[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionFraudIp",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","install",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\tCREATE TABLE IF NOT EXISTS `\"",4],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_STRING","DB_PREFIX",5],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_CONSTANT_ENCAPSED_STRING","\"fraud_ip` (\n\t\t  `ip` varchar(40) NOT NULL,\n\t\t  `date_added` datetime NOT NULL,\n\t\t  PRIMARY KEY (`ip`)\n\t\t) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;\n\t\t\"",5],")",";",["T_WHITESPACE","\n\t",10],"}",["T_WHITESPACE","\n\n\t",11],["T_PUBLIC","public",13],["T_WHITESPACE"," ",13],["T_FUNCTION","function",13],["T_WHITESPACE"," ",13],["T_STRING","uninstall",13],"(",")",["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\t\t",13],["T_VARIABLE","$this",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","db",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","query",14],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",14],["T_WHITESPACE"," ",14],".",["T_WHITESPACE"," ",14],["T_STRING","DB_PREFIX",14],["T_WHITESPACE"," ",14],".",["T_WHITESPACE"," ",14],["T_CONSTANT_ENCAPSED_STRING","\"ip`\"",14],")",";",["T_WHITESPACE","\n\t",14],"}",["T_WHITESPACE","\n\n    ",15],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_FUNCTION","function",17],["T_WHITESPACE"," ",17],["T_STRING","addIp",17],"(",["T_VARIABLE","$ip",17],")",["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n        ",17],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","db",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","query",18],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",18],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_STRING","DB_PREFIX",18],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","\"fraud_ip` SET `ip` = '\"",18],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","db",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","escape",18],"(",["T_VARIABLE","$ip",18],")",["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","\"', date_added = NOW()\"",18],")",";",["T_WHITESPACE","\n    ",18],"}",["T_WHITESPACE","\n\n    ",19],["T_PUBLIC","public",21],["T_WHITESPACE"," ",21],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","removeIp",21],"(",["T_VARIABLE","$ip",21],")",["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n        ",21],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","db",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","query",22],"(",["T_CONSTANT_ENCAPSED_STRING","\"DELETE FROM `\"",22],["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_STRING","DB_PREFIX",22],["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","\"fraud_ip` WHERE `ip` = '\"",22],["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","db",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","escape",22],"(",["T_VARIABLE","$ip",22],")",["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","\"'\"",22],")",";",["T_WHITESPACE","\n    ",22],"}",["T_WHITESPACE","\n\n\t",23],["T_PUBLIC","public",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","getIps",25],"(",["T_VARIABLE","$start",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_LNUMBER","0",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$limit",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_LNUMBER","10",25],")",["T_WHITESPACE"," ",25],"{",["T_WHITESPACE","\n        ",25],["T_IF","if",26],["T_WHITESPACE"," ",26],"(",["T_VARIABLE","$start",26],["T_WHITESPACE"," ",26],"<",["T_WHITESPACE"," ",26],["T_LNUMBER","0",26],")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n\t\t\t",26],["T_VARIABLE","$start",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_LNUMBER","0",27],";",["T_WHITESPACE","\n\t\t",27],"}",["T_WHITESPACE","\n\n\t\t",28],["T_IF","if",30],["T_WHITESPACE"," ",30],"(",["T_VARIABLE","$limit",30],["T_WHITESPACE"," ",30],"<",["T_WHITESPACE"," ",30],["T_LNUMBER","1",30],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n\t\t\t",30],["T_VARIABLE","$limit",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_LNUMBER","10",31],";",["T_WHITESPACE","\n\t\t",31],"}",["T_WHITESPACE","\n\n        ",32],["T_VARIABLE","$query",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","db",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","query",34],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_STRING","DB_PREFIX",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"fraud_ip` ORDER BY `ip` ASC LIMIT \"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_INT_CAST","(int)",34],["T_VARIABLE","$start",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\",\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_INT_CAST","(int)",34],["T_VARIABLE","$limit",34],")",";",["T_WHITESPACE","\n\n\t\t",34],["T_RETURN","return",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$query",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","rows",36],";",["T_WHITESPACE","\n\t",36],"}",["T_WHITESPACE","\n\n\t",37],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","getTotalIps",39],"(",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n\t\t",39],["T_VARIABLE","$query",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","db",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","query",40],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT COUNT(*) AS total FROM `\"",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_STRING","DB_PREFIX",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"fraud_ip`\"",40],")",";",["T_WHITESPACE","\n\n\t\t",40],["T_RETURN","return",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$query",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","row",42],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",42],"]",";",["T_WHITESPACE","\n\t",42],"}",["T_WHITESPACE","\n\n\t",43],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","getTotalIpsByIp",45],"(",["T_VARIABLE","$ip",45],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n\t\t",45],["T_VARIABLE","$query",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","db",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","query",46],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT COUNT(*) AS total FROM `\"",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_STRING","DB_PREFIX",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","\"fraud_ip` WHERE ip = '\"",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","db",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","escape",46],"(",["T_VARIABLE","$ip",46],")",["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","\"'\"",46],")",";",["T_WHITESPACE","\n\n\t\t",46],["T_RETURN","return",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$query",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","row",48],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",48],"]",";",["T_WHITESPACE","\n\t",48],"}",["T_WHITESPACE","\n",49],"}",["T_WHITESPACE","\n",50]]