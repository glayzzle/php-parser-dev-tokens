[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentSecureTradingPp",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","install",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",4],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_STRING","DB_PREFIX",5],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order` (\n\t\t\t  `securetrading_pp_order_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `order_id` INT(11) NOT NULL,\n\t\t\t  `transaction_reference` varchar(127) DEFAULT NULL,\n\t\t\t  `created` DATETIME NOT NULL,\n\t\t\t  `modified` DATETIME NOT NULL,\n\t\t\t  `release_status` INT(1) DEFAULT NULL,\n\t\t\t  `void_status` INT(1) DEFAULT NULL,\n\t\t\t  `settle_type` INT(1) DEFAULT NULL,\n\t\t\t  `rebate_status` INT(1) DEFAULT NULL,\n\t\t\t  `currency_code` CHAR(3) NOT NULL,\n\t\t\t  `total` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`securetrading_pp_order_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",5],")",";",["T_WHITESPACE","\n\n\t\t",18],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","db",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","query",20],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",20],["T_WHITESPACE"," ",21],".",["T_WHITESPACE"," ",21],["T_STRING","DB_PREFIX",21],["T_WHITESPACE"," ",21],".",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order_transaction` (\n\t\t\t  `securetrading_pp_order_transaction_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `securetrading_pp_order_id` INT(11) NOT NULL,\n\t\t\t  `created` DATETIME NOT NULL,\n\t\t\t  `type` ENUM('auth', 'payment', 'rebate', 'reversed') DEFAULT NULL,\n\t\t\t  `amount` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`securetrading_pp_order_transaction_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",21],")",";",["T_WHITESPACE","\n\t",28],"}",["T_WHITESPACE","\n\n\t",29],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","uninstall",31],"(",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n\t\t",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","db",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","query",32],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS \"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_STRING","DB_PREFIX",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order\"",32],")",";",["T_WHITESPACE","\n\t\t",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","db",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","query",33],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",33],["T_WHITESPACE"," ",33],".",["T_WHITESPACE"," ",33],["T_STRING","DB_PREFIX",33],["T_WHITESPACE"," ",33],".",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order_transaction`;\"",33],")",";",["T_WHITESPACE","\n\t",33],"}",["T_WHITESPACE","\n\n\t",34],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","void",36],"(",["T_VARIABLE","$order_id",36],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n\t\t",36],["T_VARIABLE","$securetrading_pp_order",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getOrder",37],"(",["T_VARIABLE","$order_id",37],")",";",["T_WHITESPACE","\n\n\t\t",37],["T_IF","if",39],["T_WHITESPACE"," ",39],"(","!",["T_EMPTY","empty",39],"(",["T_VARIABLE","$securetrading_pp_order",39],")",["T_WHITESPACE"," ",39],["T_BOOLEAN_AND","&&",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$securetrading_pp_order",39],"[",["T_CONSTANT_ENCAPSED_STRING","'release_status'",39],"]",["T_WHITESPACE"," ",39],["T_IS_EQUAL","==",39],["T_WHITESPACE"," ",39],["T_LNUMBER","0",39],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n\n\t\t\t",39],["T_VARIABLE","$requestblock_xml",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_NEW","new",41],["T_WHITESPACE"," ",41],["T_STRING","SimpleXMLElement",41],"(",["T_CONSTANT_ENCAPSED_STRING","'<requestblock><\/requestblock>'",41],")",";",["T_WHITESPACE","\n\t\t\t",41],["T_VARIABLE","$requestblock_xml",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","addAttribute",42],"(",["T_CONSTANT_ENCAPSED_STRING","'version'",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'3.67'",42],")",";",["T_WHITESPACE","\n\t\t\t",42],["T_VARIABLE","$requestblock_xml",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","addChild",43],"(",["T_CONSTANT_ENCAPSED_STRING","'alias'",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","config",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","get",43],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_webservice_username'",43],")",")",";",["T_WHITESPACE","\n\n\t\t\t",43],["T_VARIABLE","$request_node",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$requestblock_xml",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","addChild",45],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",45],")",";",["T_WHITESPACE","\n\t\t\t",45],["T_VARIABLE","$request_node",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","addAttribute",46],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'TRANSACTIONUPDATE'",46],")",";",["T_WHITESPACE","\n\n\t\t\t",46],["T_VARIABLE","$filter_node",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$request_node",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","addChild",48],"(",["T_CONSTANT_ENCAPSED_STRING","'filter'",48],")",";",["T_WHITESPACE","\n\t\t\t",48],["T_VARIABLE","$filter_node",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","addChild",49],"(",["T_CONSTANT_ENCAPSED_STRING","'sitereference'",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","config",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_site_reference'",49],")",")",";",["T_WHITESPACE","\n\t\t\t",49],["T_VARIABLE","$filter_node",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","addChild",50],"(",["T_CONSTANT_ENCAPSED_STRING","'transactionreference'",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$securetrading_pp_order",50],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",50],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",50],["T_VARIABLE","$request_node",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","addChild",52],"(",["T_CONSTANT_ENCAPSED_STRING","'updates'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","addChild",52],"(",["T_CONSTANT_ENCAPSED_STRING","'settlement'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","addChild",52],"(",["T_CONSTANT_ENCAPSED_STRING","'settlestatus'",52],",",["T_WHITESPACE"," ",52],["T_LNUMBER","3",52],")",";",["T_WHITESPACE","\n\n\t\t\t",52],["T_RETURN","return",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","call",54],"(",["T_VARIABLE","$requestblock_xml",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","asXML",54],"(",")",")",";",["T_WHITESPACE","\n\t\t",54],"}",["T_WHITESPACE"," ",55],["T_ELSE","else",55],["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n\t\t\t",55],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_STRING","false",56],";",["T_WHITESPACE","\n\t\t",56],"}",["T_WHITESPACE","\n\t",57],"}",["T_WHITESPACE","\n\n\t",58],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","updateVoidStatus",60],"(",["T_VARIABLE","$securetrading_pp_order_id",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$status",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n\t\t",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","db",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","query",61],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_STRING","DB_PREFIX",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order` SET `void_status` = '\"",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_INT_CAST","(int)",61],["T_VARIABLE","$status",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `securetrading_pp_order_id` = '\"",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_INT_CAST","(int)",61],["T_VARIABLE","$securetrading_pp_order_id",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","\"'\"",61],")",";",["T_WHITESPACE","\n\t",61],"}",["T_WHITESPACE","\n\n\t",62],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","release",64],"(",["T_VARIABLE","$order_id",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$amount",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n\t\t",64],["T_VARIABLE","$securetrading_pp_order",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getOrder",65],"(",["T_VARIABLE","$order_id",65],")",";",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$total_released",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getTotalReleased",66],"(",["T_VARIABLE","$securetrading_pp_order",66],"[",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_order_id'",66],"]",")",";",["T_WHITESPACE","\n\n\t\t",66],["T_IF","if",68],["T_WHITESPACE"," ",68],"(","!",["T_EMPTY","empty",68],"(",["T_VARIABLE","$securetrading_pp_order",68],")",["T_WHITESPACE"," ",68],["T_BOOLEAN_AND","&&",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$securetrading_pp_order",68],"[",["T_CONSTANT_ENCAPSED_STRING","'release_status'",68],"]",["T_WHITESPACE"," ",68],["T_IS_EQUAL","==",68],["T_WHITESPACE"," ",68],["T_LNUMBER","0",68],["T_WHITESPACE"," ",68],["T_BOOLEAN_AND","&&",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$total_released",68],["T_WHITESPACE"," ",68],["T_IS_SMALLER_OR_EQUAL","<=",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$amount",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n\n\t\t\t",68],["T_VARIABLE","$requestblock_xml",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","SimpleXMLElement",70],"(",["T_CONSTANT_ENCAPSED_STRING","'<requestblock><\/requestblock>'",70],")",";",["T_WHITESPACE","\n\t\t\t",70],["T_VARIABLE","$requestblock_xml",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","addAttribute",71],"(",["T_CONSTANT_ENCAPSED_STRING","'version'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'3.67'",71],")",";",["T_WHITESPACE","\n\t\t\t",71],["T_VARIABLE","$requestblock_xml",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","addChild",72],"(",["T_CONSTANT_ENCAPSED_STRING","'alias'",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","config",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","get",72],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_webservice_username'",72],")",")",";",["T_WHITESPACE","\n\n\t\t\t",72],["T_VARIABLE","$request_node",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$requestblock_xml",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","addChild",74],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",74],")",";",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$request_node",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","addAttribute",75],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'TRANSACTIONUPDATE'",75],")",";",["T_WHITESPACE","\n\n\t\t\t",75],["T_VARIABLE","$filter_node",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$request_node",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","addChild",77],"(",["T_CONSTANT_ENCAPSED_STRING","'filter'",77],")",";",["T_WHITESPACE","\n\t\t\t",77],["T_VARIABLE","$filter_node",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","addChild",78],"(",["T_CONSTANT_ENCAPSED_STRING","'sitereference'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","config",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","get",78],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_site_reference'",78],")",")",";",["T_WHITESPACE","\n\t\t\t",78],["T_VARIABLE","$filter_node",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","addChild",79],"(",["T_CONSTANT_ENCAPSED_STRING","'transactionreference'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$securetrading_pp_order",79],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",79],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",79],["T_VARIABLE","$settlement_node",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$request_node",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","addChild",81],"(",["T_CONSTANT_ENCAPSED_STRING","'updates'",81],")",["T_OBJECT_OPERATOR","->",81],["T_STRING","addChild",81],"(",["T_CONSTANT_ENCAPSED_STRING","'settlement'",81],")",";",["T_WHITESPACE","\n\t\t\t",81],["T_VARIABLE","$settlement_node",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","addChild",82],"(",["T_CONSTANT_ENCAPSED_STRING","'settlestatus'",82],",",["T_WHITESPACE"," ",82],["T_LNUMBER","0",82],")",";",["T_WHITESPACE","\n\t\t\t",82],["T_VARIABLE","$settlement_node",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","addChild",83],"(",["T_CONSTANT_ENCAPSED_STRING","'settlemainamount'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$amount",83],")",["T_OBJECT_OPERATOR","->",83],["T_STRING","addAttribute",83],"(",["T_CONSTANT_ENCAPSED_STRING","'currencycode'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$securetrading_pp_order",83],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",83],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",83],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","call",85],"(",["T_VARIABLE","$requestblock_xml",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","asXML",85],"(",")",")",";",["T_WHITESPACE","\n\t\t",85],"}",["T_WHITESPACE"," ",86],["T_ELSE","else",86],["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n\t\t\t",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","false",87],";",["T_WHITESPACE","\n\t\t",87],"}",["T_WHITESPACE","\n\t",88],"}",["T_WHITESPACE","\n\n\t",89],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","updateReleaseStatus",91],"(",["T_VARIABLE","$securetrading_pp_order_id",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$status",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","db",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","query",92],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_STRING","DB_PREFIX",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order` SET `release_status` = '\"",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_INT_CAST","(int)",92],["T_VARIABLE","$status",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `securetrading_pp_order_id` = '\"",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_INT_CAST","(int)",92],["T_VARIABLE","$securetrading_pp_order_id",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","\"'\"",92],")",";",["T_WHITESPACE","\n\t",92],"}",["T_WHITESPACE","\n\n\t",93],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","updateForRebate",95],"(",["T_VARIABLE","$securetrading_pp_order_id",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$order_ref",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n\t\t",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","db",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","query",96],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_STRING","DB_PREFIX",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order` SET `order_ref_previous` = '_multisettle_\"",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","db",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","escape",96],"(",["T_VARIABLE","$order_ref",96],")",["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `securetrading_pp_order_id` = '\"",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_INT_CAST","(int)",96],["T_VARIABLE","$securetrading_pp_order_id",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",96],")",";",["T_WHITESPACE","\n\t",96],"}",["T_WHITESPACE","\n\n\t",97],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","rebate",99],"(",["T_VARIABLE","$order_id",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$refunded_amount",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n\t\t",99],["T_VARIABLE","$securetrading_pp_order",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getOrder",100],"(",["T_VARIABLE","$order_id",100],")",";",["T_WHITESPACE","\n\n\t\t",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_EMPTY","empty",102],"(",["T_VARIABLE","$securetrading_pp_order",102],")",["T_WHITESPACE"," ",102],["T_BOOLEAN_AND","&&",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$securetrading_pp_order",102],"[",["T_CONSTANT_ENCAPSED_STRING","'rebate_status'",102],"]",["T_WHITESPACE"," ",102],["T_IS_NOT_EQUAL","!=",102],["T_WHITESPACE"," ",102],["T_LNUMBER","1",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n\n\t\t\t",102],["T_VARIABLE","$requestblock_xml",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_STRING","SimpleXMLElement",104],"(",["T_CONSTANT_ENCAPSED_STRING","'<requestblock><\/requestblock>'",104],")",";",["T_WHITESPACE","\n\t\t\t",104],["T_VARIABLE","$requestblock_xml",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","addAttribute",105],"(",["T_CONSTANT_ENCAPSED_STRING","'version'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'3.67'",105],")",";",["T_WHITESPACE","\n\t\t\t",105],["T_VARIABLE","$requestblock_xml",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","addChild",106],"(",["T_CONSTANT_ENCAPSED_STRING","'alias'",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","config",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","get",106],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_webservice_username'",106],")",")",";",["T_WHITESPACE","\n\n\t\t\t",106],["T_VARIABLE","$request_node",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$requestblock_xml",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","addChild",108],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",108],")",";",["T_WHITESPACE","\n\t\t\t",108],["T_VARIABLE","$request_node",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","addAttribute",109],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'REFUND'",109],")",";",["T_WHITESPACE","\n\n\t\t\t",109],["T_VARIABLE","$request_node",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","addChild",111],"(",["T_CONSTANT_ENCAPSED_STRING","'merchant'",111],")",["T_OBJECT_OPERATOR","->",111],["T_STRING","addChild",111],"(",["T_CONSTANT_ENCAPSED_STRING","'orderreference'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$order_id",111],")",";",["T_WHITESPACE","\n\n\t\t\t",111],["T_VARIABLE","$operation_node",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$request_node",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","addChild",113],"(",["T_CONSTANT_ENCAPSED_STRING","'operation'",113],")",";",["T_WHITESPACE","\n\t\t\t",113],["T_VARIABLE","$operation_node",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","addChild",114],"(",["T_CONSTANT_ENCAPSED_STRING","'accounttypedescription'",114],",",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'ECOM'",114],")",";",["T_WHITESPACE","\n\t\t\t",114],["T_VARIABLE","$operation_node",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","addChild",115],"(",["T_CONSTANT_ENCAPSED_STRING","'parenttransactionreference'",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$securetrading_pp_order",115],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",115],"]",")",";",["T_WHITESPACE","\n\t\t\t",115],["T_VARIABLE","$operation_node",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","addChild",116],"(",["T_CONSTANT_ENCAPSED_STRING","'sitereference'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","config",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","get",116],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_site_reference'",116],")",")",";",["T_WHITESPACE","\n\n\t\t\t",116],["T_VARIABLE","$billing_node",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$request_node",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","addChild",118],"(",["T_CONSTANT_ENCAPSED_STRING","'billing'",118],")",";",["T_WHITESPACE","\n\t\t\t",118],["T_VARIABLE","$billing_node",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","addAttribute",119],"(",["T_CONSTANT_ENCAPSED_STRING","'currencycode'",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$securetrading_pp_order",119],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",119],"]",")",";",["T_WHITESPACE","\n\t\t\t",119],["T_VARIABLE","$billing_node",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","addChild",120],"(",["T_CONSTANT_ENCAPSED_STRING","'amount'",120],",",["T_WHITESPACE"," ",120],["T_STRING","str_replace",120],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",120],",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","''",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$refunded_amount",120],")",")",";",["T_WHITESPACE","\n\n\t\t\t",120],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","call",122],"(",["T_VARIABLE","$requestblock_xml",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","asXML",122],"(",")",")",";",["T_WHITESPACE","\n\t\t",122],"}",["T_WHITESPACE"," ",123],["T_ELSE","else",123],["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n\t\t\t",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_STRING","false",124],";",["T_WHITESPACE","\n\t\t",124],"}",["T_WHITESPACE","\n\t",125],"}",["T_WHITESPACE","\n\n\t",126],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","getOrder",128],"(",["T_VARIABLE","$order_id",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n\t\t",128],["T_VARIABLE","$qry",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","db",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","query",129],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_STRING","DB_PREFIX",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order` WHERE `order_id` = '\"",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_INT_CAST","(int)",129],["T_VARIABLE","$order_id",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",129],")",";",["T_WHITESPACE","\n\n\t\t",129],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$qry",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","num_rows",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n\t\t\t",131],["T_VARIABLE","$order",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$qry",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","row",132],";",["T_WHITESPACE","\n\t\t\t",132],["T_VARIABLE","$order",133],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",133],"]",["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getTransactions",133],"(",["T_VARIABLE","$order",133],"[",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_order_id'",133],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",133],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$order",135],";",["T_WHITESPACE","\n\t\t",135],"}",["T_WHITESPACE"," ",136],["T_ELSE","else",136],["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n\t\t\t",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_STRING","false",137],";",["T_WHITESPACE","\n\t\t",137],"}",["T_WHITESPACE","\n\t",138],"}",["T_WHITESPACE","\n\n\t",139],["T_PRIVATE","private",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","getTransactions",141],"(",["T_VARIABLE","$securetrading_pp_order_id",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n\t\t",141],["T_VARIABLE","$qry",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","db",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","query",142],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_STRING","DB_PREFIX",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order_transaction` WHERE `securetrading_pp_order_id` = '\"",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_INT_CAST","(int)",142],["T_VARIABLE","$securetrading_pp_order_id",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","\"'\"",142],")",";",["T_WHITESPACE","\n\n\t\t",142],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$qry",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","num_rows",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n\t\t\t",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$qry",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","rows",145],";",["T_WHITESPACE","\n\t\t",145],"}",["T_WHITESPACE"," ",146],["T_ELSE","else",146],["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n\t\t\t",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_STRING","false",147],";",["T_WHITESPACE","\n\t\t",147],"}",["T_WHITESPACE","\n\t",148],"}",["T_WHITESPACE","\n\n\t",149],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","addTransaction",151],"(",["T_VARIABLE","$securetrading_pp_order_id",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$type",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$total",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n\t\t",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","db",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","query",152],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_STRING","DB_PREFIX",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order_transaction` SET `securetrading_pp_order_id` = '\"",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_INT_CAST","(int)",152],["T_VARIABLE","$securetrading_pp_order_id",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","\"', `created` = now(), `type` = '\"",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","db",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","escape",152],"(",["T_VARIABLE","$type",152],")",["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_DOUBLE_CAST","(double)",152],["T_VARIABLE","$total",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","\"'\"",152],")",";",["T_WHITESPACE","\n\t",152],"}",["T_WHITESPACE","\n\n\t",153],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","getTotalReleased",155],"(",["T_VARIABLE","$securetrading_pp_order_id",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n\t\t",155],["T_VARIABLE","$query",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","db",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","query",156],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_STRING","DB_PREFIX",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order_transaction` WHERE `securetrading_pp_order_id` = '\"",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_INT_CAST","(int)",156],["T_VARIABLE","$securetrading_pp_order_id",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","\"' AND (`type` = 'payment' OR `type` = 'rebate')\"",156],")",";",["T_WHITESPACE","\n\n\t\t",156],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_DOUBLE_CAST","(double)",158],["T_VARIABLE","$query",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","row",158],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",158],"]",";",["T_WHITESPACE","\n\t",158],"}",["T_WHITESPACE","\n\n\t",159],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","getTotalRebated",161],"(",["T_VARIABLE","$securetrading_pp_order_id",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n\t\t",161],["T_VARIABLE","$query",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","db",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","query",162],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_STRING","DB_PREFIX",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order_transaction` WHERE `securetrading_pp_order_id` = '\"",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_INT_CAST","(int)",162],["T_VARIABLE","$securetrading_pp_order_id",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","\"' AND 'rebate'\"",162],")",";",["T_WHITESPACE","\n\n\t\t",162],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_DOUBLE_CAST","(double)",164],["T_VARIABLE","$query",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","row",164],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",164],"]",";",["T_WHITESPACE","\n\t",164],"}",["T_WHITESPACE","\n\n\t",165],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","increaseRefundedAmount",167],"(",["T_VARIABLE","$order_id",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$amount",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n\t\t",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","db",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","query",168],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE \"",168],["T_WHITESPACE"," ",168],".",["T_WHITESPACE"," ",168],["T_STRING","DB_PREFIX",168],["T_WHITESPACE"," ",168],".",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_pp_order SET refunded = refunded + \"",168],["T_WHITESPACE"," ",168],".",["T_WHITESPACE"," ",168],["T_DOUBLE_CAST","(double)",168],["T_VARIABLE","$amount",168],["T_WHITESPACE"," ",168],".",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","\" WHERE order_id = \"",168],["T_WHITESPACE"," ",168],".",["T_WHITESPACE"," ",168],["T_INT_CAST","(int)",168],["T_VARIABLE","$order_id",168],")",";",["T_WHITESPACE","\n\t",168],"}",["T_WHITESPACE","\n\n\t",169],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","call",171],"(",["T_VARIABLE","$data",171],")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n\t\t",171],["T_VARIABLE","$ch",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","curl_init",172],"(",")",";",["T_WHITESPACE","\n\n\t\t",172],["T_VARIABLE","$defaults",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",["T_WHITESPACE","\n\t\t\t",174],["T_STRING","CURLOPT_POST",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_LNUMBER","1",175],",",["T_WHITESPACE","\n\t\t\t",175],["T_STRING","CURLOPT_HEADER",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_LNUMBER","0",176],",",["T_WHITESPACE","\n\t\t\t",176],["T_STRING","CURLOPT_SSL_VERIFYPEER",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_LNUMBER","0",177],",",["T_WHITESPACE","\n\t\t\t",177],["T_STRING","CURLOPT_URL",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/webservices.securetrading.net\/xml\/'",178],",",["T_WHITESPACE","\n\t\t\t",178],["T_STRING","CURLOPT_FRESH_CONNECT",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_LNUMBER","1",179],",",["T_WHITESPACE","\n\t\t\t",179],["T_STRING","CURLOPT_RETURNTRANSFER",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],["T_LNUMBER","1",180],",",["T_WHITESPACE","\n\t\t\t",180],["T_STRING","CURLOPT_FORBID_REUSE",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_LNUMBER","1",181],",",["T_WHITESPACE","\n\t\t\t",181],["T_STRING","CURLOPT_TIMEOUT",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_LNUMBER","15",182],",",["T_WHITESPACE","\n\t\t\t",182],["T_STRING","CURLOPT_HTTPHEADER",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_ARRAY","array",183],"(",["T_WHITESPACE","\n\t\t\t\t",183],["T_CONSTANT_ENCAPSED_STRING","'User-Agent: OpenCart - Secure Trading PP'",184],",",["T_WHITESPACE","\n\t\t\t\t",184],["T_CONSTANT_ENCAPSED_STRING","'Content-Length: '",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_STRING","strlen",185],"(",["T_VARIABLE","$data",185],")",",",["T_WHITESPACE","\n\t\t\t\t",185],["T_CONSTANT_ENCAPSED_STRING","'Authorization: Basic '",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_STRING","base64_encode",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","config",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","get",186],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_webservice_username'",186],")",["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","':'",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","config",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","get",186],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp_webservice_password'",186],")",")",",",["T_WHITESPACE","\n\t\t\t",186],")",",",["T_WHITESPACE","\n\t\t\t",187],["T_STRING","CURLOPT_POSTFIELDS",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$data",188],",",["T_WHITESPACE","\n\t\t",188],")",";",["T_WHITESPACE","\n\n\t\t",189],["T_STRING","curl_setopt_array",191],"(",["T_VARIABLE","$ch",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$defaults",191],")",";",["T_WHITESPACE","\n\n\t\t",191],["T_VARIABLE","$response",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","curl_exec",193],"(",["T_VARIABLE","$ch",193],")",";",["T_WHITESPACE","\n\n\t\t",193],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$response",195],["T_WHITESPACE"," ",195],["T_IS_IDENTICAL","===",195],["T_WHITESPACE"," ",195],["T_STRING","false",195],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n\t\t\t",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","log",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","write",196],"(",["T_CONSTANT_ENCAPSED_STRING","'Secure Trading PP CURL Error: ('",196],["T_WHITESPACE"," ",196],".",["T_WHITESPACE"," ",196],["T_STRING","curl_errno",196],"(",["T_VARIABLE","$ch",196],")",["T_WHITESPACE"," ",196],".",["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","') '",196],["T_WHITESPACE"," ",196],".",["T_WHITESPACE"," ",196],["T_STRING","curl_error",196],"(",["T_VARIABLE","$ch",196],")",")",";",["T_WHITESPACE","\n\t\t",196],"}",["T_WHITESPACE","\n\n\t\t",197],["T_STRING","curl_close",199],"(",["T_VARIABLE","$ch",199],")",";",["T_WHITESPACE","\n\n\t\t",199],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$response",201],";",["T_WHITESPACE","\n\t",201],"}",["T_WHITESPACE","\n\n\t",202],["T_PUBLIC","public",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","logger",204],"(",["T_VARIABLE","$message",204],")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n\t\t",204],["T_VARIABLE","$log",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_NEW","new",205],["T_WHITESPACE"," ",205],["T_STRING","Log",205],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_pp.log'",205],")",";",["T_WHITESPACE","\n\t\t",205],["T_VARIABLE","$log",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","write",206],"(",["T_VARIABLE","$message",206],")",";",["T_WHITESPACE","\n\t",206],"}",["T_WHITESPACE","\n",207],"}"]