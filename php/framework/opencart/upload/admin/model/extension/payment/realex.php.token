[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentRealex",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","install",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",4],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_STRING","DB_PREFIX",5],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_CONSTANT_ENCAPSED_STRING","\"realex_order` (\n\t\t\t  `realex_order_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `order_id` INT(11) NOT NULL,\n\t\t\t  `order_ref` CHAR(50) NOT NULL,\n\t\t\t  `order_ref_previous` CHAR(50) NOT NULL,\n\t\t\t  `pasref` VARCHAR(50) NOT NULL,\n\t\t\t  `pasref_previous` VARCHAR(50) NOT NULL,\n\t\t\t  `date_added` DATETIME NOT NULL,\n\t\t\t  `date_modified` DATETIME NOT NULL,\n\t\t\t  `capture_status` INT(1) DEFAULT NULL,\n\t\t\t  `void_status` INT(1) DEFAULT NULL,\n\t\t\t  `settle_type` INT(1) DEFAULT NULL,\n\t\t\t  `rebate_status` INT(1) DEFAULT NULL,\n\t\t\t  `currency_code` CHAR(3) NOT NULL,\n\t\t\t  `authcode` VARCHAR(30) NOT NULL,\n\t\t\t  `account` VARCHAR(30) NOT NULL,\n\t\t\t  `total` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`realex_order_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",5],")",";",["T_WHITESPACE","\n\n\t\t",23],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","db",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","query",25],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",25],["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_STRING","DB_PREFIX",26],["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","\"realex_order_transaction` (\n\t\t\t  `realex_order_transaction_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `realex_order_id` INT(11) NOT NULL,\n\t\t\t  `date_added` DATETIME NOT NULL,\n\t\t\t  `type` ENUM('auth', 'payment', 'rebate', 'void') DEFAULT NULL,\n\t\t\t  `amount` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`realex_order_transaction_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",26],")",";",["T_WHITESPACE","\n\t",33],"}",["T_WHITESPACE","\n\n\t",34],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","void",36],"(",["T_VARIABLE","$order_id",36],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n\t\t",36],["T_VARIABLE","$realex_order",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getOrder",37],"(",["T_VARIABLE","$order_id",37],")",";",["T_WHITESPACE","\n\n\t\t",37],["T_IF","if",39],["T_WHITESPACE"," ",39],"(","!",["T_EMPTY","empty",39],"(",["T_VARIABLE","$realex_order",39],")",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n\t\t\t",39],["T_VARIABLE","$timestamp",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING","strftime",40],"(",["T_CONSTANT_ENCAPSED_STRING","\"%Y%m%d%H%M%S\"",40],")",";",["T_WHITESPACE","\n\t\t\t",40],["T_VARIABLE","$merchant_id",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","config",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","get",41],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_merchant_id'",41],")",";",["T_WHITESPACE","\n\t\t\t",41],["T_VARIABLE","$secret",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","config",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","get",42],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_secret'",42],")",";",["T_WHITESPACE","\n\n\t\t\t",42],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","logger",44],"(",["T_CONSTANT_ENCAPSED_STRING","'Void hash construct: '",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_VARIABLE","$timestamp",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'.'",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_VARIABLE","$merchant_id",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'.'",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_VARIABLE","$realex_order",44],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",44],"]",["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'...'",44],")",";",["T_WHITESPACE","\n\n\t\t\t",44],["T_VARIABLE","$tmp",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$timestamp",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'.'",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_VARIABLE","$merchant_id",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'.'",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_VARIABLE","$realex_order",46],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",46],"]",["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'...'",46],";",["T_WHITESPACE","\n\t\t\t",46],["T_VARIABLE","$hash",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","sha1",47],"(",["T_VARIABLE","$tmp",47],")",";",["T_WHITESPACE","\n\t\t\t",47],["T_VARIABLE","$tmp",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$hash",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'.'",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_VARIABLE","$secret",48],";",["T_WHITESPACE","\n\t\t\t",48],["T_VARIABLE","$hash",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","sha1",49],"(",["T_VARIABLE","$tmp",49],")",";",["T_WHITESPACE","\n\n\t\t\t",49],["T_VARIABLE","$xml",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","''",51],";",["T_WHITESPACE","\n\t\t\t",51],["T_VARIABLE","$xml",52],["T_WHITESPACE"," ",52],["T_CONCAT_EQUAL",".=",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'<request type=\"void\" timestamp=\"'",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_VARIABLE","$timestamp",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'\">'",52],";",["T_WHITESPACE","\n\t\t\t",52],["T_VARIABLE","$xml",53],["T_WHITESPACE"," ",53],["T_CONCAT_EQUAL",".=",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'<merchantid>'",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_VARIABLE","$merchant_id",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'<\/merchantid>'",53],";",["T_WHITESPACE","\n\t\t\t",53],["T_VARIABLE","$xml",54],["T_WHITESPACE"," ",54],["T_CONCAT_EQUAL",".=",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'<account>'",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_VARIABLE","$realex_order",54],"[",["T_CONSTANT_ENCAPSED_STRING","'account'",54],"]",["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'<\/account>'",54],";",["T_WHITESPACE","\n\t\t\t",54],["T_VARIABLE","$xml",55],["T_WHITESPACE"," ",55],["T_CONCAT_EQUAL",".=",55],["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'<orderid>'",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$realex_order",55],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",55],"]",["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'<\/orderid>'",55],";",["T_WHITESPACE","\n\t\t\t",55],["T_VARIABLE","$xml",56],["T_WHITESPACE"," ",56],["T_CONCAT_EQUAL",".=",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'<pasref>'",56],["T_WHITESPACE"," ",56],".",["T_WHITESPACE"," ",56],["T_VARIABLE","$realex_order",56],"[",["T_CONSTANT_ENCAPSED_STRING","'pasref'",56],"]",["T_WHITESPACE"," ",56],".",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'<\/pasref>'",56],";",["T_WHITESPACE","\n\t\t\t",56],["T_VARIABLE","$xml",57],["T_WHITESPACE"," ",57],["T_CONCAT_EQUAL",".=",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'<authcode>'",57],["T_WHITESPACE"," ",57],".",["T_WHITESPACE"," ",57],["T_VARIABLE","$realex_order",57],"[",["T_CONSTANT_ENCAPSED_STRING","'authcode'",57],"]",["T_WHITESPACE"," ",57],".",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'<\/authcode>'",57],";",["T_WHITESPACE","\n\t\t\t",57],["T_VARIABLE","$xml",58],["T_WHITESPACE"," ",58],["T_CONCAT_EQUAL",".=",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'<sha1hash>'",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_VARIABLE","$hash",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'<\/sha1hash>'",58],";",["T_WHITESPACE","\n\t\t\t",58],["T_VARIABLE","$xml",59],["T_WHITESPACE"," ",59],["T_CONCAT_EQUAL",".=",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'<\/request>'",59],";",["T_WHITESPACE","\n\n\t\t\t",59],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","logger",61],"(",["T_CONSTANT_ENCAPSED_STRING","'Void XML request:\\r\\n'",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_STRING","print_r",61],"(",["T_STRING","simplexml_load_string",61],"(",["T_VARIABLE","$xml",61],")",",",["T_WHITESPACE"," ",61],["T_LNUMBER","1",61],")",")",";",["T_WHITESPACE","\n\n\t\t\t",61],["T_VARIABLE","$ch",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","curl_init",63],"(",")",";",["T_WHITESPACE","\n\t\t\t",63],["T_STRING","curl_setopt",64],"(",["T_VARIABLE","$ch",64],",",["T_WHITESPACE"," ",64],["T_STRING","CURLOPT_URL",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","\"https:\/\/epage.payandshop.com\/epage-remote.cgi\"",64],")",";",["T_WHITESPACE","\n\t\t\t",64],["T_STRING","curl_setopt",65],"(",["T_VARIABLE","$ch",65],",",["T_WHITESPACE"," ",65],["T_STRING","CURLOPT_POST",65],",",["T_WHITESPACE"," ",65],["T_LNUMBER","1",65],")",";",["T_WHITESPACE","\n\t\t\t",65],["T_STRING","curl_setopt",66],"(",["T_VARIABLE","$ch",66],",",["T_WHITESPACE"," ",66],["T_STRING","CURLOPT_USERAGENT",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"OpenCart \"",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_STRING","VERSION",66],")",";",["T_WHITESPACE","\n\t\t\t",66],["T_STRING","curl_setopt",67],"(",["T_VARIABLE","$ch",67],",",["T_WHITESPACE"," ",67],["T_STRING","CURLOPT_RETURNTRANSFER",67],",",["T_WHITESPACE"," ",67],["T_LNUMBER","1",67],")",";",["T_WHITESPACE","\n\t\t\t",67],["T_STRING","curl_setopt",68],"(",["T_VARIABLE","$ch",68],",",["T_WHITESPACE"," ",68],["T_STRING","CURLOPT_POSTFIELDS",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$xml",68],")",";",["T_WHITESPACE","\n\t\t\t",68],["T_STRING","curl_setopt",69],"(",["T_VARIABLE","$ch",69],",",["T_WHITESPACE"," ",69],["T_STRING","CURLOPT_SSL_VERIFYPEER",69],",",["T_WHITESPACE"," ",69],["T_STRING","false",69],")",";",["T_WHITESPACE","\n\t\t\t",69],["T_VARIABLE","$response",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","curl_exec",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$ch",70],")",";",["T_WHITESPACE","\n\t\t\t",70],["T_STRING","curl_close",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$ch",71],")",";",["T_WHITESPACE","\n\n\t\t\t",71],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_STRING","simplexml_load_string",73],"(",["T_VARIABLE","$response",73],")",";",["T_WHITESPACE","\n\t\t",73],"}",["T_WHITESPACE"," ",74],["T_ELSE","else",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_STRING","false",75],";",["T_WHITESPACE","\n\t\t",75],"}",["T_WHITESPACE","\n\t",76],"}",["T_WHITESPACE","\n\n\t",77],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","updateVoidStatus",79],"(",["T_VARIABLE","$realex_order_id",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$status",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n\t\t",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","db",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","query",80],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_STRING","DB_PREFIX",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"realex_order` SET `void_status` = '\"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_INT_CAST","(int)",80],["T_VARIABLE","$status",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `realex_order_id` = '\"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_INT_CAST","(int)",80],["T_VARIABLE","$realex_order_id",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"'\"",80],")",";",["T_WHITESPACE","\n\t",80],"}",["T_WHITESPACE","\n\n\t",81],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","capture",83],"(",["T_VARIABLE","$order_id",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$amount",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n\t\t",83],["T_VARIABLE","$realex_order",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getOrder",84],"(",["T_VARIABLE","$order_id",84],")",";",["T_WHITESPACE","\n\n\t\t",84],["T_IF","if",86],["T_WHITESPACE"," ",86],"(","!",["T_EMPTY","empty",86],"(",["T_VARIABLE","$realex_order",86],")",["T_WHITESPACE"," ",86],["T_BOOLEAN_AND","&&",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$realex_order",86],"[",["T_CONSTANT_ENCAPSED_STRING","'capture_status'",86],"]",["T_WHITESPACE"," ",86],["T_IS_EQUAL","==",86],["T_WHITESPACE"," ",86],["T_LNUMBER","0",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n\t\t\t",86],["T_VARIABLE","$timestamp",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","strftime",87],"(",["T_CONSTANT_ENCAPSED_STRING","\"%Y%m%d%H%M%S\"",87],")",";",["T_WHITESPACE","\n\t\t\t",87],["T_VARIABLE","$merchant_id",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","config",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","get",88],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_merchant_id'",88],")",";",["T_WHITESPACE","\n\t\t\t",88],["T_VARIABLE","$secret",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","get",89],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_secret'",89],")",";",["T_WHITESPACE","\n\n\t\t\t",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$realex_order",91],"[",["T_CONSTANT_ENCAPSED_STRING","'settle_type'",91],"]",["T_WHITESPACE"," ",91],["T_IS_EQUAL","==",91],["T_WHITESPACE"," ",91],["T_LNUMBER","2",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t\t",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","logger",92],"(",["T_CONSTANT_ENCAPSED_STRING","'Capture hash construct: '",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_VARIABLE","$timestamp",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'.'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_VARIABLE","$merchant_id",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'.'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_VARIABLE","$realex_order",92],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",92],"]",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'.'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_INT_CAST","(int)",92],["T_STRING","round",92],"(",["T_VARIABLE","$amount",92],"*",["T_LNUMBER","100",92],")",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'.'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_STRING_CAST","(string)",92],["T_VARIABLE","$realex_order",92],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",92],"]",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'.'",92],")",";",["T_WHITESPACE","\n\n\t\t\t\t",92],["T_VARIABLE","$tmp",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$timestamp",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'.'",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_VARIABLE","$merchant_id",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'.'",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_VARIABLE","$realex_order",94],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",94],"]",["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'.'",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_INT_CAST","(int)",94],["T_STRING","round",94],"(",["T_VARIABLE","$amount",94],"*",["T_LNUMBER","100",94],")",["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'.'",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_STRING_CAST","(string)",94],["T_VARIABLE","$realex_order",94],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",94],"]",["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'.'",94],";",["T_WHITESPACE","\n\t\t\t\t",94],["T_VARIABLE","$hash",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","sha1",95],"(",["T_VARIABLE","$tmp",95],")",";",["T_WHITESPACE","\n\t\t\t\t",95],["T_VARIABLE","$tmp",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$hash",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'.'",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_VARIABLE","$secret",96],";",["T_WHITESPACE","\n\t\t\t\t",96],["T_VARIABLE","$hash",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","sha1",97],"(",["T_VARIABLE","$tmp",97],")",";",["T_WHITESPACE","\n\n\t\t\t\t",97],["T_VARIABLE","$settle_type",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'multisettle'",99],";",["T_WHITESPACE","\n\t\t\t\t",99],["T_VARIABLE","$xml_amount",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'<amount currency=\"'",100],["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_STRING_CAST","(string)",100],["T_VARIABLE","$realex_order",100],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",100],"]",["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'\">'",100],["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_INT_CAST","(int)",100],["T_STRING","round",100],"(",["T_VARIABLE","$amount",100],"*",["T_LNUMBER","100",100],")",["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'<\/amount>'",100],";",["T_WHITESPACE","\n\t\t\t",100],"}",["T_WHITESPACE"," ",101],["T_ELSE","else",101],["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n\t\t\t\t",101],["T_COMMENT","\/\/$this->logger('Capture hash construct: ' . $timestamp . '.' . $merchant_id . '.' . $realex_order['order_ref'] . '...');\n",102],["T_WHITESPACE","\t\t\t\t",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","logger",103],"(",["T_CONSTANT_ENCAPSED_STRING","'Capture hash construct: '",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$timestamp",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'.'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$merchant_id",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'.'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$realex_order",103],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",103],"]",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'.'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_INT_CAST","(int)",103],["T_STRING","round",103],"(",["T_VARIABLE","$amount",103],"*",["T_LNUMBER","100",103],")",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'.'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_STRING_CAST","(string)",103],["T_VARIABLE","$realex_order",103],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",103],"]",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'.'",103],")",";",["T_WHITESPACE","\n\n\t\t\t\t",103],["T_VARIABLE","$tmp",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$timestamp",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'.'",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_VARIABLE","$merchant_id",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'.'",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_VARIABLE","$realex_order",105],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",105],"]",["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'.'",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_INT_CAST","(int)",105],["T_STRING","round",105],"(",["T_VARIABLE","$amount",105],"*",["T_LNUMBER","100",105],")",["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'.'",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_STRING_CAST","(string)",105],["T_VARIABLE","$realex_order",105],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",105],"]",["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'.'",105],";",["T_WHITESPACE","\n\t\t\t\t",105],["T_VARIABLE","$hash",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","sha1",106],"(",["T_VARIABLE","$tmp",106],")",";",["T_WHITESPACE","\n\t\t\t\t",106],["T_VARIABLE","$tmp",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$hash",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'.'",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_VARIABLE","$secret",107],";",["T_WHITESPACE","\n\t\t\t\t",107],["T_VARIABLE","$hash",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","sha1",108],"(",["T_VARIABLE","$tmp",108],")",";",["T_WHITESPACE","\n\n\t\t\t\t",108],["T_VARIABLE","$settle_type",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'settle'",110],";",["T_WHITESPACE","\n\t\t\t\t",110],["T_VARIABLE","$xml_amount",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'<amount currency=\"'",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_STRING_CAST","(string)",111],["T_VARIABLE","$realex_order",111],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",111],"]",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'\">'",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_INT_CAST","(int)",111],["T_STRING","round",111],"(",["T_VARIABLE","$amount",111],"*",["T_LNUMBER","100",111],")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'<\/amount>'",111],";",["T_WHITESPACE","\n\t\t\t",111],"}",["T_WHITESPACE","\n\n\t\t\t",112],["T_VARIABLE","$xml",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","''",114],";",["T_WHITESPACE","\n\t\t\t",114],["T_VARIABLE","$xml",115],["T_WHITESPACE"," ",115],["T_CONCAT_EQUAL",".=",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'<request type=\"'",115],["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_VARIABLE","$settle_type",115],["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'\" timestamp=\"'",115],["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_VARIABLE","$timestamp",115],["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'\">'",115],";",["T_WHITESPACE","\n\t\t\t",115],["T_VARIABLE","$xml",116],["T_WHITESPACE"," ",116],["T_CONCAT_EQUAL",".=",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'<merchantid>'",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_VARIABLE","$merchant_id",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'<\/merchantid>'",116],";",["T_WHITESPACE","\n\t\t\t",116],["T_VARIABLE","$xml",117],["T_WHITESPACE"," ",117],["T_CONCAT_EQUAL",".=",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'<account>'",117],["T_WHITESPACE"," ",117],".",["T_WHITESPACE"," ",117],["T_VARIABLE","$realex_order",117],"[",["T_CONSTANT_ENCAPSED_STRING","'account'",117],"]",["T_WHITESPACE"," ",117],".",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'<\/account>'",117],";",["T_WHITESPACE","\n\t\t\t",117],["T_VARIABLE","$xml",118],["T_WHITESPACE"," ",118],["T_CONCAT_EQUAL",".=",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'<orderid>'",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$realex_order",118],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",118],"]",["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'<\/orderid>'",118],";",["T_WHITESPACE","\n\t\t\t",118],["T_VARIABLE","$xml",119],["T_WHITESPACE"," ",119],["T_CONCAT_EQUAL",".=",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$xml_amount",119],";",["T_WHITESPACE","\n\t\t\t",119],["T_VARIABLE","$xml",120],["T_WHITESPACE"," ",120],["T_CONCAT_EQUAL",".=",120],["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'<pasref>'",120],["T_WHITESPACE"," ",120],".",["T_WHITESPACE"," ",120],["T_VARIABLE","$realex_order",120],"[",["T_CONSTANT_ENCAPSED_STRING","'pasref'",120],"]",["T_WHITESPACE"," ",120],".",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'<\/pasref>'",120],";",["T_WHITESPACE","\n\t\t\t",120],["T_VARIABLE","$xml",121],["T_WHITESPACE"," ",121],["T_CONCAT_EQUAL",".=",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'<autosettle flag=\"1\" \/>'",121],";",["T_WHITESPACE","\n\t\t\t",121],["T_VARIABLE","$xml",122],["T_WHITESPACE"," ",122],["T_CONCAT_EQUAL",".=",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'<authcode>'",122],["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_VARIABLE","$realex_order",122],"[",["T_CONSTANT_ENCAPSED_STRING","'authcode'",122],"]",["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'<\/authcode>'",122],";",["T_WHITESPACE","\n\t\t\t",122],["T_VARIABLE","$xml",123],["T_WHITESPACE"," ",123],["T_CONCAT_EQUAL",".=",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'<sha1hash>'",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$hash",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'<\/sha1hash>'",123],";",["T_WHITESPACE","\n\t\t\t",123],["T_VARIABLE","$xml",124],["T_WHITESPACE"," ",124],["T_CONCAT_EQUAL",".=",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'<\/request>'",124],";",["T_WHITESPACE","\n\n\t\t\t",124],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","logger",126],"(",["T_CONSTANT_ENCAPSED_STRING","'Settle XML request:\\r\\n'",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_STRING","print_r",126],"(",["T_STRING","simplexml_load_string",126],"(",["T_VARIABLE","$xml",126],")",",",["T_WHITESPACE"," ",126],["T_LNUMBER","1",126],")",")",";",["T_WHITESPACE","\n\n\t\t\t",126],["T_VARIABLE","$ch",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","curl_init",128],"(",")",";",["T_WHITESPACE","\n\t\t\t",128],["T_STRING","curl_setopt",129],"(",["T_VARIABLE","$ch",129],",",["T_WHITESPACE"," ",129],["T_STRING","CURLOPT_URL",129],",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"https:\/\/epage.payandshop.com\/epage-remote.cgi\"",129],")",";",["T_WHITESPACE","\n\t\t\t",129],["T_STRING","curl_setopt",130],"(",["T_VARIABLE","$ch",130],",",["T_WHITESPACE"," ",130],["T_STRING","CURLOPT_POST",130],",",["T_WHITESPACE"," ",130],["T_LNUMBER","1",130],")",";",["T_WHITESPACE","\n\t\t\t",130],["T_STRING","curl_setopt",131],"(",["T_VARIABLE","$ch",131],",",["T_WHITESPACE"," ",131],["T_STRING","CURLOPT_USERAGENT",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","\"OpenCart \"",131],["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_STRING","VERSION",131],")",";",["T_WHITESPACE","\n\t\t\t",131],["T_STRING","curl_setopt",132],"(",["T_VARIABLE","$ch",132],",",["T_WHITESPACE"," ",132],["T_STRING","CURLOPT_RETURNTRANSFER",132],",",["T_WHITESPACE"," ",132],["T_LNUMBER","1",132],")",";",["T_WHITESPACE","\n\t\t\t",132],["T_STRING","curl_setopt",133],"(",["T_VARIABLE","$ch",133],",",["T_WHITESPACE"," ",133],["T_STRING","CURLOPT_POSTFIELDS",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$xml",133],")",";",["T_WHITESPACE","\n\t\t\t",133],["T_STRING","curl_setopt",134],"(",["T_VARIABLE","$ch",134],",",["T_WHITESPACE"," ",134],["T_STRING","CURLOPT_SSL_VERIFYPEER",134],",",["T_WHITESPACE"," ",134],["T_STRING","false",134],")",";",["T_WHITESPACE","\n\t\t\t",134],["T_VARIABLE","$response",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING","curl_exec",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$ch",135],")",";",["T_WHITESPACE","\n\t\t\t",135],["T_STRING","curl_close",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$ch",136],")",";",["T_WHITESPACE","\n\n\t\t\t",136],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_STRING","simplexml_load_string",138],"(",["T_VARIABLE","$response",138],")",";",["T_WHITESPACE","\n\t\t",138],"}",["T_WHITESPACE"," ",139],["T_ELSE","else",139],["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n\t\t\t",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_STRING","false",140],";",["T_WHITESPACE","\n\t\t",140],"}",["T_WHITESPACE","\n\t",141],"}",["T_WHITESPACE","\n\n\t",142],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","updateCaptureStatus",144],"(",["T_VARIABLE","$realex_order_id",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$status",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n\t\t",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","db",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","query",145],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_STRING","DB_PREFIX",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"realex_order` SET `capture_status` = '\"",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_INT_CAST","(int)",145],["T_VARIABLE","$status",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `realex_order_id` = '\"",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_INT_CAST","(int)",145],["T_VARIABLE","$realex_order_id",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"'\"",145],")",";",["T_WHITESPACE","\n\t",145],"}",["T_WHITESPACE","\n\n\t",146],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","updateForRebate",148],"(",["T_VARIABLE","$realex_order_id",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$pas_ref",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$order_ref",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n\t\t",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","db",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","query",149],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_STRING","DB_PREFIX",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","\"realex_order` SET `order_ref_previous` = '_multisettle_\"",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","db",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","escape",149],"(",["T_VARIABLE","$order_ref",149],")",["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","\"', `pasref_previous` = '\"",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","db",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","escape",149],"(",["T_VARIABLE","$pas_ref",149],")",["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `realex_order_id` = '\"",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_INT_CAST","(int)",149],["T_VARIABLE","$realex_order_id",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",149],")",";",["T_WHITESPACE","\n\t",149],"}",["T_WHITESPACE","\n\n\t",150],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","rebate",152],"(",["T_VARIABLE","$order_id",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$amount",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n\t\t",152],["T_VARIABLE","$realex_order",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getOrder",153],"(",["T_VARIABLE","$order_id",153],")",";",["T_WHITESPACE","\n\n\t\t",153],["T_IF","if",155],["T_WHITESPACE"," ",155],"(","!",["T_EMPTY","empty",155],"(",["T_VARIABLE","$realex_order",155],")",["T_WHITESPACE"," ",155],["T_BOOLEAN_AND","&&",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$realex_order",155],"[",["T_CONSTANT_ENCAPSED_STRING","'rebate_status'",155],"]",["T_WHITESPACE"," ",155],["T_IS_NOT_EQUAL","!=",155],["T_WHITESPACE"," ",155],["T_LNUMBER","1",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n\t\t\t",155],["T_VARIABLE","$timestamp",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","strftime",156],"(",["T_CONSTANT_ENCAPSED_STRING","\"%Y%m%d%H%M%S\"",156],")",";",["T_WHITESPACE","\n\t\t\t",156],["T_VARIABLE","$merchant_id",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","config",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","get",157],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_merchant_id'",157],")",";",["T_WHITESPACE","\n\t\t\t",157],["T_VARIABLE","$secret",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","config",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","get",158],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_secret'",158],")",";",["T_WHITESPACE","\n\n\t\t\t",158],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$realex_order",160],"[",["T_CONSTANT_ENCAPSED_STRING","'settle_type'",160],"]",["T_WHITESPACE"," ",160],["T_IS_EQUAL","==",160],["T_WHITESPACE"," ",160],["T_LNUMBER","2",160],")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n\t\t\t\t",160],["T_VARIABLE","$order_ref",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'_multisettle_'",161],["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_VARIABLE","$realex_order",161],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",161],"]",";",["T_WHITESPACE","\n\n\t\t\t\t",161],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_EMPTY","empty",163],"(",["T_VARIABLE","$realex_order",163],"[",["T_CONSTANT_ENCAPSED_STRING","'pasref_previous'",163],"]",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n\t\t\t\t\t",163],["T_VARIABLE","$pas_ref",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$realex_order",164],"[",["T_CONSTANT_ENCAPSED_STRING","'pasref'",164],"]",";",["T_WHITESPACE","\n\t\t\t\t",164],"}",["T_WHITESPACE"," ",165],["T_ELSE","else",165],["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n\t\t\t\t\t",165],["T_VARIABLE","$pas_ref",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$realex_order",166],"[",["T_CONSTANT_ENCAPSED_STRING","'pasref_previous'",166],"]",";",["T_WHITESPACE","\n\t\t\t\t",166],"}",["T_WHITESPACE","\n\t\t\t",167],"}",["T_WHITESPACE"," ",168],["T_ELSE","else",168],["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n\t\t\t\t",168],["T_VARIABLE","$order_ref",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$realex_order",169],"[",["T_CONSTANT_ENCAPSED_STRING","'order_ref'",169],"]",";",["T_WHITESPACE","\n\t\t\t\t",169],["T_VARIABLE","$pas_ref",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$realex_order",170],"[",["T_CONSTANT_ENCAPSED_STRING","'pasref'",170],"]",";",["T_WHITESPACE","\n\t\t\t",170],"}",["T_WHITESPACE","\n\n\t\t\t",171],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","logger",173],"(",["T_CONSTANT_ENCAPSED_STRING","'Rebate hash construct: '",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_VARIABLE","$timestamp",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'.'",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_VARIABLE","$merchant_id",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'.'",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_VARIABLE","$order_ref",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'.'",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_INT_CAST","(int)",173],["T_STRING","round",173],"(",["T_VARIABLE","$amount",173],"*",["T_LNUMBER","100",173],")",["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'.'",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_VARIABLE","$realex_order",173],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",173],"]",["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'.'",173],")",";",["T_WHITESPACE","\n\n\t\t\t",173],["T_VARIABLE","$tmp",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$timestamp",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'.'",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_VARIABLE","$merchant_id",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'.'",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_VARIABLE","$order_ref",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'.'",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_INT_CAST","(int)",175],["T_STRING","round",175],"(",["T_VARIABLE","$amount",175],"*",["T_LNUMBER","100",175],")",["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'.'",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_VARIABLE","$realex_order",175],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",175],"]",["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'.'",175],";",["T_WHITESPACE","\n\t\t\t",175],["T_VARIABLE","$hash",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","sha1",176],"(",["T_VARIABLE","$tmp",176],")",";",["T_WHITESPACE","\n\t\t\t",176],["T_VARIABLE","$tmp",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$hash",177],["T_WHITESPACE"," ",177],".",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'.'",177],["T_WHITESPACE"," ",177],".",["T_WHITESPACE"," ",177],["T_VARIABLE","$secret",177],";",["T_WHITESPACE","\n\t\t\t",177],["T_VARIABLE","$hash",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","sha1",178],"(",["T_VARIABLE","$tmp",178],")",";",["T_WHITESPACE","\n\n\t\t\t",178],["T_VARIABLE","$rebate_hash",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","sha1",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","config",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","get",180],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_rebate_password'",180],")",")",";",["T_WHITESPACE","\n\n\t\t\t",180],["T_VARIABLE","$xml",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","''",182],";",["T_WHITESPACE","\n\t\t\t",182],["T_VARIABLE","$xml",183],["T_WHITESPACE"," ",183],["T_CONCAT_EQUAL",".=",183],["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","'<request type=\"rebate\" timestamp=\"'",183],["T_WHITESPACE"," ",183],".",["T_WHITESPACE"," ",183],["T_VARIABLE","$timestamp",183],["T_WHITESPACE"," ",183],".",["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","'\">'",183],";",["T_WHITESPACE","\n\t\t\t",183],["T_VARIABLE","$xml",184],["T_WHITESPACE"," ",184],["T_CONCAT_EQUAL",".=",184],["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'<merchantid>'",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_VARIABLE","$merchant_id",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'<\/merchantid>'",184],";",["T_WHITESPACE","\n\t\t\t",184],["T_VARIABLE","$xml",185],["T_WHITESPACE"," ",185],["T_CONCAT_EQUAL",".=",185],["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'<account>'",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_VARIABLE","$realex_order",185],"[",["T_CONSTANT_ENCAPSED_STRING","'account'",185],"]",["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'<\/account>'",185],";",["T_WHITESPACE","\n\t\t\t",185],["T_VARIABLE","$xml",186],["T_WHITESPACE"," ",186],["T_CONCAT_EQUAL",".=",186],["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","'<orderid>'",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_VARIABLE","$order_ref",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","'<\/orderid>'",186],";",["T_WHITESPACE","\n\t\t\t",186],["T_VARIABLE","$xml",187],["T_WHITESPACE"," ",187],["T_CONCAT_EQUAL",".=",187],["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'<pasref>'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$pas_ref",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'<\/pasref>'",187],";",["T_WHITESPACE","\n\t\t\t",187],["T_VARIABLE","$xml",188],["T_WHITESPACE"," ",188],["T_CONCAT_EQUAL",".=",188],["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'<authcode>'",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_VARIABLE","$realex_order",188],"[",["T_CONSTANT_ENCAPSED_STRING","'authcode'",188],"]",["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'<\/authcode>'",188],";",["T_WHITESPACE","\n\t\t\t",188],["T_VARIABLE","$xml",189],["T_WHITESPACE"," ",189],["T_CONCAT_EQUAL",".=",189],["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'<amount currency=\"'",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_STRING_CAST","(string)",189],["T_VARIABLE","$realex_order",189],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",189],"]",["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'\">'",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_INT_CAST","(int)",189],["T_STRING","round",189],"(",["T_VARIABLE","$amount",189],"*",["T_LNUMBER","100",189],")",["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'<\/amount>'",189],";",["T_WHITESPACE","\n\t\t\t",189],["T_VARIABLE","$xml",190],["T_WHITESPACE"," ",190],["T_CONCAT_EQUAL",".=",190],["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'<refundhash>'",190],["T_WHITESPACE"," ",190],".",["T_WHITESPACE"," ",190],["T_VARIABLE","$rebate_hash",190],["T_WHITESPACE"," ",190],".",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'<\/refundhash>'",190],";",["T_WHITESPACE","\n\t\t\t",190],["T_VARIABLE","$xml",191],["T_WHITESPACE"," ",191],["T_CONCAT_EQUAL",".=",191],["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'<sha1hash>'",191],["T_WHITESPACE"," ",191],".",["T_WHITESPACE"," ",191],["T_VARIABLE","$hash",191],["T_WHITESPACE"," ",191],".",["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'<\/sha1hash>'",191],";",["T_WHITESPACE","\n\t\t\t",191],["T_VARIABLE","$xml",192],["T_WHITESPACE"," ",192],["T_CONCAT_EQUAL",".=",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'<\/request>'",192],";",["T_WHITESPACE","\n\n\t\t\t",192],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","logger",194],"(",["T_CONSTANT_ENCAPSED_STRING","'Rebate XML request:\\r\\n'",194],["T_WHITESPACE"," ",194],".",["T_WHITESPACE"," ",194],["T_STRING","print_r",194],"(",["T_STRING","simplexml_load_string",194],"(",["T_VARIABLE","$xml",194],")",",",["T_WHITESPACE"," ",194],["T_LNUMBER","1",194],")",")",";",["T_WHITESPACE","\n\n\t\t\t",194],["T_VARIABLE","$ch",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","curl_init",196],"(",")",";",["T_WHITESPACE","\n\t\t\t",196],["T_STRING","curl_setopt",197],"(",["T_VARIABLE","$ch",197],",",["T_WHITESPACE"," ",197],["T_STRING","CURLOPT_URL",197],",",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","\"https:\/\/epage.payandshop.com\/epage-remote.cgi\"",197],")",";",["T_WHITESPACE","\n\t\t\t",197],["T_STRING","curl_setopt",198],"(",["T_VARIABLE","$ch",198],",",["T_WHITESPACE"," ",198],["T_STRING","CURLOPT_POST",198],",",["T_WHITESPACE"," ",198],["T_LNUMBER","1",198],")",";",["T_WHITESPACE","\n\t\t\t",198],["T_STRING","curl_setopt",199],"(",["T_VARIABLE","$ch",199],",",["T_WHITESPACE"," ",199],["T_STRING","CURLOPT_USERAGENT",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","\"OpenCart \"",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_STRING","VERSION",199],")",";",["T_WHITESPACE","\n\t\t\t",199],["T_STRING","curl_setopt",200],"(",["T_VARIABLE","$ch",200],",",["T_WHITESPACE"," ",200],["T_STRING","CURLOPT_RETURNTRANSFER",200],",",["T_WHITESPACE"," ",200],["T_LNUMBER","1",200],")",";",["T_WHITESPACE","\n\t\t\t",200],["T_STRING","curl_setopt",201],"(",["T_VARIABLE","$ch",201],",",["T_WHITESPACE"," ",201],["T_STRING","CURLOPT_POSTFIELDS",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$xml",201],")",";",["T_WHITESPACE","\n\t\t\t",201],["T_STRING","curl_setopt",202],"(",["T_VARIABLE","$ch",202],",",["T_WHITESPACE"," ",202],["T_STRING","CURLOPT_SSL_VERIFYPEER",202],",",["T_WHITESPACE"," ",202],["T_STRING","false",202],")",";",["T_WHITESPACE","\n\t\t\t",202],["T_VARIABLE","$response",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","curl_exec",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$ch",203],")",";",["T_WHITESPACE","\n\t\t\t",203],["T_STRING","curl_close",204],["T_WHITESPACE"," ",204],"(",["T_VARIABLE","$ch",204],")",";",["T_WHITESPACE","\n\n\t\t\t",204],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_STRING","simplexml_load_string",206],"(",["T_VARIABLE","$response",206],")",";",["T_WHITESPACE","\n\t\t",206],"}",["T_WHITESPACE"," ",207],["T_ELSE","else",207],["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n\t\t\t",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_STRING","false",208],";",["T_WHITESPACE","\n\t\t",208],"}",["T_WHITESPACE","\n\t",209],"}",["T_WHITESPACE","\n\n\t",210],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","updateRebateStatus",212],"(",["T_VARIABLE","$realex_order_id",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$status",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n\t\t",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","db",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","query",213],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_STRING","DB_PREFIX",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","\"realex_order` SET `rebate_status` = '\"",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_INT_CAST","(int)",213],["T_VARIABLE","$status",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `realex_order_id` = '\"",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_INT_CAST","(int)",213],["T_VARIABLE","$realex_order_id",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","\"'\"",213],")",";",["T_WHITESPACE","\n\t",213],"}",["T_WHITESPACE","\n\n\t",214],["T_PUBLIC","public",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","getOrder",216],"(",["T_VARIABLE","$order_id",216],")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n\t\t",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","logger",217],"(",["T_CONSTANT_ENCAPSED_STRING","'getOrder - '",217],["T_WHITESPACE"," ",217],".",["T_WHITESPACE"," ",217],["T_VARIABLE","$order_id",217],")",";",["T_WHITESPACE","\n\n\t\t",217],["T_VARIABLE","$qry",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","db",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","query",219],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",219],["T_WHITESPACE"," ",219],".",["T_WHITESPACE"," ",219],["T_STRING","DB_PREFIX",219],["T_WHITESPACE"," ",219],".",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","\"realex_order` WHERE `order_id` = '\"",219],["T_WHITESPACE"," ",219],".",["T_WHITESPACE"," ",219],["T_INT_CAST","(int)",219],["T_VARIABLE","$order_id",219],["T_WHITESPACE"," ",219],".",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",219],")",";",["T_WHITESPACE","\n\n\t\t",219],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$qry",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","num_rows",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n\t\t\t",221],["T_VARIABLE","$order",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$qry",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","row",222],";",["T_WHITESPACE","\n\t\t\t",222],["T_VARIABLE","$order",223],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",223],"]",["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getTransactions",223],"(",["T_VARIABLE","$order",223],"[",["T_CONSTANT_ENCAPSED_STRING","'realex_order_id'",223],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",223],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","logger",225],"(",["T_STRING","print_r",225],"(",["T_VARIABLE","$order",225],",",["T_WHITESPACE"," ",225],["T_LNUMBER","1",225],")",")",";",["T_WHITESPACE","\n\n\t\t\t",225],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$order",227],";",["T_WHITESPACE","\n\t\t",227],"}",["T_WHITESPACE"," ",228],["T_ELSE","else",228],["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n\t\t\t",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_STRING","false",229],";",["T_WHITESPACE","\n\t\t",229],"}",["T_WHITESPACE","\n\t",230],"}",["T_WHITESPACE","\n\n\t",231],["T_PRIVATE","private",233],["T_WHITESPACE"," ",233],["T_FUNCTION","function",233],["T_WHITESPACE"," ",233],["T_STRING","getTransactions",233],"(",["T_VARIABLE","$realex_order_id",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n\t\t",233],["T_VARIABLE","$qry",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","db",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","query",234],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",234],["T_WHITESPACE"," ",234],".",["T_WHITESPACE"," ",234],["T_STRING","DB_PREFIX",234],["T_WHITESPACE"," ",234],".",["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","\"realex_order_transaction` WHERE `realex_order_id` = '\"",234],["T_WHITESPACE"," ",234],".",["T_WHITESPACE"," ",234],["T_INT_CAST","(int)",234],["T_VARIABLE","$realex_order_id",234],["T_WHITESPACE"," ",234],".",["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","\"'\"",234],")",";",["T_WHITESPACE","\n\n\t\t",234],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$qry",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","num_rows",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n\t\t\t",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$qry",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","rows",237],";",["T_WHITESPACE","\n\t\t",237],"}",["T_WHITESPACE"," ",238],["T_ELSE","else",238],["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n\t\t\t",238],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_STRING","false",239],";",["T_WHITESPACE","\n\t\t",239],"}",["T_WHITESPACE","\n\t",240],"}",["T_WHITESPACE","\n\n\t",241],["T_PUBLIC","public",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","addTransaction",243],"(",["T_VARIABLE","$realex_order_id",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$type",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$total",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n\t\t",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","db",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","query",244],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_STRING","DB_PREFIX",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","\"realex_order_transaction` SET `realex_order_id` = '\"",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_INT_CAST","(int)",244],["T_VARIABLE","$realex_order_id",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","\"', `date_added` = now(), `type` = '\"",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","db",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","escape",244],"(",["T_VARIABLE","$type",244],")",["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_DOUBLE_CAST","(float)",244],["T_VARIABLE","$total",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","\"'\"",244],")",";",["T_WHITESPACE","\n\t",244],"}",["T_WHITESPACE","\n\n\t",245],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","logger",247],"(",["T_VARIABLE","$message",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n\t\t",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","config",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","get",248],"(",["T_CONSTANT_ENCAPSED_STRING","'realex_debug'",248],")",["T_WHITESPACE"," ",248],["T_IS_EQUAL","==",248],["T_WHITESPACE"," ",248],["T_LNUMBER","1",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n\t\t\t",248],["T_VARIABLE","$log",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_NEW","new",249],["T_WHITESPACE"," ",249],["T_STRING","Log",249],"(",["T_CONSTANT_ENCAPSED_STRING","'realex.log'",249],")",";",["T_WHITESPACE","\n\t\t\t",249],["T_VARIABLE","$log",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","write",250],"(",["T_VARIABLE","$message",250],")",";",["T_WHITESPACE","\n\t\t",250],"}",["T_WHITESPACE","\n\t",251],"}",["T_WHITESPACE","\n\n\t",252],["T_PUBLIC","public",254],["T_WHITESPACE"," ",254],["T_FUNCTION","function",254],["T_WHITESPACE"," ",254],["T_STRING","getTotalCaptured",254],"(",["T_VARIABLE","$realex_order_id",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n\t\t",254],["T_VARIABLE","$query",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","db",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","query",255],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_STRING","DB_PREFIX",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","\"realex_order_transaction` WHERE `realex_order_id` = '\"",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_INT_CAST","(int)",255],["T_VARIABLE","$realex_order_id",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","\"' AND (`type` = 'payment' OR `type` = 'rebate')\"",255],")",";",["T_WHITESPACE","\n\n\t\t",255],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_DOUBLE_CAST","(float)",257],["T_VARIABLE","$query",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","row",257],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",257],"]",";",["T_WHITESPACE","\n\t",257],"}",["T_WHITESPACE","\n\n\t",258],["T_PUBLIC","public",260],["T_WHITESPACE"," ",260],["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],["T_STRING","getTotalRebated",260],"(",["T_VARIABLE","$realex_order_id",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n\t\t",260],["T_VARIABLE","$query",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","db",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","query",261],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_STRING","DB_PREFIX",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","\"realex_order_transaction` WHERE `realex_order_id` = '\"",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_INT_CAST","(int)",261],["T_VARIABLE","$realex_order_id",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","\"' AND 'rebate'\"",261],")",";",["T_WHITESPACE","\n\n\t\t",261],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_DOUBLE_CAST","(float)",263],["T_VARIABLE","$query",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","row",263],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",263],"]",";",["T_WHITESPACE","\n\t",263],"}",["T_WHITESPACE","\n",264],"}"]