[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentSecureTradingWs",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","install",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",4],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_STRING","DB_PREFIX",5],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` (\n\t\t\t  `securetrading_ws_order_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `order_id` INT(11) NOT NULL,\n\t\t\t  `md` varchar(1024) DEFAULT NULL,\n\t\t\t  `transaction_reference` varchar(127) DEFAULT NULL,\n\t\t\t  `created` DATETIME NOT NULL,\n\t\t\t  `modified` DATETIME NOT NULL,\n\t\t\t  `release_status` INT(1) DEFAULT NULL,\n\t\t\t  `void_status` INT(1) DEFAULT NULL,\n\t\t\t  `settle_type` INT(1) DEFAULT NULL,\n\t\t\t  `rebate_status` INT(1) DEFAULT NULL,\n\t\t\t  `currency_code` CHAR(3) NOT NULL,\n\t\t\t  `total` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`securetrading_ws_order_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",5],")",";",["T_WHITESPACE","\n\n\t\t",19],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","db",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","query",21],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",21],["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_STRING","DB_PREFIX",22],["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction` (\n\t\t\t  `securetrading_ws_order_transaction_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `securetrading_ws_order_id` INT(11) NOT NULL,\n\t\t\t  `created` DATETIME NOT NULL,\n\t\t\t  `type` ENUM('auth', 'payment', 'rebate', 'reversed') DEFAULT NULL,\n\t\t\t  `amount` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`securetrading_ws_order_transaction_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",22],")",";",["T_WHITESPACE","\n\t",29],"}",["T_WHITESPACE","\n\n\t",30],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","uninstall",32],"(",")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n\t\t",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","db",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","query",33],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS \"",33],["T_WHITESPACE"," ",33],".",["T_WHITESPACE"," ",33],["T_STRING","DB_PREFIX",33],["T_WHITESPACE"," ",33],".",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order\"",33],")",";",["T_WHITESPACE","\n\t\t",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","db",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","query",34],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_STRING","DB_PREFIX",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction`;\"",34],")",";",["T_WHITESPACE","\n\t",34],"}",["T_WHITESPACE","\n\n\t",35],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","void",37],"(",["T_VARIABLE","$order_id",37],")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n\t\t",37],["T_VARIABLE","$securetrading_ws_order",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getOrder",38],"(",["T_VARIABLE","$order_id",38],")",";",["T_WHITESPACE","\n\n\t\t",38],["T_IF","if",40],["T_WHITESPACE"," ",40],"(","!",["T_EMPTY","empty",40],"(",["T_VARIABLE","$securetrading_ws_order",40],")",["T_WHITESPACE"," ",40],["T_BOOLEAN_AND","&&",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$securetrading_ws_order",40],"[",["T_CONSTANT_ENCAPSED_STRING","'release_status'",40],"]",["T_WHITESPACE"," ",40],["T_IS_EQUAL","==",40],["T_WHITESPACE"," ",40],["T_LNUMBER","0",40],")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n\n\t\t\t",40],["T_VARIABLE","$requestblock_xml",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_NEW","new",42],["T_WHITESPACE"," ",42],["T_STRING","SimpleXMLElement",42],"(",["T_CONSTANT_ENCAPSED_STRING","'<requestblock><\/requestblock>'",42],")",";",["T_WHITESPACE","\n\t\t\t",42],["T_VARIABLE","$requestblock_xml",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","addAttribute",43],"(",["T_CONSTANT_ENCAPSED_STRING","'version'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'3.67'",43],")",";",["T_WHITESPACE","\n\t\t\t",43],["T_VARIABLE","$requestblock_xml",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","addChild",44],"(",["T_CONSTANT_ENCAPSED_STRING","'alias'",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","config",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","get",44],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_username'",44],")",")",";",["T_WHITESPACE","\n\n\t\t\t",44],["T_VARIABLE","$request_node",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$requestblock_xml",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","addChild",46],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",46],")",";",["T_WHITESPACE","\n\t\t\t",46],["T_VARIABLE","$request_node",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","addAttribute",47],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",47],",",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'TRANSACTIONUPDATE'",47],")",";",["T_WHITESPACE","\n\n\t\t\t",47],["T_VARIABLE","$filter_node",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$request_node",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","addChild",49],"(",["T_CONSTANT_ENCAPSED_STRING","'filter'",49],")",";",["T_WHITESPACE","\n\t\t\t",49],["T_VARIABLE","$filter_node",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","addChild",50],"(",["T_CONSTANT_ENCAPSED_STRING","'sitereference'",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","config",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_site_reference'",50],")",")",";",["T_WHITESPACE","\n\t\t\t",50],["T_VARIABLE","$filter_node",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","addChild",51],"(",["T_CONSTANT_ENCAPSED_STRING","'transactionreference'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$securetrading_ws_order",51],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",51],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",51],["T_VARIABLE","$request_node",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","addChild",53],"(",["T_CONSTANT_ENCAPSED_STRING","'updates'",53],")",["T_OBJECT_OPERATOR","->",53],["T_STRING","addChild",53],"(",["T_CONSTANT_ENCAPSED_STRING","'settlement'",53],")",["T_OBJECT_OPERATOR","->",53],["T_STRING","addChild",53],"(",["T_CONSTANT_ENCAPSED_STRING","'settlestatus'",53],",",["T_WHITESPACE"," ",53],["T_LNUMBER","3",53],")",";",["T_WHITESPACE","\n\n\t\t\t",53],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","call",55],"(",["T_VARIABLE","$requestblock_xml",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","asXML",55],"(",")",")",";",["T_WHITESPACE","\n\t\t",55],"}",["T_WHITESPACE"," ",56],["T_ELSE","else",56],["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n\t\t\t",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_STRING","false",57],";",["T_WHITESPACE","\n\t\t",57],"}",["T_WHITESPACE","\n\t",58],"}",["T_WHITESPACE","\n\n\t",59],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","updateVoidStatus",61],"(",["T_VARIABLE","$securetrading_ws_order_id",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$status",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n\t\t",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","db",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","query",62],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_STRING","DB_PREFIX",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` SET `void_status` = '\"",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_INT_CAST","(int)",62],["T_VARIABLE","$status",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `securetrading_ws_order_id` = '\"",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_INT_CAST","(int)",62],["T_VARIABLE","$securetrading_ws_order_id",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","\"'\"",62],")",";",["T_WHITESPACE","\n\t",62],"}",["T_WHITESPACE","\n\n\t",63],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","release",65],"(",["T_VARIABLE","$order_id",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$amount",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$securetrading_ws_order",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getOrder",66],"(",["T_VARIABLE","$order_id",66],")",";",["T_WHITESPACE","\n\t\t",66],["T_VARIABLE","$total_released",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getTotalReleased",67],"(",["T_VARIABLE","$securetrading_ws_order",67],"[",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_order_id'",67],"]",")",";",["T_WHITESPACE","\n\n\t\t",67],["T_IF","if",69],["T_WHITESPACE"," ",69],"(","!",["T_EMPTY","empty",69],"(",["T_VARIABLE","$securetrading_ws_order",69],")",["T_WHITESPACE"," ",69],["T_BOOLEAN_AND","&&",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$securetrading_ws_order",69],"[",["T_CONSTANT_ENCAPSED_STRING","'release_status'",69],"]",["T_WHITESPACE"," ",69],["T_IS_EQUAL","==",69],["T_WHITESPACE"," ",69],["T_LNUMBER","0",69],["T_WHITESPACE"," ",69],["T_BOOLEAN_AND","&&",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$total_released",69],["T_WHITESPACE"," ",69],["T_IS_SMALLER_OR_EQUAL","<=",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$amount",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n\n\t\t\t",69],["T_VARIABLE","$requestblock_xml",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_NEW","new",71],["T_WHITESPACE"," ",71],["T_STRING","SimpleXMLElement",71],"(",["T_CONSTANT_ENCAPSED_STRING","'<requestblock><\/requestblock>'",71],")",";",["T_WHITESPACE","\n\t\t\t",71],["T_VARIABLE","$requestblock_xml",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","addAttribute",72],"(",["T_CONSTANT_ENCAPSED_STRING","'version'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'3.67'",72],")",";",["T_WHITESPACE","\n\t\t\t",72],["T_VARIABLE","$requestblock_xml",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","addChild",73],"(",["T_CONSTANT_ENCAPSED_STRING","'alias'",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","config",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","get",73],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_username'",73],")",")",";",["T_WHITESPACE","\n\n\t\t\t",73],["T_VARIABLE","$request_node",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$requestblock_xml",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","addChild",75],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",75],")",";",["T_WHITESPACE","\n\t\t\t",75],["T_VARIABLE","$request_node",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","addAttribute",76],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'TRANSACTIONUPDATE'",76],")",";",["T_WHITESPACE","\n\n\t\t\t",76],["T_VARIABLE","$filter_node",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$request_node",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","addChild",78],"(",["T_CONSTANT_ENCAPSED_STRING","'filter'",78],")",";",["T_WHITESPACE","\n\t\t\t",78],["T_VARIABLE","$filter_node",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","addChild",79],"(",["T_CONSTANT_ENCAPSED_STRING","'sitereference'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","config",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","get",79],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_site_reference'",79],")",")",";",["T_WHITESPACE","\n\t\t\t",79],["T_VARIABLE","$filter_node",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","addChild",80],"(",["T_CONSTANT_ENCAPSED_STRING","'transactionreference'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$securetrading_ws_order",80],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",80],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",80],["T_VARIABLE","$settlement_node",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$request_node",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","addChild",82],"(",["T_CONSTANT_ENCAPSED_STRING","'updates'",82],")",["T_OBJECT_OPERATOR","->",82],["T_STRING","addChild",82],"(",["T_CONSTANT_ENCAPSED_STRING","'settlement'",82],")",";",["T_WHITESPACE","\n\t\t\t",82],["T_VARIABLE","$settlement_node",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","addChild",83],"(",["T_CONSTANT_ENCAPSED_STRING","'settlestatus'",83],",",["T_WHITESPACE"," ",83],["T_LNUMBER","0",83],")",";",["T_WHITESPACE","\n\t\t\t",83],["T_VARIABLE","$settlement_node",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","addChild",84],"(",["T_CONSTANT_ENCAPSED_STRING","'settlemainamount'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$amount",84],")",["T_OBJECT_OPERATOR","->",84],["T_STRING","addAttribute",84],"(",["T_CONSTANT_ENCAPSED_STRING","'currencycode'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$securetrading_ws_order",84],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",84],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",84],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","call",86],"(",["T_VARIABLE","$requestblock_xml",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","asXML",86],"(",")",")",";",["T_WHITESPACE","\n\t\t",86],"}",["T_WHITESPACE"," ",87],["T_ELSE","else",87],["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n\t\t\t",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_STRING","false",88],";",["T_WHITESPACE","\n\t\t",88],"}",["T_WHITESPACE","\n\t",89],"}",["T_WHITESPACE","\n\n\t",90],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","updateReleaseStatus",92],"(",["T_VARIABLE","$securetrading_ws_order_id",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$status",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n\t\t",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","db",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","query",93],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_STRING","DB_PREFIX",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` SET `release_status` = '\"",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_INT_CAST","(int)",93],["T_VARIABLE","$status",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `securetrading_ws_order_id` = '\"",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_INT_CAST","(int)",93],["T_VARIABLE","$securetrading_ws_order_id",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","\"'\"",93],")",";",["T_WHITESPACE","\n\t",93],"}",["T_WHITESPACE","\n\n\t",94],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","updateForRebate",96],"(",["T_VARIABLE","$securetrading_ws_order_id",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$order_ref",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n\t\t",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","db",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","query",97],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_STRING","DB_PREFIX",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` SET `order_ref_previous` = '_multisettle_\"",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","db",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","escape",97],"(",["T_VARIABLE","$order_ref",97],")",["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `securetrading_ws_order_id` = '\"",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_INT_CAST","(int)",97],["T_VARIABLE","$securetrading_ws_order_id",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",97],")",";",["T_WHITESPACE","\n\t",97],"}",["T_WHITESPACE","\n\n\t",98],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","rebate",100],"(",["T_VARIABLE","$order_id",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$refunded_amount",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n\t\t",100],["T_VARIABLE","$securetrading_ws_order",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getOrder",101],"(",["T_VARIABLE","$order_id",101],")",";",["T_WHITESPACE","\n\n\t\t",101],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!",["T_EMPTY","empty",103],"(",["T_VARIABLE","$securetrading_ws_order",103],")",["T_WHITESPACE"," ",103],["T_BOOLEAN_AND","&&",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$securetrading_ws_order",103],"[",["T_CONSTANT_ENCAPSED_STRING","'rebate_status'",103],"]",["T_WHITESPACE"," ",103],["T_IS_NOT_EQUAL","!=",103],["T_WHITESPACE"," ",103],["T_LNUMBER","1",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n\n\t\t\t",103],["T_VARIABLE","$requestblock_xml",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","SimpleXMLElement",105],"(",["T_CONSTANT_ENCAPSED_STRING","'<requestblock><\/requestblock>'",105],")",";",["T_WHITESPACE","\n\t\t\t",105],["T_VARIABLE","$requestblock_xml",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","addAttribute",106],"(",["T_CONSTANT_ENCAPSED_STRING","'version'",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'3.67'",106],")",";",["T_WHITESPACE","\n\t\t\t",106],["T_VARIABLE","$requestblock_xml",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","addChild",107],"(",["T_CONSTANT_ENCAPSED_STRING","'alias'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","config",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","get",107],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_username'",107],")",")",";",["T_WHITESPACE","\n\n\t\t\t",107],["T_VARIABLE","$request_node",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$requestblock_xml",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","addChild",109],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",109],")",";",["T_WHITESPACE","\n\t\t\t",109],["T_VARIABLE","$request_node",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","addAttribute",110],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'REFUND'",110],")",";",["T_WHITESPACE","\n\n\t\t\t",110],["T_VARIABLE","$request_node",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","addChild",112],"(",["T_CONSTANT_ENCAPSED_STRING","'merchant'",112],")",["T_OBJECT_OPERATOR","->",112],["T_STRING","addChild",112],"(",["T_CONSTANT_ENCAPSED_STRING","'orderreference'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$order_id",112],")",";",["T_WHITESPACE","\n\n\t\t\t",112],["T_VARIABLE","$operation_node",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$request_node",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","addChild",114],"(",["T_CONSTANT_ENCAPSED_STRING","'operation'",114],")",";",["T_WHITESPACE","\n\t\t\t",114],["T_VARIABLE","$operation_node",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","addChild",115],"(",["T_CONSTANT_ENCAPSED_STRING","'accounttypedescription'",115],",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'ECOM'",115],")",";",["T_WHITESPACE","\n\t\t\t",115],["T_VARIABLE","$operation_node",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","addChild",116],"(",["T_CONSTANT_ENCAPSED_STRING","'parenttransactionreference'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$securetrading_ws_order",116],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",116],"]",")",";",["T_WHITESPACE","\n\t\t\t",116],["T_VARIABLE","$operation_node",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","addChild",117],"(",["T_CONSTANT_ENCAPSED_STRING","'sitereference'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","config",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","get",117],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_site_reference'",117],")",")",";",["T_WHITESPACE","\n\n\t\t\t",117],["T_VARIABLE","$billing_node",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$request_node",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","addChild",119],"(",["T_CONSTANT_ENCAPSED_STRING","'billing'",119],")",";",["T_WHITESPACE","\n\t\t\t",119],["T_VARIABLE","$billing_node",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","addAttribute",120],"(",["T_CONSTANT_ENCAPSED_STRING","'currencycode'",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$securetrading_ws_order",120],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",120],"]",")",";",["T_WHITESPACE","\n\t\t\t",120],["T_VARIABLE","$billing_node",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","addChild",121],"(",["T_CONSTANT_ENCAPSED_STRING","'amount'",121],",",["T_WHITESPACE"," ",121],["T_STRING","str_replace",121],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","''",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$refunded_amount",121],")",")",";",["T_WHITESPACE","\n\n\t\t\t",121],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","call",123],"(",["T_VARIABLE","$requestblock_xml",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","asXML",123],"(",")",")",";",["T_WHITESPACE","\n\t\t",123],"}",["T_WHITESPACE"," ",124],["T_ELSE","else",124],["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n\t\t\t",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_STRING","false",125],";",["T_WHITESPACE","\n\t\t",125],"}",["T_WHITESPACE","\n\t",126],"}",["T_WHITESPACE","\n\n\t",127],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","getOrder",129],"(",["T_VARIABLE","$order_id",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n\t\t",129],["T_VARIABLE","$qry",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","db",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","query",130],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_STRING","DB_PREFIX",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` WHERE `order_id` = '\"",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_INT_CAST","(int)",130],["T_VARIABLE","$order_id",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",130],")",";",["T_WHITESPACE","\n\n\t\t",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$qry",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","num_rows",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n\t\t\t",132],["T_VARIABLE","$order",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$qry",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","row",133],";",["T_WHITESPACE","\n\t\t\t",133],["T_VARIABLE","$order",134],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",134],"]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getTransactions",134],"(",["T_VARIABLE","$order",134],"[",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_order_id'",134],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",134],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$order",136],";",["T_WHITESPACE","\n\t\t",136],"}",["T_WHITESPACE"," ",137],["T_ELSE","else",137],["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n\t\t\t",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_STRING","false",138],";",["T_WHITESPACE","\n\t\t",138],"}",["T_WHITESPACE","\n\t",139],"}",["T_WHITESPACE","\n\n\t",140],["T_PRIVATE","private",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","getTransactions",142],"(",["T_VARIABLE","$securetrading_ws_order_id",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n\t\t",142],["T_VARIABLE","$qry",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","query",143],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_STRING","DB_PREFIX",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction` WHERE `securetrading_ws_order_id` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_INT_CAST","(int)",143],["T_VARIABLE","$securetrading_ws_order_id",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"'\"",143],")",";",["T_WHITESPACE","\n\n\t\t",143],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$qry",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","num_rows",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n\t\t\t",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$qry",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","rows",146],";",["T_WHITESPACE","\n\t\t",146],"}",["T_WHITESPACE"," ",147],["T_ELSE","else",147],["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n\t\t\t",147],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_STRING","false",148],";",["T_WHITESPACE","\n\t\t",148],"}",["T_WHITESPACE","\n\t",149],"}",["T_WHITESPACE","\n\n\t",150],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","addTransaction",152],"(",["T_VARIABLE","$securetrading_ws_order_id",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$type",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$total",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n\t\t",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","db",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","query",153],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_STRING","DB_PREFIX",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction` SET `securetrading_ws_order_id` = '\"",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_INT_CAST","(int)",153],["T_VARIABLE","$securetrading_ws_order_id",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"', `created` = now(), `type` = '\"",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","db",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","escape",153],"(",["T_VARIABLE","$type",153],")",["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_DOUBLE_CAST","(double)",153],["T_VARIABLE","$total",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"'\"",153],")",";",["T_WHITESPACE","\n\t",153],"}",["T_WHITESPACE","\n\n\t",154],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","getTotalReleased",156],"(",["T_VARIABLE","$securetrading_ws_order_id",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n\t\t",156],["T_VARIABLE","$query",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","db",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","query",157],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",157],["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_STRING","DB_PREFIX",157],["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction` WHERE `securetrading_ws_order_id` = '\"",157],["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_INT_CAST","(int)",157],["T_VARIABLE","$securetrading_ws_order_id",157],["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","\"' AND (`type` = 'payment' OR `type` = 'rebate')\"",157],")",";",["T_WHITESPACE","\n\n\t\t",157],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_DOUBLE_CAST","(double)",159],["T_VARIABLE","$query",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","row",159],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",159],"]",";",["T_WHITESPACE","\n\t",159],"}",["T_WHITESPACE","\n\n\t",160],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","getTotalRebated",162],"(",["T_VARIABLE","$securetrading_ws_order_id",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n\t\t",162],["T_VARIABLE","$query",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","db",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","query",163],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_STRING","DB_PREFIX",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction` WHERE `securetrading_ws_order_id` = '\"",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_INT_CAST","(int)",163],["T_VARIABLE","$securetrading_ws_order_id",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"' AND 'rebate'\"",163],")",";",["T_WHITESPACE","\n\n\t\t",163],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_DOUBLE_CAST","(double)",165],["T_VARIABLE","$query",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","row",165],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",165],"]",";",["T_WHITESPACE","\n\t",165],"}",["T_WHITESPACE","\n\n\t",166],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","increaseRefundedAmount",168],"(",["T_VARIABLE","$order_id",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$amount",168],")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n\t\t",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","db",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","query",169],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE \"",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_STRING","DB_PREFIX",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order SET refunded = refunded + \"",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_DOUBLE_CAST","(double)",169],["T_VARIABLE","$amount",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","\" WHERE order_id = \"",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_INT_CAST","(int)",169],["T_VARIABLE","$order_id",169],")",";",["T_WHITESPACE","\n\t",169],"}",["T_WHITESPACE","\n\n\t",170],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","getCsv",172],"(",["T_VARIABLE","$data",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n\t\t",172],["T_VARIABLE","$ch",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","curl_init",173],"(",")",";",["T_WHITESPACE","\n\n\t\t",173],["T_VARIABLE","$post_data",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_ARRAY","array",175],"(",")",";",["T_WHITESPACE","\n\t\t",175],["T_VARIABLE","$post_data",176],"[",["T_CONSTANT_ENCAPSED_STRING","'sitereferences'",176],"]",["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","config",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","get",176],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_site_reference'",176],")",";",["T_WHITESPACE","\n\t\t",176],["T_VARIABLE","$post_data",177],"[",["T_CONSTANT_ENCAPSED_STRING","'startdate'",177],"]",["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$data",177],"[",["T_CONSTANT_ENCAPSED_STRING","'date_from'",177],"]",";",["T_WHITESPACE","\n\t\t",177],["T_VARIABLE","$post_data",178],"[",["T_CONSTANT_ENCAPSED_STRING","'enddate'",178],"]",["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$data",178],"[",["T_CONSTANT_ENCAPSED_STRING","'date_to'",178],"]",";",["T_WHITESPACE","\n\t\t",178],["T_VARIABLE","$post_data",179],"[",["T_CONSTANT_ENCAPSED_STRING","'accounttypedescriptions'",179],"]",["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'ECOM'",179],";",["T_WHITESPACE","\n\n\t\t",179],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$data",181],"[",["T_CONSTANT_ENCAPSED_STRING","'detail'",181],"]",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n\t\t\t",181],["T_VARIABLE","$post_data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'optionalfields'",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_ARRAY","array",182],"(",["T_WHITESPACE","\n\t\t\t\t",182],["T_CONSTANT_ENCAPSED_STRING","'parenttransactionreference'",183],",",["T_WHITESPACE","\n\t\t\t\t",183],["T_CONSTANT_ENCAPSED_STRING","'accounttypedescription'",184],",",["T_WHITESPACE","\n\t\t\t\t",184],["T_CONSTANT_ENCAPSED_STRING","'requesttypedescription'",185],",",["T_WHITESPACE","\n\t\t\t\t",185],["T_CONSTANT_ENCAPSED_STRING","'mainamount'",186],",",["T_WHITESPACE","\n\t\t\t\t",186],["T_CONSTANT_ENCAPSED_STRING","'currencyiso3a'",187],",",["T_WHITESPACE","\n\t\t\t\t",187],["T_CONSTANT_ENCAPSED_STRING","'errorcode'",188],",",["T_WHITESPACE","\n\t\t\t\t",188],["T_CONSTANT_ENCAPSED_STRING","'authcode'",189],",",["T_WHITESPACE","\n\t\t\t\t",189],["T_CONSTANT_ENCAPSED_STRING","'customerip'",190],",",["T_WHITESPACE","\n\t\t\t\t",190],["T_CONSTANT_ENCAPSED_STRING","'fraudrating'",191],",",["T_WHITESPACE","\n\t\t\t\t",191],["T_CONSTANT_ENCAPSED_STRING","'orderreference'",192],",",["T_WHITESPACE","\n\t\t\t\t",192],["T_CONSTANT_ENCAPSED_STRING","'paymenttypedescription'",193],",",["T_WHITESPACE","\n\t\t\t\t",193],["T_CONSTANT_ENCAPSED_STRING","'maskedpan'",194],",",["T_WHITESPACE","\n\t\t\t\t",194],["T_CONSTANT_ENCAPSED_STRING","'expirydate'",195],",",["T_WHITESPACE","\n\t\t\t\t",195],["T_CONSTANT_ENCAPSED_STRING","'settlestatus'",196],",",["T_WHITESPACE","\n\t\t\t\t",196],["T_CONSTANT_ENCAPSED_STRING","'settlemainamount'",197],",",["T_WHITESPACE","\n\t\t\t\t",197],["T_CONSTANT_ENCAPSED_STRING","'settleduedate'",198],",",["T_WHITESPACE","\n\t\t\t\t",198],["T_CONSTANT_ENCAPSED_STRING","'securityresponsesecuritycode'",199],",",["T_WHITESPACE","\n\t\t\t\t",199],["T_CONSTANT_ENCAPSED_STRING","'securityresponseaddress'",200],",",["T_WHITESPACE","\n\t\t\t\t",200],["T_CONSTANT_ENCAPSED_STRING","'securityresponsepostcode'",201],",",["T_WHITESPACE","\n\t\t\t\t",201],["T_CONSTANT_ENCAPSED_STRING","'billingprefixname'",202],",",["T_WHITESPACE","\n\t\t\t\t",202],["T_CONSTANT_ENCAPSED_STRING","'billingfirstname'",203],",",["T_WHITESPACE","\n\t\t\t\t",203],["T_CONSTANT_ENCAPSED_STRING","'billingmiddlename'",204],",",["T_WHITESPACE","\n\t\t\t\t",204],["T_CONSTANT_ENCAPSED_STRING","'billinglastname'",205],",",["T_WHITESPACE","\n\t\t\t\t",205],["T_CONSTANT_ENCAPSED_STRING","'billingpremise'",206],",",["T_WHITESPACE","\n\t\t\t\t",206],["T_CONSTANT_ENCAPSED_STRING","'billingstreet'",207],",",["T_WHITESPACE","\n\t\t\t\t",207],["T_CONSTANT_ENCAPSED_STRING","'billingtown'",208],",",["T_WHITESPACE","\n\t\t\t\t",208],["T_CONSTANT_ENCAPSED_STRING","'billingcounty'",209],",",["T_WHITESPACE","\n\t\t\t\t",209],["T_CONSTANT_ENCAPSED_STRING","'billingemail'",210],",",["T_WHITESPACE","\n\t\t\t\t",210],["T_CONSTANT_ENCAPSED_STRING","'billingcountryiso2a'",211],",",["T_WHITESPACE","\n\t\t\t\t",211],["T_CONSTANT_ENCAPSED_STRING","'billingpostcode'",212],",",["T_WHITESPACE","\n\t\t\t\t",212],["T_CONSTANT_ENCAPSED_STRING","'billingtelephones'",213],",",["T_WHITESPACE","\n\t\t\t\t",213],["T_CONSTANT_ENCAPSED_STRING","'customerprefixname'",214],",",["T_WHITESPACE","\n\t\t\t\t",214],["T_CONSTANT_ENCAPSED_STRING","'customerfirstname'",215],",",["T_WHITESPACE","\n\t\t\t\t",215],["T_CONSTANT_ENCAPSED_STRING","'customermiddlename'",216],",",["T_WHITESPACE","\n\t\t\t\t",216],["T_CONSTANT_ENCAPSED_STRING","'customerlastname'",217],",",["T_WHITESPACE","\n\t\t\t\t",217],["T_CONSTANT_ENCAPSED_STRING","'customerpremise'",218],",",["T_WHITESPACE","\n\t\t\t\t",218],["T_CONSTANT_ENCAPSED_STRING","'customerstreet'",219],",",["T_WHITESPACE","\n\t\t\t\t",219],["T_CONSTANT_ENCAPSED_STRING","'customertown'",220],",",["T_WHITESPACE","\n\t\t\t\t",220],["T_CONSTANT_ENCAPSED_STRING","'customercounty'",221],",",["T_WHITESPACE","\n\t\t\t\t",221],["T_CONSTANT_ENCAPSED_STRING","'customeremail'",222],",",["T_WHITESPACE","\n\t\t\t\t",222],["T_CONSTANT_ENCAPSED_STRING","'customercountryiso2a'",223],",",["T_WHITESPACE","\n\t\t\t\t",223],["T_CONSTANT_ENCAPSED_STRING","'customerpostcode'",224],",",["T_WHITESPACE","\n\t\t\t\t",224],["T_CONSTANT_ENCAPSED_STRING","'customertelephones'",225],",",["T_WHITESPACE","\n\t\t\t",225],")",";",["T_WHITESPACE","\n\t\t",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n\t\t\t",227],["T_VARIABLE","$post_data",228],"[",["T_CONSTANT_ENCAPSED_STRING","'optionalfields'",228],"]",["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_ARRAY","array",228],"(",["T_WHITESPACE","\n\t\t\t\t",228],["T_CONSTANT_ENCAPSED_STRING","'orderreference'",229],",",["T_WHITESPACE","\n\t\t\t\t",229],["T_CONSTANT_ENCAPSED_STRING","'currencyiso3a'",230],",",["T_WHITESPACE","\n\t\t\t\t",230],["T_CONSTANT_ENCAPSED_STRING","'errorcode'",231],",",["T_WHITESPACE","\n\t\t\t\t",231],["T_CONSTANT_ENCAPSED_STRING","'paymenttypedescription'",232],",",["T_WHITESPACE","\n\t\t\t\t",232],["T_CONSTANT_ENCAPSED_STRING","'settlestatus'",233],",",["T_WHITESPACE","\n\t\t\t\t",233],["T_CONSTANT_ENCAPSED_STRING","'requesttypedescription'",234],",",["T_WHITESPACE","\n\t\t\t\t",234],["T_CONSTANT_ENCAPSED_STRING","'mainamount'",235],",",["T_WHITESPACE","\n\t\t\t\t",235],["T_CONSTANT_ENCAPSED_STRING","'billingfirstname'",236],",",["T_WHITESPACE","\n\t\t\t\t",236],["T_CONSTANT_ENCAPSED_STRING","'billinglastname'",237],",",["T_WHITESPACE","\n\t\t\t",237],")",";",["T_WHITESPACE","\n\t\t",238],"}",["T_WHITESPACE","\n\n\t\t",239],["T_IF","if",241],["T_WHITESPACE"," ",241],"(",["T_ISSET","isset",241],"(",["T_VARIABLE","$data",241],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",241],"]",")",["T_WHITESPACE"," ",241],["T_BOOLEAN_AND","&&",241],["T_WHITESPACE"," ",241],"!",["T_EMPTY","empty",241],"(",["T_VARIABLE","$data",241],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",241],"]",")",")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n\t\t\t",241],["T_VARIABLE","$post_data",242],"[",["T_CONSTANT_ENCAPSED_STRING","'currencyiso3as'",242],"]",["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_VARIABLE","$data",242],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",242],"]",";",["T_WHITESPACE","\n\t\t",242],"}",["T_WHITESPACE","\n\n\t\t",243],["T_IF","if",245],["T_WHITESPACE"," ",245],"(",["T_ISSET","isset",245],"(",["T_VARIABLE","$data",245],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",245],"]",")",["T_WHITESPACE"," ",245],["T_BOOLEAN_AND","&&",245],["T_WHITESPACE"," ",245],"!",["T_EMPTY","empty",245],"(",["T_VARIABLE","$data",245],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",245],"]",")",")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n\t\t\t",245],["T_VARIABLE","$post_data",246],"[",["T_CONSTANT_ENCAPSED_STRING","'errorcodes'",246],"]",["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$data",246],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",246],"]",";",["T_WHITESPACE","\n\t\t",246],"}",["T_WHITESPACE","\n\n\t\t",247],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_ISSET","isset",249],"(",["T_VARIABLE","$data",249],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_type'",249],"]",")",["T_WHITESPACE"," ",249],["T_BOOLEAN_AND","&&",249],["T_WHITESPACE"," ",249],"!",["T_EMPTY","empty",249],"(",["T_VARIABLE","$data",249],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_type'",249],"]",")",")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n\t\t\t",249],["T_VARIABLE","$post_data",250],"[",["T_CONSTANT_ENCAPSED_STRING","'paymenttypedescriptions'",250],"]",["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$data",250],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_type'",250],"]",";",["T_WHITESPACE","\n\t\t",250],"}",["T_WHITESPACE","\n\n\t\t",251],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_ISSET","isset",253],"(",["T_VARIABLE","$data",253],"[",["T_CONSTANT_ENCAPSED_STRING","'request'",253],"]",")",["T_WHITESPACE"," ",253],["T_BOOLEAN_AND","&&",253],["T_WHITESPACE"," ",253],"!",["T_EMPTY","empty",253],"(",["T_VARIABLE","$data",253],"[",["T_CONSTANT_ENCAPSED_STRING","'request'",253],"]",")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n\t\t\t",253],["T_VARIABLE","$post_data",254],"[",["T_CONSTANT_ENCAPSED_STRING","'requesttypedescriptions'",254],"]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$data",254],"[",["T_CONSTANT_ENCAPSED_STRING","'request'",254],"]",";",["T_WHITESPACE","\n\t\t",254],"}",["T_WHITESPACE","\n\n\t\t",255],["T_IF","if",257],["T_WHITESPACE"," ",257],"(",["T_ISSET","isset",257],"(",["T_VARIABLE","$data",257],"[",["T_CONSTANT_ENCAPSED_STRING","'settle_status'",257],"]",")",["T_WHITESPACE"," ",257],["T_BOOLEAN_AND","&&",257],["T_WHITESPACE"," ",257],"!",["T_EMPTY","empty",257],"(",["T_VARIABLE","$data",257],"[",["T_CONSTANT_ENCAPSED_STRING","'settle_status'",257],"]",")",")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n\t\t\t",257],["T_VARIABLE","$post_data",258],"[",["T_CONSTANT_ENCAPSED_STRING","'settlestatuss'",258],"]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$data",258],"[",["T_CONSTANT_ENCAPSED_STRING","'settle_status'",258],"]",";",["T_WHITESPACE","\n\t\t",258],"}",["T_WHITESPACE","\n\n\t\t",259],["T_VARIABLE","$defaults",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_ARRAY","array",261],"(",["T_WHITESPACE","\n\t\t\t",261],["T_STRING","CURLOPT_POST",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_LNUMBER","1",262],",",["T_WHITESPACE","\n\t\t\t",262],["T_STRING","CURLOPT_HEADER",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_LNUMBER","0",263],",",["T_WHITESPACE","\n\t\t\t",263],["T_STRING","CURLOPT_SSL_VERIFYPEER",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_LNUMBER","0",264],",",["T_WHITESPACE","\n\t\t\t",264],["T_STRING","CURLOPT_URL",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/myst.securetrading.net\/auto\/transactions\/transactionsearch'",265],",",["T_WHITESPACE","\n\t\t\t",265],["T_STRING","CURLOPT_FRESH_CONNECT",266],["T_WHITESPACE"," ",266],["T_DOUBLE_ARROW","=>",266],["T_WHITESPACE"," ",266],["T_LNUMBER","1",266],",",["T_WHITESPACE","\n\t\t\t",266],["T_STRING","CURLOPT_RETURNTRANSFER",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_LNUMBER","1",267],",",["T_WHITESPACE","\n\t\t\t",267],["T_STRING","CURLOPT_FORBID_REUSE",268],["T_WHITESPACE"," ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_LNUMBER","1",268],",",["T_WHITESPACE","\n\t\t\t",268],["T_STRING","CURLOPT_TIMEOUT",269],["T_WHITESPACE"," ",269],["T_DOUBLE_ARROW","=>",269],["T_WHITESPACE"," ",269],["T_LNUMBER","15",269],",",["T_WHITESPACE","\n\t\t\t",269],["T_STRING","CURLOPT_HTTPHEADER",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_ARRAY","array",270],"(",["T_WHITESPACE","\n\t\t\t\t",270],["T_CONSTANT_ENCAPSED_STRING","'User-Agent: OpenCart - Secure Trading WS'",271],",",["T_WHITESPACE","\n\t\t\t\t",271],["T_CONSTANT_ENCAPSED_STRING","'Authorization: Basic '",272],["T_WHITESPACE"," ",272],".",["T_WHITESPACE"," ",272],["T_STRING","base64_encode",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","config",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","get",272],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_csv_username'",272],")",["T_WHITESPACE"," ",272],".",["T_WHITESPACE"," ",272],["T_CONSTANT_ENCAPSED_STRING","':'",272],["T_WHITESPACE"," ",272],".",["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","config",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","get",272],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_csv_password'",272],")",")",",",["T_WHITESPACE","\n\t\t\t",272],")",",",["T_WHITESPACE","\n\t\t\t",273],["T_STRING","CURLOPT_POSTFIELDS",274],["T_WHITESPACE"," ",274],["T_DOUBLE_ARROW","=>",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","encodePost",274],"(",["T_VARIABLE","$post_data",274],")",",",["T_WHITESPACE","\n\t\t",274],")",";",["T_WHITESPACE","\n\n\t\t",275],["T_STRING","curl_setopt_array",277],"(",["T_VARIABLE","$ch",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$defaults",277],")",";",["T_WHITESPACE","\n\n\t\t",277],["T_VARIABLE","$response",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_STRING","curl_exec",279],"(",["T_VARIABLE","$ch",279],")",";",["T_WHITESPACE","\n\n\t\t",279],["T_IF","if",281],["T_WHITESPACE"," ",281],"(",["T_VARIABLE","$response",281],["T_WHITESPACE"," ",281],["T_IS_IDENTICAL","===",281],["T_WHITESPACE"," ",281],["T_STRING","false",281],")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n\t\t\t",281],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","log",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","write",282],"(",["T_CONSTANT_ENCAPSED_STRING","'Secure Trading WS CURL Error: ('",282],["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_STRING","curl_errno",282],"(",["T_VARIABLE","$ch",282],")",["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","') '",282],["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_STRING","curl_error",282],"(",["T_VARIABLE","$ch",282],")",")",";",["T_WHITESPACE","\n\t\t",282],"}",["T_WHITESPACE","\n\n\t\t",283],["T_STRING","curl_close",285],"(",["T_VARIABLE","$ch",285],")",";",["T_WHITESPACE","\n\n\t\t",285],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_EMPTY","empty",287],"(",["T_VARIABLE","$response",287],")",["T_WHITESPACE"," ",287],["T_BOOLEAN_OR","||",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$response",287],["T_WHITESPACE"," ",287],["T_IS_IDENTICAL","===",287],["T_WHITESPACE"," ",287],["T_CONSTANT_ENCAPSED_STRING","'No records found for search'",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n\t\t\t",287],["T_RETURN","return",288],["T_WHITESPACE"," ",288],["T_STRING","false",288],";",["T_WHITESPACE","\n\t\t",288],"}",["T_WHITESPACE","\n\n\t\t",289],["T_IF","if",291],["T_WHITESPACE"," ",291],"(",["T_STRING","preg_match",291],"(",["T_CONSTANT_ENCAPSED_STRING","'\/401 Authorization Required\/'",291],",",["T_WHITESPACE"," ",291],["T_VARIABLE","$response",291],")",")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n\t\t\t",291],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_STRING","false",292],";",["T_WHITESPACE","\n\t\t",292],"}",["T_WHITESPACE","\n\n\t\t",293],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$response",295],";",["T_WHITESPACE","\n\t",295],"}",["T_WHITESPACE","\n\n\t",296],["T_PRIVATE","private",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","encodePost",298],"(",["T_VARIABLE","$data",298],")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n\t\t",298],["T_VARIABLE","$params",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_ARRAY","array",299],"(",")",";",["T_WHITESPACE","\n\n\t\t",299],["T_FOREACH","foreach",301],["T_WHITESPACE"," ",301],"(",["T_VARIABLE","$data",301],["T_WHITESPACE"," ",301],["T_AS","as",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$key",301],["T_WHITESPACE"," ",301],["T_DOUBLE_ARROW","=>",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$value",301],")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n\t\t\t",301],["T_IF","if",302],["T_WHITESPACE"," ",302],"(",["T_STRING","is_array",302],"(",["T_VARIABLE","$value",302],")",")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n\t\t\t\t",302],["T_FOREACH","foreach",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$value",303],["T_WHITESPACE"," ",303],["T_AS","as",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$v",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n\t\t\t\t\t",303],["T_VARIABLE","$params",304],"[","]",["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$key",304],["T_WHITESPACE"," ",304],".",["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'='",304],["T_WHITESPACE"," ",304],".",["T_WHITESPACE"," ",304],["T_STRING","rawurlencode",304],"(",["T_VARIABLE","$v",304],")",";",["T_WHITESPACE","\n\t\t\t\t",304],"}",["T_WHITESPACE","\n\t\t\t",305],"}",["T_WHITESPACE"," ",306],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n\t\t\t\t",306],["T_VARIABLE","$params",307],"[","]",["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$key",307],["T_WHITESPACE"," ",307],".",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'='",307],["T_WHITESPACE"," ",307],".",["T_WHITESPACE"," ",307],["T_STRING","rawurlencode",307],"(",["T_VARIABLE","$value",307],")",";",["T_WHITESPACE","\n\t\t\t",307],"}",["T_WHITESPACE","\n\t\t",308],"}",["T_WHITESPACE","\n\n\t\t",309],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_STRING","implode",311],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",311],",",["T_WHITESPACE"," ",311],["T_VARIABLE","$params",311],")",";",["T_WHITESPACE","\n\t",311],"}",["T_WHITESPACE","\n\n\t",312],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","call",314],"(",["T_VARIABLE","$data",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n\t\t",314],["T_VARIABLE","$ch",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_STRING","curl_init",315],"(",")",";",["T_WHITESPACE","\n\n\t\t",315],["T_VARIABLE","$defaults",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_ARRAY","array",317],"(",["T_WHITESPACE","\n\t\t\t",317],["T_STRING","CURLOPT_POST",318],["T_WHITESPACE"," ",318],["T_DOUBLE_ARROW","=>",318],["T_WHITESPACE"," ",318],["T_LNUMBER","1",318],",",["T_WHITESPACE","\n\t\t\t",318],["T_STRING","CURLOPT_HEADER",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_LNUMBER","0",319],",",["T_WHITESPACE","\n\t\t\t",319],["T_STRING","CURLOPT_SSL_VERIFYPEER",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_LNUMBER","0",320],",",["T_WHITESPACE","\n\t\t\t",320],["T_STRING","CURLOPT_URL",321],["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/webservices.securetrading.net\/xml\/'",321],",",["T_WHITESPACE","\n\t\t\t",321],["T_STRING","CURLOPT_FRESH_CONNECT",322],["T_WHITESPACE"," ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_LNUMBER","1",322],",",["T_WHITESPACE","\n\t\t\t",322],["T_STRING","CURLOPT_RETURNTRANSFER",323],["T_WHITESPACE"," ",323],["T_DOUBLE_ARROW","=>",323],["T_WHITESPACE"," ",323],["T_LNUMBER","1",323],",",["T_WHITESPACE","\n\t\t\t",323],["T_STRING","CURLOPT_FORBID_REUSE",324],["T_WHITESPACE"," ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_LNUMBER","1",324],",",["T_WHITESPACE","\n\t\t\t",324],["T_STRING","CURLOPT_TIMEOUT",325],["T_WHITESPACE"," ",325],["T_DOUBLE_ARROW","=>",325],["T_WHITESPACE"," ",325],["T_LNUMBER","15",325],",",["T_WHITESPACE","\n\t\t\t",325],["T_STRING","CURLOPT_HTTPHEADER",326],["T_WHITESPACE"," ",326],["T_DOUBLE_ARROW","=>",326],["T_WHITESPACE"," ",326],["T_ARRAY","array",326],"(",["T_WHITESPACE","\n\t\t\t\t",326],["T_CONSTANT_ENCAPSED_STRING","'User-Agent: OpenCart - Secure Trading WS'",327],",",["T_WHITESPACE","\n\t\t\t\t",327],["T_CONSTANT_ENCAPSED_STRING","'Content-Length: '",328],["T_WHITESPACE"," ",328],".",["T_WHITESPACE"," ",328],["T_STRING","strlen",328],"(",["T_VARIABLE","$data",328],")",",",["T_WHITESPACE","\n\t\t\t\t",328],["T_CONSTANT_ENCAPSED_STRING","'Authorization: Basic '",329],["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_STRING","base64_encode",329],"(",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","config",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_username'",329],")",["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","':'",329],["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","config",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_password'",329],")",")",",",["T_WHITESPACE","\n\t\t\t",329],")",",",["T_WHITESPACE","\n\t\t\t",330],["T_STRING","CURLOPT_POSTFIELDS",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$data",331],",",["T_WHITESPACE","\n\t\t",331],")",";",["T_WHITESPACE","\n\n\t\t",332],["T_STRING","curl_setopt_array",334],"(",["T_VARIABLE","$ch",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$defaults",334],")",";",["T_WHITESPACE","\n\n\t\t",334],["T_VARIABLE","$response",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_STRING","curl_exec",336],"(",["T_VARIABLE","$ch",336],")",";",["T_WHITESPACE","\n\n\t\t",336],["T_IF","if",338],["T_WHITESPACE"," ",338],"(",["T_VARIABLE","$response",338],["T_WHITESPACE"," ",338],["T_IS_IDENTICAL","===",338],["T_WHITESPACE"," ",338],["T_STRING","false",338],")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n\t\t\t",338],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","log",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","write",339],"(",["T_CONSTANT_ENCAPSED_STRING","'Secure Trading WS CURL Error: ('",339],["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_STRING","curl_errno",339],"(",["T_VARIABLE","$ch",339],")",["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","') '",339],["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_STRING","curl_error",339],"(",["T_VARIABLE","$ch",339],")",")",";",["T_WHITESPACE","\n\t\t",339],"}",["T_WHITESPACE","\n\n\t\t",340],["T_STRING","curl_close",342],"(",["T_VARIABLE","$ch",342],")",";",["T_WHITESPACE","\n\n\t\t",342],["T_RETURN","return",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$response",344],";",["T_WHITESPACE","\n\t",344],"}",["T_WHITESPACE","\n\n\t",345],["T_PUBLIC","public",347],["T_WHITESPACE"," ",347],["T_FUNCTION","function",347],["T_WHITESPACE"," ",347],["T_STRING","logger",347],"(",["T_VARIABLE","$message",347],")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n\t\t",347],["T_VARIABLE","$log",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_NEW","new",348],["T_WHITESPACE"," ",348],["T_STRING","Log",348],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws.log'",348],")",";",["T_WHITESPACE","\n\t\t",348],["T_VARIABLE","$log",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","write",349],"(",["T_VARIABLE","$message",349],")",";",["T_WHITESPACE","\n\t",349],"}",["T_WHITESPACE","\n",350],"}"]