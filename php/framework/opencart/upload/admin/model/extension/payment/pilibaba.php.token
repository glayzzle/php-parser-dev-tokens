[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentPilibaba",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","install",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"CREATE TABLE IF NOT EXISTS `\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_STRING","DB_PREFIX",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"pilibaba_order` (\n\t\t\t`pilibaba_order_id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t`order_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t`amount` double NOT NULL,\n\t\t\t`fee` double NOT NULL,\n\t\t\t`tracking` VARCHAR(50) NOT NULL DEFAULT '',\n\t\t\t`date_added` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',\n\t\t\tPRIMARY KEY (`pilibaba_order_id`)\n\t\t) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci\"",4],")",";",["T_WHITESPACE","\n\t",12],"}",["T_WHITESPACE","\n\n\t",13],["T_PUBLIC","public",15],["T_WHITESPACE"," ",15],["T_FUNCTION","function",15],["T_WHITESPACE"," ",15],["T_STRING","uninstall",15],"(",")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\t\t",15],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","db",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","query",16],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_STRING","DB_PREFIX",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","\"pilibaba_order`\"",16],")",";",["T_WHITESPACE","\n\n\t\t",16],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","disablePiliExpress",18],"(",")",";",["T_WHITESPACE","\n\n\t\t",18],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","log",20],"(",["T_CONSTANT_ENCAPSED_STRING","'Module uninstalled'",20],")",";",["T_WHITESPACE","\n\t",20],"}",["T_WHITESPACE","\n\n\t",21],["T_PUBLIC","public",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","getCurrencies",23],"(",")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\t\t",23],["T_VARIABLE","$ch",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","curl_init",24],"(",")",";",["T_WHITESPACE","\n\t\t",24],["T_STRING","curl_setopt",25],"(",["T_VARIABLE","$ch",25],",",["T_WHITESPACE"," ",25],["T_STRING","CURLOPT_URL",25],",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.pilibaba.com\/pilipay\/getCurrency'",25],")",";",["T_WHITESPACE","\n\t\t",25],["T_STRING","curl_setopt",26],"(",["T_VARIABLE","$ch",26],",",["T_WHITESPACE"," ",26],["T_STRING","CURLOPT_CUSTOMREQUEST",26],",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'GET'",26],")",";",["T_WHITESPACE","\n\t\t",26],["T_STRING","curl_setopt",27],"(",["T_VARIABLE","$ch",27],",",["T_WHITESPACE"," ",27],["T_STRING","CURLOPT_RETURNTRANSFER",27],",",["T_WHITESPACE"," ",27],["T_STRING","true",27],")",";",["T_WHITESPACE","\n\t\t",27],["T_STRING","curl_setopt",28],"(",["T_VARIABLE","$ch",28],",",["T_WHITESPACE"," ",28],["T_STRING","CURLOPT_HEADER",28],",",["T_WHITESPACE"," ",28],["T_STRING","false",28],")",";",["T_WHITESPACE","\n\t\t",28],["T_STRING","curl_setopt",29],"(",["T_VARIABLE","$ch",29],",",["T_WHITESPACE"," ",29],["T_STRING","CURLOPT_TIMEOUT",29],",",["T_WHITESPACE"," ",29],["T_LNUMBER","30",29],")",";",["T_WHITESPACE","\n\t\t",29],["T_STRING","curl_setopt",30],"(",["T_VARIABLE","$ch",30],",",["T_WHITESPACE"," ",30],["T_STRING","CURLOPT_SSL_VERIFYPEER",30],",",["T_WHITESPACE"," ",30],["T_STRING","false",30],")",";",["T_WHITESPACE","\n\t\t",30],["T_VARIABLE","$response",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","curl_exec",31],"(",["T_VARIABLE","$ch",31],")",";",["T_WHITESPACE","\n\t\t",31],["T_STRING","curl_close",32],"(",["T_VARIABLE","$ch",32],")",";",["T_WHITESPACE","\n\n\t\t",32],["T_RETURN","return",34],["T_WHITESPACE"," ",34],["T_STRING","json_decode",34],"(",["T_VARIABLE","$response",34],",",["T_WHITESPACE"," ",34],["T_STRING","true",34],")",";",["T_WHITESPACE","\n\t",34],"}",["T_WHITESPACE","\n\n\t",35],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","getWarehouses",37],"(",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n\t\t",37],["T_VARIABLE","$ch",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","curl_init",38],"(",")",";",["T_WHITESPACE","\n\t\t",38],["T_STRING","curl_setopt",39],"(",["T_VARIABLE","$ch",39],",",["T_WHITESPACE"," ",39],["T_STRING","CURLOPT_URL",39],",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.pilibaba.com\/pilipay\/getAddressList'",39],")",";",["T_WHITESPACE","\n\t\t",39],["T_STRING","curl_setopt",40],"(",["T_VARIABLE","$ch",40],",",["T_WHITESPACE"," ",40],["T_STRING","CURLOPT_CUSTOMREQUEST",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'GET'",40],")",";",["T_WHITESPACE","\n\t\t",40],["T_STRING","curl_setopt",41],"(",["T_VARIABLE","$ch",41],",",["T_WHITESPACE"," ",41],["T_STRING","CURLOPT_RETURNTRANSFER",41],",",["T_WHITESPACE"," ",41],["T_STRING","true",41],")",";",["T_WHITESPACE","\n\t\t",41],["T_STRING","curl_setopt",42],"(",["T_VARIABLE","$ch",42],",",["T_WHITESPACE"," ",42],["T_STRING","CURLOPT_HEADER",42],",",["T_WHITESPACE"," ",42],["T_STRING","false",42],")",";",["T_WHITESPACE","\n\t\t",42],["T_STRING","curl_setopt",43],"(",["T_VARIABLE","$ch",43],",",["T_WHITESPACE"," ",43],["T_STRING","CURLOPT_TIMEOUT",43],",",["T_WHITESPACE"," ",43],["T_LNUMBER","30",43],")",";",["T_WHITESPACE","\n\t\t",43],["T_STRING","curl_setopt",44],"(",["T_VARIABLE","$ch",44],",",["T_WHITESPACE"," ",44],["T_STRING","CURLOPT_SSL_VERIFYPEER",44],",",["T_WHITESPACE"," ",44],["T_STRING","false",44],")",";",["T_WHITESPACE","\n\t\t",44],["T_VARIABLE","$response",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","curl_exec",45],"(",["T_VARIABLE","$ch",45],")",";",["T_WHITESPACE","\n\t\t",45],["T_STRING","curl_close",46],"(",["T_VARIABLE","$ch",46],")",";",["T_WHITESPACE","\n\n\t\t",46],["T_RETURN","return",48],["T_WHITESPACE"," ",48],["T_STRING","json_decode",48],"(",["T_VARIABLE","$response",48],",",["T_WHITESPACE"," ",48],["T_STRING","true",48],")",";",["T_WHITESPACE","\n\t",48],"}",["T_WHITESPACE","\n\n\t",49],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","getOrder",51],"(",["T_VARIABLE","$order_id",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n\t\t",51],["T_VARIABLE","$query",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","db",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","query",52],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_STRING","DB_PREFIX",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","\"pilibaba_order` WHERE `order_id` = '\"",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_INT_CAST","(int)",52],["T_VARIABLE","$order_id",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",52],")",";",["T_WHITESPACE","\n\n\t\t",52],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$query",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","num_rows",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n\t\t\t",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$query",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","row",55],";",["T_WHITESPACE","\n\t\t",55],"}",["T_WHITESPACE"," ",56],["T_ELSE","else",56],["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n\t\t\t",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_STRING","false",57],";",["T_WHITESPACE","\n\t\t",57],"}",["T_WHITESPACE","\n\t",58],"}",["T_WHITESPACE","\n\n\t",59],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","register",61],"(",["T_VARIABLE","$email",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$password",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$currency",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$warehouse",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$country",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$environment",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n\t\t",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","log",62],"(",["T_CONSTANT_ENCAPSED_STRING","'Posting register'",62],")",";",["T_WHITESPACE","\n\n\t\t",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$warehouse",64],["T_WHITESPACE"," ",64],["T_IS_EQUAL","==",64],["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'other'",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n\t\t\t",64],["T_VARIABLE","$warehouse",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","''",65],";",["T_WHITESPACE","\n\t\t",65],"}",["T_WHITESPACE","\n\n\t\t",66],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$warehouse",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n\t\t\t",68],["T_VARIABLE","$country",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","''",69],";",["T_WHITESPACE","\n\t\t",69],"}",["T_WHITESPACE","\n\n\t\t",70],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$environment",72],["T_WHITESPACE"," ",72],["T_IS_EQUAL","==",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'live'",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n\t\t\t",72],["T_VARIABLE","$url",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/en.pilibaba.com\/autoRegist'",73],";",["T_WHITESPACE","\n\t\t",73],"}",["T_WHITESPACE"," ",74],["T_ELSE","else",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$url",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/preen.pilibaba.com\/autoRegist'",75],";",["T_WHITESPACE","\n\t\t",75],"}",["T_WHITESPACE","\n\n\t\t",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","log",78],"(",["T_CONSTANT_ENCAPSED_STRING","'URL: '",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_VARIABLE","$url",78],")",";",["T_WHITESPACE","\n\n\t\t",78],["T_VARIABLE","$app_secret",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","strtoupper",80],"(",["T_STRING","md5",80],"(","(","(",["T_VARIABLE","$warehouse",80],")",["T_WHITESPACE"," ",80],"?",["T_WHITESPACE"," ",80],["T_VARIABLE","$warehouse",80],["T_WHITESPACE"," ",80],":",["T_WHITESPACE"," ",80],["T_VARIABLE","$country",80],")",["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'0210000574'",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'0b8l3ww5'",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$currency",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$email",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_STRING","md5",80],"(",["T_VARIABLE","$password",80],")",")",")",";",["T_WHITESPACE","\n\n\t\t",80],["T_VARIABLE","$data",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_ARRAY","array",82],"(",["T_WHITESPACE","\n\t\t\t",82],["T_CONSTANT_ENCAPSED_STRING","'platformNo'",83],["T_WHITESPACE","  ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'0210000574'",83],",",["T_WHITESPACE","\n\t\t\t",83],["T_CONSTANT_ENCAPSED_STRING","'appSecret'",84],["T_WHITESPACE","   ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$app_secret",84],",",["T_WHITESPACE","\n\t\t\t",84],["T_CONSTANT_ENCAPSED_STRING","'email'",85],["T_WHITESPACE","       ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$email",85],",",["T_WHITESPACE","\n\t\t\t",85],["T_CONSTANT_ENCAPSED_STRING","'password'",86],["T_WHITESPACE","    ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","md5",86],"(",["T_VARIABLE","$password",86],")",",",["T_WHITESPACE","\n\t\t\t",86],["T_CONSTANT_ENCAPSED_STRING","'currency'",87],["T_WHITESPACE","    ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$currency",87],",",["T_WHITESPACE","\n\t\t\t",87],["T_CONSTANT_ENCAPSED_STRING","'logistics'",88],["T_WHITESPACE","   ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$warehouse",88],",",["T_WHITESPACE","\n\t\t\t",88],["T_CONSTANT_ENCAPSED_STRING","'countryCode'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$country",89],["T_WHITESPACE","\n\t\t",89],")",";",["T_WHITESPACE","\n\n\t\t",90],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","log",92],"(",["T_CONSTANT_ENCAPSED_STRING","'Data: '",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_STRING","print_r",92],"(",["T_VARIABLE","$data",92],",",["T_WHITESPACE"," ",92],["T_STRING","true",92],")",")",";",["T_WHITESPACE","\n\n\t\t",92],["T_VARIABLE","$headers",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Accept: application\/json'",94],",",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",94],")",";",["T_WHITESPACE","\n\n\t\t",94],["T_VARIABLE","$ch",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","curl_init",96],"(",")",";",["T_WHITESPACE","\n\t\t",96],["T_STRING","curl_setopt",97],"(",["T_VARIABLE","$ch",97],",",["T_WHITESPACE"," ",97],["T_STRING","CURLOPT_URL",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$url",97],")",";",["T_WHITESPACE","\n\t\t",97],["T_STRING","curl_setopt",98],"(",["T_VARIABLE","$ch",98],",",["T_WHITESPACE"," ",98],["T_STRING","CURLOPT_POST",98],",",["T_WHITESPACE"," ",98],["T_STRING","true",98],")",";",["T_WHITESPACE","\n\t\t",98],["T_STRING","curl_setopt",99],"(",["T_VARIABLE","$ch",99],",",["T_WHITESPACE"," ",99],["T_STRING","CURLOPT_POSTFIELDS",99],",",["T_WHITESPACE"," ",99],["T_STRING","json_encode",99],"(",["T_VARIABLE","$data",99],")",")",";",["T_WHITESPACE","\n\t\t",99],["T_STRING","curl_setopt",100],"(",["T_VARIABLE","$ch",100],",",["T_WHITESPACE"," ",100],["T_STRING","CURLOPT_RETURNTRANSFER",100],",",["T_WHITESPACE"," ",100],["T_STRING","true",100],")",";",["T_WHITESPACE","\n\t\t",100],["T_STRING","curl_setopt",101],"(",["T_VARIABLE","$ch",101],",",["T_WHITESPACE"," ",101],["T_STRING","CURLOPT_HTTPHEADER",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$headers",101],")",";",["T_WHITESPACE","\n\t\t",101],["T_STRING","curl_setopt",102],"(",["T_VARIABLE","$ch",102],",",["T_WHITESPACE"," ",102],["T_STRING","CURLOPT_TIMEOUT",102],",",["T_WHITESPACE"," ",102],["T_LNUMBER","30",102],")",";",["T_WHITESPACE","\n\t\t",102],["T_STRING","curl_setopt",103],"(",["T_VARIABLE","$ch",103],",",["T_WHITESPACE"," ",103],["T_STRING","CURLOPT_SSL_VERIFYPEER",103],",",["T_WHITESPACE"," ",103],["T_STRING","false",103],")",";",["T_WHITESPACE","\n\t\t",103],["T_VARIABLE","$response",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","curl_exec",104],"(",["T_VARIABLE","$ch",104],")",";",["T_WHITESPACE","\n\t\t",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_STRING","curl_errno",105],"(",["T_VARIABLE","$ch",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n\t\t\t",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","log",106],"(",["T_CONSTANT_ENCAPSED_STRING","'cURL error: '",106],["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_STRING","curl_errno",106],"(",["T_VARIABLE","$ch",106],")",")",";",["T_WHITESPACE","\n\t\t",106],"}",["T_WHITESPACE","\n\t\t",107],["T_STRING","curl_close",108],"(",["T_VARIABLE","$ch",108],")",";",["T_WHITESPACE","\n\n\t\t",108],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","log",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Response: '",110],["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_STRING","print_r",110],"(",["T_VARIABLE","$response",110],",",["T_WHITESPACE"," ",110],["T_STRING","true",110],")",")",";",["T_WHITESPACE","\n\n\t\t",110],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_STRING","json_decode",112],"(",["T_VARIABLE","$response",112],",",["T_WHITESPACE"," ",112],["T_STRING","true",112],")",";",["T_WHITESPACE","\n\t",112],"}",["T_WHITESPACE","\n\n\t",113],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","updateTrackingNumber",115],"(",["T_VARIABLE","$order_id",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$tracking_number",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$merchant_number",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n\t\t",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","log",116],"(",["T_CONSTANT_ENCAPSED_STRING","'Posting tracking'",116],")",";",["T_WHITESPACE","\n\n\t\t",116],["T_VARIABLE","$sign_msg",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","strtoupper",118],"(",["T_STRING","md5",118],"(",["T_VARIABLE","$order_id",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$tracking_number",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$merchant_number",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","config",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","get",118],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_secret_key'",118],")",")",")",";",["T_WHITESPACE","\n\n\t\t",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","config",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","get",120],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_environment'",120],")",["T_WHITESPACE"," ",120],["T_IS_EQUAL","==",120],["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'live'",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n\t\t\t",120],["T_VARIABLE","$url",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.pilibaba.com\/pilipay\/updateTrackNo'",121],";",["T_WHITESPACE","\n\t\t",121],"}",["T_WHITESPACE"," ",122],["T_ELSE","else",122],["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n\t\t\t",122],["T_VARIABLE","$url",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/pre.pilibaba.com\/pilipay\/updateTrackNo'",123],";",["T_WHITESPACE","\n\t\t",123],"}",["T_WHITESPACE","\n\n\t\t",124],["T_VARIABLE","$url",126],["T_WHITESPACE"," ",126],["T_CONCAT_EQUAL",".=",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'?orderNo='",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_VARIABLE","$order_id",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'&logisticsNo='",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_VARIABLE","$tracking_number",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'&merchantNo='",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_VARIABLE","$merchant_number",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'&signMsg='",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_VARIABLE","$sign_msg",126],";",["T_WHITESPACE","\n\n\t\t",126],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","log",128],"(",["T_CONSTANT_ENCAPSED_STRING","'URL: '",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_VARIABLE","$url",128],")",";",["T_WHITESPACE","\n\n\t\t",128],["T_VARIABLE","$ch",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","curl_init",130],"(",")",";",["T_WHITESPACE","\n\t\t",130],["T_STRING","curl_setopt",131],"(",["T_VARIABLE","$ch",131],",",["T_WHITESPACE"," ",131],["T_STRING","CURLOPT_URL",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$url",131],")",";",["T_WHITESPACE","\n\t\t",131],["T_STRING","curl_setopt",132],"(",["T_VARIABLE","$ch",132],",",["T_WHITESPACE"," ",132],["T_STRING","CURLOPT_CUSTOMREQUEST",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'GET'",132],")",";",["T_WHITESPACE","\n\t\t",132],["T_STRING","curl_setopt",133],"(",["T_VARIABLE","$ch",133],",",["T_WHITESPACE"," ",133],["T_STRING","CURLOPT_RETURNTRANSFER",133],",",["T_WHITESPACE"," ",133],["T_STRING","true",133],")",";",["T_WHITESPACE","\n\t\t",133],["T_STRING","curl_setopt",134],"(",["T_VARIABLE","$ch",134],",",["T_WHITESPACE"," ",134],["T_STRING","CURLOPT_HEADER",134],",",["T_WHITESPACE"," ",134],["T_STRING","false",134],")",";",["T_WHITESPACE","\n\t\t",134],["T_STRING","curl_setopt",135],"(",["T_VARIABLE","$ch",135],",",["T_WHITESPACE"," ",135],["T_STRING","CURLOPT_TIMEOUT",135],",",["T_WHITESPACE"," ",135],["T_LNUMBER","30",135],")",";",["T_WHITESPACE","\n\t\t",135],["T_STRING","curl_setopt",136],"(",["T_VARIABLE","$ch",136],",",["T_WHITESPACE"," ",136],["T_STRING","CURLOPT_SSL_VERIFYPEER",136],",",["T_WHITESPACE"," ",136],["T_STRING","false",136],")",";",["T_WHITESPACE","\n\t\t",136],["T_VARIABLE","$response",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","curl_exec",137],"(",["T_VARIABLE","$ch",137],")",";",["T_WHITESPACE","\n\t\t",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_STRING","curl_errno",138],"(",["T_VARIABLE","$ch",138],")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n\t\t\t",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","log",139],"(",["T_CONSTANT_ENCAPSED_STRING","'cURL error: '",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_STRING","curl_errno",139],"(",["T_VARIABLE","$ch",139],")",")",";",["T_WHITESPACE","\n\t\t",139],"}",["T_WHITESPACE","\n\t\t",140],["T_STRING","curl_close",141],"(",["T_VARIABLE","$ch",141],")",";",["T_WHITESPACE","\n\n\t\t",141],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","query",143],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_STRING","DB_PREFIX",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"pilibaba_order` SET `tracking` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","escape",143],"(",["T_VARIABLE","$tracking_number",143],")",["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `order_id` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_INT_CAST","(int)",143],["T_VARIABLE","$order_id",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"'\"",143],")",";",["T_WHITESPACE","\n\t",143],"}",["T_WHITESPACE","\n\n\t",144],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","enablePiliExpress",146],"(",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n\t\t",146],["T_VARIABLE","$query",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","db",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","query",147],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_STRING","DB_PREFIX",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","\"extension` WHERE `type` = 'shipping' AND `code` = 'pilibaba'\"",147],")",";",["T_WHITESPACE","\n\n\t\t",147],["T_IF","if",149],["T_WHITESPACE"," ",149],"(","!",["T_VARIABLE","$query",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","num_rows",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n\t\t\t",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","db",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","query",150],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",150],["T_WHITESPACE"," ",150],".",["T_WHITESPACE"," ",150],["T_STRING","DB_PREFIX",150],["T_WHITESPACE"," ",150],".",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","\"extension` SET `type` = 'shipping', `code` = 'pilibaba'\"",150],")",";",["T_WHITESPACE","\n\t\t",150],"}",["T_WHITESPACE","\n\t",151],"}",["T_WHITESPACE","\n\n\t",152],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","disablePiliExpress",154],"(",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n\t\t",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","db",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","query",155],"(",["T_CONSTANT_ENCAPSED_STRING","\"DELETE FROM `\"",155],["T_WHITESPACE"," ",155],".",["T_WHITESPACE"," ",155],["T_STRING","DB_PREFIX",155],["T_WHITESPACE"," ",155],".",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","\"extension` WHERE `type` = 'shipping' AND `code` = 'pilibaba'\"",155],")",";",["T_WHITESPACE","\n\t",155],"}",["T_WHITESPACE","\n\n\t",156],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","log",158],"(",["T_VARIABLE","$data",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n\t\t",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","config",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","has",159],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_logging'",159],")",["T_WHITESPACE"," ",159],["T_BOOLEAN_AND","&&",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","config",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","get",159],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_logging'",159],")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n\t\t\t",159],["T_VARIABLE","$log",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_NEW","new",160],["T_WHITESPACE"," ",160],["T_STRING","Log",160],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba.log'",160],")",";",["T_WHITESPACE","\n\n\t\t\t",160],["T_VARIABLE","$log",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","write",162],"(",["T_VARIABLE","$data",162],")",";",["T_WHITESPACE","\n\t\t",162],"}",["T_WHITESPACE","\n\t",163],"}",["T_WHITESPACE","\n",164],"}"]