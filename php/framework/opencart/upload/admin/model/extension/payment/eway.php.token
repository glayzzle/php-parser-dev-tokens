[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_CLASS","class",3],["T_WHITESPACE"," ",3],["T_STRING","ModelExtensionPaymentEway",3],["T_WHITESPACE"," ",3],["T_EXTENDS","extends",3],["T_WHITESPACE"," ",3],["T_STRING","Model",3],["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\n\t",3],["T_PUBLIC","public",5],["T_WHITESPACE"," ",5],["T_FUNCTION","function",5],["T_WHITESPACE"," ",5],["T_STRING","install",5],"(",")",["T_WHITESPACE"," ",5],"{",["T_WHITESPACE","\n\t\t",5],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","db",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","query",6],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",6],["T_WHITESPACE"," ",7],".",["T_WHITESPACE"," ",7],["T_STRING","DB_PREFIX",7],["T_WHITESPACE"," ",7],".",["T_WHITESPACE"," ",7],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` (\n\t\t\t  `eway_order_id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `order_id` int(11) NOT NULL,\n\t\t\t  `created` DATETIME NOT NULL,\n\t\t\t  `modified` DATETIME NOT NULL,\n\t\t\t  `amount` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  `currency_code` CHAR(3) NOT NULL,\n\t\t\t  `transaction_id` VARCHAR(24) NOT NULL,\n\t\t\t  `debug_data` TEXT,\n\t\t\t  `capture_status` INT(1) DEFAULT NULL,\n\t\t\t  `void_status` INT(1) DEFAULT NULL,\n\t\t\t  `refund_status` INT(1) DEFAULT NULL,\n\t\t\t  PRIMARY KEY (`eway_order_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",7],")",";",["T_WHITESPACE","\n\n\t\t",20],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","db",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","query",22],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",22],["T_WHITESPACE"," ",23],".",["T_WHITESPACE"," ",23],["T_STRING","DB_PREFIX",23],["T_WHITESPACE"," ",23],".",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","\"eway_transactions` (\n\t\t\t  `eway_order_transaction_id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `eway_order_id` int(11) NOT NULL,\n\t\t\t  `transaction_id` VARCHAR(24) NOT NULL,\n\t\t\t  `created` DATETIME NOT NULL,\n\t\t\t  `type` ENUM('auth', 'payment', 'refund', 'void') DEFAULT NULL,\n\t\t\t  `amount` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`eway_order_transaction_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",23],")",";",["T_WHITESPACE","\n\n\t\t",31],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","db",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","query",33],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",33],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_STRING","DB_PREFIX",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"eway_card` (\n\t\t\t  `card_id` INT(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `customer_id` INT(11) NOT NULL,\n\t\t\t  `order_id` INT(11) NOT NULL,\n\t\t\t  `token` VARCHAR(50) NOT NULL,\n\t\t\t  `digits` VARCHAR(4) NOT NULL,\n\t\t\t  `expiry` VARCHAR(5) NOT NULL,\n\t\t\t  `type` VARCHAR(50) NOT NULL,\n\t\t\t  PRIMARY KEY (`card_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",34],")",";",["T_WHITESPACE","\n\t",43],"}",["T_WHITESPACE","\n\n\t",44],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","uninstall",46],"(",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n\t\t",46],["T_COMMENT","\/\/$this->model_setting_setting->deleteSetting($this->request->get['extension']);\n",47],["T_WHITESPACE","\t\t",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","db",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","query",48],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_STRING","DB_PREFIX",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","\"eway_order`;\"",48],")",";",["T_WHITESPACE","\n\t\t",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","db",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","query",49],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",49],["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_STRING","DB_PREFIX",49],["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","\"eway_transactions`;\"",49],")",";",["T_WHITESPACE","\n\t\t",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","db",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","query",50],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_STRING","DB_PREFIX",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","\"eway_card`;\"",50],")",";",["T_WHITESPACE","\n\t",50],"}",["T_WHITESPACE","\n\n\t",51],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","getOrder",53],"(",["T_VARIABLE","$order_id",53],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n\t\t",53],["T_VARIABLE","$qry",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","db",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","query",54],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_STRING","DB_PREFIX",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` WHERE `order_id` = '\"",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_INT_CAST","(int)",54],["T_VARIABLE","$order_id",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",54],")",";",["T_WHITESPACE","\n\n\t\t",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$qry",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","num_rows",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n\t\t\t",56],["T_VARIABLE","$order",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$qry",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","row",57],";",["T_WHITESPACE","\n\t\t\t",57],["T_VARIABLE","$order",58],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",58],"]",["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getTransactions",58],"(",["T_VARIABLE","$order",58],"[",["T_CONSTANT_ENCAPSED_STRING","'eway_order_id'",58],"]",")",";",["T_WHITESPACE","\n\t\t\t",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$order",59],";",["T_WHITESPACE","\n\t\t",59],"}",["T_WHITESPACE"," ",60],["T_ELSE","else",60],["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n\t\t\t",60],["T_RETURN","return",61],["T_WHITESPACE"," ",61],["T_STRING","false",61],";",["T_WHITESPACE","\n\t\t",61],"}",["T_WHITESPACE","\n\t",62],"}",["T_WHITESPACE","\n\n\t",63],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","addRefundRecord",65],"(",["T_VARIABLE","$order",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$result",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$transaction_id",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$result",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","TransactionID",66],";",["T_WHITESPACE","\n\t\t",66],["T_VARIABLE","$total_amount",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$result",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","Refund",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","TotalAmount",67],["T_WHITESPACE"," ",67],"\/",["T_WHITESPACE"," ",67],["T_LNUMBER","100",67],";",["T_WHITESPACE","\n\t\t",67],["T_VARIABLE","$refund_amount",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$order",68],"[",["T_CONSTANT_ENCAPSED_STRING","'refund_amount'",68],"]",["T_WHITESPACE"," ",68],"+",["T_WHITESPACE"," ",68],["T_VARIABLE","$total_amount",68],";",["T_WHITESPACE","\n\n\t\t",68],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_ISSET","isset",70],"(",["T_VARIABLE","$order",70],"[",["T_CONSTANT_ENCAPSED_STRING","'refund_transaction_id'",70],"]",")",["T_WHITESPACE"," ",70],["T_BOOLEAN_AND","&&",70],["T_WHITESPACE"," ",70],"!",["T_EMPTY","empty",70],"(",["T_VARIABLE","$order",70],"[",["T_CONSTANT_ENCAPSED_STRING","'refund_transaction_id'",70],"]",")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n\t\t\t",70],["T_VARIABLE","$order",71],"[",["T_CONSTANT_ENCAPSED_STRING","'refund_transaction_id'",71],"]",["T_WHITESPACE"," ",71],["T_CONCAT_EQUAL",".=",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","','",71],";",["T_WHITESPACE","\n\t\t",71],"}",["T_WHITESPACE","\n\t\t",72],["T_VARIABLE","$order",73],"[",["T_CONSTANT_ENCAPSED_STRING","'refund_transaction_id'",73],"]",["T_WHITESPACE"," ",73],["T_CONCAT_EQUAL",".=",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$transaction_id",73],";",["T_WHITESPACE","\n\n\t\t",73],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","db",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","query",75],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_STRING","DB_PREFIX",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` SET `modified` = NOW(), refund_amount = '\"",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_DOUBLE_CAST","(double)",75],["T_VARIABLE","$refund_amount",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","\"', `refund_transaction_id` = '\"",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","db",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","escape",75],"(",["T_VARIABLE","$order",75],"[",["T_CONSTANT_ENCAPSED_STRING","'refund_transaction_id'",75],"]",")",["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE eway_order_id = '\"",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_VARIABLE","$order",75],"[",["T_CONSTANT_ENCAPSED_STRING","'eway_order_id'",75],"]",["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","\"'\"",75],")",";",["T_WHITESPACE","\n\t",75],"}",["T_WHITESPACE","\n\n\t",76],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","capture",78],"(",["T_VARIABLE","$order_id",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$capture_amount",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$currency",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t",78],["T_VARIABLE","$eway_order",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getOrder",79],"(",["T_VARIABLE","$order_id",79],")",";",["T_WHITESPACE","\n\n\t\t",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$eway_order",81],["T_WHITESPACE"," ",81],["T_BOOLEAN_AND","&&",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$capture_amount",81],["T_WHITESPACE"," ",81],">",["T_WHITESPACE"," ",81],["T_LNUMBER","0",81],["T_WHITESPACE"," ",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n\n\t\t\t",81],["T_VARIABLE","$capture_data",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_NEW","new",83],["T_WHITESPACE"," ",83],["T_STRING","stdClass",83],"(",")",";",["T_WHITESPACE","\n\t\t\t",83],["T_VARIABLE","$capture_data",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","Payment",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","stdClass",84],"(",")",";",["T_WHITESPACE","\n\t\t\t",84],["T_VARIABLE","$capture_data",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","Payment",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","TotalAmount",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_INT_CAST","(int)",85],["T_STRING","number_format",85],"(",["T_VARIABLE","$capture_amount",85],",",["T_WHITESPACE"," ",85],["T_LNUMBER","2",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'.'",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","''",85],")",["T_WHITESPACE"," ",85],"*",["T_WHITESPACE"," ",85],["T_LNUMBER","100",85],";",["T_WHITESPACE","\n\t\t\t",85],["T_VARIABLE","$capture_data",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","Payment",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","CurrencyCode",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$currency",86],";",["T_WHITESPACE","\n\t\t\t",86],["T_VARIABLE","$capture_data",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","TransactionID",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$eway_order",87],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",87],"]",";",["T_WHITESPACE","\n\n\t\t\t",87],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","get",89],"(",["T_CONSTANT_ENCAPSED_STRING","'eway_test'",89],")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n\t\t\t\t",89],["T_VARIABLE","$url",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.ewaypayments.com\/CapturePayment'",90],";",["T_WHITESPACE","\n\t\t\t",90],"}",["T_WHITESPACE"," ",91],["T_ELSE","else",91],["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t\t",91],["T_VARIABLE","$url",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.ewaypayments.com\/CapturePayment'",92],";",["T_WHITESPACE","\n\t\t\t",92],"}",["T_WHITESPACE","\n\n\t\t\t",93],["T_VARIABLE","$response",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","sendCurl",95],"(",["T_VARIABLE","$url",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$capture_data",95],")",";",["T_WHITESPACE","\n\n\t\t\t",95],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_STRING","json_decode",97],"(",["T_VARIABLE","$response",97],")",";",["T_WHITESPACE","\n\n\t\t",97],"}",["T_WHITESPACE"," ",99],["T_ELSE","else",99],["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n\t\t\t",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_STRING","false",100],";",["T_WHITESPACE","\n\t\t",100],"}",["T_WHITESPACE","\n\t",101],"}",["T_WHITESPACE","\n\n\t",102],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","updateCaptureStatus",104],"(",["T_VARIABLE","$eway_order_id",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$status",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n\t\t",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","db",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","query",105],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_STRING","DB_PREFIX",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` SET `capture_status` = '\"",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_INT_CAST","(int)",105],["T_VARIABLE","$status",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `eway_order_id` = '\"",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_INT_CAST","(int)",105],["T_VARIABLE","$eway_order_id",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","\"'\"",105],")",";",["T_WHITESPACE","\n\t",105],"}",["T_WHITESPACE","\n\n\t",106],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","updateTransactionId",108],"(",["T_VARIABLE","$eway_order_id",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$transaction_id",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n\t\t",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","db",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","query",109],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_STRING","DB_PREFIX",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` SET `transaction_id` = '\"",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_VARIABLE","$transaction_id",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `eway_order_id` = '\"",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_INT_CAST","(int)",109],["T_VARIABLE","$eway_order_id",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","\"'\"",109],")",";",["T_WHITESPACE","\n\t",109],"}",["T_WHITESPACE","\n\n\t",110],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","void",112],"(",["T_VARIABLE","$order_id",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n\t\t",112],["T_VARIABLE","$eway_order",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getOrder",113],"(",["T_VARIABLE","$order_id",113],")",";",["T_WHITESPACE","\n\t\t",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$eway_order",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n\n\t\t\t",114],["T_VARIABLE","$data",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_STRING","stdClass",116],"(",")",";",["T_WHITESPACE","\n\t\t\t",116],["T_VARIABLE","$data",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","TransactionID",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$eway_order",117],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",117],"]",";",["T_WHITESPACE","\n\n\t\t\t",117],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","config",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","get",119],"(",["T_CONSTANT_ENCAPSED_STRING","'eway_test'",119],")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n\t\t\t\t",119],["T_VARIABLE","$url",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.ewaypayments.com\/CancelAuthorisation'",120],";",["T_WHITESPACE","\n\t\t\t",120],"}",["T_WHITESPACE"," ",121],["T_ELSE","else",121],["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n\t\t\t\t",121],["T_VARIABLE","$url",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.ewaypayments.com\/CancelAuthorisation'",122],";",["T_WHITESPACE","\n\t\t\t",122],"}",["T_WHITESPACE","\n\n\t\t\t",123],["T_VARIABLE","$response",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","sendCurl",125],"(",["T_VARIABLE","$url",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$data",125],")",";",["T_WHITESPACE","\n\n\t\t\t",125],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","json_decode",127],"(",["T_VARIABLE","$response",127],")",";",["T_WHITESPACE","\n\n\t\t",127],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n\t\t\t",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_STRING","false",130],";",["T_WHITESPACE","\n\t\t",130],"}",["T_WHITESPACE","\n\t",131],"}",["T_WHITESPACE","\n\n\t",132],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","updateVoidStatus",134],"(",["T_VARIABLE","$eway_order_id",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$status",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n\t\t",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","db",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","query",135],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_STRING","DB_PREFIX",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` SET `void_status` = '\"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_INT_CAST","(int)",135],["T_VARIABLE","$status",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `eway_order_id` = '\"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_INT_CAST","(int)",135],["T_VARIABLE","$eway_order_id",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\"'\"",135],")",";",["T_WHITESPACE","\n\t",135],"}",["T_WHITESPACE","\n\n\t",136],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","refund",138],"(",["T_VARIABLE","$order_id",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$refund_amount",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n\t\t",138],["T_VARIABLE","$eway_order",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getOrder",139],"(",["T_VARIABLE","$order_id",139],")",";",["T_WHITESPACE","\n\n\t\t",139],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$eway_order",141],["T_WHITESPACE"," ",141],["T_BOOLEAN_AND","&&",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$refund_amount",141],["T_WHITESPACE"," ",141],">",["T_WHITESPACE"," ",141],["T_LNUMBER","0",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n\n\t\t\t",141],["T_VARIABLE","$refund_data",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_STRING","stdClass",143],"(",")",";",["T_WHITESPACE","\n\t\t\t",143],["T_VARIABLE","$refund_data",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","Refund",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_NEW","new",144],["T_WHITESPACE"," ",144],["T_STRING","stdClass",144],"(",")",";",["T_WHITESPACE","\n\t\t\t",144],["T_VARIABLE","$refund_data",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","Refund",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","TotalAmount",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_INT_CAST","(int)",145],["T_STRING","number_format",145],"(",["T_VARIABLE","$refund_amount",145],",",["T_WHITESPACE"," ",145],["T_LNUMBER","2",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'.'",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","''",145],")",["T_WHITESPACE"," ",145],"*",["T_WHITESPACE"," ",145],["T_LNUMBER","100",145],";",["T_WHITESPACE","\n\t\t\t",145],["T_VARIABLE","$refund_data",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","Refund",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","TransactionID",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$eway_order",146],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",146],"]",";",["T_WHITESPACE","\n\n\t\t\t",146],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","config",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","get",148],"(",["T_CONSTANT_ENCAPSED_STRING","'eway_test'",148],")",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n\t\t\t\t",148],["T_VARIABLE","$url",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.ewaypayments.com\/Transaction\/'",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_VARIABLE","$eway_order",149],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",149],"]",["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'\/Refund'",149],";",["T_WHITESPACE","\n\t\t\t",149],"}",["T_WHITESPACE"," ",150],["T_ELSE","else",150],["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n\t\t\t\t",150],["T_VARIABLE","$url",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.ewaypayments.com\/Transaction\/'",151],["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_VARIABLE","$eway_order",151],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",151],"]",["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'\/Refund'",151],";",["T_WHITESPACE","\n\t\t\t",151],"}",["T_WHITESPACE","\n\n\t\t\t",152],["T_VARIABLE","$response",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","sendCurl",154],"(",["T_VARIABLE","$url",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$refund_data",154],")",";",["T_WHITESPACE","\n\n\t\t\t",154],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_STRING","json_decode",156],"(",["T_VARIABLE","$response",156],")",";",["T_WHITESPACE","\n\t\t",156],"}",["T_WHITESPACE"," ",157],["T_ELSE","else",157],["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n\t\t\t",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_STRING","false",158],";",["T_WHITESPACE","\n\t\t",158],"}",["T_WHITESPACE","\n\t",159],"}",["T_WHITESPACE","\n\n\t",160],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","updateRefundStatus",162],"(",["T_VARIABLE","$eway_order_id",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$status",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n\t\t",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","db",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","query",163],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_STRING","DB_PREFIX",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"eway_order` SET `refund_status` = '\"",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_INT_CAST","(int)",163],["T_VARIABLE","$status",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `eway_order_id` = '\"",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_INT_CAST","(int)",163],["T_VARIABLE","$eway_order_id",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"'\"",163],")",";",["T_WHITESPACE","\n\t",163],"}",["T_WHITESPACE","\n\n\t",164],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","sendCurl",166],"(",["T_VARIABLE","$url",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$data",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n\t\t",166],["T_VARIABLE","$ch",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","curl_init",167],"(",["T_VARIABLE","$url",167],")",";",["T_WHITESPACE","\n\n\t\t",167],["T_VARIABLE","$eway_username",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","html_entity_decode",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","config",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","get",169],"(",["T_CONSTANT_ENCAPSED_STRING","'eway_username'",169],")",",",["T_WHITESPACE"," ",169],["T_STRING","ENT_QUOTES",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",169],")",";",["T_WHITESPACE","\n\t\t",169],["T_VARIABLE","$eway_password",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","html_entity_decode",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","config",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","get",170],"(",["T_CONSTANT_ENCAPSED_STRING","'eway_password'",170],")",",",["T_WHITESPACE"," ",170],["T_STRING","ENT_QUOTES",170],",",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",170],")",";",["T_WHITESPACE","\n\n\t\t",170],["T_STRING","curl_setopt",172],"(",["T_VARIABLE","$ch",172],",",["T_WHITESPACE"," ",172],["T_STRING","CURLOPT_HTTPHEADER",172],",",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",["T_CONSTANT_ENCAPSED_STRING","\"Content-Type: application\/json\"",172],")",")",";",["T_WHITESPACE","\n\t\t",172],["T_STRING","curl_setopt",173],"(",["T_VARIABLE","$ch",173],",",["T_WHITESPACE"," ",173],["T_STRING","CURLOPT_USERPWD",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$eway_username",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","\":\"",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_VARIABLE","$eway_password",173],")",";",["T_WHITESPACE","\n\t\t",173],["T_STRING","curl_setopt",174],"(",["T_VARIABLE","$ch",174],",",["T_WHITESPACE"," ",174],["T_STRING","CURLOPT_POST",174],",",["T_WHITESPACE"," ",174],["T_LNUMBER","1",174],")",";",["T_WHITESPACE","\n\t\t",174],["T_STRING","curl_setopt",175],"(",["T_VARIABLE","$ch",175],",",["T_WHITESPACE"," ",175],["T_STRING","CURLOPT_POSTFIELDS",175],",",["T_WHITESPACE"," ",175],["T_STRING","json_encode",175],"(",["T_VARIABLE","$data",175],")",")",";",["T_WHITESPACE","\n\t\t",175],["T_STRING","curl_setopt",176],"(",["T_VARIABLE","$ch",176],",",["T_WHITESPACE"," ",176],["T_STRING","CURLOPT_RETURNTRANSFER",176],",",["T_WHITESPACE"," ",176],["T_LNUMBER","1",176],")",";",["T_WHITESPACE","\n\t\t",176],["T_STRING","curl_setopt",177],"(",["T_VARIABLE","$ch",177],",",["T_WHITESPACE"," ",177],["T_STRING","CURLOPT_TIMEOUT",177],",",["T_WHITESPACE"," ",177],["T_LNUMBER","60",177],")",";",["T_WHITESPACE","\n\t\t",177],["T_STRING","curl_setopt",178],"(",["T_VARIABLE","$ch",178],",",["T_WHITESPACE"," ",178],["T_STRING","CURLOPT_SSL_VERIFYPEER",178],",",["T_WHITESPACE"," ",178],["T_LNUMBER","1",178],")",";",["T_WHITESPACE","\n\n\t\t",178],["T_VARIABLE","$response",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","curl_exec",180],"(",["T_VARIABLE","$ch",180],")",";",["T_WHITESPACE","\n\n\t\t",180],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_STRING","curl_errno",182],"(",["T_VARIABLE","$ch",182],")",["T_WHITESPACE"," ",182],["T_IS_NOT_EQUAL","!=",182],["T_WHITESPACE"," ",182],["T_STRING","CURLE_OK",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n\t\t\t",182],["T_VARIABLE","$response",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_NEW","new",183],["T_WHITESPACE"," ",183],["T_STRING","stdClass",183],"(",")",";",["T_WHITESPACE","\n\t\t\t",183],["T_VARIABLE","$response",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","Errors",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","\"POST Error: \"",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_STRING","curl_error",184],"(",["T_VARIABLE","$ch",184],")",["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],"\"",["T_ENCAPSED_AND_WHITESPACE"," URL: ",184],["T_VARIABLE","$url",184],"\"",";",["T_WHITESPACE","\n\t\t\t",184],["T_VARIABLE","$response",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","json_encode",185],"(",["T_VARIABLE","$response",185],")",";",["T_WHITESPACE","\n\t\t",185],"}",["T_WHITESPACE"," ",186],["T_ELSE","else",186],["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n\t\t\t",186],["T_VARIABLE","$info",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_STRING","curl_getinfo",187],"(",["T_VARIABLE","$ch",187],")",";",["T_WHITESPACE","\n\t\t\t",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$info",188],"[",["T_CONSTANT_ENCAPSED_STRING","'http_code'",188],"]",["T_WHITESPACE"," ",188],["T_IS_EQUAL","==",188],["T_WHITESPACE"," ",188],["T_LNUMBER","401",188],["T_WHITESPACE"," ",188],["T_BOOLEAN_OR","||",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$info",188],"[",["T_CONSTANT_ENCAPSED_STRING","'http_code'",188],"]",["T_WHITESPACE"," ",188],["T_IS_EQUAL","==",188],["T_WHITESPACE"," ",188],["T_LNUMBER","404",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n\t\t\t\t",188],["T_VARIABLE","$response",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_NEW","new",189],["T_WHITESPACE"," ",189],["T_STRING","stdClass",189],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",189],["T_VARIABLE","$response",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","Errors",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","\"Please check the API Key and Password\"",190],";",["T_WHITESPACE","\n\t\t\t\t",190],["T_VARIABLE","$response",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","json_encode",191],"(",["T_VARIABLE","$response",191],")",";",["T_WHITESPACE","\n\t\t\t",191],"}",["T_WHITESPACE","\n\t\t",192],"}",["T_WHITESPACE","\n\n\t\t",193],["T_STRING","curl_close",195],"(",["T_VARIABLE","$ch",195],")",";",["T_WHITESPACE","\n\n\t\t",195],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$response",197],";",["T_WHITESPACE","\n\t",197],"}",["T_WHITESPACE","\n\n\t",198],["T_PRIVATE","private",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","getTransactions",200],"(",["T_VARIABLE","$eway_order_id",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n\t\t",200],["T_VARIABLE","$qry",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","db",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","query",201],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",201],["T_WHITESPACE"," ",201],".",["T_WHITESPACE"," ",201],["T_STRING","DB_PREFIX",201],["T_WHITESPACE"," ",201],".",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","\"eway_transactions` WHERE `eway_order_id` = '\"",201],["T_WHITESPACE"," ",201],".",["T_WHITESPACE"," ",201],["T_INT_CAST","(int)",201],["T_VARIABLE","$eway_order_id",201],["T_WHITESPACE"," ",201],".",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","\"'\"",201],")",";",["T_WHITESPACE","\n\n\t\t",201],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$qry",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","num_rows",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n\t\t\t",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$qry",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","rows",204],";",["T_WHITESPACE","\n\t\t",204],"}",["T_WHITESPACE"," ",205],["T_ELSE","else",205],["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n\t\t\t",205],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_STRING","false",206],";",["T_WHITESPACE","\n\t\t",206],"}",["T_WHITESPACE","\n\t",207],"}",["T_WHITESPACE","\n\n\t",208],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","addTransaction",210],"(",["T_VARIABLE","$eway_order_id",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$transactionid",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$type",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$total",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$currency",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n\t\t",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","db",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","query",211],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_STRING","DB_PREFIX",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","\"eway_transactions` SET `eway_order_id` = '\"",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_INT_CAST","(int)",211],["T_VARIABLE","$eway_order_id",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","\"', `created` = NOW(), `transaction_id` = '\"",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","db",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","escape",211],"(",["T_VARIABLE","$transactionid",211],")",["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","\"', `type` = '\"",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","db",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","escape",211],"(",["T_VARIABLE","$type",211],")",["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","currency",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","format",211],"(",["T_VARIABLE","$total",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$currency",211],",",["T_WHITESPACE"," ",211],["T_STRING","false",211],",",["T_WHITESPACE"," ",211],["T_STRING","false",211],")",["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","\"'\"",211],")",";",["T_WHITESPACE","\n\t",211],"}",["T_WHITESPACE","\n\n\t",212],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","getTotalCaptured",214],"(",["T_VARIABLE","$eway_order_id",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n\t\t",214],["T_VARIABLE","$query",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","db",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","query",215],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",215],["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_STRING","DB_PREFIX",215],["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","\"eway_transactions` WHERE `eway_order_id` = '\"",215],["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_INT_CAST","(int)",215],["T_VARIABLE","$eway_order_id",215],["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","\"' AND `type` = 'payment' \"",215],")",";",["T_WHITESPACE","\n\n\t\t",215],["T_RETURN","return",217],["T_WHITESPACE"," ",217],["T_DOUBLE_CAST","(double)",217],["T_VARIABLE","$query",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","row",217],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",217],"]",";",["T_WHITESPACE","\n\t",217],"}",["T_WHITESPACE","\n\n\t",218],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","getTotalRefunded",220],"(",["T_VARIABLE","$eway_order_id",220],")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n\t\t",220],["T_VARIABLE","$query",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","db",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","query",221],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `total` FROM `\"",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_STRING","DB_PREFIX",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","\"eway_transactions` WHERE `eway_order_id` = '\"",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_INT_CAST","(int)",221],["T_VARIABLE","$eway_order_id",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","\"' AND `type` = 'refund'\"",221],")",";",["T_WHITESPACE","\n\n\t\t",221],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_DOUBLE_CAST","(double)",223],["T_VARIABLE","$query",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","row",223],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",223],"]",";",["T_WHITESPACE","\n\t",223],"}",["T_WHITESPACE","\n\n",224],"}"]