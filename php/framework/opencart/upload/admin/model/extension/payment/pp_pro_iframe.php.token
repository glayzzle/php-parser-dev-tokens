[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentPPProIframe",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","install",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",4],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_STRING","DB_PREFIX",5],["T_WHITESPACE"," ",5],".",["T_WHITESPACE"," ",5],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order` (\n\t\t\t  `paypal_iframe_order_id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `order_id` int(11) NOT NULL,\n\t\t\t  `date_added` DATETIME NOT NULL,\n\t\t\t  `date_modified` DATETIME NOT NULL,\n\t\t\t  `capture_status` ENUM('Complete','NotComplete') DEFAULT NULL,\n\t\t\t  `currency_code` CHAR(3) NOT NULL,\n\t\t\t  `authorization_id` VARCHAR(30) NOT NULL,\n\t\t\t  `total` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  PRIMARY KEY (`paypal_iframe_order_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",5],")",";",["T_WHITESPACE","\n\n\t\t",15],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","db",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","query",17],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tCREATE TABLE IF NOT EXISTS `\"",17],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_STRING","DB_PREFIX",18],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` (\n\t\t\t  `paypal_iframe_order_transaction_id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t  `paypal_iframe_order_id` int(11) NOT NULL,\n\t\t\t  `transaction_id` CHAR(20) NOT NULL,\n\t\t\t  `parent_id` CHAR(20) NOT NULL,\n\t\t\t  `date_added` DATETIME NOT NULL,\n\t\t\t  `note` VARCHAR(255) NOT NULL,\n\t\t\t  `msgsubid` CHAR(38) NOT NULL,\n\t\t\t  `receipt_id` CHAR(20) NOT NULL,\n\t\t\t  `payment_type` ENUM('none','echeck','instant', 'refund', 'void') DEFAULT NULL,\n\t\t\t  `payment_status` CHAR(20) NOT NULL,\n\t\t\t  `pending_reason` CHAR(50) NOT NULL,\n\t\t\t  `transaction_entity` CHAR(50) NOT NULL,\n\t\t\t  `amount` DECIMAL( 10, 2 ) NOT NULL,\n\t\t\t  `debug_data` TEXT NOT NULL,\n\t\t\t  `call_data` TEXT NOT NULL,\n\t\t\t  PRIMARY KEY (`paypal_iframe_order_transaction_id`)\n\t\t\t) ENGINE=MyISAM DEFAULT COLLATE=utf8_general_ci;\"",18],")",";",["T_WHITESPACE","\n\t",35],"}",["T_WHITESPACE","\n\n\t",36],["T_PUBLIC","public",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","uninstall",38],"(",")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n\t\t",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","db",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","query",39],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",39],["T_WHITESPACE"," ",39],".",["T_WHITESPACE"," ",39],["T_STRING","DB_PREFIX",39],["T_WHITESPACE"," ",39],".",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction`;\"",39],")",";",["T_WHITESPACE","\n\t\t",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","db",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","query",40],"(",["T_CONSTANT_ENCAPSED_STRING","\"DROP TABLE IF EXISTS `\"",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_STRING","DB_PREFIX",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order`;\"",40],")",";",["T_WHITESPACE","\n\t",40],"}",["T_WHITESPACE","\n\n\t",41],["T_PRIVATE","private",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","getTransactions",43],"(",["T_VARIABLE","$paypal_iframe_order_id",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n\t\t",43],["T_VARIABLE","$qry",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","db",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","query",44],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `ot`.*, ( SELECT count(`ot2`.`paypal_iframe_order_id`) FROM `\"",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_STRING","DB_PREFIX",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` `ot2` WHERE `ot2`.`parent_id` = `ot`.`transaction_id` ) AS `children` FROM `\"",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_STRING","DB_PREFIX",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` `ot` WHERE `paypal_iframe_order_id` = '\"",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_INT_CAST","(int)",44],["T_VARIABLE","$paypal_iframe_order_id",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","\"'\"",44],")",";",["T_WHITESPACE","\n\n\t\t",44],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$qry",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","num_rows",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n\t\t\t",46],["T_RETURN","return",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$qry",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","rows",47],";",["T_WHITESPACE","\n\t\t",47],"}",["T_WHITESPACE"," ",48],["T_ELSE","else",48],["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n\t\t\t",48],["T_RETURN","return",49],["T_WHITESPACE"," ",49],["T_STRING","false",49],";",["T_WHITESPACE","\n\t\t",49],"}",["T_WHITESPACE","\n\t",50],"}",["T_WHITESPACE","\n\n\t",51],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","getTotalCaptured",53],"(",["T_VARIABLE","$paypal_iframe_order_id",53],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n\t\t",53],["T_VARIABLE","$qry",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","db",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","query",54],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `amount` FROM `\"",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_STRING","DB_PREFIX",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` WHERE `paypal_iframe_order_id` = '\"",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_INT_CAST","(int)",54],["T_VARIABLE","$paypal_iframe_order_id",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","\"' AND `pending_reason` != 'authorization' AND (`payment_status` = 'Partially-Refunded' OR `payment_status` = 'Completed' OR `payment_status` = 'Pending') AND `transaction_entity` = 'payment'\"",54],")",";",["T_WHITESPACE","\n\n\t\t",54],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$qry",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","row",56],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",56],"]",";",["T_WHITESPACE","\n\t",56],"}",["T_WHITESPACE","\n\n\t",57],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","getTotalRefunded",59],"(",["T_VARIABLE","$paypal_iframe_order_id",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n\t\t",59],["T_VARIABLE","$qry",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","db",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","query",60],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `amount` FROM `\"",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_STRING","DB_PREFIX",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` WHERE `paypal_iframe_order_id` = '\"",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_INT_CAST","(int)",60],["T_VARIABLE","$paypal_iframe_order_id",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","\"' AND `payment_status` = 'Refunded'\"",60],")",";",["T_WHITESPACE","\n\n\t\t",60],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$qry",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","row",62],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",62],"]",";",["T_WHITESPACE","\n\t",62],"}",["T_WHITESPACE","\n\n\t",63],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getTotalRefundedTransaction",65],"(",["T_VARIABLE","$transaction_id",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$qry",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","db",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","query",66],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(`amount`) AS `amount` FROM `\"",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_STRING","DB_PREFIX",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` WHERE `parent_id` = '\"",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","db",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","escape",66],"(",["T_VARIABLE","$transaction_id",66],")",["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"' AND `payment_type` = 'refund'\"",66],")",";",["T_WHITESPACE","\n\n\t\t",66],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$qry",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","row",68],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",68],"]",";",["T_WHITESPACE","\n\t",68],"}",["T_WHITESPACE","\n\n\t",69],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","getOrder",71],"(",["T_VARIABLE","$order_id",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n\t\t",71],["T_VARIABLE","$qry",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","db",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","query",72],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_STRING","DB_PREFIX",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order` WHERE `order_id` = '\"",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_INT_CAST","(int)",72],["T_VARIABLE","$order_id",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",72],")",";",["T_WHITESPACE","\n\n\t\t",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$qry",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","num_rows",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$order",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$qry",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","row",75],";",["T_WHITESPACE","\n\t\t\t",75],["T_VARIABLE","$order",76],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",76],"]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getTransactions",76],"(",["T_VARIABLE","$order",76],"[",["T_CONSTANT_ENCAPSED_STRING","'paypal_iframe_order_id'",76],"]",")",";",["T_WHITESPACE","\n\t\t\t",76],["T_VARIABLE","$order",77],"[",["T_CONSTANT_ENCAPSED_STRING","'captured'",77],"]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getTotalCaptured",77],"(",["T_VARIABLE","$order",77],"[",["T_CONSTANT_ENCAPSED_STRING","'paypal_iframe_order_id'",77],"]",")",";",["T_WHITESPACE","\n\t\t\t",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$order",78],";",["T_WHITESPACE","\n\t\t",78],"}",["T_WHITESPACE"," ",79],["T_ELSE","else",79],["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n\t\t\t",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_STRING","false",80],";",["T_WHITESPACE","\n\t\t",80],"}",["T_WHITESPACE","\n\t",81],"}",["T_WHITESPACE","\n\n\t",82],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","call",84],"(",["T_VARIABLE","$data",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n\n\t\t",84],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","config",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","get",86],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe_test'",86],")",["T_WHITESPACE"," ",86],["T_IS_EQUAL","==",86],["T_WHITESPACE"," ",86],["T_LNUMBER","1",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n\t\t\t",86],["T_VARIABLE","$api_endpoint",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api-3t.sandbox.paypal.com\/nvp'",87],";",["T_WHITESPACE","\n\t\t",87],"}",["T_WHITESPACE"," ",88],["T_ELSE","else",88],["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n\t\t\t",88],["T_VARIABLE","$api_endpoint",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api-3t.paypal.com\/nvp'",89],";",["T_WHITESPACE","\n\t\t",89],"}",["T_WHITESPACE","\n\n\t\t",90],["T_VARIABLE","$settings",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",["T_WHITESPACE","\n\t\t\t",92],["T_CONSTANT_ENCAPSED_STRING","'USER'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","config",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","get",93],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe_user'",93],")",",",["T_WHITESPACE","\n\t\t\t",93],["T_CONSTANT_ENCAPSED_STRING","'PWD'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","config",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","get",94],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe_password'",94],")",",",["T_WHITESPACE","\n\t\t\t",94],["T_CONSTANT_ENCAPSED_STRING","'SIGNATURE'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","config",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","get",95],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe_sig'",95],")",",",["T_WHITESPACE","\n\t\t\t",95],["T_CONSTANT_ENCAPSED_STRING","'VERSION'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'84'",96],",",["T_WHITESPACE","\n\t\t\t",96],["T_CONSTANT_ENCAPSED_STRING","'BUTTONSOURCE'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'WM_PRO_OPENCART_UK_'",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_STRING","VERSION",97],",",["T_WHITESPACE","\n\t\t",97],")",";",["T_WHITESPACE","\n\n\t\t",98],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","log",100],"(",["T_VARIABLE","$data",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'Call data'",100],")",";",["T_WHITESPACE","\n\n\t\t",100],["T_VARIABLE","$defaults",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",["T_WHITESPACE","\n\t\t\t",102],["T_STRING","CURLOPT_POST",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_LNUMBER","1",103],",",["T_WHITESPACE","\n\t\t\t",103],["T_STRING","CURLOPT_HEADER",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_LNUMBER","0",104],",",["T_WHITESPACE","\n\t\t\t",104],["T_STRING","CURLOPT_URL",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$api_endpoint",105],",",["T_WHITESPACE","\n\t\t\t",105],["T_STRING","CURLOPT_USERAGENT",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","\"Mozilla\/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1) Gecko\/20061204 Firefox\/2.0.0.1\"",106],",",["T_WHITESPACE","\n\t\t\t",106],["T_STRING","CURLOPT_FRESH_CONNECT",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_LNUMBER","1",107],",",["T_WHITESPACE","\n\t\t\t",107],["T_STRING","CURLOPT_RETURNTRANSFER",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_LNUMBER","1",108],",",["T_WHITESPACE","\n\t\t\t",108],["T_STRING","CURLOPT_FORBID_REUSE",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_LNUMBER","1",109],",",["T_WHITESPACE","\n\t\t\t",109],["T_STRING","CURLOPT_TIMEOUT",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_LNUMBER","0",110],",",["T_WHITESPACE","\n\t\t\t",110],["T_STRING","CURLOPT_SSL_VERIFYPEER",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_LNUMBER","0",111],",",["T_WHITESPACE","\n\t\t\t",111],["T_STRING","CURLOPT_SSL_VERIFYHOST",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_LNUMBER","0",112],",",["T_WHITESPACE","\n\t\t\t",112],["T_STRING","CURLOPT_POSTFIELDS",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_STRING","http_build_query",113],"(",["T_STRING","array_merge",113],"(",["T_VARIABLE","$data",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$settings",113],")",",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","''",113],",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","\"&\"",113],")",["T_WHITESPACE","\n\t\t",113],")",";",["T_WHITESPACE","\n\n\t\t",114],["T_VARIABLE","$ch",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","curl_init",116],"(",")",";",["T_WHITESPACE","\n\n\t\t",116],["T_STRING","curl_setopt_array",118],"(",["T_VARIABLE","$ch",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$defaults",118],")",";",["T_WHITESPACE","\n\n\t\t",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_VARIABLE","$result",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","curl_exec",120],"(",["T_VARIABLE","$ch",120],")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n\n\t\t\t",120],["T_VARIABLE","$log_data",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",["T_WHITESPACE","\n\t\t\t\t",122],["T_CONSTANT_ENCAPSED_STRING","'curl_error'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_STRING","curl_error",123],"(",["T_VARIABLE","$ch",123],")",",",["T_WHITESPACE","\n\t\t\t\t",123],["T_CONSTANT_ENCAPSED_STRING","'curl_errno'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_STRING","curl_errno",124],"(",["T_VARIABLE","$ch",124],")",["T_WHITESPACE","\n\t\t\t",124],")",";",["T_WHITESPACE","\n\n\t\t\t",125],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","log",127],"(",["T_VARIABLE","$log_data",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'CURL failed'",127],")",";",["T_WHITESPACE","\n\n\t\t\t",127],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","false",129],";",["T_WHITESPACE","\n\t\t",129],"}",["T_WHITESPACE","\n\n\t\t",130],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","log",132],"(",["T_VARIABLE","$result",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'Result'",132],")",";",["T_WHITESPACE","\n\n\t\t",132],["T_STRING","curl_close",134],"(",["T_VARIABLE","$ch",134],")",";",["T_WHITESPACE","\n\n\t\t",134],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","cleanReturn",136],"(",["T_VARIABLE","$result",136],")",";",["T_WHITESPACE","\n\t",136],"}",["T_WHITESPACE","\n\n\t",137],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","updateOrder",139],"(",["T_VARIABLE","$capture_status",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$order_id",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n\t\t",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","db",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","query",140],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_STRING","DB_PREFIX",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order` SET `date_modified` = now(), `capture_status` = '\"",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","db",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","escape",140],"(",["T_VARIABLE","$capture_status",140],")",["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `order_id` = '\"",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_INT_CAST","(int)",140],["T_VARIABLE","$order_id",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","\"'\"",140],")",";",["T_WHITESPACE","\n\t",140],"}",["T_WHITESPACE","\n\n\t",141],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","updateTransaction",143],"(",["T_VARIABLE","$transaction",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","db",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","query",144],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tUPDATE \"",144],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_STRING","DB_PREFIX",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction\n\t\t\tSET paypal_iframe_order_id = \"",145],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_INT_CAST","(int)",146],["T_VARIABLE","$transaction",146],"[",["T_CONSTANT_ENCAPSED_STRING","'paypal_iframe_order_id'",146],"]",["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","\",\n\t\t\t\ttransaction_id = '\"",146],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","db",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","escape",147],"(",["T_VARIABLE","$transaction",147],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",147],"]",")",["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tparent_id = '\"",147],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","db",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","escape",148],"(",["T_VARIABLE","$transaction",148],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",148],"]",")",["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tdate_added = '\"",148],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","db",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","escape",149],"(",["T_VARIABLE","$transaction",149],"[",["T_CONSTANT_ENCAPSED_STRING","'date_added'",149],"]",")",["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tnote = '\"",149],["T_WHITESPACE"," ",150],".",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","db",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","escape",150],"(",["T_VARIABLE","$transaction",150],"[",["T_CONSTANT_ENCAPSED_STRING","'note'",150],"]",")",["T_WHITESPACE"," ",150],".",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tmsgsubid = '\"",150],["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","db",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","escape",151],"(",["T_VARIABLE","$transaction",151],"[",["T_CONSTANT_ENCAPSED_STRING","'msgsubid'",151],"]",")",["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\treceipt_id = '\"",151],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","db",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","escape",152],"(",["T_VARIABLE","$transaction",152],"[",["T_CONSTANT_ENCAPSED_STRING","'receipt_id'",152],"]",")",["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tpayment_type = '\"",152],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","db",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","escape",153],"(",["T_VARIABLE","$transaction",153],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_type'",153],"]",")",["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tpayment_status = '\"",153],["T_WHITESPACE"," ",154],".",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","db",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","escape",154],"(",["T_VARIABLE","$transaction",154],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_status'",154],"]",")",["T_WHITESPACE"," ",154],".",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tpending_reason = '\"",154],["T_WHITESPACE"," ",155],".",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","db",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","escape",155],"(",["T_VARIABLE","$transaction",155],"[",["T_CONSTANT_ENCAPSED_STRING","'pending_reason'",155],"]",")",["T_WHITESPACE"," ",155],".",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\ttransaction_entity = '\"",155],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","db",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","escape",156],"(",["T_VARIABLE","$transaction",156],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_entity'",156],"]",")",["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tamount = '\"",156],["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","db",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","escape",157],"(",["T_VARIABLE","$transaction",157],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",157],"]",")",["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tdebug_data = '\"",157],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","db",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","escape",158],"(",["T_VARIABLE","$transaction",158],"[",["T_CONSTANT_ENCAPSED_STRING","'debug_data'",158],"]",")",["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tcall_data = '\"",158],["T_WHITESPACE"," ",159],".",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","db",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","escape",159],"(",["T_VARIABLE","$transaction",159],"[",["T_CONSTANT_ENCAPSED_STRING","'call_data'",159],"]",")",["T_WHITESPACE"," ",159],".",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","\"'\n\t\t\tWHERE paypal_iframe_order_transaction_id = \"",159],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_INT_CAST","(int)",160],["T_VARIABLE","$transaction",160],"[",["T_CONSTANT_ENCAPSED_STRING","'paypal_iframe_order_transaction_id'",160],"]",["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\"",160],")",";",["T_WHITESPACE","\n\t",161],"}",["T_WHITESPACE","\n\n\t",162],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","addTransaction",164],"(",["T_VARIABLE","$transaction_data",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$request_data",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_ARRAY","array",164],"(",")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n\t\t",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","query",165],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_STRING","DB_PREFIX",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` SET `paypal_iframe_order_id` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_INT_CAST","(int)",165],["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'paypal_iframe_order_id'",165],"]",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `transaction_id` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_id'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `parent_id` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `date_added` = NOW(), `note` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'note'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `msgsubid` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'msgsubid'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `receipt_id` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'receipt_id'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `payment_type` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_type'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `payment_status` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_status'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `pending_reason` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'pending_reason'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `transaction_entity` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'transaction_entity'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_DOUBLE_CAST","(float)",165],["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",165],"]",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"', `debug_data` = '\"",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$transaction_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'debug_data'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"'\"",165],")",";",["T_WHITESPACE","\n\n\t\t",165],["T_VARIABLE","$paypal_iframe_order_transaction_id",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","db",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getLastId",167],"(",")",";",["T_WHITESPACE","\n\n\t\t",167],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$request_data",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n\t\t\t",169],["T_VARIABLE","$serialized_data",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","json_encode",170],"(",["T_VARIABLE","$request_data",170],")",";",["T_WHITESPACE","\n\n\t\t\t",170],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","db",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","query",172],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\t\tUPDATE \"",172],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_STRING","DB_PREFIX",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction\n\t\t\t\tSET call_data = '\"",173],["T_WHITESPACE"," ",174],".",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","db",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","escape",174],"(",["T_VARIABLE","$serialized_data",174],")",["T_WHITESPACE"," ",174],".",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","\"'\n\t\t\t\tWHERE paypal_iframe_order_transaction_id = \"",174],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_INT_CAST","(int)",175],["T_VARIABLE","$paypal_iframe_order_transaction_id",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\t\tLIMIT 1\n\t\t\t\"",175],")",";",["T_WHITESPACE","\n\t\t",177],"}",["T_WHITESPACE","\n\n\t\t",178],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$paypal_iframe_order_transaction_id",180],";",["T_WHITESPACE","\n\t",180],"}",["T_WHITESPACE","\n\n\t",181],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","log",183],"(",["T_VARIABLE","$data",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$title",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_STRING","null",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n\t\t",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","config",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","get",184],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe_debug'",184],")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n\t\t\t",184],["T_VARIABLE","$log",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_NEW","new",185],["T_WHITESPACE"," ",185],["T_STRING","Log",185],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe.log'",185],")",";",["T_WHITESPACE","\n\t\t\t",185],["T_VARIABLE","$log",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","write",186],"(",["T_VARIABLE","$title",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","': '",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_STRING","json_encode",186],"(",["T_VARIABLE","$data",186],")",")",";",["T_WHITESPACE","\n\t\t",186],"}",["T_WHITESPACE","\n\t",187],"}",["T_WHITESPACE","\n\n\t",188],["T_PUBLIC","public",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","getTransaction",190],"(",["T_VARIABLE","$transaction_id",190],")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n\t\t",190],["T_VARIABLE","$call_data",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",["T_WHITESPACE","\n\t\t\t",191],["T_CONSTANT_ENCAPSED_STRING","'METHOD'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'GetTransactionDetails'",192],",",["T_WHITESPACE","\n\t\t\t",192],["T_CONSTANT_ENCAPSED_STRING","'TRANSACTIONID'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$transaction_id",193],",",["T_WHITESPACE","\n\t\t",193],")",";",["T_WHITESPACE","\n\n\t\t",194],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","call",196],"(",["T_VARIABLE","$call_data",196],")",";",["T_WHITESPACE","\n\t",196],"}",["T_WHITESPACE","\n\n\t",197],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","getOrderId",199],"(",["T_VARIABLE","$transaction_id",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n\t\t",199],["T_VARIABLE","$qry",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","db",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","query",200],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `o`.`order_id` FROM `\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_STRING","DB_PREFIX",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` `ot` LEFT JOIN `\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_STRING","DB_PREFIX",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order` `o`  ON `o`.`paypal_iframe_order_id` = `ot`.`paypal_iframe_order_id`  WHERE `ot`.`transaction_id` = '\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","db",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","escape",200],"(",["T_VARIABLE","$transaction_id",200],")",["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",200],")",";",["T_WHITESPACE","\n\n\t\t",200],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$qry",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","num_rows",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n\t\t\t",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$qry",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","row",203],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",203],"]",";",["T_WHITESPACE","\n\t\t",203],"}",["T_WHITESPACE"," ",204],["T_ELSE","else",204],["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n\t\t\t",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_STRING","false",205],";",["T_WHITESPACE","\n\t\t",205],"}",["T_WHITESPACE","\n\t",206],"}",["T_WHITESPACE","\n\n\t",207],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","updateAuthorizationId",209],"(",["T_VARIABLE","$paypal_iframe_order_id",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$authorization_id",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n\t\t",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","db",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","query",210],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tUPDATE `\"",210],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_STRING","DB_PREFIX",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order`\n\t\t\tSET `authorization_id` = '\"",211],["T_WHITESPACE"," ",212],".",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","db",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","escape",212],"(",["T_VARIABLE","$authorization_id",212],")",["T_WHITESPACE"," ",212],".",["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","\"'\n\t\t\tWHERE `paypal_iframe_order_id` = '\"",212],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","db",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","escape",213],"(",["T_VARIABLE","$paypal_iframe_order_id",213],")",["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","\"'\n\t\t\"",213],")",";",["T_WHITESPACE","\n\t",214],"}",["T_WHITESPACE","\n\n\t",215],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","updateRefundTransaction",217],"(",["T_VARIABLE","$transaction_id",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$transaction_type",217],")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n\t\t",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","db",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","query",218],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",218],["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_STRING","DB_PREFIX",218],["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction` SET `payment_status` = '\"",218],["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","db",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","escape",218],"(",["T_VARIABLE","$transaction_type",218],")",["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `transaction_id` = '\"",218],["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","db",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","escape",218],"(",["T_VARIABLE","$transaction_id",218],")",["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",218],")",";",["T_WHITESPACE","\n\t",218],"}",["T_WHITESPACE","\n\n\t",219],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","getFailedTransaction",221],"(",["T_VARIABLE","$paypl_iframe_order_transaction_id",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n\t\t",221],["T_VARIABLE","$result",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","query",222],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tSELECT *\n\t\t\tFROM \"",222],["T_WHITESPACE"," ",224],".",["T_WHITESPACE"," ",224],["T_STRING","DB_PREFIX",224],["T_WHITESPACE"," ",224],".",["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction\n\t\t\tWHERE paypal_iframe_order_transaction_id = \"",224],["T_WHITESPACE"," ",225],".",["T_WHITESPACE"," ",225],["T_INT_CAST","(int)",225],["T_VARIABLE","$paypl_iframe_order_transaction_id",225],["T_WHITESPACE"," ",225],".",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\"",225],")",["T_OBJECT_OPERATOR","->",226],["T_STRING","row",226],";",["T_WHITESPACE","\n\n\t\t",226],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$result",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n\t\t\t",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$result",229],";",["T_WHITESPACE","\n\t\t",229],"}",["T_WHITESPACE"," ",230],["T_ELSE","else",230],["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n\t\t\t",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_STRING","false",231],";",["T_WHITESPACE","\n\t\t",231],"}",["T_WHITESPACE","\n\t",232],"}",["T_WHITESPACE","\n\n\t",233],["T_PUBLIC","public",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","getLocalTransaction",235],"(",["T_VARIABLE","$transaction_id",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n\t\t",235],["T_VARIABLE","$result",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","db",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","query",236],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\tSELECT *\n\t\t\tFROM \"",236],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_STRING","DB_PREFIX",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","\"paypal_iframe_order_transaction\n\t\t\tWHERE transaction_id = '\"",238],["T_WHITESPACE"," ",239],".",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","db",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","escape",239],"(",["T_VARIABLE","$transaction_id",239],")",["T_WHITESPACE"," ",239],".",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","\"'\n\t\t\"",239],")",["T_OBJECT_OPERATOR","->",240],["T_STRING","row",240],";",["T_WHITESPACE","\n\n\t\t",240],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$result",242],")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n\t\t\t",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$result",243],";",["T_WHITESPACE","\n\t\t",243],"}",["T_WHITESPACE"," ",244],["T_ELSE","else",244],["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n\t\t\t",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_STRING","false",245],";",["T_WHITESPACE","\n\t\t",245],"}",["T_WHITESPACE","\n\t",246],"}",["T_WHITESPACE","\n\n\t",247],["T_PROTECTED","protected",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","cleanReturn",249],"(",["T_VARIABLE","$data",249],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n\t\t",249],["T_VARIABLE","$data",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","explode",250],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$data",250],")",";",["T_WHITESPACE","\n\n\t\t",250],["T_VARIABLE","$arr",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_ARRAY","array",252],"(",")",";",["T_WHITESPACE","\n\n\t\t",252],["T_FOREACH","foreach",254],["T_WHITESPACE"," ",254],"(",["T_VARIABLE","$data",254],["T_WHITESPACE"," ",254],["T_AS","as",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$k",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$v",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n\t\t\t",254],["T_VARIABLE","$tmp",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","explode",255],"(",["T_CONSTANT_ENCAPSED_STRING","'='",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$v",255],")",";",["T_WHITESPACE","\n\t\t\t",255],["T_VARIABLE","$arr",256],"[",["T_VARIABLE","$tmp",256],"[",["T_LNUMBER","0",256],"]","]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_STRING","urldecode",256],"(",["T_VARIABLE","$tmp",256],"[",["T_LNUMBER","1",256],"]",")",";",["T_WHITESPACE","\n\t\t",256],"}",["T_WHITESPACE","\n\n\t\t",257],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$arr",259],";",["T_WHITESPACE","\n\t",259],"}",["T_WHITESPACE","\n",260],"}"]