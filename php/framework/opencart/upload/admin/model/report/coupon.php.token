[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelReportCoupon",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","getCoupons",3],"(",["T_VARIABLE","$data",3],["T_WHITESPACE"," ",3],"=",["T_WHITESPACE"," ",3],["T_ARRAY","array",3],"(",")",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$sql",4],["T_WHITESPACE"," ",4],"=",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"SELECT ch.coupon_id, c.name, c.code, COUNT(DISTINCT ch.order_id) AS `orders`, SUM(ch.amount) AS total FROM `\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_STRING","DB_PREFIX",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"coupon_history` ch LEFT JOIN `\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_STRING","DB_PREFIX",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"coupon` c ON (ch.coupon_id = c.coupon_id)\"",4],";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$implode",6],["T_WHITESPACE"," ",6],"=",["T_WHITESPACE"," ",6],["T_ARRAY","array",6],"(",")",";",["T_WHITESPACE","\n\n\t\t",6],["T_IF","if",8],["T_WHITESPACE"," ",8],"(","!",["T_EMPTY","empty",8],"(",["T_VARIABLE","$data",8],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_start'",8],"]",")",")",["T_WHITESPACE"," ",8],"{",["T_WHITESPACE","\n\t\t\t",8],["T_VARIABLE","$implode",9],"[","]",["T_WHITESPACE"," ",9],"=",["T_WHITESPACE"," ",9],["T_CONSTANT_ENCAPSED_STRING","\"DATE(ch.date_added) >= '\"",9],["T_WHITESPACE"," ",9],".",["T_WHITESPACE"," ",9],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","db",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","escape",9],"(",["T_VARIABLE","$data",9],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_start'",9],"]",")",["T_WHITESPACE"," ",9],".",["T_WHITESPACE"," ",9],["T_CONSTANT_ENCAPSED_STRING","\"'\"",9],";",["T_WHITESPACE","\n\t\t",9],"}",["T_WHITESPACE","\n\n\t\t",10],["T_IF","if",12],["T_WHITESPACE"," ",12],"(","!",["T_EMPTY","empty",12],"(",["T_VARIABLE","$data",12],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_end'",12],"]",")",")",["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\t\t\t",12],["T_VARIABLE","$implode",13],"[","]",["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"DATE(ch.date_added) <= '\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","db",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","escape",13],"(",["T_VARIABLE","$data",13],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_end'",13],"]",")",["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"'\"",13],";",["T_WHITESPACE","\n\t\t",13],"}",["T_WHITESPACE","\n\n\t\t",14],["T_IF","if",16],["T_WHITESPACE"," ",16],"(",["T_VARIABLE","$implode",16],")",["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\t\t\t",16],["T_VARIABLE","$sql",17],["T_WHITESPACE"," ",17],["T_CONCAT_EQUAL",".=",17],["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","\" WHERE \"",17],["T_WHITESPACE"," ",17],".",["T_WHITESPACE"," ",17],["T_STRING","implode",17],"(",["T_CONSTANT_ENCAPSED_STRING","\" AND \"",17],",",["T_WHITESPACE"," ",17],["T_VARIABLE","$implode",17],")",";",["T_WHITESPACE","\n\t\t",17],"}",["T_WHITESPACE","\n\n\t\t",18],["T_VARIABLE","$sql",20],["T_WHITESPACE"," ",20],["T_CONCAT_EQUAL",".=",20],["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","\" GROUP BY ch.coupon_id ORDER BY total DESC\"",20],";",["T_WHITESPACE","\n\n\t\t",20],["T_IF","if",22],["T_WHITESPACE"," ",22],"(",["T_ISSET","isset",22],"(",["T_VARIABLE","$data",22],"[",["T_CONSTANT_ENCAPSED_STRING","'start'",22],"]",")",["T_WHITESPACE"," ",22],["T_BOOLEAN_OR","||",22],["T_WHITESPACE"," ",22],["T_ISSET","isset",22],"(",["T_VARIABLE","$data",22],"[",["T_CONSTANT_ENCAPSED_STRING","'limit'",22],"]",")",")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\t\t\t",22],["T_IF","if",23],["T_WHITESPACE"," ",23],"(",["T_VARIABLE","$data",23],"[",["T_CONSTANT_ENCAPSED_STRING","'start'",23],"]",["T_WHITESPACE"," ",23],"<",["T_WHITESPACE"," ",23],["T_LNUMBER","0",23],")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\t\t\t\t",23],["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'start'",24],"]",["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_LNUMBER","0",24],";",["T_WHITESPACE","\n\t\t\t",24],"}",["T_WHITESPACE","\n\n\t\t\t",25],["T_IF","if",27],["T_WHITESPACE"," ",27],"(",["T_VARIABLE","$data",27],"[",["T_CONSTANT_ENCAPSED_STRING","'limit'",27],"]",["T_WHITESPACE"," ",27],"<",["T_WHITESPACE"," ",27],["T_LNUMBER","1",27],")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n\t\t\t\t",27],["T_VARIABLE","$data",28],"[",["T_CONSTANT_ENCAPSED_STRING","'limit'",28],"]",["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_LNUMBER","20",28],";",["T_WHITESPACE","\n\t\t\t",28],"}",["T_WHITESPACE","\n\n\t\t\t",29],["T_VARIABLE","$sql",31],["T_WHITESPACE"," ",31],["T_CONCAT_EQUAL",".=",31],["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","\" LIMIT \"",31],["T_WHITESPACE"," ",31],".",["T_WHITESPACE"," ",31],["T_INT_CAST","(int)",31],["T_VARIABLE","$data",31],"[",["T_CONSTANT_ENCAPSED_STRING","'start'",31],"]",["T_WHITESPACE"," ",31],".",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","\",\"",31],["T_WHITESPACE"," ",31],".",["T_WHITESPACE"," ",31],["T_INT_CAST","(int)",31],["T_VARIABLE","$data",31],"[",["T_CONSTANT_ENCAPSED_STRING","'limit'",31],"]",";",["T_WHITESPACE","\n\t\t",31],"}",["T_WHITESPACE","\n\n\t\t",32],["T_VARIABLE","$query",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","db",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","query",34],"(",["T_VARIABLE","$sql",34],")",";",["T_WHITESPACE","\n\n\t\t",34],["T_RETURN","return",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$query",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","rows",36],";",["T_WHITESPACE","\n\t",36],"}",["T_WHITESPACE","\n\n\t",37],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","getTotalCoupons",39],"(",["T_VARIABLE","$data",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_ARRAY","array",39],"(",")",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n\t\t",39],["T_VARIABLE","$sql",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"SELECT COUNT(DISTINCT coupon_id) AS total FROM `\"",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_STRING","DB_PREFIX",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"coupon_history`\"",40],";",["T_WHITESPACE","\n\n\t\t",40],["T_VARIABLE","$implode",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_ARRAY","array",42],"(",")",";",["T_WHITESPACE","\n\n\t\t",42],["T_IF","if",44],["T_WHITESPACE"," ",44],"(","!",["T_EMPTY","empty",44],"(",["T_VARIABLE","$data",44],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_start'",44],"]",")",")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n\t\t\t",44],["T_VARIABLE","$implode",45],"[","]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"DATE(date_added) >= '\"",45],["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","db",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","escape",45],"(",["T_VARIABLE","$data",45],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_start'",45],"]",")",["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"'\"",45],";",["T_WHITESPACE","\n\t\t",45],"}",["T_WHITESPACE","\n\n\t\t",46],["T_IF","if",48],["T_WHITESPACE"," ",48],"(","!",["T_EMPTY","empty",48],"(",["T_VARIABLE","$data",48],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_end'",48],"]",")",")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n\t\t\t",48],["T_VARIABLE","$implode",49],"[","]",["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","\"DATE(date_added) <= '\"",49],["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","db",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","escape",49],"(",["T_VARIABLE","$data",49],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_date_end'",49],"]",")",["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","\"'\"",49],";",["T_WHITESPACE","\n\t\t",49],"}",["T_WHITESPACE","\n\n\t\t",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$implode",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n\t\t\t",52],["T_VARIABLE","$sql",53],["T_WHITESPACE"," ",53],["T_CONCAT_EQUAL",".=",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","\" WHERE \"",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_STRING","implode",53],"(",["T_CONSTANT_ENCAPSED_STRING","\" AND \"",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$implode",53],")",";",["T_WHITESPACE","\n\t\t",53],"}",["T_WHITESPACE","\n\n\t\t",54],["T_VARIABLE","$query",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","db",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","query",56],"(",["T_VARIABLE","$sql",56],")",";",["T_WHITESPACE","\n\n\t\t",56],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$query",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","row",58],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",58],"]",";",["T_WHITESPACE","\n\t",58],"}",["T_WHITESPACE","\n",59],"}"]