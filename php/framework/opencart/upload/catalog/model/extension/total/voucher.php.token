[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionTotalVoucher",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","addVoucher",3],"(",["T_VARIABLE","$order_id",3],",",["T_WHITESPACE"," ",3],["T_VARIABLE","$data",3],")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO \"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_STRING","DB_PREFIX",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"voucher SET order_id = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_INT_CAST","(int)",4],["T_VARIABLE","$order_id",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', code = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",4],"]",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', from_name = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'from_name'",4],"]",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', from_email = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'from_email'",4],"]",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', to_name = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'to_name'",4],"]",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', to_email = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'to_email'",4],"]",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', voucher_theme_id = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_INT_CAST","(int)",4],["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",4],"]",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', message = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",4],"]",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', amount = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_DOUBLE_CAST","(float)",4],["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",4],"]",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"', status = '1', date_added = NOW()\"",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_RETURN","return",6],["T_WHITESPACE"," ",6],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","db",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","getLastId",6],"(",")",";",["T_WHITESPACE","\n\t",6],"}",["T_WHITESPACE","\n\n\t",7],["T_PUBLIC","public",9],["T_WHITESPACE"," ",9],["T_FUNCTION","function",9],["T_WHITESPACE"," ",9],["T_STRING","disableVoucher",9],"(",["T_VARIABLE","$order_id",9],")",["T_WHITESPACE"," ",9],"{",["T_WHITESPACE","\n\t\t",9],["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","db",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","query",10],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE \"",10],["T_WHITESPACE"," ",10],".",["T_WHITESPACE"," ",10],["T_STRING","DB_PREFIX",10],["T_WHITESPACE"," ",10],".",["T_WHITESPACE"," ",10],["T_CONSTANT_ENCAPSED_STRING","\"voucher SET status = '0' WHERE order_id = '\"",10],["T_WHITESPACE"," ",10],".",["T_WHITESPACE"," ",10],["T_INT_CAST","(int)",10],["T_VARIABLE","$order_id",10],["T_WHITESPACE"," ",10],".",["T_WHITESPACE"," ",10],["T_CONSTANT_ENCAPSED_STRING","\"'\"",10],")",";",["T_WHITESPACE","\n\t",10],"}",["T_WHITESPACE","\n\n\t",11],["T_PUBLIC","public",13],["T_WHITESPACE"," ",13],["T_FUNCTION","function",13],["T_WHITESPACE"," ",13],["T_STRING","getVoucher",13],"(",["T_VARIABLE","$code",13],")",["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\t\t",13],["T_VARIABLE","$status",14],["T_WHITESPACE"," ",14],"=",["T_WHITESPACE"," ",14],["T_STRING","true",14],";",["T_WHITESPACE","\n\n\t\t",14],["T_VARIABLE","$voucher_query",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","db",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","query",16],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT *, vtd.name AS theme FROM \"",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_STRING","DB_PREFIX",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","\"voucher v LEFT JOIN \"",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_STRING","DB_PREFIX",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","\"voucher_theme vt ON (v.voucher_theme_id = vt.voucher_theme_id) LEFT JOIN \"",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_STRING","DB_PREFIX",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","\"voucher_theme_description vtd ON (vt.voucher_theme_id = vtd.voucher_theme_id) WHERE v.code = '\"",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","db",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","escape",16],"(",["T_VARIABLE","$code",16],")",["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","\"' AND vtd.language_id = '\"",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_INT_CAST","(int)",16],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","config",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","get",16],"(",["T_CONSTANT_ENCAPSED_STRING","'config_language_id'",16],")",["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","\"' AND v.status = '1'\"",16],")",";",["T_WHITESPACE","\n\n\t\t",16],["T_IF","if",18],["T_WHITESPACE"," ",18],"(",["T_VARIABLE","$voucher_query",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","num_rows",18],")",["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\t\t\t",18],["T_IF","if",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$voucher_query",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","row",19],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",19],"]",")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t\t\t",19],["T_VARIABLE","$implode",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_ARRAY","array",20],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",20],["T_FOREACH","foreach",22],["T_WHITESPACE"," ",22],"(",["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","config",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","get",22],"(",["T_CONSTANT_ENCAPSED_STRING","'config_complete_status'",22],")",["T_WHITESPACE"," ",22],["T_AS","as",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$order_status_id",22],")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\t\t\t\t\t",22],["T_VARIABLE","$implode",23],"[","]",["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","\"'\"",23],["T_WHITESPACE"," ",23],".",["T_WHITESPACE"," ",23],["T_INT_CAST","(int)",23],["T_VARIABLE","$order_status_id",23],["T_WHITESPACE"," ",23],".",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","\"'\"",23],";",["T_WHITESPACE","\n\t\t\t\t",23],"}",["T_WHITESPACE","\n\n\t\t\t\t",24],["T_VARIABLE","$order_query",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","db",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","query",26],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT order_id FROM `\"",26],["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_STRING","DB_PREFIX",26],["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","\"order` WHERE order_id = '\"",26],["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_INT_CAST","(int)",26],["T_VARIABLE","$voucher_query",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","row",26],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","\"' AND order_status_id IN(\"",26],["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_STRING","implode",26],"(",["T_CONSTANT_ENCAPSED_STRING","\",\"",26],",",["T_WHITESPACE"," ",26],["T_VARIABLE","$implode",26],")",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","\")\"",26],")",";",["T_WHITESPACE","\n\n\t\t\t\t",26],["T_IF","if",28],["T_WHITESPACE"," ",28],"(","!",["T_VARIABLE","$order_query",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","num_rows",28],")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n\t\t\t\t\t",28],["T_VARIABLE","$status",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_STRING","false",29],";",["T_WHITESPACE","\n\t\t\t\t",29],"}",["T_WHITESPACE","\n\n\t\t\t\t",30],["T_VARIABLE","$order_voucher_query",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","db",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","query",32],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT order_voucher_id FROM `\"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_STRING","DB_PREFIX",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"order_voucher` WHERE order_id = '\"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_INT_CAST","(int)",32],["T_VARIABLE","$voucher_query",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","row",32],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",32],"]",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"' AND voucher_id = '\"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_INT_CAST","(int)",32],["T_VARIABLE","$voucher_query",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","row",32],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_id'",32],"]",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"'\"",32],")",";",["T_WHITESPACE","\n\n\t\t\t\t",32],["T_IF","if",34],["T_WHITESPACE"," ",34],"(","!",["T_VARIABLE","$order_voucher_query",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","num_rows",34],")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n\t\t\t\t\t",34],["T_VARIABLE","$status",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","false",35],";",["T_WHITESPACE","\n\t\t\t\t",35],"}",["T_WHITESPACE","\n\t\t\t",36],"}",["T_WHITESPACE","\n\n\t\t\t",37],["T_VARIABLE","$voucher_history_query",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","db",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","query",39],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT SUM(amount) AS total FROM `\"",39],["T_WHITESPACE"," ",39],".",["T_WHITESPACE"," ",39],["T_STRING","DB_PREFIX",39],["T_WHITESPACE"," ",39],".",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","\"voucher_history` vh WHERE vh.voucher_id = '\"",39],["T_WHITESPACE"," ",39],".",["T_WHITESPACE"," ",39],["T_INT_CAST","(int)",39],["T_VARIABLE","$voucher_query",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","row",39],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_id'",39],"]",["T_WHITESPACE"," ",39],".",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","\"' GROUP BY vh.voucher_id\"",39],")",";",["T_WHITESPACE","\n\n\t\t\t",39],["T_IF","if",41],["T_WHITESPACE"," ",41],"(",["T_VARIABLE","$voucher_history_query",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","num_rows",41],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n\t\t\t\t",41],["T_VARIABLE","$amount",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$voucher_query",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","row",42],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",42],"]",["T_WHITESPACE"," ",42],"+",["T_WHITESPACE"," ",42],["T_VARIABLE","$voucher_history_query",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","row",42],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",42],"]",";",["T_WHITESPACE","\n\t\t\t",42],"}",["T_WHITESPACE"," ",43],["T_ELSE","else",43],["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n\t\t\t\t",43],["T_VARIABLE","$amount",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$voucher_query",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","row",44],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",44],"]",";",["T_WHITESPACE","\n\t\t\t",44],"}",["T_WHITESPACE","\n\n\t\t\t",45],["T_IF","if",47],["T_WHITESPACE"," ",47],"(",["T_VARIABLE","$amount",47],["T_WHITESPACE"," ",47],["T_IS_SMALLER_OR_EQUAL","<=",47],["T_WHITESPACE"," ",47],["T_LNUMBER","0",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n\t\t\t\t",47],["T_VARIABLE","$status",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","false",48],";",["T_WHITESPACE","\n\t\t\t",48],"}",["T_WHITESPACE","\n\t\t",49],"}",["T_WHITESPACE"," ",50],["T_ELSE","else",50],["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n\t\t\t",50],["T_VARIABLE","$status",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","false",51],";",["T_WHITESPACE","\n\t\t",51],"}",["T_WHITESPACE","\n\n\t\t",52],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$status",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n\t\t\t",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_ARRAY","array",55],"(",["T_WHITESPACE","\n\t\t\t\t",55],["T_CONSTANT_ENCAPSED_STRING","'voucher_id'",56],["T_WHITESPACE","       ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$voucher_query",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","row",56],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_id'",56],"]",",",["T_WHITESPACE","\n\t\t\t\t",56],["T_CONSTANT_ENCAPSED_STRING","'code'",57],["T_WHITESPACE","             ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$voucher_query",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","row",57],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",57],"]",",",["T_WHITESPACE","\n\t\t\t\t",57],["T_CONSTANT_ENCAPSED_STRING","'from_name'",58],["T_WHITESPACE","        ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$voucher_query",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","row",58],"[",["T_CONSTANT_ENCAPSED_STRING","'from_name'",58],"]",",",["T_WHITESPACE","\n\t\t\t\t",58],["T_CONSTANT_ENCAPSED_STRING","'from_email'",59],["T_WHITESPACE","       ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$voucher_query",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","row",59],"[",["T_CONSTANT_ENCAPSED_STRING","'from_email'",59],"]",",",["T_WHITESPACE","\n\t\t\t\t",59],["T_CONSTANT_ENCAPSED_STRING","'to_name'",60],["T_WHITESPACE","          ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$voucher_query",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","row",60],"[",["T_CONSTANT_ENCAPSED_STRING","'to_name'",60],"]",",",["T_WHITESPACE","\n\t\t\t\t",60],["T_CONSTANT_ENCAPSED_STRING","'to_email'",61],["T_WHITESPACE","         ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$voucher_query",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","row",61],"[",["T_CONSTANT_ENCAPSED_STRING","'to_email'",61],"]",",",["T_WHITESPACE","\n\t\t\t\t",61],["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$voucher_query",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","row",62],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",62],"]",",",["T_WHITESPACE","\n\t\t\t\t",62],["T_CONSTANT_ENCAPSED_STRING","'theme'",63],["T_WHITESPACE","            ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$voucher_query",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","row",63],"[",["T_CONSTANT_ENCAPSED_STRING","'theme'",63],"]",",",["T_WHITESPACE","\n\t\t\t\t",63],["T_CONSTANT_ENCAPSED_STRING","'message'",64],["T_WHITESPACE","          ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$voucher_query",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","row",64],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",64],"]",",",["T_WHITESPACE","\n\t\t\t\t",64],["T_CONSTANT_ENCAPSED_STRING","'image'",65],["T_WHITESPACE","            ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$voucher_query",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","row",65],"[",["T_CONSTANT_ENCAPSED_STRING","'image'",65],"]",",",["T_WHITESPACE","\n\t\t\t\t",65],["T_CONSTANT_ENCAPSED_STRING","'amount'",66],["T_WHITESPACE","           ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$amount",66],",",["T_WHITESPACE","\n\t\t\t\t",66],["T_CONSTANT_ENCAPSED_STRING","'status'",67],["T_WHITESPACE","           ",67],["T_DOUBLE_ARROW","=>",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$voucher_query",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","row",67],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",67],"]",",",["T_WHITESPACE","\n\t\t\t\t",67],["T_CONSTANT_ENCAPSED_STRING","'date_added'",68],["T_WHITESPACE","       ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$voucher_query",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","row",68],"[",["T_CONSTANT_ENCAPSED_STRING","'date_added'",68],"]",["T_WHITESPACE","\n\t\t\t",68],")",";",["T_WHITESPACE","\n\t\t",69],"}",["T_WHITESPACE","\n\t",70],"}",["T_WHITESPACE","\n\n\t",71],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","getTotal",73],"(",["T_VARIABLE","$total",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n\t\t",73],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_ISSET","isset",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","session",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","data",74],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher'",74],"]",")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","load",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","language",75],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/total\/voucher'",75],")",";",["T_WHITESPACE","\n\n\t\t\t",75],["T_VARIABLE","$voucher_info",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getVoucher",77],"(",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","session",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","data",77],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher'",77],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",77],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$voucher_info",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n\t\t\t\t",79],["T_VARIABLE","$amount",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","min",80],"(",["T_VARIABLE","$voucher_info",80],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",80],"]",",",["T_WHITESPACE"," ",80],["T_VARIABLE","$total",80],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",80],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\n\t\t\t\t",80],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$amount",82],["T_WHITESPACE"," ",82],">",["T_WHITESPACE"," ",82],["T_LNUMBER","0",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n\t\t\t\t\t",82],["T_VARIABLE","$total",83],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",83],"]","[","]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",83],["T_CONSTANT_ENCAPSED_STRING","'code'",84],["T_WHITESPACE","       ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'voucher'",84],",",["T_WHITESPACE","\n\t\t\t\t\t\t",84],["T_CONSTANT_ENCAPSED_STRING","'title'",85],["T_WHITESPACE","      ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_STRING","sprintf",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","language",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","get",85],"(",["T_CONSTANT_ENCAPSED_STRING","'text_voucher'",85],")",",",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","session",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","data",85],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher'",85],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",85],["T_CONSTANT_ENCAPSED_STRING","'value'",86],["T_WHITESPACE","      ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],"-",["T_VARIABLE","$amount",86],",",["T_WHITESPACE","\n\t\t\t\t\t\t",86],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","config",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","get",87],"(",["T_CONSTANT_ENCAPSED_STRING","'voucher_sort_order'",87],")",["T_WHITESPACE","\n\t\t\t\t\t",87],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",88],["T_VARIABLE","$total",90],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",90],"]",["T_WHITESPACE"," ",90],["T_MINUS_EQUAL","-=",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$amount",90],";",["T_WHITESPACE","\n\t\t\t\t",90],"}",["T_WHITESPACE"," ",91],["T_ELSE","else",91],["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t\t\t",91],["T_UNSET","unset",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","session",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","data",92],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher'",92],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",92],"}",["T_WHITESPACE","\n\t\t\t",93],"}",["T_WHITESPACE"," ",94],["T_ELSE","else",94],["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n\t\t\t\t",94],["T_UNSET","unset",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","session",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","data",95],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher'",95],"]",")",";",["T_WHITESPACE","\n\t\t\t",95],"}",["T_WHITESPACE","\n\t\t",96],"}",["T_WHITESPACE","\n\t",97],"}",["T_WHITESPACE","\n\n\t",98],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","confirm",100],"(",["T_VARIABLE","$order_info",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$order_total",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n\t\t",100],["T_VARIABLE","$code",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","''",101],";",["T_WHITESPACE","\n\n\t\t",101],["T_VARIABLE","$start",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","strpos",103],"(",["T_VARIABLE","$order_total",103],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",103],"]",",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'('",103],")",["T_WHITESPACE"," ",103],"+",["T_WHITESPACE"," ",103],["T_LNUMBER","1",103],";",["T_WHITESPACE","\n\t\t",103],["T_VARIABLE","$end",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","strrpos",104],"(",["T_VARIABLE","$order_total",104],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",104],"]",",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","')'",104],")",";",["T_WHITESPACE","\n\n\t\t",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$start",106],["T_WHITESPACE"," ",106],["T_BOOLEAN_AND","&&",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$end",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n\t\t\t",106],["T_VARIABLE","$code",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","substr",107],"(",["T_VARIABLE","$order_total",107],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",107],"]",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$start",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$end",107],["T_WHITESPACE"," ",107],"-",["T_WHITESPACE"," ",107],["T_VARIABLE","$start",107],")",";",["T_WHITESPACE","\n\t\t",107],"}",["T_WHITESPACE","\n\n\t\t",108],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_VARIABLE","$code",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n\t\t\t",110],["T_VARIABLE","$voucher_info",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getVoucher",111],"(",["T_VARIABLE","$code",111],")",";",["T_WHITESPACE","\n\n\t\t\t",111],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$voucher_info",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n\t\t\t\t",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","db",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","query",114],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_STRING","DB_PREFIX",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","\"voucher_history` SET voucher_id = '\"",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_INT_CAST","(int)",114],["T_VARIABLE","$voucher_info",114],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_id'",114],"]",["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","\"', order_id = '\"",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_INT_CAST","(int)",114],["T_VARIABLE","$order_info",114],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",114],"]",["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","\"', amount = '\"",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_DOUBLE_CAST","(float)",114],["T_VARIABLE","$order_total",114],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",114],"]",["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","\"', date_added = NOW()\"",114],")",";",["T_WHITESPACE","\n\t\t\t",114],"}",["T_WHITESPACE"," ",115],["T_ELSE","else",115],["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n\t\t\t\t",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","config",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","get",116],"(",["T_CONSTANT_ENCAPSED_STRING","'config_fraud_status_id'",116],")",";",["T_WHITESPACE","\n\t\t\t",116],"}",["T_WHITESPACE","\n\t\t",117],"}",["T_WHITESPACE","\n\t",118],"}",["T_WHITESPACE","\n\n\t",119],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","unconfirm",121],"(",["T_VARIABLE","$order_id",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n\t\t",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","db",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","query",122],"(",["T_CONSTANT_ENCAPSED_STRING","\"DELETE FROM `\"",122],["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_STRING","DB_PREFIX",122],["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","\"voucher_history` WHERE order_id = '\"",122],["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_INT_CAST","(int)",122],["T_VARIABLE","$order_id",122],["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","\"'\"",122],")",";",["T_WHITESPACE","\n\t",122],"}",["T_WHITESPACE","\n",123],"}",["T_WHITESPACE","\n",124]]