[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionTotalCoupon",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","getCoupon",3],"(",["T_VARIABLE","$code",3],")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$status",4],["T_WHITESPACE"," ",4],"=",["T_WHITESPACE"," ",4],["T_STRING","true",4],";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$coupon_query",6],["T_WHITESPACE"," ",6],"=",["T_WHITESPACE"," ",6],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","db",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","query",6],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_STRING","DB_PREFIX",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","\"coupon` WHERE code = '\"",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","db",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","escape",6],"(",["T_VARIABLE","$code",6],")",["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","\"' AND ((date_start = '0000-00-00' OR date_start < NOW()) AND (date_end = '0000-00-00' OR date_end > NOW())) AND status = '1'\"",6],")",";",["T_WHITESPACE","\n\n\t\t",6],["T_IF","if",8],["T_WHITESPACE"," ",8],"(",["T_VARIABLE","$coupon_query",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","num_rows",8],")",["T_WHITESPACE"," ",8],"{",["T_WHITESPACE","\n\t\t\t",8],["T_IF","if",9],["T_WHITESPACE"," ",9],"(",["T_VARIABLE","$coupon_query",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","row",9],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",9],"]",["T_WHITESPACE"," ",9],">",["T_WHITESPACE"," ",9],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","cart",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","getSubTotal",9],"(",")",")",["T_WHITESPACE"," ",9],"{",["T_WHITESPACE","\n\t\t\t\t",9],["T_VARIABLE","$status",10],["T_WHITESPACE"," ",10],"=",["T_WHITESPACE"," ",10],["T_STRING","false",10],";",["T_WHITESPACE","\n\t\t\t",10],"}",["T_WHITESPACE","\n\n\t\t\t",11],["T_VARIABLE","$coupon_history_query",13],["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","db",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","query",13],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT COUNT(*) AS total FROM `\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_STRING","DB_PREFIX",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"coupon_history` ch WHERE ch.coupon_id = '\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_INT_CAST","(int)",13],["T_VARIABLE","$coupon_query",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","row",13],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",13],"]",["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"'\"",13],")",";",["T_WHITESPACE","\n\n\t\t\t",13],["T_IF","if",15],["T_WHITESPACE"," ",15],"(",["T_VARIABLE","$coupon_query",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","row",15],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_total'",15],"]",["T_WHITESPACE"," ",15],">",["T_WHITESPACE"," ",15],["T_LNUMBER","0",15],["T_WHITESPACE"," ",15],["T_BOOLEAN_AND","&&",15],["T_WHITESPACE"," ",15],"(",["T_VARIABLE","$coupon_history_query",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","row",15],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",15],"]",["T_WHITESPACE"," ",15],["T_IS_GREATER_OR_EQUAL",">=",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$coupon_query",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","row",15],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_total'",15],"]",")",")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\t\t\t\t",15],["T_VARIABLE","$status",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_STRING","false",16],";",["T_WHITESPACE","\n\t\t\t",16],"}",["T_WHITESPACE","\n\n\t\t\t",17],["T_IF","if",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$coupon_query",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","row",19],"[",["T_CONSTANT_ENCAPSED_STRING","'logged'",19],"]",["T_WHITESPACE"," ",19],["T_BOOLEAN_AND","&&",19],["T_WHITESPACE"," ",19],"!",["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","customer",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","getId",19],"(",")",")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t\t\t",19],["T_VARIABLE","$status",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_STRING","false",20],";",["T_WHITESPACE","\n\t\t\t",20],"}",["T_WHITESPACE","\n\n\t\t\t",21],["T_IF","if",23],["T_WHITESPACE"," ",23],"(",["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","customer",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","getId",23],"(",")",")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\t\t\t\t",23],["T_VARIABLE","$coupon_history_query",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","query",24],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT COUNT(*) AS total FROM `\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_STRING","DB_PREFIX",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"coupon_history` ch WHERE ch.coupon_id = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_INT_CAST","(int)",24],["T_VARIABLE","$coupon_query",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","row",24],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",24],"]",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"' AND ch.customer_id = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_INT_CAST","(int)",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","customer",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","getId",24],"(",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"'\"",24],")",";",["T_WHITESPACE","\n\n\t\t\t\t",24],["T_IF","if",26],["T_WHITESPACE"," ",26],"(",["T_VARIABLE","$coupon_query",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","row",26],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_customer'",26],"]",["T_WHITESPACE"," ",26],">",["T_WHITESPACE"," ",26],["T_LNUMBER","0",26],["T_WHITESPACE"," ",26],["T_BOOLEAN_AND","&&",26],["T_WHITESPACE"," ",26],"(",["T_VARIABLE","$coupon_history_query",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","row",26],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",26],"]",["T_WHITESPACE"," ",26],["T_IS_GREATER_OR_EQUAL",">=",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$coupon_query",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","row",26],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_customer'",26],"]",")",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n\t\t\t\t\t",26],["T_VARIABLE","$status",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_STRING","false",27],";",["T_WHITESPACE","\n\t\t\t\t",27],"}",["T_WHITESPACE","\n\t\t\t",28],"}",["T_WHITESPACE","\n\n\t\t\t",29],["T_COMMENT","\/\/ Products\n",31],["T_WHITESPACE","\t\t\t",32],["T_VARIABLE","$coupon_product_data",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_ARRAY","array",32],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",32],["T_VARIABLE","$coupon_product_query",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","db",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","query",34],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_STRING","DB_PREFIX",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"coupon_product` WHERE coupon_id = '\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_INT_CAST","(int)",34],["T_VARIABLE","$coupon_query",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","row",34],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",34],"]",["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"'\"",34],")",";",["T_WHITESPACE","\n\n\t\t\t",34],["T_FOREACH","foreach",36],["T_WHITESPACE"," ",36],"(",["T_VARIABLE","$coupon_product_query",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","rows",36],["T_WHITESPACE"," ",36],["T_AS","as",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$product",36],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n\t\t\t\t",36],["T_VARIABLE","$coupon_product_data",37],"[","]",["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$product",37],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",37],"]",";",["T_WHITESPACE","\n\t\t\t",37],"}",["T_WHITESPACE","\n\n\t\t\t",38],["T_COMMENT","\/\/ Categories\n",40],["T_WHITESPACE","\t\t\t",41],["T_VARIABLE","$coupon_category_data",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",41],["T_VARIABLE","$coupon_category_query",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","db",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","query",43],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_STRING","DB_PREFIX",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"coupon_category` cc LEFT JOIN `\"",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_STRING","DB_PREFIX",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"category_path` cp ON (cc.category_id = cp.path_id) WHERE cc.coupon_id = '\"",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_INT_CAST","(int)",43],["T_VARIABLE","$coupon_query",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","row",43],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",43],"]",["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"'\"",43],")",";",["T_WHITESPACE","\n\n\t\t\t",43],["T_FOREACH","foreach",45],["T_WHITESPACE"," ",45],"(",["T_VARIABLE","$coupon_category_query",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","rows",45],["T_WHITESPACE"," ",45],["T_AS","as",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$category",45],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n\t\t\t\t",45],["T_VARIABLE","$coupon_category_data",46],"[","]",["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$category",46],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",46],"]",";",["T_WHITESPACE","\n\t\t\t",46],"}",["T_WHITESPACE","\n\n\t\t\t",47],["T_VARIABLE","$product_data",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",49],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_VARIABLE","$coupon_product_data",51],["T_WHITESPACE"," ",51],["T_BOOLEAN_OR","||",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$coupon_category_data",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n\t\t\t\t",51],["T_FOREACH","foreach",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","cart",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getProducts",52],"(",")",["T_WHITESPACE"," ",52],["T_AS","as",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$product",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n\t\t\t\t\t",52],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_STRING","in_array",53],"(",["T_VARIABLE","$product",53],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",53],"]",",",["T_WHITESPACE"," ",53],["T_VARIABLE","$coupon_product_data",53],")",")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",53],["T_VARIABLE","$product_data",54],"[","]",["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$product",54],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",54],"]",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",54],["T_CONTINUE","continue",56],";",["T_WHITESPACE","\n\t\t\t\t\t",56],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",57],["T_FOREACH","foreach",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$coupon_category_data",59],["T_WHITESPACE"," ",59],["T_AS","as",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$category_id",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",59],["T_VARIABLE","$coupon_category_query",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","db",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","query",60],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT COUNT(*) AS total FROM `\"",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_STRING","DB_PREFIX",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","\"product_to_category` WHERE `product_id` = '\"",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_INT_CAST","(int)",60],["T_VARIABLE","$product",60],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",60],"]",["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","\"' AND category_id = '\"",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_INT_CAST","(int)",60],["T_VARIABLE","$category_id",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","\"'\"",60],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",60],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$coupon_category_query",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","row",62],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",62],"]",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",62],["T_VARIABLE","$product_data",63],"[","]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$product",63],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",63],"]",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",63],["T_CONTINUE","continue",65],";",["T_WHITESPACE","\n\t\t\t\t\t\t",65],"}",["T_WHITESPACE","\n\t\t\t\t\t",66],"}",["T_WHITESPACE","\n\t\t\t\t",67],"}",["T_WHITESPACE","\n\n\t\t\t\t",68],["T_IF","if",70],["T_WHITESPACE"," ",70],"(","!",["T_VARIABLE","$product_data",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n\t\t\t\t\t",70],["T_VARIABLE","$status",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","false",71],";",["T_WHITESPACE","\n\t\t\t\t",71],"}",["T_WHITESPACE","\n\t\t\t",72],"}",["T_WHITESPACE","\n\t\t",73],"}",["T_WHITESPACE"," ",74],["T_ELSE","else",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$status",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","false",75],";",["T_WHITESPACE","\n\t\t",75],"}",["T_WHITESPACE","\n\n\t\t",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$status",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t\t",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",["T_WHITESPACE","\n\t\t\t\t",79],["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",80],["T_WHITESPACE","     ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$coupon_query",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","row",80],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",80],"]",",",["T_WHITESPACE","\n\t\t\t\t",80],["T_CONSTANT_ENCAPSED_STRING","'code'",81],["T_WHITESPACE","          ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$coupon_query",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","row",81],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",81],"]",",",["T_WHITESPACE","\n\t\t\t\t",81],["T_CONSTANT_ENCAPSED_STRING","'name'",82],["T_WHITESPACE","          ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$coupon_query",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","row",82],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",82],"]",",",["T_WHITESPACE","\n\t\t\t\t",82],["T_CONSTANT_ENCAPSED_STRING","'type'",83],["T_WHITESPACE","          ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$coupon_query",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","row",83],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",83],"]",",",["T_WHITESPACE","\n\t\t\t\t",83],["T_CONSTANT_ENCAPSED_STRING","'discount'",84],["T_WHITESPACE","      ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$coupon_query",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","row",84],"[",["T_CONSTANT_ENCAPSED_STRING","'discount'",84],"]",",",["T_WHITESPACE","\n\t\t\t\t",84],["T_CONSTANT_ENCAPSED_STRING","'shipping'",85],["T_WHITESPACE","      ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$coupon_query",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","row",85],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping'",85],"]",",",["T_WHITESPACE","\n\t\t\t\t",85],["T_CONSTANT_ENCAPSED_STRING","'total'",86],["T_WHITESPACE","         ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$coupon_query",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","row",86],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",86],"]",",",["T_WHITESPACE","\n\t\t\t\t",86],["T_CONSTANT_ENCAPSED_STRING","'product'",87],["T_WHITESPACE","       ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$product_data",87],",",["T_WHITESPACE","\n\t\t\t\t",87],["T_CONSTANT_ENCAPSED_STRING","'date_start'",88],["T_WHITESPACE","    ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$coupon_query",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","row",88],"[",["T_CONSTANT_ENCAPSED_STRING","'date_start'",88],"]",",",["T_WHITESPACE","\n\t\t\t\t",88],["T_CONSTANT_ENCAPSED_STRING","'date_end'",89],["T_WHITESPACE","      ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$coupon_query",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","row",89],"[",["T_CONSTANT_ENCAPSED_STRING","'date_end'",89],"]",",",["T_WHITESPACE","\n\t\t\t\t",89],["T_CONSTANT_ENCAPSED_STRING","'uses_total'",90],["T_WHITESPACE","    ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$coupon_query",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","row",90],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_total'",90],"]",",",["T_WHITESPACE","\n\t\t\t\t",90],["T_CONSTANT_ENCAPSED_STRING","'uses_customer'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$coupon_query",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","row",91],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_customer'",91],"]",",",["T_WHITESPACE","\n\t\t\t\t",91],["T_CONSTANT_ENCAPSED_STRING","'status'",92],["T_WHITESPACE","        ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$coupon_query",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","row",92],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",92],"]",",",["T_WHITESPACE","\n\t\t\t\t",92],["T_CONSTANT_ENCAPSED_STRING","'date_added'",93],["T_WHITESPACE","    ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$coupon_query",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","row",93],"[",["T_CONSTANT_ENCAPSED_STRING","'date_added'",93],"]",["T_WHITESPACE","\n\t\t\t",93],")",";",["T_WHITESPACE","\n\t\t",94],"}",["T_WHITESPACE","\n\t",95],"}",["T_WHITESPACE","\n\n\t",96],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","getTotal",98],"(",["T_VARIABLE","$total",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n\t\t",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_ISSET","isset",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","session",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","data",99],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon'",99],"]",")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n\t\t\t",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","load",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","language",100],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/total\/coupon'",100],")",";",["T_WHITESPACE","\n\n\t\t\t",100],["T_VARIABLE","$coupon_info",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getCoupon",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","session",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","data",102],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon'",102],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$coupon_info",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n\t\t\t\t",104],["T_VARIABLE","$discount_total",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_LNUMBER","0",105],";",["T_WHITESPACE","\n\n\t\t\t\t",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(","!",["T_VARIABLE","$coupon_info",107],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",107],"]",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n\t\t\t\t\t",107],["T_VARIABLE","$sub_total",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","cart",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getSubTotal",108],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",108],"}",["T_WHITESPACE"," ",109],["T_ELSE","else",109],["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n\t\t\t\t\t",109],["T_VARIABLE","$sub_total",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_LNUMBER","0",110],";",["T_WHITESPACE","\n\n\t\t\t\t\t",110],["T_FOREACH","foreach",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","cart",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getProducts",112],"(",")",["T_WHITESPACE"," ",112],["T_AS","as",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$product",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_STRING","in_array",113],"(",["T_VARIABLE","$product",113],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",113],"]",",",["T_WHITESPACE"," ",113],["T_VARIABLE","$coupon_info",113],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",113],"]",")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",113],["T_VARIABLE","$sub_total",114],["T_WHITESPACE"," ",114],["T_PLUS_EQUAL","+=",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$product",114],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",114],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",114],"}",["T_WHITESPACE","\n\t\t\t\t\t",115],"}",["T_WHITESPACE","\n\t\t\t\t",116],"}",["T_WHITESPACE","\n\n\t\t\t\t",117],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$coupon_info",119],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",119],"]",["T_WHITESPACE"," ",119],["T_IS_EQUAL","==",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'F'",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n\t\t\t\t\t",119],["T_VARIABLE","$coupon_info",120],"[",["T_CONSTANT_ENCAPSED_STRING","'discount'",120],"]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","min",120],"(",["T_VARIABLE","$coupon_info",120],"[",["T_CONSTANT_ENCAPSED_STRING","'discount'",120],"]",",",["T_WHITESPACE"," ",120],["T_VARIABLE","$sub_total",120],")",";",["T_WHITESPACE","\n\t\t\t\t",120],"}",["T_WHITESPACE","\n\n\t\t\t\t",121],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","cart",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getProducts",123],"(",")",["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$product",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n\t\t\t\t\t",123],["T_VARIABLE","$discount",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_LNUMBER","0",124],";",["T_WHITESPACE","\n\n\t\t\t\t\t",124],["T_IF","if",126],["T_WHITESPACE"," ",126],"(","!",["T_VARIABLE","$coupon_info",126],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",126],"]",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",126],["T_VARIABLE","$status",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","true",127],";",["T_WHITESPACE","\n\t\t\t\t\t",127],"}",["T_WHITESPACE"," ",128],["T_ELSE","else",128],["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",128],["T_VARIABLE","$status",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","in_array",129],"(",["T_VARIABLE","$product",129],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",129],"]",",",["T_WHITESPACE"," ",129],["T_VARIABLE","$coupon_info",129],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",129],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",129],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$status",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$coupon_info",133],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",133],"]",["T_WHITESPACE"," ",133],["T_IS_EQUAL","==",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'F'",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",133],["T_VARIABLE","$discount",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$coupon_info",134],"[",["T_CONSTANT_ENCAPSED_STRING","'discount'",134],"]",["T_WHITESPACE"," ",134],"*",["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$product",134],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",134],"]",["T_WHITESPACE"," ",134],"\/",["T_WHITESPACE"," ",134],["T_VARIABLE","$sub_total",134],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",134],"}",["T_WHITESPACE"," ",135],["T_ELSEIF","elseif",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$coupon_info",135],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",135],"]",["T_WHITESPACE"," ",135],["T_IS_EQUAL","==",135],["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'P'",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",135],["T_VARIABLE","$discount",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$product",136],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",136],"]",["T_WHITESPACE"," ",136],"\/",["T_WHITESPACE"," ",136],["T_LNUMBER","100",136],["T_WHITESPACE"," ",136],"*",["T_WHITESPACE"," ",136],["T_VARIABLE","$coupon_info",136],"[",["T_CONSTANT_ENCAPSED_STRING","'discount'",136],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",136],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",137],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$product",139],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",139],"]",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",139],["T_VARIABLE","$tax_rates",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","tax",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getRates",140],"(",["T_VARIABLE","$product",140],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",140],"]",["T_WHITESPACE"," ",140],"-",["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$product",140],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",140],"]",["T_WHITESPACE"," ",140],"-",["T_WHITESPACE"," ",140],["T_VARIABLE","$discount",140],")",",",["T_WHITESPACE"," ",140],["T_VARIABLE","$product",140],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",140],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",140],["T_FOREACH","foreach",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$tax_rates",142],["T_WHITESPACE"," ",142],["T_AS","as",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$tax_rate",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$tax_rate",143],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",143],"]",["T_WHITESPACE"," ",143],["T_IS_EQUAL","==",143],["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'P'",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",143],["T_VARIABLE","$total",144],"[",["T_CONSTANT_ENCAPSED_STRING","'taxes'",144],"]","[",["T_VARIABLE","$tax_rate",144],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_rate_id'",144],"]","]",["T_WHITESPACE"," ",144],["T_MINUS_EQUAL","-=",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$tax_rate",144],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",144],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",144],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t",145],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",146],"}",["T_WHITESPACE","\n\t\t\t\t\t",147],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",148],["T_VARIABLE","$discount_total",150],["T_WHITESPACE"," ",150],["T_PLUS_EQUAL","+=",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$discount",150],";",["T_WHITESPACE","\n\t\t\t\t",150],"}",["T_WHITESPACE","\n\n\t\t\t\t",151],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$coupon_info",153],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping'",153],"]",["T_WHITESPACE"," ",153],["T_BOOLEAN_AND","&&",153],["T_WHITESPACE"," ",153],["T_ISSET","isset",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","session",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","data",153],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",153],"]",")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n\t\t\t\t\t",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(","!",["T_EMPTY","empty",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","session",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","data",154],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",154],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",154],"]",")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",154],["T_VARIABLE","$tax_rates",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","tax",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getRates",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","session",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",155],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",155],"]",",",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","session",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",155],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",155],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",155],["T_FOREACH","foreach",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$tax_rates",157],["T_WHITESPACE"," ",157],["T_AS","as",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$tax_rate",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",157],["T_IF","if",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$tax_rate",158],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",158],"]",["T_WHITESPACE"," ",158],["T_IS_EQUAL","==",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'P'",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",158],["T_VARIABLE","$total",159],"[",["T_CONSTANT_ENCAPSED_STRING","'taxes'",159],"]","[",["T_VARIABLE","$tax_rate",159],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_rate_id'",159],"]","]",["T_WHITESPACE"," ",159],["T_MINUS_EQUAL","-=",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$tax_rate",159],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",159],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",159],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",160],"}",["T_WHITESPACE","\n\t\t\t\t\t",161],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",162],["T_VARIABLE","$discount_total",164],["T_WHITESPACE"," ",164],["T_PLUS_EQUAL","+=",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","session",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","data",164],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",164],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",164],"]",";",["T_WHITESPACE","\n\t\t\t\t",164],"}",["T_WHITESPACE","\n\n\t\t\t\t",165],["T_COMMENT","\/\/ If discount greater than total\n",167],["T_WHITESPACE","\t\t\t\t",168],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$discount_total",168],["T_WHITESPACE"," ",168],">",["T_WHITESPACE"," ",168],["T_VARIABLE","$total",168],")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n\t\t\t\t\t",168],["T_VARIABLE","$discount_total",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$total",169],";",["T_WHITESPACE","\n\t\t\t\t",169],"}",["T_WHITESPACE","\n\n\t\t\t\t",170],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$discount_total",172],["T_WHITESPACE"," ",172],">",["T_WHITESPACE"," ",172],["T_LNUMBER","0",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n\t\t\t\t\t",172],["T_VARIABLE","$total",173],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",173],"]","[","]",["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_ARRAY","array",173],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",173],["T_CONSTANT_ENCAPSED_STRING","'code'",174],["T_WHITESPACE","       ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'coupon'",174],",",["T_WHITESPACE","\n\t\t\t\t\t\t",174],["T_CONSTANT_ENCAPSED_STRING","'title'",175],["T_WHITESPACE","      ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_STRING","sprintf",175],"(",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","language",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","get",175],"(",["T_CONSTANT_ENCAPSED_STRING","'text_coupon'",175],")",",",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","session",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","data",175],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon'",175],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",175],["T_CONSTANT_ENCAPSED_STRING","'value'",176],["T_WHITESPACE","      ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],"-",["T_VARIABLE","$discount_total",176],",",["T_WHITESPACE","\n\t\t\t\t\t\t",176],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","config",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","get",177],"(",["T_CONSTANT_ENCAPSED_STRING","'coupon_sort_order'",177],")",["T_WHITESPACE","\n\t\t\t\t\t",177],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",178],["T_VARIABLE","$total",180],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",180],"]",["T_WHITESPACE"," ",180],["T_MINUS_EQUAL","-=",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$discount_total",180],";",["T_WHITESPACE","\n\t\t\t\t",180],"}",["T_WHITESPACE","\n\t\t\t",181],"}",["T_WHITESPACE","\n\t\t",182],"}",["T_WHITESPACE","\n\t",183],"}",["T_WHITESPACE","\n\n\t",184],["T_PUBLIC","public",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","confirm",186],"(",["T_VARIABLE","$order_info",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$order_total",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n\t\t",186],["T_VARIABLE","$code",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","''",187],";",["T_WHITESPACE","\n\n\t\t",187],["T_VARIABLE","$start",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","strpos",189],"(",["T_VARIABLE","$order_total",189],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",189],"]",",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'('",189],")",["T_WHITESPACE"," ",189],"+",["T_WHITESPACE"," ",189],["T_LNUMBER","1",189],";",["T_WHITESPACE","\n\t\t",189],["T_VARIABLE","$end",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","strrpos",190],"(",["T_VARIABLE","$order_total",190],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",190],"]",",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","')'",190],")",";",["T_WHITESPACE","\n\n\t\t",190],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$start",192],["T_WHITESPACE"," ",192],["T_BOOLEAN_AND","&&",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$end",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n\t\t\t",192],["T_VARIABLE","$code",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","substr",193],"(",["T_VARIABLE","$order_total",193],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",193],"]",",",["T_WHITESPACE"," ",193],["T_VARIABLE","$start",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$end",193],["T_WHITESPACE"," ",193],"-",["T_WHITESPACE"," ",193],["T_VARIABLE","$start",193],")",";",["T_WHITESPACE","\n\t\t",193],"}",["T_WHITESPACE","\n\n\t\t",194],["T_IF","if",196],["T_WHITESPACE"," ",196],"(",["T_VARIABLE","$code",196],")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n\t\t\t",196],["T_VARIABLE","$coupon_info",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getCoupon",197],"(",["T_VARIABLE","$code",197],")",";",["T_WHITESPACE","\n\n\t\t\t",197],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$coupon_info",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n\t\t\t\t",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","db",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","query",200],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_STRING","DB_PREFIX",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"coupon_history` SET coupon_id = '\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_INT_CAST","(int)",200],["T_VARIABLE","$coupon_info",200],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",200],"]",["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"', order_id = '\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_INT_CAST","(int)",200],["T_VARIABLE","$order_info",200],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",200],"]",["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"', customer_id = '\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_INT_CAST","(int)",200],["T_VARIABLE","$order_info",200],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",200],"]",["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"', amount = '\"",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_DOUBLE_CAST","(float)",200],["T_VARIABLE","$order_total",200],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",200],"]",["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"', date_added = NOW()\"",200],")",";",["T_WHITESPACE","\n\t\t\t",200],"}",["T_WHITESPACE"," ",201],["T_ELSE","else",201],["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n\t\t\t\t",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","config",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","get",202],"(",["T_CONSTANT_ENCAPSED_STRING","'config_fraud_status_id'",202],")",";",["T_WHITESPACE","\n\t\t\t",202],"}",["T_WHITESPACE","\n\t\t",203],"}",["T_WHITESPACE","\n\t",204],"}",["T_WHITESPACE","\n\n\t",205],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","unconfirm",207],"(",["T_VARIABLE","$order_id",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n\t\t",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","db",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","query",208],"(",["T_CONSTANT_ENCAPSED_STRING","\"DELETE FROM `\"",208],["T_WHITESPACE"," ",208],".",["T_WHITESPACE"," ",208],["T_STRING","DB_PREFIX",208],["T_WHITESPACE"," ",208],".",["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","\"coupon_history` WHERE order_id = '\"",208],["T_WHITESPACE"," ",208],".",["T_WHITESPACE"," ",208],["T_INT_CAST","(int)",208],["T_VARIABLE","$order_id",208],["T_WHITESPACE"," ",208],".",["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","\"'\"",208],")",";",["T_WHITESPACE","\n\t",208],"}",["T_WHITESPACE","\n",209],"}",["T_WHITESPACE","\n",210]]