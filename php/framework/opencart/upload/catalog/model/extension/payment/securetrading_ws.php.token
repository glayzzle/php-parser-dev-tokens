[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentSecureTradingWs",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","getMethod",3],"(",["T_VARIABLE","$address",3],",",["T_WHITESPACE"," ",3],["T_VARIABLE","$total",3],")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","load",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","language",4],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/securetrading_ws'",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$query",6],["T_WHITESPACE"," ",6],"=",["T_WHITESPACE"," ",6],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","db",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","query",6],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM \"",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_STRING","DB_PREFIX",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","\"zone_to_geo_zone WHERE geo_zone_id = '\"",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_INT_CAST","(int)",6],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","config",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","get",6],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_geo_zone_id'",6],")",["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","\"' AND country_id = '\"",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_INT_CAST","(int)",6],["T_VARIABLE","$address",6],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",6],"]",["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","\"' AND (zone_id = '\"",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_INT_CAST","(int)",6],["T_VARIABLE","$address",6],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",6],"]",["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","\"' OR zone_id = '0')\"",6],")",";",["T_WHITESPACE","\n\n\t\t",6],["T_IF","if",8],["T_WHITESPACE"," ",8],"(",["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","config",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","get",8],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_total'",8],")",["T_WHITESPACE"," ",8],">",["T_WHITESPACE"," ",8],["T_VARIABLE","$total",8],")",["T_WHITESPACE"," ",8],"{",["T_WHITESPACE","\n\t\t\t",8],["T_VARIABLE","$status",9],["T_WHITESPACE"," ",9],"=",["T_WHITESPACE"," ",9],["T_STRING","false",9],";",["T_WHITESPACE","\n\t\t",9],"}",["T_WHITESPACE"," ",10],["T_ELSEIF","elseif",10],["T_WHITESPACE"," ",10],"(","!",["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","config",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","get",10],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_geo_zone_id'",10],")",")",["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\t\t\t",10],["T_VARIABLE","$status",11],["T_WHITESPACE"," ",11],"=",["T_WHITESPACE"," ",11],["T_STRING","true",11],";",["T_WHITESPACE","\n\t\t",11],"}",["T_WHITESPACE"," ",12],["T_ELSEIF","elseif",12],["T_WHITESPACE"," ",12],"(",["T_VARIABLE","$query",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","num_rows",12],")",["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\t\t\t",12],["T_VARIABLE","$status",13],["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_STRING","true",13],";",["T_WHITESPACE","\n\t\t",13],"}",["T_WHITESPACE"," ",14],["T_ELSE","else",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\t\t\t",14],["T_VARIABLE","$status",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_STRING","false",15],";",["T_WHITESPACE","\n\t\t",15],"}",["T_WHITESPACE","\n\n\t\t",16],["T_VARIABLE","$method_data",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_ARRAY","array",18],"(",")",";",["T_WHITESPACE","\n\n\t\t",18],["T_IF","if",20],["T_WHITESPACE"," ",20],"(",["T_VARIABLE","$status",20],")",["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n\t\t\t",20],["T_VARIABLE","$method_data",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_ARRAY","array",21],"(",["T_WHITESPACE","\n\t\t\t\t",21],["T_CONSTANT_ENCAPSED_STRING","'code'",22],["T_WHITESPACE","       ",22],["T_DOUBLE_ARROW","=>",22],["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws'",22],",",["T_WHITESPACE","\n\t\t\t\t",22],["T_CONSTANT_ENCAPSED_STRING","'title'",23],["T_WHITESPACE","      ",23],["T_DOUBLE_ARROW","=>",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","language",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","get",23],"(",["T_CONSTANT_ENCAPSED_STRING","'text_title'",23],")",",",["T_WHITESPACE","\n\t\t\t\t",23],["T_CONSTANT_ENCAPSED_STRING","'terms'",24],["T_WHITESPACE","      ",24],["T_DOUBLE_ARROW","=>",24],["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","''",24],",",["T_WHITESPACE","\n\t\t\t\t",24],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","config",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","get",25],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_sort_order'",25],")",["T_WHITESPACE","\n\t\t\t",25],")",";",["T_WHITESPACE","\n\t\t",26],"}",["T_WHITESPACE","\n\n\t\t",27],["T_RETURN","return",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$method_data",29],";",["T_WHITESPACE","\n\t",29],"}",["T_WHITESPACE","\n\n\t",30],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","call",32],"(",["T_VARIABLE","$data",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n\t\t",32],["T_VARIABLE","$ch",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","curl_init",33],"(",")",";",["T_WHITESPACE","\n\n\t\t",33],["T_VARIABLE","$defaults",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_WHITESPACE","\n\t\t\t",35],["T_STRING","CURLOPT_POST",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_LNUMBER","1",36],",",["T_WHITESPACE","\n\t\t\t",36],["T_STRING","CURLOPT_HEADER",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_LNUMBER","0",37],",",["T_WHITESPACE","\n\t\t\t",37],["T_STRING","CURLOPT_SSL_VERIFYPEER",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_LNUMBER","0",38],",",["T_WHITESPACE","\n\t\t\t",38],["T_STRING","CURLOPT_URL",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/webservices.securetrading.net\/xml\/'",39],",",["T_WHITESPACE","\n\t\t\t",39],["T_STRING","CURLOPT_FRESH_CONNECT",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_LNUMBER","1",40],",",["T_WHITESPACE","\n\t\t\t",40],["T_STRING","CURLOPT_RETURNTRANSFER",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_LNUMBER","1",41],",",["T_WHITESPACE","\n\t\t\t",41],["T_STRING","CURLOPT_FORBID_REUSE",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_LNUMBER","1",42],",",["T_WHITESPACE","\n\t\t\t",42],["T_STRING","CURLOPT_TIMEOUT",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_LNUMBER","15",43],",",["T_WHITESPACE","\n\t\t\t",43],["T_STRING","CURLOPT_HTTPHEADER",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",["T_WHITESPACE","\n\t\t\t\t",44],["T_CONSTANT_ENCAPSED_STRING","'User-Agent: OpenCart - Secure Trading WS'",45],",",["T_WHITESPACE","\n\t\t\t\t",45],["T_CONSTANT_ENCAPSED_STRING","'Content-Length: '",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_STRING","strlen",46],"(",["T_VARIABLE","$data",46],")",",",["T_WHITESPACE","\n\t\t\t\t",46],["T_CONSTANT_ENCAPSED_STRING","'Authorization: Basic '",47],["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_STRING","base64_encode",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","config",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","get",47],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_username'",47],")",["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","':'",47],["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","config",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","get",47],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_password'",47],")",")",",",["T_WHITESPACE","\n\t\t\t",47],")",",",["T_WHITESPACE","\n\t\t\t",48],["T_STRING","CURLOPT_POSTFIELDS",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$data",49],",",["T_WHITESPACE","\n\t\t",49],")",";",["T_WHITESPACE","\n\n\t\t",50],["T_STRING","curl_setopt_array",52],"(",["T_VARIABLE","$ch",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$defaults",52],")",";",["T_WHITESPACE","\n\n\t\t",52],["T_VARIABLE","$response",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","curl_exec",54],"(",["T_VARIABLE","$ch",54],")",";",["T_WHITESPACE","\n\n\t\t",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$response",56],["T_WHITESPACE"," ",56],["T_IS_IDENTICAL","===",56],["T_WHITESPACE"," ",56],["T_STRING","false",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n\t\t\t",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","log",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","write",57],"(",["T_CONSTANT_ENCAPSED_STRING","'Secure Trading WS CURL Error: ('",57],["T_WHITESPACE"," ",57],".",["T_WHITESPACE"," ",57],["T_STRING","curl_errno",57],"(",["T_VARIABLE","$ch",57],")",["T_WHITESPACE"," ",57],".",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","') '",57],["T_WHITESPACE"," ",57],".",["T_WHITESPACE"," ",57],["T_STRING","curl_error",57],"(",["T_VARIABLE","$ch",57],")",")",";",["T_WHITESPACE","\n\t\t",57],"}",["T_WHITESPACE","\n\n\t\t",58],["T_STRING","curl_close",60],"(",["T_VARIABLE","$ch",60],")",";",["T_WHITESPACE","\n\n\t\t",60],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$response",62],";",["T_WHITESPACE","\n\t",62],"}",["T_WHITESPACE","\n\n\t",63],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getOrder",65],"(",["T_VARIABLE","$order_id",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$qry",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","db",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","query",66],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_STRING","DB_PREFIX",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` WHERE `order_id` = '\"",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_INT_CAST","(int)",66],["T_VARIABLE","$order_id",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",66],")",";",["T_WHITESPACE","\n\n\t\t",66],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$qry",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","row",68],";",["T_WHITESPACE","\n\t",68],"}",["T_WHITESPACE","\n\n\t",69],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","addMd",71],"(",["T_VARIABLE","$order_id",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$md",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n\t\t",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","db",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","query",72],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO \"",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_STRING","DB_PREFIX",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order SET order_id = \"",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_INT_CAST","(int)",72],["T_VARIABLE","$order_id",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","\", md = '\"",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","db",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","escape",72],"(",["T_VARIABLE","$md",72],")",["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","\"', `created` = now(), `modified` = now()\"",72],")",";",["T_WHITESPACE","\n\t",72],"}",["T_WHITESPACE","\n\n\t",73],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","removeMd",75],"(",["T_VARIABLE","$md",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n\t\t",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","db",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","query",76],"(",["T_CONSTANT_ENCAPSED_STRING","\"DELETE FROM \"",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_STRING","DB_PREFIX",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order WHERE md = '\"",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","db",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","escape",76],"(",["T_VARIABLE","$md",76],")",["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","\"'\"",76],")",";",["T_WHITESPACE","\n\t",76],"}",["T_WHITESPACE","\n\n\t",77],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","updateReference",79],"(",["T_VARIABLE","$order_id",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$transaction_reference",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n\t\t",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","db",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","query",80],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE \"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_STRING","DB_PREFIX",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order SET transaction_reference = '\"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","db",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","escape",80],"(",["T_VARIABLE","$transaction_reference",80],")",["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE order_id = \"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_INT_CAST","(int)",80],["T_VARIABLE","$order_id",80],")",";",["T_WHITESPACE","\n\n\t\t",80],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","db",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","countAffected",82],"(",")",["T_WHITESPACE"," ",82],["T_IS_EQUAL","==",82],["T_WHITESPACE"," ",82],["T_LNUMBER","0",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n\t\t\t",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","db",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","query",83],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO \"",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_STRING","DB_PREFIX",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order SET order_id = \"",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_INT_CAST","(int)",83],["T_VARIABLE","$order_id",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","\", transaction_reference = '\"",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","db",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","escape",83],"(",["T_VARIABLE","$transaction_reference",83],")",["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","\"', `created` = now(), `modified` = now()\"",83],")",";",["T_WHITESPACE","\n\t\t",83],"}",["T_WHITESPACE","\n\t",84],"}",["T_WHITESPACE","\n\n\t",85],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","getOrderId",87],"(",["T_VARIABLE","$md",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n\t\t",87],["T_VARIABLE","$row",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","db",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","query",88],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT order_id FROM \"",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_STRING","DB_PREFIX",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order WHERE md = '\"",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","db",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","escape",88],"(",["T_VARIABLE","$md",88],")",["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",88],")",["T_OBJECT_OPERATOR","->",88],["T_STRING","row",88],";",["T_WHITESPACE","\n\n\t\t",88],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_ISSET","isset",90],"(",["T_VARIABLE","$row",90],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",90],"]",")",["T_WHITESPACE"," ",90],["T_BOOLEAN_AND","&&",90],["T_WHITESPACE"," ",90],"!",["T_EMPTY","empty",90],"(",["T_VARIABLE","$row",90],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",90],"]",")",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n\t\t\t",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$row",91],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",91],"]",";",["T_WHITESPACE","\n\t\t",91],"}",["T_WHITESPACE"," ",92],["T_ELSE","else",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n\t\t\t",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_STRING","false",93],";",["T_WHITESPACE","\n\t\t",93],"}",["T_WHITESPACE","\n\t",94],"}",["T_WHITESPACE","\n\n\t",95],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","confirmOrder",97],"(",["T_VARIABLE","$order_id",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$order_status_id",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$comment",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","''",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$notify",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","false",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n\t\t",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","load",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","model",98],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",98],")",";",["T_WHITESPACE","\n\n\t\t",98],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","db",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","query",100],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",100],["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_STRING","DB_PREFIX",100],["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","\"order` SET order_status_id = 0 WHERE order_id = \"",100],["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_INT_CAST","(int)",100],["T_VARIABLE","$order_id",100],")",";",["T_WHITESPACE","\n\n\t\t",100],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","model_checkout_order",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","addOrderHistory",102],"(",["T_VARIABLE","$order_id",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$order_status_id",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$comment",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$notify",102],")",";",["T_WHITESPACE","\n\n\t\t",102],["T_VARIABLE","$order_info",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","model_checkout_order",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getOrder",104],"(",["T_VARIABLE","$order_id",104],")",";",["T_WHITESPACE","\n\n\t\t",104],["T_VARIABLE","$securetrading_ws_order",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getOrder",106],"(",["T_VARIABLE","$order_info",106],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",106],"]",")",";",["T_WHITESPACE","\n\n\t\t",106],["T_VARIABLE","$amount",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","currency",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","format",108],"(",["T_VARIABLE","$order_info",108],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",108],"]",",",["T_WHITESPACE"," ",108],["T_VARIABLE","$order_info",108],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",108],"]",",",["T_WHITESPACE"," ",108],["T_STRING","false",108],",",["T_WHITESPACE"," ",108],["T_STRING","false",108],")",";",["T_WHITESPACE","\n\n\t\t",108],["T_SWITCH","switch",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","config",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","get",110],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_settle_status'",110],")",")","{",["T_WHITESPACE","\n\t\t\t",110],["T_CASE","case",111],["T_WHITESPACE"," ",111],["T_LNUMBER","0",111],":",["T_WHITESPACE","\n\t\t\t\t",111],["T_VARIABLE","$trans_type",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'auth'",112],";",["T_WHITESPACE","\n\t\t\t\t",112],["T_BREAK","break",113],";",["T_WHITESPACE","\n\t\t\t",113],["T_CASE","case",114],["T_WHITESPACE"," ",114],["T_LNUMBER","1",114],":",["T_WHITESPACE","\n\t\t\t\t",114],["T_VARIABLE","$trans_type",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'auth'",115],";",["T_WHITESPACE","\n\t\t\t\t",115],["T_BREAK","break",116],";",["T_WHITESPACE","\n\t\t\t",116],["T_CASE","case",117],["T_WHITESPACE"," ",117],["T_LNUMBER","2",117],":",["T_WHITESPACE","\n\t\t\t\t",117],["T_VARIABLE","$trans_type",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'suspended'",118],";",["T_WHITESPACE","\n\t\t\t\t",118],["T_BREAK","break",119],";",["T_WHITESPACE","\n\t\t\t",119],["T_CASE","case",120],["T_WHITESPACE"," ",120],["T_LNUMBER","100",120],":",["T_WHITESPACE","\n\t\t\t\t",120],["T_VARIABLE","$trans_type",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'payment'",121],";",["T_WHITESPACE","\n\t\t\t\t",121],["T_BREAK","break",122],";",["T_WHITESPACE","\n\t\t\t",122],["T_DEFAULT","default",123],["T_WHITESPACE"," ",123],":",["T_WHITESPACE","\n\t\t\t\t",123],["T_VARIABLE","$trans_type",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","''",124],";",["T_WHITESPACE","\n\t\t",124],"}",["T_WHITESPACE","\n\n\t\t",125],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","db",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","query",127],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_STRING","DB_PREFIX",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order` SET `settle_type` = '\"",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","config",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","get",127],"(",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_settle_status'",127],")",["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","\"', `modified` = now(), `currency_code` = '\"",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","db",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","escape",127],"(",["T_VARIABLE","$order_info",127],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",127],"]",")",["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","\"', `total` = '\"",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_VARIABLE","$amount",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE order_id = \"",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_INT_CAST","(int)",127],["T_VARIABLE","$order_info",127],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",127],"]",")",";",["T_WHITESPACE","\n\n\t\t",127],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","db",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","query",129],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_STRING","DB_PREFIX",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"securetrading_ws_order_transaction` SET `securetrading_ws_order_id` = '\"",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_INT_CAST","(int)",129],["T_VARIABLE","$securetrading_ws_order",129],"[",["T_CONSTANT_ENCAPSED_STRING","'securetrading_ws_order_id'",129],"]",["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_VARIABLE","$amount",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"', type = '\"",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_VARIABLE","$trans_type",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"',  `created` = now()\"",129],")",";",["T_WHITESPACE","\n\t",129],"}",["T_WHITESPACE","\n\n\t",130],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","updateOrder",132],"(",["T_VARIABLE","$order_id",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$order_status_id",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$comment",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","''",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$notify",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","false",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n\t\t",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","load",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","model",133],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",133],")",";",["T_WHITESPACE","\n\n\t\t",133],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","db",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","query",135],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_STRING","DB_PREFIX",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\"order` SET order_status_id = \"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_INT_CAST","(int)",135],["T_VARIABLE","$order_status_id",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\" WHERE order_id = \"",135],["T_WHITESPACE","  ",135],".",["T_WHITESPACE"," ",135],["T_INT_CAST","(int)",135],["T_VARIABLE","$order_id",135],")",";",["T_WHITESPACE","\n\n\t\t",135],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","model_checkout_order",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","addOrderHistory",137],"(",["T_VARIABLE","$order_id",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$order_status_id",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$comment",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$notify",137],")",";",["T_WHITESPACE","\n\t",137],"}",["T_WHITESPACE","\n\n\t",138],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","logger",140],"(",["T_VARIABLE","$message",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n\t\t",140],["T_VARIABLE","$log",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_NEW","new",141],["T_WHITESPACE"," ",141],["T_STRING","Log",141],"(",["T_CONSTANT_ENCAPSED_STRING","'secure.log'",141],")",";",["T_WHITESPACE","\n\t\t",141],["T_VARIABLE","$log",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","write",142],"(",["T_VARIABLE","$message",142],")",";",["T_WHITESPACE","\n\t",142],"}",["T_WHITESPACE","\n",143],"}",["T_WHITESPACE","\n",144]]