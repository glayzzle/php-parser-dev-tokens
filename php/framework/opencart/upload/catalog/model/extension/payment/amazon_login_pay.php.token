[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionPaymentAmazonLoginPay",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","getCountry",3],"(",["T_VARIABLE","$iso2",3],")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_RETURN","return",4],["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","query",4],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `country_id`, `name`, `iso_code_2`, `iso_code_3`, `address_format` FROM `\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_STRING","DB_PREFIX",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"country` WHERE `iso_code_2` = '\"",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","db",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","escape",4],"(",["T_STRING","strtoupper",4],"(",["T_VARIABLE","$iso2",4],")",")",["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","\"' AND `status` = 1 LIMIT 1\"",4],")",["T_OBJECT_OPERATOR","->",4],["T_STRING","row",4],";",["T_WHITESPACE","\n\t",4],"}",["T_WHITESPACE","\n\n\t",5],["T_PUBLIC","public",7],["T_WHITESPACE"," ",7],["T_FUNCTION","function",7],["T_WHITESPACE"," ",7],["T_STRING","getZone",7],"(",["T_VARIABLE","$name",7],",",["T_WHITESPACE"," ",7],["T_VARIABLE","$country_id",7],")",["T_WHITESPACE"," ",7],"{",["T_WHITESPACE","\n\t\t",7],["T_RETURN","return",8],["T_WHITESPACE"," ",8],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","db",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","query",8],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `zone_id`, `code` FROM `\"",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_STRING","DB_PREFIX",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","\"zone` WHERE (LOWER(`name`) LIKE '\"",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","db",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","escape",8],"(",["T_STRING","strtolower",8],"(",["T_VARIABLE","$name",8],")",")",["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","\"' OR `code` LIKE '\"",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","db",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","escape",8],"(",["T_STRING","strtolower",8],"(",["T_VARIABLE","$name",8],")",")",["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","\"') AND `country_id` = \"",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_INT_CAST","(int)",8],["T_VARIABLE","$country_id",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","\" LIMIT 1\"",8],")",["T_OBJECT_OPERATOR","->",8],["T_STRING","row",8],";",["T_WHITESPACE","\n\t",8],"}",["T_WHITESPACE","\n\n\t",9],["T_PUBLIC","public",11],["T_WHITESPACE"," ",11],["T_FUNCTION","function",11],["T_WHITESPACE"," ",11],["T_STRING","addTaxesForTotals",11],"(",["T_VARIABLE","$order_id",11],",",["T_WHITESPACE"," ",11],["T_VARIABLE","$totals",11],")",["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\t\t",11],["T_FOREACH","foreach",12],["T_WHITESPACE"," ",12],"(",["T_VARIABLE","$totals",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_VARIABLE","$total",12],")",["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\t\t\t",12],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","db",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","query",13],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_STRING","DB_PREFIX",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order_total_tax` (`order_total_id`, `code`, `tax`) SELECT `order_total_id`, `code`, \"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_DOUBLE_CAST","(float)",13],["T_VARIABLE","$total",13],"[",["T_CONSTANT_ENCAPSED_STRING","'lpa_tax'",13],"]",["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\" FROM `\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_STRING","DB_PREFIX",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"order_total` WHERE `order_id` = \"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_INT_CAST","(int)",13],["T_VARIABLE","$order_id",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\" AND `code` = '\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","db",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","escape",13],"(",["T_VARIABLE","$total",13],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",13],"]",")",["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"' AND `title` = '\"",13],["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","db",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","escape",13],"(",["T_VARIABLE","$total",13],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",13],"]",")",["T_WHITESPACE"," ",13],".",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","\"'\"",13],")",";",["T_WHITESPACE","\n\t\t",13],"}",["T_WHITESPACE","\n\t",14],"}",["T_WHITESPACE","\n\n\t",15],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_FUNCTION","function",17],["T_WHITESPACE"," ",17],["T_STRING","addCustomer",17],"(",["T_VARIABLE","$data",17],")",["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\t\t",17],["T_VARIABLE","$customer_group_id",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","config",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","get",18],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_group_id'",18],")",";",["T_WHITESPACE","\n\n\t\t",18],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","load",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","model",20],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/customer_group'",20],")",";",["T_WHITESPACE","\n\n\t\t",20],["T_VARIABLE","$customer_group_info",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","model_account_customer_group",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","getCustomerGroup",22],"(",["T_VARIABLE","$customer_group_id",22],")",";",["T_WHITESPACE","\n\n\t\t",22],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","query",24],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO \"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_STRING","DB_PREFIX",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"customer SET customer_group_id = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_INT_CAST","(int)",24],["T_VARIABLE","$customer_group_id",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', store_id = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_INT_CAST","(int)",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","config",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","get",24],"(",["T_CONSTANT_ENCAPSED_STRING","'config_store_id'",24],")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', firstname = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",24],"]",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', lastname = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",24],"]",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', email = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",24],"]",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', telephone = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",24],"]",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', fax = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",24],"]",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', custom_field = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_ISSET","isset",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",24],"]","[",["T_CONSTANT_ENCAPSED_STRING","'account'",24],"]",")",["T_WHITESPACE"," ",24],"?",["T_WHITESPACE"," ",24],["T_STRING","json_encode",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",24],"]","[",["T_CONSTANT_ENCAPSED_STRING","'account'",24],"]",")",["T_WHITESPACE"," ",24],":",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","''",24],")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', salt = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$salt",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","token",24],"(",["T_LNUMBER","9",24],")",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', password = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_STRING","sha1",24],"(",["T_VARIABLE","$salt",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_STRING","sha1",24],"(",["T_VARIABLE","$salt",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_STRING","sha1",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",24],"]",")",")",")",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', newsletter = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],"(",["T_ISSET","isset",24],"(",["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",24],"]",")",["T_WHITESPACE"," ",24],"?",["T_WHITESPACE"," ",24],["T_INT_CAST","(int)",24],["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",24],"]",["T_WHITESPACE"," ",24],":",["T_WHITESPACE"," ",24],["T_LNUMBER","0",24],")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', ip = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","db",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","escape",24],"(",["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","request",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","server",24],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",24],"]",")",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', status = '1', approved = '\"",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_INT_CAST","(int)",24],"!",["T_VARIABLE","$customer_group_info",24],"[",["T_CONSTANT_ENCAPSED_STRING","'approval'",24],"]",["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"', date_added = NOW()\"",24],")",";",["T_WHITESPACE","\n\n\t\t",24],["T_VARIABLE","$customer_id",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","db",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","getLastId",26],"(",")",";",["T_WHITESPACE","\n\n\t\t",26],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","load",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","language",28],"(",["T_CONSTANT_ENCAPSED_STRING","'mail\/customer'",28],")",";",["T_WHITESPACE","\n\n\t\t",28],["T_VARIABLE","$subject",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_STRING","sprintf",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","language",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","get",30],"(",["T_CONSTANT_ENCAPSED_STRING","'text_subject'",30],")",",",["T_WHITESPACE"," ",30],["T_STRING","html_entity_decode",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","config",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","get",30],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",30],")",",",["T_WHITESPACE"," ",30],["T_STRING","ENT_QUOTES",30],",",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",30],")",")",";",["T_WHITESPACE","\n\n\t\t",30],["T_VARIABLE","$message",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","sprintf",32],"(",["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","language",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","get",32],"(",["T_CONSTANT_ENCAPSED_STRING","'text_welcome'",32],")",",",["T_WHITESPACE"," ",32],["T_STRING","html_entity_decode",32],"(",["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","config",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","get",32],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",32],")",",",["T_WHITESPACE"," ",32],["T_STRING","ENT_QUOTES",32],",",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",32],")",")",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"\\n\\n\"",32],";",["T_WHITESPACE","\n\n\t\t",32],["T_IF","if",34],["T_WHITESPACE"," ",34],"(","!",["T_VARIABLE","$customer_group_info",34],"[",["T_CONSTANT_ENCAPSED_STRING","'approval'",34],"]",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n\t\t\t",34],["T_VARIABLE","$message",35],["T_WHITESPACE"," ",35],["T_CONCAT_EQUAL",".=",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","language",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","get",35],"(",["T_CONSTANT_ENCAPSED_STRING","'text_login'",35],")",["T_WHITESPACE"," ",35],".",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",35],";",["T_WHITESPACE","\n\t\t",35],"}",["T_WHITESPACE"," ",36],["T_ELSE","else",36],["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n\t\t\t",36],["T_VARIABLE","$message",37],["T_WHITESPACE"," ",37],["T_CONCAT_EQUAL",".=",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","language",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","get",37],"(",["T_CONSTANT_ENCAPSED_STRING","'text_approval'",37],")",["T_WHITESPACE"," ",37],".",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",37],";",["T_WHITESPACE","\n\t\t",37],"}",["T_WHITESPACE","\n\n\t\t",38],["T_VARIABLE","$message",40],["T_WHITESPACE"," ",40],["T_CONCAT_EQUAL",".=",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","url",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","link",40],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/login'",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","''",40],",",["T_WHITESPACE"," ",40],["T_STRING","true",40],")",["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"\\n\\n\"",40],";",["T_WHITESPACE","\n\t\t",40],["T_VARIABLE","$message",41],["T_WHITESPACE"," ",41],["T_CONCAT_EQUAL",".=",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","language",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","get",41],"(",["T_CONSTANT_ENCAPSED_STRING","'text_services'",41],")",["T_WHITESPACE"," ",41],".",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","\"\\n\\n\"",41],";",["T_WHITESPACE","\n\t\t",41],["T_VARIABLE","$message",42],["T_WHITESPACE"," ",42],["T_CONCAT_EQUAL",".=",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","language",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","get",42],"(",["T_CONSTANT_ENCAPSED_STRING","'text_thanks'",42],")",["T_WHITESPACE"," ",42],".",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",42],";",["T_WHITESPACE","\n\t\t",42],["T_VARIABLE","$message",43],["T_WHITESPACE"," ",43],["T_CONCAT_EQUAL",".=",43],["T_WHITESPACE"," ",43],["T_STRING","html_entity_decode",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","config",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","get",43],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",43],")",",",["T_WHITESPACE"," ",43],["T_STRING","ENT_QUOTES",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",43],")",";",["T_WHITESPACE","\n\n\t\t",43],["T_VARIABLE","$mail",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_NEW","new",45],["T_WHITESPACE"," ",45],["T_STRING","Mail",45],"(",")",";",["T_WHITESPACE","\n\t\t",45],["T_VARIABLE","$mail",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","protocol",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","config",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","get",46],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_protocol'",46],")",";",["T_WHITESPACE","\n\t\t",46],["T_VARIABLE","$mail",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","parameter",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","config",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","get",47],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_parameter'",47],")",";",["T_WHITESPACE","\n\t\t",47],["T_VARIABLE","$mail",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","smtp_hostname",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","config",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","get",48],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_hostname'",48],")",";",["T_WHITESPACE","\n\t\t",48],["T_VARIABLE","$mail",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","smtp_username",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","config",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_username'",49],")",";",["T_WHITESPACE","\n\t\t",49],["T_VARIABLE","$mail",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","smtp_password",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","html_entity_decode",50],"(",["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","config",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_password'",50],")",",",["T_WHITESPACE"," ",50],["T_STRING","ENT_QUOTES",50],",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",50],")",";",["T_WHITESPACE","\n\t\t",50],["T_VARIABLE","$mail",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","smtp_port",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","config",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","get",51],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_port'",51],")",";",["T_WHITESPACE","\n\t\t",51],["T_VARIABLE","$mail",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","smtp_timeout",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","config",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","get",52],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_timeout'",52],")",";",["T_WHITESPACE","\n\n\t\t",52],["T_VARIABLE","$mail",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","setTo",54],"(",["T_VARIABLE","$data",54],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",54],"]",")",";",["T_WHITESPACE","\n\t\t",54],["T_VARIABLE","$mail",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","setFrom",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","config",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","get",55],"(",["T_CONSTANT_ENCAPSED_STRING","'config_email'",55],")",")",";",["T_WHITESPACE","\n\t\t",55],["T_VARIABLE","$mail",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","setSender",56],"(",["T_STRING","html_entity_decode",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","config",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","get",56],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",56],")",",",["T_WHITESPACE"," ",56],["T_STRING","ENT_QUOTES",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",56],")",")",";",["T_WHITESPACE","\n\t\t",56],["T_VARIABLE","$mail",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","setSubject",57],"(",["T_VARIABLE","$subject",57],")",";",["T_WHITESPACE","\n\t\t",57],["T_VARIABLE","$mail",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","setText",58],"(",["T_VARIABLE","$message",58],")",";",["T_WHITESPACE","\n\t\t",58],["T_VARIABLE","$mail",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","send",59],"(",")",";",["T_WHITESPACE","\n\n\t\t",59],["T_COMMENT","\/\/ Send to main admin email if new account email is enabled\n",61],["T_WHITESPACE","\t\t",62],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_STRING","in_array",62],"(",["T_CONSTANT_ENCAPSED_STRING","'account'",62],",",["T_WHITESPACE"," ",62],["T_ARRAY_CAST","(array)",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","config",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","get",62],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_alert'",62],")",")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n\t\t\t",62],["T_VARIABLE","$message",63],["T_WHITESPACE","  ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","language",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","get",63],"(",["T_CONSTANT_ENCAPSED_STRING","'text_signup'",63],")",["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","\"\\n\\n\"",63],";",["T_WHITESPACE","\n\t\t\t",63],["T_VARIABLE","$message",64],["T_WHITESPACE"," ",64],["T_CONCAT_EQUAL",".=",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","language",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","get",64],"(",["T_CONSTANT_ENCAPSED_STRING","'text_website'",64],")",["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","' '",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_STRING","html_entity_decode",64],"(",["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","config",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","get",64],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",64],")",",",["T_WHITESPACE"," ",64],["T_STRING","ENT_QUOTES",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",64],")",["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",64],";",["T_WHITESPACE","\n\t\t\t",64],["T_VARIABLE","$message",65],["T_WHITESPACE"," ",65],["T_CONCAT_EQUAL",".=",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","language",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","get",65],"(",["T_CONSTANT_ENCAPSED_STRING","'text_firstname'",65],")",["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","' '",65],["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_VARIABLE","$data",65],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",65],"]",["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",65],";",["T_WHITESPACE","\n\t\t\t",65],["T_VARIABLE","$message",66],["T_WHITESPACE"," ",66],["T_CONCAT_EQUAL",".=",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","language",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","get",66],"(",["T_CONSTANT_ENCAPSED_STRING","'text_lastname'",66],")",["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","' '",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$data",66],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",66],"]",["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",66],";",["T_WHITESPACE","\n\t\t\t",66],["T_VARIABLE","$message",67],["T_WHITESPACE"," ",67],["T_CONCAT_EQUAL",".=",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","language",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","get",67],"(",["T_CONSTANT_ENCAPSED_STRING","'text_customer_group'",67],")",["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","' '",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_VARIABLE","$customer_group_info",67],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",67],"]",["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",67],";",["T_WHITESPACE","\n\t\t\t",67],["T_VARIABLE","$message",68],["T_WHITESPACE"," ",68],["T_CONCAT_EQUAL",".=",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","language",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","get",68],"(",["T_CONSTANT_ENCAPSED_STRING","'text_email'",68],")",["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","' '",68],["T_WHITESPACE","  ",68],".",["T_WHITESPACE","  ",68],["T_VARIABLE","$data",68],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",68],"]",["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",68],";",["T_WHITESPACE","\n\t\t\t",68],["T_VARIABLE","$message",69],["T_WHITESPACE"," ",69],["T_CONCAT_EQUAL",".=",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","language",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","get",69],"(",["T_CONSTANT_ENCAPSED_STRING","'text_telephone'",69],")",["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","' '",69],["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_VARIABLE","$data",69],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",69],"]",["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",69],";",["T_WHITESPACE","\n\n\t\t\t",69],["T_VARIABLE","$mail",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_NEW","new",71],["T_WHITESPACE"," ",71],["T_STRING","Mail",71],"(",")",";",["T_WHITESPACE","\n\t\t\t",71],["T_VARIABLE","$mail",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","protocol",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","config",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","get",72],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_protocol'",72],")",";",["T_WHITESPACE","\n\t\t\t",72],["T_VARIABLE","$mail",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","parameter",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","config",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","get",73],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_parameter'",73],")",";",["T_WHITESPACE","\n\t\t\t",73],["T_VARIABLE","$mail",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","smtp_hostname",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","config",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","get",74],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_hostname'",74],")",";",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$mail",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","smtp_username",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","config",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","get",75],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_username'",75],")",";",["T_WHITESPACE","\n\t\t\t",75],["T_VARIABLE","$mail",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","smtp_password",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","html_entity_decode",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","config",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","get",76],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_password'",76],")",",",["T_WHITESPACE"," ",76],["T_STRING","ENT_QUOTES",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",76],")",";",["T_WHITESPACE","\n\t\t\t",76],["T_VARIABLE","$mail",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","smtp_port",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","config",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","get",77],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_port'",77],")",";",["T_WHITESPACE","\n\t\t\t",77],["T_VARIABLE","$mail",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","smtp_timeout",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","config",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","get",78],"(",["T_CONSTANT_ENCAPSED_STRING","'config_mail_smtp_timeout'",78],")",";",["T_WHITESPACE","\n\n\t\t\t",78],["T_VARIABLE","$mail",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","setTo",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","config",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","get",80],"(",["T_CONSTANT_ENCAPSED_STRING","'config_email'",80],")",")",";",["T_WHITESPACE","\n\t\t\t",80],["T_VARIABLE","$mail",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setFrom",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","config",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","get",81],"(",["T_CONSTANT_ENCAPSED_STRING","'config_email'",81],")",")",";",["T_WHITESPACE","\n\t\t\t",81],["T_VARIABLE","$mail",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","setSender",82],"(",["T_STRING","html_entity_decode",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","config",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","get",82],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",82],")",",",["T_WHITESPACE"," ",82],["T_STRING","ENT_QUOTES",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",82],")",")",";",["T_WHITESPACE","\n\t\t\t",82],["T_VARIABLE","$mail",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","setSubject",83],"(",["T_STRING","html_entity_decode",83],"(",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","language",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","get",83],"(",["T_CONSTANT_ENCAPSED_STRING","'text_new_customer'",83],")",",",["T_WHITESPACE"," ",83],["T_STRING","ENT_QUOTES",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",83],")",")",";",["T_WHITESPACE","\n\t\t\t",83],["T_VARIABLE","$mail",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","setText",84],"(",["T_VARIABLE","$message",84],")",";",["T_WHITESPACE","\n\t\t\t",84],["T_VARIABLE","$mail",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","send",85],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",85],["T_COMMENT","\/\/ Send to additional alert emails if new account email is enabled\n",87],["T_WHITESPACE","\t\t\t",88],["T_VARIABLE","$emails",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","explode",88],"(",["T_CONSTANT_ENCAPSED_STRING","','",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","config",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","get",88],"(",["T_CONSTANT_ENCAPSED_STRING","'config_alert_email'",88],")",")",";",["T_WHITESPACE","\n\n\t\t\t",88],["T_FOREACH","foreach",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$emails",90],["T_WHITESPACE"," ",90],["T_AS","as",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$email",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n\t\t\t\t",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_STRING","utf8_strlen",91],"(",["T_VARIABLE","$email",91],")",["T_WHITESPACE"," ",91],">",["T_WHITESPACE"," ",91],["T_LNUMBER","0",91],["T_WHITESPACE"," ",91],["T_BOOLEAN_AND","&&",91],["T_WHITESPACE"," ",91],["T_STRING","filter_var",91],"(",["T_VARIABLE","$email",91],",",["T_WHITESPACE"," ",91],["T_STRING","FILTER_VALIDATE_EMAIL",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t\t\t",91],["T_VARIABLE","$mail",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","setTo",92],"(",["T_VARIABLE","$email",92],")",";",["T_WHITESPACE","\n\t\t\t\t\t",92],["T_VARIABLE","$mail",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","send",93],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",93],"}",["T_WHITESPACE","\n\t\t\t",94],"}",["T_WHITESPACE","\n\t\t",95],"}",["T_WHITESPACE","\n\n\t\t",96],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$customer_id",98],";",["T_WHITESPACE","\n\t",98],"}",["T_WHITESPACE","\n\n\t",99],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","getAddress",101],"(",")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n\t\t",101],["T_VARIABLE","$address_paramter_data",102],"[",["T_CONSTANT_ENCAPSED_STRING","'AddressConsentToken'",102],"]",["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","session",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","data",102],"[",["T_CONSTANT_ENCAPSED_STRING","'access_token'",102],"]",";",["T_WHITESPACE","\n\t\t",102],["T_VARIABLE","$address",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","model_extension_payment_amazon_login_pay",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","offAmazon",103],"(",["T_CONSTANT_ENCAPSED_STRING","'GetOrderReferenceDetails'",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$address_paramter_data",103],")",";",["T_WHITESPACE","\n\t\t",103],["T_VARIABLE","$xml",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","simplexml_load_string",104],"(",["T_VARIABLE","$address",104],"[",["T_CONSTANT_ENCAPSED_STRING","'ResponseBody'",104],"]",")",";",["T_WHITESPACE","\n\t\t",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_ISSET","isset",105],"(",["T_VARIABLE","$xml",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","GetOrderReferenceDetailsResult",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","OrderReferenceDetails",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","Destination",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","PhysicalDestination",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n\t\t\t",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$xml",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","GetOrderReferenceDetailsResult",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","OrderReferenceDetails",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","Destination",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","PhysicalDestination",106],";",["T_WHITESPACE","\n\t\t",106],"}",["T_WHITESPACE","\n\t",107],"}",["T_WHITESPACE","\n\n\t",108],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","addAddress",110],"(",["T_VARIABLE","$address",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n\t\t",110],["T_VARIABLE","$query",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","query",111],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_STRING","DB_PREFIX",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"address` WHERE `firstname` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `lastname` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `address_1` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'address_1'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `address_2` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'address_2'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `postcode` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'postcode'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `city` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'city'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `zone_id` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"' AND `country_id` = '\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$address",111],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"'\"",111],")",";",["T_WHITESPACE","\n\t\t",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(","!",["T_VARIABLE","$query",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","num_rows",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n\t\t\t",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","load",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","model",113],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/address'",113],")",";",["T_WHITESPACE","\n\t\t\t",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","model_account_address",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","addAddress",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","session",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","data",114],"[",["T_CONSTANT_ENCAPSED_STRING","'lpa'",114],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address'",114],"]",")",";",["T_WHITESPACE","\n\t\t",114],"}",["T_WHITESPACE","\n\t",115],"}",["T_WHITESPACE","\n\n\t",116],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","setOrderShipping",118],"(",["T_VARIABLE","$order_id",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$has_free_shipping",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n\t\t",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","db",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","query",119],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_STRING","DB_PREFIX",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order` SET `order_id` = '\"",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_INT_CAST","(int)",119],["T_VARIABLE","$order_id",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","\"', `free_shipping` = '\"",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_INT_CAST","(int)",119],["T_VARIABLE","$has_free_shipping",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","\"',`date_added` = now(), `modified` = now() \"",119],")",";",["T_WHITESPACE","\n\t\t",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","db",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getLastId",120],"(",")",";",["T_WHITESPACE","\n\t",120],"}",["T_WHITESPACE","\n\n\t",121],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","hasFreeShipping",123],"(",["T_VARIABLE","$order_id",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n\t\t",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","db",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","query",124],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `free_shipping` FROM `\"",124],["T_WHITESPACE"," ",124],".",["T_WHITESPACE"," ",124],["T_STRING","DB_PREFIX",124],["T_WHITESPACE"," ",124],".",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order` WHERE `order_id` = \"",124],["T_WHITESPACE"," ",124],".",["T_WHITESPACE"," ",124],["T_INT_CAST","(int)",124],["T_VARIABLE","$order_id",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","row",124],"[",["T_CONSTANT_ENCAPSED_STRING","'free_shipping'",124],"]",["T_WHITESPACE"," ",124],["T_IS_EQUAL","==",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'1'",124],";",["T_WHITESPACE","\n\t",124],"}",["T_WHITESPACE","\n\n\t",125],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","getShippingPrice",127],"(",["T_VARIABLE","$order_id",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n\t\t",127],["T_VARIABLE","$query",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","db",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","query",128],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `value` + IF(`tax` IS NULL, 0, `tax`) AS 'price' FROM `\"",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_STRING","DB_PREFIX",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","\"order_total` `ot` LEFT JOIN `\"",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_STRING","DB_PREFIX",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order_total_tax` `ott` USING(`order_total_id`) WHERE `ot`.`code` = 'shipping' AND `order_id` = \"",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_INT_CAST","(int)",128],["T_VARIABLE","$order_id",128],")",";",["T_WHITESPACE","\n\t\t",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$query",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","num_rows",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n\t\t\t",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$query",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","row",130],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",130],"]",";",["T_WHITESPACE","\n\t\t",130],"}",["T_WHITESPACE","\n\t",131],"}",["T_WHITESPACE","\n\n\t",132],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","getAdditionalCharges",134],"(",["T_VARIABLE","$order_id",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n\t\t",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","db",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","query",135],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `ot`.`title`, `ot`.`order_total_id`, `value` + IF(`tax` IS NULL, 0, `tax`) AS 'price' FROM `\"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_STRING","DB_PREFIX",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\"order_total` `ot` LEFT JOIN `\"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_STRING","DB_PREFIX",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order_total_tax` `ott` USING(`order_total_id`)  WHERE `ott`.`code` NOT IN ('shipping', 'total', 'sub_total', 'tax') AND `value` > 0 AND `order_id` = \"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_INT_CAST","(int)",135],["T_VARIABLE","$order_id",135],")",["T_OBJECT_OPERATOR","->",135],["T_STRING","rows",135],";",["T_WHITESPACE","\n\t",135],"}",["T_WHITESPACE","\n\n\t",136],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","addAmazonOrderId",138],"(",["T_VARIABLE","$order_id",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$amazon_authorization_id",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$capture_status",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$total",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$currency_code",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n\t\t",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","db",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","query",139],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_STRING","DB_PREFIX",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order` SET `amazon_order_reference_id` = '\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","db",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","escape",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","session",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","data",139],"[",["T_CONSTANT_ENCAPSED_STRING","'lpa'",139],"]","[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",139],"]",")",["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"', `amazon_authorization_id` = '\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","db",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","escape",139],"(",["T_VARIABLE","$amazon_authorization_id",139],")",["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"', `modified` = now(), `capture_status` = '\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","db",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","escape",139],"(",["T_VARIABLE","$capture_status",139],")",["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"', `currency_code` = '\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","db",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","escape",139],"(",["T_VARIABLE","$currency_code",139],")",["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"', `total` = '\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_VARIABLE","$total",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `order_id` = '\"",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_INT_CAST","(int)",139],["T_VARIABLE","$order_id",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","\"'\"",139],")",";",["T_WHITESPACE","\n\t",139],"}",["T_WHITESPACE","\n\n\t",140],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","addTransaction",142],"(",["T_VARIABLE","$amazon_login_pay_order_id",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$amazon_authorization_id",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$amazon_capture_id",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$type",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$status",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$total",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n\t\t",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","query",143],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_STRING","DB_PREFIX",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order_transaction` SET `amazon_login_pay_order_id` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_INT_CAST","(int)",143],["T_VARIABLE","$amazon_login_pay_order_id",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"', `amazon_authorization_id` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","escape",143],"(",["T_VARIABLE","$amazon_authorization_id",143],")",["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"', `amazon_capture_id` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","escape",143],"(",["T_VARIABLE","$amazon_capture_id",143],")",["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"', `date_added` = now(), `type` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","escape",143],"(",["T_VARIABLE","$type",143],")",["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"', `status` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","db",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","escape",143],"(",["T_VARIABLE","$status",143],")",["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"', `amount` = '\"",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$total",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"'\"",143],")",";",["T_WHITESPACE","\n\t",143],"}",["T_WHITESPACE","\n\n\t",144],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","closeOrderRef",146],"(",["T_VARIABLE","$amazon_order_reference_id",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n\t\t",146],["T_VARIABLE","$close_paramter_data",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_ARRAY","array",147],"(",")",";",["T_WHITESPACE","\n\t\t",147],["T_VARIABLE","$close_paramter_data",148],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",148],"]",["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$amazon_order_reference_id",148],";",["T_WHITESPACE","\n\t\t",148],["T_VARIABLE","$close_details",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","offAmazon",149],"(",["T_CONSTANT_ENCAPSED_STRING","'CloseOrderReference'",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$close_paramter_data",149],")",";",["T_WHITESPACE","\n\t\t",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","validateResponse",150],"(",["T_CONSTANT_ENCAPSED_STRING","'CloseOrderReference'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$close_details",150],")",";",["T_WHITESPACE","\n\t",150],"}",["T_WHITESPACE","\n\n\t",151],["T_PUBLIC","public",153],["T_WHITESPACE"," ",153],["T_FUNCTION","function",153],["T_WHITESPACE"," ",153],["T_STRING","sendOrder",153],"(",["T_VARIABLE","$order_id",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$total",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$currency_code",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n\n\t\t",153],["T_VARIABLE","$update_paramter_data",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],"(",")",";",["T_WHITESPACE","\n\t\t",155],["T_VARIABLE","$update_paramter_data",156],"[",["T_CONSTANT_ENCAPSED_STRING","'OrderReferenceAttributes.OrderTotal.Amount'",156],"]",["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$total",156],";",["T_WHITESPACE","\n\t\t",156],["T_VARIABLE","$update_paramter_data",157],"[",["T_CONSTANT_ENCAPSED_STRING","'OrderReferenceAttributes.OrderTotal.CurrencyCode'",157],"]",["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$currency_code",157],";",["T_WHITESPACE","\n\t\t",157],["T_VARIABLE","$update_paramter_data",158],"[",["T_CONSTANT_ENCAPSED_STRING","'OrderReferenceAttributes.SellerOrderAttributes.SellerOrderId'",158],"]",["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$order_id",158],";",["T_WHITESPACE","\n\t\t",158],["T_VARIABLE","$update_paramter_data",159],"[",["T_CONSTANT_ENCAPSED_STRING","'OrderReferenceAttributes.SellerOrderAttributes.StoreName'",159],"]",["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","config",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","get",159],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",159],")",";",["T_WHITESPACE","\n\t\t",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","config",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","get",160],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",160],")",["T_WHITESPACE"," ",160],["T_IS_EQUAL","==",160],["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'USD'",160],")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n\t\t\t",160],["T_VARIABLE","$update_paramter_data",161],"[",["T_CONSTANT_ENCAPSED_STRING","'OrderReferenceAttributes.PlatformId'",161],"]",["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'A3GK1RS09H3A7D'",161],";",["T_WHITESPACE","\n\t\t",161],"}",["T_WHITESPACE"," ",162],["T_ELSE","else",162],["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n\t\t\t",162],["T_VARIABLE","$update_paramter_data",163],"[",["T_CONSTANT_ENCAPSED_STRING","'OrderReferenceAttributes.PlatformId'",163],"]",["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'A3EIRX2USI2KJV'",163],";",["T_WHITESPACE","\n\t\t",163],"}",["T_WHITESPACE","\n\n\t\t",164],["T_VARIABLE","$address_paramter_data",166],"[",["T_CONSTANT_ENCAPSED_STRING","'AddressConsentToken'",166],"]",["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","session",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","data",166],"[",["T_CONSTANT_ENCAPSED_STRING","'access_token'",166],"]",";",["T_WHITESPACE","\n\t\t",166],["T_VARIABLE","$address",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","offAmazon",167],"(",["T_CONSTANT_ENCAPSED_STRING","'GetOrderReferenceDetails'",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$address_paramter_data",167],")",";",["T_WHITESPACE","\n\t\t",167],["T_VARIABLE","$address_details_response",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","simplexml_load_string",168],"(",["T_VARIABLE","$address",168],"[",["T_CONSTANT_ENCAPSED_STRING","'ResponseBody'",168],"]",")",";",["T_WHITESPACE","\n\n\t\t",168],["T_VARIABLE","$reason_code",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING_CAST","(string)",170],["T_VARIABLE","$address_details_response",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","GetOrderReferenceDetailsResult",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","OrderReferenceDetails",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","OrderReferenceStatus",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","ReasonCode",170],";",["T_WHITESPACE","\n\n\t\t",170],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$reason_code",172],["T_WHITESPACE"," ",172],["T_IS_NOT_EQUAL","!=",172],["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'InvalidPaymentMethod'",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n\t\t\t",172],["T_VARIABLE","$update_details",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","offAmazon",173],"(",["T_CONSTANT_ENCAPSED_STRING","'SetOrderReferenceDetails'",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$update_paramter_data",173],")",";",["T_WHITESPACE","\n\t\t\t",173],["T_VARIABLE","$update_details_response",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","validateResponse",174],"(",["T_CONSTANT_ENCAPSED_STRING","'Update'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$update_details",174],")",";",["T_WHITESPACE","\n\t\t\t",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$update_details_response",175],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",175],"]",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n\t\t\t\t",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$update_details_response",176],";",["T_WHITESPACE","\n\t\t\t",176],"}",["T_WHITESPACE","\n\t\t",177],"}",["T_WHITESPACE","\n\n\t\t",178],["T_VARIABLE","$confirm_details",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","offAmazon",180],"(",["T_CONSTANT_ENCAPSED_STRING","'ConfirmOrderReference'",180],")",";",["T_WHITESPACE","\n\t\t",180],["T_VARIABLE","$confirm_details_response",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","validateResponse",181],"(",["T_CONSTANT_ENCAPSED_STRING","'Confirm'",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$confirm_details",181],")",";",["T_WHITESPACE","\n\t\t",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_VARIABLE","$confirm_details_response",182],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",182],"]",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n\t\t\t",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$confirm_details_response",183],";",["T_WHITESPACE","\n\t\t",183],"}",["T_WHITESPACE","\n\n\t\t",184],["T_VARIABLE","$response",186],"[",["T_CONSTANT_ENCAPSED_STRING","'capture_status'",186],"]",["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_LNUMBER","0",186],";",["T_WHITESPACE","\n\t\t",186],["T_VARIABLE","$authorize_paramter_data",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",")",";",["T_WHITESPACE","\n\t\t",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","config",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","get",188],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_mode'",188],")",["T_WHITESPACE"," ",188],["T_IS_EQUAL","==",188],["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'payment'",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n\t\t\t",188],["T_VARIABLE","$authorize_paramter_data",189],"[",["T_CONSTANT_ENCAPSED_STRING","'CaptureNow'",189],"]",["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","true",189],";",["T_WHITESPACE","\n\t\t\t",189],["T_VARIABLE","$authorize_paramter_data",190],"[",["T_CONSTANT_ENCAPSED_STRING","'CaptureReferenceId'",190],"]",["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'capture_'",190],["T_WHITESPACE"," ",190],".",["T_WHITESPACE"," ",190],["T_STRING","mt_rand",190],"(",")",";",["T_WHITESPACE","\n\t\t\t",190],["T_VARIABLE","$response",191],"[",["T_CONSTANT_ENCAPSED_STRING","'capture_status'",191],"]",["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_LNUMBER","1",191],";",["T_WHITESPACE","\n\t\t",191],"}",["T_WHITESPACE","\n\n\t\t",192],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","config",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","get",194],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_declined_code'",194],")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n\t\t\t",194],["T_VARIABLE","$authorize_paramter_data",195],"[",["T_CONSTANT_ENCAPSED_STRING","'SellerAuthorizationNote'",195],"]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'{\"SandboxSimulation\": {\"State\":\"Declined\", \"ReasonCode\":\"'",195],["T_WHITESPACE"," ",195],".",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","config",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","get",195],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_declined_code'",195],")",["T_WHITESPACE"," ",195],".",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'\"}}'",195],";",["T_WHITESPACE","\n\t\t",195],"}",["T_WHITESPACE","\n\n\t\t",196],["T_VARIABLE","$authorize_paramter_data",198],"[",["T_CONSTANT_ENCAPSED_STRING","'AuthorizationAmount.Amount'",198],"]",["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$total",198],";",["T_WHITESPACE","\n\t\t",198],["T_VARIABLE","$authorize_paramter_data",199],"[",["T_CONSTANT_ENCAPSED_STRING","'AuthorizationAmount.CurrencyCode'",199],"]",["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$currency_code",199],";",["T_WHITESPACE","\n\t\t",199],["T_VARIABLE","$authorize_paramter_data",200],"[",["T_CONSTANT_ENCAPSED_STRING","'AuthorizationReferenceId'",200],"]",["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'auth_'",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_STRING","mt_rand",200],"(",")",";",["T_WHITESPACE","\n\t\t",200],["T_VARIABLE","$authorize_paramter_data",201],"[",["T_CONSTANT_ENCAPSED_STRING","'TransactionTimeout'",201],"]",["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_LNUMBER","0",201],";",["T_WHITESPACE","\n\t\t",201],["T_VARIABLE","$authorize_details",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","offAmazon",202],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorize'",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$authorize_paramter_data",202],")",";",["T_WHITESPACE","\n\t\t",202],["T_VARIABLE","$authorize_details_response",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","validateResponse",203],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorize'",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$authorize_details",203],")",";",["T_WHITESPACE","\n\t\t",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_ISSET","isset",204],"(",["T_VARIABLE","$authorize_details_response",204],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",204],"]",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n\t\t\t",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$authorize_details_response",205],";",["T_WHITESPACE","\n\t\t",205],"}",["T_WHITESPACE","\n\n\t\t",206],["T_VARIABLE","$response",208],"[",["T_CONSTANT_ENCAPSED_STRING","'amazon_authorization_id'",208],"]",["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING_CAST","(string)",208],["T_VARIABLE","$authorize_details_response",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","AuthorizeResult",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","AuthorizationDetails",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","AmazonAuthorizationId",208],";",["T_WHITESPACE","\n\t\t",208],["T_VARIABLE","$response",209],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",209],"]",["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING_CAST","(string)",209],["T_VARIABLE","$authorize_details_response",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","AuthorizeResult",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","AuthorizationDetails",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","AuthorizationStatus",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","State",209],";",["T_WHITESPACE","\n\t\t",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_ISSET","isset",210],"(",["T_VARIABLE","$authorize_details_response",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","AuthorizeResult",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","AuthorizationDetails",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","IdList",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","member",210],")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n\t\t\t",210],["T_VARIABLE","$response",211],"[",["T_CONSTANT_ENCAPSED_STRING","'amazon_capture_id'",211],"]",["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING_CAST","(string)",211],["T_VARIABLE","$authorize_details_response",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","AuthorizeResult",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","AuthorizationDetails",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","IdList",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","member",211],";",["T_WHITESPACE","\n\t\t",211],"}",["T_WHITESPACE","\n\n\t\t",212],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_ISSET","isset",214],"(",["T_VARIABLE","$authorize_details_response",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","AuthorizeResult",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","AuthorizationDetails",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","AuthorizationBillingAddress",214],")",")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n\t\t\t",214],["T_VARIABLE","$response",215],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",215],"]",["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$authorize_details_response",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","AuthorizeResult",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","AuthorizationDetails",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","AuthorizationBillingAddress",215],";",["T_WHITESPACE","\n\t\t",215],"}",["T_WHITESPACE","\n\n\t\t",216],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$response",218],";",["T_WHITESPACE","\n\t",218],"}",["T_WHITESPACE","\n\n\t",219],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","editOrder",221],"(",["T_VARIABLE","$order_id",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$order",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n\t\t",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","query",222],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_STRING","DB_PREFIX",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"order` SET  payment_firstname = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_lastname = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_address_1 = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_address_2 = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_city = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_zone = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_zone_id = \"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_INT_CAST","(int)",222],["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",222],"]",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\", payment_country = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"', payment_country_id = \"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_INT_CAST","(int)",222],["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",222],"]",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\", payment_postcode = '\"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","db",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","escape",222],"(",["T_VARIABLE","$order",222],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",222],"]",")",["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE order_id = \"",222],["T_WHITESPACE"," ",222],".",["T_WHITESPACE"," ",222],["T_INT_CAST","(int)",222],["T_VARIABLE","$order_id",222],")",";",["T_WHITESPACE","\n\t",222],"}",["T_WHITESPACE","\n\n\t",223],["T_PUBLIC","public",225],["T_WHITESPACE"," ",225],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","updateStatus",225],"(",["T_VARIABLE","$amazon_id",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$type",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$status",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n\t\t",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","db",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","query",226],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_STRING","DB_PREFIX",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order_transaction` SET `status` = '\"",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","db",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","escape",226],"(",["T_VARIABLE","$status",226],")",["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `amazon_\"",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_VARIABLE","$type",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","\"_id` = '\"",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","db",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","escape",226],"(",["T_VARIABLE","$amazon_id",226],")",["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","\"' AND `type` = '\"",226],["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","db",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","escape",226],"(",["T_VARIABLE","$type",226],")",["T_WHITESPACE"," ",226],".",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","\"'\"",226],")",";",["T_WHITESPACE","\n\t",226],"}",["T_WHITESPACE","\n\n\t",227],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","authorizationIpn",229],"(",["T_VARIABLE","$xml",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n\t\t",229],["T_VARIABLE","$status",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_STRING_CAST","(string)",230],["T_VARIABLE","$xml",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","AuthorizationDetails",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","AuthorizationStatus",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","State",230],";",["T_WHITESPACE","\n\t\t",230],["T_VARIABLE","$amazon_authorization_id",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_STRING_CAST","(string)",231],["T_VARIABLE","$xml",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","AuthorizationDetails",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","AmazonAuthorizationId",231],";",["T_WHITESPACE","\n\t\t",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","updateStatus",232],"(",["T_VARIABLE","$amazon_authorization_id",232],",",["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","'authorization'",232],",",["T_WHITESPACE"," ",232],["T_VARIABLE","$status",232],")",";",["T_WHITESPACE","\n\t\t",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$status",233],["T_WHITESPACE"," ",233],["T_IS_EQUAL","==",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'Declined'",233],["T_WHITESPACE"," ",233],["T_BOOLEAN_OR","||",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$status",233],["T_WHITESPACE"," ",233],["T_IS_EQUAL","==",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'Closed'",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n\t\t\t",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","logger",234],"(",["T_VARIABLE","$status",234],["T_WHITESPACE"," ",234],".",["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","': '",234],["T_WHITESPACE"," ",234],".",["T_WHITESPACE"," ",234],["T_STRING_CAST","(string)",234],["T_VARIABLE","$xml",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","AuthorizationDetails",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","AuthorizationStatus",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","ReasonCode",234],")",";",["T_WHITESPACE","\n\t\t",234],"}",["T_WHITESPACE","\n\t",235],"}",["T_WHITESPACE","\n\n\t",236],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","captureIpn",238],"(",["T_VARIABLE","$xml",238],")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n\t\t",238],["T_VARIABLE","$status",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING_CAST","(string)",239],["T_VARIABLE","$xml",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","CaptureDetails",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","CaptureStatus",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","State",239],";",["T_WHITESPACE","\n\t\t",239],["T_VARIABLE","$amazon_capture_id",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING_CAST","(string)",240],["T_VARIABLE","$xml",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","CaptureDetails",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","AmazonCaptureId",240],";",["T_WHITESPACE","\n\t\t",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","updateStatus",241],"(",["T_VARIABLE","$amazon_capture_id",241],",",["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'capture'",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$status",241],")",";",["T_WHITESPACE","\n\t\t",241],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$status",242],["T_WHITESPACE"," ",242],["T_IS_EQUAL","==",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'Declined'",242],["T_WHITESPACE"," ",242],["T_BOOLEAN_OR","||",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$status",242],["T_WHITESPACE"," ",242],["T_IS_EQUAL","==",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'Canceled'",242],["T_WHITESPACE"," ",242],["T_BOOLEAN_OR","||",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$status",242],["T_WHITESPACE"," ",242],["T_IS_EQUAL","==",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'Closed'",242],")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n\t\t\t",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","logger",243],"(",["T_VARIABLE","$status",243],["T_WHITESPACE"," ",243],".",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","': '",243],["T_WHITESPACE"," ",243],".",["T_WHITESPACE"," ",243],["T_STRING_CAST","(string)",243],["T_VARIABLE","$xml",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","CaptureDetails",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","CaptureStatus",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","ReasonCode",243],")",";",["T_WHITESPACE","\n\t\t",243],"}",["T_WHITESPACE","\n\t",244],"}",["T_WHITESPACE","\n\n\t",245],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","refundIpn",247],"(",["T_VARIABLE","$xml",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n\t\t",247],["T_VARIABLE","$status",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING_CAST","(string)",248],["T_VARIABLE","$xml",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","RefundDetails",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","RefundStatus",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","State",248],";",["T_WHITESPACE","\n\t\t",248],["T_VARIABLE","$amazon_refund_id",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_STRING_CAST","(string)",249],["T_VARIABLE","$xml",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","RefundDetails",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","AmazonRefundId",249],";",["T_WHITESPACE","\n\t\t",249],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","updateStatus",250],"(",["T_VARIABLE","$amazon_refund_id",250],",",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'refund'",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$status",250],")",";",["T_WHITESPACE","\n\t\t",250],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$status",251],["T_WHITESPACE"," ",251],["T_IS_EQUAL","==",251],["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'Declined'",251],")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n\t\t\t",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","logger",252],"(",["T_VARIABLE","$status",252],["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","': '",252],["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_STRING_CAST","(string)",252],["T_VARIABLE","$xml",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","RefundDetails",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","RefundStatus",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","ReasonCode",252],")",";",["T_WHITESPACE","\n\t\t",252],"}",["T_WHITESPACE","\n\t",253],"}",["T_WHITESPACE","\n\n\t",254],["T_PUBLIC","public",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","capture",256],"(",["T_VARIABLE","$amazon_login_pay_order",256],")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n\t\t",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","logger",257],"(",["T_VARIABLE","$amazon_login_pay_order",257],")",";",["T_WHITESPACE","\n\t\t",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","logger",258],"(",["T_STRING","count",258],"(",["T_VARIABLE","$amazon_login_pay_order",258],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",258],"]",")",")",";",["T_WHITESPACE","\n\t\t",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_STRING","count",259],"(",["T_VARIABLE","$amazon_login_pay_order",259],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",259],"]",")",["T_WHITESPACE"," ",259],["T_IS_EQUAL","==",259],["T_WHITESPACE"," ",259],["T_LNUMBER","1",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n\t\t\t",259],["T_VARIABLE","$capture_paramter_data",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_ARRAY","array",260],"(",")",";",["T_WHITESPACE","\n\t\t\t",260],["T_VARIABLE","$capture_paramter_data",261],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",261],"]",["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$amazon_login_pay_order",261],"[",["T_CONSTANT_ENCAPSED_STRING","'amazon_order_reference_id'",261],"]",";",["T_WHITESPACE","\n\t\t\t",261],["T_VARIABLE","$capture_paramter_data",262],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonAuthorizationId'",262],"]",["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$amazon_login_pay_order",262],"[",["T_CONSTANT_ENCAPSED_STRING","'amazon_authorization_id'",262],"]",";",["T_WHITESPACE","\n\t\t\t",262],["T_VARIABLE","$capture_paramter_data",263],"[",["T_CONSTANT_ENCAPSED_STRING","'CaptureAmount.Amount'",263],"]",["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$amazon_login_pay_order",263],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",263],"]",";",["T_WHITESPACE","\n\t\t\t",263],["T_VARIABLE","$capture_paramter_data",264],"[",["T_CONSTANT_ENCAPSED_STRING","'CaptureAmount.CurrencyCode'",264],"]",["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$amazon_login_pay_order",264],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",264],"]",";",["T_WHITESPACE","\n\t\t\t",264],["T_VARIABLE","$capture_paramter_data",265],"[",["T_CONSTANT_ENCAPSED_STRING","'CaptureReferenceId'",265],"]",["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'capture_'",265],["T_WHITESPACE"," ",265],".",["T_WHITESPACE"," ",265],["T_STRING","mt_rand",265],"(",")",";",["T_WHITESPACE","\n\t\t\t",265],["T_VARIABLE","$capture_paramter_data",266],"[",["T_CONSTANT_ENCAPSED_STRING","'TransactionTimeout'",266],"]",["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_LNUMBER","0",266],";",["T_WHITESPACE","\n\n\t\t\t",266],["T_VARIABLE","$capture_details",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","offAmazon",268],"(",["T_CONSTANT_ENCAPSED_STRING","'Capture'",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$capture_paramter_data",268],")",";",["T_WHITESPACE","\n\t\t\t",268],["T_VARIABLE","$capture_response",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","validateResponse",269],"(",["T_CONSTANT_ENCAPSED_STRING","'Capture'",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$capture_details",269],")",";",["T_WHITESPACE","\n\t\t\t",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_ISSET","isset",270],"(",["T_VARIABLE","$capture_response",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","CaptureResult",270],")",")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n\t\t\t\t",270],["T_VARIABLE","$response",271],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",271],"]",["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING_CAST","(string)",271],["T_VARIABLE","$capture_response",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","CaptureResult",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","CaptureDetails",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","CaptureStatus",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","State",271],";",["T_WHITESPACE","\n\t\t\t\t",271],["T_VARIABLE","$response",272],"[",["T_CONSTANT_ENCAPSED_STRING","'amazon_capture_id'",272],"]",["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_STRING_CAST","(string)",272],["T_VARIABLE","$capture_response",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","CaptureResult",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","CaptureDetails",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","AmazonCaptureId",272],";",["T_WHITESPACE","\n\t\t\t\t",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$response",273],";",["T_WHITESPACE","\n\t\t\t",273],"}",["T_WHITESPACE","\n\n\t\t\t",274],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$capture_response",276],";",["T_WHITESPACE","\n\t\t",276],"}",["T_WHITESPACE"," ",277],["T_ELSE","else",277],["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n\t\t\t",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_STRING","false",278],";",["T_WHITESPACE","\n\t\t",278],"}",["T_WHITESPACE","\n\t",279],"}",["T_WHITESPACE","\n\n\t",280],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","updateCaptureStatus",282],"(",["T_VARIABLE","$amazon_login_pay_order_id",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$status",282],")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n\t\t",282],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","db",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","query",283],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE `\"",283],["T_WHITESPACE"," ",283],".",["T_WHITESPACE"," ",283],["T_STRING","DB_PREFIX",283],["T_WHITESPACE"," ",283],".",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order` SET `capture_status` = '\"",283],["T_WHITESPACE"," ",283],".",["T_WHITESPACE"," ",283],["T_INT_CAST","(int)",283],["T_VARIABLE","$status",283],["T_WHITESPACE"," ",283],".",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","\"' WHERE `amazon_login_pay_order_id` = '\"",283],["T_WHITESPACE"," ",283],".",["T_WHITESPACE"," ",283],["T_INT_CAST","(int)",283],["T_VARIABLE","$amazon_login_pay_order_id",283],["T_WHITESPACE"," ",283],".",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","\"'\"",283],")",";",["T_WHITESPACE","\n\t",283],"}",["T_WHITESPACE","\n\n\t",284],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","getOrder",286],"(",["T_VARIABLE","$order_id",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n\n\t\t",286],["T_VARIABLE","$qry",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","db",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","query",288],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",288],["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_STRING","DB_PREFIX",288],["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order` WHERE `order_id` = '\"",288],["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_INT_CAST","(int)",288],["T_VARIABLE","$order_id",288],["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","\"' LIMIT 1\"",288],")",";",["T_WHITESPACE","\n\n\t\t",288],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$qry",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","num_rows",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n\t\t\t",290],["T_VARIABLE","$order",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$qry",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","row",291],";",["T_WHITESPACE","\n\t\t\t",291],["T_VARIABLE","$order",292],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",292],"]",["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","getTransactions",292],"(",["T_VARIABLE","$order",292],"[",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_order_id'",292],"]",",",["T_WHITESPACE"," ",292],["T_VARIABLE","$qry",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","row",292],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",292],"]",")",";",["T_WHITESPACE","\n\t\t\t",292],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$order",293],";",["T_WHITESPACE","\n\t\t",293],"}",["T_WHITESPACE"," ",294],["T_ELSE","else",294],["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n\t\t\t",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_STRING","false",295],";",["T_WHITESPACE","\n\t\t",295],"}",["T_WHITESPACE","\n\t",296],"}",["T_WHITESPACE","\n\n\t",297],["T_PRIVATE","private",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","getTransactions",299],"(",["T_VARIABLE","$amazon_login_pay_order_id",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$currency_code",299],")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n\t\t",299],["T_VARIABLE","$query",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","db",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","query",300],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_STRING","DB_PREFIX",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","\"amazon_login_pay_order_transaction` WHERE `amazon_login_pay_order_id` = '\"",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_INT_CAST","(int)",300],["T_VARIABLE","$amazon_login_pay_order_id",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","\"'\"",300],")",";",["T_WHITESPACE","\n\n\t\t",300],["T_VARIABLE","$transactions",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_ARRAY","array",302],"(",")",";",["T_WHITESPACE","\n\n\t\t",302],["T_IF","if",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$query",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","num_rows",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n\t\t\t",304],["T_FOREACH","foreach",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$query",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","rows",305],["T_WHITESPACE"," ",305],["T_AS","as",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$row",305],")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n\t\t\t\t",305],["T_VARIABLE","$row",306],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",306],"]",["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","currency",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","format",306],"(",["T_VARIABLE","$row",306],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",306],"]",",",["T_WHITESPACE"," ",306],["T_VARIABLE","$currency_code",306],",",["T_WHITESPACE"," ",306],["T_STRING","true",306],",",["T_WHITESPACE"," ",306],["T_STRING","true",306],")",";",["T_WHITESPACE","\n\n\t\t\t\t",306],["T_VARIABLE","$transactions",308],"[","]",["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$row",308],";",["T_WHITESPACE","\n\t\t\t",308],"}",["T_WHITESPACE","\n\t\t\t",309],["T_RETURN","return",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$transactions",310],";",["T_WHITESPACE","\n\t\t",310],"}",["T_WHITESPACE"," ",311],["T_ELSE","else",311],["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n\t\t\t",311],["T_RETURN","return",312],["T_WHITESPACE"," ",312],["T_STRING","false",312],";",["T_WHITESPACE","\n\t\t",312],"}",["T_WHITESPACE","\n\t",313],"}",["T_WHITESPACE","\n\n\t",314],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","getUserInfo",316],"(",["T_VARIABLE","$access_token",316],")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n\t\t",316],["T_IF","if",317],["T_WHITESPACE"," ",317],"(",["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","config",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","get",317],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_test'",317],")",["T_WHITESPACE"," ",317],["T_IS_EQUAL","==",317],["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'sandbox'",317],")",["T_WHITESPACE"," ",317],"{",["T_WHITESPACE","\n\t\t\t",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(",["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","config",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","get",318],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",318],")",["T_WHITESPACE"," ",318],["T_IS_EQUAL","==",318],["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","'GBP'",318],")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n\t\t\t\t",318],["T_VARIABLE","$curl_token",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_STRING","curl_init",319],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.amazon.co.uk\/auth\/o2\/tokeninfo?access_token='",319],["T_WHITESPACE"," ",319],".",["T_WHITESPACE"," ",319],["T_STRING","urlencode",319],"(",["T_VARIABLE","$access_token",319],")",")",";",["T_WHITESPACE","\n\t\t\t\t",319],["T_VARIABLE","$curl_profile",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","curl_init",320],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.amazon.co.uk\/user\/profile'",320],")",";",["T_WHITESPACE","\n\t\t\t",320],"}",["T_WHITESPACE"," ",321],["T_ELSEIF","elseif",321],["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","config",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","get",321],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",321],")",["T_WHITESPACE"," ",321],["T_IS_EQUAL","==",321],["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'EUR'",321],")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n\t\t\t\t",321],["T_VARIABLE","$curl_token",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_STRING","curl_init",322],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.amazon.de\/auth\/o2\/tokeninfo?access_token='",322],["T_WHITESPACE"," ",322],".",["T_WHITESPACE"," ",322],["T_STRING","urlencode",322],"(",["T_VARIABLE","$access_token",322],")",")",";",["T_WHITESPACE","\n\t\t\t\t",322],["T_VARIABLE","$curl_profile",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","curl_init",323],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.amazon.de\/user\/profile'",323],")",";",["T_WHITESPACE","\n\t\t\t",323],"}",["T_WHITESPACE"," ",324],["T_ELSE","else",324],["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n\t\t\t\t",324],["T_VARIABLE","$curl_token",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_STRING","curl_init",325],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.amazon.com\/auth\/o2\/tokeninfo?access_token='",325],["T_WHITESPACE"," ",325],".",["T_WHITESPACE"," ",325],["T_STRING","urlencode",325],"(",["T_VARIABLE","$access_token",325],")",")",";",["T_WHITESPACE","\n\t\t\t\t",325],["T_VARIABLE","$curl_profile",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_STRING","curl_init",326],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.sandbox.amazon.com\/user\/profile'",326],")",";",["T_WHITESPACE","\n\t\t\t",326],"}",["T_WHITESPACE","\n\t\t",327],"}",["T_WHITESPACE"," ",328],["T_ELSE","else",328],["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n\t\t\t",328],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","config",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",329],")",["T_WHITESPACE"," ",329],["T_IS_EQUAL","==",329],["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'GBP'",329],")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n\t\t\t\t",329],["T_VARIABLE","$curl_token",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","curl_init",330],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.amazon.co.uk\/auth\/o2\/tokeninfo?access_token='",330],["T_WHITESPACE"," ",330],".",["T_WHITESPACE"," ",330],["T_STRING","urlencode",330],"(",["T_VARIABLE","$access_token",330],")",")",";",["T_WHITESPACE","\n\t\t\t\t",330],["T_VARIABLE","$curl_profile",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_STRING","curl_init",331],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.amazon.co.uk\/user\/profile'",331],")",";",["T_WHITESPACE","\n\t\t\t",331],"}",["T_WHITESPACE"," ",332],["T_ELSEIF","elseif",332],["T_WHITESPACE"," ",332],"(",["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","config",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","get",332],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",332],")",["T_WHITESPACE"," ",332],["T_IS_EQUAL","==",332],["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'EUR'",332],")",["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n\t\t\t\t",332],["T_VARIABLE","$curl_token",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_STRING","curl_init",333],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.amazon.de\/auth\/o2\/tokeninfo?access_token='",333],["T_WHITESPACE"," ",333],".",["T_WHITESPACE"," ",333],["T_STRING","urlencode",333],"(",["T_VARIABLE","$access_token",333],")",")",";",["T_WHITESPACE","\n\t\t\t\t",333],["T_VARIABLE","$curl_profile",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_STRING","curl_init",334],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.amazon.de\/user\/profile'",334],")",";",["T_WHITESPACE","\n\t\t\t",334],"}",["T_WHITESPACE"," ",335],["T_ELSE","else",335],["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n\t\t\t\t",335],["T_VARIABLE","$curl_token",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_STRING","curl_init",336],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.amazon.com\/auth\/o2\/tokeninfo?access_token='",336],["T_WHITESPACE"," ",336],".",["T_WHITESPACE"," ",336],["T_STRING","urlencode",336],"(",["T_VARIABLE","$access_token",336],")",")",";",["T_WHITESPACE","\n\t\t\t\t",336],["T_VARIABLE","$curl_profile",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_STRING","curl_init",337],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.amazon.com\/user\/profile'",337],")",";",["T_WHITESPACE","\n\t\t\t",337],"}",["T_WHITESPACE","\n\t\t",338],"}",["T_WHITESPACE","\n\n\t\t",339],["T_STRING","curl_setopt",341],"(",["T_VARIABLE","$curl_token",341],",",["T_WHITESPACE"," ",341],["T_STRING","CURLOPT_RETURNTRANSFER",341],",",["T_WHITESPACE"," ",341],["T_STRING","true",341],")",";",["T_WHITESPACE","\n\n\t\t",341],["T_VARIABLE","$response_token",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_STRING","curl_exec",343],"(",["T_VARIABLE","$curl_token",343],")",";",["T_WHITESPACE","\n\t\t",343],["T_STRING","curl_close",344],"(",["T_VARIABLE","$curl_token",344],")",";",["T_WHITESPACE","\n\t\t",344],["T_VARIABLE","$decoded_token",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_STRING","json_decode",345],"(",["T_VARIABLE","$response_token",345],")",";",["T_WHITESPACE","\n\n\t\t",345],["T_IF","if",347],["T_WHITESPACE"," ",347],"(","!",["T_ISSET","isset",347],"(",["T_VARIABLE","$decoded_token",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","aud",347],")",["T_WHITESPACE"," ",347],["T_BOOLEAN_OR","||",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$decoded_token",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","aud",347],["T_WHITESPACE"," ",347],["T_IS_NOT_EQUAL","!=",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","config",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","get",347],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_client_id'",347],")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n\t\t\t",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","logger",348],"(",["T_VARIABLE","$decoded_token",348],")",";",["T_WHITESPACE","\n\t\t\t",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","logger",349],"(",["T_CONSTANT_ENCAPSED_STRING","'the access token does not belong to us'",349],")",";",["T_WHITESPACE","\n\t\t\t",349],["T_RETURN","return",350],";",["T_WHITESPACE","\n\t\t",350],"}",["T_WHITESPACE","\n\n\t\t",351],["T_STRING","curl_setopt",353],"(",["T_VARIABLE","$curl_profile",353],",",["T_WHITESPACE"," ",353],["T_STRING","CURLOPT_HTTPHEADER",353],",",["T_WHITESPACE"," ",353],["T_ARRAY","array",353],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorization: bearer '",353],["T_WHITESPACE"," ",353],".",["T_WHITESPACE"," ",353],["T_VARIABLE","$access_token",353],")",")",";",["T_WHITESPACE","\n\t\t",353],["T_STRING","curl_setopt",354],"(",["T_VARIABLE","$curl_profile",354],",",["T_WHITESPACE"," ",354],["T_STRING","CURLOPT_RETURNTRANSFER",354],",",["T_WHITESPACE"," ",354],["T_STRING","true",354],")",";",["T_WHITESPACE","\n\n\t\t",354],["T_VARIABLE","$response_profile",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_STRING","curl_exec",356],"(",["T_VARIABLE","$curl_profile",356],")",";",["T_WHITESPACE","\n\t\t",356],["T_STRING","curl_close",357],"(",["T_VARIABLE","$curl_profile",357],")",";",["T_WHITESPACE","\n\t\t",357],["T_VARIABLE","$decoded_profile",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","json_decode",358],"(",["T_VARIABLE","$response_profile",358],")",";",["T_WHITESPACE","\n\n\t\t",358],["T_RETURN","return",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$decoded_profile",360],";",["T_WHITESPACE","\n\t",360],"}",["T_WHITESPACE","\n\n\t",361],["T_PRIVATE","private",363],["T_WHITESPACE"," ",363],["T_FUNCTION","function",363],["T_WHITESPACE"," ",363],["T_STRING","validateResponse",363],"(",["T_VARIABLE","$action",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$details",363],")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n\t\t",363],["T_VARIABLE","$details_xml",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_STRING","simplexml_load_string",364],"(",["T_VARIABLE","$details",364],"[",["T_CONSTANT_ENCAPSED_STRING","'ResponseBody'",364],"]",")",";",["T_WHITESPACE","\n\t\t",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","logger",365],"(",["T_VARIABLE","$action",365],")",";",["T_WHITESPACE","\n\t\t",365],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","logger",366],"(",["T_VARIABLE","$details_xml",366],")",";",["T_WHITESPACE","\n\n\t\t",366],["T_VARIABLE","$details_xml",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","registerXPathNamespace",368],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",368],",",["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/mws.amazonservices.com\/schema\/OffAmazonPayments\/2013-01-01'",368],")",";",["T_WHITESPACE","\n\t\t",368],["T_VARIABLE","$error_set",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$details_xml",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","xpath",369],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/m:ReasonCode'",369],")",";",["T_WHITESPACE","\n\n\t\t",369],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_ISSET","isset",371],"(",["T_VARIABLE","$details_xml",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","Error",371],")",")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n\t\t\t",371],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","logger",372],"(",["T_VARIABLE","$action",372],["T_WHITESPACE"," ",372],".",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","' : '",372],["T_WHITESPACE"," ",372],".",["T_WHITESPACE"," ",372],["T_STRING_CAST","(string)",372],["T_VARIABLE","$details_xml",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","Error",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","Message",372],")",";",["T_WHITESPACE","\n\t\t\t",372],["T_VARIABLE","$response",373],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",373],"]",["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'failure'",373],";",["T_WHITESPACE","\n\t\t\t",373],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$response",374],";",["T_WHITESPACE","\n\t\t",374],"}",["T_WHITESPACE"," ",375],["T_ELSEIF","elseif",375],["T_WHITESPACE"," ",375],"(","!",["T_EMPTY","empty",375],"(",["T_VARIABLE","$error_set",375],")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n\t\t\t",375],["T_VARIABLE","$reason_code",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_STRING_CAST","(string)",376],["T_VARIABLE","$error_set",376],"[",["T_LNUMBER","0",376],"]",";",["T_WHITESPACE","\n\t\t\t",376],["T_VARIABLE","$response",377],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",377],"]",["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_CONSTANT_ENCAPSED_STRING","'failure'",377],";",["T_WHITESPACE","\n\t\t\t",377],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$reason_code",378],["T_WHITESPACE"," ",378],["T_IS_EQUAL","==",378],["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'InvalidPaymentMethod'",378],")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n\t\t\t\t",378],["T_VARIABLE","$response",379],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",379],"]",["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","'paymentMethod'",379],";",["T_WHITESPACE","\n\t\t\t",379],"}",["T_WHITESPACE"," ",380],["T_ELSEIF","elseif",380],["T_WHITESPACE"," ",380],"(",["T_VARIABLE","$reason_code",380],["T_WHITESPACE"," ",380],["T_IS_EQUAL","==",380],["T_WHITESPACE"," ",380],["T_CONSTANT_ENCAPSED_STRING","'MaxCapturesProcessed'",380],")",["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n\t\t\t\t",380],["T_RETURN","return",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$details_xml",381],";",["T_WHITESPACE","\n\t\t\t",381],"}",["T_WHITESPACE","\n\t\t\t",382],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","logger",383],"(",["T_VARIABLE","$action",383],["T_WHITESPACE"," ",383],".",["T_WHITESPACE"," ",383],["T_CONSTANT_ENCAPSED_STRING","' : '",383],["T_WHITESPACE"," ",383],".",["T_WHITESPACE"," ",383],["T_VARIABLE","$reason_code",383],")",";",["T_WHITESPACE","\n\t\t\t",383],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$response",384],";",["T_WHITESPACE","\n\t\t",384],"}",["T_WHITESPACE","\n\t\t",385],["T_RETURN","return",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$details_xml",386],";",["T_WHITESPACE","\n\t",386],"}",["T_WHITESPACE","\n\n\t",387],["T_PUBLIC","public",389],["T_WHITESPACE"," ",389],["T_FUNCTION","function",389],["T_WHITESPACE"," ",389],["T_STRING","offAmazon",389],"(",["T_VARIABLE","$Action",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$parameter_data",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_ARRAY","array",389],"(",")",")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n\t\t",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","config",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","get",390],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_test'",390],")",["T_WHITESPACE"," ",390],["T_IS_EQUAL","==",390],["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'sandbox'",390],")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n\t\t\t",390],["T_IF","if",391],["T_WHITESPACE"," ",391],"(",["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","config",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","get",391],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",391],")",["T_WHITESPACE"," ",391],["T_IS_EQUAL","==",391],["T_WHITESPACE"," ",391],["T_CONSTANT_ENCAPSED_STRING","'USD'",391],")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n\t\t\t\t",391],["T_VARIABLE","$url",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/mws.amazonservices.com\/OffAmazonPayments_Sandbox\/2013-01-01\/'",392],";",["T_WHITESPACE","\n\t\t\t",392],"}",["T_WHITESPACE"," ",393],["T_ELSE","else",393],["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n\t\t\t\t",393],["T_VARIABLE","$url",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/mws-eu.amazonservices.com\/OffAmazonPayments_Sandbox\/2013-01-01\/'",394],";",["T_WHITESPACE","\n\t\t\t",394],"}",["T_WHITESPACE","\n\t\t",395],"}",["T_WHITESPACE"," ",396],["T_ELSE","else",396],["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n\t\t\t",396],["T_IF","if",397],["T_WHITESPACE"," ",397],"(",["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","config",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","get",397],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",397],")",["T_WHITESPACE"," ",397],["T_IS_EQUAL","==",397],["T_WHITESPACE"," ",397],["T_CONSTANT_ENCAPSED_STRING","'USD'",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n\t\t\t\t",397],["T_VARIABLE","$url",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/mws.amazonservices.com\/OffAmazonPayments\/2013-01-01\/'",398],";",["T_WHITESPACE","\n\t\t\t",398],"}",["T_WHITESPACE"," ",399],["T_ELSE","else",399],["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n\t\t\t\t",399],["T_VARIABLE","$url",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/mws-eu.amazonservices.com\/OffAmazonPayments\/2013-01-01\/'",400],";",["T_WHITESPACE","\n\t\t\t",400],"}",["T_WHITESPACE","\n\t\t",401],"}",["T_WHITESPACE","\n\n\t\t",402],["T_VARIABLE","$parameters",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_ARRAY","array",404],"(",")",";",["T_WHITESPACE","\n\t\t",404],["T_VARIABLE","$parameters",405],"[",["T_CONSTANT_ENCAPSED_STRING","'AWSAccessKeyId'",405],"]",["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","config",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","get",405],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_access_key'",405],")",";",["T_WHITESPACE","\n\t\t",405],["T_VARIABLE","$parameters",406],"[",["T_CONSTANT_ENCAPSED_STRING","'Action'",406],"]",["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$Action",406],";",["T_WHITESPACE","\n\t\t",406],["T_IF","if",407],["T_WHITESPACE"," ",407],"(",["T_ISSET","isset",407],"(",["T_VARIABLE","$parameter_data",407],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",407],"]",")",")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n\t\t\t",407],["T_VARIABLE","$parameters",408],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",408],"]",["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$parameter_data",408],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",408],"]",";",["T_WHITESPACE","\n\t\t",408],"}",["T_WHITESPACE"," ",409],["T_ELSE","else",409],["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n\t\t\t",409],["T_VARIABLE","$parameters",410],"[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",410],"]",["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","session",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","data",410],"[",["T_CONSTANT_ENCAPSED_STRING","'lpa'",410],"]","[",["T_CONSTANT_ENCAPSED_STRING","'AmazonOrderReferenceId'",410],"]",";",["T_WHITESPACE","\n\t\t",410],"}",["T_WHITESPACE","\n\t\t",411],["T_VARIABLE","$parameters",412],"[",["T_CONSTANT_ENCAPSED_STRING","'SellerId'",412],"]",["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","config",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","get",412],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_merchant_id'",412],")",";",["T_WHITESPACE","\n\t\t",412],["T_VARIABLE","$parameters",413],"[",["T_CONSTANT_ENCAPSED_STRING","'SignatureMethod'",413],"]",["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_CONSTANT_ENCAPSED_STRING","'HmacSHA256'",413],";",["T_WHITESPACE","\n\t\t",413],["T_VARIABLE","$parameters",414],"[",["T_CONSTANT_ENCAPSED_STRING","'SignatureVersion'",414],"]",["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_LNUMBER","2",414],";",["T_WHITESPACE","\n\t\t",414],["T_VARIABLE","$parameters",415],"[",["T_CONSTANT_ENCAPSED_STRING","'Timestamp'",415],"]",["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","date",415],"(",["T_CONSTANT_ENCAPSED_STRING","'c'",415],",",["T_WHITESPACE"," ",415],["T_STRING","time",415],"(",")",")",";",["T_WHITESPACE","\n\t\t",415],["T_VARIABLE","$parameters",416],"[",["T_CONSTANT_ENCAPSED_STRING","'Version'",416],"]",["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_CONSTANT_ENCAPSED_STRING","'2013-01-01'",416],";",["T_WHITESPACE","\n\t\t",416],["T_FOREACH","foreach",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$parameter_data",417],["T_WHITESPACE"," ",417],["T_AS","as",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$k",417],["T_WHITESPACE"," ",417],["T_DOUBLE_ARROW","=>",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$v",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n\t\t\t",417],["T_VARIABLE","$parameters",418],"[",["T_VARIABLE","$k",418],"]",["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_VARIABLE","$v",418],";",["T_WHITESPACE","\n\t\t",418],"}",["T_WHITESPACE","\n\n\t\t",419],["T_VARIABLE","$query",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","calculateStringToSignV2",421],"(",["T_VARIABLE","$parameters",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$url",421],")",";",["T_WHITESPACE","\n\n\t\t",421],["T_VARIABLE","$parameters",423],"[",["T_CONSTANT_ENCAPSED_STRING","'Signature'",423],"]",["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_STRING","base64_encode",423],"(",["T_STRING","hash_hmac",423],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$query",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","config",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","get",423],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_access_secret'",423],")",",",["T_WHITESPACE"," ",423],["T_STRING","true",423],")",")",";",["T_WHITESPACE","\n\n\t\t",423],["T_RETURN","return",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","sendCurl",425],"(",["T_VARIABLE","$url",425],",",["T_WHITESPACE"," ",425],["T_VARIABLE","$parameters",425],")",";",["T_WHITESPACE","\n\t",425],"}",["T_WHITESPACE","\n\n\t",426],["T_PUBLIC","public",428],["T_WHITESPACE"," ",428],["T_FUNCTION","function",428],["T_WHITESPACE"," ",428],["T_STRING","sendCurl",428],"(",["T_VARIABLE","$url",428],",",["T_WHITESPACE"," ",428],["T_VARIABLE","$parameters",428],")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n\t\t",428],["T_VARIABLE","$query",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getParametersAsString",429],"(",["T_VARIABLE","$parameters",429],")",";",["T_WHITESPACE","\n\n\t\t",429],["T_VARIABLE","$curl",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_STRING","curl_init",431],"(",["T_VARIABLE","$url",431],")",";",["T_WHITESPACE","\n\n\t\t",431],["T_STRING","curl_setopt",433],"(",["T_VARIABLE","$curl",433],",",["T_WHITESPACE"," ",433],["T_STRING","CURLOPT_URL",433],",",["T_WHITESPACE"," ",433],["T_VARIABLE","$url",433],")",";",["T_WHITESPACE","\n\t\t",433],["T_STRING","curl_setopt",434],"(",["T_VARIABLE","$curl",434],",",["T_WHITESPACE"," ",434],["T_STRING","CURLOPT_PORT",434],",",["T_WHITESPACE"," ",434],["T_LNUMBER","443",434],")",";",["T_WHITESPACE","\n\t\t",434],["T_STRING","curl_setopt",435],"(",["T_VARIABLE","$curl",435],",",["T_WHITESPACE"," ",435],["T_STRING","CURLOPT_SSL_VERIFYPEER",435],",",["T_WHITESPACE"," ",435],["T_STRING","true",435],")",";",["T_WHITESPACE","\n\t\t",435],["T_STRING","curl_setopt",436],"(",["T_VARIABLE","$curl",436],",",["T_WHITESPACE"," ",436],["T_STRING","CURLOPT_SSL_VERIFYHOST",436],",",["T_WHITESPACE"," ",436],["T_LNUMBER","2",436],")",";",["T_WHITESPACE","\n\t\t",436],["T_STRING","curl_setopt",437],"(",["T_VARIABLE","$curl",437],",",["T_WHITESPACE"," ",437],["T_STRING","CURLOPT_USERAGENT",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","request",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","server",437],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",437],"]",")",";",["T_WHITESPACE","\n\t\t",437],["T_STRING","curl_setopt",438],"(",["T_VARIABLE","$curl",438],",",["T_WHITESPACE"," ",438],["T_STRING","CURLOPT_POST",438],",",["T_WHITESPACE"," ",438],["T_STRING","true",438],")",";",["T_WHITESPACE","\n\t\t",438],["T_STRING","curl_setopt",439],"(",["T_VARIABLE","$curl",439],",",["T_WHITESPACE"," ",439],["T_STRING","CURLOPT_POSTFIELDS",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$query",439],")",";",["T_WHITESPACE","\n\t\t",439],["T_STRING","curl_setopt",440],"(",["T_VARIABLE","$curl",440],",",["T_WHITESPACE"," ",440],["T_STRING","CURLOPT_HEADER",440],",",["T_WHITESPACE"," ",440],["T_STRING","true",440],")",";",["T_WHITESPACE","\n\t\t",440],["T_STRING","curl_setopt",441],"(",["T_VARIABLE","$curl",441],",",["T_WHITESPACE"," ",441],["T_STRING","CURLOPT_RETURNTRANSFER",441],",",["T_WHITESPACE"," ",441],["T_STRING","true",441],")",";",["T_WHITESPACE","\n\n\t\t",441],["T_VARIABLE","$response",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_STRING","curl_exec",443],"(",["T_VARIABLE","$curl",443],")",";",["T_WHITESPACE","\n\t\t",443],["T_STRING","curl_close",444],"(",["T_VARIABLE","$curl",444],")",";",["T_WHITESPACE","\n\n\t\t",444],["T_LIST","list",446],"(",["T_VARIABLE","$other",446],",",["T_WHITESPACE"," ",446],["T_VARIABLE","$responseBody",446],")",["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_STRING","explode",446],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\\r\\n\"",446],",",["T_WHITESPACE"," ",446],["T_VARIABLE","$response",446],",",["T_WHITESPACE"," ",446],["T_LNUMBER","2",446],")",";",["T_WHITESPACE","\n\t\t",446],["T_VARIABLE","$other",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_STRING","preg_split",447],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/\\r\\n|\\n|\\r\/\"",447],",",["T_WHITESPACE"," ",447],["T_VARIABLE","$other",447],")",";",["T_WHITESPACE","\n\n\t\t",447],["T_LIST","list",449],"(",["T_VARIABLE","$protocol",449],",",["T_WHITESPACE"," ",449],["T_VARIABLE","$code",449],",",["T_WHITESPACE"," ",449],["T_VARIABLE","$text",449],")",["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_STRING","explode",449],"(",["T_CONSTANT_ENCAPSED_STRING","' '",449],",",["T_WHITESPACE"," ",449],["T_STRING","trim",449],"(",["T_STRING","array_shift",449],"(",["T_VARIABLE","$other",449],")",")",",",["T_WHITESPACE"," ",449],["T_LNUMBER","3",449],")",";",["T_WHITESPACE","\n\n\t\t",449],["T_RETURN","return",451],["T_WHITESPACE"," ",451],["T_ARRAY","array",451],"(",["T_CONSTANT_ENCAPSED_STRING","'Status'",451],["T_WHITESPACE"," ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_INT_CAST","(int)",451],["T_VARIABLE","$code",451],",",["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","'ResponseBody'",451],["T_WHITESPACE"," ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_VARIABLE","$responseBody",451],")",";",["T_WHITESPACE","\n\t",451],"}",["T_WHITESPACE","\n\n\t",452],["T_PRIVATE","private",454],["T_WHITESPACE"," ",454],["T_FUNCTION","function",454],["T_WHITESPACE"," ",454],["T_STRING","getParametersAsString",454],"(",["T_ARRAY","array",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$parameters",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n\t\t",454],["T_VARIABLE","$queryParameters",455],["T_WHITESPACE"," ",455],"=",["T_WHITESPACE"," ",455],["T_ARRAY","array",455],"(",")",";",["T_WHITESPACE","\n\t\t",455],["T_FOREACH","foreach",456],["T_WHITESPACE"," ",456],"(",["T_VARIABLE","$parameters",456],["T_WHITESPACE"," ",456],["T_AS","as",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$key",456],["T_WHITESPACE"," ",456],["T_DOUBLE_ARROW","=>",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$value",456],")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n\t\t\t",456],["T_VARIABLE","$queryParameters",457],"[","]",["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_VARIABLE","$key",457],["T_WHITESPACE"," ",457],".",["T_WHITESPACE"," ",457],["T_CONSTANT_ENCAPSED_STRING","'='",457],["T_WHITESPACE"," ",457],".",["T_WHITESPACE"," ",457],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","urlencode",457],"(",["T_VARIABLE","$value",457],")",";",["T_WHITESPACE","\n\t\t",457],"}",["T_WHITESPACE","\n\t\t",458],["T_RETURN","return",459],["T_WHITESPACE"," ",459],["T_STRING","implode",459],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$queryParameters",459],")",";",["T_WHITESPACE","\n\t",459],"}",["T_WHITESPACE","\n\n\t",460],["T_PRIVATE","private",462],["T_WHITESPACE"," ",462],["T_FUNCTION","function",462],["T_WHITESPACE"," ",462],["T_STRING","calculateStringToSignV2",462],"(",["T_ARRAY","array",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$parameters",462],",",["T_WHITESPACE"," ",462],["T_VARIABLE","$url",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n\t\t",462],["T_VARIABLE","$data",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_CONSTANT_ENCAPSED_STRING","'POST'",463],";",["T_WHITESPACE","\n\t\t",463],["T_VARIABLE","$data",464],["T_WHITESPACE"," ",464],["T_CONCAT_EQUAL",".=",464],["T_WHITESPACE"," ",464],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",464],";",["T_WHITESPACE","\n\t\t",464],["T_VARIABLE","$endpoint",465],["T_WHITESPACE"," ",465],"=",["T_WHITESPACE"," ",465],["T_STRING","parse_url",465],"(",["T_VARIABLE","$url",465],")",";",["T_WHITESPACE","\n\t\t",465],["T_VARIABLE","$data",466],["T_WHITESPACE"," ",466],["T_CONCAT_EQUAL",".=",466],["T_WHITESPACE"," ",466],["T_VARIABLE","$endpoint",466],"[",["T_CONSTANT_ENCAPSED_STRING","'host'",466],"]",";",["T_WHITESPACE","\n\t\t",466],["T_VARIABLE","$data",467],["T_WHITESPACE"," ",467],["T_CONCAT_EQUAL",".=",467],["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",467],";",["T_WHITESPACE","\n\t\t",467],["T_VARIABLE","$uri",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_STRING","array_key_exists",468],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",468],",",["T_WHITESPACE"," ",468],["T_VARIABLE","$endpoint",468],")",["T_WHITESPACE"," ",468],"?",["T_WHITESPACE"," ",468],["T_VARIABLE","$endpoint",468],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",468],"]",["T_WHITESPACE"," ",468],":",["T_WHITESPACE"," ",468],["T_STRING","null",468],";",["T_WHITESPACE","\n\t\t",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(","!",["T_ISSET","isset",469],"(",["T_VARIABLE","$uri",469],")",")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n\t\t\t",469],["T_VARIABLE","$uri",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",470],";",["T_WHITESPACE","\n\t\t",470],"}",["T_WHITESPACE","\n\t\t",471],["T_VARIABLE","$uriencoded",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_STRING","implode",472],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/\"",472],",",["T_WHITESPACE"," ",472],["T_STRING","array_map",472],"(",["T_ARRAY","array",472],"(",["T_VARIABLE","$this",472],",",["T_WHITESPACE"," ",472],["T_CONSTANT_ENCAPSED_STRING","\"urlencode\"",472],")",",",["T_WHITESPACE"," ",472],["T_STRING","explode",472],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/\"",472],",",["T_WHITESPACE"," ",472],["T_VARIABLE","$uri",472],")",")",")",";",["T_WHITESPACE","\n\t\t",472],["T_VARIABLE","$data",473],["T_WHITESPACE"," ",473],["T_CONCAT_EQUAL",".=",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$uriencoded",473],";",["T_WHITESPACE","\n\t\t",473],["T_VARIABLE","$data",474],["T_WHITESPACE"," ",474],["T_CONCAT_EQUAL",".=",474],["T_WHITESPACE"," ",474],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",474],";",["T_WHITESPACE","\n\t\t",474],["T_STRING","uksort",475],"(",["T_VARIABLE","$parameters",475],",",["T_WHITESPACE"," ",475],["T_CONSTANT_ENCAPSED_STRING","'strcmp'",475],")",";",["T_WHITESPACE","\n\t\t",475],["T_VARIABLE","$data",476],["T_WHITESPACE"," ",476],["T_CONCAT_EQUAL",".=",476],["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getParametersAsString",476],"(",["T_VARIABLE","$parameters",476],")",";",["T_WHITESPACE","\n\t\t",476],["T_RETURN","return",477],["T_WHITESPACE"," ",477],["T_VARIABLE","$data",477],";",["T_WHITESPACE","\n\t",477],"}",["T_WHITESPACE","\n\n\t",478],["T_PRIVATE","private",480],["T_WHITESPACE"," ",480],["T_FUNCTION","function",480],["T_WHITESPACE"," ",480],["T_STRING","urlencode",480],"(",["T_VARIABLE","$value",480],")",["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n\t\t",480],["T_RETURN","return",481],["T_WHITESPACE"," ",481],["T_STRING","str_replace",481],"(",["T_CONSTANT_ENCAPSED_STRING","'%7E'",481],",",["T_WHITESPACE"," ",481],["T_CONSTANT_ENCAPSED_STRING","'~'",481],",",["T_WHITESPACE"," ",481],["T_STRING","rawurlencode",481],"(",["T_VARIABLE","$value",481],")",")",";",["T_WHITESPACE","\n\t",481],"}",["T_WHITESPACE","\n\n\t",482],["T_PUBLIC","public",484],["T_WHITESPACE"," ",484],["T_FUNCTION","function",484],["T_WHITESPACE"," ",484],["T_STRING","parseRawMessage",484],"(",["T_VARIABLE","$body",484],")",["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n\t\t",484],["T_VARIABLE","$snsMessage",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","buildMessage",485],"(",["T_VARIABLE","$body",485],")",";",["T_WHITESPACE","\n\t\t",485],["T_VARIABLE","$ipnMessage",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getField",486],"(",["T_CONSTANT_ENCAPSED_STRING","\"Message\"",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$snsMessage",486],")",";",["T_WHITESPACE","\n\n\t\t",486],["T_RETURN","return",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$this",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","parseIpnMessage",488],"(",["T_VARIABLE","$ipnMessage",488],")",";",["T_WHITESPACE","\n\t",488],"}",["T_WHITESPACE","\n\n\t",489],["T_PRIVATE","private",491],["T_WHITESPACE"," ",491],["T_FUNCTION","function",491],["T_WHITESPACE"," ",491],["T_STRING","buildMessage",491],"(",["T_VARIABLE","$json",491],")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n\t\t",491],["T_VARIABLE","$message",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_STRING","json_decode",492],"(",["T_VARIABLE","$json",492],",",["T_WHITESPACE"," ",492],["T_STRING","true",492],")",";",["T_WHITESPACE","\n\t\t",492],["T_VARIABLE","$json_error",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_STRING","json_last_error",493],"(",")",";",["T_WHITESPACE","\n\n\t\t",493],["T_IF","if",495],["T_WHITESPACE"," ",495],"(",["T_VARIABLE","$json_error",495],["T_WHITESPACE"," ",495],["T_IS_NOT_EQUAL","!=",495],["T_WHITESPACE"," ",495],["T_LNUMBER","0",495],")",["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n\t\t\t",495],["T_VARIABLE","$errorMsg",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_CONSTANT_ENCAPSED_STRING","\"Error with message - content is not in json format\"",496],["T_WHITESPACE"," ",496],".",["T_WHITESPACE","\n\t\t\t\t\t",496],["T_VARIABLE","$json_error",497],["T_WHITESPACE"," ",497],".",["T_WHITESPACE"," ",497],["T_CONSTANT_ENCAPSED_STRING","\" \"",497],["T_WHITESPACE"," ",497],".",["T_WHITESPACE","\n\t\t\t\t\t",497],["T_VARIABLE","$json",498],";",["T_WHITESPACE","\n\t\t\t",498],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","logger",499],"(",["T_VARIABLE","$errorMsg",499],")",";",["T_WHITESPACE","\n\t\t",499],"}",["T_WHITESPACE","\n\t\t",500],["T_RETURN","return",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$message",501],";",["T_WHITESPACE","\n\t",501],"}",["T_WHITESPACE","\n\n\t",502],["T_PRIVATE","private",504],["T_WHITESPACE"," ",504],["T_FUNCTION","function",504],["T_WHITESPACE"," ",504],["T_STRING","parseIpnMessage",504],"(",["T_VARIABLE","$ipnMsg",504],")",["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n\t\t",504],["T_VARIABLE","$xmlDocumentElement",505],["T_WHITESPACE"," ",505],"=",["T_WHITESPACE"," ",505],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","getXmlFromIpnMessage",505],"(",["T_VARIABLE","$ipnMsg",505],")",";",["T_WHITESPACE","\n\t\t",505],["T_RETURN","return",506],["T_WHITESPACE"," ",506],["T_VARIABLE","$xmlDocumentElement",506],";",["T_WHITESPACE","\n\t",506],"}",["T_WHITESPACE","\n\n\t",507],["T_PRIVATE","private",509],["T_WHITESPACE"," ",509],["T_FUNCTION","function",509],["T_WHITESPACE"," ",509],["T_STRING","getXmlFromIpnMessage",509],"(",["T_VARIABLE","$ipnMsg",509],")",["T_WHITESPACE"," ",509],"{",["T_WHITESPACE","\n\t\t",509],["T_VARIABLE","$notificationData",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","getField",510],"(",["T_CONSTANT_ENCAPSED_STRING","\"NotificationData\"",510],",",["T_WHITESPACE"," ",510],["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","buildMessage",510],"(",["T_VARIABLE","$ipnMsg",510],")",")",";",["T_WHITESPACE","\n\t\t",510],["T_STRING","libxml_use_internal_errors",511],"(",["T_STRING","true",511],")",";",["T_WHITESPACE","\n\t\t",511],["T_TRY","try",512],["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n\t\t\t",512],["T_VARIABLE","$xml",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_STRING","simplexml_load_string",513],"(",["T_VARIABLE","$notificationData",513],")",";",["T_WHITESPACE","\n\t\t",513],"}",["T_WHITESPACE"," ",514],["T_CATCH","catch",514],["T_WHITESPACE"," ",514],"(",["T_STRING","Exception",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$ex",514],")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n\t\t\t",514],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","logger",515],"(",["T_VARIABLE","$notificationData",515],")",";",["T_WHITESPACE","\n\t\t",515],"}",["T_WHITESPACE","\n\t\t",516],["T_RETURN","return",517],["T_WHITESPACE"," ",517],["T_VARIABLE","$xml",517],";",["T_WHITESPACE","\n\t",517],"}",["T_WHITESPACE","\n\n\t",518],["T_PRIVATE","private",520],["T_WHITESPACE"," ",520],["T_FUNCTION","function",520],["T_WHITESPACE"," ",520],["T_STRING","getField",520],"(",["T_VARIABLE","$fieldName",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$snsMessage",520],")",["T_WHITESPACE"," ",520],"{",["T_WHITESPACE","\n\t\t",520],["T_IF","if",521],["T_WHITESPACE"," ",521],"(",["T_STRING","array_key_exists",521],"(",["T_VARIABLE","$fieldName",521],",",["T_WHITESPACE"," ",521],["T_VARIABLE","$snsMessage",521],")",")",["T_WHITESPACE"," ",521],"{",["T_WHITESPACE","\n\t\t\t",521],["T_RETURN","return",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$snsMessage",522],"[",["T_VARIABLE","$fieldName",522],"]",";",["T_WHITESPACE","\n\t\t",522],"}",["T_WHITESPACE"," ",523],["T_ELSE","else",523],["T_WHITESPACE"," ",523],"{",["T_WHITESPACE","\n\t\t\t",523],["T_RETURN","return",524],["T_WHITESPACE"," ",524],["T_STRING","null",524],";",["T_WHITESPACE","\n\t\t",524],"}",["T_WHITESPACE","\n\t",525],"}",["T_WHITESPACE","\n\n\t",526],["T_PUBLIC","public",528],["T_WHITESPACE"," ",528],["T_FUNCTION","function",528],["T_WHITESPACE"," ",528],["T_STRING","getWidgetJs",528],"(",")",["T_WHITESPACE"," ",528],"{",["T_WHITESPACE","\n\t\t",528],["T_IF","if",529],["T_WHITESPACE"," ",529],"(",["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","config",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","get",529],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_test'",529],")",["T_WHITESPACE"," ",529],["T_IS_EQUAL","==",529],["T_WHITESPACE"," ",529],["T_CONSTANT_ENCAPSED_STRING","'sandbox'",529],")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n\t\t\t",529],["T_IF","if",530],["T_WHITESPACE"," ",530],"(",["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","config",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","get",530],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",530],")",["T_WHITESPACE"," ",530],["T_IS_EQUAL","==",530],["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","'GBP'",530],")",["T_WHITESPACE"," ",530],"{",["T_WHITESPACE","\n\t\t\t\t",530],["T_VARIABLE","$amazon_payment_js",531],["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/static-eu.payments-amazon.com\/OffAmazonPayments\/uk\/sandbox\/lpa\/js\/Widgets.js'",531],";",["T_WHITESPACE","\n\t\t\t",531],"}",["T_WHITESPACE"," ",532],["T_ELSEIF","elseif",532],["T_WHITESPACE"," ",532],"(",["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","config",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","get",532],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",532],")",["T_WHITESPACE"," ",532],["T_IS_EQUAL","==",532],["T_WHITESPACE"," ",532],["T_CONSTANT_ENCAPSED_STRING","'USD'",532],")",["T_WHITESPACE"," ",532],"{",["T_WHITESPACE","\n\t\t\t\t",532],["T_VARIABLE","$amazon_payment_js",533],["T_WHITESPACE"," ",533],"=",["T_WHITESPACE"," ",533],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/static-na.payments-amazon.com\/OffAmazonPayments\/us\/sandbox\/js\/Widgets.js'",533],";",["T_WHITESPACE","\n\t\t\t",533],"}",["T_WHITESPACE"," ",534],["T_ELSE","else",534],["T_WHITESPACE"," ",534],"{",["T_WHITESPACE","\n\t\t\t\t",534],["T_VARIABLE","$amazon_payment_js",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/static-eu.payments-amazon.com\/OffAmazonPayments\/de\/sandbox\/lpa\/js\/Widgets.js'",535],";",["T_WHITESPACE","\n\t\t\t",535],"}",["T_WHITESPACE","\n\t\t",536],"}",["T_WHITESPACE"," ",537],["T_ELSE","else",537],["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n\t\t\t",537],["T_IF","if",538],["T_WHITESPACE"," ",538],"(",["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","config",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","get",538],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",538],")",["T_WHITESPACE"," ",538],["T_IS_EQUAL","==",538],["T_WHITESPACE"," ",538],["T_CONSTANT_ENCAPSED_STRING","'GBP'",538],")",["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n\t\t\t\t",538],["T_VARIABLE","$amazon_payment_js",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/static-eu.payments-amazon.com\/OffAmazonPayments\/uk\/lpa\/js\/Widgets.js'",539],";",["T_WHITESPACE","\n\t\t\t",539],"}",["T_WHITESPACE"," ",540],["T_ELSEIF","elseif",540],["T_WHITESPACE"," ",540],"(",["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","config",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","get",540],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_payment_region'",540],")",["T_WHITESPACE"," ",540],["T_IS_EQUAL","==",540],["T_WHITESPACE"," ",540],["T_CONSTANT_ENCAPSED_STRING","'USD'",540],")",["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n\t\t\t\t",540],["T_VARIABLE","$amazon_payment_js",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/static-na.payments-amazon.com\/OffAmazonPayments\/us\/js\/Widgets.js'",541],";",["T_WHITESPACE","\n\t\t\t",541],"}",["T_WHITESPACE"," ",542],["T_ELSE","else",542],["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n\t\t\t\t",542],["T_VARIABLE","$amazon_payment_js",543],["T_WHITESPACE"," ",543],"=",["T_WHITESPACE"," ",543],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/static-eu.payments-amazon.com\/OffAmazonPayments\/de\/lpa\/js\/Widgets.js'",543],";",["T_WHITESPACE","\n\t\t\t",543],"}",["T_WHITESPACE","\n\t\t",544],"}",["T_WHITESPACE","\n\t\t",545],["T_RETURN","return",546],["T_WHITESPACE"," ",546],["T_VARIABLE","$amazon_payment_js",546],["T_WHITESPACE"," ",546],".",["T_WHITESPACE"," ",546],["T_CONSTANT_ENCAPSED_STRING","'?sellerId='",546],["T_WHITESPACE"," ",546],".",["T_WHITESPACE"," ",546],["T_VARIABLE","$this",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","config",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","get",546],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_merchant_id'",546],")",";",["T_WHITESPACE","\n\t",546],"}",["T_WHITESPACE","\n\n\t",547],["T_PUBLIC","public",549],["T_WHITESPACE"," ",549],["T_FUNCTION","function",549],["T_WHITESPACE"," ",549],["T_STRING","getMethod",549],"(",["T_VARIABLE","$address",549],",",["T_WHITESPACE"," ",549],["T_VARIABLE","$total",549],")",["T_WHITESPACE"," ",549],"{",["T_WHITESPACE","\n\t\t",549],["T_COMMENT","\/\/ Not shown in the payment method list\n",550],["T_WHITESPACE","\t\t",551],["T_RETURN","return",551],["T_WHITESPACE"," ",551],["T_ARRAY","array",551],"(",")",";",["T_WHITESPACE","\n\t",551],"}",["T_WHITESPACE","\n\n\t",552],["T_PUBLIC","public",554],["T_WHITESPACE"," ",554],["T_FUNCTION","function",554],["T_WHITESPACE"," ",554],["T_STRING","logger",554],"(",["T_VARIABLE","$data",554],")",["T_WHITESPACE"," ",554],"{",["T_WHITESPACE","\n\t\t",554],["T_IF","if",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","config",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","get",555],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay_debug'",555],")",")",["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n\t\t\t",555],["T_VARIABLE","$log",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_NEW","new",556],["T_WHITESPACE"," ",556],["T_STRING","Log",556],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_login_pay.log'",556],")",";",["T_WHITESPACE","\n\t\t\t",556],["T_VARIABLE","$backtrace",557],["T_WHITESPACE"," ",557],"=",["T_WHITESPACE"," ",557],["T_STRING","debug_backtrace",557],"(",")",";",["T_WHITESPACE","\n\t\t\t",557],["T_VARIABLE","$log",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","write",558],"(",["T_VARIABLE","$backtrace",558],"[",["T_LNUMBER","6",558],"]","[",["T_CONSTANT_ENCAPSED_STRING","'class'",558],"]",["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","'::'",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_VARIABLE","$backtrace",558],"[",["T_LNUMBER","6",558],"]","[",["T_CONSTANT_ENCAPSED_STRING","'function'",558],"]",["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","' Data:  '",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_STRING","print_r",558],"(",["T_VARIABLE","$data",558],",",["T_WHITESPACE"," ",558],["T_LNUMBER","1",558],")",")",";",["T_WHITESPACE","\n\t\t",558],"}",["T_WHITESPACE","\n\t",559],"}",["T_WHITESPACE","\n\n",560],"}"]