[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ModelExtensionFraudFraudLabsPro",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Model",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","check",3],"(",["T_VARIABLE","$data",3],")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_COMMENT","\/\/ Do not perform fraud check if FraudLabs Pro is disabled or API key is not provided.\n",4],["T_WHITESPACE","\t\t",5],["T_IF","if",5],["T_WHITESPACE"," ",5],"(","!",["T_VARIABLE","$this",5],["T_OBJECT_OPERATOR","->",5],["T_STRING","config",5],["T_OBJECT_OPERATOR","->",5],["T_STRING","get",5],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_status'",5],")",["T_WHITESPACE"," ",5],["T_BOOLEAN_OR","||",5],"!",["T_VARIABLE","$this",5],["T_OBJECT_OPERATOR","->",5],["T_STRING","config",5],["T_OBJECT_OPERATOR","->",5],["T_STRING","get",5],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_key'",5],")",")",["T_WHITESPACE"," ",5],"{",["T_WHITESPACE","\n\t\t\t",5],["T_RETURN","return",6],";",["T_WHITESPACE","\n\t\t",6],"}",["T_WHITESPACE","\n\n\t\t",7],["T_VARIABLE","$risk_score",9],["T_WHITESPACE"," ",9],"=",["T_WHITESPACE"," ",9],["T_LNUMBER","0",9],";",["T_WHITESPACE","\n\n\t\t",9],["T_VARIABLE","$query",11],["T_WHITESPACE"," ",11],"=",["T_WHITESPACE"," ",11],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","db",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","query",11],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",11],["T_WHITESPACE"," ",11],".",["T_WHITESPACE"," ",11],["T_STRING","DB_PREFIX",11],["T_WHITESPACE"," ",11],".",["T_WHITESPACE"," ",11],["T_CONSTANT_ENCAPSED_STRING","\"fraudlabspro` WHERE order_id = '\"",11],["T_WHITESPACE"," ",11],".",["T_WHITESPACE"," ",11],["T_INT_CAST","(int)",11],["T_VARIABLE","$data",11],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",11],"]",["T_WHITESPACE"," ",11],".",["T_WHITESPACE"," ",11],["T_CONSTANT_ENCAPSED_STRING","\"'\"",11],")",";",["T_WHITESPACE","\n\n\t\t",11],["T_COMMENT","\/\/ Do not call FraudLabs Pro API if order is already screened.\n",13],["T_WHITESPACE","\t\t",14],["T_IF","if",14],["T_WHITESPACE"," ",14],"(",["T_VARIABLE","$query",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","num_rows",14],")",["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\t\t\t",14],["T_RETURN","return",15],";",["T_WHITESPACE","\n\t\t",15],"}",["T_WHITESPACE","\n\n\t\t",16],["T_VARIABLE","$ip",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_VARIABLE","$data",18],"[",["T_CONSTANT_ENCAPSED_STRING","'ip'",18],"]",";",["T_WHITESPACE","\n\n\t\t",18],["T_COMMENT","\/\/ Detect client IP is store is behind CloudFlare protection.\n",20],["T_WHITESPACE","\t\t",21],["T_IF","if",21],"(",["T_ISSET","isset",21],"(",["T_VARIABLE","$_SERVER",21],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CF_CONNECTING_IP'",21],"]",")",["T_WHITESPACE"," ",21],["T_BOOLEAN_AND","&&",21],["T_WHITESPACE"," ",21],["T_STRING","filter_var",21],"(",["T_VARIABLE","$_SERVER",21],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CF_CONNECTING_IP'",21],"]",",",["T_WHITESPACE"," ",21],["T_STRING","FILTER_VALIDATE_IP",21],")",")","{",["T_WHITESPACE","\n\t\t\t",21],["T_VARIABLE","$ip",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$_SERVER",22],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CF_CONNECTING_IP'",22],"]",";",["T_WHITESPACE","\n\t\t",22],"}",["T_WHITESPACE","\n\n\t\t",23],["T_COMMENT","\/\/ Get real client IP is they are behind proxy server.\n",25],["T_WHITESPACE","\t\t",26],["T_IF","if",26],"(",["T_ISSET","isset",26],"(",["T_VARIABLE","$_SERVER",26],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",26],"]",")",["T_WHITESPACE"," ",26],["T_BOOLEAN_AND","&&",26],["T_WHITESPACE"," ",26],["T_STRING","filter_var",26],"(",["T_VARIABLE","$_SERVER",26],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",26],"]",",",["T_WHITESPACE"," ",26],["T_STRING","FILTER_VALIDATE_IP",26],")",")","{",["T_WHITESPACE","\n\t\t\t",26],["T_VARIABLE","$ip",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$_SERVER",27],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",27],"]",";",["T_WHITESPACE","\n\t\t",27],"}",["T_WHITESPACE","\n\n\t\t",28],["T_COMMENT","\/\/ Overwrite client IP if simulate IP is provided.\n",30],["T_WHITESPACE","\t\t",31],["T_IF","if",31],["T_WHITESPACE"," ",31],"(",["T_STRING","filter_var",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","config",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","get",31],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_simulate_ip'",31],")",",",["T_WHITESPACE"," ",31],["T_STRING","FILTER_VALIDATE_IP",31],")",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n\t\t\t",31],["T_VARIABLE","$ip",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","config",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","get",32],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_simulate_ip'",32],")",";",["T_WHITESPACE","\n\t\t",32],"}",["T_WHITESPACE","\n\n\t\t",33],["T_VARIABLE","$request",35],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",35],"]",["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","config",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","get",35],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_key'",35],")",";",["T_WHITESPACE","\n\t\t",35],["T_VARIABLE","$request",36],"[",["T_CONSTANT_ENCAPSED_STRING","'ip'",36],"]",["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$ip",36],";",["T_WHITESPACE","\n\t\t",36],["T_VARIABLE","$request",37],"[",["T_CONSTANT_ENCAPSED_STRING","'first_name'",37],"]",["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$data",37],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",37],"]",";",["T_WHITESPACE","\n\t\t",37],["T_VARIABLE","$request",38],"[",["T_CONSTANT_ENCAPSED_STRING","'last_name'",38],"]",["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$data",38],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",38],"]",";",["T_WHITESPACE","\n\t\t",38],["T_VARIABLE","$request",39],"[",["T_CONSTANT_ENCAPSED_STRING","'bill_city'",39],"]",["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$data",39],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",39],"]",";",["T_WHITESPACE","\n\t\t",39],["T_VARIABLE","$request",40],"[",["T_CONSTANT_ENCAPSED_STRING","'bill_state'",40],"]",["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$data",40],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",40],"]",";",["T_WHITESPACE","\n\t\t",40],["T_VARIABLE","$request",41],"[",["T_CONSTANT_ENCAPSED_STRING","'bill_country'",41],"]",["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$data",41],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_iso_code_2'",41],"]",";",["T_WHITESPACE","\n\t\t",41],["T_VARIABLE","$request",42],"[",["T_CONSTANT_ENCAPSED_STRING","'bill_zip_code'",42],"]",["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$data",42],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",42],"]",";",["T_WHITESPACE","\n\t\t",42],["T_VARIABLE","$request",43],"[",["T_CONSTANT_ENCAPSED_STRING","'email_domain'",43],"]",["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","utf8_substr",43],"(",["T_STRING","strrchr",43],"(",["T_VARIABLE","$data",43],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",43],"]",",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'@'",43],")",",",["T_WHITESPACE"," ",43],["T_LNUMBER","1",43],")",";",["T_WHITESPACE","\n\t\t",43],["T_VARIABLE","$request",44],"[",["T_CONSTANT_ENCAPSED_STRING","'user_phone'",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$data",44],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",44],"]",";",["T_WHITESPACE","\n\n\t\t",44],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$data",46],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",46],"]",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n\t\t\t",46],["T_VARIABLE","$request",47],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_addr'",47],"]",["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$data",47],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",47],"]",";",["T_WHITESPACE","\n\t\t\t",47],["T_VARIABLE","$request",48],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_city'",48],"]",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$data",48],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",48],"]",";",["T_WHITESPACE","\n\t\t\t",48],["T_VARIABLE","$request",49],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_state'",49],"]",["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$data",49],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",49],"]",";",["T_WHITESPACE","\n\t\t\t",49],["T_VARIABLE","$request",50],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_zip_code'",50],"]",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$data",50],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",50],"]",";",["T_WHITESPACE","\n\t\t\t",50],["T_VARIABLE","$request",51],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_country'",51],"]",["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$data",51],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_iso_code_2'",51],"]",";",["T_WHITESPACE","\n\t\t",51],"}",["T_WHITESPACE","\n\t\t\n\t\t",52],["T_VARIABLE","$request",54],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",54],"]",["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$data",54],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",54],"]",";",["T_WHITESPACE","\n\t\t",54],["T_VARIABLE","$request",55],"[",["T_CONSTANT_ENCAPSED_STRING","'email_hash'",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","hashIt",55],"(",["T_VARIABLE","$data",55],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",55],"]",")",";",["T_WHITESPACE","\n\t\t",55],["T_VARIABLE","$request",56],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",56],"]",["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","currency",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","format",56],"(",["T_VARIABLE","$data",56],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",56],"]",",",["T_WHITESPACE"," ",56],["T_VARIABLE","$data",56],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",56],"]",",",["T_WHITESPACE"," ",56],["T_VARIABLE","$data",56],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",56],"]",",",["T_WHITESPACE"," ",56],["T_STRING","false",56],")",";",["T_WHITESPACE","\n\t\t",56],["T_VARIABLE","$request",57],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",57],"]",["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","1",57],";",["T_WHITESPACE","\n\t\t",57],["T_VARIABLE","$request",58],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",58],"]",["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$data",58],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",58],"]",";",["T_WHITESPACE","\n\t\t",58],["T_VARIABLE","$request",59],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_mode'",59],"]",["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$data",59],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_code'",59],"]",";",["T_WHITESPACE","\n\t\t",59],["T_VARIABLE","$request",60],"[",["T_CONSTANT_ENCAPSED_STRING","'user_order_id'",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$data",60],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",60],"]",";",["T_WHITESPACE","\n\t\t",60],["T_VARIABLE","$request",61],"[",["T_CONSTANT_ENCAPSED_STRING","'flp_checksum'",61],"]",["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],"(",["T_ISSET","isset",61],"(",["T_VARIABLE","$_COOKIE",61],"[",["T_CONSTANT_ENCAPSED_STRING","'flp_checksum'",61],"]",")",")",["T_WHITESPACE"," ",61],"?",["T_WHITESPACE"," ",61],["T_VARIABLE","$_COOKIE",61],"[",["T_CONSTANT_ENCAPSED_STRING","'flp_checksum'",61],"]",["T_WHITESPACE"," ",61],":",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","''",61],";",["T_WHITESPACE","\n\t\t",61],["T_VARIABLE","$request",62],"[",["T_CONSTANT_ENCAPSED_STRING","'format'",62],"]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'json'",62],";",["T_WHITESPACE","\n\t\t",62],["T_VARIABLE","$request",63],"[",["T_CONSTANT_ENCAPSED_STRING","'source'",63],"]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'opencart'",63],";",["T_WHITESPACE","\n\t\t",63],["T_VARIABLE","$request",64],"[",["T_CONSTANT_ENCAPSED_STRING","'source_version'",64],"]",["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'2.1.0.2'",64],";",["T_WHITESPACE","\n\n\t\t",64],["T_VARIABLE","$curl",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","curl_init",66],"(",")",";",["T_WHITESPACE","\n\t\t",66],["T_STRING","curl_setopt",67],"(",["T_VARIABLE","$curl",67],",",["T_WHITESPACE"," ",67],["T_STRING","CURLOPT_URL",67],",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/api.fraudlabspro.com\/v1\/order\/screen?'",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_STRING","http_build_query",67],"(",["T_VARIABLE","$request",67],")",")",";",["T_WHITESPACE","\n\t\t",67],["T_STRING","curl_setopt",68],"(",["T_VARIABLE","$curl",68],",",["T_WHITESPACE"," ",68],["T_STRING","CURLOPT_HEADER",68],",",["T_WHITESPACE"," ",68],["T_LNUMBER","0",68],")",";",["T_WHITESPACE","\n\t\t",68],["T_STRING","curl_setopt",69],"(",["T_VARIABLE","$curl",69],",",["T_WHITESPACE"," ",69],["T_STRING","CURLOPT_SSL_VERIFYPEER",69],",",["T_WHITESPACE"," ",69],["T_LNUMBER","0",69],")",";",["T_WHITESPACE","\n\t\t",69],["T_STRING","curl_setopt",70],"(",["T_VARIABLE","$curl",70],",",["T_WHITESPACE"," ",70],["T_STRING","CURLOPT_RETURNTRANSFER",70],",",["T_WHITESPACE"," ",70],["T_LNUMBER","1",70],")",";",["T_WHITESPACE","\n\t\t",70],["T_STRING","curl_setopt",71],"(",["T_VARIABLE","$curl",71],",",["T_WHITESPACE"," ",71],["T_STRING","CURLOPT_FORBID_REUSE",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","1",71],")",";",["T_WHITESPACE","\n\t\t",71],["T_STRING","curl_setopt",72],"(",["T_VARIABLE","$curl",72],",",["T_WHITESPACE"," ",72],["T_STRING","CURLOPT_FRESH_CONNECT",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","1",72],")",";",["T_WHITESPACE","\n\n\t\t",72],["T_VARIABLE","$response",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","curl_exec",74],"(",["T_VARIABLE","$curl",74],")",";",["T_WHITESPACE","\n\n\t\t",74],["T_STRING","curl_close",76],"(",["T_VARIABLE","$curl",76],")",";",["T_WHITESPACE","\n\n\t\t",76],["T_VARIABLE","$risk_score",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_LNUMBER","0",78],";",["T_WHITESPACE","\n\n\t\t",78],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","is_null",80],"(",["T_VARIABLE","$json",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","json_decode",80],"(",["T_VARIABLE","$response",80],")",")",["T_WHITESPACE"," ",80],["T_IS_IDENTICAL","===",80],["T_WHITESPACE"," ",80],["T_STRING","FALSE",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n\t\t\t",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","db",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","query",81],"(",["T_CONSTANT_ENCAPSED_STRING","\"REPLACE INTO `\"",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_STRING","DB_PREFIX",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","\"fraudlabspro` SET order_id = '\"",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_INT_CAST","(int)",81],["T_VARIABLE","$data",81],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",81],"]",["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_country_match = '\"",81],["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","db",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","escape",82],"(",["T_VARIABLE","$json",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","is_country_match",82],")",["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_high_risk_country = '\"",82],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","db",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","escape",83],"(",["T_VARIABLE","$json",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","is_high_risk_country",83],")",["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tdistance_in_km = '\"",83],["T_WHITESPACE"," ",84],".",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","db",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","escape",84],"(",["T_VARIABLE","$json",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","distance_in_km",84],")",["T_WHITESPACE"," ",84],".",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tdistance_in_mile = '\"",84],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","db",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","escape",85],"(",["T_VARIABLE","$json",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","distance_in_mile",85],")",["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_country = '\"",85],["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","db",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","escape",86],"(",["T_VARIABLE","$json",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","ip_country",86],")",["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_region = '\"",86],["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","db",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","escape",87],"(",["T_VARIABLE","$json",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","ip_region",87],")",["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_city = '\"",87],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","db",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","escape",88],"(",["T_VARIABLE","$json",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","ip_city",88],")",["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_continent = '\"",88],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","db",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","escape",89],"(",["T_VARIABLE","$json",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","ip_continent",89],")",["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_latitude = '\"",89],["T_WHITESPACE"," ",90],".",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","db",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","escape",90],"(",["T_VARIABLE","$json",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","ip_latitude",90],")",["T_WHITESPACE"," ",90],".",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_longitude = '\"",90],["T_WHITESPACE"," ",91],".",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","db",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","escape",91],"(",["T_VARIABLE","$json",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","ip_longitude",91],")",["T_WHITESPACE"," ",91],".",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_timezone = '\"",91],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","db",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","escape",92],"(",["T_VARIABLE","$json",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","ip_timezone",92],")",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_elevation = '\"",92],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","db",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","escape",93],"(",["T_VARIABLE","$json",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","ip_elevation",93],")",["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_domain = '\"",93],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","db",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","escape",94],"(",["T_VARIABLE","$json",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","ip_domain",94],")",["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_mobile_mnc = '\"",94],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","db",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","escape",95],"(",["T_VARIABLE","$json",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","ip_mobile_mnc",95],")",["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_mobile_mcc = '\"",95],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","db",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","escape",96],"(",["T_VARIABLE","$json",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","ip_mobile_mcc",96],")",["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_mobile_brand = '\"",96],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","db",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","escape",97],"(",["T_VARIABLE","$json",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","ip_mobile_brand",97],")",["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_netspeed = '\"",97],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","db",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","escape",98],"(",["T_VARIABLE","$json",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","ip_netspeed",98],")",["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_isp_name = '\"",98],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","db",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","escape",99],"(",["T_VARIABLE","$json",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","ip_isp_name",99],")",["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_usage_type = '\"",99],["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","db",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","escape",100],"(",["T_VARIABLE","$json",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","ip_usage_type",100],")",["T_WHITESPACE"," ",100],".",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_free_email = '\"",100],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","db",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","escape",101],"(",["T_VARIABLE","$json",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","is_free_email",101],")",["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_new_domain_name = '\"",101],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","db",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","escape",102],"(",["T_VARIABLE","$json",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","is_new_domain_name",102],")",["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_proxy_ip_address = '\"",102],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","db",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","escape",103],"(",["T_VARIABLE","$json",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","is_proxy_ip_address",103],")",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bin_found = '\"",103],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","db",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","escape",104],"(",["T_VARIABLE","$json",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","is_bin_found",104],")",["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bin_country_match = '\"",104],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","db",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","escape",105],"(",["T_VARIABLE","$json",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","is_bin_country_match",105],")",["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bin_name_match = '\"",105],["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","db",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","escape",106],"(",["T_VARIABLE","$json",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","is_bin_name_match",106],")",["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bin_phone_match = '\"",106],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","db",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","escape",107],"(",["T_VARIABLE","$json",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","is_bin_phone_match",107],")",["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bin_prepaid = '\"",107],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","db",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","escape",108],"(",["T_VARIABLE","$json",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","is_bin_prepaid",108],")",["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_address_ship_forward = '\"",108],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","db",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","escape",109],"(",["T_VARIABLE","$json",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","is_address_ship_forward",109],")",["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bill_ship_city_match = '\"",109],["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","db",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","escape",110],"(",["T_VARIABLE","$json",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","is_bill_ship_city_match",110],")",["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bill_ship_state_match = '\"",110],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","escape",111],"(",["T_VARIABLE","$json",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","is_bill_ship_state_match",111],")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bill_ship_country_match = '\"",111],["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","db",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","escape",112],"(",["T_VARIABLE","$json",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","is_bill_ship_country_match",112],")",["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_bill_ship_postal_match = '\"",112],["T_WHITESPACE"," ",113],".",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","db",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","escape",113],"(",["T_VARIABLE","$json",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","is_bill_ship_postal_match",113],")",["T_WHITESPACE"," ",113],".",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_ip_blacklist = '\"",113],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","db",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","escape",114],"(",["T_VARIABLE","$json",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","is_ip_blacklist",114],")",["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_email_blacklist = '\"",114],["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","db",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","escape",115],"(",["T_VARIABLE","$json",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","is_email_blacklist",115],")",["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_credit_card_blacklist = '\"",115],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","db",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","escape",116],"(",["T_VARIABLE","$json",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","is_credit_card_blacklist",116],")",["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_device_blacklist = '\"",116],["T_WHITESPACE"," ",117],".",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","db",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","escape",117],"(",["T_VARIABLE","$json",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","is_device_blacklist",117],")",["T_WHITESPACE"," ",117],".",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tis_user_blacklist = '\"",117],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","db",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","escape",118],"(",["T_VARIABLE","$json",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","is_user_blacklist",118],")",["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_score = '\"",118],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","db",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","escape",119],"(",["T_VARIABLE","$json",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","fraudlabspro_score",119],")",["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_distribution = '\"",119],["T_WHITESPACE"," ",120],".",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","db",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","escape",120],"(",["T_VARIABLE","$json",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","fraudlabspro_distribution",120],")",["T_WHITESPACE"," ",120],".",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_status = '\"",120],["T_WHITESPACE"," ",121],".",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","db",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","escape",121],"(",["T_VARIABLE","$json",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","fraudlabspro_status",121],")",["T_WHITESPACE"," ",121],".",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_id = '\"",121],["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","db",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","escape",122],"(",["T_VARIABLE","$json",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","fraudlabspro_id",122],")",["T_WHITESPACE"," ",122],".",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_error = '\"",122],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","db",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","escape",123],"(",["T_VARIABLE","$json",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","fraudlabspro_error_code",123],")",["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_message = '\"",123],["T_WHITESPACE"," ",124],".",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","db",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","escape",124],"(",["T_VARIABLE","$json",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","fraudlabspro_message",124],")",["T_WHITESPACE"," ",124],".",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tfraudlabspro_credits = '\"",124],["T_WHITESPACE"," ",125],".",["T_WHITESPACE","  ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","db",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","escape",125],"(",["T_VARIABLE","$json",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","fraudlabspro_credits",125],")",["T_WHITESPACE"," ",125],".",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tapi_key = '\"",125],["T_WHITESPACE"," ",126],".",["T_WHITESPACE","  ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","config",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","get",126],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_key'",126],")",["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\tip_address = '\"",126],["T_WHITESPACE"," ",127],".",["T_WHITESPACE","  ",127],["T_VARIABLE","$ip",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","\"'\"",127],["T_WHITESPACE","\n\t\t\t",127],")",";",["T_WHITESPACE","\n\n\t\t\t",128],["T_VARIABLE","$risk_score",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_INT_CAST","(int)",130],["T_VARIABLE","$json",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","fraudlabspro_score",130],";",["T_WHITESPACE","\n\t\t",130],"}",["T_WHITESPACE","\n\n\t\t",131],["T_COMMENT","\/\/ Do not perform any action if error found\n",133],["T_WHITESPACE","\t\t",134],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$json",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","fraudlabspro_error_code",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n\t\t\t",134],["T_RETURN","return",135],";",["T_WHITESPACE","\n\t\t",135],"}",["T_WHITESPACE","\n\n\t\t",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$risk_score",138],["T_WHITESPACE"," ",138],">",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","config",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","get",138],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_score'",138],")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n\t\t\t",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","config",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","get",139],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_order_status_id'",139],")",";",["T_WHITESPACE","\n\t\t",139],"}",["T_WHITESPACE","\n\n\t\t",140],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$json",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","fraudlabspro_status",142],["T_WHITESPACE"," ",142],["T_IS_EQUAL","==",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'REVIEW'",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n\t\t\t",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","config",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","get",143],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_review_status_id'",143],")",";",["T_WHITESPACE","\n\t\t",143],"}",["T_WHITESPACE","\n\n\t\t",144],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$json",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","fraudlabspro_status",146],["T_WHITESPACE"," ",146],["T_IS_EQUAL","==",146],["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'APPROVE'",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n\t\t\t",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","config",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","get",147],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_approve_status_id'",147],")",";",["T_WHITESPACE","\n\t\t",147],"}",["T_WHITESPACE","\n\n\t\t",148],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$json",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","fraudlabspro_status",150],["T_WHITESPACE"," ",150],["T_IS_EQUAL","==",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'REJECT'",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n\t\t\t",150],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","config",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","get",151],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_reject_status_id'",151],")",";",["T_WHITESPACE","\n\t\t",151],"}",["T_WHITESPACE","\n\t",152],"}",["T_WHITESPACE","\n\n\t",153],["T_PRIVATE","private",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","hashIt",155],"(",["T_VARIABLE","$s",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n\t\t",155],["T_VARIABLE","$hash",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_'",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_VARIABLE","$s",156],";",["T_WHITESPACE","\n\n\t\t",156],["T_FOR","for",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$i",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_LNUMBER","0",158],";",["T_WHITESPACE"," ",158],["T_VARIABLE","$i",158],["T_WHITESPACE"," ",158],"<",["T_WHITESPACE"," ",158],["T_LNUMBER","65536",158],";",["T_WHITESPACE"," ",158],["T_VARIABLE","$i",158],["T_INC","++",158],")",["T_WHITESPACE","\n\t\t\t",158],["T_VARIABLE","$hash",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","sha1",159],"(",["T_CONSTANT_ENCAPSED_STRING","'fraudlabspro_'",159],["T_WHITESPACE"," ",159],".",["T_WHITESPACE"," ",159],["T_VARIABLE","$hash",159],")",";",["T_WHITESPACE","\n\n\t\t",159],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$hash",161],";",["T_WHITESPACE","\n\t",161],"}",["T_WHITESPACE","\n",162],"}"]