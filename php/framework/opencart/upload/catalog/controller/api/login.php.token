[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerApiLogin",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","index",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","load",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","language",4],"(",["T_CONSTANT_ENCAPSED_STRING","'api\/login'",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$json",6],["T_WHITESPACE"," ",6],"=",["T_WHITESPACE"," ",6],["T_ARRAY","array",6],"(",")",";",["T_WHITESPACE","\n\n\t\t",6],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","load",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","model",8],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/api'",8],")",";",["T_WHITESPACE","\n\n\t\t",8],["T_COMMENT","\/\/ Login with API Key\n",10],["T_WHITESPACE","\t\t",11],["T_VARIABLE","$api_info",11],["T_WHITESPACE"," ",11],"=",["T_WHITESPACE"," ",11],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","model_account_api",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","getApiByKey",11],"(",["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","request",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","post",11],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",11],"]",")",";",["T_WHITESPACE","\n\n\t\t",11],["T_IF","if",13],["T_WHITESPACE"," ",13],"(",["T_VARIABLE","$api_info",13],")",["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\t\t\t",13],["T_COMMENT","\/\/ Check if IP is allowed\n",14],["T_WHITESPACE","\t\t\t",15],["T_VARIABLE","$ip_data",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_ARRAY","array",15],"(",")",";",["T_WHITESPACE","\n\t\n\t\t\t",15],["T_VARIABLE","$results",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","model_account_api",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","getApiIps",17],"(",["T_VARIABLE","$api_info",17],"[",["T_CONSTANT_ENCAPSED_STRING","'api_id'",17],"]",")",";",["T_WHITESPACE","\n\t\n\t\t\t",17],["T_FOREACH","foreach",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$results",19],["T_WHITESPACE"," ",19],["T_AS","as",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$result",19],")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t\t\t",19],["T_VARIABLE","$ip_data",20],"[","]",["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_STRING","trim",20],"(",["T_VARIABLE","$result",20],"[",["T_CONSTANT_ENCAPSED_STRING","'ip'",20],"]",")",";",["T_WHITESPACE","\n\t\t\t",20],"}",["T_WHITESPACE","\n\t\n\t\t\t",21],["T_IF","if",23],["T_WHITESPACE"," ",23],"(","!",["T_STRING","in_array",23],"(",["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","request",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","server",23],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",23],"]",",",["T_WHITESPACE"," ",23],["T_VARIABLE","$ip_data",23],")",")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\t\t\t\t",23],["T_VARIABLE","$json",24],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",24],"]","[",["T_CONSTANT_ENCAPSED_STRING","'ip'",24],"]",["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","sprintf",24],"(",["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","language",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","get",24],"(",["T_CONSTANT_ENCAPSED_STRING","'error_ip'",24],")",",",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","request",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","server",24],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",24],"]",")",";",["T_WHITESPACE","\n\t\t\t",24],"}",["T_WHITESPACE","\t\t\t\t\n\t\t\t\t\n\t\t\t",25],["T_IF","if",27],["T_WHITESPACE"," ",27],"(","!",["T_VARIABLE","$json",27],")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n\t\t\t\t",27],["T_VARIABLE","$json",28],"[",["T_CONSTANT_ENCAPSED_STRING","'success'",28],"]",["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","language",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","get",28],"(",["T_CONSTANT_ENCAPSED_STRING","'text_success'",28],")",";",["T_WHITESPACE","\n\t\t\t\n\t\t\t\t",28],["T_COMMENT","\/\/ We want to create a seperate session so changes do not interfere with the admin user.\n",30],["T_WHITESPACE","\t\t\t\t",31],["T_VARIABLE","$session_id_old",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","session",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getId",31],"(",")",";",["T_WHITESPACE","\n\t\t\t\t\n\t\t\t\t",31],["T_VARIABLE","$session_id_new",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","session",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","createId",33],"(",")",";",["T_WHITESPACE","\n\t\t\t\t\n\t\t\t\t",33],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","session",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","start",35],"(",["T_CONSTANT_ENCAPSED_STRING","'api'",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$session_id_new",35],")",";",["T_WHITESPACE","\n\t\t\t\t\n\t\t\t\t",35],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","session",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","data",37],"[",["T_CONSTANT_ENCAPSED_STRING","'api_id'",37],"]",["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$api_info",37],"[",["T_CONSTANT_ENCAPSED_STRING","'api_id'",37],"]",";",["T_WHITESPACE","\n\t\t\t\t\n\t\t\t\t",37],["T_COMMENT","\/\/ Close and write the new session.\n",39],["T_WHITESPACE","\t\t\t\t",40],["T_COMMENT","\/\/$session->close();\n",40],["T_WHITESPACE","\n\t\t\t\t",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","session",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","start",42],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",42],")",";",["T_WHITESPACE","\n\n\t\t\t\t",42],["T_COMMENT","\/\/ Create Token\n",44],["T_WHITESPACE","\t\t\t\t",45],["T_VARIABLE","$json",45],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",45],"]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","model_account_api",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","addApiSession",45],"(",["T_VARIABLE","$api_info",45],"[",["T_CONSTANT_ENCAPSED_STRING","'api_id'",45],"]",",",["T_WHITESPACE"," ",45],["T_VARIABLE","$session_id_new",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","request",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","server",45],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",45],"]",")",";",["T_WHITESPACE","\n\t\t\t",45],"}",["T_WHITESPACE"," ",46],["T_ELSE","else",46],["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n\t\t\t\t",46],["T_VARIABLE","$json",47],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",47],"]","[",["T_CONSTANT_ENCAPSED_STRING","'key'",47],"]",["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","language",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","get",47],"(",["T_CONSTANT_ENCAPSED_STRING","'error_key'",47],")",";",["T_WHITESPACE","\n\t\t\t",47],"}",["T_WHITESPACE","\n\t\t",48],"}",["T_WHITESPACE","\n\n\t\t",49],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_ISSET","isset",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","request",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","server",51],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ORIGIN'",51],"]",")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n\t\t\t",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","response",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","addHeader",52],"(",["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin: '",52],["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","request",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","server",52],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ORIGIN'",52],"]",")",";",["T_WHITESPACE","\n\t\t\t",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","response",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","addHeader",53],"(",["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Methods: GET, PUT, POST, DELETE, OPTIONS'",53],")",";",["T_WHITESPACE","\n\t\t\t",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","response",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","addHeader",54],"(",["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Max-Age: 1000'",54],")",";",["T_WHITESPACE","\n\t\t\t",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","response",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","addHeader",55],"(",["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Headers: Content-Type, Authorization, X-Requested-With'",55],")",";",["T_WHITESPACE","\n\t\t",55],"}",["T_WHITESPACE","\n\n\t\t",56],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","response",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","addHeader",58],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",58],")",";",["T_WHITESPACE","\n\t\t",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","response",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","setOutput",59],"(",["T_STRING","json_encode",59],"(",["T_VARIABLE","$json",59],")",")",";",["T_WHITESPACE","\n\t",59],"}",["T_WHITESPACE","\n",60],"}",["T_WHITESPACE","\n",61]]