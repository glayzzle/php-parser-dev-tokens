[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionModulePPLogin",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PRIVATE","private",3],["T_WHITESPACE"," ",3],["T_VARIABLE","$error",3],["T_WHITESPACE"," ",3],"=",["T_WHITESPACE"," ",3],["T_ARRAY","array",3],"(",")",";",["T_WHITESPACE","\n\n\t",3],["T_PUBLIC","public",5],["T_WHITESPACE"," ",5],["T_FUNCTION","function",5],["T_WHITESPACE"," ",5],["T_STRING","index",5],"(",")",["T_WHITESPACE"," ",5],"{",["T_WHITESPACE","\n\t\t",5],["T_IF","if",6],["T_WHITESPACE"," ",6],"(","!",["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","customer",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","isLogged",6],"(",")",")",["T_WHITESPACE"," ",6],"{",["T_WHITESPACE","\n\t\t\t",6],["T_VARIABLE","$data",7],"[",["T_CONSTANT_ENCAPSED_STRING","'client_id'",7],"]",["T_WHITESPACE"," ",7],"=",["T_WHITESPACE"," ",7],["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","config",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","get",7],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_client_id'",7],")",";",["T_WHITESPACE","\n\t\t\t",7],["T_VARIABLE","$data",8],"[",["T_CONSTANT_ENCAPSED_STRING","'return_url'",8],"]",["T_WHITESPACE"," ",8],"=",["T_WHITESPACE"," ",8],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","url",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","link",8],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/module\/pp_login\/login'",8],",",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","''",8],",",["T_WHITESPACE"," ",8],["T_STRING","true",8],")",";",["T_WHITESPACE","\n\n\t\t\t",8],["T_IF","if",10],["T_WHITESPACE"," ",10],"(",["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","config",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","get",10],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_sandbox'",10],")",")",["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\t\t\t\t",10],["T_VARIABLE","$data",11],"[",["T_CONSTANT_ENCAPSED_STRING","'sandbox'",11],"]",["T_WHITESPACE"," ",11],"=",["T_WHITESPACE"," ",11],["T_CONSTANT_ENCAPSED_STRING","'sandbox'",11],";",["T_WHITESPACE","\n\t\t\t",11],"}",["T_WHITESPACE"," ",12],["T_ELSE","else",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\t\t\t\t",12],["T_VARIABLE","$data",13],"[",["T_CONSTANT_ENCAPSED_STRING","'sandbox'",13],"]",["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","''",13],";",["T_WHITESPACE","\n\t\t\t",13],"}",["T_WHITESPACE","\n\n\t\t\t",14],["T_IF","if",16],["T_WHITESPACE"," ",16],"(",["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","config",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","get",16],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_button_colour'",16],")",["T_WHITESPACE"," ",16],["T_IS_EQUAL","==",16],["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'grey'",16],")",["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\t\t\t\t",16],["T_VARIABLE","$data",17],"[",["T_CONSTANT_ENCAPSED_STRING","'button_colour'",17],"]",["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'neutral'",17],";",["T_WHITESPACE","\n\t\t\t",17],"}",["T_WHITESPACE"," ",18],["T_ELSE","else",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\t\t\t\t",18],["T_VARIABLE","$data",19],"[",["T_CONSTANT_ENCAPSED_STRING","'button_colour'",19],"]",["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","''",19],";",["T_WHITESPACE","\n\t\t\t",19],"}",["T_WHITESPACE","\n\n\t\t\t",20],["T_VARIABLE","$locale",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","config",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","get",22],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_locale'",22],")",";",["T_WHITESPACE","\n\n\t\t\t",22],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","load",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","model",24],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/language'",24],")",";",["T_WHITESPACE","\n\n\t\t\t",24],["T_VARIABLE","$languages",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","model_localisation_language",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","getLanguages",26],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",26],["T_FOREACH","foreach",28],["T_WHITESPACE"," ",28],"(",["T_VARIABLE","$languages",28],["T_WHITESPACE"," ",28],["T_AS","as",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$language",28],")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n\t\t\t\t",28],["T_IF","if",29],["T_WHITESPACE"," ",29],"(",["T_VARIABLE","$language",29],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",29],"]",["T_WHITESPACE"," ",29],["T_BOOLEAN_AND","&&",29],["T_WHITESPACE"," ",29],"(",["T_VARIABLE","$language",29],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",29],"]",["T_WHITESPACE"," ",29],["T_IS_EQUAL","==",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","session",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","data",29],"[",["T_CONSTANT_ENCAPSED_STRING","'language'",29],"]",")",["T_WHITESPACE"," ",29],["T_BOOLEAN_AND","&&",29],["T_WHITESPACE"," ",29],["T_ISSET","isset",29],"(",["T_VARIABLE","$locale",29],"[",["T_VARIABLE","$language",29],"[",["T_CONSTANT_ENCAPSED_STRING","'language_id'",29],"]","]",")",")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n\t\t\t\t\t",29],["T_VARIABLE","$data",30],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",30],"]",["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$locale",30],"[",["T_VARIABLE","$language",30],"[",["T_CONSTANT_ENCAPSED_STRING","'language_id'",30],"]","]",";",["T_WHITESPACE","\n\t\t\t\t",30],"}",["T_WHITESPACE","\n\t\t\t",31],"}",["T_WHITESPACE","\n\n\t\t\t",32],["T_IF","if",34],["T_WHITESPACE"," ",34],"(","!",["T_ISSET","isset",34],"(",["T_VARIABLE","$data",34],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",34],"]",")",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n\t\t\t\t",34],["T_VARIABLE","$data",35],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",35],"]",["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'en-gb'",35],";",["T_WHITESPACE","\n\t\t\t",35],"}",["T_WHITESPACE","\n\n\t\t\t",36],["T_VARIABLE","$scopes",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_WHITESPACE","\n\t\t\t\t",38],["T_CONSTANT_ENCAPSED_STRING","'profile'",39],",",["T_WHITESPACE","\n\t\t\t\t",39],["T_CONSTANT_ENCAPSED_STRING","'email'",40],",",["T_WHITESPACE","\n\t\t\t\t",40],["T_CONSTANT_ENCAPSED_STRING","'address'",41],",",["T_WHITESPACE","\n\t\t\t\t",41],["T_CONSTANT_ENCAPSED_STRING","'phone'",42],["T_WHITESPACE","\n\t\t\t",42],")",";",["T_WHITESPACE","\n\n\t\t\t",43],["T_IF","if",45],["T_WHITESPACE"," ",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","config",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","get",45],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_seamless'",45],")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n\t\t\t\t",45],["T_VARIABLE","$scopes",46],"[","]",["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/uri.paypal.com\/services\/expresscheckout'",46],";",["T_WHITESPACE","\n\t\t\t",46],"}",["T_WHITESPACE","\n\n\t\t\t",47],["T_VARIABLE","$data",49],"[",["T_CONSTANT_ENCAPSED_STRING","'scopes'",49],"]",["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","implode",49],"(",["T_CONSTANT_ENCAPSED_STRING","' '",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$scopes",49],")",";",["T_WHITESPACE","\n\n\t\t\t",49],["T_RETURN","return",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","load",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","view",51],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/module\/pp_login'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$data",51],")",";",["T_WHITESPACE","\n\t\t",51],"}",["T_WHITESPACE","\n\t",52],"}",["T_WHITESPACE","\n\n\t",53],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","login",55],"(",")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n\t\t",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","load",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","model",56],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/module\/pp_login'",56],")",";",["T_WHITESPACE","\n\t\t",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","load",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","model",57],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/customer'",57],")",";",["T_WHITESPACE","\n\t\t",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","load",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","model",58],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/customer_group'",58],")",";",["T_WHITESPACE","\n\n\t\t",58],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","customer",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","isLogged",60],"(",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n\t\t\t",60],["T_ECHO","echo",61],["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'<script type=\"text\/javascript\">window.opener.location = \"'",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","url",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","link",61],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/account'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","''",61],",",["T_WHITESPACE"," ",61],["T_STRING","true",61],")",["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'\"; window.close();<\/script>'",61],";",["T_WHITESPACE","\n\t\t",61],"}",["T_WHITESPACE","\n\n\t\t",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_ISSET","isset",64],"(",["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","request",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","get",64],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",64],"]",")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n\t\t\t",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_ISSET","isset",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","request",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","get",65],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",65],"]",")",["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],["T_ISSET","isset",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","request",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","get",65],"[",["T_CONSTANT_ENCAPSED_STRING","'error_description'",65],"]",")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t\t\t",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","model_extension_module_pp_login",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","log",66],"(",["T_CONSTANT_ENCAPSED_STRING","'No code returned. Error: '",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","request",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","get",66],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",66],"]",["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","', Error Description: '",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","request",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","get",66],"[",["T_CONSTANT_ENCAPSED_STRING","'error_description'",66],"]",")",";",["T_WHITESPACE","\n\t\t\t",66],"}",["T_WHITESPACE","\n\n\t\t\t",67],["T_ECHO","echo",69],["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'<script type=\"text\/javascript\">window.opener.location = \"'",69],["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","url",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","link",69],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/login'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","''",69],",",["T_WHITESPACE"," ",69],["T_STRING","true",69],")",["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'\"; window.close();<\/script>'",69],";",["T_WHITESPACE","\n\t\t",69],"}",["T_WHITESPACE"," ",70],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n\t\t\t",70],["T_VARIABLE","$tokens",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","model_extension_module_pp_login",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getTokens",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","request",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","get",71],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",71],"]",")",";",["T_WHITESPACE","\n\t\t",71],"}",["T_WHITESPACE","\n\n\t\t",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_ISSET","isset",74],"(",["T_VARIABLE","$tokens",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","access_token",74],")",["T_WHITESPACE"," ",74],["T_BOOLEAN_AND","&&",74],["T_WHITESPACE"," ",74],"!",["T_ISSET","isset",74],"(",["T_VARIABLE","$tokens",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","error",74],")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$user",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","model_extension_module_pp_login",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getUserInfo",75],"(",["T_VARIABLE","$tokens",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","access_token",75],")",";",["T_WHITESPACE","\n\t\t",75],"}",["T_WHITESPACE","\n\n\t\t",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_ISSET","isset",78],"(",["T_VARIABLE","$user",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t\t",78],["T_VARIABLE","$customer_info",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","model_account_customer",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getCustomerByEmail",79],"(",["T_VARIABLE","$user",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","email",79],")",";",["T_WHITESPACE","\n\n\t\t\t",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$customer_info",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n\t\t\t\t",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","validate",82],"(",["T_VARIABLE","$user",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","email",82],")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n\t\t\t\t\t",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","completeLogin",83],"(",["T_VARIABLE","$customer_info",83],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",83],"]",",",["T_WHITESPACE"," ",83],["T_VARIABLE","$customer_info",83],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",83],"]",",",["T_WHITESPACE"," ",83],["T_VARIABLE","$tokens",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","access_token",83],")",";",["T_WHITESPACE","\n\t\t\t\t",83],"}",["T_WHITESPACE"," ",84],["T_ELSE","else",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n\t\t\t\t\t",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","model_extension_module_pp_login",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","log",85],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not login to - ID: '",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_VARIABLE","$customer_info",85],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",85],"]",["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","', Email: '",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_VARIABLE","$customer_info",85],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",85],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",85],["T_ECHO","echo",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'<script type=\"text\/javascript\">window.opener.location = \"'",86],["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","url",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","link",86],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/login'",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","''",86],",",["T_WHITESPACE"," ",86],["T_STRING","true",86],")",["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'\"; window.close();<\/script>'",86],";",["T_WHITESPACE","\n\t\t\t\t",86],"}",["T_WHITESPACE","\n\t\t\t",87],"}",["T_WHITESPACE"," ",88],["T_ELSE","else",88],["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n\t\t\t\t",88],["T_VARIABLE","$country",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","db",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","query",89],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `country_id` FROM `\"",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_STRING","DB_PREFIX",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","\"country` WHERE iso_code_2 = '\"",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","db",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","escape",89],"(",["T_VARIABLE","$user",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","address",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","country",89],")",["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","\"'\"",89],")",";",["T_WHITESPACE","\n\n\t\t\t\t",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$country",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","num_rows",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t\t\t",91],["T_VARIABLE","$country_id",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$country",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","row",92],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",92],"]",";",["T_WHITESPACE","\n\n\t\t\t\t\t",92],["T_VARIABLE","$zone",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","db",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","query",94],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `zone_id` FROM `\"",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_STRING","DB_PREFIX",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","\"zone` WHERE country_id = '\"",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_INT_CAST","(int)",94],["T_VARIABLE","$country_id",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","\"' AND name = '\"",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","db",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","escape",94],"(",["T_VARIABLE","$user",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","address",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","region",94],")",["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","\"'\"",94],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",94],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$zone",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","num_rows",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",96],["T_VARIABLE","$zone_id",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$zone",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","row",97],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",97],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",97],"}",["T_WHITESPACE"," ",98],["T_ELSE","else",98],["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",98],["T_VARIABLE","$zone_id",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_LNUMBER","0",99],";",["T_WHITESPACE","\n\t\t\t\t\t",99],"}",["T_WHITESPACE","\n\t\t\t\t",100],"}",["T_WHITESPACE"," ",101],["T_ELSE","else",101],["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n\t\t\t\t\t",101],["T_VARIABLE","$country_id",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_LNUMBER","0",102],";",["T_WHITESPACE","\n\t\t\t\t\t",102],["T_VARIABLE","$zone_id",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_LNUMBER","0",103],";",["T_WHITESPACE","\n\t\t\t\t",103],"}",["T_WHITESPACE","\n\n\t\t\t\t",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","config",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","get",106],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_customer_group_id'",106],")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n\t\t\t\t\t",106],["T_VARIABLE","$customer_group_id",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","config",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","get",107],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_customer_group_id'",107],")",";",["T_WHITESPACE","\n\t\t\t\t",107],"}",["T_WHITESPACE"," ",108],["T_ELSE","else",108],["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n\t\t\t\t\t",108],["T_VARIABLE","$customer_group_id",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","config",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","get",109],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_group_id'",109],")",";",["T_WHITESPACE","\n\t\t\t\t",109],"}",["T_WHITESPACE","\n\n\t\t\t\t",110],["T_VARIABLE","$data",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],"(",["T_WHITESPACE","\n\t\t\t\t\t",112],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_INT_CAST","(int)",113],["T_VARIABLE","$customer_group_id",113],",",["T_WHITESPACE","\n\t\t\t\t\t",113],["T_CONSTANT_ENCAPSED_STRING","'firstname'",114],["T_WHITESPACE","         ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$user",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","given_name",114],",",["T_WHITESPACE","\n\t\t\t\t\t",114],["T_CONSTANT_ENCAPSED_STRING","'lastname'",115],["T_WHITESPACE","          ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$user",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","family_name",115],",",["T_WHITESPACE","\n\t\t\t\t\t",115],["T_CONSTANT_ENCAPSED_STRING","'email'",116],["T_WHITESPACE","             ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$user",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","email",116],",",["T_WHITESPACE","\n\t\t\t\t\t",116],["T_CONSTANT_ENCAPSED_STRING","'telephone'",117],["T_WHITESPACE","         ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$user",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","phone_number",117],",",["T_WHITESPACE","\n\t\t\t\t\t",117],["T_CONSTANT_ENCAPSED_STRING","'fax'",118],["T_WHITESPACE","               ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","''",118],",",["T_WHITESPACE","\n\t\t\t\t\t",118],["T_CONSTANT_ENCAPSED_STRING","'password'",119],["T_WHITESPACE","          ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_STRING","uniqid",119],"(",["T_STRING","rand",119],"(",")",",",["T_WHITESPACE"," ",119],["T_STRING","true",119],")",",",["T_WHITESPACE","\n\t\t\t\t\t",119],["T_CONSTANT_ENCAPSED_STRING","'company'",120],["T_WHITESPACE","           ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","''",120],",",["T_WHITESPACE","\n\t\t\t\t\t",120],["T_CONSTANT_ENCAPSED_STRING","'address_1'",121],["T_WHITESPACE","         ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$user",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","address",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","street_address",121],",",["T_WHITESPACE","\n\t\t\t\t\t",121],["T_CONSTANT_ENCAPSED_STRING","'address_2'",122],["T_WHITESPACE","         ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","''",122],",",["T_WHITESPACE","\n\t\t\t\t\t",122],["T_CONSTANT_ENCAPSED_STRING","'city'",123],["T_WHITESPACE","              ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$user",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","address",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","locality",123],",",["T_WHITESPACE","\n\t\t\t\t\t",123],["T_CONSTANT_ENCAPSED_STRING","'postcode'",124],["T_WHITESPACE","          ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$user",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","address",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","postal_code",124],",",["T_WHITESPACE","\n\t\t\t\t\t",124],["T_CONSTANT_ENCAPSED_STRING","'country_id'",125],["T_WHITESPACE","        ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_INT_CAST","(int)",125],["T_VARIABLE","$country_id",125],",",["T_WHITESPACE","\n\t\t\t\t\t",125],["T_CONSTANT_ENCAPSED_STRING","'zone_id'",126],["T_WHITESPACE","           ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_INT_CAST","(int)",126],["T_VARIABLE","$zone_id",126],",",["T_WHITESPACE","\n\t\t\t\t",126],")",";",["T_WHITESPACE","\n\n\t\t\t\t",127],["T_VARIABLE","$customer_id",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","model_account_customer",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","addCustomer",129],"(",["T_VARIABLE","$data",129],")",";",["T_WHITESPACE","\n\n\t\t\t\t",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","model_extension_module_pp_login",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","log",131],"(",["T_CONSTANT_ENCAPSED_STRING","'Customer ID date_added: '",131],["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_VARIABLE","$customer_id",131],")",";",["T_WHITESPACE","\n\n\t\t\t\t",131],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","validate",133],"(",["T_VARIABLE","$user",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","email",133],")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n\t\t\t\t\t",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","completeLogin",134],"(",["T_VARIABLE","$customer_id",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$user",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","email",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$tokens",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","access_token",134],")",";",["T_WHITESPACE","\n\t\t\t\t",134],"}",["T_WHITESPACE"," ",135],["T_ELSE","else",135],["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n\t\t\t\t\t",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","model_extension_module_pp_login",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","log",136],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not login to - ID: '",136],["T_WHITESPACE"," ",136],".",["T_WHITESPACE"," ",136],["T_VARIABLE","$customer_id",136],["T_WHITESPACE"," ",136],".",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","', Email: '",136],["T_WHITESPACE"," ",136],".",["T_WHITESPACE"," ",136],["T_VARIABLE","$user",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","email",136],")",";",["T_WHITESPACE","\n\t\t\t\t\t",136],["T_ECHO","echo",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'<script type=\"text\/javascript\">window.opener.location = \"'",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","url",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","link",137],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/login'",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","''",137],",",["T_WHITESPACE"," ",137],["T_STRING","true",137],")",["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'\"; window.close();<\/script>'",137],";",["T_WHITESPACE","\n\t\t\t\t",137],"}",["T_WHITESPACE","\n\t\t\t",138],"}",["T_WHITESPACE","\n\t\t",139],"}",["T_WHITESPACE","\n\t",140],"}",["T_WHITESPACE","\n\n\t",141],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","logout",143],"(",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_ISSET","isset",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","session",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","data",144],"[",["T_CONSTANT_ENCAPSED_STRING","'pp_login'",144],"]",")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n\t\t\t",144],["T_UNSET","unset",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","session",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","data",145],"[",["T_CONSTANT_ENCAPSED_STRING","'pp_login'",145],"]",")",";",["T_WHITESPACE","\n\t\t",145],"}",["T_WHITESPACE","\n\t",146],"}",["T_WHITESPACE","\n\n\t",147],["T_PROTECTED","protected",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","completeLogin",149],"(",["T_VARIABLE","$customer_id",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$email",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$access_token",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n\t\t",149],["T_UNSET","unset",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","session",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","data",150],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",150],"]",")",";",["T_WHITESPACE","\n\n\t\t",150],["T_COMMENT","\/\/ Default Shipping Address\n",152],["T_WHITESPACE","\t\t",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","load",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","model",153],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/address'",153],")",";",["T_WHITESPACE","\n\n\t\t",153],["T_IF","if",155],["T_WHITESPACE"," ",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","config",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","get",155],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax_customer'",155],")",["T_WHITESPACE"," ",155],["T_IS_EQUAL","==",155],["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'payment'",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n\t\t\t",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","session",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","data",156],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",156],"]",["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","model_account_address",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getAddress",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","customer",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getAddressId",156],"(",")",")",";",["T_WHITESPACE","\n\t\t",156],"}",["T_WHITESPACE","\n\n\t\t",157],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","config",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","get",159],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax_customer'",159],")",["T_WHITESPACE"," ",159],["T_IS_EQUAL","==",159],["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'shipping'",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n\t\t\t",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","session",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","data",160],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",160],"]",["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","model_account_address",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getAddress",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","customer",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getAddressId",160],"(",")",")",";",["T_WHITESPACE","\n\t\t",160],"}",["T_WHITESPACE","\n\n\t\t",161],["T_COMMENT","\/\/ Add to activity log\n",163],["T_WHITESPACE","\t\t",164],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","config",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","get",164],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_activity'",164],")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n\t\t\t",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","load",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","model",165],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/activity'",165],")",";",["T_WHITESPACE","\n\n\t\t\t",165],["T_VARIABLE","$activity_data",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_WHITESPACE","\n\t\t\t\t",167],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","customer",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getId",168],"(",")",",",["T_WHITESPACE","\n\t\t\t\t",168],["T_CONSTANT_ENCAPSED_STRING","'name'",169],["T_WHITESPACE","        ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","customer",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getFirstName",169],"(",")",["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","' '",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","customer",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getLastName",169],"(",")",["T_WHITESPACE","\n\t\t\t",169],")",";",["T_WHITESPACE","\n\n\t\t\t",170],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","model_account_activity",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","addActivity",172],"(",["T_CONSTANT_ENCAPSED_STRING","'login'",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$activity_data",172],")",";",["T_WHITESPACE","\n\t\t",172],"}",["T_WHITESPACE","\n\n\t\t",173],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","config",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","get",175],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_login_seamless'",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n\t\t\t",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","session",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","data",176],"[",["T_CONSTANT_ENCAPSED_STRING","'pp_login'",176],"]","[",["T_CONSTANT_ENCAPSED_STRING","'seamless'",176],"]","[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",176],"]",["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","customer",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getId",176],"(",")",";",["T_WHITESPACE","\n\t\t\t",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","session",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","data",177],"[",["T_CONSTANT_ENCAPSED_STRING","'pp_login'",177],"]","[",["T_CONSTANT_ENCAPSED_STRING","'seamless'",177],"]","[",["T_CONSTANT_ENCAPSED_STRING","'access_token'",177],"]",["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$access_token",177],";",["T_WHITESPACE","\n\t\t",177],"}",["T_WHITESPACE"," ",178],["T_ELSE","else",178],["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n\t\t\t",178],["T_IF","if",179],["T_WHITESPACE"," ",179],"(",["T_ISSET","isset",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","session",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","data",179],"[",["T_CONSTANT_ENCAPSED_STRING","'pp_login'",179],"]","[",["T_CONSTANT_ENCAPSED_STRING","'seamless'",179],"]",")",")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n\t\t\t\t",179],["T_UNSET","unset",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","session",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","data",180],"[",["T_CONSTANT_ENCAPSED_STRING","'pp_login'",180],"]","[",["T_CONSTANT_ENCAPSED_STRING","'seamless'",180],"]",")",";",["T_WHITESPACE","\n\t\t\t",180],"}",["T_WHITESPACE","\n\t\t",181],"}",["T_WHITESPACE","\n\n\t\t",182],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","model_extension_module_pp_login",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","log",184],"(",["T_CONSTANT_ENCAPSED_STRING","'Customer logged in - ID: '",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_VARIABLE","$customer_id",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","', Email: '",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_VARIABLE","$email",184],")",";",["T_WHITESPACE","\n\t\t",184],["T_ECHO","echo",185],["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'<script type=\"text\/javascript\">window.opener.location = \"'",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","url",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","link",185],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/account'",185],",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","''",185],",",["T_WHITESPACE"," ",185],["T_STRING","true",185],")",["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'\"; window.close();<\/script>'",185],";",["T_WHITESPACE","\n\t",185],"}",["T_WHITESPACE","\n\n\t",186],["T_PROTECTED","protected",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","validate",188],"(",["T_VARIABLE","$email",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n\t\t",188],["T_COMMENT","\/\/ Check how many login attempts have been made.\n",189],["T_WHITESPACE","\t\t",190],["T_VARIABLE","$login_info",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","model_account_customer",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getLoginAttempts",190],"(",["T_VARIABLE","$email",190],")",";",["T_WHITESPACE","\n\n\t\t",190],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$login_info",192],["T_WHITESPACE"," ",192],["T_BOOLEAN_AND","&&",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$login_info",192],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",192],"]",["T_WHITESPACE"," ",192],["T_IS_GREATER_OR_EQUAL",">=",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","config",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","get",192],"(",["T_CONSTANT_ENCAPSED_STRING","'config_login_attempts'",192],")",")",["T_WHITESPACE"," ",192],["T_BOOLEAN_AND","&&",192],["T_WHITESPACE"," ",192],["T_STRING","strtotime",192],"(",["T_CONSTANT_ENCAPSED_STRING","'-1 hour'",192],")",["T_WHITESPACE"," ",192],"<",["T_WHITESPACE"," ",192],["T_STRING","strtotime",192],"(",["T_VARIABLE","$login_info",192],"[",["T_CONSTANT_ENCAPSED_STRING","'date_modified'",192],"]",")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n\t\t\t",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","error",193],"[",["T_CONSTANT_ENCAPSED_STRING","'warning'",193],"]",["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","language",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","get",193],"(",["T_CONSTANT_ENCAPSED_STRING","'error_attempts'",193],")",";",["T_WHITESPACE","\n\t\t",193],"}",["T_WHITESPACE","\n\n\t\t",194],["T_COMMENT","\/\/ Check if customer has been approved.\n",196],["T_WHITESPACE","\t\t",197],["T_VARIABLE","$customer_info",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","model_account_customer",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getCustomerByEmail",197],"(",["T_VARIABLE","$email",197],")",";",["T_WHITESPACE","\n\n\t\t",197],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$customer_info",199],["T_WHITESPACE"," ",199],["T_BOOLEAN_AND","&&",199],["T_WHITESPACE"," ",199],"!",["T_VARIABLE","$customer_info",199],"[",["T_CONSTANT_ENCAPSED_STRING","'approved'",199],"]",")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n\t\t\t",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","error",200],"[",["T_CONSTANT_ENCAPSED_STRING","'warning'",200],"]",["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","language",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","get",200],"(",["T_CONSTANT_ENCAPSED_STRING","'error_approved'",200],")",";",["T_WHITESPACE","\n\t\t",200],"}",["T_WHITESPACE","\n\n\t\t",201],["T_IF","if",203],["T_WHITESPACE"," ",203],"(","!",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","error",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n\t\t\t",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(","!",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","customer",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","login",204],"(",["T_VARIABLE","$email",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","''",204],",",["T_WHITESPACE"," ",204],["T_STRING","true",204],")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n\t\t\t\t",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","error",205],"[",["T_CONSTANT_ENCAPSED_STRING","'warning'",205],"]",["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","language",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","get",205],"(",["T_CONSTANT_ENCAPSED_STRING","'error_login'",205],")",";",["T_WHITESPACE","\n\n\t\t\t\t",205],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","model_account_customer",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","addLoginAttempt",207],"(",["T_VARIABLE","$email",207],")",";",["T_WHITESPACE","\n\t\t\t",207],"}",["T_WHITESPACE"," ",208],["T_ELSE","else",208],["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n\t\t\t\t",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","model_account_customer",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","deleteLoginAttempts",209],"(",["T_VARIABLE","$email",209],")",";",["T_WHITESPACE","\n\t\t\t",209],"}",["T_WHITESPACE","\n\t\t",210],"}",["T_WHITESPACE","\n\n\t\t",211],["T_RETURN","return",213],["T_WHITESPACE"," ",213],"!",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","error",213],";",["T_WHITESPACE","\n\t",213],"}",["T_WHITESPACE","\n",214],"}"]