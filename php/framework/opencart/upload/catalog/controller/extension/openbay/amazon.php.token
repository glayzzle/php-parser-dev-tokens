[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionOpenbayAmazon",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","order",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_IF","if",4],["T_WHITESPACE"," ",4],"(",["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","config",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","get",4],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_status'",4],")",["T_WHITESPACE"," ",4],["T_IS_NOT_EQUAL","!=",4],["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","'1'",4],")",["T_WHITESPACE"," ",4],"{",["T_WHITESPACE","\n\t\t\t",4],["T_RETURN","return",5],";",["T_WHITESPACE","\n\t\t",5],"}",["T_WHITESPACE","\n\n\t\t",6],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","load",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","model",8],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",8],")",";",["T_WHITESPACE","\n\t\t",8],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","load",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","model",9],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_order'",9],")",";",["T_WHITESPACE","\n\t\t",9],["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","load",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","language",10],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_order'",10],")",";",["T_WHITESPACE","\n\n\t\t",10],["T_VARIABLE","$logger",12],["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_NEW","new",12],["T_WHITESPACE"," ",12],["T_STRING","Log",12],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon.log'",12],")",";",["T_WHITESPACE","\n\t\t",12],["T_VARIABLE","$logger",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","write",13],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/order - started'",13],")",";",["T_WHITESPACE","\n\n\t\t",13],["T_VARIABLE","$incoming_token",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_ISSET","isset",15],"(",["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","request",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","post",15],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",15],"]",")",["T_WHITESPACE"," ",15],"?",["T_WHITESPACE"," ",15],["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","request",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","post",15],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",15],"]",["T_WHITESPACE"," ",15],":",["T_WHITESPACE"," ",15],["T_CONSTANT_ENCAPSED_STRING","''",15],";",["T_WHITESPACE","\n\n\t\t",15],["T_IF","if",17],["T_WHITESPACE"," ",17],"(","!",["T_STRING","hash_equals",17],"(",["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","config",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","get",17],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_token'",17],")",",",["T_WHITESPACE"," ",17],["T_VARIABLE","$incoming_token",17],")",")",["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\t\t\t",17],["T_VARIABLE","$logger",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","write",18],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/order - Incorrect token: '",18],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_VARIABLE","$incoming_token",18],")",";",["T_WHITESPACE","\n\t\t\t",18],["T_RETURN","return",19],";",["T_WHITESPACE","\n\t\t",19],"}",["T_WHITESPACE","\n\n\t\t",20],["T_VARIABLE","$decrypted",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","openbay",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","amazon",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","decryptArgs",22],"(",["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","request",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","post",22],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",22],"]",")",";",["T_WHITESPACE","\n\n\t\t",22],["T_IF","if",24],["T_WHITESPACE"," ",24],"(","!",["T_VARIABLE","$decrypted",24],")",["T_WHITESPACE"," ",24],"{",["T_WHITESPACE","\n\t\t\t",24],["T_VARIABLE","$logger",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","write",25],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/order Failed to decrypt data'",25],")",";",["T_WHITESPACE","\n\t\t\t",25],["T_RETURN","return",26],";",["T_WHITESPACE","\n\t\t",26],"}",["T_WHITESPACE","\n\n\t\t",27],["T_VARIABLE","$order_xml",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_STRING","simplexml_load_string",29],"(",["T_VARIABLE","$decrypted",29],")",";",["T_WHITESPACE","\n\n\t\t",29],["T_VARIABLE","$amazon_order_status",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","trim",31],"(",["T_STRING","strtolower",31],"(",["T_STRING_CAST","(string)",31],["T_VARIABLE","$order_xml",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","Status",31],")",")",";",["T_WHITESPACE","\n\n\t\t",31],["T_VARIABLE","$amazon_order_id",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING_CAST","(string)",33],["T_VARIABLE","$order_xml",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","AmazonOrderId",33],";",["T_WHITESPACE","\n\t\t",33],["T_VARIABLE","$order_status",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","model_extension_openbay_amazon_order",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getMappedStatus",34],"(",["T_STRING_CAST","(string)",34],["T_VARIABLE","$order_xml",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","Status",34],")",";",["T_WHITESPACE","\n\n\t\t",34],["T_VARIABLE","$logger",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","write",36],"(",["T_CONSTANT_ENCAPSED_STRING","'Received order '",36],["T_WHITESPACE"," ",36],".",["T_WHITESPACE"," ",36],["T_VARIABLE","$amazon_order_id",36],")",";",["T_WHITESPACE","\n\n\t\t",36],["T_VARIABLE","$order_id",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","model_extension_openbay_amazon_order",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getOrderId",38],"(",["T_VARIABLE","$amazon_order_id",38],")",";",["T_WHITESPACE","\n\n\t\t",38],["T_COMMENT","\/\/ If the order already exists on opencart, ignore it.\n",40],["T_WHITESPACE","\t\t",41],["T_IF","if",41],["T_WHITESPACE"," ",41],"(",["T_VARIABLE","$order_id",41],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n\t\t\t",41],["T_VARIABLE","$logger",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","write",42],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Duplicate order ",42],["T_VARIABLE","$amazon_order_id",42],["T_ENCAPSED_AND_WHITESPACE",". Terminating.",42],"\"",")",";",["T_WHITESPACE","\n\t\t\t",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","response",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","setOutput",43],"(",["T_CONSTANT_ENCAPSED_STRING","'Ok'",43],")",";",["T_WHITESPACE","\n\t\t\t",43],["T_RETURN","return",44],";",["T_WHITESPACE","\n\t\t",44],"}",["T_WHITESPACE","\n\n\t\t",45],["T_COMMENT","\/* Check if order comes from subscribed marketplace *\/",47],["T_WHITESPACE","\n\n\t\t",47],["T_VARIABLE","$currency_to",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","config",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_CONSTANT_ENCAPSED_STRING","'config_currency'",49],")",";",["T_WHITESPACE","\n\t\t",49],["T_VARIABLE","$order_currency",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING_CAST","(string)",50],["T_VARIABLE","$order_xml",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","Payment",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","CurrencyCode",50],";",["T_WHITESPACE","\n\n\t\t",50],["T_VARIABLE","$products",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_ARRAY","array",52],"(",")",";",["T_WHITESPACE","\n\n\t\t",52],["T_VARIABLE","$products_total",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_LNUMBER","0",54],";",["T_WHITESPACE","\n\t\t",54],["T_VARIABLE","$products_shipping",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_LNUMBER","0",55],";",["T_WHITESPACE","\n\t\t",55],["T_VARIABLE","$products_tax",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_LNUMBER","0",56],";",["T_WHITESPACE","\n\t\t",56],["T_VARIABLE","$products_shipping_tax",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","0",57],";",["T_WHITESPACE","\n\t\t",57],["T_VARIABLE","$gift_wrap",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_LNUMBER","0",58],";",["T_WHITESPACE","\n\t\t",58],["T_VARIABLE","$gift_wrap_tax",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_LNUMBER","0",59],";",["T_WHITESPACE","\n\n\t\t",59],["T_VARIABLE","$product_count",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_LNUMBER","0",61],";",["T_WHITESPACE","\n\n\t\t",61],["T_VARIABLE","$amazon_order_id",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING_CAST","(string)",63],["T_VARIABLE","$order_xml",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","AmazonOrderId",63],";",["T_WHITESPACE","\n\n\t\t",63],["T_COMMENT","\/* SKU => ORDER_ITEM_ID *\/",65],["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$product_mapping",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_ARRAY","array",66],"(",")",";",["T_WHITESPACE","\n\n\t\t",66],["T_FOREACH","foreach",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$order_xml",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","Items",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","Item",68],["T_WHITESPACE"," ",68],["T_AS","as",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$item",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n\n\t\t\t",68],["T_VARIABLE","$total_price",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","currency",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","convert",70],"(",["T_DOUBLE_CAST","(double)",70],["T_VARIABLE","$item",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","Totals",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","Price",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$order_currency",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$currency_to",70],")",";",["T_WHITESPACE","\n\t\t\t",70],["T_VARIABLE","$tax_total",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_DOUBLE_CAST","(double)",71],["T_VARIABLE","$item",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","Totals",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","Tax",71],";",["T_WHITESPACE","\n\n\t\t\t",71],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$tax_total",73],["T_WHITESPACE"," ",73],["T_IS_EQUAL","==",73],["T_WHITESPACE"," ",73],["T_LNUMBER","0",73],["T_WHITESPACE"," ",73],["T_BOOLEAN_AND","&&",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","config",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","get",73],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",73],")",["T_WHITESPACE"," ",73],">",["T_WHITESPACE"," ",73],["T_LNUMBER","0",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n\t\t\t\t",73],["T_VARIABLE","$tax_total",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_DOUBLE_CAST","(double)",74],["T_VARIABLE","$item",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","Totals",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","Price",74],["T_WHITESPACE"," ",74],"*",["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","config",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","get",74],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",74],")",["T_WHITESPACE"," ",74],"\/",["T_WHITESPACE"," ",74],["T_LNUMBER","100",74],")",["T_WHITESPACE"," ",74],"\/",["T_WHITESPACE"," ",74],"(",["T_LNUMBER","1",74],["T_WHITESPACE"," ",74],"+",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","config",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","get",74],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",74],")",["T_WHITESPACE"," ",74],"\/",["T_WHITESPACE"," ",74],["T_LNUMBER","100",74],")",";",["T_WHITESPACE","\n\t\t\t",74],"}",["T_WHITESPACE","\n\n\t\t\t",75],["T_VARIABLE","$tax_total",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","currency",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","convert",77],"(",["T_VARIABLE","$tax_total",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$order_currency",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$currency_to",77],")",";",["T_WHITESPACE","\n\n\t\t\t",77],["T_VARIABLE","$products_total",79],["T_WHITESPACE"," ",79],["T_PLUS_EQUAL","+=",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$total_price",79],";",["T_WHITESPACE","\n\t\t\t",79],["T_VARIABLE","$products_tax",80],["T_WHITESPACE"," ",80],["T_PLUS_EQUAL","+=",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$tax_total",80],";",["T_WHITESPACE","\n\n\t\t\t",80],["T_VARIABLE","$products_shipping",82],["T_WHITESPACE"," ",82],["T_PLUS_EQUAL","+=",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","currency",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","convert",82],"(",["T_DOUBLE_CAST","(double)",82],["T_VARIABLE","$item",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","Totals",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","Shipping",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$order_currency",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$currency_to",82],")",";",["T_WHITESPACE","\n\n\t\t\t",82],["T_VARIABLE","$shipping_tax",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_DOUBLE_CAST","(double)",84],["T_VARIABLE","$item",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","Totals",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","ShippingTax",84],";",["T_WHITESPACE","\n\n\t\t\t",84],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$shipping_tax",86],["T_WHITESPACE"," ",86],["T_IS_EQUAL","==",86],["T_WHITESPACE"," ",86],["T_LNUMBER","0",86],["T_WHITESPACE"," ",86],["T_BOOLEAN_AND","&&",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","config",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","get",86],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",86],")",["T_WHITESPACE"," ",86],">",["T_WHITESPACE"," ",86],["T_LNUMBER","0",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n\t\t\t\t",86],["T_VARIABLE","$shipping_tax",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_DOUBLE_CAST","(double)",87],["T_VARIABLE","$item",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","Totals",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","Shipping",87],["T_WHITESPACE"," ",87],"*",["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","config",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","get",87],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",87],")",["T_WHITESPACE"," ",87],"\/",["T_WHITESPACE"," ",87],["T_LNUMBER","100",87],")",["T_WHITESPACE"," ",87],"\/",["T_WHITESPACE"," ",87],"(",["T_LNUMBER","1",87],["T_WHITESPACE"," ",87],"+",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","config",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","get",87],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",87],")",["T_WHITESPACE"," ",87],"\/",["T_WHITESPACE"," ",87],["T_LNUMBER","100",87],")",";",["T_WHITESPACE","\n\t\t\t",87],"}",["T_WHITESPACE","\n\n\t\t\t",88],["T_VARIABLE","$products_shipping_tax",90],["T_WHITESPACE"," ",90],["T_PLUS_EQUAL","+=",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","currency",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","convert",90],"(",["T_VARIABLE","$shipping_tax",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$order_currency",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$currency_to",90],")",";",["T_WHITESPACE","\n\n\t\t\t",90],["T_VARIABLE","$gift_wrap",92],["T_WHITESPACE"," ",92],["T_PLUS_EQUAL","+=",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","currency",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","convert",92],"(",["T_DOUBLE_CAST","(double)",92],["T_VARIABLE","$item",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","Totals",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","GiftWrap",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$order_currency",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$currency_to",92],")",";",["T_WHITESPACE","\n\n\t\t\t",92],["T_VARIABLE","$item_gift_wrap_tax",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_DOUBLE_CAST","(double)",94],["T_VARIABLE","$item",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","Totals",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","GiftWrapTax",94],";",["T_WHITESPACE","\n\n\t\t\t",94],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$item_gift_wrap_tax",96],["T_WHITESPACE"," ",96],["T_IS_EQUAL","==",96],["T_WHITESPACE"," ",96],["T_LNUMBER","0",96],["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","config",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","get",96],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",96],")",["T_WHITESPACE"," ",96],">",["T_WHITESPACE"," ",96],["T_LNUMBER","0",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n\t\t\t\t",96],["T_VARIABLE","$item_gift_wrap_tax",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_DOUBLE_CAST","(double)",97],["T_VARIABLE","$item",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","Totals",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","GiftWrap",97],["T_WHITESPACE"," ",97],"*",["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","config",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","get",97],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",97],")",["T_WHITESPACE"," ",97],"\/",["T_WHITESPACE"," ",97],["T_LNUMBER","100",97],")",["T_WHITESPACE"," ",97],"\/",["T_WHITESPACE"," ",97],"(",["T_LNUMBER","1",97],["T_WHITESPACE"," ",97],"+",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","config",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","get",97],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_tax'",97],")",["T_WHITESPACE"," ",97],"\/",["T_WHITESPACE"," ",97],["T_LNUMBER","100",97],")",";",["T_WHITESPACE","\n\t\t\t",97],"}",["T_WHITESPACE","\n\n\t\t\t",98],["T_VARIABLE","$gift_wrap_tax",100],["T_WHITESPACE"," ",100],["T_PLUS_EQUAL","+=",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","currency",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","convert",100],"(",["T_VARIABLE","$item_gift_wrap_tax",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$order_currency",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$currency_to",100],")",";",["T_WHITESPACE","\n\n\t\t\t",100],["T_VARIABLE","$product_count",102],["T_WHITESPACE"," ",102],["T_PLUS_EQUAL","+=",102],["T_WHITESPACE"," ",102],["T_INT_CAST","(int)",102],["T_VARIABLE","$item",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","Ordered",102],";",["T_WHITESPACE","\n\n\t\t\t",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_INT_CAST","(int)",104],["T_VARIABLE","$item",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","Ordered",104],["T_WHITESPACE"," ",104],["T_IS_EQUAL","==",104],["T_WHITESPACE"," ",104],["T_LNUMBER","0",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n\t\t\t\t",104],["T_CONTINUE","continue",105],";",["T_WHITESPACE","\n\t\t\t",105],"}",["T_WHITESPACE","\n\n\t\t\t",106],["T_VARIABLE","$product_id",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","model_extension_openbay_amazon_order",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getProductId",108],"(",["T_STRING_CAST","(string)",108],["T_VARIABLE","$item",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","Sku",108],")",";",["T_WHITESPACE","\n\t\t\t",108],["T_VARIABLE","$product_var",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","model_extension_openbay_amazon_order",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getProductVar",109],"(",["T_STRING_CAST","(string)",109],["T_VARIABLE","$item",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","Sku",109],")",";",["T_WHITESPACE","\n\n\t\t\t",109],["T_VARIABLE","$products",111],"[","]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",["T_WHITESPACE","\n\t\t\t\t",111],["T_CONSTANT_ENCAPSED_STRING","'product_id'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$product_id",112],",",["T_WHITESPACE","\n\t\t\t\t",112],["T_CONSTANT_ENCAPSED_STRING","'var'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$product_var",113],",",["T_WHITESPACE","\n\t\t\t\t",113],["T_CONSTANT_ENCAPSED_STRING","'sku'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_STRING_CAST","(string)",114],["T_VARIABLE","$item",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","Sku",114],",",["T_WHITESPACE","\n\t\t\t\t",114],["T_CONSTANT_ENCAPSED_STRING","'asin'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_STRING_CAST","(string)",115],["T_VARIABLE","$item",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","Asin",115],",",["T_WHITESPACE","\n\t\t\t\t",115],["T_CONSTANT_ENCAPSED_STRING","'order_item_id'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_STRING_CAST","(string)",116],["T_VARIABLE","$item",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","OrderItemId",116],",",["T_WHITESPACE","\n\t\t\t\t",116],["T_CONSTANT_ENCAPSED_STRING","'name'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_STRING_CAST","(string)",117],["T_VARIABLE","$item",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","Title",117],",",["T_WHITESPACE","\n\t\t\t\t",117],["T_CONSTANT_ENCAPSED_STRING","'model'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_STRING_CAST","(string)",118],["T_VARIABLE","$item",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","Sku",118],",",["T_WHITESPACE","\n\t\t\t\t",118],["T_CONSTANT_ENCAPSED_STRING","'quantity'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_INT_CAST","(int)",119],["T_VARIABLE","$item",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","Ordered",119],",",["T_WHITESPACE","\n\t\t\t\t",119],["T_CONSTANT_ENCAPSED_STRING","'price'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_STRING","sprintf",120],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",120],",",["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$total_price",120],["T_WHITESPACE"," ",120],"-",["T_WHITESPACE"," ",120],["T_VARIABLE","$tax_total",120],")",["T_WHITESPACE"," ",120],"\/",["T_WHITESPACE"," ",120],["T_INT_CAST","(int)",120],["T_VARIABLE","$item",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","Ordered",120],")",",",["T_WHITESPACE","\n\t\t\t\t",120],["T_CONSTANT_ENCAPSED_STRING","'total'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_STRING","sprintf",121],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$total_price",121],["T_WHITESPACE"," ",121],"-",["T_WHITESPACE"," ",121],["T_VARIABLE","$tax_total",121],")",",",["T_WHITESPACE","\n\t\t\t\t",121],["T_CONSTANT_ENCAPSED_STRING","'tax'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$tax_total",122],["T_WHITESPACE"," ",122],"\/",["T_WHITESPACE"," ",122],["T_INT_CAST","(int)",122],["T_VARIABLE","$item",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","Ordered",122],",",["T_WHITESPACE","\n\t\t\t\t",122],["T_CONSTANT_ENCAPSED_STRING","'reward'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'0'",123],",",["T_WHITESPACE","\n\t\t\t\t",123],["T_CONSTANT_ENCAPSED_STRING","'option'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","model_extension_openbay_amazon_order",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getProductOptionsByVar",124],"(",["T_VARIABLE","$product_var",124],")",",",["T_WHITESPACE","\n\t\t\t\t",124],["T_CONSTANT_ENCAPSED_STRING","'download'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_ARRAY","array",125],"(",")",",",["T_WHITESPACE","\n\t\t\t",125],")",";",["T_WHITESPACE","\n\n\t\t\t",126],["T_VARIABLE","$product_mapping",128],"[",["T_STRING_CAST","(string)",128],["T_VARIABLE","$item",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","Sku",128],"]",["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING_CAST","(string)",128],["T_VARIABLE","$item",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","OrderItemId",128],";",["T_WHITESPACE","\n\t\t",128],"}",["T_WHITESPACE","\n\n\t\t",129],["T_VARIABLE","$total",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","sprintf",131],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","currency",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","convert",131],"(",["T_DOUBLE_CAST","(double)",131],["T_VARIABLE","$order_xml",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","Payment",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","Amount",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$order_currency",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$currency_to",131],")",")",";",["T_WHITESPACE","\n\n\t\t",131],["T_VARIABLE","$address_line_2",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING_CAST","(string)",133],["T_VARIABLE","$order_xml",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","Shipping",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","AddressLine2",133],";",["T_WHITESPACE","\n\t\t",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_STRING_CAST","(string)",134],["T_VARIABLE","$order_xml",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","Shipping",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","AddressLine3",134],["T_WHITESPACE"," ",134],["T_IS_NOT_EQUAL","!=",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","''",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n\t\t\t",134],["T_VARIABLE","$address_line_2",135],["T_WHITESPACE"," ",135],["T_CONCAT_EQUAL",".=",135],["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","', '",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_STRING_CAST","(string)",135],["T_VARIABLE","$order_xml",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","Shipping",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","AddressLine3",135],";",["T_WHITESPACE","\n\t\t",135],"}",["T_WHITESPACE","\n\n\t\t",136],["T_VARIABLE","$customer_info",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","db",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","query",138],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `customer_id` FROM \"",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_STRING","DB_PREFIX",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","\"customer WHERE email = '\"",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","db",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","escape",138],"(",["T_STRING_CAST","(string)",138],["T_VARIABLE","$order_xml",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","Payment",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","Email",138],")",["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","\"'\"",138],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","row",138],";",["T_WHITESPACE","\n\t\t",138],["T_VARIABLE","$customer_id",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'0'",139],";",["T_WHITESPACE","\n\n\t\t",139],["T_IF","if",141],"(",["T_ISSET","isset",141],"(",["T_VARIABLE","$customer_info",141],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",141],"]",")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n\t\t\t",141],["T_VARIABLE","$customer_id",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$customer_info",142],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",142],"]",";",["T_WHITESPACE","\n\t\t",142],"}",["T_WHITESPACE"," ",143],["T_ELSE","else",143],["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t\t",143],["T_COMMENT","\/* Add a new customer *\/",144],["T_WHITESPACE","\n\t\t\t",144],["T_VARIABLE","$customer_data",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",["T_WHITESPACE","\n\t\t\t\t",145],["T_CONSTANT_ENCAPSED_STRING","'firstname'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_STRING_CAST","(string)",146],["T_VARIABLE","$order_xml",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","Shipping",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","Name",146],",",["T_WHITESPACE","\n\t\t\t\t",146],["T_CONSTANT_ENCAPSED_STRING","'lastname'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","''",147],",",["T_WHITESPACE","\n\t\t\t\t",147],["T_CONSTANT_ENCAPSED_STRING","'email'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_STRING_CAST","(string)",148],["T_VARIABLE","$order_xml",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","Payment",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","Email",148],",",["T_WHITESPACE","\n\t\t\t\t",148],["T_CONSTANT_ENCAPSED_STRING","'telephone'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_STRING_CAST","(string)",149],["T_VARIABLE","$order_xml",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","Shipping",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","Phone",149],",",["T_WHITESPACE","\n\t\t\t\t",149],["T_CONSTANT_ENCAPSED_STRING","'fax'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","''",150],",",["T_WHITESPACE","\n\t\t\t\t",150],["T_CONSTANT_ENCAPSED_STRING","'newsletter'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'0'",151],",",["T_WHITESPACE","\n\t\t\t\t",151],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","config",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","get",152],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_customer_group'",152],")",",",["T_WHITESPACE","\n\t\t\t\t",152],["T_CONSTANT_ENCAPSED_STRING","'password'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","''",153],",",["T_WHITESPACE","\n\t\t\t\t",153],["T_CONSTANT_ENCAPSED_STRING","'status'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'0'",154],",",["T_WHITESPACE","\n\t\t\t",154],")",";",["T_WHITESPACE","\n\n\t\t\t",155],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","db",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","query",157],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\t\tINSERT INTO \"",157],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_STRING","DB_PREFIX",158],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","\"customer\n\t\t\t\tSET firstname = '\"",158],["T_WHITESPACE"," ",159],".",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","db",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","escape",159],"(",["T_VARIABLE","$customer_data",159],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",159],"]",")",["T_WHITESPACE"," ",159],".",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tlastname = '\"",159],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","db",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","escape",160],"(",["T_VARIABLE","$customer_data",160],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",160],"]",")",["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\temail = '\"",160],["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","db",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","escape",161],"(",["T_VARIABLE","$customer_data",161],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",161],"]",")",["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\ttelephone = '\"",161],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","db",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","escape",162],"(",["T_VARIABLE","$customer_data",162],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",162],"]",")",["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tfax = '\"",162],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","db",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","escape",163],"(",["T_VARIABLE","$customer_data",163],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",163],"]",")",["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tnewsletter = '\"",163],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_INT_CAST","(int)",164],["T_VARIABLE","$customer_data",164],"[",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",164],"]",["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tcustomer_group_id = '\"",164],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_INT_CAST","(int)",165],["T_VARIABLE","$customer_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",165],"]",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tpassword = '',\n\t\t\t\t\tstatus = '\"",165],["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_INT_CAST","(int)",167],["T_VARIABLE","$customer_data",167],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",167],"]",["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tdate_added = NOW()\"",167],")",";",["T_WHITESPACE","\n\n\t\t\t",168],["T_VARIABLE","$customer_id",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","db",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getLastId",170],"(",")",";",["T_WHITESPACE","\n\t\t",170],"}",["T_WHITESPACE","\n\n\t\t",171],["T_VARIABLE","$shipping_first_name",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING_CAST","(string)",173],["T_VARIABLE","$order_xml",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","Shipping",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","FirstName",173],";",["T_WHITESPACE","\n\t\t",173],["T_VARIABLE","$shipping_last_name",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING_CAST","(string)",174],["T_VARIABLE","$order_xml",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","Shipping",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","LastName",174],";",["T_WHITESPACE","\n\n\t\t",174],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_EMPTY","empty",176],"(",["T_VARIABLE","$shipping_first_name",176],")",["T_WHITESPACE"," ",176],["T_BOOLEAN_OR","||",176],["T_WHITESPACE"," ",176],["T_EMPTY","empty",176],"(",["T_VARIABLE","$shipping_last_name",176],")",")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n\t\t\t",176],["T_VARIABLE","$shipping_first_name",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_STRING_CAST","(string)",177],["T_VARIABLE","$order_xml",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","Shipping",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","Name",177],";",["T_WHITESPACE","\n\t\t\t",177],["T_VARIABLE","$shipping_last_name",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","''",178],";",["T_WHITESPACE","\n\t\t",178],"}",["T_WHITESPACE","\n\n\t\t",179],["T_VARIABLE","$order",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_ARRAY","array",181],"(",["T_WHITESPACE","\n\t\t\t",181],["T_CONSTANT_ENCAPSED_STRING","'invoice_prefix'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","config",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","get",182],"(",["T_CONSTANT_ENCAPSED_STRING","'config_invoice_prefix'",182],")",",",["T_WHITESPACE","\n\t\t\t",182],["T_CONSTANT_ENCAPSED_STRING","'store_id'",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","config",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","get",183],"(",["T_CONSTANT_ENCAPSED_STRING","'config_store_id'",183],")",",",["T_WHITESPACE","\n\t\t\t",183],["T_CONSTANT_ENCAPSED_STRING","'store_name'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","config",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","get",184],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",184],")",["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","' \/ Amazon'",184],",",["T_WHITESPACE","\n\t\t\t",184],["T_CONSTANT_ENCAPSED_STRING","'store_url'",185],["T_WHITESPACE"," ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","config",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","get",185],"(",["T_CONSTANT_ENCAPSED_STRING","'config_url'",185],")",",",["T_WHITESPACE","\n\t\t\t",185],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_INT_CAST","(int)",186],["T_VARIABLE","$customer_id",186],",",["T_WHITESPACE","\n\t\t\t",186],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","config",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","get",187],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_order_customer_group'",187],")",",",["T_WHITESPACE","\n\t\t\t",187],["T_CONSTANT_ENCAPSED_STRING","'firstname'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$shipping_first_name",188],",",["T_WHITESPACE","\n\t\t\t",188],["T_CONSTANT_ENCAPSED_STRING","'lastname'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$shipping_last_name",189],",",["T_WHITESPACE","\n\t\t\t",189],["T_CONSTANT_ENCAPSED_STRING","'email'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_STRING_CAST","(string)",190],["T_VARIABLE","$order_xml",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","Payment",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","Email",190],",",["T_WHITESPACE","\n\t\t\t",190],["T_CONSTANT_ENCAPSED_STRING","'telephone'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_STRING_CAST","(string)",191],["T_VARIABLE","$order_xml",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","Shipping",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","Phone",191],",",["T_WHITESPACE","\n\t\t\t",191],["T_CONSTANT_ENCAPSED_STRING","'fax'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","''",192],",",["T_WHITESPACE","\n\t\t\t",192],["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$shipping_first_name",193],",",["T_WHITESPACE","\n\t\t\t",193],["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$shipping_last_name",194],",",["T_WHITESPACE","\n\t\t\t",194],["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","''",195],",",["T_WHITESPACE","\n\t\t\t",195],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_STRING_CAST","(string)",196],["T_VARIABLE","$order_xml",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","Shipping",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","AddressLine1",196],",",["T_WHITESPACE","\n\t\t\t",196],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$address_line_2",197],",",["T_WHITESPACE","\n\t\t\t",197],["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_STRING_CAST","(string)",198],["T_VARIABLE","$order_xml",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","Shipping",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","City",198],",",["T_WHITESPACE","\n\t\t\t",198],["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_STRING_CAST","(string)",199],["T_VARIABLE","$order_xml",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","Shipping",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","PostCode",199],",",["T_WHITESPACE","\n\t\t\t",199],["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","model_extension_openbay_amazon_order",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getCountryName",200],"(",["T_STRING_CAST","(string)",200],["T_VARIABLE","$order_xml",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","Shipping",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","CountryCode",200],")",",",["T_WHITESPACE","\n\t\t\t",200],["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","model_extension_openbay_amazon_order",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getCountryId",201],"(",["T_STRING_CAST","(string)",201],["T_VARIABLE","$order_xml",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","Shipping",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","CountryCode",201],")",",",["T_WHITESPACE","\n\t\t\t",201],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_STRING_CAST","(string)",202],["T_VARIABLE","$order_xml",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","Shipping",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","State",202],",",["T_WHITESPACE","\n\t\t\t",202],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","model_extension_openbay_amazon_order",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getZoneId",203],"(",["T_STRING_CAST","(string)",203],["T_VARIABLE","$order_xml",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","Shipping",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","State",203],")",",",["T_WHITESPACE","\n\t\t\t",203],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","''",204],",",["T_WHITESPACE","\n\t\t\t",204],["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_STRING_CAST","(string)",205],["T_VARIABLE","$order_xml",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","Shipping",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","Type",205],",",["T_WHITESPACE","\n\t\t\t",205],["T_CONSTANT_ENCAPSED_STRING","'shipping_code'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'amazon.'",206],["T_WHITESPACE"," ",206],".",["T_WHITESPACE"," ",206],["T_STRING_CAST","(string)",206],["T_VARIABLE","$order_xml",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","Shipping",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","Type",206],",",["T_WHITESPACE","\n\t\t\t",206],["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$shipping_first_name",207],",",["T_WHITESPACE","\n\t\t\t",207],["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$shipping_last_name",208],",",["T_WHITESPACE","\n\t\t\t",208],["T_CONSTANT_ENCAPSED_STRING","'payment_company'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","''",209],",",["T_WHITESPACE","\n\t\t\t",209],["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_STRING_CAST","(string)",210],["T_VARIABLE","$order_xml",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","Shipping",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","AddressLine1",210],",",["T_WHITESPACE","\n\t\t\t",210],["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$address_line_2",211],",",["T_WHITESPACE","\n\t\t\t",211],["T_CONSTANT_ENCAPSED_STRING","'payment_city'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_STRING_CAST","(string)",212],["T_VARIABLE","$order_xml",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","Shipping",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","City",212],",",["T_WHITESPACE","\n\t\t\t",212],["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_STRING_CAST","(string)",213],["T_VARIABLE","$order_xml",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","Shipping",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","PostCode",213],",",["T_WHITESPACE","\n\t\t\t",213],["T_CONSTANT_ENCAPSED_STRING","'payment_country'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","model_extension_openbay_amazon_order",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getCountryName",214],"(",["T_STRING_CAST","(string)",214],["T_VARIABLE","$order_xml",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","Shipping",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","CountryCode",214],")",",",["T_WHITESPACE","\n\t\t\t",214],["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","model_extension_openbay_amazon_order",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getCountryId",215],"(",["T_STRING_CAST","(string)",215],["T_VARIABLE","$order_xml",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","Shipping",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","CountryCode",215],")",",",["T_WHITESPACE","\n\t\t\t",215],["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_STRING_CAST","(string)",216],["T_VARIABLE","$order_xml",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","Shipping",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","State",216],",",["T_WHITESPACE","\n\t\t\t",216],["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","model_extension_openbay_amazon_order",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getZoneId",217],"(",["T_STRING_CAST","(string)",217],["T_VARIABLE","$order_xml",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","Shipping",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","State",217],")",",",["T_WHITESPACE","\n\t\t\t",217],["T_CONSTANT_ENCAPSED_STRING","'payment_address_format'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","''",218],",",["T_WHITESPACE","\n\t\t\t",218],["T_CONSTANT_ENCAPSED_STRING","'payment_method'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","language",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","get",219],"(",["T_CONSTANT_ENCAPSED_STRING","'text_paid_amazon'",219],")",",",["T_WHITESPACE","\n\t\t\t",219],["T_CONSTANT_ENCAPSED_STRING","'payment_code'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'amazon.amazon'",220],",",["T_WHITESPACE","\n\t\t\t",220],["T_CONSTANT_ENCAPSED_STRING","'payment_company_id'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_LNUMBER","0",221],",",["T_WHITESPACE","\n\t\t\t",221],["T_CONSTANT_ENCAPSED_STRING","'payment_tax_id'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_LNUMBER","0",222],",",["T_WHITESPACE","\n\t\t\t",222],["T_CONSTANT_ENCAPSED_STRING","'comment'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","''",223],",",["T_WHITESPACE","\n\t\t\t",223],["T_CONSTANT_ENCAPSED_STRING","'total'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$total",224],",",["T_WHITESPACE","\n\t\t\t",224],["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'0'",225],",",["T_WHITESPACE","\n\t\t\t",225],["T_CONSTANT_ENCAPSED_STRING","'commission'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'0.00'",226],",",["T_WHITESPACE","\n\t\t\t",226],["T_CONSTANT_ENCAPSED_STRING","'language_id'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_INT_CAST","(int)",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","config",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","get",227],"(",["T_CONSTANT_ENCAPSED_STRING","'config_language_id'",227],")",",",["T_WHITESPACE","\n\t\t\t",227],["T_CONSTANT_ENCAPSED_STRING","'currency_id'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","currency",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getId",228],"(",["T_VARIABLE","$order_currency",228],")",",",["T_WHITESPACE","\n\t\t\t",228],["T_CONSTANT_ENCAPSED_STRING","'currency_code'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_STRING_CAST","(string)",229],["T_VARIABLE","$order_currency",229],",",["T_WHITESPACE","\n\t\t\t",229],["T_CONSTANT_ENCAPSED_STRING","'currency_value'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","currency",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getValue",230],"(",["T_VARIABLE","$order_currency",230],")",",",["T_WHITESPACE","\n\t\t\t",230],["T_CONSTANT_ENCAPSED_STRING","'ip'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","''",231],",",["T_WHITESPACE","\n\t\t\t",231],["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","''",232],",",["T_WHITESPACE","\n\t\t\t",232],["T_CONSTANT_ENCAPSED_STRING","'user_agent'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'OpenBay Pro for Amazon'",233],",",["T_WHITESPACE","\n\t\t\t",233],["T_CONSTANT_ENCAPSED_STRING","'accept_language'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","''",234],",",["T_WHITESPACE","\n\t\t\t",234],["T_CONSTANT_ENCAPSED_STRING","'products'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$products",235],",",["T_WHITESPACE","\n\t\t\t",235],["T_CONSTANT_ENCAPSED_STRING","'vouchers'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_ARRAY","array",236],"(",")",",",["T_WHITESPACE","\n\t\t\t",236],["T_CONSTANT_ENCAPSED_STRING","'totals'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_ARRAY","array",237],"(",["T_WHITESPACE","\n\t\t\t\t",237],["T_ARRAY","array",238],"(",["T_WHITESPACE","\n\t\t\t\t\t",238],["T_CONSTANT_ENCAPSED_STRING","'code'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'sub_total'",239],",",["T_WHITESPACE","\n\t\t\t\t\t",239],["T_CONSTANT_ENCAPSED_STRING","'title'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","language",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","get",240],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_sub'",240],")",",",["T_WHITESPACE","\n\t\t\t\t\t",240],["T_CONSTANT_ENCAPSED_STRING","'value'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_STRING","sprintf",241],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$products_total",241],")",",",["T_WHITESPACE","\n\t\t\t\t\t",241],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'1'",242],",",["T_WHITESPACE","\n\t\t\t\t",242],")",",",["T_WHITESPACE","\n\t\t\t\t",243],["T_ARRAY","array",244],"(",["T_WHITESPACE","\n\t\t\t\t\t",244],["T_CONSTANT_ENCAPSED_STRING","'code'",245],["T_WHITESPACE"," ",245],["T_DOUBLE_ARROW","=>",245],["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","'shipping'",245],",",["T_WHITESPACE","\n\t\t\t\t\t",245],["T_CONSTANT_ENCAPSED_STRING","'title'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","language",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","get",246],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_shipping'",246],")",",",["T_WHITESPACE","\n\t\t\t\t\t",246],["T_CONSTANT_ENCAPSED_STRING","'value'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_STRING","sprintf",247],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$products_shipping",247],")",",",["T_WHITESPACE","\n\t\t\t\t\t",247],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'3'",248],",",["T_WHITESPACE","\n\t\t\t\t",248],")",",",["T_WHITESPACE","\n\t\t\t\t",249],["T_ARRAY","array",250],"(",["T_WHITESPACE","\n\t\t\t\t\t",250],["T_CONSTANT_ENCAPSED_STRING","'code'",251],["T_WHITESPACE"," ",251],["T_DOUBLE_ARROW","=>",251],["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'tax'",251],",",["T_WHITESPACE","\n\t\t\t\t\t",251],["T_CONSTANT_ENCAPSED_STRING","'title'",252],["T_WHITESPACE"," ",252],["T_DOUBLE_ARROW","=>",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","language",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","get",252],"(",["T_CONSTANT_ENCAPSED_STRING","'text_tax'",252],")",",",["T_WHITESPACE","\n\t\t\t\t\t",252],["T_CONSTANT_ENCAPSED_STRING","'value'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_STRING","sprintf",253],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$products_tax",253],")",",",["T_WHITESPACE","\n\t\t\t\t\t",253],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'4'",254],",",["T_WHITESPACE","\n\t\t\t\t",254],")",",",["T_WHITESPACE","\n\t\t\t\t",255],["T_ARRAY","array",256],"(",["T_WHITESPACE","\n\t\t\t\t\t",256],["T_CONSTANT_ENCAPSED_STRING","'code'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax'",257],",",["T_WHITESPACE","\n\t\t\t\t\t",257],["T_CONSTANT_ENCAPSED_STRING","'title'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","language",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","get",258],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_shipping_tax'",258],")",",",["T_WHITESPACE","\n\t\t\t\t\t",258],["T_CONSTANT_ENCAPSED_STRING","'value'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_STRING","sprintf",259],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$products_shipping_tax",259],")",",",["T_WHITESPACE","\n\t\t\t\t\t",259],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","'6'",260],",",["T_WHITESPACE","\n\t\t\t\t",260],")",",",["T_WHITESPACE","\n\t\t\t\t",261],["T_ARRAY","array",262],"(",["T_WHITESPACE","\n\t\t\t\t\t",262],["T_CONSTANT_ENCAPSED_STRING","'code'",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'gift_wrap'",263],",",["T_WHITESPACE","\n\t\t\t\t\t",263],["T_CONSTANT_ENCAPSED_STRING","'title'",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","language",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","get",264],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_giftwrap'",264],")",",",["T_WHITESPACE","\n\t\t\t\t\t",264],["T_CONSTANT_ENCAPSED_STRING","'value'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_STRING","sprintf",265],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",265],",",["T_WHITESPACE"," ",265],["T_VARIABLE","$gift_wrap",265],")",",",["T_WHITESPACE","\n\t\t\t\t\t",265],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",266],["T_WHITESPACE"," ",266],["T_DOUBLE_ARROW","=>",266],["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'2'",266],",",["T_WHITESPACE","\n\t\t\t\t",266],")",",",["T_WHITESPACE","\n\t\t\t\t",267],["T_ARRAY","array",268],"(",["T_WHITESPACE","\n\t\t\t\t\t",268],["T_CONSTANT_ENCAPSED_STRING","'code'",269],["T_WHITESPACE"," ",269],["T_DOUBLE_ARROW","=>",269],["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'gift_wrap_tax'",269],",",["T_WHITESPACE","\n\t\t\t\t\t",269],["T_CONSTANT_ENCAPSED_STRING","'title'",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","language",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","get",270],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_giftwrap_tax'",270],")",",",["T_WHITESPACE","\n\t\t\t\t\t",270],["T_CONSTANT_ENCAPSED_STRING","'value'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_STRING","sprintf",271],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$gift_wrap_tax",271],")",",",["T_WHITESPACE","\n\t\t\t\t\t",271],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_CONSTANT_ENCAPSED_STRING","'5'",272],",",["T_WHITESPACE","\n\t\t\t\t",272],")",",",["T_WHITESPACE","\n\t\t\t\t",273],["T_ARRAY","array",274],"(",["T_WHITESPACE","\n\t\t\t\t\t",274],["T_CONSTANT_ENCAPSED_STRING","'code'",275],["T_WHITESPACE"," ",275],["T_DOUBLE_ARROW","=>",275],["T_WHITESPACE"," ",275],["T_CONSTANT_ENCAPSED_STRING","'total'",275],",",["T_WHITESPACE","\n\t\t\t\t\t",275],["T_CONSTANT_ENCAPSED_STRING","'title'",276],["T_WHITESPACE"," ",276],["T_DOUBLE_ARROW","=>",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","language",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","get",276],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total'",276],")",",",["T_WHITESPACE","\n\t\t\t\t\t",276],["T_CONSTANT_ENCAPSED_STRING","'value'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_STRING","sprintf",277],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$total",277],")",",",["T_WHITESPACE","\n\t\t\t\t\t",277],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'7'",278],",",["T_WHITESPACE","\n\t\t\t\t",278],")",",",["T_WHITESPACE","\n\t\t\t",279],")",",",["T_WHITESPACE","\n\t\t",280],")",";",["T_WHITESPACE","\n\n\t\t",281],["T_VARIABLE","$order_id",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","model_checkout_order",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","addOrder",283],"(",["T_VARIABLE","$order",283],")",";",["T_WHITESPACE","\n\n\t\t",283],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","model_extension_openbay_amazon_order",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","updateOrderStatus",285],"(",["T_VARIABLE","$order_id",285],",",["T_WHITESPACE"," ",285],["T_VARIABLE","$order_status",285],")",";",["T_WHITESPACE","\n\t\t",285],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","model_extension_openbay_amazon_order",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","addAmazonOrder",286],"(",["T_VARIABLE","$order_id",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$amazon_order_id",286],")",";",["T_WHITESPACE","\n\t\t",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","model_extension_openbay_amazon_order",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","addAmazonOrderProducts",287],"(",["T_VARIABLE","$order_id",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$product_mapping",287],")",";",["T_WHITESPACE","\n\n\t\t",287],["T_FOREACH","foreach",289],"(",["T_VARIABLE","$products",289],["T_WHITESPACE"," ",289],["T_AS","as",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$product",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n\t\t\t",289],["T_IF","if",290],"(",["T_VARIABLE","$product",290],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",290],"]",["T_WHITESPACE"," ",290],["T_IS_NOT_EQUAL","!=",290],["T_WHITESPACE"," ",290],["T_LNUMBER","0",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n\t\t\t\t",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","model_extension_openbay_amazon_order",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","decreaseProductQuantity",291],"(",["T_VARIABLE","$product",291],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",291],"]",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$product",291],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",291],"]",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$product",291],"[",["T_CONSTANT_ENCAPSED_STRING","'var'",291],"]",")",";",["T_WHITESPACE","\n\t\t\t",291],"}",["T_WHITESPACE","\n\t\t",292],"}",["T_WHITESPACE","\n\n\t\t",293],["T_VARIABLE","$logger",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","write",295],"(",["T_CONSTANT_ENCAPSED_STRING","'Order '",295],["T_WHITESPACE"," ",295],".",["T_WHITESPACE"," ",295],["T_VARIABLE","$amazon_order_id",295],["T_WHITESPACE"," ",295],".",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","' was added to the database (ID: '",295],["T_WHITESPACE"," ",295],".",["T_WHITESPACE"," ",295],["T_VARIABLE","$order_id",295],["T_WHITESPACE"," ",295],".",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","')'",295],")",";",["T_WHITESPACE","\n\t\t",295],["T_VARIABLE","$logger",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","write",296],"(",["T_CONSTANT_ENCAPSED_STRING","\"Finished processing the order\"",296],")",";",["T_WHITESPACE","\n\n\t\t",296],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","model_extension_openbay_amazon_order",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","acknowledgeOrder",298],"(",["T_VARIABLE","$order_id",298],")",";",["T_WHITESPACE","\n\n\t\t",298],["T_IF","if",300],"(",["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","config",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","get",300],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_notify_admin'",300],")",["T_WHITESPACE"," ",300],["T_IS_EQUAL","==",300],["T_WHITESPACE"," ",300],["T_LNUMBER","1",300],")","{",["T_WHITESPACE","\n\t\t\t",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","openbay",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","newOrderAdminNotify",301],"(",["T_VARIABLE","$order_id",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$order_status",301],")",";",["T_WHITESPACE","\n\t\t",301],"}",["T_WHITESPACE","\n\t\t\n\t\t",302],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","event",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","trigger",304],"(",["T_CONSTANT_ENCAPSED_STRING","'model\/checkout\/order\/addOrderHistory\/after'",304],",",["T_WHITESPACE"," ",304],["T_ARRAY","array",304],"(",["T_CONSTANT_ENCAPSED_STRING","'model\/checkout\/order\/addOrderHistory\/after'",304],",",["T_WHITESPACE"," ",304],["T_ARRAY","array",304],"(",["T_VARIABLE","$order_id",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$order_status",304],")",")",")",";",["T_WHITESPACE","\n\n\t\t",304],["T_VARIABLE","$logger",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","write",306],"(",["T_CONSTANT_ENCAPSED_STRING","\"Ok\"",306],")",";",["T_WHITESPACE","\n\t\t",306],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","response",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","setOutput",307],"(",["T_CONSTANT_ENCAPSED_STRING","'Ok'",307],")",";",["T_WHITESPACE","\n\t",307],"}",["T_WHITESPACE","\n\n\t",308],["T_PUBLIC","public",310],["T_WHITESPACE"," ",310],["T_FUNCTION","function",310],["T_WHITESPACE"," ",310],["T_STRING","listing",310],"(",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n\t\t",310],["T_IF","if",311],["T_WHITESPACE"," ",311],"(",["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","config",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","get",311],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_status'",311],")",["T_WHITESPACE"," ",311],["T_IS_NOT_EQUAL","!=",311],["T_WHITESPACE"," ",311],["T_CONSTANT_ENCAPSED_STRING","'1'",311],")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n\t\t\t",311],["T_RETURN","return",312],";",["T_WHITESPACE","\n\t\t",312],"}",["T_WHITESPACE","\n\n\t\t",313],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","load",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","model",315],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_listing'",315],")",";",["T_WHITESPACE","\n\t\t",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","load",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","model",316],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_product'",316],")",";",["T_WHITESPACE","\n\n\t\t",316],["T_VARIABLE","$logger",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_NEW","new",318],["T_WHITESPACE"," ",318],["T_STRING","Log",318],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_listing.log'",318],")",";",["T_WHITESPACE","\n\t\t",318],["T_VARIABLE","$logger",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","write",319],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/listing - started'",319],")",";",["T_WHITESPACE","\n\n\t\t",319],["T_VARIABLE","$incoming_token",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_ISSET","isset",321],"(",["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","request",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","post",321],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",321],"]",")",["T_WHITESPACE"," ",321],"?",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","request",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","post",321],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",321],"]",["T_WHITESPACE"," ",321],":",["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","''",321],";",["T_WHITESPACE","\n\n\t\t",321],["T_IF","if",323],["T_WHITESPACE"," ",323],"(","!",["T_STRING","hash_equals",323],"(",["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","config",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","get",323],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_token'",323],")",",",["T_WHITESPACE"," ",323],["T_VARIABLE","$incoming_token",323],")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n\t\t\t",323],["T_VARIABLE","$logger",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","write",324],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/listing - Incorrect token: '",324],["T_WHITESPACE"," ",324],".",["T_WHITESPACE"," ",324],["T_VARIABLE","$incoming_token",324],")",";",["T_WHITESPACE","\n\t\t\t",324],["T_RETURN","return",325],";",["T_WHITESPACE","\n\t\t",325],"}",["T_WHITESPACE","\n\n\t\t",326],["T_VARIABLE","$decrypted",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","openbay",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","amazon",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","decryptArgs",328],"(",["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","request",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","post",328],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",328],"]",")",";",["T_WHITESPACE","\n\n\t\t",328],["T_IF","if",330],["T_WHITESPACE"," ",330],"(","!",["T_VARIABLE","$decrypted",330],")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n\t\t\t",330],["T_VARIABLE","$logger",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","write",331],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/order Failed to decrypt data'",331],")",";",["T_WHITESPACE","\n\t\t\t",331],["T_RETURN","return",332],";",["T_WHITESPACE","\n\t\t",332],"}",["T_WHITESPACE","\n\n\t\t",333],["T_VARIABLE","$data",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","json_decode",335],"(",["T_VARIABLE","$decrypted",335],",",["T_WHITESPACE"," ",335],["T_LNUMBER","1",335],")",";",["T_WHITESPACE","\n\n\t\t",335],["T_VARIABLE","$logger",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","write",337],"(",["T_CONSTANT_ENCAPSED_STRING","\"Received data: \"",337],["T_WHITESPACE"," ",337],".",["T_WHITESPACE"," ",337],["T_STRING","print_r",337],"(",["T_VARIABLE","$data",337],",",["T_WHITESPACE"," ",337],["T_LNUMBER","1",337],")",")",";",["T_WHITESPACE","\n\n\t\t",337],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$data",339],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",339],"]",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n\t\t\t",339],["T_VARIABLE","$logger",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","write",340],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updating \"",340],["T_WHITESPACE"," ",340],".",["T_WHITESPACE"," ",340],["T_VARIABLE","$data",340],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",340],"]",["T_WHITESPACE"," ",340],".",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","' from '",340],["T_WHITESPACE"," ",340],".",["T_WHITESPACE"," ",340],["T_VARIABLE","$data",340],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",340],"]",["T_WHITESPACE"," ",340],".",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","' as successful'",340],")",";",["T_WHITESPACE","\n\t\t\t",340],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","model_extension_openbay_amazon_listing",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","listingSuccessful",341],"(",["T_VARIABLE","$data",341],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",341],"]",",",["T_WHITESPACE"," ",341],["T_VARIABLE","$data",341],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",341],"]",")",";",["T_WHITESPACE","\n\t\t\t",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","model_extension_openbay_amazon_product",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","linkProduct",342],"(",["T_VARIABLE","$data",342],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",342],"]",",",["T_WHITESPACE"," ",342],["T_VARIABLE","$data",342],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",342],"]",")",";",["T_WHITESPACE","\n\t\t\t",342],["T_VARIABLE","$logger",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","write",343],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updated successfully\"",343],")",";",["T_WHITESPACE","\n\t\t",343],"}",["T_WHITESPACE"," ",344],["T_ELSE","else",344],["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n\t\t\t",344],["T_VARIABLE","$logger",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","write",345],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updating \"",345],["T_WHITESPACE"," ",345],".",["T_WHITESPACE"," ",345],["T_VARIABLE","$data",345],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",345],"]",["T_WHITESPACE"," ",345],".",["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","' from '",345],["T_WHITESPACE"," ",345],".",["T_WHITESPACE"," ",345],["T_VARIABLE","$data",345],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",345],"]",["T_WHITESPACE"," ",345],".",["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","' as failed'",345],")",";",["T_WHITESPACE","\n\t\t\t",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","model_extension_openbay_amazon_listing",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","listingFailed",346],"(",["T_VARIABLE","$data",346],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",346],"]",",",["T_WHITESPACE"," ",346],["T_VARIABLE","$data",346],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",346],"]",",",["T_WHITESPACE"," ",346],["T_VARIABLE","$data",346],"[",["T_CONSTANT_ENCAPSED_STRING","'messages'",346],"]",")",";",["T_WHITESPACE","\n\t\t\t",346],["T_VARIABLE","$logger",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","write",347],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updated successfully\"",347],")",";",["T_WHITESPACE","\n\t\t",347],"}",["T_WHITESPACE","\n\t",348],"}",["T_WHITESPACE","\n\n\t",349],["T_PUBLIC","public",351],["T_WHITESPACE"," ",351],["T_FUNCTION","function",351],["T_WHITESPACE"," ",351],["T_STRING","listingReport",351],"(",")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n\t\t",351],["T_IF","if",352],["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","config",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","get",352],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_status'",352],")",["T_WHITESPACE"," ",352],["T_IS_NOT_EQUAL","!=",352],["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'1'",352],")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n\t\t\t",352],["T_RETURN","return",353],";",["T_WHITESPACE","\n\t\t",353],"}",["T_WHITESPACE","\n\n\t\t",354],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","load",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","model",356],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_product'",356],")",";",["T_WHITESPACE","\n\n\t\t",356],["T_VARIABLE","$logger",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_NEW","new",358],["T_WHITESPACE"," ",358],["T_STRING","Log",358],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon.log'",358],")",";",["T_WHITESPACE","\n\t\t",358],["T_VARIABLE","$logger",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","write",359],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/listing_reports - started'",359],")",";",["T_WHITESPACE","\n\n\t\t",359],["T_VARIABLE","$incoming_token",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_ISSET","isset",361],"(",["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","request",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","post",361],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",361],"]",")",["T_WHITESPACE"," ",361],"?",["T_WHITESPACE"," ",361],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","request",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","post",361],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",361],"]",["T_WHITESPACE"," ",361],":",["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","''",361],";",["T_WHITESPACE","\n\n\t\t",361],["T_IF","if",363],["T_WHITESPACE"," ",363],"(","!",["T_STRING","hash_equals",363],"(",["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","config",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","get",363],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_token'",363],")",",",["T_WHITESPACE"," ",363],["T_VARIABLE","$incoming_token",363],")",")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n\t\t\t",363],["T_VARIABLE","$logger",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","write",364],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/listing_reports - Incorrect token: '",364],["T_WHITESPACE"," ",364],".",["T_WHITESPACE"," ",364],["T_VARIABLE","$incoming_token",364],")",";",["T_WHITESPACE","\n\t\t\t",364],["T_RETURN","return",365],";",["T_WHITESPACE","\n\t\t",365],"}",["T_WHITESPACE","\n\n\t\t",366],["T_VARIABLE","$decrypted",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","openbay",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","amazon",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","decryptArgs",368],"(",["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","request",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","post",368],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",368],"]",")",";",["T_WHITESPACE","\n\n\t\t",368],["T_IF","if",370],["T_WHITESPACE"," ",370],"(","!",["T_VARIABLE","$decrypted",370],")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n\t\t\t",370],["T_VARIABLE","$logger",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","write",371],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/listing_reports - Failed to decrypt data'",371],")",";",["T_WHITESPACE","\n\t\t\t",371],["T_RETURN","return",372],";",["T_WHITESPACE","\n\t\t",372],"}",["T_WHITESPACE","\n\n\t\t",373],["T_VARIABLE","$logger",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","write",375],"(",["T_CONSTANT_ENCAPSED_STRING","'Received Listing Report: '",375],["T_WHITESPACE"," ",375],".",["T_WHITESPACE"," ",375],["T_VARIABLE","$decrypted",375],")",";",["T_WHITESPACE","\n\n\t\t",375],["T_VARIABLE","$request",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_STRING","json_decode",377],"(",["T_VARIABLE","$decrypted",377],",",["T_WHITESPACE"," ",377],["T_LNUMBER","1",377],")",";",["T_WHITESPACE","\n\n\t\t",377],["T_VARIABLE","$data",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_ARRAY","array",379],"(",")",";",["T_WHITESPACE","\n\n\t\t",379],["T_FOREACH","foreach",381],["T_WHITESPACE"," ",381],"(",["T_VARIABLE","$request",381],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",381],"]",["T_WHITESPACE"," ",381],["T_AS","as",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$product",381],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n\t\t\t",381],["T_VARIABLE","$data",382],"[","]",["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_ARRAY","array",382],"(",["T_WHITESPACE","\n\t\t\t\t",382],["T_CONSTANT_ENCAPSED_STRING","'marketplace'",383],["T_WHITESPACE"," ",383],["T_DOUBLE_ARROW","=>",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$request",383],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",383],"]",",",["T_WHITESPACE","\n\t\t\t\t",383],["T_CONSTANT_ENCAPSED_STRING","'sku'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$product",384],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",384],"]",",",["T_WHITESPACE","\n\t\t\t\t",384],["T_CONSTANT_ENCAPSED_STRING","'quantity'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$product",385],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",385],"]",",",["T_WHITESPACE","\n\t\t\t\t",385],["T_CONSTANT_ENCAPSED_STRING","'asin'",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$product",386],"[",["T_CONSTANT_ENCAPSED_STRING","'asin'",386],"]",",",["T_WHITESPACE","\n\t\t\t\t",386],["T_CONSTANT_ENCAPSED_STRING","'price'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$product",387],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",387],"]",",",["T_WHITESPACE","\n\t\t\t",387],")",";",["T_WHITESPACE","\n\t\t",388],"}",["T_WHITESPACE","\n\n\t\t",389],["T_IF","if",391],["T_WHITESPACE"," ",391],"(",["T_VARIABLE","$data",391],")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n\t\t\t",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","model_extension_openbay_amazon_product",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","addListingReport",392],"(",["T_VARIABLE","$data",392],")",";",["T_WHITESPACE","\n\t\t",392],"}",["T_WHITESPACE","\n\n\t\t",393],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","model_extension_openbay_amazon_product",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","removeListingReportLock",395],"(",["T_VARIABLE","$request",395],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",395],"]",")",";",["T_WHITESPACE","\n\n\t\t",395],["T_VARIABLE","$logger",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","write",397],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/listing_reports - Finished'",397],")",";",["T_WHITESPACE","\n\t",397],"}",["T_WHITESPACE","\n\n\t",398],["T_PUBLIC","public",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","product",400],"(",")",["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n\t\t",400],["T_IF","if",401],["T_WHITESPACE"," ",401],"(",["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","config",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","get",401],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_status'",401],")",["T_WHITESPACE"," ",401],["T_IS_NOT_EQUAL","!=",401],["T_WHITESPACE"," ",401],["T_CONSTANT_ENCAPSED_STRING","'1'",401],")",["T_WHITESPACE"," ",401],"{",["T_WHITESPACE","\n\t\t\t",401],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","response",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","setOutput",402],"(",["T_CONSTANT_ENCAPSED_STRING","\"disabled\"",402],")",";",["T_WHITESPACE","\n\t\t\t",402],["T_RETURN","return",403],";",["T_WHITESPACE","\n\t\t",403],"}",["T_WHITESPACE","\n\n\t\t",404],["T_STRING","ob_start",406],"(",")",";",["T_WHITESPACE","\n\n\t\t",406],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","load",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","model",408],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_product'",408],")",";",["T_WHITESPACE","\n\t\t",408],["T_VARIABLE","$logger",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_NEW","new",409],["T_WHITESPACE"," ",409],["T_STRING","Log",409],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon_product.log'",409],")",";",["T_WHITESPACE","\n\n\t\t",409],["T_VARIABLE","$logger",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","write",411],"(",["T_CONSTANT_ENCAPSED_STRING","\"AmazonProduct\/inbound: incoming data\"",411],")",";",["T_WHITESPACE","\n\n\t\t",411],["T_VARIABLE","$incoming_token",413],["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_ISSET","isset",413],"(",["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","request",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","post",413],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",413],"]",")",["T_WHITESPACE"," ",413],"?",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","request",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","post",413],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",413],"]",["T_WHITESPACE"," ",413],":",["T_WHITESPACE"," ",413],["T_CONSTANT_ENCAPSED_STRING","''",413],";",["T_WHITESPACE","\n\n\t\t",413],["T_IF","if",415],"(",["T_VARIABLE","$incoming_token",415],["T_WHITESPACE"," ",415],["T_IS_NOT_EQUAL","!=",415],["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","config",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","get",415],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_token'",415],")",")",["T_WHITESPACE"," ",415],"{",["T_WHITESPACE","\n\t\t\t",415],["T_VARIABLE","$logger",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","write",416],"(",["T_CONSTANT_ENCAPSED_STRING","\"Error - Incorrect token: \"",416],["T_WHITESPACE"," ",416],".",["T_WHITESPACE"," ",416],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","request",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","post",416],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",416],"]",")",";",["T_WHITESPACE","\n\t\t\t",416],["T_STRING","ob_get_clean",417],"(",")",";",["T_WHITESPACE","\n\t\t\t",417],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","response",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","setOutput",418],"(",["T_CONSTANT_ENCAPSED_STRING","\"tokens did not match\"",418],")",";",["T_WHITESPACE","\n\n\t\t\t",418],["T_RETURN","return",420],";",["T_WHITESPACE","\n\t\t",420],"}",["T_WHITESPACE","\n\n\t\t",421],["T_VARIABLE","$data",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","openbay",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","amazon",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","decryptArgs",423],"(",["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","request",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","post",423],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",423],"]",")",";",["T_WHITESPACE","\n\n\t\t",423],["T_IF","if",425],"(","!",["T_VARIABLE","$data",425],")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n\t\t\t",425],["T_VARIABLE","$logger",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","write",426],"(",["T_CONSTANT_ENCAPSED_STRING","\"Error - Failed to decrypt received data.\"",426],")",";",["T_WHITESPACE","\n\t\t\t",426],["T_STRING","ob_get_clean",427],"(",")",";",["T_WHITESPACE","\n\t\t\t",427],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","response",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","setOutput",428],"(",["T_CONSTANT_ENCAPSED_STRING","\"failed to decrypt\"",428],")",";",["T_WHITESPACE","\n\n\t\t\t",428],["T_RETURN","return",430],";",["T_WHITESPACE","\n\t\t",430],"}",["T_WHITESPACE","\n\n\t\t",431],["T_VARIABLE","$decoded_data",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_ARRAY_CAST","(array)",433],["T_STRING","json_decode",433],"(",["T_VARIABLE","$data",433],")",";",["T_WHITESPACE","\n\t\t",433],["T_VARIABLE","$logger",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","write",434],"(",["T_CONSTANT_ENCAPSED_STRING","\"Received data: \"",434],["T_WHITESPACE"," ",434],".",["T_WHITESPACE"," ",434],["T_STRING","print_r",434],"(",["T_VARIABLE","$decoded_data",434],",",["T_WHITESPACE"," ",434],["T_STRING","true",434],")",")",";",["T_WHITESPACE","\n\t\t",434],["T_VARIABLE","$status",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$decoded_data",435],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",435],"]",";",["T_WHITESPACE","\n\n\t\t",435],["T_IF","if",437],"(",["T_VARIABLE","$status",437],["T_WHITESPACE"," ",437],["T_IS_EQUAL","==",437],["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","\"submit_error\"",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n\t\t\t",437],["T_VARIABLE","$message",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_CONSTANT_ENCAPSED_STRING","'Product was not submited to amazon properly. Please try again or contact OpenBay.'",438],";",["T_WHITESPACE","\n\t\t\t",438],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","model_extension_openbay_amazon_product",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","setSubmitError",439],"(",["T_VARIABLE","$decoded_data",439],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",439],"]",",",["T_WHITESPACE"," ",439],["T_VARIABLE","$message",439],")",";",["T_WHITESPACE","\n\t\t",439],"}",["T_WHITESPACE"," ",440],["T_ELSE","else",440],["T_WHITESPACE"," ",440],"{",["T_WHITESPACE","\n\t\t\t",440],["T_VARIABLE","$status",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_ARRAY_CAST","(array)",441],["T_VARIABLE","$status",441],";",["T_WHITESPACE","\n\t\t\t",441],["T_IF","if",442],"(",["T_VARIABLE","$status",442],"[",["T_CONSTANT_ENCAPSED_STRING","'successful'",442],"]",["T_WHITESPACE"," ",442],["T_IS_EQUAL","==",442],["T_WHITESPACE"," ",442],["T_LNUMBER","1",442],")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n\t\t\t\t",442],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","model_extension_openbay_amazon_product",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","setStatus",443],"(",["T_VARIABLE","$decoded_data",443],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",443],"]",",",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'ok'",443],")",";",["T_WHITESPACE","\n\t\t\t\t",443],["T_VARIABLE","$insertion_product",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","model_extension_openbay_amazon_product",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getProduct",444],"(",["T_VARIABLE","$decoded_data",444],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",444],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","model_extension_openbay_amazon_product",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","linkProduct",445],"(",["T_VARIABLE","$insertion_product",445],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",445],"]",",",["T_WHITESPACE"," ",445],["T_VARIABLE","$insertion_product",445],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",445],"]",",",["T_WHITESPACE"," ",445],["T_VARIABLE","$insertion_product",445],"[",["T_CONSTANT_ENCAPSED_STRING","'var'",445],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",445],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","model_extension_openbay_amazon_product",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","deleteErrors",446],"(",["T_VARIABLE","$decoded_data",446],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",446],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",446],["T_VARIABLE","$quantity_data",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_ARRAY","array",448],"(",["T_WHITESPACE","\n\t\t\t\t\t",448],["T_VARIABLE","$insertion_product",449],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",449],"]",["T_WHITESPACE"," ",449],["T_DOUBLE_ARROW","=>",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","model_extension_openbay_amazon_product",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getProductQuantity",449],"(",["T_VARIABLE","$insertion_product",449],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",449],"]",",",["T_WHITESPACE"," ",449],["T_VARIABLE","$insertion_product",449],"[",["T_CONSTANT_ENCAPSED_STRING","'var'",449],"]",")",["T_WHITESPACE","\n\t\t\t\t",449],")",";",["T_WHITESPACE","\n\t\t\t\t",450],["T_VARIABLE","$logger",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","write",451],"(",["T_CONSTANT_ENCAPSED_STRING","'Updating quantity with data: '",451],["T_WHITESPACE"," ",451],".",["T_WHITESPACE"," ",451],["T_STRING","print_r",451],"(",["T_VARIABLE","$quantity_data",451],",",["T_WHITESPACE"," ",451],["T_STRING","true",451],")",")",";",["T_WHITESPACE","\n\t\t\t\t",451],["T_VARIABLE","$logger",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","write",452],"(",["T_CONSTANT_ENCAPSED_STRING","'Response: '",452],["T_WHITESPACE"," ",452],".",["T_WHITESPACE"," ",452],["T_STRING","print_r",452],"(",["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","openbay",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","amazon",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","updateQuantities",452],"(",["T_VARIABLE","$quantity_data",452],")",",",["T_WHITESPACE"," ",452],["T_STRING","true",452],")",")",";",["T_WHITESPACE","\n\t\t\t",452],"}",["T_WHITESPACE"," ",453],["T_ELSE","else",453],["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n\t\t\t\t",453],["T_VARIABLE","$msg",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'Product was not accepted by amazon. Please try again or contact OpenBay.'",454],";",["T_WHITESPACE","\n\t\t\t\t",454],["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","model_extension_openbay_amazon_product",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","setSubmitError",455],"(",["T_VARIABLE","$decoded_data",455],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",455],"]",",",["T_WHITESPACE"," ",455],["T_VARIABLE","$msg",455],")",";",["T_WHITESPACE","\n\n\t\t\t\t",455],["T_IF","if",457],"(",["T_ISSET","isset",457],"(",["T_VARIABLE","$decoded_data",457],"[",["T_CONSTANT_ENCAPSED_STRING","'error_details'",457],"]",")",")",["T_WHITESPACE"," ",457],"{",["T_WHITESPACE","\n\t\t\t\t\t",457],["T_FOREACH","foreach",458],"(",["T_VARIABLE","$decoded_data",458],"[",["T_CONSTANT_ENCAPSED_STRING","'error_details'",458],"]",["T_WHITESPACE"," ",458],["T_AS","as",458],["T_WHITESPACE"," ",458],["T_VARIABLE","$error",458],")",["T_WHITESPACE"," ",458],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",458],["T_VARIABLE","$error",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_ARRAY_CAST","(array)",459],["T_VARIABLE","$error",459],";",["T_WHITESPACE","\n\t\t\t\t\t\t",459],["T_VARIABLE","$error_data",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_ARRAY","array",460],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",460],["T_CONSTANT_ENCAPSED_STRING","'sku'",461],["T_WHITESPACE"," ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$error",461],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",461],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",461],["T_CONSTANT_ENCAPSED_STRING","'error_code'",462],["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$error",462],"[",["T_CONSTANT_ENCAPSED_STRING","'error_code'",462],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",462],["T_CONSTANT_ENCAPSED_STRING","'message'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$error",463],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",463],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",463],["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",464],["T_WHITESPACE"," ",464],["T_DOUBLE_ARROW","=>",464],["T_WHITESPACE"," ",464],["T_VARIABLE","$decoded_data",464],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",464],"]",["T_WHITESPACE","\n\t\t\t\t\t\t",464],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",465],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","model_extension_openbay_amazon_product",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","insertError",466],"(",["T_VARIABLE","$error_data",466],")",";",["T_WHITESPACE","\n\t\t\t\t\t",466],"}",["T_WHITESPACE","\n\t\t\t\t",467],"}",["T_WHITESPACE","\n\t\t\t",468],"}",["T_WHITESPACE","\n\t\t",469],"}",["T_WHITESPACE","\n\n\t\t",470],["T_VARIABLE","$logger",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","write",472],"(",["T_CONSTANT_ENCAPSED_STRING","\"Data processed successfully.\"",472],")",";",["T_WHITESPACE","\n\t\t",472],["T_STRING","ob_get_clean",473],"(",")",";",["T_WHITESPACE","\n\t\t",473],["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","response",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","setOutput",474],"(",["T_CONSTANT_ENCAPSED_STRING","\"ok\"",474],")",";",["T_WHITESPACE","\n\t",474],"}",["T_WHITESPACE","\n\n\t",475],["T_PUBLIC","public",477],["T_WHITESPACE"," ",477],["T_FUNCTION","function",477],["T_WHITESPACE"," ",477],["T_STRING","search",477],"(",")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n\t\t",477],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","config",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","get",478],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_status'",478],")",["T_WHITESPACE"," ",478],["T_IS_NOT_EQUAL","!=",478],["T_WHITESPACE"," ",478],["T_CONSTANT_ENCAPSED_STRING","'1'",478],")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n\t\t\t",478],["T_RETURN","return",479],";",["T_WHITESPACE","\n\t\t",479],"}",["T_WHITESPACE","\n\n\t\t",480],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","load",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","model",482],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_product'",482],")",";",["T_WHITESPACE","\n\n\t\t",482],["T_VARIABLE","$logger",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_NEW","new",484],["T_WHITESPACE"," ",484],["T_STRING","Log",484],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon.log'",484],")",";",["T_WHITESPACE","\n\t\t",484],["T_VARIABLE","$logger",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","write",485],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/search - started'",485],")",";",["T_WHITESPACE","\n\n\t\t",485],["T_VARIABLE","$incoming_token",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_ISSET","isset",487],"(",["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","request",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","post",487],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",487],"]",")",["T_WHITESPACE"," ",487],"?",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","request",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","post",487],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",487],"]",["T_WHITESPACE"," ",487],":",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","''",487],";",["T_WHITESPACE","\n\n\t\t",487],["T_IF","if",489],["T_WHITESPACE"," ",489],"(","!",["T_STRING","hash_equals",489],"(",["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","config",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","get",489],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_token'",489],")",",",["T_WHITESPACE"," ",489],["T_VARIABLE","$incoming_token",489],")",")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n\t\t\t",489],["T_VARIABLE","$logger",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","write",490],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/search - Incorrect token: '",490],["T_WHITESPACE"," ",490],".",["T_WHITESPACE"," ",490],["T_VARIABLE","$incoming_token",490],")",";",["T_WHITESPACE","\n\t\t\t",490],["T_RETURN","return",491],";",["T_WHITESPACE","\n\t\t",491],"}",["T_WHITESPACE","\n\n\t\t",492],["T_VARIABLE","$decrypted",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","openbay",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","amazon",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","decryptArgs",494],"(",["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","request",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","post",494],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",494],"]",")",";",["T_WHITESPACE","\n\n\t\t",494],["T_IF","if",496],["T_WHITESPACE"," ",496],"(","!",["T_VARIABLE","$decrypted",496],")",["T_WHITESPACE"," ",496],"{",["T_WHITESPACE","\n\t\t\t",496],["T_VARIABLE","$logger",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","write",497],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon\/search Failed to decrypt data'",497],")",";",["T_WHITESPACE","\n\t\t\t",497],["T_RETURN","return",498],";",["T_WHITESPACE","\n\t\t",498],"}",["T_WHITESPACE","\n\n\t\t",499],["T_VARIABLE","$logger",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","write",501],"(",["T_VARIABLE","$decrypted",501],")",";",["T_WHITESPACE","\n\n\t\t",501],["T_VARIABLE","$json",503],["T_WHITESPACE"," ",503],"=",["T_WHITESPACE"," ",503],["T_STRING","json_decode",503],"(",["T_VARIABLE","$decrypted",503],",",["T_WHITESPACE"," ",503],["T_LNUMBER","1",503],")",";",["T_WHITESPACE","\n\n\t\t",503],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","model_extension_openbay_amazon_product",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","updateSearch",505],"(",["T_VARIABLE","$json",505],")",";",["T_WHITESPACE","\n\t",505],"}",["T_WHITESPACE","\n\n\t",506],["T_PUBLIC","public",508],["T_WHITESPACE"," ",508],["T_FUNCTION","function",508],["T_WHITESPACE"," ",508],["T_STRING","dev",508],"(",")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n\t\t",508],["T_IF","if",509],["T_WHITESPACE"," ",509],"(",["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","config",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","get",509],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_status'",509],")",["T_WHITESPACE"," ",509],["T_IS_NOT_EQUAL","!=",509],["T_WHITESPACE"," ",509],["T_CONSTANT_ENCAPSED_STRING","'1'",509],")",["T_WHITESPACE"," ",509],"{",["T_WHITESPACE","\n\t\t\t",509],["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","response",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","setOutput",510],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 001\"",510],")",";",["T_WHITESPACE","\n\t\t\t",510],["T_RETURN","return",511],";",["T_WHITESPACE","\n\t\t",511],"}",["T_WHITESPACE","\n\n\t\t",512],["T_VARIABLE","$incoming_token",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_ISSET","isset",514],"(",["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","request",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","post",514],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",514],"]",")",["T_WHITESPACE"," ",514],"?",["T_WHITESPACE"," ",514],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","request",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","post",514],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",514],"]",["T_WHITESPACE"," ",514],":",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","''",514],";",["T_WHITESPACE","\n\n\t\t",514],["T_IF","if",516],["T_WHITESPACE"," ",516],"(",["T_VARIABLE","$incoming_token",516],["T_WHITESPACE"," ",516],["T_IS_NOT_EQUAL","!=",516],["T_WHITESPACE"," ",516],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","config",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","get",516],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazon_token'",516],")",")",["T_WHITESPACE"," ",516],"{",["T_WHITESPACE","\n\t\t\t",516],["T_VARIABLE","$this",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","response",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","setOutput",517],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 002\"",517],")",";",["T_WHITESPACE","\n\t\t\t",517],["T_RETURN","return",518],";",["T_WHITESPACE","\n\t\t",518],"}",["T_WHITESPACE","\n\n\t\t",519],["T_VARIABLE","$data",521],["T_WHITESPACE"," ",521],"=",["T_WHITESPACE"," ",521],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","openbay",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","amazon",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","decryptArgs",521],"(",["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","request",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","post",521],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",521],"]",")",";",["T_WHITESPACE","\n\t\t",521],["T_IF","if",522],["T_WHITESPACE"," ",522],"(","!",["T_VARIABLE","$data",522],")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n\t\t\t",522],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","response",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","setOutput",523],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 003\"",523],")",";",["T_WHITESPACE","\n\t\t\t",523],["T_RETURN","return",524],";",["T_WHITESPACE","\n\t\t",524],"}",["T_WHITESPACE","\n\n\t\t",525],["T_VARIABLE","$data_xml",527],["T_WHITESPACE"," ",527],"=",["T_WHITESPACE"," ",527],["T_STRING","simplexml_load_string",527],"(",["T_VARIABLE","$data",527],")",";",["T_WHITESPACE","\n\n\t\t",527],["T_IF","if",529],"(","!",["T_ISSET","isset",529],"(",["T_VARIABLE","$data_xml",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","action",529],")",")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n\t\t\t",529],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","response",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","setOutput",530],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 004\"",530],")",";",["T_WHITESPACE","\n\t\t\t",530],["T_RETURN","return",531],";",["T_WHITESPACE","\n\t\t",531],"}",["T_WHITESPACE","\n\n\t\t",532],["T_VARIABLE","$action",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_STRING","trim",534],"(",["T_STRING_CAST","(string)",534],["T_VARIABLE","$data_xml",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","action",534],")",";",["T_WHITESPACE","\n\n\t\t",534],["T_IF","if",536],["T_WHITESPACE"," ",536],"(",["T_VARIABLE","$action",536],["T_WHITESPACE"," ",536],["T_IS_IDENTICAL","===",536],["T_WHITESPACE"," ",536],["T_CONSTANT_ENCAPSED_STRING","\"get_amazon_product\"",536],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n\t\t\t",536],["T_IF","if",537],"(","!",["T_ISSET","isset",537],"(",["T_VARIABLE","$data_xml",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","product_id",537],")",")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n\t\t\t\t",537],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","response",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","setOutput",538],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 005\"",538],")",";",["T_WHITESPACE","\n\t\t\t\t",538],["T_RETURN","return",539],";",["T_WHITESPACE","\n\t\t\t",539],"}",["T_WHITESPACE","\n\n\t\t\t",540],["T_VARIABLE","$product_id",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_STRING","trim",542],"(",["T_STRING_CAST","(string)",542],["T_VARIABLE","$data_xml",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","product_id",542],")",";",["T_WHITESPACE","\n\n\t\t\t",542],["T_IF","if",544],["T_WHITESPACE"," ",544],"(",["T_VARIABLE","$product_id",544],["T_WHITESPACE"," ",544],["T_IS_IDENTICAL","===",544],["T_WHITESPACE"," ",544],["T_CONSTANT_ENCAPSED_STRING","\"all\"",544],")",["T_WHITESPACE"," ",544],"{",["T_WHITESPACE","\n\t\t\t\t",544],["T_VARIABLE","$all_rows",545],["T_WHITESPACE"," ",545],"=",["T_WHITESPACE"," ",545],["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","db",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","query",545],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",545],["T_WHITESPACE"," ",545],".",["T_WHITESPACE"," ",545],["T_STRING","DB_PREFIX",545],["T_WHITESPACE"," ",545],".",["T_WHITESPACE"," ",545],["T_CONSTANT_ENCAPSED_STRING","\"amazon_product`\"",545],")",["T_OBJECT_OPERATOR","->",545],["T_STRING","rows",545],";",["T_WHITESPACE","\n\n\t\t\t\t",545],["T_VARIABLE","$response",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_ARRAY","array",547],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",547],["T_FOREACH","foreach",548],["T_WHITESPACE"," ",548],"(",["T_VARIABLE","$all_rows",548],["T_WHITESPACE"," ",548],["T_AS","as",548],["T_WHITESPACE"," ",548],["T_VARIABLE","$row",548],")",["T_WHITESPACE"," ",548],"{",["T_WHITESPACE","\n\t\t\t\t\t",548],["T_UNSET","unset",549],"(",["T_VARIABLE","$row",549],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",549],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",549],["T_VARIABLE","$response",550],"[","]",["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$row",550],";",["T_WHITESPACE","\n\t\t\t\t",550],"}",["T_WHITESPACE","\n\n\t\t\t\t",551],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","response",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","setOutput",553],"(",["T_STRING","print_r",553],"(",["T_VARIABLE","$response",553],",",["T_WHITESPACE"," ",553],["T_STRING","true",553],")",")",";",["T_WHITESPACE","\n\t\t\t\t",553],["T_RETURN","return",554],";",["T_WHITESPACE","\n\t\t\t",554],"}",["T_WHITESPACE"," ",555],["T_ELSE","else",555],["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n\t\t\t\t",555],["T_VARIABLE","$response",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_VARIABLE","$this",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","db",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","query",556],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",556],["T_WHITESPACE"," ",556],".",["T_WHITESPACE"," ",556],["T_STRING","DB_PREFIX",556],["T_WHITESPACE"," ",556],".",["T_WHITESPACE"," ",556],["T_CONSTANT_ENCAPSED_STRING","\"amazon_product` WHERE `product_id` = '\"",556],["T_WHITESPACE"," ",556],".",["T_WHITESPACE"," ",556],["T_INT_CAST","(int)",556],["T_VARIABLE","$product_id",556],["T_WHITESPACE"," ",556],".",["T_WHITESPACE"," ",556],["T_CONSTANT_ENCAPSED_STRING","\"'\"",556],")",["T_OBJECT_OPERATOR","->",556],["T_STRING","rows",556],";",["T_WHITESPACE","\n\n\t\t\t\t",556],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","response",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","setOutput",558],"(",["T_STRING","print_r",558],"(",["T_VARIABLE","$response",558],",",["T_WHITESPACE"," ",558],["T_STRING","true",558],")",")",";",["T_WHITESPACE","\n\t\t\t\t",558],["T_RETURN","return",559],";",["T_WHITESPACE","\n\t\t\t",559],"}",["T_WHITESPACE","\n\t\t",560],"}",["T_WHITESPACE"," ",561],["T_ELSE","else",561],["T_WHITESPACE"," ",561],"{",["T_WHITESPACE","\n\t\t\t",561],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","response",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","setOutput",562],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 999\"",562],")",";",["T_WHITESPACE","\n\t\t\t",562],["T_RETURN","return",563],";",["T_WHITESPACE","\n\t\t",563],"}",["T_WHITESPACE","\n\t",564],"}",["T_WHITESPACE","\n\t\n\t",565],["T_PUBLIC","public",567],["T_WHITESPACE"," ",567],["T_FUNCTION","function",567],["T_WHITESPACE"," ",567],["T_STRING","eventAddOrderHistory",567],"(",["T_VARIABLE","$route",567],",",["T_WHITESPACE"," ",567],["T_VARIABLE","$data",567],")",["T_WHITESPACE"," ",567],"{",["T_WHITESPACE","\n\t\t",567],["T_VARIABLE","$logger",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_NEW","new",568],["T_WHITESPACE"," ",568],["T_NS_SEPARATOR","\\",568],["T_STRING","Log",568],"(",["T_CONSTANT_ENCAPSED_STRING","'amazon.log'",568],")",";",["T_WHITESPACE","\n\t\t",568],["T_VARIABLE","$logger",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","write",569],"(",["T_CONSTANT_ENCAPSED_STRING","'eventAddOrderHistory Event fired: '",569],["T_WHITESPACE"," ",569],".",["T_WHITESPACE"," ",569],["T_VARIABLE","$route",569],")",";",["T_WHITESPACE","\n\t\t\n\t\t",569],["T_IF","if",571],["T_WHITESPACE"," ",571],"(",["T_ISSET","isset",571],"(",["T_VARIABLE","$data",571],"[",["T_LNUMBER","0",571],"]",")",["T_WHITESPACE"," ",571],["T_BOOLEAN_AND","&&",571],["T_WHITESPACE"," ",571],"!",["T_EMPTY","empty",571],"(",["T_VARIABLE","$data",571],"[",["T_LNUMBER","0",571],"]",")",")",["T_WHITESPACE"," ",571],"{",["T_WHITESPACE","\n\t\t\t",571],["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","load",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","model",572],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazon_order'",572],")",";",["T_WHITESPACE","\n\t\t\t\n\t\t\t",572],["T_VARIABLE","$logger",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","write",574],"(",["T_CONSTANT_ENCAPSED_STRING","'Order ID: '",574],["T_WHITESPACE"," ",574],".",["T_WHITESPACE"," ",574],["T_INT_CAST","(int)",574],["T_VARIABLE","$data",574],"[",["T_LNUMBER","0",574],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",574],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","model_extension_openbay_amazon_order",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","addOrderHistory",576],"(",["T_INT_CAST","(int)",576],["T_VARIABLE","$data",576],"[",["T_LNUMBER","0",576],"]",")",";",["T_WHITESPACE","\n\t\t",576],"}",["T_WHITESPACE","\n\t",577],"}",["T_WHITESPACE","\n",578],"}"]