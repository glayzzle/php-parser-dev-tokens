[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionOpenbayAmazonus",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","order",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_IF","if",4],["T_WHITESPACE"," ",4],"(",["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","config",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","get",4],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_status'",4],")",["T_WHITESPACE"," ",4],["T_IS_NOT_EQUAL","!=",4],["T_WHITESPACE"," ",4],["T_CONSTANT_ENCAPSED_STRING","'1'",4],")",["T_WHITESPACE"," ",4],"{",["T_WHITESPACE","\n\t\t\t",4],["T_RETURN","return",5],";",["T_WHITESPACE","\n\t\t",5],"}",["T_WHITESPACE","\n\n\t\t",6],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","load",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","model",8],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",8],")",";",["T_WHITESPACE","\n\t\t",8],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","load",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","model",9],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_order'",9],")",";",["T_WHITESPACE","\n\t\t",9],["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","load",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","language",10],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_order'",10],")",";",["T_WHITESPACE","\n\n\t\t",10],["T_VARIABLE","$logger",12],["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_NEW","new",12],["T_WHITESPACE"," ",12],["T_STRING","Log",12],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus.log'",12],")",";",["T_WHITESPACE","\n\t\t",12],["T_VARIABLE","$logger",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","write",13],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/order - started'",13],")",";",["T_WHITESPACE","\n\n\t\t",13],["T_VARIABLE","$token",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","config",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","get",15],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_token'",15],")",";",["T_WHITESPACE","\n\n\t\t",15],["T_VARIABLE","$incoming_token",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_ISSET","isset",17],"(",["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","request",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","post",17],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",17],"]",")",["T_WHITESPACE"," ",17],"?",["T_WHITESPACE"," ",17],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","request",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","post",17],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",17],"]",["T_WHITESPACE"," ",17],":",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","''",17],";",["T_WHITESPACE","\n\n\t\t",17],["T_IF","if",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$incoming_token",19],["T_WHITESPACE"," ",19],["T_IS_NOT_IDENTICAL","!==",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$token",19],")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t\t",19],["T_VARIABLE","$logger",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","write",20],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/order - Incorrect token: '",20],["T_WHITESPACE"," ",20],".",["T_WHITESPACE"," ",20],["T_VARIABLE","$incoming_token",20],")",";",["T_WHITESPACE","\n\t\t\t",20],["T_RETURN","return",21],";",["T_WHITESPACE","\n\t\t",21],"}",["T_WHITESPACE","\n\n\t\t",22],["T_VARIABLE","$decrypted",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","openbay",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","amazonus",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","decryptArgs",24],"(",["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","request",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","post",24],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",24],"]",")",";",["T_WHITESPACE","\n\n\t\t",24],["T_IF","if",26],["T_WHITESPACE"," ",26],"(","!",["T_VARIABLE","$decrypted",26],")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n\t\t\t",26],["T_VARIABLE","$logger",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","write",27],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/order Failed to decrypt data'",27],")",";",["T_WHITESPACE","\n\t\t\t",27],["T_RETURN","return",28],";",["T_WHITESPACE","\n\t\t",28],"}",["T_WHITESPACE","\n\n\t\t",29],["T_VARIABLE","$order_xml",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","simplexml_load_string",31],"(",["T_VARIABLE","$decrypted",31],")",";",["T_WHITESPACE","\n\n\t\t",31],["T_VARIABLE","$amazonus_order_status",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","trim",33],"(",["T_STRING","strtolower",33],"(",["T_STRING_CAST","(string)",33],["T_VARIABLE","$order_xml",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","Status",33],")",")",";",["T_WHITESPACE","\n\n\t\t",33],["T_VARIABLE","$amazonus_order_id",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING_CAST","(string)",35],["T_VARIABLE","$order_xml",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","AmazonOrderId",35],";",["T_WHITESPACE","\n\t\t",35],["T_VARIABLE","$order_status",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","model_extension_openbay_amazonus_order",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getMappedStatus",36],"(",["T_STRING_CAST","(string)",36],["T_VARIABLE","$order_xml",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","Status",36],")",";",["T_WHITESPACE","\n\n\t\t",36],["T_VARIABLE","$logger",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","write",38],"(",["T_CONSTANT_ENCAPSED_STRING","'Received order '",38],["T_WHITESPACE"," ",38],".",["T_WHITESPACE"," ",38],["T_VARIABLE","$amazonus_order_id",38],")",";",["T_WHITESPACE","\n\n\t\t",38],["T_VARIABLE","$order_id",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","model_extension_openbay_amazonus_order",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getOrderId",40],"(",["T_VARIABLE","$amazonus_order_id",40],")",";",["T_WHITESPACE","\n\n\t\t",40],["T_COMMENT","\/\/ If the order already exists on opencart, ignore it.\n",42],["T_WHITESPACE","\t\t",43],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_VARIABLE","$order_id",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n\t\t\t",43],["T_VARIABLE","$logger",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","write",44],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Duplicate order ",44],["T_VARIABLE","$amazonus_order_id",44],["T_ENCAPSED_AND_WHITESPACE",". Terminating.",44],"\"",")",";",["T_WHITESPACE","\n\t\t\t",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","response",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","setOutput",45],"(",["T_CONSTANT_ENCAPSED_STRING","'Ok'",45],")",";",["T_WHITESPACE","\n\t\t\t",45],["T_RETURN","return",46],";",["T_WHITESPACE","\n\t\t",46],"}",["T_WHITESPACE","\n\n\t\t",47],["T_COMMENT","\/* Check if order comes from subscribed marketplace *\/",49],["T_WHITESPACE","\n\n\t\t",49],["T_VARIABLE","$currency_to",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","config",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","get",51],"(",["T_CONSTANT_ENCAPSED_STRING","'config_currency'",51],")",";",["T_WHITESPACE","\n\t\t",51],["T_VARIABLE","$order_currency",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING_CAST","(string)",52],["T_VARIABLE","$order_xml",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","Payment",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","CurrencyCode",52],";",["T_WHITESPACE","\n\n\t\t",52],["T_VARIABLE","$products",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_ARRAY","array",54],"(",")",";",["T_WHITESPACE","\n\n\t\t",54],["T_VARIABLE","$products_total",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_LNUMBER","0",56],";",["T_WHITESPACE","\n\t\t",56],["T_VARIABLE","$products_shipping",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","0",57],";",["T_WHITESPACE","\n\t\t",57],["T_VARIABLE","$products_tax",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_LNUMBER","0",58],";",["T_WHITESPACE","\n\t\t",58],["T_VARIABLE","$products_shipping_tax",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_LNUMBER","0",59],";",["T_WHITESPACE","\n\t\t",59],["T_VARIABLE","$gift_wrap",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_LNUMBER","0",60],";",["T_WHITESPACE","\n\t\t",60],["T_VARIABLE","$gift_wrap_tax",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_LNUMBER","0",61],";",["T_WHITESPACE","\n\n\t\t",61],["T_VARIABLE","$product_count",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_LNUMBER","0",63],";",["T_WHITESPACE","\n\n\t\t",63],["T_VARIABLE","$amazonus_order_id",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING_CAST","(string)",65],["T_VARIABLE","$order_xml",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","AmazonOrderId",65],";",["T_WHITESPACE","\n\n\t\t",65],["T_COMMENT","\/* SKU => ORDER_ITEM_ID *\/",67],["T_WHITESPACE","\n\t\t",67],["T_VARIABLE","$product_mapping",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",";",["T_WHITESPACE","\n\n\t\t",68],["T_FOREACH","foreach",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$order_xml",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","Items",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","Item",70],["T_WHITESPACE"," ",70],["T_AS","as",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$item",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n\n\t\t\t",70],["T_VARIABLE","$total_price",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","currency",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","convert",72],"(",["T_DOUBLE_CAST","(double)",72],["T_VARIABLE","$item",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","Totals",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","Price",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$order_currency",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$currency_to",72],")",";",["T_WHITESPACE","\n\t\t\t",72],["T_VARIABLE","$tax_total",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_DOUBLE_CAST","(double)",73],["T_VARIABLE","$item",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","Totals",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","Tax",73],";",["T_WHITESPACE","\n\n\t\t\t",73],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$tax_total",75],["T_WHITESPACE"," ",75],["T_IS_EQUAL","==",75],["T_WHITESPACE"," ",75],["T_LNUMBER","0",75],["T_WHITESPACE"," ",75],["T_BOOLEAN_AND","&&",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","config",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","get",75],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",75],")",["T_WHITESPACE"," ",75],">",["T_WHITESPACE"," ",75],["T_LNUMBER","0",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n\t\t\t\t",75],["T_VARIABLE","$tax_total",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_DOUBLE_CAST","(double)",76],["T_VARIABLE","$item",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","Totals",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","Price",76],["T_WHITESPACE"," ",76],"*",["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","config",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","get",76],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",76],")",["T_WHITESPACE"," ",76],"\/",["T_WHITESPACE"," ",76],["T_LNUMBER","100",76],")",["T_WHITESPACE"," ",76],"\/",["T_WHITESPACE"," ",76],"(",["T_LNUMBER","1",76],["T_WHITESPACE"," ",76],"+",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","config",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","get",76],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",76],")",["T_WHITESPACE"," ",76],"\/",["T_WHITESPACE"," ",76],["T_LNUMBER","100",76],")",";",["T_WHITESPACE","\n\t\t\t",76],"}",["T_WHITESPACE","\n\n\t\t\t",77],["T_VARIABLE","$tax_total",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","currency",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","convert",79],"(",["T_VARIABLE","$tax_total",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$order_currency",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$currency_to",79],")",";",["T_WHITESPACE","\n\n\t\t\t",79],["T_VARIABLE","$products_total",81],["T_WHITESPACE"," ",81],["T_PLUS_EQUAL","+=",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$total_price",81],";",["T_WHITESPACE","\n\t\t\t",81],["T_VARIABLE","$products_tax",82],["T_WHITESPACE"," ",82],["T_PLUS_EQUAL","+=",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$tax_total",82],";",["T_WHITESPACE","\n\n\t\t\t",82],["T_VARIABLE","$products_shipping",84],["T_WHITESPACE"," ",84],["T_PLUS_EQUAL","+=",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","currency",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","convert",84],"(",["T_DOUBLE_CAST","(double)",84],["T_VARIABLE","$item",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","Totals",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","Shipping",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$order_currency",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$currency_to",84],")",";",["T_WHITESPACE","\n\n\t\t\t",84],["T_VARIABLE","$shipping_tax",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_DOUBLE_CAST","(double)",86],["T_VARIABLE","$item",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","Totals",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","ShippingTax",86],";",["T_WHITESPACE","\n\n\t\t\t",86],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$shipping_tax",88],["T_WHITESPACE"," ",88],["T_IS_EQUAL","==",88],["T_WHITESPACE"," ",88],["T_LNUMBER","0",88],["T_WHITESPACE"," ",88],["T_BOOLEAN_AND","&&",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","config",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","get",88],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",88],")",["T_WHITESPACE"," ",88],">",["T_WHITESPACE"," ",88],["T_LNUMBER","0",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n\t\t\t\t",88],["T_VARIABLE","$shipping_tax",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_DOUBLE_CAST","(double)",89],["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","Totals",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","Shipping",89],["T_WHITESPACE"," ",89],"*",["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","get",89],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",89],")",["T_WHITESPACE"," ",89],"\/",["T_WHITESPACE"," ",89],["T_LNUMBER","100",89],")",["T_WHITESPACE"," ",89],"\/",["T_WHITESPACE"," ",89],"(",["T_LNUMBER","1",89],["T_WHITESPACE"," ",89],"+",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","get",89],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",89],")",["T_WHITESPACE"," ",89],"\/",["T_WHITESPACE"," ",89],["T_LNUMBER","100",89],")",";",["T_WHITESPACE","\n\t\t\t",89],"}",["T_WHITESPACE","\n\n\t\t\t",90],["T_VARIABLE","$products_shipping_tax",92],["T_WHITESPACE"," ",92],["T_PLUS_EQUAL","+=",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","currency",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","convert",92],"(",["T_VARIABLE","$shipping_tax",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$order_currency",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$currency_to",92],")",";",["T_WHITESPACE","\n\n\t\t\t",92],["T_VARIABLE","$gift_wrap",94],["T_WHITESPACE"," ",94],["T_PLUS_EQUAL","+=",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","currency",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","convert",94],"(",["T_DOUBLE_CAST","(double)",94],["T_VARIABLE","$item",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","Totals",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","GiftWrap",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$order_currency",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$currency_to",94],")",";",["T_WHITESPACE","\n\n\t\t\t",94],["T_VARIABLE","$item_gift_wrap_tax",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_DOUBLE_CAST","(double)",96],["T_VARIABLE","$item",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","Totals",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","GiftWrapTax",96],";",["T_WHITESPACE","\n\n\t\t\t",96],["T_IF","if",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$item_gift_wrap_tax",98],["T_WHITESPACE"," ",98],["T_IS_EQUAL","==",98],["T_WHITESPACE"," ",98],["T_LNUMBER","0",98],["T_WHITESPACE"," ",98],["T_BOOLEAN_AND","&&",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","config",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","get",98],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",98],")",["T_WHITESPACE"," ",98],">",["T_WHITESPACE"," ",98],["T_LNUMBER","0",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n\t\t\t\t",98],["T_VARIABLE","$item_gift_wrap_tax",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_DOUBLE_CAST","(double)",99],["T_VARIABLE","$item",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","Totals",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","GiftWrap",99],["T_WHITESPACE"," ",99],"*",["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","config",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","get",99],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",99],")",["T_WHITESPACE"," ",99],"\/",["T_WHITESPACE"," ",99],["T_LNUMBER","100",99],")",["T_WHITESPACE"," ",99],"\/",["T_WHITESPACE"," ",99],"(",["T_LNUMBER","1",99],["T_WHITESPACE"," ",99],"+",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","config",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","get",99],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_tax'",99],")",["T_WHITESPACE"," ",99],"\/",["T_WHITESPACE"," ",99],["T_LNUMBER","100",99],")",";",["T_WHITESPACE","\n\t\t\t",99],"}",["T_WHITESPACE","\n\n\t\t\t",100],["T_VARIABLE","$gift_wrap_tax",102],["T_WHITESPACE"," ",102],["T_PLUS_EQUAL","+=",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","currency",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","convert",102],"(",["T_VARIABLE","$item_gift_wrap_tax",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$order_currency",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$currency_to",102],")",";",["T_WHITESPACE","\n\n\t\t\t",102],["T_VARIABLE","$product_count",104],["T_WHITESPACE"," ",104],["T_PLUS_EQUAL","+=",104],["T_WHITESPACE"," ",104],["T_INT_CAST","(int)",104],["T_VARIABLE","$item",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","Ordered",104],";",["T_WHITESPACE","\n\n\t\t\t",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_INT_CAST","(int)",106],["T_VARIABLE","$item",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","Ordered",106],["T_WHITESPACE"," ",106],["T_IS_EQUAL","==",106],["T_WHITESPACE"," ",106],["T_LNUMBER","0",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n\t\t\t\t",106],["T_CONTINUE","continue",107],";",["T_WHITESPACE","\n\t\t\t",107],"}",["T_WHITESPACE","\n\n\t\t\t",108],["T_VARIABLE","$product_id",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","model_extension_openbay_amazonus_order",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getProductId",110],"(",["T_STRING_CAST","(string)",110],["T_VARIABLE","$item",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","Sku",110],")",";",["T_WHITESPACE","\n\t\t\t",110],["T_VARIABLE","$product_var",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","model_extension_openbay_amazonus_order",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getProductVar",111],"(",["T_STRING_CAST","(string)",111],["T_VARIABLE","$item",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","Sku",111],")",";",["T_WHITESPACE","\n\n\t\t\t",111],["T_VARIABLE","$products",113],"[","]",["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_ARRAY","array",113],"(",["T_WHITESPACE","\n\t\t\t\t",113],["T_CONSTANT_ENCAPSED_STRING","'product_id'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$product_id",114],",",["T_WHITESPACE","\n\t\t\t\t",114],["T_CONSTANT_ENCAPSED_STRING","'var'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$product_var",115],",",["T_WHITESPACE","\n\t\t\t\t",115],["T_CONSTANT_ENCAPSED_STRING","'sku'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_STRING_CAST","(string)",116],["T_VARIABLE","$item",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","Sku",116],",",["T_WHITESPACE","\n\t\t\t\t",116],["T_CONSTANT_ENCAPSED_STRING","'asin'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_STRING_CAST","(string)",117],["T_VARIABLE","$item",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","Asin",117],",",["T_WHITESPACE","\n\t\t\t\t",117],["T_CONSTANT_ENCAPSED_STRING","'order_item_id'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_STRING_CAST","(string)",118],["T_VARIABLE","$item",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","OrderItemId",118],",",["T_WHITESPACE","\n\t\t\t\t",118],["T_CONSTANT_ENCAPSED_STRING","'name'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_STRING_CAST","(string)",119],["T_VARIABLE","$item",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","Title",119],",",["T_WHITESPACE","\n\t\t\t\t",119],["T_CONSTANT_ENCAPSED_STRING","'model'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_STRING_CAST","(string)",120],["T_VARIABLE","$item",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","Sku",120],",",["T_WHITESPACE","\n\t\t\t\t",120],["T_CONSTANT_ENCAPSED_STRING","'quantity'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_INT_CAST","(int)",121],["T_VARIABLE","$item",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","Ordered",121],",",["T_WHITESPACE","\n\t\t\t\t",121],["T_CONSTANT_ENCAPSED_STRING","'price'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_STRING","sprintf",122],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",122],",",["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$total_price",122],["T_WHITESPACE"," ",122],"-",["T_WHITESPACE"," ",122],["T_VARIABLE","$tax_total",122],")",["T_WHITESPACE"," ",122],"\/",["T_WHITESPACE"," ",122],["T_INT_CAST","(int)",122],["T_VARIABLE","$item",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","Ordered",122],")",",",["T_WHITESPACE","\n\t\t\t\t",122],["T_CONSTANT_ENCAPSED_STRING","'total'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_STRING","sprintf",123],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$total_price",123],["T_WHITESPACE"," ",123],"-",["T_WHITESPACE"," ",123],["T_VARIABLE","$tax_total",123],")",",",["T_WHITESPACE","\n\t\t\t\t",123],["T_CONSTANT_ENCAPSED_STRING","'tax'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$tax_total",124],["T_WHITESPACE"," ",124],"\/",["T_WHITESPACE"," ",124],["T_INT_CAST","(int)",124],["T_VARIABLE","$item",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","Ordered",124],",",["T_WHITESPACE","\n\t\t\t\t",124],["T_CONSTANT_ENCAPSED_STRING","'reward'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'0'",125],",",["T_WHITESPACE","\n\t\t\t\t",125],["T_CONSTANT_ENCAPSED_STRING","'option'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","model_extension_openbay_amazonus_order",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getProductOptionsByVar",126],"(",["T_VARIABLE","$product_var",126],")",",",["T_WHITESPACE","\n\t\t\t\t",126],["T_CONSTANT_ENCAPSED_STRING","'download'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",")",",",["T_WHITESPACE","\n\t\t\t",127],")",";",["T_WHITESPACE","\n\n\t\t\t",128],["T_VARIABLE","$product_mapping",130],"[",["T_STRING_CAST","(string)",130],["T_VARIABLE","$item",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","Sku",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING_CAST","(string)",130],["T_VARIABLE","$item",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","OrderItemId",130],";",["T_WHITESPACE","\n\t\t",130],"}",["T_WHITESPACE","\n\n\t\t",131],["T_VARIABLE","$total",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","sprintf",133],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","currency",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","convert",133],"(",["T_DOUBLE_CAST","(double)",133],["T_VARIABLE","$order_xml",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","Payment",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","Amount",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$order_currency",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$currency_to",133],")",")",";",["T_WHITESPACE","\n\n\t\t",133],["T_VARIABLE","$address_line_2",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING_CAST","(string)",135],["T_VARIABLE","$order_xml",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","Shipping",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","AddressLine2",135],";",["T_WHITESPACE","\n\t\t",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_STRING_CAST","(string)",136],["T_VARIABLE","$order_xml",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","Shipping",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","AddressLine3",136],["T_WHITESPACE"," ",136],["T_IS_NOT_EQUAL","!=",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","''",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n\t\t\t",136],["T_VARIABLE","$address_line_2",137],["T_WHITESPACE"," ",137],["T_CONCAT_EQUAL",".=",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","', '",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_STRING_CAST","(string)",137],["T_VARIABLE","$order_xml",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","Shipping",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","AddressLine3",137],";",["T_WHITESPACE","\n\t\t",137],"}",["T_WHITESPACE","\n\n\t\t",138],["T_VARIABLE","$customer_info",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","db",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","query",140],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT `customer_id` FROM \"",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_STRING","DB_PREFIX",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","\"customer WHERE email = '\"",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","db",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","escape",140],"(",["T_STRING_CAST","(string)",140],["T_VARIABLE","$order_xml",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","Payment",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","Email",140],")",["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","\"'\"",140],")",["T_OBJECT_OPERATOR","->",140],["T_STRING","row",140],";",["T_WHITESPACE","\n\t\t",140],["T_VARIABLE","$customer_id",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'0'",141],";",["T_WHITESPACE","\n\n\t\t",141],["T_IF","if",143],"(",["T_ISSET","isset",143],"(",["T_VARIABLE","$customer_info",143],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",143],"]",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t\t",143],["T_VARIABLE","$customer_id",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$customer_info",144],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",144],"]",";",["T_WHITESPACE","\n\t\t",144],"}",["T_WHITESPACE"," ",145],["T_ELSE","else",145],["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n\t\t\t",145],["T_COMMENT","\/* Add a new customer *\/",146],["T_WHITESPACE","\n\t\t\t",146],["T_VARIABLE","$customer_data",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_ARRAY","array",147],"(",["T_WHITESPACE","\n\t\t\t\t",147],["T_CONSTANT_ENCAPSED_STRING","'firstname'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_STRING_CAST","(string)",148],["T_VARIABLE","$order_xml",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","Shipping",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","Name",148],",",["T_WHITESPACE","\n\t\t\t\t",148],["T_CONSTANT_ENCAPSED_STRING","'lastname'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","''",149],",",["T_WHITESPACE","\n\t\t\t\t",149],["T_CONSTANT_ENCAPSED_STRING","'email'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_STRING_CAST","(string)",150],["T_VARIABLE","$order_xml",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","Payment",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","Email",150],",",["T_WHITESPACE","\n\t\t\t\t",150],["T_CONSTANT_ENCAPSED_STRING","'telephone'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_STRING_CAST","(string)",151],["T_VARIABLE","$order_xml",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","Shipping",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","Phone",151],",",["T_WHITESPACE","\n\t\t\t\t",151],["T_CONSTANT_ENCAPSED_STRING","'fax'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","''",152],",",["T_WHITESPACE","\n\t\t\t\t",152],["T_CONSTANT_ENCAPSED_STRING","'newsletter'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'0'",153],",",["T_WHITESPACE","\n\t\t\t\t",153],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","config",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","get",154],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_customer_group'",154],")",",",["T_WHITESPACE","\n\t\t\t\t",154],["T_CONSTANT_ENCAPSED_STRING","'password'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","''",155],",",["T_WHITESPACE","\n\t\t\t\t",155],["T_CONSTANT_ENCAPSED_STRING","'status'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'0'",156],",",["T_WHITESPACE","\n\t\t\t",156],")",";",["T_WHITESPACE","\n\n\t\t\t",157],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","db",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","query",159],"(",["T_CONSTANT_ENCAPSED_STRING","\"\n\t\t\t\tINSERT INTO \"",159],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_STRING","DB_PREFIX",160],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","\"customer\n\t\t\t\tSET firstname = '\"",160],["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","db",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","escape",161],"(",["T_VARIABLE","$customer_data",161],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",161],"]",")",["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tlastname = '\"",161],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","db",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","escape",162],"(",["T_VARIABLE","$customer_data",162],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",162],"]",")",["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\temail = '\"",162],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","db",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","escape",163],"(",["T_VARIABLE","$customer_data",163],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",163],"]",")",["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\ttelephone = '\"",163],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","db",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","escape",164],"(",["T_VARIABLE","$customer_data",164],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",164],"]",")",["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tfax = '\"",164],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","db",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","escape",165],"(",["T_VARIABLE","$customer_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",165],"]",")",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tnewsletter = '\"",165],["T_WHITESPACE"," ",166],".",["T_WHITESPACE"," ",166],["T_INT_CAST","(int)",166],["T_VARIABLE","$customer_data",166],"[",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",166],"]",["T_WHITESPACE"," ",166],".",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tcustomer_group_id = '\"",166],["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_INT_CAST","(int)",167],["T_VARIABLE","$customer_data",167],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",167],"]",["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tpassword = '',\n\t\t\t\t\tstatus = '\"",167],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_INT_CAST","(int)",169],["T_VARIABLE","$customer_data",169],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",169],"]",["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","\"',\n\t\t\t\t\tdate_added = NOW()\"",169],")",";",["T_WHITESPACE","\n\n\t\t\t",170],["T_VARIABLE","$customer_id",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","db",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getLastId",172],"(",")",";",["T_WHITESPACE","\n\t\t",172],"}",["T_WHITESPACE","\n\n\t\t",173],["T_VARIABLE","$shipping_first_name",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING_CAST","(string)",175],["T_VARIABLE","$order_xml",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","Shipping",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","FirstName",175],";",["T_WHITESPACE","\n\t\t",175],["T_VARIABLE","$shipping_last_name",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING_CAST","(string)",176],["T_VARIABLE","$order_xml",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","Shipping",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","LastName",176],";",["T_WHITESPACE","\n\n\t\t",176],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_EMPTY","empty",178],"(",["T_VARIABLE","$shipping_first_name",178],")",["T_WHITESPACE"," ",178],["T_BOOLEAN_OR","||",178],["T_WHITESPACE"," ",178],["T_EMPTY","empty",178],"(",["T_VARIABLE","$shipping_last_name",178],")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n\t\t\t",178],["T_VARIABLE","$shipping_first_name",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING_CAST","(string)",179],["T_VARIABLE","$order_xml",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","Shipping",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","Name",179],";",["T_WHITESPACE","\n\t\t\t",179],["T_VARIABLE","$shipping_last_name",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","''",180],";",["T_WHITESPACE","\n\t\t",180],"}",["T_WHITESPACE","\n\n\t\t",181],["T_VARIABLE","$order",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_ARRAY","array",183],"(",["T_WHITESPACE","\n\t\t\t",183],["T_CONSTANT_ENCAPSED_STRING","'invoice_prefix'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","config",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","get",184],"(",["T_CONSTANT_ENCAPSED_STRING","'config_invoice_prefix'",184],")",",",["T_WHITESPACE","\n\t\t\t",184],["T_CONSTANT_ENCAPSED_STRING","'store_id'",185],["T_WHITESPACE"," ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","config",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","get",185],"(",["T_CONSTANT_ENCAPSED_STRING","'config_store_id'",185],")",",",["T_WHITESPACE","\n\t\t\t",185],["T_CONSTANT_ENCAPSED_STRING","'store_name'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","config",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","get",186],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",186],")",["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","' \/ Amazon US'",186],",",["T_WHITESPACE","\n\t\t\t",186],["T_CONSTANT_ENCAPSED_STRING","'store_url'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","config",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","get",187],"(",["T_CONSTANT_ENCAPSED_STRING","'config_url'",187],")",",",["T_WHITESPACE","\n\t\t\t",187],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_INT_CAST","(int)",188],["T_VARIABLE","$customer_id",188],",",["T_WHITESPACE","\n\t\t\t",188],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","config",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","get",189],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_order_customer_group'",189],")",",",["T_WHITESPACE","\n\t\t\t",189],["T_CONSTANT_ENCAPSED_STRING","'firstname'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$shipping_first_name",190],",",["T_WHITESPACE","\n\t\t\t",190],["T_CONSTANT_ENCAPSED_STRING","'lastname'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$shipping_last_name",191],",",["T_WHITESPACE","\n\t\t\t",191],["T_CONSTANT_ENCAPSED_STRING","'email'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_STRING_CAST","(string)",192],["T_VARIABLE","$order_xml",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","Payment",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","Email",192],",",["T_WHITESPACE","\n\t\t\t",192],["T_CONSTANT_ENCAPSED_STRING","'telephone'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_STRING_CAST","(string)",193],["T_VARIABLE","$order_xml",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","Shipping",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","Phone",193],",",["T_WHITESPACE","\n\t\t\t",193],["T_CONSTANT_ENCAPSED_STRING","'fax'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","''",194],",",["T_WHITESPACE","\n\t\t\t",194],["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$shipping_first_name",195],",",["T_WHITESPACE","\n\t\t\t",195],["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$shipping_last_name",196],",",["T_WHITESPACE","\n\t\t\t",196],["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","''",197],",",["T_WHITESPACE","\n\t\t\t",197],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_STRING_CAST","(string)",198],["T_VARIABLE","$order_xml",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","Shipping",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","AddressLine1",198],",",["T_WHITESPACE","\n\t\t\t",198],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$address_line_2",199],",",["T_WHITESPACE","\n\t\t\t",199],["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_STRING_CAST","(string)",200],["T_VARIABLE","$order_xml",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","Shipping",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","City",200],",",["T_WHITESPACE","\n\t\t\t",200],["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_STRING_CAST","(string)",201],["T_VARIABLE","$order_xml",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","Shipping",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","PostCode",201],",",["T_WHITESPACE","\n\t\t\t",201],["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","model_extension_openbay_amazonus_order",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getCountryName",202],"(",["T_STRING_CAST","(string)",202],["T_VARIABLE","$order_xml",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","Shipping",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","CountryCode",202],")",",",["T_WHITESPACE","\n\t\t\t",202],["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","model_extension_openbay_amazonus_order",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getCountryId",203],"(",["T_STRING_CAST","(string)",203],["T_VARIABLE","$order_xml",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","Shipping",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","CountryCode",203],")",",",["T_WHITESPACE","\n\t\t\t",203],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_STRING_CAST","(string)",204],["T_VARIABLE","$order_xml",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","Shipping",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","State",204],",",["T_WHITESPACE","\n\t\t\t",204],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","model_extension_openbay_amazonus_order",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getZoneId",205],"(",["T_STRING_CAST","(string)",205],["T_VARIABLE","$order_xml",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","Shipping",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","State",205],")",",",["T_WHITESPACE","\n\t\t\t",205],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","''",206],",",["T_WHITESPACE","\n\t\t\t",206],["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_STRING_CAST","(string)",207],["T_VARIABLE","$order_xml",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","Shipping",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","Type",207],",",["T_WHITESPACE","\n\t\t\t",207],["T_CONSTANT_ENCAPSED_STRING","'shipping_code'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'amazonus.'",208],["T_WHITESPACE"," ",208],".",["T_WHITESPACE"," ",208],["T_STRING_CAST","(string)",208],["T_VARIABLE","$order_xml",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","Shipping",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","Type",208],",",["T_WHITESPACE","\n\t\t\t",208],["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$shipping_first_name",209],",",["T_WHITESPACE","\n\t\t\t",209],["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$shipping_last_name",210],",",["T_WHITESPACE","\n\t\t\t",210],["T_CONSTANT_ENCAPSED_STRING","'payment_company'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","''",211],",",["T_WHITESPACE","\n\t\t\t",211],["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_STRING_CAST","(string)",212],["T_VARIABLE","$order_xml",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","Shipping",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","AddressLine1",212],",",["T_WHITESPACE","\n\t\t\t",212],["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$address_line_2",213],",",["T_WHITESPACE","\n\t\t\t",213],["T_CONSTANT_ENCAPSED_STRING","'payment_city'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_STRING_CAST","(string)",214],["T_VARIABLE","$order_xml",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","Shipping",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","City",214],",",["T_WHITESPACE","\n\t\t\t",214],["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_STRING_CAST","(string)",215],["T_VARIABLE","$order_xml",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","Shipping",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","PostCode",215],",",["T_WHITESPACE","\n\t\t\t",215],["T_CONSTANT_ENCAPSED_STRING","'payment_country'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","model_extension_openbay_amazonus_order",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getCountryName",216],"(",["T_STRING_CAST","(string)",216],["T_VARIABLE","$order_xml",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","Shipping",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","CountryCode",216],")",",",["T_WHITESPACE","\n\t\t\t",216],["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","model_extension_openbay_amazonus_order",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getCountryId",217],"(",["T_STRING_CAST","(string)",217],["T_VARIABLE","$order_xml",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","Shipping",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","CountryCode",217],")",",",["T_WHITESPACE","\n\t\t\t",217],["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_STRING_CAST","(string)",218],["T_VARIABLE","$order_xml",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","Shipping",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","State",218],",",["T_WHITESPACE","\n\t\t\t",218],["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","model_extension_openbay_amazonus_order",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getZoneId",219],"(",["T_STRING_CAST","(string)",219],["T_VARIABLE","$order_xml",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","Shipping",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","State",219],")",",",["T_WHITESPACE","\n\t\t\t",219],["T_CONSTANT_ENCAPSED_STRING","'payment_address_format'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","''",220],",",["T_WHITESPACE","\n\t\t\t",220],["T_CONSTANT_ENCAPSED_STRING","'payment_method'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","language",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","get",221],"(",["T_CONSTANT_ENCAPSED_STRING","'text_paid_amazon'",221],")",",",["T_WHITESPACE","\n\t\t\t",221],["T_CONSTANT_ENCAPSED_STRING","'payment_code'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'amazonus.amazonus'",222],",",["T_WHITESPACE","\n\t\t\t",222],["T_CONSTANT_ENCAPSED_STRING","'payment_company_id'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_LNUMBER","0",223],",",["T_WHITESPACE","\n\t\t\t",223],["T_CONSTANT_ENCAPSED_STRING","'payment_tax_id'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_LNUMBER","0",224],",",["T_WHITESPACE","\n\t\t\t",224],["T_CONSTANT_ENCAPSED_STRING","'comment'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","''",225],",",["T_WHITESPACE","\n\t\t\t",225],["T_CONSTANT_ENCAPSED_STRING","'total'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$total",226],",",["T_WHITESPACE","\n\t\t\t",226],["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'0'",227],",",["T_WHITESPACE","\n\t\t\t",227],["T_CONSTANT_ENCAPSED_STRING","'commission'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'0.00'",228],",",["T_WHITESPACE","\n\t\t\t",228],["T_CONSTANT_ENCAPSED_STRING","'language_id'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_INT_CAST","(int)",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","config",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","get",229],"(",["T_CONSTANT_ENCAPSED_STRING","'config_language_id'",229],")",",",["T_WHITESPACE","\n\t\t\t",229],["T_CONSTANT_ENCAPSED_STRING","'currency_id'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","currency",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getId",230],"(",["T_VARIABLE","$order_currency",230],")",",",["T_WHITESPACE","\n\t\t\t",230],["T_CONSTANT_ENCAPSED_STRING","'currency_code'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_STRING_CAST","(string)",231],["T_VARIABLE","$order_currency",231],",",["T_WHITESPACE","\n\t\t\t",231],["T_CONSTANT_ENCAPSED_STRING","'currency_value'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","currency",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getValue",232],"(",["T_VARIABLE","$order_currency",232],")",",",["T_WHITESPACE","\n\t\t\t",232],["T_CONSTANT_ENCAPSED_STRING","'ip'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","''",233],",",["T_WHITESPACE","\n\t\t\t",233],["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","''",234],",",["T_WHITESPACE","\n\t\t\t",234],["T_CONSTANT_ENCAPSED_STRING","'user_agent'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'OpenBay Pro for Amazon US'",235],",",["T_WHITESPACE","\n\t\t\t",235],["T_CONSTANT_ENCAPSED_STRING","'accept_language'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","''",236],",",["T_WHITESPACE","\n\t\t\t",236],["T_CONSTANT_ENCAPSED_STRING","'products'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$products",237],",",["T_WHITESPACE","\n\t\t\t",237],["T_CONSTANT_ENCAPSED_STRING","'vouchers'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],["T_ARRAY","array",238],"(",")",",",["T_WHITESPACE","\n\t\t\t",238],["T_CONSTANT_ENCAPSED_STRING","'totals'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_ARRAY","array",239],"(",["T_WHITESPACE","\n\t\t\t\t",239],["T_ARRAY","array",240],"(",["T_WHITESPACE","\n\t\t\t\t\t",240],["T_CONSTANT_ENCAPSED_STRING","'code'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'sub_total'",241],",",["T_WHITESPACE","\n\t\t\t\t\t",241],["T_CONSTANT_ENCAPSED_STRING","'title'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","language",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","get",242],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_sub'",242],")",",",["T_WHITESPACE","\n\t\t\t\t\t",242],["T_CONSTANT_ENCAPSED_STRING","'value'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_STRING","sprintf",243],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$products_total",243],")",",",["T_WHITESPACE","\n\t\t\t\t\t",243],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",244],["T_WHITESPACE"," ",244],["T_DOUBLE_ARROW","=>",244],["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","'1'",244],",",["T_WHITESPACE","\n\t\t\t\t",244],")",",",["T_WHITESPACE","\n\t\t\t\t",245],["T_ARRAY","array",246],"(",["T_WHITESPACE","\n\t\t\t\t\t",246],["T_CONSTANT_ENCAPSED_STRING","'code'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'shipping'",247],",",["T_WHITESPACE","\n\t\t\t\t\t",247],["T_CONSTANT_ENCAPSED_STRING","'title'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","language",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","get",248],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_shipping'",248],")",",",["T_WHITESPACE","\n\t\t\t\t\t",248],["T_CONSTANT_ENCAPSED_STRING","'value'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_STRING","sprintf",249],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$products_shipping",249],")",",",["T_WHITESPACE","\n\t\t\t\t\t",249],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",250],["T_WHITESPACE"," ",250],["T_DOUBLE_ARROW","=>",250],["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'3'",250],",",["T_WHITESPACE","\n\t\t\t\t",250],")",",",["T_WHITESPACE","\n\t\t\t\t",251],["T_ARRAY","array",252],"(",["T_WHITESPACE","\n\t\t\t\t\t",252],["T_CONSTANT_ENCAPSED_STRING","'code'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'tax'",253],",",["T_WHITESPACE","\n\t\t\t\t\t",253],["T_CONSTANT_ENCAPSED_STRING","'title'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","language",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","get",254],"(",["T_CONSTANT_ENCAPSED_STRING","'text_tax'",254],")",",",["T_WHITESPACE","\n\t\t\t\t\t",254],["T_CONSTANT_ENCAPSED_STRING","'value'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_STRING","sprintf",255],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$products_tax",255],")",",",["T_WHITESPACE","\n\t\t\t\t\t",255],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'4'",256],",",["T_WHITESPACE","\n\t\t\t\t",256],")",",",["T_WHITESPACE","\n\t\t\t\t",257],["T_ARRAY","array",258],"(",["T_WHITESPACE","\n\t\t\t\t\t",258],["T_CONSTANT_ENCAPSED_STRING","'code'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax'",259],",",["T_WHITESPACE","\n\t\t\t\t\t",259],["T_CONSTANT_ENCAPSED_STRING","'title'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","language",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","get",260],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_shipping_tax'",260],")",",",["T_WHITESPACE","\n\t\t\t\t\t",260],["T_CONSTANT_ENCAPSED_STRING","'value'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_STRING","sprintf",261],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$products_shipping_tax",261],")",",",["T_WHITESPACE","\n\t\t\t\t\t",261],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'6'",262],",",["T_WHITESPACE","\n\t\t\t\t",262],")",",",["T_WHITESPACE","\n\t\t\t\t",263],["T_ARRAY","array",264],"(",["T_WHITESPACE","\n\t\t\t\t\t",264],["T_CONSTANT_ENCAPSED_STRING","'code'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'gift_wrap'",265],",",["T_WHITESPACE","\n\t\t\t\t\t",265],["T_CONSTANT_ENCAPSED_STRING","'title'",266],["T_WHITESPACE"," ",266],["T_DOUBLE_ARROW","=>",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","language",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","get",266],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_giftwrap'",266],")",",",["T_WHITESPACE","\n\t\t\t\t\t",266],["T_CONSTANT_ENCAPSED_STRING","'value'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_STRING","sprintf",267],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$gift_wrap",267],")",",",["T_WHITESPACE","\n\t\t\t\t\t",267],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",268],["T_WHITESPACE"," ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_CONSTANT_ENCAPSED_STRING","'2'",268],",",["T_WHITESPACE","\n\t\t\t\t",268],")",",",["T_WHITESPACE","\n\t\t\t\t",269],["T_ARRAY","array",270],"(",["T_WHITESPACE","\n\t\t\t\t\t",270],["T_CONSTANT_ENCAPSED_STRING","'code'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_CONSTANT_ENCAPSED_STRING","'gift_wrap_tax'",271],",",["T_WHITESPACE","\n\t\t\t\t\t",271],["T_CONSTANT_ENCAPSED_STRING","'title'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","language",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","get",272],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total_giftwrap_tax'",272],")",",",["T_WHITESPACE","\n\t\t\t\t\t",272],["T_CONSTANT_ENCAPSED_STRING","'value'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_STRING","sprintf",273],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$gift_wrap_tax",273],")",",",["T_WHITESPACE","\n\t\t\t\t\t",273],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",274],["T_WHITESPACE"," ",274],["T_DOUBLE_ARROW","=>",274],["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'5'",274],",",["T_WHITESPACE","\n\t\t\t\t",274],")",",",["T_WHITESPACE","\n\t\t\t\t",275],["T_ARRAY","array",276],"(",["T_WHITESPACE","\n\t\t\t\t\t",276],["T_CONSTANT_ENCAPSED_STRING","'code'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","'total'",277],",",["T_WHITESPACE","\n\t\t\t\t\t",277],["T_CONSTANT_ENCAPSED_STRING","'title'",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","language",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","get",278],"(",["T_CONSTANT_ENCAPSED_STRING","'text_total'",278],")",",",["T_WHITESPACE","\n\t\t\t\t\t",278],["T_CONSTANT_ENCAPSED_STRING","'value'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_STRING","sprintf",279],"(",["T_CONSTANT_ENCAPSED_STRING","'%.4f'",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$total",279],")",",",["T_WHITESPACE","\n\t\t\t\t\t",279],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'7'",280],",",["T_WHITESPACE","\n\t\t\t\t",280],")",",",["T_WHITESPACE","\n\t\t\t",281],")",",",["T_WHITESPACE","\n\t\t",282],")",";",["T_WHITESPACE","\n\n\t\t",283],["T_VARIABLE","$order_id",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","model_checkout_order",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","addOrder",285],"(",["T_VARIABLE","$order",285],")",";",["T_WHITESPACE","\n\n\t\t",285],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","model_extension_openbay_amazonus_order",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","updateOrderStatus",287],"(",["T_VARIABLE","$order_id",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$order_status",287],")",";",["T_WHITESPACE","\n\t\t",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","model_extension_openbay_amazonus_order",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","addAmazonusOrder",288],"(",["T_VARIABLE","$order_id",288],",",["T_WHITESPACE"," ",288],["T_VARIABLE","$amazonus_order_id",288],")",";",["T_WHITESPACE","\n\t\t",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","model_extension_openbay_amazonus_order",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","addAmazonusOrderProducts",289],"(",["T_VARIABLE","$order_id",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$product_mapping",289],")",";",["T_WHITESPACE","\n\n\t\t",289],["T_FOREACH","foreach",291],"(",["T_VARIABLE","$products",291],["T_WHITESPACE"," ",291],["T_AS","as",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$product",291],")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n\t\t\t",291],["T_IF","if",292],"(",["T_VARIABLE","$product",292],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",292],"]",["T_WHITESPACE"," ",292],["T_IS_NOT_EQUAL","!=",292],["T_WHITESPACE"," ",292],["T_LNUMBER","0",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n\t\t\t\t",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","model_extension_openbay_amazonus_order",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","decreaseProductQuantity",293],"(",["T_VARIABLE","$product",293],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",293],"]",",",["T_WHITESPACE"," ",293],["T_VARIABLE","$product",293],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",293],"]",",",["T_WHITESPACE"," ",293],["T_VARIABLE","$product",293],"[",["T_CONSTANT_ENCAPSED_STRING","'var'",293],"]",")",";",["T_WHITESPACE","\n\t\t\t",293],"}",["T_WHITESPACE","\n\t\t",294],"}",["T_WHITESPACE","\n\n\t\t",295],["T_VARIABLE","$logger",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","write",297],"(",["T_CONSTANT_ENCAPSED_STRING","'Order '",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_VARIABLE","$amazonus_order_id",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","' was added to the database (ID: '",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_VARIABLE","$order_id",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","')'",297],")",";",["T_WHITESPACE","\n\t\t",297],["T_VARIABLE","$logger",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","write",298],"(",["T_CONSTANT_ENCAPSED_STRING","\"Finished processing the order\"",298],")",";",["T_WHITESPACE","\n\n\t\t",298],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","model_extension_openbay_amazonus_order",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","acknowledgeOrder",300],"(",["T_VARIABLE","$order_id",300],")",";",["T_WHITESPACE","\n\n\t\t",300],["T_COMMENT","\/\/send an email to the administrator about the sale\n",302],["T_WHITESPACE","\t\t",303],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","config",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","get",303],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_notify_admin'",303],")",["T_WHITESPACE"," ",303],["T_IS_EQUAL","==",303],["T_WHITESPACE"," ",303],["T_LNUMBER","1",303],")","{",["T_WHITESPACE","\n\t\t\t",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","openbay",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","newOrderAdminNotify",304],"(",["T_VARIABLE","$order_id",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$order_status",304],")",";",["T_WHITESPACE","\n\t\t",304],"}",["T_WHITESPACE","\n\t\t\n\t\t",305],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","event",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","trigger",307],"(",["T_CONSTANT_ENCAPSED_STRING","'model\/checkout\/order\/addOrderHistory\/after'",307],",",["T_WHITESPACE"," ",307],["T_ARRAY","array",307],"(",["T_CONSTANT_ENCAPSED_STRING","'model\/checkout\/order\/addOrderHistory\/after'",307],",",["T_WHITESPACE"," ",307],["T_ARRAY","array",307],"(",["T_VARIABLE","$order_id",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$order_status",307],")",")",")",";",["T_WHITESPACE","\n\n\t\t",307],["T_VARIABLE","$logger",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","write",309],"(",["T_CONSTANT_ENCAPSED_STRING","\"Ok\"",309],")",";",["T_WHITESPACE","\n\t\t",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","response",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","setOutput",310],"(",["T_CONSTANT_ENCAPSED_STRING","'Ok'",310],")",";",["T_WHITESPACE","\n\t",310],"}",["T_WHITESPACE","\n\n\t",311],["T_PUBLIC","public",313],["T_WHITESPACE"," ",313],["T_FUNCTION","function",313],["T_WHITESPACE"," ",313],["T_STRING","listing",313],"(",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n\t\t",313],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","config",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","get",314],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_status'",314],")",["T_WHITESPACE"," ",314],["T_IS_NOT_EQUAL","!=",314],["T_WHITESPACE"," ",314],["T_CONSTANT_ENCAPSED_STRING","'1'",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n\t\t\t",314],["T_RETURN","return",315],";",["T_WHITESPACE","\n\t\t",315],"}",["T_WHITESPACE","\n\n\t\t",316],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","load",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","model",318],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_listing'",318],")",";",["T_WHITESPACE","\n\t\t",318],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","load",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","model",319],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_product'",319],")",";",["T_WHITESPACE","\n\n\t\t",319],["T_VARIABLE","$logger",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_NEW","new",321],["T_WHITESPACE"," ",321],["T_STRING","Log",321],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus_listing.log'",321],")",";",["T_WHITESPACE","\n\t\t",321],["T_VARIABLE","$logger",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","write",322],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/listing - started'",322],")",";",["T_WHITESPACE","\n\n\t\t",322],["T_VARIABLE","$incoming_token",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_ISSET","isset",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","request",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","post",324],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",324],"]",")",["T_WHITESPACE"," ",324],"?",["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","request",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","post",324],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",324],"]",["T_WHITESPACE"," ",324],":",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","''",324],";",["T_WHITESPACE","\n\n\t\t",324],["T_IF","if",326],["T_WHITESPACE"," ",326],"(","!",["T_STRING","hash_equals",326],"(",["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","config",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","get",326],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_token'",326],")",",",["T_WHITESPACE"," ",326],["T_VARIABLE","$incoming_token",326],")",")",["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n\t\t\t",326],["T_VARIABLE","$logger",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","write",327],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/listing - Incorrect token: '",327],["T_WHITESPACE"," ",327],".",["T_WHITESPACE"," ",327],["T_VARIABLE","$incoming_token",327],")",";",["T_WHITESPACE","\n\t\t\t",327],["T_RETURN","return",328],";",["T_WHITESPACE","\n\t\t",328],"}",["T_WHITESPACE","\n\n\t\t",329],["T_VARIABLE","$decrypted",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","openbay",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","amazonus",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","decryptArgs",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","request",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","post",331],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",331],"]",")",";",["T_WHITESPACE","\n\n\t\t",331],["T_IF","if",333],["T_WHITESPACE"," ",333],"(","!",["T_VARIABLE","$decrypted",333],")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n\t\t\t",333],["T_VARIABLE","$logger",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","write",334],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/order Failed to decrypt data'",334],")",";",["T_WHITESPACE","\n\t\t\t",334],["T_RETURN","return",335],";",["T_WHITESPACE","\n\t\t",335],"}",["T_WHITESPACE","\n\n\t\t",336],["T_VARIABLE","$data",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_STRING","json_decode",338],"(",["T_VARIABLE","$decrypted",338],",",["T_WHITESPACE"," ",338],["T_LNUMBER","1",338],")",";",["T_WHITESPACE","\n\n\t\t",338],["T_VARIABLE","$logger",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","write",340],"(",["T_CONSTANT_ENCAPSED_STRING","\"Received data: \"",340],["T_WHITESPACE"," ",340],".",["T_WHITESPACE"," ",340],["T_STRING","print_r",340],"(",["T_VARIABLE","$data",340],",",["T_WHITESPACE"," ",340],["T_LNUMBER","1",340],")",")",";",["T_WHITESPACE","\n\n\t\t",340],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$data",342],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",342],"]",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n\t\t\t",342],["T_VARIABLE","$logger",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","write",343],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updating \"",343],["T_WHITESPACE"," ",343],".",["T_WHITESPACE"," ",343],["T_VARIABLE","$data",343],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",343],"]",["T_WHITESPACE"," ",343],".",["T_WHITESPACE"," ",343],["T_CONSTANT_ENCAPSED_STRING","' as successful'",343],")",";",["T_WHITESPACE","\n\t\t\t",343],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","model_extension_openbay_amazonus_listing",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","listingSuccessful",344],"(",["T_VARIABLE","$data",344],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",344],"]",")",";",["T_WHITESPACE","\n\t\t\t",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","model_extension_openbay_amazonus_product",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","linkProduct",345],"(",["T_VARIABLE","$data",345],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",345],"]",",",["T_WHITESPACE"," ",345],["T_VARIABLE","$data",345],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",345],"]",")",";",["T_WHITESPACE","\n\t\t\t",345],["T_VARIABLE","$logger",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","write",346],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updated successfully\"",346],")",";",["T_WHITESPACE","\n\t\t",346],"}",["T_WHITESPACE"," ",347],["T_ELSE","else",347],["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n\t\t\t",347],["T_VARIABLE","$logger",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","write",348],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updating \"",348],["T_WHITESPACE"," ",348],".",["T_WHITESPACE"," ",348],["T_VARIABLE","$data",348],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",348],"]",["T_WHITESPACE"," ",348],".",["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","' as failed'",348],")",";",["T_WHITESPACE","\n\t\t\t",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","model_extension_openbay_amazonus_listing",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","listingFailed",349],"(",["T_VARIABLE","$data",349],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",349],"]",",",["T_WHITESPACE"," ",349],["T_VARIABLE","$data",349],"[",["T_CONSTANT_ENCAPSED_STRING","'messages'",349],"]",")",";",["T_WHITESPACE","\n\t\t\t",349],["T_VARIABLE","$logger",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","write",350],"(",["T_CONSTANT_ENCAPSED_STRING","\"Updated successfully\"",350],")",";",["T_WHITESPACE","\n\t\t",350],"}",["T_WHITESPACE","\n\t",351],"}",["T_WHITESPACE","\n\n\t",352],["T_PUBLIC","public",354],["T_WHITESPACE"," ",354],["T_FUNCTION","function",354],["T_WHITESPACE"," ",354],["T_STRING","listingReport",354],"(",")",["T_WHITESPACE"," ",354],"{",["T_WHITESPACE","\n\t\t",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","config",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","get",355],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_status'",355],")",["T_WHITESPACE"," ",355],["T_IS_NOT_EQUAL","!=",355],["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'1'",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n\t\t\t",355],["T_RETURN","return",356],";",["T_WHITESPACE","\n\t\t",356],"}",["T_WHITESPACE","\n\n\t\t",357],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","load",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","model",359],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_product'",359],")",";",["T_WHITESPACE","\n\n\t\t",359],["T_VARIABLE","$logger",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_NEW","new",361],["T_WHITESPACE"," ",361],["T_STRING","Log",361],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus.log'",361],")",";",["T_WHITESPACE","\n\t\t",361],["T_VARIABLE","$logger",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","write",362],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/listing_reports - started'",362],")",";",["T_WHITESPACE","\n\n\t\t",362],["T_VARIABLE","$incoming_token",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_ISSET","isset",364],"(",["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","request",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","post",364],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",364],"]",")",["T_WHITESPACE"," ",364],"?",["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","request",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","post",364],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",364],"]",["T_WHITESPACE"," ",364],":",["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","''",364],";",["T_WHITESPACE","\n\n\t\t",364],["T_IF","if",366],["T_WHITESPACE"," ",366],"(","!",["T_STRING","hash_equals",366],"(",["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","config",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","get",366],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_token'",366],")",",",["T_WHITESPACE"," ",366],["T_VARIABLE","$incoming_token",366],")",")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n\t\t\t",366],["T_VARIABLE","$logger",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","write",367],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/listing_reports - Incorrect token: '",367],["T_WHITESPACE"," ",367],".",["T_WHITESPACE"," ",367],["T_VARIABLE","$incoming_token",367],")",";",["T_WHITESPACE","\n\t\t\t",367],["T_RETURN","return",368],";",["T_WHITESPACE","\n\t\t",368],"}",["T_WHITESPACE","\n\n\t\t",369],["T_VARIABLE","$decrypted",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","openbay",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","amazonus",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","decryptArgs",371],"(",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","request",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","post",371],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",371],"]",")",";",["T_WHITESPACE","\n\n\t\t",371],["T_IF","if",373],["T_WHITESPACE"," ",373],"(","!",["T_VARIABLE","$decrypted",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n\t\t\t",373],["T_VARIABLE","$logger",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","write",374],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/listing_reports - Failed to decrypt data'",374],")",";",["T_WHITESPACE","\n\t\t\t",374],["T_RETURN","return",375],";",["T_WHITESPACE","\n\t\t",375],"}",["T_WHITESPACE","\n\n\t\t",376],["T_VARIABLE","$logger",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","write",378],"(",["T_CONSTANT_ENCAPSED_STRING","'Received Listing Report: '",378],["T_WHITESPACE"," ",378],".",["T_WHITESPACE"," ",378],["T_VARIABLE","$decrypted",378],")",";",["T_WHITESPACE","\n\n\t\t",378],["T_VARIABLE","$request",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_STRING","json_decode",380],"(",["T_VARIABLE","$decrypted",380],",",["T_WHITESPACE"," ",380],["T_LNUMBER","1",380],")",";",["T_WHITESPACE","\n\n\t\t",380],["T_VARIABLE","$data",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_ARRAY","array",382],"(",")",";",["T_WHITESPACE","\n\n\t\t",382],["T_FOREACH","foreach",384],["T_WHITESPACE"," ",384],"(",["T_VARIABLE","$request",384],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",384],"]",["T_WHITESPACE"," ",384],["T_AS","as",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$product",384],")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n\t\t\t",384],["T_VARIABLE","$data",385],"[","]",["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_ARRAY","array",385],"(",["T_WHITESPACE","\n\t\t\t\t",385],["T_CONSTANT_ENCAPSED_STRING","'sku'",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$product",386],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",386],"]",",",["T_WHITESPACE","\n\t\t\t\t",386],["T_CONSTANT_ENCAPSED_STRING","'quantity'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$product",387],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",387],"]",",",["T_WHITESPACE","\n\t\t\t\t",387],["T_CONSTANT_ENCAPSED_STRING","'asin'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$product",388],"[",["T_CONSTANT_ENCAPSED_STRING","'asin'",388],"]",",",["T_WHITESPACE","\n\t\t\t\t",388],["T_CONSTANT_ENCAPSED_STRING","'price'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$product",389],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",389],"]",",",["T_WHITESPACE","\n\t\t\t",389],")",";",["T_WHITESPACE","\n\t\t",390],"}",["T_WHITESPACE","\n\n\t\t",391],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$data",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n\t\t\t",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","model_extension_openbay_amazonus_product",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","addListingReport",394],"(",["T_VARIABLE","$data",394],")",";",["T_WHITESPACE","\n\t\t",394],"}",["T_WHITESPACE","\n\n\t\t",395],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","model_extension_openbay_amazonus_product",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","removeListingReportLock",397],"(",["T_VARIABLE","$request",397],"[",["T_CONSTANT_ENCAPSED_STRING","'marketplace'",397],"]",")",";",["T_WHITESPACE","\n\n\t\t",397],["T_VARIABLE","$logger",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","write",399],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/listing_reports - Finished'",399],")",";",["T_WHITESPACE","\n\t",399],"}",["T_WHITESPACE","\n\n\t",400],["T_PUBLIC","public",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","product",402],"(",")",["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n\t\t",402],["T_IF","if",403],["T_WHITESPACE"," ",403],"(",["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","config",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","get",403],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_status'",403],")",["T_WHITESPACE"," ",403],["T_IS_NOT_EQUAL","!=",403],["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","'1'",403],")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n\t\t\t",403],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","response",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","setOutput",404],"(",["T_CONSTANT_ENCAPSED_STRING","\"disabled\"",404],")",";",["T_WHITESPACE","\n\t\t\t",404],["T_RETURN","return",405],";",["T_WHITESPACE","\n\t\t",405],"}",["T_WHITESPACE","\n\n\t\t",406],["T_STRING","ob_start",408],"(",")",";",["T_WHITESPACE","\n\n\t\t",408],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","load",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","model",410],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_product'",410],")",";",["T_WHITESPACE","\n\t\t",410],["T_VARIABLE","$logger",411],["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_NEW","new",411],["T_WHITESPACE"," ",411],["T_STRING","Log",411],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus_product.log'",411],")",";",["T_WHITESPACE","\n\n\t\t",411],["T_VARIABLE","$logger",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","write",413],"(",["T_CONSTANT_ENCAPSED_STRING","\"AmazonusProduct\/inbound: incoming data\"",413],")",";",["T_WHITESPACE","\n\n\t\t",413],["T_VARIABLE","$incoming_token",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_ISSET","isset",415],"(",["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","request",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","post",415],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",415],"]",")",["T_WHITESPACE"," ",415],"?",["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","request",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","post",415],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",415],"]",["T_WHITESPACE"," ",415],":",["T_WHITESPACE"," ",415],["T_CONSTANT_ENCAPSED_STRING","''",415],";",["T_WHITESPACE","\n\n\t\t",415],["T_IF","if",417],"(",["T_VARIABLE","$incoming_token",417],["T_WHITESPACE"," ",417],["T_IS_NOT_EQUAL","!=",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","config",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","get",417],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_token'",417],")",")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n\t\t\t",417],["T_VARIABLE","$logger",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","write",418],"(",["T_CONSTANT_ENCAPSED_STRING","\"Error - Incorrect token: \"",418],["T_WHITESPACE"," ",418],".",["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","request",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","post",418],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",418],"]",")",";",["T_WHITESPACE","\n\t\t\t",418],["T_STRING","ob_get_clean",419],"(",")",";",["T_WHITESPACE","\n\t\t\t",419],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","response",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","setOutput",420],"(",["T_CONSTANT_ENCAPSED_STRING","\"tokens did not match\"",420],")",";",["T_WHITESPACE","\n\t\t\t",420],["T_RETURN","return",421],";",["T_WHITESPACE","\n\t\t",421],"}",["T_WHITESPACE","\n\n\t\t",422],["T_VARIABLE","$data",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","openbay",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","amazonus",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","decryptArgs",424],"(",["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","request",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","post",424],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",424],"]",")",";",["T_WHITESPACE","\n\t\t",424],["T_IF","if",425],"(","!",["T_VARIABLE","$data",425],")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n\t\t\t",425],["T_VARIABLE","$logger",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","write",426],"(",["T_CONSTANT_ENCAPSED_STRING","\"Error - Failed to decrypt received data.\"",426],")",";",["T_WHITESPACE","\n\t\t\t",426],["T_STRING","ob_get_clean",427],"(",")",";",["T_WHITESPACE","\n\t\t\t",427],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","response",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","setOutput",428],"(",["T_CONSTANT_ENCAPSED_STRING","\"failed to decrypt\"",428],")",";",["T_WHITESPACE","\n\t\t\t",428],["T_RETURN","return",429],";",["T_WHITESPACE","\n\t\t",429],"}",["T_WHITESPACE","\n\n\t\t",430],["T_VARIABLE","$decoded_data",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_ARRAY_CAST","(array)",432],["T_STRING","json_decode",432],"(",["T_VARIABLE","$data",432],")",";",["T_WHITESPACE","\n\t\t",432],["T_VARIABLE","$logger",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","write",433],"(",["T_CONSTANT_ENCAPSED_STRING","\"Received data: \"",433],["T_WHITESPACE"," ",433],".",["T_WHITESPACE"," ",433],["T_STRING","print_r",433],"(",["T_VARIABLE","$decoded_data",433],",",["T_WHITESPACE"," ",433],["T_STRING","true",433],")",")",";",["T_WHITESPACE","\n\t\t",433],["T_VARIABLE","$status",434],["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_VARIABLE","$decoded_data",434],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",434],"]",";",["T_WHITESPACE","\n\n\t\t",434],["T_IF","if",436],"(",["T_VARIABLE","$status",436],["T_WHITESPACE"," ",436],["T_IS_EQUAL","==",436],["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","\"submit_error\"",436],")",["T_WHITESPACE"," ",436],"{",["T_WHITESPACE","\n\t\t\t",436],["T_VARIABLE","$message",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","'Product was not submited to amazonus properly. Please try again or contact OpenBay.'",437],";",["T_WHITESPACE","\n\t\t\t",437],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","model_extension_openbay_amazonus_product",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","setSubmitError",438],"(",["T_VARIABLE","$decoded_data",438],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",438],"]",",",["T_WHITESPACE"," ",438],["T_VARIABLE","$message",438],")",";",["T_WHITESPACE","\n\t\t",438],"}",["T_WHITESPACE"," ",439],["T_ELSE","else",439],["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n\t\t\t",439],["T_VARIABLE","$status",440],["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_ARRAY_CAST","(array)",440],["T_VARIABLE","$status",440],";",["T_WHITESPACE","\n\t\t\t",440],["T_IF","if",441],"(",["T_VARIABLE","$status",441],"[",["T_CONSTANT_ENCAPSED_STRING","'successful'",441],"]",["T_WHITESPACE"," ",441],["T_IS_EQUAL","==",441],["T_WHITESPACE"," ",441],["T_LNUMBER","1",441],")",["T_WHITESPACE"," ",441],"{",["T_WHITESPACE","\n\t\t\t\t",441],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","model_extension_openbay_amazonus_product",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","setStatus",442],"(",["T_VARIABLE","$decoded_data",442],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",442],"]",",",["T_WHITESPACE"," ",442],["T_CONSTANT_ENCAPSED_STRING","'ok'",442],")",";",["T_WHITESPACE","\n\t\t\t\t",442],["T_VARIABLE","$insertion_product",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","model_extension_openbay_amazonus_product",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","getProduct",443],"(",["T_VARIABLE","$decoded_data",443],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",443],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",443],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","model_extension_openbay_amazonus_product",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","linkProduct",444],"(",["T_VARIABLE","$insertion_product",444],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",444],"]",",",["T_WHITESPACE"," ",444],["T_VARIABLE","$insertion_product",444],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",444],"]",",",["T_WHITESPACE"," ",444],["T_VARIABLE","$insertion_product",444],"[",["T_CONSTANT_ENCAPSED_STRING","'var'",444],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","model_extension_openbay_amazonus_product",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","deleteErrors",445],"(",["T_VARIABLE","$decoded_data",445],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",445],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",445],["T_VARIABLE","$quantity_data",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_ARRAY","array",447],"(",["T_WHITESPACE","\n\t\t\t\t\t",447],["T_VARIABLE","$insertion_product",448],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",448],"]",["T_WHITESPACE"," ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","model_extension_openbay_amazonus_product",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","getProductQuantity",448],"(",["T_VARIABLE","$insertion_product",448],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",448],"]",",",["T_WHITESPACE"," ",448],["T_VARIABLE","$insertion_product",448],"[",["T_CONSTANT_ENCAPSED_STRING","'var'",448],"]",")",["T_WHITESPACE","\n\t\t\t\t",448],")",";",["T_WHITESPACE","\n\t\t\t\t",449],["T_VARIABLE","$logger",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","write",450],"(",["T_CONSTANT_ENCAPSED_STRING","'Updating quantity with data: '",450],["T_WHITESPACE"," ",450],".",["T_WHITESPACE"," ",450],["T_STRING","print_r",450],"(",["T_VARIABLE","$quantity_data",450],",",["T_WHITESPACE"," ",450],["T_STRING","true",450],")",")",";",["T_WHITESPACE","\n\t\t\t\t",450],["T_VARIABLE","$logger",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","write",451],"(",["T_CONSTANT_ENCAPSED_STRING","'Response: '",451],["T_WHITESPACE"," ",451],".",["T_WHITESPACE"," ",451],["T_STRING","print_r",451],"(",["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","openbay",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","amazonus",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","updateQuantities",451],"(",["T_VARIABLE","$quantity_data",451],")",",",["T_WHITESPACE"," ",451],["T_STRING","true",451],")",")",";",["T_WHITESPACE","\n\t\t\t",451],"}",["T_WHITESPACE"," ",452],["T_ELSE","else",452],["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n\t\t\t\t",452],["T_VARIABLE","$msg",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","'Product was not accepted by amazonus. Please try again or contact OpenBay.'",453],";",["T_WHITESPACE","\n\t\t\t\t",453],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","model_extension_openbay_amazonus_product",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","setSubmitError",454],"(",["T_VARIABLE","$decoded_data",454],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",454],"]",",",["T_WHITESPACE"," ",454],["T_VARIABLE","$msg",454],")",";",["T_WHITESPACE","\n\n\t\t\t\t",454],["T_IF","if",456],"(",["T_ISSET","isset",456],"(",["T_VARIABLE","$decoded_data",456],"[",["T_CONSTANT_ENCAPSED_STRING","'error_details'",456],"]",")",")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n\t\t\t\t\t",456],["T_FOREACH","foreach",457],"(",["T_VARIABLE","$decoded_data",457],"[",["T_CONSTANT_ENCAPSED_STRING","'error_details'",457],"]",["T_WHITESPACE"," ",457],["T_AS","as",457],["T_WHITESPACE"," ",457],["T_VARIABLE","$error",457],")",["T_WHITESPACE"," ",457],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",457],["T_VARIABLE","$error",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_ARRAY_CAST","(array)",458],["T_VARIABLE","$error",458],";",["T_WHITESPACE","\n\t\t\t\t\t\t",458],["T_VARIABLE","$error_data",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_ARRAY","array",459],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",459],["T_CONSTANT_ENCAPSED_STRING","'sku'",460],["T_WHITESPACE"," ",460],["T_DOUBLE_ARROW","=>",460],["T_WHITESPACE"," ",460],["T_VARIABLE","$error",460],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",460],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",460],["T_CONSTANT_ENCAPSED_STRING","'error_code'",461],["T_WHITESPACE"," ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$error",461],"[",["T_CONSTANT_ENCAPSED_STRING","'error_code'",461],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",461],["T_CONSTANT_ENCAPSED_STRING","'message'",462],["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$error",462],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",462],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",462],["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$decoded_data",463],"[",["T_CONSTANT_ENCAPSED_STRING","'insertion_id'",463],"]",["T_WHITESPACE","\n\t\t\t\t\t\t",463],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",464],["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","model_extension_openbay_amazonus_product",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","insertError",465],"(",["T_VARIABLE","$error_data",465],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",465],"}",["T_WHITESPACE","\n\t\t\t\t",467],"}",["T_WHITESPACE","\n\t\t\t",468],"}",["T_WHITESPACE","\n\t\t",469],"}",["T_WHITESPACE","\n\n\t\t",470],["T_VARIABLE","$logger",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","write",472],"(",["T_CONSTANT_ENCAPSED_STRING","\"Data processed successfully.\"",472],")",";",["T_WHITESPACE","\n\t\t",472],["T_STRING","ob_get_clean",473],"(",")",";",["T_WHITESPACE","\n\t\t",473],["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","response",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","setOutput",474],"(",["T_CONSTANT_ENCAPSED_STRING","\"ok\"",474],")",";",["T_WHITESPACE","\n\t",474],"}",["T_WHITESPACE","\n\n\t",475],["T_PUBLIC","public",477],["T_WHITESPACE"," ",477],["T_FUNCTION","function",477],["T_WHITESPACE"," ",477],["T_STRING","search",477],"(",")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n\t\t",477],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","config",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","get",478],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_status'",478],")",["T_WHITESPACE"," ",478],["T_IS_NOT_EQUAL","!=",478],["T_WHITESPACE"," ",478],["T_CONSTANT_ENCAPSED_STRING","'1'",478],")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n\t\t\t",478],["T_RETURN","return",479],";",["T_WHITESPACE","\n\t\t",479],"}",["T_WHITESPACE","\n\n\t\t",480],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","load",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","model",482],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_product'",482],")",";",["T_WHITESPACE","\n\n\t\t",482],["T_VARIABLE","$logger",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_NEW","new",484],["T_WHITESPACE"," ",484],["T_STRING","Log",484],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus.log'",484],")",";",["T_WHITESPACE","\n\t\t",484],["T_VARIABLE","$logger",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","write",485],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/search - started'",485],")",";",["T_WHITESPACE","\n\n\t\t",485],["T_VARIABLE","$incoming_token",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_ISSET","isset",487],"(",["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","request",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","post",487],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",487],"]",")",["T_WHITESPACE"," ",487],"?",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","request",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","post",487],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",487],"]",["T_WHITESPACE"," ",487],":",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","''",487],";",["T_WHITESPACE","\n\n\t\t",487],["T_IF","if",489],["T_WHITESPACE"," ",489],"(","!",["T_STRING","hash_equals",489],"(",["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","config",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","get",489],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_token'",489],")",",",["T_WHITESPACE"," ",489],["T_VARIABLE","$incoming_token",489],")",")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n\t\t\t",489],["T_VARIABLE","$logger",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","write",490],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/search - Incorrect token: '",490],["T_WHITESPACE"," ",490],".",["T_WHITESPACE"," ",490],["T_VARIABLE","$incoming_token",490],")",";",["T_WHITESPACE","\n\t\t\t",490],["T_RETURN","return",491],";",["T_WHITESPACE","\n\t\t",491],"}",["T_WHITESPACE","\n\n\t\t",492],["T_VARIABLE","$decrypted",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","openbay",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","amazonus",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","decryptArgs",494],"(",["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","request",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","post",494],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",494],"]",")",";",["T_WHITESPACE","\n\n\t\t",494],["T_IF","if",496],["T_WHITESPACE"," ",496],"(","!",["T_VARIABLE","$decrypted",496],")",["T_WHITESPACE"," ",496],"{",["T_WHITESPACE","\n\t\t\t",496],["T_VARIABLE","$logger",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","write",497],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus\/search Failed to decrypt data'",497],")",";",["T_WHITESPACE","\n\t\t\t",497],["T_RETURN","return",498],";",["T_WHITESPACE","\n\t\t",498],"}",["T_WHITESPACE","\n\n\t\t",499],["T_VARIABLE","$logger",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","write",501],"(",["T_VARIABLE","$decrypted",501],")",";",["T_WHITESPACE","\n\n\t\t",501],["T_VARIABLE","$json",503],["T_WHITESPACE"," ",503],"=",["T_WHITESPACE"," ",503],["T_STRING","json_decode",503],"(",["T_VARIABLE","$decrypted",503],",",["T_WHITESPACE"," ",503],["T_LNUMBER","1",503],")",";",["T_WHITESPACE","\n\n\t\t",503],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","model_extension_openbay_amazonus_product",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","updateSearch",505],"(",["T_VARIABLE","$json",505],")",";",["T_WHITESPACE","\n\t",505],"}",["T_WHITESPACE","\n\n\t",506],["T_PUBLIC","public",508],["T_WHITESPACE"," ",508],["T_FUNCTION","function",508],["T_WHITESPACE"," ",508],["T_STRING","dev",508],"(",")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n\t\t",508],["T_IF","if",509],["T_WHITESPACE"," ",509],"(",["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","config",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","get",509],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_status'",509],")",["T_WHITESPACE"," ",509],["T_IS_NOT_EQUAL","!=",509],["T_WHITESPACE"," ",509],["T_CONSTANT_ENCAPSED_STRING","'1'",509],")",["T_WHITESPACE"," ",509],"{",["T_WHITESPACE","\n\t\t\t",509],["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","response",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","setOutput",510],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 001\"",510],")",";",["T_WHITESPACE","\n\t\t\t",510],["T_RETURN","return",511],";",["T_WHITESPACE","\n\t\t",511],"}",["T_WHITESPACE","\n\n\t\t",512],["T_VARIABLE","$incoming_token",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_ISSET","isset",514],"(",["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","request",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","post",514],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",514],"]",")",["T_WHITESPACE"," ",514],"?",["T_WHITESPACE"," ",514],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","request",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","post",514],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",514],"]",["T_WHITESPACE"," ",514],":",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","''",514],";",["T_WHITESPACE","\n\n\t\t",514],["T_IF","if",516],["T_WHITESPACE"," ",516],"(",["T_VARIABLE","$incoming_token",516],["T_WHITESPACE"," ",516],["T_IS_NOT_EQUAL","!=",516],["T_WHITESPACE"," ",516],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","config",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","get",516],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_amazonus_token'",516],")",")",["T_WHITESPACE"," ",516],"{",["T_WHITESPACE","\n\t\t\t",516],["T_VARIABLE","$this",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","response",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","setOutput",517],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 002\"",517],")",";",["T_WHITESPACE","\n\t\t\t",517],["T_RETURN","return",518],";",["T_WHITESPACE","\n\t\t",518],"}",["T_WHITESPACE","\n\n\t\t",519],["T_VARIABLE","$data",521],["T_WHITESPACE"," ",521],"=",["T_WHITESPACE"," ",521],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","openbay",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","amazonus",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","decryptArgs",521],"(",["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","request",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","post",521],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",521],"]",")",";",["T_WHITESPACE","\n\t\t",521],["T_IF","if",522],["T_WHITESPACE"," ",522],"(","!",["T_VARIABLE","$data",522],")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n\t\t\t",522],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","response",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","setOutput",523],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 003\"",523],")",";",["T_WHITESPACE","\n\t\t\t",523],["T_RETURN","return",524],";",["T_WHITESPACE","\n\t\t",524],"}",["T_WHITESPACE","\n\n\t\t",525],["T_VARIABLE","$data_xml",527],["T_WHITESPACE"," ",527],"=",["T_WHITESPACE"," ",527],["T_STRING","simplexml_load_string",527],"(",["T_VARIABLE","$data",527],")",";",["T_WHITESPACE","\n\n\t\t",527],["T_IF","if",529],"(","!",["T_ISSET","isset",529],"(",["T_VARIABLE","$data_xml",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","action",529],")",")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n\t\t\t",529],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","response",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","setOutput",530],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 004\"",530],")",";",["T_WHITESPACE","\n\t\t\t",530],["T_RETURN","return",531],";",["T_WHITESPACE","\n\t\t",531],"}",["T_WHITESPACE","\n\n\t\t",532],["T_VARIABLE","$action",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_STRING","trim",534],"(",["T_STRING_CAST","(string)",534],["T_VARIABLE","$data_xml",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","action",534],")",";",["T_WHITESPACE","\n\n\t\t",534],["T_IF","if",536],["T_WHITESPACE"," ",536],"(",["T_VARIABLE","$action",536],["T_WHITESPACE"," ",536],["T_IS_IDENTICAL","===",536],["T_WHITESPACE"," ",536],["T_CONSTANT_ENCAPSED_STRING","\"get_amazonus_product\"",536],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n\t\t\t",536],["T_IF","if",537],"(","!",["T_ISSET","isset",537],"(",["T_VARIABLE","$data_xml",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","product_id",537],")",")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n\t\t\t\t",537],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","response",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","setOutput",538],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 005\"",538],")",";",["T_WHITESPACE","\n\t\t\t\t",538],["T_RETURN","return",539],";",["T_WHITESPACE","\n\t\t\t",539],"}",["T_WHITESPACE","\n\n\t\t\t",540],["T_VARIABLE","$product_id",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_STRING","trim",542],"(",["T_STRING_CAST","(string)",542],["T_VARIABLE","$data_xml",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","product_id",542],")",";",["T_WHITESPACE","\n\n\t\t\t",542],["T_IF","if",544],["T_WHITESPACE"," ",544],"(",["T_VARIABLE","$product_id",544],["T_WHITESPACE"," ",544],["T_IS_IDENTICAL","===",544],["T_WHITESPACE"," ",544],["T_CONSTANT_ENCAPSED_STRING","\"all\"",544],")",["T_WHITESPACE"," ",544],"{",["T_WHITESPACE","\n\t\t\t\t",544],["T_VARIABLE","$all_rows",545],["T_WHITESPACE"," ",545],"=",["T_WHITESPACE"," ",545],["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","db",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","query",545],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",545],["T_WHITESPACE"," ",545],".",["T_WHITESPACE"," ",545],["T_STRING","DB_PREFIX",545],["T_WHITESPACE"," ",545],".",["T_WHITESPACE"," ",545],["T_CONSTANT_ENCAPSED_STRING","\"amazonus_product`\"",545],")",["T_OBJECT_OPERATOR","->",545],["T_STRING","rows",545],";",["T_WHITESPACE","\n\n\t\t\t\t",545],["T_VARIABLE","$response",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_ARRAY","array",547],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",547],["T_FOREACH","foreach",549],["T_WHITESPACE"," ",549],"(",["T_VARIABLE","$all_rows",549],["T_WHITESPACE"," ",549],["T_AS","as",549],["T_WHITESPACE"," ",549],["T_VARIABLE","$row",549],")",["T_WHITESPACE"," ",549],"{",["T_WHITESPACE","\n\t\t\t\t\t",549],["T_UNSET","unset",550],"(",["T_VARIABLE","$row",550],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",550],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",550],["T_VARIABLE","$response",551],"[","]",["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_VARIABLE","$row",551],";",["T_WHITESPACE","\n\t\t\t\t",551],"}",["T_WHITESPACE","\n\n\t\t\t\t",552],["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","response",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","setOutput",554],"(",["T_STRING","print_r",554],"(",["T_VARIABLE","$response",554],",",["T_WHITESPACE"," ",554],["T_STRING","true",554],")",")",";",["T_WHITESPACE","\n\t\t\t\t\n\t\t\t\t",554],["T_RETURN","return",556],";",["T_WHITESPACE","\n\t\t\t",556],"}",["T_WHITESPACE"," ",557],["T_ELSE","else",557],["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n\t\t\t\t",557],["T_VARIABLE","$response",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","db",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","query",558],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM `\"",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_STRING","DB_PREFIX",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","\"amazonus_product` WHERE `product_id` = '\"",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_INT_CAST","(int)",558],["T_VARIABLE","$product_id",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","\"'\"",558],")",["T_OBJECT_OPERATOR","->",558],["T_STRING","rows",558],";",["T_WHITESPACE","\n\n\t\t\t\t",558],["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","response",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","setOutput",560],"(",["T_STRING","print_r",560],"(",["T_VARIABLE","$response",560],",",["T_WHITESPACE"," ",560],["T_STRING","true",560],")",")",";",["T_WHITESPACE","\n\t\t\t\t",560],["T_RETURN","return",561],";",["T_WHITESPACE","\n\t\t\t",561],"}",["T_WHITESPACE","\n\t\t",562],"}",["T_WHITESPACE"," ",563],["T_ELSE","else",563],["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n\t\t\t",563],["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","response",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","setOutput",564],"(",["T_CONSTANT_ENCAPSED_STRING","\"error 999\"",564],")",";",["T_WHITESPACE","\n\t\t\t",564],["T_RETURN","return",565],";",["T_WHITESPACE","\n\t\t",565],"}",["T_WHITESPACE","\n\t",566],"}",["T_WHITESPACE","\n\n\t",567],["T_PUBLIC","public",569],["T_WHITESPACE"," ",569],["T_FUNCTION","function",569],["T_WHITESPACE"," ",569],["T_STRING","eventAddOrderHistory",569],"(",["T_VARIABLE","$route",569],",",["T_WHITESPACE"," ",569],["T_VARIABLE","$data",569],")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n\t\t",569],["T_VARIABLE","$logger",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_NEW","new",570],["T_WHITESPACE"," ",570],["T_NS_SEPARATOR","\\",570],["T_STRING","Log",570],"(",["T_CONSTANT_ENCAPSED_STRING","'amazonus.log'",570],")",";",["T_WHITESPACE","\n\t\t",570],["T_VARIABLE","$logger",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","write",571],"(",["T_CONSTANT_ENCAPSED_STRING","'eventAddOrderHistory Event fired: '",571],["T_WHITESPACE"," ",571],".",["T_WHITESPACE"," ",571],["T_VARIABLE","$route",571],")",";",["T_WHITESPACE","\n\t\t\n\t\t",571],["T_IF","if",573],["T_WHITESPACE"," ",573],"(",["T_ISSET","isset",573],"(",["T_VARIABLE","$data",573],"[",["T_LNUMBER","0",573],"]",")",["T_WHITESPACE"," ",573],["T_BOOLEAN_AND","&&",573],["T_WHITESPACE"," ",573],"!",["T_EMPTY","empty",573],"(",["T_VARIABLE","$data",573],"[",["T_LNUMBER","0",573],"]",")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n\t\t\t",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","load",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","model",574],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/openbay\/amazonus_order'",574],")",";",["T_WHITESPACE","\n\t\t\t\n\t\t\t",574],["T_VARIABLE","$logger",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","write",576],"(",["T_CONSTANT_ENCAPSED_STRING","'Order ID: '",576],["T_WHITESPACE"," ",576],".",["T_WHITESPACE"," ",576],["T_INT_CAST","(int)",576],["T_VARIABLE","$data",576],"[",["T_LNUMBER","0",576],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",576],["T_VARIABLE","$this",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","model_extension_openbay_amazonus_order",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","addOrderHistory",578],"(",["T_INT_CAST","(int)",578],["T_VARIABLE","$data",578],"[",["T_LNUMBER","0",578],"]",")",";",["T_WHITESPACE","\n\t\t",578],"}",["T_WHITESPACE","\n\t",579],"}",["T_WHITESPACE","\n",580],"}"]