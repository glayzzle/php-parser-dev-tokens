[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionOpenbayFba",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","eventAddOrderHistory",3],"(",["T_VARIABLE","$route",3],",",["T_WHITESPACE"," ",3],["T_VARIABLE","$data",3],")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","openbay",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","fba",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","log",4],"(",["T_CONSTANT_ENCAPSED_STRING","'eventAddOrderHistory Event fired: '",4],["T_WHITESPACE"," ",4],".",["T_WHITESPACE"," ",4],["T_VARIABLE","$route",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_IF","if",6],["T_WHITESPACE"," ",6],"(",["T_ISSET","isset",6],"(",["T_VARIABLE","$data",6],"[",["T_LNUMBER","0",6],"]",")",["T_WHITESPACE"," ",6],["T_BOOLEAN_AND","&&",6],["T_WHITESPACE"," ",6],"!",["T_EMPTY","empty",6],"(",["T_VARIABLE","$data",6],"[",["T_LNUMBER","0",6],"]",")",")",["T_WHITESPACE"," ",6],"{",["T_WHITESPACE","\n\t\t\t",6],["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","load",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","model",7],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",7],")",";",["T_WHITESPACE","\n\t\t\t",7],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","load",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","model",8],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/order'",8],")",";",["T_WHITESPACE","\n\t\t\t",8],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","load",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","model",9],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",9],")",";",["T_WHITESPACE","\n\n\t\t\t",9],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","openbay",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","fba",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","log",11],"(",["T_CONSTANT_ENCAPSED_STRING","'eventAddOrderHistory Event fired for order ID: '",11],["T_WHITESPACE"," ",11],".",["T_WHITESPACE"," ",11],["T_VARIABLE","$data",11],"[",["T_LNUMBER","0",11],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",11],["T_VARIABLE","$order",13],["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","model_checkout_order",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","getOrder",13],"(",["T_VARIABLE","$data",13],"[",["T_LNUMBER","0",13],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",13],["T_IF","if",15],["T_WHITESPACE"," ",15],"(",["T_VARIABLE","$order",15],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",15],"]",")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\t\t\t\t",15],["T_IF","if",16],["T_WHITESPACE"," ",16],"(",["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","config",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","get",16],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_order_trigger_status'",16],")",["T_WHITESPACE"," ",16],["T_IS_EQUAL","==",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$order",16],"[",["T_CONSTANT_ENCAPSED_STRING","'order_status_id'",16],"]",")",["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\t\t\t\t\t",16],["T_VARIABLE","$fba_fulfillment_id",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","openbay",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","fba",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","createFBAFulfillmentID",17],"(",["T_VARIABLE","$data",17],"[",["T_LNUMBER","0",17],"]",",",["T_WHITESPACE"," ",17],["T_LNUMBER","0",17],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",17],["T_VARIABLE","$order_products",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","model_account_order",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","getOrderProducts",19],"(",["T_VARIABLE","$data",19],"[",["T_LNUMBER","0",19],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",19],["T_VARIABLE","$total_order_products",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","count",21],"(",["T_VARIABLE","$order_products",21],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",21],["T_VARIABLE","$fulfillment_items",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_ARRAY","array",23],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",23],["T_FOREACH","foreach",25],["T_WHITESPACE"," ",25],"(",["T_VARIABLE","$order_products",25],["T_WHITESPACE"," ",25],["T_AS","as",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$order_product",25],")",["T_WHITESPACE"," ",25],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",25],["T_VARIABLE","$product",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","model_catalog_product",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","getProduct",26],"(",["T_VARIABLE","$order_product",26],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",26],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",26],["T_IF","if",28],["T_WHITESPACE"," ",28],"(",["T_VARIABLE","$product",28],"[",["T_CONSTANT_ENCAPSED_STRING","'location'",28],"]",["T_WHITESPACE"," ",28],["T_IS_EQUAL","==",28],["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'FBA'",28],")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",28],["T_VARIABLE","$fulfillment_items",29],"[","]",["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",29],["T_CONSTANT_ENCAPSED_STRING","'seller_sku'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$product",30],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",30],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",30],["T_CONSTANT_ENCAPSED_STRING","'quantity'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$order_product",31],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",31],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",31],["T_CONSTANT_ENCAPSED_STRING","'seller_fulfillment_order_item_id'",32],["T_WHITESPACE"," ",32],["T_DOUBLE_ARROW","=>",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","config",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","get",32],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_order_prefix'",32],")",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_VARIABLE","$fba_fulfillment_id",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'-'",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_VARIABLE","$order_product",32],"[",["T_CONSTANT_ENCAPSED_STRING","'order_product_id'",32],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",32],["T_CONSTANT_ENCAPSED_STRING","'per_unit_declared_value'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t",33],["T_CONSTANT_ENCAPSED_STRING","'currency_code'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$order",34],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",34],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t",34],["T_CONSTANT_ENCAPSED_STRING","'value'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_STRING","number_format",35],"(",["T_VARIABLE","$order_product",35],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",35],"]",",",["T_WHITESPACE"," ",35],["T_LNUMBER","2",35],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",35],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",36],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",37],"}",["T_WHITESPACE","\n\t\t\t\t\t",38],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",39],["T_VARIABLE","$total_fulfillment_items",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","count",41],"(",["T_VARIABLE","$fulfillment_items",41],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",41],["T_IF","if",43],["T_WHITESPACE"," ",43],"(","(",["T_VARIABLE","$total_order_products",43],["T_WHITESPACE"," ",43],["T_IS_EQUAL","==",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$total_fulfillment_items",43],")",["T_WHITESPACE"," ",43],["T_BOOLEAN_OR","||",43],["T_WHITESPACE"," ",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","config",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","get",43],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_only_fill_complete'",43],")",["T_WHITESPACE"," ",43],["T_IS_NOT_EQUAL","!=",43],["T_WHITESPACE"," ",43],["T_LNUMBER","1",43],")",")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",43],["T_IF","if",44],["T_WHITESPACE"," ",44],"(","!",["T_EMPTY","empty",44],"(",["T_VARIABLE","$fulfillment_items",44],")",")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",44],["T_VARIABLE","$request",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",45],["T_VARIABLE","$datetime",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_STRING","DateTime",47],"(",["T_VARIABLE","$order",47],"[",["T_CONSTANT_ENCAPSED_STRING","'date_added'",47],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",47],["T_VARIABLE","$request",48],"[",["T_CONSTANT_ENCAPSED_STRING","'displayable_order_datetime'",48],"]",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$datetime",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","format",48],"(",["T_STRING","DateTime",48],["T_DOUBLE_COLON","::",48],["T_STRING","ISO8601",48],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",48],["T_VARIABLE","$request",50],"[",["T_CONSTANT_ENCAPSED_STRING","'seller_fulfillment_order_id'",50],"]",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","config",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_order_prefix'",50],")",["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$data",50],"[",["T_LNUMBER","0",50],"]",["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'-'",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$fba_fulfillment_id",50],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",50],["T_VARIABLE","$request",51],"[",["T_CONSTANT_ENCAPSED_STRING","'displayable_order_id'",51],"]",["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$data",51],"[",["T_LNUMBER","0",51],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",51],["T_VARIABLE","$request",52],"[",["T_CONSTANT_ENCAPSED_STRING","'displayable_order_comment'",52],"]",["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'none'",52],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",52],["T_VARIABLE","$request",53],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_speed_category'",53],"]",["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","config",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","get",53],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_shipping_speed'",53],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",53],["T_VARIABLE","$request",54],"[",["T_CONSTANT_ENCAPSED_STRING","'fulfillment_action'",54],"]",["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","config",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","get",54],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_send_orders'",54],")",["T_WHITESPACE"," ",54],["T_IS_EQUAL","==",54],["T_WHITESPACE"," ",54],["T_LNUMBER","1",54],["T_WHITESPACE"," ",54],"?",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Ship'",54],["T_WHITESPACE"," ",54],":",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Hold'",54],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",54],["T_VARIABLE","$request",55],"[",["T_CONSTANT_ENCAPSED_STRING","'fulfillment_policy'",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","config",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","get",55],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_fulfill_policy'",55],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",55],["T_VARIABLE","$request",57],"[",["T_CONSTANT_ENCAPSED_STRING","'destination_address'",57],"]",["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",57],["T_CONSTANT_ENCAPSED_STRING","'name'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$order",58],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",58],"]",["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","' '",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_VARIABLE","$order",58],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",58],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",58],["T_CONSTANT_ENCAPSED_STRING","'line_1'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],"(","!",["T_EMPTY","empty",59],"(",["T_VARIABLE","$order",59],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",59],"]",")",["T_WHITESPACE"," ",59],"?",["T_WHITESPACE"," ",59],["T_VARIABLE","$order",59],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",59],"]",["T_WHITESPACE"," ",59],":",["T_WHITESPACE"," ",59],["T_VARIABLE","$order",59],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",59],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",59],["T_CONSTANT_ENCAPSED_STRING","'line_2'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],"(","!",["T_EMPTY","empty",60],"(",["T_VARIABLE","$order",60],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",60],"]",")",["T_WHITESPACE"," ",60],"?",["T_WHITESPACE"," ",60],["T_VARIABLE","$order",60],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",60],"]",["T_WHITESPACE"," ",60],":",["T_WHITESPACE"," ",60],["T_VARIABLE","$order",60],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",60],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",60],["T_CONSTANT_ENCAPSED_STRING","'line_3'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],"(","!",["T_EMPTY","empty",61],"(",["T_VARIABLE","$order",61],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",61],"]",")",["T_WHITESPACE"," ",61],"?",["T_WHITESPACE"," ",61],["T_VARIABLE","$order",61],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",61],"]",["T_WHITESPACE"," ",61],":",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","''",61],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",61],["T_CONSTANT_ENCAPSED_STRING","'state_or_province_code'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$order",62],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",62],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",62],["T_CONSTANT_ENCAPSED_STRING","'city'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$order",63],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",63],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",63],["T_CONSTANT_ENCAPSED_STRING","'country_code'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$order",64],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_iso_code_2'",64],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",64],["T_CONSTANT_ENCAPSED_STRING","'postal_code'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$order",65],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",65],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",65],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",66],["T_VARIABLE","$request",68],"[",["T_CONSTANT_ENCAPSED_STRING","'items'",68],"]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$fulfillment_items",68],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",68],["T_VARIABLE","$response",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","openbay",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","fba",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","call",70],"(",["T_CONSTANT_ENCAPSED_STRING","\"v1\/fba\/fulfillments\/\"",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$request",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'POST'",70],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",70],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$response",72],"[",["T_CONSTANT_ENCAPSED_STRING","'response_http'",72],"]",["T_WHITESPACE"," ",72],["T_IS_NOT_EQUAL","!=",72],["T_WHITESPACE"," ",72],["T_LNUMBER","201",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",72],["T_DOC_COMMENT","\/**\n\t\t\t\t\t\t\t\t * @todo notify the admin about any errors\n\t\t\t\t\t\t\t\t *\/",73],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","openbay",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","fba",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","updateFBAOrderStatus",76],"(",["T_VARIABLE","$data",76],"[",["T_LNUMBER","0",76],"]",",",["T_WHITESPACE"," ",76],["T_LNUMBER","1",76],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",76],"}",["T_WHITESPACE"," ",77],["T_ELSE","else",77],["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","config",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","get",78],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_send_orders'",78],")",["T_WHITESPACE"," ",78],["T_IS_EQUAL","==",78],["T_WHITESPACE"," ",78],["T_LNUMBER","1",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","openbay",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","fba",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","updateFBAOrderStatus",79],"(",["T_VARIABLE","$data",79],"[",["T_LNUMBER","0",79],"]",",",["T_WHITESPACE"," ",79],["T_LNUMBER","3",79],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",79],"}",["T_WHITESPACE"," ",80],["T_ELSE","else",80],["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","openbay",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","fba",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","updateFBAOrderStatus",81],"(",["T_VARIABLE","$data",81],"[",["T_LNUMBER","0",81],"]",",",["T_WHITESPACE"," ",81],["T_LNUMBER","2",81],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",81],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","openbay",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","fba",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","updateFBAOrderRef",84],"(",["T_VARIABLE","$data",84],"[",["T_LNUMBER","0",84],"]",",",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","config",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","get",84],"(",["T_CONSTANT_ENCAPSED_STRING","'openbay_fba_order_prefix'",84],")",["T_WHITESPACE"," ",84],".",["T_WHITESPACE"," ",84],["T_VARIABLE","$data",84],"[",["T_LNUMBER","0",84],"]",["T_WHITESPACE"," ",84],".",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'-'",84],["T_WHITESPACE"," ",84],".",["T_WHITESPACE"," ",84],["T_VARIABLE","$fba_fulfillment_id",84],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",84],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","openbay",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","fba",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","populateFBAFulfillment",87],"(",["T_STRING","json_encode",87],"(",["T_VARIABLE","$request",87],")",",",["T_WHITESPACE"," ",87],["T_STRING","json_encode",87],"(",["T_VARIABLE","$response",87],")",",",["T_WHITESPACE"," ",87],["T_VARIABLE","$response",87],"[",["T_CONSTANT_ENCAPSED_STRING","'response_http'",87],"]",",",["T_WHITESPACE"," ",87],["T_VARIABLE","$fba_fulfillment_id",87],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","openbay",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","fba",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","updateFBAOrderFulfillmentID",88],"(",["T_VARIABLE","$data",88],"[",["T_LNUMBER","0",88],"]",",",["T_WHITESPACE"," ",88],["T_VARIABLE","$fba_fulfillment_id",88],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",88],"}",["T_WHITESPACE"," ",89],["T_ELSE","else",89],["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","openbay",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","fba",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","log",90],"(",["T_CONSTANT_ENCAPSED_STRING","'No FBA items found for this order'",90],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",90],"}",["T_WHITESPACE","\n\t\t\t\t\t",91],"}",["T_WHITESPACE"," ",92],["T_ELSE","else",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","openbay",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","fba",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","log",93],"(",["T_CONSTANT_ENCAPSED_STRING","'Products:'",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_VARIABLE","$total_order_products",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","', Fulfillment products: '",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_VARIABLE","$total_fulfillment_items",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","' - settings do not allow incomplete order fulfillment.'",93],")",";",["T_WHITESPACE","\n\t\t\t\t\t",93],"}",["T_WHITESPACE","\n\t\t\t\t",94],"}",["T_WHITESPACE","\n\t\t\t",95],"}",["T_WHITESPACE","\n\n\t\t\t",96],["T_COMMENT","\/\/ how about notifications? does the merchant want a notification that here is a new fulfillment ready to be checked over?\n",98],["T_WHITESPACE","\t\t\t",99],["T_COMMENT","\/\/ alert of any missing products that were not in FBA?\n",99],["T_WHITESPACE","\t\t\t",100],["T_COMMENT","\/\/ any errors returned by FBA?\n",100],["T_WHITESPACE","\t\t",101],"}",["T_WHITESPACE","\n\t",101],"}",["T_WHITESPACE","\n\n\t",102],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","eventAddOrder",104],"(",["T_VARIABLE","$route",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$data",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n\t\t",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","openbay",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","fba",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","log",105],"(",["T_CONSTANT_ENCAPSED_STRING","'eventAddOrder Event fired: '",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_VARIABLE","$route",105],")",";",["T_WHITESPACE","\n\n\t\t",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_ISSET","isset",107],"(",["T_VARIABLE","$data",107],"[",["T_LNUMBER","0",107],"]",")",["T_WHITESPACE"," ",107],["T_BOOLEAN_AND","&&",107],["T_WHITESPACE"," ",107],"!",["T_EMPTY","empty",107],"(",["T_VARIABLE","$data",107],"[",["T_LNUMBER","0",107],"]",")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n\t\t\t",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","load",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","model",108],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",108],")",";",["T_WHITESPACE","\n\n\t\t\t",108],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","openbay",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","fba",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","log",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Order ID: '",110],["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_INT_CAST","(int)",110],["T_VARIABLE","$data",110],"[",["T_LNUMBER","0",110],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",110],["T_VARIABLE","$order",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","model_checkout_order",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getOrder",112],"(",["T_INT_CAST","(int)",112],["T_VARIABLE","$data",112],"[",["T_LNUMBER","0",112],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",112],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$order",114],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",114],"]",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n\t\t\t\t",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","openbay",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","fba",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","createFBAOrderID",115],"(",["T_INT_CAST","(int)",115],["T_VARIABLE","$data",115],"[",["T_LNUMBER","0",115],"]",")",";",["T_WHITESPACE","\n\t\t\t",115],"}",["T_WHITESPACE","\n\t\t",116],"}",["T_WHITESPACE","\n\t",117],"}",["T_WHITESPACE","\n",118],"}"]