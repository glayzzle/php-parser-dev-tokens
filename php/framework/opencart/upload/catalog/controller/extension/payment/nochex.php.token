[["T_OPEN_TAG","<?php\n",1],["T_COMMENT","\/\/ Nochex via form will work for both simple \"Seller\" account and \"Merchant\" account holders\n",2],["T_COMMENT","\/\/ Nochex via APC maybe only avaiable to \"Merchant\" account holders only - site docs a bit vague on this point\n",3],["T_CLASS","class",4],["T_WHITESPACE"," ",4],["T_STRING","ControllerExtensionPaymentNochex",4],["T_WHITESPACE"," ",4],["T_EXTENDS","extends",4],["T_WHITESPACE"," ",4],["T_STRING","Controller",4],["T_WHITESPACE"," ",4],"{",["T_WHITESPACE","\n\t",4],["T_PUBLIC","public",5],["T_WHITESPACE"," ",5],["T_FUNCTION","function",5],["T_WHITESPACE"," ",5],["T_STRING","index",5],"(",")",["T_WHITESPACE"," ",5],"{",["T_WHITESPACE","\n\t\t",5],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","load",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","language",6],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/nochex'",6],")",";",["T_WHITESPACE","\n\n\t\t",6],["T_VARIABLE","$data",8],"[",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",8],"]",["T_WHITESPACE"," ",8],"=",["T_WHITESPACE"," ",8],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","language",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","get",8],"(",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",8],")",";",["T_WHITESPACE","\n\n\t\t",8],["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","load",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","model",10],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",10],")",";",["T_WHITESPACE","\n\n\t\t",10],["T_VARIABLE","$order_info",12],["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_VARIABLE","$this",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","model_checkout_order",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","getOrder",12],"(",["T_VARIABLE","$this",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","session",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","data",12],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",12],"]",")",";",["T_WHITESPACE","\n\n\t\t",12],["T_VARIABLE","$data",14],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",14],"]",["T_WHITESPACE"," ",14],"=",["T_WHITESPACE"," ",14],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/secure.nochex.com\/'",14],";",["T_WHITESPACE","\n\n\t\t",14],["T_COMMENT","\/\/ Nochex minimum requirements\n",16],["T_WHITESPACE","\t\t",17],["T_COMMENT","\/\/ The merchant ID is usually your Nochex registered email address but can be altered for \"Merchant\" accounts see below\n",17],["T_WHITESPACE","\t\t",18],["T_IF","if",18],["T_WHITESPACE"," ",18],"(",["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","config",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","get",18],"(",["T_CONSTANT_ENCAPSED_STRING","'nochex_email'",18],")",["T_WHITESPACE"," ",18],["T_IS_NOT_EQUAL","!=",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","config",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","get",18],"(",["T_CONSTANT_ENCAPSED_STRING","'nochex_merchant'",18],")",")",["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\t\t\t",18],["T_COMMENT","\/\/ This MUST be changed on your Nochex account!!!!\n",19],["T_WHITESPACE","\t\t\t",20],["T_VARIABLE","$data",20],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",20],"]",["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","config",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","get",20],"(",["T_CONSTANT_ENCAPSED_STRING","'nochex_merchant'",20],")",";",["T_WHITESPACE","\n\t\t",20],"}",["T_WHITESPACE"," ",21],["T_ELSE","else",21],["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\t\t\t",21],["T_VARIABLE","$data",22],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",22],"]",["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","config",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","get",22],"(",["T_CONSTANT_ENCAPSED_STRING","'nochex_email'",22],")",";",["T_WHITESPACE","\n\t\t",22],"}",["T_WHITESPACE","\n\n\t\t",23],["T_VARIABLE","$data",25],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",25],"]",["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","currency",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","format",25],"(",["T_VARIABLE","$order_info",25],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",25],"]",",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'GBP'",25],",",["T_WHITESPACE"," ",25],["T_STRING","false",25],",",["T_WHITESPACE"," ",25],["T_STRING","false",25],")",";",["T_WHITESPACE","\n\t\t",25],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",26],"]",["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","session",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",26],"]",";",["T_WHITESPACE","\n\t\t",26],["T_VARIABLE","$data",27],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",27],"]",["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","config",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","get",27],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",27],")",";",["T_WHITESPACE","\n\n\t\t",27],["T_VARIABLE","$data",29],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_fullname'",29],"]",["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$order_info",29],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",29],"]",["T_WHITESPACE"," ",29],".",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","' '",29],["T_WHITESPACE"," ",29],".",["T_WHITESPACE"," ",29],["T_VARIABLE","$order_info",29],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",29],"]",";",["T_WHITESPACE","\n\n\t\t",29],["T_IF","if",31],["T_WHITESPACE"," ",31],"(",["T_VARIABLE","$order_info",31],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",31],"]",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n\t\t\t",31],["T_VARIABLE","$data",32],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",32],"]",["T_WHITESPACE","  ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$order_info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",32],"]",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_VARIABLE","$order_info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",32],"]",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_VARIABLE","$order_info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",32],"]",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_VARIABLE","$order_info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",32],"]",["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",32],";",["T_WHITESPACE","\n\t\t",32],"}",["T_WHITESPACE"," ",33],["T_ELSE","else",33],["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n\t\t\t",33],["T_VARIABLE","$data",34],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",34],"]",["T_WHITESPACE","  ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$order_info",34],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",34],"]",["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_VARIABLE","$order_info",34],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",34],"]",["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_VARIABLE","$order_info",34],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",34],"]",["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",34],";",["T_WHITESPACE","\n\t\t",34],"}",["T_WHITESPACE","\n\n\t\t",35],["T_VARIABLE","$data",37],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_postcode'",37],"]",["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$order_info",37],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",37],"]",";",["T_WHITESPACE","\n\n\t\t",37],["T_IF","if",39],["T_WHITESPACE"," ",39],"(",["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","cart",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","hasShipping",39],"(",")",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n\t\t\t",39],["T_VARIABLE","$data",40],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_fullname'",40],"]",["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$order_info",40],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",40],"]",["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","' '",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_VARIABLE","$order_info",40],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",40],"]",";",["T_WHITESPACE","\n\n\t\t\t",40],["T_IF","if",42],["T_WHITESPACE"," ",42],"(",["T_VARIABLE","$order_info",42],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",42],"]",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n\t\t\t\t",42],["T_VARIABLE","$data",43],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_address'",43],"]",["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$order_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",43],"]",["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_VARIABLE","$order_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",43],"]",["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_VARIABLE","$order_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",43],"]",["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_VARIABLE","$order_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",43],"]",["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",43],";",["T_WHITESPACE","\n\t\t\t",43],"}",["T_WHITESPACE"," ",44],["T_ELSE","else",44],["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n\t\t\t\t",44],["T_VARIABLE","$data",45],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_address'",45],"]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$order_info",45],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",45],"]",["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",45],["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_VARIABLE","$order_info",45],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",45],"]",["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",45],["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_VARIABLE","$order_info",45],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",45],"]",["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",45],";",["T_WHITESPACE","\n\t\t\t",45],"}",["T_WHITESPACE","\n\n\t\t\t",46],["T_VARIABLE","$data",48],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_postcode'",48],"]",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$order_info",48],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",48],"]",";",["T_WHITESPACE","\n\t\t",48],"}",["T_WHITESPACE"," ",49],["T_ELSE","else",49],["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\t\t\t",49],["T_VARIABLE","$data",50],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_fullname'",50],"]",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$order_info",50],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",50],"]",["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","' '",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$order_info",50],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",50],"]",";",["T_WHITESPACE","\n\n\t\t\t",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$order_info",52],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",52],"]",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n\t\t\t\t",52],["T_VARIABLE","$data",53],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_address'",53],"]",["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$order_info",53],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",53],"]",["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_VARIABLE","$order_info",53],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",53],"]",["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_VARIABLE","$order_info",53],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",53],"]",["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_VARIABLE","$order_info",53],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",53],"]",["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",53],";",["T_WHITESPACE","\n\t\t\t",53],"}",["T_WHITESPACE"," ",54],["T_ELSE","else",54],["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n\t\t\t\t",54],["T_VARIABLE","$data",55],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_address'",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$order_info",55],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",55],"]",["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$order_info",55],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",55],"]",["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$order_info",55],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",55],"]",["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",55],";",["T_WHITESPACE","\n\t\t\t",55],"}",["T_WHITESPACE","\n\n\t\t\t",56],["T_VARIABLE","$data",58],"[",["T_CONSTANT_ENCAPSED_STRING","'delivery_postcode'",58],"]",["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$order_info",58],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",58],"]",";",["T_WHITESPACE","\n\t\t",58],"}",["T_WHITESPACE","\n\n\t\t",59],["T_VARIABLE","$data",61],"[",["T_CONSTANT_ENCAPSED_STRING","'email_address'",61],"]",["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$order_info",61],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",61],"]",";",["T_WHITESPACE","\n\t\t",61],["T_VARIABLE","$data",62],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_phone_number'",62],"]","=",["T_WHITESPACE"," ",62],["T_VARIABLE","$order_info",62],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",62],"]",";",["T_WHITESPACE","\n\t\t",62],["T_VARIABLE","$data",63],"[",["T_CONSTANT_ENCAPSED_STRING","'test'",63],"]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","config",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","get",63],"(",["T_CONSTANT_ENCAPSED_STRING","'nochex_test'",63],")",";",["T_WHITESPACE","\n\t\t",63],["T_VARIABLE","$data",64],"[",["T_CONSTANT_ENCAPSED_STRING","'success_url'",64],"]",["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","url",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","link",64],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","''",64],",",["T_WHITESPACE"," ",64],["T_STRING","true",64],")",";",["T_WHITESPACE","\n\t\t",64],["T_VARIABLE","$data",65],"[",["T_CONSTANT_ENCAPSED_STRING","'cancel_url'",65],"]",["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","url",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","link",65],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/payment'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","''",65],",",["T_WHITESPACE"," ",65],["T_STRING","true",65],")",";",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$data",66],"[",["T_CONSTANT_ENCAPSED_STRING","'declined_url'",66],"]",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","url",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","link",66],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/nochex\/callback'",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'method=decline'",66],",",["T_WHITESPACE"," ",66],["T_STRING","true",66],")",";",["T_WHITESPACE","\n\t\t",66],["T_VARIABLE","$data",67],"[",["T_CONSTANT_ENCAPSED_STRING","'callback_url'",67],"]",["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","url",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","link",67],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/nochex\/callback'",67],",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'order='",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","session",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","data",67],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",67],"]",",",["T_WHITESPACE"," ",67],["T_STRING","true",67],")",";",["T_WHITESPACE","\n\n\t\t",67],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","load",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","view",69],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/nochex'",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$data",69],")",";",["T_WHITESPACE","\n\t",69],"}",["T_WHITESPACE","\n\n\t",70],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","callback",72],"(",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n\t\t",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","load",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","language",73],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/nochex'",73],")",";",["T_WHITESPACE","\n\n\t\t",73],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_ISSET","isset",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","request",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","get",75],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",75],"]",")",["T_WHITESPACE"," ",75],["T_BOOLEAN_AND","&&",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","request",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","get",75],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",75],"]",["T_WHITESPACE"," ",75],["T_IS_EQUAL","==",75],["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'decline'",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n\t\t\t",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","session",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","data",76],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",76],"]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","language",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","get",76],"(",["T_CONSTANT_ENCAPSED_STRING","'error_declined'",76],")",";",["T_WHITESPACE","\n\n\t\t\t",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","response",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","redirect",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","url",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","link",78],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",78],")",")",";",["T_WHITESPACE","\n\t\t",78],"}",["T_WHITESPACE","\n\n\t\t",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_ISSET","isset",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","request",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","post",81],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",81],"]",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n\t\t\t",81],["T_VARIABLE","$order_id",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","request",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","post",82],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",82],"]",";",["T_WHITESPACE","\n\t\t",82],"}",["T_WHITESPACE"," ",83],["T_ELSE","else",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n\t\t\t",83],["T_VARIABLE","$order_id",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_LNUMBER","0",84],";",["T_WHITESPACE","\n\t\t",84],"}",["T_WHITESPACE","\n\n\t\t",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","load",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","model",87],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",87],")",";",["T_WHITESPACE","\n\n\t\t",87],["T_VARIABLE","$order_info",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","model_checkout_order",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getOrder",89],"(",["T_VARIABLE","$order_id",89],")",";",["T_WHITESPACE","\n\n\t\t",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_VARIABLE","$order_info",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","session",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","data",92],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",92],"]",["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","language",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","get",92],"(",["T_CONSTANT_ENCAPSED_STRING","'error_no_order'",92],")",";",["T_WHITESPACE","\n\n\t\t\t",92],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","response",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","redirect",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","url",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","link",94],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",94],")",")",";",["T_WHITESPACE","\n\t\t",94],"}",["T_WHITESPACE","\n\n\t\t",95],["T_COMMENT","\/\/ Fraud Verification Step.\n",97],["T_WHITESPACE","\t\t",98],["T_VARIABLE","$request",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","''",98],";",["T_WHITESPACE","\n\n\t\t",98],["T_FOREACH","foreach",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","request",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","post",100],["T_WHITESPACE"," ",100],["T_AS","as",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$key",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$value",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n\t\t\t",100],["T_VARIABLE","$request",101],["T_WHITESPACE"," ",101],["T_CONCAT_EQUAL",".=",101],["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'&'",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_VARIABLE","$key",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'='",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_STRING","urlencode",101],"(",["T_STRING","stripslashes",101],"(",["T_VARIABLE","$value",101],")",")",";",["T_WHITESPACE","\n\t\t",101],"}",["T_WHITESPACE","\n\n\t\t",102],["T_VARIABLE","$curl",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","curl_init",104],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.nochex.com\/nochex.dll\/apc\/apc'",104],")",";",["T_WHITESPACE","\n\n\t\t",104],["T_STRING","curl_setopt",106],"(",["T_VARIABLE","$curl",106],",",["T_WHITESPACE"," ",106],["T_STRING","CURLOPT_POST",106],",",["T_WHITESPACE"," ",106],["T_STRING","true",106],")",";",["T_WHITESPACE","\n\t\t",106],["T_STRING","curl_setopt",107],"(",["T_VARIABLE","$curl",107],",",["T_WHITESPACE"," ",107],["T_STRING","CURLOPT_POSTFIELDS",107],",",["T_WHITESPACE"," ",107],["T_STRING","trim",107],"(",["T_VARIABLE","$request",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'&'",107],")",")",";",["T_WHITESPACE","\n\t\t",107],["T_STRING","curl_setopt",108],"(",["T_VARIABLE","$curl",108],",",["T_WHITESPACE"," ",108],["T_STRING","CURLOPT_RETURNTRANSFER",108],",",["T_WHITESPACE"," ",108],["T_STRING","true",108],")",";",["T_WHITESPACE","\n\t\t",108],["T_STRING","curl_setopt",109],"(",["T_VARIABLE","$curl",109],",",["T_WHITESPACE"," ",109],["T_STRING","CURLOPT_HEADER",109],",",["T_WHITESPACE"," ",109],["T_STRING","false",109],")",";",["T_WHITESPACE","\n\t\t",109],["T_STRING","curl_setopt",110],"(",["T_VARIABLE","$curl",110],",",["T_WHITESPACE"," ",110],["T_STRING","CURLOPT_TIMEOUT",110],",",["T_WHITESPACE"," ",110],["T_LNUMBER","30",110],")",";",["T_WHITESPACE","\n\t\t",110],["T_STRING","curl_setopt",111],"(",["T_VARIABLE","$curl",111],",",["T_WHITESPACE"," ",111],["T_STRING","CURLOPT_SSL_VERIFYPEER",111],",",["T_WHITESPACE"," ",111],["T_STRING","false",111],")",";",["T_WHITESPACE","\n\n\t\t",111],["T_VARIABLE","$response",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","curl_exec",113],"(",["T_VARIABLE","$curl",113],")",";",["T_WHITESPACE","\n\n\t\t",113],["T_STRING","curl_close",115],"(",["T_VARIABLE","$curl",115],")",";",["T_WHITESPACE","\n\n\t\t",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_STRING","strcmp",117],"(",["T_VARIABLE","$response",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'AUTHORISED'",117],")",["T_WHITESPACE"," ",117],["T_IS_EQUAL","==",117],["T_WHITESPACE"," ",117],["T_LNUMBER","0",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n\t\t\t",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","model_checkout_order",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","addOrderHistory",118],"(",["T_VARIABLE","$order_id",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","config",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","get",118],"(",["T_CONSTANT_ENCAPSED_STRING","'nochex_order_status_id'",118],")",")",";",["T_WHITESPACE","\n\t\t",118],"}",["T_WHITESPACE"," ",119],["T_ELSE","else",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n\t\t\t",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","model_checkout_order",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","addOrderHistory",120],"(",["T_VARIABLE","$order_id",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","config",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","get",120],"(",["T_CONSTANT_ENCAPSED_STRING","'config_order_status_id'",120],")",",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'Auto-Verification step failed. Manually check the transaction.'",120],")",";",["T_WHITESPACE","\n\t\t",120],"}",["T_WHITESPACE","\n\n\t\t",121],["T_COMMENT","\/\/ Since it returned, the customer should see success.\n",123],["T_WHITESPACE","\t\t",124],["T_COMMENT","\/\/ It's up to the store owner to manually verify payment.\n",124],["T_WHITESPACE","\t\t",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","response",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","redirect",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","url",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","link",125],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","''",125],",",["T_WHITESPACE"," ",125],["T_STRING","true",125],")",")",";",["T_WHITESPACE","\n\t",125],"}",["T_WHITESPACE","\n",126],"}"]