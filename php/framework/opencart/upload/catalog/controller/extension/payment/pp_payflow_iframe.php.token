[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionPaymentPPPayflowIframe",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","index",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","load",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","model",4],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",4],")",";",["T_WHITESPACE","\n\t\t",4],["T_VARIABLE","$this",5],["T_OBJECT_OPERATOR","->",5],["T_STRING","load",5],["T_OBJECT_OPERATOR","->",5],["T_STRING","model",5],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pp_payflow_iframe'",5],")",";",["T_WHITESPACE","\n\t\t",5],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","load",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","model",6],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/country'",6],")",";",["T_WHITESPACE","\n\t\t",6],["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","load",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","model",7],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/zone'",7],")",";",["T_WHITESPACE","\n\n\t\t",7],["T_VARIABLE","$order_info",9],["T_WHITESPACE"," ",9],"=",["T_WHITESPACE"," ",9],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","model_checkout_order",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","getOrder",9],"(",["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","session",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","data",9],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",9],"]",")",";",["T_WHITESPACE","\n\n\t\t",9],["T_IF","if",11],["T_WHITESPACE"," ",11],"(",["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","config",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","get",11],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_payflow_iframe_test'",11],")",")",["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\t\t\t",11],["T_VARIABLE","$mode",12],["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_CONSTANT_ENCAPSED_STRING","'TEST'",12],";",["T_WHITESPACE","\n\t\t",12],"}",["T_WHITESPACE"," ",13],["T_ELSE","else",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\t\t\t",13],["T_VARIABLE","$mode",14],["T_WHITESPACE"," ",14],"=",["T_WHITESPACE"," ",14],["T_CONSTANT_ENCAPSED_STRING","'LIVE'",14],";",["T_WHITESPACE","\n\t\t",14],"}",["T_WHITESPACE","\n\n\t\t",15],["T_VARIABLE","$payflow_url",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/payflowlink.paypal.com'",17],";",["T_WHITESPACE","\n\n\t\t",17],["T_IF","if",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","config",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","get",19],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_payflow_iframe_transaction_method'",19],")",["T_WHITESPACE"," ",19],["T_IS_EQUAL","==",19],["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'sale'",19],")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t\t",19],["T_VARIABLE","$transaction_type",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'S'",20],";",["T_WHITESPACE","\n\t\t",20],"}",["T_WHITESPACE"," ",21],["T_ELSE","else",21],["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\t\t\t",21],["T_VARIABLE","$transaction_type",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'A'",22],";",["T_WHITESPACE","\n\t\t",22],"}",["T_WHITESPACE","\n\n\t\t",23],["T_VARIABLE","$secure_token_id",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_STRING","md5",25],"(",["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","session",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","data",25],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",25],"]",["T_WHITESPACE"," ",25],".",["T_WHITESPACE"," ",25],["T_STRING","mt_rand",25],"(",")",["T_WHITESPACE"," ",25],".",["T_WHITESPACE"," ",25],["T_STRING","microtime",25],"(",")",")",";",["T_WHITESPACE","\n\n\t\t",25],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","model_extension_payment_pp_payflow_iframe",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","addOrder",27],"(",["T_VARIABLE","$order_info",27],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",27],"]",",",["T_WHITESPACE"," ",27],["T_VARIABLE","$secure_token_id",27],")",";",["T_WHITESPACE","\n\n\t\t",27],["T_VARIABLE","$shipping_country",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","model_localisation_country",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","getCountry",29],"(",["T_VARIABLE","$order_info",29],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",29],"]",")",";",["T_WHITESPACE","\n\t\t",29],["T_VARIABLE","$shipping_zone",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","model_localisation_zone",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","getZone",30],"(",["T_VARIABLE","$order_info",30],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",30],"]",")",";",["T_WHITESPACE","\n\n\t\t",30],["T_VARIABLE","$payment_country",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","model_localisation_country",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","getCountry",32],"(",["T_VARIABLE","$order_info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",32],"]",")",";",["T_WHITESPACE","\n\t\t",32],["T_VARIABLE","$payment_zone",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","model_localisation_zone",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","getZone",33],"(",["T_VARIABLE","$order_info",33],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",33],"]",")",";",["T_WHITESPACE","\n\n\t\t",33],["T_VARIABLE","$url_params",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_WHITESPACE","\n\t\t\t",35],["T_CONSTANT_ENCAPSED_STRING","'TENDER'",36],["T_WHITESPACE","            ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'C'",36],",",["T_WHITESPACE","\n\t\t\t",36],["T_CONSTANT_ENCAPSED_STRING","'TRXTYPE'",37],["T_WHITESPACE","           ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$transaction_type",37],",",["T_WHITESPACE","\n\t\t\t",37],["T_CONSTANT_ENCAPSED_STRING","'AMT'",38],["T_WHITESPACE","               ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","currency",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","format",38],"(",["T_VARIABLE","$order_info",38],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",38],"]",",",["T_WHITESPACE"," ",38],["T_VARIABLE","$order_info",38],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",38],"]",",",["T_WHITESPACE"," ",38],["T_STRING","false",38],",",["T_WHITESPACE"," ",38],["T_STRING","false",38],")",",",["T_WHITESPACE","\n\t\t\t",38],["T_CONSTANT_ENCAPSED_STRING","'CURRENCY'",39],["T_WHITESPACE","          ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$order_info",39],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",39],"]",",",["T_WHITESPACE","\n\t\t\t",39],["T_CONSTANT_ENCAPSED_STRING","'CREATESECURETOKEN'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'Y'",40],",",["T_WHITESPACE","\n\t\t\t",40],["T_CONSTANT_ENCAPSED_STRING","'SECURETOKENID'",41],["T_WHITESPACE","     ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$secure_token_id",41],",",["T_WHITESPACE","\n\t\t\t",41],["T_CONSTANT_ENCAPSED_STRING","'BILLTOFIRSTNAME'",42],["T_WHITESPACE","   ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$order_info",42],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",42],"]",",",["T_WHITESPACE","\n\t\t\t",42],["T_CONSTANT_ENCAPSED_STRING","'BILLTOLASTNAME'",43],["T_WHITESPACE","    ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$order_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",43],"]",",",["T_WHITESPACE","\n\t\t\t",43],["T_CONSTANT_ENCAPSED_STRING","'BILLTOSTREET'",44],["T_WHITESPACE","      ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_STRING","trim",44],"(",["T_VARIABLE","$order_info",44],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",44],"]",["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","' '",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_VARIABLE","$order_info",44],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",44],"]",")",",",["T_WHITESPACE","\n\t\t\t",44],["T_CONSTANT_ENCAPSED_STRING","'BILLTOCITY'",45],["T_WHITESPACE","        ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$order_info",45],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",45],"]",",",["T_WHITESPACE","\n\t\t\t",45],["T_CONSTANT_ENCAPSED_STRING","'BILLTOSTATE'",46],["T_WHITESPACE","       ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$payment_zone",46],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",46],"]",",",["T_WHITESPACE","\n\t\t\t",46],["T_CONSTANT_ENCAPSED_STRING","'BILLTOZIP'",47],["T_WHITESPACE","         ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$order_info",47],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",47],"]",",",["T_WHITESPACE","\n\t\t\t",47],["T_CONSTANT_ENCAPSED_STRING","'BILLTOCOUNTRY'",48],["T_WHITESPACE","     ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$payment_country",48],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",48],"]",",",["T_WHITESPACE","\n\t\t",48],")",";",["T_WHITESPACE","\n\n\t\t",49],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_VARIABLE","$shipping_country",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n\t\t\t",51],["T_VARIABLE","$url_params",52],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOFIRSTNAME'",52],"]",["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$order_info",52],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",52],"]",";",["T_WHITESPACE","\n\t\t\t",52],["T_VARIABLE","$url_params",53],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOLASTNAME'",53],"]",["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$order_info",53],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",53],"]",";",["T_WHITESPACE","\n\t\t\t",53],["T_VARIABLE","$url_params",54],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOSTREET'",54],"]",["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","trim",54],"(",["T_VARIABLE","$order_info",54],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",54],"]",["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","' '",54],["T_WHITESPACE"," ",54],".",["T_WHITESPACE"," ",54],["T_VARIABLE","$order_info",54],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",54],"]",")",";",["T_WHITESPACE","\n\t\t\t",54],["T_VARIABLE","$url_params",55],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOCITY'",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$order_info",55],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",55],"]",";",["T_WHITESPACE","\n\t\t\t",55],["T_VARIABLE","$url_params",56],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOSTATE'",56],"]",["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$shipping_zone",56],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",56],"]",";",["T_WHITESPACE","\n\t\t\t",56],["T_VARIABLE","$url_params",57],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOZIP'",57],"]",["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$order_info",57],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",57],"]",";",["T_WHITESPACE","\n\t\t\t",57],["T_VARIABLE","$url_params",58],"[",["T_CONSTANT_ENCAPSED_STRING","'SHIPTOCOUNTRY'",58],"]",["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$shipping_country",58],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",58],"]",";",["T_WHITESPACE","\n\t\t",58],"}",["T_WHITESPACE","\n\n\t\t",59],["T_VARIABLE","$response_params",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","model_extension_payment_pp_payflow_iframe",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","call",61],"(",["T_VARIABLE","$url_params",61],")",";",["T_WHITESPACE","\n\n\t\t",61],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_ISSET","isset",63],"(",["T_VARIABLE","$response_params",63],"[",["T_CONSTANT_ENCAPSED_STRING","'SECURETOKEN'",63],"]",")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n\t\t\t",63],["T_VARIABLE","$secure_token",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$response_params",64],"[",["T_CONSTANT_ENCAPSED_STRING","'SECURETOKEN'",64],"]",";",["T_WHITESPACE","\n\t\t",64],"}",["T_WHITESPACE"," ",65],["T_ELSE","else",65],["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t\t",65],["T_VARIABLE","$secure_token",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","''",66],";",["T_WHITESPACE","\n\t\t",66],"}",["T_WHITESPACE","\n\n\t\t",67],["T_VARIABLE","$iframe_params",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_WHITESPACE","\n\t\t\t",69],["T_CONSTANT_ENCAPSED_STRING","'MODE'",70],["T_WHITESPACE","          ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$mode",70],",",["T_WHITESPACE","\n\t\t\t",70],["T_CONSTANT_ENCAPSED_STRING","'SECURETOKENID'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$secure_token_id",71],",",["T_WHITESPACE","\n\t\t\t",71],["T_CONSTANT_ENCAPSED_STRING","'SECURETOKEN'",72],["T_WHITESPACE","   ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$secure_token",72],",",["T_WHITESPACE","\n\t\t",72],")",";",["T_WHITESPACE","\n\n\t\t",73],["T_VARIABLE","$data",75],"[",["T_CONSTANT_ENCAPSED_STRING","'iframe_url'",75],"]",["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$payflow_url",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'?'",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_STRING","http_build_query",75],"(",["T_VARIABLE","$iframe_params",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","''",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","\"&\"",75],")",";",["T_WHITESPACE","\n\t\t",75],["T_VARIABLE","$data",76],"[",["T_CONSTANT_ENCAPSED_STRING","'checkout_method'",76],"]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","config",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","get",76],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_payflow_iframe_checkout_method'",76],")",";",["T_WHITESPACE","\n\t\t",76],["T_VARIABLE","$data",77],"[",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",77],"]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","language",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","get",77],"(",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",77],")",";",["T_WHITESPACE","\n\n\t\t",77],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","load",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","view",79],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pp_payflow_iframe'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$data",79],")",";",["T_WHITESPACE","\n\t",79],"}",["T_WHITESPACE","\n\n\t",80],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","paymentReturn",82],"(",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n\t\t",82],["T_VARIABLE","$data",83],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",83],"]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","url",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","link",83],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",83],")",";",["T_WHITESPACE","\n\n\t\t",83],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","response",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","setOutput",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","load",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","view",85],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pp_payflow_iframe_return'",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$data",85],")",")",";",["T_WHITESPACE","\n\t",85],"}",["T_WHITESPACE","\n\n\t",86],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","paymentCancel",88],"(",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n\t\t",88],["T_VARIABLE","$data",89],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",89],"]",["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","url",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","link",89],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",89],")",";",["T_WHITESPACE","\n\n\t\t",89],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","response",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","setOutput",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","load",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","view",91],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pp_payflow_iframe_return'",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$data",91],")",")",";",["T_WHITESPACE","\n\t",91],"}",["T_WHITESPACE","\n\n\t",92],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","paymentError",94],"(",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n\t\t",94],["T_VARIABLE","$data",95],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",95],"]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","url",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","link",95],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",95],")",";",["T_WHITESPACE","\n\n\t\t",95],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","response",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","setOutput",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","load",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","view",97],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pp_payflow_iframe_return'",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$data",97],")",")",";",["T_WHITESPACE","\n\t",97],"}",["T_WHITESPACE","\n\n\t",98],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","paymentIpn",100],"(",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n\t\t",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","load",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","model",101],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pp_payflow_iframe'",101],")",";",["T_WHITESPACE","\n\t\t",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","load",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","model",102],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",102],")",";",["T_WHITESPACE","\n\n\t\t",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","config",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","get",104],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe_debug'",104],")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n\t\t\t",104],["T_VARIABLE","$log",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","Log",105],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_pro_iframe.log'",105],")",";",["T_WHITESPACE","\n\t\t\t",105],["T_VARIABLE","$log",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","write",106],"(",["T_CONSTANT_ENCAPSED_STRING","'POST: '",106],["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_STRING","print_r",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","request",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","post",106],",",["T_WHITESPACE"," ",106],["T_LNUMBER","1",106],")",")",";",["T_WHITESPACE","\n\t\t",106],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\n\t\t",107],["T_VARIABLE","$order_id",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","model_extension_payment_pp_payflow_iframe",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getOrderId",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","request",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","post",109],"[",["T_CONSTANT_ENCAPSED_STRING","'SECURETOKENID'",109],"]",")",";",["T_WHITESPACE","\n\n\t\t",109],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$order_id",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n\t\t\t",111],["T_VARIABLE","$order_info",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","model_checkout_order",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getOrder",112],"(",["T_VARIABLE","$order_id",112],")",";",["T_WHITESPACE","\n\n\t\t\t",112],["T_VARIABLE","$url_params",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_WHITESPACE","\n\t\t\t\t",114],["T_CONSTANT_ENCAPSED_STRING","'TENDER'",115],["T_WHITESPACE","  ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'C'",115],",",["T_WHITESPACE","\n\t\t\t\t",115],["T_CONSTANT_ENCAPSED_STRING","'TRXTYPE'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'I'",116],",",["T_WHITESPACE","\n\t\t\t\t",116],["T_CONSTANT_ENCAPSED_STRING","'ORIGID'",117],["T_WHITESPACE","  ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","request",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","post",117],"[",["T_CONSTANT_ENCAPSED_STRING","'PNREF'",117],"]",",",["T_WHITESPACE","\n\t\t\t",117],")",";",["T_WHITESPACE","\n\n\t\t\t",118],["T_VARIABLE","$response_params",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","model_extension_payment_pp_payflow_iframe",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","call",120],"(",["T_VARIABLE","$url_params",120],")",";",["T_WHITESPACE","\n\n\t\t\t",120],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$order_info",122],"[",["T_CONSTANT_ENCAPSED_STRING","'order_status_id'",122],"]",["T_WHITESPACE"," ",122],["T_IS_EQUAL","==",122],["T_WHITESPACE"," ",122],["T_LNUMBER","0",122],["T_WHITESPACE"," ",122],["T_BOOLEAN_AND","&&",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$response_params",122],"[",["T_CONSTANT_ENCAPSED_STRING","'RESULT'",122],"]",["T_WHITESPACE"," ",122],["T_IS_EQUAL","==",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'0'",122],["T_WHITESPACE"," ",122],["T_BOOLEAN_AND","&&",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","request",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","post",122],"[",["T_CONSTANT_ENCAPSED_STRING","'RESULT'",122],"]",["T_WHITESPACE"," ",122],["T_IS_EQUAL","==",122],["T_WHITESPACE"," ",122],["T_LNUMBER","0",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n\t\t\t\t",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","model_checkout_order",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","addOrderHistory",123],"(",["T_VARIABLE","$order_id",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","config",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","get",123],"(",["T_CONSTANT_ENCAPSED_STRING","'pp_payflow_iframe_order_status_id'",123],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",123],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","request",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","post",125],"[",["T_CONSTANT_ENCAPSED_STRING","'TYPE'",125],"]",["T_WHITESPACE"," ",125],["T_IS_EQUAL","==",125],["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'S'",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n\t\t\t\t\t",125],["T_VARIABLE","$complete",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_LNUMBER","1",126],";",["T_WHITESPACE","\n\t\t\t\t",126],"}",["T_WHITESPACE"," ",127],["T_ELSE","else",127],["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n\t\t\t\t\t",127],["T_VARIABLE","$complete",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_LNUMBER","0",128],";",["T_WHITESPACE","\n\t\t\t\t",128],"}",["T_WHITESPACE","\n\n\t\t\t\t",129],["T_VARIABLE","$data",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",["T_WHITESPACE","\n\t\t\t\t\t",131],["T_CONSTANT_ENCAPSED_STRING","'secure_token_id'",132],["T_WHITESPACE","       ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","request",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","post",132],"[",["T_CONSTANT_ENCAPSED_STRING","'SECURETOKENID'",132],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",132],["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","request",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","post",133],"[",["T_CONSTANT_ENCAPSED_STRING","'PNREF'",133],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",133],["T_CONSTANT_ENCAPSED_STRING","'transaction_type'",134],["T_WHITESPACE","      ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","request",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","post",134],"[",["T_CONSTANT_ENCAPSED_STRING","'TYPE'",134],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",134],["T_CONSTANT_ENCAPSED_STRING","'complete'",135],["T_WHITESPACE","              ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$complete",135],",",["T_WHITESPACE","\n\t\t\t\t",135],")",";",["T_WHITESPACE","\n\n\t\t\t\t",136],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","model_extension_payment_pp_payflow_iframe",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","updateOrder",138],"(",["T_VARIABLE","$data",138],")",";",["T_WHITESPACE","\n\n\t\t\t\t",138],["T_VARIABLE","$data",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_ARRAY","array",140],"(",["T_WHITESPACE","\n\t\t\t\t\t",140],["T_CONSTANT_ENCAPSED_STRING","'order_id'",141],["T_WHITESPACE","              ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$order_id",141],",",["T_WHITESPACE","\n\t\t\t\t\t",141],["T_CONSTANT_ENCAPSED_STRING","'type'",142],["T_WHITESPACE","                  ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","request",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","post",142],"[",["T_CONSTANT_ENCAPSED_STRING","'TYPE'",142],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",142],["T_CONSTANT_ENCAPSED_STRING","'transaction_reference'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","request",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","post",143],"[",["T_CONSTANT_ENCAPSED_STRING","'PNREF'",143],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",143],["T_CONSTANT_ENCAPSED_STRING","'amount'",144],["T_WHITESPACE","                ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","request",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","post",144],"[",["T_CONSTANT_ENCAPSED_STRING","'AMT'",144],"]",",",["T_WHITESPACE","\n\t\t\t\t",144],")",";",["T_WHITESPACE","\n\n\t\t\t\t",145],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","model_extension_payment_pp_payflow_iframe",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","addTransaction",147],"(",["T_VARIABLE","$data",147],")",";",["T_WHITESPACE","\n\t\t\t",147],"}",["T_WHITESPACE","\n\t\t",148],"}",["T_WHITESPACE","\n\n\t\t",149],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","response",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","setOutput",151],"(",["T_CONSTANT_ENCAPSED_STRING","'Ok'",151],")",";",["T_WHITESPACE","\n\t",151],"}",["T_WHITESPACE","\n",152],"}"]