[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionPaymentKlarnaCheckout",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","index",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","load",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","language",4],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","load",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","model",6],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",6],")",";",["T_WHITESPACE","\n\t\t",6],["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","load",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","model",7],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/country'",7],")",";",["T_WHITESPACE","\n\n\t\t",7],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","document",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","setTitle",9],"(",["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","language",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","get",9],"(",["T_CONSTANT_ENCAPSED_STRING","'heading_title'",9],")",")",";",["T_WHITESPACE","\n\n\t\t",9],["T_VARIABLE","$data",11],"[",["T_CONSTANT_ENCAPSED_STRING","'column_left'",11],"]",["T_WHITESPACE"," ",11],"=",["T_WHITESPACE"," ",11],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","load",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","controller",11],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/column_left'",11],")",";",["T_WHITESPACE","\n\t\t",11],["T_VARIABLE","$data",12],"[",["T_CONSTANT_ENCAPSED_STRING","'column_right'",12],"]",["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_VARIABLE","$this",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","load",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","controller",12],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/column_right'",12],")",";",["T_WHITESPACE","\n\t\t",12],["T_VARIABLE","$data",13],"[",["T_CONSTANT_ENCAPSED_STRING","'content_top'",13],"]",["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","load",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","controller",13],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/content_top'",13],")",";",["T_WHITESPACE","\n\t\t",13],["T_VARIABLE","$data",14],"[",["T_CONSTANT_ENCAPSED_STRING","'content_bottom'",14],"]",["T_WHITESPACE"," ",14],"=",["T_WHITESPACE"," ",14],["T_VARIABLE","$this",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","load",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","controller",14],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/content_bottom'",14],")",";",["T_WHITESPACE","\n\t\t",14],["T_VARIABLE","$data",15],"[",["T_CONSTANT_ENCAPSED_STRING","'footer'",15],"]",["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","load",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","controller",15],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/footer'",15],")",";",["T_WHITESPACE","\n\t\t",15],["T_VARIABLE","$data",16],"[",["T_CONSTANT_ENCAPSED_STRING","'header'",16],"]",["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","load",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","controller",16],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/header'",16],")",";",["T_WHITESPACE","\n\n\t\t",16],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","response",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","setOutput",18],"(",["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","load",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","view",18],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",18],",",["T_WHITESPACE"," ",18],["T_VARIABLE","$data",18],")",")",";",["T_WHITESPACE","\n\t",18],"}",["T_WHITESPACE","\n\n\t",19],["T_PUBLIC","public",21],["T_WHITESPACE"," ",21],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","main",21],"(",")",["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\t\t",21],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","load",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","language",22],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",22],")",";",["T_WHITESPACE","\n\n\t\t",22],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","load",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","model",24],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",24],")",";",["T_WHITESPACE","\n\t\t",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","load",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","model",25],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/country'",25],")",";",["T_WHITESPACE","\n\n\t\t",25],["T_VARIABLE","$redirect",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_STRING","false",27],";",["T_WHITESPACE","\n\t\t",27],["T_VARIABLE","$html_snippet",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","''",28],";",["T_WHITESPACE","\n\n\t\t",28],["T_COMMENT","\/\/ Validate cart has products and has stock.\n",30],["T_WHITESPACE","\t\t",31],["T_IF","if",31],["T_WHITESPACE"," ",31],"(","(","!",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","cart",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","hasProducts",31],"(",")",["T_WHITESPACE"," ",31],["T_BOOLEAN_AND","&&",31],["T_WHITESPACE"," ",31],["T_EMPTY","empty",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","session",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","data",31],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",31],"]",")",")",["T_WHITESPACE"," ",31],["T_BOOLEAN_OR","||",31],["T_WHITESPACE"," ",31],"(","!",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","cart",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","hasStock",31],"(",")",["T_WHITESPACE"," ",31],["T_BOOLEAN_AND","&&",31],["T_WHITESPACE"," ",31],"!",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","config",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","get",31],"(",["T_CONSTANT_ENCAPSED_STRING","'config_stock_checkout'",31],")",")",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n\t\t\t",31],["T_VARIABLE","$redirect",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","url",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","link",32],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",32],")",";",["T_WHITESPACE","\n\t\t",32],"}",["T_WHITESPACE","\n\n\t\t",33],["T_COMMENT","\/\/ Validate minimum quantity requirements.\n",35],["T_WHITESPACE","\t\t",36],["T_VARIABLE","$products",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","cart",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getProducts",36],"(",")",";",["T_WHITESPACE","\n\n\t\t",36],["T_FOREACH","foreach",38],["T_WHITESPACE"," ",38],"(",["T_VARIABLE","$products",38],["T_WHITESPACE"," ",38],["T_AS","as",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$product",38],")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n\t\t\t",38],["T_VARIABLE","$product_total",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_LNUMBER","0",39],";",["T_WHITESPACE","\n\n\t\t\t",39],["T_FOREACH","foreach",41],["T_WHITESPACE"," ",41],"(",["T_VARIABLE","$products",41],["T_WHITESPACE"," ",41],["T_AS","as",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$product_2",41],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n\t\t\t\t",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(",["T_VARIABLE","$product_2",42],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",42],"]",["T_WHITESPACE"," ",42],["T_IS_EQUAL","==",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$product",42],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",42],"]",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n\t\t\t\t\t",42],["T_VARIABLE","$product_total",43],["T_WHITESPACE"," ",43],["T_PLUS_EQUAL","+=",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$product_2",43],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",43],"]",";",["T_WHITESPACE","\n\t\t\t\t",43],"}",["T_WHITESPACE","\n\t\t\t",44],"}",["T_WHITESPACE","\n\n\t\t\t",45],["T_IF","if",47],["T_WHITESPACE"," ",47],"(",["T_VARIABLE","$product",47],"[",["T_CONSTANT_ENCAPSED_STRING","'minimum'",47],"]",["T_WHITESPACE"," ",47],">",["T_WHITESPACE"," ",47],["T_VARIABLE","$product_total",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n\t\t\t\t",47],["T_VARIABLE","$redirect",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","url",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","link",48],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",48],")",";",["T_WHITESPACE","\n\t\t\t",48],"}",["T_WHITESPACE","\n\t\t",49],"}",["T_WHITESPACE","\n\n\t\t",50],["T_COMMENT","\/\/ Validate cart has recurring products\n",52],["T_WHITESPACE","\t\t",53],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","cart",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","hasRecurringProducts",53],"(",")",")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n\t\t\t",53],["T_VARIABLE","$redirect",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","url",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","link",54],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",54],")",";",["T_WHITESPACE","\n\t\t",54],"}",["T_WHITESPACE","\n\n\t\t",55],["T_LIST","list",57],"(",["T_VARIABLE","$totals",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$taxes",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$total",57],")",["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","model_extension_payment_klarna_checkout",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getTotals",57],"(",")",";",["T_WHITESPACE","\n\n\t\t",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","config",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_total'",59],")",["T_WHITESPACE"," ",59],">",["T_WHITESPACE"," ",59],["T_LNUMBER","0",59],["T_WHITESPACE"," ",59],["T_BOOLEAN_AND","&&",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","config",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_total'",59],")",["T_WHITESPACE"," ",59],">",["T_WHITESPACE"," ",59],["T_VARIABLE","$total",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n\t\t\t",59],["T_VARIABLE","$redirect",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","url",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","link",60],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",60],")",";",["T_WHITESPACE","\n\t\t",60],"}",["T_WHITESPACE","\n\n\t\t",61],["T_IF","if",63],["T_WHITESPACE"," ",63],"(","!",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","config",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","get",63],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",63],")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n\t\t\t",63],["T_VARIABLE","$redirect",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","url",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","link",64],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",64],")",";",["T_WHITESPACE","\n\t\t",64],"}",["T_WHITESPACE","\n\n\t\t",65],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","model_extension_payment_klarna_checkout",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","checkForPaymentTaxes",67],"(",["T_VARIABLE","$products",67],")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n\t\t\t",67],["T_VARIABLE","$redirect",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","url",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","link",68],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",68],")",";",["T_WHITESPACE","\n\t\t",68],"}",["T_WHITESPACE","\n\n\t\t",69],["T_VARIABLE","$text_title",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","language",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","get",71],"(",["T_CONSTANT_ENCAPSED_STRING","'text_title'",71],")",";",["T_WHITESPACE","\n\n\t\t",71],["T_UNSET","unset",73],"(",["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","session",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","data",73],"[",["T_CONSTANT_ENCAPSED_STRING","'success'",73],"]",")",";",["T_WHITESPACE","\n\n\t\t",73],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","setPayment",75],"(",")",";",["T_WHITESPACE","\n\t\t",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","setShipping",76],"(",")",";",["T_WHITESPACE","\n\n\t\t",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","session",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","data",78],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",78],"]",["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_ARRAY","array",78],"(",["T_WHITESPACE","\n\t\t\t",78],["T_CONSTANT_ENCAPSED_STRING","'code'",79],["T_WHITESPACE","       ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout'",79],",",["T_WHITESPACE","\n\t\t\t",79],["T_CONSTANT_ENCAPSED_STRING","'title'",80],["T_WHITESPACE","      ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$text_title",80],",",["T_WHITESPACE","\n\t\t\t",80],["T_CONSTANT_ENCAPSED_STRING","'terms'",81],["T_WHITESPACE","      ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","url",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","link",81],"(",["T_CONSTANT_ENCAPSED_STRING","'information\/information'",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'information_id='",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","config",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","get",81],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_terms'",81],")",",",["T_WHITESPACE"," ",81],["T_STRING","true",81],")",",",["T_WHITESPACE","\n\t\t\t",81],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'1'",82],["T_WHITESPACE","\n\t\t",82],")",";",["T_WHITESPACE","\n\n\t\t",83],["T_COMMENT","\/\/ Shipping\n",85],["T_WHITESPACE","\t\t",86],["T_VARIABLE","$unset_shipping_method",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","true",86],";",["T_WHITESPACE","\n\t\t",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_ISSET","isset",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","session",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","data",87],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",87],"]",")",["T_WHITESPACE"," ",87],["T_BOOLEAN_AND","&&",87],["T_WHITESPACE"," ",87],["T_ISSET","isset",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","session",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","data",87],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",87],"]",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n\t\t\t",87],["T_FOREACH","foreach",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","session",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","data",88],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",88],"]",["T_WHITESPACE"," ",88],["T_AS","as",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$shipping_method",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n\t\t\t\t",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$shipping_method",89],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",89],"]",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n\t\t\t\t\t",89],["T_FOREACH","foreach",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$shipping_method",90],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",90],"]",["T_WHITESPACE"," ",90],["T_AS","as",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$quote",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$quote",91],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",91],"]",["T_WHITESPACE"," ",91],["T_IS_EQUAL","==",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","session",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","data",91],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",91],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",91],"]",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",91],["T_VARIABLE","$unset_shipping_method",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","false",92],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",92],["T_BREAK","break",93],["T_WHITESPACE"," ",93],["T_LNUMBER","2",93],";",["T_WHITESPACE","\n\t\t\t\t\t\t",93],"}",["T_WHITESPACE","\n\t\t\t\t\t",94],"}",["T_WHITESPACE","\n\t\t\t\t",95],"}",["T_WHITESPACE","\n\t\t\t",96],"}",["T_WHITESPACE","\n\t\t",97],"}",["T_WHITESPACE","\n\n\t\t",98],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$unset_shipping_method",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n\t\t\t",100],["T_UNSET","unset",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","session",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","data",101],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",101],"]",")",";",["T_WHITESPACE","\n\t\t",101],"}",["T_WHITESPACE","\n\n\t\t",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(","(","!",["T_ISSET","isset",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","session",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","data",104],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",104],"]",")",["T_WHITESPACE"," ",104],["T_BOOLEAN_OR","||",104],["T_WHITESPACE"," ",104],["T_EMPTY","empty",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","session",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","data",104],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",104],"]",")",")",["T_WHITESPACE"," ",104],["T_BOOLEAN_AND","&&",104],["T_WHITESPACE"," ",104],"(",["T_ISSET","isset",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","session",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","data",104],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",104],"]",")",["T_WHITESPACE"," ",104],["T_BOOLEAN_AND","&&",104],["T_WHITESPACE"," ",104],"!",["T_EMPTY","empty",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","session",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","data",104],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",104],"]",")",")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n\t\t\t",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","session",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","data",105],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",105],"]",["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","model_extension_payment_klarna_checkout",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getDefaultShippingMethod",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","session",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","data",105],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",105],"]",")",";",["T_WHITESPACE","\n\t\t",105],"}",["T_WHITESPACE","\n\n\t\t",106],["T_COMMENT","\/\/Klarna Connector\n",108],["T_WHITESPACE","\t\t",109],["T_LIST","list",109],"(",["T_VARIABLE","$klarna_account",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$connector",109],")",["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","model_extension_payment_klarna_checkout",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getConnector",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","config",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","get",109],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",109],")",",",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","session",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","data",109],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",109],"]",")",";",["T_WHITESPACE","\n\n\t\t",109],["T_IF","if",111],["T_WHITESPACE"," ",111],"(","!",["T_VARIABLE","$klarna_account",111],["T_WHITESPACE"," ",111],["T_BOOLEAN_OR","||",111],["T_WHITESPACE"," ",111],"!",["T_VARIABLE","$connector",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n\t\t\t",111],["T_VARIABLE","$redirect",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","url",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","link",112],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",112],")",";",["T_WHITESPACE","\n\t\t",112],"}",["T_WHITESPACE","\n\n\t\t",113],["T_IF","if",115],["T_WHITESPACE"," ",115],"(","!",["T_VARIABLE","$redirect",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n\t\t\t",115],["T_COMMENT","\/\/ Get currency code and currency value to use to calculate taxes\n",116],["T_WHITESPACE","\n\t\t\t",117],["T_COMMENT","\/\/ Build order_lines\n",118],["T_WHITESPACE","\t\t\t",119],["T_VARIABLE","$create_order",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","true",119],";",["T_WHITESPACE","\n\t\t\t",119],["T_VARIABLE","$klarna_checkout",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","false",120],";",["T_WHITESPACE","\n\n\t\t\t",120],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","createOrder",122],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",122],["T_LIST","list",124],"(",["T_VARIABLE","$klarna_order_data",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$encrypted_order_data",124],")",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","klarnaOrderData",124],"(",["T_VARIABLE","$klarna_account",124],")",";",["T_WHITESPACE","\n\n\t\t\t",124],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_ISSET","isset",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","session",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","data",126],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_currency'",126],"]",")",["T_WHITESPACE"," ",126],["T_BOOLEAN_AND","&&",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","session",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","data",126],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_currency'",126],"]",["T_WHITESPACE"," ",126],["T_IS_NOT_EQUAL","!=",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","session",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","data",126],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",126],"]",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n\t\t\t\t",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","model_extension_payment_klarna_checkout",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","log",127],"(",["T_CONSTANT_ENCAPSED_STRING","'Currency changed, unsetting kc order id'",127],")",";",["T_WHITESPACE","\n\t\t\t\t",127],["T_UNSET","unset",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","session",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","data",128],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_id'",128],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",128],["T_UNSET","unset",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","session",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","data",129],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",129],"]",")",";",["T_WHITESPACE","\n\t\t\t",129],"}",["T_WHITESPACE","\n\n\t\t\t",130],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","session",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","data",132],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_currency'",132],"]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","session",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","data",132],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",132],"]",";",["T_WHITESPACE","\n\n\t\t\t",132],["T_COMMENT","\/\/ Fetch or create order\n",134],["T_WHITESPACE","\t\t\t",135],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_ISSET","isset",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","session",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","data",135],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_id'",135],"]",")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n\t\t\t\t",135],["T_VARIABLE","$retrieve",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","model_extension_payment_klarna_checkout",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","orderRetrieve",136],"(",["T_VARIABLE","$connector",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","session",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","data",136],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_id'",136],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$retrieve",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n\t\t\t\t\t",138],["T_COMMENT","\/\/If address has changed, unset klarna_checkout_order_id and create new order\n",139],["T_WHITESPACE","\t\t\t\t\t",140],["T_VARIABLE","$address_change",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","false",140],";",["T_WHITESPACE","\n\n\t\t\t\t\t",140],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_ISSET","isset",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","session",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","data",142],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",142],"]",")",["T_WHITESPACE"," ",142],["T_BOOLEAN_AND","&&",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","session",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","data",142],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",142],"]",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_ISSET","isset",143],"(",["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","session",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","data",143],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",143],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_code'",143],"]",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",143],["T_VARIABLE","$kc_region",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","session",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","data",144],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",144],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_code'",144],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",144],"}",["T_WHITESPACE"," ",145],["T_ELSE","else",145],["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",145],["T_VARIABLE","$kc_region",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","''",146],";",["T_WHITESPACE","\n\t\t\t\t\t\t",146],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",147],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_ISSET","isset",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","session",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","data",149],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",149],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",149],"]",")",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",149],["T_VARIABLE","$kc_country",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","session",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","data",150],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",150],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",150],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",150],"}",["T_WHITESPACE"," ",151],["T_ELSE","else",151],["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",151],["T_VARIABLE","$kc_country",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","''",152],";",["T_WHITESPACE","\n\t\t\t\t\t\t",152],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",153],["T_IF","if",155],["T_WHITESPACE"," ",155],"(",["T_ISSET","isset",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","session",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",155],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_code'",155],"]",")",")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",155],["T_VARIABLE","$oc_region",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","session",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","data",156],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",156],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_code'",156],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",156],"}",["T_WHITESPACE"," ",157],["T_ELSE","else",157],["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",157],["T_VARIABLE","$oc_region",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","''",158],";",["T_WHITESPACE","\n\t\t\t\t\t\t",158],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",159],["T_IF","if",161],["T_WHITESPACE"," ",161],"(",["T_ISSET","isset",161],"(",["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","session",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","data",161],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",161],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",161],"]",")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",161],["T_VARIABLE","$oc_country",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","session",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","data",162],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",162],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",162],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",162],"}",["T_WHITESPACE"," ",163],["T_ELSE","else",163],["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",163],["T_VARIABLE","$oc_country",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","''",164],";",["T_WHITESPACE","\n\t\t\t\t\t\t",164],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",165],["T_VARIABLE","$kc_address",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",167],["T_CONSTANT_ENCAPSED_STRING","'region'",168],["T_WHITESPACE","  ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$kc_region",168],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",168],["T_CONSTANT_ENCAPSED_STRING","'country'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$kc_country",169],",",["T_WHITESPACE","\n\t\t\t\t\t\t",169],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",170],["T_VARIABLE","$oc_address",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",172],["T_CONSTANT_ENCAPSED_STRING","'region'",173],["T_WHITESPACE","  ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$oc_region",173],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",173],["T_CONSTANT_ENCAPSED_STRING","'country'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$oc_country",174],",",["T_WHITESPACE","\n\t\t\t\t\t\t",174],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",175],["T_COMMENT","\/\/If address has changed, dont use retrieved order, create new one instead\n",177],["T_WHITESPACE","\t\t\t\t\t\t",178],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_STRING","array_diff",178],"(",["T_STRING","array_map",178],"(",["T_CONSTANT_ENCAPSED_STRING","'strtolower'",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$kc_address",178],")",",",["T_WHITESPACE"," ",178],["T_STRING","array_map",178],"(",["T_CONSTANT_ENCAPSED_STRING","'strtolower'",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$oc_address",178],")",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",178],["T_VARIABLE","$address_change",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING","true",179],";",["T_WHITESPACE","\n\t\t\t\t\t\t",179],"}",["T_WHITESPACE","\n\t\t\t\t\t",180],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",181],["T_IF","if",183],["T_WHITESPACE"," ",183],"(","!",["T_VARIABLE","$address_change",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                        ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","model_extension_payment_klarna_checkout",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","log",184],"(",["T_CONSTANT_ENCAPSED_STRING","'Order Updated'",184],")",";",["T_WHITESPACE","\n                        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","model_extension_payment_klarna_checkout",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","log",185],"(",["T_VARIABLE","$klarna_order_data",185],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",185],["T_VARIABLE","$create_order",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_STRING","false",187],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",187],["T_VARIABLE","$update",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","model_extension_payment_klarna_checkout",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","orderUpdate",189],"(",["T_VARIABLE","$connector",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","session",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","data",189],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_id'",189],"]",",",["T_WHITESPACE"," ",189],["T_VARIABLE","$klarna_order_data",189],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",189],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$update",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",191],["T_VARIABLE","$klarna_checkout",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$update",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","fetch",192],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",192],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","model_extension_payment_klarna_checkout",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","updateOrder",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","session",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","data",194],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",194],"]",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$klarna_checkout",194],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",194],"]",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$encrypted_order_data",194],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",194],"}",["T_WHITESPACE","\n\t\t\t\t\t",195],"}",["T_WHITESPACE","\n\t\t\t\t",196],"}",["T_WHITESPACE","\n\t\t\t",197],"}",["T_WHITESPACE","\n\n\t\t\t",198],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$create_order",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n\t\t\t\t",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","model_extension_payment_klarna_checkout",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","log",201],"(",["T_CONSTANT_ENCAPSED_STRING","'Order Created'",201],")",";",["T_WHITESPACE","\n\t\t\t\t",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","model_extension_payment_klarna_checkout",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","log",202],"(",["T_VARIABLE","$klarna_order_data",202],")",";",["T_WHITESPACE","\n\n\t\t\t\t",202],["T_UNSET","unset",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","session",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","data",204],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",204],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",204],["T_VARIABLE","$create",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","model_extension_payment_klarna_checkout",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","orderCreate",206],"(",["T_VARIABLE","$connector",206],",",["T_WHITESPACE"," ",206],["T_VARIABLE","$klarna_order_data",206],")",";",["T_WHITESPACE","\n\n\t\t\t\t",206],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$create",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n\t\t\t\t\t",208],["T_VARIABLE","$klarna_checkout",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$create",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","fetch",209],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",209],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","model_extension_payment_klarna_checkout",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","addOrder",211],"(",["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","session",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","data",211],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",211],"]",",",["T_WHITESPACE"," ",211],["T_VARIABLE","$klarna_checkout",211],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",211],"]",",",["T_WHITESPACE"," ",211],["T_VARIABLE","$encrypted_order_data",211],")",";",["T_WHITESPACE","\n\t\t\t\t",211],"}",["T_WHITESPACE","\n\t\t\t",212],"}",["T_WHITESPACE","\n\n\t\t\t",213],["T_IF","if",215],["T_WHITESPACE"," ",215],"(",["T_VARIABLE","$klarna_checkout",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n\t\t\t\t",215],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","session",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","data",216],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_id'",216],"]",["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$klarna_checkout",216],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",216],"]",";",["T_WHITESPACE","\n\n\t\t\t\t",216],["T_VARIABLE","$html_snippet",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$klarna_checkout",218],"[",["T_CONSTANT_ENCAPSED_STRING","'html_snippet'",218],"]",";",["T_WHITESPACE","\n\t\t\t",218],"}",["T_WHITESPACE","\n\t\t",219],"}",["T_WHITESPACE","\n\n\t\t",220],["T_IF","if",222],["T_WHITESPACE"," ",222],"(",["T_ISSET","isset",222],"(",["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","request",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","post",222],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",222],"]",")",["T_WHITESPACE"," ",222],["T_BOOLEAN_AND","&&",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","request",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","post",222],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",222],"]",["T_WHITESPACE"," ",222],["T_IS_EQUAL","==",222],["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'template'",222],")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n\t\t\t",222],["T_VARIABLE","$data",223],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",223],"]",["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$redirect",223],";",["T_WHITESPACE","\n\n\t\t\t",223],["T_VARIABLE","$data",225],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout'",225],"]",["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$html_snippet",225],";",["T_WHITESPACE","\n\n\t\t\t",225],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","response",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","setOutput",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","load",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","view",227],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout_main'",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$data",227],")",")",";",["T_WHITESPACE","\n\t\t",227],"}",["T_WHITESPACE"," ",228],["T_ELSEIF","elseif",228],["T_WHITESPACE"," ",228],"(",["T_ISSET","isset",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","request",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","post",228],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",228],"]",")",["T_WHITESPACE"," ",228],["T_BOOLEAN_AND","&&",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","request",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","post",228],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",228],"]",["T_WHITESPACE"," ",228],["T_IS_EQUAL","==",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'json'",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n\t\t\t",228],["T_VARIABLE","$json",229],"[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",229],"]",["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$redirect",229],";",["T_WHITESPACE","\n\n\t\t\t",229],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","response",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","addHeader",231],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",231],")",";",["T_WHITESPACE","\n\t\t\t",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","response",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","setOutput",232],"(",["T_STRING","json_encode",232],"(",["T_VARIABLE","$json",232],")",")",";",["T_WHITESPACE","\n\t\t",232],"}",["T_WHITESPACE","\n\t",233],"}",["T_WHITESPACE","\n\n\t",234],["T_PUBLIC","public",236],["T_WHITESPACE"," ",236],["T_FUNCTION","function",236],["T_WHITESPACE"," ",236],["T_STRING","sidebar",236],"(",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n\t\t",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","load",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","language",237],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",237],")",";",["T_WHITESPACE","\n\t\t",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","load",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","language",238],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",238],")",";",["T_WHITESPACE","\n\n\t\t",238],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","load",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","model",240],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",240],")",";",["T_WHITESPACE","\n\n\t\t",240],["T_IF","if",242],["T_WHITESPACE"," ",242],"(","!",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","config",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","get",242],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",242],")",")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n\t\t\t",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_STRING","false",243],";",["T_WHITESPACE","\n\t\t",243],"}",["T_WHITESPACE","\n\n\t\t",244],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","setPayment",246],"(",")",";",["T_WHITESPACE","\n\t\t",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","setShipping",247],"(",")",";",["T_WHITESPACE","\n\n\t\t",247],["T_COMMENT","\/\/ Shipping\n",249],["T_WHITESPACE","\t\t",250],["T_VARIABLE","$unset_shipping_method",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","true",250],";",["T_WHITESPACE","\n\t\t",250],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_ISSET","isset",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","session",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","data",251],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",251],"]",")",["T_WHITESPACE"," ",251],["T_BOOLEAN_AND","&&",251],["T_WHITESPACE"," ",251],["T_ISSET","isset",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","session",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","data",251],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",251],"]",")",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n\t\t\t",251],["T_FOREACH","foreach",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","session",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","data",252],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",252],"]",["T_WHITESPACE"," ",252],["T_AS","as",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$shipping_method",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n\t\t\t\t",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$shipping_method",253],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",253],"]",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n\t\t\t\t\t",253],["T_FOREACH","foreach",254],["T_WHITESPACE"," ",254],"(",["T_VARIABLE","$shipping_method",254],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",254],"]",["T_WHITESPACE"," ",254],["T_AS","as",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$quote",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$quote",255],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",255],"]",["T_WHITESPACE"," ",255],["T_IS_EQUAL","==",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","session",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","data",255],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",255],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",255],"]",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",255],["T_VARIABLE","$unset_shipping_method",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_STRING","false",256],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",256],["T_BREAK","break",257],["T_WHITESPACE"," ",257],["T_LNUMBER","2",257],";",["T_WHITESPACE","\n\t\t\t\t\t\t",257],"}",["T_WHITESPACE","\n\t\t\t\t\t",258],"}",["T_WHITESPACE","\n\t\t\t\t",259],"}",["T_WHITESPACE","\n\t\t\t",260],"}",["T_WHITESPACE","\n\t\t",261],"}",["T_WHITESPACE","\n\n\t\t",262],["T_IF","if",264],["T_WHITESPACE"," ",264],"(",["T_VARIABLE","$unset_shipping_method",264],")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n\t\t\t",264],["T_UNSET","unset",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","session",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","data",265],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",265],"]",")",";",["T_WHITESPACE","\n\t\t",265],"}",["T_WHITESPACE","\n\n\t\t",266],["T_IF","if",268],["T_WHITESPACE"," ",268],"(","(","!",["T_ISSET","isset",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","session",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","data",268],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",268],"]",")",["T_WHITESPACE"," ",268],["T_BOOLEAN_OR","||",268],["T_WHITESPACE"," ",268],["T_EMPTY","empty",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","session",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","data",268],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",268],"]",")",")",["T_WHITESPACE"," ",268],["T_BOOLEAN_AND","&&",268],["T_WHITESPACE"," ",268],"(",["T_ISSET","isset",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","session",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","data",268],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",268],"]",")",["T_WHITESPACE"," ",268],["T_BOOLEAN_AND","&&",268],["T_WHITESPACE"," ",268],"!",["T_EMPTY","empty",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","session",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","data",268],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",268],"]",")",")",")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n\t\t\t",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","session",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","data",269],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",269],"]",["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","model_extension_payment_klarna_checkout",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getDefaultShippingMethod",269],"(",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","session",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","data",269],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",269],"]",")",";",["T_WHITESPACE","\n\t\t",269],"}",["T_WHITESPACE","\n\n\t\t",270],["T_VARIABLE","$data",272],"[",["T_CONSTANT_ENCAPSED_STRING","'text_choose_shipping_method'",272],"]",["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","language",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","get",272],"(",["T_CONSTANT_ENCAPSED_STRING","'text_choose_shipping_method'",272],")",";",["T_WHITESPACE","\n\t\t",272],["T_VARIABLE","$data",273],"[",["T_CONSTANT_ENCAPSED_STRING","'text_shipping_method'",273],"]",["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","language",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","get",273],"(",["T_CONSTANT_ENCAPSED_STRING","'text_shipping_method'",273],")",";",["T_WHITESPACE","\n\t\t",273],["T_VARIABLE","$data",274],"[",["T_CONSTANT_ENCAPSED_STRING","'text_no_shipping'",274],"]",["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","language",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","get",274],"(",["T_CONSTANT_ENCAPSED_STRING","'error_no_shipping'",274],")",";",["T_WHITESPACE","\n\n\t\t",274],["T_VARIABLE","$data",276],"[",["T_CONSTANT_ENCAPSED_STRING","'button_remove'",276],"]",["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","language",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","get",276],"(",["T_CONSTANT_ENCAPSED_STRING","'button_remove'",276],")",";",["T_WHITESPACE","\n\n\t\t",276],["T_VARIABLE","$data",278],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_required'",278],"]",["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","cart",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","hasShipping",278],"(",")",";",["T_WHITESPACE","\n\n\t\t",278],["T_IF","if",280],["T_WHITESPACE"," ",280],"(",["T_ISSET","isset",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","session",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","data",280],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",280],"]",")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n\t\t\t",280],["T_VARIABLE","$data",281],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",281],"]",["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","session",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","data",281],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",281],"]",";",["T_WHITESPACE","\n\t\t",281],"}",["T_WHITESPACE"," ",282],["T_ELSE","else",282],["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n\t\t\t",282],["T_UNSET","unset",283],"(",["T_VARIABLE","$data",283],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",283],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",283],["T_VARIABLE","$data",285],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",285],"]",["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_ARRAY","array",285],"(",")",";",["T_WHITESPACE","\n\t\t",285],"}",["T_WHITESPACE","\n\n\t\t",286],["T_IF","if",288],["T_WHITESPACE"," ",288],"(",["T_ISSET","isset",288],"(",["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","session",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","data",288],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",288],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",288],"]",")",")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n\t\t\t",288],["T_VARIABLE","$data",289],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",289],"]",["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","session",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","data",289],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",289],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",289],"]",";",["T_WHITESPACE","\n\t\t",289],"}",["T_WHITESPACE"," ",290],["T_ELSE","else",290],["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n\t\t\t",290],["T_VARIABLE","$data",291],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",291],"]",["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","''",291],";",["T_WHITESPACE","\n\t\t",291],"}",["T_WHITESPACE","\n\n\t\t",292],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","load",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","model",294],"(",["T_CONSTANT_ENCAPSED_STRING","'tool\/image'",294],")",";",["T_WHITESPACE","\n\t\t",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","load",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","model",295],"(",["T_CONSTANT_ENCAPSED_STRING","'tool\/upload'",295],")",";",["T_WHITESPACE","\n\n\t\t",295],["T_VARIABLE","$data",297],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",297],"]",["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_ARRAY","array",297],"(",")",";",["T_WHITESPACE","\n\n\t\t",297],["T_FOREACH","foreach",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","cart",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getProducts",299],"(",")",["T_WHITESPACE"," ",299],["T_AS","as",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$product",299],")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n\t\t\t",299],["T_IF","if",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$product",300],"[",["T_CONSTANT_ENCAPSED_STRING","'image'",300],"]",")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n\t\t\t\t",300],["T_VARIABLE","$image",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","model_tool_image",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","resize",301],"(",["T_VARIABLE","$product",301],"[",["T_CONSTANT_ENCAPSED_STRING","'image'",301],"]",",",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","config",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","get",301],"(",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","config",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","get",301],"(",["T_CONSTANT_ENCAPSED_STRING","'config_theme'",301],")",["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'_image_cart_width'",301],")",",",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","config",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","get",301],"(",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","config",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","get",301],"(",["T_CONSTANT_ENCAPSED_STRING","'config_theme'",301],")",["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'_image_cart_height'",301],")",")",";",["T_WHITESPACE","\n\t\t\t",301],"}",["T_WHITESPACE"," ",302],["T_ELSE","else",302],["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n\t\t\t\t",302],["T_VARIABLE","$image",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","''",303],";",["T_WHITESPACE","\n\t\t\t",303],"}",["T_WHITESPACE","\n\n\t\t\t",304],["T_VARIABLE","$option_data",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_ARRAY","array",306],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",306],["T_FOREACH","foreach",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$product",308],"[",["T_CONSTANT_ENCAPSED_STRING","'option'",308],"]",["T_WHITESPACE"," ",308],["T_AS","as",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$option",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n\t\t\t\t",308],["T_IF","if",309],["T_WHITESPACE"," ",309],"(",["T_VARIABLE","$option",309],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",309],"]",["T_WHITESPACE"," ",309],["T_IS_NOT_EQUAL","!=",309],["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'file'",309],")",["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n\t\t\t\t\t",309],["T_VARIABLE","$value",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$option",310],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",310],"]",";",["T_WHITESPACE","\n\t\t\t\t",310],"}",["T_WHITESPACE"," ",311],["T_ELSE","else",311],["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n\t\t\t\t\t",311],["T_VARIABLE","$upload_info",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","model_tool_upload",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getUploadByCode",312],"(",["T_VARIABLE","$option",312],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",312],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",312],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$upload_info",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",314],["T_VARIABLE","$value",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_VARIABLE","$upload_info",315],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",315],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",315],"}",["T_WHITESPACE"," ",316],["T_ELSE","else",316],["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",316],["T_VARIABLE","$value",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","''",317],";",["T_WHITESPACE","\n\t\t\t\t\t",317],"}",["T_WHITESPACE","\n\t\t\t\t",318],"}",["T_WHITESPACE","\n\n\t\t\t\t",319],["T_VARIABLE","$option_data",321],"[","]",["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_ARRAY","array",321],"(",["T_WHITESPACE","\n\t\t\t\t\t",321],["T_CONSTANT_ENCAPSED_STRING","'name'",322],["T_WHITESPACE","  ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$option",322],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",322],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",322],["T_CONSTANT_ENCAPSED_STRING","'value'",323],["T_WHITESPACE"," ",323],["T_DOUBLE_ARROW","=>",323],["T_WHITESPACE"," ",323],"(",["T_STRING","utf8_strlen",323],"(",["T_VARIABLE","$value",323],")",["T_WHITESPACE"," ",323],">",["T_WHITESPACE"," ",323],["T_LNUMBER","20",323],["T_WHITESPACE"," ",323],"?",["T_WHITESPACE"," ",323],["T_STRING","utf8_substr",323],"(",["T_VARIABLE","$value",323],",",["T_WHITESPACE"," ",323],["T_LNUMBER","0",323],",",["T_WHITESPACE"," ",323],["T_LNUMBER","20",323],")",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'..'",323],["T_WHITESPACE"," ",323],":",["T_WHITESPACE"," ",323],["T_VARIABLE","$value",323],")",",",["T_WHITESPACE","\n\t\t\t\t\t",323],["T_CONSTANT_ENCAPSED_STRING","'type'",324],["T_WHITESPACE","  ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$option",324],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",324],"]",["T_WHITESPACE","\n\t\t\t\t",324],")",";",["T_WHITESPACE","\n\t\t\t",325],"}",["T_WHITESPACE","\n\n\t\t\t",326],["T_COMMENT","\/\/ Display prices\n",328],["T_WHITESPACE","\t\t\t",329],["T_IF","if",329],["T_WHITESPACE"," ",329],"(","(",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","config",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_price'",329],")",["T_WHITESPACE"," ",329],["T_BOOLEAN_AND","&&",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","customer",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","isLogged",329],"(",")",")",["T_WHITESPACE"," ",329],["T_BOOLEAN_OR","||",329],["T_WHITESPACE"," ",329],"!",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","config",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_price'",329],")",")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n\t\t\t\t",329],["T_VARIABLE","$price",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","currency",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","format",330],"(",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","tax",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","calculate",330],"(",["T_VARIABLE","$product",330],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",330],"]",",",["T_WHITESPACE"," ",330],["T_VARIABLE","$product",330],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",330],"]",",",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","config",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","get",330],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax'",330],")",")",",",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","session",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","data",330],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",330],"]",")",";",["T_WHITESPACE","\n\t\t\t",330],"}",["T_WHITESPACE"," ",331],["T_ELSE","else",331],["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n\t\t\t\t",331],["T_VARIABLE","$price",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","false",332],";",["T_WHITESPACE","\n\t\t\t",332],"}",["T_WHITESPACE","\n\n\t\t\t",333],["T_COMMENT","\/\/ Display prices\n",335],["T_WHITESPACE","\t\t\t",336],["T_IF","if",336],["T_WHITESPACE"," ",336],"(","(",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","config",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","get",336],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_price'",336],")",["T_WHITESPACE"," ",336],["T_BOOLEAN_AND","&&",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","customer",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","isLogged",336],"(",")",")",["T_WHITESPACE"," ",336],["T_BOOLEAN_OR","||",336],["T_WHITESPACE"," ",336],"!",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","config",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","get",336],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_price'",336],")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n\t\t\t\t",336],["T_VARIABLE","$total",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","currency",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","format",337],"(",["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","tax",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","calculate",337],"(",["T_VARIABLE","$product",337],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",337],"]",",",["T_WHITESPACE"," ",337],["T_VARIABLE","$product",337],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",337],"]",",",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","config",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","get",337],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax'",337],")",")",["T_WHITESPACE"," ",337],"*",["T_WHITESPACE"," ",337],["T_VARIABLE","$product",337],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",337],"]",",",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","session",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","data",337],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",337],"]",")",";",["T_WHITESPACE","\n\t\t\t",337],"}",["T_WHITESPACE"," ",338],["T_ELSE","else",338],["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n\t\t\t\t",338],["T_VARIABLE","$total",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","false",339],";",["T_WHITESPACE","\n\t\t\t",339],"}",["T_WHITESPACE","\n\n\t\t\t",340],["T_VARIABLE","$data",342],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",342],"]","[","]",["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_ARRAY","array",342],"(",["T_WHITESPACE","\n\t\t\t\t",342],["T_CONSTANT_ENCAPSED_STRING","'cart_id'",343],["T_WHITESPACE","   ",343],["T_DOUBLE_ARROW","=>",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$product",343],"[",["T_CONSTANT_ENCAPSED_STRING","'cart_id'",343],"]",",",["T_WHITESPACE","\n\t\t\t\t",343],["T_CONSTANT_ENCAPSED_STRING","'thumb'",344],["T_WHITESPACE","     ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$image",344],",",["T_WHITESPACE","\n\t\t\t\t",344],["T_CONSTANT_ENCAPSED_STRING","'name'",345],["T_WHITESPACE","      ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$product",345],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",345],"]",",",["T_WHITESPACE","\n\t\t\t\t",345],["T_CONSTANT_ENCAPSED_STRING","'model'",346],["T_WHITESPACE","     ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$product",346],"[",["T_CONSTANT_ENCAPSED_STRING","'model'",346],"]",",",["T_WHITESPACE","\n\t\t\t\t",346],["T_CONSTANT_ENCAPSED_STRING","'option'",347],["T_WHITESPACE","    ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$option_data",347],",",["T_WHITESPACE","\n\t\t\t\t",347],["T_CONSTANT_ENCAPSED_STRING","'recurring'",348],["T_WHITESPACE"," ",348],["T_DOUBLE_ARROW","=>",348],["T_WHITESPACE"," ",348],"(",["T_VARIABLE","$product",348],"[",["T_CONSTANT_ENCAPSED_STRING","'recurring'",348],"]",["T_WHITESPACE"," ",348],"?",["T_WHITESPACE"," ",348],["T_VARIABLE","$product",348],"[",["T_CONSTANT_ENCAPSED_STRING","'recurring'",348],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",348],"]",["T_WHITESPACE"," ",348],":",["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","''",348],")",",",["T_WHITESPACE","\n\t\t\t\t",348],["T_CONSTANT_ENCAPSED_STRING","'quantity'",349],["T_WHITESPACE","  ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$product",349],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",349],"]",",",["T_WHITESPACE","\n\t\t\t\t",349],["T_CONSTANT_ENCAPSED_STRING","'price'",350],["T_WHITESPACE","     ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$price",350],",",["T_WHITESPACE","\n\t\t\t\t",350],["T_CONSTANT_ENCAPSED_STRING","'total'",351],["T_WHITESPACE","     ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_VARIABLE","$total",351],",",["T_WHITESPACE","\n\t\t\t\t",351],["T_CONSTANT_ENCAPSED_STRING","'href'",352],["T_WHITESPACE","      ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","url",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","link",352],"(",["T_CONSTANT_ENCAPSED_STRING","'product\/product'",352],",",["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'product_id='",352],["T_WHITESPACE"," ",352],".",["T_WHITESPACE"," ",352],["T_VARIABLE","$product",352],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",352],"]",")",["T_WHITESPACE","\n\t\t\t",352],")",";",["T_WHITESPACE","\n\t\t",353],"}",["T_WHITESPACE","\n\n\t\t",354],["T_COMMENT","\/\/ Gift Voucher\n",356],["T_WHITESPACE","\t\t",357],["T_VARIABLE","$data",357],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",357],"]",["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_ARRAY","array",357],"(",")",";",["T_WHITESPACE","\n\n\t\t",357],["T_IF","if",359],["T_WHITESPACE"," ",359],"(","!",["T_EMPTY","empty",359],"(",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","session",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","data",359],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",359],"]",")",")",["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n\t\t\t",359],["T_FOREACH","foreach",360],["T_WHITESPACE"," ",360],"(",["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","session",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","data",360],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",360],"]",["T_WHITESPACE"," ",360],["T_AS","as",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$key",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$voucher",360],")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n\t\t\t\t",360],["T_VARIABLE","$data",361],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",361],"]","[","]",["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_ARRAY","array",361],"(",["T_WHITESPACE","\n\t\t\t\t\t",361],["T_CONSTANT_ENCAPSED_STRING","'key'",362],["T_WHITESPACE","         ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$key",362],",",["T_WHITESPACE","\n\t\t\t\t\t",362],["T_CONSTANT_ENCAPSED_STRING","'description'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$voucher",363],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",363],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",363],["T_CONSTANT_ENCAPSED_STRING","'amount'",364],["T_WHITESPACE","      ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","currency",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","format",364],"(",["T_VARIABLE","$voucher",364],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",364],"]",",",["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","session",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","data",364],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",364],"]",")",["T_WHITESPACE","\n\t\t\t\t",364],")",";",["T_WHITESPACE","\n\t\t\t",365],"}",["T_WHITESPACE","\n\t\t",366],"}",["T_WHITESPACE","\n\n\t\t",367],["T_VARIABLE","$totals",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_ARRAY","array",369],"(",")",";",["T_WHITESPACE","\n\t\t",369],["T_VARIABLE","$taxes",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","cart",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getTaxes",370],"(",")",";",["T_WHITESPACE","\n\t\t",370],["T_VARIABLE","$total",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_LNUMBER","0",371],";",["T_WHITESPACE","\n\n\t\t",371],["T_COMMENT","\/\/ Because __call can not keep var references so we put them into an array.\n",373],["T_WHITESPACE","\t\t",374],["T_VARIABLE","$total_data",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_ARRAY","array",374],"(",["T_WHITESPACE","\n\t\t\t",374],["T_CONSTANT_ENCAPSED_STRING","'totals'",375],["T_WHITESPACE"," ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],"&",["T_VARIABLE","$totals",375],",",["T_WHITESPACE","\n\t\t\t",375],["T_CONSTANT_ENCAPSED_STRING","'taxes'",376],["T_WHITESPACE","  ",376],["T_DOUBLE_ARROW","=>",376],["T_WHITESPACE"," ",376],"&",["T_VARIABLE","$taxes",376],",",["T_WHITESPACE","\n\t\t\t",376],["T_CONSTANT_ENCAPSED_STRING","'total'",377],["T_WHITESPACE","  ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],"&",["T_VARIABLE","$total",377],["T_WHITESPACE","\n\t\t",377],")",";",["T_WHITESPACE","\n\n\t\t",378],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","load",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","model",380],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/extension'",380],")",";",["T_WHITESPACE","\n\n\t\t",380],["T_VARIABLE","$sort_order",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_ARRAY","array",382],"(",")",";",["T_WHITESPACE","\n\n\t\t",382],["T_VARIABLE","$results",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","model_extension_extension",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","getExtensions",384],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",384],")",";",["T_WHITESPACE","\n\n\t\t",384],["T_FOREACH","foreach",386],["T_WHITESPACE"," ",386],"(",["T_VARIABLE","$results",386],["T_WHITESPACE"," ",386],["T_AS","as",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$key",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$value",386],")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n\t\t\t",386],["T_VARIABLE","$sort_order",387],"[",["T_VARIABLE","$key",387],"]",["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","config",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","get",387],"(",["T_VARIABLE","$value",387],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",387],"]",["T_WHITESPACE"," ",387],".",["T_WHITESPACE"," ",387],["T_CONSTANT_ENCAPSED_STRING","'_sort_order'",387],")",";",["T_WHITESPACE","\n\t\t",387],"}",["T_WHITESPACE","\n\n\t\t",388],["T_STRING","array_multisort",390],"(",["T_VARIABLE","$sort_order",390],",",["T_WHITESPACE"," ",390],["T_STRING","SORT_ASC",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$results",390],")",";",["T_WHITESPACE","\n\n\t\t",390],["T_FOREACH","foreach",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$results",392],["T_WHITESPACE"," ",392],["T_AS","as",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$result",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n\t\t\t",392],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","config",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","get",393],"(",["T_VARIABLE","$result",393],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",393],"]",["T_WHITESPACE"," ",393],".",["T_WHITESPACE"," ",393],["T_CONSTANT_ENCAPSED_STRING","'_status'",393],")",")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n\t\t\t\t",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","load",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","model",394],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/total\/'",394],["T_WHITESPACE"," ",394],".",["T_WHITESPACE"," ",394],["T_VARIABLE","$result",394],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",394],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",394],["T_COMMENT","\/\/ We have to put the totals in an array so that they pass by reference.\n",396],["T_WHITESPACE","\t\t\t\t",397],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],"{",["T_CONSTANT_ENCAPSED_STRING","'model_extension_total_'",397],["T_WHITESPACE"," ",397],".",["T_WHITESPACE"," ",397],["T_VARIABLE","$result",397],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",397],"]","}",["T_OBJECT_OPERATOR","->",397],["T_STRING","getTotal",397],"(",["T_VARIABLE","$total_data",397],")",";",["T_WHITESPACE","\n\t\t\t",397],"}",["T_WHITESPACE","\n\t\t",398],"}",["T_WHITESPACE","\n\n\t\t",399],["T_VARIABLE","$sort_order",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_ARRAY","array",401],"(",")",";",["T_WHITESPACE","\n\n\t\t",401],["T_FOREACH","foreach",403],["T_WHITESPACE"," ",403],"(",["T_VARIABLE","$totals",403],["T_WHITESPACE"," ",403],["T_AS","as",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$key",403],["T_WHITESPACE"," ",403],["T_DOUBLE_ARROW","=>",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$value",403],")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n\t\t\t",403],["T_VARIABLE","$sort_order",404],"[",["T_VARIABLE","$key",404],"]",["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_VARIABLE","$value",404],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",404],"]",";",["T_WHITESPACE","\n\t\t",404],"}",["T_WHITESPACE","\n\n\t\t",405],["T_STRING","array_multisort",407],"(",["T_VARIABLE","$sort_order",407],",",["T_WHITESPACE"," ",407],["T_STRING","SORT_ASC",407],",",["T_WHITESPACE"," ",407],["T_VARIABLE","$totals",407],")",";",["T_WHITESPACE","\n\n\t\t",407],["T_VARIABLE","$data",409],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",409],"]",["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_ARRAY","array",409],"(",")",";",["T_WHITESPACE","\n\n\t\t",409],["T_FOREACH","foreach",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$totals",411],["T_WHITESPACE"," ",411],["T_AS","as",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$total",411],")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n\t\t\t",411],["T_VARIABLE","$data",412],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",412],"]","[","]",["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_ARRAY","array",412],"(",["T_WHITESPACE","\n\t\t\t\t",412],["T_CONSTANT_ENCAPSED_STRING","'title'",413],["T_WHITESPACE"," ",413],["T_DOUBLE_ARROW","=>",413],["T_WHITESPACE"," ",413],["T_VARIABLE","$total",413],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",413],"]",",",["T_WHITESPACE","\n\t\t\t\t",413],["T_CONSTANT_ENCAPSED_STRING","'text'",414],["T_WHITESPACE","  ",414],["T_DOUBLE_ARROW","=>",414],["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","currency",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","format",414],"(",["T_VARIABLE","$total",414],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",414],"]",",",["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","session",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","data",414],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",414],"]",")",["T_WHITESPACE","\n\t\t\t",414],")",";",["T_WHITESPACE","\n\t\t",415],"}",["T_WHITESPACE","\n\n\t\t",416],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","response",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","setOutput",418],"(",["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","load",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","view",418],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout_sidebar'",418],",",["T_WHITESPACE"," ",418],["T_VARIABLE","$data",418],")",")",";",["T_WHITESPACE","\n\t",418],"}",["T_WHITESPACE","\n\n\t",419],["T_PUBLIC","public",421],["T_WHITESPACE"," ",421],["T_FUNCTION","function",421],["T_WHITESPACE"," ",421],["T_STRING","shippingAddress",421],"(",")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n\t\t",421],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","load",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","model",422],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",422],")",";",["T_WHITESPACE","\n\t\t",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","load",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","model",423],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/zone'",423],")",";",["T_WHITESPACE","\n\n\t\t",423],["T_IF","if",425],["T_WHITESPACE"," ",425],"(","!",["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","config",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","get",425],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",425],")",")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n\t\t\t",425],["T_RETURN","return",426],["T_WHITESPACE"," ",426],["T_STRING","false",426],";",["T_WHITESPACE","\n\t\t",426],"}",["T_WHITESPACE","\n\n\t\t",427],["T_VARIABLE","$json",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_ARRAY","array",429],"(",")",";",["T_WHITESPACE","\n\n\t\t",429],["T_UNSET","unset",431],"(",["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","session",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","data",431],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",431],"]",")",";",["T_WHITESPACE","\n\t\t",431],["T_UNSET","unset",432],"(",["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","session",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","data",432],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",432],"]",")",";",["T_WHITESPACE","\n\n\t\t",432],["T_IF","if",434],["T_WHITESPACE"," ",434],"(","(",["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","request",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","server",434],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",434],"]",["T_WHITESPACE"," ",434],["T_IS_EQUAL","==",434],["T_WHITESPACE"," ",434],["T_CONSTANT_ENCAPSED_STRING","'POST'",434],")",["T_WHITESPACE"," ",434],["T_BOOLEAN_AND","&&",434],["T_WHITESPACE"," ",434],["T_ISSET","isset",434],"(",["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","request",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","post",434],"[",["T_CONSTANT_ENCAPSED_STRING","'country'",434],"]",")",")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n\t\t\t",434],["T_VARIABLE","$country_info",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","model_extension_payment_klarna_checkout",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","getCountryByIsoCode3",435],"(",["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","request",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","post",435],"[",["T_CONSTANT_ENCAPSED_STRING","'country'",435],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",435],["T_IF","if",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$country_info",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n\t\t\t\t",437],["T_COMMENT","\/\/ Set default zone for shipping calculations. Get overwritten by correct data when order is confirmed\n",438],["T_WHITESPACE","\t\t\t\t",439],["T_VARIABLE","$zones",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","model_localisation_zone",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getZonesByCountryId",439],"(",["T_VARIABLE","$country_info",439],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",439],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",439],["T_VARIABLE","$zone",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_ARRAY","array",441],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",441],["T_IF","if",442],["T_WHITESPACE"," ",442],"(",["T_ISSET","isset",442],"(",["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","request",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","post",442],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",442],"]",")",["T_WHITESPACE"," ",442],["T_BOOLEAN_AND","&&",442],["T_WHITESPACE"," ",442],"!",["T_EMPTY","empty",442],"(",["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","request",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","post",442],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",442],"]",")",")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n\t\t\t\t\t",442],["T_VARIABLE","$zone",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","model_extension_payment_klarna_checkout",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","getZoneByCode",443],"(",["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","request",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","post",443],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",443],"]",",",["T_WHITESPACE"," ",443],["T_VARIABLE","$country_info",443],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",443],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",443],"}",["T_WHITESPACE","\n\n\t\t\t\t",444],["T_IF","if",446],["T_WHITESPACE"," ",446],"(",["T_VARIABLE","$zone",446],["T_WHITESPACE"," ",446],["T_BOOLEAN_OR","||",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$zones",446],")",["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n\t\t\t\t\t",446],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","session",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","data",447],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",447],"]",["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_ARRAY","array",447],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",447],["T_CONSTANT_ENCAPSED_STRING","'address_id'",448],["T_WHITESPACE","\t ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_STRING","null",448],",",["T_WHITESPACE","\n\t\t\t\t\t\t",448],["T_CONSTANT_ENCAPSED_STRING","'firstname'",449],["T_WHITESPACE","\t\t ",449],["T_DOUBLE_ARROW","=>",449],["T_WHITESPACE"," ",449],["T_STRING","utf8_substr",449],"(",["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","request",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","post",449],"[",["T_CONSTANT_ENCAPSED_STRING","'given_name'",449],"]",",",["T_WHITESPACE"," ",449],["T_LNUMBER","0",449],",",["T_WHITESPACE"," ",449],["T_LNUMBER","32",449],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",449],["T_CONSTANT_ENCAPSED_STRING","'lastname'",450],["T_WHITESPACE","\t\t ",450],["T_DOUBLE_ARROW","=>",450],["T_WHITESPACE"," ",450],["T_STRING","utf8_substr",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","request",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","post",450],"[",["T_CONSTANT_ENCAPSED_STRING","'family_name'",450],"]",",",["T_WHITESPACE"," ",450],["T_LNUMBER","0",450],",",["T_WHITESPACE"," ",450],["T_LNUMBER","32",450],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",450],["T_CONSTANT_ENCAPSED_STRING","'company'",451],["T_WHITESPACE","\t\t ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_STRING","null",451],",",["T_WHITESPACE","\n\t\t\t\t\t\t",451],["T_CONSTANT_ENCAPSED_STRING","'address_1'",452],["T_WHITESPACE","\t\t ",452],["T_DOUBLE_ARROW","=>",452],["T_WHITESPACE"," ",452],["T_STRING","utf8_substr",452],"(",["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","request",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","post",452],"[",["T_CONSTANT_ENCAPSED_STRING","'street_address'",452],"]",",",["T_WHITESPACE"," ",452],["T_LNUMBER","0",452],",",["T_WHITESPACE"," ",452],["T_LNUMBER","128",452],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",452],["T_CONSTANT_ENCAPSED_STRING","'address_2'",453],["T_WHITESPACE","\t\t ",453],["T_DOUBLE_ARROW","=>",453],["T_WHITESPACE"," ",453],["T_STRING","utf8_substr",453],"(",["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","request",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","post",453],"[",["T_CONSTANT_ENCAPSED_STRING","'street_address'",453],"]",",",["T_WHITESPACE"," ",453],["T_LNUMBER","129",453],",",["T_WHITESPACE"," ",453],["T_LNUMBER","256",453],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",453],["T_CONSTANT_ENCAPSED_STRING","'postcode'",454],["T_WHITESPACE","\t\t ",454],["T_DOUBLE_ARROW","=>",454],["T_WHITESPACE"," ",454],["T_STRING","utf8_substr",454],"(",["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","request",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","post",454],"[",["T_CONSTANT_ENCAPSED_STRING","'postal_code'",454],"]",",",["T_WHITESPACE"," ",454],["T_LNUMBER","0",454],",",["T_WHITESPACE"," ",454],["T_LNUMBER","10",454],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",454],["T_CONSTANT_ENCAPSED_STRING","'city'",455],["T_WHITESPACE","\t\t\t ",455],["T_DOUBLE_ARROW","=>",455],["T_WHITESPACE"," ",455],["T_STRING","utf8_substr",455],"(",["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","request",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","post",455],"[",["T_CONSTANT_ENCAPSED_STRING","'city'",455],"]",",",["T_WHITESPACE"," ",455],["T_LNUMBER","0",455],",",["T_WHITESPACE"," ",455],["T_LNUMBER","128",455],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",455],["T_CONSTANT_ENCAPSED_STRING","'zone_id'",456],["T_WHITESPACE","\t\t ",456],["T_DOUBLE_ARROW","=>",456],["T_WHITESPACE"," ",456],"(",["T_VARIABLE","$zone",456],["T_WHITESPACE"," ",456],"?",["T_WHITESPACE"," ",456],["T_VARIABLE","$zone",456],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",456],"]",["T_WHITESPACE"," ",456],":",["T_WHITESPACE"," ",456],["T_VARIABLE","$zones",456],"[",["T_LNUMBER","0",456],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",456],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",456],["T_CONSTANT_ENCAPSED_STRING","'zone'",457],["T_WHITESPACE","\t\t\t ",457],["T_DOUBLE_ARROW","=>",457],["T_WHITESPACE"," ",457],"(",["T_VARIABLE","$zone",457],["T_WHITESPACE"," ",457],"?",["T_WHITESPACE"," ",457],["T_VARIABLE","$zone",457],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",457],"]",["T_WHITESPACE"," ",457],":",["T_WHITESPACE"," ",457],["T_VARIABLE","$zones",457],"[",["T_LNUMBER","0",457],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",457],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",457],["T_CONSTANT_ENCAPSED_STRING","'zone_code'",458],["T_WHITESPACE","\t\t ",458],["T_DOUBLE_ARROW","=>",458],["T_WHITESPACE"," ",458],"(",["T_VARIABLE","$zone",458],["T_WHITESPACE"," ",458],"?",["T_WHITESPACE"," ",458],["T_VARIABLE","$zone",458],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",458],"]",["T_WHITESPACE"," ",458],":",["T_WHITESPACE"," ",458],["T_VARIABLE","$zones",458],"[",["T_LNUMBER","0",458],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",458],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",458],["T_CONSTANT_ENCAPSED_STRING","'country_id'",459],["T_WHITESPACE","\t ",459],["T_DOUBLE_ARROW","=>",459],["T_WHITESPACE"," ",459],["T_VARIABLE","$country_info",459],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",459],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",459],["T_CONSTANT_ENCAPSED_STRING","'country'",460],["T_WHITESPACE","\t\t ",460],["T_DOUBLE_ARROW","=>",460],["T_WHITESPACE"," ",460],["T_VARIABLE","$country_info",460],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",460],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",460],["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",461],["T_WHITESPACE","\t ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$country_info",461],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",461],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",461],["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",462],["T_WHITESPACE","\t ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$country_info",462],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",462],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",462],["T_CONSTANT_ENCAPSED_STRING","'address_format'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$country_info",463],"[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",463],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",463],["T_CONSTANT_ENCAPSED_STRING","'custom_field'",464],["T_WHITESPACE","\t ",464],["T_DOUBLE_ARROW","=>",464],["T_WHITESPACE"," ",464],["T_ARRAY","array",464],"(",")",",",["T_WHITESPACE","\n\t\t\t\t\t",464],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",465],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","tax",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","unsetRates",467],"(",")",";",["T_WHITESPACE","\n\t\t\t\t\t",467],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","tax",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","setShippingAddress",468],"(",["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","session",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","data",468],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",468],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",468],"]",",",["T_WHITESPACE"," ",468],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","session",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","data",468],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",468],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",468],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",468],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","tax",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","setStoreAddress",469],"(",["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","config",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","get",469],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",469],")",",",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","config",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","get",469],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",469],")",")",";",["T_WHITESPACE","\n\t\t\t\t",469],"}",["T_WHITESPACE","\n\t\t\t",470],"}",["T_WHITESPACE"," ",471],["T_ELSE","else",471],["T_WHITESPACE"," ",471],"{",["T_WHITESPACE","\n\t\t\t\t",471],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","model_extension_payment_klarna_checkout",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","log",472],"(",["T_CONSTANT_ENCAPSED_STRING","'Couldnt find country: '",472],["T_WHITESPACE"," ",472],".",["T_WHITESPACE"," ",472],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","request",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","post",472],"[",["T_CONSTANT_ENCAPSED_STRING","'country'",472],"]",")",";",["T_WHITESPACE","\n\t\t\t",472],"}",["T_WHITESPACE","\n\t\t",473],"}",["T_WHITESPACE","\n\n\t\t",474],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","response",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","addHeader",476],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",476],")",";",["T_WHITESPACE","\n\t\t",476],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","response",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","setOutput",477],"(",["T_STRING","json_encode",477],"(",["T_VARIABLE","$json",477],")",")",";",["T_WHITESPACE","\n\t",477],"}",["T_WHITESPACE","\n\n\t",478],["T_PUBLIC","public",480],["T_WHITESPACE"," ",480],["T_FUNCTION","function",480],["T_WHITESPACE"," ",480],["T_STRING","cartTotal",480],"(",")",["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n\t\t",480],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","load",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","language",481],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",481],")",";",["T_WHITESPACE","\n\n\t\t",481],["T_IF","if",483],["T_WHITESPACE"," ",483],"(","!",["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","config",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","get",483],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",483],")",")",["T_WHITESPACE"," ",483],"{",["T_WHITESPACE","\n\t\t\t",483],["T_RETURN","return",484],["T_WHITESPACE"," ",484],["T_STRING","false",484],";",["T_WHITESPACE","\n\t\t",484],"}",["T_WHITESPACE","\n\n\t\t",485],["T_COMMENT","\/\/ Totals\n",487],["T_WHITESPACE","\t\t",488],["T_VARIABLE","$this",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","load",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","model",488],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/extension'",488],")",";",["T_WHITESPACE","\n\n\t\t",488],["T_VARIABLE","$totals",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_ARRAY","array",490],"(",")",";",["T_WHITESPACE","\n\t\t",490],["T_VARIABLE","$taxes",491],["T_WHITESPACE"," ",491],"=",["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","cart",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","getTaxes",491],"(",")",";",["T_WHITESPACE","\n\t\t",491],["T_VARIABLE","$total",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_LNUMBER","0",492],";",["T_WHITESPACE","\n\n\t\t",492],["T_COMMENT","\/\/ Because __call can not keep var references so we put them into an array.\n",494],["T_WHITESPACE","\t\t",495],["T_VARIABLE","$total_data",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_ARRAY","array",495],"(",["T_WHITESPACE","\n\t\t\t",495],["T_CONSTANT_ENCAPSED_STRING","'totals'",496],["T_WHITESPACE"," ",496],["T_DOUBLE_ARROW","=>",496],["T_WHITESPACE"," ",496],"&",["T_VARIABLE","$totals",496],",",["T_WHITESPACE","\n\t\t\t",496],["T_CONSTANT_ENCAPSED_STRING","'taxes'",497],["T_WHITESPACE","  ",497],["T_DOUBLE_ARROW","=>",497],["T_WHITESPACE"," ",497],"&",["T_VARIABLE","$taxes",497],",",["T_WHITESPACE","\n\t\t\t",497],["T_CONSTANT_ENCAPSED_STRING","'total'",498],["T_WHITESPACE","  ",498],["T_DOUBLE_ARROW","=>",498],["T_WHITESPACE"," ",498],"&",["T_VARIABLE","$total",498],["T_WHITESPACE","\n\t\t",498],")",";",["T_WHITESPACE","\n\n\t\t",499],["T_COMMENT","\/\/ Display prices\n",501],["T_WHITESPACE","\t\t",502],["T_IF","if",502],["T_WHITESPACE"," ",502],"(","(",["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","config",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","get",502],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_price'",502],")",["T_WHITESPACE"," ",502],["T_BOOLEAN_AND","&&",502],["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","customer",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","isLogged",502],"(",")",")",["T_WHITESPACE"," ",502],["T_BOOLEAN_OR","||",502],["T_WHITESPACE"," ",502],"!",["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","config",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","get",502],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_price'",502],")",")",["T_WHITESPACE"," ",502],"{",["T_WHITESPACE","\n\t\t\t",502],["T_VARIABLE","$sort_order",503],["T_WHITESPACE"," ",503],"=",["T_WHITESPACE"," ",503],["T_ARRAY","array",503],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",503],["T_VARIABLE","$results",505],["T_WHITESPACE"," ",505],"=",["T_WHITESPACE"," ",505],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","model_extension_extension",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","getExtensions",505],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",505],")",";",["T_WHITESPACE","\n\n\t\t\t",505],["T_FOREACH","foreach",507],["T_WHITESPACE"," ",507],"(",["T_VARIABLE","$results",507],["T_WHITESPACE"," ",507],["T_AS","as",507],["T_WHITESPACE"," ",507],["T_VARIABLE","$key",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_VARIABLE","$value",507],")",["T_WHITESPACE"," ",507],"{",["T_WHITESPACE","\n\t\t\t\t",507],["T_VARIABLE","$sort_order",508],"[",["T_VARIABLE","$key",508],"]",["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","config",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","get",508],"(",["T_VARIABLE","$value",508],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",508],"]",["T_WHITESPACE"," ",508],".",["T_WHITESPACE"," ",508],["T_CONSTANT_ENCAPSED_STRING","'_sort_order'",508],")",";",["T_WHITESPACE","\n\t\t\t",508],"}",["T_WHITESPACE","\n\n\t\t\t",509],["T_STRING","array_multisort",511],"(",["T_VARIABLE","$sort_order",511],",",["T_WHITESPACE"," ",511],["T_STRING","SORT_ASC",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$results",511],")",";",["T_WHITESPACE","\n\n\t\t\t",511],["T_FOREACH","foreach",513],["T_WHITESPACE"," ",513],"(",["T_VARIABLE","$results",513],["T_WHITESPACE"," ",513],["T_AS","as",513],["T_WHITESPACE"," ",513],["T_VARIABLE","$result",513],")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n\t\t\t\t",513],["T_IF","if",514],["T_WHITESPACE"," ",514],"(",["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","config",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","get",514],"(",["T_VARIABLE","$result",514],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",514],"]",["T_WHITESPACE"," ",514],".",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","'_status'",514],")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n\t\t\t\t\t",514],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","load",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","model",515],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/total\/'",515],["T_WHITESPACE"," ",515],".",["T_WHITESPACE"," ",515],["T_VARIABLE","$result",515],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",515],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",515],["T_COMMENT","\/\/ We have to put the totals in an array so that they pass by reference.\n",517],["T_WHITESPACE","\t\t\t\t\t",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],"{",["T_CONSTANT_ENCAPSED_STRING","'model_extension_total_'",518],["T_WHITESPACE"," ",518],".",["T_WHITESPACE"," ",518],["T_VARIABLE","$result",518],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",518],"]","}",["T_OBJECT_OPERATOR","->",518],["T_STRING","getTotal",518],"(",["T_VARIABLE","$total_data",518],")",";",["T_WHITESPACE","\n\t\t\t\t",518],"}",["T_WHITESPACE","\n\t\t\t",519],"}",["T_WHITESPACE","\n\n\t\t\t",520],["T_VARIABLE","$sort_order",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_ARRAY","array",522],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",522],["T_FOREACH","foreach",524],["T_WHITESPACE"," ",524],"(",["T_VARIABLE","$totals",524],["T_WHITESPACE"," ",524],["T_AS","as",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$key",524],["T_WHITESPACE"," ",524],["T_DOUBLE_ARROW","=>",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$value",524],")",["T_WHITESPACE"," ",524],"{",["T_WHITESPACE","\n\t\t\t\t",524],["T_VARIABLE","$sort_order",525],"[",["T_VARIABLE","$key",525],"]",["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_VARIABLE","$value",525],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",525],"]",";",["T_WHITESPACE","\n\t\t\t",525],"}",["T_WHITESPACE","\n\n\t\t\t",526],["T_STRING","array_multisort",528],"(",["T_VARIABLE","$sort_order",528],",",["T_WHITESPACE"," ",528],["T_STRING","SORT_ASC",528],",",["T_WHITESPACE"," ",528],["T_VARIABLE","$totals",528],")",";",["T_WHITESPACE","\n\n\t\t\t",528],["T_VARIABLE","$total",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_STRING","sprintf",530],"(",["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","language",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","get",530],"(",["T_CONSTANT_ENCAPSED_STRING","'text_items'",530],")",",",["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","cart",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","countProducts",530],"(",")",["T_WHITESPACE"," ",530],"+",["T_WHITESPACE"," ",530],"(",["T_ISSET","isset",530],"(",["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","session",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","data",530],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",530],"]",")",["T_WHITESPACE"," ",530],"?",["T_WHITESPACE"," ",530],["T_STRING","count",530],"(",["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","session",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","data",530],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",530],"]",")",["T_WHITESPACE"," ",530],":",["T_WHITESPACE"," ",530],["T_LNUMBER","0",530],")",",",["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","currency",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","format",530],"(",["T_VARIABLE","$total",530],",",["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","session",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","data",530],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",530],"]",")",")",";",["T_WHITESPACE","\n\t\t",530],"}",["T_WHITESPACE","\n\n\t\t",531],["T_VARIABLE","$this",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","response",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","addHeader",533],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",533],")",";",["T_WHITESPACE","\n\t\t",533],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","response",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","setOutput",534],"(",["T_STRING","json_encode",534],"(",["T_VARIABLE","$total",534],")",")",";",["T_WHITESPACE","\n\t",534],"}",["T_WHITESPACE","\n\n\t",535],["T_PUBLIC","public",537],["T_WHITESPACE"," ",537],["T_FUNCTION","function",537],["T_WHITESPACE"," ",537],["T_STRING","addressUpdate",537],"(",")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n\t\t",537],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","load",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","language",538],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",538],")",";",["T_WHITESPACE","\n\n\t\t",538],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","load",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","model",540],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/customer'",540],")",";",["T_WHITESPACE","\n\t\t",540],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","load",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","model",541],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",541],")",";",["T_WHITESPACE","\n\t\t",541],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","load",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","model",542],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",542],")",";",["T_WHITESPACE","\n\t\t",542],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","load",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","model",543],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/zone'",543],")",";",["T_WHITESPACE","\n\n\t\t",543],["T_IF","if",545],["T_WHITESPACE"," ",545],"(","!",["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","config",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","get",545],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",545],")",")",["T_WHITESPACE"," ",545],"{",["T_WHITESPACE","\n\t\t\t",545],["T_RETURN","return",546],["T_WHITESPACE"," ",546],["T_STRING","false",546],";",["T_WHITESPACE","\n\t\t",546],"}",["T_WHITESPACE","\n\n\t\t",547],["T_VARIABLE","$process",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_STRING","true",549],";",["T_WHITESPACE","\n\n\t\t",549],["T_VARIABLE","$request",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_STRING","json_decode",551],"(",["T_STRING","file_get_contents",551],"(",["T_CONSTANT_ENCAPSED_STRING","'php:\/\/input'",551],")",")",";",["T_WHITESPACE","\n\n\t\t",551],["T_VARIABLE","$json",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_ARRAY","array",553],"(",")",";",["T_WHITESPACE","\n\n\t\t",553],["T_VARIABLE","$http_response_code",555],["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_LNUMBER","400",555],";",["T_WHITESPACE","\n\n\t\t",555],["T_COMMENT","\/\/ Check to see if request data is complete\n",557],["T_WHITESPACE","\t\t",558],["T_IF","if",558],["T_WHITESPACE"," ",558],"(","!",["T_VARIABLE","$request",558],["T_WHITESPACE"," ",558],["T_BOOLEAN_OR","||",558],["T_WHITESPACE"," ",558],"!",["T_ISSET","isset",558],"(",["T_VARIABLE","$request",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","order_lines",558],")",["T_WHITESPACE"," ",558],["T_BOOLEAN_OR","||",558],["T_WHITESPACE"," ",558],["T_EMPTY","empty",558],"(",["T_VARIABLE","$request",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","order_lines",558],")",["T_WHITESPACE"," ",558],["T_BOOLEAN_OR","||",558],["T_WHITESPACE"," ",558],"!",["T_ISSET","isset",558],"(",["T_VARIABLE","$request",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","shipping_address",558],")",["T_WHITESPACE"," ",558],["T_BOOLEAN_OR","||",558],["T_WHITESPACE"," ",558],["T_EMPTY","empty",558],"(",["T_VARIABLE","$request",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","shipping_address",558],")",")",["T_WHITESPACE"," ",558],"{",["T_WHITESPACE","\n\t\t\t",558],["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","model_extension_payment_klarna_checkout",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","log",559],"(",["T_CONSTANT_ENCAPSED_STRING","'Request data incomplete. Full request below:'",559],")",";",["T_WHITESPACE","\n\t\t\t",559],["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","model_extension_payment_klarna_checkout",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","log",560],"(",["T_VARIABLE","$request",560],")",";",["T_WHITESPACE","\n\t\t\t",560],["T_VARIABLE","$process",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_STRING","false",561],";",["T_WHITESPACE","\n\t\t",561],"}",["T_WHITESPACE","\n\n\t\t",562],["T_COMMENT","\/\/ Get Klarna order info from db\n",564],["T_WHITESPACE","\t\t",565],["T_IF","if",565],["T_WHITESPACE"," ",565],"(",["T_VARIABLE","$process",565],")",["T_WHITESPACE"," ",565],"{",["T_WHITESPACE","\n\t\t\t",565],["T_VARIABLE","$order_id",566],["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_STRING","null",566],";",["T_WHITESPACE","\n\n\t\t\t",566],["T_FOREACH","foreach",568],["T_WHITESPACE"," ",568],"(",["T_VARIABLE","$request",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","order_lines",568],["T_WHITESPACE"," ",568],["T_AS","as",568],["T_WHITESPACE"," ",568],["T_VARIABLE","$order_line",568],")",["T_WHITESPACE"," ",568],"{",["T_WHITESPACE","\n\t\t\t\t",568],["T_IF","if",569],["T_WHITESPACE"," ",569],"(",["T_VARIABLE","$order_line",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","type",569],["T_WHITESPACE"," ",569],["T_IS_EQUAL","==",569],["T_WHITESPACE"," ",569],["T_CONSTANT_ENCAPSED_STRING","'physical'",569],["T_WHITESPACE"," ",569],["T_BOOLEAN_OR","||",569],["T_WHITESPACE"," ",569],["T_VARIABLE","$order_line",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","type",569],["T_WHITESPACE"," ",569],["T_IS_EQUAL","==",569],["T_WHITESPACE"," ",569],["T_CONSTANT_ENCAPSED_STRING","'digital'",569],["T_WHITESPACE"," ",569],["T_BOOLEAN_OR","||",569],["T_WHITESPACE"," ",569],["T_VARIABLE","$order_line",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","type",569],["T_WHITESPACE"," ",569],["T_IS_EQUAL","==",569],["T_WHITESPACE"," ",569],["T_CONSTANT_ENCAPSED_STRING","'gift_card'",569],")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n\t\t\t\t\t",569],["T_VARIABLE","$order_id",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","encryption",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","decrypt",570],"(",["T_VARIABLE","$order_line",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","merchant_data",570],")",";",["T_WHITESPACE","\n\t\t\t\t\t",570],["T_BREAK","break",571],";",["T_WHITESPACE","\n\t\t\t\t",571],"}",["T_WHITESPACE","\n\t\t\t",572],"}",["T_WHITESPACE","\n\n\t\t\t",573],["T_IF","if",575],["T_WHITESPACE"," ",575],"(",["T_VARIABLE","$order_id",575],")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n\t\t\t\t",575],["T_COMMENT","\/\/ Get klarna order data from db\n",576],["T_WHITESPACE","\t\t\t\t",577],["T_VARIABLE","$klarna_checkout_order",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","model_extension_payment_klarna_checkout",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","getOrderByOrderId",577],"(",["T_VARIABLE","$order_id",577],")",";",["T_WHITESPACE","\n\n\t\t\t\t",577],["T_IF","if",579],["T_WHITESPACE"," ",579],"(","!",["T_VARIABLE","$klarna_checkout_order",579],["T_WHITESPACE"," ",579],["T_BOOLEAN_OR","||",579],["T_WHITESPACE"," ",579],"!",["T_VARIABLE","$klarna_checkout_order",579],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",579],"]",")",["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n\t\t\t\t\t",579],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","model_extension_payment_klarna_checkout",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","log",580],"(",["T_CONSTANT_ENCAPSED_STRING","'No klarna order found using order_id: '",580],["T_WHITESPACE"," ",580],".",["T_WHITESPACE"," ",580],["T_VARIABLE","$order_id",580],")",";",["T_WHITESPACE","\n\t\t\t\t\t",580],["T_VARIABLE","$process",581],["T_WHITESPACE"," ",581],"=",["T_WHITESPACE"," ",581],["T_STRING","false",581],";",["T_WHITESPACE","\n\t\t\t\t",581],"}",["T_WHITESPACE","\n\t\t\t",582],"}",["T_WHITESPACE"," ",583],["T_ELSE","else",583],["T_WHITESPACE"," ",583],"{",["T_WHITESPACE","\n\t\t\t\t",583],["T_VARIABLE","$process",584],["T_WHITESPACE"," ",584],"=",["T_WHITESPACE"," ",584],["T_STRING","false",584],";",["T_WHITESPACE","\n\t\t\t",584],"}",["T_WHITESPACE","\n\t\t",585],"}",["T_WHITESPACE","\n\n\t\t",586],["T_IF","if",588],["T_WHITESPACE"," ",588],"(",["T_VARIABLE","$process",588],")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n\t\t\t",588],["T_VARIABLE","$klarna_checkout_order_data",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_STRING","json_decode",589],"(",["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","encryption",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","decrypt",589],"(",["T_VARIABLE","$klarna_checkout_order",589],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",589],"]",")",",",["T_WHITESPACE"," ",589],["T_STRING","true",589],")",";",["T_WHITESPACE","\n\n\t\t\t",589],["T_COMMENT","\/\/ Check credentials in request with ones stored in db\n",591],["T_WHITESPACE","\t\t\t",592],["T_VARIABLE","$valid_request",592],["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_STRING","false",592],";",["T_WHITESPACE","\n\t\t\t",592],["T_FOREACH","foreach",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$this",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","config",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","get",593],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",593],")",["T_WHITESPACE"," ",593],["T_AS","as",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$account",593],")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n\t\t\t\t",593],["T_IF","if",594],["T_WHITESPACE"," ",594],"(","(",["T_VARIABLE","$account",594],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",594],"]",["T_WHITESPACE"," ",594],["T_IS_EQUAL","==",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$klarna_checkout_order_data",594],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",594],"]",")",["T_WHITESPACE"," ",594],["T_BOOLEAN_AND","&&",594],["T_WHITESPACE"," ",594],"(",["T_VARIABLE","$account",594],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",594],"]",["T_WHITESPACE"," ",594],["T_IS_EQUAL","==",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$klarna_checkout_order_data",594],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",594],"]",")",")",["T_WHITESPACE"," ",594],"{",["T_WHITESPACE","\n\t\t\t\t\t",594],["T_VARIABLE","$valid_request",595],["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_STRING","true",595],";",["T_WHITESPACE","\n\t\t\t\t\t",595],["T_BREAK","break",596],";",["T_WHITESPACE","\n\t\t\t\t",596],"}",["T_WHITESPACE","\n\t\t\t",597],"}",["T_WHITESPACE","\n\n\t\t\t",598],["T_IF","if",600],["T_WHITESPACE"," ",600],"(","!",["T_VARIABLE","$valid_request",600],")",["T_WHITESPACE"," ",600],"{",["T_WHITESPACE","\n\t\t\t\t",600],["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","model_extension_payment_klarna_checkout",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","log",601],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot validate request. Terminating.'",601],")",";",["T_WHITESPACE","\n\t\t\t\t",601],["T_VARIABLE","$process",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_STRING","false",602],";",["T_WHITESPACE","\n\t\t\t",602],"}",["T_WHITESPACE","\n\t\t",603],"}",["T_WHITESPACE","\n\n\t\t",604],["T_COMMENT","\/\/ Request is valid, we can spoof\/simulate the customer to calculate shipping\n",606],["T_WHITESPACE","\t\t",607],["T_IF","if",607],["T_WHITESPACE"," ",607],"(",["T_VARIABLE","$process",607],")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n\t\t\t",607],["T_STRING","session_destroy",608],"(",")",";",["T_WHITESPACE","\n\t\t\t",608],["T_STRING","session_id",609],"(",["T_VARIABLE","$klarna_checkout_order_data",609],"[",["T_CONSTANT_ENCAPSED_STRING","'session_id'",609],"]",")",";",["T_WHITESPACE","\n\t\t\t",609],["T_STRING","session_start",610],"(",")",";",["T_WHITESPACE","\n\t\t\t",610],["T_VARIABLE","$this",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","session",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","start",611],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",611],",",["T_WHITESPACE"," ",611],["T_VARIABLE","$klarna_checkout_order_data",611],"[",["T_CONSTANT_ENCAPSED_STRING","'session_key'",611],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",611],["T_IF","if",613],["T_WHITESPACE"," ",613],"(",["T_VARIABLE","$klarna_checkout_order_data",613],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",613],"]",")",["T_WHITESPACE"," ",613],"{",["T_WHITESPACE","\n\t\t\t\t",613],["T_VARIABLE","$customer_info",614],["T_WHITESPACE"," ",614],"=",["T_WHITESPACE"," ",614],["T_VARIABLE","$this",614],["T_OBJECT_OPERATOR","->",614],["T_STRING","model_account_customer",614],["T_OBJECT_OPERATOR","->",614],["T_STRING","getCustomer",614],"(",["T_VARIABLE","$klarna_checkout_order_data",614],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",614],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",614],["T_IF","if",616],["T_WHITESPACE"," ",616],"(",["T_VARIABLE","$customer_info",616],")",["T_WHITESPACE"," ",616],"{",["T_WHITESPACE","\n\t\t\t\t\t",616],["T_VARIABLE","$this",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","customer",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","login",617],"(",["T_VARIABLE","$customer_info",617],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",617],"]",",",["T_WHITESPACE"," ",617],["T_CONSTANT_ENCAPSED_STRING","''",617],",",["T_WHITESPACE"," ",617],["T_STRING","true",617],")",";",["T_WHITESPACE","\n\t\t\t\t",617],"}",["T_WHITESPACE","\n\t\t\t",618],"}",["T_WHITESPACE","\n\n\t\t\t",619],["T_VARIABLE","$order_info",621],["T_WHITESPACE"," ",621],"=",["T_WHITESPACE"," ",621],["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","model_checkout_order",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getOrder",621],"(",["T_VARIABLE","$order_id",621],")",";",["T_WHITESPACE","\n\n\t\t\t",621],["T_IF","if",623],["T_WHITESPACE"," ",623],"(","!",["T_VARIABLE","$order_info",623],")",["T_WHITESPACE"," ",623],"{",["T_WHITESPACE","\n\t\t\t\t",623],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","model_extension_payment_klarna_checkout",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","log",624],"(",["T_CONSTANT_ENCAPSED_STRING","'No order found using order_id: '",624],["T_WHITESPACE"," ",624],".",["T_WHITESPACE"," ",624],["T_VARIABLE","$order_id",624],["T_WHITESPACE"," ",624],".",["T_WHITESPACE"," ",624],["T_CONSTANT_ENCAPSED_STRING","'. Full request below:'",624],")",";",["T_WHITESPACE","\n\t\t\t\t",624],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","model_extension_payment_klarna_checkout",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","log",625],"(",["T_VARIABLE","$request",625],")",";",["T_WHITESPACE","\n\t\t\t\t",625],["T_VARIABLE","$process",626],["T_WHITESPACE"," ",626],"=",["T_WHITESPACE"," ",626],["T_STRING","false",626],";",["T_WHITESPACE","\n\t\t\t",626],"}",["T_WHITESPACE","\n\n\t\t\t",627],["T_COMMENT","\/\/ Set more session data from the order\n",629],["T_WHITESPACE","\t\t\t",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","session",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","data",630],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",630],"]",["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_VARIABLE","$order_info",630],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",630],"]",";",["T_WHITESPACE","\n\t\t\t",630],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","session",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","data",631],"[",["T_CONSTANT_ENCAPSED_STRING","'language'",631],"]",["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_VARIABLE","$order_info",631],"[",["T_CONSTANT_ENCAPSED_STRING","'language_code'",631],"]",";",["T_WHITESPACE","\n\n\t\t\t",631],["T_VARIABLE","$country_info",633],["T_WHITESPACE"," ",633],"=",["T_WHITESPACE"," ",633],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","model_extension_payment_klarna_checkout",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","getCountryByIsoCode2",633],"(",["T_VARIABLE","$request",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","shipping_address",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","country",633],")",";",["T_WHITESPACE","\n\n\t\t\t",633],["T_IF","if",635],["T_WHITESPACE"," ",635],"(","!",["T_VARIABLE","$country_info",635],")",["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n\t\t\t\t",635],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","model_extension_payment_klarna_checkout",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","log",636],"(",["T_CONSTANT_ENCAPSED_STRING","'No country found using: '",636],["T_WHITESPACE"," ",636],".",["T_WHITESPACE"," ",636],["T_VARIABLE","$request",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","shipping_address",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","country",636],["T_WHITESPACE"," ",636],".",["T_WHITESPACE"," ",636],["T_CONSTANT_ENCAPSED_STRING","'. Full request below:'",636],")",";",["T_WHITESPACE","\n\t\t\t\t",636],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","model_extension_payment_klarna_checkout",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","log",637],"(",["T_VARIABLE","$request",637],")",";",["T_WHITESPACE","\n\t\t\t",637],"}",["T_WHITESPACE","\n\n\t\t\t",638],["T_IF","if",640],["T_WHITESPACE"," ",640],"(",["T_VARIABLE","$order_info",640],["T_WHITESPACE"," ",640],["T_BOOLEAN_AND","&&",640],["T_WHITESPACE"," ",640],["T_VARIABLE","$country_info",640],")",["T_WHITESPACE"," ",640],"{",["T_WHITESPACE","\n\t\t\t\t",640],["T_VARIABLE","$zones",641],["T_WHITESPACE"," ",641],"=",["T_WHITESPACE"," ",641],["T_VARIABLE","$this",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","model_localisation_zone",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","getZonesByCountryId",641],"(",["T_VARIABLE","$country_info",641],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",641],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",641],["T_VARIABLE","$zone",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_ARRAY","array",643],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",643],["T_IF","if",644],["T_WHITESPACE"," ",644],"(",["T_ISSET","isset",644],"(",["T_VARIABLE","$request",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","shipping_address",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","region",644],")",["T_WHITESPACE"," ",644],["T_BOOLEAN_AND","&&",644],["T_WHITESPACE"," ",644],"!",["T_EMPTY","empty",644],"(",["T_VARIABLE","$request",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","shipping_address",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","region",644],")",")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n\t\t\t\t\t",644],["T_VARIABLE","$zone",645],["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","model_extension_payment_klarna_checkout",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","getZoneByCode",645],"(",["T_VARIABLE","$request",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","shipping_address",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","region",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$country_info",645],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",645],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",645],"}",["T_WHITESPACE","\n\n\t\t\t\t",646],["T_IF","if",648],["T_WHITESPACE"," ",648],"(",["T_VARIABLE","$zone",648],["T_WHITESPACE"," ",648],["T_BOOLEAN_OR","||",648],["T_WHITESPACE"," ",648],["T_VARIABLE","$zones",648],")",["T_WHITESPACE"," ",648],"{",["T_WHITESPACE","\n\t\t\t\t\t",648],["T_VARIABLE","$this",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","session",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","data",649],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",649],"]",["T_WHITESPACE"," ",649],"=",["T_WHITESPACE"," ",649],["T_ARRAY","array",649],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",649],["T_CONSTANT_ENCAPSED_STRING","'address_id'",650],["T_WHITESPACE","\t ",650],["T_DOUBLE_ARROW","=>",650],["T_WHITESPACE"," ",650],["T_STRING","null",650],",",["T_WHITESPACE","\n\t\t\t\t\t\t",650],["T_CONSTANT_ENCAPSED_STRING","'firstname'",651],["T_WHITESPACE","\t\t ",651],["T_DOUBLE_ARROW","=>",651],["T_WHITESPACE"," ",651],["T_STRING","null",651],",",["T_WHITESPACE","\n\t\t\t\t\t\t",651],["T_CONSTANT_ENCAPSED_STRING","'lastname'",652],["T_WHITESPACE","\t\t ",652],["T_DOUBLE_ARROW","=>",652],["T_WHITESPACE"," ",652],["T_STRING","null",652],",",["T_WHITESPACE","\n\t\t\t\t\t\t",652],["T_CONSTANT_ENCAPSED_STRING","'company'",653],["T_WHITESPACE","\t\t ",653],["T_DOUBLE_ARROW","=>",653],["T_WHITESPACE"," ",653],["T_STRING","null",653],",",["T_WHITESPACE","\n\t\t\t\t\t\t",653],["T_CONSTANT_ENCAPSED_STRING","'address_1'",654],["T_WHITESPACE","\t\t ",654],["T_DOUBLE_ARROW","=>",654],["T_WHITESPACE"," ",654],["T_STRING","null",654],",",["T_WHITESPACE","\n\t\t\t\t\t\t",654],["T_CONSTANT_ENCAPSED_STRING","'address_2'",655],["T_WHITESPACE","\t\t ",655],["T_DOUBLE_ARROW","=>",655],["T_WHITESPACE"," ",655],["T_STRING","null",655],",",["T_WHITESPACE","\n\t\t\t\t\t\t",655],["T_CONSTANT_ENCAPSED_STRING","'postcode'",656],["T_WHITESPACE","\t\t ",656],["T_DOUBLE_ARROW","=>",656],["T_WHITESPACE"," ",656],["T_STRING","null",656],",",["T_WHITESPACE","\n\t\t\t\t\t\t",656],["T_CONSTANT_ENCAPSED_STRING","'city'",657],["T_WHITESPACE","\t\t\t ",657],["T_DOUBLE_ARROW","=>",657],["T_WHITESPACE"," ",657],["T_STRING","null",657],",",["T_WHITESPACE","\n\t\t\t\t\t\t",657],["T_CONSTANT_ENCAPSED_STRING","'zone_id'",658],["T_WHITESPACE","\t\t ",658],["T_DOUBLE_ARROW","=>",658],["T_WHITESPACE"," ",658],"(",["T_VARIABLE","$zone",658],["T_WHITESPACE"," ",658],"?",["T_WHITESPACE"," ",658],["T_VARIABLE","$zone",658],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",658],"]",["T_WHITESPACE"," ",658],":",["T_WHITESPACE"," ",658],["T_VARIABLE","$zones",658],"[",["T_LNUMBER","0",658],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",658],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",658],["T_CONSTANT_ENCAPSED_STRING","'zone'",659],["T_WHITESPACE","\t\t\t ",659],["T_DOUBLE_ARROW","=>",659],["T_WHITESPACE"," ",659],"(",["T_VARIABLE","$zone",659],["T_WHITESPACE"," ",659],"?",["T_WHITESPACE"," ",659],["T_VARIABLE","$zone",659],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",659],"]",["T_WHITESPACE"," ",659],":",["T_WHITESPACE"," ",659],["T_VARIABLE","$zones",659],"[",["T_LNUMBER","0",659],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",659],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",659],["T_CONSTANT_ENCAPSED_STRING","'zone_code'",660],["T_WHITESPACE","\t\t ",660],["T_DOUBLE_ARROW","=>",660],["T_WHITESPACE"," ",660],"(",["T_VARIABLE","$zone",660],["T_WHITESPACE"," ",660],"?",["T_WHITESPACE"," ",660],["T_VARIABLE","$zone",660],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",660],"]",["T_WHITESPACE"," ",660],":",["T_WHITESPACE"," ",660],["T_VARIABLE","$zones",660],"[",["T_LNUMBER","0",660],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",660],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",660],["T_CONSTANT_ENCAPSED_STRING","'country_id'",661],["T_WHITESPACE","\t ",661],["T_DOUBLE_ARROW","=>",661],["T_WHITESPACE"," ",661],["T_VARIABLE","$country_info",661],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",661],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",661],["T_CONSTANT_ENCAPSED_STRING","'country'",662],["T_WHITESPACE","\t\t ",662],["T_DOUBLE_ARROW","=>",662],["T_WHITESPACE"," ",662],["T_VARIABLE","$country_info",662],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",662],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",662],["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",663],["T_WHITESPACE","\t ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_VARIABLE","$country_info",663],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",663],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",663],["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",664],["T_WHITESPACE","\t ",664],["T_DOUBLE_ARROW","=>",664],["T_WHITESPACE"," ",664],["T_VARIABLE","$country_info",664],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",664],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",664],["T_CONSTANT_ENCAPSED_STRING","'address_format'",665],["T_WHITESPACE"," ",665],["T_DOUBLE_ARROW","=>",665],["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","''",665],",",["T_WHITESPACE","\n\t\t\t\t\t\t",665],["T_CONSTANT_ENCAPSED_STRING","'custom_field'",666],["T_WHITESPACE","\t ",666],["T_DOUBLE_ARROW","=>",666],["T_WHITESPACE"," ",666],["T_ARRAY","array",666],"(",")",["T_WHITESPACE","\n\t\t\t\t\t",666],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",667],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","session",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","data",669],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",669],"]",["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_ARRAY","array",669],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",669],["T_CONSTANT_ENCAPSED_STRING","'email'",670],["T_WHITESPACE","\t\t ",670],["T_DOUBLE_ARROW","=>",670],["T_WHITESPACE"," ",670],["T_VARIABLE","$request",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","billing_address",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","email",670],",",["T_WHITESPACE","\n\t\t\t\t\t\t",670],["T_CONSTANT_ENCAPSED_STRING","'firstname'",671],["T_WHITESPACE","\t ",671],["T_DOUBLE_ARROW","=>",671],["T_WHITESPACE"," ",671],["T_VARIABLE","$request",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","billing_address",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","given_name",671],",",["T_WHITESPACE","\n\t\t\t\t\t\t",671],["T_CONSTANT_ENCAPSED_STRING","'lastname'",672],["T_WHITESPACE","\t ",672],["T_DOUBLE_ARROW","=>",672],["T_WHITESPACE"," ",672],["T_VARIABLE","$request",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","billing_address",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","family_name",672],",",["T_WHITESPACE","\n\t\t\t\t\t\t",672],["T_CONSTANT_ENCAPSED_STRING","'telephone'",673],["T_WHITESPACE","\t ",673],["T_DOUBLE_ARROW","=>",673],["T_WHITESPACE"," ",673],["T_VARIABLE","$request",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","billing_address",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","phone",673],",",["T_WHITESPACE","\n\t\t\t\t\t\t",673],["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",674],["T_WHITESPACE"," ",674],["T_DOUBLE_ARROW","=>",674],["T_WHITESPACE"," ",674],["T_VARIABLE","$this",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","session",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","data",674],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",674],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",674],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",674],["T_CONSTANT_ENCAPSED_STRING","'zone_code'",675],["T_WHITESPACE","  ",675],["T_DOUBLE_ARROW","=>",675],["T_WHITESPACE"," ",675],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","session",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","data",675],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",675],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_code'",675],"]",["T_WHITESPACE","\n\t\t\t\t\t",675],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",676],["T_COMMENT","\/\/ Unset $tax_rates\n",678],["T_WHITESPACE","\t\t\t\t\t",679],["T_VARIABLE","$this",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","tax",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","unsetRates",679],"(",")",";",["T_WHITESPACE","\n\t\t\t\t\t",679],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","tax",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","setShippingAddress",680],"(",["T_VARIABLE","$country_info",680],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",680],"]",",",["T_WHITESPACE"," ",680],"(",["T_VARIABLE","$zone",680],["T_WHITESPACE"," ",680],"?",["T_WHITESPACE"," ",680],["T_VARIABLE","$zone",680],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",680],"]",["T_WHITESPACE"," ",680],":",["T_WHITESPACE"," ",680],["T_VARIABLE","$zones",680],"[",["T_LNUMBER","0",680],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",680],"]",")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",680],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","tax",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","setStoreAddress",681],"(",["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","config",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","get",681],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",681],")",",",["T_WHITESPACE"," ",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","config",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","get",681],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",681],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",681],["T_COMMENT","\/\/Check if customer is US. If so, send taxes differently\n",683],["T_WHITESPACE","\t\t\t\t\t",684],["T_IF","if",684],["T_WHITESPACE"," ",684],"(",["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","session",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","data",684],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",684],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",684],"]",["T_WHITESPACE"," ",684],["T_IS_IDENTICAL","===",684],["T_WHITESPACE"," ",684],["T_CONSTANT_ENCAPSED_STRING","'US'",684],")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",684],["T_VARIABLE","$include_taxes",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_STRING","false",685],";",["T_WHITESPACE","\n\t\t\t\t\t",685],"}",["T_WHITESPACE"," ",686],["T_ELSE","else",686],["T_WHITESPACE"," ",686],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",686],["T_VARIABLE","$include_taxes",687],["T_WHITESPACE"," ",687],"=",["T_WHITESPACE"," ",687],["T_STRING","true",687],";",["T_WHITESPACE","\n\t\t\t\t\t",687],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",688],["T_VARIABLE","$method_data",690],["T_WHITESPACE"," ",690],"=",["T_WHITESPACE"," ",690],["T_ARRAY","array",690],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",690],["T_VARIABLE","$this",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","load",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","model",692],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/extension'",692],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",692],["T_VARIABLE","$results",694],["T_WHITESPACE"," ",694],"=",["T_WHITESPACE"," ",694],["T_VARIABLE","$this",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","model_extension_extension",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","getExtensions",694],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",694],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",694],["T_FOREACH","foreach",696],["T_WHITESPACE"," ",696],"(",["T_VARIABLE","$results",696],["T_WHITESPACE"," ",696],["T_AS","as",696],["T_WHITESPACE"," ",696],["T_VARIABLE","$result",696],")",["T_WHITESPACE"," ",696],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",696],["T_IF","if",697],["T_WHITESPACE"," ",697],"(",["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","config",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","get",697],"(",["T_VARIABLE","$result",697],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",697],"]",["T_WHITESPACE"," ",697],".",["T_WHITESPACE"," ",697],["T_CONSTANT_ENCAPSED_STRING","'_status'",697],")",")",["T_WHITESPACE"," ",697],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",697],["T_VARIABLE","$this",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","load",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","model",698],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/shipping\/'",698],["T_WHITESPACE"," ",698],".",["T_WHITESPACE"," ",698],["T_VARIABLE","$result",698],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",698],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",698],["T_VARIABLE","$quote",700],["T_WHITESPACE"," ",700],"=",["T_WHITESPACE"," ",700],["T_VARIABLE","$this",700],["T_OBJECT_OPERATOR","->",700],"{",["T_CONSTANT_ENCAPSED_STRING","'model_extension_shipping_'",700],["T_WHITESPACE"," ",700],".",["T_WHITESPACE"," ",700],["T_VARIABLE","$result",700],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",700],"]","}",["T_OBJECT_OPERATOR","->",700],["T_STRING","getQuote",700],"(",["T_VARIABLE","$this",700],["T_OBJECT_OPERATOR","->",700],["T_STRING","session",700],["T_OBJECT_OPERATOR","->",700],["T_STRING","data",700],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",700],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",700],["T_IF","if",702],["T_WHITESPACE"," ",702],"(",["T_VARIABLE","$quote",702],")",["T_WHITESPACE"," ",702],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",702],["T_VARIABLE","$method_data",703],"[",["T_VARIABLE","$result",703],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",703],"]","]",["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_ARRAY","array",703],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",703],["T_CONSTANT_ENCAPSED_STRING","'title'",704],["T_WHITESPACE","      ",704],["T_DOUBLE_ARROW","=>",704],["T_WHITESPACE"," ",704],["T_VARIABLE","$quote",704],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",704],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",704],["T_CONSTANT_ENCAPSED_STRING","'quote'",705],["T_WHITESPACE","      ",705],["T_DOUBLE_ARROW","=>",705],["T_WHITESPACE"," ",705],["T_VARIABLE","$quote",705],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",705],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",705],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",706],["T_WHITESPACE"," ",706],["T_DOUBLE_ARROW","=>",706],["T_WHITESPACE"," ",706],["T_VARIABLE","$quote",706],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",706],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",706],["T_CONSTANT_ENCAPSED_STRING","'error'",707],["T_WHITESPACE","      ",707],["T_DOUBLE_ARROW","=>",707],["T_WHITESPACE"," ",707],["T_VARIABLE","$quote",707],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",707],"]",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",707],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",708],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",709],"}",["T_WHITESPACE","\n\t\t\t\t\t",710],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",711],["T_VARIABLE","$sort_order",713],["T_WHITESPACE"," ",713],"=",["T_WHITESPACE"," ",713],["T_ARRAY","array",713],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",713],["T_FOREACH","foreach",715],["T_WHITESPACE"," ",715],"(",["T_VARIABLE","$method_data",715],["T_WHITESPACE"," ",715],["T_AS","as",715],["T_WHITESPACE"," ",715],["T_VARIABLE","$key",715],["T_WHITESPACE"," ",715],["T_DOUBLE_ARROW","=>",715],["T_WHITESPACE"," ",715],["T_VARIABLE","$value",715],")",["T_WHITESPACE"," ",715],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",715],["T_VARIABLE","$sort_order",716],"[",["T_VARIABLE","$key",716],"]",["T_WHITESPACE"," ",716],"=",["T_WHITESPACE"," ",716],["T_VARIABLE","$value",716],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",716],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",716],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",717],["T_STRING","array_multisort",719],"(",["T_VARIABLE","$sort_order",719],",",["T_WHITESPACE"," ",719],["T_STRING","SORT_ASC",719],",",["T_WHITESPACE"," ",719],["T_VARIABLE","$method_data",719],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",719],["T_VARIABLE","$shipping_methods",721],["T_WHITESPACE"," ",721],"=",["T_WHITESPACE"," ",721],["T_VARIABLE","$method_data",721],";",["T_WHITESPACE","\n\n\t\t\t\t\t",721],["T_IF","if",723],["T_WHITESPACE"," ",723],"(",["T_VARIABLE","$shipping_methods",723],")",["T_WHITESPACE"," ",723],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",723],["T_LIST","list",724],"(",["T_VARIABLE","$klarna_account",724],",",["T_WHITESPACE"," ",724],["T_VARIABLE","$connector",724],")",["T_WHITESPACE"," ",724],"=",["T_WHITESPACE"," ",724],["T_VARIABLE","$this",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","model_extension_payment_klarna_checkout",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","getConnector",724],"(",["T_VARIABLE","$this",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","config",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","get",724],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",724],")",",",["T_WHITESPACE"," ",724],["T_VARIABLE","$this",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","session",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","data",724],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",724],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",724],["T_IF","if",726],["T_WHITESPACE"," ",726],"(",["T_VARIABLE","$klarna_account",726],["T_WHITESPACE"," ",726],["T_BOOLEAN_AND","&&",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$connector",726],")",["T_WHITESPACE"," ",726],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",726],["T_LIST","list",727],"(",["T_VARIABLE","$klarna_order_data",727],",",["T_WHITESPACE"," ",727],["T_VARIABLE","$encrypted_order_data",727],")",["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","klarnaOrderData",727],"(",["T_VARIABLE","$klarna_account",727],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",727],["T_IF","if",729],["T_WHITESPACE"," ",729],"(",["T_VARIABLE","$this",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","cart",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","hasShipping",729],"(",")",")",["T_WHITESPACE"," ",729],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",729],["T_VARIABLE","$shipping_method",730],["T_WHITESPACE"," ",730],"=",["T_WHITESPACE"," ",730],["T_ARRAY","array",730],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",730],["T_IF","if",732],["T_WHITESPACE"," ",732],"(",["T_ISSET","isset",732],"(",["T_VARIABLE","$this",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","session",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","data",732],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",732],"]",")",["T_WHITESPACE"," ",732],["T_BOOLEAN_AND","&&",732],["T_WHITESPACE"," ",732],"!",["T_EMPTY","empty",732],"(",["T_VARIABLE","$this",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","session",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","data",732],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",732],"]",")",")",["T_WHITESPACE"," ",732],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",732],["T_FOREACH","foreach",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$shipping_methods",733],["T_WHITESPACE"," ",733],["T_AS","as",733],["T_WHITESPACE"," ",733],["T_VARIABLE","$individual_shipping_method",733],")",["T_WHITESPACE"," ",733],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",733],["T_IF","if",734],["T_WHITESPACE"," ",734],"(",["T_VARIABLE","$individual_shipping_method",734],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",734],"]",")",["T_WHITESPACE"," ",734],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t",734],["T_FOREACH","foreach",735],["T_WHITESPACE"," ",735],"(",["T_VARIABLE","$individual_shipping_method",735],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",735],"]",["T_WHITESPACE"," ",735],["T_AS","as",735],["T_WHITESPACE"," ",735],["T_VARIABLE","$quote",735],")",["T_WHITESPACE"," ",735],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t\t",735],["T_IF","if",736],["T_WHITESPACE"," ",736],"(","(",["T_VARIABLE","$this",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","session",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","data",736],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",736],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",736],"]",["T_WHITESPACE"," ",736],["T_IS_EQUAL","==",736],["T_WHITESPACE"," ",736],["T_VARIABLE","$quote",736],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",736],"]",")",["T_WHITESPACE"," ",736],["T_BOOLEAN_AND","&&",736],["T_WHITESPACE"," ",736],"(",["T_VARIABLE","$this",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","session",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","data",736],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",736],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",736],"]",["T_WHITESPACE"," ",736],["T_IS_EQUAL","==",736],["T_WHITESPACE"," ",736],["T_VARIABLE","$quote",736],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",736],"]",")",["T_WHITESPACE"," ",736],["T_BOOLEAN_AND","&&",736],["T_WHITESPACE"," ",736],"(",["T_VARIABLE","$this",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","session",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","data",736],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",736],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",736],"]",["T_WHITESPACE"," ",736],["T_IS_EQUAL","==",736],["T_WHITESPACE"," ",736],["T_VARIABLE","$quote",736],"[",["T_CONSTANT_ENCAPSED_STRING","'cost'",736],"]",")",["T_WHITESPACE"," ",736],["T_BOOLEAN_AND","&&",736],["T_WHITESPACE"," ",736],"(",["T_VARIABLE","$this",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","session",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","data",736],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",736],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",736],"]",["T_WHITESPACE"," ",736],["T_IS_EQUAL","==",736],["T_WHITESPACE"," ",736],["T_VARIABLE","$quote",736],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",736],"]",")",")",["T_WHITESPACE"," ",736],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t\t\t",736],["T_VARIABLE","$shipping_method",737],["T_WHITESPACE"," ",737],"=",["T_WHITESPACE"," ",737],["T_VARIABLE","$quote",737],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t\t\t",737],["T_BREAK","break",738],["T_WHITESPACE"," ",738],["T_LNUMBER","2",738],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t\t",738],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t",739],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",740],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",741],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",742],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",743],["T_COMMENT","\/\/ If the current shipping method isn't in the available shipping methods, assign default\n",745],["T_WHITESPACE","\t\t\t\t\t\t\t\t",746],["T_IF","if",746],["T_WHITESPACE"," ",746],"(","!",["T_VARIABLE","$shipping_method",746],")",["T_WHITESPACE"," ",746],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",746],["T_VARIABLE","$this",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","session",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","data",747],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",747],"]",["T_WHITESPACE"," ",747],"=",["T_WHITESPACE"," ",747],["T_VARIABLE","$this",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","model_extension_payment_klarna_checkout",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","getDefaultShippingMethod",747],"(",["T_VARIABLE","$shipping_methods",747],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",747],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",748],["T_VARIABLE","$total_amount",750],["T_WHITESPACE"," ",750],"=",["T_WHITESPACE"," ",750],["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","currency",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","format",750],"(",["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","tax",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","calculate",750],"(",["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","session",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","data",750],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",750],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",750],"]",",",["T_WHITESPACE"," ",750],["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","session",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","data",750],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",750],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",750],"]",",",["T_WHITESPACE"," ",750],["T_VARIABLE","$include_taxes",750],")",",",["T_WHITESPACE"," ",750],["T_VARIABLE","$order_info",750],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",750],"]",",",["T_WHITESPACE"," ",750],["T_VARIABLE","$order_info",750],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",750],"]",",",["T_WHITESPACE"," ",750],["T_STRING","false",750],")",["T_WHITESPACE"," ",750],"*",["T_WHITESPACE"," ",750],["T_LNUMBER","100",750],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",750],["T_IF","if",752],["T_WHITESPACE"," ",752],"(",["T_VARIABLE","$include_taxes",752],")",["T_WHITESPACE"," ",752],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",752],["T_VARIABLE","$total_tax_amount",753],["T_WHITESPACE"," ",753],"=",["T_WHITESPACE"," ",753],["T_VARIABLE","$this",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","currency",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","format",753],"(",["T_VARIABLE","$this",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","tax",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","getTax",753],"(",["T_VARIABLE","$this",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","session",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","data",753],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",753],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",753],"]",",",["T_WHITESPACE"," ",753],["T_VARIABLE","$this",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","session",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","data",753],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",753],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",753],"]",")",",",["T_WHITESPACE"," ",753],["T_VARIABLE","$order_info",753],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",753],"]",",",["T_WHITESPACE"," ",753],["T_VARIABLE","$order_info",753],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",753],"]",",",["T_WHITESPACE"," ",753],["T_STRING","false",753],")",["T_WHITESPACE"," ",753],"*",["T_WHITESPACE"," ",753],["T_LNUMBER","100",753],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",753],"}",["T_WHITESPACE"," ",754],["T_ELSE","else",754],["T_WHITESPACE"," ",754],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",754],["T_VARIABLE","$total_tax_amount",755],["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_LNUMBER","0",755],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",755],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",756],["T_VARIABLE","$total_sub_amount",758],["T_WHITESPACE"," ",758],"=",["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","currency",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","format",758],"(",["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","tax",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","calculate",758],"(",["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","session",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","data",758],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",758],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",758],"]",",",["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","session",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","data",758],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",758],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",758],"]",",",["T_WHITESPACE"," ",758],["T_STRING","false",758],")",",",["T_WHITESPACE"," ",758],["T_VARIABLE","$order_info",758],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",758],"]",",",["T_WHITESPACE"," ",758],["T_VARIABLE","$order_info",758],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",758],"]",",",["T_WHITESPACE"," ",758],["T_STRING","false",758],")",["T_WHITESPACE"," ",758],"*",["T_WHITESPACE"," ",758],["T_LNUMBER","100",758],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",758],["T_VARIABLE","$tax_rate",760],["T_WHITESPACE"," ",760],"=",["T_WHITESPACE"," ",760],["T_LNUMBER","0",760],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",760],["T_IF","if",762],["T_WHITESPACE"," ",762],"(",["T_VARIABLE","$include_taxes",762],["T_WHITESPACE"," ",762],["T_BOOLEAN_AND","&&",762],["T_WHITESPACE"," ",762],["T_VARIABLE","$total_tax_amount",762],["T_WHITESPACE"," ",762],["T_BOOLEAN_AND","&&",762],["T_WHITESPACE"," ",762],["T_VARIABLE","$total_sub_amount",762],")",["T_WHITESPACE"," ",762],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",762],["T_VARIABLE","$tax_rate",763],["T_WHITESPACE"," ",763],"=",["T_WHITESPACE"," ",763],"(",["T_VARIABLE","$total_tax_amount",763],["T_WHITESPACE"," ",763],"\/",["T_WHITESPACE"," ",763],["T_VARIABLE","$total_sub_amount",763],")",["T_WHITESPACE"," ",763],"*",["T_WHITESPACE"," ",763],["T_LNUMBER","100",763],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",763],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",764],["T_FOREACH","foreach",766],["T_WHITESPACE"," ",766],"(",["T_VARIABLE","$klarna_order_data",766],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",766],"]",["T_WHITESPACE"," ",766],["T_AS","as",766],["T_WHITESPACE"," ",766],["T_VARIABLE","$key",766],["T_WHITESPACE"," ",766],["T_DOUBLE_ARROW","=>",766],["T_WHITESPACE"," ",766],["T_VARIABLE","$order_line",766],")",["T_WHITESPACE"," ",766],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",766],["T_IF","if",767],["T_WHITESPACE"," ",767],"(",["T_VARIABLE","$order_line",767],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",767],"]",["T_WHITESPACE"," ",767],["T_IS_EQUAL","==",767],["T_WHITESPACE"," ",767],["T_CONSTANT_ENCAPSED_STRING","'shipping_fee'",767],")",["T_WHITESPACE"," ",767],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",767],["T_UNSET","unset",768],"(",["T_VARIABLE","$klarna_order_data",768],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",768],"]","[",["T_VARIABLE","$key",768],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",768],["T_BREAK","break",769],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",769],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",770],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",771],["T_VARIABLE","$klarna_order_data",773],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",773],"]","[","]",["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_ARRAY","array",773],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",773],["T_CONSTANT_ENCAPSED_STRING","'type'",774],["T_WHITESPACE","\t\t\t\t\t",774],["T_DOUBLE_ARROW","=>",774],["T_WHITESPACE"," ",774],["T_CONSTANT_ENCAPSED_STRING","'shipping_fee'",774],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",774],["T_CONSTANT_ENCAPSED_STRING","'name'",775],["T_WHITESPACE","\t\t\t\t\t",775],["T_DOUBLE_ARROW","=>",775],["T_WHITESPACE"," ",775],["T_VARIABLE","$this",775],["T_OBJECT_OPERATOR","->",775],["T_STRING","session",775],["T_OBJECT_OPERATOR","->",775],["T_STRING","data",775],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",775],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",775],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",775],["T_CONSTANT_ENCAPSED_STRING","'quantity'",776],["T_WHITESPACE","\t\t\t\t",776],["T_DOUBLE_ARROW","=>",776],["T_WHITESPACE"," ",776],["T_CONSTANT_ENCAPSED_STRING","'1'",776],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",776],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",777],["T_WHITESPACE","\t\t\t",777],["T_DOUBLE_ARROW","=>",777],["T_WHITESPACE"," ",777],["T_STRING","round",777],"(",["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","currency",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","format",777],"(",["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","tax",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","calculate",777],"(",["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","session",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","data",777],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",777],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",777],"]",",",["T_WHITESPACE"," ",777],["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","session",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","data",777],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",777],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",777],"]",",",["T_WHITESPACE"," ",777],["T_VARIABLE","$include_taxes",777],")",",",["T_WHITESPACE"," ",777],["T_VARIABLE","$order_info",777],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",777],"]",",",["T_WHITESPACE"," ",777],["T_VARIABLE","$order_info",777],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",777],"]",",",["T_WHITESPACE"," ",777],["T_STRING","false",777],")",["T_WHITESPACE"," ",777],"*",["T_WHITESPACE"," ",777],["T_LNUMBER","100",777],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",777],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",778],["T_WHITESPACE","\t\t\t\t",778],["T_DOUBLE_ARROW","=>",778],["T_WHITESPACE"," ",778],["T_STRING","round",778],"(",["T_VARIABLE","$tax_rate",778],["T_WHITESPACE"," ",778],"*",["T_WHITESPACE"," ",778],["T_LNUMBER","100",778],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",778],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",779],["T_WHITESPACE","\t\t\t",779],["T_DOUBLE_ARROW","=>",779],["T_WHITESPACE"," ",779],["T_STRING","round",779],"(",["T_VARIABLE","$total_amount",779],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",779],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",780],["T_WHITESPACE","\t\t",780],["T_DOUBLE_ARROW","=>",780],["T_WHITESPACE"," ",780],["T_STRING","round",780],"(",["T_VARIABLE","$total_tax_amount",780],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",780],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",781],["T_WHITESPACE"," ",781],["T_DOUBLE_ARROW","=>",781],["T_WHITESPACE"," ",781],["T_LNUMBER","0",781],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",781],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",782],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",783],["T_LIST","list",785],"(",["T_VARIABLE","$totals",785],",",["T_WHITESPACE"," ",785],["T_VARIABLE","$taxes",785],",",["T_WHITESPACE"," ",785],["T_VARIABLE","$total",785],")",["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_VARIABLE","$this",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","model_extension_payment_klarna_checkout",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","getTotals",785],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",785],["T_COMMENT","\/\/If $include_taxes is false, means customer is US so we add a new sales_tax order line with all the tax\n",787],["T_WHITESPACE","\t\t\t\t\t\t\t",788],["T_IF","if",788],["T_WHITESPACE"," ",788],"(","!",["T_VARIABLE","$include_taxes",788],")",["T_WHITESPACE"," ",788],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",788],["T_FOREACH","foreach",789],["T_WHITESPACE"," ",789],"(",["T_VARIABLE","$klarna_order_data",789],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",789],"]",["T_WHITESPACE"," ",789],["T_AS","as",789],["T_WHITESPACE"," ",789],["T_VARIABLE","$key",789],["T_WHITESPACE"," ",789],["T_DOUBLE_ARROW","=>",789],["T_WHITESPACE"," ",789],["T_VARIABLE","$order_line",789],")",["T_WHITESPACE"," ",789],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",789],["T_IF","if",790],["T_WHITESPACE"," ",790],"(",["T_VARIABLE","$order_line",790],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",790],"]",["T_WHITESPACE"," ",790],["T_IS_EQUAL","==",790],["T_WHITESPACE"," ",790],["T_CONSTANT_ENCAPSED_STRING","'sales_tax'",790],")",["T_WHITESPACE"," ",790],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",790],["T_UNSET","unset",791],"(",["T_VARIABLE","$klarna_order_data",791],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",791],"]","[",["T_VARIABLE","$key",791],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",791],["T_BREAK","break",792],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",792],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",793],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",794],["T_VARIABLE","$klarna_order_data",796],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",796],"]","[","]",["T_WHITESPACE"," ",796],"=",["T_WHITESPACE"," ",796],["T_ARRAY","array",796],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",796],["T_CONSTANT_ENCAPSED_STRING","'type'",797],["T_WHITESPACE","\t\t\t\t\t",797],["T_DOUBLE_ARROW","=>",797],["T_WHITESPACE"," ",797],["T_CONSTANT_ENCAPSED_STRING","'sales_tax'",797],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",797],["T_CONSTANT_ENCAPSED_STRING","'name'",798],["T_WHITESPACE","\t\t\t\t\t",798],["T_DOUBLE_ARROW","=>",798],["T_WHITESPACE"," ",798],["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","language",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","get",798],"(",["T_CONSTANT_ENCAPSED_STRING","'text_sales_tax'",798],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",798],["T_CONSTANT_ENCAPSED_STRING","'quantity'",799],["T_WHITESPACE","\t\t\t\t",799],["T_DOUBLE_ARROW","=>",799],["T_WHITESPACE"," ",799],["T_CONSTANT_ENCAPSED_STRING","'1'",799],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",799],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",800],["T_WHITESPACE","\t\t\t",800],["T_DOUBLE_ARROW","=>",800],["T_WHITESPACE"," ",800],["T_STRING","round",800],"(",["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","currency",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","format",800],"(",["T_STRING","array_sum",800],"(",["T_VARIABLE","$taxes",800],")",",",["T_WHITESPACE"," ",800],["T_VARIABLE","$order_info",800],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",800],"]",",",["T_WHITESPACE"," ",800],["T_VARIABLE","$order_info",800],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",800],"]",",",["T_WHITESPACE"," ",800],["T_STRING","false",800],")",["T_WHITESPACE"," ",800],"*",["T_WHITESPACE"," ",800],["T_LNUMBER","100",800],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",800],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",801],["T_WHITESPACE","\t\t\t\t",801],["T_DOUBLE_ARROW","=>",801],["T_WHITESPACE"," ",801],["T_LNUMBER","0",801],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",801],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",802],["T_WHITESPACE","\t\t\t",802],["T_DOUBLE_ARROW","=>",802],["T_WHITESPACE"," ",802],["T_STRING","round",802],"(",["T_VARIABLE","$this",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","currency",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","format",802],"(",["T_STRING","array_sum",802],"(",["T_VARIABLE","$taxes",802],")",",",["T_WHITESPACE"," ",802],["T_VARIABLE","$order_info",802],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",802],"]",",",["T_WHITESPACE"," ",802],["T_VARIABLE","$order_info",802],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",802],"]",",",["T_WHITESPACE"," ",802],["T_STRING","false",802],")",["T_WHITESPACE"," ",802],"*",["T_WHITESPACE"," ",802],["T_LNUMBER","100",802],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",802],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",803],["T_WHITESPACE","\t\t",803],["T_DOUBLE_ARROW","=>",803],["T_WHITESPACE"," ",803],["T_LNUMBER","0",803],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",803],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",804],["T_WHITESPACE"," ",804],["T_DOUBLE_ARROW","=>",804],["T_WHITESPACE"," ",804],["T_LNUMBER","0",804],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",804],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",805],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",806],["T_VARIABLE","$http_response_code",808],["T_WHITESPACE"," ",808],"=",["T_WHITESPACE"," ",808],["T_LNUMBER","200",808],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",808],["T_VARIABLE","$json",810],["T_WHITESPACE"," ",810],"=",["T_WHITESPACE"," ",810],["T_ARRAY","array",810],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",810],["T_CONSTANT_ENCAPSED_STRING","'order_amount'",811],["T_WHITESPACE","     ",811],["T_DOUBLE_ARROW","=>",811],["T_WHITESPACE"," ",811],["T_STRING","round",811],"(",["T_VARIABLE","$this",811],["T_OBJECT_OPERATOR","->",811],["T_STRING","currency",811],["T_OBJECT_OPERATOR","->",811],["T_STRING","format",811],"(",["T_VARIABLE","$total",811],",",["T_WHITESPACE"," ",811],["T_VARIABLE","$order_info",811],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",811],"]",",",["T_WHITESPACE"," ",811],["T_VARIABLE","$order_info",811],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",811],"]",",",["T_WHITESPACE"," ",811],["T_STRING","false",811],")",["T_WHITESPACE"," ",811],"*",["T_WHITESPACE"," ",811],["T_LNUMBER","100",811],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",811],["T_CONSTANT_ENCAPSED_STRING","'order_tax_amount'",812],["T_WHITESPACE"," ",812],["T_DOUBLE_ARROW","=>",812],["T_WHITESPACE"," ",812],["T_STRING","round",812],"(",["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","currency",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","format",812],"(",["T_STRING","array_sum",812],"(",["T_VARIABLE","$taxes",812],")",",",["T_WHITESPACE"," ",812],["T_VARIABLE","$order_info",812],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",812],"]",",",["T_WHITESPACE"," ",812],["T_VARIABLE","$order_info",812],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",812],"]",",",["T_WHITESPACE"," ",812],["T_STRING","false",812],")",["T_WHITESPACE"," ",812],"*",["T_WHITESPACE"," ",812],["T_LNUMBER","100",812],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",812],["T_CONSTANT_ENCAPSED_STRING","'order_lines'",813],["T_WHITESPACE","      ",813],["T_DOUBLE_ARROW","=>",813],["T_WHITESPACE"," ",813],["T_STRING","array_values",813],"(",["T_VARIABLE","$klarna_order_data",813],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",813],"]",")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",813],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",814],"}",["T_WHITESPACE","\n\t\t\t\t\t",815],"}",["T_WHITESPACE","\n\t\t\t\t",816],"}",["T_WHITESPACE","\n\t\t\t",817],"}",["T_WHITESPACE","\n\t\t",818],"}",["T_WHITESPACE","\n\n\t\t",819],["T_VARIABLE","$this",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","model_extension_payment_klarna_checkout",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","log",821],"(",["T_VARIABLE","$http_response_code",821],")",";",["T_WHITESPACE","\n\t\t",821],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","model_extension_payment_klarna_checkout",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","log",822],"(",["T_VARIABLE","$json",822],")",";",["T_WHITESPACE","\n\n\t\t",822],["T_STRING","http_response_code",824],"(",["T_VARIABLE","$http_response_code",824],")",";",["T_WHITESPACE","\n\t\t",824],["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","response",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","addHeader",825],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",825],")",";",["T_WHITESPACE","\n\t\t",825],["T_VARIABLE","$this",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","response",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","setOutput",826],"(",["T_STRING","json_encode",826],"(",["T_VARIABLE","$json",826],")",")",";",["T_WHITESPACE","\n\t",826],"}",["T_WHITESPACE","\n\n\t",827],["T_PUBLIC","public",829],["T_WHITESPACE"," ",829],["T_FUNCTION","function",829],["T_WHITESPACE"," ",829],["T_STRING","notification",829],"(",")",["T_WHITESPACE"," ",829],"{",["T_WHITESPACE","\n\t\t",829],["T_VARIABLE","$this",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","load",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","model",830],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",830],")",";",["T_WHITESPACE","\n\t\t",830],["T_VARIABLE","$this",831],["T_OBJECT_OPERATOR","->",831],["T_STRING","load",831],["T_OBJECT_OPERATOR","->",831],["T_STRING","model",831],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",831],")",";",["T_WHITESPACE","\n\n\t\t",831],["T_IF","if",833],["T_WHITESPACE"," ",833],"(","!",["T_VARIABLE","$this",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","config",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","get",833],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",833],")",")",["T_WHITESPACE"," ",833],"{",["T_WHITESPACE","\n\t\t\t",833],["T_RETURN","return",834],["T_WHITESPACE"," ",834],["T_STRING","false",834],";",["T_WHITESPACE","\n\t\t",834],"}",["T_WHITESPACE","\n\n\t\t",835],["T_VARIABLE","$request",837],["T_WHITESPACE"," ",837],"=",["T_WHITESPACE"," ",837],["T_STRING","json_decode",837],"(",["T_STRING","file_get_contents",837],"(",["T_CONSTANT_ENCAPSED_STRING","'php:\/\/input'",837],")",")",";",["T_WHITESPACE","\n\n\t\t",837],["T_IF","if",839],["T_WHITESPACE"," ",839],"(",["T_ISSET","isset",839],"(",["T_VARIABLE","$request",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","order_id",839],")",")",["T_WHITESPACE"," ",839],"{",["T_WHITESPACE","\n\t\t\t",839],["T_VARIABLE","$klarna_checkout_order",840],["T_WHITESPACE"," ",840],"=",["T_WHITESPACE"," ",840],["T_VARIABLE","$this",840],["T_OBJECT_OPERATOR","->",840],["T_STRING","model_extension_payment_klarna_checkout",840],["T_OBJECT_OPERATOR","->",840],["T_STRING","getOrder",840],"(",["T_VARIABLE","$request",840],["T_OBJECT_OPERATOR","->",840],["T_STRING","order_id",840],")",";",["T_WHITESPACE","\n\n\t\t\t",840],["T_IF","if",842],["T_WHITESPACE"," ",842],"(",["T_VARIABLE","$klarna_checkout_order",842],")",["T_WHITESPACE"," ",842],"{",["T_WHITESPACE","\n\t\t\t\t",842],["T_VARIABLE","$order_info",843],["T_WHITESPACE"," ",843],"=",["T_WHITESPACE"," ",843],["T_VARIABLE","$this",843],["T_OBJECT_OPERATOR","->",843],["T_STRING","model_checkout_order",843],["T_OBJECT_OPERATOR","->",843],["T_STRING","getOrder",843],"(",["T_VARIABLE","$klarna_checkout_order",843],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",843],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",843],["T_IF","if",845],["T_WHITESPACE"," ",845],"(",["T_VARIABLE","$order_info",845],")",["T_WHITESPACE"," ",845],"{",["T_WHITESPACE","\n\t\t\t\t\t",845],["T_LIST","list",846],"(",["T_VARIABLE","$klarna_account",846],",",["T_WHITESPACE"," ",846],["T_VARIABLE","$connector",846],")",["T_WHITESPACE"," ",846],"=",["T_WHITESPACE"," ",846],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","model_extension_payment_klarna_checkout",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","getConnector",846],"(",["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","config",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","get",846],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",846],")",",",["T_WHITESPACE"," ",846],["T_VARIABLE","$order_info",846],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",846],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",846],["T_IF","if",848],["T_WHITESPACE"," ",848],"(","!",["T_VARIABLE","$klarna_account",848],["T_WHITESPACE"," ",848],["T_BOOLEAN_OR","||",848],["T_WHITESPACE"," ",848],"!",["T_VARIABLE","$connector",848],")",["T_WHITESPACE"," ",848],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",848],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","model_extension_payment_klarna_checkout",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","log",849],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not getConnector'",849],")",";",["T_WHITESPACE","\n\t\t\t\t\t",849],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",850],["T_VARIABLE","$retrieve",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_VARIABLE","$this",852],["T_OBJECT_OPERATOR","->",852],["T_STRING","model_extension_payment_klarna_checkout",852],["T_OBJECT_OPERATOR","->",852],["T_STRING","omOrderRetrieve",852],"(",["T_VARIABLE","$connector",852],",",["T_WHITESPACE"," ",852],["T_VARIABLE","$request",852],["T_OBJECT_OPERATOR","->",852],["T_STRING","order_id",852],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",852],["T_VARIABLE","$order_status_id",854],["T_WHITESPACE"," ",854],"=",["T_WHITESPACE"," ",854],["T_STRING","false",854],";",["T_WHITESPACE","\n\t\t\t\t\t",854],["T_IF","if",855],["T_WHITESPACE"," ",855],"(",["T_VARIABLE","$retrieve",855],")",["T_WHITESPACE"," ",855],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",855],["T_SWITCH","switch",856],["T_WHITESPACE"," ",856],"(",["T_VARIABLE","$request",856],["T_OBJECT_OPERATOR","->",856],["T_STRING","event_type",856],")",["T_WHITESPACE"," ",856],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",856],["T_CASE","case",857],["T_WHITESPACE"," ",857],["T_CONSTANT_ENCAPSED_STRING","'FRAUD_RISK_ACCEPTED'",857],":",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",857],["T_VARIABLE","$order_status_id",858],["T_WHITESPACE"," ",858],"=",["T_WHITESPACE"," ",858],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","config",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","get",858],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_fraud_accepted_id'",858],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",858],["T_BREAK","break",859],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",859],["T_CASE","case",860],["T_WHITESPACE"," ",860],["T_CONSTANT_ENCAPSED_STRING","'FRAUD_RISK_REJECTED'",860],":",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",860],["T_VARIABLE","$order_status_id",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","config",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","get",861],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_fraud_rejected_id'",861],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",861],["T_BREAK","break",862],";",["T_WHITESPACE","\n\t\t\t\t\t\t",862],"}",["T_WHITESPACE","\n\t\t\t\t\t",863],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",864],["T_IF","if",866],["T_WHITESPACE"," ",866],"(",["T_VARIABLE","$order_status_id",866],")",["T_WHITESPACE"," ",866],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",866],["T_VARIABLE","$this",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","model_checkout_order",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","addOrderHistory",867],"(",["T_VARIABLE","$klarna_checkout_order",867],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",867],"]",",",["T_WHITESPACE"," ",867],["T_VARIABLE","$order_status_id",867],")",";",["T_WHITESPACE","\n\t\t\t\t\t",867],"}",["T_WHITESPACE","\n\t\t\t\t",868],"}",["T_WHITESPACE","\n\t\t\t",869],"}",["T_WHITESPACE"," ",870],["T_ELSE","else",870],["T_WHITESPACE"," ",870],"{",["T_WHITESPACE","\n\t\t\t\t",870],["T_VARIABLE","$this",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","model_extension_payment_klarna_checkout",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","log",871],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not find order id using '",871],["T_WHITESPACE"," ",871],".",["T_WHITESPACE"," ",871],["T_VARIABLE","$request",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","order_id",871],")",";",["T_WHITESPACE","\n\t\t\t",871],"}",["T_WHITESPACE","\n\t\t",872],"}",["T_WHITESPACE"," ",873],["T_ELSE","else",873],["T_WHITESPACE"," ",873],"{",["T_WHITESPACE","\n\t\t\t",873],["T_VARIABLE","$this",874],["T_OBJECT_OPERATOR","->",874],["T_STRING","model_extension_payment_klarna_checkout",874],["T_OBJECT_OPERATOR","->",874],["T_STRING","log",874],"(",["T_CONSTANT_ENCAPSED_STRING","'$request->order_id is not set'",874],")",";",["T_WHITESPACE","\n\t\t",874],"}",["T_WHITESPACE","\n\t",875],"}",["T_WHITESPACE","\n\n\t",876],["T_PUBLIC","public",878],["T_WHITESPACE"," ",878],["T_FUNCTION","function",878],["T_WHITESPACE"," ",878],["T_STRING","validation",878],"(",")",["T_WHITESPACE"," ",878],"{",["T_WHITESPACE","\n\t\t",878],["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","load",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","model",879],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/customer'",879],")",";",["T_WHITESPACE","\n\t\t",879],["T_VARIABLE","$this",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","load",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","model",880],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",880],")",";",["T_WHITESPACE","\n\t\t",880],["T_VARIABLE","$this",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","load",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","model",881],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",881],")",";",["T_WHITESPACE","\n\n\t\t",881],["T_IF","if",883],["T_WHITESPACE"," ",883],"(","!",["T_VARIABLE","$this",883],["T_OBJECT_OPERATOR","->",883],["T_STRING","config",883],["T_OBJECT_OPERATOR","->",883],["T_STRING","get",883],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",883],")",")",["T_WHITESPACE"," ",883],"{",["T_WHITESPACE","\n\t\t\t",883],["T_RETURN","return",884],["T_WHITESPACE"," ",884],["T_STRING","false",884],";",["T_WHITESPACE","\n\t\t",884],"}",["T_WHITESPACE","\n\n\t\t",885],["T_VARIABLE","$validate",887],["T_WHITESPACE"," ",887],"=",["T_WHITESPACE"," ",887],["T_STRING","true",887],";",["T_WHITESPACE","\n\n\t\t",887],["T_VARIABLE","$request",889],["T_WHITESPACE"," ",889],"=",["T_WHITESPACE"," ",889],["T_STRING","json_decode",889],"(",["T_STRING","file_get_contents",889],"(",["T_CONSTANT_ENCAPSED_STRING","'php:\/\/input'",889],")",")",";",["T_WHITESPACE","\n\n\t\t",889],["T_VARIABLE","$json",891],["T_WHITESPACE"," ",891],"=",["T_WHITESPACE"," ",891],["T_ARRAY","array",891],"(",")",";",["T_WHITESPACE","\n\n\t\t",891],["T_COMMENT","\/\/ Check to see if request data is complete\n",893],["T_WHITESPACE","\t\t",894],["T_IF","if",894],["T_WHITESPACE"," ",894],"(","!",["T_VARIABLE","$request",894],["T_WHITESPACE"," ",894],["T_BOOLEAN_OR","||",894],["T_WHITESPACE"," ",894],"!",["T_ISSET","isset",894],"(",["T_VARIABLE","$request",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","order_lines",894],")",["T_WHITESPACE"," ",894],["T_BOOLEAN_OR","||",894],["T_WHITESPACE"," ",894],["T_EMPTY","empty",894],"(",["T_VARIABLE","$request",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","order_lines",894],")",["T_WHITESPACE"," ",894],["T_BOOLEAN_OR","||",894],["T_WHITESPACE"," ",894],"!",["T_ISSET","isset",894],"(",["T_VARIABLE","$request",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","shipping_address",894],")",["T_WHITESPACE"," ",894],["T_BOOLEAN_OR","||",894],["T_WHITESPACE"," ",894],["T_EMPTY","empty",894],"(",["T_VARIABLE","$request",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","shipping_address",894],")",["T_WHITESPACE"," ",894],["T_BOOLEAN_OR","||",894],["T_WHITESPACE"," ",894],"!",["T_ISSET","isset",894],"(",["T_VARIABLE","$request",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","billing_address",894],")",["T_WHITESPACE"," ",894],["T_BOOLEAN_OR","||",894],["T_WHITESPACE"," ",894],["T_EMPTY","empty",894],"(",["T_VARIABLE","$request",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","billing_address",894],")",")",["T_WHITESPACE"," ",894],"{",["T_WHITESPACE","\n\t\t\t",894],["T_VARIABLE","$this",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","model_extension_payment_klarna_checkout",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","log",895],"(",["T_CONSTANT_ENCAPSED_STRING","'Request data incomplete. Full request below:'",895],")",";",["T_WHITESPACE","\n\t\t\t",895],["T_VARIABLE","$this",896],["T_OBJECT_OPERATOR","->",896],["T_STRING","model_extension_payment_klarna_checkout",896],["T_OBJECT_OPERATOR","->",896],["T_STRING","log",896],"(",["T_VARIABLE","$request",896],")",";",["T_WHITESPACE","\n\t\t\t",896],["T_VARIABLE","$validate",897],["T_WHITESPACE"," ",897],"=",["T_WHITESPACE"," ",897],["T_STRING","false",897],";",["T_WHITESPACE","\n\t\t",897],"}",["T_WHITESPACE","\n\n\t\t",898],["T_COMMENT","\/\/ Get Klarna order info from db\n",900],["T_WHITESPACE","\t\t",901],["T_IF","if",901],["T_WHITESPACE"," ",901],"(",["T_VARIABLE","$validate",901],")",["T_WHITESPACE"," ",901],"{",["T_WHITESPACE","\n\t\t\t",901],["T_VARIABLE","$order_id",902],["T_WHITESPACE"," ",902],"=",["T_WHITESPACE"," ",902],["T_STRING","null",902],";",["T_WHITESPACE","\n\n\t\t\t",902],["T_FOREACH","foreach",904],["T_WHITESPACE"," ",904],"(",["T_VARIABLE","$request",904],["T_OBJECT_OPERATOR","->",904],["T_STRING","order_lines",904],["T_WHITESPACE"," ",904],["T_AS","as",904],["T_WHITESPACE"," ",904],["T_VARIABLE","$order_line",904],")",["T_WHITESPACE"," ",904],"{",["T_WHITESPACE","\n\t\t\t\t",904],["T_IF","if",905],["T_WHITESPACE"," ",905],"(",["T_VARIABLE","$order_line",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","type",905],["T_WHITESPACE"," ",905],["T_IS_EQUAL","==",905],["T_WHITESPACE"," ",905],["T_CONSTANT_ENCAPSED_STRING","'physical'",905],["T_WHITESPACE"," ",905],["T_BOOLEAN_OR","||",905],["T_WHITESPACE"," ",905],["T_VARIABLE","$order_line",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","type",905],["T_WHITESPACE"," ",905],["T_IS_EQUAL","==",905],["T_WHITESPACE"," ",905],["T_CONSTANT_ENCAPSED_STRING","'digital'",905],["T_WHITESPACE"," ",905],["T_BOOLEAN_OR","||",905],["T_WHITESPACE"," ",905],["T_VARIABLE","$order_line",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","type",905],["T_WHITESPACE"," ",905],["T_IS_EQUAL","==",905],["T_WHITESPACE"," ",905],["T_CONSTANT_ENCAPSED_STRING","'gift_card'",905],")",["T_WHITESPACE"," ",905],"{",["T_WHITESPACE","\n\t\t\t\t\t",905],["T_VARIABLE","$order_id",906],["T_WHITESPACE"," ",906],"=",["T_WHITESPACE"," ",906],["T_VARIABLE","$this",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","encryption",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","decrypt",906],"(",["T_VARIABLE","$order_line",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","merchant_data",906],")",";",["T_WHITESPACE","\n\t\t\t\t\t",906],["T_BREAK","break",907],";",["T_WHITESPACE","\n\t\t\t\t",907],"}",["T_WHITESPACE","\n\t\t\t",908],"}",["T_WHITESPACE","\n\n\t\t\t",909],["T_IF","if",911],["T_WHITESPACE"," ",911],"(",["T_VARIABLE","$order_id",911],")",["T_WHITESPACE"," ",911],"{",["T_WHITESPACE","\n\t\t\t\t",911],["T_COMMENT","\/\/ Get klarna order data from db\n",912],["T_WHITESPACE","\t\t\t\t",913],["T_VARIABLE","$klarna_checkout_order",913],["T_WHITESPACE"," ",913],"=",["T_WHITESPACE"," ",913],["T_VARIABLE","$this",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","model_extension_payment_klarna_checkout",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","getOrderByOrderId",913],"(",["T_VARIABLE","$order_id",913],")",";",["T_WHITESPACE","\n\n\t\t\t\t",913],["T_IF","if",915],["T_WHITESPACE"," ",915],"(","!",["T_VARIABLE","$klarna_checkout_order",915],["T_WHITESPACE"," ",915],["T_BOOLEAN_OR","||",915],["T_WHITESPACE"," ",915],"!",["T_VARIABLE","$klarna_checkout_order",915],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",915],"]",")",["T_WHITESPACE"," ",915],"{",["T_WHITESPACE","\n\t\t\t\t\t",915],["T_VARIABLE","$this",916],["T_OBJECT_OPERATOR","->",916],["T_STRING","model_extension_payment_klarna_checkout",916],["T_OBJECT_OPERATOR","->",916],["T_STRING","log",916],"(",["T_CONSTANT_ENCAPSED_STRING","'No klarna order found using order_id: '",916],["T_WHITESPACE"," ",916],".",["T_WHITESPACE"," ",916],["T_VARIABLE","$order_id",916],")",";",["T_WHITESPACE","\n\t\t\t\t\t",916],["T_VARIABLE","$validate",917],["T_WHITESPACE"," ",917],"=",["T_WHITESPACE"," ",917],["T_STRING","false",917],";",["T_WHITESPACE","\n\t\t\t\t",917],"}",["T_WHITESPACE","\n\t\t\t",918],"}",["T_WHITESPACE"," ",919],["T_ELSE","else",919],["T_WHITESPACE"," ",919],"{",["T_WHITESPACE","\n\t\t\t\t",919],["T_VARIABLE","$this",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","model_extension_payment_klarna_checkout",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","log",920],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot get decrypted order_id'",920],")",";",["T_WHITESPACE","\n\t\t\t\t",920],["T_VARIABLE","$validate",921],["T_WHITESPACE"," ",921],"=",["T_WHITESPACE"," ",921],["T_STRING","false",921],";",["T_WHITESPACE","\n\t\t\t",921],"}",["T_WHITESPACE","\n\t\t",922],"}",["T_WHITESPACE","\n\n\t\t",923],["T_IF","if",925],["T_WHITESPACE"," ",925],"(",["T_VARIABLE","$validate",925],")",["T_WHITESPACE"," ",925],"{",["T_WHITESPACE","\n\t\t\t",925],["T_VARIABLE","$klarna_checkout_order_data",926],["T_WHITESPACE"," ",926],"=",["T_WHITESPACE"," ",926],["T_STRING","json_decode",926],"(",["T_VARIABLE","$this",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","encryption",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","decrypt",926],"(",["T_VARIABLE","$klarna_checkout_order",926],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",926],"]",")",",",["T_WHITESPACE"," ",926],["T_STRING","true",926],")",";",["T_WHITESPACE","\n\n\t\t\t",926],["T_COMMENT","\/\/ Check credentials in request with ones stored in db\n",928],["T_WHITESPACE","\t\t\t",929],["T_VARIABLE","$valid_request",929],["T_WHITESPACE"," ",929],"=",["T_WHITESPACE"," ",929],["T_STRING","false",929],";",["T_WHITESPACE","\n\t\t\t",929],["T_FOREACH","foreach",930],["T_WHITESPACE"," ",930],"(",["T_VARIABLE","$this",930],["T_OBJECT_OPERATOR","->",930],["T_STRING","config",930],["T_OBJECT_OPERATOR","->",930],["T_STRING","get",930],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",930],")",["T_WHITESPACE"," ",930],["T_AS","as",930],["T_WHITESPACE"," ",930],["T_VARIABLE","$account",930],")",["T_WHITESPACE"," ",930],"{",["T_WHITESPACE","\n\t\t\t\t",930],["T_IF","if",931],["T_WHITESPACE"," ",931],"(","(",["T_VARIABLE","$account",931],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",931],"]",["T_WHITESPACE"," ",931],["T_IS_EQUAL","==",931],["T_WHITESPACE"," ",931],["T_VARIABLE","$klarna_checkout_order_data",931],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",931],"]",")",["T_WHITESPACE"," ",931],["T_BOOLEAN_AND","&&",931],["T_WHITESPACE"," ",931],"(",["T_VARIABLE","$account",931],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",931],"]",["T_WHITESPACE"," ",931],["T_IS_EQUAL","==",931],["T_WHITESPACE"," ",931],["T_VARIABLE","$klarna_checkout_order_data",931],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",931],"]",")",")",["T_WHITESPACE"," ",931],"{",["T_WHITESPACE","\n\t\t\t\t\t",931],["T_VARIABLE","$valid_request",932],["T_WHITESPACE"," ",932],"=",["T_WHITESPACE"," ",932],["T_STRING","true",932],";",["T_WHITESPACE","\n\t\t\t\t\t",932],["T_BREAK","break",933],";",["T_WHITESPACE","\n\t\t\t\t",933],"}",["T_WHITESPACE","\n\t\t\t",934],"}",["T_WHITESPACE","\n\n\t\t\t",935],["T_IF","if",937],["T_WHITESPACE"," ",937],"(","!",["T_VARIABLE","$valid_request",937],")",["T_WHITESPACE"," ",937],"{",["T_WHITESPACE","\n\t\t\t\t",937],["T_VARIABLE","$this",938],["T_OBJECT_OPERATOR","->",938],["T_STRING","model_extension_payment_klarna_checkout",938],["T_OBJECT_OPERATOR","->",938],["T_STRING","log",938],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot validate request. Terminating.'",938],")",";",["T_WHITESPACE","\n\t\t\t\t",938],["T_VARIABLE","$validate",939],["T_WHITESPACE"," ",939],"=",["T_WHITESPACE"," ",939],["T_STRING","false",939],";",["T_WHITESPACE","\n\t\t\t",939],"}",["T_WHITESPACE","\n\t\t",940],"}",["T_WHITESPACE","\n\n\t\t",941],["T_COMMENT","\/\/ Spoof\/simulate the customer to calculate shipping\n",943],["T_WHITESPACE","\t\t",944],["T_IF","if",944],["T_WHITESPACE"," ",944],"(",["T_VARIABLE","$validate",944],")",["T_WHITESPACE"," ",944],"{",["T_WHITESPACE","\n\t\t\t",944],["T_STRING","session_destroy",945],"(",")",";",["T_WHITESPACE","\n\t\t\t",945],["T_STRING","session_id",946],"(",["T_VARIABLE","$klarna_checkout_order_data",946],"[",["T_CONSTANT_ENCAPSED_STRING","'session_id'",946],"]",")",";",["T_WHITESPACE","\n\t\t\t",946],["T_STRING","session_start",947],"(",")",";",["T_WHITESPACE","\n\t\t\t",947],["T_VARIABLE","$this",948],["T_OBJECT_OPERATOR","->",948],["T_STRING","session",948],["T_OBJECT_OPERATOR","->",948],["T_STRING","start",948],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",948],",",["T_WHITESPACE"," ",948],["T_VARIABLE","$klarna_checkout_order_data",948],"[",["T_CONSTANT_ENCAPSED_STRING","'session_key'",948],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",948],["T_IF","if",950],["T_WHITESPACE"," ",950],"(",["T_VARIABLE","$klarna_checkout_order_data",950],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",950],"]",")",["T_WHITESPACE"," ",950],"{",["T_WHITESPACE","\n\t\t\t\t",950],["T_VARIABLE","$customer_info",951],["T_WHITESPACE"," ",951],"=",["T_WHITESPACE"," ",951],["T_VARIABLE","$this",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","model_account_customer",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","getCustomer",951],"(",["T_VARIABLE","$klarna_checkout_order_data",951],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",951],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",951],["T_IF","if",953],["T_WHITESPACE"," ",953],"(",["T_VARIABLE","$customer_info",953],")",["T_WHITESPACE"," ",953],"{",["T_WHITESPACE","\n\t\t\t\t\t",953],["T_VARIABLE","$this",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","customer",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","login",954],"(",["T_VARIABLE","$customer_info",954],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",954],"]",",",["T_WHITESPACE"," ",954],["T_CONSTANT_ENCAPSED_STRING","''",954],",",["T_WHITESPACE"," ",954],["T_STRING","true",954],")",";",["T_WHITESPACE","\n\t\t\t\t",954],"}",["T_WHITESPACE","\n\t\t\t",955],"}",["T_WHITESPACE","\n\n\t\t\t",956],["T_COMMENT","\/\/ Validate cart has products and has stock.\n",958],["T_WHITESPACE","\t\t\t",959],["T_IF","if",959],["T_WHITESPACE"," ",959],"(","(","!",["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","cart",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","hasProducts",959],"(",")",["T_WHITESPACE"," ",959],["T_BOOLEAN_AND","&&",959],["T_WHITESPACE"," ",959],["T_EMPTY","empty",959],"(",["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","session",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","data",959],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",959],"]",")",")",["T_WHITESPACE"," ",959],["T_BOOLEAN_OR","||",959],["T_WHITESPACE"," ",959],"(","!",["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","cart",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","hasStock",959],"(",")",["T_WHITESPACE"," ",959],["T_BOOLEAN_AND","&&",959],["T_WHITESPACE"," ",959],"!",["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","config",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","get",959],"(",["T_CONSTANT_ENCAPSED_STRING","'config_stock_checkout'",959],")",")",")",["T_WHITESPACE"," ",959],"{",["T_WHITESPACE","\n\t\t\t\t",959],["T_VARIABLE","$this",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","model_extension_payment_klarna_checkout",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","log",960],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart has no products or cart has no stock'",960],")",";",["T_WHITESPACE","\n\t\t\t\t",960],["T_VARIABLE","$validate",961],["T_WHITESPACE"," ",961],"=",["T_WHITESPACE"," ",961],["T_STRING","false",961],";",["T_WHITESPACE","\n\t\t\t",961],"}",["T_WHITESPACE","\n\n\t\t\t",962],["T_COMMENT","\/\/ Validate minimum quantity requirements.\n",964],["T_WHITESPACE","\t\t\t",965],["T_VARIABLE","$products",965],["T_WHITESPACE"," ",965],"=",["T_WHITESPACE"," ",965],["T_VARIABLE","$this",965],["T_OBJECT_OPERATOR","->",965],["T_STRING","cart",965],["T_OBJECT_OPERATOR","->",965],["T_STRING","getProducts",965],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",965],["T_FOREACH","foreach",967],["T_WHITESPACE"," ",967],"(",["T_VARIABLE","$products",967],["T_WHITESPACE"," ",967],["T_AS","as",967],["T_WHITESPACE"," ",967],["T_VARIABLE","$product",967],")",["T_WHITESPACE"," ",967],"{",["T_WHITESPACE","\n\t\t\t\t",967],["T_VARIABLE","$product_total",968],["T_WHITESPACE"," ",968],"=",["T_WHITESPACE"," ",968],["T_LNUMBER","0",968],";",["T_WHITESPACE","\n\n\t\t\t\t",968],["T_FOREACH","foreach",970],["T_WHITESPACE"," ",970],"(",["T_VARIABLE","$products",970],["T_WHITESPACE"," ",970],["T_AS","as",970],["T_WHITESPACE"," ",970],["T_VARIABLE","$product_2",970],")",["T_WHITESPACE"," ",970],"{",["T_WHITESPACE","\n\t\t\t\t\t",970],["T_IF","if",971],["T_WHITESPACE"," ",971],"(",["T_VARIABLE","$product_2",971],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",971],"]",["T_WHITESPACE"," ",971],["T_IS_EQUAL","==",971],["T_WHITESPACE"," ",971],["T_VARIABLE","$product",971],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",971],"]",")",["T_WHITESPACE"," ",971],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",971],["T_VARIABLE","$product_total",972],["T_WHITESPACE"," ",972],["T_PLUS_EQUAL","+=",972],["T_WHITESPACE"," ",972],["T_VARIABLE","$product_2",972],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",972],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",972],"}",["T_WHITESPACE","\n\t\t\t\t",973],"}",["T_WHITESPACE","\n\n\t\t\t\t",974],["T_IF","if",976],["T_WHITESPACE"," ",976],"(",["T_VARIABLE","$product",976],"[",["T_CONSTANT_ENCAPSED_STRING","'minimum'",976],"]",["T_WHITESPACE"," ",976],">",["T_WHITESPACE"," ",976],["T_VARIABLE","$product_total",976],")",["T_WHITESPACE"," ",976],"{",["T_WHITESPACE","\n\t\t\t\t\t",976],["T_VARIABLE","$this",977],["T_OBJECT_OPERATOR","->",977],["T_STRING","model_extension_payment_klarna_checkout",977],["T_OBJECT_OPERATOR","->",977],["T_STRING","log",977],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart doesnt meet minimum quantities'",977],")",";",["T_WHITESPACE","\n\t\t\t\t\t",977],["T_VARIABLE","$validate",978],["T_WHITESPACE"," ",978],"=",["T_WHITESPACE"," ",978],["T_STRING","false",978],";",["T_WHITESPACE","\n\t\t\t\t",978],"}",["T_WHITESPACE","\n\t\t\t",979],"}",["T_WHITESPACE","\n\n\t\t\t",980],["T_COMMENT","\/\/ Validate cart has recurring products\n",982],["T_WHITESPACE","\t\t\t",983],["T_IF","if",983],["T_WHITESPACE"," ",983],"(",["T_VARIABLE","$this",983],["T_OBJECT_OPERATOR","->",983],["T_STRING","cart",983],["T_OBJECT_OPERATOR","->",983],["T_STRING","hasRecurringProducts",983],"(",")",")",["T_WHITESPACE"," ",983],"{",["T_WHITESPACE","\n\t\t\t\t",983],["T_VARIABLE","$this",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","model_extension_payment_klarna_checkout",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","log",984],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart has recurring products'",984],")",";",["T_WHITESPACE","\n\t\t\t\t",984],["T_VARIABLE","$validate",985],["T_WHITESPACE"," ",985],"=",["T_WHITESPACE"," ",985],["T_STRING","false",985],";",["T_WHITESPACE","\n\t\t\t",985],"}",["T_WHITESPACE","\n\t\t",986],"}",["T_WHITESPACE","\n\n\t\t",987],["T_COMMENT","\/\/ Check order total to see if session matches post data\n",989],["T_WHITESPACE","\t\t",990],["T_IF","if",990],["T_WHITESPACE"," ",990],"(",["T_VARIABLE","$validate",990],")",["T_WHITESPACE"," ",990],"{",["T_WHITESPACE","\n\t\t\t",990],["T_VARIABLE","$order_info",991],["T_WHITESPACE"," ",991],"=",["T_WHITESPACE"," ",991],["T_VARIABLE","$this",991],["T_OBJECT_OPERATOR","->",991],["T_STRING","model_checkout_order",991],["T_OBJECT_OPERATOR","->",991],["T_STRING","getOrder",991],"(",["T_VARIABLE","$order_id",991],")",";",["T_WHITESPACE","\n\n\t\t\t",991],["T_IF","if",993],["T_WHITESPACE"," ",993],"(",["T_VARIABLE","$order_info",993],")",["T_WHITESPACE"," ",993],"{",["T_WHITESPACE","\n\t\t\t\t",993],["T_COMMENT","\/\/ Unset $tax_rates and set them again using correct shipping data\n",994],["T_WHITESPACE","\t\t\t\t",995],["T_VARIABLE","$this",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","tax",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","unsetRates",995],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",995],["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","tax",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","setShippingAddress",996],"(",["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","session",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","data",996],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",996],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",996],"]",",",["T_WHITESPACE"," ",996],["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","session",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","data",996],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",996],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",996],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",996],["T_VARIABLE","$this",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","tax",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","setStoreAddress",997],"(",["T_VARIABLE","$this",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","config",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","get",997],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",997],")",",",["T_WHITESPACE"," ",997],["T_VARIABLE","$this",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","config",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","get",997],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",997],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",997],["T_LIST","list",999],"(",["T_VARIABLE","$totals",999],",",["T_WHITESPACE"," ",999],["T_VARIABLE","$taxes",999],",",["T_WHITESPACE"," ",999],["T_VARIABLE","$total",999],")",["T_WHITESPACE"," ",999],"=",["T_WHITESPACE"," ",999],["T_VARIABLE","$this",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","model_extension_payment_klarna_checkout",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","getTotals",999],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",999],["T_COMMENT","\/\/ Check order_amount\n",1001],["T_WHITESPACE","\t\t\t\t",1002],["T_IF","if",1002],["T_WHITESPACE"," ",1002],"(",["T_STRING","round",1002],"(",["T_VARIABLE","$this",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","currency",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","format",1002],"(",["T_VARIABLE","$total",1002],",",["T_WHITESPACE"," ",1002],["T_VARIABLE","$order_info",1002],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1002],"]",",",["T_WHITESPACE"," ",1002],["T_VARIABLE","$order_info",1002],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",1002],"]",",",["T_WHITESPACE"," ",1002],["T_STRING","false",1002],")",["T_WHITESPACE"," ",1002],"*",["T_WHITESPACE"," ",1002],["T_LNUMBER","100",1002],")",["T_WHITESPACE"," ",1002],["T_IS_NOT_EQUAL","!=",1002],["T_WHITESPACE"," ",1002],["T_VARIABLE","$request",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","order_amount",1002],")",["T_WHITESPACE"," ",1002],"{",["T_WHITESPACE","\n\t\t\t\t\t",1002],["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","model_extension_payment_klarna_checkout",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","log",1003],"(",["T_CONSTANT_ENCAPSED_STRING","'Klarna Checkout order_amount does not match session order total. Klarna Request: '",1003],["T_WHITESPACE"," ",1003],".",["T_WHITESPACE"," ",1003],["T_VARIABLE","$request",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","order_amount",1003],["T_WHITESPACE"," ",1003],".",["T_WHITESPACE"," ",1003],["T_CONSTANT_ENCAPSED_STRING","'. OpenCart: '",1003],["T_WHITESPACE"," ",1003],".",["T_WHITESPACE"," ",1003],["T_STRING","round",1003],"(",["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","currency",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","format",1003],"(",["T_VARIABLE","$total",1003],",",["T_WHITESPACE"," ",1003],["T_VARIABLE","$order_info",1003],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1003],"]",",",["T_WHITESPACE"," ",1003],["T_VARIABLE","$order_info",1003],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",1003],"]",",",["T_WHITESPACE"," ",1003],["T_STRING","false",1003],")",["T_WHITESPACE"," ",1003],"*",["T_WHITESPACE"," ",1003],["T_LNUMBER","100",1003],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1003],["T_VARIABLE","$this",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","model_extension_payment_klarna_checkout",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","log",1004],"(",["T_VARIABLE","$order_info",1004],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1004],["T_VARIABLE","$this",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","model_extension_payment_klarna_checkout",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","log",1005],"(",["T_VARIABLE","$this",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","cart",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","getTaxes",1005],"(",")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1005],["T_VARIABLE","$validate",1006],["T_WHITESPACE"," ",1006],"=",["T_WHITESPACE"," ",1006],["T_STRING","false",1006],";",["T_WHITESPACE","\n\t\t\t\t",1006],"}",["T_WHITESPACE","\n\n\t\t\t\t",1007],["T_COMMENT","\/\/ Check order_tax_amount\n",1009],["T_WHITESPACE","\t\t\t\t",1010],["T_IF","if",1010],["T_WHITESPACE"," ",1010],"(",["T_STRING","round",1010],"(",["T_VARIABLE","$this",1010],["T_OBJECT_OPERATOR","->",1010],["T_STRING","currency",1010],["T_OBJECT_OPERATOR","->",1010],["T_STRING","format",1010],"(",["T_STRING","array_sum",1010],"(",["T_VARIABLE","$taxes",1010],")",",",["T_WHITESPACE"," ",1010],["T_VARIABLE","$order_info",1010],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1010],"]",",",["T_WHITESPACE"," ",1010],["T_VARIABLE","$order_info",1010],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",1010],"]",",",["T_WHITESPACE"," ",1010],["T_STRING","false",1010],")",["T_WHITESPACE"," ",1010],"*",["T_WHITESPACE"," ",1010],["T_LNUMBER","100",1010],")",["T_WHITESPACE"," ",1010],["T_IS_NOT_EQUAL","!=",1010],["T_WHITESPACE"," ",1010],["T_VARIABLE","$request",1010],["T_OBJECT_OPERATOR","->",1010],["T_STRING","order_tax_amount",1010],")",["T_WHITESPACE"," ",1010],"{",["T_WHITESPACE","\n\t\t\t\t\t",1010],["T_VARIABLE","$this",1011],["T_OBJECT_OPERATOR","->",1011],["T_STRING","model_extension_payment_klarna_checkout",1011],["T_OBJECT_OPERATOR","->",1011],["T_STRING","log",1011],"(",["T_CONSTANT_ENCAPSED_STRING","'Klarna Checkout order_tax_amount does not match session tax total. Totals below:'",1011],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1011],["T_VARIABLE","$this",1012],["T_OBJECT_OPERATOR","->",1012],["T_STRING","model_extension_payment_klarna_checkout",1012],["T_OBJECT_OPERATOR","->",1012],["T_STRING","log",1012],"(",["T_CONSTANT_ENCAPSED_STRING","'Session taxes:'",1012],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1012],["T_VARIABLE","$this",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","model_extension_payment_klarna_checkout",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","log",1013],"(",["T_STRING","round",1013],"(",["T_VARIABLE","$this",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","currency",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","format",1013],"(",["T_STRING","array_sum",1013],"(",["T_VARIABLE","$taxes",1013],")",",",["T_WHITESPACE"," ",1013],["T_VARIABLE","$order_info",1013],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1013],"]",",",["T_WHITESPACE"," ",1013],["T_VARIABLE","$order_info",1013],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",1013],"]",",",["T_WHITESPACE"," ",1013],["T_STRING","false",1013],")",["T_WHITESPACE"," ",1013],"*",["T_WHITESPACE"," ",1013],["T_LNUMBER","100",1013],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1013],["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","model_extension_payment_klarna_checkout",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","log",1014],"(",["T_CONSTANT_ENCAPSED_STRING","'Request taxes:'",1014],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1014],["T_VARIABLE","$this",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","model_extension_payment_klarna_checkout",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","log",1015],"(",["T_VARIABLE","$request",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","order_tax_amount",1015],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1015],["T_VARIABLE","$validate",1016],["T_WHITESPACE"," ",1016],"=",["T_WHITESPACE"," ",1016],["T_STRING","false",1016],";",["T_WHITESPACE","\n\t\t\t\t",1016],"}",["T_WHITESPACE","\n\t\t\t",1017],"}",["T_WHITESPACE"," ",1018],["T_ELSE","else",1018],["T_WHITESPACE"," ",1018],"{",["T_WHITESPACE","\n\t\t\t\t",1018],["T_VARIABLE","$this",1019],["T_OBJECT_OPERATOR","->",1019],["T_STRING","model_extension_payment_klarna_checkout",1019],["T_OBJECT_OPERATOR","->",1019],["T_STRING","log",1019],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot find order using: '",1019],["T_WHITESPACE"," ",1019],".",["T_WHITESPACE"," ",1019],["T_VARIABLE","$order_id",1019],")",";",["T_WHITESPACE","\n\t\t\t\t",1019],["T_VARIABLE","$validate",1020],["T_WHITESPACE"," ",1020],"=",["T_WHITESPACE"," ",1020],["T_STRING","false",1020],";",["T_WHITESPACE","\n\t\t\t",1020],"}",["T_WHITESPACE","\n\t\t",1021],"}",["T_WHITESPACE","\n\n\t\t",1022],["T_COMMENT","\/\/ If validates, add customer's email (if guest checkout) and then send 200 response\n",1024],["T_WHITESPACE","\t\t",1025],["T_IF","if",1025],["T_WHITESPACE"," ",1025],"(",["T_VARIABLE","$validate",1025],")",["T_WHITESPACE"," ",1025],"{",["T_WHITESPACE","\n\t\t\t",1025],["T_IF","if",1026],["T_WHITESPACE"," ",1026],"(","!",["T_VARIABLE","$this",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","customer",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","isLogged",1026],"(",")",")",["T_WHITESPACE"," ",1026],"{",["T_WHITESPACE","\n\t\t\t\t",1026],["T_VARIABLE","$this",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","model_extension_payment_klarna_checkout",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","updateOcOrderEmail",1027],"(",["T_VARIABLE","$order_id",1027],",",["T_WHITESPACE"," ",1027],["T_STRING","utf8_substr",1027],"(",["T_VARIABLE","$request",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","shipping_address",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","email",1027],",",["T_WHITESPACE"," ",1027],["T_LNUMBER","0",1027],",",["T_WHITESPACE"," ",1027],["T_LNUMBER","96",1027],")",")",";",["T_WHITESPACE","\n\t\t\t",1027],"}",["T_WHITESPACE","\n\n\t\t\t",1028],["T_COMMENT","\/\/ Update OpenCart order with payment and shipping details\n",1030],["T_WHITESPACE","\t\t\t",1031],["T_VARIABLE","$payment_country_info",1031],["T_WHITESPACE"," ",1031],"=",["T_WHITESPACE"," ",1031],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","model_extension_payment_klarna_checkout",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","getCountryByIsoCode2",1031],"(",["T_VARIABLE","$request",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","billing_address",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","country",1031],")",";",["T_WHITESPACE","\n\t\t\t",1031],["T_VARIABLE","$shipping_country_info",1032],["T_WHITESPACE"," ",1032],"=",["T_WHITESPACE"," ",1032],["T_VARIABLE","$this",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","model_extension_payment_klarna_checkout",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","getCountryByIsoCode2",1032],"(",["T_VARIABLE","$request",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","shipping_address",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","country",1032],")",";",["T_WHITESPACE","\n\n\t\t\t",1032],["T_COMMENT","\/\/If region is passed, try to update OpenCart order with correct region\/zone\n",1034],["T_WHITESPACE","\t\t\t",1035],["T_VARIABLE","$payment_zone_info",1035],["T_WHITESPACE"," ",1035],"=",["T_WHITESPACE"," ",1035],["T_ARRAY","array",1035],"(",")",";",["T_WHITESPACE","\n\t\t\t",1035],["T_IF","if",1036],["T_WHITESPACE"," ",1036],"(",["T_VARIABLE","$payment_country_info",1036],["T_WHITESPACE"," ",1036],["T_BOOLEAN_AND","&&",1036],["T_WHITESPACE"," ",1036],["T_ISSET","isset",1036],"(",["T_VARIABLE","$request",1036],["T_OBJECT_OPERATOR","->",1036],["T_STRING","billing_address",1036],["T_OBJECT_OPERATOR","->",1036],["T_STRING","region",1036],")",")",["T_WHITESPACE"," ",1036],"{",["T_WHITESPACE","\n\t\t\t\t",1036],["T_VARIABLE","$payment_zone_info",1037],["T_WHITESPACE"," ",1037],"=",["T_WHITESPACE"," ",1037],["T_VARIABLE","$this",1037],["T_OBJECT_OPERATOR","->",1037],["T_STRING","model_extension_payment_klarna_checkout",1037],["T_OBJECT_OPERATOR","->",1037],["T_STRING","getZoneByCode",1037],"(",["T_VARIABLE","$request",1037],["T_OBJECT_OPERATOR","->",1037],["T_STRING","billing_address",1037],["T_OBJECT_OPERATOR","->",1037],["T_STRING","region",1037],",",["T_WHITESPACE"," ",1037],["T_VARIABLE","$payment_country_info",1037],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1037],"]",")",";",["T_WHITESPACE","\n\t\t\t",1037],"}",["T_WHITESPACE","\n\n\t\t\t",1038],["T_VARIABLE","$shipping_zone_info",1040],["T_WHITESPACE"," ",1040],"=",["T_WHITESPACE"," ",1040],["T_ARRAY","array",1040],"(",")",";",["T_WHITESPACE","\n\t\t\t",1040],["T_IF","if",1041],["T_WHITESPACE"," ",1041],"(",["T_VARIABLE","$shipping_country_info",1041],["T_WHITESPACE"," ",1041],["T_BOOLEAN_AND","&&",1041],["T_WHITESPACE"," ",1041],["T_ISSET","isset",1041],"(",["T_VARIABLE","$request",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","shipping_address",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","region",1041],")",")",["T_WHITESPACE"," ",1041],"{",["T_WHITESPACE","\n\t\t\t\t",1041],["T_VARIABLE","$shipping_zone_info",1042],["T_WHITESPACE"," ",1042],"=",["T_WHITESPACE"," ",1042],["T_VARIABLE","$this",1042],["T_OBJECT_OPERATOR","->",1042],["T_STRING","model_extension_payment_klarna_checkout",1042],["T_OBJECT_OPERATOR","->",1042],["T_STRING","getZoneByCode",1042],"(",["T_VARIABLE","$request",1042],["T_OBJECT_OPERATOR","->",1042],["T_STRING","shipping_address",1042],["T_OBJECT_OPERATOR","->",1042],["T_STRING","region",1042],",",["T_WHITESPACE"," ",1042],["T_VARIABLE","$shipping_country_info",1042],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1042],"]",")",";",["T_WHITESPACE","\n\t\t\t",1042],"}",["T_WHITESPACE","\n\n\t\t\t",1043],["T_VARIABLE","$order_data",1045],["T_WHITESPACE"," ",1045],"=",["T_WHITESPACE"," ",1045],["T_ARRAY","array",1045],"(",["T_WHITESPACE","\n\t\t\t\t",1045],["T_CONSTANT_ENCAPSED_STRING","'firstname'",1046],["T_WHITESPACE","\t\t\t\t  ",1046],["T_DOUBLE_ARROW","=>",1046],["T_WHITESPACE"," ",1046],["T_STRING","utf8_substr",1046],"(",["T_VARIABLE","$request",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","billing_address",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","given_name",1046],",",["T_WHITESPACE"," ",1046],["T_LNUMBER","0",1046],",",["T_WHITESPACE"," ",1046],["T_LNUMBER","32",1046],")",",",["T_WHITESPACE","\n\t\t\t\t",1046],["T_CONSTANT_ENCAPSED_STRING","'lastname'",1047],["T_WHITESPACE","\t\t\t\t  ",1047],["T_DOUBLE_ARROW","=>",1047],["T_WHITESPACE"," ",1047],["T_STRING","utf8_substr",1047],"(",["T_VARIABLE","$request",1047],["T_OBJECT_OPERATOR","->",1047],["T_STRING","billing_address",1047],["T_OBJECT_OPERATOR","->",1047],["T_STRING","family_name",1047],",",["T_WHITESPACE"," ",1047],["T_LNUMBER","0",1047],",",["T_WHITESPACE"," ",1047],["T_LNUMBER","32",1047],")",",",["T_WHITESPACE","\n\t\t\t\t",1047],["T_CONSTANT_ENCAPSED_STRING","'telephone'",1048],["T_WHITESPACE","\t\t\t\t  ",1048],["T_DOUBLE_ARROW","=>",1048],["T_WHITESPACE"," ",1048],["T_STRING","utf8_substr",1048],"(",["T_VARIABLE","$request",1048],["T_OBJECT_OPERATOR","->",1048],["T_STRING","billing_address",1048],["T_OBJECT_OPERATOR","->",1048],["T_STRING","phone",1048],",",["T_WHITESPACE"," ",1048],["T_LNUMBER","0",1048],",",["T_WHITESPACE"," ",1048],["T_LNUMBER","32",1048],")",",",["T_WHITESPACE","\n\t\t\t\t",1048],["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",1049],["T_WHITESPACE","\t\t  ",1049],["T_DOUBLE_ARROW","=>",1049],["T_WHITESPACE"," ",1049],["T_STRING","utf8_substr",1049],"(",["T_VARIABLE","$request",1049],["T_OBJECT_OPERATOR","->",1049],["T_STRING","billing_address",1049],["T_OBJECT_OPERATOR","->",1049],["T_STRING","given_name",1049],",",["T_WHITESPACE"," ",1049],["T_LNUMBER","0",1049],",",["T_WHITESPACE"," ",1049],["T_LNUMBER","32",1049],")",",",["T_WHITESPACE","\n\t\t\t\t",1049],["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",1050],["T_WHITESPACE","\t\t  ",1050],["T_DOUBLE_ARROW","=>",1050],["T_WHITESPACE"," ",1050],["T_STRING","utf8_substr",1050],"(",["T_VARIABLE","$request",1050],["T_OBJECT_OPERATOR","->",1050],["T_STRING","billing_address",1050],["T_OBJECT_OPERATOR","->",1050],["T_STRING","family_name",1050],",",["T_WHITESPACE"," ",1050],["T_LNUMBER","0",1050],",",["T_WHITESPACE"," ",1050],["T_LNUMBER","32",1050],")",",",["T_WHITESPACE","\n\t\t\t\t",1050],["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",1051],["T_WHITESPACE","\t\t  ",1051],["T_DOUBLE_ARROW","=>",1051],["T_WHITESPACE"," ",1051],["T_STRING","utf8_substr",1051],"(",["T_VARIABLE","$request",1051],["T_OBJECT_OPERATOR","->",1051],["T_STRING","billing_address",1051],["T_OBJECT_OPERATOR","->",1051],["T_STRING","street_address",1051],",",["T_WHITESPACE"," ",1051],["T_LNUMBER","0",1051],",",["T_WHITESPACE"," ",1051],["T_LNUMBER","128",1051],")",",",["T_WHITESPACE","\n\t\t\t\t",1051],["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",1052],["T_WHITESPACE","\t\t  ",1052],["T_DOUBLE_ARROW","=>",1052],["T_WHITESPACE"," ",1052],"(",["T_ISSET","isset",1052],"(",["T_VARIABLE","$request",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","billing_address",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","street_address2",1052],")",["T_WHITESPACE"," ",1052],"?",["T_WHITESPACE"," ",1052],["T_STRING","utf8_substr",1052],"(",["T_VARIABLE","$request",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","billing_address",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","street_address2",1052],",",["T_WHITESPACE"," ",1052],["T_LNUMBER","0",1052],",",["T_WHITESPACE"," ",1052],["T_LNUMBER","128",1052],")",["T_WHITESPACE"," ",1052],":",["T_WHITESPACE"," ",1052],["T_CONSTANT_ENCAPSED_STRING","''",1052],")",",",["T_WHITESPACE","\n\t\t\t\t",1052],["T_CONSTANT_ENCAPSED_STRING","'payment_city'",1053],["T_WHITESPACE","\t\t\t  ",1053],["T_DOUBLE_ARROW","=>",1053],["T_WHITESPACE"," ",1053],["T_STRING","utf8_substr",1053],"(",["T_VARIABLE","$request",1053],["T_OBJECT_OPERATOR","->",1053],["T_STRING","billing_address",1053],["T_OBJECT_OPERATOR","->",1053],["T_STRING","city",1053],",",["T_WHITESPACE"," ",1053],["T_LNUMBER","0",1053],",",["T_WHITESPACE"," ",1053],["T_LNUMBER","128",1053],")",",",["T_WHITESPACE","\n\t\t\t\t",1053],["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",1054],["T_WHITESPACE","\t\t  ",1054],["T_DOUBLE_ARROW","=>",1054],["T_WHITESPACE"," ",1054],["T_STRING","utf8_substr",1054],"(",["T_VARIABLE","$request",1054],["T_OBJECT_OPERATOR","->",1054],["T_STRING","billing_address",1054],["T_OBJECT_OPERATOR","->",1054],["T_STRING","postal_code",1054],",",["T_WHITESPACE"," ",1054],["T_LNUMBER","0",1054],",",["T_WHITESPACE"," ",1054],["T_LNUMBER","10",1054],")",",",["T_WHITESPACE","\n\t\t\t\t",1054],["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",1055],["T_WHITESPACE","\t\t\t  ",1055],["T_DOUBLE_ARROW","=>",1055],["T_WHITESPACE"," ",1055],"(",["T_VARIABLE","$payment_zone_info",1055],["T_WHITESPACE"," ",1055],"?",["T_WHITESPACE"," ",1055],["T_VARIABLE","$payment_zone_info",1055],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1055],"]",["T_WHITESPACE"," ",1055],":",["T_WHITESPACE"," ",1055],["T_CONSTANT_ENCAPSED_STRING","''",1055],")",",",["T_WHITESPACE","\n\t\t\t\t",1055],["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",1056],["T_WHITESPACE","\t\t  ",1056],["T_DOUBLE_ARROW","=>",1056],["T_WHITESPACE"," ",1056],"(",["T_VARIABLE","$payment_zone_info",1056],["T_WHITESPACE"," ",1056],"?",["T_WHITESPACE"," ",1056],["T_VARIABLE","$payment_zone_info",1056],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1056],"]",["T_WHITESPACE"," ",1056],":",["T_WHITESPACE"," ",1056],["T_CONSTANT_ENCAPSED_STRING","''",1056],")",",",["T_WHITESPACE","\n\t\t\t\t",1056],["T_CONSTANT_ENCAPSED_STRING","'payment_country'",1057],["T_WHITESPACE","\t\t  ",1057],["T_DOUBLE_ARROW","=>",1057],["T_WHITESPACE"," ",1057],"(",["T_VARIABLE","$payment_country_info",1057],["T_WHITESPACE"," ",1057],"?",["T_WHITESPACE"," ",1057],["T_VARIABLE","$payment_country_info",1057],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1057],"]",["T_WHITESPACE"," ",1057],":",["T_WHITESPACE"," ",1057],["T_CONSTANT_ENCAPSED_STRING","''",1057],")",",",["T_WHITESPACE","\n\t\t\t\t",1057],["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",1058],["T_WHITESPACE","\t  ",1058],["T_DOUBLE_ARROW","=>",1058],["T_WHITESPACE"," ",1058],"(",["T_VARIABLE","$payment_country_info",1058],["T_WHITESPACE"," ",1058],"?",["T_WHITESPACE"," ",1058],["T_VARIABLE","$payment_country_info",1058],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1058],"]",["T_WHITESPACE"," ",1058],":",["T_WHITESPACE"," ",1058],["T_CONSTANT_ENCAPSED_STRING","''",1058],")",",",["T_WHITESPACE","\n\t\t\t\t",1058],["T_CONSTANT_ENCAPSED_STRING","'payment_address_format'",1059],["T_WHITESPACE","  ",1059],["T_DOUBLE_ARROW","=>",1059],["T_WHITESPACE"," ",1059],"(",["T_VARIABLE","$payment_country_info",1059],["T_WHITESPACE"," ",1059],"?",["T_WHITESPACE"," ",1059],["T_VARIABLE","$payment_country_info",1059],"[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",1059],"]",["T_WHITESPACE"," ",1059],":",["T_WHITESPACE"," ",1059],["T_CONSTANT_ENCAPSED_STRING","''",1059],")",",",["T_WHITESPACE","\n\t\t\t\t",1059],["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",1060],["T_WHITESPACE","\t  ",1060],["T_DOUBLE_ARROW","=>",1060],["T_WHITESPACE"," ",1060],["T_STRING","utf8_substr",1060],"(",["T_VARIABLE","$request",1060],["T_OBJECT_OPERATOR","->",1060],["T_STRING","shipping_address",1060],["T_OBJECT_OPERATOR","->",1060],["T_STRING","given_name",1060],",",["T_WHITESPACE"," ",1060],["T_LNUMBER","0",1060],",",["T_WHITESPACE"," ",1060],["T_LNUMBER","32",1060],")",",",["T_WHITESPACE","\n\t\t\t\t",1060],["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",1061],["T_WHITESPACE","\t\t  ",1061],["T_DOUBLE_ARROW","=>",1061],["T_WHITESPACE"," ",1061],["T_STRING","utf8_substr",1061],"(",["T_VARIABLE","$request",1061],["T_OBJECT_OPERATOR","->",1061],["T_STRING","shipping_address",1061],["T_OBJECT_OPERATOR","->",1061],["T_STRING","family_name",1061],",",["T_WHITESPACE"," ",1061],["T_LNUMBER","0",1061],",",["T_WHITESPACE"," ",1061],["T_LNUMBER","32",1061],")",",",["T_WHITESPACE","\n\t\t\t\t",1061],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",1062],["T_WHITESPACE","\t  ",1062],["T_DOUBLE_ARROW","=>",1062],["T_WHITESPACE"," ",1062],["T_STRING","utf8_substr",1062],"(",["T_VARIABLE","$request",1062],["T_OBJECT_OPERATOR","->",1062],["T_STRING","shipping_address",1062],["T_OBJECT_OPERATOR","->",1062],["T_STRING","street_address",1062],",",["T_WHITESPACE"," ",1062],["T_LNUMBER","0",1062],",",["T_WHITESPACE"," ",1062],["T_LNUMBER","128",1062],")",",",["T_WHITESPACE","\n\t\t\t\t",1062],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",1063],["T_WHITESPACE","\t  ",1063],["T_DOUBLE_ARROW","=>",1063],["T_WHITESPACE"," ",1063],"(",["T_ISSET","isset",1063],"(",["T_VARIABLE","$request",1063],["T_OBJECT_OPERATOR","->",1063],["T_STRING","shipping_address",1063],["T_OBJECT_OPERATOR","->",1063],["T_STRING","street_address2",1063],")",["T_WHITESPACE"," ",1063],"?",["T_WHITESPACE"," ",1063],["T_STRING","utf8_substr",1063],"(",["T_VARIABLE","$request",1063],["T_OBJECT_OPERATOR","->",1063],["T_STRING","shipping_address",1063],["T_OBJECT_OPERATOR","->",1063],["T_STRING","street_address2",1063],",",["T_WHITESPACE"," ",1063],["T_LNUMBER","0",1063],",",["T_WHITESPACE"," ",1063],["T_LNUMBER","128",1063],")",["T_WHITESPACE"," ",1063],":",["T_WHITESPACE"," ",1063],["T_CONSTANT_ENCAPSED_STRING","''",1063],")",",",["T_WHITESPACE","\n\t\t\t\t",1063],["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",1064],["T_WHITESPACE","\t\t\t  ",1064],["T_DOUBLE_ARROW","=>",1064],["T_WHITESPACE"," ",1064],["T_STRING","utf8_substr",1064],"(",["T_VARIABLE","$request",1064],["T_OBJECT_OPERATOR","->",1064],["T_STRING","shipping_address",1064],["T_OBJECT_OPERATOR","->",1064],["T_STRING","city",1064],",",["T_WHITESPACE"," ",1064],["T_LNUMBER","0",1064],",",["T_WHITESPACE"," ",1064],["T_LNUMBER","128",1064],")",",",["T_WHITESPACE","\n\t\t\t\t",1064],["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",1065],["T_WHITESPACE","\t\t  ",1065],["T_DOUBLE_ARROW","=>",1065],["T_WHITESPACE"," ",1065],["T_STRING","utf8_substr",1065],"(",["T_VARIABLE","$request",1065],["T_OBJECT_OPERATOR","->",1065],["T_STRING","shipping_address",1065],["T_OBJECT_OPERATOR","->",1065],["T_STRING","postal_code",1065],",",["T_WHITESPACE"," ",1065],["T_LNUMBER","0",1065],",",["T_WHITESPACE"," ",1065],["T_LNUMBER","10",1065],")",",",["T_WHITESPACE","\n\t\t\t\t",1065],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",1066],["T_WHITESPACE","\t\t\t  ",1066],["T_DOUBLE_ARROW","=>",1066],["T_WHITESPACE"," ",1066],"(",["T_VARIABLE","$shipping_zone_info",1066],["T_WHITESPACE"," ",1066],"?",["T_WHITESPACE"," ",1066],["T_VARIABLE","$shipping_zone_info",1066],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1066],"]",["T_WHITESPACE"," ",1066],":",["T_WHITESPACE"," ",1066],["T_CONSTANT_ENCAPSED_STRING","''",1066],")",",",["T_WHITESPACE","\n\t\t\t\t",1066],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",1067],["T_WHITESPACE","\t\t  ",1067],["T_DOUBLE_ARROW","=>",1067],["T_WHITESPACE"," ",1067],"(",["T_VARIABLE","$shipping_zone_info",1067],["T_WHITESPACE"," ",1067],"?",["T_WHITESPACE"," ",1067],["T_VARIABLE","$shipping_zone_info",1067],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1067],"]",["T_WHITESPACE"," ",1067],":",["T_WHITESPACE"," ",1067],["T_CONSTANT_ENCAPSED_STRING","''",1067],")",",",["T_WHITESPACE","\n\t\t\t\t",1067],["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",1068],["T_WHITESPACE","\t\t  ",1068],["T_DOUBLE_ARROW","=>",1068],["T_WHITESPACE"," ",1068],"(",["T_VARIABLE","$shipping_country_info",1068],["T_WHITESPACE"," ",1068],"?",["T_WHITESPACE"," ",1068],["T_VARIABLE","$shipping_country_info",1068],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1068],"]",["T_WHITESPACE"," ",1068],":",["T_WHITESPACE"," ",1068],["T_CONSTANT_ENCAPSED_STRING","''",1068],")",",",["T_WHITESPACE","\n\t\t\t\t",1068],["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",1069],["T_WHITESPACE","\t  ",1069],["T_DOUBLE_ARROW","=>",1069],["T_WHITESPACE"," ",1069],"(",["T_VARIABLE","$shipping_country_info",1069],["T_WHITESPACE"," ",1069],"?",["T_WHITESPACE"," ",1069],["T_VARIABLE","$shipping_country_info",1069],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1069],"]",["T_WHITESPACE"," ",1069],":",["T_WHITESPACE"," ",1069],["T_CONSTANT_ENCAPSED_STRING","''",1069],")",",",["T_WHITESPACE","\n\t\t\t\t",1069],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",1070],["T_WHITESPACE"," ",1070],["T_DOUBLE_ARROW","=>",1070],["T_WHITESPACE"," ",1070],"(",["T_VARIABLE","$shipping_country_info",1070],["T_WHITESPACE"," ",1070],"?",["T_WHITESPACE"," ",1070],["T_VARIABLE","$shipping_country_info",1070],"[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",1070],"]",["T_WHITESPACE"," ",1070],":",["T_WHITESPACE"," ",1070],["T_CONSTANT_ENCAPSED_STRING","''",1070],")",["T_WHITESPACE","\n\t\t\t",1070],")",";",["T_WHITESPACE","\n\n\t\t\t",1071],["T_VARIABLE","$this",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","model_extension_payment_klarna_checkout",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","updateOcOrder",1073],"(",["T_VARIABLE","$order_id",1073],",",["T_WHITESPACE"," ",1073],["T_VARIABLE","$order_data",1073],")",";",["T_WHITESPACE","\n\n\t\t\t",1073],["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","model_checkout_order",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","addOrderHistory",1075],"(",["T_VARIABLE","$order_id",1075],",",["T_WHITESPACE"," ",1075],["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","config",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","get",1075],"(",["T_CONSTANT_ENCAPSED_STRING","'config_order_status_id'",1075],")",")",";",["T_WHITESPACE","\n\n\t\t\t",1075],["T_STRING","http_response_code",1077],"(",["T_LNUMBER","200",1077],")",";",["T_WHITESPACE","\n\t\t",1077],"}",["T_WHITESPACE"," ",1078],["T_ELSE","else",1078],["T_WHITESPACE"," ",1078],"{",["T_WHITESPACE","\n\t\t\t",1078],["T_STRING","http_response_code",1079],"(",["T_LNUMBER","303",1079],")",";",["T_WHITESPACE","\n\t\t\t",1079],["T_VARIABLE","$this",1080],["T_OBJECT_OPERATOR","->",1080],["T_STRING","response",1080],["T_OBJECT_OPERATOR","->",1080],["T_STRING","addHeader",1080],"(",["T_CONSTANT_ENCAPSED_STRING","'Location: '",1080],["T_WHITESPACE"," ",1080],".",["T_WHITESPACE"," ",1080],["T_VARIABLE","$this",1080],["T_OBJECT_OPERATOR","->",1080],["T_STRING","url",1080],["T_OBJECT_OPERATOR","->",1080],["T_STRING","link",1080],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/failure'",1080],",",["T_WHITESPACE"," ",1080],["T_CONSTANT_ENCAPSED_STRING","''",1080],",",["T_WHITESPACE"," ",1080],["T_STRING","true",1080],")",")",";",["T_WHITESPACE","\n\t\t",1080],"}",["T_WHITESPACE","\n\n\t\t",1081],["T_VARIABLE","$this",1083],["T_OBJECT_OPERATOR","->",1083],["T_STRING","response",1083],["T_OBJECT_OPERATOR","->",1083],["T_STRING","addHeader",1083],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: application\/json'",1083],")",";",["T_WHITESPACE","\n\t\t",1083],["T_VARIABLE","$this",1084],["T_OBJECT_OPERATOR","->",1084],["T_STRING","response",1084],["T_OBJECT_OPERATOR","->",1084],["T_STRING","setOutput",1084],"(",["T_STRING","json_encode",1084],"(",["T_VARIABLE","$json",1084],")",")",";",["T_WHITESPACE","\n\t",1084],"}",["T_WHITESPACE","\n\n\t",1085],["T_PUBLIC","public",1087],["T_WHITESPACE"," ",1087],["T_FUNCTION","function",1087],["T_WHITESPACE"," ",1087],["T_STRING","confirmation",1087],"(",")",["T_WHITESPACE"," ",1087],"{",["T_WHITESPACE","\n\t\t",1087],["T_VARIABLE","$this",1088],["T_OBJECT_OPERATOR","->",1088],["T_STRING","load",1088],["T_OBJECT_OPERATOR","->",1088],["T_STRING","language",1088],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",1088],")",";",["T_WHITESPACE","\n\n\t\t",1088],["T_IF","if",1090],["T_WHITESPACE"," ",1090],"(","!",["T_VARIABLE","$this",1090],["T_OBJECT_OPERATOR","->",1090],["T_STRING","config",1090],["T_OBJECT_OPERATOR","->",1090],["T_STRING","get",1090],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",1090],")",")",["T_WHITESPACE"," ",1090],"{",["T_WHITESPACE","\n\t\t\t",1090],["T_RETURN","return",1091],["T_WHITESPACE"," ",1091],["T_STRING","false",1091],";",["T_WHITESPACE","\n\t\t",1091],"}",["T_WHITESPACE","\n\n\t\t",1092],["T_IF","if",1094],["T_WHITESPACE"," ",1094],"(",["T_ISSET","isset",1094],"(",["T_VARIABLE","$this",1094],["T_OBJECT_OPERATOR","->",1094],["T_STRING","session",1094],["T_OBJECT_OPERATOR","->",1094],["T_STRING","data",1094],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1094],"]",")",")",["T_WHITESPACE"," ",1094],"{",["T_WHITESPACE","\n\t\t\t",1094],["T_VARIABLE","$this",1095],["T_OBJECT_OPERATOR","->",1095],["T_STRING","cart",1095],["T_OBJECT_OPERATOR","->",1095],["T_STRING","clear",1095],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",1095],["T_COMMENT","\/\/ Add to activity log\n",1097],["T_WHITESPACE","\t\t\t",1098],["T_IF","if",1098],["T_WHITESPACE"," ",1098],"(",["T_VARIABLE","$this",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","config",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","get",1098],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_activity'",1098],")",")",["T_WHITESPACE"," ",1098],"{",["T_WHITESPACE","\n\t\t\t\t",1098],["T_VARIABLE","$this",1099],["T_OBJECT_OPERATOR","->",1099],["T_STRING","load",1099],["T_OBJECT_OPERATOR","->",1099],["T_STRING","model",1099],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/activity'",1099],")",";",["T_WHITESPACE","\n\n\t\t\t\t",1099],["T_IF","if",1101],["T_WHITESPACE"," ",1101],"(",["T_VARIABLE","$this",1101],["T_OBJECT_OPERATOR","->",1101],["T_STRING","customer",1101],["T_OBJECT_OPERATOR","->",1101],["T_STRING","isLogged",1101],"(",")",")",["T_WHITESPACE"," ",1101],"{",["T_WHITESPACE","\n\t\t\t\t\t",1101],["T_VARIABLE","$activity_data",1102],["T_WHITESPACE"," ",1102],"=",["T_WHITESPACE"," ",1102],["T_ARRAY","array",1102],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",1102],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",1103],["T_WHITESPACE"," ",1103],["T_DOUBLE_ARROW","=>",1103],["T_WHITESPACE"," ",1103],["T_VARIABLE","$this",1103],["T_OBJECT_OPERATOR","->",1103],["T_STRING","customer",1103],["T_OBJECT_OPERATOR","->",1103],["T_STRING","getId",1103],"(",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",1103],["T_CONSTANT_ENCAPSED_STRING","'name'",1104],["T_WHITESPACE","        ",1104],["T_DOUBLE_ARROW","=>",1104],["T_WHITESPACE"," ",1104],["T_VARIABLE","$this",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","customer",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","getFirstName",1104],"(",")",["T_WHITESPACE"," ",1104],".",["T_WHITESPACE"," ",1104],["T_CONSTANT_ENCAPSED_STRING","' '",1104],["T_WHITESPACE"," ",1104],".",["T_WHITESPACE"," ",1104],["T_VARIABLE","$this",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","customer",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","getLastName",1104],"(",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",1104],["T_CONSTANT_ENCAPSED_STRING","'order_id'",1105],["T_WHITESPACE","    ",1105],["T_DOUBLE_ARROW","=>",1105],["T_WHITESPACE"," ",1105],["T_VARIABLE","$this",1105],["T_OBJECT_OPERATOR","->",1105],["T_STRING","session",1105],["T_OBJECT_OPERATOR","->",1105],["T_STRING","data",1105],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1105],"]",["T_WHITESPACE","\n\t\t\t\t\t",1105],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1106],["T_VARIABLE","$this",1108],["T_OBJECT_OPERATOR","->",1108],["T_STRING","model_account_activity",1108],["T_OBJECT_OPERATOR","->",1108],["T_STRING","addActivity",1108],"(",["T_CONSTANT_ENCAPSED_STRING","'order_account'",1108],",",["T_WHITESPACE"," ",1108],["T_VARIABLE","$activity_data",1108],")",";",["T_WHITESPACE","\n\t\t\t\t",1108],"}",["T_WHITESPACE"," ",1109],["T_ELSE","else",1109],["T_WHITESPACE"," ",1109],"{",["T_WHITESPACE","\n\t\t\t\t\t",1109],["T_VARIABLE","$activity_data",1110],["T_WHITESPACE"," ",1110],"=",["T_WHITESPACE"," ",1110],["T_ARRAY","array",1110],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",1110],["T_CONSTANT_ENCAPSED_STRING","'name'",1111],["T_WHITESPACE","     ",1111],["T_DOUBLE_ARROW","=>",1111],["T_WHITESPACE"," ",1111],["T_VARIABLE","$this",1111],["T_OBJECT_OPERATOR","->",1111],["T_STRING","session",1111],["T_OBJECT_OPERATOR","->",1111],["T_STRING","data",1111],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1111],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1111],"]",["T_WHITESPACE"," ",1111],".",["T_WHITESPACE"," ",1111],["T_CONSTANT_ENCAPSED_STRING","' '",1111],["T_WHITESPACE"," ",1111],".",["T_WHITESPACE"," ",1111],["T_VARIABLE","$this",1111],["T_OBJECT_OPERATOR","->",1111],["T_STRING","session",1111],["T_OBJECT_OPERATOR","->",1111],["T_STRING","data",1111],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1111],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1111],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",1111],["T_CONSTANT_ENCAPSED_STRING","'order_id'",1112],["T_WHITESPACE"," ",1112],["T_DOUBLE_ARROW","=>",1112],["T_WHITESPACE"," ",1112],["T_VARIABLE","$this",1112],["T_OBJECT_OPERATOR","->",1112],["T_STRING","session",1112],["T_OBJECT_OPERATOR","->",1112],["T_STRING","data",1112],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1112],"]",["T_WHITESPACE","\n\t\t\t\t\t",1112],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1113],["T_VARIABLE","$this",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","model_account_activity",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","addActivity",1115],"(",["T_CONSTANT_ENCAPSED_STRING","'order_guest'",1115],",",["T_WHITESPACE"," ",1115],["T_VARIABLE","$activity_data",1115],")",";",["T_WHITESPACE","\n\t\t\t\t",1115],"}",["T_WHITESPACE","\n\t\t\t",1116],"}",["T_WHITESPACE","\n\n\t\t\t",1117],["T_UNSET","unset",1119],"(",["T_VARIABLE","$this",1119],["T_OBJECT_OPERATOR","->",1119],["T_STRING","session",1119],["T_OBJECT_OPERATOR","->",1119],["T_STRING","data",1119],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1119],"]",")",";",["T_WHITESPACE","\n\t\t\t",1119],["T_UNSET","unset",1120],"(",["T_VARIABLE","$this",1120],["T_OBJECT_OPERATOR","->",1120],["T_STRING","session",1120],["T_OBJECT_OPERATOR","->",1120],["T_STRING","data",1120],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1120],"]",")",";",["T_WHITESPACE","\n\t\t\t",1120],["T_UNSET","unset",1121],"(",["T_VARIABLE","$this",1121],["T_OBJECT_OPERATOR","->",1121],["T_STRING","session",1121],["T_OBJECT_OPERATOR","->",1121],["T_STRING","data",1121],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1121],"]",")",";",["T_WHITESPACE","\n\t\t\t",1121],["T_UNSET","unset",1122],"(",["T_VARIABLE","$this",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","session",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","data",1122],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_methods'",1122],"]",")",";",["T_WHITESPACE","\n\t\t\t",1122],["T_UNSET","unset",1123],"(",["T_VARIABLE","$this",1123],["T_OBJECT_OPERATOR","->",1123],["T_STRING","session",1123],["T_OBJECT_OPERATOR","->",1123],["T_STRING","data",1123],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1123],"]",")",";",["T_WHITESPACE","\n\t\t\t",1123],["T_UNSET","unset",1124],"(",["T_VARIABLE","$this",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","session",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","data",1124],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",1124],"]",")",";",["T_WHITESPACE","\n\t\t\t",1124],["T_UNSET","unset",1125],"(",["T_VARIABLE","$this",1125],["T_OBJECT_OPERATOR","->",1125],["T_STRING","session",1125],["T_OBJECT_OPERATOR","->",1125],["T_STRING","data",1125],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1125],"]",")",";",["T_WHITESPACE","\n\t\t\t",1125],["T_UNSET","unset",1126],"(",["T_VARIABLE","$this",1126],["T_OBJECT_OPERATOR","->",1126],["T_STRING","session",1126],["T_OBJECT_OPERATOR","->",1126],["T_STRING","data",1126],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon'",1126],"]",")",";",["T_WHITESPACE","\n\t\t\t",1126],["T_UNSET","unset",1127],"(",["T_VARIABLE","$this",1127],["T_OBJECT_OPERATOR","->",1127],["T_STRING","session",1127],["T_OBJECT_OPERATOR","->",1127],["T_STRING","data",1127],"[",["T_CONSTANT_ENCAPSED_STRING","'reward'",1127],"]",")",";",["T_WHITESPACE","\n\t\t\t",1127],["T_UNSET","unset",1128],"(",["T_VARIABLE","$this",1128],["T_OBJECT_OPERATOR","->",1128],["T_STRING","session",1128],["T_OBJECT_OPERATOR","->",1128],["T_STRING","data",1128],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher'",1128],"]",")",";",["T_WHITESPACE","\n\t\t\t",1128],["T_UNSET","unset",1129],"(",["T_VARIABLE","$this",1129],["T_OBJECT_OPERATOR","->",1129],["T_STRING","session",1129],["T_OBJECT_OPERATOR","->",1129],["T_STRING","data",1129],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1129],"]",")",";",["T_WHITESPACE","\n\t\t\t",1129],["T_UNSET","unset",1130],"(",["T_VARIABLE","$this",1130],["T_OBJECT_OPERATOR","->",1130],["T_STRING","session",1130],["T_OBJECT_OPERATOR","->",1130],["T_STRING","data",1130],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",1130],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",1130],["T_UNSET","unset",1132],"(",["T_VARIABLE","$this",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","session",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","data",1132],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_id'",1132],"]",")",";",["T_WHITESPACE","\n\t\t\t",1132],["T_UNSET","unset",1133],"(",["T_VARIABLE","$this",1133],["T_OBJECT_OPERATOR","->",1133],["T_STRING","session",1133],["T_OBJECT_OPERATOR","->",1133],["T_STRING","data",1133],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",1133],"]",")",";",["T_WHITESPACE","\n\t\t",1133],"}",["T_WHITESPACE","\n\n\t\t",1134],["T_VARIABLE","$this",1136],["T_OBJECT_OPERATOR","->",1136],["T_STRING","document",1136],["T_OBJECT_OPERATOR","->",1136],["T_STRING","setTitle",1136],"(",["T_VARIABLE","$this",1136],["T_OBJECT_OPERATOR","->",1136],["T_STRING","language",1136],["T_OBJECT_OPERATOR","->",1136],["T_STRING","get",1136],"(",["T_CONSTANT_ENCAPSED_STRING","'heading_title_success'",1136],")",")",";",["T_WHITESPACE","\n\n\t\t",1136],["T_VARIABLE","$data",1138],"[",["T_CONSTANT_ENCAPSED_STRING","'breadcrumbs'",1138],"]",["T_WHITESPACE"," ",1138],"=",["T_WHITESPACE"," ",1138],["T_ARRAY","array",1138],"(",")",";",["T_WHITESPACE","\n\n\t\t",1138],["T_VARIABLE","$data",1140],"[",["T_CONSTANT_ENCAPSED_STRING","'breadcrumbs'",1140],"]","[","]",["T_WHITESPACE"," ",1140],"=",["T_WHITESPACE"," ",1140],["T_ARRAY","array",1140],"(",["T_WHITESPACE","\n\t\t\t",1140],["T_CONSTANT_ENCAPSED_STRING","'text'",1141],["T_WHITESPACE"," ",1141],["T_DOUBLE_ARROW","=>",1141],["T_WHITESPACE"," ",1141],["T_VARIABLE","$this",1141],["T_OBJECT_OPERATOR","->",1141],["T_STRING","language",1141],["T_OBJECT_OPERATOR","->",1141],["T_STRING","get",1141],"(",["T_CONSTANT_ENCAPSED_STRING","'text_home'",1141],")",",",["T_WHITESPACE","\n\t\t\t",1141],["T_CONSTANT_ENCAPSED_STRING","'href'",1142],["T_WHITESPACE"," ",1142],["T_DOUBLE_ARROW","=>",1142],["T_WHITESPACE"," ",1142],["T_VARIABLE","$this",1142],["T_OBJECT_OPERATOR","->",1142],["T_STRING","url",1142],["T_OBJECT_OPERATOR","->",1142],["T_STRING","link",1142],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/home'",1142],")",["T_WHITESPACE","\n\t\t",1142],")",";",["T_WHITESPACE","\n\n\t\t",1143],["T_VARIABLE","$data",1145],"[",["T_CONSTANT_ENCAPSED_STRING","'breadcrumbs'",1145],"]","[","]",["T_WHITESPACE"," ",1145],"=",["T_WHITESPACE"," ",1145],["T_ARRAY","array",1145],"(",["T_WHITESPACE","\n\t\t\t",1145],["T_CONSTANT_ENCAPSED_STRING","'text'",1146],["T_WHITESPACE"," ",1146],["T_DOUBLE_ARROW","=>",1146],["T_WHITESPACE"," ",1146],["T_VARIABLE","$this",1146],["T_OBJECT_OPERATOR","->",1146],["T_STRING","language",1146],["T_OBJECT_OPERATOR","->",1146],["T_STRING","get",1146],"(",["T_CONSTANT_ENCAPSED_STRING","'text_basket'",1146],")",",",["T_WHITESPACE","\n\t\t\t",1146],["T_CONSTANT_ENCAPSED_STRING","'href'",1147],["T_WHITESPACE"," ",1147],["T_DOUBLE_ARROW","=>",1147],["T_WHITESPACE"," ",1147],["T_VARIABLE","$this",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","url",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","link",1147],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",1147],")",["T_WHITESPACE","\n\t\t",1147],")",";",["T_WHITESPACE","\n\n\t\t",1148],["T_VARIABLE","$data",1150],"[",["T_CONSTANT_ENCAPSED_STRING","'breadcrumbs'",1150],"]","[","]",["T_WHITESPACE"," ",1150],"=",["T_WHITESPACE"," ",1150],["T_ARRAY","array",1150],"(",["T_WHITESPACE","\n\t\t\t",1150],["T_CONSTANT_ENCAPSED_STRING","'text'",1151],["T_WHITESPACE"," ",1151],["T_DOUBLE_ARROW","=>",1151],["T_WHITESPACE"," ",1151],["T_VARIABLE","$this",1151],["T_OBJECT_OPERATOR","->",1151],["T_STRING","language",1151],["T_OBJECT_OPERATOR","->",1151],["T_STRING","get",1151],"(",["T_CONSTANT_ENCAPSED_STRING","'text_checkout'",1151],")",",",["T_WHITESPACE","\n\t\t\t",1151],["T_CONSTANT_ENCAPSED_STRING","'href'",1152],["T_WHITESPACE"," ",1152],["T_DOUBLE_ARROW","=>",1152],["T_WHITESPACE"," ",1152],["T_VARIABLE","$this",1152],["T_OBJECT_OPERATOR","->",1152],["T_STRING","url",1152],["T_OBJECT_OPERATOR","->",1152],["T_STRING","link",1152],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",1152],",",["T_WHITESPACE"," ",1152],["T_CONSTANT_ENCAPSED_STRING","''",1152],",",["T_WHITESPACE"," ",1152],["T_STRING","true",1152],")",["T_WHITESPACE","\n\t\t",1152],")",";",["T_WHITESPACE","\n\n\t\t",1153],["T_VARIABLE","$data",1155],"[",["T_CONSTANT_ENCAPSED_STRING","'breadcrumbs'",1155],"]","[","]",["T_WHITESPACE"," ",1155],"=",["T_WHITESPACE"," ",1155],["T_ARRAY","array",1155],"(",["T_WHITESPACE","\n\t\t\t",1155],["T_CONSTANT_ENCAPSED_STRING","'text'",1156],["T_WHITESPACE"," ",1156],["T_DOUBLE_ARROW","=>",1156],["T_WHITESPACE"," ",1156],["T_VARIABLE","$this",1156],["T_OBJECT_OPERATOR","->",1156],["T_STRING","language",1156],["T_OBJECT_OPERATOR","->",1156],["T_STRING","get",1156],"(",["T_CONSTANT_ENCAPSED_STRING","'text_success'",1156],")",",",["T_WHITESPACE","\n\t\t\t",1156],["T_CONSTANT_ENCAPSED_STRING","'href'",1157],["T_WHITESPACE"," ",1157],["T_DOUBLE_ARROW","=>",1157],["T_WHITESPACE"," ",1157],["T_VARIABLE","$this",1157],["T_OBJECT_OPERATOR","->",1157],["T_STRING","url",1157],["T_OBJECT_OPERATOR","->",1157],["T_STRING","link",1157],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",1157],")",["T_WHITESPACE","\n\t\t",1157],")",";",["T_WHITESPACE","\n\n\t\t",1158],["T_VARIABLE","$data",1160],"[",["T_CONSTANT_ENCAPSED_STRING","'heading_title'",1160],"]",["T_WHITESPACE"," ",1160],"=",["T_WHITESPACE"," ",1160],["T_VARIABLE","$this",1160],["T_OBJECT_OPERATOR","->",1160],["T_STRING","language",1160],["T_OBJECT_OPERATOR","->",1160],["T_STRING","get",1160],"(",["T_CONSTANT_ENCAPSED_STRING","'heading_title_success'",1160],")",";",["T_WHITESPACE","\n\n\t\t",1160],["T_VARIABLE","$data",1162],"[",["T_CONSTANT_ENCAPSED_STRING","'button_continue'",1162],"]",["T_WHITESPACE"," ",1162],"=",["T_WHITESPACE"," ",1162],["T_VARIABLE","$this",1162],["T_OBJECT_OPERATOR","->",1162],["T_STRING","language",1162],["T_OBJECT_OPERATOR","->",1162],["T_STRING","get",1162],"(",["T_CONSTANT_ENCAPSED_STRING","'button_continue'",1162],")",";",["T_WHITESPACE","\n\n\t\t",1162],["T_VARIABLE","$data",1164],"[",["T_CONSTANT_ENCAPSED_STRING","'continue'",1164],"]",["T_WHITESPACE"," ",1164],"=",["T_WHITESPACE"," ",1164],["T_VARIABLE","$this",1164],["T_OBJECT_OPERATOR","->",1164],["T_STRING","url",1164],["T_OBJECT_OPERATOR","->",1164],["T_STRING","link",1164],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/home'",1164],")",";",["T_WHITESPACE","\n\n\t\t",1164],["T_VARIABLE","$data",1166],"[",["T_CONSTANT_ENCAPSED_STRING","'column_left'",1166],"]",["T_WHITESPACE"," ",1166],"=",["T_WHITESPACE"," ",1166],["T_VARIABLE","$this",1166],["T_OBJECT_OPERATOR","->",1166],["T_STRING","load",1166],["T_OBJECT_OPERATOR","->",1166],["T_STRING","controller",1166],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/column_left'",1166],")",";",["T_WHITESPACE","\n\t\t",1166],["T_VARIABLE","$data",1167],"[",["T_CONSTANT_ENCAPSED_STRING","'column_right'",1167],"]",["T_WHITESPACE"," ",1167],"=",["T_WHITESPACE"," ",1167],["T_VARIABLE","$this",1167],["T_OBJECT_OPERATOR","->",1167],["T_STRING","load",1167],["T_OBJECT_OPERATOR","->",1167],["T_STRING","controller",1167],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/column_right'",1167],")",";",["T_WHITESPACE","\n\t\t",1167],["T_VARIABLE","$data",1168],"[",["T_CONSTANT_ENCAPSED_STRING","'content_top'",1168],"]",["T_WHITESPACE"," ",1168],"=",["T_WHITESPACE"," ",1168],["T_VARIABLE","$this",1168],["T_OBJECT_OPERATOR","->",1168],["T_STRING","load",1168],["T_OBJECT_OPERATOR","->",1168],["T_STRING","controller",1168],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/content_top'",1168],")",";",["T_WHITESPACE","\n\t\t",1168],["T_VARIABLE","$data",1169],"[",["T_CONSTANT_ENCAPSED_STRING","'content_bottom'",1169],"]",["T_WHITESPACE"," ",1169],"=",["T_WHITESPACE"," ",1169],["T_VARIABLE","$this",1169],["T_OBJECT_OPERATOR","->",1169],["T_STRING","load",1169],["T_OBJECT_OPERATOR","->",1169],["T_STRING","controller",1169],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/content_bottom'",1169],")",";",["T_WHITESPACE","\n\t\t",1169],["T_VARIABLE","$data",1170],"[",["T_CONSTANT_ENCAPSED_STRING","'footer'",1170],"]",["T_WHITESPACE"," ",1170],"=",["T_WHITESPACE"," ",1170],["T_VARIABLE","$this",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","load",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","controller",1170],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/footer'",1170],")",";",["T_WHITESPACE","\n\t\t",1170],["T_VARIABLE","$data",1171],"[",["T_CONSTANT_ENCAPSED_STRING","'header'",1171],"]",["T_WHITESPACE"," ",1171],"=",["T_WHITESPACE"," ",1171],["T_VARIABLE","$this",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","load",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","controller",1171],"(",["T_CONSTANT_ENCAPSED_STRING","'common\/header'",1171],")",";",["T_WHITESPACE","\n\n\t\t",1171],["T_VARIABLE","$this",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","load",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","model",1173],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",1173],")",";",["T_WHITESPACE","\n\t\t",1173],["T_VARIABLE","$this",1174],["T_OBJECT_OPERATOR","->",1174],["T_STRING","load",1174],["T_OBJECT_OPERATOR","->",1174],["T_STRING","model",1174],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",1174],")",";",["T_WHITESPACE","\n\n\t\t",1174],["T_VARIABLE","$klarna_checkout",1176],["T_WHITESPACE"," ",1176],"=",["T_WHITESPACE"," ",1176],["T_STRING","false",1176],";",["T_WHITESPACE","\n\t\t",1176],["T_VARIABLE","$html_snippet",1177],["T_WHITESPACE"," ",1177],"=",["T_WHITESPACE"," ",1177],["T_CONSTANT_ENCAPSED_STRING","''",1177],";",["T_WHITESPACE","\n\n\t\t",1177],["T_IF","if",1179],["T_WHITESPACE"," ",1179],"(",["T_ISSET","isset",1179],"(",["T_VARIABLE","$this",1179],["T_OBJECT_OPERATOR","->",1179],["T_STRING","request",1179],["T_OBJECT_OPERATOR","->",1179],["T_STRING","get",1179],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1179],"]",")",")",["T_WHITESPACE"," ",1179],"{",["T_WHITESPACE","\n\t\t\t",1179],["T_VARIABLE","$klarna_checkout_order",1180],["T_WHITESPACE"," ",1180],"=",["T_WHITESPACE"," ",1180],["T_VARIABLE","$this",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","model_extension_payment_klarna_checkout",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","getOrder",1180],"(",["T_VARIABLE","$this",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","request",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","get",1180],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1180],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",1180],["T_IF","if",1182],["T_WHITESPACE"," ",1182],"(",["T_VARIABLE","$klarna_checkout_order",1182],")",["T_WHITESPACE"," ",1182],"{",["T_WHITESPACE","\n\t\t\t\t",1182],["T_VARIABLE","$order_info",1183],["T_WHITESPACE"," ",1183],"=",["T_WHITESPACE"," ",1183],["T_VARIABLE","$this",1183],["T_OBJECT_OPERATOR","->",1183],["T_STRING","model_checkout_order",1183],["T_OBJECT_OPERATOR","->",1183],["T_STRING","getOrder",1183],"(",["T_VARIABLE","$klarna_checkout_order",1183],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1183],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",1183],["T_IF","if",1185],["T_WHITESPACE"," ",1185],"(",["T_VARIABLE","$order_info",1185],")",["T_WHITESPACE"," ",1185],"{",["T_WHITESPACE","\n\t\t\t\t\t",1185],["T_LIST","list",1186],"(",["T_VARIABLE","$klarna_account",1186],",",["T_WHITESPACE"," ",1186],["T_VARIABLE","$connector",1186],")",["T_WHITESPACE"," ",1186],"=",["T_WHITESPACE"," ",1186],["T_VARIABLE","$this",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","model_extension_payment_klarna_checkout",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","getConnector",1186],"(",["T_VARIABLE","$this",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","config",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","get",1186],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",1186],")",",",["T_WHITESPACE"," ",1186],["T_VARIABLE","$order_info",1186],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1186],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1186],["T_IF","if",1188],["T_WHITESPACE"," ",1188],"(","!",["T_VARIABLE","$klarna_account",1188],["T_WHITESPACE"," ",1188],["T_BOOLEAN_OR","||",1188],["T_WHITESPACE"," ",1188],"!",["T_VARIABLE","$connector",1188],")",["T_WHITESPACE"," ",1188],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1188],["T_VARIABLE","$this",1189],["T_OBJECT_OPERATOR","->",1189],["T_STRING","model_extension_payment_klarna_checkout",1189],["T_OBJECT_OPERATOR","->",1189],["T_STRING","log",1189],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not getConnector'",1189],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1189],["T_VARIABLE","$this",1190],["T_OBJECT_OPERATOR","->",1190],["T_STRING","response",1190],["T_OBJECT_OPERATOR","->",1190],["T_STRING","redirect",1190],"(",["T_VARIABLE","$this",1190],["T_OBJECT_OPERATOR","->",1190],["T_STRING","url",1190],["T_OBJECT_OPERATOR","->",1190],["T_STRING","link",1190],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/failure'",1190],",",["T_WHITESPACE"," ",1190],["T_CONSTANT_ENCAPSED_STRING","''",1190],",",["T_WHITESPACE"," ",1190],["T_STRING","true",1190],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1190],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",1191],["T_VARIABLE","$retrieve",1193],["T_WHITESPACE"," ",1193],"=",["T_WHITESPACE"," ",1193],["T_VARIABLE","$this",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","model_extension_payment_klarna_checkout",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","orderRetrieve",1193],"(",["T_VARIABLE","$connector",1193],",",["T_WHITESPACE"," ",1193],["T_VARIABLE","$this",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","request",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","get",1193],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1193],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1193],["T_IF","if",1195],["T_WHITESPACE"," ",1195],"(",["T_VARIABLE","$retrieve",1195],")",["T_WHITESPACE"," ",1195],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1195],["T_VARIABLE","$klarna_checkout",1196],["T_WHITESPACE"," ",1196],"=",["T_WHITESPACE"," ",1196],["T_VARIABLE","$retrieve",1196],["T_OBJECT_OPERATOR","->",1196],["T_STRING","fetch",1196],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",1196],["T_IF","if",1198],["T_WHITESPACE"," ",1198],"(",["T_VARIABLE","$klarna_checkout",1198],["T_WHITESPACE"," ",1198],["T_BOOLEAN_AND","&&",1198],["T_WHITESPACE"," ",1198],["T_VARIABLE","$klarna_checkout",1198],"[",["T_CONSTANT_ENCAPSED_STRING","'html_snippet'",1198],"]",")",["T_WHITESPACE"," ",1198],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1198],["T_VARIABLE","$html_snippet",1199],["T_WHITESPACE"," ",1199],"=",["T_WHITESPACE"," ",1199],["T_VARIABLE","$klarna_checkout",1199],"[",["T_CONSTANT_ENCAPSED_STRING","'html_snippet'",1199],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1199],"}",["T_WHITESPACE","\n\t\t\t\t\t",1200],"}",["T_WHITESPACE"," ",1201],["T_ELSE","else",1201],["T_WHITESPACE"," ",1201],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1201],["T_VARIABLE","$this",1202],["T_OBJECT_OPERATOR","->",1202],["T_STRING","response",1202],["T_OBJECT_OPERATOR","->",1202],["T_STRING","redirect",1202],"(",["T_VARIABLE","$this",1202],["T_OBJECT_OPERATOR","->",1202],["T_STRING","url",1202],["T_OBJECT_OPERATOR","->",1202],["T_STRING","link",1202],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",1202],",",["T_WHITESPACE"," ",1202],["T_CONSTANT_ENCAPSED_STRING","''",1202],",",["T_WHITESPACE"," ",1202],["T_STRING","true",1202],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1202],"}",["T_WHITESPACE","\n\t\t\t\t",1203],"}",["T_WHITESPACE","\n\t\t\t",1204],"}",["T_WHITESPACE"," ",1205],["T_ELSE","else",1205],["T_WHITESPACE"," ",1205],"{",["T_WHITESPACE","\n\t\t\t\t",1205],["T_VARIABLE","$this",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","model_extension_payment_klarna_checkout",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","log",1206],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not find order id using '",1206],["T_WHITESPACE"," ",1206],".",["T_WHITESPACE"," ",1206],["T_VARIABLE","$this",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","request",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","get",1206],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1206],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",1206],["T_VARIABLE","$this",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","response",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","redirect",1207],"(",["T_VARIABLE","$this",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","url",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","link",1207],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/failure'",1207],",",["T_WHITESPACE"," ",1207],["T_CONSTANT_ENCAPSED_STRING","''",1207],",",["T_WHITESPACE"," ",1207],["T_STRING","true",1207],")",")",";",["T_WHITESPACE","\n\t\t\t",1207],"}",["T_WHITESPACE","\n\t\t",1208],"}",["T_WHITESPACE"," ",1209],["T_ELSE","else",1209],["T_WHITESPACE"," ",1209],"{",["T_WHITESPACE","\n\t\t\t",1209],["T_VARIABLE","$this",1210],["T_OBJECT_OPERATOR","->",1210],["T_STRING","model_extension_payment_klarna_checkout",1210],["T_OBJECT_OPERATOR","->",1210],["T_STRING","log",1210],"(",["T_CONSTANT_ENCAPSED_STRING","'$this->request->get[\\'klarna_order_id\\'] is not set'",1210],")",";",["T_WHITESPACE","\n\t\t\t",1210],["T_VARIABLE","$this",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","response",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","redirect",1211],"(",["T_VARIABLE","$this",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","url",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","link",1211],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/failure'",1211],",",["T_WHITESPACE"," ",1211],["T_CONSTANT_ENCAPSED_STRING","''",1211],",",["T_WHITESPACE"," ",1211],["T_STRING","true",1211],")",")",";",["T_WHITESPACE","\n\t\t",1211],"}",["T_WHITESPACE","\n\n\t\t",1212],["T_VARIABLE","$data",1214],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout'",1214],"]",["T_WHITESPACE"," ",1214],"=",["T_WHITESPACE"," ",1214],["T_VARIABLE","$html_snippet",1214],";",["T_WHITESPACE","\n\n\t\t",1214],["T_VARIABLE","$this",1216],["T_OBJECT_OPERATOR","->",1216],["T_STRING","response",1216],["T_OBJECT_OPERATOR","->",1216],["T_STRING","setOutput",1216],"(",["T_VARIABLE","$this",1216],["T_OBJECT_OPERATOR","->",1216],["T_STRING","load",1216],["T_OBJECT_OPERATOR","->",1216],["T_STRING","view",1216],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout_success'",1216],",",["T_WHITESPACE"," ",1216],["T_VARIABLE","$data",1216],")",")",";",["T_WHITESPACE","\n\t",1216],"}",["T_WHITESPACE","\n\n\t",1217],["T_PUBLIC","public",1219],["T_WHITESPACE"," ",1219],["T_FUNCTION","function",1219],["T_WHITESPACE"," ",1219],["T_STRING","push",1219],"(",")",["T_WHITESPACE"," ",1219],"{",["T_WHITESPACE","\n\t\t",1219],["T_VARIABLE","$this",1220],["T_OBJECT_OPERATOR","->",1220],["T_STRING","load",1220],["T_OBJECT_OPERATOR","->",1220],["T_STRING","model",1220],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",1220],")",";",["T_WHITESPACE","\n\t\t",1220],["T_VARIABLE","$this",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","load",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","model",1221],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",1221],")",";",["T_WHITESPACE","\n\n\t\t",1221],["T_IF","if",1223],["T_WHITESPACE"," ",1223],"(","!",["T_VARIABLE","$this",1223],["T_OBJECT_OPERATOR","->",1223],["T_STRING","config",1223],["T_OBJECT_OPERATOR","->",1223],["T_STRING","get",1223],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_status'",1223],")",")",["T_WHITESPACE"," ",1223],"{",["T_WHITESPACE","\n\t\t\t",1223],["T_RETURN","return",1224],["T_WHITESPACE"," ",1224],["T_STRING","false",1224],";",["T_WHITESPACE","\n\t\t",1224],"}",["T_WHITESPACE","\n\n\t\t",1225],["T_IF","if",1227],["T_WHITESPACE"," ",1227],"(",["T_ISSET","isset",1227],"(",["T_VARIABLE","$this",1227],["T_OBJECT_OPERATOR","->",1227],["T_STRING","request",1227],["T_OBJECT_OPERATOR","->",1227],["T_STRING","get",1227],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1227],"]",")",")",["T_WHITESPACE"," ",1227],"{",["T_WHITESPACE","\n\t\t\t",1227],["T_VARIABLE","$klarna_checkout_order",1228],["T_WHITESPACE"," ",1228],"=",["T_WHITESPACE"," ",1228],["T_VARIABLE","$this",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","model_extension_payment_klarna_checkout",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","getOrder",1228],"(",["T_VARIABLE","$this",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","request",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","get",1228],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1228],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",1228],["T_IF","if",1230],["T_WHITESPACE"," ",1230],"(",["T_VARIABLE","$klarna_checkout_order",1230],")",["T_WHITESPACE"," ",1230],"{",["T_WHITESPACE","\n\t\t\t\t",1230],["T_VARIABLE","$order_info",1231],["T_WHITESPACE"," ",1231],"=",["T_WHITESPACE"," ",1231],["T_VARIABLE","$this",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","model_checkout_order",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","getOrder",1231],"(",["T_VARIABLE","$klarna_checkout_order",1231],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1231],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",1231],["T_IF","if",1233],["T_WHITESPACE"," ",1233],"(",["T_VARIABLE","$order_info",1233],")",["T_WHITESPACE"," ",1233],"{",["T_WHITESPACE","\n\t\t\t\t\t",1233],["T_LIST","list",1234],"(",["T_VARIABLE","$klarna_account",1234],",",["T_WHITESPACE"," ",1234],["T_VARIABLE","$connector",1234],")",["T_WHITESPACE"," ",1234],"=",["T_WHITESPACE"," ",1234],["T_VARIABLE","$this",1234],["T_OBJECT_OPERATOR","->",1234],["T_STRING","model_extension_payment_klarna_checkout",1234],["T_OBJECT_OPERATOR","->",1234],["T_STRING","getConnector",1234],"(",["T_VARIABLE","$this",1234],["T_OBJECT_OPERATOR","->",1234],["T_STRING","config",1234],["T_OBJECT_OPERATOR","->",1234],["T_STRING","get",1234],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_account'",1234],")",",",["T_WHITESPACE"," ",1234],["T_VARIABLE","$order_info",1234],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1234],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1234],["T_IF","if",1236],["T_WHITESPACE"," ",1236],"(",["T_VARIABLE","$klarna_account",1236],["T_WHITESPACE"," ",1236],["T_BOOLEAN_AND","&&",1236],["T_WHITESPACE"," ",1236],["T_VARIABLE","$connector",1236],")",["T_WHITESPACE"," ",1236],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1236],["T_VARIABLE","$order",1237],["T_WHITESPACE"," ",1237],"=",["T_WHITESPACE"," ",1237],["T_VARIABLE","$this",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","model_extension_payment_klarna_checkout",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","omOrderRetrieve",1237],"(",["T_VARIABLE","$connector",1237],",",["T_WHITESPACE"," ",1237],["T_VARIABLE","$this",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","request",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","get",1237],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1237],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",1237],["T_VARIABLE","$this",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","model_extension_payment_klarna_checkout",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","log",1239],"(",["T_CONSTANT_ENCAPSED_STRING","'Order details from push:'",1239],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1239],["T_VARIABLE","$this",1240],["T_OBJECT_OPERATOR","->",1240],["T_STRING","model_extension_payment_klarna_checkout",1240],["T_OBJECT_OPERATOR","->",1240],["T_STRING","log",1240],"(",["T_VARIABLE","$order",1240],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",1240],["T_IF","if",1242],["T_WHITESPACE"," ",1242],"(",["T_VARIABLE","$order",1242],")",["T_WHITESPACE"," ",1242],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1242],["T_IF","if",1243],["T_WHITESPACE"," ",1243],"(",["T_VARIABLE","$order",1243],["T_OBJECT_OPERATOR","->",1243],["T_STRING","acknowledge",1243],"(",")",")",["T_WHITESPACE"," ",1243],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1243],["T_COMMENT","\/\/ Update OpenCart order with payment and shipping details\n",1244],["T_WHITESPACE","\t\t\t\t\t\t\t\t",1245],["T_VARIABLE","$payment_country_info",1245],["T_WHITESPACE"," ",1245],"=",["T_WHITESPACE"," ",1245],["T_VARIABLE","$this",1245],["T_OBJECT_OPERATOR","->",1245],["T_STRING","model_extension_payment_klarna_checkout",1245],["T_OBJECT_OPERATOR","->",1245],["T_STRING","getCountryByIsoCode2",1245],"(",["T_VARIABLE","$order",1245],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1245],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country'",1245],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1245],["T_VARIABLE","$shipping_country_info",1246],["T_WHITESPACE"," ",1246],"=",["T_WHITESPACE"," ",1246],["T_VARIABLE","$this",1246],["T_OBJECT_OPERATOR","->",1246],["T_STRING","model_extension_payment_klarna_checkout",1246],["T_OBJECT_OPERATOR","->",1246],["T_STRING","getCountryByIsoCode2",1246],"(",["T_VARIABLE","$order",1246],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1246],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country'",1246],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",1246],["T_COMMENT","\/\/If region is passed, try to update OpenCart order with correct region\/zone\n",1248],["T_WHITESPACE","\t\t\t\t\t\t\t\t",1249],["T_VARIABLE","$payment_zone_info",1249],["T_WHITESPACE"," ",1249],"=",["T_WHITESPACE"," ",1249],["T_ARRAY","array",1249],"(",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1249],["T_IF","if",1250],["T_WHITESPACE"," ",1250],"(",["T_VARIABLE","$payment_country_info",1250],["T_WHITESPACE"," ",1250],["T_BOOLEAN_AND","&&",1250],["T_WHITESPACE"," ",1250],["T_ISSET","isset",1250],"(",["T_VARIABLE","$order",1250],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1250],"]","[",["T_CONSTANT_ENCAPSED_STRING","'region'",1250],"]",")",")",["T_WHITESPACE"," ",1250],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1250],["T_VARIABLE","$payment_zone_info",1251],["T_WHITESPACE"," ",1251],"=",["T_WHITESPACE"," ",1251],["T_VARIABLE","$this",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","model_extension_payment_klarna_checkout",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","getZoneByCode",1251],"(",["T_VARIABLE","$order",1251],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1251],"]","[",["T_CONSTANT_ENCAPSED_STRING","'region'",1251],"]",",",["T_WHITESPACE"," ",1251],["T_VARIABLE","$payment_country_info",1251],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1251],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1251],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",1252],["T_VARIABLE","$shipping_zone_info",1254],["T_WHITESPACE"," ",1254],"=",["T_WHITESPACE"," ",1254],["T_ARRAY","array",1254],"(",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1254],["T_IF","if",1255],["T_WHITESPACE"," ",1255],"(",["T_VARIABLE","$shipping_country_info",1255],["T_WHITESPACE"," ",1255],["T_BOOLEAN_AND","&&",1255],["T_WHITESPACE"," ",1255],["T_ISSET","isset",1255],"(",["T_VARIABLE","$order",1255],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1255],"]","[",["T_CONSTANT_ENCAPSED_STRING","'region'",1255],"]",")",")",["T_WHITESPACE"," ",1255],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1255],["T_VARIABLE","$shipping_zone_info",1256],["T_WHITESPACE"," ",1256],"=",["T_WHITESPACE"," ",1256],["T_VARIABLE","$this",1256],["T_OBJECT_OPERATOR","->",1256],["T_STRING","model_extension_payment_klarna_checkout",1256],["T_OBJECT_OPERATOR","->",1256],["T_STRING","getZoneByCode",1256],"(",["T_VARIABLE","$order",1256],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1256],"]","[",["T_CONSTANT_ENCAPSED_STRING","'region'",1256],"]",",",["T_WHITESPACE"," ",1256],["T_VARIABLE","$shipping_country_info",1256],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1256],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1256],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",1257],["T_VARIABLE","$order_data",1259],["T_WHITESPACE"," ",1259],"=",["T_WHITESPACE"," ",1259],["T_ARRAY","array",1259],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1259],["T_CONSTANT_ENCAPSED_STRING","'firstname'",1260],["T_WHITESPACE","\t\t\t\t  ",1260],["T_DOUBLE_ARROW","=>",1260],["T_WHITESPACE"," ",1260],["T_STRING","utf8_substr",1260],"(",["T_VARIABLE","$order",1260],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1260],"]","[",["T_CONSTANT_ENCAPSED_STRING","'given_name'",1260],"]",",",["T_WHITESPACE"," ",1260],["T_LNUMBER","0",1260],",",["T_WHITESPACE"," ",1260],["T_LNUMBER","32",1260],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1260],["T_CONSTANT_ENCAPSED_STRING","'lastname'",1261],["T_WHITESPACE","\t\t\t\t  ",1261],["T_DOUBLE_ARROW","=>",1261],["T_WHITESPACE"," ",1261],["T_STRING","utf8_substr",1261],"(",["T_VARIABLE","$order",1261],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1261],"]","[",["T_CONSTANT_ENCAPSED_STRING","'family_name'",1261],"]",",",["T_WHITESPACE"," ",1261],["T_LNUMBER","0",1261],",",["T_WHITESPACE"," ",1261],["T_LNUMBER","32",1261],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1261],["T_CONSTANT_ENCAPSED_STRING","'telephone'",1262],["T_WHITESPACE","\t\t\t\t  ",1262],["T_DOUBLE_ARROW","=>",1262],["T_WHITESPACE"," ",1262],["T_STRING","utf8_substr",1262],"(",["T_VARIABLE","$order",1262],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1262],"]","[",["T_CONSTANT_ENCAPSED_STRING","'phone'",1262],"]",",",["T_WHITESPACE"," ",1262],["T_LNUMBER","0",1262],",",["T_WHITESPACE"," ",1262],["T_LNUMBER","32",1262],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1262],["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",1263],["T_WHITESPACE","\t\t  ",1263],["T_DOUBLE_ARROW","=>",1263],["T_WHITESPACE"," ",1263],["T_STRING","utf8_substr",1263],"(",["T_VARIABLE","$order",1263],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1263],"]","[",["T_CONSTANT_ENCAPSED_STRING","'given_name'",1263],"]",",",["T_WHITESPACE"," ",1263],["T_LNUMBER","0",1263],",",["T_WHITESPACE"," ",1263],["T_LNUMBER","32",1263],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1263],["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",1264],["T_WHITESPACE","\t\t  ",1264],["T_DOUBLE_ARROW","=>",1264],["T_WHITESPACE"," ",1264],["T_STRING","utf8_substr",1264],"(",["T_VARIABLE","$order",1264],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1264],"]","[",["T_CONSTANT_ENCAPSED_STRING","'family_name'",1264],"]",",",["T_WHITESPACE"," ",1264],["T_LNUMBER","0",1264],",",["T_WHITESPACE"," ",1264],["T_LNUMBER","32",1264],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1264],["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",1265],["T_WHITESPACE","\t\t  ",1265],["T_DOUBLE_ARROW","=>",1265],["T_WHITESPACE"," ",1265],["T_STRING","utf8_substr",1265],"(",["T_VARIABLE","$order",1265],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1265],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street_address'",1265],"]",",",["T_WHITESPACE"," ",1265],["T_LNUMBER","0",1265],",",["T_WHITESPACE"," ",1265],["T_LNUMBER","128",1265],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1265],["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",1266],["T_WHITESPACE","\t\t  ",1266],["T_DOUBLE_ARROW","=>",1266],["T_WHITESPACE"," ",1266],"(",["T_ISSET","isset",1266],"(",["T_VARIABLE","$order",1266],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1266],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street_address2'",1266],"]",")",["T_WHITESPACE"," ",1266],"?",["T_WHITESPACE"," ",1266],["T_STRING","utf8_substr",1266],"(",["T_VARIABLE","$order",1266],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1266],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street_address2'",1266],"]",",",["T_WHITESPACE"," ",1266],["T_LNUMBER","0",1266],",",["T_WHITESPACE"," ",1266],["T_LNUMBER","128",1266],")",["T_WHITESPACE"," ",1266],":",["T_WHITESPACE"," ",1266],["T_CONSTANT_ENCAPSED_STRING","''",1266],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1266],["T_CONSTANT_ENCAPSED_STRING","'payment_city'",1267],["T_WHITESPACE","\t\t\t  ",1267],["T_DOUBLE_ARROW","=>",1267],["T_WHITESPACE"," ",1267],["T_STRING","utf8_substr",1267],"(",["T_VARIABLE","$order",1267],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1267],"]","[",["T_CONSTANT_ENCAPSED_STRING","'city'",1267],"]",",",["T_WHITESPACE"," ",1267],["T_LNUMBER","0",1267],",",["T_WHITESPACE"," ",1267],["T_LNUMBER","128",1267],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1267],["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",1268],["T_WHITESPACE","\t\t  ",1268],["T_DOUBLE_ARROW","=>",1268],["T_WHITESPACE"," ",1268],["T_STRING","utf8_substr",1268],"(",["T_VARIABLE","$order",1268],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1268],"]","[",["T_CONSTANT_ENCAPSED_STRING","'postal_code'",1268],"]",",",["T_WHITESPACE"," ",1268],["T_LNUMBER","0",1268],",",["T_WHITESPACE"," ",1268],["T_LNUMBER","10",1268],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1268],["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",1269],["T_WHITESPACE","\t\t\t  ",1269],["T_DOUBLE_ARROW","=>",1269],["T_WHITESPACE"," ",1269],"(",["T_VARIABLE","$payment_zone_info",1269],["T_WHITESPACE"," ",1269],"?",["T_WHITESPACE"," ",1269],["T_VARIABLE","$payment_zone_info",1269],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1269],"]",["T_WHITESPACE"," ",1269],":",["T_WHITESPACE"," ",1269],["T_CONSTANT_ENCAPSED_STRING","''",1269],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1269],["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",1270],["T_WHITESPACE","\t\t  ",1270],["T_DOUBLE_ARROW","=>",1270],["T_WHITESPACE"," ",1270],"(",["T_VARIABLE","$payment_zone_info",1270],["T_WHITESPACE"," ",1270],"?",["T_WHITESPACE"," ",1270],["T_VARIABLE","$payment_zone_info",1270],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1270],"]",["T_WHITESPACE"," ",1270],":",["T_WHITESPACE"," ",1270],["T_CONSTANT_ENCAPSED_STRING","''",1270],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1270],["T_CONSTANT_ENCAPSED_STRING","'payment_country'",1271],["T_WHITESPACE","\t\t  ",1271],["T_DOUBLE_ARROW","=>",1271],["T_WHITESPACE"," ",1271],"(",["T_VARIABLE","$payment_country_info",1271],["T_WHITESPACE"," ",1271],"?",["T_WHITESPACE"," ",1271],["T_VARIABLE","$payment_country_info",1271],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1271],"]",["T_WHITESPACE"," ",1271],":",["T_WHITESPACE"," ",1271],["T_CONSTANT_ENCAPSED_STRING","''",1271],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1271],["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",1272],["T_WHITESPACE","\t  ",1272],["T_DOUBLE_ARROW","=>",1272],["T_WHITESPACE"," ",1272],"(",["T_VARIABLE","$payment_country_info",1272],["T_WHITESPACE"," ",1272],"?",["T_WHITESPACE"," ",1272],["T_VARIABLE","$payment_country_info",1272],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1272],"]",["T_WHITESPACE"," ",1272],":",["T_WHITESPACE"," ",1272],["T_CONSTANT_ENCAPSED_STRING","''",1272],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1272],["T_CONSTANT_ENCAPSED_STRING","'payment_address_format'",1273],["T_WHITESPACE","  ",1273],["T_DOUBLE_ARROW","=>",1273],["T_WHITESPACE"," ",1273],"(",["T_VARIABLE","$payment_country_info",1273],["T_WHITESPACE"," ",1273],"?",["T_WHITESPACE"," ",1273],["T_VARIABLE","$payment_country_info",1273],"[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",1273],"]",["T_WHITESPACE"," ",1273],":",["T_WHITESPACE"," ",1273],["T_CONSTANT_ENCAPSED_STRING","''",1273],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1273],["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",1274],["T_WHITESPACE","\t  ",1274],["T_DOUBLE_ARROW","=>",1274],["T_WHITESPACE"," ",1274],["T_STRING","utf8_substr",1274],"(",["T_VARIABLE","$order",1274],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1274],"]","[",["T_CONSTANT_ENCAPSED_STRING","'given_name'",1274],"]",",",["T_WHITESPACE"," ",1274],["T_LNUMBER","0",1274],",",["T_WHITESPACE"," ",1274],["T_LNUMBER","32",1274],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1274],["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",1275],["T_WHITESPACE","\t\t  ",1275],["T_DOUBLE_ARROW","=>",1275],["T_WHITESPACE"," ",1275],["T_STRING","utf8_substr",1275],"(",["T_VARIABLE","$order",1275],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1275],"]","[",["T_CONSTANT_ENCAPSED_STRING","'family_name'",1275],"]",",",["T_WHITESPACE"," ",1275],["T_LNUMBER","0",1275],",",["T_WHITESPACE"," ",1275],["T_LNUMBER","32",1275],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1275],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",1276],["T_WHITESPACE","\t  ",1276],["T_DOUBLE_ARROW","=>",1276],["T_WHITESPACE"," ",1276],["T_STRING","utf8_substr",1276],"(",["T_VARIABLE","$order",1276],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1276],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street_address'",1276],"]",",",["T_WHITESPACE"," ",1276],["T_LNUMBER","0",1276],",",["T_WHITESPACE"," ",1276],["T_LNUMBER","128",1276],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1276],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",1277],["T_WHITESPACE","\t  ",1277],["T_DOUBLE_ARROW","=>",1277],["T_WHITESPACE"," ",1277],"(",["T_ISSET","isset",1277],"(",["T_VARIABLE","$order",1277],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1277],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street_address2'",1277],"]",")",["T_WHITESPACE"," ",1277],"?",["T_WHITESPACE"," ",1277],["T_STRING","utf8_substr",1277],"(",["T_VARIABLE","$order",1277],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1277],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street_address2'",1277],"]",",",["T_WHITESPACE"," ",1277],["T_LNUMBER","0",1277],",",["T_WHITESPACE"," ",1277],["T_LNUMBER","128",1277],")",["T_WHITESPACE"," ",1277],":",["T_WHITESPACE"," ",1277],["T_CONSTANT_ENCAPSED_STRING","''",1277],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1277],["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",1278],["T_WHITESPACE","\t\t\t  ",1278],["T_DOUBLE_ARROW","=>",1278],["T_WHITESPACE"," ",1278],["T_STRING","utf8_substr",1278],"(",["T_VARIABLE","$order",1278],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1278],"]","[",["T_CONSTANT_ENCAPSED_STRING","'city'",1278],"]",",",["T_WHITESPACE"," ",1278],["T_LNUMBER","0",1278],",",["T_WHITESPACE"," ",1278],["T_LNUMBER","128",1278],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1278],["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",1279],["T_WHITESPACE","\t\t  ",1279],["T_DOUBLE_ARROW","=>",1279],["T_WHITESPACE"," ",1279],["T_STRING","utf8_substr",1279],"(",["T_VARIABLE","$order",1279],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1279],"]","[",["T_CONSTANT_ENCAPSED_STRING","'postal_code'",1279],"]",",",["T_WHITESPACE"," ",1279],["T_LNUMBER","0",1279],",",["T_WHITESPACE"," ",1279],["T_LNUMBER","10",1279],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1279],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",1280],["T_WHITESPACE","\t\t\t  ",1280],["T_DOUBLE_ARROW","=>",1280],["T_WHITESPACE"," ",1280],"(",["T_VARIABLE","$shipping_zone_info",1280],["T_WHITESPACE"," ",1280],"?",["T_WHITESPACE"," ",1280],["T_VARIABLE","$shipping_zone_info",1280],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1280],"]",["T_WHITESPACE"," ",1280],":",["T_WHITESPACE"," ",1280],["T_CONSTANT_ENCAPSED_STRING","''",1280],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1280],["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",1281],["T_WHITESPACE","\t\t  ",1281],["T_DOUBLE_ARROW","=>",1281],["T_WHITESPACE"," ",1281],"(",["T_VARIABLE","$shipping_zone_info",1281],["T_WHITESPACE"," ",1281],"?",["T_WHITESPACE"," ",1281],["T_VARIABLE","$shipping_zone_info",1281],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1281],"]",["T_WHITESPACE"," ",1281],":",["T_WHITESPACE"," ",1281],["T_CONSTANT_ENCAPSED_STRING","''",1281],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1281],["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",1282],["T_WHITESPACE","\t\t  ",1282],["T_DOUBLE_ARROW","=>",1282],["T_WHITESPACE"," ",1282],"(",["T_VARIABLE","$shipping_country_info",1282],["T_WHITESPACE"," ",1282],"?",["T_WHITESPACE"," ",1282],["T_VARIABLE","$shipping_country_info",1282],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1282],"]",["T_WHITESPACE"," ",1282],":",["T_WHITESPACE"," ",1282],["T_CONSTANT_ENCAPSED_STRING","''",1282],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1282],["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",1283],["T_WHITESPACE","\t  ",1283],["T_DOUBLE_ARROW","=>",1283],["T_WHITESPACE"," ",1283],"(",["T_VARIABLE","$shipping_country_info",1283],["T_WHITESPACE"," ",1283],"?",["T_WHITESPACE"," ",1283],["T_VARIABLE","$shipping_country_info",1283],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1283],"]",["T_WHITESPACE"," ",1283],":",["T_WHITESPACE"," ",1283],["T_CONSTANT_ENCAPSED_STRING","''",1283],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1283],["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",1284],["T_WHITESPACE"," ",1284],["T_DOUBLE_ARROW","=>",1284],["T_WHITESPACE"," ",1284],"(",["T_VARIABLE","$shipping_country_info",1284],["T_WHITESPACE"," ",1284],"?",["T_WHITESPACE"," ",1284],["T_VARIABLE","$shipping_country_info",1284],"[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",1284],"]",["T_WHITESPACE"," ",1284],":",["T_WHITESPACE"," ",1284],["T_CONSTANT_ENCAPSED_STRING","''",1284],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1284],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",1285],["T_VARIABLE","$this",1287],["T_OBJECT_OPERATOR","->",1287],["T_STRING","model_extension_payment_klarna_checkout",1287],["T_OBJECT_OPERATOR","->",1287],["T_STRING","updateOcOrder",1287],"(",["T_VARIABLE","$klarna_checkout_order",1287],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1287],"]",",",["T_WHITESPACE"," ",1287],["T_VARIABLE","$order_data",1287],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",1287],["T_VARIABLE","$order_status_id",1289],["T_WHITESPACE"," ",1289],"=",["T_WHITESPACE"," ",1289],["T_STRING","false",1289],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1289],["T_SWITCH","switch",1290],["T_WHITESPACE"," ",1290],"(",["T_VARIABLE","$order",1290],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",1290],"]",")",["T_WHITESPACE"," ",1290],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1290],["T_CASE","case",1291],["T_WHITESPACE"," ",1291],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZED'",1291],":",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1291],["T_VARIABLE","$order_status_id",1292],["T_WHITESPACE"," ",1292],"=",["T_WHITESPACE"," ",1292],["T_VARIABLE","$this",1292],["T_OBJECT_OPERATOR","->",1292],["T_STRING","config",1292],["T_OBJECT_OPERATOR","->",1292],["T_STRING","get",1292],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_authorised_id'",1292],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t\t\t",1292],["T_IF","if",1294],["T_WHITESPACE"," ",1294],"(",["T_VARIABLE","$order",1294],"[",["T_CONSTANT_ENCAPSED_STRING","'fraud_status'",1294],"]",["T_WHITESPACE"," ",1294],["T_IS_EQUAL","==",1294],["T_WHITESPACE"," ",1294],["T_CONSTANT_ENCAPSED_STRING","'PENDING'",1294],")",["T_WHITESPACE"," ",1294],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t",1294],["T_VARIABLE","$order_status_id",1295],["T_WHITESPACE"," ",1295],"=",["T_WHITESPACE"," ",1295],["T_VARIABLE","$this",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","config",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","get",1295],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_fraud_pending_id'",1295],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1295],"}",["T_WHITESPACE"," ",1296],["T_ELSEIF","elseif",1296],["T_WHITESPACE"," ",1296],"(",["T_VARIABLE","$order",1296],"[",["T_CONSTANT_ENCAPSED_STRING","'fraud_status'",1296],"]",["T_WHITESPACE"," ",1296],["T_IS_EQUAL","==",1296],["T_WHITESPACE"," ",1296],["T_CONSTANT_ENCAPSED_STRING","'REJECTED'",1296],")",["T_WHITESPACE"," ",1296],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t",1296],["T_VARIABLE","$order_status_id",1297],["T_WHITESPACE"," ",1297],"=",["T_WHITESPACE"," ",1297],["T_VARIABLE","$this",1297],["T_OBJECT_OPERATOR","->",1297],["T_STRING","config",1297],["T_OBJECT_OPERATOR","->",1297],["T_STRING","get",1297],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_fraud_rejected_id'",1297],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1297],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1298],["T_BREAK","break",1299],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1299],["T_CASE","case",1300],["T_WHITESPACE"," ",1300],["T_CONSTANT_ENCAPSED_STRING","'PART_CAPTURED'",1300],":",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1300],["T_VARIABLE","$order_status_id",1301],["T_WHITESPACE"," ",1301],"=",["T_WHITESPACE"," ",1301],["T_VARIABLE","$this",1301],["T_OBJECT_OPERATOR","->",1301],["T_STRING","config",1301],["T_OBJECT_OPERATOR","->",1301],["T_STRING","get",1301],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_part_captured_id'",1301],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1301],["T_BREAK","break",1302],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1302],["T_CASE","case",1303],["T_WHITESPACE"," ",1303],["T_CONSTANT_ENCAPSED_STRING","'CAPTURED'",1303],":",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1303],["T_VARIABLE","$order_status_id",1304],["T_WHITESPACE"," ",1304],"=",["T_WHITESPACE"," ",1304],["T_VARIABLE","$this",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","config",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","get",1304],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_captured_id'",1304],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1304],["T_BREAK","break",1305],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1305],["T_CASE","case",1306],["T_WHITESPACE"," ",1306],["T_CONSTANT_ENCAPSED_STRING","'CANCELLED'",1306],":",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1306],["T_VARIABLE","$order_status_id",1307],["T_WHITESPACE"," ",1307],"=",["T_WHITESPACE"," ",1307],["T_VARIABLE","$this",1307],["T_OBJECT_OPERATOR","->",1307],["T_STRING","config",1307],["T_OBJECT_OPERATOR","->",1307],["T_STRING","get",1307],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_order_status_cancelled_id'",1307],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t",1307],["T_BREAK","break",1308],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1308],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t\t",1309],["T_IF","if",1311],["T_WHITESPACE"," ",1311],"(",["T_VARIABLE","$order_status_id",1311],")",["T_WHITESPACE"," ",1311],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",1311],["T_VARIABLE","$this",1312],["T_OBJECT_OPERATOR","->",1312],["T_STRING","model_checkout_order",1312],["T_OBJECT_OPERATOR","->",1312],["T_STRING","addOrderHistory",1312],"(",["T_VARIABLE","$klarna_checkout_order",1312],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1312],"]",",",["T_WHITESPACE"," ",1312],["T_VARIABLE","$order_status_id",1312],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",1312],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1313],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",1314],"}",["T_WHITESPACE"," ",1315],["T_ELSE","else",1315],["T_WHITESPACE"," ",1315],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1315],["T_VARIABLE","$this",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","model_extension_payment_klarna_checkout",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","log",1316],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot retrieve KC order using order_id: '",1316],["T_WHITESPACE"," ",1316],".",["T_WHITESPACE"," ",1316],["T_VARIABLE","$this",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","request",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","get",1316],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1316],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1316],"}",["T_WHITESPACE","\n\t\t\t\t\t",1317],"}",["T_WHITESPACE","\n\t\t\t\t",1318],"}",["T_WHITESPACE","\n\t\t\t",1319],"}",["T_WHITESPACE"," ",1320],["T_ELSE","else",1320],["T_WHITESPACE"," ",1320],"{",["T_WHITESPACE","\n\t\t\t\t",1320],["T_VARIABLE","$this",1321],["T_OBJECT_OPERATOR","->",1321],["T_STRING","model_extension_payment_klarna_checkout",1321],["T_OBJECT_OPERATOR","->",1321],["T_STRING","log",1321],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot find KC order using order_id: '",1321],["T_WHITESPACE"," ",1321],".",["T_WHITESPACE"," ",1321],["T_VARIABLE","$this",1321],["T_OBJECT_OPERATOR","->",1321],["T_STRING","request",1321],["T_OBJECT_OPERATOR","->",1321],["T_STRING","get",1321],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id'",1321],"]",")",";",["T_WHITESPACE","\n\t\t\t",1321],"}",["T_WHITESPACE","\n\t\t",1322],"}",["T_WHITESPACE","\n\t",1323],"}",["T_WHITESPACE","\n\n\t",1324],["T_PRIVATE","private",1326],["T_WHITESPACE"," ",1326],["T_FUNCTION","function",1326],["T_WHITESPACE"," ",1326],["T_STRING","setPayment",1326],"(",")",["T_WHITESPACE"," ",1326],"{",["T_WHITESPACE","\n\t\t",1326],["T_VARIABLE","$this",1327],["T_OBJECT_OPERATOR","->",1327],["T_STRING","load",1327],["T_OBJECT_OPERATOR","->",1327],["T_STRING","model",1327],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/address'",1327],")",";",["T_WHITESPACE","\n\t\t",1327],["T_VARIABLE","$this",1328],["T_OBJECT_OPERATOR","->",1328],["T_STRING","load",1328],["T_OBJECT_OPERATOR","->",1328],["T_STRING","model",1328],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/country'",1328],")",";",["T_WHITESPACE","\n\t\t",1328],["T_VARIABLE","$this",1329],["T_OBJECT_OPERATOR","->",1329],["T_STRING","load",1329],["T_OBJECT_OPERATOR","->",1329],["T_STRING","model",1329],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/zone'",1329],")",";",["T_WHITESPACE","\n\n\t\t",1329],["T_IF","if",1331],["T_WHITESPACE"," ",1331],"(",["T_ISSET","isset",1331],"(",["T_VARIABLE","$this",1331],["T_OBJECT_OPERATOR","->",1331],["T_STRING","session",1331],["T_OBJECT_OPERATOR","->",1331],["T_STRING","data",1331],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1331],"]",")",["T_WHITESPACE"," ",1331],["T_BOOLEAN_AND","&&",1331],["T_WHITESPACE"," ",1331],"!",["T_EMPTY","empty",1331],"(",["T_VARIABLE","$this",1331],["T_OBJECT_OPERATOR","->",1331],["T_STRING","session",1331],["T_OBJECT_OPERATOR","->",1331],["T_STRING","data",1331],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1331],"]",")",")",["T_WHITESPACE"," ",1331],"{",["T_WHITESPACE","\n\t\t\t",1331],["T_VARIABLE","$this",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","session",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","data",1332],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1332],"]",["T_WHITESPACE"," ",1332],"=",["T_WHITESPACE"," ",1332],["T_VARIABLE","$this",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","session",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","data",1332],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1332],"]",";",["T_WHITESPACE","\n\t\t",1332],"}",["T_WHITESPACE"," ",1333],["T_ELSEIF","elseif",1333],["T_WHITESPACE"," ",1333],"(",["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","customer",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","isLogged",1333],"(",")",["T_WHITESPACE"," ",1333],["T_BOOLEAN_AND","&&",1333],["T_WHITESPACE"," ",1333],["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","customer",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","getAddressId",1333],"(",")",")",["T_WHITESPACE"," ",1333],"{",["T_WHITESPACE","\n\t\t\t",1333],["T_VARIABLE","$this",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","session",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","data",1334],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1334],"]",["T_WHITESPACE"," ",1334],"=",["T_WHITESPACE"," ",1334],["T_VARIABLE","$this",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","model_account_address",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","getAddress",1334],"(",["T_VARIABLE","$this",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","customer",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","getAddressId",1334],"(",")",")",";",["T_WHITESPACE","\n\t\t",1334],"}",["T_WHITESPACE"," ",1335],["T_ELSE","else",1335],["T_WHITESPACE"," ",1335],"{",["T_WHITESPACE","\n\t\t\t",1335],["T_VARIABLE","$country_info",1336],["T_WHITESPACE"," ",1336],"=",["T_WHITESPACE"," ",1336],["T_VARIABLE","$this",1336],["T_OBJECT_OPERATOR","->",1336],["T_STRING","model_localisation_country",1336],["T_OBJECT_OPERATOR","->",1336],["T_STRING","getCountry",1336],"(",["T_VARIABLE","$this",1336],["T_OBJECT_OPERATOR","->",1336],["T_STRING","config",1336],["T_OBJECT_OPERATOR","->",1336],["T_STRING","get",1336],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",1336],")",")",";",["T_WHITESPACE","\n\n\t\t\t",1336],["T_VARIABLE","$zone_info",1338],["T_WHITESPACE"," ",1338],"=",["T_WHITESPACE"," ",1338],["T_VARIABLE","$this",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","model_localisation_zone",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","getZone",1338],"(",["T_VARIABLE","$this",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","config",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","get",1338],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",1338],")",")",";",["T_WHITESPACE","\n\n\t\t\t",1338],["T_VARIABLE","$this",1340],["T_OBJECT_OPERATOR","->",1340],["T_STRING","session",1340],["T_OBJECT_OPERATOR","->",1340],["T_STRING","data",1340],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1340],"]",["T_WHITESPACE"," ",1340],"=",["T_WHITESPACE"," ",1340],["T_ARRAY","array",1340],"(",["T_WHITESPACE","\n\t\t\t\t",1340],["T_CONSTANT_ENCAPSED_STRING","'address_id'",1341],["T_WHITESPACE","\t ",1341],["T_DOUBLE_ARROW","=>",1341],["T_WHITESPACE"," ",1341],["T_STRING","null",1341],",",["T_WHITESPACE","\n\t\t\t\t",1341],["T_CONSTANT_ENCAPSED_STRING","'firstname'",1342],["T_WHITESPACE","\t\t ",1342],["T_DOUBLE_ARROW","=>",1342],["T_WHITESPACE"," ",1342],["T_STRING","null",1342],",",["T_WHITESPACE","\n\t\t\t\t",1342],["T_CONSTANT_ENCAPSED_STRING","'lastname'",1343],["T_WHITESPACE","\t\t ",1343],["T_DOUBLE_ARROW","=>",1343],["T_WHITESPACE"," ",1343],["T_STRING","null",1343],",",["T_WHITESPACE","\n\t\t\t\t",1343],["T_CONSTANT_ENCAPSED_STRING","'company'",1344],["T_WHITESPACE","\t\t ",1344],["T_DOUBLE_ARROW","=>",1344],["T_WHITESPACE"," ",1344],["T_STRING","null",1344],",",["T_WHITESPACE","\n\t\t\t\t",1344],["T_CONSTANT_ENCAPSED_STRING","'address_1'",1345],["T_WHITESPACE","\t\t ",1345],["T_DOUBLE_ARROW","=>",1345],["T_WHITESPACE"," ",1345],["T_STRING","null",1345],",",["T_WHITESPACE","\n\t\t\t\t",1345],["T_CONSTANT_ENCAPSED_STRING","'address_2'",1346],["T_WHITESPACE","\t\t ",1346],["T_DOUBLE_ARROW","=>",1346],["T_WHITESPACE"," ",1346],["T_STRING","null",1346],",",["T_WHITESPACE","\n\t\t\t\t",1346],["T_CONSTANT_ENCAPSED_STRING","'postcode'",1347],["T_WHITESPACE","\t\t ",1347],["T_DOUBLE_ARROW","=>",1347],["T_WHITESPACE"," ",1347],["T_STRING","null",1347],",",["T_WHITESPACE","\n\t\t\t\t",1347],["T_CONSTANT_ENCAPSED_STRING","'city'",1348],["T_WHITESPACE","\t\t\t ",1348],["T_DOUBLE_ARROW","=>",1348],["T_WHITESPACE"," ",1348],["T_STRING","null",1348],",",["T_WHITESPACE","\n\t\t\t\t",1348],["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1349],["T_WHITESPACE","\t\t ",1349],["T_DOUBLE_ARROW","=>",1349],["T_WHITESPACE"," ",1349],["T_VARIABLE","$zone_info",1349],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1349],"]",",",["T_WHITESPACE","\n\t\t\t\t",1349],["T_CONSTANT_ENCAPSED_STRING","'zone'",1350],["T_WHITESPACE","\t\t\t ",1350],["T_DOUBLE_ARROW","=>",1350],["T_WHITESPACE"," ",1350],["T_VARIABLE","$zone_info",1350],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1350],"]",",",["T_WHITESPACE","\n\t\t\t\t",1350],["T_CONSTANT_ENCAPSED_STRING","'zone_code'",1351],["T_WHITESPACE","\t\t ",1351],["T_DOUBLE_ARROW","=>",1351],["T_WHITESPACE"," ",1351],["T_VARIABLE","$zone_info",1351],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1351],"]",",",["T_WHITESPACE","\n\t\t\t\t",1351],["T_CONSTANT_ENCAPSED_STRING","'country_id'",1352],["T_WHITESPACE","\t ",1352],["T_DOUBLE_ARROW","=>",1352],["T_WHITESPACE"," ",1352],["T_VARIABLE","$country_info",1352],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1352],"]",",",["T_WHITESPACE","\n\t\t\t\t",1352],["T_CONSTANT_ENCAPSED_STRING","'country'",1353],["T_WHITESPACE","\t\t ",1353],["T_DOUBLE_ARROW","=>",1353],["T_WHITESPACE"," ",1353],["T_VARIABLE","$country_info",1353],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1353],"]",",",["T_WHITESPACE","\n\t\t\t\t",1353],["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1354],["T_WHITESPACE","\t ",1354],["T_DOUBLE_ARROW","=>",1354],["T_WHITESPACE"," ",1354],["T_VARIABLE","$country_info",1354],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1354],"]",",",["T_WHITESPACE","\n\t\t\t\t",1354],["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",1355],["T_WHITESPACE","\t ",1355],["T_DOUBLE_ARROW","=>",1355],["T_WHITESPACE"," ",1355],["T_VARIABLE","$country_info",1355],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",1355],"]",",",["T_WHITESPACE","\n\t\t\t\t",1355],["T_CONSTANT_ENCAPSED_STRING","'address_format'",1356],["T_WHITESPACE"," ",1356],["T_DOUBLE_ARROW","=>",1356],["T_WHITESPACE"," ",1356],["T_CONSTANT_ENCAPSED_STRING","''",1356],",",["T_WHITESPACE","\n\t\t\t\t",1356],["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1357],["T_WHITESPACE","\t ",1357],["T_DOUBLE_ARROW","=>",1357],["T_WHITESPACE"," ",1357],["T_ARRAY","array",1357],"(",")",["T_WHITESPACE","\n\t\t\t",1357],")",";",["T_WHITESPACE","\n\t\t",1358],"}",["T_WHITESPACE","\n\n\t\t",1359],["T_VARIABLE","$this",1361],["T_OBJECT_OPERATOR","->",1361],["T_STRING","tax",1361],["T_OBJECT_OPERATOR","->",1361],["T_STRING","setPaymentAddress",1361],"(",["T_VARIABLE","$this",1361],["T_OBJECT_OPERATOR","->",1361],["T_STRING","session",1361],["T_OBJECT_OPERATOR","->",1361],["T_STRING","data",1361],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1361],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1361],"]",",",["T_WHITESPACE"," ",1361],["T_VARIABLE","$this",1361],["T_OBJECT_OPERATOR","->",1361],["T_STRING","session",1361],["T_OBJECT_OPERATOR","->",1361],["T_STRING","data",1361],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1361],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1361],"]",")",";",["T_WHITESPACE","\n\t\t",1361],["T_VARIABLE","$this",1362],["T_OBJECT_OPERATOR","->",1362],["T_STRING","tax",1362],["T_OBJECT_OPERATOR","->",1362],["T_STRING","setStoreAddress",1362],"(",["T_VARIABLE","$this",1362],["T_OBJECT_OPERATOR","->",1362],["T_STRING","config",1362],["T_OBJECT_OPERATOR","->",1362],["T_STRING","get",1362],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",1362],")",",",["T_WHITESPACE"," ",1362],["T_VARIABLE","$this",1362],["T_OBJECT_OPERATOR","->",1362],["T_STRING","config",1362],["T_OBJECT_OPERATOR","->",1362],["T_STRING","get",1362],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",1362],")",")",";",["T_WHITESPACE","\n\t",1362],"}",["T_WHITESPACE","\n\n\t",1363],["T_PRIVATE","private",1365],["T_WHITESPACE"," ",1365],["T_FUNCTION","function",1365],["T_WHITESPACE"," ",1365],["T_STRING","setShipping",1365],"(",")",["T_WHITESPACE"," ",1365],"{",["T_WHITESPACE","\n\t\t",1365],["T_VARIABLE","$this",1366],["T_OBJECT_OPERATOR","->",1366],["T_STRING","load",1366],["T_OBJECT_OPERATOR","->",1366],["T_STRING","model",1366],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/address'",1366],")",";",["T_WHITESPACE","\n\t\t",1366],["T_VARIABLE","$this",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","load",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","model",1367],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/country'",1367],")",";",["T_WHITESPACE","\n\t\t",1367],["T_VARIABLE","$this",1368],["T_OBJECT_OPERATOR","->",1368],["T_STRING","load",1368],["T_OBJECT_OPERATOR","->",1368],["T_STRING","model",1368],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/zone'",1368],")",";",["T_WHITESPACE","\n\n\t\t",1368],["T_IF","if",1370],["T_WHITESPACE"," ",1370],"(",["T_ISSET","isset",1370],"(",["T_VARIABLE","$this",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","session",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","data",1370],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1370],"]",")",["T_WHITESPACE"," ",1370],["T_BOOLEAN_AND","&&",1370],["T_WHITESPACE"," ",1370],"!",["T_EMPTY","empty",1370],"(",["T_VARIABLE","$this",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","session",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","data",1370],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1370],"]",")",")",["T_WHITESPACE"," ",1370],"{",["T_WHITESPACE","\n\t\t\t",1370],["T_VARIABLE","$this",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","session",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","data",1371],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1371],"]",["T_WHITESPACE"," ",1371],"=",["T_WHITESPACE"," ",1371],["T_VARIABLE","$this",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","session",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","data",1371],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1371],"]",";",["T_WHITESPACE","\n\t\t",1371],"}",["T_WHITESPACE"," ",1372],["T_ELSEIF","elseif",1372],["T_WHITESPACE"," ",1372],"(",["T_VARIABLE","$this",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","customer",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","isLogged",1372],"(",")",["T_WHITESPACE"," ",1372],["T_BOOLEAN_AND","&&",1372],["T_WHITESPACE"," ",1372],["T_VARIABLE","$this",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","customer",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","getAddressId",1372],"(",")",")",["T_WHITESPACE"," ",1372],"{",["T_WHITESPACE","\n\t\t\t",1372],["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","session",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","data",1373],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1373],"]",["T_WHITESPACE"," ",1373],"=",["T_WHITESPACE"," ",1373],["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","model_account_address",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","getAddress",1373],"(",["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","customer",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","getAddressId",1373],"(",")",")",";",["T_WHITESPACE","\n\t\t",1373],"}",["T_WHITESPACE"," ",1374],["T_ELSE","else",1374],["T_WHITESPACE"," ",1374],"{",["T_WHITESPACE","\n\t\t\t",1374],["T_VARIABLE","$country_info",1375],["T_WHITESPACE"," ",1375],"=",["T_WHITESPACE"," ",1375],["T_VARIABLE","$this",1375],["T_OBJECT_OPERATOR","->",1375],["T_STRING","model_localisation_country",1375],["T_OBJECT_OPERATOR","->",1375],["T_STRING","getCountry",1375],"(",["T_VARIABLE","$this",1375],["T_OBJECT_OPERATOR","->",1375],["T_STRING","config",1375],["T_OBJECT_OPERATOR","->",1375],["T_STRING","get",1375],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",1375],")",")",";",["T_WHITESPACE","\n\n\t\t\t",1375],["T_VARIABLE","$zone_info",1377],["T_WHITESPACE"," ",1377],"=",["T_WHITESPACE"," ",1377],["T_VARIABLE","$this",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","model_localisation_zone",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","getZone",1377],"(",["T_VARIABLE","$this",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","config",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","get",1377],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",1377],")",")",";",["T_WHITESPACE","\n\n\t\t\t",1377],["T_VARIABLE","$this",1379],["T_OBJECT_OPERATOR","->",1379],["T_STRING","session",1379],["T_OBJECT_OPERATOR","->",1379],["T_STRING","data",1379],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1379],"]",["T_WHITESPACE"," ",1379],"=",["T_WHITESPACE"," ",1379],["T_ARRAY","array",1379],"(",["T_WHITESPACE","\n\t\t\t\t",1379],["T_CONSTANT_ENCAPSED_STRING","'address_id'",1380],["T_WHITESPACE","\t ",1380],["T_DOUBLE_ARROW","=>",1380],["T_WHITESPACE"," ",1380],["T_STRING","null",1380],",",["T_WHITESPACE","\n\t\t\t\t",1380],["T_CONSTANT_ENCAPSED_STRING","'firstname'",1381],["T_WHITESPACE","\t\t ",1381],["T_DOUBLE_ARROW","=>",1381],["T_WHITESPACE"," ",1381],["T_STRING","null",1381],",",["T_WHITESPACE","\n\t\t\t\t",1381],["T_CONSTANT_ENCAPSED_STRING","'lastname'",1382],["T_WHITESPACE","\t\t ",1382],["T_DOUBLE_ARROW","=>",1382],["T_WHITESPACE"," ",1382],["T_STRING","null",1382],",",["T_WHITESPACE","\n\t\t\t\t",1382],["T_CONSTANT_ENCAPSED_STRING","'company'",1383],["T_WHITESPACE","\t\t ",1383],["T_DOUBLE_ARROW","=>",1383],["T_WHITESPACE"," ",1383],["T_STRING","null",1383],",",["T_WHITESPACE","\n\t\t\t\t",1383],["T_CONSTANT_ENCAPSED_STRING","'address_1'",1384],["T_WHITESPACE","\t\t ",1384],["T_DOUBLE_ARROW","=>",1384],["T_WHITESPACE"," ",1384],["T_STRING","null",1384],",",["T_WHITESPACE","\n\t\t\t\t",1384],["T_CONSTANT_ENCAPSED_STRING","'address_2'",1385],["T_WHITESPACE","\t\t ",1385],["T_DOUBLE_ARROW","=>",1385],["T_WHITESPACE"," ",1385],["T_STRING","null",1385],",",["T_WHITESPACE","\n\t\t\t\t",1385],["T_CONSTANT_ENCAPSED_STRING","'postcode'",1386],["T_WHITESPACE","\t\t ",1386],["T_DOUBLE_ARROW","=>",1386],["T_WHITESPACE"," ",1386],["T_STRING","null",1386],",",["T_WHITESPACE","\n\t\t\t\t",1386],["T_CONSTANT_ENCAPSED_STRING","'city'",1387],["T_WHITESPACE","\t\t\t ",1387],["T_DOUBLE_ARROW","=>",1387],["T_WHITESPACE"," ",1387],["T_STRING","null",1387],",",["T_WHITESPACE","\n\t\t\t\t",1387],["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1388],["T_WHITESPACE","\t\t ",1388],["T_DOUBLE_ARROW","=>",1388],["T_WHITESPACE"," ",1388],["T_VARIABLE","$zone_info",1388],"[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1388],"]",",",["T_WHITESPACE","\n\t\t\t\t",1388],["T_CONSTANT_ENCAPSED_STRING","'zone'",1389],["T_WHITESPACE","\t\t\t ",1389],["T_DOUBLE_ARROW","=>",1389],["T_WHITESPACE"," ",1389],["T_VARIABLE","$zone_info",1389],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1389],"]",",",["T_WHITESPACE","\n\t\t\t\t",1389],["T_CONSTANT_ENCAPSED_STRING","'zone_code'",1390],["T_WHITESPACE","\t\t ",1390],["T_DOUBLE_ARROW","=>",1390],["T_WHITESPACE"," ",1390],["T_VARIABLE","$zone_info",1390],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1390],"]",",",["T_WHITESPACE","\n\t\t\t\t",1390],["T_CONSTANT_ENCAPSED_STRING","'country_id'",1391],["T_WHITESPACE","\t ",1391],["T_DOUBLE_ARROW","=>",1391],["T_WHITESPACE"," ",1391],["T_VARIABLE","$country_info",1391],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1391],"]",",",["T_WHITESPACE","\n\t\t\t\t",1391],["T_CONSTANT_ENCAPSED_STRING","'country'",1392],["T_WHITESPACE","\t\t ",1392],["T_DOUBLE_ARROW","=>",1392],["T_WHITESPACE"," ",1392],["T_VARIABLE","$country_info",1392],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1392],"]",",",["T_WHITESPACE","\n\t\t\t\t",1392],["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1393],["T_WHITESPACE","\t ",1393],["T_DOUBLE_ARROW","=>",1393],["T_WHITESPACE"," ",1393],["T_VARIABLE","$country_info",1393],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1393],"]",",",["T_WHITESPACE","\n\t\t\t\t",1393],["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",1394],["T_WHITESPACE","\t ",1394],["T_DOUBLE_ARROW","=>",1394],["T_WHITESPACE"," ",1394],["T_VARIABLE","$country_info",1394],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_3'",1394],"]",",",["T_WHITESPACE","\n\t\t\t\t",1394],["T_CONSTANT_ENCAPSED_STRING","'address_format'",1395],["T_WHITESPACE"," ",1395],["T_DOUBLE_ARROW","=>",1395],["T_WHITESPACE"," ",1395],["T_CONSTANT_ENCAPSED_STRING","''",1395],",",["T_WHITESPACE","\n\t\t\t\t",1395],["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1396],["T_WHITESPACE","\t ",1396],["T_DOUBLE_ARROW","=>",1396],["T_WHITESPACE"," ",1396],["T_ARRAY","array",1396],"(",")",["T_WHITESPACE","\n\t\t\t",1396],")",";",["T_WHITESPACE","\n\t\t",1397],"}",["T_WHITESPACE","\n\n\t\t",1398],["T_VARIABLE","$this",1400],["T_OBJECT_OPERATOR","->",1400],["T_STRING","tax",1400],["T_OBJECT_OPERATOR","->",1400],["T_STRING","unsetRates",1400],"(",")",";",["T_WHITESPACE","\n\t\t",1400],["T_VARIABLE","$this",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","tax",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","setShippingAddress",1401],"(",["T_VARIABLE","$this",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","session",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","data",1401],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1401],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1401],"]",",",["T_WHITESPACE"," ",1401],["T_VARIABLE","$this",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","session",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","data",1401],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1401],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1401],"]",")",";",["T_WHITESPACE","\n\t\t",1401],["T_VARIABLE","$this",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","tax",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","setStoreAddress",1402],"(",["T_VARIABLE","$this",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","config",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","get",1402],"(",["T_CONSTANT_ENCAPSED_STRING","'config_country_id'",1402],")",",",["T_WHITESPACE"," ",1402],["T_VARIABLE","$this",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","config",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","get",1402],"(",["T_CONSTANT_ENCAPSED_STRING","'config_zone_id'",1402],")",")",";",["T_WHITESPACE","\n\n\t\t",1402],["T_IF","if",1404],["T_WHITESPACE"," ",1404],"(",["T_ISSET","isset",1404],"(",["T_VARIABLE","$this",1404],["T_OBJECT_OPERATOR","->",1404],["T_STRING","session",1404],["T_OBJECT_OPERATOR","->",1404],["T_STRING","data",1404],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1404],"]",")",")",["T_WHITESPACE"," ",1404],"{",["T_WHITESPACE","\n\t\t\t",1404],["T_COMMENT","\/\/ Shipping Methods\n",1405],["T_WHITESPACE","\t\t\t",1406],["T_VARIABLE","$method_data",1406],["T_WHITESPACE"," ",1406],"=",["T_WHITESPACE"," ",1406],["T_ARRAY","array",1406],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",1406],["T_VARIABLE","$this",1408],["T_OBJECT_OPERATOR","->",1408],["T_STRING","load",1408],["T_OBJECT_OPERATOR","->",1408],["T_STRING","model",1408],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/extension'",1408],")",";",["T_WHITESPACE","\n\n\t\t\t",1408],["T_VARIABLE","$results",1410],["T_WHITESPACE"," ",1410],"=",["T_WHITESPACE"," ",1410],["T_VARIABLE","$this",1410],["T_OBJECT_OPERATOR","->",1410],["T_STRING","model_extension_extension",1410],["T_OBJECT_OPERATOR","->",1410],["T_STRING","getExtensions",1410],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",1410],")",";",["T_WHITESPACE","\n\n\t\t\t",1410],["T_FOREACH","foreach",1412],["T_WHITESPACE"," ",1412],"(",["T_VARIABLE","$results",1412],["T_WHITESPACE"," ",1412],["T_AS","as",1412],["T_WHITESPACE"," ",1412],["T_VARIABLE","$result",1412],")",["T_WHITESPACE"," ",1412],"{",["T_WHITESPACE","\n\t\t\t\t",1412],["T_IF","if",1413],["T_WHITESPACE"," ",1413],"(",["T_VARIABLE","$this",1413],["T_OBJECT_OPERATOR","->",1413],["T_STRING","config",1413],["T_OBJECT_OPERATOR","->",1413],["T_STRING","get",1413],"(",["T_VARIABLE","$result",1413],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1413],"]",["T_WHITESPACE"," ",1413],".",["T_WHITESPACE"," ",1413],["T_CONSTANT_ENCAPSED_STRING","'_status'",1413],")",")",["T_WHITESPACE"," ",1413],"{",["T_WHITESPACE","\n\t\t\t\t\t",1413],["T_VARIABLE","$this",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","load",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","model",1414],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/shipping\/'",1414],["T_WHITESPACE"," ",1414],".",["T_WHITESPACE"," ",1414],["T_VARIABLE","$result",1414],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1414],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1414],["T_VARIABLE","$quote",1416],["T_WHITESPACE"," ",1416],"=",["T_WHITESPACE"," ",1416],["T_VARIABLE","$this",1416],["T_OBJECT_OPERATOR","->",1416],"{",["T_CONSTANT_ENCAPSED_STRING","'model_extension_shipping_'",1416],["T_WHITESPACE"," ",1416],".",["T_WHITESPACE"," ",1416],["T_VARIABLE","$result",1416],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1416],"]","}",["T_OBJECT_OPERATOR","->",1416],["T_STRING","getQuote",1416],"(",["T_VARIABLE","$this",1416],["T_OBJECT_OPERATOR","->",1416],["T_STRING","session",1416],["T_OBJECT_OPERATOR","->",1416],["T_STRING","data",1416],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1416],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1416],["T_IF","if",1418],["T_WHITESPACE"," ",1418],"(",["T_VARIABLE","$quote",1418],")",["T_WHITESPACE"," ",1418],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1418],["T_VARIABLE","$method_data",1419],"[",["T_VARIABLE","$result",1419],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1419],"]","]",["T_WHITESPACE"," ",1419],"=",["T_WHITESPACE"," ",1419],["T_ARRAY","array",1419],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1419],["T_CONSTANT_ENCAPSED_STRING","'title'",1420],["T_WHITESPACE","      ",1420],["T_DOUBLE_ARROW","=>",1420],["T_WHITESPACE"," ",1420],["T_VARIABLE","$quote",1420],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",1420],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1420],["T_CONSTANT_ENCAPSED_STRING","'quote'",1421],["T_WHITESPACE","      ",1421],["T_DOUBLE_ARROW","=>",1421],["T_WHITESPACE"," ",1421],["T_VARIABLE","$quote",1421],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",1421],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1421],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",1422],["T_WHITESPACE"," ",1422],["T_DOUBLE_ARROW","=>",1422],["T_WHITESPACE"," ",1422],["T_VARIABLE","$quote",1422],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",1422],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1422],["T_CONSTANT_ENCAPSED_STRING","'error'",1423],["T_WHITESPACE","      ",1423],["T_DOUBLE_ARROW","=>",1423],["T_WHITESPACE"," ",1423],["T_VARIABLE","$quote",1423],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",1423],"]",["T_WHITESPACE","\n\t\t\t\t\t\t",1423],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1424],"}",["T_WHITESPACE","\n\t\t\t\t",1425],"}",["T_WHITESPACE","\n\t\t\t",1426],"}",["T_WHITESPACE","\n\n\t\t\t",1427],["T_VARIABLE","$sort_order",1429],["T_WHITESPACE"," ",1429],"=",["T_WHITESPACE"," ",1429],["T_ARRAY","array",1429],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",1429],["T_FOREACH","foreach",1431],["T_WHITESPACE"," ",1431],"(",["T_VARIABLE","$method_data",1431],["T_WHITESPACE"," ",1431],["T_AS","as",1431],["T_WHITESPACE"," ",1431],["T_VARIABLE","$key",1431],["T_WHITESPACE"," ",1431],["T_DOUBLE_ARROW","=>",1431],["T_WHITESPACE"," ",1431],["T_VARIABLE","$value",1431],")",["T_WHITESPACE"," ",1431],"{",["T_WHITESPACE","\n\t\t\t\t",1431],["T_VARIABLE","$sort_order",1432],"[",["T_VARIABLE","$key",1432],"]",["T_WHITESPACE"," ",1432],"=",["T_WHITESPACE"," ",1432],["T_VARIABLE","$value",1432],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",1432],"]",";",["T_WHITESPACE","\n\t\t\t",1432],"}",["T_WHITESPACE","\n\n\t\t\t",1433],["T_STRING","array_multisort",1435],"(",["T_VARIABLE","$sort_order",1435],",",["T_WHITESPACE"," ",1435],["T_STRING","SORT_ASC",1435],",",["T_WHITESPACE"," ",1435],["T_VARIABLE","$method_data",1435],")",";",["T_WHITESPACE","\n\n\t\t\t",1435],["T_VARIABLE","$this",1437],["T_OBJECT_OPERATOR","->",1437],["T_STRING","session",1437],["T_OBJECT_OPERATOR","->",1437],["T_STRING","data",1437],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1437],"]",["T_WHITESPACE"," ",1437],"=",["T_WHITESPACE"," ",1437],["T_VARIABLE","$method_data",1437],";",["T_WHITESPACE","\n\t\t",1437],"}",["T_WHITESPACE","\n\t",1438],"}",["T_WHITESPACE","\n\n\t",1439],["T_PRIVATE","private",1441],["T_WHITESPACE"," ",1441],["T_FUNCTION","function",1441],["T_WHITESPACE"," ",1441],["T_STRING","createOrder",1441],"(",")",["T_WHITESPACE"," ",1441],"{",["T_WHITESPACE","\n\t\t",1441],["T_COMMENT","\/\/Klarna defaults:\n",1442],["T_WHITESPACE","\t\t",1443],["T_VARIABLE","$this",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","session",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","data",1443],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",1443],"]",["T_WHITESPACE"," ",1443],"=",["T_WHITESPACE"," ",1443],["T_CONSTANT_ENCAPSED_STRING","''",1443],";",["T_WHITESPACE","\n\n\t\t",1443],["T_IF","if",1445],["T_WHITESPACE"," ",1445],"(","!",["T_VARIABLE","$this",1445],["T_OBJECT_OPERATOR","->",1445],["T_STRING","customer",1445],["T_OBJECT_OPERATOR","->",1445],["T_STRING","isLogged",1445],"(",")",")",["T_WHITESPACE"," ",1445],"{",["T_WHITESPACE","\n\t\t\t",1445],["T_VARIABLE","$this",1446],["T_OBJECT_OPERATOR","->",1446],["T_STRING","session",1446],["T_OBJECT_OPERATOR","->",1446],["T_STRING","data",1446],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1446],"]",["T_WHITESPACE"," ",1446],"=",["T_WHITESPACE"," ",1446],["T_ARRAY","array",1446],"(",["T_WHITESPACE","\n\t\t\t\t",1446],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1447],["T_WHITESPACE"," ",1447],["T_DOUBLE_ARROW","=>",1447],["T_WHITESPACE"," ",1447],["T_VARIABLE","$this",1447],["T_OBJECT_OPERATOR","->",1447],["T_STRING","config",1447],["T_OBJECT_OPERATOR","->",1447],["T_STRING","get",1447],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_group_id'",1447],")",",",["T_WHITESPACE","\n\t\t\t\t",1447],["T_CONSTANT_ENCAPSED_STRING","'firstname'",1448],["T_WHITESPACE","\t\t\t",1448],["T_DOUBLE_ARROW","=>",1448],["T_WHITESPACE"," ",1448],["T_CONSTANT_ENCAPSED_STRING","''",1448],",",["T_WHITESPACE","\n\t\t\t\t",1448],["T_CONSTANT_ENCAPSED_STRING","'lastname'",1449],["T_WHITESPACE","\t\t\t",1449],["T_DOUBLE_ARROW","=>",1449],["T_WHITESPACE"," ",1449],["T_CONSTANT_ENCAPSED_STRING","''",1449],",",["T_WHITESPACE","\n\t\t\t\t",1449],["T_CONSTANT_ENCAPSED_STRING","'email'",1450],["T_WHITESPACE","\t\t\t\t",1450],["T_DOUBLE_ARROW","=>",1450],["T_WHITESPACE"," ",1450],["T_CONSTANT_ENCAPSED_STRING","''",1450],",",["T_WHITESPACE","\n\t\t\t\t",1450],["T_CONSTANT_ENCAPSED_STRING","'telephone'",1451],["T_WHITESPACE","\t\t\t",1451],["T_DOUBLE_ARROW","=>",1451],["T_WHITESPACE"," ",1451],["T_CONSTANT_ENCAPSED_STRING","''",1451],",",["T_WHITESPACE","\n\t\t\t\t",1451],["T_CONSTANT_ENCAPSED_STRING","'fax'",1452],["T_WHITESPACE","\t\t\t\t",1452],["T_DOUBLE_ARROW","=>",1452],["T_WHITESPACE"," ",1452],["T_CONSTANT_ENCAPSED_STRING","''",1452],",",["T_WHITESPACE","\n\t\t\t\t",1452],["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1453],["T_WHITESPACE","\t\t",1453],["T_DOUBLE_ARROW","=>",1453],["T_WHITESPACE"," ",1453],["T_ARRAY","array",1453],"(",")",",",["T_WHITESPACE","\n\t\t\t",1453],")",";",["T_WHITESPACE","\n\t\t",1454],"}",["T_WHITESPACE","\n\n\t\t",1455],["T_COMMENT","\/\/OpenCart:\n",1457],["T_WHITESPACE","\t\t",1458],["T_VARIABLE","$order_data",1458],["T_WHITESPACE"," ",1458],"=",["T_WHITESPACE"," ",1458],["T_ARRAY","array",1458],"(",")",";",["T_WHITESPACE","\n\n\t\t",1458],["T_LIST","list",1460],"(",["T_VARIABLE","$totals",1460],",",["T_WHITESPACE"," ",1460],["T_VARIABLE","$taxes",1460],",",["T_WHITESPACE"," ",1460],["T_VARIABLE","$total",1460],")",["T_WHITESPACE"," ",1460],"=",["T_WHITESPACE"," ",1460],["T_VARIABLE","$this",1460],["T_OBJECT_OPERATOR","->",1460],["T_STRING","model_extension_payment_klarna_checkout",1460],["T_OBJECT_OPERATOR","->",1460],["T_STRING","getTotals",1460],"(",")",";",["T_WHITESPACE","\n\n\t\t",1460],["T_VARIABLE","$order_data",1462],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",1462],"]",["T_WHITESPACE"," ",1462],"=",["T_WHITESPACE"," ",1462],["T_VARIABLE","$totals",1462],";",["T_WHITESPACE","\n\n\t\t",1462],["T_VARIABLE","$this",1464],["T_OBJECT_OPERATOR","->",1464],["T_STRING","load",1464],["T_OBJECT_OPERATOR","->",1464],["T_STRING","language",1464],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",1464],")",";",["T_WHITESPACE","\n\n\t\t",1464],["T_VARIABLE","$order_data",1466],"[",["T_CONSTANT_ENCAPSED_STRING","'invoice_prefix'",1466],"]",["T_WHITESPACE"," ",1466],"=",["T_WHITESPACE"," ",1466],["T_VARIABLE","$this",1466],["T_OBJECT_OPERATOR","->",1466],["T_STRING","config",1466],["T_OBJECT_OPERATOR","->",1466],["T_STRING","get",1466],"(",["T_CONSTANT_ENCAPSED_STRING","'config_invoice_prefix'",1466],")",";",["T_WHITESPACE","\n\t\t",1466],["T_VARIABLE","$order_data",1467],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",1467],"]",["T_WHITESPACE"," ",1467],"=",["T_WHITESPACE"," ",1467],["T_VARIABLE","$this",1467],["T_OBJECT_OPERATOR","->",1467],["T_STRING","config",1467],["T_OBJECT_OPERATOR","->",1467],["T_STRING","get",1467],"(",["T_CONSTANT_ENCAPSED_STRING","'config_store_id'",1467],")",";",["T_WHITESPACE","\n\t\t",1467],["T_VARIABLE","$order_data",1468],"[",["T_CONSTANT_ENCAPSED_STRING","'store_name'",1468],"]",["T_WHITESPACE"," ",1468],"=",["T_WHITESPACE"," ",1468],["T_VARIABLE","$this",1468],["T_OBJECT_OPERATOR","->",1468],["T_STRING","config",1468],["T_OBJECT_OPERATOR","->",1468],["T_STRING","get",1468],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",1468],")",";",["T_WHITESPACE","\n\n\t\t",1468],["T_IF","if",1470],["T_WHITESPACE"," ",1470],"(",["T_VARIABLE","$order_data",1470],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",1470],"]",")",["T_WHITESPACE"," ",1470],"{",["T_WHITESPACE","\n\t\t\t",1470],["T_VARIABLE","$order_data",1471],"[",["T_CONSTANT_ENCAPSED_STRING","'store_url'",1471],"]",["T_WHITESPACE"," ",1471],"=",["T_WHITESPACE"," ",1471],["T_VARIABLE","$this",1471],["T_OBJECT_OPERATOR","->",1471],["T_STRING","config",1471],["T_OBJECT_OPERATOR","->",1471],["T_STRING","get",1471],"(",["T_CONSTANT_ENCAPSED_STRING","'config_url'",1471],")",";",["T_WHITESPACE","\n\t\t",1471],"}",["T_WHITESPACE"," ",1472],["T_ELSE","else",1472],["T_WHITESPACE"," ",1472],"{",["T_WHITESPACE","\n\t\t\t",1472],["T_VARIABLE","$order_data",1473],"[",["T_CONSTANT_ENCAPSED_STRING","'store_url'",1473],"]",["T_WHITESPACE"," ",1473],"=",["T_WHITESPACE"," ",1473],["T_STRING","HTTP_SERVER",1473],";",["T_WHITESPACE","\n\t\t",1473],"}",["T_WHITESPACE","\n\n\t\t",1474],["T_IF","if",1476],["T_WHITESPACE"," ",1476],"(",["T_VARIABLE","$this",1476],["T_OBJECT_OPERATOR","->",1476],["T_STRING","customer",1476],["T_OBJECT_OPERATOR","->",1476],["T_STRING","isLogged",1476],"(",")",")",["T_WHITESPACE"," ",1476],"{",["T_WHITESPACE","\n\t\t\t",1476],["T_VARIABLE","$this",1477],["T_OBJECT_OPERATOR","->",1477],["T_STRING","load",1477],["T_OBJECT_OPERATOR","->",1477],["T_STRING","model",1477],"(",["T_CONSTANT_ENCAPSED_STRING","'account\/customer'",1477],")",";",["T_WHITESPACE","\n\n\t\t\t",1477],["T_VARIABLE","$customer_info",1479],["T_WHITESPACE"," ",1479],"=",["T_WHITESPACE"," ",1479],["T_VARIABLE","$this",1479],["T_OBJECT_OPERATOR","->",1479],["T_STRING","model_account_customer",1479],["T_OBJECT_OPERATOR","->",1479],["T_STRING","getCustomer",1479],"(",["T_VARIABLE","$this",1479],["T_OBJECT_OPERATOR","->",1479],["T_STRING","customer",1479],["T_OBJECT_OPERATOR","->",1479],["T_STRING","getId",1479],"(",")",")",";",["T_WHITESPACE","\n\n\t\t\t",1479],["T_VARIABLE","$order_data",1481],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",1481],"]",["T_WHITESPACE"," ",1481],"=",["T_WHITESPACE"," ",1481],["T_VARIABLE","$this",1481],["T_OBJECT_OPERATOR","->",1481],["T_STRING","customer",1481],["T_OBJECT_OPERATOR","->",1481],["T_STRING","getId",1481],"(",")",";",["T_WHITESPACE","\n\t\t\t",1481],["T_VARIABLE","$order_data",1482],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1482],"]",["T_WHITESPACE"," ",1482],"=",["T_WHITESPACE"," ",1482],["T_VARIABLE","$customer_info",1482],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1482],"]",";",["T_WHITESPACE","\n\t\t\t",1482],["T_VARIABLE","$order_data",1483],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1483],"]",["T_WHITESPACE"," ",1483],"=",["T_WHITESPACE"," ",1483],["T_VARIABLE","$customer_info",1483],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1483],"]",";",["T_WHITESPACE","\n\t\t\t",1483],["T_VARIABLE","$order_data",1484],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1484],"]",["T_WHITESPACE"," ",1484],"=",["T_WHITESPACE"," ",1484],["T_VARIABLE","$customer_info",1484],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1484],"]",";",["T_WHITESPACE","\n\t\t\t",1484],["T_VARIABLE","$order_data",1485],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",1485],"]",["T_WHITESPACE"," ",1485],"=",["T_WHITESPACE"," ",1485],["T_VARIABLE","$customer_info",1485],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",1485],"]",";",["T_WHITESPACE","\n\t\t\t",1485],["T_VARIABLE","$order_data",1486],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",1486],"]",["T_WHITESPACE"," ",1486],"=",["T_WHITESPACE"," ",1486],["T_VARIABLE","$customer_info",1486],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",1486],"]",";",["T_WHITESPACE","\n\t\t\t",1486],["T_VARIABLE","$order_data",1487],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",1487],"]",["T_WHITESPACE"," ",1487],"=",["T_WHITESPACE"," ",1487],["T_VARIABLE","$customer_info",1487],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",1487],"]",";",["T_WHITESPACE","\n\t\t\t",1487],["T_VARIABLE","$order_data",1488],"[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1488],"]",["T_WHITESPACE"," ",1488],"=",["T_WHITESPACE"," ",1488],["T_STRING","json_decode",1488],"(",["T_VARIABLE","$customer_info",1488],"[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1488],"]",",",["T_WHITESPACE"," ",1488],["T_STRING","true",1488],")",";",["T_WHITESPACE","\n\t\t",1488],"}",["T_WHITESPACE"," ",1489],["T_ELSEIF","elseif",1489],["T_WHITESPACE"," ",1489],"(",["T_ISSET","isset",1489],"(",["T_VARIABLE","$this",1489],["T_OBJECT_OPERATOR","->",1489],["T_STRING","session",1489],["T_OBJECT_OPERATOR","->",1489],["T_STRING","data",1489],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1489],"]",")",")",["T_WHITESPACE"," ",1489],"{",["T_WHITESPACE","\n\t\t\t",1489],["T_VARIABLE","$order_data",1490],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",1490],"]",["T_WHITESPACE"," ",1490],"=",["T_WHITESPACE"," ",1490],["T_LNUMBER","0",1490],";",["T_WHITESPACE","\n\t\t\t",1490],["T_VARIABLE","$order_data",1491],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1491],"]",["T_WHITESPACE"," ",1491],"=",["T_WHITESPACE"," ",1491],["T_VARIABLE","$this",1491],["T_OBJECT_OPERATOR","->",1491],["T_STRING","session",1491],["T_OBJECT_OPERATOR","->",1491],["T_STRING","data",1491],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1491],"]","[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1491],"]",";",["T_WHITESPACE","\n\t\t\t",1491],["T_VARIABLE","$order_data",1492],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1492],"]",["T_WHITESPACE"," ",1492],"=",["T_WHITESPACE"," ",1492],["T_VARIABLE","$this",1492],["T_OBJECT_OPERATOR","->",1492],["T_STRING","session",1492],["T_OBJECT_OPERATOR","->",1492],["T_STRING","data",1492],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1492],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1492],"]",";",["T_WHITESPACE","\n\t\t\t",1492],["T_VARIABLE","$order_data",1493],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1493],"]",["T_WHITESPACE"," ",1493],"=",["T_WHITESPACE"," ",1493],["T_VARIABLE","$this",1493],["T_OBJECT_OPERATOR","->",1493],["T_STRING","session",1493],["T_OBJECT_OPERATOR","->",1493],["T_STRING","data",1493],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1493],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1493],"]",";",["T_WHITESPACE","\n\t\t\t",1493],["T_VARIABLE","$order_data",1494],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",1494],"]",["T_WHITESPACE"," ",1494],"=",["T_WHITESPACE"," ",1494],["T_VARIABLE","$this",1494],["T_OBJECT_OPERATOR","->",1494],["T_STRING","session",1494],["T_OBJECT_OPERATOR","->",1494],["T_STRING","data",1494],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1494],"]","[",["T_CONSTANT_ENCAPSED_STRING","'email'",1494],"]",";",["T_WHITESPACE","\n\t\t\t",1494],["T_VARIABLE","$order_data",1495],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",1495],"]",["T_WHITESPACE"," ",1495],"=",["T_WHITESPACE"," ",1495],["T_VARIABLE","$this",1495],["T_OBJECT_OPERATOR","->",1495],["T_STRING","session",1495],["T_OBJECT_OPERATOR","->",1495],["T_STRING","data",1495],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1495],"]","[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",1495],"]",";",["T_WHITESPACE","\n\t\t\t",1495],["T_VARIABLE","$order_data",1496],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",1496],"]",["T_WHITESPACE"," ",1496],"=",["T_WHITESPACE"," ",1496],["T_VARIABLE","$this",1496],["T_OBJECT_OPERATOR","->",1496],["T_STRING","session",1496],["T_OBJECT_OPERATOR","->",1496],["T_STRING","data",1496],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1496],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fax'",1496],"]",";",["T_WHITESPACE","\n\t\t\t",1496],["T_VARIABLE","$order_data",1497],"[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1497],"]",["T_WHITESPACE"," ",1497],"=",["T_WHITESPACE"," ",1497],["T_VARIABLE","$this",1497],["T_OBJECT_OPERATOR","->",1497],["T_STRING","session",1497],["T_OBJECT_OPERATOR","->",1497],["T_STRING","data",1497],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",1497],"]","[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1497],"]",";",["T_WHITESPACE","\n\t\t",1497],"}",["T_WHITESPACE","\n\n\t\t",1498],["T_VARIABLE","$order_data",1500],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",1500],"]",["T_WHITESPACE"," ",1500],"=",["T_WHITESPACE"," ",1500],["T_VARIABLE","$this",1500],["T_OBJECT_OPERATOR","->",1500],["T_STRING","session",1500],["T_OBJECT_OPERATOR","->",1500],["T_STRING","data",1500],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1500],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1500],"]",";",["T_WHITESPACE","\n\t\t",1500],["T_VARIABLE","$order_data",1501],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",1501],"]",["T_WHITESPACE"," ",1501],"=",["T_WHITESPACE"," ",1501],["T_VARIABLE","$this",1501],["T_OBJECT_OPERATOR","->",1501],["T_STRING","session",1501],["T_OBJECT_OPERATOR","->",1501],["T_STRING","data",1501],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1501],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1501],"]",";",["T_WHITESPACE","\n\t\t",1501],["T_VARIABLE","$order_data",1502],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_company'",1502],"]",["T_WHITESPACE"," ",1502],"=",["T_WHITESPACE"," ",1502],["T_VARIABLE","$this",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","session",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","data",1502],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1502],"]","[",["T_CONSTANT_ENCAPSED_STRING","'company'",1502],"]",";",["T_WHITESPACE","\n\t\t",1502],["T_VARIABLE","$order_data",1503],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",1503],"]",["T_WHITESPACE"," ",1503],"=",["T_WHITESPACE"," ",1503],["T_VARIABLE","$this",1503],["T_OBJECT_OPERATOR","->",1503],["T_STRING","session",1503],["T_OBJECT_OPERATOR","->",1503],["T_STRING","data",1503],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1503],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address_1'",1503],"]",";",["T_WHITESPACE","\n\t\t",1503],["T_VARIABLE","$order_data",1504],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",1504],"]",["T_WHITESPACE"," ",1504],"=",["T_WHITESPACE"," ",1504],["T_VARIABLE","$this",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","session",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","data",1504],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1504],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address_2'",1504],"]",";",["T_WHITESPACE","\n\t\t",1504],["T_VARIABLE","$order_data",1505],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",1505],"]",["T_WHITESPACE"," ",1505],"=",["T_WHITESPACE"," ",1505],["T_VARIABLE","$this",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","session",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","data",1505],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1505],"]","[",["T_CONSTANT_ENCAPSED_STRING","'city'",1505],"]",";",["T_WHITESPACE","\n\t\t",1505],["T_VARIABLE","$order_data",1506],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",1506],"]",["T_WHITESPACE"," ",1506],"=",["T_WHITESPACE"," ",1506],["T_VARIABLE","$this",1506],["T_OBJECT_OPERATOR","->",1506],["T_STRING","session",1506],["T_OBJECT_OPERATOR","->",1506],["T_STRING","data",1506],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1506],"]","[",["T_CONSTANT_ENCAPSED_STRING","'postcode'",1506],"]",";",["T_WHITESPACE","\n\t\t",1506],["T_VARIABLE","$order_data",1507],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",1507],"]",["T_WHITESPACE"," ",1507],"=",["T_WHITESPACE"," ",1507],["T_VARIABLE","$this",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","session",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","data",1507],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1507],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone'",1507],"]",";",["T_WHITESPACE","\n\t\t",1507],["T_VARIABLE","$order_data",1508],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",1508],"]",["T_WHITESPACE"," ",1508],"=",["T_WHITESPACE"," ",1508],["T_VARIABLE","$this",1508],["T_OBJECT_OPERATOR","->",1508],["T_STRING","session",1508],["T_OBJECT_OPERATOR","->",1508],["T_STRING","data",1508],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1508],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1508],"]",";",["T_WHITESPACE","\n\t\t",1508],["T_VARIABLE","$order_data",1509],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country'",1509],"]",["T_WHITESPACE"," ",1509],"=",["T_WHITESPACE"," ",1509],["T_VARIABLE","$this",1509],["T_OBJECT_OPERATOR","->",1509],["T_STRING","session",1509],["T_OBJECT_OPERATOR","->",1509],["T_STRING","data",1509],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1509],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country'",1509],"]",";",["T_WHITESPACE","\n\t\t",1509],["T_VARIABLE","$order_data",1510],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",1510],"]",["T_WHITESPACE"," ",1510],"=",["T_WHITESPACE"," ",1510],["T_VARIABLE","$this",1510],["T_OBJECT_OPERATOR","->",1510],["T_STRING","session",1510],["T_OBJECT_OPERATOR","->",1510],["T_STRING","data",1510],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1510],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1510],"]",";",["T_WHITESPACE","\n\t\t",1510],["T_VARIABLE","$order_data",1511],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_format'",1511],"]",["T_WHITESPACE"," ",1511],"=",["T_WHITESPACE"," ",1511],["T_VARIABLE","$this",1511],["T_OBJECT_OPERATOR","->",1511],["T_STRING","session",1511],["T_OBJECT_OPERATOR","->",1511],["T_STRING","data",1511],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1511],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",1511],"]",";",["T_WHITESPACE","\n\t\t",1511],["T_VARIABLE","$order_data",1512],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_custom_field'",1512],"]",["T_WHITESPACE"," ",1512],"=",["T_WHITESPACE"," ",1512],"(",["T_ISSET","isset",1512],"(",["T_VARIABLE","$this",1512],["T_OBJECT_OPERATOR","->",1512],["T_STRING","session",1512],["T_OBJECT_OPERATOR","->",1512],["T_STRING","data",1512],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1512],"]","[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1512],"]",")",["T_WHITESPACE"," ",1512],"?",["T_WHITESPACE"," ",1512],["T_VARIABLE","$this",1512],["T_OBJECT_OPERATOR","->",1512],["T_STRING","session",1512],["T_OBJECT_OPERATOR","->",1512],["T_STRING","data",1512],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address'",1512],"]","[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1512],"]",["T_WHITESPACE"," ",1512],":",["T_WHITESPACE"," ",1512],["T_ARRAY","array",1512],"(",")",")",";",["T_WHITESPACE","\n\n\t\t",1512],["T_IF","if",1514],["T_WHITESPACE"," ",1514],"(",["T_ISSET","isset",1514],"(",["T_VARIABLE","$this",1514],["T_OBJECT_OPERATOR","->",1514],["T_STRING","session",1514],["T_OBJECT_OPERATOR","->",1514],["T_STRING","data",1514],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1514],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",1514],"]",")",")",["T_WHITESPACE"," ",1514],"{",["T_WHITESPACE","\n\t\t\t",1514],["T_VARIABLE","$order_data",1515],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1515],"]",["T_WHITESPACE"," ",1515],"=",["T_WHITESPACE"," ",1515],["T_VARIABLE","$this",1515],["T_OBJECT_OPERATOR","->",1515],["T_STRING","session",1515],["T_OBJECT_OPERATOR","->",1515],["T_STRING","data",1515],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1515],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",1515],"]",";",["T_WHITESPACE","\n\t\t",1515],"}",["T_WHITESPACE"," ",1516],["T_ELSE","else",1516],["T_WHITESPACE"," ",1516],"{",["T_WHITESPACE","\n\t\t\t",1516],["T_VARIABLE","$order_data",1517],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1517],"]",["T_WHITESPACE"," ",1517],"=",["T_WHITESPACE"," ",1517],["T_CONSTANT_ENCAPSED_STRING","''",1517],";",["T_WHITESPACE","\n\t\t",1517],"}",["T_WHITESPACE","\n\n\t\t",1518],["T_IF","if",1520],["T_WHITESPACE"," ",1520],"(",["T_ISSET","isset",1520],"(",["T_VARIABLE","$this",1520],["T_OBJECT_OPERATOR","->",1520],["T_STRING","session",1520],["T_OBJECT_OPERATOR","->",1520],["T_STRING","data",1520],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1520],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",1520],"]",")",")",["T_WHITESPACE"," ",1520],"{",["T_WHITESPACE","\n\t\t\t",1520],["T_VARIABLE","$order_data",1521],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_code'",1521],"]",["T_WHITESPACE"," ",1521],"=",["T_WHITESPACE"," ",1521],["T_VARIABLE","$this",1521],["T_OBJECT_OPERATOR","->",1521],["T_STRING","session",1521],["T_OBJECT_OPERATOR","->",1521],["T_STRING","data",1521],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",1521],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",1521],"]",";",["T_WHITESPACE","\n\t\t",1521],"}",["T_WHITESPACE"," ",1522],["T_ELSE","else",1522],["T_WHITESPACE"," ",1522],"{",["T_WHITESPACE","\n\t\t\t",1522],["T_VARIABLE","$order_data",1523],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_code'",1523],"]",["T_WHITESPACE"," ",1523],"=",["T_WHITESPACE"," ",1523],["T_CONSTANT_ENCAPSED_STRING","''",1523],";",["T_WHITESPACE","\n\t\t",1523],"}",["T_WHITESPACE","\n\n\t\t",1524],["T_IF","if",1526],["T_WHITESPACE"," ",1526],"(",["T_VARIABLE","$this",1526],["T_OBJECT_OPERATOR","->",1526],["T_STRING","cart",1526],["T_OBJECT_OPERATOR","->",1526],["T_STRING","hasShipping",1526],"(",")",")",["T_WHITESPACE"," ",1526],"{",["T_WHITESPACE","\n\t\t\t",1526],["T_VARIABLE","$order_data",1527],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",1527],"]",["T_WHITESPACE"," ",1527],"=",["T_WHITESPACE"," ",1527],["T_VARIABLE","$this",1527],["T_OBJECT_OPERATOR","->",1527],["T_STRING","session",1527],["T_OBJECT_OPERATOR","->",1527],["T_STRING","data",1527],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1527],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1527],"]",";",["T_WHITESPACE","\n\t\t\t",1527],["T_VARIABLE","$order_data",1528],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",1528],"]",["T_WHITESPACE"," ",1528],"=",["T_WHITESPACE"," ",1528],["T_VARIABLE","$this",1528],["T_OBJECT_OPERATOR","->",1528],["T_STRING","session",1528],["T_OBJECT_OPERATOR","->",1528],["T_STRING","data",1528],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1528],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1528],"]",";",["T_WHITESPACE","\n\t\t\t",1528],["T_VARIABLE","$order_data",1529],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",1529],"]",["T_WHITESPACE"," ",1529],"=",["T_WHITESPACE"," ",1529],["T_VARIABLE","$this",1529],["T_OBJECT_OPERATOR","->",1529],["T_STRING","session",1529],["T_OBJECT_OPERATOR","->",1529],["T_STRING","data",1529],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1529],"]","[",["T_CONSTANT_ENCAPSED_STRING","'company'",1529],"]",";",["T_WHITESPACE","\n\t\t\t",1529],["T_VARIABLE","$order_data",1530],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",1530],"]",["T_WHITESPACE"," ",1530],"=",["T_WHITESPACE"," ",1530],["T_VARIABLE","$this",1530],["T_OBJECT_OPERATOR","->",1530],["T_STRING","session",1530],["T_OBJECT_OPERATOR","->",1530],["T_STRING","data",1530],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1530],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address_1'",1530],"]",";",["T_WHITESPACE","\n\t\t\t",1530],["T_VARIABLE","$order_data",1531],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",1531],"]",["T_WHITESPACE"," ",1531],"=",["T_WHITESPACE"," ",1531],["T_VARIABLE","$this",1531],["T_OBJECT_OPERATOR","->",1531],["T_STRING","session",1531],["T_OBJECT_OPERATOR","->",1531],["T_STRING","data",1531],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1531],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address_2'",1531],"]",";",["T_WHITESPACE","\n\t\t\t",1531],["T_VARIABLE","$order_data",1532],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",1532],"]",["T_WHITESPACE"," ",1532],"=",["T_WHITESPACE"," ",1532],["T_VARIABLE","$this",1532],["T_OBJECT_OPERATOR","->",1532],["T_STRING","session",1532],["T_OBJECT_OPERATOR","->",1532],["T_STRING","data",1532],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1532],"]","[",["T_CONSTANT_ENCAPSED_STRING","'city'",1532],"]",";",["T_WHITESPACE","\n\t\t\t",1532],["T_VARIABLE","$order_data",1533],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",1533],"]",["T_WHITESPACE"," ",1533],"=",["T_WHITESPACE"," ",1533],["T_VARIABLE","$this",1533],["T_OBJECT_OPERATOR","->",1533],["T_STRING","session",1533],["T_OBJECT_OPERATOR","->",1533],["T_STRING","data",1533],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1533],"]","[",["T_CONSTANT_ENCAPSED_STRING","'postcode'",1533],"]",";",["T_WHITESPACE","\n\t\t\t",1533],["T_VARIABLE","$order_data",1534],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",1534],"]",["T_WHITESPACE"," ",1534],"=",["T_WHITESPACE"," ",1534],["T_VARIABLE","$this",1534],["T_OBJECT_OPERATOR","->",1534],["T_STRING","session",1534],["T_OBJECT_OPERATOR","->",1534],["T_STRING","data",1534],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1534],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone'",1534],"]",";",["T_WHITESPACE","\n\t\t\t",1534],["T_VARIABLE","$order_data",1535],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",1535],"]",["T_WHITESPACE"," ",1535],"=",["T_WHITESPACE"," ",1535],["T_VARIABLE","$this",1535],["T_OBJECT_OPERATOR","->",1535],["T_STRING","session",1535],["T_OBJECT_OPERATOR","->",1535],["T_STRING","data",1535],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1535],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_id'",1535],"]",";",["T_WHITESPACE","\n\t\t\t",1535],["T_VARIABLE","$order_data",1536],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",1536],"]",["T_WHITESPACE"," ",1536],"=",["T_WHITESPACE"," ",1536],["T_VARIABLE","$this",1536],["T_OBJECT_OPERATOR","->",1536],["T_STRING","session",1536],["T_OBJECT_OPERATOR","->",1536],["T_STRING","data",1536],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1536],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country'",1536],"]",";",["T_WHITESPACE","\n\t\t\t",1536],["T_VARIABLE","$order_data",1537],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",1537],"]",["T_WHITESPACE"," ",1537],"=",["T_WHITESPACE"," ",1537],["T_VARIABLE","$this",1537],["T_OBJECT_OPERATOR","->",1537],["T_STRING","session",1537],["T_OBJECT_OPERATOR","->",1537],["T_STRING","data",1537],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1537],"]","[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1537],"]",";",["T_WHITESPACE","\n\t\t\t",1537],["T_VARIABLE","$order_data",1538],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",1538],"]",["T_WHITESPACE"," ",1538],"=",["T_WHITESPACE"," ",1538],["T_VARIABLE","$this",1538],["T_OBJECT_OPERATOR","->",1538],["T_STRING","session",1538],["T_OBJECT_OPERATOR","->",1538],["T_STRING","data",1538],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1538],"]","[",["T_CONSTANT_ENCAPSED_STRING","'address_format'",1538],"]",";",["T_WHITESPACE","\n\t\t\t",1538],["T_VARIABLE","$order_data",1539],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_custom_field'",1539],"]",["T_WHITESPACE"," ",1539],"=",["T_WHITESPACE"," ",1539],"(",["T_ISSET","isset",1539],"(",["T_VARIABLE","$this",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","session",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","data",1539],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1539],"]","[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1539],"]",")",["T_WHITESPACE"," ",1539],"?",["T_WHITESPACE"," ",1539],["T_VARIABLE","$this",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","session",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","data",1539],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1539],"]","[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",1539],"]",["T_WHITESPACE"," ",1539],":",["T_WHITESPACE"," ",1539],["T_ARRAY","array",1539],"(",")",")",";",["T_WHITESPACE","\n\n\t\t\t",1539],["T_IF","if",1541],["T_WHITESPACE"," ",1541],"(",["T_ISSET","isset",1541],"(",["T_VARIABLE","$this",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","session",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","data",1541],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1541],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",1541],"]",")",")",["T_WHITESPACE"," ",1541],"{",["T_WHITESPACE","\n\t\t\t\t",1541],["T_VARIABLE","$order_data",1542],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1542],"]",["T_WHITESPACE"," ",1542],"=",["T_WHITESPACE"," ",1542],["T_VARIABLE","$this",1542],["T_OBJECT_OPERATOR","->",1542],["T_STRING","session",1542],["T_OBJECT_OPERATOR","->",1542],["T_STRING","data",1542],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1542],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",1542],"]",";",["T_WHITESPACE","\n\t\t\t",1542],"}",["T_WHITESPACE"," ",1543],["T_ELSE","else",1543],["T_WHITESPACE"," ",1543],"{",["T_WHITESPACE","\n\t\t\t\t",1543],["T_VARIABLE","$order_data",1544],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1544],"]",["T_WHITESPACE"," ",1544],"=",["T_WHITESPACE"," ",1544],["T_CONSTANT_ENCAPSED_STRING","''",1544],";",["T_WHITESPACE","\n\t\t\t",1544],"}",["T_WHITESPACE","\n\n\t\t\t",1545],["T_IF","if",1547],["T_WHITESPACE"," ",1547],"(",["T_ISSET","isset",1547],"(",["T_VARIABLE","$this",1547],["T_OBJECT_OPERATOR","->",1547],["T_STRING","session",1547],["T_OBJECT_OPERATOR","->",1547],["T_STRING","data",1547],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1547],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",1547],"]",")",")",["T_WHITESPACE"," ",1547],"{",["T_WHITESPACE","\n\t\t\t\t",1547],["T_VARIABLE","$order_data",1548],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_code'",1548],"]",["T_WHITESPACE"," ",1548],"=",["T_WHITESPACE"," ",1548],["T_VARIABLE","$this",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","session",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","data",1548],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1548],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",1548],"]",";",["T_WHITESPACE","\n\t\t\t",1548],"}",["T_WHITESPACE"," ",1549],["T_ELSE","else",1549],["T_WHITESPACE"," ",1549],"{",["T_WHITESPACE","\n\t\t\t\t",1549],["T_VARIABLE","$order_data",1550],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_code'",1550],"]",["T_WHITESPACE"," ",1550],"=",["T_WHITESPACE"," ",1550],["T_CONSTANT_ENCAPSED_STRING","''",1550],";",["T_WHITESPACE","\n\t\t\t",1550],"}",["T_WHITESPACE","\n\t\t",1551],"}",["T_WHITESPACE"," ",1552],["T_ELSE","else",1552],["T_WHITESPACE"," ",1552],"{",["T_WHITESPACE","\n\t\t\t",1552],["T_VARIABLE","$order_data",1553],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",1553],"]",["T_WHITESPACE"," ",1553],"=",["T_WHITESPACE"," ",1553],["T_CONSTANT_ENCAPSED_STRING","''",1553],";",["T_WHITESPACE","\n\t\t\t",1553],["T_VARIABLE","$order_data",1554],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",1554],"]",["T_WHITESPACE"," ",1554],"=",["T_WHITESPACE"," ",1554],["T_CONSTANT_ENCAPSED_STRING","''",1554],";",["T_WHITESPACE","\n\t\t\t",1554],["T_VARIABLE","$order_data",1555],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",1555],"]",["T_WHITESPACE"," ",1555],"=",["T_WHITESPACE"," ",1555],["T_CONSTANT_ENCAPSED_STRING","''",1555],";",["T_WHITESPACE","\n\t\t\t",1555],["T_VARIABLE","$order_data",1556],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",1556],"]",["T_WHITESPACE"," ",1556],"=",["T_WHITESPACE"," ",1556],["T_CONSTANT_ENCAPSED_STRING","''",1556],";",["T_WHITESPACE","\n\t\t\t",1556],["T_VARIABLE","$order_data",1557],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",1557],"]",["T_WHITESPACE"," ",1557],"=",["T_WHITESPACE"," ",1557],["T_CONSTANT_ENCAPSED_STRING","''",1557],";",["T_WHITESPACE","\n\t\t\t",1557],["T_VARIABLE","$order_data",1558],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",1558],"]",["T_WHITESPACE"," ",1558],"=",["T_WHITESPACE"," ",1558],["T_CONSTANT_ENCAPSED_STRING","''",1558],";",["T_WHITESPACE","\n\t\t\t",1558],["T_VARIABLE","$order_data",1559],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",1559],"]",["T_WHITESPACE"," ",1559],"=",["T_WHITESPACE"," ",1559],["T_CONSTANT_ENCAPSED_STRING","''",1559],";",["T_WHITESPACE","\n\t\t\t",1559],["T_VARIABLE","$order_data",1560],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",1560],"]",["T_WHITESPACE"," ",1560],"=",["T_WHITESPACE"," ",1560],["T_CONSTANT_ENCAPSED_STRING","''",1560],";",["T_WHITESPACE","\n\t\t\t",1560],["T_VARIABLE","$order_data",1561],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",1561],"]",["T_WHITESPACE"," ",1561],"=",["T_WHITESPACE"," ",1561],["T_CONSTANT_ENCAPSED_STRING","''",1561],";",["T_WHITESPACE","\n\t\t\t",1561],["T_VARIABLE","$order_data",1562],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",1562],"]",["T_WHITESPACE"," ",1562],"=",["T_WHITESPACE"," ",1562],["T_CONSTANT_ENCAPSED_STRING","''",1562],";",["T_WHITESPACE","\n\t\t\t",1562],["T_VARIABLE","$order_data",1563],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",1563],"]",["T_WHITESPACE"," ",1563],"=",["T_WHITESPACE"," ",1563],["T_CONSTANT_ENCAPSED_STRING","''",1563],";",["T_WHITESPACE","\n\t\t\t",1563],["T_VARIABLE","$order_data",1564],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",1564],"]",["T_WHITESPACE"," ",1564],"=",["T_WHITESPACE"," ",1564],["T_CONSTANT_ENCAPSED_STRING","''",1564],";",["T_WHITESPACE","\n\t\t\t",1564],["T_VARIABLE","$order_data",1565],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_custom_field'",1565],"]",["T_WHITESPACE"," ",1565],"=",["T_WHITESPACE"," ",1565],["T_ARRAY","array",1565],"(",")",";",["T_WHITESPACE","\n\t\t\t",1565],["T_VARIABLE","$order_data",1566],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1566],"]",["T_WHITESPACE"," ",1566],"=",["T_WHITESPACE"," ",1566],["T_CONSTANT_ENCAPSED_STRING","''",1566],";",["T_WHITESPACE","\n\t\t\t",1566],["T_VARIABLE","$order_data",1567],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_code'",1567],"]",["T_WHITESPACE"," ",1567],"=",["T_WHITESPACE"," ",1567],["T_CONSTANT_ENCAPSED_STRING","''",1567],";",["T_WHITESPACE","\n\t\t",1567],"}",["T_WHITESPACE","\n\n\t\t",1568],["T_VARIABLE","$order_data",1570],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",1570],"]",["T_WHITESPACE"," ",1570],"=",["T_WHITESPACE"," ",1570],["T_ARRAY","array",1570],"(",")",";",["T_WHITESPACE","\n\n\t\t",1570],["T_FOREACH","foreach",1572],["T_WHITESPACE"," ",1572],"(",["T_VARIABLE","$this",1572],["T_OBJECT_OPERATOR","->",1572],["T_STRING","cart",1572],["T_OBJECT_OPERATOR","->",1572],["T_STRING","getProducts",1572],"(",")",["T_WHITESPACE"," ",1572],["T_AS","as",1572],["T_WHITESPACE"," ",1572],["T_VARIABLE","$product",1572],")",["T_WHITESPACE"," ",1572],"{",["T_WHITESPACE","\n\t\t\t",1572],["T_VARIABLE","$option_data",1573],["T_WHITESPACE"," ",1573],"=",["T_WHITESPACE"," ",1573],["T_ARRAY","array",1573],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",1573],["T_FOREACH","foreach",1575],["T_WHITESPACE"," ",1575],"(",["T_VARIABLE","$product",1575],"[",["T_CONSTANT_ENCAPSED_STRING","'option'",1575],"]",["T_WHITESPACE"," ",1575],["T_AS","as",1575],["T_WHITESPACE"," ",1575],["T_VARIABLE","$option",1575],")",["T_WHITESPACE"," ",1575],"{",["T_WHITESPACE","\n\t\t\t\t",1575],["T_VARIABLE","$option_data",1576],"[","]",["T_WHITESPACE"," ",1576],"=",["T_WHITESPACE"," ",1576],["T_ARRAY","array",1576],"(",["T_WHITESPACE","\n\t\t\t\t\t",1576],["T_CONSTANT_ENCAPSED_STRING","'product_option_id'",1577],["T_WHITESPACE","       ",1577],["T_DOUBLE_ARROW","=>",1577],["T_WHITESPACE"," ",1577],["T_VARIABLE","$option",1577],"[",["T_CONSTANT_ENCAPSED_STRING","'product_option_id'",1577],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1577],["T_CONSTANT_ENCAPSED_STRING","'product_option_value_id'",1578],["T_WHITESPACE"," ",1578],["T_DOUBLE_ARROW","=>",1578],["T_WHITESPACE"," ",1578],["T_VARIABLE","$option",1578],"[",["T_CONSTANT_ENCAPSED_STRING","'product_option_value_id'",1578],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1578],["T_CONSTANT_ENCAPSED_STRING","'option_id'",1579],["T_WHITESPACE","               ",1579],["T_DOUBLE_ARROW","=>",1579],["T_WHITESPACE"," ",1579],["T_VARIABLE","$option",1579],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",1579],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1579],["T_CONSTANT_ENCAPSED_STRING","'option_value_id'",1580],["T_WHITESPACE","         ",1580],["T_DOUBLE_ARROW","=>",1580],["T_WHITESPACE"," ",1580],["T_VARIABLE","$option",1580],"[",["T_CONSTANT_ENCAPSED_STRING","'option_value_id'",1580],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1580],["T_CONSTANT_ENCAPSED_STRING","'name'",1581],["T_WHITESPACE","                    ",1581],["T_DOUBLE_ARROW","=>",1581],["T_WHITESPACE"," ",1581],["T_VARIABLE","$option",1581],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1581],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1581],["T_CONSTANT_ENCAPSED_STRING","'value'",1582],["T_WHITESPACE","                   ",1582],["T_DOUBLE_ARROW","=>",1582],["T_WHITESPACE"," ",1582],["T_VARIABLE","$option",1582],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1582],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1582],["T_CONSTANT_ENCAPSED_STRING","'type'",1583],["T_WHITESPACE","                    ",1583],["T_DOUBLE_ARROW","=>",1583],["T_WHITESPACE"," ",1583],["T_VARIABLE","$option",1583],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",1583],"]",["T_WHITESPACE","\n\t\t\t\t",1583],")",";",["T_WHITESPACE","\n\t\t\t",1584],"}",["T_WHITESPACE","\n\n\t\t\t",1585],["T_VARIABLE","$order_data",1587],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",1587],"]","[","]",["T_WHITESPACE"," ",1587],"=",["T_WHITESPACE"," ",1587],["T_ARRAY","array",1587],"(",["T_WHITESPACE","\n\t\t\t\t",1587],["T_CONSTANT_ENCAPSED_STRING","'product_id'",1588],["T_WHITESPACE"," ",1588],["T_DOUBLE_ARROW","=>",1588],["T_WHITESPACE"," ",1588],["T_VARIABLE","$product",1588],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",1588],"]",",",["T_WHITESPACE","\n\t\t\t\t",1588],["T_CONSTANT_ENCAPSED_STRING","'name'",1589],["T_WHITESPACE","       ",1589],["T_DOUBLE_ARROW","=>",1589],["T_WHITESPACE"," ",1589],["T_VARIABLE","$product",1589],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1589],"]",",",["T_WHITESPACE","\n\t\t\t\t",1589],["T_CONSTANT_ENCAPSED_STRING","'model'",1590],["T_WHITESPACE","      ",1590],["T_DOUBLE_ARROW","=>",1590],["T_WHITESPACE"," ",1590],["T_VARIABLE","$product",1590],"[",["T_CONSTANT_ENCAPSED_STRING","'model'",1590],"]",",",["T_WHITESPACE","\n\t\t\t\t",1590],["T_CONSTANT_ENCAPSED_STRING","'option'",1591],["T_WHITESPACE","     ",1591],["T_DOUBLE_ARROW","=>",1591],["T_WHITESPACE"," ",1591],["T_VARIABLE","$option_data",1591],",",["T_WHITESPACE","\n\t\t\t\t",1591],["T_CONSTANT_ENCAPSED_STRING","'download'",1592],["T_WHITESPACE","   ",1592],["T_DOUBLE_ARROW","=>",1592],["T_WHITESPACE"," ",1592],["T_VARIABLE","$product",1592],"[",["T_CONSTANT_ENCAPSED_STRING","'download'",1592],"]",",",["T_WHITESPACE","\n\t\t\t\t",1592],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1593],["T_WHITESPACE","   ",1593],["T_DOUBLE_ARROW","=>",1593],["T_WHITESPACE"," ",1593],["T_VARIABLE","$product",1593],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",1593],"]",",",["T_WHITESPACE","\n\t\t\t\t",1593],["T_CONSTANT_ENCAPSED_STRING","'subtract'",1594],["T_WHITESPACE","   ",1594],["T_DOUBLE_ARROW","=>",1594],["T_WHITESPACE"," ",1594],["T_VARIABLE","$product",1594],"[",["T_CONSTANT_ENCAPSED_STRING","'subtract'",1594],"]",",",["T_WHITESPACE","\n\t\t\t\t",1594],["T_CONSTANT_ENCAPSED_STRING","'price'",1595],["T_WHITESPACE","      ",1595],["T_DOUBLE_ARROW","=>",1595],["T_WHITESPACE"," ",1595],["T_VARIABLE","$product",1595],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",1595],"]",",",["T_WHITESPACE","\n\t\t\t\t",1595],["T_CONSTANT_ENCAPSED_STRING","'total'",1596],["T_WHITESPACE","      ",1596],["T_DOUBLE_ARROW","=>",1596],["T_WHITESPACE"," ",1596],["T_VARIABLE","$product",1596],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",1596],"]",",",["T_WHITESPACE","\n\t\t\t\t",1596],["T_CONSTANT_ENCAPSED_STRING","'tax'",1597],["T_WHITESPACE","        ",1597],["T_DOUBLE_ARROW","=>",1597],["T_WHITESPACE"," ",1597],["T_VARIABLE","$this",1597],["T_OBJECT_OPERATOR","->",1597],["T_STRING","tax",1597],["T_OBJECT_OPERATOR","->",1597],["T_STRING","getTax",1597],"(",["T_VARIABLE","$product",1597],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",1597],"]",",",["T_WHITESPACE"," ",1597],["T_VARIABLE","$product",1597],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1597],"]",")",",",["T_WHITESPACE","\n\t\t\t\t",1597],["T_CONSTANT_ENCAPSED_STRING","'reward'",1598],["T_WHITESPACE","     ",1598],["T_DOUBLE_ARROW","=>",1598],["T_WHITESPACE"," ",1598],["T_VARIABLE","$product",1598],"[",["T_CONSTANT_ENCAPSED_STRING","'reward'",1598],"]",["T_WHITESPACE","\n\t\t\t",1598],")",";",["T_WHITESPACE","\n\t\t",1599],"}",["T_WHITESPACE","\n\n\t\t",1600],["T_COMMENT","\/\/ Gift Voucher\n",1602],["T_WHITESPACE","\t\t",1603],["T_VARIABLE","$order_data",1603],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1603],"]",["T_WHITESPACE"," ",1603],"=",["T_WHITESPACE"," ",1603],["T_ARRAY","array",1603],"(",")",";",["T_WHITESPACE","\n\n\t\t",1603],["T_IF","if",1605],["T_WHITESPACE"," ",1605],"(","!",["T_EMPTY","empty",1605],"(",["T_VARIABLE","$this",1605],["T_OBJECT_OPERATOR","->",1605],["T_STRING","session",1605],["T_OBJECT_OPERATOR","->",1605],["T_STRING","data",1605],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1605],"]",")",")",["T_WHITESPACE"," ",1605],"{",["T_WHITESPACE","\n\t\t\t",1605],["T_FOREACH","foreach",1606],["T_WHITESPACE"," ",1606],"(",["T_VARIABLE","$this",1606],["T_OBJECT_OPERATOR","->",1606],["T_STRING","session",1606],["T_OBJECT_OPERATOR","->",1606],["T_STRING","data",1606],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1606],"]",["T_WHITESPACE"," ",1606],["T_AS","as",1606],["T_WHITESPACE"," ",1606],["T_VARIABLE","$voucher",1606],")",["T_WHITESPACE"," ",1606],"{",["T_WHITESPACE","\n\t\t\t\t",1606],["T_VARIABLE","$order_data",1607],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1607],"]","[","]",["T_WHITESPACE"," ",1607],"=",["T_WHITESPACE"," ",1607],["T_ARRAY","array",1607],"(",["T_WHITESPACE","\n\t\t\t\t\t",1607],["T_CONSTANT_ENCAPSED_STRING","'description'",1608],["T_WHITESPACE","      ",1608],["T_DOUBLE_ARROW","=>",1608],["T_WHITESPACE"," ",1608],["T_VARIABLE","$voucher",1608],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",1608],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1608],["T_CONSTANT_ENCAPSED_STRING","'code'",1609],["T_WHITESPACE","             ",1609],["T_DOUBLE_ARROW","=>",1609],["T_WHITESPACE"," ",1609],["T_STRING","token",1609],"(",["T_LNUMBER","10",1609],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1609],["T_CONSTANT_ENCAPSED_STRING","'to_name'",1610],["T_WHITESPACE","          ",1610],["T_DOUBLE_ARROW","=>",1610],["T_WHITESPACE"," ",1610],["T_VARIABLE","$voucher",1610],"[",["T_CONSTANT_ENCAPSED_STRING","'to_name'",1610],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1610],["T_CONSTANT_ENCAPSED_STRING","'to_email'",1611],["T_WHITESPACE","         ",1611],["T_DOUBLE_ARROW","=>",1611],["T_WHITESPACE"," ",1611],["T_VARIABLE","$voucher",1611],"[",["T_CONSTANT_ENCAPSED_STRING","'to_email'",1611],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1611],["T_CONSTANT_ENCAPSED_STRING","'from_name'",1612],["T_WHITESPACE","        ",1612],["T_DOUBLE_ARROW","=>",1612],["T_WHITESPACE"," ",1612],["T_VARIABLE","$voucher",1612],"[",["T_CONSTANT_ENCAPSED_STRING","'from_name'",1612],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1612],["T_CONSTANT_ENCAPSED_STRING","'from_email'",1613],["T_WHITESPACE","       ",1613],["T_DOUBLE_ARROW","=>",1613],["T_WHITESPACE"," ",1613],["T_VARIABLE","$voucher",1613],"[",["T_CONSTANT_ENCAPSED_STRING","'from_email'",1613],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1613],["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",1614],["T_WHITESPACE"," ",1614],["T_DOUBLE_ARROW","=>",1614],["T_WHITESPACE"," ",1614],["T_VARIABLE","$voucher",1614],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",1614],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1614],["T_CONSTANT_ENCAPSED_STRING","'message'",1615],["T_WHITESPACE","          ",1615],["T_DOUBLE_ARROW","=>",1615],["T_WHITESPACE"," ",1615],["T_VARIABLE","$voucher",1615],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",1615],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1615],["T_CONSTANT_ENCAPSED_STRING","'amount'",1616],["T_WHITESPACE","           ",1616],["T_DOUBLE_ARROW","=>",1616],["T_WHITESPACE"," ",1616],["T_VARIABLE","$voucher",1616],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",1616],"]",["T_WHITESPACE","\n\t\t\t\t",1616],")",";",["T_WHITESPACE","\n\t\t\t",1617],"}",["T_WHITESPACE","\n\t\t",1618],"}",["T_WHITESPACE","\n\n\t\t",1619],["T_VARIABLE","$order_data",1621],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",1621],"]",["T_WHITESPACE"," ",1621],"=",["T_WHITESPACE"," ",1621],["T_VARIABLE","$this",1621],["T_OBJECT_OPERATOR","->",1621],["T_STRING","session",1621],["T_OBJECT_OPERATOR","->",1621],["T_STRING","data",1621],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",1621],"]",";",["T_WHITESPACE","\n\t\t",1621],["T_VARIABLE","$order_data",1622],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",1622],"]",["T_WHITESPACE"," ",1622],"=",["T_WHITESPACE"," ",1622],["T_VARIABLE","$total",1622],";",["T_WHITESPACE","\n\n\t\t",1622],["T_IF","if",1624],["T_WHITESPACE"," ",1624],"(",["T_ISSET","isset",1624],"(",["T_VARIABLE","$this",1624],["T_OBJECT_OPERATOR","->",1624],["T_STRING","request",1624],["T_OBJECT_OPERATOR","->",1624],["T_STRING","cookie",1624],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",1624],"]",")",")",["T_WHITESPACE"," ",1624],"{",["T_WHITESPACE","\n\t\t\t",1624],["T_VARIABLE","$order_data",1625],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",1625],"]",["T_WHITESPACE"," ",1625],"=",["T_WHITESPACE"," ",1625],["T_VARIABLE","$this",1625],["T_OBJECT_OPERATOR","->",1625],["T_STRING","request",1625],["T_OBJECT_OPERATOR","->",1625],["T_STRING","cookie",1625],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",1625],"]",";",["T_WHITESPACE","\n\n\t\t\t",1625],["T_VARIABLE","$subtotal",1627],["T_WHITESPACE"," ",1627],"=",["T_WHITESPACE"," ",1627],["T_VARIABLE","$this",1627],["T_OBJECT_OPERATOR","->",1627],["T_STRING","cart",1627],["T_OBJECT_OPERATOR","->",1627],["T_STRING","getSubTotal",1627],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",1627],["T_COMMENT","\/\/ Affiliate\n",1629],["T_WHITESPACE","\t\t\t",1630],["T_VARIABLE","$this",1630],["T_OBJECT_OPERATOR","->",1630],["T_STRING","load",1630],["T_OBJECT_OPERATOR","->",1630],["T_STRING","model",1630],"(",["T_CONSTANT_ENCAPSED_STRING","'affiliate\/affiliate'",1630],")",";",["T_WHITESPACE","\n\n\t\t\t",1630],["T_VARIABLE","$affiliate_info",1632],["T_WHITESPACE"," ",1632],"=",["T_WHITESPACE"," ",1632],["T_VARIABLE","$this",1632],["T_OBJECT_OPERATOR","->",1632],["T_STRING","model_affiliate_affiliate",1632],["T_OBJECT_OPERATOR","->",1632],["T_STRING","getAffiliateByCode",1632],"(",["T_VARIABLE","$this",1632],["T_OBJECT_OPERATOR","->",1632],["T_STRING","request",1632],["T_OBJECT_OPERATOR","->",1632],["T_STRING","cookie",1632],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",1632],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",1632],["T_IF","if",1634],["T_WHITESPACE"," ",1634],"(",["T_VARIABLE","$affiliate_info",1634],")",["T_WHITESPACE"," ",1634],"{",["T_WHITESPACE","\n\t\t\t\t",1634],["T_VARIABLE","$order_data",1635],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",1635],"]",["T_WHITESPACE"," ",1635],"=",["T_WHITESPACE"," ",1635],["T_VARIABLE","$affiliate_info",1635],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",1635],"]",";",["T_WHITESPACE","\n\t\t\t\t",1635],["T_VARIABLE","$order_data",1636],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",1636],"]",["T_WHITESPACE"," ",1636],"=",["T_WHITESPACE"," ",1636],"(",["T_VARIABLE","$subtotal",1636],["T_WHITESPACE"," ",1636],"\/",["T_WHITESPACE"," ",1636],["T_LNUMBER","100",1636],")",["T_WHITESPACE"," ",1636],"*",["T_WHITESPACE"," ",1636],["T_VARIABLE","$affiliate_info",1636],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",1636],"]",";",["T_WHITESPACE","\n\t\t\t",1636],"}",["T_WHITESPACE"," ",1637],["T_ELSE","else",1637],["T_WHITESPACE"," ",1637],"{",["T_WHITESPACE","\n\t\t\t\t",1637],["T_VARIABLE","$order_data",1638],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",1638],"]",["T_WHITESPACE"," ",1638],"=",["T_WHITESPACE"," ",1638],["T_LNUMBER","0",1638],";",["T_WHITESPACE","\n\t\t\t\t",1638],["T_VARIABLE","$order_data",1639],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",1639],"]",["T_WHITESPACE"," ",1639],"=",["T_WHITESPACE"," ",1639],["T_LNUMBER","0",1639],";",["T_WHITESPACE","\n\t\t\t",1639],"}",["T_WHITESPACE","\n\n\t\t\t",1640],["T_COMMENT","\/\/ Marketing\n",1642],["T_WHITESPACE","\t\t\t",1643],["T_VARIABLE","$this",1643],["T_OBJECT_OPERATOR","->",1643],["T_STRING","load",1643],["T_OBJECT_OPERATOR","->",1643],["T_STRING","model",1643],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/marketing'",1643],")",";",["T_WHITESPACE","\n\n\t\t\t",1643],["T_VARIABLE","$marketing_info",1645],["T_WHITESPACE"," ",1645],"=",["T_WHITESPACE"," ",1645],["T_VARIABLE","$this",1645],["T_OBJECT_OPERATOR","->",1645],["T_STRING","model_checkout_marketing",1645],["T_OBJECT_OPERATOR","->",1645],["T_STRING","getMarketingByCode",1645],"(",["T_VARIABLE","$this",1645],["T_OBJECT_OPERATOR","->",1645],["T_STRING","request",1645],["T_OBJECT_OPERATOR","->",1645],["T_STRING","cookie",1645],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",1645],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",1645],["T_IF","if",1647],["T_WHITESPACE"," ",1647],"(",["T_VARIABLE","$marketing_info",1647],")",["T_WHITESPACE"," ",1647],"{",["T_WHITESPACE","\n\t\t\t\t",1647],["T_VARIABLE","$order_data",1648],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",1648],"]",["T_WHITESPACE"," ",1648],"=",["T_WHITESPACE"," ",1648],["T_VARIABLE","$marketing_info",1648],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",1648],"]",";",["T_WHITESPACE","\n\t\t\t",1648],"}",["T_WHITESPACE"," ",1649],["T_ELSE","else",1649],["T_WHITESPACE"," ",1649],"{",["T_WHITESPACE","\n\t\t\t\t",1649],["T_VARIABLE","$order_data",1650],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",1650],"]",["T_WHITESPACE"," ",1650],"=",["T_WHITESPACE"," ",1650],["T_LNUMBER","0",1650],";",["T_WHITESPACE","\n\t\t\t",1650],"}",["T_WHITESPACE","\n\t\t",1651],"}",["T_WHITESPACE"," ",1652],["T_ELSE","else",1652],["T_WHITESPACE"," ",1652],"{",["T_WHITESPACE","\n\t\t\t",1652],["T_VARIABLE","$order_data",1653],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",1653],"]",["T_WHITESPACE"," ",1653],"=",["T_WHITESPACE"," ",1653],["T_LNUMBER","0",1653],";",["T_WHITESPACE","\n\t\t\t",1653],["T_VARIABLE","$order_data",1654],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",1654],"]",["T_WHITESPACE"," ",1654],"=",["T_WHITESPACE"," ",1654],["T_LNUMBER","0",1654],";",["T_WHITESPACE","\n\t\t\t",1654],["T_VARIABLE","$order_data",1655],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",1655],"]",["T_WHITESPACE"," ",1655],"=",["T_WHITESPACE"," ",1655],["T_LNUMBER","0",1655],";",["T_WHITESPACE","\n\t\t\t",1655],["T_VARIABLE","$order_data",1656],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",1656],"]",["T_WHITESPACE"," ",1656],"=",["T_WHITESPACE"," ",1656],["T_CONSTANT_ENCAPSED_STRING","''",1656],";",["T_WHITESPACE","\n\t\t",1656],"}",["T_WHITESPACE","\n\n\t\t",1657],["T_VARIABLE","$order_data",1659],"[",["T_CONSTANT_ENCAPSED_STRING","'language_id'",1659],"]",["T_WHITESPACE"," ",1659],"=",["T_WHITESPACE"," ",1659],["T_VARIABLE","$this",1659],["T_OBJECT_OPERATOR","->",1659],["T_STRING","config",1659],["T_OBJECT_OPERATOR","->",1659],["T_STRING","get",1659],"(",["T_CONSTANT_ENCAPSED_STRING","'config_language_id'",1659],")",";",["T_WHITESPACE","\n\t\t",1659],["T_VARIABLE","$order_data",1660],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_id'",1660],"]",["T_WHITESPACE"," ",1660],"=",["T_WHITESPACE"," ",1660],["T_VARIABLE","$this",1660],["T_OBJECT_OPERATOR","->",1660],["T_STRING","currency",1660],["T_OBJECT_OPERATOR","->",1660],["T_STRING","getId",1660],"(",["T_VARIABLE","$this",1660],["T_OBJECT_OPERATOR","->",1660],["T_STRING","session",1660],["T_OBJECT_OPERATOR","->",1660],["T_STRING","data",1660],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",1660],"]",")",";",["T_WHITESPACE","\n\t\t",1660],["T_VARIABLE","$order_data",1661],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",1661],"]",["T_WHITESPACE"," ",1661],"=",["T_WHITESPACE"," ",1661],["T_VARIABLE","$this",1661],["T_OBJECT_OPERATOR","->",1661],["T_STRING","session",1661],["T_OBJECT_OPERATOR","->",1661],["T_STRING","data",1661],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",1661],"]",";",["T_WHITESPACE","\n\t\t",1661],["T_VARIABLE","$order_data",1662],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",1662],"]",["T_WHITESPACE"," ",1662],"=",["T_WHITESPACE"," ",1662],["T_VARIABLE","$this",1662],["T_OBJECT_OPERATOR","->",1662],["T_STRING","currency",1662],["T_OBJECT_OPERATOR","->",1662],["T_STRING","getValue",1662],"(",["T_VARIABLE","$this",1662],["T_OBJECT_OPERATOR","->",1662],["T_STRING","session",1662],["T_OBJECT_OPERATOR","->",1662],["T_STRING","data",1662],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",1662],"]",")",";",["T_WHITESPACE","\n\t\t",1662],["T_VARIABLE","$order_data",1663],"[",["T_CONSTANT_ENCAPSED_STRING","'ip'",1663],"]",["T_WHITESPACE"," ",1663],"=",["T_WHITESPACE"," ",1663],["T_VARIABLE","$this",1663],["T_OBJECT_OPERATOR","->",1663],["T_STRING","request",1663],["T_OBJECT_OPERATOR","->",1663],["T_STRING","server",1663],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",1663],"]",";",["T_WHITESPACE","\n\n\t\t",1663],["T_IF","if",1665],["T_WHITESPACE"," ",1665],"(","!",["T_EMPTY","empty",1665],"(",["T_VARIABLE","$this",1665],["T_OBJECT_OPERATOR","->",1665],["T_STRING","request",1665],["T_OBJECT_OPERATOR","->",1665],["T_STRING","server",1665],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",1665],"]",")",")",["T_WHITESPACE"," ",1665],"{",["T_WHITESPACE","\n\t\t\t",1665],["T_VARIABLE","$order_data",1666],"[",["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",1666],"]",["T_WHITESPACE"," ",1666],"=",["T_WHITESPACE"," ",1666],["T_VARIABLE","$this",1666],["T_OBJECT_OPERATOR","->",1666],["T_STRING","request",1666],["T_OBJECT_OPERATOR","->",1666],["T_STRING","server",1666],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",1666],"]",";",["T_WHITESPACE","\n\t\t",1666],"}",["T_WHITESPACE"," ",1667],["T_ELSEIF","elseif",1667],["T_WHITESPACE"," ",1667],"(","!",["T_EMPTY","empty",1667],"(",["T_VARIABLE","$this",1667],["T_OBJECT_OPERATOR","->",1667],["T_STRING","request",1667],["T_OBJECT_OPERATOR","->",1667],["T_STRING","server",1667],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CLIENT_IP'",1667],"]",")",")",["T_WHITESPACE"," ",1667],"{",["T_WHITESPACE","\n\t\t\t",1667],["T_VARIABLE","$order_data",1668],"[",["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",1668],"]",["T_WHITESPACE"," ",1668],"=",["T_WHITESPACE"," ",1668],["T_VARIABLE","$this",1668],["T_OBJECT_OPERATOR","->",1668],["T_STRING","request",1668],["T_OBJECT_OPERATOR","->",1668],["T_STRING","server",1668],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CLIENT_IP'",1668],"]",";",["T_WHITESPACE","\n\t\t",1668],"}",["T_WHITESPACE"," ",1669],["T_ELSE","else",1669],["T_WHITESPACE"," ",1669],"{",["T_WHITESPACE","\n\t\t\t",1669],["T_VARIABLE","$order_data",1670],"[",["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",1670],"]",["T_WHITESPACE"," ",1670],"=",["T_WHITESPACE"," ",1670],["T_CONSTANT_ENCAPSED_STRING","''",1670],";",["T_WHITESPACE","\n\t\t",1670],"}",["T_WHITESPACE","\n\n\t\t",1671],["T_IF","if",1673],["T_WHITESPACE"," ",1673],"(",["T_ISSET","isset",1673],"(",["T_VARIABLE","$this",1673],["T_OBJECT_OPERATOR","->",1673],["T_STRING","request",1673],["T_OBJECT_OPERATOR","->",1673],["T_STRING","server",1673],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",1673],"]",")",")",["T_WHITESPACE"," ",1673],"{",["T_WHITESPACE","\n\t\t\t",1673],["T_VARIABLE","$order_data",1674],"[",["T_CONSTANT_ENCAPSED_STRING","'user_agent'",1674],"]",["T_WHITESPACE"," ",1674],"=",["T_WHITESPACE"," ",1674],["T_VARIABLE","$this",1674],["T_OBJECT_OPERATOR","->",1674],["T_STRING","request",1674],["T_OBJECT_OPERATOR","->",1674],["T_STRING","server",1674],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",1674],"]",";",["T_WHITESPACE","\n\t\t",1674],"}",["T_WHITESPACE"," ",1675],["T_ELSE","else",1675],["T_WHITESPACE"," ",1675],"{",["T_WHITESPACE","\n\t\t\t",1675],["T_VARIABLE","$order_data",1676],"[",["T_CONSTANT_ENCAPSED_STRING","'user_agent'",1676],"]",["T_WHITESPACE"," ",1676],"=",["T_WHITESPACE"," ",1676],["T_CONSTANT_ENCAPSED_STRING","''",1676],";",["T_WHITESPACE","\n\t\t",1676],"}",["T_WHITESPACE","\n\n\t\t",1677],["T_IF","if",1679],["T_WHITESPACE"," ",1679],"(",["T_ISSET","isset",1679],"(",["T_VARIABLE","$this",1679],["T_OBJECT_OPERATOR","->",1679],["T_STRING","request",1679],["T_OBJECT_OPERATOR","->",1679],["T_STRING","server",1679],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ACCEPT_LANGUAGE'",1679],"]",")",")",["T_WHITESPACE"," ",1679],"{",["T_WHITESPACE","\n\t\t\t",1679],["T_VARIABLE","$order_data",1680],"[",["T_CONSTANT_ENCAPSED_STRING","'accept_language'",1680],"]",["T_WHITESPACE"," ",1680],"=",["T_WHITESPACE"," ",1680],["T_VARIABLE","$this",1680],["T_OBJECT_OPERATOR","->",1680],["T_STRING","request",1680],["T_OBJECT_OPERATOR","->",1680],["T_STRING","server",1680],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ACCEPT_LANGUAGE'",1680],"]",";",["T_WHITESPACE","\n\t\t",1680],"}",["T_WHITESPACE"," ",1681],["T_ELSE","else",1681],["T_WHITESPACE"," ",1681],"{",["T_WHITESPACE","\n\t\t\t",1681],["T_VARIABLE","$order_data",1682],"[",["T_CONSTANT_ENCAPSED_STRING","'accept_language'",1682],"]",["T_WHITESPACE"," ",1682],"=",["T_WHITESPACE"," ",1682],["T_CONSTANT_ENCAPSED_STRING","''",1682],";",["T_WHITESPACE","\n\t\t",1682],"}",["T_WHITESPACE","\n\n\t\t",1683],["T_VARIABLE","$this",1685],["T_OBJECT_OPERATOR","->",1685],["T_STRING","load",1685],["T_OBJECT_OPERATOR","->",1685],["T_STRING","model",1685],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",1685],")",";",["T_WHITESPACE","\n\n\t\t",1685],["T_VARIABLE","$this",1687],["T_OBJECT_OPERATOR","->",1687],["T_STRING","session",1687],["T_OBJECT_OPERATOR","->",1687],["T_STRING","data",1687],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1687],"]",["T_WHITESPACE"," ",1687],"=",["T_WHITESPACE"," ",1687],["T_VARIABLE","$this",1687],["T_OBJECT_OPERATOR","->",1687],["T_STRING","model_checkout_order",1687],["T_OBJECT_OPERATOR","->",1687],["T_STRING","addOrder",1687],"(",["T_VARIABLE","$order_data",1687],")",";",["T_WHITESPACE","\n\t",1687],"}",["T_WHITESPACE","\n\n\t",1688],["T_PRIVATE","private",1690],["T_WHITESPACE"," ",1690],["T_FUNCTION","function",1690],["T_WHITESPACE"," ",1690],["T_STRING","klarnaOrderData",1690],"(",["T_VARIABLE","$klarna_account",1690],")",["T_WHITESPACE"," ",1690],"{",["T_WHITESPACE","\n\t\t",1690],["T_VARIABLE","$this",1691],["T_OBJECT_OPERATOR","->",1691],["T_STRING","load",1691],["T_OBJECT_OPERATOR","->",1691],["T_STRING","language",1691],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",1691],")",";",["T_WHITESPACE","\n\n\t\t",1691],["T_VARIABLE","$this",1693],["T_OBJECT_OPERATOR","->",1693],["T_STRING","load",1693],["T_OBJECT_OPERATOR","->",1693],["T_STRING","model",1693],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",1693],")",";",["T_WHITESPACE","\n\t\t",1693],["T_VARIABLE","$this",1694],["T_OBJECT_OPERATOR","->",1694],["T_STRING","load",1694],["T_OBJECT_OPERATOR","->",1694],["T_STRING","model",1694],"(",["T_CONSTANT_ENCAPSED_STRING","'localisation\/country'",1694],")",";",["T_WHITESPACE","\n\n\t\t",1694],["T_VARIABLE","$currency_code",1696],["T_WHITESPACE"," ",1696],"=",["T_WHITESPACE"," ",1696],["T_VARIABLE","$this",1696],["T_OBJECT_OPERATOR","->",1696],["T_STRING","session",1696],["T_OBJECT_OPERATOR","->",1696],["T_STRING","data",1696],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",1696],"]",";",["T_WHITESPACE","\n\t\t",1696],["T_VARIABLE","$currency_value",1697],["T_WHITESPACE"," ",1697],"=",["T_WHITESPACE"," ",1697],["T_VARIABLE","$this",1697],["T_OBJECT_OPERATOR","->",1697],["T_STRING","currency",1697],["T_OBJECT_OPERATOR","->",1697],["T_STRING","getValue",1697],"(",["T_VARIABLE","$this",1697],["T_OBJECT_OPERATOR","->",1697],["T_STRING","session",1697],["T_OBJECT_OPERATOR","->",1697],["T_STRING","data",1697],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",1697],"]",")",";",["T_WHITESPACE","\n\n\t\t",1697],["T_COMMENT","\/\/ Shipping\n",1699],["T_WHITESPACE","\t\t",1700],["T_VARIABLE","$unset_shipping_method",1700],["T_WHITESPACE"," ",1700],"=",["T_WHITESPACE"," ",1700],["T_STRING","true",1700],";",["T_WHITESPACE","\n\t\t",1700],["T_IF","if",1701],["T_WHITESPACE"," ",1701],"(",["T_ISSET","isset",1701],"(",["T_VARIABLE","$this",1701],["T_OBJECT_OPERATOR","->",1701],["T_STRING","session",1701],["T_OBJECT_OPERATOR","->",1701],["T_STRING","data",1701],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1701],"]",")",["T_WHITESPACE"," ",1701],["T_BOOLEAN_AND","&&",1701],["T_WHITESPACE"," ",1701],["T_ISSET","isset",1701],"(",["T_VARIABLE","$this",1701],["T_OBJECT_OPERATOR","->",1701],["T_STRING","session",1701],["T_OBJECT_OPERATOR","->",1701],["T_STRING","data",1701],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1701],"]",")",")",["T_WHITESPACE"," ",1701],"{",["T_WHITESPACE","\n\t\t\t",1701],["T_FOREACH","foreach",1702],["T_WHITESPACE"," ",1702],"(",["T_VARIABLE","$this",1702],["T_OBJECT_OPERATOR","->",1702],["T_STRING","session",1702],["T_OBJECT_OPERATOR","->",1702],["T_STRING","data",1702],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1702],"]",["T_WHITESPACE"," ",1702],["T_AS","as",1702],["T_WHITESPACE"," ",1702],["T_VARIABLE","$shipping_method",1702],")",["T_WHITESPACE"," ",1702],"{",["T_WHITESPACE","\n\t\t\t\t",1702],["T_IF","if",1703],["T_WHITESPACE"," ",1703],"(",["T_VARIABLE","$shipping_method",1703],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",1703],"]",")",["T_WHITESPACE"," ",1703],"{",["T_WHITESPACE","\n\t\t\t\t\t",1703],["T_FOREACH","foreach",1704],["T_WHITESPACE"," ",1704],"(",["T_VARIABLE","$shipping_method",1704],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",1704],"]",["T_WHITESPACE"," ",1704],["T_AS","as",1704],["T_WHITESPACE"," ",1704],["T_VARIABLE","$quote",1704],")",["T_WHITESPACE"," ",1704],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1704],["T_IF","if",1705],["T_WHITESPACE"," ",1705],"(",["T_VARIABLE","$quote",1705],["T_WHITESPACE"," ",1705],["T_IS_EQUAL","==",1705],["T_WHITESPACE"," ",1705],["T_VARIABLE","$this",1705],["T_OBJECT_OPERATOR","->",1705],["T_STRING","session",1705],["T_OBJECT_OPERATOR","->",1705],["T_STRING","data",1705],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1705],"]",")",["T_WHITESPACE"," ",1705],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1705],["T_VARIABLE","$unset_shipping_method",1706],["T_WHITESPACE"," ",1706],"=",["T_WHITESPACE"," ",1706],["T_STRING","false",1706],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1706],["T_BREAK","break",1707],["T_WHITESPACE"," ",1707],["T_LNUMBER","2",1707],";",["T_WHITESPACE","\n\t\t\t\t\t\t",1707],"}",["T_WHITESPACE","\n\t\t\t\t\t",1708],"}",["T_WHITESPACE","\n\t\t\t\t",1709],"}",["T_WHITESPACE","\n\t\t\t",1710],"}",["T_WHITESPACE","\n\t\t",1711],"}",["T_WHITESPACE","\n\n\t\t",1712],["T_IF","if",1714],["T_WHITESPACE"," ",1714],"(",["T_VARIABLE","$unset_shipping_method",1714],")",["T_WHITESPACE"," ",1714],"{",["T_WHITESPACE","\n\t\t\t",1714],["T_UNSET","unset",1715],"(",["T_VARIABLE","$this",1715],["T_OBJECT_OPERATOR","->",1715],["T_STRING","session",1715],["T_OBJECT_OPERATOR","->",1715],["T_STRING","data",1715],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1715],"]",")",";",["T_WHITESPACE","\n\t\t",1715],"}",["T_WHITESPACE","\n\n\t\t",1716],["T_IF","if",1718],["T_WHITESPACE"," ",1718],"(","(","!",["T_ISSET","isset",1718],"(",["T_VARIABLE","$this",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","session",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","data",1718],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1718],"]",")",["T_WHITESPACE"," ",1718],["T_BOOLEAN_OR","||",1718],["T_WHITESPACE"," ",1718],["T_EMPTY","empty",1718],"(",["T_VARIABLE","$this",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","session",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","data",1718],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1718],"]",")",")",["T_WHITESPACE"," ",1718],["T_BOOLEAN_AND","&&",1718],["T_WHITESPACE"," ",1718],"(",["T_ISSET","isset",1718],"(",["T_VARIABLE","$this",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","session",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","data",1718],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1718],"]",")",["T_WHITESPACE"," ",1718],["T_BOOLEAN_AND","&&",1718],["T_WHITESPACE"," ",1718],"!",["T_EMPTY","empty",1718],"(",["T_VARIABLE","$this",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","session",1718],["T_OBJECT_OPERATOR","->",1718],["T_STRING","data",1718],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1718],"]",")",")",")",["T_WHITESPACE"," ",1718],"{",["T_WHITESPACE","\n\t\t\t",1718],["T_VARIABLE","$this",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","session",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","data",1719],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1719],"]",["T_WHITESPACE"," ",1719],"=",["T_WHITESPACE"," ",1719],["T_VARIABLE","$this",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","model_extension_payment_klarna_checkout",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","getDefaultShippingMethod",1719],"(",["T_VARIABLE","$this",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","session",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","data",1719],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_methods'",1719],"]",")",";",["T_WHITESPACE","\n\t\t",1719],"}",["T_WHITESPACE","\n\n\t\t",1720],["T_COMMENT","\/\/Check if customer is US. If so, send taxes differently\n",1722],["T_WHITESPACE","\t\t",1723],["T_IF","if",1723],["T_WHITESPACE"," ",1723],"(",["T_VARIABLE","$this",1723],["T_OBJECT_OPERATOR","->",1723],["T_STRING","session",1723],["T_OBJECT_OPERATOR","->",1723],["T_STRING","data",1723],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1723],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1723],"]",["T_WHITESPACE"," ",1723],["T_IS_IDENTICAL","===",1723],["T_WHITESPACE"," ",1723],["T_CONSTANT_ENCAPSED_STRING","'US'",1723],")",["T_WHITESPACE"," ",1723],"{",["T_WHITESPACE","\n\t\t\t",1723],["T_VARIABLE","$include_taxes",1724],["T_WHITESPACE"," ",1724],"=",["T_WHITESPACE"," ",1724],["T_STRING","false",1724],";",["T_WHITESPACE","\n\t\t",1724],"}",["T_WHITESPACE"," ",1725],["T_ELSE","else",1725],["T_WHITESPACE"," ",1725],"{",["T_WHITESPACE","\n\t\t\t",1725],["T_VARIABLE","$include_taxes",1726],["T_WHITESPACE"," ",1726],"=",["T_WHITESPACE"," ",1726],["T_STRING","true",1726],";",["T_WHITESPACE","\n\t\t",1726],"}",["T_WHITESPACE","\n\n\t\t",1727],["T_IF","if",1729],["T_WHITESPACE"," ",1729],"(",["T_VARIABLE","$this",1729],["T_OBJECT_OPERATOR","->",1729],["T_STRING","cart",1729],["T_OBJECT_OPERATOR","->",1729],["T_STRING","hasShipping",1729],"(",")",["T_WHITESPACE"," ",1729],["T_BOOLEAN_AND","&&",1729],["T_WHITESPACE"," ",1729],["T_ISSET","isset",1729],"(",["T_VARIABLE","$this",1729],["T_OBJECT_OPERATOR","->",1729],["T_STRING","session",1729],["T_OBJECT_OPERATOR","->",1729],["T_STRING","data",1729],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1729],"]",")",["T_WHITESPACE"," ",1729],["T_BOOLEAN_AND","&&",1729],["T_WHITESPACE"," ",1729],"!",["T_EMPTY","empty",1729],"(",["T_VARIABLE","$this",1729],["T_OBJECT_OPERATOR","->",1729],["T_STRING","session",1729],["T_OBJECT_OPERATOR","->",1729],["T_STRING","data",1729],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1729],"]",")",")",["T_WHITESPACE"," ",1729],"{",["T_WHITESPACE","\n\t\t\t",1729],["T_VARIABLE","$total_amount",1730],["T_WHITESPACE"," ",1730],"=",["T_WHITESPACE"," ",1730],["T_VARIABLE","$this",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","currency",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","format",1730],"(",["T_VARIABLE","$this",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","tax",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","calculate",1730],"(",["T_VARIABLE","$this",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","session",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","data",1730],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1730],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",1730],"]",",",["T_WHITESPACE"," ",1730],["T_VARIABLE","$this",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","session",1730],["T_OBJECT_OPERATOR","->",1730],["T_STRING","data",1730],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1730],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1730],"]",",",["T_WHITESPACE"," ",1730],["T_VARIABLE","$include_taxes",1730],")",",",["T_WHITESPACE"," ",1730],["T_VARIABLE","$currency_code",1730],",",["T_WHITESPACE"," ",1730],["T_VARIABLE","$currency_value",1730],",",["T_WHITESPACE"," ",1730],["T_STRING","false",1730],")",["T_WHITESPACE"," ",1730],"*",["T_WHITESPACE"," ",1730],["T_LNUMBER","100",1730],";",["T_WHITESPACE","\n\n\t\t\t",1730],["T_IF","if",1732],["T_WHITESPACE"," ",1732],"(",["T_VARIABLE","$include_taxes",1732],")",["T_WHITESPACE"," ",1732],"{",["T_WHITESPACE","\n\t\t\t\t",1732],["T_VARIABLE","$total_tax_amount",1733],["T_WHITESPACE"," ",1733],"=",["T_WHITESPACE"," ",1733],["T_VARIABLE","$this",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","currency",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","format",1733],"(",["T_VARIABLE","$this",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","tax",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","getTax",1733],"(",["T_VARIABLE","$this",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","session",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","data",1733],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1733],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",1733],"]",",",["T_WHITESPACE"," ",1733],["T_VARIABLE","$this",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","session",1733],["T_OBJECT_OPERATOR","->",1733],["T_STRING","data",1733],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1733],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1733],"]",")",",",["T_WHITESPACE"," ",1733],["T_VARIABLE","$currency_code",1733],",",["T_WHITESPACE"," ",1733],["T_VARIABLE","$currency_value",1733],",",["T_WHITESPACE"," ",1733],["T_STRING","false",1733],")",["T_WHITESPACE"," ",1733],"*",["T_WHITESPACE"," ",1733],["T_LNUMBER","100",1733],";",["T_WHITESPACE","\n\t\t\t",1733],"}",["T_WHITESPACE"," ",1734],["T_ELSE","else",1734],["T_WHITESPACE"," ",1734],"{",["T_WHITESPACE","\n\t\t\t\t",1734],["T_VARIABLE","$total_tax_amount",1735],["T_WHITESPACE"," ",1735],"=",["T_WHITESPACE"," ",1735],["T_LNUMBER","0",1735],";",["T_WHITESPACE","\n\t\t\t",1735],"}",["T_WHITESPACE","\n\n\t\t\t",1736],["T_VARIABLE","$total_sub_amount",1738],["T_WHITESPACE"," ",1738],"=",["T_WHITESPACE"," ",1738],["T_VARIABLE","$this",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","currency",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","format",1738],"(",["T_VARIABLE","$this",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","tax",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","calculate",1738],"(",["T_VARIABLE","$this",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","session",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","data",1738],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1738],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",1738],"]",",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$this",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","session",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","data",1738],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1738],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1738],"]",",",["T_WHITESPACE"," ",1738],["T_STRING","false",1738],")",",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$currency_code",1738],",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$currency_value",1738],",",["T_WHITESPACE"," ",1738],["T_STRING","false",1738],")",["T_WHITESPACE"," ",1738],"*",["T_WHITESPACE"," ",1738],["T_LNUMBER","100",1738],";",["T_WHITESPACE","\n\n\t\t\t",1738],["T_VARIABLE","$tax_rate",1740],["T_WHITESPACE"," ",1740],"=",["T_WHITESPACE"," ",1740],["T_LNUMBER","0",1740],";",["T_WHITESPACE","\n\n\t\t\t",1740],["T_IF","if",1742],["T_WHITESPACE"," ",1742],"(",["T_VARIABLE","$include_taxes",1742],["T_WHITESPACE"," ",1742],["T_BOOLEAN_AND","&&",1742],["T_WHITESPACE"," ",1742],["T_VARIABLE","$total_tax_amount",1742],["T_WHITESPACE"," ",1742],["T_BOOLEAN_AND","&&",1742],["T_WHITESPACE"," ",1742],["T_VARIABLE","$total_sub_amount",1742],")",["T_WHITESPACE"," ",1742],"{",["T_WHITESPACE","\n\t\t\t\t",1742],["T_VARIABLE","$tax_rate",1743],["T_WHITESPACE"," ",1743],"=",["T_WHITESPACE"," ",1743],"(",["T_VARIABLE","$total_tax_amount",1743],["T_WHITESPACE"," ",1743],"\/",["T_WHITESPACE"," ",1743],["T_VARIABLE","$total_sub_amount",1743],")",["T_WHITESPACE"," ",1743],"*",["T_WHITESPACE"," ",1743],["T_LNUMBER","100",1743],";",["T_WHITESPACE","\n\t\t\t",1743],"}",["T_WHITESPACE","\n\n\t\t\t",1744],["T_VARIABLE","$klarna_order_data",1746],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",1746],"]","[","]",["T_WHITESPACE"," ",1746],"=",["T_WHITESPACE"," ",1746],["T_ARRAY","array",1746],"(",["T_WHITESPACE","\n\t\t\t\t",1746],["T_CONSTANT_ENCAPSED_STRING","'type'",1747],["T_WHITESPACE","\t\t\t\t\t",1747],["T_DOUBLE_ARROW","=>",1747],["T_WHITESPACE"," ",1747],["T_CONSTANT_ENCAPSED_STRING","'shipping_fee'",1747],",",["T_WHITESPACE","\n\t\t\t\t",1747],["T_CONSTANT_ENCAPSED_STRING","'name'",1748],["T_WHITESPACE","\t\t\t\t\t",1748],["T_DOUBLE_ARROW","=>",1748],["T_WHITESPACE"," ",1748],["T_VARIABLE","$this",1748],["T_OBJECT_OPERATOR","->",1748],["T_STRING","session",1748],["T_OBJECT_OPERATOR","->",1748],["T_STRING","data",1748],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1748],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",1748],"]",",",["T_WHITESPACE","\n\t\t\t\t",1748],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1749],["T_WHITESPACE","\t\t\t\t",1749],["T_DOUBLE_ARROW","=>",1749],["T_WHITESPACE"," ",1749],["T_CONSTANT_ENCAPSED_STRING","'1'",1749],",",["T_WHITESPACE","\n\t\t\t\t",1749],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",1750],["T_WHITESPACE","\t\t\t",1750],["T_DOUBLE_ARROW","=>",1750],["T_WHITESPACE"," ",1750],["T_STRING","round",1750],"(",["T_VARIABLE","$this",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","currency",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","format",1750],"(",["T_VARIABLE","$this",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","tax",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","calculate",1750],"(",["T_VARIABLE","$this",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","session",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","data",1750],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1750],"]","[",["T_CONSTANT_ENCAPSED_STRING","'cost'",1750],"]",",",["T_WHITESPACE"," ",1750],["T_VARIABLE","$this",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","session",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","data",1750],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",1750],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1750],"]",",",["T_WHITESPACE"," ",1750],["T_VARIABLE","$include_taxes",1750],")",",",["T_WHITESPACE"," ",1750],["T_VARIABLE","$currency_code",1750],",",["T_WHITESPACE"," ",1750],["T_VARIABLE","$currency_value",1750],",",["T_WHITESPACE"," ",1750],["T_STRING","false",1750],")",["T_WHITESPACE"," ",1750],"*",["T_WHITESPACE"," ",1750],["T_LNUMBER","100",1750],")",",",["T_WHITESPACE","\n\t\t\t\t",1750],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",1751],["T_WHITESPACE","\t\t\t\t",1751],["T_DOUBLE_ARROW","=>",1751],["T_WHITESPACE"," ",1751],["T_STRING","round",1751],"(",["T_VARIABLE","$tax_rate",1751],["T_WHITESPACE"," ",1751],"*",["T_WHITESPACE"," ",1751],["T_LNUMBER","100",1751],")",",",["T_WHITESPACE","\n\t\t\t\t",1751],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",1752],["T_WHITESPACE","\t\t\t",1752],["T_DOUBLE_ARROW","=>",1752],["T_WHITESPACE"," ",1752],["T_STRING","round",1752],"(",["T_VARIABLE","$total_amount",1752],")",",",["T_WHITESPACE","\n\t\t\t\t",1752],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",1753],["T_WHITESPACE","\t\t",1753],["T_DOUBLE_ARROW","=>",1753],["T_WHITESPACE"," ",1753],["T_STRING","round",1753],"(",["T_VARIABLE","$total_tax_amount",1753],")",",",["T_WHITESPACE","\n\t\t\t\t",1753],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",1754],["T_WHITESPACE"," ",1754],["T_DOUBLE_ARROW","=>",1754],["T_WHITESPACE"," ",1754],["T_LNUMBER","0",1754],["T_WHITESPACE","\n\t\t\t",1754],")",";",["T_WHITESPACE","\n\t\t",1755],"}",["T_WHITESPACE","\n\n\t\t",1756],["T_COMMENT","\/\/ Billing Address\n",1758],["T_WHITESPACE","\t\t",1759],["T_IF","if",1759],["T_WHITESPACE"," ",1759],"(",["T_ISSET","isset",1759],"(",["T_VARIABLE","$this",1759],["T_OBJECT_OPERATOR","->",1759],["T_STRING","session",1759],["T_OBJECT_OPERATOR","->",1759],["T_STRING","data",1759],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",1759],"]",")",")",["T_WHITESPACE"," ",1759],"{",["T_WHITESPACE","\n\t\t\t",1759],["T_VARIABLE","$klarna_order_data",1760],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1760],"]",["T_WHITESPACE"," ",1760],"=",["T_WHITESPACE"," ",1760],["T_ARRAY","array",1760],"(",["T_WHITESPACE","\n\t\t\t\t",1760],["T_CONSTANT_ENCAPSED_STRING","'given_name'",1761],["T_WHITESPACE","  ",1761],["T_DOUBLE_ARROW","=>",1761],["T_WHITESPACE"," ",1761],["T_VARIABLE","$this",1761],["T_OBJECT_OPERATOR","->",1761],["T_STRING","session",1761],["T_OBJECT_OPERATOR","->",1761],["T_STRING","data",1761],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",1761],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1761],"]",",",["T_WHITESPACE","\n\t\t\t\t",1761],["T_CONSTANT_ENCAPSED_STRING","'family_name'",1762],["T_WHITESPACE"," ",1762],["T_DOUBLE_ARROW","=>",1762],["T_WHITESPACE"," ",1762],["T_VARIABLE","$this",1762],["T_OBJECT_OPERATOR","->",1762],["T_STRING","session",1762],["T_OBJECT_OPERATOR","->",1762],["T_STRING","data",1762],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",1762],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1762],"]",",",["T_WHITESPACE","\n\t\t\t\t",1762],["T_CONSTANT_ENCAPSED_STRING","'email'",1763],["T_WHITESPACE","\t\t  ",1763],["T_DOUBLE_ARROW","=>",1763],["T_WHITESPACE"," ",1763],["T_VARIABLE","$this",1763],["T_OBJECT_OPERATOR","->",1763],["T_STRING","session",1763],["T_OBJECT_OPERATOR","->",1763],["T_STRING","data",1763],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",1763],"]","[",["T_CONSTANT_ENCAPSED_STRING","'email'",1763],"]",",",["T_WHITESPACE","\n\t\t\t\t",1763],["T_CONSTANT_ENCAPSED_STRING","'phone'",1764],["T_WHITESPACE","\t\t  ",1764],["T_DOUBLE_ARROW","=>",1764],["T_WHITESPACE"," ",1764],["T_VARIABLE","$this",1764],["T_OBJECT_OPERATOR","->",1764],["T_STRING","session",1764],["T_OBJECT_OPERATOR","->",1764],["T_STRING","data",1764],"[",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_data'",1764],"]","[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",1764],"]",",",["T_WHITESPACE","\n\t\t\t\t",1764],["T_CONSTANT_ENCAPSED_STRING","'postal_code'",1765],["T_WHITESPACE"," ",1765],["T_DOUBLE_ARROW","=>",1765],["T_WHITESPACE"," ",1765],["T_VARIABLE","$this",1765],["T_OBJECT_OPERATOR","->",1765],["T_STRING","session",1765],["T_OBJECT_OPERATOR","->",1765],["T_STRING","data",1765],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1765],"]","[",["T_CONSTANT_ENCAPSED_STRING","'postcode'",1765],"]",",",["T_WHITESPACE","\n\t\t\t\t",1765],["T_CONSTANT_ENCAPSED_STRING","'region'",1766],["T_WHITESPACE","\t  ",1766],["T_DOUBLE_ARROW","=>",1766],["T_WHITESPACE"," ",1766],["T_VARIABLE","$this",1766],["T_OBJECT_OPERATOR","->",1766],["T_STRING","session",1766],["T_OBJECT_OPERATOR","->",1766],["T_STRING","data",1766],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1766],"]","[",["T_CONSTANT_ENCAPSED_STRING","'zone_code'",1766],"]",",",["T_WHITESPACE","\n\t\t\t\t",1766],["T_CONSTANT_ENCAPSED_STRING","'country'",1767],["T_WHITESPACE","\t  ",1767],["T_DOUBLE_ARROW","=>",1767],["T_WHITESPACE"," ",1767],["T_VARIABLE","$this",1767],["T_OBJECT_OPERATOR","->",1767],["T_STRING","session",1767],["T_OBJECT_OPERATOR","->",1767],["T_STRING","data",1767],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1767],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1767],"]",",",["T_WHITESPACE","\n\t\t\t",1767],")",";",["T_WHITESPACE","\n\t\t",1768],"}",["T_WHITESPACE"," ",1769],["T_ELSE","else",1769],["T_WHITESPACE"," ",1769],"{",["T_WHITESPACE","\n\t\t\t",1769],["T_VARIABLE","$klarna_order_data",1770],"[",["T_CONSTANT_ENCAPSED_STRING","'billing_address'",1770],"]",["T_WHITESPACE"," ",1770],"=",["T_WHITESPACE"," ",1770],["T_ARRAY","array",1770],"(",["T_WHITESPACE","\n\t\t\t\t",1770],["T_CONSTANT_ENCAPSED_STRING","'given_name'",1771],["T_WHITESPACE","\t  ",1771],["T_DOUBLE_ARROW","=>",1771],["T_WHITESPACE"," ",1771],["T_VARIABLE","$this",1771],["T_OBJECT_OPERATOR","->",1771],["T_STRING","session",1771],["T_OBJECT_OPERATOR","->",1771],["T_STRING","data",1771],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1771],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",1771],"]",",",["T_WHITESPACE","\n\t\t\t\t",1771],["T_CONSTANT_ENCAPSED_STRING","'family_name'",1772],["T_WHITESPACE","\t  ",1772],["T_DOUBLE_ARROW","=>",1772],["T_WHITESPACE"," ",1772],["T_VARIABLE","$this",1772],["T_OBJECT_OPERATOR","->",1772],["T_STRING","session",1772],["T_OBJECT_OPERATOR","->",1772],["T_STRING","data",1772],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address'",1772],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",1772],"]",",",["T_WHITESPACE","\n\t\t\t\t",1772],["T_CONSTANT_ENCAPSED_STRING","'email'",1773],["T_WHITESPACE","\t\t\t  ",1773],["T_DOUBLE_ARROW","=>",1773],["T_WHITESPACE"," ",1773],"(",["T_VARIABLE","$this",1773],["T_OBJECT_OPERATOR","->",1773],["T_STRING","customer",1773],["T_OBJECT_OPERATOR","->",1773],["T_STRING","isLogged",1773],"(",")",["T_WHITESPACE"," ",1773],"?",["T_WHITESPACE"," ",1773],["T_VARIABLE","$this",1773],["T_OBJECT_OPERATOR","->",1773],["T_STRING","customer",1773],["T_OBJECT_OPERATOR","->",1773],["T_STRING","getEmail",1773],"(",")",["T_WHITESPACE"," ",1773],":",["T_WHITESPACE"," ",1773],["T_STRING","null",1773],")",",",["T_WHITESPACE","\n\t\t\t\t",1773],["T_CONSTANT_ENCAPSED_STRING","'phone'",1774],["T_WHITESPACE","\t\t\t  ",1774],["T_DOUBLE_ARROW","=>",1774],["T_WHITESPACE"," ",1774],"(",["T_VARIABLE","$this",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","customer",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","isLogged",1774],"(",")",["T_WHITESPACE"," ",1774],"?",["T_WHITESPACE"," ",1774],["T_VARIABLE","$this",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","customer",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","getTelephone",1774],"(",")",["T_WHITESPACE"," ",1774],":",["T_WHITESPACE"," ",1774],["T_STRING","null",1774],")",["T_WHITESPACE","\n\t\t\t",1774],")",";",["T_WHITESPACE","\n\t\t",1775],"}",["T_WHITESPACE","\n\n\t\t",1776],["T_COMMENT","\/\/ Order Total\n",1778],["T_WHITESPACE","\t\t",1779],["T_LIST","list",1779],"(",["T_VARIABLE","$totals",1779],",",["T_WHITESPACE"," ",1779],["T_VARIABLE","$taxes",1779],",",["T_WHITESPACE"," ",1779],["T_VARIABLE","$total",1779],")",["T_WHITESPACE"," ",1779],"=",["T_WHITESPACE"," ",1779],["T_VARIABLE","$this",1779],["T_OBJECT_OPERATOR","->",1779],["T_STRING","model_extension_payment_klarna_checkout",1779],["T_OBJECT_OPERATOR","->",1779],["T_STRING","getTotals",1779],"(",")",";",["T_WHITESPACE","\n\n\t\t",1779],["T_VARIABLE","$merchant_urls",1781],["T_WHITESPACE"," ",1781],"=",["T_WHITESPACE"," ",1781],["T_ARRAY","array",1781],"(",["T_WHITESPACE","\n\t\t\t",1781],["T_CONSTANT_ENCAPSED_STRING","'checkout'",1782],["T_WHITESPACE","\t     ",1782],["T_DOUBLE_ARROW","=>",1782],["T_WHITESPACE"," ",1782],["T_STRING","html_entity_decode",1782],"(",["T_VARIABLE","$this",1782],["T_OBJECT_OPERATOR","->",1782],["T_STRING","url",1782],["T_OBJECT_OPERATOR","->",1782],["T_STRING","link",1782],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout'",1782],",",["T_WHITESPACE"," ",1782],["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id={checkout.order.id}'",1782],",",["T_WHITESPACE"," ",1782],["T_STRING","true",1782],")",")",",",["T_WHITESPACE","\n\t\t\t",1782],["T_CONSTANT_ENCAPSED_STRING","'confirmation'",1783],["T_WHITESPACE","   ",1783],["T_DOUBLE_ARROW","=>",1783],["T_WHITESPACE"," ",1783],["T_STRING","html_entity_decode",1783],"(",["T_VARIABLE","$this",1783],["T_OBJECT_OPERATOR","->",1783],["T_STRING","url",1783],["T_OBJECT_OPERATOR","->",1783],["T_STRING","link",1783],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout\/confirmation'",1783],",",["T_WHITESPACE"," ",1783],["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id={checkout.order.id}'",1783],",",["T_WHITESPACE"," ",1783],["T_STRING","true",1783],")",")",",",["T_WHITESPACE","\n\t\t\t",1783],["T_CONSTANT_ENCAPSED_STRING","'push'",1784],["T_WHITESPACE","\t\t\t ",1784],["T_DOUBLE_ARROW","=>",1784],["T_WHITESPACE"," ",1784],["T_STRING","html_entity_decode",1784],"(",["T_VARIABLE","$this",1784],["T_OBJECT_OPERATOR","->",1784],["T_STRING","url",1784],["T_OBJECT_OPERATOR","->",1784],["T_STRING","link",1784],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout\/push'",1784],",",["T_WHITESPACE"," ",1784],["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id={checkout.order.id}'",1784],",",["T_WHITESPACE"," ",1784],["T_STRING","true",1784],")",")",",",["T_WHITESPACE","\n\t\t\t",1784],["T_CONSTANT_ENCAPSED_STRING","'validation'",1785],["T_WHITESPACE","\t ",1785],["T_DOUBLE_ARROW","=>",1785],["T_WHITESPACE"," ",1785],["T_STRING","html_entity_decode",1785],"(",["T_VARIABLE","$this",1785],["T_OBJECT_OPERATOR","->",1785],["T_STRING","url",1785],["T_OBJECT_OPERATOR","->",1785],["T_STRING","link",1785],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout\/validation'",1785],",",["T_WHITESPACE"," ",1785],["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id={checkout.order.id}'",1785],",",["T_WHITESPACE"," ",1785],["T_STRING","true",1785],")",")",",",["T_WHITESPACE","\n\t\t\t",1785],["T_CONSTANT_ENCAPSED_STRING","'address_update'",1786],["T_WHITESPACE"," ",1786],["T_DOUBLE_ARROW","=>",1786],["T_WHITESPACE"," ",1786],["T_STRING","html_entity_decode",1786],"(",["T_VARIABLE","$this",1786],["T_OBJECT_OPERATOR","->",1786],["T_STRING","url",1786],["T_OBJECT_OPERATOR","->",1786],["T_STRING","link",1786],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout\/addressUpdate'",1786],",",["T_WHITESPACE"," ",1786],["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id={checkout.order.id}'",1786],",",["T_WHITESPACE"," ",1786],["T_STRING","true",1786],")",")",",",["T_WHITESPACE","\n\t\t\t",1786],["T_CONSTANT_ENCAPSED_STRING","'notification'",1787],["T_WHITESPACE","\t ",1787],["T_DOUBLE_ARROW","=>",1787],["T_WHITESPACE"," ",1787],["T_STRING","html_entity_decode",1787],"(",["T_VARIABLE","$this",1787],["T_OBJECT_OPERATOR","->",1787],["T_STRING","url",1787],["T_OBJECT_OPERATOR","->",1787],["T_STRING","link",1787],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/klarna_checkout\/notification'",1787],",",["T_WHITESPACE"," ",1787],["T_CONSTANT_ENCAPSED_STRING","'klarna_order_id={checkout.order.id}'",1787],",",["T_WHITESPACE"," ",1787],["T_STRING","true",1787],")",")",",",["T_WHITESPACE","\n\t\t",1787],")",";",["T_WHITESPACE","\n\n\t\t",1788],["T_IF","if",1790],["T_WHITESPACE"," ",1790],"(",["T_VARIABLE","$this",1790],["T_OBJECT_OPERATOR","->",1790],["T_STRING","config",1790],["T_OBJECT_OPERATOR","->",1790],["T_STRING","get",1790],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_terms'",1790],")",")",["T_WHITESPACE"," ",1790],"{",["T_WHITESPACE","\n\t\t\t",1790],["T_VARIABLE","$merchant_urls",1791],"[",["T_CONSTANT_ENCAPSED_STRING","'terms'",1791],"]",["T_WHITESPACE"," ",1791],"=",["T_WHITESPACE"," ",1791],["T_STRING","html_entity_decode",1791],"(",["T_VARIABLE","$this",1791],["T_OBJECT_OPERATOR","->",1791],["T_STRING","url",1791],["T_OBJECT_OPERATOR","->",1791],["T_STRING","link",1791],"(",["T_CONSTANT_ENCAPSED_STRING","'information\/information'",1791],",",["T_WHITESPACE"," ",1791],["T_CONSTANT_ENCAPSED_STRING","'information_id='",1791],["T_WHITESPACE"," ",1791],".",["T_WHITESPACE"," ",1791],["T_VARIABLE","$this",1791],["T_OBJECT_OPERATOR","->",1791],["T_STRING","config",1791],["T_OBJECT_OPERATOR","->",1791],["T_STRING","get",1791],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_terms'",1791],")",",",["T_WHITESPACE"," ",1791],["T_STRING","true",1791],")",")",";",["T_WHITESPACE","\n\t\t",1791],"}",["T_WHITESPACE","\n\n\t\t",1792],["T_VARIABLE","$country_info",1794],["T_WHITESPACE"," ",1794],"=",["T_WHITESPACE"," ",1794],["T_VARIABLE","$this",1794],["T_OBJECT_OPERATOR","->",1794],["T_STRING","model_localisation_country",1794],["T_OBJECT_OPERATOR","->",1794],["T_STRING","getCountry",1794],"(",["T_VARIABLE","$klarna_account",1794],"[",["T_CONSTANT_ENCAPSED_STRING","'country'",1794],"]",")",";",["T_WHITESPACE","\n\n\t\t",1794],["T_IF","if",1796],["T_WHITESPACE"," ",1796],"(",["T_VARIABLE","$country_info",1796],")",["T_WHITESPACE"," ",1796],"{",["T_WHITESPACE","\n\t\t\t",1796],["T_VARIABLE","$klarna_order_data",1797],"[",["T_CONSTANT_ENCAPSED_STRING","'purchase_country'",1797],"]",["T_WHITESPACE"," ",1797],"=",["T_WHITESPACE"," ",1797],["T_VARIABLE","$country_info",1797],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1797],"]",";",["T_WHITESPACE","\n\t\t",1797],"}",["T_WHITESPACE","\n\n\t\t",1798],["T_VARIABLE","$klarna_order_data",1800],"[",["T_CONSTANT_ENCAPSED_STRING","'purchase_currency'",1800],"]",["T_WHITESPACE"," ",1800],"=",["T_WHITESPACE"," ",1800],["T_VARIABLE","$currency_code",1800],";",["T_WHITESPACE","\n\t\t",1800],["T_VARIABLE","$klarna_order_data",1801],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",1801],"]",["T_WHITESPACE"," ",1801],"=",["T_WHITESPACE"," ",1801],["T_VARIABLE","$klarna_account",1801],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",1801],"]",";",["T_WHITESPACE","\n\n\t\t",1801],["T_VARIABLE","$klarna_order_data",1803],"[",["T_CONSTANT_ENCAPSED_STRING","'order_amount'",1803],"]",["T_WHITESPACE"," ",1803],"=",["T_WHITESPACE"," ",1803],["T_STRING","round",1803],"(",["T_VARIABLE","$this",1803],["T_OBJECT_OPERATOR","->",1803],["T_STRING","currency",1803],["T_OBJECT_OPERATOR","->",1803],["T_STRING","format",1803],"(",["T_VARIABLE","$total",1803],",",["T_WHITESPACE"," ",1803],["T_VARIABLE","$currency_code",1803],",",["T_WHITESPACE"," ",1803],["T_VARIABLE","$currency_value",1803],",",["T_WHITESPACE"," ",1803],["T_STRING","false",1803],")",["T_WHITESPACE"," ",1803],"*",["T_WHITESPACE"," ",1803],["T_LNUMBER","100",1803],")",";",["T_WHITESPACE","\n\t\t",1803],["T_VARIABLE","$klarna_order_data",1804],"[",["T_CONSTANT_ENCAPSED_STRING","'order_tax_amount'",1804],"]",["T_WHITESPACE"," ",1804],"=",["T_WHITESPACE"," ",1804],["T_STRING","round",1804],"(",["T_VARIABLE","$this",1804],["T_OBJECT_OPERATOR","->",1804],["T_STRING","currency",1804],["T_OBJECT_OPERATOR","->",1804],["T_STRING","format",1804],"(",["T_STRING","array_sum",1804],"(",["T_VARIABLE","$taxes",1804],")",",",["T_WHITESPACE"," ",1804],["T_VARIABLE","$currency_code",1804],",",["T_WHITESPACE"," ",1804],["T_VARIABLE","$currency_value",1804],",",["T_WHITESPACE"," ",1804],["T_STRING","false",1804],")",["T_WHITESPACE"," ",1804],"*",["T_WHITESPACE"," ",1804],["T_LNUMBER","100",1804],")",";",["T_WHITESPACE","\n\n\t\t",1804],["T_VARIABLE","$klarna_order_data",1806],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_urls'",1806],"]",["T_WHITESPACE"," ",1806],"=",["T_WHITESPACE"," ",1806],["T_VARIABLE","$merchant_urls",1806],";",["T_WHITESPACE","\n\n\t\t",1806],["T_COMMENT","\/\/ Callback data to be used to spoof\/simulate customer to accurately calculate shipping\n",1808],["T_WHITESPACE","\t\t",1809],["T_VARIABLE","$encrypted_order_data",1809],["T_WHITESPACE"," ",1809],"=",["T_WHITESPACE"," ",1809],["T_VARIABLE","$this",1809],["T_OBJECT_OPERATOR","->",1809],["T_STRING","encryption",1809],["T_OBJECT_OPERATOR","->",1809],["T_STRING","encrypt",1809],"(",["T_STRING","json_encode",1809],"(",["T_ARRAY","array",1809],"(",["T_WHITESPACE","\n\t\t\t",1809],["T_CONSTANT_ENCAPSED_STRING","'session_id'",1810],["T_WHITESPACE","  ",1810],["T_DOUBLE_ARROW","=>",1810],["T_WHITESPACE"," ",1810],["T_STRING","session_id",1810],"(",")",",",["T_WHITESPACE","\n\t\t\t",1810],["T_CONSTANT_ENCAPSED_STRING","'session_key'",1811],["T_WHITESPACE"," ",1811],["T_DOUBLE_ARROW","=>",1811],["T_WHITESPACE"," ",1811],["T_VARIABLE","$this",1811],["T_OBJECT_OPERATOR","->",1811],["T_STRING","session",1811],["T_OBJECT_OPERATOR","->",1811],["T_STRING","getId",1811],"(",")",",",["T_WHITESPACE","\n\t\t\t",1811],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",1812],["T_WHITESPACE"," ",1812],["T_DOUBLE_ARROW","=>",1812],["T_WHITESPACE"," ",1812],["T_VARIABLE","$this",1812],["T_OBJECT_OPERATOR","->",1812],["T_STRING","customer",1812],["T_OBJECT_OPERATOR","->",1812],["T_STRING","getId",1812],"(",")",",",["T_WHITESPACE","\n\t\t\t",1812],["T_CONSTANT_ENCAPSED_STRING","'order_id'",1813],["T_WHITESPACE","\t  ",1813],["T_DOUBLE_ARROW","=>",1813],["T_WHITESPACE"," ",1813],["T_VARIABLE","$this",1813],["T_OBJECT_OPERATOR","->",1813],["T_STRING","session",1813],["T_OBJECT_OPERATOR","->",1813],["T_STRING","data",1813],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1813],"]",",",["T_WHITESPACE","\n\t\t\t",1813],["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",1814],["T_WHITESPACE"," ",1814],["T_DOUBLE_ARROW","=>",1814],["T_WHITESPACE"," ",1814],["T_VARIABLE","$klarna_account",1814],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_id'",1814],"]",",",["T_WHITESPACE","\n\t\t\t",1814],["T_CONSTANT_ENCAPSED_STRING","'secret'",1815],["T_WHITESPACE","      ",1815],["T_DOUBLE_ARROW","=>",1815],["T_WHITESPACE"," ",1815],["T_VARIABLE","$klarna_account",1815],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",1815],"]",["T_WHITESPACE","\n\t\t",1815],")",")",")",";",["T_WHITESPACE","\n\n\t\t",1816],["T_VARIABLE","$encrypted_order_id",1818],["T_WHITESPACE"," ",1818],"=",["T_WHITESPACE"," ",1818],["T_VARIABLE","$this",1818],["T_OBJECT_OPERATOR","->",1818],["T_STRING","encryption",1818],["T_OBJECT_OPERATOR","->",1818],["T_STRING","encrypt",1818],"(",["T_VARIABLE","$this",1818],["T_OBJECT_OPERATOR","->",1818],["T_STRING","session",1818],["T_OBJECT_OPERATOR","->",1818],["T_STRING","data",1818],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1818],"]",")",";",["T_WHITESPACE","\n\n\t\t",1818],["T_VARIABLE","$klarna_order_data",1820],"[",["T_CONSTANT_ENCAPSED_STRING","'merchant_reference1'",1820],"]",["T_WHITESPACE"," ",1820],"=",["T_WHITESPACE"," ",1820],["T_VARIABLE","$this",1820],["T_OBJECT_OPERATOR","->",1820],["T_STRING","session",1820],["T_OBJECT_OPERATOR","->",1820],["T_STRING","data",1820],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",1820],"]",";",["T_WHITESPACE","\n\n\t\t",1820],["T_VARIABLE","$klarna_order_data",1822],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1822],"]",["T_WHITESPACE"," ",1822],"=",["T_WHITESPACE"," ",1822],["T_ARRAY","array",1822],"(",")",";",["T_WHITESPACE","\n\n\t\t",1822],["T_IF","if",1824],["T_WHITESPACE"," ",1824],"(",["T_VARIABLE","$this",1824],["T_OBJECT_OPERATOR","->",1824],["T_STRING","config",1824],["T_OBJECT_OPERATOR","->",1824],["T_STRING","get",1824],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_button'",1824],")",")",["T_WHITESPACE"," ",1824],"{",["T_WHITESPACE","\n\t\t\t",1824],["T_VARIABLE","$klarna_order_data",1825],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1825],"]","[",["T_CONSTANT_ENCAPSED_STRING","'color_button'",1825],"]",["T_WHITESPACE"," ",1825],"=",["T_WHITESPACE"," ",1825],["T_VARIABLE","$this",1825],["T_OBJECT_OPERATOR","->",1825],["T_STRING","config",1825],["T_OBJECT_OPERATOR","->",1825],["T_STRING","get",1825],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_button'",1825],")",";",["T_WHITESPACE","\n\t\t",1825],"}",["T_WHITESPACE","\n\n\t\t",1826],["T_IF","if",1828],["T_WHITESPACE"," ",1828],"(",["T_VARIABLE","$this",1828],["T_OBJECT_OPERATOR","->",1828],["T_STRING","config",1828],["T_OBJECT_OPERATOR","->",1828],["T_STRING","get",1828],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_button_text'",1828],")",")",["T_WHITESPACE"," ",1828],"{",["T_WHITESPACE","\n\t\t\t",1828],["T_VARIABLE","$klarna_order_data",1829],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1829],"]","[",["T_CONSTANT_ENCAPSED_STRING","'color_button_text'",1829],"]",["T_WHITESPACE"," ",1829],"=",["T_WHITESPACE"," ",1829],["T_VARIABLE","$this",1829],["T_OBJECT_OPERATOR","->",1829],["T_STRING","config",1829],["T_OBJECT_OPERATOR","->",1829],["T_STRING","get",1829],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_button_text'",1829],")",";",["T_WHITESPACE","\n\t\t",1829],"}",["T_WHITESPACE","\n\n\t\t",1830],["T_IF","if",1832],["T_WHITESPACE"," ",1832],"(",["T_VARIABLE","$this",1832],["T_OBJECT_OPERATOR","->",1832],["T_STRING","config",1832],["T_OBJECT_OPERATOR","->",1832],["T_STRING","get",1832],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_checkbox'",1832],")",")",["T_WHITESPACE"," ",1832],"{",["T_WHITESPACE","\n\t\t\t",1832],["T_VARIABLE","$klarna_order_data",1833],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1833],"]","[",["T_CONSTANT_ENCAPSED_STRING","'color_checkbox'",1833],"]",["T_WHITESPACE"," ",1833],"=",["T_WHITESPACE"," ",1833],["T_VARIABLE","$this",1833],["T_OBJECT_OPERATOR","->",1833],["T_STRING","config",1833],["T_OBJECT_OPERATOR","->",1833],["T_STRING","get",1833],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_checkbox'",1833],")",";",["T_WHITESPACE","\n\t\t",1833],"}",["T_WHITESPACE","\n\n\t\t",1834],["T_IF","if",1836],["T_WHITESPACE"," ",1836],"(",["T_VARIABLE","$this",1836],["T_OBJECT_OPERATOR","->",1836],["T_STRING","config",1836],["T_OBJECT_OPERATOR","->",1836],["T_STRING","get",1836],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_checkbox_checkmark'",1836],")",")",["T_WHITESPACE"," ",1836],"{",["T_WHITESPACE","\n\t\t\t",1836],["T_VARIABLE","$klarna_order_data",1837],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1837],"]","[",["T_CONSTANT_ENCAPSED_STRING","'color_checkbox_checkmark'",1837],"]",["T_WHITESPACE"," ",1837],"=",["T_WHITESPACE"," ",1837],["T_VARIABLE","$this",1837],["T_OBJECT_OPERATOR","->",1837],["T_STRING","config",1837],["T_OBJECT_OPERATOR","->",1837],["T_STRING","get",1837],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_checkbox_checkmark'",1837],")",";",["T_WHITESPACE","\n\t\t",1837],"}",["T_WHITESPACE","\n\n\t\t",1838],["T_IF","if",1840],["T_WHITESPACE"," ",1840],"(",["T_VARIABLE","$this",1840],["T_OBJECT_OPERATOR","->",1840],["T_STRING","config",1840],["T_OBJECT_OPERATOR","->",1840],["T_STRING","get",1840],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_header'",1840],")",")",["T_WHITESPACE"," ",1840],"{",["T_WHITESPACE","\n\t\t\t",1840],["T_VARIABLE","$klarna_order_data",1841],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1841],"]","[",["T_CONSTANT_ENCAPSED_STRING","'color_header'",1841],"]",["T_WHITESPACE"," ",1841],"=",["T_WHITESPACE"," ",1841],["T_VARIABLE","$this",1841],["T_OBJECT_OPERATOR","->",1841],["T_STRING","config",1841],["T_OBJECT_OPERATOR","->",1841],["T_STRING","get",1841],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_header'",1841],")",";",["T_WHITESPACE","\n\t\t",1841],"}",["T_WHITESPACE","\n\n\t\t",1842],["T_IF","if",1844],["T_WHITESPACE"," ",1844],"(",["T_VARIABLE","$this",1844],["T_OBJECT_OPERATOR","->",1844],["T_STRING","config",1844],["T_OBJECT_OPERATOR","->",1844],["T_STRING","get",1844],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_link'",1844],")",")",["T_WHITESPACE"," ",1844],"{",["T_WHITESPACE","\n\t\t\t",1844],["T_VARIABLE","$klarna_order_data",1845],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1845],"]","[",["T_CONSTANT_ENCAPSED_STRING","'color_link'",1845],"]",["T_WHITESPACE"," ",1845],"=",["T_WHITESPACE"," ",1845],["T_VARIABLE","$this",1845],["T_OBJECT_OPERATOR","->",1845],["T_STRING","config",1845],["T_OBJECT_OPERATOR","->",1845],["T_STRING","get",1845],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_colour_link'",1845],")",";",["T_WHITESPACE","\n\t\t",1845],"}",["T_WHITESPACE","\n\n\t\t",1846],["T_IF","if",1848],["T_WHITESPACE"," ",1848],"(",["T_VARIABLE","$this",1848],["T_OBJECT_OPERATOR","->",1848],["T_STRING","config",1848],["T_OBJECT_OPERATOR","->",1848],["T_STRING","get",1848],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_separate_shipping_address'",1848],")",")",["T_WHITESPACE"," ",1848],"{",["T_WHITESPACE","\n\t\t\t",1848],["T_VARIABLE","$klarna_order_data",1849],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1849],"]","[",["T_CONSTANT_ENCAPSED_STRING","'allow_separate_shipping_address'",1849],"]",["T_WHITESPACE"," ",1849],"=",["T_WHITESPACE"," ",1849],["T_STRING","true",1849],";",["T_WHITESPACE","\n\t\t",1849],"}",["T_WHITESPACE","\n\n\t\t",1850],["T_COMMENT","\/\/ Only pass DOB\/title mandatory for UK stores\n",1852],["T_WHITESPACE","\t\t",1853],["T_IF","if",1853],["T_WHITESPACE"," ",1853],"(",["T_VARIABLE","$country_info",1853],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1853],"]",["T_WHITESPACE"," ",1853],["T_IS_EQUAL","==",1853],["T_WHITESPACE"," ",1853],["T_CONSTANT_ENCAPSED_STRING","'GB'",1853],")",["T_WHITESPACE"," ",1853],"{",["T_WHITESPACE","\n\t\t\t",1853],["T_IF","if",1854],["T_WHITESPACE"," ",1854],"(",["T_VARIABLE","$this",1854],["T_OBJECT_OPERATOR","->",1854],["T_STRING","config",1854],["T_OBJECT_OPERATOR","->",1854],["T_STRING","get",1854],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_dob_mandatory'",1854],")",")",["T_WHITESPACE"," ",1854],"{",["T_WHITESPACE","\n\t\t\t\t",1854],["T_VARIABLE","$klarna_order_data",1855],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1855],"]","[",["T_CONSTANT_ENCAPSED_STRING","'date_of_birth_mandatory'",1855],"]",["T_WHITESPACE"," ",1855],"=",["T_WHITESPACE"," ",1855],["T_STRING","true",1855],";",["T_WHITESPACE","\n\t\t\t",1855],"}",["T_WHITESPACE","\n\n\t\t\t",1856],["T_IF","if",1858],["T_WHITESPACE"," ",1858],"(",["T_VARIABLE","$this",1858],["T_OBJECT_OPERATOR","->",1858],["T_STRING","config",1858],["T_OBJECT_OPERATOR","->",1858],["T_STRING","get",1858],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_title_mandatory'",1858],")",")",["T_WHITESPACE"," ",1858],"{",["T_WHITESPACE","\n\t\t\t\t",1858],["T_VARIABLE","$klarna_order_data",1859],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1859],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title_mandatory'",1859],"]",["T_WHITESPACE"," ",1859],"=",["T_WHITESPACE"," ",1859],["T_STRING","true",1859],";",["T_WHITESPACE","\n\t\t\t",1859],"}",["T_WHITESPACE","\n\t\t",1860],"}",["T_WHITESPACE","\n\n\t\t",1861],["T_IF","if",1863],["T_WHITESPACE"," ",1863],"(",["T_VARIABLE","$this",1863],["T_OBJECT_OPERATOR","->",1863],["T_STRING","config",1863],["T_OBJECT_OPERATOR","->",1863],["T_STRING","get",1863],"(",["T_CONSTANT_ENCAPSED_STRING","'klarna_checkout_additional_text_box'",1863],")",["T_WHITESPACE"," ",1863],["T_BOOLEAN_AND","&&",1863],["T_WHITESPACE"," ",1863],["T_VARIABLE","$this",1863],["T_OBJECT_OPERATOR","->",1863],["T_STRING","customer",1863],["T_OBJECT_OPERATOR","->",1863],["T_STRING","isLogged",1863],"(",")",["T_WHITESPACE"," ",1863],["T_BOOLEAN_AND","&&",1863],["T_WHITESPACE"," ",1863],"!",["T_VARIABLE","$this",1863],["T_OBJECT_OPERATOR","->",1863],["T_STRING","customer",1863],["T_OBJECT_OPERATOR","->",1863],["T_STRING","getNewsletter",1863],"(",")",")",["T_WHITESPACE"," ",1863],"{",["T_WHITESPACE","\n\t\t\t",1863],["T_VARIABLE","$klarna_order_data",1864],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",1864],"]","[",["T_CONSTANT_ENCAPSED_STRING","'additional_checkbox'",1864],"]",["T_WHITESPACE"," ",1864],"=",["T_WHITESPACE"," ",1864],["T_ARRAY","array",1864],"(",["T_WHITESPACE","\n\t\t\t\t",1864],["T_CONSTANT_ENCAPSED_STRING","'text'",1865],["T_WHITESPACE","\t   ",1865],["T_DOUBLE_ARROW","=>",1865],["T_WHITESPACE"," ",1865],["T_VARIABLE","$this",1865],["T_OBJECT_OPERATOR","->",1865],["T_STRING","language",1865],["T_OBJECT_OPERATOR","->",1865],["T_STRING","get",1865],"(",["T_CONSTANT_ENCAPSED_STRING","'text_newsletter'",1865],")",",",["T_WHITESPACE","\n\t\t\t\t",1865],["T_CONSTANT_ENCAPSED_STRING","'checked'",1866],["T_WHITESPACE","  ",1866],["T_DOUBLE_ARROW","=>",1866],["T_WHITESPACE"," ",1866],["T_STRING","false",1866],",",["T_WHITESPACE","\n\t\t\t\t",1866],["T_CONSTANT_ENCAPSED_STRING","'required'",1867],["T_WHITESPACE"," ",1867],["T_DOUBLE_ARROW","=>",1867],["T_WHITESPACE"," ",1867],["T_STRING","false",1867],["T_WHITESPACE","\n\t\t\t",1867],")",";",["T_WHITESPACE","\n\t\t",1868],"}",["T_WHITESPACE","\n\n\t\t",1869],["T_VARIABLE","$shipping_countries",1871],["T_WHITESPACE"," ",1871],"=",["T_WHITESPACE"," ",1871],["T_VARIABLE","$this",1871],["T_OBJECT_OPERATOR","->",1871],["T_STRING","model_extension_payment_klarna_checkout",1871],["T_OBJECT_OPERATOR","->",1871],["T_STRING","getCountriesByGeoZone",1871],"(",["T_VARIABLE","$klarna_account",1871],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping'",1871],"]",")",";",["T_WHITESPACE","\n\n\t\t",1871],["T_VARIABLE","$klarna_shipping_countries",1873],["T_WHITESPACE"," ",1873],"=",["T_WHITESPACE"," ",1873],["T_ARRAY","array",1873],"(",")",";",["T_WHITESPACE","\n\t\t",1873],["T_FOREACH","foreach",1874],["T_WHITESPACE"," ",1874],"(",["T_VARIABLE","$shipping_countries",1874],["T_WHITESPACE"," ",1874],["T_AS","as",1874],["T_WHITESPACE"," ",1874],["T_VARIABLE","$shipping_country",1874],")",["T_WHITESPACE"," ",1874],"{",["T_WHITESPACE","\n\t\t\t",1874],["T_VARIABLE","$country_info",1875],["T_WHITESPACE"," ",1875],"=",["T_WHITESPACE"," ",1875],["T_VARIABLE","$this",1875],["T_OBJECT_OPERATOR","->",1875],["T_STRING","model_localisation_country",1875],["T_OBJECT_OPERATOR","->",1875],["T_STRING","getCountry",1875],"(",["T_VARIABLE","$shipping_country",1875],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",1875],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",1875],["T_IF","if",1877],["T_WHITESPACE"," ",1877],"(",["T_VARIABLE","$country_info",1877],["T_WHITESPACE"," ",1877],["T_BOOLEAN_AND","&&",1877],["T_WHITESPACE"," ",1877],["T_VARIABLE","$country_info",1877],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1877],"]",")",["T_WHITESPACE"," ",1877],"{",["T_WHITESPACE","\n\t\t\t\t",1877],["T_VARIABLE","$klarna_shipping_countries",1878],"[","]",["T_WHITESPACE"," ",1878],"=",["T_WHITESPACE"," ",1878],["T_VARIABLE","$country_info",1878],"[",["T_CONSTANT_ENCAPSED_STRING","'iso_code_2'",1878],"]",";",["T_WHITESPACE","\n\t\t\t",1878],"}",["T_WHITESPACE","\n\t\t",1879],"}",["T_WHITESPACE","\n\n\t\t",1880],["T_VARIABLE","$klarna_order_data",1882],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_countries'",1882],"]",["T_WHITESPACE"," ",1882],"=",["T_WHITESPACE"," ",1882],["T_VARIABLE","$klarna_shipping_countries",1882],";",["T_WHITESPACE","\n\n\t\t",1882],["T_VARIABLE","$average_product_tax_rate",1884],["T_WHITESPACE"," ",1884],"=",["T_WHITESPACE"," ",1884],["T_ARRAY","array",1884],"(",")",";",["T_WHITESPACE","\n\n\t\t",1884],["T_COMMENT","\/\/ Products (Add these last because we send encrypted session order_id)\n",1886],["T_WHITESPACE","\t\t",1887],["T_FOREACH","foreach",1887],["T_WHITESPACE"," ",1887],"(",["T_VARIABLE","$this",1887],["T_OBJECT_OPERATOR","->",1887],["T_STRING","cart",1887],["T_OBJECT_OPERATOR","->",1887],["T_STRING","getProducts",1887],"(",")",["T_WHITESPACE"," ",1887],["T_AS","as",1887],["T_WHITESPACE"," ",1887],["T_VARIABLE","$product",1887],")",["T_WHITESPACE"," ",1887],"{",["T_WHITESPACE","\n\t\t\t",1887],["T_VARIABLE","$total_amount",1888],["T_WHITESPACE"," ",1888],"=",["T_WHITESPACE"," ",1888],["T_VARIABLE","$this",1888],["T_OBJECT_OPERATOR","->",1888],["T_STRING","currency",1888],["T_OBJECT_OPERATOR","->",1888],["T_STRING","format",1888],"(",["T_VARIABLE","$this",1888],["T_OBJECT_OPERATOR","->",1888],["T_STRING","tax",1888],["T_OBJECT_OPERATOR","->",1888],["T_STRING","calculate",1888],"(",["T_VARIABLE","$product",1888],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",1888],"]",",",["T_WHITESPACE"," ",1888],["T_VARIABLE","$product",1888],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1888],"]",",",["T_WHITESPACE"," ",1888],["T_VARIABLE","$include_taxes",1888],")",["T_WHITESPACE"," ",1888],"*",["T_WHITESPACE"," ",1888],["T_VARIABLE","$product",1888],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",1888],"]",",",["T_WHITESPACE"," ",1888],["T_VARIABLE","$currency_code",1888],",",["T_WHITESPACE"," ",1888],["T_VARIABLE","$currency_value",1888],",",["T_WHITESPACE"," ",1888],["T_STRING","false",1888],")",["T_WHITESPACE"," ",1888],"*",["T_WHITESPACE"," ",1888],["T_LNUMBER","100",1888],";",["T_WHITESPACE","\n\n\t\t\t",1888],["T_IF","if",1890],["T_WHITESPACE"," ",1890],"(",["T_VARIABLE","$include_taxes",1890],")",["T_WHITESPACE"," ",1890],"{",["T_WHITESPACE","\n\t\t\t\t",1890],["T_VARIABLE","$total_tax_amount",1891],["T_WHITESPACE"," ",1891],"=",["T_WHITESPACE"," ",1891],["T_VARIABLE","$this",1891],["T_OBJECT_OPERATOR","->",1891],["T_STRING","currency",1891],["T_OBJECT_OPERATOR","->",1891],["T_STRING","format",1891],"(",["T_VARIABLE","$this",1891],["T_OBJECT_OPERATOR","->",1891],["T_STRING","tax",1891],["T_OBJECT_OPERATOR","->",1891],["T_STRING","getTax",1891],"(",["T_VARIABLE","$product",1891],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",1891],"]",",",["T_WHITESPACE"," ",1891],["T_VARIABLE","$product",1891],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1891],"]",")",["T_WHITESPACE"," ",1891],"*",["T_WHITESPACE"," ",1891],["T_VARIABLE","$product",1891],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",1891],"]",",",["T_WHITESPACE"," ",1891],["T_VARIABLE","$currency_code",1891],",",["T_WHITESPACE"," ",1891],["T_VARIABLE","$currency_value",1891],",",["T_WHITESPACE"," ",1891],["T_STRING","false",1891],")",["T_WHITESPACE"," ",1891],"*",["T_WHITESPACE"," ",1891],["T_LNUMBER","100",1891],";",["T_WHITESPACE","\n\t\t\t",1891],"}",["T_WHITESPACE"," ",1892],["T_ELSE","else",1892],["T_WHITESPACE"," ",1892],"{",["T_WHITESPACE","\n\t\t\t\t",1892],["T_VARIABLE","$total_tax_amount",1893],["T_WHITESPACE"," ",1893],"=",["T_WHITESPACE"," ",1893],["T_LNUMBER","0",1893],";",["T_WHITESPACE","\n\t\t\t",1893],"}",["T_WHITESPACE","\n\n\t\t\t",1894],["T_VARIABLE","$total_sub_amount",1896],["T_WHITESPACE"," ",1896],"=",["T_WHITESPACE"," ",1896],["T_VARIABLE","$this",1896],["T_OBJECT_OPERATOR","->",1896],["T_STRING","currency",1896],["T_OBJECT_OPERATOR","->",1896],["T_STRING","format",1896],"(",["T_VARIABLE","$this",1896],["T_OBJECT_OPERATOR","->",1896],["T_STRING","tax",1896],["T_OBJECT_OPERATOR","->",1896],["T_STRING","calculate",1896],"(",["T_VARIABLE","$product",1896],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",1896],"]",",",["T_WHITESPACE"," ",1896],["T_VARIABLE","$product",1896],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1896],"]",",",["T_WHITESPACE"," ",1896],["T_STRING","false",1896],")",["T_WHITESPACE"," ",1896],"*",["T_WHITESPACE"," ",1896],["T_VARIABLE","$product",1896],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",1896],"]",",",["T_WHITESPACE"," ",1896],["T_VARIABLE","$currency_code",1896],",",["T_WHITESPACE"," ",1896],["T_VARIABLE","$currency_value",1896],",",["T_WHITESPACE"," ",1896],["T_STRING","false",1896],")",["T_WHITESPACE"," ",1896],"*",["T_WHITESPACE"," ",1896],["T_LNUMBER","100",1896],";",["T_WHITESPACE","\n\n\t\t\t",1896],["T_VARIABLE","$tax_rate",1898],["T_WHITESPACE"," ",1898],"=",["T_WHITESPACE"," ",1898],["T_LNUMBER","0",1898],";",["T_WHITESPACE","\n\n\t\t\t",1898],["T_IF","if",1900],["T_WHITESPACE"," ",1900],"(",["T_VARIABLE","$include_taxes",1900],["T_WHITESPACE"," ",1900],["T_BOOLEAN_AND","&&",1900],["T_WHITESPACE"," ",1900],["T_VARIABLE","$total_tax_amount",1900],["T_WHITESPACE"," ",1900],["T_BOOLEAN_AND","&&",1900],["T_WHITESPACE"," ",1900],["T_VARIABLE","$total_sub_amount",1900],")",["T_WHITESPACE"," ",1900],"{",["T_WHITESPACE","\n\t\t\t\t",1900],["T_VARIABLE","$tax_rate",1901],["T_WHITESPACE"," ",1901],"=",["T_WHITESPACE"," ",1901],"(",["T_VARIABLE","$total_tax_amount",1901],["T_WHITESPACE"," ",1901],"\/",["T_WHITESPACE"," ",1901],["T_VARIABLE","$total_sub_amount",1901],")",["T_WHITESPACE"," ",1901],"*",["T_WHITESPACE"," ",1901],["T_LNUMBER","100",1901],";",["T_WHITESPACE","\n\t\t\t",1901],"}",["T_WHITESPACE","\n\n\t\t\t",1902],["T_VARIABLE","$average_product_tax_rate",1904],"[","]",["T_WHITESPACE"," ",1904],"=",["T_WHITESPACE"," ",1904],["T_STRING","round",1904],"(",["T_VARIABLE","$tax_rate",1904],["T_WHITESPACE"," ",1904],"*",["T_WHITESPACE"," ",1904],["T_LNUMBER","100",1904],")",";",["T_WHITESPACE","\n\n\t\t\t",1904],["T_VARIABLE","$klarna_order_data",1906],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",1906],"]","[","]",["T_WHITESPACE"," ",1906],"=",["T_WHITESPACE"," ",1906],["T_ARRAY","array",1906],"(",["T_WHITESPACE","\n\t\t\t\t",1906],["T_CONSTANT_ENCAPSED_STRING","'type'",1907],["T_WHITESPACE","\t\t\t\t\t",1907],["T_DOUBLE_ARROW","=>",1907],["T_WHITESPACE"," ",1907],"(",["T_VARIABLE","$product",1907],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping'",1907],"]",["T_WHITESPACE"," ",1907],"?",["T_WHITESPACE"," ",1907],["T_CONSTANT_ENCAPSED_STRING","'physical'",1907],["T_WHITESPACE"," ",1907],":",["T_WHITESPACE"," ",1907],["T_CONSTANT_ENCAPSED_STRING","'digital'",1907],")",",",["T_WHITESPACE","\n\t\t\t\t",1907],["T_CONSTANT_ENCAPSED_STRING","'reference'",1908],["T_WHITESPACE","\t\t\t\t",1908],["T_DOUBLE_ARROW","=>",1908],["T_WHITESPACE"," ",1908],["T_VARIABLE","$product",1908],"[",["T_CONSTANT_ENCAPSED_STRING","'model'",1908],"]",",",["T_WHITESPACE","\n\t\t\t\t",1908],["T_CONSTANT_ENCAPSED_STRING","'name'",1909],["T_WHITESPACE","\t\t\t\t\t",1909],["T_DOUBLE_ARROW","=>",1909],["T_WHITESPACE"," ",1909],["T_VARIABLE","$product",1909],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",1909],"]",",",["T_WHITESPACE","\n\t\t\t\t",1909],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1910],["T_WHITESPACE","\t\t\t\t",1910],["T_DOUBLE_ARROW","=>",1910],["T_WHITESPACE"," ",1910],["T_VARIABLE","$product",1910],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",1910],"]",",",["T_WHITESPACE","\n\t\t\t\t",1910],["T_CONSTANT_ENCAPSED_STRING","'quantity_unit'",1911],["T_WHITESPACE","\t\t\t",1911],["T_DOUBLE_ARROW","=>",1911],["T_WHITESPACE"," ",1911],["T_CONSTANT_ENCAPSED_STRING","'pcs'",1911],",",["T_WHITESPACE","\n\t\t\t\t",1911],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",1912],["T_WHITESPACE","\t\t\t",1912],["T_DOUBLE_ARROW","=>",1912],["T_WHITESPACE"," ",1912],["T_STRING","round",1912],"(",["T_VARIABLE","$this",1912],["T_OBJECT_OPERATOR","->",1912],["T_STRING","currency",1912],["T_OBJECT_OPERATOR","->",1912],["T_STRING","format",1912],"(",["T_VARIABLE","$this",1912],["T_OBJECT_OPERATOR","->",1912],["T_STRING","tax",1912],["T_OBJECT_OPERATOR","->",1912],["T_STRING","calculate",1912],"(",["T_VARIABLE","$product",1912],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",1912],"]",",",["T_WHITESPACE"," ",1912],["T_VARIABLE","$product",1912],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1912],"]",",",["T_WHITESPACE"," ",1912],["T_VARIABLE","$include_taxes",1912],")",",",["T_WHITESPACE"," ",1912],["T_VARIABLE","$currency_code",1912],",",["T_WHITESPACE"," ",1912],["T_VARIABLE","$currency_value",1912],",",["T_WHITESPACE"," ",1912],["T_STRING","false",1912],")",["T_WHITESPACE"," ",1912],"*",["T_WHITESPACE"," ",1912],["T_LNUMBER","100",1912],")",",",["T_WHITESPACE","\n\t\t\t\t",1912],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",1913],["T_WHITESPACE","\t\t\t\t",1913],["T_DOUBLE_ARROW","=>",1913],["T_WHITESPACE"," ",1913],["T_STRING","round",1913],"(",["T_VARIABLE","$tax_rate",1913],["T_WHITESPACE"," ",1913],"*",["T_WHITESPACE"," ",1913],["T_LNUMBER","100",1913],")",",",["T_WHITESPACE","\n\t\t\t\t",1913],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",1914],["T_WHITESPACE","\t\t\t",1914],["T_DOUBLE_ARROW","=>",1914],["T_WHITESPACE"," ",1914],["T_STRING","round",1914],"(",["T_VARIABLE","$total_amount",1914],")",",",["T_WHITESPACE","\n\t\t\t\t",1914],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",1915],["T_WHITESPACE","\t\t",1915],["T_DOUBLE_ARROW","=>",1915],["T_WHITESPACE"," ",1915],["T_STRING","round",1915],"(",["T_VARIABLE","$total_tax_amount",1915],")",",",["T_WHITESPACE","\n\t\t\t\t",1915],["T_CONSTANT_ENCAPSED_STRING","'merchant_data'",1916],["T_WHITESPACE","         ",1916],["T_DOUBLE_ARROW","=>",1916],["T_WHITESPACE"," ",1916],["T_VARIABLE","$encrypted_order_id",1916],",",["T_WHITESPACE","\n\t\t\t\t",1916],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",1917],["T_WHITESPACE"," ",1917],["T_DOUBLE_ARROW","=>",1917],["T_WHITESPACE"," ",1917],["T_LNUMBER","0",1917],["T_WHITESPACE","\n\t\t\t",1917],")",";",["T_WHITESPACE","\n\t\t",1918],"}",["T_WHITESPACE","\n\n\t\t",1919],["T_COMMENT","\/\/ Gift Voucher\n",1921],["T_WHITESPACE","\t\t",1922],["T_IF","if",1922],["T_WHITESPACE"," ",1922],"(","!",["T_EMPTY","empty",1922],"(",["T_VARIABLE","$this",1922],["T_OBJECT_OPERATOR","->",1922],["T_STRING","session",1922],["T_OBJECT_OPERATOR","->",1922],["T_STRING","data",1922],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1922],"]",")",")",["T_WHITESPACE"," ",1922],"{",["T_WHITESPACE","\n\t\t\t",1922],["T_FOREACH","foreach",1923],["T_WHITESPACE"," ",1923],"(",["T_VARIABLE","$this",1923],["T_OBJECT_OPERATOR","->",1923],["T_STRING","session",1923],["T_OBJECT_OPERATOR","->",1923],["T_STRING","data",1923],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",1923],"]",["T_WHITESPACE"," ",1923],["T_AS","as",1923],["T_WHITESPACE"," ",1923],["T_VARIABLE","$key",1923],["T_WHITESPACE"," ",1923],["T_DOUBLE_ARROW","=>",1923],["T_WHITESPACE"," ",1923],["T_VARIABLE","$voucher",1923],")",["T_WHITESPACE"," ",1923],"{",["T_WHITESPACE","\n\t\t\t\t",1923],["T_VARIABLE","$klarna_order_data",1924],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",1924],"]","[","]",["T_WHITESPACE"," ",1924],"=",["T_WHITESPACE"," ",1924],["T_ARRAY","array",1924],"(",["T_WHITESPACE","\n\t\t\t\t\t",1924],["T_CONSTANT_ENCAPSED_STRING","'type'",1925],["T_WHITESPACE","\t\t\t\t\t",1925],["T_DOUBLE_ARROW","=>",1925],["T_WHITESPACE"," ",1925],["T_CONSTANT_ENCAPSED_STRING","'gift_card'",1925],",",["T_WHITESPACE","\n\t\t\t\t\t",1925],["T_CONSTANT_ENCAPSED_STRING","'reference'",1926],["T_WHITESPACE","\t\t\t\t",1926],["T_DOUBLE_ARROW","=>",1926],["T_WHITESPACE"," ",1926],["T_CONSTANT_ENCAPSED_STRING","''",1926],",",["T_WHITESPACE","\n\t\t\t\t\t",1926],["T_CONSTANT_ENCAPSED_STRING","'name'",1927],["T_WHITESPACE","\t\t\t\t\t",1927],["T_DOUBLE_ARROW","=>",1927],["T_WHITESPACE"," ",1927],["T_VARIABLE","$voucher",1927],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",1927],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1927],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1928],["T_WHITESPACE","\t\t\t\t",1928],["T_DOUBLE_ARROW","=>",1928],["T_WHITESPACE"," ",1928],["T_LNUMBER","1",1928],",",["T_WHITESPACE","\n\t\t\t\t\t",1928],["T_CONSTANT_ENCAPSED_STRING","'quantity_unit'",1929],["T_WHITESPACE","\t\t\t",1929],["T_DOUBLE_ARROW","=>",1929],["T_WHITESPACE"," ",1929],["T_CONSTANT_ENCAPSED_STRING","'pcs'",1929],",",["T_WHITESPACE","\n\t\t\t\t\t",1929],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",1930],["T_WHITESPACE","\t\t\t",1930],["T_DOUBLE_ARROW","=>",1930],["T_WHITESPACE"," ",1930],["T_STRING","round",1930],"(",["T_VARIABLE","$this",1930],["T_OBJECT_OPERATOR","->",1930],["T_STRING","currency",1930],["T_OBJECT_OPERATOR","->",1930],["T_STRING","format",1930],"(",["T_VARIABLE","$voucher",1930],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",1930],"]",",",["T_WHITESPACE"," ",1930],["T_VARIABLE","$currency_code",1930],",",["T_WHITESPACE"," ",1930],["T_VARIABLE","$currency_value",1930],",",["T_WHITESPACE"," ",1930],["T_STRING","false",1930],")",["T_WHITESPACE"," ",1930],"*",["T_WHITESPACE"," ",1930],["T_LNUMBER","100",1930],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1930],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",1931],["T_WHITESPACE","\t\t\t\t",1931],["T_DOUBLE_ARROW","=>",1931],["T_WHITESPACE"," ",1931],["T_LNUMBER","0",1931],",",["T_WHITESPACE","\n\t\t\t\t\t",1931],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",1932],["T_WHITESPACE","\t\t\t",1932],["T_DOUBLE_ARROW","=>",1932],["T_WHITESPACE"," ",1932],["T_STRING","round",1932],"(",["T_VARIABLE","$this",1932],["T_OBJECT_OPERATOR","->",1932],["T_STRING","currency",1932],["T_OBJECT_OPERATOR","->",1932],["T_STRING","format",1932],"(",["T_VARIABLE","$voucher",1932],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",1932],"]",",",["T_WHITESPACE"," ",1932],["T_VARIABLE","$currency_code",1932],",",["T_WHITESPACE"," ",1932],["T_VARIABLE","$currency_value",1932],",",["T_WHITESPACE"," ",1932],["T_STRING","false",1932],")",["T_WHITESPACE"," ",1932],"*",["T_WHITESPACE"," ",1932],["T_LNUMBER","100",1932],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1932],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",1933],["T_WHITESPACE","\t\t",1933],["T_DOUBLE_ARROW","=>",1933],["T_WHITESPACE"," ",1933],["T_LNUMBER","0",1933],",",["T_WHITESPACE","\n\t\t\t\t\t",1933],["T_CONSTANT_ENCAPSED_STRING","'merchant_data'",1934],["T_WHITESPACE","         ",1934],["T_DOUBLE_ARROW","=>",1934],["T_WHITESPACE"," ",1934],["T_VARIABLE","$encrypted_order_id",1934],",",["T_WHITESPACE","\n\t\t\t\t\t",1934],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",1935],["T_WHITESPACE"," ",1935],["T_DOUBLE_ARROW","=>",1935],["T_WHITESPACE"," ",1935],["T_LNUMBER","0",1935],["T_WHITESPACE","\n\t\t\t\t",1935],")",";",["T_WHITESPACE","\n\t\t\t",1936],"}",["T_WHITESPACE","\n\t\t",1937],"}",["T_WHITESPACE","\n\n\t\t",1938],["T_FOREACH","foreach",1940],["T_WHITESPACE"," ",1940],"(",["T_VARIABLE","$totals",1940],["T_WHITESPACE"," ",1940],["T_AS","as",1940],["T_WHITESPACE"," ",1940],["T_VARIABLE","$result",1940],")",["T_WHITESPACE"," ",1940],"{",["T_WHITESPACE","\n\t\t\t",1940],["T_IF","if",1941],["T_WHITESPACE"," ",1941],"(",["T_VARIABLE","$result",1941],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1941],"]",["T_WHITESPACE"," ",1941],["T_IS_EQUAL","==",1941],["T_WHITESPACE"," ",1941],["T_CONSTANT_ENCAPSED_STRING","'coupon'",1941],")",["T_WHITESPACE"," ",1941],"{",["T_WHITESPACE","\n\t\t\t\t",1941],["T_VARIABLE","$discount_total_price",1942],["T_WHITESPACE"," ",1942],"=",["T_WHITESPACE"," ",1942],["T_LNUMBER","0",1942],";",["T_WHITESPACE","\n\t\t\t\t",1942],["T_VARIABLE","$discount_sub_total_price",1943],["T_WHITESPACE"," ",1943],"=",["T_WHITESPACE"," ",1943],["T_LNUMBER","0",1943],";",["T_WHITESPACE","\n\t\t\t\t",1943],["T_FOREACH","foreach",1944],["T_WHITESPACE"," ",1944],"(",["T_VARIABLE","$this",1944],["T_OBJECT_OPERATOR","->",1944],["T_STRING","cart",1944],["T_OBJECT_OPERATOR","->",1944],["T_STRING","getProducts",1944],"(",")",["T_WHITESPACE"," ",1944],["T_AS","as",1944],["T_WHITESPACE"," ",1944],["T_VARIABLE","$product",1944],")",["T_WHITESPACE"," ",1944],"{",["T_WHITESPACE","\n\t\t\t\t\t",1944],["T_VARIABLE","$discount_total_price",1945],["T_WHITESPACE"," ",1945],["T_PLUS_EQUAL","+=",1945],["T_WHITESPACE"," ",1945],["T_VARIABLE","$this",1945],["T_OBJECT_OPERATOR","->",1945],["T_STRING","tax",1945],["T_OBJECT_OPERATOR","->",1945],["T_STRING","calculate",1945],"(",["T_VARIABLE","$result",1945],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1945],"]",",",["T_WHITESPACE"," ",1945],["T_VARIABLE","$product",1945],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",1945],"]",",",["T_WHITESPACE"," ",1945],["T_VARIABLE","$include_taxes",1945],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1945],["T_VARIABLE","$discount_sub_total_price",1946],["T_WHITESPACE"," ",1946],["T_PLUS_EQUAL","+=",1946],["T_WHITESPACE"," ",1946],["T_VARIABLE","$result",1946],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1946],"]",";",["T_WHITESPACE","\n\t\t\t\t",1946],"}",["T_WHITESPACE","\n\n\t\t\t\t",1947],["T_VARIABLE","$average_discount_total_price",1949],["T_WHITESPACE"," ",1949],"=",["T_WHITESPACE"," ",1949],["T_VARIABLE","$discount_total_price",1949],["T_WHITESPACE"," ",1949],"\/",["T_WHITESPACE"," ",1949],["T_STRING","count",1949],"(",["T_VARIABLE","$average_product_tax_rate",1949],")",";",["T_WHITESPACE","\n\n\t\t\t\t",1949],["T_VARIABLE","$average_discount_sub_total_price",1951],["T_WHITESPACE"," ",1951],"=",["T_WHITESPACE"," ",1951],["T_VARIABLE","$discount_sub_total_price",1951],["T_WHITESPACE"," ",1951],"\/",["T_WHITESPACE"," ",1951],["T_STRING","count",1951],"(",["T_VARIABLE","$average_product_tax_rate",1951],")",";",["T_WHITESPACE","\n\n\t\t\t\t",1951],["T_VARIABLE","$total_tax_amount",1953],["T_WHITESPACE"," ",1953],"=",["T_WHITESPACE"," ",1953],"(",["T_VARIABLE","$average_discount_sub_total_price",1953],["T_WHITESPACE"," ",1953],"\/",["T_WHITESPACE"," ",1953],["T_LNUMBER","100",1953],")",["T_WHITESPACE"," ",1953],"*",["T_WHITESPACE"," ",1953],"(",["T_STRING","array_sum",1953],"(",["T_VARIABLE","$average_product_tax_rate",1953],")",["T_WHITESPACE"," ",1953],"\/",["T_WHITESPACE"," ",1953],["T_STRING","count",1953],"(",["T_VARIABLE","$average_product_tax_rate",1953],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",1953],["T_VARIABLE","$klarna_order_data",1955],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",1955],"]","[","]",["T_WHITESPACE"," ",1955],"=",["T_WHITESPACE"," ",1955],["T_ARRAY","array",1955],"(",["T_WHITESPACE","\n\t\t\t\t\t",1955],["T_CONSTANT_ENCAPSED_STRING","'type'",1956],["T_WHITESPACE","\t\t\t\t\t",1956],["T_DOUBLE_ARROW","=>",1956],["T_WHITESPACE"," ",1956],["T_CONSTANT_ENCAPSED_STRING","'discount'",1956],",",["T_WHITESPACE","\n\t\t\t\t\t",1956],["T_CONSTANT_ENCAPSED_STRING","'name'",1957],["T_WHITESPACE","\t\t\t\t\t",1957],["T_DOUBLE_ARROW","=>",1957],["T_WHITESPACE"," ",1957],["T_VARIABLE","$result",1957],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",1957],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1957],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1958],["T_WHITESPACE","\t\t\t\t",1958],["T_DOUBLE_ARROW","=>",1958],["T_WHITESPACE"," ",1958],["T_CONSTANT_ENCAPSED_STRING","'1'",1958],",",["T_WHITESPACE","\n\t\t\t\t\t",1958],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",1959],["T_WHITESPACE","\t\t\t",1959],["T_DOUBLE_ARROW","=>",1959],["T_WHITESPACE"," ",1959],["T_STRING","round",1959],"(",["T_VARIABLE","$this",1959],["T_OBJECT_OPERATOR","->",1959],["T_STRING","currency",1959],["T_OBJECT_OPERATOR","->",1959],["T_STRING","format",1959],"(",["T_VARIABLE","$average_discount_total_price",1959],",",["T_WHITESPACE"," ",1959],["T_VARIABLE","$currency_code",1959],",",["T_WHITESPACE"," ",1959],["T_VARIABLE","$currency_value",1959],",",["T_WHITESPACE"," ",1959],["T_STRING","false",1959],")",["T_WHITESPACE"," ",1959],"*",["T_WHITESPACE"," ",1959],["T_LNUMBER","100",1959],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1959],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",1960],["T_WHITESPACE","\t\t\t\t",1960],["T_DOUBLE_ARROW","=>",1960],["T_WHITESPACE"," ",1960],["T_STRING","array_sum",1960],"(",["T_VARIABLE","$average_product_tax_rate",1960],")",["T_WHITESPACE"," ",1960],"\/",["T_WHITESPACE"," ",1960],["T_STRING","count",1960],"(",["T_VARIABLE","$average_product_tax_rate",1960],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1960],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",1961],["T_WHITESPACE","\t\t\t",1961],["T_DOUBLE_ARROW","=>",1961],["T_WHITESPACE"," ",1961],["T_STRING","round",1961],"(",["T_VARIABLE","$this",1961],["T_OBJECT_OPERATOR","->",1961],["T_STRING","currency",1961],["T_OBJECT_OPERATOR","->",1961],["T_STRING","format",1961],"(",["T_VARIABLE","$average_discount_total_price",1961],",",["T_WHITESPACE"," ",1961],["T_VARIABLE","$currency_code",1961],",",["T_WHITESPACE"," ",1961],["T_VARIABLE","$currency_value",1961],",",["T_WHITESPACE"," ",1961],["T_STRING","false",1961],")",["T_WHITESPACE"," ",1961],"*",["T_WHITESPACE"," ",1961],["T_LNUMBER","100",1961],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1961],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",1962],["T_WHITESPACE","\t\t",1962],["T_DOUBLE_ARROW","=>",1962],["T_WHITESPACE"," ",1962],["T_STRING","round",1962],"(",["T_VARIABLE","$total_tax_amount",1962],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1962],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",1963],["T_WHITESPACE"," ",1963],["T_DOUBLE_ARROW","=>",1963],["T_WHITESPACE"," ",1963],["T_LNUMBER","0",1963],["T_WHITESPACE","\n\t\t\t\t",1963],")",";",["T_WHITESPACE","\n\t\t\t",1964],"}",["T_WHITESPACE","\n\n\t\t\t",1965],["T_IF","if",1967],["T_WHITESPACE"," ",1967],"(",["T_VARIABLE","$result",1967],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",1967],"]",["T_WHITESPACE"," ",1967],["T_IS_EQUAL","==",1967],["T_WHITESPACE"," ",1967],["T_CONSTANT_ENCAPSED_STRING","'voucher'",1967],")",["T_WHITESPACE"," ",1967],"{",["T_WHITESPACE","\n\t\t\t\t",1967],["T_VARIABLE","$klarna_order_data",1968],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",1968],"]","[","]",["T_WHITESPACE"," ",1968],"=",["T_WHITESPACE"," ",1968],["T_ARRAY","array",1968],"(",["T_WHITESPACE","\n\t\t\t\t\t",1968],["T_CONSTANT_ENCAPSED_STRING","'type'",1969],["T_WHITESPACE","\t\t\t\t\t",1969],["T_DOUBLE_ARROW","=>",1969],["T_WHITESPACE"," ",1969],["T_CONSTANT_ENCAPSED_STRING","'discount'",1969],",",["T_WHITESPACE","\n\t\t\t\t\t",1969],["T_CONSTANT_ENCAPSED_STRING","'name'",1970],["T_WHITESPACE","\t\t\t\t\t",1970],["T_DOUBLE_ARROW","=>",1970],["T_WHITESPACE"," ",1970],["T_VARIABLE","$result",1970],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",1970],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",1970],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1971],["T_WHITESPACE","\t\t\t\t",1971],["T_DOUBLE_ARROW","=>",1971],["T_WHITESPACE"," ",1971],["T_CONSTANT_ENCAPSED_STRING","'1'",1971],",",["T_WHITESPACE","\n\t\t\t\t\t",1971],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",1972],["T_WHITESPACE","\t\t\t",1972],["T_DOUBLE_ARROW","=>",1972],["T_WHITESPACE"," ",1972],["T_STRING","round",1972],"(",["T_VARIABLE","$this",1972],["T_OBJECT_OPERATOR","->",1972],["T_STRING","currency",1972],["T_OBJECT_OPERATOR","->",1972],["T_STRING","format",1972],"(",["T_VARIABLE","$result",1972],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1972],"]",",",["T_WHITESPACE"," ",1972],["T_VARIABLE","$currency_code",1972],",",["T_WHITESPACE"," ",1972],["T_VARIABLE","$currency_value",1972],",",["T_WHITESPACE"," ",1972],["T_STRING","false",1972],")",["T_WHITESPACE"," ",1972],"*",["T_WHITESPACE"," ",1972],["T_LNUMBER","100",1972],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1972],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",1973],["T_WHITESPACE","\t\t\t\t",1973],["T_DOUBLE_ARROW","=>",1973],["T_WHITESPACE"," ",1973],["T_LNUMBER","0",1973],",",["T_WHITESPACE","\n\t\t\t\t\t",1973],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",1974],["T_WHITESPACE","\t\t\t",1974],["T_DOUBLE_ARROW","=>",1974],["T_WHITESPACE"," ",1974],["T_STRING","round",1974],"(",["T_VARIABLE","$this",1974],["T_OBJECT_OPERATOR","->",1974],["T_STRING","currency",1974],["T_OBJECT_OPERATOR","->",1974],["T_STRING","format",1974],"(",["T_VARIABLE","$result",1974],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1974],"]",",",["T_WHITESPACE"," ",1974],["T_VARIABLE","$currency_code",1974],",",["T_WHITESPACE"," ",1974],["T_VARIABLE","$currency_value",1974],",",["T_WHITESPACE"," ",1974],["T_STRING","false",1974],")",["T_WHITESPACE"," ",1974],"*",["T_WHITESPACE"," ",1974],["T_LNUMBER","100",1974],")",",",["T_WHITESPACE","\n\t\t\t\t\t",1974],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",1975],["T_WHITESPACE","\t\t",1975],["T_DOUBLE_ARROW","=>",1975],["T_WHITESPACE"," ",1975],["T_LNUMBER","0",1975],",",["T_WHITESPACE","\n\t\t\t\t\t",1975],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",1976],["T_WHITESPACE"," ",1976],["T_DOUBLE_ARROW","=>",1976],["T_WHITESPACE"," ",1976],["T_LNUMBER","0",1976],["T_WHITESPACE","\n\t\t\t\t",1976],")",";",["T_WHITESPACE","\n\t\t\t",1977],"}",["T_WHITESPACE","\n\t\t",1978],"}",["T_WHITESPACE","\n\n\t\t",1979],["T_COMMENT","\/\/If $include_taxes is false, means customer is US so we add a new sales_tax order line with all the tax\n",1981],["T_WHITESPACE","\t\t",1982],["T_IF","if",1982],["T_WHITESPACE"," ",1982],"(","!",["T_VARIABLE","$include_taxes",1982],")",["T_WHITESPACE"," ",1982],"{",["T_WHITESPACE","\n\t\t\t",1982],["T_VARIABLE","$klarna_order_data",1983],"[",["T_CONSTANT_ENCAPSED_STRING","'order_lines'",1983],"]","[","]",["T_WHITESPACE"," ",1983],"=",["T_WHITESPACE"," ",1983],["T_ARRAY","array",1983],"(",["T_WHITESPACE","\n\t\t\t\t",1983],["T_CONSTANT_ENCAPSED_STRING","'type'",1984],["T_WHITESPACE","\t\t\t\t\t",1984],["T_DOUBLE_ARROW","=>",1984],["T_WHITESPACE"," ",1984],["T_CONSTANT_ENCAPSED_STRING","'sales_tax'",1984],",",["T_WHITESPACE","\n\t\t\t\t",1984],["T_CONSTANT_ENCAPSED_STRING","'name'",1985],["T_WHITESPACE","\t\t\t\t\t",1985],["T_DOUBLE_ARROW","=>",1985],["T_WHITESPACE"," ",1985],["T_VARIABLE","$this",1985],["T_OBJECT_OPERATOR","->",1985],["T_STRING","language",1985],["T_OBJECT_OPERATOR","->",1985],["T_STRING","get",1985],"(",["T_CONSTANT_ENCAPSED_STRING","'text_sales_tax'",1985],")",",",["T_WHITESPACE","\n\t\t\t\t",1985],["T_CONSTANT_ENCAPSED_STRING","'quantity'",1986],["T_WHITESPACE","\t\t\t\t",1986],["T_DOUBLE_ARROW","=>",1986],["T_WHITESPACE"," ",1986],["T_CONSTANT_ENCAPSED_STRING","'1'",1986],",",["T_WHITESPACE","\n\t\t\t\t",1986],["T_CONSTANT_ENCAPSED_STRING","'unit_price'",1987],["T_WHITESPACE","\t\t\t",1987],["T_DOUBLE_ARROW","=>",1987],["T_WHITESPACE"," ",1987],["T_STRING","round",1987],"(",["T_VARIABLE","$this",1987],["T_OBJECT_OPERATOR","->",1987],["T_STRING","currency",1987],["T_OBJECT_OPERATOR","->",1987],["T_STRING","format",1987],"(",["T_STRING","array_sum",1987],"(",["T_VARIABLE","$taxes",1987],")",",",["T_WHITESPACE"," ",1987],["T_VARIABLE","$currency_code",1987],",",["T_WHITESPACE"," ",1987],["T_VARIABLE","$currency_value",1987],",",["T_WHITESPACE"," ",1987],["T_STRING","false",1987],")",["T_WHITESPACE"," ",1987],"*",["T_WHITESPACE"," ",1987],["T_LNUMBER","100",1987],")",",",["T_WHITESPACE","\n\t\t\t\t",1987],["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",1988],["T_WHITESPACE","\t\t\t\t",1988],["T_DOUBLE_ARROW","=>",1988],["T_WHITESPACE"," ",1988],["T_LNUMBER","0",1988],",",["T_WHITESPACE","\n\t\t\t\t",1988],["T_CONSTANT_ENCAPSED_STRING","'total_amount'",1989],["T_WHITESPACE","\t\t\t",1989],["T_DOUBLE_ARROW","=>",1989],["T_WHITESPACE"," ",1989],["T_STRING","round",1989],"(",["T_VARIABLE","$this",1989],["T_OBJECT_OPERATOR","->",1989],["T_STRING","currency",1989],["T_OBJECT_OPERATOR","->",1989],["T_STRING","format",1989],"(",["T_STRING","array_sum",1989],"(",["T_VARIABLE","$taxes",1989],")",",",["T_WHITESPACE"," ",1989],["T_VARIABLE","$currency_code",1989],",",["T_WHITESPACE"," ",1989],["T_VARIABLE","$currency_value",1989],",",["T_WHITESPACE"," ",1989],["T_STRING","false",1989],")",["T_WHITESPACE"," ",1989],"*",["T_WHITESPACE"," ",1989],["T_LNUMBER","100",1989],")",",",["T_WHITESPACE","\n\t\t\t\t",1989],["T_CONSTANT_ENCAPSED_STRING","'total_tax_amount'",1990],["T_WHITESPACE","\t\t",1990],["T_DOUBLE_ARROW","=>",1990],["T_WHITESPACE"," ",1990],["T_LNUMBER","0",1990],",",["T_WHITESPACE","\n\t\t\t\t",1990],["T_CONSTANT_ENCAPSED_STRING","'total_discount_amount'",1991],["T_WHITESPACE"," ",1991],["T_DOUBLE_ARROW","=>",1991],["T_WHITESPACE"," ",1991],["T_LNUMBER","0",1991],["T_WHITESPACE","\n\t\t\t",1991],")",";",["T_WHITESPACE","\n\t\t",1992],"}",["T_WHITESPACE","\n\n\t\t",1993],["T_RETURN","return",1995],["T_WHITESPACE"," ",1995],["T_ARRAY","array",1995],"(",["T_VARIABLE","$klarna_order_data",1995],",",["T_WHITESPACE"," ",1995],["T_VARIABLE","$encrypted_order_data",1995],")",";",["T_WHITESPACE","\n\t",1995],"}",["T_WHITESPACE","\n",1996],"}",["T_WHITESPACE","\n",1997]]