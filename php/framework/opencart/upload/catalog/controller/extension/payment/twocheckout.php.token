[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionPaymentTwoCheckout",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","index",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$data",4],"[",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",4],"]",["T_WHITESPACE"," ",4],"=",["T_WHITESPACE"," ",4],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","language",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","get",4],"(",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","load",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","model",6],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",6],")",";",["T_WHITESPACE","\n\n\t\t",6],["T_VARIABLE","$order_info",8],["T_WHITESPACE"," ",8],"=",["T_WHITESPACE"," ",8],["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","model_checkout_order",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","getOrder",8],"(",["T_VARIABLE","$this",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","session",8],["T_OBJECT_OPERATOR","->",8],["T_STRING","data",8],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",8],"]",")",";",["T_WHITESPACE","\n\n\t\t",8],["T_VARIABLE","$data",10],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",10],"]",["T_WHITESPACE"," ",10],"=",["T_WHITESPACE"," ",10],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.2checkout.com\/checkout\/purchase'",10],";",["T_WHITESPACE","\n\n\t\t",10],["T_VARIABLE","$data",12],"[",["T_CONSTANT_ENCAPSED_STRING","'sid'",12],"]",["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_VARIABLE","$this",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","config",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","get",12],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_account'",12],")",";",["T_WHITESPACE","\n\t\t",12],["T_VARIABLE","$data",13],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",13],"]",["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_VARIABLE","$order_info",13],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",13],"]",";",["T_WHITESPACE","\n\t\t",13],["T_VARIABLE","$data",14],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",14],"]",["T_WHITESPACE"," ",14],"=",["T_WHITESPACE"," ",14],["T_VARIABLE","$this",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","currency",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","format",14],"(",["T_VARIABLE","$order_info",14],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",14],"]",",",["T_WHITESPACE"," ",14],["T_VARIABLE","$order_info",14],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",14],"]",",",["T_WHITESPACE"," ",14],["T_VARIABLE","$order_info",14],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",14],"]",",",["T_WHITESPACE"," ",14],["T_STRING","false",14],")",";",["T_WHITESPACE","\n\t\t",14],["T_VARIABLE","$data",15],"[",["T_CONSTANT_ENCAPSED_STRING","'cart_order_id'",15],"]",["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","session",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","data",15],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",15],"]",";",["T_WHITESPACE","\n\t\t",15],["T_VARIABLE","$data",16],"[",["T_CONSTANT_ENCAPSED_STRING","'card_holder_name'",16],"]",["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_VARIABLE","$order_info",16],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",16],"]",["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","' '",16],["T_WHITESPACE"," ",16],".",["T_WHITESPACE"," ",16],["T_VARIABLE","$order_info",16],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",16],"]",";",["T_WHITESPACE","\n\t\t",16],["T_VARIABLE","$data",17],"[",["T_CONSTANT_ENCAPSED_STRING","'street_address'",17],"]",["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_VARIABLE","$order_info",17],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",17],"]",";",["T_WHITESPACE","\n\t\t",17],["T_VARIABLE","$data",18],"[",["T_CONSTANT_ENCAPSED_STRING","'city'",18],"]",["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_VARIABLE","$order_info",18],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",18],"]",";",["T_WHITESPACE","\n\n\t\t",18],["T_IF","if",20],["T_WHITESPACE"," ",20],"(",["T_VARIABLE","$order_info",20],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_iso_code_2'",20],"]",["T_WHITESPACE"," ",20],["T_IS_EQUAL","==",20],["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'US'",20],["T_WHITESPACE"," ",20],["T_BOOLEAN_OR","||",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$order_info",20],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_iso_code_2'",20],"]",["T_WHITESPACE"," ",20],["T_IS_EQUAL","==",20],["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'CA'",20],")",["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n\t\t\t",20],["T_VARIABLE","$data",21],"[",["T_CONSTANT_ENCAPSED_STRING","'state'",21],"]",["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_VARIABLE","$order_info",21],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",21],"]",";",["T_WHITESPACE","\n\t\t",21],"}",["T_WHITESPACE"," ",22],["T_ELSE","else",22],["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\t\t\t",22],["T_VARIABLE","$data",23],"[",["T_CONSTANT_ENCAPSED_STRING","'state'",23],"]",["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'XX'",23],";",["T_WHITESPACE","\n\t\t",23],"}",["T_WHITESPACE","\n\n\t\t",24],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'zip'",26],"]",["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$order_info",26],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",26],"]",";",["T_WHITESPACE","\n\t\t",26],["T_VARIABLE","$data",27],"[",["T_CONSTANT_ENCAPSED_STRING","'country'",27],"]",["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$order_info",27],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country'",27],"]",";",["T_WHITESPACE","\n\t\t",27],["T_VARIABLE","$data",28],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",28],"]",["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$order_info",28],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",28],"]",";",["T_WHITESPACE","\n\t\t",28],["T_VARIABLE","$data",29],"[",["T_CONSTANT_ENCAPSED_STRING","'phone'",29],"]",["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$order_info",29],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",29],"]",";",["T_WHITESPACE","\n\n\t\t",29],["T_IF","if",31],["T_WHITESPACE"," ",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","cart",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","hasShipping",31],"(",")",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n\t\t\t",31],["T_VARIABLE","$data",32],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_street_address'",32],"]",["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$order_info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",32],"]",";",["T_WHITESPACE","\n\t\t\t",32],["T_VARIABLE","$data",33],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_city'",33],"]",["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_VARIABLE","$order_info",33],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",33],"]",";",["T_WHITESPACE","\n\t\t\t",33],["T_VARIABLE","$data",34],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_state'",34],"]",["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$order_info",34],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",34],"]",";",["T_WHITESPACE","\n\t\t\t",34],["T_VARIABLE","$data",35],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_zip'",35],"]",["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$order_info",35],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",35],"]",";",["T_WHITESPACE","\n\t\t\t",35],["T_VARIABLE","$data",36],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_country'",36],"]",["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$order_info",36],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",36],"]",";",["T_WHITESPACE","\n\t\t",36],"}",["T_WHITESPACE"," ",37],["T_ELSE","else",37],["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n\t\t\t",37],["T_VARIABLE","$data",38],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_street_address'",38],"]",["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$order_info",38],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",38],"]",";",["T_WHITESPACE","\n\t\t\t",38],["T_VARIABLE","$data",39],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_city'",39],"]",["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$order_info",39],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",39],"]",";",["T_WHITESPACE","\n\t\t\t",39],["T_VARIABLE","$data",40],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_state'",40],"]",["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$order_info",40],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",40],"]",";",["T_WHITESPACE","\n\t\t\t",40],["T_VARIABLE","$data",41],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_zip'",41],"]",["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$order_info",41],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",41],"]",";",["T_WHITESPACE","\n\t\t\t",41],["T_VARIABLE","$data",42],"[",["T_CONSTANT_ENCAPSED_STRING","'ship_country'",42],"]",["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$order_info",42],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country'",42],"]",";",["T_WHITESPACE","\n\t\t",42],"}",["T_WHITESPACE","\n\n\t\t",43],["T_VARIABLE","$data",45],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",45],"]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",")",";",["T_WHITESPACE","\n\n\t\t",45],["T_VARIABLE","$products",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","cart",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getProducts",47],"(",")",";",["T_WHITESPACE","\n\n\t\t",47],["T_FOREACH","foreach",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$products",49],["T_WHITESPACE"," ",49],["T_AS","as",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$product",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\t\t\t",49],["T_VARIABLE","$data",50],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",50],"]","[","]",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_ARRAY","array",50],"(",["T_WHITESPACE","\n\t\t\t\t",50],["T_CONSTANT_ENCAPSED_STRING","'product_id'",51],["T_WHITESPACE","  ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$product",51],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",51],"]",",",["T_WHITESPACE","\n\t\t\t\t",51],["T_CONSTANT_ENCAPSED_STRING","'name'",52],["T_WHITESPACE","        ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$product",52],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",52],"]",",",["T_WHITESPACE","\n\t\t\t\t",52],["T_CONSTANT_ENCAPSED_STRING","'description'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$product",53],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",53],"]",",",["T_WHITESPACE","\n\t\t\t\t",53],["T_CONSTANT_ENCAPSED_STRING","'quantity'",54],["T_WHITESPACE","    ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$product",54],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",54],"]",",",["T_WHITESPACE","\n\t\t\t\t",54],["T_CONSTANT_ENCAPSED_STRING","'price'",55],["T_WHITESPACE","       ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","currency",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","format",55],"(",["T_VARIABLE","$product",55],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",55],"]",",",["T_WHITESPACE"," ",55],["T_VARIABLE","$order_info",55],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",55],"]",",",["T_WHITESPACE"," ",55],["T_VARIABLE","$order_info",55],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",55],"]",",",["T_WHITESPACE"," ",55],["T_STRING","false",55],")",["T_WHITESPACE","\n\t\t\t",55],")",";",["T_WHITESPACE","\n\t\t",56],"}",["T_WHITESPACE","\n\n\t\t",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","config",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_test'",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n\t\t\t",59],["T_VARIABLE","$data",60],"[",["T_CONSTANT_ENCAPSED_STRING","'demo'",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'Y'",60],";",["T_WHITESPACE","\n\t\t",60],"}",["T_WHITESPACE"," ",61],["T_ELSE","else",61],["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n\t\t\t",61],["T_VARIABLE","$data",62],"[",["T_CONSTANT_ENCAPSED_STRING","'demo'",62],"]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","''",62],";",["T_WHITESPACE","\n\t\t",62],"}",["T_WHITESPACE","\n\n\t\t",63],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","config",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","get",65],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_display'",65],")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t\t",65],["T_VARIABLE","$data",66],"[",["T_CONSTANT_ENCAPSED_STRING","'display'",66],"]",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'Y'",66],";",["T_WHITESPACE","\n\t\t",66],"}",["T_WHITESPACE"," ",67],["T_ELSE","else",67],["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n\t\t\t",67],["T_VARIABLE","$data",68],"[",["T_CONSTANT_ENCAPSED_STRING","'display'",68],"]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","''",68],";",["T_WHITESPACE","\n\t\t",68],"}",["T_WHITESPACE","\n\n\t\t",69],["T_VARIABLE","$data",71],"[",["T_CONSTANT_ENCAPSED_STRING","'lang'",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","session",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","data",71],"[",["T_CONSTANT_ENCAPSED_STRING","'language'",71],"]",";",["T_WHITESPACE","\n\n\t\t",71],["T_VARIABLE","$data",73],"[",["T_CONSTANT_ENCAPSED_STRING","'return_url'",73],"]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","url",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","link",73],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/twocheckout\/callback'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","''",73],",",["T_WHITESPACE"," ",73],["T_STRING","true",73],")",";",["T_WHITESPACE","\n\n\t\t",73],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","load",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","view",75],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/twocheckout'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$data",75],")",";",["T_WHITESPACE","\n\t",75],"}",["T_WHITESPACE","\n\n\t",76],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","callback",78],"(",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","load",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","model",79],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",79],")",";",["T_WHITESPACE","\n\n\t\t",79],["T_VARIABLE","$order_info",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","model_checkout_order",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getOrder",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","request",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","post",81],"[",["T_CONSTANT_ENCAPSED_STRING","'cart_order_id'",81],"]",")",";",["T_WHITESPACE","\n\n\t\t",81],["T_IF","if",83],["T_WHITESPACE"," ",83],"(","!",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","config",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","get",83],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_test'",83],")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n\t\t\t",83],["T_VARIABLE","$order_number",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","request",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","post",84],"[",["T_CONSTANT_ENCAPSED_STRING","'order_number'",84],"]",";",["T_WHITESPACE","\n\t\t",84],"}",["T_WHITESPACE"," ",85],["T_ELSE","else",85],["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n\t\t\t",85],["T_VARIABLE","$order_number",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'1'",86],";",["T_WHITESPACE","\n\t\t",86],"}",["T_WHITESPACE","\n\n\t\t",87],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_STRING","strtoupper",89],"(",["T_STRING","md5",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","get",89],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_secret'",89],")",["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","get",89],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_account'",89],")",["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$order_number",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","request",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","post",89],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",89],"]",")",")",["T_WHITESPACE"," ",89],["T_IS_EQUAL","==",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","request",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","post",89],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",89],"]",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n\t\t\t",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","currency",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","format",90],"(",["T_VARIABLE","$order_info",90],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",90],"]",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$order_info",90],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",90],"]",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$order_info",90],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",90],"]",",",["T_WHITESPACE"," ",90],["T_STRING","false",90],")",["T_WHITESPACE"," ",90],["T_IS_EQUAL","==",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","request",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","post",90],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",90],"]",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n\t\t\t\t",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","model_checkout_order",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","addOrderHistory",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","request",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","post",91],"[",["T_CONSTANT_ENCAPSED_STRING","'cart_order_id'",91],"]",",",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","config",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","get",91],"(",["T_CONSTANT_ENCAPSED_STRING","'twocheckout_order_status_id'",91],")",")",";",["T_WHITESPACE","\n\t\t\t",91],"}",["T_WHITESPACE"," ",92],["T_ELSE","else",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n\t\t\t\t",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","model_checkout_order",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","addOrderHistory",93],"(",["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","request",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","post",93],"[",["T_CONSTANT_ENCAPSED_STRING","'cart_order_id'",93],"]",",",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","config",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","get",93],"(",["T_CONSTANT_ENCAPSED_STRING","'config_order_status_id'",93],")",")",";",["T_COMMENT","\/\/ Ugh. Some one've faked the sum. What should we do? Probably drop a mail to the shop owner?\n",93],["T_WHITESPACE","\t\t\t",94],"}",["T_WHITESPACE","\n\n\t\t\t",94],["T_COMMENT","\/\/ We can't use $this->response->redirect() here, because of 2CO behavior. It fetches this page\n",96],["T_WHITESPACE","\t\t\t",97],["T_COMMENT","\/\/ on behalf of the user and thus user (and his browser) see this as located at 2checkout.com\n",97],["T_WHITESPACE","\t\t\t",98],["T_COMMENT","\/\/ domain. So user's cookies are not here and he will see empty basket and probably other\n",98],["T_WHITESPACE","\t\t\t",99],["T_COMMENT","\/\/ weird things.\n",99],["T_WHITESPACE","\n\t\t\t",100],["T_ECHO","echo",101],["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'<html>'",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",101],";",["T_WHITESPACE","\n\t\t\t",101],["T_ECHO","echo",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'<head>'",102],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",102],";",["T_WHITESPACE","\n\t\t\t",102],["T_ECHO","echo",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'  <meta http-equiv=\"Refresh\" content=\"0; url='",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","url",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","link",103],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",103],")",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'\">'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",103],";",["T_WHITESPACE","\n\t\t\t",103],["T_ECHO","echo",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'<\/head>'",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",104],";",["T_WHITESPACE","\n\t\t\t",104],["T_ECHO","echo",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'<body>'",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",105],";",["T_WHITESPACE","\n\t\t\t",105],["T_ECHO","echo",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'  <p>Please follow <a href=\"'",106],["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","url",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","link",106],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",106],")",["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'\">link<\/a>!<\/p>'",106],["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",106],";",["T_WHITESPACE","\n\t\t\t",106],["T_ECHO","echo",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'<\/body>'",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",107],";",["T_WHITESPACE","\n\t\t\t",107],["T_ECHO","echo",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'<\/html>'",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",108],";",["T_WHITESPACE","\n\t\t\t",108],["T_EXIT","exit",109],"(",")",";",["T_WHITESPACE","\n\t\t",109],"}",["T_WHITESPACE"," ",110],["T_ELSE","else",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n\t\t\t",110],["T_ECHO","echo",111],["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'The response from 2checkout.com can\\'t be parsed. Contact site administrator, please!'",111],";",["T_WHITESPACE","\n\t\t",111],"}",["T_WHITESPACE","\n\t",112],"}",["T_WHITESPACE","\n",113],"}"]