[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","ControllerExtensionPaymentPilibaba",2],["T_WHITESPACE"," ",2],["T_EXTENDS","extends",2],["T_WHITESPACE"," ",2],["T_STRING","Controller",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_FUNCTION","function",3],["T_WHITESPACE"," ",3],["T_STRING","index",3],"(",")",["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t\t",3],["T_VARIABLE","$this",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","load",4],["T_OBJECT_OPERATOR","->",4],["T_STRING","language",4],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",4],")",";",["T_WHITESPACE","\n\n\t\t",4],["T_VARIABLE","$this",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","load",6],["T_OBJECT_OPERATOR","->",6],["T_STRING","model",6],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",6],")",";",["T_WHITESPACE","\n\t\t",6],["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","load",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","model",7],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",7],")",";",["T_WHITESPACE","\n\n\t\t",7],["T_VARIABLE","$this",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","model_extension_payment_pilibaba",9],["T_OBJECT_OPERATOR","->",9],["T_STRING","log",9],"(",["T_CONSTANT_ENCAPSED_STRING","'Regular called'",9],")",";",["T_WHITESPACE","\n\n\t\t",9],["T_VARIABLE","$order_info",11],["T_WHITESPACE"," ",11],"=",["T_WHITESPACE"," ",11],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","model_checkout_order",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","getOrder",11],"(",["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","session",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","data",11],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",11],"]",")",";",["T_WHITESPACE","\n\n\t\t",11],["T_VARIABLE","$data",13],"[",["T_CONSTANT_ENCAPSED_STRING","'version'",13],"]",["T_WHITESPACE","      ",13],"=",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","'V2.0.01'",13],";",["T_WHITESPACE","\n\t\t",13],["T_VARIABLE","$data",14],"[",["T_CONSTANT_ENCAPSED_STRING","'merchantNo'",14],"]",["T_WHITESPACE","   ",14],"=",["T_WHITESPACE"," ",14],["T_VARIABLE","$this",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","config",14],["T_OBJECT_OPERATOR","->",14],["T_STRING","get",14],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_merchant_number'",14],")",";",["T_WHITESPACE","\n\t\t",14],["T_VARIABLE","$data",15],"[",["T_CONSTANT_ENCAPSED_STRING","'currencyType'",15],"]",["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_VARIABLE","$order_info",15],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",15],"]",";",["T_WHITESPACE","\n\t\t",15],["T_VARIABLE","$data",16],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",16],"]",["T_WHITESPACE","      ",16],"=",["T_WHITESPACE"," ",16],["T_VARIABLE","$order_info",16],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",16],"]",";",["T_WHITESPACE","\n\t\t",16],["T_VARIABLE","$data",17],"[",["T_CONSTANT_ENCAPSED_STRING","'orderAmount'",17],"]",["T_WHITESPACE","  ",17],"=",["T_WHITESPACE"," ",17],["T_STRING","intval",17],"(",["T_STRING","round",17],"(",["T_VARIABLE","$order_info",17],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",17],"]",",",["T_WHITESPACE"," ",17],["T_LNUMBER","2",17],")",["T_WHITESPACE"," ",17],"*",["T_WHITESPACE"," ",17],["T_LNUMBER","100",17],")",";",["T_WHITESPACE","\n\t\t",17],["T_VARIABLE","$data",18],"[",["T_CONSTANT_ENCAPSED_STRING","'orderTime'",18],"]",["T_WHITESPACE","    ",18],"=",["T_WHITESPACE"," ",18],["T_STRING","date",18],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d H:i:s'",18],")",";",["T_WHITESPACE","\n\t\t",18],["T_VARIABLE","$data",19],"[",["T_CONSTANT_ENCAPSED_STRING","'pageUrl'",19],"]",["T_WHITESPACE","      ",19],"=",["T_WHITESPACE"," ",19],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","url",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","link",19],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",19],",",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","''",19],",",["T_WHITESPACE"," ",19],["T_STRING","true",19],")",";",["T_WHITESPACE","\n\t\t",19],["T_VARIABLE","$data",20],"[",["T_CONSTANT_ENCAPSED_STRING","'serverUrl'",20],"]",["T_WHITESPACE","    ",20],"=",["T_WHITESPACE"," ",20],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","url",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","link",20],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba\/callback'",20],",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","''",20],",",["T_WHITESPACE"," ",20],["T_STRING","true",20],")",";",["T_WHITESPACE","\n\t\t",20],["T_VARIABLE","$data",21],"[",["T_CONSTANT_ENCAPSED_STRING","'redirectUrl'",21],"]",["T_WHITESPACE","  ",21],"=",["T_WHITESPACE"," ",21],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","url",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","link",21],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",21],",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","''",21],",",["T_WHITESPACE"," ",21],["T_STRING","true",21],")",";",["T_WHITESPACE","\n\t\t",21],["T_VARIABLE","$data",22],"[",["T_CONSTANT_ENCAPSED_STRING","'notifyType'",22],"]",["T_WHITESPACE","   ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'json'",22],";",["T_WHITESPACE","\n\t\t",22],["T_VARIABLE","$data",23],"[",["T_CONSTANT_ENCAPSED_STRING","'shipper'",23],"]",["T_WHITESPACE","      ",23],"=",["T_WHITESPACE"," ",23],["T_LNUMBER","0",23],";",["T_WHITESPACE","\n\t\t",23],["T_VARIABLE","$data",24],"[",["T_CONSTANT_ENCAPSED_STRING","'tax'",24],"]",["T_WHITESPACE","          ",24],"=",["T_WHITESPACE"," ",24],"(",["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","config",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","get",24],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax'",24],")",")",["T_WHITESPACE"," ",24],"?",["T_WHITESPACE"," ",24],["T_LNUMBER","0",24],["T_WHITESPACE"," ",24],":",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","model_extension_payment_pilibaba",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","getOrderTaxAmount",24],"(",["T_VARIABLE","$order_info",24],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",24],"]",")",";",["T_WHITESPACE","\n\t\t",24],["T_VARIABLE","$data",25],"[",["T_CONSTANT_ENCAPSED_STRING","'signType'",25],"]",["T_WHITESPACE","     ",25],"=",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'MD5'",25],";",["T_WHITESPACE","\n\t\t",25],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'signMsg'",26],"]",["T_WHITESPACE","      ",26],"=",["T_WHITESPACE"," ",26],["T_STRING","strtoupper",26],"(",["T_STRING","md5",26],"(",["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'version'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'merchantNo'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'currencyType'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'orderAmount'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'orderTime'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'pageUrl'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'serverUrl'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'redirectUrl'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'notifyType'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'shipper'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'tax'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$data",26],"[",["T_CONSTANT_ENCAPSED_STRING","'signType'",26],"]",["T_WHITESPACE"," ",26],".",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","config",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","get",26],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_secret_key'",26],")",")",")",";",["T_WHITESPACE","\n\n\t\t",26],["T_VARIABLE","$products",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_ARRAY","array",28],"(",")",";",["T_WHITESPACE","\n\n\t\t",28],["T_FOREACH","foreach",30],["T_WHITESPACE"," ",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","cart",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","getProducts",30],"(",")",["T_WHITESPACE"," ",30],["T_AS","as",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$product",30],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n\t\t\t",30],["T_COMMENT","\/\/ kilograms\n",31],["T_WHITESPACE","\t\t\t",32],["T_IF","if",32],["T_WHITESPACE"," ",32],"(",["T_VARIABLE","$product",32],"[",["T_CONSTANT_ENCAPSED_STRING","'weight_class_id'",32],"]",["T_WHITESPACE"," ",32],["T_IS_EQUAL","==",32],["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'1'",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n\t\t\t\t",32],["T_VARIABLE","$weight",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","intval",33],"(",["T_STRING","round",33],"(",["T_VARIABLE","$product",33],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",33],"]",",",["T_WHITESPACE"," ",33],["T_LNUMBER","2",33],")",["T_WHITESPACE"," ",33],"*",["T_WHITESPACE"," ",33],["T_LNUMBER","1000",33],")",";",["T_WHITESPACE","\n\t\t\t",33],"}",["T_WHITESPACE"," ",34],["T_ELSE","else",34],["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n\t\t\t\t",34],["T_VARIABLE","$weight",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","intval",35],"(",["T_VARIABLE","$product",35],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",35],"]",")",";",["T_WHITESPACE","\n\t\t\t",35],"}",["T_WHITESPACE","\n\n\t\t\t",36],["T_VARIABLE","$products",38],"[","]",["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","array_map",38],"(",["T_CONSTANT_ENCAPSED_STRING","'strval'",38],",",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_WHITESPACE","\n\t\t\t\t",38],["T_CONSTANT_ENCAPSED_STRING","'name'",39],["T_WHITESPACE","       ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$product",39],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",39],"]",",",["T_WHITESPACE","\n\t\t\t\t",39],["T_CONSTANT_ENCAPSED_STRING","'pictureUrl'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","config",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","get",40],"(",["T_CONSTANT_ENCAPSED_STRING","'config_url'",40],")",["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'image\/'",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_VARIABLE","$product",40],"[",["T_CONSTANT_ENCAPSED_STRING","'image'",40],"]",",",["T_WHITESPACE","\n\t\t\t\t",40],["T_CONSTANT_ENCAPSED_STRING","'price'",41],["T_WHITESPACE","      ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_STRING","intval",41],"(",["T_STRING","round",41],"(",["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","tax",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","calculate",41],"(",["T_VARIABLE","$product",41],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",41],"]",",",["T_WHITESPACE"," ",41],["T_VARIABLE","$product",41],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",41],"]",",",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","config",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","get",41],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax'",41],")",",",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","session",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","data",41],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",41],"]",")",",",["T_WHITESPACE"," ",41],["T_LNUMBER","2",41],")",["T_WHITESPACE"," ",41],"*",["T_WHITESPACE"," ",41],["T_LNUMBER","100",41],")",",",["T_WHITESPACE","\n\t\t\t\t",41],["T_CONSTANT_ENCAPSED_STRING","'productUrl'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_STRING","str_replace",42],"(",["T_CONSTANT_ENCAPSED_STRING","'&amp;'",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'&'",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","url",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","link",42],"(",["T_CONSTANT_ENCAPSED_STRING","'product\/product'",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'product_id='",42],["T_WHITESPACE"," ",42],".",["T_WHITESPACE"," ",42],["T_VARIABLE","$product",42],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",42],"]",")",")",",",["T_WHITESPACE","\n\t\t\t\t",42],["T_CONSTANT_ENCAPSED_STRING","'productId'",43],["T_WHITESPACE","  ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$product",43],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",43],"]",",",["T_WHITESPACE","\n\t\t\t\t",43],["T_CONSTANT_ENCAPSED_STRING","'quantity'",44],["T_WHITESPACE","   ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$product",44],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",44],"]",",",["T_WHITESPACE","\n\t\t\t\t",44],["T_CONSTANT_ENCAPSED_STRING","'weight'",45],["T_WHITESPACE","     ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$weight",45],["T_WHITESPACE","\n\t\t\t",45],")",")",";",["T_WHITESPACE","\n\t\t",46],"}",["T_WHITESPACE","\n\n\t\t",47],["T_VARIABLE","$data",49],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",49],"]",["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$products",49],";",["T_WHITESPACE","\n\n\t\t",49],["T_VARIABLE","$data",51],"[",["T_CONSTANT_ENCAPSED_STRING","'goodsList'",51],"]",["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","urlencode",51],"(",["T_STRING","json_encode",51],"(",["T_VARIABLE","$products",51],")",")",";",["T_WHITESPACE","\n\n\t\t",51],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","config",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","get",53],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_environment'",53],")",["T_WHITESPACE"," ",53],["T_IS_EQUAL","==",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'live'",53],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n\t\t\t",53],["T_VARIABLE","$data",54],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",54],"]",["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.pilibaba.com\/pilipay\/payreq'",54],";",["T_WHITESPACE","\n\t\t",54],"}",["T_WHITESPACE"," ",55],["T_ELSE","else",55],["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n\t\t\t",55],["T_VARIABLE","$data",56],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",56],"]",["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/pre.pilibaba.com\/pilipay\/payreq'",56],";",["T_WHITESPACE","\n\t\t",56],"}",["T_WHITESPACE","\n\n\t\t",57],["T_VARIABLE","$data",59],"[",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",59],"]",["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","language",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'button_confirm'",59],")",";",["T_WHITESPACE","\n\t\t",59],["T_VARIABLE","$data",60],"[",["T_CONSTANT_ENCAPSED_STRING","'text_loading'",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","language",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","get",60],"(",["T_CONSTANT_ENCAPSED_STRING","'text_loading'",60],")",";",["T_WHITESPACE","\n\n\t\t",60],["T_VARIABLE","$data",62],"[",["T_CONSTANT_ENCAPSED_STRING","'auto_submit'",62],"]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","false",62],";",["T_WHITESPACE","\n\n\t\t",62],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","model_extension_payment_pilibaba",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","log",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Request: '",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_STRING","print_r",64],"(",["T_VARIABLE","$data",64],",",["T_WHITESPACE"," ",64],["T_STRING","true",64],")",")",";",["T_WHITESPACE","\n\n\t\t",64],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","load",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","view",66],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$data",66],")",";",["T_WHITESPACE","\n\t",66],"}",["T_WHITESPACE","\n\n\t",67],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","express",69],"(",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n\t\t",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","load",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","language",70],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/shipping\/pilibaba'",70],")",";",["T_WHITESPACE","\n\n\t\t",70],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","load",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","language",72],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",72],")",";",["T_WHITESPACE","\n\n\t\t",72],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","load",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","model",74],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",74],")",";",["T_WHITESPACE","\n\n\t\t",74],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","model_extension_payment_pilibaba",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","log",76],"(",["T_CONSTANT_ENCAPSED_STRING","'Express called'",76],")",";",["T_WHITESPACE","\n\n\t\t",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","config",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","get",78],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_status'",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t\t",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(","!",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","cart",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","hasProducts",79],"(",")",["T_WHITESPACE"," ",79],["T_BOOLEAN_OR","||",79],["T_WHITESPACE"," ",79],"(","!",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","cart",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","hasStock",79],"(",")",["T_WHITESPACE"," ",79],["T_BOOLEAN_AND","&&",79],["T_WHITESPACE"," ",79],"!",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","config",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","get",79],"(",["T_CONSTANT_ENCAPSED_STRING","'config_stock_checkout'",79],")",")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n\t\t\t\t",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","model_extension_payment_pilibaba",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","log",80],"(",["T_CONSTANT_ENCAPSED_STRING","'No physical products. Redirecting to checkout\/cart'",80],")",";",["T_WHITESPACE","\n\n\t\t\t\t",80],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","response",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","redirect",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","url",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","link",82],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",82],")",")",";",["T_WHITESPACE","\n\t\t\t",82],"}",["T_WHITESPACE"," ",83],["T_ELSE","else",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n\t\t\t\t",83],["T_VARIABLE","$order_data",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",84],["T_VARIABLE","$totals",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",86],["T_VARIABLE","$taxes",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","cart",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getTaxes",87],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",87],["T_VARIABLE","$total",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_LNUMBER","0",88],";",["T_WHITESPACE","\n\n\t\t\t\t",88],["T_COMMENT","\/\/ Because __call can not keep var references so we put them into an array.\n",90],["T_WHITESPACE","\t\t\t\t",91],["T_VARIABLE","$total_data",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",["T_WHITESPACE","\n\t\t\t\t\t",91],["T_CONSTANT_ENCAPSED_STRING","'totals'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],"&",["T_VARIABLE","$totals",92],",",["T_WHITESPACE","\n\t\t\t\t\t",92],["T_CONSTANT_ENCAPSED_STRING","'taxes'",93],["T_WHITESPACE","  ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],"&",["T_VARIABLE","$taxes",93],",",["T_WHITESPACE","\n\t\t\t\t\t",93],["T_CONSTANT_ENCAPSED_STRING","'total'",94],["T_WHITESPACE","  ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],"&",["T_VARIABLE","$total",94],["T_WHITESPACE","\n\t\t\t\t",94],")",";",["T_WHITESPACE","\n\n\t\t\t\t",95],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","load",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","model",97],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/extension'",97],")",";",["T_WHITESPACE","\n\n\t\t\t\t",97],["T_VARIABLE","$sort_order",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_ARRAY","array",99],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",99],["T_VARIABLE","$results",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","model_extension_extension",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getExtensions",101],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",101],")",";",["T_WHITESPACE","\n\n\t\t\t\t",101],["T_FOREACH","foreach",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$results",103],["T_WHITESPACE"," ",103],["T_AS","as",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$key",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$value",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n\t\t\t\t\t",103],["T_VARIABLE","$sort_order",104],"[",["T_VARIABLE","$key",104],"]",["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","config",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","get",104],"(",["T_VARIABLE","$value",104],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",104],"]",["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'_sort_order'",104],")",";",["T_WHITESPACE","\n\t\t\t\t",104],"}",["T_WHITESPACE","\n\n\t\t\t\t",105],["T_STRING","array_multisort",107],"(",["T_VARIABLE","$sort_order",107],",",["T_WHITESPACE"," ",107],["T_STRING","SORT_ASC",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$results",107],")",";",["T_WHITESPACE","\n\n\t\t\t\t",107],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$results",109],["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$result",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n\t\t\t\t\t",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","config",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","get",110],"(",["T_VARIABLE","$result",110],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",110],"]",["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'_status'",110],")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","load",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","model",111],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/total\/'",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$result",111],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",111],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",111],["T_COMMENT","\/\/ We have to put the totals in an array so that they pass by reference.\n",113],["T_WHITESPACE","\t\t\t\t\t\t",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],"{",["T_CONSTANT_ENCAPSED_STRING","'model_extension_total_'",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_VARIABLE","$result",114],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",114],"]","}",["T_OBJECT_OPERATOR","->",114],["T_STRING","getTotal",114],"(",["T_VARIABLE","$total_data",114],")",";",["T_WHITESPACE","\n\t\t\t\t\t",114],"}",["T_WHITESPACE","\n\t\t\t\t",115],"}",["T_WHITESPACE","\n\n\t\t\t\t",116],["T_VARIABLE","$sort_order",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_ARRAY","array",118],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",118],["T_FOREACH","foreach",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$totals",120],["T_WHITESPACE"," ",120],["T_AS","as",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$key",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$value",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n\t\t\t\t\t",120],["T_VARIABLE","$sort_order",121],"[",["T_VARIABLE","$key",121],"]",["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$value",121],"[",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",121],"]",";",["T_WHITESPACE","\n\t\t\t\t",121],"}",["T_WHITESPACE","\n\n\t\t\t\t",122],["T_STRING","array_multisort",124],"(",["T_VARIABLE","$sort_order",124],",",["T_WHITESPACE"," ",124],["T_STRING","SORT_ASC",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$totals",124],")",";",["T_WHITESPACE","\n\n\t\t\t\t",124],["T_VARIABLE","$order_data",126],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",126],"]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$totals",126],";",["T_WHITESPACE","\n\n\t\t\t\t",126],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","load",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","language",128],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",128],")",";",["T_WHITESPACE","\n\n\t\t\t\t",128],["T_VARIABLE","$order_data",130],"[",["T_CONSTANT_ENCAPSED_STRING","'invoice_prefix'",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","config",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","get",130],"(",["T_CONSTANT_ENCAPSED_STRING","'config_invoice_prefix'",130],")",";",["T_WHITESPACE","\n\t\t\t\t",130],["T_VARIABLE","$order_data",131],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","config",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","get",131],"(",["T_CONSTANT_ENCAPSED_STRING","'config_store_id'",131],")",";",["T_WHITESPACE","\n\t\t\t\t",131],["T_VARIABLE","$order_data",132],"[",["T_CONSTANT_ENCAPSED_STRING","'store_name'",132],"]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","config",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","get",132],"(",["T_CONSTANT_ENCAPSED_STRING","'config_name'",132],")",";",["T_WHITESPACE","\n\n\t\t\t\t",132],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$order_data",134],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",134],"]",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n\t\t\t\t\t",134],["T_VARIABLE","$order_data",135],"[",["T_CONSTANT_ENCAPSED_STRING","'store_url'",135],"]",["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","config",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","get",135],"(",["T_CONSTANT_ENCAPSED_STRING","'config_url'",135],")",";",["T_WHITESPACE","\n\t\t\t\t",135],"}",["T_WHITESPACE"," ",136],["T_ELSE","else",136],["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n\t\t\t\t\t",136],["T_VARIABLE","$order_data",137],"[",["T_CONSTANT_ENCAPSED_STRING","'store_url'",137],"]",["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","HTTP_SERVER",137],";",["T_WHITESPACE","\n\t\t\t\t",137],"}",["T_WHITESPACE","\n\n\t\t\t\t",138],["T_VARIABLE","$order_data",140],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",140],"]",["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_LNUMBER","0",140],";",["T_WHITESPACE","\n\t\t\t\t",140],["T_VARIABLE","$order_data",141],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",141],"]",["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","config",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","get",141],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_group_id'",141],")",";",["T_WHITESPACE","\n\t\t\t\t",141],["T_VARIABLE","$order_data",142],"[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",142],"]",["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","''",142],";",["T_WHITESPACE","\n\t\t\t\t",142],["T_VARIABLE","$order_data",143],"[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",143],"]",["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","''",143],";",["T_WHITESPACE","\n\t\t\t\t",143],["T_VARIABLE","$order_data",144],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",144],"]",["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","''",144],";",["T_WHITESPACE","\n\t\t\t\t",144],["T_VARIABLE","$order_data",145],"[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",145],"]",["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","''",145],";",["T_WHITESPACE","\n\t\t\t\t",145],["T_VARIABLE","$order_data",146],"[",["T_CONSTANT_ENCAPSED_STRING","'fax'",146],"]",["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","''",146],";",["T_WHITESPACE","\n\t\t\t\t",146],["T_VARIABLE","$order_data",147],"[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",147],"]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","null",147],";",["T_WHITESPACE","\n\n\t\t\t\t",147],["T_VARIABLE","$order_data",149],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_firstname'",149],"]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","''",149],";",["T_WHITESPACE","\n\t\t\t\t",149],["T_VARIABLE","$order_data",150],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_lastname'",150],"]",["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","''",150],";",["T_WHITESPACE","\n\t\t\t\t",150],["T_VARIABLE","$order_data",151],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_company'",151],"]",["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","''",151],";",["T_WHITESPACE","\n\t\t\t\t",151],["T_VARIABLE","$order_data",152],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_1'",152],"]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","''",152],";",["T_WHITESPACE","\n\t\t\t\t",152],["T_VARIABLE","$order_data",153],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_2'",153],"]",["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","''",153],";",["T_WHITESPACE","\n\t\t\t\t",153],["T_VARIABLE","$order_data",154],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_city'",154],"]",["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","''",154],";",["T_WHITESPACE","\n\t\t\t\t",154],["T_VARIABLE","$order_data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_postcode'",155],"]",["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","''",155],";",["T_WHITESPACE","\n\t\t\t\t",155],["T_VARIABLE","$order_data",156],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone'",156],"]",["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","''",156],";",["T_WHITESPACE","\n\t\t\t\t",156],["T_VARIABLE","$order_data",157],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_zone_id'",157],"]",["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_LNUMBER","0",157],";",["T_WHITESPACE","\n\t\t\t\t",157],["T_VARIABLE","$order_data",158],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country'",158],"]",["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","''",158],";",["T_WHITESPACE","\n\t\t\t\t",158],["T_VARIABLE","$order_data",159],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_country_id'",159],"]",["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_LNUMBER","0",159],";",["T_WHITESPACE","\n\t\t\t\t",159],["T_VARIABLE","$order_data",160],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_address_format'",160],"]",["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","''",160],";",["T_WHITESPACE","\n\t\t\t\t",160],["T_VARIABLE","$order_data",161],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_custom_field'",161],"]",["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_ARRAY","array",161],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",161],["T_VARIABLE","$order_data",162],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",162],"]",["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","language",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","get",162],"(",["T_CONSTANT_ENCAPSED_STRING","'text_title'",162],")",";",["T_WHITESPACE","\n\t\t\t\t",162],["T_VARIABLE","$order_data",163],"[",["T_CONSTANT_ENCAPSED_STRING","'payment_code'",163],"]",["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'pilibaba'",163],";",["T_WHITESPACE","\n\n\t\t\t\t",163],["T_VARIABLE","$order_data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_firstname'",165],"]",["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","''",165],";",["T_WHITESPACE","\n\t\t\t\t",165],["T_VARIABLE","$order_data",166],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_lastname'",166],"]",["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","''",166],";",["T_WHITESPACE","\n\t\t\t\t",166],["T_VARIABLE","$order_data",167],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_company'",167],"]",["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","''",167],";",["T_WHITESPACE","\n\t\t\t\t",167],["T_VARIABLE","$order_data",168],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_1'",168],"]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","''",168],";",["T_WHITESPACE","\n\t\t\t\t",168],["T_VARIABLE","$order_data",169],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_2'",169],"]",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","''",169],";",["T_WHITESPACE","\n\t\t\t\t",169],["T_VARIABLE","$order_data",170],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_city'",170],"]",["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","''",170],";",["T_WHITESPACE","\n\t\t\t\t",170],["T_VARIABLE","$order_data",171],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_postcode'",171],"]",["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","''",171],";",["T_WHITESPACE","\n\t\t\t\t",171],["T_VARIABLE","$order_data",172],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone'",172],"]",["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","''",172],";",["T_WHITESPACE","\n\t\t\t\t",172],["T_VARIABLE","$order_data",173],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_zone_id'",173],"]",["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_LNUMBER","0",173],";",["T_WHITESPACE","\n\t\t\t\t",173],["T_VARIABLE","$order_data",174],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country'",174],"]",["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","''",174],";",["T_WHITESPACE","\n\t\t\t\t",174],["T_VARIABLE","$order_data",175],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_country_id'",175],"]",["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_LNUMBER","0",175],";",["T_WHITESPACE","\n\t\t\t\t",175],["T_VARIABLE","$order_data",176],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_format'",176],"]",["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","''",176],";",["T_WHITESPACE","\n\t\t\t\t",176],["T_VARIABLE","$order_data",177],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_custom_field'",177],"]",["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_ARRAY","array",177],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",177],["T_VARIABLE","$order_data",178],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",178],"]",["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","language",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","get",178],"(",["T_CONSTANT_ENCAPSED_STRING","'text_description'",178],")",";",["T_WHITESPACE","\n\t\t\t\t",178],["T_VARIABLE","$order_data",179],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_code'",179],"]",["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'pilibaba.pilibaba'",179],";",["T_WHITESPACE","\n\n\t\t\t\t",179],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","session",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","data",181],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",181],"]","[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",181],"]",["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","config",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","get",181],"(",["T_CONSTANT_ENCAPSED_STRING","'config_customer_group_id'",181],")",";",["T_WHITESPACE","\n\t\t\t\t",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","session",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",182],"]","[",["T_CONSTANT_ENCAPSED_STRING","'firstname'",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","''",182],";",["T_WHITESPACE","\n\t\t\t\t",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","session",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","data",183],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",183],"]","[",["T_CONSTANT_ENCAPSED_STRING","'lastname'",183],"]",["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","''",183],";",["T_WHITESPACE","\n\t\t\t\t",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","session",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","data",184],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",184],"]","[",["T_CONSTANT_ENCAPSED_STRING","'email'",184],"]",["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","''",184],";",["T_WHITESPACE","\n\t\t\t\t",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","session",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","data",185],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",185],"]","[",["T_CONSTANT_ENCAPSED_STRING","'telephone'",185],"]",["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","''",185],";",["T_WHITESPACE","\n\t\t\t\t",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","session",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","data",186],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",186],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fax'",186],"]",["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","''",186],";",["T_WHITESPACE","\n\t\t\t\t",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","session",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","data",187],"[",["T_CONSTANT_ENCAPSED_STRING","'guest'",187],"]","[",["T_CONSTANT_ENCAPSED_STRING","'custom_field'",187],"]",["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",187],["T_VARIABLE","$order_data",189],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",189],"]",["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_ARRAY","array",189],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",189],["T_FOREACH","foreach",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","cart",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getProducts",191],"(",")",["T_WHITESPACE"," ",191],["T_AS","as",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$product",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n\t\t\t\t\t",191],["T_VARIABLE","$option_data",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_ARRAY","array",192],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",192],["T_FOREACH","foreach",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$product",194],"[",["T_CONSTANT_ENCAPSED_STRING","'option'",194],"]",["T_WHITESPACE"," ",194],["T_AS","as",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$option",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",194],["T_VARIABLE","$option_data",195],"[","]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_ARRAY","array",195],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",195],["T_CONSTANT_ENCAPSED_STRING","'product_option_id'",196],["T_WHITESPACE","       ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$option",196],"[",["T_CONSTANT_ENCAPSED_STRING","'product_option_id'",196],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",196],["T_CONSTANT_ENCAPSED_STRING","'product_option_value_id'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$option",197],"[",["T_CONSTANT_ENCAPSED_STRING","'product_option_value_id'",197],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",197],["T_CONSTANT_ENCAPSED_STRING","'option_id'",198],["T_WHITESPACE","               ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$option",198],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",198],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",198],["T_CONSTANT_ENCAPSED_STRING","'option_value_id'",199],["T_WHITESPACE","         ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$option",199],"[",["T_CONSTANT_ENCAPSED_STRING","'option_value_id'",199],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",199],["T_CONSTANT_ENCAPSED_STRING","'name'",200],["T_WHITESPACE","                    ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$option",200],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",200],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",200],["T_CONSTANT_ENCAPSED_STRING","'value'",201],["T_WHITESPACE","                   ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$option",201],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",201],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",201],["T_CONSTANT_ENCAPSED_STRING","'type'",202],["T_WHITESPACE","                    ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$option",202],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",202],"]",["T_WHITESPACE","\n\t\t\t\t\t\t",202],")",";",["T_WHITESPACE","\n\t\t\t\t\t",203],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",204],["T_VARIABLE","$order_data",206],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",206],"]","[","]",["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_ARRAY","array",206],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",206],["T_CONSTANT_ENCAPSED_STRING","'product_id'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$product",207],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",207],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",207],["T_CONSTANT_ENCAPSED_STRING","'name'",208],["T_WHITESPACE","       ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$product",208],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",208],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",208],["T_CONSTANT_ENCAPSED_STRING","'model'",209],["T_WHITESPACE","      ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$product",209],"[",["T_CONSTANT_ENCAPSED_STRING","'model'",209],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",209],["T_CONSTANT_ENCAPSED_STRING","'option'",210],["T_WHITESPACE","     ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$option_data",210],",",["T_WHITESPACE","\n\t\t\t\t\t\t",210],["T_CONSTANT_ENCAPSED_STRING","'download'",211],["T_WHITESPACE","   ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$product",211],"[",["T_CONSTANT_ENCAPSED_STRING","'download'",211],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",211],["T_CONSTANT_ENCAPSED_STRING","'quantity'",212],["T_WHITESPACE","   ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$product",212],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",212],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",212],["T_CONSTANT_ENCAPSED_STRING","'subtract'",213],["T_WHITESPACE","   ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$product",213],"[",["T_CONSTANT_ENCAPSED_STRING","'subtract'",213],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",213],["T_CONSTANT_ENCAPSED_STRING","'price'",214],["T_WHITESPACE","      ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$product",214],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",214],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",214],["T_CONSTANT_ENCAPSED_STRING","'total'",215],["T_WHITESPACE","      ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$product",215],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",215],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",215],["T_CONSTANT_ENCAPSED_STRING","'tax'",216],["T_WHITESPACE","        ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","tax",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getTax",216],"(",["T_VARIABLE","$product",216],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",216],"]",",",["T_WHITESPACE"," ",216],["T_VARIABLE","$product",216],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",216],"]",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",216],["T_CONSTANT_ENCAPSED_STRING","'reward'",217],["T_WHITESPACE","     ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$product",217],"[",["T_CONSTANT_ENCAPSED_STRING","'reward'",217],"]",["T_WHITESPACE","\n\t\t\t\t\t",217],")",";",["T_WHITESPACE","\n\t\t\t\t",218],"}",["T_WHITESPACE","\n\n\t\t\t\t",219],["T_COMMENT","\/\/ Gift Voucher\n",221],["T_WHITESPACE","\t\t\t\t",222],["T_VARIABLE","$order_data",222],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",222],"]",["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",222],["T_IF","if",224],["T_WHITESPACE"," ",224],"(","!",["T_EMPTY","empty",224],"(",["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","session",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","data",224],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",224],"]",")",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n\t\t\t\t\t",224],["T_FOREACH","foreach",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","session",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","data",225],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",225],"]",["T_WHITESPACE"," ",225],["T_AS","as",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$voucher",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",225],["T_VARIABLE","$order_data",226],"[",["T_CONSTANT_ENCAPSED_STRING","'vouchers'",226],"]","[","]",["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_WHITESPACE","\n\t\t\t\t\t\t\t",226],["T_CONSTANT_ENCAPSED_STRING","'description'",227],["T_WHITESPACE","      ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$voucher",227],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",227],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",227],["T_CONSTANT_ENCAPSED_STRING","'code'",228],["T_WHITESPACE","             ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_STRING","token",228],"(",["T_LNUMBER","10",228],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",228],["T_CONSTANT_ENCAPSED_STRING","'to_name'",229],["T_WHITESPACE","          ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$voucher",229],"[",["T_CONSTANT_ENCAPSED_STRING","'to_name'",229],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",229],["T_CONSTANT_ENCAPSED_STRING","'to_email'",230],["T_WHITESPACE","         ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$voucher",230],"[",["T_CONSTANT_ENCAPSED_STRING","'to_email'",230],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",230],["T_CONSTANT_ENCAPSED_STRING","'from_name'",231],["T_WHITESPACE","        ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$voucher",231],"[",["T_CONSTANT_ENCAPSED_STRING","'from_name'",231],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",231],["T_CONSTANT_ENCAPSED_STRING","'from_email'",232],["T_WHITESPACE","       ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$voucher",232],"[",["T_CONSTANT_ENCAPSED_STRING","'from_email'",232],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",232],["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$voucher",233],"[",["T_CONSTANT_ENCAPSED_STRING","'voucher_theme_id'",233],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",233],["T_CONSTANT_ENCAPSED_STRING","'message'",234],["T_WHITESPACE","          ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$voucher",234],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",234],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",234],["T_CONSTANT_ENCAPSED_STRING","'amount'",235],["T_WHITESPACE","           ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$voucher",235],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",235],"]",["T_WHITESPACE","\n\t\t\t\t\t\t",235],")",";",["T_WHITESPACE","\n\t\t\t\t\t",236],"}",["T_WHITESPACE","\n\t\t\t\t",237],"}",["T_WHITESPACE","\n\n\t\t\t\t",238],["T_VARIABLE","$order_data",240],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",240],"]",["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_CONSTANT_ENCAPSED_STRING","''",240],";",["T_WHITESPACE","\n\t\t\t\t",240],["T_VARIABLE","$order_data",241],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",241],"]",["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$total_data",241],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",241],"]",";",["T_WHITESPACE","\n\n\t\t\t\t",241],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_ISSET","isset",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","request",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","cookie",243],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",243],"]",")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n\t\t\t\t\t",243],["T_VARIABLE","$order_data",244],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",244],"]",["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","request",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","cookie",244],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",244],"]",";",["T_WHITESPACE","\n\n\t\t\t\t\t",244],["T_VARIABLE","$subtotal",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","cart",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getSubTotal",246],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",246],["T_COMMENT","\/\/ Affiliate\n",248],["T_WHITESPACE","\t\t\t\t\t",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","load",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","model",249],"(",["T_CONSTANT_ENCAPSED_STRING","'affiliate\/affiliate'",249],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",249],["T_VARIABLE","$affiliate_info",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","model_affiliate_affiliate",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getAffiliateByCode",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","request",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","cookie",251],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",251],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",251],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$affiliate_info",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",253],["T_VARIABLE","$order_data",254],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",254],"]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$affiliate_info",254],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",254],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",254],["T_VARIABLE","$order_data",255],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",255],"]",["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$subtotal",255],["T_WHITESPACE"," ",255],"\/",["T_WHITESPACE"," ",255],["T_LNUMBER","100",255],")",["T_WHITESPACE"," ",255],"*",["T_WHITESPACE"," ",255],["T_VARIABLE","$affiliate_info",255],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",255],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",255],"}",["T_WHITESPACE"," ",256],["T_ELSE","else",256],["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",256],["T_VARIABLE","$order_data",257],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",257],"]",["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_LNUMBER","0",257],";",["T_WHITESPACE","\n\t\t\t\t\t\t",257],["T_VARIABLE","$order_data",258],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",258],"]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_LNUMBER","0",258],";",["T_WHITESPACE","\n\t\t\t\t\t",258],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",259],["T_COMMENT","\/\/ Marketing\n",261],["T_WHITESPACE","\t\t\t\t\t",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","load",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","model",262],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/marketing'",262],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",262],["T_VARIABLE","$marketing_info",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","model_checkout_marketing",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getMarketingByCode",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","request",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","cookie",264],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",264],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",264],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$marketing_info",266],")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",266],["T_VARIABLE","$order_data",267],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",267],"]",["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$marketing_info",267],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",267],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",267],"}",["T_WHITESPACE"," ",268],["T_ELSE","else",268],["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",268],["T_VARIABLE","$order_data",269],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",269],"]",["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_LNUMBER","0",269],";",["T_WHITESPACE","\n\t\t\t\t\t",269],"}",["T_WHITESPACE","\n\t\t\t\t",270],"}",["T_WHITESPACE"," ",271],["T_ELSE","else",271],["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n\t\t\t\t\t",271],["T_VARIABLE","$order_data",272],"[",["T_CONSTANT_ENCAPSED_STRING","'affiliate_id'",272],"]",["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_LNUMBER","0",272],";",["T_WHITESPACE","\n\t\t\t\t\t",272],["T_VARIABLE","$order_data",273],"[",["T_CONSTANT_ENCAPSED_STRING","'commission'",273],"]",["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_LNUMBER","0",273],";",["T_WHITESPACE","\n\t\t\t\t\t",273],["T_VARIABLE","$order_data",274],"[",["T_CONSTANT_ENCAPSED_STRING","'marketing_id'",274],"]",["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_LNUMBER","0",274],";",["T_WHITESPACE","\n\t\t\t\t\t",274],["T_VARIABLE","$order_data",275],"[",["T_CONSTANT_ENCAPSED_STRING","'tracking'",275],"]",["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_CONSTANT_ENCAPSED_STRING","''",275],";",["T_WHITESPACE","\n\t\t\t\t",275],"}",["T_WHITESPACE","\n\n\t\t\t\t",276],["T_VARIABLE","$order_data",278],"[",["T_CONSTANT_ENCAPSED_STRING","'language_id'",278],"]",["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","config",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","get",278],"(",["T_CONSTANT_ENCAPSED_STRING","'config_language_id'",278],")",";",["T_WHITESPACE","\n\t\t\t\t",278],["T_VARIABLE","$order_data",279],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_id'",279],"]",["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","currency",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getId",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","session",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","data",279],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",279],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",279],["T_VARIABLE","$order_data",280],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",280],"]",["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","session",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","data",280],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",280],"]",";",["T_WHITESPACE","\n\t\t\t\t",280],["T_VARIABLE","$order_data",281],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_value'",281],"]",["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","currency",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getValue",281],"(",["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","session",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","data",281],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",281],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",281],["T_VARIABLE","$order_data",282],"[",["T_CONSTANT_ENCAPSED_STRING","'ip'",282],"]",["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","request",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","server",282],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",282],"]",";",["T_WHITESPACE","\n\n\t\t\t\t",282],["T_IF","if",284],["T_WHITESPACE"," ",284],"(","!",["T_EMPTY","empty",284],"(",["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","request",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","server",284],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",284],"]",")",")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n\t\t\t\t\t",284],["T_VARIABLE","$order_data",285],"[",["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",285],"]",["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","request",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","server",285],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",285],"]",";",["T_WHITESPACE","\n\t\t\t\t",285],"}",["T_WHITESPACE"," ",286],["T_ELSEIF","elseif",286],["T_WHITESPACE"," ",286],"(","!",["T_EMPTY","empty",286],"(",["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","request",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","server",286],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CLIENT_IP'",286],"]",")",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n\t\t\t\t\t",286],["T_VARIABLE","$order_data",287],"[",["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",287],"]",["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","request",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","server",287],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_CLIENT_IP'",287],"]",";",["T_WHITESPACE","\n\t\t\t\t",287],"}",["T_WHITESPACE"," ",288],["T_ELSE","else",288],["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n\t\t\t\t\t",288],["T_VARIABLE","$order_data",289],"[",["T_CONSTANT_ENCAPSED_STRING","'forwarded_ip'",289],"]",["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_CONSTANT_ENCAPSED_STRING","''",289],";",["T_WHITESPACE","\n\t\t\t\t",289],"}",["T_WHITESPACE","\n\n\t\t\t\t",290],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_ISSET","isset",292],"(",["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","request",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","server",292],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",292],"]",")",")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n\t\t\t\t\t",292],["T_VARIABLE","$order_data",293],"[",["T_CONSTANT_ENCAPSED_STRING","'user_agent'",293],"]",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","request",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","server",293],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",293],"]",";",["T_WHITESPACE","\n\t\t\t\t",293],"}",["T_WHITESPACE"," ",294],["T_ELSE","else",294],["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n\t\t\t\t\t",294],["T_VARIABLE","$order_data",295],"[",["T_CONSTANT_ENCAPSED_STRING","'user_agent'",295],"]",["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","''",295],";",["T_WHITESPACE","\n\t\t\t\t",295],"}",["T_WHITESPACE","\n\n\t\t\t\t",296],["T_IF","if",298],["T_WHITESPACE"," ",298],"(",["T_ISSET","isset",298],"(",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","request",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","server",298],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ACCEPT_LANGUAGE'",298],"]",")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n\t\t\t\t\t",298],["T_VARIABLE","$order_data",299],"[",["T_CONSTANT_ENCAPSED_STRING","'accept_language'",299],"]",["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","request",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","server",299],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ACCEPT_LANGUAGE'",299],"]",";",["T_WHITESPACE","\n\t\t\t\t",299],"}",["T_WHITESPACE"," ",300],["T_ELSE","else",300],["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n\t\t\t\t\t",300],["T_VARIABLE","$order_data",301],"[",["T_CONSTANT_ENCAPSED_STRING","'accept_language'",301],"]",["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","''",301],";",["T_WHITESPACE","\n\t\t\t\t",301],"}",["T_WHITESPACE","\n\n\t\t\t\t",302],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","load",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","model",304],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",304],")",";",["T_WHITESPACE","\n\n\t\t\t\t",304],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","session",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","data",306],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",306],"]",["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","model_checkout_order",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","addOrder",306],"(",["T_VARIABLE","$order_data",306],")",";",["T_WHITESPACE","\n\n\t\t\t\t",306],["T_VARIABLE","$order_info",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","model_checkout_order",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getOrder",308],"(",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","session",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","data",308],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",308],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",308],["T_VARIABLE","$data",310],"[",["T_CONSTANT_ENCAPSED_STRING","'version'",310],"]",["T_WHITESPACE","      ",310],"=",["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","'V2.0.01'",310],";",["T_WHITESPACE","\n\t\t\t\t",310],["T_VARIABLE","$data",311],"[",["T_CONSTANT_ENCAPSED_STRING","'merchantNo'",311],"]",["T_WHITESPACE","   ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","config",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","get",311],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_merchant_number'",311],")",";",["T_WHITESPACE","\n\t\t\t\t",311],["T_VARIABLE","$data",312],"[",["T_CONSTANT_ENCAPSED_STRING","'currencyType'",312],"]",["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$order_info",312],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_code'",312],"]",";",["T_WHITESPACE","\n\t\t\t\t",312],["T_VARIABLE","$data",313],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",313],"]",["T_WHITESPACE","      ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$order_info",313],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",313],"]",";",["T_WHITESPACE","\n\t\t\t\t",313],["T_VARIABLE","$data",314],"[",["T_CONSTANT_ENCAPSED_STRING","'orderAmount'",314],"]",["T_WHITESPACE","  ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","intval",314],"(",["T_STRING","round",314],"(",["T_VARIABLE","$order_info",314],"[",["T_CONSTANT_ENCAPSED_STRING","'total'",314],"]",",",["T_WHITESPACE"," ",314],["T_LNUMBER","2",314],")",["T_WHITESPACE"," ",314],"*",["T_WHITESPACE"," ",314],["T_LNUMBER","100",314],")",";",["T_WHITESPACE","\n\t\t\t\t",314],["T_VARIABLE","$data",315],"[",["T_CONSTANT_ENCAPSED_STRING","'orderTime'",315],"]",["T_WHITESPACE","    ",315],"=",["T_WHITESPACE"," ",315],["T_STRING","date",315],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d H:i:s'",315],")",";",["T_WHITESPACE","\n\t\t\t\t",315],["T_VARIABLE","$data",316],"[",["T_CONSTANT_ENCAPSED_STRING","'pageUrl'",316],"]",["T_WHITESPACE","      ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","url",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","link",316],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/checkout'",316],",",["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","''",316],",",["T_WHITESPACE"," ",316],["T_STRING","true",316],")",";",["T_WHITESPACE","\n\t\t\t\t",316],["T_VARIABLE","$data",317],"[",["T_CONSTANT_ENCAPSED_STRING","'serverUrl'",317],"]",["T_WHITESPACE","    ",317],"=",["T_WHITESPACE"," ",317],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","url",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","link",317],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba\/callback'",317],",",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","''",317],",",["T_WHITESPACE"," ",317],["T_STRING","true",317],")",";",["T_WHITESPACE","\n\t\t\t\t",317],["T_VARIABLE","$data",318],"[",["T_CONSTANT_ENCAPSED_STRING","'redirectUrl'",318],"]",["T_WHITESPACE","  ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","url",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","link",318],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/success'",318],",",["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","''",318],",",["T_WHITESPACE"," ",318],["T_STRING","true",318],")",";",["T_WHITESPACE","\n\t\t\t\t",318],["T_VARIABLE","$data",319],"[",["T_CONSTANT_ENCAPSED_STRING","'notifyType'",319],"]",["T_WHITESPACE","   ",319],"=",["T_WHITESPACE"," ",319],["T_CONSTANT_ENCAPSED_STRING","'json'",319],";",["T_WHITESPACE","\n\t\t\t\t",319],["T_VARIABLE","$data",320],"[",["T_CONSTANT_ENCAPSED_STRING","'shipper'",320],"]",["T_WHITESPACE","      ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","intval",320],"(",["T_STRING","round",320],"(",["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","config",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","get",320],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_shipping_fee'",320],")",",",["T_WHITESPACE"," ",320],["T_LNUMBER","2",320],")",["T_WHITESPACE"," ",320],"*",["T_WHITESPACE"," ",320],["T_LNUMBER","100",320],")",";",["T_WHITESPACE","\n\t\t\t\t",320],["T_VARIABLE","$data",321],"[",["T_CONSTANT_ENCAPSED_STRING","'tax'",321],"]",["T_WHITESPACE","          ",321],"=",["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","config",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","get",321],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax'",321],")",")",["T_WHITESPACE"," ",321],"?",["T_WHITESPACE"," ",321],["T_LNUMBER","0",321],["T_WHITESPACE"," ",321],":",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","model_extension_payment_pilibaba",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getOrderTaxAmount",321],"(",["T_VARIABLE","$order_info",321],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",321],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",321],["T_VARIABLE","$data",322],"[",["T_CONSTANT_ENCAPSED_STRING","'signType'",322],"]",["T_WHITESPACE","     ",322],"=",["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'MD5'",322],";",["T_WHITESPACE","\n\t\t\t\t",322],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'signMsg'",323],"]",["T_WHITESPACE","      ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","strtoupper",323],"(",["T_STRING","md5",323],"(",["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'version'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'merchantNo'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'currencyType'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'orderAmount'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'orderTime'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'pageUrl'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'serverUrl'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'redirectUrl'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'notifyType'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'shipper'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'tax'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],"[",["T_CONSTANT_ENCAPSED_STRING","'signType'",323],"]",["T_WHITESPACE"," ",323],".",["T_WHITESPACE"," ",323],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","config",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","get",323],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_secret_key'",323],")",")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",323],["T_VARIABLE","$products",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_ARRAY","array",325],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",325],["T_FOREACH","foreach",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","cart",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getProducts",327],"(",")",["T_WHITESPACE"," ",327],["T_AS","as",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$product",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n\t\t\t\t\t",327],["T_COMMENT","\/\/ kilograms\n",328],["T_WHITESPACE","\t\t\t\t\t",329],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$product",329],"[",["T_CONSTANT_ENCAPSED_STRING","'weight_class_id'",329],"]",["T_WHITESPACE"," ",329],["T_IS_EQUAL","==",329],["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'1'",329],")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",329],["T_VARIABLE","$weight",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","intval",330],"(",["T_STRING","round",330],"(",["T_VARIABLE","$product",330],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",330],"]",",",["T_WHITESPACE"," ",330],["T_LNUMBER","2",330],")",["T_WHITESPACE"," ",330],"*",["T_WHITESPACE"," ",330],["T_LNUMBER","1000",330],")",";",["T_WHITESPACE","\n\t\t\t\t\t",330],"}",["T_WHITESPACE"," ",331],["T_ELSE","else",331],["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",331],["T_VARIABLE","$weight",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","intval",332],"(",["T_VARIABLE","$product",332],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",332],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",332],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",333],["T_VARIABLE","$products",335],"[","]",["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","array_map",335],"(",["T_CONSTANT_ENCAPSED_STRING","'strval'",335],",",["T_WHITESPACE"," ",335],["T_ARRAY","array",335],"(",["T_WHITESPACE","\n\t\t\t\t\t\t",335],["T_CONSTANT_ENCAPSED_STRING","'name'",336],["T_WHITESPACE","       ",336],["T_DOUBLE_ARROW","=>",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$product",336],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",336],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",336],["T_CONSTANT_ENCAPSED_STRING","'pictureUrl'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","config",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","get",337],"(",["T_CONSTANT_ENCAPSED_STRING","'config_url'",337],")",["T_WHITESPACE"," ",337],".",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'image\/'",337],["T_WHITESPACE"," ",337],".",["T_WHITESPACE"," ",337],["T_VARIABLE","$product",337],"[",["T_CONSTANT_ENCAPSED_STRING","'image'",337],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",337],["T_CONSTANT_ENCAPSED_STRING","'price'",338],["T_WHITESPACE","      ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_STRING","intval",338],"(",["T_STRING","round",338],"(",["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","tax",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","calculate",338],"(",["T_VARIABLE","$product",338],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",338],"]",",",["T_WHITESPACE"," ",338],["T_VARIABLE","$product",338],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",338],"]",",",["T_WHITESPACE"," ",338],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","config",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","get",338],"(",["T_CONSTANT_ENCAPSED_STRING","'config_tax'",338],")",",",["T_WHITESPACE"," ",338],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","session",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","data",338],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",338],"]",")",",",["T_WHITESPACE"," ",338],["T_LNUMBER","2",338],")",["T_WHITESPACE"," ",338],"*",["T_WHITESPACE"," ",338],["T_LNUMBER","100",338],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",338],["T_CONSTANT_ENCAPSED_STRING","'productUrl'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_STRING","str_replace",339],"(",["T_CONSTANT_ENCAPSED_STRING","'&amp;'",339],",",["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'&'",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","url",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","link",339],"(",["T_CONSTANT_ENCAPSED_STRING","'product\/product'",339],",",["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'product_id='",339],["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_VARIABLE","$product",339],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",339],"]",")",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t",339],["T_CONSTANT_ENCAPSED_STRING","'productId'",340],["T_WHITESPACE","  ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$product",340],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",340],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",340],["T_CONSTANT_ENCAPSED_STRING","'quantity'",341],["T_WHITESPACE","   ",341],["T_DOUBLE_ARROW","=>",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$product",341],"[",["T_CONSTANT_ENCAPSED_STRING","'quantity'",341],"]",",",["T_WHITESPACE","\n\t\t\t\t\t\t",341],["T_CONSTANT_ENCAPSED_STRING","'weight'",342],["T_WHITESPACE","     ",342],["T_DOUBLE_ARROW","=>",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$weight",342],["T_WHITESPACE","\n\t\t\t\t\t",342],")",")",";",["T_WHITESPACE","\n\t\t\t\t",343],"}",["T_WHITESPACE","\n\n\t\t\t\t",344],["T_VARIABLE","$data",346],"[",["T_CONSTANT_ENCAPSED_STRING","'products'",346],"]",["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_VARIABLE","$products",346],";",["T_WHITESPACE","\n\n\t\t\t\t",346],["T_VARIABLE","$data",348],"[",["T_CONSTANT_ENCAPSED_STRING","'goodsList'",348],"]",["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","urlencode",348],"(",["T_STRING","json_encode",348],"(",["T_VARIABLE","$products",348],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",348],["T_IF","if",350],["T_WHITESPACE"," ",350],"(",["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","config",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","get",350],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_environment'",350],")",["T_WHITESPACE"," ",350],["T_IS_EQUAL","==",350],["T_WHITESPACE"," ",350],["T_CONSTANT_ENCAPSED_STRING","'live'",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n\t\t\t\t\t",350],["T_VARIABLE","$data",351],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",351],"]",["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.pilibaba.com\/pilipay\/payreq'",351],";",["T_WHITESPACE","\n\t\t\t\t",351],"}",["T_WHITESPACE"," ",352],["T_ELSE","else",352],["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n\t\t\t\t\t",352],["T_VARIABLE","$data",353],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",353],"]",["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/pre.pilibaba.com\/pilipay\/payreq'",353],";",["T_WHITESPACE","\n\t\t\t\t",353],"}",["T_WHITESPACE","\n\n\t\t\t\t",354],["T_VARIABLE","$data",356],"[",["T_CONSTANT_ENCAPSED_STRING","'text_redirecting'",356],"]",["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","language",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","get",356],"(",["T_CONSTANT_ENCAPSED_STRING","'text_redirecting'",356],")",";",["T_WHITESPACE","\n\n\t\t\t\t",356],["T_VARIABLE","$data",358],"[",["T_CONSTANT_ENCAPSED_STRING","'auto_submit'",358],"]",["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","true",358],";",["T_WHITESPACE","\n\n\t\t\t\t",358],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","model_extension_payment_pilibaba",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","log",360],"(",["T_CONSTANT_ENCAPSED_STRING","'Request: '",360],["T_WHITESPACE"," ",360],".",["T_WHITESPACE"," ",360],["T_STRING","print_r",360],"(",["T_VARIABLE","$data",360],",",["T_WHITESPACE"," ",360],["T_STRING","true",360],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",360],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","response",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","setOutput",362],"(",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","load",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","view",362],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$data",362],")",")",";",["T_WHITESPACE","\n\t\t\t",362],"}",["T_WHITESPACE","\n\t\t",363],"}",["T_WHITESPACE"," ",364],["T_ELSE","else",364],["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n\t\t   ",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","model_extension_payment_pilibaba",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","log",365],"(",["T_CONSTANT_ENCAPSED_STRING","'Module disabled'",365],")",";",["T_WHITESPACE","\n\t\t",365],"}",["T_WHITESPACE","\n\t",366],"}",["T_WHITESPACE","\n\n\t",367],["T_PUBLIC","public",369],["T_WHITESPACE"," ",369],["T_FUNCTION","function",369],["T_WHITESPACE"," ",369],["T_STRING","callback",369],"(",")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n\t\t",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","load",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","language",370],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",370],")",";",["T_WHITESPACE","\n\n\t\t",370],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","load",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","model",372],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/order'",372],")",";",["T_WHITESPACE","\n\t\t",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","load",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","model",373],"(",["T_CONSTANT_ENCAPSED_STRING","'extension\/payment\/pilibaba'",373],")",";",["T_WHITESPACE","\n\n\t\t",373],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","model_extension_payment_pilibaba",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","log",375],"(",["T_CONSTANT_ENCAPSED_STRING","'Receiving callback'",375],")",";",["T_WHITESPACE","\n\n\t\t",375],["T_VARIABLE","$response_data",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","request",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","get",377],";",["T_WHITESPACE","\n\n\t\t",377],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","model_extension_payment_pilibaba",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","log",379],"(",["T_CONSTANT_ENCAPSED_STRING","'Response: '",379],["T_WHITESPACE"," ",379],".",["T_WHITESPACE"," ",379],["T_STRING","print_r",379],"(",["T_VARIABLE","$response_data",379],",",["T_WHITESPACE"," ",379],["T_STRING","true",379],")",")",";",["T_WHITESPACE","\n\n\t\t",379],["T_VARIABLE","$sign_msg",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_STRING","strtoupper",381],"(",["T_STRING","md5",381],"(",["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","config",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","get",381],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_merchant_number'",381],")",["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_VARIABLE","$response_data",381],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",381],"]",["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_VARIABLE","$response_data",381],"[",["T_CONSTANT_ENCAPSED_STRING","'orderAmount'",381],"]",["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_CONSTANT_ENCAPSED_STRING","'MD5'",381],["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_VARIABLE","$response_data",381],"[",["T_CONSTANT_ENCAPSED_STRING","'fee'",381],"]",["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_VARIABLE","$response_data",381],"[",["T_CONSTANT_ENCAPSED_STRING","'orderTime'",381],"]",["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_VARIABLE","$response_data",381],"[",["T_CONSTANT_ENCAPSED_STRING","'customerMail'",381],"]",["T_WHITESPACE"," ",381],".",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","config",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","get",381],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_secret_key'",381],")",")",")",";",["T_WHITESPACE","\n\n\t\t",381],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","model_extension_payment_pilibaba",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","log",383],"(",["T_CONSTANT_ENCAPSED_STRING","'signMsg: '",383],["T_WHITESPACE"," ",383],".",["T_WHITESPACE"," ",383],["T_VARIABLE","$sign_msg",383],")",";",["T_WHITESPACE","\n\n\t\t",383],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_STRING","hash_equals",385],"(",["T_VARIABLE","$sign_msg",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$response_data",385],"[",["T_CONSTANT_ENCAPSED_STRING","'signMsg'",385],"]",")",")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n\t\t\t",385],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","model_extension_payment_pilibaba",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","log",386],"(",["T_CONSTANT_ENCAPSED_STRING","'Adding Pilibaba order'",386],")",";",["T_WHITESPACE","\n\n\t\t\t",386],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","model_extension_payment_pilibaba",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","addPilibabaOrder",388],"(",["T_VARIABLE","$response_data",388],")",";",["T_WHITESPACE","\n\n\t\t\t",388],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","model_extension_payment_pilibaba",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","log",390],"(",["T_CONSTANT_ENCAPSED_STRING","'Pilibaba order added'",390],")",";",["T_WHITESPACE","\n\n\t\t\t",390],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","model_extension_payment_pilibaba",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","log",392],"(",["T_CONSTANT_ENCAPSED_STRING","'Getting consumer info'",392],")",";",["T_WHITESPACE","\n\n\t\t\t",392],["T_VARIABLE","$consumer_info",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","model_extension_payment_pilibaba",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getConsumerInfo",394],"(",["T_VARIABLE","$response_data",394],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",394],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",394],["T_IF","if",396],["T_WHITESPACE"," ",396],"(",["T_ISSET","isset",396],"(",["T_VARIABLE","$consumer_info",396],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",396],"]",")",["T_WHITESPACE"," ",396],["T_BOOLEAN_AND","&&",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$consumer_info",396],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",396],"]",["T_WHITESPACE"," ",396],["T_IS_EQUAL","==",396],["T_WHITESPACE"," ",396],["T_CONSTANT_ENCAPSED_STRING","'success'",396],")",["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n\t\t\t\t",396],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","model_extension_payment_pilibaba",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","log",397],"(",["T_CONSTANT_ENCAPSED_STRING","'Updating order info'",397],")",";",["T_WHITESPACE","\n\n\t\t\t\t",397],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","model_extension_payment_pilibaba",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","updateOrderInfo",399],"(",["T_VARIABLE","$consumer_info",399],",",["T_WHITESPACE"," ",399],["T_VARIABLE","$response_data",399],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",399],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",399],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","model_extension_payment_pilibaba",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","log",401],"(",["T_CONSTANT_ENCAPSED_STRING","'Order info updated'",401],")",";",["T_WHITESPACE","\n\n\t\t\t\t",401],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","model_extension_payment_pilibaba",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","log",403],"(",["T_CONSTANT_ENCAPSED_STRING","'Adding order history'",403],")",";",["T_WHITESPACE","\n\n\t\t\t\t",403],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","model_checkout_order",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","addOrderHistory",405],"(",["T_VARIABLE","$response_data",405],"[",["T_CONSTANT_ENCAPSED_STRING","'orderNo'",405],"]",",",["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","config",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","get",405],"(",["T_CONSTANT_ENCAPSED_STRING","'pilibaba_order_status_id'",405],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",405],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","model_extension_payment_pilibaba",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","log",407],"(",["T_CONSTANT_ENCAPSED_STRING","'Order history added'",407],")",";",["T_WHITESPACE","\n\t\t\t",407],"}",["T_WHITESPACE"," ",408],["T_ELSE","else",408],["T_WHITESPACE"," ",408],"{",["T_WHITESPACE","\n\t\t\t\t",408],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","model_extension_payment_pilibaba",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","log",409],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid consumer info response'",409],")",";",["T_WHITESPACE","\n\t\t\t",409],"}",["T_WHITESPACE","\n\n\t\t\t",410],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","model_extension_payment_pilibaba",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","log",412],"(",["T_CONSTANT_ENCAPSED_STRING","'Outputting \"OK\"'",412],")",";",["T_WHITESPACE","\n\n\t\t\t",412],["T_ECHO","echo",414],["T_WHITESPACE"," ",414],["T_CONSTANT_ENCAPSED_STRING","'OK'",414],";",["T_WHITESPACE","\n\n\t\t\t",414],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","model_extension_payment_pilibaba",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","log",416],"(",["T_CONSTANT_ENCAPSED_STRING","'\"OK\" outputted'",416],")",";",["T_WHITESPACE","\n\t\t",416],"}",["T_WHITESPACE"," ",417],["T_ELSE","else",417],["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n\t\t\t",417],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","model_extension_payment_pilibaba",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","log",418],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid callback response'",418],")",";",["T_WHITESPACE","\n\t\t",418],"}",["T_WHITESPACE","\n\t",419],"}",["T_WHITESPACE","\n",420],"}"]