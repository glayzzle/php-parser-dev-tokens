[["T_OPEN_TAG","<?php\n",1],["T_NAMESPACE","namespace",2],["T_WHITESPACE"," ",2],["T_STRING","DB",2],";",["T_WHITESPACE","\n",2],["T_FINAL","final",3],["T_WHITESPACE"," ",3],["T_CLASS","class",3],["T_WHITESPACE"," ",3],["T_STRING","MSSQL",3],["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\t",3],["T_PRIVATE","private",4],["T_WHITESPACE"," ",4],["T_VARIABLE","$connection",4],";",["T_WHITESPACE","\n\n\t",4],["T_PUBLIC","public",6],["T_WHITESPACE"," ",6],["T_FUNCTION","function",6],["T_WHITESPACE"," ",6],["T_STRING","__construct",6],"(",["T_VARIABLE","$hostname",6],",",["T_WHITESPACE"," ",6],["T_VARIABLE","$username",6],",",["T_WHITESPACE"," ",6],["T_VARIABLE","$password",6],",",["T_WHITESPACE"," ",6],["T_VARIABLE","$database",6],",",["T_WHITESPACE"," ",6],["T_VARIABLE","$port",6],["T_WHITESPACE"," ",6],"=",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","'1433'",6],")",["T_WHITESPACE"," ",6],"{",["T_WHITESPACE","\n\t\t",6],["T_IF","if",7],["T_WHITESPACE"," ",7],"(","!",["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","connection",7],["T_WHITESPACE"," ",7],"=",["T_WHITESPACE"," ",7],["T_STRING","mssql_connect",7],"(",["T_VARIABLE","$hostname",7],".",["T_WHITESPACE"," ",7],["T_CONSTANT_ENCAPSED_STRING","':'",7],["T_WHITESPACE"," ",7],".",["T_WHITESPACE"," ",7],["T_VARIABLE","$port",7],",",["T_WHITESPACE"," ",7],["T_VARIABLE","$username",7],",",["T_WHITESPACE"," ",7],["T_VARIABLE","$password",7],")",")",["T_WHITESPACE"," ",7],"{",["T_WHITESPACE","\n\t\t\t",7],["T_THROW","throw",8],["T_WHITESPACE"," ",8],["T_NEW","new",8],["T_WHITESPACE"," ",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Exception",8],"(",["T_CONSTANT_ENCAPSED_STRING","'Error: Could not make a database connection using '",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_VARIABLE","$username",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","'@'",8],["T_WHITESPACE"," ",8],".",["T_WHITESPACE"," ",8],["T_VARIABLE","$hostname",8],")",";",["T_WHITESPACE","\n\t\t",8],"}",["T_WHITESPACE","\n\n\t\t",9],["T_IF","if",11],["T_WHITESPACE"," ",11],"(","!",["T_STRING","mssql_select_db",11],"(",["T_VARIABLE","$database",11],",",["T_WHITESPACE"," ",11],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","link",11],")",")",["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\t\t\t",11],["T_THROW","throw",12],["T_WHITESPACE"," ",12],["T_NEW","new",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Exception",12],"(",["T_CONSTANT_ENCAPSED_STRING","'Error: Could not connect to database '",12],["T_WHITESPACE"," ",12],".",["T_WHITESPACE"," ",12],["T_VARIABLE","$database",12],")",";",["T_WHITESPACE","\n\t\t",12],"}",["T_WHITESPACE","\n\n\t\t",13],["T_STRING","mssql_query",15],"(",["T_CONSTANT_ENCAPSED_STRING","\"SET NAMES 'utf8'\"",15],",",["T_WHITESPACE"," ",15],["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","connection",15],")",";",["T_WHITESPACE","\n\t\t",15],["T_STRING","mssql_query",16],"(",["T_CONSTANT_ENCAPSED_STRING","\"SET CHARACTER SET utf8\"",16],",",["T_WHITESPACE"," ",16],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","connection",16],")",";",["T_WHITESPACE","\n\t",16],"}",["T_WHITESPACE","\n\n\t",17],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_FUNCTION","function",19],["T_WHITESPACE"," ",19],["T_STRING","query",19],"(",["T_VARIABLE","$sql",19],")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t",19],["T_VARIABLE","$resource",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_STRING","mssql_query",20],"(",["T_VARIABLE","$sql",20],",",["T_WHITESPACE"," ",20],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","connection",20],")",";",["T_WHITESPACE","\n\n\t\t",20],["T_IF","if",22],["T_WHITESPACE"," ",22],"(",["T_VARIABLE","$resource",22],")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\t\t\t",22],["T_IF","if",23],["T_WHITESPACE"," ",23],"(",["T_STRING","is_resource",23],"(",["T_VARIABLE","$resource",23],")",")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\t\t\t\t",23],["T_VARIABLE","$i",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_LNUMBER","0",24],";",["T_WHITESPACE","\n\n\t\t\t\t",24],["T_VARIABLE","$data",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_ARRAY","array",26],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t",26],["T_WHILE","while",28],["T_WHITESPACE"," ",28],"(",["T_VARIABLE","$result",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_STRING","mssql_fetch_assoc",28],"(",["T_VARIABLE","$resource",28],")",")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n\t\t\t\t\t",28],["T_VARIABLE","$data",29],"[",["T_VARIABLE","$i",29],"]",["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$result",29],";",["T_WHITESPACE","\n\n\t\t\t\t\t",29],["T_VARIABLE","$i",31],["T_INC","++",31],";",["T_WHITESPACE","\n\t\t\t\t",31],"}",["T_WHITESPACE","\n\n\t\t\t\t",32],["T_STRING","mssql_free_result",34],"(",["T_VARIABLE","$resource",34],")",";",["T_WHITESPACE","\n\n\t\t\t\t",34],["T_VARIABLE","$query",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_NEW","new",36],["T_WHITESPACE"," ",36],["T_NS_SEPARATOR","\\",36],["T_STRING","stdClass",36],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",36],["T_VARIABLE","$query",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","row",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_ISSET","isset",37],"(",["T_VARIABLE","$data",37],"[",["T_LNUMBER","0",37],"]",")",["T_WHITESPACE"," ",37],"?",["T_WHITESPACE"," ",37],["T_VARIABLE","$data",37],"[",["T_LNUMBER","0",37],"]",["T_WHITESPACE"," ",37],":",["T_WHITESPACE"," ",37],["T_ARRAY","array",37],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",37],["T_VARIABLE","$query",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","rows",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$data",38],";",["T_WHITESPACE","\n\t\t\t\t",38],["T_VARIABLE","$query",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","num_rows",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$i",39],";",["T_WHITESPACE","\n\n\t\t\t\t",39],["T_UNSET","unset",41],"(",["T_VARIABLE","$data",41],")",";",["T_WHITESPACE","\n\n\t\t\t\t",41],["T_RETURN","return",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$query",43],";",["T_WHITESPACE","\n\t\t\t",43],"}",["T_WHITESPACE"," ",44],["T_ELSE","else",44],["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n\t\t\t\t",44],["T_RETURN","return",45],["T_WHITESPACE"," ",45],["T_STRING","true",45],";",["T_WHITESPACE","\n\t\t\t",45],"}",["T_WHITESPACE","\n\t\t",46],"}",["T_WHITESPACE"," ",47],["T_ELSE","else",47],["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n\t\t\t",47],["T_THROW","throw",48],["T_WHITESPACE"," ",48],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Exception",48],"(",["T_CONSTANT_ENCAPSED_STRING","'Error: '",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_STRING","mssql_get_last_message",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","connection",48],")",["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'<br \/>'",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_VARIABLE","$sql",48],")",";",["T_WHITESPACE","\n\t\t",48],"}",["T_WHITESPACE","\n\t",49],"}",["T_WHITESPACE","\n\n\t",50],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","escape",52],"(",["T_VARIABLE","$value",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n\t\t",52],["T_VARIABLE","$unpacked",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","unpack",53],"(",["T_CONSTANT_ENCAPSED_STRING","'H*hex'",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$value",53],")",";",["T_WHITESPACE","\n\n\t\t",53],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'0x'",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$unpacked",55],"[",["T_CONSTANT_ENCAPSED_STRING","'hex'",55],"]",";",["T_WHITESPACE","\n\t",55],"}",["T_WHITESPACE","\n\n\t",56],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","countAffected",58],"(",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n\t\t",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_STRING","mssql_rows_affected",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","connection",59],")",";",["T_WHITESPACE","\n\t",59],"}",["T_WHITESPACE","\n\n\t",60],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","getLastId",62],"(",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n\t\t",62],["T_VARIABLE","$last_id",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","false",63],";",["T_WHITESPACE","\n\n\t\t",63],["T_VARIABLE","$resource",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","mssql_query",65],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT @@identity AS id\"",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","connection",65],")",";",["T_WHITESPACE","\n\n\t\t",65],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$row",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_STRING","mssql_fetch_row",67],"(",["T_VARIABLE","$resource",67],")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n\t\t\t",67],["T_VARIABLE","$last_id",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","trim",68],"(",["T_VARIABLE","$row",68],"[",["T_LNUMBER","0",68],"]",")",";",["T_WHITESPACE","\n\t\t",68],"}",["T_WHITESPACE","\n\n\t\t",69],["T_STRING","mssql_free_result",71],"(",["T_VARIABLE","$resource",71],")",";",["T_WHITESPACE","\n\n\t\t",71],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$last_id",73],";",["T_WHITESPACE","\n\t",73],"}",["T_WHITESPACE","\n\n\t",74],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","__destruct",76],"(",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n\t\t",76],["T_STRING","mssql_close",77],"(",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","connection",77],")",";",["T_WHITESPACE","\n\t",77],"}",["T_WHITESPACE","\n",78],"}"]