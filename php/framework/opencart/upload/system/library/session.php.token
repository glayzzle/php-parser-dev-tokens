[["T_OPEN_TAG","<?php\n",1],["T_CLASS","class",2],["T_WHITESPACE"," ",2],["T_STRING","Session",2],["T_WHITESPACE"," ",2],"{",["T_WHITESPACE","\n\t",2],["T_PUBLIC","public",3],["T_WHITESPACE"," ",3],["T_VARIABLE","$session_id",3],["T_WHITESPACE"," ",3],"=",["T_WHITESPACE"," ",3],["T_CONSTANT_ENCAPSED_STRING","''",3],";",["T_WHITESPACE","\n\t",3],["T_PUBLIC","public",4],["T_WHITESPACE"," ",4],["T_VARIABLE","$data",4],["T_WHITESPACE"," ",4],"=",["T_WHITESPACE"," ",4],["T_ARRAY","array",4],"(",")",";",["T_WHITESPACE","\n\n\t",4],["T_PUBLIC","public",6],["T_WHITESPACE"," ",6],["T_FUNCTION","function",6],["T_WHITESPACE"," ",6],["T_STRING","__construct",6],"(",["T_VARIABLE","$adaptor",6],["T_WHITESPACE"," ",6],"=",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","'native'",6],")",["T_WHITESPACE"," ",6],"{",["T_WHITESPACE","\n\t\t",6],["T_VARIABLE","$class",7],["T_WHITESPACE"," ",7],"=",["T_WHITESPACE"," ",7],["T_CONSTANT_ENCAPSED_STRING","'Session\\\\'",7],["T_WHITESPACE"," ",7],".",["T_WHITESPACE"," ",7],["T_VARIABLE","$adaptor",7],";",["T_WHITESPACE","\n\t\t\n\t\t",7],["T_IF","if",9],["T_WHITESPACE"," ",9],"(",["T_STRING","class_exists",9],"(",["T_VARIABLE","$class",9],")",")",["T_WHITESPACE"," ",9],"{",["T_WHITESPACE","\n\t\t\t",9],["T_VARIABLE","$this",10],["T_OBJECT_OPERATOR","->",10],["T_STRING","adaptor",10],["T_WHITESPACE"," ",10],"=",["T_WHITESPACE"," ",10],["T_NEW","new",10],["T_WHITESPACE"," ",10],["T_VARIABLE","$class",10],"(",["T_VARIABLE","$this",10],")",";",["T_WHITESPACE","\n\t\t",10],"}",["T_WHITESPACE"," ",11],["T_ELSE","else",11],["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\t\t\t",11],["T_THROW","throw",12],["T_WHITESPACE"," ",12],["T_NEW","new",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Exception",12],"(",["T_CONSTANT_ENCAPSED_STRING","'Error: Could not load session adaptor '",12],["T_WHITESPACE"," ",12],".",["T_WHITESPACE"," ",12],["T_VARIABLE","$adaptor",12],["T_WHITESPACE"," ",12],".",["T_WHITESPACE"," ",12],["T_CONSTANT_ENCAPSED_STRING","' session!'",12],")",";",["T_WHITESPACE","\n\t\t",12],"}",["T_WHITESPACE","\t\t\n\t\t\n\t\t",13],["T_IF","if",15],["T_WHITESPACE"," ",15],"(",["T_VARIABLE","$this",15],["T_OBJECT_OPERATOR","->",15],["T_STRING","adaptor",15],")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\t\t\t",15],["T_STRING","session_set_save_handler",16],"(",["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","adaptor",16],")",";",["T_WHITESPACE","\n\t\t",16],"}",["T_WHITESPACE","\n\t\t\t\n\t\t",17],["T_IF","if",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","adaptor",19],["T_WHITESPACE"," ",19],["T_BOOLEAN_AND","&&",19],["T_WHITESPACE"," ",19],"!",["T_STRING","session_id",19],"(",")",")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\t\t\t",19],["T_STRING","ini_set",20],"(",["T_CONSTANT_ENCAPSED_STRING","'session.use_only_cookies'",20],",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'Off'",20],")",";",["T_WHITESPACE","\n\t\t\t",20],["T_STRING","ini_set",21],"(",["T_CONSTANT_ENCAPSED_STRING","'session.use_cookies'",21],",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'On'",21],")",";",["T_WHITESPACE","\n\t\t\t",21],["T_STRING","ini_set",22],"(",["T_CONSTANT_ENCAPSED_STRING","'session.use_trans_sid'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'Off'",22],")",";",["T_WHITESPACE","\n\t\t\t",22],["T_STRING","ini_set",23],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_httponly'",23],",",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'On'",23],")",";",["T_WHITESPACE","\n\t\t\n\t\t\t",23],["T_IF","if",25],["T_WHITESPACE"," ",25],"(",["T_ISSET","isset",25],"(",["T_VARIABLE","$_COOKIE",25],"[",["T_STRING","session_name",25],"(",")","]",")",["T_WHITESPACE"," ",25],["T_BOOLEAN_AND","&&",25],["T_WHITESPACE"," ",25],"!",["T_STRING","preg_match",25],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[a-zA-Z0-9,\\-]{22,52}$\/'",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$_COOKIE",25],"[",["T_STRING","session_name",25],"(",")","]",")",")",["T_WHITESPACE"," ",25],"{",["T_WHITESPACE","\n\t\t\t\t",25],["T_EXIT","exit",26],"(",["T_CONSTANT_ENCAPSED_STRING","'Error: Invalid session ID!'",26],")",";",["T_WHITESPACE","\n\t\t\t",26],"}",["T_WHITESPACE","\n\t\t\t\n\t\t\t",27],["T_STRING","session_set_cookie_params",29],"(",["T_LNUMBER","0",29],",",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'\/'",29],")",";",["T_WHITESPACE","\n\t\t\t",29],["T_STRING","session_start",30],"(",")",";",["T_WHITESPACE","\n\t\t",30],"}",["T_WHITESPACE","\t\t\t\n\t",31],"}",["T_WHITESPACE","\n\t\t\n\t",32],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","start",34],"(",["T_VARIABLE","$key",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'default'",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$value",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","''",34],")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n\t\t",34],["T_IF","if",35],["T_WHITESPACE"," ",35],"(",["T_VARIABLE","$value",35],")",["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n\t\t\t",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","session_id",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$value",36],";",["T_WHITESPACE","\n\t\t",36],"}",["T_WHITESPACE"," ",37],["T_ELSEIF","elseif",37],["T_WHITESPACE"," ",37],"(",["T_ISSET","isset",37],"(",["T_VARIABLE","$_COOKIE",37],"[",["T_VARIABLE","$key",37],"]",")",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n\t\t\t",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","session_id",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$_COOKIE",38],"[",["T_VARIABLE","$key",38],"]",";",["T_WHITESPACE","\n\t\t",38],"}",["T_WHITESPACE"," ",39],["T_ELSE","else",39],["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n\t\t\t",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","session_id",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","createId",40],"(",")",";",["T_WHITESPACE","\n\t\t",40],"}",["T_WHITESPACE","\t\n\t\t\n\t\t",41],["T_IF","if",43],["T_WHITESPACE"," ",43],"(","!",["T_ISSET","isset",43],"(",["T_VARIABLE","$_SESSION",43],"[",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","session_id",43],"]",")",")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n\t\t\t",43],["T_VARIABLE","$_SESSION",44],"[",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","session_id",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",")",";",["T_WHITESPACE","\n\t\t",44],"}",["T_WHITESPACE","\n\t\t\n\t\t",45],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","data",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],"&",["T_VARIABLE","$_SESSION",47],"[",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","session_id",47],"]",";",["T_WHITESPACE","\n\t\t\n\t\t",47],["T_IF","if",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$key",49],["T_WHITESPACE"," ",49],["T_IS_NOT_EQUAL","!=",49],["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'PHPSESSID'",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\t\t\t",49],["T_STRING","setcookie",50],"(",["T_VARIABLE","$key",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","session_id",50],",",["T_WHITESPACE"," ",50],["T_STRING","ini_get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_lifetime'",50],")",",",["T_WHITESPACE"," ",50],["T_STRING","ini_get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_path'",50],")",",",["T_WHITESPACE"," ",50],["T_STRING","ini_get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_domain'",50],")",",",["T_WHITESPACE"," ",50],["T_STRING","ini_get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_secure'",50],")",",",["T_WHITESPACE"," ",50],["T_STRING","ini_get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_httponly'",50],")",")",";",["T_WHITESPACE","\n\t\t",50],"}",["T_WHITESPACE","\n\t\t\n\t\t",51],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","session_id",53],";",["T_WHITESPACE","\n\t",53],"}",["T_WHITESPACE","\t\n\n\t",54],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","getId",56],"(",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n\t\t",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","session_id",57],";",["T_WHITESPACE","\n\t",57],"}",["T_WHITESPACE","\n\t\n\t",58],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","createId",60],"(",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n\t\t",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(",["T_STRING","version_compare",61],"(",["T_STRING","phpversion",61],"(",")",",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'5.5.4'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'>'",61],")",["T_WHITESPACE"," ",61],["T_IS_EQUAL","==",61],["T_WHITESPACE"," ",61],["T_STRING","true",61],["T_WHITESPACE"," ",61],["T_BOOLEAN_AND","&&",61],["T_WHITESPACE"," ",61],["T_STRING","method_exists",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","adaptor",61],",",["T_CONSTANT_ENCAPSED_STRING","'create_sid'",61],")",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n\t\t\t",61],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","adaptor",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","create_sid",62],"(",")",";",["T_WHITESPACE","\n\t\t",62],"}",["T_WHITESPACE"," ",63],["T_ELSEIF","elseif",63],["T_WHITESPACE"," ",63],"(",["T_STRING","function_exists",63],"(",["T_CONSTANT_ENCAPSED_STRING","'random_bytes'",63],")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n        \t",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_STRING","substr",64],"(",["T_STRING","bin2hex",64],"(",["T_STRING","random_bytes",64],"(",["T_LNUMBER","26",64],")",")",",",["T_WHITESPACE"," ",64],["T_LNUMBER","0",64],",",["T_WHITESPACE"," ",64],["T_LNUMBER","26",64],")",";",["T_WHITESPACE","\n\t\t",64],"}",["T_WHITESPACE"," ",65],["T_ELSEIF","elseif",65],["T_WHITESPACE"," ",65],"(",["T_STRING","function_exists",65],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl_random_pseudo_bytes'",65],")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n\t\t\t",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_STRING","substr",66],"(",["T_STRING","bin2hex",66],"(",["T_STRING","openssl_random_pseudo_bytes",66],"(",["T_LNUMBER","26",66],")",")",",",["T_WHITESPACE"," ",66],["T_LNUMBER","0",66],",",["T_WHITESPACE"," ",66],["T_LNUMBER","26",66],")",";",["T_WHITESPACE","\n\t\t",66],"}",["T_WHITESPACE"," ",67],["T_ELSE","else",67],["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n\t\t\t",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_STRING","substr",68],"(",["T_STRING","bin2hex",68],"(",["T_STRING","mcrypt_create_iv",68],"(",["T_LNUMBER","26",68],",",["T_WHITESPACE"," ",68],["T_STRING","MCRYPT_DEV_URANDOM",68],")",")",",",["T_WHITESPACE"," ",68],["T_LNUMBER","0",68],",",["T_WHITESPACE"," ",68],["T_LNUMBER","26",68],")",";",["T_WHITESPACE","\n\t\t",68],"}",["T_WHITESPACE","\n\t",69],"}",["T_WHITESPACE","\n\t\t\n\t",70],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","destroy",72],"(",["T_VARIABLE","$key",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'default'",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n\t\t",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_ISSET","isset",73],"(",["T_VARIABLE","$_SESSION",73],"[",["T_VARIABLE","$key",73],"]",")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n\t\t\t",73],["T_UNSET","unset",74],"(",["T_VARIABLE","$_SESSION",74],"[",["T_VARIABLE","$key",74],"]",")",";",["T_WHITESPACE","\n\t\t",74],"}",["T_WHITESPACE","\n\t\t\n\t\t",75],["T_STRING","setcookie",77],"(",["T_VARIABLE","$key",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","''",77],",",["T_WHITESPACE"," ",77],["T_STRING","time",77],"(",")",["T_WHITESPACE"," ",77],"-",["T_WHITESPACE"," ",77],["T_LNUMBER","42000",77],",",["T_WHITESPACE"," ",77],["T_STRING","ini_get",77],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_path'",77],")",",",["T_WHITESPACE"," ",77],["T_STRING","ini_get",77],"(",["T_CONSTANT_ENCAPSED_STRING","'session.cookie_domain'",77],")",")",";",["T_WHITESPACE","\n\t",77],"}",["T_WHITESPACE","\n",78],"}"]