[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Component",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Utility",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Utility class for cryptographically-secure string handling routines.\n *\n * @ingroup utility\n *\/",5],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","Crypt",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * Returns a string of highly randomized bytes (over the full 8-bit range).\n   *\n   * This function is better than simply calling mt_rand() or any other built-in\n   * PHP function because it can return a long string of bytes (compared to < 4\n   * bytes normally from mt_rand()) and uses the best available pseudo-random\n   * source.\n   *\n   * In PHP 7 and up, this uses the built-in PHP function random_bytes().\n   * In older PHP versions, this uses the random_bytes() function provided by\n   * the random_compat library.\n   *\n   * @param int $count\n   *   The number of characters (bytes) to return in the string.\n   *\n   * @return string\n   *   A randomly generated string.\n   *\/",12],["T_WHITESPACE","\n  ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_STATIC","static",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","randomBytes",30],"(",["T_VARIABLE","$count",30],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n    ",30],["T_RETURN","return",31],["T_WHITESPACE"," ",31],["T_STRING","random_bytes",31],"(",["T_VARIABLE","$count",31],")",";",["T_WHITESPACE","\n  ",31],"}",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Calculates a base-64 encoded, URL-safe sha-256 hmac.\n   *\n   * @param mixed $data\n   *   Scalar value to be validated with the hmac.\n   * @param mixed $key\n   *   A secret key, this can be any scalar value.\n   *\n   * @return string\n   *   A base-64 encoded sha-256 hmac, with + replaced with -, \/ with _ and\n   *   any = padding characters removed.\n   *\/",34],["T_WHITESPACE","\n  ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_STATIC","static",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","hmacBase64",46],"(",["T_VARIABLE","$data",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$key",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n    ",46],["T_COMMENT","\/\/ $data and $key being strings here is necessary to avoid empty string\n",47],["T_WHITESPACE","    ",48],["T_COMMENT","\/\/ results of the hash function if they are not scalar values. As this\n",48],["T_WHITESPACE","    ",49],["T_COMMENT","\/\/ function is used in security-critical contexts like token validation it\n",49],["T_WHITESPACE","    ",50],["T_COMMENT","\/\/ is important that it never returns an empty string.\n",50],["T_WHITESPACE","    ",51],["T_IF","if",51],["T_WHITESPACE"," ",51],"(","!",["T_STRING","is_scalar",51],"(",["T_VARIABLE","$data",51],")",["T_WHITESPACE"," ",51],["T_BOOLEAN_OR","||",51],["T_WHITESPACE"," ",51],"!",["T_STRING","is_scalar",51],"(",["T_VARIABLE","$key",51],")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n      ",51],["T_THROW","throw",52],["T_WHITESPACE"," ",52],["T_NEW","new",52],["T_WHITESPACE"," ",52],["T_NS_SEPARATOR","\\",52],["T_STRING","InvalidArgumentException",52],"(",["T_CONSTANT_ENCAPSED_STRING","'Both parameters passed to \\Drupal\\Component\\Utility\\Crypt::hmacBase64 must be scalar values.'",52],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_VARIABLE","$hmac",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","base64_encode",55],"(",["T_STRING","hash_hmac",55],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$data",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$key",55],",",["T_WHITESPACE"," ",55],["T_STRING","TRUE",55],")",")",";",["T_WHITESPACE","\n    ",55],["T_COMMENT","\/\/ Modify the hmac so it's safe to use in URLs.\n",56],["T_WHITESPACE","    ",57],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_STRING","str_replace",57],"(","[",["T_CONSTANT_ENCAPSED_STRING","'+'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'\/'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'='",57],"]",",",["T_WHITESPACE"," ",57],"[",["T_CONSTANT_ENCAPSED_STRING","'-'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'_'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","''",57],"]",",",["T_WHITESPACE"," ",57],["T_VARIABLE","$hmac",57],")",";",["T_WHITESPACE","\n  ",57],"}",["T_WHITESPACE","\n\n  ",58],["T_DOC_COMMENT","\/**\n   * Calculates a base-64 encoded, URL-safe sha-256 hash.\n   *\n   * @param string $data\n   *   String to be hashed.\n   *\n   * @return string\n   *   A base-64 encoded sha-256 hash, with + replaced with -, \/ with _ and\n   *   any = padding characters removed.\n   *\/",60],["T_WHITESPACE","\n  ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_STATIC","static",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","hashBase64",70],"(",["T_VARIABLE","$data",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$hash",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","base64_encode",71],"(",["T_STRING","hash",71],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$data",71],",",["T_WHITESPACE"," ",71],["T_STRING","TRUE",71],")",")",";",["T_WHITESPACE","\n    ",71],["T_COMMENT","\/\/ Modify the hash so it's safe to use in URLs.\n",72],["T_WHITESPACE","    ",73],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_STRING","str_replace",73],"(","[",["T_CONSTANT_ENCAPSED_STRING","'+'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'\/'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'='",73],"]",",",["T_WHITESPACE"," ",73],"[",["T_CONSTANT_ENCAPSED_STRING","'-'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'_'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","''",73],"]",",",["T_WHITESPACE"," ",73],["T_VARIABLE","$hash",73],")",";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * Compares strings in constant time.\n   *\n   * @param string $known_string\n   *   The expected string.\n   * @param string $user_string\n   *   The user supplied string to check.\n   *\n   * @return bool\n   *   Returns TRUE when the two strings are equal, FALSE otherwise.\n   *\/",76],["T_WHITESPACE","\n  ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_STATIC","static",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","hashEquals",87],"(",["T_VARIABLE","$known_string",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$user_string",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n    ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_STRING","function_exists",88],"(",["T_CONSTANT_ENCAPSED_STRING","'hash_equals'",88],")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n      ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_STRING","hash_equals",89],"(",["T_VARIABLE","$known_string",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$user_string",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n    ",90],["T_ELSE","else",91],["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n      ",91],["T_COMMENT","\/\/ Backport of hash_equals() function from PHP 5.6\n",92],["T_WHITESPACE","      ",93],["T_COMMENT","\/\/ @see https:\/\/github.com\/php\/php-src\/blob\/PHP-5.6\/ext\/hash\/hash.c#L739\n",93],["T_WHITESPACE","      ",94],["T_IF","if",94],["T_WHITESPACE"," ",94],"(","!",["T_STRING","is_string",94],"(",["T_VARIABLE","$known_string",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n        ",94],["T_STRING","trigger_error",95],"(",["T_STRING","sprintf",95],"(",["T_CONSTANT_ENCAPSED_STRING","\"Expected known_string to be a string, %s given\"",95],",",["T_WHITESPACE"," ",95],["T_STRING","gettype",95],"(",["T_VARIABLE","$known_string",95],")",")",",",["T_WHITESPACE"," ",95],["T_STRING","E_USER_WARNING",95],")",";",["T_WHITESPACE","\n        ",95],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_STRING","FALSE",96],";",["T_WHITESPACE","\n      ",96],"}",["T_WHITESPACE","\n\n      ",97],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_STRING","is_string",99],"(",["T_VARIABLE","$user_string",99],")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n        ",99],["T_STRING","trigger_error",100],"(",["T_STRING","sprintf",100],"(",["T_CONSTANT_ENCAPSED_STRING","\"Expected user_string to be a string, %s given\"",100],",",["T_WHITESPACE"," ",100],["T_STRING","gettype",100],"(",["T_VARIABLE","$user_string",100],")",")",",",["T_WHITESPACE"," ",100],["T_STRING","E_USER_WARNING",100],")",";",["T_WHITESPACE","\n        ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_STRING","FALSE",101],";",["T_WHITESPACE","\n      ",101],"}",["T_WHITESPACE","\n\n      ",102],["T_VARIABLE","$known_len",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","strlen",104],"(",["T_VARIABLE","$known_string",104],")",";",["T_WHITESPACE","\n      ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$known_len",105],["T_WHITESPACE"," ",105],["T_IS_NOT_IDENTICAL","!==",105],["T_WHITESPACE"," ",105],["T_STRING","strlen",105],"(",["T_VARIABLE","$user_string",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n        ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_STRING","FALSE",106],";",["T_WHITESPACE","\n      ",106],"}",["T_WHITESPACE","\n\n      ",107],["T_COMMENT","\/\/ This is security sensitive code. Do not optimize this for speed.\n",109],["T_WHITESPACE","      ",110],["T_VARIABLE","$result",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_LNUMBER","0",110],";",["T_WHITESPACE","\n      ",110],["T_FOR","for",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$i",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_LNUMBER","0",111],";",["T_WHITESPACE"," ",111],["T_VARIABLE","$i",111],["T_WHITESPACE"," ",111],"<",["T_WHITESPACE"," ",111],["T_VARIABLE","$known_len",111],";",["T_WHITESPACE"," ",111],["T_VARIABLE","$i",111],["T_INC","++",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$result",112],["T_WHITESPACE"," ",112],["T_OR_EQUAL","|=",112],["T_WHITESPACE"," ",112],"(",["T_STRING","ord",112],"(",["T_VARIABLE","$known_string",112],"[",["T_VARIABLE","$i",112],"]",")",["T_WHITESPACE"," ",112],"^",["T_WHITESPACE"," ",112],["T_STRING","ord",112],"(",["T_VARIABLE","$user_string",112],"[",["T_VARIABLE","$i",112],"]",")",")",";",["T_WHITESPACE","\n      ",112],"}",["T_WHITESPACE","\n\n      ",113],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$result",115],["T_WHITESPACE"," ",115],["T_IS_IDENTICAL","===",115],["T_WHITESPACE"," ",115],["T_LNUMBER","0",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n  ",116],"}",["T_WHITESPACE","\n\n  ",117],["T_DOC_COMMENT","\/**\n   * Returns a URL-safe, base64 encoded string of highly randomized bytes.\n   *\n   * @param $count\n   *   The number of random bytes to fetch and base64 encode.\n   *\n   * @return string\n   *   The base64 encoded result will have a length of up to 4 * $count.\n   *\n   * @see \\Drupal\\Component\\Utility\\Crypt::randomBytes()\n   *\/",119],["T_WHITESPACE","\n  ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_STATIC","static",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","randomBytesBase64",130],"(",["T_VARIABLE","$count",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_LNUMBER","32",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n    ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_STRING","str_replace",131],"(","[",["T_CONSTANT_ENCAPSED_STRING","'+'",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'\/'",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'='",131],"]",",",["T_WHITESPACE"," ",131],"[",["T_CONSTANT_ENCAPSED_STRING","'-'",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'_'",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","''",131],"]",",",["T_WHITESPACE"," ",131],["T_STRING","base64_encode",131],"(",["T_STATIC","static",131],["T_DOUBLE_COLON","::",131],["T_STRING","randomBytes",131],"(",["T_VARIABLE","$count",131],")",")",")",";",["T_WHITESPACE","\n  ",131],"}",["T_WHITESPACE","\n\n",132],"}",["T_WHITESPACE","\n",134]]