[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Component",3],["T_NS_SEPARATOR","\\",3],["T_STRING","PhpStorage",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Stores PHP code in files with securely hashed names.\n *\n * The goal of this class is to ensure that if a PHP file is replaced with\n * an untrusted one, it does not get loaded. Since mtime granularity is 1\n * second, we cannot prevent an attack that happens within one second of the\n * initial save(). However, it is very unlikely for an attacker exploiting an\n * upload or file write vulnerability to also know when a legitimate file is\n * being saved, discover its hash, undo its file permissions, and override the\n * file with an upload all within a single second. Being able to accomplish\n * that would indicate a site very likely vulnerable to many other attack\n * vectors.\n *\n * Each file is stored in its own unique containing directory. The hash is based\n * on the virtual file name, the containing directory's mtime, and a\n * cryptographically hard to guess secret string. Thus, even if the hashed file\n * name is discovered and replaced by an untrusted file (e.g., via a\n * move_uploaded_file() invocation by a script that performs insufficient\n * validation), the directory's mtime gets updated in the process, invalidating\n * the hash and preventing the untrusted file from getting loaded.\n *\n * This class does not protect against overwriting a file in-place (e.g. a\n * malicious module that does a file_put_contents()) since this will not change\n * the mtime of the directory. MTimeProtectedFileStorage protects against this\n * at the cost of an additional system call for every load() and exists().\n *\n * The containing directory is created with the same name as the virtual file\n * name (slashes removed) to assist with debugging, since the file itself is\n * stored with a name that's meaningless to humans.\n *\/",5],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","MTimeProtectedFastFileStorage",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","FileStorage",35],["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * The secret used in the HMAC.\n   *\n   * @var string\n   *\/",37],["T_WHITESPACE","\n  ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$secret",42],";",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * Constructs this MTimeProtectedFastFileStorage object.\n   *\n   * @param array $configuration\n   *   An associated array, containing at least these keys (the rest are\n   *   ignored):\n   *   - directory: The directory where the files should be stored.\n   *   - secret: A cryptographically hard to guess secret string.\n   *   -bin. The storage bin. Multiple storage objects can be instantiated with\n   *   the same configuration, but for different bins.\n   *\/",44],["T_WHITESPACE","\n  ",54],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","__construct",55],"(",["T_ARRAY","array",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$configuration",55],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n    ",55],["T_STRING","parent",56],["T_DOUBLE_COLON","::",56],["T_STRING","__construct",56],"(",["T_VARIABLE","$configuration",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","secret",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$configuration",57],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",57],"]",";",["T_WHITESPACE","\n  ",57],"}",["T_WHITESPACE","\n\n  ",58],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",60],["T_WHITESPACE","\n  ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","save",63],"(",["T_VARIABLE","$name",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$data",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","ensureDirectory",64],"(",["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","directory",64],")",";",["T_WHITESPACE","\n\n    ",64],["T_COMMENT","\/\/ Write the file out to a temporary location. Prepend with a '.' to keep it\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ hidden from listings and web servers.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$temporary_path",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","tempnam",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","directory",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'.'",68],")",";",["T_WHITESPACE","\n    ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(","!",["T_VARIABLE","$temporary_path",69],["T_WHITESPACE"," ",69],["T_BOOLEAN_OR","||",69],["T_WHITESPACE"," ",69],"!","@",["T_STRING","file_put_contents",69],"(",["T_VARIABLE","$temporary_path",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$data",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n      ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","FALSE",70],";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n    ",71],["T_COMMENT","\/\/ The file will not be chmod() in the future so this is the final\n",72],["T_WHITESPACE","    ",73],["T_COMMENT","\/\/ permission.\n",73],["T_WHITESPACE","    ",74],["T_STRING","chmod",74],"(",["T_VARIABLE","$temporary_path",74],",",["T_WHITESPACE"," ",74],["T_LNUMBER","0444",74],")",";",["T_WHITESPACE","\n\n    ",74],["T_COMMENT","\/\/ Determine the exact modification time of the file.\n",76],["T_WHITESPACE","    ",77],["T_VARIABLE","$mtime",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getUncachedMTime",77],"(",["T_VARIABLE","$temporary_path",77],")",";",["T_WHITESPACE","\n\n    ",77],["T_COMMENT","\/\/ Move the temporary file into the proper directory. Note that POSIX\n",79],["T_WHITESPACE","    ",80],["T_COMMENT","\/\/ compliant systems as well as modern Windows perform the rename operation\n",80],["T_WHITESPACE","    ",81],["T_COMMENT","\/\/ atomically, i.e. there is no point at which another process attempting to\n",81],["T_WHITESPACE","    ",82],["T_COMMENT","\/\/ access the new path will find it missing.\n",82],["T_WHITESPACE","    ",83],["T_VARIABLE","$directory",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getContainingDirectoryFullPath",83],"(",["T_VARIABLE","$name",83],")",";",["T_WHITESPACE","\n    ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","ensureDirectory",84],"(",["T_VARIABLE","$directory",84],")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$full_path",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getFullPath",85],"(",["T_VARIABLE","$name",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$directory",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$mtime",85],")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$result",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","rename",86],"(",["T_VARIABLE","$temporary_path",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$full_path",86],")",";",["T_WHITESPACE","\n\n    ",86],["T_COMMENT","\/\/ Finally reset the modification time of the directory to match the one of\n",88],["T_WHITESPACE","    ",89],["T_COMMENT","\/\/ the newly created file. In order to prevent the creation of a file if the\n",89],["T_WHITESPACE","    ",90],["T_COMMENT","\/\/ directory does not exist, ensure that the path terminates with a\n",90],["T_WHITESPACE","    ",91],["T_COMMENT","\/\/ directory separator.\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/\n",92],["T_WHITESPACE","    ",93],["T_COMMENT","\/\/ Recall that when subsequently loading the file, the hash is calculated\n",93],["T_WHITESPACE","    ",94],["T_COMMENT","\/\/ based on the file name, the containing mtime, and a the secret string.\n",94],["T_WHITESPACE","    ",95],["T_COMMENT","\/\/ Hence updating the mtime here is comparable to pointing a symbolic link\n",95],["T_WHITESPACE","    ",96],["T_COMMENT","\/\/ at a new target, i.e., the newly created file.\n",96],["T_WHITESPACE","    ",97],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$result",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n      ",97],["T_VARIABLE","$result",98],["T_WHITESPACE"," ",98],["T_AND_EQUAL","&=",98],["T_WHITESPACE"," ",98],["T_STRING","touch",98],"(",["T_VARIABLE","$directory",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'\/'",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$mtime",98],")",";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_BOOL_CAST","(bool)",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$result",101],";",["T_WHITESPACE","\n  ",101],"}",["T_WHITESPACE","\n\n  ",102],["T_DOC_COMMENT","\/**\n   * Gets the full path where the file is or should be stored.\n   *\n   * This function creates a file path that includes a unique containing\n   * directory for the file and a file name that is a hash of the virtual file\n   * name, a cryptographic secret, and the containing directory mtime. If the\n   * file is overridden by an insecure upload script, the directory mtime gets\n   * modified, invalidating the file, thus protecting against untrusted code\n   * getting executed.\n   *\n   * @param string $name\n   *   The virtual file name. Can be a relative path.\n   * @param string $directory\n   *   (optional) The directory containing the file. If not passed, this is\n   *   retrieved by calling getContainingDirectoryFullPath().\n   * @param int $directory_mtime\n   *   (optional) The mtime of $directory. Can be passed to avoid an extra\n   *   filesystem call when the mtime of the directory is already known.\n   *\n   * @return string\n   *   The full path where the file is or should be stored.\n   *\/",104],["T_WHITESPACE","\n  ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","getFullPath",126],"(",["T_VARIABLE","$name",126],",",["T_WHITESPACE"," ",126],"&",["T_VARIABLE","$directory",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","NULL",126],",",["T_WHITESPACE"," ",126],"&",["T_VARIABLE","$directory_mtime",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","NULL",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n    ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(","!",["T_ISSET","isset",127],"(",["T_VARIABLE","$directory",127],")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n      ",127],["T_VARIABLE","$directory",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getContainingDirectoryFullPath",128],"(",["T_VARIABLE","$name",128],")",";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n    ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(","!",["T_ISSET","isset",130],"(",["T_VARIABLE","$directory_mtime",130],")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n      ",130],["T_VARIABLE","$directory_mtime",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","file_exists",131],"(",["T_VARIABLE","$directory",131],")",["T_WHITESPACE"," ",131],"?",["T_WHITESPACE"," ",131],["T_STRING","filemtime",131],"(",["T_VARIABLE","$directory",131],")",["T_WHITESPACE"," ",131],":",["T_WHITESPACE"," ",131],["T_LNUMBER","0",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n    ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$directory",133],["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'\/'",133],["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_STRING","hash_hmac",133],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$name",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","secret",133],["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_VARIABLE","$directory_mtime",133],")",["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'.php'",133],";",["T_WHITESPACE","\n  ",133],"}",["T_WHITESPACE","\n\n  ",134],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",136],["T_WHITESPACE","\n  ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","delete",139],"(",["T_VARIABLE","$name",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$path",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getContainingDirectoryFullPath",140],"(",["T_VARIABLE","$name",140],")",";",["T_WHITESPACE","\n    ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_STRING","file_exists",141],"(",["T_VARIABLE","$path",141],")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n      ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","unlink",142],"(",["T_VARIABLE","$path",142],")",";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n    ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_STRING","FALSE",144],";",["T_WHITESPACE","\n  ",144],"}",["T_WHITESPACE","\n\n  ",145],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",147],["T_WHITESPACE","\n  ",149],["T_PUBLIC","public",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","garbageCollection",150],"(",")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n    ",150],["T_VARIABLE","$flags",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_NS_SEPARATOR","\\",151],["T_STRING","FilesystemIterator",151],["T_DOUBLE_COLON","::",151],["T_STRING","CURRENT_AS_FILEINFO",151],";",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$flags",152],["T_WHITESPACE"," ",152],["T_PLUS_EQUAL","+=",152],["T_WHITESPACE"," ",152],["T_NS_SEPARATOR","\\",152],["T_STRING","FilesystemIterator",152],["T_DOUBLE_COLON","::",152],["T_STRING","SKIP_DOTS",152],";",["T_WHITESPACE","\n\n    ",152],["T_FOREACH","foreach",154],["T_WHITESPACE"," ",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","listAll",154],"(",")",["T_WHITESPACE"," ",154],["T_AS","as",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$name",154],")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n      ",154],["T_VARIABLE","$directory",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getContainingDirectoryFullPath",155],"(",["T_VARIABLE","$name",155],")",";",["T_WHITESPACE","\n      ",155],["T_TRY","try",156],["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$dir_iterator",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_NEW","new",157],["T_WHITESPACE"," ",157],["T_NS_SEPARATOR","\\",157],["T_STRING","FilesystemIterator",157],"(",["T_VARIABLE","$directory",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$flags",157],")",";",["T_WHITESPACE","\n      ",157],"}",["T_WHITESPACE","\n      ",158],["T_CATCH","catch",159],["T_WHITESPACE"," ",159],"(",["T_NS_SEPARATOR","\\",159],["T_STRING","UnexpectedValueException",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$e",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n        ",159],["T_COMMENT","\/\/ FilesystemIterator throws an UnexpectedValueException if the\n",160],["T_WHITESPACE","        ",161],["T_COMMENT","\/\/ specified path is not a directory, or if it is not accessible.\n",161],["T_WHITESPACE","        ",162],["T_CONTINUE","continue",162],";",["T_WHITESPACE","\n      ",162],"}",["T_WHITESPACE","\n\n      ",163],["T_VARIABLE","$directory_unlink",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","TRUE",165],";",["T_WHITESPACE","\n      ",165],["T_VARIABLE","$directory_mtime",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","filemtime",166],"(",["T_VARIABLE","$directory",166],")",";",["T_WHITESPACE","\n      ",166],["T_FOREACH","foreach",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$dir_iterator",167],["T_WHITESPACE"," ",167],["T_AS","as",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$fileinfo",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n        ",167],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$directory_mtime",168],["T_WHITESPACE"," ",168],">",["T_WHITESPACE"," ",168],["T_VARIABLE","$fileinfo",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getMTime",168],"(",")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n          ",168],["T_COMMENT","\/\/ Ensure the folder is writable.\n",169],["T_WHITESPACE","          ",170],"@",["T_STRING","chmod",170],"(",["T_VARIABLE","$directory",170],",",["T_WHITESPACE"," ",170],["T_LNUMBER","0777",170],")",";",["T_WHITESPACE","\n          ",170],"@",["T_STRING","unlink",171],"(",["T_VARIABLE","$fileinfo",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getPathName",171],"(",")",")",";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n        ",172],["T_ELSE","else",173],["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n          ",173],["T_COMMENT","\/\/ The directory still contains valid files.\n",174],["T_WHITESPACE","          ",175],["T_VARIABLE","$directory_unlink",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","FALSE",175],";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n      ",176],"}",["T_WHITESPACE","\n\n      ",177],["T_IF","if",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$directory_unlink",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","unlink",180],"(",["T_VARIABLE","$name",180],")",";",["T_WHITESPACE","\n      ",180],"}",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n  ",182],"}",["T_WHITESPACE","\n\n  ",183],["T_DOC_COMMENT","\/**\n   * Gets the full path of the containing directory where the file is or should\n   * be stored.\n   *\n   * @param string $name\n   *   The virtual file name. Can be a relative path.\n   *\n   * @return string\n   *   The full path of the containing directory where the file is or should be\n   *   stored.\n   *\/",185],["T_WHITESPACE","\n  ",195],["T_PROTECTED","protected",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","getContainingDirectoryFullPath",196],"(",["T_VARIABLE","$name",196],")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n    ",196],["T_COMMENT","\/\/ Remove the .php file extension from the directory name.\n",197],["T_WHITESPACE","    ",198],["T_COMMENT","\/\/ Within a single directory, a subdirectory cannot have the same name as a\n",198],["T_WHITESPACE","    ",199],["T_COMMENT","\/\/ file. Thus, when switching between MTimeProtectedFastFileStorage and\n",199],["T_WHITESPACE","    ",200],["T_COMMENT","\/\/ FileStorage, the subdirectory or the file cannot be created in case the\n",200],["T_WHITESPACE","    ",201],["T_COMMENT","\/\/ other file type exists already.\n",201],["T_WHITESPACE","    ",202],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_STRING","substr",202],"(",["T_VARIABLE","$name",202],",",["T_WHITESPACE"," ",202],"-",["T_LNUMBER","4",202],")",["T_WHITESPACE"," ",202],["T_IS_IDENTICAL","===",202],["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'.php'",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n      ",202],["T_VARIABLE","$name",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","substr",203],"(",["T_VARIABLE","$name",203],",",["T_WHITESPACE"," ",203],["T_LNUMBER","0",203],",",["T_WHITESPACE"," ",203],"-",["T_LNUMBER","4",203],")",";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n    ",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","directory",205],["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'\/'",205],["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_STRING","str_replace",205],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",205],",",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'#'",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$name",205],")",";",["T_WHITESPACE","\n  ",205],"}",["T_WHITESPACE","\n\n  ",206],["T_DOC_COMMENT","\/**\n   * Clears PHP's stat cache and returns the directory's mtime.\n   *\/",208],["T_WHITESPACE","\n  ",210],["T_PROTECTED","protected",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","getUncachedMTime",211],"(",["T_VARIABLE","$directory",211],")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n    ",211],["T_STRING","clearstatcache",212],"(",["T_STRING","TRUE",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$directory",212],")",";",["T_WHITESPACE","\n    ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_STRING","filemtime",213],"(",["T_VARIABLE","$directory",213],")",";",["T_WHITESPACE","\n  ",213],"}",["T_WHITESPACE","\n\n  ",214],["T_DOC_COMMENT","\/**\n   * A brute force tempnam implementation supporting streams.\n   *\n   * @param $directory\n   *   The directory where the temporary filename will be created.\n   * @param $prefix\n   *   The prefix of the generated temporary filename.\n   * @return string\n   *   Returns the new temporary filename (with path), or FALSE on failure.\n   *\/",216],["T_WHITESPACE","\n  ",225],["T_PROTECTED","protected",226],["T_WHITESPACE"," ",226],["T_FUNCTION","function",226],["T_WHITESPACE"," ",226],["T_STRING","tempnam",226],"(",["T_VARIABLE","$directory",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$prefix",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n    ",226],["T_DO","do",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n      ",227],["T_VARIABLE","$path",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$directory",228],["T_WHITESPACE"," ",228],".",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'\/'",228],["T_WHITESPACE"," ",228],".",["T_WHITESPACE"," ",228],["T_VARIABLE","$prefix",228],["T_WHITESPACE"," ",228],".",["T_WHITESPACE"," ",228],["T_STRING","substr",228],"(",["T_STRING","str_shuffle",228],"(",["T_STRING","hash",228],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",228],",",["T_WHITESPACE"," ",228],["T_STRING","microtime",228],"(",")",")",")",",",["T_WHITESPACE"," ",228],["T_LNUMBER","0",228],",",["T_WHITESPACE"," ",228],["T_LNUMBER","10",228],")",";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE"," ",229],["T_WHILE","while",229],["T_WHITESPACE"," ",229],"(",["T_STRING","file_exists",229],"(",["T_VARIABLE","$path",229],")",")",";",["T_WHITESPACE","\n    ",229],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$path",230],";",["T_WHITESPACE","\n  ",230],"}",["T_WHITESPACE","\n\n",231],"}",["T_WHITESPACE","\n",233]]