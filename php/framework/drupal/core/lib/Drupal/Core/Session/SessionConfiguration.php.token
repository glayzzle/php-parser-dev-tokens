[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Session",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Symfony",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","HttpFoundation",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Request",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Defines the default session configuration generator.\n *\/",7],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","SessionConfiguration",10],["T_WHITESPACE"," ",10],["T_IMPLEMENTS","implements",10],["T_WHITESPACE"," ",10],["T_STRING","SessionConfigurationInterface",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * An associative array of session ini settings.\n   *\/",12],["T_WHITESPACE","\n  ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$options",15],";",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Constructs a new session configuration instance.\n   *\n   * @param array $options\n   *   An associative array of session ini settings.\n   *\n   * @see \\Symfony\\Component\\HttpFoundation\\Session\\Storage\\NativeSessionStorage::__construct()\n   * @see http:\/\/php.net\/manual\/session.configuration.php\n   *\/",17],["T_WHITESPACE","\n  ",25],["T_PUBLIC","public",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","__construct",26],"(",["T_VARIABLE","$options",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],"[","]",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","options",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$options",27],";",["T_WHITESPACE","\n  ",27],"}",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",30],["T_WHITESPACE","\n  ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","hasSession",33],"(",["T_STRING","Request",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$request",33],")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_RETURN","return",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$request",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","cookies",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","has",34],"(",["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getName",34],"(",["T_VARIABLE","$request",34],")",")",";",["T_WHITESPACE","\n  ",34],"}",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",37],["T_WHITESPACE","\n  ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","getOptions",40],"(",["T_STRING","Request",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$request",40],")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$options",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","options",41],";",["T_WHITESPACE","\n\n    ",41],["T_COMMENT","\/\/ Generate \/ validate the cookie domain.\n",43],["T_WHITESPACE","    ",44],["T_VARIABLE","$options",44],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getCookieDomain",44],"(",["T_VARIABLE","$request",44],")",["T_WHITESPACE"," ",44],"?",":",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","''",44],";",["T_WHITESPACE","\n\n    ",44],["T_COMMENT","\/\/ If the site is accessed via SSL, ensure that the session cookie is\n",46],["T_WHITESPACE","    ",47],["T_COMMENT","\/\/ issued with the secure flag.\n",47],["T_WHITESPACE","    ",48],["T_VARIABLE","$options",48],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_secure'",48],"]",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$request",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","isSecure",48],"(",")",";",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/\/ Set the session cookie name.\n",50],["T_WHITESPACE","    ",51],["T_VARIABLE","$options",51],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",51],"]",["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getName",51],"(",["T_VARIABLE","$request",51],")",";",["T_WHITESPACE","\n\n    ",51],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$options",53],";",["T_WHITESPACE","\n  ",53],"}",["T_WHITESPACE","\n\n  ",54],["T_DOC_COMMENT","\/**\n   * Returns the session cookie name.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The request.\n   *\n   * @return string\n   *   The name of the session cookie.\n   *\/",56],["T_WHITESPACE","\n  ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getName",65],"(",["T_STRING","Request",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$request",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n    ",65],["T_COMMENT","\/\/ To prevent session cookies from being hijacked, a user can configure the\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ SSL version of their website to only transfer session cookies via SSL by\n",67],["T_WHITESPACE","    ",68],["T_COMMENT","\/\/ using PHP's session.cookie_secure setting. The browser will then use two\n",68],["T_WHITESPACE","    ",69],["T_COMMENT","\/\/ separate session cookies for the HTTPS and HTTP versions of the site. So\n",69],["T_WHITESPACE","    ",70],["T_COMMENT","\/\/ we must use different session identifiers for HTTPS and HTTP to prevent a\n",70],["T_WHITESPACE","    ",71],["T_COMMENT","\/\/ cookie collision.\n",71],["T_WHITESPACE","    ",72],["T_VARIABLE","$prefix",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$request",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","isSecure",72],"(",")",["T_WHITESPACE"," ",72],"?",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'SSESS'",72],["T_WHITESPACE"," ",72],":",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'SESS'",72],";",["T_WHITESPACE","\n    ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$prefix",73],["T_WHITESPACE"," ",73],".",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getUnprefixedName",73],"(",["T_VARIABLE","$request",73],")",";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * Returns the session cookie name without the secure\/insecure prefix.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The request.\n   *\n   * @returns string\n   *   The session name without the prefix (SESS\/SSESS).\n   *\/",76],["T_WHITESPACE","\n  ",84],["T_PROTECTED","protected",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","getUnprefixedName",85],"(",["T_STRING","Request",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$request",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n    ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$test_prefix",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","drupalValidTestUa",86],"(",")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n      ",86],["T_VARIABLE","$session_name",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$test_prefix",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n    ",88],["T_ELSEIF","elseif",89],["T_WHITESPACE"," ",89],"(",["T_ISSET","isset",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","options",89],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",89],"]",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n      ",89],["T_COMMENT","\/\/ If the user specifies the cookie domain, also use it for session name.\n",90],["T_WHITESPACE","      ",91],["T_VARIABLE","$session_name",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","options",91],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",91],"]",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n    ",92],["T_ELSE","else",93],["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n      ",93],["T_COMMENT","\/\/ Otherwise use $base_url as session name, without the protocol\n",94],["T_WHITESPACE","      ",95],["T_COMMENT","\/\/ to use the same session identifiers across HTTP and HTTPS.\n",95],["T_WHITESPACE","      ",96],["T_VARIABLE","$session_name",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$request",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getHost",96],"(",")",["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_VARIABLE","$request",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getBasePath",96],"(",")",";",["T_WHITESPACE","\n      ",96],["T_COMMENT","\/\/ Replace \"core\" out of session_name so core scripts redirect properly,\n",97],["T_WHITESPACE","      ",98],["T_COMMENT","\/\/ specifically install.php.\n",98],["T_WHITESPACE","      ",99],["T_VARIABLE","$session_name",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","preg_replace",99],"(",["T_CONSTANT_ENCAPSED_STRING","'#\/core$#'",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","''",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$session_name",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_STRING","substr",102],"(",["T_STRING","hash",102],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$session_name",102],")",",",["T_WHITESPACE"," ",102],["T_LNUMBER","0",102],",",["T_WHITESPACE"," ",102],["T_LNUMBER","32",102],")",";",["T_WHITESPACE","\n  ",102],"}",["T_WHITESPACE","\n\n  ",103],["T_DOC_COMMENT","\/**\n   * Return the session cookie domain.\n   *\n   * The Set-Cookie response header and its domain attribute are defined in RFC\n   * 2109, RFC 2965 and RFC 6265 each one superseeding the previous version.\n   *\n   * @see http:\/\/tools.ietf.org\/html\/rfc2109\n   * @see http:\/\/tools.ietf.org\/html\/rfc2965\n   * @see http:\/\/tools.ietf.org\/html\/rfc6265\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The request.\n   *\n   * @returns string\n   *   The session cookie domain.\n   *\/",105],["T_WHITESPACE","\n  ",120],["T_PROTECTED","protected",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","getCookieDomain",121],"(",["T_STRING","Request",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$request",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n    ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_ISSET","isset",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","options",122],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",122],"]",")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n      ",122],["T_VARIABLE","$cookie_domain",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","options",123],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",123],"]",";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n    ",124],["T_ELSE","else",125],["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n      ",125],["T_VARIABLE","$host",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$request",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getHost",126],"(",")",";",["T_WHITESPACE","\n      ",126],["T_COMMENT","\/\/ To maximize compatibility and normalize the behavior across user\n",127],["T_WHITESPACE","      ",128],["T_COMMENT","\/\/ agents, the cookie domain should start with a dot.\n",128],["T_WHITESPACE","      ",129],["T_VARIABLE","$cookie_domain",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'.'",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_VARIABLE","$host",129],";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_COMMENT","\/\/ Cookies for domains without an embedded dot will be rejected by user\n",132],["T_WHITESPACE","    ",133],["T_COMMENT","\/\/ agents in order to defeat malicious websites attempting to set cookies\n",133],["T_WHITESPACE","    ",134],["T_COMMENT","\/\/ for top-level domains. Also IP addresses may not be used in the domain\n",134],["T_WHITESPACE","    ",135],["T_COMMENT","\/\/ attribute of a Set-Cookie header.\n",135],["T_WHITESPACE","    ",136],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_STRING","count",136],"(",["T_STRING","explode",136],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$cookie_domain",136],")",")",["T_WHITESPACE"," ",136],">",["T_WHITESPACE"," ",136],["T_LNUMBER","2",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],"!",["T_STRING","is_numeric",136],"(",["T_STRING","str_replace",136],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","''",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$cookie_domain",136],")",")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n      ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$cookie_domain",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n  ",138],"}",["T_WHITESPACE","\n\n  ",139],["T_DOC_COMMENT","\/**\n   * Wraps drupal_valid_test_ua().\n   *\n   * @return string|false\n   *   Either the simpletest prefix (the string \"simpletest\" followed by any\n   *   number of digits) or FALSE if the user agent does not contain a valid\n   *   HMAC and timestamp.\n   *\/",141],["T_WHITESPACE","\n  ",148],["T_PROTECTED","protected",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","drupalValidTestUa",149],"(",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n    ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_STRING","drupal_valid_test_ua",150],"(",")",";",["T_WHITESPACE","\n  ",150],"}",["T_WHITESPACE","\n\n",151],"}",["T_WHITESPACE","\n",153]]