[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Authentication",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Routing",5],["T_NS_SEPARATOR","\\",5],["T_STRING","RouteMatch",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Symfony",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","HttpFoundation",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Request",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Manager for authentication.\n *\n * On each request, let all authentication providers try to authenticate the\n * user. The providers are iterated according to their priority and the first\n * provider detecting credentials for its method wins. No further provider will\n * get triggered.\n *\n * If no provider set an active user then the user is set to anonymous.\n *\/",8],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","AuthenticationManager",18],["T_WHITESPACE"," ",18],["T_IMPLEMENTS","implements",18],["T_WHITESPACE"," ",18],["T_STRING","AuthenticationProviderInterface",18],",",["T_WHITESPACE"," ",18],["T_STRING","AuthenticationProviderFilterInterface",18],",",["T_WHITESPACE"," ",18],["T_STRING","AuthenticationProviderChallengeInterface",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * The authentication provider collector.\n   *\n   * @var \\Drupal\\Core\\Authentication\\AuthenticationCollectorInterface\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$authCollector",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * Creates a new authentication manager instance.\n   *\n   * @param \\Drupal\\Core\\Authentication\\AuthenticationCollectorInterface $auth_collector\n   *   The authentication provider collector.\n   *\/",27],["T_WHITESPACE","\n  ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","__construct",33],"(",["T_STRING","AuthenticationCollectorInterface",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$auth_collector",33],")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","authCollector",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$auth_collector",34],";",["T_WHITESPACE","\n  ",34],"}",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",37],["T_WHITESPACE","\n  ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","applies",40],"(",["T_STRING","Request",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$request",40],")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n    ",40],["T_RETURN","return",41],["T_WHITESPACE"," ",41],["T_BOOL_CAST","(bool)",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","getProvider",41],"(",["T_VARIABLE","$request",41],")",";",["T_WHITESPACE","\n  ",41],"}",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",44],["T_WHITESPACE","\n  ",46],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","authenticate",47],"(",["T_STRING","Request",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$request",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$provider_id",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getProvider",48],"(",["T_VARIABLE","$request",48],")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$provider",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","authCollector",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getProvider",49],"(",["T_VARIABLE","$provider_id",49],")",";",["T_WHITESPACE","\n\n    ",49],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_VARIABLE","$provider",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n      ",51],["T_RETURN","return",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$provider",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","authenticate",52],"(",["T_VARIABLE","$request",52],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_STRING","NULL",55],";",["T_WHITESPACE","\n  ",55],"}",["T_WHITESPACE","\n\n  ",56],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",58],["T_WHITESPACE","\n  ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","appliesToRoutedRequest",61],"(",["T_STRING","Request",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$request",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$authenticated",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$result",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","FALSE",62],";",["T_WHITESPACE","\n\n    ",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$authenticated",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n      ",64],["T_VARIABLE","$result",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","applyFilter",65],"(",["T_VARIABLE","$request",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$authenticated",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getProvider",65],"(",["T_VARIABLE","$request",65],")",")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n    ",66],["T_ELSE","else",67],["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n      ",67],["T_FOREACH","foreach",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","authCollector",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getSortedProviders",68],"(",")",["T_WHITESPACE"," ",68],["T_AS","as",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$provider_id",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$provider",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n        ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","applyFilter",69],"(",["T_VARIABLE","$request",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$authenticated",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$provider_id",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n          ",69],["T_VARIABLE","$result",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","TRUE",70],";",["T_WHITESPACE","\n          ",70],["T_BREAK","break",71],";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n      ",72],"}",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$result",76],";",["T_WHITESPACE","\n  ",76],"}",["T_WHITESPACE","\n\n  ",77],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",79],["T_WHITESPACE","\n  ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","challengeException",82],"(",["T_STRING","Request",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$request",82],",",["T_WHITESPACE"," ",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Exception",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$previous",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$provider_id",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getChallenger",83],"(",["T_VARIABLE","$request",83],")",";",["T_WHITESPACE","\n\n    ",83],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$provider_id",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n      ",85],["T_VARIABLE","$provider",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","authCollector",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getProvider",86],"(",["T_VARIABLE","$provider_id",86],")",";",["T_WHITESPACE","\n      ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$provider",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","challengeException",87],"(",["T_VARIABLE","$request",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$previous",87],")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n  ",88],"}",["T_WHITESPACE","\n\n  ",89],["T_DOC_COMMENT","\/**\n   * Returns the id of the authentication provider for a request.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The incoming request.\n   *\n   * @return string|null\n   *   The id of the first authentication provider which applies to the request.\n   *   If no application detects appropriate credentials, then NULL is returned.\n   *\/",91],["T_WHITESPACE","\n  ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","getProvider",101],"(",["T_STRING","Request",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$request",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n    ",101],["T_FOREACH","foreach",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","authCollector",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getSortedProviders",102],"(",")",["T_WHITESPACE"," ",102],["T_AS","as",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$provider_id",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$provider",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n      ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$provider",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","applies",103],"(",["T_VARIABLE","$request",103],")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$provider_id",104],";",["T_WHITESPACE","\n      ",104],"}",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n  ",106],"}",["T_WHITESPACE","\n\n  ",107],["T_DOC_COMMENT","\/**\n   * Returns the ID of the challenge provider for a request.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The incoming request.\n   *\n   * @return string|null\n   *   The ID of the first authentication provider which applies to the request.\n   *   If no application detects appropriate credentials, then NULL is returned.\n   *\/",109],["T_WHITESPACE","\n  ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","getChallenger",119],"(",["T_STRING","Request",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$request",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n    ",119],["T_FOREACH","foreach",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","authCollector",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getSortedProviders",120],"(",")",["T_WHITESPACE"," ",120],["T_AS","as",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$provider_id",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$provider",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n      ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","(",["T_VARIABLE","$provider",121],["T_WHITESPACE"," ",121],["T_INSTANCEOF","instanceof",121],["T_WHITESPACE"," ",121],["T_STRING","AuthenticationProviderChallengeInterface",121],")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],"!",["T_VARIABLE","$provider",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","applies",121],"(",["T_VARIABLE","$request",121],")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","applyFilter",121],"(",["T_VARIABLE","$request",121],",",["T_WHITESPACE"," ",121],["T_STRING","FALSE",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$provider_id",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n        ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$provider_id",122],";",["T_WHITESPACE","\n      ",122],"}",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n  ",124],"}",["T_WHITESPACE","\n\n  ",125],["T_DOC_COMMENT","\/**\n   * Checks whether a provider is allowed on the given request.\n   *\n   * If no filter is registered for the given provider id, the default filter\n   * is applied.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The incoming request.\n   * @param bool $authenticated\n   *   Whether or not the request is authenticated.\n   * @param string $provider_id\n   *   The id of the authentication provider to check access for.\n   *\n   * @return bool\n   *   TRUE if provider is allowed, FALSE otherwise.\n   *\/",127],["T_WHITESPACE","\n  ",142],["T_PROTECTED","protected",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","applyFilter",143],"(",["T_STRING","Request",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$request",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$authenticated",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$provider_id",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n    ",143],["T_VARIABLE","$provider",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","authCollector",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getProvider",144],"(",["T_VARIABLE","$provider_id",144],")",";",["T_WHITESPACE","\n\n    ",144],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$provider",146],["T_WHITESPACE"," ",146],["T_BOOLEAN_AND","&&",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$provider",146],["T_WHITESPACE"," ",146],["T_INSTANCEOF","instanceof",146],["T_WHITESPACE"," ",146],["T_STRING","AuthenticationProviderFilterInterface",146],")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n      ",146],["T_VARIABLE","$result",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$provider",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","appliesToRoutedRequest",147],"(",["T_VARIABLE","$request",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$authenticated",147],")",";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n    ",148],["T_ELSE","else",149],["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n      ",149],["T_VARIABLE","$result",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","defaultFilter",150],"(",["T_VARIABLE","$request",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$provider_id",150],")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$result",153],";",["T_WHITESPACE","\n  ",153],"}",["T_WHITESPACE","\n\n  ",154],["T_DOC_COMMENT","\/**\n   * Default implementation of the provider filter.\n   *\n   * Checks whether a provider is allowed as per the _auth option on a route. If\n   * the option is not set or if the request did not match any route, only\n   * providers from the global provider set are allowed.\n   *\n   * If no filter is registered for the given provider id, the default filter\n   * is applied.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The incoming request.\n   * @param string $provider_id\n   *   The id of the authentication provider to check access for.\n   *\n   * @return bool\n   *   TRUE if provider is allowed, FALSE otherwise.\n   *\/",156],["T_WHITESPACE","\n  ",173],["T_PROTECTED","protected",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","defaultFilter",174],"(",["T_STRING","Request",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$request",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$provider_id",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$route",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","RouteMatch",175],["T_DOUBLE_COLON","::",175],["T_STRING","createFromRequest",175],"(",["T_VARIABLE","$request",175],")",["T_OBJECT_OPERATOR","->",175],["T_STRING","getRouteObject",175],"(",")",";",["T_WHITESPACE","\n    ",175],["T_VARIABLE","$has_auth_option",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_ISSET","isset",176],"(",["T_VARIABLE","$route",176],")",["T_WHITESPACE"," ",176],["T_BOOLEAN_AND","&&",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$route",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","hasOption",176],"(",["T_CONSTANT_ENCAPSED_STRING","'_auth'",176],")",";",["T_WHITESPACE","\n\n    ",176],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$has_auth_option",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n      ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_STRING","in_array",179],"(",["T_VARIABLE","$provider_id",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$route",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getOption",179],"(",["T_CONSTANT_ENCAPSED_STRING","'_auth'",179],")",")",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n    ",180],["T_ELSE","else",181],["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n      ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","authCollector",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","isGlobal",182],"(",["T_VARIABLE","$provider_id",182],")",";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n  ",183],"}",["T_WHITESPACE","\n\n",184],"}",["T_WHITESPACE","\n",186]]