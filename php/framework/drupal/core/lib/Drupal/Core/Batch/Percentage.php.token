[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Batch",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Helper methods for the batch system.\n *\/",5],["T_WHITESPACE","\n",7],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","Percentage",8],["T_WHITESPACE"," ",8],"{",["T_WHITESPACE","\n\n  ",8],["T_DOC_COMMENT","\/**\n   * Formats the percent completion for a batch set.\n   *\n   * @param int $total\n   *   The total number of operations.\n   * @param int $current\n   *   The number of the current operation. This may be a floating point number\n   *   rather than an integer in the case of a multi-step operation that is not\n   *   yet complete; in that case, the fractional part of $current represents the\n   *   fraction of the operation that has been completed.\n   *\n   * @return string\n   *   The properly formatted percentage, as a string. We output percentages\n   *   using the correct number of decimal places so that we never print \"100%\"\n   *   until we are finished, but we also never print more decimal places than\n   *   are meaningful.\n   *\n   * @see _batch_process()\n   *\/",10],["T_WHITESPACE","\n  ",28],["T_PUBLIC","public",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","format",29],"(",["T_VARIABLE","$total",29],",",["T_WHITESPACE"," ",29],["T_VARIABLE","$current",29],")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n    ",29],["T_IF","if",30],["T_WHITESPACE"," ",30],"(","!",["T_VARIABLE","$total",30],["T_WHITESPACE"," ",30],["T_BOOLEAN_OR","||",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$total",30],["T_WHITESPACE"," ",30],["T_IS_EQUAL","==",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$current",30],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n      ",30],["T_COMMENT","\/\/ If $total doesn't evaluate as true or is equal to the current set, then\n",31],["T_WHITESPACE","      ",32],["T_COMMENT","\/\/ we're finished, and we can return \"100\".\n",32],["T_WHITESPACE","      ",33],["T_VARIABLE","$percentage",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'100'",33],";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n    ",34],["T_ELSE","else",35],["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n      ",35],["T_COMMENT","\/\/ We add a new digit at 200, 2000, etc. (since, for example, 199\/200\n",36],["T_WHITESPACE","      ",37],["T_COMMENT","\/\/ would round up to 100% if we didn't).\n",37],["T_WHITESPACE","      ",38],["T_VARIABLE","$decimal_places",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","max",38],"(",["T_LNUMBER","0",38],",",["T_WHITESPACE"," ",38],["T_STRING","floor",38],"(",["T_STRING","log10",38],"(",["T_VARIABLE","$total",38],["T_WHITESPACE"," ",38],"\/",["T_WHITESPACE"," ",38],["T_DNUMBER","2.0",38],")",")",["T_WHITESPACE"," ",38],"-",["T_WHITESPACE"," ",38],["T_LNUMBER","1",38],")",";",["T_WHITESPACE","\n      ",38],["T_DO","do",39],["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n        ",39],["T_COMMENT","\/\/ Calculate the percentage to the specified number of decimal places.\n",40],["T_WHITESPACE","        ",41],["T_VARIABLE","$percentage",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","sprintf",41],"(",["T_CONSTANT_ENCAPSED_STRING","'%01.'",41],["T_WHITESPACE"," ",41],".",["T_WHITESPACE"," ",41],["T_VARIABLE","$decimal_places",41],["T_WHITESPACE"," ",41],".",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'f'",41],",",["T_WHITESPACE"," ",41],["T_STRING","round",41],"(",["T_VARIABLE","$current",41],["T_WHITESPACE"," ",41],"\/",["T_WHITESPACE"," ",41],["T_VARIABLE","$total",41],["T_WHITESPACE"," ",41],"*",["T_WHITESPACE"," ",41],["T_LNUMBER","100",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$decimal_places",41],")",")",";",["T_WHITESPACE","\n        ",41],["T_COMMENT","\/\/ When $current is an integer, the above calculation will always be\n",42],["T_WHITESPACE","        ",43],["T_COMMENT","\/\/ correct. However, if $current is a floating point number (in the case\n",43],["T_WHITESPACE","        ",44],["T_COMMENT","\/\/ of a multi-step batch operation that is not yet complete), $percentage\n",44],["T_WHITESPACE","        ",45],["T_COMMENT","\/\/ may be erroneously rounded up to 100%. To prevent that, we add one\n",45],["T_WHITESPACE","        ",46],["T_COMMENT","\/\/ more decimal place and try again.\n",46],["T_WHITESPACE","        ",47],["T_VARIABLE","$decimal_places",47],["T_INC","++",47],";",["T_WHITESPACE","\n      ",47],"}",["T_WHITESPACE"," ",48],["T_WHILE","while",48],["T_WHITESPACE"," ",48],"(",["T_VARIABLE","$percentage",48],["T_WHITESPACE"," ",48],["T_IS_EQUAL","==",48],["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'100'",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n    ",49],["T_RETURN","return",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$percentage",50],";",["T_WHITESPACE","\n  ",50],"}",["T_WHITESPACE","\n\n",51],"}",["T_WHITESPACE","\n",53]]