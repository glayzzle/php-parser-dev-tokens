[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","ImageToolkit",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],["T_NS_SEPARATOR","\\",5],["T_STRING","CacheBackendInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Extension",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ModuleHandlerInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Plugin",7],["T_NS_SEPARATOR","\\",7],["T_STRING","DefaultPluginManager",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Component",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Exception",8],["T_NS_SEPARATOR","\\",8],["T_STRING","PluginNotFoundException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Component",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Plugin",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Factory",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DefaultFactory",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Component",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Utility",10],["T_NS_SEPARATOR","\\",10],["T_STRING","SafeMarkup",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Psr",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Log",11],["T_NS_SEPARATOR","\\",11],["T_STRING","LoggerInterface",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Manages toolkit operation plugins.\n *\n * @see \\Drupal\\Core\\ImageToolkit\\Annotation\\ImageToolkitOperation\n * @see \\Drupal\\Core\\ImageToolkit\\ImageToolkitOperationBase\n * @see \\Drupal\\Core\\ImageToolkit\\ImageToolkitOperationInterface\n * @see plugin_api\n *\/",13],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","ImageToolkitOperationManager",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","DefaultPluginManager",21],["T_WHITESPACE"," ",21],["T_IMPLEMENTS","implements",21],["T_WHITESPACE"," ",21],["T_STRING","ImageToolkitOperationManagerInterface",21],["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * A logger instance.\n   *\n   * @var \\Psr\\Log\\LoggerInterface\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$logger",28],";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * The image toolkit manager.\n   *\n   * @var \\Drupal\\Core\\ImageToolkit\\ImageToolkitManager\n   *\/",30],["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$toolkitManager",35],";",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * Constructs the ImageToolkitOperationManager object.\n   *\n   * @param \\Traversable $namespaces\n   *   An object that implements \\Traversable which contains the root paths\n   *   keyed by the corresponding namespace to look for plugin implementations.\n   * @param \\Drupal\\Core\\Cache\\CacheBackendInterface $cache_backend\n   *   Cache backend instance to use.\n   * @param \\Drupal\\Core\\Extension\\ModuleHandlerInterface $module_handler\n   *   The module handler to invoke the alter hook with.\n   * @param \\Psr\\Log\\LoggerInterface $logger\n   *   A logger instance.\n   * @param \\Drupal\\Core\\ImageToolkit\\ImageToolkitManager $toolkit_manager\n   *   The image toolkit manager.\n   *\/",37],["T_WHITESPACE","\n  ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","__construct",52],"(",["T_NS_SEPARATOR","\\",52],["T_STRING","Traversable",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$namespaces",52],",",["T_WHITESPACE"," ",52],["T_STRING","CacheBackendInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$cache_backend",52],",",["T_WHITESPACE"," ",52],["T_STRING","ModuleHandlerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$module_handler",52],",",["T_WHITESPACE"," ",52],["T_STRING","LoggerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$logger",52],",",["T_WHITESPACE"," ",52],["T_STRING","ImageToolkitManager",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$toolkit_manager",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n    ",52],["T_STRING","parent",53],["T_DOUBLE_COLON","::",53],["T_STRING","__construct",53],"(",["T_CONSTANT_ENCAPSED_STRING","'Plugin\/ImageToolkit\/Operation'",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$namespaces",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$module_handler",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\ImageToolkit\\ImageToolkitOperationInterface'",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\ImageToolkit\\Annotation\\ImageToolkitOperation'",53],")",";",["T_WHITESPACE","\n\n    ",53],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","alterInfo",55],"(",["T_CONSTANT_ENCAPSED_STRING","'image_toolkit_operation'",55],")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","setCacheBackend",56],"(",["T_VARIABLE","$cache_backend",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'image_toolkit_operation_plugins'",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","logger",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$logger",57],";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","toolkitManager",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$toolkit_manager",58],";",["T_WHITESPACE","\n  ",58],"}",["T_WHITESPACE","\n\n  ",59],["T_DOC_COMMENT","\/**\n   * Returns the plugin ID for a given toolkit and operation.\n   *\n   * @param \\Drupal\\Core\\ImageToolkit\\ImageToolkitInterface $toolkit\n   *   The toolkit instance.\n   * @param string $operation\n   *   The operation (e.g. \"crop\").\n   *\n   * @return string\n   *   The plugin ID.\n   *\n   * @throws \\Drupal\\Component\\Plugin\\Exception\\PluginNotFoundException\n   *   When no plugin is available.\n   *\/",61],["T_WHITESPACE","\n  ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","getToolkitOperationPluginId",75],"(",["T_STRING","ImageToolkitInterface",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$toolkit",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$operation",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$toolkit_id",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$toolkit",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getPluginId",76],"(",")",";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$definitions",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getDefinitions",77],"(",")",";",["T_WHITESPACE","\n\n    ",77],["T_VARIABLE","$definitions",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","array_filter",79],"(",["T_VARIABLE","$definitions",79],",",["T_WHITESPACE","\n      ",79],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$definition",80],")",["T_WHITESPACE"," ",80],["T_USE","use",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$toolkit_id",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$operation",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$definition",81],"[",["T_CONSTANT_ENCAPSED_STRING","'toolkit'",81],"]",["T_WHITESPACE"," ",81],["T_IS_EQUAL","==",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$toolkit_id",81],["T_WHITESPACE"," ",81],["T_BOOLEAN_AND","&&",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$definition",81],"[",["T_CONSTANT_ENCAPSED_STRING","'operation'",81],"]",["T_WHITESPACE"," ",81],["T_IS_EQUAL","==",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$operation",81],";",["T_WHITESPACE","\n      ",81],"}",["T_WHITESPACE","\n    ",82],")",";",["T_WHITESPACE","\n\n    ",83],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_VARIABLE","$definitions",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n      ",85],["T_COMMENT","\/\/ If this image toolkit plugin is a derivative and returns no operation,\n",86],["T_WHITESPACE","      ",87],["T_COMMENT","\/\/ try once again with its base plugin.\n",87],["T_WHITESPACE","      ",88],["T_VARIABLE","$base_toolkit_id",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$toolkit",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getBaseId",88],"(",")",";",["T_WHITESPACE","\n      ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(","(",["T_VARIABLE","$toolkit_id",89],["T_WHITESPACE"," ",89],["T_IS_NOT_EQUAL","!=",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$base_toolkit_id",89],")",["T_WHITESPACE"," ",89],["T_BOOLEAN_AND","&&",89],["T_WHITESPACE"," ",89],"!",["T_EMPTY","empty",89],"(",["T_VARIABLE","$base_toolkit_id",89],")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$base_toolkit",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","toolkitManager",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","createInstance",90],"(",["T_VARIABLE","$base_toolkit_id",90],")",";",["T_WHITESPACE","\n        ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getToolkitOperationPluginId",91],"(",["T_VARIABLE","$base_toolkit",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$operation",91],")",";",["T_WHITESPACE","\n      ",91],"}",["T_WHITESPACE","\n\n      ",92],["T_VARIABLE","$message",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","SafeMarkup",94],["T_DOUBLE_COLON","::",94],["T_STRING","format",94],"(",["T_CONSTANT_ENCAPSED_STRING","\"No image operation plugin for '@toolkit' toolkit and '@operation' operation.\"",94],",",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_CONSTANT_ENCAPSED_STRING","'@toolkit'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$toolkit_id",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'@operation'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$operation",94],")",")",";",["T_WHITESPACE","\n      ",94],["T_THROW","throw",95],["T_WHITESPACE"," ",95],["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_STRING","PluginNotFoundException",95],"(",["T_VARIABLE","$toolkit_id",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'.'",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_VARIABLE","$operation",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$message",95],")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n    ",96],["T_ELSE","else",97],["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n      ",97],["T_COMMENT","\/\/ Pickup the first plugin found.\n",98],["T_WHITESPACE","      ",99],["T_COMMENT","\/\/ @todo In https:\/\/www.drupal.org\/node\/2110591 we'll return here the UI\n",99],["T_WHITESPACE","      ",100],["T_COMMENT","\/\/   selected plugin or the first found if missed.\n",100],["T_WHITESPACE","      ",101],["T_VARIABLE","$definition",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_STRING","reset",101],"(",["T_VARIABLE","$definitions",101],")",";",["T_WHITESPACE","\n      ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$definition",102],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",102],"]",";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n  ",103],"}",["T_WHITESPACE","\n\n  ",104],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",106],["T_WHITESPACE","\n  ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","createInstance",109],"(",["T_VARIABLE","$plugin_id",109],",",["T_WHITESPACE"," ",109],["T_ARRAY","array",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$configuration",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_ARRAY","array",109],"(",")",",",["T_WHITESPACE"," ",109],["T_STRING","ImageToolkitInterface",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$toolkit",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","NULL",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$plugin_definition",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getDefinition",110],"(",["T_VARIABLE","$plugin_id",110],")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$plugin_class",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","DefaultFactory",111],["T_DOUBLE_COLON","::",111],["T_STRING","getPluginClass",111],"(",["T_VARIABLE","$plugin_id",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$plugin_definition",111],")",";",["T_WHITESPACE","\n    ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$plugin_class",112],"(",["T_VARIABLE","$configuration",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$plugin_id",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$plugin_definition",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$toolkit",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","logger",112],")",";",["T_WHITESPACE","\n  ",112],"}",["T_WHITESPACE","\n\n  ",113],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",115],["T_WHITESPACE","\n  ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","getToolkitOperation",118],"(",["T_STRING","ImageToolkitInterface",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$toolkit",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$operation",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$plugin_id",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getToolkitOperationPluginId",119],"(",["T_VARIABLE","$toolkit",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$operation",119],")",";",["T_WHITESPACE","\n    ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","createInstance",120],"(",["T_VARIABLE","$plugin_id",120],",",["T_WHITESPACE"," ",120],["T_ARRAY","array",120],"(",")",",",["T_WHITESPACE"," ",120],["T_VARIABLE","$toolkit",120],")",";",["T_WHITESPACE","\n  ",120],"}",["T_WHITESPACE","\n\n",121],"}",["T_WHITESPACE","\n",123]]