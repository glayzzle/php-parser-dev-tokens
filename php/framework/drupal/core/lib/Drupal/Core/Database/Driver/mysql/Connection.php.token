[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Driver",3],["T_NS_SEPARATOR","\\",3],["T_STRING","mysql",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DatabaseExceptionWrapper",5],";",["T_WHITESPACE","\n\n",5],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Database",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Database",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Database",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DatabaseNotFoundException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Database",9],["T_NS_SEPARATOR","\\",9],["T_STRING","TransactionCommitFailedException",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Database",10],["T_NS_SEPARATOR","\\",10],["T_STRING","DatabaseException",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Core",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Database",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Connection",11],["T_WHITESPACE"," ",11],["T_AS","as",11],["T_WHITESPACE"," ",11],["T_STRING","DatabaseConnection",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Utility",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Unicode",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * @addtogroup database\n * @{\n *\/",14],["T_WHITESPACE","\n\n",17],["T_DOC_COMMENT","\/**\n * MySQL implementation of \\Drupal\\Core\\Database\\Connection.\n *\/",19],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","Connection",22],["T_WHITESPACE"," ",22],["T_EXTENDS","extends",22],["T_WHITESPACE"," ",22],["T_STRING","DatabaseConnection",22],["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * Error code for \"Unknown database\" error.\n   *\/",24],["T_WHITESPACE","\n  ",26],["T_CONST","const",27],["T_WHITESPACE"," ",27],["T_STRING","DATABASE_NOT_FOUND",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_LNUMBER","1049",27],";",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * Error code for \"Can't initialize character set\" error.\n   *\/",29],["T_WHITESPACE","\n  ",31],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","UNSUPPORTED_CHARSET",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_LNUMBER","2019",32],";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Driver-specific error code for \"Unknown character set\" error.\n   *\/",34],["T_WHITESPACE","\n  ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","UNKNOWN_CHARSET",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_LNUMBER","1115",37],";",["T_WHITESPACE","\n\n  ",37],["T_DOC_COMMENT","\/**\n   * SQLSTATE error code for \"Syntax error or access rule violation\".\n   *\/",39],["T_WHITESPACE","\n  ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","SQLSTATE_SYNTAX_ERROR",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_LNUMBER","42000",42],";",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * Flag to indicate if the cleanup function in __destruct() should run.\n   *\n   * @var bool\n   *\/",44],["T_WHITESPACE","\n  ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$needsCleanup",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","FALSE",49],";",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * The minimal possible value for the max_allowed_packet setting of MySQL.\n   *\n   * @link https:\/\/mariadb.com\/kb\/en\/mariadb\/server-system-variables\/#max_allowed_packet\n   * @link https:\/\/dev.mysql.com\/doc\/refman\/5.7\/en\/server-system-variables.html#sysvar_max_allowed_packet\n   *\n   * @var int\n   *\/",51],["T_WHITESPACE","\n  ",58],["T_CONST","const",59],["T_WHITESPACE"," ",59],["T_STRING","MIN_MAX_ALLOWED_PACKET",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_LNUMBER","1024",59],";",["T_WHITESPACE","\n\n  ",59],["T_DOC_COMMENT","\/**\n   * Constructs a Connection object.\n   *\/",61],["T_WHITESPACE","\n  ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","__construct",64],"(",["T_NS_SEPARATOR","\\",64],["T_STRING","PDO",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$connection",64],",",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$connection_options",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n    ",64],["T_STRING","parent",65],["T_DOUBLE_COLON","::",65],["T_STRING","__construct",65],"(",["T_VARIABLE","$connection",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$connection_options",65],")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ This driver defaults to transaction support, except if explicitly passed FALSE.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","transactionSupport",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],"!",["T_ISSET","isset",68],"(",["T_VARIABLE","$connection_options",68],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",68],"]",")",["T_WHITESPACE"," ",68],["T_BOOLEAN_OR","||",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$connection_options",68],"[",["T_CONSTANT_ENCAPSED_STRING","'transactions'",68],"]",["T_WHITESPACE"," ",68],["T_IS_NOT_IDENTICAL","!==",68],["T_WHITESPACE"," ",68],["T_STRING","FALSE",68],")",";",["T_WHITESPACE","\n\n    ",68],["T_COMMENT","\/\/ MySQL never supports transactional DDL.\n",70],["T_WHITESPACE","    ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","transactionalDDLSupport",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","FALSE",71],";",["T_WHITESPACE","\n\n    ",71],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","connectionOptions",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$connection_options",73],";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",76],["T_WHITESPACE","\n  ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","query",79],"(",["T_VARIABLE","$query",79],",",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$args",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",")",",",["T_WHITESPACE"," ",79],["T_VARIABLE","$options",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n    ",79],["T_TRY","try",80],["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n      ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_STRING","parent",81],["T_DOUBLE_COLON","::",81],["T_STRING","query",81],"(",["T_VARIABLE","$query",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$args",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$options",81],")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n    ",82],["T_CATCH","catch",83],["T_WHITESPACE"," ",83],"(",["T_STRING","DatabaseException",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$e",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n      ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$e",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getPrevious",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","errorInfo",84],"[",["T_LNUMBER","1",84],"]",["T_WHITESPACE"," ",84],["T_IS_EQUAL","==",84],["T_WHITESPACE"," ",84],["T_LNUMBER","1153",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n        ",84],["T_COMMENT","\/\/ If a max_allowed_packet error occurs the message length is truncated.\n",85],["T_WHITESPACE","        ",86],["T_COMMENT","\/\/ This should prevent the error from recurring if the exception is\n",86],["T_WHITESPACE","        ",87],["T_COMMENT","\/\/ logged to the database using dblog or the like.\n",87],["T_WHITESPACE","        ",88],["T_VARIABLE","$message",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","Unicode",88],["T_DOUBLE_COLON","::",88],["T_STRING","truncateBytes",88],"(",["T_VARIABLE","$e",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getMessage",88],"(",")",",",["T_WHITESPACE"," ",88],["T_STRING","self",88],["T_DOUBLE_COLON","::",88],["T_STRING","MIN_MAX_ALLOWED_PACKET",88],")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$e",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_STRING","DatabaseExceptionWrapper",89],"(",["T_VARIABLE","$message",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$e",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getCode",89],"(",")",",",["T_WHITESPACE"," ",89],["T_VARIABLE","$e",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getPrevious",89],"(",")",")",";",["T_WHITESPACE","\n      ",89],"}",["T_WHITESPACE","\n      ",90],["T_THROW","throw",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$e",91],";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n  ",92],"}",["T_WHITESPACE","\n\n  ",93],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",95],["T_WHITESPACE","\n  ",97],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_STATIC","static",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","open",98],"(",["T_ARRAY","array",98],["T_WHITESPACE"," ",98],"&",["T_VARIABLE","$connection_options",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n    ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_ISSET","isset",99],"(",["T_VARIABLE","$connection_options",99],"[",["T_CONSTANT_ENCAPSED_STRING","'_dsn_utf8_fallback'",99],"]",")",["T_WHITESPACE"," ",99],["T_BOOLEAN_AND","&&",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$connection_options",99],"[",["T_CONSTANT_ENCAPSED_STRING","'_dsn_utf8_fallback'",99],"]",["T_WHITESPACE"," ",99],["T_IS_IDENTICAL","===",99],["T_WHITESPACE"," ",99],["T_STRING","TRUE",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_COMMENT","\/\/ Only used during the installer version check, as a fallback from utf8mb4.\n",100],["T_WHITESPACE","      ",101],["T_VARIABLE","$charset",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'utf8'",101],";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n    ",102],["T_ELSE","else",103],["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n      ",103],["T_VARIABLE","$charset",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'utf8mb4'",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n    ",105],["T_COMMENT","\/\/ The DSN should use either a socket or a host\/port.\n",106],["T_WHITESPACE","    ",107],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_ISSET","isset",107],"(",["T_VARIABLE","$connection_options",107],"[",["T_CONSTANT_ENCAPSED_STRING","'unix_socket'",107],"]",")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n      ",107],["T_VARIABLE","$dsn",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'mysql:unix_socket='",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$connection_options",108],"[",["T_CONSTANT_ENCAPSED_STRING","'unix_socket'",108],"]",";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n    ",109],["T_ELSE","else",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n      ",110],["T_COMMENT","\/\/ Default to TCP connection on port 3306.\n",111],["T_WHITESPACE","      ",112],["T_VARIABLE","$dsn",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'mysql:host='",112],["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],["T_VARIABLE","$connection_options",112],"[",["T_CONSTANT_ENCAPSED_STRING","'host'",112],"]",["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","';port='",112],["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],"(",["T_EMPTY","empty",112],"(",["T_VARIABLE","$connection_options",112],"[",["T_CONSTANT_ENCAPSED_STRING","'port'",112],"]",")",["T_WHITESPACE"," ",112],"?",["T_WHITESPACE"," ",112],["T_LNUMBER","3306",112],["T_WHITESPACE"," ",112],":",["T_WHITESPACE"," ",112],["T_VARIABLE","$connection_options",112],"[",["T_CONSTANT_ENCAPSED_STRING","'port'",112],"]",")",";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n    ",113],["T_COMMENT","\/\/ Character set is added to dsn to ensure PDO uses the proper character\n",114],["T_WHITESPACE","    ",115],["T_COMMENT","\/\/ set when escaping. This has security implications. See\n",115],["T_WHITESPACE","    ",116],["T_COMMENT","\/\/ https:\/\/www.drupal.org\/node\/1201452 for further discussion.\n",116],["T_WHITESPACE","    ",117],["T_VARIABLE","$dsn",117],["T_WHITESPACE"," ",117],["T_CONCAT_EQUAL",".=",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","';charset='",117],["T_WHITESPACE"," ",117],".",["T_WHITESPACE"," ",117],["T_VARIABLE","$charset",117],";",["T_WHITESPACE","\n    ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(","!",["T_EMPTY","empty",118],"(",["T_VARIABLE","$connection_options",118],"[",["T_CONSTANT_ENCAPSED_STRING","'database'",118],"]",")",")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n      ",118],["T_VARIABLE","$dsn",119],["T_WHITESPACE"," ",119],["T_CONCAT_EQUAL",".=",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","';dbname='",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_VARIABLE","$connection_options",119],"[",["T_CONSTANT_ENCAPSED_STRING","'database'",119],"]",";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n    ",120],["T_COMMENT","\/\/ Allow PDO options to be overridden.\n",121],["T_WHITESPACE","    ",122],["T_VARIABLE","$connection_options",122],["T_WHITESPACE"," ",122],["T_PLUS_EQUAL","+=",122],["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",["T_WHITESPACE","\n      ",122],["T_CONSTANT_ENCAPSED_STRING","'pdo'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_ARRAY","array",123],"(",")",",",["T_WHITESPACE","\n    ",123],")",";",["T_WHITESPACE","\n    ",124],["T_VARIABLE","$connection_options",125],"[",["T_CONSTANT_ENCAPSED_STRING","'pdo'",125],"]",["T_WHITESPACE"," ",125],["T_PLUS_EQUAL","+=",125],["T_WHITESPACE"," ",125],["T_ARRAY","array",125],"(",["T_WHITESPACE","\n      ",125],["T_NS_SEPARATOR","\\",126],["T_STRING","PDO",126],["T_DOUBLE_COLON","::",126],["T_STRING","ATTR_ERRMODE",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","PDO",126],["T_DOUBLE_COLON","::",126],["T_STRING","ERRMODE_EXCEPTION",126],",",["T_WHITESPACE","\n      ",126],["T_COMMENT","\/\/ So we don't have to mess around with cursors and unbuffered queries by default.\n",127],["T_WHITESPACE","      ",128],["T_NS_SEPARATOR","\\",128],["T_STRING","PDO",128],["T_DOUBLE_COLON","::",128],["T_STRING","MYSQL_ATTR_USE_BUFFERED_QUERY",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_STRING","TRUE",128],",",["T_WHITESPACE","\n      ",128],["T_COMMENT","\/\/ Make sure MySQL returns all matched rows on update queries including\n",129],["T_WHITESPACE","      ",130],["T_COMMENT","\/\/ rows that actually didn't have to be updated because the values didn't\n",130],["T_WHITESPACE","      ",131],["T_COMMENT","\/\/ change. This matches common behavior among other database systems.\n",131],["T_WHITESPACE","      ",132],["T_NS_SEPARATOR","\\",132],["T_STRING","PDO",132],["T_DOUBLE_COLON","::",132],["T_STRING","MYSQL_ATTR_FOUND_ROWS",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_STRING","TRUE",132],",",["T_WHITESPACE","\n      ",132],["T_COMMENT","\/\/ Because MySQL's prepared statements skip the query cache, because it's dumb.\n",133],["T_WHITESPACE","      ",134],["T_NS_SEPARATOR","\\",134],["T_STRING","PDO",134],["T_DOUBLE_COLON","::",134],["T_STRING","ATTR_EMULATE_PREPARES",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_STRING","TRUE",134],",",["T_WHITESPACE","\n    ",134],")",";",["T_WHITESPACE","\n    ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_STRING","defined",136],"(",["T_CONSTANT_ENCAPSED_STRING","'\\PDO::MYSQL_ATTR_MULTI_STATEMENTS'",136],")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n      ",136],["T_COMMENT","\/\/ An added connection option in PHP 5.5.21 to optionally limit SQL to a\n",137],["T_WHITESPACE","      ",138],["T_COMMENT","\/\/ single statement like mysqli.\n",138],["T_WHITESPACE","      ",139],["T_VARIABLE","$connection_options",139],"[",["T_CONSTANT_ENCAPSED_STRING","'pdo'",139],"]",["T_WHITESPACE"," ",139],["T_PLUS_EQUAL","+=",139],["T_WHITESPACE"," ",139],"[",["T_NS_SEPARATOR","\\",139],["T_STRING","PDO",139],["T_DOUBLE_COLON","::",139],["T_STRING","MYSQL_ATTR_MULTI_STATEMENTS",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_STRING","FALSE",139],"]",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_VARIABLE","$pdo",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_NEW","new",142],["T_WHITESPACE"," ",142],["T_NS_SEPARATOR","\\",142],["T_STRING","PDO",142],"(",["T_VARIABLE","$dsn",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$connection_options",142],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",142],"]",",",["T_WHITESPACE"," ",142],["T_VARIABLE","$connection_options",142],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",142],"]",",",["T_WHITESPACE"," ",142],["T_VARIABLE","$connection_options",142],"[",["T_CONSTANT_ENCAPSED_STRING","'pdo'",142],"]",")",";",["T_WHITESPACE","\n\n    ",142],["T_COMMENT","\/\/ Force MySQL to use the UTF-8 character set. Also set the collation, if a\n",144],["T_WHITESPACE","    ",145],["T_COMMENT","\/\/ certain one has been set; otherwise, MySQL defaults to\n",145],["T_WHITESPACE","    ",146],["T_COMMENT","\/\/ 'utf8mb4_general_ci' for utf8mb4.\n",146],["T_WHITESPACE","    ",147],["T_IF","if",147],["T_WHITESPACE"," ",147],"(","!",["T_EMPTY","empty",147],"(",["T_VARIABLE","$connection_options",147],"[",["T_CONSTANT_ENCAPSED_STRING","'collation'",147],"]",")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n      ",147],["T_VARIABLE","$pdo",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","exec",148],"(",["T_CONSTANT_ENCAPSED_STRING","'SET NAMES '",148],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_VARIABLE","$charset",148],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","' COLLATE '",148],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_VARIABLE","$connection_options",148],"[",["T_CONSTANT_ENCAPSED_STRING","'collation'",148],"]",")",";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n    ",149],["T_ELSE","else",150],["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n      ",150],["T_VARIABLE","$pdo",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","exec",151],"(",["T_CONSTANT_ENCAPSED_STRING","'SET NAMES '",151],["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_VARIABLE","$charset",151],")",";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_COMMENT","\/\/ Set MySQL init_commands if not already defined.  Default Drupal's MySQL\n",154],["T_WHITESPACE","    ",155],["T_COMMENT","\/\/ behavior to conform more closely to SQL standards.  This allows Drupal\n",155],["T_WHITESPACE","    ",156],["T_COMMENT","\/\/ to run almost seamlessly on many different kinds of database systems.\n",156],["T_WHITESPACE","    ",157],["T_COMMENT","\/\/ These settings force MySQL to behave the same as postgresql, or sqlite\n",157],["T_WHITESPACE","    ",158],["T_COMMENT","\/\/ in regards to syntax interpretation and invalid data handling.  See\n",158],["T_WHITESPACE","    ",159],["T_COMMENT","\/\/ https:\/\/www.drupal.org\/node\/344575 for further discussion. Also, as MySQL\n",159],["T_WHITESPACE","    ",160],["T_COMMENT","\/\/ 5.5 changed the meaning of TRADITIONAL we need to spell out the modes one\n",160],["T_WHITESPACE","    ",161],["T_COMMENT","\/\/ by one.\n",161],["T_WHITESPACE","    ",162],["T_VARIABLE","$connection_options",162],["T_WHITESPACE"," ",162],["T_PLUS_EQUAL","+=",162],["T_WHITESPACE"," ",162],["T_ARRAY","array",162],"(",["T_WHITESPACE","\n      ",162],["T_CONSTANT_ENCAPSED_STRING","'init_commands'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_ARRAY","array",163],"(",")",",",["T_WHITESPACE","\n    ",163],")",";",["T_WHITESPACE","\n    ",164],["T_VARIABLE","$connection_options",165],"[",["T_CONSTANT_ENCAPSED_STRING","'init_commands'",165],"]",["T_WHITESPACE"," ",165],["T_PLUS_EQUAL","+=",165],["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",["T_WHITESPACE","\n      ",165],["T_CONSTANT_ENCAPSED_STRING","'sql_mode'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","\"SET sql_mode = 'ANSI,STRICT_TRANS_TABLES,STRICT_ALL_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,ONLY_FULL_GROUP_BY'\"",166],",",["T_WHITESPACE","\n    ",166],")",";",["T_WHITESPACE","\n    ",167],["T_COMMENT","\/\/ Execute initial commands.\n",168],["T_WHITESPACE","    ",169],["T_FOREACH","foreach",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$connection_options",169],"[",["T_CONSTANT_ENCAPSED_STRING","'init_commands'",169],"]",["T_WHITESPACE"," ",169],["T_AS","as",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$sql",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n      ",169],["T_VARIABLE","$pdo",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","exec",170],"(",["T_VARIABLE","$sql",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$pdo",173],";",["T_WHITESPACE","\n  ",173],"}",["T_WHITESPACE","\n\n  ",174],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",176],["T_WHITESPACE","\n  ",178],["T_PUBLIC","public",179],["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],["T_STRING","serialize",179],"(",")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n    ",179],["T_COMMENT","\/\/ Cleanup the connection, much like __destruct() does it as well.\n",180],["T_WHITESPACE","    ",181],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","needsCleanup",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n      ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","nextIdDelete",182],"(",")",";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","needsCleanup",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_STRING","FALSE",184],";",["T_WHITESPACE","\n\n    ",184],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_STRING","parent",186],["T_DOUBLE_COLON","::",186],["T_STRING","serialize",186],"(",")",";",["T_WHITESPACE","\n  ",186],"}",["T_WHITESPACE","\n\n  ",187],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",189],["T_WHITESPACE","\n  ",191],["T_PUBLIC","public",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","__destruct",192],"(",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n    ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","needsCleanup",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n      ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","nextIdDelete",194],"(",")",";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n  ",195],"}",["T_WHITESPACE","\n\n  ",196],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","queryRange",198],"(",["T_VARIABLE","$query",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$from",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$count",198],",",["T_WHITESPACE"," ",198],["T_ARRAY","array",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$args",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_ARRAY","array",198],"(",")",",",["T_WHITESPACE"," ",198],["T_ARRAY","array",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$options",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_ARRAY","array",198],"(",")",")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n    ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","query",199],"(",["T_VARIABLE","$query",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","' LIMIT '",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_INT_CAST","(int)",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$from",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","', '",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_INT_CAST","(int)",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$count",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$args",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$options",199],")",";",["T_WHITESPACE","\n  ",199],"}",["T_WHITESPACE","\n\n  ",200],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","queryTemporary",202],"(",["T_VARIABLE","$query",202],",",["T_WHITESPACE"," ",202],["T_ARRAY","array",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$args",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_ARRAY","array",202],"(",")",",",["T_WHITESPACE"," ",202],["T_ARRAY","array",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$options",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_ARRAY","array",202],"(",")",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n    ",202],["T_VARIABLE","$tablename",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","generateTemporaryTableName",203],"(",")",";",["T_WHITESPACE","\n    ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","query",204],"(",["T_CONSTANT_ENCAPSED_STRING","'CREATE TEMPORARY TABLE {'",204],["T_WHITESPACE"," ",204],".",["T_WHITESPACE"," ",204],["T_VARIABLE","$tablename",204],["T_WHITESPACE"," ",204],".",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'} Engine=MEMORY '",204],["T_WHITESPACE"," ",204],".",["T_WHITESPACE"," ",204],["T_VARIABLE","$query",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$args",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$options",204],")",";",["T_WHITESPACE","\n    ",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$tablename",205],";",["T_WHITESPACE","\n  ",205],"}",["T_WHITESPACE","\n\n  ",206],["T_PUBLIC","public",208],["T_WHITESPACE"," ",208],["T_FUNCTION","function",208],["T_WHITESPACE"," ",208],["T_STRING","driver",208],"(",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n    ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'mysql'",209],";",["T_WHITESPACE","\n  ",209],"}",["T_WHITESPACE","\n\n  ",210],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","databaseType",212],"(",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n    ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'mysql'",213],";",["T_WHITESPACE","\n  ",213],"}",["T_WHITESPACE","\n\n  ",214],["T_DOC_COMMENT","\/**\n   * Overrides \\Drupal\\Core\\Database\\Connection::createDatabase().\n   *\n   * @param string $database\n   *   The name of the database to create.\n   *\n   * @throws \\Drupal\\Core\\Database\\DatabaseNotFoundException\n   *\/",216],["T_WHITESPACE","\n  ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","createDatabase",224],"(",["T_VARIABLE","$database",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n    ",224],["T_COMMENT","\/\/ Escape the database name.\n",225],["T_WHITESPACE","    ",226],["T_VARIABLE","$database",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_STRING","Database",226],["T_DOUBLE_COLON","::",226],["T_STRING","getConnection",226],"(",")",["T_OBJECT_OPERATOR","->",226],["T_STRING","escapeDatabase",226],"(",["T_VARIABLE","$database",226],")",";",["T_WHITESPACE","\n\n    ",226],["T_TRY","try",228],["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n      ",228],["T_COMMENT","\/\/ Create the database and set it as active.\n",229],["T_WHITESPACE","      ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","connection",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","exec",230],"(","\"",["T_ENCAPSED_AND_WHITESPACE","CREATE DATABASE ",230],["T_VARIABLE","$database",230],"\"",")",";",["T_WHITESPACE","\n      ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","connection",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","exec",231],"(","\"",["T_ENCAPSED_AND_WHITESPACE","USE ",231],["T_VARIABLE","$database",231],"\"",")",";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n    ",232],["T_CATCH","catch",233],["T_WHITESPACE"," ",233],"(",["T_NS_SEPARATOR","\\",233],["T_STRING","Exception",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$e",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n      ",233],["T_THROW","throw",234],["T_WHITESPACE"," ",234],["T_NEW","new",234],["T_WHITESPACE"," ",234],["T_STRING","DatabaseNotFoundException",234],"(",["T_VARIABLE","$e",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getMessage",234],"(",")",")",";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n  ",235],"}",["T_WHITESPACE","\n\n  ",236],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","mapConditionOperator",238],"(",["T_VARIABLE","$operator",238],")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n    ",238],["T_COMMENT","\/\/ We don't want to override any of the defaults.\n",239],["T_WHITESPACE","    ",240],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_STRING","NULL",240],";",["T_WHITESPACE","\n  ",240],"}",["T_WHITESPACE","\n\n  ",241],["T_PUBLIC","public",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","nextId",243],"(",["T_VARIABLE","$existing_id",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_LNUMBER","0",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$new_id",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","query",244],"(",["T_CONSTANT_ENCAPSED_STRING","'INSERT INTO {sequences} () VALUES ()'",244],",",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",")",",",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",["T_CONSTANT_ENCAPSED_STRING","'return'",244],["T_WHITESPACE"," ",244],["T_DOUBLE_ARROW","=>",244],["T_WHITESPACE"," ",244],["T_STRING","Database",244],["T_DOUBLE_COLON","::",244],["T_STRING","RETURN_INSERT_ID",244],")",")",";",["T_WHITESPACE","\n    ",244],["T_COMMENT","\/\/ This should only happen after an import or similar event.\n",245],["T_WHITESPACE","    ",246],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$existing_id",246],["T_WHITESPACE"," ",246],["T_IS_GREATER_OR_EQUAL",">=",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$new_id",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n      ",246],["T_COMMENT","\/\/ If we INSERT a value manually into the sequences table, on the next\n",247],["T_WHITESPACE","      ",248],["T_COMMENT","\/\/ INSERT, MySQL will generate a larger value. However, there is no way\n",248],["T_WHITESPACE","      ",249],["T_COMMENT","\/\/ of knowing whether this value already exists in the table. MySQL\n",249],["T_WHITESPACE","      ",250],["T_COMMENT","\/\/ provides an INSERT IGNORE which would work, but that can mask problems\n",250],["T_WHITESPACE","      ",251],["T_COMMENT","\/\/ other than duplicate keys. Instead, we use INSERT ... ON DUPLICATE KEY\n",251],["T_WHITESPACE","      ",252],["T_COMMENT","\/\/ UPDATE in such a way that the UPDATE does not do anything. This way,\n",252],["T_WHITESPACE","      ",253],["T_COMMENT","\/\/ duplicate keys do not generate errors but everything else does.\n",253],["T_WHITESPACE","      ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","query",254],"(",["T_CONSTANT_ENCAPSED_STRING","'INSERT INTO {sequences} (value) VALUES (:value) ON DUPLICATE KEY UPDATE value = value'",254],",",["T_WHITESPACE"," ",254],["T_ARRAY","array",254],"(",["T_CONSTANT_ENCAPSED_STRING","':value'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$existing_id",254],")",")",";",["T_WHITESPACE","\n      ",254],["T_VARIABLE","$new_id",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","query",255],"(",["T_CONSTANT_ENCAPSED_STRING","'INSERT INTO {sequences} () VALUES ()'",255],",",["T_WHITESPACE"," ",255],["T_ARRAY","array",255],"(",")",",",["T_WHITESPACE"," ",255],["T_ARRAY","array",255],"(",["T_CONSTANT_ENCAPSED_STRING","'return'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_STRING","Database",255],["T_DOUBLE_COLON","::",255],["T_STRING","RETURN_INSERT_ID",255],")",")",";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n    ",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","needsCleanup",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_STRING","TRUE",257],";",["T_WHITESPACE","\n    ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$new_id",258],";",["T_WHITESPACE","\n  ",258],"}",["T_WHITESPACE","\n\n  ",259],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","nextIdDelete",261],"(",")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n    ",261],["T_COMMENT","\/\/ While we want to clean up the table to keep it up from occupying too\n",262],["T_WHITESPACE","    ",263],["T_COMMENT","\/\/ much storage and memory, we must keep the highest value in the table\n",263],["T_WHITESPACE","    ",264],["T_COMMENT","\/\/ because InnoDB uses an in-memory auto-increment counter as long as the\n",264],["T_WHITESPACE","    ",265],["T_COMMENT","\/\/ server runs. When the server is stopped and restarted, InnoDB\n",265],["T_WHITESPACE","    ",266],["T_COMMENT","\/\/ reinitializes the counter for each table for the first INSERT to the\n",266],["T_WHITESPACE","    ",267],["T_COMMENT","\/\/ table based solely on values from the table so deleting all values would\n",267],["T_WHITESPACE","    ",268],["T_COMMENT","\/\/ be a problem in this case. Also, TRUNCATE resets the auto increment\n",268],["T_WHITESPACE","    ",269],["T_COMMENT","\/\/ counter.\n",269],["T_WHITESPACE","    ",270],["T_TRY","try",270],["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n      ",270],["T_VARIABLE","$max_id",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","query",271],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT MAX(value) FROM {sequences}'",271],")",["T_OBJECT_OPERATOR","->",271],["T_STRING","fetchField",271],"(",")",";",["T_WHITESPACE","\n      ",271],["T_COMMENT","\/\/ We know we are using MySQL here, no need for the slower db_delete().\n",272],["T_WHITESPACE","      ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","query",273],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE FROM {sequences} WHERE value < :value'",273],",",["T_WHITESPACE"," ",273],["T_ARRAY","array",273],"(",["T_CONSTANT_ENCAPSED_STRING","':value'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$max_id",273],")",")",";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n    ",274],["T_COMMENT","\/\/ During testing, this function is called from shutdown with the\n",275],["T_WHITESPACE","    ",276],["T_COMMENT","\/\/ simpletest prefix stored in $this->connection, and those tables are gone\n",276],["T_WHITESPACE","    ",277],["T_COMMENT","\/\/ by the time shutdown is called so we need to ignore the database\n",277],["T_WHITESPACE","    ",278],["T_COMMENT","\/\/ errors. There is no problem with completely ignoring errors here: if\n",278],["T_WHITESPACE","    ",279],["T_COMMENT","\/\/ these queries fail, the sequence will work just fine, just use a bit\n",279],["T_WHITESPACE","    ",280],["T_COMMENT","\/\/ more database storage and memory.\n",280],["T_WHITESPACE","    ",281],["T_CATCH","catch",281],["T_WHITESPACE"," ",281],"(",["T_STRING","DatabaseException",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$e",281],")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n    ",281],"}",["T_WHITESPACE","\n  ",282],"}",["T_WHITESPACE","\n\n  ",283],["T_DOC_COMMENT","\/**\n   * Overridden to work around issues to MySQL not supporting transactional DDL.\n   *\/",285],["T_WHITESPACE","\n  ",287],["T_PROTECTED","protected",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","popCommittableTransactions",288],"(",")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n    ",288],["T_COMMENT","\/\/ Commit all the committable layers.\n",289],["T_WHITESPACE","    ",290],["T_FOREACH","foreach",290],["T_WHITESPACE"," ",290],"(",["T_STRING","array_reverse",290],"(",["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","transactionLayers",290],")",["T_WHITESPACE"," ",290],["T_AS","as",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$name",290],["T_WHITESPACE"," ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$active",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n      ",290],["T_COMMENT","\/\/ Stop once we found an active transaction.\n",291],["T_WHITESPACE","      ",292],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$active",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n        ",292],["T_BREAK","break",293],";",["T_WHITESPACE","\n      ",293],"}",["T_WHITESPACE","\n\n      ",294],["T_COMMENT","\/\/ If there are no more layers left then we should commit.\n",296],["T_WHITESPACE","      ",297],["T_UNSET","unset",297],"(",["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","transactionLayers",297],"[",["T_VARIABLE","$name",297],"]",")",";",["T_WHITESPACE","\n      ",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(",["T_EMPTY","empty",298],"(",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","transactionLayers",298],")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n        ",298],["T_IF","if",299],["T_WHITESPACE"," ",299],"(","!",["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","connection",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","commit",299],"(",")",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n          ",299],["T_THROW","throw",300],["T_WHITESPACE"," ",300],["T_NEW","new",300],["T_WHITESPACE"," ",300],["T_STRING","TransactionCommitFailedException",300],"(",")",";",["T_WHITESPACE","\n        ",300],"}",["T_WHITESPACE","\n      ",301],"}",["T_WHITESPACE","\n      ",302],["T_ELSE","else",303],["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n        ",303],["T_COMMENT","\/\/ Attempt to release this savepoint in the standard way.\n",304],["T_WHITESPACE","        ",305],["T_TRY","try",305],["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n          ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","query",306],"(",["T_CONSTANT_ENCAPSED_STRING","'RELEASE SAVEPOINT '",306],["T_WHITESPACE"," ",306],".",["T_WHITESPACE"," ",306],["T_VARIABLE","$name",306],")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n        ",307],["T_CATCH","catch",308],["T_WHITESPACE"," ",308],"(",["T_STRING","DatabaseExceptionWrapper",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$e",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n          ",308],["T_COMMENT","\/\/ However, in MySQL (InnoDB), savepoints are automatically committed\n",309],["T_WHITESPACE","          ",310],["T_COMMENT","\/\/ when tables are altered or created (DDL transactions are not\n",310],["T_WHITESPACE","          ",311],["T_COMMENT","\/\/ supported). This can cause exceptions due to trying to release\n",311],["T_WHITESPACE","          ",312],["T_COMMENT","\/\/ savepoints which no longer exist.\n",312],["T_WHITESPACE","          ",313],["T_COMMENT","\/\/\n",313],["T_WHITESPACE","          ",314],["T_COMMENT","\/\/ To avoid exceptions when no actual error has occurred, we silently\n",314],["T_WHITESPACE","          ",315],["T_COMMENT","\/\/ succeed for MySQL error code 1305 (\"SAVEPOINT does not exist\").\n",315],["T_WHITESPACE","          ",316],["T_IF","if",316],["T_WHITESPACE"," ",316],"(",["T_VARIABLE","$e",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getPrevious",316],"(",")",["T_OBJECT_OPERATOR","->",316],["T_STRING","errorInfo",316],"[",["T_LNUMBER","1",316],"]",["T_WHITESPACE"," ",316],["T_IS_EQUAL","==",316],["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'1305'",316],")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n            ",316],["T_COMMENT","\/\/ If one SAVEPOINT was released automatically, then all were.\n",317],["T_WHITESPACE","            ",318],["T_COMMENT","\/\/ Therefore, clean the transaction stack.\n",318],["T_WHITESPACE","            ",319],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","transactionLayers",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_ARRAY","array",319],"(",")",";",["T_WHITESPACE","\n            ",319],["T_COMMENT","\/\/ We also have to explain to PDO that the transaction stack has\n",320],["T_WHITESPACE","            ",321],["T_COMMENT","\/\/ been cleaned-up.\n",321],["T_WHITESPACE","            ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","connection",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","commit",322],"(",")",";",["T_WHITESPACE","\n          ",322],"}",["T_WHITESPACE","\n          ",323],["T_ELSE","else",324],["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_THROW","throw",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$e",325],";",["T_WHITESPACE","\n          ",325],"}",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n      ",327],"}",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n  ",329],"}",["T_WHITESPACE","\n\n",330],"}",["T_WHITESPACE","\n\n\n",332],["T_DOC_COMMENT","\/**\n * @} End of \"addtogroup database\".\n *\/",335],["T_WHITESPACE","\n",337]]