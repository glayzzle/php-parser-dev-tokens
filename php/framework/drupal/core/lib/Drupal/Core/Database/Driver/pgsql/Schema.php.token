[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Driver",3],["T_NS_SEPARATOR","\\",3],["T_STRING","pgsql",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Unicode",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Database",6],["T_NS_SEPARATOR","\\",6],["T_STRING","SchemaObjectExistsException",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Database",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SchemaObjectDoesNotExistException",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Database",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Schema",8],["T_WHITESPACE"," ",8],["T_AS","as",8],["T_WHITESPACE"," ",8],["T_STRING","DatabaseSchema",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * @addtogroup schemaapi\n * @{\n *\/",10],["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * PostgreSQL implementation of \\Drupal\\Core\\Database\\Schema.\n *\/",15],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","Schema",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_STRING","DatabaseSchema",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * A cache of information about blob columns and sequences of tables.\n   *\n   * This is collected by Schema::queryTableInformation(), by introspecting the\n   * database.\n   *\n   * @see \\Drupal\\Core\\Database\\Driver\\pgsql\\Schema::queryTableInformation()\n   * @var array\n   *\/",20],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$tableInformation",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",")",";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * The maximum allowed length for index, primary key and constraint names.\n   *\n   * Value will usually be set to a 63 chars limit but PostgreSQL allows\n   * to higher this value before compiling, so we need to check for that.\n   *\n   * @var int\n   *\/",31],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$maxIdentifierLength",39],";",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * Make sure to limit identifiers according to PostgreSQL compiled in length.\n   *\n   * PostgreSQL allows in standard configuration no longer identifiers than 63\n   * chars for table\/relation names, indexes, primary keys, and constraints. So\n   * we map all identifiers that are too long to drupal_base64hash_tag, where\n   * tag is one of:\n   *   - idx for indexes\n   *   - key for constraints\n   *   - pkey for primary keys\n   *\n   * @param $identifiers\n   *   The arguments to build the identifier string\n   * @return\n   *   The index\/constraint\/pkey identifier\n   *\/",41],["T_WHITESPACE","\n  ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","ensureIdentifiersLength",57],"(",["T_VARIABLE","$identifier",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$args",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","func_get_args",58],"(",")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$info",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getPrefixInfo",59],"(",["T_VARIABLE","$identifier",59],")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$args",60],"[",["T_LNUMBER","0",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$info",60],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",60],"]",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$identifierName",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","implode",61],"(",["T_CONSTANT_ENCAPSED_STRING","'__'",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$args",61],")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ Retrieve the max identifier length which is usually 63 characters\n",63],["T_WHITESPACE","    ",64],["T_COMMENT","\/\/ but can be altered before PostgreSQL is compiled so we need to check.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","maxIdentifierLength",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","connection",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","query",65],"(",["T_CONSTANT_ENCAPSED_STRING","\"SHOW max_identifier_length\"",65],")",["T_OBJECT_OPERATOR","->",65],["T_STRING","fetchField",65],"(",")",";",["T_WHITESPACE","\n\n    ",65],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_STRING","strlen",67],"(",["T_VARIABLE","$identifierName",67],")",["T_WHITESPACE"," ",67],">",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","maxIdentifierLength",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n      ",67],["T_VARIABLE","$saveIdentifier",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'\"drupal_'",68],["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","hashBase64",68],"(",["T_VARIABLE","$identifierName",68],")",["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'_'",68],["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_VARIABLE","$args",68],"[",["T_LNUMBER","2",68],"]",["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'\"'",68],";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n    ",69],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n      ",70],["T_VARIABLE","$saveIdentifier",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$identifierName",71],";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n    ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$saveIdentifier",73],";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * Fetch the list of blobs and sequences used on a table.\n   *\n   * We introspect the database to collect the information required by insert\n   * and update queries.\n   *\n   * @param $table_name\n   *   The non-prefixed name of the table.\n   * @return\n   *   An object with two member variables:\n   *     - 'blob_fields' that lists all the blob fields in the table.\n   *     - 'sequences' that lists the sequences used in that table.\n   *\/",76],["T_WHITESPACE","\n  ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","queryTableInformation",89],"(",["T_VARIABLE","$table",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n    ",89],["T_COMMENT","\/\/ Generate a key to reference this table's information on.\n",90],["T_WHITESPACE","    ",91],["T_VARIABLE","$key",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","connection",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","prefixTables",91],"(",["T_CONSTANT_ENCAPSED_STRING","'{'",91],["T_WHITESPACE"," ",91],".",["T_WHITESPACE"," ",91],["T_VARIABLE","$table",91],["T_WHITESPACE"," ",91],".",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'}'",91],")",";",["T_WHITESPACE","\n\n    ",91],["T_COMMENT","\/\/ Take into account that temporary tables are stored in a different schema.\n",93],["T_WHITESPACE","    ",94],["T_COMMENT","\/\/ \\Drupal\\Core\\Database\\Connection::generateTemporaryTableName() sets the\n",94],["T_WHITESPACE","    ",95],["T_COMMENT","\/\/ 'db_temporary_' prefix to all temporary tables.\n",95],["T_WHITESPACE","    ",96],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_STRING","strpos",96],"(",["T_VARIABLE","$key",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'.'",96],")",["T_WHITESPACE"," ",96],["T_IS_IDENTICAL","===",96],["T_WHITESPACE"," ",96],["T_STRING","FALSE",96],["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],["T_STRING","strpos",96],"(",["T_VARIABLE","$table",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'db_temporary_'",96],")",["T_WHITESPACE"," ",96],["T_IS_IDENTICAL","===",96],["T_WHITESPACE"," ",96],["T_STRING","FALSE",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$key",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'public.'",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_VARIABLE","$key",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n    ",98],["T_ELSE","else",99],["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_VARIABLE","$schema",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","connection",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","query",100],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT nspname FROM pg_namespace WHERE oid = pg_my_temp_schema()'",100],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","fetchField",100],"(",")",";",["T_WHITESPACE","\n      ",100],["T_VARIABLE","$key",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$schema",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'.'",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_VARIABLE","$key",101],";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(","!",["T_ISSET","isset",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","tableInformation",104],"[",["T_VARIABLE","$key",104],"]",")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n      ",104],["T_COMMENT","\/\/ Split the key into schema and table for querying.\n",105],["T_WHITESPACE","      ",106],["T_LIST","list",106],"(",["T_VARIABLE","$schema",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$table_name",106],")",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","explode",106],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$key",106],")",";",["T_WHITESPACE","\n      ",106],["T_VARIABLE","$table_information",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_OBJECT_CAST","(object)",107],["T_WHITESPACE"," ",107],["T_ARRAY","array",107],"(",["T_WHITESPACE","\n        ",107],["T_CONSTANT_ENCAPSED_STRING","'blob_fields'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_ARRAY","array",108],"(",")",",",["T_WHITESPACE","\n        ",108],["T_CONSTANT_ENCAPSED_STRING","'sequences'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_ARRAY","array",109],"(",")",",",["T_WHITESPACE","\n      ",109],")",";",["T_WHITESPACE","\n      ",110],["T_COMMENT","\/\/ Don't use {} around information_schema.columns table.\n",111],["T_WHITESPACE","      ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","connection",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","addSavepoint",112],"(",")",";",["T_WHITESPACE","\n\n      ",112],["T_TRY","try",114],["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n        ",114],["T_COMMENT","\/\/ Check if the table information exists in the PostgreSQL metadata.\n",115],["T_WHITESPACE","        ",116],["T_VARIABLE","$table_information_exists",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_BOOL_CAST","(bool)",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","connection",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","query",116],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT 1 FROM pg_class WHERE relname = :table\"",116],",",["T_WHITESPACE"," ",116],["T_ARRAY","array",116],"(",["T_CONSTANT_ENCAPSED_STRING","':table'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$table_name",116],")",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","fetchField",116],"(",")",";",["T_WHITESPACE","\n\n        ",116],["T_COMMENT","\/\/ If the table information does not yet exist in the PostgreSQL\n",118],["T_WHITESPACE","        ",119],["T_COMMENT","\/\/ metadata, then return the default table information here, so that it\n",119],["T_WHITESPACE","        ",120],["T_COMMENT","\/\/ will not be cached.\n",120],["T_WHITESPACE","        ",121],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$table_information_exists",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n          ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","connection",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","releaseSavepoint",122],"(",")",";",["T_WHITESPACE","\n          ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$table_information",123],";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n        ",124],["T_ELSE","else",125],["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n          ",125],["T_VARIABLE","$result",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","connection",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","query",126],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT column_name, data_type, column_default FROM information_schema.columns WHERE table_schema = :schema AND table_name = :table AND (data_type = 'bytea' OR (numeric_precision IS NOT NULL AND column_default LIKE :default))\"",126],",",["T_WHITESPACE"," ",126],["T_ARRAY","array",126],"(",["T_WHITESPACE","\n            ",126],["T_CONSTANT_ENCAPSED_STRING","':schema'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$schema",127],",",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","':table'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$table_name",128],",",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","':default'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'%nextval%'",129],",",["T_WHITESPACE","\n          ",129],")",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n      ",131],"}",["T_WHITESPACE","\n      ",132],["T_CATCH","catch",133],["T_WHITESPACE"," ",133],"(",["T_NS_SEPARATOR","\\",133],["T_STRING","Exception",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$e",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","connection",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","rollbackSavepoint",134],"(",")",";",["T_WHITESPACE","\n        ",134],["T_THROW","throw",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$e",135],";",["T_WHITESPACE","\n      ",135],"}",["T_WHITESPACE","\n      ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","connection",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","releaseSavepoint",137],"(",")",";",["T_WHITESPACE","\n\n      ",137],["T_FOREACH","foreach",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$result",139],["T_WHITESPACE"," ",139],["T_AS","as",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$column",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$column",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","data_type",140],["T_WHITESPACE"," ",140],["T_IS_EQUAL","==",140],["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'bytea'",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n          ",140],["T_VARIABLE","$table_information",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","blob_fields",141],"[",["T_VARIABLE","$column",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","column_name",141],"]",["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","TRUE",141],";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n        ",142],["T_ELSEIF","elseif",143],["T_WHITESPACE"," ",143],"(",["T_STRING","preg_match",143],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/nextval\\('([^']+)'\/\"",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$column",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","column_default",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$matches",143],")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n          ",143],["T_COMMENT","\/\/ We must know of any sequences in the table structure to help us\n",144],["T_WHITESPACE","          ",145],["T_COMMENT","\/\/ return the last insert id. If there is more than 1 sequences the\n",145],["T_WHITESPACE","          ",146],["T_COMMENT","\/\/ first one (index 0 of the sequences array) will be used.\n",146],["T_WHITESPACE","          ",147],["T_VARIABLE","$table_information",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","sequences",147],"[","]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$matches",147],"[",["T_LNUMBER","1",147],"]",";",["T_WHITESPACE","\n          ",147],["T_VARIABLE","$table_information",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","serial_fields",148],"[","]",["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$column",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","column_name",148],";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n      ",149],"}",["T_WHITESPACE","\n      ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","tableInformation",151],"[",["T_VARIABLE","$key",151],"]",["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$table_information",151],";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n    ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","tableInformation",153],"[",["T_VARIABLE","$key",153],"]",";",["T_WHITESPACE","\n  ",153],"}",["T_WHITESPACE","\n\n  ",154],["T_DOC_COMMENT","\/**\n   * Resets information about table blobs, sequences and serial fields.\n   *\n   * @param $table\n   *   The non-prefixed name of the table.\n   *\/",156],["T_WHITESPACE","\n  ",161],["T_PROTECTED","protected",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","resetTableInformation",162],"(",["T_VARIABLE","$table",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$key",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","connection",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","prefixTables",163],"(",["T_CONSTANT_ENCAPSED_STRING","'{'",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$table",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'}'",163],")",";",["T_WHITESPACE","\n    ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_STRING","strpos",164],"(",["T_VARIABLE","$key",164],",",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'.'",164],")",["T_WHITESPACE"," ",164],["T_IS_IDENTICAL","===",164],["T_WHITESPACE"," ",164],["T_STRING","FALSE",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n      ",164],["T_VARIABLE","$key",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'public.'",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$key",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n    ",166],["T_UNSET","unset",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","tableInformation",167],"[",["T_VARIABLE","$key",167],"]",")",";",["T_WHITESPACE","\n  ",167],"}",["T_WHITESPACE","\n\n  ",168],["T_DOC_COMMENT","\/**\n   * Fetch the list of CHECK constraints used on a field.\n   *\n   * We introspect the database to collect the information required by field\n   * alteration.\n   *\n   * @param $table\n   *   The non-prefixed name of the table.\n   * @param $field\n   *   The name of the field.\n   * @return\n   *   An array of all the checks for the field.\n   *\/",170],["T_WHITESPACE","\n  ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","queryFieldInformation",183],"(",["T_VARIABLE","$table",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$field",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$prefixInfo",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getPrefixInfo",184],"(",["T_VARIABLE","$table",184],",",["T_WHITESPACE"," ",184],["T_STRING","TRUE",184],")",";",["T_WHITESPACE","\n\n    ",184],["T_COMMENT","\/\/ Split the key into schema and table for querying.\n",186],["T_WHITESPACE","    ",187],["T_VARIABLE","$schema",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$prefixInfo",187],"[",["T_CONSTANT_ENCAPSED_STRING","'schema'",187],"]",";",["T_WHITESPACE","\n    ",187],["T_VARIABLE","$table_name",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$prefixInfo",188],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",188],"]",";",["T_WHITESPACE","\n\n    ",188],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","connection",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","addSavepoint",190],"(",")",";",["T_WHITESPACE","\n\n    ",190],["T_TRY","try",192],["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n      ",192],["T_VARIABLE","$checks",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","connection",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","query",193],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT conname FROM pg_class cl INNER JOIN pg_constraint co ON co.conrelid = cl.oid INNER JOIN pg_attribute attr ON attr.attrelid = cl.oid AND attr.attnum = ANY (co.conkey) INNER JOIN pg_namespace ns ON cl.relnamespace = ns.oid WHERE co.contype = 'c' AND ns.nspname = :schema AND cl.relname = :table AND attr.attname = :column\"",193],",",["T_WHITESPACE"," ",193],["T_ARRAY","array",193],"(",["T_WHITESPACE","\n        ",193],["T_CONSTANT_ENCAPSED_STRING","':schema'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$schema",194],",",["T_WHITESPACE","\n        ",194],["T_CONSTANT_ENCAPSED_STRING","':table'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$table_name",195],",",["T_WHITESPACE","\n        ",195],["T_CONSTANT_ENCAPSED_STRING","':column'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$field",196],",",["T_WHITESPACE","\n      ",196],")",")",";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n    ",198],["T_CATCH","catch",199],["T_WHITESPACE"," ",199],"(",["T_NS_SEPARATOR","\\",199],["T_STRING","Exception",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$e",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n      ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","connection",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","rollbackSavepoint",200],"(",")",";",["T_WHITESPACE","\n      ",200],["T_THROW","throw",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$e",201],";",["T_WHITESPACE","\n    ",201],"}",["T_WHITESPACE","\n\n    ",202],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","connection",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","releaseSavepoint",204],"(",")",";",["T_WHITESPACE","\n\n    ",204],["T_VARIABLE","$field_information",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$checks",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","fetchCol",206],"(",")",";",["T_WHITESPACE","\n\n    ",206],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$field_information",208],";",["T_WHITESPACE","\n  ",208],"}",["T_WHITESPACE","\n\n  ",209],["T_DOC_COMMENT","\/**\n   * Generate SQL to create a new table from a Drupal schema definition.\n   *\n   * @param $name\n   *   The name of the table to create.\n   * @param $table\n   *   A Schema API table definition array.\n   * @return\n   *   An array of SQL statements to create the table.\n   *\/",211],["T_WHITESPACE","\n  ",220],["T_PROTECTED","protected",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","createTableSql",221],"(",["T_VARIABLE","$name",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$table",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n    ",221],["T_VARIABLE","$sql_fields",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",")",";",["T_WHITESPACE","\n    ",222],["T_FOREACH","foreach",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$table",223],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",223],"]",["T_WHITESPACE"," ",223],["T_AS","as",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$field_name",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$field",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n      ",223],["T_VARIABLE","$sql_fields",224],"[","]",["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","createFieldSql",224],"(",["T_VARIABLE","$field_name",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","processField",224],"(",["T_VARIABLE","$field",224],")",")",";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_VARIABLE","$sql_keys",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_ARRAY","array",227],"(",")",";",["T_WHITESPACE","\n    ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_ISSET","isset",228],"(",["T_VARIABLE","$table",228],"[",["T_CONSTANT_ENCAPSED_STRING","'primary key'",228],"]",")",["T_WHITESPACE"," ",228],["T_BOOLEAN_AND","&&",228],["T_WHITESPACE"," ",228],["T_STRING","is_array",228],"(",["T_VARIABLE","$table",228],"[",["T_CONSTANT_ENCAPSED_STRING","'primary key'",228],"]",")",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n      ",228],["T_VARIABLE","$sql_keys",229],"[","]",["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'CONSTRAINT '",229],["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","ensureIdentifiersLength",229],"(",["T_VARIABLE","$name",229],",",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","''",229],",",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'pkey'",229],")",["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","' PRIMARY KEY ('",229],["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","createPrimaryKeySql",229],"(",["T_VARIABLE","$table",229],"[",["T_CONSTANT_ENCAPSED_STRING","'primary key'",229],"]",")",["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","')'",229],";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n    ",230],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_ISSET","isset",231],"(",["T_VARIABLE","$table",231],"[",["T_CONSTANT_ENCAPSED_STRING","'unique keys'",231],"]",")",["T_WHITESPACE"," ",231],["T_BOOLEAN_AND","&&",231],["T_WHITESPACE"," ",231],["T_STRING","is_array",231],"(",["T_VARIABLE","$table",231],"[",["T_CONSTANT_ENCAPSED_STRING","'unique keys'",231],"]",")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n      ",231],["T_FOREACH","foreach",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$table",232],"[",["T_CONSTANT_ENCAPSED_STRING","'unique keys'",232],"]",["T_WHITESPACE"," ",232],["T_AS","as",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$key_name",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$key",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$sql_keys",233],"[","]",["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'CONSTRAINT '",233],["T_WHITESPACE"," ",233],".",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","ensureIdentifiersLength",233],"(",["T_VARIABLE","$name",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$key_name",233],",",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'key'",233],")",["T_WHITESPACE"," ",233],".",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","' UNIQUE ('",233],["T_WHITESPACE"," ",233],".",["T_WHITESPACE"," ",233],["T_STRING","implode",233],"(",["T_CONSTANT_ENCAPSED_STRING","', '",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$key",233],")",["T_WHITESPACE"," ",233],".",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","')'",233],";",["T_WHITESPACE","\n      ",233],"}",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n\n    ",235],["T_VARIABLE","$sql",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","\"CREATE TABLE {\"",237],["T_WHITESPACE"," ",237],".",["T_WHITESPACE"," ",237],["T_VARIABLE","$name",237],["T_WHITESPACE"," ",237],".",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","\"} (\\n\\t\"",237],";",["T_WHITESPACE","\n    ",237],["T_VARIABLE","$sql",238],["T_WHITESPACE"," ",238],["T_CONCAT_EQUAL",".=",238],["T_WHITESPACE"," ",238],["T_STRING","implode",238],"(",["T_CONSTANT_ENCAPSED_STRING","\",\\n\\t\"",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$sql_fields",238],")",";",["T_WHITESPACE","\n    ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_STRING","count",239],"(",["T_VARIABLE","$sql_keys",239],")",["T_WHITESPACE"," ",239],">",["T_WHITESPACE"," ",239],["T_LNUMBER","0",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n      ",239],["T_VARIABLE","$sql",240],["T_WHITESPACE"," ",240],["T_CONCAT_EQUAL",".=",240],["T_WHITESPACE"," ",240],["T_CONSTANT_ENCAPSED_STRING","\",\\n\\t\"",240],";",["T_WHITESPACE","\n    ",240],"}",["T_WHITESPACE","\n    ",241],["T_VARIABLE","$sql",242],["T_WHITESPACE"," ",242],["T_CONCAT_EQUAL",".=",242],["T_WHITESPACE"," ",242],["T_STRING","implode",242],"(",["T_CONSTANT_ENCAPSED_STRING","\",\\n\\t\"",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$sql_keys",242],")",";",["T_WHITESPACE","\n    ",242],["T_VARIABLE","$sql",243],["T_WHITESPACE"," ",243],["T_CONCAT_EQUAL",".=",243],["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","\"\\n)\"",243],";",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$statements",244],"[","]",["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$sql",244],";",["T_WHITESPACE","\n\n    ",244],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_ISSET","isset",246],"(",["T_VARIABLE","$table",246],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",246],"]",")",["T_WHITESPACE"," ",246],["T_BOOLEAN_AND","&&",246],["T_WHITESPACE"," ",246],["T_STRING","is_array",246],"(",["T_VARIABLE","$table",246],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",246],"]",")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n      ",246],["T_FOREACH","foreach",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$table",247],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",247],"]",["T_WHITESPACE"," ",247],["T_AS","as",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$key_name",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$key",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$statements",248],"[","]",["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_createIndexSql",248],"(",["T_VARIABLE","$name",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$key_name",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$key",248],")",";",["T_WHITESPACE","\n      ",248],"}",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_COMMENT","\/\/ Add table comment.\n",252],["T_WHITESPACE","    ",253],["T_IF","if",253],["T_WHITESPACE"," ",253],"(","!",["T_EMPTY","empty",253],"(",["T_VARIABLE","$table",253],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",253],"]",")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n      ",253],["T_VARIABLE","$statements",254],"[","]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'COMMENT ON TABLE {'",254],["T_WHITESPACE"," ",254],".",["T_WHITESPACE"," ",254],["T_VARIABLE","$name",254],["T_WHITESPACE"," ",254],".",["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'} IS '",254],["T_WHITESPACE"," ",254],".",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","prepareComment",254],"(",["T_VARIABLE","$table",254],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",254],"]",")",";",["T_WHITESPACE","\n    ",254],"}",["T_WHITESPACE","\n\n    ",255],["T_COMMENT","\/\/ Add column comments.\n",257],["T_WHITESPACE","    ",258],["T_FOREACH","foreach",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$table",258],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",258],"]",["T_WHITESPACE"," ",258],["T_AS","as",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$field_name",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$field",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n      ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","!",["T_EMPTY","empty",259],"(",["T_VARIABLE","$field",259],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",259],"]",")",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$statements",260],"[","]",["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","'COMMENT ON COLUMN {'",260],["T_WHITESPACE"," ",260],".",["T_WHITESPACE"," ",260],["T_VARIABLE","$name",260],["T_WHITESPACE"," ",260],".",["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","'}.'",260],["T_WHITESPACE"," ",260],".",["T_WHITESPACE"," ",260],["T_VARIABLE","$field_name",260],["T_WHITESPACE"," ",260],".",["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","' IS '",260],["T_WHITESPACE"," ",260],".",["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","prepareComment",260],"(",["T_VARIABLE","$field",260],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",260],"]",")",";",["T_WHITESPACE","\n      ",260],"}",["T_WHITESPACE","\n    ",261],"}",["T_WHITESPACE","\n\n    ",262],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$statements",264],";",["T_WHITESPACE","\n  ",264],"}",["T_WHITESPACE","\n\n  ",265],["T_DOC_COMMENT","\/**\n   * Create an SQL string for a field to be used in table creation or\n   * alteration.\n   *\n   * Before passing a field out of a schema definition into this\n   * function it has to be processed by _db_process_field().\n   *\n   * @param $name\n   *    Name of the field.\n   * @param $spec\n   *    The field specification, as per the schema data structure format.\n   *\/",267],["T_WHITESPACE","\n  ",278],["T_PROTECTED","protected",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","createFieldSql",279],"(",["T_VARIABLE","$name",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$spec",279],")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n    ",279],["T_COMMENT","\/\/ The PostgreSQL server converts names into lowercase, unless quoted.\n",280],["T_WHITESPACE","    ",281],["T_VARIABLE","$sql",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'\"'",281],["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_VARIABLE","$name",281],["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'\" '",281],["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_VARIABLE","$spec",281],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",281],"]",";",["T_WHITESPACE","\n\n    ",281],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_ISSET","isset",283],"(",["T_VARIABLE","$spec",283],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",283],"]",")",["T_WHITESPACE"," ",283],["T_BOOLEAN_AND","&&",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$spec",283],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",283],"]",["T_WHITESPACE"," ",283],["T_IS_EQUAL","==",283],["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","'serial'",283],")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n      ",283],["T_UNSET","unset",284],"(",["T_VARIABLE","$spec",284],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",284],"]",")",";",["T_WHITESPACE","\n    ",284],"}",["T_WHITESPACE","\n\n    ",285],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_STRING","in_array",287],"(",["T_VARIABLE","$spec",287],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",287],"]",",",["T_WHITESPACE"," ",287],["T_ARRAY","array",287],"(",["T_CONSTANT_ENCAPSED_STRING","'varchar'",287],",",["T_WHITESPACE"," ",287],["T_CONSTANT_ENCAPSED_STRING","'character'",287],")",")",["T_WHITESPACE"," ",287],["T_BOOLEAN_AND","&&",287],["T_WHITESPACE"," ",287],["T_ISSET","isset",287],"(",["T_VARIABLE","$spec",287],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",287],"]",")",")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n      ",287],["T_VARIABLE","$sql",288],["T_WHITESPACE"," ",288],["T_CONCAT_EQUAL",".=",288],["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'('",288],["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_VARIABLE","$spec",288],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",288],"]",["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","')'",288],";",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n    ",289],["T_ELSEIF","elseif",290],["T_WHITESPACE"," ",290],"(",["T_ISSET","isset",290],"(",["T_VARIABLE","$spec",290],"[",["T_CONSTANT_ENCAPSED_STRING","'precision'",290],"]",")",["T_WHITESPACE"," ",290],["T_BOOLEAN_AND","&&",290],["T_WHITESPACE"," ",290],["T_ISSET","isset",290],"(",["T_VARIABLE","$spec",290],"[",["T_CONSTANT_ENCAPSED_STRING","'scale'",290],"]",")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n      ",290],["T_VARIABLE","$sql",291],["T_WHITESPACE"," ",291],["T_CONCAT_EQUAL",".=",291],["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'('",291],["T_WHITESPACE"," ",291],".",["T_WHITESPACE"," ",291],["T_VARIABLE","$spec",291],"[",["T_CONSTANT_ENCAPSED_STRING","'precision'",291],"]",["T_WHITESPACE"," ",291],".",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","', '",291],["T_WHITESPACE"," ",291],".",["T_WHITESPACE"," ",291],["T_VARIABLE","$spec",291],"[",["T_CONSTANT_ENCAPSED_STRING","'scale'",291],"]",["T_WHITESPACE"," ",291],".",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","')'",291],";",["T_WHITESPACE","\n    ",291],"}",["T_WHITESPACE","\n\n    ",292],["T_IF","if",294],["T_WHITESPACE"," ",294],"(","!",["T_EMPTY","empty",294],"(",["T_VARIABLE","$spec",294],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",294],"]",")",")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n      ",294],["T_VARIABLE","$sql",295],["T_WHITESPACE"," ",295],["T_CONCAT_EQUAL",".=",295],["T_WHITESPACE"," ",295],"\"",["T_ENCAPSED_AND_WHITESPACE"," CHECK (",295],["T_VARIABLE","$name",295],["T_ENCAPSED_AND_WHITESPACE"," >= 0)",295],"\"",";",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_IF","if",298],["T_WHITESPACE"," ",298],"(",["T_ISSET","isset",298],"(",["T_VARIABLE","$spec",298],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",298],"]",")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n      ",298],["T_IF","if",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$spec",299],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",299],"]",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n        ",299],["T_VARIABLE","$sql",300],["T_WHITESPACE"," ",300],["T_CONCAT_EQUAL",".=",300],["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","' NOT NULL'",300],";",["T_WHITESPACE","\n      ",300],"}",["T_WHITESPACE","\n      ",301],["T_ELSE","else",302],["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$sql",303],["T_WHITESPACE"," ",303],["T_CONCAT_EQUAL",".=",303],["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","' NULL'",303],";",["T_WHITESPACE","\n      ",303],"}",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n    ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_STRING","array_key_exists",306],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$spec",306],")",")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n      ",306],["T_VARIABLE","$default",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","escapeDefaultValue",307],"(",["T_VARIABLE","$spec",307],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",307],"]",")",";",["T_WHITESPACE","\n      ",307],["T_VARIABLE","$sql",308],["T_WHITESPACE"," ",308],["T_CONCAT_EQUAL",".=",308],["T_WHITESPACE"," ",308],"\"",["T_ENCAPSED_AND_WHITESPACE"," default ",308],["T_VARIABLE","$default",308],"\"",";",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$sql",311],";",["T_WHITESPACE","\n  ",311],"}",["T_WHITESPACE","\n\n  ",312],["T_DOC_COMMENT","\/**\n   * Set database-engine specific properties for a field.\n   *\n   * @param $field\n   *   A field description array, as specified in the schema documentation.\n   *\/",314],["T_WHITESPACE","\n  ",319],["T_PROTECTED","protected",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","processField",320],"(",["T_VARIABLE","$field",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n    ",320],["T_IF","if",321],["T_WHITESPACE"," ",321],"(","!",["T_ISSET","isset",321],"(",["T_VARIABLE","$field",321],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",321],"]",")",")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n      ",321],["T_VARIABLE","$field",322],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",322],"]",["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'normal'",322],";",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n\n    ",323],["T_COMMENT","\/\/ Set the correct database-engine specific datatype.\n",325],["T_WHITESPACE","    ",326],["T_COMMENT","\/\/ In case one is already provided, force it to lowercase.\n",326],["T_WHITESPACE","    ",327],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_ISSET","isset",327],"(",["T_VARIABLE","$field",327],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",327],"]",")",")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n      ",327],["T_VARIABLE","$field",328],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",328],"]",["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_STRING","Unicode",328],["T_DOUBLE_COLON","::",328],["T_STRING","strtolower",328],"(",["T_VARIABLE","$field",328],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",328],"]",")",";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n    ",329],["T_ELSE","else",330],["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n      ",330],["T_VARIABLE","$map",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getFieldTypeMap",331],"(",")",";",["T_WHITESPACE","\n      ",331],["T_VARIABLE","$field",332],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",332],"]",["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$map",332],"[",["T_VARIABLE","$field",332],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",332],"]",["T_WHITESPACE"," ",332],".",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","':'",332],["T_WHITESPACE"," ",332],".",["T_WHITESPACE"," ",332],["T_VARIABLE","$field",332],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",332],"]","]",";",["T_WHITESPACE","\n    ",332],"}",["T_WHITESPACE","\n\n    ",333],["T_IF","if",335],["T_WHITESPACE"," ",335],"(","!",["T_EMPTY","empty",335],"(",["T_VARIABLE","$field",335],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",335],"]",")",")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n      ",335],["T_COMMENT","\/\/ Unsigned datatypes are not supported in PostgreSQL 9.1. In MySQL,\n",336],["T_WHITESPACE","      ",337],["T_COMMENT","\/\/ they are used to ensure a positive number is inserted and it also\n",337],["T_WHITESPACE","      ",338],["T_COMMENT","\/\/ doubles the maximum integer size that can be stored in a field.\n",338],["T_WHITESPACE","      ",339],["T_COMMENT","\/\/ The PostgreSQL schema in Drupal creates a check constraint\n",339],["T_WHITESPACE","      ",340],["T_COMMENT","\/\/ to ensure that a value inserted is >= 0. To provide the extra\n",340],["T_WHITESPACE","      ",341],["T_COMMENT","\/\/ integer capacity, here, we bump up the column field size.\n",341],["T_WHITESPACE","      ",342],["T_IF","if",342],["T_WHITESPACE"," ",342],"(","!",["T_ISSET","isset",342],"(",["T_VARIABLE","$map",342],")",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n        ",342],["T_VARIABLE","$map",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getFieldTypeMap",343],"(",")",";",["T_WHITESPACE","\n      ",343],"}",["T_WHITESPACE","\n      ",344],["T_SWITCH","switch",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$field",345],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",345],"]",")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n        ",345],["T_CASE","case",346],["T_WHITESPACE"," ",346],["T_CONSTANT_ENCAPSED_STRING","'smallint'",346],":",["T_WHITESPACE","\n          ",346],["T_VARIABLE","$field",347],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",347],"]",["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$map",347],"[",["T_CONSTANT_ENCAPSED_STRING","'int:medium'",347],"]",";",["T_WHITESPACE","\n          ",347],["T_BREAK","break",348],";",["T_WHITESPACE","\n        ",348],["T_CASE","case",349],["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'int'",349],["T_WHITESPACE"," ",349],":",["T_WHITESPACE","\n          ",349],["T_VARIABLE","$field",350],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",350],"]",["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$map",350],"[",["T_CONSTANT_ENCAPSED_STRING","'int:big'",350],"]",";",["T_WHITESPACE","\n          ",350],["T_BREAK","break",351],";",["T_WHITESPACE","\n      ",351],"}",["T_WHITESPACE","\n    ",352],"}",["T_WHITESPACE","\n    ",353],["T_IF","if",354],["T_WHITESPACE"," ",354],"(",["T_ISSET","isset",354],"(",["T_VARIABLE","$field",354],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",354],"]",")",["T_WHITESPACE"," ",354],["T_BOOLEAN_AND","&&",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$field",354],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",354],"]",["T_WHITESPACE"," ",354],["T_IS_EQUAL","==",354],["T_WHITESPACE"," ",354],["T_CONSTANT_ENCAPSED_STRING","'serial'",354],")",["T_WHITESPACE"," ",354],"{",["T_WHITESPACE","\n      ",354],["T_UNSET","unset",355],"(",["T_VARIABLE","$field",355],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",355],"]",")",";",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n    ",356],["T_RETURN","return",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$field",357],";",["T_WHITESPACE","\n  ",357],"}",["T_WHITESPACE","\n\n  ",358],["T_DOC_COMMENT","\/**\n   * This maps a generic data type in combination with its data size\n   * to the engine-specific data type.\n   *\/",360],["T_WHITESPACE","\n  ",363],["T_FUNCTION","function",364],["T_WHITESPACE"," ",364],["T_STRING","getFieldTypeMap",364],"(",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n    ",364],["T_COMMENT","\/\/ Put :normal last so it gets preserved by array_flip. This makes\n",365],["T_WHITESPACE","    ",366],["T_COMMENT","\/\/ it much easier for modules (such as schema.module) to map\n",366],["T_WHITESPACE","    ",367],["T_COMMENT","\/\/ database types back into schema types.\n",367],["T_WHITESPACE","    ",368],["T_COMMENT","\/\/ $map does not use drupal_static as its value never changes.\n",368],["T_WHITESPACE","    ",369],["T_STATIC","static",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$map",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_ARRAY","array",369],"(",["T_WHITESPACE","\n      ",369],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii:normal'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'varchar'",370],",",["T_WHITESPACE","\n\n      ",370],["T_CONSTANT_ENCAPSED_STRING","'varchar:normal'",372],["T_WHITESPACE"," ",372],["T_DOUBLE_ARROW","=>",372],["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'varchar'",372],",",["T_WHITESPACE","\n      ",372],["T_CONSTANT_ENCAPSED_STRING","'char:normal'",373],["T_WHITESPACE"," ",373],["T_DOUBLE_ARROW","=>",373],["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'character'",373],",",["T_WHITESPACE","\n\n      ",373],["T_CONSTANT_ENCAPSED_STRING","'text:tiny'",375],["T_WHITESPACE"," ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],["T_CONSTANT_ENCAPSED_STRING","'text'",375],",",["T_WHITESPACE","\n      ",375],["T_CONSTANT_ENCAPSED_STRING","'text:small'",376],["T_WHITESPACE"," ",376],["T_DOUBLE_ARROW","=>",376],["T_WHITESPACE"," ",376],["T_CONSTANT_ENCAPSED_STRING","'text'",376],",",["T_WHITESPACE","\n      ",376],["T_CONSTANT_ENCAPSED_STRING","'text:medium'",377],["T_WHITESPACE"," ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],["T_CONSTANT_ENCAPSED_STRING","'text'",377],",",["T_WHITESPACE","\n      ",377],["T_CONSTANT_ENCAPSED_STRING","'text:big'",378],["T_WHITESPACE"," ",378],["T_DOUBLE_ARROW","=>",378],["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'text'",378],",",["T_WHITESPACE","\n      ",378],["T_CONSTANT_ENCAPSED_STRING","'text:normal'",379],["T_WHITESPACE"," ",379],["T_DOUBLE_ARROW","=>",379],["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","'text'",379],",",["T_WHITESPACE","\n\n      ",379],["T_CONSTANT_ENCAPSED_STRING","'int:tiny'",381],["T_WHITESPACE"," ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_CONSTANT_ENCAPSED_STRING","'smallint'",381],",",["T_WHITESPACE","\n      ",381],["T_CONSTANT_ENCAPSED_STRING","'int:small'",382],["T_WHITESPACE"," ",382],["T_DOUBLE_ARROW","=>",382],["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'smallint'",382],",",["T_WHITESPACE","\n      ",382],["T_CONSTANT_ENCAPSED_STRING","'int:medium'",383],["T_WHITESPACE"," ",383],["T_DOUBLE_ARROW","=>",383],["T_WHITESPACE"," ",383],["T_CONSTANT_ENCAPSED_STRING","'int'",383],",",["T_WHITESPACE","\n      ",383],["T_CONSTANT_ENCAPSED_STRING","'int:big'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'bigint'",384],",",["T_WHITESPACE","\n      ",384],["T_CONSTANT_ENCAPSED_STRING","'int:normal'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_CONSTANT_ENCAPSED_STRING","'int'",385],",",["T_WHITESPACE","\n\n      ",385],["T_CONSTANT_ENCAPSED_STRING","'float:tiny'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_CONSTANT_ENCAPSED_STRING","'real'",387],",",["T_WHITESPACE","\n      ",387],["T_CONSTANT_ENCAPSED_STRING","'float:small'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_CONSTANT_ENCAPSED_STRING","'real'",388],",",["T_WHITESPACE","\n      ",388],["T_CONSTANT_ENCAPSED_STRING","'float:medium'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_CONSTANT_ENCAPSED_STRING","'real'",389],",",["T_WHITESPACE","\n      ",389],["T_CONSTANT_ENCAPSED_STRING","'float:big'",390],["T_WHITESPACE"," ",390],["T_DOUBLE_ARROW","=>",390],["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'double precision'",390],",",["T_WHITESPACE","\n      ",390],["T_CONSTANT_ENCAPSED_STRING","'float:normal'",391],["T_WHITESPACE"," ",391],["T_DOUBLE_ARROW","=>",391],["T_WHITESPACE"," ",391],["T_CONSTANT_ENCAPSED_STRING","'real'",391],",",["T_WHITESPACE","\n\n      ",391],["T_CONSTANT_ENCAPSED_STRING","'numeric:normal'",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_CONSTANT_ENCAPSED_STRING","'numeric'",393],",",["T_WHITESPACE","\n\n      ",393],["T_CONSTANT_ENCAPSED_STRING","'blob:big'",395],["T_WHITESPACE"," ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_CONSTANT_ENCAPSED_STRING","'bytea'",395],",",["T_WHITESPACE","\n      ",395],["T_CONSTANT_ENCAPSED_STRING","'blob:normal'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_CONSTANT_ENCAPSED_STRING","'bytea'",396],",",["T_WHITESPACE","\n\n      ",396],["T_CONSTANT_ENCAPSED_STRING","'serial:tiny'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_CONSTANT_ENCAPSED_STRING","'serial'",398],",",["T_WHITESPACE","\n      ",398],["T_CONSTANT_ENCAPSED_STRING","'serial:small'",399],["T_WHITESPACE"," ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],["T_CONSTANT_ENCAPSED_STRING","'serial'",399],",",["T_WHITESPACE","\n      ",399],["T_CONSTANT_ENCAPSED_STRING","'serial:medium'",400],["T_WHITESPACE"," ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],["T_CONSTANT_ENCAPSED_STRING","'serial'",400],",",["T_WHITESPACE","\n      ",400],["T_CONSTANT_ENCAPSED_STRING","'serial:big'",401],["T_WHITESPACE"," ",401],["T_DOUBLE_ARROW","=>",401],["T_WHITESPACE"," ",401],["T_CONSTANT_ENCAPSED_STRING","'bigserial'",401],",",["T_WHITESPACE","\n      ",401],["T_CONSTANT_ENCAPSED_STRING","'serial:normal'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'serial'",402],",",["T_WHITESPACE","\n      ",402],")",";",["T_WHITESPACE","\n    ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$map",404],";",["T_WHITESPACE","\n  ",404],"}",["T_WHITESPACE","\n\n  ",405],["T_PROTECTED","protected",407],["T_WHITESPACE"," ",407],["T_FUNCTION","function",407],["T_WHITESPACE"," ",407],["T_STRING","_createKeySql",407],"(",["T_VARIABLE","$fields",407],")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n    ",407],["T_VARIABLE","$return",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_ARRAY","array",408],"(",")",";",["T_WHITESPACE","\n    ",408],["T_FOREACH","foreach",409],["T_WHITESPACE"," ",409],"(",["T_VARIABLE","$fields",409],["T_WHITESPACE"," ",409],["T_AS","as",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$field",409],")",["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n      ",409],["T_IF","if",410],["T_WHITESPACE"," ",410],"(",["T_STRING","is_array",410],"(",["T_VARIABLE","$field",410],")",")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n        ",410],["T_VARIABLE","$return",411],"[","]",["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_CONSTANT_ENCAPSED_STRING","'substr('",411],["T_WHITESPACE"," ",411],".",["T_WHITESPACE"," ",411],["T_VARIABLE","$field",411],"[",["T_LNUMBER","0",411],"]",["T_WHITESPACE"," ",411],".",["T_WHITESPACE"," ",411],["T_CONSTANT_ENCAPSED_STRING","', 1, '",411],["T_WHITESPACE"," ",411],".",["T_WHITESPACE"," ",411],["T_VARIABLE","$field",411],"[",["T_LNUMBER","1",411],"]",["T_WHITESPACE"," ",411],".",["T_WHITESPACE"," ",411],["T_CONSTANT_ENCAPSED_STRING","')'",411],";",["T_WHITESPACE","\n      ",411],"}",["T_WHITESPACE","\n      ",412],["T_ELSE","else",413],["T_WHITESPACE"," ",413],"{",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$return",414],"[","]",["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_CONSTANT_ENCAPSED_STRING","'\"'",414],["T_WHITESPACE"," ",414],".",["T_WHITESPACE"," ",414],["T_VARIABLE","$field",414],["T_WHITESPACE"," ",414],".",["T_WHITESPACE"," ",414],["T_CONSTANT_ENCAPSED_STRING","'\"'",414],";",["T_WHITESPACE","\n      ",414],"}",["T_WHITESPACE","\n    ",415],"}",["T_WHITESPACE","\n    ",416],["T_RETURN","return",417],["T_WHITESPACE"," ",417],["T_STRING","implode",417],"(",["T_CONSTANT_ENCAPSED_STRING","', '",417],",",["T_WHITESPACE"," ",417],["T_VARIABLE","$return",417],")",";",["T_WHITESPACE","\n  ",417],"}",["T_WHITESPACE","\n\n  ",418],["T_DOC_COMMENT","\/**\n   * Create the SQL expression for primary keys.\n   *\n   * Postgresql does not support key length. It does support fillfactor, but\n   * that requires a separate database lookup for each column in the key. The\n   * key length defined in the schema is ignored.\n   *\/",420],["T_WHITESPACE","\n  ",426],["T_PROTECTED","protected",427],["T_WHITESPACE"," ",427],["T_FUNCTION","function",427],["T_WHITESPACE"," ",427],["T_STRING","createPrimaryKeySql",427],"(",["T_VARIABLE","$fields",427],")",["T_WHITESPACE"," ",427],"{",["T_WHITESPACE","\n    ",427],["T_VARIABLE","$return",428],["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_ARRAY","array",428],"(",")",";",["T_WHITESPACE","\n    ",428],["T_FOREACH","foreach",429],["T_WHITESPACE"," ",429],"(",["T_VARIABLE","$fields",429],["T_WHITESPACE"," ",429],["T_AS","as",429],["T_WHITESPACE"," ",429],["T_VARIABLE","$field",429],")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n      ",429],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_STRING","is_array",430],"(",["T_VARIABLE","$field",430],")",")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n        ",430],["T_VARIABLE","$return",431],"[","]",["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'\"'",431],["T_WHITESPACE"," ",431],".",["T_WHITESPACE"," ",431],["T_VARIABLE","$field",431],"[",["T_LNUMBER","0",431],"]",["T_WHITESPACE"," ",431],".",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'\"'",431],";",["T_WHITESPACE","\n      ",431],"}",["T_WHITESPACE","\n      ",432],["T_ELSE","else",433],["T_WHITESPACE"," ",433],"{",["T_WHITESPACE","\n        ",433],["T_VARIABLE","$return",434],"[","]",["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_CONSTANT_ENCAPSED_STRING","'\"'",434],["T_WHITESPACE"," ",434],".",["T_WHITESPACE"," ",434],["T_VARIABLE","$field",434],["T_WHITESPACE"," ",434],".",["T_WHITESPACE"," ",434],["T_CONSTANT_ENCAPSED_STRING","'\"'",434],";",["T_WHITESPACE","\n      ",434],"}",["T_WHITESPACE","\n    ",435],"}",["T_WHITESPACE","\n    ",436],["T_RETURN","return",437],["T_WHITESPACE"," ",437],["T_STRING","implode",437],"(",["T_CONSTANT_ENCAPSED_STRING","', '",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$return",437],")",";",["T_WHITESPACE","\n  ",437],"}",["T_WHITESPACE","\n\n  ",438],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",440],["T_WHITESPACE","\n  ",442],["T_PUBLIC","public",443],["T_WHITESPACE"," ",443],["T_FUNCTION","function",443],["T_WHITESPACE"," ",443],["T_STRING","tableExists",443],"(",["T_VARIABLE","$table",443],")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n    ",443],["T_VARIABLE","$prefixInfo",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getPrefixInfo",444],"(",["T_VARIABLE","$table",444],",",["T_WHITESPACE"," ",444],["T_STRING","TRUE",444],")",";",["T_WHITESPACE","\n\n    ",444],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_BOOL_CAST","(bool)",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","connection",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","query",446],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT 1 FROM pg_tables WHERE schemaname = :schema AND tablename = :table\"",446],",",["T_WHITESPACE"," ",446],["T_ARRAY","array",446],"(",["T_CONSTANT_ENCAPSED_STRING","':schema'",446],["T_WHITESPACE"," ",446],["T_DOUBLE_ARROW","=>",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$prefixInfo",446],"[",["T_CONSTANT_ENCAPSED_STRING","'schema'",446],"]",",",["T_WHITESPACE"," ",446],["T_CONSTANT_ENCAPSED_STRING","':table'",446],["T_WHITESPACE"," ",446],["T_DOUBLE_ARROW","=>",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$prefixInfo",446],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",446],"]",")",")",["T_OBJECT_OPERATOR","->",446],["T_STRING","fetchField",446],"(",")",";",["T_WHITESPACE","\n  ",446],"}",["T_WHITESPACE","\n\n  ",447],["T_FUNCTION","function",449],["T_WHITESPACE"," ",449],["T_STRING","renameTable",449],"(",["T_VARIABLE","$table",449],",",["T_WHITESPACE"," ",449],["T_VARIABLE","$new_name",449],")",["T_WHITESPACE"," ",449],"{",["T_WHITESPACE","\n    ",449],["T_IF","if",450],["T_WHITESPACE"," ",450],"(","!",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","tableExists",450],"(",["T_VARIABLE","$table",450],")",")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n      ",450],["T_THROW","throw",451],["T_WHITESPACE"," ",451],["T_NEW","new",451],["T_WHITESPACE"," ",451],["T_STRING","SchemaObjectDoesNotExistException",451],"(",["T_STRING","t",451],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot rename @table to @table_new: table @table doesn't exist.\"",451],",",["T_WHITESPACE"," ",451],["T_ARRAY","array",451],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",451],["T_WHITESPACE"," ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_VARIABLE","$table",451],",",["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","'@table_new'",451],["T_WHITESPACE"," ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_VARIABLE","$new_name",451],")",")",")",";",["T_WHITESPACE","\n    ",451],"}",["T_WHITESPACE","\n    ",452],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","tableExists",453],"(",["T_VARIABLE","$new_name",453],")",")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n      ",453],["T_THROW","throw",454],["T_WHITESPACE"," ",454],["T_NEW","new",454],["T_WHITESPACE"," ",454],["T_STRING","SchemaObjectExistsException",454],"(",["T_STRING","t",454],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot rename @table to @table_new: table @table_new already exists.\"",454],",",["T_WHITESPACE"," ",454],["T_ARRAY","array",454],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",454],["T_WHITESPACE"," ",454],["T_DOUBLE_ARROW","=>",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$table",454],",",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'@table_new'",454],["T_WHITESPACE"," ",454],["T_DOUBLE_ARROW","=>",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$new_name",454],")",")",")",";",["T_WHITESPACE","\n    ",454],"}",["T_WHITESPACE","\n\n    ",455],["T_COMMENT","\/\/ Get the schema and tablename for the old table.\n",457],["T_WHITESPACE","    ",458],["T_VARIABLE","$old_full_name",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","connection",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","prefixTables",458],"(",["T_CONSTANT_ENCAPSED_STRING","'{'",458],["T_WHITESPACE"," ",458],".",["T_WHITESPACE"," ",458],["T_VARIABLE","$table",458],["T_WHITESPACE"," ",458],".",["T_WHITESPACE"," ",458],["T_CONSTANT_ENCAPSED_STRING","'}'",458],")",";",["T_WHITESPACE","\n    ",458],["T_LIST","list",459],"(",["T_VARIABLE","$old_schema",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$old_table_name",459],")",["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_STRING","strpos",459],"(",["T_VARIABLE","$old_full_name",459],",",["T_WHITESPACE"," ",459],["T_CONSTANT_ENCAPSED_STRING","'.'",459],")",["T_WHITESPACE"," ",459],"?",["T_WHITESPACE"," ",459],["T_STRING","explode",459],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$old_full_name",459],")",["T_WHITESPACE"," ",459],":",["T_WHITESPACE"," ",459],["T_ARRAY","array",459],"(",["T_CONSTANT_ENCAPSED_STRING","'public'",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$old_full_name",459],")",";",["T_WHITESPACE","\n\n    ",459],["T_COMMENT","\/\/ Index names and constraint names are global in PostgreSQL, so we need to\n",461],["T_WHITESPACE","    ",462],["T_COMMENT","\/\/ rename them when renaming the table.\n",462],["T_WHITESPACE","    ",463],["T_VARIABLE","$indexes",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","connection",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","query",463],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT indexname FROM pg_indexes WHERE schemaname = :schema AND tablename = :table'",463],",",["T_WHITESPACE"," ",463],["T_ARRAY","array",463],"(",["T_CONSTANT_ENCAPSED_STRING","':schema'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$old_schema",463],",",["T_WHITESPACE"," ",463],["T_CONSTANT_ENCAPSED_STRING","':table'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$old_table_name",463],")",")",";",["T_WHITESPACE","\n\n    ",463],["T_FOREACH","foreach",465],["T_WHITESPACE"," ",465],"(",["T_VARIABLE","$indexes",465],["T_WHITESPACE"," ",465],["T_AS","as",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$index",465],")",["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n      ",465],["T_COMMENT","\/\/ Get the index type by suffix, e.g. idx\/key\/pkey\n",466],["T_WHITESPACE","      ",467],["T_VARIABLE","$index_type",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_STRING","substr",467],"(",["T_VARIABLE","$index",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","indexname",467],",",["T_WHITESPACE"," ",467],["T_STRING","strrpos",467],"(",["T_VARIABLE","$index",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","indexname",467],",",["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","'_'",467],")",["T_WHITESPACE"," ",467],"+",["T_WHITESPACE"," ",467],["T_LNUMBER","1",467],")",";",["T_WHITESPACE","\n\n      ",467],["T_COMMENT","\/\/ If the index is already rewritten by ensureIdentifiersLength() to not\n",469],["T_WHITESPACE","      ",470],["T_COMMENT","\/\/ exceed the 63 chars limit of PostgreSQL, we need to take care of that.\n",470],["T_WHITESPACE","      ",471],["T_COMMENT","\/\/ Example (drupal_Gk7Su_T1jcBHVuvSPeP22_I3Ni4GrVEgTYlIYnBJkro_idx).\n",471],["T_WHITESPACE","      ",472],["T_IF","if",472],["T_WHITESPACE"," ",472],"(",["T_STRING","strpos",472],"(",["T_VARIABLE","$index",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","indexname",472],",",["T_WHITESPACE"," ",472],["T_CONSTANT_ENCAPSED_STRING","'drupal_'",472],")",["T_WHITESPACE"," ",472],["T_IS_NOT_IDENTICAL","!==",472],["T_WHITESPACE"," ",472],["T_STRING","FALSE",472],")",["T_WHITESPACE"," ",472],"{",["T_WHITESPACE","\n        ",472],["T_STRING","preg_match",473],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^drupal_(.*)_'",473],["T_WHITESPACE"," ",473],".",["T_WHITESPACE"," ",473],["T_STRING","preg_quote",473],"(",["T_VARIABLE","$index_type",473],")",["T_WHITESPACE"," ",473],".",["T_WHITESPACE"," ",473],["T_CONSTANT_ENCAPSED_STRING","'\/'",473],",",["T_WHITESPACE"," ",473],["T_VARIABLE","$index",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","indexname",473],",",["T_WHITESPACE"," ",473],["T_VARIABLE","$matches",473],")",";",["T_WHITESPACE","\n        ",473],["T_VARIABLE","$index_name",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_VARIABLE","$matches",474],"[",["T_LNUMBER","1",474],"]",";",["T_WHITESPACE","\n      ",474],"}",["T_WHITESPACE","\n      ",475],["T_ELSE","else",476],["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n        ",476],["T_COMMENT","\/\/ Make sure to remove the suffix from index names, because\n",477],["T_WHITESPACE","        ",478],["T_COMMENT","\/\/ $this->ensureIdentifiersLength() will add the suffix again and thus\n",478],["T_WHITESPACE","        ",479],["T_COMMENT","\/\/ would result in a wrong index name.\n",479],["T_WHITESPACE","        ",480],["T_STRING","preg_match",480],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^'",480],["T_WHITESPACE"," ",480],".",["T_WHITESPACE"," ",480],["T_STRING","preg_quote",480],"(",["T_VARIABLE","$old_full_name",480],")",["T_WHITESPACE"," ",480],".",["T_WHITESPACE"," ",480],["T_CONSTANT_ENCAPSED_STRING","'__(.*)__'",480],["T_WHITESPACE"," ",480],".",["T_WHITESPACE"," ",480],["T_STRING","preg_quote",480],"(",["T_VARIABLE","$index_type",480],")",["T_WHITESPACE"," ",480],".",["T_WHITESPACE"," ",480],["T_CONSTANT_ENCAPSED_STRING","'\/'",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$index",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","indexname",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$matches",480],")",";",["T_WHITESPACE","\n        ",480],["T_VARIABLE","$index_name",481],["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_VARIABLE","$matches",481],"[",["T_LNUMBER","1",481],"]",";",["T_WHITESPACE","\n      ",481],"}",["T_WHITESPACE","\n      ",482],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","connection",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","query",483],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER INDEX \"'",483],["T_WHITESPACE"," ",483],".",["T_WHITESPACE"," ",483],["T_VARIABLE","$index",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","indexname",483],["T_WHITESPACE"," ",483],".",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'\" RENAME TO '",483],["T_WHITESPACE"," ",483],".",["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","ensureIdentifiersLength",483],"(",["T_VARIABLE","$new_name",483],",",["T_WHITESPACE"," ",483],["T_VARIABLE","$index_name",483],",",["T_WHITESPACE"," ",483],["T_VARIABLE","$index_type",483],")",["T_WHITESPACE"," ",483],".",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","''",483],")",";",["T_WHITESPACE","\n    ",483],"}",["T_WHITESPACE","\n\n    ",484],["T_COMMENT","\/\/ Ensure the new table name does not include schema syntax.\n",486],["T_WHITESPACE","    ",487],["T_VARIABLE","$prefixInfo",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","getPrefixInfo",487],"(",["T_VARIABLE","$new_name",487],")",";",["T_WHITESPACE","\n\n    ",487],["T_COMMENT","\/\/ Rename sequences if there's a serial fields.\n",489],["T_WHITESPACE","    ",490],["T_VARIABLE","$info",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","queryTableInformation",490],"(",["T_VARIABLE","$table",490],")",";",["T_WHITESPACE","\n    ",490],["T_IF","if",491],["T_WHITESPACE"," ",491],"(","!",["T_EMPTY","empty",491],"(",["T_VARIABLE","$info",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","serial_fields",491],")",")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n      ",491],["T_FOREACH","foreach",492],["T_WHITESPACE"," ",492],"(",["T_VARIABLE","$info",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","serial_fields",492],["T_WHITESPACE"," ",492],["T_AS","as",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$field",492],")",["T_WHITESPACE"," ",492],"{",["T_WHITESPACE","\n        ",492],["T_VARIABLE","$old_sequence",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","prefixNonTable",493],"(",["T_VARIABLE","$table",493],",",["T_WHITESPACE"," ",493],["T_VARIABLE","$field",493],",",["T_WHITESPACE"," ",493],["T_CONSTANT_ENCAPSED_STRING","'seq'",493],")",";",["T_WHITESPACE","\n        ",493],["T_VARIABLE","$new_sequence",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","prefixNonTable",494],"(",["T_VARIABLE","$new_name",494],",",["T_WHITESPACE"," ",494],["T_VARIABLE","$field",494],",",["T_WHITESPACE"," ",494],["T_CONSTANT_ENCAPSED_STRING","'seq'",494],")",";",["T_WHITESPACE","\n        ",494],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","connection",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","query",495],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER SEQUENCE '",495],["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_VARIABLE","$old_sequence",495],["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","' RENAME TO '",495],["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_VARIABLE","$new_sequence",495],")",";",["T_WHITESPACE","\n      ",495],"}",["T_WHITESPACE","\n    ",496],"}",["T_WHITESPACE","\n    ",497],["T_COMMENT","\/\/ Now rename the table.\n",498],["T_WHITESPACE","    ",499],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","connection",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","query",499],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",499],["T_WHITESPACE"," ",499],".",["T_WHITESPACE"," ",499],["T_VARIABLE","$table",499],["T_WHITESPACE"," ",499],".",["T_WHITESPACE"," ",499],["T_CONSTANT_ENCAPSED_STRING","'} RENAME TO '",499],["T_WHITESPACE"," ",499],".",["T_WHITESPACE"," ",499],["T_VARIABLE","$prefixInfo",499],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",499],"]",")",";",["T_WHITESPACE","\n    ",499],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","resetTableInformation",500],"(",["T_VARIABLE","$table",500],")",";",["T_WHITESPACE","\n  ",500],"}",["T_WHITESPACE","\n\n  ",501],["T_PUBLIC","public",503],["T_WHITESPACE"," ",503],["T_FUNCTION","function",503],["T_WHITESPACE"," ",503],["T_STRING","dropTable",503],"(",["T_VARIABLE","$table",503],")",["T_WHITESPACE"," ",503],"{",["T_WHITESPACE","\n    ",503],["T_IF","if",504],["T_WHITESPACE"," ",504],"(","!",["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","tableExists",504],"(",["T_VARIABLE","$table",504],")",")",["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n      ",504],["T_RETURN","return",505],["T_WHITESPACE"," ",505],["T_STRING","FALSE",505],";",["T_WHITESPACE","\n    ",505],"}",["T_WHITESPACE","\n\n    ",506],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","connection",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","query",508],"(",["T_CONSTANT_ENCAPSED_STRING","'DROP TABLE {'",508],["T_WHITESPACE"," ",508],".",["T_WHITESPACE"," ",508],["T_VARIABLE","$table",508],["T_WHITESPACE"," ",508],".",["T_WHITESPACE"," ",508],["T_CONSTANT_ENCAPSED_STRING","'}'",508],")",";",["T_WHITESPACE","\n    ",508],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","resetTableInformation",509],"(",["T_VARIABLE","$table",509],")",";",["T_WHITESPACE","\n    ",509],["T_RETURN","return",510],["T_WHITESPACE"," ",510],["T_STRING","TRUE",510],";",["T_WHITESPACE","\n  ",510],"}",["T_WHITESPACE","\n\n  ",511],["T_PUBLIC","public",513],["T_WHITESPACE"," ",513],["T_FUNCTION","function",513],["T_WHITESPACE"," ",513],["T_STRING","addField",513],"(",["T_VARIABLE","$table",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$field",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$spec",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$new_keys",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_ARRAY","array",513],"(",")",")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n    ",513],["T_IF","if",514],["T_WHITESPACE"," ",514],"(","!",["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","tableExists",514],"(",["T_VARIABLE","$table",514],")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n      ",514],["T_THROW","throw",515],["T_WHITESPACE"," ",515],["T_NEW","new",515],["T_WHITESPACE"," ",515],["T_STRING","SchemaObjectDoesNotExistException",515],"(",["T_STRING","t",515],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add field @table.@field: table doesn't exist.\"",515],",",["T_WHITESPACE"," ",515],["T_ARRAY","array",515],"(",["T_CONSTANT_ENCAPSED_STRING","'@field'",515],["T_WHITESPACE"," ",515],["T_DOUBLE_ARROW","=>",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$field",515],",",["T_WHITESPACE"," ",515],["T_CONSTANT_ENCAPSED_STRING","'@table'",515],["T_WHITESPACE"," ",515],["T_DOUBLE_ARROW","=>",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$table",515],")",")",")",";",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n    ",516],["T_IF","if",517],["T_WHITESPACE"," ",517],"(",["T_VARIABLE","$this",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","fieldExists",517],"(",["T_VARIABLE","$table",517],",",["T_WHITESPACE"," ",517],["T_VARIABLE","$field",517],")",")",["T_WHITESPACE"," ",517],"{",["T_WHITESPACE","\n      ",517],["T_THROW","throw",518],["T_WHITESPACE"," ",518],["T_NEW","new",518],["T_WHITESPACE"," ",518],["T_STRING","SchemaObjectExistsException",518],"(",["T_STRING","t",518],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add field @table.@field: field already exists.\"",518],",",["T_WHITESPACE"," ",518],["T_ARRAY","array",518],"(",["T_CONSTANT_ENCAPSED_STRING","'@field'",518],["T_WHITESPACE"," ",518],["T_DOUBLE_ARROW","=>",518],["T_WHITESPACE"," ",518],["T_VARIABLE","$field",518],",",["T_WHITESPACE"," ",518],["T_CONSTANT_ENCAPSED_STRING","'@table'",518],["T_WHITESPACE"," ",518],["T_DOUBLE_ARROW","=>",518],["T_WHITESPACE"," ",518],["T_VARIABLE","$table",518],")",")",")",";",["T_WHITESPACE","\n    ",518],"}",["T_WHITESPACE","\n\n    ",519],["T_VARIABLE","$fixnull",521],["T_WHITESPACE"," ",521],"=",["T_WHITESPACE"," ",521],["T_STRING","FALSE",521],";",["T_WHITESPACE","\n    ",521],["T_IF","if",522],["T_WHITESPACE"," ",522],"(","!",["T_EMPTY","empty",522],"(",["T_VARIABLE","$spec",522],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",522],"]",")",["T_WHITESPACE"," ",522],["T_BOOLEAN_AND","&&",522],["T_WHITESPACE"," ",522],"!",["T_ISSET","isset",522],"(",["T_VARIABLE","$spec",522],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",522],"]",")",")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n      ",522],["T_VARIABLE","$fixnull",523],["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_STRING","TRUE",523],";",["T_WHITESPACE","\n      ",523],["T_VARIABLE","$spec",524],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",524],"]",["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_STRING","FALSE",524],";",["T_WHITESPACE","\n    ",524],"}",["T_WHITESPACE","\n    ",525],["T_VARIABLE","$query",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",526],["T_WHITESPACE"," ",526],".",["T_WHITESPACE"," ",526],["T_VARIABLE","$table",526],["T_WHITESPACE"," ",526],".",["T_WHITESPACE"," ",526],["T_CONSTANT_ENCAPSED_STRING","'} ADD COLUMN '",526],";",["T_WHITESPACE","\n    ",526],["T_VARIABLE","$query",527],["T_WHITESPACE"," ",527],["T_CONCAT_EQUAL",".=",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","createFieldSql",527],"(",["T_VARIABLE","$field",527],",",["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","processField",527],"(",["T_VARIABLE","$spec",527],")",")",";",["T_WHITESPACE","\n    ",527],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","connection",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","query",528],"(",["T_VARIABLE","$query",528],")",";",["T_WHITESPACE","\n    ",528],["T_IF","if",529],["T_WHITESPACE"," ",529],"(",["T_ISSET","isset",529],"(",["T_VARIABLE","$spec",529],"[",["T_CONSTANT_ENCAPSED_STRING","'initial'",529],"]",")",")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n      ",529],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","connection",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","update",530],"(",["T_VARIABLE","$table",530],")",["T_WHITESPACE","\n        ",530],["T_OBJECT_OPERATOR","->",531],["T_STRING","fields",531],"(",["T_ARRAY","array",531],"(",["T_VARIABLE","$field",531],["T_WHITESPACE"," ",531],["T_DOUBLE_ARROW","=>",531],["T_WHITESPACE"," ",531],["T_VARIABLE","$spec",531],"[",["T_CONSTANT_ENCAPSED_STRING","'initial'",531],"]",")",")",["T_WHITESPACE","\n        ",531],["T_OBJECT_OPERATOR","->",532],["T_STRING","execute",532],"(",")",";",["T_WHITESPACE","\n    ",532],"}",["T_WHITESPACE","\n    ",533],["T_IF","if",534],["T_WHITESPACE"," ",534],"(",["T_ISSET","isset",534],"(",["T_VARIABLE","$spec",534],"[",["T_CONSTANT_ENCAPSED_STRING","'initial_from_field'",534],"]",")",")",["T_WHITESPACE"," ",534],"{",["T_WHITESPACE","\n      ",534],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","connection",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","update",535],"(",["T_VARIABLE","$table",535],")",["T_WHITESPACE","\n        ",535],["T_OBJECT_OPERATOR","->",536],["T_STRING","expression",536],"(",["T_VARIABLE","$field",536],",",["T_WHITESPACE"," ",536],["T_VARIABLE","$spec",536],"[",["T_CONSTANT_ENCAPSED_STRING","'initial_from_field'",536],"]",")",["T_WHITESPACE","\n        ",536],["T_OBJECT_OPERATOR","->",537],["T_STRING","execute",537],"(",")",";",["T_WHITESPACE","\n    ",537],"}",["T_WHITESPACE","\n    ",538],["T_IF","if",539],["T_WHITESPACE"," ",539],"(",["T_VARIABLE","$fixnull",539],")",["T_WHITESPACE"," ",539],"{",["T_WHITESPACE","\n      ",539],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","connection",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","query",540],"(",["T_CONSTANT_ENCAPSED_STRING","\"ALTER TABLE {\"",540],["T_WHITESPACE"," ",540],".",["T_WHITESPACE"," ",540],["T_VARIABLE","$table",540],["T_WHITESPACE"," ",540],".",["T_WHITESPACE"," ",540],"\"",["T_ENCAPSED_AND_WHITESPACE","} ALTER ",540],["T_VARIABLE","$field",540],["T_ENCAPSED_AND_WHITESPACE"," SET NOT NULL",540],"\"",")",";",["T_WHITESPACE","\n    ",540],"}",["T_WHITESPACE","\n    ",541],["T_IF","if",542],["T_WHITESPACE"," ",542],"(",["T_ISSET","isset",542],"(",["T_VARIABLE","$new_keys",542],")",")",["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n      ",542],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","_createKeys",543],"(",["T_VARIABLE","$table",543],",",["T_WHITESPACE"," ",543],["T_VARIABLE","$new_keys",543],")",";",["T_WHITESPACE","\n    ",543],"}",["T_WHITESPACE","\n    ",544],["T_COMMENT","\/\/ Add column comment.\n",545],["T_WHITESPACE","    ",546],["T_IF","if",546],["T_WHITESPACE"," ",546],"(","!",["T_EMPTY","empty",546],"(",["T_VARIABLE","$spec",546],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",546],"]",")",")",["T_WHITESPACE"," ",546],"{",["T_WHITESPACE","\n      ",546],["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","connection",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","query",547],"(",["T_CONSTANT_ENCAPSED_STRING","'COMMENT ON COLUMN {'",547],["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_VARIABLE","$table",547],["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_CONSTANT_ENCAPSED_STRING","'}.'",547],["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_VARIABLE","$field",547],["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_CONSTANT_ENCAPSED_STRING","' IS '",547],["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","prepareComment",547],"(",["T_VARIABLE","$spec",547],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",547],"]",")",")",";",["T_WHITESPACE","\n    ",547],"}",["T_WHITESPACE","\n    ",548],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","resetTableInformation",549],"(",["T_VARIABLE","$table",549],")",";",["T_WHITESPACE","\n  ",549],"}",["T_WHITESPACE","\n\n  ",550],["T_PUBLIC","public",552],["T_WHITESPACE"," ",552],["T_FUNCTION","function",552],["T_WHITESPACE"," ",552],["T_STRING","dropField",552],"(",["T_VARIABLE","$table",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$field",552],")",["T_WHITESPACE"," ",552],"{",["T_WHITESPACE","\n    ",552],["T_IF","if",553],["T_WHITESPACE"," ",553],"(","!",["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","fieldExists",553],"(",["T_VARIABLE","$table",553],",",["T_WHITESPACE"," ",553],["T_VARIABLE","$field",553],")",")",["T_WHITESPACE"," ",553],"{",["T_WHITESPACE","\n      ",553],["T_RETURN","return",554],["T_WHITESPACE"," ",554],["T_STRING","FALSE",554],";",["T_WHITESPACE","\n    ",554],"}",["T_WHITESPACE","\n\n    ",555],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","connection",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","query",557],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",557],["T_WHITESPACE"," ",557],".",["T_WHITESPACE"," ",557],["T_VARIABLE","$table",557],["T_WHITESPACE"," ",557],".",["T_WHITESPACE"," ",557],["T_CONSTANT_ENCAPSED_STRING","'} DROP COLUMN \"'",557],["T_WHITESPACE"," ",557],".",["T_WHITESPACE"," ",557],["T_VARIABLE","$field",557],["T_WHITESPACE"," ",557],".",["T_WHITESPACE"," ",557],["T_CONSTANT_ENCAPSED_STRING","'\"'",557],")",";",["T_WHITESPACE","\n    ",557],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","resetTableInformation",558],"(",["T_VARIABLE","$table",558],")",";",["T_WHITESPACE","\n    ",558],["T_RETURN","return",559],["T_WHITESPACE"," ",559],["T_STRING","TRUE",559],";",["T_WHITESPACE","\n  ",559],"}",["T_WHITESPACE","\n\n  ",560],["T_PUBLIC","public",562],["T_WHITESPACE"," ",562],["T_FUNCTION","function",562],["T_WHITESPACE"," ",562],["T_STRING","fieldSetDefault",562],"(",["T_VARIABLE","$table",562],",",["T_WHITESPACE"," ",562],["T_VARIABLE","$field",562],",",["T_WHITESPACE"," ",562],["T_VARIABLE","$default",562],")",["T_WHITESPACE"," ",562],"{",["T_WHITESPACE","\n    ",562],["T_IF","if",563],["T_WHITESPACE"," ",563],"(","!",["T_VARIABLE","$this",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","fieldExists",563],"(",["T_VARIABLE","$table",563],",",["T_WHITESPACE"," ",563],["T_VARIABLE","$field",563],")",")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n      ",563],["T_THROW","throw",564],["T_WHITESPACE"," ",564],["T_NEW","new",564],["T_WHITESPACE"," ",564],["T_STRING","SchemaObjectDoesNotExistException",564],"(",["T_STRING","t",564],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot set default value of field @table.@field: field doesn't exist.\"",564],",",["T_WHITESPACE"," ",564],["T_ARRAY","array",564],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",564],["T_WHITESPACE"," ",564],["T_DOUBLE_ARROW","=>",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$table",564],",",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","'@field'",564],["T_WHITESPACE"," ",564],["T_DOUBLE_ARROW","=>",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$field",564],")",")",")",";",["T_WHITESPACE","\n    ",564],"}",["T_WHITESPACE","\n\n    ",565],["T_VARIABLE","$default",567],["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_VARIABLE","$this",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","escapeDefaultValue",567],"(",["T_VARIABLE","$default",567],")",";",["T_WHITESPACE","\n\n    ",567],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","connection",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","query",569],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",569],["T_WHITESPACE"," ",569],".",["T_WHITESPACE"," ",569],["T_VARIABLE","$table",569],["T_WHITESPACE"," ",569],".",["T_WHITESPACE"," ",569],["T_CONSTANT_ENCAPSED_STRING","'} ALTER COLUMN \"'",569],["T_WHITESPACE"," ",569],".",["T_WHITESPACE"," ",569],["T_VARIABLE","$field",569],["T_WHITESPACE"," ",569],".",["T_WHITESPACE"," ",569],["T_CONSTANT_ENCAPSED_STRING","'\" SET DEFAULT '",569],["T_WHITESPACE"," ",569],".",["T_WHITESPACE"," ",569],["T_VARIABLE","$default",569],")",";",["T_WHITESPACE","\n  ",569],"}",["T_WHITESPACE","\n\n  ",570],["T_PUBLIC","public",572],["T_WHITESPACE"," ",572],["T_FUNCTION","function",572],["T_WHITESPACE"," ",572],["T_STRING","fieldSetNoDefault",572],"(",["T_VARIABLE","$table",572],",",["T_WHITESPACE"," ",572],["T_VARIABLE","$field",572],")",["T_WHITESPACE"," ",572],"{",["T_WHITESPACE","\n    ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(","!",["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","fieldExists",573],"(",["T_VARIABLE","$table",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$field",573],")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n      ",573],["T_THROW","throw",574],["T_WHITESPACE"," ",574],["T_NEW","new",574],["T_WHITESPACE"," ",574],["T_STRING","SchemaObjectDoesNotExistException",574],"(",["T_STRING","t",574],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot remove default value of field @table.@field: field doesn't exist.\"",574],",",["T_WHITESPACE"," ",574],["T_ARRAY","array",574],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",574],["T_WHITESPACE"," ",574],["T_DOUBLE_ARROW","=>",574],["T_WHITESPACE"," ",574],["T_VARIABLE","$table",574],",",["T_WHITESPACE"," ",574],["T_CONSTANT_ENCAPSED_STRING","'@field'",574],["T_WHITESPACE"," ",574],["T_DOUBLE_ARROW","=>",574],["T_WHITESPACE"," ",574],["T_VARIABLE","$field",574],")",")",")",";",["T_WHITESPACE","\n    ",574],"}",["T_WHITESPACE","\n\n    ",575],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","connection",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","query",577],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",577],["T_WHITESPACE"," ",577],".",["T_WHITESPACE"," ",577],["T_VARIABLE","$table",577],["T_WHITESPACE"," ",577],".",["T_WHITESPACE"," ",577],["T_CONSTANT_ENCAPSED_STRING","'} ALTER COLUMN \"'",577],["T_WHITESPACE"," ",577],".",["T_WHITESPACE"," ",577],["T_VARIABLE","$field",577],["T_WHITESPACE"," ",577],".",["T_WHITESPACE"," ",577],["T_CONSTANT_ENCAPSED_STRING","'\" DROP DEFAULT'",577],")",";",["T_WHITESPACE","\n  ",577],"}",["T_WHITESPACE","\n\n  ",578],["T_PUBLIC","public",580],["T_WHITESPACE"," ",580],["T_FUNCTION","function",580],["T_WHITESPACE"," ",580],["T_STRING","indexExists",580],"(",["T_VARIABLE","$table",580],",",["T_WHITESPACE"," ",580],["T_VARIABLE","$name",580],")",["T_WHITESPACE"," ",580],"{",["T_WHITESPACE","\n    ",580],["T_COMMENT","\/\/ Details http:\/\/www.postgresql.org\/docs\/9.1\/interactive\/view-pg-indexes.html\n",581],["T_WHITESPACE","    ",582],["T_VARIABLE","$index_name",582],["T_WHITESPACE"," ",582],"=",["T_WHITESPACE"," ",582],["T_VARIABLE","$this",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","ensureIdentifiersLength",582],"(",["T_VARIABLE","$table",582],",",["T_WHITESPACE"," ",582],["T_VARIABLE","$name",582],",",["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'idx'",582],")",";",["T_WHITESPACE","\n    ",582],["T_COMMENT","\/\/ Remove leading and trailing quotes because the index name is in a WHERE\n",583],["T_WHITESPACE","    ",584],["T_COMMENT","\/\/ clause and not used as an identifier.\n",584],["T_WHITESPACE","    ",585],["T_VARIABLE","$index_name",585],["T_WHITESPACE"," ",585],"=",["T_WHITESPACE"," ",585],["T_STRING","str_replace",585],"(",["T_CONSTANT_ENCAPSED_STRING","'\"'",585],",",["T_WHITESPACE"," ",585],["T_CONSTANT_ENCAPSED_STRING","''",585],",",["T_WHITESPACE"," ",585],["T_VARIABLE","$index_name",585],")",";",["T_WHITESPACE","\n    ",585],["T_RETURN","return",586],["T_WHITESPACE"," ",586],["T_BOOL_CAST","(bool)",586],["T_WHITESPACE"," ",586],["T_VARIABLE","$this",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","connection",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","query",586],"(","\"",["T_ENCAPSED_AND_WHITESPACE","SELECT 1 FROM pg_indexes WHERE indexname = '",586],["T_VARIABLE","$index_name",586],["T_ENCAPSED_AND_WHITESPACE","'",586],"\"",")",["T_OBJECT_OPERATOR","->",586],["T_STRING","fetchField",586],"(",")",";",["T_WHITESPACE","\n  ",586],"}",["T_WHITESPACE","\n\n  ",587],["T_DOC_COMMENT","\/**\n   * Helper function: check if a constraint (PK, FK, UK) exists.\n   *\n   * @param string $table\n   *   The name of the table.\n   * @param string $name\n   *   The name of the constraint (typically 'pkey' or '[constraint]__key').\n   *\n   * @return bool\n   *   TRUE if the constraint exists, FALSE otherwise.\n   *\/",589],["T_WHITESPACE","\n  ",599],["T_PUBLIC","public",600],["T_WHITESPACE"," ",600],["T_FUNCTION","function",600],["T_WHITESPACE"," ",600],["T_STRING","constraintExists",600],"(",["T_VARIABLE","$table",600],",",["T_WHITESPACE"," ",600],["T_VARIABLE","$name",600],")",["T_WHITESPACE"," ",600],"{",["T_WHITESPACE","\n    ",600],["T_COMMENT","\/\/ ::ensureIdentifiersLength() expects three parameters, although not\n",601],["T_WHITESPACE","    ",602],["T_COMMENT","\/\/ explicitly stated in its signature, thus we split our constraint name in\n",602],["T_WHITESPACE","    ",603],["T_COMMENT","\/\/ a proper name and a suffix.\n",603],["T_WHITESPACE","    ",604],["T_IF","if",604],["T_WHITESPACE"," ",604],"(",["T_VARIABLE","$name",604],["T_WHITESPACE"," ",604],["T_IS_EQUAL","==",604],["T_WHITESPACE"," ",604],["T_CONSTANT_ENCAPSED_STRING","'pkey'",604],")",["T_WHITESPACE"," ",604],"{",["T_WHITESPACE","\n      ",604],["T_VARIABLE","$suffix",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_VARIABLE","$name",605],";",["T_WHITESPACE","\n      ",605],["T_VARIABLE","$name",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_CONSTANT_ENCAPSED_STRING","''",606],";",["T_WHITESPACE","\n    ",606],"}",["T_WHITESPACE","\n    ",607],["T_ELSE","else",608],["T_WHITESPACE"," ",608],"{",["T_WHITESPACE","\n      ",608],["T_VARIABLE","$pos",609],["T_WHITESPACE"," ",609],"=",["T_WHITESPACE"," ",609],["T_STRING","strrpos",609],"(",["T_VARIABLE","$name",609],",",["T_WHITESPACE"," ",609],["T_CONSTANT_ENCAPSED_STRING","'__'",609],")",";",["T_WHITESPACE","\n      ",609],["T_VARIABLE","$suffix",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_STRING","substr",610],"(",["T_VARIABLE","$name",610],",",["T_WHITESPACE"," ",610],["T_VARIABLE","$pos",610],["T_WHITESPACE"," ",610],"+",["T_WHITESPACE"," ",610],["T_LNUMBER","2",610],")",";",["T_WHITESPACE","\n      ",610],["T_VARIABLE","$name",611],["T_WHITESPACE"," ",611],"=",["T_WHITESPACE"," ",611],["T_STRING","substr",611],"(",["T_VARIABLE","$name",611],",",["T_WHITESPACE"," ",611],["T_LNUMBER","0",611],",",["T_WHITESPACE"," ",611],["T_VARIABLE","$pos",611],")",";",["T_WHITESPACE","\n    ",611],"}",["T_WHITESPACE","\n    ",612],["T_VARIABLE","$constraint_name",613],["T_WHITESPACE"," ",613],"=",["T_WHITESPACE"," ",613],["T_VARIABLE","$this",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","ensureIdentifiersLength",613],"(",["T_VARIABLE","$table",613],",",["T_WHITESPACE"," ",613],["T_VARIABLE","$name",613],",",["T_WHITESPACE"," ",613],["T_VARIABLE","$suffix",613],")",";",["T_WHITESPACE","\n    ",613],["T_COMMENT","\/\/ Remove leading and trailing quotes because the index name is in a WHERE\n",614],["T_WHITESPACE","    ",615],["T_COMMENT","\/\/ clause and not used as an identifier.\n",615],["T_WHITESPACE","    ",616],["T_VARIABLE","$constraint_name",616],["T_WHITESPACE"," ",616],"=",["T_WHITESPACE"," ",616],["T_STRING","str_replace",616],"(",["T_CONSTANT_ENCAPSED_STRING","'\"'",616],",",["T_WHITESPACE"," ",616],["T_CONSTANT_ENCAPSED_STRING","''",616],",",["T_WHITESPACE"," ",616],["T_VARIABLE","$constraint_name",616],")",";",["T_WHITESPACE","\n    ",616],["T_RETURN","return",617],["T_WHITESPACE"," ",617],["T_BOOL_CAST","(bool)",617],["T_WHITESPACE"," ",617],["T_VARIABLE","$this",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","connection",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","query",617],"(","\"",["T_ENCAPSED_AND_WHITESPACE","SELECT 1 FROM pg_constraint WHERE conname = '",617],["T_VARIABLE","$constraint_name",617],["T_ENCAPSED_AND_WHITESPACE","'",617],"\"",")",["T_OBJECT_OPERATOR","->",617],["T_STRING","fetchField",617],"(",")",";",["T_WHITESPACE","\n  ",617],"}",["T_WHITESPACE","\n\n  ",618],["T_PUBLIC","public",620],["T_WHITESPACE"," ",620],["T_FUNCTION","function",620],["T_WHITESPACE"," ",620],["T_STRING","addPrimaryKey",620],"(",["T_VARIABLE","$table",620],",",["T_WHITESPACE"," ",620],["T_VARIABLE","$fields",620],")",["T_WHITESPACE"," ",620],"{",["T_WHITESPACE","\n    ",620],["T_IF","if",621],["T_WHITESPACE"," ",621],"(","!",["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","tableExists",621],"(",["T_VARIABLE","$table",621],")",")",["T_WHITESPACE"," ",621],"{",["T_WHITESPACE","\n      ",621],["T_THROW","throw",622],["T_WHITESPACE"," ",622],["T_NEW","new",622],["T_WHITESPACE"," ",622],["T_STRING","SchemaObjectDoesNotExistException",622],"(",["T_STRING","t",622],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add primary key to table @table: table doesn't exist.\"",622],",",["T_WHITESPACE"," ",622],["T_ARRAY","array",622],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",622],["T_WHITESPACE"," ",622],["T_DOUBLE_ARROW","=>",622],["T_WHITESPACE"," ",622],["T_VARIABLE","$table",622],")",")",")",";",["T_WHITESPACE","\n    ",622],"}",["T_WHITESPACE","\n    ",623],["T_IF","if",624],["T_WHITESPACE"," ",624],"(",["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","constraintExists",624],"(",["T_VARIABLE","$table",624],",",["T_WHITESPACE"," ",624],["T_CONSTANT_ENCAPSED_STRING","'pkey'",624],")",")",["T_WHITESPACE"," ",624],"{",["T_WHITESPACE","\n      ",624],["T_THROW","throw",625],["T_WHITESPACE"," ",625],["T_NEW","new",625],["T_WHITESPACE"," ",625],["T_STRING","SchemaObjectExistsException",625],"(",["T_STRING","t",625],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add primary key to table @table: primary key already exists.\"",625],",",["T_WHITESPACE"," ",625],["T_ARRAY","array",625],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",625],["T_WHITESPACE"," ",625],["T_DOUBLE_ARROW","=>",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$table",625],")",")",")",";",["T_WHITESPACE","\n    ",625],"}",["T_WHITESPACE","\n\n    ",626],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","connection",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","query",628],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",628],["T_WHITESPACE"," ",628],".",["T_WHITESPACE"," ",628],["T_VARIABLE","$table",628],["T_WHITESPACE"," ",628],".",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","'} ADD CONSTRAINT '",628],["T_WHITESPACE"," ",628],".",["T_WHITESPACE"," ",628],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","ensureIdentifiersLength",628],"(",["T_VARIABLE","$table",628],",",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","''",628],",",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","'pkey'",628],")",["T_WHITESPACE"," ",628],".",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","' PRIMARY KEY ('",628],["T_WHITESPACE"," ",628],".",["T_WHITESPACE"," ",628],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","createPrimaryKeySql",628],"(",["T_VARIABLE","$fields",628],")",["T_WHITESPACE"," ",628],".",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","')'",628],")",";",["T_WHITESPACE","\n    ",628],["T_VARIABLE","$this",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","resetTableInformation",629],"(",["T_VARIABLE","$table",629],")",";",["T_WHITESPACE","\n  ",629],"}",["T_WHITESPACE","\n\n  ",630],["T_PUBLIC","public",632],["T_WHITESPACE"," ",632],["T_FUNCTION","function",632],["T_WHITESPACE"," ",632],["T_STRING","dropPrimaryKey",632],"(",["T_VARIABLE","$table",632],")",["T_WHITESPACE"," ",632],"{",["T_WHITESPACE","\n    ",632],["T_IF","if",633],["T_WHITESPACE"," ",633],"(","!",["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","constraintExists",633],"(",["T_VARIABLE","$table",633],",",["T_WHITESPACE"," ",633],["T_CONSTANT_ENCAPSED_STRING","'pkey'",633],")",")",["T_WHITESPACE"," ",633],"{",["T_WHITESPACE","\n      ",633],["T_RETURN","return",634],["T_WHITESPACE"," ",634],["T_STRING","FALSE",634],";",["T_WHITESPACE","\n    ",634],"}",["T_WHITESPACE","\n\n    ",635],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","connection",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","query",637],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$table",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","'} DROP CONSTRAINT '",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","ensureIdentifiersLength",637],"(",["T_VARIABLE","$table",637],",",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","''",637],",",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","'pkey'",637],")",")",";",["T_WHITESPACE","\n    ",637],["T_VARIABLE","$this",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","resetTableInformation",638],"(",["T_VARIABLE","$table",638],")",";",["T_WHITESPACE","\n    ",638],["T_RETURN","return",639],["T_WHITESPACE"," ",639],["T_STRING","TRUE",639],";",["T_WHITESPACE","\n  ",639],"}",["T_WHITESPACE","\n\n  ",640],["T_FUNCTION","function",642],["T_WHITESPACE"," ",642],["T_STRING","addUniqueKey",642],"(",["T_VARIABLE","$table",642],",",["T_WHITESPACE"," ",642],["T_VARIABLE","$name",642],",",["T_WHITESPACE"," ",642],["T_VARIABLE","$fields",642],")",["T_WHITESPACE"," ",642],"{",["T_WHITESPACE","\n    ",642],["T_IF","if",643],["T_WHITESPACE"," ",643],"(","!",["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","tableExists",643],"(",["T_VARIABLE","$table",643],")",")",["T_WHITESPACE"," ",643],"{",["T_WHITESPACE","\n      ",643],["T_THROW","throw",644],["T_WHITESPACE"," ",644],["T_NEW","new",644],["T_WHITESPACE"," ",644],["T_STRING","SchemaObjectDoesNotExistException",644],"(",["T_STRING","t",644],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add unique key @name to table @table: table doesn't exist.\"",644],",",["T_WHITESPACE"," ",644],["T_ARRAY","array",644],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",644],["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$table",644],",",["T_WHITESPACE"," ",644],["T_CONSTANT_ENCAPSED_STRING","'@name'",644],["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$name",644],")",")",")",";",["T_WHITESPACE","\n    ",644],"}",["T_WHITESPACE","\n    ",645],["T_IF","if",646],["T_WHITESPACE"," ",646],"(",["T_VARIABLE","$this",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","constraintExists",646],"(",["T_VARIABLE","$table",646],",",["T_WHITESPACE"," ",646],["T_VARIABLE","$name",646],["T_WHITESPACE"," ",646],".",["T_WHITESPACE"," ",646],["T_CONSTANT_ENCAPSED_STRING","'__key'",646],")",")",["T_WHITESPACE"," ",646],"{",["T_WHITESPACE","\n      ",646],["T_THROW","throw",647],["T_WHITESPACE"," ",647],["T_NEW","new",647],["T_WHITESPACE"," ",647],["T_STRING","SchemaObjectExistsException",647],"(",["T_STRING","t",647],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add unique key @name to table @table: unique key already exists.\"",647],",",["T_WHITESPACE"," ",647],["T_ARRAY","array",647],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",647],["T_WHITESPACE"," ",647],["T_DOUBLE_ARROW","=>",647],["T_WHITESPACE"," ",647],["T_VARIABLE","$table",647],",",["T_WHITESPACE"," ",647],["T_CONSTANT_ENCAPSED_STRING","'@name'",647],["T_WHITESPACE"," ",647],["T_DOUBLE_ARROW","=>",647],["T_WHITESPACE"," ",647],["T_VARIABLE","$name",647],")",")",")",";",["T_WHITESPACE","\n    ",647],"}",["T_WHITESPACE","\n\n    ",648],["T_VARIABLE","$this",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","connection",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","query",650],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",650],["T_WHITESPACE"," ",650],".",["T_WHITESPACE"," ",650],["T_VARIABLE","$table",650],["T_WHITESPACE"," ",650],".",["T_WHITESPACE"," ",650],["T_CONSTANT_ENCAPSED_STRING","'} ADD CONSTRAINT '",650],["T_WHITESPACE"," ",650],".",["T_WHITESPACE"," ",650],["T_VARIABLE","$this",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","ensureIdentifiersLength",650],"(",["T_VARIABLE","$table",650],",",["T_WHITESPACE"," ",650],["T_VARIABLE","$name",650],",",["T_WHITESPACE"," ",650],["T_CONSTANT_ENCAPSED_STRING","'key'",650],")",["T_WHITESPACE"," ",650],".",["T_WHITESPACE"," ",650],["T_CONSTANT_ENCAPSED_STRING","' UNIQUE ('",650],["T_WHITESPACE"," ",650],".",["T_WHITESPACE"," ",650],["T_STRING","implode",650],"(",["T_CONSTANT_ENCAPSED_STRING","','",650],",",["T_WHITESPACE"," ",650],["T_VARIABLE","$fields",650],")",["T_WHITESPACE"," ",650],".",["T_WHITESPACE"," ",650],["T_CONSTANT_ENCAPSED_STRING","')'",650],")",";",["T_WHITESPACE","\n    ",650],["T_VARIABLE","$this",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","resetTableInformation",651],"(",["T_VARIABLE","$table",651],")",";",["T_WHITESPACE","\n  ",651],"}",["T_WHITESPACE","\n\n  ",652],["T_PUBLIC","public",654],["T_WHITESPACE"," ",654],["T_FUNCTION","function",654],["T_WHITESPACE"," ",654],["T_STRING","dropUniqueKey",654],"(",["T_VARIABLE","$table",654],",",["T_WHITESPACE"," ",654],["T_VARIABLE","$name",654],")",["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n    ",654],["T_IF","if",655],["T_WHITESPACE"," ",655],"(","!",["T_VARIABLE","$this",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","constraintExists",655],"(",["T_VARIABLE","$table",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$name",655],["T_WHITESPACE"," ",655],".",["T_WHITESPACE"," ",655],["T_CONSTANT_ENCAPSED_STRING","'__key'",655],")",")",["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n      ",655],["T_RETURN","return",656],["T_WHITESPACE"," ",656],["T_STRING","FALSE",656],";",["T_WHITESPACE","\n    ",656],"}",["T_WHITESPACE","\n\n    ",657],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","connection",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","query",659],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",659],["T_WHITESPACE"," ",659],".",["T_WHITESPACE"," ",659],["T_VARIABLE","$table",659],["T_WHITESPACE"," ",659],".",["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'} DROP CONSTRAINT '",659],["T_WHITESPACE"," ",659],".",["T_WHITESPACE"," ",659],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","ensureIdentifiersLength",659],"(",["T_VARIABLE","$table",659],",",["T_WHITESPACE"," ",659],["T_VARIABLE","$name",659],",",["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'key'",659],")",")",";",["T_WHITESPACE","\n    ",659],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","resetTableInformation",660],"(",["T_VARIABLE","$table",660],")",";",["T_WHITESPACE","\n    ",660],["T_RETURN","return",661],["T_WHITESPACE"," ",661],["T_STRING","TRUE",661],";",["T_WHITESPACE","\n  ",661],"}",["T_WHITESPACE","\n\n  ",662],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",664],["T_WHITESPACE","\n  ",666],["T_PUBLIC","public",667],["T_WHITESPACE"," ",667],["T_FUNCTION","function",667],["T_WHITESPACE"," ",667],["T_STRING","addIndex",667],"(",["T_VARIABLE","$table",667],",",["T_WHITESPACE"," ",667],["T_VARIABLE","$name",667],",",["T_WHITESPACE"," ",667],["T_VARIABLE","$fields",667],",",["T_WHITESPACE"," ",667],["T_ARRAY","array",667],["T_WHITESPACE"," ",667],["T_VARIABLE","$spec",667],")",["T_WHITESPACE"," ",667],"{",["T_WHITESPACE","\n    ",667],["T_IF","if",668],["T_WHITESPACE"," ",668],"(","!",["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","tableExists",668],"(",["T_VARIABLE","$table",668],")",")",["T_WHITESPACE"," ",668],"{",["T_WHITESPACE","\n      ",668],["T_THROW","throw",669],["T_WHITESPACE"," ",669],["T_NEW","new",669],["T_WHITESPACE"," ",669],["T_STRING","SchemaObjectDoesNotExistException",669],"(",["T_STRING","t",669],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add index @name to table @table: table doesn't exist.\"",669],",",["T_WHITESPACE"," ",669],["T_ARRAY","array",669],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",669],["T_WHITESPACE"," ",669],["T_DOUBLE_ARROW","=>",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$table",669],",",["T_WHITESPACE"," ",669],["T_CONSTANT_ENCAPSED_STRING","'@name'",669],["T_WHITESPACE"," ",669],["T_DOUBLE_ARROW","=>",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$name",669],")",")",")",";",["T_WHITESPACE","\n    ",669],"}",["T_WHITESPACE","\n    ",670],["T_IF","if",671],["T_WHITESPACE"," ",671],"(",["T_VARIABLE","$this",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","indexExists",671],"(",["T_VARIABLE","$table",671],",",["T_WHITESPACE"," ",671],["T_VARIABLE","$name",671],")",")",["T_WHITESPACE"," ",671],"{",["T_WHITESPACE","\n      ",671],["T_THROW","throw",672],["T_WHITESPACE"," ",672],["T_NEW","new",672],["T_WHITESPACE"," ",672],["T_STRING","SchemaObjectExistsException",672],"(",["T_STRING","t",672],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot add index @name to table @table: index already exists.\"",672],",",["T_WHITESPACE"," ",672],["T_ARRAY","array",672],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",672],["T_WHITESPACE"," ",672],["T_DOUBLE_ARROW","=>",672],["T_WHITESPACE"," ",672],["T_VARIABLE","$table",672],",",["T_WHITESPACE"," ",672],["T_CONSTANT_ENCAPSED_STRING","'@name'",672],["T_WHITESPACE"," ",672],["T_DOUBLE_ARROW","=>",672],["T_WHITESPACE"," ",672],["T_VARIABLE","$name",672],")",")",")",";",["T_WHITESPACE","\n    ",672],"}",["T_WHITESPACE","\n\n    ",673],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","connection",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","query",675],"(",["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","_createIndexSql",675],"(",["T_VARIABLE","$table",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$name",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$fields",675],")",")",";",["T_WHITESPACE","\n    ",675],["T_VARIABLE","$this",676],["T_OBJECT_OPERATOR","->",676],["T_STRING","resetTableInformation",676],"(",["T_VARIABLE","$table",676],")",";",["T_WHITESPACE","\n  ",676],"}",["T_WHITESPACE","\n\n  ",677],["T_PUBLIC","public",679],["T_WHITESPACE"," ",679],["T_FUNCTION","function",679],["T_WHITESPACE"," ",679],["T_STRING","dropIndex",679],"(",["T_VARIABLE","$table",679],",",["T_WHITESPACE"," ",679],["T_VARIABLE","$name",679],")",["T_WHITESPACE"," ",679],"{",["T_WHITESPACE","\n    ",679],["T_IF","if",680],["T_WHITESPACE"," ",680],"(","!",["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","indexExists",680],"(",["T_VARIABLE","$table",680],",",["T_WHITESPACE"," ",680],["T_VARIABLE","$name",680],")",")",["T_WHITESPACE"," ",680],"{",["T_WHITESPACE","\n      ",680],["T_RETURN","return",681],["T_WHITESPACE"," ",681],["T_STRING","FALSE",681],";",["T_WHITESPACE","\n    ",681],"}",["T_WHITESPACE","\n\n    ",682],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","connection",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","query",684],"(",["T_CONSTANT_ENCAPSED_STRING","'DROP INDEX '",684],["T_WHITESPACE"," ",684],".",["T_WHITESPACE"," ",684],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","ensureIdentifiersLength",684],"(",["T_VARIABLE","$table",684],",",["T_WHITESPACE"," ",684],["T_VARIABLE","$name",684],",",["T_WHITESPACE"," ",684],["T_CONSTANT_ENCAPSED_STRING","'idx'",684],")",")",";",["T_WHITESPACE","\n    ",684],["T_VARIABLE","$this",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","resetTableInformation",685],"(",["T_VARIABLE","$table",685],")",";",["T_WHITESPACE","\n    ",685],["T_RETURN","return",686],["T_WHITESPACE"," ",686],["T_STRING","TRUE",686],";",["T_WHITESPACE","\n  ",686],"}",["T_WHITESPACE","\n\n  ",687],["T_PUBLIC","public",689],["T_WHITESPACE"," ",689],["T_FUNCTION","function",689],["T_WHITESPACE"," ",689],["T_STRING","changeField",689],"(",["T_VARIABLE","$table",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$field",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$field_new",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$spec",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$new_keys",689],["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_ARRAY","array",689],"(",")",")",["T_WHITESPACE"," ",689],"{",["T_WHITESPACE","\n    ",689],["T_IF","if",690],["T_WHITESPACE"," ",690],"(","!",["T_VARIABLE","$this",690],["T_OBJECT_OPERATOR","->",690],["T_STRING","fieldExists",690],"(",["T_VARIABLE","$table",690],",",["T_WHITESPACE"," ",690],["T_VARIABLE","$field",690],")",")",["T_WHITESPACE"," ",690],"{",["T_WHITESPACE","\n      ",690],["T_THROW","throw",691],["T_WHITESPACE"," ",691],["T_NEW","new",691],["T_WHITESPACE"," ",691],["T_STRING","SchemaObjectDoesNotExistException",691],"(",["T_STRING","t",691],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot change the definition of field @table.@name: field doesn't exist.\"",691],",",["T_WHITESPACE"," ",691],["T_ARRAY","array",691],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$table",691],",",["T_WHITESPACE"," ",691],["T_CONSTANT_ENCAPSED_STRING","'@name'",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$field",691],")",")",")",";",["T_WHITESPACE","\n    ",691],"}",["T_WHITESPACE","\n    ",692],["T_IF","if",693],["T_WHITESPACE"," ",693],"(","(",["T_VARIABLE","$field",693],["T_WHITESPACE"," ",693],["T_IS_NOT_EQUAL","!=",693],["T_WHITESPACE"," ",693],["T_VARIABLE","$field_new",693],")",["T_WHITESPACE"," ",693],["T_BOOLEAN_AND","&&",693],["T_WHITESPACE"," ",693],["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","fieldExists",693],"(",["T_VARIABLE","$table",693],",",["T_WHITESPACE"," ",693],["T_VARIABLE","$field_new",693],")",")",["T_WHITESPACE"," ",693],"{",["T_WHITESPACE","\n      ",693],["T_THROW","throw",694],["T_WHITESPACE"," ",694],["T_NEW","new",694],["T_WHITESPACE"," ",694],["T_STRING","SchemaObjectExistsException",694],"(",["T_STRING","t",694],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot rename field @table.@name to @name_new: target field already exists.\"",694],",",["T_WHITESPACE"," ",694],["T_ARRAY","array",694],"(",["T_CONSTANT_ENCAPSED_STRING","'@table'",694],["T_WHITESPACE"," ",694],["T_DOUBLE_ARROW","=>",694],["T_WHITESPACE"," ",694],["T_VARIABLE","$table",694],",",["T_WHITESPACE"," ",694],["T_CONSTANT_ENCAPSED_STRING","'@name'",694],["T_WHITESPACE"," ",694],["T_DOUBLE_ARROW","=>",694],["T_WHITESPACE"," ",694],["T_VARIABLE","$field",694],",",["T_WHITESPACE"," ",694],["T_CONSTANT_ENCAPSED_STRING","'@name_new'",694],["T_WHITESPACE"," ",694],["T_DOUBLE_ARROW","=>",694],["T_WHITESPACE"," ",694],["T_VARIABLE","$field_new",694],")",")",")",";",["T_WHITESPACE","\n    ",694],"}",["T_WHITESPACE","\n\n    ",695],["T_VARIABLE","$spec",697],["T_WHITESPACE"," ",697],"=",["T_WHITESPACE"," ",697],["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","processField",697],"(",["T_VARIABLE","$spec",697],")",";",["T_WHITESPACE","\n\n    ",697],["T_COMMENT","\/\/ Type 'serial' is known to PostgreSQL, but only during table creation,\n",699],["T_WHITESPACE","    ",700],["T_COMMENT","\/\/ not when altering. Because of that, we create it here as an 'int'. After\n",700],["T_WHITESPACE","    ",701],["T_COMMENT","\/\/ we create it we manually re-apply the sequence.\n",701],["T_WHITESPACE","    ",702],["T_IF","if",702],["T_WHITESPACE"," ",702],"(",["T_STRING","in_array",702],"(",["T_VARIABLE","$spec",702],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",702],"]",",",["T_WHITESPACE"," ",702],["T_ARRAY","array",702],"(",["T_CONSTANT_ENCAPSED_STRING","'serial'",702],",",["T_WHITESPACE"," ",702],["T_CONSTANT_ENCAPSED_STRING","'bigserial'",702],")",")",")",["T_WHITESPACE"," ",702],"{",["T_WHITESPACE","\n      ",702],["T_VARIABLE","$field_def",703],["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_CONSTANT_ENCAPSED_STRING","'int'",703],";",["T_WHITESPACE","\n    ",703],"}",["T_WHITESPACE","\n    ",704],["T_ELSE","else",705],["T_WHITESPACE"," ",705],"{",["T_WHITESPACE","\n      ",705],["T_VARIABLE","$field_def",706],["T_WHITESPACE"," ",706],"=",["T_WHITESPACE"," ",706],["T_VARIABLE","$spec",706],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",706],"]",";",["T_WHITESPACE","\n    ",706],"}",["T_WHITESPACE","\n\n    ",707],["T_IF","if",709],["T_WHITESPACE"," ",709],"(",["T_STRING","in_array",709],"(",["T_VARIABLE","$spec",709],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",709],"]",",",["T_WHITESPACE"," ",709],["T_ARRAY","array",709],"(",["T_CONSTANT_ENCAPSED_STRING","'varchar'",709],",",["T_WHITESPACE"," ",709],["T_CONSTANT_ENCAPSED_STRING","'character'",709],",",["T_WHITESPACE"," ",709],["T_CONSTANT_ENCAPSED_STRING","'text'",709],")",")",["T_WHITESPACE"," ",709],["T_BOOLEAN_AND","&&",709],["T_WHITESPACE"," ",709],["T_ISSET","isset",709],"(",["T_VARIABLE","$spec",709],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",709],"]",")",")",["T_WHITESPACE"," ",709],"{",["T_WHITESPACE","\n      ",709],["T_VARIABLE","$field_def",710],["T_WHITESPACE"," ",710],["T_CONCAT_EQUAL",".=",710],["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'('",710],["T_WHITESPACE"," ",710],".",["T_WHITESPACE"," ",710],["T_VARIABLE","$spec",710],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",710],"]",["T_WHITESPACE"," ",710],".",["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","')'",710],";",["T_WHITESPACE","\n    ",710],"}",["T_WHITESPACE","\n    ",711],["T_ELSEIF","elseif",712],["T_WHITESPACE"," ",712],"(",["T_ISSET","isset",712],"(",["T_VARIABLE","$spec",712],"[",["T_CONSTANT_ENCAPSED_STRING","'precision'",712],"]",")",["T_WHITESPACE"," ",712],["T_BOOLEAN_AND","&&",712],["T_WHITESPACE"," ",712],["T_ISSET","isset",712],"(",["T_VARIABLE","$spec",712],"[",["T_CONSTANT_ENCAPSED_STRING","'scale'",712],"]",")",")",["T_WHITESPACE"," ",712],"{",["T_WHITESPACE","\n      ",712],["T_VARIABLE","$field_def",713],["T_WHITESPACE"," ",713],["T_CONCAT_EQUAL",".=",713],["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'('",713],["T_WHITESPACE"," ",713],".",["T_WHITESPACE"," ",713],["T_VARIABLE","$spec",713],"[",["T_CONSTANT_ENCAPSED_STRING","'precision'",713],"]",["T_WHITESPACE"," ",713],".",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","', '",713],["T_WHITESPACE"," ",713],".",["T_WHITESPACE"," ",713],["T_VARIABLE","$spec",713],"[",["T_CONSTANT_ENCAPSED_STRING","'scale'",713],"]",["T_WHITESPACE"," ",713],".",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","')'",713],";",["T_WHITESPACE","\n    ",713],"}",["T_WHITESPACE","\n\n    ",714],["T_COMMENT","\/\/ Remove old check constraints.\n",716],["T_WHITESPACE","    ",717],["T_VARIABLE","$field_info",717],["T_WHITESPACE"," ",717],"=",["T_WHITESPACE"," ",717],["T_VARIABLE","$this",717],["T_OBJECT_OPERATOR","->",717],["T_STRING","queryFieldInformation",717],"(",["T_VARIABLE","$table",717],",",["T_WHITESPACE"," ",717],["T_VARIABLE","$field",717],")",";",["T_WHITESPACE","\n\n    ",717],["T_FOREACH","foreach",719],["T_WHITESPACE"," ",719],"(",["T_VARIABLE","$field_info",719],["T_WHITESPACE"," ",719],["T_AS","as",719],["T_WHITESPACE"," ",719],["T_VARIABLE","$check",719],")",["T_WHITESPACE"," ",719],"{",["T_WHITESPACE","\n      ",719],["T_VARIABLE","$this",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","connection",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","query",720],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",720],["T_WHITESPACE"," ",720],".",["T_WHITESPACE"," ",720],["T_VARIABLE","$table",720],["T_WHITESPACE"," ",720],".",["T_WHITESPACE"," ",720],["T_CONSTANT_ENCAPSED_STRING","'} DROP CONSTRAINT \"'",720],["T_WHITESPACE"," ",720],".",["T_WHITESPACE"," ",720],["T_VARIABLE","$check",720],["T_WHITESPACE"," ",720],".",["T_WHITESPACE"," ",720],["T_CONSTANT_ENCAPSED_STRING","'\"'",720],")",";",["T_WHITESPACE","\n    ",720],"}",["T_WHITESPACE","\n\n    ",721],["T_COMMENT","\/\/ Remove old default.\n",723],["T_WHITESPACE","    ",724],["T_VARIABLE","$this",724],["T_OBJECT_OPERATOR","->",724],["T_STRING","fieldSetNoDefault",724],"(",["T_VARIABLE","$table",724],",",["T_WHITESPACE"," ",724],["T_VARIABLE","$field",724],")",";",["T_WHITESPACE","\n\n    ",724],["T_COMMENT","\/\/ Convert field type.\n",726],["T_WHITESPACE","    ",727],["T_COMMENT","\/\/ Usually, we do this via a simple typecast 'USING fieldname::type'. But\n",727],["T_WHITESPACE","    ",728],["T_COMMENT","\/\/ the typecast does not work for conversions to bytea.\n",728],["T_WHITESPACE","    ",729],["T_COMMENT","\/\/ @see http:\/\/www.postgresql.org\/docs\/current\/static\/datatype-binary.html\n",729],["T_WHITESPACE","    ",730],["T_VARIABLE","$table_information",730],["T_WHITESPACE"," ",730],"=",["T_WHITESPACE"," ",730],["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","queryTableInformation",730],"(",["T_VARIABLE","$table",730],")",";",["T_WHITESPACE","\n    ",730],["T_VARIABLE","$is_bytea",731],["T_WHITESPACE"," ",731],"=",["T_WHITESPACE"," ",731],"!",["T_EMPTY","empty",731],"(",["T_VARIABLE","$table_information",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","blob_fields",731],"[",["T_VARIABLE","$field",731],"]",")",";",["T_WHITESPACE","\n    ",731],["T_IF","if",732],["T_WHITESPACE"," ",732],"(",["T_VARIABLE","$spec",732],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",732],"]",["T_WHITESPACE"," ",732],["T_IS_NOT_EQUAL","!=",732],["T_WHITESPACE"," ",732],["T_CONSTANT_ENCAPSED_STRING","'bytea'",732],")",["T_WHITESPACE"," ",732],"{",["T_WHITESPACE","\n      ",732],["T_IF","if",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$is_bytea",733],")",["T_WHITESPACE"," ",733],"{",["T_WHITESPACE","\n        ",733],["T_VARIABLE","$this",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","connection",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","query",734],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_VARIABLE","$table",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_CONSTANT_ENCAPSED_STRING","'} ALTER \"'",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_VARIABLE","$field",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_CONSTANT_ENCAPSED_STRING","'\" TYPE '",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_VARIABLE","$field_def",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_CONSTANT_ENCAPSED_STRING","' USING convert_from(\"'",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_VARIABLE","$field",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_CONSTANT_ENCAPSED_STRING","'\"'",734],["T_WHITESPACE"," ",734],".",["T_WHITESPACE"," ",734],["T_CONSTANT_ENCAPSED_STRING","\", 'UTF8')\"",734],")",";",["T_WHITESPACE","\n      ",734],"}",["T_WHITESPACE","\n      ",735],["T_ELSE","else",736],["T_WHITESPACE"," ",736],"{",["T_WHITESPACE","\n        ",736],["T_VARIABLE","$this",737],["T_OBJECT_OPERATOR","->",737],["T_STRING","connection",737],["T_OBJECT_OPERATOR","->",737],["T_STRING","query",737],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_VARIABLE","$table",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_CONSTANT_ENCAPSED_STRING","'} ALTER \"'",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_VARIABLE","$field",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_CONSTANT_ENCAPSED_STRING","'\" TYPE '",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_VARIABLE","$field_def",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_CONSTANT_ENCAPSED_STRING","' USING \"'",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_VARIABLE","$field",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_CONSTANT_ENCAPSED_STRING","'\"::'",737],["T_WHITESPACE"," ",737],".",["T_WHITESPACE"," ",737],["T_VARIABLE","$field_def",737],")",";",["T_WHITESPACE","\n      ",737],"}",["T_WHITESPACE","\n    ",738],"}",["T_WHITESPACE","\n    ",739],["T_ELSE","else",740],["T_WHITESPACE"," ",740],"{",["T_WHITESPACE","\n      ",740],["T_COMMENT","\/\/ Do not attempt to convert a field that is bytea already.\n",741],["T_WHITESPACE","      ",742],["T_IF","if",742],["T_WHITESPACE"," ",742],"(","!",["T_VARIABLE","$is_bytea",742],")",["T_WHITESPACE"," ",742],"{",["T_WHITESPACE","\n        ",742],["T_COMMENT","\/\/ Convert to a bytea type by using the SQL replace() function to\n",743],["T_WHITESPACE","        ",744],["T_COMMENT","\/\/ convert any single backslashes in the field content to double\n",744],["T_WHITESPACE","        ",745],["T_COMMENT","\/\/ backslashes ('\\' to '\\\\').\n",745],["T_WHITESPACE","        ",746],["T_VARIABLE","$this",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","connection",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","query",746],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_VARIABLE","$table",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_CONSTANT_ENCAPSED_STRING","'} ALTER \"'",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_VARIABLE","$field",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_CONSTANT_ENCAPSED_STRING","'\" TYPE '",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_VARIABLE","$field_def",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_CONSTANT_ENCAPSED_STRING","' USING decode(replace(\"'",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_VARIABLE","$field",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_CONSTANT_ENCAPSED_STRING","'\"'",746],["T_WHITESPACE"," ",746],".",["T_WHITESPACE"," ",746],["T_CONSTANT_ENCAPSED_STRING","\", E'\\\\\\\\', E'\\\\\\\\\\\\\\\\'), 'escape');\"",746],")",";",["T_WHITESPACE","\n      ",746],"}",["T_WHITESPACE","\n    ",747],"}",["T_WHITESPACE","\n\n    ",748],["T_IF","if",750],["T_WHITESPACE"," ",750],"(",["T_ISSET","isset",750],"(",["T_VARIABLE","$spec",750],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",750],"]",")",")",["T_WHITESPACE"," ",750],"{",["T_WHITESPACE","\n      ",750],["T_IF","if",751],["T_WHITESPACE"," ",751],"(",["T_VARIABLE","$spec",751],"[",["T_CONSTANT_ENCAPSED_STRING","'not null'",751],"]",")",["T_WHITESPACE"," ",751],"{",["T_WHITESPACE","\n        ",751],["T_VARIABLE","$nullaction",752],["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_CONSTANT_ENCAPSED_STRING","'SET NOT NULL'",752],";",["T_WHITESPACE","\n      ",752],"}",["T_WHITESPACE","\n      ",753],["T_ELSE","else",754],["T_WHITESPACE"," ",754],"{",["T_WHITESPACE","\n        ",754],["T_VARIABLE","$nullaction",755],["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_CONSTANT_ENCAPSED_STRING","'DROP NOT NULL'",755],";",["T_WHITESPACE","\n      ",755],"}",["T_WHITESPACE","\n      ",756],["T_VARIABLE","$this",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","connection",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","query",757],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",757],["T_WHITESPACE"," ",757],".",["T_WHITESPACE"," ",757],["T_VARIABLE","$table",757],["T_WHITESPACE"," ",757],".",["T_WHITESPACE"," ",757],["T_CONSTANT_ENCAPSED_STRING","'} ALTER \"'",757],["T_WHITESPACE"," ",757],".",["T_WHITESPACE"," ",757],["T_VARIABLE","$field",757],["T_WHITESPACE"," ",757],".",["T_WHITESPACE"," ",757],["T_CONSTANT_ENCAPSED_STRING","'\" '",757],["T_WHITESPACE"," ",757],".",["T_WHITESPACE"," ",757],["T_VARIABLE","$nullaction",757],")",";",["T_WHITESPACE","\n    ",757],"}",["T_WHITESPACE","\n\n    ",758],["T_IF","if",760],["T_WHITESPACE"," ",760],"(",["T_STRING","in_array",760],"(",["T_VARIABLE","$spec",760],"[",["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",760],"]",",",["T_WHITESPACE"," ",760],["T_ARRAY","array",760],"(",["T_CONSTANT_ENCAPSED_STRING","'serial'",760],",",["T_WHITESPACE"," ",760],["T_CONSTANT_ENCAPSED_STRING","'bigserial'",760],")",")",")",["T_WHITESPACE"," ",760],"{",["T_WHITESPACE","\n      ",760],["T_COMMENT","\/\/ Type \"serial\" is known to PostgreSQL, but *only* during table creation,\n",761],["T_WHITESPACE","      ",762],["T_COMMENT","\/\/ not when altering. Because of that, the sequence needs to be created\n",762],["T_WHITESPACE","      ",763],["T_COMMENT","\/\/ and initialized by hand.\n",763],["T_WHITESPACE","      ",764],["T_VARIABLE","$seq",764],["T_WHITESPACE"," ",764],"=",["T_WHITESPACE"," ",764],["T_CONSTANT_ENCAPSED_STRING","\"{\"",764],["T_WHITESPACE"," ",764],".",["T_WHITESPACE"," ",764],["T_VARIABLE","$table",764],["T_WHITESPACE"," ",764],".",["T_WHITESPACE"," ",764],["T_CONSTANT_ENCAPSED_STRING","\"}_\"",764],["T_WHITESPACE"," ",764],".",["T_WHITESPACE"," ",764],["T_VARIABLE","$field_new",764],["T_WHITESPACE"," ",764],".",["T_WHITESPACE"," ",764],["T_CONSTANT_ENCAPSED_STRING","\"_seq\"",764],";",["T_WHITESPACE","\n      ",764],["T_VARIABLE","$this",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","connection",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","query",765],"(",["T_CONSTANT_ENCAPSED_STRING","\"CREATE SEQUENCE \"",765],["T_WHITESPACE"," ",765],".",["T_WHITESPACE"," ",765],["T_VARIABLE","$seq",765],")",";",["T_WHITESPACE","\n      ",765],["T_COMMENT","\/\/ Set sequence to maximal field value to not conflict with existing\n",766],["T_WHITESPACE","      ",767],["T_COMMENT","\/\/ entries.\n",767],["T_WHITESPACE","      ",768],["T_VARIABLE","$this",768],["T_OBJECT_OPERATOR","->",768],["T_STRING","connection",768],["T_OBJECT_OPERATOR","->",768],["T_STRING","query",768],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT setval('\"",768],["T_WHITESPACE"," ",768],".",["T_WHITESPACE"," ",768],["T_VARIABLE","$seq",768],["T_WHITESPACE"," ",768],".",["T_WHITESPACE"," ",768],["T_CONSTANT_ENCAPSED_STRING","\"', MAX(\\\"\"",768],["T_WHITESPACE"," ",768],".",["T_WHITESPACE"," ",768],["T_VARIABLE","$field",768],["T_WHITESPACE"," ",768],".",["T_WHITESPACE"," ",768],["T_CONSTANT_ENCAPSED_STRING","'\")) FROM {'",768],["T_WHITESPACE"," ",768],".",["T_WHITESPACE"," ",768],["T_VARIABLE","$table",768],["T_WHITESPACE"," ",768],".",["T_WHITESPACE"," ",768],["T_CONSTANT_ENCAPSED_STRING","\"}\"",768],")",";",["T_WHITESPACE","\n      ",768],["T_VARIABLE","$this",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","connection",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","query",769],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",769],["T_WHITESPACE"," ",769],".",["T_WHITESPACE"," ",769],["T_VARIABLE","$table",769],["T_WHITESPACE"," ",769],".",["T_WHITESPACE"," ",769],["T_CONSTANT_ENCAPSED_STRING","'} ALTER '",769],["T_WHITESPACE"," ",769],".",["T_WHITESPACE"," ",769],["T_VARIABLE","$field",769],["T_WHITESPACE"," ",769],".",["T_WHITESPACE"," ",769],["T_CONSTANT_ENCAPSED_STRING","' SET DEFAULT nextval('",769],["T_WHITESPACE"," ",769],".",["T_WHITESPACE"," ",769],["T_VARIABLE","$this",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","connection",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","quote",769],"(",["T_VARIABLE","$seq",769],")",["T_WHITESPACE"," ",769],".",["T_WHITESPACE"," ",769],["T_CONSTANT_ENCAPSED_STRING","')'",769],")",";",["T_WHITESPACE","\n    ",769],"}",["T_WHITESPACE","\n\n    ",770],["T_COMMENT","\/\/ Rename the column if necessary.\n",772],["T_WHITESPACE","    ",773],["T_IF","if",773],["T_WHITESPACE"," ",773],"(",["T_VARIABLE","$field",773],["T_WHITESPACE"," ",773],["T_IS_NOT_EQUAL","!=",773],["T_WHITESPACE"," ",773],["T_VARIABLE","$field_new",773],")",["T_WHITESPACE"," ",773],"{",["T_WHITESPACE","\n      ",773],["T_VARIABLE","$this",774],["T_OBJECT_OPERATOR","->",774],["T_STRING","connection",774],["T_OBJECT_OPERATOR","->",774],["T_STRING","query",774],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_VARIABLE","$table",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_CONSTANT_ENCAPSED_STRING","'} RENAME \"'",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_VARIABLE","$field",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_CONSTANT_ENCAPSED_STRING","'\" TO \"'",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_VARIABLE","$field_new",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_CONSTANT_ENCAPSED_STRING","'\"'",774],")",";",["T_WHITESPACE","\n    ",774],"}",["T_WHITESPACE","\n\n    ",775],["T_COMMENT","\/\/ Add unsigned check if necessary.\n",777],["T_WHITESPACE","    ",778],["T_IF","if",778],["T_WHITESPACE"," ",778],"(","!",["T_EMPTY","empty",778],"(",["T_VARIABLE","$spec",778],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",778],"]",")",")",["T_WHITESPACE"," ",778],"{",["T_WHITESPACE","\n      ",778],["T_VARIABLE","$this",779],["T_OBJECT_OPERATOR","->",779],["T_STRING","connection",779],["T_OBJECT_OPERATOR","->",779],["T_STRING","query",779],"(",["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE {'",779],["T_WHITESPACE"," ",779],".",["T_WHITESPACE"," ",779],["T_VARIABLE","$table",779],["T_WHITESPACE"," ",779],".",["T_WHITESPACE"," ",779],["T_CONSTANT_ENCAPSED_STRING","'} ADD CHECK (\"'",779],["T_WHITESPACE"," ",779],".",["T_WHITESPACE"," ",779],["T_VARIABLE","$field_new",779],["T_WHITESPACE"," ",779],".",["T_WHITESPACE"," ",779],["T_CONSTANT_ENCAPSED_STRING","'\" >= 0)'",779],")",";",["T_WHITESPACE","\n    ",779],"}",["T_WHITESPACE","\n\n    ",780],["T_COMMENT","\/\/ Add default if necessary.\n",782],["T_WHITESPACE","    ",783],["T_IF","if",783],["T_WHITESPACE"," ",783],"(",["T_ISSET","isset",783],"(",["T_VARIABLE","$spec",783],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",783],"]",")",")",["T_WHITESPACE"," ",783],"{",["T_WHITESPACE","\n      ",783],["T_VARIABLE","$this",784],["T_OBJECT_OPERATOR","->",784],["T_STRING","fieldSetDefault",784],"(",["T_VARIABLE","$table",784],",",["T_WHITESPACE"," ",784],["T_VARIABLE","$field_new",784],",",["T_WHITESPACE"," ",784],["T_VARIABLE","$spec",784],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",784],"]",")",";",["T_WHITESPACE","\n    ",784],"}",["T_WHITESPACE","\n\n    ",785],["T_COMMENT","\/\/ Change description if necessary.\n",787],["T_WHITESPACE","    ",788],["T_IF","if",788],["T_WHITESPACE"," ",788],"(","!",["T_EMPTY","empty",788],"(",["T_VARIABLE","$spec",788],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",788],"]",")",")",["T_WHITESPACE"," ",788],"{",["T_WHITESPACE","\n      ",788],["T_VARIABLE","$this",789],["T_OBJECT_OPERATOR","->",789],["T_STRING","connection",789],["T_OBJECT_OPERATOR","->",789],["T_STRING","query",789],"(",["T_CONSTANT_ENCAPSED_STRING","'COMMENT ON COLUMN {'",789],["T_WHITESPACE"," ",789],".",["T_WHITESPACE"," ",789],["T_VARIABLE","$table",789],["T_WHITESPACE"," ",789],".",["T_WHITESPACE"," ",789],["T_CONSTANT_ENCAPSED_STRING","'}.\"'",789],["T_WHITESPACE"," ",789],".",["T_WHITESPACE"," ",789],["T_VARIABLE","$field_new",789],["T_WHITESPACE"," ",789],".",["T_WHITESPACE"," ",789],["T_CONSTANT_ENCAPSED_STRING","'\" IS '",789],["T_WHITESPACE"," ",789],".",["T_WHITESPACE"," ",789],["T_VARIABLE","$this",789],["T_OBJECT_OPERATOR","->",789],["T_STRING","prepareComment",789],"(",["T_VARIABLE","$spec",789],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",789],"]",")",")",";",["T_WHITESPACE","\n    ",789],"}",["T_WHITESPACE","\n\n    ",790],["T_IF","if",792],["T_WHITESPACE"," ",792],"(",["T_ISSET","isset",792],"(",["T_VARIABLE","$new_keys",792],")",")",["T_WHITESPACE"," ",792],"{",["T_WHITESPACE","\n      ",792],["T_VARIABLE","$this",793],["T_OBJECT_OPERATOR","->",793],["T_STRING","_createKeys",793],"(",["T_VARIABLE","$table",793],",",["T_WHITESPACE"," ",793],["T_VARIABLE","$new_keys",793],")",";",["T_WHITESPACE","\n    ",793],"}",["T_WHITESPACE","\n    ",794],["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","resetTableInformation",795],"(",["T_VARIABLE","$table",795],")",";",["T_WHITESPACE","\n  ",795],"}",["T_WHITESPACE","\n\n  ",796],["T_PROTECTED","protected",798],["T_WHITESPACE"," ",798],["T_FUNCTION","function",798],["T_WHITESPACE"," ",798],["T_STRING","_createIndexSql",798],"(",["T_VARIABLE","$table",798],",",["T_WHITESPACE"," ",798],["T_VARIABLE","$name",798],",",["T_WHITESPACE"," ",798],["T_VARIABLE","$fields",798],")",["T_WHITESPACE"," ",798],"{",["T_WHITESPACE","\n    ",798],["T_VARIABLE","$query",799],["T_WHITESPACE"," ",799],"=",["T_WHITESPACE"," ",799],["T_CONSTANT_ENCAPSED_STRING","'CREATE INDEX '",799],["T_WHITESPACE"," ",799],".",["T_WHITESPACE"," ",799],["T_VARIABLE","$this",799],["T_OBJECT_OPERATOR","->",799],["T_STRING","ensureIdentifiersLength",799],"(",["T_VARIABLE","$table",799],",",["T_WHITESPACE"," ",799],["T_VARIABLE","$name",799],",",["T_WHITESPACE"," ",799],["T_CONSTANT_ENCAPSED_STRING","'idx'",799],")",["T_WHITESPACE"," ",799],".",["T_WHITESPACE"," ",799],["T_CONSTANT_ENCAPSED_STRING","' ON {'",799],["T_WHITESPACE"," ",799],".",["T_WHITESPACE"," ",799],["T_VARIABLE","$table",799],["T_WHITESPACE"," ",799],".",["T_WHITESPACE"," ",799],["T_CONSTANT_ENCAPSED_STRING","'} ('",799],";",["T_WHITESPACE","\n    ",799],["T_VARIABLE","$query",800],["T_WHITESPACE"," ",800],["T_CONCAT_EQUAL",".=",800],["T_WHITESPACE"," ",800],["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","_createKeySql",800],"(",["T_VARIABLE","$fields",800],")",["T_WHITESPACE"," ",800],".",["T_WHITESPACE"," ",800],["T_CONSTANT_ENCAPSED_STRING","')'",800],";",["T_WHITESPACE","\n    ",800],["T_RETURN","return",801],["T_WHITESPACE"," ",801],["T_VARIABLE","$query",801],";",["T_WHITESPACE","\n  ",801],"}",["T_WHITESPACE","\n\n  ",802],["T_PROTECTED","protected",804],["T_WHITESPACE"," ",804],["T_FUNCTION","function",804],["T_WHITESPACE"," ",804],["T_STRING","_createKeys",804],"(",["T_VARIABLE","$table",804],",",["T_WHITESPACE"," ",804],["T_VARIABLE","$new_keys",804],")",["T_WHITESPACE"," ",804],"{",["T_WHITESPACE","\n    ",804],["T_IF","if",805],["T_WHITESPACE"," ",805],"(",["T_ISSET","isset",805],"(",["T_VARIABLE","$new_keys",805],"[",["T_CONSTANT_ENCAPSED_STRING","'primary key'",805],"]",")",")",["T_WHITESPACE"," ",805],"{",["T_WHITESPACE","\n      ",805],["T_VARIABLE","$this",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","addPrimaryKey",806],"(",["T_VARIABLE","$table",806],",",["T_WHITESPACE"," ",806],["T_VARIABLE","$new_keys",806],"[",["T_CONSTANT_ENCAPSED_STRING","'primary key'",806],"]",")",";",["T_WHITESPACE","\n    ",806],"}",["T_WHITESPACE","\n    ",807],["T_IF","if",808],["T_WHITESPACE"," ",808],"(",["T_ISSET","isset",808],"(",["T_VARIABLE","$new_keys",808],"[",["T_CONSTANT_ENCAPSED_STRING","'unique keys'",808],"]",")",")",["T_WHITESPACE"," ",808],"{",["T_WHITESPACE","\n      ",808],["T_FOREACH","foreach",809],["T_WHITESPACE"," ",809],"(",["T_VARIABLE","$new_keys",809],"[",["T_CONSTANT_ENCAPSED_STRING","'unique keys'",809],"]",["T_WHITESPACE"," ",809],["T_AS","as",809],["T_WHITESPACE"," ",809],["T_VARIABLE","$name",809],["T_WHITESPACE"," ",809],["T_DOUBLE_ARROW","=>",809],["T_WHITESPACE"," ",809],["T_VARIABLE","$fields",809],")",["T_WHITESPACE"," ",809],"{",["T_WHITESPACE","\n        ",809],["T_VARIABLE","$this",810],["T_OBJECT_OPERATOR","->",810],["T_STRING","addUniqueKey",810],"(",["T_VARIABLE","$table",810],",",["T_WHITESPACE"," ",810],["T_VARIABLE","$name",810],",",["T_WHITESPACE"," ",810],["T_VARIABLE","$fields",810],")",";",["T_WHITESPACE","\n      ",810],"}",["T_WHITESPACE","\n    ",811],"}",["T_WHITESPACE","\n    ",812],["T_IF","if",813],["T_WHITESPACE"," ",813],"(",["T_ISSET","isset",813],"(",["T_VARIABLE","$new_keys",813],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",813],"]",")",")",["T_WHITESPACE"," ",813],"{",["T_WHITESPACE","\n      ",813],["T_FOREACH","foreach",814],["T_WHITESPACE"," ",814],"(",["T_VARIABLE","$new_keys",814],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",814],"]",["T_WHITESPACE"," ",814],["T_AS","as",814],["T_WHITESPACE"," ",814],["T_VARIABLE","$name",814],["T_WHITESPACE"," ",814],["T_DOUBLE_ARROW","=>",814],["T_WHITESPACE"," ",814],["T_VARIABLE","$fields",814],")",["T_WHITESPACE"," ",814],"{",["T_WHITESPACE","\n        ",814],["T_COMMENT","\/\/ Even though $new_keys is not a full schema it still has 'indexes' and\n",815],["T_WHITESPACE","        ",816],["T_COMMENT","\/\/ so is a partial schema. Technically addIndex() doesn't do anything\n",816],["T_WHITESPACE","        ",817],["T_COMMENT","\/\/ with it so passing an empty array would work as well.\n",817],["T_WHITESPACE","        ",818],["T_VARIABLE","$this",818],["T_OBJECT_OPERATOR","->",818],["T_STRING","addIndex",818],"(",["T_VARIABLE","$table",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$name",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$fields",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$new_keys",818],")",";",["T_WHITESPACE","\n      ",818],"}",["T_WHITESPACE","\n    ",819],"}",["T_WHITESPACE","\n  ",820],"}",["T_WHITESPACE","\n\n  ",821],["T_DOC_COMMENT","\/**\n   * Retrieve a table or column comment.\n   *\/",823],["T_WHITESPACE","\n  ",825],["T_PUBLIC","public",826],["T_WHITESPACE"," ",826],["T_FUNCTION","function",826],["T_WHITESPACE"," ",826],["T_STRING","getComment",826],"(",["T_VARIABLE","$table",826],",",["T_WHITESPACE"," ",826],["T_VARIABLE","$column",826],["T_WHITESPACE"," ",826],"=",["T_WHITESPACE"," ",826],["T_STRING","NULL",826],")",["T_WHITESPACE"," ",826],"{",["T_WHITESPACE","\n    ",826],["T_VARIABLE","$info",827],["T_WHITESPACE"," ",827],"=",["T_WHITESPACE"," ",827],["T_VARIABLE","$this",827],["T_OBJECT_OPERATOR","->",827],["T_STRING","getPrefixInfo",827],"(",["T_VARIABLE","$table",827],")",";",["T_WHITESPACE","\n    ",827],["T_COMMENT","\/\/ Don't use {} around pg_class, pg_attribute tables.\n",828],["T_WHITESPACE","    ",829],["T_IF","if",829],["T_WHITESPACE"," ",829],"(",["T_ISSET","isset",829],"(",["T_VARIABLE","$column",829],")",")",["T_WHITESPACE"," ",829],"{",["T_WHITESPACE","\n      ",829],["T_RETURN","return",830],["T_WHITESPACE"," ",830],["T_VARIABLE","$this",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","connection",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","query",830],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT col_description(oid, attnum) FROM pg_class, pg_attribute WHERE attrelid = oid AND relname = ? AND attname = ?'",830],",",["T_WHITESPACE"," ",830],["T_ARRAY","array",830],"(",["T_VARIABLE","$info",830],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",830],"]",",",["T_WHITESPACE"," ",830],["T_VARIABLE","$column",830],")",")",["T_OBJECT_OPERATOR","->",830],["T_STRING","fetchField",830],"(",")",";",["T_WHITESPACE","\n    ",830],"}",["T_WHITESPACE","\n    ",831],["T_ELSE","else",832],["T_WHITESPACE"," ",832],"{",["T_WHITESPACE","\n      ",832],["T_RETURN","return",833],["T_WHITESPACE"," ",833],["T_VARIABLE","$this",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","connection",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","query",833],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT obj_description(oid, ?) FROM pg_class WHERE relname = ?'",833],",",["T_WHITESPACE"," ",833],["T_ARRAY","array",833],"(",["T_CONSTANT_ENCAPSED_STRING","'pg_class'",833],",",["T_WHITESPACE"," ",833],["T_VARIABLE","$info",833],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",833],"]",")",")",["T_OBJECT_OPERATOR","->",833],["T_STRING","fetchField",833],"(",")",";",["T_WHITESPACE","\n    ",833],"}",["T_WHITESPACE","\n  ",834],"}",["T_WHITESPACE","\n\n  ",835],["T_DOC_COMMENT","\/**\n   * Calculates a base-64 encoded, PostgreSQL-safe sha-256 hash per PostgreSQL\n   * documentation: 4.1. Lexical Structure.\n   *\n   * @param $data\n   *   String to be hashed.\n   * @return string\n   *   A base-64 encoded sha-256 hash, with + and \/ replaced with _ and any =\n   *   padding characters removed.\n   *\/",837],["T_WHITESPACE","\n  ",846],["T_PROTECTED","protected",847],["T_WHITESPACE"," ",847],["T_FUNCTION","function",847],["T_WHITESPACE"," ",847],["T_STRING","hashBase64",847],"(",["T_VARIABLE","$data",847],")",["T_WHITESPACE"," ",847],"{",["T_WHITESPACE","\n    ",847],["T_VARIABLE","$hash",848],["T_WHITESPACE"," ",848],"=",["T_WHITESPACE"," ",848],["T_STRING","base64_encode",848],"(",["T_STRING","hash",848],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",848],",",["T_WHITESPACE"," ",848],["T_VARIABLE","$data",848],",",["T_WHITESPACE"," ",848],["T_STRING","TRUE",848],")",")",";",["T_WHITESPACE","\n    ",848],["T_COMMENT","\/\/ Modify the hash so it's safe to use in PostgreSQL identifiers.\n",849],["T_WHITESPACE","    ",850],["T_RETURN","return",850],["T_WHITESPACE"," ",850],["T_STRING","strtr",850],"(",["T_VARIABLE","$hash",850],",",["T_WHITESPACE"," ",850],["T_ARRAY","array",850],"(",["T_CONSTANT_ENCAPSED_STRING","'+'",850],["T_WHITESPACE"," ",850],["T_DOUBLE_ARROW","=>",850],["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","'_'",850],",",["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","'\/'",850],["T_WHITESPACE"," ",850],["T_DOUBLE_ARROW","=>",850],["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","'_'",850],",",["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","'='",850],["T_WHITESPACE"," ",850],["T_DOUBLE_ARROW","=>",850],["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","''",850],")",")",";",["T_WHITESPACE","\n  ",850],"}",["T_WHITESPACE","\n\n",851],"}",["T_WHITESPACE","\n\n",853],["T_DOC_COMMENT","\/**\n * @} End of \"addtogroup schemaapi\".\n *\/",855],["T_WHITESPACE","\n",857]]