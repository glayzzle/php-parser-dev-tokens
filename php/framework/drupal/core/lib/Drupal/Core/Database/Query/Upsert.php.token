[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Query",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Connection",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Database",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Database",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * General class for an abstracted \"Upsert\" (UPDATE or INSERT) query operation.\n *\n * This class can only be used with a table with a single unique index.\n * Often, this will be the primary key. On such a table this class works like\n * Insert except the rows will be set to the desired values even if the key\n * existed before.\n *\/",8],["T_WHITESPACE","\n",15],["T_ABSTRACT","abstract",16],["T_WHITESPACE"," ",16],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Upsert",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_STRING","Query",16],["T_WHITESPACE"," ",16],["T_IMPLEMENTS","implements",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Countable",16],["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\n  ",16],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","InsertTrait",18],";",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * The unique or primary key of the table.\n   *\n   * @var string\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$key",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * Constructs an Upsert object.\n   *\n   * @param \\Drupal\\Core\\Database\\Connection $connection\n   *   A Connection object.\n   * @param string $table\n   *   Name of the table to associate with this query.\n   * @param array $options\n   *   (optional) An array of database options.\n   *\/",27],["T_WHITESPACE","\n  ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","__construct",37],"(",["T_STRING","Connection",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$connection",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$table",37],",",["T_WHITESPACE"," ",37],["T_ARRAY","array",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$options",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],"[","]",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$options",38],"[",["T_CONSTANT_ENCAPSED_STRING","'return'",38],"]",["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","Database",38],["T_DOUBLE_COLON","::",38],["T_STRING","RETURN_AFFECTED",38],";",["T_WHITESPACE","\n    ",38],["T_STRING","parent",39],["T_DOUBLE_COLON","::",39],["T_STRING","__construct",39],"(",["T_VARIABLE","$connection",39],",",["T_WHITESPACE"," ",39],["T_VARIABLE","$options",39],")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","table",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$table",40],";",["T_WHITESPACE","\n  ",40],"}",["T_WHITESPACE","\n\n  ",41],["T_DOC_COMMENT","\/**\n   * Sets the unique \/ primary key field to be used as condition for this query.\n   *\n   * @param string $field\n   *   The name of the field to set.\n   *\n   * @return $this\n   *\/",43],["T_WHITESPACE","\n  ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","key",51],"(",["T_VARIABLE","$field",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","key",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$field",52],";",["T_WHITESPACE","\n\n    ",52],["T_RETURN","return",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],";",["T_WHITESPACE","\n  ",54],"}",["T_WHITESPACE","\n\n  ",55],["T_DOC_COMMENT","\/**\n   * Preprocesses and validates the query.\n   *\n   * @return bool\n   *   TRUE if the validation was successful, FALSE otherwise.\n   *\n   * @throws \\Drupal\\Core\\Database\\Query\\NoUniqueFieldException\n   * @throws \\Drupal\\Core\\Database\\Query\\FieldsOverlapException\n   * @throws \\Drupal\\Core\\Database\\Query\\NoFieldsException\n   *\/",57],["T_WHITESPACE","\n  ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","preExecute",67],"(",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n    ",67],["T_COMMENT","\/\/ Confirm that the user set the unique\/primary key of the table.\n",68],["T_WHITESPACE","    ",69],["T_IF","if",69],["T_WHITESPACE"," ",69],"(","!",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","key",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n      ",69],["T_THROW","throw",70],["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","NoUniqueFieldException",70],"(",["T_CONSTANT_ENCAPSED_STRING","'There is no unique field specified.'",70],")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_COMMENT","\/\/ Confirm that the user did not try to specify an identical\n",73],["T_WHITESPACE","    ",74],["T_COMMENT","\/\/ field and default field.\n",74],["T_WHITESPACE","    ",75],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_STRING","array_intersect",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","insertFields",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","defaultFields",75],")",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n      ",75],["T_THROW","throw",76],["T_WHITESPACE"," ",76],["T_NEW","new",76],["T_WHITESPACE"," ",76],["T_STRING","FieldsOverlapException",76],"(",["T_CONSTANT_ENCAPSED_STRING","'You may not specify the same field to have a value and a schema-default value.'",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_COMMENT","\/\/ Don't execute query without fields.\n",79],["T_WHITESPACE","    ",80],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","count",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","insertFields",80],")",["T_WHITESPACE"," ",80],"+",["T_WHITESPACE"," ",80],["T_STRING","count",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","defaultFields",80],")",["T_WHITESPACE"," ",80],["T_IS_EQUAL","==",80],["T_WHITESPACE"," ",80],["T_LNUMBER","0",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n      ",80],["T_THROW","throw",81],["T_WHITESPACE"," ",81],["T_NEW","new",81],["T_WHITESPACE"," ",81],["T_STRING","NoFieldsException",81],"(",["T_CONSTANT_ENCAPSED_STRING","'There are no fields available to insert with.'",81],")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_COMMENT","\/\/ If no values have been added, silently ignore this query. This can happen\n",84],["T_WHITESPACE","    ",85],["T_COMMENT","\/\/ if values are added conditionally, so we don't want to throw an\n",85],["T_WHITESPACE","    ",86],["T_COMMENT","\/\/ exception.\n",86],["T_WHITESPACE","    ",87],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_ISSET","isset",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","insertValues",87],"[",["T_LNUMBER","0",87],"]",")",["T_WHITESPACE"," ",87],["T_BOOLEAN_OR","||",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","insertFields",87],";",["T_WHITESPACE","\n  ",87],"}",["T_WHITESPACE","\n\n  ",88],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",90],["T_WHITESPACE","\n  ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","execute",93],"(",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n    ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(","!",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","preExecute",94],"(",")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n      ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_STRING","NULL",95],";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_VARIABLE","$max_placeholder",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_LNUMBER","0",98],";",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$values",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_ARRAY","array",99],"(",")",";",["T_WHITESPACE","\n    ",99],["T_FOREACH","foreach",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","insertValues",100],["T_WHITESPACE"," ",100],["T_AS","as",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$insert_values",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n      ",100],["T_FOREACH","foreach",101],["T_WHITESPACE"," ",101],"(",["T_VARIABLE","$insert_values",101],["T_WHITESPACE"," ",101],["T_AS","as",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$value",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$values",102],"[",["T_CONSTANT_ENCAPSED_STRING","':db_insert_placeholder_'",102],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_VARIABLE","$max_placeholder",102],["T_INC","++",102],"]",["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$value",102],";",["T_WHITESPACE","\n      ",102],"}",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_VARIABLE","$last_insert_id",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","connection",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","query",106],"(",["T_STRING_CAST","(string)",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$values",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","queryOptions",106],")",";",["T_WHITESPACE","\n\n    ",106],["T_COMMENT","\/\/ Re-initialize the values array so that we can re-use this query.\n",108],["T_WHITESPACE","    ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","insertValues",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_ARRAY","array",109],"(",")",";",["T_WHITESPACE","\n\n    ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$last_insert_id",111],";",["T_WHITESPACE","\n  ",111],"}",["T_WHITESPACE","\n\n",112],"}",["T_WHITESPACE","\n",114]]