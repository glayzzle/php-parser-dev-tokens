[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Entity",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Element",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Crypt",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Utility",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Tags",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntityReferenceSelection",8],["T_NS_SEPARATOR","\\",8],["T_STRING","SelectionInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","EntityReferenceSelection",9],["T_NS_SEPARATOR","\\",9],["T_STRING","SelectionWithAutocreateInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Form",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FormStateInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Core",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Render",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Element",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Textfield",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Site",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Settings",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Provides an entity autocomplete form element.\n *\n * The #default_value accepted by this element is either an entity object or an\n * array of entity objects.\n *\n * @FormElement(\"entity_autocomplete\")\n *\/",14],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","EntityAutocomplete",22],["T_WHITESPACE"," ",22],["T_EXTENDS","extends",22],["T_WHITESPACE"," ",22],["T_STRING","Textfield",22],["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",24],["T_WHITESPACE","\n  ",26],["T_PUBLIC","public",27],["T_WHITESPACE"," ",27],["T_FUNCTION","function",27],["T_WHITESPACE"," ",27],["T_STRING","getInfo",27],"(",")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n    ",27],["T_VARIABLE","$info",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_STRING","parent",28],["T_DOUBLE_COLON","::",28],["T_STRING","getInfo",28],"(",")",";",["T_WHITESPACE","\n    ",28],["T_VARIABLE","$class",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_STRING","get_class",29],"(",["T_VARIABLE","$this",29],")",";",["T_WHITESPACE","\n\n    ",29],["T_COMMENT","\/\/ Apply default form element properties.\n",31],["T_WHITESPACE","    ",32],["T_VARIABLE","$info",32],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",32],"]",["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","NULL",32],";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$info",33],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_handler'",33],"]",["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'default'",33],";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$info",34],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_settings'",34],"]",["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_ARRAY","array",34],"(",")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$info",35],"[",["T_CONSTANT_ENCAPSED_STRING","'#tags'",35],"]",["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","FALSE",35],";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$info",36],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",36],"]",["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_STRING","NULL",36],";",["T_WHITESPACE","\n    ",36],["T_COMMENT","\/\/ This should only be set to FALSE if proper validation by the selection\n",37],["T_WHITESPACE","    ",38],["T_COMMENT","\/\/ handler is performed at another level on the extracted form values.\n",38],["T_WHITESPACE","    ",39],["T_VARIABLE","$info",39],"[",["T_CONSTANT_ENCAPSED_STRING","'#validate_reference'",39],"]",["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","TRUE",39],";",["T_WHITESPACE","\n    ",39],["T_COMMENT","\/\/ IMPORTANT! This should only be set to FALSE if the #default_value\n",40],["T_WHITESPACE","    ",41],["T_COMMENT","\/\/ property is processed at another level (e.g. by a Field API widget) and\n",41],["T_WHITESPACE","    ",42],["T_COMMENT","\/\/ it's value is properly checked for access.\n",42],["T_WHITESPACE","    ",43],["T_VARIABLE","$info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'#process_default_value'",43],"]",["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","TRUE",43],";",["T_WHITESPACE","\n\n    ",43],["T_VARIABLE","$info",45],"[",["T_CONSTANT_ENCAPSED_STRING","'#element_validate'",45],"]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_ARRAY","array",45],"(",["T_VARIABLE","$class",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'validateEntityAutocomplete'",45],")",")",";",["T_WHITESPACE","\n    ",45],["T_STRING","array_unshift",46],"(",["T_VARIABLE","$info",46],"[",["T_CONSTANT_ENCAPSED_STRING","'#process'",46],"]",",",["T_WHITESPACE"," ",46],["T_ARRAY","array",46],"(",["T_VARIABLE","$class",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'processEntityAutocomplete'",46],")",")",";",["T_WHITESPACE","\n\n    ",46],["T_RETURN","return",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$info",48],";",["T_WHITESPACE","\n  ",48],"}",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",51],["T_WHITESPACE","\n  ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_STATIC","static",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","valueCallback",54],"(","&",["T_VARIABLE","$element",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$input",54],",",["T_WHITESPACE"," ",54],["T_STRING","FormStateInterface",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$form_state",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n    ",54],["T_COMMENT","\/\/ Process the #default_value property.\n",55],["T_WHITESPACE","    ",56],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$input",56],["T_WHITESPACE"," ",56],["T_IS_IDENTICAL","===",56],["T_WHITESPACE"," ",56],["T_STRING","FALSE",56],["T_WHITESPACE"," ",56],["T_BOOLEAN_AND","&&",56],["T_WHITESPACE"," ",56],["T_ISSET","isset",56],"(",["T_VARIABLE","$element",56],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",56],"]",")",["T_WHITESPACE"," ",56],["T_BOOLEAN_AND","&&",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$element",56],"[",["T_CONSTANT_ENCAPSED_STRING","'#process_default_value'",56],"]",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n      ",56],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_STRING","is_array",57],"(",["T_VARIABLE","$element",57],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",57],"]",")",["T_WHITESPACE"," ",57],["T_BOOLEAN_AND","&&",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$element",57],"[",["T_CONSTANT_ENCAPSED_STRING","'#tags'",57],"]",["T_WHITESPACE"," ",57],["T_IS_NOT_IDENTICAL","!==",57],["T_WHITESPACE"," ",57],["T_STRING","TRUE",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n        ",57],["T_THROW","throw",58],["T_WHITESPACE"," ",58],["T_NEW","new",58],["T_WHITESPACE"," ",58],["T_NS_SEPARATOR","\\",58],["T_STRING","InvalidArgumentException",58],"(",["T_CONSTANT_ENCAPSED_STRING","'The #default_value property is an array but the form element does not allow multiple values.'",58],")",";",["T_WHITESPACE","\n      ",58],"}",["T_WHITESPACE","\n      ",59],["T_ELSEIF","elseif",60],["T_WHITESPACE"," ",60],"(","!",["T_EMPTY","empty",60],"(",["T_VARIABLE","$element",60],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",60],"]",")",["T_WHITESPACE"," ",60],["T_BOOLEAN_AND","&&",60],["T_WHITESPACE"," ",60],"!",["T_STRING","is_array",60],"(",["T_VARIABLE","$element",60],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",60],"]",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n        ",60],["T_COMMENT","\/\/ Convert the default value into an array for easier processing in\n",61],["T_WHITESPACE","        ",62],["T_COMMENT","\/\/ static::getEntityLabels().\n",62],["T_WHITESPACE","        ",63],["T_VARIABLE","$element",63],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",63],"]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",["T_VARIABLE","$element",63],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",63],"]",")",";",["T_WHITESPACE","\n      ",63],"}",["T_WHITESPACE","\n\n      ",64],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$element",66],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",66],"]",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!","(",["T_STRING","reset",67],"(",["T_VARIABLE","$element",67],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",67],"]",")",["T_WHITESPACE"," ",67],["T_INSTANCEOF","instanceof",67],["T_WHITESPACE"," ",67],["T_STRING","EntityInterface",67],")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n          ",67],["T_THROW","throw",68],["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_NS_SEPARATOR","\\",68],["T_STRING","InvalidArgumentException",68],"(",["T_CONSTANT_ENCAPSED_STRING","'The #default_value property has to be an entity object or an array of entity objects.'",68],")",";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n\n        ",69],["T_COMMENT","\/\/ Extract the labels from the passed-in entity objects, taking access\n",71],["T_WHITESPACE","        ",72],["T_COMMENT","\/\/ checks into account.\n",72],["T_WHITESPACE","        ",73],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_STATIC","static",73],["T_DOUBLE_COLON","::",73],["T_STRING","getEntityLabels",73],"(",["T_VARIABLE","$element",73],"[",["T_CONSTANT_ENCAPSED_STRING","'#default_value'",73],"]",")",";",["T_WHITESPACE","\n      ",73],"}",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Potentially the #value is set directly, so it contains the 'target_id'\n",77],["T_WHITESPACE","    ",78],["T_COMMENT","\/\/ array structure instead of a string.\n",78],["T_WHITESPACE","    ",79],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$input",79],["T_WHITESPACE"," ",79],["T_IS_NOT_IDENTICAL","!==",79],["T_WHITESPACE"," ",79],["T_STRING","FALSE",79],["T_WHITESPACE"," ",79],["T_BOOLEAN_AND","&&",79],["T_WHITESPACE"," ",79],["T_STRING","is_array",79],"(",["T_VARIABLE","$input",79],")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n      ",79],["T_VARIABLE","$entity_ids",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","array_map",80],"(",["T_FUNCTION","function",80],"(",["T_ARRAY","array",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$item",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$item",81],"[",["T_CONSTANT_ENCAPSED_STRING","'target_id'",81],"]",";",["T_WHITESPACE","\n      ",81],"}",",",["T_WHITESPACE"," ",82],["T_VARIABLE","$input",82],")",";",["T_WHITESPACE","\n\n      ",82],["T_VARIABLE","$entities",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_NS_SEPARATOR","\\",84],["T_STRING","Drupal",84],["T_DOUBLE_COLON","::",84],["T_STRING","entityTypeManager",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","getStorage",84],"(",["T_VARIABLE","$element",84],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",84],"]",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","loadMultiple",84],"(",["T_VARIABLE","$entity_ids",84],")",";",["T_WHITESPACE","\n\n      ",84],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_STATIC","static",86],["T_DOUBLE_COLON","::",86],["T_STRING","getEntityLabels",86],"(",["T_VARIABLE","$entities",86],")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n  ",87],"}",["T_WHITESPACE","\n\n  ",88],["T_DOC_COMMENT","\/**\n   * Adds entity autocomplete functionality to a form element.\n   *\n   * @param array $element\n   *   The form element to process. Properties used:\n   *   - #target_type: The ID of the target entity type.\n   *   - #selection_handler: The plugin ID of the entity reference selection\n   *     handler.\n   *   - #selection_settings: An array of settings that will be passed to the\n   *     selection handler.\n   * @param \\Drupal\\Core\\Form\\FormStateInterface $form_state\n   *   The current state of the form.\n   * @param array $complete_form\n   *   The complete form structure.\n   *\n   * @return array\n   *   The form element.\n   *\n   * @throws \\InvalidArgumentException\n   *   Exception thrown when the #target_type or #autocreate['bundle'] are\n   *   missing.\n   *\/",90],["T_WHITESPACE","\n  ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_STATIC","static",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","processEntityAutocomplete",112],"(",["T_ARRAY","array",112],["T_WHITESPACE"," ",112],"&",["T_VARIABLE","$element",112],",",["T_WHITESPACE"," ",112],["T_STRING","FormStateInterface",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$form_state",112],",",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],["T_WHITESPACE"," ",112],"&",["T_VARIABLE","$complete_form",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n    ",112],["T_COMMENT","\/\/ Nothing to do if there is no target entity type.\n",113],["T_WHITESPACE","    ",114],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_EMPTY","empty",114],"(",["T_VARIABLE","$element",114],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",114],"]",")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n      ",114],["T_THROW","throw",115],["T_WHITESPACE"," ",115],["T_NEW","new",115],["T_WHITESPACE"," ",115],["T_NS_SEPARATOR","\\",115],["T_STRING","InvalidArgumentException",115],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing required #target_type parameter.'",115],")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_COMMENT","\/\/ Provide default values and sanity checks for the #autocreate parameter.\n",118],["T_WHITESPACE","    ",119],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$element",119],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",119],"]",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n      ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_ISSET","isset",120],"(",["T_VARIABLE","$element",120],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",120],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",120],"]",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n        ",120],["T_THROW","throw",121],["T_WHITESPACE"," ",121],["T_NEW","new",121],["T_WHITESPACE"," ",121],["T_NS_SEPARATOR","\\",121],["T_STRING","InvalidArgumentException",121],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing required #autocreate['bundle'] parameter.\"",121],")",";",["T_WHITESPACE","\n      ",121],"}",["T_WHITESPACE","\n      ",122],["T_COMMENT","\/\/ Default the autocreate user ID to the current user.\n",123],["T_WHITESPACE","      ",124],["T_VARIABLE","$element",124],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",124],"]","[",["T_CONSTANT_ENCAPSED_STRING","'uid'",124],"]",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_ISSET","isset",124],"(",["T_VARIABLE","$element",124],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",124],"]","[",["T_CONSTANT_ENCAPSED_STRING","'uid'",124],"]",")",["T_WHITESPACE"," ",124],"?",["T_WHITESPACE"," ",124],["T_VARIABLE","$element",124],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",124],"]","[",["T_CONSTANT_ENCAPSED_STRING","'uid'",124],"]",["T_WHITESPACE"," ",124],":",["T_WHITESPACE"," ",124],["T_NS_SEPARATOR","\\",124],["T_STRING","Drupal",124],["T_DOUBLE_COLON","::",124],["T_STRING","currentUser",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","id",124],"(",")",";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_COMMENT","\/\/ Store the selection settings in the key\/value store and pass a hashed key\n",127],["T_WHITESPACE","    ",128],["T_COMMENT","\/\/ in the route parameters.\n",128],["T_WHITESPACE","    ",129],["T_VARIABLE","$selection_settings",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_ISSET","isset",129],"(",["T_VARIABLE","$element",129],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_settings'",129],"]",")",["T_WHITESPACE"," ",129],"?",["T_WHITESPACE"," ",129],["T_VARIABLE","$element",129],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_settings'",129],"]",["T_WHITESPACE"," ",129],":",["T_WHITESPACE"," ",129],"[","]",";",["T_WHITESPACE","\n    ",129],["T_VARIABLE","$data",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","serialize",130],"(",["T_VARIABLE","$selection_settings",130],")",["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_VARIABLE","$element",130],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",130],"]",["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_VARIABLE","$element",130],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_handler'",130],"]",";",["T_WHITESPACE","\n    ",130],["T_VARIABLE","$selection_settings_key",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","Crypt",131],["T_DOUBLE_COLON","::",131],["T_STRING","hmacBase64",131],"(",["T_VARIABLE","$data",131],",",["T_WHITESPACE"," ",131],["T_STRING","Settings",131],["T_DOUBLE_COLON","::",131],["T_STRING","getHashSalt",131],"(",")",")",";",["T_WHITESPACE","\n\n    ",131],["T_VARIABLE","$key_value_storage",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Drupal",133],["T_DOUBLE_COLON","::",133],["T_STRING","keyValue",133],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_autocomplete'",133],")",";",["T_WHITESPACE","\n    ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(","!",["T_VARIABLE","$key_value_storage",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","has",134],"(",["T_VARIABLE","$selection_settings_key",134],")",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n      ",134],["T_VARIABLE","$key_value_storage",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","set",135],"(",["T_VARIABLE","$selection_settings_key",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$selection_settings",135],")",";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_VARIABLE","$element",138],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocomplete_route_name'",138],"]",["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'system.entity_autocomplete'",138],";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$element",139],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocomplete_route_parameters'",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_ARRAY","array",139],"(",["T_WHITESPACE","\n      ",139],["T_CONSTANT_ENCAPSED_STRING","'target_type'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$element",140],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",140],"]",",",["T_WHITESPACE","\n      ",140],["T_CONSTANT_ENCAPSED_STRING","'selection_handler'",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$element",141],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_handler'",141],"]",",",["T_WHITESPACE","\n      ",141],["T_CONSTANT_ENCAPSED_STRING","'selection_settings_key'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$selection_settings_key",142],",",["T_WHITESPACE","\n    ",142],")",";",["T_WHITESPACE","\n\n    ",143],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$element",145],";",["T_WHITESPACE","\n  ",145],"}",["T_WHITESPACE","\n\n  ",146],["T_DOC_COMMENT","\/**\n   * Form element validation handler for entity_autocomplete elements.\n   *\/",148],["T_WHITESPACE","\n  ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_STATIC","static",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","validateEntityAutocomplete",151],"(",["T_ARRAY","array",151],["T_WHITESPACE"," ",151],"&",["T_VARIABLE","$element",151],",",["T_WHITESPACE"," ",151],["T_STRING","FormStateInterface",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$form_state",151],",",["T_WHITESPACE"," ",151],["T_ARRAY","array",151],["T_WHITESPACE"," ",151],"&",["T_VARIABLE","$complete_form",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$value",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","NULL",152],";",["T_WHITESPACE","\n\n    ",152],["T_IF","if",154],["T_WHITESPACE"," ",154],"(","!",["T_EMPTY","empty",154],"(",["T_VARIABLE","$element",154],"[",["T_CONSTANT_ENCAPSED_STRING","'#value'",154],"]",")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n      ",154],["T_VARIABLE","$options",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],"(",["T_WHITESPACE","\n        ",155],["T_CONSTANT_ENCAPSED_STRING","'target_type'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$element",156],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",156],"]",",",["T_WHITESPACE","\n        ",156],["T_CONSTANT_ENCAPSED_STRING","'handler'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$element",157],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_handler'",157],"]",",",["T_WHITESPACE","\n        ",157],["T_CONSTANT_ENCAPSED_STRING","'handler_settings'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$element",158],"[",["T_CONSTANT_ENCAPSED_STRING","'#selection_settings'",158],"]",",",["T_WHITESPACE","\n      ",158],")",";",["T_WHITESPACE","\n      ",159],["T_DOC_COMMENT","\/** @var \/Drupal\\Core\\Entity\\EntityReferenceSelection\\SelectionInterface $handler *\/",160],["T_WHITESPACE","\n      ",160],["T_VARIABLE","$handler",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_NS_SEPARATOR","\\",161],["T_STRING","Drupal",161],["T_DOUBLE_COLON","::",161],["T_STRING","service",161],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.entity_reference_selection'",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","getInstance",161],"(",["T_VARIABLE","$options",161],")",";",["T_WHITESPACE","\n      ",161],["T_VARIABLE","$autocreate",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_BOOL_CAST","(bool)",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$element",162],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",162],"]",["T_WHITESPACE"," ",162],["T_BOOLEAN_AND","&&",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$handler",162],["T_WHITESPACE"," ",162],["T_INSTANCEOF","instanceof",162],["T_WHITESPACE"," ",162],["T_STRING","SelectionWithAutocreateInterface",162],";",["T_WHITESPACE","\n\n      ",162],["T_COMMENT","\/\/ GET forms might pass the validated data around on the next request, in\n",164],["T_WHITESPACE","      ",165],["T_COMMENT","\/\/ which case it will already be in the expected format.\n",165],["T_WHITESPACE","      ",166],["T_IF","if",166],["T_WHITESPACE"," ",166],"(",["T_STRING","is_array",166],"(",["T_VARIABLE","$element",166],"[",["T_CONSTANT_ENCAPSED_STRING","'#value'",166],"]",")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$value",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$element",167],"[",["T_CONSTANT_ENCAPSED_STRING","'#value'",167],"]",";",["T_WHITESPACE","\n      ",167],"}",["T_WHITESPACE","\n      ",168],["T_ELSE","else",169],["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$input_values",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$element",170],"[",["T_CONSTANT_ENCAPSED_STRING","'#tags'",170],"]",["T_WHITESPACE"," ",170],"?",["T_WHITESPACE"," ",170],["T_STRING","Tags",170],["T_DOUBLE_COLON","::",170],["T_STRING","explode",170],"(",["T_VARIABLE","$element",170],"[",["T_CONSTANT_ENCAPSED_STRING","'#value'",170],"]",")",["T_WHITESPACE"," ",170],":",["T_WHITESPACE"," ",170],["T_ARRAY","array",170],"(",["T_VARIABLE","$element",170],"[",["T_CONSTANT_ENCAPSED_STRING","'#value'",170],"]",")",";",["T_WHITESPACE","\n\n        ",170],["T_FOREACH","foreach",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$input_values",172],["T_WHITESPACE"," ",172],["T_AS","as",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$input",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n          ",172],["T_VARIABLE","$match",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STATIC","static",173],["T_DOUBLE_COLON","::",173],["T_STRING","extractEntityIdFromAutocompleteInput",173],"(",["T_VARIABLE","$input",173],")",";",["T_WHITESPACE","\n          ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$match",174],["T_WHITESPACE"," ",174],["T_IS_IDENTICAL","===",174],["T_WHITESPACE"," ",174],["T_STRING","NULL",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_COMMENT","\/\/ Try to get a match from the input string when the user didn't use\n",175],["T_WHITESPACE","            ",176],["T_COMMENT","\/\/ the autocomplete but filled in a value manually.\n",176],["T_WHITESPACE","            ",177],["T_VARIABLE","$match",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_STATIC","static",177],["T_DOUBLE_COLON","::",177],["T_STRING","matchEntityByTitle",177],"(",["T_VARIABLE","$handler",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$input",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$element",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$form_state",177],",",["T_WHITESPACE"," ",177],"!",["T_VARIABLE","$autocreate",177],")",";",["T_WHITESPACE","\n          ",177],"}",["T_WHITESPACE","\n\n          ",178],["T_IF","if",180],["T_WHITESPACE"," ",180],"(",["T_VARIABLE","$match",180],["T_WHITESPACE"," ",180],["T_IS_NOT_IDENTICAL","!==",180],["T_WHITESPACE"," ",180],["T_STRING","NULL",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$value",181],"[","]",["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_ARRAY","array",181],"(",["T_WHITESPACE","\n              ",181],["T_CONSTANT_ENCAPSED_STRING","'target_id'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$match",182],",",["T_WHITESPACE","\n            ",182],")",";",["T_WHITESPACE","\n          ",183],"}",["T_WHITESPACE","\n          ",184],["T_ELSEIF","elseif",185],["T_WHITESPACE"," ",185],"(",["T_VARIABLE","$autocreate",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\EntityReferenceSelection\\SelectionWithAutocreateInterface $handler *\/",186],["T_WHITESPACE","\n            ",186],["T_COMMENT","\/\/ Auto-create item. See an example of how this is handled in\n",187],["T_WHITESPACE","            ",188],["T_COMMENT","\/\/ \\Drupal\\Core\\Field\\Plugin\\Field\\FieldType\\EntityReferenceItem::presave().\n",188],["T_WHITESPACE","            ",189],["T_VARIABLE","$value",189],"[","]",["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_ARRAY","array",189],"(",["T_WHITESPACE","\n              ",189],["T_CONSTANT_ENCAPSED_STRING","'entity'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$handler",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","createNewEntity",190],"(",["T_VARIABLE","$element",190],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",190],"]",",",["T_WHITESPACE"," ",190],["T_VARIABLE","$element",190],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",190],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",190],"]",",",["T_WHITESPACE"," ",190],["T_VARIABLE","$input",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$element",190],"[",["T_CONSTANT_ENCAPSED_STRING","'#autocreate'",190],"]","[",["T_CONSTANT_ENCAPSED_STRING","'uid'",190],"]",")",",",["T_WHITESPACE","\n            ",190],")",";",["T_WHITESPACE","\n          ",191],"}",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n      ",193],"}",["T_WHITESPACE","\n\n      ",194],["T_COMMENT","\/\/ Check that the referenced entities are valid, if needed.\n",196],["T_WHITESPACE","      ",197],["T_IF","if",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$element",197],"[",["T_CONSTANT_ENCAPSED_STRING","'#validate_reference'",197],"]",["T_WHITESPACE"," ",197],["T_BOOLEAN_AND","&&",197],["T_WHITESPACE"," ",197],"!",["T_EMPTY","empty",197],"(",["T_VARIABLE","$value",197],")",")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n        ",197],["T_COMMENT","\/\/ Validate existing entities.\n",198],["T_WHITESPACE","        ",199],["T_VARIABLE","$ids",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","array_reduce",199],"(",["T_VARIABLE","$value",199],",",["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$return",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$item",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n          ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_ISSET","isset",200],"(",["T_VARIABLE","$item",200],"[",["T_CONSTANT_ENCAPSED_STRING","'target_id'",200],"]",")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$return",201],"[","]",["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$item",201],"[",["T_CONSTANT_ENCAPSED_STRING","'target_id'",201],"]",";",["T_WHITESPACE","\n          ",201],"}",["T_WHITESPACE","\n          ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$return",203],";",["T_WHITESPACE","\n        ",203],"}",")",";",["T_WHITESPACE","\n\n        ",204],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$ids",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n          ",206],["T_VARIABLE","$valid_ids",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$handler",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","validateReferenceableEntities",207],"(",["T_VARIABLE","$ids",207],")",";",["T_WHITESPACE","\n          ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$invalid_ids",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","array_diff",208],"(",["T_VARIABLE","$ids",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$valid_ids",208],")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_FOREACH","foreach",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$invalid_ids",209],["T_WHITESPACE"," ",209],["T_AS","as",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$invalid_id",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n              ",209],["T_VARIABLE","$form_state",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","setError",210],"(",["T_VARIABLE","$element",210],",",["T_WHITESPACE"," ",210],["T_STRING","t",210],"(",["T_CONSTANT_ENCAPSED_STRING","'The referenced entity (%type: %id) does not exist.'",210],",",["T_WHITESPACE"," ",210],["T_ARRAY","array",210],"(",["T_CONSTANT_ENCAPSED_STRING","'%type'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$element",210],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",210],"]",",",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'%id'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$invalid_id",210],")",")",")",";",["T_WHITESPACE","\n            ",210],"}",["T_WHITESPACE","\n          ",211],"}",["T_WHITESPACE","\n        ",212],"}",["T_WHITESPACE","\n\n        ",213],["T_COMMENT","\/\/ Validate newly created entities.\n",215],["T_WHITESPACE","        ",216],["T_VARIABLE","$new_entities",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_STRING","array_reduce",216],"(",["T_VARIABLE","$value",216],",",["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$return",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$item",216],")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n          ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_ISSET","isset",217],"(",["T_VARIABLE","$item",217],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",217],"]",")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$return",218],"[","]",["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$item",218],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",218],"]",";",["T_WHITESPACE","\n          ",218],"}",["T_WHITESPACE","\n          ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$return",220],";",["T_WHITESPACE","\n        ",220],"}",")",";",["T_WHITESPACE","\n\n        ",221],["T_IF","if",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$new_entities",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n          ",223],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$autocreate",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$valid_new_entities",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$handler",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","validateReferenceableNewEntities",225],"(",["T_VARIABLE","$new_entities",225],")",";",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$invalid_new_entities",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_STRING","array_diff_key",226],"(",["T_VARIABLE","$new_entities",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$valid_new_entities",226],")",";",["T_WHITESPACE","\n          ",226],"}",["T_WHITESPACE","\n          ",227],["T_ELSE","else",228],["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_COMMENT","\/\/ If the selection handler does not support referencing newly\n",229],["T_WHITESPACE","            ",230],["T_COMMENT","\/\/ created entities, all of them should be invalidated.\n",230],["T_WHITESPACE","            ",231],["T_VARIABLE","$invalid_new_entities",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$new_entities",231],";",["T_WHITESPACE","\n          ",231],"}",["T_WHITESPACE","\n\n          ",232],["T_FOREACH","foreach",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$invalid_new_entities",234],["T_WHITESPACE"," ",234],["T_AS","as",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$entity",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\EntityInterface $entity *\/",235],["T_WHITESPACE","\n            ",235],["T_VARIABLE","$form_state",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","setError",236],"(",["T_VARIABLE","$element",236],",",["T_WHITESPACE"," ",236],["T_STRING","t",236],"(",["T_CONSTANT_ENCAPSED_STRING","'This entity (%type: %label) cannot be referenced.'",236],",",["T_WHITESPACE"," ",236],["T_ARRAY","array",236],"(",["T_CONSTANT_ENCAPSED_STRING","'%type'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$element",236],"[",["T_CONSTANT_ENCAPSED_STRING","'#target_type'",236],"]",",",["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'%label'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$entity",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","label",236],"(",")",")",")",")",";",["T_WHITESPACE","\n          ",236],"}",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE","\n      ",238],"}",["T_WHITESPACE","\n\n      ",239],["T_COMMENT","\/\/ Use only the last value if the form element does not support multiple\n",241],["T_WHITESPACE","      ",242],["T_COMMENT","\/\/ matches (tags).\n",242],["T_WHITESPACE","      ",243],["T_IF","if",243],["T_WHITESPACE"," ",243],"(","!",["T_VARIABLE","$element",243],"[",["T_CONSTANT_ENCAPSED_STRING","'#tags'",243],"]",["T_WHITESPACE"," ",243],["T_BOOLEAN_AND","&&",243],["T_WHITESPACE"," ",243],"!",["T_EMPTY","empty",243],"(",["T_VARIABLE","$value",243],")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$last_value",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$value",244],"[",["T_STRING","count",244],"(",["T_VARIABLE","$value",244],")",["T_WHITESPACE"," ",244],"-",["T_WHITESPACE"," ",244],["T_LNUMBER","1",244],"]",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$value",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_ISSET","isset",245],"(",["T_VARIABLE","$last_value",245],"[",["T_CONSTANT_ENCAPSED_STRING","'target_id'",245],"]",")",["T_WHITESPACE"," ",245],"?",["T_WHITESPACE"," ",245],["T_VARIABLE","$last_value",245],"[",["T_CONSTANT_ENCAPSED_STRING","'target_id'",245],"]",["T_WHITESPACE"," ",245],":",["T_WHITESPACE"," ",245],["T_VARIABLE","$last_value",245],";",["T_WHITESPACE","\n      ",245],"}",["T_WHITESPACE","\n    ",246],"}",["T_WHITESPACE","\n\n    ",247],["T_VARIABLE","$form_state",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","setValueForElement",249],"(",["T_VARIABLE","$element",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$value",249],")",";",["T_WHITESPACE","\n  ",249],"}",["T_WHITESPACE","\n\n  ",250],["T_DOC_COMMENT","\/**\n   * Finds an entity from an autocomplete input without an explicit ID.\n   *\n   * The method will return an entity ID if one single entity unambuguously\n   * matches the incoming input, and sill assign form errors otherwise.\n   *\n   * @param \\Drupal\\Core\\Entity\\EntityReferenceSelection\\SelectionInterface $handler\n   *   Entity reference selection plugin.\n   * @param string $input\n   *   Single string from autocomplete element.\n   * @param array $element\n   *   The form element to set a form error.\n   * @param \\Drupal\\Core\\Form\\FormStateInterface $form_state\n   *   The current form state.\n   * @param bool $strict\n   *   Whether to trigger a form error if an element from $input (eg. an entity)\n   *   is not found.\n   *\n   * @return int|null\n   *   Value of a matching entity ID, or NULL if none.\n   *\/",252],["T_WHITESPACE","\n  ",272],["T_PROTECTED","protected",273],["T_WHITESPACE"," ",273],["T_STATIC","static",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","matchEntityByTitle",273],"(",["T_STRING","SelectionInterface",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$handler",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$input",273],",",["T_WHITESPACE"," ",273],["T_ARRAY","array",273],["T_WHITESPACE"," ",273],"&",["T_VARIABLE","$element",273],",",["T_WHITESPACE"," ",273],["T_STRING","FormStateInterface",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$form_state",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$strict",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n    ",273],["T_VARIABLE","$entities_by_bundle",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$handler",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getReferenceableEntities",274],"(",["T_VARIABLE","$input",274],",",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'='",274],",",["T_WHITESPACE"," ",274],["T_LNUMBER","6",274],")",";",["T_WHITESPACE","\n    ",274],["T_VARIABLE","$entities",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_STRING","array_reduce",275],"(",["T_VARIABLE","$entities_by_bundle",275],",",["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],"(",["T_VARIABLE","$flattened",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$bundle_entities",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n      ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$flattened",276],["T_WHITESPACE"," ",276],"+",["T_WHITESPACE"," ",276],["T_VARIABLE","$bundle_entities",276],";",["T_WHITESPACE","\n    ",276],"}",",",["T_WHITESPACE"," ",277],"[","]",")",";",["T_WHITESPACE","\n    ",277],["T_VARIABLE","$params",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_ARRAY","array",278],"(",["T_WHITESPACE","\n      ",278],["T_CONSTANT_ENCAPSED_STRING","'%value'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$input",279],",",["T_WHITESPACE","\n      ",279],["T_CONSTANT_ENCAPSED_STRING","'@value'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$input",280],",",["T_WHITESPACE","\n    ",280],")",";",["T_WHITESPACE","\n    ",281],["T_IF","if",282],["T_WHITESPACE"," ",282],"(",["T_EMPTY","empty",282],"(",["T_VARIABLE","$entities",282],")",")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n      ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_VARIABLE","$strict",283],")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n        ",283],["T_COMMENT","\/\/ Error if there are no entities available for a required field.\n",284],["T_WHITESPACE","        ",285],["T_VARIABLE","$form_state",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","setError",285],"(",["T_VARIABLE","$element",285],",",["T_WHITESPACE"," ",285],["T_STRING","t",285],"(",["T_CONSTANT_ENCAPSED_STRING","'There are no entities matching \"%value\".'",285],",",["T_WHITESPACE"," ",285],["T_VARIABLE","$params",285],")",")",";",["T_WHITESPACE","\n      ",285],"}",["T_WHITESPACE","\n    ",286],"}",["T_WHITESPACE","\n    ",287],["T_ELSEIF","elseif",288],["T_WHITESPACE"," ",288],"(",["T_STRING","count",288],"(",["T_VARIABLE","$entities",288],")",["T_WHITESPACE"," ",288],">",["T_WHITESPACE"," ",288],["T_LNUMBER","5",288],")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n      ",288],["T_VARIABLE","$params",289],"[",["T_CONSTANT_ENCAPSED_STRING","'@id'",289],"]",["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_STRING","key",289],"(",["T_VARIABLE","$entities",289],")",";",["T_WHITESPACE","\n      ",289],["T_COMMENT","\/\/ Error if there are more than 5 matching entities.\n",290],["T_WHITESPACE","      ",291],["T_VARIABLE","$form_state",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","setError",291],"(",["T_VARIABLE","$element",291],",",["T_WHITESPACE"," ",291],["T_STRING","t",291],"(",["T_CONSTANT_ENCAPSED_STRING","'Many entities are called %value. Specify the one you want by appending the id in parentheses, like \"@value (@id)\".'",291],",",["T_WHITESPACE"," ",291],["T_VARIABLE","$params",291],")",")",";",["T_WHITESPACE","\n    ",291],"}",["T_WHITESPACE","\n    ",292],["T_ELSEIF","elseif",293],["T_WHITESPACE"," ",293],"(",["T_STRING","count",293],"(",["T_VARIABLE","$entities",293],")",["T_WHITESPACE"," ",293],">",["T_WHITESPACE"," ",293],["T_LNUMBER","1",293],")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n      ",293],["T_COMMENT","\/\/ More helpful error if there are only a few matching entities.\n",294],["T_WHITESPACE","      ",295],["T_VARIABLE","$multiples",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_ARRAY","array",295],"(",")",";",["T_WHITESPACE","\n      ",295],["T_FOREACH","foreach",296],["T_WHITESPACE"," ",296],"(",["T_VARIABLE","$entities",296],["T_WHITESPACE"," ",296],["T_AS","as",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$id",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$name",296],")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n        ",296],["T_VARIABLE","$multiples",297],"[","]",["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$name",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","' ('",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_VARIABLE","$id",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","')'",297],";",["T_WHITESPACE","\n      ",297],"}",["T_WHITESPACE","\n      ",298],["T_VARIABLE","$params",299],"[",["T_CONSTANT_ENCAPSED_STRING","'@id'",299],"]",["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$id",299],";",["T_WHITESPACE","\n      ",299],["T_VARIABLE","$form_state",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","setError",300],"(",["T_VARIABLE","$element",300],",",["T_WHITESPACE"," ",300],["T_STRING","t",300],"(",["T_CONSTANT_ENCAPSED_STRING","'Multiple entities match this reference; \"%multiple\". Specify the one you want by appending the id in parentheses, like \"@value (@id)\".'",300],",",["T_WHITESPACE"," ",300],["T_ARRAY","array",300],"(",["T_CONSTANT_ENCAPSED_STRING","'%multiple'",300],["T_WHITESPACE"," ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_STRING","implode",300],"(",["T_CONSTANT_ENCAPSED_STRING","'\", \"'",300],",",["T_WHITESPACE"," ",300],["T_VARIABLE","$multiples",300],")",")",["T_WHITESPACE"," ",300],"+",["T_WHITESPACE"," ",300],["T_VARIABLE","$params",300],")",")",";",["T_WHITESPACE","\n    ",300],"}",["T_WHITESPACE","\n    ",301],["T_ELSE","else",302],["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n      ",302],["T_COMMENT","\/\/ Take the one and only matching entity.\n",303],["T_WHITESPACE","      ",304],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_STRING","key",304],"(",["T_VARIABLE","$entities",304],")",";",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n  ",305],"}",["T_WHITESPACE","\n\n  ",306],["T_DOC_COMMENT","\/**\n   * Converts an array of entity objects into a string of entity labels.\n   *\n   * This method is also responsible for checking the 'view label' access on the\n   * passed-in entities.\n   *\n   * @param \\Drupal\\Core\\Entity\\EntityInterface[] $entities\n   *   An array of entity objects.\n   *\n   * @return string\n   *   A string of entity labels separated by commas.\n   *\/",308],["T_WHITESPACE","\n  ",319],["T_PUBLIC","public",320],["T_WHITESPACE"," ",320],["T_STATIC","static",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","getEntityLabels",320],"(",["T_ARRAY","array",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$entities",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n    ",320],["T_VARIABLE","$entity_labels",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_ARRAY","array",321],"(",")",";",["T_WHITESPACE","\n    ",321],["T_FOREACH","foreach",322],["T_WHITESPACE"," ",322],"(",["T_VARIABLE","$entities",322],["T_WHITESPACE"," ",322],["T_AS","as",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$entity",322],")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n      ",322],["T_COMMENT","\/\/ Use the special view label, since some entities allow the label to be\n",323],["T_WHITESPACE","      ",324],["T_COMMENT","\/\/ viewed, even if the entity is not allowed to be viewed.\n",324],["T_WHITESPACE","      ",325],["T_VARIABLE","$label",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$entity",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","access",325],"(",["T_CONSTANT_ENCAPSED_STRING","'view label'",325],")",")",["T_WHITESPACE"," ",325],"?",["T_WHITESPACE"," ",325],["T_VARIABLE","$entity",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","label",325],"(",")",["T_WHITESPACE"," ",325],":",["T_WHITESPACE"," ",325],["T_STRING","t",325],"(",["T_CONSTANT_ENCAPSED_STRING","'- Restricted access -'",325],")",";",["T_WHITESPACE","\n\n      ",325],["T_COMMENT","\/\/ Take into account \"autocreated\" entities.\n",327],["T_WHITESPACE","      ",328],["T_IF","if",328],["T_WHITESPACE"," ",328],"(","!",["T_VARIABLE","$entity",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","isNew",328],"(",")",")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n        ",328],["T_VARIABLE","$label",329],["T_WHITESPACE"," ",329],["T_CONCAT_EQUAL",".=",329],["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","' ('",329],["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_VARIABLE","$entity",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","id",329],"(",")",["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","')'",329],";",["T_WHITESPACE","\n      ",329],"}",["T_WHITESPACE","\n\n      ",330],["T_COMMENT","\/\/ Labels containing commas or quotes must be wrapped in quotes.\n",332],["T_WHITESPACE","      ",333],["T_VARIABLE","$entity_labels",333],"[","]",["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_STRING","Tags",333],["T_DOUBLE_COLON","::",333],["T_STRING","encode",333],"(",["T_VARIABLE","$label",333],")",";",["T_WHITESPACE","\n    ",333],"}",["T_WHITESPACE","\n\n    ",334],["T_RETURN","return",336],["T_WHITESPACE"," ",336],["T_STRING","implode",336],"(",["T_CONSTANT_ENCAPSED_STRING","', '",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$entity_labels",336],")",";",["T_WHITESPACE","\n  ",336],"}",["T_WHITESPACE","\n\n  ",337],["T_DOC_COMMENT","\/**\n   * Extracts the entity ID from the autocompletion result.\n   *\n   * @param string $input\n   *   The input coming from the autocompletion result.\n   *\n   * @return mixed|null\n   *   An entity ID or NULL if the input does not contain one.\n   *\/",339],["T_WHITESPACE","\n  ",347],["T_PUBLIC","public",348],["T_WHITESPACE"," ",348],["T_STATIC","static",348],["T_WHITESPACE"," ",348],["T_FUNCTION","function",348],["T_WHITESPACE"," ",348],["T_STRING","extractEntityIdFromAutocompleteInput",348],"(",["T_VARIABLE","$input",348],")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n    ",348],["T_VARIABLE","$match",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_STRING","NULL",349],";",["T_WHITESPACE","\n\n    ",349],["T_COMMENT","\/\/ Take \"label (entity id)', match the ID from inside the parentheses.\n",351],["T_WHITESPACE","    ",352],["T_COMMENT","\/\/ @todo Add support for entities containing parentheses in their ID.\n",352],["T_WHITESPACE","    ",353],["T_COMMENT","\/\/ @see https:\/\/www.drupal.org\/node\/2520416\n",353],["T_WHITESPACE","    ",354],["T_IF","if",354],["T_WHITESPACE"," ",354],"(",["T_STRING","preg_match",354],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/.+\\s\\(([^\\)]+)\\)\/\"",354],",",["T_WHITESPACE"," ",354],["T_VARIABLE","$input",354],",",["T_WHITESPACE"," ",354],["T_VARIABLE","$matches",354],")",")",["T_WHITESPACE"," ",354],"{",["T_WHITESPACE","\n      ",354],["T_VARIABLE","$match",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$matches",355],"[",["T_LNUMBER","1",355],"]",";",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n\n    ",356],["T_RETURN","return",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$match",358],";",["T_WHITESPACE","\n  ",358],"}",["T_WHITESPACE","\n\n",359],"}",["T_WHITESPACE","\n",361]]