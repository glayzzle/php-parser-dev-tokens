[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Flood",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","SchemaObjectExistsException",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Symfony",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","HttpFoundation",6],["T_NS_SEPARATOR","\\",6],["T_STRING","RequestStack",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Database",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Connection",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Defines the database flood backend. This is the default Drupal backend.\n *\/",9],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","DatabaseBackend",12],["T_WHITESPACE"," ",12],["T_IMPLEMENTS","implements",12],["T_WHITESPACE"," ",12],["T_STRING","FloodInterface",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * The database table name.\n   *\/",14],["T_WHITESPACE","\n  ",16],["T_CONST","const",17],["T_WHITESPACE"," ",17],["T_STRING","TABLE_NAME",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'flood'",17],";",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * The database connection used to store flood event information.\n   *\n   * @var \\Drupal\\Core\\Database\\Connection\n   *\/",19],["T_WHITESPACE","\n  ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$connection",24],";",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * The request stack.\n   *\n   * @var \\Symfony\\Component\\HttpFoundation\\RequestStack\n   *\/",26],["T_WHITESPACE","\n  ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$requestStack",31],";",["T_WHITESPACE","\n\n  ",31],["T_DOC_COMMENT","\/**\n   * Construct the DatabaseBackend.\n   *\n   * @param \\Drupal\\Core\\Database\\Connection $connection\n   *   The database connection which will be used to store the flood event\n   *   information.\n   * @param \\Symfony\\Component\\HttpFoundation\\RequestStack $request_stack\n   *   The request stack used to retrieve the current request.\n   *\/",33],["T_WHITESPACE","\n  ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","__construct",42],"(",["T_STRING","Connection",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$connection",42],",",["T_WHITESPACE"," ",42],["T_STRING","RequestStack",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$request_stack",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","connection",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$connection",43],";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","requestStack",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$request_stack",44],";",["T_WHITESPACE","\n  ",44],"}",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",47],["T_WHITESPACE","\n  ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","register",50],"(",["T_VARIABLE","$name",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$window",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_LNUMBER","3600",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$identifier",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","NULL",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_IF","if",51],["T_WHITESPACE"," ",51],"(","!",["T_ISSET","isset",51],"(",["T_VARIABLE","$identifier",51],")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n      ",51],["T_VARIABLE","$identifier",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","requestStack",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getCurrentRequest",52],"(",")",["T_OBJECT_OPERATOR","->",52],["T_STRING","getClientIp",52],"(",")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$try_again",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","FALSE",54],";",["T_WHITESPACE","\n    ",54],["T_TRY","try",55],["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n      ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","doInsert",56],"(",["T_VARIABLE","$name",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$window",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$identifier",56],")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n    ",57],["T_CATCH","catch",58],["T_WHITESPACE"," ",58],"(",["T_NS_SEPARATOR","\\",58],["T_STRING","Exception",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$e",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n      ",58],["T_VARIABLE","$try_again",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","ensureTableExists",59],"(",")",";",["T_WHITESPACE","\n      ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(","!",["T_VARIABLE","$try_again",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n        ",60],["T_THROW","throw",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$e",61],";",["T_WHITESPACE","\n      ",61],"}",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n    ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$try_again",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n      ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","doInsert",65],"(",["T_VARIABLE","$name",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$window",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$identifier",65],")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n  ",66],"}",["T_WHITESPACE","\n\n  ",67],["T_DOC_COMMENT","\/**\n   * Inserts an event into the flood table\n   *\n   * @param string $name\n   *   The name of an event.\n   * @param int $window\n   *   Number of seconds before this event expires.\n   * @param string $identifier\n   *   Unique identifier of the current user.\n   *\n   * @see \\Drupal\\Core\\Flood\\DatabaseBackend::register\n   *\/",69],["T_WHITESPACE","\n  ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","doInsert",81],"(",["T_VARIABLE","$name",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$window",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$identifier",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","connection",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","insert",82],"(",["T_STATIC","static",82],["T_DOUBLE_COLON","::",82],["T_STRING","TABLE_NAME",82],")",["T_WHITESPACE","\n      ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","fields",83],"(",["T_ARRAY","array",83],"(",["T_WHITESPACE","\n        ",83],["T_CONSTANT_ENCAPSED_STRING","'event'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$name",84],",",["T_WHITESPACE","\n        ",84],["T_CONSTANT_ENCAPSED_STRING","'identifier'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$identifier",85],",",["T_WHITESPACE","\n        ",85],["T_CONSTANT_ENCAPSED_STRING","'timestamp'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","REQUEST_TIME",86],",",["T_WHITESPACE","\n        ",86],["T_CONSTANT_ENCAPSED_STRING","'expiration'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_STRING","REQUEST_TIME",87],["T_WHITESPACE"," ",87],"+",["T_WHITESPACE"," ",87],["T_VARIABLE","$window",87],",",["T_WHITESPACE","\n      ",87],")",")",["T_WHITESPACE","\n      ",88],["T_OBJECT_OPERATOR","->",89],["T_STRING","execute",89],"(",")",";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",92],["T_WHITESPACE","\n  ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","clear",95],"(",["T_VARIABLE","$name",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$identifier",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","NULL",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n    ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_ISSET","isset",96],"(",["T_VARIABLE","$identifier",96],")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$identifier",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","requestStack",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getCurrentRequest",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getClientIp",97],"(",")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n    ",98],["T_TRY","try",99],["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","connection",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","delete",100],"(",["T_STATIC","static",100],["T_DOUBLE_COLON","::",100],["T_STRING","TABLE_NAME",100],")",["T_WHITESPACE","\n        ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","condition",101],"(",["T_CONSTANT_ENCAPSED_STRING","'event'",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$name",101],")",["T_WHITESPACE","\n        ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","condition",102],"(",["T_CONSTANT_ENCAPSED_STRING","'identifier'",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$identifier",102],")",["T_WHITESPACE","\n        ",102],["T_OBJECT_OPERATOR","->",103],["T_STRING","execute",103],"(",")",";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n    ",104],["T_CATCH","catch",105],["T_WHITESPACE"," ",105],"(",["T_NS_SEPARATOR","\\",105],["T_STRING","Exception",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$e",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n      ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","catchException",106],"(",["T_VARIABLE","$e",106],")",";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n  ",107],"}",["T_WHITESPACE","\n\n  ",108],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",110],["T_WHITESPACE","\n  ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","isAllowed",113],"(",["T_VARIABLE","$name",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$threshold",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$window",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_LNUMBER","3600",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$identifier",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","NULL",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n    ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(","!",["T_ISSET","isset",114],"(",["T_VARIABLE","$identifier",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n      ",114],["T_VARIABLE","$identifier",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","requestStack",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getCurrentRequest",115],"(",")",["T_OBJECT_OPERATOR","->",115],["T_STRING","getClientIp",115],"(",")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n    ",116],["T_TRY","try",117],["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n      ",117],["T_VARIABLE","$number",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","connection",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","select",118],"(",["T_STATIC","static",118],["T_DOUBLE_COLON","::",118],["T_STRING","TABLE_NAME",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'f'",118],")",["T_WHITESPACE","\n        ",118],["T_OBJECT_OPERATOR","->",119],["T_STRING","condition",119],"(",["T_CONSTANT_ENCAPSED_STRING","'event'",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$name",119],")",["T_WHITESPACE","\n        ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","condition",120],"(",["T_CONSTANT_ENCAPSED_STRING","'identifier'",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$identifier",120],")",["T_WHITESPACE","\n        ",120],["T_OBJECT_OPERATOR","->",121],["T_STRING","condition",121],"(",["T_CONSTANT_ENCAPSED_STRING","'timestamp'",121],",",["T_WHITESPACE"," ",121],["T_STRING","REQUEST_TIME",121],["T_WHITESPACE"," ",121],"-",["T_WHITESPACE"," ",121],["T_VARIABLE","$window",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'>'",121],")",["T_WHITESPACE","\n        ",121],["T_OBJECT_OPERATOR","->",122],["T_STRING","countQuery",122],"(",")",["T_WHITESPACE","\n        ",122],["T_OBJECT_OPERATOR","->",123],["T_STRING","execute",123],"(",")",["T_WHITESPACE","\n        ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","fetchField",124],"(",")",";",["T_WHITESPACE","\n      ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$number",125],["T_WHITESPACE"," ",125],"<",["T_WHITESPACE"," ",125],["T_VARIABLE","$threshold",125],")",";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n    ",126],["T_CATCH","catch",127],["T_WHITESPACE"," ",127],"(",["T_NS_SEPARATOR","\\",127],["T_STRING","Exception",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$e",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n      ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","catchException",128],"(",["T_VARIABLE","$e",128],")",";",["T_WHITESPACE","\n      ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","TRUE",129],";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n  ",130],"}",["T_WHITESPACE","\n\n  ",131],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",133],["T_WHITESPACE","\n  ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","garbageCollection",136],"(",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n    ",136],["T_TRY","try",137],["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n      ",137],["T_VARIABLE","$return",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","connection",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","delete",138],"(",["T_STATIC","static",138],["T_DOUBLE_COLON","::",138],["T_STRING","TABLE_NAME",138],")",["T_WHITESPACE","\n        ",138],["T_OBJECT_OPERATOR","->",139],["T_STRING","condition",139],"(",["T_CONSTANT_ENCAPSED_STRING","'expiration'",139],",",["T_WHITESPACE"," ",139],["T_STRING","REQUEST_TIME",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'<'",139],")",["T_WHITESPACE","\n        ",139],["T_OBJECT_OPERATOR","->",140],["T_STRING","execute",140],"(",")",";",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n    ",141],["T_CATCH","catch",142],["T_WHITESPACE"," ",142],"(",["T_NS_SEPARATOR","\\",142],["T_STRING","Exception",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$e",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n      ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","catchException",143],"(",["T_VARIABLE","$e",143],")",";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n  ",144],"}",["T_WHITESPACE","\n\n  ",145],["T_DOC_COMMENT","\/**\n   * Check if the flood table exists and create it if not.\n   *\/",147],["T_WHITESPACE","\n  ",149],["T_PROTECTED","protected",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","ensureTableExists",150],"(",")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n    ",150],["T_TRY","try",151],["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n      ",151],["T_VARIABLE","$database_schema",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","connection",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","schema",152],"(",")",";",["T_WHITESPACE","\n      ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(","!",["T_VARIABLE","$database_schema",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","tableExists",153],"(",["T_STATIC","static",153],["T_DOUBLE_COLON","::",153],["T_STRING","TABLE_NAME",153],")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$schema_definition",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","schemaDefinition",154],"(",")",";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$database_schema",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","createTable",155],"(",["T_STATIC","static",155],["T_DOUBLE_COLON","::",155],["T_STRING","TABLE_NAME",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$schema_definition",155],")",";",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_STRING","TRUE",156],";",["T_WHITESPACE","\n      ",156],"}",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n    ",158],["T_COMMENT","\/\/ If another process has already created the table, attempting to create\n",159],["T_WHITESPACE","    ",160],["T_COMMENT","\/\/ it will throw an exception. In this case just catch the exception and do\n",160],["T_WHITESPACE","    ",161],["T_COMMENT","\/\/ nothing.\n",161],["T_WHITESPACE","    ",162],["T_CATCH","catch",162],["T_WHITESPACE"," ",162],"(",["T_STRING","SchemaObjectExistsException",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$e",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n      ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","TRUE",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n    ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_STRING","FALSE",165],";",["T_WHITESPACE","\n  ",165],"}",["T_WHITESPACE","\n\n  ",166],["T_DOC_COMMENT","\/**\n   * Act on an exception when flood might be stale.\n   *\n   * If the table does not yet exist, that's fine, but if the table exists and\n   * yet the query failed, then the flood is stale and the exception needs to\n   * propagate.\n   *\n   * @param $e\n   *   The exception.\n   *\n   * @throws \\Exception\n   *\/",168],["T_WHITESPACE","\n  ",179],["T_PROTECTED","protected",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","catchException",180],"(",["T_NS_SEPARATOR","\\",180],["T_STRING","Exception",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$e",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n    ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","connection",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","schema",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","tableExists",181],"(",["T_STATIC","static",181],["T_DOUBLE_COLON","::",181],["T_STRING","TABLE_NAME",181],")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n      ",181],["T_THROW","throw",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$e",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n  ",183],"}",["T_WHITESPACE","\n\n  ",184],["T_DOC_COMMENT","\/**\n   * Defines the schema for the flood table.\n   *\/",186],["T_WHITESPACE","\n  ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","schemaDefinition",189],"(",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n    ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],"[",["T_WHITESPACE","\n      ",190],["T_CONSTANT_ENCAPSED_STRING","'description'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'Flood controls the threshold of events, such as the number of contact attempts.'",191],",",["T_WHITESPACE","\n      ",191],["T_CONSTANT_ENCAPSED_STRING","'fields'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],"[",["T_WHITESPACE","\n        ",192],["T_CONSTANT_ENCAPSED_STRING","'fid'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],"[",["T_WHITESPACE","\n          ",193],["T_CONSTANT_ENCAPSED_STRING","'description'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'Unique flood event ID.'",194],",",["T_WHITESPACE","\n          ",194],["T_CONSTANT_ENCAPSED_STRING","'type'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'serial'",195],",",["T_WHITESPACE","\n          ",195],["T_CONSTANT_ENCAPSED_STRING","'not null'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_STRING","TRUE",196],",",["T_WHITESPACE","\n        ",196],"]",",",["T_WHITESPACE","\n        ",197],["T_CONSTANT_ENCAPSED_STRING","'event'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],"[",["T_WHITESPACE","\n          ",198],["T_CONSTANT_ENCAPSED_STRING","'description'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'Name of event (e.g. contact).'",199],",",["T_WHITESPACE","\n          ",199],["T_CONSTANT_ENCAPSED_STRING","'type'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii'",200],",",["T_WHITESPACE","\n          ",200],["T_CONSTANT_ENCAPSED_STRING","'length'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_LNUMBER","64",201],",",["T_WHITESPACE","\n          ",201],["T_CONSTANT_ENCAPSED_STRING","'not null'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_STRING","TRUE",202],",",["T_WHITESPACE","\n          ",202],["T_CONSTANT_ENCAPSED_STRING","'default'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","''",203],",",["T_WHITESPACE","\n        ",203],"]",",",["T_WHITESPACE","\n        ",204],["T_CONSTANT_ENCAPSED_STRING","'identifier'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],"[",["T_WHITESPACE","\n          ",205],["T_CONSTANT_ENCAPSED_STRING","'description'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'Identifier of the visitor, such as an IP address or hostname.'",206],",",["T_WHITESPACE","\n          ",206],["T_CONSTANT_ENCAPSED_STRING","'type'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii'",207],",",["T_WHITESPACE","\n          ",207],["T_CONSTANT_ENCAPSED_STRING","'length'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_LNUMBER","128",208],",",["T_WHITESPACE","\n          ",208],["T_CONSTANT_ENCAPSED_STRING","'not null'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_STRING","TRUE",209],",",["T_WHITESPACE","\n          ",209],["T_CONSTANT_ENCAPSED_STRING","'default'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","''",210],",",["T_WHITESPACE","\n        ",210],"]",",",["T_WHITESPACE","\n        ",211],["T_CONSTANT_ENCAPSED_STRING","'timestamp'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],"[",["T_WHITESPACE","\n          ",212],["T_CONSTANT_ENCAPSED_STRING","'description'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'Timestamp of the event.'",213],",",["T_WHITESPACE","\n          ",213],["T_CONSTANT_ENCAPSED_STRING","'type'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'int'",214],",",["T_WHITESPACE","\n          ",214],["T_CONSTANT_ENCAPSED_STRING","'not null'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_STRING","TRUE",215],",",["T_WHITESPACE","\n          ",215],["T_CONSTANT_ENCAPSED_STRING","'default'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_LNUMBER","0",216],",",["T_WHITESPACE","\n        ",216],"]",",",["T_WHITESPACE","\n        ",217],["T_CONSTANT_ENCAPSED_STRING","'expiration'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],"[",["T_WHITESPACE","\n          ",218],["T_CONSTANT_ENCAPSED_STRING","'description'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'Expiration timestamp. Expired events are purged on cron run.'",219],",",["T_WHITESPACE","\n          ",219],["T_CONSTANT_ENCAPSED_STRING","'type'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'int'",220],",",["T_WHITESPACE","\n          ",220],["T_CONSTANT_ENCAPSED_STRING","'not null'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_STRING","TRUE",221],",",["T_WHITESPACE","\n          ",221],["T_CONSTANT_ENCAPSED_STRING","'default'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_LNUMBER","0",222],",",["T_WHITESPACE","\n        ",222],"]",",",["T_WHITESPACE","\n      ",223],"]",",",["T_WHITESPACE","\n      ",224],["T_CONSTANT_ENCAPSED_STRING","'primary key'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],"[",["T_CONSTANT_ENCAPSED_STRING","'fid'",225],"]",",",["T_WHITESPACE","\n      ",225],["T_CONSTANT_ENCAPSED_STRING","'indexes'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],"[",["T_WHITESPACE","\n        ",226],["T_CONSTANT_ENCAPSED_STRING","'allow'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],"[",["T_CONSTANT_ENCAPSED_STRING","'event'",227],",",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'identifier'",227],",",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'timestamp'",227],"]",",",["T_WHITESPACE","\n        ",227],["T_CONSTANT_ENCAPSED_STRING","'purge'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],"[",["T_CONSTANT_ENCAPSED_STRING","'expiration'",228],"]",",",["T_WHITESPACE","\n      ",228],"]",",",["T_WHITESPACE","\n    ",229],"]",";",["T_WHITESPACE","\n  ",230],"}",["T_WHITESPACE","\n\n",231],"}",["T_WHITESPACE","\n",233]]