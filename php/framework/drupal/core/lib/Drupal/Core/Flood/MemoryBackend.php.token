[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Flood",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Symfony",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","HttpFoundation",5],["T_NS_SEPARATOR","\\",5],["T_STRING","RequestStack",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Defines the memory flood backend. This is used for testing.\n *\/",7],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","MemoryBackend",10],["T_WHITESPACE"," ",10],["T_IMPLEMENTS","implements",10],["T_WHITESPACE"," ",10],["T_STRING","FloodInterface",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * The request stack.\n   *\n   * @var \\Symfony\\Component\\HttpFoundation\\RequestStack\n   *\/",12],["T_WHITESPACE","\n  ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$requestStack",17],";",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * An array holding flood events, keyed by event name and identifier.\n   *\/",19],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$events",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_ARRAY","array",22],"(",")",";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * Construct the MemoryBackend.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\RequestStack $request_stack\n   *   The request stack used to retrieve the current request.\n   *\/",24],["T_WHITESPACE","\n  ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","__construct",30],"(",["T_STRING","RequestStack",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$request_stack",30],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","requestStack",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$request_stack",31],";",["T_WHITESPACE","\n  ",31],"}",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",34],["T_WHITESPACE","\n  ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","register",37],"(",["T_VARIABLE","$name",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$window",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_LNUMBER","3600",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$identifier",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","NULL",37],")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n    ",37],["T_IF","if",38],["T_WHITESPACE"," ",38],"(","!",["T_ISSET","isset",38],"(",["T_VARIABLE","$identifier",38],")",")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n      ",38],["T_VARIABLE","$identifier",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","requestStack",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getCurrentRequest",39],"(",")",["T_OBJECT_OPERATOR","->",39],["T_STRING","getClientIp",39],"(",")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n    ",40],["T_COMMENT","\/\/ We can't use REQUEST_TIME here, because that would not guarantee\n",41],["T_WHITESPACE","    ",42],["T_COMMENT","\/\/ uniqueness.\n",42],["T_WHITESPACE","    ",43],["T_VARIABLE","$time",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","microtime",43],"(",["T_STRING","TRUE",43],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","events",44],"[",["T_VARIABLE","$name",44],"]","[",["T_VARIABLE","$identifier",44],"]","[",["T_VARIABLE","$time",44],["T_WHITESPACE"," ",44],"+",["T_WHITESPACE"," ",44],["T_VARIABLE","$window",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$time",44],";",["T_WHITESPACE","\n  ",44],"}",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",47],["T_WHITESPACE","\n  ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","clear",50],"(",["T_VARIABLE","$name",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$identifier",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","NULL",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_IF","if",51],["T_WHITESPACE"," ",51],"(","!",["T_ISSET","isset",51],"(",["T_VARIABLE","$identifier",51],")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n      ",51],["T_VARIABLE","$identifier",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","requestStack",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getCurrentRequest",52],"(",")",["T_OBJECT_OPERATOR","->",52],["T_STRING","getClientIp",52],"(",")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n    ",53],["T_UNSET","unset",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","events",54],"[",["T_VARIABLE","$name",54],"]","[",["T_VARIABLE","$identifier",54],"]",")",";",["T_WHITESPACE","\n  ",54],"}",["T_WHITESPACE","\n\n  ",55],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",57],["T_WHITESPACE","\n  ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","isAllowed",60],"(",["T_VARIABLE","$name",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$threshold",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$window",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_LNUMBER","3600",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$identifier",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","NULL",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n    ",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(","!",["T_ISSET","isset",61],"(",["T_VARIABLE","$identifier",61],")",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n      ",61],["T_VARIABLE","$identifier",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","requestStack",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getCurrentRequest",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getClientIp",62],"(",")",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$limit",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","microtime",64],"(",["T_STRING","TRUE",64],")",["T_WHITESPACE"," ",64],"-",["T_WHITESPACE"," ",64],["T_VARIABLE","$window",64],";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$number",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","count",65],"(",["T_STRING","array_filter",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","events",65],"[",["T_VARIABLE","$name",65],"]","[",["T_VARIABLE","$identifier",65],"]",",",["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$timestamp",65],")",["T_WHITESPACE"," ",65],["T_USE","use",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$limit",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n      ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$timestamp",66],["T_WHITESPACE"," ",66],">",["T_WHITESPACE"," ",66],["T_VARIABLE","$limit",66],";",["T_WHITESPACE","\n    ",66],"}",")",")",";",["T_WHITESPACE","\n    ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$number",68],["T_WHITESPACE"," ",68],"<",["T_WHITESPACE"," ",68],["T_VARIABLE","$threshold",68],")",";",["T_WHITESPACE","\n  ",68],"}",["T_WHITESPACE","\n\n  ",69],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",71],["T_WHITESPACE","\n  ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","garbageCollection",74],"(",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n    ",74],["T_FOREACH","foreach",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","events",75],["T_WHITESPACE"," ",75],["T_AS","as",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$name",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$identifiers",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n      ",75],["T_FOREACH","foreach",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","events",76],"[",["T_VARIABLE","$name",76],"]",["T_WHITESPACE"," ",76],["T_AS","as",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$identifier",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$timestamps",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n        ",76],["T_COMMENT","\/\/ Filter by key (expiration) but preserve key => value  associations.\n",77],["T_WHITESPACE","        ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","events",78],"[",["T_VARIABLE","$name",78],"]","[",["T_VARIABLE","$identifier",78],"]",["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","array_filter",78],"(",["T_VARIABLE","$timestamps",78],",",["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],"(",")",["T_WHITESPACE"," ",78],["T_USE","use",78],["T_WHITESPACE"," ",78],"(","&",["T_VARIABLE","$timestamps",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n          ",78],["T_VARIABLE","$expiration",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","key",79],"(",["T_VARIABLE","$timestamps",79],")",";",["T_WHITESPACE","\n          ",79],["T_STRING","next",80],"(",["T_VARIABLE","$timestamps",80],")",";",["T_WHITESPACE","\n          ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$expiration",81],["T_WHITESPACE"," ",81],">",["T_WHITESPACE"," ",81],["T_STRING","microtime",81],"(",["T_STRING","TRUE",81],")",";",["T_WHITESPACE","\n        ",81],"}",")",";",["T_WHITESPACE","\n      ",82],"}",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n  ",84],"}",["T_WHITESPACE","\n\n",85],"}",["T_WHITESPACE","\n",87]]