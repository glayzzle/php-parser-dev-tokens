[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Context",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Plugin",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Exception",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ContextException",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CacheableDependencyInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Plugin",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ContextAwarePluginInterface",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Provides methods to handle sets of contexts.\n *\/",9],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","ContextHandler",12],["T_WHITESPACE"," ",12],["T_IMPLEMENTS","implements",12],["T_WHITESPACE"," ",12],["T_STRING","ContextHandlerInterface",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",14],["T_WHITESPACE","\n  ",16],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_FUNCTION","function",17],["T_WHITESPACE"," ",17],["T_STRING","filterPluginDefinitionsByContexts",17],"(",["T_ARRAY","array",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$contexts",17],",",["T_WHITESPACE"," ",17],["T_ARRAY","array",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$definitions",17],")",["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n    ",17],["T_RETURN","return",18],["T_WHITESPACE"," ",18],["T_STRING","array_filter",18],"(",["T_VARIABLE","$definitions",18],",",["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],"(",["T_VARIABLE","$plugin_definition",18],")",["T_WHITESPACE"," ",18],["T_USE","use",18],["T_WHITESPACE"," ",18],"(",["T_VARIABLE","$contexts",18],")",["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n      ",18],["T_COMMENT","\/\/ If this plugin doesn't need any context, it is available to use.\n",19],["T_WHITESPACE","      ",20],["T_IF","if",20],["T_WHITESPACE"," ",20],"(","!",["T_ISSET","isset",20],"(",["T_VARIABLE","$plugin_definition",20],"[",["T_CONSTANT_ENCAPSED_STRING","'context'",20],"]",")",")",["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n        ",20],["T_RETURN","return",21],["T_WHITESPACE"," ",21],["T_STRING","TRUE",21],";",["T_WHITESPACE","\n      ",21],"}",["T_WHITESPACE","\n\n      ",22],["T_COMMENT","\/\/ Check the set of contexts against the requirements.\n",24],["T_WHITESPACE","      ",25],["T_RETURN","return",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","checkRequirements",25],"(",["T_VARIABLE","$contexts",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$plugin_definition",25],"[",["T_CONSTANT_ENCAPSED_STRING","'context'",25],"]",")",";",["T_WHITESPACE","\n    ",25],"}",")",";",["T_WHITESPACE","\n  ",26],"}",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",29],["T_WHITESPACE","\n  ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","checkRequirements",32],"(",["T_ARRAY","array",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$contexts",32],",",["T_WHITESPACE"," ",32],["T_ARRAY","array",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$requirements",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n    ",32],["T_FOREACH","foreach",33],["T_WHITESPACE"," ",33],"(",["T_VARIABLE","$requirements",33],["T_WHITESPACE"," ",33],["T_AS","as",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$requirement",33],")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n      ",33],["T_IF","if",34],["T_WHITESPACE"," ",34],"(",["T_VARIABLE","$requirement",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","isRequired",34],"(",")",["T_WHITESPACE"," ",34],["T_BOOLEAN_AND","&&",34],["T_WHITESPACE"," ",34],"!",["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getMatchingContexts",34],"(",["T_VARIABLE","$contexts",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$requirement",34],")",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n        ",34],["T_RETURN","return",35],["T_WHITESPACE"," ",35],["T_STRING","FALSE",35],";",["T_WHITESPACE","\n      ",35],"}",["T_WHITESPACE","\n    ",36],"}",["T_WHITESPACE","\n    ",37],["T_RETURN","return",38],["T_WHITESPACE"," ",38],["T_STRING","TRUE",38],";",["T_WHITESPACE","\n  ",38],"}",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",41],["T_WHITESPACE","\n  ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","getMatchingContexts",44],"(",["T_ARRAY","array",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$contexts",44],",",["T_WHITESPACE"," ",44],["T_STRING","ContextDefinitionInterface",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$definition",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n    ",44],["T_RETURN","return",45],["T_WHITESPACE"," ",45],["T_STRING","array_filter",45],"(",["T_VARIABLE","$contexts",45],",",["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],"(",["T_STRING","ContextInterface",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$context",45],")",["T_WHITESPACE"," ",45],["T_USE","use",45],["T_WHITESPACE"," ",45],"(",["T_VARIABLE","$definition",45],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n      ",45],["T_VARIABLE","$context_definition",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$context",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getContextDefinition",46],"(",")",";",["T_WHITESPACE","\n\n      ",46],["T_COMMENT","\/\/ If the data types do not match, this context is invalid unless the\n",48],["T_WHITESPACE","      ",49],["T_COMMENT","\/\/ expected data type is any, which means all data types are supported.\n",49],["T_WHITESPACE","      ",50],["T_IF","if",50],["T_WHITESPACE"," ",50],"(",["T_VARIABLE","$definition",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getDataType",50],"(",")",["T_WHITESPACE"," ",50],["T_IS_NOT_EQUAL","!=",50],["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'any'",50],["T_WHITESPACE"," ",50],["T_BOOLEAN_AND","&&",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$definition",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getDataType",50],"(",")",["T_WHITESPACE"," ",50],["T_IS_NOT_EQUAL","!=",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$context_definition",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getDataType",50],"(",")",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n        ",50],["T_RETURN","return",51],["T_WHITESPACE"," ",51],["T_STRING","FALSE",51],";",["T_WHITESPACE","\n      ",51],"}",["T_WHITESPACE","\n\n      ",52],["T_COMMENT","\/\/ If any constraint does not match, this context is invalid.\n",54],["T_WHITESPACE","      ",55],["T_FOREACH","foreach",55],["T_WHITESPACE"," ",55],"(",["T_VARIABLE","$definition",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getConstraints",55],"(",")",["T_WHITESPACE"," ",55],["T_AS","as",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$constraint_name",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$constraint",55],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$context_definition",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getConstraint",56],"(",["T_VARIABLE","$constraint_name",56],")",["T_WHITESPACE"," ",56],["T_IS_NOT_EQUAL","!=",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$constraint",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n          ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_STRING","FALSE",57],";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n      ",58],"}",["T_WHITESPACE","\n\n      ",59],["T_COMMENT","\/\/ All contexts with matching data type and contexts are valid.\n",61],["T_WHITESPACE","      ",62],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_STRING","TRUE",62],";",["T_WHITESPACE","\n    ",62],"}",")",";",["T_WHITESPACE","\n  ",63],"}",["T_WHITESPACE","\n\n  ",64],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",66],["T_WHITESPACE","\n  ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","applyContextMapping",69],"(",["T_STRING","ContextAwarePluginInterface",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$plugin",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$contexts",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$mappings",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n    ",69],["T_DOC_COMMENT","\/** @var $contexts \\Drupal\\Core\\Plugin\\Context\\ContextInterface[] *\/",70],["T_WHITESPACE","\n    ",70],["T_VARIABLE","$mappings",71],["T_WHITESPACE"," ",71],["T_PLUS_EQUAL","+=",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$plugin",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getContextMapping",71],"(",")",";",["T_WHITESPACE","\n    ",71],["T_COMMENT","\/\/ Loop through each of the expected contexts.\n",72],["T_WHITESPACE","\n    ",73],["T_VARIABLE","$missing_value",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],"[","]",";",["T_WHITESPACE","\n\n    ",74],["T_FOREACH","foreach",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$plugin",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getContextDefinitions",76],"(",")",["T_WHITESPACE"," ",76],["T_AS","as",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$plugin_context_id",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$plugin_context_definition",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n      ",76],["T_COMMENT","\/\/ If this context was given a specific name, use that.\n",77],["T_WHITESPACE","      ",78],["T_VARIABLE","$context_id",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_ISSET","isset",78],"(",["T_VARIABLE","$mappings",78],"[",["T_VARIABLE","$plugin_context_id",78],"]",")",["T_WHITESPACE"," ",78],"?",["T_WHITESPACE"," ",78],["T_VARIABLE","$mappings",78],"[",["T_VARIABLE","$plugin_context_id",78],"]",["T_WHITESPACE"," ",78],":",["T_WHITESPACE"," ",78],["T_VARIABLE","$plugin_context_id",78],";",["T_WHITESPACE","\n      ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(","!",["T_EMPTY","empty",79],"(",["T_VARIABLE","$contexts",79],"[",["T_VARIABLE","$context_id",79],"]",")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n        ",79],["T_COMMENT","\/\/ This assignment has been used, remove it.\n",80],["T_WHITESPACE","        ",81],["T_UNSET","unset",81],"(",["T_VARIABLE","$mappings",81],"[",["T_VARIABLE","$plugin_context_id",81],"]",")",";",["T_WHITESPACE","\n\n        ",81],["T_COMMENT","\/\/ Plugins have their on context objects, only the value is applied.\n",83],["T_WHITESPACE","        ",84],["T_COMMENT","\/\/ They also need to know about the cacheability metadata of where that\n",84],["T_WHITESPACE","        ",85],["T_COMMENT","\/\/ value is coming from, so pass them through to those objects.\n",85],["T_WHITESPACE","        ",86],["T_VARIABLE","$plugin_context",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$plugin",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getContext",86],"(",["T_VARIABLE","$plugin_context_id",86],")",";",["T_WHITESPACE","\n        ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$plugin_context",87],["T_WHITESPACE"," ",87],["T_INSTANCEOF","instanceof",87],["T_WHITESPACE"," ",87],["T_STRING","ContextInterface",87],["T_WHITESPACE"," ",87],["T_BOOLEAN_AND","&&",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$contexts",87],"[",["T_VARIABLE","$context_id",87],"]",["T_WHITESPACE"," ",87],["T_INSTANCEOF","instanceof",87],["T_WHITESPACE"," ",87],["T_STRING","CacheableDependencyInterface",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n          ",87],["T_VARIABLE","$plugin_context",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","addCacheableDependency",88],"(",["T_VARIABLE","$contexts",88],"[",["T_VARIABLE","$context_id",88],"]",")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_COMMENT","\/\/ Pass the value to the plugin if there is one.\n",91],["T_WHITESPACE","        ",92],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$contexts",92],"[",["T_VARIABLE","$context_id",92],"]",["T_OBJECT_OPERATOR","->",92],["T_STRING","hasContextValue",92],"(",")",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n          ",92],["T_VARIABLE","$plugin",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","setContextValue",93],"(",["T_VARIABLE","$plugin_context_id",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$contexts",93],"[",["T_VARIABLE","$context_id",93],"]",["T_OBJECT_OPERATOR","->",93],["T_STRING","getContextData",93],"(",")",")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n        ",94],["T_ELSEIF","elseif",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$plugin_context_definition",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","isRequired",95],"(",")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n          ",95],["T_COMMENT","\/\/ Collect required contexts that exist but are missing a value.\n",96],["T_WHITESPACE","          ",97],["T_VARIABLE","$missing_value",97],"[","]",["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$plugin_context_id",97],";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n      ",98],"}",["T_WHITESPACE","\n      ",99],["T_ELSEIF","elseif",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$plugin_context_definition",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","isRequired",100],"(",")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n        ",100],["T_COMMENT","\/\/ Collect required contexts that are missing.\n",101],["T_WHITESPACE","        ",102],["T_VARIABLE","$missing_value",102],"[","]",["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$plugin_context_id",102],";",["T_WHITESPACE","\n      ",102],"}",["T_WHITESPACE","\n      ",103],["T_ELSE","else",104],["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n        ",104],["T_COMMENT","\/\/ Ignore mappings for optional missing context.\n",105],["T_WHITESPACE","        ",106],["T_UNSET","unset",106],"(",["T_VARIABLE","$mappings",106],"[",["T_VARIABLE","$plugin_context_id",106],"]",")",";",["T_WHITESPACE","\n      ",106],"}",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_COMMENT","\/\/ If there are any required contexts without a value, throw an exception.\n",110],["T_WHITESPACE","    ",111],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$missing_value",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n      ",111],["T_THROW","throw",112],["T_WHITESPACE"," ",112],["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_STRING","ContextException",112],"(",["T_STRING","sprintf",112],"(",["T_CONSTANT_ENCAPSED_STRING","'Required contexts without a value: %s.'",112],",",["T_WHITESPACE"," ",112],["T_STRING","implode",112],"(",["T_CONSTANT_ENCAPSED_STRING","', '",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$missing_value",112],")",")",")",";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_COMMENT","\/\/ If there are any mappings that were not satisfied, throw an exception.\n",115],["T_WHITESPACE","    ",116],["T_IF","if",116],["T_WHITESPACE"," ",116],"(","!",["T_EMPTY","empty",116],"(",["T_VARIABLE","$mappings",116],")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n      ",116],["T_THROW","throw",117],["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_STRING","ContextException",117],"(",["T_CONSTANT_ENCAPSED_STRING","'Assigned contexts were not satisfied: '",117],["T_WHITESPACE"," ",117],".",["T_WHITESPACE"," ",117],["T_STRING","implode",117],"(",["T_CONSTANT_ENCAPSED_STRING","','",117],",",["T_WHITESPACE"," ",117],["T_STRING","array_keys",117],"(",["T_VARIABLE","$mappings",117],")",")",")",";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n  ",118],"}",["T_WHITESPACE","\n\n",119],"}",["T_WHITESPACE","\n",121]]