[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Context",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Symfony",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DependencyInjection",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ContainerInterface",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Provides a context repository which uses context provider services.\n *\/",7],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","LazyContextRepository",10],["T_WHITESPACE"," ",10],["T_IMPLEMENTS","implements",10],["T_WHITESPACE"," ",10],["T_STRING","ContextRepositoryInterface",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * The set of available context providers service IDs.\n   *\n   * @var string[]\n   *   Context provider service IDs.\n   *\/",12],["T_WHITESPACE","\n  ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$contextProviderServiceIDs",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],"[","]",";",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * The service container.\n   *\n   * @var \\Symfony\\Component\\DependencyInjection\\ContainerInterface\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$container",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * The statically cached contexts.\n   *\n   * @var \\Drupal\\Core\\Plugin\\Context\\ContextInterface[]\n   *\/",27],["T_WHITESPACE","\n  ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$contexts",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],"[","]",";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Constructs a LazyContextRepository object.\n   *\n   * @param \\Symfony\\Component\\DependencyInjection\\ContainerInterface $container\n   *   The current service container.\n   * @param string[] $context_provider_service_ids\n   *   The set of the available context provider service IDs.\n   *\/",34],["T_WHITESPACE","\n  ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","__construct",42],"(",["T_STRING","ContainerInterface",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$container",42],",",["T_WHITESPACE"," ",42],["T_ARRAY","array",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$context_provider_service_ids",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","container",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$container",43],";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","contextProviderServiceIDs",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$context_provider_service_ids",44],";",["T_WHITESPACE","\n  ",44],"}",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",47],["T_WHITESPACE","\n  ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","getRuntimeContexts",50],"(",["T_ARRAY","array",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$context_ids",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$contexts",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],"[","]",";",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Create a map of context providers (service IDs) to unqualified context\n",53],["T_WHITESPACE","    ",54],["T_COMMENT","\/\/ IDs.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$context_ids_by_service",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[","]",";",["T_WHITESPACE","\n    ",55],["T_FOREACH","foreach",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$context_ids",56],["T_WHITESPACE"," ",56],["T_AS","as",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$id",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n      ",56],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_ISSET","isset",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","contexts",57],"[",["T_VARIABLE","$id",57],"]",")",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$contexts",58],"[",["T_VARIABLE","$id",58],"]",["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","contexts",58],"[",["T_VARIABLE","$id",58],"]",";",["T_WHITESPACE","\n        ",58],["T_CONTINUE","continue",59],";",["T_WHITESPACE","\n      ",59],"}",["T_WHITESPACE","\n      ",60],["T_COMMENT","\/\/ The IDs have been passed in @{service_id}:{unqualified_context_id}\n",61],["T_WHITESPACE","      ",62],["T_COMMENT","\/\/ format.\n",62],["T_WHITESPACE","      ",63],["T_COMMENT","\/\/ @todo Convert to an assert once https:\/\/www.drupal.org\/node\/2408013 is\n",63],["T_WHITESPACE","      ",64],["T_COMMENT","\/\/   in.\n",64],["T_WHITESPACE","      ",65],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$id",65],"[",["T_LNUMBER","0",65],"]",["T_WHITESPACE"," ",65],["T_IS_IDENTICAL","===",65],["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'@'",65],["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],["T_STRING","strpos",65],"(",["T_VARIABLE","$id",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","':'",65],")",["T_WHITESPACE"," ",65],["T_IS_NOT_IDENTICAL","!==",65],["T_WHITESPACE"," ",65],["T_STRING","FALSE",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n        ",65],["T_LIST","list",66],"(",["T_VARIABLE","$service_id",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$unqualified_context_id",66],")",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","explode",66],"(",["T_CONSTANT_ENCAPSED_STRING","':'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$id",66],",",["T_WHITESPACE"," ",66],["T_LNUMBER","2",66],")",";",["T_WHITESPACE","\n        ",66],["T_COMMENT","\/\/ Remove the leading '@'.\n",67],["T_WHITESPACE","        ",68],["T_VARIABLE","$service_id",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","substr",68],"(",["T_VARIABLE","$service_id",68],",",["T_WHITESPACE"," ",68],["T_LNUMBER","1",68],")",";",["T_WHITESPACE","\n      ",68],"}",["T_WHITESPACE","\n      ",69],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n        ",70],["T_THROW","throw",71],["T_WHITESPACE"," ",71],["T_NEW","new",71],["T_WHITESPACE"," ",71],["T_NS_SEPARATOR","\\",71],["T_STRING","InvalidArgumentException",71],"(",["T_CONSTANT_ENCAPSED_STRING","'You must provide the context IDs in the @{service_id}:{unqualified_context_id} format.'",71],")",";",["T_WHITESPACE","\n      ",71],"}",["T_WHITESPACE","\n      ",72],["T_VARIABLE","$context_ids_by_service",73],"[",["T_VARIABLE","$service_id",73],"]","[","]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$unqualified_context_id",73],";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_COMMENT","\/\/ Iterate over all missing context providers (services), gather the\n",76],["T_WHITESPACE","    ",77],["T_COMMENT","\/\/ runtime contexts and assign them as requested.\n",77],["T_WHITESPACE","    ",78],["T_FOREACH","foreach",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$context_ids_by_service",78],["T_WHITESPACE"," ",78],["T_AS","as",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$service_id",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$unqualified_context_ids",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n      ",78],["T_VARIABLE","$contexts_by_service",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","container",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","get",79],"(",["T_VARIABLE","$service_id",79],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","getRuntimeContexts",79],"(",["T_VARIABLE","$unqualified_context_ids",79],")",";",["T_WHITESPACE","\n\n      ",79],["T_VARIABLE","$wanted_contexts",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","array_intersect_key",81],"(",["T_VARIABLE","$contexts_by_service",81],",",["T_WHITESPACE"," ",81],["T_STRING","array_flip",81],"(",["T_VARIABLE","$unqualified_context_ids",81],")",")",";",["T_WHITESPACE","\n      ",81],["T_FOREACH","foreach",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$wanted_contexts",82],["T_WHITESPACE"," ",82],["T_AS","as",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$unqualified_context_id",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$context",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$context_id",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'@'",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$service_id",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","':'",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$unqualified_context_id",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","contexts",84],"[",["T_VARIABLE","$context_id",84],"]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$contexts",84],"[",["T_VARIABLE","$context_id",84],"]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$context",84],";",["T_WHITESPACE","\n      ",84],"}",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$contexts",88],";",["T_WHITESPACE","\n  ",88],"}",["T_WHITESPACE","\n\n  ",89],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",91],["T_WHITESPACE","\n  ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","getAvailableContexts",94],"(",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$contexts",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],"[","]",";",["T_WHITESPACE","\n    ",95],["T_FOREACH","foreach",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","contextProviderServiceIDs",96],["T_WHITESPACE"," ",96],["T_AS","as",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$service_id",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$contexts_by_service",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","container",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","get",97],"(",["T_VARIABLE","$service_id",97],")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getAvailableContexts",97],"(",")",";",["T_WHITESPACE","\n      ",97],["T_FOREACH","foreach",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$contexts_by_service",98],["T_WHITESPACE"," ",98],["T_AS","as",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$unqualified_context_id",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$context",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$context_id",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'@'",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$service_id",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","':'",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$unqualified_context_id",99],";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$contexts",100],"[",["T_VARIABLE","$context_id",100],"]",["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$context",100],";",["T_WHITESPACE","\n      ",100],"}",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$contexts",104],";",["T_WHITESPACE","\n  ",104],"}",["T_WHITESPACE","\n\n",105],"}",["T_WHITESPACE","\n",107]]