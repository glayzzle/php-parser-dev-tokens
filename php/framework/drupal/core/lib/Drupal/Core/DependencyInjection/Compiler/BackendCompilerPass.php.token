[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","DependencyInjection",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Compiler",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Symfony",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DependencyInjection",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Alias",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Symfony",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","DependencyInjection",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Compiler",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CompilerPassInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Symfony",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Component",7],["T_NS_SEPARATOR","\\",7],["T_STRING","DependencyInjection",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ContainerBuilder",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Defines a compiler pass to allow automatic override per backend.\n *\n * A module developer has to tag his backend service with \"backend_overridable\":\n * @code\n * custom_service:\n *   class: ...\n *   tags:\n *     - { name: backend_overridable }\n * @endcode\n *\n * As a site admin you set the 'default_backend' in your services.yml file:\n * @code\n * parameters:\n *   default_backend: sqlite\n * @endcode\n *\n * As a developer for alternative storage engines you register a service with\n * $yourbackend.$original_service:\n *\n * @code\n * sqlite.custom_service:\n *   class: ...\n * @endcode\n *\/",9],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","BackendCompilerPass",34],["T_WHITESPACE"," ",34],["T_IMPLEMENTS","implements",34],["T_WHITESPACE"," ",34],["T_STRING","CompilerPassInterface",34],["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n\n  ",34],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",36],["T_WHITESPACE","\n  ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","process",39],"(",["T_STRING","ContainerBuilder",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$container",39],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n    ",39],["T_IF","if",40],["T_WHITESPACE"," ",40],"(",["T_VARIABLE","$container",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","hasParameter",40],"(",["T_CONSTANT_ENCAPSED_STRING","'default_backend'",40],")",")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n      ",40],["T_VARIABLE","$default_backend",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$container",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","getParameter",41],"(",["T_CONSTANT_ENCAPSED_STRING","'default_backend'",41],")",";",["T_WHITESPACE","\n      ",41],["T_COMMENT","\/\/ Opt out from the default backend.\n",42],["T_WHITESPACE","      ",43],["T_IF","if",43],["T_WHITESPACE"," ",43],"(","!",["T_VARIABLE","$default_backend",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n        ",43],["T_RETURN","return",44],";",["T_WHITESPACE","\n      ",44],"}",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n    ",46],["T_ELSE","else",47],["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n      ",47],["T_TRY","try",48],["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$default_backend",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$container",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_CONSTANT_ENCAPSED_STRING","'database'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","driver",49],"(",")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$container",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","set",50],"(",["T_CONSTANT_ENCAPSED_STRING","'database'",50],",",["T_WHITESPACE"," ",50],["T_STRING","NULL",50],")",";",["T_WHITESPACE","\n      ",50],"}",["T_WHITESPACE","\n      ",51],["T_CATCH","catch",52],["T_WHITESPACE"," ",52],"(",["T_NS_SEPARATOR","\\",52],["T_STRING","Exception",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$e",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n        ",52],["T_COMMENT","\/\/ If Drupal is not installed or a test doesn't define database there\n",53],["T_WHITESPACE","        ",54],["T_COMMENT","\/\/ is nothing to override.\n",54],["T_WHITESPACE","        ",55],["T_RETURN","return",55],";",["T_WHITESPACE","\n      ",55],"}",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n\n    ",57],["T_FOREACH","foreach",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$container",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","findTaggedServiceIds",60],"(",["T_CONSTANT_ENCAPSED_STRING","'backend_overridable'",60],")",["T_WHITESPACE"," ",60],["T_AS","as",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$id",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$attributes",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n      ",60],["T_COMMENT","\/\/ If the service is already an alias it is not the original backend, so\n",61],["T_WHITESPACE","      ",62],["T_COMMENT","\/\/ we don't want to fallback to other storages any longer.\n",62],["T_WHITESPACE","      ",63],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_VARIABLE","$container",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","hasAlias",63],"(",["T_VARIABLE","$id",63],")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n        ",63],["T_CONTINUE","continue",64],";",["T_WHITESPACE","\n      ",64],"}",["T_WHITESPACE","\n      ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$container",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","hasDefinition",66],"(","\"",["T_VARIABLE","$default_backend",66],["T_ENCAPSED_AND_WHITESPACE",".",66],["T_VARIABLE","$id",66],"\"",")",["T_WHITESPACE"," ",66],["T_BOOLEAN_OR","||",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$container",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","hasAlias",66],"(","\"",["T_VARIABLE","$default_backend",66],["T_ENCAPSED_AND_WHITESPACE",".",66],["T_VARIABLE","$id",66],"\"",")",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$container",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","setAlias",67],"(",["T_VARIABLE","$id",67],",",["T_WHITESPACE"," ",67],["T_NEW","new",67],["T_WHITESPACE"," ",67],["T_STRING","Alias",67],"(","\"",["T_VARIABLE","$default_backend",67],["T_ENCAPSED_AND_WHITESPACE",".",67],["T_VARIABLE","$id",67],"\"",")",")",";",["T_WHITESPACE","\n      ",67],"}",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n  ",69],"}",["T_WHITESPACE","\n\n",70],"}",["T_WHITESPACE","\n",72]]