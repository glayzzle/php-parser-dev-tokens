[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Access",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Crypt",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","PrivateKey",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Session",7],["T_NS_SEPARATOR","\\",7],["T_STRING","MetadataBag",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Site",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Settings",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Generates and validates CSRF tokens.\n *\n * @see \\Drupal\\Tests\\Core\\Access\\CsrfTokenGeneratorTest\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","CsrfTokenGenerator",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * The private key service.\n   *\n   * @var \\Drupal\\Core\\PrivateKey\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$privateKey",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The session metadata bag.\n   *\n   * @var \\Drupal\\Core\\Session\\MetadataBag\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$sessionMetadata",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * Constructs the token generator.\n   *\n   * @param \\Drupal\\Core\\PrivateKey $private_key\n   *   The private key service.\n   * @param \\Drupal\\Core\\Session\\MetadataBag $session_metadata\n   *   The session metadata bag.\n   *\/",31],["T_WHITESPACE","\n  ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_STRING","PrivateKey",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$private_key",39],",",["T_WHITESPACE"," ",39],["T_STRING","MetadataBag",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$session_metadata",39],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","privateKey",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$private_key",40],";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","sessionMetadata",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$session_metadata",41],";",["T_WHITESPACE","\n  ",41],"}",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * Generates a token based on $value, the user session, and the private key.\n   *\n   * The generated token is based on the session of the current user. Normally,\n   * anonymous users do not have a session, so the generated token will be\n   * different on every page request. To generate a token for users without a\n   * session, manually start a session prior to calling this function.\n   *\n   * @param string $value\n   *   (optional) An additional value to base the token on.\n   *\n   * @return string\n   *   A 43-character URL-safe token for validation, based on the token seed,\n   *   the hash salt provided by Settings::getHashSalt(), and the\n   *   'drupal_private_key' configuration variable.\n   *\n   * @see \\Drupal\\Core\\Site\\Settings::getHashSalt()\n   * @see \\Symfony\\Component\\HttpFoundation\\Session\\SessionInterface::start()\n   *\/",44],["T_WHITESPACE","\n  ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","get",63],"(",["T_VARIABLE","$value",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","''",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$seed",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","sessionMetadata",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getCsrfTokenSeed",64],"(",")",";",["T_WHITESPACE","\n    ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_EMPTY","empty",65],"(",["T_VARIABLE","$seed",65],")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n      ",65],["T_VARIABLE","$seed",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Crypt",66],["T_DOUBLE_COLON","::",66],["T_STRING","randomBytesBase64",66],"(",")",";",["T_WHITESPACE","\n      ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","sessionMetadata",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","setCsrfTokenSeed",67],"(",["T_VARIABLE","$seed",67],")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","computeToken",70],"(",["T_VARIABLE","$seed",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$value",70],")",";",["T_WHITESPACE","\n  ",70],"}",["T_WHITESPACE","\n\n  ",71],["T_DOC_COMMENT","\/**\n   * Validates a token based on $value, the user session, and the private key.\n   *\n   * @param string $token\n   *   The token to be validated.\n   * @param string $value\n   *   (optional) An additional value to base the token on.\n   *\n   * @return bool\n   *   TRUE for a valid token, FALSE for an invalid token.\n   *\/",73],["T_WHITESPACE","\n  ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","validate",84],"(",["T_VARIABLE","$token",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$value",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","''",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$seed",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","sessionMetadata",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getCsrfTokenSeed",85],"(",")",";",["T_WHITESPACE","\n    ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_EMPTY","empty",86],"(",["T_VARIABLE","$seed",86],")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n      ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","FALSE",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_RETURN","return",90],["T_WHITESPACE"," ",90],["T_STRING","Crypt",90],["T_DOUBLE_COLON","::",90],["T_STRING","hashEquals",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","computeToken",90],"(",["T_VARIABLE","$seed",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$value",90],")",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$token",90],")",";",["T_WHITESPACE","\n  ",90],"}",["T_WHITESPACE","\n\n  ",91],["T_DOC_COMMENT","\/**\n   * Generates a token based on $value, the token seed, and the private key.\n   *\n   * @param string $seed\n   *   The per-session token seed.\n   * @param string $value\n   *   (optional) An additional value to base the token on.\n   *\n   * @return string\n   *   A 43-character URL-safe token for validation, based on the token seed,\n   *   the hash salt provided by Settings::getHashSalt(), and the\n   *   'drupal_private_key' configuration variable.\n   *\n   * @see \\Drupal\\Core\\Site\\Settings::getHashSalt()\n   *\/",93],["T_WHITESPACE","\n  ",107],["T_PROTECTED","protected",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","computeToken",108],"(",["T_VARIABLE","$seed",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$value",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","''",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n    ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_STRING","Crypt",109],["T_DOUBLE_COLON","::",109],["T_STRING","hmacBase64",109],"(",["T_VARIABLE","$value",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$seed",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","privateKey",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","get",109],"(",")",["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_STRING","Settings",109],["T_DOUBLE_COLON","::",109],["T_STRING","getHashSalt",109],"(",")",")",";",["T_WHITESPACE","\n  ",109],"}",["T_WHITESPACE","\n\n",110],"}",["T_WHITESPACE","\n",112]]