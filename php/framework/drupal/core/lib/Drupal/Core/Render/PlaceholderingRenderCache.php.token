[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Render",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],["T_NS_SEPARATOR","\\",5],["T_STRING","CacheFactoryInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Context",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CacheContextsManager",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Symfony",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Component",7],["T_NS_SEPARATOR","\\",7],["T_STRING","HttpFoundation",7],["T_NS_SEPARATOR","\\",7],["T_STRING","RequestStack",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Adds automatic placeholdering to the RenderCache.\n *\n * This automatic placeholdering is performed to ensure the containing elements\n * and overarching response are as cacheable as possible. Elements whose subtree\n * bubble either max-age=0 or high-cardinality cache contexts (such as 'user'\n * and 'session') are considered poorly cacheable.\n *\n * @see sites\/default\/default.services.yml\n *\n * Automatic placeholdering is performed only on elements whose subtree was\n * generated using a #lazy_builder callback and whose bubbled cacheability meets\n * the auto-placeholdering conditions as configured in the renderer.config\n * container parameter.\n *\n * This RenderCache implementation automatically replaces an element with a\n * placeholder:\n * - on render cache hit, i.e. ::get()\n * - on render cache miss, i.e. ::set() (in subsequent requests, it will be a\n *   cache hit)\n *\n * In either case, the render cache is guaranteed to contain the to-be-rendered\n * placeholder, so replacing (rendering) the placeholder will be very fast.\n *\n * Finally, in case the render cache item disappears between the time it is\n * decided to automatically placeholder the element and the time where the\n * placeholder is replaced (rendered), that is guaranteed to not be problematic.\n * Because this only automatically placeholders elements that have a\n * #lazy_builder callback set, which means that in the worst case, it will need\n * to be re-rendered.\n *\/",9],["T_WHITESPACE","\n",39],["T_CLASS","class",40],["T_WHITESPACE"," ",40],["T_STRING","PlaceholderingRenderCache",40],["T_WHITESPACE"," ",40],["T_EXTENDS","extends",40],["T_WHITESPACE"," ",40],["T_STRING","RenderCache",40],["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * The placeholder generator.\n   *\n   * @var \\Drupal\\Core\\Render\\PlaceholderGeneratorInterface\n   *\/",42],["T_WHITESPACE","\n  ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$placeholderGenerator",47],";",["T_WHITESPACE","\n\n  ",47],["T_DOC_COMMENT","\/**\n   * Stores rendered results for automatically placeholdered elements.\n   *\n   * This allows us to avoid talking to the cache twice per auto-placeholdered\n   * element, or in case of an uncacheable element, to render it twice.\n   *\n   * Scenario A. The double cache read would happen because:\n   * 1. when rendering, cache read, but auto-placeholdered\n   * 2. when rendering placeholders, again cache read\n   *\n   * Scenario B. The cache write plus read would happen because:\n   * 1. when rendering, cache write, but auto-placeholdered\n   * 2. when rendering placeholders, cache read\n   *\n   * Scenario C. The double rendering for an uncacheable element would happen because:\n   * 1. when rendering, not cacheable, but auto-placeholdered\n   * 2. when rendering placeholders, rendered again\n   *\n   * In all three scenarios, this static cache avoids the second step, thus\n   * avoiding expensive work.\n   *\n   * @var array\n   *\/",49],["T_WHITESPACE","\n  ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$placeholderResultsCache",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],"[","]",";",["T_WHITESPACE","\n\n  ",72],["T_DOC_COMMENT","\/**\n   * Constructs a new PlaceholderingRenderCache object.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\RequestStack $request_stack\n   *   The request stack.\n   * @param \\Drupal\\Core\\Cache\\CacheFactoryInterface $cache_factory\n   *   The cache factory.\n   * @param \\Drupal\\Core\\Cache\\Context\\CacheContextsManager $cache_contexts_manager\n   *   The cache contexts manager.\n   * @param \\Drupal\\Core\\Render\\PlaceholderGeneratorInterface $placeholder_generator\n   *   The placeholder generator.\n   *\/",74],["T_WHITESPACE","\n  ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","__construct",86],"(",["T_STRING","RequestStack",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$request_stack",86],",",["T_WHITESPACE"," ",86],["T_STRING","CacheFactoryInterface",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$cache_factory",86],",",["T_WHITESPACE"," ",86],["T_STRING","CacheContextsManager",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$cache_contexts_manager",86],",",["T_WHITESPACE"," ",86],["T_STRING","PlaceholderGeneratorInterface",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$placeholder_generator",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n    ",86],["T_STRING","parent",87],["T_DOUBLE_COLON","::",87],["T_STRING","__construct",87],"(",["T_VARIABLE","$request_stack",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$cache_factory",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$cache_contexts_manager",87],")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","placeholderGenerator",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$placeholder_generator",88],";",["T_WHITESPACE","\n  ",88],"}",["T_WHITESPACE","\n\n  ",89],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",91],["T_WHITESPACE","\n  ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","get",94],"(",["T_ARRAY","array",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$elements",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n    ",94],["T_COMMENT","\/\/ @todo remove this check when https:\/\/www.drupal.org\/node\/2367555 lands.\n",95],["T_WHITESPACE","    ",96],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","requestStack",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getCurrentRequest",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","isMethodSafe",96],"(",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_STRING","FALSE",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_COMMENT","\/\/ When rendering placeholders, special case auto-placeholdered elements:\n",100],["T_WHITESPACE","    ",101],["T_COMMENT","\/\/ avoid retrieving them from cache again, or rendering them again.\n",101],["T_WHITESPACE","    ",102],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_ISSET","isset",102],"(",["T_VARIABLE","$elements",102],"[",["T_CONSTANT_ENCAPSED_STRING","'#create_placeholder'",102],"]",")",["T_WHITESPACE"," ",102],["T_BOOLEAN_AND","&&",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$elements",102],"[",["T_CONSTANT_ENCAPSED_STRING","'#create_placeholder'",102],"]",["T_WHITESPACE"," ",102],["T_IS_IDENTICAL","===",102],["T_WHITESPACE"," ",102],["T_STRING","FALSE",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n      ",102],["T_VARIABLE","$cached_placeholder_result",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getFromPlaceholderResultsCache",103],"(",["T_VARIABLE","$elements",103],")",";",["T_WHITESPACE","\n      ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$cached_placeholder_result",104],["T_WHITESPACE"," ",104],["T_IS_NOT_IDENTICAL","!==",104],["T_WHITESPACE"," ",104],["T_STRING","FALSE",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$cached_placeholder_result",105],";",["T_WHITESPACE","\n      ",105],"}",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_VARIABLE","$cached_element",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","parent",109],["T_DOUBLE_COLON","::",109],["T_STRING","get",109],"(",["T_VARIABLE","$elements",109],")",";",["T_WHITESPACE","\n\n    ",109],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$cached_element",111],["T_WHITESPACE"," ",111],["T_IS_IDENTICAL","===",111],["T_WHITESPACE"," ",111],["T_STRING","FALSE",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n      ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_STRING","FALSE",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n    ",113],["T_ELSE","else",114],["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n      ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","placeholderGenerator",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","canCreatePlaceholder",115],"(",["T_VARIABLE","$elements",115],")",["T_WHITESPACE"," ",115],["T_BOOLEAN_AND","&&",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","placeholderGenerator",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","shouldAutomaticallyPlaceholder",115],"(",["T_VARIABLE","$cached_element",115],")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","createPlaceholderAndRemember",116],"(",["T_VARIABLE","$cached_element",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$elements",116],")",";",["T_WHITESPACE","\n      ",116],"}",["T_WHITESPACE","\n\n      ",117],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$cached_element",119],";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n  ",120],"}",["T_WHITESPACE","\n\n  ",121],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",123],["T_WHITESPACE","\n  ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","set",126],"(",["T_ARRAY","array",126],["T_WHITESPACE"," ",126],"&",["T_VARIABLE","$elements",126],",",["T_WHITESPACE"," ",126],["T_ARRAY","array",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$pre_bubbling_elements",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$result",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","parent",127],["T_DOUBLE_COLON","::",127],["T_STRING","set",127],"(",["T_VARIABLE","$elements",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$pre_bubbling_elements",127],")",";",["T_WHITESPACE","\n\n    ",127],["T_COMMENT","\/\/ @todo remove this check when https:\/\/www.drupal.org\/node\/2367555 lands.\n",129],["T_WHITESPACE","    ",130],["T_IF","if",130],["T_WHITESPACE"," ",130],"(","!",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","requestStack",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getCurrentRequest",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","isMethodSafe",130],"(",")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n      ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_STRING","FALSE",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","placeholderGenerator",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","canCreatePlaceholder",134],"(",["T_VARIABLE","$pre_bubbling_elements",134],")",["T_WHITESPACE"," ",134],["T_BOOLEAN_AND","&&",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","placeholderGenerator",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","shouldAutomaticallyPlaceholder",134],"(",["T_VARIABLE","$elements",134],")",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n      ",134],["T_COMMENT","\/\/ Overwrite $elements with a placeholder. The Renderer (which called this\n",135],["T_WHITESPACE","      ",136],["T_COMMENT","\/\/ method) will update the context with the bubbleable metadata of the\n",136],["T_WHITESPACE","      ",137],["T_COMMENT","\/\/ overwritten $elements.\n",137],["T_WHITESPACE","      ",138],["T_VARIABLE","$elements",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","createPlaceholderAndRemember",138],"(",["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getCacheableRenderArray",138],"(",["T_VARIABLE","$elements",138],")",",",["T_WHITESPACE"," ",138],["T_VARIABLE","$pre_bubbling_elements",138],")",";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$result",141],";",["T_WHITESPACE","\n  ",141],"}",["T_WHITESPACE","\n\n  ",142],["T_DOC_COMMENT","\/**\n   * Create a placeholder for a renderable array and remember in a static cache.\n   *\n   * @param array $rendered_elements\n   *   A fully rendered renderable array.\n   * @param array $pre_bubbling_elements\n   *   A renderable array corresponding to the state (in particular, the\n   *   cacheability metadata) of $rendered_elements prior to the beginning of\n   *   its rendering process, and therefore before any bubbling of child\n   *   information has taken place. Only the #cache property is used by this\n   *   function, so the caller may omit all other properties and children from\n   *   this array.\n   *\n   * @return array\n   *   Renderable array with placeholder markup and the attached placeholder\n   *   replacement metadata.\n   *\/",144],["T_WHITESPACE","\n  ",160],["T_PROTECTED","protected",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","createPlaceholderAndRemember",161],"(",["T_ARRAY","array",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$rendered_elements",161],",",["T_WHITESPACE"," ",161],["T_ARRAY","array",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$pre_bubbling_elements",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$placeholder_element",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","placeholderGenerator",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","createPlaceholder",162],"(",["T_VARIABLE","$pre_bubbling_elements",162],")",";",["T_WHITESPACE","\n    ",162],["T_COMMENT","\/\/ Remember the result for this placeholder to avoid double work.\n",163],["T_WHITESPACE","    ",164],["T_VARIABLE","$placeholder",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING_CAST","(string)",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$placeholder_element",164],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",164],"]",";",["T_WHITESPACE","\n    ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","placeholderResultsCache",165],"[",["T_VARIABLE","$placeholder",165],"]",["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$rendered_elements",165],";",["T_WHITESPACE","\n    ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$placeholder_element",166],";",["T_WHITESPACE","\n  ",166],"}",["T_WHITESPACE","\n\n  ",167],["T_DOC_COMMENT","\/**\n   * Retrieves an auto-placeholdered renderable array from the static cache.\n   *\n   * @param array $elements\n   *   A renderable array.\n   *\n   * @return array|false\n   *   A renderable array, with the original element and all its children pre-\n   *   rendered, or FALSE if no cached copy of the element is available.\n   *\/",169],["T_WHITESPACE","\n  ",178],["T_PROTECTED","protected",179],["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],["T_STRING","getFromPlaceholderResultsCache",179],"(",["T_ARRAY","array",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$elements",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n    ",179],["T_VARIABLE","$placeholder_element",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","placeholderGenerator",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","createPlaceholder",180],"(",["T_VARIABLE","$elements",180],")",";",["T_WHITESPACE","\n    ",180],["T_VARIABLE","$placeholder",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING_CAST","(string)",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$placeholder_element",181],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",181],"]",";",["T_WHITESPACE","\n    ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_ISSET","isset",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","placeholderResultsCache",182],"[",["T_VARIABLE","$placeholder",182],"]",")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n      ",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","placeholderResultsCache",183],"[",["T_VARIABLE","$placeholder",183],"]",";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n    ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_STRING","FALSE",185],";",["T_WHITESPACE","\n  ",185],"}",["T_WHITESPACE","\n\n",186],"}",["T_WHITESPACE","\n",188]]