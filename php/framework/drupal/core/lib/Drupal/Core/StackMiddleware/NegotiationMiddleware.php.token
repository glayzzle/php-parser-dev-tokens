[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","StackMiddleware",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Symfony",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","HttpFoundation",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Request",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Symfony",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","HttpKernel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","HttpKernelInterface",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Provides a middleware to determine the content type upon the accept header.\n *\n * @todo This is a temporary solution, remove this in https:\/\/www.drupal.org\/node\/2364011\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","NegotiationMiddleware",13],["T_WHITESPACE"," ",13],["T_IMPLEMENTS","implements",13],["T_WHITESPACE"," ",13],["T_STRING","HttpKernelInterface",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * The wrapped HTTP kernel.\n   *\n   * @var \\Symfony\\Component\\HttpKernel\\HttpKernelInterface\n   *\/",15],["T_WHITESPACE","\n  ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$app",20],";",["T_WHITESPACE","\n\n  ",20],["T_DOC_COMMENT","\/**\n   * Contains a hashmap of format as key and mimetype as value.\n   *\n   * @var array\n   *\/",22],["T_WHITESPACE","\n  ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$formats",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],"[","]",";",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * Constructs a new NegotiationMiddleware.\n   *\n   * @param \\Symfony\\Component\\HttpKernel\\HttpKernelInterface $app\n   *   The wrapper HTTP kernel\n   *\/",29],["T_WHITESPACE","\n  ",34],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","__construct",35],"(",["T_STRING","HttpKernelInterface",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$app",35],")",["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","app",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$app",36],";",["T_WHITESPACE","\n  ",36],"}",["T_WHITESPACE","\n\n  ",37],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",39],["T_WHITESPACE","\n  ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","handle",42],"(",["T_STRING","Request",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$request",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$type",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","self",42],["T_DOUBLE_COLON","::",42],["T_STRING","MASTER_REQUEST",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$catch",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","TRUE",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n    ",42],["T_COMMENT","\/\/ Register available mime types.\n",43],["T_WHITESPACE","    ",44],["T_FOREACH","foreach",44],["T_WHITESPACE"," ",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","formats",44],["T_WHITESPACE"," ",44],["T_AS","as",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$format",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$mime_type",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n      ",44],["T_VARIABLE","$request",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","setFormat",45],"(",["T_VARIABLE","$format",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$mime_type",45],")",";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_COMMENT","\/\/ Determine the request format using the negotiator.\n",48],["T_WHITESPACE","    ",49],["T_VARIABLE","$request",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","setRequestFormat",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getContentType",49],"(",["T_VARIABLE","$request",49],")",")",";",["T_WHITESPACE","\n    ",49],["T_RETURN","return",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","app",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","handle",50],"(",["T_VARIABLE","$request",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$type",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$catch",50],")",";",["T_WHITESPACE","\n  ",50],"}",["T_WHITESPACE","\n\n  ",51],["T_DOC_COMMENT","\/**\n   * Registers a format for a given MIME type.\n   *\n   * @param string $format\n   *   The format.\n   * @param string $mime_type\n   *   The MIME type.\n   *\n   * @return $this\n   *\/",53],["T_WHITESPACE","\n  ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","registerFormat",63],"(",["T_VARIABLE","$format",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$mime_type",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","formats",64],"[",["T_VARIABLE","$format",64],"]",["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$mime_type",64],";",["T_WHITESPACE","\n    ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],";",["T_WHITESPACE","\n  ",65],"}",["T_WHITESPACE","\n\n  ",66],["T_DOC_COMMENT","\/**\n   * Gets the normalized type of a request.\n   *\n   * The normalized type is a short, lowercase version of the format, such as\n   * 'html', 'json' or 'atom'.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The request object from which to extract the content type.\n   *\n   * @return string\n   *   The normalized type of a given request.\n   *\/",68],["T_WHITESPACE","\n  ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","getContentType",80],"(",["T_STRING","Request",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$request",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n    ",80],["T_COMMENT","\/\/ AJAX iframe uploads need special handling, because they contain a JSON\n",81],["T_WHITESPACE","    ",82],["T_COMMENT","\/\/ response wrapped in <textarea>.\n",82],["T_WHITESPACE","    ",83],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$request",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","request",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","get",83],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_iframe_upload'",83],",",["T_WHITESPACE"," ",83],["T_STRING","FALSE",83],")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n      ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'iframeupload'",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$request",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","query",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","has",87],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$request",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","query",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","get",88],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",88],")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ Do HTML last so that it always wins.\n",91],["T_WHITESPACE","    ",92],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'html'",92],";",["T_WHITESPACE","\n  ",92],"}",["T_WHITESPACE","\n\n",93],"}",["T_WHITESPACE","\n",95]]