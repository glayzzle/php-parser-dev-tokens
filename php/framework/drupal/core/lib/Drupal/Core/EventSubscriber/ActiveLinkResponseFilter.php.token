[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","EventSubscriber",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Serialization",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Json",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Language",6],["T_NS_SEPARATOR","\\",6],["T_STRING","LanguageInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Language",7],["T_NS_SEPARATOR","\\",7],["T_STRING","LanguageManagerInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Path",8],["T_NS_SEPARATOR","\\",8],["T_STRING","CurrentPathStack",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Path",9],["T_NS_SEPARATOR","\\",9],["T_STRING","PathMatcherInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Session",10],["T_NS_SEPARATOR","\\",10],["T_STRING","AccountInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Symfony",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Component",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EventDispatcher",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EventSubscriberInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpKernel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Event",12],["T_NS_SEPARATOR","\\",12],["T_STRING","FilterResponseEvent",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Symfony",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Component",13],["T_NS_SEPARATOR","\\",13],["T_STRING","HttpKernel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","KernelEvents",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Subscribes to filter HTML responses, to set the 'is-active' class on links.\n *\n * Only for anonymous users; for authenticated users, the active-link asset\n * library is loaded.\n *\n * @see system_page_attachments()\n *\/",15],["T_WHITESPACE","\n",22],["T_CLASS","class",23],["T_WHITESPACE"," ",23],["T_STRING","ActiveLinkResponseFilter",23],["T_WHITESPACE"," ",23],["T_IMPLEMENTS","implements",23],["T_WHITESPACE"," ",23],["T_STRING","EventSubscriberInterface",23],["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\n  ",23],["T_DOC_COMMENT","\/**\n   * The current user.\n   *\n   * @var \\Drupal\\Core\\Session\\AccountInterface\n   *\/",25],["T_WHITESPACE","\n  ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$currentUser",30],";",["T_WHITESPACE","\n\n  ",30],["T_DOC_COMMENT","\/**\n   * The current path.\n   *\n   * @var \\Drupal\\Core\\Path\\CurrentPathStack\n   *\/",32],["T_WHITESPACE","\n  ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$currentPath",37],";",["T_WHITESPACE","\n\n  ",37],["T_DOC_COMMENT","\/**\n   * The path matcher.\n   *\n   * @var \\Drupal\\Core\\Path\\PathMatcherInterface\n   *\/",39],["T_WHITESPACE","\n  ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$pathMatcher",44],";",["T_WHITESPACE","\n\n  ",44],["T_DOC_COMMENT","\/**\n   * The language manager.\n   *\n   * @var \\Drupal\\Core\\Language\\LanguageManagerInterface\n   *\/",46],["T_WHITESPACE","\n  ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$languageManager",51],";",["T_WHITESPACE","\n\n  ",51],["T_DOC_COMMENT","\/**\n   * Constructs a new ActiveLinkResponseFilter instance.\n   *\n   * @param \\Drupal\\Core\\Session\\AccountInterface $current_user\n   *   The current user.\n   * @param \\Drupal\\Core\\Path\\CurrentPathStack $current_path\n   *   The current path.\n   * @param \\Drupal\\Core\\Path\\PathMatcherInterface $path_matcher\n   *   The path matcher.\n   * @param \\Drupal\\Core\\Language\\LanguageManagerInterface $language_manager\n   *   The language manager.\n   *\/",53],["T_WHITESPACE","\n  ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","__construct",65],"(",["T_STRING","AccountInterface",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$current_user",65],",",["T_WHITESPACE"," ",65],["T_STRING","CurrentPathStack",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$current_path",65],",",["T_WHITESPACE"," ",65],["T_STRING","PathMatcherInterface",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$path_matcher",65],",",["T_WHITESPACE"," ",65],["T_STRING","LanguageManagerInterface",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$language_manager",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","currentUser",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$current_user",66],";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","currentPath",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$current_path",67],";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","pathMatcher",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$path_matcher",68],";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","languageManager",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$language_manager",69],";",["T_WHITESPACE","\n  ",69],"}",["T_WHITESPACE","\n\n  ",70],["T_DOC_COMMENT","\/**\n   * Sets the 'is-active' class on links.\n   *\n   * @param \\Symfony\\Component\\HttpKernel\\Event\\FilterResponseEvent $event\n   *   The response event.\n   *\/",72],["T_WHITESPACE","\n  ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","onResponse",78],"(",["T_STRING","FilterResponseEvent",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$event",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n    ",78],["T_COMMENT","\/\/ Only care about HTML responses.\n",79],["T_WHITESPACE","    ",80],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","stripos",80],"(",["T_VARIABLE","$event",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getResponse",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","headers",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","get",80],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",80],")",",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'text\/html'",80],")",["T_WHITESPACE"," ",80],["T_IS_IDENTICAL","===",80],["T_WHITESPACE"," ",80],["T_STRING","FALSE",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n      ",80],["T_RETURN","return",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_COMMENT","\/\/ For authenticated users, the 'is-active' class is set in JavaScript.\n",84],["T_WHITESPACE","    ",85],["T_COMMENT","\/\/ @see system_page_attachments()\n",85],["T_WHITESPACE","    ",86],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","currentUser",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","isAuthenticated",86],"(",")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n      ",86],["T_RETURN","return",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_VARIABLE","$response",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$event",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getResponse",90],"(",")",";",["T_WHITESPACE","\n    ",90],["T_VARIABLE","$response",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","setContent",91],"(",["T_STATIC","static",91],["T_DOUBLE_COLON","::",91],["T_STRING","setLinkActiveClass",91],"(",["T_WHITESPACE","\n      ",91],["T_VARIABLE","$response",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getContent",92],"(",")",",",["T_WHITESPACE","\n      ",92],["T_STRING","ltrim",93],"(",["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","currentPath",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getPath",93],"(",")",",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'\/'",93],")",",",["T_WHITESPACE","\n      ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","pathMatcher",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","isFrontPage",94],"(",")",",",["T_WHITESPACE","\n      ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","languageManager",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getCurrentLanguage",95],"(",["T_STRING","LanguageInterface",95],["T_DOUBLE_COLON","::",95],["T_STRING","TYPE_URL",95],")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getId",95],"(",")",",",["T_WHITESPACE","\n      ",95],["T_VARIABLE","$event",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getRequest",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","query",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","all",96],"(",")",["T_WHITESPACE","\n    ",96],")",")",";",["T_WHITESPACE","\n  ",97],"}",["T_WHITESPACE","\n\n\n  ",98],["T_DOC_COMMENT","\/**\n   * Sets the \"is-active\" class on relevant links.\n   *\n   * This is a PHP implementation of the drupal.active-link JavaScript library.\n   *\n   * @param string $html_markup.\n   *   The HTML markup to update.\n   * @param string $current_path\n   *   The system path of the currently active page.\n   * @param bool $is_front\n   *   Whether the current page is the front page (which implies the current\n   *   path might also be <front>).\n   * @param string $url_language\n   *   The language code of the current URL.\n   * @param array $query\n   *   The query string for the current URL.\n   *\n   * @return string\n   *   The updated HTML markup.\n   *\n   * @todo Once a future version of PHP supports parsing HTML5 properly\n   *   (i.e. doesn't fail on\n   *   https:\/\/www.drupal.org\/comment\/7938201#comment-7938201) then we can get\n   *   rid of this manual parsing and use DOMDocument instead.\n   *\/",101],["T_WHITESPACE","\n  ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_STATIC","static",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","setLinkActiveClass",126],"(",["T_VARIABLE","$html_markup",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$current_path",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$is_front",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$url_language",126],",",["T_WHITESPACE"," ",126],["T_ARRAY","array",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$query",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$search_key_current_path",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'data-drupal-link-system-path=\"'",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_VARIABLE","$current_path",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'\"'",127],";",["T_WHITESPACE","\n    ",127],["T_VARIABLE","$search_key_front",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'data-drupal-link-system-path=\"&lt;front&gt;\"'",128],";",["T_WHITESPACE","\n\n    ",128],["T_VARIABLE","$offset",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_LNUMBER","0",130],";",["T_WHITESPACE","\n    ",130],["T_COMMENT","\/\/ There are two distinct conditions that can make a link be marked active:\n",131],["T_WHITESPACE","    ",132],["T_COMMENT","\/\/ 1. A link has the current path in its 'data-drupal-link-system-path'\n",132],["T_WHITESPACE","    ",133],["T_COMMENT","\/\/    attribute.\n",133],["T_WHITESPACE","    ",134],["T_COMMENT","\/\/ 2. We are on the front page and a link has the special '<front>' value in\n",134],["T_WHITESPACE","    ",135],["T_COMMENT","\/\/    its 'data-drupal-link-system-path' attribute.\n",135],["T_WHITESPACE","    ",136],["T_WHILE","while",136],["T_WHITESPACE"," ",136],"(",["T_STRING","strpos",136],"(",["T_VARIABLE","$html_markup",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$search_key_current_path",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$offset",136],")",["T_WHITESPACE"," ",136],["T_IS_NOT_IDENTICAL","!==",136],["T_WHITESPACE"," ",136],["T_STRING","FALSE",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_OR","||",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$is_front",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_STRING","strpos",136],"(",["T_VARIABLE","$html_markup",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$search_key_front",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$offset",136],")",["T_WHITESPACE"," ",136],["T_IS_NOT_IDENTICAL","!==",136],["T_WHITESPACE"," ",136],["T_STRING","FALSE",136],")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n      ",136],["T_VARIABLE","$pos_current_path",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","strpos",137],"(",["T_VARIABLE","$html_markup",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$search_key_current_path",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$offset",137],")",";",["T_WHITESPACE","\n      ",137],["T_COMMENT","\/\/ Only look for links with the special '<front>' system path if we are\n",138],["T_WHITESPACE","      ",139],["T_COMMENT","\/\/ actually on the front page.\n",139],["T_WHITESPACE","      ",140],["T_VARIABLE","$pos_front",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$is_front",140],["T_WHITESPACE"," ",140],"?",["T_WHITESPACE"," ",140],["T_STRING","strpos",140],"(",["T_VARIABLE","$html_markup",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$search_key_front",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$offset",140],")",["T_WHITESPACE"," ",140],":",["T_WHITESPACE"," ",140],["T_STRING","FALSE",140],";",["T_WHITESPACE","\n\n      ",140],["T_COMMENT","\/\/ Determine which of the two values is the next match: the exact path, or\n",142],["T_WHITESPACE","      ",143],["T_COMMENT","\/\/ the <front> special case.\n",143],["T_WHITESPACE","      ",144],["T_VARIABLE","$pos_match",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","NULL",144],";",["T_WHITESPACE","\n      ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$pos_front",145],["T_WHITESPACE"," ",145],["T_IS_IDENTICAL","===",145],["T_WHITESPACE"," ",145],["T_STRING","FALSE",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$pos_match",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$pos_current_path",146],";",["T_WHITESPACE","\n      ",146],"}",["T_WHITESPACE","\n      ",147],["T_ELSEIF","elseif",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$pos_current_path",148],["T_WHITESPACE"," ",148],["T_IS_IDENTICAL","===",148],["T_WHITESPACE"," ",148],["T_STRING","FALSE",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$pos_match",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$pos_front",149],";",["T_WHITESPACE","\n      ",149],"}",["T_WHITESPACE","\n      ",150],["T_ELSEIF","elseif",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$pos_current_path",151],["T_WHITESPACE"," ",151],"<",["T_WHITESPACE"," ",151],["T_VARIABLE","$pos_front",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$pos_match",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$pos_current_path",152],";",["T_WHITESPACE","\n      ",152],"}",["T_WHITESPACE","\n      ",153],["T_ELSE","else",154],["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$pos_match",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$pos_front",155],";",["T_WHITESPACE","\n      ",155],"}",["T_WHITESPACE","\n\n      ",156],["T_COMMENT","\/\/ Find beginning and ending of opening tag.\n",158],["T_WHITESPACE","      ",159],["T_VARIABLE","$pos_tag_start",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","NULL",159],";",["T_WHITESPACE","\n      ",159],["T_FOR","for",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$i",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$pos_match",160],";",["T_WHITESPACE"," ",160],["T_VARIABLE","$pos_tag_start",160],["T_WHITESPACE"," ",160],["T_IS_IDENTICAL","===",160],["T_WHITESPACE"," ",160],["T_STRING","NULL",160],["T_WHITESPACE"," ",160],["T_BOOLEAN_AND","&&",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$i",160],["T_WHITESPACE"," ",160],">",["T_WHITESPACE"," ",160],["T_LNUMBER","0",160],";",["T_WHITESPACE"," ",160],["T_VARIABLE","$i",160],["T_DEC","--",160],")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n        ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(",["T_VARIABLE","$html_markup",161],"[",["T_VARIABLE","$i",161],"]",["T_WHITESPACE"," ",161],["T_IS_IDENTICAL","===",161],["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'<'",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n          ",161],["T_VARIABLE","$pos_tag_start",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$i",162],";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n      ",163],"}",["T_WHITESPACE","\n      ",164],["T_VARIABLE","$pos_tag_end",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","NULL",165],";",["T_WHITESPACE","\n      ",165],["T_FOR","for",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$i",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$pos_match",166],";",["T_WHITESPACE"," ",166],["T_VARIABLE","$pos_tag_end",166],["T_WHITESPACE"," ",166],["T_IS_IDENTICAL","===",166],["T_WHITESPACE"," ",166],["T_STRING","NULL",166],["T_WHITESPACE"," ",166],["T_BOOLEAN_AND","&&",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$i",166],["T_WHITESPACE"," ",166],"<",["T_WHITESPACE"," ",166],["T_STRING","strlen",166],"(",["T_VARIABLE","$html_markup",166],")",";",["T_WHITESPACE"," ",166],["T_VARIABLE","$i",166],["T_INC","++",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$html_markup",167],"[",["T_VARIABLE","$i",167],"]",["T_WHITESPACE"," ",167],["T_IS_IDENTICAL","===",167],["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'>'",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n          ",167],["T_VARIABLE","$pos_tag_end",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$i",168],";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n      ",169],"}",["T_WHITESPACE","\n\n      ",170],["T_COMMENT","\/\/ Get the HTML: this will be the opening part of a single tag, e.g.:\n",172],["T_WHITESPACE","      ",173],["T_COMMENT","\/\/   <a href=\"\/\" data-drupal-link-system-path=\"&lt;front&gt;\">\n",173],["T_WHITESPACE","      ",174],["T_VARIABLE","$tag",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","substr",174],"(",["T_VARIABLE","$html_markup",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$pos_tag_start",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$pos_tag_end",174],["T_WHITESPACE"," ",174],"-",["T_WHITESPACE"," ",174],["T_VARIABLE","$pos_tag_start",174],["T_WHITESPACE"," ",174],"+",["T_WHITESPACE"," ",174],["T_LNUMBER","1",174],")",";",["T_WHITESPACE","\n\n      ",174],["T_COMMENT","\/\/ Parse it into a DOMDocument so we can reliably read and modify\n",176],["T_WHITESPACE","      ",177],["T_COMMENT","\/\/ attributes.\n",177],["T_WHITESPACE","      ",178],["T_VARIABLE","$dom",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_NEW","new",178],["T_WHITESPACE"," ",178],["T_NS_SEPARATOR","\\",178],["T_STRING","DOMDocument",178],"(",")",";",["T_WHITESPACE","\n      ",178],"@",["T_VARIABLE","$dom",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","loadHTML",179],"(",["T_CONSTANT_ENCAPSED_STRING","'<!DOCTYPE html><html><head><meta http-equiv=\"Content-Type\" content=\"text\/html; charset=utf-8\" \/><\/head><body>'",179],["T_WHITESPACE"," ",179],".",["T_WHITESPACE"," ",179],["T_VARIABLE","$tag",179],["T_WHITESPACE"," ",179],".",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'<\/body><\/html>'",179],")",";",["T_WHITESPACE","\n      ",179],["T_VARIABLE","$node",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$dom",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getElementsByTagName",180],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",180],")",["T_OBJECT_OPERATOR","->",180],["T_STRING","item",180],"(",["T_LNUMBER","0",180],")",["T_OBJECT_OPERATOR","->",180],["T_STRING","firstChild",180],";",["T_WHITESPACE","\n\n      ",180],["T_COMMENT","\/\/ Ensure we don't set the \"active\" class twice on the same element.\n",182],["T_WHITESPACE","      ",183],["T_VARIABLE","$class",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$node",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getAttribute",183],"(",["T_CONSTANT_ENCAPSED_STRING","'class'",183],")",";",["T_WHITESPACE","\n      ",183],["T_VARIABLE","$add_active",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],"!",["T_STRING","in_array",184],"(",["T_CONSTANT_ENCAPSED_STRING","'is-active'",184],",",["T_WHITESPACE"," ",184],["T_STRING","explode",184],"(",["T_CONSTANT_ENCAPSED_STRING","' '",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$class",184],")",")",";",["T_WHITESPACE","\n\n      ",184],["T_COMMENT","\/\/ The language of an active link is equal to the current language.\n",186],["T_WHITESPACE","      ",187],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$add_active",187],["T_WHITESPACE"," ",187],["T_BOOLEAN_AND","&&",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$url_language",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n        ",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$node",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","hasAttribute",188],"(",["T_CONSTANT_ENCAPSED_STRING","'hreflang'",188],")",["T_WHITESPACE"," ",188],["T_BOOLEAN_AND","&&",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$node",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getAttribute",188],"(",["T_CONSTANT_ENCAPSED_STRING","'hreflang'",188],")",["T_WHITESPACE"," ",188],["T_IS_NOT_IDENTICAL","!==",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$url_language",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n          ",188],["T_VARIABLE","$add_active",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","FALSE",189],";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n      ",190],"}",["T_WHITESPACE","\n      ",191],["T_COMMENT","\/\/ The query parameters of an active link are equal to the current\n",192],["T_WHITESPACE","      ",193],["T_COMMENT","\/\/ parameters.\n",193],["T_WHITESPACE","      ",194],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$add_active",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n        ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$query",195],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n          ",195],["T_IF","if",196],["T_WHITESPACE"," ",196],"(","!",["T_VARIABLE","$node",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","hasAttribute",196],"(",["T_CONSTANT_ENCAPSED_STRING","'data-drupal-link-query'",196],")",["T_WHITESPACE"," ",196],["T_BOOLEAN_OR","||",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$node",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getAttribute",196],"(",["T_CONSTANT_ENCAPSED_STRING","'data-drupal-link-query'",196],")",["T_WHITESPACE"," ",196],["T_IS_NOT_IDENTICAL","!==",196],["T_WHITESPACE"," ",196],["T_STRING","Json",196],["T_DOUBLE_COLON","::",196],["T_STRING","encode",196],"(",["T_VARIABLE","$query",196],")",")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$add_active",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_STRING","FALSE",197],";",["T_WHITESPACE","\n          ",197],"}",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE","\n        ",199],["T_ELSE","else",200],["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n          ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_VARIABLE","$node",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","hasAttribute",201],"(",["T_CONSTANT_ENCAPSED_STRING","'data-drupal-link-query'",201],")",")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$add_active",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","FALSE",202],";",["T_WHITESPACE","\n          ",202],"}",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n      ",204],"}",["T_WHITESPACE","\n\n      ",205],["T_COMMENT","\/\/ Only if the path, the language and the query match, we set the\n",207],["T_WHITESPACE","      ",208],["T_COMMENT","\/\/ \"is-active\" class.\n",208],["T_WHITESPACE","      ",209],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$add_active",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n        ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_STRING","strlen",210],"(",["T_VARIABLE","$class",210],")",["T_WHITESPACE"," ",210],">",["T_WHITESPACE"," ",210],["T_LNUMBER","0",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n          ",210],["T_VARIABLE","$class",211],["T_WHITESPACE"," ",211],["T_CONCAT_EQUAL",".=",211],["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","' '",211],";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$class",213],["T_WHITESPACE"," ",213],["T_CONCAT_EQUAL",".=",213],["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'is-active'",213],";",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$node",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","setAttribute",214],"(",["T_CONSTANT_ENCAPSED_STRING","'class'",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$class",214],")",";",["T_WHITESPACE","\n\n        ",214],["T_COMMENT","\/\/ Get the updated tag.\n",216],["T_WHITESPACE","        ",217],["T_VARIABLE","$updated_tag",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$dom",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","saveXML",217],"(",["T_VARIABLE","$node",217],",",["T_WHITESPACE"," ",217],["T_STRING","LIBXML_NOEMPTYTAG",217],")",";",["T_WHITESPACE","\n        ",217],["T_COMMENT","\/\/ saveXML() added a closing tag, remove it.\n",218],["T_WHITESPACE","        ",219],["T_VARIABLE","$updated_tag",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","substr",219],"(",["T_VARIABLE","$updated_tag",219],",",["T_WHITESPACE"," ",219],["T_LNUMBER","0",219],",",["T_WHITESPACE"," ",219],["T_STRING","strrpos",219],"(",["T_VARIABLE","$updated_tag",219],",",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'<'",219],")",")",";",["T_WHITESPACE","\n\n        ",219],["T_VARIABLE","$html_markup",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_STRING","str_replace",221],"(",["T_VARIABLE","$tag",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$updated_tag",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$html_markup",221],")",";",["T_WHITESPACE","\n\n        ",221],["T_COMMENT","\/\/ Ensure we only search the remaining HTML.\n",223],["T_WHITESPACE","        ",224],["T_VARIABLE","$offset",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$pos_tag_end",224],["T_WHITESPACE"," ",224],"-",["T_WHITESPACE"," ",224],["T_STRING","strlen",224],"(",["T_VARIABLE","$tag",224],")",["T_WHITESPACE"," ",224],"+",["T_WHITESPACE"," ",224],["T_STRING","strlen",224],"(",["T_VARIABLE","$updated_tag",224],")",";",["T_WHITESPACE","\n      ",224],"}",["T_WHITESPACE","\n      ",225],["T_ELSE","else",226],["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n        ",226],["T_COMMENT","\/\/ Ensure we only search the remaining HTML.\n",227],["T_WHITESPACE","        ",228],["T_VARIABLE","$offset",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$pos_tag_end",228],["T_WHITESPACE"," ",228],"+",["T_WHITESPACE"," ",228],["T_LNUMBER","1",228],";",["T_WHITESPACE","\n      ",228],"}",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$html_markup",232],";",["T_WHITESPACE","\n  ",232],"}",["T_WHITESPACE","\n\n  ",233],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",235],["T_WHITESPACE","\n  ",237],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_STATIC","static",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","getSubscribedEvents",238],"(",")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n    ",238],["T_COMMENT","\/\/ Should run after any other response subscriber that modifies the markup.\n",239],["T_WHITESPACE","    ",240],["T_VARIABLE","$events",240],"[",["T_STRING","KernelEvents",240],["T_DOUBLE_COLON","::",240],["T_STRING","RESPONSE",240],"]","[","]",["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],"[",["T_CONSTANT_ENCAPSED_STRING","'onResponse'",240],",",["T_WHITESPACE"," ",240],"-",["T_LNUMBER","512",240],"]",";",["T_WHITESPACE","\n\n    ",240],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$events",242],";",["T_WHITESPACE","\n  ",242],"}",["T_WHITESPACE","\n\n",243],"}",["T_WHITESPACE","\n",245]]