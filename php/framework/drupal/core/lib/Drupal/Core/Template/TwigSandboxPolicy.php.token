[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Template",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Site",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Settings",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Default sandbox policy for Twig templates.\n *\n * Twig's sandbox extension is usually used to evaluate untrusted code by\n * limiting access to potentially unsafe properties or methods. Since we do not\n * use ViewModels when passing objects to Twig templates, we limit what those\n * objects can do by whitelisting certain classes, method names, and method\n * names with an allowed prefix. All object properties may be accessed.\n *\/",7],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","TwigSandboxPolicy",16],["T_WHITESPACE"," ",16],["T_IMPLEMENTS","implements",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Twig_Sandbox_SecurityPolicyInterface",16],["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\n  ",16],["T_DOC_COMMENT","\/**\n   * An array of whitelisted methods in the form of methodName => TRUE.\n   *\/",18],["T_WHITESPACE","\n  ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$whitelisted_methods",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","NULL",21],";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * An array of whitelisted method prefixes -- any method starting with one of\n   * these prefixes will be allowed.\n   *\/",23],["T_WHITESPACE","\n  ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$whitelisted_prefixes",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_STRING","NULL",27],";",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * An array of class names for which any method calls are allowed.\n   *\/",29],["T_WHITESPACE","\n  ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$whitelisted_classes",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","NULL",32],";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Constructs a new TwigSandboxPolicy object.\n   *\/",34],["T_WHITESPACE","\n  ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","__construct",37],"(",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n    ",37],["T_COMMENT","\/\/ Allow settings.php to override our default whitelisted classes, methods,\n",38],["T_WHITESPACE","    ",39],["T_COMMENT","\/\/ and prefixes.\n",39],["T_WHITESPACE","    ",40],["T_VARIABLE","$whitelisted_classes",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING","Settings",40],["T_DOUBLE_COLON","::",40],["T_STRING","get",40],"(",["T_CONSTANT_ENCAPSED_STRING","'twig_sandbox_whitelisted_classes'",40],",",["T_WHITESPACE"," ",40],"[",["T_WHITESPACE","\n      ",40],["T_COMMENT","\/\/ Allow any operations on the Attribute object as it is intended to be\n",41],["T_WHITESPACE","      ",42],["T_COMMENT","\/\/ changed from a Twig template, for example calling addClass().\n",42],["T_WHITESPACE","      ",43],["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Template\\Attribute'",43],",",["T_WHITESPACE","\n    ",43],"]",")",";",["T_WHITESPACE","\n    ",44],["T_COMMENT","\/\/ Flip the arrays so we can check using isset().\n",45],["T_WHITESPACE","    ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","whitelisted_classes",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","array_flip",46],"(",["T_VARIABLE","$whitelisted_classes",46],")",";",["T_WHITESPACE","\n\n    ",46],["T_VARIABLE","$whitelisted_methods",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","Settings",48],["T_DOUBLE_COLON","::",48],["T_STRING","get",48],"(",["T_CONSTANT_ENCAPSED_STRING","'twig_sandbox_whitelisted_methods'",48],",",["T_WHITESPACE"," ",48],"[",["T_WHITESPACE","\n      ",48],["T_COMMENT","\/\/ Only allow idempotent methods.\n",49],["T_WHITESPACE","      ",50],["T_CONSTANT_ENCAPSED_STRING","'id'",50],",",["T_WHITESPACE","\n      ",50],["T_CONSTANT_ENCAPSED_STRING","'label'",51],",",["T_WHITESPACE","\n      ",51],["T_CONSTANT_ENCAPSED_STRING","'bundle'",52],",",["T_WHITESPACE","\n      ",52],["T_CONSTANT_ENCAPSED_STRING","'get'",53],",",["T_WHITESPACE","\n      ",53],["T_CONSTANT_ENCAPSED_STRING","'__toString'",54],",",["T_WHITESPACE","\n      ",54],["T_CONSTANT_ENCAPSED_STRING","'toString'",55],",",["T_WHITESPACE","\n    ",55],"]",")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","whitelisted_methods",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","array_flip",57],"(",["T_VARIABLE","$whitelisted_methods",57],")",";",["T_WHITESPACE","\n\n    ",57],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","whitelisted_prefixes",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","Settings",59],["T_DOUBLE_COLON","::",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'twig_sandbox_whitelisted_prefixes'",59],",",["T_WHITESPACE"," ",59],"[",["T_WHITESPACE","\n      ",59],["T_CONSTANT_ENCAPSED_STRING","'get'",60],",",["T_WHITESPACE","\n      ",60],["T_CONSTANT_ENCAPSED_STRING","'has'",61],",",["T_WHITESPACE","\n      ",61],["T_CONSTANT_ENCAPSED_STRING","'is'",62],",",["T_WHITESPACE","\n    ",62],"]",")",";",["T_WHITESPACE","\n  ",63],"}",["T_WHITESPACE","\n\n  ",64],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",66],["T_WHITESPACE","\n  ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","checkSecurity",69],"(",["T_VARIABLE","$tags",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$filters",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$functions",69],")",["T_WHITESPACE"," ",69],"{","}",["T_WHITESPACE","\n\n  ",69],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",71],["T_WHITESPACE","\n  ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","checkPropertyAllowed",74],"(",["T_VARIABLE","$obj",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$property",74],")",["T_WHITESPACE"," ",74],"{","}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",76],["T_WHITESPACE","\n  ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","checkMethodAllowed",79],"(",["T_VARIABLE","$obj",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$method",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n    ",79],["T_FOREACH","foreach",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","whitelisted_classes",80],["T_WHITESPACE"," ",80],["T_AS","as",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$class",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$key",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n      ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$obj",81],["T_WHITESPACE"," ",81],["T_INSTANCEOF","instanceof",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$class",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_STRING","TRUE",82],";",["T_WHITESPACE","\n      ",82],"}",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_COMMENT","\/\/ Return quickly for an exact match of the method name.\n",86],["T_WHITESPACE","    ",87],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_ISSET","isset",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","whitelisted_methods",87],"[",["T_VARIABLE","$method",87],"]",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_STRING","TRUE",88],";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ If the method name starts with a whitelisted prefix, allow it.\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/ Note: strpos() is between 3x and 7x faster than preg_match in this case.\n",92],["T_WHITESPACE","    ",93],["T_FOREACH","foreach",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","whitelisted_prefixes",93],["T_WHITESPACE"," ",93],["T_AS","as",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$prefix",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n      ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","strpos",94],"(",["T_VARIABLE","$method",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$prefix",94],")",["T_WHITESPACE"," ",94],["T_IS_IDENTICAL","===",94],["T_WHITESPACE"," ",94],["T_LNUMBER","0",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_STRING","TRUE",95],";",["T_WHITESPACE","\n      ",95],"}",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_THROW","throw",99],["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Twig_Sandbox_SecurityError",99],"(",["T_STRING","sprintf",99],"(",["T_CONSTANT_ENCAPSED_STRING","'Calling \"%s\" method on a \"%s\" object is not allowed.'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$method",99],",",["T_WHITESPACE"," ",99],["T_STRING","get_class",99],"(",["T_VARIABLE","$obj",99],")",")",")",";",["T_WHITESPACE","\n  ",99],"}",["T_WHITESPACE","\n\n",100],"}",["T_WHITESPACE","\n",102]]