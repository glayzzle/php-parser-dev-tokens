[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Password",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Crypt",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Secure password hashing functions based on the Portable PHP password\n * hashing framework.\n *\n * @see http:\/\/www.openwall.com\/phpass\/\n *\/",7],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","PhpassHashedPassword",13],["T_WHITESPACE"," ",13],["T_IMPLEMENTS","implements",13],["T_WHITESPACE"," ",13],["T_STRING","PasswordInterface",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n  ",13],["T_DOC_COMMENT","\/**\n   * The minimum allowed log2 number of iterations for password stretching.\n   *\/",14],["T_WHITESPACE","\n  ",16],["T_CONST","const",17],["T_WHITESPACE"," ",17],["T_STRING","MIN_HASH_COUNT",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_LNUMBER","7",17],";",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * The maximum allowed log2 number of iterations for password stretching.\n   *\/",19],["T_WHITESPACE","\n  ",21],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","MAX_HASH_COUNT",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_LNUMBER","30",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The expected (and maximum) number of characters in a hashed password.\n   *\/",24],["T_WHITESPACE","\n  ",26],["T_CONST","const",27],["T_WHITESPACE"," ",27],["T_STRING","HASH_LENGTH",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_LNUMBER","55",27],";",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * Returns a string for mapping an int to the corresponding base 64 character.\n   *\/",29],["T_WHITESPACE","\n  ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_STATIC","static",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$ITOA64",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'.\/0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'",32],";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Specifies the number of times the hashing function will be applied when\n   * generating new password hashes. The number of times is calculated by\n   * raising 2 to the power of the given value.\n   *\/",34],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$countLog2",39],";",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * Constructs a new password hashing instance.\n   *\n   * @param int $countLog2\n   *   Password stretching iteration count. Specifies the number of times the\n   *   hashing function will be applied when generating new password hashes.\n   *   The number of times is calculated by raising 2 to the power of the given\n   *   value.\n   *\/",41],["T_WHITESPACE","\n  ",49],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","__construct",50],"(",["T_VARIABLE","$countLog2",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_COMMENT","\/\/ Ensure that $countLog2 is within set bounds.\n",51],["T_WHITESPACE","    ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","countLog2",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","enforceLog2Boundaries",52],"(",["T_VARIABLE","$countLog2",52],")",";",["T_WHITESPACE","\n  ",52],"}",["T_WHITESPACE","\n\n  ",53],["T_DOC_COMMENT","\/**\n   * Encodes bytes into printable base 64 using the *nix standard from crypt().\n   *\n   * @param string $input\n   *   The string containing bytes to encode.\n   * @param int $count\n   *   The number of characters (bytes) to encode.\n   *\n   * @return string\n   *   Encoded string.\n   *\/",55],["T_WHITESPACE","\n  ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","base64Encode",66],"(",["T_VARIABLE","$input",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$count",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$output",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","''",67],";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$i",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_LNUMBER","0",68],";",["T_WHITESPACE","\n    ",68],["T_DO","do",69],["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n      ",69],["T_VARIABLE","$value",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","ord",70],"(",["T_VARIABLE","$input",70],"[",["T_VARIABLE","$i",70],["T_INC","++",70],"]",")",";",["T_WHITESPACE","\n      ",70],["T_VARIABLE","$output",71],["T_WHITESPACE"," ",71],["T_CONCAT_EQUAL",".=",71],["T_WHITESPACE"," ",71],["T_STATIC","static",71],["T_DOUBLE_COLON","::",71],["T_VARIABLE","$ITOA64",71],"[",["T_VARIABLE","$value",71],["T_WHITESPACE"," ",71],"&",["T_WHITESPACE"," ",71],["T_LNUMBER","0x3f",71],"]",";",["T_WHITESPACE","\n      ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$i",72],["T_WHITESPACE"," ",72],"<",["T_WHITESPACE"," ",72],["T_VARIABLE","$count",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$value",73],["T_WHITESPACE"," ",73],["T_OR_EQUAL","|=",73],["T_WHITESPACE"," ",73],["T_STRING","ord",73],"(",["T_VARIABLE","$input",73],"[",["T_VARIABLE","$i",73],"]",")",["T_WHITESPACE"," ",73],["T_SL","<<",73],["T_WHITESPACE"," ",73],["T_LNUMBER","8",73],";",["T_WHITESPACE","\n      ",73],"}",["T_WHITESPACE","\n      ",74],["T_VARIABLE","$output",75],["T_WHITESPACE"," ",75],["T_CONCAT_EQUAL",".=",75],["T_WHITESPACE"," ",75],["T_STATIC","static",75],["T_DOUBLE_COLON","::",75],["T_VARIABLE","$ITOA64",75],"[","(",["T_VARIABLE","$value",75],["T_WHITESPACE"," ",75],["T_SR",">>",75],["T_WHITESPACE"," ",75],["T_LNUMBER","6",75],")",["T_WHITESPACE"," ",75],"&",["T_WHITESPACE"," ",75],["T_LNUMBER","0x3f",75],"]",";",["T_WHITESPACE","\n      ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$i",76],["T_INC","++",76],["T_WHITESPACE"," ",76],["T_IS_GREATER_OR_EQUAL",">=",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$count",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n        ",76],["T_BREAK","break",77],";",["T_WHITESPACE","\n      ",77],"}",["T_WHITESPACE","\n      ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$i",79],["T_WHITESPACE"," ",79],"<",["T_WHITESPACE"," ",79],["T_VARIABLE","$count",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$value",80],["T_WHITESPACE"," ",80],["T_OR_EQUAL","|=",80],["T_WHITESPACE"," ",80],["T_STRING","ord",80],"(",["T_VARIABLE","$input",80],"[",["T_VARIABLE","$i",80],"]",")",["T_WHITESPACE"," ",80],["T_SL","<<",80],["T_WHITESPACE"," ",80],["T_LNUMBER","16",80],";",["T_WHITESPACE","\n      ",80],"}",["T_WHITESPACE","\n      ",81],["T_VARIABLE","$output",82],["T_WHITESPACE"," ",82],["T_CONCAT_EQUAL",".=",82],["T_WHITESPACE"," ",82],["T_STATIC","static",82],["T_DOUBLE_COLON","::",82],["T_VARIABLE","$ITOA64",82],"[","(",["T_VARIABLE","$value",82],["T_WHITESPACE"," ",82],["T_SR",">>",82],["T_WHITESPACE"," ",82],["T_LNUMBER","12",82],")",["T_WHITESPACE"," ",82],"&",["T_WHITESPACE"," ",82],["T_LNUMBER","0x3f",82],"]",";",["T_WHITESPACE","\n      ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$i",83],["T_INC","++",83],["T_WHITESPACE"," ",83],["T_IS_GREATER_OR_EQUAL",">=",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$count",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n        ",83],["T_BREAK","break",84],";",["T_WHITESPACE","\n      ",84],"}",["T_WHITESPACE","\n      ",85],["T_VARIABLE","$output",86],["T_WHITESPACE"," ",86],["T_CONCAT_EQUAL",".=",86],["T_WHITESPACE"," ",86],["T_STATIC","static",86],["T_DOUBLE_COLON","::",86],["T_VARIABLE","$ITOA64",86],"[","(",["T_VARIABLE","$value",86],["T_WHITESPACE"," ",86],["T_SR",">>",86],["T_WHITESPACE"," ",86],["T_LNUMBER","18",86],")",["T_WHITESPACE"," ",86],"&",["T_WHITESPACE"," ",86],["T_LNUMBER","0x3f",86],"]",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE"," ",87],["T_WHILE","while",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$i",87],["T_WHITESPACE"," ",87],"<",["T_WHITESPACE"," ",87],["T_VARIABLE","$count",87],")",";",["T_WHITESPACE","\n\n    ",87],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$output",89],";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Generates a random base 64-encoded salt prefixed with hash settings.\n   *\n   * Proper use of salts may defeat a number of attacks, including:\n   *  - The ability to try candidate passwords against multiple hashes at once.\n   *  - The ability to use pre-hashed lists of candidate passwords.\n   *  - The ability to determine whether two users have the same (or different)\n   *    password without actually having to guess one of the passwords.\n   *\n   * @return string\n   *   A 12 character string containing the iteration count and a random salt.\n   *\/",92],["T_WHITESPACE","\n  ",103],["T_PROTECTED","protected",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","generateSalt",104],"(",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$output",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'$S$'",105],";",["T_WHITESPACE","\n    ",105],["T_COMMENT","\/\/ We encode the final log2 iteration count in base 64.\n",106],["T_WHITESPACE","    ",107],["T_VARIABLE","$output",107],["T_WHITESPACE"," ",107],["T_CONCAT_EQUAL",".=",107],["T_WHITESPACE"," ",107],["T_STATIC","static",107],["T_DOUBLE_COLON","::",107],["T_VARIABLE","$ITOA64",107],"[",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","countLog2",107],"]",";",["T_WHITESPACE","\n    ",107],["T_COMMENT","\/\/ 6 bytes is the standard salt for a portable phpass hash.\n",108],["T_WHITESPACE","    ",109],["T_VARIABLE","$output",109],["T_WHITESPACE"," ",109],["T_CONCAT_EQUAL",".=",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","base64Encode",109],"(",["T_STRING","Crypt",109],["T_DOUBLE_COLON","::",109],["T_STRING","randomBytes",109],"(",["T_LNUMBER","6",109],")",",",["T_WHITESPACE"," ",109],["T_LNUMBER","6",109],")",";",["T_WHITESPACE","\n    ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$output",110],";",["T_WHITESPACE","\n  ",110],"}",["T_WHITESPACE","\n\n  ",111],["T_DOC_COMMENT","\/**\n   * Ensures that $count_log2 is within set bounds.\n   *\n   * @param int $count_log2\n   *   Integer that determines the number of iterations used in the hashing\n   *   process. A larger value is more secure, but takes more time to complete.\n   *\n   * @return int\n   *   Integer within set bounds that is closest to $count_log2.\n   *\/",113],["T_WHITESPACE","\n  ",122],["T_PROTECTED","protected",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","enforceLog2Boundaries",123],"(",["T_VARIABLE","$count_log2",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n    ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$count_log2",124],["T_WHITESPACE"," ",124],"<",["T_WHITESPACE"," ",124],["T_STATIC","static",124],["T_DOUBLE_COLON","::",124],["T_STRING","MIN_HASH_COUNT",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n      ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_STATIC","static",125],["T_DOUBLE_COLON","::",125],["T_STRING","MIN_HASH_COUNT",125],";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n    ",126],["T_ELSEIF","elseif",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$count_log2",127],["T_WHITESPACE"," ",127],">",["T_WHITESPACE"," ",127],["T_STATIC","static",127],["T_DOUBLE_COLON","::",127],["T_STRING","MAX_HASH_COUNT",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n      ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_STATIC","static",128],["T_DOUBLE_COLON","::",128],["T_STRING","MAX_HASH_COUNT",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_INT_CAST","(int)",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$count_log2",131],";",["T_WHITESPACE","\n  ",131],"}",["T_WHITESPACE","\n\n  ",132],["T_DOC_COMMENT","\/**\n   * Hash a password using a secure stretched hash.\n   *\n   * By using a salt and repeated hashing the password is \"stretched\". Its\n   * security is increased because it becomes much more computationally costly\n   * for an attacker to try to break the hash by brute-force computation of the\n   * hashes of a large number of plain-text words or strings to find a match.\n   *\n   * @param string $algo\n   *   The string name of a hashing algorithm usable by hash(), like 'sha256'.\n   * @param string $password\n   *   Plain-text password up to 512 bytes (128 to 512 UTF-8 characters) to\n   *   hash.\n   * @param string $setting\n   *   An existing hash or the output of $this->generateSalt(). Must be at least\n   *   12 characters (the settings and salt).\n   *\n   * @return string\n   *   A string containing the hashed password (and salt) or FALSE on failure.\n   *   The return string will be truncated at HASH_LENGTH characters max.\n   *\/",134],["T_WHITESPACE","\n  ",154],["T_PROTECTED","protected",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","crypt",155],"(",["T_VARIABLE","$algo",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$password",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$setting",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n    ",155],["T_COMMENT","\/\/ Prevent DoS attacks by refusing to hash large passwords.\n",156],["T_WHITESPACE","    ",157],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_STRING","strlen",157],"(",["T_VARIABLE","$password",157],")",["T_WHITESPACE"," ",157],">",["T_WHITESPACE"," ",157],["T_STRING","PasswordInterface",157],["T_DOUBLE_COLON","::",157],["T_STRING","PASSWORD_MAX_LENGTH",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n      ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_STRING","FALSE",158],";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n\n    ",159],["T_COMMENT","\/\/ The first 12 characters of an existing hash are its setting string.\n",161],["T_WHITESPACE","    ",162],["T_VARIABLE","$setting",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","substr",162],"(",["T_VARIABLE","$setting",162],",",["T_WHITESPACE"," ",162],["T_LNUMBER","0",162],",",["T_WHITESPACE"," ",162],["T_LNUMBER","12",162],")",";",["T_WHITESPACE","\n\n    ",162],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$setting",164],"[",["T_LNUMBER","0",164],"]",["T_WHITESPACE"," ",164],["T_IS_NOT_EQUAL","!=",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'$'",164],["T_WHITESPACE"," ",164],["T_BOOLEAN_OR","||",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$setting",164],"[",["T_LNUMBER","2",164],"]",["T_WHITESPACE"," ",164],["T_IS_NOT_EQUAL","!=",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'$'",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n      ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_STRING","FALSE",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n    ",166],["T_VARIABLE","$count_log2",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getCountLog2",167],"(",["T_VARIABLE","$setting",167],")",";",["T_WHITESPACE","\n    ",167],["T_COMMENT","\/\/ Stored hashes may have been crypted with any iteration count. However we\n",168],["T_WHITESPACE","    ",169],["T_COMMENT","\/\/ do not allow applying the algorithm for unreasonable low and high values\n",169],["T_WHITESPACE","    ",170],["T_COMMENT","\/\/ respectively.\n",170],["T_WHITESPACE","    ",171],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$count_log2",171],["T_WHITESPACE"," ",171],["T_IS_NOT_EQUAL","!=",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","enforceLog2Boundaries",171],"(",["T_VARIABLE","$count_log2",171],")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n      ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_STRING","FALSE",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$salt",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","substr",174],"(",["T_VARIABLE","$setting",174],",",["T_WHITESPACE"," ",174],["T_LNUMBER","4",174],",",["T_WHITESPACE"," ",174],["T_LNUMBER","8",174],")",";",["T_WHITESPACE","\n    ",174],["T_COMMENT","\/\/ Hashes must have an 8 character salt.\n",175],["T_WHITESPACE","    ",176],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_STRING","strlen",176],"(",["T_VARIABLE","$salt",176],")",["T_WHITESPACE"," ",176],["T_IS_NOT_EQUAL","!=",176],["T_WHITESPACE"," ",176],["T_LNUMBER","8",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n      ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_STRING","FALSE",177],";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n\n    ",178],["T_COMMENT","\/\/ Convert the base 2 logarithm into an integer.\n",180],["T_WHITESPACE","    ",181],["T_VARIABLE","$count",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_LNUMBER","1",181],["T_WHITESPACE"," ",181],["T_SL","<<",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$count_log2",181],";",["T_WHITESPACE","\n\n    ",181],["T_COMMENT","\/\/ We rely on the hash() function being available in PHP 5.2+.\n",183],["T_WHITESPACE","    ",184],["T_VARIABLE","$hash",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_STRING","hash",184],"(",["T_VARIABLE","$algo",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$salt",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_VARIABLE","$password",184],",",["T_WHITESPACE"," ",184],["T_STRING","TRUE",184],")",";",["T_WHITESPACE","\n    ",184],["T_DO","do",185],["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n      ",185],["T_VARIABLE","$hash",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","hash",186],"(",["T_VARIABLE","$algo",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$hash",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE"," ",186],["T_VARIABLE","$password",186],",",["T_WHITESPACE"," ",186],["T_STRING","TRUE",186],")",";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE"," ",187],["T_WHILE","while",187],["T_WHITESPACE"," ",187],"(",["T_DEC","--",187],["T_VARIABLE","$count",187],")",";",["T_WHITESPACE","\n\n    ",187],["T_VARIABLE","$len",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","strlen",189],"(",["T_VARIABLE","$hash",189],")",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$output",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$setting",190],["T_WHITESPACE"," ",190],".",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","base64Encode",190],"(",["T_VARIABLE","$hash",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$len",190],")",";",["T_WHITESPACE","\n    ",190],["T_COMMENT","\/\/ $this->base64Encode() of a 16 byte MD5 will always be 22 characters.\n",191],["T_WHITESPACE","    ",192],["T_COMMENT","\/\/ $this->base64Encode() of a 64 byte sha512 will always be 86 characters.\n",192],["T_WHITESPACE","    ",193],["T_VARIABLE","$expected",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_LNUMBER","12",193],["T_WHITESPACE"," ",193],"+",["T_WHITESPACE"," ",193],["T_STRING","ceil",193],"(","(",["T_LNUMBER","8",193],["T_WHITESPACE"," ",193],"*",["T_WHITESPACE"," ",193],["T_VARIABLE","$len",193],")",["T_WHITESPACE"," ",193],"\/",["T_WHITESPACE"," ",193],["T_LNUMBER","6",193],")",";",["T_WHITESPACE","\n    ",193],["T_RETURN","return",194],["T_WHITESPACE"," ",194],"(",["T_STRING","strlen",194],"(",["T_VARIABLE","$output",194],")",["T_WHITESPACE"," ",194],["T_IS_EQUAL","==",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$expected",194],")",["T_WHITESPACE"," ",194],"?",["T_WHITESPACE"," ",194],["T_STRING","substr",194],"(",["T_VARIABLE","$output",194],",",["T_WHITESPACE"," ",194],["T_LNUMBER","0",194],",",["T_WHITESPACE"," ",194],["T_STATIC","static",194],["T_DOUBLE_COLON","::",194],["T_STRING","HASH_LENGTH",194],")",["T_WHITESPACE"," ",194],":",["T_WHITESPACE"," ",194],["T_STRING","FALSE",194],";",["T_WHITESPACE","\n  ",194],"}",["T_WHITESPACE","\n\n  ",195],["T_DOC_COMMENT","\/**\n   * Parses the log2 iteration count from a stored hash or setting string.\n   *\n   * @param string $setting\n   *   An existing hash or the output of $this->generateSalt(). Must be at least\n   *   12 characters (the settings and salt).\n   *\n   * @return int\n   *   The log2 iteration count.\n   *\/",197],["T_WHITESPACE","\n  ",206],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","getCountLog2",207],"(",["T_VARIABLE","$setting",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n    ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_STRING","strpos",208],"(",["T_STATIC","static",208],["T_DOUBLE_COLON","::",208],["T_VARIABLE","$ITOA64",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$setting",208],"[",["T_LNUMBER","3",208],"]",")",";",["T_WHITESPACE","\n  ",208],"}",["T_WHITESPACE","\n\n  ",209],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",211],["T_WHITESPACE","\n  ",213],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","hash",214],"(",["T_VARIABLE","$password",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n    ",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","crypt",215],"(",["T_CONSTANT_ENCAPSED_STRING","'sha512'",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$password",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","generateSalt",215],"(",")",")",";",["T_WHITESPACE","\n  ",215],"}",["T_WHITESPACE","\n\n  ",216],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",218],["T_WHITESPACE","\n  ",220],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","check",221],"(",["T_VARIABLE","$password",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$hash",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n    ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(",["T_STRING","substr",222],"(",["T_VARIABLE","$hash",222],",",["T_WHITESPACE"," ",222],["T_LNUMBER","0",222],",",["T_WHITESPACE"," ",222],["T_LNUMBER","2",222],")",["T_WHITESPACE"," ",222],["T_IS_EQUAL","==",222],["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'U$'",222],")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n      ",222],["T_COMMENT","\/\/ This may be an updated password from user_update_7000(). Such hashes\n",223],["T_WHITESPACE","      ",224],["T_COMMENT","\/\/ have 'U' added as the first character and need an extra md5() (see the\n",224],["T_WHITESPACE","      ",225],["T_COMMENT","\/\/ Drupal 7 documentation).\n",225],["T_WHITESPACE","      ",226],["T_VARIABLE","$stored_hash",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_STRING","substr",226],"(",["T_VARIABLE","$hash",226],",",["T_WHITESPACE"," ",226],["T_LNUMBER","1",226],")",";",["T_WHITESPACE","\n      ",226],["T_VARIABLE","$password",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","md5",227],"(",["T_VARIABLE","$password",227],")",";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n    ",228],["T_ELSE","else",229],["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n      ",229],["T_VARIABLE","$stored_hash",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_VARIABLE","$hash",230],";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_VARIABLE","$type",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","substr",233],"(",["T_VARIABLE","$stored_hash",233],",",["T_WHITESPACE"," ",233],["T_LNUMBER","0",233],",",["T_WHITESPACE"," ",233],["T_LNUMBER","3",233],")",";",["T_WHITESPACE","\n    ",233],["T_SWITCH","switch",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$type",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n      ",234],["T_CASE","case",235],["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'$S$'",235],":",["T_WHITESPACE","\n        ",235],["T_COMMENT","\/\/ A normal Drupal 7 password using sha512.\n",236],["T_WHITESPACE","        ",237],["T_VARIABLE","$computed_hash",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","crypt",237],"(",["T_CONSTANT_ENCAPSED_STRING","'sha512'",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$password",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$stored_hash",237],")",";",["T_WHITESPACE","\n        ",237],["T_BREAK","break",238],";",["T_WHITESPACE","\n      ",238],["T_CASE","case",239],["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'$H$'",239],":",["T_WHITESPACE","\n        ",239],["T_COMMENT","\/\/ phpBB3 uses \"$H$\" for the same thing as \"$P$\".\n",240],["T_WHITESPACE","      ",241],["T_CASE","case",241],["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'$P$'",241],":",["T_WHITESPACE","\n        ",241],["T_COMMENT","\/\/ A phpass password generated using md5.  This is an\n",242],["T_WHITESPACE","        ",243],["T_COMMENT","\/\/ imported password or from an earlier Drupal version.\n",243],["T_WHITESPACE","        ",244],["T_VARIABLE","$computed_hash",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","crypt",244],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$password",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$stored_hash",244],")",";",["T_WHITESPACE","\n        ",244],["T_BREAK","break",245],";",["T_WHITESPACE","\n      ",245],["T_DEFAULT","default",246],":",["T_WHITESPACE","\n        ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_STRING","FALSE",247],";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_COMMENT","\/\/ Compare using hashEquals() instead of === to mitigate timing attacks.\n",250],["T_WHITESPACE","    ",251],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$computed_hash",251],["T_WHITESPACE"," ",251],["T_BOOLEAN_AND","&&",251],["T_WHITESPACE"," ",251],["T_STRING","Crypt",251],["T_DOUBLE_COLON","::",251],["T_STRING","hashEquals",251],"(",["T_VARIABLE","$stored_hash",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$computed_hash",251],")",";",["T_WHITESPACE","\n  ",251],"}",["T_WHITESPACE","\n\n  ",252],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",254],["T_WHITESPACE","\n  ",256],["T_PUBLIC","public",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","needsRehash",257],"(",["T_VARIABLE","$hash",257],")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n    ",257],["T_COMMENT","\/\/ Check whether this was an updated password.\n",258],["T_WHITESPACE","    ",259],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","(",["T_STRING","substr",259],"(",["T_VARIABLE","$hash",259],",",["T_WHITESPACE"," ",259],["T_LNUMBER","0",259],",",["T_WHITESPACE"," ",259],["T_LNUMBER","3",259],")",["T_WHITESPACE"," ",259],["T_IS_NOT_EQUAL","!=",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'$S$'",259],")",["T_WHITESPACE"," ",259],["T_BOOLEAN_OR","||",259],["T_WHITESPACE"," ",259],"(",["T_STRING","strlen",259],"(",["T_VARIABLE","$hash",259],")",["T_WHITESPACE"," ",259],["T_IS_NOT_EQUAL","!=",259],["T_WHITESPACE"," ",259],["T_STATIC","static",259],["T_DOUBLE_COLON","::",259],["T_STRING","HASH_LENGTH",259],")",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n      ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_STRING","TRUE",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n    ",261],["T_COMMENT","\/\/ Ensure that $count_log2 is within set bounds.\n",262],["T_WHITESPACE","    ",263],["T_VARIABLE","$count_log2",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","enforceLog2Boundaries",263],"(",["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","countLog2",263],")",";",["T_WHITESPACE","\n    ",263],["T_COMMENT","\/\/ Check whether the iteration count used differs from the standard number.\n",264],["T_WHITESPACE","    ",265],["T_RETURN","return",265],["T_WHITESPACE"," ",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getCountLog2",265],"(",["T_VARIABLE","$hash",265],")",["T_WHITESPACE"," ",265],["T_IS_NOT_IDENTICAL","!==",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$count_log2",265],")",";",["T_WHITESPACE","\n  ",265],"}",["T_WHITESPACE","\n\n",266],"}",["T_WHITESPACE","\n",268]]