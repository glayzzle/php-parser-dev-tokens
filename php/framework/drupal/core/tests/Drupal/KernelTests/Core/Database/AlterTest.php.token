[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Tests the hook_query_alter capabilities of the Select builder.\n *\n * @group Database\n * @see database_test_query_alter()\n *\/",5],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","AlterTest",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_STRING","DatabaseTestBase",11],["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\n  ",11],["T_DOC_COMMENT","\/**\n   * Tests that we can do basic alters.\n   *\/",13],["T_WHITESPACE","\n  ",15],["T_FUNCTION","function",16],["T_WHITESPACE"," ",16],["T_STRING","testSimpleAlter",16],"(",")",["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n    ",16],["T_VARIABLE","$query",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_STRING","db_select",17],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",17],")",";",["T_WHITESPACE","\n    ",17],["T_VARIABLE","$query",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","addField",18],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",18],",",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'name'",18],")",";",["T_WHITESPACE","\n    ",18],["T_VARIABLE","$query",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","addField",19],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",19],",",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'age'",19],",",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'age'",19],")",";",["T_WHITESPACE","\n    ",19],["T_VARIABLE","$query",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","addTag",20],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_add_range'",20],")",";",["T_WHITESPACE","\n\n    ",20],["T_VARIABLE","$result",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$query",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","execute",22],"(",")",["T_OBJECT_OPERATOR","->",22],["T_STRING","fetchAll",22],"(",")",";",["T_WHITESPACE","\n\n    ",22],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","assertEqual",24],"(",["T_STRING","count",24],"(",["T_VARIABLE","$result",24],")",",",["T_WHITESPACE"," ",24],["T_LNUMBER","2",24],",",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct number of rows.'",24],")",";",["T_WHITESPACE","\n  ",24],"}",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * Tests that we can alter the joins on a query.\n   *\/",27],["T_WHITESPACE","\n  ",29],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","testAlterWithJoin",30],"(",")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$query",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","db_select",31],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",31],")",";",["T_WHITESPACE","\n    ",31],["T_VARIABLE","$tid_field",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$query",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","addField",32],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",32],",",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'tid'",32],")",";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$task_field",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_VARIABLE","$query",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","addField",33],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'task'",33],")",";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$query",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","orderBy",34],"(",["T_VARIABLE","$task_field",34],")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$query",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","addTag",35],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_add_join'",35],")",";",["T_WHITESPACE","\n\n    ",35],["T_VARIABLE","$result",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$query",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","execute",37],"(",")",";",["T_WHITESPACE","\n\n    ",37],["T_VARIABLE","$records",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$result",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","fetchAll",39],"(",")",";",["T_WHITESPACE","\n\n    ",39],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","assertEqual",41],"(",["T_STRING","count",41],"(",["T_VARIABLE","$records",41],")",",",["T_WHITESPACE"," ",41],["T_LNUMBER","2",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct number of rows.'",41],")",";",["T_WHITESPACE","\n\n    ",41],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","assertEqual",43],"(",["T_VARIABLE","$records",43],"[",["T_LNUMBER","0",43],"]",["T_OBJECT_OPERATOR","->",43],["T_STRING","name",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'George'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",43],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","assertEqual",44],"(",["T_VARIABLE","$records",44],"[",["T_LNUMBER","0",44],"]",["T_OBJECT_OPERATOR","->",44],["T_VARIABLE","$tid_field",44],",",["T_WHITESPACE"," ",44],["T_LNUMBER","4",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertEqual",45],"(",["T_VARIABLE","$records",45],"[",["T_LNUMBER","0",45],"]",["T_OBJECT_OPERATOR","->",45],["T_VARIABLE","$task_field",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'sing'",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",45],")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","assertEqual",46],"(",["T_VARIABLE","$records",46],"[",["T_LNUMBER","1",46],"]",["T_OBJECT_OPERATOR","->",46],["T_STRING","name",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'George'",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",46],")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertEqual",47],"(",["T_VARIABLE","$records",47],"[",["T_LNUMBER","1",47],"]",["T_OBJECT_OPERATOR","->",47],["T_VARIABLE","$tid_field",47],",",["T_WHITESPACE"," ",47],["T_LNUMBER","5",47],",",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",47],")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","assertEqual",48],"(",["T_VARIABLE","$records",48],"[",["T_LNUMBER","1",48],"]",["T_OBJECT_OPERATOR","->",48],["T_VARIABLE","$task_field",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'sleep'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",48],")",";",["T_WHITESPACE","\n  ",48],"}",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * Tests that we can alter a query's conditionals.\n   *\/",51],["T_WHITESPACE","\n  ",53],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","testAlterChangeConditional",54],"(",")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$query",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","db_select",55],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",55],")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$tid_field",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$query",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","addField",56],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'tid'",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$pid_field",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$query",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","addField",57],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'pid'",57],")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$task_field",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$query",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","addField",58],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'task'",58],")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$people_alias",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$query",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","join",59],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'people'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","\"test_task.pid = people.id\"",59],")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$name_field",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$query",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","addField",60],"(",["T_VARIABLE","$people_alias",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'name'",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'name'",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$query",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","condition",61],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task.tid'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'1'",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$query",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","orderBy",62],"(",["T_VARIABLE","$tid_field",62],")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$query",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","addTag",63],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_change_conditional'",63],")",";",["T_WHITESPACE","\n\n    ",63],["T_VARIABLE","$result",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$query",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","execute",65],"(",")",";",["T_WHITESPACE","\n\n    ",65],["T_VARIABLE","$records",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$result",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","fetchAll",67],"(",")",";",["T_WHITESPACE","\n\n    ",67],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEqual",69],"(",["T_STRING","count",69],"(",["T_VARIABLE","$records",69],")",",",["T_WHITESPACE"," ",69],["T_LNUMBER","1",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct number of rows.'",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertEqual",70],"(",["T_VARIABLE","$records",70],"[",["T_LNUMBER","0",70],"]",["T_OBJECT_OPERATOR","->",70],["T_VARIABLE","$name_field",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'John'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertEqual",71],"(",["T_VARIABLE","$records",71],"[",["T_LNUMBER","0",71],"]",["T_OBJECT_OPERATOR","->",71],["T_VARIABLE","$tid_field",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","2",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertEqual",72],"(",["T_VARIABLE","$records",72],"[",["T_LNUMBER","0",72],"]",["T_OBJECT_OPERATOR","->",72],["T_VARIABLE","$pid_field",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","1",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","assertEqual",73],"(",["T_VARIABLE","$records",73],"[",["T_LNUMBER","0",73],"]",["T_OBJECT_OPERATOR","->",73],["T_VARIABLE","$task_field",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'sleep'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",73],")",";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * Tests that we can alter the fields of a query.\n   *\/",76],["T_WHITESPACE","\n  ",78],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","testAlterChangeFields",79],"(",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$query",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","db_select",80],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",80],")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$name_field",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$query",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","addField",81],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'name'",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$age_field",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$query",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","addField",82],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'age'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'age'",82],")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$query",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","orderBy",83],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",83],")",";",["T_WHITESPACE","\n    ",83],["T_VARIABLE","$query",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","addTag",84],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_change_fields'",84],")",";",["T_WHITESPACE","\n\n    ",84],["T_VARIABLE","$record",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$query",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","execute",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","fetch",86],"(",")",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertEqual",87],"(",["T_VARIABLE","$record",87],["T_OBJECT_OPERATOR","->",87],["T_VARIABLE","$name_field",87],",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'George'",87],",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'Correct data retrieved.'",87],")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertFalse",88],"(",["T_ISSET","isset",88],"(",["T_VARIABLE","$record",88],["T_OBJECT_OPERATOR","->",88],["T_VARIABLE","$age_field",88],")",",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'Age field not found, as intended.'",88],")",";",["T_WHITESPACE","\n  ",88],"}",["T_WHITESPACE","\n\n  ",89],["T_DOC_COMMENT","\/**\n   * Tests that we can alter expressions in the query.\n   *\/",91],["T_WHITESPACE","\n  ",93],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","testAlterExpression",94],"(",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$query",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","db_select",95],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$name_field",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$query",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","addField",96],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'name'",96],")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$age_field",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$query",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","addExpression",97],"(",["T_CONSTANT_ENCAPSED_STRING","\"age*2\"",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'double_age'",97],")",";",["T_WHITESPACE","\n    ",97],["T_VARIABLE","$query",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","condition",98],"(",["T_CONSTANT_ENCAPSED_STRING","'age'",98],",",["T_WHITESPACE"," ",98],["T_LNUMBER","27",98],")",";",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$query",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","addTag",99],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_change_expressions'",99],")",";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$result",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$query",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","execute",100],"(",")",";",["T_WHITESPACE","\n\n    ",100],["T_COMMENT","\/\/ Ensure that we got the right record.\n",102],["T_WHITESPACE","    ",103],["T_VARIABLE","$record",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$result",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","fetch",103],"(",")",";",["T_WHITESPACE","\n\n    ",103],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","assertEqual",105],"(",["T_VARIABLE","$record",105],["T_OBJECT_OPERATOR","->",105],["T_VARIABLE","$name_field",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'George'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'Fetched name is correct.'",105],")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertEqual",106],"(",["T_VARIABLE","$record",106],["T_OBJECT_OPERATOR","->",106],["T_VARIABLE","$age_field",106],",",["T_WHITESPACE"," ",106],["T_LNUMBER","27",106],["T_WHITESPACE"," ",106],"*",["T_WHITESPACE"," ",106],["T_LNUMBER","3",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'Fetched age expression is correct.'",106],")",";",["T_WHITESPACE","\n  ",106],"}",["T_WHITESPACE","\n\n  ",107],["T_DOC_COMMENT","\/**\n   * Tests that we can remove a range() value from a query.\n   *\n   * This also tests hook_query_TAG_alter().\n   *\/",109],["T_WHITESPACE","\n  ",113],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","testAlterRemoveRange",114],"(",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$query",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","db_select",115],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",115],")",";",["T_WHITESPACE","\n    ",115],["T_VARIABLE","$query",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","addField",116],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",116],",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'name'",116],")",";",["T_WHITESPACE","\n    ",116],["T_VARIABLE","$query",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","addField",117],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'age'",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'age'",117],")",";",["T_WHITESPACE","\n    ",117],["T_VARIABLE","$query",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","range",118],"(",["T_LNUMBER","0",118],",",["T_WHITESPACE"," ",118],["T_LNUMBER","2",118],")",";",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$query",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","addTag",119],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_remove_range'",119],")",";",["T_WHITESPACE","\n\n    ",119],["T_VARIABLE","$num_records",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","count",121],"(",["T_VARIABLE","$query",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","execute",121],"(",")",["T_OBJECT_OPERATOR","->",121],["T_STRING","fetchAll",121],"(",")",")",";",["T_WHITESPACE","\n\n    ",121],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","assertEqual",123],"(",["T_VARIABLE","$num_records",123],",",["T_WHITESPACE"," ",123],["T_LNUMBER","4",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct number of rows.'",123],")",";",["T_WHITESPACE","\n  ",123],"}",["T_WHITESPACE","\n\n  ",124],["T_DOC_COMMENT","\/**\n   * Tests that we can do basic alters on subqueries.\n   *\/",126],["T_WHITESPACE","\n  ",128],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","testSimpleAlterSubquery",129],"(",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n    ",129],["T_COMMENT","\/\/ Create a sub-query with an alter tag.\n",130],["T_WHITESPACE","    ",131],["T_VARIABLE","$subquery",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","db_select",131],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'p'",131],")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$subquery",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","addField",132],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'name'",132],")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$subquery",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","addField",133],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'id'",133],")",";",["T_WHITESPACE","\n    ",133],["T_COMMENT","\/\/ Pick out George.\n",134],["T_WHITESPACE","    ",135],["T_VARIABLE","$subquery",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","condition",135],"(",["T_CONSTANT_ENCAPSED_STRING","'age'",135],",",["T_WHITESPACE"," ",135],["T_LNUMBER","27",135],")",";",["T_WHITESPACE","\n    ",135],["T_VARIABLE","$subquery",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","addExpression",136],"(",["T_CONSTANT_ENCAPSED_STRING","\"age*2\"",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'double_age'",136],")",";",["T_WHITESPACE","\n    ",136],["T_COMMENT","\/\/ This query alter should change it to age * 3.\n",137],["T_WHITESPACE","    ",138],["T_VARIABLE","$subquery",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","addTag",138],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test_alter_change_expressions'",138],")",";",["T_WHITESPACE","\n\n    ",138],["T_COMMENT","\/\/ Create a main query and join to sub-query.\n",140],["T_WHITESPACE","    ",141],["T_VARIABLE","$query",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","db_select",141],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",141],",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'tt'",141],")",";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$query",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","join",142],"(",["T_VARIABLE","$subquery",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'pq'",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'pq.id = tt.pid'",142],")",";",["T_WHITESPACE","\n    ",142],["T_VARIABLE","$age_field",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$query",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","addField",143],"(",["T_CONSTANT_ENCAPSED_STRING","'pq'",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'double_age'",143],")",";",["T_WHITESPACE","\n    ",143],["T_VARIABLE","$name_field",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$query",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","addField",144],"(",["T_CONSTANT_ENCAPSED_STRING","'pq'",144],",",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'name'",144],")",";",["T_WHITESPACE","\n\n    ",144],["T_VARIABLE","$record",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$query",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","execute",146],"(",")",["T_OBJECT_OPERATOR","->",146],["T_STRING","fetch",146],"(",")",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","assertEqual",147],"(",["T_VARIABLE","$record",147],["T_OBJECT_OPERATOR","->",147],["T_VARIABLE","$name_field",147],",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'George'",147],",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'Fetched name is correct.'",147],")",";",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","assertEqual",148],"(",["T_VARIABLE","$record",148],["T_OBJECT_OPERATOR","->",148],["T_VARIABLE","$age_field",148],",",["T_WHITESPACE"," ",148],["T_LNUMBER","27",148],["T_WHITESPACE"," ",148],"*",["T_WHITESPACE"," ",148],["T_LNUMBER","3",148],",",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'Fetched age expression is correct.'",148],")",";",["T_WHITESPACE","\n  ",148],"}",["T_WHITESPACE","\n\n",149],"}",["T_WHITESPACE","\n",151]]