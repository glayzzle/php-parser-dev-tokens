[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Render",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","KernelTests",5],["T_NS_SEPARATOR","\\",5],["T_STRING","KernelTestBase",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","simpletest",6],["T_NS_SEPARATOR","\\",6],["T_STRING","UserCreationTrait",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests the caching of render items via functional tests.\n *\n * @group Render\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","RenderCacheTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","KernelTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","UserCreationTrait",15],";",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$modules",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],"[",["T_CONSTANT_ENCAPSED_STRING","'user'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'system'",22],"]",";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",24],["T_WHITESPACE","\n  ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_FUNCTION","function",27],["T_WHITESPACE"," ",27],["T_STRING","setUp",27],"(",")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n    ",27],["T_STRING","parent",28],["T_DOUBLE_COLON","::",28],["T_STRING","setUp",28],"(",")",";",["T_WHITESPACE","\n    ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","installEntitySchema",29],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",29],")",";",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","installConfig",30],"(","[",["T_CONSTANT_ENCAPSED_STRING","'user'",30],"]",")",";",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","installSchema",31],"(",["T_CONSTANT_ENCAPSED_STRING","'system'",31],",",["T_WHITESPACE"," ",31],"[",["T_CONSTANT_ENCAPSED_STRING","'sequences'",31],"]",")",";",["T_WHITESPACE","\n  ",31],"}",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Tests that user 1 has a different permission context with the same roles.\n   *\/",34],["T_WHITESPACE","\n  ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","testUser1PermissionContext",37],"(",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","doTestUser1WithContexts",38],"(","[",["T_CONSTANT_ENCAPSED_STRING","'user.permissions'",38],"]",")",";",["T_WHITESPACE","\n  ",38],"}",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * Tests that user 1 has a different roles context with the same roles.\n   *\/",41],["T_WHITESPACE","\n  ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","testUser1RolesContext",44],"(",")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","doTestUser1WithContexts",45],"(","[",["T_CONSTANT_ENCAPSED_STRING","'user.roles'",45],"]",")",";",["T_WHITESPACE","\n  ",45],"}",["T_WHITESPACE","\n\n  ",46],["T_DOC_COMMENT","\/**\n   * Ensures that user 1 has a unique render cache for the given context.\n   *\n   * @param string[] $contexts\n   *   List of cache contexts to use.\n   *\/",48],["T_WHITESPACE","\n  ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","doTestUser1WithContexts",54],"(",["T_VARIABLE","$contexts",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n    ",54],["T_COMMENT","\/\/ Test that user 1 does not share the cache with other users who have the\n",55],["T_WHITESPACE","    ",56],["T_COMMENT","\/\/ same roles, even when using a role-based cache context.\n",56],["T_WHITESPACE","    ",57],["T_VARIABLE","$user1",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","createUser",57],"(",")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertEqual",58],"(",["T_VARIABLE","$user1",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","id",58],"(",")",",",["T_WHITESPACE"," ",58],["T_LNUMBER","1",58],")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$first_authenticated_user",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","createUser",59],"(",")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$second_authenticated_user",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","createUser",60],"(",")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$admin_user",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","createUser",61],"(","[","]",",",["T_WHITESPACE"," ",61],["T_STRING","NULL",61],",",["T_WHITESPACE"," ",61],["T_STRING","TRUE",61],")",";",["T_WHITESPACE","\n\n    ",61],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertEqual",63],"(",["T_VARIABLE","$user1",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getRoles",63],"(",")",",",["T_WHITESPACE"," ",63],["T_VARIABLE","$first_authenticated_user",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getRoles",63],"(",")",",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'User 1 has the same roles as an authenticated user.'",63],")",";",["T_WHITESPACE","\n    ",63],["T_COMMENT","\/\/ Impersonate user 1 and render content that only user 1 should have\n",64],["T_WHITESPACE","    ",65],["T_COMMENT","\/\/ permission to see.\n",65],["T_WHITESPACE","    ",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Drupal",66],["T_DOUBLE_COLON","::",66],["T_STRING","service",66],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",66],")",["T_OBJECT_OPERATOR","->",66],["T_STRING","switchTo",66],"(",["T_VARIABLE","$user1",66],")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$test_element",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],"[",["T_WHITESPACE","\n      ",67],["T_CONSTANT_ENCAPSED_STRING","'#cache'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],"[",["T_WHITESPACE","\n        ",68],["T_CONSTANT_ENCAPSED_STRING","'keys'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'test'",69],"]",",",["T_WHITESPACE","\n        ",69],["T_CONSTANT_ENCAPSED_STRING","'contexts'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$contexts",70],",",["T_WHITESPACE","\n      ",70],"]",",",["T_WHITESPACE","\n    ",71],"]",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$element",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$test_element",73],";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$element",74],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",74],"]",["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'content for user 1'",74],";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$output",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Drupal",75],["T_DOUBLE_COLON","::",75],["T_STRING","service",75],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","renderRoot",75],"(",["T_VARIABLE","$element",75],")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertEqual",76],"(",["T_VARIABLE","$output",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'content for user 1'",76],")",";",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/\/ Verify the cache is working by rendering the same element but with\n",78],["T_WHITESPACE","    ",79],["T_COMMENT","\/\/ different markup passed in; the result should be the same.\n",79],["T_WHITESPACE","    ",80],["T_VARIABLE","$element",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$test_element",80],";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$element",81],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",81],"]",["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'should not be used'",81],";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$output",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Drupal",82],["T_DOUBLE_COLON","::",82],["T_STRING","service",82],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",82],")",["T_OBJECT_OPERATOR","->",82],["T_STRING","renderRoot",82],"(",["T_VARIABLE","$element",82],")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertEqual",83],"(",["T_VARIABLE","$output",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'content for user 1'",83],")",";",["T_WHITESPACE","\n    ",83],["T_NS_SEPARATOR","\\",84],["T_STRING","Drupal",84],["T_DOUBLE_COLON","::",84],["T_STRING","service",84],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",84],")",["T_OBJECT_OPERATOR","->",84],["T_STRING","switchBack",84],"(",")",";",["T_WHITESPACE","\n\n    ",84],["T_COMMENT","\/\/ Verify that the first authenticated user does not see the same content\n",86],["T_WHITESPACE","    ",87],["T_COMMENT","\/\/ as user 1.\n",87],["T_WHITESPACE","    ",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Drupal",88],["T_DOUBLE_COLON","::",88],["T_STRING","service",88],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",88],")",["T_OBJECT_OPERATOR","->",88],["T_STRING","switchTo",88],"(",["T_VARIABLE","$first_authenticated_user",88],")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$element",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$test_element",89],";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$element",90],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",90],"]",["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'content for authenticated users'",90],";",["T_WHITESPACE","\n    ",90],["T_VARIABLE","$output",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Drupal",91],["T_DOUBLE_COLON","::",91],["T_STRING","service",91],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","renderRoot",91],"(",["T_VARIABLE","$element",91],")",";",["T_WHITESPACE","\n    ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","assertEqual",92],"(",["T_VARIABLE","$output",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'content for authenticated users'",92],")",";",["T_WHITESPACE","\n    ",92],["T_NS_SEPARATOR","\\",93],["T_STRING","Drupal",93],["T_DOUBLE_COLON","::",93],["T_STRING","service",93],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",93],")",["T_OBJECT_OPERATOR","->",93],["T_STRING","switchBack",93],"(",")",";",["T_WHITESPACE","\n\n    ",93],["T_COMMENT","\/\/ Verify that the second authenticated user shares the cache with the\n",95],["T_WHITESPACE","    ",96],["T_COMMENT","\/\/ first authenticated user.\n",96],["T_WHITESPACE","    ",97],["T_NS_SEPARATOR","\\",97],["T_STRING","Drupal",97],["T_DOUBLE_COLON","::",97],["T_STRING","service",97],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",97],")",["T_OBJECT_OPERATOR","->",97],["T_STRING","switchTo",97],"(",["T_VARIABLE","$second_authenticated_user",97],")",";",["T_WHITESPACE","\n    ",97],["T_VARIABLE","$element",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$test_element",98],";",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$element",99],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",99],"]",["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'should not be used'",99],";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$output",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Drupal",100],["T_DOUBLE_COLON","::",100],["T_STRING","service",100],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",100],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","renderRoot",100],"(",["T_VARIABLE","$element",100],")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertEqual",101],"(",["T_VARIABLE","$output",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'content for authenticated users'",101],")",";",["T_WHITESPACE","\n    ",101],["T_NS_SEPARATOR","\\",102],["T_STRING","Drupal",102],["T_DOUBLE_COLON","::",102],["T_STRING","service",102],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",102],")",["T_OBJECT_OPERATOR","->",102],["T_STRING","switchBack",102],"(",")",";",["T_WHITESPACE","\n\n    ",102],["T_COMMENT","\/\/ Verify that the admin user (who has an admin role without explicit\n",104],["T_WHITESPACE","    ",105],["T_COMMENT","\/\/ permissions) does not share the same cache.\n",105],["T_WHITESPACE","    ",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Drupal",106],["T_DOUBLE_COLON","::",106],["T_STRING","service",106],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","switchTo",106],"(",["T_VARIABLE","$admin_user",106],")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$element",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$test_element",107],";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$element",108],"[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",108],"]",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'content for admin user'",108],";",["T_WHITESPACE","\n    ",108],["T_VARIABLE","$output",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Drupal",109],["T_DOUBLE_COLON","::",109],["T_STRING","service",109],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","renderRoot",109],"(",["T_VARIABLE","$element",109],")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertEqual",110],"(",["T_VARIABLE","$output",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'content for admin user'",110],")",";",["T_WHITESPACE","\n    ",110],["T_NS_SEPARATOR","\\",111],["T_STRING","Drupal",111],["T_DOUBLE_COLON","::",111],["T_STRING","service",111],"(",["T_CONSTANT_ENCAPSED_STRING","'account_switcher'",111],")",["T_OBJECT_OPERATOR","->",111],["T_STRING","switchBack",111],"(",")",";",["T_WHITESPACE","\n  ",111],"}",["T_WHITESPACE","\n\n",112],"}",["T_WHITESPACE","\n",114]]