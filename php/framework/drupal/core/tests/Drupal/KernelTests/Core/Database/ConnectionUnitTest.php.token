[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTests",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTestBase",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests management of database connections.\n *\n * @group Database\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","ConnectionUnitTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","KernelTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$key",15],";",["T_WHITESPACE","\n  ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$target",16],";",["T_WHITESPACE","\n\n  ",16],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$monitor",18],";",["T_WHITESPACE","\n  ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$originalCount",19],";",["T_WHITESPACE","\n\n  ",19],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","setUp",21],"(",")",["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n    ",21],["T_STRING","parent",22],["T_DOUBLE_COLON","::",22],["T_STRING","setUp",22],"(",")",";",["T_WHITESPACE","\n\n    ",22],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","key",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'default'",24],";",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","originalTarget",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'default'",25],";",["T_WHITESPACE","\n    ",25],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","target",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'DatabaseConnectionUnitTest'",26],";",["T_WHITESPACE","\n\n    ",26],["T_COMMENT","\/\/ Determine whether the database driver is MySQL. If it is not, the test\n",28],["T_WHITESPACE","    ",29],["T_COMMENT","\/\/ methods will not be executed.\n",29],["T_WHITESPACE","    ",30],["T_COMMENT","\/\/ @todo Make this test driver-agnostic, or find a proper way to skip it.\n",30],["T_WHITESPACE","    ",31],["T_COMMENT","\/\/   See https:\/\/www.drupal.org\/node\/1273478.\n",31],["T_WHITESPACE","    ",32],["T_VARIABLE","$connection_info",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","Database",32],["T_DOUBLE_COLON","::",32],["T_STRING","getConnectionInfo",32],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",32],")",";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","skipTest",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_BOOL_CAST","(bool)",33],["T_WHITESPACE"," ",33],"(",["T_VARIABLE","$connection_info",33],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",33],"]","[",["T_CONSTANT_ENCAPSED_STRING","'driver'",33],"]",["T_WHITESPACE"," ",33],["T_IS_NOT_EQUAL","!=",33],["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'mysql'",33],")",";",["T_WHITESPACE","\n    ",33],["T_IF","if",34],["T_WHITESPACE"," ",34],"(",["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","skipTest",34],")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n      ",34],["T_COMMENT","\/\/ Insert an assertion to prevent Simpletest from interpreting the test\n",35],["T_WHITESPACE","      ",36],["T_COMMENT","\/\/ as failure.\n",36],["T_WHITESPACE","      ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","pass",37],"(",["T_CONSTANT_ENCAPSED_STRING","'This test is only compatible with MySQL.'",37],")",";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/ Create an additional connection to monitor the connections being opened\n",40],["T_WHITESPACE","    ",41],["T_COMMENT","\/\/ and closed in this test.\n",41],["T_WHITESPACE","    ",42],["T_COMMENT","\/\/ @see TestBase::changeDatabasePrefix()\n",42],["T_WHITESPACE","    ",43],["T_STRING","Database",43],["T_DOUBLE_COLON","::",43],["T_STRING","addConnectionInfo",43],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'monitor'",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$connection_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",43],"]",")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","monitor",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","Database",44],["T_DOUBLE_COLON","::",44],["T_STRING","getConnection",44],"(",["T_CONSTANT_ENCAPSED_STRING","'monitor'",44],")",";",["T_WHITESPACE","\n  ",44],"}",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * Adds a new database connection info to Database.\n   *\/",47],["T_WHITESPACE","\n  ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","addConnection",50],"(",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_COMMENT","\/\/ Add a new target to the connection, by cloning the current connection.\n",51],["T_WHITESPACE","    ",52],["T_VARIABLE","$connection_info",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","Database",52],["T_DOUBLE_COLON","::",52],["T_STRING","getConnectionInfo",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","key",52],")",";",["T_WHITESPACE","\n    ",52],["T_STRING","Database",53],["T_DOUBLE_COLON","::",53],["T_STRING","addConnectionInfo",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","key",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","target",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$connection_info",53],"[",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","originalTarget",53],"]",")",";",["T_WHITESPACE","\n\n    ",53],["T_COMMENT","\/\/ Verify that the new target exists.\n",55],["T_WHITESPACE","    ",56],["T_VARIABLE","$info",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","Database",56],["T_DOUBLE_COLON","::",56],["T_STRING","getConnectionInfo",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","key",56],")",";",["T_WHITESPACE","\n    ",56],["T_COMMENT","\/\/ Note: Custom assertion message to not expose database credentials.\n",57],["T_WHITESPACE","    ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertIdentical",58],"(",["T_VARIABLE","$info",58],"[",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","target",58],"]",",",["T_WHITESPACE"," ",58],["T_VARIABLE","$connection_info",58],"[",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","key",58],"]",",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'New connection info found.'",58],")",";",["T_WHITESPACE","\n  ",58],"}",["T_WHITESPACE","\n\n  ",59],["T_DOC_COMMENT","\/**\n   * Returns the connection ID of the current test connection.\n   *\n   * @return int\n   *\/",61],["T_WHITESPACE","\n  ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","getConnectionID",66],"(",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n    ",66],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_INT_CAST","(int)",67],["T_WHITESPACE"," ",67],["T_STRING","Database",67],["T_DOUBLE_COLON","::",67],["T_STRING","getConnection",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","target",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","key",67],")",["T_OBJECT_OPERATOR","->",67],["T_STRING","query",67],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT CONNECTION_ID()'",67],")",["T_OBJECT_OPERATOR","->",67],["T_STRING","fetchField",67],"(",")",";",["T_WHITESPACE","\n  ",67],"}",["T_WHITESPACE","\n\n  ",68],["T_DOC_COMMENT","\/**\n   * Asserts that a connection ID exists.\n   *\n   * @param int $id\n   *   The connection ID to verify.\n   *\/",70],["T_WHITESPACE","\n  ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","assertConnection",76],"(",["T_VARIABLE","$id",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$list",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","monitor",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","query",77],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW PROCESSLIST'",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","fetchAllKeyed",77],"(",["T_LNUMBER","0",77],",",["T_WHITESPACE"," ",77],["T_LNUMBER","0",77],")",";",["T_WHITESPACE","\n    ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertTrue",78],"(",["T_ISSET","isset",78],"(",["T_VARIABLE","$list",78],"[",["T_VARIABLE","$id",78],"]",")",",",["T_WHITESPACE"," ",78],["T_STRING","format_string",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection ID @id found.'",78],",",["T_WHITESPACE"," ",78],["T_ARRAY","array",78],"(",["T_CONSTANT_ENCAPSED_STRING","'@id'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$id",78],")",")",")",";",["T_WHITESPACE","\n  ",78],"}",["T_WHITESPACE","\n\n  ",79],["T_DOC_COMMENT","\/**\n   * Asserts that a connection ID does not exist.\n   *\n   * @param int $id\n   *   The connection ID to verify.\n   *\/",81],["T_WHITESPACE","\n  ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","assertNoConnection",87],"(",["T_VARIABLE","$id",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$list",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","monitor",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","query",88],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW PROCESSLIST'",88],")",["T_OBJECT_OPERATOR","->",88],["T_STRING","fetchAllKeyed",88],"(",["T_LNUMBER","0",88],",",["T_WHITESPACE"," ",88],["T_LNUMBER","0",88],")",";",["T_WHITESPACE","\n    ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertFalse",89],"(",["T_ISSET","isset",89],"(",["T_VARIABLE","$list",89],"[",["T_VARIABLE","$id",89],"]",")",",",["T_WHITESPACE"," ",89],["T_STRING","format_string",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection ID @id not found.'",89],",",["T_WHITESPACE"," ",89],["T_ARRAY","array",89],"(",["T_CONSTANT_ENCAPSED_STRING","'@id'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$id",89],")",")",")",";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Tests Database::closeConnection() without query.\n   *\n   * @todo getConnectionID() executes a query.\n   *\/",92],["T_WHITESPACE","\n  ",96],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","testOpenClose",97],"(",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n    ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","skipTest",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n      ",98],["T_RETURN","return",99],";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n    ",100],["T_COMMENT","\/\/ Add and open a new connection.\n",101],["T_WHITESPACE","    ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","addConnection",102],"(",")",";",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$id",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getConnectionID",103],"(",")",";",["T_WHITESPACE","\n    ",103],["T_STRING","Database",104],["T_DOUBLE_COLON","::",104],["T_STRING","getConnection",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","target",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","key",104],")",";",["T_WHITESPACE","\n\n    ",104],["T_COMMENT","\/\/ Verify that there is a new connection.\n",106],["T_WHITESPACE","    ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","assertConnection",107],"(",["T_VARIABLE","$id",107],")",";",["T_WHITESPACE","\n\n    ",107],["T_COMMENT","\/\/ Close the connection.\n",109],["T_WHITESPACE","    ",110],["T_STRING","Database",110],["T_DOUBLE_COLON","::",110],["T_STRING","closeConnection",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","target",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","key",110],")",";",["T_WHITESPACE","\n    ",110],["T_COMMENT","\/\/ Wait 20ms to give the database engine sufficient time to react.\n",111],["T_WHITESPACE","    ",112],["T_STRING","usleep",112],"(",["T_LNUMBER","20000",112],")",";",["T_WHITESPACE","\n\n    ",112],["T_COMMENT","\/\/ Verify that we are back to the original connection count.\n",114],["T_WHITESPACE","    ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","assertNoConnection",115],"(",["T_VARIABLE","$id",115],")",";",["T_WHITESPACE","\n  ",115],"}",["T_WHITESPACE","\n\n  ",116],["T_DOC_COMMENT","\/**\n   * Tests Database::closeConnection() with a query.\n   *\/",118],["T_WHITESPACE","\n  ",120],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","testOpenQueryClose",121],"(",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n    ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","skipTest",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n      ",122],["T_RETURN","return",123],";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n    ",124],["T_COMMENT","\/\/ Add and open a new connection.\n",125],["T_WHITESPACE","    ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","addConnection",126],"(",")",";",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$id",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getConnectionID",127],"(",")",";",["T_WHITESPACE","\n    ",127],["T_STRING","Database",128],["T_DOUBLE_COLON","::",128],["T_STRING","getConnection",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","target",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","key",128],")",";",["T_WHITESPACE","\n\n    ",128],["T_COMMENT","\/\/ Verify that there is a new connection.\n",130],["T_WHITESPACE","    ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertConnection",131],"(",["T_VARIABLE","$id",131],")",";",["T_WHITESPACE","\n\n    ",131],["T_COMMENT","\/\/ Execute a query.\n",133],["T_WHITESPACE","    ",134],["T_STRING","Database",134],["T_DOUBLE_COLON","::",134],["T_STRING","getConnection",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","target",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","key",134],")",["T_OBJECT_OPERATOR","->",134],["T_STRING","query",134],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW TABLES'",134],")",";",["T_WHITESPACE","\n\n    ",134],["T_COMMENT","\/\/ Close the connection.\n",136],["T_WHITESPACE","    ",137],["T_STRING","Database",137],["T_DOUBLE_COLON","::",137],["T_STRING","closeConnection",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","target",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","key",137],")",";",["T_WHITESPACE","\n    ",137],["T_COMMENT","\/\/ Wait 20ms to give the database engine sufficient time to react.\n",138],["T_WHITESPACE","    ",139],["T_STRING","usleep",139],"(",["T_LNUMBER","20000",139],")",";",["T_WHITESPACE","\n\n    ",139],["T_COMMENT","\/\/ Verify that we are back to the original connection count.\n",141],["T_WHITESPACE","    ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","assertNoConnection",142],"(",["T_VARIABLE","$id",142],")",";",["T_WHITESPACE","\n  ",142],"}",["T_WHITESPACE","\n\n  ",143],["T_DOC_COMMENT","\/**\n   * Tests Database::closeConnection() with a query and custom prefetch method.\n   *\/",145],["T_WHITESPACE","\n  ",147],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","testOpenQueryPrefetchClose",148],"(",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n    ",148],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","skipTest",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n      ",149],["T_RETURN","return",150],";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n    ",151],["T_COMMENT","\/\/ Add and open a new connection.\n",152],["T_WHITESPACE","    ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","addConnection",153],"(",")",";",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$id",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getConnectionID",154],"(",")",";",["T_WHITESPACE","\n    ",154],["T_STRING","Database",155],["T_DOUBLE_COLON","::",155],["T_STRING","getConnection",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","target",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","key",155],")",";",["T_WHITESPACE","\n\n    ",155],["T_COMMENT","\/\/ Verify that there is a new connection.\n",157],["T_WHITESPACE","    ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","assertConnection",158],"(",["T_VARIABLE","$id",158],")",";",["T_WHITESPACE","\n\n    ",158],["T_COMMENT","\/\/ Execute a query.\n",160],["T_WHITESPACE","    ",161],["T_STRING","Database",161],["T_DOUBLE_COLON","::",161],["T_STRING","getConnection",161],"(",["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","target",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","key",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","query",161],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW TABLES'",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","fetchCol",161],"(",")",";",["T_WHITESPACE","\n\n    ",161],["T_COMMENT","\/\/ Close the connection.\n",163],["T_WHITESPACE","    ",164],["T_STRING","Database",164],["T_DOUBLE_COLON","::",164],["T_STRING","closeConnection",164],"(",["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","target",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","key",164],")",";",["T_WHITESPACE","\n    ",164],["T_COMMENT","\/\/ Wait 20ms to give the database engine sufficient time to react.\n",165],["T_WHITESPACE","    ",166],["T_STRING","usleep",166],"(",["T_LNUMBER","20000",166],")",";",["T_WHITESPACE","\n\n    ",166],["T_COMMENT","\/\/ Verify that we are back to the original connection count.\n",168],["T_WHITESPACE","    ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","assertNoConnection",169],"(",["T_VARIABLE","$id",169],")",";",["T_WHITESPACE","\n  ",169],"}",["T_WHITESPACE","\n\n  ",170],["T_DOC_COMMENT","\/**\n   * Tests Database::closeConnection() with a select query.\n   *\/",172],["T_WHITESPACE","\n  ",174],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","testOpenSelectQueryClose",175],"(",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n    ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","skipTest",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n      ",176],["T_RETURN","return",177],";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n    ",178],["T_COMMENT","\/\/ Add and open a new connection.\n",179],["T_WHITESPACE","    ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","addConnection",180],"(",")",";",["T_WHITESPACE","\n    ",180],["T_VARIABLE","$id",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getConnectionID",181],"(",")",";",["T_WHITESPACE","\n    ",181],["T_STRING","Database",182],["T_DOUBLE_COLON","::",182],["T_STRING","getConnection",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","target",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","key",182],")",";",["T_WHITESPACE","\n\n    ",182],["T_COMMENT","\/\/ Verify that there is a new connection.\n",184],["T_WHITESPACE","    ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertConnection",185],"(",["T_VARIABLE","$id",185],")",";",["T_WHITESPACE","\n\n    ",185],["T_COMMENT","\/\/ Create a table.\n",187],["T_WHITESPACE","    ",188],["T_VARIABLE","$name",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'foo'",188],";",["T_WHITESPACE","\n    ",188],["T_STRING","Database",189],["T_DOUBLE_COLON","::",189],["T_STRING","getConnection",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","target",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","key",189],")",["T_OBJECT_OPERATOR","->",189],["T_STRING","schema",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","createTable",189],"(",["T_VARIABLE","$name",189],",",["T_WHITESPACE"," ",189],["T_ARRAY","array",189],"(",["T_WHITESPACE","\n      ",189],["T_CONSTANT_ENCAPSED_STRING","'fields'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_ARRAY","array",190],"(",["T_WHITESPACE","\n        ",190],["T_CONSTANT_ENCAPSED_STRING","'name'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",["T_WHITESPACE","\n          ",191],["T_CONSTANT_ENCAPSED_STRING","'type'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'varchar'",192],",",["T_WHITESPACE","\n          ",192],["T_CONSTANT_ENCAPSED_STRING","'length'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_LNUMBER","255",193],",",["T_WHITESPACE","\n        ",193],")",",",["T_WHITESPACE","\n      ",194],")",",",["T_WHITESPACE","\n    ",195],")",")",";",["T_WHITESPACE","\n\n    ",196],["T_COMMENT","\/\/ Execute a query.\n",198],["T_WHITESPACE","    ",199],["T_STRING","Database",199],["T_DOUBLE_COLON","::",199],["T_STRING","getConnection",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","target",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","key",199],")",["T_OBJECT_OPERATOR","->",199],["T_STRING","select",199],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'f'",199],")",["T_WHITESPACE","\n      ",199],["T_OBJECT_OPERATOR","->",200],["T_STRING","fields",200],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",200],",",["T_WHITESPACE"," ",200],["T_ARRAY","array",200],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",200],")",")",["T_WHITESPACE","\n      ",200],["T_OBJECT_OPERATOR","->",201],["T_STRING","execute",201],"(",")",["T_WHITESPACE","\n      ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","fetchAll",202],"(",")",";",["T_WHITESPACE","\n\n    ",202],["T_COMMENT","\/\/ Drop the table.\n",204],["T_WHITESPACE","    ",205],["T_STRING","Database",205],["T_DOUBLE_COLON","::",205],["T_STRING","getConnection",205],"(",["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","target",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","key",205],")",["T_OBJECT_OPERATOR","->",205],["T_STRING","schema",205],"(",")",["T_OBJECT_OPERATOR","->",205],["T_STRING","dropTable",205],"(",["T_VARIABLE","$name",205],")",";",["T_WHITESPACE","\n\n    ",205],["T_COMMENT","\/\/ Close the connection.\n",207],["T_WHITESPACE","    ",208],["T_STRING","Database",208],["T_DOUBLE_COLON","::",208],["T_STRING","closeConnection",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","target",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","key",208],")",";",["T_WHITESPACE","\n    ",208],["T_COMMENT","\/\/ Wait 20ms to give the database engine sufficient time to react.\n",209],["T_WHITESPACE","    ",210],["T_STRING","usleep",210],"(",["T_LNUMBER","20000",210],")",";",["T_WHITESPACE","\n\n    ",210],["T_COMMENT","\/\/ Verify that we are back to the original connection count.\n",212],["T_WHITESPACE","    ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","assertNoConnection",213],"(",["T_VARIABLE","$id",213],")",";",["T_WHITESPACE","\n  ",213],"}",["T_WHITESPACE","\n\n  ",214],["T_DOC_COMMENT","\/**\n   * Tests pdo options override.\n   *\/",216],["T_WHITESPACE","\n  ",218],["T_PUBLIC","public",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","testConnectionOpen",219],"(",")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n    ",219],["T_VARIABLE","$connection",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","Database",220],["T_DOUBLE_COLON","::",220],["T_STRING","getConnection",220],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",220],")",";",["T_WHITESPACE","\n    ",220],["T_VARIABLE","$reflection",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_NEW","new",221],["T_WHITESPACE"," ",221],["T_NS_SEPARATOR","\\",221],["T_STRING","ReflectionObject",221],"(",["T_VARIABLE","$connection",221],")",";",["T_WHITESPACE","\n    ",221],["T_VARIABLE","$connection_property",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$reflection",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getProperty",222],"(",["T_CONSTANT_ENCAPSED_STRING","'connection'",222],")",";",["T_WHITESPACE","\n    ",222],["T_VARIABLE","$connection_property",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","setAccessible",223],"(",["T_STRING","TRUE",223],")",";",["T_WHITESPACE","\n    ",223],["T_VARIABLE","$error_mode",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$connection_property",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getValue",224],"(",["T_VARIABLE","$connection",224],")",["T_WHITESPACE","\n      ",224],["T_OBJECT_OPERATOR","->",225],["T_STRING","getAttribute",225],"(",["T_NS_SEPARATOR","\\",225],["T_STRING","PDO",225],["T_DOUBLE_COLON","::",225],["T_STRING","ATTR_ERRMODE",225],")",";",["T_WHITESPACE","\n    ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","assertEqual",226],"(",["T_VARIABLE","$error_mode",226],",",["T_WHITESPACE"," ",226],["T_NS_SEPARATOR","\\",226],["T_STRING","PDO",226],["T_DOUBLE_COLON","::",226],["T_STRING","ERRMODE_EXCEPTION",226],",",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'Ensure the default error mode is set to exception.'",226],")",";",["T_WHITESPACE","\n\n    ",226],["T_VARIABLE","$connection",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","Database",228],["T_DOUBLE_COLON","::",228],["T_STRING","getConnectionInfo",228],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",228],")",";",["T_WHITESPACE","\n    ",228],["T_VARIABLE","$connection",229],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",229],"]","[",["T_CONSTANT_ENCAPSED_STRING","'pdo'",229],"]","[",["T_NS_SEPARATOR","\\",229],["T_STRING","PDO",229],["T_DOUBLE_COLON","::",229],["T_STRING","ATTR_ERRMODE",229],"]",["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_NS_SEPARATOR","\\",229],["T_STRING","PDO",229],["T_DOUBLE_COLON","::",229],["T_STRING","ERRMODE_SILENT",229],";",["T_WHITESPACE","\n    ",229],["T_STRING","Database",230],["T_DOUBLE_COLON","::",230],["T_STRING","addConnectionInfo",230],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",230],",",["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'default'",230],",",["T_WHITESPACE"," ",230],["T_VARIABLE","$connection",230],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",230],"]",")",";",["T_WHITESPACE","\n    ",230],["T_VARIABLE","$connection",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_STRING","Database",231],["T_DOUBLE_COLON","::",231],["T_STRING","getConnection",231],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",231],",",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'test'",231],")",";",["T_WHITESPACE","\n\n    ",231],["T_VARIABLE","$reflection",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_NEW","new",233],["T_WHITESPACE"," ",233],["T_NS_SEPARATOR","\\",233],["T_STRING","ReflectionObject",233],"(",["T_VARIABLE","$connection",233],")",";",["T_WHITESPACE","\n    ",233],["T_VARIABLE","$connection_property",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$reflection",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getProperty",234],"(",["T_CONSTANT_ENCAPSED_STRING","'connection'",234],")",";",["T_WHITESPACE","\n    ",234],["T_VARIABLE","$connection_property",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","setAccessible",235],"(",["T_STRING","TRUE",235],")",";",["T_WHITESPACE","\n    ",235],["T_VARIABLE","$error_mode",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$connection_property",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getValue",236],"(",["T_VARIABLE","$connection",236],")",["T_WHITESPACE","\n      ",236],["T_OBJECT_OPERATOR","->",237],["T_STRING","getAttribute",237],"(",["T_NS_SEPARATOR","\\",237],["T_STRING","PDO",237],["T_DOUBLE_COLON","::",237],["T_STRING","ATTR_ERRMODE",237],")",";",["T_WHITESPACE","\n    ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","assertEqual",238],"(",["T_VARIABLE","$error_mode",238],",",["T_WHITESPACE"," ",238],["T_NS_SEPARATOR","\\",238],["T_STRING","PDO",238],["T_DOUBLE_COLON","::",238],["T_STRING","ERRMODE_SILENT",238],",",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'Ensure PDO connection options can be overridden.'",238],")",";",["T_WHITESPACE","\n\n    ",238],["T_STRING","Database",240],["T_DOUBLE_COLON","::",240],["T_STRING","removeConnection",240],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",240],")",";",["T_WHITESPACE","\n  ",240],"}",["T_WHITESPACE","\n\n",241],"}",["T_WHITESPACE","\n",243]]