[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KeyValueStore",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DependencyInjection",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ContainerBuilder",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KeyValueStore",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KeyValueFactory",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests the key-value database storage.\n *\n * @group KeyValueStore\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","DatabaseStorageExpirableTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","StorageTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",15],["T_WHITESPACE","\n  ",19],["T_PUBLIC","public",20],["T_WHITESPACE"," ",20],["T_STATIC","static",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$modules",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_ARRAY","array",20],"(",["T_CONSTANT_ENCAPSED_STRING","'system'",20],")",";",["T_WHITESPACE","\n\n  ",20],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","setUp",22],"(",")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n    ",22],["T_STRING","parent",23],["T_DOUBLE_COLON","::",23],["T_STRING","setUp",23],"(",")",";",["T_WHITESPACE","\n    ",23],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","factory",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'keyvalue.expirable'",24],";",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","installSchema",25],"(",["T_CONSTANT_ENCAPSED_STRING","'system'",25],",",["T_WHITESPACE"," ",25],["T_ARRAY","array",25],"(",["T_CONSTANT_ENCAPSED_STRING","'key_value_expire'",25],")",")",";",["T_WHITESPACE","\n  ",25],"}",["T_WHITESPACE","\n\n  ",26],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",28],["T_WHITESPACE","\n  ",30],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","register",31],"(",["T_STRING","ContainerBuilder",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$container",31],")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n    ",31],["T_STRING","parent",32],["T_DOUBLE_COLON","::",32],["T_STRING","register",32],"(",["T_VARIABLE","$container",32],")",";",["T_WHITESPACE","\n\n    ",32],["T_VARIABLE","$parameter",34],"[",["T_STRING","KeyValueFactory",34],["T_DOUBLE_COLON","::",34],["T_STRING","DEFAULT_SETTING",34],"]",["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'keyvalue.expirable.database'",34],";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$container",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","setParameter",35],"(",["T_CONSTANT_ENCAPSED_STRING","'factory.keyvalue.expirable'",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$parameter",35],")",";",["T_WHITESPACE","\n  ",35],"}",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * Tests CRUD functionality with expiration.\n   *\/",38],["T_WHITESPACE","\n  ",40],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","testCRUDWithExpiration",41],"(",")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$stores",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","createStorage",42],"(",")",";",["T_WHITESPACE","\n\n    ",42],["T_COMMENT","\/\/ Verify that an item can be stored with setWithExpire().\n",44],["T_WHITESPACE","    ",45],["T_COMMENT","\/\/ Use a random expiration in each test.\n",45],["T_WHITESPACE","    ",46],["T_VARIABLE","$stores",46],"[",["T_LNUMBER","0",46],"]",["T_OBJECT_OPERATOR","->",46],["T_STRING","setWithExpire",46],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","objects",46],"[",["T_LNUMBER","0",46],"]",",",["T_WHITESPACE"," ",46],["T_STRING","rand",46],"(",["T_LNUMBER","500",46],",",["T_WHITESPACE"," ",46],["T_LNUMBER","100000",46],")",")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertIdenticalObject",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","objects",47],"[",["T_LNUMBER","0",47],"]",",",["T_WHITESPACE"," ",47],["T_VARIABLE","$stores",47],"[",["T_LNUMBER","0",47],"]",["T_OBJECT_OPERATOR","->",47],["T_STRING","get",47],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",47],")",")",";",["T_WHITESPACE","\n    ",47],["T_COMMENT","\/\/ Verify that the other collection is not affected.\n",48],["T_WHITESPACE","    ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertFalse",49],"(",["T_VARIABLE","$stores",49],"[",["T_LNUMBER","1",49],"]",["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",49],")",")",";",["T_WHITESPACE","\n\n    ",49],["T_COMMENT","\/\/ Verify that an item can be updated with setWithExpire().\n",51],["T_WHITESPACE","    ",52],["T_VARIABLE","$stores",52],"[",["T_LNUMBER","0",52],"]",["T_OBJECT_OPERATOR","->",52],["T_STRING","setWithExpire",52],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","objects",52],"[",["T_LNUMBER","1",52],"]",",",["T_WHITESPACE"," ",52],["T_STRING","rand",52],"(",["T_LNUMBER","500",52],",",["T_WHITESPACE"," ",52],["T_LNUMBER","100000",52],")",")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","assertIdenticalObject",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","objects",53],"[",["T_LNUMBER","1",53],"]",",",["T_WHITESPACE"," ",53],["T_VARIABLE","$stores",53],"[",["T_LNUMBER","0",53],"]",["T_OBJECT_OPERATOR","->",53],["T_STRING","get",53],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",53],")",")",";",["T_WHITESPACE","\n    ",53],["T_COMMENT","\/\/ Verify that the other collection is still not affected.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","assertFalse",55],"(",["T_VARIABLE","$stores",55],"[",["T_LNUMBER","1",55],"]",["T_OBJECT_OPERATOR","->",55],["T_STRING","get",55],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",55],")",")",";",["T_WHITESPACE","\n\n    ",55],["T_COMMENT","\/\/ Verify that the expirable data key is unique.\n",57],["T_WHITESPACE","    ",58],["T_VARIABLE","$stores",58],"[",["T_LNUMBER","1",58],"]",["T_OBJECT_OPERATOR","->",58],["T_STRING","setWithExpire",58],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","objects",58],"[",["T_LNUMBER","2",58],"]",",",["T_WHITESPACE"," ",58],["T_STRING","rand",58],"(",["T_LNUMBER","500",58],",",["T_WHITESPACE"," ",58],["T_LNUMBER","100000",58],")",")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertIdenticalObject",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","objects",59],"[",["T_LNUMBER","1",59],"]",",",["T_WHITESPACE"," ",59],["T_VARIABLE","$stores",59],"[",["T_LNUMBER","0",59],"]",["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",59],")",")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertIdenticalObject",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","objects",60],"[",["T_LNUMBER","2",60],"]",",",["T_WHITESPACE"," ",60],["T_VARIABLE","$stores",60],"[",["T_LNUMBER","1",60],"]",["T_OBJECT_OPERATOR","->",60],["T_STRING","get",60],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",60],")",")",";",["T_WHITESPACE","\n\n    ",60],["T_COMMENT","\/\/ Verify that multiple items can be stored with setMultipleWithExpire().\n",62],["T_WHITESPACE","    ",63],["T_VARIABLE","$values",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",["T_WHITESPACE","\n      ",63],["T_CONSTANT_ENCAPSED_STRING","'foo'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","objects",64],"[",["T_LNUMBER","3",64],"]",",",["T_WHITESPACE","\n      ",64],["T_CONSTANT_ENCAPSED_STRING","'bar'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","objects",65],"[",["T_LNUMBER","4",65],"]",",",["T_WHITESPACE","\n    ",65],")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$stores",67],"[",["T_LNUMBER","0",67],"]",["T_OBJECT_OPERATOR","->",67],["T_STRING","setMultipleWithExpire",67],"(",["T_VARIABLE","$values",67],",",["T_WHITESPACE"," ",67],["T_STRING","rand",67],"(",["T_LNUMBER","500",67],",",["T_WHITESPACE"," ",67],["T_LNUMBER","100000",67],")",")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$result",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$stores",68],"[",["T_LNUMBER","0",68],"]",["T_OBJECT_OPERATOR","->",68],["T_STRING","getMultiple",68],"(",["T_ARRAY","array",68],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'bar'",68],")",")",";",["T_WHITESPACE","\n    ",68],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$values",69],["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$j",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$value",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n      ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertIdenticalObject",70],"(",["T_VARIABLE","$value",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$result",70],"[",["T_VARIABLE","$j",70],"]",")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_COMMENT","\/\/ Verify that the other collection was not affected.\n",73],["T_WHITESPACE","    ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","assertIdenticalObject",74],"(",["T_VARIABLE","$stores",74],"[",["T_LNUMBER","1",74],"]",["T_OBJECT_OPERATOR","->",74],["T_STRING","get",74],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",74],")",",",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","objects",74],"[",["T_LNUMBER","2",74],"]",")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertFalse",75],"(",["T_VARIABLE","$stores",75],"[",["T_LNUMBER","1",75],"]",["T_OBJECT_OPERATOR","->",75],["T_STRING","get",75],"(",["T_CONSTANT_ENCAPSED_STRING","'bar'",75],")",")",";",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Verify that all items in a collection can be retrieved.\n",77],["T_WHITESPACE","    ",78],["T_COMMENT","\/\/ Ensure that an item with the same name exists in the other collection.\n",78],["T_WHITESPACE","    ",79],["T_VARIABLE","$stores",79],"[",["T_LNUMBER","1",79],"]",["T_OBJECT_OPERATOR","->",79],["T_STRING","set",79],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","objects",79],"[",["T_LNUMBER","5",79],"]",")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$result",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$stores",80],"[",["T_LNUMBER","0",80],"]",["T_OBJECT_OPERATOR","->",80],["T_STRING","getAll",80],"(",")",";",["T_WHITESPACE","\n    ",80],["T_COMMENT","\/\/ Not using assertIdentical(), since the order is not defined for getAll().\n",81],["T_WHITESPACE","    ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertEqual",82],"(",["T_STRING","count",82],"(",["T_VARIABLE","$result",82],")",",",["T_WHITESPACE"," ",82],["T_STRING","count",82],"(",["T_VARIABLE","$values",82],")",")",";",["T_WHITESPACE","\n    ",82],["T_FOREACH","foreach",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$result",83],["T_WHITESPACE"," ",83],["T_AS","as",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$key",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$value",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n      ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertEqual",84],"(",["T_VARIABLE","$values",84],"[",["T_VARIABLE","$key",84],"]",",",["T_WHITESPACE"," ",84],["T_VARIABLE","$value",84],")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n    ",85],["T_COMMENT","\/\/ Verify that all items in the other collection are different.\n",86],["T_WHITESPACE","    ",87],["T_VARIABLE","$result",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$stores",87],"[",["T_LNUMBER","1",87],"]",["T_OBJECT_OPERATOR","->",87],["T_STRING","getAll",87],"(",")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertEqual",88],"(",["T_VARIABLE","$result",88],",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","objects",88],"[",["T_LNUMBER","5",88],"]",")",")",";",["T_WHITESPACE","\n\n    ",88],["T_COMMENT","\/\/ Verify that multiple items can be deleted.\n",90],["T_WHITESPACE","    ",91],["T_VARIABLE","$stores",91],"[",["T_LNUMBER","0",91],"]",["T_OBJECT_OPERATOR","->",91],["T_STRING","deleteMultiple",91],"(",["T_STRING","array_keys",91],"(",["T_VARIABLE","$values",91],")",")",";",["T_WHITESPACE","\n    ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","assertFalse",92],"(",["T_VARIABLE","$stores",92],"[",["T_LNUMBER","0",92],"]",["T_OBJECT_OPERATOR","->",92],["T_STRING","get",92],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",92],")",")",";",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertFalse",93],"(",["T_VARIABLE","$stores",93],"[",["T_LNUMBER","0",93],"]",["T_OBJECT_OPERATOR","->",93],["T_STRING","get",93],"(",["T_CONSTANT_ENCAPSED_STRING","'bar'",93],")",")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertFalse",94],"(",["T_VARIABLE","$stores",94],"[",["T_LNUMBER","0",94],"]",["T_OBJECT_OPERATOR","->",94],["T_STRING","getMultiple",94],"(",["T_ARRAY","array",94],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'bar'",94],")",")",")",";",["T_WHITESPACE","\n    ",94],["T_COMMENT","\/\/ Verify that the item in the other collection still exists.\n",95],["T_WHITESPACE","    ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","assertIdenticalObject",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","objects",96],"[",["T_LNUMBER","5",96],"]",",",["T_WHITESPACE"," ",96],["T_VARIABLE","$stores",96],"[",["T_LNUMBER","1",96],"]",["T_OBJECT_OPERATOR","->",96],["T_STRING","get",96],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",96],")",")",";",["T_WHITESPACE","\n\n    ",96],["T_COMMENT","\/\/ Test that setWithExpireIfNotExists() succeeds only the first time.\n",98],["T_WHITESPACE","    ",99],["T_VARIABLE","$key",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","randomMachineName",99],"(",")",";",["T_WHITESPACE","\n    ",99],["T_FOR","for",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$i",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_LNUMBER","0",100],";",["T_WHITESPACE"," ",100],["T_VARIABLE","$i",100],["T_WHITESPACE"," ",100],["T_IS_SMALLER_OR_EQUAL","<=",100],["T_WHITESPACE"," ",100],["T_LNUMBER","1",100],";",["T_WHITESPACE"," ",100],["T_VARIABLE","$i",100],["T_INC","++",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n      ",100],["T_COMMENT","\/\/ setWithExpireIfNotExists() should be TRUE the first time (when $i is\n",101],["T_WHITESPACE","      ",102],["T_COMMENT","\/\/ 0) and FALSE the second time (when $i is 1).\n",102],["T_WHITESPACE","      ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertEqual",103],"(","!",["T_VARIABLE","$i",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$stores",103],"[",["T_LNUMBER","0",103],"]",["T_OBJECT_OPERATOR","->",103],["T_STRING","setWithExpireIfNotExists",103],"(",["T_VARIABLE","$key",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","objects",103],"[",["T_VARIABLE","$i",103],"]",",",["T_WHITESPACE"," ",103],["T_STRING","rand",103],"(",["T_LNUMBER","500",103],",",["T_WHITESPACE"," ",103],["T_LNUMBER","100000",103],")",")",")",";",["T_WHITESPACE","\n      ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","assertIdenticalObject",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","objects",104],"[",["T_LNUMBER","0",104],"]",",",["T_WHITESPACE"," ",104],["T_VARIABLE","$stores",104],"[",["T_LNUMBER","0",104],"]",["T_OBJECT_OPERATOR","->",104],["T_STRING","get",104],"(",["T_VARIABLE","$key",104],")",")",";",["T_WHITESPACE","\n      ",104],["T_COMMENT","\/\/ Verify that the other collection is not affected.\n",105],["T_WHITESPACE","      ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertFalse",106],"(",["T_VARIABLE","$stores",106],"[",["T_LNUMBER","1",106],"]",["T_OBJECT_OPERATOR","->",106],["T_STRING","get",106],"(",["T_VARIABLE","$key",106],")",")",";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_COMMENT","\/\/ Remove the item and try to set it again.\n",109],["T_WHITESPACE","    ",110],["T_VARIABLE","$stores",110],"[",["T_LNUMBER","0",110],"]",["T_OBJECT_OPERATOR","->",110],["T_STRING","delete",110],"(",["T_VARIABLE","$key",110],")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$stores",111],"[",["T_LNUMBER","0",111],"]",["T_OBJECT_OPERATOR","->",111],["T_STRING","setWithExpireIfNotExists",111],"(",["T_VARIABLE","$key",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","objects",111],"[",["T_LNUMBER","1",111],"]",",",["T_WHITESPACE"," ",111],["T_STRING","rand",111],"(",["T_LNUMBER","500",111],",",["T_WHITESPACE"," ",111],["T_LNUMBER","100000",111],")",")",";",["T_WHITESPACE","\n    ",111],["T_COMMENT","\/\/ This time it should succeed.\n",112],["T_WHITESPACE","    ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertIdenticalObject",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","objects",113],"[",["T_LNUMBER","1",113],"]",",",["T_WHITESPACE"," ",113],["T_VARIABLE","$stores",113],"[",["T_LNUMBER","0",113],"]",["T_OBJECT_OPERATOR","->",113],["T_STRING","get",113],"(",["T_VARIABLE","$key",113],")",")",";",["T_WHITESPACE","\n    ",113],["T_COMMENT","\/\/ Verify that the other collection is still not affected.\n",114],["T_WHITESPACE","    ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","assertFalse",115],"(",["T_VARIABLE","$stores",115],"[",["T_LNUMBER","1",115],"]",["T_OBJECT_OPERATOR","->",115],["T_STRING","get",115],"(",["T_VARIABLE","$key",115],")",")",";",["T_WHITESPACE","\n\n  ",115],"}",["T_WHITESPACE","\n\n  ",117],["T_DOC_COMMENT","\/**\n   * Tests data expiration.\n   *\/",119],["T_WHITESPACE","\n  ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","testExpiration",122],"(",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n    ",122],["T_VARIABLE","$stores",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","createStorage",123],"(",")",";",["T_WHITESPACE","\n    ",123],["T_VARIABLE","$day",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_LNUMBER","604800",124],";",["T_WHITESPACE","\n\n    ",124],["T_COMMENT","\/\/ Set an item to expire in the past and another without an expiration.\n",126],["T_WHITESPACE","    ",127],["T_VARIABLE","$stores",127],"[",["T_LNUMBER","0",127],"]",["T_OBJECT_OPERATOR","->",127],["T_STRING","setWithExpire",127],"(",["T_CONSTANT_ENCAPSED_STRING","'yesterday'",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'all my troubles seemed so far away'",127],",",["T_WHITESPACE"," ",127],"-",["T_LNUMBER","1",127],["T_WHITESPACE"," ",127],"*",["T_WHITESPACE"," ",127],["T_VARIABLE","$day",127],")",";",["T_WHITESPACE","\n    ",127],["T_VARIABLE","$stores",128],"[",["T_LNUMBER","0",128],"]",["T_OBJECT_OPERATOR","->",128],["T_STRING","set",128],"(",["T_CONSTANT_ENCAPSED_STRING","'troubles'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'here to stay'",128],")",";",["T_WHITESPACE","\n\n    ",128],["T_COMMENT","\/\/ Only the non-expired item should be returned.\n",130],["T_WHITESPACE","    ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertFalse",131],"(",["T_VARIABLE","$stores",131],"[",["T_LNUMBER","0",131],"]",["T_OBJECT_OPERATOR","->",131],["T_STRING","has",131],"(",["T_CONSTANT_ENCAPSED_STRING","'yesterday'",131],")",")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","assertFalse",132],"(",["T_VARIABLE","$stores",132],"[",["T_LNUMBER","0",132],"]",["T_OBJECT_OPERATOR","->",132],["T_STRING","get",132],"(",["T_CONSTANT_ENCAPSED_STRING","'yesterday'",132],")",")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","assertTrue",133],"(",["T_VARIABLE","$stores",133],"[",["T_LNUMBER","0",133],"]",["T_OBJECT_OPERATOR","->",133],["T_STRING","has",133],"(",["T_CONSTANT_ENCAPSED_STRING","'troubles'",133],")",")",";",["T_WHITESPACE","\n    ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertIdentical",134],"(",["T_VARIABLE","$stores",134],"[",["T_LNUMBER","0",134],"]",["T_OBJECT_OPERATOR","->",134],["T_STRING","get",134],"(",["T_CONSTANT_ENCAPSED_STRING","'troubles'",134],")",",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'here to stay'",134],")",";",["T_WHITESPACE","\n    ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertIdentical",135],"(",["T_STRING","count",135],"(",["T_VARIABLE","$stores",135],"[",["T_LNUMBER","0",135],"]",["T_OBJECT_OPERATOR","->",135],["T_STRING","getMultiple",135],"(",["T_ARRAY","array",135],"(",["T_CONSTANT_ENCAPSED_STRING","'yesterday'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'troubles'",135],")",")",")",",",["T_WHITESPACE"," ",135],["T_LNUMBER","1",135],")",";",["T_WHITESPACE","\n\n    ",135],["T_COMMENT","\/\/ Store items set to expire in the past in various ways.\n",137],["T_WHITESPACE","    ",138],["T_VARIABLE","$stores",138],"[",["T_LNUMBER","0",138],"]",["T_OBJECT_OPERATOR","->",138],["T_STRING","setWithExpire",138],"(",["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","randomMachineName",138],"(",")",",",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","objects",138],"[",["T_LNUMBER","0",138],"]",",",["T_WHITESPACE"," ",138],"-",["T_LNUMBER","7",138],["T_WHITESPACE"," ",138],"*",["T_WHITESPACE"," ",138],["T_VARIABLE","$day",138],")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$stores",139],"[",["T_LNUMBER","0",139],"]",["T_OBJECT_OPERATOR","->",139],["T_STRING","setWithExpireIfNotExists",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","randomMachineName",139],"(",")",",",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","objects",139],"[",["T_LNUMBER","1",139],"]",",",["T_WHITESPACE"," ",139],"-",["T_LNUMBER","5",139],["T_WHITESPACE"," ",139],"*",["T_WHITESPACE"," ",139],["T_VARIABLE","$day",139],")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$stores",140],"[",["T_LNUMBER","0",140],"]",["T_OBJECT_OPERATOR","->",140],["T_STRING","setMultipleWithExpire",140],"(",["T_WHITESPACE","\n      ",140],["T_ARRAY","array",141],"(",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","randomMachineName",142],"(",")",["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","objects",142],"[",["T_LNUMBER","2",142],"]",",",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","randomMachineName",143],"(",")",["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","objects",143],"[",["T_LNUMBER","3",143],"]",",",["T_WHITESPACE","\n      ",143],")",",",["T_WHITESPACE","\n      ",144],"-",["T_LNUMBER","3",145],["T_WHITESPACE"," ",145],"*",["T_WHITESPACE"," ",145],["T_VARIABLE","$day",145],["T_WHITESPACE","\n    ",145],")",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$stores",147],"[",["T_LNUMBER","0",147],"]",["T_OBJECT_OPERATOR","->",147],["T_STRING","setWithExpireIfNotExists",147],"(",["T_CONSTANT_ENCAPSED_STRING","'yesterday'",147],",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","\"you'd forgiven me\"",147],",",["T_WHITESPACE"," ",147],"-",["T_LNUMBER","1",147],["T_WHITESPACE"," ",147],"*",["T_WHITESPACE"," ",147],["T_VARIABLE","$day",147],")",";",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$stores",148],"[",["T_LNUMBER","0",148],"]",["T_OBJECT_OPERATOR","->",148],["T_STRING","setWithExpire",148],"(",["T_CONSTANT_ENCAPSED_STRING","'still'",148],",",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","\"'til we say we're sorry\"",148],",",["T_WHITESPACE"," ",148],["T_LNUMBER","2",148],["T_WHITESPACE"," ",148],"*",["T_WHITESPACE"," ",148],["T_VARIABLE","$day",148],")",";",["T_WHITESPACE","\n\n    ",148],["T_COMMENT","\/\/ Ensure only non-expired items are retrieved.\n",150],["T_WHITESPACE","    ",151],["T_VARIABLE","$all",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$stores",151],"[",["T_LNUMBER","0",151],"]",["T_OBJECT_OPERATOR","->",151],["T_STRING","getAll",151],"(",")",";",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","assertIdentical",152],"(",["T_STRING","count",152],"(",["T_VARIABLE","$all",152],")",",",["T_WHITESPACE"," ",152],["T_LNUMBER","2",152],")",";",["T_WHITESPACE","\n    ",152],["T_FOREACH","foreach",153],["T_WHITESPACE"," ",153],"(",["T_ARRAY","array",153],"(",["T_CONSTANT_ENCAPSED_STRING","'troubles'",153],",",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'still'",153],")",["T_WHITESPACE"," ",153],["T_AS","as",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$key",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n      ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","assertTrue",154],"(","!",["T_EMPTY","empty",154],"(",["T_VARIABLE","$all",154],"[",["T_VARIABLE","$key",154],"]",")",")",";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n  ",155],"}",["T_WHITESPACE","\n\n",156],"}",["T_WHITESPACE","\n",158]]