[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Config",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Config",5],["T_NS_SEPARATOR","\\",5],["T_STRING","StorageComparer",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTests",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTestBase",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests config snapshot creation and updating.\n *\n * @group config\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","ConfigSnapshotTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","KernelTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",15],["T_WHITESPACE","\n  ",19],["T_PUBLIC","public",20],["T_WHITESPACE"," ",20],["T_STATIC","static",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$modules",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_ARRAY","array",20],"(",["T_CONSTANT_ENCAPSED_STRING","'config_test'",20],",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'system'",20],")",";",["T_WHITESPACE","\n\n  ",20],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",22],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","setUp",25],"(",")",["T_WHITESPACE"," ",25],"{",["T_WHITESPACE","\n    ",25],["T_STRING","parent",26],["T_DOUBLE_COLON","::",26],["T_STRING","setUp",26],"(",")",";",["T_WHITESPACE","\n    ",26],["T_COMMENT","\/\/ Update the config snapshot. This allows the parent::setUp() to write\n",27],["T_WHITESPACE","    ",28],["T_COMMENT","\/\/ configuration files.\n",28],["T_WHITESPACE","    ",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Drupal",29],["T_DOUBLE_COLON","::",29],["T_STRING","service",29],"(",["T_CONSTANT_ENCAPSED_STRING","'config.manager'",29],")",["T_OBJECT_OPERATOR","->",29],["T_STRING","createSnapshot",29],"(",["T_NS_SEPARATOR","\\",29],["T_STRING","Drupal",29],["T_DOUBLE_COLON","::",29],["T_STRING","service",29],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage'",29],")",",",["T_WHITESPACE"," ",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Drupal",29],["T_DOUBLE_COLON","::",29],["T_STRING","service",29],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage.snapshot'",29],")",")",";",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","copyConfig",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","container",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","get",30],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage'",30],")",",",["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","container",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","get",30],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage.sync'",30],")",")",";",["T_WHITESPACE","\n  ",30],"}",["T_WHITESPACE","\n\n  ",31],["T_DOC_COMMENT","\/**\n   * Tests config snapshot creation and updating.\n   *\/",33],["T_WHITESPACE","\n  ",35],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","testSnapshot",36],"(",")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$active",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","container",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","get",37],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage'",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$sync",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","container",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","get",38],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage.sync'",38],")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$snapshot",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","container",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","get",39],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage.snapshot'",39],")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$config_manager",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","container",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","get",40],"(",["T_CONSTANT_ENCAPSED_STRING","'config.manager'",40],")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$config_name",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'config_test.system'",41],";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$config_key",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'foo'",42],";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$new_data",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'foobar'",43],";",["T_WHITESPACE","\n\n    ",43],["T_VARIABLE","$active_snapshot_comparer",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_NEW","new",45],["T_WHITESPACE"," ",45],["T_STRING","StorageComparer",45],"(",["T_VARIABLE","$active",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$snapshot",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$config_manager",45],")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$sync_snapshot_comparer",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_NEW","new",46],["T_WHITESPACE"," ",46],["T_STRING","StorageComparer",46],"(",["T_VARIABLE","$sync",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$snapshot",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$config_manager",46],")",";",["T_WHITESPACE","\n\n    ",46],["T_COMMENT","\/\/ Verify that we have an initial snapshot that matches the active\n",48],["T_WHITESPACE","    ",49],["T_COMMENT","\/\/ configuration. This has to be true as no config should be installed.\n",49],["T_WHITESPACE","    ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","assertFalse",50],"(",["T_VARIABLE","$active_snapshot_comparer",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","createChangelist",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","hasChanges",50],"(",")",")",";",["T_WHITESPACE","\n\n    ",50],["T_COMMENT","\/\/ Install the default config.\n",52],["T_WHITESPACE","    ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","installConfig",53],"(",["T_ARRAY","array",53],"(",["T_CONSTANT_ENCAPSED_STRING","'config_test'",53],")",")",";",["T_WHITESPACE","\n    ",53],["T_COMMENT","\/\/ Although we have imported config this has not affected the snapshot.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","assertTrue",55],"(",["T_VARIABLE","$active_snapshot_comparer",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","reset",55],"(",")",["T_OBJECT_OPERATOR","->",55],["T_STRING","hasChanges",55],"(",")",")",";",["T_WHITESPACE","\n\n    ",55],["T_COMMENT","\/\/ Update the config snapshot.\n",57],["T_WHITESPACE","    ",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Drupal",58],["T_DOUBLE_COLON","::",58],["T_STRING","service",58],"(",["T_CONSTANT_ENCAPSED_STRING","'config.manager'",58],")",["T_OBJECT_OPERATOR","->",58],["T_STRING","createSnapshot",58],"(",["T_VARIABLE","$active",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$snapshot",58],")",";",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ The snapshot and active config should now contain the same config\n",60],["T_WHITESPACE","    ",61],["T_COMMENT","\/\/ objects.\n",61],["T_WHITESPACE","    ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertFalse",62],"(",["T_VARIABLE","$active_snapshot_comparer",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","reset",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","hasChanges",62],"(",")",")",";",["T_WHITESPACE","\n\n    ",62],["T_COMMENT","\/\/ Change a configuration value in sync.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$sync_data",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","config",65],"(",["T_VARIABLE","$config_name",65],")",["T_OBJECT_OPERATOR","->",65],["T_STRING","get",65],"(",")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$sync_data",66],"[",["T_VARIABLE","$config_key",66],"]",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$new_data",66],";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$sync",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","write",67],"(",["T_VARIABLE","$config_name",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$sync_data",67],")",";",["T_WHITESPACE","\n\n    ",67],["T_COMMENT","\/\/ Verify that active and snapshot match, and that sync doesn't match\n",69],["T_WHITESPACE","    ",70],["T_COMMENT","\/\/ active.\n",70],["T_WHITESPACE","    ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertFalse",71],"(",["T_VARIABLE","$active_snapshot_comparer",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","reset",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","hasChanges",71],"(",")",")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertTrue",72],"(",["T_VARIABLE","$sync_snapshot_comparer",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","createChangelist",72],"(",")",["T_OBJECT_OPERATOR","->",72],["T_STRING","hasChanges",72],"(",")",")",";",["T_WHITESPACE","\n\n    ",72],["T_COMMENT","\/\/ Import changed data from sync to active.\n",74],["T_WHITESPACE","    ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","configImporter",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","import",75],"(",")",";",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Verify changed config was properly imported.\n",77],["T_WHITESPACE","    ",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Drupal",78],["T_DOUBLE_COLON","::",78],["T_STRING","configFactory",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","reset",78],"(",["T_VARIABLE","$config_name",78],")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertIdentical",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","config",79],"(",["T_VARIABLE","$config_name",79],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","get",79],"(",["T_VARIABLE","$config_key",79],")",",",["T_WHITESPACE"," ",79],["T_VARIABLE","$new_data",79],")",";",["T_WHITESPACE","\n\n    ",79],["T_COMMENT","\/\/ Verify that a new snapshot was created which and that it matches\n",81],["T_WHITESPACE","    ",82],["T_COMMENT","\/\/ the active config.\n",82],["T_WHITESPACE","    ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertFalse",83],"(",["T_VARIABLE","$active_snapshot_comparer",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","reset",83],"(",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","hasChanges",83],"(",")",")",";",["T_WHITESPACE","\n  ",83],"}",["T_WHITESPACE","\n\n",84],"}",["T_WHITESPACE","\n",86]]