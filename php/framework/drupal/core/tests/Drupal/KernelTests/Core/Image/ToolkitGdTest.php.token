[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Image",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Image",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ImageInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Utility",6],["T_NS_SEPARATOR","\\",6],["T_STRING","SafeMarkup",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Site",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Settings",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","KernelTests",8],["T_NS_SEPARATOR","\\",8],["T_STRING","KernelTestBase",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Tests that core image manipulations work properly: scale, resize, rotate,\n * crop, scale and crop, and desaturate.\n *\n * @group Image\n *\/",10],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","ToolkitGdTest",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_STRING","KernelTestBase",16],["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\n  ",16],["T_DOC_COMMENT","\/**\n   * The image factory service.\n   *\n   * @var \\Drupal\\Core\\Image\\ImageFactory\n   *\/",18],["T_WHITESPACE","\n  ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$imageFactory",23],";",["T_WHITESPACE","\n\n  ",23],["T_COMMENT","\/\/ Colors that are used in testing.\n",25],["T_WHITESPACE","  ",26],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$black",26],["T_WHITESPACE","       ",26],"=",["T_WHITESPACE"," ",26],["T_ARRAY","array",26],"(",["T_LNUMBER","0",26],",",["T_WHITESPACE"," ",26],["T_LNUMBER","0",26],",",["T_WHITESPACE"," ",26],["T_LNUMBER","0",26],",",["T_WHITESPACE"," ",26],["T_LNUMBER","0",26],")",";",["T_WHITESPACE","\n  ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$red",27],["T_WHITESPACE","         ",27],"=",["T_WHITESPACE"," ",27],["T_ARRAY","array",27],"(",["T_LNUMBER","255",27],",",["T_WHITESPACE"," ",27],["T_LNUMBER","0",27],",",["T_WHITESPACE"," ",27],["T_LNUMBER","0",27],",",["T_WHITESPACE"," ",27],["T_LNUMBER","0",27],")",";",["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$green",28],["T_WHITESPACE","       ",28],"=",["T_WHITESPACE"," ",28],["T_ARRAY","array",28],"(",["T_LNUMBER","0",28],",",["T_WHITESPACE"," ",28],["T_LNUMBER","255",28],",",["T_WHITESPACE"," ",28],["T_LNUMBER","0",28],",",["T_WHITESPACE"," ",28],["T_LNUMBER","0",28],")",";",["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$blue",29],["T_WHITESPACE","        ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_LNUMBER","0",29],",",["T_WHITESPACE"," ",29],["T_LNUMBER","0",29],",",["T_WHITESPACE"," ",29],["T_LNUMBER","255",29],",",["T_WHITESPACE"," ",29],["T_LNUMBER","0",29],")",";",["T_WHITESPACE","\n  ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$yellow",30],["T_WHITESPACE","      ",30],"=",["T_WHITESPACE"," ",30],["T_ARRAY","array",30],"(",["T_LNUMBER","255",30],",",["T_WHITESPACE"," ",30],["T_LNUMBER","255",30],",",["T_WHITESPACE"," ",30],["T_LNUMBER","0",30],",",["T_WHITESPACE"," ",30],["T_LNUMBER","0",30],")",";",["T_WHITESPACE","\n  ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$white",31],["T_WHITESPACE","       ",31],"=",["T_WHITESPACE"," ",31],["T_ARRAY","array",31],"(",["T_LNUMBER","255",31],",",["T_WHITESPACE"," ",31],["T_LNUMBER","255",31],",",["T_WHITESPACE"," ",31],["T_LNUMBER","255",31],",",["T_WHITESPACE"," ",31],["T_LNUMBER","0",31],")",";",["T_WHITESPACE","\n  ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$transparent",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_ARRAY","array",32],"(",["T_LNUMBER","0",32],",",["T_WHITESPACE"," ",32],["T_LNUMBER","0",32],",",["T_WHITESPACE"," ",32],["T_LNUMBER","0",32],",",["T_WHITESPACE"," ",32],["T_LNUMBER","127",32],")",";",["T_WHITESPACE","\n  ",32],["T_COMMENT","\/\/ Used as rotate background colors.\n",33],["T_WHITESPACE","  ",34],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$fuchsia",34],["T_WHITESPACE","            ",34],"=",["T_WHITESPACE"," ",34],["T_ARRAY","array",34],"(",["T_LNUMBER","255",34],",",["T_WHITESPACE"," ",34],["T_LNUMBER","0",34],",",["T_WHITESPACE"," ",34],["T_LNUMBER","255",34],",",["T_WHITESPACE"," ",34],["T_LNUMBER","0",34],")",";",["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$rotateTransparent",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_LNUMBER","255",35],",",["T_WHITESPACE"," ",35],["T_LNUMBER","255",35],",",["T_WHITESPACE"," ",35],["T_LNUMBER","255",35],",",["T_WHITESPACE"," ",35],["T_LNUMBER","127",35],")",";",["T_WHITESPACE","\n\n  ",35],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$width",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_LNUMBER","40",37],";",["T_WHITESPACE","\n  ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$height",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_LNUMBER","20",38],";",["T_WHITESPACE","\n\n  ",38],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",40],["T_WHITESPACE","\n  ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_STATIC","static",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$modules",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_CONSTANT_ENCAPSED_STRING","'system'",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",45],")",";",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",47],["T_WHITESPACE","\n  ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","setUp",50],"(",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_STRING","parent",51],["T_DOUBLE_COLON","::",51],["T_STRING","setUp",51],"(",")",";",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Set the image factory service.\n",53],["T_WHITESPACE","    ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","imageFactory",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","container",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","get",54],"(",["T_CONSTANT_ENCAPSED_STRING","'image.factory'",54],")",";",["T_WHITESPACE","\n  ",54],"}",["T_WHITESPACE","\n\n  ",55],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","checkRequirements",57],"(",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n    ",57],["T_COMMENT","\/\/ GD2 support is available.\n",58],["T_WHITESPACE","    ",59],["T_IF","if",59],["T_WHITESPACE"," ",59],"(","!",["T_STRING","function_exists",59],"(",["T_CONSTANT_ENCAPSED_STRING","'imagegd2'",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n      ",59],["T_RETURN","return",60],["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",["T_WHITESPACE","\n        ",60],["T_CONSTANT_ENCAPSED_STRING","'Image manipulations for the GD toolkit cannot run because the GD toolkit is not available.'",61],",",["T_WHITESPACE","\n      ",61],")",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n    ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_STRING","parent",64],["T_DOUBLE_COLON","::",64],["T_STRING","checkRequirements",64],"(",")",";",["T_WHITESPACE","\n  ",64],"}",["T_WHITESPACE","\n\n  ",65],["T_DOC_COMMENT","\/**\n   * Function to compare two colors by RGBa.\n   *\/",67],["T_WHITESPACE","\n  ",69],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","colorsAreEqual",70],"(",["T_VARIABLE","$color_a",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$color_b",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_COMMENT","\/\/ Fully transparent pixels are equal, regardless of RGB.\n",71],["T_WHITESPACE","    ",72],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$color_a",72],"[",["T_LNUMBER","3",72],"]",["T_WHITESPACE"," ",72],["T_IS_EQUAL","==",72],["T_WHITESPACE"," ",72],["T_LNUMBER","127",72],["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$color_b",72],"[",["T_LNUMBER","3",72],"]",["T_WHITESPACE"," ",72],["T_IS_EQUAL","==",72],["T_WHITESPACE"," ",72],["T_LNUMBER","127",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n      ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_STRING","TRUE",73],";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_FOREACH","foreach",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$color_a",76],["T_WHITESPACE"," ",76],["T_AS","as",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$key",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$value",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n      ",76],["T_IF","if",77],["T_WHITESPACE"," ",77],"(",["T_VARIABLE","$color_b",77],"[",["T_VARIABLE","$key",77],"]",["T_WHITESPACE"," ",77],["T_IS_NOT_EQUAL","!=",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$value",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n        ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_STRING","FALSE",78],";",["T_WHITESPACE","\n      ",78],"}",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_STRING","TRUE",82],";",["T_WHITESPACE","\n  ",82],"}",["T_WHITESPACE","\n\n  ",83],["T_DOC_COMMENT","\/**\n   * Function for finding a pixel's RGBa values.\n   *\/",85],["T_WHITESPACE","\n  ",87],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","getPixelColor",88],"(",["T_STRING","ImageInterface",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$image",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$x",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$y",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$toolkit",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$image",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getToolkit",89],"(",")",";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$color_index",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","imagecolorat",90],"(",["T_VARIABLE","$toolkit",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getResource",90],"(",")",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$x",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$y",90],")",";",["T_WHITESPACE","\n\n    ",90],["T_VARIABLE","$transparent_index",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","imagecolortransparent",92],"(",["T_VARIABLE","$toolkit",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getResource",92],"(",")",")",";",["T_WHITESPACE","\n    ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$color_index",93],["T_WHITESPACE"," ",93],["T_IS_EQUAL","==",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$transparent_index",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n      ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_LNUMBER","0",94],",",["T_WHITESPACE"," ",94],["T_LNUMBER","0",94],",",["T_WHITESPACE"," ",94],["T_LNUMBER","0",94],",",["T_WHITESPACE"," ",94],["T_LNUMBER","127",94],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_STRING","array_values",97],"(",["T_STRING","imagecolorsforindex",97],"(",["T_VARIABLE","$toolkit",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getResource",97],"(",")",",",["T_WHITESPACE"," ",97],["T_VARIABLE","$color_index",97],")",")",";",["T_WHITESPACE","\n  ",97],"}",["T_WHITESPACE","\n\n  ",98],["T_DOC_COMMENT","\/**\n   * Since PHP can't visually check that our images have been manipulated\n   * properly, build a list of expected color values for each of the corners and\n   * the expected height and widths for the final images.\n   *\/",100],["T_WHITESPACE","\n  ",104],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","testManipulations",105],"(",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n\n    ",105],["T_COMMENT","\/\/ Test that the image factory is set to use the GD toolkit.\n",107],["T_WHITESPACE","    ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertEqual",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","imageFactory",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getToolkitId",108],"(",")",",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'gd'",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'The image factory is set to use the \\'gd\\' image toolkit.'",108],")",";",["T_WHITESPACE","\n\n    ",108],["T_COMMENT","\/\/ Test the list of supported extensions.\n",110],["T_WHITESPACE","    ",111],["T_VARIABLE","$expected_extensions",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],"[",["T_CONSTANT_ENCAPSED_STRING","'png'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'gif'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'jpeg'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'jpg'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'jpe'",111],"]",";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$supported_extensions",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","imageFactory",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getSupportedExtensions",112],"(",")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertEqual",113],"(",["T_VARIABLE","$expected_extensions",113],",",["T_WHITESPACE"," ",113],["T_STRING","array_intersect",113],"(",["T_VARIABLE","$expected_extensions",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$supported_extensions",113],")",")",";",["T_WHITESPACE","\n\n    ",113],["T_COMMENT","\/\/ Test that the supported extensions map to correct internal GD image\n",115],["T_WHITESPACE","    ",116],["T_COMMENT","\/\/ types.\n",116],["T_WHITESPACE","    ",117],["T_VARIABLE","$expected_image_types",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],"[",["T_WHITESPACE","\n      ",117],["T_CONSTANT_ENCAPSED_STRING","'png'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_STRING","IMAGETYPE_PNG",118],",",["T_WHITESPACE","\n      ",118],["T_CONSTANT_ENCAPSED_STRING","'gif'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_STRING","IMAGETYPE_GIF",119],",",["T_WHITESPACE","\n      ",119],["T_CONSTANT_ENCAPSED_STRING","'jpeg'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_STRING","IMAGETYPE_JPEG",120],",",["T_WHITESPACE","\n      ",120],["T_CONSTANT_ENCAPSED_STRING","'jpg'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_STRING","IMAGETYPE_JPEG",121],",",["T_WHITESPACE","\n      ",121],["T_CONSTANT_ENCAPSED_STRING","'jpe'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_STRING","IMAGETYPE_JPEG",122],["T_WHITESPACE","\n    ",122],"]",";",["T_WHITESPACE","\n    ",123],["T_VARIABLE","$image",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","imageFactory",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","get",124],"(",")",";",["T_WHITESPACE","\n    ",124],["T_FOREACH","foreach",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$expected_image_types",125],["T_WHITESPACE"," ",125],["T_AS","as",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$extension",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$expected_image_type",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n      ",125],["T_VARIABLE","$image_type",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$image",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getToolkit",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","extensionToImageType",126],"(",["T_VARIABLE","$extension",126],")",";",["T_WHITESPACE","\n      ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","assertSame",127],"(",["T_VARIABLE","$expected_image_type",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$image_type",127],")",";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_COMMENT","\/\/ Typically the corner colors will be unchanged. These colors are in the\n",130],["T_WHITESPACE","    ",131],["T_COMMENT","\/\/ order of top-left, top-right, bottom-right, bottom-left.\n",131],["T_WHITESPACE","    ",132],["T_VARIABLE","$default_corners",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","red",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","green",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","blue",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","transparent",132],")",";",["T_WHITESPACE","\n\n    ",132],["T_COMMENT","\/\/ A list of files that will be tested.\n",134],["T_WHITESPACE","    ",135],["T_VARIABLE","$files",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_ARRAY","array",135],"(",["T_WHITESPACE","\n      ",135],["T_CONSTANT_ENCAPSED_STRING","'image-test.png'",136],",",["T_WHITESPACE","\n      ",136],["T_CONSTANT_ENCAPSED_STRING","'image-test.gif'",137],",",["T_WHITESPACE","\n      ",137],["T_CONSTANT_ENCAPSED_STRING","'image-test-no-transparency.gif'",138],",",["T_WHITESPACE","\n      ",138],["T_CONSTANT_ENCAPSED_STRING","'image-test.jpg'",139],",",["T_WHITESPACE","\n    ",139],")",";",["T_WHITESPACE","\n\n    ",140],["T_COMMENT","\/\/ Setup a list of tests to perform on each type.\n",142],["T_WHITESPACE","    ",143],["T_VARIABLE","$operations",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_ARRAY","array",143],"(",["T_WHITESPACE","\n      ",143],["T_CONSTANT_ENCAPSED_STRING","'resize'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_ARRAY","array",144],"(",["T_WHITESPACE","\n        ",144],["T_CONSTANT_ENCAPSED_STRING","'function'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'resize'",145],",",["T_WHITESPACE","\n        ",145],["T_CONSTANT_ENCAPSED_STRING","'arguments'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_ARRAY","array",146],"(",["T_CONSTANT_ENCAPSED_STRING","'width'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_LNUMBER","20",146],",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'height'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_LNUMBER","10",146],")",",",["T_WHITESPACE","\n        ",146],["T_CONSTANT_ENCAPSED_STRING","'width'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_LNUMBER","20",147],",",["T_WHITESPACE","\n        ",147],["T_CONSTANT_ENCAPSED_STRING","'height'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_LNUMBER","10",148],",",["T_WHITESPACE","\n        ",148],["T_CONSTANT_ENCAPSED_STRING","'corners'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$default_corners",149],",",["T_WHITESPACE","\n      ",149],")",",",["T_WHITESPACE","\n      ",150],["T_CONSTANT_ENCAPSED_STRING","'scale_x'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_ARRAY","array",151],"(",["T_WHITESPACE","\n        ",151],["T_CONSTANT_ENCAPSED_STRING","'function'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'scale'",152],",",["T_WHITESPACE","\n        ",152],["T_CONSTANT_ENCAPSED_STRING","'arguments'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_ARRAY","array",153],"(",["T_CONSTANT_ENCAPSED_STRING","'width'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_LNUMBER","20",153],")",",",["T_WHITESPACE","\n        ",153],["T_CONSTANT_ENCAPSED_STRING","'width'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_LNUMBER","20",154],",",["T_WHITESPACE","\n        ",154],["T_CONSTANT_ENCAPSED_STRING","'height'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_LNUMBER","10",155],",",["T_WHITESPACE","\n        ",155],["T_CONSTANT_ENCAPSED_STRING","'corners'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$default_corners",156],",",["T_WHITESPACE","\n      ",156],")",",",["T_WHITESPACE","\n      ",157],["T_CONSTANT_ENCAPSED_STRING","'scale_y'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_ARRAY","array",158],"(",["T_WHITESPACE","\n        ",158],["T_CONSTANT_ENCAPSED_STRING","'function'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'scale'",159],",",["T_WHITESPACE","\n        ",159],["T_CONSTANT_ENCAPSED_STRING","'arguments'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_ARRAY","array",160],"(",["T_CONSTANT_ENCAPSED_STRING","'height'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","10",160],")",",",["T_WHITESPACE","\n        ",160],["T_CONSTANT_ENCAPSED_STRING","'width'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_LNUMBER","20",161],",",["T_WHITESPACE","\n        ",161],["T_CONSTANT_ENCAPSED_STRING","'height'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_LNUMBER","10",162],",",["T_WHITESPACE","\n        ",162],["T_CONSTANT_ENCAPSED_STRING","'corners'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$default_corners",163],",",["T_WHITESPACE","\n      ",163],")",",",["T_WHITESPACE","\n      ",164],["T_CONSTANT_ENCAPSED_STRING","'upscale_x'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",["T_WHITESPACE","\n        ",165],["T_CONSTANT_ENCAPSED_STRING","'function'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'scale'",166],",",["T_WHITESPACE","\n        ",166],["T_CONSTANT_ENCAPSED_STRING","'arguments'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_CONSTANT_ENCAPSED_STRING","'width'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_LNUMBER","80",167],",",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'upscale'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_STRING","TRUE",167],")",",",["T_WHITESPACE","\n        ",167],["T_CONSTANT_ENCAPSED_STRING","'width'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_LNUMBER","80",168],",",["T_WHITESPACE","\n        ",168],["T_CONSTANT_ENCAPSED_STRING","'height'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_LNUMBER","40",169],",",["T_WHITESPACE","\n        ",169],["T_CONSTANT_ENCAPSED_STRING","'corners'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$default_corners",170],",",["T_WHITESPACE","\n      ",170],")",",",["T_WHITESPACE","\n      ",171],["T_CONSTANT_ENCAPSED_STRING","'upscale_y'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",["T_WHITESPACE","\n        ",172],["T_CONSTANT_ENCAPSED_STRING","'function'",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'scale'",173],",",["T_WHITESPACE","\n        ",173],["T_CONSTANT_ENCAPSED_STRING","'arguments'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",["T_CONSTANT_ENCAPSED_STRING","'height'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_LNUMBER","40",174],",",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'upscale'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_STRING","TRUE",174],")",",",["T_WHITESPACE","\n        ",174],["T_CONSTANT_ENCAPSED_STRING","'width'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_LNUMBER","80",175],",",["T_WHITESPACE","\n        ",175],["T_CONSTANT_ENCAPSED_STRING","'height'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_LNUMBER","40",176],",",["T_WHITESPACE","\n        ",176],["T_CONSTANT_ENCAPSED_STRING","'corners'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$default_corners",177],",",["T_WHITESPACE","\n      ",177],")",",",["T_WHITESPACE","\n      ",178],["T_CONSTANT_ENCAPSED_STRING","'crop'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_ARRAY","array",179],"(",["T_WHITESPACE","\n        ",179],["T_CONSTANT_ENCAPSED_STRING","'function'",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'crop'",180],",",["T_WHITESPACE","\n        ",180],["T_CONSTANT_ENCAPSED_STRING","'arguments'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_ARRAY","array",181],"(",["T_CONSTANT_ENCAPSED_STRING","'x'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_LNUMBER","12",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'y'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_LNUMBER","4",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'width'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_LNUMBER","16",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'height'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_LNUMBER","12",181],")",",",["T_WHITESPACE","\n        ",181],["T_CONSTANT_ENCAPSED_STRING","'width'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_LNUMBER","16",182],",",["T_WHITESPACE","\n        ",182],["T_CONSTANT_ENCAPSED_STRING","'height'",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_LNUMBER","12",183],",",["T_WHITESPACE","\n        ",183],["T_CONSTANT_ENCAPSED_STRING","'corners'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_STRING","array_fill",184],"(",["T_LNUMBER","0",184],",",["T_WHITESPACE"," ",184],["T_LNUMBER","4",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","white",184],")",",",["T_WHITESPACE","\n      ",184],")",",",["T_WHITESPACE","\n      ",185],["T_CONSTANT_ENCAPSED_STRING","'scale_and_crop'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_ARRAY","array",186],"(",["T_WHITESPACE","\n        ",186],["T_CONSTANT_ENCAPSED_STRING","'function'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'scale_and_crop'",187],",",["T_WHITESPACE","\n        ",187],["T_CONSTANT_ENCAPSED_STRING","'arguments'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_ARRAY","array",188],"(",["T_CONSTANT_ENCAPSED_STRING","'width'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_LNUMBER","10",188],",",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'height'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_LNUMBER","8",188],")",",",["T_WHITESPACE","\n        ",188],["T_CONSTANT_ENCAPSED_STRING","'width'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_LNUMBER","10",189],",",["T_WHITESPACE","\n        ",189],["T_CONSTANT_ENCAPSED_STRING","'height'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_LNUMBER","8",190],",",["T_WHITESPACE","\n        ",190],["T_CONSTANT_ENCAPSED_STRING","'corners'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_STRING","array_fill",191],"(",["T_LNUMBER","0",191],",",["T_WHITESPACE"," ",191],["T_LNUMBER","4",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","black",191],")",",",["T_WHITESPACE","\n      ",191],")",",",["T_WHITESPACE","\n      ",192],["T_CONSTANT_ENCAPSED_STRING","'convert_jpg'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_ARRAY","array",193],"(",["T_WHITESPACE","\n        ",193],["T_CONSTANT_ENCAPSED_STRING","'function'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'convert'",194],",",["T_WHITESPACE","\n        ",194],["T_CONSTANT_ENCAPSED_STRING","'width'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_LNUMBER","40",195],",",["T_WHITESPACE","\n        ",195],["T_CONSTANT_ENCAPSED_STRING","'height'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_LNUMBER","20",196],",",["T_WHITESPACE","\n        ",196],["T_CONSTANT_ENCAPSED_STRING","'arguments'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_ARRAY","array",197],"(",["T_CONSTANT_ENCAPSED_STRING","'extension'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'jpeg'",197],")",",",["T_WHITESPACE","\n        ",197],["T_CONSTANT_ENCAPSED_STRING","'corners'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$default_corners",198],",",["T_WHITESPACE","\n      ",198],")",",",["T_WHITESPACE","\n      ",199],["T_CONSTANT_ENCAPSED_STRING","'convert_gif'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_ARRAY","array",200],"(",["T_WHITESPACE","\n        ",200],["T_CONSTANT_ENCAPSED_STRING","'function'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'convert'",201],",",["T_WHITESPACE","\n        ",201],["T_CONSTANT_ENCAPSED_STRING","'width'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_LNUMBER","40",202],",",["T_WHITESPACE","\n        ",202],["T_CONSTANT_ENCAPSED_STRING","'height'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_LNUMBER","20",203],",",["T_WHITESPACE","\n        ",203],["T_CONSTANT_ENCAPSED_STRING","'arguments'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_ARRAY","array",204],"(",["T_CONSTANT_ENCAPSED_STRING","'extension'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'gif'",204],")",",",["T_WHITESPACE","\n        ",204],["T_CONSTANT_ENCAPSED_STRING","'corners'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$default_corners",205],",",["T_WHITESPACE","\n      ",205],")",",",["T_WHITESPACE","\n      ",206],["T_CONSTANT_ENCAPSED_STRING","'convert_png'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_ARRAY","array",207],"(",["T_WHITESPACE","\n        ",207],["T_CONSTANT_ENCAPSED_STRING","'function'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'convert'",208],",",["T_WHITESPACE","\n        ",208],["T_CONSTANT_ENCAPSED_STRING","'width'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_LNUMBER","40",209],",",["T_WHITESPACE","\n        ",209],["T_CONSTANT_ENCAPSED_STRING","'height'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_LNUMBER","20",210],",",["T_WHITESPACE","\n        ",210],["T_CONSTANT_ENCAPSED_STRING","'arguments'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_ARRAY","array",211],"(",["T_CONSTANT_ENCAPSED_STRING","'extension'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'png'",211],")",",",["T_WHITESPACE","\n        ",211],["T_CONSTANT_ENCAPSED_STRING","'corners'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$default_corners",212],",",["T_WHITESPACE","\n      ",212],")",",",["T_WHITESPACE","\n    ",213],")",";",["T_WHITESPACE","\n\n    ",214],["T_COMMENT","\/\/ Systems using non-bundled GD2 don't have imagerotate. Test if available.\n",216],["T_WHITESPACE","    ",217],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_STRING","function_exists",217],"(",["T_CONSTANT_ENCAPSED_STRING","'imagerotate'",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n      ",217],["T_VARIABLE","$operations",218],["T_WHITESPACE"," ",218],["T_PLUS_EQUAL","+=",218],["T_WHITESPACE"," ",218],["T_ARRAY","array",218],"(",["T_WHITESPACE","\n        ",218],["T_CONSTANT_ENCAPSED_STRING","'rotate_5'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_ARRAY","array",219],"(",["T_WHITESPACE","\n          ",219],["T_CONSTANT_ENCAPSED_STRING","'function'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'rotate'",220],",",["T_WHITESPACE","\n          ",220],["T_CONSTANT_ENCAPSED_STRING","'arguments'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_ARRAY","array",221],"(",["T_CONSTANT_ENCAPSED_STRING","'degrees'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_LNUMBER","5",221],",",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'background'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'#FF00FF'",221],")",",",["T_WHITESPACE"," ",221],["T_COMMENT","\/\/ Fuchsia background.\n",221],["T_WHITESPACE","          ",222],["T_CONSTANT_ENCAPSED_STRING","'width'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_LNUMBER","41",222],",",["T_WHITESPACE","\n          ",222],["T_CONSTANT_ENCAPSED_STRING","'height'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_LNUMBER","23",223],",",["T_WHITESPACE","\n          ",223],["T_CONSTANT_ENCAPSED_STRING","'corners'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_STRING","array_fill",224],"(",["T_LNUMBER","0",224],",",["T_WHITESPACE"," ",224],["T_LNUMBER","4",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","fuchsia",224],")",",",["T_WHITESPACE","\n        ",224],")",",",["T_WHITESPACE","\n        ",225],["T_CONSTANT_ENCAPSED_STRING","'rotate_90'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_WHITESPACE","\n          ",226],["T_CONSTANT_ENCAPSED_STRING","'function'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'rotate'",227],",",["T_WHITESPACE","\n          ",227],["T_CONSTANT_ENCAPSED_STRING","'arguments'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_ARRAY","array",228],"(",["T_CONSTANT_ENCAPSED_STRING","'degrees'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_LNUMBER","90",228],",",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'background'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'#FF00FF'",228],")",",",["T_WHITESPACE"," ",228],["T_COMMENT","\/\/ Fuchsia background.\n",228],["T_WHITESPACE","          ",229],["T_CONSTANT_ENCAPSED_STRING","'width'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_LNUMBER","20",229],",",["T_WHITESPACE","\n          ",229],["T_CONSTANT_ENCAPSED_STRING","'height'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_LNUMBER","40",230],",",["T_WHITESPACE","\n          ",230],["T_CONSTANT_ENCAPSED_STRING","'corners'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_ARRAY","array",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","transparent",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","red",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","green",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","blue",231],")",",",["T_WHITESPACE","\n        ",231],")",",",["T_WHITESPACE","\n        ",232],["T_CONSTANT_ENCAPSED_STRING","'rotate_transparent_5'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_ARRAY","array",233],"(",["T_WHITESPACE","\n          ",233],["T_CONSTANT_ENCAPSED_STRING","'function'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'rotate'",234],",",["T_WHITESPACE","\n          ",234],["T_CONSTANT_ENCAPSED_STRING","'arguments'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_ARRAY","array",235],"(",["T_CONSTANT_ENCAPSED_STRING","'degrees'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_LNUMBER","5",235],")",",",["T_WHITESPACE","\n          ",235],["T_CONSTANT_ENCAPSED_STRING","'width'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_LNUMBER","41",236],",",["T_WHITESPACE","\n          ",236],["T_CONSTANT_ENCAPSED_STRING","'height'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_LNUMBER","23",237],",",["T_WHITESPACE","\n          ",237],["T_CONSTANT_ENCAPSED_STRING","'corners'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],["T_STRING","array_fill",238],"(",["T_LNUMBER","0",238],",",["T_WHITESPACE"," ",238],["T_LNUMBER","4",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","rotateTransparent",238],")",",",["T_WHITESPACE","\n        ",238],")",",",["T_WHITESPACE","\n        ",239],["T_CONSTANT_ENCAPSED_STRING","'rotate_transparent_90'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_ARRAY","array",240],"(",["T_WHITESPACE","\n          ",240],["T_CONSTANT_ENCAPSED_STRING","'function'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'rotate'",241],",",["T_WHITESPACE","\n          ",241],["T_CONSTANT_ENCAPSED_STRING","'arguments'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_ARRAY","array",242],"(",["T_CONSTANT_ENCAPSED_STRING","'degrees'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_LNUMBER","90",242],")",",",["T_WHITESPACE","\n          ",242],["T_CONSTANT_ENCAPSED_STRING","'width'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_LNUMBER","20",243],",",["T_WHITESPACE","\n          ",243],["T_CONSTANT_ENCAPSED_STRING","'height'",244],["T_WHITESPACE"," ",244],["T_DOUBLE_ARROW","=>",244],["T_WHITESPACE"," ",244],["T_LNUMBER","40",244],",",["T_WHITESPACE","\n          ",244],["T_CONSTANT_ENCAPSED_STRING","'corners'",245],["T_WHITESPACE"," ",245],["T_DOUBLE_ARROW","=>",245],["T_WHITESPACE"," ",245],["T_ARRAY","array",245],"(",["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","transparent",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","red",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","green",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","blue",245],")",",",["T_WHITESPACE","\n        ",245],")",",",["T_WHITESPACE","\n      ",246],")",";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_COMMENT","\/\/ Systems using non-bundled GD2 don't have imagefilter. Test if available.\n",250],["T_WHITESPACE","    ",251],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_STRING","function_exists",251],"(",["T_CONSTANT_ENCAPSED_STRING","'imagefilter'",251],")",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n      ",251],["T_VARIABLE","$operations",252],["T_WHITESPACE"," ",252],["T_PLUS_EQUAL","+=",252],["T_WHITESPACE"," ",252],["T_ARRAY","array",252],"(",["T_WHITESPACE","\n        ",252],["T_CONSTANT_ENCAPSED_STRING","'desaturate'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_ARRAY","array",253],"(",["T_WHITESPACE","\n          ",253],["T_CONSTANT_ENCAPSED_STRING","'function'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'desaturate'",254],",",["T_WHITESPACE","\n          ",254],["T_CONSTANT_ENCAPSED_STRING","'arguments'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_ARRAY","array",255],"(",")",",",["T_WHITESPACE","\n          ",255],["T_CONSTANT_ENCAPSED_STRING","'height'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_LNUMBER","20",256],",",["T_WHITESPACE","\n          ",256],["T_CONSTANT_ENCAPSED_STRING","'width'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],["T_LNUMBER","40",257],",",["T_WHITESPACE","\n          ",257],["T_COMMENT","\/\/ Grayscale corners are a bit funky. Each of the corners are a shade of\n",258],["T_WHITESPACE","          ",259],["T_COMMENT","\/\/ gray. The values of these were determined simply by looking at the\n",259],["T_WHITESPACE","          ",260],["T_COMMENT","\/\/ final image to see what desaturated colors end up being.\n",260],["T_WHITESPACE","          ",261],["T_CONSTANT_ENCAPSED_STRING","'corners'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_ARRAY","array",261],"(",["T_WHITESPACE","\n            ",261],["T_STRING","array_fill",262],"(",["T_LNUMBER","0",262],",",["T_WHITESPACE"," ",262],["T_LNUMBER","3",262],",",["T_WHITESPACE"," ",262],["T_LNUMBER","76",262],")",["T_WHITESPACE"," ",262],"+",["T_WHITESPACE"," ",262],["T_ARRAY","array",262],"(",["T_LNUMBER","3",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_LNUMBER","0",262],")",",",["T_WHITESPACE","\n            ",262],["T_STRING","array_fill",263],"(",["T_LNUMBER","0",263],",",["T_WHITESPACE"," ",263],["T_LNUMBER","3",263],",",["T_WHITESPACE"," ",263],["T_LNUMBER","149",263],")",["T_WHITESPACE"," ",263],"+",["T_WHITESPACE"," ",263],["T_ARRAY","array",263],"(",["T_LNUMBER","3",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_LNUMBER","0",263],")",",",["T_WHITESPACE","\n            ",263],["T_STRING","array_fill",264],"(",["T_LNUMBER","0",264],",",["T_WHITESPACE"," ",264],["T_LNUMBER","3",264],",",["T_WHITESPACE"," ",264],["T_LNUMBER","29",264],")",["T_WHITESPACE"," ",264],"+",["T_WHITESPACE"," ",264],["T_ARRAY","array",264],"(",["T_LNUMBER","3",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_LNUMBER","0",264],")",",",["T_WHITESPACE","\n            ",264],["T_STRING","array_fill",265],"(",["T_LNUMBER","0",265],",",["T_WHITESPACE"," ",265],["T_LNUMBER","3",265],",",["T_WHITESPACE"," ",265],["T_LNUMBER","225",265],")",["T_WHITESPACE"," ",265],"+",["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",["T_LNUMBER","3",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_LNUMBER","127",265],")",["T_WHITESPACE","\n          ",265],")",",",["T_WHITESPACE","\n        ",266],")",",",["T_WHITESPACE","\n      ",267],")",";",["T_WHITESPACE","\n    ",268],"}",["T_WHITESPACE","\n\n    ",269],["T_COMMENT","\/\/ Prepare a directory for test file results.\n",271],["T_WHITESPACE","    ",272],["T_VARIABLE","$directory",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_STRING","Settings",272],["T_DOUBLE_COLON","::",272],["T_STRING","get",272],"(",["T_CONSTANT_ENCAPSED_STRING","'file_public_path'",272],")",["T_WHITESPACE"," ",272],".",["T_WHITESPACE"," ",272],["T_CONSTANT_ENCAPSED_STRING","'\/imagetest'",272],";",["T_WHITESPACE","\n    ",272],["T_STRING","file_prepare_directory",273],"(",["T_VARIABLE","$directory",273],",",["T_WHITESPACE"," ",273],["T_STRING","FILE_CREATE_DIRECTORY",273],")",";",["T_WHITESPACE","\n\n    ",273],["T_FOREACH","foreach",275],["T_WHITESPACE"," ",275],"(",["T_VARIABLE","$files",275],["T_WHITESPACE"," ",275],["T_AS","as",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$file",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n      ",275],["T_FOREACH","foreach",276],["T_WHITESPACE"," ",276],"(",["T_VARIABLE","$operations",276],["T_WHITESPACE"," ",276],["T_AS","as",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$op",276],["T_WHITESPACE"," ",276],["T_DOUBLE_ARROW","=>",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$values",276],")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n        ",276],["T_COMMENT","\/\/ Load up a fresh image.\n",277],["T_WHITESPACE","        ",278],["T_VARIABLE","$image",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","imageFactory",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","get",278],"(",["T_STRING","drupal_get_path",278],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",278],",",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",278],")",["T_WHITESPACE"," ",278],".",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'\/files\/'",278],["T_WHITESPACE"," ",278],".",["T_WHITESPACE"," ",278],["T_VARIABLE","$file",278],")",";",["T_WHITESPACE","\n        ",278],["T_VARIABLE","$toolkit",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$image",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getToolkit",279],"(",")",";",["T_WHITESPACE","\n        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(","!",["T_VARIABLE","$image",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","isValid",280],"(",")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n          ",280],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","fail",281],"(",["T_STRING","SafeMarkup",281],["T_DOUBLE_COLON","::",281],["T_STRING","format",281],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not load image %file.'",281],",",["T_WHITESPACE"," ",281],["T_ARRAY","array",281],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",281],["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$file",281],")",")",")",";",["T_WHITESPACE","\n          ",281],["T_CONTINUE","continue",282],["T_WHITESPACE"," ",282],["T_LNUMBER","2",282],";",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$image_original_type",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$image",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getToolkit",284],"(",")",["T_OBJECT_OPERATOR","->",284],["T_STRING","getType",284],"(",")",";",["T_WHITESPACE","\n\n        ",284],["T_COMMENT","\/\/ All images should be converted to truecolor when loaded.\n",286],["T_WHITESPACE","        ",287],["T_VARIABLE","$image_truecolor",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_STRING","imageistruecolor",287],"(",["T_VARIABLE","$toolkit",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getResource",287],"(",")",")",";",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","assertTrue",288],"(",["T_VARIABLE","$image_truecolor",288],",",["T_WHITESPACE"," ",288],["T_STRING","SafeMarkup",288],["T_DOUBLE_COLON","::",288],["T_STRING","format",288],"(",["T_CONSTANT_ENCAPSED_STRING","'Image %file after load is a truecolor image.'",288],",",["T_WHITESPACE"," ",288],["T_ARRAY","array",288],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",288],["T_WHITESPACE"," ",288],["T_DOUBLE_ARROW","=>",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$file",288],")",")",")",";",["T_WHITESPACE","\n\n        ",288],["T_COMMENT","\/\/ Store the original GD resource.\n",290],["T_WHITESPACE","        ",291],["T_VARIABLE","$old_res",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$toolkit",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getResource",291],"(",")",";",["T_WHITESPACE","\n\n        ",291],["T_COMMENT","\/\/ Perform our operation.\n",293],["T_WHITESPACE","        ",294],["T_VARIABLE","$image",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","apply",294],"(",["T_VARIABLE","$values",294],"[",["T_CONSTANT_ENCAPSED_STRING","'function'",294],"]",",",["T_WHITESPACE"," ",294],["T_VARIABLE","$values",294],"[",["T_CONSTANT_ENCAPSED_STRING","'arguments'",294],"]",")",";",["T_WHITESPACE","\n\n        ",294],["T_COMMENT","\/\/ If the operation replaced the resource, check that the old one has\n",296],["T_WHITESPACE","        ",297],["T_COMMENT","\/\/ been destroyed.\n",297],["T_WHITESPACE","        ",298],["T_VARIABLE","$new_res",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$toolkit",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getResource",298],"(",")",";",["T_WHITESPACE","\n        ",298],["T_IF","if",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$new_res",299],["T_WHITESPACE"," ",299],["T_IS_NOT_IDENTICAL","!==",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$old_res",299],")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n          ",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","assertFalse",300],"(",["T_STRING","is_resource",300],"(",["T_VARIABLE","$old_res",300],")",",",["T_WHITESPACE"," ",300],["T_STRING","SafeMarkup",300],["T_DOUBLE_COLON","::",300],["T_STRING","format",300],"(",["T_CONSTANT_ENCAPSED_STRING","\"'%operation' destroyed the original resource.\"",300],",",["T_WHITESPACE"," ",300],"[",["T_CONSTANT_ENCAPSED_STRING","'%operation'",300],["T_WHITESPACE"," ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$values",300],"[",["T_CONSTANT_ENCAPSED_STRING","'function'",300],"]","]",")",")",";",["T_WHITESPACE","\n        ",300],"}",["T_WHITESPACE","\n\n        ",301],["T_COMMENT","\/\/ To keep from flooding the test with assert values, make a general\n",303],["T_WHITESPACE","        ",304],["T_COMMENT","\/\/ value for whether each group of values fail.\n",304],["T_WHITESPACE","        ",305],["T_VARIABLE","$correct_dimensions_real",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_STRING","TRUE",305],";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$correct_dimensions_object",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_STRING","TRUE",306],";",["T_WHITESPACE","\n\n        ",306],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_STRING","imagesy",308],"(",["T_VARIABLE","$toolkit",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getResource",308],"(",")",")",["T_WHITESPACE"," ",308],["T_IS_NOT_EQUAL","!=",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$values",308],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",308],"]",["T_WHITESPACE"," ",308],["T_BOOLEAN_OR","||",308],["T_WHITESPACE"," ",308],["T_STRING","imagesx",308],"(",["T_VARIABLE","$toolkit",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getResource",308],"(",")",")",["T_WHITESPACE"," ",308],["T_IS_NOT_EQUAL","!=",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$values",308],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",308],"]",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n          ",308],["T_VARIABLE","$correct_dimensions_real",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_STRING","FALSE",309],";",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE","\n\n        ",310],["T_COMMENT","\/\/ Check that the image object has an accurate record of the dimensions.\n",312],["T_WHITESPACE","        ",313],["T_IF","if",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$image",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getWidth",313],"(",")",["T_WHITESPACE"," ",313],["T_IS_NOT_EQUAL","!=",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$values",313],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",313],"]",["T_WHITESPACE"," ",313],["T_BOOLEAN_OR","||",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$image",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getHeight",313],"(",")",["T_WHITESPACE"," ",313],["T_IS_NOT_EQUAL","!=",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$values",313],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",313],"]",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n          ",313],["T_VARIABLE","$correct_dimensions_object",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","FALSE",314],";",["T_WHITESPACE","\n        ",314],"}",["T_WHITESPACE","\n\n        ",315],["T_VARIABLE","$file_path",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_VARIABLE","$directory",317],["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'\/'",317],["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_VARIABLE","$op",317],["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_STRING","image_type_to_extension",317],"(",["T_VARIABLE","$image",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getToolkit",317],"(",")",["T_OBJECT_OPERATOR","->",317],["T_STRING","getType",317],"(",")",")",";",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$image",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","save",318],"(",["T_VARIABLE","$file_path",318],")",";",["T_WHITESPACE","\n\n        ",318],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","assertTrue",320],"(",["T_VARIABLE","$correct_dimensions_real",320],",",["T_WHITESPACE"," ",320],["T_STRING","SafeMarkup",320],["T_DOUBLE_COLON","::",320],["T_STRING","format",320],"(",["T_CONSTANT_ENCAPSED_STRING","'Image %file after %action action has proper dimensions.'",320],",",["T_WHITESPACE"," ",320],["T_ARRAY","array",320],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$file",320],",",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'%action'",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$op",320],")",")",")",";",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","assertTrue",321],"(",["T_VARIABLE","$correct_dimensions_object",321],",",["T_WHITESPACE"," ",321],["T_STRING","SafeMarkup",321],["T_DOUBLE_COLON","::",321],["T_STRING","format",321],"(",["T_CONSTANT_ENCAPSED_STRING","'Image %file object after %action action is reporting the proper height and width values.'",321],",",["T_WHITESPACE"," ",321],["T_ARRAY","array",321],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",321],["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$file",321],",",["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'%action'",321],["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$op",321],")",")",")",";",["T_WHITESPACE","\n\n        ",321],["T_COMMENT","\/\/ JPEG colors will always be messed up due to compression. So we skip\n",323],["T_WHITESPACE","        ",324],["T_COMMENT","\/\/ these tests if the original or the result is in jpeg format.\n",324],["T_WHITESPACE","        ",325],["T_IF","if",325],["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$image",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getToolkit",325],"(",")",["T_OBJECT_OPERATOR","->",325],["T_STRING","getType",325],"(",")",["T_WHITESPACE"," ",325],["T_IS_NOT_EQUAL","!=",325],["T_WHITESPACE"," ",325],["T_STRING","IMAGETYPE_JPEG",325],["T_WHITESPACE"," ",325],["T_BOOLEAN_AND","&&",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$image_original_type",325],["T_WHITESPACE"," ",325],["T_IS_NOT_EQUAL","!=",325],["T_WHITESPACE"," ",325],["T_STRING","IMAGETYPE_JPEG",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n          ",325],["T_COMMENT","\/\/ Now check each of the corners to ensure color correctness.\n",326],["T_WHITESPACE","          ",327],["T_FOREACH","foreach",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$values",327],"[",["T_CONSTANT_ENCAPSED_STRING","'corners'",327],"]",["T_WHITESPACE"," ",327],["T_AS","as",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$key",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$corner",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_COMMENT","\/\/ The test gif that does not have transparency color set is a\n",328],["T_WHITESPACE","            ",329],["T_COMMENT","\/\/ special case.\n",329],["T_WHITESPACE","            ",330],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$file",330],["T_WHITESPACE"," ",330],["T_IS_IDENTICAL","===",330],["T_WHITESPACE"," ",330],["T_CONSTANT_ENCAPSED_STRING","'image-test-no-transparency.gif'",330],")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n              ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(",["T_VARIABLE","$op",331],["T_WHITESPACE"," ",331],["T_IS_EQUAL","==",331],["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'desaturate'",331],")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n                ",331],["T_COMMENT","\/\/ For desaturating, keep the expected color from the test\n",332],["T_WHITESPACE","                ",333],["T_COMMENT","\/\/ data, but set alpha channel to fully opaque.\n",333],["T_WHITESPACE","                ",334],["T_VARIABLE","$corner",334],"[",["T_LNUMBER","3",334],"]",["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_LNUMBER","0",334],";",["T_WHITESPACE","\n              ",334],"}",["T_WHITESPACE","\n              ",335],["T_ELSEIF","elseif",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$corner",336],["T_WHITESPACE"," ",336],["T_IS_IDENTICAL","===",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","transparent",336],")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                ",336],["T_COMMENT","\/\/ Set expected pixel to yellow where the others have\n",337],["T_WHITESPACE","                ",338],["T_COMMENT","\/\/ transparent.\n",338],["T_WHITESPACE","                ",339],["T_VARIABLE","$corner",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","yellow",339],";",["T_WHITESPACE","\n              ",339],"}",["T_WHITESPACE","\n            ",340],"}",["T_WHITESPACE","\n\n            ",341],["T_COMMENT","\/\/ Get the location of the corner.\n",343],["T_WHITESPACE","            ",344],["T_SWITCH","switch",344],["T_WHITESPACE"," ",344],"(",["T_VARIABLE","$key",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n              ",344],["T_CASE","case",345],["T_WHITESPACE"," ",345],["T_LNUMBER","0",345],":",["T_WHITESPACE","\n                ",345],["T_VARIABLE","$x",346],["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_LNUMBER","0",346],";",["T_WHITESPACE","\n                ",346],["T_VARIABLE","$y",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_LNUMBER","0",347],";",["T_WHITESPACE","\n                ",347],["T_BREAK","break",348],";",["T_WHITESPACE","\n              ",348],["T_CASE","case",349],["T_WHITESPACE"," ",349],["T_LNUMBER","1",349],":",["T_WHITESPACE","\n                ",349],["T_VARIABLE","$x",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$image",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getWidth",350],"(",")",["T_WHITESPACE"," ",350],"-",["T_WHITESPACE"," ",350],["T_LNUMBER","1",350],";",["T_WHITESPACE","\n                ",350],["T_VARIABLE","$y",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_LNUMBER","0",351],";",["T_WHITESPACE","\n                ",351],["T_BREAK","break",352],";",["T_WHITESPACE","\n              ",352],["T_CASE","case",353],["T_WHITESPACE"," ",353],["T_LNUMBER","2",353],":",["T_WHITESPACE","\n                ",353],["T_VARIABLE","$x",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$image",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getWidth",354],"(",")",["T_WHITESPACE"," ",354],"-",["T_WHITESPACE"," ",354],["T_LNUMBER","1",354],";",["T_WHITESPACE","\n                ",354],["T_VARIABLE","$y",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$image",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getHeight",355],"(",")",["T_WHITESPACE"," ",355],"-",["T_WHITESPACE"," ",355],["T_LNUMBER","1",355],";",["T_WHITESPACE","\n                ",355],["T_BREAK","break",356],";",["T_WHITESPACE","\n              ",356],["T_CASE","case",357],["T_WHITESPACE"," ",357],["T_LNUMBER","3",357],":",["T_WHITESPACE","\n                ",357],["T_VARIABLE","$x",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_LNUMBER","0",358],";",["T_WHITESPACE","\n                ",358],["T_VARIABLE","$y",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$image",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getHeight",359],"(",")",["T_WHITESPACE"," ",359],"-",["T_WHITESPACE"," ",359],["T_LNUMBER","1",359],";",["T_WHITESPACE","\n                ",359],["T_BREAK","break",360],";",["T_WHITESPACE","\n            ",360],"}",["T_WHITESPACE","\n            ",361],["T_VARIABLE","$color",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getPixelColor",362],"(",["T_VARIABLE","$image",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$x",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$y",362],")",";",["T_WHITESPACE","\n            ",362],["T_COMMENT","\/\/ We also skip the color test for transparency for gif <-> png\n",363],["T_WHITESPACE","            ",364],["T_COMMENT","\/\/ conversion. The convert operation cannot handle that correctly.\n",364],["T_WHITESPACE","            ",365],["T_IF","if",365],["T_WHITESPACE"," ",365],"(",["T_VARIABLE","$image",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getToolkit",365],"(",")",["T_OBJECT_OPERATOR","->",365],["T_STRING","getType",365],"(",")",["T_WHITESPACE"," ",365],["T_IS_EQUAL","==",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$image_original_type",365],["T_WHITESPACE"," ",365],["T_BOOLEAN_OR","||",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$corner",365],["T_WHITESPACE"," ",365],["T_IS_NOT_EQUAL","!=",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","transparent",365],")",["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n              ",365],["T_VARIABLE","$correct_colors",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","colorsAreEqual",366],"(",["T_VARIABLE","$color",366],",",["T_WHITESPACE"," ",366],["T_VARIABLE","$corner",366],")",";",["T_WHITESPACE","\n              ",366],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","assertTrue",367],"(",["T_VARIABLE","$correct_colors",367],",",["T_WHITESPACE"," ",367],["T_STRING","SafeMarkup",367],["T_DOUBLE_COLON","::",367],["T_STRING","format",367],"(",["T_CONSTANT_ENCAPSED_STRING","'Image %file object after %action action has the correct color placement at corner %corner.'",367],",",["T_WHITESPACE","\n                ",367],["T_ARRAY","array",368],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",368],["T_WHITESPACE","   ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$file",368],",",["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'%action'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$op",368],",",["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'%corner'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$key",368],")",")",")",";",["T_WHITESPACE","\n            ",368],"}",["T_WHITESPACE","\n          ",369],"}",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n\n        ",371],["T_COMMENT","\/\/ Check that saved image reloads without raising PHP errors.\n",373],["T_WHITESPACE","        ",374],["T_VARIABLE","$image_reloaded",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","imageFactory",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","get",374],"(",["T_VARIABLE","$file_path",374],")",";",["T_WHITESPACE","\n        ",374],["T_VARIABLE","$resource",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$image_reloaded",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getToolkit",375],"(",")",["T_OBJECT_OPERATOR","->",375],["T_STRING","getResource",375],"(",")",";",["T_WHITESPACE","\n      ",375],"}",["T_WHITESPACE","\n    ",376],"}",["T_WHITESPACE","\n\n    ",377],["T_COMMENT","\/\/ Test creation of image from scratch, and saving to storage.\n",379],["T_WHITESPACE","    ",380],["T_FOREACH","foreach",380],["T_WHITESPACE"," ",380],"(",["T_ARRAY","array",380],"(",["T_STRING","IMAGETYPE_PNG",380],",",["T_WHITESPACE"," ",380],["T_STRING","IMAGETYPE_GIF",380],",",["T_WHITESPACE"," ",380],["T_STRING","IMAGETYPE_JPEG",380],")",["T_WHITESPACE"," ",380],["T_AS","as",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$type",380],")",["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n      ",380],["T_VARIABLE","$image",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","imageFactory",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","get",381],"(",")",";",["T_WHITESPACE","\n      ",381],["T_VARIABLE","$image",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","createNew",382],"(",["T_LNUMBER","50",382],",",["T_WHITESPACE"," ",382],["T_LNUMBER","20",382],",",["T_WHITESPACE"," ",382],["T_STRING","image_type_to_extension",382],"(",["T_VARIABLE","$type",382],",",["T_WHITESPACE"," ",382],["T_STRING","FALSE",382],")",",",["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'#ffff00'",382],")",";",["T_WHITESPACE","\n      ",382],["T_VARIABLE","$file",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_CONSTANT_ENCAPSED_STRING","'from_null'",383],["T_WHITESPACE"," ",383],".",["T_WHITESPACE"," ",383],["T_STRING","image_type_to_extension",383],"(",["T_VARIABLE","$type",383],")",";",["T_WHITESPACE","\n      ",383],["T_VARIABLE","$file_path",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$directory",384],["T_WHITESPACE"," ",384],".",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'\/'",384],["T_WHITESPACE"," ",384],".",["T_WHITESPACE"," ",384],["T_VARIABLE","$file",384],["T_WHITESPACE"," ",384],";",["T_WHITESPACE","\n      ",384],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","assertEqual",385],"(",["T_LNUMBER","50",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$image",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","getWidth",385],"(",")",",",["T_WHITESPACE"," ",385],["T_STRING","SafeMarkup",385],["T_DOUBLE_COLON","::",385],["T_STRING","format",385],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct width.'",385],",",["T_WHITESPACE"," ",385],["T_ARRAY","array",385],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$file",385],")",")",")",";",["T_WHITESPACE","\n      ",385],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","assertEqual",386],"(",["T_LNUMBER","20",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$image",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getHeight",386],"(",")",",",["T_WHITESPACE"," ",386],["T_STRING","SafeMarkup",386],["T_DOUBLE_COLON","::",386],["T_STRING","format",386],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct height.'",386],",",["T_WHITESPACE"," ",386],["T_ARRAY","array",386],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$file",386],")",")",")",";",["T_WHITESPACE","\n      ",386],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","assertEqual",387],"(",["T_STRING","image_type_to_mime_type",387],"(",["T_VARIABLE","$type",387],")",",",["T_WHITESPACE"," ",387],["T_VARIABLE","$image",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getMimeType",387],"(",")",",",["T_WHITESPACE"," ",387],["T_STRING","SafeMarkup",387],["T_DOUBLE_COLON","::",387],["T_STRING","format",387],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct MIME type.'",387],",",["T_WHITESPACE"," ",387],["T_ARRAY","array",387],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$file",387],")",")",")",";",["T_WHITESPACE","\n      ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","assertTrue",388],"(",["T_VARIABLE","$image",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","save",388],"(",["T_VARIABLE","$file_path",388],")",",",["T_WHITESPACE"," ",388],["T_STRING","SafeMarkup",388],["T_DOUBLE_COLON","::",388],["T_STRING","format",388],"(",["T_CONSTANT_ENCAPSED_STRING","'Image %file created anew from a null image was saved.'",388],",",["T_WHITESPACE"," ",388],["T_ARRAY","array",388],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$file",388],")",")",")",";",["T_WHITESPACE","\n\n      ",388],["T_COMMENT","\/\/ Reload saved image.\n",390],["T_WHITESPACE","      ",391],["T_VARIABLE","$image_reloaded",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","imageFactory",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","get",391],"(",["T_VARIABLE","$file_path",391],")",";",["T_WHITESPACE","\n      ",391],["T_IF","if",392],["T_WHITESPACE"," ",392],"(","!",["T_VARIABLE","$image_reloaded",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","isValid",392],"(",")",")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n        ",392],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","fail",393],"(",["T_STRING","SafeMarkup",393],["T_DOUBLE_COLON","::",393],["T_STRING","format",393],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not load image %file.'",393],",",["T_WHITESPACE"," ",393],["T_ARRAY","array",393],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$file",393],")",")",")",";",["T_WHITESPACE","\n        ",393],["T_CONTINUE","continue",394],";",["T_WHITESPACE","\n      ",394],"}",["T_WHITESPACE","\n      ",395],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","assertEqual",396],"(",["T_LNUMBER","50",396],",",["T_WHITESPACE"," ",396],["T_VARIABLE","$image_reloaded",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getWidth",396],"(",")",",",["T_WHITESPACE"," ",396],["T_STRING","SafeMarkup",396],["T_DOUBLE_COLON","::",396],["T_STRING","format",396],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct width.'",396],",",["T_WHITESPACE"," ",396],["T_ARRAY","array",396],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$file",396],")",")",")",";",["T_WHITESPACE","\n      ",396],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","assertEqual",397],"(",["T_LNUMBER","20",397],",",["T_WHITESPACE"," ",397],["T_VARIABLE","$image_reloaded",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getHeight",397],"(",")",",",["T_WHITESPACE"," ",397],["T_STRING","SafeMarkup",397],["T_DOUBLE_COLON","::",397],["T_STRING","format",397],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct height.'",397],",",["T_WHITESPACE"," ",397],["T_ARRAY","array",397],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",397],["T_WHITESPACE"," ",397],["T_DOUBLE_ARROW","=>",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$file",397],")",")",")",";",["T_WHITESPACE","\n      ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","assertEqual",398],"(",["T_STRING","image_type_to_mime_type",398],"(",["T_VARIABLE","$type",398],")",",",["T_WHITESPACE"," ",398],["T_VARIABLE","$image_reloaded",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getMimeType",398],"(",")",",",["T_WHITESPACE"," ",398],["T_STRING","SafeMarkup",398],["T_DOUBLE_COLON","::",398],["T_STRING","format",398],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct MIME type.'",398],",",["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$file",398],")",")",")",";",["T_WHITESPACE","\n      ",398],["T_IF","if",399],["T_WHITESPACE"," ",399],"(",["T_VARIABLE","$image_reloaded",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","getToolkit",399],"(",")",["T_OBJECT_OPERATOR","->",399],["T_STRING","getType",399],"(",")",["T_WHITESPACE"," ",399],["T_IS_EQUAL","==",399],["T_WHITESPACE"," ",399],["T_STRING","IMAGETYPE_GIF",399],")",["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n        ",399],["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","assertEqual",400],"(",["T_CONSTANT_ENCAPSED_STRING","'#ffff00'",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$image_reloaded",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","getToolkit",400],"(",")",["T_OBJECT_OPERATOR","->",400],["T_STRING","getTransparentColor",400],"(",")",",",["T_WHITESPACE"," ",400],["T_STRING","SafeMarkup",400],["T_DOUBLE_COLON","::",400],["T_STRING","format",400],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has the correct transparent color channel set.'",400],",",["T_WHITESPACE"," ",400],["T_ARRAY","array",400],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",400],["T_WHITESPACE"," ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$file",400],")",")",")",";",["T_WHITESPACE","\n      ",400],"}",["T_WHITESPACE","\n      ",401],["T_ELSE","else",402],["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","assertEqual",403],"(",["T_STRING","NULL",403],",",["T_WHITESPACE"," ",403],["T_VARIABLE","$image_reloaded",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","getToolkit",403],"(",")",["T_OBJECT_OPERATOR","->",403],["T_STRING","getTransparentColor",403],"(",")",",",["T_WHITESPACE"," ",403],["T_STRING","SafeMarkup",403],["T_DOUBLE_COLON","::",403],["T_STRING","format",403],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file %file has no color channel set.'",403],",",["T_WHITESPACE"," ",403],["T_ARRAY","array",403],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",403],["T_WHITESPACE"," ",403],["T_DOUBLE_ARROW","=>",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$file",403],")",")",")",";",["T_WHITESPACE","\n      ",403],"}",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_COMMENT","\/\/ Test failures of the 'create_new' operation.\n",407],["T_WHITESPACE","    ",408],["T_VARIABLE","$image",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","imageFactory",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","get",408],"(",")",";",["T_WHITESPACE","\n    ",408],["T_VARIABLE","$image",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","createNew",409],"(","-",["T_LNUMBER","50",409],",",["T_WHITESPACE"," ",409],["T_LNUMBER","20",409],")",";",["T_WHITESPACE","\n    ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","assertFalse",410],"(",["T_VARIABLE","$image",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","isValid",410],"(",")",",",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","'CreateNew with negative width fails.'",410],")",";",["T_WHITESPACE","\n    ",410],["T_VARIABLE","$image",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","createNew",411],"(",["T_LNUMBER","50",411],",",["T_WHITESPACE"," ",411],["T_LNUMBER","20",411],",",["T_WHITESPACE"," ",411],["T_CONSTANT_ENCAPSED_STRING","'foo'",411],")",";",["T_WHITESPACE","\n    ",411],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","assertFalse",412],"(",["T_VARIABLE","$image",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","isValid",412],"(",")",",",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","'CreateNew with invalid extension fails.'",412],")",";",["T_WHITESPACE","\n    ",412],["T_VARIABLE","$image",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","createNew",413],"(",["T_LNUMBER","50",413],",",["T_WHITESPACE"," ",413],["T_LNUMBER","20",413],",",["T_WHITESPACE"," ",413],["T_CONSTANT_ENCAPSED_STRING","'gif'",413],",",["T_WHITESPACE"," ",413],["T_CONSTANT_ENCAPSED_STRING","'#foo'",413],")",";",["T_WHITESPACE","\n    ",413],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","assertFalse",414],"(",["T_VARIABLE","$image",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","isValid",414],"(",")",",",["T_WHITESPACE"," ",414],["T_CONSTANT_ENCAPSED_STRING","'CreateNew with invalid color hex string fails.'",414],")",";",["T_WHITESPACE","\n    ",414],["T_VARIABLE","$image",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","createNew",415],"(",["T_LNUMBER","50",415],",",["T_WHITESPACE"," ",415],["T_LNUMBER","20",415],",",["T_WHITESPACE"," ",415],["T_CONSTANT_ENCAPSED_STRING","'gif'",415],",",["T_WHITESPACE"," ",415],["T_CONSTANT_ENCAPSED_STRING","'#ff0000'",415],")",";",["T_WHITESPACE","\n    ",415],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","assertTrue",416],"(",["T_VARIABLE","$image",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","isValid",416],"(",")",",",["T_WHITESPACE"," ",416],["T_CONSTANT_ENCAPSED_STRING","'CreateNew with valid arguments validates the Image.'",416],")",";",["T_WHITESPACE","\n  ",416],"}",["T_WHITESPACE","\n\n  ",417],["T_DOC_COMMENT","\/**\n   * Tests that GD resources are freed from memory.\n   *\/",419],["T_WHITESPACE","\n  ",421],["T_PUBLIC","public",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","testResourceDestruction",422],"(",")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n    ",422],["T_COMMENT","\/\/ Test that an Image object going out of scope releases its GD resource.\n",423],["T_WHITESPACE","    ",424],["T_VARIABLE","$image",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","imageFactory",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","get",424],"(",["T_STRING","drupal_get_path",424],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",424],",",["T_WHITESPACE"," ",424],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",424],")",["T_WHITESPACE"," ",424],".",["T_WHITESPACE"," ",424],["T_CONSTANT_ENCAPSED_STRING","'\/files\/image-test.png'",424],")",";",["T_WHITESPACE","\n    ",424],["T_VARIABLE","$res",425],["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$image",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getToolkit",425],"(",")",["T_OBJECT_OPERATOR","->",425],["T_STRING","getResource",425],"(",")",";",["T_WHITESPACE","\n    ",425],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","assertTrue",426],"(",["T_STRING","is_resource",426],"(",["T_VARIABLE","$res",426],")",",",["T_WHITESPACE"," ",426],["T_CONSTANT_ENCAPSED_STRING","'Successfully loaded image resource.'",426],")",";",["T_WHITESPACE","\n    ",426],["T_VARIABLE","$image",427],["T_WHITESPACE"," ",427],"=",["T_WHITESPACE"," ",427],["T_STRING","NULL",427],";",["T_WHITESPACE","\n    ",427],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","assertFalse",428],"(",["T_STRING","is_resource",428],"(",["T_VARIABLE","$res",428],")",",",["T_WHITESPACE"," ",428],["T_CONSTANT_ENCAPSED_STRING","'Image resource was destroyed after losing scope.'",428],")",";",["T_WHITESPACE","\n\n    ",428],["T_COMMENT","\/\/ Test that 'create_new' operation does not leave orphaned GD resources.\n",430],["T_WHITESPACE","    ",431],["T_VARIABLE","$image",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","imageFactory",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","get",431],"(",["T_STRING","drupal_get_path",431],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",431],",",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",431],")",["T_WHITESPACE"," ",431],".",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'\/files\/image-test.png'",431],")",";",["T_WHITESPACE","\n    ",431],["T_VARIABLE","$old_res",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$image",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getToolkit",432],"(",")",["T_OBJECT_OPERATOR","->",432],["T_STRING","getResource",432],"(",")",";",["T_WHITESPACE","\n    ",432],["T_COMMENT","\/\/ Check if resource has been created successfully.\n",433],["T_WHITESPACE","    ",434],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","assertTrue",434],"(",["T_STRING","is_resource",434],"(",["T_VARIABLE","$old_res",434],")",")",";",["T_WHITESPACE","\n    ",434],["T_VARIABLE","$image",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","createNew",435],"(",["T_LNUMBER","20",435],",",["T_WHITESPACE"," ",435],["T_LNUMBER","20",435],")",";",["T_WHITESPACE","\n    ",435],["T_VARIABLE","$new_res",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$image",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","getToolkit",436],"(",")",["T_OBJECT_OPERATOR","->",436],["T_STRING","getResource",436],"(",")",";",["T_WHITESPACE","\n    ",436],["T_COMMENT","\/\/ Check if the original resource has been destroyed.\n",437],["T_WHITESPACE","    ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","assertFalse",438],"(",["T_STRING","is_resource",438],"(",["T_VARIABLE","$old_res",438],")",")",";",["T_WHITESPACE","\n    ",438],["T_COMMENT","\/\/ Check if a new resource has been created successfully.\n",439],["T_WHITESPACE","    ",440],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","assertTrue",440],"(",["T_STRING","is_resource",440],"(",["T_VARIABLE","$new_res",440],")",")",";",["T_WHITESPACE","\n  ",440],"}",["T_WHITESPACE","\n\n  ",441],["T_DOC_COMMENT","\/**\n   * Tests for GIF images with transparency.\n   *\/",443],["T_WHITESPACE","\n  ",445],["T_FUNCTION","function",446],["T_WHITESPACE"," ",446],["T_STRING","testGifTransparentImages",446],"(",")",["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n    ",446],["T_COMMENT","\/\/ Prepare a directory for test file results.\n",447],["T_WHITESPACE","    ",448],["T_VARIABLE","$directory",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_STRING","Settings",448],["T_DOUBLE_COLON","::",448],["T_STRING","get",448],"(",["T_CONSTANT_ENCAPSED_STRING","'file_public_path'",448],")",["T_WHITESPACE"," ",448],".",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'\/imagetest'",448],";",["T_WHITESPACE","\n    ",448],["T_STRING","file_prepare_directory",449],"(",["T_VARIABLE","$directory",449],",",["T_WHITESPACE"," ",449],["T_STRING","FILE_CREATE_DIRECTORY",449],")",";",["T_WHITESPACE","\n\n    ",449],["T_COMMENT","\/\/ Test loading an indexed GIF image with transparent color set.\n",451],["T_WHITESPACE","    ",452],["T_COMMENT","\/\/ Color at top-right pixel should be fully transparent.\n",452],["T_WHITESPACE","    ",453],["T_VARIABLE","$file",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","'image-test-transparent-indexed.gif'",453],";",["T_WHITESPACE","\n    ",453],["T_VARIABLE","$image",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","imageFactory",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","get",454],"(",["T_STRING","drupal_get_path",454],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",454],",",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",454],")",["T_WHITESPACE"," ",454],".",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'\/files\/'",454],["T_WHITESPACE"," ",454],".",["T_WHITESPACE"," ",454],["T_VARIABLE","$file",454],")",";",["T_WHITESPACE","\n    ",454],["T_VARIABLE","$resource",455],["T_WHITESPACE"," ",455],"=",["T_WHITESPACE"," ",455],["T_VARIABLE","$image",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getToolkit",455],"(",")",["T_OBJECT_OPERATOR","->",455],["T_STRING","getResource",455],"(",")",";",["T_WHITESPACE","\n    ",455],["T_VARIABLE","$color_index",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_STRING","imagecolorat",456],"(",["T_VARIABLE","$resource",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$image",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","getWidth",456],"(",")",["T_WHITESPACE"," ",456],"-",["T_WHITESPACE"," ",456],["T_LNUMBER","1",456],",",["T_WHITESPACE"," ",456],["T_LNUMBER","0",456],")",";",["T_WHITESPACE","\n    ",456],["T_VARIABLE","$color",457],["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_STRING","array_values",457],"(",["T_STRING","imagecolorsforindex",457],"(",["T_VARIABLE","$resource",457],",",["T_WHITESPACE"," ",457],["T_VARIABLE","$color_index",457],")",")",";",["T_WHITESPACE","\n    ",457],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","assertEqual",458],"(",["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","rotateTransparent",458],",",["T_WHITESPACE"," ",458],["T_VARIABLE","$color",458],",",["T_WHITESPACE"," ",458],"\"",["T_ENCAPSED_AND_WHITESPACE","Image ",458],["T_CURLY_OPEN","{",458],["T_VARIABLE","$file",458],"}",["T_ENCAPSED_AND_WHITESPACE"," after load has full transparent color at corner 1.",458],"\"",")",";",["T_WHITESPACE","\n\n    ",458],["T_COMMENT","\/\/ Test deliberately creating a GIF image with no transparent color set.\n",460],["T_WHITESPACE","    ",461],["T_COMMENT","\/\/ Color at top-right pixel should be fully transparent while in memory,\n",461],["T_WHITESPACE","    ",462],["T_COMMENT","\/\/ fully opaque after flushing image to file.\n",462],["T_WHITESPACE","    ",463],["T_VARIABLE","$file",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_CONSTANT_ENCAPSED_STRING","'image-test-no-transparent-color-set.gif'",463],";",["T_WHITESPACE","\n    ",463],["T_VARIABLE","$file_path",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_VARIABLE","$directory",464],["T_WHITESPACE"," ",464],".",["T_WHITESPACE"," ",464],["T_CONSTANT_ENCAPSED_STRING","'\/'",464],["T_WHITESPACE"," ",464],".",["T_WHITESPACE"," ",464],["T_VARIABLE","$file",464],["T_WHITESPACE"," ",464],";",["T_WHITESPACE","\n    ",464],["T_COMMENT","\/\/ Create image.\n",465],["T_WHITESPACE","    ",466],["T_VARIABLE","$image",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","imageFactory",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","get",466],"(",")",";",["T_WHITESPACE","\n    ",466],["T_VARIABLE","$image",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","createNew",467],"(",["T_LNUMBER","50",467],",",["T_WHITESPACE"," ",467],["T_LNUMBER","20",467],",",["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","'gif'",467],",",["T_WHITESPACE"," ",467],["T_STRING","NULL",467],")",";",["T_WHITESPACE","\n    ",467],["T_VARIABLE","$resource",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_VARIABLE","$image",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","getToolkit",468],"(",")",["T_OBJECT_OPERATOR","->",468],["T_STRING","getResource",468],"(",")",";",["T_WHITESPACE","\n    ",468],["T_VARIABLE","$color_index",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_STRING","imagecolorat",469],"(",["T_VARIABLE","$resource",469],",",["T_WHITESPACE"," ",469],["T_VARIABLE","$image",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getWidth",469],"(",")",["T_WHITESPACE"," ",469],"-",["T_WHITESPACE"," ",469],["T_LNUMBER","1",469],",",["T_WHITESPACE"," ",469],["T_LNUMBER","0",469],")",";",["T_WHITESPACE","\n    ",469],["T_VARIABLE","$color",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_STRING","array_values",470],"(",["T_STRING","imagecolorsforindex",470],"(",["T_VARIABLE","$resource",470],",",["T_WHITESPACE"," ",470],["T_VARIABLE","$color_index",470],")",")",";",["T_WHITESPACE","\n    ",470],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","assertEqual",471],"(",["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","rotateTransparent",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$color",471],",",["T_WHITESPACE"," ",471],["T_CONSTANT_ENCAPSED_STRING","\"New GIF image with no transparent color set after creation has full transparent color at corner 1.\"",471],")",";",["T_WHITESPACE","\n    ",471],["T_COMMENT","\/\/ Save image.\n",472],["T_WHITESPACE","    ",473],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","assertTrue",473],"(",["T_VARIABLE","$image",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","save",473],"(",["T_VARIABLE","$file_path",473],")",",",["T_WHITESPACE"," ",473],"\"",["T_ENCAPSED_AND_WHITESPACE","New GIF image ",473],["T_CURLY_OPEN","{",473],["T_VARIABLE","$file",473],"}",["T_ENCAPSED_AND_WHITESPACE"," was saved.",473],"\"",")",";",["T_WHITESPACE","\n    ",473],["T_COMMENT","\/\/ Reload image.\n",474],["T_WHITESPACE","    ",475],["T_VARIABLE","$image_reloaded",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_VARIABLE","$this",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","imageFactory",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","get",475],"(",["T_VARIABLE","$file_path",475],")",";",["T_WHITESPACE","\n    ",475],["T_VARIABLE","$resource",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_VARIABLE","$image_reloaded",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getToolkit",476],"(",")",["T_OBJECT_OPERATOR","->",476],["T_STRING","getResource",476],"(",")",";",["T_WHITESPACE","\n    ",476],["T_VARIABLE","$color_index",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_STRING","imagecolorat",477],"(",["T_VARIABLE","$resource",477],",",["T_WHITESPACE"," ",477],["T_VARIABLE","$image_reloaded",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","getWidth",477],"(",")",["T_WHITESPACE"," ",477],"-",["T_WHITESPACE"," ",477],["T_LNUMBER","1",477],",",["T_WHITESPACE"," ",477],["T_LNUMBER","0",477],")",";",["T_WHITESPACE","\n    ",477],["T_VARIABLE","$color",478],["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],["T_STRING","array_values",478],"(",["T_STRING","imagecolorsforindex",478],"(",["T_VARIABLE","$resource",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$color_index",478],")",")",";",["T_WHITESPACE","\n    ",478],["T_COMMENT","\/\/ Check explicitly for alpha == 0 as the rest of the color has been\n",479],["T_WHITESPACE","    ",480],["T_COMMENT","\/\/ compressed and may have slight difference from full white.\n",480],["T_WHITESPACE","    ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","assertEqual",481],"(",["T_LNUMBER","0",481],",",["T_WHITESPACE"," ",481],["T_VARIABLE","$color",481],"[",["T_LNUMBER","3",481],"]",",",["T_WHITESPACE"," ",481],"\"",["T_ENCAPSED_AND_WHITESPACE","New GIF image ",481],["T_CURLY_OPEN","{",481],["T_VARIABLE","$file",481],"}",["T_ENCAPSED_AND_WHITESPACE"," after reload has no transparent color at corner 1.",481],"\"",")",";",["T_WHITESPACE","\n\n    ",481],["T_COMMENT","\/\/ Test loading an image whose transparent color index is out of range.\n",483],["T_WHITESPACE","    ",484],["T_COMMENT","\/\/ This image was generated by taking an initial image with a palette size\n",484],["T_WHITESPACE","    ",485],["T_COMMENT","\/\/ of 6 colors, and setting the transparent color index to 6 (one higher\n",485],["T_WHITESPACE","    ",486],["T_COMMENT","\/\/ than the largest allowed index), as follows:\n",486],["T_WHITESPACE","    ",487],["T_COMMENT","\/\/ @code\n",487],["T_WHITESPACE","    ",488],["T_COMMENT","\/\/ $image = imagecreatefromgif('core\/modules\/simpletest\/files\/image-test.gif');\n",488],["T_WHITESPACE","    ",489],["T_COMMENT","\/\/ imagecolortransparent($image, 6);\n",489],["T_WHITESPACE","    ",490],["T_COMMENT","\/\/ imagegif($image, 'core\/modules\/simpletest\/files\/image-test-transparent-out-of-range.gif');\n",490],["T_WHITESPACE","    ",491],["T_COMMENT","\/\/ @endcode\n",491],["T_WHITESPACE","    ",492],["T_COMMENT","\/\/ This allows us to test that an image with an out-of-range color index\n",492],["T_WHITESPACE","    ",493],["T_COMMENT","\/\/ can be loaded correctly.\n",493],["T_WHITESPACE","    ",494],["T_VARIABLE","$file",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_CONSTANT_ENCAPSED_STRING","'image-test-transparent-out-of-range.gif'",494],";",["T_WHITESPACE","\n    ",494],["T_VARIABLE","$image",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","imageFactory",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","get",495],"(",["T_STRING","drupal_get_path",495],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",495],",",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",495],")",["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'\/files\/'",495],["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_VARIABLE","$file",495],")",";",["T_WHITESPACE","\n    ",495],["T_VARIABLE","$toolkit",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$image",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","getToolkit",496],"(",")",";",["T_WHITESPACE","\n\n    ",496],["T_IF","if",498],["T_WHITESPACE"," ",498],"(","!",["T_VARIABLE","$image",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","isValid",498],"(",")",")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n      ",498],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","fail",499],"(",["T_STRING","SafeMarkup",499],["T_DOUBLE_COLON","::",499],["T_STRING","format",499],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not load image %file.'",499],",",["T_WHITESPACE"," ",499],["T_ARRAY","array",499],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",499],["T_WHITESPACE"," ",499],["T_DOUBLE_ARROW","=>",499],["T_WHITESPACE"," ",499],["T_VARIABLE","$file",499],")",")",")",";",["T_WHITESPACE","\n    ",499],"}",["T_WHITESPACE","\n    ",500],["T_ELSE","else",501],["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n      ",501],["T_COMMENT","\/\/ All images should be converted to truecolor when loaded.\n",502],["T_WHITESPACE","      ",503],["T_VARIABLE","$image_truecolor",503],["T_WHITESPACE"," ",503],"=",["T_WHITESPACE"," ",503],["T_STRING","imageistruecolor",503],"(",["T_VARIABLE","$toolkit",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","getResource",503],"(",")",")",";",["T_WHITESPACE","\n      ",503],["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","assertTrue",504],"(",["T_VARIABLE","$image_truecolor",504],",",["T_WHITESPACE"," ",504],["T_STRING","SafeMarkup",504],["T_DOUBLE_COLON","::",504],["T_STRING","format",504],"(",["T_CONSTANT_ENCAPSED_STRING","'Image %file after load is a truecolor image.'",504],",",["T_WHITESPACE"," ",504],["T_ARRAY","array",504],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",504],["T_WHITESPACE"," ",504],["T_DOUBLE_ARROW","=>",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$file",504],")",")",")",";",["T_WHITESPACE","\n    ",504],"}",["T_WHITESPACE","\n  ",505],"}",["T_WHITESPACE","\n\n  ",506],["T_DOC_COMMENT","\/**\n   * Tests calling a missing image operation plugin.\n   *\/",508],["T_WHITESPACE","\n  ",510],["T_FUNCTION","function",511],["T_WHITESPACE"," ",511],["T_STRING","testMissingOperation",511],"(",")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n\n    ",511],["T_COMMENT","\/\/ Test that the image factory is set to use the GD toolkit.\n",513],["T_WHITESPACE","    ",514],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","assertEqual",514],"(",["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","imageFactory",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","getToolkitId",514],"(",")",",",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","'gd'",514],",",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","'The image factory is set to use the \\'gd\\' image toolkit.'",514],")",";",["T_WHITESPACE","\n\n    ",514],["T_COMMENT","\/\/ An image file that will be tested.\n",516],["T_WHITESPACE","    ",517],["T_VARIABLE","$file",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],["T_CONSTANT_ENCAPSED_STRING","'image-test.png'",517],";",["T_WHITESPACE","\n\n    ",517],["T_COMMENT","\/\/ Load up a fresh image.\n",519],["T_WHITESPACE","    ",520],["T_VARIABLE","$image",520],["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","imageFactory",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","get",520],"(",["T_STRING","drupal_get_path",520],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",520],",",["T_WHITESPACE"," ",520],["T_CONSTANT_ENCAPSED_STRING","'simpletest'",520],")",["T_WHITESPACE"," ",520],".",["T_WHITESPACE"," ",520],["T_CONSTANT_ENCAPSED_STRING","'\/files\/'",520],["T_WHITESPACE"," ",520],".",["T_WHITESPACE"," ",520],["T_VARIABLE","$file",520],")",";",["T_WHITESPACE","\n    ",520],["T_IF","if",521],["T_WHITESPACE"," ",521],"(","!",["T_VARIABLE","$image",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","isValid",521],"(",")",")",["T_WHITESPACE"," ",521],"{",["T_WHITESPACE","\n      ",521],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","fail",522],"(",["T_STRING","SafeMarkup",522],["T_DOUBLE_COLON","::",522],["T_STRING","format",522],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not load image %file.'",522],",",["T_WHITESPACE"," ",522],["T_ARRAY","array",522],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",522],["T_WHITESPACE"," ",522],["T_DOUBLE_ARROW","=>",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$file",522],")",")",")",";",["T_WHITESPACE","\n    ",522],"}",["T_WHITESPACE","\n\n    ",523],["T_COMMENT","\/\/ Try perform a missing toolkit operation.\n",525],["T_WHITESPACE","    ",526],["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","assertFalse",526],"(",["T_VARIABLE","$image",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","apply",526],"(",["T_CONSTANT_ENCAPSED_STRING","'missing_op'",526],",",["T_WHITESPACE"," ",526],["T_ARRAY","array",526],"(",")",")",",",["T_WHITESPACE"," ",526],["T_CONSTANT_ENCAPSED_STRING","'Calling a missing image toolkit operation plugin fails.'",526],")",";",["T_WHITESPACE","\n  ",526],"}",["T_WHITESPACE","\n\n",527],"}",["T_WHITESPACE","\n",529]]