[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Database",6],["T_NS_SEPARATOR","\\",6],["T_STRING","SchemaException",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Database",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SchemaObjectDoesNotExistException",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Database",8],["T_NS_SEPARATOR","\\",8],["T_STRING","SchemaObjectExistsException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","KernelTests",9],["T_NS_SEPARATOR","\\",9],["T_STRING","KernelTestBase",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Component",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Utility",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Unicode",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Tests table creation and modification via the schema API.\n *\n * @group Database\n *\/",12],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","SchemaTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_STRING","KernelTestBase",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * A global counter for table and field creation.\n   *\/",19],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$counter",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * Tests database interactions.\n   *\/",24],["T_WHITESPACE","\n  ",26],["T_FUNCTION","function",27],["T_WHITESPACE"," ",27],["T_STRING","testSchema",27],"(",")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n    ",27],["T_COMMENT","\/\/ Try creating a table.\n",28],["T_WHITESPACE","    ",29],["T_VARIABLE","$table_specification",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_WHITESPACE","\n      ",29],["T_CONSTANT_ENCAPSED_STRING","'description'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'Schema table description may contain \"quotes\" and could be long\u00e2\u0080\u0094very long indeed.'",30],",",["T_WHITESPACE","\n      ",30],["T_CONSTANT_ENCAPSED_STRING","'fields'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],["T_ARRAY","array",31],"(",["T_WHITESPACE","\n        ",31],["T_CONSTANT_ENCAPSED_STRING","'id'",32],["T_WHITESPACE","  ",32],["T_DOUBLE_ARROW","=>",32],["T_WHITESPACE"," ",32],["T_ARRAY","array",32],"(",["T_WHITESPACE","\n          ",32],["T_CONSTANT_ENCAPSED_STRING","'type'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'int'",33],",",["T_WHITESPACE","\n          ",33],["T_CONSTANT_ENCAPSED_STRING","'default'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_STRING","NULL",34],",",["T_WHITESPACE","\n        ",34],")",",",["T_WHITESPACE","\n        ",35],["T_CONSTANT_ENCAPSED_STRING","'test_field'",36],["T_WHITESPACE","  ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_ARRAY","array",36],"(",["T_WHITESPACE","\n          ",36],["T_CONSTANT_ENCAPSED_STRING","'type'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'int'",37],",",["T_WHITESPACE","\n          ",37],["T_CONSTANT_ENCAPSED_STRING","'not null'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_STRING","TRUE",38],",",["T_WHITESPACE","\n          ",38],["T_CONSTANT_ENCAPSED_STRING","'description'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'Schema table description may contain \"quotes\" and could be long\u00e2\u0080\u0094very long indeed. There could be \"multiple quoted regions\".'",39],",",["T_WHITESPACE","\n        ",39],")",",",["T_WHITESPACE","\n        ",40],["T_CONSTANT_ENCAPSED_STRING","'test_field_string'",41],["T_WHITESPACE","  ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",["T_WHITESPACE","\n          ",41],["T_CONSTANT_ENCAPSED_STRING","'type'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'varchar'",42],",",["T_WHITESPACE","\n          ",42],["T_CONSTANT_ENCAPSED_STRING","'length'",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_LNUMBER","20",43],",",["T_WHITESPACE","\n          ",43],["T_CONSTANT_ENCAPSED_STRING","'not null'",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_STRING","TRUE",44],",",["T_WHITESPACE","\n          ",44],["T_CONSTANT_ENCAPSED_STRING","'default'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"'\\\"funky default'\\\"\"",45],",",["T_WHITESPACE","\n          ",45],["T_CONSTANT_ENCAPSED_STRING","'description'",46],["T_WHITESPACE"," ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'Schema column description for string.'",46],",",["T_WHITESPACE","\n        ",46],")",",",["T_WHITESPACE","\n        ",47],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii'",48],["T_WHITESPACE","  ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_WHITESPACE","\n          ",48],["T_CONSTANT_ENCAPSED_STRING","'type'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii'",49],",",["T_WHITESPACE","\n          ",49],["T_CONSTANT_ENCAPSED_STRING","'length'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_LNUMBER","255",50],",",["T_WHITESPACE","\n          ",50],["T_CONSTANT_ENCAPSED_STRING","'description'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'Schema column description for ASCII string.'",51],",",["T_WHITESPACE","\n        ",51],")",",",["T_WHITESPACE","\n      ",52],")",",",["T_WHITESPACE","\n    ",53],")",";",["T_WHITESPACE","\n    ",54],["T_STRING","db_create_table",55],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$table_specification",55],")",";",["T_WHITESPACE","\n\n    ",55],["T_COMMENT","\/\/ Assert that the table exists.\n",57],["T_WHITESPACE","    ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertTrue",58],"(",["T_STRING","db_table_exists",58],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",58],")",",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'The table exists.'",58],")",";",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ Assert that the table comment has been set.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","checkSchemaComment",61],"(",["T_VARIABLE","$table_specification",61],"[",["T_CONSTANT_ENCAPSED_STRING","'description'",61],"]",",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'test_table'",61],")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ Assert that the column comment has been set.\n",63],["T_WHITESPACE","    ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","checkSchemaComment",64],"(",["T_VARIABLE","$table_specification",64],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",64],"]","[",["T_CONSTANT_ENCAPSED_STRING","'test_field'",64],"]","[",["T_CONSTANT_ENCAPSED_STRING","'description'",64],"]",",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'test_table'",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'test_field'",64],")",";",["T_WHITESPACE","\n\n    ",64],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_STRING","Database",66],["T_DOUBLE_COLON","::",66],["T_STRING","getConnection",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","databaseType",66],"(",")",["T_WHITESPACE"," ",66],["T_IS_EQUAL","==",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'mysql'",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n      ",66],["T_COMMENT","\/\/ Make sure that varchar fields have the correct collation.\n",67],["T_WHITESPACE","      ",68],["T_VARIABLE","$columns",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","db_query",68],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW FULL COLUMNS FROM {test_table}'",68],")",";",["T_WHITESPACE","\n      ",68],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$columns",69],["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$column",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n        ",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$column",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","Field",70],["T_WHITESPACE"," ",70],["T_IS_EQUAL","==",70],["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'test_field_string'",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n          ",70],["T_VARIABLE","$string_check",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$column",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","Collation",71],["T_WHITESPACE"," ",71],["T_IS_EQUAL","==",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'utf8mb4_general_ci'",71],")",";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n        ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$column",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","Field",73],["T_WHITESPACE"," ",73],["T_IS_EQUAL","==",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii'",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n          ",73],["T_VARIABLE","$string_ascii_check",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$column",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","Collation",74],["T_WHITESPACE"," ",74],["T_IS_EQUAL","==",74],["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'ascii_general_ci'",74],")",";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n      ",75],"}",["T_WHITESPACE","\n      ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertTrue",77],"(","!",["T_EMPTY","empty",77],"(",["T_VARIABLE","$string_check",77],")",",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'string field has the right collation.'",77],")",";",["T_WHITESPACE","\n      ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertTrue",78],"(","!",["T_EMPTY","empty",78],"(",["T_VARIABLE","$string_ascii_check",78],")",",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'ASCII string field has the right collation.'",78],")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_COMMENT","\/\/ An insert without a value for the column 'test_table' should fail.\n",81],["T_WHITESPACE","    ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertFalse",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","tryInsert",82],"(",")",",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'Insert without a default failed.'",82],")",";",["T_WHITESPACE","\n\n    ",82],["T_COMMENT","\/\/ Add a default value to the column.\n",84],["T_WHITESPACE","    ",85],["T_STRING","db_field_set_default",85],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'test_field'",85],",",["T_WHITESPACE"," ",85],["T_LNUMBER","0",85],")",";",["T_WHITESPACE","\n    ",85],["T_COMMENT","\/\/ The insert should now succeed.\n",86],["T_WHITESPACE","    ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertTrue",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","tryInsert",87],"(",")",",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'Insert with a default succeeded.'",87],")",";",["T_WHITESPACE","\n\n    ",87],["T_COMMENT","\/\/ Remove the default.\n",89],["T_WHITESPACE","    ",90],["T_STRING","db_field_set_no_default",90],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'test_field'",90],")",";",["T_WHITESPACE","\n    ",90],["T_COMMENT","\/\/ The insert should fail again.\n",91],["T_WHITESPACE","    ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","assertFalse",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","tryInsert",92],"(",")",",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'Insert without a default failed.'",92],")",";",["T_WHITESPACE","\n\n    ",92],["T_COMMENT","\/\/ Test for fake index and test for the boolean result of indexExists().\n",94],["T_WHITESPACE","    ",95],["T_VARIABLE","$index_exists",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","Database",95],["T_DOUBLE_COLON","::",95],["T_STRING","getConnection",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","schema",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","indexExists",95],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'test_field'",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","assertIdentical",96],"(",["T_VARIABLE","$index_exists",96],",",["T_WHITESPACE"," ",96],["T_STRING","FALSE",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'Fake index does not exists'",96],")",";",["T_WHITESPACE","\n    ",96],["T_COMMENT","\/\/ Add index.\n",97],["T_WHITESPACE","    ",98],["T_STRING","db_add_index",98],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'test_field'",98],",",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field'",98],")",",",["T_WHITESPACE"," ",98],["T_VARIABLE","$table_specification",98],")",";",["T_WHITESPACE","\n    ",98],["T_COMMENT","\/\/ Test for created index and test for the boolean result of indexExists().\n",99],["T_WHITESPACE","    ",100],["T_VARIABLE","$index_exists",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","Database",100],["T_DOUBLE_COLON","::",100],["T_STRING","getConnection",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","schema",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","indexExists",100],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'test_field'",100],")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertIdentical",101],"(",["T_VARIABLE","$index_exists",101],",",["T_WHITESPACE"," ",101],["T_STRING","TRUE",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'Index created.'",101],")",";",["T_WHITESPACE","\n\n    ",101],["T_COMMENT","\/\/ Rename the table.\n",103],["T_WHITESPACE","    ",104],["T_STRING","db_rename_table",104],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'test_table2'",104],")",";",["T_WHITESPACE","\n\n    ",104],["T_COMMENT","\/\/ Index should be renamed.\n",106],["T_WHITESPACE","    ",107],["T_VARIABLE","$index_exists",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","Database",107],["T_DOUBLE_COLON","::",107],["T_STRING","getConnection",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","schema",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","indexExists",107],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'test_field'",107],")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertTrue",108],"(",["T_VARIABLE","$index_exists",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'Index was renamed.'",108],")",";",["T_WHITESPACE","\n\n    ",108],["T_COMMENT","\/\/ We need the default so that we can insert after the rename.\n",110],["T_WHITESPACE","    ",111],["T_STRING","db_field_set_default",111],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'test_field'",111],",",["T_WHITESPACE"," ",111],["T_LNUMBER","0",111],")",";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertFalse",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","tryInsert",112],"(",")",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'Insert into the old table failed.'",112],")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertTrue",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","tryInsert",113],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",113],")",",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'Insert into the new table succeeded.'",113],")",";",["T_WHITESPACE","\n\n    ",113],["T_COMMENT","\/\/ We should have successfully inserted exactly two rows.\n",115],["T_WHITESPACE","    ",116],["T_VARIABLE","$count",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","db_query",116],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT COUNT(*) FROM {test_table2}'",116],")",["T_OBJECT_OPERATOR","->",116],["T_STRING","fetchField",116],"(",")",";",["T_WHITESPACE","\n    ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","assertEqual",117],"(",["T_VARIABLE","$count",117],",",["T_WHITESPACE"," ",117],["T_LNUMBER","2",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'Two fields were successfully inserted.'",117],")",";",["T_WHITESPACE","\n\n    ",117],["T_COMMENT","\/\/ Try to drop the table.\n",119],["T_WHITESPACE","    ",120],["T_STRING","db_drop_table",120],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",120],")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","assertFalse",121],"(",["T_STRING","db_table_exists",121],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",121],")",",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'The dropped table does not exist.'",121],")",";",["T_WHITESPACE","\n\n    ",121],["T_COMMENT","\/\/ Recreate the table.\n",123],["T_WHITESPACE","    ",124],["T_STRING","db_create_table",124],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$table_specification",124],")",";",["T_WHITESPACE","\n    ",124],["T_STRING","db_field_set_default",125],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'test_field'",125],",",["T_WHITESPACE"," ",125],["T_LNUMBER","0",125],")",";",["T_WHITESPACE","\n    ",125],["T_STRING","db_add_field",126],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'test_serial'",126],",",["T_WHITESPACE"," ",126],["T_ARRAY","array",126],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'int'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'not null'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_STRING","TRUE",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'default'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_LNUMBER","0",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'description'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'Added column description.'",126],")",")",";",["T_WHITESPACE","\n\n    ",126],["T_COMMENT","\/\/ Assert that the column comment has been set.\n",128],["T_WHITESPACE","    ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","checkSchemaComment",129],"(",["T_CONSTANT_ENCAPSED_STRING","'Added column description.'",129],",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'test_table'",129],",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'test_serial'",129],")",";",["T_WHITESPACE","\n\n    ",129],["T_COMMENT","\/\/ Change the new field to a serial column.\n",131],["T_WHITESPACE","    ",132],["T_STRING","db_change_field",132],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'test_serial'",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'test_serial'",132],",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'serial'",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'not null'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_STRING","TRUE",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'description'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'Changed column description.'",132],")",",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_CONSTANT_ENCAPSED_STRING","'primary key'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_CONSTANT_ENCAPSED_STRING","'test_serial'",132],")",")",")",";",["T_WHITESPACE","\n\n    ",132],["T_COMMENT","\/\/ Assert that the column comment has been set.\n",134],["T_WHITESPACE","    ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","checkSchemaComment",135],"(",["T_CONSTANT_ENCAPSED_STRING","'Changed column description.'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'test_table'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'test_serial'",135],")",";",["T_WHITESPACE","\n\n    ",135],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertTrue",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","tryInsert",137],"(",")",",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'Insert with a serial succeeded.'",137],")",";",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$max1",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","db_query",138],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT MAX(test_serial) FROM {test_table}'",138],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","fetchField",138],"(",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertTrue",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","tryInsert",139],"(",")",",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'Insert with a serial succeeded.'",139],")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$max2",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","db_query",140],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT MAX(test_serial) FROM {test_table}'",140],")",["T_OBJECT_OPERATOR","->",140],["T_STRING","fetchField",140],"(",")",";",["T_WHITESPACE","\n    ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","assertTrue",141],"(",["T_VARIABLE","$max2",141],["T_WHITESPACE"," ",141],">",["T_WHITESPACE"," ",141],["T_VARIABLE","$max1",141],",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'The serial is monotone.'",141],")",";",["T_WHITESPACE","\n\n    ",141],["T_VARIABLE","$count",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","db_query",143],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT COUNT(*) FROM {test_table}'",143],")",["T_OBJECT_OPERATOR","->",143],["T_STRING","fetchField",143],"(",")",";",["T_WHITESPACE","\n    ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","assertEqual",144],"(",["T_VARIABLE","$count",144],",",["T_WHITESPACE"," ",144],["T_LNUMBER","2",144],",",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'There were two rows.'",144],")",";",["T_WHITESPACE","\n\n    ",144],["T_COMMENT","\/\/ Test renaming of keys and constraints.\n",146],["T_WHITESPACE","    ",147],["T_STRING","db_drop_table",147],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",147],")",";",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$table_specification",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_ARRAY","array",148],"(",["T_WHITESPACE","\n      ",148],["T_CONSTANT_ENCAPSED_STRING","'fields'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_ARRAY","array",149],"(",["T_WHITESPACE","\n        ",149],["T_CONSTANT_ENCAPSED_STRING","'id'",150],["T_WHITESPACE","  ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_ARRAY","array",150],"(",["T_WHITESPACE","\n          ",150],["T_CONSTANT_ENCAPSED_STRING","'type'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'serial'",151],",",["T_WHITESPACE","\n          ",151],["T_CONSTANT_ENCAPSED_STRING","'not null'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_STRING","TRUE",152],",",["T_WHITESPACE","\n        ",152],")",",",["T_WHITESPACE","\n        ",153],["T_CONSTANT_ENCAPSED_STRING","'test_field'",154],["T_WHITESPACE","  ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_ARRAY","array",154],"(",["T_WHITESPACE","\n          ",154],["T_CONSTANT_ENCAPSED_STRING","'type'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'int'",155],",",["T_WHITESPACE","\n          ",155],["T_CONSTANT_ENCAPSED_STRING","'default'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_LNUMBER","0",156],",",["T_WHITESPACE","\n        ",156],")",",",["T_WHITESPACE","\n      ",157],")",",",["T_WHITESPACE","\n      ",158],["T_CONSTANT_ENCAPSED_STRING","'primary key'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_ARRAY","array",159],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",159],")",",",["T_WHITESPACE","\n      ",159],["T_CONSTANT_ENCAPSED_STRING","'unique keys'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_ARRAY","array",160],"(",["T_WHITESPACE","\n        ",160],["T_CONSTANT_ENCAPSED_STRING","'test_field'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_ARRAY","array",161],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field'",161],")",",",["T_WHITESPACE","\n      ",161],")",",",["T_WHITESPACE","\n    ",162],")",";",["T_WHITESPACE","\n    ",163],["T_STRING","db_create_table",164],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$table_specification",164],")",";",["T_WHITESPACE","\n\n    ",164],["T_COMMENT","\/\/ Tests for indexes are Database specific.\n",166],["T_WHITESPACE","    ",167],["T_VARIABLE","$db_type",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","Database",167],["T_DOUBLE_COLON","::",167],["T_STRING","getConnection",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","databaseType",167],"(",")",";",["T_WHITESPACE","\n\n    ",167],["T_COMMENT","\/\/ Test for existing primary and unique keys.\n",169],["T_WHITESPACE","    ",170],["T_SWITCH","switch",170],["T_WHITESPACE"," ",170],"(",["T_VARIABLE","$db_type",170],")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n      ",170],["T_CASE","case",171],["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",171],":",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$primary_key_exists",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","Database",172],["T_DOUBLE_COLON","::",172],["T_STRING","getConnection",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","schema",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","constraintExists",172],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'__pkey'",172],")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$unique_key_exists",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Database",173],["T_DOUBLE_COLON","::",173],["T_STRING","getConnection",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","schema",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","constraintExists",173],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",173],",",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'test_field'",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'__key'",173],")",";",["T_WHITESPACE","\n        ",173],["T_BREAK","break",174],";",["T_WHITESPACE","\n      ",174],["T_CASE","case",175],["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",175],":",["T_WHITESPACE","\n        ",175],["T_COMMENT","\/\/ SQLite does not create a standalone index for primary keys.\n",176],["T_WHITESPACE","        ",177],["T_VARIABLE","$primary_key_exists",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_STRING","TRUE",177],";",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$unique_key_exists",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","Database",178],["T_DOUBLE_COLON","::",178],["T_STRING","getConnection",178],"(",")",["T_OBJECT_OPERATOR","->",178],["T_STRING","schema",178],"(",")",["T_OBJECT_OPERATOR","->",178],["T_STRING","indexExists",178],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",178],",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'test_field'",178],")",";",["T_WHITESPACE","\n        ",178],["T_BREAK","break",179],";",["T_WHITESPACE","\n      ",179],["T_DEFAULT","default",180],":",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$primary_key_exists",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING","Database",181],["T_DOUBLE_COLON","::",181],["T_STRING","getConnection",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","schema",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","indexExists",181],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",181],")",";",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$unique_key_exists",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","Database",182],["T_DOUBLE_COLON","::",182],["T_STRING","getConnection",182],"(",")",["T_OBJECT_OPERATOR","->",182],["T_STRING","schema",182],"(",")",["T_OBJECT_OPERATOR","->",182],["T_STRING","indexExists",182],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",182],",",["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","'test_field'",182],")",";",["T_WHITESPACE","\n        ",182],["T_BREAK","break",183],";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n    ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertIdentical",185],"(",["T_VARIABLE","$primary_key_exists",185],",",["T_WHITESPACE"," ",185],["T_STRING","TRUE",185],",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'Primary key created.'",185],")",";",["T_WHITESPACE","\n    ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","assertIdentical",186],"(",["T_VARIABLE","$unique_key_exists",186],",",["T_WHITESPACE"," ",186],["T_STRING","TRUE",186],",",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","'Unique key created.'",186],")",";",["T_WHITESPACE","\n\n    ",186],["T_STRING","db_rename_table",188],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table'",188],",",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'test_table2'",188],")",";",["T_WHITESPACE","\n\n    ",188],["T_COMMENT","\/\/ Test for renamed primary and unique keys.\n",190],["T_WHITESPACE","    ",191],["T_SWITCH","switch",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$db_type",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n      ",191],["T_CASE","case",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",192],":",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$renamed_primary_key_exists",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","Database",193],["T_DOUBLE_COLON","::",193],["T_STRING","getConnection",193],"(",")",["T_OBJECT_OPERATOR","->",193],["T_STRING","schema",193],"(",")",["T_OBJECT_OPERATOR","->",193],["T_STRING","constraintExists",193],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",193],",",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'__pkey'",193],")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$renamed_unique_key_exists",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","Database",194],["T_DOUBLE_COLON","::",194],["T_STRING","getConnection",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","schema",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","constraintExists",194],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",194],",",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'test_field'",194],["T_WHITESPACE"," ",194],".",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'__key'",194],")",";",["T_WHITESPACE","\n        ",194],["T_BREAK","break",195],";",["T_WHITESPACE","\n      ",195],["T_CASE","case",196],["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",196],":",["T_WHITESPACE","\n        ",196],["T_COMMENT","\/\/ SQLite does not create a standalone index for primary keys.\n",197],["T_WHITESPACE","        ",198],["T_VARIABLE","$renamed_primary_key_exists",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","TRUE",198],";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$renamed_unique_key_exists",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","Database",199],["T_DOUBLE_COLON","::",199],["T_STRING","getConnection",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","schema",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","indexExists",199],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'test_field'",199],")",";",["T_WHITESPACE","\n        ",199],["T_BREAK","break",200],";",["T_WHITESPACE","\n      ",200],["T_DEFAULT","default",201],":",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$renamed_primary_key_exists",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","Database",202],["T_DOUBLE_COLON","::",202],["T_STRING","getConnection",202],"(",")",["T_OBJECT_OPERATOR","->",202],["T_STRING","schema",202],"(",")",["T_OBJECT_OPERATOR","->",202],["T_STRING","indexExists",202],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",202],",",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",202],")",";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$renamed_unique_key_exists",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","Database",203],["T_DOUBLE_COLON","::",203],["T_STRING","getConnection",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","schema",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","indexExists",203],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",203],",",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'test_field'",203],")",";",["T_WHITESPACE","\n        ",203],["T_BREAK","break",204],";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n    ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","assertIdentical",206],"(",["T_VARIABLE","$renamed_primary_key_exists",206],",",["T_WHITESPACE"," ",206],["T_STRING","TRUE",206],",",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'Primary key was renamed.'",206],")",";",["T_WHITESPACE","\n    ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","assertIdentical",207],"(",["T_VARIABLE","$renamed_unique_key_exists",207],",",["T_WHITESPACE"," ",207],["T_STRING","TRUE",207],",",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'Unique key was renamed.'",207],")",";",["T_WHITESPACE","\n\n    ",207],["T_COMMENT","\/\/ For PostgreSQL check in addition that sequence was renamed.\n",209],["T_WHITESPACE","    ",210],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$db_type",210],["T_WHITESPACE"," ",210],["T_IS_EQUAL","==",210],["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n      ",210],["T_COMMENT","\/\/ Get information about new table.\n",211],["T_WHITESPACE","      ",212],["T_VARIABLE","$info",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","Database",212],["T_DOUBLE_COLON","::",212],["T_STRING","getConnection",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","schema",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","queryTableInformation",212],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",212],")",";",["T_WHITESPACE","\n      ",212],["T_VARIABLE","$sequence_name",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","Database",213],["T_DOUBLE_COLON","::",213],["T_STRING","getConnection",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","schema",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","prefixNonTable",213],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table2'",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'id'",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'seq'",213],")",";",["T_WHITESPACE","\n      ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","assertEqual",214],"(",["T_VARIABLE","$sequence_name",214],",",["T_WHITESPACE"," ",214],["T_STRING","current",214],"(",["T_VARIABLE","$info",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","sequences",214],")",",",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'Sequence was renamed.'",214],")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_COMMENT","\/\/ Use database specific data type and ensure that table is created.\n",217],["T_WHITESPACE","    ",218],["T_VARIABLE","$table_specification",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_ARRAY","array",218],"(",["T_WHITESPACE","\n      ",218],["T_CONSTANT_ENCAPSED_STRING","'description'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'Schema table description.'",219],",",["T_WHITESPACE","\n      ",219],["T_CONSTANT_ENCAPSED_STRING","'fields'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_ARRAY","array",220],"(",["T_WHITESPACE","\n        ",220],["T_CONSTANT_ENCAPSED_STRING","'timestamp'",221],["T_WHITESPACE","  ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_ARRAY","array",221],"(",["T_WHITESPACE","\n          ",221],["T_CONSTANT_ENCAPSED_STRING","'mysql_type'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'timestamp'",222],",",["T_WHITESPACE","\n          ",222],["T_CONSTANT_ENCAPSED_STRING","'pgsql_type'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'timestamp'",223],",",["T_WHITESPACE","\n          ",223],["T_CONSTANT_ENCAPSED_STRING","'sqlite_type'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'datetime'",224],",",["T_WHITESPACE","\n          ",224],["T_CONSTANT_ENCAPSED_STRING","'not null'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_STRING","FALSE",225],",",["T_WHITESPACE","\n          ",225],["T_CONSTANT_ENCAPSED_STRING","'default'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_STRING","NULL",226],",",["T_WHITESPACE","\n        ",226],")",",",["T_WHITESPACE","\n      ",227],")",",",["T_WHITESPACE","\n    ",228],")",";",["T_WHITESPACE","\n    ",229],["T_TRY","try",230],["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n      ",230],["T_STRING","db_create_table",231],"(",["T_CONSTANT_ENCAPSED_STRING","'test_timestamp'",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$table_specification",231],")",";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n    ",232],["T_CATCH","catch",233],["T_WHITESPACE"," ",233],"(",["T_NS_SEPARATOR","\\",233],["T_STRING","Exception",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$e",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n    ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","assertTrue",235],"(",["T_STRING","db_table_exists",235],"(",["T_CONSTANT_ENCAPSED_STRING","'test_timestamp'",235],")",",",["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'Table with database specific datatype was created.'",235],")",";",["T_WHITESPACE","\n  ",235],"}",["T_WHITESPACE","\n\n  ",236],["T_DOC_COMMENT","\/**\n   * Tests that indexes on string fields are limited to 191 characters on MySQL.\n   *\n   * @see \\Drupal\\Core\\Database\\Driver\\mysql\\Schema::getNormalizedIndexes()\n   *\/",238],["T_WHITESPACE","\n  ",242],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","testIndexLength",243],"(",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n    ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_STRING","Database",244],["T_DOUBLE_COLON","::",244],["T_STRING","getConnection",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","databaseType",244],"(",")",["T_WHITESPACE"," ",244],["T_IS_NOT_EQUAL","!=",244],["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","'mysql'",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n      ",244],["T_RETURN","return",245],";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n    ",246],["T_VARIABLE","$table_specification",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_ARRAY","array",247],"(",["T_WHITESPACE","\n      ",247],["T_CONSTANT_ENCAPSED_STRING","'fields'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_ARRAY","array",248],"(",["T_WHITESPACE","\n        ",248],["T_CONSTANT_ENCAPSED_STRING","'id'",249],["T_WHITESPACE","  ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_ARRAY","array",249],"(",["T_WHITESPACE","\n          ",249],["T_CONSTANT_ENCAPSED_STRING","'type'",250],["T_WHITESPACE"," ",250],["T_DOUBLE_ARROW","=>",250],["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'int'",250],",",["T_WHITESPACE","\n          ",250],["T_CONSTANT_ENCAPSED_STRING","'default'",251],["T_WHITESPACE"," ",251],["T_DOUBLE_ARROW","=>",251],["T_WHITESPACE"," ",251],["T_STRING","NULL",251],",",["T_WHITESPACE","\n        ",251],")",",",["T_WHITESPACE","\n        ",252],["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",253],["T_WHITESPACE","  ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_ARRAY","array",253],"(",["T_WHITESPACE","\n          ",253],["T_CONSTANT_ENCAPSED_STRING","'type'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'text'",254],",",["T_WHITESPACE","\n          ",254],["T_CONSTANT_ENCAPSED_STRING","'not null'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_STRING","TRUE",255],",",["T_WHITESPACE","\n        ",255],")",",",["T_WHITESPACE","\n        ",256],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",257],["T_WHITESPACE","  ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],["T_ARRAY","array",257],"(",["T_WHITESPACE","\n          ",257],["T_CONSTANT_ENCAPSED_STRING","'type'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'varchar'",258],",",["T_WHITESPACE","\n          ",258],["T_CONSTANT_ENCAPSED_STRING","'length'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_LNUMBER","255",259],",",["T_WHITESPACE","\n          ",259],["T_CONSTANT_ENCAPSED_STRING","'not null'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_STRING","TRUE",260],",",["T_WHITESPACE","\n        ",260],")",",",["T_WHITESPACE","\n        ",261],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",262],["T_WHITESPACE","  ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_ARRAY","array",262],"(",["T_WHITESPACE","\n          ",262],["T_CONSTANT_ENCAPSED_STRING","'type'",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii'",263],",",["T_WHITESPACE","\n          ",263],["T_CONSTANT_ENCAPSED_STRING","'length'",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_LNUMBER","255",264],",",["T_WHITESPACE","\n        ",264],")",",",["T_WHITESPACE","\n        ",265],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",266],["T_WHITESPACE","  ",266],["T_DOUBLE_ARROW","=>",266],["T_WHITESPACE"," ",266],["T_ARRAY","array",266],"(",["T_WHITESPACE","\n          ",266],["T_CONSTANT_ENCAPSED_STRING","'type'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'varchar'",267],",",["T_WHITESPACE","\n          ",267],["T_CONSTANT_ENCAPSED_STRING","'length'",268],["T_WHITESPACE"," ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_LNUMBER","128",268],",",["T_WHITESPACE","\n          ",268],["T_CONSTANT_ENCAPSED_STRING","'not null'",269],["T_WHITESPACE"," ",269],["T_DOUBLE_ARROW","=>",269],["T_WHITESPACE"," ",269],["T_STRING","TRUE",269],",",["T_WHITESPACE","\n        ",269],")",",",["T_WHITESPACE","\n      ",270],")",",",["T_WHITESPACE","\n      ",271],["T_CONSTANT_ENCAPSED_STRING","'indexes'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_ARRAY","array",272],"(",["T_WHITESPACE","\n        ",272],["T_CONSTANT_ENCAPSED_STRING","'test_regular'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_ARRAY","array",273],"(",["T_WHITESPACE","\n          ",273],["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",274],",",["T_WHITESPACE","\n          ",274],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",275],",",["T_WHITESPACE","\n          ",275],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",276],",",["T_WHITESPACE","\n          ",276],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",277],",",["T_WHITESPACE","\n        ",277],")",",",["T_WHITESPACE","\n        ",278],["T_CONSTANT_ENCAPSED_STRING","'test_length'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_ARRAY","array",279],"(",["T_WHITESPACE","\n          ",279],["T_ARRAY","array",280],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",280],",",["T_WHITESPACE"," ",280],["T_LNUMBER","128",280],")",",",["T_WHITESPACE","\n          ",280],["T_ARRAY","array",281],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",281],",",["T_WHITESPACE"," ",281],["T_LNUMBER","128",281],")",",",["T_WHITESPACE","\n          ",281],["T_ARRAY","array",282],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",282],",",["T_WHITESPACE"," ",282],["T_LNUMBER","128",282],")",",",["T_WHITESPACE","\n          ",282],["T_ARRAY","array",283],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",283],",",["T_WHITESPACE"," ",283],["T_LNUMBER","128",283],")",",",["T_WHITESPACE","\n        ",283],")",",",["T_WHITESPACE","\n        ",284],["T_CONSTANT_ENCAPSED_STRING","'test_mixed'",285],["T_WHITESPACE"," ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_ARRAY","array",285],"(",["T_WHITESPACE","\n          ",285],["T_ARRAY","array",286],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",286],",",["T_WHITESPACE"," ",286],["T_LNUMBER","200",286],")",",",["T_WHITESPACE","\n          ",286],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",287],",",["T_WHITESPACE","\n          ",287],["T_ARRAY","array",288],"(",["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",288],",",["T_WHITESPACE"," ",288],["T_LNUMBER","200",288],")",",",["T_WHITESPACE","\n          ",288],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",289],",",["T_WHITESPACE","\n        ",289],")",",",["T_WHITESPACE","\n      ",290],")",",",["T_WHITESPACE","\n    ",291],")",";",["T_WHITESPACE","\n    ",292],["T_STRING","db_create_table",293],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table_index_length'",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$table_specification",293],")",";",["T_WHITESPACE","\n\n    ",293],["T_VARIABLE","$schema_object",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_STRING","Database",295],["T_DOUBLE_COLON","::",295],["T_STRING","getConnection",295],"(",")",["T_OBJECT_OPERATOR","->",295],["T_STRING","schema",295],"(",")",";",["T_WHITESPACE","\n\n    ",295],["T_COMMENT","\/\/ Ensure expected exception thrown when adding index with missing info.\n",297],["T_WHITESPACE","    ",298],["T_VARIABLE","$expected_exception_message",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","\"MySQL needs the 'test_field_text' field specification in order to normalize the 'test_regular' index\"",298],";",["T_WHITESPACE","\n    ",298],["T_VARIABLE","$missing_field_spec",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$table_specification",299],";",["T_WHITESPACE","\n    ",299],["T_UNSET","unset",300],"(",["T_VARIABLE","$missing_field_spec",300],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",300],"]","[",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",300],"]",")",";",["T_WHITESPACE","\n    ",300],["T_TRY","try",301],["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n      ",301],["T_VARIABLE","$schema_object",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","addIndex",302],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table_index_length'",302],",",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'test_separate'",302],",",["T_WHITESPACE"," ",302],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",302],",",["T_WHITESPACE"," ",302],["T_LNUMBER","200",302],"]","]",",",["T_WHITESPACE"," ",302],["T_VARIABLE","$missing_field_spec",302],")",";",["T_WHITESPACE","\n      ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","fail",303],"(",["T_CONSTANT_ENCAPSED_STRING","'SchemaException not thrown when adding index with missing information.'",303],")",";",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n    ",304],["T_CATCH","catch",305],["T_WHITESPACE"," ",305],"(",["T_STRING","SchemaException",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$e",305],")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n      ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","assertEqual",306],"(",["T_VARIABLE","$expected_exception_message",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$e",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getMessage",306],"(",")",")",";",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n\n    ",307],["T_COMMENT","\/\/ Add a separate index.\n",309],["T_WHITESPACE","    ",310],["T_VARIABLE","$schema_object",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","addIndex",310],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table_index_length'",310],",",["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","'test_separate'",310],",",["T_WHITESPACE"," ",310],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",310],",",["T_WHITESPACE"," ",310],["T_LNUMBER","200",310],"]","]",",",["T_WHITESPACE"," ",310],["T_VARIABLE","$table_specification",310],")",";",["T_WHITESPACE","\n    ",310],["T_VARIABLE","$table_specification_with_new_index",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$table_specification",311],";",["T_WHITESPACE","\n    ",311],["T_VARIABLE","$table_specification_with_new_index",312],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",312],"]","[",["T_CONSTANT_ENCAPSED_STRING","'test_separate'",312],"]",["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",312],",",["T_WHITESPACE"," ",312],["T_LNUMBER","200",312],"]","]",";",["T_WHITESPACE","\n\n    ",312],["T_COMMENT","\/\/ Ensure that the exceptions of addIndex are thrown as expected.\n",314],["T_WHITESPACE","\n    ",315],["T_TRY","try",316],["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n      ",316],["T_VARIABLE","$schema_object",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","addIndex",317],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table_index_length'",317],",",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'test_separate'",317],",",["T_WHITESPACE"," ",317],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",317],",",["T_WHITESPACE"," ",317],["T_LNUMBER","200",317],"]","]",",",["T_WHITESPACE"," ",317],["T_VARIABLE","$table_specification",317],")",";",["T_WHITESPACE","\n      ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","fail",318],"(",["T_CONSTANT_ENCAPSED_STRING","'\\Drupal\\Core\\Database\\SchemaObjectExistsException exception missed.'",318],")",";",["T_WHITESPACE","\n    ",318],"}",["T_WHITESPACE","\n    ",319],["T_CATCH","catch",320],["T_WHITESPACE"," ",320],"(",["T_STRING","SchemaObjectExistsException",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$e",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n      ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","pass",321],"(",["T_CONSTANT_ENCAPSED_STRING","'\\Drupal\\Core\\Database\\SchemaObjectExistsException thrown when index already exists.'",321],")",";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n\n    ",322],["T_TRY","try",324],["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n      ",324],["T_VARIABLE","$schema_object",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","addIndex",325],"(",["T_CONSTANT_ENCAPSED_STRING","'test_table_non_existing'",325],",",["T_WHITESPACE"," ",325],["T_CONSTANT_ENCAPSED_STRING","'test_separate'",325],",",["T_WHITESPACE"," ",325],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",325],",",["T_WHITESPACE"," ",325],["T_LNUMBER","200",325],"]","]",",",["T_WHITESPACE"," ",325],["T_VARIABLE","$table_specification",325],")",";",["T_WHITESPACE","\n      ",325],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","fail",326],"(",["T_CONSTANT_ENCAPSED_STRING","'\\Drupal\\Core\\Database\\SchemaObjectDoesNotExistException exception missed.'",326],")",";",["T_WHITESPACE","\n    ",326],"}",["T_WHITESPACE","\n    ",327],["T_CATCH","catch",328],["T_WHITESPACE"," ",328],"(",["T_STRING","SchemaObjectDoesNotExistException",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$e",328],")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n      ",328],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","pass",329],"(",["T_CONSTANT_ENCAPSED_STRING","'\\Drupal\\Core\\Database\\SchemaObjectDoesNotExistException thrown when index already exists.'",329],")",";",["T_WHITESPACE","\n    ",329],"}",["T_WHITESPACE","\n\n    ",330],["T_COMMENT","\/\/ Get index information.\n",332],["T_WHITESPACE","    ",333],["T_VARIABLE","$results",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_STRING","db_query",333],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW INDEX FROM {test_table_index_length}'",333],")",";",["T_WHITESPACE","\n    ",333],["T_VARIABLE","$expected_lengths",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_ARRAY","array",334],"(",["T_WHITESPACE","\n      ",334],["T_CONSTANT_ENCAPSED_STRING","'test_regular'",335],["T_WHITESPACE"," ",335],["T_DOUBLE_ARROW","=>",335],["T_WHITESPACE"," ",335],["T_ARRAY","array",335],"(",["T_WHITESPACE","\n        ",335],["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",336],["T_WHITESPACE"," ",336],["T_DOUBLE_ARROW","=>",336],["T_WHITESPACE"," ",336],["T_LNUMBER","191",336],",",["T_WHITESPACE","\n        ",336],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_LNUMBER","191",337],",",["T_WHITESPACE","\n        ",337],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_STRING","NULL",338],",",["T_WHITESPACE","\n        ",338],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_STRING","NULL",339],",",["T_WHITESPACE","\n      ",339],")",",",["T_WHITESPACE","\n      ",340],["T_CONSTANT_ENCAPSED_STRING","'test_length'",341],["T_WHITESPACE"," ",341],["T_DOUBLE_ARROW","=>",341],["T_WHITESPACE"," ",341],["T_ARRAY","array",341],"(",["T_WHITESPACE","\n        ",341],["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",342],["T_WHITESPACE"," ",342],["T_DOUBLE_ARROW","=>",342],["T_WHITESPACE"," ",342],["T_LNUMBER","128",342],",",["T_WHITESPACE","\n        ",342],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",343],["T_WHITESPACE"," ",343],["T_DOUBLE_ARROW","=>",343],["T_WHITESPACE"," ",343],["T_LNUMBER","128",343],",",["T_WHITESPACE","\n        ",343],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",344],["T_WHITESPACE"," ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_LNUMBER","128",344],",",["T_WHITESPACE","\n        ",344],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_STRING","NULL",345],",",["T_WHITESPACE","\n      ",345],")",",",["T_WHITESPACE","\n      ",346],["T_CONSTANT_ENCAPSED_STRING","'test_mixed'",347],["T_WHITESPACE"," ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],["T_ARRAY","array",347],"(",["T_WHITESPACE","\n        ",347],["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",348],["T_WHITESPACE"," ",348],["T_DOUBLE_ARROW","=>",348],["T_WHITESPACE"," ",348],["T_LNUMBER","191",348],",",["T_WHITESPACE","\n        ",348],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_long'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_LNUMBER","191",349],",",["T_WHITESPACE","\n        ",349],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_ascii_long'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_LNUMBER","200",350],",",["T_WHITESPACE","\n        ",350],["T_CONSTANT_ENCAPSED_STRING","'test_field_string_short'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_STRING","NULL",351],",",["T_WHITESPACE","\n      ",351],")",",",["T_WHITESPACE","\n      ",352],["T_CONSTANT_ENCAPSED_STRING","'test_separate'",353],["T_WHITESPACE"," ",353],["T_DOUBLE_ARROW","=>",353],["T_WHITESPACE"," ",353],["T_ARRAY","array",353],"(",["T_WHITESPACE","\n        ",353],["T_CONSTANT_ENCAPSED_STRING","'test_field_text'",354],["T_WHITESPACE"," ",354],["T_DOUBLE_ARROW","=>",354],["T_WHITESPACE"," ",354],["T_LNUMBER","191",354],",",["T_WHITESPACE","\n      ",354],")",",",["T_WHITESPACE","\n    ",355],")",";",["T_WHITESPACE","\n\n    ",356],["T_COMMENT","\/\/ Count the number of columns defined in the indexes.\n",358],["T_WHITESPACE","    ",359],["T_VARIABLE","$column_count",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_LNUMBER","0",359],";",["T_WHITESPACE","\n    ",359],["T_FOREACH","foreach",360],["T_WHITESPACE"," ",360],"(",["T_VARIABLE","$table_specification_with_new_index",360],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",360],"]",["T_WHITESPACE"," ",360],["T_AS","as",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$index",360],")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n      ",360],["T_FOREACH","foreach",361],["T_WHITESPACE"," ",361],"(",["T_VARIABLE","$index",361],["T_WHITESPACE"," ",361],["T_AS","as",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$field",361],")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n        ",361],["T_VARIABLE","$column_count",362],["T_INC","++",362],";",["T_WHITESPACE","\n      ",362],"}",["T_WHITESPACE","\n    ",363],"}",["T_WHITESPACE","\n    ",364],["T_VARIABLE","$test_count",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_LNUMBER","0",365],";",["T_WHITESPACE","\n    ",365],["T_FOREACH","foreach",366],["T_WHITESPACE"," ",366],"(",["T_VARIABLE","$results",366],["T_WHITESPACE"," ",366],["T_AS","as",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$result",366],")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n      ",366],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","assertEqual",367],"(",["T_VARIABLE","$result",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","Sub_part",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$expected_lengths",367],"[",["T_VARIABLE","$result",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","Key_name",367],"]","[",["T_VARIABLE","$result",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","Column_name",367],"]",",",["T_WHITESPACE"," ",367],["T_CONSTANT_ENCAPSED_STRING","'Index length matches expected value.'",367],")",";",["T_WHITESPACE","\n      ",367],["T_VARIABLE","$test_count",368],["T_INC","++",368],";",["T_WHITESPACE","\n    ",368],"}",["T_WHITESPACE","\n    ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","assertEqual",370],"(",["T_VARIABLE","$test_count",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$column_count",370],",",["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'Number of tests matches expected value.'",370],")",";",["T_WHITESPACE","\n  ",370],"}",["T_WHITESPACE","\n\n  ",371],["T_DOC_COMMENT","\/**\n   * Tests inserting data into an existing table.\n   *\n   * @param $table\n   *   The database table to insert data into.\n   *\n   * @return\n   *   TRUE if the insert succeeded, FALSE otherwise.\n   *\/",373],["T_WHITESPACE","\n  ",381],["T_FUNCTION","function",382],["T_WHITESPACE"," ",382],["T_STRING","tryInsert",382],"(",["T_VARIABLE","$table",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'test_table'",382],")",["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n    ",382],["T_TRY","try",383],["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n      ",383],["T_STRING","db_insert",384],"(",["T_VARIABLE","$table",384],")",["T_WHITESPACE","\n        ",384],["T_OBJECT_OPERATOR","->",385],["T_STRING","fields",385],"(",["T_ARRAY","array",385],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_STRING","mt_rand",385],"(",["T_LNUMBER","10",385],",",["T_WHITESPACE"," ",385],["T_LNUMBER","20",385],")",")",")",["T_WHITESPACE","\n        ",385],["T_OBJECT_OPERATOR","->",386],["T_STRING","execute",386],"(",")",";",["T_WHITESPACE","\n      ",386],["T_RETURN","return",387],["T_WHITESPACE"," ",387],["T_STRING","TRUE",387],";",["T_WHITESPACE","\n    ",387],"}",["T_WHITESPACE","\n    ",388],["T_CATCH","catch",389],["T_WHITESPACE"," ",389],"(",["T_NS_SEPARATOR","\\",389],["T_STRING","Exception",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$e",389],")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n      ",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_STRING","FALSE",390],";",["T_WHITESPACE","\n    ",390],"}",["T_WHITESPACE","\n  ",391],"}",["T_WHITESPACE","\n\n  ",392],["T_DOC_COMMENT","\/**\n   * Checks that a table or column comment matches a given description.\n   *\n   * @param $description\n   *   The asserted description.\n   * @param $table\n   *   The table to test.\n   * @param $column\n   *   Optional column to test.\n   *\/",394],["T_WHITESPACE","\n  ",403],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","checkSchemaComment",404],"(",["T_VARIABLE","$description",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$table",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$column",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_STRING","NULL",404],")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n    ",404],["T_IF","if",405],["T_WHITESPACE"," ",405],"(",["T_STRING","method_exists",405],"(",["T_STRING","Database",405],["T_DOUBLE_COLON","::",405],["T_STRING","getConnection",405],"(",")",["T_OBJECT_OPERATOR","->",405],["T_STRING","schema",405],"(",")",",",["T_WHITESPACE"," ",405],["T_CONSTANT_ENCAPSED_STRING","'getComment'",405],")",")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n      ",405],["T_VARIABLE","$comment",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_STRING","Database",406],["T_DOUBLE_COLON","::",406],["T_STRING","getConnection",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","schema",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","getComment",406],"(",["T_VARIABLE","$table",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$column",406],")",";",["T_WHITESPACE","\n      ",406],["T_COMMENT","\/\/ The schema comment truncation for mysql is different.\n",407],["T_WHITESPACE","      ",408],["T_IF","if",408],["T_WHITESPACE"," ",408],"(",["T_STRING","Database",408],["T_DOUBLE_COLON","::",408],["T_STRING","getConnection",408],"(",")",["T_OBJECT_OPERATOR","->",408],["T_STRING","databaseType",408],"(",")",["T_WHITESPACE"," ",408],["T_IS_EQUAL","==",408],["T_WHITESPACE"," ",408],["T_CONSTANT_ENCAPSED_STRING","'mysql'",408],")",["T_WHITESPACE"," ",408],"{",["T_WHITESPACE","\n        ",408],["T_VARIABLE","$max_length",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$column",409],["T_WHITESPACE"," ",409],"?",["T_WHITESPACE"," ",409],["T_LNUMBER","255",409],["T_WHITESPACE"," ",409],":",["T_WHITESPACE"," ",409],["T_LNUMBER","60",409],";",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$description",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_STRING","Unicode",410],["T_DOUBLE_COLON","::",410],["T_STRING","truncate",410],"(",["T_VARIABLE","$description",410],",",["T_WHITESPACE"," ",410],["T_VARIABLE","$max_length",410],",",["T_WHITESPACE"," ",410],["T_STRING","TRUE",410],",",["T_WHITESPACE"," ",410],["T_STRING","TRUE",410],")",";",["T_WHITESPACE","\n      ",410],"}",["T_WHITESPACE","\n      ",411],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","assertEqual",412],"(",["T_VARIABLE","$comment",412],",",["T_WHITESPACE"," ",412],["T_VARIABLE","$description",412],",",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","'The comment matches the schema description.'",412],")",";",["T_WHITESPACE","\n    ",412],"}",["T_WHITESPACE","\n  ",413],"}",["T_WHITESPACE","\n\n  ",414],["T_DOC_COMMENT","\/**\n   * Tests creating unsigned columns and data integrity thereof.\n   *\/",416],["T_WHITESPACE","\n  ",418],["T_FUNCTION","function",419],["T_WHITESPACE"," ",419],["T_STRING","testUnsignedColumns",419],"(",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n    ",419],["T_COMMENT","\/\/ First create the table with just a serial column.\n",420],["T_WHITESPACE","    ",421],["T_VARIABLE","$table_name",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_CONSTANT_ENCAPSED_STRING","'unsigned_table'",421],";",["T_WHITESPACE","\n    ",421],["T_VARIABLE","$table_spec",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_ARRAY","array",422],"(",["T_WHITESPACE","\n      ",422],["T_CONSTANT_ENCAPSED_STRING","'fields'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_ARRAY","array",423],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_ARRAY","array",423],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'serial'",423],",",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_STRING","TRUE",423],",",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'not null'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_STRING","TRUE",423],")",")",",",["T_WHITESPACE","\n      ",423],["T_CONSTANT_ENCAPSED_STRING","'primary key'",424],["T_WHITESPACE"," ",424],["T_DOUBLE_ARROW","=>",424],["T_WHITESPACE"," ",424],["T_ARRAY","array",424],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",424],")",",",["T_WHITESPACE","\n    ",424],")",";",["T_WHITESPACE","\n    ",425],["T_STRING","db_create_table",426],"(",["T_VARIABLE","$table_name",426],",",["T_WHITESPACE"," ",426],["T_VARIABLE","$table_spec",426],")",";",["T_WHITESPACE","\n\n    ",426],["T_COMMENT","\/\/ Now set up columns for the other types.\n",428],["T_WHITESPACE","    ",429],["T_VARIABLE","$types",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_ARRAY","array",429],"(",["T_CONSTANT_ENCAPSED_STRING","'int'",429],",",["T_WHITESPACE"," ",429],["T_CONSTANT_ENCAPSED_STRING","'float'",429],",",["T_WHITESPACE"," ",429],["T_CONSTANT_ENCAPSED_STRING","'numeric'",429],")",";",["T_WHITESPACE","\n    ",429],["T_FOREACH","foreach",430],["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$types",430],["T_WHITESPACE"," ",430],["T_AS","as",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$type",430],")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n      ",430],["T_VARIABLE","$column_spec",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_ARRAY","array",431],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",431],["T_WHITESPACE"," ",431],["T_DOUBLE_ARROW","=>",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$type",431],",",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",431],["T_WHITESPACE"," ",431],["T_DOUBLE_ARROW","=>",431],["T_WHITESPACE"," ",431],["T_STRING","TRUE",431],")",";",["T_WHITESPACE","\n      ",431],["T_IF","if",432],["T_WHITESPACE"," ",432],"(",["T_VARIABLE","$type",432],["T_WHITESPACE"," ",432],["T_IS_EQUAL","==",432],["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'numeric'",432],")",["T_WHITESPACE"," ",432],"{",["T_WHITESPACE","\n        ",432],["T_VARIABLE","$column_spec",433],["T_WHITESPACE"," ",433],["T_PLUS_EQUAL","+=",433],["T_WHITESPACE"," ",433],["T_ARRAY","array",433],"(",["T_CONSTANT_ENCAPSED_STRING","'precision'",433],["T_WHITESPACE"," ",433],["T_DOUBLE_ARROW","=>",433],["T_WHITESPACE"," ",433],["T_LNUMBER","10",433],",",["T_WHITESPACE"," ",433],["T_CONSTANT_ENCAPSED_STRING","'scale'",433],["T_WHITESPACE"," ",433],["T_DOUBLE_ARROW","=>",433],["T_WHITESPACE"," ",433],["T_LNUMBER","0",433],")",";",["T_WHITESPACE","\n      ",433],"}",["T_WHITESPACE","\n      ",434],["T_VARIABLE","$column_name",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$type",435],["T_WHITESPACE"," ",435],".",["T_WHITESPACE"," ",435],["T_CONSTANT_ENCAPSED_STRING","'_column'",435],";",["T_WHITESPACE","\n      ",435],["T_VARIABLE","$table_spec",436],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",436],"]","[",["T_VARIABLE","$column_name",436],"]",["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$column_spec",436],";",["T_WHITESPACE","\n      ",436],["T_STRING","db_add_field",437],"(",["T_VARIABLE","$table_name",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$column_name",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$column_spec",437],")",";",["T_WHITESPACE","\n    ",437],"}",["T_WHITESPACE","\n\n    ",438],["T_COMMENT","\/\/ Finally, check each column and try to insert invalid values into them.\n",440],["T_WHITESPACE","    ",441],["T_FOREACH","foreach",441],["T_WHITESPACE"," ",441],"(",["T_VARIABLE","$table_spec",441],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",441],"]",["T_WHITESPACE"," ",441],["T_AS","as",441],["T_WHITESPACE"," ",441],["T_VARIABLE","$column_name",441],["T_WHITESPACE"," ",441],["T_DOUBLE_ARROW","=>",441],["T_WHITESPACE"," ",441],["T_VARIABLE","$column_spec",441],")",["T_WHITESPACE"," ",441],"{",["T_WHITESPACE","\n      ",441],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","assertTrue",442],"(",["T_STRING","db_field_exists",442],"(",["T_VARIABLE","$table_name",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$column_name",442],")",",",["T_WHITESPACE"," ",442],["T_STRING","format_string",442],"(",["T_CONSTANT_ENCAPSED_STRING","'Unsigned @type column was created.'",442],",",["T_WHITESPACE"," ",442],["T_ARRAY","array",442],"(",["T_CONSTANT_ENCAPSED_STRING","'@type'",442],["T_WHITESPACE"," ",442],["T_DOUBLE_ARROW","=>",442],["T_WHITESPACE"," ",442],["T_VARIABLE","$column_spec",442],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",442],"]",")",")",")",";",["T_WHITESPACE","\n      ",442],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","assertFalse",443],"(",["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","tryUnsignedInsert",443],"(",["T_VARIABLE","$table_name",443],",",["T_WHITESPACE"," ",443],["T_VARIABLE","$column_name",443],")",",",["T_WHITESPACE"," ",443],["T_STRING","format_string",443],"(",["T_CONSTANT_ENCAPSED_STRING","'Unsigned @type column rejected a negative value.'",443],",",["T_WHITESPACE"," ",443],["T_ARRAY","array",443],"(",["T_CONSTANT_ENCAPSED_STRING","'@type'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$column_spec",443],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",443],"]",")",")",")",";",["T_WHITESPACE","\n    ",443],"}",["T_WHITESPACE","\n  ",444],"}",["T_WHITESPACE","\n\n  ",445],["T_DOC_COMMENT","\/**\n   * Tries to insert a negative value into columns defined as unsigned.\n   *\n   * @param $table_name\n   *   The table to insert.\n   * @param $column_name\n   *   The column to insert.\n   *\n   * @return\n   *   TRUE if the insert succeeded, FALSE otherwise.\n   *\/",447],["T_WHITESPACE","\n  ",457],["T_FUNCTION","function",458],["T_WHITESPACE"," ",458],["T_STRING","tryUnsignedInsert",458],"(",["T_VARIABLE","$table_name",458],",",["T_WHITESPACE"," ",458],["T_VARIABLE","$column_name",458],")",["T_WHITESPACE"," ",458],"{",["T_WHITESPACE","\n    ",458],["T_TRY","try",459],["T_WHITESPACE"," ",459],"{",["T_WHITESPACE","\n      ",459],["T_STRING","db_insert",460],"(",["T_VARIABLE","$table_name",460],")",["T_WHITESPACE","\n        ",460],["T_OBJECT_OPERATOR","->",461],["T_STRING","fields",461],"(",["T_ARRAY","array",461],"(",["T_VARIABLE","$column_name",461],["T_WHITESPACE"," ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],"-",["T_LNUMBER","1",461],")",")",["T_WHITESPACE","\n        ",461],["T_OBJECT_OPERATOR","->",462],["T_STRING","execute",462],"(",")",";",["T_WHITESPACE","\n      ",462],["T_RETURN","return",463],["T_WHITESPACE"," ",463],["T_STRING","TRUE",463],";",["T_WHITESPACE","\n    ",463],"}",["T_WHITESPACE","\n    ",464],["T_CATCH","catch",465],["T_WHITESPACE"," ",465],"(",["T_NS_SEPARATOR","\\",465],["T_STRING","Exception",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$e",465],")",["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n      ",465],["T_RETURN","return",466],["T_WHITESPACE"," ",466],["T_STRING","FALSE",466],";",["T_WHITESPACE","\n    ",466],"}",["T_WHITESPACE","\n  ",467],"}",["T_WHITESPACE","\n\n  ",468],["T_DOC_COMMENT","\/**\n   * Tests adding columns to an existing table.\n   *\/",470],["T_WHITESPACE","\n  ",472],["T_FUNCTION","function",473],["T_WHITESPACE"," ",473],["T_STRING","testSchemaAddField",473],"(",")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n    ",473],["T_COMMENT","\/\/ Test varchar types.\n",474],["T_WHITESPACE","    ",475],["T_FOREACH","foreach",475],["T_WHITESPACE"," ",475],"(",["T_ARRAY","array",475],"(",["T_LNUMBER","1",475],",",["T_WHITESPACE"," ",475],["T_LNUMBER","32",475],",",["T_WHITESPACE"," ",475],["T_LNUMBER","128",475],",",["T_WHITESPACE"," ",475],["T_LNUMBER","256",475],",",["T_WHITESPACE"," ",475],["T_LNUMBER","512",475],")",["T_WHITESPACE"," ",475],["T_AS","as",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$length",475],")",["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n      ",475],["T_VARIABLE","$base_field_spec",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_ARRAY","array",476],"(",["T_WHITESPACE","\n        ",476],["T_CONSTANT_ENCAPSED_STRING","'type'",477],["T_WHITESPACE"," ",477],["T_DOUBLE_ARROW","=>",477],["T_WHITESPACE"," ",477],["T_CONSTANT_ENCAPSED_STRING","'varchar'",477],",",["T_WHITESPACE","\n        ",477],["T_CONSTANT_ENCAPSED_STRING","'length'",478],["T_WHITESPACE"," ",478],["T_DOUBLE_ARROW","=>",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$length",478],",",["T_WHITESPACE","\n      ",478],")",";",["T_WHITESPACE","\n      ",479],["T_VARIABLE","$variations",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_ARRAY","array",480],"(",["T_WHITESPACE","\n        ",480],["T_ARRAY","array",481],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",481],["T_WHITESPACE"," ",481],["T_DOUBLE_ARROW","=>",481],["T_WHITESPACE"," ",481],["T_STRING","FALSE",481],")",",",["T_WHITESPACE","\n        ",481],["T_ARRAY","array",482],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",482],["T_WHITESPACE"," ",482],["T_DOUBLE_ARROW","=>",482],["T_WHITESPACE"," ",482],["T_STRING","FALSE",482],",",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'default'",482],["T_WHITESPACE"," ",482],["T_DOUBLE_ARROW","=>",482],["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'7'",482],")",",",["T_WHITESPACE","\n        ",482],["T_ARRAY","array",483],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_STRING","FALSE",483],",",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'default'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_STRING","substr",483],"(",["T_CONSTANT_ENCAPSED_STRING","'\"thing\"'",483],",",["T_WHITESPACE"," ",483],["T_LNUMBER","0",483],",",["T_WHITESPACE"," ",483],["T_VARIABLE","$length",483],")",")",",",["T_WHITESPACE","\n        ",483],["T_ARRAY","array",484],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",484],["T_WHITESPACE"," ",484],["T_DOUBLE_ARROW","=>",484],["T_WHITESPACE"," ",484],["T_STRING","FALSE",484],",",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'default'",484],["T_WHITESPACE"," ",484],["T_DOUBLE_ARROW","=>",484],["T_WHITESPACE"," ",484],["T_STRING","substr",484],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\\"'hing\"",484],",",["T_WHITESPACE"," ",484],["T_LNUMBER","0",484],",",["T_WHITESPACE"," ",484],["T_VARIABLE","$length",484],")",")",",",["T_WHITESPACE","\n        ",484],["T_ARRAY","array",485],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",485],["T_WHITESPACE"," ",485],["T_DOUBLE_ARROW","=>",485],["T_WHITESPACE"," ",485],["T_STRING","TRUE",485],",",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","'initial'",485],["T_WHITESPACE"," ",485],["T_DOUBLE_ARROW","=>",485],["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","'d'",485],")",",",["T_WHITESPACE","\n        ",485],["T_ARRAY","array",486],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",486],["T_WHITESPACE"," ",486],["T_DOUBLE_ARROW","=>",486],["T_WHITESPACE"," ",486],["T_STRING","FALSE",486],",",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'default'",486],["T_WHITESPACE"," ",486],["T_DOUBLE_ARROW","=>",486],["T_WHITESPACE"," ",486],["T_STRING","NULL",486],")",",",["T_WHITESPACE","\n        ",486],["T_ARRAY","array",487],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_STRING","TRUE",487],",",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'initial'",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'d'",487],",",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'default'",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'7'",487],")",",",["T_WHITESPACE","\n      ",487],")",";",["T_WHITESPACE","\n\n      ",488],["T_FOREACH","foreach",490],["T_WHITESPACE"," ",490],"(",["T_VARIABLE","$variations",490],["T_WHITESPACE"," ",490],["T_AS","as",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$variation",490],")",["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n        ",490],["T_VARIABLE","$field_spec",491],["T_WHITESPACE"," ",491],"=",["T_WHITESPACE"," ",491],["T_VARIABLE","$variation",491],["T_WHITESPACE"," ",491],"+",["T_WHITESPACE"," ",491],["T_VARIABLE","$base_field_spec",491],";",["T_WHITESPACE","\n        ",491],["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","assertFieldAdditionRemoval",492],"(",["T_VARIABLE","$field_spec",492],")",";",["T_WHITESPACE","\n      ",492],"}",["T_WHITESPACE","\n    ",493],"}",["T_WHITESPACE","\n\n    ",494],["T_COMMENT","\/\/ Test int and float types.\n",496],["T_WHITESPACE","    ",497],["T_FOREACH","foreach",497],["T_WHITESPACE"," ",497],"(",["T_ARRAY","array",497],"(",["T_CONSTANT_ENCAPSED_STRING","'int'",497],",",["T_WHITESPACE"," ",497],["T_CONSTANT_ENCAPSED_STRING","'float'",497],")",["T_WHITESPACE"," ",497],["T_AS","as",497],["T_WHITESPACE"," ",497],["T_VARIABLE","$type",497],")",["T_WHITESPACE"," ",497],"{",["T_WHITESPACE","\n      ",497],["T_FOREACH","foreach",498],["T_WHITESPACE"," ",498],"(",["T_ARRAY","array",498],"(",["T_CONSTANT_ENCAPSED_STRING","'tiny'",498],",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'small'",498],",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'medium'",498],",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'normal'",498],",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'big'",498],")",["T_WHITESPACE"," ",498],["T_AS","as",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$size",498],")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n        ",498],["T_VARIABLE","$base_field_spec",499],["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_ARRAY","array",499],"(",["T_WHITESPACE","\n          ",499],["T_CONSTANT_ENCAPSED_STRING","'type'",500],["T_WHITESPACE"," ",500],["T_DOUBLE_ARROW","=>",500],["T_WHITESPACE"," ",500],["T_VARIABLE","$type",500],",",["T_WHITESPACE","\n          ",500],["T_CONSTANT_ENCAPSED_STRING","'size'",501],["T_WHITESPACE"," ",501],["T_DOUBLE_ARROW","=>",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$size",501],",",["T_WHITESPACE","\n        ",501],")",";",["T_WHITESPACE","\n        ",502],["T_VARIABLE","$variations",503],["T_WHITESPACE"," ",503],"=",["T_WHITESPACE"," ",503],["T_ARRAY","array",503],"(",["T_WHITESPACE","\n          ",503],["T_ARRAY","array",504],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",504],["T_WHITESPACE"," ",504],["T_DOUBLE_ARROW","=>",504],["T_WHITESPACE"," ",504],["T_STRING","FALSE",504],")",",",["T_WHITESPACE","\n          ",504],["T_ARRAY","array",505],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",505],["T_WHITESPACE"," ",505],["T_DOUBLE_ARROW","=>",505],["T_WHITESPACE"," ",505],["T_STRING","FALSE",505],",",["T_WHITESPACE"," ",505],["T_CONSTANT_ENCAPSED_STRING","'default'",505],["T_WHITESPACE"," ",505],["T_DOUBLE_ARROW","=>",505],["T_WHITESPACE"," ",505],["T_LNUMBER","7",505],")",",",["T_WHITESPACE","\n          ",505],["T_ARRAY","array",506],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",506],["T_WHITESPACE"," ",506],["T_DOUBLE_ARROW","=>",506],["T_WHITESPACE"," ",506],["T_STRING","TRUE",506],",",["T_WHITESPACE"," ",506],["T_CONSTANT_ENCAPSED_STRING","'initial'",506],["T_WHITESPACE"," ",506],["T_DOUBLE_ARROW","=>",506],["T_WHITESPACE"," ",506],["T_LNUMBER","1",506],")",",",["T_WHITESPACE","\n          ",506],["T_ARRAY","array",507],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_STRING","TRUE",507],",",["T_WHITESPACE"," ",507],["T_CONSTANT_ENCAPSED_STRING","'initial'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_LNUMBER","1",507],",",["T_WHITESPACE"," ",507],["T_CONSTANT_ENCAPSED_STRING","'default'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_LNUMBER","7",507],")",",",["T_WHITESPACE","\n          ",507],["T_ARRAY","array",508],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",508],["T_WHITESPACE"," ",508],["T_DOUBLE_ARROW","=>",508],["T_WHITESPACE"," ",508],["T_STRING","TRUE",508],",",["T_WHITESPACE"," ",508],["T_CONSTANT_ENCAPSED_STRING","'initial_from_field'",508],["T_WHITESPACE"," ",508],["T_DOUBLE_ARROW","=>",508],["T_WHITESPACE"," ",508],["T_CONSTANT_ENCAPSED_STRING","'serial_column'",508],")",",",["T_WHITESPACE","\n        ",508],")",";",["T_WHITESPACE","\n\n        ",509],["T_FOREACH","foreach",511],["T_WHITESPACE"," ",511],"(",["T_VARIABLE","$variations",511],["T_WHITESPACE"," ",511],["T_AS","as",511],["T_WHITESPACE"," ",511],["T_VARIABLE","$variation",511],")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n          ",511],["T_VARIABLE","$field_spec",512],["T_WHITESPACE"," ",512],"=",["T_WHITESPACE"," ",512],["T_VARIABLE","$variation",512],["T_WHITESPACE"," ",512],"+",["T_WHITESPACE"," ",512],["T_VARIABLE","$base_field_spec",512],";",["T_WHITESPACE","\n          ",512],["T_VARIABLE","$this",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","assertFieldAdditionRemoval",513],"(",["T_VARIABLE","$field_spec",513],")",";",["T_WHITESPACE","\n        ",513],"}",["T_WHITESPACE","\n      ",514],"}",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n\n    ",516],["T_COMMENT","\/\/ Test numeric types.\n",518],["T_WHITESPACE","    ",519],["T_FOREACH","foreach",519],["T_WHITESPACE"," ",519],"(",["T_ARRAY","array",519],"(",["T_LNUMBER","1",519],",",["T_WHITESPACE"," ",519],["T_LNUMBER","5",519],",",["T_WHITESPACE"," ",519],["T_LNUMBER","10",519],",",["T_WHITESPACE"," ",519],["T_LNUMBER","40",519],",",["T_WHITESPACE"," ",519],["T_LNUMBER","65",519],")",["T_WHITESPACE"," ",519],["T_AS","as",519],["T_WHITESPACE"," ",519],["T_VARIABLE","$precision",519],")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n      ",519],["T_FOREACH","foreach",520],["T_WHITESPACE"," ",520],"(",["T_ARRAY","array",520],"(",["T_LNUMBER","0",520],",",["T_WHITESPACE"," ",520],["T_LNUMBER","2",520],",",["T_WHITESPACE"," ",520],["T_LNUMBER","10",520],",",["T_WHITESPACE"," ",520],["T_LNUMBER","30",520],")",["T_WHITESPACE"," ",520],["T_AS","as",520],["T_WHITESPACE"," ",520],["T_VARIABLE","$scale",520],")",["T_WHITESPACE"," ",520],"{",["T_WHITESPACE","\n        ",520],["T_COMMENT","\/\/ Skip combinations where precision is smaller than scale.\n",521],["T_WHITESPACE","        ",522],["T_IF","if",522],["T_WHITESPACE"," ",522],"(",["T_VARIABLE","$precision",522],["T_WHITESPACE"," ",522],["T_IS_SMALLER_OR_EQUAL","<=",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$scale",522],")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n          ",522],["T_CONTINUE","continue",523],";",["T_WHITESPACE","\n        ",523],"}",["T_WHITESPACE","\n\n        ",524],["T_VARIABLE","$base_field_spec",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_ARRAY","array",526],"(",["T_WHITESPACE","\n          ",526],["T_CONSTANT_ENCAPSED_STRING","'type'",527],["T_WHITESPACE"," ",527],["T_DOUBLE_ARROW","=>",527],["T_WHITESPACE"," ",527],["T_CONSTANT_ENCAPSED_STRING","'numeric'",527],",",["T_WHITESPACE","\n          ",527],["T_CONSTANT_ENCAPSED_STRING","'scale'",528],["T_WHITESPACE"," ",528],["T_DOUBLE_ARROW","=>",528],["T_WHITESPACE"," ",528],["T_VARIABLE","$scale",528],",",["T_WHITESPACE","\n          ",528],["T_CONSTANT_ENCAPSED_STRING","'precision'",529],["T_WHITESPACE"," ",529],["T_DOUBLE_ARROW","=>",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$precision",529],",",["T_WHITESPACE","\n        ",529],")",";",["T_WHITESPACE","\n        ",530],["T_VARIABLE","$variations",531],["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_ARRAY","array",531],"(",["T_WHITESPACE","\n          ",531],["T_ARRAY","array",532],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",532],["T_WHITESPACE"," ",532],["T_DOUBLE_ARROW","=>",532],["T_WHITESPACE"," ",532],["T_STRING","FALSE",532],")",",",["T_WHITESPACE","\n          ",532],["T_ARRAY","array",533],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",533],["T_WHITESPACE"," ",533],["T_DOUBLE_ARROW","=>",533],["T_WHITESPACE"," ",533],["T_STRING","FALSE",533],",",["T_WHITESPACE"," ",533],["T_CONSTANT_ENCAPSED_STRING","'default'",533],["T_WHITESPACE"," ",533],["T_DOUBLE_ARROW","=>",533],["T_WHITESPACE"," ",533],["T_LNUMBER","7",533],")",",",["T_WHITESPACE","\n          ",533],["T_ARRAY","array",534],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",534],["T_WHITESPACE"," ",534],["T_DOUBLE_ARROW","=>",534],["T_WHITESPACE"," ",534],["T_STRING","TRUE",534],",",["T_WHITESPACE"," ",534],["T_CONSTANT_ENCAPSED_STRING","'initial'",534],["T_WHITESPACE"," ",534],["T_DOUBLE_ARROW","=>",534],["T_WHITESPACE"," ",534],["T_LNUMBER","1",534],")",",",["T_WHITESPACE","\n          ",534],["T_ARRAY","array",535],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",535],["T_WHITESPACE"," ",535],["T_DOUBLE_ARROW","=>",535],["T_WHITESPACE"," ",535],["T_STRING","TRUE",535],",",["T_WHITESPACE"," ",535],["T_CONSTANT_ENCAPSED_STRING","'initial'",535],["T_WHITESPACE"," ",535],["T_DOUBLE_ARROW","=>",535],["T_WHITESPACE"," ",535],["T_LNUMBER","1",535],",",["T_WHITESPACE"," ",535],["T_CONSTANT_ENCAPSED_STRING","'default'",535],["T_WHITESPACE"," ",535],["T_DOUBLE_ARROW","=>",535],["T_WHITESPACE"," ",535],["T_LNUMBER","7",535],")",",",["T_WHITESPACE","\n          ",535],["T_ARRAY","array",536],"(",["T_CONSTANT_ENCAPSED_STRING","'not null'",536],["T_WHITESPACE"," ",536],["T_DOUBLE_ARROW","=>",536],["T_WHITESPACE"," ",536],["T_STRING","TRUE",536],",",["T_WHITESPACE"," ",536],["T_CONSTANT_ENCAPSED_STRING","'initial_from_field'",536],["T_WHITESPACE"," ",536],["T_DOUBLE_ARROW","=>",536],["T_WHITESPACE"," ",536],["T_CONSTANT_ENCAPSED_STRING","'serial_column'",536],")",",",["T_WHITESPACE","\n        ",536],")",";",["T_WHITESPACE","\n\n        ",537],["T_FOREACH","foreach",539],["T_WHITESPACE"," ",539],"(",["T_VARIABLE","$variations",539],["T_WHITESPACE"," ",539],["T_AS","as",539],["T_WHITESPACE"," ",539],["T_VARIABLE","$variation",539],")",["T_WHITESPACE"," ",539],"{",["T_WHITESPACE","\n          ",539],["T_VARIABLE","$field_spec",540],["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_VARIABLE","$variation",540],["T_WHITESPACE"," ",540],"+",["T_WHITESPACE"," ",540],["T_VARIABLE","$base_field_spec",540],";",["T_WHITESPACE","\n          ",540],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","assertFieldAdditionRemoval",541],"(",["T_VARIABLE","$field_spec",541],")",";",["T_WHITESPACE","\n        ",541],"}",["T_WHITESPACE","\n      ",542],"}",["T_WHITESPACE","\n    ",543],"}",["T_WHITESPACE","\n  ",544],"}",["T_WHITESPACE","\n\n  ",545],["T_DOC_COMMENT","\/**\n   * Asserts that a given field can be added and removed from a table.\n   *\n   * The addition test covers both defining a field of a given specification\n   * when initially creating at table and extending an existing table.\n   *\n   * @param $field_spec\n   *   The schema specification of the field.\n   *\/",547],["T_WHITESPACE","\n  ",555],["T_PROTECTED","protected",556],["T_WHITESPACE"," ",556],["T_FUNCTION","function",556],["T_WHITESPACE"," ",556],["T_STRING","assertFieldAdditionRemoval",556],"(",["T_VARIABLE","$field_spec",556],")",["T_WHITESPACE"," ",556],"{",["T_WHITESPACE","\n    ",556],["T_COMMENT","\/\/ Try creating the field on a new table.\n",557],["T_WHITESPACE","    ",558],["T_VARIABLE","$table_name",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","'test_table_'",558],["T_WHITESPACE"," ",558],".",["T_WHITESPACE"," ",558],"(",["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","counter",558],["T_INC","++",558],")",";",["T_WHITESPACE","\n    ",558],["T_VARIABLE","$table_spec",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_ARRAY","array",559],"(",["T_WHITESPACE","\n      ",559],["T_CONSTANT_ENCAPSED_STRING","'fields'",560],["T_WHITESPACE"," ",560],["T_DOUBLE_ARROW","=>",560],["T_WHITESPACE"," ",560],["T_ARRAY","array",560],"(",["T_WHITESPACE","\n        ",560],["T_CONSTANT_ENCAPSED_STRING","'serial_column'",561],["T_WHITESPACE"," ",561],["T_DOUBLE_ARROW","=>",561],["T_WHITESPACE"," ",561],["T_ARRAY","array",561],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",561],["T_WHITESPACE"," ",561],["T_DOUBLE_ARROW","=>",561],["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","'serial'",561],",",["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",561],["T_WHITESPACE"," ",561],["T_DOUBLE_ARROW","=>",561],["T_WHITESPACE"," ",561],["T_STRING","TRUE",561],",",["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","'not null'",561],["T_WHITESPACE"," ",561],["T_DOUBLE_ARROW","=>",561],["T_WHITESPACE"," ",561],["T_STRING","TRUE",561],")",",",["T_WHITESPACE","\n        ",561],["T_CONSTANT_ENCAPSED_STRING","'test_field'",562],["T_WHITESPACE"," ",562],["T_DOUBLE_ARROW","=>",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$field_spec",562],",",["T_WHITESPACE","\n      ",562],")",",",["T_WHITESPACE","\n      ",563],["T_CONSTANT_ENCAPSED_STRING","'primary key'",564],["T_WHITESPACE"," ",564],["T_DOUBLE_ARROW","=>",564],["T_WHITESPACE"," ",564],["T_ARRAY","array",564],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",564],")",",",["T_WHITESPACE","\n    ",564],")",";",["T_WHITESPACE","\n    ",565],["T_STRING","db_create_table",566],"(",["T_VARIABLE","$table_name",566],",",["T_WHITESPACE"," ",566],["T_VARIABLE","$table_spec",566],")",";",["T_WHITESPACE","\n    ",566],["T_VARIABLE","$this",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","pass",567],"(",["T_STRING","format_string",567],"(",["T_CONSTANT_ENCAPSED_STRING","'Table %table created.'",567],",",["T_WHITESPACE"," ",567],["T_ARRAY","array",567],"(",["T_CONSTANT_ENCAPSED_STRING","'%table'",567],["T_WHITESPACE"," ",567],["T_DOUBLE_ARROW","=>",567],["T_WHITESPACE"," ",567],["T_VARIABLE","$table_name",567],")",")",")",";",["T_WHITESPACE","\n\n    ",567],["T_COMMENT","\/\/ Check the characteristics of the field.\n",569],["T_WHITESPACE","    ",570],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","assertFieldCharacteristics",570],"(",["T_VARIABLE","$table_name",570],",",["T_WHITESPACE"," ",570],["T_CONSTANT_ENCAPSED_STRING","'test_field'",570],",",["T_WHITESPACE"," ",570],["T_VARIABLE","$field_spec",570],")",";",["T_WHITESPACE","\n\n    ",570],["T_COMMENT","\/\/ Clean-up.\n",572],["T_WHITESPACE","    ",573],["T_STRING","db_drop_table",573],"(",["T_VARIABLE","$table_name",573],")",";",["T_WHITESPACE","\n\n    ",573],["T_COMMENT","\/\/ Try adding a field to an existing table.\n",575],["T_WHITESPACE","    ",576],["T_VARIABLE","$table_name",576],["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_CONSTANT_ENCAPSED_STRING","'test_table_'",576],["T_WHITESPACE"," ",576],".",["T_WHITESPACE"," ",576],"(",["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","counter",576],["T_INC","++",576],")",";",["T_WHITESPACE","\n    ",576],["T_VARIABLE","$table_spec",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_ARRAY","array",577],"(",["T_WHITESPACE","\n      ",577],["T_CONSTANT_ENCAPSED_STRING","'fields'",578],["T_WHITESPACE"," ",578],["T_DOUBLE_ARROW","=>",578],["T_WHITESPACE"," ",578],["T_ARRAY","array",578],"(",["T_WHITESPACE","\n        ",578],["T_CONSTANT_ENCAPSED_STRING","'serial_column'",579],["T_WHITESPACE"," ",579],["T_DOUBLE_ARROW","=>",579],["T_WHITESPACE"," ",579],["T_ARRAY","array",579],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",579],["T_WHITESPACE"," ",579],["T_DOUBLE_ARROW","=>",579],["T_WHITESPACE"," ",579],["T_CONSTANT_ENCAPSED_STRING","'serial'",579],",",["T_WHITESPACE"," ",579],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",579],["T_WHITESPACE"," ",579],["T_DOUBLE_ARROW","=>",579],["T_WHITESPACE"," ",579],["T_STRING","TRUE",579],",",["T_WHITESPACE"," ",579],["T_CONSTANT_ENCAPSED_STRING","'not null'",579],["T_WHITESPACE"," ",579],["T_DOUBLE_ARROW","=>",579],["T_WHITESPACE"," ",579],["T_STRING","TRUE",579],")",",",["T_WHITESPACE","\n      ",579],")",",",["T_WHITESPACE","\n      ",580],["T_CONSTANT_ENCAPSED_STRING","'primary key'",581],["T_WHITESPACE"," ",581],["T_DOUBLE_ARROW","=>",581],["T_WHITESPACE"," ",581],["T_ARRAY","array",581],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",581],")",",",["T_WHITESPACE","\n    ",581],")",";",["T_WHITESPACE","\n    ",582],["T_STRING","db_create_table",583],"(",["T_VARIABLE","$table_name",583],",",["T_WHITESPACE"," ",583],["T_VARIABLE","$table_spec",583],")",";",["T_WHITESPACE","\n    ",583],["T_VARIABLE","$this",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","pass",584],"(",["T_STRING","format_string",584],"(",["T_CONSTANT_ENCAPSED_STRING","'Table %table created.'",584],",",["T_WHITESPACE"," ",584],["T_ARRAY","array",584],"(",["T_CONSTANT_ENCAPSED_STRING","'%table'",584],["T_WHITESPACE"," ",584],["T_DOUBLE_ARROW","=>",584],["T_WHITESPACE"," ",584],["T_VARIABLE","$table_name",584],")",")",")",";",["T_WHITESPACE","\n\n    ",584],["T_COMMENT","\/\/ Insert some rows to the table to test the handling of initial values.\n",586],["T_WHITESPACE","    ",587],["T_FOR","for",587],["T_WHITESPACE"," ",587],"(",["T_VARIABLE","$i",587],["T_WHITESPACE"," ",587],"=",["T_WHITESPACE"," ",587],["T_LNUMBER","0",587],";",["T_WHITESPACE"," ",587],["T_VARIABLE","$i",587],["T_WHITESPACE"," ",587],"<",["T_WHITESPACE"," ",587],["T_LNUMBER","3",587],";",["T_WHITESPACE"," ",587],["T_VARIABLE","$i",587],["T_INC","++",587],")",["T_WHITESPACE"," ",587],"{",["T_WHITESPACE","\n      ",587],["T_STRING","db_insert",588],"(",["T_VARIABLE","$table_name",588],")",["T_WHITESPACE","\n        ",588],["T_OBJECT_OPERATOR","->",589],["T_STRING","useDefaults",589],"(",["T_ARRAY","array",589],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",589],")",")",["T_WHITESPACE","\n        ",589],["T_OBJECT_OPERATOR","->",590],["T_STRING","execute",590],"(",")",";",["T_WHITESPACE","\n    ",590],"}",["T_WHITESPACE","\n\n    ",591],["T_STRING","db_add_field",593],"(",["T_VARIABLE","$table_name",593],",",["T_WHITESPACE"," ",593],["T_CONSTANT_ENCAPSED_STRING","'test_field'",593],",",["T_WHITESPACE"," ",593],["T_VARIABLE","$field_spec",593],")",";",["T_WHITESPACE","\n    ",593],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","pass",594],"(",["T_STRING","format_string",594],"(",["T_CONSTANT_ENCAPSED_STRING","'Column %column created.'",594],",",["T_WHITESPACE"," ",594],["T_ARRAY","array",594],"(",["T_CONSTANT_ENCAPSED_STRING","'%column'",594],["T_WHITESPACE"," ",594],["T_DOUBLE_ARROW","=>",594],["T_WHITESPACE"," ",594],["T_CONSTANT_ENCAPSED_STRING","'test_field'",594],")",")",")",";",["T_WHITESPACE","\n\n    ",594],["T_COMMENT","\/\/ Check the characteristics of the field.\n",596],["T_WHITESPACE","    ",597],["T_VARIABLE","$this",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","assertFieldCharacteristics",597],"(",["T_VARIABLE","$table_name",597],",",["T_WHITESPACE"," ",597],["T_CONSTANT_ENCAPSED_STRING","'test_field'",597],",",["T_WHITESPACE"," ",597],["T_VARIABLE","$field_spec",597],")",";",["T_WHITESPACE","\n\n    ",597],["T_COMMENT","\/\/ Clean-up.\n",599],["T_WHITESPACE","    ",600],["T_STRING","db_drop_field",600],"(",["T_VARIABLE","$table_name",600],",",["T_WHITESPACE"," ",600],["T_CONSTANT_ENCAPSED_STRING","'test_field'",600],")",";",["T_WHITESPACE","\n\n    ",600],["T_COMMENT","\/\/ Add back the field and then try to delete a field which is also a primary\n",602],["T_WHITESPACE","    ",603],["T_COMMENT","\/\/ key.\n",603],["T_WHITESPACE","    ",604],["T_STRING","db_add_field",604],"(",["T_VARIABLE","$table_name",604],",",["T_WHITESPACE"," ",604],["T_CONSTANT_ENCAPSED_STRING","'test_field'",604],",",["T_WHITESPACE"," ",604],["T_VARIABLE","$field_spec",604],")",";",["T_WHITESPACE","\n    ",604],["T_STRING","db_drop_field",605],"(",["T_VARIABLE","$table_name",605],",",["T_WHITESPACE"," ",605],["T_CONSTANT_ENCAPSED_STRING","'serial_column'",605],")",";",["T_WHITESPACE","\n    ",605],["T_STRING","db_drop_table",606],"(",["T_VARIABLE","$table_name",606],")",";",["T_WHITESPACE","\n  ",606],"}",["T_WHITESPACE","\n\n  ",607],["T_DOC_COMMENT","\/**\n   * Asserts that a newly added field has the correct characteristics.\n   *\/",609],["T_WHITESPACE","\n  ",611],["T_PROTECTED","protected",612],["T_WHITESPACE"," ",612],["T_FUNCTION","function",612],["T_WHITESPACE"," ",612],["T_STRING","assertFieldCharacteristics",612],"(",["T_VARIABLE","$table_name",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$field_name",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$field_spec",612],")",["T_WHITESPACE"," ",612],"{",["T_WHITESPACE","\n    ",612],["T_COMMENT","\/\/ Check that the initial value has been registered.\n",613],["T_WHITESPACE","    ",614],["T_IF","if",614],["T_WHITESPACE"," ",614],"(",["T_ISSET","isset",614],"(",["T_VARIABLE","$field_spec",614],"[",["T_CONSTANT_ENCAPSED_STRING","'initial'",614],"]",")",")",["T_WHITESPACE"," ",614],"{",["T_WHITESPACE","\n      ",614],["T_COMMENT","\/\/ There should be no row with a value different then $field_spec['initial'].\n",615],["T_WHITESPACE","      ",616],["T_VARIABLE","$count",616],["T_WHITESPACE"," ",616],"=",["T_WHITESPACE"," ",616],["T_STRING","db_select",616],"(",["T_VARIABLE","$table_name",616],")",["T_WHITESPACE","\n        ",616],["T_OBJECT_OPERATOR","->",617],["T_STRING","fields",617],"(",["T_VARIABLE","$table_name",617],",",["T_WHITESPACE"," ",617],["T_ARRAY","array",617],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",617],")",")",["T_WHITESPACE","\n        ",617],["T_OBJECT_OPERATOR","->",618],["T_STRING","condition",618],"(",["T_VARIABLE","$field_name",618],",",["T_WHITESPACE"," ",618],["T_VARIABLE","$field_spec",618],"[",["T_CONSTANT_ENCAPSED_STRING","'initial'",618],"]",",",["T_WHITESPACE"," ",618],["T_CONSTANT_ENCAPSED_STRING","'<>'",618],")",["T_WHITESPACE","\n        ",618],["T_OBJECT_OPERATOR","->",619],["T_STRING","countQuery",619],"(",")",["T_WHITESPACE","\n        ",619],["T_OBJECT_OPERATOR","->",620],["T_STRING","execute",620],"(",")",["T_WHITESPACE","\n        ",620],["T_OBJECT_OPERATOR","->",621],["T_STRING","fetchField",621],"(",")",";",["T_WHITESPACE","\n      ",621],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","assertEqual",622],"(",["T_VARIABLE","$count",622],",",["T_WHITESPACE"," ",622],["T_LNUMBER","0",622],",",["T_WHITESPACE"," ",622],["T_CONSTANT_ENCAPSED_STRING","'Initial values filled out.'",622],")",";",["T_WHITESPACE","\n    ",622],"}",["T_WHITESPACE","\n\n    ",623],["T_COMMENT","\/\/ Check that the initial value from another field has been registered.\n",625],["T_WHITESPACE","    ",626],["T_IF","if",626],["T_WHITESPACE"," ",626],"(",["T_ISSET","isset",626],"(",["T_VARIABLE","$field_spec",626],"[",["T_CONSTANT_ENCAPSED_STRING","'initial_from_field'",626],"]",")",")",["T_WHITESPACE"," ",626],"{",["T_WHITESPACE","\n      ",626],["T_COMMENT","\/\/ There should be no row with a value different than\n",627],["T_WHITESPACE","      ",628],["T_COMMENT","\/\/ $field_spec['initial_from_field'].\n",628],["T_WHITESPACE","      ",629],["T_VARIABLE","$count",629],["T_WHITESPACE"," ",629],"=",["T_WHITESPACE"," ",629],["T_STRING","db_select",629],"(",["T_VARIABLE","$table_name",629],")",["T_WHITESPACE","\n        ",629],["T_OBJECT_OPERATOR","->",630],["T_STRING","fields",630],"(",["T_VARIABLE","$table_name",630],",",["T_WHITESPACE"," ",630],["T_ARRAY","array",630],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",630],")",")",["T_WHITESPACE","\n        ",630],["T_OBJECT_OPERATOR","->",631],["T_STRING","where",631],"(",["T_VARIABLE","$table_name",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'.'",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_VARIABLE","$field_spec",631],"[",["T_CONSTANT_ENCAPSED_STRING","'initial_from_field'",631],"]",["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","' <> '",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_VARIABLE","$table_name",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'.'",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_VARIABLE","$field_name",631],")",["T_WHITESPACE","\n        ",631],["T_OBJECT_OPERATOR","->",632],["T_STRING","countQuery",632],"(",")",["T_WHITESPACE","\n        ",632],["T_OBJECT_OPERATOR","->",633],["T_STRING","execute",633],"(",")",["T_WHITESPACE","\n        ",633],["T_OBJECT_OPERATOR","->",634],["T_STRING","fetchField",634],"(",")",";",["T_WHITESPACE","\n      ",634],["T_VARIABLE","$this",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","assertEqual",635],"(",["T_VARIABLE","$count",635],",",["T_WHITESPACE"," ",635],["T_LNUMBER","0",635],",",["T_WHITESPACE"," ",635],["T_CONSTANT_ENCAPSED_STRING","'Initial values from another field filled out.'",635],")",";",["T_WHITESPACE","\n    ",635],"}",["T_WHITESPACE","\n\n    ",636],["T_COMMENT","\/\/ Check that the default value has been registered.\n",638],["T_WHITESPACE","    ",639],["T_IF","if",639],["T_WHITESPACE"," ",639],"(",["T_ISSET","isset",639],"(",["T_VARIABLE","$field_spec",639],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",639],"]",")",")",["T_WHITESPACE"," ",639],"{",["T_WHITESPACE","\n      ",639],["T_COMMENT","\/\/ Try inserting a row, and check the resulting value of the new column.\n",640],["T_WHITESPACE","      ",641],["T_VARIABLE","$id",641],["T_WHITESPACE"," ",641],"=",["T_WHITESPACE"," ",641],["T_STRING","db_insert",641],"(",["T_VARIABLE","$table_name",641],")",["T_WHITESPACE","\n        ",641],["T_OBJECT_OPERATOR","->",642],["T_STRING","useDefaults",642],"(",["T_ARRAY","array",642],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",642],")",")",["T_WHITESPACE","\n        ",642],["T_OBJECT_OPERATOR","->",643],["T_STRING","execute",643],"(",")",";",["T_WHITESPACE","\n      ",643],["T_VARIABLE","$field_value",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_STRING","db_select",644],"(",["T_VARIABLE","$table_name",644],")",["T_WHITESPACE","\n        ",644],["T_OBJECT_OPERATOR","->",645],["T_STRING","fields",645],"(",["T_VARIABLE","$table_name",645],",",["T_WHITESPACE"," ",645],["T_ARRAY","array",645],"(",["T_VARIABLE","$field_name",645],")",")",["T_WHITESPACE","\n        ",645],["T_OBJECT_OPERATOR","->",646],["T_STRING","condition",646],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",646],",",["T_WHITESPACE"," ",646],["T_VARIABLE","$id",646],")",["T_WHITESPACE","\n        ",646],["T_OBJECT_OPERATOR","->",647],["T_STRING","execute",647],"(",")",["T_WHITESPACE","\n        ",647],["T_OBJECT_OPERATOR","->",648],["T_STRING","fetchField",648],"(",")",";",["T_WHITESPACE","\n      ",648],["T_VARIABLE","$this",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","assertEqual",649],"(",["T_VARIABLE","$field_value",649],",",["T_WHITESPACE"," ",649],["T_VARIABLE","$field_spec",649],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",649],"]",",",["T_WHITESPACE"," ",649],["T_CONSTANT_ENCAPSED_STRING","'Default value registered.'",649],")",";",["T_WHITESPACE","\n    ",649],"}",["T_WHITESPACE","\n  ",650],"}",["T_WHITESPACE","\n\n  ",651],["T_DOC_COMMENT","\/**\n   * Tests changing columns between types.\n   *\/",653],["T_WHITESPACE","\n  ",655],["T_FUNCTION","function",656],["T_WHITESPACE"," ",656],["T_STRING","testSchemaChangeField",656],"(",")",["T_WHITESPACE"," ",656],"{",["T_WHITESPACE","\n    ",656],["T_VARIABLE","$field_specs",657],["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],["T_ARRAY","array",657],"(",["T_WHITESPACE","\n      ",657],["T_ARRAY","array",658],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",658],["T_WHITESPACE"," ",658],["T_DOUBLE_ARROW","=>",658],["T_WHITESPACE"," ",658],["T_CONSTANT_ENCAPSED_STRING","'int'",658],",",["T_WHITESPACE"," ",658],["T_CONSTANT_ENCAPSED_STRING","'size'",658],["T_WHITESPACE"," ",658],["T_DOUBLE_ARROW","=>",658],["T_WHITESPACE"," ",658],["T_CONSTANT_ENCAPSED_STRING","'normal'",658],",",["T_WHITESPACE"," ",658],["T_CONSTANT_ENCAPSED_STRING","'not null'",658],["T_WHITESPACE"," ",658],["T_DOUBLE_ARROW","=>",658],["T_WHITESPACE"," ",658],["T_STRING","FALSE",658],")",",",["T_WHITESPACE","\n      ",658],["T_ARRAY","array",659],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",659],["T_WHITESPACE"," ",659],["T_DOUBLE_ARROW","=>",659],["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'int'",659],",",["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'size'",659],["T_WHITESPACE"," ",659],["T_DOUBLE_ARROW","=>",659],["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'normal'",659],",",["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'not null'",659],["T_WHITESPACE"," ",659],["T_DOUBLE_ARROW","=>",659],["T_WHITESPACE"," ",659],["T_STRING","TRUE",659],",",["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'initial'",659],["T_WHITESPACE"," ",659],["T_DOUBLE_ARROW","=>",659],["T_WHITESPACE"," ",659],["T_LNUMBER","1",659],",",["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'default'",659],["T_WHITESPACE"," ",659],["T_DOUBLE_ARROW","=>",659],["T_WHITESPACE"," ",659],["T_LNUMBER","17",659],")",",",["T_WHITESPACE","\n      ",659],["T_ARRAY","array",660],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",660],["T_WHITESPACE"," ",660],["T_DOUBLE_ARROW","=>",660],["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","'float'",660],",",["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","'size'",660],["T_WHITESPACE"," ",660],["T_DOUBLE_ARROW","=>",660],["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","'normal'",660],",",["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","'not null'",660],["T_WHITESPACE"," ",660],["T_DOUBLE_ARROW","=>",660],["T_WHITESPACE"," ",660],["T_STRING","FALSE",660],")",",",["T_WHITESPACE","\n      ",660],["T_ARRAY","array",661],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",661],["T_WHITESPACE"," ",661],["T_DOUBLE_ARROW","=>",661],["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","'float'",661],",",["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","'size'",661],["T_WHITESPACE"," ",661],["T_DOUBLE_ARROW","=>",661],["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","'normal'",661],",",["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","'not null'",661],["T_WHITESPACE"," ",661],["T_DOUBLE_ARROW","=>",661],["T_WHITESPACE"," ",661],["T_STRING","TRUE",661],",",["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","'initial'",661],["T_WHITESPACE"," ",661],["T_DOUBLE_ARROW","=>",661],["T_WHITESPACE"," ",661],["T_LNUMBER","1",661],",",["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","'default'",661],["T_WHITESPACE"," ",661],["T_DOUBLE_ARROW","=>",661],["T_WHITESPACE"," ",661],["T_DNUMBER","7.3",661],")",",",["T_WHITESPACE","\n      ",661],["T_ARRAY","array",662],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",662],["T_WHITESPACE"," ",662],["T_DOUBLE_ARROW","=>",662],["T_WHITESPACE"," ",662],["T_CONSTANT_ENCAPSED_STRING","'numeric'",662],",",["T_WHITESPACE"," ",662],["T_CONSTANT_ENCAPSED_STRING","'scale'",662],["T_WHITESPACE"," ",662],["T_DOUBLE_ARROW","=>",662],["T_WHITESPACE"," ",662],["T_LNUMBER","2",662],",",["T_WHITESPACE"," ",662],["T_CONSTANT_ENCAPSED_STRING","'precision'",662],["T_WHITESPACE"," ",662],["T_DOUBLE_ARROW","=>",662],["T_WHITESPACE"," ",662],["T_LNUMBER","10",662],",",["T_WHITESPACE"," ",662],["T_CONSTANT_ENCAPSED_STRING","'not null'",662],["T_WHITESPACE"," ",662],["T_DOUBLE_ARROW","=>",662],["T_WHITESPACE"," ",662],["T_STRING","FALSE",662],")",",",["T_WHITESPACE","\n      ",662],["T_ARRAY","array",663],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'numeric'",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'scale'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_LNUMBER","2",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'precision'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_LNUMBER","10",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'not null'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_STRING","TRUE",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'initial'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_LNUMBER","1",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'default'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_LNUMBER","7",663],")",",",["T_WHITESPACE","\n    ",663],")",";",["T_WHITESPACE","\n\n    ",664],["T_FOREACH","foreach",666],["T_WHITESPACE"," ",666],"(",["T_VARIABLE","$field_specs",666],["T_WHITESPACE"," ",666],["T_AS","as",666],["T_WHITESPACE"," ",666],["T_VARIABLE","$i",666],["T_WHITESPACE"," ",666],["T_DOUBLE_ARROW","=>",666],["T_WHITESPACE"," ",666],["T_VARIABLE","$old_spec",666],")",["T_WHITESPACE"," ",666],"{",["T_WHITESPACE","\n      ",666],["T_FOREACH","foreach",667],["T_WHITESPACE"," ",667],"(",["T_VARIABLE","$field_specs",667],["T_WHITESPACE"," ",667],["T_AS","as",667],["T_WHITESPACE"," ",667],["T_VARIABLE","$j",667],["T_WHITESPACE"," ",667],["T_DOUBLE_ARROW","=>",667],["T_WHITESPACE"," ",667],["T_VARIABLE","$new_spec",667],")",["T_WHITESPACE"," ",667],"{",["T_WHITESPACE","\n        ",667],["T_IF","if",668],["T_WHITESPACE"," ",668],"(",["T_VARIABLE","$i",668],["T_WHITESPACE"," ",668],["T_IS_IDENTICAL","===",668],["T_WHITESPACE"," ",668],["T_VARIABLE","$j",668],")",["T_WHITESPACE"," ",668],"{",["T_WHITESPACE","\n          ",668],["T_COMMENT","\/\/ Do not change a field into itself.\n",669],["T_WHITESPACE","          ",670],["T_CONTINUE","continue",670],";",["T_WHITESPACE","\n        ",670],"}",["T_WHITESPACE","\n        ",671],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","assertFieldChange",672],"(",["T_VARIABLE","$old_spec",672],",",["T_WHITESPACE"," ",672],["T_VARIABLE","$new_spec",672],")",";",["T_WHITESPACE","\n      ",672],"}",["T_WHITESPACE","\n    ",673],"}",["T_WHITESPACE","\n\n    ",674],["T_VARIABLE","$field_specs",676],["T_WHITESPACE"," ",676],"=",["T_WHITESPACE"," ",676],["T_ARRAY","array",676],"(",["T_WHITESPACE","\n      ",676],["T_ARRAY","array",677],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",677],["T_WHITESPACE"," ",677],["T_DOUBLE_ARROW","=>",677],["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii'",677],",",["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'length'",677],["T_WHITESPACE"," ",677],["T_DOUBLE_ARROW","=>",677],["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'255'",677],")",",",["T_WHITESPACE","\n      ",677],["T_ARRAY","array",678],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",678],["T_WHITESPACE"," ",678],["T_DOUBLE_ARROW","=>",678],["T_WHITESPACE"," ",678],["T_CONSTANT_ENCAPSED_STRING","'varchar'",678],",",["T_WHITESPACE"," ",678],["T_CONSTANT_ENCAPSED_STRING","'length'",678],["T_WHITESPACE"," ",678],["T_DOUBLE_ARROW","=>",678],["T_WHITESPACE"," ",678],["T_CONSTANT_ENCAPSED_STRING","'255'",678],")",",",["T_WHITESPACE","\n      ",678],["T_ARRAY","array",679],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",679],["T_WHITESPACE"," ",679],["T_DOUBLE_ARROW","=>",679],["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'text'",679],")",",",["T_WHITESPACE","\n      ",679],["T_ARRAY","array",680],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",680],["T_WHITESPACE"," ",680],["T_DOUBLE_ARROW","=>",680],["T_WHITESPACE"," ",680],["T_CONSTANT_ENCAPSED_STRING","'blob'",680],",",["T_WHITESPACE"," ",680],["T_CONSTANT_ENCAPSED_STRING","'size'",680],["T_WHITESPACE"," ",680],["T_DOUBLE_ARROW","=>",680],["T_WHITESPACE"," ",680],["T_CONSTANT_ENCAPSED_STRING","'big'",680],")",",",["T_WHITESPACE","\n    ",680],")",";",["T_WHITESPACE","\n\n    ",681],["T_FOREACH","foreach",683],["T_WHITESPACE"," ",683],"(",["T_VARIABLE","$field_specs",683],["T_WHITESPACE"," ",683],["T_AS","as",683],["T_WHITESPACE"," ",683],["T_VARIABLE","$i",683],["T_WHITESPACE"," ",683],["T_DOUBLE_ARROW","=>",683],["T_WHITESPACE"," ",683],["T_VARIABLE","$old_spec",683],")",["T_WHITESPACE"," ",683],"{",["T_WHITESPACE","\n      ",683],["T_FOREACH","foreach",684],["T_WHITESPACE"," ",684],"(",["T_VARIABLE","$field_specs",684],["T_WHITESPACE"," ",684],["T_AS","as",684],["T_WHITESPACE"," ",684],["T_VARIABLE","$j",684],["T_WHITESPACE"," ",684],["T_DOUBLE_ARROW","=>",684],["T_WHITESPACE"," ",684],["T_VARIABLE","$new_spec",684],")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n        ",684],["T_IF","if",685],["T_WHITESPACE"," ",685],"(",["T_VARIABLE","$i",685],["T_WHITESPACE"," ",685],["T_IS_IDENTICAL","===",685],["T_WHITESPACE"," ",685],["T_VARIABLE","$j",685],")",["T_WHITESPACE"," ",685],"{",["T_WHITESPACE","\n          ",685],["T_COMMENT","\/\/ Do not change a field into itself.\n",686],["T_WHITESPACE","          ",687],["T_CONTINUE","continue",687],";",["T_WHITESPACE","\n        ",687],"}",["T_WHITESPACE","\n        ",688],["T_COMMENT","\/\/ Note if the serialized data contained an object this would fail on\n",689],["T_WHITESPACE","        ",690],["T_COMMENT","\/\/ Postgres.\n",690],["T_WHITESPACE","        ",691],["T_COMMENT","\/\/ @see https:\/\/www.drupal.org\/node\/1031122\n",691],["T_WHITESPACE","        ",692],["T_VARIABLE","$this",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","assertFieldChange",692],"(",["T_VARIABLE","$old_spec",692],",",["T_WHITESPACE"," ",692],["T_VARIABLE","$new_spec",692],",",["T_WHITESPACE"," ",692],["T_STRING","serialize",692],"(","[",["T_CONSTANT_ENCAPSED_STRING","'string'",692],["T_WHITESPACE"," ",692],["T_DOUBLE_ARROW","=>",692],["T_WHITESPACE"," ",692],["T_CONSTANT_ENCAPSED_STRING","\"This \\n has \\\\\\\\ some backslash \\\"*string action.\\\\n\"",692],"]",")",")",";",["T_WHITESPACE","\n      ",692],"}",["T_WHITESPACE","\n    ",693],"}",["T_WHITESPACE","\n\n  ",694],"}",["T_WHITESPACE","\n\n  ",696],["T_DOC_COMMENT","\/**\n   * Asserts that a field can be changed from one spec to another.\n   *\n   * @param $old_spec\n   *   The beginning field specification.\n   * @param $new_spec\n   *   The ending field specification.\n   *\/",698],["T_WHITESPACE","\n  ",705],["T_PROTECTED","protected",706],["T_WHITESPACE"," ",706],["T_FUNCTION","function",706],["T_WHITESPACE"," ",706],["T_STRING","assertFieldChange",706],"(",["T_VARIABLE","$old_spec",706],",",["T_WHITESPACE"," ",706],["T_VARIABLE","$new_spec",706],",",["T_WHITESPACE"," ",706],["T_VARIABLE","$test_data",706],["T_WHITESPACE"," ",706],"=",["T_WHITESPACE"," ",706],["T_STRING","NULL",706],")",["T_WHITESPACE"," ",706],"{",["T_WHITESPACE","\n    ",706],["T_VARIABLE","$table_name",707],["T_WHITESPACE"," ",707],"=",["T_WHITESPACE"," ",707],["T_CONSTANT_ENCAPSED_STRING","'test_table_'",707],["T_WHITESPACE"," ",707],".",["T_WHITESPACE"," ",707],"(",["T_VARIABLE","$this",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","counter",707],["T_INC","++",707],")",";",["T_WHITESPACE","\n    ",707],["T_VARIABLE","$table_spec",708],["T_WHITESPACE"," ",708],"=",["T_WHITESPACE"," ",708],["T_ARRAY","array",708],"(",["T_WHITESPACE","\n      ",708],["T_CONSTANT_ENCAPSED_STRING","'fields'",709],["T_WHITESPACE"," ",709],["T_DOUBLE_ARROW","=>",709],["T_WHITESPACE"," ",709],["T_ARRAY","array",709],"(",["T_WHITESPACE","\n        ",709],["T_CONSTANT_ENCAPSED_STRING","'serial_column'",710],["T_WHITESPACE"," ",710],["T_DOUBLE_ARROW","=>",710],["T_WHITESPACE"," ",710],["T_ARRAY","array",710],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",710],["T_WHITESPACE"," ",710],["T_DOUBLE_ARROW","=>",710],["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'serial'",710],",",["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",710],["T_WHITESPACE"," ",710],["T_DOUBLE_ARROW","=>",710],["T_WHITESPACE"," ",710],["T_STRING","TRUE",710],",",["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'not null'",710],["T_WHITESPACE"," ",710],["T_DOUBLE_ARROW","=>",710],["T_WHITESPACE"," ",710],["T_STRING","TRUE",710],")",",",["T_WHITESPACE","\n        ",710],["T_CONSTANT_ENCAPSED_STRING","'test_field'",711],["T_WHITESPACE"," ",711],["T_DOUBLE_ARROW","=>",711],["T_WHITESPACE"," ",711],["T_VARIABLE","$old_spec",711],",",["T_WHITESPACE","\n      ",711],")",",",["T_WHITESPACE","\n      ",712],["T_CONSTANT_ENCAPSED_STRING","'primary key'",713],["T_WHITESPACE"," ",713],["T_DOUBLE_ARROW","=>",713],["T_WHITESPACE"," ",713],["T_ARRAY","array",713],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",713],")",",",["T_WHITESPACE","\n    ",713],")",";",["T_WHITESPACE","\n    ",714],["T_STRING","db_create_table",715],"(",["T_VARIABLE","$table_name",715],",",["T_WHITESPACE"," ",715],["T_VARIABLE","$table_spec",715],")",";",["T_WHITESPACE","\n    ",715],["T_VARIABLE","$this",716],["T_OBJECT_OPERATOR","->",716],["T_STRING","pass",716],"(",["T_STRING","format_string",716],"(",["T_CONSTANT_ENCAPSED_STRING","'Table %table created.'",716],",",["T_WHITESPACE"," ",716],["T_ARRAY","array",716],"(",["T_CONSTANT_ENCAPSED_STRING","'%table'",716],["T_WHITESPACE"," ",716],["T_DOUBLE_ARROW","=>",716],["T_WHITESPACE"," ",716],["T_VARIABLE","$table_name",716],")",")",")",";",["T_WHITESPACE","\n\n    ",716],["T_COMMENT","\/\/ Check the characteristics of the field.\n",718],["T_WHITESPACE","    ",719],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","assertFieldCharacteristics",719],"(",["T_VARIABLE","$table_name",719],",",["T_WHITESPACE"," ",719],["T_CONSTANT_ENCAPSED_STRING","'test_field'",719],",",["T_WHITESPACE"," ",719],["T_VARIABLE","$old_spec",719],")",";",["T_WHITESPACE","\n\n    ",719],["T_COMMENT","\/\/ Remove inserted rows.\n",721],["T_WHITESPACE","    ",722],["T_STRING","db_truncate",722],"(",["T_VARIABLE","$table_name",722],")",["T_OBJECT_OPERATOR","->",722],["T_STRING","execute",722],"(",")",";",["T_WHITESPACE","\n\n    ",722],["T_IF","if",724],["T_WHITESPACE"," ",724],"(",["T_VARIABLE","$test_data",724],")",["T_WHITESPACE"," ",724],"{",["T_WHITESPACE","\n      ",724],["T_VARIABLE","$id",725],["T_WHITESPACE"," ",725],"=",["T_WHITESPACE"," ",725],["T_STRING","db_insert",725],"(",["T_VARIABLE","$table_name",725],")",["T_WHITESPACE","\n        ",725],["T_OBJECT_OPERATOR","->",726],["T_STRING","fields",726],"(","[",["T_CONSTANT_ENCAPSED_STRING","'test_field'",726],"]",",",["T_WHITESPACE"," ",726],"[",["T_VARIABLE","$test_data",726],"]",")",["T_WHITESPACE","\n        ",726],["T_OBJECT_OPERATOR","->",727],["T_STRING","execute",727],"(",")",";",["T_WHITESPACE","\n    ",727],"}",["T_WHITESPACE","\n\n    ",728],["T_COMMENT","\/\/ Change the field.\n",730],["T_WHITESPACE","    ",731],["T_STRING","db_change_field",731],"(",["T_VARIABLE","$table_name",731],",",["T_WHITESPACE"," ",731],["T_CONSTANT_ENCAPSED_STRING","'test_field'",731],",",["T_WHITESPACE"," ",731],["T_CONSTANT_ENCAPSED_STRING","'test_field'",731],",",["T_WHITESPACE"," ",731],["T_VARIABLE","$new_spec",731],")",";",["T_WHITESPACE","\n\n    ",731],["T_IF","if",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$test_data",733],")",["T_WHITESPACE"," ",733],"{",["T_WHITESPACE","\n      ",733],["T_VARIABLE","$field_value",734],["T_WHITESPACE"," ",734],"=",["T_WHITESPACE"," ",734],["T_STRING","db_select",734],"(",["T_VARIABLE","$table_name",734],")",["T_WHITESPACE","\n        ",734],["T_OBJECT_OPERATOR","->",735],["T_STRING","fields",735],"(",["T_VARIABLE","$table_name",735],",",["T_WHITESPACE"," ",735],"[",["T_CONSTANT_ENCAPSED_STRING","'test_field'",735],"]",")",["T_WHITESPACE","\n        ",735],["T_OBJECT_OPERATOR","->",736],["T_STRING","condition",736],"(",["T_CONSTANT_ENCAPSED_STRING","'serial_column'",736],",",["T_WHITESPACE"," ",736],["T_VARIABLE","$id",736],")",["T_WHITESPACE","\n        ",736],["T_OBJECT_OPERATOR","->",737],["T_STRING","execute",737],"(",")",["T_WHITESPACE","\n        ",737],["T_OBJECT_OPERATOR","->",738],["T_STRING","fetchField",738],"(",")",";",["T_WHITESPACE","\n      ",738],["T_VARIABLE","$this",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","assertIdentical",739],"(",["T_VARIABLE","$field_value",739],",",["T_WHITESPACE"," ",739],["T_VARIABLE","$test_data",739],")",";",["T_WHITESPACE","\n    ",739],"}",["T_WHITESPACE","\n\n    ",740],["T_COMMENT","\/\/ Check the field was changed.\n",742],["T_WHITESPACE","    ",743],["T_VARIABLE","$this",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","assertFieldCharacteristics",743],"(",["T_VARIABLE","$table_name",743],",",["T_WHITESPACE"," ",743],["T_CONSTANT_ENCAPSED_STRING","'test_field'",743],",",["T_WHITESPACE"," ",743],["T_VARIABLE","$new_spec",743],")",";",["T_WHITESPACE","\n\n    ",743],["T_COMMENT","\/\/ Clean-up.\n",745],["T_WHITESPACE","    ",746],["T_STRING","db_drop_table",746],"(",["T_VARIABLE","$table_name",746],")",";",["T_WHITESPACE","\n  ",746],"}",["T_WHITESPACE","\n\n  ",747],["T_DOC_COMMENT","\/**\n   * Tests the findTables() method.\n   *\/",749],["T_WHITESPACE","\n  ",751],["T_PUBLIC","public",752],["T_WHITESPACE"," ",752],["T_FUNCTION","function",752],["T_WHITESPACE"," ",752],["T_STRING","testFindTables",752],"(",")",["T_WHITESPACE"," ",752],"{",["T_WHITESPACE","\n    ",752],["T_COMMENT","\/\/ We will be testing with three tables, two of them using the default\n",753],["T_WHITESPACE","    ",754],["T_COMMENT","\/\/ prefix and the third one with an individually specified prefix.\n",754],["T_WHITESPACE","\n    ",755],["T_COMMENT","\/\/ Set up a new connection with different connection info.\n",756],["T_WHITESPACE","    ",757],["T_VARIABLE","$connection_info",757],["T_WHITESPACE"," ",757],"=",["T_WHITESPACE"," ",757],["T_STRING","Database",757],["T_DOUBLE_COLON","::",757],["T_STRING","getConnectionInfo",757],"(",")",";",["T_WHITESPACE","\n\n    ",757],["T_COMMENT","\/\/ Add per-table prefix to the second table.\n",759],["T_WHITESPACE","    ",760],["T_VARIABLE","$new_connection_info",760],["T_WHITESPACE"," ",760],"=",["T_WHITESPACE"," ",760],["T_VARIABLE","$connection_info",760],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",760],"]",";",["T_WHITESPACE","\n    ",760],["T_VARIABLE","$new_connection_info",761],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",761],"]","[",["T_CONSTANT_ENCAPSED_STRING","'test_2_table'",761],"]",["T_WHITESPACE"," ",761],"=",["T_WHITESPACE"," ",761],["T_VARIABLE","$new_connection_info",761],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",761],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default'",761],"]",["T_WHITESPACE"," ",761],".",["T_WHITESPACE"," ",761],["T_CONSTANT_ENCAPSED_STRING","'_shared_'",761],";",["T_WHITESPACE","\n    ",761],["T_STRING","Database",762],["T_DOUBLE_COLON","::",762],["T_STRING","addConnectionInfo",762],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",762],",",["T_WHITESPACE"," ",762],["T_CONSTANT_ENCAPSED_STRING","'default'",762],",",["T_WHITESPACE"," ",762],["T_VARIABLE","$new_connection_info",762],")",";",["T_WHITESPACE","\n\n    ",762],["T_STRING","Database",764],["T_DOUBLE_COLON","::",764],["T_STRING","setActiveConnection",764],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",764],")",";",["T_WHITESPACE","\n\n    ",764],["T_COMMENT","\/\/ Create the tables.\n",766],["T_WHITESPACE","    ",767],["T_VARIABLE","$table_specification",767],["T_WHITESPACE"," ",767],"=",["T_WHITESPACE"," ",767],"[",["T_WHITESPACE","\n      ",767],["T_CONSTANT_ENCAPSED_STRING","'description'",768],["T_WHITESPACE"," ",768],["T_DOUBLE_ARROW","=>",768],["T_WHITESPACE"," ",768],["T_CONSTANT_ENCAPSED_STRING","'Test table.'",768],",",["T_WHITESPACE","\n      ",768],["T_CONSTANT_ENCAPSED_STRING","'fields'",769],["T_WHITESPACE"," ",769],["T_DOUBLE_ARROW","=>",769],["T_WHITESPACE"," ",769],"[",["T_WHITESPACE","\n        ",769],["T_CONSTANT_ENCAPSED_STRING","'id'",770],["T_WHITESPACE","  ",770],["T_DOUBLE_ARROW","=>",770],["T_WHITESPACE"," ",770],"[",["T_WHITESPACE","\n          ",770],["T_CONSTANT_ENCAPSED_STRING","'type'",771],["T_WHITESPACE"," ",771],["T_DOUBLE_ARROW","=>",771],["T_WHITESPACE"," ",771],["T_CONSTANT_ENCAPSED_STRING","'int'",771],",",["T_WHITESPACE","\n          ",771],["T_CONSTANT_ENCAPSED_STRING","'default'",772],["T_WHITESPACE"," ",772],["T_DOUBLE_ARROW","=>",772],["T_WHITESPACE"," ",772],["T_STRING","NULL",772],",",["T_WHITESPACE","\n        ",772],"]",",",["T_WHITESPACE","\n      ",773],"]",",",["T_WHITESPACE","\n    ",774],"]",";",["T_WHITESPACE","\n    ",775],["T_STRING","Database",776],["T_DOUBLE_COLON","::",776],["T_STRING","getConnection",776],"(",")",["T_OBJECT_OPERATOR","->",776],["T_STRING","schema",776],"(",")",["T_OBJECT_OPERATOR","->",776],["T_STRING","createTable",776],"(",["T_CONSTANT_ENCAPSED_STRING","'test_1_table'",776],",",["T_WHITESPACE"," ",776],["T_VARIABLE","$table_specification",776],")",";",["T_WHITESPACE","\n    ",776],["T_STRING","Database",777],["T_DOUBLE_COLON","::",777],["T_STRING","getConnection",777],"(",")",["T_OBJECT_OPERATOR","->",777],["T_STRING","schema",777],"(",")",["T_OBJECT_OPERATOR","->",777],["T_STRING","createTable",777],"(",["T_CONSTANT_ENCAPSED_STRING","'test_2_table'",777],",",["T_WHITESPACE"," ",777],["T_VARIABLE","$table_specification",777],")",";",["T_WHITESPACE","\n    ",777],["T_STRING","Database",778],["T_DOUBLE_COLON","::",778],["T_STRING","getConnection",778],"(",")",["T_OBJECT_OPERATOR","->",778],["T_STRING","schema",778],"(",")",["T_OBJECT_OPERATOR","->",778],["T_STRING","createTable",778],"(",["T_CONSTANT_ENCAPSED_STRING","'the_third_table'",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$table_specification",778],")",";",["T_WHITESPACE","\n\n    ",778],["T_COMMENT","\/\/ Check the \"all tables\" syntax.\n",780],["T_WHITESPACE","    ",781],["T_VARIABLE","$tables",781],["T_WHITESPACE"," ",781],"=",["T_WHITESPACE"," ",781],["T_STRING","Database",781],["T_DOUBLE_COLON","::",781],["T_STRING","getConnection",781],"(",")",["T_OBJECT_OPERATOR","->",781],["T_STRING","schema",781],"(",")",["T_OBJECT_OPERATOR","->",781],["T_STRING","findTables",781],"(",["T_CONSTANT_ENCAPSED_STRING","'%'",781],")",";",["T_WHITESPACE","\n    ",781],["T_STRING","sort",782],"(",["T_VARIABLE","$tables",782],")",";",["T_WHITESPACE","\n    ",782],["T_VARIABLE","$expected",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],"[",["T_WHITESPACE","\n      ",783],["T_COMMENT","\/\/ The 'config' table is added by\n",784],["T_WHITESPACE","      ",785],["T_COMMENT","\/\/ \\Drupal\\KernelTests\\KernelTestBase::containerBuild().\n",785],["T_WHITESPACE","      ",786],["T_CONSTANT_ENCAPSED_STRING","'config'",786],",",["T_WHITESPACE","\n      ",786],["T_CONSTANT_ENCAPSED_STRING","'test_1_table'",787],",",["T_WHITESPACE","\n      ",787],["T_COMMENT","\/\/ This table uses a per-table prefix, yet it is returned as un-prefixed.\n",788],["T_WHITESPACE","      ",789],["T_CONSTANT_ENCAPSED_STRING","'test_2_table'",789],",",["T_WHITESPACE","\n      ",789],["T_CONSTANT_ENCAPSED_STRING","'the_third_table'",790],",",["T_WHITESPACE","\n    ",790],"]",";",["T_WHITESPACE","\n    ",791],["T_VARIABLE","$this",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","assertEqual",792],"(",["T_VARIABLE","$tables",792],",",["T_WHITESPACE"," ",792],["T_VARIABLE","$expected",792],",",["T_WHITESPACE"," ",792],["T_CONSTANT_ENCAPSED_STRING","'All tables were found.'",792],")",";",["T_WHITESPACE","\n\n    ",792],["T_COMMENT","\/\/ Check the restrictive syntax.\n",794],["T_WHITESPACE","    ",795],["T_VARIABLE","$tables",795],["T_WHITESPACE"," ",795],"=",["T_WHITESPACE"," ",795],["T_STRING","Database",795],["T_DOUBLE_COLON","::",795],["T_STRING","getConnection",795],"(",")",["T_OBJECT_OPERATOR","->",795],["T_STRING","schema",795],"(",")",["T_OBJECT_OPERATOR","->",795],["T_STRING","findTables",795],"(",["T_CONSTANT_ENCAPSED_STRING","'test_%'",795],")",";",["T_WHITESPACE","\n    ",795],["T_STRING","sort",796],"(",["T_VARIABLE","$tables",796],")",";",["T_WHITESPACE","\n    ",796],["T_VARIABLE","$expected",797],["T_WHITESPACE"," ",797],"=",["T_WHITESPACE"," ",797],"[",["T_WHITESPACE","\n      ",797],["T_CONSTANT_ENCAPSED_STRING","'test_1_table'",798],",",["T_WHITESPACE","\n      ",798],["T_CONSTANT_ENCAPSED_STRING","'test_2_table'",799],",",["T_WHITESPACE","\n    ",799],"]",";",["T_WHITESPACE","\n    ",800],["T_VARIABLE","$this",801],["T_OBJECT_OPERATOR","->",801],["T_STRING","assertEqual",801],"(",["T_VARIABLE","$tables",801],",",["T_WHITESPACE"," ",801],["T_VARIABLE","$expected",801],",",["T_WHITESPACE"," ",801],["T_CONSTANT_ENCAPSED_STRING","'Two tables were found.'",801],")",";",["T_WHITESPACE","\n\n    ",801],["T_COMMENT","\/\/ Go back to the initial connection.\n",803],["T_WHITESPACE","    ",804],["T_STRING","Database",804],["T_DOUBLE_COLON","::",804],["T_STRING","setActiveConnection",804],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",804],")",";",["T_WHITESPACE","\n  ",804],"}",["T_WHITESPACE","\n\n",805],"}",["T_WHITESPACE","\n",807]]