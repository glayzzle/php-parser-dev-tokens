[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Config",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","config_entity_static_cache_test",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ConfigOverrider",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTests",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTestBase",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests the entity static cache when used by config entities.\n *\n * @group config\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","ConfigEntityStaticCacheTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","KernelTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",15],["T_WHITESPACE","\n  ",19],["T_PUBLIC","public",20],["T_WHITESPACE"," ",20],["T_STATIC","static",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$modules",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_ARRAY","array",20],"(",["T_CONSTANT_ENCAPSED_STRING","'config_test'",20],",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'config_entity_static_cache_test'",20],")",";",["T_WHITESPACE","\n\n  ",20],["T_DOC_COMMENT","\/**\n   * The type ID of the entity under test.\n   *\n   * @var string\n   *\/",22],["T_WHITESPACE","\n  ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$entityTypeId",27],";",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * The entity ID of the entity under test.\n   *\n   * @var string\n   *\/",29],["T_WHITESPACE","\n  ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$entityId",34],";",["T_WHITESPACE","\n\n  ",34],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",36],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","setUp",39],"(",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n    ",39],["T_STRING","parent",40],["T_DOUBLE_COLON","::",40],["T_STRING","setUp",40],"(",")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","entityTypeId",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'config_test'",41],";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","entityId",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'test_1'",42],";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","container",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","get",43],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",43],")",["T_WHITESPACE","\n      ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","getStorage",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","entityTypeId",44],")",["T_WHITESPACE","\n      ",44],["T_OBJECT_OPERATOR","->",45],["T_STRING","create",45],"(",["T_ARRAY","array",45],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","entityId",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'label'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'Original label'",45],")",")",["T_WHITESPACE","\n      ",45],["T_OBJECT_OPERATOR","->",46],["T_STRING","save",46],"(",")",";",["T_WHITESPACE","\n  ",46],"}",["T_WHITESPACE","\n\n  ",47],["T_DOC_COMMENT","\/**\n   * Tests that the static cache is working.\n   *\/",49],["T_WHITESPACE","\n  ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","testCacheHit",52],"(",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$storage",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","container",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","get",53],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",53],")",["T_WHITESPACE","\n      ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","getStorage",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","entityTypeId",54],")",";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$entity_1",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$storage",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","load",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","entityId",55],")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$entity_2",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$storage",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","load",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","entityId",56],")",";",["T_WHITESPACE","\n    ",56],["T_COMMENT","\/\/ config_entity_static_cache_test_config_test_load() sets _loadStamp to a\n",57],["T_WHITESPACE","    ",58],["T_COMMENT","\/\/ random string. If they match, it means $entity_2 was retrieved from the\n",58],["T_WHITESPACE","    ",59],["T_COMMENT","\/\/ static cache rather than going through a separate load sequence.\n",59],["T_WHITESPACE","    ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertIdentical",60],"(",["T_VARIABLE","$entity_1",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_loadStamp",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$entity_2",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_loadStamp",60],")",";",["T_WHITESPACE","\n  ",60],"}",["T_WHITESPACE","\n\n  ",61],["T_DOC_COMMENT","\/**\n   * Tests that the static cache is reset on entity save and delete.\n   *\/",63],["T_WHITESPACE","\n  ",65],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","testReset",66],"(",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$storage",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","container",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","get",67],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",67],")",["T_WHITESPACE","\n      ",67],["T_OBJECT_OPERATOR","->",68],["T_STRING","getStorage",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","entityTypeId",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$entity",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$storage",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","load",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","entityId",69],")",";",["T_WHITESPACE","\n\n    ",69],["T_COMMENT","\/\/ Ensure loading after a save retrieves the updated entity rather than an\n",71],["T_WHITESPACE","    ",72],["T_COMMENT","\/\/ obsolete cached one.\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$entity",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","label",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'New label'",73],";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$entity",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","save",74],"(",")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$entity",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$storage",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","load",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","entityId",75],")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertIdentical",76],"(",["T_VARIABLE","$entity",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","label",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'New label'",76],")",";",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/\/ Ensure loading after a delete retrieves NULL rather than an obsolete\n",78],["T_WHITESPACE","    ",79],["T_COMMENT","\/\/ cached one.\n",79],["T_WHITESPACE","    ",80],["T_VARIABLE","$entity",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","delete",80],"(",")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","assertNull",81],"(",["T_VARIABLE","$storage",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","load",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","entityId",81],")",")",";",["T_WHITESPACE","\n  ",81],"}",["T_WHITESPACE","\n\n  ",82],["T_DOC_COMMENT","\/**\n   * Tests that the static cache is sensitive to config overrides.\n   *\/",84],["T_WHITESPACE","\n  ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","testConfigOverride",87],"(",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n    ",87],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Config\\Entity\\ConfigEntityStorage $storage *\/",88],["T_WHITESPACE","\n    ",88],["T_VARIABLE","$storage",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Drupal",89],["T_DOUBLE_COLON","::",89],["T_STRING","entityManager",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","getStorage",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","entityTypeId",89],")",";",["T_WHITESPACE","\n    ",89],["T_COMMENT","\/\/ Prime the cache prior to adding a config override.\n",90],["T_WHITESPACE","    ",91],["T_VARIABLE","$storage",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","load",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","entityId",91],")",";",["T_WHITESPACE","\n\n    ",91],["T_COMMENT","\/\/ Add the config override, and ensure that what is loaded is correct\n",93],["T_WHITESPACE","    ",94],["T_COMMENT","\/\/ despite the prior cache priming.\n",94],["T_WHITESPACE","    ",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Drupal",95],["T_DOUBLE_COLON","::",95],["T_STRING","configFactory",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","addOverride",95],"(",["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_STRING","ConfigOverrider",95],"(",")",")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$entity_override",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$storage",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","load",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","entityId",96],")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","assertIdentical",97],"(",["T_VARIABLE","$entity_override",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","label",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'Overridden label'",97],")",";",["T_WHITESPACE","\n\n    ",97],["T_COMMENT","\/\/ Load override free to ensure that loading the config entity again does\n",99],["T_WHITESPACE","    ",100],["T_COMMENT","\/\/ not return the overridden value.\n",100],["T_WHITESPACE","    ",101],["T_VARIABLE","$entity_no_override",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$storage",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","loadOverrideFree",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","entityId",101],")",";",["T_WHITESPACE","\n    ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertNotIdentical",102],"(",["T_VARIABLE","$entity_no_override",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","label",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'Overridden label'",102],")",";",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertNotIdentical",103],"(",["T_VARIABLE","$entity_override",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_loadStamp",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$entity_no_override",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_loadStamp",103],")",";",["T_WHITESPACE","\n\n    ",103],["T_COMMENT","\/\/ Reload the entity and ensure the cache is used.\n",105],["T_WHITESPACE","    ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertIdentical",106],"(",["T_VARIABLE","$storage",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","loadOverrideFree",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","entityId",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","_loadStamp",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$entity_no_override",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_loadStamp",106],")",";",["T_WHITESPACE","\n\n    ",106],["T_COMMENT","\/\/ Enable overrides and reload the entity and ensure the cache is used.\n",108],["T_WHITESPACE","    ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assertIdentical",109],"(",["T_VARIABLE","$storage",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","load",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","entityId",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","_loadStamp",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$entity_override",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_loadStamp",109],")",";",["T_WHITESPACE","\n  ",109],"}",["T_WHITESPACE","\n\n",110],"}",["T_WHITESPACE","\n",112]]