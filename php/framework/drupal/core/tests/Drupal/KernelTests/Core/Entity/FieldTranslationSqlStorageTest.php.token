[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","KernelTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Entity",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FieldableEntityInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Language",6],["T_NS_SEPARATOR","\\",6],["T_STRING","LanguageInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","field",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","FieldStorageConfig",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Tests Field translation SQL Storage.\n *\n * @group Entity\n *\/",9],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","FieldTranslationSqlStorageTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_STRING","EntityLanguageTestBase",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * Tests field SQL storage.\n   *\/",16],["T_WHITESPACE","\n  ",18],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_FUNCTION","function",19],["T_WHITESPACE"," ",19],["T_STRING","testFieldSqlStorage",19],"(",")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n    ",19],["T_VARIABLE","$entity_type",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'entity_test_mul'",20],";",["T_WHITESPACE","\n\n    ",20],["T_VARIABLE","$controller",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","entityManager",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","getStorage",22],"(",["T_VARIABLE","$entity_type",22],")",";",["T_WHITESPACE","\n    ",22],["T_VARIABLE","$values",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_ARRAY","array",23],"(",["T_WHITESPACE","\n      ",23],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","fieldName",24],["T_WHITESPACE"," ",24],["T_DOUBLE_ARROW","=>",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","randomMachineName",24],"(",")",",",["T_WHITESPACE","\n      ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","untranslatableFieldName",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","randomMachineName",25],"(",")",",",["T_WHITESPACE","\n    ",25],")",";",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$entity",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$controller",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","create",27],"(",["T_VARIABLE","$values",27],")",";",["T_WHITESPACE","\n    ",27],["T_VARIABLE","$entity",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","save",28],"(",")",";",["T_WHITESPACE","\n\n    ",28],["T_COMMENT","\/\/ Tests that when changing language field language codes are still correct.\n",30],["T_WHITESPACE","    ",31],["T_VARIABLE","$langcode",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","langcodes",31],"[",["T_LNUMBER","0",31],"]",";",["T_WHITESPACE","\n    ",31],["T_VARIABLE","$entity",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","langcode",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","value",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$langcode",32],";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$entity",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","save",33],"(",")",";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","assertFieldStorageLangcode",34],"(",["T_VARIABLE","$entity",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'Field language successfully changed from language neutral.'",34],")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$langcode",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","langcodes",35],"[",["T_LNUMBER","1",35],"]",";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$entity",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","langcode",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","value",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$langcode",36],";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$entity",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","save",37],"(",")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","assertFieldStorageLangcode",38],"(",["T_VARIABLE","$entity",38],",",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'Field language successfully changed.'",38],")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$langcode",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","LanguageInterface",39],["T_DOUBLE_COLON","::",39],["T_STRING","LANGCODE_NOT_SPECIFIED",39],";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$entity",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","langcode",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","value",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$langcode",40],";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$entity",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","save",41],"(",")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","assertFieldStorageLangcode",42],"(",["T_VARIABLE","$entity",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'Field language successfully changed to language neutral.'",42],")",";",["T_WHITESPACE","\n\n    ",42],["T_COMMENT","\/\/ Test that after switching field translatability things keep working as\n",44],["T_WHITESPACE","    ",45],["T_COMMENT","\/\/ before.\n",45],["T_WHITESPACE","    ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","toggleFieldTranslatability",46],"(",["T_VARIABLE","$entity_type",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$entity_type",46],")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$entity",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","reloadEntity",47],"(",["T_VARIABLE","$entity",47],")",";",["T_WHITESPACE","\n    ",47],["T_FOREACH","foreach",48],["T_WHITESPACE"," ",48],"(",["T_ARRAY","array",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","fieldName",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","untranslatableFieldName",48],")",["T_WHITESPACE"," ",48],["T_AS","as",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$field_name",48],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n      ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertEqual",49],"(",["T_VARIABLE","$entity",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_VARIABLE","$field_name",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","value",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$values",49],"[",["T_VARIABLE","$field_name",49],"]",",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'Field language works as expected after switching translatability.'",49],")",";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_COMMENT","\/\/ Test that after disabling field translatability translated values are not\n",52],["T_WHITESPACE","    ",53],["T_COMMENT","\/\/ loaded.\n",53],["T_WHITESPACE","    ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","toggleFieldTranslatability",54],"(",["T_VARIABLE","$entity_type",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$entity_type",54],")",";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$entity",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","reloadEntity",55],"(",["T_VARIABLE","$entity",55],")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$entity",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","langcode",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","value",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","langcodes",56],"[",["T_LNUMBER","0",56],"]",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$translation",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$entity",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","addTranslation",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","langcodes",57],"[",["T_LNUMBER","1",57],"]",")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$translated_value",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","randomMachineName",58],"(",")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$translation",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","fieldName",59],")",["T_OBJECT_OPERATOR","->",59],["T_STRING","value",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$translated_value",59],";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$translation",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","save",60],"(",")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","toggleFieldTranslatability",61],"(",["T_VARIABLE","$entity_type",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$entity_type",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$entity",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","reloadEntity",62],"(",["T_VARIABLE","$entity",62],")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertEqual",63],"(",["T_VARIABLE","$entity",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getTranslation",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","langcodes",63],"[",["T_LNUMBER","1",63],"]",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","get",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","fieldName",63],")",["T_OBJECT_OPERATOR","->",63],["T_STRING","value",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$values",63],"[",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","fieldName",63],"]",",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'Existing field translations are not loaded for untranslatable fields.'",63],")",";",["T_WHITESPACE","\n  ",63],"}",["T_WHITESPACE","\n\n  ",64],["T_DOC_COMMENT","\/**\n   * Checks whether field languages are correctly stored for the given entity.\n   *\n   * @param \\Drupal\\Core\\Entity\\FieldableEntityInterface $entity\n   *   The entity fields are attached to.\n   * @param string $message\n   *   (optional) A message to display with the assertion.\n   *\/",66],["T_WHITESPACE","\n  ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","assertFieldStorageLangcode",74],"(",["T_STRING","FieldableEntityInterface",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$entity",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$message",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","''",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$status",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","TRUE",75],";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$entity_type",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$entity",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getEntityTypeId",76],"(",")",";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$id",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$entity",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","id",77],"(",")",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$langcode",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$entity",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getUntranslated",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","language",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","getId",78],"(",")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$fields",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","fieldName",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","untranslatableFieldName",79],")",";",["T_WHITESPACE","\n    ",79],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\Sql\\DefaultTableMapping $table_mapping *\/",80],["T_WHITESPACE","\n    ",80],["T_VARIABLE","$table_mapping",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Drupal",81],["T_DOUBLE_COLON","::",81],["T_STRING","entityManager",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","getStorage",81],"(",["T_VARIABLE","$entity_type",81],")",["T_OBJECT_OPERATOR","->",81],["T_STRING","getTableMapping",81],"(",")",";",["T_WHITESPACE","\n\n    ",81],["T_FOREACH","foreach",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$fields",83],["T_WHITESPACE"," ",83],["T_AS","as",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$field_name",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n      ",83],["T_VARIABLE","$field_storage",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","FieldStorageConfig",84],["T_DOUBLE_COLON","::",84],["T_STRING","loadByName",84],"(",["T_VARIABLE","$entity_type",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$field_name",84],")",";",["T_WHITESPACE","\n      ",84],["T_VARIABLE","$table",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$table_mapping",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getDedicatedDataTableName",85],"(",["T_VARIABLE","$field_storage",85],")",";",["T_WHITESPACE","\n\n      ",85],["T_VARIABLE","$record",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Drupal",87],["T_DOUBLE_COLON","::",87],["T_STRING","database",87],"(",")",["T_WHITESPACE","\n        ",87],["T_OBJECT_OPERATOR","->",88],["T_STRING","select",88],"(",["T_VARIABLE","$table",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'f'",88],")",["T_WHITESPACE","\n        ",88],["T_OBJECT_OPERATOR","->",89],["T_STRING","fields",89],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",89],")",["T_WHITESPACE","\n        ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","condition",90],"(",["T_CONSTANT_ENCAPSED_STRING","'f.entity_id'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$id",90],")",["T_WHITESPACE","\n        ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","condition",91],"(",["T_CONSTANT_ENCAPSED_STRING","'f.revision_id'",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$id",91],")",["T_WHITESPACE","\n        ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","execute",92],"(",")",["T_WHITESPACE","\n        ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","fetchObject",93],"(",")",";",["T_WHITESPACE","\n\n      ",93],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$record",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","langcode",95],["T_WHITESPACE"," ",95],["T_IS_NOT_EQUAL","!=",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$langcode",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$status",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","FALSE",96],";",["T_WHITESPACE","\n        ",96],["T_BREAK","break",97],";",["T_WHITESPACE","\n      ",97],"}",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertTrue",101],"(",["T_VARIABLE","$status",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$message",101],")",";",["T_WHITESPACE","\n  ",101],"}",["T_WHITESPACE","\n\n",102],"}",["T_WHITESPACE","\n",104]]