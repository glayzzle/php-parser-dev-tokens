[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Session",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Crypt",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Session",6],["T_NS_SEPARATOR","\\",6],["T_STRING","PermissionsHashGenerator",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Site",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Settings",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Tests",8],["T_NS_SEPARATOR","\\",8],["T_STRING","UnitTestCase",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * @coversDefaultClass \\Drupal\\Core\\Session\\PermissionsHashGenerator\n * @group Session\n *\/",10],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","PermissionsHashGeneratorTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_STRING","UnitTestCase",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * The mocked super user account.\n   *\n   * @var \\Drupal\\user\\UserInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",16],["T_WHITESPACE","\n  ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$account1",21],";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * A mocked account.\n   *\n   * @var \\Drupal\\user\\UserInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$account2",28],";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * An \"updated\" mocked account.\n   *\n   * @var \\Drupal\\user\\UserInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",30],["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$account2Updated",35],";",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * A different account.\n   *\n   * @var \\Drupal\\user\\UserInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",37],["T_WHITESPACE","\n  ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$account3",42],";",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * The mocked private key service.\n   *\n   * @var \\Drupal\\Core\\PrivateKey|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",44],["T_WHITESPACE","\n  ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$privateKey",49],";",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * The mocked cache backend.\n   *\n   * @var \\Drupal\\Core\\Cache\\CacheBackendInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",51],["T_WHITESPACE","\n  ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$cache",56],";",["T_WHITESPACE","\n\n  ",56],["T_DOC_COMMENT","\/**\n   * The mocked cache backend.\n   *\n   * @var \\Drupal\\Core\\Cache\\CacheBackendInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",58],["T_WHITESPACE","\n  ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$staticCache",63],";",["T_WHITESPACE","\n\n  ",63],["T_DOC_COMMENT","\/**\n   * The permission hash class being tested.\n   *\n   * @var \\Drupal\\Core\\Session\\PermissionsHashGeneratorInterface\n   *\/",65],["T_WHITESPACE","\n  ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$permissionsHash",70],";",["T_WHITESPACE","\n\n  ",70],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",72],["T_WHITESPACE","\n  ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","setUp",75],"(",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n    ",75],["T_STRING","parent",76],["T_DOUBLE_COLON","::",76],["T_STRING","setUp",76],"(",")",";",["T_WHITESPACE","\n\n    ",76],["T_NEW","new",78],["T_WHITESPACE"," ",78],["T_STRING","Settings",78],"(",["T_ARRAY","array",78],"(",["T_CONSTANT_ENCAPSED_STRING","'hash_salt'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'test'",78],")",")",";",["T_WHITESPACE","\n\n    ",78],["T_COMMENT","\/\/ The mocked super user account, with the same roles as Account 2.\n",80],["T_WHITESPACE","    ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","account1",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getMockBuilder",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\user\\Entity\\User'",81],")",["T_WHITESPACE","\n      ",81],["T_OBJECT_OPERATOR","->",82],["T_STRING","disableOriginalConstructor",82],"(",")",["T_WHITESPACE","\n      ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","setMethods",83],"(",["T_ARRAY","array",83],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'id'",83],")",")",["T_WHITESPACE","\n      ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","getMock",84],"(",")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","account1",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","expects",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","any",85],"(",")",")",["T_WHITESPACE","\n      ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","method",86],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",86],")",["T_WHITESPACE","\n      ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","willReturn",87],"(",["T_LNUMBER","1",87],")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","account1",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","expects",88],"(",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","never",88],"(",")",")",["T_WHITESPACE","\n      ",88],["T_OBJECT_OPERATOR","->",89],["T_STRING","method",89],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",89],")",";",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ Account 2: 'administrator' and 'authenticated' roles.\n",91],["T_WHITESPACE","    ",92],["T_VARIABLE","$roles_1",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",["T_CONSTANT_ENCAPSED_STRING","'administrator'",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'authenticated'",92],")",";",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","account2",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getMockBuilder",93],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\user\\Entity\\User'",93],")",["T_WHITESPACE","\n      ",93],["T_OBJECT_OPERATOR","->",94],["T_STRING","disableOriginalConstructor",94],"(",")",["T_WHITESPACE","\n      ",94],["T_OBJECT_OPERATOR","->",95],["T_STRING","setMethods",95],"(",["T_ARRAY","array",95],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'id'",95],")",")",["T_WHITESPACE","\n      ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","getMock",96],"(",")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","account2",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","expects",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","any",97],"(",")",")",["T_WHITESPACE","\n      ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","method",98],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",98],")",["T_WHITESPACE","\n      ",98],["T_OBJECT_OPERATOR","->",99],["T_STRING","will",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","returnValue",99],"(",["T_VARIABLE","$roles_1",99],")",")",";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","account2",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","expects",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","any",100],"(",")",")",["T_WHITESPACE","\n      ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","method",101],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",101],")",["T_WHITESPACE","\n      ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","willReturn",102],"(",["T_LNUMBER","2",102],")",";",["T_WHITESPACE","\n\n    ",102],["T_COMMENT","\/\/ Account 3: 'authenticated' and 'administrator' roles (different order).\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$roles_3",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticated'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'administrator'",105],")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","account3",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getMockBuilder",106],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\user\\Entity\\User'",106],")",["T_WHITESPACE","\n      ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","disableOriginalConstructor",107],"(",")",["T_WHITESPACE","\n      ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","setMethods",108],"(",["T_ARRAY","array",108],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'id'",108],")",")",["T_WHITESPACE","\n      ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","getMock",109],"(",")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","account3",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","expects",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","any",110],"(",")",")",["T_WHITESPACE","\n      ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","method",111],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",111],")",["T_WHITESPACE","\n      ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","will",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","returnValue",112],"(",["T_VARIABLE","$roles_3",112],")",")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","account3",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","expects",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","any",113],"(",")",")",["T_WHITESPACE","\n      ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","method",114],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",114],")",["T_WHITESPACE","\n      ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","willReturn",115],"(",["T_LNUMBER","3",115],")",";",["T_WHITESPACE","\n\n    ",115],["T_COMMENT","\/\/ Updated account 2: now also 'editor' role.\n",117],["T_WHITESPACE","    ",118],["T_VARIABLE","$roles_2_updated",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_ARRAY","array",118],"(",["T_CONSTANT_ENCAPSED_STRING","'editor'",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'administrator'",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'authenticated'",118],")",";",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","account2Updated",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getMockBuilder",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\user\\Entity\\User'",119],")",["T_WHITESPACE","\n      ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","disableOriginalConstructor",120],"(",")",["T_WHITESPACE","\n      ",120],["T_OBJECT_OPERATOR","->",121],["T_STRING","setMethods",121],"(",["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'id'",121],")",")",["T_WHITESPACE","\n      ",121],["T_OBJECT_OPERATOR","->",122],["T_STRING","getMock",122],"(",")",";",["T_WHITESPACE","\n    ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","account2Updated",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","expects",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","any",123],"(",")",")",["T_WHITESPACE","\n      ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","method",124],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",124],")",["T_WHITESPACE","\n      ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","will",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","returnValue",125],"(",["T_VARIABLE","$roles_2_updated",125],")",")",";",["T_WHITESPACE","\n    ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","account2Updated",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","expects",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","any",126],"(",")",")",["T_WHITESPACE","\n      ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","method",127],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",127],")",["T_WHITESPACE","\n      ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","willReturn",128],"(",["T_LNUMBER","2",128],")",";",["T_WHITESPACE","\n\n    ",128],["T_COMMENT","\/\/ Mocked private key + cache services.\n",130],["T_WHITESPACE","    ",131],["T_VARIABLE","$random",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","Crypt",131],["T_DOUBLE_COLON","::",131],["T_STRING","randomBytesBase64",131],"(",["T_LNUMBER","55",131],")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","privateKey",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getMockBuilder",132],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\PrivateKey'",132],")",["T_WHITESPACE","\n      ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","disableOriginalConstructor",133],"(",")",["T_WHITESPACE","\n      ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","setMethods",134],"(",["T_ARRAY","array",134],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",134],")",")",["T_WHITESPACE","\n      ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","getMock",135],"(",")",";",["T_WHITESPACE","\n    ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","privateKey",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","expects",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","any",136],"(",")",")",["T_WHITESPACE","\n      ",136],["T_OBJECT_OPERATOR","->",137],["T_STRING","method",137],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",137],")",["T_WHITESPACE","\n      ",137],["T_OBJECT_OPERATOR","->",138],["T_STRING","will",138],"(",["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","returnValue",138],"(",["T_VARIABLE","$random",138],")",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","cache",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getMockBuilder",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Cache\\CacheBackendInterface'",139],")",["T_WHITESPACE","\n      ",139],["T_OBJECT_OPERATOR","->",140],["T_STRING","disableOriginalConstructor",140],"(",")",["T_WHITESPACE","\n      ",140],["T_OBJECT_OPERATOR","->",141],["T_STRING","getMock",141],"(",")",";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","staticCache",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getMockBuilder",142],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Cache\\CacheBackendInterface'",142],")",["T_WHITESPACE","\n      ",142],["T_OBJECT_OPERATOR","->",143],["T_STRING","disableOriginalConstructor",143],"(",")",["T_WHITESPACE","\n      ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","getMock",144],"(",")",";",["T_WHITESPACE","\n\n    ",144],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","permissionsHash",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_NEW","new",146],["T_WHITESPACE"," ",146],["T_STRING","PermissionsHashGenerator",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","privateKey",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","cache",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","staticCache",146],")",";",["T_WHITESPACE","\n  ",146],"}",["T_WHITESPACE","\n\n  ",147],["T_DOC_COMMENT","\/**\n   * @covers ::generate\n   *\/",149],["T_WHITESPACE","\n  ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","testGenerate",152],"(",")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n    ",152],["T_COMMENT","\/\/ Ensure that the super user (user 1) always gets the same hash.\n",153],["T_WHITESPACE","    ",154],["T_VARIABLE","$super_user_hash",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","permissionsHash",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","generate",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","account1",154],")",";",["T_WHITESPACE","\n\n    ",154],["T_COMMENT","\/\/ Ensure that two user accounts with the same roles generate the same hash.\n",156],["T_WHITESPACE","    ",157],["T_VARIABLE","$hash_2",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","permissionsHash",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","generate",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","account2",157],")",";",["T_WHITESPACE","\n    ",157],["T_VARIABLE","$hash_3",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","permissionsHash",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","generate",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","account3",158],")",";",["T_WHITESPACE","\n    ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertSame",159],"(",["T_VARIABLE","$hash_2",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$hash_3",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'Different users with the same roles generate the same permissions hash.'",159],")",";",["T_WHITESPACE","\n\n    ",159],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","assertNotSame",161],"(",["T_VARIABLE","$hash_2",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$super_user_hash",161],",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'User 1 has a different hash despite having the same roles'",161],")",";",["T_WHITESPACE","\n\n    ",161],["T_COMMENT","\/\/ Compare with hash for user account 1 with an additional role.\n",163],["T_WHITESPACE","    ",164],["T_VARIABLE","$updated_hash_2",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","permissionsHash",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","generate",164],"(",["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","account2Updated",164],")",";",["T_WHITESPACE","\n    ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","assertNotSame",165],"(",["T_VARIABLE","$hash_2",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$updated_hash_2",165],",",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'Same user with updated roles generates different permissions hash.'",165],")",";",["T_WHITESPACE","\n  ",165],"}",["T_WHITESPACE","\n\n  ",166],["T_DOC_COMMENT","\/**\n   * @covers ::generate\n   *\/",168],["T_WHITESPACE","\n  ",170],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","testGeneratePersistentCache",171],"(",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n    ",171],["T_COMMENT","\/\/ Set expectations for the mocked cache backend.\n",172],["T_WHITESPACE","    ",173],["T_VARIABLE","$expected_cid",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'user_permissions_hash:administrator,authenticated'",173],";",["T_WHITESPACE","\n\n    ",173],["T_VARIABLE","$mock_cache",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_NS_SEPARATOR","\\",175],["T_STRING","stdClass",175],"(",")",";",["T_WHITESPACE","\n    ",175],["T_VARIABLE","$mock_cache",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","data",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'test_hash_here'",176],";",["T_WHITESPACE","\n\n    ",176],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","staticCache",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","expects",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","once",178],"(",")",")",["T_WHITESPACE","\n      ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","method",179],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",179],")",["T_WHITESPACE","\n      ",179],["T_OBJECT_OPERATOR","->",180],["T_STRING","with",180],"(",["T_VARIABLE","$expected_cid",180],")",["T_WHITESPACE","\n      ",180],["T_OBJECT_OPERATOR","->",181],["T_STRING","will",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","returnValue",181],"(",["T_STRING","FALSE",181],")",")",";",["T_WHITESPACE","\n    ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","staticCache",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","expects",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","once",182],"(",")",")",["T_WHITESPACE","\n      ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","method",183],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",183],")",["T_WHITESPACE","\n      ",183],["T_OBJECT_OPERATOR","->",184],["T_STRING","with",184],"(",["T_VARIABLE","$expected_cid",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","isType",184],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",184],")",")",";",["T_WHITESPACE","\n\n    ",184],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","cache",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","expects",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","once",186],"(",")",")",["T_WHITESPACE","\n      ",186],["T_OBJECT_OPERATOR","->",187],["T_STRING","method",187],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",187],")",["T_WHITESPACE","\n      ",187],["T_OBJECT_OPERATOR","->",188],["T_STRING","with",188],"(",["T_VARIABLE","$expected_cid",188],")",["T_WHITESPACE","\n      ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","will",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","returnValue",189],"(",["T_VARIABLE","$mock_cache",189],")",")",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","cache",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","expects",190],"(",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","never",190],"(",")",")",["T_WHITESPACE","\n      ",190],["T_OBJECT_OPERATOR","->",191],["T_STRING","method",191],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",191],")",";",["T_WHITESPACE","\n\n    ",191],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","permissionsHash",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","generate",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","account2",193],")",";",["T_WHITESPACE","\n  ",193],"}",["T_WHITESPACE","\n\n  ",194],["T_DOC_COMMENT","\/**\n   * @covers ::generate\n   *\/",196],["T_WHITESPACE","\n  ",198],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","testGenerateStaticCache",199],"(",")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n    ",199],["T_COMMENT","\/\/ Set expectations for the mocked cache backend.\n",200],["T_WHITESPACE","    ",201],["T_VARIABLE","$expected_cid",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'user_permissions_hash:administrator,authenticated'",201],";",["T_WHITESPACE","\n\n    ",201],["T_VARIABLE","$mock_cache",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_NEW","new",203],["T_WHITESPACE"," ",203],["T_NS_SEPARATOR","\\",203],["T_STRING","stdClass",203],"(",")",";",["T_WHITESPACE","\n    ",203],["T_VARIABLE","$mock_cache",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","data",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'test_hash_here'",204],";",["T_WHITESPACE","\n\n    ",204],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","staticCache",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","expects",206],"(",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","once",206],"(",")",")",["T_WHITESPACE","\n      ",206],["T_OBJECT_OPERATOR","->",207],["T_STRING","method",207],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",207],")",["T_WHITESPACE","\n      ",207],["T_OBJECT_OPERATOR","->",208],["T_STRING","with",208],"(",["T_VARIABLE","$expected_cid",208],")",["T_WHITESPACE","\n      ",208],["T_OBJECT_OPERATOR","->",209],["T_STRING","will",209],"(",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","returnValue",209],"(",["T_VARIABLE","$mock_cache",209],")",")",";",["T_WHITESPACE","\n    ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","staticCache",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","expects",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","never",210],"(",")",")",["T_WHITESPACE","\n      ",210],["T_OBJECT_OPERATOR","->",211],["T_STRING","method",211],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",211],")",";",["T_WHITESPACE","\n\n    ",211],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","cache",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","expects",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","never",213],"(",")",")",["T_WHITESPACE","\n      ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","method",214],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",214],")",";",["T_WHITESPACE","\n    ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","cache",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","expects",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","never",215],"(",")",")",["T_WHITESPACE","\n      ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","method",216],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",216],")",";",["T_WHITESPACE","\n\n    ",216],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","permissionsHash",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","generate",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","account2",218],")",";",["T_WHITESPACE","\n  ",218],"}",["T_WHITESPACE","\n\n  ",219],["T_DOC_COMMENT","\/**\n   * Tests the generate method with no cache returned.\n   *\/",221],["T_WHITESPACE","\n  ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","testGenerateNoCache",224],"(",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n    ",224],["T_COMMENT","\/\/ Set expectations for the mocked cache backend.\n",225],["T_WHITESPACE","    ",226],["T_VARIABLE","$expected_cid",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'user_permissions_hash:administrator,authenticated'",226],";",["T_WHITESPACE","\n\n    ",226],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","staticCache",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","expects",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","once",228],"(",")",")",["T_WHITESPACE","\n      ",228],["T_OBJECT_OPERATOR","->",229],["T_STRING","method",229],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",229],")",["T_WHITESPACE","\n      ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","with",230],"(",["T_VARIABLE","$expected_cid",230],")",["T_WHITESPACE","\n      ",230],["T_OBJECT_OPERATOR","->",231],["T_STRING","will",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","returnValue",231],"(",["T_STRING","FALSE",231],")",")",";",["T_WHITESPACE","\n    ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","staticCache",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","expects",232],"(",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","once",232],"(",")",")",["T_WHITESPACE","\n      ",232],["T_OBJECT_OPERATOR","->",233],["T_STRING","method",233],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",233],")",["T_WHITESPACE","\n      ",233],["T_OBJECT_OPERATOR","->",234],["T_STRING","with",234],"(",["T_VARIABLE","$expected_cid",234],",",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","isType",234],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",234],")",")",";",["T_WHITESPACE","\n\n    ",234],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","cache",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","expects",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","once",236],"(",")",")",["T_WHITESPACE","\n      ",236],["T_OBJECT_OPERATOR","->",237],["T_STRING","method",237],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",237],")",["T_WHITESPACE","\n      ",237],["T_OBJECT_OPERATOR","->",238],["T_STRING","with",238],"(",["T_VARIABLE","$expected_cid",238],")",["T_WHITESPACE","\n      ",238],["T_OBJECT_OPERATOR","->",239],["T_STRING","will",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","returnValue",239],"(",["T_STRING","FALSE",239],")",")",";",["T_WHITESPACE","\n    ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","cache",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","expects",240],"(",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","once",240],"(",")",")",["T_WHITESPACE","\n      ",240],["T_OBJECT_OPERATOR","->",241],["T_STRING","method",241],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",241],")",["T_WHITESPACE","\n      ",241],["T_OBJECT_OPERATOR","->",242],["T_STRING","with",242],"(",["T_VARIABLE","$expected_cid",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","isType",242],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",242],")",")",";",["T_WHITESPACE","\n\n    ",242],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","permissionsHash",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","generate",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","account2",244],")",";",["T_WHITESPACE","\n  ",244],"}",["T_WHITESPACE","\n\n",245],"}",["T_WHITESPACE","\n\n",247],["T_NAMESPACE","namespace",249],["T_WHITESPACE"," ",249],["T_STRING","Drupal",249],["T_NS_SEPARATOR","\\",249],["T_STRING","Core",249],["T_NS_SEPARATOR","\\",249],["T_STRING","Session",249],";",["T_WHITESPACE","\n\n",249],["T_COMMENT","\/\/ @todo remove once user_role_permissions() can be injected.\n",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(","!",["T_STRING","function_exists",252],"(",["T_CONSTANT_ENCAPSED_STRING","'user_role_permissions'",252],")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n  ",252],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","user_role_permissions",253],"(",["T_ARRAY","array",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$roles",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n    ",253],["T_VARIABLE","$role_permissions",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_ARRAY","array",254],"(",")",";",["T_WHITESPACE","\n    ",254],["T_FOREACH","foreach",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$roles",255],["T_WHITESPACE"," ",255],["T_AS","as",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$rid",255],")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n      ",255],["T_VARIABLE","$role_permissions",256],"[",["T_VARIABLE","$rid",256],"]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_ARRAY","array",256],"(",")",";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n    ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$role_permissions",258],";",["T_WHITESPACE","\n  ",258],"}",["T_WHITESPACE","\n",259],"}",["T_WHITESPACE","\n",260]]