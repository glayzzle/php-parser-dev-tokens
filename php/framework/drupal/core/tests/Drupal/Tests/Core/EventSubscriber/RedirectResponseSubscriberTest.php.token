[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","EventSubscriber",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","EventSubscriber",5],["T_NS_SEPARATOR","\\",5],["T_STRING","RedirectResponseSubscriber",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Routing",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TrustedRedirectResponse",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Utility",7],["T_NS_SEPARATOR","\\",7],["T_STRING","UnroutedUrlAssemblerInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Tests",8],["T_NS_SEPARATOR","\\",8],["T_STRING","UnitTestCase",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Symfony",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Component",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DependencyInjection",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Container",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Symfony",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Component",10],["T_NS_SEPARATOR","\\",10],["T_STRING","EventDispatcher",10],["T_NS_SEPARATOR","\\",10],["T_STRING","EventDispatcher",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Symfony",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Component",11],["T_NS_SEPARATOR","\\",11],["T_STRING","HttpFoundation",11],["T_NS_SEPARATOR","\\",11],["T_STRING","RedirectResponse",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpFoundation",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Request",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Symfony",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Component",13],["T_NS_SEPARATOR","\\",13],["T_STRING","HttpKernel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Event",13],["T_NS_SEPARATOR","\\",13],["T_STRING","FilterResponseEvent",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpKernel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Event",14],["T_NS_SEPARATOR","\\",14],["T_STRING","GetResponseEvent",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpKernel",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpKernelInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpKernel",16],["T_NS_SEPARATOR","\\",16],["T_STRING","KernelEvents",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * @coversDefaultClass \\Drupal\\Core\\EventSubscriber\\RedirectResponseSubscriber\n * @group EventSubscriber\n *\/",18],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","RedirectResponseSubscriberTest",22],["T_WHITESPACE"," ",22],["T_EXTENDS","extends",22],["T_WHITESPACE"," ",22],["T_STRING","UnitTestCase",22],["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The mocked request context.\n   *\n   * @var \\Drupal\\Core\\Routing\\RequestContext|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$requestContext",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * The mocked request context.\n   *\n   * @var \\Drupal\\Core\\Utility\\UnroutedUrlAssemblerInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",31],["T_WHITESPACE","\n  ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$urlAssembler",36],";",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",38],["T_WHITESPACE","\n  ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","setUp",41],"(",")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n    ",41],["T_STRING","parent",42],["T_DOUBLE_COLON","::",42],["T_STRING","setUp",42],"(",")",";",["T_WHITESPACE","\n\n    ",42],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","requestContext",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getMockBuilder",44],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Routing\\RequestContext'",44],")",["T_WHITESPACE","\n      ",44],["T_OBJECT_OPERATOR","->",45],["T_STRING","disableOriginalConstructor",45],"(",")",["T_WHITESPACE","\n      ",45],["T_OBJECT_OPERATOR","->",46],["T_STRING","getMock",46],"(",")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","requestContext",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","expects",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","any",47],"(",")",")",["T_WHITESPACE","\n      ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","method",48],"(",["T_CONSTANT_ENCAPSED_STRING","'getCompleteBaseUrl'",48],")",["T_WHITESPACE","\n      ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","willReturn",49],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal'",49],")",";",["T_WHITESPACE","\n\n    ",49],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","urlAssembler",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getMock",51],"(",["T_STRING","UnroutedUrlAssemblerInterface",51],["T_DOUBLE_COLON","::",51],["T_CLASS","class",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","urlAssembler",52],["T_WHITESPACE","\n      ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","expects",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","any",53],"(",")",")",["T_WHITESPACE","\n      ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","method",54],"(",["T_CONSTANT_ENCAPSED_STRING","'assemble'",54],")",["T_WHITESPACE","\n      ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","willReturnMap",55],"(","[",["T_WHITESPACE","\n        ",55],"[",["T_CONSTANT_ENCAPSED_STRING","'base:test'",56],",",["T_WHITESPACE"," ",56],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],"[","]",",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'fragment'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","''",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'absolute'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_STRING","TRUE",56],"]",",",["T_WHITESPACE"," ",56],["T_STRING","FALSE",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/test'",56],"]",",",["T_WHITESPACE","\n        ",56],"[",["T_CONSTANT_ENCAPSED_STRING","'base:example.com'",57],",",["T_WHITESPACE"," ",57],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],"[","]",",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'fragment'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","''",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'absolute'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_STRING","TRUE",57],"]",",",["T_WHITESPACE"," ",57],["T_STRING","FALSE",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/example.com'",57],"]",",",["T_WHITESPACE","\n        ",57],"[",["T_CONSTANT_ENCAPSED_STRING","'base:example:com'",58],",",["T_WHITESPACE"," ",58],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],"[","]",",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'fragment'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","''",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'absolute'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_STRING","TRUE",58],"]",",",["T_WHITESPACE"," ",58],["T_STRING","FALSE",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/example:com'",58],"]",",",["T_WHITESPACE","\n        ",58],"[",["T_CONSTANT_ENCAPSED_STRING","'base:javascript:alert(0)'",59],",",["T_WHITESPACE"," ",59],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],"[","]",",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'fragment'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","''",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'absolute'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_STRING","TRUE",59],"]",",",["T_WHITESPACE"," ",59],["T_STRING","FALSE",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/javascript:alert(0)'",59],"]",",",["T_WHITESPACE","\n      ",59],"]",")",";",["T_WHITESPACE","\n\n    ",60],["T_VARIABLE","$container",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_NEW","new",62],["T_WHITESPACE"," ",62],["T_STRING","Container",62],"(",")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$container",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","set",63],"(",["T_CONSTANT_ENCAPSED_STRING","'router.request_context'",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","requestContext",63],")",";",["T_WHITESPACE","\n    ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Drupal",64],["T_DOUBLE_COLON","::",64],["T_STRING","setContainer",64],"(",["T_VARIABLE","$container",64],")",";",["T_WHITESPACE","\n  ",64],"}",["T_WHITESPACE","\n\n  ",65],["T_DOC_COMMENT","\/**\n   * Test destination detection and redirection.\n   *\n   * @param Request $request\n   *   The request object with destination query set.\n   * @param string|bool $expected\n   *   The expected target URL or FALSE.\n   *\n   * @covers ::checkRedirectUrl\n   * @dataProvider providerTestDestinationRedirect\n   *\/",67],["T_WHITESPACE","\n  ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","testDestinationRedirect",78],"(",["T_STRING","Request",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$request",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$expected",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$dispatcher",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_STRING","EventDispatcher",79],"(",")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$kernel",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getMock",80],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",80],")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$response",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_NEW","new",81],["T_WHITESPACE"," ",81],["T_STRING","RedirectResponse",81],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal'",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$request",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","headers",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","set",82],"(",["T_CONSTANT_ENCAPSED_STRING","'HOST'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'example.com'",82],")",";",["T_WHITESPACE","\n\n    ",82],["T_VARIABLE","$listener",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","RedirectResponseSubscriber",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","urlAssembler",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","requestContext",84],")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$dispatcher",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","addListener",85],"(",["T_STRING","KernelEvents",85],["T_DOUBLE_COLON","::",85],["T_STRING","RESPONSE",85],",",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",["T_VARIABLE","$listener",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'checkRedirectUrl'",85],")",")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$event",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_NEW","new",86],["T_WHITESPACE"," ",86],["T_STRING","FilterResponseEvent",86],"(",["T_VARIABLE","$kernel",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$request",86],",",["T_WHITESPACE"," ",86],["T_STRING","HttpKernelInterface",86],["T_DOUBLE_COLON","::",86],["T_STRING","SUB_REQUEST",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$response",86],")",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$dispatcher",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","dispatch",87],"(",["T_STRING","KernelEvents",87],["T_DOUBLE_COLON","::",87],["T_STRING","RESPONSE",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$event",87],")",";",["T_WHITESPACE","\n\n    ",87],["T_VARIABLE","$target_url",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$event",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getResponse",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","getTargetUrl",89],"(",")",";",["T_WHITESPACE","\n    ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$expected",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n      ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertEquals",91],"(",["T_VARIABLE","$expected",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$target_url",91],")",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n    ",92],["T_ELSE","else",93],["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n      ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertEquals",94],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$target_url",94],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n  ",95],"}",["T_WHITESPACE","\n\n  ",96],["T_DOC_COMMENT","\/**\n   * Data provider for testDestinationRedirect().\n   *\n   * @see \\Drupal\\Tests\\Core\\EventSubscriber\\RedirectResponseSubscriberTest::testDestinationRedirect()\n   *\/",98],["T_WHITESPACE","\n  ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_STATIC","static",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","providerTestDestinationRedirect",103],"(",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n    ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_ARRAY","array",104],"(",["T_WHITESPACE","\n      ",104],["T_ARRAY","array",105],"(",["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","Request",105],"(",")",",",["T_WHITESPACE"," ",105],["T_STRING","FALSE",105],")",",",["T_WHITESPACE","\n      ",105],["T_ARRAY","array",106],"(",["T_NEW","new",106],["T_WHITESPACE"," ",106],["T_STRING","Request",106],"(",["T_ARRAY","array",106],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'test'",106],")",")",",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/test'",106],")",",",["T_WHITESPACE","\n      ",106],["T_ARRAY","array",107],"(",["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","Request",107],"(",["T_ARRAY","array",107],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'\/drupal\/test'",107],")",")",",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/test'",107],")",",",["T_WHITESPACE","\n      ",107],["T_ARRAY","array",108],"(",["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","Request",108],"(",["T_ARRAY","array",108],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'example.com'",108],")",")",",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/example.com'",108],")",",",["T_WHITESPACE","\n      ",108],["T_ARRAY","array",109],"(",["T_NEW","new",109],["T_WHITESPACE"," ",109],["T_STRING","Request",109],"(",["T_ARRAY","array",109],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'example:com'",109],")",")",",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/example:com'",109],")",",",["T_WHITESPACE","\n      ",109],["T_ARRAY","array",110],"(",["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Request",110],"(",["T_ARRAY","array",110],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'javascript:alert(0)'",110],")",")",",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/javascript:alert(0)'",110],")",",",["T_WHITESPACE","\n      ",110],["T_ARRAY","array",111],"(",["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","Request",111],"(",["T_ARRAY","array",111],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/'",111],")",")",",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/'",111],")",",",["T_WHITESPACE","\n      ",111],["T_ARRAY","array",112],"(",["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_STRING","Request",112],"(",["T_ARRAY","array",112],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/test'",112],")",")",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal\/test'",112],")",",",["T_WHITESPACE","\n    ",112],")",";",["T_WHITESPACE","\n  ",113],"}",["T_WHITESPACE","\n\n  ",114],["T_DOC_COMMENT","\/**\n   * @dataProvider providerTestDestinationRedirectToExternalUrl\n   *\n   * @expectedException \\PHPUnit_Framework_Error\n   *\/",116],["T_WHITESPACE","\n  ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","testDestinationRedirectToExternalUrl",121],"(",["T_VARIABLE","$request",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$expected",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n    ",121],["T_VARIABLE","$dispatcher",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","EventDispatcher",122],"(",")",";",["T_WHITESPACE","\n    ",122],["T_VARIABLE","$kernel",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getMock",123],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",123],")",";",["T_WHITESPACE","\n    ",123],["T_VARIABLE","$response",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_NEW","new",124],["T_WHITESPACE"," ",124],["T_STRING","RedirectResponse",124],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/other-example.com'",124],")",";",["T_WHITESPACE","\n\n    ",124],["T_VARIABLE","$listener",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_STRING","RedirectResponseSubscriber",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","urlAssembler",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","requestContext",126],")",";",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$dispatcher",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","addListener",127],"(",["T_STRING","KernelEvents",127],["T_DOUBLE_COLON","::",127],["T_STRING","RESPONSE",127],",",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_VARIABLE","$listener",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'checkRedirectUrl'",127],")",")",";",["T_WHITESPACE","\n    ",127],["T_VARIABLE","$event",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_STRING","FilterResponseEvent",128],"(",["T_VARIABLE","$kernel",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$request",128],",",["T_WHITESPACE"," ",128],["T_STRING","HttpKernelInterface",128],["T_DOUBLE_COLON","::",128],["T_STRING","SUB_REQUEST",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$response",128],")",";",["T_WHITESPACE","\n    ",128],["T_VARIABLE","$dispatcher",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","dispatch",129],"(",["T_STRING","KernelEvents",129],["T_DOUBLE_COLON","::",129],["T_STRING","RESPONSE",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$event",129],")",";",["T_WHITESPACE","\n\n    ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertEquals",131],"(",["T_LNUMBER","400",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$event",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getResponse",131],"(",")",["T_OBJECT_OPERATOR","->",131],["T_STRING","getStatusCode",131],"(",")",")",";",["T_WHITESPACE","\n  ",131],"}",["T_WHITESPACE","\n\n  ",132],["T_DOC_COMMENT","\/**\n   * @covers ::checkRedirectUrl\n   *\/",134],["T_WHITESPACE","\n  ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","testRedirectWithOptInExternalUrl",137],"(",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$dispatcher",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","EventDispatcher",138],"(",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$kernel",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getMock",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",139],")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$response",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_NEW","new",140],["T_WHITESPACE"," ",140],["T_STRING","TrustedRedirectResponse",140],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/external-url.com'",140],")",";",["T_WHITESPACE","\n    ",140],["T_VARIABLE","$request",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","Request",141],["T_DOUBLE_COLON","::",141],["T_STRING","create",141],"(",["T_CONSTANT_ENCAPSED_STRING","''",141],")",";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$request",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","headers",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","set",142],"(",["T_CONSTANT_ENCAPSED_STRING","'HOST'",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'example.com'",142],")",";",["T_WHITESPACE","\n\n    ",142],["T_VARIABLE","$listener",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_NEW","new",144],["T_WHITESPACE"," ",144],["T_STRING","RedirectResponseSubscriber",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","urlAssembler",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","requestContext",144],")",";",["T_WHITESPACE","\n    ",144],["T_VARIABLE","$dispatcher",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","addListener",145],"(",["T_STRING","KernelEvents",145],["T_DOUBLE_COLON","::",145],["T_STRING","RESPONSE",145],",",["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",["T_VARIABLE","$listener",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'checkRedirectUrl'",145],")",")",";",["T_WHITESPACE","\n    ",145],["T_VARIABLE","$event",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_NEW","new",146],["T_WHITESPACE"," ",146],["T_STRING","FilterResponseEvent",146],"(",["T_VARIABLE","$kernel",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$request",146],",",["T_WHITESPACE"," ",146],["T_STRING","HttpKernelInterface",146],["T_DOUBLE_COLON","::",146],["T_STRING","SUB_REQUEST",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$response",146],")",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$dispatcher",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","dispatch",147],"(",["T_STRING","KernelEvents",147],["T_DOUBLE_COLON","::",147],["T_STRING","RESPONSE",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$event",147],")",";",["T_WHITESPACE","\n\n    ",147],["T_VARIABLE","$target_url",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$event",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getResponse",149],"(",")",["T_OBJECT_OPERATOR","->",149],["T_STRING","getTargetUrl",149],"(",")",";",["T_WHITESPACE","\n    ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","assertEquals",150],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/external-url.com'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$target_url",150],")",";",["T_WHITESPACE","\n  ",150],"}",["T_WHITESPACE","\n\n  ",151],["T_DOC_COMMENT","\/**\n   * Data provider for testDestinationRedirectToExternalUrl().\n   *\/",153],["T_WHITESPACE","\n  ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","providerTestDestinationRedirectToExternalUrl",156],"(",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n    ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],"[",["T_WHITESPACE","\n      ",157],["T_CONSTANT_ENCAPSED_STRING","'absolute external url'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],"[",["T_NEW","new",158],["T_WHITESPACE"," ",158],["T_STRING","Request",158],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",158],"]",")",",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",158],"]",",",["T_WHITESPACE","\n      ",158],["T_CONSTANT_ENCAPSED_STRING","'absolute external url with folder'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],"[",["T_NEW","new",159],["T_WHITESPACE"," ",159],["T_STRING","Request",159],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/foobar'",159],"]",")",",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/foobar'",159],"]",",",["T_WHITESPACE","\n      ",159],["T_CONSTANT_ENCAPSED_STRING","'absolute external url with folder2'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],"[",["T_NEW","new",160],["T_WHITESPACE"," ",160],["T_STRING","Request",160],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.ca\/drupal'",160],"]",")",",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.ca\/drupal'",160],"]",",",["T_WHITESPACE","\n      ",160],["T_CONSTANT_ENCAPSED_STRING","'path without drupal basepath'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],"[",["T_NEW","new",161],["T_WHITESPACE"," ",161],["T_STRING","Request",161],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'\/test'",161],"]",")",",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/test'",161],"]",",",["T_WHITESPACE","\n      ",161],["T_CONSTANT_ENCAPSED_STRING","'path with URL'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],"[",["T_NEW","new",162],["T_WHITESPACE"," ",162],["T_STRING","Request",162],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'\/example.com'",162],"]",")",",",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/example.com'",162],"]",",",["T_WHITESPACE","\n      ",162],["T_CONSTANT_ENCAPSED_STRING","'path with URL and two slashes'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],"[",["T_NEW","new",163],["T_WHITESPACE"," ",163],["T_STRING","Request",163],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'\/\/example.com'",163],"]",")",",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/\/example.com'",163],"]",",",["T_WHITESPACE","\n    ",163],"]",";",["T_WHITESPACE","\n  ",164],"}",["T_WHITESPACE","\n\n  ",165],["T_DOC_COMMENT","\/**\n   * @expectedException \\PHPUnit_Framework_Error\n   *\n   * @dataProvider providerTestDestinationRedirectWithInvalidUrl\n   *\/",167],["T_WHITESPACE","\n  ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","testDestinationRedirectWithInvalidUrl",172],"(",["T_STRING","Request",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$request",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n    ",172],["T_VARIABLE","$dispatcher",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_NEW","new",173],["T_WHITESPACE"," ",173],["T_STRING","EventDispatcher",173],"(",")",";",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$kernel",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getMock",174],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",174],")",";",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$response",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_STRING","RedirectResponse",175],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/drupal'",175],")",";",["T_WHITESPACE","\n\n    ",175],["T_VARIABLE","$listener",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_NEW","new",177],["T_WHITESPACE"," ",177],["T_STRING","RedirectResponseSubscriber",177],"(",["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","urlAssembler",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","requestContext",177],")",";",["T_WHITESPACE","\n    ",177],["T_VARIABLE","$dispatcher",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","addListener",178],"(",["T_STRING","KernelEvents",178],["T_DOUBLE_COLON","::",178],["T_STRING","RESPONSE",178],",",["T_WHITESPACE"," ",178],["T_ARRAY","array",178],"(",["T_VARIABLE","$listener",178],",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'checkRedirectUrl'",178],")",")",";",["T_WHITESPACE","\n    ",178],["T_VARIABLE","$event",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_NEW","new",179],["T_WHITESPACE"," ",179],["T_STRING","FilterResponseEvent",179],"(",["T_VARIABLE","$kernel",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$request",179],",",["T_WHITESPACE"," ",179],["T_STRING","HttpKernelInterface",179],["T_DOUBLE_COLON","::",179],["T_STRING","SUB_REQUEST",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$response",179],")",";",["T_WHITESPACE","\n    ",179],["T_VARIABLE","$dispatcher",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","dispatch",180],"(",["T_STRING","KernelEvents",180],["T_DOUBLE_COLON","::",180],["T_STRING","RESPONSE",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$event",180],")",";",["T_WHITESPACE","\n\n    ",180],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","assertEquals",182],"(",["T_LNUMBER","400",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$event",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getResponse",182],"(",")",["T_OBJECT_OPERATOR","->",182],["T_STRING","getStatusCode",182],"(",")",")",";",["T_WHITESPACE","\n  ",182],"}",["T_WHITESPACE","\n\n  ",183],["T_DOC_COMMENT","\/**\n   * Data provider for testDestinationRedirectWithInvalidUrl().\n   *\/",185],["T_WHITESPACE","\n  ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","providerTestDestinationRedirectWithInvalidUrl",188],"(",")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n    ",188],["T_VARIABLE","$data",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],"[","]",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$data",190],"[","]",["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],"[",["T_NEW","new",190],["T_WHITESPACE"," ",190],["T_STRING","Request",190],"(",["T_ARRAY","array",190],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'\/\/example:com'",190],")",")","]",";",["T_WHITESPACE","\n    ",190],["T_VARIABLE","$data",191],"[","]",["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],"[",["T_NEW","new",191],["T_WHITESPACE"," ",191],["T_STRING","Request",191],"(",["T_ARRAY","array",191],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'\/\/example:com\/test'",191],")",")","]",";",["T_WHITESPACE","\n    ",191],["T_VARIABLE","$data",192],"[",["T_CONSTANT_ENCAPSED_STRING","'absolute external url'",192],"]",["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],"[",["T_NEW","new",192],["T_WHITESPACE"," ",192],["T_STRING","Request",192],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",192],"]",")","]",";",["T_WHITESPACE","\n    ",192],["T_VARIABLE","$data",193],"[",["T_CONSTANT_ENCAPSED_STRING","'absolute external url with folder'",193],"]",["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],"[",["T_NEW","new",193],["T_WHITESPACE"," ",193],["T_STRING","Request",193],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.ca\/drupal'",193],"]",")","]",";",["T_WHITESPACE","\n    ",193],["T_VARIABLE","$data",194],"[",["T_CONSTANT_ENCAPSED_STRING","'path without drupal basepath'",194],"]",["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],"[",["T_NEW","new",194],["T_WHITESPACE"," ",194],["T_STRING","Request",194],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'\/test'",194],"]",")","]",";",["T_WHITESPACE","\n    ",194],["T_VARIABLE","$data",195],"[",["T_CONSTANT_ENCAPSED_STRING","'path with URL'",195],"]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],"[",["T_NEW","new",195],["T_WHITESPACE"," ",195],["T_STRING","Request",195],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'\/example.com'",195],"]",")","]",";",["T_WHITESPACE","\n    ",195],["T_VARIABLE","$data",196],"[",["T_CONSTANT_ENCAPSED_STRING","'path with URL and two slashes'",196],"]",["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],"[",["T_NEW","new",196],["T_WHITESPACE"," ",196],["T_STRING","Request",196],"(","[",["T_CONSTANT_ENCAPSED_STRING","'destination'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'\/\/example.com'",196],"]",")","]",";",["T_WHITESPACE","\n\n    ",196],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$data",198],";",["T_WHITESPACE","\n  ",198],"}",["T_WHITESPACE","\n\n  ",199],["T_DOC_COMMENT","\/**\n   * Tests that $_GET only contain internal URLs.\n   *\n   * @covers ::sanitizeDestination\n   *\n   * @dataProvider providerTestSanitizeDestination\n   *\n   * @see \\Drupal\\Component\\Utility\\UrlHelper::isExternal\n   *\/",201],["T_WHITESPACE","\n  ",209],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","testSanitizeDestinationForGet",210],"(",["T_VARIABLE","$input",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$output",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n    ",210],["T_VARIABLE","$request",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_NEW","new",211],["T_WHITESPACE"," ",211],["T_STRING","Request",211],"(",")",";",["T_WHITESPACE","\n    ",211],["T_VARIABLE","$request",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","query",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","set",212],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$input",212],")",";",["T_WHITESPACE","\n\n    ",212],["T_VARIABLE","$listener",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_NEW","new",214],["T_WHITESPACE"," ",214],["T_STRING","RedirectResponseSubscriber",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","urlAssembler",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","requestContext",214],")",";",["T_WHITESPACE","\n    ",214],["T_VARIABLE","$kernel",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getMock",215],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",215],")",";",["T_WHITESPACE","\n    ",215],["T_VARIABLE","$event",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_NEW","new",216],["T_WHITESPACE"," ",216],["T_STRING","GetResponseEvent",216],"(",["T_VARIABLE","$kernel",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$request",216],",",["T_WHITESPACE"," ",216],["T_STRING","HttpKernelInterface",216],["T_DOUBLE_COLON","::",216],["T_STRING","MASTER_REQUEST",216],")",";",["T_WHITESPACE","\n\n    ",216],["T_VARIABLE","$dispatcher",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_NEW","new",218],["T_WHITESPACE"," ",218],["T_STRING","EventDispatcher",218],"(",")",";",["T_WHITESPACE","\n    ",218],["T_VARIABLE","$dispatcher",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","addListener",219],"(",["T_STRING","KernelEvents",219],["T_DOUBLE_COLON","::",219],["T_STRING","REQUEST",219],",",["T_WHITESPACE"," ",219],"[",["T_VARIABLE","$listener",219],",",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'sanitizeDestination'",219],"]",",",["T_WHITESPACE"," ",219],["T_LNUMBER","100",219],")",";",["T_WHITESPACE","\n    ",219],["T_VARIABLE","$dispatcher",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","dispatch",220],"(",["T_STRING","KernelEvents",220],["T_DOUBLE_COLON","::",220],["T_STRING","REQUEST",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$event",220],")",";",["T_WHITESPACE","\n\n    ",220],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","assertEquals",222],"(",["T_VARIABLE","$output",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$request",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","query",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","get",222],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",222],")",")",";",["T_WHITESPACE","\n  ",222],"}",["T_WHITESPACE","\n\n  ",223],["T_DOC_COMMENT","\/**\n   * Tests that $_REQUEST['destination'] only contain internal URLs.\n   *\n   * @covers ::sanitizeDestination\n   *\n   * @dataProvider providerTestSanitizeDestination\n   *\n   * @see \\Drupal\\Component\\Utility\\UrlHelper::isExternal\n   *\/",225],["T_WHITESPACE","\n  ",233],["T_PUBLIC","public",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","testSanitizeDestinationForPost",234],"(",["T_VARIABLE","$input",234],",",["T_WHITESPACE"," ",234],["T_VARIABLE","$output",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n    ",234],["T_VARIABLE","$request",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_NEW","new",235],["T_WHITESPACE"," ",235],["T_STRING","Request",235],"(",")",";",["T_WHITESPACE","\n    ",235],["T_VARIABLE","$request",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","request",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","set",236],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$input",236],")",";",["T_WHITESPACE","\n\n    ",236],["T_VARIABLE","$listener",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_NEW","new",238],["T_WHITESPACE"," ",238],["T_STRING","RedirectResponseSubscriber",238],"(",["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","urlAssembler",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","requestContext",238],")",";",["T_WHITESPACE","\n    ",238],["T_VARIABLE","$kernel",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getMock",239],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",239],")",";",["T_WHITESPACE","\n    ",239],["T_VARIABLE","$event",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_NEW","new",240],["T_WHITESPACE"," ",240],["T_STRING","GetResponseEvent",240],"(",["T_VARIABLE","$kernel",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$request",240],",",["T_WHITESPACE"," ",240],["T_STRING","HttpKernelInterface",240],["T_DOUBLE_COLON","::",240],["T_STRING","MASTER_REQUEST",240],")",";",["T_WHITESPACE","\n\n    ",240],["T_VARIABLE","$dispatcher",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_NEW","new",242],["T_WHITESPACE"," ",242],["T_STRING","EventDispatcher",242],"(",")",";",["T_WHITESPACE","\n    ",242],["T_VARIABLE","$dispatcher",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","addListener",243],"(",["T_STRING","KernelEvents",243],["T_DOUBLE_COLON","::",243],["T_STRING","REQUEST",243],",",["T_WHITESPACE"," ",243],"[",["T_VARIABLE","$listener",243],",",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'sanitizeDestination'",243],"]",",",["T_WHITESPACE"," ",243],["T_LNUMBER","100",243],")",";",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$dispatcher",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","dispatch",244],"(",["T_STRING","KernelEvents",244],["T_DOUBLE_COLON","::",244],["T_STRING","REQUEST",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$event",244],")",";",["T_WHITESPACE","\n\n    ",244],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","assertEquals",246],"(",["T_VARIABLE","$output",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$request",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","request",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","get",246],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",246],")",")",";",["T_WHITESPACE","\n  ",246],"}",["T_WHITESPACE","\n\n  ",247],["T_DOC_COMMENT","\/**\n   * Data provider for testSanitizeDestination().\n   *\/",249],["T_WHITESPACE","\n  ",251],["T_PUBLIC","public",252],["T_WHITESPACE"," ",252],["T_FUNCTION","function",252],["T_WHITESPACE"," ",252],["T_STRING","providerTestSanitizeDestination",252],"(",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n    ",252],["T_VARIABLE","$data",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],"[","]",";",["T_WHITESPACE","\n    ",253],["T_COMMENT","\/\/ Standard internal example node path is present in the 'destination'\n",254],["T_WHITESPACE","    ",255],["T_COMMENT","\/\/ parameter.\n",255],["T_WHITESPACE","    ",256],["T_VARIABLE","$data",256],"[","]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],"[",["T_CONSTANT_ENCAPSED_STRING","'node'",256],",",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'node'",256],"]",";",["T_WHITESPACE","\n    ",256],["T_COMMENT","\/\/ Internal path with one leading slash is allowed.\n",257],["T_WHITESPACE","    ",258],["T_VARIABLE","$data",258],"[","]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],"[",["T_CONSTANT_ENCAPSED_STRING","'\/example.com'",258],",",["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'\/example.com'",258],"]",";",["T_WHITESPACE","\n    ",258],["T_COMMENT","\/\/ External URL without scheme is not allowed.\n",259],["T_WHITESPACE","    ",260],["T_VARIABLE","$data",260],"[","]",["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],"[",["T_CONSTANT_ENCAPSED_STRING","'\/\/example.com\/test'",260],",",["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","''",260],"]",";",["T_WHITESPACE","\n    ",260],["T_COMMENT","\/\/ Internal URL using a colon is allowed.\n",261],["T_WHITESPACE","    ",262],["T_VARIABLE","$data",262],"[","]",["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],"[",["T_CONSTANT_ENCAPSED_STRING","'example:test'",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'example:test'",262],"]",";",["T_WHITESPACE","\n    ",262],["T_COMMENT","\/\/ External URL is not allowed.\n",263],["T_WHITESPACE","    ",264],["T_VARIABLE","$data",264],"[","]",["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],"[",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",264],",",["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","''",264],"]",";",["T_WHITESPACE","\n    ",264],["T_COMMENT","\/\/ Javascript URL is allowed because it is treated as an internal URL.\n",265],["T_WHITESPACE","    ",266],["T_VARIABLE","$data",266],"[","]",["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],"[",["T_CONSTANT_ENCAPSED_STRING","'javascript:alert(0)'",266],",",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'javascript:alert(0)'",266],"]",";",["T_WHITESPACE","\n\n    ",266],["T_RETURN","return",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$data",268],";",["T_WHITESPACE","\n  ",268],"}",["T_WHITESPACE","\n\n",269],"}",["T_WHITESPACE","\n",271]]