[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Batch",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Batch",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Percentage",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Tests",6],["T_NS_SEPARATOR","\\",6],["T_STRING","UnitTestCase",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * @coversDefaultClass \\Drupal\\Core\\Batch\\Percentage\n * @group Batch\n *\n * Tests the Batch helper object to make sure that the rounding works properly\n * in all cases.\n *\/",8],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","PercentagesTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","UnitTestCase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n  ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$testCases",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_ARRAY","array",16],"(",")",";",["T_WHITESPACE","\n\n  ",16],["T_DOC_COMMENT","\/**\n   * @dataProvider providerTestPercentages\n   * @covers ::format\n   *\/",18],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","testPercentages",22],"(",["T_VARIABLE","$total",22],",",["T_WHITESPACE"," ",22],["T_VARIABLE","$current",22],",",["T_WHITESPACE"," ",22],["T_VARIABLE","$expected_result",22],")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n    ",22],["T_VARIABLE","$actual_result",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_STRING","Percentage",23],["T_DOUBLE_COLON","::",23],["T_STRING","format",23],"(",["T_VARIABLE","$total",23],",",["T_WHITESPACE"," ",23],["T_VARIABLE","$current",23],")",";",["T_WHITESPACE","\n    ",23],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","assertEquals",24],"(",["T_VARIABLE","$actual_result",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$expected_result",24],",",["T_WHITESPACE"," ",24],["T_STRING","sprintf",24],"(",["T_CONSTANT_ENCAPSED_STRING","'The expected the batch api percentage at the state %s\/%s is %s%% and got %s%%.'",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$current",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$total",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$expected_result",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$actual_result",24],")",")",";",["T_WHITESPACE","\n  ",24],"}",["T_WHITESPACE","\n  ",25],["T_DOC_COMMENT","\/**\n   * Provide data for batch unit tests.\n   *\n   * @return array\n   *   An array of data used by the test.\n   *\/",26],["T_WHITESPACE","\n  ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","providerTestPercentages",32],"(",")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n    ",32],["T_COMMENT","\/\/ Set up an array of test cases.\n",33],["T_WHITESPACE","    ",34],["T_RETURN","return",34],["T_WHITESPACE"," ",34],["T_ARRAY","array",34],"(",["T_WHITESPACE","\n      ",34],["T_COMMENT","\/\/ array(total, current, expected).\n",35],["T_WHITESPACE","      ",36],["T_COMMENT","\/\/ 1\/2 is 50%.\n",36],["T_WHITESPACE","      ",37],["T_ARRAY","array",37],"(",["T_LNUMBER","2",37],",",["T_WHITESPACE"," ",37],["T_LNUMBER","1",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'50'",37],")",",",["T_WHITESPACE","\n      ",37],["T_COMMENT","\/\/ Though we should never encounter a case where the current set is set\n",38],["T_WHITESPACE","      ",39],["T_COMMENT","\/\/ 0, if we did, we should get 0%.\n",39],["T_WHITESPACE","      ",40],["T_ARRAY","array",40],"(",["T_LNUMBER","3",40],",",["T_WHITESPACE"," ",40],["T_LNUMBER","0",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'0'",40],")",",",["T_WHITESPACE","\n      ",40],["T_COMMENT","\/\/ 1\/3 is closer to 33% than to 34%.\n",41],["T_WHITESPACE","      ",42],["T_ARRAY","array",42],"(",["T_LNUMBER","3",42],",",["T_WHITESPACE"," ",42],["T_LNUMBER","1",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'33'",42],")",",",["T_WHITESPACE","\n      ",42],["T_COMMENT","\/\/ 2\/3 is closer to 67% than to 66%.\n",43],["T_WHITESPACE","      ",44],["T_ARRAY","array",44],"(",["T_LNUMBER","3",44],",",["T_WHITESPACE"," ",44],["T_LNUMBER","2",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'67'",44],")",",",["T_WHITESPACE","\n      ",44],["T_COMMENT","\/\/ 1\/199 should round up to 1%.\n",45],["T_WHITESPACE","      ",46],["T_ARRAY","array",46],"(",["T_LNUMBER","199",46],",",["T_WHITESPACE"," ",46],["T_LNUMBER","1",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'1'",46],")",",",["T_WHITESPACE","\n      ",46],["T_COMMENT","\/\/ 198\/199 should round down to 99%.\n",47],["T_WHITESPACE","      ",48],["T_ARRAY","array",48],"(",["T_LNUMBER","199",48],",",["T_WHITESPACE"," ",48],["T_LNUMBER","198",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'99'",48],")",",",["T_WHITESPACE","\n      ",48],["T_COMMENT","\/\/ 199\/200 would have rounded up to 100%, which would give the false\n",49],["T_WHITESPACE","      ",50],["T_COMMENT","\/\/ impression of being finished, so we add another digit and should get\n",50],["T_WHITESPACE","      ",51],["T_COMMENT","\/\/ 99.5%.\n",51],["T_WHITESPACE","      ",52],["T_ARRAY","array",52],"(",["T_LNUMBER","200",52],",",["T_WHITESPACE"," ",52],["T_LNUMBER","199",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'99.5'",52],")",",",["T_WHITESPACE","\n      ",52],["T_COMMENT","\/\/ The same logic holds for 1\/200: we should get 0.5%.\n",53],["T_WHITESPACE","      ",54],["T_ARRAY","array",54],"(",["T_LNUMBER","200",54],",",["T_WHITESPACE"," ",54],["T_LNUMBER","1",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'0.5'",54],")",",",["T_WHITESPACE","\n      ",54],["T_COMMENT","\/\/ Numbers that come out evenly, such as 50\/200, should be forced to have\n",55],["T_WHITESPACE","      ",56],["T_COMMENT","\/\/ extra digits for consistency.\n",56],["T_WHITESPACE","      ",57],["T_ARRAY","array",57],"(",["T_LNUMBER","200",57],",",["T_WHITESPACE"," ",57],["T_LNUMBER","50",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'25.0'",57],")",",",["T_WHITESPACE","\n      ",57],["T_COMMENT","\/\/ Regardless of number of digits we're using, 100% should always just be\n",58],["T_WHITESPACE","      ",59],["T_COMMENT","\/\/ 100%.\n",59],["T_WHITESPACE","      ",60],["T_ARRAY","array",60],"(",["T_LNUMBER","200",60],",",["T_WHITESPACE"," ",60],["T_LNUMBER","200",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'100'",60],")",",",["T_WHITESPACE","\n      ",60],["T_COMMENT","\/\/ 1998\/1999 should similarly round down to 99.9%.\n",61],["T_WHITESPACE","      ",62],["T_ARRAY","array",62],"(",["T_LNUMBER","1999",62],",",["T_WHITESPACE"," ",62],["T_LNUMBER","1998",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'99.9'",62],")",",",["T_WHITESPACE","\n      ",62],["T_COMMENT","\/\/ 1999\/2000 should add another digit and go to 99.95%.\n",63],["T_WHITESPACE","      ",64],["T_ARRAY","array",64],"(",["T_LNUMBER","2000",64],",",["T_WHITESPACE"," ",64],["T_LNUMBER","1999",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'99.95'",64],")",",",["T_WHITESPACE","\n      ",64],["T_COMMENT","\/\/ 19999\/20000 should add yet another digit and go to 99.995%.\n",65],["T_WHITESPACE","      ",66],["T_ARRAY","array",66],"(",["T_LNUMBER","20000",66],",",["T_WHITESPACE"," ",66],["T_LNUMBER","19999",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'99.995'",66],")",",",["T_WHITESPACE","\n      ",66],["T_COMMENT","\/\/ The next five test cases simulate a batch with a single operation\n",67],["T_WHITESPACE","      ",68],["T_COMMENT","\/\/ ('total' equals 1) that takes several steps to complete. Within the\n",68],["T_WHITESPACE","      ",69],["T_COMMENT","\/\/ operation, we imagine that there are 501 items to process, and 100 are\n",69],["T_WHITESPACE","      ",70],["T_COMMENT","\/\/ completed during each step. The percentages we get back should be\n",70],["T_WHITESPACE","      ",71],["T_COMMENT","\/\/ rounded the usual way for the first few passes (i.e., 20%, 40%, etc.),\n",71],["T_WHITESPACE","      ",72],["T_COMMENT","\/\/ but for the last pass through, when 500 out of 501 items have been\n",72],["T_WHITESPACE","      ",73],["T_COMMENT","\/\/ processed, we do not want to round up to 100%, since that would\n",73],["T_WHITESPACE","      ",74],["T_COMMENT","\/\/ erroneously indicate that the processing is complete.\n",74],["T_WHITESPACE","      ",75],["T_ARRAY","array",75],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_LNUMBER","1",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'current'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_LNUMBER","100",75],["T_WHITESPACE"," ",75],"\/",["T_WHITESPACE"," ",75],["T_LNUMBER","501",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'20'",75],")",",",["T_WHITESPACE","\n      ",75],["T_ARRAY","array",76],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_LNUMBER","1",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'current'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_LNUMBER","200",76],["T_WHITESPACE"," ",76],"\/",["T_WHITESPACE"," ",76],["T_LNUMBER","501",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'40'",76],")",",",["T_WHITESPACE","\n      ",76],["T_ARRAY","array",77],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_LNUMBER","1",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'current'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_LNUMBER","300",77],["T_WHITESPACE"," ",77],"\/",["T_WHITESPACE"," ",77],["T_LNUMBER","501",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'60'",77],")",",",["T_WHITESPACE","\n      ",77],["T_ARRAY","array",78],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_LNUMBER","1",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'current'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_LNUMBER","400",78],["T_WHITESPACE"," ",78],"\/",["T_WHITESPACE"," ",78],["T_LNUMBER","501",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'80'",78],")",",",["T_WHITESPACE","\n      ",78],["T_ARRAY","array",79],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_LNUMBER","1",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'current'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_LNUMBER","500",79],["T_WHITESPACE"," ",79],"\/",["T_WHITESPACE"," ",79],["T_LNUMBER","501",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'99.8'",79],")",",",["T_WHITESPACE","\n    ",79],")",";",["T_WHITESPACE","\n  ",80],"}",["T_WHITESPACE","\n\n",81],"}",["T_WHITESPACE","\n",83]]