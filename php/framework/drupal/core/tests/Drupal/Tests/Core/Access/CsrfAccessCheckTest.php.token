[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Core",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Access",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Access",5],["T_NS_SEPARATOR","\\",5],["T_STRING","AccessResult",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Symfony",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","HttpFoundation",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Request",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Symfony",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Component",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Routing",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Route",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Access",8],["T_NS_SEPARATOR","\\",8],["T_STRING","CsrfAccessCheck",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Tests",9],["T_NS_SEPARATOR","\\",9],["T_STRING","UnitTestCase",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * @coversDefaultClass \\Drupal\\Core\\Access\\CsrfAccessCheck\n * @group Access\n *\/",11],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","CsrfAccessCheckTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","UnitTestCase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * The mock CSRF token generator.\n   *\n   * @var \\Drupal\\Core\\Access\\CsrfTokenGenerator|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$csrfToken",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The access checker.\n   *\n   * @var \\Drupal\\Core\\Access\\CsrfAccessCheck\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$accessCheck",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * The mock route match.\n   *\n   * @var \\Drupal\\Core\\RouteMatch\\RouteMatchInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",31],["T_WHITESPACE","\n  ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$routeMatch",36],";",["T_WHITESPACE","\n\n  ",36],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","setUp",38],"(",")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","csrfToken",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getMockBuilder",39],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Access\\CsrfTokenGenerator'",39],")",["T_WHITESPACE","\n      ",39],["T_OBJECT_OPERATOR","->",40],["T_STRING","disableOriginalConstructor",40],"(",")",["T_WHITESPACE","\n      ",40],["T_OBJECT_OPERATOR","->",41],["T_STRING","getMock",41],"(",")",";",["T_WHITESPACE","\n\n    ",41],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","routeMatch",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getMock",43],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Routing\\RouteMatchInterface'",43],")",";",["T_WHITESPACE","\n\n    ",43],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","accessCheck",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_NEW","new",45],["T_WHITESPACE"," ",45],["T_STRING","CsrfAccessCheck",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","csrfToken",45],")",";",["T_WHITESPACE","\n  ",45],"}",["T_WHITESPACE","\n\n  ",46],["T_DOC_COMMENT","\/**\n   * Tests the access() method with a valid token.\n   *\/",48],["T_WHITESPACE","\n  ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","testAccessTokenPass",51],"(",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","csrfToken",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","expects",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","once",52],"(",")",")",["T_WHITESPACE","\n      ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","method",53],"(",["T_CONSTANT_ENCAPSED_STRING","'validate'",53],")",["T_WHITESPACE","\n      ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","with",54],"(",["T_CONSTANT_ENCAPSED_STRING","'test_query'",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'test-path\/42'",54],")",["T_WHITESPACE","\n      ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","will",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","returnValue",55],"(",["T_STRING","TRUE",55],")",")",";",["T_WHITESPACE","\n\n    ",55],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","routeMatch",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","expects",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","once",57],"(",")",")",["T_WHITESPACE","\n      ",57],["T_OBJECT_OPERATOR","->",58],["T_STRING","method",58],"(",["T_CONSTANT_ENCAPSED_STRING","'getRawParameters'",58],")",["T_WHITESPACE","\n      ",58],["T_OBJECT_OPERATOR","->",59],["T_STRING","will",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","returnValue",59],"(",["T_ARRAY","array",59],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_LNUMBER","42",59],")",")",")",";",["T_WHITESPACE","\n\n    ",59],["T_VARIABLE","$route",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_NEW","new",61],["T_WHITESPACE"," ",61],["T_STRING","Route",61],"(",["T_CONSTANT_ENCAPSED_STRING","'\/test-path\/{node}'",61],",",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",",",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",["T_CONSTANT_ENCAPSED_STRING","'_csrf_token'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'TRUE'",61],")",")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$request",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","Request",62],["T_DOUBLE_COLON","::",62],["T_STRING","create",62],"(",["T_CONSTANT_ENCAPSED_STRING","'\/test-path\/42?token=test_query'",62],")",";",["T_WHITESPACE","\n\n    ",62],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertEquals",64],"(",["T_STRING","AccessResult",64],["T_DOUBLE_COLON","::",64],["T_STRING","allowed",64],"(",")",["T_OBJECT_OPERATOR","->",64],["T_STRING","setCacheMaxAge",64],"(",["T_LNUMBER","0",64],")",",",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","accessCheck",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","access",64],"(",["T_VARIABLE","$route",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$request",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","routeMatch",64],")",")",";",["T_WHITESPACE","\n  ",64],"}",["T_WHITESPACE","\n\n  ",65],["T_DOC_COMMENT","\/**\n   * Tests the access() method with an invalid token.\n   *\/",67],["T_WHITESPACE","\n  ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","testAccessTokenFail",70],"(",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","csrfToken",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","expects",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","once",71],"(",")",")",["T_WHITESPACE","\n      ",71],["T_OBJECT_OPERATOR","->",72],["T_STRING","method",72],"(",["T_CONSTANT_ENCAPSED_STRING","'validate'",72],")",["T_WHITESPACE","\n      ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","with",73],"(",["T_CONSTANT_ENCAPSED_STRING","'test_query'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'test-path'",73],")",["T_WHITESPACE","\n      ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","will",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","returnValue",74],"(",["T_STRING","FALSE",74],")",")",";",["T_WHITESPACE","\n\n    ",74],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","routeMatch",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","expects",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","once",76],"(",")",")",["T_WHITESPACE","\n      ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","method",77],"(",["T_CONSTANT_ENCAPSED_STRING","'getRawParameters'",77],")",["T_WHITESPACE","\n      ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","will",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","returnValue",78],"(",["T_ARRAY","array",78],"(",")",")",")",";",["T_WHITESPACE","\n\n    ",78],["T_VARIABLE","$route",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_NEW","new",80],["T_WHITESPACE"," ",80],["T_STRING","Route",80],"(",["T_CONSTANT_ENCAPSED_STRING","'\/test-path'",80],",",["T_WHITESPACE"," ",80],["T_ARRAY","array",80],"(",")",",",["T_WHITESPACE"," ",80],["T_ARRAY","array",80],"(",["T_CONSTANT_ENCAPSED_STRING","'_csrf_token'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'TRUE'",80],")",")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$request",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","Request",81],["T_DOUBLE_COLON","::",81],["T_STRING","create",81],"(",["T_CONSTANT_ENCAPSED_STRING","'\/test-path?token=test_query'",81],")",";",["T_WHITESPACE","\n\n    ",81],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertEquals",83],"(",["T_STRING","AccessResult",83],["T_DOUBLE_COLON","::",83],["T_STRING","forbidden",83],"(",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","setCacheMaxAge",83],"(",["T_LNUMBER","0",83],")",",",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","accessCheck",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","access",83],"(",["T_VARIABLE","$route",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$request",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","routeMatch",83],")",")",";",["T_WHITESPACE","\n  ",83],"}",["T_WHITESPACE","\n\n",84],"}",["T_WHITESPACE","\n",86]]