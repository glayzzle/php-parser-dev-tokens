[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Component",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Utility",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Tests",5],["T_NS_SEPARATOR","\\",5],["T_STRING","UnitTestCase",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Utility",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Crypt",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests random byte generation.\n *\n * @group Utility\n *\n * @coversDefaultClass \\Drupal\\Component\\Utility\\Crypt\n *\/",8],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","CryptTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","UnitTestCase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Tests random byte generation.\n   *\n   * @covers ::randomBytes\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","testRandomBytes",22],"(",")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n    ",22],["T_FOR","for",23],["T_WHITESPACE"," ",23],"(",["T_VARIABLE","$i",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_LNUMBER","1",23],";",["T_WHITESPACE"," ",23],["T_VARIABLE","$i",23],["T_WHITESPACE"," ",23],"<",["T_WHITESPACE"," ",23],["T_LNUMBER","10",23],";",["T_WHITESPACE"," ",23],["T_VARIABLE","$i",23],["T_INC","++",23],")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n      ",23],["T_VARIABLE","$count",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","rand",24],"(",["T_LNUMBER","10",24],",",["T_WHITESPACE"," ",24],["T_LNUMBER","10000",24],")",";",["T_WHITESPACE","\n      ",24],["T_COMMENT","\/\/ Check that different values are being generated.\n",25],["T_WHITESPACE","      ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","assertNotEquals",26],"(",["T_STRING","Crypt",26],["T_DOUBLE_COLON","::",26],["T_STRING","randomBytes",26],"(",["T_VARIABLE","$count",26],")",",",["T_WHITESPACE"," ",26],["T_STRING","Crypt",26],["T_DOUBLE_COLON","::",26],["T_STRING","randomBytes",26],"(",["T_VARIABLE","$count",26],")",")",";",["T_WHITESPACE","\n      ",26],["T_COMMENT","\/\/ Check the length.\n",27],["T_WHITESPACE","      ",28],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","assertEquals",28],"(",["T_STRING","strlen",28],"(",["T_STRING","Crypt",28],["T_DOUBLE_COLON","::",28],["T_STRING","randomBytes",28],"(",["T_VARIABLE","$count",28],")",")",",",["T_WHITESPACE"," ",28],["T_VARIABLE","$count",28],")",";",["T_WHITESPACE","\n    ",28],"}",["T_WHITESPACE","\n  ",29],"}",["T_WHITESPACE","\n\n  ",30],["T_DOC_COMMENT","\/**\n   * Tests hash generation.\n   *\n   * @dataProvider providerTestHashBase64\n   * @covers ::hashBase64\n   *\n   * @param string $data\n   *   Data to hash.\n   * @param string $expected_hash\n   *   Expected result from hashing $data.\n   *\/",32],["T_WHITESPACE","\n  ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","testHashBase64",43],"(",["T_VARIABLE","$data",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$expected_hash",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$hash",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","Crypt",44],["T_DOUBLE_COLON","::",44],["T_STRING","hashBase64",44],"(",["T_VARIABLE","$data",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertEquals",45],"(",["T_VARIABLE","$expected_hash",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$hash",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'The correct hash was not calculated.'",45],")",";",["T_WHITESPACE","\n  ",45],"}",["T_WHITESPACE","\n\n  ",46],["T_DOC_COMMENT","\/**\n   * Tests HMAC generation.\n   *\n   * @dataProvider providerTestHmacBase64\n   * @covers ::hmacBase64\n   *\n   * @param string $data\n   *   Data to hash.\n   * @param string $key\n   *   Key to use in hashing process.\n   * @param string $expected_hmac\n   *   Expected result from hashing $data using $key.\n   *\/",48],["T_WHITESPACE","\n  ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","testHmacBase64",61],"(",["T_VARIABLE","$data",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$key",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$expected_hmac",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$hmac",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","Crypt",62],["T_DOUBLE_COLON","::",62],["T_STRING","hmacBase64",62],"(",["T_VARIABLE","$data",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$key",62],")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertEquals",63],"(",["T_VARIABLE","$expected_hmac",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$hmac",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'The correct hmac was not calculated.'",63],")",";",["T_WHITESPACE","\n  ",63],"}",["T_WHITESPACE","\n\n  ",64],["T_DOC_COMMENT","\/**\n   * Tests the hmacBase64 method with invalid parameters.\n   *\n   * @dataProvider providerTestHmacBase64Invalid\n   * @expectedException InvalidArgumentException\n   * @covers ::hmacBase64\n   *\n   * @param string $data\n   *   Data to hash.\n   * @param string $key\n   *   Key to use in hashing process.\n   *\/",66],["T_WHITESPACE","\n  ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","testHmacBase64Invalid",78],"(",["T_VARIABLE","$data",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$key",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n    ",78],["T_STRING","Crypt",79],["T_DOUBLE_COLON","::",79],["T_STRING","hmacBase64",79],"(",["T_VARIABLE","$data",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$key",79],")",";",["T_WHITESPACE","\n  ",79],"}",["T_WHITESPACE","\n\n  ",80],["T_DOC_COMMENT","\/**\n   * Provides data for self::testHashBase64().\n   *\n   * @return array Test data.\n   *\/",82],["T_WHITESPACE","\n  ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","providerTestHashBase64",87],"(",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n    ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_WHITESPACE","\n      ",88],["T_ARRAY","array",89],"(",["T_WHITESPACE","\n        ",89],["T_CONSTANT_ENCAPSED_STRING","'data'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'The SHA (Secure Hash Algorithm) is one of a number of cryptographic hash functions. A cryptographic hash is like a signature for a text or a data file. SHA-256 algorithm generates an almost-unique, fixed size 256-bit (32-byte) hash. Hash is a one way function \u00e2\u0080\u0093 it cannot be decrypted back. This makes it suitable for password validation, challenge hash authentication, anti-tamper, digital signatures.'",90],",",["T_WHITESPACE","\n        ",90],["T_CONSTANT_ENCAPSED_STRING","'expectedHash'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'034rT6smZAVRxpq8O98cFFNLIVx_Ph1EwLZQKcmRR_s'",91],",",["T_WHITESPACE","\n      ",91],")",",",["T_WHITESPACE","\n      ",92],["T_ARRAY","array",93],"(",["T_WHITESPACE","\n        ",93],["T_CONSTANT_ENCAPSED_STRING","'data'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'SHA-256 is one of the successor hash functions to SHA-1, and is one of the strongest hash functions available.'",94],",",["T_WHITESPACE","\n        ",94],["T_CONSTANT_ENCAPSED_STRING","'expected_hash'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'yuqkDDYqprL71k4xIb6K6D7n76xldO4jseRhEkEE6SI'",95],",",["T_WHITESPACE","\n      ",95],")",",",["T_WHITESPACE","\n    ",96],")",";",["T_WHITESPACE","\n  ",97],"}",["T_WHITESPACE","\n\n  ",98],["T_DOC_COMMENT","\/**\n   * Provides data for self::testHmacBase64().\n   *\n   * @return array Test data.\n   *\/",100],["T_WHITESPACE","\n  ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","providerTestHmacBase64",105],"(",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n    ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_ARRAY","array",106],"(",["T_WHITESPACE","\n      ",106],["T_ARRAY","array",107],"(",["T_WHITESPACE","\n        ",107],["T_CONSTANT_ENCAPSED_STRING","'data'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'Calculates a base-64 encoded, URL-safe sha-256 hmac.'",108],",",["T_WHITESPACE","\n        ",108],["T_CONSTANT_ENCAPSED_STRING","'key'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'secret-key'",109],",",["T_WHITESPACE","\n        ",109],["T_CONSTANT_ENCAPSED_STRING","'expected_hmac'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'2AaH63zwjhekWZlEpAiufyfhAHIzbQhl9Hd9oCi3_c8'",110],",",["T_WHITESPACE","\n      ",110],")",",",["T_WHITESPACE","\n    ",111],")",";",["T_WHITESPACE","\n  ",112],"}",["T_WHITESPACE","\n\n  ",113],["T_DOC_COMMENT","\/**\n   * Provides data for self::testHmacBase64().\n   *\n   * @return array Test data.\n   *\/",115],["T_WHITESPACE","\n  ",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","providerTestHmacBase64Invalid",120],"(",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n    ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_ARRAY","array",121],"(",["T_WHITESPACE","\n      ",121],["T_ARRAY","array",122],"(",["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_NS_SEPARATOR","\\",122],["T_STRING","stdClass",122],"(",")",",",["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_NS_SEPARATOR","\\",122],["T_STRING","stdClass",122],"(",")",")",",",["T_WHITESPACE","\n      ",122],["T_ARRAY","array",123],"(",["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_NS_SEPARATOR","\\",123],["T_STRING","stdClass",123],"(",")",",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'string'",123],")",",",["T_WHITESPACE","\n      ",123],["T_ARRAY","array",124],"(",["T_NEW","new",124],["T_WHITESPACE"," ",124],["T_NS_SEPARATOR","\\",124],["T_STRING","stdClass",124],"(",")",",",["T_WHITESPACE"," ",124],["T_LNUMBER","1",124],")",",",["T_WHITESPACE","\n      ",124],["T_ARRAY","array",125],"(",["T_NEW","new",125],["T_WHITESPACE"," ",125],["T_NS_SEPARATOR","\\",125],["T_STRING","stdClass",125],"(",")",",",["T_WHITESPACE"," ",125],["T_LNUMBER","0",125],")",",",["T_WHITESPACE","\n      ",125],["T_ARRAY","array",126],"(",["T_STRING","NULL",126],",",["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","stdClass",126],"(",")",")",",",["T_WHITESPACE","\n      ",126],["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",127],",",["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_NS_SEPARATOR","\\",127],["T_STRING","stdClass",127],"(",")",")",",",["T_WHITESPACE","\n      ",127],["T_ARRAY","array",128],"(",["T_LNUMBER","1",128],",",["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_NS_SEPARATOR","\\",128],["T_STRING","stdClass",128],"(",")",")",",",["T_WHITESPACE","\n      ",128],["T_ARRAY","array",129],"(",["T_LNUMBER","0",129],",",["T_WHITESPACE"," ",129],["T_NEW","new",129],["T_WHITESPACE"," ",129],["T_NS_SEPARATOR","\\",129],["T_STRING","stdClass",129],"(",")",")",",",["T_WHITESPACE","\n      ",129],["T_ARRAY","array",130],"(",["T_ARRAY","array",130],"(",")",",",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",")",")",",",["T_WHITESPACE","\n      ",130],["T_ARRAY","array",131],"(",["T_ARRAY","array",131],"(",")",",",["T_WHITESPACE"," ",131],["T_STRING","NULL",131],")",",",["T_WHITESPACE","\n      ",131],["T_ARRAY","array",132],"(",["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'string'",132],")",",",["T_WHITESPACE","\n      ",132],["T_ARRAY","array",133],"(",["T_ARRAY","array",133],"(",")",",",["T_WHITESPACE"," ",133],["T_LNUMBER","1",133],")",",",["T_WHITESPACE","\n      ",133],["T_ARRAY","array",134],"(",["T_ARRAY","array",134],"(",")",",",["T_WHITESPACE"," ",134],["T_LNUMBER","0",134],")",",",["T_WHITESPACE","\n      ",134],["T_ARRAY","array",135],"(",["T_STRING","NULL",135],",",["T_WHITESPACE"," ",135],["T_ARRAY","array",135],"(",")",")",",",["T_WHITESPACE","\n      ",135],["T_ARRAY","array",136],"(",["T_LNUMBER","1",136],",",["T_WHITESPACE"," ",136],["T_ARRAY","array",136],"(",")",")",",",["T_WHITESPACE","\n      ",136],["T_ARRAY","array",137],"(",["T_LNUMBER","0",137],",",["T_WHITESPACE"," ",137],["T_ARRAY","array",137],"(",")",")",",",["T_WHITESPACE","\n      ",137],["T_ARRAY","array",138],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",138],",",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",")",")",",",["T_WHITESPACE","\n      ",138],["T_ARRAY","array",139],"(",["T_ARRAY","array",139],"(",")",",",["T_WHITESPACE"," ",139],["T_STRING","NULL",139],")",",",["T_WHITESPACE","\n      ",139],["T_ARRAY","array",140],"(",["T_STRING","NULL",140],",",["T_WHITESPACE"," ",140],["T_STRING","NULL",140],")",",",["T_WHITESPACE","\n      ",140],["T_ARRAY","array",141],"(",["T_STRING","NULL",141],",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'string'",141],")",",",["T_WHITESPACE","\n      ",141],["T_ARRAY","array",142],"(",["T_STRING","NULL",142],",",["T_WHITESPACE"," ",142],["T_LNUMBER","1",142],")",",",["T_WHITESPACE","\n      ",142],["T_ARRAY","array",143],"(",["T_STRING","NULL",143],",",["T_WHITESPACE"," ",143],["T_LNUMBER","0",143],")",",",["T_WHITESPACE","\n      ",143],["T_ARRAY","array",144],"(",["T_LNUMBER","1",144],",",["T_WHITESPACE"," ",144],["T_STRING","NULL",144],")",",",["T_WHITESPACE","\n      ",144],["T_ARRAY","array",145],"(",["T_LNUMBER","0",145],",",["T_WHITESPACE"," ",145],["T_STRING","NULL",145],")",",",["T_WHITESPACE","\n      ",145],["T_ARRAY","array",146],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",146],",",["T_WHITESPACE"," ",146],["T_STRING","NULL",146],")",",",["T_WHITESPACE","\n    ",146],")",";",["T_WHITESPACE","\n  ",147],"}",["T_WHITESPACE","\n\n",148],"}",["T_WHITESPACE","\n",150]]