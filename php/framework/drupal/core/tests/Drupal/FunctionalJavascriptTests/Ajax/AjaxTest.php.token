[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","FunctionalJavascriptTests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Ajax",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FunctionalJavascriptTests",5],["T_NS_SEPARATOR","\\",5],["T_STRING","JavascriptTestBase",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests AJAX responses.\n *\n * @group Ajax\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","AjaxTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","JavascriptTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",14],["T_WHITESPACE","\n  ",16],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_STATIC","static",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$modules",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],"[",["T_CONSTANT_ENCAPSED_STRING","'ajax_test'",17],"]",";",["T_WHITESPACE","\n\n  ",17],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_FUNCTION","function",19],["T_WHITESPACE"," ",19],["T_STRING","testAjaxWithAdminRoute",19],"(",")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n    ",19],["T_NS_SEPARATOR","\\",20],["T_STRING","Drupal",20],["T_DOUBLE_COLON","::",20],["T_STRING","service",20],"(",["T_CONSTANT_ENCAPSED_STRING","'theme_installer'",20],")",["T_OBJECT_OPERATOR","->",20],["T_STRING","install",20],"(","[",["T_CONSTANT_ENCAPSED_STRING","'stable'",20],",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'seven'",20],"]",")",";",["T_WHITESPACE","\n    ",20],["T_VARIABLE","$theme_config",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Drupal",21],["T_DOUBLE_COLON","::",21],["T_STRING","configFactory",21],"(",")",["T_OBJECT_OPERATOR","->",21],["T_STRING","getEditable",21],"(",["T_CONSTANT_ENCAPSED_STRING","'system.theme'",21],")",";",["T_WHITESPACE","\n    ",21],["T_VARIABLE","$theme_config",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","set",22],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'seven'",22],")",";",["T_WHITESPACE","\n    ",22],["T_VARIABLE","$theme_config",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","set",23],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",23],",",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'stable'",23],")",";",["T_WHITESPACE","\n    ",23],["T_VARIABLE","$theme_config",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","save",24],"(",")",";",["T_WHITESPACE","\n\n    ",24],["T_VARIABLE","$account",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","drupalCreateUser",26],"(","[",["T_CONSTANT_ENCAPSED_STRING","'view the administration theme'",26],"]",")",";",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","drupalLogin",27],"(",["T_VARIABLE","$account",27],")",";",["T_WHITESPACE","\n\n    ",27],["T_COMMENT","\/\/ First visit the site directly via the URL. This should render it in the\n",29],["T_WHITESPACE","    ",30],["T_COMMENT","\/\/ admin theme.\n",30],["T_WHITESPACE","    ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","drupalGet",31],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/ajax-test\/theme'",31],")",";",["T_WHITESPACE","\n    ",31],["T_VARIABLE","$assert",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","assertSession",32],"(",")",";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$assert",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","pageTextContains",33],"(",["T_CONSTANT_ENCAPSED_STRING","'Current theme: seven'",33],")",";",["T_WHITESPACE","\n\n    ",33],["T_COMMENT","\/\/ Now click the modal, which should also use the admin theme.\n",35],["T_WHITESPACE","    ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","drupalGet",36],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax-test\/dialog'",36],")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$assert",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","pageTextNotContains",37],"(",["T_CONSTANT_ENCAPSED_STRING","'Current theme: stable'",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","clickLink",38],"(",["T_CONSTANT_ENCAPSED_STRING","'Link 8 (ajax)'",38],")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$assert",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","assertWaitOnAjaxRequest",39],"(",")",";",["T_WHITESPACE","\n\n    ",39],["T_VARIABLE","$assert",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","pageTextContains",41],"(",["T_CONSTANT_ENCAPSED_STRING","'Current theme: stable'",41],")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$assert",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","pageTextNotContains",42],"(",["T_CONSTANT_ENCAPSED_STRING","'Current theme: seven'",42],")",";",["T_WHITESPACE","\n  ",42],"}",["T_WHITESPACE","\n\n  ",43],["T_DOC_COMMENT","\/**\n   * Test that AJAX loaded libraries are not retained between requests.\n   *\n   * @see https:\/\/www.drupal.org\/node\/2647916\n   *\/",45],["T_WHITESPACE","\n  ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","testDrupalSettingsCachingRegression",50],"(",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalGet",51],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax-test\/dialog'",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$assert",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","assertSession",52],"(",")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$session",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getSession",53],"(",")",";",["T_WHITESPACE","\n\n    ",53],["T_COMMENT","\/\/ Insert a fake library into the already loaded library settings.\n",55],["T_WHITESPACE","    ",56],["T_VARIABLE","$fake_library",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'fakeLibrary\/fakeLibrary'",56],";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$session",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","evaluateScript",57],"(","\"",["T_ENCAPSED_AND_WHITESPACE","drupalSettings.ajaxPageState.libraries = drupalSettings.ajaxPageState.libraries + ',",57],["T_VARIABLE","$fake_library",57],["T_ENCAPSED_AND_WHITESPACE","';",57],"\"",")",";",["T_WHITESPACE","\n\n    ",57],["T_VARIABLE","$libraries",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$session",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","evaluateScript",59],"(",["T_CONSTANT_ENCAPSED_STRING","'drupalSettings.ajaxPageState.libraries'",59],")",";",["T_WHITESPACE","\n    ",59],["T_COMMENT","\/\/ Test that the fake library is set.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertContains",61],"(",["T_VARIABLE","$fake_library",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$libraries",61],")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ Click on the AJAX link.\n",63],["T_WHITESPACE","    ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","clickLink",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Link 8 (ajax)'",64],")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$assert",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertWaitOnAjaxRequest",65],"(",")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ Test that the fake library is still set after the AJAX call.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$libraries",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$session",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","evaluateScript",68],"(",["T_CONSTANT_ENCAPSED_STRING","'drupalSettings.ajaxPageState.libraries'",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertContains",69],"(",["T_VARIABLE","$fake_library",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$libraries",69],")",";",["T_WHITESPACE","\n\n    ",69],["T_COMMENT","\/\/ Reload the page, this should reset the loaded libraries and remove the\n",71],["T_WHITESPACE","    ",72],["T_COMMENT","\/\/ fake library.\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","drupalGet",73],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax-test\/dialog'",73],")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$libraries",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$session",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","evaluateScript",74],"(",["T_CONSTANT_ENCAPSED_STRING","'drupalSettings.ajaxPageState.libraries'",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertNotContains",75],"(",["T_VARIABLE","$fake_library",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$libraries",75],")",";",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Click on the AJAX link again, and the libraries should still not contain\n",77],["T_WHITESPACE","    ",78],["T_COMMENT","\/\/ the fake library.\n",78],["T_WHITESPACE","    ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","clickLink",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Link 8 (ajax)'",79],")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$assert",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","assertWaitOnAjaxRequest",80],"(",")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$libraries",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$session",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","evaluateScript",81],"(",["T_CONSTANT_ENCAPSED_STRING","'drupalSettings.ajaxPageState.libraries'",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertNotContains",82],"(",["T_VARIABLE","$fake_library",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$libraries",82],")",";",["T_WHITESPACE","\n  ",82],"}",["T_WHITESPACE","\n\n",83],"}",["T_WHITESPACE","\n",85]]