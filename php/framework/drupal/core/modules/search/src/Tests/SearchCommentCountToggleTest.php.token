[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","search",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","comment",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Plugin",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Field",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FieldType",5],["T_NS_SEPARATOR","\\",5],["T_STRING","CommentItemInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","comment",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Tests",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CommentTestTrait",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Tests that comment count display toggles properly on comment status of node.\n *\n * Issue 537278\n *\n * - Nodes with comment status set to Open should always how comment counts\n * - Nodes with comment status set to Closed should show comment counts\n *     only when there are comments\n * - Nodes with comment status set to Hidden should never show comment counts\n *\n * @group search\n *\/",8],["T_WHITESPACE","\n",19],["T_CLASS","class",20],["T_WHITESPACE"," ",20],["T_STRING","SearchCommentCountToggleTest",20],["T_WHITESPACE"," ",20],["T_EXTENDS","extends",20],["T_WHITESPACE"," ",20],["T_STRING","SearchTestBase",20],["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n\n  ",20],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","CommentTestTrait",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PUBLIC","public",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$modules",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",29],",",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'comment'",29],")",";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * A user with permission to search and post comments.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",31],["T_WHITESPACE","\n  ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$searchingUser",36],";",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * Array of nodes available to search.\n   *\n   * @var \\Drupal\\node\\NodeInterface[]\n   *\/",38],["T_WHITESPACE","\n  ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$searchableNodes",43],";",["T_WHITESPACE","\n\n  ",43],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","setUp",45],"(",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_STRING","parent",46],["T_DOUBLE_COLON","::",46],["T_STRING","setUp",46],"(",")",";",["T_WHITESPACE","\n\n    ",46],["T_COMMENT","\/\/ Create searching user.\n",48],["T_WHITESPACE","    ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","searchingUser",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","drupalCreateUser",49],"(",["T_ARRAY","array",49],"(",["T_CONSTANT_ENCAPSED_STRING","'search content'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'access content'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'access comments'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'post comments'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'skip comment approval'",49],")",")",";",["T_WHITESPACE","\n\n    ",49],["T_COMMENT","\/\/ Log in with sufficient privileges.\n",51],["T_WHITESPACE","    ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","drupalLogin",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","searchingUser",52],")",";",["T_WHITESPACE","\n\n    ",52],["T_COMMENT","\/\/ Add a comment field.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","addDefaultCommentField",55],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",55],",",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'article'",55],")",";",["T_WHITESPACE","\n    ",55],["T_COMMENT","\/\/ Create initial nodes.\n",56],["T_WHITESPACE","    ",57],["T_VARIABLE","$node_params",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'article'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'body'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_ARRAY","array",57],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'SearchCommentToggleTestCase'",57],")",")",")",";",["T_WHITESPACE","\n\n    ",57],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","searchableNodes",59],"[",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",59],"]",["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","drupalCreateNode",59],"(",["T_VARIABLE","$node_params",59],")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","searchableNodes",60],"[",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","drupalCreateNode",60],"(",["T_VARIABLE","$node_params",60],")",";",["T_WHITESPACE","\n\n    ",60],["T_COMMENT","\/\/ Create a comment array\n",62],["T_WHITESPACE","    ",63],["T_VARIABLE","$edit_comment",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",")",";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$edit_comment",64],"[",["T_CONSTANT_ENCAPSED_STRING","'subject[0][value]'",64],"]",["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","randomMachineName",64],"(",")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$edit_comment",65],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_body[0][value]'",65],"]",["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","randomMachineName",65],"(",")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ Post comment to the test node with comment\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","drupalPostForm",68],"(",["T_CONSTANT_ENCAPSED_STRING","'comment\/reply\/node\/'",68],["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","searchableNodes",68],"[",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",68],"]",["T_OBJECT_OPERATOR","->",68],["T_STRING","id",68],"(",")",["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'\/comment'",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$edit_comment",68],",",["T_WHITESPACE"," ",68],["T_STRING","t",68],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",68],")",")",";",["T_WHITESPACE","\n\n    ",68],["T_COMMENT","\/\/ First update the index. This does the initial processing.\n",70],["T_WHITESPACE","    ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","container",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","get",71],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.search'",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","createInstance",71],"(",["T_CONSTANT_ENCAPSED_STRING","'node_search'",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","updateIndex",71],"(",")",";",["T_WHITESPACE","\n\n    ",71],["T_COMMENT","\/\/ Then, run the shutdown function. Testing is a unique case where indexing\n",73],["T_WHITESPACE","    ",74],["T_COMMENT","\/\/ and searching has to happen in the same request, so running the shutdown\n",74],["T_WHITESPACE","    ",75],["T_COMMENT","\/\/ function manually is needed to finish the indexing process.\n",75],["T_WHITESPACE","    ",76],["T_STRING","search_update_totals",76],"(",")",";",["T_WHITESPACE","\n  ",76],"}",["T_WHITESPACE","\n\n  ",77],["T_DOC_COMMENT","\/**\n   * Verify that comment count display toggles properly on comment status of node\n   *\/",79],["T_WHITESPACE","\n  ",81],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","testSearchCommentCountToggle",82],"(",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n    ",82],["T_COMMENT","\/\/ Search for the nodes by string in the node body.\n",83],["T_WHITESPACE","    ",84],["T_VARIABLE","$edit",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",["T_WHITESPACE","\n      ",84],["T_CONSTANT_ENCAPSED_STRING","'keys'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","\"'SearchCommentToggleTestCase'\"",85],",",["T_WHITESPACE","\n    ",85],")",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","drupalGet",87],"(",["T_CONSTANT_ENCAPSED_STRING","'search\/node'",87],")",";",["T_WHITESPACE","\n\n    ",87],["T_COMMENT","\/\/ Test comment count display for nodes with comment status set to Open\n",89],["T_WHITESPACE","    ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","drupalPostForm",90],"(",["T_STRING","NULL",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$edit",90],",",["T_WHITESPACE"," ",90],["T_STRING","t",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Search'",90],")",")",";",["T_WHITESPACE","\n    ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertText",91],"(",["T_STRING","t",91],"(",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",91],")",",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'Empty comment count displays for nodes with comment status set to Open'",91],")",";",["T_WHITESPACE","\n    ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","assertText",92],"(",["T_STRING","t",92],"(",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",92],")",",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'Non-empty comment count displays for nodes with comment status set to Open'",92],")",";",["T_WHITESPACE","\n\n    ",92],["T_COMMENT","\/\/ Test comment count display for nodes with comment status set to Closed\n",94],["T_WHITESPACE","    ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","searchableNodes",95],"[",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",95],"]",["T_OBJECT_OPERATOR","->",95],["T_STRING","set",95],"(",["T_CONSTANT_ENCAPSED_STRING","'comment'",95],",",["T_WHITESPACE"," ",95],["T_STRING","CommentItemInterface",95],["T_DOUBLE_COLON","::",95],["T_STRING","CLOSED",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","searchableNodes",96],"[",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",96],"]",["T_OBJECT_OPERATOR","->",96],["T_STRING","save",96],"(",")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","searchableNodes",97],"[",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",97],"]",["T_OBJECT_OPERATOR","->",97],["T_STRING","set",97],"(",["T_CONSTANT_ENCAPSED_STRING","'comment'",97],",",["T_WHITESPACE"," ",97],["T_STRING","CommentItemInterface",97],["T_DOUBLE_COLON","::",97],["T_STRING","CLOSED",97],")",";",["T_WHITESPACE","\n    ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","searchableNodes",98],"[",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",98],"]",["T_OBJECT_OPERATOR","->",98],["T_STRING","save",98],"(",")",";",["T_WHITESPACE","\n\n    ",98],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","drupalPostForm",100],"(",["T_STRING","NULL",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$edit",100],",",["T_WHITESPACE"," ",100],["T_STRING","t",100],"(",["T_CONSTANT_ENCAPSED_STRING","'Search'",100],")",")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertNoText",101],"(",["T_STRING","t",101],"(",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",101],")",",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'Empty comment count does not display for nodes with comment status set to Closed'",101],")",";",["T_WHITESPACE","\n    ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertText",102],"(",["T_STRING","t",102],"(",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",102],")",",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'Non-empty comment count displays for nodes with comment status set to Closed'",102],")",";",["T_WHITESPACE","\n\n    ",102],["T_COMMENT","\/\/ Test comment count display for nodes with comment status set to Hidden\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","searchableNodes",105],"[",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",105],"]",["T_OBJECT_OPERATOR","->",105],["T_STRING","set",105],"(",["T_CONSTANT_ENCAPSED_STRING","'comment'",105],",",["T_WHITESPACE"," ",105],["T_STRING","CommentItemInterface",105],["T_DOUBLE_COLON","::",105],["T_STRING","HIDDEN",105],")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","searchableNodes",106],"[",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",106],"]",["T_OBJECT_OPERATOR","->",106],["T_STRING","save",106],"(",")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","searchableNodes",107],"[",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",107],"]",["T_OBJECT_OPERATOR","->",107],["T_STRING","set",107],"(",["T_CONSTANT_ENCAPSED_STRING","'comment'",107],",",["T_WHITESPACE"," ",107],["T_STRING","CommentItemInterface",107],["T_DOUBLE_COLON","::",107],["T_STRING","HIDDEN",107],")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","searchableNodes",108],"[",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",108],"]",["T_OBJECT_OPERATOR","->",108],["T_STRING","save",108],"(",")",";",["T_WHITESPACE","\n\n    ",108],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","drupalPostForm",110],"(",["T_STRING","NULL",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$edit",110],",",["T_WHITESPACE"," ",110],["T_STRING","t",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Search'",110],")",")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","assertNoText",111],"(",["T_STRING","t",111],"(",["T_CONSTANT_ENCAPSED_STRING","'0 comments'",111],")",",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'Empty comment count does not display for nodes with comment status set to Hidden'",111],")",";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertNoText",112],"(",["T_STRING","t",112],"(",["T_CONSTANT_ENCAPSED_STRING","'1 comment'",112],")",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'Non-empty comment count does not display for nodes with comment status set to Hidden'",112],")",";",["T_WHITESPACE","\n  ",112],"}",["T_WHITESPACE","\n\n",113],"}",["T_WHITESPACE","\n",115]]