[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","dynamic_page_cache",3],["T_NS_SEPARATOR","\\",3],["T_STRING","EventSubscriber",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CacheableMetadata",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Cache",7],["T_NS_SEPARATOR","\\",7],["T_STRING","CacheableResponseInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","PageCache",8],["T_NS_SEPARATOR","\\",8],["T_STRING","RequestPolicyInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","PageCache",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ResponsePolicyInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Render",10],["T_NS_SEPARATOR","\\",10],["T_STRING","RenderCacheInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Symfony",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Component",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EventDispatcher",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EventSubscriberInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpKernel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Event",12],["T_NS_SEPARATOR","\\",12],["T_STRING","FilterResponseEvent",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Symfony",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Component",13],["T_NS_SEPARATOR","\\",13],["T_STRING","HttpKernel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Event",13],["T_NS_SEPARATOR","\\",13],["T_STRING","GetResponseEvent",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpKernel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","KernelEvents",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Returns cached responses as early and avoiding as much work as possible.\n *\n * Dynamic Page Cache is able to cache so much because it utilizes cache\n * contexts: the cache contexts that are present capture the variations of every\n * component of the page. That, combined with the fact that cacheability\n * metadata is bubbled, means that the cache contexts at the page level\n * represent the complete set of contexts that the page varies by.\n *\n * The reason Dynamic Page Cache is implemented as two event subscribers (a late\n * REQUEST subscriber immediately after routing for cache hits, and an early\n * RESPONSE subscriber for cache misses) is because many cache contexts can only\n * be evaluated after routing. (Examples: 'user', 'user.permissions', 'route' \u00e2\u0080\u00a6)\n * Consequently, it is impossible to implement Dynamic Page Cache as a kernel\n * middleware that simply caches per URL.\n *\n * @see \\Drupal\\Core\\Render\\MainContent\\HtmlRenderer\n * @see \\Drupal\\Core\\Cache\\CacheableResponseInterface\n *\/",16],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","DynamicPageCacheSubscriber",35],["T_WHITESPACE"," ",35],["T_IMPLEMENTS","implements",35],["T_WHITESPACE"," ",35],["T_STRING","EventSubscriberInterface",35],["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * Name of Dynamic Page Cache's response header.\n   *\/",37],["T_WHITESPACE","\n  ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","HEADER",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Dynamic-Cache'",40],";",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * A request policy rule determining the cacheability of a response.\n   *\n   * @var \\Drupal\\Core\\PageCache\\RequestPolicyInterface\n   *\/",42],["T_WHITESPACE","\n  ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$requestPolicy",47],";",["T_WHITESPACE","\n\n  ",47],["T_DOC_COMMENT","\/**\n   * A response policy rule determining the cacheability of the response.\n   *\n   * @var \\Drupal\\Core\\PageCache\\ResponsePolicyInterface\n   *\/",49],["T_WHITESPACE","\n  ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$responsePolicy",54],";",["T_WHITESPACE","\n\n  ",54],["T_DOC_COMMENT","\/**\n   * The render cache.\n   *\n   * @var \\Drupal\\Core\\Render\\RenderCacheInterface\n   *\/",56],["T_WHITESPACE","\n  ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$renderCache",61],";",["T_WHITESPACE","\n\n  ",61],["T_DOC_COMMENT","\/**\n   * The renderer configuration array.\n   *\n   * @var array\n   *\/",63],["T_WHITESPACE","\n  ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$rendererConfig",68],";",["T_WHITESPACE","\n\n  ",68],["T_DOC_COMMENT","\/**\n   * Dynamic Page Cache's redirect render array.\n   *\n   * @var array\n   *\/",70],["T_WHITESPACE","\n  ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$dynamicPageCacheRedirectRenderArray",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],"[",["T_WHITESPACE","\n    ",75],["T_CONSTANT_ENCAPSED_STRING","'#cache'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],"[",["T_WHITESPACE","\n      ",76],["T_CONSTANT_ENCAPSED_STRING","'keys'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",77],"]",",",["T_WHITESPACE","\n      ",77],["T_CONSTANT_ENCAPSED_STRING","'contexts'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],"[",["T_WHITESPACE","\n        ",78],["T_CONSTANT_ENCAPSED_STRING","'route'",79],",",["T_WHITESPACE","\n        ",79],["T_COMMENT","\/\/ Some routes' controllers rely on the request format (they don't have\n",80],["T_WHITESPACE","        ",81],["T_COMMENT","\/\/ a separate route for each request format). Additionally, a controller\n",81],["T_WHITESPACE","        ",82],["T_COMMENT","\/\/ may be returning a domain object that a KernelEvents::VIEW subscriber\n",82],["T_WHITESPACE","        ",83],["T_COMMENT","\/\/ must turn into an actual response, but perhaps a format is being\n",83],["T_WHITESPACE","        ",84],["T_COMMENT","\/\/ requested that the subscriber does not support.\n",84],["T_WHITESPACE","        ",85],["T_COMMENT","\/\/ @see \\Drupal\\Core\\EventSubscriber\\AcceptNegotiation406::onViewDetect406()\n",85],["T_WHITESPACE","        ",86],["T_CONSTANT_ENCAPSED_STRING","'request_format'",86],",",["T_WHITESPACE","\n      ",86],"]",",",["T_WHITESPACE","\n      ",87],["T_CONSTANT_ENCAPSED_STRING","'bin'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'dynamic_page_cache'",88],",",["T_WHITESPACE","\n    ",88],"]",",",["T_WHITESPACE","\n  ",89],"]",";",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Internal cache of request policy results.\n   *\n   * @var \\SplObjectStorage\n   *\/",92],["T_WHITESPACE","\n  ",96],["T_PROTECTED","protected",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$requestPolicyResults",97],";",["T_WHITESPACE","\n\n  ",97],["T_DOC_COMMENT","\/**\n   * Constructs a new DynamicPageCacheSubscriber object.\n   *\n   * @param \\Drupal\\Core\\PageCache\\RequestPolicyInterface $request_policy\n   *   A policy rule determining the cacheability of a request.\n   * @param \\Drupal\\Core\\PageCache\\ResponsePolicyInterface $response_policy\n   *   A policy rule determining the cacheability of the response.\n   * @param \\Drupal\\Core\\Render\\RenderCacheInterface $render_cache\n   *   The render cache.\n   * @param array $renderer_config\n   *   The renderer configuration array.\n   *\/",99],["T_WHITESPACE","\n  ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","__construct",111],"(",["T_STRING","RequestPolicyInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$request_policy",111],",",["T_WHITESPACE"," ",111],["T_STRING","ResponsePolicyInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$response_policy",111],",",["T_WHITESPACE"," ",111],["T_STRING","RenderCacheInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$render_cache",111],",",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$renderer_config",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","requestPolicy",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$request_policy",112],";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","responsePolicy",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$response_policy",113],";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","renderCache",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$render_cache",114],";",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","rendererConfig",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$renderer_config",115],";",["T_WHITESPACE","\n    ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","requestPolicyResults",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_NS_SEPARATOR","\\",116],["T_STRING","SplObjectStorage",116],"(",")",";",["T_WHITESPACE","\n  ",116],"}",["T_WHITESPACE","\n\n  ",117],["T_DOC_COMMENT","\/**\n   * Sets a response in case of a Dynamic Page Cache hit.\n   *\n   * @param \\Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent $event\n   *   The event to process.\n   *\/",119],["T_WHITESPACE","\n  ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","onRouteMatch",125],"(",["T_STRING","GetResponseEvent",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$event",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n    ",125],["T_COMMENT","\/\/ Don't cache the response if the Dynamic Page Cache request policies are\n",126],["T_WHITESPACE","    ",127],["T_COMMENT","\/\/ not met. Store the result in a static keyed by current request, so that\n",127],["T_WHITESPACE","    ",128],["T_COMMENT","\/\/ onResponse() does not have to redo the request policy check.\n",128],["T_WHITESPACE","    ",129],["T_VARIABLE","$request",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$event",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getRequest",129],"(",")",";",["T_WHITESPACE","\n    ",129],["T_VARIABLE","$request_policy_result",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","requestPolicy",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","check",130],"(",["T_VARIABLE","$request",130],")",";",["T_WHITESPACE","\n    ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","requestPolicyResults",131],"[",["T_VARIABLE","$request",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$request_policy_result",131],";",["T_WHITESPACE","\n    ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$request_policy_result",132],["T_WHITESPACE"," ",132],["T_IS_IDENTICAL","===",132],["T_WHITESPACE"," ",132],["T_STRING","RequestPolicyInterface",132],["T_DOUBLE_COLON","::",132],["T_STRING","DENY",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n      ",132],["T_RETURN","return",133],";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_COMMENT","\/\/ Sets the response for the current route, if cached.\n",136],["T_WHITESPACE","    ",137],["T_VARIABLE","$cached",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","renderCache",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","get",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","dynamicPageCacheRedirectRenderArray",137],")",";",["T_WHITESPACE","\n    ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$cached",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n      ",138],["T_VARIABLE","$response",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","renderArrayToResponse",139],"(",["T_VARIABLE","$cached",139],")",";",["T_WHITESPACE","\n      ",139],["T_VARIABLE","$response",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","headers",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","set",140],"(",["T_STRING","self",140],["T_DOUBLE_COLON","::",140],["T_STRING","HEADER",140],",",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'HIT'",140],")",";",["T_WHITESPACE","\n      ",140],["T_VARIABLE","$event",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","setResponse",141],"(",["T_VARIABLE","$response",141],")",";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n  ",142],"}",["T_WHITESPACE","\n\n  ",143],["T_DOC_COMMENT","\/**\n   * Stores a response in case of a Dynamic Page Cache miss, if cacheable.\n   *\n   * @param \\Symfony\\Component\\HttpKernel\\Event\\FilterResponseEvent $event\n   *   The event to process.\n   *\/",145],["T_WHITESPACE","\n  ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","onResponse",151],"(",["T_STRING","FilterResponseEvent",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$event",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$response",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$event",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getResponse",152],"(",")",";",["T_WHITESPACE","\n\n    ",152],["T_COMMENT","\/\/ Dynamic Page Cache only works with cacheable responses. It does not work\n",154],["T_WHITESPACE","    ",155],["T_COMMENT","\/\/ with plain Response objects. (Dynamic Page Cache needs to be able to\n",155],["T_WHITESPACE","    ",156],["T_COMMENT","\/\/ access and modify the cacheability metadata associated with the\n",156],["T_WHITESPACE","    ",157],["T_COMMENT","\/\/ response.)\n",157],["T_WHITESPACE","    ",158],["T_IF","if",158],["T_WHITESPACE"," ",158],"(","!",["T_VARIABLE","$response",158],["T_WHITESPACE"," ",158],["T_INSTANCEOF","instanceof",158],["T_WHITESPACE"," ",158],["T_STRING","CacheableResponseInterface",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n      ",158],["T_RETURN","return",159],";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_COMMENT","\/\/ There's no work left to be done if this is a Dynamic Page Cache hit.\n",162],["T_WHITESPACE","    ",163],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$response",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","headers",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","get",163],"(",["T_STRING","self",163],["T_DOUBLE_COLON","::",163],["T_STRING","HEADER",163],")",["T_WHITESPACE"," ",163],["T_IS_IDENTICAL","===",163],["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'HIT'",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n      ",163],["T_RETURN","return",164],";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_COMMENT","\/\/ There's no work left to be done if this is an uncacheable response.\n",167],["T_WHITESPACE","    ",168],["T_IF","if",168],["T_WHITESPACE"," ",168],"(","!",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","shouldCacheResponse",168],"(",["T_VARIABLE","$response",168],")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n      ",168],["T_COMMENT","\/\/ The response is uncacheable, mark it as such.\n",169],["T_WHITESPACE","      ",170],["T_VARIABLE","$response",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","headers",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","set",170],"(",["T_STRING","self",170],["T_DOUBLE_COLON","::",170],["T_STRING","HEADER",170],",",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'UNCACHEABLE'",170],")",";",["T_WHITESPACE","\n      ",170],["T_RETURN","return",171],";",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_COMMENT","\/\/ Don't cache the response if Dynamic Page Cache's request subscriber did\n",174],["T_WHITESPACE","    ",175],["T_COMMENT","\/\/ not fire, because that means it is impossible to have a Dynamic Page\n",175],["T_WHITESPACE","    ",176],["T_COMMENT","\/\/ Cache hit. This can happen when the master request is for example a 403\n",176],["T_WHITESPACE","    ",177],["T_COMMENT","\/\/ or 404, in which case a subrequest is performed by the router. In that\n",177],["T_WHITESPACE","    ",178],["T_COMMENT","\/\/ case, it is the subrequest's response that is cached by Dynamic Page\n",178],["T_WHITESPACE","    ",179],["T_COMMENT","\/\/ Cache, because the routing happens in a request subscriber earlier than\n",179],["T_WHITESPACE","    ",180],["T_COMMENT","\/\/ Dynamic Page Cache's and immediately sets a response, i.e. the one\n",180],["T_WHITESPACE","    ",181],["T_COMMENT","\/\/ returned by the subrequest, and thus causes Dynamic Page Cache's request\n",181],["T_WHITESPACE","    ",182],["T_COMMENT","\/\/ subscriber to not fire for the master request.\n",182],["T_WHITESPACE","    ",183],["T_COMMENT","\/\/ @see \\Drupal\\Core\\Routing\\AccessAwareRouter::checkAccess()\n",183],["T_WHITESPACE","    ",184],["T_COMMENT","\/\/ @see \\Drupal\\Core\\EventSubscriber\\DefaultExceptionHtmlSubscriber::on403()\n",184],["T_WHITESPACE","    ",185],["T_VARIABLE","$request",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$event",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getRequest",185],"(",")",";",["T_WHITESPACE","\n    ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(","!",["T_ISSET","isset",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","requestPolicyResults",186],"[",["T_VARIABLE","$request",186],"]",")",")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n      ",186],["T_RETURN","return",187],";",["T_WHITESPACE","\n    ",187],"}",["T_WHITESPACE","\n\n    ",188],["T_COMMENT","\/\/ Don't cache the response if the Dynamic Page Cache request & response\n",190],["T_WHITESPACE","    ",191],["T_COMMENT","\/\/ policies are not met.\n",191],["T_WHITESPACE","    ",192],["T_COMMENT","\/\/ @see onRouteMatch()\n",192],["T_WHITESPACE","    ",193],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","requestPolicyResults",193],"[",["T_VARIABLE","$request",193],"]",["T_WHITESPACE"," ",193],["T_IS_IDENTICAL","===",193],["T_WHITESPACE"," ",193],["T_STRING","RequestPolicyInterface",193],["T_DOUBLE_COLON","::",193],["T_STRING","DENY",193],["T_WHITESPACE"," ",193],["T_BOOLEAN_OR","||",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","responsePolicy",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","check",193],"(",["T_VARIABLE","$response",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$request",193],")",["T_WHITESPACE"," ",193],["T_IS_IDENTICAL","===",193],["T_WHITESPACE"," ",193],["T_STRING","ResponsePolicyInterface",193],["T_DOUBLE_COLON","::",193],["T_STRING","DENY",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n      ",193],["T_RETURN","return",194],";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_COMMENT","\/\/ Embed the response object in a render array so that RenderCache is able\n",197],["T_WHITESPACE","    ",198],["T_COMMENT","\/\/ to cache it, handling cache redirection for us.\n",198],["T_WHITESPACE","    ",199],["T_VARIABLE","$response_as_render_array",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","responseToRenderArray",199],"(",["T_VARIABLE","$response",199],")",";",["T_WHITESPACE","\n    ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","renderCache",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","set",200],"(",["T_VARIABLE","$response_as_render_array",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","dynamicPageCacheRedirectRenderArray",200],")",";",["T_WHITESPACE","\n\n    ",200],["T_COMMENT","\/\/ The response was generated, mark the response as a cache miss. The next\n",202],["T_WHITESPACE","    ",203],["T_COMMENT","\/\/ time, it will be a cache hit.\n",203],["T_WHITESPACE","    ",204],["T_VARIABLE","$response",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","headers",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","set",204],"(",["T_STRING","self",204],["T_DOUBLE_COLON","::",204],["T_STRING","HEADER",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'MISS'",204],")",";",["T_WHITESPACE","\n  ",204],"}",["T_WHITESPACE","\n\n  ",205],["T_DOC_COMMENT","\/**\n   * Whether the given response should be cached by Dynamic Page Cache.\n   *\n   * We consider any response that has cacheability metadata meeting the auto-\n   * placeholdering conditions to be uncacheable. Because those conditions\n   * indicate poor cacheability, and if it doesn't make sense to cache parts of\n   * a page, then neither does it make sense to cache an entire page.\n   *\n   * But note that auto-placeholdering avoids such cacheability metadata ever\n   * bubbling to the response level: while rendering, the Renderer checks every\n   * subtree to see if meets the auto-placeholdering conditions. If it does, it\n   * is automatically placeholdered, and consequently the cacheability metadata\n   * of the placeholdered content does not bubble up to the response level.\n   *\n   * @param \\Drupal\\Core\\Cache\\CacheableResponseInterface $response\n   *   The response whose cacheability to analyze.\n   *\n   * @return bool\n   *   Whether the given response should be cached.\n   *\n   * @see \\Drupal\\Core\\Render\\Renderer::shouldAutomaticallyPlaceholder()\n   *\/",207],["T_WHITESPACE","\n  ",228],["T_PROTECTED","protected",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","shouldCacheResponse",229],"(",["T_STRING","CacheableResponseInterface",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$response",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n    ",229],["T_VARIABLE","$conditions",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","rendererConfig",230],"[",["T_CONSTANT_ENCAPSED_STRING","'auto_placeholder_conditions'",230],"]",";",["T_WHITESPACE","\n\n    ",230],["T_VARIABLE","$cacheability",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$response",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getCacheableMetadata",232],"(",")",";",["T_WHITESPACE","\n\n    ",232],["T_COMMENT","\/\/ Response's max-age is at or below the configured threshold.\n",234],["T_WHITESPACE","    ",235],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$cacheability",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getCacheMaxAge",235],"(",")",["T_WHITESPACE"," ",235],["T_IS_NOT_IDENTICAL","!==",235],["T_WHITESPACE"," ",235],["T_STRING","Cache",235],["T_DOUBLE_COLON","::",235],["T_STRING","PERMANENT",235],["T_WHITESPACE"," ",235],["T_BOOLEAN_AND","&&",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$cacheability",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getCacheMaxAge",235],"(",")",["T_WHITESPACE"," ",235],["T_IS_SMALLER_OR_EQUAL","<=",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$conditions",235],"[",["T_CONSTANT_ENCAPSED_STRING","'max-age'",235],"]",")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n      ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_STRING","FALSE",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_COMMENT","\/\/ Response has a high-cardinality cache context.\n",239],["T_WHITESPACE","    ",240],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_STRING","array_intersect",240],"(",["T_VARIABLE","$cacheability",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getCacheContexts",240],"(",")",",",["T_WHITESPACE"," ",240],["T_VARIABLE","$conditions",240],"[",["T_CONSTANT_ENCAPSED_STRING","'contexts'",240],"]",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n      ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","FALSE",241],";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_COMMENT","\/\/ Response has a high-invalidation frequency cache tag.\n",244],["T_WHITESPACE","    ",245],["T_IF","if",245],["T_WHITESPACE"," ",245],"(",["T_STRING","array_intersect",245],"(",["T_VARIABLE","$cacheability",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getCacheTags",245],"(",")",",",["T_WHITESPACE"," ",245],["T_VARIABLE","$conditions",245],"[",["T_CONSTANT_ENCAPSED_STRING","'tags'",245],"]",")",")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n      ",245],["T_RETURN","return",246],["T_WHITESPACE"," ",246],["T_STRING","FALSE",246],";",["T_WHITESPACE","\n    ",246],"}",["T_WHITESPACE","\n\n    ",247],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_STRING","TRUE",249],";",["T_WHITESPACE","\n  ",249],"}",["T_WHITESPACE","\n\n  ",250],["T_DOC_COMMENT","\/**\n   * Embeds a Response object in a render array so that RenderCache can cache it.\n   *\n   * @param \\Drupal\\Core\\Cache\\CacheableResponseInterface $response\n   *   A cacheable response.\n   *\n   * @return array\n   *   A render array that embeds the given cacheable response object, with the\n   *   cacheability metadata of the response object present in the #cache\n   *   property of the render array.\n   *\n   * @see renderArrayToResponse()\n   *\n   * @todo Refactor\/remove once https:\/\/www.drupal.org\/node\/2551419 lands.\n   *\/",252],["T_WHITESPACE","\n  ",266],["T_PROTECTED","protected",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","responseToRenderArray",267],"(",["T_STRING","CacheableResponseInterface",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$response",267],")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n    ",267],["T_VARIABLE","$response_as_render_array",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","dynamicPageCacheRedirectRenderArray",268],["T_WHITESPACE"," ",268],"+",["T_WHITESPACE"," ",268],"[",["T_WHITESPACE","\n      ",268],["T_COMMENT","\/\/ The data we actually care about.\n",269],["T_WHITESPACE","      ",270],["T_CONSTANT_ENCAPSED_STRING","'#response'",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$response",270],",",["T_WHITESPACE","\n      ",270],["T_COMMENT","\/\/ Tell RenderCache to cache the #response property: the data we actually\n",271],["T_WHITESPACE","      ",272],["T_COMMENT","\/\/ care about.\n",272],["T_WHITESPACE","      ",273],["T_CONSTANT_ENCAPSED_STRING","'#cache_properties'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],"[",["T_CONSTANT_ENCAPSED_STRING","'#response'",273],"]",",",["T_WHITESPACE","\n      ",273],["T_COMMENT","\/\/ These exist only to fulfill the requirements of the RenderCache, which\n",274],["T_WHITESPACE","      ",275],["T_COMMENT","\/\/ is designed to work with render arrays only. We don't care about these.\n",275],["T_WHITESPACE","      ",276],["T_CONSTANT_ENCAPSED_STRING","'#markup'",276],["T_WHITESPACE"," ",276],["T_DOUBLE_ARROW","=>",276],["T_WHITESPACE"," ",276],["T_CONSTANT_ENCAPSED_STRING","''",276],",",["T_WHITESPACE","\n      ",276],["T_CONSTANT_ENCAPSED_STRING","'#attached'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","''",277],",",["T_WHITESPACE","\n    ",277],"]",";",["T_WHITESPACE","\n\n    ",278],["T_COMMENT","\/\/ Merge the response's cacheability metadata, so that RenderCache can take\n",280],["T_WHITESPACE","    ",281],["T_COMMENT","\/\/ care of cache redirects for us.\n",281],["T_WHITESPACE","    ",282],["T_STRING","CacheableMetadata",282],["T_DOUBLE_COLON","::",282],["T_STRING","createFromObject",282],"(",["T_VARIABLE","$response",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getCacheableMetadata",282],"(",")",")",["T_WHITESPACE","\n      ",282],["T_OBJECT_OPERATOR","->",283],["T_STRING","merge",283],"(",["T_STRING","CacheableMetadata",283],["T_DOUBLE_COLON","::",283],["T_STRING","createFromRenderArray",283],"(",["T_VARIABLE","$response_as_render_array",283],")",")",["T_WHITESPACE","\n      ",283],["T_OBJECT_OPERATOR","->",284],["T_STRING","applyTo",284],"(",["T_VARIABLE","$response_as_render_array",284],")",";",["T_WHITESPACE","\n\n    ",284],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$response_as_render_array",286],";",["T_WHITESPACE","\n  ",286],"}",["T_WHITESPACE","\n\n  ",287],["T_DOC_COMMENT","\/**\n   * Gets the embedded Response object in a render array.\n   *\n   * @param array $render_array\n   *   A render array with a #response property.\n   *\n   * @return \\Drupal\\Core\\Cache\\CacheableResponseInterface\n   *   The cacheable response object.\n   *\n   * @see responseToRenderArray()\n   *\/",289],["T_WHITESPACE","\n  ",299],["T_PROTECTED","protected",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","renderArrayToResponse",300],"(",["T_ARRAY","array",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$render_array",300],")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n    ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$render_array",301],"[",["T_CONSTANT_ENCAPSED_STRING","'#response'",301],"]",";",["T_WHITESPACE","\n  ",301],"}",["T_WHITESPACE","\n\n  ",302],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",304],["T_WHITESPACE","\n  ",306],["T_PUBLIC","public",307],["T_WHITESPACE"," ",307],["T_STATIC","static",307],["T_WHITESPACE"," ",307],["T_FUNCTION","function",307],["T_WHITESPACE"," ",307],["T_STRING","getSubscribedEvents",307],"(",")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n    ",307],["T_VARIABLE","$events",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],"[","]",";",["T_WHITESPACE","\n\n    ",308],["T_COMMENT","\/\/ Run after AuthenticationSubscriber (necessary for the 'user' cache\n",310],["T_WHITESPACE","    ",311],["T_COMMENT","\/\/ context; priority 300) and MaintenanceModeSubscriber (Dynamic Page Cache\n",311],["T_WHITESPACE","    ",312],["T_COMMENT","\/\/ should not be polluted by maintenance mode-specific behavior; priority\n",312],["T_WHITESPACE","    ",313],["T_COMMENT","\/\/ 30), but before ContentControllerSubscriber (updates _controller, but\n",313],["T_WHITESPACE","    ",314],["T_COMMENT","\/\/ that is a no-op when Dynamic Page Cache runs; priority 25).\n",314],["T_WHITESPACE","    ",315],["T_VARIABLE","$events",315],"[",["T_STRING","KernelEvents",315],["T_DOUBLE_COLON","::",315],["T_STRING","REQUEST",315],"]","[","]",["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],"[",["T_CONSTANT_ENCAPSED_STRING","'onRouteMatch'",315],",",["T_WHITESPACE"," ",315],["T_LNUMBER","27",315],"]",";",["T_WHITESPACE","\n\n    ",315],["T_COMMENT","\/\/ Run before HtmlResponseSubscriber::onRespond(), which has priority 0.\n",317],["T_WHITESPACE","    ",318],["T_VARIABLE","$events",318],"[",["T_STRING","KernelEvents",318],["T_DOUBLE_COLON","::",318],["T_STRING","RESPONSE",318],"]","[","]",["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],"[",["T_CONSTANT_ENCAPSED_STRING","'onResponse'",318],",",["T_WHITESPACE"," ",318],["T_LNUMBER","100",318],"]",";",["T_WHITESPACE","\n\n    ",318],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$events",320],";",["T_WHITESPACE","\n  ",320],"}",["T_WHITESPACE","\n\n",321],"}",["T_WHITESPACE","\n",323]]