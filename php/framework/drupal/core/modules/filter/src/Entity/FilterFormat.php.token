[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","filter",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Entity",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Plugin",5],["T_NS_SEPARATOR","\\",5],["T_STRING","PluginInspectionInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Config",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ConfigEntityBase",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityWithPluginCollectionInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntityStorageInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","filter",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FilterFormatInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","filter",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FilterPluginCollection",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","filter",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Plugin",11],["T_NS_SEPARATOR","\\",11],["T_STRING","FilterInterface",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Represents a text format.\n *\n * @ConfigEntityType(\n *   id = \"filter_format\",\n *   label = @Translation(\"Text format\"),\n *   handlers = {\n *     \"form\" = {\n *       \"add\" = \"Drupal\\filter\\FilterFormatAddForm\",\n *       \"edit\" = \"Drupal\\filter\\FilterFormatEditForm\",\n *       \"disable\" = \"Drupal\\filter\\Form\\FilterDisableForm\"\n *     },\n *     \"list_builder\" = \"Drupal\\filter\\FilterFormatListBuilder\",\n *     \"access\" = \"Drupal\\filter\\FilterFormatAccessControlHandler\",\n *   },\n *   config_prefix = \"format\",\n *   admin_permission = \"administer filters\",\n *   entity_keys = {\n *     \"id\" = \"format\",\n *     \"label\" = \"name\",\n *     \"weight\" = \"weight\",\n *     \"status\" = \"status\"\n *   },\n *   links = {\n *     \"edit-form\" = \"\/admin\/config\/content\/formats\/manage\/{filter_format}\",\n *     \"disable\" = \"\/admin\/config\/content\/formats\/manage\/{filter_format}\/disable\"\n *   },\n *   config_export = {\n *     \"name\",\n *     \"format\",\n *     \"weight\",\n *     \"roles\",\n *     \"filters\",\n *   }\n * )\n *\/",13],["T_WHITESPACE","\n",48],["T_CLASS","class",49],["T_WHITESPACE"," ",49],["T_STRING","FilterFormat",49],["T_WHITESPACE"," ",49],["T_EXTENDS","extends",49],["T_WHITESPACE"," ",49],["T_STRING","ConfigEntityBase",49],["T_WHITESPACE"," ",49],["T_IMPLEMENTS","implements",49],["T_WHITESPACE"," ",49],["T_STRING","FilterFormatInterface",49],",",["T_WHITESPACE"," ",49],["T_STRING","EntityWithPluginCollectionInterface",49],["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * Unique machine name of the format.\n   *\n   * @todo Rename to $id.\n   *\n   * @var string\n   *\/",51],["T_WHITESPACE","\n  ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$format",58],";",["T_WHITESPACE","\n\n  ",58],["T_DOC_COMMENT","\/**\n   * Unique label of the text format.\n   *\n   * Since text formats impact a site's security, two formats with the same\n   * label but different filter configuration would impose a security risk.\n   * Therefore, each text format label must be unique.\n   *\n   * @todo Rename to $label.\n   *\n   * @var string\n   *\/",60],["T_WHITESPACE","\n  ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$name",71],";",["T_WHITESPACE","\n\n  ",71],["T_DOC_COMMENT","\/**\n   * Weight of this format in the text format selector.\n   *\n   * The first\/lowest text format that is accessible for a user is used as\n   * default format.\n   *\n   * @var int\n   *\/",73],["T_WHITESPACE","\n  ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$weight",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_LNUMBER","0",81],";",["T_WHITESPACE","\n\n  ",81],["T_DOC_COMMENT","\/**\n   * List of user role IDs to grant access to use this format on initial creation.\n   *\n   * This property is always empty and unused for existing text formats.\n   *\n   * Default configuration objects of modules and installation profiles are\n   * allowed to specify a list of user role IDs to grant access to.\n   *\n   * This property only has an effect when a new text format is created and the\n   * list is not empty. By default, no user role is allowed to use a new format.\n   *\n   * @var array\n   *\/",83],["T_WHITESPACE","\n  ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$roles",96],";",["T_WHITESPACE","\n\n  ",96],["T_DOC_COMMENT","\/**\n   * Configured filters for this text format.\n   *\n   * An associative array of filters assigned to the text format, keyed by the\n   * instance ID of each filter and using the properties:\n   * - id: The plugin ID of the filter plugin instance.\n   * - provider: The name of the provider that owns the filter.\n   * - status: (optional) A Boolean indicating whether the filter is\n   *   enabled in the text format. Defaults to FALSE.\n   * - weight: (optional) The weight of the filter in the text format. Defaults\n   *   to 0.\n   * - settings: (optional) An array of configured settings for the filter.\n   *\n   * Use FilterFormat::filters() to access the actual filters.\n   *\n   * @var array\n   *\/",98],["T_WHITESPACE","\n  ",114],["T_PROTECTED","protected",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$filters",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_ARRAY","array",115],"(",")",";",["T_WHITESPACE","\n\n  ",115],["T_DOC_COMMENT","\/**\n   * Holds the collection of filters that are attached to this format.\n   *\n   * @var \\Drupal\\filter\\FilterPluginCollection\n   *\/",117],["T_WHITESPACE","\n  ",121],["T_PROTECTED","protected",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$filterCollection",122],";",["T_WHITESPACE","\n\n  ",122],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",124],["T_WHITESPACE","\n  ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","id",127],"(",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n    ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","format",128],";",["T_WHITESPACE","\n  ",128],"}",["T_WHITESPACE","\n\n  ",129],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",131],["T_WHITESPACE","\n  ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","filters",134],"(",["T_VARIABLE","$instance_id",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","NULL",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n    ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_ISSET","isset",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","filterCollection",135],")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n      ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","filterCollection",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_NEW","new",136],["T_WHITESPACE"," ",136],["T_STRING","FilterPluginCollection",136],"(",["T_NS_SEPARATOR","\\",136],["T_STRING","Drupal",136],["T_DOUBLE_COLON","::",136],["T_STRING","service",136],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.filter'",136],")",",",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","filters",136],")",";",["T_WHITESPACE","\n      ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","filterCollection",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","sort",137],"(",")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n    ",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_ISSET","isset",139],"(",["T_VARIABLE","$instance_id",139],")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n      ",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","filterCollection",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","get",140],"(",["T_VARIABLE","$instance_id",140],")",";",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n    ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","filterCollection",142],";",["T_WHITESPACE","\n  ",142],"}",["T_WHITESPACE","\n\n  ",143],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",145],["T_WHITESPACE","\n  ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","getPluginCollections",148],"(",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n    ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_ARRAY","array",149],"(",["T_CONSTANT_ENCAPSED_STRING","'filters'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","filters",149],"(",")",")",";",["T_WHITESPACE","\n  ",149],"}",["T_WHITESPACE","\n\n  ",150],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",152],["T_WHITESPACE","\n  ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","setFilterConfig",155],"(",["T_VARIABLE","$instance_id",155],",",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$configuration",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","filters",156],"[",["T_VARIABLE","$instance_id",156],"]",["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$configuration",156],";",["T_WHITESPACE","\n    ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_ISSET","isset",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","filterCollection",157],")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n      ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","filterCollection",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","setInstanceConfiguration",158],"(",["T_VARIABLE","$instance_id",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$configuration",158],")",";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n    ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],";",["T_WHITESPACE","\n  ",160],"}",["T_WHITESPACE","\n\n  ",161],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",163],["T_WHITESPACE","\n  ",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","toArray",166],"(",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n    ",166],["T_VARIABLE","$properties",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","parent",167],["T_DOUBLE_COLON","::",167],["T_STRING","toArray",167],"(",")",";",["T_WHITESPACE","\n    ",167],["T_COMMENT","\/\/ The 'roles' property is only used during install and should never\n",168],["T_WHITESPACE","    ",169],["T_COMMENT","\/\/ actually be saved.\n",169],["T_WHITESPACE","    ",170],["T_UNSET","unset",170],"(",["T_VARIABLE","$properties",170],"[",["T_CONSTANT_ENCAPSED_STRING","'roles'",170],"]",")",";",["T_WHITESPACE","\n    ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$properties",171],";",["T_WHITESPACE","\n  ",171],"}",["T_WHITESPACE","\n\n  ",172],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",174],["T_WHITESPACE","\n  ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","disable",177],"(",")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n    ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","isFallbackFormat",178],"(",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n      ",178],["T_THROW","throw",179],["T_WHITESPACE"," ",179],["T_NEW","new",179],["T_WHITESPACE"," ",179],["T_NS_SEPARATOR","\\",179],["T_STRING","LogicException",179],"(","\"",["T_ENCAPSED_AND_WHITESPACE","The fallback text format '",179],["T_CURLY_OPEN","{",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","id",179],"(",")","}",["T_ENCAPSED_AND_WHITESPACE","' cannot be disabled.",179],"\"",")",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_STRING","parent",182],["T_DOUBLE_COLON","::",182],["T_STRING","disable",182],"(",")",";",["T_WHITESPACE","\n\n    ",182],["T_COMMENT","\/\/ Allow modules to react on text format deletion.\n",184],["T_WHITESPACE","    ",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Drupal",185],["T_DOUBLE_COLON","::",185],["T_STRING","moduleHandler",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","invokeAll",185],"(",["T_CONSTANT_ENCAPSED_STRING","'filter_format_disable'",185],",",["T_WHITESPACE"," ",185],["T_ARRAY","array",185],"(",["T_VARIABLE","$this",185],")",")",";",["T_WHITESPACE","\n\n    ",185],["T_COMMENT","\/\/ Clear the filter cache whenever a text format is disabled.\n",187],["T_WHITESPACE","    ",188],["T_STRING","filter_formats_reset",188],"(",")",";",["T_WHITESPACE","\n\n    ",188],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],";",["T_WHITESPACE","\n  ",190],"}",["T_WHITESPACE","\n\n  ",191],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",193],["T_WHITESPACE","\n  ",195],["T_PUBLIC","public",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","preSave",196],"(",["T_STRING","EntityStorageInterface",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$storage",196],")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n    ",196],["T_COMMENT","\/\/ Ensure the filters have been sorted before saving.\n",197],["T_WHITESPACE","    ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","filters",198],"(",")",["T_OBJECT_OPERATOR","->",198],["T_STRING","sort",198],"(",")",";",["T_WHITESPACE","\n\n    ",198],["T_STRING","parent",200],["T_DOUBLE_COLON","::",200],["T_STRING","preSave",200],"(",["T_VARIABLE","$storage",200],")",";",["T_WHITESPACE","\n\n    ",200],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","name",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","trim",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","label",202],"(",")",")",";",["T_WHITESPACE","\n  ",202],"}",["T_WHITESPACE","\n\n  ",203],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",205],["T_WHITESPACE","\n  ",207],["T_PUBLIC","public",208],["T_WHITESPACE"," ",208],["T_FUNCTION","function",208],["T_WHITESPACE"," ",208],["T_STRING","postSave",208],"(",["T_STRING","EntityStorageInterface",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$storage",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$update",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","TRUE",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n    ",208],["T_STRING","parent",209],["T_DOUBLE_COLON","::",209],["T_STRING","postSave",209],"(",["T_VARIABLE","$storage",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$update",209],")",";",["T_WHITESPACE","\n\n    ",209],["T_COMMENT","\/\/ Clear the static caches of filter_formats() and others.\n",211],["T_WHITESPACE","    ",212],["T_STRING","filter_formats_reset",212],"(",")",";",["T_WHITESPACE","\n\n    ",212],["T_IF","if",214],["T_WHITESPACE"," ",214],"(","!",["T_VARIABLE","$update",214],["T_WHITESPACE"," ",214],["T_BOOLEAN_AND","&&",214],["T_WHITESPACE"," ",214],"!",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","isSyncing",214],"(",")",")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n      ",214],["T_COMMENT","\/\/ Default configuration of modules and installation profiles is allowed\n",215],["T_WHITESPACE","      ",216],["T_COMMENT","\/\/ to specify a list of user roles to grant access to for the new format;\n",216],["T_WHITESPACE","      ",217],["T_COMMENT","\/\/ apply the defined user role permissions when a new format is inserted\n",217],["T_WHITESPACE","      ",218],["T_COMMENT","\/\/ and has a non-empty $roles property.\n",218],["T_WHITESPACE","      ",219],["T_COMMENT","\/\/ Note: user_role_change_permissions() triggers a call chain back into\n",219],["T_WHITESPACE","      ",220],["T_COMMENT","\/\/ \\Drupal\\filter\\FilterPermissions::permissions() and lastly\n",220],["T_WHITESPACE","      ",221],["T_COMMENT","\/\/ filter_formats(), so its cache must be reset upfront.\n",221],["T_WHITESPACE","      ",222],["T_IF","if",222],["T_WHITESPACE"," ",222],"(","(",["T_VARIABLE","$roles",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","get",222],"(",["T_CONSTANT_ENCAPSED_STRING","'roles'",222],")",")",["T_WHITESPACE"," ",222],["T_BOOLEAN_AND","&&",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$permission",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getPermissionName",222],"(",")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n        ",222],["T_FOREACH","foreach",223],["T_WHITESPACE"," ",223],"(",["T_STRING","user_roles",223],"(",")",["T_WHITESPACE"," ",223],["T_AS","as",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$rid",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$name",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n          ",223],["T_VARIABLE","$enabled",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_STRING","in_array",224],"(",["T_VARIABLE","$rid",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$roles",224],",",["T_WHITESPACE"," ",224],["T_STRING","TRUE",224],")",";",["T_WHITESPACE","\n          ",224],["T_STRING","user_role_change_permissions",225],"(",["T_VARIABLE","$rid",225],",",["T_WHITESPACE"," ",225],["T_ARRAY","array",225],"(",["T_VARIABLE","$permission",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$enabled",225],")",")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n      ",226],"}",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n  ",228],"}",["T_WHITESPACE","\n\n  ",229],["T_DOC_COMMENT","\/**\n   * Returns if this format is the fallback format.\n   *\n   * The fallback format can never be disabled. It must always be available.\n   *\n   * @return bool\n   *   TRUE if this format is the fallback format, FALSE otherwise.\n   *\/",231],["T_WHITESPACE","\n  ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","isFallbackFormat",239],"(",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n    ",239],["T_VARIABLE","$fallback_format",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_NS_SEPARATOR","\\",240],["T_STRING","Drupal",240],["T_DOUBLE_COLON","::",240],["T_STRING","config",240],"(",["T_CONSTANT_ENCAPSED_STRING","'filter.settings'",240],")",["T_OBJECT_OPERATOR","->",240],["T_STRING","get",240],"(",["T_CONSTANT_ENCAPSED_STRING","'fallback_format'",240],")",";",["T_WHITESPACE","\n    ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","id",241],"(",")",["T_WHITESPACE"," ",241],["T_IS_EQUAL","==",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$fallback_format",241],";",["T_WHITESPACE","\n  ",241],"}",["T_WHITESPACE","\n\n  ",242],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",244],["T_WHITESPACE","\n  ",246],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","getPermissionName",247],"(",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n    ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],"!",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","isFallbackFormat",248],"(",")",["T_WHITESPACE"," ",248],"?",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'use text format '",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","id",248],"(",")",["T_WHITESPACE"," ",248],":",["T_WHITESPACE"," ",248],["T_STRING","FALSE",248],";",["T_WHITESPACE","\n  ",248],"}",["T_WHITESPACE","\n\n  ",249],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",251],["T_WHITESPACE","\n  ",253],["T_PUBLIC","public",254],["T_WHITESPACE"," ",254],["T_FUNCTION","function",254],["T_WHITESPACE"," ",254],["T_STRING","getFilterTypes",254],"(",")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n    ",254],["T_VARIABLE","$filter_types",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_ARRAY","array",255],"(",")",";",["T_WHITESPACE","\n\n    ",255],["T_VARIABLE","$filters",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","filters",257],"(",")",";",["T_WHITESPACE","\n    ",257],["T_FOREACH","foreach",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$filters",258],["T_WHITESPACE"," ",258],["T_AS","as",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$filter",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n      ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$filter",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","status",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$filter_types",260],"[","]",["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_VARIABLE","$filter",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getType",260],"(",")",";",["T_WHITESPACE","\n      ",260],"}",["T_WHITESPACE","\n    ",261],"}",["T_WHITESPACE","\n\n    ",262],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_STRING","array_unique",264],"(",["T_VARIABLE","$filter_types",264],")",";",["T_WHITESPACE","\n  ",264],"}",["T_WHITESPACE","\n\n  ",265],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",267],["T_WHITESPACE","\n  ",269],["T_PUBLIC","public",270],["T_WHITESPACE"," ",270],["T_FUNCTION","function",270],["T_WHITESPACE"," ",270],["T_STRING","getHtmlRestrictions",270],"(",")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n    ",270],["T_COMMENT","\/\/ Ignore filters that are disabled or don't have HTML restrictions.\n",271],["T_WHITESPACE","    ",272],["T_VARIABLE","$filters",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_STRING","array_filter",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","filters",272],"(",")",["T_OBJECT_OPERATOR","->",272],["T_STRING","getAll",272],"(",")",",",["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],"(",["T_VARIABLE","$filter",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n      ",272],["T_IF","if",273],["T_WHITESPACE"," ",273],"(","!",["T_VARIABLE","$filter",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","status",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n        ",273],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_STRING","FALSE",274],";",["T_WHITESPACE","\n      ",274],"}",["T_WHITESPACE","\n      ",275],["T_IF","if",276],["T_WHITESPACE"," ",276],"(",["T_VARIABLE","$filter",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getType",276],"(",")",["T_WHITESPACE"," ",276],["T_IS_IDENTICAL","===",276],["T_WHITESPACE"," ",276],["T_STRING","FilterInterface",276],["T_DOUBLE_COLON","::",276],["T_STRING","TYPE_HTML_RESTRICTOR",276],["T_WHITESPACE"," ",276],["T_BOOLEAN_AND","&&",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$filter",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getHTMLRestrictions",276],"(",")",["T_WHITESPACE"," ",276],["T_IS_NOT_IDENTICAL","!==",276],["T_WHITESPACE"," ",276],["T_STRING","FALSE",276],")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n        ",276],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_STRING","TRUE",277],";",["T_WHITESPACE","\n      ",277],"}",["T_WHITESPACE","\n      ",278],["T_RETURN","return",279],["T_WHITESPACE"," ",279],["T_STRING","FALSE",279],";",["T_WHITESPACE","\n    ",279],"}",")",";",["T_WHITESPACE","\n\n    ",280],["T_IF","if",282],["T_WHITESPACE"," ",282],"(",["T_EMPTY","empty",282],"(",["T_VARIABLE","$filters",282],")",")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n      ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_STRING","FALSE",283],";",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n    ",284],["T_ELSE","else",285],["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n      ",285],["T_COMMENT","\/\/ From the set of remaining filters (they were filtered by array_filter()\n",286],["T_WHITESPACE","      ",287],["T_COMMENT","\/\/ above), collect the list of tags and attributes that are allowed by all\n",287],["T_WHITESPACE","      ",288],["T_COMMENT","\/\/ filters, i.e. the intersection of all allowed tags and attributes.\n",288],["T_WHITESPACE","      ",289],["T_VARIABLE","$restrictions",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_STRING","array_reduce",289],"(",["T_VARIABLE","$filters",289],",",["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],"(",["T_VARIABLE","$restrictions",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$filter",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$new_restrictions",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$filter",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getHTMLRestrictions",290],"(",")",";",["T_WHITESPACE","\n\n        ",290],["T_COMMENT","\/\/ The first filter with HTML restrictions provides the initial set.\n",292],["T_WHITESPACE","        ",293],["T_IF","if",293],["T_WHITESPACE"," ",293],"(","!",["T_ISSET","isset",293],"(",["T_VARIABLE","$restrictions",293],")",")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n          ",293],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$new_restrictions",294],";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_COMMENT","\/\/ Subsequent filters with an \"allowed html\" setting must be intersected\n",296],["T_WHITESPACE","        ",297],["T_COMMENT","\/\/ with the existing set, to ensure we only end up with the tags that are\n",297],["T_WHITESPACE","        ",298],["T_COMMENT","\/\/ allowed by *all* filters with an \"allowed html\" setting.\n",298],["T_WHITESPACE","        ",299],["T_ELSE","else",299],["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n          ",299],["T_COMMENT","\/\/ Track the union of forbidden (blacklisted) tags.\n",300],["T_WHITESPACE","          ",301],["T_IF","if",301],["T_WHITESPACE"," ",301],"(",["T_ISSET","isset",301],"(",["T_VARIABLE","$new_restrictions",301],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",301],"]",")",")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n            ",301],["T_IF","if",302],["T_WHITESPACE"," ",302],"(","!",["T_ISSET","isset",302],"(",["T_VARIABLE","$restrictions",302],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",302],"]",")",")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n              ",302],["T_VARIABLE","$restrictions",303],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",303],"]",["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$new_restrictions",303],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",303],"]",";",["T_WHITESPACE","\n            ",303],"}",["T_WHITESPACE","\n            ",304],["T_ELSE","else",305],["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n              ",305],["T_VARIABLE","$restrictions",306],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",306],"]",["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_STRING","array_unique",306],"(",["T_STRING","array_merge",306],"(",["T_VARIABLE","$restrictions",306],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",306],"]",",",["T_WHITESPACE"," ",306],["T_VARIABLE","$new_restrictions",306],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",306],"]",")",")",";",["T_WHITESPACE","\n            ",306],"}",["T_WHITESPACE","\n          ",307],"}",["T_WHITESPACE","\n\n          ",308],["T_COMMENT","\/\/ Track the intersection of allowed (whitelisted) tags.\n",310],["T_WHITESPACE","          ",311],["T_IF","if",311],["T_WHITESPACE"," ",311],"(",["T_ISSET","isset",311],"(",["T_VARIABLE","$restrictions",311],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",311],"]",")",")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n            ",311],["T_VARIABLE","$intersection",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$restrictions",312],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",312],"]",";",["T_WHITESPACE","\n            ",312],["T_FOREACH","foreach",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$intersection",313],["T_WHITESPACE"," ",313],["T_AS","as",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$tag",313],["T_WHITESPACE"," ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$attributes",313],")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n              ",313],["T_COMMENT","\/\/ If the current tag is not whitelisted by the new filter, then\n",314],["T_WHITESPACE","              ",315],["T_COMMENT","\/\/ it's outside of the intersection.\n",315],["T_WHITESPACE","              ",316],["T_IF","if",316],["T_WHITESPACE"," ",316],"(","!",["T_STRING","array_key_exists",316],"(",["T_VARIABLE","$tag",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$new_restrictions",316],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",316],"]",")",")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n                ",316],["T_COMMENT","\/\/ The exception is the asterisk (which applies to all tags): it\n",317],["T_WHITESPACE","                ",318],["T_COMMENT","\/\/ does not need to be whitelisted by every filter in order to be\n",318],["T_WHITESPACE","                ",319],["T_COMMENT","\/\/ used; not every filter needs attribute restrictions on all tags.\n",319],["T_WHITESPACE","                ",320],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_VARIABLE","$tag",320],["T_WHITESPACE"," ",320],["T_IS_IDENTICAL","===",320],["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'*'",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n                  ",320],["T_CONTINUE","continue",321],";",["T_WHITESPACE","\n                ",321],"}",["T_WHITESPACE","\n                ",322],["T_UNSET","unset",323],"(",["T_VARIABLE","$intersection",323],"[",["T_VARIABLE","$tag",323],"]",")",";",["T_WHITESPACE","\n              ",323],"}",["T_WHITESPACE","\n              ",324],["T_COMMENT","\/\/ The tag is in the intersection, but now we must calculate the\n",325],["T_WHITESPACE","              ",326],["T_COMMENT","\/\/ intersection of the allowed attributes.\n",326],["T_WHITESPACE","              ",327],["T_ELSE","else",327],["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n                ",327],["T_VARIABLE","$current_attributes",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$intersection",328],"[",["T_VARIABLE","$tag",328],"]",";",["T_WHITESPACE","\n                ",328],["T_VARIABLE","$new_attributes",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$new_restrictions",329],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",329],"]","[",["T_VARIABLE","$tag",329],"]",";",["T_WHITESPACE","\n                ",329],["T_COMMENT","\/\/ The current intersection does not allow any attributes, never\n",330],["T_WHITESPACE","                ",331],["T_COMMENT","\/\/ allow.\n",331],["T_WHITESPACE","                ",332],["T_IF","if",332],["T_WHITESPACE"," ",332],"(","!",["T_STRING","is_array",332],"(",["T_VARIABLE","$current_attributes",332],")",["T_WHITESPACE"," ",332],["T_BOOLEAN_AND","&&",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$current_attributes",332],["T_WHITESPACE"," ",332],["T_IS_EQUAL","==",332],["T_WHITESPACE"," ",332],["T_STRING","FALSE",332],")",["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n                  ",332],["T_CONTINUE","continue",333],";",["T_WHITESPACE","\n                ",333],"}",["T_WHITESPACE","\n                ",334],["T_COMMENT","\/\/ The new filter allows less attributes (all -> list or none).\n",335],["T_WHITESPACE","                ",336],["T_ELSEIF","elseif",336],["T_WHITESPACE"," ",336],"(","!",["T_STRING","is_array",336],"(",["T_VARIABLE","$current_attributes",336],")",["T_WHITESPACE"," ",336],["T_BOOLEAN_AND","&&",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$current_attributes",336],["T_WHITESPACE"," ",336],["T_IS_EQUAL","==",336],["T_WHITESPACE"," ",336],["T_STRING","TRUE",336],["T_WHITESPACE"," ",336],["T_BOOLEAN_AND","&&",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$new_attributes",336],["T_WHITESPACE"," ",336],["T_IS_EQUAL","==",336],["T_WHITESPACE"," ",336],["T_STRING","FALSE",336],["T_WHITESPACE"," ",336],["T_BOOLEAN_OR","||",336],["T_WHITESPACE"," ",336],["T_STRING","is_array",336],"(",["T_VARIABLE","$new_attributes",336],")",")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                  ",336],["T_VARIABLE","$intersection",337],"[",["T_VARIABLE","$tag",337],"]",["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_VARIABLE","$new_attributes",337],";",["T_WHITESPACE","\n                ",337],"}",["T_WHITESPACE","\n                ",338],["T_COMMENT","\/\/ The new filter allows less attributes (list -> none).\n",339],["T_WHITESPACE","                ",340],["T_ELSEIF","elseif",340],["T_WHITESPACE"," ",340],"(",["T_STRING","is_array",340],"(",["T_VARIABLE","$current_attributes",340],")",["T_WHITESPACE"," ",340],["T_BOOLEAN_AND","&&",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$new_attributes",340],["T_WHITESPACE"," ",340],["T_IS_EQUAL","==",340],["T_WHITESPACE"," ",340],["T_STRING","FALSE",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n                  ",340],["T_VARIABLE","$intersection",341],"[",["T_VARIABLE","$tag",341],"]",["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$new_attributes",341],";",["T_WHITESPACE","\n                ",341],"}",["T_WHITESPACE","\n                ",342],["T_COMMENT","\/\/ The new filter allows more attributes; retain current.\n",343],["T_WHITESPACE","                ",344],["T_ELSEIF","elseif",344],["T_WHITESPACE"," ",344],"(",["T_STRING","is_array",344],"(",["T_VARIABLE","$current_attributes",344],")",["T_WHITESPACE"," ",344],["T_BOOLEAN_AND","&&",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$new_attributes",344],["T_WHITESPACE"," ",344],["T_IS_EQUAL","==",344],["T_WHITESPACE"," ",344],["T_STRING","TRUE",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                  ",344],["T_CONTINUE","continue",345],";",["T_WHITESPACE","\n                ",345],"}",["T_WHITESPACE","\n                ",346],["T_COMMENT","\/\/ The new filter allows the same attributes; retain current.\n",347],["T_WHITESPACE","                ",348],["T_ELSEIF","elseif",348],["T_WHITESPACE"," ",348],"(",["T_VARIABLE","$current_attributes",348],["T_WHITESPACE"," ",348],["T_IS_EQUAL","==",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$new_attributes",348],")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n                  ",348],["T_CONTINUE","continue",349],";",["T_WHITESPACE","\n                ",349],"}",["T_WHITESPACE","\n                ",350],["T_COMMENT","\/\/ Both list an array of attribute values; do an intersection,\n",351],["T_WHITESPACE","                ",352],["T_COMMENT","\/\/ where we take into account that a value of:\n",352],["T_WHITESPACE","                ",353],["T_COMMENT","\/\/  - TRUE means the attribute value is allowed;\n",353],["T_WHITESPACE","                ",354],["T_COMMENT","\/\/  - FALSE means the attribute value is forbidden;\n",354],["T_WHITESPACE","                ",355],["T_COMMENT","\/\/ hence we keep the ANDed result.\n",355],["T_WHITESPACE","                ",356],["T_ELSE","else",356],["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n                  ",356],["T_VARIABLE","$intersection",357],"[",["T_VARIABLE","$tag",357],"]",["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_STRING","array_intersect_key",357],"(",["T_VARIABLE","$intersection",357],"[",["T_VARIABLE","$tag",357],"]",",",["T_WHITESPACE"," ",357],["T_VARIABLE","$new_attributes",357],")",";",["T_WHITESPACE","\n                  ",357],["T_FOREACH","foreach",358],["T_WHITESPACE"," ",358],"(",["T_STRING","array_keys",358],"(",["T_VARIABLE","$intersection",358],"[",["T_VARIABLE","$tag",358],"]",")",["T_WHITESPACE"," ",358],["T_AS","as",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$attribute_value",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n                    ",358],["T_VARIABLE","$intersection",359],"[",["T_VARIABLE","$tag",359],"]","[",["T_VARIABLE","$attribute_value",359],"]",["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$intersection",359],"[",["T_VARIABLE","$tag",359],"]","[",["T_VARIABLE","$attribute_value",359],"]",["T_WHITESPACE"," ",359],["T_BOOLEAN_AND","&&",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$new_attributes",359],"[",["T_VARIABLE","$attribute_value",359],"]",";",["T_WHITESPACE","\n                  ",359],"}",["T_WHITESPACE","\n                ",360],"}",["T_WHITESPACE","\n              ",361],"}",["T_WHITESPACE","\n            ",362],"}",["T_WHITESPACE","\n            ",363],["T_VARIABLE","$restrictions",364],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",364],"]",["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_VARIABLE","$intersection",364],";",["T_WHITESPACE","\n          ",364],"}",["T_WHITESPACE","\n\n          ",365],["T_RETURN","return",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$restrictions",367],";",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE","\n      ",368],"}",",",["T_WHITESPACE"," ",369],["T_STRING","NULL",369],")",";",["T_WHITESPACE","\n\n      ",369],["T_COMMENT","\/\/ Simplification: if we have both a (intersected) whitelist and a (unioned)\n",371],["T_WHITESPACE","      ",372],["T_COMMENT","\/\/ blacklist, then remove any tags from the whitelist that also exist in the\n",372],["T_WHITESPACE","      ",373],["T_COMMENT","\/\/ blacklist. Now the whitelist alone expresses all tag-level restrictions,\n",373],["T_WHITESPACE","      ",374],["T_COMMENT","\/\/ and we can delete the blacklist.\n",374],["T_WHITESPACE","      ",375],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_ISSET","isset",375],"(",["T_VARIABLE","$restrictions",375],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",375],"]",")",["T_WHITESPACE"," ",375],["T_BOOLEAN_AND","&&",375],["T_WHITESPACE"," ",375],["T_ISSET","isset",375],"(",["T_VARIABLE","$restrictions",375],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",375],"]",")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n        ",375],["T_FOREACH","foreach",376],["T_WHITESPACE"," ",376],"(",["T_VARIABLE","$restrictions",376],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",376],"]",["T_WHITESPACE"," ",376],["T_AS","as",376],["T_WHITESPACE"," ",376],["T_VARIABLE","$tag",376],")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n          ",376],["T_IF","if",377],["T_WHITESPACE"," ",377],"(",["T_ISSET","isset",377],"(",["T_VARIABLE","$restrictions",377],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",377],"]","[",["T_VARIABLE","$tag",377],"]",")",")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n            ",377],["T_UNSET","unset",378],"(",["T_VARIABLE","$restrictions",378],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",378],"]","[",["T_VARIABLE","$tag",378],"]",")",";",["T_WHITESPACE","\n          ",378],"}",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE","\n        ",380],["T_UNSET","unset",381],"(",["T_VARIABLE","$restrictions",381],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",381],"]",")",";",["T_WHITESPACE","\n      ",381],"}",["T_WHITESPACE","\n\n      ",382],["T_COMMENT","\/\/ Simplification: if the only remaining allowed tag is the asterisk (which\n",384],["T_WHITESPACE","      ",385],["T_COMMENT","\/\/ contains attribute restrictions that apply to all tags), and only\n",385],["T_WHITESPACE","      ",386],["T_COMMENT","\/\/ whitelisting filters were used, then effectively nothing is allowed.\n",386],["T_WHITESPACE","      ",387],["T_IF","if",387],["T_WHITESPACE"," ",387],"(",["T_ISSET","isset",387],"(",["T_VARIABLE","$restrictions",387],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",387],"]",")",")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n        ",387],["T_IF","if",388],["T_WHITESPACE"," ",388],"(",["T_STRING","count",388],"(",["T_VARIABLE","$restrictions",388],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",388],"]",")",["T_WHITESPACE"," ",388],["T_IS_IDENTICAL","===",388],["T_WHITESPACE"," ",388],["T_LNUMBER","1",388],["T_WHITESPACE"," ",388],["T_BOOLEAN_AND","&&",388],["T_WHITESPACE"," ",388],["T_STRING","array_key_exists",388],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",388],",",["T_WHITESPACE"," ",388],["T_VARIABLE","$restrictions",388],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",388],"]",")",["T_WHITESPACE"," ",388],["T_BOOLEAN_AND","&&",388],["T_WHITESPACE"," ",388],"!",["T_ISSET","isset",388],"(",["T_VARIABLE","$restrictions",388],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",388],"]",")",")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n          ",388],["T_VARIABLE","$restrictions",389],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",389],"]",["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_ARRAY","array",389],"(",")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n      ",390],"}",["T_WHITESPACE","\n\n      ",391],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$restrictions",393],";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n  ",394],"}",["T_WHITESPACE","\n\n  ",395],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",397],["T_WHITESPACE","\n  ",399],["T_PUBLIC","public",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","removeFilter",400],"(",["T_VARIABLE","$instance_id",400],")",["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n    ",400],["T_UNSET","unset",401],"(",["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","filters",401],"[",["T_VARIABLE","$instance_id",401],"]",")",";",["T_WHITESPACE","\n    ",401],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","filterCollection",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","removeInstanceId",402],"(",["T_VARIABLE","$instance_id",402],")",";",["T_WHITESPACE","\n  ",402],"}",["T_WHITESPACE","\n\n  ",403],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",405],["T_WHITESPACE","\n  ",407],["T_PUBLIC","public",408],["T_WHITESPACE"," ",408],["T_FUNCTION","function",408],["T_WHITESPACE"," ",408],["T_STRING","onDependencyRemoval",408],"(",["T_ARRAY","array",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$dependencies",408],")",["T_WHITESPACE"," ",408],"{",["T_WHITESPACE","\n    ",408],["T_VARIABLE","$changed",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_STRING","parent",409],["T_DOUBLE_COLON","::",409],["T_STRING","onDependencyRemoval",409],"(",["T_VARIABLE","$dependencies",409],")",";",["T_WHITESPACE","\n    ",409],["T_VARIABLE","$filters",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","filters",410],"(",")",";",["T_WHITESPACE","\n    ",410],["T_FOREACH","foreach",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$filters",411],["T_WHITESPACE"," ",411],["T_AS","as",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$filter",411],")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n      ",411],["T_COMMENT","\/\/ Remove disabled filters, so that this FilterFormat config entity can\n",412],["T_WHITESPACE","      ",413],["T_COMMENT","\/\/ continue to exist.\n",413],["T_WHITESPACE","      ",414],["T_IF","if",414],["T_WHITESPACE"," ",414],"(","!",["T_VARIABLE","$filter",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","status",414],["T_WHITESPACE"," ",414],["T_BOOLEAN_AND","&&",414],["T_WHITESPACE"," ",414],["T_STRING","in_array",414],"(",["T_VARIABLE","$filter",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","provider",414],",",["T_WHITESPACE"," ",414],["T_VARIABLE","$dependencies",414],"[",["T_CONSTANT_ENCAPSED_STRING","'module'",414],"]",")",")",["T_WHITESPACE"," ",414],"{",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","removeFilter",415],"(",["T_VARIABLE","$filter",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","getPluginId",415],"(",")",")",";",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$changed",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_STRING","TRUE",416],";",["T_WHITESPACE","\n      ",416],"}",["T_WHITESPACE","\n    ",417],"}",["T_WHITESPACE","\n    ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$changed",419],";",["T_WHITESPACE","\n  ",419],"}",["T_WHITESPACE","\n\n  ",420],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",422],["T_WHITESPACE","\n  ",424],["T_PROTECTED","protected",425],["T_WHITESPACE"," ",425],["T_FUNCTION","function",425],["T_WHITESPACE"," ",425],["T_STRING","calculatePluginDependencies",425],"(",["T_STRING","PluginInspectionInterface",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$instance",425],")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n    ",425],["T_COMMENT","\/\/ Only add dependencies for plugins that are actually configured. This is\n",426],["T_WHITESPACE","    ",427],["T_COMMENT","\/\/ necessary because the filter plugin collection will return all available\n",427],["T_WHITESPACE","    ",428],["T_COMMENT","\/\/ filter plugins.\n",428],["T_WHITESPACE","    ",429],["T_COMMENT","\/\/ @see \\Drupal\\filter\\FilterPluginCollection::getConfiguration()\n",429],["T_WHITESPACE","    ",430],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_ISSET","isset",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","filters",430],"[",["T_VARIABLE","$instance",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getPluginId",430],"(",")","]",")",")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n      ",430],["T_STRING","parent",431],["T_DOUBLE_COLON","::",431],["T_STRING","calculatePluginDependencies",431],"(",["T_VARIABLE","$instance",431],")",";",["T_WHITESPACE","\n    ",431],"}",["T_WHITESPACE","\n  ",432],"}",["T_WHITESPACE","\n\n",433],"}",["T_WHITESPACE","\n",435]]