[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","filter",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Unicode",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","filter",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FilterFormat",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","simpletest",7],["T_NS_SEPARATOR","\\",7],["T_STRING","WebTestBase",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Tests the default text formats for different users.\n *\n * @group filter\n *\/",9],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","FilterDefaultFormatTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_STRING","WebTestBase",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",16],["T_WHITESPACE","\n  ",20],["T_PUBLIC","public",21],["T_WHITESPACE"," ",21],["T_STATIC","static",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$modules",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_ARRAY","array",21],"(",["T_CONSTANT_ENCAPSED_STRING","'filter'",21],")",";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * Tests if the default text format is accessible to users.\n   *\/",23],["T_WHITESPACE","\n  ",25],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","testDefaultTextFormats",26],"(",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n    ",26],["T_COMMENT","\/\/ Create two text formats, and two users. The first user has access to\n",27],["T_WHITESPACE","    ",28],["T_COMMENT","\/\/ both formats, but the second user only has access to the second one.\n",28],["T_WHITESPACE","    ",29],["T_VARIABLE","$admin_user",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","drupalCreateUser",29],"(",["T_ARRAY","array",29],"(",["T_CONSTANT_ENCAPSED_STRING","'administer filters'",29],")",")",";",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","drupalLogin",30],"(",["T_VARIABLE","$admin_user",30],")",";",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$formats",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_ARRAY","array",31],"(",")",";",["T_WHITESPACE","\n    ",31],["T_FOR","for",32],["T_WHITESPACE"," ",32],"(",["T_VARIABLE","$i",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_LNUMBER","0",32],";",["T_WHITESPACE"," ",32],["T_VARIABLE","$i",32],["T_WHITESPACE"," ",32],"<",["T_WHITESPACE"," ",32],["T_LNUMBER","2",32],";",["T_WHITESPACE"," ",32],["T_VARIABLE","$i",32],["T_INC","++",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n      ",32],["T_VARIABLE","$edit",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_WHITESPACE","\n        ",33],["T_CONSTANT_ENCAPSED_STRING","'format'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_STRING","Unicode",34],["T_DOUBLE_COLON","::",34],["T_STRING","strtolower",34],"(",["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","randomMachineName",34],"(",")",")",",",["T_WHITESPACE","\n        ",34],["T_CONSTANT_ENCAPSED_STRING","'name'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","randomMachineName",35],"(",")",",",["T_WHITESPACE","\n      ",35],")",";",["T_WHITESPACE","\n      ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","drupalPostForm",37],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/content\/formats\/add'",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$edit",37],",",["T_WHITESPACE"," ",37],["T_STRING","t",37],"(",["T_CONSTANT_ENCAPSED_STRING","'Save configuration'",37],")",")",";",["T_WHITESPACE","\n      ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","resetFilterCaches",38],"(",")",";",["T_WHITESPACE","\n      ",38],["T_VARIABLE","$formats",39],"[","]",["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","FilterFormat",39],["T_DOUBLE_COLON","::",39],["T_STRING","load",39],"(",["T_VARIABLE","$edit",39],"[",["T_CONSTANT_ENCAPSED_STRING","'format'",39],"]",")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n    ",40],["T_LIST","list",41],"(",["T_VARIABLE","$first_format",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$second_format",41],")",["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$formats",41],";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$second_format_permission",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$second_format",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getPermissionName",42],"(",")",";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$first_user",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","drupalCreateUser",43],"(",["T_ARRAY","array",43],"(",["T_VARIABLE","$first_format",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getPermissionName",43],"(",")",",",["T_WHITESPACE"," ",43],["T_VARIABLE","$second_format_permission",43],")",")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$second_user",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","drupalCreateUser",44],"(",["T_ARRAY","array",44],"(",["T_VARIABLE","$second_format_permission",44],")",")",";",["T_WHITESPACE","\n\n    ",44],["T_COMMENT","\/\/ Adjust the weights so that the first and second formats (in that order)\n",46],["T_WHITESPACE","    ",47],["T_COMMENT","\/\/ are the two lowest weighted formats available to any user.\n",47],["T_WHITESPACE","    ",48],["T_VARIABLE","$edit",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$edit",49],"[",["T_CONSTANT_ENCAPSED_STRING","'formats['",49],["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_VARIABLE","$first_format",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","id",49],"(",")",["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'][weight]'",49],"]",["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],"-",["T_LNUMBER","2",49],";",["T_WHITESPACE","\n    ",49],["T_VARIABLE","$edit",50],"[",["T_CONSTANT_ENCAPSED_STRING","'formats['",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$second_format",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","id",50],"(",")",["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'][weight]'",50],"]",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],"-",["T_LNUMBER","1",50],";",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalPostForm",51],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/content\/formats'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$edit",51],",",["T_WHITESPACE"," ",51],["T_STRING","t",51],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",51],")",")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","resetFilterCaches",52],"(",")",";",["T_WHITESPACE","\n\n    ",52],["T_COMMENT","\/\/ Check that each user's default format is the lowest weighted format that\n",54],["T_WHITESPACE","    ",55],["T_COMMENT","\/\/ the user has access to.\n",55],["T_WHITESPACE","    ",56],["T_VARIABLE","$actual",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","filter_default_format",56],"(",["T_VARIABLE","$first_user",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$expected",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$first_format",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","id",57],"(",")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertEqual",58],"(",["T_VARIABLE","$actual",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$expected",58],",",["T_WHITESPACE"," ",58],"\"",["T_ENCAPSED_AND_WHITESPACE","First user's default format ",58],["T_VARIABLE","$actual",58],["T_ENCAPSED_AND_WHITESPACE"," is the expected lowest weighted format ",58],["T_VARIABLE","$expected",58],["T_ENCAPSED_AND_WHITESPACE"," that the user has access to.",58],"\"",")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$actual",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","filter_default_format",59],"(",["T_VARIABLE","$second_user",59],")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$expected",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$second_format",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","id",60],"(",")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertEqual",61],"(",["T_VARIABLE","$actual",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$expected",61],",",["T_WHITESPACE"," ",61],"\"",["T_ENCAPSED_AND_WHITESPACE","Second user's default format ",61],["T_VARIABLE","$actual",61],["T_ENCAPSED_AND_WHITESPACE"," is the expected lowest weighted format ",61],["T_VARIABLE","$expected",61],["T_ENCAPSED_AND_WHITESPACE"," that the user has access to, and different to the first user's.",61],"\"",")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ Reorder the two formats, and check that both users now have the same\n",63],["T_WHITESPACE","    ",64],["T_COMMENT","\/\/ default.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$edit",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_ARRAY","array",65],"(",")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$edit",66],"[",["T_CONSTANT_ENCAPSED_STRING","'formats['",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$second_format",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","id",66],"(",")",["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'][weight]'",66],"]",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],"-",["T_LNUMBER","3",66],";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","drupalPostForm",67],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/content\/formats'",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$edit",67],",",["T_WHITESPACE"," ",67],["T_STRING","t",67],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",67],")",")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","resetFilterCaches",68],"(",")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEqual",69],"(",["T_STRING","filter_default_format",69],"(",["T_VARIABLE","$first_user",69],")",",",["T_WHITESPACE"," ",69],["T_STRING","filter_default_format",69],"(",["T_VARIABLE","$second_user",69],")",",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'After the formats are reordered, both users have the same default format.'",69],")",";",["T_WHITESPACE","\n  ",69],"}",["T_WHITESPACE","\n\n  ",70],["T_DOC_COMMENT","\/**\n   * Rebuilds text format and permission caches in the thread running the tests.\n   *\/",72],["T_WHITESPACE","\n  ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","resetFilterCaches",75],"(",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n    ",75],["T_STRING","filter_formats_reset",76],"(",")",";",["T_WHITESPACE","\n  ",76],"}",["T_WHITESPACE","\n\n",77],"}",["T_WHITESPACE","\n",79]]