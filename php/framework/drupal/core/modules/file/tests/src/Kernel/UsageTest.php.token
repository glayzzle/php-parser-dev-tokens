[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","file",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","field",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FieldConfig",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","field",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FieldStorageConfig",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","language",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ConfigurableLanguage",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","language",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ContentLanguageSettings",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","node",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Node",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","node",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Entity",10],["T_NS_SEPARATOR","\\",10],["T_STRING","NodeType",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Tests file usage functions.\n *\n * @group file\n *\/",12],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","UsageTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_STRING","FileManagedUnitTestBase",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n  ",17],["T_DOC_COMMENT","\/**\n   * Tests \\Drupal\\file\\FileUsage\\DatabaseFileUsageBackend::listUsage().\n   *\/",18],["T_WHITESPACE","\n  ",20],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","testGetUsage",21],"(",")",["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n    ",21],["T_VARIABLE","$file",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","createFile",22],"(",")",";",["T_WHITESPACE","\n    ",22],["T_STRING","db_insert",23],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",23],")",["T_WHITESPACE","\n      ",23],["T_OBJECT_OPERATOR","->",24],["T_STRING","fields",24],"(",["T_ARRAY","array",24],"(",["T_WHITESPACE","\n        ",24],["T_CONSTANT_ENCAPSED_STRING","'fid'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$file",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","id",25],"(",")",",",["T_WHITESPACE","\n        ",25],["T_CONSTANT_ENCAPSED_STRING","'module'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'testing'",26],",",["T_WHITESPACE","\n        ",26],["T_CONSTANT_ENCAPSED_STRING","'type'",27],["T_WHITESPACE"," ",27],["T_DOUBLE_ARROW","=>",27],["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'foo'",27],",",["T_WHITESPACE","\n        ",27],["T_CONSTANT_ENCAPSED_STRING","'id'",28],["T_WHITESPACE"," ",28],["T_DOUBLE_ARROW","=>",28],["T_WHITESPACE"," ",28],["T_LNUMBER","1",28],",",["T_WHITESPACE","\n        ",28],["T_CONSTANT_ENCAPSED_STRING","'count'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],["T_LNUMBER","1",29],["T_WHITESPACE","\n      ",29],")",")",["T_WHITESPACE","\n      ",30],["T_OBJECT_OPERATOR","->",31],["T_STRING","execute",31],"(",")",";",["T_WHITESPACE","\n    ",31],["T_STRING","db_insert",32],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",32],")",["T_WHITESPACE","\n      ",32],["T_OBJECT_OPERATOR","->",33],["T_STRING","fields",33],"(",["T_ARRAY","array",33],"(",["T_WHITESPACE","\n        ",33],["T_CONSTANT_ENCAPSED_STRING","'fid'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$file",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","id",34],"(",")",",",["T_WHITESPACE","\n        ",34],["T_CONSTANT_ENCAPSED_STRING","'module'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'testing'",35],",",["T_WHITESPACE","\n        ",35],["T_CONSTANT_ENCAPSED_STRING","'type'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'bar'",36],",",["T_WHITESPACE","\n        ",36],["T_CONSTANT_ENCAPSED_STRING","'id'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_LNUMBER","2",37],",",["T_WHITESPACE","\n        ",37],["T_CONSTANT_ENCAPSED_STRING","'count'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_LNUMBER","2",38],["T_WHITESPACE","\n      ",38],")",")",["T_WHITESPACE","\n      ",39],["T_OBJECT_OPERATOR","->",40],["T_STRING","execute",40],"(",")",";",["T_WHITESPACE","\n\n    ",40],["T_VARIABLE","$usage",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","container",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","get",42],"(",["T_CONSTANT_ENCAPSED_STRING","'file.usage'",42],")",["T_OBJECT_OPERATOR","->",42],["T_STRING","listUsage",42],"(",["T_VARIABLE","$file",42],")",";",["T_WHITESPACE","\n\n    ",42],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","assertEqual",44],"(",["T_STRING","count",44],"(",["T_VARIABLE","$usage",44],"[",["T_CONSTANT_ENCAPSED_STRING","'testing'",44],"]",")",",",["T_WHITESPACE"," ",44],["T_LNUMBER","2",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct number of items.'",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertTrue",45],"(",["T_ISSET","isset",45],"(",["T_VARIABLE","$usage",45],"[",["T_CONSTANT_ENCAPSED_STRING","'testing'",45],"]","[",["T_CONSTANT_ENCAPSED_STRING","'foo'",45],"]","[",["T_LNUMBER","1",45],"]",")",",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct id.'",45],")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","assertTrue",46],"(",["T_ISSET","isset",46],"(",["T_VARIABLE","$usage",46],"[",["T_CONSTANT_ENCAPSED_STRING","'testing'",46],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bar'",46],"]","[",["T_LNUMBER","2",46],"]",")",",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct id.'",46],")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertEqual",47],"(",["T_VARIABLE","$usage",47],"[",["T_CONSTANT_ENCAPSED_STRING","'testing'",47],"]","[",["T_CONSTANT_ENCAPSED_STRING","'foo'",47],"]","[",["T_LNUMBER","1",47],"]",",",["T_WHITESPACE"," ",47],["T_LNUMBER","1",47],",",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct count.'",47],")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","assertEqual",48],"(",["T_VARIABLE","$usage",48],"[",["T_CONSTANT_ENCAPSED_STRING","'testing'",48],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bar'",48],"]","[",["T_LNUMBER","2",48],"]",",",["T_WHITESPACE"," ",48],["T_LNUMBER","2",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'Returned the correct count.'",48],")",";",["T_WHITESPACE","\n  ",48],"}",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * Tests \\Drupal\\file\\FileUsage\\DatabaseFileUsageBackend::add().\n   *\/",51],["T_WHITESPACE","\n  ",53],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","testAddUsage",54],"(",")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$file",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","createFile",55],"(",")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$file_usage",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","container",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","get",56],"(",["T_CONSTANT_ENCAPSED_STRING","'file.usage'",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$file_usage",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","add",57],"(",["T_VARIABLE","$file",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'testing'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'foo'",57],",",["T_WHITESPACE"," ",57],["T_LNUMBER","1",57],")",";",["T_WHITESPACE","\n    ",57],["T_COMMENT","\/\/ Add the file twice to ensure that the count is incremented rather than\n",58],["T_WHITESPACE","    ",59],["T_COMMENT","\/\/ creating additional records.\n",59],["T_WHITESPACE","    ",60],["T_VARIABLE","$file_usage",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","add",60],"(",["T_VARIABLE","$file",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'testing'",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'bar'",60],",",["T_WHITESPACE"," ",60],["T_LNUMBER","2",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$file_usage",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","add",61],"(",["T_VARIABLE","$file",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'testing'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'bar'",61],",",["T_WHITESPACE"," ",61],["T_LNUMBER","2",61],")",";",["T_WHITESPACE","\n\n    ",61],["T_VARIABLE","$usage",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","db_select",63],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'f'",63],")",["T_WHITESPACE","\n      ",63],["T_OBJECT_OPERATOR","->",64],["T_STRING","fields",64],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",64],")",["T_WHITESPACE","\n      ",64],["T_OBJECT_OPERATOR","->",65],["T_STRING","condition",65],"(",["T_CONSTANT_ENCAPSED_STRING","'f.fid'",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$file",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","id",65],"(",")",")",["T_WHITESPACE","\n      ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","execute",66],"(",")",["T_WHITESPACE","\n      ",66],["T_OBJECT_OPERATOR","->",67],["T_STRING","fetchAllAssoc",67],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",67],")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","assertEqual",68],"(",["T_STRING","count",68],"(",["T_VARIABLE","$usage",68],")",",",["T_WHITESPACE"," ",68],["T_LNUMBER","2",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'Created two records'",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEqual",69],"(",["T_VARIABLE","$usage",69],"[",["T_LNUMBER","1",69],"]",["T_OBJECT_OPERATOR","->",69],["T_STRING","module",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'testing'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'Correct module'",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertEqual",70],"(",["T_VARIABLE","$usage",70],"[",["T_LNUMBER","2",70],"]",["T_OBJECT_OPERATOR","->",70],["T_STRING","module",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'testing'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'Correct module'",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertEqual",71],"(",["T_VARIABLE","$usage",71],"[",["T_LNUMBER","1",71],"]",["T_OBJECT_OPERATOR","->",71],["T_STRING","type",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'foo'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'Correct type'",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertEqual",72],"(",["T_VARIABLE","$usage",72],"[",["T_LNUMBER","2",72],"]",["T_OBJECT_OPERATOR","->",72],["T_STRING","type",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'bar'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Correct type'",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","assertEqual",73],"(",["T_VARIABLE","$usage",73],"[",["T_LNUMBER","1",73],"]",["T_OBJECT_OPERATOR","->",73],["T_STRING","count",73],",",["T_WHITESPACE"," ",73],["T_LNUMBER","1",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'Correct count'",73],")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","assertEqual",74],"(",["T_VARIABLE","$usage",74],"[",["T_LNUMBER","2",74],"]",["T_OBJECT_OPERATOR","->",74],["T_STRING","count",74],",",["T_WHITESPACE"," ",74],["T_LNUMBER","2",74],",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'Correct count'",74],")",";",["T_WHITESPACE","\n  ",74],"}",["T_WHITESPACE","\n\n  ",75],["T_DOC_COMMENT","\/**\n   * Tests \\Drupal\\file\\FileUsage\\DatabaseFileUsageBackend::delete().\n   *\/",77],["T_WHITESPACE","\n  ",79],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","testRemoveUsage",80],"(",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$file",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","createFile",81],"(",")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$file_usage",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","container",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","get",82],"(",["T_CONSTANT_ENCAPSED_STRING","'file.usage'",82],")",";",["T_WHITESPACE","\n    ",82],["T_STRING","db_insert",83],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",83],")",["T_WHITESPACE","\n      ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","fields",84],"(",["T_ARRAY","array",84],"(",["T_WHITESPACE","\n        ",84],["T_CONSTANT_ENCAPSED_STRING","'fid'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$file",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","id",85],"(",")",",",["T_WHITESPACE","\n        ",85],["T_CONSTANT_ENCAPSED_STRING","'module'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'testing'",86],",",["T_WHITESPACE","\n        ",86],["T_CONSTANT_ENCAPSED_STRING","'type'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'bar'",87],",",["T_WHITESPACE","\n        ",87],["T_CONSTANT_ENCAPSED_STRING","'id'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_LNUMBER","2",88],",",["T_WHITESPACE","\n        ",88],["T_CONSTANT_ENCAPSED_STRING","'count'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_LNUMBER","3",89],",",["T_WHITESPACE","\n      ",89],")",")",["T_WHITESPACE","\n      ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","execute",91],"(",")",";",["T_WHITESPACE","\n\n    ",91],["T_COMMENT","\/\/ Normal decrement.\n",93],["T_WHITESPACE","    ",94],["T_VARIABLE","$file_usage",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","delete",94],"(",["T_VARIABLE","$file",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'testing'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'bar'",94],",",["T_WHITESPACE"," ",94],["T_LNUMBER","2",94],")",";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$count",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","db_select",95],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'f'",95],")",["T_WHITESPACE","\n      ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","fields",96],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",96],",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",96],")",")",["T_WHITESPACE","\n      ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","condition",97],"(",["T_CONSTANT_ENCAPSED_STRING","'f.fid'",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$file",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","id",97],"(",")",")",["T_WHITESPACE","\n      ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","execute",98],"(",")",["T_WHITESPACE","\n      ",98],["T_OBJECT_OPERATOR","->",99],["T_STRING","fetchField",99],"(",")",";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","assertEqual",100],"(",["T_LNUMBER","2",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$count",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'The count was decremented correctly.'",100],")",";",["T_WHITESPACE","\n\n    ",100],["T_COMMENT","\/\/ Multiple decrement and removal.\n",102],["T_WHITESPACE","    ",103],["T_VARIABLE","$file_usage",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","delete",103],"(",["T_VARIABLE","$file",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'testing'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'bar'",103],",",["T_WHITESPACE"," ",103],["T_LNUMBER","2",103],",",["T_WHITESPACE"," ",103],["T_LNUMBER","2",103],")",";",["T_WHITESPACE","\n    ",103],["T_VARIABLE","$count",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","db_select",104],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'f'",104],")",["T_WHITESPACE","\n      ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","fields",105],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",105],",",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",105],")",")",["T_WHITESPACE","\n      ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","condition",106],"(",["T_CONSTANT_ENCAPSED_STRING","'f.fid'",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$file",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","id",106],"(",")",")",["T_WHITESPACE","\n      ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","execute",107],"(",")",["T_WHITESPACE","\n      ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","fetchField",108],"(",")",";",["T_WHITESPACE","\n    ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assertIdentical",109],"(",["T_STRING","FALSE",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$count",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'The count was removed entirely when empty.'",109],")",";",["T_WHITESPACE","\n\n    ",109],["T_COMMENT","\/\/ Non-existent decrement.\n",111],["T_WHITESPACE","    ",112],["T_VARIABLE","$file_usage",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","delete",112],"(",["T_VARIABLE","$file",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'testing'",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'bar'",112],",",["T_WHITESPACE"," ",112],["T_LNUMBER","2",112],")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$count",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","db_select",113],"(",["T_CONSTANT_ENCAPSED_STRING","'file_usage'",113],",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'f'",113],")",["T_WHITESPACE","\n      ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","fields",114],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",114],",",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",114],")",")",["T_WHITESPACE","\n      ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","condition",115],"(",["T_CONSTANT_ENCAPSED_STRING","'f.fid'",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$file",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","id",115],"(",")",")",["T_WHITESPACE","\n      ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","execute",116],"(",")",["T_WHITESPACE","\n      ",116],["T_OBJECT_OPERATOR","->",117],["T_STRING","fetchField",117],"(",")",";",["T_WHITESPACE","\n    ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","assertIdentical",118],"(",["T_STRING","FALSE",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$count",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'Decrementing non-exist record complete.'",118],")",";",["T_WHITESPACE","\n  ",118],"}",["T_WHITESPACE","\n\n  ",119],["T_DOC_COMMENT","\/**\n   * Create files for all the possible combinations of age and status.\n   *\n   * We are using UPDATE statements because using the API would set the\n   * timestamp.\n   *\/",121],["T_WHITESPACE","\n  ",126],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","createTempFiles",127],"(",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n    ",127],["T_COMMENT","\/\/ Temporary file that is old.\n",128],["T_WHITESPACE","    ",129],["T_VARIABLE","$temp_old",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","file_save_data",129],"(",["T_CONSTANT_ENCAPSED_STRING","''",129],")",";",["T_WHITESPACE","\n    ",129],["T_STRING","db_update",130],"(",["T_CONSTANT_ENCAPSED_STRING","'file_managed'",130],")",["T_WHITESPACE","\n      ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","fields",131],"(",["T_ARRAY","array",131],"(",["T_WHITESPACE","\n        ",131],["T_CONSTANT_ENCAPSED_STRING","'status'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_LNUMBER","0",132],",",["T_WHITESPACE","\n        ",132],["T_CONSTANT_ENCAPSED_STRING","'changed'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_STRING","REQUEST_TIME",133],["T_WHITESPACE"," ",133],"-",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","config",133],"(",["T_CONSTANT_ENCAPSED_STRING","'system.file'",133],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","get",133],"(",["T_CONSTANT_ENCAPSED_STRING","'temporary_maximum_age'",133],")",["T_WHITESPACE"," ",133],"-",["T_WHITESPACE"," ",133],["T_LNUMBER","1",133],",",["T_WHITESPACE","\n      ",133],")",")",["T_WHITESPACE","\n      ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","condition",135],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$temp_old",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","id",135],"(",")",")",["T_WHITESPACE","\n      ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","execute",136],"(",")",";",["T_WHITESPACE","\n    ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertTrue",137],"(",["T_STRING","file_exists",137],"(",["T_VARIABLE","$temp_old",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getFileUri",137],"(",")",")",",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'Old temp file was created correctly.'",137],")",";",["T_WHITESPACE","\n\n    ",137],["T_COMMENT","\/\/ Temporary file that is new.\n",139],["T_WHITESPACE","    ",140],["T_VARIABLE","$temp_new",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","file_save_data",140],"(",["T_CONSTANT_ENCAPSED_STRING","''",140],")",";",["T_WHITESPACE","\n    ",140],["T_STRING","db_update",141],"(",["T_CONSTANT_ENCAPSED_STRING","'file_managed'",141],")",["T_WHITESPACE","\n      ",141],["T_OBJECT_OPERATOR","->",142],["T_STRING","fields",142],"(",["T_ARRAY","array",142],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_LNUMBER","0",142],")",")",["T_WHITESPACE","\n      ",142],["T_OBJECT_OPERATOR","->",143],["T_STRING","condition",143],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$temp_new",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","id",143],"(",")",")",["T_WHITESPACE","\n      ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","execute",144],"(",")",";",["T_WHITESPACE","\n    ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","assertTrue",145],"(",["T_STRING","file_exists",145],"(",["T_VARIABLE","$temp_new",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getFileUri",145],"(",")",")",",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'New temp file was created correctly.'",145],")",";",["T_WHITESPACE","\n\n    ",145],["T_COMMENT","\/\/ Permanent file that is old.\n",147],["T_WHITESPACE","    ",148],["T_VARIABLE","$perm_old",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","file_save_data",148],"(",["T_CONSTANT_ENCAPSED_STRING","''",148],")",";",["T_WHITESPACE","\n    ",148],["T_STRING","db_update",149],"(",["T_CONSTANT_ENCAPSED_STRING","'file_managed'",149],")",["T_WHITESPACE","\n      ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","fields",150],"(",["T_ARRAY","array",150],"(",["T_CONSTANT_ENCAPSED_STRING","'changed'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_STRING","REQUEST_TIME",150],["T_WHITESPACE"," ",150],"-",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","config",150],"(",["T_CONSTANT_ENCAPSED_STRING","'system.file'",150],")",["T_OBJECT_OPERATOR","->",150],["T_STRING","get",150],"(",["T_CONSTANT_ENCAPSED_STRING","'temporary_maximum_age'",150],")",["T_WHITESPACE"," ",150],"-",["T_WHITESPACE"," ",150],["T_LNUMBER","1",150],")",")",["T_WHITESPACE","\n      ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","condition",151],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$temp_old",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","id",151],"(",")",")",["T_WHITESPACE","\n      ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","execute",152],"(",")",";",["T_WHITESPACE","\n    ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","assertTrue",153],"(",["T_STRING","file_exists",153],"(",["T_VARIABLE","$perm_old",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getFileUri",153],"(",")",")",",",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'Old permanent file was created correctly.'",153],")",";",["T_WHITESPACE","\n\n    ",153],["T_COMMENT","\/\/ Permanent file that is new.\n",155],["T_WHITESPACE","    ",156],["T_VARIABLE","$perm_new",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","file_save_data",156],"(",["T_CONSTANT_ENCAPSED_STRING","''",156],")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","assertTrue",157],"(",["T_STRING","file_exists",157],"(",["T_VARIABLE","$perm_new",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getFileUri",157],"(",")",")",",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'New permanent file was created correctly.'",157],")",";",["T_WHITESPACE","\n    ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_ARRAY","array",158],"(",["T_VARIABLE","$temp_old",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$temp_new",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$perm_old",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$perm_new",158],")",";",["T_WHITESPACE","\n  ",158],"}",["T_WHITESPACE","\n\n  ",159],["T_DOC_COMMENT","\/**\n   * Ensure that temporary files are removed by default.\n   *\/",161],["T_WHITESPACE","\n  ",163],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","testTempFileCleanupDefault",164],"(",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n    ",164],["T_LIST","list",165],"(",["T_VARIABLE","$temp_old",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$temp_new",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$perm_old",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$perm_new",165],")",["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","createTempFiles",165],"(",")",";",["T_WHITESPACE","\n\n    ",165],["T_COMMENT","\/\/ Run cron and then ensure that only the old, temp file was deleted.\n",167],["T_WHITESPACE","    ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","container",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","get",168],"(",["T_CONSTANT_ENCAPSED_STRING","'cron'",168],")",["T_OBJECT_OPERATOR","->",168],["T_STRING","run",168],"(",")",";",["T_WHITESPACE","\n    ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","assertFalse",169],"(",["T_STRING","file_exists",169],"(",["T_VARIABLE","$temp_old",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getFileUri",169],"(",")",")",",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'Old temp file was correctly removed.'",169],")",";",["T_WHITESPACE","\n    ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","assertTrue",170],"(",["T_STRING","file_exists",170],"(",["T_VARIABLE","$temp_new",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getFileUri",170],"(",")",")",",",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'New temp file was correctly ignored.'",170],")",";",["T_WHITESPACE","\n    ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","assertTrue",171],"(",["T_STRING","file_exists",171],"(",["T_VARIABLE","$perm_old",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getFileUri",171],"(",")",")",",",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'Old permanent file was correctly ignored.'",171],")",";",["T_WHITESPACE","\n    ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","assertTrue",172],"(",["T_STRING","file_exists",172],"(",["T_VARIABLE","$perm_new",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getFileUri",172],"(",")",")",",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'New permanent file was correctly ignored.'",172],")",";",["T_WHITESPACE","\n  ",172],"}",["T_WHITESPACE","\n\n  ",173],["T_DOC_COMMENT","\/**\n   * Ensure that temporary files are kept as configured.\n   *\/",175],["T_WHITESPACE","\n  ",177],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","testTempFileNoCleanup",178],"(",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n    ",178],["T_LIST","list",179],"(",["T_VARIABLE","$temp_old",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$temp_new",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$perm_old",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$perm_new",179],")",["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","createTempFiles",179],"(",")",";",["T_WHITESPACE","\n\n    ",179],["T_COMMENT","\/\/ Set the max age to 0, meaning no temporary files will be deleted.\n",181],["T_WHITESPACE","    ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","config",182],"(",["T_CONSTANT_ENCAPSED_STRING","'system.file'",182],")",["T_WHITESPACE","\n      ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","set",183],"(",["T_CONSTANT_ENCAPSED_STRING","'temporary_maximum_age'",183],",",["T_WHITESPACE"," ",183],["T_LNUMBER","0",183],")",["T_WHITESPACE","\n      ",183],["T_OBJECT_OPERATOR","->",184],["T_STRING","save",184],"(",")",";",["T_WHITESPACE","\n\n    ",184],["T_COMMENT","\/\/ Run cron and then ensure that no file was deleted.\n",186],["T_WHITESPACE","    ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","container",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","get",187],"(",["T_CONSTANT_ENCAPSED_STRING","'cron'",187],")",["T_OBJECT_OPERATOR","->",187],["T_STRING","run",187],"(",")",";",["T_WHITESPACE","\n    ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","assertTrue",188],"(",["T_STRING","file_exists",188],"(",["T_VARIABLE","$temp_old",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getFileUri",188],"(",")",")",",",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'Old temp file was correctly ignored.'",188],")",";",["T_WHITESPACE","\n    ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","assertTrue",189],"(",["T_STRING","file_exists",189],"(",["T_VARIABLE","$temp_new",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getFileUri",189],"(",")",")",",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'New temp file was correctly ignored.'",189],")",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","assertTrue",190],"(",["T_STRING","file_exists",190],"(",["T_VARIABLE","$perm_old",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getFileUri",190],"(",")",")",",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'Old permanent file was correctly ignored.'",190],")",";",["T_WHITESPACE","\n    ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","assertTrue",191],"(",["T_STRING","file_exists",191],"(",["T_VARIABLE","$perm_new",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getFileUri",191],"(",")",")",",",["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'New permanent file was correctly ignored.'",191],")",";",["T_WHITESPACE","\n  ",191],"}",["T_WHITESPACE","\n\n  ",192],["T_DOC_COMMENT","\/**\n   * Ensure that temporary files are kept as configured.\n   *\/",194],["T_WHITESPACE","\n  ",196],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","testTempFileCustomCleanup",197],"(",")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n    ",197],["T_LIST","list",198],"(",["T_VARIABLE","$temp_old",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$temp_new",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$perm_old",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$perm_new",198],")",["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","createTempFiles",198],"(",")",";",["T_WHITESPACE","\n\n    ",198],["T_COMMENT","\/\/ Set the max age to older than default.\n",200],["T_WHITESPACE","    ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","config",201],"(",["T_CONSTANT_ENCAPSED_STRING","'system.file'",201],")",["T_WHITESPACE","\n      ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","set",202],"(",["T_CONSTANT_ENCAPSED_STRING","'temporary_maximum_age'",202],",",["T_WHITESPACE"," ",202],["T_LNUMBER","21600",202],["T_WHITESPACE"," ",202],"+",["T_WHITESPACE"," ",202],["T_LNUMBER","2",202],")",["T_WHITESPACE","\n      ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","save",203],"(",")",";",["T_WHITESPACE","\n\n    ",203],["T_COMMENT","\/\/ Run cron and then ensure that more files were deleted.\n",205],["T_WHITESPACE","    ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","container",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","get",206],"(",["T_CONSTANT_ENCAPSED_STRING","'cron'",206],")",["T_OBJECT_OPERATOR","->",206],["T_STRING","run",206],"(",")",";",["T_WHITESPACE","\n    ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","assertTrue",207],"(",["T_STRING","file_exists",207],"(",["T_VARIABLE","$temp_old",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getFileUri",207],"(",")",")",",",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'Old temp file was correctly ignored.'",207],")",";",["T_WHITESPACE","\n    ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","assertTrue",208],"(",["T_STRING","file_exists",208],"(",["T_VARIABLE","$temp_new",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getFileUri",208],"(",")",")",",",["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'New temp file was correctly ignored.'",208],")",";",["T_WHITESPACE","\n    ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","assertTrue",209],"(",["T_STRING","file_exists",209],"(",["T_VARIABLE","$perm_old",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getFileUri",209],"(",")",")",",",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'Old permanent file was correctly ignored.'",209],")",";",["T_WHITESPACE","\n    ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","assertTrue",210],"(",["T_STRING","file_exists",210],"(",["T_VARIABLE","$perm_new",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getFileUri",210],"(",")",")",",",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'New permanent file was correctly ignored.'",210],")",";",["T_WHITESPACE","\n  ",210],"}",["T_WHITESPACE","\n\n  ",211],["T_DOC_COMMENT","\/**\n   * Tests file usage with translated entities.\n   *\/",213],["T_WHITESPACE","\n  ",215],["T_PUBLIC","public",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","testFileUsageWithEntityTranslation",216],"(",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n    ",216],["T_DOC_COMMENT","\/** @var \\Drupal\\file\\FileUsage\\FileUsageInterface $file_usage *\/",217],["T_WHITESPACE","\n    ",217],["T_VARIABLE","$file_usage",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","container",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","get",218],"(",["T_CONSTANT_ENCAPSED_STRING","'file.usage'",218],")",";",["T_WHITESPACE","\n\n    ",218],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","enableModules",220],"(","[",["T_CONSTANT_ENCAPSED_STRING","'node'",220],",",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'language'",220],"]",")",";",["T_WHITESPACE","\n    ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","installEntitySchema",221],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",221],")",";",["T_WHITESPACE","\n    ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","installSchema",222],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",222],",",["T_WHITESPACE"," ",222],"[",["T_CONSTANT_ENCAPSED_STRING","'node_access'",222],"]",")",";",["T_WHITESPACE","\n\n    ",222],["T_COMMENT","\/\/ Activate English and Romanian languages.\n",224],["T_WHITESPACE","    ",225],["T_STRING","ConfigurableLanguage",225],["T_DOUBLE_COLON","::",225],["T_STRING","create",225],"(","[",["T_CONSTANT_ENCAPSED_STRING","'id'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'en'",225],"]",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","save",225],"(",")",";",["T_WHITESPACE","\n    ",225],["T_STRING","ConfigurableLanguage",226],["T_DOUBLE_COLON","::",226],["T_STRING","create",226],"(","[",["T_CONSTANT_ENCAPSED_STRING","'id'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'ro'",226],"]",")",["T_OBJECT_OPERATOR","->",226],["T_STRING","save",226],"(",")",";",["T_WHITESPACE","\n\n    ",226],["T_STRING","NodeType",228],["T_DOUBLE_COLON","::",228],["T_STRING","create",228],"(","[",["T_CONSTANT_ENCAPSED_STRING","'type'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'page'",228],"]",")",["T_OBJECT_OPERATOR","->",228],["T_STRING","save",228],"(",")",";",["T_WHITESPACE","\n    ",228],["T_STRING","ContentLanguageSettings",229],["T_DOUBLE_COLON","::",229],["T_STRING","loadByEntityTypeBundle",229],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",229],",",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'page'",229],")",["T_WHITESPACE","\n      ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","setLanguageAlterable",230],"(",["T_STRING","FALSE",230],")",["T_WHITESPACE","\n      ",230],["T_OBJECT_OPERATOR","->",231],["T_STRING","setDefaultLangcode",231],"(",["T_CONSTANT_ENCAPSED_STRING","'en'",231],")",["T_WHITESPACE","\n      ",231],["T_OBJECT_OPERATOR","->",232],["T_STRING","save",232],"(",")",";",["T_WHITESPACE","\n    ",232],["T_COMMENT","\/\/ Create a file field attached to 'page' node-type.\n",233],["T_WHITESPACE","    ",234],["T_STRING","FieldStorageConfig",234],["T_DOUBLE_COLON","::",234],["T_STRING","create",234],"(","[",["T_WHITESPACE","\n      ",234],["T_CONSTANT_ENCAPSED_STRING","'type'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'file'",235],",",["T_WHITESPACE","\n      ",235],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'node'",236],",",["T_WHITESPACE","\n      ",236],["T_CONSTANT_ENCAPSED_STRING","'field_name'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'file'",237],",",["T_WHITESPACE","\n    ",237],"]",")",["T_OBJECT_OPERATOR","->",238],["T_STRING","save",238],"(",")",";",["T_WHITESPACE","\n    ",238],["T_STRING","FieldConfig",239],["T_DOUBLE_COLON","::",239],["T_STRING","create",239],"(","[",["T_WHITESPACE","\n      ",239],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_CONSTANT_ENCAPSED_STRING","'node'",240],",",["T_WHITESPACE","\n      ",240],["T_CONSTANT_ENCAPSED_STRING","'bundle'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'page'",241],",",["T_WHITESPACE","\n      ",241],["T_CONSTANT_ENCAPSED_STRING","'field_name'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'file'",242],",",["T_WHITESPACE","\n      ",242],["T_CONSTANT_ENCAPSED_STRING","'label'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'File'",243],",",["T_WHITESPACE","\n    ",243],"]",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","save",244],"(",")",";",["T_WHITESPACE","\n\n    ",244],["T_COMMENT","\/\/ Create a node, attach a file and add a Romanian translation.\n",246],["T_WHITESPACE","    ",247],["T_VARIABLE","$node",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","Node",247],["T_DOUBLE_COLON","::",247],["T_STRING","create",247],"(","[",["T_CONSTANT_ENCAPSED_STRING","'type'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'page'",247],",",["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'title'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'Page'",247],"]",")",";",["T_WHITESPACE","\n    ",247],["T_VARIABLE","$node",248],["T_WHITESPACE","\n      ",248],["T_OBJECT_OPERATOR","->",249],["T_STRING","set",249],"(",["T_CONSTANT_ENCAPSED_STRING","'file'",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$file",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","createFile",249],"(",")",")",["T_WHITESPACE","\n      ",249],["T_OBJECT_OPERATOR","->",250],["T_STRING","addTranslation",250],"(",["T_CONSTANT_ENCAPSED_STRING","'ro'",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$node",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getTranslation",250],"(",["T_CONSTANT_ENCAPSED_STRING","'en'",250],")",["T_OBJECT_OPERATOR","->",250],["T_STRING","toArray",250],"(",")",")",["T_WHITESPACE","\n      ",250],["T_OBJECT_OPERATOR","->",251],["T_STRING","save",251],"(",")",";",["T_WHITESPACE","\n\n    ",251],["T_COMMENT","\/\/ Check that the file is used twice.\n",253],["T_WHITESPACE","    ",254],["T_VARIABLE","$usage",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$file_usage",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","listUsage",254],"(",["T_VARIABLE","$file",254],")",";",["T_WHITESPACE","\n    ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","assertEquals",255],"(",["T_LNUMBER","2",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$usage",255],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",255],"]","[",["T_CONSTANT_ENCAPSED_STRING","'node'",255],"]","[",["T_VARIABLE","$node",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","id",255],"(",")","]",")",";",["T_WHITESPACE","\n\n    ",255],["T_COMMENT","\/\/ Remove the Romanian translation.\n",257],["T_WHITESPACE","    ",258],["T_VARIABLE","$node",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","removeTranslation",258],"(",["T_CONSTANT_ENCAPSED_STRING","'ro'",258],")",";",["T_WHITESPACE","\n    ",258],["T_VARIABLE","$node",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","save",259],"(",")",";",["T_WHITESPACE","\n\n    ",259],["T_COMMENT","\/\/ Check that one usage has been removed and is used only once now.\n",261],["T_WHITESPACE","    ",262],["T_VARIABLE","$usage",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$file_usage",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","listUsage",262],"(",["T_VARIABLE","$file",262],")",";",["T_WHITESPACE","\n    ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","assertEquals",263],"(",["T_LNUMBER","1",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$usage",263],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",263],"]","[",["T_CONSTANT_ENCAPSED_STRING","'node'",263],"]","[",["T_VARIABLE","$node",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","id",263],"(",")","]",")",";",["T_WHITESPACE","\n  ",263],"}",["T_WHITESPACE","\n\n",264],"}",["T_WHITESPACE","\n",266]]