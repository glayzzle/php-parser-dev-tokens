[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","file",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","file",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","File",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests the file move function.\n *\n * @group file\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","MoveTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","FileManagedUnitTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n  ",12],["T_DOC_COMMENT","\/**\n   * Move a normal file.\n   *\/",13],["T_WHITESPACE","\n  ",15],["T_FUNCTION","function",16],["T_WHITESPACE"," ",16],["T_STRING","testNormal",16],"(",")",["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n    ",16],["T_VARIABLE","$contents",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","randomMachineName",17],"(",["T_LNUMBER","10",17],")",";",["T_WHITESPACE","\n    ",17],["T_VARIABLE","$source",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","createFile",18],"(",["T_STRING","NULL",18],",",["T_WHITESPACE"," ",18],["T_VARIABLE","$contents",18],")",";",["T_WHITESPACE","\n    ",18],["T_VARIABLE","$desired_filepath",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/'",19],["T_WHITESPACE"," ",19],".",["T_WHITESPACE"," ",19],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","randomMachineName",19],"(",")",";",["T_WHITESPACE","\n\n    ",19],["T_COMMENT","\/\/ Clone the object so we don't have to worry about the function changing\n",21],["T_WHITESPACE","    ",22],["T_COMMENT","\/\/ our reference copy.\n",22],["T_WHITESPACE","    ",23],["T_VARIABLE","$result",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_STRING","file_move",23],"(",["T_CLONE","clone",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$source",23],",",["T_WHITESPACE"," ",23],["T_VARIABLE","$desired_filepath",23],",",["T_WHITESPACE"," ",23],["T_STRING","FILE_EXISTS_ERROR",23],")",";",["T_WHITESPACE","\n\n    ",23],["T_COMMENT","\/\/ Check the return status and that the contents changed.\n",25],["T_WHITESPACE","    ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","assertTrue",26],"(",["T_VARIABLE","$result",26],",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'File moved successfully.'",26],")",";",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","assertFalse",27],"(",["T_STRING","file_exists",27],"(",["T_VARIABLE","$source",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","getFileUri",27],"(",")",")",")",";",["T_WHITESPACE","\n    ",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","assertEqual",28],"(",["T_VARIABLE","$contents",28],",",["T_WHITESPACE"," ",28],["T_STRING","file_get_contents",28],"(",["T_VARIABLE","$result",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","getFileUri",28],"(",")",")",",",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'Contents of file correctly written.'",28],")",";",["T_WHITESPACE","\n\n    ",28],["T_COMMENT","\/\/ Check that the correct hooks were called.\n",30],["T_WHITESPACE","    ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","assertFileHooksCalled",31],"(",["T_ARRAY","array",31],"(",["T_CONSTANT_ENCAPSED_STRING","'move'",31],",",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'load'",31],",",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'update'",31],")",")",";",["T_WHITESPACE","\n\n    ",31],["T_COMMENT","\/\/ Make sure we got the same file back.\n",33],["T_WHITESPACE","    ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","assertEqual",34],"(",["T_VARIABLE","$source",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","id",34],"(",")",",",["T_WHITESPACE"," ",34],["T_VARIABLE","$result",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","id",34],"(",")",",",["T_WHITESPACE"," ",34],["T_STRING","format_string",34],"(",["T_CONSTANT_ENCAPSED_STRING","\"Source file id's' %fid is unchanged after move.\"",34],",",["T_WHITESPACE"," ",34],["T_ARRAY","array",34],"(",["T_CONSTANT_ENCAPSED_STRING","'%fid'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$source",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","id",34],"(",")",")",")",")",";",["T_WHITESPACE","\n\n    ",34],["T_COMMENT","\/\/ Reload the file from the database and check that the changes were\n",36],["T_WHITESPACE","    ",37],["T_COMMENT","\/\/ actually saved.\n",37],["T_WHITESPACE","    ",38],["T_VARIABLE","$loaded_file",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","File",38],["T_DOUBLE_COLON","::",38],["T_STRING","load",38],"(",["T_VARIABLE","$result",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","id",38],"(",")",")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","assertTrue",39],"(",["T_VARIABLE","$loaded_file",39],",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'File can be loaded from the database.'",39],")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","assertFileUnchanged",40],"(",["T_VARIABLE","$result",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$loaded_file",40],")",";",["T_WHITESPACE","\n  ",40],"}",["T_WHITESPACE","\n\n  ",41],["T_DOC_COMMENT","\/**\n   * Test renaming when moving onto a file that already exists.\n   *\/",43],["T_WHITESPACE","\n  ",45],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","testExistingRename",46],"(",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n    ",46],["T_COMMENT","\/\/ Setup a file to overwrite.\n",47],["T_WHITESPACE","    ",48],["T_VARIABLE","$contents",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","randomMachineName",48],"(",["T_LNUMBER","10",48],")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$source",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","createFile",49],"(",["T_STRING","NULL",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$contents",49],")",";",["T_WHITESPACE","\n    ",49],["T_VARIABLE","$target",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","createFile",50],"(",")",";",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","assertDifferentFile",51],"(",["T_VARIABLE","$source",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$target",51],")",";",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Clone the object so we don't have to worry about the function changing\n",53],["T_WHITESPACE","    ",54],["T_COMMENT","\/\/ our reference copy.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$result",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","file_move",55],"(",["T_CLONE","clone",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$source",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$target",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getFileUri",55],"(",")",",",["T_WHITESPACE"," ",55],["T_STRING","FILE_EXISTS_RENAME",55],")",";",["T_WHITESPACE","\n\n    ",55],["T_COMMENT","\/\/ Check the return status and that the contents changed.\n",57],["T_WHITESPACE","    ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertTrue",58],"(",["T_VARIABLE","$result",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'File moved successfully.'",58],")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertFalse",59],"(",["T_STRING","file_exists",59],"(",["T_VARIABLE","$source",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getFileUri",59],"(",")",")",")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertEqual",60],"(",["T_VARIABLE","$contents",60],",",["T_WHITESPACE"," ",60],["T_STRING","file_get_contents",60],"(",["T_VARIABLE","$result",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getFileUri",60],"(",")",")",",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'Contents of file correctly written.'",60],")",";",["T_WHITESPACE","\n\n    ",60],["T_COMMENT","\/\/ Check that the correct hooks were called.\n",62],["T_WHITESPACE","    ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertFileHooksCalled",63],"(",["T_ARRAY","array",63],"(",["T_CONSTANT_ENCAPSED_STRING","'move'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'load'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'update'",63],")",")",";",["T_WHITESPACE","\n\n    ",63],["T_COMMENT","\/\/ Compare the returned value to what made it into the database.\n",65],["T_WHITESPACE","    ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertFileUnchanged",66],"(",["T_VARIABLE","$result",66],",",["T_WHITESPACE"," ",66],["T_STRING","File",66],["T_DOUBLE_COLON","::",66],["T_STRING","load",66],"(",["T_VARIABLE","$result",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","id",66],"(",")",")",")",";",["T_WHITESPACE","\n    ",66],["T_COMMENT","\/\/ The target file should not have been altered.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","assertFileUnchanged",68],"(",["T_VARIABLE","$target",68],",",["T_WHITESPACE"," ",68],["T_STRING","File",68],["T_DOUBLE_COLON","::",68],["T_STRING","load",68],"(",["T_VARIABLE","$target",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","id",68],"(",")",")",")",";",["T_WHITESPACE","\n    ",68],["T_COMMENT","\/\/ Make sure we end up with two distinct files afterwards.\n",69],["T_WHITESPACE","    ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertDifferentFile",70],"(",["T_VARIABLE","$target",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$result",70],")",";",["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/\/ Compare the source and results.\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$loaded_source",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","File",73],["T_DOUBLE_COLON","::",73],["T_STRING","load",73],"(",["T_VARIABLE","$source",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","id",73],"(",")",")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","assertEqual",74],"(",["T_VARIABLE","$loaded_source",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","id",74],"(",")",",",["T_WHITESPACE"," ",74],["T_VARIABLE","$result",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","id",74],"(",")",",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","\"Returned file's id matches the source.\"",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertNotEqual",75],"(",["T_VARIABLE","$loaded_source",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getFileUri",75],"(",")",",",["T_WHITESPACE"," ",75],["T_VARIABLE","$source",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getFileUri",75],"(",")",",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'Returned file path has changed from the original.'",75],")",";",["T_WHITESPACE","\n  ",75],"}",["T_WHITESPACE","\n\n  ",76],["T_DOC_COMMENT","\/**\n   * Test replacement when moving onto a file that already exists.\n   *\/",78],["T_WHITESPACE","\n  ",80],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","testExistingReplace",81],"(",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n    ",81],["T_COMMENT","\/\/ Setup a file to overwrite.\n",82],["T_WHITESPACE","    ",83],["T_VARIABLE","$contents",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","randomMachineName",83],"(",["T_LNUMBER","10",83],")",";",["T_WHITESPACE","\n    ",83],["T_VARIABLE","$source",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","createFile",84],"(",["T_STRING","NULL",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$contents",84],")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$target",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","createFile",85],"(",")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertDifferentFile",86],"(",["T_VARIABLE","$source",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$target",86],")",";",["T_WHITESPACE","\n\n    ",86],["T_COMMENT","\/\/ Clone the object so we don't have to worry about the function changing\n",88],["T_WHITESPACE","    ",89],["T_COMMENT","\/\/ our reference copy.\n",89],["T_WHITESPACE","    ",90],["T_VARIABLE","$result",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","file_move",90],"(",["T_CLONE","clone",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$source",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$target",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getFileUri",90],"(",")",",",["T_WHITESPACE"," ",90],["T_STRING","FILE_EXISTS_REPLACE",90],")",";",["T_WHITESPACE","\n\n    ",90],["T_COMMENT","\/\/ Look at the results.\n",92],["T_WHITESPACE","    ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertEqual",93],"(",["T_VARIABLE","$contents",93],",",["T_WHITESPACE"," ",93],["T_STRING","file_get_contents",93],"(",["T_VARIABLE","$result",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getFileUri",93],"(",")",")",",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'Contents of file were overwritten.'",93],")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertFalse",94],"(",["T_STRING","file_exists",94],"(",["T_VARIABLE","$source",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getFileUri",94],"(",")",")",")",";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertTrue",95],"(",["T_VARIABLE","$result",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'File moved successfully.'",95],")",";",["T_WHITESPACE","\n\n    ",95],["T_COMMENT","\/\/ Check that the correct hooks were called.\n",97],["T_WHITESPACE","    ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","assertFileHooksCalled",98],"(",["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'move'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'update'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'delete'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'load'",98],")",")",";",["T_WHITESPACE","\n\n    ",98],["T_COMMENT","\/\/ Reload the file from the database and check that the changes were\n",100],["T_WHITESPACE","    ",101],["T_COMMENT","\/\/ actually saved.\n",101],["T_WHITESPACE","    ",102],["T_VARIABLE","$loaded_result",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","File",102],["T_DOUBLE_COLON","::",102],["T_STRING","load",102],"(",["T_VARIABLE","$result",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","id",102],"(",")",")",";",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertFileUnchanged",103],"(",["T_VARIABLE","$result",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$loaded_result",103],")",";",["T_WHITESPACE","\n    ",103],["T_COMMENT","\/\/ Check that target was re-used.\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","assertSameFile",105],"(",["T_VARIABLE","$target",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$loaded_result",105],")",";",["T_WHITESPACE","\n    ",105],["T_COMMENT","\/\/ Source and result should be totally different.\n",106],["T_WHITESPACE","    ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","assertDifferentFile",107],"(",["T_VARIABLE","$source",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$loaded_result",107],")",";",["T_WHITESPACE","\n  ",107],"}",["T_WHITESPACE","\n\n  ",108],["T_DOC_COMMENT","\/**\n   * Test replacement when moving onto itself.\n   *\/",110],["T_WHITESPACE","\n  ",112],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","testExistingReplaceSelf",113],"(",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n    ",113],["T_COMMENT","\/\/ Setup a file to overwrite.\n",114],["T_WHITESPACE","    ",115],["T_VARIABLE","$contents",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","randomMachineName",115],"(",["T_LNUMBER","10",115],")",";",["T_WHITESPACE","\n    ",115],["T_VARIABLE","$source",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","createFile",116],"(",["T_STRING","NULL",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$contents",116],")",";",["T_WHITESPACE","\n\n    ",116],["T_COMMENT","\/\/ Copy the file over itself. Clone the object so we don't have to worry\n",118],["T_WHITESPACE","    ",119],["T_COMMENT","\/\/ about the function changing our reference copy.\n",119],["T_WHITESPACE","    ",120],["T_VARIABLE","$result",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","file_move",120],"(",["T_CLONE","clone",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$source",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$source",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getFileUri",120],"(",")",",",["T_WHITESPACE"," ",120],["T_STRING","FILE_EXISTS_REPLACE",120],")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","assertFalse",121],"(",["T_VARIABLE","$result",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'File move failed.'",121],")",";",["T_WHITESPACE","\n    ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","assertEqual",122],"(",["T_VARIABLE","$contents",122],",",["T_WHITESPACE"," ",122],["T_STRING","file_get_contents",122],"(",["T_VARIABLE","$source",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getFileUri",122],"(",")",")",",",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'Contents of file were not altered.'",122],")",";",["T_WHITESPACE","\n\n    ",122],["T_COMMENT","\/\/ Check that no hooks were called while failing.\n",124],["T_WHITESPACE","    ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","assertFileHooksCalled",125],"(",["T_ARRAY","array",125],"(",")",")",";",["T_WHITESPACE","\n\n    ",125],["T_COMMENT","\/\/ Load the file from the database and make sure it is identical to what\n",127],["T_WHITESPACE","    ",128],["T_COMMENT","\/\/ was returned.\n",128],["T_WHITESPACE","    ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","assertFileUnchanged",129],"(",["T_VARIABLE","$source",129],",",["T_WHITESPACE"," ",129],["T_STRING","File",129],["T_DOUBLE_COLON","::",129],["T_STRING","load",129],"(",["T_VARIABLE","$source",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","id",129],"(",")",")",")",";",["T_WHITESPACE","\n  ",129],"}",["T_WHITESPACE","\n\n  ",130],["T_DOC_COMMENT","\/**\n   * Test that moving onto an existing file fails when FILE_EXISTS_ERROR is\n   * specified.\n   *\/",132],["T_WHITESPACE","\n  ",135],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","testExistingError",136],"(",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n    ",136],["T_VARIABLE","$contents",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","randomMachineName",137],"(",["T_LNUMBER","10",137],")",";",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$source",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","createFile",138],"(",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$target",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","createFile",139],"(",["T_STRING","NULL",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$contents",139],")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","assertDifferentFile",140],"(",["T_VARIABLE","$source",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$target",140],")",";",["T_WHITESPACE","\n\n    ",140],["T_COMMENT","\/\/ Clone the object so we don't have to worry about the function changing\n",142],["T_WHITESPACE","    ",143],["T_COMMENT","\/\/ our reference copy.\n",143],["T_WHITESPACE","    ",144],["T_VARIABLE","$result",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","file_move",144],"(",["T_CLONE","clone",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$source",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$target",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getFileUri",144],"(",")",",",["T_WHITESPACE"," ",144],["T_STRING","FILE_EXISTS_ERROR",144],")",";",["T_WHITESPACE","\n\n    ",144],["T_COMMENT","\/\/ Check the return status and that the contents did not change.\n",146],["T_WHITESPACE","    ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","assertFalse",147],"(",["T_VARIABLE","$result",147],",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'File move failed.'",147],")",";",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","assertTrue",148],"(",["T_STRING","file_exists",148],"(",["T_VARIABLE","$source",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getFileUri",148],"(",")",")",")",";",["T_WHITESPACE","\n    ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","assertEqual",149],"(",["T_VARIABLE","$contents",149],",",["T_WHITESPACE"," ",149],["T_STRING","file_get_contents",149],"(",["T_VARIABLE","$target",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getFileUri",149],"(",")",")",",",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'Contents of file were not altered.'",149],")",";",["T_WHITESPACE","\n\n    ",149],["T_COMMENT","\/\/ Check that no hooks were called while failing.\n",151],["T_WHITESPACE","    ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","assertFileHooksCalled",152],"(",["T_ARRAY","array",152],"(",")",")",";",["T_WHITESPACE","\n\n    ",152],["T_COMMENT","\/\/ Load the file from the database and make sure it is identical to what\n",154],["T_WHITESPACE","    ",155],["T_COMMENT","\/\/ was returned.\n",155],["T_WHITESPACE","    ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","assertFileUnchanged",156],"(",["T_VARIABLE","$source",156],",",["T_WHITESPACE"," ",156],["T_STRING","File",156],["T_DOUBLE_COLON","::",156],["T_STRING","load",156],"(",["T_VARIABLE","$source",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","id",156],"(",")",")",")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","assertFileUnchanged",157],"(",["T_VARIABLE","$target",157],",",["T_WHITESPACE"," ",157],["T_STRING","File",157],["T_DOUBLE_COLON","::",157],["T_STRING","load",157],"(",["T_VARIABLE","$target",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","id",157],"(",")",")",")",";",["T_WHITESPACE","\n  ",157],"}",["T_WHITESPACE","\n\n",158],"}",["T_WHITESPACE","\n",160]]