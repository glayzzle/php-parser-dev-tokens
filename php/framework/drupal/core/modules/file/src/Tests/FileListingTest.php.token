[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","file",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","node",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Node",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","file",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","File",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","entity_test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityTestConstraints",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Tests file listing page functionality.\n *\n * @group file\n *\/",9],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","FileListingTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_STRING","FileFieldTestBase",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",16],["T_WHITESPACE","\n  ",20],["T_PUBLIC","public",21],["T_WHITESPACE"," ",21],["T_STATIC","static",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$modules",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_ARRAY","array",21],"(",["T_CONSTANT_ENCAPSED_STRING","'views'",21],",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'file'",21],",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'image'",21],",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",21],")",";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * An authenticated user.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$baseUser",28],";",["T_WHITESPACE","\n\n  ",28],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","setUp",30],"(",")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n    ",30],["T_STRING","parent",31],["T_DOUBLE_COLON","::",31],["T_STRING","setUp",31],"(",")",";",["T_WHITESPACE","\n\n    ",31],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","adminUser",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","drupalCreateUser",33],"(",["T_ARRAY","array",33],"(",["T_CONSTANT_ENCAPSED_STRING","'access files overview'",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'bypass node access'",33],")",")",";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","baseUser",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","drupalCreateUser",34],"(",")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","createFileField",35],"(",["T_CONSTANT_ENCAPSED_STRING","'file'",35],",",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'node'",35],",",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'article'",35],",",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",")",",",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'txt png'",35],")",")",";",["T_WHITESPACE","\n  ",35],"}",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * Calculates total count of usages for a file.\n   *\n   * @param $usage array\n   *   Array of file usage information as returned from file_usage subsystem.\n   * @return int\n   *   Total usage count.\n   *\/",38],["T_WHITESPACE","\n  ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","sumUsages",46],"(",["T_VARIABLE","$usage",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$count",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_LNUMBER","0",47],";",["T_WHITESPACE","\n    ",47],["T_FOREACH","foreach",48],["T_WHITESPACE"," ",48],"(",["T_VARIABLE","$usage",48],["T_WHITESPACE"," ",48],["T_AS","as",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$module",48],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n      ",48],["T_FOREACH","foreach",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$module",49],["T_WHITESPACE"," ",49],["T_AS","as",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$entity_type",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n        ",49],["T_FOREACH","foreach",50],["T_WHITESPACE"," ",50],"(",["T_VARIABLE","$entity_type",50],["T_WHITESPACE"," ",50],["T_AS","as",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$entity",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n          ",50],["T_VARIABLE","$count",51],["T_WHITESPACE"," ",51],["T_PLUS_EQUAL","+=",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$entity",51],";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n      ",52],"}",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$count",56],";",["T_WHITESPACE","\n  ",56],"}",["T_WHITESPACE","\n\n  ",57],["T_DOC_COMMENT","\/**\n   * Tests file overview with different user permissions.\n   *\/",59],["T_WHITESPACE","\n  ",61],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","testFileListingPages",62],"(",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$file_usage",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","container",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","get",63],"(",["T_CONSTANT_ENCAPSED_STRING","'file.usage'",63],")",";",["T_WHITESPACE","\n    ",63],["T_COMMENT","\/\/ Users without sufficient permissions should not see file listing.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","drupalLogin",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","baseUser",65],")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","drupalGet",66],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files'",66],")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertResponse",67],"(",["T_LNUMBER","403",67],")",";",["T_WHITESPACE","\n\n    ",67],["T_COMMENT","\/\/ Log in with user with right permissions and test listing.\n",69],["T_WHITESPACE","    ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","drupalLogin",70],"(",["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","adminUser",70],")",";",["T_WHITESPACE","\n\n    ",70],["T_FOR","for",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$i",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_LNUMBER","0",72],";",["T_WHITESPACE"," ",72],["T_VARIABLE","$i",72],["T_WHITESPACE"," ",72],"<",["T_WHITESPACE"," ",72],["T_LNUMBER","5",72],";",["T_WHITESPACE"," ",72],["T_VARIABLE","$i",72],["T_INC","++",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n      ",72],["T_VARIABLE","$nodes",73],"[","]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","drupalCreateNode",73],"(",["T_ARRAY","array",73],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'article'",73],")",")",";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","drupalGet",76],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files'",76],")",";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertResponse",77],"(",["T_LNUMBER","200",77],")",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertText",78],"(",["T_CONSTANT_ENCAPSED_STRING","'No files available.'",78],")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","drupalGet",79],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files'",79],")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","assertResponse",80],"(",["T_LNUMBER","200",80],")",";",["T_WHITESPACE","\n\n    ",80],["T_COMMENT","\/\/ Create a file with no usage.\n",82],["T_WHITESPACE","    ",83],["T_VARIABLE","$file",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","createFile",83],"(",")",";",["T_WHITESPACE","\n\n    ",83],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","drupalGet",85],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files\/usage\/'",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_VARIABLE","$file",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","id",85],"(",")",")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertResponse",86],"(",["T_LNUMBER","200",86],")",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertTitle",87],"(",["T_STRING","t",87],"(",["T_CONSTANT_ENCAPSED_STRING","'File usage information for @file | Drupal'",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'@file'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$file",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getFilename",87],"(",")",")",")",")",";",["T_WHITESPACE","\n\n    ",87],["T_FOREACH","foreach",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$nodes",89],["T_WHITESPACE"," ",89],["T_AS","as",89],["T_WHITESPACE"," ",89],"&",["T_VARIABLE","$node",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n      ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","drupalGet",90],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",90],["T_WHITESPACE"," ",90],".",["T_WHITESPACE"," ",90],["T_VARIABLE","$node",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","id",90],"(",")",["T_WHITESPACE"," ",90],".",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",90],")",";",["T_WHITESPACE","\n      ",90],["T_VARIABLE","$file",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getTestFile",91],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",91],")",";",["T_WHITESPACE","\n\n      ",91],["T_VARIABLE","$edit",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",["T_WHITESPACE","\n        ",93],["T_CONSTANT_ENCAPSED_STRING","'files[file_0]'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_STRING","drupal_realpath",94],"(",["T_VARIABLE","$file",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getFileUri",94],"(",")",")",",",["T_WHITESPACE","\n      ",94],")",";",["T_WHITESPACE","\n      ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","drupalPostForm",96],"(",["T_STRING","NULL",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$edit",96],",",["T_WHITESPACE"," ",96],["T_STRING","t",96],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",96],")",")",";",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$node",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","Node",97],["T_DOUBLE_COLON","::",97],["T_STRING","load",97],"(",["T_VARIABLE","$node",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","id",97],"(",")",")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","drupalGet",100],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files'",100],")",";",["T_WHITESPACE","\n\n    ",100],["T_FOREACH","foreach",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$nodes",102],["T_WHITESPACE"," ",102],["T_AS","as",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$node",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n      ",102],["T_VARIABLE","$file",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","File",103],["T_DOUBLE_COLON","::",103],["T_STRING","load",103],"(",["T_VARIABLE","$node",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","file",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","target_id",103],")",";",["T_WHITESPACE","\n      ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","assertText",104],"(",["T_VARIABLE","$file",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getFilename",104],"(",")",")",";",["T_WHITESPACE","\n      ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","assertLinkByHref",105],"(",["T_STRING","file_create_url",105],"(",["T_VARIABLE","$file",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getFileUri",105],"(",")",")",")",";",["T_WHITESPACE","\n      ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertLinkByHref",106],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files\/usage\/'",106],["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_VARIABLE","$file",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","id",106],"(",")",")",";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertFalse",108],"(",["T_STRING","preg_match",108],"(",["T_CONSTANT_ENCAPSED_STRING","'\/views-field-status priority-low\\\">\\s*'",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_STRING","t",108],"(",["T_CONSTANT_ENCAPSED_STRING","'Temporary'",108],")",["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'\/'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getRawContent",108],"(",")",")",",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'All files are stored as permanent.'",108],")",";",["T_WHITESPACE","\n\n    ",108],["T_COMMENT","\/\/ Use one file two times and check usage information.\n",110],["T_WHITESPACE","    ",111],["T_VARIABLE","$orphaned_file",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$nodes",111],"[",["T_LNUMBER","1",111],"]",["T_OBJECT_OPERATOR","->",111],["T_STRING","file",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","target_id",111],";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$used_file",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$nodes",112],"[",["T_LNUMBER","0",112],"]",["T_OBJECT_OPERATOR","->",112],["T_STRING","file",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","target_id",112],";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$nodes",113],"[",["T_LNUMBER","1",113],"]",["T_OBJECT_OPERATOR","->",113],["T_STRING","file",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","target_id",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$used_file",113],";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$nodes",114],"[",["T_LNUMBER","1",114],"]",["T_OBJECT_OPERATOR","->",114],["T_STRING","save",114],"(",")",";",["T_WHITESPACE","\n\n    ",114],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","drupalGet",116],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files'",116],")",";",["T_WHITESPACE","\n    ",116],["T_VARIABLE","$file",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","File",117],["T_DOUBLE_COLON","::",117],["T_STRING","load",117],"(",["T_VARIABLE","$orphaned_file",117],")",";",["T_WHITESPACE","\n    ",117],["T_VARIABLE","$usage",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","sumUsages",118],"(",["T_VARIABLE","$file_usage",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","listUsage",118],"(",["T_VARIABLE","$file",118],")",")",";",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","assertRaw",119],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files\/usage\/'",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_VARIABLE","$file",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","id",119],"(",")",["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'\">'",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_VARIABLE","$usage",119],")",";",["T_WHITESPACE","\n\n    ",119],["T_VARIABLE","$file",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","File",121],["T_DOUBLE_COLON","::",121],["T_STRING","load",121],"(",["T_VARIABLE","$used_file",121],")",";",["T_WHITESPACE","\n    ",121],["T_VARIABLE","$usage",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","sumUsages",122],"(",["T_VARIABLE","$file_usage",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","listUsage",122],"(",["T_VARIABLE","$file",122],")",")",";",["T_WHITESPACE","\n    ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","assertRaw",123],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files\/usage\/'",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$file",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","id",123],"(",")",["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'\">'",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$usage",123],")",";",["T_WHITESPACE","\n\n    ",123],["T_VARIABLE","$result",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","xpath",125],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/\/td[contains(@class, 'views-field-status') and contains(text(), :value)]\"",125],",",["T_WHITESPACE"," ",125],["T_ARRAY","array",125],"(",["T_CONSTANT_ENCAPSED_STRING","':value'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_STRING","t",125],"(",["T_CONSTANT_ENCAPSED_STRING","'Temporary'",125],")",")",")",";",["T_WHITESPACE","\n    ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","assertEqual",126],"(",["T_LNUMBER","1",126],",",["T_WHITESPACE"," ",126],["T_STRING","count",126],"(",["T_VARIABLE","$result",126],")",",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'Unused file marked as temporary.'",126],")",";",["T_WHITESPACE","\n\n    ",126],["T_COMMENT","\/\/ Test file usage page.\n",128],["T_WHITESPACE","    ",129],["T_FOREACH","foreach",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$nodes",129],["T_WHITESPACE"," ",129],["T_AS","as",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$node",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n      ",129],["T_VARIABLE","$file",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","File",130],["T_DOUBLE_COLON","::",130],["T_STRING","load",130],"(",["T_VARIABLE","$node",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","file",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","target_id",130],")",";",["T_WHITESPACE","\n      ",130],["T_VARIABLE","$usage",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$file_usage",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","listUsage",131],"(",["T_VARIABLE","$file",131],")",";",["T_WHITESPACE","\n      ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","drupalGet",132],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files\/usage\/'",132],["T_WHITESPACE"," ",132],".",["T_WHITESPACE"," ",132],["T_VARIABLE","$file",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","id",132],"(",")",")",";",["T_WHITESPACE","\n      ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","assertResponse",133],"(",["T_LNUMBER","200",133],")",";",["T_WHITESPACE","\n      ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertText",134],"(",["T_VARIABLE","$node",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getTitle",134],"(",")",",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'Node title found on usage page.'",134],")",";",["T_WHITESPACE","\n      ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertText",135],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'Registering entity type found on usage page.'",135],")",";",["T_WHITESPACE","\n      ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertText",136],"(",["T_CONSTANT_ENCAPSED_STRING","'file'",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'Registering module found on usage page.'",136],")",";",["T_WHITESPACE","\n      ",136],["T_FOREACH","foreach",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$usage",137],["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$module",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n        ",137],["T_FOREACH","foreach",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$module",138],["T_WHITESPACE"," ",138],["T_AS","as",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$entity_type",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n          ",138],["T_FOREACH","foreach",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$entity_type",139],["T_WHITESPACE"," ",139],["T_AS","as",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$entity",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","assertText",140],"(",["T_VARIABLE","$entity",140],",",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'Usage count found on usage page.'",140],")",";",["T_WHITESPACE","\n          ",140],"}",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n      ",142],"}",["T_WHITESPACE","\n      ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","assertLinkByHref",144],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_VARIABLE","$node",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","id",144],"(",")",",",["T_WHITESPACE"," ",144],["T_LNUMBER","0",144],",",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'Link to registering entity found on usage page.'",144],")",";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n  ",145],"}",["T_WHITESPACE","\n\n  ",146],["T_DOC_COMMENT","\/**\n   * Tests file listing usage page for entities with no canonical link template.\n   *\/",148],["T_WHITESPACE","\n  ",150],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","testFileListingUsageNoLink",151],"(",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n    ",151],["T_COMMENT","\/\/ Login with user with right permissions and test listing.\n",152],["T_WHITESPACE","    ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","drupalLogin",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","adminUser",153],")",";",["T_WHITESPACE","\n\n    ",153],["T_COMMENT","\/\/ Create a bundle and attach a File field to the bundle.\n",155],["T_WHITESPACE","    ",156],["T_VARIABLE","$bundle",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","randomMachineName",156],"(",")",";",["T_WHITESPACE","\n    ",156],["T_STRING","entity_test_create_bundle",157],"(",["T_VARIABLE","$bundle",157],",",["T_WHITESPACE"," ",157],["T_STRING","NULL",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'entity_test_constraints'",157],")",";",["T_WHITESPACE","\n    ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","createFileField",158],"(",["T_CONSTANT_ENCAPSED_STRING","'field_test_file'",158],",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'entity_test_constraints'",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$bundle",158],",",["T_WHITESPACE"," ",158],["T_ARRAY","array",158],"(",")",",",["T_WHITESPACE"," ",158],["T_ARRAY","array",158],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'txt png'",158],")",")",";",["T_WHITESPACE","\n\n    ",158],["T_COMMENT","\/\/ Create file to attach to entity.\n",160],["T_WHITESPACE","    ",161],["T_VARIABLE","$file",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","File",161],["T_DOUBLE_COLON","::",161],["T_STRING","create",161],"(","[",["T_WHITESPACE","\n      ",161],["T_CONSTANT_ENCAPSED_STRING","'filename'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'druplicon.txt'",162],",",["T_WHITESPACE","\n      ",162],["T_CONSTANT_ENCAPSED_STRING","'uri'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/druplicon.txt'",163],",",["T_WHITESPACE","\n      ",163],["T_CONSTANT_ENCAPSED_STRING","'filemime'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",164],",",["T_WHITESPACE","\n    ",164],"]",")",";",["T_WHITESPACE","\n    ",165],["T_VARIABLE","$file",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","setPermanent",166],"(",")",";",["T_WHITESPACE","\n    ",166],["T_STRING","file_put_contents",167],"(",["T_VARIABLE","$file",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getFileUri",167],"(",")",",",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'hello world'",167],")",";",["T_WHITESPACE","\n    ",167],["T_VARIABLE","$file",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","save",168],"(",")",";",["T_WHITESPACE","\n\n    ",168],["T_COMMENT","\/\/ Create entity and attach the created file.\n",170],["T_WHITESPACE","    ",171],["T_VARIABLE","$entity_name",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","randomMachineName",171],"(",")",";",["T_WHITESPACE","\n    ",171],["T_VARIABLE","$entity",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","EntityTestConstraints",172],["T_DOUBLE_COLON","::",172],["T_STRING","create",172],"(",["T_ARRAY","array",172],"(",["T_WHITESPACE","\n      ",172],["T_CONSTANT_ENCAPSED_STRING","'uid'",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_LNUMBER","1",173],",",["T_WHITESPACE","\n      ",173],["T_CONSTANT_ENCAPSED_STRING","'name'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$entity_name",174],",",["T_WHITESPACE","\n      ",174],["T_CONSTANT_ENCAPSED_STRING","'type'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$bundle",175],",",["T_WHITESPACE","\n      ",175],["T_CONSTANT_ENCAPSED_STRING","'field_test_file'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_ARRAY","array",176],"(",["T_WHITESPACE","\n        ",176],["T_CONSTANT_ENCAPSED_STRING","'target_id'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$file",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","id",177],"(",")",",",["T_WHITESPACE","\n      ",177],")",",",["T_WHITESPACE","\n    ",178],")",")",";",["T_WHITESPACE","\n    ",179],["T_VARIABLE","$entity",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","save",180],"(",")",";",["T_WHITESPACE","\n\n    ",180],["T_COMMENT","\/\/ Create node entity and attach the created file.\n",182],["T_WHITESPACE","    ",183],["T_VARIABLE","$node",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","drupalCreateNode",183],"(",["T_ARRAY","array",183],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","'article'",183],",",["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","'file'",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$file",183],")",")",";",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$node",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","save",184],"(",")",";",["T_WHITESPACE","\n\n    ",184],["T_COMMENT","\/\/ Load the file usage page for the created and attached file.\n",186],["T_WHITESPACE","    ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","drupalGet",187],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content\/files\/usage\/'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$file",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","id",187],"(",")",")",";",["T_WHITESPACE","\n\n    ",187],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","assertResponse",189],"(",["T_LNUMBER","200",189],")",";",["T_WHITESPACE","\n    ",189],["T_COMMENT","\/\/ Entity name should be displayed, but not linked if Entity::toUrl\n",190],["T_WHITESPACE","    ",191],["T_COMMENT","\/\/ throws an exception\n",191],["T_WHITESPACE","    ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","assertText",192],"(",["T_VARIABLE","$entity_name",192],",",["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'Entity name is added to file usage listing.'",192],")",";",["T_WHITESPACE","\n    ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","assertNoLink",193],"(",["T_VARIABLE","$entity_name",193],",",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'Linked entity name not added to file usage listing.'",193],")",";",["T_WHITESPACE","\n    ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","assertLink",194],"(",["T_VARIABLE","$node",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getTitle",194],"(",")",")",";",["T_WHITESPACE","\n  ",194],"}",["T_WHITESPACE","\n\n  ",195],["T_DOC_COMMENT","\/**\n   * Creates and saves a test file.\n   *\n   * @return \\Drupal\\Core\\Entity\\EntityInterface\n   *   A file entity.\n   *\/",197],["T_WHITESPACE","\n  ",202],["T_PROTECTED","protected",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","createFile",203],"(",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n    ",203],["T_COMMENT","\/\/ Create a new file entity.\n",204],["T_WHITESPACE","    ",205],["T_VARIABLE","$file",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_STRING","File",205],["T_DOUBLE_COLON","::",205],["T_STRING","create",205],"(","[",["T_WHITESPACE","\n      ",205],["T_CONSTANT_ENCAPSED_STRING","'uid'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_LNUMBER","1",206],",",["T_WHITESPACE","\n      ",206],["T_CONSTANT_ENCAPSED_STRING","'filename'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'druplicon.txt'",207],",",["T_WHITESPACE","\n      ",207],["T_CONSTANT_ENCAPSED_STRING","'uri'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/druplicon.txt'",208],",",["T_WHITESPACE","\n      ",208],["T_CONSTANT_ENCAPSED_STRING","'filemime'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",209],",",["T_WHITESPACE","\n      ",209],["T_CONSTANT_ENCAPSED_STRING","'created'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_LNUMBER","1",210],",",["T_WHITESPACE","\n      ",210],["T_CONSTANT_ENCAPSED_STRING","'changed'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_LNUMBER","1",211],",",["T_WHITESPACE","\n      ",211],["T_CONSTANT_ENCAPSED_STRING","'status'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_STRING","FILE_STATUS_PERMANENT",212],",",["T_WHITESPACE","\n    ",212],"]",")",";",["T_WHITESPACE","\n    ",213],["T_STRING","file_put_contents",214],"(",["T_VARIABLE","$file",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getFileUri",214],"(",")",",",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'hello world'",214],")",";",["T_WHITESPACE","\n\n    ",214],["T_COMMENT","\/\/ Save it, inserting a new record.\n",216],["T_WHITESPACE","    ",217],["T_VARIABLE","$file",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","save",217],"(",")",";",["T_WHITESPACE","\n\n    ",217],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$file",219],";",["T_WHITESPACE","\n  ",219],"}",["T_WHITESPACE","\n\n",220],"}",["T_WHITESPACE","\n",222]]