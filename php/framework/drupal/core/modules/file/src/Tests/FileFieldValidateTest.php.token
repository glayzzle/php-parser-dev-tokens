[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","file",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Field",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FieldStorageDefinitionInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","field",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FieldConfig",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","file",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","File",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Tests validation functions such as file type, max file size, max size per\n * node, and required.\n *\n * @group file\n *\/",9],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","FileFieldValidateTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","FileFieldTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Tests the required property on file fields.\n   *\/",17],["T_WHITESPACE","\n  ",19],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],["T_STRING","testRequired",20],"(",")",["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n    ",20],["T_VARIABLE","$node_storage",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","container",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","get",21],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",21],")",["T_OBJECT_OPERATOR","->",21],["T_STRING","getStorage",21],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",21],")",";",["T_WHITESPACE","\n    ",21],["T_VARIABLE","$type_name",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'article'",22],";",["T_WHITESPACE","\n    ",22],["T_VARIABLE","$field_name",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_STRING","strtolower",23],"(",["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","randomMachineName",23],"(",")",")",";",["T_WHITESPACE","\n    ",23],["T_VARIABLE","$storage",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","createFileField",24],"(",["T_VARIABLE","$field_name",24],",",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'node'",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$type_name",24],",",["T_WHITESPACE"," ",24],["T_ARRAY","array",24],"(",")",",",["T_WHITESPACE"," ",24],["T_ARRAY","array",24],"(",["T_CONSTANT_ENCAPSED_STRING","'required'",24],["T_WHITESPACE"," ",24],["T_DOUBLE_ARROW","=>",24],["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'1'",24],")",")",";",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$field",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_STRING","FieldConfig",25],["T_DOUBLE_COLON","::",25],["T_STRING","loadByName",25],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$type_name",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$field_name",25],")",";",["T_WHITESPACE","\n\n    ",25],["T_VARIABLE","$test_file",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","getTestFile",27],"(",["T_CONSTANT_ENCAPSED_STRING","'text'",27],")",";",["T_WHITESPACE","\n\n    ",27],["T_COMMENT","\/\/ Try to post a new node without uploading a file.\n",29],["T_WHITESPACE","    ",30],["T_VARIABLE","$edit",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_ARRAY","array",30],"(",")",";",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$edit",31],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",31],"]",["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","randomMachineName",31],"(",")",";",["T_WHITESPACE","\n    ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","drupalPostForm",32],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/'",32],["T_WHITESPACE"," ",32],".",["T_WHITESPACE"," ",32],["T_VARIABLE","$type_name",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$edit",32],",",["T_WHITESPACE"," ",32],["T_STRING","t",32],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and publish'",32],")",")",";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","assertRaw",33],"(",["T_STRING","t",33],"(",["T_CONSTANT_ENCAPSED_STRING","'@title field is required.'",33],",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_CONSTANT_ENCAPSED_STRING","'@title'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$field",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","getLabel",33],"(",")",")",")",",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'Node save failed when required file field was empty.'",33],")",";",["T_WHITESPACE","\n\n    ",33],["T_COMMENT","\/\/ Create a new node with the uploaded file.\n",35],["T_WHITESPACE","    ",36],["T_VARIABLE","$nid",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","uploadNodeFile",36],"(",["T_VARIABLE","$test_file",36],",",["T_WHITESPACE"," ",36],["T_VARIABLE","$field_name",36],",",["T_WHITESPACE"," ",36],["T_VARIABLE","$type_name",36],")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","assertTrue",37],"(",["T_VARIABLE","$nid",37],["T_WHITESPACE"," ",37],["T_IS_NOT_IDENTICAL","!==",37],["T_WHITESPACE"," ",37],["T_STRING","FALSE",37],",",["T_WHITESPACE"," ",37],["T_STRING","format_string",37],"(",["T_CONSTANT_ENCAPSED_STRING","'uploadNodeFile(@test_file, @field_name, @type_name) succeeded'",37],",",["T_WHITESPACE"," ",37],["T_ARRAY","array",37],"(",["T_CONSTANT_ENCAPSED_STRING","'@test_file'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$test_file",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getFileUri",37],"(",")",",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'@field_name'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$field_name",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'@type_name'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$type_name",37],")",")",")",";",["T_WHITESPACE","\n\n    ",37],["T_VARIABLE","$node_storage",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","resetCache",39],"(",["T_ARRAY","array",39],"(",["T_VARIABLE","$nid",39],")",")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$node",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$node_storage",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","load",40],"(",["T_VARIABLE","$nid",40],")",";",["T_WHITESPACE","\n\n    ",40],["T_VARIABLE","$node_file",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","File",42],["T_DOUBLE_COLON","::",42],["T_STRING","load",42],"(",["T_VARIABLE","$node",42],["T_OBJECT_OPERATOR","->",42],"{",["T_VARIABLE","$field_name",42],"}",["T_OBJECT_OPERATOR","->",42],["T_STRING","target_id",42],")",";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","assertFileExists",43],"(",["T_VARIABLE","$node_file",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading to the required field.'",43],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","assertFileEntryExists",44],"(",["T_VARIABLE","$node_file",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading to the required field.'",44],")",";",["T_WHITESPACE","\n\n    ",44],["T_COMMENT","\/\/ Try again with a multiple value field.\n",46],["T_WHITESPACE","    ",47],["T_VARIABLE","$storage",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","delete",47],"(",")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","createFileField",48],"(",["T_VARIABLE","$field_name",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'node'",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$type_name",48],",",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_CONSTANT_ENCAPSED_STRING","'cardinality'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_STRING","FieldStorageDefinitionInterface",48],["T_DOUBLE_COLON","::",48],["T_STRING","CARDINALITY_UNLIMITED",48],")",",",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_CONSTANT_ENCAPSED_STRING","'required'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'1'",48],")",")",";",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/\/ Try to post a new node without uploading a file in the multivalue field.\n",50],["T_WHITESPACE","    ",51],["T_VARIABLE","$edit",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_ARRAY","array",51],"(",")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$edit",52],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",52],"]",["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","randomMachineName",52],"(",")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","drupalPostForm",53],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/'",53],["T_WHITESPACE"," ",53],".",["T_WHITESPACE"," ",53],["T_VARIABLE","$type_name",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$edit",53],",",["T_WHITESPACE"," ",53],["T_STRING","t",53],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and publish'",53],")",")",";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertRaw",54],"(",["T_STRING","t",54],"(",["T_CONSTANT_ENCAPSED_STRING","'@title field is required.'",54],",",["T_WHITESPACE"," ",54],["T_ARRAY","array",54],"(",["T_CONSTANT_ENCAPSED_STRING","'@title'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$field",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getLabel",54],"(",")",")",")",",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Node save failed when required multiple value file field was empty.'",54],")",";",["T_WHITESPACE","\n\n    ",54],["T_COMMENT","\/\/ Create a new node with the uploaded file into the multivalue field.\n",56],["T_WHITESPACE","    ",57],["T_VARIABLE","$nid",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","uploadNodeFile",57],"(",["T_VARIABLE","$test_file",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$field_name",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$type_name",57],")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$node_storage",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","resetCache",58],"(",["T_ARRAY","array",58],"(",["T_VARIABLE","$nid",58],")",")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$node",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$node_storage",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","load",59],"(",["T_VARIABLE","$nid",59],")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$node_file",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","File",60],["T_DOUBLE_COLON","::",60],["T_STRING","load",60],"(",["T_VARIABLE","$node",60],["T_OBJECT_OPERATOR","->",60],"{",["T_VARIABLE","$field_name",60],"}",["T_OBJECT_OPERATOR","->",60],["T_STRING","target_id",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertFileExists",61],"(",["T_VARIABLE","$node_file",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading to the required multiple value field.'",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertFileEntryExists",62],"(",["T_VARIABLE","$node_file",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading to the required multiple value field.'",62],")",";",["T_WHITESPACE","\n  ",62],"}",["T_WHITESPACE","\n\n  ",63],["T_DOC_COMMENT","\/**\n   * Tests the max file size validator.\n   *\/",65],["T_WHITESPACE","\n  ",67],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","testFileMaxSize",68],"(",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$node_storage",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","container",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","get",69],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",69],")",["T_OBJECT_OPERATOR","->",69],["T_STRING","getStorage",69],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$type_name",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'article'",70],";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$field_name",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","strtolower",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","randomMachineName",71],"(",")",")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","createFileField",72],"(",["T_VARIABLE","$field_name",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'node'",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$type_name",72],",",["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",")",",",["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'required'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'1'",72],")",")",";",["T_WHITESPACE","\n\n    ",72],["T_VARIABLE","$small_file",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getTestFile",74],"(",["T_CONSTANT_ENCAPSED_STRING","'text'",74],",",["T_WHITESPACE"," ",74],["T_LNUMBER","131072",74],")",";",["T_WHITESPACE"," ",74],["T_COMMENT","\/\/ 128KB.\n",74],["T_WHITESPACE","    ",75],["T_VARIABLE","$large_file",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getTestFile",75],"(",["T_CONSTANT_ENCAPSED_STRING","'text'",75],",",["T_WHITESPACE"," ",75],["T_LNUMBER","1310720",75],")",";",["T_WHITESPACE"," ",75],["T_COMMENT","\/\/ 1.2MB\n",75],["T_WHITESPACE","\n    ",76],["T_COMMENT","\/\/ Test uploading both a large and small file with different increments.\n",77],["T_WHITESPACE","    ",78],["T_VARIABLE","$sizes",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_ARRAY","array",78],"(",["T_WHITESPACE","\n      ",78],["T_CONSTANT_ENCAPSED_STRING","'1M'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_LNUMBER","1048576",79],",",["T_WHITESPACE","\n      ",79],["T_CONSTANT_ENCAPSED_STRING","'1024K'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_LNUMBER","1048576",80],",",["T_WHITESPACE","\n      ",80],["T_CONSTANT_ENCAPSED_STRING","'1048576'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_LNUMBER","1048576",81],",",["T_WHITESPACE","\n    ",81],")",";",["T_WHITESPACE","\n\n    ",82],["T_FOREACH","foreach",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$sizes",84],["T_WHITESPACE"," ",84],["T_AS","as",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$max_filesize",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$file_limit",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n      ",84],["T_COMMENT","\/\/ Set the max file upload size.\n",85],["T_WHITESPACE","      ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","updateFileField",86],"(",["T_VARIABLE","$field_name",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$type_name",86],",",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",["T_CONSTANT_ENCAPSED_STRING","'max_filesize'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$max_filesize",86],")",")",";",["T_WHITESPACE","\n\n      ",86],["T_COMMENT","\/\/ Create a new node with the small file, which should pass.\n",88],["T_WHITESPACE","      ",89],["T_VARIABLE","$nid",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","uploadNodeFile",89],"(",["T_VARIABLE","$small_file",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$field_name",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$type_name",89],")",";",["T_WHITESPACE","\n      ",89],["T_VARIABLE","$node_storage",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","resetCache",90],"(",["T_ARRAY","array",90],"(",["T_VARIABLE","$nid",90],")",")",";",["T_WHITESPACE","\n      ",90],["T_VARIABLE","$node",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$node_storage",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","load",91],"(",["T_VARIABLE","$nid",91],")",";",["T_WHITESPACE","\n      ",91],["T_VARIABLE","$node_file",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","File",92],["T_DOUBLE_COLON","::",92],["T_STRING","load",92],"(",["T_VARIABLE","$node",92],["T_OBJECT_OPERATOR","->",92],"{",["T_VARIABLE","$field_name",92],"}",["T_OBJECT_OPERATOR","->",92],["T_STRING","target_id",92],")",";",["T_WHITESPACE","\n      ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertFileExists",93],"(",["T_VARIABLE","$node_file",93],",",["T_WHITESPACE"," ",93],["T_STRING","format_string",93],"(",["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading a file (%filesize) under the max limit (%maxsize).'",93],",",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",["T_CONSTANT_ENCAPSED_STRING","'%filesize'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_STRING","format_size",93],"(",["T_VARIABLE","$small_file",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getSize",93],"(",")",")",",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'%maxsize'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$max_filesize",93],")",")",")",";",["T_WHITESPACE","\n      ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertFileEntryExists",94],"(",["T_VARIABLE","$node_file",94],",",["T_WHITESPACE"," ",94],["T_STRING","format_string",94],"(",["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading a file (%filesize) under the max limit (%maxsize).'",94],",",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_CONSTANT_ENCAPSED_STRING","'%filesize'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_STRING","format_size",94],"(",["T_VARIABLE","$small_file",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getSize",94],"(",")",")",",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'%maxsize'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$max_filesize",94],")",")",")",";",["T_WHITESPACE","\n\n      ",94],["T_COMMENT","\/\/ Check that uploading the large file fails (1M limit).\n",96],["T_WHITESPACE","      ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","uploadNodeFile",97],"(",["T_VARIABLE","$large_file",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$field_name",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$type_name",97],")",";",["T_WHITESPACE","\n      ",97],["T_VARIABLE","$error_message",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","t",98],"(",["T_CONSTANT_ENCAPSED_STRING","'The file is %filesize exceeding the maximum file size of %maxsize.'",98],",",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'%filesize'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_STRING","format_size",98],"(",["T_VARIABLE","$large_file",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getSize",98],"(",")",")",",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'%maxsize'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_STRING","format_size",98],"(",["T_VARIABLE","$file_limit",98],")",")",")",";",["T_WHITESPACE","\n      ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","assertRaw",99],"(",["T_VARIABLE","$error_message",99],",",["T_WHITESPACE"," ",99],["T_STRING","format_string",99],"(",["T_CONSTANT_ENCAPSED_STRING","'Node save failed when file (%filesize) exceeded the max upload size (%maxsize).'",99],",",["T_WHITESPACE"," ",99],["T_ARRAY","array",99],"(",["T_CONSTANT_ENCAPSED_STRING","'%filesize'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_STRING","format_size",99],"(",["T_VARIABLE","$large_file",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getSize",99],"(",")",")",",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'%maxsize'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$max_filesize",99],")",")",")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_COMMENT","\/\/ Turn off the max filesize.\n",102],["T_WHITESPACE","    ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","updateFileField",103],"(",["T_VARIABLE","$field_name",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$type_name",103],",",["T_WHITESPACE"," ",103],["T_ARRAY","array",103],"(",["T_CONSTANT_ENCAPSED_STRING","'max_filesize'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","''",103],")",")",";",["T_WHITESPACE","\n\n    ",103],["T_COMMENT","\/\/ Upload the big file successfully.\n",105],["T_WHITESPACE","    ",106],["T_VARIABLE","$nid",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","uploadNodeFile",106],"(",["T_VARIABLE","$large_file",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$field_name",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$type_name",106],")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$node_storage",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","resetCache",107],"(",["T_ARRAY","array",107],"(",["T_VARIABLE","$nid",107],")",")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$node",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$node_storage",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","load",108],"(",["T_VARIABLE","$nid",108],")",";",["T_WHITESPACE","\n    ",108],["T_VARIABLE","$node_file",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","File",109],["T_DOUBLE_COLON","::",109],["T_STRING","load",109],"(",["T_VARIABLE","$node",109],["T_OBJECT_OPERATOR","->",109],"{",["T_VARIABLE","$field_name",109],"}",["T_OBJECT_OPERATOR","->",109],["T_STRING","target_id",109],")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertFileExists",110],"(",["T_VARIABLE","$node_file",110],",",["T_WHITESPACE"," ",110],["T_STRING","format_string",110],"(",["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading a file (%filesize) with no max limit.'",110],",",["T_WHITESPACE"," ",110],["T_ARRAY","array",110],"(",["T_CONSTANT_ENCAPSED_STRING","'%filesize'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_STRING","format_size",110],"(",["T_VARIABLE","$large_file",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getSize",110],"(",")",")",")",")",")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","assertFileEntryExists",111],"(",["T_VARIABLE","$node_file",111],",",["T_WHITESPACE"," ",111],["T_STRING","format_string",111],"(",["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading a file (%filesize) with no max limit.'",111],",",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",["T_CONSTANT_ENCAPSED_STRING","'%filesize'",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_STRING","format_size",111],"(",["T_VARIABLE","$large_file",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getSize",111],"(",")",")",")",")",")",";",["T_WHITESPACE","\n  ",111],"}",["T_WHITESPACE","\n\n  ",112],["T_DOC_COMMENT","\/**\n   * Tests file extension checking.\n   *\/",114],["T_WHITESPACE","\n  ",116],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","testFileExtension",117],"(",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n    ",117],["T_VARIABLE","$node_storage",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","container",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","get",118],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",118],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","getStorage",118],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",118],")",";",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$type_name",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'article'",119],";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$field_name",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","strtolower",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","randomMachineName",120],"(",")",")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","createFileField",121],"(",["T_VARIABLE","$field_name",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'node'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$type_name",121],")",";",["T_WHITESPACE","\n\n    ",121],["T_VARIABLE","$test_file",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getTestFile",123],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",123],")",";",["T_WHITESPACE","\n    ",123],["T_LIST","list",124],"(",",",["T_WHITESPACE"," ",124],["T_VARIABLE","$test_file_extension",124],")",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","explode",124],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$test_file",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getFilename",124],"(",")",")",";",["T_WHITESPACE","\n\n    ",124],["T_COMMENT","\/\/ Disable extension checking.\n",126],["T_WHITESPACE","    ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","updateFileField",127],"(",["T_VARIABLE","$field_name",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$type_name",127],",",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","''",127],")",")",";",["T_WHITESPACE","\n\n    ",127],["T_COMMENT","\/\/ Check that the file can be uploaded with no extension checking.\n",129],["T_WHITESPACE","    ",130],["T_VARIABLE","$nid",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","uploadNodeFile",130],"(",["T_VARIABLE","$test_file",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$field_name",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$type_name",130],")",";",["T_WHITESPACE","\n    ",130],["T_VARIABLE","$node_storage",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","resetCache",131],"(",["T_ARRAY","array",131],"(",["T_VARIABLE","$nid",131],")",")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$node",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$node_storage",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","load",132],"(",["T_VARIABLE","$nid",132],")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$node_file",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","File",133],["T_DOUBLE_COLON","::",133],["T_STRING","load",133],"(",["T_VARIABLE","$node",133],["T_OBJECT_OPERATOR","->",133],"{",["T_VARIABLE","$field_name",133],"}",["T_OBJECT_OPERATOR","->",133],["T_STRING","target_id",133],")",";",["T_WHITESPACE","\n    ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertFileExists",134],"(",["T_VARIABLE","$node_file",134],",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading a file with no extension checking.'",134],")",";",["T_WHITESPACE","\n    ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertFileEntryExists",135],"(",["T_VARIABLE","$node_file",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading a file with no extension checking.'",135],")",";",["T_WHITESPACE","\n\n    ",135],["T_COMMENT","\/\/ Enable extension checking for text files.\n",137],["T_WHITESPACE","    ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","updateFileField",138],"(",["T_VARIABLE","$field_name",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$type_name",138],",",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'txt'",138],")",")",";",["T_WHITESPACE","\n\n    ",138],["T_COMMENT","\/\/ Check that the file with the wrong extension cannot be uploaded.\n",140],["T_WHITESPACE","    ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","uploadNodeFile",141],"(",["T_VARIABLE","$test_file",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$field_name",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$type_name",141],")",";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$error_message",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","t",142],"(",["T_CONSTANT_ENCAPSED_STRING","'Only files with the following extensions are allowed: %files-allowed.'",142],",",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_CONSTANT_ENCAPSED_STRING","'%files-allowed'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'txt'",142],")",")",";",["T_WHITESPACE","\n    ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","assertRaw",143],"(",["T_VARIABLE","$error_message",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'Node save failed when file uploaded with the wrong extension.'",143],")",";",["T_WHITESPACE","\n\n    ",143],["T_COMMENT","\/\/ Enable extension checking for text and image files.\n",145],["T_WHITESPACE","    ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","updateFileField",146],"(",["T_VARIABLE","$field_name",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$type_name",146],",",["T_WHITESPACE"," ",146],["T_ARRAY","array",146],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],"\"",["T_ENCAPSED_AND_WHITESPACE","txt ",146],["T_VARIABLE","$test_file_extension",146],"\"",")",")",";",["T_WHITESPACE","\n\n    ",146],["T_COMMENT","\/\/ Check that the file can be uploaded with extension checking.\n",148],["T_WHITESPACE","    ",149],["T_VARIABLE","$nid",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","uploadNodeFile",149],"(",["T_VARIABLE","$test_file",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$field_name",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$type_name",149],")",";",["T_WHITESPACE","\n    ",149],["T_VARIABLE","$node_storage",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","resetCache",150],"(",["T_ARRAY","array",150],"(",["T_VARIABLE","$nid",150],")",")",";",["T_WHITESPACE","\n    ",150],["T_VARIABLE","$node",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$node_storage",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","load",151],"(",["T_VARIABLE","$nid",151],")",";",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$node_file",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","File",152],["T_DOUBLE_COLON","::",152],["T_STRING","load",152],"(",["T_VARIABLE","$node",152],["T_OBJECT_OPERATOR","->",152],"{",["T_VARIABLE","$field_name",152],"}",["T_OBJECT_OPERATOR","->",152],["T_STRING","target_id",152],")",";",["T_WHITESPACE","\n    ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","assertFileExists",153],"(",["T_VARIABLE","$node_file",153],",",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading a file with extension checking.'",153],")",";",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","assertFileEntryExists",154],"(",["T_VARIABLE","$node_file",154],",",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading a file with extension checking.'",154],")",";",["T_WHITESPACE","\n  ",154],"}",["T_WHITESPACE","\n\n  ",155],["T_DOC_COMMENT","\/**\n   * Checks that a file can always be removed if it does not pass validation.\n   *\/",157],["T_WHITESPACE","\n  ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","testFileRemoval",160],"(",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n    ",160],["T_VARIABLE","$node_storage",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","container",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","get",161],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","getStorage",161],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",161],")",";",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$type_name",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'article'",162],";",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$field_name",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'file_test'",163],";",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","createFileField",164],"(",["T_VARIABLE","$field_name",164],",",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'node'",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$type_name",164],")",";",["T_WHITESPACE","\n\n    ",164],["T_VARIABLE","$test_file",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getTestFile",166],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",166],")",";",["T_WHITESPACE","\n\n    ",166],["T_COMMENT","\/\/ Disable extension checking.\n",168],["T_WHITESPACE","    ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","updateFileField",169],"(",["T_VARIABLE","$field_name",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$type_name",169],",",["T_WHITESPACE"," ",169],["T_ARRAY","array",169],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","''",169],")",")",";",["T_WHITESPACE","\n\n    ",169],["T_COMMENT","\/\/ Check that the file can be uploaded with no extension checking.\n",171],["T_WHITESPACE","    ",172],["T_VARIABLE","$nid",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","uploadNodeFile",172],"(",["T_VARIABLE","$test_file",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$field_name",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$type_name",172],")",";",["T_WHITESPACE","\n    ",172],["T_VARIABLE","$node_storage",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","resetCache",173],"(",["T_ARRAY","array",173],"(",["T_VARIABLE","$nid",173],")",")",";",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$node",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$node_storage",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","load",174],"(",["T_VARIABLE","$nid",174],")",";",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$node_file",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","File",175],["T_DOUBLE_COLON","::",175],["T_STRING","load",175],"(",["T_VARIABLE","$node",175],["T_OBJECT_OPERATOR","->",175],"{",["T_VARIABLE","$field_name",175],"}",["T_OBJECT_OPERATOR","->",175],["T_STRING","target_id",175],")",";",["T_WHITESPACE","\n    ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","assertFileExists",176],"(",["T_VARIABLE","$node_file",176],",",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'File exists after uploading a file with no extension checking.'",176],")",";",["T_WHITESPACE","\n    ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","assertFileEntryExists",177],"(",["T_VARIABLE","$node_file",177],",",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'File entry exists after uploading a file with no extension checking.'",177],")",";",["T_WHITESPACE","\n\n    ",177],["T_COMMENT","\/\/ Enable extension checking for text files.\n",179],["T_WHITESPACE","    ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","updateFileField",180],"(",["T_VARIABLE","$field_name",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$type_name",180],",",["T_WHITESPACE"," ",180],["T_ARRAY","array",180],"(",["T_CONSTANT_ENCAPSED_STRING","'file_extensions'",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'txt'",180],")",")",";",["T_WHITESPACE","\n\n    ",180],["T_COMMENT","\/\/ Check that the file can still be removed.\n",182],["T_WHITESPACE","    ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","removeNodeFile",183],"(",["T_VARIABLE","$nid",183],")",";",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","assertNoText",184],"(",["T_CONSTANT_ENCAPSED_STRING","'Only files with the following extensions are allowed: txt.'",184],")",";",["T_WHITESPACE","\n    ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertText",185],"(",["T_CONSTANT_ENCAPSED_STRING","'Article '",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_VARIABLE","$node",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getTitle",185],"(",")",["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","' has been updated.'",185],")",";",["T_WHITESPACE","\n  ",185],"}",["T_WHITESPACE","\n\n",186],"}",["T_WHITESPACE","\n",188]]