[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","file",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Plugin",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Validation",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Constraint",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ReferenceAccessConstraint",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Utility",6],["T_NS_SEPARATOR","\\",6],["T_STRING","SafeMarkup",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","file",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","File",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","node",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","NodeType",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Uploads a test to a private node and checks access.\n *\n * @group file\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","FilePrivateTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","FileFieldTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$modules",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_ARRAY","array",22],"(",["T_CONSTANT_ENCAPSED_STRING","'node_access_test'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'field_test'",22],")",";",["T_WHITESPACE","\n\n  ",22],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","setUp",24],"(",")",["T_WHITESPACE"," ",24],"{",["T_WHITESPACE","\n    ",24],["T_STRING","parent",25],["T_DOUBLE_COLON","::",25],["T_STRING","setUp",25],"(",")",";",["T_WHITESPACE","\n    ",25],["T_STRING","node_access_test_add_field",26],"(",["T_STRING","NodeType",26],["T_DOUBLE_COLON","::",26],["T_STRING","load",26],"(",["T_CONSTANT_ENCAPSED_STRING","'article'",26],")",")",";",["T_WHITESPACE","\n    ",26],["T_STRING","node_access_rebuild",27],"(",")",";",["T_WHITESPACE","\n    ",27],["T_NS_SEPARATOR","\\",28],["T_STRING","Drupal",28],["T_DOUBLE_COLON","::",28],["T_STRING","state",28],"(",")",["T_OBJECT_OPERATOR","->",28],["T_STRING","set",28],"(",["T_CONSTANT_ENCAPSED_STRING","'node_access_test.private'",28],",",["T_WHITESPACE"," ",28],["T_STRING","TRUE",28],")",";",["T_WHITESPACE","\n  ",28],"}",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * Tests file access for file uploaded to a private node.\n   *\/",31],["T_WHITESPACE","\n  ",33],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","testPrivateFile",34],"(",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$node_storage",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","container",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","get",35],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",35],")",["T_OBJECT_OPERATOR","->",35],["T_STRING","getStorage",35],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",35],")",";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$type_name",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'article'",36],";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$field_name",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","strtolower",37],"(",["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","randomMachineName",37],"(",")",")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","createFileField",38],"(",["T_VARIABLE","$field_name",38],",",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'node'",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$type_name",38],",",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_CONSTANT_ENCAPSED_STRING","'uri_scheme'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'private'",38],")",")",";",["T_WHITESPACE","\n\n    ",38],["T_VARIABLE","$test_file",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getTestFile",40],"(",["T_CONSTANT_ENCAPSED_STRING","'text'",40],")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$nid",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","uploadNodeFile",41],"(",["T_VARIABLE","$test_file",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$field_name",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$type_name",41],",",["T_WHITESPACE"," ",41],["T_STRING","TRUE",41],",",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",["T_CONSTANT_ENCAPSED_STRING","'private'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_STRING","TRUE",41],")",")",";",["T_WHITESPACE","\n    ",41],["T_NS_SEPARATOR","\\",42],["T_STRING","Drupal",42],["T_DOUBLE_COLON","::",42],["T_STRING","entityManager",42],"(",")",["T_OBJECT_OPERATOR","->",42],["T_STRING","getStorage",42],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",42],")",["T_OBJECT_OPERATOR","->",42],["T_STRING","resetCache",42],"(",["T_ARRAY","array",42],"(",["T_VARIABLE","$nid",42],")",")",";",["T_WHITESPACE","\n    ",42],["T_COMMENT","\/* @var \\Drupal\\node\\NodeInterface $node *\/",43],["T_WHITESPACE","\n    ",43],["T_VARIABLE","$node",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$node_storage",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","load",44],"(",["T_VARIABLE","$nid",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$node_file",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","File",45],["T_DOUBLE_COLON","::",45],["T_STRING","load",45],"(",["T_VARIABLE","$node",45],["T_OBJECT_OPERATOR","->",45],"{",["T_VARIABLE","$field_name",45],"}",["T_OBJECT_OPERATOR","->",45],["T_STRING","target_id",45],")",";",["T_WHITESPACE","\n    ",45],["T_COMMENT","\/\/ Ensure the file can be viewed.\n",46],["T_WHITESPACE","    ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","drupalGet",47],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",47],["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_VARIABLE","$node",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","id",47],"(",")",")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","assertRaw",48],"(",["T_VARIABLE","$node_file",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getFilename",48],"(",")",",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'File reference is displayed after attaching it'",48],")",";",["T_WHITESPACE","\n    ",48],["T_COMMENT","\/\/ Ensure the file can be downloaded.\n",49],["T_WHITESPACE","    ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","drupalGet",50],"(",["T_STRING","file_create_url",50],"(",["T_VARIABLE","$node_file",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getFileUri",50],"(",")",")",")",";",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","assertResponse",51],"(",["T_LNUMBER","200",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'Confirmed that the generated URL is correct by downloading the shipped file.'",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","drupalLogOut",52],"(",")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","drupalGet",53],"(",["T_STRING","file_create_url",53],"(",["T_VARIABLE","$node_file",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getFileUri",53],"(",")",")",")",";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertResponse",54],"(",["T_LNUMBER","403",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Confirmed that access is denied for the file without the needed permission.'",54],")",";",["T_WHITESPACE","\n\n    ",54],["T_COMMENT","\/\/ Create a field with no view access. See\n",56],["T_WHITESPACE","    ",57],["T_COMMENT","\/\/ field_test_entity_field_access().\n",57],["T_WHITESPACE","    ",58],["T_VARIABLE","$no_access_field_name",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'field_no_view_access'",58],";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","createFileField",59],"(",["T_VARIABLE","$no_access_field_name",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'node'",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$type_name",59],",",["T_WHITESPACE"," ",59],["T_ARRAY","array",59],"(",["T_CONSTANT_ENCAPSED_STRING","'uri_scheme'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'private'",59],")",")",";",["T_WHITESPACE","\n    ",59],["T_COMMENT","\/\/ Test with the field that should deny access through field access.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","drupalLogin",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","adminUser",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$nid",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","uploadNodeFile",62],"(",["T_VARIABLE","$test_file",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$no_access_field_name",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$type_name",62],",",["T_WHITESPACE"," ",62],["T_STRING","TRUE",62],",",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_CONSTANT_ENCAPSED_STRING","'private'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_STRING","TRUE",62],")",")",";",["T_WHITESPACE","\n    ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Drupal",63],["T_DOUBLE_COLON","::",63],["T_STRING","entityManager",63],"(",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","getStorage",63],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",63],")",["T_OBJECT_OPERATOR","->",63],["T_STRING","resetCache",63],"(",["T_ARRAY","array",63],"(",["T_VARIABLE","$nid",63],")",")",";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$node",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$node_storage",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","load",64],"(",["T_VARIABLE","$nid",64],")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$node_file",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","File",65],["T_DOUBLE_COLON","::",65],["T_STRING","load",65],"(",["T_VARIABLE","$node",65],["T_OBJECT_OPERATOR","->",65],"{",["T_VARIABLE","$no_access_field_name",65],"}",["T_OBJECT_OPERATOR","->",65],["T_STRING","target_id",65],")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ Ensure the file cannot be downloaded.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$file_url",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","file_create_url",68],"(",["T_VARIABLE","$node_file",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getFileUri",68],"(",")",")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","drupalGet",69],"(",["T_VARIABLE","$file_url",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertResponse",70],"(",["T_LNUMBER","403",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'Confirmed that access is denied for the file without view field access permission.'",70],")",";",["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/\/ Attempt to reuse the file when editing a node.\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$edit",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$edit",74],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",74],"]",["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","randomMachineName",74],"(",")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","drupalPostForm",75],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/'",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_VARIABLE","$type_name",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$edit",75],",",["T_WHITESPACE"," ",75],["T_STRING","t",75],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and publish'",75],")",")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$new_node",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","drupalGetNodeByTitle",76],"(",["T_VARIABLE","$edit",76],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",76],"]",")",";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$edit",77],"[",["T_VARIABLE","$field_name",77],["T_WHITESPACE"," ",77],".",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'[0][fids]'",77],"]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$node_file",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","id",77],"(",")",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","drupalPostForm",78],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_VARIABLE","$new_node",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","id",78],"(",")",["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$edit",78],",",["T_WHITESPACE"," ",78],["T_STRING","t",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and keep published'",78],")",")",";",["T_WHITESPACE","\n    ",78],["T_COMMENT","\/\/ Make sure the form submit failed - we stayed on the edit form.\n",79],["T_WHITESPACE","    ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","assertUrl",80],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$new_node",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","id",80],"(",")",["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",80],")",";",["T_WHITESPACE","\n    ",80],["T_COMMENT","\/\/ Check that we got the expected constraint form error.\n",81],["T_WHITESPACE","    ",82],["T_VARIABLE","$constraint",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","ReferenceAccessConstraint",82],"(",")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertRaw",83],"(",["T_STRING","SafeMarkup",83],["T_DOUBLE_COLON","::",83],["T_STRING","format",83],"(",["T_VARIABLE","$constraint",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","message",83],",",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_CONSTANT_ENCAPSED_STRING","'%type'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'file'",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'%id'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$node_file",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","id",83],"(",")",")",")",")",";",["T_WHITESPACE","\n    ",83],["T_COMMENT","\/\/ Attempt to reuse the existing file when creating a new node, and confirm\n",84],["T_WHITESPACE","    ",85],["T_COMMENT","\/\/ that access is still denied.\n",85],["T_WHITESPACE","    ",86],["T_VARIABLE","$edit",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",")",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$edit",87],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",87],"]",["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","randomMachineName",87],"(",")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$edit",88],"[",["T_VARIABLE","$field_name",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'[0][fids]'",88],"]",["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$node_file",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","id",88],"(",")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","drupalPostForm",89],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/'",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$type_name",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$edit",89],",",["T_WHITESPACE"," ",89],["T_STRING","t",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and publish'",89],")",")",";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$new_node",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","drupalGetNodeByTitle",90],"(",["T_VARIABLE","$edit",90],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",90],"]",")",";",["T_WHITESPACE","\n    ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertTrue",91],"(",["T_EMPTY","empty",91],"(",["T_VARIABLE","$new_node",91],")",",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'Node was not created.'",91],")",";",["T_WHITESPACE","\n    ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","assertUrl",92],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_VARIABLE","$type_name",92],")",";",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertRaw",93],"(",["T_STRING","SafeMarkup",93],["T_DOUBLE_COLON","::",93],["T_STRING","format",93],"(",["T_VARIABLE","$constraint",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","message",93],",",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",["T_CONSTANT_ENCAPSED_STRING","'%type'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'file'",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'%id'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$node_file",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","id",93],"(",")",")",")",")",";",["T_WHITESPACE","\n\n    ",93],["T_COMMENT","\/\/ Now make file_test_file_download() return everything.\n",95],["T_WHITESPACE","    ",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Drupal",96],["T_DOUBLE_COLON","::",96],["T_STRING","state",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","set",96],"(",["T_CONSTANT_ENCAPSED_STRING","'file_test.allow_all'",96],",",["T_WHITESPACE"," ",96],["T_STRING","TRUE",96],")",";",["T_WHITESPACE","\n    ",96],["T_COMMENT","\/\/ Delete the node.\n",97],["T_WHITESPACE","    ",98],["T_VARIABLE","$node",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","delete",98],"(",")",";",["T_WHITESPACE","\n    ",98],["T_COMMENT","\/\/ Ensure the file can still be downloaded by the owner.\n",99],["T_WHITESPACE","    ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","drupalGet",100],"(",["T_VARIABLE","$file_url",100],")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertResponse",101],"(",["T_LNUMBER","200",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'Confirmed that the owner still has access to the temporary file.'",101],")",";",["T_WHITESPACE","\n\n    ",101],["T_COMMENT","\/\/ Ensure the file cannot be downloaded by an anonymous user.\n",103],["T_WHITESPACE","    ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","drupalLogout",104],"(",")",";",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","drupalGet",105],"(",["T_VARIABLE","$file_url",105],")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertResponse",106],"(",["T_LNUMBER","403",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'Confirmed that access is denied for an anonymous user to the temporary file.'",106],")",";",["T_WHITESPACE","\n\n    ",106],["T_COMMENT","\/\/ Ensure the file cannot be downloaded by another user.\n",108],["T_WHITESPACE","    ",109],["T_VARIABLE","$account",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","drupalCreateUser",109],"(",")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","drupalLogin",110],"(",["T_VARIABLE","$account",110],")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","drupalGet",111],"(",["T_VARIABLE","$file_url",111],")",";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertResponse",112],"(",["T_LNUMBER","403",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'Confirmed that access is denied for another user to the temporary file.'",112],")",";",["T_WHITESPACE","\n  ",112],"}",["T_WHITESPACE","\n\n",113],"}",["T_WHITESPACE","\n",115]]