[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","file",3],["T_NS_SEPARATOR","\\",3],["T_STRING","FileUsage",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Connection",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","file",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FileInterface",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Defines the database file usage backend. This is the default Drupal backend.\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","DatabaseFileUsageBackend",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_STRING","FileUsageBase",11],["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\n  ",11],["T_DOC_COMMENT","\/**\n   * The database connection used to store file usage information.\n   *\n   * @var \\Drupal\\Core\\Database\\Connection\n   *\/",13],["T_WHITESPACE","\n  ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$connection",18],";",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * The name of the SQL table used to store file usage information.\n   *\n   * @var string\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$tableName",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * Construct the DatabaseFileUsageBackend.\n   *\n   * @param \\Drupal\\Core\\Database\\Connection $connection\n   *   The database connection which will be used to store the file usage\n   *   information.\n   * @param string $table\n   *   (optional) The table to store file usage info. Defaults to 'file_usage'.\n   *\/",27],["T_WHITESPACE","\n  ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","__construct",36],"(",["T_STRING","Connection",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$connection",36],",",["T_WHITESPACE"," ",36],["T_VARIABLE","$table",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'file_usage'",36],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","connection",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$connection",37],";",["T_WHITESPACE","\n\n    ",37],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","tableName",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$table",39],";",["T_WHITESPACE","\n  ",39],"}",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",42],["T_WHITESPACE","\n  ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","add",45],"(",["T_STRING","FileInterface",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$file",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$module",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$type",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$id",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$count",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_LNUMBER","1",45],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","connection",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","merge",46],"(",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","tableName",46],")",["T_WHITESPACE","\n      ",46],["T_OBJECT_OPERATOR","->",47],["T_STRING","keys",47],"(",["T_ARRAY","array",47],"(",["T_WHITESPACE","\n        ",47],["T_CONSTANT_ENCAPSED_STRING","'fid'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$file",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","id",48],"(",")",",",["T_WHITESPACE","\n        ",48],["T_CONSTANT_ENCAPSED_STRING","'module'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$module",49],",",["T_WHITESPACE","\n        ",49],["T_CONSTANT_ENCAPSED_STRING","'type'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$type",50],",",["T_WHITESPACE","\n        ",50],["T_CONSTANT_ENCAPSED_STRING","'id'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$id",51],",",["T_WHITESPACE","\n      ",51],")",")",["T_WHITESPACE","\n      ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","fields",53],"(",["T_ARRAY","array",53],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$count",53],")",")",["T_WHITESPACE","\n      ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","expression",54],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'count + :count'",54],",",["T_WHITESPACE"," ",54],["T_ARRAY","array",54],"(",["T_CONSTANT_ENCAPSED_STRING","':count'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$count",54],")",")",["T_WHITESPACE","\n      ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","execute",55],"(",")",";",["T_WHITESPACE","\n\n    ",55],["T_STRING","parent",57],["T_DOUBLE_COLON","::",57],["T_STRING","add",57],"(",["T_VARIABLE","$file",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$module",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$type",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$id",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$count",57],")",";",["T_WHITESPACE","\n  ",57],"}",["T_WHITESPACE","\n\n  ",58],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",60],["T_WHITESPACE","\n  ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","delete",63],"(",["T_STRING","FileInterface",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$file",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$module",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$type",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","NULL",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$id",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","NULL",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$count",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_LNUMBER","1",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_COMMENT","\/\/ Delete rows that have a exact or less value to prevent empty rows.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$query",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","connection",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","delete",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","tableName",65],")",["T_WHITESPACE","\n      ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","condition",66],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$module",66],")",["T_WHITESPACE","\n      ",66],["T_OBJECT_OPERATOR","->",67],["T_STRING","condition",67],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$file",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","id",67],"(",")",")",";",["T_WHITESPACE","\n    ",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$type",68],["T_WHITESPACE"," ",68],["T_BOOLEAN_AND","&&",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$id",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n      ",68],["T_VARIABLE","$query",69],["T_WHITESPACE","\n        ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","condition",70],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$type",70],")",["T_WHITESPACE","\n        ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","condition",71],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$id",71],")",";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n    ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$count",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n      ",73],["T_VARIABLE","$query",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","condition",74],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$count",74],",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'<='",74],")",";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$result",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$query",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","execute",76],"(",")",";",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/\/ If the row has more than the specified count decrement it by that number.\n",78],["T_WHITESPACE","    ",79],["T_IF","if",79],["T_WHITESPACE"," ",79],"(","!",["T_VARIABLE","$result",79],["T_WHITESPACE"," ",79],["T_BOOLEAN_AND","&&",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$count",79],["T_WHITESPACE"," ",79],">",["T_WHITESPACE"," ",79],["T_LNUMBER","0",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n      ",79],["T_VARIABLE","$query",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","connection",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","update",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","tableName",80],")",["T_WHITESPACE","\n        ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","condition",81],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$module",81],")",["T_WHITESPACE","\n        ",81],["T_OBJECT_OPERATOR","->",82],["T_STRING","condition",82],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$file",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","id",82],"(",")",")",";",["T_WHITESPACE","\n      ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$type",83],["T_WHITESPACE"," ",83],["T_BOOLEAN_AND","&&",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$id",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$query",84],["T_WHITESPACE","\n          ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","condition",85],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$type",85],")",["T_WHITESPACE","\n          ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","condition",86],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$id",86],")",";",["T_WHITESPACE","\n      ",86],"}",["T_WHITESPACE","\n      ",87],["T_VARIABLE","$query",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","expression",88],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'count - :count'",88],",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_CONSTANT_ENCAPSED_STRING","':count'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$count",88],")",")",";",["T_WHITESPACE","\n      ",88],["T_VARIABLE","$query",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","execute",89],"(",")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_STRING","parent",92],["T_DOUBLE_COLON","::",92],["T_STRING","delete",92],"(",["T_VARIABLE","$file",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$module",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$type",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$id",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$count",92],")",";",["T_WHITESPACE","\n  ",92],"}",["T_WHITESPACE","\n\n  ",93],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",95],["T_WHITESPACE","\n  ",97],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","listUsage",98],"(",["T_STRING","FileInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$file",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$result",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","connection",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","select",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","tableName",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'f'",99],")",["T_WHITESPACE","\n      ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","fields",100],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",100],",",["T_WHITESPACE"," ",100],["T_ARRAY","array",100],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'type'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'id'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'count'",100],")",")",["T_WHITESPACE","\n      ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","condition",101],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$file",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","id",101],"(",")",")",["T_WHITESPACE","\n      ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","condition",102],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",102],",",["T_WHITESPACE"," ",102],["T_LNUMBER","0",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'>'",102],")",["T_WHITESPACE","\n      ",102],["T_OBJECT_OPERATOR","->",103],["T_STRING","execute",103],"(",")",";",["T_WHITESPACE","\n    ",103],["T_VARIABLE","$references",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_ARRAY","array",104],"(",")",";",["T_WHITESPACE","\n    ",104],["T_FOREACH","foreach",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$result",105],["T_WHITESPACE"," ",105],["T_AS","as",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$usage",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n      ",105],["T_VARIABLE","$references",106],"[",["T_VARIABLE","$usage",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","module",106],"]","[",["T_VARIABLE","$usage",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","type",106],"]","[",["T_VARIABLE","$usage",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","id",106],"]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$usage",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","count",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n    ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$references",108],";",["T_WHITESPACE","\n  ",108],"}",["T_WHITESPACE","\n\n",109],"}",["T_WHITESPACE","\n",111]]