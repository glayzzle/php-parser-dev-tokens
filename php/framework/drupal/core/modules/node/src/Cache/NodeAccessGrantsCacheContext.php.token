[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","node",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Cache",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],["T_NS_SEPARATOR","\\",5],["T_STRING","CacheableMetadata",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Context",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CalculatedCacheContextInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Cache",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Context",7],["T_NS_SEPARATOR","\\",7],["T_STRING","UserCacheContextBase",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Defines the node access view cache context service.\n *\n * Cache context ID: 'user.node_grants' (to vary by all operations' grants).\n * Calculated cache context ID: 'user.node_grants:%operation', e.g.\n * 'user.node_grants:view' (to vary by the view operation's grants).\n *\n * This allows for node access grants-sensitive caching when listing nodes.\n *\n * @see node_query_node_access_alter()\n * @ingroup node_access\n *\/",9],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","NodeAccessGrantsCacheContext",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","UserCacheContextBase",21],["T_WHITESPACE"," ",21],["T_IMPLEMENTS","implements",21],["T_WHITESPACE"," ",21],["T_STRING","CalculatedCacheContextInterface",21],["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",23],["T_WHITESPACE","\n  ",25],["T_PUBLIC","public",26],["T_WHITESPACE"," ",26],["T_STATIC","static",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","getLabel",26],"(",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n    ",26],["T_RETURN","return",27],["T_WHITESPACE"," ",27],["T_STRING","t",27],"(",["T_CONSTANT_ENCAPSED_STRING","\"Content access view grants\"",27],")",";",["T_WHITESPACE","\n  ",27],"}",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",30],["T_WHITESPACE","\n  ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","getContext",33],"(",["T_VARIABLE","$operation",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","NULL",33],")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_COMMENT","\/\/ If the current user either can bypass node access then we don't need to\n",34],["T_WHITESPACE","    ",35],["T_COMMENT","\/\/ determine the exact node grants for the current user.\n",35],["T_WHITESPACE","    ",36],["T_IF","if",36],["T_WHITESPACE"," ",36],"(",["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","user",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","hasPermission",36],"(",["T_CONSTANT_ENCAPSED_STRING","'bypass node access'",36],")",")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n      ",36],["T_RETURN","return",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'all'",37],";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/ When no specific operation is specified, check the grants for all three\n",40],["T_WHITESPACE","    ",41],["T_COMMENT","\/\/ possible operations.\n",41],["T_WHITESPACE","    ",42],["T_IF","if",42],["T_WHITESPACE"," ",42],"(",["T_VARIABLE","$operation",42],["T_WHITESPACE"," ",42],["T_IS_IDENTICAL","===",42],["T_WHITESPACE"," ",42],["T_STRING","NULL",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n      ",42],["T_VARIABLE","$result",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],"[","]",";",["T_WHITESPACE","\n      ",43],["T_FOREACH","foreach",44],["T_WHITESPACE"," ",44],"(","[",["T_CONSTANT_ENCAPSED_STRING","'view'",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'update'",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'delete'",44],"]",["T_WHITESPACE"," ",44],["T_AS","as",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$op",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$result",45],"[","]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","checkNodeGrants",45],"(",["T_VARIABLE","$op",45],")",";",["T_WHITESPACE","\n      ",45],"}",["T_WHITESPACE","\n      ",46],["T_RETURN","return",47],["T_WHITESPACE"," ",47],["T_STRING","implode",47],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",47],",",["T_WHITESPACE"," ",47],["T_VARIABLE","$result",47],")",";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n    ",48],["T_ELSE","else",49],["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n      ",49],["T_RETURN","return",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","checkNodeGrants",50],"(",["T_VARIABLE","$operation",50],")",";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n  ",51],"}",["T_WHITESPACE","\n\n  ",52],["T_DOC_COMMENT","\/**\n   * Checks the node grants for the given operation.\n   *\n   * @param string $operation\n   *   The operation to check the node grants for.\n   *\n   * @return string\n   *   The string representation of the cache context.\n   *\/",54],["T_WHITESPACE","\n  ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","checkNodeGrants",63],"(",["T_VARIABLE","$operation",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_COMMENT","\/\/ When checking the grants for the 'view' operation and the current user\n",64],["T_WHITESPACE","    ",65],["T_COMMENT","\/\/ has a global view grant (i.e. a view grant for node ID 0) \u00e2\u0080\u0094 note that\n",65],["T_WHITESPACE","    ",66],["T_COMMENT","\/\/ this is automatically the case if no node access modules exist (no\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ hook_node_grants() implementations) then we don't need to determine the\n",67],["T_WHITESPACE","    ",68],["T_COMMENT","\/\/ exact node view grants for the current user.\n",68],["T_WHITESPACE","    ",69],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$operation",69],["T_WHITESPACE"," ",69],["T_IS_IDENTICAL","===",69],["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'view'",69],["T_WHITESPACE"," ",69],["T_BOOLEAN_AND","&&",69],["T_WHITESPACE"," ",69],["T_STRING","node_access_view_all_nodes",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","user",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n      ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'view.all'",70],";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_VARIABLE","$grants",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","node_access_grants",73],"(",["T_VARIABLE","$operation",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","user",73],")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$grants_context_parts",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],"[","]",";",["T_WHITESPACE","\n    ",74],["T_FOREACH","foreach",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$grants",75],["T_WHITESPACE"," ",75],["T_AS","as",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$realm",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$gids",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n      ",75],["T_VARIABLE","$grants_context_parts",76],"[","]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$realm",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","':'",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_STRING","implode",76],"(",["T_CONSTANT_ENCAPSED_STRING","','",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$gids",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n    ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$operation",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'.'",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_STRING","implode",78],"(",["T_CONSTANT_ENCAPSED_STRING","';'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$grants_context_parts",78],")",";",["T_WHITESPACE","\n  ",78],"}",["T_WHITESPACE","\n\n  ",79],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",81],["T_WHITESPACE","\n  ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","getCacheableMetadata",84],"(",["T_VARIABLE","$operation",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","NULL",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$cacheable_metadata",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_NEW","new",85],["T_WHITESPACE"," ",85],["T_STRING","CacheableMetadata",85],"(",")",";",["T_WHITESPACE","\n\n    ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_NS_SEPARATOR","\\",87],["T_STRING","Drupal",87],["T_DOUBLE_COLON","::",87],["T_STRING","moduleHandler",87],"(",")",["T_OBJECT_OPERATOR","->",87],["T_STRING","getImplementations",87],"(",["T_CONSTANT_ENCAPSED_STRING","'node_grants'",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$cacheable_metadata",88],";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ The node grants may change if the user is updated. (The max-age is set to\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/ zero below, but sites may override this cache context, and change it to a\n",92],["T_WHITESPACE","    ",93],["T_COMMENT","\/\/ non-zero value. In such cases, this cache tag is needed for correctness.)\n",93],["T_WHITESPACE","    ",94],["T_VARIABLE","$cacheable_metadata",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","setCacheTags",94],"(","[",["T_CONSTANT_ENCAPSED_STRING","'user:'",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","user",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","id",94],"(",")","]",")",";",["T_WHITESPACE","\n\n    ",94],["T_COMMENT","\/\/ If the site is using node grants, this cache context can not be\n",96],["T_WHITESPACE","    ",97],["T_COMMENT","\/\/ optimized.\n",97],["T_WHITESPACE","    ",98],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$cacheable_metadata",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","setCacheMaxAge",98],"(",["T_LNUMBER","0",98],")",";",["T_WHITESPACE","\n  ",98],"}",["T_WHITESPACE","\n\n",99],"}",["T_WHITESPACE","\n",101]]