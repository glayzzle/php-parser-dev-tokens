[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],["T_NS_SEPARATOR","\\",3],["T_STRING","process",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","StreamWrapper",5],["T_NS_SEPARATOR","\\",5],["T_STRING","StreamWrapperInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTests",6],["T_NS_SEPARATOR","\\",6],["T_STRING","KernelTestBase",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","migrate",7],["T_NS_SEPARATOR","\\",7],["T_STRING","MigrateExecutableInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","migrate",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],["T_NS_SEPARATOR","\\",8],["T_STRING","migrate",8],["T_NS_SEPARATOR","\\",8],["T_STRING","process",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FileCopy",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","migrate",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Row",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Tests the copy_file process plugin.\n *\n * @group migrate\n *\/",11],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","CopyFileTest",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_STRING","KernelTestBase",16],["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\n  ",16],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",18],["T_WHITESPACE","\n  ",20],["T_PUBLIC","public",21],["T_WHITESPACE"," ",21],["T_STATIC","static",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$modules",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],"[",["T_CONSTANT_ENCAPSED_STRING","'migrate'",21],",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'system'",21],"]",";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * The file system service.\n   *\n   * @var \\Drupal\\Core\\File\\FileSystemInterface\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$fileSystem",28],";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",30],["T_WHITESPACE","\n  ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","setUp",33],"(",")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_STRING","parent",34],["T_DOUBLE_COLON","::",34],["T_STRING","setUp",34],"(",")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","fileSystem",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","container",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","get",35],"(",["T_CONSTANT_ENCAPSED_STRING","'file_system'",35],")",";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","container",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","get",36],"(",["T_CONSTANT_ENCAPSED_STRING","'stream_wrapper_manager'",36],")",["T_OBJECT_OPERATOR","->",36],["T_STRING","registerWrapper",36],"(",["T_CONSTANT_ENCAPSED_STRING","'temporary'",36],",",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\StreamWrapper\\TemporaryStream'",36],",",["T_WHITESPACE"," ",36],["T_STRING","StreamWrapperInterface",36],["T_DOUBLE_COLON","::",36],["T_STRING","LOCAL_NORMAL",36],")",";",["T_WHITESPACE","\n  ",36],"}",["T_WHITESPACE","\n\n  ",37],["T_DOC_COMMENT","\/**\n   * Test successful imports\/copies.\n   *\/",39],["T_WHITESPACE","\n  ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","testSuccessfulCopies",42],"(",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$file",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","createUri",43],"(",["T_STRING","NULL",43],",",["T_WHITESPACE"," ",43],["T_STRING","NULL",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'temporary'",43],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$file_absolute",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","fileSystem",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","realpath",44],"(",["T_VARIABLE","$file",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$data_sets",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],"[",["T_WHITESPACE","\n      ",45],["T_COMMENT","\/\/ Test a local to local copy.\n",46],["T_WHITESPACE","      ",47],"[",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","root",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'\/core\/modules\/simpletest\/files\/image-test.jpg'",48],",",["T_WHITESPACE","\n        ",48],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/file1.jpg'",49],["T_WHITESPACE","\n      ",49],"]",",",["T_WHITESPACE","\n      ",50],["T_COMMENT","\/\/ Test a temporary file using an absolute path.\n",51],["T_WHITESPACE","      ",52],"[",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$file_absolute",53],",",["T_WHITESPACE","\n        ",53],["T_CONSTANT_ENCAPSED_STRING","'temporary:\/\/test.jpg'",54],["T_WHITESPACE","\n      ",54],"]",",",["T_WHITESPACE","\n      ",55],["T_COMMENT","\/\/ Test a temporary file using a relative path.\n",56],["T_WHITESPACE","      ",57],"[",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$file_absolute",58],",",["T_WHITESPACE","\n        ",58],["T_CONSTANT_ENCAPSED_STRING","'temporary:\/\/core\/modules\/simpletest\/files\/test.jpg'",59],["T_WHITESPACE","\n      ",59],"]",",",["T_WHITESPACE","\n    ",60],"]",";",["T_WHITESPACE","\n    ",61],["T_FOREACH","foreach",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$data_sets",62],["T_WHITESPACE"," ",62],["T_AS","as",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$data",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n      ",62],["T_LIST","list",63],"(",["T_VARIABLE","$source_path",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$destination_path",63],")",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$data",63],";",["T_WHITESPACE","\n      ",63],["T_VARIABLE","$actual_destination",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","doImport",64],"(",["T_VARIABLE","$source_path",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$destination_path",64],")",";",["T_WHITESPACE","\n      ",64],["T_VARIABLE","$message",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","sprintf",65],"(",["T_CONSTANT_ENCAPSED_STRING","'File %s exists'",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$destination_path",65],")",";",["T_WHITESPACE","\n      ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertFileExists",66],"(",["T_VARIABLE","$destination_path",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$message",66],")",";",["T_WHITESPACE","\n      ",66],["T_COMMENT","\/\/ Make sure we didn't accidentally do a move.\n",67],["T_WHITESPACE","      ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","assertFileExists",68],"(",["T_VARIABLE","$source_path",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$message",68],")",";",["T_WHITESPACE","\n      ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertSame",69],"(",["T_VARIABLE","$actual_destination",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$destination_path",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'The import returned the copied filename.'",69],")",";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n  ",70],"}",["T_WHITESPACE","\n\n  ",71],["T_DOC_COMMENT","\/**\n   * Test successful file reuse.\n   *\/",73],["T_WHITESPACE","\n  ",75],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","testSuccessfulReuse",76],"(",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$source_path",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","root",77],["T_WHITESPACE"," ",77],".",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'\/core\/modules\/simpletest\/files\/image-test.jpg'",77],";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$destination_path",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/file1.jpg'",78],";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$file_reuse",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","file_unmanaged_copy",79],"(",["T_VARIABLE","$source_path",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$destination_path",79],")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$timestamp",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],"(",["T_NEW","new",80],["T_WHITESPACE"," ",80],["T_NS_SEPARATOR","\\",80],["T_STRING","SplFileInfo",80],"(",["T_VARIABLE","$file_reuse",80],")",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","getMTime",80],"(",")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","assertInternalType",81],"(",["T_CONSTANT_ENCAPSED_STRING","'int'",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$timestamp",81],")",";",["T_WHITESPACE","\n\n    ",81],["T_COMMENT","\/\/ We need to make sure the modified timestamp on the file is sooner than\n",83],["T_WHITESPACE","    ",84],["T_COMMENT","\/\/ the attempted migration.\n",84],["T_WHITESPACE","    ",85],["T_STRING","sleep",85],"(",["T_LNUMBER","1",85],")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$configuration",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],"[",["T_CONSTANT_ENCAPSED_STRING","'reuse'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","TRUE",86],"]",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","doImport",87],"(",["T_VARIABLE","$source_path",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$destination_path",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$configuration",87],")",";",["T_WHITESPACE","\n    ",87],["T_STRING","clearstatcache",88],"(",["T_STRING","TRUE",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$destination_path",88],")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$modified_timestamp",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],"(",["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_NS_SEPARATOR","\\",89],["T_STRING","SplFileInfo",89],"(",["T_VARIABLE","$destination_path",89],")",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","getMTime",89],"(",")",";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertEquals",90],"(",["T_VARIABLE","$timestamp",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$modified_timestamp",90],")",";",["T_WHITESPACE","\n\n    ",90],["T_VARIABLE","$configuration",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],"[",["T_CONSTANT_ENCAPSED_STRING","'reuse'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_STRING","FALSE",92],"]",";",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","doImport",93],"(",["T_VARIABLE","$source_path",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$destination_path",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$configuration",93],")",";",["T_WHITESPACE","\n    ",93],["T_STRING","clearstatcache",94],"(",["T_STRING","TRUE",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$destination_path",94],")",";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$modified_timestamp",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],"(",["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_NS_SEPARATOR","\\",95],["T_STRING","SplFileInfo",95],"(",["T_VARIABLE","$destination_path",95],")",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getMTime",95],"(",")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","assertGreaterThan",96],"(",["T_VARIABLE","$timestamp",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$modified_timestamp",96],")",";",["T_WHITESPACE","\n  ",96],"}",["T_WHITESPACE","\n\n  ",97],["T_DOC_COMMENT","\/**\n   * Test successful moves.\n   *\/",99],["T_WHITESPACE","\n  ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","testSuccessfulMoves",102],"(",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$file_1",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","createUri",103],"(",["T_STRING","NULL",103],",",["T_WHITESPACE"," ",103],["T_STRING","NULL",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'temporary'",103],")",";",["T_WHITESPACE","\n    ",103],["T_VARIABLE","$file_1_absolute",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","fileSystem",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","realpath",104],"(",["T_VARIABLE","$file_1",104],")",";",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$file_2",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","createUri",105],"(",["T_STRING","NULL",105],",",["T_WHITESPACE"," ",105],["T_STRING","NULL",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'temporary'",105],")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$file_2_absolute",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","fileSystem",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","realpath",106],"(",["T_VARIABLE","$file_2",106],")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$local_file",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","createUri",107],"(",["T_STRING","NULL",107],",",["T_WHITESPACE"," ",107],["T_STRING","NULL",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'public'",107],")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$data_sets",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],"[",["T_WHITESPACE","\n      ",108],["T_COMMENT","\/\/ Test a local to local copy.\n",109],["T_WHITESPACE","      ",110],"[",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$local_file",111],",",["T_WHITESPACE","\n        ",111],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/file1.jpg'",112],["T_WHITESPACE","\n      ",112],"]",",",["T_WHITESPACE","\n      ",113],["T_COMMENT","\/\/ Test a temporary file using an absolute path.\n",114],["T_WHITESPACE","      ",115],"[",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$file_1_absolute",116],",",["T_WHITESPACE","\n        ",116],["T_CONSTANT_ENCAPSED_STRING","'temporary:\/\/test.jpg'",117],["T_WHITESPACE","\n      ",117],"]",",",["T_WHITESPACE","\n      ",118],["T_COMMENT","\/\/ Test a temporary file using a relative path.\n",119],["T_WHITESPACE","      ",120],"[",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$file_2_absolute",121],",",["T_WHITESPACE","\n        ",121],["T_CONSTANT_ENCAPSED_STRING","'temporary:\/\/core\/modules\/simpletest\/files\/test.jpg'",122],["T_WHITESPACE","\n      ",122],"]",",",["T_WHITESPACE","\n    ",123],"]",";",["T_WHITESPACE","\n    ",124],["T_FOREACH","foreach",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$data_sets",125],["T_WHITESPACE"," ",125],["T_AS","as",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$data",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n      ",125],["T_LIST","list",126],"(",["T_VARIABLE","$source_path",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$destination_path",126],")",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$data",126],";",["T_WHITESPACE","\n      ",126],["T_VARIABLE","$actual_destination",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","doImport",127],"(",["T_VARIABLE","$source_path",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$destination_path",127],",",["T_WHITESPACE"," ",127],"[",["T_CONSTANT_ENCAPSED_STRING","'move'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_STRING","TRUE",127],"]",")",";",["T_WHITESPACE","\n      ",127],["T_VARIABLE","$message",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","sprintf",128],"(",["T_CONSTANT_ENCAPSED_STRING","'File %s exists'",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$destination_path",128],")",";",["T_WHITESPACE","\n      ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","assertFileExists",129],"(",["T_VARIABLE","$destination_path",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$message",129],")",";",["T_WHITESPACE","\n      ",129],["T_VARIABLE","$message",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","sprintf",130],"(",["T_CONSTANT_ENCAPSED_STRING","'File %s does not exist'",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$source_path",130],")",";",["T_WHITESPACE","\n      ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertFileNotExists",131],"(",["T_VARIABLE","$source_path",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$message",131],")",";",["T_WHITESPACE","\n      ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","assertSame",132],"(",["T_VARIABLE","$actual_destination",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$destination_path",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'The importer returned the moved filename.'",132],")",";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n  ",133],"}",["T_WHITESPACE","\n\n  ",134],["T_DOC_COMMENT","\/**\n   * Test that non-existent files throw an exception.\n   *\n   * @expectedException \\Drupal\\migrate\\MigrateException\n   *\n   * @expectedExceptionMessage File '\/non\/existent\/file' does not exist\n   *\/",136],["T_WHITESPACE","\n  ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","testNonExistentSourceFile",143],"(",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n    ",143],["T_VARIABLE","$source",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'\/non\/existent\/file'",144],";",["T_WHITESPACE","\n    ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","doImport",145],"(",["T_VARIABLE","$source",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/wontmatter.jpg'",145],")",";",["T_WHITESPACE","\n  ",145],"}",["T_WHITESPACE","\n\n  ",146],["T_DOC_COMMENT","\/**\n   * Test the 'rename' overwrite mode.\n   *\/",148],["T_WHITESPACE","\n  ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","testRenameFile",151],"(",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$source",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","createUri",152],"(",["T_STRING","NULL",152],",",["T_WHITESPACE"," ",152],["T_STRING","NULL",152],",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'temporary'",152],")",";",["T_WHITESPACE","\n    ",152],["T_VARIABLE","$destination",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","createUri",153],"(",["T_CONSTANT_ENCAPSED_STRING","'foo.txt'",153],",",["T_WHITESPACE"," ",153],["T_STRING","NULL",153],",",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'public'",153],")",";",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$expected_destination",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'public:\/\/foo_0.txt'",154],";",["T_WHITESPACE","\n    ",154],["T_VARIABLE","$actual_destination",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","doImport",155],"(",["T_VARIABLE","$source",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$destination",155],",",["T_WHITESPACE"," ",155],"[",["T_CONSTANT_ENCAPSED_STRING","'rename'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_STRING","TRUE",155],"]",")",";",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","assertFileExists",156],"(",["T_VARIABLE","$expected_destination",156],",",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'File was renamed on import'",156],")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","assertSame",157],"(",["T_VARIABLE","$actual_destination",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$expected_destination",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'The importer returned the renamed filename.'",157],")",";",["T_WHITESPACE","\n  ",157],"}",["T_WHITESPACE","\n\n  ",158],["T_DOC_COMMENT","\/**\n   * Do an import using the destination.\n   *\n   * @param string $source_path\n   *   Source path to copy from.\n   * @param string $destination_path\n   *   The destination path to copy to.\n   * @param array $configuration\n   *   Process plugin configuration settings.\n   *\n   * @throws \\Drupal\\migrate\\MigrateException\n   *\/",160],["T_WHITESPACE","\n  ",171],["T_PROTECTED","protected",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","doImport",172],"(",["T_VARIABLE","$source_path",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$destination_path",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$configuration",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],"[","]",")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n    ",172],["T_VARIABLE","$plugin",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","FileCopy",173],["T_DOUBLE_COLON","::",173],["T_STRING","create",173],"(",["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","container",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$configuration",173],",",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'file_copy'",173],",",["T_WHITESPACE"," ",173],"[","]",")",";",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$executable",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","prophesize",174],"(",["T_STRING","MigrateExecutableInterface",174],["T_DOUBLE_COLON","::",174],["T_CLASS","class",174],")",["T_OBJECT_OPERATOR","->",174],["T_STRING","reveal",174],"(",")",";",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$row",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_STRING","Row",175],"(",")",";",["T_WHITESPACE","\n\n    ",175],["T_VARIABLE","$result",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$plugin",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","transform",177],"(","[",["T_VARIABLE","$source_path",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$destination_path",177],"]",",",["T_WHITESPACE"," ",177],["T_VARIABLE","$executable",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$row",177],",",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'foobaz'",177],")",";",["T_WHITESPACE","\n\n    ",177],["T_COMMENT","\/\/ Return the imported file Uri.\n",179],["T_WHITESPACE","    ",180],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$result",180],";",["T_WHITESPACE","\n  ",180],"}",["T_WHITESPACE","\n\n  ",181],["T_DOC_COMMENT","\/**\n   * Create a file and return the URI of it.\n   *\n   * @param $filepath\n   *   Optional string specifying the file path. If none is provided then a\n   *   randomly named file will be created in the site's files directory.\n   * @param $contents\n   *   Optional contents to save into the file. If a NULL value is provided an\n   *   arbitrary string will be used.\n   * @param $scheme\n   *   Optional string indicating the stream scheme to use. Drupal core includes\n   *   public, private, and temporary. The public wrapper is the default.\n   * @return\n   *   File URI.\n   *\/",183],["T_WHITESPACE","\n  ",197],["T_PROTECTED","protected",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","createUri",198],"(",["T_VARIABLE","$filepath",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","NULL",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$contents",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","NULL",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$scheme",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","NULL",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n    ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(","!",["T_ISSET","isset",199],"(",["T_VARIABLE","$filepath",199],")",")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n      ",199],["T_COMMENT","\/\/ Prefix with non-latin characters to ensure that all file-related\n",200],["T_WHITESPACE","      ",201],["T_COMMENT","\/\/ tests work with international filenames.\n",201],["T_WHITESPACE","      ",202],["T_VARIABLE","$filepath",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'\u00d0\u00a4\u00d0\u00b0\u00d0\u00b9\u00d0\u00bb \u00d0\u00b4\u00d0\u00bb\u00d1\u008f \u00d1\u0082\u00d0\u00b5\u00d1\u0081\u00d1\u0082\u00d0\u00b8\u00d1\u0080\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d0\u00bd\u00d0\u00b8\u00d1\u008f '",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","randomMachineName",202],"(",")",";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n    ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_EMPTY","empty",204],"(",["T_VARIABLE","$scheme",204],")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n      ",204],["T_VARIABLE","$scheme",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_STRING","file_default_scheme",205],"(",")",";",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n    ",206],["T_VARIABLE","$filepath",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$scheme",207],["T_WHITESPACE"," ",207],".",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","':\/\/'",207],["T_WHITESPACE"," ",207],".",["T_WHITESPACE"," ",207],["T_VARIABLE","$filepath",207],";",["T_WHITESPACE","\n\n    ",207],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_EMPTY","empty",209],"(",["T_VARIABLE","$contents",209],")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n      ",209],["T_VARIABLE","$contents",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","\"file_put_contents() doesn't seem to appreciate empty strings so let's put in some data.\"",210],";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n\n    ",211],["T_STRING","file_put_contents",213],"(",["T_VARIABLE","$filepath",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$contents",213],")",";",["T_WHITESPACE","\n    ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","assertFileExists",214],"(",["T_VARIABLE","$filepath",214],",",["T_WHITESPACE"," ",214],["T_STRING","t",214],"(",["T_CONSTANT_ENCAPSED_STRING","'The test file exists on the disk.'",214],")",")",";",["T_WHITESPACE","\n    ",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$filepath",215],";",["T_WHITESPACE","\n  ",215],"}",["T_WHITESPACE","\n\n",216],"}",["T_WHITESPACE","\n",218]]