[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","KernelTests",5],["T_NS_SEPARATOR","\\",5],["T_STRING","KernelTestBase",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests the EmbeddedDataSource plugin.\n *\n * @group migrate\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","MigrateEmbeddedDataTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","KernelTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",14],["T_WHITESPACE","\n  ",18],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_STATIC","static",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$modules",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],"[",["T_CONSTANT_ENCAPSED_STRING","'migrate'",19],"]",";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * Tests the embedded_data source plugin.\n   *\/",21],["T_WHITESPACE","\n  ",23],["T_PUBLIC","public",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","testEmbeddedData",24],"(",")",["T_WHITESPACE"," ",24],"{",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$data_rows",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],"[",["T_WHITESPACE","\n      ",25],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'1'",26],",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'field1'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'f1value1'",26],",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'field2'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'f2value1'",26],"]",",",["T_WHITESPACE","\n      ",26],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",27],["T_WHITESPACE"," ",27],["T_DOUBLE_ARROW","=>",27],["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'2'",27],",",["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'field1'",27],["T_WHITESPACE"," ",27],["T_DOUBLE_ARROW","=>",27],["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'f1value2'",27],",",["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'field2'",27],["T_WHITESPACE"," ",27],["T_DOUBLE_ARROW","=>",27],["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'f2value2'",27],"]",",",["T_WHITESPACE","\n    ",27],"]",";",["T_WHITESPACE","\n    ",28],["T_VARIABLE","$ids",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'integer'",29],"]","]",";",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$definition",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],"[",["T_WHITESPACE","\n      ",30],["T_CONSTANT_ENCAPSED_STRING","'migration_tags'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],"[",["T_CONSTANT_ENCAPSED_STRING","'Embedded data test'",31],"]",",",["T_WHITESPACE","\n      ",31],["T_CONSTANT_ENCAPSED_STRING","'source'",32],["T_WHITESPACE"," ",32],["T_DOUBLE_ARROW","=>",32],["T_WHITESPACE"," ",32],"[",["T_WHITESPACE","\n        ",32],["T_CONSTANT_ENCAPSED_STRING","'plugin'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'embedded_data'",33],",",["T_WHITESPACE","\n        ",33],["T_CONSTANT_ENCAPSED_STRING","'data_rows'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$data_rows",34],",",["T_WHITESPACE","\n        ",34],["T_CONSTANT_ENCAPSED_STRING","'ids'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$ids",35],",",["T_WHITESPACE","\n      ",35],"]",",",["T_WHITESPACE","\n      ",36],["T_CONSTANT_ENCAPSED_STRING","'process'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],"[","]",",",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'destination'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],"[",["T_CONSTANT_ENCAPSED_STRING","'plugin'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'null'",38],"]",",",["T_WHITESPACE","\n    ",38],"]",";",["T_WHITESPACE","\n\n    ",39],["T_VARIABLE","$migration",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Drupal",41],["T_DOUBLE_COLON","::",41],["T_STRING","service",41],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.migration'",41],")",["T_OBJECT_OPERATOR","->",41],["T_STRING","createStubMigration",41],"(",["T_VARIABLE","$definition",41],")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$source",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$migration",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getSourcePlugin",42],"(",")",";",["T_WHITESPACE","\n\n    ",42],["T_COMMENT","\/\/ Validate the plugin returns the source data that was provided.\n",44],["T_WHITESPACE","    ",45],["T_VARIABLE","$results",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],"[","]",";",["T_WHITESPACE","\n    ",45],["T_DOC_COMMENT","\/** @var \\Drupal\\migrate\\Row $row *\/",46],["T_WHITESPACE","\n    ",46],["T_FOREACH","foreach",47],["T_WHITESPACE"," ",47],"(",["T_VARIABLE","$source",47],["T_WHITESPACE"," ",47],["T_AS","as",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$row",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n      ",47],["T_VARIABLE","$data_row",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$row",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getSource",48],"(",")",";",["T_WHITESPACE","\n      ",48],["T_COMMENT","\/\/ The \"data\" row returned by getSource() also includes all source\n",49],["T_WHITESPACE","      ",50],["T_COMMENT","\/\/ configuration - we remove it so we see only the data itself.\n",50],["T_WHITESPACE","      ",51],["T_UNSET","unset",51],"(",["T_VARIABLE","$data_row",51],"[",["T_CONSTANT_ENCAPSED_STRING","'plugin'",51],"]",")",";",["T_WHITESPACE","\n      ",51],["T_UNSET","unset",52],"(",["T_VARIABLE","$data_row",52],"[",["T_CONSTANT_ENCAPSED_STRING","'data_rows'",52],"]",")",";",["T_WHITESPACE","\n      ",52],["T_UNSET","unset",53],"(",["T_VARIABLE","$data_row",53],"[",["T_CONSTANT_ENCAPSED_STRING","'ids'",53],"]",")",";",["T_WHITESPACE","\n      ",53],["T_VARIABLE","$results",54],"[","]",["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$data_row",54],";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertIdentical",56],"(",["T_VARIABLE","$results",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$data_rows",56],")",";",["T_WHITESPACE","\n\n    ",56],["T_COMMENT","\/\/ Validate the public APIs.\n",58],["T_WHITESPACE","    ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertIdentical",59],"(",["T_VARIABLE","$source",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","count",59],"(",")",",",["T_WHITESPACE"," ",59],["T_STRING","count",59],"(",["T_VARIABLE","$data_rows",59],")",")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertIdentical",60],"(",["T_VARIABLE","$source",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getIds",60],"(",")",",",["T_WHITESPACE"," ",60],["T_VARIABLE","$ids",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$expected_fields",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],"[",["T_WHITESPACE","\n      ",61],["T_CONSTANT_ENCAPSED_STRING","'key'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'key'",62],",",["T_WHITESPACE","\n      ",62],["T_CONSTANT_ENCAPSED_STRING","'field1'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'field1'",63],",",["T_WHITESPACE","\n      ",63],["T_CONSTANT_ENCAPSED_STRING","'field2'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'field2'",64],",",["T_WHITESPACE","\n    ",64],"]",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertIdentical",66],"(",["T_VARIABLE","$source",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","fields",66],"(",")",",",["T_WHITESPACE"," ",66],["T_VARIABLE","$expected_fields",66],")",";",["T_WHITESPACE","\n  ",66],"}",["T_WHITESPACE","\n\n",67],"}",["T_WHITESPACE","\n",69]]