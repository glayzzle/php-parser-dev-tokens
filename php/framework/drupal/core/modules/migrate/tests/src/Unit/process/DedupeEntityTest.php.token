[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Unit",3],["T_NS_SEPARATOR","\\",3],["T_STRING","process",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Query",5],["T_NS_SEPARATOR","\\",5],["T_STRING","QueryInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","migrate",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],["T_NS_SEPARATOR","\\",6],["T_STRING","migrate",6],["T_NS_SEPARATOR","\\",6],["T_STRING","process",6],["T_NS_SEPARATOR","\\",6],["T_STRING","DedupeEntity",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Component",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Utility",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Unicode",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * @coversDefaultClass \\Drupal\\migrate\\Plugin\\migrate\\process\\DedupeEntity\n * @group migrate\n *\/",9],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","DedupeEntityTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","MigrateProcessTestCase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * The mock entity query.\n   *\n   * @var \\Drupal\\Core\\Entity\\Query\\QueryInterface\n   * @var \\Drupal\\Core\\Entity\\Query\\QueryFactory\n   *\/",15],["T_WHITESPACE","\n  ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$entityQuery",21],";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * The mock entity query factory.\n   *\n   * @var \\Drupal\\Core\\Entity\\Query\\QueryFactory|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$entityQueryFactory",28],";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * The migration configuration, initialized to set the ID to test.\n   *\n   * @var array\n   *\/",30],["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$migrationConfiguration",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_WHITESPACE","\n    ",35],["T_CONSTANT_ENCAPSED_STRING","'id'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'test'",36],",",["T_WHITESPACE","\n  ",36],")",";",["T_WHITESPACE","\n\n  ",37],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",39],["T_WHITESPACE","\n  ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","setUp",42],"(",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","entityQuery",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getMockBuilder",43],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Entity\\Query\\QueryInterface'",43],")",["T_WHITESPACE","\n      ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","disableOriginalConstructor",44],"(",")",["T_WHITESPACE","\n      ",44],["T_OBJECT_OPERATOR","->",45],["T_STRING","getMock",45],"(",")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","entityQueryFactory",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getMockBuilder",46],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Entity\\Query\\QueryFactory'",46],")",["T_WHITESPACE","\n      ",46],["T_OBJECT_OPERATOR","->",47],["T_STRING","disableOriginalConstructor",47],"(",")",["T_WHITESPACE","\n      ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","getMock",48],"(",")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","entityQueryFactory",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","expects",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","any",49],"(",")",")",["T_WHITESPACE","\n      ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","method",50],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",50],")",["T_WHITESPACE","\n      ",50],["T_OBJECT_OPERATOR","->",51],["T_STRING","will",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","returnValue",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","entityQuery",51],")",")",";",["T_WHITESPACE","\n    ",51],["T_STRING","parent",52],["T_DOUBLE_COLON","::",52],["T_STRING","setUp",52],"(",")",";",["T_WHITESPACE","\n  ",52],"}",["T_WHITESPACE","\n\n  ",53],["T_DOC_COMMENT","\/**\n   * Tests entity based deduplication based on providerTestDedupe() values.\n   *\n   * @dataProvider providerTestDedupe\n   *\/",55],["T_WHITESPACE","\n  ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","testDedupe",60],"(",["T_VARIABLE","$count",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$postfix",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","''",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$start",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","NULL",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$length",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","NULL",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$configuration",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",["T_WHITESPACE","\n      ",61],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'test_entity_type'",62],",",["T_WHITESPACE","\n      ",62],["T_CONSTANT_ENCAPSED_STRING","'field'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'test_field'",63],",",["T_WHITESPACE","\n    ",63],")",";",["T_WHITESPACE","\n    ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$postfix",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n      ",65],["T_VARIABLE","$configuration",66],"[",["T_CONSTANT_ENCAPSED_STRING","'postfix'",66],"]",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$postfix",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$configuration",68],"[",["T_CONSTANT_ENCAPSED_STRING","'start'",68],"]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_ISSET","isset",68],"(",["T_VARIABLE","$start",68],")",["T_WHITESPACE"," ",68],"?",["T_WHITESPACE"," ",68],["T_VARIABLE","$start",68],["T_WHITESPACE"," ",68],":",["T_WHITESPACE"," ",68],["T_STRING","NULL",68],";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$configuration",69],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",69],"]",["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ISSET","isset",69],"(",["T_VARIABLE","$length",69],")",["T_WHITESPACE"," ",69],"?",["T_WHITESPACE"," ",69],["T_VARIABLE","$length",69],["T_WHITESPACE"," ",69],":",["T_WHITESPACE"," ",69],["T_STRING","NULL",69],";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$plugin",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","DedupeEntity",70],"(",["T_VARIABLE","$configuration",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'dedupe_entity'",70],",",["T_WHITESPACE"," ",70],["T_ARRAY","array",70],"(",")",",",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getMigration",70],"(",")",",",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","entityQueryFactory",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","entityQueryExpects",71],"(",["T_VARIABLE","$count",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$value",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","randomMachineName",72],"(",["T_LNUMBER","32",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$actual",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$plugin",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","transform",73],"(",["T_VARIABLE","$value",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","migrateExecutable",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","row",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'testproperty'",73],")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$expected",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","Unicode",74],["T_DOUBLE_COLON","::",74],["T_STRING","substr",74],"(",["T_VARIABLE","$value",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$start",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$length",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$expected",75],["T_WHITESPACE"," ",75],["T_CONCAT_EQUAL",".=",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$count",75],["T_WHITESPACE"," ",75],"?",["T_WHITESPACE"," ",75],["T_VARIABLE","$postfix",75],["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_VARIABLE","$count",75],["T_WHITESPACE"," ",75],":",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","''",75],";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertSame",76],"(",["T_VARIABLE","$expected",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$actual",76],")",";",["T_WHITESPACE","\n  ",76],"}",["T_WHITESPACE","\n\n  ",77],["T_DOC_COMMENT","\/**\n   * Tests that invalid start position throws an exception.\n   *\/",79],["T_WHITESPACE","\n  ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","testDedupeEntityInvalidStart",82],"(",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$configuration",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_WHITESPACE","\n      ",83],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'test_entity_type'",84],",",["T_WHITESPACE","\n      ",84],["T_CONSTANT_ENCAPSED_STRING","'field'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'test_field'",85],",",["T_WHITESPACE","\n      ",85],["T_CONSTANT_ENCAPSED_STRING","'start'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'foobar'",86],",",["T_WHITESPACE","\n    ",86],")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$plugin",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_STRING","DedupeEntity",88],"(",["T_VARIABLE","$configuration",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'dedupe_entity'",88],",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",")",",",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getMigration",88],"(",")",",",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","entityQueryFactory",88],")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","setExpectedException",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\migrate\\MigrateException'",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'The start position configuration key should be an integer. Omit this key to capture from the beginning of the string.'",89],")",";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$plugin",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","transform",90],"(",["T_CONSTANT_ENCAPSED_STRING","'test_start'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","migrateExecutable",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","row",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'testproperty'",90],")",";",["T_WHITESPACE","\n  ",90],"}",["T_WHITESPACE","\n\n  ",91],["T_DOC_COMMENT","\/**\n   * Tests that invalid length option throws an exception.\n   *\/",93],["T_WHITESPACE","\n  ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","testDedupeEntityInvalidLength",96],"(",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$configuration",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_ARRAY","array",97],"(",["T_WHITESPACE","\n      ",97],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'test_entity_type'",98],",",["T_WHITESPACE","\n      ",98],["T_CONSTANT_ENCAPSED_STRING","'field'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'test_field'",99],",",["T_WHITESPACE","\n      ",99],["T_CONSTANT_ENCAPSED_STRING","'length'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'foobar'",100],",",["T_WHITESPACE","\n    ",100],")",";",["T_WHITESPACE","\n    ",101],["T_VARIABLE","$plugin",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_STRING","DedupeEntity",102],"(",["T_VARIABLE","$configuration",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'dedupe_entity'",102],",",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",")",",",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getMigration",102],"(",")",",",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","entityQueryFactory",102],")",";",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","setExpectedException",103],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\migrate\\MigrateException'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'The character length configuration key should be an integer. Omit this key to capture the entire string.'",103],")",";",["T_WHITESPACE","\n    ",103],["T_VARIABLE","$plugin",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","transform",104],"(",["T_CONSTANT_ENCAPSED_STRING","'test_length'",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","migrateExecutable",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","row",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'testproperty'",104],")",";",["T_WHITESPACE","\n  ",104],"}",["T_WHITESPACE","\n\n  ",105],["T_DOC_COMMENT","\/**\n   * Data provider for testDedupe().\n   *\/",107],["T_WHITESPACE","\n  ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","providerTestDedupe",110],"(",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n    ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",["T_WHITESPACE","\n      ",111],["T_COMMENT","\/\/ Tests no duplication.\n",112],["T_WHITESPACE","      ",113],["T_ARRAY","array",113],"(",["T_LNUMBER","0",113],")",",",["T_WHITESPACE","\n      ",113],["T_COMMENT","\/\/ Tests no duplication and start position.\n",114],["T_WHITESPACE","      ",115],["T_ARRAY","array",115],"(",["T_LNUMBER","0",115],",",["T_WHITESPACE"," ",115],["T_STRING","NULL",115],",",["T_WHITESPACE"," ",115],["T_LNUMBER","10",115],")",",",["T_WHITESPACE","\n      ",115],["T_COMMENT","\/\/ Tests no duplication, start position, and length.\n",116],["T_WHITESPACE","      ",117],["T_ARRAY","array",117],"(",["T_LNUMBER","0",117],",",["T_WHITESPACE"," ",117],["T_STRING","NULL",117],",",["T_WHITESPACE"," ",117],["T_LNUMBER","5",117],",",["T_WHITESPACE"," ",117],["T_LNUMBER","10",117],")",",",["T_WHITESPACE","\n      ",117],["T_COMMENT","\/\/ Tests no duplication and length.\n",118],["T_WHITESPACE","      ",119],["T_ARRAY","array",119],"(",["T_LNUMBER","0",119],",",["T_WHITESPACE"," ",119],["T_STRING","NULL",119],",",["T_WHITESPACE"," ",119],["T_STRING","NULL",119],",",["T_WHITESPACE"," ",119],["T_LNUMBER","10",119],")",",",["T_WHITESPACE","\n      ",119],["T_COMMENT","\/\/ Tests duplication.\n",120],["T_WHITESPACE","      ",121],["T_ARRAY","array",121],"(",["T_LNUMBER","3",121],")",",",["T_WHITESPACE","\n      ",121],["T_COMMENT","\/\/ Tests duplication and start position.\n",122],["T_WHITESPACE","      ",123],["T_ARRAY","array",123],"(",["T_LNUMBER","3",123],",",["T_WHITESPACE"," ",123],["T_STRING","NULL",123],",",["T_WHITESPACE"," ",123],["T_LNUMBER","10",123],")",",",["T_WHITESPACE","\n      ",123],["T_COMMENT","\/\/ Tests duplication, start position, and length.\n",124],["T_WHITESPACE","      ",125],["T_ARRAY","array",125],"(",["T_LNUMBER","3",125],",",["T_WHITESPACE"," ",125],["T_STRING","NULL",125],",",["T_WHITESPACE"," ",125],["T_LNUMBER","5",125],",",["T_WHITESPACE"," ",125],["T_LNUMBER","10",125],")",",",["T_WHITESPACE","\n      ",125],["T_COMMENT","\/\/ Tests duplication and length.\n",126],["T_WHITESPACE","      ",127],["T_ARRAY","array",127],"(",["T_LNUMBER","3",127],",",["T_WHITESPACE"," ",127],["T_STRING","NULL",127],",",["T_WHITESPACE"," ",127],["T_STRING","NULL",127],",",["T_WHITESPACE"," ",127],["T_LNUMBER","10",127],")",",",["T_WHITESPACE","\n      ",127],["T_COMMENT","\/\/ Tests no duplication and postfix.\n",128],["T_WHITESPACE","      ",129],["T_ARRAY","array",129],"(",["T_LNUMBER","0",129],",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'_'",129],")",",",["T_WHITESPACE","\n      ",129],["T_COMMENT","\/\/ Tests no duplication, postfix, and start position.\n",130],["T_WHITESPACE","      ",131],["T_ARRAY","array",131],"(",["T_LNUMBER","0",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'_'",131],",",["T_WHITESPACE"," ",131],["T_LNUMBER","5",131],")",",",["T_WHITESPACE","\n      ",131],["T_COMMENT","\/\/ Tests no duplication, postfix, start position, and length.\n",132],["T_WHITESPACE","      ",133],["T_ARRAY","array",133],"(",["T_LNUMBER","0",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'_'",133],",",["T_WHITESPACE"," ",133],["T_LNUMBER","5",133],",",["T_WHITESPACE"," ",133],["T_LNUMBER","10",133],")",",",["T_WHITESPACE","\n      ",133],["T_COMMENT","\/\/ Tests no duplication, postfix, and length.\n",134],["T_WHITESPACE","      ",135],["T_ARRAY","array",135],"(",["T_LNUMBER","0",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'_'",135],",",["T_WHITESPACE"," ",135],["T_STRING","NULL",135],",",["T_WHITESPACE"," ",135],["T_LNUMBER","10",135],")",",",["T_WHITESPACE","\n      ",135],["T_COMMENT","\/\/ Tests duplication and postfix.\n",136],["T_WHITESPACE","      ",137],["T_ARRAY","array",137],"(",["T_LNUMBER","2",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'_'",137],")",",",["T_WHITESPACE","\n      ",137],["T_COMMENT","\/\/ Tests duplication, postfix, and start position.\n",138],["T_WHITESPACE","      ",139],["T_ARRAY","array",139],"(",["T_LNUMBER","2",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'_'",139],",",["T_WHITESPACE"," ",139],["T_LNUMBER","5",139],")",",",["T_WHITESPACE","\n      ",139],["T_COMMENT","\/\/ Tests duplication, postfix, start position, and length.\n",140],["T_WHITESPACE","      ",141],["T_ARRAY","array",141],"(",["T_LNUMBER","2",141],",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'_'",141],",",["T_WHITESPACE"," ",141],["T_LNUMBER","5",141],",",["T_WHITESPACE"," ",141],["T_LNUMBER","10",141],")",",",["T_WHITESPACE","\n      ",141],["T_COMMENT","\/\/ Tests duplication, postfix, and length.\n",142],["T_WHITESPACE","      ",143],["T_ARRAY","array",143],"(",["T_LNUMBER","2",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'_'",143],",",["T_WHITESPACE"," ",143],["T_STRING","NULL",143],",",["T_WHITESPACE"," ",143],["T_LNUMBER","10",143],")",",",["T_WHITESPACE","\n    ",143],")",";",["T_WHITESPACE","\n  ",144],"}",["T_WHITESPACE","\n\n  ",145],["T_DOC_COMMENT","\/**\n   * Helper function to add expectations to the mock entity query object.\n   *\n   * @param int $count\n   *   The number of deduplications to be set up.\n   *\/",147],["T_WHITESPACE","\n  ",152],["T_PROTECTED","protected",153],["T_WHITESPACE"," ",153],["T_FUNCTION","function",153],["T_WHITESPACE"," ",153],["T_STRING","entityQueryExpects",153],"(",["T_VARIABLE","$count",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","entityQuery",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","expects",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","exactly",154],"(",["T_VARIABLE","$count",154],["T_WHITESPACE"," ",154],"+",["T_WHITESPACE"," ",154],["T_LNUMBER","1",154],")",")",["T_WHITESPACE","\n      ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","method",155],"(",["T_CONSTANT_ENCAPSED_STRING","'condition'",155],")",["T_WHITESPACE","\n      ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","will",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","returnValue",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","entityQuery",156],")",")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","entityQuery",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","expects",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","exactly",157],"(",["T_VARIABLE","$count",157],["T_WHITESPACE"," ",157],"+",["T_WHITESPACE"," ",157],["T_LNUMBER","1",157],")",")",["T_WHITESPACE","\n      ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","method",158],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",158],")",["T_WHITESPACE","\n      ",158],["T_OBJECT_OPERATOR","->",159],["T_STRING","will",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","returnValue",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","entityQuery",159],")",")",";",["T_WHITESPACE","\n    ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","entityQuery",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","expects",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","exactly",160],"(",["T_VARIABLE","$count",160],["T_WHITESPACE"," ",160],"+",["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],")",")",["T_WHITESPACE","\n      ",160],["T_OBJECT_OPERATOR","->",161],["T_STRING","method",161],"(",["T_CONSTANT_ENCAPSED_STRING","'execute'",161],")",["T_WHITESPACE","\n      ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","will",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","returnCallback",162],"(",["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],"(",")",["T_WHITESPACE"," ",162],["T_USE","use",162],["T_WHITESPACE"," ",162],"(","&",["T_VARIABLE","$count",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE"," ",162],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$count",162],["T_DEC","--",162],";","}",")",")",";",["T_WHITESPACE","\n  ",162],"}",["T_WHITESPACE","\n\n  ",163],["T_DOC_COMMENT","\/**\n   * Test deduplicating only migrated entities.\n   *\/",165],["T_WHITESPACE","\n  ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","testDedupeMigrated",168],"(",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n    ",168],["T_VARIABLE","$configuration",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_ARRAY","array",169],"(",["T_WHITESPACE","\n      ",169],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'test_entity_type'",170],",",["T_WHITESPACE","\n      ",170],["T_CONSTANT_ENCAPSED_STRING","'field'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'test_field'",171],",",["T_WHITESPACE","\n      ",171],["T_CONSTANT_ENCAPSED_STRING","'migrated'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_STRING","TRUE",172],",",["T_WHITESPACE","\n    ",172],")",";",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$plugin",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_NEW","new",174],["T_WHITESPACE"," ",174],["T_STRING","DedupeEntity",174],"(",["T_VARIABLE","$configuration",174],",",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'dedupe_entity'",174],",",["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",")",",",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getMigration",174],"(",")",",",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","entityQueryFactory",174],")",";",["T_WHITESPACE","\n\n    ",174],["T_COMMENT","\/\/ Setup the entityQuery used in DedupeEntity::exists. The map, $map, is\n",176],["T_WHITESPACE","    ",177],["T_COMMENT","\/\/ an array consisting of the four input parameters to the query condition\n",177],["T_WHITESPACE","    ",178],["T_COMMENT","\/\/ method and then the query to return. Both 'forum' and\n",178],["T_WHITESPACE","    ",179],["T_COMMENT","\/\/ 'test_vocab' are existing entities. There is no 'test_vocab1'.\n",179],["T_WHITESPACE","    ",180],["T_VARIABLE","$map",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],"[","]",";",["T_WHITESPACE","\n    ",180],["T_FOREACH","foreach",181],["T_WHITESPACE"," ",181],"(","[",["T_CONSTANT_ENCAPSED_STRING","'forums'",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'test_vocab'",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'test_vocab1'",181],"]",["T_WHITESPACE"," ",181],["T_AS","as",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$id",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n      ",181],["T_VARIABLE","$query",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","prophesize",182],"(",["T_STRING","QueryInterface",182],["T_DOUBLE_COLON","::",182],["T_CLASS","class",182],")",";",["T_WHITESPACE","\n      ",182],["T_VARIABLE","$query",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","willBeConstructedWith",183],"(","[","]",")",";",["T_WHITESPACE","\n      ",183],["T_VARIABLE","$query",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","execute",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","willReturn",184],"(",["T_VARIABLE","$id",184],["T_WHITESPACE"," ",184],["T_IS_IDENTICAL","===",184],["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'test_vocab1'",184],["T_WHITESPACE"," ",184],"?",["T_WHITESPACE"," ",184],"[","]",["T_WHITESPACE"," ",184],":",["T_WHITESPACE"," ",184],"[",["T_VARIABLE","$id",184],"]",")",";",["T_WHITESPACE","\n      ",184],["T_VARIABLE","$map",185],"[","]",["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],"[",["T_CONSTANT_ENCAPSED_STRING","'test_field'",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$id",185],",",["T_WHITESPACE"," ",185],["T_STRING","NULL",185],",",["T_WHITESPACE"," ",185],["T_STRING","NULL",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$query",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","reveal",185],"(",")","]",";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n    ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","entityQuery",187],["T_WHITESPACE","\n      ",187],["T_OBJECT_OPERATOR","->",188],["T_STRING","method",188],"(",["T_CONSTANT_ENCAPSED_STRING","'condition'",188],")",["T_WHITESPACE","\n      ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","will",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","returnValueMap",189],"(",["T_VARIABLE","$map",189],")",")",";",["T_WHITESPACE","\n\n    ",189],["T_COMMENT","\/\/ Entity 'forums' is pre-existing, entity 'test_vocab' was migrated.\n",191],["T_WHITESPACE","    ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","idMap",192],["T_WHITESPACE","\n      ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","method",193],"(",["T_CONSTANT_ENCAPSED_STRING","'lookupSourceID'",193],")",["T_WHITESPACE","\n      ",193],["T_OBJECT_OPERATOR","->",194],["T_STRING","will",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","returnValueMap",194],"(","[",["T_WHITESPACE","\n        ",194],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'forums'",195],"]",",",["T_WHITESPACE"," ",195],["T_STRING","FALSE",195],"]",",",["T_WHITESPACE","\n        ",195],"[","[",["T_CONSTANT_ENCAPSED_STRING","'test_field'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'test_vocab'",196],"]",",",["T_WHITESPACE"," ",196],"[",["T_CONSTANT_ENCAPSED_STRING","'source_id'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_LNUMBER","42",196],"]","]",",",["T_WHITESPACE","\n      ",196],"]",")",")",";",["T_WHITESPACE","\n\n    ",197],["T_COMMENT","\/\/ Existing entity 'forums' was not migrated, it should not be deduplicated.\n",199],["T_WHITESPACE","    ",200],["T_VARIABLE","$actual",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$plugin",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","transform",200],"(",["T_CONSTANT_ENCAPSED_STRING","'forums'",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","migrateExecutable",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","row",200],",",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'testproperty'",200],")",";",["T_WHITESPACE","\n    ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","assertEquals",201],"(",["T_CONSTANT_ENCAPSED_STRING","'forums'",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$actual",201],",",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'Pre-existing name is re-used'",201],")",";",["T_WHITESPACE","\n\n    ",201],["T_COMMENT","\/\/ Entity 'test_vocab' was migrated, should be deduplicated.\n",203],["T_WHITESPACE","    ",204],["T_VARIABLE","$actual",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$plugin",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","transform",204],"(",["T_CONSTANT_ENCAPSED_STRING","'test_vocab'",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","migrateExecutable",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","row",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'testproperty'",204],")",";",["T_WHITESPACE","\n    ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","assertEquals",205],"(",["T_CONSTANT_ENCAPSED_STRING","'test_vocab1'",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$actual",205],",",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'Migrated name is deduplicated'",205],")",";",["T_WHITESPACE","\n  ",205],"}",["T_WHITESPACE","\n\n",206],"}",["T_WHITESPACE","\n",208]]