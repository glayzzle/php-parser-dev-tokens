[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","process",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","File",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FileSystemInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ContainerFactoryPluginInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","migrate",7],["T_NS_SEPARATOR","\\",7],["T_STRING","MigrateException",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","migrate",8],["T_NS_SEPARATOR","\\",8],["T_STRING","MigrateExecutableInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","migrate",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ProcessPluginBase",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","migrate",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Row",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","GuzzleHttp",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Client",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","DependencyInjection",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ContainerInterface",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Downloads a file from a remote location into the local file system.\n *\n * @MigrateProcessPlugin(\n *   id = \"download\"\n * )\n *\/",14],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","Download",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","ProcessPluginBase",21],["T_WHITESPACE"," ",21],["T_IMPLEMENTS","implements",21],["T_WHITESPACE"," ",21],["T_STRING","ContainerFactoryPluginInterface",21],["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * The file system service.\n   *\n   * @var \\Drupal\\Core\\File\\FileSystemInterface\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$fileSystem",28],";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * The Guzzle HTTP Client service.\n   *\n   * @var \\GuzzleHttp\\Client\n   *\/",30],["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$httpClient",35],";",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * Constructs a download process plugin.\n   *\n   * @param array $configuration\n   *   The plugin configuration.\n   * @param string $plugin_id\n   *   The plugin ID.\n   * @param mixed $plugin_definition\n   *   The plugin definition.\n   * @param \\Drupal\\Core\\File\\FileSystemInterface $file_system\n   *   The file system service.\n   * @param \\GuzzleHttp\\Client $http_client\n   *   The HTTP client.\n   *\/",37],["T_WHITESPACE","\n  ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","__construct",51],"(",["T_ARRAY","array",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$configuration",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$plugin_id",51],",",["T_WHITESPACE"," ",51],["T_ARRAY","array",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$plugin_definition",51],",",["T_WHITESPACE"," ",51],["T_STRING","FileSystemInterface",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$file_system",51],",",["T_WHITESPACE"," ",51],["T_STRING","Client",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$http_client",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$configuration",52],["T_WHITESPACE"," ",52],["T_PLUS_EQUAL","+=",52],["T_WHITESPACE"," ",52],"[",["T_WHITESPACE","\n      ",52],["T_CONSTANT_ENCAPSED_STRING","'rename'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_STRING","FALSE",53],",",["T_WHITESPACE","\n      ",53],["T_CONSTANT_ENCAPSED_STRING","'guzzle_options'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],"[","]",",",["T_WHITESPACE","\n    ",54],"]",";",["T_WHITESPACE","\n    ",55],["T_STRING","parent",56],["T_DOUBLE_COLON","::",56],["T_STRING","__construct",56],"(",["T_VARIABLE","$configuration",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$plugin_id",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$plugin_definition",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","fileSystem",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$file_system",57],";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","httpClient",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$http_client",58],";",["T_WHITESPACE","\n  ",58],"}",["T_WHITESPACE","\n\n  ",59],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",61],["T_WHITESPACE","\n  ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_STATIC","static",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","create",64],"(",["T_STRING","ContainerInterface",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$container",64],",",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$configuration",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$plugin_id",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$plugin_definition",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n    ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_NEW","new",65],["T_WHITESPACE"," ",65],["T_STATIC","static",65],"(",["T_WHITESPACE","\n      ",65],["T_VARIABLE","$configuration",66],",",["T_WHITESPACE","\n      ",66],["T_VARIABLE","$plugin_id",67],",",["T_WHITESPACE","\n      ",67],["T_VARIABLE","$plugin_definition",68],",",["T_WHITESPACE","\n      ",68],["T_VARIABLE","$container",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","get",69],"(",["T_CONSTANT_ENCAPSED_STRING","'file_system'",69],")",",",["T_WHITESPACE","\n      ",69],["T_VARIABLE","$container",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","get",70],"(",["T_CONSTANT_ENCAPSED_STRING","'http_client'",70],")",["T_WHITESPACE","\n    ",70],")",";",["T_WHITESPACE","\n  ",71],"}",["T_WHITESPACE","\n\n  ",72],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",74],["T_WHITESPACE","\n  ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","transform",77],"(",["T_VARIABLE","$value",77],",",["T_WHITESPACE"," ",77],["T_STRING","MigrateExecutableInterface",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$migrate_executable",77],",",["T_WHITESPACE"," ",77],["T_STRING","Row",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$row",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$destination_property",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n    ",77],["T_COMMENT","\/\/ If we're stubbing a file entity, return a uri of NULL so it will get\n",78],["T_WHITESPACE","    ",79],["T_COMMENT","\/\/ stubbed by the general process.\n",79],["T_WHITESPACE","    ",80],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$row",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","isStub",80],"(",")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n      ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_STRING","NULL",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n    ",82],["T_LIST","list",83],"(",["T_VARIABLE","$source",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$destination",83],")",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$value",83],";",["T_WHITESPACE","\n\n    ",83],["T_COMMENT","\/\/ Modify the destination filename if necessary.\n",85],["T_WHITESPACE","    ",86],["T_VARIABLE","$replace",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],"!",["T_EMPTY","empty",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","configuration",86],"[",["T_CONSTANT_ENCAPSED_STRING","'rename'",86],"]",")",["T_WHITESPACE"," ",86],"?",["T_WHITESPACE","\n      ",86],["T_STRING","FILE_EXISTS_RENAME",87],["T_WHITESPACE"," ",87],":",["T_WHITESPACE","\n      ",87],["T_STRING","FILE_EXISTS_REPLACE",88],";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$final_destination",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","file_destination",89],"(",["T_VARIABLE","$destination",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$replace",89],")",";",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ Try opening the file first, to avoid calling file_prepare_directory()\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/ unnecessarily. We're suppressing fopen() errors because we want to try\n",92],["T_WHITESPACE","    ",93],["T_COMMENT","\/\/ to prepare the directory before we give up and fail.\n",93],["T_WHITESPACE","    ",94],["T_VARIABLE","$destination_stream",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],"@",["T_STRING","fopen",94],"(",["T_VARIABLE","$final_destination",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'w'",94],")",";",["T_WHITESPACE","\n    ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(","!",["T_VARIABLE","$destination_stream",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n      ",95],["T_COMMENT","\/\/ If fopen didn't work, make sure there's a writable directory in place.\n",96],["T_WHITESPACE","      ",97],["T_VARIABLE","$dir",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","fileSystem",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","dirname",97],"(",["T_VARIABLE","$final_destination",97],")",";",["T_WHITESPACE","\n      ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_STRING","file_prepare_directory",98],"(",["T_VARIABLE","$dir",98],",",["T_WHITESPACE"," ",98],["T_STRING","FILE_CREATE_DIRECTORY",98],["T_WHITESPACE"," ",98],"|",["T_WHITESPACE"," ",98],["T_STRING","FILE_MODIFY_PERMISSIONS",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n        ",98],["T_THROW","throw",99],["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_STRING","MigrateException",99],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Could not create or write to directory '",99],["T_VARIABLE","$dir",99],["T_ENCAPSED_AND_WHITESPACE","'",99],"\"",")",";",["T_WHITESPACE","\n      ",99],"}",["T_WHITESPACE","\n      ",100],["T_COMMENT","\/\/ Let's try that fopen again.\n",101],["T_WHITESPACE","      ",102],["T_VARIABLE","$destination_stream",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],"@",["T_STRING","fopen",102],"(",["T_VARIABLE","$final_destination",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'w'",102],")",";",["T_WHITESPACE","\n      ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!",["T_VARIABLE","$destination_stream",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n        ",103],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_STRING","MigrateException",104],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Could not write to file '",104],["T_VARIABLE","$final_destination",104],["T_ENCAPSED_AND_WHITESPACE","'",104],"\"",")",";",["T_WHITESPACE","\n      ",104],"}",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_COMMENT","\/\/ Stream the request body directly to the final destination stream.\n",108],["T_WHITESPACE","    ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","configuration",109],"[",["T_CONSTANT_ENCAPSED_STRING","'guzzle_options'",109],"]","[",["T_CONSTANT_ENCAPSED_STRING","'sink'",109],"]",["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$destination_stream",109],";",["T_WHITESPACE","\n\n    ",109],["T_TRY","try",111],["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n      ",111],["T_COMMENT","\/\/ Make the request. Guzzle throws an exception for anything but 200.\n",112],["T_WHITESPACE","      ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","httpClient",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","get",113],"(",["T_VARIABLE","$source",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","configuration",113],"[",["T_CONSTANT_ENCAPSED_STRING","'guzzle_options'",113],"]",")",";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n    ",114],["T_CATCH","catch",115],["T_WHITESPACE"," ",115],"(",["T_NS_SEPARATOR","\\",115],["T_STRING","Exception",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$e",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n      ",115],["T_THROW","throw",116],["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_STRING","MigrateException",116],"(","\"",["T_CURLY_OPEN","{",116],["T_VARIABLE","$e",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getMessage",116],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," (",116],["T_VARIABLE","$source",116],["T_ENCAPSED_AND_WHITESPACE",")",116],"\"",")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$final_destination",119],";",["T_WHITESPACE","\n  ",119],"}",["T_WHITESPACE","\n\n",120],"}",["T_WHITESPACE","\n",122]]