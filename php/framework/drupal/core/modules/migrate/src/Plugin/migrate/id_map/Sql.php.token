[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","id_map",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Unicode",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Field",6],["T_NS_SEPARATOR","\\",6],["T_STRING","BaseFieldDefinition",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Plugin",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ContainerFactoryPluginInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],["T_NS_SEPARATOR","\\",8],["T_STRING","PluginBase",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","migrate",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Plugin",9],["T_NS_SEPARATOR","\\",9],["T_STRING","MigrationInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","migrate",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Event",10],["T_NS_SEPARATOR","\\",10],["T_STRING","MigrateIdMapMessageEvent",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","migrate",11],["T_NS_SEPARATOR","\\",11],["T_STRING","MigrateException",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","migrate",12],["T_NS_SEPARATOR","\\",12],["T_STRING","MigrateMessageInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Drupal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","migrate",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Plugin",13],["T_NS_SEPARATOR","\\",13],["T_STRING","MigrateIdMapInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Drupal",14],["T_NS_SEPARATOR","\\",14],["T_STRING","migrate",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Row",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Drupal",15],["T_NS_SEPARATOR","\\",15],["T_STRING","migrate",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Event",15],["T_NS_SEPARATOR","\\",15],["T_STRING","MigrateEvents",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Drupal",16],["T_NS_SEPARATOR","\\",16],["T_STRING","migrate",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Event",16],["T_NS_SEPARATOR","\\",16],["T_STRING","MigrateMapSaveEvent",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Drupal",17],["T_NS_SEPARATOR","\\",17],["T_STRING","migrate",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Event",17],["T_NS_SEPARATOR","\\",17],["T_STRING","MigrateMapDeleteEvent",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","DependencyInjection",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ContainerInterface",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","EventDispatcher",19],["T_NS_SEPARATOR","\\",19],["T_STRING","EventDispatcherInterface",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * Defines the sql based ID map implementation.\n *\n * It creates one map and one message table per migration entity to store the\n * relevant information.\n *\n * @PluginID(\"sql\")\n *\/",21],["T_WHITESPACE","\n",28],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","Sql",29],["T_WHITESPACE"," ",29],["T_EXTENDS","extends",29],["T_WHITESPACE"," ",29],["T_STRING","PluginBase",29],["T_WHITESPACE"," ",29],["T_IMPLEMENTS","implements",29],["T_WHITESPACE"," ",29],["T_STRING","MigrateIdMapInterface",29],",",["T_WHITESPACE"," ",29],["T_STRING","ContainerFactoryPluginInterface",29],["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * Column name of hashed source id values.\n   *\/",31],["T_WHITESPACE","\n  ",33],["T_CONST","const",34],["T_WHITESPACE"," ",34],["T_STRING","SOURCE_IDS_HASH",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'source_ids_hash'",34],";",["T_WHITESPACE","\n\n  ",34],["T_DOC_COMMENT","\/**\n   * An event dispatcher instance to use for map events.\n   *\n   * @var \\Symfony\\Component\\EventDispatcher\\EventDispatcherInterface\n   *\/",36],["T_WHITESPACE","\n  ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$eventDispatcher",41],";",["T_WHITESPACE","\n\n  ",41],["T_DOC_COMMENT","\/**\n   * The migration map table name.\n   *\n   * @var string\n   *\/",43],["T_WHITESPACE","\n  ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$mapTableName",48],";",["T_WHITESPACE","\n\n  ",48],["T_DOC_COMMENT","\/**\n   * The message table name.\n   *\n   * @var string\n   *\/",50],["T_WHITESPACE","\n  ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$messageTableName",55],";",["T_WHITESPACE","\n\n  ",55],["T_DOC_COMMENT","\/**\n   * The migrate message.\n   *\n   * @var \\Drupal\\migrate\\MigrateMessageInterface\n   *\/",57],["T_WHITESPACE","\n  ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$message",62],";",["T_WHITESPACE","\n\n  ",62],["T_DOC_COMMENT","\/**\n   * The database connection for the map\/message tables on the destination.\n   *\n   * @var \\Drupal\\Core\\Database\\Connection\n   *\/",64],["T_WHITESPACE","\n  ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$database",69],";",["T_WHITESPACE","\n\n  ",69],["T_DOC_COMMENT","\/**\n   * The select query.\n   *\n   * @var \\Drupal\\Core\\Database\\Query\\SelectInterface\n   *\/",71],["T_WHITESPACE","\n  ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$query",76],";",["T_WHITESPACE","\n\n  ",76],["T_DOC_COMMENT","\/**\n   * The migration being done.\n   *\n   * @var \\Drupal\\migrate\\Plugin\\MigrationInterface\n   *\/",78],["T_WHITESPACE","\n  ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$migration",83],";",["T_WHITESPACE","\n\n  ",83],["T_DOC_COMMENT","\/**\n   * The source ID fields.\n   *\n   * @var array\n   *\/",85],["T_WHITESPACE","\n  ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$sourceIdFields",90],";",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * The destination ID fields.\n   *\n   * @var array\n   *\/",92],["T_WHITESPACE","\n  ",96],["T_PROTECTED","protected",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$destinationIdFields",97],";",["T_WHITESPACE","\n\n  ",97],["T_DOC_COMMENT","\/**\n   * Whether the plugin is already initialized.\n   *\n   * @var bool\n   *\/",99],["T_WHITESPACE","\n  ",103],["T_PROTECTED","protected",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$initialized",104],";",["T_WHITESPACE","\n\n  ",104],["T_DOC_COMMENT","\/**\n   * The result.\n   *\n   * @var null\n   *\/",106],["T_WHITESPACE","\n  ",110],["T_PROTECTED","protected",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$result",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","NULL",111],";",["T_WHITESPACE","\n\n  ",111],["T_DOC_COMMENT","\/**\n   * The source identifiers.\n   *\n   * @var array\n   *\/",113],["T_WHITESPACE","\n  ",117],["T_PROTECTED","protected",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$sourceIds",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_ARRAY","array",118],"(",")",";",["T_WHITESPACE","\n\n  ",118],["T_DOC_COMMENT","\/**\n   * The destination identifiers.\n   *\n   * @var array\n   *\/",120],["T_WHITESPACE","\n  ",124],["T_PROTECTED","protected",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$destinationIds",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_ARRAY","array",125],"(",")",";",["T_WHITESPACE","\n\n  ",125],["T_DOC_COMMENT","\/**\n   * The current row.\n   *\n   * @var null\n   *\/",127],["T_WHITESPACE","\n  ",131],["T_PROTECTED","protected",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$currentRow",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","NULL",132],";",["T_WHITESPACE","\n\n  ",132],["T_DOC_COMMENT","\/**\n   * The current key.\n   *\n   * @var array\n   *\/",134],["T_WHITESPACE","\n  ",138],["T_PROTECTED","protected",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$currentKey",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_ARRAY","array",139],"(",")",";",["T_WHITESPACE","\n\n  ",139],["T_DOC_COMMENT","\/**\n   * Constructs an SQL object.\n   *\n   * Sets up the tables and builds the maps,\n   *\n   * @param array $configuration\n   *   The configuration.\n   * @param string $plugin_id\n   *   The plugin ID for the migration process to do.\n   * @param mixed $plugin_definition\n   *   The configuration for the plugin.\n   * @param \\Drupal\\migrate\\Plugin\\MigrationInterface $migration\n   *   The migration to do.\n   *\/",141],["T_WHITESPACE","\n  ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","__construct",155],"(",["T_ARRAY","array",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$configuration",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$plugin_id",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$plugin_definition",155],",",["T_WHITESPACE"," ",155],["T_STRING","MigrationInterface",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$migration",155],",",["T_WHITESPACE"," ",155],["T_STRING","EventDispatcherInterface",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$event_dispatcher",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n    ",155],["T_STRING","parent",156],["T_DOUBLE_COLON","::",156],["T_STRING","__construct",156],"(",["T_VARIABLE","$configuration",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$plugin_id",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$plugin_definition",156],")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","migration",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$migration",157],";",["T_WHITESPACE","\n    ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","eventDispatcher",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$event_dispatcher",158],";",["T_WHITESPACE","\n  ",158],"}",["T_WHITESPACE","\n\n  ",159],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",161],["T_WHITESPACE","\n  ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_STATIC","static",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","create",164],"(",["T_STRING","ContainerInterface",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$container",164],",",["T_WHITESPACE"," ",164],["T_ARRAY","array",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$configuration",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$plugin_id",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$plugin_definition",164],",",["T_WHITESPACE"," ",164],["T_STRING","MigrationInterface",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$migration",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","NULL",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n    ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_NEW","new",165],["T_WHITESPACE"," ",165],["T_STATIC","static",165],"(",["T_WHITESPACE","\n      ",165],["T_VARIABLE","$configuration",166],",",["T_WHITESPACE","\n      ",166],["T_VARIABLE","$plugin_id",167],",",["T_WHITESPACE","\n      ",167],["T_VARIABLE","$plugin_definition",168],",",["T_WHITESPACE","\n      ",168],["T_VARIABLE","$migration",169],",",["T_WHITESPACE","\n      ",169],["T_VARIABLE","$container",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","get",170],"(",["T_CONSTANT_ENCAPSED_STRING","'event_dispatcher'",170],")",["T_WHITESPACE","\n    ",170],")",";",["T_WHITESPACE","\n  ",171],"}",["T_WHITESPACE","\n\n  ",172],["T_DOC_COMMENT","\/**\n   * Retrieves the hash of the source identifier values.\n   *\n   * It is public only for testing purposes.\n   *\n   * @param array $source_id_values\n   *   The source identifiers\n   *\n   * @return string\n   *   An hash containing the hashed values of the source identifiers.\n   *\/",174],["T_WHITESPACE","\n  ",184],["T_PUBLIC","public",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","getSourceIDsHash",185],"(",["T_ARRAY","array",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$source_id_values",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n    ",185],["T_COMMENT","\/\/ When looking up the destination ID we require an array with both the\n",186],["T_WHITESPACE","    ",187],["T_COMMENT","\/\/ source key and value, e.g. ['nid' => 41]. In this case, $source_id_values\n",187],["T_WHITESPACE","    ",188],["T_COMMENT","\/\/ need to be ordered the same order as $this->sourceIdFields().\n",188],["T_WHITESPACE","    ",189],["T_COMMENT","\/\/ However, the Migration process plugin doesn't currently have a way to get\n",189],["T_WHITESPACE","    ",190],["T_COMMENT","\/\/ the source key so we presume the values have been passed through in the\n",190],["T_WHITESPACE","    ",191],["T_COMMENT","\/\/ correct order.\n",191],["T_WHITESPACE","    ",192],["T_IF","if",192],["T_WHITESPACE"," ",192],"(","!",["T_ISSET","isset",192],"(",["T_VARIABLE","$source_id_values",192],"[",["T_LNUMBER","0",192],"]",")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n      ",192],["T_VARIABLE","$source_id_values_keyed",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],"[","]",";",["T_WHITESPACE","\n      ",193],["T_FOREACH","foreach",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","sourceIdFields",194],"(",")",["T_WHITESPACE"," ",194],["T_AS","as",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$field_name",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$source_id",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$source_id_values_keyed",195],"[","]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$source_id_values",195],"[",["T_VARIABLE","$field_name",195],"]",";",["T_WHITESPACE","\n      ",195],"}",["T_WHITESPACE","\n      ",196],["T_VARIABLE","$source_id_values",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$source_id_values_keyed",197],";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n    ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_STRING","hash",199],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",199],",",["T_WHITESPACE"," ",199],["T_STRING","serialize",199],"(",["T_STRING","array_map",199],"(",["T_CONSTANT_ENCAPSED_STRING","'strval'",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$source_id_values",199],")",")",")",";",["T_WHITESPACE","\n  ",199],"}",["T_WHITESPACE","\n\n  ",200],["T_DOC_COMMENT","\/**\n   * The source ID fields.\n   *\n   * @return array\n   *   The source ID fields.\n   *\/",202],["T_WHITESPACE","\n  ",207],["T_PROTECTED","protected",208],["T_WHITESPACE"," ",208],["T_FUNCTION","function",208],["T_WHITESPACE"," ",208],["T_STRING","sourceIdFields",208],"(",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n    ",208],["T_IF","if",209],["T_WHITESPACE"," ",209],"(","!",["T_ISSET","isset",209],"(",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","sourceIdFields",209],")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n      ",209],["T_COMMENT","\/\/ Build the source and destination identifier maps.\n",210],["T_WHITESPACE","      ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","sourceIdFields",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_ARRAY","array",211],"(",")",";",["T_WHITESPACE","\n      ",211],["T_VARIABLE","$count",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_LNUMBER","1",212],";",["T_WHITESPACE","\n      ",212],["T_FOREACH","foreach",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","migration",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getSourcePlugin",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","getIds",213],"(",")",["T_WHITESPACE"," ",213],["T_AS","as",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$field",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$schema",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","sourceIdFields",214],"[",["T_VARIABLE","$field",214],"]",["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'sourceid'",214],["T_WHITESPACE"," ",214],".",["T_WHITESPACE"," ",214],["T_VARIABLE","$count",214],["T_INC","++",214],";",["T_WHITESPACE","\n      ",214],"}",["T_WHITESPACE","\n    ",215],"}",["T_WHITESPACE","\n    ",216],["T_RETURN","return",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","sourceIdFields",217],";",["T_WHITESPACE","\n  ",217],"}",["T_WHITESPACE","\n\n  ",218],["T_DOC_COMMENT","\/**\n   * The destination ID fields.\n   *\n   * @return array\n   *   The destination ID fields.\n   *\/",220],["T_WHITESPACE","\n  ",225],["T_PROTECTED","protected",226],["T_WHITESPACE"," ",226],["T_FUNCTION","function",226],["T_WHITESPACE"," ",226],["T_STRING","destinationIdFields",226],"(",")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n    ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(","!",["T_ISSET","isset",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","destinationIdFields",227],")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n      ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","destinationIdFields",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_ARRAY","array",228],"(",")",";",["T_WHITESPACE","\n      ",228],["T_VARIABLE","$count",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_LNUMBER","1",229],";",["T_WHITESPACE","\n      ",229],["T_FOREACH","foreach",230],["T_WHITESPACE"," ",230],"(",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","migration",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getDestinationPlugin",230],"(",")",["T_OBJECT_OPERATOR","->",230],["T_STRING","getIds",230],"(",")",["T_WHITESPACE"," ",230],["T_AS","as",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$field",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$schema",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","destinationIdFields",231],"[",["T_VARIABLE","$field",231],"]",["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'destid'",231],["T_WHITESPACE"," ",231],".",["T_WHITESPACE"," ",231],["T_VARIABLE","$count",231],["T_INC","++",231],";",["T_WHITESPACE","\n      ",231],"}",["T_WHITESPACE","\n    ",232],"}",["T_WHITESPACE","\n    ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","destinationIdFields",234],";",["T_WHITESPACE","\n  ",234],"}",["T_WHITESPACE","\n\n  ",235],["T_DOC_COMMENT","\/**\n   * The name of the database map table.\n   *\n   * @return string\n   *   The map table name.\n   *\/",237],["T_WHITESPACE","\n  ",242],["T_PUBLIC","public",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","mapTableName",243],"(",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","init",244],"(",")",";",["T_WHITESPACE","\n    ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","mapTableName",245],";",["T_WHITESPACE","\n  ",245],"}",["T_WHITESPACE","\n\n  ",246],["T_DOC_COMMENT","\/**\n   * The name of the database message table.\n   *\n   * @return string\n   *   The message table name.\n   *\/",248],["T_WHITESPACE","\n  ",253],["T_PUBLIC","public",254],["T_WHITESPACE"," ",254],["T_FUNCTION","function",254],["T_WHITESPACE"," ",254],["T_STRING","messageTableName",254],"(",")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n    ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","init",255],"(",")",";",["T_WHITESPACE","\n    ",255],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","messageTableName",256],";",["T_WHITESPACE","\n  ",256],"}",["T_WHITESPACE","\n\n  ",257],["T_DOC_COMMENT","\/**\n   * Get the fully qualified map table name.\n   *\n   * @return string\n   *   The fully qualified map table name.\n   *\/",259],["T_WHITESPACE","\n  ",264],["T_PUBLIC","public",265],["T_WHITESPACE"," ",265],["T_FUNCTION","function",265],["T_WHITESPACE"," ",265],["T_STRING","getQualifiedMapTableName",265],"(",")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n    ",265],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getDatabase",266],"(",")",["T_OBJECT_OPERATOR","->",266],["T_STRING","getFullQualifiedTableName",266],"(",["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","mapTableName",266],")",";",["T_WHITESPACE","\n  ",266],"}",["T_WHITESPACE","\n\n  ",267],["T_DOC_COMMENT","\/**\n   * Gets the database connection.\n   *\n   * @return \\Drupal\\Core\\Database\\Connection\n   *   The database connection object.\n   *\/",269],["T_WHITESPACE","\n  ",274],["T_PUBLIC","public",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","getDatabase",275],"(",")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n    ",275],["T_IF","if",276],["T_WHITESPACE"," ",276],"(","!",["T_ISSET","isset",276],"(",["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","database",276],")",")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n      ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","database",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_NS_SEPARATOR","\\",277],["T_STRING","Drupal",277],["T_DOUBLE_COLON","::",277],["T_STRING","database",277],"(",")",";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n    ",278],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","init",279],"(",")",";",["T_WHITESPACE","\n    ",279],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","database",280],";",["T_WHITESPACE","\n  ",280],"}",["T_WHITESPACE","\n\n  ",281],["T_DOC_COMMENT","\/**\n   * Initialize the plugin.\n   *\/",283],["T_WHITESPACE","\n  ",285],["T_PROTECTED","protected",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","init",286],"(",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n    ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(","!",["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","initialized",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n      ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","initialized",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_STRING","TRUE",288],";",["T_WHITESPACE","\n      ",288],["T_COMMENT","\/\/ Default generated table names, limited to 63 characters.\n",289],["T_WHITESPACE","      ",290],["T_VARIABLE","$machine_name",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","str_replace",290],"(",["T_CONSTANT_ENCAPSED_STRING","':'",290],",",["T_WHITESPACE"," ",290],["T_CONSTANT_ENCAPSED_STRING","'__'",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","migration",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","id",290],"(",")",")",";",["T_WHITESPACE","\n      ",290],["T_VARIABLE","$prefix_length",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","strlen",291],"(",["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getDatabase",291],"(",")",["T_OBJECT_OPERATOR","->",291],["T_STRING","tablePrefix",291],"(",")",")",";",["T_WHITESPACE","\n      ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","mapTableName",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'migrate_map_'",292],["T_WHITESPACE"," ",292],".",["T_WHITESPACE"," ",292],["T_STRING","Unicode",292],["T_DOUBLE_COLON","::",292],["T_STRING","strtolower",292],"(",["T_VARIABLE","$machine_name",292],")",";",["T_WHITESPACE","\n      ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","mapTableName",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_STRING","Unicode",293],["T_DOUBLE_COLON","::",293],["T_STRING","substr",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","mapTableName",293],",",["T_WHITESPACE"," ",293],["T_LNUMBER","0",293],",",["T_WHITESPACE"," ",293],["T_LNUMBER","63",293],["T_WHITESPACE"," ",293],"-",["T_WHITESPACE"," ",293],["T_VARIABLE","$prefix_length",293],")",";",["T_WHITESPACE","\n      ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","messageTableName",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'migrate_message_'",294],["T_WHITESPACE"," ",294],".",["T_WHITESPACE"," ",294],["T_STRING","Unicode",294],["T_DOUBLE_COLON","::",294],["T_STRING","strtolower",294],"(",["T_VARIABLE","$machine_name",294],")",";",["T_WHITESPACE","\n      ",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","messageTableName",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_STRING","Unicode",295],["T_DOUBLE_COLON","::",295],["T_STRING","substr",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","messageTableName",295],",",["T_WHITESPACE"," ",295],["T_LNUMBER","0",295],",",["T_WHITESPACE"," ",295],["T_LNUMBER","63",295],["T_WHITESPACE"," ",295],"-",["T_WHITESPACE"," ",295],["T_VARIABLE","$prefix_length",295],")",";",["T_WHITESPACE","\n      ",295],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","ensureTables",296],"(",")",";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n  ",297],"}",["T_WHITESPACE","\n\n  ",298],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",300],["T_WHITESPACE","\n  ",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","setMessage",303],"(",["T_STRING","MigrateMessageInterface",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$message",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n    ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","message",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$message",304],";",["T_WHITESPACE","\n  ",304],"}",["T_WHITESPACE","\n\n  ",305],["T_DOC_COMMENT","\/**\n   * Create the map and message tables if they don't already exist.\n   *\/",307],["T_WHITESPACE","\n  ",309],["T_PROTECTED","protected",310],["T_WHITESPACE"," ",310],["T_FUNCTION","function",310],["T_WHITESPACE"," ",310],["T_STRING","ensureTables",310],"(",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n    ",310],["T_IF","if",311],["T_WHITESPACE"," ",311],"(","!",["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getDatabase",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","schema",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","tableExists",311],"(",["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","mapTableName",311],")",")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n      ",311],["T_COMMENT","\/\/ Generate appropriate schema info for the map and message tables,\n",312],["T_WHITESPACE","      ",313],["T_COMMENT","\/\/ and map from the source field names to the map\/msg field names.\n",313],["T_WHITESPACE","      ",314],["T_VARIABLE","$count",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_LNUMBER","1",314],";",["T_WHITESPACE","\n      ",314],["T_VARIABLE","$source_id_schema",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_ARRAY","array",315],"(",")",";",["T_WHITESPACE","\n      ",315],["T_FOREACH","foreach",316],["T_WHITESPACE"," ",316],"(",["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","migration",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getSourcePlugin",316],"(",")",["T_OBJECT_OPERATOR","->",316],["T_STRING","getIds",316],"(",")",["T_WHITESPACE"," ",316],["T_AS","as",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$id_definition",316],")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n        ",316],["T_VARIABLE","$mapkey",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'sourceid'",317],["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_VARIABLE","$count",317],["T_INC","++",317],";",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$source_id_schema",318],"[",["T_VARIABLE","$mapkey",318],"]",["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getFieldSchema",318],"(",["T_VARIABLE","$id_definition",318],")",";",["T_WHITESPACE","\n        ",318],["T_VARIABLE","$source_id_schema",319],"[",["T_VARIABLE","$mapkey",319],"]","[",["T_CONSTANT_ENCAPSED_STRING","'not null'",319],"]",["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_STRING","TRUE",319],";",["T_WHITESPACE","\n      ",319],"}",["T_WHITESPACE","\n\n      ",320],["T_VARIABLE","$source_ids_hash",322],"[",["T_STATIC","static",322],["T_DOUBLE_COLON","::",322],["T_STRING","SOURCE_IDS_HASH",322],"]",["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_ARRAY","array",322],"(",["T_WHITESPACE","\n        ",322],["T_CONSTANT_ENCAPSED_STRING","'type'",323],["T_WHITESPACE"," ",323],["T_DOUBLE_ARROW","=>",323],["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'varchar'",323],",",["T_WHITESPACE","\n        ",323],["T_CONSTANT_ENCAPSED_STRING","'length'",324],["T_WHITESPACE"," ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","'64'",324],",",["T_WHITESPACE","\n        ",324],["T_CONSTANT_ENCAPSED_STRING","'not null'",325],["T_WHITESPACE"," ",325],["T_DOUBLE_ARROW","=>",325],["T_WHITESPACE"," ",325],["T_STRING","TRUE",325],",",["T_WHITESPACE","\n        ",325],["T_CONSTANT_ENCAPSED_STRING","'description'",326],["T_WHITESPACE"," ",326],["T_DOUBLE_ARROW","=>",326],["T_WHITESPACE"," ",326],["T_CONSTANT_ENCAPSED_STRING","'Hash of source ids. Used as primary key'",326],",",["T_WHITESPACE","\n      ",326],")",";",["T_WHITESPACE","\n      ",327],["T_VARIABLE","$fields",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$source_ids_hash",328],["T_WHITESPACE"," ",328],"+",["T_WHITESPACE"," ",328],["T_VARIABLE","$source_id_schema",328],";",["T_WHITESPACE","\n\n      ",328],["T_COMMENT","\/\/ Add destination identifiers to map table.\n",330],["T_WHITESPACE","      ",331],["T_COMMENT","\/\/ @todo How do we discover the destination schema?\n",331],["T_WHITESPACE","      ",332],["T_VARIABLE","$count",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_LNUMBER","1",332],";",["T_WHITESPACE","\n      ",332],["T_FOREACH","foreach",333],["T_WHITESPACE"," ",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","migration",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getDestinationPlugin",333],"(",")",["T_OBJECT_OPERATOR","->",333],["T_STRING","getIds",333],"(",")",["T_WHITESPACE"," ",333],["T_AS","as",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$id_definition",333],")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n        ",333],["T_COMMENT","\/\/ Allow dest identifier fields to be NULL (for IGNORED\/FAILED cases).\n",334],["T_WHITESPACE","        ",335],["T_VARIABLE","$mapkey",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'destid'",335],["T_WHITESPACE"," ",335],".",["T_WHITESPACE"," ",335],["T_VARIABLE","$count",335],["T_INC","++",335],";",["T_WHITESPACE","\n        ",335],["T_VARIABLE","$fields",336],"[",["T_VARIABLE","$mapkey",336],"]",["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getFieldSchema",336],"(",["T_VARIABLE","$id_definition",336],")",";",["T_WHITESPACE","\n        ",336],["T_VARIABLE","$fields",337],"[",["T_VARIABLE","$mapkey",337],"]","[",["T_CONSTANT_ENCAPSED_STRING","'not null'",337],"]",["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_STRING","FALSE",337],";",["T_WHITESPACE","\n      ",337],"}",["T_WHITESPACE","\n      ",338],["T_VARIABLE","$fields",339],"[",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",339],"]",["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_ARRAY","array",339],"(",["T_WHITESPACE","\n        ",339],["T_CONSTANT_ENCAPSED_STRING","'type'",340],["T_WHITESPACE"," ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'int'",340],",",["T_WHITESPACE","\n        ",340],["T_CONSTANT_ENCAPSED_STRING","'size'",341],["T_WHITESPACE"," ",341],["T_DOUBLE_ARROW","=>",341],["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'tiny'",341],",",["T_WHITESPACE","\n        ",341],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",342],["T_WHITESPACE"," ",342],["T_DOUBLE_ARROW","=>",342],["T_WHITESPACE"," ",342],["T_STRING","TRUE",342],",",["T_WHITESPACE","\n        ",342],["T_CONSTANT_ENCAPSED_STRING","'not null'",343],["T_WHITESPACE"," ",343],["T_DOUBLE_ARROW","=>",343],["T_WHITESPACE"," ",343],["T_STRING","TRUE",343],",",["T_WHITESPACE","\n        ",343],["T_CONSTANT_ENCAPSED_STRING","'default'",344],["T_WHITESPACE"," ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_STRING","MigrateIdMapInterface",344],["T_DOUBLE_COLON","::",344],["T_STRING","STATUS_IMPORTED",344],",",["T_WHITESPACE","\n        ",344],["T_CONSTANT_ENCAPSED_STRING","'description'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","'Indicates current status of the source row'",345],",",["T_WHITESPACE","\n      ",345],")",";",["T_WHITESPACE","\n      ",346],["T_VARIABLE","$fields",347],"[",["T_CONSTANT_ENCAPSED_STRING","'rollback_action'",347],"]",["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_ARRAY","array",347],"(",["T_WHITESPACE","\n        ",347],["T_CONSTANT_ENCAPSED_STRING","'type'",348],["T_WHITESPACE"," ",348],["T_DOUBLE_ARROW","=>",348],["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","'int'",348],",",["T_WHITESPACE","\n        ",348],["T_CONSTANT_ENCAPSED_STRING","'size'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'tiny'",349],",",["T_WHITESPACE","\n        ",349],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_STRING","TRUE",350],",",["T_WHITESPACE","\n        ",350],["T_CONSTANT_ENCAPSED_STRING","'not null'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_STRING","TRUE",351],",",["T_WHITESPACE","\n        ",351],["T_CONSTANT_ENCAPSED_STRING","'default'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_STRING","MigrateIdMapInterface",352],["T_DOUBLE_COLON","::",352],["T_STRING","ROLLBACK_DELETE",352],",",["T_WHITESPACE","\n        ",352],["T_CONSTANT_ENCAPSED_STRING","'description'",353],["T_WHITESPACE"," ",353],["T_DOUBLE_ARROW","=>",353],["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","'Flag indicating what to do for this item on rollback'",353],",",["T_WHITESPACE","\n      ",353],")",";",["T_WHITESPACE","\n      ",354],["T_VARIABLE","$fields",355],"[",["T_CONSTANT_ENCAPSED_STRING","'last_imported'",355],"]",["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_ARRAY","array",355],"(",["T_WHITESPACE","\n        ",355],["T_CONSTANT_ENCAPSED_STRING","'type'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","'int'",356],",",["T_WHITESPACE","\n        ",356],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_STRING","TRUE",357],",",["T_WHITESPACE","\n        ",357],["T_CONSTANT_ENCAPSED_STRING","'not null'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_STRING","TRUE",358],",",["T_WHITESPACE","\n        ",358],["T_CONSTANT_ENCAPSED_STRING","'default'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_LNUMBER","0",359],",",["T_WHITESPACE","\n        ",359],["T_CONSTANT_ENCAPSED_STRING","'description'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","'UNIX timestamp of the last time this row was imported'",360],",",["T_WHITESPACE","\n      ",360],")",";",["T_WHITESPACE","\n      ",361],["T_VARIABLE","$fields",362],"[",["T_CONSTANT_ENCAPSED_STRING","'hash'",362],"]",["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_ARRAY","array",362],"(",["T_WHITESPACE","\n        ",362],["T_CONSTANT_ENCAPSED_STRING","'type'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'varchar'",363],",",["T_WHITESPACE","\n        ",363],["T_CONSTANT_ENCAPSED_STRING","'length'",364],["T_WHITESPACE"," ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","'64'",364],",",["T_WHITESPACE","\n        ",364],["T_CONSTANT_ENCAPSED_STRING","'not null'",365],["T_WHITESPACE"," ",365],["T_DOUBLE_ARROW","=>",365],["T_WHITESPACE"," ",365],["T_STRING","FALSE",365],",",["T_WHITESPACE","\n        ",365],["T_CONSTANT_ENCAPSED_STRING","'description'",366],["T_WHITESPACE"," ",366],["T_DOUBLE_ARROW","=>",366],["T_WHITESPACE"," ",366],["T_CONSTANT_ENCAPSED_STRING","'Hash of source row data, for detecting changes'",366],",",["T_WHITESPACE","\n      ",366],")",";",["T_WHITESPACE","\n      ",367],["T_VARIABLE","$schema",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_ARRAY","array",368],"(",["T_WHITESPACE","\n        ",368],["T_CONSTANT_ENCAPSED_STRING","'description'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_CONSTANT_ENCAPSED_STRING","'Mappings from source identifier value(s) to destination identifier value(s).'",369],",",["T_WHITESPACE","\n        ",369],["T_CONSTANT_ENCAPSED_STRING","'fields'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$fields",370],",",["T_WHITESPACE","\n        ",370],["T_CONSTANT_ENCAPSED_STRING","'primary key'",371],["T_WHITESPACE"," ",371],["T_DOUBLE_ARROW","=>",371],["T_WHITESPACE"," ",371],["T_ARRAY","array",371],"(",["T_STATIC","static",371],["T_DOUBLE_COLON","::",371],["T_STRING","SOURCE_IDS_HASH",371],")",",",["T_WHITESPACE","\n      ",371],")",";",["T_WHITESPACE","\n      ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getDatabase",373],"(",")",["T_OBJECT_OPERATOR","->",373],["T_STRING","schema",373],"(",")",["T_OBJECT_OPERATOR","->",373],["T_STRING","createTable",373],"(",["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","mapTableName",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$schema",373],")",";",["T_WHITESPACE","\n\n      ",373],["T_COMMENT","\/\/ Now do the message table.\n",375],["T_WHITESPACE","      ",376],["T_IF","if",376],["T_WHITESPACE"," ",376],"(","!",["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getDatabase",376],"(",")",["T_OBJECT_OPERATOR","->",376],["T_STRING","schema",376],"(",")",["T_OBJECT_OPERATOR","->",376],["T_STRING","tableExists",376],"(",["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","messageTableName",376],"(",")",")",")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n        ",376],["T_VARIABLE","$fields",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_ARRAY","array",377],"(",")",";",["T_WHITESPACE","\n        ",377],["T_VARIABLE","$fields",378],"[",["T_CONSTANT_ENCAPSED_STRING","'msgid'",378],"]",["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_ARRAY","array",378],"(",["T_WHITESPACE","\n          ",378],["T_CONSTANT_ENCAPSED_STRING","'type'",379],["T_WHITESPACE"," ",379],["T_DOUBLE_ARROW","=>",379],["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","'serial'",379],",",["T_WHITESPACE","\n          ",379],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",380],["T_WHITESPACE"," ",380],["T_DOUBLE_ARROW","=>",380],["T_WHITESPACE"," ",380],["T_STRING","TRUE",380],",",["T_WHITESPACE","\n          ",380],["T_CONSTANT_ENCAPSED_STRING","'not null'",381],["T_WHITESPACE"," ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_STRING","TRUE",381],",",["T_WHITESPACE","\n        ",381],")",";",["T_WHITESPACE","\n        ",382],["T_VARIABLE","$fields",383],["T_WHITESPACE"," ",383],["T_PLUS_EQUAL","+=",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$source_ids_hash",383],";",["T_WHITESPACE","\n\n        ",383],["T_VARIABLE","$fields",385],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",385],"]",["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_ARRAY","array",385],"(",["T_WHITESPACE","\n          ",385],["T_CONSTANT_ENCAPSED_STRING","'type'",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_CONSTANT_ENCAPSED_STRING","'int'",386],",",["T_WHITESPACE","\n          ",386],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_STRING","TRUE",387],",",["T_WHITESPACE","\n          ",387],["T_CONSTANT_ENCAPSED_STRING","'not null'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_STRING","TRUE",388],",",["T_WHITESPACE","\n          ",388],["T_CONSTANT_ENCAPSED_STRING","'default'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_LNUMBER","1",389],",",["T_WHITESPACE","\n        ",389],")",";",["T_WHITESPACE","\n        ",390],["T_VARIABLE","$fields",391],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",391],"]",["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_ARRAY","array",391],"(",["T_WHITESPACE","\n          ",391],["T_CONSTANT_ENCAPSED_STRING","'type'",392],["T_WHITESPACE"," ",392],["T_DOUBLE_ARROW","=>",392],["T_WHITESPACE"," ",392],["T_CONSTANT_ENCAPSED_STRING","'text'",392],",",["T_WHITESPACE","\n          ",392],["T_CONSTANT_ENCAPSED_STRING","'size'",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_CONSTANT_ENCAPSED_STRING","'medium'",393],",",["T_WHITESPACE","\n          ",393],["T_CONSTANT_ENCAPSED_STRING","'not null'",394],["T_WHITESPACE"," ",394],["T_DOUBLE_ARROW","=>",394],["T_WHITESPACE"," ",394],["T_STRING","TRUE",394],",",["T_WHITESPACE","\n        ",394],")",";",["T_WHITESPACE","\n        ",395],["T_VARIABLE","$schema",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_ARRAY","array",396],"(",["T_WHITESPACE","\n          ",396],["T_CONSTANT_ENCAPSED_STRING","'description'",397],["T_WHITESPACE"," ",397],["T_DOUBLE_ARROW","=>",397],["T_WHITESPACE"," ",397],["T_CONSTANT_ENCAPSED_STRING","'Messages generated during a migration process'",397],",",["T_WHITESPACE","\n          ",397],["T_CONSTANT_ENCAPSED_STRING","'fields'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$fields",398],",",["T_WHITESPACE","\n          ",398],["T_CONSTANT_ENCAPSED_STRING","'primary key'",399],["T_WHITESPACE"," ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],["T_ARRAY","array",399],"(",["T_CONSTANT_ENCAPSED_STRING","'msgid'",399],")",",",["T_WHITESPACE","\n        ",399],")",";",["T_WHITESPACE","\n        ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getDatabase",401],"(",")",["T_OBJECT_OPERATOR","->",401],["T_STRING","schema",401],"(",")",["T_OBJECT_OPERATOR","->",401],["T_STRING","createTable",401],"(",["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","messageTableName",401],"(",")",",",["T_WHITESPACE"," ",401],["T_VARIABLE","$schema",401],")",";",["T_WHITESPACE","\n      ",401],"}",["T_WHITESPACE","\n    ",402],"}",["T_WHITESPACE","\n    ",403],["T_ELSE","else",404],["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n      ",404],["T_COMMENT","\/\/ Add any missing columns to the map table.\n",405],["T_WHITESPACE","      ",406],["T_IF","if",406],["T_WHITESPACE"," ",406],"(","!",["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getDatabase",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","schema",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","fieldExists",406],"(",["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","mapTableName",406],",",["T_WHITESPACE","\n                                                    ",406],["T_CONSTANT_ENCAPSED_STRING","'rollback_action'",407],")",")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n        ",407],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","getDatabase",408],"(",")",["T_OBJECT_OPERATOR","->",408],["T_STRING","schema",408],"(",")",["T_OBJECT_OPERATOR","->",408],["T_STRING","addField",408],"(",["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","mapTableName",408],",",["T_WHITESPACE"," ",408],["T_CONSTANT_ENCAPSED_STRING","'rollback_action'",408],",",["T_WHITESPACE","\n          ",408],["T_ARRAY","array",409],"(",["T_WHITESPACE","\n            ",409],["T_CONSTANT_ENCAPSED_STRING","'type'",410],["T_WHITESPACE"," ",410],["T_DOUBLE_ARROW","=>",410],["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","'int'",410],",",["T_WHITESPACE","\n            ",410],["T_CONSTANT_ENCAPSED_STRING","'size'",411],["T_WHITESPACE"," ",411],["T_DOUBLE_ARROW","=>",411],["T_WHITESPACE"," ",411],["T_CONSTANT_ENCAPSED_STRING","'tiny'",411],",",["T_WHITESPACE","\n            ",411],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",412],["T_WHITESPACE"," ",412],["T_DOUBLE_ARROW","=>",412],["T_WHITESPACE"," ",412],["T_STRING","TRUE",412],",",["T_WHITESPACE","\n            ",412],["T_CONSTANT_ENCAPSED_STRING","'not null'",413],["T_WHITESPACE"," ",413],["T_DOUBLE_ARROW","=>",413],["T_WHITESPACE"," ",413],["T_STRING","TRUE",413],",",["T_WHITESPACE","\n            ",413],["T_CONSTANT_ENCAPSED_STRING","'default'",414],["T_WHITESPACE"," ",414],["T_DOUBLE_ARROW","=>",414],["T_WHITESPACE"," ",414],["T_LNUMBER","0",414],",",["T_WHITESPACE","\n            ",414],["T_CONSTANT_ENCAPSED_STRING","'description'",415],["T_WHITESPACE"," ",415],["T_DOUBLE_ARROW","=>",415],["T_WHITESPACE"," ",415],["T_CONSTANT_ENCAPSED_STRING","'Flag indicating what to do for this item on rollback'",415],",",["T_WHITESPACE","\n          ",415],")",["T_WHITESPACE","\n        ",416],")",";",["T_WHITESPACE","\n      ",417],"}",["T_WHITESPACE","\n      ",418],["T_IF","if",419],["T_WHITESPACE"," ",419],"(","!",["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getDatabase",419],"(",")",["T_OBJECT_OPERATOR","->",419],["T_STRING","schema",419],"(",")",["T_OBJECT_OPERATOR","->",419],["T_STRING","fieldExists",419],"(",["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","mapTableName",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'hash'",419],")",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n        ",419],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","getDatabase",420],"(",")",["T_OBJECT_OPERATOR","->",420],["T_STRING","schema",420],"(",")",["T_OBJECT_OPERATOR","->",420],["T_STRING","addField",420],"(",["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","mapTableName",420],",",["T_WHITESPACE"," ",420],["T_CONSTANT_ENCAPSED_STRING","'hash'",420],",",["T_WHITESPACE","\n          ",420],["T_ARRAY","array",421],"(",["T_WHITESPACE","\n            ",421],["T_CONSTANT_ENCAPSED_STRING","'type'",422],["T_WHITESPACE"," ",422],["T_DOUBLE_ARROW","=>",422],["T_WHITESPACE"," ",422],["T_CONSTANT_ENCAPSED_STRING","'varchar'",422],",",["T_WHITESPACE","\n            ",422],["T_CONSTANT_ENCAPSED_STRING","'length'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'64'",423],",",["T_WHITESPACE","\n            ",423],["T_CONSTANT_ENCAPSED_STRING","'not null'",424],["T_WHITESPACE"," ",424],["T_DOUBLE_ARROW","=>",424],["T_WHITESPACE"," ",424],["T_STRING","FALSE",424],",",["T_WHITESPACE","\n            ",424],["T_CONSTANT_ENCAPSED_STRING","'description'",425],["T_WHITESPACE"," ",425],["T_DOUBLE_ARROW","=>",425],["T_WHITESPACE"," ",425],["T_CONSTANT_ENCAPSED_STRING","'Hash of source row data, for detecting changes'",425],",",["T_WHITESPACE","\n          ",425],")",["T_WHITESPACE","\n        ",426],")",";",["T_WHITESPACE","\n      ",427],"}",["T_WHITESPACE","\n      ",428],["T_IF","if",429],["T_WHITESPACE"," ",429],"(","!",["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getDatabase",429],"(",")",["T_OBJECT_OPERATOR","->",429],["T_STRING","schema",429],"(",")",["T_OBJECT_OPERATOR","->",429],["T_STRING","fieldExists",429],"(",["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","mapTableName",429],",",["T_WHITESPACE"," ",429],["T_STATIC","static",429],["T_DOUBLE_COLON","::",429],["T_STRING","SOURCE_IDS_HASH",429],")",")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n        ",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getDatabase",430],"(",")",["T_OBJECT_OPERATOR","->",430],["T_STRING","schema",430],"(",")",["T_OBJECT_OPERATOR","->",430],["T_STRING","addField",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","mapTableName",430],",",["T_WHITESPACE"," ",430],["T_STATIC","static",430],["T_DOUBLE_COLON","::",430],["T_STRING","SOURCE_IDS_HASH",430],",",["T_WHITESPACE"," ",430],["T_ARRAY","array",430],"(",["T_WHITESPACE","\n          ",430],["T_CONSTANT_ENCAPSED_STRING","'type'",431],["T_WHITESPACE"," ",431],["T_DOUBLE_ARROW","=>",431],["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'varchar'",431],",",["T_WHITESPACE","\n          ",431],["T_CONSTANT_ENCAPSED_STRING","'length'",432],["T_WHITESPACE"," ",432],["T_DOUBLE_ARROW","=>",432],["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'64'",432],",",["T_WHITESPACE","\n          ",432],["T_CONSTANT_ENCAPSED_STRING","'not null'",433],["T_WHITESPACE"," ",433],["T_DOUBLE_ARROW","=>",433],["T_WHITESPACE"," ",433],["T_STRING","TRUE",433],",",["T_WHITESPACE","\n          ",433],["T_CONSTANT_ENCAPSED_STRING","'description'",434],["T_WHITESPACE"," ",434],["T_DOUBLE_ARROW","=>",434],["T_WHITESPACE"," ",434],["T_CONSTANT_ENCAPSED_STRING","'Hash of source ids. Used as primary key'",434],",",["T_WHITESPACE","\n        ",434],")",")",";",["T_WHITESPACE","\n      ",435],"}",["T_WHITESPACE","\n    ",436],"}",["T_WHITESPACE","\n  ",437],"}",["T_WHITESPACE","\n\n  ",438],["T_DOC_COMMENT","\/**\n   * Creates schema from an ID definition.\n   *\n   * @param array $id_definition\n   *   The definition of the field having the structure as the items returned by\n   *   MigrateSourceInterface or MigrateDestinationInterface::getIds().\n   *\n   * @return array\n   *   The database schema definition.\n   *\n   * @see \\Drupal\\migrate\\Plugin\\MigrateSourceInterface::getIds()\n   * @see \\Drupal\\migrate\\Plugin\\MigrateDestinationInterface::getIds()\n   *\/",440],["T_WHITESPACE","\n  ",452],["T_PROTECTED","protected",453],["T_WHITESPACE"," ",453],["T_FUNCTION","function",453],["T_WHITESPACE"," ",453],["T_STRING","getFieldSchema",453],"(",["T_ARRAY","array",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$id_definition",453],")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n    ",453],["T_VARIABLE","$type_parts",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_STRING","explode",454],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",454],",",["T_WHITESPACE"," ",454],["T_VARIABLE","$id_definition",454],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",454],"]",")",";",["T_WHITESPACE","\n    ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_STRING","count",455],"(",["T_VARIABLE","$type_parts",455],")",["T_WHITESPACE"," ",455],["T_IS_EQUAL","==",455],["T_WHITESPACE"," ",455],["T_LNUMBER","1",455],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n      ",455],["T_VARIABLE","$type_parts",456],"[","]",["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_CONSTANT_ENCAPSED_STRING","'value'",456],";",["T_WHITESPACE","\n    ",456],"}",["T_WHITESPACE","\n    ",457],["T_UNSET","unset",458],"(",["T_VARIABLE","$id_definition",458],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",458],"]",")",";",["T_WHITESPACE","\n\n    ",458],["T_COMMENT","\/\/ Get the field storage definition.\n",460],["T_WHITESPACE","    ",461],["T_VARIABLE","$definition",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_STRING","BaseFieldDefinition",461],["T_DOUBLE_COLON","::",461],["T_STRING","create",461],"(",["T_VARIABLE","$type_parts",461],"[",["T_LNUMBER","0",461],"]",")",";",["T_WHITESPACE","\n\n    ",461],["T_COMMENT","\/\/ Get a list of setting keys belonging strictly to the field definition.\n",463],["T_WHITESPACE","    ",464],["T_VARIABLE","$default_field_settings",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_VARIABLE","$definition",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","getSettings",464],"(",")",";",["T_WHITESPACE","\n    ",464],["T_COMMENT","\/\/ Separate field definition settings from custom settings. Custom settings\n",465],["T_WHITESPACE","    ",466],["T_COMMENT","\/\/ are settings passed in $id_definition that are not part of field storage\n",466],["T_WHITESPACE","    ",467],["T_COMMENT","\/\/ definition settings.\n",467],["T_WHITESPACE","    ",468],["T_VARIABLE","$field_settings",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_STRING","array_intersect_key",468],"(",["T_VARIABLE","$id_definition",468],",",["T_WHITESPACE"," ",468],["T_VARIABLE","$default_field_settings",468],")",";",["T_WHITESPACE","\n    ",468],["T_VARIABLE","$custom_settings",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_STRING","array_diff_key",469],"(",["T_VARIABLE","$id_definition",469],",",["T_WHITESPACE"," ",469],["T_VARIABLE","$default_field_settings",469],")",";",["T_WHITESPACE","\n\n    ",469],["T_COMMENT","\/\/ Resolve schema from field storage definition settings.\n",471],["T_WHITESPACE","    ",472],["T_VARIABLE","$schema",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_VARIABLE","$definition",472],["T_WHITESPACE","\n      ",472],["T_OBJECT_OPERATOR","->",473],["T_STRING","setSettings",473],"(",["T_VARIABLE","$field_settings",473],")",["T_WHITESPACE","\n      ",473],["T_OBJECT_OPERATOR","->",474],["T_STRING","getColumns",474],"(",")","[",["T_VARIABLE","$type_parts",474],"[",["T_LNUMBER","1",474],"]","]",";",["T_WHITESPACE","\n\n    ",474],["T_COMMENT","\/\/ Merge back custom settings.\n",476],["T_WHITESPACE","    ",477],["T_RETURN","return",477],["T_WHITESPACE"," ",477],["T_VARIABLE","$schema",477],["T_WHITESPACE"," ",477],"+",["T_WHITESPACE"," ",477],["T_VARIABLE","$custom_settings",477],";",["T_WHITESPACE","\n  ",477],"}",["T_WHITESPACE","\n\n  ",478],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",480],["T_WHITESPACE","\n  ",482],["T_PUBLIC","public",483],["T_WHITESPACE"," ",483],["T_FUNCTION","function",483],["T_WHITESPACE"," ",483],["T_STRING","getRowBySource",483],"(",["T_ARRAY","array",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$source_id_values",483],")",["T_WHITESPACE"," ",483],"{",["T_WHITESPACE","\n    ",483],["T_VARIABLE","$query",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","getDatabase",484],"(",")",["T_OBJECT_OPERATOR","->",484],["T_STRING","select",484],"(",["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","mapTableName",484],"(",")",",",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'map'",484],")",["T_WHITESPACE","\n              ",484],["T_OBJECT_OPERATOR","->",485],["T_STRING","fields",485],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",485],")",";",["T_WHITESPACE","\n    ",485],["T_VARIABLE","$query",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","condition",486],"(",["T_STATIC","static",486],["T_DOUBLE_COLON","::",486],["T_STRING","SOURCE_IDS_HASH",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getSourceIDsHash",486],"(",["T_VARIABLE","$source_id_values",486],")",")",";",["T_WHITESPACE","\n    ",486],["T_VARIABLE","$result",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_VARIABLE","$query",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","execute",487],"(",")",";",["T_WHITESPACE","\n    ",487],["T_RETURN","return",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$result",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","fetchAssoc",488],"(",")",";",["T_WHITESPACE","\n  ",488],"}",["T_WHITESPACE","\n\n  ",489],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",491],["T_WHITESPACE","\n  ",493],["T_PUBLIC","public",494],["T_WHITESPACE"," ",494],["T_FUNCTION","function",494],["T_WHITESPACE"," ",494],["T_STRING","getRowByDestination",494],"(",["T_ARRAY","array",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$destination_id_values",494],")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n    ",494],["T_VARIABLE","$query",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","getDatabase",495],"(",")",["T_OBJECT_OPERATOR","->",495],["T_STRING","select",495],"(",["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","mapTableName",495],"(",")",",",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'map'",495],")",["T_WHITESPACE","\n              ",495],["T_OBJECT_OPERATOR","->",496],["T_STRING","fields",496],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",496],")",";",["T_WHITESPACE","\n    ",496],["T_FOREACH","foreach",497],["T_WHITESPACE"," ",497],"(",["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","destinationIdFields",497],"(",")",["T_WHITESPACE"," ",497],["T_AS","as",497],["T_WHITESPACE"," ",497],["T_VARIABLE","$field_name",497],["T_WHITESPACE"," ",497],["T_DOUBLE_ARROW","=>",497],["T_WHITESPACE"," ",497],["T_VARIABLE","$destination_id",497],")",["T_WHITESPACE"," ",497],"{",["T_WHITESPACE","\n      ",497],["T_VARIABLE","$query",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","condition",498],"(","\"",["T_ENCAPSED_AND_WHITESPACE","map.",498],["T_VARIABLE","$destination_id",498],"\"",",",["T_WHITESPACE"," ",498],["T_VARIABLE","$destination_id_values",498],"[",["T_VARIABLE","$field_name",498],"]",",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'='",498],")",";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n    ",499],["T_VARIABLE","$result",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_VARIABLE","$query",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","execute",500],"(",")",";",["T_WHITESPACE","\n    ",500],["T_RETURN","return",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$result",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","fetchAssoc",501],"(",")",";",["T_WHITESPACE","\n  ",501],"}",["T_WHITESPACE","\n\n  ",502],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",504],["T_WHITESPACE","\n  ",506],["T_PUBLIC","public",507],["T_WHITESPACE"," ",507],["T_FUNCTION","function",507],["T_WHITESPACE"," ",507],["T_STRING","getRowsNeedingUpdate",507],"(",["T_VARIABLE","$count",507],")",["T_WHITESPACE"," ",507],"{",["T_WHITESPACE","\n    ",507],["T_VARIABLE","$rows",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_ARRAY","array",508],"(",")",";",["T_WHITESPACE","\n    ",508],["T_VARIABLE","$result",509],["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getDatabase",509],"(",")",["T_OBJECT_OPERATOR","->",509],["T_STRING","select",509],"(",["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","mapTableName",509],"(",")",",",["T_WHITESPACE"," ",509],["T_CONSTANT_ENCAPSED_STRING","'map'",509],")",["T_WHITESPACE","\n                      ",509],["T_OBJECT_OPERATOR","->",510],["T_STRING","fields",510],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",510],")",["T_WHITESPACE","\n                      ",510],["T_OBJECT_OPERATOR","->",511],["T_STRING","condition",511],"(",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",511],",",["T_WHITESPACE"," ",511],["T_STRING","MigrateIdMapInterface",511],["T_DOUBLE_COLON","::",511],["T_STRING","STATUS_NEEDS_UPDATE",511],")",["T_WHITESPACE","\n                      ",511],["T_OBJECT_OPERATOR","->",512],["T_STRING","range",512],"(",["T_LNUMBER","0",512],",",["T_WHITESPACE"," ",512],["T_VARIABLE","$count",512],")",["T_WHITESPACE","\n                      ",512],["T_OBJECT_OPERATOR","->",513],["T_STRING","execute",513],"(",")",";",["T_WHITESPACE","\n    ",513],["T_FOREACH","foreach",514],["T_WHITESPACE"," ",514],"(",["T_VARIABLE","$result",514],["T_WHITESPACE"," ",514],["T_AS","as",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$row",514],")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n      ",514],["T_VARIABLE","$rows",515],"[","]",["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_VARIABLE","$row",515],";",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n    ",516],["T_RETURN","return",517],["T_WHITESPACE"," ",517],["T_VARIABLE","$rows",517],";",["T_WHITESPACE","\n  ",517],"}",["T_WHITESPACE","\n\n  ",518],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",520],["T_WHITESPACE","\n  ",522],["T_PUBLIC","public",523],["T_WHITESPACE"," ",523],["T_FUNCTION","function",523],["T_WHITESPACE"," ",523],["T_STRING","lookupSourceID",523],"(",["T_ARRAY","array",523],["T_WHITESPACE"," ",523],["T_VARIABLE","$destination_id_values",523],")",["T_WHITESPACE"," ",523],"{",["T_WHITESPACE","\n    ",523],["T_VARIABLE","$source_id_fields",524],["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","sourceIdFields",524],"(",")",";",["T_WHITESPACE","\n    ",524],["T_VARIABLE","$query",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","getDatabase",525],"(",")",["T_OBJECT_OPERATOR","->",525],["T_STRING","select",525],"(",["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","mapTableName",525],"(",")",",",["T_WHITESPACE"," ",525],["T_CONSTANT_ENCAPSED_STRING","'map'",525],")",";",["T_WHITESPACE","\n    ",525],["T_FOREACH","foreach",526],["T_WHITESPACE"," ",526],"(",["T_VARIABLE","$source_id_fields",526],["T_WHITESPACE"," ",526],["T_AS","as",526],["T_WHITESPACE"," ",526],["T_VARIABLE","$source_field_name",526],["T_WHITESPACE"," ",526],["T_DOUBLE_ARROW","=>",526],["T_WHITESPACE"," ",526],["T_VARIABLE","$idmap_field_name",526],")",["T_WHITESPACE"," ",526],"{",["T_WHITESPACE","\n      ",526],["T_VARIABLE","$query",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","addField",527],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",527],",",["T_WHITESPACE"," ",527],["T_VARIABLE","$idmap_field_name",527],",",["T_WHITESPACE"," ",527],["T_VARIABLE","$source_field_name",527],")",";",["T_WHITESPACE","\n    ",527],"}",["T_WHITESPACE","\n    ",528],["T_FOREACH","foreach",529],["T_WHITESPACE"," ",529],"(",["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","destinationIdFields",529],"(",")",["T_WHITESPACE"," ",529],["T_AS","as",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$field_name",529],["T_WHITESPACE"," ",529],["T_DOUBLE_ARROW","=>",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$destination_id",529],")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n      ",529],["T_VARIABLE","$query",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","condition",530],"(","\"",["T_ENCAPSED_AND_WHITESPACE","map.",530],["T_VARIABLE","$destination_id",530],"\"",",",["T_WHITESPACE"," ",530],["T_VARIABLE","$destination_id_values",530],"[",["T_VARIABLE","$field_name",530],"]",",",["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","'='",530],")",";",["T_WHITESPACE","\n    ",530],"}",["T_WHITESPACE","\n    ",531],["T_VARIABLE","$result",532],["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_VARIABLE","$query",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","execute",532],"(",")",";",["T_WHITESPACE","\n    ",532],["T_RETURN","return",533],["T_WHITESPACE"," ",533],["T_VARIABLE","$result",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","fetchAssoc",533],"(",")",["T_WHITESPACE"," ",533],"?",":",["T_WHITESPACE"," ",533],"[","]",";",["T_WHITESPACE","\n  ",533],"}",["T_WHITESPACE","\n\n  ",534],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",536],["T_WHITESPACE","\n  ",538],["T_PUBLIC","public",539],["T_WHITESPACE"," ",539],["T_FUNCTION","function",539],["T_WHITESPACE"," ",539],["T_STRING","lookupDestinationId",539],"(",["T_ARRAY","array",539],["T_WHITESPACE"," ",539],["T_VARIABLE","$source_id_values",539],")",["T_WHITESPACE"," ",539],"{",["T_WHITESPACE","\n    ",539],["T_VARIABLE","$results",540],["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","lookupDestinationIds",540],"(",["T_VARIABLE","$source_id_values",540],")",";",["T_WHITESPACE","\n    ",540],["T_RETURN","return",541],["T_WHITESPACE"," ",541],["T_VARIABLE","$results",541],["T_WHITESPACE"," ",541],"?",["T_WHITESPACE"," ",541],["T_STRING","reset",541],"(",["T_VARIABLE","$results",541],")",["T_WHITESPACE"," ",541],":",["T_WHITESPACE"," ",541],["T_ARRAY","array",541],"(",")",";",["T_WHITESPACE","\n  ",541],"}",["T_WHITESPACE","\n\n  ",542],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",544],["T_WHITESPACE","\n  ",546],["T_PUBLIC","public",547],["T_WHITESPACE"," ",547],["T_FUNCTION","function",547],["T_WHITESPACE"," ",547],["T_STRING","lookupDestinationIds",547],"(",["T_ARRAY","array",547],["T_WHITESPACE"," ",547],["T_VARIABLE","$source_id_values",547],")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n    ",547],["T_IF","if",548],["T_WHITESPACE"," ",548],"(",["T_EMPTY","empty",548],"(",["T_VARIABLE","$source_id_values",548],")",")",["T_WHITESPACE"," ",548],"{",["T_WHITESPACE","\n      ",548],["T_RETURN","return",549],["T_WHITESPACE"," ",549],["T_ARRAY","array",549],"(",")",";",["T_WHITESPACE","\n    ",549],"}",["T_WHITESPACE","\n\n    ",550],["T_COMMENT","\/\/ Canonicalize the keys into a hash of DB-field => value.\n",552],["T_WHITESPACE","    ",553],["T_VARIABLE","$is_associative",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],"!",["T_ISSET","isset",553],"(",["T_VARIABLE","$source_id_values",553],"[",["T_LNUMBER","0",553],"]",")",";",["T_WHITESPACE","\n    ",553],["T_VARIABLE","$conditions",554],["T_WHITESPACE"," ",554],"=",["T_WHITESPACE"," ",554],"[","]",";",["T_WHITESPACE","\n    ",554],["T_FOREACH","foreach",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","sourceIdFields",555],"(",")",["T_WHITESPACE"," ",555],["T_AS","as",555],["T_WHITESPACE"," ",555],["T_VARIABLE","$field_name",555],["T_WHITESPACE"," ",555],["T_DOUBLE_ARROW","=>",555],["T_WHITESPACE"," ",555],["T_VARIABLE","$db_field",555],")",["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n      ",555],["T_IF","if",556],["T_WHITESPACE"," ",556],"(",["T_VARIABLE","$is_associative",556],")",["T_WHITESPACE"," ",556],"{",["T_WHITESPACE","\n        ",556],["T_COMMENT","\/\/ Associative $source_id_values can have fields out of order.\n",557],["T_WHITESPACE","        ",558],["T_IF","if",558],["T_WHITESPACE"," ",558],"(",["T_ISSET","isset",558],"(",["T_VARIABLE","$source_id_values",558],"[",["T_VARIABLE","$field_name",558],"]",")",")",["T_WHITESPACE"," ",558],"{",["T_WHITESPACE","\n          ",558],["T_VARIABLE","$conditions",559],"[",["T_VARIABLE","$db_field",559],"]",["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_VARIABLE","$source_id_values",559],"[",["T_VARIABLE","$field_name",559],"]",";",["T_WHITESPACE","\n          ",559],["T_UNSET","unset",560],"(",["T_VARIABLE","$source_id_values",560],"[",["T_VARIABLE","$field_name",560],"]",")",";",["T_WHITESPACE","\n        ",560],"}",["T_WHITESPACE","\n      ",561],"}",["T_WHITESPACE","\n      ",562],["T_ELSE","else",563],["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n        ",563],["T_COMMENT","\/\/ For non-associative $source_id_values, we assume they're the first\n",564],["T_WHITESPACE","        ",565],["T_COMMENT","\/\/ few fields.\n",565],["T_WHITESPACE","        ",566],["T_IF","if",566],["T_WHITESPACE"," ",566],"(",["T_EMPTY","empty",566],"(",["T_VARIABLE","$source_id_values",566],")",")",["T_WHITESPACE"," ",566],"{",["T_WHITESPACE","\n          ",566],["T_BREAK","break",567],";",["T_WHITESPACE","\n        ",567],"}",["T_WHITESPACE","\n        ",568],["T_VARIABLE","$conditions",569],"[",["T_VARIABLE","$db_field",569],"]",["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_STRING","array_shift",569],"(",["T_VARIABLE","$source_id_values",569],")",";",["T_WHITESPACE","\n      ",569],"}",["T_WHITESPACE","\n    ",570],"}",["T_WHITESPACE","\n\n    ",571],["T_IF","if",573],["T_WHITESPACE"," ",573],"(","!",["T_EMPTY","empty",573],"(",["T_VARIABLE","$source_id_values",573],")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n      ",573],["T_THROW","throw",574],["T_WHITESPACE"," ",574],["T_NEW","new",574],["T_WHITESPACE"," ",574],["T_STRING","MigrateException",574],"(",["T_CONSTANT_ENCAPSED_STRING","\"Extra unknown items in source IDs\"",574],")",";",["T_WHITESPACE","\n    ",574],"}",["T_WHITESPACE","\n\n    ",575],["T_VARIABLE","$query",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","getDatabase",577],"(",")",["T_OBJECT_OPERATOR","->",577],["T_STRING","select",577],"(",["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","mapTableName",577],"(",")",",",["T_WHITESPACE"," ",577],["T_CONSTANT_ENCAPSED_STRING","'map'",577],")",["T_WHITESPACE","\n      ",577],["T_OBJECT_OPERATOR","->",578],["T_STRING","fields",578],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",578],",",["T_WHITESPACE"," ",578],["T_VARIABLE","$this",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","destinationIdFields",578],"(",")",")",";",["T_WHITESPACE","\n    ",578],["T_IF","if",579],["T_WHITESPACE"," ",579],"(",["T_STRING","count",579],"(",["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","sourceIdFields",579],"(",")",")",["T_WHITESPACE"," ",579],["T_IS_IDENTICAL","===",579],["T_WHITESPACE"," ",579],["T_STRING","count",579],"(",["T_VARIABLE","$conditions",579],")",")",["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n      ",579],["T_COMMENT","\/\/ Optimization: Use the primary key.\n",580],["T_WHITESPACE","      ",581],["T_VARIABLE","$query",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","condition",581],"(",["T_STRING","self",581],["T_DOUBLE_COLON","::",581],["T_STRING","SOURCE_IDS_HASH",581],",",["T_WHITESPACE"," ",581],["T_VARIABLE","$this",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","getSourceIDsHash",581],"(",["T_STRING","array_values",581],"(",["T_VARIABLE","$conditions",581],")",")",")",";",["T_WHITESPACE","\n    ",581],"}",["T_WHITESPACE","\n    ",582],["T_ELSE","else",583],["T_WHITESPACE"," ",583],"{",["T_WHITESPACE","\n      ",583],["T_FOREACH","foreach",584],["T_WHITESPACE"," ",584],"(",["T_VARIABLE","$conditions",584],["T_WHITESPACE"," ",584],["T_AS","as",584],["T_WHITESPACE"," ",584],["T_VARIABLE","$db_field",584],["T_WHITESPACE"," ",584],["T_DOUBLE_ARROW","=>",584],["T_WHITESPACE"," ",584],["T_VARIABLE","$value",584],")",["T_WHITESPACE"," ",584],"{",["T_WHITESPACE","\n        ",584],["T_VARIABLE","$query",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","condition",585],"(",["T_VARIABLE","$db_field",585],",",["T_WHITESPACE"," ",585],["T_VARIABLE","$value",585],")",";",["T_WHITESPACE","\n      ",585],"}",["T_WHITESPACE","\n    ",586],"}",["T_WHITESPACE","\n\n    ",587],["T_RETURN","return",589],["T_WHITESPACE"," ",589],["T_VARIABLE","$query",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","execute",589],"(",")",["T_OBJECT_OPERATOR","->",589],["T_STRING","fetchAll",589],"(",["T_NS_SEPARATOR","\\",589],["T_STRING","PDO",589],["T_DOUBLE_COLON","::",589],["T_STRING","FETCH_NUM",589],")",";",["T_WHITESPACE","\n  ",589],"}",["T_WHITESPACE","\n\n  ",590],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",592],["T_WHITESPACE","\n  ",594],["T_PUBLIC","public",595],["T_WHITESPACE"," ",595],["T_FUNCTION","function",595],["T_WHITESPACE"," ",595],["T_STRING","saveIdMapping",595],"(",["T_STRING","Row",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$row",595],",",["T_WHITESPACE"," ",595],["T_ARRAY","array",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$destination_id_values",595],",",["T_WHITESPACE"," ",595],["T_VARIABLE","$source_row_status",595],["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_STRING","MigrateIdMapInterface",595],["T_DOUBLE_COLON","::",595],["T_STRING","STATUS_IMPORTED",595],",",["T_WHITESPACE"," ",595],["T_VARIABLE","$rollback_action",595],["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_STRING","MigrateIdMapInterface",595],["T_DOUBLE_COLON","::",595],["T_STRING","ROLLBACK_DELETE",595],")",["T_WHITESPACE"," ",595],"{",["T_WHITESPACE","\n    ",595],["T_COMMENT","\/\/ Construct the source key.\n",596],["T_WHITESPACE","    ",597],["T_VARIABLE","$source_id_values",597],["T_WHITESPACE"," ",597],"=",["T_WHITESPACE"," ",597],["T_VARIABLE","$row",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","getSourceIdValues",597],"(",")",";",["T_WHITESPACE","\n    ",597],["T_COMMENT","\/\/ Construct the source key and initialize to empty variable keys.\n",598],["T_WHITESPACE","    ",599],["T_VARIABLE","$fields",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],"[","]",";",["T_WHITESPACE","\n    ",599],["T_FOREACH","foreach",600],["T_WHITESPACE"," ",600],"(",["T_VARIABLE","$this",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","sourceIdFields",600],"(",")",["T_WHITESPACE"," ",600],["T_AS","as",600],["T_WHITESPACE"," ",600],["T_VARIABLE","$field_name",600],["T_WHITESPACE"," ",600],["T_DOUBLE_ARROW","=>",600],["T_WHITESPACE"," ",600],["T_VARIABLE","$key_name",600],")",["T_WHITESPACE"," ",600],"{",["T_WHITESPACE","\n      ",600],["T_COMMENT","\/\/ A NULL key value is usually an indication of a problem.\n",601],["T_WHITESPACE","      ",602],["T_IF","if",602],["T_WHITESPACE"," ",602],"(","!",["T_ISSET","isset",602],"(",["T_VARIABLE","$source_id_values",602],"[",["T_VARIABLE","$field_name",602],"]",")",")",["T_WHITESPACE"," ",602],"{",["T_WHITESPACE","\n        ",602],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","message",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","display",603],"(",["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","t",603],"(",["T_WHITESPACE","\n          ",603],["T_CONSTANT_ENCAPSED_STRING","'Did not save to map table due to NULL value for key field @field'",604],",",["T_WHITESPACE","\n          ",604],["T_ARRAY","array",605],"(",["T_CONSTANT_ENCAPSED_STRING","'@field'",605],["T_WHITESPACE"," ",605],["T_DOUBLE_ARROW","=>",605],["T_WHITESPACE"," ",605],["T_VARIABLE","$field_name",605],")",")",",",["T_WHITESPACE"," ",605],["T_CONSTANT_ENCAPSED_STRING","'error'",605],")",";",["T_WHITESPACE","\n        ",605],["T_RETURN","return",606],";",["T_WHITESPACE","\n      ",606],"}",["T_WHITESPACE","\n      ",607],["T_VARIABLE","$fields",608],"[",["T_VARIABLE","$key_name",608],"]",["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_VARIABLE","$source_id_values",608],"[",["T_VARIABLE","$field_name",608],"]",";",["T_WHITESPACE","\n    ",608],"}",["T_WHITESPACE","\n\n    ",609],["T_IF","if",611],["T_WHITESPACE"," ",611],"(","!",["T_VARIABLE","$fields",611],")",["T_WHITESPACE"," ",611],"{",["T_WHITESPACE","\n      ",611],["T_RETURN","return",612],";",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n\n    ",613],["T_VARIABLE","$fields",615],["T_WHITESPACE"," ",615],["T_PLUS_EQUAL","+=",615],["T_WHITESPACE"," ",615],["T_ARRAY","array",615],"(",["T_WHITESPACE","\n      ",615],["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",616],["T_WHITESPACE"," ",616],["T_DOUBLE_ARROW","=>",616],["T_WHITESPACE"," ",616],["T_INT_CAST","(int)",616],["T_WHITESPACE"," ",616],["T_VARIABLE","$source_row_status",616],",",["T_WHITESPACE","\n      ",616],["T_CONSTANT_ENCAPSED_STRING","'rollback_action'",617],["T_WHITESPACE"," ",617],["T_DOUBLE_ARROW","=>",617],["T_WHITESPACE"," ",617],["T_INT_CAST","(int)",617],["T_WHITESPACE"," ",617],["T_VARIABLE","$rollback_action",617],",",["T_WHITESPACE","\n      ",617],["T_CONSTANT_ENCAPSED_STRING","'hash'",618],["T_WHITESPACE"," ",618],["T_DOUBLE_ARROW","=>",618],["T_WHITESPACE"," ",618],["T_VARIABLE","$row",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getHash",618],"(",")",",",["T_WHITESPACE","\n    ",618],")",";",["T_WHITESPACE","\n    ",619],["T_VARIABLE","$count",620],["T_WHITESPACE"," ",620],"=",["T_WHITESPACE"," ",620],["T_LNUMBER","0",620],";",["T_WHITESPACE","\n    ",620],["T_FOREACH","foreach",621],["T_WHITESPACE"," ",621],"(",["T_VARIABLE","$destination_id_values",621],["T_WHITESPACE"," ",621],["T_AS","as",621],["T_WHITESPACE"," ",621],["T_VARIABLE","$dest_id",621],")",["T_WHITESPACE"," ",621],"{",["T_WHITESPACE","\n      ",621],["T_VARIABLE","$fields",622],"[",["T_CONSTANT_ENCAPSED_STRING","'destid'",622],["T_WHITESPACE"," ",622],".",["T_WHITESPACE"," ",622],["T_INC","++",622],["T_VARIABLE","$count",622],"]",["T_WHITESPACE"," ",622],"=",["T_WHITESPACE"," ",622],["T_VARIABLE","$dest_id",622],";",["T_WHITESPACE","\n    ",622],"}",["T_WHITESPACE","\n    ",623],["T_IF","if",624],["T_WHITESPACE"," ",624],"(",["T_VARIABLE","$count",624],["T_WHITESPACE"," ",624],["T_BOOLEAN_AND","&&",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$count",624],["T_WHITESPACE"," ",624],["T_IS_NOT_EQUAL","!=",624],["T_WHITESPACE"," ",624],["T_STRING","count",624],"(",["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","destinationIdFields",624],"(",")",")",")",["T_WHITESPACE"," ",624],"{",["T_WHITESPACE","\n      ",624],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","message",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","display",625],"(",["T_STRING","t",625],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not save to map table due to missing destination id values'",625],")",",",["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","'error'",625],")",";",["T_WHITESPACE","\n      ",625],["T_RETURN","return",626],";",["T_WHITESPACE","\n    ",626],"}",["T_WHITESPACE","\n    ",627],["T_IF","if",628],["T_WHITESPACE"," ",628],"(",["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","migration",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","getTrackLastImported",628],"(",")",")",["T_WHITESPACE"," ",628],"{",["T_WHITESPACE","\n      ",628],["T_VARIABLE","$fields",629],"[",["T_CONSTANT_ENCAPSED_STRING","'last_imported'",629],"]",["T_WHITESPACE"," ",629],"=",["T_WHITESPACE"," ",629],["T_STRING","time",629],"(",")",";",["T_WHITESPACE","\n    ",629],"}",["T_WHITESPACE","\n    ",630],["T_VARIABLE","$keys",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],"[",["T_STATIC","static",631],["T_DOUBLE_COLON","::",631],["T_STRING","SOURCE_IDS_HASH",631],["T_WHITESPACE"," ",631],["T_DOUBLE_ARROW","=>",631],["T_WHITESPACE"," ",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","getSourceIDsHash",631],"(",["T_VARIABLE","$source_id_values",631],")","]",";",["T_WHITESPACE","\n    ",631],["T_COMMENT","\/\/ Notify anyone listening of the map row we're about to save.\n",632],["T_WHITESPACE","    ",633],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","eventDispatcher",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","dispatch",633],"(",["T_STRING","MigrateEvents",633],["T_DOUBLE_COLON","::",633],["T_STRING","MAP_SAVE",633],",",["T_WHITESPACE"," ",633],["T_NEW","new",633],["T_WHITESPACE"," ",633],["T_STRING","MigrateMapSaveEvent",633],"(",["T_VARIABLE","$this",633],",",["T_WHITESPACE"," ",633],["T_VARIABLE","$fields",633],")",")",";",["T_WHITESPACE","\n    ",633],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","getDatabase",634],"(",")",["T_OBJECT_OPERATOR","->",634],["T_STRING","merge",634],"(",["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","mapTableName",634],"(",")",")",["T_WHITESPACE","\n      ",634],["T_OBJECT_OPERATOR","->",635],["T_STRING","key",635],"(",["T_VARIABLE","$keys",635],")",["T_WHITESPACE","\n      ",635],["T_OBJECT_OPERATOR","->",636],["T_STRING","fields",636],"(",["T_VARIABLE","$fields",636],")",["T_WHITESPACE","\n      ",636],["T_OBJECT_OPERATOR","->",637],["T_STRING","execute",637],"(",")",";",["T_WHITESPACE","\n  ",637],"}",["T_WHITESPACE","\n\n  ",638],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",640],["T_WHITESPACE","\n  ",642],["T_PUBLIC","public",643],["T_WHITESPACE"," ",643],["T_FUNCTION","function",643],["T_WHITESPACE"," ",643],["T_STRING","saveMessage",643],"(",["T_ARRAY","array",643],["T_WHITESPACE"," ",643],["T_VARIABLE","$source_id_values",643],",",["T_WHITESPACE"," ",643],["T_VARIABLE","$message",643],",",["T_WHITESPACE"," ",643],["T_VARIABLE","$level",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_STRING","MigrationInterface",643],["T_DOUBLE_COLON","::",643],["T_STRING","MESSAGE_ERROR",643],")",["T_WHITESPACE"," ",643],"{",["T_WHITESPACE","\n    ",643],["T_FOREACH","foreach",644],["T_WHITESPACE"," ",644],"(",["T_VARIABLE","$this",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","sourceIdFields",644],"(",")",["T_WHITESPACE"," ",644],["T_AS","as",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$field_name",644],["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$source_id",644],")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n      ",644],["T_COMMENT","\/\/ If any key value is not set, we can't save.\n",645],["T_WHITESPACE","      ",646],["T_IF","if",646],["T_WHITESPACE"," ",646],"(","!",["T_ISSET","isset",646],"(",["T_VARIABLE","$source_id_values",646],"[",["T_VARIABLE","$field_name",646],"]",")",")",["T_WHITESPACE"," ",646],"{",["T_WHITESPACE","\n        ",646],["T_RETURN","return",647],";",["T_WHITESPACE","\n      ",647],"}",["T_WHITESPACE","\n    ",648],"}",["T_WHITESPACE","\n    ",649],["T_VARIABLE","$fields",650],"[",["T_STATIC","static",650],["T_DOUBLE_COLON","::",650],["T_STRING","SOURCE_IDS_HASH",650],"]",["T_WHITESPACE"," ",650],"=",["T_WHITESPACE"," ",650],["T_VARIABLE","$this",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","getSourceIDsHash",650],"(",["T_VARIABLE","$source_id_values",650],")",";",["T_WHITESPACE","\n    ",650],["T_VARIABLE","$fields",651],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",651],"]",["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_VARIABLE","$level",651],";",["T_WHITESPACE","\n    ",651],["T_VARIABLE","$fields",652],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",652],"]",["T_WHITESPACE"," ",652],"=",["T_WHITESPACE"," ",652],["T_VARIABLE","$message",652],";",["T_WHITESPACE","\n    ",652],["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","getDatabase",653],"(",")",["T_OBJECT_OPERATOR","->",653],["T_STRING","insert",653],"(",["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","messageTableName",653],"(",")",")",["T_WHITESPACE","\n      ",653],["T_OBJECT_OPERATOR","->",654],["T_STRING","fields",654],"(",["T_VARIABLE","$fields",654],")",["T_WHITESPACE","\n      ",654],["T_OBJECT_OPERATOR","->",655],["T_STRING","execute",655],"(",")",";",["T_WHITESPACE","\n\n    ",655],["T_COMMENT","\/\/ Notify anyone listening of the message we've saved.\n",657],["T_WHITESPACE","    ",658],["T_VARIABLE","$this",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","eventDispatcher",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","dispatch",658],"(",["T_STRING","MigrateEvents",658],["T_DOUBLE_COLON","::",658],["T_STRING","IDMAP_MESSAGE",658],",",["T_WHITESPACE","\n      ",658],["T_NEW","new",659],["T_WHITESPACE"," ",659],["T_STRING","MigrateIdMapMessageEvent",659],"(",["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","migration",659],",",["T_WHITESPACE"," ",659],["T_VARIABLE","$source_id_values",659],",",["T_WHITESPACE"," ",659],["T_VARIABLE","$message",659],",",["T_WHITESPACE"," ",659],["T_VARIABLE","$level",659],")",")",";",["T_WHITESPACE","\n  ",659],"}",["T_WHITESPACE","\n\n  ",660],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",662],["T_WHITESPACE","\n  ",664],["T_PUBLIC","public",665],["T_WHITESPACE"," ",665],["T_FUNCTION","function",665],["T_WHITESPACE"," ",665],["T_STRING","getMessageIterator",665],"(",["T_ARRAY","array",665],["T_WHITESPACE"," ",665],["T_VARIABLE","$source_id_values",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],"[","]",",",["T_WHITESPACE"," ",665],["T_VARIABLE","$level",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_STRING","NULL",665],")",["T_WHITESPACE"," ",665],"{",["T_WHITESPACE","\n    ",665],["T_VARIABLE","$query",666],["T_WHITESPACE"," ",666],"=",["T_WHITESPACE"," ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","getDatabase",666],"(",")",["T_OBJECT_OPERATOR","->",666],["T_STRING","select",666],"(",["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","messageTableName",666],"(",")",",",["T_WHITESPACE"," ",666],["T_CONSTANT_ENCAPSED_STRING","'msg'",666],")",["T_WHITESPACE","\n      ",666],["T_OBJECT_OPERATOR","->",667],["T_STRING","fields",667],"(",["T_CONSTANT_ENCAPSED_STRING","'msg'",667],")",";",["T_WHITESPACE","\n    ",667],["T_IF","if",668],["T_WHITESPACE"," ",668],"(",["T_VARIABLE","$source_id_values",668],")",["T_WHITESPACE"," ",668],"{",["T_WHITESPACE","\n      ",668],["T_VARIABLE","$query",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","condition",669],"(",["T_STATIC","static",669],["T_DOUBLE_COLON","::",669],["T_STRING","SOURCE_IDS_HASH",669],",",["T_WHITESPACE"," ",669],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","getSourceIDsHash",669],"(",["T_VARIABLE","$source_id_values",669],")",")",";",["T_WHITESPACE","\n    ",669],"}",["T_WHITESPACE","\n\n    ",670],["T_IF","if",672],["T_WHITESPACE"," ",672],"(",["T_VARIABLE","$level",672],")",["T_WHITESPACE"," ",672],"{",["T_WHITESPACE","\n      ",672],["T_VARIABLE","$query",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","condition",673],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",673],",",["T_WHITESPACE"," ",673],["T_VARIABLE","$level",673],")",";",["T_WHITESPACE","\n    ",673],"}",["T_WHITESPACE","\n    ",674],["T_RETURN","return",675],["T_WHITESPACE"," ",675],["T_VARIABLE","$query",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","execute",675],"(",")",";",["T_WHITESPACE","\n  ",675],"}",["T_WHITESPACE","\n\n  ",676],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",678],["T_WHITESPACE","\n  ",680],["T_PUBLIC","public",681],["T_WHITESPACE"," ",681],["T_FUNCTION","function",681],["T_WHITESPACE"," ",681],["T_STRING","prepareUpdate",681],"(",")",["T_WHITESPACE"," ",681],"{",["T_WHITESPACE","\n    ",681],["T_VARIABLE","$this",682],["T_OBJECT_OPERATOR","->",682],["T_STRING","getDatabase",682],"(",")",["T_OBJECT_OPERATOR","->",682],["T_STRING","update",682],"(",["T_VARIABLE","$this",682],["T_OBJECT_OPERATOR","->",682],["T_STRING","mapTableName",682],"(",")",")",["T_WHITESPACE","\n      ",682],["T_OBJECT_OPERATOR","->",683],["T_STRING","fields",683],"(",["T_ARRAY","array",683],"(",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",683],["T_WHITESPACE"," ",683],["T_DOUBLE_ARROW","=>",683],["T_WHITESPACE"," ",683],["T_STRING","MigrateIdMapInterface",683],["T_DOUBLE_COLON","::",683],["T_STRING","STATUS_NEEDS_UPDATE",683],")",")",["T_WHITESPACE","\n      ",683],["T_OBJECT_OPERATOR","->",684],["T_STRING","execute",684],"(",")",";",["T_WHITESPACE","\n  ",684],"}",["T_WHITESPACE","\n\n  ",685],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",687],["T_WHITESPACE","\n  ",689],["T_PUBLIC","public",690],["T_WHITESPACE"," ",690],["T_FUNCTION","function",690],["T_WHITESPACE"," ",690],["T_STRING","processedCount",690],"(",")",["T_WHITESPACE"," ",690],"{",["T_WHITESPACE","\n    ",690],["T_RETURN","return",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$this",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","getDatabase",691],"(",")",["T_OBJECT_OPERATOR","->",691],["T_STRING","select",691],"(",["T_VARIABLE","$this",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","mapTableName",691],"(",")",")",["T_WHITESPACE","\n      ",691],["T_OBJECT_OPERATOR","->",692],["T_STRING","countQuery",692],"(",")",["T_WHITESPACE","\n      ",692],["T_OBJECT_OPERATOR","->",693],["T_STRING","execute",693],"(",")",["T_WHITESPACE","\n      ",693],["T_OBJECT_OPERATOR","->",694],["T_STRING","fetchField",694],"(",")",";",["T_WHITESPACE","\n  ",694],"}",["T_WHITESPACE","\n\n  ",695],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",697],["T_WHITESPACE","\n  ",699],["T_PUBLIC","public",700],["T_WHITESPACE"," ",700],["T_FUNCTION","function",700],["T_WHITESPACE"," ",700],["T_STRING","importedCount",700],"(",")",["T_WHITESPACE"," ",700],"{",["T_WHITESPACE","\n    ",700],["T_RETURN","return",701],["T_WHITESPACE"," ",701],["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","getDatabase",701],"(",")",["T_OBJECT_OPERATOR","->",701],["T_STRING","select",701],"(",["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","mapTableName",701],"(",")",")",["T_WHITESPACE","\n      ",701],["T_OBJECT_OPERATOR","->",702],["T_STRING","condition",702],"(",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",702],",",["T_WHITESPACE"," ",702],["T_ARRAY","array",702],"(",["T_STRING","MigrateIdMapInterface",702],["T_DOUBLE_COLON","::",702],["T_STRING","STATUS_IMPORTED",702],",",["T_WHITESPACE"," ",702],["T_STRING","MigrateIdMapInterface",702],["T_DOUBLE_COLON","::",702],["T_STRING","STATUS_NEEDS_UPDATE",702],")",",",["T_WHITESPACE"," ",702],["T_CONSTANT_ENCAPSED_STRING","'IN'",702],")",["T_WHITESPACE","\n      ",702],["T_OBJECT_OPERATOR","->",703],["T_STRING","countQuery",703],"(",")",["T_WHITESPACE","\n      ",703],["T_OBJECT_OPERATOR","->",704],["T_STRING","execute",704],"(",")",["T_WHITESPACE","\n      ",704],["T_OBJECT_OPERATOR","->",705],["T_STRING","fetchField",705],"(",")",";",["T_WHITESPACE","\n  ",705],"}",["T_WHITESPACE","\n\n  ",706],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",708],["T_WHITESPACE","\n  ",710],["T_PUBLIC","public",711],["T_WHITESPACE"," ",711],["T_FUNCTION","function",711],["T_WHITESPACE"," ",711],["T_STRING","updateCount",711],"(",")",["T_WHITESPACE"," ",711],"{",["T_WHITESPACE","\n    ",711],["T_RETURN","return",712],["T_WHITESPACE"," ",712],["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","countHelper",712],"(",["T_STRING","MigrateIdMapInterface",712],["T_DOUBLE_COLON","::",712],["T_STRING","STATUS_NEEDS_UPDATE",712],")",";",["T_WHITESPACE","\n  ",712],"}",["T_WHITESPACE","\n\n  ",713],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",715],["T_WHITESPACE","\n  ",717],["T_PUBLIC","public",718],["T_WHITESPACE"," ",718],["T_FUNCTION","function",718],["T_WHITESPACE"," ",718],["T_STRING","errorCount",718],"(",")",["T_WHITESPACE"," ",718],"{",["T_WHITESPACE","\n    ",718],["T_RETURN","return",719],["T_WHITESPACE"," ",719],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","countHelper",719],"(",["T_STRING","MigrateIdMapInterface",719],["T_DOUBLE_COLON","::",719],["T_STRING","STATUS_FAILED",719],")",";",["T_WHITESPACE","\n  ",719],"}",["T_WHITESPACE","\n\n  ",720],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",722],["T_WHITESPACE","\n  ",724],["T_PUBLIC","public",725],["T_WHITESPACE"," ",725],["T_FUNCTION","function",725],["T_WHITESPACE"," ",725],["T_STRING","messageCount",725],"(",")",["T_WHITESPACE"," ",725],"{",["T_WHITESPACE","\n    ",725],["T_RETURN","return",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","countHelper",726],"(",["T_STRING","NULL",726],",",["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","messageTableName",726],"(",")",")",";",["T_WHITESPACE","\n  ",726],"}",["T_WHITESPACE","\n\n  ",727],["T_DOC_COMMENT","\/**\n   * Counts records in a table.\n   *\n   * @param int $status\n   *   An integer for the source_row_status column.\n   * @param string $table\n   *   (optional) The table to work. Defaults to NULL.\n   *\n   * @return int\n   *   The number of records.\n   *\/",729],["T_WHITESPACE","\n  ",739],["T_PROTECTED","protected",740],["T_WHITESPACE"," ",740],["T_FUNCTION","function",740],["T_WHITESPACE"," ",740],["T_STRING","countHelper",740],"(",["T_VARIABLE","$status",740],",",["T_WHITESPACE"," ",740],["T_VARIABLE","$table",740],["T_WHITESPACE"," ",740],"=",["T_WHITESPACE"," ",740],["T_STRING","NULL",740],")",["T_WHITESPACE"," ",740],"{",["T_WHITESPACE","\n    ",740],["T_VARIABLE","$query",741],["T_WHITESPACE"," ",741],"=",["T_WHITESPACE"," ",741],["T_VARIABLE","$this",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","getDatabase",741],"(",")",["T_OBJECT_OPERATOR","->",741],["T_STRING","select",741],"(",["T_VARIABLE","$table",741],["T_WHITESPACE"," ",741],"?",":",["T_WHITESPACE"," ",741],["T_VARIABLE","$this",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","mapTableName",741],"(",")",")",";",["T_WHITESPACE","\n    ",741],["T_IF","if",742],["T_WHITESPACE"," ",742],"(",["T_ISSET","isset",742],"(",["T_VARIABLE","$status",742],")",")",["T_WHITESPACE"," ",742],"{",["T_WHITESPACE","\n      ",742],["T_VARIABLE","$query",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","condition",743],"(",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",743],",",["T_WHITESPACE"," ",743],["T_VARIABLE","$status",743],")",";",["T_WHITESPACE","\n    ",743],"}",["T_WHITESPACE","\n    ",744],["T_RETURN","return",745],["T_WHITESPACE"," ",745],["T_VARIABLE","$query",745],["T_OBJECT_OPERATOR","->",745],["T_STRING","countQuery",745],"(",")",["T_OBJECT_OPERATOR","->",745],["T_STRING","execute",745],"(",")",["T_OBJECT_OPERATOR","->",745],["T_STRING","fetchField",745],"(",")",";",["T_WHITESPACE","\n  ",745],"}",["T_WHITESPACE","\n\n  ",746],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",748],["T_WHITESPACE","\n  ",750],["T_PUBLIC","public",751],["T_WHITESPACE"," ",751],["T_FUNCTION","function",751],["T_WHITESPACE"," ",751],["T_STRING","delete",751],"(",["T_ARRAY","array",751],["T_WHITESPACE"," ",751],["T_VARIABLE","$source_id_values",751],",",["T_WHITESPACE"," ",751],["T_VARIABLE","$messages_only",751],["T_WHITESPACE"," ",751],"=",["T_WHITESPACE"," ",751],["T_STRING","FALSE",751],")",["T_WHITESPACE"," ",751],"{",["T_WHITESPACE","\n    ",751],["T_IF","if",752],["T_WHITESPACE"," ",752],"(",["T_EMPTY","empty",752],"(",["T_VARIABLE","$source_id_values",752],")",")",["T_WHITESPACE"," ",752],"{",["T_WHITESPACE","\n      ",752],["T_THROW","throw",753],["T_WHITESPACE"," ",753],["T_NEW","new",753],["T_WHITESPACE"," ",753],["T_STRING","MigrateException",753],"(",["T_CONSTANT_ENCAPSED_STRING","'Without source identifier values it is impossible to find the row to delete.'",753],")",";",["T_WHITESPACE","\n    ",753],"}",["T_WHITESPACE","\n\n    ",754],["T_IF","if",756],["T_WHITESPACE"," ",756],"(","!",["T_VARIABLE","$messages_only",756],")",["T_WHITESPACE"," ",756],"{",["T_WHITESPACE","\n      ",756],["T_VARIABLE","$map_query",757],["T_WHITESPACE"," ",757],"=",["T_WHITESPACE"," ",757],["T_VARIABLE","$this",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","getDatabase",757],"(",")",["T_OBJECT_OPERATOR","->",757],["T_STRING","delete",757],"(",["T_VARIABLE","$this",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","mapTableName",757],"(",")",")",";",["T_WHITESPACE","\n      ",757],["T_VARIABLE","$map_query",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","condition",758],"(",["T_STATIC","static",758],["T_DOUBLE_COLON","::",758],["T_STRING","SOURCE_IDS_HASH",758],",",["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","getSourceIDsHash",758],"(",["T_VARIABLE","$source_id_values",758],")",")",";",["T_WHITESPACE","\n      ",758],["T_COMMENT","\/\/ Notify anyone listening of the map row we're about to delete.\n",759],["T_WHITESPACE","      ",760],["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","eventDispatcher",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","dispatch",760],"(",["T_STRING","MigrateEvents",760],["T_DOUBLE_COLON","::",760],["T_STRING","MAP_DELETE",760],",",["T_WHITESPACE"," ",760],["T_NEW","new",760],["T_WHITESPACE"," ",760],["T_STRING","MigrateMapDeleteEvent",760],"(",["T_VARIABLE","$this",760],",",["T_WHITESPACE"," ",760],["T_VARIABLE","$source_id_values",760],")",")",";",["T_WHITESPACE","\n      ",760],["T_VARIABLE","$map_query",761],["T_OBJECT_OPERATOR","->",761],["T_STRING","execute",761],"(",")",";",["T_WHITESPACE","\n    ",761],"}",["T_WHITESPACE","\n    ",762],["T_VARIABLE","$message_query",763],["T_WHITESPACE"," ",763],"=",["T_WHITESPACE"," ",763],["T_VARIABLE","$this",763],["T_OBJECT_OPERATOR","->",763],["T_STRING","getDatabase",763],"(",")",["T_OBJECT_OPERATOR","->",763],["T_STRING","delete",763],"(",["T_VARIABLE","$this",763],["T_OBJECT_OPERATOR","->",763],["T_STRING","messageTableName",763],"(",")",")",";",["T_WHITESPACE","\n    ",763],["T_VARIABLE","$message_query",764],["T_OBJECT_OPERATOR","->",764],["T_STRING","condition",764],"(",["T_STATIC","static",764],["T_DOUBLE_COLON","::",764],["T_STRING","SOURCE_IDS_HASH",764],",",["T_WHITESPACE"," ",764],["T_VARIABLE","$this",764],["T_OBJECT_OPERATOR","->",764],["T_STRING","getSourceIDsHash",764],"(",["T_VARIABLE","$source_id_values",764],")",")",";",["T_WHITESPACE","\n    ",764],["T_VARIABLE","$message_query",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","execute",765],"(",")",";",["T_WHITESPACE","\n  ",765],"}",["T_WHITESPACE","\n\n  ",766],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",768],["T_WHITESPACE","\n  ",770],["T_PUBLIC","public",771],["T_WHITESPACE"," ",771],["T_FUNCTION","function",771],["T_WHITESPACE"," ",771],["T_STRING","deleteDestination",771],"(",["T_ARRAY","array",771],["T_WHITESPACE"," ",771],["T_VARIABLE","$destination_id_values",771],")",["T_WHITESPACE"," ",771],"{",["T_WHITESPACE","\n    ",771],["T_VARIABLE","$map_query",772],["T_WHITESPACE"," ",772],"=",["T_WHITESPACE"," ",772],["T_VARIABLE","$this",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","getDatabase",772],"(",")",["T_OBJECT_OPERATOR","->",772],["T_STRING","delete",772],"(",["T_VARIABLE","$this",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","mapTableName",772],"(",")",")",";",["T_WHITESPACE","\n    ",772],["T_VARIABLE","$message_query",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","getDatabase",773],"(",")",["T_OBJECT_OPERATOR","->",773],["T_STRING","delete",773],"(",["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","messageTableName",773],"(",")",")",";",["T_WHITESPACE","\n    ",773],["T_VARIABLE","$source_id_values",774],["T_WHITESPACE"," ",774],"=",["T_WHITESPACE"," ",774],["T_VARIABLE","$this",774],["T_OBJECT_OPERATOR","->",774],["T_STRING","lookupSourceID",774],"(",["T_VARIABLE","$destination_id_values",774],")",";",["T_WHITESPACE","\n    ",774],["T_IF","if",775],["T_WHITESPACE"," ",775],"(","!",["T_EMPTY","empty",775],"(",["T_VARIABLE","$source_id_values",775],")",")",["T_WHITESPACE"," ",775],"{",["T_WHITESPACE","\n      ",775],["T_FOREACH","foreach",776],["T_WHITESPACE"," ",776],"(",["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","destinationIdFields",776],"(",")",["T_WHITESPACE"," ",776],["T_AS","as",776],["T_WHITESPACE"," ",776],["T_VARIABLE","$field_name",776],["T_WHITESPACE"," ",776],["T_DOUBLE_ARROW","=>",776],["T_WHITESPACE"," ",776],["T_VARIABLE","$destination_id",776],")",["T_WHITESPACE"," ",776],"{",["T_WHITESPACE","\n        ",776],["T_VARIABLE","$map_query",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","condition",777],"(",["T_VARIABLE","$destination_id",777],",",["T_WHITESPACE"," ",777],["T_VARIABLE","$destination_id_values",777],"[",["T_VARIABLE","$field_name",777],"]",")",";",["T_WHITESPACE","\n      ",777],"}",["T_WHITESPACE","\n      ",778],["T_COMMENT","\/\/ Notify anyone listening of the map row we're about to delete.\n",779],["T_WHITESPACE","      ",780],["T_VARIABLE","$this",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","eventDispatcher",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","dispatch",780],"(",["T_STRING","MigrateEvents",780],["T_DOUBLE_COLON","::",780],["T_STRING","MAP_DELETE",780],",",["T_WHITESPACE"," ",780],["T_NEW","new",780],["T_WHITESPACE"," ",780],["T_STRING","MigrateMapDeleteEvent",780],"(",["T_VARIABLE","$this",780],",",["T_WHITESPACE"," ",780],["T_VARIABLE","$source_id_values",780],")",")",";",["T_WHITESPACE","\n      ",780],["T_VARIABLE","$map_query",781],["T_OBJECT_OPERATOR","->",781],["T_STRING","execute",781],"(",")",";",["T_WHITESPACE","\n\n      ",781],["T_VARIABLE","$message_query",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","condition",783],"(",["T_STATIC","static",783],["T_DOUBLE_COLON","::",783],["T_STRING","SOURCE_IDS_HASH",783],",",["T_WHITESPACE"," ",783],["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","getSourceIDsHash",783],"(",["T_VARIABLE","$source_id_values",783],")",")",";",["T_WHITESPACE","\n      ",783],["T_VARIABLE","$message_query",784],["T_OBJECT_OPERATOR","->",784],["T_STRING","execute",784],"(",")",";",["T_WHITESPACE","\n    ",784],"}",["T_WHITESPACE","\n  ",785],"}",["T_WHITESPACE","\n\n  ",786],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",788],["T_WHITESPACE","\n  ",790],["T_PUBLIC","public",791],["T_WHITESPACE"," ",791],["T_FUNCTION","function",791],["T_WHITESPACE"," ",791],["T_STRING","setUpdate",791],"(",["T_ARRAY","array",791],["T_WHITESPACE"," ",791],["T_VARIABLE","$source_id_values",791],")",["T_WHITESPACE"," ",791],"{",["T_WHITESPACE","\n    ",791],["T_IF","if",792],["T_WHITESPACE"," ",792],"(",["T_EMPTY","empty",792],"(",["T_VARIABLE","$source_id_values",792],")",")",["T_WHITESPACE"," ",792],"{",["T_WHITESPACE","\n      ",792],["T_THROW","throw",793],["T_WHITESPACE"," ",793],["T_NEW","new",793],["T_WHITESPACE"," ",793],["T_STRING","MigrateException",793],"(",["T_CONSTANT_ENCAPSED_STRING","'No source identifiers provided to update.'",793],")",";",["T_WHITESPACE","\n    ",793],"}",["T_WHITESPACE","\n    ",794],["T_VARIABLE","$query",795],["T_WHITESPACE"," ",795],"=",["T_WHITESPACE"," ",795],["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","getDatabase",795],"(",")",["T_WHITESPACE","\n      ",795],["T_OBJECT_OPERATOR","->",796],["T_STRING","update",796],"(",["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","mapTableName",796],"(",")",")",["T_WHITESPACE","\n      ",796],["T_OBJECT_OPERATOR","->",797],["T_STRING","fields",797],"(",["T_ARRAY","array",797],"(",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",797],["T_WHITESPACE"," ",797],["T_DOUBLE_ARROW","=>",797],["T_WHITESPACE"," ",797],["T_STRING","MigrateIdMapInterface",797],["T_DOUBLE_COLON","::",797],["T_STRING","STATUS_NEEDS_UPDATE",797],")",")",";",["T_WHITESPACE","\n\n    ",797],["T_FOREACH","foreach",799],["T_WHITESPACE"," ",799],"(",["T_VARIABLE","$this",799],["T_OBJECT_OPERATOR","->",799],["T_STRING","sourceIdFields",799],"(",")",["T_WHITESPACE"," ",799],["T_AS","as",799],["T_WHITESPACE"," ",799],["T_VARIABLE","$field_name",799],["T_WHITESPACE"," ",799],["T_DOUBLE_ARROW","=>",799],["T_WHITESPACE"," ",799],["T_VARIABLE","$source_id",799],")",["T_WHITESPACE"," ",799],"{",["T_WHITESPACE","\n      ",799],["T_VARIABLE","$query",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","condition",800],"(",["T_VARIABLE","$source_id",800],",",["T_WHITESPACE"," ",800],["T_VARIABLE","$source_id_values",800],"[",["T_VARIABLE","$field_name",800],"]",")",";",["T_WHITESPACE","\n    ",800],"}",["T_WHITESPACE","\n    ",801],["T_VARIABLE","$query",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","execute",802],"(",")",";",["T_WHITESPACE","\n  ",802],"}",["T_WHITESPACE","\n\n  ",803],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",805],["T_WHITESPACE","\n  ",807],["T_PUBLIC","public",808],["T_WHITESPACE"," ",808],["T_FUNCTION","function",808],["T_WHITESPACE"," ",808],["T_STRING","clearMessages",808],"(",")",["T_WHITESPACE"," ",808],"{",["T_WHITESPACE","\n    ",808],["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","getDatabase",809],"(",")",["T_OBJECT_OPERATOR","->",809],["T_STRING","truncate",809],"(",["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","messageTableName",809],"(",")",")",["T_OBJECT_OPERATOR","->",809],["T_STRING","execute",809],"(",")",";",["T_WHITESPACE","\n  ",809],"}",["T_WHITESPACE","\n\n  ",810],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",812],["T_WHITESPACE","\n  ",814],["T_PUBLIC","public",815],["T_WHITESPACE"," ",815],["T_FUNCTION","function",815],["T_WHITESPACE"," ",815],["T_STRING","destroy",815],"(",")",["T_WHITESPACE"," ",815],"{",["T_WHITESPACE","\n    ",815],["T_VARIABLE","$this",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","getDatabase",816],"(",")",["T_OBJECT_OPERATOR","->",816],["T_STRING","schema",816],"(",")",["T_OBJECT_OPERATOR","->",816],["T_STRING","dropTable",816],"(",["T_VARIABLE","$this",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","mapTableName",816],"(",")",")",";",["T_WHITESPACE","\n    ",816],["T_VARIABLE","$this",817],["T_OBJECT_OPERATOR","->",817],["T_STRING","getDatabase",817],"(",")",["T_OBJECT_OPERATOR","->",817],["T_STRING","schema",817],"(",")",["T_OBJECT_OPERATOR","->",817],["T_STRING","dropTable",817],"(",["T_VARIABLE","$this",817],["T_OBJECT_OPERATOR","->",817],["T_STRING","messageTableName",817],"(",")",")",";",["T_WHITESPACE","\n  ",817],"}",["T_WHITESPACE","\n\n  ",818],["T_DOC_COMMENT","\/**\n   * Implementation of Iterator::rewind().\n   *\n   * This is called before beginning a foreach loop.\n   *\/",820],["T_WHITESPACE","\n  ",824],["T_PUBLIC","public",825],["T_WHITESPACE"," ",825],["T_FUNCTION","function",825],["T_WHITESPACE"," ",825],["T_STRING","rewind",825],"(",")",["T_WHITESPACE"," ",825],"{",["T_WHITESPACE","\n    ",825],["T_VARIABLE","$this",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","currentRow",826],["T_WHITESPACE"," ",826],"=",["T_WHITESPACE"," ",826],["T_STRING","NULL",826],";",["T_WHITESPACE","\n    ",826],["T_VARIABLE","$fields",827],["T_WHITESPACE"," ",827],"=",["T_WHITESPACE"," ",827],["T_ARRAY","array",827],"(",")",";",["T_WHITESPACE","\n    ",827],["T_FOREACH","foreach",828],["T_WHITESPACE"," ",828],"(",["T_VARIABLE","$this",828],["T_OBJECT_OPERATOR","->",828],["T_STRING","sourceIdFields",828],"(",")",["T_WHITESPACE"," ",828],["T_AS","as",828],["T_WHITESPACE"," ",828],["T_VARIABLE","$field",828],")",["T_WHITESPACE"," ",828],"{",["T_WHITESPACE","\n      ",828],["T_VARIABLE","$fields",829],"[","]",["T_WHITESPACE"," ",829],"=",["T_WHITESPACE"," ",829],["T_VARIABLE","$field",829],";",["T_WHITESPACE","\n    ",829],"}",["T_WHITESPACE","\n    ",830],["T_FOREACH","foreach",831],["T_WHITESPACE"," ",831],"(",["T_VARIABLE","$this",831],["T_OBJECT_OPERATOR","->",831],["T_STRING","destinationIdFields",831],"(",")",["T_WHITESPACE"," ",831],["T_AS","as",831],["T_WHITESPACE"," ",831],["T_VARIABLE","$field",831],")",["T_WHITESPACE"," ",831],"{",["T_WHITESPACE","\n      ",831],["T_VARIABLE","$fields",832],"[","]",["T_WHITESPACE"," ",832],"=",["T_WHITESPACE"," ",832],["T_VARIABLE","$field",832],";",["T_WHITESPACE","\n    ",832],"}",["T_WHITESPACE","\n    ",833],["T_VARIABLE","$this",834],["T_OBJECT_OPERATOR","->",834],["T_STRING","result",834],["T_WHITESPACE"," ",834],"=",["T_WHITESPACE"," ",834],["T_VARIABLE","$this",834],["T_OBJECT_OPERATOR","->",834],["T_STRING","getDatabase",834],"(",")",["T_OBJECT_OPERATOR","->",834],["T_STRING","select",834],"(",["T_VARIABLE","$this",834],["T_OBJECT_OPERATOR","->",834],["T_STRING","mapTableName",834],"(",")",",",["T_WHITESPACE"," ",834],["T_CONSTANT_ENCAPSED_STRING","'map'",834],")",["T_WHITESPACE","\n      ",834],["T_OBJECT_OPERATOR","->",835],["T_STRING","fields",835],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",835],",",["T_WHITESPACE"," ",835],["T_VARIABLE","$fields",835],")",["T_WHITESPACE","\n      ",835],["T_OBJECT_OPERATOR","->",836],["T_STRING","orderBy",836],"(",["T_CONSTANT_ENCAPSED_STRING","'destid1'",836],")",["T_WHITESPACE","\n      ",836],["T_OBJECT_OPERATOR","->",837],["T_STRING","execute",837],"(",")",";",["T_WHITESPACE","\n    ",837],["T_VARIABLE","$this",838],["T_OBJECT_OPERATOR","->",838],["T_STRING","next",838],"(",")",";",["T_WHITESPACE","\n  ",838],"}",["T_WHITESPACE","\n\n  ",839],["T_DOC_COMMENT","\/**\n   * Implementation of Iterator::current().\n   *\n   * This is called when entering a loop iteration, returning the current row.\n   *\/",841],["T_WHITESPACE","\n  ",845],["T_PUBLIC","public",846],["T_WHITESPACE"," ",846],["T_FUNCTION","function",846],["T_WHITESPACE"," ",846],["T_STRING","current",846],"(",")",["T_WHITESPACE"," ",846],"{",["T_WHITESPACE","\n    ",846],["T_RETURN","return",847],["T_WHITESPACE"," ",847],["T_VARIABLE","$this",847],["T_OBJECT_OPERATOR","->",847],["T_STRING","currentRow",847],";",["T_WHITESPACE","\n  ",847],"}",["T_WHITESPACE","\n\n  ",848],["T_DOC_COMMENT","\/**\n   * Implementation of Iterator::key().\n   *\n   * This is called when entering a loop iteration, returning the key of the\n   * current row. It must be a scalar - we will serialize to fulfill the\n   * requirement, but using getCurrentKey() is preferable.\n   *\/",850],["T_WHITESPACE","\n  ",856],["T_PUBLIC","public",857],["T_WHITESPACE"," ",857],["T_FUNCTION","function",857],["T_WHITESPACE"," ",857],["T_STRING","key",857],"(",")",["T_WHITESPACE"," ",857],"{",["T_WHITESPACE","\n    ",857],["T_RETURN","return",858],["T_WHITESPACE"," ",858],["T_STRING","serialize",858],"(",["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","currentKey",858],")",";",["T_WHITESPACE","\n  ",858],"}",["T_WHITESPACE","\n\n  ",859],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",861],["T_WHITESPACE","\n  ",863],["T_PUBLIC","public",864],["T_WHITESPACE"," ",864],["T_FUNCTION","function",864],["T_WHITESPACE"," ",864],["T_STRING","currentDestination",864],"(",")",["T_WHITESPACE"," ",864],"{",["T_WHITESPACE","\n    ",864],["T_IF","if",865],["T_WHITESPACE"," ",865],"(",["T_VARIABLE","$this",865],["T_OBJECT_OPERATOR","->",865],["T_STRING","valid",865],"(",")",")",["T_WHITESPACE"," ",865],"{",["T_WHITESPACE","\n      ",865],["T_VARIABLE","$result",866],["T_WHITESPACE"," ",866],"=",["T_WHITESPACE"," ",866],["T_ARRAY","array",866],"(",")",";",["T_WHITESPACE","\n      ",866],["T_FOREACH","foreach",867],["T_WHITESPACE"," ",867],"(",["T_VARIABLE","$this",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","destinationIdFields",867],"(",")",["T_WHITESPACE"," ",867],["T_AS","as",867],["T_WHITESPACE"," ",867],["T_VARIABLE","$destination_field_name",867],["T_WHITESPACE"," ",867],["T_DOUBLE_ARROW","=>",867],["T_WHITESPACE"," ",867],["T_VARIABLE","$idmap_field_name",867],")",["T_WHITESPACE"," ",867],"{",["T_WHITESPACE","\n        ",867],["T_IF","if",868],["T_WHITESPACE"," ",868],"(","!",["T_STRING","is_null",868],"(",["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","currentRow",868],"[",["T_VARIABLE","$idmap_field_name",868],"]",")",")",["T_WHITESPACE"," ",868],"{",["T_WHITESPACE","\n          ",868],["T_VARIABLE","$result",869],"[",["T_VARIABLE","$destination_field_name",869],"]",["T_WHITESPACE"," ",869],"=",["T_WHITESPACE"," ",869],["T_VARIABLE","$this",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","currentRow",869],"[",["T_VARIABLE","$idmap_field_name",869],"]",";",["T_WHITESPACE","\n        ",869],"}",["T_WHITESPACE","\n      ",870],"}",["T_WHITESPACE","\n      ",871],["T_RETURN","return",872],["T_WHITESPACE"," ",872],["T_VARIABLE","$result",872],";",["T_WHITESPACE","\n    ",872],"}",["T_WHITESPACE","\n    ",873],["T_ELSE","else",874],["T_WHITESPACE"," ",874],"{",["T_WHITESPACE","\n      ",874],["T_RETURN","return",875],["T_WHITESPACE"," ",875],["T_STRING","NULL",875],";",["T_WHITESPACE","\n    ",875],"}",["T_WHITESPACE","\n  ",876],"}",["T_WHITESPACE","\n\n  ",877],["T_DOC_COMMENT","\/**\n   * @inheritdoc\n   *\/",879],["T_WHITESPACE","\n  ",881],["T_PUBLIC","public",882],["T_WHITESPACE"," ",882],["T_FUNCTION","function",882],["T_WHITESPACE"," ",882],["T_STRING","currentSource",882],"(",")",["T_WHITESPACE"," ",882],"{",["T_WHITESPACE","\n    ",882],["T_IF","if",883],["T_WHITESPACE"," ",883],"(",["T_VARIABLE","$this",883],["T_OBJECT_OPERATOR","->",883],["T_STRING","valid",883],"(",")",")",["T_WHITESPACE"," ",883],"{",["T_WHITESPACE","\n      ",883],["T_VARIABLE","$result",884],["T_WHITESPACE"," ",884],"=",["T_WHITESPACE"," ",884],["T_ARRAY","array",884],"(",")",";",["T_WHITESPACE","\n      ",884],["T_FOREACH","foreach",885],["T_WHITESPACE"," ",885],"(",["T_VARIABLE","$this",885],["T_OBJECT_OPERATOR","->",885],["T_STRING","sourceIdFields",885],"(",")",["T_WHITESPACE"," ",885],["T_AS","as",885],["T_WHITESPACE"," ",885],["T_VARIABLE","$field_name",885],["T_WHITESPACE"," ",885],["T_DOUBLE_ARROW","=>",885],["T_WHITESPACE"," ",885],["T_VARIABLE","$source_id",885],")",["T_WHITESPACE"," ",885],"{",["T_WHITESPACE","\n        ",885],["T_VARIABLE","$result",886],"[",["T_VARIABLE","$field_name",886],"]",["T_WHITESPACE"," ",886],"=",["T_WHITESPACE"," ",886],["T_VARIABLE","$this",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","currentKey",886],"[",["T_VARIABLE","$source_id",886],"]",";",["T_WHITESPACE","\n      ",886],"}",["T_WHITESPACE","\n      ",887],["T_RETURN","return",888],["T_WHITESPACE"," ",888],["T_VARIABLE","$result",888],";",["T_WHITESPACE","\n    ",888],"}",["T_WHITESPACE","\n    ",889],["T_ELSE","else",890],["T_WHITESPACE"," ",890],"{",["T_WHITESPACE","\n      ",890],["T_RETURN","return",891],["T_WHITESPACE"," ",891],["T_STRING","NULL",891],";",["T_WHITESPACE","\n    ",891],"}",["T_WHITESPACE","\n  ",892],"}",["T_WHITESPACE","\n\n  ",893],["T_DOC_COMMENT","\/**\n   * Implementation of Iterator::next().\n   *\n   * This is called at the bottom of the loop implicitly, as well as explicitly\n   * from rewind().\n   *\/",895],["T_WHITESPACE","\n  ",900],["T_PUBLIC","public",901],["T_WHITESPACE"," ",901],["T_FUNCTION","function",901],["T_WHITESPACE"," ",901],["T_STRING","next",901],"(",")",["T_WHITESPACE"," ",901],"{",["T_WHITESPACE","\n    ",901],["T_VARIABLE","$this",902],["T_OBJECT_OPERATOR","->",902],["T_STRING","currentRow",902],["T_WHITESPACE"," ",902],"=",["T_WHITESPACE"," ",902],["T_VARIABLE","$this",902],["T_OBJECT_OPERATOR","->",902],["T_STRING","result",902],["T_OBJECT_OPERATOR","->",902],["T_STRING","fetchAssoc",902],"(",")",";",["T_WHITESPACE","\n    ",902],["T_VARIABLE","$this",903],["T_OBJECT_OPERATOR","->",903],["T_STRING","currentKey",903],["T_WHITESPACE"," ",903],"=",["T_WHITESPACE"," ",903],["T_ARRAY","array",903],"(",")",";",["T_WHITESPACE","\n    ",903],["T_IF","if",904],["T_WHITESPACE"," ",904],"(",["T_VARIABLE","$this",904],["T_OBJECT_OPERATOR","->",904],["T_STRING","currentRow",904],")",["T_WHITESPACE"," ",904],"{",["T_WHITESPACE","\n      ",904],["T_FOREACH","foreach",905],["T_WHITESPACE"," ",905],"(",["T_VARIABLE","$this",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","sourceIdFields",905],"(",")",["T_WHITESPACE"," ",905],["T_AS","as",905],["T_WHITESPACE"," ",905],["T_VARIABLE","$map_field",905],")",["T_WHITESPACE"," ",905],"{",["T_WHITESPACE","\n        ",905],["T_VARIABLE","$this",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","currentKey",906],"[",["T_VARIABLE","$map_field",906],"]",["T_WHITESPACE"," ",906],"=",["T_WHITESPACE"," ",906],["T_VARIABLE","$this",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","currentRow",906],"[",["T_VARIABLE","$map_field",906],"]",";",["T_WHITESPACE","\n        ",906],["T_COMMENT","\/\/ Leave only destination fields.\n",907],["T_WHITESPACE","        ",908],["T_UNSET","unset",908],"(",["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","currentRow",908],"[",["T_VARIABLE","$map_field",908],"]",")",";",["T_WHITESPACE","\n      ",908],"}",["T_WHITESPACE","\n    ",909],"}",["T_WHITESPACE","\n  ",910],"}",["T_WHITESPACE","\n\n  ",911],["T_DOC_COMMENT","\/**\n   * Implementation of Iterator::valid().\n   *\n   * This is called at the top of the loop, returning TRUE to process the loop\n   * and FALSE to terminate it.\n   *\/",913],["T_WHITESPACE","\n  ",918],["T_PUBLIC","public",919],["T_WHITESPACE"," ",919],["T_FUNCTION","function",919],["T_WHITESPACE"," ",919],["T_STRING","valid",919],"(",")",["T_WHITESPACE"," ",919],"{",["T_WHITESPACE","\n    ",919],["T_RETURN","return",920],["T_WHITESPACE"," ",920],["T_VARIABLE","$this",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","currentRow",920],["T_WHITESPACE"," ",920],["T_IS_NOT_IDENTICAL","!==",920],["T_WHITESPACE"," ",920],["T_STRING","FALSE",920],";",["T_WHITESPACE","\n  ",920],"}",["T_WHITESPACE","\n\n",921],"}",["T_WHITESPACE","\n",923]]