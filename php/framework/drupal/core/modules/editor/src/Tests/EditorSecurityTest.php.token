[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","editor",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Serialization",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Json",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","editor",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Editor",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","simpletest",7],["T_NS_SEPARATOR","\\",7],["T_STRING","WebTestBase",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","filter",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FilterFormat",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Tests XSS protection for content creators when using text editors.\n *\n * @group editor\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","EditorSecurityTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","WebTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * The sample content to use in all tests.\n   *\n   * @var string\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$sampleContent",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'<p style=\"color: red\">Hello, Dumbo Octopus!<\/p><script>alert(0)<\/script><embed type=\"image\/svg+xml\" src=\"image.svg\" \/>'",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The secured sample content to use in most tests.\n   *\n   * @var string\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$sampleContentSecured",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'<p>Hello, Dumbo Octopus!<\/p>alert(0)'",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * The secured sample content to use in tests when the <embed> tag is allowed.\n   *\n   * @var string\n   *\/",31],["T_WHITESPACE","\n  ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_STATIC","static",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$sampleContentSecuredEmbedAllowed",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'<p>Hello, Dumbo Octopus!<\/p>alert(0)<embed type=\"image\/svg+xml\" src=\"image.svg\" \/>'",36],";",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",38],["T_WHITESPACE","\n  ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_STATIC","static",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$modules",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_ARRAY","array",43],"(",["T_CONSTANT_ENCAPSED_STRING","'filter'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'editor'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'editor_test'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'node'",43],")",";",["T_WHITESPACE","\n\n  ",43],["T_DOC_COMMENT","\/**\n   * User with access to Restricted HTML text format without text editor.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",45],["T_WHITESPACE","\n  ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$untrustedUser",50],";",["T_WHITESPACE","\n\n  ",50],["T_DOC_COMMENT","\/**\n   * User with access to Restricted HTML text format with text editor.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",52],["T_WHITESPACE","\n  ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$normalUser",57],";",["T_WHITESPACE","\n\n  ",57],["T_DOC_COMMENT","\/**\n   * User with access to Restricted HTML text format, dangerous tags allowed\n   * with text editor.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",59],["T_WHITESPACE","\n  ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$trustedUser",65],";",["T_WHITESPACE","\n\n  ",65],["T_DOC_COMMENT","\/**\n   * User with access to all text formats and text editors.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",67],["T_WHITESPACE","\n  ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$privilegedUser",72],";",["T_WHITESPACE","\n\n  ",72],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","setUp",74],"(",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n    ",74],["T_STRING","parent",75],["T_DOUBLE_COLON","::",75],["T_STRING","setUp",75],"(",")",";",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Create 5 text formats, to cover all potential use cases:\n",77],["T_WHITESPACE","    ",78],["T_COMMENT","\/\/  1. restricted_without_editor (untrusted: anonymous)\n",78],["T_WHITESPACE","    ",79],["T_COMMENT","\/\/  2. restricted_with_editor (normal: authenticated)\n",79],["T_WHITESPACE","    ",80],["T_COMMENT","\/\/  3. restricted_plus_dangerous_tag_with_editor (privileged: trusted)\n",80],["T_WHITESPACE","    ",81],["T_COMMENT","\/\/  4. unrestricted_without_editor (privileged: admin)\n",81],["T_WHITESPACE","    ",82],["T_COMMENT","\/\/  5. unrestricted_with_editor (privileged: admin)\n",82],["T_WHITESPACE","    ",83],["T_COMMENT","\/\/ With text formats 2, 3 and 5, we also associate a text editor that does\n",83],["T_WHITESPACE","    ",84],["T_COMMENT","\/\/ not guarantee XSS safety. \"restricted\" means the text format has XSS\n",84],["T_WHITESPACE","    ",85],["T_COMMENT","\/\/ filters on output, \"unrestricted\" means the opposite.\n",85],["T_WHITESPACE","    ",86],["T_VARIABLE","$format",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","FilterFormat",86],["T_DOUBLE_COLON","::",86],["T_STRING","create",86],"(",["T_ARRAY","array",86],"(",["T_WHITESPACE","\n      ",86],["T_CONSTANT_ENCAPSED_STRING","'format'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",87],",",["T_WHITESPACE","\n      ",87],["T_CONSTANT_ENCAPSED_STRING","'name'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'Restricted HTML, without text editor'",88],",",["T_WHITESPACE","\n      ",88],["T_CONSTANT_ENCAPSED_STRING","'weight'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_LNUMBER","0",89],",",["T_WHITESPACE","\n      ",89],["T_CONSTANT_ENCAPSED_STRING","'filters'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_ARRAY","array",90],"(",["T_WHITESPACE","\n        ",90],["T_COMMENT","\/\/ A filter of the FilterInterface::TYPE_HTML_RESTRICTOR type.\n",91],["T_WHITESPACE","        ",92],["T_CONSTANT_ENCAPSED_STRING","'filter_html'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",["T_WHITESPACE","\n          ",92],["T_CONSTANT_ENCAPSED_STRING","'status'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_LNUMBER","1",93],",",["T_WHITESPACE","\n          ",93],["T_CONSTANT_ENCAPSED_STRING","'settings'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'allowed_html'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'<h2> <h3> <h4> <h5> <h6> <p> <br> <strong> <a>'",95],",",["T_WHITESPACE","\n          ",95],")",["T_WHITESPACE","\n        ",96],")",",",["T_WHITESPACE","\n      ",97],")",",",["T_WHITESPACE","\n    ",98],")",")",";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$format",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","save",100],"(",")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$format",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_STRING","FilterFormat",101],["T_DOUBLE_COLON","::",101],["T_STRING","create",101],"(",["T_ARRAY","array",101],"(",["T_WHITESPACE","\n      ",101],["T_CONSTANT_ENCAPSED_STRING","'format'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",102],",",["T_WHITESPACE","\n      ",102],["T_CONSTANT_ENCAPSED_STRING","'name'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'Restricted HTML, with text editor'",103],",",["T_WHITESPACE","\n      ",103],["T_CONSTANT_ENCAPSED_STRING","'weight'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_LNUMBER","1",104],",",["T_WHITESPACE","\n      ",104],["T_CONSTANT_ENCAPSED_STRING","'filters'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_WHITESPACE","\n        ",105],["T_COMMENT","\/\/ A filter of the FilterInterface::TYPE_HTML_RESTRICTOR type.\n",106],["T_WHITESPACE","        ",107],["T_CONSTANT_ENCAPSED_STRING","'filter_html'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_ARRAY","array",107],"(",["T_WHITESPACE","\n          ",107],["T_CONSTANT_ENCAPSED_STRING","'status'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_LNUMBER","1",108],",",["T_WHITESPACE","\n          ",108],["T_CONSTANT_ENCAPSED_STRING","'settings'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_ARRAY","array",109],"(",["T_WHITESPACE","\n            ",109],["T_CONSTANT_ENCAPSED_STRING","'allowed_html'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'<h2> <h3> <h4> <h5> <h6> <p> <br> <strong> <a>'",110],",",["T_WHITESPACE","\n          ",110],")",["T_WHITESPACE","\n        ",111],")",",",["T_WHITESPACE","\n      ",112],")",",",["T_WHITESPACE","\n    ",113],")",")",";",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$format",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","save",115],"(",")",";",["T_WHITESPACE","\n    ",115],["T_VARIABLE","$editor",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","Editor",116],["T_DOUBLE_COLON","::",116],["T_STRING","create",116],"(","[",["T_WHITESPACE","\n      ",116],["T_CONSTANT_ENCAPSED_STRING","'format'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",117],",",["T_WHITESPACE","\n      ",117],["T_CONSTANT_ENCAPSED_STRING","'editor'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'unicorn'",118],",",["T_WHITESPACE","\n    ",118],"]",")",";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$editor",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","save",120],"(",")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$format",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","FilterFormat",121],["T_DOUBLE_COLON","::",121],["T_STRING","create",121],"(",["T_ARRAY","array",121],"(",["T_WHITESPACE","\n      ",121],["T_CONSTANT_ENCAPSED_STRING","'format'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",122],",",["T_WHITESPACE","\n      ",122],["T_CONSTANT_ENCAPSED_STRING","'name'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'Restricted HTML, dangerous tag allowed, with text editor'",123],",",["T_WHITESPACE","\n      ",123],["T_CONSTANT_ENCAPSED_STRING","'weight'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_LNUMBER","1",124],",",["T_WHITESPACE","\n      ",124],["T_CONSTANT_ENCAPSED_STRING","'filters'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_ARRAY","array",125],"(",["T_WHITESPACE","\n        ",125],["T_COMMENT","\/\/ A filter of the FilterInterface::TYPE_HTML_RESTRICTOR type.\n",126],["T_WHITESPACE","        ",127],["T_CONSTANT_ENCAPSED_STRING","'filter_html'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_WHITESPACE","\n          ",127],["T_CONSTANT_ENCAPSED_STRING","'status'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_LNUMBER","1",128],",",["T_WHITESPACE","\n          ",128],["T_CONSTANT_ENCAPSED_STRING","'settings'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_ARRAY","array",129],"(",["T_WHITESPACE","\n            ",129],["T_CONSTANT_ENCAPSED_STRING","'allowed_html'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'<h2> <h3> <h4> <h5> <h6> <p> <br> <strong> <a> <embed>'",130],",",["T_WHITESPACE","\n          ",130],")",["T_WHITESPACE","\n        ",131],")",",",["T_WHITESPACE","\n      ",132],")",",",["T_WHITESPACE","\n    ",133],")",")",";",["T_WHITESPACE","\n    ",134],["T_VARIABLE","$format",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","save",135],"(",")",";",["T_WHITESPACE","\n    ",135],["T_VARIABLE","$editor",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","Editor",136],["T_DOUBLE_COLON","::",136],["T_STRING","create",136],"(","[",["T_WHITESPACE","\n      ",136],["T_CONSTANT_ENCAPSED_STRING","'format'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",137],",",["T_WHITESPACE","\n      ",137],["T_CONSTANT_ENCAPSED_STRING","'editor'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'unicorn'",138],",",["T_WHITESPACE","\n    ",138],"]",")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$editor",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","save",140],"(",")",";",["T_WHITESPACE","\n    ",140],["T_VARIABLE","$format",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","FilterFormat",141],["T_DOUBLE_COLON","::",141],["T_STRING","create",141],"(",["T_ARRAY","array",141],"(",["T_WHITESPACE","\n      ",141],["T_CONSTANT_ENCAPSED_STRING","'format'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",142],",",["T_WHITESPACE","\n      ",142],["T_CONSTANT_ENCAPSED_STRING","'name'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'Unrestricted HTML, without text editor'",143],",",["T_WHITESPACE","\n      ",143],["T_CONSTANT_ENCAPSED_STRING","'weight'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_LNUMBER","0",144],",",["T_WHITESPACE","\n      ",144],["T_CONSTANT_ENCAPSED_STRING","'filters'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",")",",",["T_WHITESPACE","\n    ",145],")",")",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$format",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","save",147],"(",")",";",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$format",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","FilterFormat",148],["T_DOUBLE_COLON","::",148],["T_STRING","create",148],"(",["T_ARRAY","array",148],"(",["T_WHITESPACE","\n      ",148],["T_CONSTANT_ENCAPSED_STRING","'format'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",149],",",["T_WHITESPACE","\n      ",149],["T_CONSTANT_ENCAPSED_STRING","'name'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'Unrestricted HTML, with text editor'",150],",",["T_WHITESPACE","\n      ",150],["T_CONSTANT_ENCAPSED_STRING","'weight'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_LNUMBER","1",151],",",["T_WHITESPACE","\n      ",151],["T_CONSTANT_ENCAPSED_STRING","'filters'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_ARRAY","array",152],"(",")",",",["T_WHITESPACE","\n    ",152],")",")",";",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$format",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","save",154],"(",")",";",["T_WHITESPACE","\n    ",154],["T_VARIABLE","$editor",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","Editor",155],["T_DOUBLE_COLON","::",155],["T_STRING","create",155],"(","[",["T_WHITESPACE","\n      ",155],["T_CONSTANT_ENCAPSED_STRING","'format'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",156],",",["T_WHITESPACE","\n      ",156],["T_CONSTANT_ENCAPSED_STRING","'editor'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'unicorn'",157],",",["T_WHITESPACE","\n    ",157],"]",")",";",["T_WHITESPACE","\n    ",158],["T_VARIABLE","$editor",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","save",159],"(",")",";",["T_WHITESPACE","\n\n\n    ",159],["T_COMMENT","\/\/ Create node type.\n",162],["T_WHITESPACE","    ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","drupalCreateContentType",163],"(",["T_ARRAY","array",163],"(",["T_WHITESPACE","\n      ",163],["T_CONSTANT_ENCAPSED_STRING","'type'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'article'",164],",",["T_WHITESPACE","\n      ",164],["T_CONSTANT_ENCAPSED_STRING","'name'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'Article'",165],",",["T_WHITESPACE","\n    ",165],")",")",";",["T_WHITESPACE","\n\n    ",166],["T_COMMENT","\/\/ Create 4 users, each with access to different text formats\/editors:\n",168],["T_WHITESPACE","    ",169],["T_COMMENT","\/\/   - \"untrusted\": restricted_without_editor\n",169],["T_WHITESPACE","    ",170],["T_COMMENT","\/\/   - \"normal\": restricted_with_editor,\n",170],["T_WHITESPACE","    ",171],["T_COMMENT","\/\/   - \"trusted\": restricted_plus_dangerous_tag_with_editor\n",171],["T_WHITESPACE","    ",172],["T_COMMENT","\/\/   - \"privileged\": restricted_without_editor, restricted_with_editor,\n",172],["T_WHITESPACE","    ",173],["T_COMMENT","\/\/     restricted_plus_dangerous_tag_with_editor,\n",173],["T_WHITESPACE","    ",174],["T_COMMENT","\/\/     unrestricted_without_editor and unrestricted_with_editor\n",174],["T_WHITESPACE","    ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","untrustedUser",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","drupalCreateUser",175],"(",["T_ARRAY","array",175],"(",["T_WHITESPACE","\n      ",175],["T_CONSTANT_ENCAPSED_STRING","'create article content'",176],",",["T_WHITESPACE","\n      ",176],["T_CONSTANT_ENCAPSED_STRING","'edit any article content'",177],",",["T_WHITESPACE","\n      ",177],["T_CONSTANT_ENCAPSED_STRING","'use text format restricted_without_editor'",178],",",["T_WHITESPACE","\n    ",178],")",")",";",["T_WHITESPACE","\n    ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","normalUser",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","drupalCreateUser",180],"(",["T_ARRAY","array",180],"(",["T_WHITESPACE","\n      ",180],["T_CONSTANT_ENCAPSED_STRING","'create article content'",181],",",["T_WHITESPACE","\n      ",181],["T_CONSTANT_ENCAPSED_STRING","'edit any article content'",182],",",["T_WHITESPACE","\n      ",182],["T_CONSTANT_ENCAPSED_STRING","'use text format restricted_with_editor'",183],",",["T_WHITESPACE","\n    ",183],")",")",";",["T_WHITESPACE","\n    ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","trustedUser",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","drupalCreateUser",185],"(",["T_ARRAY","array",185],"(",["T_WHITESPACE","\n      ",185],["T_CONSTANT_ENCAPSED_STRING","'create article content'",186],",",["T_WHITESPACE","\n      ",186],["T_CONSTANT_ENCAPSED_STRING","'edit any article content'",187],",",["T_WHITESPACE","\n      ",187],["T_CONSTANT_ENCAPSED_STRING","'use text format restricted_plus_dangerous_tag_with_editor'",188],",",["T_WHITESPACE","\n    ",188],")",")",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","privilegedUser",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","drupalCreateUser",190],"(",["T_ARRAY","array",190],"(",["T_WHITESPACE","\n      ",190],["T_CONSTANT_ENCAPSED_STRING","'create article content'",191],",",["T_WHITESPACE","\n      ",191],["T_CONSTANT_ENCAPSED_STRING","'edit any article content'",192],",",["T_WHITESPACE","\n      ",192],["T_CONSTANT_ENCAPSED_STRING","'use text format restricted_without_editor'",193],",",["T_WHITESPACE","\n      ",193],["T_CONSTANT_ENCAPSED_STRING","'use text format restricted_with_editor'",194],",",["T_WHITESPACE","\n      ",194],["T_CONSTANT_ENCAPSED_STRING","'use text format restricted_plus_dangerous_tag_with_editor'",195],",",["T_WHITESPACE","\n      ",195],["T_CONSTANT_ENCAPSED_STRING","'use text format unrestricted_without_editor'",196],",",["T_WHITESPACE","\n      ",196],["T_CONSTANT_ENCAPSED_STRING","'use text format unrestricted_with_editor'",197],",",["T_WHITESPACE","\n    ",197],")",")",";",["T_WHITESPACE","\n\n    ",198],["T_COMMENT","\/\/ Create an \"article\" node for each possible text format, with the same\n",200],["T_WHITESPACE","    ",201],["T_COMMENT","\/\/ sample content, to do our tests on.\n",201],["T_WHITESPACE","    ",202],["T_VARIABLE","$samples",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_ARRAY","array",202],"(",["T_WHITESPACE","\n      ",202],["T_ARRAY","array",203],"(",["T_CONSTANT_ENCAPSED_STRING","'author'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","untrustedUser",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","id",203],"(",")",",",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'format'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",203],")",",",["T_WHITESPACE","\n      ",203],["T_ARRAY","array",204],"(",["T_CONSTANT_ENCAPSED_STRING","'author'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","normalUser",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","id",204],"(",")",",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'format'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",204],")",",",["T_WHITESPACE","\n      ",204],["T_ARRAY","array",205],"(",["T_CONSTANT_ENCAPSED_STRING","'author'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","trustedUser",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","id",205],"(",")",",",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'format'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",205],")",",",["T_WHITESPACE","\n      ",205],["T_ARRAY","array",206],"(",["T_CONSTANT_ENCAPSED_STRING","'author'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","privilegedUser",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","id",206],"(",")",",",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'format'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",206],")",",",["T_WHITESPACE","\n      ",206],["T_ARRAY","array",207],"(",["T_CONSTANT_ENCAPSED_STRING","'author'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","privilegedUser",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","id",207],"(",")",",",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'format'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",207],")",",",["T_WHITESPACE","\n    ",207],")",";",["T_WHITESPACE","\n    ",208],["T_FOREACH","foreach",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$samples",209],["T_WHITESPACE"," ",209],["T_AS","as",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$sample",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n      ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","drupalCreateNode",210],"(",["T_ARRAY","array",210],"(",["T_WHITESPACE","\n        ",210],["T_CONSTANT_ENCAPSED_STRING","'type'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'article'",211],",",["T_WHITESPACE","\n        ",211],["T_CONSTANT_ENCAPSED_STRING","'body'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_ARRAY","array",212],"(",["T_WHITESPACE","\n          ",212],["T_ARRAY","array",213],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_STRING","self",213],["T_DOUBLE_COLON","::",213],["T_VARIABLE","$sampleContent",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'format'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$sample",213],"[",["T_CONSTANT_ENCAPSED_STRING","'format'",213],"]",")",["T_WHITESPACE","\n        ",213],")",",",["T_WHITESPACE","\n        ",214],["T_CONSTANT_ENCAPSED_STRING","'uid'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$sample",215],"[",["T_CONSTANT_ENCAPSED_STRING","'author'",215],"]",["T_WHITESPACE","\n      ",215],")",")",";",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n  ",217],"}",["T_WHITESPACE","\n\n  ",218],["T_DOC_COMMENT","\/**\n   * Tests initial security: is the user safe without switching text formats?\n   *\n   * Tests 8 scenarios. Tests only with a text editor that is not XSS-safe.\n   *\/",220],["T_WHITESPACE","\n  ",224],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","testInitialSecurity",225],"(",")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n    ",225],["T_VARIABLE","$expected",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_WHITESPACE","\n      ",226],["T_ARRAY","array",227],"(",["T_WHITESPACE","\n        ",227],["T_CONSTANT_ENCAPSED_STRING","'node_id'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_LNUMBER","1",228],",",["T_WHITESPACE","\n        ",228],["T_CONSTANT_ENCAPSED_STRING","'format'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",229],",",["T_WHITESPACE","\n        ",229],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",230],["T_WHITESPACE","        ",231],["T_CONSTANT_ENCAPSED_STRING","'value'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_STRING","self",231],["T_DOUBLE_COLON","::",231],["T_VARIABLE","$sampleContent",231],",",["T_WHITESPACE","\n        ",231],["T_CONSTANT_ENCAPSED_STRING","'users'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_ARRAY","array",232],"(",["T_WHITESPACE","\n          ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","untrustedUser",233],",",["T_WHITESPACE","\n          ",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","privilegedUser",234],",",["T_WHITESPACE","\n        ",234],")",",",["T_WHITESPACE","\n      ",235],")",",",["T_WHITESPACE","\n      ",236],["T_ARRAY","array",237],"(",["T_WHITESPACE","\n        ",237],["T_CONSTANT_ENCAPSED_STRING","'node_id'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],["T_LNUMBER","2",238],",",["T_WHITESPACE","\n        ",238],["T_CONSTANT_ENCAPSED_STRING","'format'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",239],",",["T_WHITESPACE","\n        ",239],["T_COMMENT","\/\/ Text editor => XSS filtering.\n",240],["T_WHITESPACE","        ",241],["T_CONSTANT_ENCAPSED_STRING","'value'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_STRING","self",241],["T_DOUBLE_COLON","::",241],["T_VARIABLE","$sampleContentSecured",241],",",["T_WHITESPACE","\n        ",241],["T_CONSTANT_ENCAPSED_STRING","'users'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_ARRAY","array",242],"(",["T_WHITESPACE","\n          ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","normalUser",243],",",["T_WHITESPACE","\n          ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","privilegedUser",244],",",["T_WHITESPACE","\n        ",244],")",",",["T_WHITESPACE","\n      ",245],")",",",["T_WHITESPACE","\n      ",246],["T_ARRAY","array",247],"(",["T_WHITESPACE","\n        ",247],["T_CONSTANT_ENCAPSED_STRING","'node_id'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_LNUMBER","3",248],",",["T_WHITESPACE","\n        ",248],["T_CONSTANT_ENCAPSED_STRING","'format'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",249],",",["T_WHITESPACE","\n        ",249],["T_COMMENT","\/\/ Text editor => XSS filtering.\n",250],["T_WHITESPACE","        ",251],["T_CONSTANT_ENCAPSED_STRING","'value'",251],["T_WHITESPACE"," ",251],["T_DOUBLE_ARROW","=>",251],["T_WHITESPACE"," ",251],["T_STRING","self",251],["T_DOUBLE_COLON","::",251],["T_VARIABLE","$sampleContentSecuredEmbedAllowed",251],",",["T_WHITESPACE","\n        ",251],["T_CONSTANT_ENCAPSED_STRING","'users'",252],["T_WHITESPACE"," ",252],["T_DOUBLE_ARROW","=>",252],["T_WHITESPACE"," ",252],["T_ARRAY","array",252],"(",["T_WHITESPACE","\n          ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","trustedUser",253],",",["T_WHITESPACE","\n          ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","privilegedUser",254],",",["T_WHITESPACE","\n        ",254],")",",",["T_WHITESPACE","\n      ",255],")",",",["T_WHITESPACE","\n      ",256],["T_ARRAY","array",257],"(",["T_WHITESPACE","\n        ",257],["T_CONSTANT_ENCAPSED_STRING","'node_id'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_LNUMBER","4",258],",",["T_WHITESPACE","\n        ",258],["T_CONSTANT_ENCAPSED_STRING","'format'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",259],",",["T_WHITESPACE","\n        ",259],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",260],["T_WHITESPACE","        ",261],["T_CONSTANT_ENCAPSED_STRING","'value'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_STRING","self",261],["T_DOUBLE_COLON","::",261],["T_VARIABLE","$sampleContent",261],",",["T_WHITESPACE","\n        ",261],["T_CONSTANT_ENCAPSED_STRING","'users'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_ARRAY","array",262],"(",["T_WHITESPACE","\n          ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","privilegedUser",263],",",["T_WHITESPACE","\n        ",263],")",",",["T_WHITESPACE","\n      ",264],")",",",["T_WHITESPACE","\n      ",265],["T_ARRAY","array",266],"(",["T_WHITESPACE","\n        ",266],["T_CONSTANT_ENCAPSED_STRING","'node_id'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_LNUMBER","5",267],",",["T_WHITESPACE","\n        ",267],["T_CONSTANT_ENCAPSED_STRING","'format'",268],["T_WHITESPACE"," ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",268],",",["T_WHITESPACE","\n        ",268],["T_COMMENT","\/\/ Text editor, no security filter => no XSS filtering.\n",269],["T_WHITESPACE","        ",270],["T_CONSTANT_ENCAPSED_STRING","'value'",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_STRING","self",270],["T_DOUBLE_COLON","::",270],["T_VARIABLE","$sampleContent",270],",",["T_WHITESPACE","\n        ",270],["T_CONSTANT_ENCAPSED_STRING","'users'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_ARRAY","array",271],"(",["T_WHITESPACE","\n          ",271],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","privilegedUser",272],",",["T_WHITESPACE","\n        ",272],")",",",["T_WHITESPACE","\n      ",273],")",",",["T_WHITESPACE","\n    ",274],")",";",["T_WHITESPACE","\n\n    ",275],["T_COMMENT","\/\/ Log in as each user that may edit the content, and assert the value.\n",277],["T_WHITESPACE","    ",278],["T_FOREACH","foreach",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$expected",278],["T_WHITESPACE"," ",278],["T_AS","as",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$case",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n      ",278],["T_FOREACH","foreach",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$case",279],"[",["T_CONSTANT_ENCAPSED_STRING","'users'",279],"]",["T_WHITESPACE"," ",279],["T_AS","as",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$account",279],")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","pass",280],"(",["T_STRING","format_string",280],"(",["T_CONSTANT_ENCAPSED_STRING","'Scenario: sample %sample_id, %format.'",280],",",["T_WHITESPACE"," ",280],["T_ARRAY","array",280],"(",["T_WHITESPACE","\n          ",280],["T_CONSTANT_ENCAPSED_STRING","'%sample_id'",281],["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$case",281],"[",["T_CONSTANT_ENCAPSED_STRING","'node_id'",281],"]",",",["T_WHITESPACE","\n          ",281],["T_CONSTANT_ENCAPSED_STRING","'%format'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$case",282],"[",["T_CONSTANT_ENCAPSED_STRING","'format'",282],"]",",",["T_WHITESPACE","\n        ",282],")",")",")",";",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","drupalLogin",284],"(",["T_VARIABLE","$account",284],")",";",["T_WHITESPACE","\n        ",284],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","drupalGet",285],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",285],["T_WHITESPACE"," ",285],".",["T_WHITESPACE"," ",285],["T_VARIABLE","$case",285],"[",["T_CONSTANT_ENCAPSED_STRING","'node_id'",285],"]",["T_WHITESPACE"," ",285],".",["T_WHITESPACE"," ",285],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",285],")",";",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$dom_node",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","xpath",286],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/textarea[@id=\"edit-body-0-value\"]'",286],")",";",["T_WHITESPACE","\n        ",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","assertIdentical",287],"(",["T_VARIABLE","$case",287],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",287],"]",",",["T_WHITESPACE"," ",287],["T_STRING_CAST","(string)",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$dom_node",287],"[",["T_LNUMBER","0",287],"]",",",["T_WHITESPACE"," ",287],["T_CONSTANT_ENCAPSED_STRING","'The value was correctly filtered for XSS attack vectors.'",287],")",";",["T_WHITESPACE","\n      ",287],"}",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n  ",289],"}",["T_WHITESPACE","\n\n  ",290],["T_DOC_COMMENT","\/**\n   * Tests administrator security: is the user safe when switching text formats?\n   *\n   * Tests 24 scenarios. Tests only with a text editor that is not XSS-safe.\n   *\n   * When changing from a more restrictive text format with a text editor (or a\n   * text format without a text editor) to a less restrictive text format, it is\n   * possible that a malicious user could trigger an XSS.\n   *\n   * E.g. when switching a piece of text that uses the Restricted HTML text\n   * format and contains a <script> tag to the Full HTML text format, the\n   * <script> tag would be executed. Unless we apply appropriate filtering.\n   *\/",292],["T_WHITESPACE","\n  ",304],["T_FUNCTION","function",305],["T_WHITESPACE"," ",305],["T_STRING","testSwitchingSecurity",305],"(",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n    ",305],["T_VARIABLE","$expected",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_ARRAY","array",306],"(",["T_WHITESPACE","\n      ",306],["T_ARRAY","array",307],"(",["T_WHITESPACE","\n        ",307],["T_CONSTANT_ENCAPSED_STRING","'node_id'",308],["T_WHITESPACE"," ",308],["T_DOUBLE_ARROW","=>",308],["T_WHITESPACE"," ",308],["T_LNUMBER","1",308],",",["T_WHITESPACE","\n        ",308],["T_CONSTANT_ENCAPSED_STRING","'value'",309],["T_WHITESPACE"," ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],["T_STRING","self",309],["T_DOUBLE_COLON","::",309],["T_VARIABLE","$sampleContent",309],",",["T_WHITESPACE"," ",309],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",309],["T_WHITESPACE","        ",310],["T_CONSTANT_ENCAPSED_STRING","'format'",310],["T_WHITESPACE"," ",310],["T_DOUBLE_ARROW","=>",310],["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",310],",",["T_WHITESPACE","\n        ",310],["T_CONSTANT_ENCAPSED_STRING","'switch_to'",311],["T_WHITESPACE"," ",311],["T_DOUBLE_ARROW","=>",311],["T_WHITESPACE"," ",311],["T_ARRAY","array",311],"(",["T_WHITESPACE","\n          ",311],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",312],["T_WHITESPACE"," ",312],["T_DOUBLE_ARROW","=>",312],["T_WHITESPACE"," ",312],["T_STRING","self",312],["T_DOUBLE_COLON","::",312],["T_VARIABLE","$sampleContentSecured",312],",",["T_WHITESPACE","\n          ",312],["T_COMMENT","\/\/ Intersection of restrictions => most strict XSS filtering.\n",313],["T_WHITESPACE","          ",314],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",314],["T_WHITESPACE"," ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_STRING","self",314],["T_DOUBLE_COLON","::",314],["T_VARIABLE","$sampleContentSecured",314],",",["T_WHITESPACE","\n          ",314],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",315],["T_WHITESPACE","          ",316],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",316],["T_WHITESPACE"," ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_STRING","FALSE",316],",",["T_WHITESPACE","\n          ",316],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",317],["T_WHITESPACE"," ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_STRING","self",317],["T_DOUBLE_COLON","::",317],["T_VARIABLE","$sampleContentSecured",317],",",["T_WHITESPACE","\n        ",317],")",",",["T_WHITESPACE","\n      ",318],")",",",["T_WHITESPACE","\n      ",319],["T_ARRAY","array",320],"(",["T_WHITESPACE","\n        ",320],["T_CONSTANT_ENCAPSED_STRING","'node_id'",321],["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_LNUMBER","2",321],",",["T_WHITESPACE","\n        ",321],["T_CONSTANT_ENCAPSED_STRING","'value'",322],["T_WHITESPACE"," ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_STRING","self",322],["T_DOUBLE_COLON","::",322],["T_VARIABLE","$sampleContentSecured",322],",",["T_WHITESPACE"," ",322],["T_COMMENT","\/\/ Text editor => XSS filtering.\n",322],["T_WHITESPACE","        ",323],["T_CONSTANT_ENCAPSED_STRING","'format'",323],["T_WHITESPACE"," ",323],["T_DOUBLE_ARROW","=>",323],["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",323],",",["T_WHITESPACE","\n        ",323],["T_CONSTANT_ENCAPSED_STRING","'switch_to'",324],["T_WHITESPACE"," ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_ARRAY","array",324],"(",["T_WHITESPACE","\n          ",324],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",325],["T_WHITESPACE","          ",326],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",326],["T_WHITESPACE"," ",326],["T_DOUBLE_ARROW","=>",326],["T_WHITESPACE"," ",326],["T_STRING","FALSE",326],",",["T_WHITESPACE","\n          ",326],["T_COMMENT","\/\/ Intersection of restrictions => most strict XSS filtering.\n",327],["T_WHITESPACE","          ",328],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",328],["T_WHITESPACE"," ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],["T_STRING","self",328],["T_DOUBLE_COLON","::",328],["T_VARIABLE","$sampleContentSecured",328],",",["T_WHITESPACE","\n          ",328],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",329],["T_WHITESPACE","          ",330],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",330],["T_WHITESPACE"," ",330],["T_DOUBLE_ARROW","=>",330],["T_WHITESPACE"," ",330],["T_STRING","FALSE",330],",",["T_WHITESPACE","\n          ",330],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_STRING","self",331],["T_DOUBLE_COLON","::",331],["T_VARIABLE","$sampleContentSecured",331],",",["T_WHITESPACE","\n        ",331],")",",",["T_WHITESPACE","\n      ",332],")",",",["T_WHITESPACE","\n      ",333],["T_ARRAY","array",334],"(",["T_WHITESPACE","\n        ",334],["T_CONSTANT_ENCAPSED_STRING","'node_id'",335],["T_WHITESPACE"," ",335],["T_DOUBLE_ARROW","=>",335],["T_WHITESPACE"," ",335],["T_LNUMBER","3",335],",",["T_WHITESPACE","\n        ",335],["T_CONSTANT_ENCAPSED_STRING","'value'",336],["T_WHITESPACE"," ",336],["T_DOUBLE_ARROW","=>",336],["T_WHITESPACE"," ",336],["T_STRING","self",336],["T_DOUBLE_COLON","::",336],["T_VARIABLE","$sampleContentSecuredEmbedAllowed",336],",",["T_WHITESPACE"," ",336],["T_COMMENT","\/\/ Text editor => XSS filtering.\n",336],["T_WHITESPACE","        ",337],["T_CONSTANT_ENCAPSED_STRING","'format'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",337],",",["T_WHITESPACE","\n        ",337],["T_CONSTANT_ENCAPSED_STRING","'switch_to'",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_ARRAY","array",338],"(",["T_WHITESPACE","\n          ",338],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",339],["T_WHITESPACE","          ",340],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",340],["T_WHITESPACE"," ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_STRING","FALSE",340],",",["T_WHITESPACE","\n          ",340],["T_COMMENT","\/\/ Intersection of restrictions => most strict XSS filtering.\n",341],["T_WHITESPACE","          ",342],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",342],["T_WHITESPACE"," ",342],["T_DOUBLE_ARROW","=>",342],["T_WHITESPACE"," ",342],["T_STRING","self",342],["T_DOUBLE_COLON","::",342],["T_VARIABLE","$sampleContentSecured",342],",",["T_WHITESPACE","\n          ",342],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",343],["T_WHITESPACE","          ",344],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",344],["T_WHITESPACE"," ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_STRING","FALSE",344],",",["T_WHITESPACE","\n          ",344],["T_COMMENT","\/\/ Intersection of restrictions => most strict XSS filtering.\n",345],["T_WHITESPACE","          ",346],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",346],["T_WHITESPACE"," ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],["T_STRING","self",346],["T_DOUBLE_COLON","::",346],["T_VARIABLE","$sampleContentSecured",346],",",["T_WHITESPACE","\n        ",346],")",",",["T_WHITESPACE","\n      ",347],")",",",["T_WHITESPACE","\n      ",348],["T_ARRAY","array",349],"(",["T_WHITESPACE","\n        ",349],["T_CONSTANT_ENCAPSED_STRING","'node_id'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_LNUMBER","4",350],",",["T_WHITESPACE","\n        ",350],["T_CONSTANT_ENCAPSED_STRING","'value'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_STRING","self",351],["T_DOUBLE_COLON","::",351],["T_VARIABLE","$sampleContent",351],",",["T_WHITESPACE"," ",351],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",351],["T_WHITESPACE","        ",352],["T_CONSTANT_ENCAPSED_STRING","'format'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",352],",",["T_WHITESPACE","\n        ",352],["T_CONSTANT_ENCAPSED_STRING","'switch_to'",353],["T_WHITESPACE"," ",353],["T_DOUBLE_ARROW","=>",353],["T_WHITESPACE"," ",353],["T_ARRAY","array",353],"(",["T_WHITESPACE","\n          ",353],["T_COMMENT","\/\/ No text editor => no XSS filtering.\n",354],["T_WHITESPACE","          ",355],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",355],["T_WHITESPACE"," ",355],["T_DOUBLE_ARROW","=>",355],["T_WHITESPACE"," ",355],["T_STRING","FALSE",355],",",["T_WHITESPACE","\n          ",355],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_STRING","self",356],["T_DOUBLE_COLON","::",356],["T_VARIABLE","$sampleContentSecured",356],",",["T_WHITESPACE","\n          ",356],["T_COMMENT","\/\/ Intersection of restrictions => most strict XSS filtering.\n",357],["T_WHITESPACE","          ",358],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_STRING","self",358],["T_DOUBLE_COLON","::",358],["T_VARIABLE","$sampleContentSecured",358],",",["T_WHITESPACE","\n          ",358],["T_COMMENT","\/\/ From no editor, no security filters, to editor, still no security\n",359],["T_WHITESPACE","          ",360],["T_COMMENT","\/\/ filters: resulting content when viewed was already vulnerable, so\n",360],["T_WHITESPACE","          ",361],["T_COMMENT","\/\/ it must be intentional.\n",361],["T_WHITESPACE","          ",362],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_STRING","FALSE",362],",",["T_WHITESPACE","\n        ",362],")",",",["T_WHITESPACE","\n      ",363],")",",",["T_WHITESPACE","\n      ",364],["T_ARRAY","array",365],"(",["T_WHITESPACE","\n        ",365],["T_CONSTANT_ENCAPSED_STRING","'node_id'",366],["T_WHITESPACE"," ",366],["T_DOUBLE_ARROW","=>",366],["T_WHITESPACE"," ",366],["T_LNUMBER","5",366],",",["T_WHITESPACE","\n        ",366],["T_CONSTANT_ENCAPSED_STRING","'value'",367],["T_WHITESPACE"," ",367],["T_DOUBLE_ARROW","=>",367],["T_WHITESPACE"," ",367],["T_STRING","self",367],["T_DOUBLE_COLON","::",367],["T_VARIABLE","$sampleContentSecured",367],",",["T_WHITESPACE"," ",367],["T_COMMENT","\/\/ Text editor => XSS filtering.\n",367],["T_WHITESPACE","        ",368],["T_CONSTANT_ENCAPSED_STRING","'format'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_with_editor'",368],",",["T_WHITESPACE","\n        ",368],["T_CONSTANT_ENCAPSED_STRING","'switch_to'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_ARRAY","array",369],"(",["T_WHITESPACE","\n          ",369],["T_COMMENT","\/\/ From editor, no security filters to security filters, no editor: no\n",370],["T_WHITESPACE","          ",371],["T_COMMENT","\/\/ risk.\n",371],["T_WHITESPACE","          ",372],["T_CONSTANT_ENCAPSED_STRING","'restricted_without_editor'",372],["T_WHITESPACE"," ",372],["T_DOUBLE_ARROW","=>",372],["T_WHITESPACE"," ",372],["T_STRING","FALSE",372],",",["T_WHITESPACE","\n          ",372],["T_CONSTANT_ENCAPSED_STRING","'restricted_with_editor'",373],["T_WHITESPACE"," ",373],["T_DOUBLE_ARROW","=>",373],["T_WHITESPACE"," ",373],["T_STRING","self",373],["T_DOUBLE_COLON","::",373],["T_VARIABLE","$sampleContentSecured",373],",",["T_WHITESPACE","\n          ",373],["T_COMMENT","\/\/ Intersection of restrictions => most strict XSS filtering.\n",374],["T_WHITESPACE","          ",375],["T_CONSTANT_ENCAPSED_STRING","'restricted_plus_dangerous_tag_with_editor'",375],["T_WHITESPACE"," ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],["T_STRING","self",375],["T_DOUBLE_COLON","::",375],["T_VARIABLE","$sampleContentSecured",375],",",["T_WHITESPACE","\n          ",375],["T_COMMENT","\/\/ From no editor, no security filters, to editor, still no security\n",376],["T_WHITESPACE","          ",377],["T_COMMENT","\/\/ filters: resulting content when viewed was already vulnerable, so\n",377],["T_WHITESPACE","          ",378],["T_COMMENT","\/\/ it must be intentional.\n",378],["T_WHITESPACE","          ",379],["T_CONSTANT_ENCAPSED_STRING","'unrestricted_without_editor'",379],["T_WHITESPACE"," ",379],["T_DOUBLE_ARROW","=>",379],["T_WHITESPACE"," ",379],["T_STRING","FALSE",379],",",["T_WHITESPACE","\n        ",379],")",",",["T_WHITESPACE","\n      ",380],")",",",["T_WHITESPACE","\n    ",381],")",";",["T_WHITESPACE","\n\n    ",382],["T_COMMENT","\/\/ Log in as the privileged user, and for every sample, do the following:\n",384],["T_WHITESPACE","    ",385],["T_COMMENT","\/\/  - switch to every other text format\/editor\n",385],["T_WHITESPACE","    ",386],["T_COMMENT","\/\/  - assert the XSS-filtered values that we get from the server\n",386],["T_WHITESPACE","    ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","drupalLogin",387],"(",["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","privilegedUser",387],")",";",["T_WHITESPACE","\n    ",387],["T_FOREACH","foreach",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$expected",388],["T_WHITESPACE"," ",388],["T_AS","as",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$case",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n      ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","drupalGet",389],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",389],["T_WHITESPACE"," ",389],".",["T_WHITESPACE"," ",389],["T_VARIABLE","$case",389],"[",["T_CONSTANT_ENCAPSED_STRING","'node_id'",389],"]",["T_WHITESPACE"," ",389],".",["T_WHITESPACE"," ",389],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",389],")",";",["T_WHITESPACE","\n\n      ",389],["T_COMMENT","\/\/ Verify data- attributes.\n",391],["T_WHITESPACE","      ",392],["T_VARIABLE","$dom_node",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","xpath",392],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/textarea[@id=\"edit-body-0-value\"]'",392],")",";",["T_WHITESPACE","\n      ",392],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","assertIdentical",393],"(",["T_STRING","self",393],["T_DOUBLE_COLON","::",393],["T_VARIABLE","$sampleContent",393],",",["T_WHITESPACE"," ",393],["T_STRING_CAST","(string)",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$dom_node",393],"[",["T_LNUMBER","0",393],"]","[",["T_CONSTANT_ENCAPSED_STRING","'data-editor-value-original'",393],"]",",",["T_WHITESPACE"," ",393],["T_CONSTANT_ENCAPSED_STRING","'The data-editor-value-original attribute is correctly set.'",393],")",";",["T_WHITESPACE","\n      ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","assertIdentical",394],"(",["T_CONSTANT_ENCAPSED_STRING","'false'",394],",",["T_WHITESPACE"," ",394],["T_STRING_CAST","(string)",394],["T_WHITESPACE"," ",394],["T_VARIABLE","$dom_node",394],"[",["T_LNUMBER","0",394],"]","[",["T_CONSTANT_ENCAPSED_STRING","'data-editor-value-is-changed'",394],"]",",",["T_WHITESPACE"," ",394],["T_CONSTANT_ENCAPSED_STRING","'The data-editor-value-is-changed attribute is correctly set.'",394],")",";",["T_WHITESPACE","\n\n      ",394],["T_COMMENT","\/\/ Switch to every other text format\/editor and verify the results.\n",396],["T_WHITESPACE","      ",397],["T_FOREACH","foreach",397],["T_WHITESPACE"," ",397],"(",["T_VARIABLE","$case",397],"[",["T_CONSTANT_ENCAPSED_STRING","'switch_to'",397],"]",["T_WHITESPACE"," ",397],["T_AS","as",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$format",397],["T_WHITESPACE"," ",397],["T_DOUBLE_ARROW","=>",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$expected_filtered_value",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n        ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","pass",398],"(",["T_STRING","format_string",398],"(",["T_CONSTANT_ENCAPSED_STRING","'Scenario: sample %sample_id, switch from %original_format to %format.'",398],",",["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",["T_WHITESPACE","\n          ",398],["T_CONSTANT_ENCAPSED_STRING","'%sample_id'",399],["T_WHITESPACE"," ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$case",399],"[",["T_CONSTANT_ENCAPSED_STRING","'node_id'",399],"]",",",["T_WHITESPACE","\n          ",399],["T_CONSTANT_ENCAPSED_STRING","'%original_format'",400],["T_WHITESPACE"," ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$case",400],"[",["T_CONSTANT_ENCAPSED_STRING","'format'",400],"]",",",["T_WHITESPACE","\n          ",400],["T_CONSTANT_ENCAPSED_STRING","'%format'",401],["T_WHITESPACE"," ",401],["T_DOUBLE_ARROW","=>",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$format",401],",",["T_WHITESPACE","\n        ",401],")",")",")",";",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$post",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_ARRAY","array",403],"(",["T_WHITESPACE","\n          ",403],["T_CONSTANT_ENCAPSED_STRING","'value'",404],["T_WHITESPACE"," ",404],["T_DOUBLE_ARROW","=>",404],["T_WHITESPACE"," ",404],["T_STRING","self",404],["T_DOUBLE_COLON","::",404],["T_VARIABLE","$sampleContent",404],",",["T_WHITESPACE","\n          ",404],["T_CONSTANT_ENCAPSED_STRING","'original_format_id'",405],["T_WHITESPACE"," ",405],["T_DOUBLE_ARROW","=>",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$case",405],"[",["T_CONSTANT_ENCAPSED_STRING","'format'",405],"]",",",["T_WHITESPACE","\n        ",405],")",";",["T_WHITESPACE","\n        ",406],["T_VARIABLE","$response",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","drupalPostWithFormat",407],"(",["T_CONSTANT_ENCAPSED_STRING","'editor\/filter_xss\/'",407],["T_WHITESPACE"," ",407],".",["T_WHITESPACE"," ",407],["T_VARIABLE","$format",407],",",["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","'json'",407],",",["T_WHITESPACE"," ",407],["T_VARIABLE","$post",407],")",";",["T_WHITESPACE","\n        ",407],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","assertResponse",408],"(",["T_LNUMBER","200",408],")",";",["T_WHITESPACE","\n        ",408],["T_VARIABLE","$json",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_STRING","Json",409],["T_DOUBLE_COLON","::",409],["T_STRING","decode",409],"(",["T_VARIABLE","$response",409],")",";",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","assertIdentical",410],"(",["T_VARIABLE","$json",410],",",["T_WHITESPACE"," ",410],["T_VARIABLE","$expected_filtered_value",410],",",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","'The value was correctly filtered for XSS attack vectors.'",410],")",";",["T_WHITESPACE","\n      ",410],"}",["T_WHITESPACE","\n    ",411],"}",["T_WHITESPACE","\n  ",412],"}",["T_WHITESPACE","\n\n  ",413],["T_DOC_COMMENT","\/**\n   * Tests the standard text editor XSS filter being overridden.\n   *\/",415],["T_WHITESPACE","\n  ",417],["T_FUNCTION","function",418],["T_WHITESPACE"," ",418],["T_STRING","testEditorXssFilterOverride",418],"(",")",["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n    ",418],["T_COMMENT","\/\/ First: the Standard text editor XSS filter.\n",419],["T_WHITESPACE","    ",420],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","drupalLogin",420],"(",["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","normalUser",420],")",";",["T_WHITESPACE","\n    ",420],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","drupalGet",421],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/2\/edit'",421],")",";",["T_WHITESPACE","\n    ",421],["T_VARIABLE","$dom_node",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","xpath",422],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/textarea[@id=\"edit-body-0-value\"]'",422],")",";",["T_WHITESPACE","\n    ",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","assertIdentical",423],"(",["T_STRING","self",423],["T_DOUBLE_COLON","::",423],["T_VARIABLE","$sampleContentSecured",423],",",["T_WHITESPACE"," ",423],["T_STRING_CAST","(string)",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$dom_node",423],"[",["T_LNUMBER","0",423],"]",",",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'The value was filtered by the Standard text editor XSS filter.'",423],")",";",["T_WHITESPACE","\n\n    ",423],["T_COMMENT","\/\/ Enable editor_test.module's hook_editor_xss_filter_alter() implementation\n",425],["T_WHITESPACE","    ",426],["T_COMMENT","\/\/ to alter the text editor XSS filter class being used.\n",426],["T_WHITESPACE","    ",427],["T_NS_SEPARATOR","\\",427],["T_STRING","Drupal",427],["T_DOUBLE_COLON","::",427],["T_STRING","state",427],"(",")",["T_OBJECT_OPERATOR","->",427],["T_STRING","set",427],"(",["T_CONSTANT_ENCAPSED_STRING","'editor_test_editor_xss_filter_alter_enabled'",427],",",["T_WHITESPACE"," ",427],["T_STRING","TRUE",427],")",";",["T_WHITESPACE","\n\n    ",427],["T_COMMENT","\/\/ First: the Insecure text editor XSS filter.\n",429],["T_WHITESPACE","    ",430],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","drupalGet",430],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/2\/edit'",430],")",";",["T_WHITESPACE","\n    ",430],["T_VARIABLE","$dom_node",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","xpath",431],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/textarea[@id=\"edit-body-0-value\"]'",431],")",";",["T_WHITESPACE","\n    ",431],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","assertIdentical",432],"(",["T_STRING","self",432],["T_DOUBLE_COLON","::",432],["T_VARIABLE","$sampleContent",432],",",["T_WHITESPACE"," ",432],["T_STRING_CAST","(string)",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$dom_node",432],"[",["T_LNUMBER","0",432],"]",",",["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'The value was filtered by the Insecure text editor XSS filter.'",432],")",";",["T_WHITESPACE","\n  ",432],"}",["T_WHITESPACE","\n\n",433],"}",["T_WHITESPACE","\n",435]]