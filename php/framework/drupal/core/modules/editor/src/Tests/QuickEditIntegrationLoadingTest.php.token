[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","editor",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Serialization",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Json",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","EventSubscriber",6],["T_NS_SEPARATOR","\\",6],["T_STRING","MainContentViewSubscriber",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","simpletest",7],["T_NS_SEPARATOR","\\",7],["T_STRING","WebTestBase",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","filter",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FilterFormat",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Tests Quick Edit module integration endpoints.\n *\n * @group editor\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","QuickEditIntegrationLoadingTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","WebTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$modules",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_ARRAY","array",22],"(",["T_CONSTANT_ENCAPSED_STRING","'quickedit'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'filter'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'node'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'editor'",22],")",";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The basic permissions necessary to view content and use in-place editing.\n   *\n   * @var array\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$basicPermissions",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_CONSTANT_ENCAPSED_STRING","'access content'",29],",",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'create article content'",29],",",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'use text format filtered_html'",29],",",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'access contextual links'",29],")",";",["T_WHITESPACE","\n\n  ",29],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","setUp",31],"(",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n    ",31],["T_STRING","parent",32],["T_DOUBLE_COLON","::",32],["T_STRING","setUp",32],"(",")",";",["T_WHITESPACE","\n\n    ",32],["T_COMMENT","\/\/ Create a text format.\n",34],["T_WHITESPACE","    ",35],["T_VARIABLE","$filtered_html_format",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","FilterFormat",35],["T_DOUBLE_COLON","::",35],["T_STRING","create",35],"(",["T_ARRAY","array",35],"(",["T_WHITESPACE","\n      ",35],["T_CONSTANT_ENCAPSED_STRING","'format'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'filtered_html'",36],",",["T_WHITESPACE","\n      ",36],["T_CONSTANT_ENCAPSED_STRING","'name'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'Filtered HTML'",37],",",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'weight'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_LNUMBER","0",38],",",["T_WHITESPACE","\n      ",38],["T_CONSTANT_ENCAPSED_STRING","'filters'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_ARRAY","array",39],"(",["T_WHITESPACE","\n        ",39],["T_CONSTANT_ENCAPSED_STRING","'filter_caption'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_ARRAY","array",40],"(",["T_WHITESPACE","\n          ",40],["T_CONSTANT_ENCAPSED_STRING","'status'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_LNUMBER","1",41],",",["T_WHITESPACE","\n        ",41],")",",",["T_WHITESPACE","\n      ",42],")",",",["T_WHITESPACE","\n    ",43],")",")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$filtered_html_format",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","save",45],"(",")",";",["T_WHITESPACE","\n\n    ",45],["T_COMMENT","\/\/ Create a node type.\n",47],["T_WHITESPACE","    ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","drupalCreateContentType",48],"(",["T_ARRAY","array",48],"(",["T_WHITESPACE","\n      ",48],["T_CONSTANT_ENCAPSED_STRING","'type'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'article'",49],",",["T_WHITESPACE","\n      ",49],["T_CONSTANT_ENCAPSED_STRING","'name'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'Article'",50],",",["T_WHITESPACE","\n    ",50],")",")",";",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Create one node of the above node type using the above text format.\n",53],["T_WHITESPACE","    ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","drupalCreateNode",54],"(",["T_ARRAY","array",54],"(",["T_WHITESPACE","\n      ",54],["T_CONSTANT_ENCAPSED_STRING","'type'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'article'",55],",",["T_WHITESPACE","\n      ",55],["T_CONSTANT_ENCAPSED_STRING","'body'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",["T_WHITESPACE","\n        ",56],["T_LNUMBER","0",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_WHITESPACE","\n          ",57],["T_CONSTANT_ENCAPSED_STRING","'value'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'<p>Do you also love Drupal?<\/p><img src=\"druplicon.png\" data-caption=\"Druplicon\" \/>'",58],",",["T_WHITESPACE","\n          ",58],["T_CONSTANT_ENCAPSED_STRING","'format'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'filtered_html'",59],",",["T_WHITESPACE","\n        ",59],")",["T_WHITESPACE","\n      ",60],")",["T_WHITESPACE","\n    ",61],")",")",";",["T_WHITESPACE","\n  ",62],"}",["T_WHITESPACE","\n\n  ",63],["T_DOC_COMMENT","\/**\n   * Test loading of untransformed text when a user doesn't have access to it.\n   *\/",65],["T_WHITESPACE","\n  ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","testUsersWithoutPermission",68],"(",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n    ",68],["T_COMMENT","\/\/ Create 3 users, each with insufficient permissions, i.e. without either\n",69],["T_WHITESPACE","    ",70],["T_COMMENT","\/\/ or both of the following permissions:\n",70],["T_WHITESPACE","    ",71],["T_COMMENT","\/\/ - the 'access in-place editing' permission\n",71],["T_WHITESPACE","    ",72],["T_COMMENT","\/\/ - the 'edit any article content' permission (necessary to edit node 1)\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$users",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",["T_WHITESPACE","\n      ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","drupalCreateUser",74],"(",["T_STATIC","static",74],["T_DOUBLE_COLON","::",74],["T_VARIABLE","$basicPermissions",74],")",",",["T_WHITESPACE","\n      ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","drupalCreateUser",75],"(",["T_STRING","array_merge",75],"(",["T_STATIC","static",75],["T_DOUBLE_COLON","::",75],["T_VARIABLE","$basicPermissions",75],",",["T_WHITESPACE"," ",75],["T_ARRAY","array",75],"(",["T_CONSTANT_ENCAPSED_STRING","'edit any article content'",75],")",")",")",",",["T_WHITESPACE","\n      ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","drupalCreateUser",76],"(",["T_STRING","array_merge",76],"(",["T_STATIC","static",76],["T_DOUBLE_COLON","::",76],["T_VARIABLE","$basicPermissions",76],",",["T_WHITESPACE"," ",76],["T_ARRAY","array",76],"(",["T_CONSTANT_ENCAPSED_STRING","'access in-place editing'",76],")",")",")",["T_WHITESPACE","\n    ",76],")",";",["T_WHITESPACE","\n\n    ",77],["T_COMMENT","\/\/ Now test with each of the 3 users with insufficient permissions.\n",79],["T_WHITESPACE","    ",80],["T_FOREACH","foreach",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$users",80],["T_WHITESPACE"," ",80],["T_AS","as",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$user",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n      ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","drupalLogin",81],"(",["T_VARIABLE","$user",81],")",";",["T_WHITESPACE","\n      ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","drupalGet",82],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/1'",82],")",";",["T_WHITESPACE","\n\n      ",82],["T_COMMENT","\/\/ Ensure the text is transformed.\n",84],["T_WHITESPACE","      ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","assertRaw",85],"(",["T_CONSTANT_ENCAPSED_STRING","'<p>Do you also love Drupal?<\/p><figure role=\"group\" class=\"caption caption-img\"><img src=\"druplicon.png\" \/><figcaption>Druplicon<\/figcaption><\/figure>'",85],")",";",["T_WHITESPACE","\n\n      ",85],["T_COMMENT","\/\/ Retrieving the untransformed text should result in an empty 403 response.\n",87],["T_WHITESPACE","      ",88],["T_VARIABLE","$response",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","drupalPost",88],"(",["T_CONSTANT_ENCAPSED_STRING","'editor\/'",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'node\/1\/body\/en\/full'",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","''",88],",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",")",",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_STRING","MainContentViewSubscriber",88],["T_DOUBLE_COLON","::",88],["T_STRING","WRAPPER_FORMAT",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'drupal_ajax'",88],")",")",")",";",["T_WHITESPACE","\n      ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertResponse",89],"(",["T_LNUMBER","403",89],")",";",["T_WHITESPACE","\n      ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertIdentical",90],"(",["T_CONSTANT_ENCAPSED_STRING","'{}'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$response",90],")",";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n  ",91],"}",["T_WHITESPACE","\n\n  ",92],["T_DOC_COMMENT","\/**\n   * Test loading of untransformed text when a user does have access to it.\n   *\/",94],["T_WHITESPACE","\n  ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","testUserWithPermission",97],"(",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n    ",97],["T_VARIABLE","$user",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","drupalCreateUser",98],"(",["T_STRING","array_merge",98],"(",["T_STATIC","static",98],["T_DOUBLE_COLON","::",98],["T_VARIABLE","$basicPermissions",98],",",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'edit any article content'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'access in-place editing'",98],")",")",")",";",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","drupalLogin",99],"(",["T_VARIABLE","$user",99],")",";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","drupalGet",100],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/1'",100],")",";",["T_WHITESPACE","\n\n    ",100],["T_COMMENT","\/\/ Ensure the text is transformed.\n",102],["T_WHITESPACE","    ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertRaw",103],"(",["T_CONSTANT_ENCAPSED_STRING","'<p>Do you also love Drupal?<\/p><figure role=\"group\" class=\"caption caption-img\"><img src=\"druplicon.png\" \/><figcaption>Druplicon<\/figcaption><\/figure>'",103],")",";",["T_WHITESPACE","\n\n    ",103],["T_VARIABLE","$response",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","drupalPost",105],"(",["T_CONSTANT_ENCAPSED_STRING","'editor\/'",105],["T_WHITESPACE"," ",105],".",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'node\/1\/body\/en\/full'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","''",105],",",["T_WHITESPACE"," ",105],"[","]",",",["T_WHITESPACE"," ",105],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],"[",["T_STRING","MainContentViewSubscriber",105],["T_DOUBLE_COLON","::",105],["T_STRING","WRAPPER_FORMAT",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'drupal_ajax'",105],"]","]",")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertResponse",106],"(",["T_LNUMBER","200",106],")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$ajax_commands",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","Json",107],["T_DOUBLE_COLON","::",107],["T_STRING","decode",107],"(",["T_VARIABLE","$response",107],")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertIdentical",108],"(",["T_LNUMBER","1",108],",",["T_WHITESPACE"," ",108],["T_STRING","count",108],"(",["T_VARIABLE","$ajax_commands",108],")",",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'The untransformed text POST request results in one AJAX command.'",108],")",";",["T_WHITESPACE","\n    ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assertIdentical",109],"(",["T_CONSTANT_ENCAPSED_STRING","'editorGetUntransformedText'",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$ajax_commands",109],"[",["T_LNUMBER","0",109],"]","[",["T_CONSTANT_ENCAPSED_STRING","'command'",109],"]",",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'The first AJAX command is an editorGetUntransformedText command.'",109],")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertIdentical",110],"(",["T_CONSTANT_ENCAPSED_STRING","'<p>Do you also love Drupal?<\/p><img src=\"druplicon.png\" data-caption=\"Druplicon\" \/>'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$ajax_commands",110],"[",["T_LNUMBER","0",110],"]","[",["T_CONSTANT_ENCAPSED_STRING","'data'",110],"]",",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'The editorGetUntransformedText command contains the expected data.'",110],")",";",["T_WHITESPACE","\n  ",110],"}",["T_WHITESPACE","\n\n",111],"}",["T_WHITESPACE","\n",113]]