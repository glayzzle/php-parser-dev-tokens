[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","editor",3],["T_NS_SEPARATOR","\\",3],["T_STRING","EditorXssFilter",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Html",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Utility",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Xss",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","filter",7],["T_NS_SEPARATOR","\\",7],["T_STRING","FilterFormatInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","editor",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EditorXssFilterInterface",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Defines the standard text editor XSS filter.\n *\/",10],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Standard",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","Xss",13],["T_WHITESPACE"," ",13],["T_IMPLEMENTS","implements",13],["T_WHITESPACE"," ",13],["T_STRING","EditorXssFilterInterface",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",15],["T_WHITESPACE","\n  ",17],["T_PUBLIC","public",18],["T_WHITESPACE"," ",18],["T_STATIC","static",18],["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","filterXss",18],"(",["T_VARIABLE","$html",18],",",["T_WHITESPACE"," ",18],["T_STRING","FilterFormatInterface",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$format",18],",",["T_WHITESPACE"," ",18],["T_STRING","FilterFormatInterface",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$original_format",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_STRING","NULL",18],")",["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n    ",18],["T_COMMENT","\/\/ Apply XSS filtering, but blacklist the <script>, <style>, <link>, <embed>\n",19],["T_WHITESPACE","    ",20],["T_COMMENT","\/\/ and <object> tags.\n",20],["T_WHITESPACE","    ",21],["T_COMMENT","\/\/ The <script> and <style> tags are blacklisted because their contents\n",21],["T_WHITESPACE","    ",22],["T_COMMENT","\/\/ can be malicious (and therefor they are inherently unsafe), whereas for\n",22],["T_WHITESPACE","    ",23],["T_COMMENT","\/\/ all other tags, only their attributes can make them malicious. Since\n",23],["T_WHITESPACE","    ",24],["T_COMMENT","\/\/ \\Drupal\\Component\\Utility\\Xss::filter() protects against malicious\n",24],["T_WHITESPACE","    ",25],["T_COMMENT","\/\/ attributes, we take no blacklisting action.\n",25],["T_WHITESPACE","    ",26],["T_COMMENT","\/\/ The exceptions to the above rule are <link>, <embed> and <object>:\n",26],["T_WHITESPACE","    ",27],["T_COMMENT","\/\/ - <link> because the href attribute allows the attacker to import CSS\n",27],["T_WHITESPACE","    ",28],["T_COMMENT","\/\/   using the HTTP(S) protocols which Xss::filter() considers safe by\n",28],["T_WHITESPACE","    ",29],["T_COMMENT","\/\/   default. The imported remote CSS is applied to the main document, thus\n",29],["T_WHITESPACE","    ",30],["T_COMMENT","\/\/   allowing for the same XSS attacks as a regular <style> tag.\n",30],["T_WHITESPACE","    ",31],["T_COMMENT","\/\/ - <embed> and <object> because these tags allow non-HTML applications or\n",31],["T_WHITESPACE","    ",32],["T_COMMENT","\/\/   content to be embedded using the src or data attributes, respectively.\n",32],["T_WHITESPACE","    ",33],["T_COMMENT","\/\/   This is safe in the case of HTML documents, but not in the case of\n",33],["T_WHITESPACE","    ",34],["T_COMMENT","\/\/   Flash objects for example, that may access\/modify the main document\n",34],["T_WHITESPACE","    ",35],["T_COMMENT","\/\/   directly.\n",35],["T_WHITESPACE","    ",36],["T_COMMENT","\/\/ <iframe> is considered safe because it only allows HTML content to be\n",36],["T_WHITESPACE","    ",37],["T_COMMENT","\/\/ embedded, hence ensuring the same origin policy always applies.\n",37],["T_WHITESPACE","    ",38],["T_VARIABLE","$dangerous_tags",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_CONSTANT_ENCAPSED_STRING","'script'",38],",",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'style'",38],",",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'link'",38],",",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'embed'",38],",",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'object'",38],")",";",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/ Simply blacklisting these five dangerous tags would bring safety, but\n",40],["T_WHITESPACE","    ",41],["T_COMMENT","\/\/ also user frustration: what if a text format is configured to allow\n",41],["T_WHITESPACE","    ",42],["T_COMMENT","\/\/ <embed>, for example? Then we would strip that tag, even though it is\n",42],["T_WHITESPACE","    ",43],["T_COMMENT","\/\/ allowed, thereby causing data loss!\n",43],["T_WHITESPACE","    ",44],["T_COMMENT","\/\/ Therefor, we want to be smarter still. We want to take into account which\n",44],["T_WHITESPACE","    ",45],["T_COMMENT","\/\/ HTML tags are allowed and forbidden by the text format we're filtering\n",45],["T_WHITESPACE","    ",46],["T_COMMENT","\/\/ for, and if we're switching from another text format, we want to take\n",46],["T_WHITESPACE","    ",47],["T_COMMENT","\/\/ that format's allowed and forbidden tags into account as well.\n",47],["T_WHITESPACE","    ",48],["T_COMMENT","\/\/ In other words: we only expect markup allowed in both the original and\n",48],["T_WHITESPACE","    ",49],["T_COMMENT","\/\/ the new format to continue to exist.\n",49],["T_WHITESPACE","    ",50],["T_VARIABLE","$format_restrictions",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$format",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getHtmlRestrictions",50],"(",")",";",["T_WHITESPACE","\n    ",50],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_VARIABLE","$original_format",51],["T_WHITESPACE"," ",51],["T_IS_NOT_IDENTICAL","!==",51],["T_WHITESPACE"," ",51],["T_STRING","NULL",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n      ",51],["T_VARIABLE","$original_format_restrictions",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$original_format",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getHtmlRestrictions",52],"(",")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_COMMENT","\/\/ Any tags that are explicitly blacklisted by the text format must be\n",55],["T_WHITESPACE","    ",56],["T_COMMENT","\/\/ appended to the list of default dangerous tags: if they're explicitly\n",56],["T_WHITESPACE","    ",57],["T_COMMENT","\/\/ forbidden, then we must respect that configuration.\n",57],["T_WHITESPACE","    ",58],["T_COMMENT","\/\/ When switching from another text format, we must use the union of\n",58],["T_WHITESPACE","    ",59],["T_COMMENT","\/\/ forbidden tags: if either text format is more restrictive, then the\n",59],["T_WHITESPACE","    ",60],["T_COMMENT","\/\/ safety expectations of *both* text formats apply.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$forbidden_tags",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","self",61],["T_DOUBLE_COLON","::",61],["T_STRING","getForbiddenTags",61],"(",["T_VARIABLE","$format_restrictions",61],")",";",["T_WHITESPACE","\n    ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$original_format",62],["T_WHITESPACE"," ",62],["T_IS_NOT_IDENTICAL","!==",62],["T_WHITESPACE"," ",62],["T_STRING","NULL",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n      ",62],["T_VARIABLE","$forbidden_tags",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","array_merge",63],"(",["T_VARIABLE","$forbidden_tags",63],",",["T_WHITESPACE"," ",63],["T_STRING","self",63],["T_DOUBLE_COLON","::",63],["T_STRING","getForbiddenTags",63],"(",["T_VARIABLE","$original_format_restrictions",63],")",")",";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_COMMENT","\/\/ Any tags that are explicitly whitelisted by the text format must be\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ removed from the list of default dangerous tags: if they're explicitly\n",67],["T_WHITESPACE","    ",68],["T_COMMENT","\/\/ allowed, then we must respect that configuration.\n",68],["T_WHITESPACE","    ",69],["T_COMMENT","\/\/ When switching from another format, we must use the intersection of\n",69],["T_WHITESPACE","    ",70],["T_COMMENT","\/\/ allowed tags: if either format is more restrictive, then the safety\n",70],["T_WHITESPACE","    ",71],["T_COMMENT","\/\/ expectations of *both* formats apply.\n",71],["T_WHITESPACE","    ",72],["T_VARIABLE","$allowed_tags",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","self",72],["T_DOUBLE_COLON","::",72],["T_STRING","getAllowedTags",72],"(",["T_VARIABLE","$format_restrictions",72],")",";",["T_WHITESPACE","\n    ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$original_format",73],["T_WHITESPACE"," ",73],["T_IS_NOT_IDENTICAL","!==",73],["T_WHITESPACE"," ",73],["T_STRING","NULL",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n      ",73],["T_VARIABLE","$allowed_tags",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","array_intersect",74],"(",["T_VARIABLE","$allowed_tags",74],",",["T_WHITESPACE"," ",74],["T_STRING","self",74],["T_DOUBLE_COLON","::",74],["T_STRING","getAllowedTags",74],"(",["T_VARIABLE","$original_format_restrictions",74],")",")",";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Don't blacklist dangerous tags that are explicitly allowed in both text\n",77],["T_WHITESPACE","    ",78],["T_COMMENT","\/\/ formats.\n",78],["T_WHITESPACE","    ",79],["T_VARIABLE","$blacklisted_tags",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","array_diff",79],"(",["T_VARIABLE","$dangerous_tags",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$allowed_tags",79],")",";",["T_WHITESPACE","\n\n    ",79],["T_COMMENT","\/\/ Also blacklist tags that are explicitly forbidden in either text format.\n",81],["T_WHITESPACE","    ",82],["T_VARIABLE","$blacklisted_tags",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","array_merge",82],"(",["T_VARIABLE","$blacklisted_tags",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$forbidden_tags",82],")",";",["T_WHITESPACE","\n\n    ",82],["T_VARIABLE","$output",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STATIC","static",84],["T_DOUBLE_COLON","::",84],["T_STRING","filter",84],"(",["T_VARIABLE","$html",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$blacklisted_tags",84],")",";",["T_WHITESPACE","\n\n    ",84],["T_COMMENT","\/\/ Since data-attributes can contain encoded HTML markup that could be\n",86],["T_WHITESPACE","    ",87],["T_COMMENT","\/\/ decoded and interpreted by editors, we need to apply XSS filtering to\n",87],["T_WHITESPACE","    ",88],["T_COMMENT","\/\/ their contents.\n",88],["T_WHITESPACE","    ",89],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_STATIC","static",89],["T_DOUBLE_COLON","::",89],["T_STRING","filterXssDataAttributes",89],"(",["T_VARIABLE","$output",89],")",";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Applies a very permissive XSS\/HTML filter to data-attributes.\n   *\n   * @param string $html\n   *   The string to apply the data-attributes filtering to.\n   *\n   * @return string\n   *   The filtered string.\n   *\/",92],["T_WHITESPACE","\n  ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_STATIC","static",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","filterXssDataAttributes",101],"(",["T_VARIABLE","$html",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n    ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_STRING","stristr",102],"(",["T_VARIABLE","$html",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'data-'",102],")",["T_WHITESPACE"," ",102],["T_IS_NOT_IDENTICAL","!==",102],["T_WHITESPACE"," ",102],["T_STRING","FALSE",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n      ",102],["T_VARIABLE","$dom",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","Html",103],["T_DOUBLE_COLON","::",103],["T_STRING","load",103],"(",["T_VARIABLE","$html",103],")",";",["T_WHITESPACE","\n      ",103],["T_VARIABLE","$xpath",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_NS_SEPARATOR","\\",104],["T_STRING","DOMXPath",104],"(",["T_VARIABLE","$dom",104],")",";",["T_WHITESPACE","\n      ",104],["T_FOREACH","foreach",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$xpath",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","query",105],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/@*[starts-with(name(.), \"data-\")]'",105],")",["T_WHITESPACE"," ",105],["T_AS","as",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$node",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n        ",105],["T_COMMENT","\/\/ The data-attributes contain an HTML-encoded value, so we need to\n",106],["T_WHITESPACE","        ",107],["T_COMMENT","\/\/ decode the value, apply XSS filtering and then re-save as encoded\n",107],["T_WHITESPACE","        ",108],["T_COMMENT","\/\/ value. There is no need to explicitly decode $node->value, since the\n",108],["T_WHITESPACE","        ",109],["T_COMMENT","\/\/ DOMAttr::value getter returns the decoded value.\n",109],["T_WHITESPACE","        ",110],["T_VARIABLE","$value",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","Xss",110],["T_DOUBLE_COLON","::",110],["T_STRING","filterAdmin",110],"(",["T_VARIABLE","$node",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","value",110],")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$node",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","value",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","Html",111],["T_DOUBLE_COLON","::",111],["T_STRING","escape",111],"(",["T_VARIABLE","$value",111],")",";",["T_WHITESPACE","\n      ",111],"}",["T_WHITESPACE","\n      ",112],["T_VARIABLE","$html",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","Html",113],["T_DOUBLE_COLON","::",113],["T_STRING","serialize",113],"(",["T_VARIABLE","$dom",113],")",";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$html",116],";",["T_WHITESPACE","\n  ",116],"}",["T_WHITESPACE","\n\n\n  ",117],["T_DOC_COMMENT","\/**\n   * Get all allowed tags from a restrictions data structure.\n   *\n   * @param array|false $restrictions\n   *   Restrictions as returned by FilterInterface::getHTMLRestrictions().\n   *\n   * @return array\n   *   An array of allowed HTML tags.\n   *\n   * @see \\Drupal\\filter\\Plugin\\Filter\\FilterInterface::getHTMLRestrictions()\n   *\/",120],["T_WHITESPACE","\n  ",130],["T_PROTECTED","protected",131],["T_WHITESPACE"," ",131],["T_STATIC","static",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","getAllowedTags",131],"(",["T_VARIABLE","$restrictions",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n    ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$restrictions",132],["T_WHITESPACE"," ",132],["T_IS_IDENTICAL","===",132],["T_WHITESPACE"," ",132],["T_STRING","FALSE",132],["T_WHITESPACE"," ",132],["T_BOOLEAN_OR","||",132],["T_WHITESPACE"," ",132],"!",["T_ISSET","isset",132],"(",["T_VARIABLE","$restrictions",132],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",132],"]",")",")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n      ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",")",";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_VARIABLE","$allowed_tags",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","array_keys",136],"(",["T_VARIABLE","$restrictions",136],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed'",136],"]",")",";",["T_WHITESPACE","\n    ",136],["T_COMMENT","\/\/ Exclude the wildcard tag, which is used to set attribute restrictions on\n",137],["T_WHITESPACE","    ",138],["T_COMMENT","\/\/ all tags simultaneously.\n",138],["T_WHITESPACE","    ",139],["T_VARIABLE","$allowed_tags",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","array_diff",139],"(",["T_VARIABLE","$allowed_tags",139],",",["T_WHITESPACE"," ",139],["T_ARRAY","array",139],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",139],")",")",";",["T_WHITESPACE","\n\n    ",139],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$allowed_tags",141],";",["T_WHITESPACE","\n  ",141],"}",["T_WHITESPACE","\n\n  ",142],["T_DOC_COMMENT","\/**\n   * Get all forbidden tags from a restrictions data structure.\n   *\n   * @param array|false $restrictions\n   *   Restrictions as returned by FilterInterface::getHTMLRestrictions().\n   *\n   * @return array\n   *   An array of forbidden HTML tags.\n   *\n   * @see \\Drupal\\filter\\Plugin\\Filter\\FilterInterface::getHTMLRestrictions()\n   *\/",144],["T_WHITESPACE","\n  ",154],["T_PROTECTED","protected",155],["T_WHITESPACE"," ",155],["T_STATIC","static",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","getForbiddenTags",155],"(",["T_VARIABLE","$restrictions",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n    ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$restrictions",156],["T_WHITESPACE"," ",156],["T_IS_IDENTICAL","===",156],["T_WHITESPACE"," ",156],["T_STRING","FALSE",156],["T_WHITESPACE"," ",156],["T_BOOLEAN_OR","||",156],["T_WHITESPACE"," ",156],"!",["T_ISSET","isset",156],"(",["T_VARIABLE","$restrictions",156],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",156],"]",")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n      ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_ARRAY","array",157],"(",")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n    ",158],["T_ELSE","else",159],["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n      ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$restrictions",160],"[",["T_CONSTANT_ENCAPSED_STRING","'forbidden_tags'",160],"]",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n  ",161],"}",["T_WHITESPACE","\n\n  ",162],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",164],["T_WHITESPACE","\n  ",166],["T_PROTECTED","protected",167],["T_WHITESPACE"," ",167],["T_STATIC","static",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","needsRemoval",167],"(",["T_VARIABLE","$html_tags",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$elem",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n    ",167],["T_COMMENT","\/\/ See static::filterXss() about how this class uses blacklisting instead\n",168],["T_WHITESPACE","    ",169],["T_COMMENT","\/\/ of the normal whitelisting.\n",169],["T_WHITESPACE","    ",170],["T_RETURN","return",170],["T_WHITESPACE"," ",170],"!",["T_STRING","parent",170],["T_DOUBLE_COLON","::",170],["T_STRING","needsRemoval",170],"(",["T_VARIABLE","$html_tags",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$elem",170],")",";",["T_WHITESPACE","\n  ",170],"}",["T_WHITESPACE","\n\n",171],"}",["T_WHITESPACE","\n",173]]