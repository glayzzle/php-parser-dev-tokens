[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Ajax",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Performs tests on AJAX forms in cached pages.\n *\n * @group Ajax\n *\/",5],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","AjaxFormPageCacheTest",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_STRING","AjaxTestBase",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",12],["T_WHITESPACE","\n  ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_FUNCTION","function",15],["T_WHITESPACE"," ",15],["T_STRING","setUp",15],"(",")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n    ",15],["T_STRING","parent",16],["T_DOUBLE_COLON","::",16],["T_STRING","setUp",16],"(",")",";",["T_WHITESPACE","\n\n    ",16],["T_VARIABLE","$config",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","config",18],"(",["T_CONSTANT_ENCAPSED_STRING","'system.performance'",18],")",";",["T_WHITESPACE","\n    ",18],["T_VARIABLE","$config",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","set",19],"(",["T_CONSTANT_ENCAPSED_STRING","'cache.page.max_age'",19],",",["T_WHITESPACE"," ",19],["T_LNUMBER","300",19],")",";",["T_WHITESPACE","\n    ",19],["T_VARIABLE","$config",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","save",20],"(",")",";",["T_WHITESPACE","\n  ",20],"}",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * Return the build id of the current form.\n   *\/",23],["T_WHITESPACE","\n  ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","getFormBuildId",26],"(",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$build_id_fields",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","xpath",27],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/input[@name=\"form_build_id\"]'",27],")",";",["T_WHITESPACE","\n    ",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","assertEqual",28],"(",["T_STRING","count",28],"(",["T_VARIABLE","$build_id_fields",28],")",",",["T_WHITESPACE"," ",28],["T_LNUMBER","1",28],",",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'One form build id field on the page'",28],")",";",["T_WHITESPACE","\n    ",28],["T_RETURN","return",29],["T_WHITESPACE"," ",29],["T_STRING_CAST","(string)",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$build_id_fields",29],"[",["T_LNUMBER","0",29],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",29],"]",";",["T_WHITESPACE","\n  ",29],"}",["T_WHITESPACE","\n\n  ",30],["T_DOC_COMMENT","\/**\n   * Create a simple form, then submit the form via AJAX to change to it.\n   *\/",32],["T_WHITESPACE","\n  ",34],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","testSimpleAJAXFormValue",35],"(",")",["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","drupalGet",36],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_get_form'",36],")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","assertEqual",37],"(",["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","drupalGetHeader",37],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",37],")",",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'MISS'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'Page was not cached.'",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$build_id_initial",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getFormBuildId",38],"(",")",";",["T_WHITESPACE","\n\n    ",38],["T_VARIABLE","$edit",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],"[",["T_CONSTANT_ENCAPSED_STRING","'select'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'green'",40],"]",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$commands",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","drupalPostAjaxForm",41],"(",["T_STRING","NULL",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$edit",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'select'",41],")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$build_id_first_ajax",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getFormBuildId",42],"(",")",";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","assertNotEqual",43],"(",["T_VARIABLE","$build_id_initial",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$build_id_first_ajax",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'Build id is changed in the simpletest-DOM on first AJAX submission'",43],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$expected",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],"[",["T_WHITESPACE","\n      ",44],["T_CONSTANT_ENCAPSED_STRING","'command'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'update_build_id'",45],",",["T_WHITESPACE","\n      ",45],["T_CONSTANT_ENCAPSED_STRING","'old'",46],["T_WHITESPACE"," ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$build_id_initial",46],",",["T_WHITESPACE","\n      ",46],["T_CONSTANT_ENCAPSED_STRING","'new'",47],["T_WHITESPACE"," ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$build_id_first_ajax",47],",",["T_WHITESPACE","\n    ",47],"]",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertCommand",49],"(",["T_VARIABLE","$commands",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$expected",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'Build id change command issued on first AJAX submission'",49],")",";",["T_WHITESPACE","\n\n    ",49],["T_VARIABLE","$edit",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],"[",["T_CONSTANT_ENCAPSED_STRING","'select'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'red'",51],"]",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$commands",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","drupalPostAjaxForm",52],"(",["T_STRING","NULL",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$edit",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'select'",52],")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$build_id_second_ajax",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getFormBuildId",53],"(",")",";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertNotEqual",54],"(",["T_VARIABLE","$build_id_first_ajax",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$build_id_second_ajax",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Build id changes on subsequent AJAX submissions'",54],")",";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$expected",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[",["T_WHITESPACE","\n      ",55],["T_CONSTANT_ENCAPSED_STRING","'command'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'update_build_id'",56],",",["T_WHITESPACE","\n      ",56],["T_CONSTANT_ENCAPSED_STRING","'old'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$build_id_first_ajax",57],",",["T_WHITESPACE","\n      ",57],["T_CONSTANT_ENCAPSED_STRING","'new'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$build_id_second_ajax",58],",",["T_WHITESPACE","\n    ",58],"]",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertCommand",60],"(",["T_VARIABLE","$commands",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$expected",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'Build id change command issued on subsequent AJAX submissions'",60],")",";",["T_WHITESPACE","\n\n    ",60],["T_COMMENT","\/\/ Repeat the test sequence but this time with a page loaded from the cache.\n",62],["T_WHITESPACE","    ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","drupalGet",63],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_get_form'",63],")",";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertEqual",64],"(",["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","drupalGetHeader",64],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",64],")",",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'HIT'",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'Page was cached.'",64],")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$build_id_from_cache_initial",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getFormBuildId",65],"(",")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertEqual",66],"(",["T_VARIABLE","$build_id_initial",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$build_id_from_cache_initial",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'Build id is the same as on the first request'",66],")",";",["T_WHITESPACE","\n\n    ",66],["T_VARIABLE","$edit",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],"[",["T_CONSTANT_ENCAPSED_STRING","'select'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'green'",68],"]",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$commands",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","drupalPostAjaxForm",69],"(",["T_STRING","NULL",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$edit",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'select'",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$build_id_from_cache_first_ajax",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getFormBuildId",70],"(",")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertNotEqual",71],"(",["T_VARIABLE","$build_id_from_cache_initial",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$build_id_from_cache_first_ajax",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'Build id is changed in the simpletest-DOM on first AJAX submission'",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertNotEqual",72],"(",["T_VARIABLE","$build_id_first_ajax",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$build_id_from_cache_first_ajax",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Build id from first user is not reused'",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$expected",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],"[",["T_WHITESPACE","\n      ",73],["T_CONSTANT_ENCAPSED_STRING","'command'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'update_build_id'",74],",",["T_WHITESPACE","\n      ",74],["T_CONSTANT_ENCAPSED_STRING","'old'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$build_id_from_cache_initial",75],",",["T_WHITESPACE","\n      ",75],["T_CONSTANT_ENCAPSED_STRING","'new'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$build_id_from_cache_first_ajax",76],",",["T_WHITESPACE","\n    ",76],"]",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertCommand",78],"(",["T_VARIABLE","$commands",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$expected",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'Build id change command issued on first AJAX submission'",78],")",";",["T_WHITESPACE","\n\n    ",78],["T_VARIABLE","$edit",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],"[",["T_CONSTANT_ENCAPSED_STRING","'select'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'red'",80],"]",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$commands",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","drupalPostAjaxForm",81],"(",["T_STRING","NULL",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$edit",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'select'",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$build_id_from_cache_second_ajax",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getFormBuildId",82],"(",")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertNotEqual",83],"(",["T_VARIABLE","$build_id_from_cache_first_ajax",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$build_id_from_cache_second_ajax",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'Build id changes on subsequent AJAX submissions'",83],")",";",["T_WHITESPACE","\n    ",83],["T_VARIABLE","$expected",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],"[",["T_WHITESPACE","\n      ",84],["T_CONSTANT_ENCAPSED_STRING","'command'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'update_build_id'",85],",",["T_WHITESPACE","\n      ",85],["T_CONSTANT_ENCAPSED_STRING","'old'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$build_id_from_cache_first_ajax",86],",",["T_WHITESPACE","\n      ",86],["T_CONSTANT_ENCAPSED_STRING","'new'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$build_id_from_cache_second_ajax",87],",",["T_WHITESPACE","\n    ",87],"]",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertCommand",89],"(",["T_VARIABLE","$commands",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$expected",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'Build id change command issued on subsequent AJAX submissions'",89],")",";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Tests a form that uses an #ajax callback.\n   *\n   * @see \\Drupal\\system\\Tests\\Ajax\\ElementValidationTest::testAjaxElementValidation()\n   *\/",92],["T_WHITESPACE","\n  ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","testAjaxElementValidation",97],"(",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n    ",97],["T_VARIABLE","$edit",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],"[",["T_CONSTANT_ENCAPSED_STRING","'drivertext'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_STRING","t",98],"(",["T_CONSTANT_ENCAPSED_STRING","'some dumb text'",98],")","]",";",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","drupalPostAjaxForm",99],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_validation_test'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$edit",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'drivertext'",99],")",";",["T_WHITESPACE","\n  ",99],"}",["T_WHITESPACE","\n\n",100],"}",["T_WHITESPACE","\n",102]]