[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Update",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","node",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Node",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests the upgrade path for local actions\/tasks being converted into blocks.\n *\n * @see https:\/\/www.drupal.org\/node\/507488\n *\n * @group system\n *\/",7],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","LocalActionsAndTasksConvertedIntoBlocksUpdateTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_STRING","UpdatePathTestBase",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",16],["T_WHITESPACE","\n  ",18],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_FUNCTION","function",19],["T_WHITESPACE"," ",19],["T_STRING","setDatabaseDumpFiles",19],"(",")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n    ",19],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","databaseDumpFiles",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],"[",["T_WHITESPACE","\n      ",20],["T_DIR","__DIR__",21],["T_WHITESPACE"," ",21],".",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'\/..\/..\/..\/..\/system\/tests\/fixtures\/update\/drupal-8.bare.standard.php.gz'",21],",",["T_WHITESPACE","\n      ",21],["T_DIR","__DIR__",22],["T_WHITESPACE"," ",22],".",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'\/..\/..\/..\/..\/system\/tests\/fixtures\/update\/drupal-8.local-actions-tasks-into-blocks-507488.php'",22],",",["T_WHITESPACE","\n    ",22],"]",";",["T_WHITESPACE","\n  ",23],"}",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",26],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","setUp",29],"(",")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n    ",29],["T_STRING","parent",30],["T_DOUBLE_COLON","::",30],["T_STRING","setUp",30],"(",")",";",["T_WHITESPACE","\n    ",30],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Extension\\ThemeHandlerInterface $theme_handler *\/",31],["T_WHITESPACE","\n    ",31],["T_VARIABLE","$theme_handler",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Drupal",32],["T_DOUBLE_COLON","::",32],["T_STRING","service",32],"(",["T_CONSTANT_ENCAPSED_STRING","'theme_handler'",32],")",";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$theme_handler",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","refreshInfo",33],"(",")",";",["T_WHITESPACE","\n  ",33],"}",["T_WHITESPACE","\n\n  ",34],["T_DOC_COMMENT","\/**\n   * Tests that local actions\/tasks are being converted into blocks.\n   *\/",36],["T_WHITESPACE","\n  ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","testUpdateHookN",39],"(",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","runUpdates",40],"(",")",";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/** @var \\Drupal\\block\\BlockInterface $block_storage *\/",42],["T_WHITESPACE","\n    ",42],["T_VARIABLE","$block_storage",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Drupal",43],["T_DOUBLE_COLON","::",43],["T_STRING","entityManager",43],"(",")",["T_OBJECT_OPERATOR","->",43],["T_STRING","getStorage",43],"(",["T_CONSTANT_ENCAPSED_STRING","'block'",43],")",";",["T_WHITESPACE","\n    ",43],["T_COMMENT","\/* @var \\Drupal\\block\\BlockInterface[] $help_blocks *\/",44],["T_WHITESPACE","\n    ",44],["T_VARIABLE","$help_blocks",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$block_storage",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","loadByProperties",45],"(","[",["T_CONSTANT_ENCAPSED_STRING","'theme'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'bartik'",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'region'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'help'",45],"]",")",";",["T_WHITESPACE","\n\n    ",45],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertRaw",47],"(",["T_CONSTANT_ENCAPSED_STRING","'Because your site has custom theme(s) installed, we had to set local actions and tasks blocks into the content region. Please manually review the block configurations and remove the removed variables from your templates.'",47],")",";",["T_WHITESPACE","\n\n    ",47],["T_COMMENT","\/\/ Disable maintenance mode.\n",49],["T_WHITESPACE","    ",50],["T_COMMENT","\/\/ @todo Can be removed once maintenance mode is automatically turned off\n",50],["T_WHITESPACE","    ",51],["T_COMMENT","\/\/ after updates in https:\/\/www.drupal.org\/node\/2435135.\n",51],["T_WHITESPACE","    ",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Drupal",52],["T_DOUBLE_COLON","::",52],["T_STRING","state",52],"(",")",["T_OBJECT_OPERATOR","->",52],["T_STRING","set",52],"(",["T_CONSTANT_ENCAPSED_STRING","'system.maintenance_mode'",52],",",["T_WHITESPACE"," ",52],["T_STRING","FALSE",52],")",";",["T_WHITESPACE","\n\n    ",52],["T_COMMENT","\/\/ We finished updating so we can log in the user now.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","drupalLogin",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","rootUser",55],")",";",["T_WHITESPACE","\n\n    ",55],["T_VARIABLE","$page",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","Node",57],["T_DOUBLE_COLON","::",57],["T_STRING","create",57],"(","[",["T_WHITESPACE","\n      ",57],["T_CONSTANT_ENCAPSED_STRING","'type'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'page'",58],",",["T_WHITESPACE","\n      ",58],["T_CONSTANT_ENCAPSED_STRING","'title'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'Page node'",59],",",["T_WHITESPACE","\n    ",59],"]",")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$page",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","save",61],"(",")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ Ensures that blocks inside help region has been moved to content region.\n",63],["T_WHITESPACE","    ",64],["T_FOREACH","foreach",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$help_blocks",64],["T_WHITESPACE"," ",64],["T_AS","as",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$block",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n      ",64],["T_VARIABLE","$new_block",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$block_storage",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","load",65],"(",["T_VARIABLE","$block",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","id",65],"(",")",")",";",["T_WHITESPACE","\n      ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertEqual",66],"(",["T_VARIABLE","$new_block",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getRegion",66],"(",")",",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'content'",66],")",";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_COMMENT","\/\/ Local tasks are visible on the node page.\n",69],["T_WHITESPACE","    ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","drupalGet",70],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/'",70],["T_WHITESPACE"," ",70],".",["T_WHITESPACE"," ",70],["T_VARIABLE","$page",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","id",70],"(",")",")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertText",71],"(",["T_STRING","t",71],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit'",71],")",")",";",["T_WHITESPACE","\n\n    ",71],["T_COMMENT","\/\/ Local actions are visible on the content listing page.\n",73],["T_WHITESPACE","    ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","drupalGet",74],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/content'",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$action_link",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","cssSelect",75],"(",["T_CONSTANT_ENCAPSED_STRING","'.action-links'",75],")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertTrue",76],"(",["T_VARIABLE","$action_link",76],")",";",["T_WHITESPACE","\n\n    ",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","drupalGet",78],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/structure\/block\/list\/seven'",78],")",";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Config\\StorageInterface $config_storage *\/",80],["T_WHITESPACE","\n    ",80],["T_VARIABLE","$config_storage",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Drupal",81],["T_DOUBLE_COLON","::",81],["T_STRING","service",81],"(",["T_CONSTANT_ENCAPSED_STRING","'config.storage'",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertTrue",82],"(",["T_VARIABLE","$config_storage",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","exists",82],"(",["T_CONSTANT_ENCAPSED_STRING","'block.block.test_theme_local_tasks'",82],")",",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'Local task block has been created for the custom theme.'",82],")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertTrue",83],"(",["T_VARIABLE","$config_storage",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","exists",83],"(",["T_CONSTANT_ENCAPSED_STRING","'block.block.test_theme_local_actions'",83],")",",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'Local action block has been created for the custom theme.'",83],")",";",["T_WHITESPACE","\n  ",83],"}",["T_WHITESPACE","\n\n",84],"}",["T_WHITESPACE","\n",86]]