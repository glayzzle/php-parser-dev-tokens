[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Ajax",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Ajax",5],["T_NS_SEPARATOR","\\",5],["T_STRING","AddCssCommand",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Ajax",6],["T_NS_SEPARATOR","\\",6],["T_STRING","AlertCommand",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Ajax",7],["T_NS_SEPARATOR","\\",7],["T_STRING","AppendCommand",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Ajax",8],["T_NS_SEPARATOR","\\",8],["T_STRING","HtmlCommand",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Ajax",9],["T_NS_SEPARATOR","\\",9],["T_STRING","PrependCommand",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Ajax",10],["T_NS_SEPARATOR","\\",10],["T_STRING","SettingsCommand",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Core",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Asset",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AttachedAssets",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Performs tests on AJAX framework functions.\n *\n * @group Ajax\n *\/",13],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","FrameworkTest",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_STRING","AjaxTestBase",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n  ",18],["T_DOC_COMMENT","\/**\n   * Verifies the Ajax rendering of a command in the settings.\n   *\/",19],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","testAJAXRender",22],"(",")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n    ",22],["T_COMMENT","\/\/ Verify that settings command is generated if JavaScript settings exist.\n",23],["T_WHITESPACE","    ",24],["T_VARIABLE","$commands",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","drupalGetAjax",24],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax-test\/render'",24],")",";",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$expected",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_NEW","new",25],["T_WHITESPACE"," ",25],["T_STRING","SettingsCommand",25],"(",["T_ARRAY","array",25],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'test'",25],")",",",["T_WHITESPACE"," ",25],["T_STRING","TRUE",25],")",";",["T_WHITESPACE","\n    ",25],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","assertCommand",26],"(",["T_VARIABLE","$commands",26],",",["T_WHITESPACE"," ",26],["T_VARIABLE","$expected",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","render",26],"(",")",",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'JavaScript settings command is present.'",26],")",";",["T_WHITESPACE","\n  ",26],"}",["T_WHITESPACE","\n\n  ",27],["T_DOC_COMMENT","\/**\n   * Tests AjaxResponse::prepare() AJAX commands ordering.\n   *\/",29],["T_WHITESPACE","\n  ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","testOrder",32],"(",")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$expected_commands",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",";",["T_WHITESPACE","\n\n    ",33],["T_COMMENT","\/\/ Expected commands, in a very specific order.\n",35],["T_WHITESPACE","    ",36],["T_VARIABLE","$asset_resolver",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Drupal",36],["T_DOUBLE_COLON","::",36],["T_STRING","service",36],"(",["T_CONSTANT_ENCAPSED_STRING","'asset.resolver'",36],")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$css_collection_renderer",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Drupal",37],["T_DOUBLE_COLON","::",37],["T_STRING","service",37],"(",["T_CONSTANT_ENCAPSED_STRING","'asset.css.collection_renderer'",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$js_collection_renderer",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Drupal",38],["T_DOUBLE_COLON","::",38],["T_STRING","service",38],"(",["T_CONSTANT_ENCAPSED_STRING","'asset.js.collection_renderer'",38],")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$renderer",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Drupal",39],["T_DOUBLE_COLON","::",39],["T_STRING","service",39],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",39],")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$expected_commands",40],"[",["T_LNUMBER","0",40],"]",["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_NEW","new",40],["T_WHITESPACE"," ",40],["T_STRING","SettingsCommand",40],"(",["T_ARRAY","array",40],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'test'",40],")",",",["T_WHITESPACE"," ",40],["T_STRING","TRUE",40],")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$build",41],"[",["T_CONSTANT_ENCAPSED_STRING","'#attached'",41],"]","[",["T_CONSTANT_ENCAPSED_STRING","'library'",41],"]","[","]",["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'ajax_test\/order-css-command'",41],";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$assets",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","AttachedAssets",42],["T_DOUBLE_COLON","::",42],["T_STRING","createFromRenderArray",42],"(",["T_VARIABLE","$build",42],")",";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$css_render_array",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$css_collection_renderer",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","render",43],"(",["T_VARIABLE","$asset_resolver",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getCssAssets",43],"(",["T_VARIABLE","$assets",43],",",["T_WHITESPACE"," ",43],["T_STRING","FALSE",43],")",")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$expected_commands",44],"[",["T_LNUMBER","1",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_NEW","new",44],["T_WHITESPACE"," ",44],["T_STRING","AddCssCommand",44],"(",["T_VARIABLE","$renderer",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","renderRoot",44],"(",["T_VARIABLE","$css_render_array",44],")",")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$build",45],"[",["T_CONSTANT_ENCAPSED_STRING","'#attached'",45],"]","[",["T_CONSTANT_ENCAPSED_STRING","'library'",45],"]","[","]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'ajax_test\/order-header-js-command'",45],";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$build",46],"[",["T_CONSTANT_ENCAPSED_STRING","'#attached'",46],"]","[",["T_CONSTANT_ENCAPSED_STRING","'library'",46],"]","[","]",["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'ajax_test\/order-footer-js-command'",46],";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$assets",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","AttachedAssets",47],["T_DOUBLE_COLON","::",47],["T_STRING","createFromRenderArray",47],"(",["T_VARIABLE","$build",47],")",";",["T_WHITESPACE","\n    ",47],["T_LIST","list",48],"(",["T_VARIABLE","$js_assets_header",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$js_assets_footer",48],")",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$asset_resolver",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getJsAssets",48],"(",["T_VARIABLE","$assets",48],",",["T_WHITESPACE"," ",48],["T_STRING","FALSE",48],")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$js_header_render_array",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$js_collection_renderer",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","render",49],"(",["T_VARIABLE","$js_assets_header",49],")",";",["T_WHITESPACE","\n    ",49],["T_VARIABLE","$js_footer_render_array",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$js_collection_renderer",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","render",50],"(",["T_VARIABLE","$js_assets_footer",50],")",";",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$expected_commands",51],"[",["T_LNUMBER","2",51],"]",["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_NEW","new",51],["T_WHITESPACE"," ",51],["T_STRING","PrependCommand",51],"(",["T_CONSTANT_ENCAPSED_STRING","'head'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$js_header_render_array",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$expected_commands",52],"[",["T_LNUMBER","3",52],"]",["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_NEW","new",52],["T_WHITESPACE"," ",52],["T_STRING","AppendCommand",52],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$js_footer_render_array",52],")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$expected_commands",53],"[",["T_LNUMBER","4",53],"]",["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_NEW","new",53],["T_WHITESPACE"," ",53],["T_STRING","HtmlCommand",53],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Hello, world!'",53],")",";",["T_WHITESPACE","\n\n    ",53],["T_COMMENT","\/\/ Load any page with at least one CSS file, at least one JavaScript file\n",55],["T_WHITESPACE","    ",56],["T_COMMENT","\/\/ and at least one #ajax-powered element. The latter is an assumption of\n",56],["T_WHITESPACE","    ",57],["T_COMMENT","\/\/ drupalPostAjaxForm(), the two former are assumptions of the Ajax\n",57],["T_WHITESPACE","    ",58],["T_COMMENT","\/\/ renderer.\n",58],["T_WHITESPACE","    ",59],["T_COMMENT","\/\/ @todo refactor AJAX Framework + tests to make less assumptions.\n",59],["T_WHITESPACE","    ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","drupalGet",60],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_lazy_load_form'",60],")",";",["T_WHITESPACE","\n\n    ",60],["T_COMMENT","\/\/ Verify AJAX command order \u00e2\u0080\u0094 this should always be the order:\n",62],["T_WHITESPACE","    ",63],["T_COMMENT","\/\/ 1. JavaScript settings\n",63],["T_WHITESPACE","    ",64],["T_COMMENT","\/\/ 2. CSS files\n",64],["T_WHITESPACE","    ",65],["T_COMMENT","\/\/ 3. JavaScript files in the header\n",65],["T_WHITESPACE","    ",66],["T_COMMENT","\/\/ 4. JavaScript files in the footer\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ 5. Any other AJAX commands, in whatever order they were added.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$commands",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","drupalPostAjaxForm",68],"(",["T_STRING","NULL",68],",",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",",",["T_WHITESPACE"," ",68],["T_STRING","NULL",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'ajax-test\/order'",68],",",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",",",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",",",["T_WHITESPACE"," ",68],["T_STRING","NULL",68],",",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertCommand",69],"(",["T_STRING","array_slice",69],"(",["T_VARIABLE","$commands",69],",",["T_WHITESPACE"," ",69],["T_LNUMBER","0",69],",",["T_WHITESPACE"," ",69],["T_LNUMBER","1",69],")",",",["T_WHITESPACE"," ",69],["T_VARIABLE","$expected_commands",69],"[",["T_LNUMBER","0",69],"]",["T_OBJECT_OPERATOR","->",69],["T_STRING","render",69],"(",")",",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'Settings command is first.'",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertCommand",70],"(",["T_STRING","array_slice",70],"(",["T_VARIABLE","$commands",70],",",["T_WHITESPACE"," ",70],["T_LNUMBER","1",70],",",["T_WHITESPACE"," ",70],["T_LNUMBER","1",70],")",",",["T_WHITESPACE"," ",70],["T_VARIABLE","$expected_commands",70],"[",["T_LNUMBER","1",70],"]",["T_OBJECT_OPERATOR","->",70],["T_STRING","render",70],"(",")",",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'CSS command is second (and CSS files are ordered correctly).'",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertCommand",71],"(",["T_STRING","array_slice",71],"(",["T_VARIABLE","$commands",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","2",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","1",71],")",",",["T_WHITESPACE"," ",71],["T_VARIABLE","$expected_commands",71],"[",["T_LNUMBER","2",71],"]",["T_OBJECT_OPERATOR","->",71],["T_STRING","render",71],"(",")",",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'Header JS command is third.'",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertCommand",72],"(",["T_STRING","array_slice",72],"(",["T_VARIABLE","$commands",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","3",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","1",72],")",",",["T_WHITESPACE"," ",72],["T_VARIABLE","$expected_commands",72],"[",["T_LNUMBER","3",72],"]",["T_OBJECT_OPERATOR","->",72],["T_STRING","render",72],"(",")",",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Footer JS command is fourth.'",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","assertCommand",73],"(",["T_STRING","array_slice",73],"(",["T_VARIABLE","$commands",73],",",["T_WHITESPACE"," ",73],["T_LNUMBER","4",73],",",["T_WHITESPACE"," ",73],["T_LNUMBER","1",73],")",",",["T_WHITESPACE"," ",73],["T_VARIABLE","$expected_commands",73],"[",["T_LNUMBER","4",73],"]",["T_OBJECT_OPERATOR","->",73],["T_STRING","render",73],"(",")",",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'HTML command is fifth.'",73],")",";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * Tests the behavior of an error alert command.\n   *\/",76],["T_WHITESPACE","\n  ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","testAJAXRenderError",79],"(",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n    ",79],["T_COMMENT","\/\/ Verify custom error message.\n",80],["T_WHITESPACE","    ",81],["T_VARIABLE","$edit",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",["T_WHITESPACE","\n      ",81],["T_CONSTANT_ENCAPSED_STRING","'message'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'Custom error message.'",82],",",["T_WHITESPACE","\n    ",82],")",";",["T_WHITESPACE","\n    ",83],["T_VARIABLE","$commands",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","drupalGetAjax",84],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax-test\/render-error'",84],",",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$edit",84],")",")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$expected",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_NEW","new",85],["T_WHITESPACE"," ",85],["T_STRING","AlertCommand",85],"(",["T_VARIABLE","$edit",85],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",85],"]",")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertCommand",86],"(",["T_VARIABLE","$commands",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$expected",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","render",86],"(",")",",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'Custom error message is output.'",86],")",";",["T_WHITESPACE","\n  ",86],"}",["T_WHITESPACE","\n\n  ",87],["T_DOC_COMMENT","\/**\n   * Tests that new JavaScript and CSS files are lazy-loaded on an AJAX request.\n   *\/",89],["T_WHITESPACE","\n  ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","testLazyLoad",92],"(",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$asset_resolver",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Drupal",93],["T_DOUBLE_COLON","::",93],["T_STRING","service",93],"(",["T_CONSTANT_ENCAPSED_STRING","'asset.resolver'",93],")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$css_collection_renderer",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Drupal",94],["T_DOUBLE_COLON","::",94],["T_STRING","service",94],"(",["T_CONSTANT_ENCAPSED_STRING","'asset.css.collection_renderer'",94],")",";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$js_collection_renderer",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Drupal",95],["T_DOUBLE_COLON","::",95],["T_STRING","service",95],"(",["T_CONSTANT_ENCAPSED_STRING","'asset.js.collection_renderer'",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$renderer",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Drupal",96],["T_DOUBLE_COLON","::",96],["T_STRING","service",96],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",96],")",";",["T_WHITESPACE","\n\n    ",96],["T_VARIABLE","$expected",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_WHITESPACE","\n      ",98],["T_CONSTANT_ENCAPSED_STRING","'setting_name'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_lazy_load_form_submit'",99],",",["T_WHITESPACE","\n      ",99],["T_CONSTANT_ENCAPSED_STRING","'setting_value'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'executed'",100],",",["T_WHITESPACE","\n      ",100],["T_CONSTANT_ENCAPSED_STRING","'library_1'",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'system\/admin'",101],",",["T_WHITESPACE","\n      ",101],["T_CONSTANT_ENCAPSED_STRING","'library_2'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'system\/drupal.system'",102],",",["T_WHITESPACE","\n    ",102],")",";",["T_WHITESPACE","\n\n    ",103],["T_COMMENT","\/\/ Get the base page.\n",105],["T_WHITESPACE","    ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","drupalGet",106],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_lazy_load_form'",106],")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$original_settings",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getDrupalSettings",107],"(",")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$original_libraries",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","explode",108],"(",["T_CONSTANT_ENCAPSED_STRING","','",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$original_settings",108],"[",["T_CONSTANT_ENCAPSED_STRING","'ajaxPageState'",108],"]","[",["T_CONSTANT_ENCAPSED_STRING","'libraries'",108],"]",")",";",["T_WHITESPACE","\n\n    ",108],["T_COMMENT","\/\/ Verify that the base page doesn't have the settings and files that are to\n",110],["T_WHITESPACE","    ",111],["T_COMMENT","\/\/ be lazy loaded as part of the next requests.\n",111],["T_WHITESPACE","    ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertTrue",112],"(","!",["T_ISSET","isset",112],"(",["T_VARIABLE","$original_settings",112],"[",["T_VARIABLE","$expected",112],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",112],"]","]",")",",",["T_WHITESPACE"," ",112],["T_STRING","format_string",112],"(",["T_CONSTANT_ENCAPSED_STRING","'Page originally lacks the %setting, as expected.'",112],",",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],"(",["T_CONSTANT_ENCAPSED_STRING","'%setting'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$expected",112],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",112],"]",")",")",")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertTrue",113],"(","!",["T_STRING","in_array",113],"(",["T_VARIABLE","$expected",113],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",113],"]",",",["T_WHITESPACE"," ",113],["T_VARIABLE","$original_libraries",113],")",",",["T_WHITESPACE"," ",113],["T_STRING","format_string",113],"(",["T_CONSTANT_ENCAPSED_STRING","'Page originally lacks the %library library, as expected.'",113],",",["T_WHITESPACE"," ",113],["T_ARRAY","array",113],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$expected",113],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",113],"]",")",")",")",";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","assertTrue",114],"(","!",["T_STRING","in_array",114],"(",["T_VARIABLE","$expected",114],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",114],"]",",",["T_WHITESPACE"," ",114],["T_VARIABLE","$original_libraries",114],")",",",["T_WHITESPACE"," ",114],["T_STRING","format_string",114],"(",["T_CONSTANT_ENCAPSED_STRING","'Page originally lacks the %library library, as expected.'",114],",",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$expected",114],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",114],"]",")",")",")",";",["T_WHITESPACE","\n\n    ",114],["T_COMMENT","\/\/ Calculate the expected CSS and JS.\n",116],["T_WHITESPACE","    ",117],["T_VARIABLE","$assets",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_STRING","AttachedAssets",117],"(",")",";",["T_WHITESPACE","\n    ",117],["T_VARIABLE","$assets",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setLibraries",118],"(","[",["T_VARIABLE","$expected",118],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",118],"]","]",")",["T_WHITESPACE","\n      ",118],["T_OBJECT_OPERATOR","->",119],["T_STRING","setAlreadyLoadedLibraries",119],"(",["T_VARIABLE","$original_libraries",119],")",";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$css_render_array",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$css_collection_renderer",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","render",120],"(",["T_VARIABLE","$asset_resolver",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getCssAssets",120],"(",["T_VARIABLE","$assets",120],",",["T_WHITESPACE"," ",120],["T_STRING","FALSE",120],")",")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$expected_css_html",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$renderer",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","renderRoot",121],"(",["T_VARIABLE","$css_render_array",121],")",";",["T_WHITESPACE","\n\n    ",121],["T_VARIABLE","$assets",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","setLibraries",123],"(","[",["T_VARIABLE","$expected",123],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",123],"]","]",")",["T_WHITESPACE","\n      ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","setAlreadyLoadedLibraries",124],"(",["T_VARIABLE","$original_libraries",124],")",";",["T_WHITESPACE","\n    ",124],["T_VARIABLE","$js_assets",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$asset_resolver",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getJsAssets",125],"(",["T_VARIABLE","$assets",125],",",["T_WHITESPACE"," ",125],["T_STRING","FALSE",125],")","[",["T_LNUMBER","1",125],"]",";",["T_WHITESPACE","\n    ",125],["T_UNSET","unset",126],"(",["T_VARIABLE","$js_assets",126],"[",["T_CONSTANT_ENCAPSED_STRING","'drupalSettings'",126],"]",")",";",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$js_render_array",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$js_collection_renderer",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","render",127],"(",["T_VARIABLE","$js_assets",127],")",";",["T_WHITESPACE","\n    ",127],["T_VARIABLE","$expected_js_html",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$renderer",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","renderRoot",128],"(",["T_VARIABLE","$js_render_array",128],")",";",["T_WHITESPACE","\n\n    ",128],["T_COMMENT","\/\/ Submit the AJAX request without triggering files getting added.\n",130],["T_WHITESPACE","    ",131],["T_VARIABLE","$commands",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","drupalPostAjaxForm",131],"(",["T_STRING","NULL",131],",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",["T_CONSTANT_ENCAPSED_STRING","'add_files'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_STRING","FALSE",131],")",",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",["T_CONSTANT_ENCAPSED_STRING","'op'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_STRING","t",131],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",131],")",")",")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$new_settings",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getDrupalSettings",132],"(",")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$new_libraries",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","explode",133],"(",["T_CONSTANT_ENCAPSED_STRING","','",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$new_settings",133],"[",["T_CONSTANT_ENCAPSED_STRING","'ajaxPageState'",133],"]","[",["T_CONSTANT_ENCAPSED_STRING","'libraries'",133],"]",")",";",["T_WHITESPACE","\n\n    ",133],["T_COMMENT","\/\/ Verify the setting was not added when not expected.\n",135],["T_WHITESPACE","    ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertTrue",136],"(","!",["T_ISSET","isset",136],"(",["T_VARIABLE","$new_settings",136],"[",["T_VARIABLE","$expected",136],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",136],"]","]",")",",",["T_WHITESPACE"," ",136],["T_STRING","format_string",136],"(",["T_CONSTANT_ENCAPSED_STRING","'Page still lacks the %setting, as expected.'",136],",",["T_WHITESPACE"," ",136],["T_ARRAY","array",136],"(",["T_CONSTANT_ENCAPSED_STRING","'%setting'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$expected",136],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",136],"]",")",")",")",";",["T_WHITESPACE","\n    ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertTrue",137],"(","!",["T_STRING","in_array",137],"(",["T_VARIABLE","$expected",137],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",137],"]",",",["T_WHITESPACE"," ",137],["T_VARIABLE","$new_libraries",137],")",",",["T_WHITESPACE"," ",137],["T_STRING","format_string",137],"(",["T_CONSTANT_ENCAPSED_STRING","'Page still lacks the %library library, as expected.'",137],",",["T_WHITESPACE"," ",137],["T_ARRAY","array",137],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$expected",137],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",137],"]",")",")",")",";",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertTrue",138],"(","!",["T_STRING","in_array",138],"(",["T_VARIABLE","$expected",138],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",138],"]",",",["T_WHITESPACE"," ",138],["T_VARIABLE","$new_libraries",138],")",",",["T_WHITESPACE"," ",138],["T_STRING","format_string",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Page still lacks the %library library, as expected.'",138],",",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$expected",138],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",138],"]",")",")",")",";",["T_WHITESPACE","\n    ",138],["T_COMMENT","\/\/ Verify a settings command does not add CSS or scripts to drupalSettings\n",139],["T_WHITESPACE","    ",140],["T_COMMENT","\/\/ and no command inserts the corresponding tags on the page.\n",140],["T_WHITESPACE","    ",141],["T_VARIABLE","$found_settings_command",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","FALSE",141],";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$found_markup_command",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","FALSE",142],";",["T_WHITESPACE","\n    ",142],["T_FOREACH","foreach",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$commands",143],["T_WHITESPACE"," ",143],["T_AS","as",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$command",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n      ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$command",144],"[",["T_CONSTANT_ENCAPSED_STRING","'command'",144],"]",["T_WHITESPACE"," ",144],["T_IS_EQUAL","==",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'settings'",144],["T_WHITESPACE"," ",144],["T_BOOLEAN_AND","&&",144],["T_WHITESPACE"," ",144],"(",["T_STRING","array_key_exists",144],"(",["T_CONSTANT_ENCAPSED_STRING","'css'",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$command",144],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",144],"]","[",["T_CONSTANT_ENCAPSED_STRING","'ajaxPageState'",144],"]",")",["T_WHITESPACE"," ",144],["T_BOOLEAN_OR","||",144],["T_WHITESPACE"," ",144],["T_STRING","array_key_exists",144],"(",["T_CONSTANT_ENCAPSED_STRING","'js'",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$command",144],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",144],"]","[",["T_CONSTANT_ENCAPSED_STRING","'ajaxPageState'",144],"]",")",")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$found_settings_command",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","TRUE",145],";",["T_WHITESPACE","\n      ",145],"}",["T_WHITESPACE","\n      ",146],["T_IF","if",147],["T_WHITESPACE"," ",147],"(",["T_ISSET","isset",147],"(",["T_VARIABLE","$command",147],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",147],"]",")",["T_WHITESPACE"," ",147],["T_BOOLEAN_AND","&&",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$command",147],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",147],"]",["T_WHITESPACE"," ",147],["T_IS_EQUAL","==",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$expected_js_html",147],["T_WHITESPACE"," ",147],["T_BOOLEAN_OR","||",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$command",147],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",147],"]",["T_WHITESPACE"," ",147],["T_IS_EQUAL","==",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$expected_css_html",147],")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$found_markup_command",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","TRUE",148],";",["T_WHITESPACE","\n      ",148],"}",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n    ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","assertFalse",151],"(",["T_VARIABLE","$found_settings_command",151],",",["T_WHITESPACE"," ",151],["T_STRING","format_string",151],"(",["T_CONSTANT_ENCAPSED_STRING","'Page state still lacks the %library_1 and %library_2 libraries, as expected.'",151],",",["T_WHITESPACE"," ",151],["T_ARRAY","array",151],"(",["T_CONSTANT_ENCAPSED_STRING","'%library_1'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$expected",151],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",151],"]",",",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'%library_2'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$expected",151],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",151],"]",")",")",")",";",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","assertFalse",152],"(",["T_VARIABLE","$found_markup_command",152],",",["T_WHITESPACE"," ",152],["T_STRING","format_string",152],"(",["T_CONSTANT_ENCAPSED_STRING","'Page still lacks the %library_1 and %library_2 libraries, as expected.'",152],",",["T_WHITESPACE"," ",152],["T_ARRAY","array",152],"(",["T_CONSTANT_ENCAPSED_STRING","'%library_1'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$expected",152],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",152],"]",",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'%library_2'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$expected",152],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",152],"]",")",")",")",";",["T_WHITESPACE","\n\n    ",152],["T_COMMENT","\/\/ Submit the AJAX request and trigger adding files.\n",154],["T_WHITESPACE","    ",155],["T_VARIABLE","$commands",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","drupalPostAjaxForm",155],"(",["T_STRING","NULL",155],",",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],"(",["T_CONSTANT_ENCAPSED_STRING","'add_files'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_STRING","TRUE",155],")",",",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],"(",["T_CONSTANT_ENCAPSED_STRING","'op'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_STRING","t",155],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",155],")",")",")",";",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$new_settings",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getDrupalSettings",156],"(",")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$new_libraries",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","explode",157],"(",["T_CONSTANT_ENCAPSED_STRING","','",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$new_settings",157],"[",["T_CONSTANT_ENCAPSED_STRING","'ajaxPageState'",157],"]","[",["T_CONSTANT_ENCAPSED_STRING","'libraries'",157],"]",")",";",["T_WHITESPACE","\n\n    ",157],["T_COMMENT","\/\/ Verify the expected setting was added, both to drupalSettings, and as\n",159],["T_WHITESPACE","    ",160],["T_COMMENT","\/\/ the first AJAX command.\n",160],["T_WHITESPACE","    ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","assertIdentical",161],"(",["T_VARIABLE","$new_settings",161],"[",["T_VARIABLE","$expected",161],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",161],"]","]",",",["T_WHITESPACE"," ",161],["T_VARIABLE","$expected",161],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_value'",161],"]",",",["T_WHITESPACE"," ",161],["T_STRING","format_string",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Page now has the %setting.'",161],",",["T_WHITESPACE"," ",161],["T_ARRAY","array",161],"(",["T_CONSTANT_ENCAPSED_STRING","'%setting'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$expected",161],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",161],"]",")",")",")",";",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$expected_command",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_NEW","new",162],["T_WHITESPACE"," ",162],["T_STRING","SettingsCommand",162],"(",["T_ARRAY","array",162],"(",["T_VARIABLE","$expected",162],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_name'",162],"]",["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$expected",162],"[",["T_CONSTANT_ENCAPSED_STRING","'setting_value'",162],"]",")",",",["T_WHITESPACE"," ",162],["T_STRING","TRUE",162],")",";",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertCommand",163],"(",["T_STRING","array_slice",163],"(",["T_VARIABLE","$commands",163],",",["T_WHITESPACE"," ",163],["T_LNUMBER","0",163],",",["T_WHITESPACE"," ",163],["T_LNUMBER","1",163],")",",",["T_WHITESPACE"," ",163],["T_VARIABLE","$expected_command",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","render",163],"(",")",",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'The settings command was first.'",163],")",";",["T_WHITESPACE","\n\n    ",163],["T_COMMENT","\/\/ Verify the expected CSS file was added, both to drupalSettings, and as\n",165],["T_WHITESPACE","    ",166],["T_COMMENT","\/\/ the second AJAX command for inclusion into the HTML.\n",166],["T_WHITESPACE","    ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","assertTrue",167],"(",["T_STRING","in_array",167],"(",["T_VARIABLE","$expected",167],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",167],"]",",",["T_WHITESPACE"," ",167],["T_VARIABLE","$new_libraries",167],")",",",["T_WHITESPACE"," ",167],["T_STRING","format_string",167],"(",["T_CONSTANT_ENCAPSED_STRING","'Page state now has the %library library.'",167],",",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$expected",167],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",167],"]",")",")",")",";",["T_WHITESPACE","\n    ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","assertCommand",168],"(",["T_STRING","array_slice",168],"(",["T_VARIABLE","$commands",168],",",["T_WHITESPACE"," ",168],["T_LNUMBER","1",168],",",["T_WHITESPACE"," ",168],["T_LNUMBER","1",168],")",",",["T_WHITESPACE"," ",168],["T_ARRAY","array",168],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$expected_css_html",168],")",",",["T_WHITESPACE"," ",168],["T_STRING","format_string",168],"(",["T_CONSTANT_ENCAPSED_STRING","'Page now has the %library library.'",168],",",["T_WHITESPACE"," ",168],["T_ARRAY","array",168],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$expected",168],"[",["T_CONSTANT_ENCAPSED_STRING","'library_1'",168],"]",")",")",")",";",["T_WHITESPACE","\n\n    ",168],["T_COMMENT","\/\/ Verify the expected JS file was added, both to drupalSettings, and as\n",170],["T_WHITESPACE","    ",171],["T_COMMENT","\/\/ the third AJAX command for inclusion into the HTML. By testing for an\n",171],["T_WHITESPACE","    ",172],["T_COMMENT","\/\/ exact HTML string containing the SCRIPT tag, we also ensure that\n",172],["T_WHITESPACE","    ",173],["T_COMMENT","\/\/ unexpected JavaScript code, such as a jQuery.extend() that would\n",173],["T_WHITESPACE","    ",174],["T_COMMENT","\/\/ potentially clobber rather than properly merge settings, didn't\n",174],["T_WHITESPACE","    ",175],["T_COMMENT","\/\/ accidentally get added.\n",175],["T_WHITESPACE","    ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","assertTrue",176],"(",["T_STRING","in_array",176],"(",["T_VARIABLE","$expected",176],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",176],"]",",",["T_WHITESPACE"," ",176],["T_VARIABLE","$new_libraries",176],")",",",["T_WHITESPACE"," ",176],["T_STRING","format_string",176],"(",["T_CONSTANT_ENCAPSED_STRING","'Page state now has the %library library.'",176],",",["T_WHITESPACE"," ",176],["T_ARRAY","array",176],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$expected",176],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",176],"]",")",")",")",";",["T_WHITESPACE","\n    ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","assertCommand",177],"(",["T_STRING","array_slice",177],"(",["T_VARIABLE","$commands",177],",",["T_WHITESPACE"," ",177],["T_LNUMBER","2",177],",",["T_WHITESPACE"," ",177],["T_LNUMBER","1",177],")",",",["T_WHITESPACE"," ",177],["T_ARRAY","array",177],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$expected_js_html",177],")",",",["T_WHITESPACE"," ",177],["T_STRING","format_string",177],"(",["T_CONSTANT_ENCAPSED_STRING","'Page now has the %library library.'",177],",",["T_WHITESPACE"," ",177],["T_ARRAY","array",177],"(",["T_CONSTANT_ENCAPSED_STRING","'%library'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$expected",177],"[",["T_CONSTANT_ENCAPSED_STRING","'library_2'",177],"]",")",")",")",";",["T_WHITESPACE","\n  ",177],"}",["T_WHITESPACE","\n\n  ",178],["T_DOC_COMMENT","\/**\n   * Tests that drupalSettings.currentPath is not updated on AJAX requests.\n   *\/",180],["T_WHITESPACE","\n  ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","testCurrentPathChange",183],"(",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$commands",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","drupalPostAjaxForm",184],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_lazy_load_form'",184],",",["T_WHITESPACE"," ",184],["T_ARRAY","array",184],"(",["T_CONSTANT_ENCAPSED_STRING","'add_files'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_STRING","FALSE",184],")",",",["T_WHITESPACE"," ",184],["T_ARRAY","array",184],"(",["T_CONSTANT_ENCAPSED_STRING","'op'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_STRING","t",184],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",184],")",")",")",";",["T_WHITESPACE","\n    ",184],["T_FOREACH","foreach",185],["T_WHITESPACE"," ",185],"(",["T_VARIABLE","$commands",185],["T_WHITESPACE"," ",185],["T_AS","as",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$command",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n      ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$command",186],"[",["T_CONSTANT_ENCAPSED_STRING","'command'",186],"]",["T_WHITESPACE"," ",186],["T_IS_EQUAL","==",186],["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","'settings'",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","assertFalse",187],"(",["T_ISSET","isset",187],"(",["T_VARIABLE","$command",187],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",187],"]","[",["T_CONSTANT_ENCAPSED_STRING","'currentPath'",187],"]",")",",",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'Value of drupalSettings.currentPath is not updated after an AJAX request.'",187],")",";",["T_WHITESPACE","\n      ",187],"}",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n  ",189],"}",["T_WHITESPACE","\n\n  ",190],["T_DOC_COMMENT","\/**\n   * Tests that overridden CSS files are not added during lazy load.\n   *\/",192],["T_WHITESPACE","\n  ",194],["T_PUBLIC","public",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","testLazyLoadOverriddenCSS",195],"(",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n    ",195],["T_COMMENT","\/\/ The test theme overrides js.module.css without an implementation,\n",196],["T_WHITESPACE","    ",197],["T_COMMENT","\/\/ thereby removing it.\n",197],["T_WHITESPACE","    ",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Drupal",198],["T_DOUBLE_COLON","::",198],["T_STRING","service",198],"(",["T_CONSTANT_ENCAPSED_STRING","'theme_handler'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","install",198],"(",["T_ARRAY","array",198],"(",["T_CONSTANT_ENCAPSED_STRING","'test_theme'",198],")",")",";",["T_WHITESPACE","\n    ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","config",199],"(",["T_CONSTANT_ENCAPSED_STRING","'system.theme'",199],")",["T_WHITESPACE","\n      ",199],["T_OBJECT_OPERATOR","->",200],["T_STRING","set",200],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",200],",",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'test_theme'",200],")",["T_WHITESPACE","\n      ",200],["T_OBJECT_OPERATOR","->",201],["T_STRING","save",201],"(",")",";",["T_WHITESPACE","\n\n    ",201],["T_COMMENT","\/\/ This gets the form, and emulates an Ajax submission on it, including\n",203],["T_WHITESPACE","    ",204],["T_COMMENT","\/\/ adding markup to the HEAD and BODY for any lazy loaded JS\/CSS files.\n",204],["T_WHITESPACE","    ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","drupalPostAjaxForm",205],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax_forms_test_lazy_load_form'",205],",",["T_WHITESPACE"," ",205],["T_ARRAY","array",205],"(",["T_CONSTANT_ENCAPSED_STRING","'add_files'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_STRING","TRUE",205],")",",",["T_WHITESPACE"," ",205],["T_ARRAY","array",205],"(",["T_CONSTANT_ENCAPSED_STRING","'op'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_STRING","t",205],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",205],")",")",")",";",["T_WHITESPACE","\n\n    ",205],["T_COMMENT","\/\/ Verify that the resulting HTML does not load the overridden CSS file.\n",207],["T_WHITESPACE","    ",208],["T_COMMENT","\/\/ We add a \"?\" to the assertion, because drupalSettings may include\n",208],["T_WHITESPACE","    ",209],["T_COMMENT","\/\/ information about the file; we only really care about whether it appears\n",209],["T_WHITESPACE","    ",210],["T_COMMENT","\/\/ in a LINK or STYLE tag, for which Drupal always adds a query string for\n",210],["T_WHITESPACE","    ",211],["T_COMMENT","\/\/ cache control.\n",211],["T_WHITESPACE","    ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","assertNoText",212],"(",["T_CONSTANT_ENCAPSED_STRING","'js.module.css?'",212],",",["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","'Ajax lazy loading does not add overridden CSS files.'",212],")",";",["T_WHITESPACE","\n  ",212],"}",["T_WHITESPACE","\n\n",213],"}",["T_WHITESPACE","\n",215]]