[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Database",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Tests the temporary query functionality.\n *\n * @group Database\n *\/",5],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","TemporaryQueryTest",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_STRING","DatabaseWebTestBase",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",12],["T_WHITESPACE","\n  ",16],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_STATIC","static",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$modules",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_ARRAY","array",17],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test'",17],")",";",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * Returns the number of rows of a table.\n   *\/",19],["T_WHITESPACE","\n  ",21],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","countTableRows",22],"(",["T_VARIABLE","$table_name",22],")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n    ",22],["T_RETURN","return",23],["T_WHITESPACE"," ",23],["T_STRING","db_select",23],"(",["T_VARIABLE","$table_name",23],")",["T_OBJECT_OPERATOR","->",23],["T_STRING","countQuery",23],"(",")",["T_OBJECT_OPERATOR","->",23],["T_STRING","execute",23],"(",")",["T_OBJECT_OPERATOR","->",23],["T_STRING","fetchField",23],"(",")",";",["T_WHITESPACE","\n  ",23],"}",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * Confirms that temporary tables work and are limited to one request.\n   *\/",26],["T_WHITESPACE","\n  ",28],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","testTemporaryQuery",29],"(",")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","drupalGet",30],"(",["T_CONSTANT_ENCAPSED_STRING","'database_test\/db_query_temporary'",30],")",";",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$data",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","json_decode",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getRawContent",31],"(",")",")",";",["T_WHITESPACE","\n    ",31],["T_IF","if",32],["T_WHITESPACE"," ",32],"(",["T_VARIABLE","$data",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n      ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","assertEqual",33],"(",["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","countTableRows",33],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",33],")",",",["T_WHITESPACE"," ",33],["T_VARIABLE","$data",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","row_count",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'The temporary table contains the correct amount of rows.'",33],")",";",["T_WHITESPACE","\n      ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","assertFalse",34],"(",["T_STRING","db_table_exists",34],"(",["T_VARIABLE","$data",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","table_name",34],")",",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'The temporary table is, indeed, temporary.'",34],")",";",["T_WHITESPACE","\n    ",34],"}",["T_WHITESPACE","\n    ",35],["T_ELSE","else",36],["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n      ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","fail",37],"(",["T_CONSTANT_ENCAPSED_STRING","'The creation of the temporary table failed.'",37],")",";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/ Now try to run two db_query_temporary() in the same request.\n",40],["T_WHITESPACE","    ",41],["T_VARIABLE","$table_name_test",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","db_query_temporary",41],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT name FROM {test}'",41],",",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",")",")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$table_name_task",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","db_query_temporary",42],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pid FROM {test_task}'",42],",",["T_WHITESPACE"," ",42],["T_ARRAY","array",42],"(",")",")",";",["T_WHITESPACE","\n\n    ",42],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","assertEqual",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","countTableRows",44],"(",["T_VARIABLE","$table_name_test",44],")",",",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","countTableRows",44],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",44],")",",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'A temporary table was created successfully in this request.'",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertEqual",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","countTableRows",45],"(",["T_VARIABLE","$table_name_task",45],")",",",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","countTableRows",45],"(",["T_CONSTANT_ENCAPSED_STRING","'test_task'",45],")",",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'A second temporary table was created successfully in this request.'",45],")",";",["T_WHITESPACE","\n\n    ",45],["T_COMMENT","\/\/ Check that leading whitespace and comments do not cause problems\n",47],["T_WHITESPACE","    ",48],["T_COMMENT","\/\/ in the modified query.\n",48],["T_WHITESPACE","    ",49],["T_VARIABLE","$sql",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","\"\n      -- Let's select some rows into a temporary table\n      SELECT name FROM {test}\n    \"",49],";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$table_name_test",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","db_query_temporary",53],"(",["T_VARIABLE","$sql",53],",",["T_WHITESPACE"," ",53],["T_ARRAY","array",53],"(",")",")",";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertEqual",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","countTableRows",54],"(",["T_VARIABLE","$table_name_test",54],")",",",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","countTableRows",54],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",54],")",",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Leading white space and comments do not interfere with temporary table creation.'",54],")",";",["T_WHITESPACE","\n  ",54],"}",["T_WHITESPACE","\n\n",55],"}",["T_WHITESPACE","\n",57]]