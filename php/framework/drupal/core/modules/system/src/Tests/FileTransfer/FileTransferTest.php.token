[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","FileTransfer",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FileTransfer",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FileTransferException",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","StreamWrapper",6],["T_NS_SEPARATOR","\\",6],["T_STRING","PublicStream",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","simpletest",7],["T_NS_SEPARATOR","\\",7],["T_STRING","WebTestBase",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Tests that the jail is respected and that protocols using recursive file move\n * operations work.\n *\n * @group FileTransfer\n *\/",9],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","FileTransferTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","WebTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n  ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$hostname",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'localhost'",16],";",["T_WHITESPACE","\n  ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$username",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'drupal'",17],";",["T_WHITESPACE","\n  ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$password",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'password'",18],";",["T_WHITESPACE","\n  ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$port",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'42'",19],";",["T_WHITESPACE","\n\n  ",19],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","setUp",21],"(",")",["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n    ",21],["T_STRING","parent",22],["T_DOUBLE_COLON","::",22],["T_STRING","setUp",22],"(",")",";",["T_WHITESPACE","\n    ",22],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","testConnection",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_STRING","TestFileTransfer",23],["T_DOUBLE_COLON","::",23],["T_STRING","factory",23],"(",["T_NS_SEPARATOR","\\",23],["T_STRING","Drupal",23],["T_DOUBLE_COLON","::",23],["T_STRING","root",23],"(",")",",",["T_WHITESPACE"," ",23],["T_ARRAY","array",23],"(",["T_CONSTANT_ENCAPSED_STRING","'hostname'",23],["T_WHITESPACE"," ",23],["T_DOUBLE_ARROW","=>",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","hostname",23],",",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'username'",23],["T_WHITESPACE"," ",23],["T_DOUBLE_ARROW","=>",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","username",23],",",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'password'",23],["T_WHITESPACE"," ",23],["T_DOUBLE_ARROW","=>",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","password",23],",",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'port'",23],["T_WHITESPACE"," ",23],["T_DOUBLE_ARROW","=>",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","port",23],")",")",";",["T_WHITESPACE","\n  ",23],"}",["T_WHITESPACE","\n\n  ",24],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","_getFakeModuleFiles",26],"(",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$files",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_ARRAY","array",27],"(",["T_WHITESPACE","\n      ",27],["T_CONSTANT_ENCAPSED_STRING","'fake.module'",28],",",["T_WHITESPACE","\n      ",28],["T_CONSTANT_ENCAPSED_STRING","'fake.info.yml'",29],",",["T_WHITESPACE","\n      ",29],["T_CONSTANT_ENCAPSED_STRING","'theme'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_ARRAY","array",30],"(",["T_WHITESPACE","\n        ",30],["T_CONSTANT_ENCAPSED_STRING","'fake.html.twig'",31],["T_WHITESPACE","\n      ",31],")",",",["T_WHITESPACE","\n      ",32],["T_CONSTANT_ENCAPSED_STRING","'inc'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_WHITESPACE","\n        ",33],["T_CONSTANT_ENCAPSED_STRING","'fake.inc'",34],["T_WHITESPACE","\n      ",34],")",["T_WHITESPACE","\n    ",35],")",";",["T_WHITESPACE","\n    ",36],["T_RETURN","return",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$files",37],";",["T_WHITESPACE","\n  ",37],"}",["T_WHITESPACE","\n\n  ",38],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","_buildFakeModule",40],"(",")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$location",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'temporary:\/\/fake'",41],";",["T_WHITESPACE","\n    ",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(",["T_STRING","is_dir",42],"(",["T_VARIABLE","$location",42],")",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n      ",42],["T_VARIABLE","$ret",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_LNUMBER","0",43],";",["T_WHITESPACE","\n      ",43],["T_VARIABLE","$output",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",")",";",["T_WHITESPACE","\n      ",44],["T_STRING","exec",45],"(",["T_CONSTANT_ENCAPSED_STRING","'rm -Rf '",45],["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_STRING","escapeshellarg",45],"(",["T_VARIABLE","$location",45],")",",",["T_WHITESPACE"," ",45],["T_VARIABLE","$output",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$ret",45],")",";",["T_WHITESPACE","\n      ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$ret",46],["T_WHITESPACE"," ",46],["T_IS_NOT_EQUAL","!=",46],["T_WHITESPACE"," ",46],["T_LNUMBER","0",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n        ",46],["T_THROW","throw",47],["T_WHITESPACE"," ",47],["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_STRING","Exception",47],"(",["T_CONSTANT_ENCAPSED_STRING","'Error removing fake module directory.'",47],")",";",["T_WHITESPACE","\n      ",47],"}",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_VARIABLE","$files",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_getFakeModuleFiles",51],"(",")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_writeDirectory",52],"(",["T_VARIABLE","$location",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$files",52],")",";",["T_WHITESPACE","\n    ",52],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$location",53],";",["T_WHITESPACE","\n  ",53],"}",["T_WHITESPACE","\n\n  ",54],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","_writeDirectory",56],"(",["T_VARIABLE","$base",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$files",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n    ",56],["T_STRING","mkdir",57],"(",["T_VARIABLE","$base",57],")",";",["T_WHITESPACE","\n    ",57],["T_FOREACH","foreach",58],["T_WHITESPACE"," ",58],"(",["T_VARIABLE","$files",58],["T_WHITESPACE"," ",58],["T_AS","as",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$key",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$file",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n      ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_STRING","is_array",59],"(",["T_VARIABLE","$file",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_writeDirectory",60],"(",["T_VARIABLE","$base",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_STRING","DIRECTORY_SEPARATOR",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_VARIABLE","$key",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$file",60],")",";",["T_WHITESPACE","\n      ",60],"}",["T_WHITESPACE","\n      ",61],["T_ELSE","else",62],["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n        ",62],["T_COMMENT","\/\/just write the filename into the file\n",63],["T_WHITESPACE","        ",64],["T_STRING","file_put_contents",64],"(",["T_VARIABLE","$base",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_STRING","DIRECTORY_SEPARATOR",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_VARIABLE","$file",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$file",64],")",";",["T_WHITESPACE","\n      ",64],"}",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n  ",66],"}",["T_WHITESPACE","\n\n  ",67],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","testJail",69],"(",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$source",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_buildFakeModule",70],"(",")",";",["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/\/ This convoluted piece of code is here because our testing framework does\n",72],["T_WHITESPACE","    ",73],["T_COMMENT","\/\/ not support expecting exceptions.\n",73],["T_WHITESPACE","    ",74],["T_VARIABLE","$gotit",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","FALSE",74],";",["T_WHITESPACE","\n    ",74],["T_TRY","try",75],["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n      ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","testConnection",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","copyDirectory",76],"(",["T_VARIABLE","$source",76],",",["T_WHITESPACE"," ",76],["T_STRING","sys_get_temp_dir",76],"(",")",")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n    ",77],["T_CATCH","catch",78],["T_WHITESPACE"," ",78],"(",["T_STRING","FileTransferException",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$e",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n      ",78],["T_VARIABLE","$gotit",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","TRUE",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","assertTrue",81],"(",["T_VARIABLE","$gotit",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'Was not able to copy a directory outside of the jailed area.'",81],")",";",["T_WHITESPACE","\n\n    ",81],["T_VARIABLE","$gotit",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","TRUE",83],";",["T_WHITESPACE","\n    ",83],["T_TRY","try",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n      ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","testConnection",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","copyDirectory",85],"(",["T_VARIABLE","$source",85],",",["T_WHITESPACE"," ",85],["T_NS_SEPARATOR","\\",85],["T_STRING","Drupal",85],["T_DOUBLE_COLON","::",85],["T_STRING","root",85],"(",")",["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'\/'",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_STRING","PublicStream",85],["T_DOUBLE_COLON","::",85],["T_STRING","basePath",85],"(",")",")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n    ",86],["T_CATCH","catch",87],["T_WHITESPACE"," ",87],"(",["T_STRING","FileTransferException",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$e",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_VARIABLE","$gotit",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","FALSE",88],";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertTrue",90],"(",["T_VARIABLE","$gotit",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'Was able to copy a directory inside of the jailed area'",90],")",";",["T_WHITESPACE","\n  ",90],"}",["T_WHITESPACE","\n\n",91],"}",["T_WHITESPACE","\n",93]]