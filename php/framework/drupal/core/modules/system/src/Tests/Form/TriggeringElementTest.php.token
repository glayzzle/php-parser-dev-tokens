[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Form",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","simpletest",5],["T_NS_SEPARATOR","\\",5],["T_STRING","WebTestBase",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests that FAPI correctly determines the triggering element.\n *\n * @group Form\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","TriggeringElementTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","WebTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",14],["T_WHITESPACE","\n  ",18],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_STATIC","static",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$modules",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_ARRAY","array",19],"(",["T_CONSTANT_ENCAPSED_STRING","'form_test'",19],")",";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * Test the determination of the triggering element when no button\n   * information is included in the POST data, as is sometimes the case when\n   * the ENTER key is pressed in a textfield in Internet Explorer.\n   *\/",21],["T_WHITESPACE","\n  ",25],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","testNoButtonInfoInPost",26],"(",")",["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$path",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'form-test\/clicked-button'",27],";",["T_WHITESPACE","\n    ",27],["T_VARIABLE","$edit",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_ARRAY","array",28],"(",")",";",["T_WHITESPACE","\n    ",28],["T_VARIABLE","$form_html_id",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'form-test-clicked-button'",29],";",["T_WHITESPACE","\n\n    ",29],["T_COMMENT","\/\/ Ensure submitting a form with no buttons results in no triggering element\n",31],["T_WHITESPACE","    ",32],["T_COMMENT","\/\/ and the form submit handler not running.\n",32],["T_WHITESPACE","    ",33],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","drupalPostForm",33],"(",["T_VARIABLE","$path",33],",",["T_WHITESPACE"," ",33],["T_VARIABLE","$edit",33],",",["T_WHITESPACE"," ",33],["T_STRING","NULL",33],",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_VARIABLE","$form_html_id",33],")",";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","assertText",34],"(",["T_CONSTANT_ENCAPSED_STRING","'There is no clicked button.'",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to NULL.'",34],")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","assertNoText",35],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",35],",",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler did not execute.'",35],")",";",["T_WHITESPACE","\n\n    ",35],["T_COMMENT","\/\/ Ensure submitting a form with one or more submit buttons results in the\n",37],["T_WHITESPACE","    ",38],["T_COMMENT","\/\/ triggering element being set to the first one the user has access to. An\n",38],["T_WHITESPACE","    ",39],["T_COMMENT","\/\/ argument with 'r' in it indicates a restricted (#access=FALSE) button.\n",39],["T_WHITESPACE","    ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","drupalPostForm",40],"(",["T_VARIABLE","$path",40],["T_WHITESPACE"," ",40],".",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'\/s'",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$edit",40],",",["T_WHITESPACE"," ",40],["T_STRING","NULL",40],",",["T_WHITESPACE"," ",40],["T_ARRAY","array",40],"(",")",",",["T_WHITESPACE"," ",40],["T_ARRAY","array",40],"(",")",",",["T_WHITESPACE"," ",40],["T_VARIABLE","$form_html_id",40],")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","assertText",41],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button1.'",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to only button.'",41],")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","assertText",42],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler executed.'",42],")",";",["T_WHITESPACE","\n\n    ",42],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","drupalPostForm",44],"(",["T_VARIABLE","$path",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'\/s\/s'",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$edit",44],",",["T_WHITESPACE"," ",44],["T_STRING","NULL",44],",",["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",")",",",["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",")",",",["T_WHITESPACE"," ",44],["T_VARIABLE","$form_html_id",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertText",45],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button1.'",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to first button.'",45],")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","assertText",46],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler executed.'",46],")",";",["T_WHITESPACE","\n\n    ",46],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","drupalPostForm",48],"(",["T_VARIABLE","$path",48],["T_WHITESPACE"," ",48],".",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'\/rs\/s'",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$edit",48],",",["T_WHITESPACE"," ",48],["T_STRING","NULL",48],",",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",",",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",",",["T_WHITESPACE"," ",48],["T_VARIABLE","$form_html_id",48],")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertText",49],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button2.'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to first available button.'",49],")",";",["T_WHITESPACE","\n    ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","assertText",50],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",50],",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler executed.'",50],")",";",["T_WHITESPACE","\n\n    ",50],["T_COMMENT","\/\/ Ensure submitting a form with buttons of different types results in the\n",52],["T_WHITESPACE","    ",53],["T_COMMENT","\/\/ triggering element being set to the first button, regardless of type. For\n",53],["T_WHITESPACE","    ",54],["T_COMMENT","\/\/ the FAPI 'button' type, this should result in the submit handler not\n",54],["T_WHITESPACE","    ",55],["T_COMMENT","\/\/ executing. The types are 's'(ubmit), 'b'(utton), and 'i'(mage_button).\n",55],["T_WHITESPACE","    ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","drupalPostForm",56],"(",["T_VARIABLE","$path",56],["T_WHITESPACE"," ",56],".",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'\/s\/b\/i'",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$edit",56],",",["T_WHITESPACE"," ",56],["T_STRING","NULL",56],",",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",")",",",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",")",",",["T_WHITESPACE"," ",56],["T_VARIABLE","$form_html_id",56],")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertText",57],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button1.'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to first button.'",57],")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertText",58],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler executed.'",58],")",";",["T_WHITESPACE","\n\n    ",58],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","drupalPostForm",60],"(",["T_VARIABLE","$path",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'\/b\/s\/i'",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$edit",60],",",["T_WHITESPACE"," ",60],["T_STRING","NULL",60],",",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",")",",",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",")",",",["T_WHITESPACE"," ",60],["T_VARIABLE","$form_html_id",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertText",61],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button1.'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to first button.'",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertNoText",62],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler did not execute.'",62],")",";",["T_WHITESPACE","\n\n    ",62],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","drupalPostForm",64],"(",["T_VARIABLE","$path",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'\/i\/s\/b'",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$edit",64],",",["T_WHITESPACE"," ",64],["T_STRING","NULL",64],",",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",",",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",",",["T_WHITESPACE"," ",64],["T_VARIABLE","$form_html_id",64],")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertText",65],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button1.'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() set to first button.'",65],")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertText",66],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit handler for form_test_clicked_button executed.'",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'Form submit handler executed.'",66],")",";",["T_WHITESPACE","\n  ",66],"}",["T_WHITESPACE","\n\n  ",67],["T_DOC_COMMENT","\/**\n   * Test that the triggering element does not get set to a button with\n   * #access=FALSE.\n   *\/",69],["T_WHITESPACE","\n  ",72],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","testAttemptAccessControlBypass",73],"(",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$path",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'form-test\/clicked-button'",74],";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$form_html_id",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'form-test-clicked-button'",75],";",["T_WHITESPACE","\n\n    ",75],["T_COMMENT","\/\/ Retrieve a form where 'button1' has #access=FALSE and 'button2' doesn't.\n",77],["T_WHITESPACE","    ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","drupalGet",78],"(",["T_VARIABLE","$path",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'\/rs\/s'",78],")",";",["T_WHITESPACE","\n\n    ",78],["T_COMMENT","\/\/ Submit the form with 'button1=button1' in the POST data, which someone\n",80],["T_WHITESPACE","    ",81],["T_COMMENT","\/\/ trying to get around security safeguards could easily do. We have to do\n",81],["T_WHITESPACE","    ",82],["T_COMMENT","\/\/ a little trickery here, to work around the safeguards in drupalPostForm(): by\n",82],["T_WHITESPACE","    ",83],["T_COMMENT","\/\/ renaming the text field that is in the form to 'button1', we can get the\n",83],["T_WHITESPACE","    ",84],["T_COMMENT","\/\/ data we want into \\Drupal::request()->request.\n",84],["T_WHITESPACE","    ",85],["T_VARIABLE","$elements",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","xpath",85],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/form[@id=\"'",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_VARIABLE","$form_html_id",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'\"]\/\/input[@name=\"text\"]'",85],")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$elements",86],"[",["T_LNUMBER","0",86],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",86],"]",["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'button1'",86],";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","drupalPostForm",87],"(",["T_STRING","NULL",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'button1'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'button1'",87],")",",",["T_WHITESPACE"," ",87],["T_STRING","NULL",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",")",",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",")",",",["T_WHITESPACE"," ",87],["T_VARIABLE","$form_html_id",87],")",";",["T_WHITESPACE","\n\n    ",87],["T_COMMENT","\/\/ Ensure that the triggering element was not set to the restricted button.\n",89],["T_WHITESPACE","    ",90],["T_COMMENT","\/\/ Do this with both a negative and positive assertion, because negative\n",90],["T_WHITESPACE","    ",91],["T_COMMENT","\/\/ assertions alone can be brittle. See testNoButtonInfoInPost() for why the\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/triggering element gets set to 'button2'.\n",92],["T_WHITESPACE","    ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertNoText",93],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button1.'",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() not set to a restricted button.'",93],")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertText",94],"(",["T_CONSTANT_ENCAPSED_STRING","'The clicked button is button2.'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'$form_state->getTriggeringElement() not set to a restricted button.'",94],")",";",["T_WHITESPACE","\n  ",94],"}",["T_WHITESPACE","\n\n",95],"}",["T_WHITESPACE","\n",97]]