[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Form",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Field",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FieldStorageDefinitionInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Url",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","field",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","FieldConfig",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","simpletest",8],["T_NS_SEPARATOR","\\",8],["T_STRING","WebTestBase",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","field",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FieldStorageConfig",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Tests functionality of \\Drupal\\Core\\Form\\FormBuilderInterface::rebuildForm().\n *\n * @group Form\n * @todo Add tests for other aspects of form rebuilding.\n *\/",11],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","RebuildTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_STRING","WebTestBase",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",19],["T_WHITESPACE","\n  ",23],["T_PUBLIC","public",24],["T_WHITESPACE"," ",24],["T_STATIC","static",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$modules",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_ARRAY","array",24],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",24],",",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'form_test'",24],")",";",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * A user for testing.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",26],["T_WHITESPACE","\n  ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$webUser",31],";",["T_WHITESPACE","\n\n  ",31],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","setUp",33],"(",")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_STRING","parent",34],["T_DOUBLE_COLON","::",34],["T_STRING","setUp",34],"(",")",";",["T_WHITESPACE","\n\n    ",34],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","drupalCreateContentType",36],"(",["T_ARRAY","array",36],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'page'",36],",",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'name'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'Basic page'",36],")",")",";",["T_WHITESPACE","\n\n    ",36],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","webUser",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","drupalCreateUser",38],"(",["T_ARRAY","array",38],"(",["T_CONSTANT_ENCAPSED_STRING","'access content'",38],")",")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","drupalLogin",39],"(",["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","webUser",39],")",";",["T_WHITESPACE","\n  ",39],"}",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * Tests preservation of values.\n   *\/",42],["T_WHITESPACE","\n  ",44],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testRebuildPreservesValues",45],"(",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$edit",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_ARRAY","array",46],"(",["T_WHITESPACE","\n      ",46],["T_CONSTANT_ENCAPSED_STRING","'checkbox_1_default_off'",47],["T_WHITESPACE"," ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_STRING","TRUE",47],",",["T_WHITESPACE","\n      ",47],["T_CONSTANT_ENCAPSED_STRING","'checkbox_1_default_on'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_STRING","FALSE",48],",",["T_WHITESPACE","\n      ",48],["T_CONSTANT_ENCAPSED_STRING","'text_1'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'foo'",49],",",["T_WHITESPACE","\n    ",49],")",";",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalPostForm",51],"(",["T_CONSTANT_ENCAPSED_STRING","'form-test\/form-rebuild-preserve-values'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$edit",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'Add more'",51],")",";",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Verify that initial elements retained their submitted values.\n",53],["T_WHITESPACE","    ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertFieldChecked",54],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-checkbox-1-default-off'",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'A submitted checked checkbox retained its checked state during a rebuild.'",54],")",";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","assertNoFieldChecked",55],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-checkbox-1-default-on'",55],",",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'A submitted unchecked checkbox retained its unchecked state during a rebuild.'",55],")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertFieldById",56],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-text-1'",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'foo'",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'A textfield retained its submitted value during a rebuild.'",56],")",";",["T_WHITESPACE","\n\n    ",56],["T_COMMENT","\/\/ Verify that newly added elements were initialized with their default values.\n",58],["T_WHITESPACE","    ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertFieldChecked",59],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-checkbox-2-default-on'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'A newly added checkbox was initialized with a default checked state.'",59],")",";",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertNoFieldChecked",60],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-checkbox-2-default-off'",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'A newly added checkbox was initialized with a default unchecked state.'",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertFieldById",61],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-text-2'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'DEFAULT 2'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'A newly added textfield was initialized with its default value.'",61],")",";",["T_WHITESPACE","\n  ",61],"}",["T_WHITESPACE","\n\n  ",62],["T_DOC_COMMENT","\/**\n   * Tests that a form's action is retained after an Ajax submission.\n   *\n   * The 'action' attribute of a form should not change after an Ajax submission\n   * followed by a non-Ajax submission, which triggers a validation error.\n   *\/",64],["T_WHITESPACE","\n  ",69],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","testPreserveFormActionAfterAJAX",70],"(",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_COMMENT","\/\/ Create a multi-valued field for 'page' nodes to use for Ajax testing.\n",71],["T_WHITESPACE","    ",72],["T_VARIABLE","$field_name",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'field_ajax_test'",72],";",["T_WHITESPACE","\n    ",72],["T_STRING","FieldStorageConfig",73],["T_DOUBLE_COLON","::",73],["T_STRING","create",73],"(",["T_ARRAY","array",73],"(",["T_WHITESPACE","\n      ",73],["T_CONSTANT_ENCAPSED_STRING","'field_name'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$field_name",74],",",["T_WHITESPACE","\n      ",74],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'node'",75],",",["T_WHITESPACE","\n      ",75],["T_CONSTANT_ENCAPSED_STRING","'type'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'text'",76],",",["T_WHITESPACE","\n      ",76],["T_CONSTANT_ENCAPSED_STRING","'cardinality'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_STRING","FieldStorageDefinitionInterface",77],["T_DOUBLE_COLON","::",77],["T_STRING","CARDINALITY_UNLIMITED",77],",",["T_WHITESPACE","\n    ",77],")",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","save",78],"(",")",";",["T_WHITESPACE","\n    ",78],["T_STRING","FieldConfig",79],["T_DOUBLE_COLON","::",79],["T_STRING","create",79],"(","[",["T_WHITESPACE","\n      ",79],["T_CONSTANT_ENCAPSED_STRING","'field_name'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$field_name",80],",",["T_WHITESPACE","\n      ",80],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'node'",81],",",["T_WHITESPACE","\n      ",81],["T_CONSTANT_ENCAPSED_STRING","'bundle'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'page'",82],",",["T_WHITESPACE","\n    ",82],"]",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","save",83],"(",")",";",["T_WHITESPACE","\n    ",83],["T_STRING","entity_get_form_display",84],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'page'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'default'",84],")",["T_WHITESPACE","\n      ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","setComponent",85],"(",["T_VARIABLE","$field_name",85],",",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'text_textfield'",85],")",")",["T_WHITESPACE","\n      ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","save",86],"(",")",";",["T_WHITESPACE","\n\n    ",86],["T_COMMENT","\/\/ Log in a user who can create 'page' nodes.\n",88],["T_WHITESPACE","    ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","webUser",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","drupalCreateUser",89],"(",["T_ARRAY","array",89],"(",["T_CONSTANT_ENCAPSED_STRING","'create page content'",89],")",")",";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","drupalLogin",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","webUser",90],")",";",["T_WHITESPACE","\n\n    ",90],["T_COMMENT","\/\/ Get the form for adding a 'page' node. Submit an \"add another item\" Ajax\n",92],["T_WHITESPACE","    ",93],["T_COMMENT","\/\/ submission and verify it worked by ensuring the updated page has two text\n",93],["T_WHITESPACE","    ",94],["T_COMMENT","\/\/ field items in the field for which we just added an item.\n",94],["T_WHITESPACE","    ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","drupalGet",95],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/page'",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","drupalPostAjaxForm",96],"(",["T_STRING","NULL",96],",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_CONSTANT_ENCAPSED_STRING","'field_ajax_test_add_more'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_STRING","t",96],"(",["T_CONSTANT_ENCAPSED_STRING","'Add another item'",96],")",")",",",["T_WHITESPACE"," ",96],["T_STRING","NULL",96],",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'node-page-form'",96],")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","assert",97],"(",["T_STRING","count",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","xpath",97],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/div[contains(@class, \"field--name-field-ajax-test\")]\/\/input[@type=\"text\"]'",97],")",")",["T_WHITESPACE"," ",97],["T_IS_EQUAL","==",97],["T_WHITESPACE"," ",97],["T_LNUMBER","2",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'AJAX submission succeeded.'",97],")",";",["T_WHITESPACE","\n\n    ",97],["T_COMMENT","\/\/ Submit the form with the non-Ajax \"Save\" button, leaving the title field\n",99],["T_WHITESPACE","    ",100],["T_COMMENT","\/\/ blank to trigger a validation error, and ensure that a validation error\n",100],["T_WHITESPACE","    ",101],["T_COMMENT","\/\/ occurred, because this test is for testing what happens when a form is\n",101],["T_WHITESPACE","    ",102],["T_COMMENT","\/\/ re-rendered without being re-built, which is what happens when there's\n",102],["T_WHITESPACE","    ",103],["T_COMMENT","\/\/ a validation error.\n",103],["T_WHITESPACE","    ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","drupalPostForm",104],"(",["T_STRING","NULL",104],",",["T_WHITESPACE"," ",104],["T_ARRAY","array",104],"(",")",",",["T_WHITESPACE"," ",104],["T_STRING","t",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",104],")",")",";",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","assertText",105],"(",["T_CONSTANT_ENCAPSED_STRING","'Title field is required.'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'Non-AJAX submission correctly triggered a validation error.'",105],")",";",["T_WHITESPACE","\n\n    ",105],["T_COMMENT","\/\/ Ensure that the form contains two items in the multi-valued field, so we\n",107],["T_WHITESPACE","    ",108],["T_COMMENT","\/\/ know we're testing a form that was correctly retrieved from cache.\n",108],["T_WHITESPACE","    ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assert",109],"(",["T_STRING","count",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","xpath",109],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/form[contains(@id, \"node-page-form\")]\/\/div[contains(@class, \"js-form-item-field-ajax-test\")]\/\/input[@type=\"text\"]'",109],")",")",["T_WHITESPACE"," ",109],["T_IS_EQUAL","==",109],["T_WHITESPACE"," ",109],["T_LNUMBER","2",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'Form retained its state from cache.'",109],")",";",["T_WHITESPACE","\n\n    ",109],["T_COMMENT","\/\/ Ensure that the form's action is correct.\n",111],["T_WHITESPACE","    ",112],["T_VARIABLE","$forms",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","xpath",112],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/form[contains(@class, \"node-page-form\")]'",112],")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertEqual",113],"(",["T_LNUMBER","1",113],",",["T_WHITESPACE"," ",113],["T_STRING","count",113],"(",["T_VARIABLE","$forms",113],")",")",";",["T_WHITESPACE","\n    ",113],["T_COMMENT","\/\/ Strip query params off the action before asserting.\n",114],["T_WHITESPACE","    ",115],["T_VARIABLE","$url",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","parse_url",115],"(",["T_VARIABLE","$forms",115],"[",["T_LNUMBER","0",115],"]","[",["T_CONSTANT_ENCAPSED_STRING","'action'",115],"]",")","[",["T_CONSTANT_ENCAPSED_STRING","'path'",115],"]",";",["T_WHITESPACE","\n    ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","assertEqual",116],"(",["T_STRING","Url",116],["T_DOUBLE_COLON","::",116],["T_STRING","fromRoute",116],"(",["T_CONSTANT_ENCAPSED_STRING","'node.add'",116],",",["T_WHITESPACE"," ",116],"[",["T_CONSTANT_ENCAPSED_STRING","'node_type'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'page'",116],"]",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","toString",116],"(",")",",",["T_WHITESPACE"," ",116],["T_VARIABLE","$url",116],")",";",["T_WHITESPACE","\n  ",116],"}",["T_WHITESPACE","\n\n",117],"}",["T_WHITESPACE","\n",119]]