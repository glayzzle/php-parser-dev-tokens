[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","System",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","simpletest",5],["T_NS_SEPARATOR","\\",5],["T_STRING","WebTestBase",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests .htaccess is working correctly.\n *\n * @group system\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","HtaccessTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","WebTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",14],["T_WHITESPACE","\n  ",18],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_STATIC","static",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$modules",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_ARRAY","array",19],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",19],",",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'path'",19],")",";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * Get an array of file paths for access testing.\n   *\n   * @return int[]\n   *   An array keyed by file paths. Each value is the expected response code,\n   *   for example, 200 or 403.\n   *\/",21],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","getProtectedFiles",28],"(",")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n    ",28],["T_VARIABLE","$path",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_STRING","drupal_get_path",29],"(",["T_CONSTANT_ENCAPSED_STRING","'module'",29],",",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'system'",29],")",["T_WHITESPACE"," ",29],".",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'\/tests\/fixtures\/HtaccessTest'",29],";",["T_WHITESPACE","\n\n    ",29],["T_COMMENT","\/\/ Tests the FilesMatch directive which denies access to certain file\n",31],["T_WHITESPACE","    ",32],["T_COMMENT","\/\/ extensions.\n",32],["T_WHITESPACE","    ",33],["T_VARIABLE","$file_exts_to_deny",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],"[",["T_WHITESPACE","\n      ",33],["T_CONSTANT_ENCAPSED_STRING","'engine'",34],",",["T_WHITESPACE","\n      ",34],["T_CONSTANT_ENCAPSED_STRING","'inc'",35],",",["T_WHITESPACE","\n      ",35],["T_CONSTANT_ENCAPSED_STRING","'install'",36],",",["T_WHITESPACE","\n      ",36],["T_CONSTANT_ENCAPSED_STRING","'make'",37],",",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'module'",38],",",["T_WHITESPACE","\n      ",38],["T_CONSTANT_ENCAPSED_STRING","'module~'",39],",",["T_WHITESPACE","\n      ",39],["T_CONSTANT_ENCAPSED_STRING","'module.bak'",40],",",["T_WHITESPACE","\n      ",40],["T_CONSTANT_ENCAPSED_STRING","'module.orig'",41],",",["T_WHITESPACE","\n      ",41],["T_CONSTANT_ENCAPSED_STRING","'module.save'",42],",",["T_WHITESPACE","\n      ",42],["T_CONSTANT_ENCAPSED_STRING","'module.swo'",43],",",["T_WHITESPACE","\n      ",43],["T_CONSTANT_ENCAPSED_STRING","'module.swp'",44],",",["T_WHITESPACE","\n      ",44],["T_CONSTANT_ENCAPSED_STRING","'php~'",45],",",["T_WHITESPACE","\n      ",45],["T_CONSTANT_ENCAPSED_STRING","'php.bak'",46],",",["T_WHITESPACE","\n      ",46],["T_CONSTANT_ENCAPSED_STRING","'php.orig'",47],",",["T_WHITESPACE","\n      ",47],["T_CONSTANT_ENCAPSED_STRING","'php.save'",48],",",["T_WHITESPACE","\n      ",48],["T_CONSTANT_ENCAPSED_STRING","'php.swo'",49],",",["T_WHITESPACE","\n      ",49],["T_CONSTANT_ENCAPSED_STRING","'php.swp'",50],",",["T_WHITESPACE","\n      ",50],["T_CONSTANT_ENCAPSED_STRING","'profile'",51],",",["T_WHITESPACE","\n      ",51],["T_CONSTANT_ENCAPSED_STRING","'po'",52],",",["T_WHITESPACE","\n      ",52],["T_CONSTANT_ENCAPSED_STRING","'sh'",53],",",["T_WHITESPACE","\n      ",53],["T_CONSTANT_ENCAPSED_STRING","'sql'",54],",",["T_WHITESPACE","\n      ",54],["T_CONSTANT_ENCAPSED_STRING","'theme'",55],",",["T_WHITESPACE","\n      ",55],["T_CONSTANT_ENCAPSED_STRING","'twig'",56],",",["T_WHITESPACE","\n      ",56],["T_CONSTANT_ENCAPSED_STRING","'tpl.php'",57],",",["T_WHITESPACE","\n      ",57],["T_CONSTANT_ENCAPSED_STRING","'xtmpl'",58],",",["T_WHITESPACE","\n      ",58],["T_CONSTANT_ENCAPSED_STRING","'yml'",59],",",["T_WHITESPACE","\n    ",59],"]",";",["T_WHITESPACE","\n\n    ",60],["T_FOREACH","foreach",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$file_exts_to_deny",62],["T_WHITESPACE"," ",62],["T_AS","as",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$file_ext",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n      ",62],["T_VARIABLE","$file_paths",63],"[","\"",["T_VARIABLE","$path",63],["T_ENCAPSED_AND_WHITESPACE","\/access_test.",63],["T_VARIABLE","$file_ext",63],"\"","]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_LNUMBER","403",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_COMMENT","\/\/ Tests the .htaccess file in vendor and created by a Composer script.\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ Try and access a non PHP file in the vendor directory.\n",67],["T_WHITESPACE","    ",68],["T_COMMENT","\/\/ @see Drupal\\\\Core\\\\Composer\\\\Composer::ensureHtaccess\n",68],["T_WHITESPACE","    ",69],["T_VARIABLE","$file_paths",69],"[",["T_CONSTANT_ENCAPSED_STRING","'vendor\/composer\/installed.json'",69],"]",["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_LNUMBER","403",69],";",["T_WHITESPACE","\n\n    ",69],["T_COMMENT","\/\/ Tests the rewrite conditions and rule that denies access to php files.\n",71],["T_WHITESPACE","    ",72],["T_VARIABLE","$file_paths",72],"[",["T_CONSTANT_ENCAPSED_STRING","'core\/lib\/Drupal.php'",72],"]",["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_LNUMBER","403",72],";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$file_paths",73],"[",["T_CONSTANT_ENCAPSED_STRING","'vendor\/autoload.php'",73],"]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_LNUMBER","403",73],";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$file_paths",74],"[",["T_CONSTANT_ENCAPSED_STRING","'autoload.php'",74],"]",["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_LNUMBER","403",74],";",["T_WHITESPACE","\n\n    ",74],["T_COMMENT","\/\/ Test extensions that should be permitted.\n",76],["T_WHITESPACE","    ",77],["T_VARIABLE","$file_exts_to_allow",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],"[",["T_WHITESPACE","\n      ",77],["T_CONSTANT_ENCAPSED_STRING","'php-info.txt'",78],["T_WHITESPACE","\n    ",78],"]",";",["T_WHITESPACE","\n\n    ",79],["T_FOREACH","foreach",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$file_exts_to_allow",81],["T_WHITESPACE"," ",81],["T_AS","as",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$file_ext",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n      ",81],["T_VARIABLE","$file_paths",82],"[","\"",["T_VARIABLE","$path",82],["T_ENCAPSED_AND_WHITESPACE","\/access_test.",82],["T_VARIABLE","$file_ext",82],"\"","]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_LNUMBER","200",82],";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_COMMENT","\/\/ Ensure composer.json and composer.lock cannot be accessed.\n",85],["T_WHITESPACE","    ",86],["T_VARIABLE","$file_paths",86],"[","\"",["T_VARIABLE","$path",86],["T_ENCAPSED_AND_WHITESPACE","\/composer.json",86],"\"","]",["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_LNUMBER","403",86],";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$file_paths",87],"[","\"",["T_VARIABLE","$path",87],["T_ENCAPSED_AND_WHITESPACE","\/composer.lock",87],"\"","]",["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_LNUMBER","403",87],";",["T_WHITESPACE","\n\n    ",87],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$file_paths",89],";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Iterates over protected files and calls assertNoFileAccess().\n   *\/",92],["T_WHITESPACE","\n  ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","testFileAccess",95],"(",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n    ",95],["T_FOREACH","foreach",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getProtectedFiles",96],"(",")",["T_WHITESPACE"," ",96],["T_AS","as",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$file",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$response_code",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","assertFileAccess",97],"(",["T_VARIABLE","$file",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$response_code",97],")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_COMMENT","\/\/ Test that adding \"\/1\" to a .php URL does not make it accessible.\n",100],["T_WHITESPACE","    ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","drupalGet",101],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/lib\/Drupal.php\/1'",101],")",";",["T_WHITESPACE","\n    ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertResponse",102],"(",["T_LNUMBER","403",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","\"Access to core\/lib\/Drupal.php\/1 is denied.\"",102],")",";",["T_WHITESPACE","\n\n    ",102],["T_COMMENT","\/\/ Test that it is possible to have path aliases containing .php.\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$type",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","drupalCreateContentType",105],"(",")",";",["T_WHITESPACE","\n\n    ",105],["T_COMMENT","\/\/ Create an node aliased to test.php.\n",107],["T_WHITESPACE","    ",108],["T_VARIABLE","$node",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","drupalCreateNode",108],"(","[",["T_WHITESPACE","\n      ",108],["T_CONSTANT_ENCAPSED_STRING","'title'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'This is a node'",109],",",["T_WHITESPACE","\n      ",109],["T_CONSTANT_ENCAPSED_STRING","'type'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$type",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","id",110],"(",")",",",["T_WHITESPACE","\n      ",110],["T_CONSTANT_ENCAPSED_STRING","'path'",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'\/test.php'",111],["T_WHITESPACE","\n    ",111],"]",")",";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$node",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","save",113],"(",")",";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","drupalGet",114],"(",["T_CONSTANT_ENCAPSED_STRING","'test.php'",114],")",";",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","assertResponse",115],"(",["T_LNUMBER","200",115],")",";",["T_WHITESPACE","\n    ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","assertText",116],"(",["T_CONSTANT_ENCAPSED_STRING","'This is a node'",116],")",";",["T_WHITESPACE","\n\n    ",116],["T_COMMENT","\/\/ Update node's alias to test.php\/test.\n",118],["T_WHITESPACE","    ",119],["T_VARIABLE","$node",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","path",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'\/test.php\/test'",119],";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$node",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","save",120],"(",")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","drupalGet",121],"(",["T_CONSTANT_ENCAPSED_STRING","'test.php\/test'",121],")",";",["T_WHITESPACE","\n    ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","assertResponse",122],"(",["T_LNUMBER","200",122],")",";",["T_WHITESPACE","\n    ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","assertText",123],"(",["T_CONSTANT_ENCAPSED_STRING","'This is a node'",123],")",";",["T_WHITESPACE","\n  ",123],"}",["T_WHITESPACE","\n\n  ",124],["T_DOC_COMMENT","\/**\n   * Asserts that a file exists and requesting it returns a specific response.\n   *\n   * @param string $path\n   *   Path to file. Without leading slash.\n   * @param int $response_code\n   *   The expected response code. For example: 200, 403 or 404.\n   *\n   * @return bool\n   *   TRUE if the assertion succeeded, FALSE otherwise.\n   *\/",126],["T_WHITESPACE","\n  ",136],["T_PROTECTED","protected",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","assertFileAccess",137],"(",["T_VARIABLE","$path",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$response_code",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$result",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertTrue",138],"(",["T_STRING","file_exists",138],"(",["T_NS_SEPARATOR","\\",138],["T_STRING","Drupal",138],["T_DOUBLE_COLON","::",138],["T_STRING","root",138],"(",")",["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'\/'",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_VARIABLE","$path",138],")",",",["T_WHITESPACE"," ",138],"\"",["T_ENCAPSED_AND_WHITESPACE","The file ",138],["T_VARIABLE","$path",138],["T_ENCAPSED_AND_WHITESPACE"," exists.",138],"\"",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","drupalGet",139],"(",["T_VARIABLE","$path",139],")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$result",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$result",140],["T_WHITESPACE"," ",140],["T_BOOLEAN_AND","&&",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","assertResponse",140],"(",["T_VARIABLE","$response_code",140],",",["T_WHITESPACE"," ",140],"\"",["T_ENCAPSED_AND_WHITESPACE","Response code to ",140],["T_VARIABLE","$path",140],["T_ENCAPSED_AND_WHITESPACE"," is ",140],["T_VARIABLE","$response_code",140],["T_ENCAPSED_AND_WHITESPACE",".",140],"\"",")",";",["T_WHITESPACE","\n    ",140],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$result",141],";",["T_WHITESPACE","\n  ",141],"}",["T_WHITESPACE","\n\n  ",142],["T_DOC_COMMENT","\/**\n   * Tests that SVGZ files are served with Content-Encoding: gzip.\n   *\/",144],["T_WHITESPACE","\n  ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","testSvgzContentEncoding",147],"(",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","drupalGet",148],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/modules\/system\/tests\/logo.svgz'",148],")",";",["T_WHITESPACE","\n    ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","assertResponse",149],"(",["T_LNUMBER","200",149],")",";",["T_WHITESPACE","\n    ",149],["T_VARIABLE","$header",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","drupalGetHeader",150],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Encoding'",150],")",";",["T_WHITESPACE","\n    ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","assertEqual",151],"(",["T_VARIABLE","$header",151],",",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'gzip'",151],")",";",["T_WHITESPACE","\n  ",151],"}",["T_WHITESPACE","\n\n",152],"}",["T_WHITESPACE","\n",154]]