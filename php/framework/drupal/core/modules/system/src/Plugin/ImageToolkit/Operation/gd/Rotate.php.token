[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","system",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","ImageToolkit",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Operation",3],["T_NS_SEPARATOR","\\",3],["T_STRING","gd",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Color",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Defines GD2 rotate operation.\n *\n * @ImageToolkitOperation(\n *   id = \"gd_rotate\",\n *   toolkit = \"gd\",\n *   operation = \"rotate\",\n *   label = @Translation(\"Rotate\"),\n *   description = @Translation(\"Rotates an image by the given number of degrees.\")\n * )\n *\/",7],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","Rotate",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_STRING","GDImageToolkitOperationBase",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",20],["T_WHITESPACE","\n  ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","arguments",23],"(",")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n    ",23],["T_RETURN","return",24],["T_WHITESPACE"," ",24],["T_ARRAY","array",24],"(",["T_WHITESPACE","\n      ",24],["T_CONSTANT_ENCAPSED_STRING","'degrees'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_ARRAY","array",25],"(",["T_WHITESPACE","\n        ",25],["T_CONSTANT_ENCAPSED_STRING","'description'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'The number of (clockwise) degrees to rotate the image'",26],",",["T_WHITESPACE","\n      ",26],")",",",["T_WHITESPACE","\n      ",27],["T_CONSTANT_ENCAPSED_STRING","'background'",28],["T_WHITESPACE"," ",28],["T_DOUBLE_ARROW","=>",28],["T_WHITESPACE"," ",28],["T_ARRAY","array",28],"(",["T_WHITESPACE","\n        ",28],["T_CONSTANT_ENCAPSED_STRING","'description'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","\"A string specifying the hexadecimal color code to use as background for the uncovered area of the image after the rotation. E.g. '#000000' for black, '#ff00ff' for magenta, and '#ffffff' for white. For images that support transparency, this will default to transparent white\"",29],",",["T_WHITESPACE","\n        ",29],["T_CONSTANT_ENCAPSED_STRING","'required'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_STRING","FALSE",30],",",["T_WHITESPACE","\n        ",30],["T_CONSTANT_ENCAPSED_STRING","'default'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],["T_STRING","NULL",31],",",["T_WHITESPACE","\n      ",31],")",",",["T_WHITESPACE","\n    ",32],")",";",["T_WHITESPACE","\n  ",33],"}",["T_WHITESPACE","\n\n  ",34],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",36],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","validateArguments",39],"(",["T_ARRAY","array",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$arguments",39],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n    ",39],["T_COMMENT","\/\/ PHP 5.5 GD bug: https:\/\/bugs.php.net\/bug.php?id=65148: To prevent buggy\n",40],["T_WHITESPACE","    ",41],["T_COMMENT","\/\/ behavior on negative multiples of 90 degrees we convert any negative\n",41],["T_WHITESPACE","    ",42],["T_COMMENT","\/\/ angle to a positive one between 0 and 360 degrees.\n",42],["T_WHITESPACE","    ",43],["T_VARIABLE","$arguments",43],"[",["T_CONSTANT_ENCAPSED_STRING","'degrees'",43],"]",["T_WHITESPACE"," ",43],["T_MINUS_EQUAL","-=",43],["T_WHITESPACE"," ",43],["T_STRING","floor",43],"(",["T_VARIABLE","$arguments",43],"[",["T_CONSTANT_ENCAPSED_STRING","'degrees'",43],"]",["T_WHITESPACE"," ",43],"\/",["T_WHITESPACE"," ",43],["T_LNUMBER","360",43],")",["T_WHITESPACE"," ",43],"*",["T_WHITESPACE"," ",43],["T_LNUMBER","360",43],";",["T_WHITESPACE","\n\n    ",43],["T_COMMENT","\/\/ Validate or set background color argument.\n",45],["T_WHITESPACE","    ",46],["T_IF","if",46],["T_WHITESPACE"," ",46],"(","!",["T_EMPTY","empty",46],"(",["T_VARIABLE","$arguments",46],"[",["T_CONSTANT_ENCAPSED_STRING","'background'",46],"]",")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n      ",46],["T_COMMENT","\/\/ Validate the background color: Color::hexToRgb does so for us.\n",47],["T_WHITESPACE","      ",48],["T_VARIABLE","$background",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","Color",48],["T_DOUBLE_COLON","::",48],["T_STRING","hexToRgb",48],"(",["T_VARIABLE","$arguments",48],"[",["T_CONSTANT_ENCAPSED_STRING","'background'",48],"]",")",["T_WHITESPACE"," ",48],"+",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'alpha'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_LNUMBER","0",48],["T_WHITESPACE"," ",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n    ",49],["T_ELSE","else",50],["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n      ",50],["T_COMMENT","\/\/ Background color is not specified: use transparent white as background.\n",51],["T_WHITESPACE","      ",52],["T_VARIABLE","$background",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_ARRAY","array",52],"(",["T_CONSTANT_ENCAPSED_STRING","'red'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_LNUMBER","255",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'green'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_LNUMBER","255",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'blue'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_LNUMBER","255",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'alpha'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_LNUMBER","127",52],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n    ",53],["T_COMMENT","\/\/ Store the color index for the background as that is what GD uses.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$arguments",55],"[",["T_CONSTANT_ENCAPSED_STRING","'background_idx'",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","imagecolorallocatealpha",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getToolkit",55],"(",")",["T_OBJECT_OPERATOR","->",55],["T_STRING","getResource",55],"(",")",",",["T_WHITESPACE"," ",55],["T_VARIABLE","$background",55],"[",["T_CONSTANT_ENCAPSED_STRING","'red'",55],"]",",",["T_WHITESPACE"," ",55],["T_VARIABLE","$background",55],"[",["T_CONSTANT_ENCAPSED_STRING","'green'",55],"]",",",["T_WHITESPACE"," ",55],["T_VARIABLE","$background",55],"[",["T_CONSTANT_ENCAPSED_STRING","'blue'",55],"]",",",["T_WHITESPACE"," ",55],["T_VARIABLE","$background",55],"[",["T_CONSTANT_ENCAPSED_STRING","'alpha'",55],"]",")",";",["T_WHITESPACE","\n\n    ",55],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getToolkit",57],"(",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","getType",57],"(",")",["T_WHITESPACE"," ",57],["T_IS_IDENTICAL","===",57],["T_WHITESPACE"," ",57],["T_STRING","IMAGETYPE_GIF",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n      ",57],["T_COMMENT","\/\/ GIF does not work with a transparency channel, but can define 1 color\n",58],["T_WHITESPACE","      ",59],["T_COMMENT","\/\/ in its palette to act as transparent.\n",59],["T_WHITESPACE","\n      ",60],["T_COMMENT","\/\/ Get the current transparent color, if any.\n",61],["T_WHITESPACE","      ",62],["T_VARIABLE","$gif_transparent_id",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","imagecolortransparent",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getToolkit",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getResource",62],"(",")",")",";",["T_WHITESPACE","\n      ",62],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_VARIABLE","$gif_transparent_id",63],["T_WHITESPACE"," ",63],["T_IS_NOT_IDENTICAL","!==",63],["T_WHITESPACE"," ",63],"-",["T_LNUMBER","1",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n        ",63],["T_COMMENT","\/\/ The gif already has a transparent color set: remember it to set it on\n",64],["T_WHITESPACE","        ",65],["T_COMMENT","\/\/ the rotated image as well.\n",65],["T_WHITESPACE","        ",66],["T_VARIABLE","$arguments",66],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",66],"]",["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","imagecolorsforindex",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getToolkit",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getResource",66],"(",")",",",["T_WHITESPACE"," ",66],["T_VARIABLE","$gif_transparent_id",66],")",";",["T_WHITESPACE","\n\n        ",66],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$background",68],"[",["T_CONSTANT_ENCAPSED_STRING","'alpha'",68],"]",["T_WHITESPACE"," ",68],["T_IS_GREATER_OR_EQUAL",">=",68],["T_WHITESPACE"," ",68],["T_LNUMBER","127",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n          ",68],["T_COMMENT","\/\/ We want a transparent background: use the color already set to act\n",69],["T_WHITESPACE","          ",70],["T_COMMENT","\/\/ as transparent, as background.\n",70],["T_WHITESPACE","          ",71],["T_VARIABLE","$arguments",71],"[",["T_CONSTANT_ENCAPSED_STRING","'background_idx'",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$gif_transparent_id",71],";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n      ",72],"}",["T_WHITESPACE","\n      ",73],["T_ELSE","else",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n        ",74],["T_COMMENT","\/\/ The gif does not currently have a transparent color set.\n",75],["T_WHITESPACE","        ",76],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$background",76],"[",["T_CONSTANT_ENCAPSED_STRING","'alpha'",76],"]",["T_WHITESPACE"," ",76],["T_IS_GREATER_OR_EQUAL",">=",76],["T_WHITESPACE"," ",76],["T_LNUMBER","127",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n          ",76],["T_COMMENT","\/\/ But as the background is transparent, it should get one.\n",77],["T_WHITESPACE","          ",78],["T_VARIABLE","$arguments",78],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",78],"]",["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$background",78],";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE","\n      ",79],"}",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$arguments",83],";",["T_WHITESPACE","\n  ",83],"}",["T_WHITESPACE","\n\n  ",84],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",86],["T_WHITESPACE","\n  ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","execute",89],"(",["T_ARRAY","array",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$arguments",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n    ",89],["T_COMMENT","\/\/ PHP installations using non-bundled GD do not have imagerotate.\n",90],["T_WHITESPACE","    ",91],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_STRING","function_exists",91],"(",["T_CONSTANT_ENCAPSED_STRING","'imagerotate'",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n      ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","logger",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","notice",92],"(",["T_CONSTANT_ENCAPSED_STRING","'The image %file could not be rotated because the imagerotate() function is not available in this PHP installation.'",92],",",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",["T_CONSTANT_ENCAPSED_STRING","'%file'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getToolkit",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","getSource",92],"(",")",")",")",";",["T_WHITESPACE","\n      ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_STRING","FALSE",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_COMMENT","\/\/ Stores the original GD resource.\n",96],["T_WHITESPACE","    ",97],["T_VARIABLE","$original_res",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getToolkit",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getResource",97],"(",")",";",["T_WHITESPACE","\n\n    ",97],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$new_res",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","imagerotate",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getToolkit",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","getResource",99],"(",")",",",["T_WHITESPACE"," ",99],["T_LNUMBER","360",99],["T_WHITESPACE"," ",99],"-",["T_WHITESPACE"," ",99],["T_VARIABLE","$arguments",99],"[",["T_CONSTANT_ENCAPSED_STRING","'degrees'",99],"]",",",["T_WHITESPACE"," ",99],["T_VARIABLE","$arguments",99],"[",["T_CONSTANT_ENCAPSED_STRING","'background_idx'",99],"]",")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getToolkit",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","setResource",100],"(",["T_VARIABLE","$new_res",100],")",";",["T_WHITESPACE","\n      ",100],["T_STRING","imagedestroy",101],"(",["T_VARIABLE","$original_res",101],")",";",["T_WHITESPACE","\n\n      ",101],["T_COMMENT","\/\/ GIFs need to reassign the transparent color after performing the\n",103],["T_WHITESPACE","      ",104],["T_COMMENT","\/\/ rotate, but only do so, if the image already had transparency of its\n",104],["T_WHITESPACE","      ",105],["T_COMMENT","\/\/ own, or the rotate added a transparent background.\n",105],["T_WHITESPACE","      ",106],["T_IF","if",106],["T_WHITESPACE"," ",106],"(","!",["T_EMPTY","empty",106],"(",["T_VARIABLE","$arguments",106],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",106],"]",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$transparent_idx",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","imagecolorexactalpha",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getToolkit",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","getResource",107],"(",")",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$arguments",107],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",107],"]","[",["T_CONSTANT_ENCAPSED_STRING","'red'",107],"]",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$arguments",107],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",107],"]","[",["T_CONSTANT_ENCAPSED_STRING","'green'",107],"]",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$arguments",107],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",107],"]","[",["T_CONSTANT_ENCAPSED_STRING","'blue'",107],"]",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$arguments",107],"[",["T_CONSTANT_ENCAPSED_STRING","'gif_transparent_color'",107],"]","[",["T_CONSTANT_ENCAPSED_STRING","'alpha'",107],"]",")",";",["T_WHITESPACE","\n        ",107],["T_STRING","imagecolortransparent",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getToolkit",108],"(",")",["T_OBJECT_OPERATOR","->",108],["T_STRING","getResource",108],"(",")",",",["T_WHITESPACE"," ",108],["T_VARIABLE","$transparent_idx",108],")",";",["T_WHITESPACE","\n      ",108],"}",["T_WHITESPACE","\n\n      ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_STRING","TRUE",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","FALSE",114],";",["T_WHITESPACE","\n  ",114],"}",["T_WHITESPACE","\n\n",115],"}",["T_WHITESPACE","\n",117]]