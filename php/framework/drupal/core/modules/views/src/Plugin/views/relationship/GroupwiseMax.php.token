[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","views",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","views",3],["T_NS_SEPARATOR","\\",3],["T_STRING","relationship",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Query",5],["T_NS_SEPARATOR","\\",5],["T_STRING","AlterableInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Form",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FormStateInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","views",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Views",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","views",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","View",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Relationship handler that allows a groupwise maximum of the linked in table.\n * For a definition, see:\n * http:\/\/dev.mysql.com\/doc\/refman\/5.0\/en\/example-maximum-column-group-row.html\n * In lay terms, instead of joining to get all matching records in the linked\n * table, we get only one record, a 'representative record' picked according\n * to a given criteria.\n *\n * Example:\n * Suppose we have a term view that gives us the terms: Horse, Cat, Aardvark.\n * We wish to show for each term the most recent node of that term.\n * What we want is some kind of relationship from term to node.\n * But a regular relationship will give us all the nodes for each term,\n * giving the view multiple rows per term. What we want is just one\n * representative node per term, the node that is the 'best' in some way:\n * eg, the most recent, the most commented on, the first in alphabetical order.\n *\n * This handler gives us that kind of relationship from term to node.\n * The method of choosing the 'best' implemented with a sort\n * that the user selects in the relationship settings.\n *\n * So if we want our term view to show the most commented node for each term,\n * add the relationship and in its options, pick the 'Comment count' sort.\n *\n * Relationship definition\n *  - 'outer field': The outer field to substitute into the correlated subquery.\n *       This must be the full field name, not the alias.\n *       Eg: 'term_data.tid'.\n *  - 'argument table',\n *    'argument field': These options define a views argument that the subquery\n *     must add to itself to filter by the main view.\n *     Example: the main view shows terms, this handler is being used to get to\n *     the nodes base table. Your argument must be 'term_node', 'tid', as this\n *     is the argument that should be added to a node view to filter on terms.\n *\n * A note on performance:\n * This relationship uses a correlated subquery, which is expensive.\n * Subsequent versions of this handler could also implement the alternative way\n * of doing this, with a join -- though this looks like it could be pretty messy\n * to implement. This is also an expensive method, so providing both methods and\n * allowing the user to choose which one works fastest for their data might be\n * the best way.\n * If your use of this relationship handler is likely to result in large\n * data sets, you might want to consider storing statistics in a separate table,\n * in the same way as node_comment_statistics.\n *\n * @ingroup views_relationship_handlers\n *\n * @ViewsRelationship(\"groupwise_max\")\n *\/",10],["T_WHITESPACE","\n",59],["T_CLASS","class",60],["T_WHITESPACE"," ",60],["T_STRING","GroupwiseMax",60],["T_WHITESPACE"," ",60],["T_EXTENDS","extends",60],["T_WHITESPACE"," ",60],["T_STRING","RelationshipPluginBase",60],["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n\n  ",60],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",62],["T_WHITESPACE","\n  ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","defineOptions",65],"(",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$options",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","parent",66],["T_DOUBLE_COLON","::",66],["T_STRING","defineOptions",66],"(",")",";",["T_WHITESPACE","\n\n    ",66],["T_VARIABLE","$options",68],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_sort'",68],"]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_STRING","NULL",68],")",";",["T_WHITESPACE","\n    ",68],["T_COMMENT","\/\/ Descending more useful.\n",69],["T_WHITESPACE","    ",70],["T_VARIABLE","$options",70],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_order'",70],"]",["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_ARRAY","array",70],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'DESC'",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$options",71],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_regenerate'",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_ARRAY","array",71],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_STRING","FALSE",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$options",72],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_view'",72],"]",["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_STRING","FALSE",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$options",73],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",73],"]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_STRING","FALSE",73],")",";",["T_WHITESPACE","\n\n    ",73],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$options",75],";",["T_WHITESPACE","\n  ",75],"}",["T_WHITESPACE","\n\n  ",76],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",78],["T_WHITESPACE","\n  ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","buildOptionsForm",81],"(","&",["T_VARIABLE","$form",81],",",["T_WHITESPACE"," ",81],["T_STRING","FormStateInterface",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$form_state",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n    ",81],["T_STRING","parent",82],["T_DOUBLE_COLON","::",82],["T_STRING","buildOptionsForm",82],"(",["T_VARIABLE","$form",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$form_state",82],")",";",["T_WHITESPACE","\n\n    ",82],["T_COMMENT","\/\/ Get the sorts that apply to our base.\n",84],["T_WHITESPACE","    ",85],["T_VARIABLE","$sorts",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","Views",85],["T_DOUBLE_COLON","::",85],["T_STRING","viewsDataHelper",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","fetchFields",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","definition",85],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",85],"]",",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'sort'",85],")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$sort_options",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",")",";",["T_WHITESPACE","\n    ",86],["T_FOREACH","foreach",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$sorts",87],["T_WHITESPACE"," ",87],["T_AS","as",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$sort_id",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$sort",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_VARIABLE","$sort_options",88],"[",["T_VARIABLE","$sort_id",88],"]",["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],"\"",["T_VARIABLE","$sort",88],"[",["T_STRING","group",88],"]",["T_ENCAPSED_AND_WHITESPACE",": ",88],["T_VARIABLE","$sort",88],"[",["T_STRING","title",88],"]","\"",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$base_table_data",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","Views",90],["T_DOUBLE_COLON","::",90],["T_STRING","viewsData",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","get",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","definition",90],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",90],"]",")",";",["T_WHITESPACE","\n\n    ",90],["T_COMMENT","\/\/ Extends the relationship's basic options, allowing the user to pick a\n",92],["T_WHITESPACE","    ",93],["T_COMMENT","\/\/ sort and an order for it.\n",93],["T_WHITESPACE","    ",94],["T_VARIABLE","$form",94],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_sort'",94],"]",["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_WHITESPACE","\n      ",94],["T_CONSTANT_ENCAPSED_STRING","'#type'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'select'",95],",",["T_WHITESPACE","\n      ",95],["T_CONSTANT_ENCAPSED_STRING","'#title'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","t",96],"(",["T_CONSTANT_ENCAPSED_STRING","'Representative sort criteria'",96],")",",",["T_WHITESPACE","\n      ",96],["T_COMMENT","\/\/ Provide the base field as sane default sort option.\n",97],["T_WHITESPACE","      ",98],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],"!",["T_EMPTY","empty",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","options",98],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_sort'",98],"]",")",["T_WHITESPACE"," ",98],"?",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","options",98],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_sort'",98],"]",["T_WHITESPACE"," ",98],":",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","definition",98],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",98],"]",["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'.'",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_VARIABLE","$base_table_data",98],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",98],"]","[",["T_CONSTANT_ENCAPSED_STRING","'base'",98],"]","[",["T_CONSTANT_ENCAPSED_STRING","'field'",98],"]",",",["T_WHITESPACE","\n      ",98],["T_CONSTANT_ENCAPSED_STRING","'#options'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$sort_options",99],",",["T_WHITESPACE","\n      ",99],["T_CONSTANT_ENCAPSED_STRING","'#description'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","t",100],"(",["T_CONSTANT_ENCAPSED_STRING","\"The sort criteria is applied to the data brought in by the relationship to determine how a representative item is obtained for each row. For example, to show the most recent node for each user, pick 'Content: Updated date'.\"",100],")",",",["T_WHITESPACE","\n    ",100],")",";",["T_WHITESPACE","\n\n    ",101],["T_VARIABLE","$form",103],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_order'",103],"]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_ARRAY","array",103],"(",["T_WHITESPACE","\n      ",103],["T_CONSTANT_ENCAPSED_STRING","'#type'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'radios'",104],",",["T_WHITESPACE","\n      ",104],["T_CONSTANT_ENCAPSED_STRING","'#title'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","t",105],"(",["T_CONSTANT_ENCAPSED_STRING","'Representative sort order'",105],")",",",["T_WHITESPACE","\n      ",105],["T_CONSTANT_ENCAPSED_STRING","'#description'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","t",106],"(",["T_CONSTANT_ENCAPSED_STRING","\"The ordering to use for the sort criteria selected above.\"",106],")",",",["T_WHITESPACE","\n      ",106],["T_CONSTANT_ENCAPSED_STRING","'#options'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_ARRAY","array",107],"(",["T_CONSTANT_ENCAPSED_STRING","'ASC'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","t",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Ascending'",107],")",",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'DESC'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","t",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Descending'",107],")",")",",",["T_WHITESPACE","\n      ",107],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","options",108],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_order'",108],"]",",",["T_WHITESPACE","\n    ",108],")",";",["T_WHITESPACE","\n\n    ",109],["T_VARIABLE","$form",111],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",111],"]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",["T_WHITESPACE","\n      ",111],["T_CONSTANT_ENCAPSED_STRING","'#type'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'textfield'",112],",",["T_WHITESPACE","\n      ",112],["T_CONSTANT_ENCAPSED_STRING","'#title'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","t",113],"(",["T_CONSTANT_ENCAPSED_STRING","'Subquery namespace'",113],")",",",["T_WHITESPACE","\n      ",113],["T_CONSTANT_ENCAPSED_STRING","'#description'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","t",114],"(",["T_CONSTANT_ENCAPSED_STRING","'Advanced. Enter a namespace for the subquery used by this relationship.'",114],")",",",["T_WHITESPACE","\n      ",114],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","options",115],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",115],"]",",",["T_WHITESPACE","\n    ",115],")",";",["T_WHITESPACE","\n\n\n    ",116],["T_COMMENT","\/\/ WIP: This stuff doesn't work yet: namespacing issues.\n",119],["T_WHITESPACE","    ",120],["T_COMMENT","\/\/ A list of suitable views to pick one as the subview.\n",120],["T_WHITESPACE","    ",121],["T_VARIABLE","$views",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","''",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'- None -'",121],")",";",["T_WHITESPACE","\n    ",121],["T_FOREACH","foreach",122],["T_WHITESPACE"," ",122],"(",["T_STRING","Views",122],["T_DOUBLE_COLON","::",122],["T_STRING","getAllViews",122],"(",")",["T_WHITESPACE"," ",122],["T_AS","as",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$view",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n      ",122],["T_COMMENT","\/\/ Only get views that are suitable:\n",123],["T_WHITESPACE","      ",124],["T_COMMENT","\/\/ - base must the base that our relationship joins towards\n",124],["T_WHITESPACE","      ",125],["T_COMMENT","\/\/ - must have fields.\n",125],["T_WHITESPACE","      ",126],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$view",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","get",126],"(",["T_CONSTANT_ENCAPSED_STRING","'base_table'",126],")",["T_WHITESPACE"," ",126],["T_IS_EQUAL","==",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","definition",126],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",126],"]",["T_WHITESPACE"," ",126],["T_BOOLEAN_AND","&&",126],["T_WHITESPACE"," ",126],"!",["T_EMPTY","empty",126],"(",["T_VARIABLE","$view",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getDisplay",126],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",126],")","[",["T_CONSTANT_ENCAPSED_STRING","'display_options'",126],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fields'",126],"]",")",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n        ",126],["T_COMMENT","\/\/ TODO: check the field is the correct sort?\n",127],["T_WHITESPACE","        ",128],["T_COMMENT","\/\/ or let users hang themselves at this stage and check later?\n",128],["T_WHITESPACE","        ",129],["T_VARIABLE","$views",129],"[",["T_VARIABLE","$view",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","id",129],"(",")","]",["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$view",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","id",129],"(",")",";",["T_WHITESPACE","\n      ",129],"}",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_VARIABLE","$form",133],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_view'",133],"]",["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",["T_WHITESPACE","\n      ",133],["T_CONSTANT_ENCAPSED_STRING","'#type'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'select'",134],",",["T_WHITESPACE","\n      ",134],["T_CONSTANT_ENCAPSED_STRING","'#title'",135],["T_WHITESPACE"," ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","t",135],"(",["T_CONSTANT_ENCAPSED_STRING","'Representative view'",135],")",",",["T_WHITESPACE","\n      ",135],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","options",136],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_view'",136],"]",",",["T_WHITESPACE","\n      ",136],["T_CONSTANT_ENCAPSED_STRING","'#options'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$views",137],",",["T_WHITESPACE","\n      ",137],["T_CONSTANT_ENCAPSED_STRING","'#description'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","t",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Advanced. Use another view to generate the relationship subquery. This allows you to use filtering and more than one sort. If you pick a view here, the sort options above are ignored. Your view must have the ID of its base as its only field, and should have some kind of sorting.'",138],")",",",["T_WHITESPACE","\n    ",138],")",";",["T_WHITESPACE","\n\n    ",139],["T_VARIABLE","$form",141],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_regenerate'",141],"]",["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_ARRAY","array",141],"(",["T_WHITESPACE","\n      ",141],["T_CONSTANT_ENCAPSED_STRING","'#type'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'checkbox'",142],",",["T_WHITESPACE","\n      ",142],["T_CONSTANT_ENCAPSED_STRING","'#title'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","t",143],"(",["T_CONSTANT_ENCAPSED_STRING","'Generate subquery each time view is run'",143],")",",",["T_WHITESPACE","\n      ",143],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","options",144],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_regenerate'",144],"]",",",["T_WHITESPACE","\n      ",144],["T_CONSTANT_ENCAPSED_STRING","'#description'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","t",145],"(",["T_CONSTANT_ENCAPSED_STRING","'Will re-generate the subquery for this relationship every time the view is run, instead of only when these options are saved. Use for testing if you are making changes elsewhere. WARNING: seriously impairs performance.'",145],")",",",["T_WHITESPACE","\n    ",145],")",";",["T_WHITESPACE","\n  ",146],"}",["T_WHITESPACE","\n\n  ",147],["T_DOC_COMMENT","\/**\n   * Helper function to create a pseudo view.\n   *\n   * We use this to obtain our subquery SQL.\n   *\/",149],["T_WHITESPACE","\n  ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","getTemporaryView",154],"(",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n    ",154],["T_VARIABLE","$view",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","View",155],["T_DOUBLE_COLON","::",155],["T_STRING","create",155],"(",["T_ARRAY","array",155],"(",["T_CONSTANT_ENCAPSED_STRING","'base_table'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","definition",155],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",155],"]",")",")",";",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$view",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","addDisplay",156],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",156],")",";",["T_WHITESPACE","\n    ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$view",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getExecutable",157],"(",")",";",["T_WHITESPACE","\n  ",157],"}",["T_WHITESPACE","\n\n  ",158],["T_DOC_COMMENT","\/**\n   * When the form is submitted, make sure to clear the subquery string cache.\n   *\/",160],["T_WHITESPACE","\n  ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","submitOptionsForm",163],"(","&",["T_VARIABLE","$form",163],",",["T_WHITESPACE"," ",163],["T_STRING","FormStateInterface",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$form_state",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$cid",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'views_relationship_groupwise_max:'",164],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","view",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","storage",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","id",164],"(",")",["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","':'",164],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","view",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","current_display",164],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","':'",164],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","options",164],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",164],"]",";",["T_WHITESPACE","\n    ",164],["T_NS_SEPARATOR","\\",165],["T_STRING","Drupal",165],["T_DOUBLE_COLON","::",165],["T_STRING","cache",165],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",165],")",["T_OBJECT_OPERATOR","->",165],["T_STRING","delete",165],"(",["T_VARIABLE","$cid",165],")",";",["T_WHITESPACE","\n  ",165],"}",["T_WHITESPACE","\n\n  ",166],["T_DOC_COMMENT","\/**\n   * Generate a subquery given the user options, as set in the options.\n   *\n   * These are passed in rather than picked up from the object because we\n   * generate the subquery when the options are saved, rather than when the view\n   * is run. This saves considerable time.\n   *\n   * @param $options\n   *   An array of options:\n   *    - subquery_sort: the id of a views sort.\n   *    - subquery_order: either ASC or DESC.\n   *\n   * @return string\n   *    The subquery SQL string, ready for use in the main query.\n   *\/",168],["T_WHITESPACE","\n  ",182],["T_PROTECTED","protected",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","leftQuery",183],"(",["T_VARIABLE","$options",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n    ",183],["T_COMMENT","\/\/ Either load another view, or create one on the fly.\n",184],["T_WHITESPACE","    ",185],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_VARIABLE","$options",185],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_view'",185],"]",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n      ",185],["T_VARIABLE","$temp_view",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","Views",186],["T_DOUBLE_COLON","::",186],["T_STRING","getView",186],"(",["T_VARIABLE","$options",186],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_view'",186],"]",")",";",["T_WHITESPACE","\n      ",186],["T_COMMENT","\/\/ Remove all fields from default display\n",187],["T_WHITESPACE","      ",188],["T_UNSET","unset",188],"(",["T_VARIABLE","$temp_view",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","display",188],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",188],"]","[",["T_CONSTANT_ENCAPSED_STRING","'display_options'",188],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fields'",188],"]",")",";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n    ",189],["T_ELSE","else",190],["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n      ",190],["T_COMMENT","\/\/ Create a new view object on the fly, which we use to generate a query\n",191],["T_WHITESPACE","      ",192],["T_COMMENT","\/\/ object and then get the SQL we need for the subquery.\n",192],["T_WHITESPACE","      ",193],["T_VARIABLE","$temp_view",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getTemporaryView",193],"(",")",";",["T_WHITESPACE","\n\n      ",193],["T_COMMENT","\/\/ Add the sort from the options to the default display.\n",195],["T_WHITESPACE","      ",196],["T_COMMENT","\/\/ This is broken, in that the sort order field also gets added as a\n",196],["T_WHITESPACE","      ",197],["T_COMMENT","\/\/ select field. See https:\/\/www.drupal.org\/node\/844910.\n",197],["T_WHITESPACE","      ",198],["T_COMMENT","\/\/ We work around this further down.\n",198],["T_WHITESPACE","      ",199],["T_VARIABLE","$sort",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$options",199],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_sort'",199],"]",";",["T_WHITESPACE","\n      ",199],["T_LIST","list",200],"(",["T_VARIABLE","$sort_table",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$sort_field",200],")",["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","explode",200],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$sort",200],")",";",["T_WHITESPACE","\n      ",200],["T_VARIABLE","$sort_options",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_ARRAY","array",201],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$options",201],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_order'",201],"]",")",";",["T_WHITESPACE","\n      ",201],["T_VARIABLE","$temp_view",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","addHandler",202],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",202],",",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'sort'",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$sort_table",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$sort_field",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$sort_options",202],")",";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_COMMENT","\/\/ Get the namespace string.\n",205],["T_WHITESPACE","    ",206],["T_VARIABLE","$temp_view",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","namespace",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],"(","!",["T_EMPTY","empty",206],"(",["T_VARIABLE","$options",206],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",206],"]",")",")",["T_WHITESPACE"," ",206],"?",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'_'",206],["T_WHITESPACE"," ",206],".",["T_WHITESPACE"," ",206],["T_VARIABLE","$options",206],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",206],"]",["T_WHITESPACE"," ",206],":",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'_INNER'",206],";",["T_WHITESPACE","\n    ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","subquery_namespace",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],"(","!",["T_EMPTY","empty",207],"(",["T_VARIABLE","$options",207],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",207],"]",")",")",["T_WHITESPACE"," ",207],"?",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'_'",207],["T_WHITESPACE"," ",207],".",["T_WHITESPACE"," ",207],["T_VARIABLE","$options",207],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_namespace'",207],"]",["T_WHITESPACE"," ",207],":",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'INNER'",207],";",["T_WHITESPACE","\n\n    ",207],["T_COMMENT","\/\/ The value we add here does nothing, but doing this adds the right tables\n",209],["T_WHITESPACE","    ",210],["T_COMMENT","\/\/ and puts in a WHERE clause with a placeholder we can grab later.\n",210],["T_WHITESPACE","    ",211],["T_VARIABLE","$temp_view",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","args",211],"[","]",["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'**CORRELATED**'",211],";",["T_WHITESPACE","\n\n    ",211],["T_COMMENT","\/\/ Add the base table ID field.\n",213],["T_WHITESPACE","    ",214],["T_VARIABLE","$temp_view",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","addHandler",214],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",214],",",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'field'",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","definition",214],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",214],"]",",",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","definition",214],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",214],"]",")",";",["T_WHITESPACE","\n\n    ",214],["T_VARIABLE","$relationship_id",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_STRING","NULL",216],";",["T_WHITESPACE","\n    ",216],["T_COMMENT","\/\/ Add the used relationship for the subjoin, if defined.\n",217],["T_WHITESPACE","    ",218],["T_IF","if",218],["T_WHITESPACE"," ",218],"(",["T_ISSET","isset",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","definition",218],"[",["T_CONSTANT_ENCAPSED_STRING","'relationship'",218],"]",")",")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n      ",218],["T_LIST","list",219],"(",["T_VARIABLE","$relationship_table",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$relationship_field",219],")",["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","explode",219],"(",["T_CONSTANT_ENCAPSED_STRING","':'",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","definition",219],"[",["T_CONSTANT_ENCAPSED_STRING","'relationship'",219],"]",")",";",["T_WHITESPACE","\n      ",219],["T_VARIABLE","$relationship_id",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$temp_view",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","addHandler",220],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",220],",",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'relationship'",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$relationship_table",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$relationship_field",220],")",";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n    ",221],["T_VARIABLE","$temp_item_options",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",["T_CONSTANT_ENCAPSED_STRING","'relationship'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$relationship_id",222],")",";",["T_WHITESPACE","\n\n    ",222],["T_COMMENT","\/\/ Add the correct argument for our relationship's base\n",224],["T_WHITESPACE","    ",225],["T_COMMENT","\/\/ ie the 'how to get back to base' argument.\n",225],["T_WHITESPACE","    ",226],["T_COMMENT","\/\/ The relationship definition tells us which one to use.\n",226],["T_WHITESPACE","    ",227],["T_VARIABLE","$temp_view",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","addHandler",227],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",227],",",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'argument'",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","definition",227],"[",["T_CONSTANT_ENCAPSED_STRING","'argument table'",227],"]",",",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","definition",227],"[",["T_CONSTANT_ENCAPSED_STRING","'argument field'",227],"]",",",["T_WHITESPACE"," ",227],["T_VARIABLE","$temp_item_options",227],")",";",["T_WHITESPACE","\n\n    ",227],["T_COMMENT","\/\/ Build the view. The creates the query object and produces the query\n",229],["T_WHITESPACE","    ",230],["T_COMMENT","\/\/ string but does not run any queries.\n",230],["T_WHITESPACE","    ",231],["T_VARIABLE","$temp_view",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","build",231],"(",")",";",["T_WHITESPACE","\n\n    ",231],["T_COMMENT","\/\/ Now take the SelectQuery object the View has built and massage it\n",233],["T_WHITESPACE","    ",234],["T_COMMENT","\/\/ somewhat so we can get the SQL query from it.\n",234],["T_WHITESPACE","    ",235],["T_VARIABLE","$subquery",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$temp_view",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","build_info",235],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",235],"]",";",["T_WHITESPACE","\n\n    ",235],["T_COMMENT","\/\/ Workaround until https:\/\/www.drupal.org\/node\/844910 is fixed:\n",237],["T_WHITESPACE","    ",238],["T_COMMENT","\/\/ Remove all fields from the SELECT except the base id.\n",238],["T_WHITESPACE","    ",239],["T_VARIABLE","$fields",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],"&",["T_VARIABLE","$subquery",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getFields",239],"(",")",";",["T_WHITESPACE","\n    ",239],["T_FOREACH","foreach",240],["T_WHITESPACE"," ",240],"(",["T_STRING","array_keys",240],"(",["T_VARIABLE","$fields",240],")",["T_WHITESPACE"," ",240],["T_AS","as",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$field_name",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n      ",240],["T_COMMENT","\/\/ The base id for this subquery is stored in our definition.\n",241],["T_WHITESPACE","      ",242],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$field_name",242],["T_WHITESPACE"," ",242],["T_IS_NOT_EQUAL","!=",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","definition",242],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",242],"]",")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n        ",242],["T_UNSET","unset",243],"(",["T_VARIABLE","$fields",243],"[",["T_VARIABLE","$field_name",243],"]",")",";",["T_WHITESPACE","\n      ",243],"}",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_COMMENT","\/\/ Make every alias in the subquery safe within the outer query by\n",247],["T_WHITESPACE","    ",248],["T_COMMENT","\/\/ appending a namespace to it, '_inner' by default.\n",248],["T_WHITESPACE","    ",249],["T_VARIABLE","$tables",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],"&",["T_VARIABLE","$subquery",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getTables",249],"(",")",";",["T_WHITESPACE","\n    ",249],["T_FOREACH","foreach",250],["T_WHITESPACE"," ",250],"(",["T_STRING","array_keys",250],"(",["T_VARIABLE","$tables",250],")",["T_WHITESPACE"," ",250],["T_AS","as",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$table_name",250],")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n      ",250],["T_VARIABLE","$tables",251],"[",["T_VARIABLE","$table_name",251],"]","[",["T_CONSTANT_ENCAPSED_STRING","'alias'",251],"]",["T_WHITESPACE"," ",251],["T_CONCAT_EQUAL",".=",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","subquery_namespace",251],";",["T_WHITESPACE","\n      ",251],["T_COMMENT","\/\/ Namespace the join on every table.\n",252],["T_WHITESPACE","      ",253],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_ISSET","isset",253],"(",["T_VARIABLE","$tables",253],"[",["T_VARIABLE","$table_name",253],"]","[",["T_CONSTANT_ENCAPSED_STRING","'condition'",253],"]",")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$tables",254],"[",["T_VARIABLE","$table_name",254],"]","[",["T_CONSTANT_ENCAPSED_STRING","'condition'",254],"]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","conditionNamespace",254],"(",["T_VARIABLE","$tables",254],"[",["T_VARIABLE","$table_name",254],"]","[",["T_CONSTANT_ENCAPSED_STRING","'condition'",254],"]",")",";",["T_WHITESPACE","\n      ",254],"}",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n    ",256],["T_COMMENT","\/\/ Namespace fields.\n",257],["T_WHITESPACE","    ",258],["T_FOREACH","foreach",258],["T_WHITESPACE"," ",258],"(",["T_STRING","array_keys",258],"(",["T_VARIABLE","$fields",258],")",["T_WHITESPACE"," ",258],["T_AS","as",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$field_name",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n      ",258],["T_VARIABLE","$fields",259],"[",["T_VARIABLE","$field_name",259],"]","[",["T_CONSTANT_ENCAPSED_STRING","'table'",259],"]",["T_WHITESPACE"," ",259],["T_CONCAT_EQUAL",".=",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","subquery_namespace",259],";",["T_WHITESPACE","\n      ",259],["T_VARIABLE","$fields",260],"[",["T_VARIABLE","$field_name",260],"]","[",["T_CONSTANT_ENCAPSED_STRING","'alias'",260],"]",["T_WHITESPACE"," ",260],["T_CONCAT_EQUAL",".=",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","subquery_namespace",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n    ",261],["T_COMMENT","\/\/ Namespace conditions.\n",262],["T_WHITESPACE","    ",263],["T_VARIABLE","$where",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],"&",["T_VARIABLE","$subquery",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","conditions",263],"(",")",";",["T_WHITESPACE","\n    ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","alterSubqueryCondition",264],"(",["T_VARIABLE","$subquery",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$where",264],")",";",["T_WHITESPACE","\n    ",264],["T_COMMENT","\/\/ Not sure why, but our sort order clause doesn't have a table.\n",265],["T_WHITESPACE","    ",266],["T_COMMENT","\/\/ TODO: the call to addHandler() above to add the sort handler is probably\n",266],["T_WHITESPACE","    ",267],["T_COMMENT","\/\/ wrong -- needs attention from someone who understands it.\n",267],["T_WHITESPACE","    ",268],["T_COMMENT","\/\/ In the meantime, this works, but with a leap of faith.\n",268],["T_WHITESPACE","    ",269],["T_VARIABLE","$orders",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],"&",["T_VARIABLE","$subquery",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getOrderBy",269],"(",")",";",["T_WHITESPACE","\n    ",269],["T_FOREACH","foreach",270],["T_WHITESPACE"," ",270],"(",["T_VARIABLE","$orders",270],["T_WHITESPACE"," ",270],["T_AS","as",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$order_key",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$order",270],")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n      ",270],["T_COMMENT","\/\/ But if we're using a whole view, we don't know what we have!\n",271],["T_WHITESPACE","      ",272],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$options",272],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_view'",272],"]",")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n        ",272],["T_LIST","list",273],"(",["T_VARIABLE","$sort_table",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$sort_field",273],")",["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","explode",273],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$order_key",273],")",";",["T_WHITESPACE","\n      ",273],"}",["T_WHITESPACE","\n      ",274],["T_VARIABLE","$orders",275],"[",["T_VARIABLE","$sort_table",275],["T_WHITESPACE"," ",275],".",["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","subquery_namespace",275],["T_WHITESPACE"," ",275],".",["T_WHITESPACE"," ",275],["T_CONSTANT_ENCAPSED_STRING","'.'",275],["T_WHITESPACE"," ",275],".",["T_WHITESPACE"," ",275],["T_VARIABLE","$sort_field",275],"]",["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$order",275],";",["T_WHITESPACE","\n      ",275],["T_UNSET","unset",276],"(",["T_VARIABLE","$orders",276],"[",["T_VARIABLE","$order_key",276],"]",")",";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n\n    ",277],["T_COMMENT","\/\/ The query we get doesn't include the LIMIT, so add it here.\n",279],["T_WHITESPACE","    ",280],["T_VARIABLE","$subquery",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","range",280],"(",["T_LNUMBER","0",280],",",["T_WHITESPACE"," ",280],["T_LNUMBER","1",280],")",";",["T_WHITESPACE","\n\n    ",280],["T_COMMENT","\/\/ Extract the SQL the temporary view built.\n",282],["T_WHITESPACE","    ",283],["T_VARIABLE","$subquery_sql",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$subquery",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","__toString",283],"(",")",";",["T_WHITESPACE","\n\n    ",283],["T_COMMENT","\/\/ Replace the placeholder with the outer, correlated field.\n",285],["T_WHITESPACE","    ",286],["T_COMMENT","\/\/ Eg, change the placeholder ':users_uid' into the outer field 'users.uid'.\n",286],["T_WHITESPACE","    ",287],["T_COMMENT","\/\/ We have to work directly with the SQL, because putting a name of a field\n",287],["T_WHITESPACE","    ",288],["T_COMMENT","\/\/ into a SelectQuery that it does not recognize (because it's outer) just\n",288],["T_WHITESPACE","    ",289],["T_COMMENT","\/\/ makes it treat it as a string.\n",289],["T_WHITESPACE","    ",290],["T_VARIABLE","$outer_placeholder",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_CONSTANT_ENCAPSED_STRING","':'",290],["T_WHITESPACE"," ",290],".",["T_WHITESPACE"," ",290],["T_STRING","str_replace",290],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",290],",",["T_WHITESPACE"," ",290],["T_CONSTANT_ENCAPSED_STRING","'_'",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","definition",290],"[",["T_CONSTANT_ENCAPSED_STRING","'outer field'",290],"]",")",";",["T_WHITESPACE","\n    ",290],["T_VARIABLE","$subquery_sql",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","str_replace",291],"(",["T_VARIABLE","$outer_placeholder",291],",",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","definition",291],"[",["T_CONSTANT_ENCAPSED_STRING","'outer field'",291],"]",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$subquery_sql",291],")",";",["T_WHITESPACE","\n\n    ",291],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$subquery_sql",293],";",["T_WHITESPACE","\n  ",293],"}",["T_WHITESPACE","\n\n  ",294],["T_DOC_COMMENT","\/**\n   * Recursive helper to add a namespace to conditions.\n   *\n   * Similar to _views_query_tag_alter_condition().\n   *\n   * (Though why is the condition we get in a simple query 3 levels deep???)\n   *\/",296],["T_WHITESPACE","\n  ",302],["T_PROTECTED","protected",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","alterSubqueryCondition",303],"(",["T_STRING","AlterableInterface",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$query",303],",",["T_WHITESPACE"," ",303],"&",["T_VARIABLE","$conditions",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n    ",303],["T_FOREACH","foreach",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$conditions",304],["T_WHITESPACE"," ",304],["T_AS","as",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$condition_id",304],["T_WHITESPACE"," ",304],["T_DOUBLE_ARROW","=>",304],["T_WHITESPACE"," ",304],"&",["T_VARIABLE","$condition",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n      ",304],["T_COMMENT","\/\/ Skip the #conjunction element.\n",305],["T_WHITESPACE","      ",306],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_STRING","is_numeric",306],"(",["T_VARIABLE","$condition_id",306],")",")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n        ",306],["T_IF","if",307],["T_WHITESPACE"," ",307],"(",["T_STRING","is_string",307],"(",["T_VARIABLE","$condition",307],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",307],"]",")",")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n          ",307],["T_VARIABLE","$condition",308],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",308],"]",["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","conditionNamespace",308],"(",["T_VARIABLE","$condition",308],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",308],"]",")",";",["T_WHITESPACE","\n        ",308],"}",["T_WHITESPACE","\n        ",309],["T_ELSEIF","elseif",310],["T_WHITESPACE"," ",310],"(",["T_STRING","is_object",310],"(",["T_VARIABLE","$condition",310],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",310],"]",")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n          ",310],["T_VARIABLE","$sub_conditions",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],"&",["T_VARIABLE","$condition",311],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",311],"]",["T_OBJECT_OPERATOR","->",311],["T_STRING","conditions",311],"(",")",";",["T_WHITESPACE","\n          ",311],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","alterSubqueryCondition",312],"(",["T_VARIABLE","$query",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$sub_conditions",312],")",";",["T_WHITESPACE","\n        ",312],"}",["T_WHITESPACE","\n      ",313],"}",["T_WHITESPACE","\n    ",314],"}",["T_WHITESPACE","\n  ",315],"}",["T_WHITESPACE","\n\n  ",316],["T_DOC_COMMENT","\/**\n   * Helper function to namespace query pieces.\n   *\n   * Turns 'foo.bar' into '\"foo_NAMESPACE\".bar'.\n   * PostgreSQL doesn't support mixed-cased identifiers unless quoted, so we\n   * need to quote each single part to prevent from query exceptions.\n   *\/",318],["T_WHITESPACE","\n  ",324],["T_PROTECTED","protected",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","conditionNamespace",325],"(",["T_VARIABLE","$string",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n    ",325],["T_VARIABLE","$parts",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_STRING","explode",326],"(",["T_CONSTANT_ENCAPSED_STRING","' = '",326],",",["T_WHITESPACE"," ",326],["T_VARIABLE","$string",326],")",";",["T_WHITESPACE","\n    ",326],["T_FOREACH","foreach",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$parts",327],["T_WHITESPACE"," ",327],["T_AS","as",327],["T_WHITESPACE"," ",327],"&",["T_VARIABLE","$part",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n      ",327],["T_IF","if",328],["T_WHITESPACE"," ",328],"(",["T_STRING","strpos",328],"(",["T_VARIABLE","$part",328],",",["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'.'",328],")",["T_WHITESPACE"," ",328],["T_IS_NOT_IDENTICAL","!==",328],["T_WHITESPACE"," ",328],["T_STRING","FALSE",328],")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n        ",328],["T_VARIABLE","$part",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'\"'",329],["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_STRING","str_replace",329],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",329],",",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","subquery_namespace",329],["T_WHITESPACE"," ",329],".",["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'\".'",329],",",["T_WHITESPACE"," ",329],["T_VARIABLE","$part",329],")",";",["T_WHITESPACE","\n      ",329],"}",["T_WHITESPACE","\n    ",330],"}",["T_WHITESPACE","\n\n    ",331],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_STRING","implode",333],"(",["T_CONSTANT_ENCAPSED_STRING","' = '",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$parts",333],")",";",["T_WHITESPACE","\n  ",333],"}",["T_WHITESPACE","\n\n  ",334],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",336],["T_WHITESPACE","\n  ",338],["T_PUBLIC","public",339],["T_WHITESPACE"," ",339],["T_FUNCTION","function",339],["T_WHITESPACE"," ",339],["T_STRING","query",339],"(",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n    ",339],["T_COMMENT","\/\/ Figure out what base table this relationship brings to the party.\n",340],["T_WHITESPACE","    ",341],["T_VARIABLE","$table_data",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_STRING","Views",341],["T_DOUBLE_COLON","::",341],["T_STRING","viewsData",341],"(",")",["T_OBJECT_OPERATOR","->",341],["T_STRING","get",341],"(",["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","definition",341],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",341],"]",")",";",["T_WHITESPACE","\n    ",341],["T_VARIABLE","$base_field",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_EMPTY","empty",342],"(",["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","definition",342],"[",["T_CONSTANT_ENCAPSED_STRING","'base field'",342],"]",")",["T_WHITESPACE"," ",342],"?",["T_WHITESPACE"," ",342],["T_VARIABLE","$table_data",342],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",342],"]","[",["T_CONSTANT_ENCAPSED_STRING","'base'",342],"]","[",["T_CONSTANT_ENCAPSED_STRING","'field'",342],"]",["T_WHITESPACE"," ",342],":",["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","definition",342],"[",["T_CONSTANT_ENCAPSED_STRING","'base field'",342],"]",";",["T_WHITESPACE","\n\n    ",342],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","ensureMyTable",344],"(",")",";",["T_WHITESPACE","\n\n    ",344],["T_VARIABLE","$def",346],["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","definition",346],";",["T_WHITESPACE","\n    ",346],["T_VARIABLE","$def",347],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",347],"]",["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","definition",347],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",347],"]",";",["T_WHITESPACE","\n    ",347],["T_VARIABLE","$def",348],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",348],"]",["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$base_field",348],";",["T_WHITESPACE","\n    ",348],["T_VARIABLE","$def",349],"[",["T_CONSTANT_ENCAPSED_STRING","'left_table'",349],"]",["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","tableAlias",349],";",["T_WHITESPACE","\n    ",349],["T_VARIABLE","$def",350],"[",["T_CONSTANT_ENCAPSED_STRING","'left_field'",350],"]",["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","field",350],";",["T_WHITESPACE","\n    ",350],["T_VARIABLE","$def",351],"[",["T_CONSTANT_ENCAPSED_STRING","'adjusted'",351],"]",["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","TRUE",351],";",["T_WHITESPACE","\n    ",351],["T_IF","if",352],["T_WHITESPACE"," ",352],"(","!",["T_EMPTY","empty",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","options",352],"[",["T_CONSTANT_ENCAPSED_STRING","'required'",352],"]",")",")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n      ",352],["T_VARIABLE","$def",353],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",353],"]",["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","'INNER'",353],";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n    ",354],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","options",356],"[",["T_CONSTANT_ENCAPSED_STRING","'subquery_regenerate'",356],"]",")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n      ",356],["T_COMMENT","\/\/ For testing only, regenerate the subquery each time.\n",357],["T_WHITESPACE","      ",358],["T_VARIABLE","$def",358],"[",["T_CONSTANT_ENCAPSED_STRING","'left_query'",358],"]",["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","leftQuery",358],"(",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","options",358],")",";",["T_WHITESPACE","\n    ",358],"}",["T_WHITESPACE","\n    ",359],["T_ELSE","else",360],["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n      ",360],["T_COMMENT","\/\/ Get the stored subquery SQL string.\n",361],["T_WHITESPACE","      ",362],["T_VARIABLE","$cid",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","'views_relationship_groupwise_max:'",362],["T_WHITESPACE"," ",362],".",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","view",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","storage",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","id",362],"(",")",["T_WHITESPACE"," ",362],".",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","':'",362],["T_WHITESPACE"," ",362],".",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","view",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","current_display",362],["T_WHITESPACE"," ",362],".",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","':'",362],["T_WHITESPACE"," ",362],".",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","options",362],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",362],"]",";",["T_WHITESPACE","\n      ",362],["T_VARIABLE","$cache",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_NS_SEPARATOR","\\",363],["T_STRING","Drupal",363],["T_DOUBLE_COLON","::",363],["T_STRING","cache",363],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",363],")",["T_OBJECT_OPERATOR","->",363],["T_STRING","get",363],"(",["T_VARIABLE","$cid",363],")",";",["T_WHITESPACE","\n      ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(",["T_ISSET","isset",364],"(",["T_VARIABLE","$cache",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","data",364],")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n        ",364],["T_VARIABLE","$def",365],"[",["T_CONSTANT_ENCAPSED_STRING","'left_query'",365],"]",["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_VARIABLE","$cache",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","data",365],";",["T_WHITESPACE","\n      ",365],"}",["T_WHITESPACE","\n      ",366],["T_ELSE","else",367],["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n        ",367],["T_VARIABLE","$def",368],"[",["T_CONSTANT_ENCAPSED_STRING","'left_query'",368],"]",["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","leftQuery",368],"(",["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","options",368],")",";",["T_WHITESPACE","\n        ",368],["T_NS_SEPARATOR","\\",369],["T_STRING","Drupal",369],["T_DOUBLE_COLON","::",369],["T_STRING","cache",369],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",369],")",["T_OBJECT_OPERATOR","->",369],["T_STRING","set",369],"(",["T_VARIABLE","$cid",369],",",["T_WHITESPACE"," ",369],["T_VARIABLE","$def",369],"[",["T_CONSTANT_ENCAPSED_STRING","'left_query'",369],"]",")",";",["T_WHITESPACE","\n      ",369],"}",["T_WHITESPACE","\n    ",370],"}",["T_WHITESPACE","\n\n    ",371],["T_IF","if",373],["T_WHITESPACE"," ",373],"(","!",["T_EMPTY","empty",373],"(",["T_VARIABLE","$def",373],"[",["T_CONSTANT_ENCAPSED_STRING","'join_id'",373],"]",")",")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n      ",373],["T_VARIABLE","$id",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_VARIABLE","$def",374],"[",["T_CONSTANT_ENCAPSED_STRING","'join_id'",374],"]",";",["T_WHITESPACE","\n    ",374],"}",["T_WHITESPACE","\n    ",375],["T_ELSE","else",376],["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n      ",376],["T_VARIABLE","$id",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_CONSTANT_ENCAPSED_STRING","'subquery'",377],";",["T_WHITESPACE","\n    ",377],"}",["T_WHITESPACE","\n    ",378],["T_VARIABLE","$join",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_STRING","Views",379],["T_DOUBLE_COLON","::",379],["T_STRING","pluginManager",379],"(",["T_CONSTANT_ENCAPSED_STRING","'join'",379],")",["T_OBJECT_OPERATOR","->",379],["T_STRING","createInstance",379],"(",["T_VARIABLE","$id",379],",",["T_WHITESPACE"," ",379],["T_VARIABLE","$def",379],")",";",["T_WHITESPACE","\n\n    ",379],["T_COMMENT","\/\/ use a short alias for this:\n",381],["T_WHITESPACE","    ",382],["T_VARIABLE","$alias",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$def",382],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",382],"]",["T_WHITESPACE"," ",382],".",["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'_'",382],["T_WHITESPACE"," ",382],".",["T_WHITESPACE"," ",382],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","table",382],";",["T_WHITESPACE","\n\n    ",382],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","alias",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","query",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","addRelationship",384],"(",["T_VARIABLE","$alias",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$join",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","definition",384],"[",["T_CONSTANT_ENCAPSED_STRING","'base'",384],"]",",",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","relationship",384],")",";",["T_WHITESPACE","\n  ",384],"}",["T_WHITESPACE","\n\n",385],"}",["T_WHITESPACE","\n",387]]