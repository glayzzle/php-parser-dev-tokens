[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","aggregator",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n",3],["T_USE","use",4],["T_WHITESPACE"," ",4],["T_STRING","Drupal",4],["T_NS_SEPARATOR","\\",4],["T_STRING","aggregator",4],["T_NS_SEPARATOR","\\",4],["T_STRING","Entity",4],["T_NS_SEPARATOR","\\",4],["T_STRING","Feed",4],";",["T_WHITESPACE","\n\n",4],["T_DOC_COMMENT","\/**\n * Update feed items from a feed.\n *\n * @group aggregator\n *\/",6],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","UpdateFeedItemTest",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_STRING","AggregatorTestBase",11],["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n  ",11],["T_DOC_COMMENT","\/**\n   * Tests running \"update items\" from 'admin\/config\/services\/aggregator' page.\n   *\/",12],["T_WHITESPACE","\n  ",14],["T_PUBLIC","public",15],["T_WHITESPACE"," ",15],["T_FUNCTION","function",15],["T_WHITESPACE"," ",15],["T_STRING","testUpdateFeedItem",15],"(",")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n    ",15],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","createSampleNodes",16],"(",")",";",["T_WHITESPACE","\n\n    ",16],["T_COMMENT","\/\/ Create a feed and test updating feed items if possible.\n",18],["T_WHITESPACE","    ",19],["T_VARIABLE","$feed",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","createFeed",19],"(",")",";",["T_WHITESPACE","\n    ",19],["T_IF","if",20],["T_WHITESPACE"," ",20],"(","!",["T_EMPTY","empty",20],"(",["T_VARIABLE","$feed",20],")",")",["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n      ",20],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","updateFeedItems",21],"(",["T_VARIABLE","$feed",21],",",["T_WHITESPACE"," ",21],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","getDefaultFeedItemCount",21],"(",")",")",";",["T_WHITESPACE","\n      ",21],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","deleteFeedItems",22],"(",["T_VARIABLE","$feed",22],")",";",["T_WHITESPACE","\n    ",22],"}",["T_WHITESPACE","\n\n    ",23],["T_COMMENT","\/\/ Delete feed.\n",25],["T_WHITESPACE","    ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","deleteFeed",26],"(",["T_VARIABLE","$feed",26],")",";",["T_WHITESPACE","\n\n    ",26],["T_COMMENT","\/\/ Test updating feed items without valid timestamp information.\n",28],["T_WHITESPACE","    ",29],["T_VARIABLE","$edit",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_WHITESPACE","\n      ",29],["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","\"Feed without publish timestamp\"",30],",",["T_WHITESPACE","\n      ",30],["T_CONSTANT_ENCAPSED_STRING","'url[0][value]'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getRSS091Sample",31],"(",")",",",["T_WHITESPACE","\n    ",31],")",";",["T_WHITESPACE","\n\n    ",32],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","drupalGet",34],"(",["T_VARIABLE","$edit",34],"[",["T_CONSTANT_ENCAPSED_STRING","'url[0][value]'",34],"]",")",";",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","assertResponse",35],"(",["T_LNUMBER","200",35],")",";",["T_WHITESPACE","\n\n    ",35],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","drupalPostForm",37],"(",["T_CONSTANT_ENCAPSED_STRING","'aggregator\/sources\/add'",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$edit",37],",",["T_WHITESPACE"," ",37],["T_STRING","t",37],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",37],")",")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","assertText",38],"(",["T_STRING","t",38],"(",["T_CONSTANT_ENCAPSED_STRING","'The feed @name has been added.'",38],",",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$edit",38],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",38],"]",")",")",",",["T_WHITESPACE"," ",38],["T_STRING","format_string",38],"(",["T_CONSTANT_ENCAPSED_STRING","'The feed @name has been added.'",38],",",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$edit",38],"[",["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",38],"]",")",")",")",";",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/ Verify that the creation message contains a link to a feed.\n",40],["T_WHITESPACE","    ",41],["T_VARIABLE","$view_link",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","xpath",41],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/div[@class=\"messages\"]\/\/a[contains(@href, :href)]'",41],",",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",["T_CONSTANT_ENCAPSED_STRING","':href'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'aggregator\/sources\/'",41],")",")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","assert",42],"(",["T_ISSET","isset",42],"(",["T_VARIABLE","$view_link",42],")",",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'The message area contains a link to a feed'",42],")",";",["T_WHITESPACE","\n\n    ",42],["T_VARIABLE","$fid",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","db_query",44],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT fid FROM {aggregator_feed} WHERE url = :url\"",44],",",["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",["T_CONSTANT_ENCAPSED_STRING","':url'",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$edit",44],"[",["T_CONSTANT_ENCAPSED_STRING","'url[0][value]'",44],"]",")",")",["T_OBJECT_OPERATOR","->",44],["T_STRING","fetchField",44],"(",")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$feed",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","Feed",45],["T_DOUBLE_COLON","::",45],["T_STRING","load",45],"(",["T_VARIABLE","$fid",45],")",";",["T_WHITESPACE","\n\n    ",45],["T_VARIABLE","$feed",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","refreshItems",47],"(",")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$before",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","db_query",48],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT timestamp FROM {aggregator_item} WHERE fid = :fid'",48],",",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_CONSTANT_ENCAPSED_STRING","':fid'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$feed",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","id",48],"(",")",")",")",["T_OBJECT_OPERATOR","->",48],["T_STRING","fetchField",48],"(",")",";",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/\/ Sleep for 3 second.\n",50],["T_WHITESPACE","    ",51],["T_STRING","sleep",51],"(",["T_LNUMBER","3",51],")",";",["T_WHITESPACE","\n    ",51],["T_STRING","db_update",52],"(",["T_CONSTANT_ENCAPSED_STRING","'aggregator_feed'",52],")",["T_WHITESPACE","\n      ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","condition",53],"(",["T_CONSTANT_ENCAPSED_STRING","'fid'",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$feed",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","id",53],"(",")",")",["T_WHITESPACE","\n      ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","fields",54],"(",["T_ARRAY","array",54],"(",["T_WHITESPACE","\n        ",54],["T_CONSTANT_ENCAPSED_STRING","'checked'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_LNUMBER","0",55],",",["T_WHITESPACE","\n        ",55],["T_CONSTANT_ENCAPSED_STRING","'hash'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","''",56],",",["T_WHITESPACE","\n        ",56],["T_CONSTANT_ENCAPSED_STRING","'etag'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","''",57],",",["T_WHITESPACE","\n        ",57],["T_CONSTANT_ENCAPSED_STRING","'modified'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_LNUMBER","0",58],",",["T_WHITESPACE","\n      ",58],")",")",["T_WHITESPACE","\n      ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","execute",60],"(",")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$feed",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","refreshItems",61],"(",")",";",["T_WHITESPACE","\n\n    ",61],["T_VARIABLE","$after",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","db_query",63],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT timestamp FROM {aggregator_item} WHERE fid = :fid'",63],",",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",["T_CONSTANT_ENCAPSED_STRING","':fid'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$feed",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","id",63],"(",")",")",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","fetchField",63],"(",")",";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertTrue",64],"(",["T_VARIABLE","$before",64],["T_WHITESPACE"," ",64],["T_IS_IDENTICAL","===",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$after",64],",",["T_WHITESPACE"," ",64],["T_STRING","format_string",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Publish timestamp of feed item was not updated (@before === @after)'",64],",",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",["T_CONSTANT_ENCAPSED_STRING","'@before'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$before",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'@after'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$after",64],")",")",")",";",["T_WHITESPACE","\n\n    ",64],["T_COMMENT","\/\/ Make sure updating items works even after uninstalling a module\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ that provides the selected plugins.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","enableTestPlugins",68],"(",")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","container",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","get",69],"(",["T_CONSTANT_ENCAPSED_STRING","'module_installer'",69],")",["T_OBJECT_OPERATOR","->",69],["T_STRING","uninstall",69],"(",["T_ARRAY","array",69],"(",["T_CONSTANT_ENCAPSED_STRING","'aggregator_test'",69],")",")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","updateFeedItems",70],"(",["T_VARIABLE","$feed",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertResponse",71],"(",["T_LNUMBER","200",71],")",";",["T_WHITESPACE","\n  ",71],"}",["T_WHITESPACE","\n\n",72],"}",["T_WHITESPACE","\n",74]]