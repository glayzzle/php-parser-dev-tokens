[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","rest",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Session",5],["T_NS_SEPARATOR","\\",5],["T_STRING","AccountInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","rest",6],["T_NS_SEPARATOR","\\",6],["T_STRING","RestResourceConfigInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","user",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Role",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","user",8],["T_NS_SEPARATOR","\\",8],["T_STRING","RoleInterface",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Tests the structure of a REST resource.\n *\n * @group rest\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","ResourceTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","RESTTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Modules to install.\n   *\n   * @var array\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$modules",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_ARRAY","array",22],"(",["T_CONSTANT_ENCAPSED_STRING","'hal'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'rest'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'rest_test'",22],")",";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The entity.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityInterface\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$entity",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",31],["T_WHITESPACE","\n  ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","setUp",34],"(",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n    ",34],["T_STRING","parent",35],["T_DOUBLE_COLON","::",35],["T_STRING","setUp",35],"(",")",";",["T_WHITESPACE","\n    ",35],["T_COMMENT","\/\/ Create an entity programmatic.\n",36],["T_WHITESPACE","    ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","entity",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","entityCreate",37],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","entity",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","save",38],"(",")",";",["T_WHITESPACE","\n\n    ",38],["T_STRING","Role",40],["T_DOUBLE_COLON","::",40],["T_STRING","load",40],"(",["T_STRING","AccountInterface",40],["T_DOUBLE_COLON","::",40],["T_STRING","ANONYMOUS_ROLE",40],")",["T_WHITESPACE","\n      ",40],["T_OBJECT_OPERATOR","->",41],["T_STRING","grantPermission",41],"(",["T_CONSTANT_ENCAPSED_STRING","'view test entity'",41],")",["T_WHITESPACE","\n      ",41],["T_OBJECT_OPERATOR","->",42],["T_STRING","save",42],"(",")",";",["T_WHITESPACE","\n  ",42],"}",["T_WHITESPACE","\n\n  ",43],["T_DOC_COMMENT","\/**\n   * Tests that a resource without formats cannot be enabled.\n   *\/",45],["T_WHITESPACE","\n  ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","testFormats",48],"(",")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","resourceConfigStorage",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","create",49],"(","[",["T_WHITESPACE","\n      ",49],["T_CONSTANT_ENCAPSED_STRING","'id'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'entity.entity_test'",50],",",["T_WHITESPACE","\n      ",50],["T_CONSTANT_ENCAPSED_STRING","'granularity'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_STRING","RestResourceConfigInterface",51],["T_DOUBLE_COLON","::",51],["T_STRING","METHOD_GRANULARITY",51],",",["T_WHITESPACE","\n      ",51],["T_CONSTANT_ENCAPSED_STRING","'configuration'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],"[",["T_WHITESPACE","\n        ",52],["T_CONSTANT_ENCAPSED_STRING","'GET'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],"[",["T_WHITESPACE","\n          ",53],["T_CONSTANT_ENCAPSED_STRING","'supported_auth'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],"[",["T_WHITESPACE","\n            ",54],["T_CONSTANT_ENCAPSED_STRING","'basic_auth'",55],",",["T_WHITESPACE","\n          ",55],"]",",",["T_WHITESPACE","\n        ",56],"]",",",["T_WHITESPACE","\n      ",57],"]",",",["T_WHITESPACE","\n    ",58],"]",")",["T_OBJECT_OPERATOR","->",59],["T_STRING","save",59],"(",")",";",["T_WHITESPACE","\n\n    ",59],["T_COMMENT","\/\/ Verify that accessing the resource returns 406.\n",61],["T_WHITESPACE","    ",62],["T_VARIABLE","$response",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","httpRequest",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","entity",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","urlInfo",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","setRouteParameter",62],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","defaultFormat",62],")",",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'GET'",62],")",";",["T_WHITESPACE","\n    ",62],["T_COMMENT","\/\/ \\Drupal\\Core\\Routing\\RequestFormatRouteFilter considers the canonical,\n",63],["T_WHITESPACE","    ",64],["T_COMMENT","\/\/ non-REST route a match, but a lower quality one: no format restrictions\n",64],["T_WHITESPACE","    ",65],["T_COMMENT","\/\/ means there's always a match and hence when there is no matching REST\n",65],["T_WHITESPACE","    ",66],["T_COMMENT","\/\/ route, the non-REST route is used, but can't render into\n",66],["T_WHITESPACE","    ",67],["T_COMMENT","\/\/ application\/hal+json, so it returns a 406.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","assertResponse",68],"(",["T_CONSTANT_ENCAPSED_STRING","'406'",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'HTTP response code is 406 when the resource does not define formats, because it falls back to the canonical, non-REST route.'",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","curlClose",69],"(",")",";",["T_WHITESPACE","\n  ",69],"}",["T_WHITESPACE","\n\n  ",70],["T_DOC_COMMENT","\/**\n   * Tests that a resource without authentication cannot be enabled.\n   *\/",72],["T_WHITESPACE","\n  ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","testAuthentication",75],"(",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","resourceConfigStorage",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","create",76],"(","[",["T_WHITESPACE","\n      ",76],["T_CONSTANT_ENCAPSED_STRING","'id'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'entity.entity_test'",77],",",["T_WHITESPACE","\n      ",77],["T_CONSTANT_ENCAPSED_STRING","'granularity'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_STRING","RestResourceConfigInterface",78],["T_DOUBLE_COLON","::",78],["T_STRING","METHOD_GRANULARITY",78],",",["T_WHITESPACE","\n      ",78],["T_CONSTANT_ENCAPSED_STRING","'configuration'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],"[",["T_WHITESPACE","\n        ",79],["T_CONSTANT_ENCAPSED_STRING","'GET'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],"[",["T_WHITESPACE","\n          ",80],["T_CONSTANT_ENCAPSED_STRING","'supported_formats'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],"[",["T_WHITESPACE","\n            ",81],["T_CONSTANT_ENCAPSED_STRING","'hal_json'",82],",",["T_WHITESPACE","\n          ",82],"]",",",["T_WHITESPACE","\n        ",83],"]",",",["T_WHITESPACE","\n      ",84],"]",",",["T_WHITESPACE","\n    ",85],"]",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","save",86],"(",")",";",["T_WHITESPACE","\n\n    ",86],["T_COMMENT","\/\/ Verify that accessing the resource returns 401.\n",88],["T_WHITESPACE","    ",89],["T_VARIABLE","$response",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","httpRequest",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","entity",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","urlInfo",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","setRouteParameter",89],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","defaultFormat",89],")",",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'GET'",89],")",";",["T_WHITESPACE","\n    ",89],["T_COMMENT","\/\/ \\Drupal\\Core\\Routing\\RequestFormatRouteFilter considers the canonical,\n",90],["T_WHITESPACE","    ",91],["T_COMMENT","\/\/ non-REST route a match, but a lower quality one: no format restrictions\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/ means there's always a match and hence when there is no matching REST\n",92],["T_WHITESPACE","    ",93],["T_COMMENT","\/\/ route, the non-REST route is used, but can't render into\n",93],["T_WHITESPACE","    ",94],["T_COMMENT","\/\/ application\/hal+json, so it returns a 406.\n",94],["T_WHITESPACE","    ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertResponse",95],"(",["T_CONSTANT_ENCAPSED_STRING","'406'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'HTTP response code is 406 when the resource does not define formats, because it falls back to the canonical, non-REST route.'",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","curlClose",96],"(",")",";",["T_WHITESPACE","\n  ",96],"}",["T_WHITESPACE","\n\n  ",97],["T_DOC_COMMENT","\/**\n   * Tests that serialization_class is optional.\n   *\/",99],["T_WHITESPACE","\n  ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","testSerializationClassIsOptional",102],"(",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","enableService",103],"(",["T_CONSTANT_ENCAPSED_STRING","'serialization_test'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'POST'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'json'",103],")",";",["T_WHITESPACE","\n\n    ",103],["T_STRING","Role",105],["T_DOUBLE_COLON","::",105],["T_STRING","load",105],"(",["T_STRING","RoleInterface",105],["T_DOUBLE_COLON","::",105],["T_STRING","ANONYMOUS_ID",105],")",["T_WHITESPACE","\n      ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","grantPermission",106],"(",["T_CONSTANT_ENCAPSED_STRING","'restful post serialization_test'",106],")",["T_WHITESPACE","\n      ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","save",107],"(",")",";",["T_WHITESPACE","\n\n    ",107],["T_VARIABLE","$serialized",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","container",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","get",109],"(",["T_CONSTANT_ENCAPSED_STRING","'serializer'",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","serialize",109],"(","[",["T_CONSTANT_ENCAPSED_STRING","'foo'",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'bar'",109],"]",",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'json'",109],")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","httpRequest",110],"(",["T_CONSTANT_ENCAPSED_STRING","'serialization_test'",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'POST'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$serialized",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'application\/json'",110],")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","assertResponse",111],"(",["T_LNUMBER","200",111],")",";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertResponseBody",112],"(",["T_CONSTANT_ENCAPSED_STRING","'[\"foo\",\"bar\"]'",112],")",";",["T_WHITESPACE","\n  ",112],"}",["T_WHITESPACE","\n\n  ",113],["T_DOC_COMMENT","\/**\n   * Tests that resource URI paths are formatted properly.\n   *\/",115],["T_WHITESPACE","\n  ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","testUriPaths",118],"(",")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","enableService",119],"(",["T_CONSTANT_ENCAPSED_STRING","'entity:entity_test'",119],")",";",["T_WHITESPACE","\n    ",119],["T_DOC_COMMENT","\/** @var \\Drupal\\rest\\Plugin\\Type\\ResourcePluginManager $manager *\/",120],["T_WHITESPACE","\n    ",120],["T_VARIABLE","$manager",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_NS_SEPARATOR","\\",121],["T_STRING","Drupal",121],["T_DOUBLE_COLON","::",121],["T_STRING","service",121],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.rest'",121],")",";",["T_WHITESPACE","\n\n    ",121],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$manager",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getDefinitions",123],"(",")",["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$resource",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$definition",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n      ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$definition",124],"[",["T_CONSTANT_ENCAPSED_STRING","'uri_paths'",124],"]",["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$key",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$uri_path",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","assertFalse",125],"(",["T_STRING","strpos",125],"(",["T_VARIABLE","$uri_path",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'\/\/'",125],")",",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'The resource URI path does not have duplicate slashes.'",125],")",";",["T_WHITESPACE","\n      ",125],"}",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n  ",127],"}",["T_WHITESPACE","\n\n",128],"}",["T_WHITESPACE","\n",130]]