[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","rest",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Functional",3],["T_NS_SEPARATOR","\\",3],["T_STRING","EntityResource",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","NestedArray",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Config",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ConfigEntityInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntityChangedInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FieldableEntityInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Url",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","field",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Entity",11],["T_NS_SEPARATOR","\\",11],["T_STRING","FieldConfig",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","field",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Entity",12],["T_NS_SEPARATOR","\\",12],["T_STRING","FieldStorageConfig",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Drupal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Tests",13],["T_NS_SEPARATOR","\\",13],["T_STRING","rest",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Functional",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceTestBase",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","GuzzleHttp",14],["T_NS_SEPARATOR","\\",14],["T_STRING","RequestOptions",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Psr",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Http",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Message",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ResponseInterface",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Even though there is the generic EntityResource, it's necessary for every\n * entity type to have its own test, because they each have different fields,\n * validation constraints, et cetera. It's not because the generic case works,\n * that every case works.\n *\n * Furthermore, it's necessary to test every format separately, because there\n * can be entity type-specific normalization or serialization problems.\n *\n * Subclass this for every entity type. Also respect instructions in\n * \\Drupal\\rest\\Tests\\ResourceTestBase.\n *\n * For example, for the node test coverage, there is the (abstract)\n * \\Drupal\\Tests\\rest\\Functional\\EntityResource\\Node\\NodeResourceTestBase, which\n * is then again subclassed for every authentication provider:\n * - \\Drupal\\Tests\\rest\\Functional\\EntityResource\\Node\\NodeJsonAnonTest\n * - \\Drupal\\Tests\\rest\\Functional\\EntityResource\\Node\\NodeJsonBasicAuthTest\n * - \\Drupal\\Tests\\rest\\Functional\\EntityResource\\Node\\NodeJsonCookieTest\n * But the HAL module also adds a new format ('hal_json'), so that format also\n * needs test coverage (for its own peculiarities in normalization & encoding):\n * - \\Drupal\\Tests\\hal\\Functional\\EntityResource\\Node\\NodeHalJsonAnonTest\n * - \\Drupal\\Tests\\hal\\Functional\\EntityResource\\Node\\NodeHalJsonBasicAuthTest\n * - \\Drupal\\Tests\\hal\\Functional\\EntityResource\\Node\\NodeHalJsonCookieTest\n *\n * In other words: for every entity type there should be:\n * 1. an abstract subclass that includes the entity type-specific authorization\n *    (permissions or perhaps custom access control handling, such as node\n *    grants), plus\n * 2. a concrete subclass extending the abstract entity type-specific subclass\n *    that specifies the exact @code $format @endcode, @code $mimeType @endcode,\n *    @code $expectedErrorMimeType @endcode and @code $auth @endcode for this\n *    concrete test. Usually that's all that's necessary: most concrete\n *    subclasses will be very thin.\n *\n * For every of these concrete subclasses, a comprehensive test scenario will\n * run per HTTP method:\n * - ::testGet()\n * - ::testPost()\n * - ::testPatch()\n * - ::testDelete()\n *\n * If there is an entity type-specific edge case scenario to test, then add that\n * to the entity type-specific abstract subclass. Example:\n * \\Drupal\\Tests\\rest\\Functional\\EntityResource\\Comment\\CommentResourceTestBase::testPostDxWithoutCriticalBaseFields\n *\n * If there is an entity type-specific format-specific edge case to test, then\n * add that to a concrete subclass. Example:\n * \\Drupal\\Tests\\hal\\Functional\\EntityResource\\Comment\\CommentHalJsonTestBase::$patchProtectedFieldNames\n *\/",17],["T_WHITESPACE","\n",65],["T_ABSTRACT","abstract",66],["T_WHITESPACE"," ",66],["T_CLASS","class",66],["T_WHITESPACE"," ",66],["T_STRING","EntityResourceTestBase",66],["T_WHITESPACE"," ",66],["T_EXTENDS","extends",66],["T_WHITESPACE"," ",66],["T_STRING","ResourceTestBase",66],["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n\n  ",66],["T_DOC_COMMENT","\/**\n   * The tested entity type.\n   *\n   * @var string\n   *\/",68],["T_WHITESPACE","\n  ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_STATIC","static",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$entityTypeId",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","NULL",73],";",["T_WHITESPACE","\n\n  ",73],["T_DOC_COMMENT","\/**\n   * The fields that are protected against modification during PATCH requests.\n   *\n   * @var string[]\n   *\/",75],["T_WHITESPACE","\n  ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_STATIC","static",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$patchProtectedFieldNames",80],";",["T_WHITESPACE","\n\n  ",80],["T_DOC_COMMENT","\/**\n   * Optionally specify which field is the 'label' field. Some entities specify\n   * a 'label_callback', but not a 'label' entity key. For example: User.\n   *\n   * @see ::getInvalidNormalizedEntityToCreate\n   *\n   * @var string|null\n   *\/",82],["T_WHITESPACE","\n  ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_STATIC","static",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$labelFieldName",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","NULL",90],";",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * The entity ID for the first created entity in testPost().\n   *\n   * The default value of 2 should work for most content entities.\n   *\n   * @see ::testPost()\n   *\n   * @var string|int\n   *\/",92],["T_WHITESPACE","\n  ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_STATIC","static",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$firstCreatedEntityId",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_LNUMBER","2",101],";",["T_WHITESPACE","\n\n  ",101],["T_DOC_COMMENT","\/**\n   * The entity ID for the second created entity in testPost().\n   *\n   * The default value of 3 should work for most content entities.\n   *\n   * @see ::testPost()\n   *\n   * @var string|int\n   *\/",103],["T_WHITESPACE","\n  ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_STATIC","static",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$secondCreatedEntityId",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_LNUMBER","3",112],";",["T_WHITESPACE","\n\n  ",112],["T_DOC_COMMENT","\/**\n   * @var \\GuzzleHttp\\ClientInterface\n   *\/",114],["T_WHITESPACE","\n  ",116],["T_PROTECTED","protected",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$httpClient",117],";",["T_WHITESPACE","\n\n  ",117],["T_DOC_COMMENT","\/**\n   * The main entity used for testing.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityInterface\n   *\/",119],["T_WHITESPACE","\n  ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$entity",124],";",["T_WHITESPACE","\n\n  ",124],["T_DOC_COMMENT","\/**\n   * The entity storage.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityStorageInterface\n   *\/",126],["T_WHITESPACE","\n  ",130],["T_PROTECTED","protected",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$entityStorage",131],";",["T_WHITESPACE","\n\n  ",131],["T_DOC_COMMENT","\/**\n   * Modules to install.\n   *\n   * @var array\n   *\/",133],["T_WHITESPACE","\n  ",137],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_STATIC","static",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$modules",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],"[",["T_CONSTANT_ENCAPSED_STRING","'rest_test'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'text'",138],"]",";",["T_WHITESPACE","\n\n  ",138],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",140],["T_WHITESPACE","\n  ",142],["T_PROTECTED","protected",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","provisionEntityResource",143],"(",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n    ",143],["T_COMMENT","\/\/ It's possible to not have any authentication providers enabled, when\n",144],["T_WHITESPACE","    ",145],["T_COMMENT","\/\/ testing public (anonymous) usage of a REST resource.\n",145],["T_WHITESPACE","    ",146],["T_VARIABLE","$auth",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_ISSET","isset",146],"(",["T_STATIC","static",146],["T_DOUBLE_COLON","::",146],["T_VARIABLE","$auth",146],")",["T_WHITESPACE"," ",146],"?",["T_WHITESPACE"," ",146],"[",["T_STATIC","static",146],["T_DOUBLE_COLON","::",146],["T_VARIABLE","$auth",146],"]",["T_WHITESPACE"," ",146],":",["T_WHITESPACE"," ",146],"[","]",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","provisionResource",147],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.'",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_STATIC","static",147],["T_DOUBLE_COLON","::",147],["T_VARIABLE","$entityTypeId",147],",",["T_WHITESPACE"," ",147],"[",["T_STATIC","static",147],["T_DOUBLE_COLON","::",147],["T_VARIABLE","$format",147],"]",",",["T_WHITESPACE"," ",147],["T_VARIABLE","$auth",147],")",";",["T_WHITESPACE","\n  ",147],"}",["T_WHITESPACE","\n\n  ",148],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",150],["T_WHITESPACE","\n  ",152],["T_PUBLIC","public",153],["T_WHITESPACE"," ",153],["T_FUNCTION","function",153],["T_WHITESPACE"," ",153],["T_STRING","setUp",153],"(",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n    ",153],["T_STRING","parent",154],["T_DOUBLE_COLON","::",154],["T_STRING","setUp",154],"(",")",";",["T_WHITESPACE","\n\n    ",154],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","serializer",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","container",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","get",156],"(",["T_CONSTANT_ENCAPSED_STRING","'serializer'",156],")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","entityStorage",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","container",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","get",157],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",157],")",["T_WHITESPACE","\n      ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","getStorage",158],"(",["T_STATIC","static",158],["T_DOUBLE_COLON","::",158],["T_VARIABLE","$entityTypeId",158],")",";",["T_WHITESPACE","\n\n    ",158],["T_COMMENT","\/\/ Set up a HTTP client that accepts relative URLs.\n",160],["T_WHITESPACE","    ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","httpClient",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","container",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","get",161],"(",["T_CONSTANT_ENCAPSED_STRING","'http_client_factory'",161],")",["T_WHITESPACE","\n      ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","fromOptions",162],"(","[",["T_CONSTANT_ENCAPSED_STRING","'base_uri'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","baseUrl",162],"]",")",";",["T_WHITESPACE","\n\n    ",162],["T_COMMENT","\/\/ Create an entity.\n",164],["T_WHITESPACE","    ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","entity",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","createEntity",165],"(",")",";",["T_WHITESPACE","\n\n    ",165],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","entity",167],["T_WHITESPACE"," ",167],["T_INSTANCEOF","instanceof",167],["T_WHITESPACE"," ",167],["T_STRING","FieldableEntityInterface",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n      ",167],["T_COMMENT","\/\/ Add access-protected field.\n",168],["T_WHITESPACE","      ",169],["T_STRING","FieldStorageConfig",169],["T_DOUBLE_COLON","::",169],["T_STRING","create",169],"(","[",["T_WHITESPACE","\n        ",169],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_STATIC","static",170],["T_DOUBLE_COLON","::",170],["T_VARIABLE","$entityTypeId",170],",",["T_WHITESPACE","\n        ",170],["T_CONSTANT_ENCAPSED_STRING","'field_name'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'field_rest_test'",171],",",["T_WHITESPACE","\n        ",171],["T_CONSTANT_ENCAPSED_STRING","'type'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'text'",172],",",["T_WHITESPACE","\n      ",172],"]",")",["T_WHITESPACE","\n        ",173],["T_OBJECT_OPERATOR","->",174],["T_STRING","setCardinality",174],"(",["T_LNUMBER","1",174],")",["T_WHITESPACE","\n        ",174],["T_OBJECT_OPERATOR","->",175],["T_STRING","save",175],"(",")",";",["T_WHITESPACE","\n      ",175],["T_STRING","FieldConfig",176],["T_DOUBLE_COLON","::",176],["T_STRING","create",176],"(","[",["T_WHITESPACE","\n        ",176],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_STATIC","static",177],["T_DOUBLE_COLON","::",177],["T_VARIABLE","$entityTypeId",177],",",["T_WHITESPACE","\n        ",177],["T_CONSTANT_ENCAPSED_STRING","'field_name'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'field_rest_test'",178],",",["T_WHITESPACE","\n        ",178],["T_CONSTANT_ENCAPSED_STRING","'bundle'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","entity",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","bundle",179],"(",")",",",["T_WHITESPACE","\n      ",179],"]",")",["T_WHITESPACE","\n        ",180],["T_OBJECT_OPERATOR","->",181],["T_STRING","setLabel",181],"(",["T_CONSTANT_ENCAPSED_STRING","'Test field'",181],")",["T_WHITESPACE","\n        ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","setTranslatable",182],"(",["T_STRING","FALSE",182],")",["T_WHITESPACE","\n        ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","save",183],"(",")",";",["T_WHITESPACE","\n\n      ",183],["T_COMMENT","\/\/ Reload entity so that it has the new field.\n",185],["T_WHITESPACE","      ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","entity",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","entityStorage",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","loadUnchanged",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","entity",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","id",186],"(",")",")",";",["T_WHITESPACE","\n\n      ",186],["T_COMMENT","\/\/ Set a default value on the field.\n",188],["T_WHITESPACE","      ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","entity",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","set",189],"(",["T_CONSTANT_ENCAPSED_STRING","'field_rest_test'",189],",",["T_WHITESPACE"," ",189],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'All the faith he had had had had no effect on the outcome of his life.'",189],"]",")",";",["T_WHITESPACE","\n      ",189],["T_COMMENT","\/\/ @todo Remove in this if-test in https:\/\/www.drupal.org\/node\/2808335.\n",190],["T_WHITESPACE","      ",191],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","entity",191],["T_WHITESPACE"," ",191],["T_INSTANCEOF","instanceof",191],["T_WHITESPACE"," ",191],["T_STRING","EntityChangedInterface",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$changed",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","entity",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getChangedTime",192],"(",")",";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","entity",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","setChangedTime",193],"(",["T_LNUMBER","42",193],")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","entity",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","save",194],"(",")",";",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","entity",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","setChangedTime",195],"(",["T_VARIABLE","$changed",195],")",";",["T_WHITESPACE","\n      ",195],"}",["T_WHITESPACE","\n      ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","entity",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","save",197],"(",")",";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2815845.\n",200],["T_WHITESPACE","    ",201],["T_STRING","drupal_flush_all_caches",201],"(",")",";",["T_WHITESPACE","\n  ",201],"}",["T_WHITESPACE","\n\n  ",202],["T_DOC_COMMENT","\/**\n   * Creates the entity to be tested.\n   *\n   * @return \\Drupal\\Core\\Entity\\EntityInterface\n   *   The entity to be tested.\n   *\/",204],["T_WHITESPACE","\n  ",209],["T_ABSTRACT","abstract",210],["T_WHITESPACE"," ",210],["T_PROTECTED","protected",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","createEntity",210],"(",")",";",["T_WHITESPACE","\n\n  ",210],["T_DOC_COMMENT","\/**\n   * Returns the expected normalization of the entity.\n   *\n   * @see ::createEntity()\n   *\n   * @return array\n   *\/",212],["T_WHITESPACE","\n  ",218],["T_ABSTRACT","abstract",219],["T_WHITESPACE"," ",219],["T_PROTECTED","protected",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","getExpectedNormalizedEntity",219],"(",")",";",["T_WHITESPACE","\n\n  ",219],["T_DOC_COMMENT","\/**\n   * Returns the normalized POST entity.\n   *\n   * @see ::testPost\n   *\n   * @return array\n   *\/",221],["T_WHITESPACE","\n  ",227],["T_ABSTRACT","abstract",228],["T_WHITESPACE"," ",228],["T_PROTECTED","protected",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","getNormalizedPostEntity",228],"(",")",";",["T_WHITESPACE","\n\n  ",228],["T_DOC_COMMENT","\/**\n   * Returns the normalized PATCH entity.\n   *\n   * By default, reuses ::getNormalizedPostEntity(), which works fine for most\n   * entity types. A counterexample: the 'comment' entity type.\n   *\n   * @see ::testPatch\n   *\n   * @return array\n   *\/",230],["T_WHITESPACE","\n  ",239],["T_PROTECTED","protected",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","getNormalizedPatchEntity",240],"(",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n    ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getNormalizedPostEntity",241],"(",")",";",["T_WHITESPACE","\n  ",241],"}",["T_WHITESPACE","\n\n  ",242],["T_DOC_COMMENT","\/**\n   * The expected cache tags for the GET\/HEAD response of the test entity.\n   *\n   * @see ::testGet\n   *\n   * @return string[]\n   *\/",244],["T_WHITESPACE","\n  ",250],["T_PROTECTED","protected",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","getExpectedCacheTags",251],"(",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n    ",251],["T_VARIABLE","$expected_cache_tags",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],"[",["T_WHITESPACE","\n      ",252],["T_CONSTANT_ENCAPSED_STRING","'config:rest.resource.entity.'",253],["T_WHITESPACE"," ",253],".",["T_WHITESPACE"," ",253],["T_STATIC","static",253],["T_DOUBLE_COLON","::",253],["T_VARIABLE","$entityTypeId",253],",",["T_WHITESPACE","\n    ",253],"]",";",["T_WHITESPACE","\n    ",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(","!",["T_STATIC","static",255],["T_DOUBLE_COLON","::",255],["T_VARIABLE","$auth",255],")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n      ",255],["T_VARIABLE","$expected_cache_tags",256],"[","]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'config:user.role.anonymous'",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n    ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_STRING","Cache",258],["T_DOUBLE_COLON","::",258],["T_STRING","mergeTags",258],"(",["T_VARIABLE","$expected_cache_tags",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","entity",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getCacheTags",258],"(",")",")",";",["T_WHITESPACE","\n  ",258],"}",["T_WHITESPACE","\n\n  ",259],["T_DOC_COMMENT","\/**\n   * The expected cache contexts for the GET\/HEAD response of the test entity.\n   *\n   * @see ::testGet\n   *\n   * @return string[]\n   *\/",261],["T_WHITESPACE","\n  ",267],["T_PROTECTED","protected",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","getExpectedCacheContexts",268],"(",")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n    ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],"[",["T_WHITESPACE","\n      ",269],["T_CONSTANT_ENCAPSED_STRING","'user.permissions'",270],",",["T_WHITESPACE","\n    ",270],"]",";",["T_WHITESPACE","\n  ",271],"}",["T_WHITESPACE","\n\n  ",272],["T_DOC_COMMENT","\/**\n   * Test a GET request for an entity, plus edge cases to ensure good DX.\n   *\/",274],["T_WHITESPACE","\n  ",276],["T_PUBLIC","public",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","testGet",277],"(",")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n    ",277],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","initAuthentication",278],"(",")",";",["T_WHITESPACE","\n    ",278],["T_VARIABLE","$has_canonical_url",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","entity",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","hasLinkTemplate",279],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",279],")",";",["T_WHITESPACE","\n\n    ",279],["T_COMMENT","\/\/ The URL and Guzzle request options that will be used in this test. The\n",281],["T_WHITESPACE","    ",282],["T_COMMENT","\/\/ request options will be modified\/expanded throughout this test:\n",282],["T_WHITESPACE","    ",283],["T_COMMENT","\/\/ - to first test all mistakes a developer might make, and assert that the\n",283],["T_WHITESPACE","    ",284],["T_COMMENT","\/\/   error responses provide a good DX\n",284],["T_WHITESPACE","    ",285],["T_COMMENT","\/\/ - to eventually result in a well-formed request that succeeds.\n",285],["T_WHITESPACE","    ",286],["T_VARIABLE","$url",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getUrl",286],"(",")",";",["T_WHITESPACE","\n    ",286],["T_VARIABLE","$request_options",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],"[","]",";",["T_WHITESPACE","\n\n\n    ",287],["T_COMMENT","\/\/ DX: 404 when resource not provisioned, 403 if canonical route. HTML\n",290],["T_WHITESPACE","    ",291],["T_COMMENT","\/\/ response because missing ?_format query string.\n",291],["T_WHITESPACE","    ",292],["T_VARIABLE","$response",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","request",292],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$url",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$request_options",292],")",";",["T_WHITESPACE","\n    ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","assertSame",293],"(",["T_VARIABLE","$has_canonical_url",293],["T_WHITESPACE"," ",293],"?",["T_WHITESPACE"," ",293],["T_LNUMBER","403",293],["T_WHITESPACE"," ",293],":",["T_WHITESPACE"," ",293],["T_LNUMBER","404",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$response",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getStatusCode",293],"(",")",")",";",["T_WHITESPACE","\n    ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","assertSame",294],"(","[",["T_CONSTANT_ENCAPSED_STRING","'text\/html; charset=UTF-8'",294],"]",",",["T_WHITESPACE"," ",294],["T_VARIABLE","$response",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getHeader",294],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",294],")",")",";",["T_WHITESPACE","\n\n\n    ",294],["T_VARIABLE","$url",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","setOption",297],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",297],",",["T_WHITESPACE"," ",297],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_STATIC","static",297],["T_DOUBLE_COLON","::",297],["T_VARIABLE","$format",297],"]",")",";",["T_WHITESPACE","\n\n\n    ",297],["T_COMMENT","\/\/ DX: 404 when resource not provisioned, 403 if canonical route. Non-HTML\n",300],["T_WHITESPACE","    ",301],["T_COMMENT","\/\/ response because ?_format query string is present.\n",301],["T_WHITESPACE","    ",302],["T_VARIABLE","$response",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","request",302],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$url",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$request_options",302],")",";",["T_WHITESPACE","\n    ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$has_canonical_url",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n      ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","assertResourceErrorResponse",304],"(",["T_LNUMBER","403",304],",",["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","''",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$response",304],")",";",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n    ",305],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n      ",306],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","assertResourceErrorResponse",307],"(",["T_LNUMBER","404",307],",",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"GET '",307],["T_WHITESPACE"," ",307],".",["T_WHITESPACE"," ",307],["T_STRING","str_replace",307],"(",["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","baseUrl",307],",",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","''",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getUrl",307],"(",")",["T_OBJECT_OPERATOR","->",307],["T_STRING","setAbsolute",307],"(",")",["T_OBJECT_OPERATOR","->",307],["T_STRING","toString",307],"(",")",")",["T_WHITESPACE"," ",307],".",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'\"'",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$response",307],")",";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n\n    ",308],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","provisionEntityResource",311],"(",")",";",["T_WHITESPACE","\n    ",311],["T_COMMENT","\/\/ Simulate the developer again forgetting the ?_format query string.\n",312],["T_WHITESPACE","    ",313],["T_VARIABLE","$url",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","setOption",313],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",313],",",["T_WHITESPACE"," ",313],"[","]",")",";",["T_WHITESPACE","\n\n\n\n    ",313],["T_COMMENT","\/\/ DX: 406 when ?_format is missing, except when requesting a canonical HTML\n",317],["T_WHITESPACE","    ",318],["T_COMMENT","\/\/ route.\n",318],["T_WHITESPACE","    ",319],["T_VARIABLE","$response",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","request",319],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$url",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$request_options",319],")",";",["T_WHITESPACE","\n    ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_VARIABLE","$has_canonical_url",320],["T_WHITESPACE"," ",320],["T_BOOLEAN_AND","&&",320],["T_WHITESPACE"," ",320],"(","!",["T_STATIC","static",320],["T_DOUBLE_COLON","::",320],["T_VARIABLE","$auth",320],["T_WHITESPACE"," ",320],["T_BOOLEAN_OR","||",320],["T_WHITESPACE"," ",320],["T_STATIC","static",320],["T_DOUBLE_COLON","::",320],["T_VARIABLE","$auth",320],["T_WHITESPACE"," ",320],["T_IS_IDENTICAL","===",320],["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'cookie'",320],")",")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n      ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","assertSame",321],"(",["T_LNUMBER","403",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$response",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getStatusCode",321],"(",")",")",";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n    ",322],["T_ELSE","else",323],["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n      ",323],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","assert406Response",324],"(",["T_VARIABLE","$response",324],")",";",["T_WHITESPACE","\n    ",324],"}",["T_WHITESPACE","\n\n\n    ",325],["T_VARIABLE","$url",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","setOption",328],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",328],",",["T_WHITESPACE"," ",328],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",328],["T_WHITESPACE"," ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],["T_STATIC","static",328],["T_DOUBLE_COLON","::",328],["T_VARIABLE","$format",328],"]",")",";",["T_WHITESPACE","\n\n\n    ",328],["T_COMMENT","\/\/ DX: forgetting authentication: authentication provider-specific error\n",331],["T_WHITESPACE","    ",332],["T_COMMENT","\/\/ response.\n",332],["T_WHITESPACE","    ",333],["T_IF","if",333],["T_WHITESPACE"," ",333],"(",["T_STATIC","static",333],["T_DOUBLE_COLON","::",333],["T_VARIABLE","$auth",333],")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n      ",333],["T_VARIABLE","$response",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","request",334],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$url",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$request_options",334],")",";",["T_WHITESPACE","\n      ",334],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","assertResponseWhenMissingAuthentication",335],"(",["T_VARIABLE","$response",335],")",";",["T_WHITESPACE","\n    ",335],"}",["T_WHITESPACE","\n\n    ",336],["T_VARIABLE","$request_options",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_STRING","NestedArray",338],["T_DOUBLE_COLON","::",338],["T_STRING","mergeDeep",338],"(",["T_VARIABLE","$request_options",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getAuthenticationRequestOptions",338],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",338],")",")",";",["T_WHITESPACE","\n\n\n    ",338],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",341],["T_WHITESPACE","    ",342],["T_VARIABLE","$response",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","request",342],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$url",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$request_options",342],")",";",["T_WHITESPACE","\n    ",342],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",343],["T_WHITESPACE","    ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","assertResourceErrorResponse",344],"(",["T_LNUMBER","403",344],",",["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","''",344],",",["T_WHITESPACE"," ",344],["T_VARIABLE","$response",344],")",";",["T_WHITESPACE","\n\n\n    ",344],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","setUpAuthorization",347],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",347],")",";",["T_WHITESPACE","\n\n\n    ",347],["T_COMMENT","\/\/ 200 for well-formed HEAD request.\n",350],["T_WHITESPACE","    ",351],["T_VARIABLE","$response",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","request",351],"(",["T_CONSTANT_ENCAPSED_STRING","'HEAD'",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$url",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$request_options",351],")",";",["T_WHITESPACE","\n    ",351],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","assertResourceResponse",352],"(",["T_LNUMBER","200",352],",",["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","''",352],",",["T_WHITESPACE"," ",352],["T_VARIABLE","$response",352],")",";",["T_WHITESPACE","\n    ",352],["T_IF","if",353],["T_WHITESPACE"," ",353],"(","!",["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","account",353],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n      ",353],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","assertSame",354],"(","[",["T_CONSTANT_ENCAPSED_STRING","'MISS'",354],"]",",",["T_WHITESPACE"," ",354],["T_VARIABLE","$response",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getHeader",354],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",354],")",")",";",["T_WHITESPACE","\n    ",354],"}",["T_WHITESPACE","\n    ",355],["T_ELSE","else",356],["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n      ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","assertFalse",357],"(",["T_VARIABLE","$response",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","hasHeader",357],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",357],")",")",";",["T_WHITESPACE","\n    ",357],"}",["T_WHITESPACE","\n    ",358],["T_VARIABLE","$head_headers",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$response",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getHeaders",359],"(",")",";",["T_WHITESPACE","\n\n    ",359],["T_COMMENT","\/\/ 200 for well-formed GET request. Page Cache hit because of HEAD request.\n",361],["T_WHITESPACE","    ",362],["T_VARIABLE","$response",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","request",362],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$url",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$request_options",362],")",";",["T_WHITESPACE","\n    ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","assertResourceResponse",363],"(",["T_LNUMBER","200",363],",",["T_WHITESPACE"," ",363],["T_STRING","FALSE",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$response",363],")",";",["T_WHITESPACE","\n    ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(","!",["T_STATIC","static",364],["T_DOUBLE_COLON","::",364],["T_VARIABLE","$auth",364],")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n      ",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","assertSame",365],"(","[",["T_CONSTANT_ENCAPSED_STRING","'HIT'",365],"]",",",["T_WHITESPACE"," ",365],["T_VARIABLE","$response",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getHeader",365],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",365],")",")",";",["T_WHITESPACE","\n    ",365],"}",["T_WHITESPACE","\n    ",366],["T_ELSE","else",367],["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n      ",367],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","assertFalse",368],"(",["T_VARIABLE","$response",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","hasHeader",368],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",368],")",")",";",["T_WHITESPACE","\n    ",368],"}",["T_WHITESPACE","\n    ",369],["T_VARIABLE","$cache_tags_header_value",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],["T_VARIABLE","$response",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getHeader",370],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache-Tags'",370],")","[",["T_LNUMBER","0",370],"]",";",["T_WHITESPACE","\n    ",370],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","assertEquals",371],"(",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","getExpectedCacheTags",371],"(",")",",",["T_WHITESPACE"," ",371],["T_EMPTY","empty",371],"(",["T_VARIABLE","$cache_tags_header_value",371],")",["T_WHITESPACE"," ",371],"?",["T_WHITESPACE"," ",371],"[","]",["T_WHITESPACE"," ",371],":",["T_WHITESPACE"," ",371],["T_STRING","explode",371],"(",["T_CONSTANT_ENCAPSED_STRING","' '",371],",",["T_WHITESPACE"," ",371],["T_VARIABLE","$cache_tags_header_value",371],")",")",";",["T_WHITESPACE","\n    ",371],["T_VARIABLE","$cache_contexts_header_value",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$response",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","getHeader",372],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache-Contexts'",372],")","[",["T_LNUMBER","0",372],"]",";",["T_WHITESPACE","\n    ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","assertEquals",373],"(",["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getExpectedCacheContexts",373],"(",")",",",["T_WHITESPACE"," ",373],["T_EMPTY","empty",373],"(",["T_VARIABLE","$cache_contexts_header_value",373],")",["T_WHITESPACE"," ",373],"?",["T_WHITESPACE"," ",373],"[","]",["T_WHITESPACE"," ",373],":",["T_WHITESPACE"," ",373],["T_STRING","explode",373],"(",["T_CONSTANT_ENCAPSED_STRING","' '",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$cache_contexts_header_value",373],")",")",";",["T_WHITESPACE","\n    ",373],["T_COMMENT","\/\/ Comparing the exact serialization is pointless, because the order of\n",374],["T_WHITESPACE","    ",375],["T_COMMENT","\/\/ fields does not matter (at least not yet). That's why we only compare the\n",375],["T_WHITESPACE","    ",376],["T_COMMENT","\/\/ normalized entity with the decoded response: it's comparing PHP arrays\n",376],["T_WHITESPACE","    ",377],["T_COMMENT","\/\/ instead of strings.\n",377],["T_WHITESPACE","    ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","assertEquals",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getExpectedNormalizedEntity",378],"(",")",",",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","serializer",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","decode",378],"(",["T_STRING_CAST","(string)",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$response",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getBody",378],"(",")",",",["T_WHITESPACE"," ",378],["T_STATIC","static",378],["T_DOUBLE_COLON","::",378],["T_VARIABLE","$format",378],")",")",";",["T_WHITESPACE","\n    ",378],["T_COMMENT","\/\/ Not only assert the normalization, also assert deserialization of the\n",379],["T_WHITESPACE","    ",380],["T_COMMENT","\/\/ response results in the expected object.\n",380],["T_WHITESPACE","    ",381],["T_VARIABLE","$unserialized",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","serializer",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","deserialize",381],"(",["T_STRING_CAST","(string)",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$response",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getBody",381],"(",")",",",["T_WHITESPACE"," ",381],["T_STRING","get_class",381],"(",["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","entity",381],")",",",["T_WHITESPACE"," ",381],["T_STATIC","static",381],["T_DOUBLE_COLON","::",381],["T_VARIABLE","$format",381],")",";",["T_WHITESPACE","\n    ",381],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","assertSame",382],"(",["T_VARIABLE","$unserialized",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","uuid",382],"(",")",",",["T_WHITESPACE"," ",382],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","entity",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","uuid",382],"(",")",")",";",["T_WHITESPACE","\n    ",382],["T_VARIABLE","$get_headers",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$response",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","getHeaders",383],"(",")",";",["T_WHITESPACE","\n\n    ",383],["T_COMMENT","\/\/ Verify that the GET and HEAD responses are the same. The only difference\n",385],["T_WHITESPACE","    ",386],["T_COMMENT","\/\/ is that there's no body. For this reason the 'Transfer-Encoding' header\n",386],["T_WHITESPACE","    ",387],["T_COMMENT","\/\/ is also added to the list of headers to ignore, as this could be added to\n",387],["T_WHITESPACE","    ",388],["T_COMMENT","\/\/ GET requests - depending on web server configuration. This would usually\n",388],["T_WHITESPACE","    ",389],["T_COMMENT","\/\/ be 'Transfer-Encoding: chunked'.\n",389],["T_WHITESPACE","    ",390],["T_VARIABLE","$ignored_headers",390],["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],"[",["T_CONSTANT_ENCAPSED_STRING","'Date'",390],",",["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'Content-Length'",390],",",["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",390],",",["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Dynamic-Cache'",390],",",["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'Transfer-Encoding'",390],"]",";",["T_WHITESPACE","\n    ",390],["T_FOREACH","foreach",391],["T_WHITESPACE"," ",391],"(",["T_VARIABLE","$ignored_headers",391],["T_WHITESPACE"," ",391],["T_AS","as",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$ignored_header",391],")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n      ",391],["T_UNSET","unset",392],"(",["T_VARIABLE","$head_headers",392],"[",["T_VARIABLE","$ignored_header",392],"]",")",";",["T_WHITESPACE","\n      ",392],["T_UNSET","unset",393],"(",["T_VARIABLE","$get_headers",393],"[",["T_VARIABLE","$ignored_header",393],"]",")",";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n    ",394],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","assertSame",395],"(",["T_VARIABLE","$get_headers",395],",",["T_WHITESPACE"," ",395],["T_VARIABLE","$head_headers",395],")",";",["T_WHITESPACE","\n\n\n    ",395],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","config",398],"(",["T_CONSTANT_ENCAPSED_STRING","'rest.settings'",398],")",["T_OBJECT_OPERATOR","->",398],["T_STRING","set",398],"(",["T_CONSTANT_ENCAPSED_STRING","'bc_entity_resource_permissions'",398],",",["T_WHITESPACE"," ",398],["T_STRING","TRUE",398],")",["T_OBJECT_OPERATOR","->",398],["T_STRING","save",398],"(",["T_STRING","TRUE",398],")",";",["T_WHITESPACE","\n    ",398],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2815845.\n",399],["T_WHITESPACE","    ",400],["T_STRING","drupal_flush_all_caches",400],"(",")",";",["T_WHITESPACE","\n\n\n    ",400],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",403],["T_WHITESPACE","    ",404],["T_VARIABLE","$response",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","request",404],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$url",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$request_options",404],")",";",["T_WHITESPACE","\n    ",404],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",405],["T_WHITESPACE","    ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","assertResourceErrorResponse",406],"(",["T_LNUMBER","403",406],",",["T_WHITESPACE"," ",406],["T_CONSTANT_ENCAPSED_STRING","''",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$response",406],")",";",["T_WHITESPACE","\n\n\n    ",406],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","grantPermissionsToTestedRole",409],"(","[",["T_CONSTANT_ENCAPSED_STRING","'restful get entity:'",409],["T_WHITESPACE"," ",409],".",["T_WHITESPACE"," ",409],["T_STATIC","static",409],["T_DOUBLE_COLON","::",409],["T_VARIABLE","$entityTypeId",409],"]",")",";",["T_WHITESPACE","\n\n\n    ",409],["T_COMMENT","\/\/ 200 for well-formed request.\n",412],["T_WHITESPACE","    ",413],["T_VARIABLE","$response",413],["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","request",413],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",413],",",["T_WHITESPACE"," ",413],["T_VARIABLE","$url",413],",",["T_WHITESPACE"," ",413],["T_VARIABLE","$request_options",413],")",";",["T_WHITESPACE","\n    ",413],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","assertResourceResponse",414],"(",["T_LNUMBER","200",414],",",["T_WHITESPACE"," ",414],["T_STRING","FALSE",414],",",["T_WHITESPACE"," ",414],["T_VARIABLE","$response",414],")",";",["T_WHITESPACE","\n\n\n    ",414],["T_VARIABLE","$url",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","setOption",417],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",417],",",["T_WHITESPACE"," ",417],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",417],["T_WHITESPACE"," ",417],["T_DOUBLE_ARROW","=>",417],["T_WHITESPACE"," ",417],["T_CONSTANT_ENCAPSED_STRING","'non_existing_format'",417],"]",")",";",["T_WHITESPACE","\n\n\n    ",417],["T_COMMENT","\/\/ DX: 406 when requesting unsupported format.\n",420],["T_WHITESPACE","    ",421],["T_VARIABLE","$response",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","request",421],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$url",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$request_options",421],")",";",["T_WHITESPACE","\n    ",421],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","assert406Response",422],"(",["T_VARIABLE","$response",422],")",";",["T_WHITESPACE","\n    ",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","assertNotSame",423],"(","[",["T_STATIC","static",423],["T_DOUBLE_COLON","::",423],["T_VARIABLE","$expectedErrorMimeType",423],"]",",",["T_WHITESPACE"," ",423],["T_VARIABLE","$response",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","getHeader",423],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",423],")",")",";",["T_WHITESPACE","\n\n\n    ",423],["T_VARIABLE","$request_options",426],"[",["T_STRING","RequestOptions",426],["T_DOUBLE_COLON","::",426],["T_STRING","HEADERS",426],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Accept'",426],"]",["T_WHITESPACE"," ",426],"=",["T_WHITESPACE"," ",426],["T_STATIC","static",426],["T_DOUBLE_COLON","::",426],["T_VARIABLE","$mimeType",426],";",["T_WHITESPACE","\n\n\n    ",426],["T_COMMENT","\/\/ DX: 406 when requesting unsupported format but specifying Accept header.\n",429],["T_WHITESPACE","    ",430],["T_COMMENT","\/\/ @todo Update in https:\/\/www.drupal.org\/node\/2825347.\n",430],["T_WHITESPACE","    ",431],["T_VARIABLE","$response",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","request",431],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",431],",",["T_WHITESPACE"," ",431],["T_VARIABLE","$url",431],",",["T_WHITESPACE"," ",431],["T_VARIABLE","$request_options",431],")",";",["T_WHITESPACE","\n    ",431],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","assert406Response",432],"(",["T_VARIABLE","$response",432],")",";",["T_WHITESPACE","\n    ",432],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","assertSame",433],"(","[",["T_STATIC","static",433],["T_DOUBLE_COLON","::",433],["T_VARIABLE","$expectedErrorMimeType",433],"]",",",["T_WHITESPACE"," ",433],["T_VARIABLE","$response",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","getHeader",433],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",433],")",")",";",["T_WHITESPACE","\n\n\n    ",433],["T_VARIABLE","$url",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_STRING","Url",436],["T_DOUBLE_COLON","::",436],["T_STRING","fromRoute",436],"(",["T_CONSTANT_ENCAPSED_STRING","'rest.entity.'",436],["T_WHITESPACE"," ",436],".",["T_WHITESPACE"," ",436],["T_STATIC","static",436],["T_DOUBLE_COLON","::",436],["T_VARIABLE","$entityTypeId",436],["T_WHITESPACE"," ",436],".",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","'.GET.'",436],["T_WHITESPACE"," ",436],".",["T_WHITESPACE"," ",436],["T_STATIC","static",436],["T_DOUBLE_COLON","::",436],["T_VARIABLE","$format",436],")",";",["T_WHITESPACE","\n    ",436],["T_VARIABLE","$url",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","setRouteParameter",437],"(",["T_STATIC","static",437],["T_DOUBLE_COLON","::",437],["T_VARIABLE","$entityTypeId",437],",",["T_WHITESPACE"," ",437],["T_LNUMBER","987654321",437],")",";",["T_WHITESPACE","\n    ",437],["T_VARIABLE","$url",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","setOption",438],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",438],",",["T_WHITESPACE"," ",438],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",438],["T_WHITESPACE"," ",438],["T_DOUBLE_ARROW","=>",438],["T_WHITESPACE"," ",438],["T_STATIC","static",438],["T_DOUBLE_COLON","::",438],["T_VARIABLE","$format",438],"]",")",";",["T_WHITESPACE","\n\n\n    ",438],["T_COMMENT","\/\/ DX: 404 when GETting non-existing entity.\n",441],["T_WHITESPACE","    ",442],["T_VARIABLE","$response",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","request",442],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$url",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$request_options",442],")",";",["T_WHITESPACE","\n    ",442],["T_VARIABLE","$path",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_STRING","str_replace",443],"(",["T_CONSTANT_ENCAPSED_STRING","'987654321'",443],",",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'{'",443],["T_WHITESPACE"," ",443],".",["T_WHITESPACE"," ",443],["T_STATIC","static",443],["T_DOUBLE_COLON","::",443],["T_VARIABLE","$entityTypeId",443],["T_WHITESPACE"," ",443],".",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'}'",443],",",["T_WHITESPACE"," ",443],["T_VARIABLE","$url",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","setAbsolute",443],"(",")",["T_OBJECT_OPERATOR","->",443],["T_STRING","setOptions",443],"(","[",["T_CONSTANT_ENCAPSED_STRING","'base_url'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","''",443],",",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'query'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],"[","]","]",")",["T_OBJECT_OPERATOR","->",443],["T_STRING","toString",443],"(",")",")",";",["T_WHITESPACE","\n    ",443],["T_VARIABLE","$message",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'The \"'",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_STATIC","static",444],["T_DOUBLE_COLON","::",444],["T_VARIABLE","$entityTypeId",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'\" parameter was not converted for the path \"'",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_VARIABLE","$path",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'\" (route name: \"rest.entity.'",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_STATIC","static",444],["T_DOUBLE_COLON","::",444],["T_VARIABLE","$entityTypeId",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'.GET.'",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_STATIC","static",444],["T_DOUBLE_COLON","::",444],["T_VARIABLE","$format",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'\")'",444],";",["T_WHITESPACE","\n    ",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","assertResourceErrorResponse",445],"(",["T_LNUMBER","404",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$message",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$response",445],")",";",["T_WHITESPACE","\n  ",445],"}",["T_WHITESPACE","\n\n  ",446],["T_DOC_COMMENT","\/**\n   * Tests a POST request for an entity, plus edge cases to ensure good DX.\n   *\/",448],["T_WHITESPACE","\n  ",450],["T_PUBLIC","public",451],["T_WHITESPACE"," ",451],["T_FUNCTION","function",451],["T_WHITESPACE"," ",451],["T_STRING","testPost",451],"(",")",["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n    ",451],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2300677.\n",452],["T_WHITESPACE","    ",453],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","entity",453],["T_WHITESPACE"," ",453],["T_INSTANCEOF","instanceof",453],["T_WHITESPACE"," ",453],["T_STRING","ConfigEntityInterface",453],")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n      ",453],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","assertTrue",454],"(",["T_STRING","TRUE",454],",",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'POSTing config entities is not yet supported.'",454],")",";",["T_WHITESPACE","\n      ",454],["T_RETURN","return",455],";",["T_WHITESPACE","\n    ",455],"}",["T_WHITESPACE","\n\n    ",456],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","initAuthentication",458],"(",")",";",["T_WHITESPACE","\n    ",458],["T_VARIABLE","$has_canonical_url",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","entity",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","hasLinkTemplate",459],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",459],")",";",["T_WHITESPACE","\n\n    ",459],["T_COMMENT","\/\/ Try with all of the following request bodies.\n",461],["T_WHITESPACE","    ",462],["T_VARIABLE","$unparseable_request_body",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_CONSTANT_ENCAPSED_STRING","'!{>}<'",462],";",["T_WHITESPACE","\n    ",462],["T_VARIABLE","$parseable_valid_request_body",463],["T_WHITESPACE","   ",463],"=",["T_WHITESPACE"," ",463],["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","serializer",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","encode",463],"(",["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","getNormalizedPostEntity",463],"(",")",",",["T_WHITESPACE"," ",463],["T_STATIC","static",463],["T_DOUBLE_COLON","::",463],["T_VARIABLE","$format",463],")",";",["T_WHITESPACE","\n    ",463],["T_VARIABLE","$parseable_valid_request_body_2",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","serializer",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","encode",464],"(",["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","getNormalizedPostEntity",464],"(",")",",",["T_WHITESPACE"," ",464],["T_STATIC","static",464],["T_DOUBLE_COLON","::",464],["T_VARIABLE","$format",464],")",";",["T_WHITESPACE","\n    ",464],["T_VARIABLE","$parseable_invalid_request_body",465],["T_WHITESPACE","   ",465],"=",["T_WHITESPACE"," ",465],["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","serializer",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","encode",465],"(",["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","makeNormalizationInvalid",465],"(",["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","getNormalizedPostEntity",465],"(",")",")",",",["T_WHITESPACE"," ",465],["T_STATIC","static",465],["T_DOUBLE_COLON","::",465],["T_VARIABLE","$format",465],")",";",["T_WHITESPACE","\n    ",465],["T_COMMENT","\/\/ @todo Change to ['uuid' => UUID] in https:\/\/www.drupal.org\/node\/2820743.\n",466],["T_WHITESPACE","    ",467],["T_VARIABLE","$parseable_invalid_request_body_2",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","serializer",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","encode",467],"(",["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","getNormalizedPostEntity",467],"(",")",["T_WHITESPACE"," ",467],"+",["T_WHITESPACE"," ",467],"[",["T_CONSTANT_ENCAPSED_STRING","'uuid'",467],["T_WHITESPACE"," ",467],["T_DOUBLE_ARROW","=>",467],["T_WHITESPACE"," ",467],"[","[",["T_CONSTANT_ENCAPSED_STRING","'value'",467],["T_WHITESPACE"," ",467],["T_DOUBLE_ARROW","=>",467],["T_WHITESPACE"," ",467],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","randomMachineName",467],"(",["T_LNUMBER","129",467],")","]","]","]",",",["T_WHITESPACE"," ",467],["T_STATIC","static",467],["T_DOUBLE_COLON","::",467],["T_VARIABLE","$format",467],")",";",["T_WHITESPACE","\n    ",467],["T_VARIABLE","$parseable_invalid_request_body_3",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","serializer",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","encode",468],"(",["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","getNormalizedPostEntity",468],"(",")",["T_WHITESPACE"," ",468],"+",["T_WHITESPACE"," ",468],"[",["T_CONSTANT_ENCAPSED_STRING","'field_rest_test'",468],["T_WHITESPACE"," ",468],["T_DOUBLE_ARROW","=>",468],["T_WHITESPACE"," ",468],"[","[",["T_CONSTANT_ENCAPSED_STRING","'value'",468],["T_WHITESPACE"," ",468],["T_DOUBLE_ARROW","=>",468],["T_WHITESPACE"," ",468],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","randomString",468],"(",")","]","]","]",",",["T_WHITESPACE"," ",468],["T_STATIC","static",468],["T_DOUBLE_COLON","::",468],["T_VARIABLE","$format",468],")",";",["T_WHITESPACE","\n\n    ",468],["T_COMMENT","\/\/ The URL and Guzzle request options that will be used in this test. The\n",470],["T_WHITESPACE","    ",471],["T_COMMENT","\/\/ request options will be modified\/expanded throughout this test:\n",471],["T_WHITESPACE","    ",472],["T_COMMENT","\/\/ - to first test all mistakes a developer might make, and assert that the\n",472],["T_WHITESPACE","    ",473],["T_COMMENT","\/\/   error responses provide a good DX\n",473],["T_WHITESPACE","    ",474],["T_COMMENT","\/\/ - to eventually result in a well-formed request that succeeds.\n",474],["T_WHITESPACE","    ",475],["T_VARIABLE","$url",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_VARIABLE","$this",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","getPostUrl",475],"(",")",";",["T_WHITESPACE","\n    ",475],["T_VARIABLE","$request_options",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],"[","]",";",["T_WHITESPACE","\n\n\n    ",476],["T_COMMENT","\/\/ DX: 404 when resource not provisioned, but HTML if canonical route.\n",479],["T_WHITESPACE","    ",480],["T_VARIABLE","$response",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","request",480],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$url",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$request_options",480],")",";",["T_WHITESPACE","\n    ",480],["T_IF","if",481],["T_WHITESPACE"," ",481],"(",["T_VARIABLE","$has_canonical_url",481],")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n      ",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","assertSame",482],"(",["T_LNUMBER","404",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$response",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","getStatusCode",482],"(",")",")",";",["T_WHITESPACE","\n      ",482],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","assertSame",483],"(","[",["T_CONSTANT_ENCAPSED_STRING","'text\/html; charset=UTF-8'",483],"]",",",["T_WHITESPACE"," ",483],["T_VARIABLE","$response",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","getHeader",483],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",483],")",")",";",["T_WHITESPACE","\n    ",483],"}",["T_WHITESPACE","\n    ",484],["T_ELSE","else",485],["T_WHITESPACE"," ",485],"{",["T_WHITESPACE","\n      ",485],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","assertResourceErrorResponse",486],"(",["T_LNUMBER","404",486],",",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"GET '",486],["T_WHITESPACE"," ",486],".",["T_WHITESPACE"," ",486],["T_STRING","str_replace",486],"(",["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","baseUrl",486],",",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","''",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getUrl",486],"(",")",["T_OBJECT_OPERATOR","->",486],["T_STRING","setAbsolute",486],"(",")",["T_OBJECT_OPERATOR","->",486],["T_STRING","toString",486],"(",")",")",["T_WHITESPACE"," ",486],".",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'\"'",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$response",486],")",";",["T_WHITESPACE","\n    ",486],"}",["T_WHITESPACE","\n\n\n    ",487],["T_VARIABLE","$url",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","setOption",490],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",490],",",["T_WHITESPACE"," ",490],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",490],["T_WHITESPACE"," ",490],["T_DOUBLE_ARROW","=>",490],["T_WHITESPACE"," ",490],["T_STATIC","static",490],["T_DOUBLE_COLON","::",490],["T_VARIABLE","$format",490],"]",")",";",["T_WHITESPACE","\n\n\n    ",490],["T_COMMENT","\/\/ DX: 404 when resource not provisioned.\n",493],["T_WHITESPACE","    ",494],["T_VARIABLE","$response",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","request",494],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",494],",",["T_WHITESPACE"," ",494],["T_VARIABLE","$url",494],",",["T_WHITESPACE"," ",494],["T_VARIABLE","$request_options",494],")",";",["T_WHITESPACE","\n    ",494],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","assertResourceErrorResponse",495],"(",["T_LNUMBER","404",495],",",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"POST '",495],["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_STRING","str_replace",495],"(",["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","baseUrl",495],",",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","''",495],",",["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","getPostUrl",495],"(",")",["T_OBJECT_OPERATOR","->",495],["T_STRING","setAbsolute",495],"(",")",["T_OBJECT_OPERATOR","->",495],["T_STRING","toString",495],"(",")",")",["T_WHITESPACE"," ",495],".",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'\"'",495],",",["T_WHITESPACE"," ",495],["T_VARIABLE","$response",495],")",";",["T_WHITESPACE","\n\n\n    ",495],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","provisionEntityResource",498],"(",")",";",["T_WHITESPACE","\n    ",498],["T_COMMENT","\/\/ Simulate the developer again forgetting the ?_format query string.\n",499],["T_WHITESPACE","    ",500],["T_VARIABLE","$url",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","setOption",500],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",500],",",["T_WHITESPACE"," ",500],"[","]",")",";",["T_WHITESPACE","\n\n\n    ",500],["T_COMMENT","\/\/ DX: 415 when no Content-Type request header, but HTML if canonical route.\n",503],["T_WHITESPACE","    ",504],["T_VARIABLE","$response",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","request",504],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",504],",",["T_WHITESPACE"," ",504],["T_VARIABLE","$url",504],",",["T_WHITESPACE"," ",504],["T_VARIABLE","$request_options",504],")",";",["T_WHITESPACE","\n    ",504],["T_IF","if",505],["T_WHITESPACE"," ",505],"(",["T_VARIABLE","$has_canonical_url",505],")",["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n      ",505],["T_VARIABLE","$this",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","assertSame",506],"(",["T_LNUMBER","415",506],",",["T_WHITESPACE"," ",506],["T_VARIABLE","$response",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","getStatusCode",506],"(",")",")",";",["T_WHITESPACE","\n      ",506],["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","assertSame",507],"(","[",["T_CONSTANT_ENCAPSED_STRING","'text\/html; charset=UTF-8'",507],"]",",",["T_WHITESPACE"," ",507],["T_VARIABLE","$response",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","getHeader",507],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",507],")",")",";",["T_WHITESPACE","\n      ",507],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","assertContains",508],"(",["T_STRING","htmlspecialchars",508],"(",["T_CONSTANT_ENCAPSED_STRING","'No \"Content-Type\" request header specified'",508],")",",",["T_WHITESPACE"," ",508],["T_STRING_CAST","(string)",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$response",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","getBody",508],"(",")",")",";",["T_WHITESPACE","\n    ",508],"}",["T_WHITESPACE","\n    ",509],["T_ELSE","else",510],["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n      ",510],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","assertResourceErrorResponse",511],"(",["T_LNUMBER","415",511],",",["T_WHITESPACE"," ",511],["T_CONSTANT_ENCAPSED_STRING","'No \"Content-Type\" request header specified'",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$response",511],")",";",["T_WHITESPACE","\n    ",511],"}",["T_WHITESPACE","\n\n\n    ",512],["T_VARIABLE","$url",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","setOption",515],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",515],",",["T_WHITESPACE"," ",515],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",515],["T_WHITESPACE"," ",515],["T_DOUBLE_ARROW","=>",515],["T_WHITESPACE"," ",515],["T_STATIC","static",515],["T_DOUBLE_COLON","::",515],["T_VARIABLE","$format",515],"]",")",";",["T_WHITESPACE","\n\n\n    ",515],["T_COMMENT","\/\/ DX: 415 when no Content-Type request header.\n",518],["T_WHITESPACE","    ",519],["T_VARIABLE","$response",519],["T_WHITESPACE"," ",519],"=",["T_WHITESPACE"," ",519],["T_VARIABLE","$this",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","request",519],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",519],",",["T_WHITESPACE"," ",519],["T_VARIABLE","$url",519],",",["T_WHITESPACE"," ",519],["T_VARIABLE","$request_options",519],")",";",["T_WHITESPACE","\n    ",519],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","assertResourceErrorResponse",520],"(",["T_LNUMBER","415",520],",",["T_WHITESPACE"," ",520],["T_CONSTANT_ENCAPSED_STRING","'No \"Content-Type\" request header specified'",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$response",520],")",";",["T_WHITESPACE","\n\n\n    ",520],["T_VARIABLE","$request_options",523],"[",["T_STRING","RequestOptions",523],["T_DOUBLE_COLON","::",523],["T_STRING","HEADERS",523],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",523],"]",["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_STATIC","static",523],["T_DOUBLE_COLON","::",523],["T_VARIABLE","$mimeType",523],";",["T_WHITESPACE","\n\n\n    ",523],["T_COMMENT","\/\/ DX: 400 when no request body.\n",526],["T_WHITESPACE","    ",527],["T_VARIABLE","$response",527],["T_WHITESPACE"," ",527],"=",["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","request",527],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",527],",",["T_WHITESPACE"," ",527],["T_VARIABLE","$url",527],",",["T_WHITESPACE"," ",527],["T_VARIABLE","$request_options",527],")",";",["T_WHITESPACE","\n    ",527],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","assertResourceErrorResponse",528],"(",["T_LNUMBER","400",528],",",["T_WHITESPACE"," ",528],["T_CONSTANT_ENCAPSED_STRING","'No entity content received.'",528],",",["T_WHITESPACE"," ",528],["T_VARIABLE","$response",528],")",";",["T_WHITESPACE","\n\n\n    ",528],["T_VARIABLE","$request_options",531],"[",["T_STRING","RequestOptions",531],["T_DOUBLE_COLON","::",531],["T_STRING","BODY",531],"]",["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_VARIABLE","$unparseable_request_body",531],";",["T_WHITESPACE","\n\n\n    ",531],["T_COMMENT","\/\/ DX: 400 when unparseable request body.\n",534],["T_WHITESPACE","    ",535],["T_VARIABLE","$response",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","request",535],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",535],",",["T_WHITESPACE"," ",535],["T_VARIABLE","$url",535],",",["T_WHITESPACE"," ",535],["T_VARIABLE","$request_options",535],")",";",["T_WHITESPACE","\n    ",535],["T_COMMENT","\/\/ @todo Uncomment, remove next 3 in https:\/\/www.drupal.org\/node\/2813853.\n",536],["T_WHITESPACE","    ",537],["T_COMMENT","\/\/ $this->assertResourceErrorResponse(400, 'Syntax error', $response);\n",537],["T_WHITESPACE","    ",538],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","assertSame",538],"(",["T_LNUMBER","400",538],",",["T_WHITESPACE"," ",538],["T_VARIABLE","$response",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","getStatusCode",538],"(",")",")",";",["T_WHITESPACE","\n    ",538],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","assertSame",539],"(","[",["T_STATIC","static",539],["T_DOUBLE_COLON","::",539],["T_VARIABLE","$mimeType",539],"]",",",["T_WHITESPACE"," ",539],["T_VARIABLE","$response",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getHeader",539],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",539],")",")",";",["T_WHITESPACE","\n    ",539],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","assertSame",540],"(",["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","serializer",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","encode",540],"(","[",["T_CONSTANT_ENCAPSED_STRING","'error'",540],["T_WHITESPACE"," ",540],["T_DOUBLE_ARROW","=>",540],["T_WHITESPACE"," ",540],["T_CONSTANT_ENCAPSED_STRING","'Syntax error'",540],"]",",",["T_WHITESPACE"," ",540],["T_STATIC","static",540],["T_DOUBLE_COLON","::",540],["T_VARIABLE","$format",540],")",",",["T_WHITESPACE"," ",540],["T_STRING_CAST","(string)",540],["T_WHITESPACE"," ",540],["T_VARIABLE","$response",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","getBody",540],"(",")",")",";",["T_WHITESPACE","\n\n\n\n    ",540],["T_VARIABLE","$request_options",544],"[",["T_STRING","RequestOptions",544],["T_DOUBLE_COLON","::",544],["T_STRING","BODY",544],"]",["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_VARIABLE","$parseable_invalid_request_body",544],";",["T_WHITESPACE","\n\n\n    ",544],["T_IF","if",547],["T_WHITESPACE"," ",547],"(",["T_STATIC","static",547],["T_DOUBLE_COLON","::",547],["T_VARIABLE","$auth",547],")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n      ",547],["T_COMMENT","\/\/ DX: forgetting authentication: authentication provider-specific error\n",548],["T_WHITESPACE","      ",549],["T_COMMENT","\/\/ response.\n",549],["T_WHITESPACE","      ",550],["T_VARIABLE","$response",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","request",550],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",550],",",["T_WHITESPACE"," ",550],["T_VARIABLE","$url",550],",",["T_WHITESPACE"," ",550],["T_VARIABLE","$request_options",550],")",";",["T_WHITESPACE","\n      ",550],["T_VARIABLE","$this",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","assertResponseWhenMissingAuthentication",551],"(",["T_VARIABLE","$response",551],")",";",["T_WHITESPACE","\n    ",551],"}",["T_WHITESPACE","\n\n\n    ",552],["T_VARIABLE","$request_options",555],["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_STRING","NestedArray",555],["T_DOUBLE_COLON","::",555],["T_STRING","mergeDeep",555],"(",["T_VARIABLE","$request_options",555],",",["T_WHITESPACE"," ",555],["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","getAuthenticationRequestOptions",555],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",555],")",")",";",["T_WHITESPACE","\n\n\n    ",555],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",558],["T_WHITESPACE","    ",559],["T_VARIABLE","$response",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","request",559],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",559],",",["T_WHITESPACE"," ",559],["T_VARIABLE","$url",559],",",["T_WHITESPACE"," ",559],["T_VARIABLE","$request_options",559],")",";",["T_WHITESPACE","\n    ",559],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",560],["T_WHITESPACE","    ",561],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","assertResourceErrorResponse",561],"(",["T_LNUMBER","403",561],",",["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","''",561],",",["T_WHITESPACE"," ",561],["T_VARIABLE","$response",561],")",";",["T_WHITESPACE","\n\n\n    ",561],["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","setUpAuthorization",564],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",564],")",";",["T_WHITESPACE","\n\n\n    ",564],["T_COMMENT","\/\/ DX: 422 when invalid entity: multiple values sent for single-value field.\n",567],["T_WHITESPACE","    ",568],["T_VARIABLE","$response",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","request",568],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",568],",",["T_WHITESPACE"," ",568],["T_VARIABLE","$url",568],",",["T_WHITESPACE"," ",568],["T_VARIABLE","$request_options",568],")",";",["T_WHITESPACE","\n    ",568],["T_VARIABLE","$label_field",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","entity",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","getEntityType",569],"(",")",["T_OBJECT_OPERATOR","->",569],["T_STRING","hasKey",569],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",569],")",["T_WHITESPACE"," ",569],"?",["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","entity",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","getEntityType",569],"(",")",["T_OBJECT_OPERATOR","->",569],["T_STRING","getKey",569],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",569],")",["T_WHITESPACE"," ",569],":",["T_WHITESPACE"," ",569],["T_STATIC","static",569],["T_DOUBLE_COLON","::",569],["T_VARIABLE","$labelFieldName",569],";",["T_WHITESPACE","\n    ",569],["T_VARIABLE","$label_field_capitalized",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_STRING","ucfirst",570],"(",["T_VARIABLE","$label_field",570],")",";",["T_WHITESPACE","\n    ",570],["T_COMMENT","\/\/ @todo Uncomment, remove next 3 in https:\/\/www.drupal.org\/node\/2813755.\n",571],["T_WHITESPACE","    ",572],["T_COMMENT","\/\/ $this->assertErrorResponse(422, \"Unprocessable Entity: validation failed.\\ntitle: <em class=\\\"placeholder\\\">Title<\/em>: this field cannot hold more than 1 values.\\n\", $response);\n",572],["T_WHITESPACE","    ",573],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","assertSame",573],"(",["T_LNUMBER","422",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$response",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getStatusCode",573],"(",")",")",";",["T_WHITESPACE","\n    ",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","assertSame",574],"(","[",["T_STATIC","static",574],["T_DOUBLE_COLON","::",574],["T_VARIABLE","$mimeType",574],"]",",",["T_WHITESPACE"," ",574],["T_VARIABLE","$response",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","getHeader",574],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",574],")",")",";",["T_WHITESPACE","\n    ",574],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","assertSame",575],"(",["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","serializer",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","encode",575],"(","[",["T_CONSTANT_ENCAPSED_STRING","'message'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],"\"",["T_ENCAPSED_AND_WHITESPACE","Unprocessable Entity: validation failed.\\n",575],["T_VARIABLE","$label_field",575],["T_ENCAPSED_AND_WHITESPACE",": <em class=\\\"placeholder\\\">",575],["T_VARIABLE","$label_field_capitalized",575],["T_ENCAPSED_AND_WHITESPACE","<\/em>: this field cannot hold more than 1 values.\\n",575],"\"","]",",",["T_WHITESPACE"," ",575],["T_STATIC","static",575],["T_DOUBLE_COLON","::",575],["T_VARIABLE","$format",575],")",",",["T_WHITESPACE"," ",575],["T_STRING_CAST","(string)",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$response",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","getBody",575],"(",")",")",";",["T_WHITESPACE","\n\n\n    ",575],["T_VARIABLE","$request_options",578],"[",["T_STRING","RequestOptions",578],["T_DOUBLE_COLON","::",578],["T_STRING","BODY",578],"]",["T_WHITESPACE"," ",578],"=",["T_WHITESPACE"," ",578],["T_VARIABLE","$parseable_invalid_request_body_2",578],";",["T_WHITESPACE","\n\n\n    ",578],["T_COMMENT","\/\/ DX: 422 when invalid entity: UUID field too long.\n",581],["T_WHITESPACE","    ",582],["T_VARIABLE","$response",582],["T_WHITESPACE"," ",582],"=",["T_WHITESPACE"," ",582],["T_VARIABLE","$this",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","request",582],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",582],",",["T_WHITESPACE"," ",582],["T_VARIABLE","$url",582],",",["T_WHITESPACE"," ",582],["T_VARIABLE","$request_options",582],")",";",["T_WHITESPACE","\n    ",582],["T_COMMENT","\/\/ @todo Uncomment, remove next 3 in https:\/\/www.drupal.org\/node\/2813755.\n",583],["T_WHITESPACE","    ",584],["T_COMMENT","\/\/ $this->assertErrorResponse(422, \"Unprocessable Entity: validation failed.\\nuuid.0.value: <em class=\\\"placeholder\\\">UUID<\/em>: may not be longer than 128 characters.\\n\", $response);\n",584],["T_WHITESPACE","    ",585],["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","assertSame",585],"(",["T_LNUMBER","422",585],",",["T_WHITESPACE"," ",585],["T_VARIABLE","$response",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","getStatusCode",585],"(",")",")",";",["T_WHITESPACE","\n    ",585],["T_VARIABLE","$this",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","assertSame",586],"(","[",["T_STATIC","static",586],["T_DOUBLE_COLON","::",586],["T_VARIABLE","$mimeType",586],"]",",",["T_WHITESPACE"," ",586],["T_VARIABLE","$response",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","getHeader",586],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",586],")",")",";",["T_WHITESPACE","\n    ",586],["T_VARIABLE","$this",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","assertSame",587],"(",["T_VARIABLE","$this",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","serializer",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","encode",587],"(","[",["T_CONSTANT_ENCAPSED_STRING","'message'",587],["T_WHITESPACE"," ",587],["T_DOUBLE_ARROW","=>",587],["T_WHITESPACE"," ",587],["T_CONSTANT_ENCAPSED_STRING","\"Unprocessable Entity: validation failed.\\nuuid.0.value: <em class=\\\"placeholder\\\">UUID<\/em>: may not be longer than 128 characters.\\n\"",587],"]",",",["T_WHITESPACE"," ",587],["T_STATIC","static",587],["T_DOUBLE_COLON","::",587],["T_VARIABLE","$format",587],")",",",["T_WHITESPACE"," ",587],["T_STRING_CAST","(string)",587],["T_WHITESPACE"," ",587],["T_VARIABLE","$response",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","getBody",587],"(",")",")",";",["T_WHITESPACE","\n\n\n    ",587],["T_VARIABLE","$request_options",590],"[",["T_STRING","RequestOptions",590],["T_DOUBLE_COLON","::",590],["T_STRING","BODY",590],"]",["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_VARIABLE","$parseable_invalid_request_body_3",590],";",["T_WHITESPACE","\n\n\n    ",590],["T_COMMENT","\/\/ DX: 403 when entity contains field without 'edit' access.\n",593],["T_WHITESPACE","    ",594],["T_VARIABLE","$response",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","request",594],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",594],",",["T_WHITESPACE"," ",594],["T_VARIABLE","$url",594],",",["T_WHITESPACE"," ",594],["T_VARIABLE","$request_options",594],")",";",["T_WHITESPACE","\n    ",594],["T_COMMENT","\/\/ @todo Add trailing period in https:\/\/www.drupal.org\/node\/2821013.\n",595],["T_WHITESPACE","    ",596],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","assertResourceErrorResponse",596],"(",["T_LNUMBER","403",596],",",["T_WHITESPACE"," ",596],["T_CONSTANT_ENCAPSED_STRING","\"Access denied on creating field 'field_rest_test'\"",596],",",["T_WHITESPACE"," ",596],["T_VARIABLE","$response",596],")",";",["T_WHITESPACE","\n\n\n    ",596],["T_VARIABLE","$request_options",599],"[",["T_STRING","RequestOptions",599],["T_DOUBLE_COLON","::",599],["T_STRING","BODY",599],"]",["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_VARIABLE","$parseable_valid_request_body",599],";",["T_WHITESPACE","\n\n\n    ",599],["T_COMMENT","\/\/ Before sending a well-formed request, allow the normalization and\n",602],["T_WHITESPACE","    ",603],["T_COMMENT","\/\/ authentication provider edge cases to also be tested.\n",603],["T_WHITESPACE","    ",604],["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","assertNormalizationEdgeCases",604],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",604],",",["T_WHITESPACE"," ",604],["T_VARIABLE","$url",604],",",["T_WHITESPACE"," ",604],["T_VARIABLE","$request_options",604],")",";",["T_WHITESPACE","\n    ",604],["T_VARIABLE","$this",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","assertAuthenticationEdgeCases",605],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$url",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$request_options",605],")",";",["T_WHITESPACE","\n\n\n    ",605],["T_VARIABLE","$request_options",608],"[",["T_STRING","RequestOptions",608],["T_DOUBLE_COLON","::",608],["T_STRING","HEADERS",608],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",608],"]",["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",608],";",["T_WHITESPACE","\n\n\n    ",608],["T_COMMENT","\/\/ DX: 415 when request body in existing but not allowed format.\n",611],["T_WHITESPACE","    ",612],["T_VARIABLE","$response",612],["T_WHITESPACE"," ",612],"=",["T_WHITESPACE"," ",612],["T_VARIABLE","$this",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","request",612],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$url",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$request_options",612],")",";",["T_WHITESPACE","\n    ",612],["T_COMMENT","\/\/ @todo Update this in https:\/\/www.drupal.org\/node\/2826407. Also move it\n",613],["T_WHITESPACE","    ",614],["T_COMMENT","\/\/ higher, before the \"no request body\" test. That's impossible right now,\n",614],["T_WHITESPACE","    ",615],["T_COMMENT","\/\/ because the format validation happens too late.\n",615],["T_WHITESPACE","    ",616],["T_VARIABLE","$this",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","assertResourceErrorResponse",616],"(",["T_LNUMBER","415",616],",",["T_WHITESPACE"," ",616],["T_CONSTANT_ENCAPSED_STRING","''",616],",",["T_WHITESPACE"," ",616],["T_VARIABLE","$response",616],")",";",["T_WHITESPACE","\n\n\n    ",616],["T_VARIABLE","$request_options",619],"[",["T_STRING","RequestOptions",619],["T_DOUBLE_COLON","::",619],["T_STRING","HEADERS",619],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",619],"]",["T_WHITESPACE"," ",619],"=",["T_WHITESPACE"," ",619],["T_STATIC","static",619],["T_DOUBLE_COLON","::",619],["T_VARIABLE","$mimeType",619],";",["T_WHITESPACE","\n\n\n    ",619],["T_COMMENT","\/\/ 201 for well-formed request.\n",622],["T_WHITESPACE","    ",623],["T_VARIABLE","$response",623],["T_WHITESPACE"," ",623],"=",["T_WHITESPACE"," ",623],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","request",623],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",623],",",["T_WHITESPACE"," ",623],["T_VARIABLE","$url",623],",",["T_WHITESPACE"," ",623],["T_VARIABLE","$request_options",623],")",";",["T_WHITESPACE","\n    ",623],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","assertResourceResponse",624],"(",["T_LNUMBER","201",624],",",["T_WHITESPACE"," ",624],["T_STRING","FALSE",624],",",["T_WHITESPACE"," ",624],["T_VARIABLE","$response",624],")",";",["T_WHITESPACE","\n    ",624],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","assertSame",625],"(","[",["T_STRING","str_replace",625],"(",["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","entity",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","id",625],"(",")",",",["T_WHITESPACE"," ",625],["T_STATIC","static",625],["T_DOUBLE_COLON","::",625],["T_VARIABLE","$firstCreatedEntityId",625],",",["T_WHITESPACE"," ",625],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","entity",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","toUrl",625],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",625],")",["T_OBJECT_OPERATOR","->",625],["T_STRING","setAbsolute",625],"(",["T_STRING","TRUE",625],")",["T_OBJECT_OPERATOR","->",625],["T_STRING","toString",625],"(",")",")","]",",",["T_WHITESPACE"," ",625],["T_VARIABLE","$response",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","getHeader",625],"(",["T_CONSTANT_ENCAPSED_STRING","'Location'",625],")",")",";",["T_WHITESPACE","\n    ",625],["T_VARIABLE","$this",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","assertFalse",626],"(",["T_VARIABLE","$response",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","hasHeader",626],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",626],")",")",";",["T_WHITESPACE","\n\n\n    ",626],["T_VARIABLE","$this",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","config",629],"(",["T_CONSTANT_ENCAPSED_STRING","'rest.settings'",629],")",["T_OBJECT_OPERATOR","->",629],["T_STRING","set",629],"(",["T_CONSTANT_ENCAPSED_STRING","'bc_entity_resource_permissions'",629],",",["T_WHITESPACE"," ",629],["T_STRING","TRUE",629],")",["T_OBJECT_OPERATOR","->",629],["T_STRING","save",629],"(",["T_STRING","TRUE",629],")",";",["T_WHITESPACE","\n    ",629],["T_VARIABLE","$request_options",630],"[",["T_STRING","RequestOptions",630],["T_DOUBLE_COLON","::",630],["T_STRING","BODY",630],"]",["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_VARIABLE","$parseable_valid_request_body_2",630],";",["T_WHITESPACE","\n    ",630],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2815845.\n",631],["T_WHITESPACE","    ",632],["T_STRING","drupal_flush_all_caches",632],"(",")",";",["T_WHITESPACE","\n\n\n    ",632],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",635],["T_WHITESPACE","    ",636],["T_VARIABLE","$response",636],["T_WHITESPACE"," ",636],"=",["T_WHITESPACE"," ",636],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","request",636],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",636],",",["T_WHITESPACE"," ",636],["T_VARIABLE","$url",636],",",["T_WHITESPACE"," ",636],["T_VARIABLE","$request_options",636],")",";",["T_WHITESPACE","\n    ",636],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",637],["T_WHITESPACE","    ",638],["T_VARIABLE","$this",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","assertResourceErrorResponse",638],"(",["T_LNUMBER","403",638],",",["T_WHITESPACE"," ",638],["T_CONSTANT_ENCAPSED_STRING","''",638],",",["T_WHITESPACE"," ",638],["T_VARIABLE","$response",638],")",";",["T_WHITESPACE","\n\n\n    ",638],["T_VARIABLE","$this",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","grantPermissionsToTestedRole",641],"(","[",["T_CONSTANT_ENCAPSED_STRING","'restful post entity:'",641],["T_WHITESPACE"," ",641],".",["T_WHITESPACE"," ",641],["T_STATIC","static",641],["T_DOUBLE_COLON","::",641],["T_VARIABLE","$entityTypeId",641],"]",")",";",["T_WHITESPACE","\n\n\n    ",641],["T_COMMENT","\/\/ 201 for well-formed request.\n",644],["T_WHITESPACE","    ",645],["T_VARIABLE","$response",645],["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","request",645],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$url",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$request_options",645],")",";",["T_WHITESPACE","\n    ",645],["T_VARIABLE","$this",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","assertResourceResponse",646],"(",["T_LNUMBER","201",646],",",["T_WHITESPACE"," ",646],["T_STRING","FALSE",646],",",["T_WHITESPACE"," ",646],["T_VARIABLE","$response",646],")",";",["T_WHITESPACE","\n    ",646],["T_VARIABLE","$this",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","assertSame",647],"(","[",["T_STRING","str_replace",647],"(",["T_VARIABLE","$this",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","entity",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","id",647],"(",")",",",["T_WHITESPACE"," ",647],["T_STATIC","static",647],["T_DOUBLE_COLON","::",647],["T_VARIABLE","$secondCreatedEntityId",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$this",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","entity",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","toUrl",647],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",647],")",["T_OBJECT_OPERATOR","->",647],["T_STRING","setAbsolute",647],"(",["T_STRING","TRUE",647],")",["T_OBJECT_OPERATOR","->",647],["T_STRING","toString",647],"(",")",")","]",",",["T_WHITESPACE"," ",647],["T_VARIABLE","$response",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","getHeader",647],"(",["T_CONSTANT_ENCAPSED_STRING","'Location'",647],")",")",";",["T_WHITESPACE","\n    ",647],["T_VARIABLE","$this",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","assertFalse",648],"(",["T_VARIABLE","$response",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","hasHeader",648],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",648],")",")",";",["T_WHITESPACE","\n  ",648],"}",["T_WHITESPACE","\n\n  ",649],["T_DOC_COMMENT","\/**\n   * Tests a PATCH request for an entity, plus edge cases to ensure good DX.\n   *\/",651],["T_WHITESPACE","\n  ",653],["T_PUBLIC","public",654],["T_WHITESPACE"," ",654],["T_FUNCTION","function",654],["T_WHITESPACE"," ",654],["T_STRING","testPatch",654],"(",")",["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n    ",654],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2300677.\n",655],["T_WHITESPACE","    ",656],["T_IF","if",656],["T_WHITESPACE"," ",656],"(",["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","entity",656],["T_WHITESPACE"," ",656],["T_INSTANCEOF","instanceof",656],["T_WHITESPACE"," ",656],["T_STRING","ConfigEntityInterface",656],")",["T_WHITESPACE"," ",656],"{",["T_WHITESPACE","\n      ",656],["T_VARIABLE","$this",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","assertTrue",657],"(",["T_STRING","TRUE",657],",",["T_WHITESPACE"," ",657],["T_CONSTANT_ENCAPSED_STRING","'PATCHing config entities is not yet supported.'",657],")",";",["T_WHITESPACE","\n      ",657],["T_RETURN","return",658],";",["T_WHITESPACE","\n    ",658],"}",["T_WHITESPACE","\n\n    ",659],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","initAuthentication",661],"(",")",";",["T_WHITESPACE","\n    ",661],["T_VARIABLE","$has_canonical_url",662],["T_WHITESPACE"," ",662],"=",["T_WHITESPACE"," ",662],["T_VARIABLE","$this",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","entity",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","hasLinkTemplate",662],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",662],")",";",["T_WHITESPACE","\n\n    ",662],["T_COMMENT","\/\/ Try with all of the following request bodies.\n",664],["T_WHITESPACE","    ",665],["T_VARIABLE","$unparseable_request_body",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","'!{>}<'",665],";",["T_WHITESPACE","\n    ",665],["T_VARIABLE","$parseable_valid_request_body",666],["T_WHITESPACE","   ",666],"=",["T_WHITESPACE"," ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","serializer",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","encode",666],"(",["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","getNormalizedPatchEntity",666],"(",")",",",["T_WHITESPACE"," ",666],["T_STATIC","static",666],["T_DOUBLE_COLON","::",666],["T_VARIABLE","$format",666],")",";",["T_WHITESPACE","\n    ",666],["T_VARIABLE","$parseable_valid_request_body_2",667],["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","serializer",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","encode",667],"(",["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","getNormalizedPatchEntity",667],"(",")",",",["T_WHITESPACE"," ",667],["T_STATIC","static",667],["T_DOUBLE_COLON","::",667],["T_VARIABLE","$format",667],")",";",["T_WHITESPACE","\n    ",667],["T_VARIABLE","$parseable_invalid_request_body",668],["T_WHITESPACE","   ",668],"=",["T_WHITESPACE"," ",668],["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","serializer",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","encode",668],"(",["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","makeNormalizationInvalid",668],"(",["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","getNormalizedPatchEntity",668],"(",")",")",",",["T_WHITESPACE"," ",668],["T_STATIC","static",668],["T_DOUBLE_COLON","::",668],["T_VARIABLE","$format",668],")",";",["T_WHITESPACE","\n    ",668],["T_VARIABLE","$parseable_invalid_request_body_2",669],["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","serializer",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","encode",669],"(",["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","getNormalizedPatchEntity",669],"(",")",["T_WHITESPACE"," ",669],"+",["T_WHITESPACE"," ",669],"[",["T_CONSTANT_ENCAPSED_STRING","'field_rest_test'",669],["T_WHITESPACE"," ",669],["T_DOUBLE_ARROW","=>",669],["T_WHITESPACE"," ",669],"[","[",["T_CONSTANT_ENCAPSED_STRING","'value'",669],["T_WHITESPACE"," ",669],["T_DOUBLE_ARROW","=>",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","randomString",669],"(",")","]","]","]",",",["T_WHITESPACE"," ",669],["T_STATIC","static",669],["T_DOUBLE_COLON","::",669],["T_VARIABLE","$format",669],")",";",["T_WHITESPACE","\n\n    ",669],["T_COMMENT","\/\/ The URL and Guzzle request options that will be used in this test. The\n",671],["T_WHITESPACE","    ",672],["T_COMMENT","\/\/ request options will be modified\/expanded throughout this test:\n",672],["T_WHITESPACE","    ",673],["T_COMMENT","\/\/ - to first test all mistakes a developer might make, and assert that the\n",673],["T_WHITESPACE","    ",674],["T_COMMENT","\/\/   error responses provide a good DX\n",674],["T_WHITESPACE","    ",675],["T_COMMENT","\/\/ - to eventually result in a well-formed request that succeeds.\n",675],["T_WHITESPACE","    ",676],["T_VARIABLE","$url",676],["T_WHITESPACE"," ",676],"=",["T_WHITESPACE"," ",676],["T_VARIABLE","$this",676],["T_OBJECT_OPERATOR","->",676],["T_STRING","getUrl",676],"(",")",";",["T_WHITESPACE","\n    ",676],["T_VARIABLE","$request_options",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],"[","]",";",["T_WHITESPACE","\n\n\n    ",677],["T_COMMENT","\/\/ DX: 405 when resource not provisioned, but HTML if canonical route.\n",680],["T_WHITESPACE","    ",681],["T_VARIABLE","$response",681],["T_WHITESPACE"," ",681],"=",["T_WHITESPACE"," ",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","request",681],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",681],",",["T_WHITESPACE"," ",681],["T_VARIABLE","$url",681],",",["T_WHITESPACE"," ",681],["T_VARIABLE","$request_options",681],")",";",["T_WHITESPACE","\n    ",681],["T_IF","if",682],["T_WHITESPACE"," ",682],"(",["T_VARIABLE","$has_canonical_url",682],")",["T_WHITESPACE"," ",682],"{",["T_WHITESPACE","\n      ",682],["T_VARIABLE","$this",683],["T_OBJECT_OPERATOR","->",683],["T_STRING","assertSame",683],"(",["T_LNUMBER","405",683],",",["T_WHITESPACE"," ",683],["T_VARIABLE","$response",683],["T_OBJECT_OPERATOR","->",683],["T_STRING","getStatusCode",683],"(",")",")",";",["T_WHITESPACE","\n      ",683],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","assertSame",684],"(","[",["T_CONSTANT_ENCAPSED_STRING","'text\/html; charset=UTF-8'",684],"]",",",["T_WHITESPACE"," ",684],["T_VARIABLE","$response",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","getHeader",684],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",684],")",")",";",["T_WHITESPACE","\n    ",684],"}",["T_WHITESPACE","\n    ",685],["T_ELSE","else",686],["T_WHITESPACE"," ",686],"{",["T_WHITESPACE","\n      ",686],["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","assertResourceErrorResponse",687],"(",["T_LNUMBER","404",687],",",["T_WHITESPACE"," ",687],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"PATCH '",687],["T_WHITESPACE"," ",687],".",["T_WHITESPACE"," ",687],["T_STRING","str_replace",687],"(",["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","baseUrl",687],",",["T_WHITESPACE"," ",687],["T_CONSTANT_ENCAPSED_STRING","''",687],",",["T_WHITESPACE"," ",687],["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","getUrl",687],"(",")",["T_OBJECT_OPERATOR","->",687],["T_STRING","setAbsolute",687],"(",")",["T_OBJECT_OPERATOR","->",687],["T_STRING","toString",687],"(",")",")",["T_WHITESPACE"," ",687],".",["T_WHITESPACE"," ",687],["T_CONSTANT_ENCAPSED_STRING","'\"'",687],",",["T_WHITESPACE"," ",687],["T_VARIABLE","$response",687],")",";",["T_WHITESPACE","\n    ",687],"}",["T_WHITESPACE","\n\n\n    ",688],["T_VARIABLE","$url",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","setOption",691],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",691],",",["T_WHITESPACE"," ",691],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_STATIC","static",691],["T_DOUBLE_COLON","::",691],["T_VARIABLE","$format",691],"]",")",";",["T_WHITESPACE","\n\n\n    ",691],["T_COMMENT","\/\/ DX: 405 when resource not provisioned.\n",694],["T_WHITESPACE","    ",695],["T_VARIABLE","$response",695],["T_WHITESPACE"," ",695],"=",["T_WHITESPACE"," ",695],["T_VARIABLE","$this",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","request",695],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",695],",",["T_WHITESPACE"," ",695],["T_VARIABLE","$url",695],",",["T_WHITESPACE"," ",695],["T_VARIABLE","$request_options",695],")",";",["T_WHITESPACE","\n    ",695],["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","assertResourceErrorResponse",696],"(",["T_LNUMBER","405",696],",",["T_WHITESPACE"," ",696],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"PATCH '",696],["T_WHITESPACE"," ",696],".",["T_WHITESPACE"," ",696],["T_STRING","str_replace",696],"(",["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","baseUrl",696],",",["T_WHITESPACE"," ",696],["T_CONSTANT_ENCAPSED_STRING","''",696],",",["T_WHITESPACE"," ",696],["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","getUrl",696],"(",")",["T_OBJECT_OPERATOR","->",696],["T_STRING","setAbsolute",696],"(",")",["T_OBJECT_OPERATOR","->",696],["T_STRING","toString",696],"(",")",")",["T_WHITESPACE"," ",696],".",["T_WHITESPACE"," ",696],["T_CONSTANT_ENCAPSED_STRING","'\": Method Not Allowed (Allow: GET, POST, HEAD)'",696],",",["T_WHITESPACE"," ",696],["T_VARIABLE","$response",696],")",";",["T_WHITESPACE","\n\n\n    ",696],["T_VARIABLE","$this",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","provisionEntityResource",699],"(",")",";",["T_WHITESPACE","\n    ",699],["T_COMMENT","\/\/ Simulate the developer again forgetting the ?_format query string.\n",700],["T_WHITESPACE","    ",701],["T_VARIABLE","$url",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","setOption",701],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",701],",",["T_WHITESPACE"," ",701],"[","]",")",";",["T_WHITESPACE","\n\n\n    ",701],["T_COMMENT","\/\/ DX: 415 when no Content-Type request header, but HTML if canonical route.\n",704],["T_WHITESPACE","    ",705],["T_VARIABLE","$response",705],["T_WHITESPACE"," ",705],"=",["T_WHITESPACE"," ",705],["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","request",705],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",705],",",["T_WHITESPACE"," ",705],["T_VARIABLE","$url",705],",",["T_WHITESPACE"," ",705],["T_VARIABLE","$request_options",705],")",";",["T_WHITESPACE","\n    ",705],["T_IF","if",706],["T_WHITESPACE"," ",706],"(",["T_VARIABLE","$has_canonical_url",706],")",["T_WHITESPACE"," ",706],"{",["T_WHITESPACE","\n      ",706],["T_VARIABLE","$this",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","assertSame",707],"(",["T_LNUMBER","415",707],",",["T_WHITESPACE"," ",707],["T_VARIABLE","$response",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","getStatusCode",707],"(",")",")",";",["T_WHITESPACE","\n      ",707],["T_VARIABLE","$this",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","assertSame",708],"(","[",["T_CONSTANT_ENCAPSED_STRING","'text\/html; charset=UTF-8'",708],"]",",",["T_WHITESPACE"," ",708],["T_VARIABLE","$response",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","getHeader",708],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",708],")",")",";",["T_WHITESPACE","\n      ",708],["T_VARIABLE","$this",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","assertTrue",709],"(",["T_STRING","FALSE",709],["T_WHITESPACE"," ",709],["T_IS_NOT_IDENTICAL","!==",709],["T_WHITESPACE"," ",709],["T_STRING","strpos",709],"(",["T_STRING_CAST","(string)",709],["T_WHITESPACE"," ",709],["T_VARIABLE","$response",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","getBody",709],"(",")",",",["T_WHITESPACE"," ",709],["T_STRING","htmlspecialchars",709],"(",["T_CONSTANT_ENCAPSED_STRING","'No \"Content-Type\" request header specified'",709],")",")",")",";",["T_WHITESPACE","\n    ",709],"}",["T_WHITESPACE","\n    ",710],["T_ELSE","else",711],["T_WHITESPACE"," ",711],"{",["T_WHITESPACE","\n      ",711],["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","assertResourceErrorResponse",712],"(",["T_LNUMBER","415",712],",",["T_WHITESPACE"," ",712],["T_CONSTANT_ENCAPSED_STRING","'No \"Content-Type\" request header specified'",712],",",["T_WHITESPACE"," ",712],["T_VARIABLE","$response",712],")",";",["T_WHITESPACE","\n    ",712],"}",["T_WHITESPACE","\n\n\n    ",713],["T_VARIABLE","$url",716],["T_OBJECT_OPERATOR","->",716],["T_STRING","setOption",716],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",716],",",["T_WHITESPACE"," ",716],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",716],["T_WHITESPACE"," ",716],["T_DOUBLE_ARROW","=>",716],["T_WHITESPACE"," ",716],["T_STATIC","static",716],["T_DOUBLE_COLON","::",716],["T_VARIABLE","$format",716],"]",")",";",["T_WHITESPACE","\n\n\n    ",716],["T_COMMENT","\/\/ DX: 415 when no Content-Type request header.\n",719],["T_WHITESPACE","    ",720],["T_VARIABLE","$response",720],["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$this",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","request",720],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",720],",",["T_WHITESPACE"," ",720],["T_VARIABLE","$url",720],",",["T_WHITESPACE"," ",720],["T_VARIABLE","$request_options",720],")",";",["T_WHITESPACE","\n    ",720],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","assertResourceErrorResponse",721],"(",["T_LNUMBER","415",721],",",["T_WHITESPACE"," ",721],["T_CONSTANT_ENCAPSED_STRING","'No \"Content-Type\" request header specified'",721],",",["T_WHITESPACE"," ",721],["T_VARIABLE","$response",721],")",";",["T_WHITESPACE","\n\n\n    ",721],["T_VARIABLE","$request_options",724],"[",["T_STRING","RequestOptions",724],["T_DOUBLE_COLON","::",724],["T_STRING","HEADERS",724],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",724],"]",["T_WHITESPACE"," ",724],"=",["T_WHITESPACE"," ",724],["T_STATIC","static",724],["T_DOUBLE_COLON","::",724],["T_VARIABLE","$mimeType",724],";",["T_WHITESPACE","\n\n\n    ",724],["T_COMMENT","\/\/ DX: 400 when no request body.\n",727],["T_WHITESPACE","    ",728],["T_VARIABLE","$response",728],["T_WHITESPACE"," ",728],"=",["T_WHITESPACE"," ",728],["T_VARIABLE","$this",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","request",728],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",728],",",["T_WHITESPACE"," ",728],["T_VARIABLE","$url",728],",",["T_WHITESPACE"," ",728],["T_VARIABLE","$request_options",728],")",";",["T_WHITESPACE","\n    ",728],["T_VARIABLE","$this",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","assertResourceErrorResponse",729],"(",["T_LNUMBER","400",729],",",["T_WHITESPACE"," ",729],["T_CONSTANT_ENCAPSED_STRING","'No entity content received.'",729],",",["T_WHITESPACE"," ",729],["T_VARIABLE","$response",729],")",";",["T_WHITESPACE","\n\n\n    ",729],["T_VARIABLE","$request_options",732],"[",["T_STRING","RequestOptions",732],["T_DOUBLE_COLON","::",732],["T_STRING","BODY",732],"]",["T_WHITESPACE"," ",732],"=",["T_WHITESPACE"," ",732],["T_VARIABLE","$unparseable_request_body",732],";",["T_WHITESPACE","\n\n\n    ",732],["T_COMMENT","\/\/ DX: 400 when unparseable request body.\n",735],["T_WHITESPACE","    ",736],["T_VARIABLE","$response",736],["T_WHITESPACE"," ",736],"=",["T_WHITESPACE"," ",736],["T_VARIABLE","$this",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","request",736],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",736],",",["T_WHITESPACE"," ",736],["T_VARIABLE","$url",736],",",["T_WHITESPACE"," ",736],["T_VARIABLE","$request_options",736],")",";",["T_WHITESPACE","\n    ",736],["T_COMMENT","\/\/ @todo Uncomment, remove next 3 in https:\/\/www.drupal.org\/node\/2813853.\n",737],["T_WHITESPACE","    ",738],["T_COMMENT","\/\/ $this->assertResourceErrorResponse(400, 'Syntax error', $response);\n",738],["T_WHITESPACE","    ",739],["T_VARIABLE","$this",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","assertSame",739],"(",["T_LNUMBER","400",739],",",["T_WHITESPACE"," ",739],["T_VARIABLE","$response",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","getStatusCode",739],"(",")",")",";",["T_WHITESPACE","\n    ",739],["T_VARIABLE","$this",740],["T_OBJECT_OPERATOR","->",740],["T_STRING","assertSame",740],"(","[",["T_STATIC","static",740],["T_DOUBLE_COLON","::",740],["T_VARIABLE","$mimeType",740],"]",",",["T_WHITESPACE"," ",740],["T_VARIABLE","$response",740],["T_OBJECT_OPERATOR","->",740],["T_STRING","getHeader",740],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",740],")",")",";",["T_WHITESPACE","\n    ",740],["T_VARIABLE","$this",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","assertSame",741],"(",["T_VARIABLE","$this",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","serializer",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","encode",741],"(","[",["T_CONSTANT_ENCAPSED_STRING","'error'",741],["T_WHITESPACE"," ",741],["T_DOUBLE_ARROW","=>",741],["T_WHITESPACE"," ",741],["T_CONSTANT_ENCAPSED_STRING","'Syntax error'",741],"]",",",["T_WHITESPACE"," ",741],["T_STATIC","static",741],["T_DOUBLE_COLON","::",741],["T_VARIABLE","$format",741],")",",",["T_WHITESPACE"," ",741],["T_STRING_CAST","(string)",741],["T_WHITESPACE"," ",741],["T_VARIABLE","$response",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","getBody",741],"(",")",")",";",["T_WHITESPACE","\n\n\n\n    ",741],["T_VARIABLE","$request_options",745],"[",["T_STRING","RequestOptions",745],["T_DOUBLE_COLON","::",745],["T_STRING","BODY",745],"]",["T_WHITESPACE"," ",745],"=",["T_WHITESPACE"," ",745],["T_VARIABLE","$parseable_invalid_request_body",745],";",["T_WHITESPACE","\n\n\n    ",745],["T_IF","if",748],["T_WHITESPACE"," ",748],"(",["T_STATIC","static",748],["T_DOUBLE_COLON","::",748],["T_VARIABLE","$auth",748],")",["T_WHITESPACE"," ",748],"{",["T_WHITESPACE","\n      ",748],["T_COMMENT","\/\/ DX: forgetting authentication: authentication provider-specific error\n",749],["T_WHITESPACE","      ",750],["T_COMMENT","\/\/ response.\n",750],["T_WHITESPACE","      ",751],["T_VARIABLE","$response",751],["T_WHITESPACE"," ",751],"=",["T_WHITESPACE"," ",751],["T_VARIABLE","$this",751],["T_OBJECT_OPERATOR","->",751],["T_STRING","request",751],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",751],",",["T_WHITESPACE"," ",751],["T_VARIABLE","$url",751],",",["T_WHITESPACE"," ",751],["T_VARIABLE","$request_options",751],")",";",["T_WHITESPACE","\n      ",751],["T_VARIABLE","$this",752],["T_OBJECT_OPERATOR","->",752],["T_STRING","assertResponseWhenMissingAuthentication",752],"(",["T_VARIABLE","$response",752],")",";",["T_WHITESPACE","\n    ",752],"}",["T_WHITESPACE","\n\n\n    ",753],["T_VARIABLE","$request_options",756],["T_WHITESPACE"," ",756],"=",["T_WHITESPACE"," ",756],["T_STRING","NestedArray",756],["T_DOUBLE_COLON","::",756],["T_STRING","mergeDeep",756],"(",["T_VARIABLE","$request_options",756],",",["T_WHITESPACE"," ",756],["T_VARIABLE","$this",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","getAuthenticationRequestOptions",756],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",756],")",")",";",["T_WHITESPACE","\n\n\n    ",756],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",759],["T_WHITESPACE","    ",760],["T_VARIABLE","$response",760],["T_WHITESPACE"," ",760],"=",["T_WHITESPACE"," ",760],["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","request",760],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",760],",",["T_WHITESPACE"," ",760],["T_VARIABLE","$url",760],",",["T_WHITESPACE"," ",760],["T_VARIABLE","$request_options",760],")",";",["T_WHITESPACE","\n    ",760],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",761],["T_WHITESPACE","    ",762],["T_VARIABLE","$this",762],["T_OBJECT_OPERATOR","->",762],["T_STRING","assertResourceErrorResponse",762],"(",["T_LNUMBER","403",762],",",["T_WHITESPACE"," ",762],["T_CONSTANT_ENCAPSED_STRING","''",762],",",["T_WHITESPACE"," ",762],["T_VARIABLE","$response",762],")",";",["T_WHITESPACE","\n\n\n    ",762],["T_VARIABLE","$this",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","setUpAuthorization",765],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",765],")",";",["T_WHITESPACE","\n\n\n    ",765],["T_COMMENT","\/\/ DX: 422 when invalid entity: multiple values sent for single-value field.\n",768],["T_WHITESPACE","    ",769],["T_VARIABLE","$response",769],["T_WHITESPACE"," ",769],"=",["T_WHITESPACE"," ",769],["T_VARIABLE","$this",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","request",769],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",769],",",["T_WHITESPACE"," ",769],["T_VARIABLE","$url",769],",",["T_WHITESPACE"," ",769],["T_VARIABLE","$request_options",769],")",";",["T_WHITESPACE","\n    ",769],["T_VARIABLE","$label_field",770],["T_WHITESPACE"," ",770],"=",["T_WHITESPACE"," ",770],["T_VARIABLE","$this",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","entity",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","getEntityType",770],"(",")",["T_OBJECT_OPERATOR","->",770],["T_STRING","hasKey",770],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",770],")",["T_WHITESPACE"," ",770],"?",["T_WHITESPACE"," ",770],["T_VARIABLE","$this",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","entity",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","getEntityType",770],"(",")",["T_OBJECT_OPERATOR","->",770],["T_STRING","getKey",770],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",770],")",["T_WHITESPACE"," ",770],":",["T_WHITESPACE"," ",770],["T_STATIC","static",770],["T_DOUBLE_COLON","::",770],["T_VARIABLE","$labelFieldName",770],";",["T_WHITESPACE","\n    ",770],["T_VARIABLE","$label_field_capitalized",771],["T_WHITESPACE"," ",771],"=",["T_WHITESPACE"," ",771],["T_STRING","ucfirst",771],"(",["T_VARIABLE","$label_field",771],")",";",["T_WHITESPACE","\n    ",771],["T_COMMENT","\/\/ @todo Uncomment, remove next 3 in https:\/\/www.drupal.org\/node\/2813755.\n",772],["T_WHITESPACE","    ",773],["T_COMMENT","\/\/ $this->assertErrorResponse(422, \"Unprocessable Entity: validation failed.\\ntitle: <em class=\\\"placeholder\\\">Title<\/em>: this field cannot hold more than 1 values.\\n\", $response);\n",773],["T_WHITESPACE","    ",774],["T_COMMENT","\/\/ $this->assertSame(422, $response->getStatusCode());\n",774],["T_WHITESPACE","    ",775],["T_COMMENT","\/\/ $this->assertSame([static::$mimeType], $response->getHeader('Content-Type'));\n",775],["T_WHITESPACE","    ",776],["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","assertSame",776],"(",["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","serializer",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","encode",776],"(","[",["T_CONSTANT_ENCAPSED_STRING","'message'",776],["T_WHITESPACE"," ",776],["T_DOUBLE_ARROW","=>",776],["T_WHITESPACE"," ",776],"\"",["T_ENCAPSED_AND_WHITESPACE","Unprocessable Entity: validation failed.\\n",776],["T_VARIABLE","$label_field",776],["T_ENCAPSED_AND_WHITESPACE",": <em class=\\\"placeholder\\\">",776],["T_VARIABLE","$label_field_capitalized",776],["T_ENCAPSED_AND_WHITESPACE","<\/em>: this field cannot hold more than 1 values.\\n",776],"\"","]",",",["T_WHITESPACE"," ",776],["T_STATIC","static",776],["T_DOUBLE_COLON","::",776],["T_VARIABLE","$format",776],")",",",["T_WHITESPACE"," ",776],["T_STRING_CAST","(string)",776],["T_WHITESPACE"," ",776],["T_VARIABLE","$response",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","getBody",776],"(",")",")",";",["T_WHITESPACE","\n\n\n    ",776],["T_VARIABLE","$request_options",779],"[",["T_STRING","RequestOptions",779],["T_DOUBLE_COLON","::",779],["T_STRING","BODY",779],"]",["T_WHITESPACE"," ",779],"=",["T_WHITESPACE"," ",779],["T_VARIABLE","$parseable_invalid_request_body_2",779],";",["T_WHITESPACE","\n\n\n    ",779],["T_COMMENT","\/\/ DX: 403 when entity contains field without 'edit' access.\n",782],["T_WHITESPACE","    ",783],["T_VARIABLE","$response",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","request",783],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",783],",",["T_WHITESPACE"," ",783],["T_VARIABLE","$url",783],",",["T_WHITESPACE"," ",783],["T_VARIABLE","$request_options",783],")",";",["T_WHITESPACE","\n    ",783],["T_VARIABLE","$this",784],["T_OBJECT_OPERATOR","->",784],["T_STRING","assertResourceErrorResponse",784],"(",["T_LNUMBER","403",784],",",["T_WHITESPACE"," ",784],["T_CONSTANT_ENCAPSED_STRING","\"Access denied on updating field 'field_rest_test'.\"",784],",",["T_WHITESPACE"," ",784],["T_VARIABLE","$response",784],")",";",["T_WHITESPACE","\n\n\n    ",784],["T_COMMENT","\/\/ DX: 403 when sending PATCH request with read-only fields.\n",787],["T_WHITESPACE","    ",788],["T_COMMENT","\/\/ First send all fields (the \"maximum normalization\"). Assert the expected\n",788],["T_WHITESPACE","    ",789],["T_COMMENT","\/\/ error message for the first PATCH-protected field. Remove that field from\n",789],["T_WHITESPACE","    ",790],["T_COMMENT","\/\/ the normalization, send another request, assert the next PATCH-protected\n",790],["T_WHITESPACE","    ",791],["T_COMMENT","\/\/ field error message. And so on.\n",791],["T_WHITESPACE","    ",792],["T_VARIABLE","$max_normalization",792],["T_WHITESPACE"," ",792],"=",["T_WHITESPACE"," ",792],["T_VARIABLE","$this",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","getNormalizedPatchEntity",792],"(",")",["T_WHITESPACE"," ",792],"+",["T_WHITESPACE"," ",792],["T_VARIABLE","$this",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","serializer",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","normalize",792],"(",["T_VARIABLE","$this",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","entity",792],",",["T_WHITESPACE"," ",792],["T_STATIC","static",792],["T_DOUBLE_COLON","::",792],["T_VARIABLE","$format",792],")",";",["T_WHITESPACE","\n    ",792],["T_FOR","for",793],["T_WHITESPACE"," ",793],"(",["T_VARIABLE","$i",793],["T_WHITESPACE"," ",793],"=",["T_WHITESPACE"," ",793],["T_LNUMBER","0",793],";",["T_WHITESPACE"," ",793],["T_VARIABLE","$i",793],["T_WHITESPACE"," ",793],"<",["T_WHITESPACE"," ",793],["T_STRING","count",793],"(",["T_STATIC","static",793],["T_DOUBLE_COLON","::",793],["T_VARIABLE","$patchProtectedFieldNames",793],")",";",["T_WHITESPACE"," ",793],["T_VARIABLE","$i",793],["T_INC","++",793],")",["T_WHITESPACE"," ",793],"{",["T_WHITESPACE","\n      ",793],["T_VARIABLE","$max_normalization",794],["T_WHITESPACE"," ",794],"=",["T_WHITESPACE"," ",794],["T_VARIABLE","$this",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","removeFieldsFromNormalization",794],"(",["T_VARIABLE","$max_normalization",794],",",["T_WHITESPACE"," ",794],["T_STRING","array_slice",794],"(",["T_STATIC","static",794],["T_DOUBLE_COLON","::",794],["T_VARIABLE","$patchProtectedFieldNames",794],",",["T_WHITESPACE"," ",794],["T_LNUMBER","0",794],",",["T_WHITESPACE"," ",794],["T_VARIABLE","$i",794],")",")",";",["T_WHITESPACE","\n      ",794],["T_VARIABLE","$request_options",795],"[",["T_STRING","RequestOptions",795],["T_DOUBLE_COLON","::",795],["T_STRING","BODY",795],"]",["T_WHITESPACE"," ",795],"=",["T_WHITESPACE"," ",795],["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","serializer",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","serialize",795],"(",["T_VARIABLE","$max_normalization",795],",",["T_WHITESPACE"," ",795],["T_STATIC","static",795],["T_DOUBLE_COLON","::",795],["T_VARIABLE","$format",795],")",";",["T_WHITESPACE","\n      ",795],["T_VARIABLE","$response",796],["T_WHITESPACE"," ",796],"=",["T_WHITESPACE"," ",796],["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","request",796],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",796],",",["T_WHITESPACE"," ",796],["T_VARIABLE","$url",796],",",["T_WHITESPACE"," ",796],["T_VARIABLE","$request_options",796],")",";",["T_WHITESPACE","\n      ",796],["T_VARIABLE","$this",797],["T_OBJECT_OPERATOR","->",797],["T_STRING","assertResourceErrorResponse",797],"(",["T_LNUMBER","403",797],",",["T_WHITESPACE"," ",797],["T_CONSTANT_ENCAPSED_STRING","\"Access denied on updating field '\"",797],["T_WHITESPACE"," ",797],".",["T_WHITESPACE"," ",797],["T_STATIC","static",797],["T_DOUBLE_COLON","::",797],["T_VARIABLE","$patchProtectedFieldNames",797],"[",["T_VARIABLE","$i",797],"]",["T_WHITESPACE"," ",797],".",["T_WHITESPACE"," ",797],["T_CONSTANT_ENCAPSED_STRING","\"'.\"",797],",",["T_WHITESPACE"," ",797],["T_VARIABLE","$response",797],")",";",["T_WHITESPACE","\n    ",797],"}",["T_WHITESPACE","\n\n    ",798],["T_COMMENT","\/\/ 200 for well-formed request that sends the maximum number of fields.\n",800],["T_WHITESPACE","    ",801],["T_VARIABLE","$max_normalization",801],["T_WHITESPACE"," ",801],"=",["T_WHITESPACE"," ",801],["T_VARIABLE","$this",801],["T_OBJECT_OPERATOR","->",801],["T_STRING","removeFieldsFromNormalization",801],"(",["T_VARIABLE","$max_normalization",801],",",["T_WHITESPACE"," ",801],["T_STATIC","static",801],["T_DOUBLE_COLON","::",801],["T_VARIABLE","$patchProtectedFieldNames",801],")",";",["T_WHITESPACE","\n    ",801],["T_VARIABLE","$request_options",802],"[",["T_STRING","RequestOptions",802],["T_DOUBLE_COLON","::",802],["T_STRING","BODY",802],"]",["T_WHITESPACE"," ",802],"=",["T_WHITESPACE"," ",802],["T_VARIABLE","$this",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","serializer",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","serialize",802],"(",["T_VARIABLE","$max_normalization",802],",",["T_WHITESPACE"," ",802],["T_STATIC","static",802],["T_DOUBLE_COLON","::",802],["T_VARIABLE","$format",802],")",";",["T_WHITESPACE","\n    ",802],["T_VARIABLE","$response",803],["T_WHITESPACE"," ",803],"=",["T_WHITESPACE"," ",803],["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","request",803],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",803],",",["T_WHITESPACE"," ",803],["T_VARIABLE","$url",803],",",["T_WHITESPACE"," ",803],["T_VARIABLE","$request_options",803],")",";",["T_WHITESPACE","\n    ",803],["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","assertResourceResponse",804],"(",["T_LNUMBER","200",804],",",["T_WHITESPACE"," ",804],["T_STRING","FALSE",804],",",["T_WHITESPACE"," ",804],["T_VARIABLE","$response",804],")",";",["T_WHITESPACE","\n\n\n    ",804],["T_VARIABLE","$request_options",807],"[",["T_STRING","RequestOptions",807],["T_DOUBLE_COLON","::",807],["T_STRING","BODY",807],"]",["T_WHITESPACE"," ",807],"=",["T_WHITESPACE"," ",807],["T_VARIABLE","$parseable_valid_request_body",807],";",["T_WHITESPACE","\n\n\n    ",807],["T_COMMENT","\/\/ Before sending a well-formed request, allow the normalization and\n",810],["T_WHITESPACE","    ",811],["T_COMMENT","\/\/ authentication provider edge cases to also be tested.\n",811],["T_WHITESPACE","    ",812],["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","assertNormalizationEdgeCases",812],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",812],",",["T_WHITESPACE"," ",812],["T_VARIABLE","$url",812],",",["T_WHITESPACE"," ",812],["T_VARIABLE","$request_options",812],")",";",["T_WHITESPACE","\n    ",812],["T_VARIABLE","$this",813],["T_OBJECT_OPERATOR","->",813],["T_STRING","assertAuthenticationEdgeCases",813],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",813],",",["T_WHITESPACE"," ",813],["T_VARIABLE","$url",813],",",["T_WHITESPACE"," ",813],["T_VARIABLE","$request_options",813],")",";",["T_WHITESPACE","\n\n\n    ",813],["T_VARIABLE","$request_options",816],"[",["T_STRING","RequestOptions",816],["T_DOUBLE_COLON","::",816],["T_STRING","HEADERS",816],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",816],"]",["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",816],";",["T_WHITESPACE","\n\n\n    ",816],["T_COMMENT","\/\/ DX: 415 when request body in existing but not allowed format.\n",819],["T_WHITESPACE","    ",820],["T_VARIABLE","$response",820],["T_WHITESPACE"," ",820],"=",["T_WHITESPACE"," ",820],["T_VARIABLE","$this",820],["T_OBJECT_OPERATOR","->",820],["T_STRING","request",820],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",820],",",["T_WHITESPACE"," ",820],["T_VARIABLE","$url",820],",",["T_WHITESPACE"," ",820],["T_VARIABLE","$request_options",820],")",";",["T_WHITESPACE","\n    ",820],["T_COMMENT","\/\/ @todo Update this in https:\/\/www.drupal.org\/node\/2826407. Also move it\n",821],["T_WHITESPACE","    ",822],["T_COMMENT","\/\/ higher, before the \"no request body\" test. That's impossible right now,\n",822],["T_WHITESPACE","    ",823],["T_COMMENT","\/\/ because the format validation happens too late.\n",823],["T_WHITESPACE","    ",824],["T_VARIABLE","$this",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","assertResourceErrorResponse",824],"(",["T_LNUMBER","415",824],",",["T_WHITESPACE"," ",824],["T_CONSTANT_ENCAPSED_STRING","''",824],",",["T_WHITESPACE"," ",824],["T_VARIABLE","$response",824],")",";",["T_WHITESPACE","\n\n\n    ",824],["T_VARIABLE","$request_options",827],"[",["T_STRING","RequestOptions",827],["T_DOUBLE_COLON","::",827],["T_STRING","HEADERS",827],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",827],"]",["T_WHITESPACE"," ",827],"=",["T_WHITESPACE"," ",827],["T_STATIC","static",827],["T_DOUBLE_COLON","::",827],["T_VARIABLE","$mimeType",827],";",["T_WHITESPACE","\n\n\n    ",827],["T_COMMENT","\/\/ 200 for well-formed request.\n",830],["T_WHITESPACE","    ",831],["T_VARIABLE","$response",831],["T_WHITESPACE"," ",831],"=",["T_WHITESPACE"," ",831],["T_VARIABLE","$this",831],["T_OBJECT_OPERATOR","->",831],["T_STRING","request",831],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",831],",",["T_WHITESPACE"," ",831],["T_VARIABLE","$url",831],",",["T_WHITESPACE"," ",831],["T_VARIABLE","$request_options",831],")",";",["T_WHITESPACE","\n    ",831],["T_VARIABLE","$this",832],["T_OBJECT_OPERATOR","->",832],["T_STRING","assertResourceResponse",832],"(",["T_LNUMBER","200",832],",",["T_WHITESPACE"," ",832],["T_STRING","FALSE",832],",",["T_WHITESPACE"," ",832],["T_VARIABLE","$response",832],")",";",["T_WHITESPACE","\n    ",832],["T_VARIABLE","$this",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","assertFalse",833],"(",["T_VARIABLE","$response",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","hasHeader",833],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",833],")",")",";",["T_WHITESPACE","\n    ",833],["T_COMMENT","\/\/ Ensure that fields do not get deleted if they're not present in the PATCH\n",834],["T_WHITESPACE","    ",835],["T_COMMENT","\/\/ request. Test this using the configurable field that we added, but which\n",835],["T_WHITESPACE","    ",836],["T_COMMENT","\/\/ is not sent in the PATCH request.\n",836],["T_WHITESPACE","    ",837],["T_VARIABLE","$this",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","assertSame",837],"(",["T_CONSTANT_ENCAPSED_STRING","'All the faith he had had had had no effect on the outcome of his life.'",837],",",["T_WHITESPACE"," ",837],["T_VARIABLE","$this",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","entityStorage",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","loadUnchanged",837],"(",["T_VARIABLE","$this",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","entity",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","id",837],"(",")",")",["T_OBJECT_OPERATOR","->",837],["T_STRING","get",837],"(",["T_CONSTANT_ENCAPSED_STRING","'field_rest_test'",837],")",["T_OBJECT_OPERATOR","->",837],["T_STRING","value",837],")",";",["T_WHITESPACE","\n\n\n    ",837],["T_VARIABLE","$this",840],["T_OBJECT_OPERATOR","->",840],["T_STRING","config",840],"(",["T_CONSTANT_ENCAPSED_STRING","'rest.settings'",840],")",["T_OBJECT_OPERATOR","->",840],["T_STRING","set",840],"(",["T_CONSTANT_ENCAPSED_STRING","'bc_entity_resource_permissions'",840],",",["T_WHITESPACE"," ",840],["T_STRING","TRUE",840],")",["T_OBJECT_OPERATOR","->",840],["T_STRING","save",840],"(",["T_STRING","TRUE",840],")",";",["T_WHITESPACE","\n    ",840],["T_VARIABLE","$request_options",841],"[",["T_STRING","RequestOptions",841],["T_DOUBLE_COLON","::",841],["T_STRING","BODY",841],"]",["T_WHITESPACE"," ",841],"=",["T_WHITESPACE"," ",841],["T_VARIABLE","$parseable_valid_request_body_2",841],";",["T_WHITESPACE","\n    ",841],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2815845.\n",842],["T_WHITESPACE","    ",843],["T_STRING","drupal_flush_all_caches",843],"(",")",";",["T_WHITESPACE","\n\n\n    ",843],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",846],["T_WHITESPACE","    ",847],["T_VARIABLE","$response",847],["T_WHITESPACE"," ",847],"=",["T_WHITESPACE"," ",847],["T_VARIABLE","$this",847],["T_OBJECT_OPERATOR","->",847],["T_STRING","request",847],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",847],",",["T_WHITESPACE"," ",847],["T_VARIABLE","$url",847],",",["T_WHITESPACE"," ",847],["T_VARIABLE","$request_options",847],")",";",["T_WHITESPACE","\n    ",847],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",848],["T_WHITESPACE","    ",849],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","assertResourceErrorResponse",849],"(",["T_LNUMBER","403",849],",",["T_WHITESPACE"," ",849],["T_CONSTANT_ENCAPSED_STRING","''",849],",",["T_WHITESPACE"," ",849],["T_VARIABLE","$response",849],")",";",["T_WHITESPACE","\n\n\n    ",849],["T_VARIABLE","$this",852],["T_OBJECT_OPERATOR","->",852],["T_STRING","grantPermissionsToTestedRole",852],"(","[",["T_CONSTANT_ENCAPSED_STRING","'restful patch entity:'",852],["T_WHITESPACE"," ",852],".",["T_WHITESPACE"," ",852],["T_STATIC","static",852],["T_DOUBLE_COLON","::",852],["T_VARIABLE","$entityTypeId",852],"]",")",";",["T_WHITESPACE","\n\n\n    ",852],["T_COMMENT","\/\/ 200 for well-formed request.\n",855],["T_WHITESPACE","    ",856],["T_VARIABLE","$response",856],["T_WHITESPACE"," ",856],"=",["T_WHITESPACE"," ",856],["T_VARIABLE","$this",856],["T_OBJECT_OPERATOR","->",856],["T_STRING","request",856],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",856],",",["T_WHITESPACE"," ",856],["T_VARIABLE","$url",856],",",["T_WHITESPACE"," ",856],["T_VARIABLE","$request_options",856],")",";",["T_WHITESPACE","\n    ",856],["T_VARIABLE","$this",857],["T_OBJECT_OPERATOR","->",857],["T_STRING","assertResourceResponse",857],"(",["T_LNUMBER","200",857],",",["T_WHITESPACE"," ",857],["T_STRING","FALSE",857],",",["T_WHITESPACE"," ",857],["T_VARIABLE","$response",857],")",";",["T_WHITESPACE","\n    ",857],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","assertFalse",858],"(",["T_VARIABLE","$response",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","hasHeader",858],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",858],")",")",";",["T_WHITESPACE","\n  ",858],"}",["T_WHITESPACE","\n\n  ",859],["T_DOC_COMMENT","\/**\n   * Tests a DELETE request for an entity, plus edge cases to ensure good DX.\n   *\/",861],["T_WHITESPACE","\n  ",863],["T_PUBLIC","public",864],["T_WHITESPACE"," ",864],["T_FUNCTION","function",864],["T_WHITESPACE"," ",864],["T_STRING","testDelete",864],"(",")",["T_WHITESPACE"," ",864],"{",["T_WHITESPACE","\n    ",864],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2300677.\n",865],["T_WHITESPACE","    ",866],["T_IF","if",866],["T_WHITESPACE"," ",866],"(",["T_VARIABLE","$this",866],["T_OBJECT_OPERATOR","->",866],["T_STRING","entity",866],["T_WHITESPACE"," ",866],["T_INSTANCEOF","instanceof",866],["T_WHITESPACE"," ",866],["T_STRING","ConfigEntityInterface",866],")",["T_WHITESPACE"," ",866],"{",["T_WHITESPACE","\n      ",866],["T_VARIABLE","$this",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","assertTrue",867],"(",["T_STRING","TRUE",867],",",["T_WHITESPACE"," ",867],["T_CONSTANT_ENCAPSED_STRING","'DELETEing config entities is not yet supported.'",867],")",";",["T_WHITESPACE","\n      ",867],["T_RETURN","return",868],";",["T_WHITESPACE","\n    ",868],"}",["T_WHITESPACE","\n\n    ",869],["T_VARIABLE","$this",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","initAuthentication",871],"(",")",";",["T_WHITESPACE","\n    ",871],["T_VARIABLE","$has_canonical_url",872],["T_WHITESPACE"," ",872],"=",["T_WHITESPACE"," ",872],["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","entity",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","hasLinkTemplate",872],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",872],")",";",["T_WHITESPACE","\n\n    ",872],["T_COMMENT","\/\/ The URL and Guzzle request options that will be used in this test. The\n",874],["T_WHITESPACE","    ",875],["T_COMMENT","\/\/ request options will be modified\/expanded throughout this test:\n",875],["T_WHITESPACE","    ",876],["T_COMMENT","\/\/ - to first test all mistakes a developer might make, and assert that the\n",876],["T_WHITESPACE","    ",877],["T_COMMENT","\/\/   error responses provide a good DX\n",877],["T_WHITESPACE","    ",878],["T_COMMENT","\/\/ - to eventually result in a well-formed request that succeeds.\n",878],["T_WHITESPACE","    ",879],["T_VARIABLE","$url",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","getUrl",879],"(",")",";",["T_WHITESPACE","\n    ",879],["T_VARIABLE","$request_options",880],["T_WHITESPACE"," ",880],"=",["T_WHITESPACE"," ",880],"[","]",";",["T_WHITESPACE","\n\n\n    ",880],["T_COMMENT","\/\/ DX: 405 when resource not provisioned, but HTML if canonical route.\n",883],["T_WHITESPACE","    ",884],["T_VARIABLE","$response",884],["T_WHITESPACE"," ",884],"=",["T_WHITESPACE"," ",884],["T_VARIABLE","$this",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","request",884],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",884],",",["T_WHITESPACE"," ",884],["T_VARIABLE","$url",884],",",["T_WHITESPACE"," ",884],["T_VARIABLE","$request_options",884],")",";",["T_WHITESPACE","\n    ",884],["T_IF","if",885],["T_WHITESPACE"," ",885],"(",["T_VARIABLE","$has_canonical_url",885],")",["T_WHITESPACE"," ",885],"{",["T_WHITESPACE","\n      ",885],["T_VARIABLE","$this",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","assertSame",886],"(",["T_LNUMBER","405",886],",",["T_WHITESPACE"," ",886],["T_VARIABLE","$response",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","getStatusCode",886],"(",")",")",";",["T_WHITESPACE","\n      ",886],["T_VARIABLE","$this",887],["T_OBJECT_OPERATOR","->",887],["T_STRING","assertSame",887],"(","[",["T_CONSTANT_ENCAPSED_STRING","'text\/html; charset=UTF-8'",887],"]",",",["T_WHITESPACE"," ",887],["T_VARIABLE","$response",887],["T_OBJECT_OPERATOR","->",887],["T_STRING","getHeader",887],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",887],")",")",";",["T_WHITESPACE","\n    ",887],"}",["T_WHITESPACE","\n    ",888],["T_ELSE","else",889],["T_WHITESPACE"," ",889],"{",["T_WHITESPACE","\n      ",889],["T_VARIABLE","$this",890],["T_OBJECT_OPERATOR","->",890],["T_STRING","assertResourceErrorResponse",890],"(",["T_LNUMBER","404",890],",",["T_WHITESPACE"," ",890],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"DELETE '",890],["T_WHITESPACE"," ",890],".",["T_WHITESPACE"," ",890],["T_STRING","str_replace",890],"(",["T_VARIABLE","$this",890],["T_OBJECT_OPERATOR","->",890],["T_STRING","baseUrl",890],",",["T_WHITESPACE"," ",890],["T_CONSTANT_ENCAPSED_STRING","''",890],",",["T_WHITESPACE"," ",890],["T_VARIABLE","$this",890],["T_OBJECT_OPERATOR","->",890],["T_STRING","getUrl",890],"(",")",["T_OBJECT_OPERATOR","->",890],["T_STRING","setAbsolute",890],"(",")",["T_OBJECT_OPERATOR","->",890],["T_STRING","toString",890],"(",")",")",["T_WHITESPACE"," ",890],".",["T_WHITESPACE"," ",890],["T_CONSTANT_ENCAPSED_STRING","'\"'",890],",",["T_WHITESPACE"," ",890],["T_VARIABLE","$response",890],")",";",["T_WHITESPACE","\n    ",890],"}",["T_WHITESPACE","\n\n\n    ",891],["T_VARIABLE","$url",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","setOption",894],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",894],",",["T_WHITESPACE"," ",894],"[",["T_CONSTANT_ENCAPSED_STRING","'_format'",894],["T_WHITESPACE"," ",894],["T_DOUBLE_ARROW","=>",894],["T_WHITESPACE"," ",894],["T_STATIC","static",894],["T_DOUBLE_COLON","::",894],["T_VARIABLE","$format",894],"]",")",";",["T_WHITESPACE","\n\n\n    ",894],["T_COMMENT","\/\/ DX: 405 when resource not provisioned.\n",897],["T_WHITESPACE","    ",898],["T_VARIABLE","$response",898],["T_WHITESPACE"," ",898],"=",["T_WHITESPACE"," ",898],["T_VARIABLE","$this",898],["T_OBJECT_OPERATOR","->",898],["T_STRING","request",898],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",898],",",["T_WHITESPACE"," ",898],["T_VARIABLE","$url",898],",",["T_WHITESPACE"," ",898],["T_VARIABLE","$request_options",898],")",";",["T_WHITESPACE","\n    ",898],["T_VARIABLE","$this",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","assertResourceErrorResponse",899],"(",["T_LNUMBER","405",899],",",["T_WHITESPACE"," ",899],["T_CONSTANT_ENCAPSED_STRING","'No route found for \"DELETE '",899],["T_WHITESPACE"," ",899],".",["T_WHITESPACE"," ",899],["T_STRING","str_replace",899],"(",["T_VARIABLE","$this",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","baseUrl",899],",",["T_WHITESPACE"," ",899],["T_CONSTANT_ENCAPSED_STRING","''",899],",",["T_WHITESPACE"," ",899],["T_VARIABLE","$this",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","getUrl",899],"(",")",["T_OBJECT_OPERATOR","->",899],["T_STRING","setAbsolute",899],"(",")",["T_OBJECT_OPERATOR","->",899],["T_STRING","toString",899],"(",")",")",["T_WHITESPACE"," ",899],".",["T_WHITESPACE"," ",899],["T_CONSTANT_ENCAPSED_STRING","'\": Method Not Allowed (Allow: GET, POST, HEAD)'",899],",",["T_WHITESPACE"," ",899],["T_VARIABLE","$response",899],")",";",["T_WHITESPACE","\n\n\n    ",899],["T_VARIABLE","$this",902],["T_OBJECT_OPERATOR","->",902],["T_STRING","provisionEntityResource",902],"(",")",";",["T_WHITESPACE","\n\n\n    ",902],["T_IF","if",905],["T_WHITESPACE"," ",905],"(",["T_STATIC","static",905],["T_DOUBLE_COLON","::",905],["T_VARIABLE","$auth",905],")",["T_WHITESPACE"," ",905],"{",["T_WHITESPACE","\n      ",905],["T_COMMENT","\/\/ DX: forgetting authentication: authentication provider-specific error\n",906],["T_WHITESPACE","      ",907],["T_COMMENT","\/\/ response.\n",907],["T_WHITESPACE","      ",908],["T_VARIABLE","$response",908],["T_WHITESPACE"," ",908],"=",["T_WHITESPACE"," ",908],["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","request",908],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",908],",",["T_WHITESPACE"," ",908],["T_VARIABLE","$url",908],",",["T_WHITESPACE"," ",908],["T_VARIABLE","$request_options",908],")",";",["T_WHITESPACE","\n      ",908],["T_VARIABLE","$this",909],["T_OBJECT_OPERATOR","->",909],["T_STRING","assertResponseWhenMissingAuthentication",909],"(",["T_VARIABLE","$response",909],")",";",["T_WHITESPACE","\n    ",909],"}",["T_WHITESPACE","\n\n\n    ",910],["T_VARIABLE","$request_options",913],["T_WHITESPACE"," ",913],"=",["T_WHITESPACE"," ",913],["T_STRING","NestedArray",913],["T_DOUBLE_COLON","::",913],["T_STRING","mergeDeep",913],"(",["T_VARIABLE","$request_options",913],",",["T_WHITESPACE"," ",913],["T_VARIABLE","$this",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","getAuthenticationRequestOptions",913],"(",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",913],")",")",";",["T_WHITESPACE","\n\n\n    ",913],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",916],["T_WHITESPACE","    ",917],["T_VARIABLE","$response",917],["T_WHITESPACE"," ",917],"=",["T_WHITESPACE"," ",917],["T_VARIABLE","$this",917],["T_OBJECT_OPERATOR","->",917],["T_STRING","request",917],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",917],",",["T_WHITESPACE"," ",917],["T_VARIABLE","$url",917],",",["T_WHITESPACE"," ",917],["T_VARIABLE","$request_options",917],")",";",["T_WHITESPACE","\n    ",917],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",918],["T_WHITESPACE","    ",919],["T_VARIABLE","$this",919],["T_OBJECT_OPERATOR","->",919],["T_STRING","assertResourceErrorResponse",919],"(",["T_LNUMBER","403",919],",",["T_WHITESPACE"," ",919],["T_CONSTANT_ENCAPSED_STRING","''",919],",",["T_WHITESPACE"," ",919],["T_VARIABLE","$response",919],")",";",["T_WHITESPACE","\n\n\n    ",919],["T_VARIABLE","$this",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","setUpAuthorization",922],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",922],")",";",["T_WHITESPACE","\n\n\n    ",922],["T_COMMENT","\/\/ Before sending a well-formed request, allow the authentication provider's\n",925],["T_WHITESPACE","    ",926],["T_COMMENT","\/\/ edge cases to also be tested.\n",926],["T_WHITESPACE","    ",927],["T_VARIABLE","$this",927],["T_OBJECT_OPERATOR","->",927],["T_STRING","assertAuthenticationEdgeCases",927],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",927],",",["T_WHITESPACE"," ",927],["T_VARIABLE","$url",927],",",["T_WHITESPACE"," ",927],["T_VARIABLE","$request_options",927],")",";",["T_WHITESPACE","\n\n\n    ",927],["T_COMMENT","\/\/ 204 for well-formed request.\n",930],["T_WHITESPACE","    ",931],["T_VARIABLE","$response",931],["T_WHITESPACE"," ",931],"=",["T_WHITESPACE"," ",931],["T_VARIABLE","$this",931],["T_OBJECT_OPERATOR","->",931],["T_STRING","request",931],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",931],",",["T_WHITESPACE"," ",931],["T_VARIABLE","$url",931],",",["T_WHITESPACE"," ",931],["T_VARIABLE","$request_options",931],")",";",["T_WHITESPACE","\n    ",931],["T_VARIABLE","$this",932],["T_OBJECT_OPERATOR","->",932],["T_STRING","assertSame",932],"(",["T_LNUMBER","204",932],",",["T_WHITESPACE"," ",932],["T_VARIABLE","$response",932],["T_OBJECT_OPERATOR","->",932],["T_STRING","getStatusCode",932],"(",")",")",";",["T_WHITESPACE","\n    ",932],["T_COMMENT","\/\/ @todo Uncomment the following line when https:\/\/www.drupal.org\/node\/2821711 is fixed.\n",933],["T_WHITESPACE","    ",934],["T_COMMENT","\/\/ $this->assertSame(FALSE, $response->hasHeader('Content-Type'));\n",934],["T_WHITESPACE","    ",935],["T_VARIABLE","$this",935],["T_OBJECT_OPERATOR","->",935],["T_STRING","assertSame",935],"(",["T_CONSTANT_ENCAPSED_STRING","''",935],",",["T_WHITESPACE"," ",935],["T_STRING_CAST","(string)",935],["T_WHITESPACE"," ",935],["T_VARIABLE","$response",935],["T_OBJECT_OPERATOR","->",935],["T_STRING","getBody",935],"(",")",")",";",["T_WHITESPACE","\n    ",935],["T_VARIABLE","$this",936],["T_OBJECT_OPERATOR","->",936],["T_STRING","assertFalse",936],"(",["T_VARIABLE","$response",936],["T_OBJECT_OPERATOR","->",936],["T_STRING","hasHeader",936],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",936],")",")",";",["T_WHITESPACE","\n\n\n    ",936],["T_VARIABLE","$this",939],["T_OBJECT_OPERATOR","->",939],["T_STRING","config",939],"(",["T_CONSTANT_ENCAPSED_STRING","'rest.settings'",939],")",["T_OBJECT_OPERATOR","->",939],["T_STRING","set",939],"(",["T_CONSTANT_ENCAPSED_STRING","'bc_entity_resource_permissions'",939],",",["T_WHITESPACE"," ",939],["T_STRING","TRUE",939],")",["T_OBJECT_OPERATOR","->",939],["T_STRING","save",939],"(",["T_STRING","TRUE",939],")",";",["T_WHITESPACE","\n    ",939],["T_COMMENT","\/\/ @todo Remove this in https:\/\/www.drupal.org\/node\/2815845.\n",940],["T_WHITESPACE","    ",941],["T_STRING","drupal_flush_all_caches",941],"(",")",";",["T_WHITESPACE","\n    ",941],["T_VARIABLE","$this",942],["T_OBJECT_OPERATOR","->",942],["T_STRING","entity",942],["T_WHITESPACE"," ",942],"=",["T_WHITESPACE"," ",942],["T_VARIABLE","$this",942],["T_OBJECT_OPERATOR","->",942],["T_STRING","createEntity",942],"(",")",";",["T_WHITESPACE","\n    ",942],["T_VARIABLE","$url",943],["T_WHITESPACE"," ",943],"=",["T_WHITESPACE"," ",943],["T_VARIABLE","$this",943],["T_OBJECT_OPERATOR","->",943],["T_STRING","getUrl",943],"(",")",["T_OBJECT_OPERATOR","->",943],["T_STRING","setOption",943],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",943],",",["T_WHITESPACE"," ",943],["T_VARIABLE","$url",943],["T_OBJECT_OPERATOR","->",943],["T_STRING","getOption",943],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",943],")",")",";",["T_WHITESPACE","\n\n\n    ",943],["T_COMMENT","\/\/ DX: 403 when unauthorized.\n",946],["T_WHITESPACE","    ",947],["T_VARIABLE","$response",947],["T_WHITESPACE"," ",947],"=",["T_WHITESPACE"," ",947],["T_VARIABLE","$this",947],["T_OBJECT_OPERATOR","->",947],["T_STRING","request",947],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",947],",",["T_WHITESPACE"," ",947],["T_VARIABLE","$url",947],",",["T_WHITESPACE"," ",947],["T_VARIABLE","$request_options",947],")",";",["T_WHITESPACE","\n    ",947],["T_COMMENT","\/\/ @todo Update the message in https:\/\/www.drupal.org\/node\/2808233.\n",948],["T_WHITESPACE","    ",949],["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","assertResourceErrorResponse",949],"(",["T_LNUMBER","403",949],",",["T_WHITESPACE"," ",949],["T_CONSTANT_ENCAPSED_STRING","''",949],",",["T_WHITESPACE"," ",949],["T_VARIABLE","$response",949],")",";",["T_WHITESPACE","\n\n\n    ",949],["T_VARIABLE","$this",952],["T_OBJECT_OPERATOR","->",952],["T_STRING","grantPermissionsToTestedRole",952],"(","[",["T_CONSTANT_ENCAPSED_STRING","'restful delete entity:'",952],["T_WHITESPACE"," ",952],".",["T_WHITESPACE"," ",952],["T_STATIC","static",952],["T_DOUBLE_COLON","::",952],["T_VARIABLE","$entityTypeId",952],"]",")",";",["T_WHITESPACE","\n\n\n    ",952],["T_COMMENT","\/\/ 204 for well-formed request.\n",955],["T_WHITESPACE","    ",956],["T_VARIABLE","$response",956],["T_WHITESPACE"," ",956],"=",["T_WHITESPACE"," ",956],["T_VARIABLE","$this",956],["T_OBJECT_OPERATOR","->",956],["T_STRING","request",956],"(",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",956],",",["T_WHITESPACE"," ",956],["T_VARIABLE","$url",956],",",["T_WHITESPACE"," ",956],["T_VARIABLE","$request_options",956],")",";",["T_WHITESPACE","\n    ",956],["T_VARIABLE","$this",957],["T_OBJECT_OPERATOR","->",957],["T_STRING","assertSame",957],"(",["T_LNUMBER","204",957],",",["T_WHITESPACE"," ",957],["T_VARIABLE","$response",957],["T_OBJECT_OPERATOR","->",957],["T_STRING","getStatusCode",957],"(",")",")",";",["T_WHITESPACE","\n    ",957],["T_COMMENT","\/\/ @todo Uncomment the following line when https:\/\/www.drupal.org\/node\/2821711 is fixed.\n",958],["T_WHITESPACE","    ",959],["T_COMMENT","\/\/ $this->assertSame(FALSE, $response->hasHeader('Content-Type'));\n",959],["T_WHITESPACE","    ",960],["T_VARIABLE","$this",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","assertSame",960],"(",["T_CONSTANT_ENCAPSED_STRING","''",960],",",["T_WHITESPACE"," ",960],["T_STRING_CAST","(string)",960],["T_WHITESPACE"," ",960],["T_VARIABLE","$response",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","getBody",960],"(",")",")",";",["T_WHITESPACE","\n    ",960],["T_VARIABLE","$this",961],["T_OBJECT_OPERATOR","->",961],["T_STRING","assertFalse",961],"(",["T_VARIABLE","$response",961],["T_OBJECT_OPERATOR","->",961],["T_STRING","hasHeader",961],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",961],")",")",";",["T_WHITESPACE","\n  ",961],"}",["T_WHITESPACE","\n\n  ",962],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",964],["T_WHITESPACE","\n  ",966],["T_PROTECTED","protected",967],["T_WHITESPACE"," ",967],["T_FUNCTION","function",967],["T_WHITESPACE"," ",967],["T_STRING","assertNormalizationEdgeCases",967],"(",["T_VARIABLE","$method",967],",",["T_WHITESPACE"," ",967],["T_STRING","Url",967],["T_WHITESPACE"," ",967],["T_VARIABLE","$url",967],",",["T_WHITESPACE"," ",967],["T_ARRAY","array",967],["T_WHITESPACE"," ",967],["T_VARIABLE","$request_options",967],")",["T_WHITESPACE"," ",967],"{",["T_WHITESPACE","\n    ",967],["T_COMMENT","\/\/ \\Drupal\\serialization\\Normalizer\\EntityNormalizer::denormalize(): entity\n",968],["T_WHITESPACE","    ",969],["T_COMMENT","\/\/ types with bundles MUST send their bundle field to be denormalizable.\n",969],["T_WHITESPACE","    ",970],["T_VARIABLE","$entity_type",970],["T_WHITESPACE"," ",970],"=",["T_WHITESPACE"," ",970],["T_VARIABLE","$this",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","entity",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","getEntityType",970],"(",")",";",["T_WHITESPACE","\n    ",970],["T_IF","if",971],["T_WHITESPACE"," ",971],"(",["T_VARIABLE","$entity_type",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","hasKey",971],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle'",971],")",")",["T_WHITESPACE"," ",971],"{",["T_WHITESPACE","\n      ",971],["T_VARIABLE","$bundle_field_name",972],["T_WHITESPACE"," ",972],"=",["T_WHITESPACE"," ",972],["T_VARIABLE","$this",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","entity",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","getEntityType",972],"(",")",["T_OBJECT_OPERATOR","->",972],["T_STRING","getKey",972],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle'",972],")",";",["T_WHITESPACE","\n      ",972],["T_VARIABLE","$normalization",973],["T_WHITESPACE"," ",973],"=",["T_WHITESPACE"," ",973],["T_VARIABLE","$this",973],["T_OBJECT_OPERATOR","->",973],["T_STRING","getNormalizedPostEntity",973],"(",")",";",["T_WHITESPACE","\n\n      ",973],["T_COMMENT","\/\/ The bundle type itself can be validated only if there's a bundle entity\n",975],["T_WHITESPACE","      ",976],["T_COMMENT","\/\/ type.\n",976],["T_WHITESPACE","      ",977],["T_IF","if",977],["T_WHITESPACE"," ",977],"(",["T_VARIABLE","$entity_type",977],["T_OBJECT_OPERATOR","->",977],["T_STRING","getBundleEntityType",977],"(",")",")",["T_WHITESPACE"," ",977],"{",["T_WHITESPACE","\n        ",977],["T_VARIABLE","$normalization",978],"[",["T_VARIABLE","$bundle_field_name",978],"]",["T_WHITESPACE"," ",978],"=",["T_WHITESPACE"," ",978],["T_CONSTANT_ENCAPSED_STRING","'bad_bundle_name'",978],";",["T_WHITESPACE","\n        ",978],["T_VARIABLE","$request_options",979],"[",["T_STRING","RequestOptions",979],["T_DOUBLE_COLON","::",979],["T_STRING","BODY",979],"]",["T_WHITESPACE"," ",979],"=",["T_WHITESPACE"," ",979],["T_VARIABLE","$this",979],["T_OBJECT_OPERATOR","->",979],["T_STRING","serializer",979],["T_OBJECT_OPERATOR","->",979],["T_STRING","encode",979],"(",["T_VARIABLE","$normalization",979],",",["T_WHITESPACE"," ",979],["T_STATIC","static",979],["T_DOUBLE_COLON","::",979],["T_VARIABLE","$format",979],")",";",["T_WHITESPACE","\n\n\n        ",979],["T_COMMENT","\/\/ DX: 400 when incorrect entity type bundle is specified.\n",982],["T_WHITESPACE","        ",983],["T_COMMENT","\/\/ @todo Change to 422 in https:\/\/www.drupal.org\/node\/2827084.\n",983],["T_WHITESPACE","        ",984],["T_VARIABLE","$response",984],["T_WHITESPACE"," ",984],"=",["T_WHITESPACE"," ",984],["T_VARIABLE","$this",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","request",984],"(",["T_VARIABLE","$method",984],",",["T_WHITESPACE"," ",984],["T_VARIABLE","$url",984],",",["T_WHITESPACE"," ",984],["T_VARIABLE","$request_options",984],")",";",["T_WHITESPACE","\n        ",984],["T_COMMENT","\/\/ @todo use this commented line instead of the 3 lines thereafter once https:\/\/www.drupal.org\/node\/2813853 lands.\n",985],["T_WHITESPACE","        ",986],["T_COMMENT","\/\/      $this->assertResourceErrorResponse(400, '\"bad_bundle_name\" is not a valid bundle type for denormalization.', $response);\n",986],["T_WHITESPACE","        ",987],["T_VARIABLE","$this",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","assertSame",987],"(",["T_LNUMBER","400",987],",",["T_WHITESPACE"," ",987],["T_VARIABLE","$response",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","getStatusCode",987],"(",")",")",";",["T_WHITESPACE","\n        ",987],["T_VARIABLE","$this",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","assertSame",988],"(","[",["T_STATIC","static",988],["T_DOUBLE_COLON","::",988],["T_VARIABLE","$mimeType",988],"]",",",["T_WHITESPACE"," ",988],["T_VARIABLE","$response",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","getHeader",988],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",988],")",")",";",["T_WHITESPACE","\n        ",988],["T_VARIABLE","$this",989],["T_OBJECT_OPERATOR","->",989],["T_STRING","assertSame",989],"(",["T_VARIABLE","$this",989],["T_OBJECT_OPERATOR","->",989],["T_STRING","serializer",989],["T_OBJECT_OPERATOR","->",989],["T_STRING","encode",989],"(","[",["T_CONSTANT_ENCAPSED_STRING","'error'",989],["T_WHITESPACE"," ",989],["T_DOUBLE_ARROW","=>",989],["T_WHITESPACE"," ",989],["T_CONSTANT_ENCAPSED_STRING","'\"bad_bundle_name\" is not a valid bundle type for denormalization.'",989],"]",",",["T_WHITESPACE"," ",989],["T_STATIC","static",989],["T_DOUBLE_COLON","::",989],["T_VARIABLE","$format",989],")",",",["T_WHITESPACE"," ",989],["T_STRING_CAST","(string)",989],["T_WHITESPACE"," ",989],["T_VARIABLE","$response",989],["T_OBJECT_OPERATOR","->",989],["T_STRING","getBody",989],"(",")",")",";",["T_WHITESPACE","\n      ",989],"}",["T_WHITESPACE","\n\n\n      ",990],["T_UNSET","unset",993],"(",["T_VARIABLE","$normalization",993],"[",["T_VARIABLE","$bundle_field_name",993],"]",")",";",["T_WHITESPACE","\n      ",993],["T_VARIABLE","$request_options",994],"[",["T_STRING","RequestOptions",994],["T_DOUBLE_COLON","::",994],["T_STRING","BODY",994],"]",["T_WHITESPACE"," ",994],"=",["T_WHITESPACE"," ",994],["T_VARIABLE","$this",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","serializer",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","encode",994],"(",["T_VARIABLE","$normalization",994],",",["T_WHITESPACE"," ",994],["T_STATIC","static",994],["T_DOUBLE_COLON","::",994],["T_VARIABLE","$format",994],")",";",["T_WHITESPACE","\n\n\n      ",994],["T_COMMENT","\/\/ DX: 400 when no entity type bundle is specified.\n",997],["T_WHITESPACE","      ",998],["T_COMMENT","\/\/ @todo Change to 422 in https:\/\/www.drupal.org\/node\/2827084.\n",998],["T_WHITESPACE","      ",999],["T_VARIABLE","$response",999],["T_WHITESPACE"," ",999],"=",["T_WHITESPACE"," ",999],["T_VARIABLE","$this",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","request",999],"(",["T_VARIABLE","$method",999],",",["T_WHITESPACE"," ",999],["T_VARIABLE","$url",999],",",["T_WHITESPACE"," ",999],["T_VARIABLE","$request_options",999],")",";",["T_WHITESPACE","\n      ",999],["T_COMMENT","\/\/ @todo use this commented line instead of the 3 lines thereafter once https:\/\/www.drupal.org\/node\/2813853 lands.\n",1000],["T_WHITESPACE","      ",1001],["T_COMMENT","\/\/ $this->assertResourceErrorResponse(400, 'A string must be provided as a bundle value.', $response);\n",1001],["T_WHITESPACE","      ",1002],["T_VARIABLE","$this",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","assertSame",1002],"(",["T_LNUMBER","400",1002],",",["T_WHITESPACE"," ",1002],["T_VARIABLE","$response",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","getStatusCode",1002],"(",")",")",";",["T_WHITESPACE","\n      ",1002],["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","assertSame",1003],"(","[",["T_STATIC","static",1003],["T_DOUBLE_COLON","::",1003],["T_VARIABLE","$mimeType",1003],"]",",",["T_WHITESPACE"," ",1003],["T_VARIABLE","$response",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","getHeader",1003],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",1003],")",")",";",["T_WHITESPACE","\n      ",1003],["T_VARIABLE","$this",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","assertSame",1004],"(",["T_VARIABLE","$this",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","serializer",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","encode",1004],"(","[",["T_CONSTANT_ENCAPSED_STRING","'error'",1004],["T_WHITESPACE"," ",1004],["T_DOUBLE_ARROW","=>",1004],["T_WHITESPACE"," ",1004],["T_CONSTANT_ENCAPSED_STRING","'A string must be provided as a bundle value.'",1004],"]",",",["T_WHITESPACE"," ",1004],["T_STATIC","static",1004],["T_DOUBLE_COLON","::",1004],["T_VARIABLE","$format",1004],")",",",["T_WHITESPACE"," ",1004],["T_STRING_CAST","(string)",1004],["T_WHITESPACE"," ",1004],["T_VARIABLE","$response",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","getBody",1004],"(",")",")",";",["T_WHITESPACE","\n    ",1004],"}",["T_WHITESPACE","\n  ",1005],"}",["T_WHITESPACE","\n\n  ",1006],["T_DOC_COMMENT","\/**\n   * Gets an entity resource's GET\/PATCH\/DELETE URL.\n   *\n   * @return \\Drupal\\Core\\Url\n   *   The URL to GET\/PATCH\/DELETE.\n   *\/",1008],["T_WHITESPACE","\n  ",1013],["T_PROTECTED","protected",1014],["T_WHITESPACE"," ",1014],["T_FUNCTION","function",1014],["T_WHITESPACE"," ",1014],["T_STRING","getUrl",1014],"(",")",["T_WHITESPACE"," ",1014],"{",["T_WHITESPACE","\n    ",1014],["T_VARIABLE","$has_canonical_url",1015],["T_WHITESPACE"," ",1015],"=",["T_WHITESPACE"," ",1015],["T_VARIABLE","$this",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","entity",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","hasLinkTemplate",1015],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",1015],")",";",["T_WHITESPACE","\n    ",1015],["T_RETURN","return",1016],["T_WHITESPACE"," ",1016],["T_VARIABLE","$has_canonical_url",1016],["T_WHITESPACE"," ",1016],"?",["T_WHITESPACE"," ",1016],["T_VARIABLE","$this",1016],["T_OBJECT_OPERATOR","->",1016],["T_STRING","entity",1016],["T_OBJECT_OPERATOR","->",1016],["T_STRING","toUrl",1016],"(",")",["T_WHITESPACE"," ",1016],":",["T_WHITESPACE"," ",1016],["T_STRING","Url",1016],["T_DOUBLE_COLON","::",1016],["T_STRING","fromUri",1016],"(",["T_CONSTANT_ENCAPSED_STRING","'base:entity\/'",1016],["T_WHITESPACE"," ",1016],".",["T_WHITESPACE"," ",1016],["T_STATIC","static",1016],["T_DOUBLE_COLON","::",1016],["T_VARIABLE","$entityTypeId",1016],["T_WHITESPACE"," ",1016],".",["T_WHITESPACE"," ",1016],["T_CONSTANT_ENCAPSED_STRING","'\/'",1016],["T_WHITESPACE"," ",1016],".",["T_WHITESPACE"," ",1016],["T_VARIABLE","$this",1016],["T_OBJECT_OPERATOR","->",1016],["T_STRING","entity",1016],["T_OBJECT_OPERATOR","->",1016],["T_STRING","id",1016],"(",")",")",";",["T_WHITESPACE","\n  ",1016],"}",["T_WHITESPACE","\n\n  ",1017],["T_DOC_COMMENT","\/**\n   * Gets an entity resource's POST URL.\n   *\n   * @return \\Drupal\\Core\\Url\n   *   The URL to POST to.\n   *\/",1019],["T_WHITESPACE","\n  ",1024],["T_PROTECTED","protected",1025],["T_WHITESPACE"," ",1025],["T_FUNCTION","function",1025],["T_WHITESPACE"," ",1025],["T_STRING","getPostUrl",1025],"(",")",["T_WHITESPACE"," ",1025],"{",["T_WHITESPACE","\n    ",1025],["T_VARIABLE","$has_canonical_url",1026],["T_WHITESPACE"," ",1026],"=",["T_WHITESPACE"," ",1026],["T_VARIABLE","$this",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","entity",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","hasLinkTemplate",1026],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.drupal.org\/link-relations\/create'",1026],")",";",["T_WHITESPACE","\n    ",1026],["T_RETURN","return",1027],["T_WHITESPACE"," ",1027],["T_VARIABLE","$has_canonical_url",1027],["T_WHITESPACE"," ",1027],"?",["T_WHITESPACE"," ",1027],["T_VARIABLE","$this",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","entity",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","toUrl",1027],"(",")",["T_WHITESPACE"," ",1027],":",["T_WHITESPACE"," ",1027],["T_STRING","Url",1027],["T_DOUBLE_COLON","::",1027],["T_STRING","fromUri",1027],"(",["T_CONSTANT_ENCAPSED_STRING","'base:entity\/'",1027],["T_WHITESPACE"," ",1027],".",["T_WHITESPACE"," ",1027],["T_STATIC","static",1027],["T_DOUBLE_COLON","::",1027],["T_VARIABLE","$entityTypeId",1027],")",";",["T_WHITESPACE","\n  ",1027],"}",["T_WHITESPACE","\n\n  ",1028],["T_DOC_COMMENT","\/**\n   * Makes the given entity normalization invalid.\n   *\n   * @param array $normalization\n   *   An entity normalization.\n   *\n   * @return array\n   *   The updated entity normalization, now invalid.\n   *\/",1030],["T_WHITESPACE","\n  ",1038],["T_PROTECTED","protected",1039],["T_WHITESPACE"," ",1039],["T_FUNCTION","function",1039],["T_WHITESPACE"," ",1039],["T_STRING","makeNormalizationInvalid",1039],"(",["T_ARRAY","array",1039],["T_WHITESPACE"," ",1039],["T_VARIABLE","$normalization",1039],")",["T_WHITESPACE"," ",1039],"{",["T_WHITESPACE","\n    ",1039],["T_COMMENT","\/\/ Add a second label to this entity to make it invalid.\n",1040],["T_WHITESPACE","    ",1041],["T_VARIABLE","$label_field",1041],["T_WHITESPACE"," ",1041],"=",["T_WHITESPACE"," ",1041],["T_VARIABLE","$this",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","entity",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","getEntityType",1041],"(",")",["T_OBJECT_OPERATOR","->",1041],["T_STRING","hasKey",1041],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",1041],")",["T_WHITESPACE"," ",1041],"?",["T_WHITESPACE"," ",1041],["T_VARIABLE","$this",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","entity",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","getEntityType",1041],"(",")",["T_OBJECT_OPERATOR","->",1041],["T_STRING","getKey",1041],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",1041],")",["T_WHITESPACE"," ",1041],":",["T_WHITESPACE"," ",1041],["T_STATIC","static",1041],["T_DOUBLE_COLON","::",1041],["T_VARIABLE","$labelFieldName",1041],";",["T_WHITESPACE","\n    ",1041],["T_VARIABLE","$normalization",1042],"[",["T_VARIABLE","$label_field",1042],"]","[",["T_LNUMBER","1",1042],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",1042],"]",["T_WHITESPACE"," ",1042],"=",["T_WHITESPACE"," ",1042],["T_CONSTANT_ENCAPSED_STRING","'Second Title'",1042],";",["T_WHITESPACE","\n\n    ",1042],["T_RETURN","return",1044],["T_WHITESPACE"," ",1044],["T_VARIABLE","$normalization",1044],";",["T_WHITESPACE","\n  ",1044],"}",["T_WHITESPACE","\n\n  ",1045],["T_DOC_COMMENT","\/**\n   * Removes fields from a normalization.\n   *\n   * @param array $normalization\n   *   An entity normalization.\n   * @param string[] $field_names\n   *   The field names to remove from the entity normalization.\n   *\n   * @return array\n   *   The updated entity normalization.\n   *\n   * @see ::testPatch\n   *\/",1047],["T_WHITESPACE","\n  ",1059],["T_PROTECTED","protected",1060],["T_WHITESPACE"," ",1060],["T_FUNCTION","function",1060],["T_WHITESPACE"," ",1060],["T_STRING","removeFieldsFromNormalization",1060],"(",["T_ARRAY","array",1060],["T_WHITESPACE"," ",1060],["T_VARIABLE","$normalization",1060],",",["T_WHITESPACE"," ",1060],["T_VARIABLE","$field_names",1060],")",["T_WHITESPACE"," ",1060],"{",["T_WHITESPACE","\n    ",1060],["T_RETURN","return",1061],["T_WHITESPACE"," ",1061],["T_STRING","array_diff_key",1061],"(",["T_VARIABLE","$normalization",1061],",",["T_WHITESPACE"," ",1061],["T_STRING","array_flip",1061],"(",["T_VARIABLE","$field_names",1061],")",")",";",["T_WHITESPACE","\n  ",1061],"}",["T_WHITESPACE","\n\n  ",1062],["T_DOC_COMMENT","\/**\n   * Asserts a 406 response\u00e2\u0080\u00a6 or in some cases a 403 response, because weirdness.\n   *\n   * Asserting a 406 response should be easy, but it's not, due to bugs.\n   *\n   * Drupal returns a 403 response instead of a 406 response when:\n   * - there is a canonical route, i.e. one that serves HTML\n   * - unless the user is logged in with any non-global authentication provider,\n   *   because then they tried to access a route that requires the user to be\n   *   authenticated, but they used an authentication provider that is only\n   *   accepted for specific routes, and HTML routes never have such specific\n   *   authentication providers specified. (By default, only 'cookie' is a\n   *   global authentication provider.)\n   *\n   * @todo Remove this in https:\/\/www.drupal.org\/node\/2805279.\n   *\n   * @param \\Psr\\Http\\Message\\ResponseInterface $response\n   *   The response to assert.\n   *\/",1064],["T_WHITESPACE","\n  ",1082],["T_PROTECTED","protected",1083],["T_WHITESPACE"," ",1083],["T_FUNCTION","function",1083],["T_WHITESPACE"," ",1083],["T_STRING","assert406Response",1083],"(",["T_STRING","ResponseInterface",1083],["T_WHITESPACE"," ",1083],["T_VARIABLE","$response",1083],")",["T_WHITESPACE"," ",1083],"{",["T_WHITESPACE","\n    ",1083],["T_IF","if",1084],["T_WHITESPACE"," ",1084],"(",["T_VARIABLE","$this",1084],["T_OBJECT_OPERATOR","->",1084],["T_STRING","entity",1084],["T_OBJECT_OPERATOR","->",1084],["T_STRING","hasLinkTemplate",1084],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",1084],")",["T_WHITESPACE"," ",1084],["T_BOOLEAN_AND","&&",1084],["T_WHITESPACE"," ",1084],"(",["T_VARIABLE","$this",1084],["T_OBJECT_OPERATOR","->",1084],["T_STRING","account",1084],["T_WHITESPACE"," ",1084],["T_BOOLEAN_AND","&&",1084],["T_WHITESPACE"," ",1084],["T_STATIC","static",1084],["T_DOUBLE_COLON","::",1084],["T_VARIABLE","$auth",1084],["T_WHITESPACE"," ",1084],["T_IS_NOT_IDENTICAL","!==",1084],["T_WHITESPACE"," ",1084],["T_CONSTANT_ENCAPSED_STRING","'cookie'",1084],")",")",["T_WHITESPACE"," ",1084],"{",["T_WHITESPACE","\n      ",1084],["T_VARIABLE","$this",1085],["T_OBJECT_OPERATOR","->",1085],["T_STRING","assertSame",1085],"(",["T_LNUMBER","403",1085],",",["T_WHITESPACE"," ",1085],["T_VARIABLE","$response",1085],["T_OBJECT_OPERATOR","->",1085],["T_STRING","getStatusCode",1085],"(",")",")",";",["T_WHITESPACE","\n    ",1085],"}",["T_WHITESPACE","\n    ",1086],["T_ELSE","else",1087],["T_WHITESPACE"," ",1087],"{",["T_WHITESPACE","\n      ",1087],["T_COMMENT","\/\/ This is the desired response.\n",1088],["T_WHITESPACE","      ",1089],["T_VARIABLE","$this",1089],["T_OBJECT_OPERATOR","->",1089],["T_STRING","assertSame",1089],"(",["T_LNUMBER","406",1089],",",["T_WHITESPACE"," ",1089],["T_VARIABLE","$response",1089],["T_OBJECT_OPERATOR","->",1089],["T_STRING","getStatusCode",1089],"(",")",")",";",["T_WHITESPACE","\n    ",1089],"}",["T_WHITESPACE","\n  ",1090],"}",["T_WHITESPACE","\n\n",1091],"}",["T_WHITESPACE","\n",1093]]