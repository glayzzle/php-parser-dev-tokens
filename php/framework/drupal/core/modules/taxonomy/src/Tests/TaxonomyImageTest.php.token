[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","taxonomy",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","field",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FieldConfig",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","user",6],["T_NS_SEPARATOR","\\",6],["T_STRING","RoleInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","file",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","File",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","field",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FieldStorageConfig",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Tests access checks of private image fields.\n *\n * @group taxonomy\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","TaxonomyImageTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","TaxonomyTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Used taxonomy vocabulary.\n   *\n   * @var \\Drupal\\taxonomy\\VocabularyInterface\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$vocabulary",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PUBLIC","public",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$modules",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",29],")",";",["T_WHITESPACE","\n\n  ",29],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","setUp",31],"(",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n    ",31],["T_STRING","parent",32],["T_DOUBLE_COLON","::",32],["T_STRING","setUp",32],"(",")",";",["T_WHITESPACE","\n\n    ",32],["T_COMMENT","\/\/ Remove access content permission from registered users.\n",34],["T_WHITESPACE","    ",35],["T_STRING","user_role_revoke_permissions",35],"(",["T_STRING","RoleInterface",35],["T_DOUBLE_COLON","::",35],["T_STRING","AUTHENTICATED_ID",35],",",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_CONSTANT_ENCAPSED_STRING","'access content'",35],")",")",";",["T_WHITESPACE","\n\n    ",35],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","vocabulary",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","createVocabulary",37],"(",")",";",["T_WHITESPACE","\n    ",37],["T_COMMENT","\/\/ Add a field to the vocabulary.\n",38],["T_WHITESPACE","    ",39],["T_VARIABLE","$entity_type",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'taxonomy_term'",39],";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$name",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'field_test'",40],";",["T_WHITESPACE","\n    ",40],["T_STRING","FieldStorageConfig",41],["T_DOUBLE_COLON","::",41],["T_STRING","create",41],"(",["T_ARRAY","array",41],"(",["T_WHITESPACE","\n      ",41],["T_CONSTANT_ENCAPSED_STRING","'field_name'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$name",42],",",["T_WHITESPACE","\n      ",42],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$entity_type",43],",",["T_WHITESPACE","\n      ",43],["T_CONSTANT_ENCAPSED_STRING","'type'",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'image'",44],",",["T_WHITESPACE","\n      ",44],["T_CONSTANT_ENCAPSED_STRING","'settings'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_WHITESPACE","\n        ",45],["T_CONSTANT_ENCAPSED_STRING","'uri_scheme'",46],["T_WHITESPACE"," ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'private'",46],",",["T_WHITESPACE","\n      ",46],")",",",["T_WHITESPACE","\n    ",47],")",")",["T_OBJECT_OPERATOR","->",48],["T_STRING","save",48],"(",")",";",["T_WHITESPACE","\n    ",48],["T_STRING","FieldConfig",49],["T_DOUBLE_COLON","::",49],["T_STRING","create",49],"(","[",["T_WHITESPACE","\n      ",49],["T_CONSTANT_ENCAPSED_STRING","'field_name'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$name",50],",",["T_WHITESPACE","\n      ",50],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$entity_type",51],",",["T_WHITESPACE","\n      ",51],["T_CONSTANT_ENCAPSED_STRING","'bundle'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","vocabulary",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","id",52],"(",")",",",["T_WHITESPACE","\n      ",52],["T_CONSTANT_ENCAPSED_STRING","'settings'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_ARRAY","array",53],"(",")",",",["T_WHITESPACE","\n    ",53],"]",")",["T_OBJECT_OPERATOR","->",54],["T_STRING","save",54],"(",")",";",["T_WHITESPACE","\n    ",54],["T_STRING","entity_get_display",55],"(",["T_VARIABLE","$entity_type",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","vocabulary",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","id",55],"(",")",",",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'default'",55],")",["T_WHITESPACE","\n      ",55],["T_OBJECT_OPERATOR","->",56],["T_STRING","setComponent",56],"(",["T_VARIABLE","$name",56],",",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",["T_WHITESPACE","\n        ",56],["T_CONSTANT_ENCAPSED_STRING","'type'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'image'",57],",",["T_WHITESPACE","\n        ",57],["T_CONSTANT_ENCAPSED_STRING","'settings'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",")",",",["T_WHITESPACE","\n      ",58],")",")",["T_WHITESPACE","\n      ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","save",60],"(",")",";",["T_WHITESPACE","\n    ",60],["T_STRING","entity_get_form_display",61],"(",["T_VARIABLE","$entity_type",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","vocabulary",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","id",61],"(",")",",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'default'",61],")",["T_WHITESPACE","\n      ",61],["T_OBJECT_OPERATOR","->",62],["T_STRING","setComponent",62],"(",["T_VARIABLE","$name",62],",",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_WHITESPACE","\n        ",62],["T_CONSTANT_ENCAPSED_STRING","'type'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'image_image'",63],",",["T_WHITESPACE","\n        ",63],["T_CONSTANT_ENCAPSED_STRING","'settings'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",",",["T_WHITESPACE","\n      ",64],")",")",["T_WHITESPACE","\n      ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","save",66],"(",")",";",["T_WHITESPACE","\n  ",66],"}",["T_WHITESPACE","\n\n  ",67],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","testTaxonomyImageAccess",69],"(",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$user",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","drupalCreateUser",70],"(",["T_ARRAY","array",70],"(",["T_CONSTANT_ENCAPSED_STRING","'administer site configuration'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'administer taxonomy'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",70],")",")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","drupalLogin",71],"(",["T_VARIABLE","$user",71],")",";",["T_WHITESPACE","\n\n    ",71],["T_COMMENT","\/\/ Create a term and upload the image.\n",73],["T_WHITESPACE","    ",74],["T_VARIABLE","$files",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","drupalGetTestFiles",74],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$image",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","array_pop",75],"(",["T_VARIABLE","$files",75],")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$edit",76],"[",["T_CONSTANT_ENCAPSED_STRING","'name[0][value]'",76],"]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","randomMachineName",76],"(",")",";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$edit",77],"[",["T_CONSTANT_ENCAPSED_STRING","'files[field_test_0]'",77],"]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","drupal_realpath",77],"(",["T_VARIABLE","$image",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","uri",77],")",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","drupalPostForm",78],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/structure\/taxonomy\/manage\/'",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","vocabulary",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","id",78],"(",")",["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'\/add'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$edit",78],",",["T_WHITESPACE"," ",78],["T_STRING","t",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",78],")",")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","drupalPostForm",79],"(",["T_STRING","NULL",79],",",["T_WHITESPACE"," ",79],"[",["T_CONSTANT_ENCAPSED_STRING","'field_test[0][alt]'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","randomMachineName",79],"(",")","]",",",["T_WHITESPACE"," ",79],["T_STRING","t",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",79],")",")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$terms",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","entity_load_multiple_by_properties",80],"(",["T_CONSTANT_ENCAPSED_STRING","'taxonomy_term'",80],",",["T_WHITESPACE"," ",80],["T_ARRAY","array",80],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$edit",80],"[",["T_CONSTANT_ENCAPSED_STRING","'name[0][value]'",80],"]",")",")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$term",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","reset",81],"(",["T_VARIABLE","$terms",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertText",82],"(",["T_STRING","t",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Created new term @name.'",82],",",["T_WHITESPACE"," ",82],["T_ARRAY","array",82],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$term",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getName",82],"(",")",")",")",")",";",["T_WHITESPACE","\n\n    ",82],["T_COMMENT","\/\/ Create a user that should have access to the file and one that doesn't.\n",84],["T_WHITESPACE","    ",85],["T_VARIABLE","$access_user",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","drupalCreateUser",85],"(",["T_ARRAY","array",85],"(",["T_CONSTANT_ENCAPSED_STRING","'access content'",85],")",")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$no_access_user",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","drupalCreateUser",86],"(",")",";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$image",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","File",87],["T_DOUBLE_COLON","::",87],["T_STRING","load",87],"(",["T_VARIABLE","$term",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","field_test",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","target_id",87],")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","drupalLogin",88],"(",["T_VARIABLE","$access_user",88],")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","drupalGet",89],"(",["T_STRING","file_create_url",89],"(",["T_VARIABLE","$image",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getFileUri",89],"(",")",")",")",";",["T_WHITESPACE","\n    ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertResponse",90],"(",["T_LNUMBER","200",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'Private image on term is accessible with right permission'",90],")",";",["T_WHITESPACE","\n\n    ",90],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","drupalLogin",92],"(",["T_VARIABLE","$no_access_user",92],")",";",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","drupalGet",93],"(",["T_STRING","file_create_url",93],"(",["T_VARIABLE","$image",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getFileUri",93],"(",")",")",")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertResponse",94],"(",["T_LNUMBER","403",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'Private image on term not accessible without right permission'",94],")",";",["T_WHITESPACE","\n  ",94],"}",["T_WHITESPACE","\n\n",95],"}",["T_WHITESPACE","\n",97]]