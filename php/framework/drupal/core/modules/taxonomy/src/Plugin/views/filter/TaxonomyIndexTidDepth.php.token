[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","taxonomy",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","views",3],["T_NS_SEPARATOR","\\",3],["T_STRING","filter",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Form",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FormStateInterface",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Filter handler for taxonomy terms with depth.\n *\n * This handler is actually part of the node table and has some restrictions,\n * because it uses a subquery to find nodes with.\n *\n * @ingroup views_filter_handlers\n *\n * @ViewsFilter(\"taxonomy_index_tid_depth\")\n *\/",7],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","TaxonomyIndexTidDepth",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_STRING","TaxonomyIndexTid",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\n  ",17],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_FUNCTION","function",19],["T_WHITESPACE"," ",19],["T_STRING","operatorOptions",19],"(",["T_VARIABLE","$which",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'title'",19],")",["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n    ",19],["T_RETURN","return",20],["T_WHITESPACE"," ",20],["T_ARRAY","array",20],"(",["T_WHITESPACE","\n      ",20],["T_CONSTANT_ENCAPSED_STRING","'or'",21],["T_WHITESPACE"," ",21],["T_DOUBLE_ARROW","=>",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","t",21],"(",["T_CONSTANT_ENCAPSED_STRING","'Is one of'",21],")",",",["T_WHITESPACE","\n    ",21],")",";",["T_WHITESPACE","\n  ",22],"}",["T_WHITESPACE","\n\n  ",23],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","defineOptions",25],"(",")",["T_WHITESPACE"," ",25],"{",["T_WHITESPACE","\n    ",25],["T_VARIABLE","$options",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_STRING","parent",26],["T_DOUBLE_COLON","::",26],["T_STRING","defineOptions",26],"(",")",";",["T_WHITESPACE","\n\n    ",26],["T_VARIABLE","$options",28],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",28],"]",["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_ARRAY","array",28],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",28],["T_WHITESPACE"," ",28],["T_DOUBLE_ARROW","=>",28],["T_WHITESPACE"," ",28],["T_LNUMBER","0",28],")",";",["T_WHITESPACE","\n\n    ",28],["T_RETURN","return",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$options",30],";",["T_WHITESPACE","\n  ",30],"}",["T_WHITESPACE","\n\n  ",31],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","buildExtraOptionsForm",33],"(","&",["T_VARIABLE","$form",33],",",["T_WHITESPACE"," ",33],["T_STRING","FormStateInterface",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$form_state",33],")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_STRING","parent",34],["T_DOUBLE_COLON","::",34],["T_STRING","buildExtraOptionsForm",34],"(",["T_VARIABLE","$form",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$form_state",34],")",";",["T_WHITESPACE","\n\n    ",34],["T_VARIABLE","$form",36],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",36],"]",["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_ARRAY","array",36],"(",["T_WHITESPACE","\n      ",36],["T_CONSTANT_ENCAPSED_STRING","'#type'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'weight'",37],",",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'#title'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","t",38],"(",["T_CONSTANT_ENCAPSED_STRING","'Depth'",38],")",",",["T_WHITESPACE","\n      ",38],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","options",39],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",39],"]",",",["T_WHITESPACE","\n      ",39],["T_CONSTANT_ENCAPSED_STRING","'#description'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","t",40],"(",["T_CONSTANT_ENCAPSED_STRING","'The depth will match nodes tagged with terms in the hierarchy. For example, if you have the term \"fruit\" and a child term \"apple\", with a depth of 1 (or higher) then filtering for the term \"fruit\" will get nodes that are tagged with \"apple\" as well as \"fruit\". If negative, the reverse is true; searching for \"apple\" will also pick up nodes tagged with \"fruit\" if depth is -1 (or lower).'",40],")",",",["T_WHITESPACE","\n    ",40],")",";",["T_WHITESPACE","\n  ",41],"}",["T_WHITESPACE","\n\n  ",42],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","query",44],"(",")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n    ",44],["T_COMMENT","\/\/ If no filter values are present, then do nothing.\n",45],["T_WHITESPACE","    ",46],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_STRING","count",46],"(",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","value",46],")",["T_WHITESPACE"," ",46],["T_IS_EQUAL","==",46],["T_WHITESPACE"," ",46],["T_LNUMBER","0",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n      ",46],["T_RETURN","return",47],";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n    ",48],["T_ELSEIF","elseif",49],["T_WHITESPACE"," ",49],"(",["T_STRING","count",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","value",49],")",["T_WHITESPACE"," ",49],["T_IS_EQUAL","==",49],["T_WHITESPACE"," ",49],["T_LNUMBER","1",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n      ",49],["T_COMMENT","\/\/ Sometimes $this->value is an array with a single element so convert it.\n",50],["T_WHITESPACE","      ",51],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_STRING","is_array",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","value",51],")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","value",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","current",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","value",52],")",";",["T_WHITESPACE","\n      ",52],"}",["T_WHITESPACE","\n      ",53],["T_VARIABLE","$operator",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'='",54],";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n    ",55],["T_ELSE","else",56],["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n      ",56],["T_VARIABLE","$operator",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'IN'",57],";",["T_COMMENT","# \" IN (\" . implode(', ', array_fill(0, sizeof($this->value), '%d')) . \")\";\n",57],["T_WHITESPACE","    ",58],"}",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ The normal use of ensureMyTable() here breaks Views.\n",60],["T_WHITESPACE","    ",61],["T_COMMENT","\/\/ So instead we trick the filter into using the alias of the base table.\n",61],["T_WHITESPACE","    ",62],["T_COMMENT","\/\/   See https:\/\/www.drupal.org\/node\/271833.\n",62],["T_WHITESPACE","    ",63],["T_COMMENT","\/\/ If a relationship is set, we must use the alias it provides.\n",63],["T_WHITESPACE","    ",64],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_EMPTY","empty",64],"(",["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","relationship",64],")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n      ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","tableAlias",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","relationship",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n    ",66],["T_COMMENT","\/\/ If no relationship, then use the alias of the base table.\n",67],["T_WHITESPACE","    ",68],["T_ELSE","else",68],["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n      ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","tableAlias",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","query",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","ensureTable",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","view",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","storage",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","get",69],"(",["T_CONSTANT_ENCAPSED_STRING","'base_table'",69],")",")",";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/\/ Now build the subqueries.\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$subquery",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","db_select",73],"(",["T_CONSTANT_ENCAPSED_STRING","'taxonomy_index'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'tn'",73],")",";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$subquery",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","addField",74],"(",["T_CONSTANT_ENCAPSED_STRING","'tn'",74],",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'nid'",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$where",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","db_or",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","condition",75],"(",["T_CONSTANT_ENCAPSED_STRING","'tn.tid'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","value",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$operator",75],")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$last",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","\"tn\"",76],";",["T_WHITESPACE","\n\n    ",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","options",78],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",78],"]",["T_WHITESPACE"," ",78],">",["T_WHITESPACE"," ",78],["T_LNUMBER","0",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n      ",78],["T_VARIABLE","$subquery",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","leftJoin",79],"(",["T_CONSTANT_ENCAPSED_STRING","'taxonomy_term_hierarchy'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'th'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","\"th.tid = tn.tid\"",79],")",";",["T_WHITESPACE","\n      ",79],["T_VARIABLE","$last",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"th\"",80],";",["T_WHITESPACE","\n      ",80],["T_FOREACH","foreach",81],["T_WHITESPACE"," ",81],"(",["T_STRING","range",81],"(",["T_LNUMBER","1",81],",",["T_WHITESPACE"," ",81],["T_STRING","abs",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","options",81],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",81],"]",")",")",["T_WHITESPACE"," ",81],["T_AS","as",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$count",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$subquery",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","leftJoin",82],"(",["T_CONSTANT_ENCAPSED_STRING","'taxonomy_term_hierarchy'",82],",",["T_WHITESPACE"," ",82],"\"",["T_ENCAPSED_AND_WHITESPACE","th",82],["T_VARIABLE","$count",82],"\"",",",["T_WHITESPACE"," ",82],"\"",["T_VARIABLE","$last",82],["T_ENCAPSED_AND_WHITESPACE",".parent = th",82],["T_VARIABLE","$count",82],["T_ENCAPSED_AND_WHITESPACE",".tid",82],"\"",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$where",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","condition",83],"(","\"",["T_ENCAPSED_AND_WHITESPACE","th",83],["T_VARIABLE","$count",83],["T_ENCAPSED_AND_WHITESPACE",".tid",83],"\"",",",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","value",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$operator",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$last",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],"\"",["T_ENCAPSED_AND_WHITESPACE","th",84],["T_VARIABLE","$count",84],"\"",";",["T_WHITESPACE","\n      ",84],"}",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n    ",86],["T_ELSEIF","elseif",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","options",87],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",87],"]",["T_WHITESPACE"," ",87],"<",["T_WHITESPACE"," ",87],["T_LNUMBER","0",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_FOREACH","foreach",88],["T_WHITESPACE"," ",88],"(",["T_STRING","range",88],"(",["T_LNUMBER","1",88],",",["T_WHITESPACE"," ",88],["T_STRING","abs",88],"(",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","options",88],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",88],"]",")",")",["T_WHITESPACE"," ",88],["T_AS","as",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$count",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$subquery",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","leftJoin",89],"(",["T_CONSTANT_ENCAPSED_STRING","'taxonomy_term_hierarchy'",89],",",["T_WHITESPACE"," ",89],"\"",["T_ENCAPSED_AND_WHITESPACE","th",89],["T_VARIABLE","$count",89],"\"",",",["T_WHITESPACE"," ",89],"\"",["T_VARIABLE","$last",89],["T_ENCAPSED_AND_WHITESPACE",".tid = th",89],["T_VARIABLE","$count",89],["T_ENCAPSED_AND_WHITESPACE",".parent",89],"\"",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$where",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","condition",90],"(","\"",["T_ENCAPSED_AND_WHITESPACE","th",90],["T_VARIABLE","$count",90],["T_ENCAPSED_AND_WHITESPACE",".tid",90],"\"",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","value",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$operator",90],")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$last",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],"\"",["T_ENCAPSED_AND_WHITESPACE","th",91],["T_VARIABLE","$count",91],"\"",";",["T_WHITESPACE","\n      ",91],"}",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_VARIABLE","$subquery",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","condition",95],"(",["T_VARIABLE","$where",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","query",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","addWhere",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","options",96],"[",["T_CONSTANT_ENCAPSED_STRING","'group'",96],"]",",",["T_WHITESPACE"," ",96],"\"",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","tableAlias",96],["T_ENCAPSED_AND_WHITESPACE",".",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","realField",96],"\"",",",["T_WHITESPACE"," ",96],["T_VARIABLE","$subquery",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'IN'",96],")",";",["T_WHITESPACE","\n  ",96],"}",["T_WHITESPACE","\n\n",97],"}",["T_WHITESPACE","\n",99]]