[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate_drupal_ui",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","migrate",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],["T_NS_SEPARATOR","\\",6],["T_STRING","MigrateIdMapInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","migrate_drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","MigrationConfigurationTrait",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","simpletest",8],["T_NS_SEPARATOR","\\",8],["T_STRING","WebTestBase",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Provides a base class for testing migration upgrades in the UI.\n *\/",10],["T_WHITESPACE","\n",12],["T_ABSTRACT","abstract",13],["T_WHITESPACE"," ",13],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","MigrateUpgradeTestBase",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","WebTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n  ",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","MigrationConfigurationTrait",14],";",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * Use the Standard profile to test help implementations of many core modules.\n   *\/",16],["T_WHITESPACE","\n  ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$profile",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'standard'",19],";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * The source database connection.\n   *\n   * @var \\Drupal\\Core\\Database\\Connection\n   *\/",21],["T_WHITESPACE","\n  ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$sourceDatabase",26],";",["T_WHITESPACE","\n\n  ",26],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",28],["T_WHITESPACE","\n  ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_STATIC","static",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$modules",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],"[",["T_CONSTANT_ENCAPSED_STRING","'language'",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'content_translation'",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'migrate_drupal_ui'",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'telephone'",33],"]",";",["T_WHITESPACE","\n\n  ",33],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",35],["T_WHITESPACE","\n  ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","setUp",38],"(",")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n    ",38],["T_STRING","parent",39],["T_DOUBLE_COLON","::",39],["T_STRING","setUp",39],"(",")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","createMigrationConnection",40],"(",")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","sourceDatabase",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","Database",41],["T_DOUBLE_COLON","::",41],["T_STRING","getConnection",41],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'migrate_drupal_ui'",41],")",";",["T_WHITESPACE","\n\n    ",41],["T_COMMENT","\/\/ Log in as user 1. Migrations in the UI can only be performed as user 1.\n",43],["T_WHITESPACE","    ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","drupalLogin",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","rootUser",44],")",";",["T_WHITESPACE","\n  ",44],"}",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * Loads a database fixture into the source database connection.\n   *\n   * @param string $path\n   *   Path to the dump file.\n   *\/",47],["T_WHITESPACE","\n  ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","loadFixture",53],"(",["T_VARIABLE","$path",53],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$default_db",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","Database",54],["T_DOUBLE_COLON","::",54],["T_STRING","getConnection",54],"(",")",["T_OBJECT_OPERATOR","->",54],["T_STRING","getKey",54],"(",")",";",["T_WHITESPACE","\n    ",54],["T_STRING","Database",55],["T_DOUBLE_COLON","::",55],["T_STRING","setActiveConnection",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","sourceDatabase",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getKey",55],"(",")",")",";",["T_WHITESPACE","\n\n    ",55],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_STRING","substr",57],"(",["T_VARIABLE","$path",57],",",["T_WHITESPACE"," ",57],"-",["T_LNUMBER","3",57],")",["T_WHITESPACE"," ",57],["T_IS_EQUAL","==",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'.gz'",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n      ",57],["T_VARIABLE","$path",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'compress.zlib:\/\/'",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_VARIABLE","$path",58],";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n    ",59],["T_REQUIRE","require",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$path",60],";",["T_WHITESPACE","\n\n    ",60],["T_STRING","Database",62],["T_DOUBLE_COLON","::",62],["T_STRING","setActiveConnection",62],"(",["T_VARIABLE","$default_db",62],")",";",["T_WHITESPACE","\n  ",62],"}",["T_WHITESPACE","\n\n  ",63],["T_DOC_COMMENT","\/**\n   * Changes the database connection to the prefixed one.\n   *\n   * @todo Remove when we don't use global. https:\/\/www.drupal.org\/node\/2552791\n   *\/",65],["T_WHITESPACE","\n  ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","createMigrationConnection",70],"(",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$connection_info",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","Database",71],["T_DOUBLE_COLON","::",71],["T_STRING","getConnectionInfo",71],"(",["T_CONSTANT_ENCAPSED_STRING","'default'",71],")","[",["T_CONSTANT_ENCAPSED_STRING","'default'",71],"]",";",["T_WHITESPACE","\n    ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$connection_info",72],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",72],"]",["T_WHITESPACE"," ",72],["T_IS_IDENTICAL","===",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n      ",72],["T_COMMENT","\/\/ Create database file in the test site's public file directory so that\n",73],["T_WHITESPACE","      ",74],["T_COMMENT","\/\/ \\Drupal\\simpletest\\TestBase::restoreEnvironment() will delete this once\n",74],["T_WHITESPACE","      ",75],["T_COMMENT","\/\/ the test is complete.\n",75],["T_WHITESPACE","      ",76],["T_VARIABLE","$file",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","publicFilesDirectory",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'\/'",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","testId",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'-migrate.db.sqlite'",76],";",["T_WHITESPACE","\n      ",76],["T_STRING","touch",77],"(",["T_VARIABLE","$file",77],")",";",["T_WHITESPACE","\n      ",77],["T_VARIABLE","$connection_info",78],"[",["T_CONSTANT_ENCAPSED_STRING","'database'",78],"]",["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$file",78],";",["T_WHITESPACE","\n      ",78],["T_VARIABLE","$connection_info",79],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",79],"]",["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","''",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n    ",80],["T_ELSE","else",81],["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n      ",81],["T_VARIABLE","$prefix",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","is_array",82],"(",["T_VARIABLE","$connection_info",82],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",82],"]",")",["T_WHITESPACE"," ",82],"?",["T_WHITESPACE"," ",82],["T_VARIABLE","$connection_info",82],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",82],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default'",82],"]",["T_WHITESPACE"," ",82],":",["T_WHITESPACE"," ",82],["T_VARIABLE","$connection_info",82],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",82],"]",";",["T_WHITESPACE","\n      ",82],["T_COMMENT","\/\/ Simpletest uses fixed length prefixes. Create a new prefix for the\n",83],["T_WHITESPACE","      ",84],["T_COMMENT","\/\/ source database. Adding to the end of the prefix ensures that\n",84],["T_WHITESPACE","      ",85],["T_COMMENT","\/\/ \\Drupal\\simpletest\\TestBase::restoreEnvironment() will remove the\n",85],["T_WHITESPACE","      ",86],["T_COMMENT","\/\/ additional tables.\n",86],["T_WHITESPACE","      ",87],["T_VARIABLE","$connection_info",87],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",87],"]",["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$prefix",87],["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'0'",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_STRING","Database",90],["T_DOUBLE_COLON","::",90],["T_STRING","addConnectionInfo",90],"(",["T_CONSTANT_ENCAPSED_STRING","'migrate_drupal_ui'",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'default'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$connection_info",90],")",";",["T_WHITESPACE","\n  ",90],"}",["T_WHITESPACE","\n\n  ",91],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",93],["T_WHITESPACE","\n  ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","tearDown",96],"(",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n    ",96],["T_STRING","Database",97],["T_DOUBLE_COLON","::",97],["T_STRING","removeConnection",97],"(",["T_CONSTANT_ENCAPSED_STRING","'migrate_drupal_ui'",97],")",";",["T_WHITESPACE","\n    ",97],["T_STRING","parent",98],["T_DOUBLE_COLON","::",98],["T_STRING","tearDown",98],"(",")",";",["T_WHITESPACE","\n  ",98],"}",["T_WHITESPACE","\n\n  ",99],["T_DOC_COMMENT","\/**\n   * Executes all steps of migrations upgrade.\n   *\/",101],["T_WHITESPACE","\n  ",103],["T_PROTECTED","protected",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","testMigrateUpgrade",104],"(",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$connection_options",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","sourceDatabase",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getConnectionOptions",105],"(",")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","drupalGet",106],"(",["T_CONSTANT_ENCAPSED_STRING","'\/upgrade'",106],")",";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","assertText",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Upgrade a site by importing it into a clean and empty new install of Drupal 8. You will lose any existing configuration once you import your site into it. See the online documentation for Drupal site upgrades for more detailed information.'",107],")",";",["T_WHITESPACE","\n\n    ",107],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","drupalPostForm",109],"(",["T_STRING","NULL",109],",",["T_WHITESPACE"," ",109],"[","]",",",["T_WHITESPACE"," ",109],["T_STRING","t",109],"(",["T_CONSTANT_ENCAPSED_STRING","'Continue'",109],")",")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertText",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Provide credentials for the database of the Drupal site you want to upgrade.'",110],")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","assertFieldByName",111],"(",["T_CONSTANT_ENCAPSED_STRING","'mysql[host]'",111],")",";",["T_WHITESPACE","\n\n    ",111],["T_VARIABLE","$driver",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$connection_options",113],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",113],"]",";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$connection_options",114],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",114],"]",["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$connection_options",114],"[",["T_CONSTANT_ENCAPSED_STRING","'prefix'",114],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default'",114],"]",";",["T_WHITESPACE","\n\n    ",114],["T_COMMENT","\/\/ Use the driver connection form to get the correct options out of the\n",116],["T_WHITESPACE","    ",117],["T_COMMENT","\/\/ database settings. This supports all of the databases we test against.\n",117],["T_WHITESPACE","    ",118],["T_VARIABLE","$drivers",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","drupal_get_database_types",118],"(",")",";",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$form",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$drivers",119],"[",["T_VARIABLE","$driver",119],"]",["T_OBJECT_OPERATOR","->",119],["T_STRING","getFormOptions",119],"(",["T_VARIABLE","$connection_options",119],")",";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$connection_options",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","array_intersect_key",120],"(",["T_VARIABLE","$connection_options",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$form",120],["T_WHITESPACE"," ",120],"+",["T_WHITESPACE"," ",120],["T_VARIABLE","$form",120],"[",["T_CONSTANT_ENCAPSED_STRING","'advanced_options'",120],"]",")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$edit",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],"[",["T_WHITESPACE","\n      ",121],["T_VARIABLE","$driver",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$connection_options",122],",",["T_WHITESPACE","\n      ",122],["T_CONSTANT_ENCAPSED_STRING","'source_base_path'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getSourceBasePath",123],"(",")",",",["T_WHITESPACE","\n    ",123],"]",";",["T_WHITESPACE","\n    ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_STRING","count",125],"(",["T_VARIABLE","$drivers",125],")",["T_WHITESPACE"," ",125],["T_IS_NOT_IDENTICAL","!==",125],["T_WHITESPACE"," ",125],["T_LNUMBER","1",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n      ",125],["T_VARIABLE","$edit",126],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",126],"]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$driver",126],";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n    ",127],["T_VARIABLE","$edits",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","translatePostValues",128],"(",["T_VARIABLE","$edit",128],")",";",["T_WHITESPACE","\n\n    ",128],["T_COMMENT","\/\/ Ensure submitting the form with invalid database credentials gives us a\n",130],["T_WHITESPACE","    ",131],["T_COMMENT","\/\/ nice warning.\n",131],["T_WHITESPACE","    ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","drupalPostForm",132],"(",["T_STRING","NULL",132],",",["T_WHITESPACE"," ",132],"[",["T_VARIABLE","$driver",132],["T_WHITESPACE"," ",132],".",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'[database]'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'wrong'",132],"]",["T_WHITESPACE"," ",132],"+",["T_WHITESPACE"," ",132],["T_VARIABLE","$edits",132],",",["T_WHITESPACE"," ",132],["T_STRING","t",132],"(",["T_CONSTANT_ENCAPSED_STRING","'Review upgrade'",132],")",")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","assertText",133],"(",["T_CONSTANT_ENCAPSED_STRING","'Resolve the issue below to continue the upgrade.'",133],")",";",["T_WHITESPACE","\n\n    ",133],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","drupalPostForm",135],"(",["T_STRING","NULL",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$edits",135],",",["T_WHITESPACE"," ",135],["T_STRING","t",135],"(",["T_CONSTANT_ENCAPSED_STRING","'Review upgrade'",135],")",")",";",["T_WHITESPACE","\n    ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertResponse",136],"(",["T_LNUMBER","200",136],")",";",["T_WHITESPACE","\n    ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertText",137],"(",["T_CONSTANT_ENCAPSED_STRING","'Are you sure?'",137],")",";",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","drupalPostForm",138],"(",["T_STRING","NULL",138],",",["T_WHITESPACE"," ",138],"[","]",",",["T_WHITESPACE"," ",138],["T_STRING","t",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Perform upgrade'",138],")",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertText",139],"(",["T_STRING","t",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Congratulations, you upgraded Drupal!'",139],")",")",";",["T_WHITESPACE","\n\n    ",139],["T_COMMENT","\/\/ Have to reset all the statics after migration to ensure entities are\n",141],["T_WHITESPACE","    ",142],["T_COMMENT","\/\/ loadable.\n",142],["T_WHITESPACE","    ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","resetAll",143],"(",")",";",["T_WHITESPACE","\n\n    ",143],["T_VARIABLE","$expected_counts",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getEntityCounts",145],"(",")",";",["T_WHITESPACE","\n    ",145],["T_FOREACH","foreach",146],["T_WHITESPACE"," ",146],"(",["T_STRING","array_keys",146],"(",["T_NS_SEPARATOR","\\",146],["T_STRING","Drupal",146],["T_DOUBLE_COLON","::",146],["T_STRING","entityTypeManager",146],"(",")",["T_OBJECT_OPERATOR","->",146],["T_STRING","getDefinitions",146],"(",")",")",["T_WHITESPACE"," ",146],["T_AS","as",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$entity_type",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n      ",146],["T_VARIABLE","$real_count",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","count",147],"(",["T_NS_SEPARATOR","\\",147],["T_STRING","Drupal",147],["T_DOUBLE_COLON","::",147],["T_STRING","entityTypeManager",147],"(",")",["T_OBJECT_OPERATOR","->",147],["T_STRING","getStorage",147],"(",["T_VARIABLE","$entity_type",147],")",["T_OBJECT_OPERATOR","->",147],["T_STRING","loadMultiple",147],"(",")",")",";",["T_WHITESPACE","\n      ",147],["T_VARIABLE","$expected_count",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_ISSET","isset",148],"(",["T_VARIABLE","$expected_counts",148],"[",["T_VARIABLE","$entity_type",148],"]",")",["T_WHITESPACE"," ",148],"?",["T_WHITESPACE"," ",148],["T_VARIABLE","$expected_counts",148],"[",["T_VARIABLE","$entity_type",148],"]",["T_WHITESPACE"," ",148],":",["T_WHITESPACE"," ",148],["T_LNUMBER","0",148],";",["T_WHITESPACE","\n      ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","assertEqual",149],"(",["T_VARIABLE","$expected_count",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$real_count",149],",",["T_WHITESPACE"," ",149],"\"",["T_ENCAPSED_AND_WHITESPACE","Found ",149],["T_VARIABLE","$real_count",149],["T_ENCAPSED_AND_WHITESPACE"," ",149],["T_VARIABLE","$entity_type",149],["T_ENCAPSED_AND_WHITESPACE"," entities, expected ",149],["T_VARIABLE","$expected_count",149],["T_ENCAPSED_AND_WHITESPACE",".",149],"\"",")",";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_VARIABLE","$version_tag",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'Drupal '",152],["T_WHITESPACE"," ",152],".",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getLegacyDrupalVersion",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","sourceDatabase",152],")",";",["T_WHITESPACE","\n    ",152],["T_VARIABLE","$plugin_manager",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_NS_SEPARATOR","\\",153],["T_STRING","Drupal",153],["T_DOUBLE_COLON","::",153],["T_STRING","service",153],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.migration'",153],")",";",["T_WHITESPACE","\n    ",153],["T_DOC_COMMENT","\/** @var \\Drupal\\migrate\\Plugin\\Migration[] $all_migrations *\/",154],["T_WHITESPACE","\n    ",154],["T_VARIABLE","$all_migrations",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$plugin_manager",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","createInstancesByTag",155],"(",["T_VARIABLE","$version_tag",155],")",";",["T_WHITESPACE","\n    ",155],["T_FOREACH","foreach",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$all_migrations",156],["T_WHITESPACE"," ",156],["T_AS","as",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$migration",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n      ",156],["T_VARIABLE","$id_map",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$migration",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getIdMap",157],"(",")",";",["T_WHITESPACE","\n      ",157],["T_FOREACH","foreach",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$id_map",158],["T_WHITESPACE"," ",158],["T_AS","as",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$source_id",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$map",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n        ",158],["T_COMMENT","\/\/ Convert $source_id into a keyless array so that\n",159],["T_WHITESPACE","        ",160],["T_COMMENT","\/\/ \\Drupal\\migrate\\Plugin\\migrate\\id_map\\Sql::getSourceHash() works as\n",160],["T_WHITESPACE","        ",161],["T_COMMENT","\/\/ expected.\n",161],["T_WHITESPACE","        ",162],["T_VARIABLE","$source_id_values",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","array_values",162],"(",["T_STRING","unserialize",162],"(",["T_VARIABLE","$source_id",162],")",")",";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$row",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$id_map",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getRowBySource",163],"(",["T_VARIABLE","$source_id_values",163],")",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$destination",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","serialize",164],"(",["T_VARIABLE","$id_map",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","currentDestination",164],"(",")",")",";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$message",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],"\"",["T_ENCAPSED_AND_WHITESPACE","Successful migration of ",165],["T_VARIABLE","$source_id",165],["T_ENCAPSED_AND_WHITESPACE"," to ",165],["T_VARIABLE","$destination",165],["T_ENCAPSED_AND_WHITESPACE"," as part of the ",165],["T_CURLY_OPEN","{",165],["T_VARIABLE","$migration",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","id",165],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," migration. The source row status is ",165],"\"",["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$row",165],"[",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",165],"]",";",["T_WHITESPACE","\n        ",165],["T_COMMENT","\/\/ A completed migration should have maps with\n",166],["T_WHITESPACE","        ",167],["T_COMMENT","\/\/ MigrateIdMapInterface::STATUS_IGNORED or\n",167],["T_WHITESPACE","        ",168],["T_COMMENT","\/\/ MigrateIdMapInterface::STATUS_IMPORTED.\n",168],["T_WHITESPACE","        ",169],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$row",169],"[",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",169],"]",["T_WHITESPACE"," ",169],["T_IS_EQUAL","==",169],["T_WHITESPACE"," ",169],["T_STRING","MigrateIdMapInterface",169],["T_DOUBLE_COLON","::",169],["T_STRING","STATUS_FAILED",169],["T_WHITESPACE"," ",169],["T_BOOLEAN_OR","||",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$row",169],"[",["T_CONSTANT_ENCAPSED_STRING","'source_row_status'",169],"]",["T_WHITESPACE"," ",169],["T_IS_EQUAL","==",169],["T_WHITESPACE"," ",169],["T_STRING","MigrateIdMapInterface",169],["T_DOUBLE_COLON","::",169],["T_STRING","STATUS_NEEDS_UPDATE",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n          ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","fail",170],"(",["T_VARIABLE","$message",170],")",";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n        ",171],["T_ELSE","else",172],["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n          ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","pass",173],"(",["T_VARIABLE","$message",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n      ",174],"}",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n    ",176],["T_NS_SEPARATOR","\\",177],["T_STRING","Drupal",177],["T_DOUBLE_COLON","::",177],["T_STRING","service",177],"(",["T_CONSTANT_ENCAPSED_STRING","'module_installer'",177],")",["T_OBJECT_OPERATOR","->",177],["T_STRING","install",177],"(","[",["T_CONSTANT_ENCAPSED_STRING","'forum'",177],"]",")",";",["T_WHITESPACE","\n  ",177],"}",["T_WHITESPACE","\n\n  ",178],["T_DOC_COMMENT","\/**\n   * Gets the source base path for the concrete test.\n   *\n   * @return string\n   *   The source base path.\n   *\/",180],["T_WHITESPACE","\n  ",185],["T_ABSTRACT","abstract",186],["T_WHITESPACE"," ",186],["T_PROTECTED","protected",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","getSourceBasePath",186],"(",")",";",["T_WHITESPACE","\n\n  ",186],["T_DOC_COMMENT","\/**\n   * Gets the expected number of entities per entity type after migration.\n   *\n   * @return int[]\n   *   An array of expected counts keyed by entity type ID.\n   *\/",188],["T_WHITESPACE","\n  ",193],["T_ABSTRACT","abstract",194],["T_WHITESPACE"," ",194],["T_PROTECTED","protected",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","getEntityCounts",194],"(",")",";",["T_WHITESPACE","\n\n",194],"}",["T_WHITESPACE","\n",196]]