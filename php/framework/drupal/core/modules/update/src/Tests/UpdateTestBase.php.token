[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","update",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DrupalKernel",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Url",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","simpletest",7],["T_NS_SEPARATOR","\\",7],["T_STRING","WebTestBase",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Defines some shared functions used by all update tests.\n *\n * The overarching methodology of these tests is we need to compare a given\n * state of installed modules and themes (e.g., version, project grouping,\n * timestamps, etc) against a current state of what the release history XML\n * files we fetch say is available. We have dummy XML files (in the\n * core\/modules\/update\/tests directory) that describe various scenarios of\n * what's available for different test projects, and we have dummy .info file\n * data (specified via hook_system_info_alter() in the update_test helper\n * module) describing what's currently installed. Each test case defines a set\n * of projects to install, their current state (via the\n * 'update_test_system_info' variable) and the desired available update data\n * (via the 'update_test_xml_map' variable), and then performs a series of\n * assertions that the report matches our expectations given the specific\n * initial state and availability scenario.\n *\/",9],["T_WHITESPACE","\n",25],["T_ABSTRACT","abstract",26],["T_WHITESPACE"," ",26],["T_CLASS","class",26],["T_WHITESPACE"," ",26],["T_STRING","UpdateTestBase",26],["T_WHITESPACE"," ",26],["T_EXTENDS","extends",26],["T_WHITESPACE"," ",26],["T_STRING","WebTestBase",26],["T_WHITESPACE"," ",26],"{",["T_WHITESPACE","\n\n  ",26],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","setUp",28],"(",")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n    ",28],["T_STRING","parent",29],["T_DOUBLE_COLON","::",29],["T_STRING","setUp",29],"(",")",";",["T_WHITESPACE","\n\n    ",29],["T_COMMENT","\/\/ Change the root path which Update Manager uses to install and update\n",31],["T_WHITESPACE","    ",32],["T_COMMENT","\/\/ projects to be inside the testing site directory. See\n",32],["T_WHITESPACE","    ",33],["T_COMMENT","\/\/ \\Drupal\\update\\UpdateRootFactory::get() for equivalent changes to the\n",33],["T_WHITESPACE","    ",34],["T_COMMENT","\/\/ test child site.\n",34],["T_WHITESPACE","    ",35],["T_VARIABLE","$request",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Drupal",35],["T_DOUBLE_COLON","::",35],["T_STRING","request",35],"(",")",";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$update_root",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","container",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","get",36],"(",["T_CONSTANT_ENCAPSED_STRING","'update.root'",36],")",["T_WHITESPACE"," ",36],".",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'\/'",36],["T_WHITESPACE"," ",36],".",["T_WHITESPACE"," ",36],["T_STRING","DrupalKernel",36],["T_DOUBLE_COLON","::",36],["T_STRING","findSitePath",36],"(",["T_VARIABLE","$request",36],")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","container",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","set",37],"(",["T_CONSTANT_ENCAPSED_STRING","'update.root'",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$update_root",37],")",";",["T_WHITESPACE","\n    ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Drupal",38],["T_DOUBLE_COLON","::",38],["T_STRING","setContainer",38],"(",["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","container",38],")",";",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/ Create the directories within the root path within which the Update\n",40],["T_WHITESPACE","    ",41],["T_COMMENT","\/\/ Manager will install projects.\n",41],["T_WHITESPACE","    ",42],["T_FOREACH","foreach",42],["T_WHITESPACE"," ",42],"(",["T_STRING","drupal_get_updaters",42],"(",")",["T_WHITESPACE"," ",42],["T_AS","as",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$updater_info",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n      ",42],["T_VARIABLE","$updater",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$updater_info",43],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",43],"]",";",["T_WHITESPACE","\n      ",43],["T_VARIABLE","$install_directory",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$update_root",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'\/'",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_VARIABLE","$updater",44],["T_DOUBLE_COLON","::",44],["T_STRING","getRootDirectoryRelativePath",44],"(",")",";",["T_WHITESPACE","\n      ",44],["T_IF","if",45],["T_WHITESPACE"," ",45],"(","!",["T_STRING","is_dir",45],"(",["T_VARIABLE","$install_directory",45],")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n        ",45],["T_STRING","mkdir",46],"(",["T_VARIABLE","$install_directory",46],")",";",["T_WHITESPACE","\n      ",46],"}",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n  ",48],"}",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * Refreshes the update status based on the desired available update scenario.\n   *\n   * @param $xml_map\n   *   Array that maps project names to availability scenarios to fetch. The key\n   *   '#all' is used if a project-specific mapping is not defined.\n   * @param $url\n   *   (optional) A string containing the URL to fetch update data from.\n   *   Defaults to 'update-test'.\n   *\n   * @see Drupal\\update_test\\Controller\\UpdateTestController::updateTest()\n   *\/",51],["T_WHITESPACE","\n  ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","refreshUpdateStatus",63],"(",["T_VARIABLE","$xml_map",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$url",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'update-test'",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_COMMENT","\/\/ Tell the Update Manager module to fetch from the URL provided by\n",64],["T_WHITESPACE","    ",65],["T_COMMENT","\/\/ update_test module.\n",65],["T_WHITESPACE","    ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","config",66],"(",["T_CONSTANT_ENCAPSED_STRING","'update.settings'",66],")",["T_OBJECT_OPERATOR","->",66],["T_STRING","set",66],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch.url'",66],",",["T_WHITESPACE"," ",66],["T_STRING","Url",66],["T_DOUBLE_COLON","::",66],["T_STRING","fromUri",66],"(",["T_CONSTANT_ENCAPSED_STRING","'base:'",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$url",66],",",["T_WHITESPACE"," ",66],["T_ARRAY","array",66],"(",["T_CONSTANT_ENCAPSED_STRING","'absolute'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_STRING","TRUE",66],")",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","toString",66],"(",")",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","save",66],"(",")",";",["T_WHITESPACE","\n    ",66],["T_COMMENT","\/\/ Save the map for UpdateTestController::updateTest() to use.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","config",68],"(",["T_CONSTANT_ENCAPSED_STRING","'update_test.settings'",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","set",68],"(",["T_CONSTANT_ENCAPSED_STRING","'xml_map'",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$xml_map",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","save",68],"(",")",";",["T_WHITESPACE","\n    ",68],["T_COMMENT","\/\/ Manually check the update status.\n",69],["T_WHITESPACE","    ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","drupalGet",70],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/reports\/updates'",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","clickLink",71],"(",["T_STRING","t",71],"(",["T_CONSTANT_ENCAPSED_STRING","'Check manually'",71],")",")",";",["T_WHITESPACE","\n  ",71],"}",["T_WHITESPACE","\n\n  ",72],["T_DOC_COMMENT","\/**\n   * Runs a series of assertions that are applicable to all update statuses.\n   *\/",74],["T_WHITESPACE","\n  ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","standardTests",77],"(",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertRaw",78],"(",["T_CONSTANT_ENCAPSED_STRING","'<h3>'",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_STRING","t",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal core'",78],")",["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'<\/h3>'",78],")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertRaw",79],"(",["T_NS_SEPARATOR","\\",79],["T_STRING","Drupal",79],["T_DOUBLE_COLON","::",79],["T_STRING","l",79],"(",["T_STRING","t",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal'",79],")",",",["T_WHITESPACE"," ",79],["T_STRING","Url",79],["T_DOUBLE_COLON","::",79],["T_STRING","fromUri",79],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/project\/drupal'",79],")",")",",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'Link to the Drupal project appears.'",79],")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","assertNoText",80],"(",["T_STRING","t",80],"(",["T_CONSTANT_ENCAPSED_STRING","'No available releases found'",80],")",")",";",["T_WHITESPACE","\n  ",80],"}",["T_WHITESPACE","\n\n",81],"}",["T_WHITESPACE","\n",83]]