[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","update",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Crypt",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Config",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ConfigFactoryInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","KeyValueStore",7],["T_NS_SEPARATOR","\\",7],["T_STRING","KeyValueFactoryInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","State",8],["T_NS_SEPARATOR","\\",8],["T_STRING","StateInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","PrivateKey",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Queue",10],["T_NS_SEPARATOR","\\",10],["T_STRING","QueueFactory",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Process project update information.\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","UpdateProcessor",15],["T_WHITESPACE"," ",15],["T_IMPLEMENTS","implements",15],["T_WHITESPACE"," ",15],["T_STRING","UpdateProcessorInterface",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * The update settings\n   *\n   * @var \\Drupal\\Core\\Config\\Config\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$updateSettings",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The UpdateFetcher service.\n   *\n   * @var \\Drupal\\update\\UpdateFetcherInterface\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$updateFetcher",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * The update fetch queue.\n   *\n   * @var \\Drupal\\Core\\Queue\\QueueInterface\n   *\/",31],["T_WHITESPACE","\n  ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$fetchQueue",36],";",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * Update key\/value store\n   *\n   * @var \\Drupal\\Core\\KeyValueStore\\KeyValueStoreExpirableInterface\n   *\/",38],["T_WHITESPACE","\n  ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$tempStore",43],";",["T_WHITESPACE","\n\n  ",43],["T_DOC_COMMENT","\/**\n   * Update Fetch Task Store\n   *\n   * @var \\Drupal\\Core\\KeyValueStore\\KeyValueStoreInterface\n   *\/",45],["T_WHITESPACE","\n  ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$fetchTaskStore",50],";",["T_WHITESPACE","\n\n  ",50],["T_DOC_COMMENT","\/**\n   * Update available releases store\n   *\n   * @var \\Drupal\\Core\\KeyValueStore\\KeyValueStoreExpirableInterface\n   *\/",52],["T_WHITESPACE","\n  ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$availableReleasesTempStore",57],";",["T_WHITESPACE","\n\n  ",57],["T_DOC_COMMENT","\/**\n   * Array of release history URLs that we have failed to fetch\n   *\n   * @var array\n   *\/",59],["T_WHITESPACE","\n  ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$failed",64],";",["T_WHITESPACE","\n\n  ",64],["T_DOC_COMMENT","\/**\n   * The state service.\n   *\n   * @var \\Drupal\\Core\\State\\StateInterface\n   *\/",66],["T_WHITESPACE","\n  ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$stateStore",71],";",["T_WHITESPACE","\n\n  ",71],["T_DOC_COMMENT","\/**\n   * The private key.\n   *\n   * @var \\Drupal\\Core\\PrivateKey\n   *\/",73],["T_WHITESPACE","\n  ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$privateKey",78],";",["T_WHITESPACE","\n\n  ",78],["T_DOC_COMMENT","\/**\n   * Constructs a UpdateProcessor.\n   *\n   * @param \\Drupal\\Core\\Config\\ConfigFactoryInterface $config_factory\n   *   The config factory.\n   * @param \\Drupal\\Core\\Queue\\QueueFactory $queue_factory\n   *   The queue factory\n   * @param \\Drupal\\update\\UpdateFetcherInterface $update_fetcher\n   *   The update fetcher service\n   * @param \\Drupal\\Core\\State\\StateInterface $state_store\n   *   The state service.\n   * @param \\Drupal\\Core\\PrivateKey $private_key\n   *   The private key factory service.\n   * @param \\Drupal\\Core\\KeyValueStore\\KeyValueFactoryInterface $key_value_factory\n   *   The key\/value factory.\n   * @param \\Drupal\\Core\\KeyValueStore\\KeyValueFactoryInterface $key_value_expirable_factory\n   *   The expirable key\/value factory.\n   *\/",80],["T_WHITESPACE","\n  ",97],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","__construct",98],"(",["T_STRING","ConfigFactoryInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$config_factory",98],",",["T_WHITESPACE"," ",98],["T_STRING","QueueFactory",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$queue_factory",98],",",["T_WHITESPACE"," ",98],["T_STRING","UpdateFetcherInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$update_fetcher",98],",",["T_WHITESPACE"," ",98],["T_STRING","StateInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$state_store",98],",",["T_WHITESPACE"," ",98],["T_STRING","PrivateKey",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$private_key",98],",",["T_WHITESPACE"," ",98],["T_STRING","KeyValueFactoryInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$key_value_factory",98],",",["T_WHITESPACE"," ",98],["T_STRING","KeyValueFactoryInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$key_value_expirable_factory",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","updateFetcher",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$update_fetcher",99],";",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","updateSettings",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$config_factory",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","get",100],"(",["T_CONSTANT_ENCAPSED_STRING","'update.settings'",100],")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","fetchQueue",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$queue_factory",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","get",101],"(",["T_CONSTANT_ENCAPSED_STRING","'update_fetch_tasks'",101],")",";",["T_WHITESPACE","\n    ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","tempStore",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$key_value_expirable_factory",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","get",102],"(",["T_CONSTANT_ENCAPSED_STRING","'update'",102],")",";",["T_WHITESPACE","\n    ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","fetchTaskStore",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$key_value_factory",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","get",103],"(",["T_CONSTANT_ENCAPSED_STRING","'update_fetch_task'",103],")",";",["T_WHITESPACE","\n    ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","availableReleasesTempStore",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$key_value_expirable_factory",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","get",104],"(",["T_CONSTANT_ENCAPSED_STRING","'update_available_releases'",104],")",";",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","stateStore",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$state_store",105],";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","privateKey",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$private_key",106],";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","fetchTasks",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_ARRAY","array",107],"(",")",";",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","failed",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_ARRAY","array",108],"(",")",";",["T_WHITESPACE","\n  ",108],"}",["T_WHITESPACE","\n\n  ",109],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",111],["T_WHITESPACE","\n  ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","createFetchTask",114],"(",["T_VARIABLE","$project",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n    ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_EMPTY","empty",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","fetchTasks",115],")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n      ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","fetchTasks",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","fetchTaskStore",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getAll",116],"(",")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n    ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_EMPTY","empty",118],"(",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","fetchTasks",118],"[",["T_VARIABLE","$project",118],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",118],"]","]",")",")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n      ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","fetchQueue",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","createItem",119],"(",["T_VARIABLE","$project",119],")",";",["T_WHITESPACE","\n      ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","fetchTaskStore",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","set",120],"(",["T_VARIABLE","$project",120],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",120],"]",",",["T_WHITESPACE"," ",120],["T_VARIABLE","$project",120],")",";",["T_WHITESPACE","\n      ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","fetchTasks",121],"[",["T_VARIABLE","$project",121],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",121],"]","]",["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","REQUEST_TIME",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n  ",122],"}",["T_WHITESPACE","\n\n  ",123],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",125],["T_WHITESPACE","\n  ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","fetchData",128],"(",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n    ",128],["T_VARIABLE","$end",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","time",129],"(",")",["T_WHITESPACE"," ",129],"+",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","updateSettings",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","get",129],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch.timeout'",129],")",";",["T_WHITESPACE","\n    ",129],["T_WHILE","while",130],["T_WHITESPACE"," ",130],"(",["T_STRING","time",130],"(",")",["T_WHITESPACE"," ",130],"<",["T_WHITESPACE"," ",130],["T_VARIABLE","$end",130],["T_WHITESPACE"," ",130],["T_BOOLEAN_AND","&&",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$item",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","fetchQueue",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","claimItem",130],"(",")",")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n      ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","processFetchTask",131],"(",["T_VARIABLE","$item",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","data",131],")",";",["T_WHITESPACE","\n      ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","fetchQueue",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","deleteItem",132],"(",["T_VARIABLE","$item",132],")",";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n  ",133],"}",["T_WHITESPACE","\n\n  ",134],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",136],["T_WHITESPACE","\n  ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","processFetchTask",139],"(",["T_VARIABLE","$project",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n    ",139],["T_GLOBAL","global",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$base_url",140],";",["T_WHITESPACE","\n\n    ",140],["T_COMMENT","\/\/ This can be in the middle of a long-running batch, so REQUEST_TIME won't\n",142],["T_WHITESPACE","    ",143],["T_COMMENT","\/\/ necessarily be valid.\n",143],["T_WHITESPACE","    ",144],["T_VARIABLE","$request_time_difference",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","time",144],"(",")",["T_WHITESPACE"," ",144],"-",["T_WHITESPACE"," ",144],["T_STRING","REQUEST_TIME",144],";",["T_WHITESPACE","\n    ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_EMPTY","empty",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","failed",145],")",")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n      ",145],["T_COMMENT","\/\/ If we have valid data about release history XML servers that we have\n",146],["T_WHITESPACE","      ",147],["T_COMMENT","\/\/ failed to fetch from on previous attempts, load that.\n",147],["T_WHITESPACE","      ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","failed",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","tempStore",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","get",148],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch_failures'",148],")",";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_VARIABLE","$max_fetch_attempts",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","updateSettings",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","get",151],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch.max_attempts'",151],")",";",["T_WHITESPACE","\n\n    ",151],["T_VARIABLE","$success",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_STRING","FALSE",153],";",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$available",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_ARRAY","array",154],"(",")",";",["T_WHITESPACE","\n    ",154],["T_VARIABLE","$site_key",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","Crypt",155],["T_DOUBLE_COLON","::",155],["T_STRING","hmacBase64",155],"(",["T_VARIABLE","$base_url",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","privateKey",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","get",155],"(",")",")",";",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$fetch_url_base",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","updateFetcher",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getFetchBaseUrl",156],"(",["T_VARIABLE","$project",156],")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$project_name",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$project",157],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",157],"]",";",["T_WHITESPACE","\n\n    ",157],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_EMPTY","empty",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","failed",159],"[",["T_VARIABLE","$fetch_url_base",159],"]",")",["T_WHITESPACE"," ",159],["T_BOOLEAN_OR","||",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","failed",159],"[",["T_VARIABLE","$fetch_url_base",159],"]",["T_WHITESPACE"," ",159],"<",["T_WHITESPACE"," ",159],["T_VARIABLE","$max_fetch_attempts",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n      ",159],["T_VARIABLE","$data",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","updateFetcher",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","fetchProjectData",160],"(",["T_VARIABLE","$project",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$site_key",160],")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n    ",161],["T_IF","if",162],["T_WHITESPACE"," ",162],"(","!",["T_EMPTY","empty",162],"(",["T_VARIABLE","$data",162],")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n      ",162],["T_VARIABLE","$available",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","parseXml",163],"(",["T_VARIABLE","$data",163],")",";",["T_WHITESPACE","\n      ",163],["T_COMMENT","\/\/ @todo: Purge release data we don't need. See\n",164],["T_WHITESPACE","      ",165],["T_COMMENT","\/\/   https:\/\/www.drupal.org\/node\/238950.\n",165],["T_WHITESPACE","      ",166],["T_IF","if",166],["T_WHITESPACE"," ",166],"(","!",["T_EMPTY","empty",166],"(",["T_VARIABLE","$available",166],")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n        ",166],["T_COMMENT","\/\/ Only if we fetched and parsed something sane do we return success.\n",167],["T_WHITESPACE","        ",168],["T_VARIABLE","$success",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","TRUE",168],";",["T_WHITESPACE","\n      ",168],"}",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n    ",170],["T_ELSE","else",171],["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n      ",171],["T_VARIABLE","$available",172],"[",["T_CONSTANT_ENCAPSED_STRING","'project_status'",172],"]",["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'not-fetched'",172],";",["T_WHITESPACE","\n      ",172],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_EMPTY","empty",173],"(",["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","failed",173],"[",["T_VARIABLE","$fetch_url_base",173],"]",")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","failed",174],"[",["T_VARIABLE","$fetch_url_base",174],"]",["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_LNUMBER","1",174],";",["T_WHITESPACE","\n      ",174],"}",["T_WHITESPACE","\n      ",175],["T_ELSE","else",176],["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","failed",177],"[",["T_VARIABLE","$fetch_url_base",177],"]",["T_INC","++",177],";",["T_WHITESPACE","\n      ",177],"}",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_VARIABLE","$frequency",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","updateSettings",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","get",181],"(",["T_CONSTANT_ENCAPSED_STRING","'check.interval_days'",181],")",";",["T_WHITESPACE","\n    ",181],["T_VARIABLE","$available",182],"[",["T_CONSTANT_ENCAPSED_STRING","'last_fetch'",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","REQUEST_TIME",182],["T_WHITESPACE"," ",182],"+",["T_WHITESPACE"," ",182],["T_VARIABLE","$request_time_difference",182],";",["T_WHITESPACE","\n    ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","availableReleasesTempStore",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setWithExpire",183],"(",["T_VARIABLE","$project_name",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$available",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$request_time_difference",183],["T_WHITESPACE"," ",183],"+",["T_WHITESPACE"," ",183],"(",["T_LNUMBER","60",183],["T_WHITESPACE"," ",183],"*",["T_WHITESPACE"," ",183],["T_LNUMBER","60",183],["T_WHITESPACE"," ",183],"*",["T_WHITESPACE"," ",183],["T_LNUMBER","24",183],["T_WHITESPACE"," ",183],"*",["T_WHITESPACE"," ",183],["T_VARIABLE","$frequency",183],")",")",";",["T_WHITESPACE","\n\n    ",183],["T_COMMENT","\/\/ Stash the $this->failed data back in the DB for the next 5 minutes.\n",185],["T_WHITESPACE","    ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","tempStore",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setWithExpire",186],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch_failures'",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","failed",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$request_time_difference",186],["T_WHITESPACE"," ",186],"+",["T_WHITESPACE"," ",186],"(",["T_LNUMBER","60",186],["T_WHITESPACE"," ",186],"*",["T_WHITESPACE"," ",186],["T_LNUMBER","5",186],")",")",";",["T_WHITESPACE","\n\n    ",186],["T_COMMENT","\/\/ Whether this worked or not, we did just (try to) check for updates.\n",188],["T_WHITESPACE","    ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","stateStore",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","set",189],"(",["T_CONSTANT_ENCAPSED_STRING","'update.last_check'",189],",",["T_WHITESPACE"," ",189],["T_STRING","REQUEST_TIME",189],["T_WHITESPACE"," ",189],"+",["T_WHITESPACE"," ",189],["T_VARIABLE","$request_time_difference",189],")",";",["T_WHITESPACE","\n\n    ",189],["T_COMMENT","\/\/ Now that we processed the fetch task for this project, clear out the\n",191],["T_WHITESPACE","    ",192],["T_COMMENT","\/\/ record for this task so we're willing to fetch again.\n",192],["T_WHITESPACE","    ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","fetchTaskStore",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","delete",193],"(",["T_VARIABLE","$project_name",193],")",";",["T_WHITESPACE","\n\n    ",193],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$success",195],";",["T_WHITESPACE","\n  ",195],"}",["T_WHITESPACE","\n\n  ",196],["T_DOC_COMMENT","\/**\n   * Parses the XML of the Drupal release history info files.\n   *\n   * @param string $raw_xml\n   *   A raw XML string of available release data for a given project.\n   *\n   * @return array\n   *   Array of parsed data about releases for a given project, or NULL if there\n   *   was an error parsing the string.\n   *\/",198],["T_WHITESPACE","\n  ",207],["T_PROTECTED","protected",208],["T_WHITESPACE"," ",208],["T_FUNCTION","function",208],["T_WHITESPACE"," ",208],["T_STRING","parseXml",208],"(",["T_VARIABLE","$raw_xml",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n    ",208],["T_TRY","try",209],["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n      ",209],["T_VARIABLE","$xml",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_NEW","new",210],["T_WHITESPACE"," ",210],["T_NS_SEPARATOR","\\",210],["T_STRING","SimpleXMLElement",210],"(",["T_VARIABLE","$raw_xml",210],")",";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n    ",211],["T_CATCH","catch",212],["T_WHITESPACE"," ",212],"(",["T_NS_SEPARATOR","\\",212],["T_STRING","Exception",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$e",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n      ",212],["T_COMMENT","\/\/ SimpleXMLElement::__construct produces an E_WARNING error message for\n",213],["T_WHITESPACE","      ",214],["T_COMMENT","\/\/ each error found in the XML data and throws an exception if errors\n",214],["T_WHITESPACE","      ",215],["T_COMMENT","\/\/ were detected. Catch any exception and return failure (NULL).\n",215],["T_WHITESPACE","      ",216],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_STRING","NULL",216],";",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n    ",217],["T_COMMENT","\/\/ If there is no valid project data, the XML is invalid, so return failure.\n",218],["T_WHITESPACE","    ",219],["T_IF","if",219],["T_WHITESPACE"," ",219],"(","!",["T_ISSET","isset",219],"(",["T_VARIABLE","$xml",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","short_name",219],")",")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n      ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_STRING","NULL",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n    ",221],["T_VARIABLE","$data",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",")",";",["T_WHITESPACE","\n    ",222],["T_FOREACH","foreach",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$xml",223],["T_WHITESPACE"," ",223],["T_AS","as",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$k",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$v",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n      ",223],["T_VARIABLE","$data",224],"[",["T_VARIABLE","$k",224],"]",["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_STRING_CAST","(string)",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$v",224],";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n    ",225],["T_VARIABLE","$data",226],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",226],"]",["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",")",";",["T_WHITESPACE","\n    ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_ISSET","isset",227],"(",["T_VARIABLE","$xml",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","releases",227],")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n      ",227],["T_FOREACH","foreach",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$xml",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","releases",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","children",228],"(",")",["T_WHITESPACE"," ",228],["T_AS","as",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$release",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$version",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_STRING_CAST","(string)",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$release",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","version",229],";",["T_WHITESPACE","\n        ",229],["T_VARIABLE","$data",230],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",230],"]","[",["T_VARIABLE","$version",230],"]",["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_ARRAY","array",230],"(",")",";",["T_WHITESPACE","\n        ",230],["T_FOREACH","foreach",231],["T_WHITESPACE"," ",231],"(",["T_VARIABLE","$release",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","children",231],"(",")",["T_WHITESPACE"," ",231],["T_AS","as",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$k",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$v",231],")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n          ",231],["T_VARIABLE","$data",232],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",232],"]","[",["T_VARIABLE","$version",232],"]","[",["T_VARIABLE","$k",232],"]",["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_STRING_CAST","(string)",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$v",232],";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$data",234],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",234],"]","[",["T_VARIABLE","$version",234],"]","[",["T_CONSTANT_ENCAPSED_STRING","'terms'",234],"]",["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_ARRAY","array",234],"(",")",";",["T_WHITESPACE","\n        ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$release",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","terms",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n          ",235],["T_FOREACH","foreach",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$release",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","terms",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","children",236],"(",")",["T_WHITESPACE"," ",236],["T_AS","as",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$term",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(","!",["T_ISSET","isset",237],"(",["T_VARIABLE","$data",237],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",237],"]","[",["T_VARIABLE","$version",237],"]","[",["T_CONSTANT_ENCAPSED_STRING","'terms'",237],"]","[",["T_STRING_CAST","(string)",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$term",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","name",237],"]",")",")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n              ",237],["T_VARIABLE","$data",238],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",238],"]","[",["T_VARIABLE","$version",238],"]","[",["T_CONSTANT_ENCAPSED_STRING","'terms'",238],"]","[",["T_STRING_CAST","(string)",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$term",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","name",238],"]",["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_ARRAY","array",238],"(",")",";",["T_WHITESPACE","\n            ",238],"}",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$data",240],"[",["T_CONSTANT_ENCAPSED_STRING","'releases'",240],"]","[",["T_VARIABLE","$version",240],"]","[",["T_CONSTANT_ENCAPSED_STRING","'terms'",240],"]","[",["T_STRING_CAST","(string)",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$term",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","name",240],"]","[","]",["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING_CAST","(string)",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$term",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","value",240],";",["T_WHITESPACE","\n          ",240],"}",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n      ",242],"}",["T_WHITESPACE","\n    ",243],"}",["T_WHITESPACE","\n    ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$data",245],";",["T_WHITESPACE","\n  ",245],"}",["T_WHITESPACE","\n\n  ",246],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",248],["T_WHITESPACE","\n  ",250],["T_PUBLIC","public",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","numberOfQueueItems",251],"(",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n    ",251],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","fetchQueue",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","numberOfItems",252],"(",")",";",["T_WHITESPACE","\n  ",252],"}",["T_WHITESPACE","\n\n  ",253],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",255],["T_WHITESPACE","\n  ",257],["T_PUBLIC","public",258],["T_WHITESPACE"," ",258],["T_FUNCTION","function",258],["T_WHITESPACE"," ",258],["T_STRING","claimQueueItem",258],"(",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n    ",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","fetchQueue",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","claimItem",259],"(",")",";",["T_WHITESPACE","\n  ",259],"}",["T_WHITESPACE","\n\n  ",260],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",262],["T_WHITESPACE","\n  ",264],["T_PUBLIC","public",265],["T_WHITESPACE"," ",265],["T_FUNCTION","function",265],["T_WHITESPACE"," ",265],["T_STRING","deleteQueueItem",265],"(",["T_VARIABLE","$item",265],")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n    ",265],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","fetchQueue",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","deleteItem",266],"(",["T_VARIABLE","$item",266],")",";",["T_WHITESPACE","\n  ",266],"}",["T_WHITESPACE","\n\n",267],"}",["T_WHITESPACE","\n",269]]