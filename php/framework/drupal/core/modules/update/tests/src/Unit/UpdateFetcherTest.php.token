[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","update",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Unit",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Tests",5],["T_NS_SEPARATOR","\\",5],["T_STRING","UnitTestCase",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","update",6],["T_NS_SEPARATOR","\\",6],["T_STRING","UpdateFetcher",6],";",["T_WHITESPACE","\n\n",6],["T_IF","if",8],["T_WHITESPACE"," ",8],"(","!",["T_STRING","defined",8],"(",["T_CONSTANT_ENCAPSED_STRING","'DRUPAL_CORE_COMPATIBILITY'",8],")",")",["T_WHITESPACE"," ",8],"{",["T_WHITESPACE","\n  ",8],["T_STRING","define",9],"(",["T_CONSTANT_ENCAPSED_STRING","'DRUPAL_CORE_COMPATIBILITY'",9],",",["T_WHITESPACE"," ",9],["T_CONSTANT_ENCAPSED_STRING","'8.x'",9],")",";",["T_WHITESPACE","\n",9],"}",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Tests update functionality unrelated to the database.\n *\n * @group update\n *\/",12],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","UpdateFetcherTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_STRING","UnitTestCase",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * The update fetcher to use.\n   *\n   * @var \\Drupal\\update\\UpdateFetcher\n   *\/",19],["T_WHITESPACE","\n  ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$updateFetcher",24],";",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",26],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","setUp",29],"(",")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$config_factory",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","getConfigFactoryStub",30],"(",["T_ARRAY","array",30],"(",["T_CONSTANT_ENCAPSED_STRING","'update.settings'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_ARRAY","array",30],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch_url'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",30],")",")",")",";",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$http_client_mock",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getMock",31],"(",["T_CONSTANT_ENCAPSED_STRING","'\\GuzzleHttp\\ClientInterface'",31],")",";",["T_WHITESPACE","\n    ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","updateFetcher",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_NEW","new",32],["T_WHITESPACE"," ",32],["T_STRING","UpdateFetcher",32],"(",["T_VARIABLE","$config_factory",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$http_client_mock",32],")",";",["T_WHITESPACE","\n  ",32],"}",["T_WHITESPACE","\n\n  ",33],["T_DOC_COMMENT","\/**\n   * Tests that buildFetchUrl() builds the URL correctly.\n   *\n   * @param array $project\n   *   A keyed array of project information matching results from\n   *   \\Drupal\\Update\\UpdateManager::getProjects().\n   * @param string $site_key\n   *   A string to mimic an anonymous site key hash.\n   * @param string $expected\n   *   The expected url returned from UpdateFetcher::buildFetchUrl()\n   *\n   * @dataProvider providerTestUpdateBuildFetchUrl\n   *\n   * @see \\Drupal\\update\\UpdateFetcher::buildFetchUrl()\n   *\/",35],["T_WHITESPACE","\n  ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","testUpdateBuildFetchUrl",50],"(",["T_ARRAY","array",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$project",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$site_key",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$expected",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$url",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","updateFetcher",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","buildFetchUrl",51],"(",["T_VARIABLE","$project",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$site_key",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","assertEquals",52],"(",["T_VARIABLE","$url",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$expected",52],")",";",["T_WHITESPACE","\n  ",52],"}",["T_WHITESPACE","\n\n  ",53],["T_DOC_COMMENT","\/**\n   * Provide test data for self::testUpdateBuildFetchUrl().\n   *\n   * @return array\n   *   An array of arrays, each containing:\n   *   - 'project' - An array matching a project's .info file structure.\n   *   - 'site_key' - An arbitrary site key.\n   *   - 'expected' - The expected url from UpdateFetcher::buildFetchUrl().\n   *\/",55],["T_WHITESPACE","\n  ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","providerTestUpdateBuildFetchUrl",64],"(",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$data",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_ARRAY","array",65],"(",")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ First test that we didn't break the trivial case.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$project",68],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",68],"]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'update_test'",68],";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$project",69],"[",["T_CONSTANT_ENCAPSED_STRING","'project_type'",69],"]",["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","''",69],";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$project",70],"[",["T_CONSTANT_ENCAPSED_STRING","'info'",70],"]","[",["T_CONSTANT_ENCAPSED_STRING","'version'",70],"]",["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","''",70],";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$project",71],"[",["T_CONSTANT_ENCAPSED_STRING","'info'",71],"]","[",["T_CONSTANT_ENCAPSED_STRING","'project status url'",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",71],";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$project",72],"[",["T_CONSTANT_ENCAPSED_STRING","'includes'",72],"]",["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'module1'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Module 1'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'module2'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Module 2'",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$site_key",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","''",73],";",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$expected",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com\/'",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_VARIABLE","$project",74],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",74],"]",["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'\/'",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_STRING","DRUPAL_CORE_COMPATIBILITY",74],";",["T_WHITESPACE","\n\n    ",74],["T_VARIABLE","$data",76],"[","]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_ARRAY","array",76],"(",["T_VARIABLE","$project",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$site_key",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$expected",76],")",";",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/\/ For disabled projects it shouldn't add the site key either.\n",78],["T_WHITESPACE","    ",79],["T_VARIABLE","$site_key",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'site_key'",79],";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$project",80],"[",["T_CONSTANT_ENCAPSED_STRING","'project_type'",80],"]",["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'disabled'",80],";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$expected",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com\/'",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_VARIABLE","$project",81],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",81],"]",["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'\/'",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_STRING","DRUPAL_CORE_COMPATIBILITY",81],";",["T_WHITESPACE","\n\n    ",81],["T_VARIABLE","$data",83],"[","]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_VARIABLE","$project",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$site_key",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$expected",83],")",";",["T_WHITESPACE","\n\n    ",83],["T_COMMENT","\/\/ For enabled projects, test adding the site key.\n",85],["T_WHITESPACE","    ",86],["T_VARIABLE","$project",86],"[",["T_CONSTANT_ENCAPSED_STRING","'project_type'",86],"]",["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","''",86],";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$expected",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com\/'",87],["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_VARIABLE","$project",87],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",87],"]",["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'\/'",87],["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_STRING","DRUPAL_CORE_COMPATIBILITY",87],";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$expected",88],["T_WHITESPACE"," ",88],["T_CONCAT_EQUAL",".=",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'?site_key=site_key'",88],";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$expected",89],["T_WHITESPACE"," ",89],["T_CONCAT_EQUAL",".=",89],["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'&list='",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_STRING","rawurlencode",89],"(",["T_CONSTANT_ENCAPSED_STRING","'module1,module2'",89],")",";",["T_WHITESPACE","\n\n    ",89],["T_VARIABLE","$data",91],"[","]",["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",["T_VARIABLE","$project",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$site_key",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$expected",91],")",";",["T_WHITESPACE","\n\n    ",91],["T_COMMENT","\/\/ Test when the URL contains a question mark.\n",93],["T_WHITESPACE","    ",94],["T_VARIABLE","$project",94],"[",["T_CONSTANT_ENCAPSED_STRING","'info'",94],"]","[",["T_CONSTANT_ENCAPSED_STRING","'project status url'",94],"]",["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com\/?project='",94],";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$expected",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com\/?project=\/'",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_VARIABLE","$project",95],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",95],"]",["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'\/'",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_STRING","DRUPAL_CORE_COMPATIBILITY",95],";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$expected",96],["T_WHITESPACE"," ",96],["T_CONCAT_EQUAL",".=",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'&site_key=site_key'",96],";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$expected",97],["T_WHITESPACE"," ",97],["T_CONCAT_EQUAL",".=",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'&list='",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_STRING","rawurlencode",97],"(",["T_CONSTANT_ENCAPSED_STRING","'module1,module2'",97],")",";",["T_WHITESPACE","\n\n    ",97],["T_VARIABLE","$data",99],"[","]",["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_ARRAY","array",99],"(",["T_VARIABLE","$project",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$site_key",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$expected",99],")",";",["T_WHITESPACE","\n\n    ",99],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$data",101],";",["T_WHITESPACE","\n  ",101],"}",["T_WHITESPACE","\n\n",102],"}",["T_WHITESPACE","\n",104]]