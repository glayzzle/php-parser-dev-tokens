[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","basic_auth",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Authentication",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","SafeMarkup",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Url",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","basic_auth",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Tests",7],["T_NS_SEPARATOR","\\",7],["T_STRING","BasicAuthTestTrait",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","language",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ConfigurableLanguage",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","simpletest",9],["T_NS_SEPARATOR","\\",9],["T_STRING","WebTestBase",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Tests for BasicAuth authentication provider.\n *\n * @group basic_auth\n *\/",11],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","BasicAuthTest",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_STRING","WebTestBase",16],["T_WHITESPACE"," ",16],"{",["T_WHITESPACE","\n\n  ",16],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","BasicAuthTestTrait",18],";",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * Modules installed for all tests.\n   *\n   * @var array\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PUBLIC","public",25],["T_WHITESPACE"," ",25],["T_STATIC","static",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$modules",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_ARRAY","array",25],"(",["T_CONSTANT_ENCAPSED_STRING","'basic_auth'",25],",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'router_test'",25],",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'locale'",25],",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'basic_auth_test'",25],")",";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * Test http basic authentication.\n   *\/",27],["T_WHITESPACE","\n  ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","testBasicAuth",30],"(",")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n    ",30],["T_COMMENT","\/\/ Enable page caching.\n",31],["T_WHITESPACE","    ",32],["T_VARIABLE","$config",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","config",32],"(",["T_CONSTANT_ENCAPSED_STRING","'system.performance'",32],")",";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$config",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","set",33],"(",["T_CONSTANT_ENCAPSED_STRING","'cache.page.max_age'",33],",",["T_WHITESPACE"," ",33],["T_LNUMBER","300",33],")",";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$config",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","save",34],"(",")",";",["T_WHITESPACE","\n\n    ",34],["T_VARIABLE","$account",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","drupalCreateUser",36],"(",")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$url",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","Url",37],["T_DOUBLE_COLON","::",37],["T_STRING","fromRoute",37],"(",["T_CONSTANT_ENCAPSED_STRING","'router_test.11'",37],")",";",["T_WHITESPACE","\n\n    ",37],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","basicAuthGet",39],"(",["T_VARIABLE","$url",39],",",["T_WHITESPACE"," ",39],["T_VARIABLE","$account",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getUsername",39],"(",")",",",["T_WHITESPACE"," ",39],["T_VARIABLE","$account",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","pass_raw",39],")",";",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","assertText",40],"(",["T_VARIABLE","$account",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getUsername",40],"(",")",",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'Account name is displayed.'",40],")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","assertResponse",41],"(",["T_CONSTANT_ENCAPSED_STRING","'200'",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'HTTP response is OK'",41],")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","curlClose",42],"(",")",";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","assertFalse",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","drupalGetHeader",43],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",43],")",")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","assertIdentical",44],"(",["T_STRING","strpos",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","drupalGetHeader",44],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache-Control'",44],")",",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'public'",44],")",",",["T_WHITESPACE"," ",44],["T_STRING","FALSE",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'Cache-Control is not set to public'",44],")",";",["T_WHITESPACE","\n\n    ",44],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","basicAuthGet",46],"(",["T_VARIABLE","$url",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$account",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getUsername",46],"(",")",",",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","randomMachineName",46],"(",")",")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertNoText",47],"(",["T_VARIABLE","$account",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getUsername",47],"(",")",",",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'Bad basic auth credentials do not authenticate the user.'",47],")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","assertResponse",48],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'Access is not granted.'",48],")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","curlClose",49],"(",")",";",["T_WHITESPACE","\n\n    ",49],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalGet",51],"(",["T_VARIABLE","$url",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","assertEqual",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","drupalGetHeader",52],"(",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate'",52],")",",",["T_WHITESPACE"," ",52],["T_STRING","SafeMarkup",52],["T_DOUBLE_COLON","::",52],["T_STRING","format",52],"(",["T_CONSTANT_ENCAPSED_STRING","'Basic realm=\"@realm\"'",52],",",["T_WHITESPACE"," ",52],"[",["T_CONSTANT_ENCAPSED_STRING","'@realm'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Drupal",52],["T_DOUBLE_COLON","::",52],["T_STRING","config",52],"(",["T_CONSTANT_ENCAPSED_STRING","'system.site'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","get",52],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",52],")","]",")",")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","assertResponse",53],"(",["T_CONSTANT_ENCAPSED_STRING","'401'",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Not authenticated on the route that allows only basic_auth. Prompt to authenticate received.'",53],")",";",["T_WHITESPACE","\n\n    ",53],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","drupalGet",55],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",55],")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertResponse",56],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'No authentication prompt for routes not explicitly defining authentication providers.'",56],")",";",["T_WHITESPACE","\n\n    ",56],["T_VARIABLE","$account",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","drupalCreateUser",58],"(",["T_ARRAY","array",58],"(",["T_CONSTANT_ENCAPSED_STRING","'access administration pages'",58],")",")",";",["T_WHITESPACE","\n\n    ",58],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","basicAuthGet",60],"(",["T_STRING","Url",60],["T_DOUBLE_COLON","::",60],["T_STRING","fromRoute",60],"(",["T_CONSTANT_ENCAPSED_STRING","'system.admin'",60],")",",",["T_WHITESPACE"," ",60],["T_VARIABLE","$account",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getUsername",60],"(",")",",",["T_WHITESPACE"," ",60],["T_VARIABLE","$account",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","pass_raw",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertNoLink",61],"(",["T_CONSTANT_ENCAPSED_STRING","'Log out'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'User is not logged in'",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertResponse",62],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'No basic authentication for routes not explicitly defining authentication providers.'",62],")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","curlClose",63],"(",")",";",["T_WHITESPACE","\n\n    ",63],["T_COMMENT","\/\/ Ensure that pages already in the page cache aren't returned from page\n",65],["T_WHITESPACE","    ",66],["T_COMMENT","\/\/ cache if basic auth credentials are provided.\n",66],["T_WHITESPACE","    ",67],["T_VARIABLE","$url",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_STRING","Url",67],["T_DOUBLE_COLON","::",67],["T_STRING","fromRoute",67],"(",["T_CONSTANT_ENCAPSED_STRING","'router_test.10'",67],")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","drupalGet",68],"(",["T_VARIABLE","$url",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEqual",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","drupalGetHeader",69],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",69],")",",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'MISS'",69],")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","basicAuthGet",70],"(",["T_VARIABLE","$url",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$account",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getUsername",70],"(",")",",",["T_WHITESPACE"," ",70],["T_VARIABLE","$account",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","pass_raw",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertFalse",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","drupalGetHeader",71],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",71],")",")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertIdentical",72],"(",["T_STRING","strpos",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","drupalGetHeader",72],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache-Control'",72],")",",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'public'",72],")",",",["T_WHITESPACE"," ",72],["T_STRING","FALSE",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'No page cache response when requesting a cached page with basic auth credentials.'",72],")",";",["T_WHITESPACE","\n  ",72],"}",["T_WHITESPACE","\n\n  ",73],["T_DOC_COMMENT","\/**\n   * Test the global login flood control.\n   *\/",75],["T_WHITESPACE","\n  ",77],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","testGlobalLoginFloodControl",78],"(",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","config",79],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",79],")",["T_WHITESPACE","\n      ",79],["T_OBJECT_OPERATOR","->",80],["T_STRING","set",80],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",80],",",["T_WHITESPACE"," ",80],["T_LNUMBER","2",80],")",["T_WHITESPACE","\n      ",80],["T_COMMENT","\/\/ Set a high per-user limit out so that it is not relevant in the test.\n",81],["T_WHITESPACE","      ",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","set",82],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",82],",",["T_WHITESPACE"," ",82],["T_LNUMBER","4000",82],")",["T_WHITESPACE","\n      ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","save",83],"(",")",";",["T_WHITESPACE","\n\n    ",83],["T_VARIABLE","$user",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","drupalCreateUser",85],"(",["T_ARRAY","array",85],"(",")",")",";",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$incorrect_user",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CLONE","clone",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$user",86],";",["T_WHITESPACE","\n    ",86],["T_VARIABLE","$incorrect_user",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","pass_raw",87],["T_WHITESPACE"," ",87],["T_CONCAT_EQUAL",".=",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'incorrect'",87],";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$url",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","Url",88],["T_DOUBLE_COLON","::",88],["T_STRING","fromRoute",88],"(",["T_CONSTANT_ENCAPSED_STRING","'router_test.11'",88],")",";",["T_WHITESPACE","\n\n    ",88],["T_COMMENT","\/\/ Try 2 failed logins.\n",90],["T_WHITESPACE","    ",91],["T_FOR","for",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$i",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_LNUMBER","0",91],";",["T_WHITESPACE"," ",91],["T_VARIABLE","$i",91],["T_WHITESPACE"," ",91],"<",["T_WHITESPACE"," ",91],["T_LNUMBER","2",91],";",["T_WHITESPACE"," ",91],["T_VARIABLE","$i",91],["T_INC","++",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n      ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","basicAuthGet",92],"(",["T_VARIABLE","$url",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$incorrect_user",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getUsername",92],"(",")",",",["T_WHITESPACE"," ",92],["T_VARIABLE","$incorrect_user",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","pass_raw",92],")",";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_COMMENT","\/\/ IP limit has reached to its limit. Even valid user credentials will fail.\n",95],["T_WHITESPACE","    ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","basicAuthGet",96],"(",["T_VARIABLE","$url",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$user",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getUsername",96],"(",")",",",["T_WHITESPACE"," ",96],["T_VARIABLE","$user",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","pass_raw",96],")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","assertResponse",97],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'Access is blocked because of IP based flood prevention.'",97],")",";",["T_WHITESPACE","\n  ",97],"}",["T_WHITESPACE","\n\n  ",98],["T_DOC_COMMENT","\/**\n   * Test the per-user login flood control.\n   *\/",100],["T_WHITESPACE","\n  ",102],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","testPerUserLoginFloodControl",103],"(",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n    ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","config",104],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",104],")",["T_WHITESPACE","\n      ",104],["T_COMMENT","\/\/ Set a high global limit out so that it is not relevant in the test.\n",105],["T_WHITESPACE","      ",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","set",106],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",106],",",["T_WHITESPACE"," ",106],["T_LNUMBER","4000",106],")",["T_WHITESPACE","\n      ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","set",107],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",107],",",["T_WHITESPACE"," ",107],["T_LNUMBER","2",107],")",["T_WHITESPACE","\n      ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","save",108],"(",")",";",["T_WHITESPACE","\n\n    ",108],["T_VARIABLE","$user",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","drupalCreateUser",110],"(",["T_ARRAY","array",110],"(",")",")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$incorrect_user",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_CLONE","clone",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$user",111],";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$incorrect_user",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","pass_raw",112],["T_WHITESPACE"," ",112],["T_CONCAT_EQUAL",".=",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'incorrect'",112],";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$user2",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","drupalCreateUser",113],"(",["T_ARRAY","array",113],"(",")",")",";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$url",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","Url",114],["T_DOUBLE_COLON","::",114],["T_STRING","fromRoute",114],"(",["T_CONSTANT_ENCAPSED_STRING","'router_test.11'",114],")",";",["T_WHITESPACE","\n\n    ",114],["T_COMMENT","\/\/ Try a failed login.\n",116],["T_WHITESPACE","    ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","basicAuthGet",117],"(",["T_VARIABLE","$url",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$incorrect_user",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getUsername",117],"(",")",",",["T_WHITESPACE"," ",117],["T_VARIABLE","$incorrect_user",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","pass_raw",117],")",";",["T_WHITESPACE","\n\n    ",117],["T_COMMENT","\/\/ A successful login will reset the per-user flood control count.\n",119],["T_WHITESPACE","    ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","basicAuthGet",120],"(",["T_VARIABLE","$url",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$user",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getUsername",120],"(",")",",",["T_WHITESPACE"," ",120],["T_VARIABLE","$user",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","pass_raw",120],")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","assertResponse",121],"(",["T_CONSTANT_ENCAPSED_STRING","'200'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'Per user flood prevention gets reset on a successful login.'",121],")",";",["T_WHITESPACE","\n\n    ",121],["T_COMMENT","\/\/ Try 2 failed logins for a user. They will trigger flood control.\n",123],["T_WHITESPACE","    ",124],["T_FOR","for",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$i",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_LNUMBER","0",124],";",["T_WHITESPACE"," ",124],["T_VARIABLE","$i",124],["T_WHITESPACE"," ",124],"<",["T_WHITESPACE"," ",124],["T_LNUMBER","2",124],";",["T_WHITESPACE"," ",124],["T_VARIABLE","$i",124],["T_INC","++",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n      ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","basicAuthGet",125],"(",["T_VARIABLE","$url",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$incorrect_user",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getUsername",125],"(",")",",",["T_WHITESPACE"," ",125],["T_VARIABLE","$incorrect_user",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","pass_raw",125],")",";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_COMMENT","\/\/ Now the user account is blocked.\n",128],["T_WHITESPACE","    ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","basicAuthGet",129],"(",["T_VARIABLE","$url",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$user",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getUsername",129],"(",")",",",["T_WHITESPACE"," ",129],["T_VARIABLE","$user",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","pass_raw",129],")",";",["T_WHITESPACE","\n    ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","assertResponse",130],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'The user account is blocked due to per user flood prevention.'",130],")",";",["T_WHITESPACE","\n\n    ",130],["T_COMMENT","\/\/ Try one successful attempt for a different user, it should not trigger\n",132],["T_WHITESPACE","    ",133],["T_COMMENT","\/\/ any flood control.\n",133],["T_WHITESPACE","    ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","basicAuthGet",134],"(",["T_VARIABLE","$url",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$user2",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getUsername",134],"(",")",",",["T_WHITESPACE"," ",134],["T_VARIABLE","$user2",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","pass_raw",134],")",";",["T_WHITESPACE","\n    ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertResponse",135],"(",["T_CONSTANT_ENCAPSED_STRING","'200'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'Per user flood prevention does not block access for other users.'",135],")",";",["T_WHITESPACE","\n  ",135],"}",["T_WHITESPACE","\n\n  ",136],["T_DOC_COMMENT","\/**\n   * Tests compatibility with locale\/UI translation.\n   *\/",138],["T_WHITESPACE","\n  ",140],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","testLocale",141],"(",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n    ",141],["T_STRING","ConfigurableLanguage",142],["T_DOUBLE_COLON","::",142],["T_STRING","createFromLangcode",142],"(",["T_CONSTANT_ENCAPSED_STRING","'de'",142],")",["T_OBJECT_OPERATOR","->",142],["T_STRING","save",142],"(",")",";",["T_WHITESPACE","\n    ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","config",143],"(",["T_CONSTANT_ENCAPSED_STRING","'system.site'",143],")",["T_OBJECT_OPERATOR","->",143],["T_STRING","set",143],"(",["T_CONSTANT_ENCAPSED_STRING","'default_langcode'",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'de'",143],")",["T_OBJECT_OPERATOR","->",143],["T_STRING","save",143],"(",")",";",["T_WHITESPACE","\n\n    ",143],["T_VARIABLE","$account",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","drupalCreateUser",145],"(",")",";",["T_WHITESPACE","\n    ",145],["T_VARIABLE","$url",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","Url",146],["T_DOUBLE_COLON","::",146],["T_STRING","fromRoute",146],"(",["T_CONSTANT_ENCAPSED_STRING","'router_test.11'",146],")",";",["T_WHITESPACE","\n\n    ",146],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","basicAuthGet",148],"(",["T_VARIABLE","$url",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$account",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getUsername",148],"(",")",",",["T_WHITESPACE"," ",148],["T_VARIABLE","$account",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","pass_raw",148],")",";",["T_WHITESPACE","\n    ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","assertText",149],"(",["T_VARIABLE","$account",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getUsername",149],"(",")",",",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'Account name is displayed.'",149],")",";",["T_WHITESPACE","\n    ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","assertResponse",150],"(",["T_CONSTANT_ENCAPSED_STRING","'200'",150],",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'HTTP response is OK'",150],")",";",["T_WHITESPACE","\n    ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","curlClose",151],"(",")",";",["T_WHITESPACE","\n  ",151],"}",["T_WHITESPACE","\n\n  ",152],["T_DOC_COMMENT","\/**\n   * Tests if a comprehensive message is displayed when the route is denied.\n   *\/",154],["T_WHITESPACE","\n  ",156],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","testUnauthorizedErrorMessage",157],"(",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n    ",157],["T_VARIABLE","$account",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","drupalCreateUser",158],"(",")",";",["T_WHITESPACE","\n    ",158],["T_VARIABLE","$url",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","Url",159],["T_DOUBLE_COLON","::",159],["T_STRING","fromRoute",159],"(",["T_CONSTANT_ENCAPSED_STRING","'router_test.11'",159],")",";",["T_WHITESPACE","\n\n    ",159],["T_COMMENT","\/\/ Case when no credentials are passed.\n",161],["T_WHITESPACE","    ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","drupalGet",162],"(",["T_VARIABLE","$url",162],")",";",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertResponse",163],"(",["T_CONSTANT_ENCAPSED_STRING","'401'",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'The user is blocked when no credentials are passed.'",163],")",";",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","assertNoText",164],"(",["T_CONSTANT_ENCAPSED_STRING","'Exception'",164],",",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","\"No raw exception is displayed on the page.\"",164],")",";",["T_WHITESPACE","\n    ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","assertText",165],"(",["T_CONSTANT_ENCAPSED_STRING","'Please log in to access this page.'",165],",",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"A user friendly access unauthorized message is displayed.\"",165],")",";",["T_WHITESPACE","\n\n    ",165],["T_COMMENT","\/\/ Case when empty credentials are passed.\n",167],["T_WHITESPACE","    ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","basicAuthGet",168],"(",["T_VARIABLE","$url",168],",",["T_WHITESPACE"," ",168],["T_STRING","NULL",168],",",["T_WHITESPACE"," ",168],["T_STRING","NULL",168],")",";",["T_WHITESPACE","\n    ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","assertResponse",169],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'The user is blocked when empty credentials are passed.'",169],")",";",["T_WHITESPACE","\n    ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","assertText",170],"(",["T_CONSTANT_ENCAPSED_STRING","'Access denied'",170],",",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","\"A user friendly access denied message is displayed\"",170],")",";",["T_WHITESPACE","\n\n    ",170],["T_COMMENT","\/\/ Case when wrong credentials are passed.\n",172],["T_WHITESPACE","    ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","basicAuthGet",173],"(",["T_VARIABLE","$url",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$account",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getUsername",173],"(",")",",",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","randomMachineName",173],"(",")",")",";",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","assertResponse",174],"(",["T_CONSTANT_ENCAPSED_STRING","'403'",174],",",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'The user is blocked when wrong credentials are passed.'",174],")",";",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","assertText",175],"(",["T_CONSTANT_ENCAPSED_STRING","'Access denied'",175],",",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","\"A user friendly access denied message is displayed\"",175],")",";",["T_WHITESPACE","\n  ",175],"}",["T_WHITESPACE","\n\n  ",176],["T_DOC_COMMENT","\/**\n   * Tests if the controller is called before authentication.\n   *\n   * @see https:\/\/www.drupal.org\/node\/2817727\n   *\/",178],["T_WHITESPACE","\n  ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","testControllerNotCalledBeforeAuth",183],"(",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","drupalGet",184],"(",["T_CONSTANT_ENCAPSED_STRING","'\/basic_auth_test\/state\/modify'",184],")",";",["T_WHITESPACE","\n    ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertResponse",185],"(",["T_LNUMBER","401",185],")",";",["T_WHITESPACE","\n    ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","drupalGet",186],"(",["T_CONSTANT_ENCAPSED_STRING","'\/basic_auth_test\/state\/read'",186],")",";",["T_WHITESPACE","\n    ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","assertResponse",187],"(",["T_LNUMBER","200",187],")",";",["T_WHITESPACE","\n    ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","assertRaw",188],"(",["T_CONSTANT_ENCAPSED_STRING","'nope'",188],")",";",["T_WHITESPACE","\n\n    ",188],["T_VARIABLE","$account",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","drupalCreateUser",190],"(",")",";",["T_WHITESPACE","\n    ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","basicAuthGet",191],"(",["T_CONSTANT_ENCAPSED_STRING","'\/basic_auth_test\/state\/modify'",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$account",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getUsername",191],"(",")",",",["T_WHITESPACE"," ",191],["T_VARIABLE","$account",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","pass_raw",191],")",";",["T_WHITESPACE","\n    ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","assertResponse",192],"(",["T_LNUMBER","200",192],")",";",["T_WHITESPACE","\n    ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","assertRaw",193],"(",["T_CONSTANT_ENCAPSED_STRING","'Done'",193],")",";",["T_WHITESPACE","\n    ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","drupalGet",194],"(",["T_CONSTANT_ENCAPSED_STRING","'\/basic_auth_test\/state\/read'",194],")",";",["T_WHITESPACE","\n    ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","assertResponse",195],"(",["T_LNUMBER","200",195],")",";",["T_WHITESPACE","\n    ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","assertRaw",196],"(",["T_CONSTANT_ENCAPSED_STRING","'yep'",196],")",";",["T_WHITESPACE","\n  ",196],"}",["T_WHITESPACE","\n\n",197],"}",["T_WHITESPACE","\n",199]]