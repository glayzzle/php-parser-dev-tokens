[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","basic_auth",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Authentication",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Provider",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","SafeMarkup",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Authentication",6],["T_NS_SEPARATOR","\\",6],["T_STRING","AuthenticationProviderInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Authentication",7],["T_NS_SEPARATOR","\\",7],["T_STRING","AuthenticationProviderChallengeInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Config",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ConfigFactoryInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","EntityManagerInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Flood",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FloodInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","user",11],["T_NS_SEPARATOR","\\",11],["T_STRING","UserAuthInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpFoundation",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Request",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Symfony",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Component",13],["T_NS_SEPARATOR","\\",13],["T_STRING","HttpKernel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Exception",13],["T_NS_SEPARATOR","\\",13],["T_STRING","UnauthorizedHttpException",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * HTTP Basic authentication provider.\n *\/",15],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","BasicAuth",18],["T_WHITESPACE"," ",18],["T_IMPLEMENTS","implements",18],["T_WHITESPACE"," ",18],["T_STRING","AuthenticationProviderInterface",18],",",["T_WHITESPACE"," ",18],["T_STRING","AuthenticationProviderChallengeInterface",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * The config factory.\n   *\n   * @var \\Drupal\\Core\\Config\\ConfigFactoryInterface\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$configFactory",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * The user auth service.\n   *\n   * @var \\Drupal\\user\\UserAuthInterface\n   *\/",27],["T_WHITESPACE","\n  ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$userAuth",32],";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * The flood service.\n   *\n   * @var \\Drupal\\Core\\Flood\\FloodInterface\n   *\/",34],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$flood",39],";",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * The entity manager.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityManagerInterface\n   *\/",41],["T_WHITESPACE","\n  ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$entityManager",46],";",["T_WHITESPACE","\n\n  ",46],["T_DOC_COMMENT","\/**\n   * Constructs a HTTP basic authentication provider object.\n   *\n   * @param \\Drupal\\Core\\Config\\ConfigFactoryInterface $config_factory\n   *   The config factory.\n   * @param \\Drupal\\user\\UserAuthInterface $user_auth\n   *   The user authentication service.\n   * @param \\Drupal\\Core\\Flood\\FloodInterface $flood\n   *   The flood service.\n   * @param \\Drupal\\Core\\Entity\\EntityManagerInterface $entity_manager\n   *   The entity manager service.\n   *\/",48],["T_WHITESPACE","\n  ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","__construct",60],"(",["T_STRING","ConfigFactoryInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$config_factory",60],",",["T_WHITESPACE"," ",60],["T_STRING","UserAuthInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$user_auth",60],",",["T_WHITESPACE"," ",60],["T_STRING","FloodInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$flood",60],",",["T_WHITESPACE"," ",60],["T_STRING","EntityManagerInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$entity_manager",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","configFactory",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$config_factory",61],";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","userAuth",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$user_auth",62],";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","flood",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$flood",63],";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","entityManager",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$entity_manager",64],";",["T_WHITESPACE","\n  ",64],"}",["T_WHITESPACE","\n\n  ",65],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",67],["T_WHITESPACE","\n  ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","applies",70],"(",["T_STRING","Request",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$request",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$username",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$request",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","headers",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","get",71],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$password",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$request",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","headers",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","get",72],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",72],")",";",["T_WHITESPACE","\n    ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_ISSET","isset",73],"(",["T_VARIABLE","$username",73],")",["T_WHITESPACE"," ",73],["T_BOOLEAN_AND","&&",73],["T_WHITESPACE"," ",73],["T_ISSET","isset",73],"(",["T_VARIABLE","$password",73],")",";",["T_WHITESPACE","\n  ",73],"}",["T_WHITESPACE","\n\n  ",74],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",76],["T_WHITESPACE","\n  ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","authenticate",79],"(",["T_STRING","Request",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$request",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$flood_config",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","configFactory",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","get",80],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",80],")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$username",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$request",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","headers",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","get",81],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$password",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$request",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","headers",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","get",82],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",82],")",";",["T_WHITESPACE","\n    ",82],["T_COMMENT","\/\/ Flood protection: this is very similar to the user login form code.\n",83],["T_WHITESPACE","    ",84],["T_COMMENT","\/\/ @see \\Drupal\\user\\Form\\UserLoginForm::validateAuthentication()\n",84],["T_WHITESPACE","    ",85],["T_COMMENT","\/\/ Do not allow any login from the current user's IP if the limit has been\n",85],["T_WHITESPACE","    ",86],["T_COMMENT","\/\/ reached. Default is 50 failed attempts allowed in one hour. This is\n",86],["T_WHITESPACE","    ",87],["T_COMMENT","\/\/ independent of the per-user limit to catch attempts from one IP to log\n",87],["T_WHITESPACE","    ",88],["T_COMMENT","\/\/ in to many different user accounts.  We have a reasonably high limit\n",88],["T_WHITESPACE","    ",89],["T_COMMENT","\/\/ since there may be only one apparent IP for all users at an institution.\n",89],["T_WHITESPACE","    ",90],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","flood",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","isAllowed",90],"(",["T_CONSTANT_ENCAPSED_STRING","'basic_auth.failed_login_ip'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$flood_config",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","get",90],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",90],")",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$flood_config",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","get",90],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_window'",90],")",")",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n      ",90],["T_VARIABLE","$accounts",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","entityManager",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getStorage",91],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","loadByProperties",91],"(",["T_ARRAY","array",91],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$username",91],",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'status'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_LNUMBER","1",91],")",")",";",["T_WHITESPACE","\n      ",91],["T_VARIABLE","$account",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","reset",92],"(",["T_VARIABLE","$accounts",92],")",";",["T_WHITESPACE","\n      ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$account",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$flood_config",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","get",94],"(",["T_CONSTANT_ENCAPSED_STRING","'uid_only'",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n          ",94],["T_COMMENT","\/\/ Register flood events based on the uid only, so they apply for any\n",95],["T_WHITESPACE","          ",96],["T_COMMENT","\/\/ IP address. This is the most secure option.\n",96],["T_WHITESPACE","          ",97],["T_VARIABLE","$identifier",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$account",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","id",97],"(",")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n        ",98],["T_ELSE","else",99],["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n          ",99],["T_COMMENT","\/\/ The default identifier is a combination of uid and IP address. This\n",100],["T_WHITESPACE","          ",101],["T_COMMENT","\/\/ is less secure but more resistant to denial-of-service attacks that\n",101],["T_WHITESPACE","          ",102],["T_COMMENT","\/\/ could lock out all users with public user names.\n",102],["T_WHITESPACE","          ",103],["T_VARIABLE","$identifier",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$account",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","id",103],"(",")",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'-'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$request",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getClientIP",103],"(",")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_COMMENT","\/\/ Don't allow login if the limit for this user has been reached.\n",105],["T_WHITESPACE","        ",106],["T_COMMENT","\/\/ Default is to allow 5 failed attempts every 6 hours.\n",106],["T_WHITESPACE","        ",107],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","flood",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","isAllowed",107],"(",["T_CONSTANT_ENCAPSED_STRING","'basic_auth.failed_login_user'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$flood_config",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","get",107],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",107],")",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$flood_config",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","get",107],"(",["T_CONSTANT_ENCAPSED_STRING","'user_window'",107],")",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$identifier",107],")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n          ",107],["T_VARIABLE","$uid",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","userAuth",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","authenticate",108],"(",["T_VARIABLE","$username",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$password",108],")",";",["T_WHITESPACE","\n          ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$uid",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","flood",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","clear",110],"(",["T_CONSTANT_ENCAPSED_STRING","'basic_auth.failed_login_user'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$identifier",110],")",";",["T_WHITESPACE","\n            ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","entityManager",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getStorage",111],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",111],")",["T_OBJECT_OPERATOR","->",111],["T_STRING","load",111],"(",["T_VARIABLE","$uid",111],")",";",["T_WHITESPACE","\n          ",111],"}",["T_WHITESPACE","\n          ",112],["T_ELSE","else",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_COMMENT","\/\/ Register a per-user failed login event.\n",114],["T_WHITESPACE","            ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","flood",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","register",115],"(",["T_CONSTANT_ENCAPSED_STRING","'basic_auth.failed_login_user'",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$flood_config",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","get",115],"(",["T_CONSTANT_ENCAPSED_STRING","'user_window'",115],")",",",["T_WHITESPACE"," ",115],["T_VARIABLE","$identifier",115],")",";",["T_WHITESPACE","\n          ",115],"}",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n      ",117],"}",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n    ",119],["T_COMMENT","\/\/ Always register an IP-based failed login event.\n",120],["T_WHITESPACE","    ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","flood",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","register",121],"(",["T_CONSTANT_ENCAPSED_STRING","'basic_auth.failed_login_ip'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$flood_config",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","get",121],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_window'",121],")",")",";",["T_WHITESPACE","\n    ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],"[","]",";",["T_WHITESPACE","\n  ",122],"}",["T_WHITESPACE","\n\n  ",123],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",125],["T_WHITESPACE","\n  ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","challengeException",128],"(",["T_STRING","Request",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$request",128],",",["T_WHITESPACE"," ",128],["T_NS_SEPARATOR","\\",128],["T_STRING","Exception",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$previous",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n    ",128],["T_VARIABLE","$site_name",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","configFactory",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","get",129],"(",["T_CONSTANT_ENCAPSED_STRING","'system.site'",129],")",["T_OBJECT_OPERATOR","->",129],["T_STRING","get",129],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",129],")",";",["T_WHITESPACE","\n    ",129],["T_VARIABLE","$challenge",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","SafeMarkup",130],["T_DOUBLE_COLON","::",130],["T_STRING","format",130],"(",["T_CONSTANT_ENCAPSED_STRING","'Basic realm=\"@realm\"'",130],",",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",["T_WHITESPACE","\n      ",130],["T_CONSTANT_ENCAPSED_STRING","'@realm'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],"!",["T_EMPTY","empty",131],"(",["T_VARIABLE","$site_name",131],")",["T_WHITESPACE"," ",131],"?",["T_WHITESPACE"," ",131],["T_VARIABLE","$site_name",131],["T_WHITESPACE"," ",131],":",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'Access restricted'",131],",",["T_WHITESPACE","\n    ",131],")",")",";",["T_WHITESPACE","\n    ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_STRING","UnauthorizedHttpException",133],"(",["T_STRING_CAST","(string)",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$challenge",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'No authentication credentials provided.'",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$previous",133],")",";",["T_WHITESPACE","\n  ",133],"}",["T_WHITESPACE","\n\n",134],"}",["T_WHITESPACE","\n",136]]