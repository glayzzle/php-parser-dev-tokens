[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","field",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","EntityStorageException",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Exception",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FieldStorageDefinitionUpdateForbiddenException",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Field",7],["T_NS_SEPARATOR","\\",7],["T_STRING","FieldException",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","entity_test",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntityTest",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","field",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FieldConfig",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","field",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Entity",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FieldStorageConfig",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Tests field storage create, read, update, and delete.\n *\n * @group field\n *\/",12],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","FieldStorageCrudTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_STRING","FieldKernelTestBase",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",19],["T_WHITESPACE","\n  ",23],["T_PUBLIC","public",24],["T_WHITESPACE"," ",24],["T_STATIC","static",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$modules",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_ARRAY","array",24],"(",")",";",["T_WHITESPACE","\n\n  ",24],["T_COMMENT","\/\/ TODO : test creation with\n",26],["T_WHITESPACE","  ",27],["T_COMMENT","\/\/ - a full fledged $field structure, check that all the values are there\n",27],["T_WHITESPACE","  ",28],["T_COMMENT","\/\/ - a minimal $field structure, check all default values are set\n",28],["T_WHITESPACE","  ",29],["T_COMMENT","\/\/ defer actual $field comparison to a helper function, used for the two cases above\n",29],["T_WHITESPACE","\n  ",30],["T_DOC_COMMENT","\/**\n   * Test the creation of a field storage.\n   *\/",31],["T_WHITESPACE","\n  ",33],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","testCreate",34],"(",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$field_storage_definition",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(",["T_WHITESPACE","\n      ",35],["T_CONSTANT_ENCAPSED_STRING","'field_name'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'field_2'",36],",",["T_WHITESPACE","\n      ",36],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",37],",",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'type'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'test_field'",38],",",["T_WHITESPACE","\n    ",38],")",";",["T_WHITESPACE","\n    ",39],["T_STRING","field_test_memorize",40],"(",")",";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$field_storage",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","FieldStorageConfig",41],["T_DOUBLE_COLON","::",41],["T_STRING","create",41],"(",["T_VARIABLE","$field_storage_definition",41],")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$field_storage",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","save",42],"(",")",";",["T_WHITESPACE","\n\n    ",42],["T_VARIABLE","$field_storage",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","FieldStorageConfig",44],["T_DOUBLE_COLON","::",44],["T_STRING","load",44],"(",["T_VARIABLE","$field_storage",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","id",44],"(",")",")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertTrue",45],"(",["T_VARIABLE","$field_storage",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getSetting",45],"(",["T_CONSTANT_ENCAPSED_STRING","'storage_setting_from_config_data'",45],")",")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","assertNull",46],"(",["T_VARIABLE","$field_storage",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getSetting",46],"(",["T_CONSTANT_ENCAPSED_STRING","'config_data_from_storage_setting'",46],")",")",";",["T_WHITESPACE","\n\n    ",46],["T_VARIABLE","$mem",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","field_test_memorize",48],"(",")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertIdentical",49],"(",["T_VARIABLE","$mem",49],"[",["T_CONSTANT_ENCAPSED_STRING","'field_test_field_storage_config_create'",49],"]","[",["T_LNUMBER","0",49],"]","[",["T_LNUMBER","0",49],"]",["T_OBJECT_OPERATOR","->",49],["T_STRING","getName",49],"(",")",",",["T_WHITESPACE"," ",49],["T_VARIABLE","$field_storage_definition",49],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",49],"]",",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'hook_entity_create() called with correct arguments.'",49],")",";",["T_WHITESPACE","\n    ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","assertIdentical",50],"(",["T_VARIABLE","$mem",50],"[",["T_CONSTANT_ENCAPSED_STRING","'field_test_field_storage_config_create'",50],"]","[",["T_LNUMBER","0",50],"]","[",["T_LNUMBER","0",50],"]",["T_OBJECT_OPERATOR","->",50],["T_STRING","getType",50],"(",")",",",["T_WHITESPACE"," ",50],["T_VARIABLE","$field_storage_definition",50],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",50],"]",",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'hook_entity_create() called with correct arguments.'",50],")",";",["T_WHITESPACE","\n\n    ",50],["T_COMMENT","\/\/ Read the configuration. Check against raw configuration data rather than\n",52],["T_WHITESPACE","    ",53],["T_COMMENT","\/\/ the loaded ConfigEntity, to be sure we check that the defaults are\n",53],["T_WHITESPACE","    ",54],["T_COMMENT","\/\/ applied on write.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$field_storage_config",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","config",55],"(",["T_CONSTANT_ENCAPSED_STRING","'field.storage.'",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$field_storage",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","id",55],"(",")",")",["T_OBJECT_OPERATOR","->",55],["T_STRING","get",55],"(",")",";",["T_WHITESPACE","\n\n    ",55],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertTrue",57],"(",["T_VARIABLE","$field_storage_config",57],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",57],"]","[",["T_CONSTANT_ENCAPSED_STRING","'config_data_from_storage_setting'",57],"]",")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertTrue",58],"(","!",["T_ISSET","isset",58],"(",["T_VARIABLE","$field_storage_config",58],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",58],"]","[",["T_CONSTANT_ENCAPSED_STRING","'storage_setting_from_config_data'",58],"]",")",")",";",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ Since we are working with raw configuration, this needs to be unset\n",60],["T_WHITESPACE","    ",61],["T_COMMENT","\/\/ manually.\n",61],["T_WHITESPACE","    ",62],["T_COMMENT","\/\/ @see Drupal\\field_test\\Plugin\\Field\\FieldType\\TestItem::storageSettingsFromConfigData()\n",62],["T_WHITESPACE","    ",63],["T_UNSET","unset",63],"(",["T_VARIABLE","$field_storage_config",63],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",63],"]","[",["T_CONSTANT_ENCAPSED_STRING","'config_data_from_storage_setting'",63],"]",")",";",["T_WHITESPACE","\n\n    ",63],["T_COMMENT","\/\/ Ensure that basic properties are preserved.\n",65],["T_WHITESPACE","    ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertEqual",66],"(",["T_VARIABLE","$field_storage_config",66],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",66],"]",",",["T_WHITESPACE"," ",66],["T_VARIABLE","$field_storage_definition",66],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",66],"]",",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'The field name is properly saved.'",66],")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertEqual",67],"(",["T_VARIABLE","$field_storage_config",67],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",67],"]",",",["T_WHITESPACE"," ",67],["T_VARIABLE","$field_storage_definition",67],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",67],"]",",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'The field entity type is properly saved.'",67],")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","assertEqual",68],"(",["T_VARIABLE","$field_storage_config",68],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",68],"]",",",["T_WHITESPACE"," ",68],["T_VARIABLE","$field_storage_definition",68],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",68],"]",["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'.'",68],["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_VARIABLE","$field_storage_definition",68],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",68],"]",",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'The field id is properly saved.'",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEqual",69],"(",["T_VARIABLE","$field_storage_config",69],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",69],"]",",",["T_WHITESPACE"," ",69],["T_VARIABLE","$field_storage_definition",69],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",69],"]",",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'The field type is properly saved.'",69],")",";",["T_WHITESPACE","\n\n    ",69],["T_COMMENT","\/\/ Ensure that cardinality defaults to 1.\n",71],["T_WHITESPACE","    ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertEqual",72],"(",["T_VARIABLE","$field_storage_config",72],"[",["T_CONSTANT_ENCAPSED_STRING","'cardinality'",72],"]",",",["T_WHITESPACE"," ",72],["T_LNUMBER","1",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Cardinality defaults to 1.'",72],")",";",["T_WHITESPACE","\n\n    ",72],["T_COMMENT","\/\/ Ensure that default settings are present.\n",74],["T_WHITESPACE","    ",75],["T_VARIABLE","$field_type_manager",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Drupal",75],["T_DOUBLE_COLON","::",75],["T_STRING","service",75],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.field.field_type'",75],")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertEqual",76],"(",["T_VARIABLE","$field_storage_config",76],"[",["T_CONSTANT_ENCAPSED_STRING","'settings'",76],"]",",",["T_WHITESPACE"," ",76],["T_VARIABLE","$field_type_manager",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getDefaultStorageSettings",76],"(",["T_VARIABLE","$field_storage_definition",76],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",76],"]",")",",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'Default storage settings have been written.'",76],")",";",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/\/ Guarantee that the name is unique.\n",78],["T_WHITESPACE","    ",79],["T_TRY","try",79],["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n      ",79],["T_STRING","FieldStorageConfig",80],["T_DOUBLE_COLON","::",80],["T_STRING","create",80],"(",["T_VARIABLE","$field_storage_definition",80],")",["T_OBJECT_OPERATOR","->",80],["T_STRING","save",80],"(",")",";",["T_WHITESPACE","\n      ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","fail",81],"(",["T_STRING","t",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create two fields with the same name.'",81],")",")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n    ",82],["T_CATCH","catch",83],["T_WHITESPACE"," ",83],"(",["T_STRING","EntityStorageException",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$e",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n      ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","pass",84],"(",["T_STRING","t",84],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create two fields with the same name.'",84],")",")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_COMMENT","\/\/ Check that field type is required.\n",87],["T_WHITESPACE","    ",88],["T_TRY","try",88],["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n      ",88],["T_VARIABLE","$field_storage_definition",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_ARRAY","array",89],"(",["T_WHITESPACE","\n        ",89],["T_CONSTANT_ENCAPSED_STRING","'field_name'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'field_1'",90],",",["T_WHITESPACE","\n        ",90],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",91],",",["T_WHITESPACE","\n      ",91],")",";",["T_WHITESPACE","\n      ",92],["T_STRING","FieldStorageConfig",93],["T_DOUBLE_COLON","::",93],["T_STRING","create",93],"(",["T_VARIABLE","$field_storage_definition",93],")",["T_OBJECT_OPERATOR","->",93],["T_STRING","save",93],"(",")",";",["T_WHITESPACE","\n      ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","fail",94],"(",["T_STRING","t",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with no type.'",94],")",")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n    ",95],["T_CATCH","catch",96],["T_WHITESPACE"," ",96],"(",["T_STRING","FieldException",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$e",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","pass",97],"(",["T_STRING","t",97],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with no type.'",97],")",")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_COMMENT","\/\/ Check that field name is required.\n",100],["T_WHITESPACE","    ",101],["T_TRY","try",101],["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n      ",101],["T_VARIABLE","$field_storage_definition",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",["T_WHITESPACE","\n        ",102],["T_CONSTANT_ENCAPSED_STRING","'type'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'test_field'",103],",",["T_WHITESPACE","\n        ",103],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",104],",",["T_WHITESPACE","\n      ",104],")",";",["T_WHITESPACE","\n      ",105],["T_STRING","FieldStorageConfig",106],["T_DOUBLE_COLON","::",106],["T_STRING","create",106],"(",["T_VARIABLE","$field_storage_definition",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","save",106],"(",")",";",["T_WHITESPACE","\n      ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","fail",107],"(",["T_STRING","t",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create an unnamed field.'",107],")",")",";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n    ",108],["T_CATCH","catch",109],["T_WHITESPACE"," ",109],"(",["T_STRING","FieldException",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$e",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n      ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","pass",110],"(",["T_STRING","t",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create an unnamed field.'",110],")",")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n    ",111],["T_COMMENT","\/\/ Check that entity type is required.\n",112],["T_WHITESPACE","    ",113],["T_TRY","try",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n      ",113],["T_VARIABLE","$field_storage_definition",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_WHITESPACE","\n        ",114],["T_CONSTANT_ENCAPSED_STRING","'field_name'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'test_field'",115],",",["T_WHITESPACE","\n        ",115],["T_CONSTANT_ENCAPSED_STRING","'type'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'test_field'",116],["T_WHITESPACE","\n      ",116],")",";",["T_WHITESPACE","\n      ",117],["T_STRING","FieldStorageConfig",118],["T_DOUBLE_COLON","::",118],["T_STRING","create",118],"(",["T_VARIABLE","$field_storage_definition",118],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","save",118],"(",")",";",["T_WHITESPACE","\n      ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","fail",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field without an entity type.'",119],")",";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n    ",120],["T_CATCH","catch",121],["T_WHITESPACE"," ",121],"(",["T_STRING","FieldException",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$e",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n      ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","pass",122],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field without an entity type.'",122],")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_COMMENT","\/\/ Check that field name must start with a letter or _.\n",125],["T_WHITESPACE","    ",126],["T_TRY","try",126],["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n      ",126],["T_VARIABLE","$field_storage_definition",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_WHITESPACE","\n        ",127],["T_CONSTANT_ENCAPSED_STRING","'field_name'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'2field_2'",128],",",["T_WHITESPACE","\n        ",128],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",129],",",["T_WHITESPACE","\n        ",129],["T_CONSTANT_ENCAPSED_STRING","'type'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'test_field'",130],",",["T_WHITESPACE","\n      ",130],")",";",["T_WHITESPACE","\n      ",131],["T_STRING","FieldStorageConfig",132],["T_DOUBLE_COLON","::",132],["T_STRING","create",132],"(",["T_VARIABLE","$field_storage_definition",132],")",["T_OBJECT_OPERATOR","->",132],["T_STRING","save",132],"(",")",";",["T_WHITESPACE","\n      ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","fail",133],"(",["T_STRING","t",133],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with a name starting with a digit.'",133],")",")",";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n    ",134],["T_CATCH","catch",135],["T_WHITESPACE"," ",135],"(",["T_STRING","FieldException",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$e",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n      ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","pass",136],"(",["T_STRING","t",136],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with a name starting with a digit.'",136],")",")",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_COMMENT","\/\/ Check that field name must only contain lowercase alphanumeric or _.\n",139],["T_WHITESPACE","    ",140],["T_TRY","try",140],["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n      ",140],["T_VARIABLE","$field_storage_definition",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_ARRAY","array",141],"(",["T_WHITESPACE","\n        ",141],["T_CONSTANT_ENCAPSED_STRING","'field_name'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'field#_3'",142],",",["T_WHITESPACE","\n        ",142],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",143],",",["T_WHITESPACE","\n        ",143],["T_CONSTANT_ENCAPSED_STRING","'type'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'test_field'",144],",",["T_WHITESPACE","\n      ",144],")",";",["T_WHITESPACE","\n      ",145],["T_STRING","FieldStorageConfig",146],["T_DOUBLE_COLON","::",146],["T_STRING","create",146],"(",["T_VARIABLE","$field_storage_definition",146],")",["T_OBJECT_OPERATOR","->",146],["T_STRING","save",146],"(",")",";",["T_WHITESPACE","\n      ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","fail",147],"(",["T_STRING","t",147],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with a name containing an illegal character.'",147],")",")",";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n    ",148],["T_CATCH","catch",149],["T_WHITESPACE"," ",149],"(",["T_STRING","FieldException",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$e",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n      ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","pass",150],"(",["T_STRING","t",150],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with a name containing an illegal character.'",150],")",")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_COMMENT","\/\/ Check that field name cannot be longer than 32 characters long.\n",153],["T_WHITESPACE","    ",154],["T_TRY","try",154],["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n      ",154],["T_VARIABLE","$field_storage_definition",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],"(",["T_WHITESPACE","\n        ",155],["T_CONSTANT_ENCAPSED_STRING","'field_name'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'_12345678901234567890123456789012'",156],",",["T_WHITESPACE","\n        ",156],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",157],",",["T_WHITESPACE","\n        ",157],["T_CONSTANT_ENCAPSED_STRING","'type'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'test_field'",158],",",["T_WHITESPACE","\n      ",158],")",";",["T_WHITESPACE","\n      ",159],["T_STRING","FieldStorageConfig",160],["T_DOUBLE_COLON","::",160],["T_STRING","create",160],"(",["T_VARIABLE","$field_storage_definition",160],")",["T_OBJECT_OPERATOR","->",160],["T_STRING","save",160],"(",")",";",["T_WHITESPACE","\n      ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","fail",161],"(",["T_STRING","t",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with a name longer than 32 characters.'",161],")",")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n    ",162],["T_CATCH","catch",163],["T_WHITESPACE"," ",163],"(",["T_STRING","FieldException",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$e",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n      ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","pass",164],"(",["T_STRING","t",164],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field with a name longer than 32 characters.'",164],")",")",";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_COMMENT","\/\/ Check that field name can not be an entity key.\n",167],["T_WHITESPACE","    ",168],["T_COMMENT","\/\/ \"id\" is known as an entity key from the \"entity_test\" type.\n",168],["T_WHITESPACE","    ",169],["T_TRY","try",169],["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n      ",169],["T_VARIABLE","$field_storage_definition",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_ARRAY","array",170],"(",["T_WHITESPACE","\n        ",170],["T_CONSTANT_ENCAPSED_STRING","'type'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'test_field'",171],",",["T_WHITESPACE","\n        ",171],["T_CONSTANT_ENCAPSED_STRING","'field_name'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'id'",172],",",["T_WHITESPACE","\n        ",172],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",173],",",["T_WHITESPACE","\n      ",173],")",";",["T_WHITESPACE","\n      ",174],["T_STRING","FieldStorageConfig",175],["T_DOUBLE_COLON","::",175],["T_STRING","create",175],"(",["T_VARIABLE","$field_storage_definition",175],")",["T_OBJECT_OPERATOR","->",175],["T_STRING","save",175],"(",")",";",["T_WHITESPACE","\n      ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","fail",176],"(",["T_STRING","t",176],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field bearing the name of an entity key.'",176],")",")",";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n    ",177],["T_CATCH","catch",178],["T_WHITESPACE"," ",178],"(",["T_STRING","FieldException",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$e",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n      ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","pass",179],"(",["T_STRING","t",179],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create a field bearing the name of an entity key.'",179],")",")",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n  ",180],"}",["T_WHITESPACE","\n\n  ",181],["T_DOC_COMMENT","\/**\n   * Tests that an explicit schema can be provided on creation.\n   *\n   * This behavior is needed to allow field storage creation within updates,\n   * since plugin classes (and thus the field type schema) cannot be accessed.\n   *\/",183],["T_WHITESPACE","\n  ",188],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","testCreateWithExplicitSchema",189],"(",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$schema",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_ARRAY","array",190],"(",["T_WHITESPACE","\n      ",190],["T_CONSTANT_ENCAPSED_STRING","'dummy'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'foobar'",191],["T_WHITESPACE","\n    ",191],")",";",["T_WHITESPACE","\n    ",192],["T_VARIABLE","$field_storage",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","FieldStorageConfig",193],["T_DOUBLE_COLON","::",193],["T_STRING","create",193],"(",["T_ARRAY","array",193],"(",["T_WHITESPACE","\n      ",193],["T_CONSTANT_ENCAPSED_STRING","'field_name'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'field_2'",194],",",["T_WHITESPACE","\n      ",194],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",195],",",["T_WHITESPACE","\n      ",195],["T_CONSTANT_ENCAPSED_STRING","'type'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'test_field'",196],",",["T_WHITESPACE","\n      ",196],["T_CONSTANT_ENCAPSED_STRING","'schema'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$schema",197],",",["T_WHITESPACE","\n    ",197],")",")",";",["T_WHITESPACE","\n    ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","assertEqual",199],"(",["T_VARIABLE","$field_storage",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getSchema",199],"(",")",",",["T_WHITESPACE"," ",199],["T_VARIABLE","$schema",199],")",";",["T_WHITESPACE","\n  ",199],"}",["T_WHITESPACE","\n\n  ",200],["T_DOC_COMMENT","\/**\n   * Tests reading field storage definitions.\n   *\/",202],["T_WHITESPACE","\n  ",204],["T_FUNCTION","function",205],["T_WHITESPACE"," ",205],["T_STRING","testRead",205],"(",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n    ",205],["T_VARIABLE","$field_storage_definition",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_ARRAY","array",206],"(",["T_WHITESPACE","\n      ",206],["T_CONSTANT_ENCAPSED_STRING","'field_name'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'field_1'",207],",",["T_WHITESPACE","\n      ",207],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",208],",",["T_WHITESPACE","\n      ",208],["T_CONSTANT_ENCAPSED_STRING","'type'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'test_field'",209],",",["T_WHITESPACE","\n    ",209],")",";",["T_WHITESPACE","\n    ",210],["T_VARIABLE","$field_storage",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","FieldStorageConfig",211],["T_DOUBLE_COLON","::",211],["T_STRING","create",211],"(",["T_VARIABLE","$field_storage_definition",211],")",";",["T_WHITESPACE","\n    ",211],["T_VARIABLE","$field_storage",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","save",212],"(",")",";",["T_WHITESPACE","\n    ",212],["T_VARIABLE","$id",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$field_storage",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","id",213],"(",")",";",["T_WHITESPACE","\n\n    ",213],["T_COMMENT","\/\/ Check that 'single column' criteria works.\n",215],["T_WHITESPACE","    ",216],["T_VARIABLE","$fields",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_STRING","entity_load_multiple_by_properties",216],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",216],",",["T_WHITESPACE"," ",216],["T_ARRAY","array",216],"(",["T_CONSTANT_ENCAPSED_STRING","'field_name'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$field_storage_definition",216],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",216],"]",")",")",";",["T_WHITESPACE","\n    ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","assertTrue",217],"(",["T_STRING","count",217],"(",["T_VARIABLE","$fields",217],")",["T_WHITESPACE"," ",217],["T_IS_EQUAL","==",217],["T_WHITESPACE"," ",217],["T_LNUMBER","1",217],["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],["T_ISSET","isset",217],"(",["T_VARIABLE","$fields",217],"[",["T_VARIABLE","$id",217],"]",")",",",["T_WHITESPACE"," ",217],["T_CONSTANT_ENCAPSED_STRING","'The field was properly read.'",217],")",";",["T_WHITESPACE","\n\n    ",217],["T_COMMENT","\/\/ Check that 'multi column' criteria works.\n",219],["T_WHITESPACE","    ",220],["T_VARIABLE","$fields",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","entity_load_multiple_by_properties",220],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",220],",",["T_WHITESPACE"," ",220],["T_ARRAY","array",220],"(",["T_CONSTANT_ENCAPSED_STRING","'field_name'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$field_storage_definition",220],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",220],"]",",",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'type'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$field_storage_definition",220],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",220],"]",")",")",";",["T_WHITESPACE","\n    ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","assertTrue",221],"(",["T_STRING","count",221],"(",["T_VARIABLE","$fields",221],")",["T_WHITESPACE"," ",221],["T_IS_EQUAL","==",221],["T_WHITESPACE"," ",221],["T_LNUMBER","1",221],["T_WHITESPACE"," ",221],["T_BOOLEAN_AND","&&",221],["T_WHITESPACE"," ",221],["T_ISSET","isset",221],"(",["T_VARIABLE","$fields",221],"[",["T_VARIABLE","$id",221],"]",")",",",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'The field was properly read.'",221],")",";",["T_WHITESPACE","\n    ",221],["T_VARIABLE","$fields",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_STRING","entity_load_multiple_by_properties",222],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",222],",",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",["T_CONSTANT_ENCAPSED_STRING","'field_name'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$field_storage_definition",222],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",222],"]",",",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'type'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'foo'",222],")",")",";",["T_WHITESPACE","\n    ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","assertTrue",223],"(",["T_EMPTY","empty",223],"(",["T_VARIABLE","$fields",223],")",",",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'No field was found.'",223],")",";",["T_WHITESPACE","\n\n    ",223],["T_COMMENT","\/\/ Create a field from the field storage.\n",225],["T_WHITESPACE","    ",226],["T_VARIABLE","$field_definition",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_WHITESPACE","\n      ",226],["T_CONSTANT_ENCAPSED_STRING","'field_name'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$field_storage_definition",227],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",227],"]",",",["T_WHITESPACE","\n      ",227],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",228],",",["T_WHITESPACE","\n      ",228],["T_CONSTANT_ENCAPSED_STRING","'bundle'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",229],",",["T_WHITESPACE","\n    ",229],")",";",["T_WHITESPACE","\n    ",230],["T_STRING","FieldConfig",231],["T_DOUBLE_COLON","::",231],["T_STRING","create",231],"(",["T_VARIABLE","$field_definition",231],")",["T_OBJECT_OPERATOR","->",231],["T_STRING","save",231],"(",")",";",["T_WHITESPACE","\n  ",231],"}",["T_WHITESPACE","\n\n  ",232],["T_DOC_COMMENT","\/**\n   * Test creation of indexes on data column.\n   *\/",234],["T_WHITESPACE","\n  ",236],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","testIndexes",237],"(",")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n    ",237],["T_COMMENT","\/\/ Check that indexes specified by the field type are used by default.\n",238],["T_WHITESPACE","    ",239],["T_VARIABLE","$field_storage",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","FieldStorageConfig",239],["T_DOUBLE_COLON","::",239],["T_STRING","create",239],"(",["T_ARRAY","array",239],"(",["T_WHITESPACE","\n      ",239],["T_CONSTANT_ENCAPSED_STRING","'field_name'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_CONSTANT_ENCAPSED_STRING","'field_1'",240],",",["T_WHITESPACE","\n      ",240],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",241],",",["T_WHITESPACE","\n      ",241],["T_CONSTANT_ENCAPSED_STRING","'type'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'test_field'",242],",",["T_WHITESPACE","\n    ",242],")",")",";",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$field_storage",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","save",244],"(",")",";",["T_WHITESPACE","\n    ",244],["T_VARIABLE","$field_storage",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","FieldStorageConfig",245],["T_DOUBLE_COLON","::",245],["T_STRING","load",245],"(",["T_VARIABLE","$field_storage",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","id",245],"(",")",")",";",["T_WHITESPACE","\n    ",245],["T_VARIABLE","$schema",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$field_storage",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getSchema",246],"(",")",";",["T_WHITESPACE","\n    ",246],["T_VARIABLE","$expected_indexes",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_ARRAY","array",247],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_ARRAY","array",247],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",247],")",")",";",["T_WHITESPACE","\n    ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","assertEqual",248],"(",["T_VARIABLE","$schema",248],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",248],"]",",",["T_WHITESPACE"," ",248],["T_VARIABLE","$expected_indexes",248],",",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'Field type indexes saved by default'",248],")",";",["T_WHITESPACE","\n\n    ",248],["T_COMMENT","\/\/ Check that indexes specified by the field definition override the field\n",250],["T_WHITESPACE","    ",251],["T_COMMENT","\/\/ type indexes.\n",251],["T_WHITESPACE","    ",252],["T_VARIABLE","$field_storage",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_STRING","FieldStorageConfig",252],["T_DOUBLE_COLON","::",252],["T_STRING","create",252],"(",["T_ARRAY","array",252],"(",["T_WHITESPACE","\n      ",252],["T_CONSTANT_ENCAPSED_STRING","'field_name'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'field_2'",253],",",["T_WHITESPACE","\n      ",253],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",254],",",["T_WHITESPACE","\n      ",254],["T_CONSTANT_ENCAPSED_STRING","'type'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","'test_field'",255],",",["T_WHITESPACE","\n      ",255],["T_CONSTANT_ENCAPSED_STRING","'indexes'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_ARRAY","array",256],"(",["T_WHITESPACE","\n        ",256],["T_CONSTANT_ENCAPSED_STRING","'value'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],["T_ARRAY","array",257],"(",")",",",["T_WHITESPACE","\n      ",257],")",",",["T_WHITESPACE","\n    ",258],")",")",";",["T_WHITESPACE","\n    ",259],["T_VARIABLE","$field_storage",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","save",260],"(",")",";",["T_WHITESPACE","\n    ",260],["T_VARIABLE","$field_storage",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","FieldStorageConfig",261],["T_DOUBLE_COLON","::",261],["T_STRING","load",261],"(",["T_VARIABLE","$field_storage",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","id",261],"(",")",")",";",["T_WHITESPACE","\n    ",261],["T_VARIABLE","$schema",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$field_storage",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getSchema",262],"(",")",";",["T_WHITESPACE","\n    ",262],["T_VARIABLE","$expected_indexes",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_ARRAY","array",263],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_ARRAY","array",263],"(",")",")",";",["T_WHITESPACE","\n    ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","assertEqual",264],"(",["T_VARIABLE","$schema",264],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",264],"]",",",["T_WHITESPACE"," ",264],["T_VARIABLE","$expected_indexes",264],",",["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'Field definition indexes override field type indexes'",264],")",";",["T_WHITESPACE","\n\n    ",264],["T_COMMENT","\/\/ Check that indexes specified by the field definition add to the field\n",266],["T_WHITESPACE","    ",267],["T_COMMENT","\/\/ type indexes.\n",267],["T_WHITESPACE","    ",268],["T_VARIABLE","$field_storage",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","FieldStorageConfig",268],["T_DOUBLE_COLON","::",268],["T_STRING","create",268],"(",["T_ARRAY","array",268],"(",["T_WHITESPACE","\n      ",268],["T_CONSTANT_ENCAPSED_STRING","'field_name'",269],["T_WHITESPACE"," ",269],["T_DOUBLE_ARROW","=>",269],["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'field_3'",269],",",["T_WHITESPACE","\n      ",269],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",270],",",["T_WHITESPACE","\n      ",270],["T_CONSTANT_ENCAPSED_STRING","'type'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_CONSTANT_ENCAPSED_STRING","'test_field'",271],",",["T_WHITESPACE","\n      ",271],["T_CONSTANT_ENCAPSED_STRING","'indexes'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_ARRAY","array",272],"(",["T_WHITESPACE","\n        ",272],["T_CONSTANT_ENCAPSED_STRING","'value_2'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_ARRAY","array",273],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",273],")",",",["T_WHITESPACE","\n      ",273],")",",",["T_WHITESPACE","\n    ",274],")",")",";",["T_WHITESPACE","\n    ",275],["T_VARIABLE","$field_storage",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","save",276],"(",")",";",["T_WHITESPACE","\n    ",276],["T_VARIABLE","$id",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$field_storage",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","id",277],"(",")",";",["T_WHITESPACE","\n    ",277],["T_VARIABLE","$field_storage",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_STRING","FieldStorageConfig",278],["T_DOUBLE_COLON","::",278],["T_STRING","load",278],"(",["T_VARIABLE","$id",278],")",";",["T_WHITESPACE","\n    ",278],["T_VARIABLE","$schema",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$field_storage",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getSchema",279],"(",")",";",["T_WHITESPACE","\n    ",279],["T_VARIABLE","$expected_indexes",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_ARRAY","array",280],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_ARRAY","array",280],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",280],")",",",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'value_2'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_ARRAY","array",280],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",280],")",")",";",["T_WHITESPACE","\n    ",280],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","assertEqual",281],"(",["T_VARIABLE","$schema",281],"[",["T_CONSTANT_ENCAPSED_STRING","'indexes'",281],"]",",",["T_WHITESPACE"," ",281],["T_VARIABLE","$expected_indexes",281],",",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'Field definition indexes are merged with field type indexes'",281],")",";",["T_WHITESPACE","\n  ",281],"}",["T_WHITESPACE","\n\n  ",282],["T_DOC_COMMENT","\/**\n   * Test the deletion of a field storage.\n   *\/",284],["T_WHITESPACE","\n  ",286],["T_FUNCTION","function",287],["T_WHITESPACE"," ",287],["T_STRING","testDelete",287],"(",")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n    ",287],["T_COMMENT","\/\/ TODO: Also test deletion of the data stored in the field ?\n",288],["T_WHITESPACE","\n    ",289],["T_COMMENT","\/\/ Create two fields (so we can test that only one is deleted).\n",290],["T_WHITESPACE","    ",291],["T_VARIABLE","$field_storage_definition",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_ARRAY","array",291],"(",["T_WHITESPACE","\n      ",291],["T_CONSTANT_ENCAPSED_STRING","'field_name'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'field_1'",292],",",["T_WHITESPACE","\n      ",292],["T_CONSTANT_ENCAPSED_STRING","'type'",293],["T_WHITESPACE"," ",293],["T_DOUBLE_ARROW","=>",293],["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'test_field'",293],",",["T_WHITESPACE","\n      ",293],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",294],["T_WHITESPACE"," ",294],["T_DOUBLE_ARROW","=>",294],["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",294],",",["T_WHITESPACE","\n    ",294],")",";",["T_WHITESPACE","\n    ",295],["T_STRING","FieldStorageConfig",296],["T_DOUBLE_COLON","::",296],["T_STRING","create",296],"(",["T_VARIABLE","$field_storage_definition",296],")",["T_OBJECT_OPERATOR","->",296],["T_STRING","save",296],"(",")",";",["T_WHITESPACE","\n    ",296],["T_VARIABLE","$another_field_storage_definition",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_ARRAY","array",297],"(",["T_WHITESPACE","\n      ",297],["T_CONSTANT_ENCAPSED_STRING","'field_name'",298],["T_WHITESPACE"," ",298],["T_DOUBLE_ARROW","=>",298],["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'field_2'",298],",",["T_WHITESPACE","\n      ",298],["T_CONSTANT_ENCAPSED_STRING","'type'",299],["T_WHITESPACE"," ",299],["T_DOUBLE_ARROW","=>",299],["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'test_field'",299],",",["T_WHITESPACE","\n      ",299],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",300],["T_WHITESPACE"," ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",300],",",["T_WHITESPACE","\n    ",300],")",";",["T_WHITESPACE","\n    ",301],["T_STRING","FieldStorageConfig",302],["T_DOUBLE_COLON","::",302],["T_STRING","create",302],"(",["T_VARIABLE","$another_field_storage_definition",302],")",["T_OBJECT_OPERATOR","->",302],["T_STRING","save",302],"(",")",";",["T_WHITESPACE","\n\n    ",302],["T_COMMENT","\/\/ Create fields for each.\n",304],["T_WHITESPACE","    ",305],["T_VARIABLE","$field_definition",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_ARRAY","array",305],"(",["T_WHITESPACE","\n      ",305],["T_CONSTANT_ENCAPSED_STRING","'field_name'",306],["T_WHITESPACE"," ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$field_storage_definition",306],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",306],"]",",",["T_WHITESPACE","\n      ",306],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",307],",",["T_WHITESPACE","\n      ",307],["T_CONSTANT_ENCAPSED_STRING","'bundle'",308],["T_WHITESPACE"," ",308],["T_DOUBLE_ARROW","=>",308],["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",308],",",["T_WHITESPACE","\n    ",308],")",";",["T_WHITESPACE","\n    ",309],["T_STRING","FieldConfig",310],["T_DOUBLE_COLON","::",310],["T_STRING","create",310],"(",["T_VARIABLE","$field_definition",310],")",["T_OBJECT_OPERATOR","->",310],["T_STRING","save",310],"(",")",";",["T_WHITESPACE","\n    ",310],["T_VARIABLE","$another_field_definition",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$field_definition",311],";",["T_WHITESPACE","\n    ",311],["T_VARIABLE","$another_field_definition",312],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",312],"]",["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$another_field_storage_definition",312],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",312],"]",";",["T_WHITESPACE","\n    ",312],["T_STRING","FieldConfig",313],["T_DOUBLE_COLON","::",313],["T_STRING","create",313],"(",["T_VARIABLE","$another_field_definition",313],")",["T_OBJECT_OPERATOR","->",313],["T_STRING","save",313],"(",")",";",["T_WHITESPACE","\n\n    ",313],["T_COMMENT","\/\/ Test that the first field is not deleted, and then delete it.\n",315],["T_WHITESPACE","    ",316],["T_VARIABLE","$field_storage",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","current",316],"(",["T_STRING","entity_load_multiple_by_properties",316],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",316],",",["T_WHITESPACE"," ",316],["T_ARRAY","array",316],"(",["T_CONSTANT_ENCAPSED_STRING","'field_name'",316],["T_WHITESPACE"," ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$field_storage_definition",316],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",316],"]",",",["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",316],["T_WHITESPACE"," ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_STRING","TRUE",316],")",")",")",";",["T_WHITESPACE","\n    ",316],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","assertTrue",317],"(","!",["T_EMPTY","empty",317],"(",["T_VARIABLE","$field_storage",317],")",["T_WHITESPACE"," ",317],["T_BOOLEAN_AND","&&",317],["T_WHITESPACE"," ",317],"!",["T_VARIABLE","$field_storage",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","isDeleted",317],"(",")",",",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'A new storage is not marked for deletion.'",317],")",";",["T_WHITESPACE","\n    ",317],["T_STRING","FieldStorageConfig",318],["T_DOUBLE_COLON","::",318],["T_STRING","loadByName",318],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",318],",",["T_WHITESPACE"," ",318],["T_VARIABLE","$field_storage_definition",318],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",318],"]",")",["T_OBJECT_OPERATOR","->",318],["T_STRING","delete",318],"(",")",";",["T_WHITESPACE","\n\n    ",318],["T_COMMENT","\/\/ Make sure that the field is marked as deleted when it is specifically\n",320],["T_WHITESPACE","    ",321],["T_COMMENT","\/\/ loaded.\n",321],["T_WHITESPACE","    ",322],["T_VARIABLE","$field_storage",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_STRING","current",322],"(",["T_STRING","entity_load_multiple_by_properties",322],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",322],",",["T_WHITESPACE"," ",322],["T_ARRAY","array",322],"(",["T_CONSTANT_ENCAPSED_STRING","'field_name'",322],["T_WHITESPACE"," ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$field_storage_definition",322],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",322],"]",",",["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",322],["T_WHITESPACE"," ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_STRING","TRUE",322],")",")",")",";",["T_WHITESPACE","\n    ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","assertTrue",323],"(",["T_VARIABLE","$field_storage",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","isDeleted",323],"(",")",",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'A deleted storage is marked for deletion.'",323],")",";",["T_WHITESPACE","\n\n    ",323],["T_COMMENT","\/\/ Make sure that this field is marked as deleted when it is\n",325],["T_WHITESPACE","    ",326],["T_COMMENT","\/\/ specifically loaded.\n",326],["T_WHITESPACE","    ",327],["T_VARIABLE","$field",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_STRING","current",327],"(",["T_STRING","entity_load_multiple_by_properties",327],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",327],",",["T_WHITESPACE"," ",327],["T_ARRAY","array",327],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",327],",",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'field_name'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$field_definition",327],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",327],"]",",",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'bundle'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$field_definition",327],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",327],"]",",",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_STRING","TRUE",327],")",")",")",";",["T_WHITESPACE","\n    ",327],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","assertTrue",328],"(",["T_VARIABLE","$field",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","isDeleted",328],"(",")",",",["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'A field whose storage was deleted is marked for deletion.'",328],")",";",["T_WHITESPACE","\n\n    ",328],["T_COMMENT","\/\/ Try to load the storage normally and make sure it does not show up.\n",330],["T_WHITESPACE","    ",331],["T_VARIABLE","$field_storage",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_STRING","FieldStorageConfig",331],["T_DOUBLE_COLON","::",331],["T_STRING","load",331],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test.'",331],["T_WHITESPACE"," ",331],".",["T_WHITESPACE"," ",331],["T_VARIABLE","$field_storage_definition",331],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",331],"]",")",";",["T_WHITESPACE","\n    ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","assertTrue",332],"(",["T_EMPTY","empty",332],"(",["T_VARIABLE","$field_storage",332],")",",",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'A deleted storage is not loaded by default.'",332],")",";",["T_WHITESPACE","\n\n    ",332],["T_COMMENT","\/\/ Try to load the field normally and make sure it does not show up.\n",334],["T_WHITESPACE","    ",335],["T_VARIABLE","$field",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","FieldConfig",335],["T_DOUBLE_COLON","::",335],["T_STRING","load",335],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test.'",335],["T_WHITESPACE"," ",335],".",["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'.'",335],["T_WHITESPACE"," ",335],".",["T_WHITESPACE"," ",335],["T_VARIABLE","$field_definition",335],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",335],"]",["T_WHITESPACE"," ",335],".",["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'.'",335],["T_WHITESPACE"," ",335],".",["T_WHITESPACE"," ",335],["T_VARIABLE","$field_definition",335],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",335],"]",")",";",["T_WHITESPACE","\n    ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","assertTrue",336],"(",["T_EMPTY","empty",336],"(",["T_VARIABLE","$field",336],")",",",["T_WHITESPACE"," ",336],["T_CONSTANT_ENCAPSED_STRING","'A field whose storage was deleted is not loaded by default.'",336],")",";",["T_WHITESPACE","\n\n    ",336],["T_COMMENT","\/\/ Make sure the other field and its storage are not deleted.\n",338],["T_WHITESPACE","    ",339],["T_VARIABLE","$another_field_storage",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","FieldStorageConfig",339],["T_DOUBLE_COLON","::",339],["T_STRING","load",339],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test.'",339],["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_VARIABLE","$another_field_storage_definition",339],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",339],"]",")",";",["T_WHITESPACE","\n    ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","assertTrue",340],"(","!",["T_EMPTY","empty",340],"(",["T_VARIABLE","$another_field_storage",340],")",["T_WHITESPACE"," ",340],["T_BOOLEAN_AND","&&",340],["T_WHITESPACE"," ",340],"!",["T_VARIABLE","$another_field_storage",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","isDeleted",340],"(",")",",",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'A non-deleted storage is not marked for deletion.'",340],")",";",["T_WHITESPACE","\n    ",340],["T_VARIABLE","$another_field",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_STRING","FieldConfig",341],["T_DOUBLE_COLON","::",341],["T_STRING","load",341],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test.'",341],["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_VARIABLE","$another_field_definition",341],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",341],"]",["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'.'",341],["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_VARIABLE","$another_field_definition",341],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",341],"]",")",";",["T_WHITESPACE","\n    ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","assertTrue",342],"(","!",["T_EMPTY","empty",342],"(",["T_VARIABLE","$another_field",342],")",["T_WHITESPACE"," ",342],["T_BOOLEAN_AND","&&",342],["T_WHITESPACE"," ",342],"!",["T_VARIABLE","$another_field",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","isDeleted",342],"(",")",",",["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","'A field whose storage was not deleted is not marked for deletion.'",342],")",";",["T_WHITESPACE","\n\n    ",342],["T_COMMENT","\/\/ Try to create a new field the same name as a deleted field and\n",344],["T_WHITESPACE","    ",345],["T_COMMENT","\/\/ write data into it.\n",345],["T_WHITESPACE","    ",346],["T_STRING","FieldStorageConfig",346],["T_DOUBLE_COLON","::",346],["T_STRING","create",346],"(",["T_VARIABLE","$field_storage_definition",346],")",["T_OBJECT_OPERATOR","->",346],["T_STRING","save",346],"(",")",";",["T_WHITESPACE","\n    ",346],["T_STRING","FieldConfig",347],["T_DOUBLE_COLON","::",347],["T_STRING","create",347],"(",["T_VARIABLE","$field_definition",347],")",["T_OBJECT_OPERATOR","->",347],["T_STRING","save",347],"(",")",";",["T_WHITESPACE","\n    ",347],["T_VARIABLE","$field_storage",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","FieldStorageConfig",348],["T_DOUBLE_COLON","::",348],["T_STRING","load",348],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test.'",348],["T_WHITESPACE"," ",348],".",["T_WHITESPACE"," ",348],["T_VARIABLE","$field_storage_definition",348],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",348],"]",")",";",["T_WHITESPACE","\n    ",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","assertTrue",349],"(","!",["T_EMPTY","empty",349],"(",["T_VARIABLE","$field_storage",349],")",["T_WHITESPACE"," ",349],["T_BOOLEAN_AND","&&",349],["T_WHITESPACE"," ",349],"!",["T_VARIABLE","$field_storage",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","isDeleted",349],"(",")",",",["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'A new storage with a previously used name is created.'",349],")",";",["T_WHITESPACE","\n    ",349],["T_VARIABLE","$field",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_STRING","FieldConfig",350],["T_DOUBLE_COLON","::",350],["T_STRING","load",350],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test.'",350],["T_WHITESPACE"," ",350],".",["T_WHITESPACE"," ",350],["T_VARIABLE","$field_definition",350],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",350],"]",["T_WHITESPACE"," ",350],".",["T_WHITESPACE"," ",350],["T_CONSTANT_ENCAPSED_STRING","'.'",350],["T_WHITESPACE"," ",350],".",["T_WHITESPACE"," ",350],["T_VARIABLE","$field_definition",350],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",350],"]",["T_WHITESPACE"," ",350],")",";",["T_WHITESPACE","\n    ",350],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","assertTrue",351],"(","!",["T_EMPTY","empty",351],"(",["T_VARIABLE","$field",351],")",["T_WHITESPACE"," ",351],["T_BOOLEAN_AND","&&",351],["T_WHITESPACE"," ",351],"!",["T_VARIABLE","$field",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","isDeleted",351],"(",")",",",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'A new field for a previously used field name is created.'",351],")",";",["T_WHITESPACE","\n\n    ",351],["T_COMMENT","\/\/ Save an entity with data for the field\n",353],["T_WHITESPACE","    ",354],["T_VARIABLE","$entity",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_STRING","EntityTest",354],["T_DOUBLE_COLON","::",354],["T_STRING","create",354],"(",")",";",["T_WHITESPACE","\n    ",354],["T_VARIABLE","$values",355],"[",["T_LNUMBER","0",355],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",355],"]",["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_STRING","mt_rand",355],"(",["T_LNUMBER","1",355],",",["T_WHITESPACE"," ",355],["T_LNUMBER","127",355],")",";",["T_WHITESPACE","\n    ",355],["T_VARIABLE","$entity",356],["T_OBJECT_OPERATOR","->",356],"{",["T_VARIABLE","$field_storage",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getName",356],"(",")","}",["T_OBJECT_OPERATOR","->",356],["T_STRING","value",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_VARIABLE","$values",356],"[",["T_LNUMBER","0",356],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",356],"]",";",["T_WHITESPACE","\n    ",356],["T_VARIABLE","$entity",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","entitySaveReload",357],"(",["T_VARIABLE","$entity",357],")",";",["T_WHITESPACE","\n\n    ",357],["T_COMMENT","\/\/ Verify the field is present on load\n",359],["T_WHITESPACE","    ",360],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","assertIdentical",360],"(",["T_STRING","count",360],"(",["T_VARIABLE","$entity",360],["T_OBJECT_OPERATOR","->",360],"{",["T_VARIABLE","$field_storage",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getName",360],"(",")","}",")",",",["T_WHITESPACE"," ",360],["T_STRING","count",360],"(",["T_VARIABLE","$values",360],")",",",["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","\"Data in previously deleted field saves and loads correctly\"",360],")",";",["T_WHITESPACE","\n    ",360],["T_FOREACH","foreach",361],["T_WHITESPACE"," ",361],"(",["T_VARIABLE","$values",361],["T_WHITESPACE"," ",361],["T_AS","as",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$delta",361],["T_WHITESPACE"," ",361],["T_DOUBLE_ARROW","=>",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$value",361],")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n      ",361],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","assertEqual",362],"(",["T_VARIABLE","$entity",362],["T_OBJECT_OPERATOR","->",362],"{",["T_VARIABLE","$field_storage",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getName",362],"(",")","}","[",["T_VARIABLE","$delta",362],"]",["T_OBJECT_OPERATOR","->",362],["T_STRING","value",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$values",362],"[",["T_VARIABLE","$delta",362],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",362],"]",",",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","\"Data in previously deleted field saves and loads correctly\"",362],")",";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n  ",363],"}",["T_WHITESPACE","\n\n  ",364],["T_FUNCTION","function",366],["T_WHITESPACE"," ",366],["T_STRING","testUpdateFieldType",366],"(",")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n    ",366],["T_VARIABLE","$field_storage",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_STRING","FieldStorageConfig",367],["T_DOUBLE_COLON","::",367],["T_STRING","create",367],"(",["T_ARRAY","array",367],"(",["T_WHITESPACE","\n      ",367],["T_CONSTANT_ENCAPSED_STRING","'field_name'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'field_type'",368],",",["T_WHITESPACE","\n      ",368],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",369],",",["T_WHITESPACE","\n      ",369],["T_CONSTANT_ENCAPSED_STRING","'type'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'decimal'",370],",",["T_WHITESPACE","\n    ",370],")",")",";",["T_WHITESPACE","\n    ",371],["T_VARIABLE","$field_storage",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","save",372],"(",")",";",["T_WHITESPACE","\n\n    ",372],["T_TRY","try",374],["T_WHITESPACE"," ",374],"{",["T_WHITESPACE","\n      ",374],["T_VARIABLE","$field_storage",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","set",375],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",375],",",["T_WHITESPACE"," ",375],["T_CONSTANT_ENCAPSED_STRING","'integer'",375],")",";",["T_WHITESPACE","\n      ",375],["T_VARIABLE","$field_storage",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","save",376],"(",")",";",["T_WHITESPACE","\n      ",376],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","fail",377],"(",["T_STRING","t",377],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot update a field to a different type.'",377],")",")",";",["T_WHITESPACE","\n    ",377],"}",["T_WHITESPACE","\n    ",378],["T_CATCH","catch",379],["T_WHITESPACE"," ",379],"(",["T_STRING","FieldException",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$e",379],")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n      ",379],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","pass",380],"(",["T_STRING","t",380],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot update a field to a different type.'",380],")",")",";",["T_WHITESPACE","\n    ",380],"}",["T_WHITESPACE","\n  ",381],"}",["T_WHITESPACE","\n\n  ",382],["T_DOC_COMMENT","\/**\n   * Test updating a field storage.\n   *\/",384],["T_WHITESPACE","\n  ",386],["T_FUNCTION","function",387],["T_WHITESPACE"," ",387],["T_STRING","testUpdate",387],"(",")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n    ",387],["T_COMMENT","\/\/ Create a field with a defined cardinality, so that we can ensure it's\n",388],["T_WHITESPACE","    ",389],["T_COMMENT","\/\/ respected. Since cardinality enforcement is consistent across database\n",389],["T_WHITESPACE","    ",390],["T_COMMENT","\/\/ systems, it makes a good test case.\n",390],["T_WHITESPACE","    ",391],["T_VARIABLE","$cardinality",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_LNUMBER","4",391],";",["T_WHITESPACE","\n    ",391],["T_VARIABLE","$field_storage",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_STRING","FieldStorageConfig",392],["T_DOUBLE_COLON","::",392],["T_STRING","create",392],"(",["T_ARRAY","array",392],"(",["T_WHITESPACE","\n      ",392],["T_CONSTANT_ENCAPSED_STRING","'field_name'",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_CONSTANT_ENCAPSED_STRING","'field_update'",393],",",["T_WHITESPACE","\n      ",393],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",394],["T_WHITESPACE"," ",394],["T_DOUBLE_ARROW","=>",394],["T_WHITESPACE"," ",394],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",394],",",["T_WHITESPACE","\n      ",394],["T_CONSTANT_ENCAPSED_STRING","'type'",395],["T_WHITESPACE"," ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_CONSTANT_ENCAPSED_STRING","'test_field'",395],",",["T_WHITESPACE","\n      ",395],["T_CONSTANT_ENCAPSED_STRING","'cardinality'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$cardinality",396],",",["T_WHITESPACE","\n    ",396],")",")",";",["T_WHITESPACE","\n    ",397],["T_VARIABLE","$field_storage",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","save",398],"(",")",";",["T_WHITESPACE","\n    ",398],["T_VARIABLE","$field",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_STRING","FieldConfig",399],["T_DOUBLE_COLON","::",399],["T_STRING","create",399],"(","[",["T_WHITESPACE","\n      ",399],["T_CONSTANT_ENCAPSED_STRING","'field_storage'",400],["T_WHITESPACE"," ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$field_storage",400],",",["T_WHITESPACE","\n      ",400],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",401],["T_WHITESPACE"," ",401],["T_DOUBLE_ARROW","=>",401],["T_WHITESPACE"," ",401],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",401],",",["T_WHITESPACE","\n      ",401],["T_CONSTANT_ENCAPSED_STRING","'bundle'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",402],",",["T_WHITESPACE","\n    ",402],"]",")",";",["T_WHITESPACE","\n    ",403],["T_VARIABLE","$field",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","save",404],"(",")",";",["T_WHITESPACE","\n\n    ",404],["T_DO","do",406],["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n      ",406],["T_VARIABLE","$entity",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_STRING","EntityTest",407],["T_DOUBLE_COLON","::",407],["T_STRING","create",407],"(",")",";",["T_WHITESPACE","\n      ",407],["T_COMMENT","\/\/ Fill in the entity with more values than $cardinality.\n",408],["T_WHITESPACE","      ",409],["T_FOR","for",409],["T_WHITESPACE"," ",409],"(",["T_VARIABLE","$i",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_LNUMBER","0",409],";",["T_WHITESPACE"," ",409],["T_VARIABLE","$i",409],["T_WHITESPACE"," ",409],"<",["T_WHITESPACE"," ",409],["T_LNUMBER","20",409],";",["T_WHITESPACE"," ",409],["T_VARIABLE","$i",409],["T_INC","++",409],")",["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n        ",409],["T_COMMENT","\/\/ We can not use $i here because 0 values are filtered out.\n",410],["T_WHITESPACE","        ",411],["T_VARIABLE","$entity",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","field_update",411],"[","]",["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_VARIABLE","$i",411],["T_WHITESPACE"," ",411],"+",["T_WHITESPACE"," ",411],["T_LNUMBER","1",411],";",["T_WHITESPACE","\n      ",411],"}",["T_WHITESPACE","\n      ",412],["T_COMMENT","\/\/ Load back and assert there are $cardinality number of values.\n",413],["T_WHITESPACE","      ",414],["T_VARIABLE","$entity",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","entitySaveReload",414],"(",["T_VARIABLE","$entity",414],")",";",["T_WHITESPACE","\n      ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","assertEqual",415],"(",["T_STRING","count",415],"(",["T_VARIABLE","$entity",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","field_update",415],")",",",["T_WHITESPACE"," ",415],["T_VARIABLE","$field_storage",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","getCardinality",415],"(",")",")",";",["T_WHITESPACE","\n      ",415],["T_COMMENT","\/\/ Now check the values themselves.\n",416],["T_WHITESPACE","      ",417],["T_FOR","for",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$delta",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_LNUMBER","0",417],";",["T_WHITESPACE"," ",417],["T_VARIABLE","$delta",417],["T_WHITESPACE"," ",417],"<",["T_WHITESPACE"," ",417],["T_VARIABLE","$cardinality",417],";",["T_WHITESPACE"," ",417],["T_VARIABLE","$delta",417],["T_INC","++",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n        ",417],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","assertEqual",418],"(",["T_VARIABLE","$entity",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","field_update",418],"[",["T_VARIABLE","$delta",418],"]",["T_OBJECT_OPERATOR","->",418],["T_STRING","value",418],",",["T_WHITESPACE"," ",418],["T_VARIABLE","$delta",418],["T_WHITESPACE"," ",418],"+",["T_WHITESPACE"," ",418],["T_LNUMBER","1",418],")",";",["T_WHITESPACE","\n      ",418],"}",["T_WHITESPACE","\n      ",419],["T_COMMENT","\/\/ Increase $cardinality and set the field cardinality to the new value.\n",420],["T_WHITESPACE","      ",421],["T_VARIABLE","$field_storage",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","setCardinality",421],"(",["T_INC","++",421],["T_VARIABLE","$cardinality",421],")",";",["T_WHITESPACE","\n      ",421],["T_VARIABLE","$field_storage",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","save",422],"(",")",";",["T_WHITESPACE","\n    ",422],"}",["T_WHITESPACE"," ",423],["T_WHILE","while",423],["T_WHITESPACE"," ",423],"(",["T_VARIABLE","$cardinality",423],["T_WHITESPACE"," ",423],"<",["T_WHITESPACE"," ",423],["T_LNUMBER","6",423],")",";",["T_WHITESPACE","\n  ",423],"}",["T_WHITESPACE","\n\n  ",424],["T_DOC_COMMENT","\/**\n   * Test field type modules forbidding an update.\n   *\/",426],["T_WHITESPACE","\n  ",428],["T_FUNCTION","function",429],["T_WHITESPACE"," ",429],["T_STRING","testUpdateForbid",429],"(",")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n    ",429],["T_VARIABLE","$field_storage",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_STRING","FieldStorageConfig",430],["T_DOUBLE_COLON","::",430],["T_STRING","create",430],"(",["T_ARRAY","array",430],"(",["T_WHITESPACE","\n      ",430],["T_CONSTANT_ENCAPSED_STRING","'field_name'",431],["T_WHITESPACE"," ",431],["T_DOUBLE_ARROW","=>",431],["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'forbidden'",431],",",["T_WHITESPACE","\n      ",431],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",432],["T_WHITESPACE"," ",432],["T_DOUBLE_ARROW","=>",432],["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",432],",",["T_WHITESPACE","\n      ",432],["T_CONSTANT_ENCAPSED_STRING","'type'",433],["T_WHITESPACE"," ",433],["T_DOUBLE_ARROW","=>",433],["T_WHITESPACE"," ",433],["T_CONSTANT_ENCAPSED_STRING","'test_field'",433],",",["T_WHITESPACE","\n      ",433],["T_CONSTANT_ENCAPSED_STRING","'settings'",434],["T_WHITESPACE"," ",434],["T_DOUBLE_ARROW","=>",434],["T_WHITESPACE"," ",434],["T_ARRAY","array",434],"(",["T_WHITESPACE","\n        ",434],["T_CONSTANT_ENCAPSED_STRING","'changeable'",435],["T_WHITESPACE"," ",435],["T_DOUBLE_ARROW","=>",435],["T_WHITESPACE"," ",435],["T_LNUMBER","0",435],",",["T_WHITESPACE","\n        ",435],["T_CONSTANT_ENCAPSED_STRING","'unchangeable'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_LNUMBER","0",436],["T_WHITESPACE","\n    ",436],")",")",")",";",["T_WHITESPACE","\n    ",437],["T_VARIABLE","$field_storage",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","save",438],"(",")",";",["T_WHITESPACE","\n    ",438],["T_VARIABLE","$field_storage",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","setSetting",439],"(",["T_CONSTANT_ENCAPSED_STRING","'changeable'",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$field_storage",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getSetting",439],"(",["T_CONSTANT_ENCAPSED_STRING","'changeable'",439],")",["T_WHITESPACE"," ",439],"+",["T_WHITESPACE"," ",439],["T_LNUMBER","1",439],")",";",["T_WHITESPACE","\n    ",439],["T_TRY","try",440],["T_WHITESPACE"," ",440],"{",["T_WHITESPACE","\n      ",440],["T_VARIABLE","$field_storage",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","save",441],"(",")",";",["T_WHITESPACE","\n      ",441],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","pass",442],"(",["T_STRING","t",442],"(",["T_CONSTANT_ENCAPSED_STRING","\"A changeable setting can be updated.\"",442],")",")",";",["T_WHITESPACE","\n    ",442],"}",["T_WHITESPACE","\n    ",443],["T_CATCH","catch",444],["T_WHITESPACE"," ",444],"(",["T_STRING","FieldStorageDefinitionUpdateForbiddenException",444],["T_WHITESPACE"," ",444],["T_VARIABLE","$e",444],")",["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n      ",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","fail",445],"(",["T_STRING","t",445],"(",["T_CONSTANT_ENCAPSED_STRING","\"An unchangeable setting cannot be updated.\"",445],")",")",";",["T_WHITESPACE","\n    ",445],"}",["T_WHITESPACE","\n    ",446],["T_VARIABLE","$field_storage",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","setSetting",447],"(",["T_CONSTANT_ENCAPSED_STRING","'unchangeable'",447],",",["T_WHITESPACE"," ",447],["T_VARIABLE","$field_storage",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","getSetting",447],"(",["T_CONSTANT_ENCAPSED_STRING","'unchangeable'",447],")",["T_WHITESPACE"," ",447],"+",["T_WHITESPACE"," ",447],["T_LNUMBER","1",447],")",";",["T_WHITESPACE","\n    ",447],["T_TRY","try",448],["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n      ",448],["T_VARIABLE","$field_storage",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","save",449],"(",")",";",["T_WHITESPACE","\n      ",449],["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","fail",450],"(",["T_STRING","t",450],"(",["T_CONSTANT_ENCAPSED_STRING","\"An unchangeable setting can be updated.\"",450],")",")",";",["T_WHITESPACE","\n    ",450],"}",["T_WHITESPACE","\n    ",451],["T_CATCH","catch",452],["T_WHITESPACE"," ",452],"(",["T_STRING","FieldStorageDefinitionUpdateForbiddenException",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$e",452],")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n      ",452],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","pass",453],"(",["T_STRING","t",453],"(",["T_CONSTANT_ENCAPSED_STRING","\"An unchangeable setting cannot be updated.\"",453],")",")",";",["T_WHITESPACE","\n    ",453],"}",["T_WHITESPACE","\n  ",454],"}",["T_WHITESPACE","\n\n",455],"}",["T_WHITESPACE","\n",457]]