[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","field",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],["T_NS_SEPARATOR","\\",3],["T_STRING","EntityReference",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Cache",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CacheableMetadata",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Field",7],["T_NS_SEPARATOR","\\",7],["T_STRING","FieldStorageDefinitionInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Field",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Field",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FieldFormatter",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntityReferenceEntityFormatter",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","field",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Entity",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FieldConfig",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","field",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Entity",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FieldStorageConfig",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","field",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Tests",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EntityReference",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EntityReferenceTestTrait",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","filter",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Entity",12],["T_NS_SEPARATOR","\\",12],["T_STRING","FilterFormat",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Drupal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","KernelTests",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Core",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Entity",13],["T_NS_SEPARATOR","\\",13],["T_STRING","EntityKernelTestBase",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Drupal",14],["T_NS_SEPARATOR","\\",14],["T_STRING","user",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Entity",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Role",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Drupal",15],["T_NS_SEPARATOR","\\",15],["T_STRING","user",15],["T_NS_SEPARATOR","\\",15],["T_STRING","RoleInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Drupal",16],["T_NS_SEPARATOR","\\",16],["T_STRING","entity_test",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Entity",16],["T_NS_SEPARATOR","\\",16],["T_STRING","EntityTestLabel",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * Tests the formatters functionality.\n *\n * @group entity_reference\n *\/",18],["T_WHITESPACE","\n",22],["T_CLASS","class",23],["T_WHITESPACE"," ",23],["T_STRING","EntityReferenceFormatterTest",23],["T_WHITESPACE"," ",23],["T_EXTENDS","extends",23],["T_WHITESPACE"," ",23],["T_STRING","EntityKernelTestBase",23],["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n\n  ",23],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","EntityReferenceTestTrait",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * The entity type used in this test.\n   *\n   * @var string\n   *\/",27],["T_WHITESPACE","\n  ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$entityType",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",32],";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * The bundle used in this test.\n   *\n   * @var string\n   *\/",34],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$bundle",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",39],";",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * The name of the field used in this test.\n   *\n   * @var string\n   *\/",41],["T_WHITESPACE","\n  ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$fieldName",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'field_test'",46],";",["T_WHITESPACE","\n\n  ",46],["T_DOC_COMMENT","\/**\n   * The entity to be referenced in this test.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityInterface\n   *\/",48],["T_WHITESPACE","\n  ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$referencedEntity",53],";",["T_WHITESPACE","\n\n  ",53],["T_DOC_COMMENT","\/**\n   * The entity that is not yet saved to its persistent storage to be referenced\n   * in this test.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityInterface\n   *\/",55],["T_WHITESPACE","\n  ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$unsavedReferencedEntity",61],";",["T_WHITESPACE","\n\n  ",61],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","setUp",63],"(",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n    ",63],["T_STRING","parent",64],["T_DOUBLE_COLON","::",64],["T_STRING","setUp",64],"(",")",";",["T_WHITESPACE","\n\n    ",64],["T_COMMENT","\/\/ Use Classy theme for testing markup output.\n",66],["T_WHITESPACE","    ",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Drupal",67],["T_DOUBLE_COLON","::",67],["T_STRING","service",67],"(",["T_CONSTANT_ENCAPSED_STRING","'theme_handler'",67],")",["T_OBJECT_OPERATOR","->",67],["T_STRING","install",67],"(","[",["T_CONSTANT_ENCAPSED_STRING","'classy'",67],"]",")",";",["T_WHITESPACE","\n    ",67],["T_NS_SEPARATOR","\\",68],["T_STRING","Drupal",68],["T_DOUBLE_COLON","::",68],["T_STRING","service",68],"(",["T_CONSTANT_ENCAPSED_STRING","'theme_handler'",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","setDefault",68],"(",["T_CONSTANT_ENCAPSED_STRING","'classy'",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","installEntitySchema",69],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",69],")",";",["T_WHITESPACE","\n    ",69],["T_COMMENT","\/\/ Grant the 'view test entity' permission.\n",70],["T_WHITESPACE","    ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","installConfig",71],"(",["T_ARRAY","array",71],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",71],")",")",";",["T_WHITESPACE","\n    ",71],["T_STRING","Role",72],["T_DOUBLE_COLON","::",72],["T_STRING","load",72],"(",["T_STRING","RoleInterface",72],["T_DOUBLE_COLON","::",72],["T_STRING","ANONYMOUS_ID",72],")",["T_WHITESPACE","\n      ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","grantPermission",73],"(",["T_CONSTANT_ENCAPSED_STRING","'view test entity'",73],")",["T_WHITESPACE","\n      ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","save",74],"(",")",";",["T_WHITESPACE","\n\n    ",74],["T_COMMENT","\/\/ The label formatter rendering generates links, so build the router.\n",76],["T_WHITESPACE","    ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","container",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","get",77],"(",["T_CONSTANT_ENCAPSED_STRING","'router.builder'",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","rebuild",77],"(",")",";",["T_WHITESPACE","\n\n    ",77],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","createEntityReferenceField",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","entityType",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","bundle",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","fieldName",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'Field test'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","entityType",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'default'",79],",",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",")",",",["T_WHITESPACE"," ",79],["T_STRING","FieldStorageDefinitionInterface",79],["T_DOUBLE_COLON","::",79],["T_STRING","CARDINALITY_UNLIMITED",79],")",";",["T_WHITESPACE","\n\n    ",79],["T_COMMENT","\/\/ Set up a field, so that the entity that'll be referenced bubbles up a\n",81],["T_WHITESPACE","    ",82],["T_COMMENT","\/\/ cache tag when rendering it entirely.\n",82],["T_WHITESPACE","    ",83],["T_STRING","FieldStorageConfig",83],["T_DOUBLE_COLON","::",83],["T_STRING","create",83],"(",["T_ARRAY","array",83],"(",["T_WHITESPACE","\n      ",83],["T_CONSTANT_ENCAPSED_STRING","'field_name'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'body'",84],",",["T_WHITESPACE","\n      ",84],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","entityType",85],",",["T_WHITESPACE","\n      ",85],["T_CONSTANT_ENCAPSED_STRING","'type'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'text'",86],",",["T_WHITESPACE","\n      ",86],["T_CONSTANT_ENCAPSED_STRING","'settings'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",")",",",["T_WHITESPACE","\n    ",87],")",")",["T_OBJECT_OPERATOR","->",88],["T_STRING","save",88],"(",")",";",["T_WHITESPACE","\n    ",88],["T_STRING","FieldConfig",89],["T_DOUBLE_COLON","::",89],["T_STRING","create",89],"(","[",["T_WHITESPACE","\n      ",89],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","entityType",90],",",["T_WHITESPACE","\n      ",90],["T_CONSTANT_ENCAPSED_STRING","'bundle'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","bundle",91],",",["T_WHITESPACE","\n      ",91],["T_CONSTANT_ENCAPSED_STRING","'field_name'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'body'",92],",",["T_WHITESPACE","\n      ",92],["T_CONSTANT_ENCAPSED_STRING","'label'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'Body'",93],",",["T_WHITESPACE","\n    ",93],"]",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","save",94],"(",")",";",["T_WHITESPACE","\n    ",94],["T_STRING","entity_get_display",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","entityType",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","bundle",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'default'",95],")",["T_WHITESPACE","\n      ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","setComponent",96],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",96],",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_WHITESPACE","\n        ",96],["T_CONSTANT_ENCAPSED_STRING","'type'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'text_default'",97],",",["T_WHITESPACE","\n        ",97],["T_CONSTANT_ENCAPSED_STRING","'settings'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",")",",",["T_WHITESPACE","\n      ",98],")",")",["T_WHITESPACE","\n      ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","save",100],"(",")",";",["T_WHITESPACE","\n\n    ",100],["T_STRING","FilterFormat",102],["T_DOUBLE_COLON","::",102],["T_STRING","create",102],"(",["T_ARRAY","array",102],"(",["T_WHITESPACE","\n      ",102],["T_CONSTANT_ENCAPSED_STRING","'format'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'full_html'",103],",",["T_WHITESPACE","\n      ",103],["T_CONSTANT_ENCAPSED_STRING","'name'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'Full HTML'",104],",",["T_WHITESPACE","\n    ",104],")",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","save",105],"(",")",";",["T_WHITESPACE","\n\n    ",105],["T_COMMENT","\/\/ Create the entity to be referenced.\n",107],["T_WHITESPACE","    ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","referencedEntity",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","container",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","get",108],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",108],")",["T_WHITESPACE","\n      ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","getStorage",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","entityType",109],")",["T_WHITESPACE","\n      ",109],["T_OBJECT_OPERATOR","->",110],["T_STRING","create",110],"(",["T_ARRAY","array",110],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","randomMachineName",110],"(",")",")",")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","referencedEntity",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","body",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",["T_WHITESPACE","\n      ",111],["T_CONSTANT_ENCAPSED_STRING","'value'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'<p>Hello, world!<\/p>'",112],",",["T_WHITESPACE","\n      ",112],["T_CONSTANT_ENCAPSED_STRING","'format'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'full_html'",113],",",["T_WHITESPACE","\n    ",113],")",";",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","referencedEntity",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","save",115],"(",")",";",["T_WHITESPACE","\n\n    ",115],["T_COMMENT","\/\/ Create another entity to be referenced but do not save it.\n",117],["T_WHITESPACE","    ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","unsavedReferencedEntity",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","container",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","get",118],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",118],")",["T_WHITESPACE","\n      ",118],["T_OBJECT_OPERATOR","->",119],["T_STRING","getStorage",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","entityType",119],")",["T_WHITESPACE","\n      ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","create",120],"(",["T_ARRAY","array",120],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","randomMachineName",120],"(",")",")",")",";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","unsavedReferencedEntity",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","body",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_ARRAY","array",121],"(",["T_WHITESPACE","\n      ",121],["T_CONSTANT_ENCAPSED_STRING","'value'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'<p>Hello, unsaved world!<\/p>'",122],",",["T_WHITESPACE","\n      ",122],["T_CONSTANT_ENCAPSED_STRING","'format'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'full_html'",123],",",["T_WHITESPACE","\n    ",123],")",";",["T_WHITESPACE","\n  ",124],"}",["T_WHITESPACE","\n\n  ",125],["T_DOC_COMMENT","\/**\n   * Assert inaccessible items don't change the data of the fields.\n   *\/",127],["T_WHITESPACE","\n  ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","testAccess",130],"(",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n    ",130],["T_COMMENT","\/\/ Revoke the 'view test entity' permission for this test.\n",131],["T_WHITESPACE","    ",132],["T_STRING","Role",132],["T_DOUBLE_COLON","::",132],["T_STRING","load",132],"(",["T_STRING","RoleInterface",132],["T_DOUBLE_COLON","::",132],["T_STRING","ANONYMOUS_ID",132],")",["T_WHITESPACE","\n      ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","revokePermission",133],"(",["T_CONSTANT_ENCAPSED_STRING","'view test entity'",133],")",["T_WHITESPACE","\n      ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","save",134],"(",")",";",["T_WHITESPACE","\n\n    ",134],["T_VARIABLE","$field_name",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","fieldName",136],";",["T_WHITESPACE","\n\n    ",136],["T_VARIABLE","$referencing_entity",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","container",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","get",138],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",138],")",["T_WHITESPACE","\n      ",138],["T_OBJECT_OPERATOR","->",139],["T_STRING","getStorage",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","entityType",139],")",["T_WHITESPACE","\n      ",139],["T_OBJECT_OPERATOR","->",140],["T_STRING","create",140],"(",["T_ARRAY","array",140],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","randomMachineName",140],"(",")",")",")",";",["T_WHITESPACE","\n    ",140],["T_VARIABLE","$referencing_entity",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","save",141],"(",")",";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$referencing_entity",142],["T_OBJECT_OPERATOR","->",142],"{",["T_VARIABLE","$field_name",142],"}",["T_OBJECT_OPERATOR","->",142],["T_STRING","entity",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","referencedEntity",142],";",["T_WHITESPACE","\n\n    ",142],["T_COMMENT","\/\/ Assert user doesn't have access to the entity.\n",144],["T_WHITESPACE","    ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","assertFalse",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","referencedEntity",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","access",145],"(",["T_CONSTANT_ENCAPSED_STRING","'view'",145],")",",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'Current user does not have access to view the referenced entity.'",145],")",";",["T_WHITESPACE","\n\n    ",145],["T_VARIABLE","$formatter_manager",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","container",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","get",147],"(",["T_CONSTANT_ENCAPSED_STRING","'plugin.manager.field.formatter'",147],")",";",["T_WHITESPACE","\n\n    ",147],["T_COMMENT","\/\/ Get all the existing formatters.\n",149],["T_WHITESPACE","    ",150],["T_FOREACH","foreach",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$formatter_manager",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getOptions",150],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_reference'",150],")",["T_WHITESPACE"," ",150],["T_AS","as",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$formatter",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$name",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n      ",150],["T_COMMENT","\/\/ Set formatter type for the 'full' view mode.\n",151],["T_WHITESPACE","      ",152],["T_STRING","entity_get_display",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","entityType",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","bundle",152],",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'default'",152],")",["T_WHITESPACE","\n        ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","setComponent",153],"(",["T_VARIABLE","$field_name",153],",",["T_WHITESPACE"," ",153],["T_ARRAY","array",153],"(",["T_WHITESPACE","\n          ",153],["T_CONSTANT_ENCAPSED_STRING","'type'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$formatter",154],",",["T_WHITESPACE","\n        ",154],")",")",["T_WHITESPACE","\n        ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","save",156],"(",")",";",["T_WHITESPACE","\n\n      ",156],["T_COMMENT","\/\/ Invoke entity view.\n",158],["T_WHITESPACE","      ",159],["T_STRING","entity_view",159],"(",["T_VARIABLE","$referencing_entity",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'default'",159],")",";",["T_WHITESPACE","\n\n      ",159],["T_COMMENT","\/\/ Verify the un-accessible item still exists.\n",161],["T_WHITESPACE","      ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","assertEqual",162],"(",["T_VARIABLE","$referencing_entity",162],["T_OBJECT_OPERATOR","->",162],"{",["T_VARIABLE","$field_name",162],"}",["T_OBJECT_OPERATOR","->",162],["T_STRING","target_id",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","referencedEntity",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","id",162],"(",")",",",["T_WHITESPACE"," ",162],["T_STRING","format_string",162],"(",["T_CONSTANT_ENCAPSED_STRING","'The un-accessible item still exists after @name formatter was executed.'",162],",",["T_WHITESPACE"," ",162],["T_ARRAY","array",162],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$name",162],")",")",")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n  ",163],"}",["T_WHITESPACE","\n\n  ",164],["T_DOC_COMMENT","\/**\n   * Tests the ID formatter.\n   *\/",166],["T_WHITESPACE","\n  ",168],["T_PUBLIC","public",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","testIdFormatter",169],"(",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n    ",169],["T_VARIABLE","$formatter",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'entity_reference_entity_id'",170],";",["T_WHITESPACE","\n    ",170],["T_VARIABLE","$build",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","buildRenderArray",171],"(","[",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","referencedEntity",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","unsavedReferencedEntity",171],"]",",",["T_WHITESPACE"," ",171],["T_VARIABLE","$formatter",171],")",";",["T_WHITESPACE","\n\n    ",171],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","assertEqual",173],"(",["T_VARIABLE","$build",173],"[",["T_LNUMBER","0",173],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#plain_text'",173],"]",",",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","referencedEntity",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","id",173],"(",")",",",["T_WHITESPACE"," ",173],["T_STRING","sprintf",173],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a saved entity.'",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$formatter",173],")",")",";",["T_WHITESPACE","\n    ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","assertEqual",174],"(",["T_VARIABLE","$build",174],"[",["T_LNUMBER","0",174],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#cache'",174],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tags'",174],"]",",",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","referencedEntity",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getCacheTags",174],"(",")",",",["T_WHITESPACE"," ",174],["T_STRING","sprintf",174],"(",["T_CONSTANT_ENCAPSED_STRING","'The %s formatter has the expected cache tags.'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$formatter",174],")",")",";",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","assertTrue",175],"(","!",["T_ISSET","isset",175],"(",["T_VARIABLE","$build",175],"[",["T_LNUMBER","1",175],"]",")",",",["T_WHITESPACE"," ",175],["T_STRING","sprintf",175],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a unsaved entity.'",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$formatter",175],")",")",";",["T_WHITESPACE","\n  ",175],"}",["T_WHITESPACE","\n\n  ",176],["T_DOC_COMMENT","\/**\n   * Tests the entity formatter.\n   *\/",178],["T_WHITESPACE","\n  ",180],["T_PUBLIC","public",181],["T_WHITESPACE"," ",181],["T_FUNCTION","function",181],["T_WHITESPACE"," ",181],["T_STRING","testEntityFormatter",181],"(",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n    ",181],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Render\\RendererInterface $renderer *\/",182],["T_WHITESPACE","\n    ",182],["T_VARIABLE","$renderer",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","container",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","get",183],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",183],")",";",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$formatter",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'entity_reference_entity_view'",184],";",["T_WHITESPACE","\n    ",184],["T_VARIABLE","$build",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","buildRenderArray",185],"(","[",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","referencedEntity",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","unsavedReferencedEntity",185],"]",",",["T_WHITESPACE"," ",185],["T_VARIABLE","$formatter",185],")",";",["T_WHITESPACE","\n\n    ",185],["T_COMMENT","\/\/ Test the first field item.\n",187],["T_WHITESPACE","    ",188],["T_VARIABLE","$expected_rendered_name_field_1",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'\n            <div class=\"field field--name-name field--type-string field--label-hidden field__item\">'",188],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","referencedEntity",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","label",189],"(",")",["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'<\/div>\n      '",189],";",["T_WHITESPACE","\n    ",190],["T_VARIABLE","$expected_rendered_body_field_1",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'\n  <div class=\"clearfix text-formatted field field--name-body field--type-text field--label-above\">\n    <div class=\"field__label\">Body<\/div>\n              <div class=\"field__item\"><p>Hello, world!<\/p><\/div>\n          <\/div>\n'",191],";",["T_WHITESPACE","\n    ",196],["T_VARIABLE","$renderer",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","renderRoot",197],"(",["T_VARIABLE","$build",197],"[",["T_LNUMBER","0",197],"]",")",";",["T_WHITESPACE","\n    ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","assertEqual",198],"(",["T_VARIABLE","$build",198],"[",["T_LNUMBER","0",198],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",198],"]",",",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'default | '",198],["T_WHITESPACE"," ",198],".",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","referencedEntity",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","label",198],"(",")",["T_WHITESPACE"," ",198],".",["T_WHITESPACE"," ",198],["T_VARIABLE","$expected_rendered_name_field_1",198],["T_WHITESPACE"," ",198],".",["T_WHITESPACE"," ",198],["T_VARIABLE","$expected_rendered_body_field_1",198],",",["T_WHITESPACE"," ",198],["T_STRING","sprintf",198],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a saved entity.'",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$formatter",198],")",")",";",["T_WHITESPACE","\n    ",198],["T_VARIABLE","$expected_cache_tags",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","Cache",199],["T_DOUBLE_COLON","::",199],["T_STRING","mergeTags",199],"(",["T_NS_SEPARATOR","\\",199],["T_STRING","Drupal",199],["T_DOUBLE_COLON","::",199],["T_STRING","entityManager",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getViewBuilder",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","entityType",199],")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getCacheTags",199],"(",")",",",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","referencedEntity",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getCacheTags",199],"(",")",")",";",["T_WHITESPACE","\n    ",199],["T_VARIABLE","$expected_cache_tags",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","Cache",200],["T_DOUBLE_COLON","::",200],["T_STRING","mergeTags",200],"(",["T_VARIABLE","$expected_cache_tags",200],",",["T_WHITESPACE"," ",200],["T_STRING","FilterFormat",200],["T_DOUBLE_COLON","::",200],["T_STRING","load",200],"(",["T_CONSTANT_ENCAPSED_STRING","'full_html'",200],")",["T_OBJECT_OPERATOR","->",200],["T_STRING","getCacheTags",200],"(",")",")",";",["T_WHITESPACE","\n    ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","assertEqual",201],"(",["T_VARIABLE","$build",201],"[",["T_LNUMBER","0",201],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#cache'",201],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tags'",201],"]",",",["T_WHITESPACE"," ",201],["T_VARIABLE","$expected_cache_tags",201],",",["T_WHITESPACE"," ",201],["T_STRING","format_string",201],"(",["T_CONSTANT_ENCAPSED_STRING","'The @formatter formatter has the expected cache tags.'",201],",",["T_WHITESPACE"," ",201],["T_ARRAY","array",201],"(",["T_CONSTANT_ENCAPSED_STRING","'@formatter'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$formatter",201],")",")",")",";",["T_WHITESPACE","\n\n    ",201],["T_COMMENT","\/\/ Test the second field item.\n",203],["T_WHITESPACE","    ",204],["T_VARIABLE","$expected_rendered_name_field_2",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'\n            <div class=\"field field--name-name field--type-string field--label-hidden field__item\">'",204],["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","unsavedReferencedEntity",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","label",205],"(",")",["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'<\/div>\n      '",205],";",["T_WHITESPACE","\n    ",206],["T_VARIABLE","$expected_rendered_body_field_2",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'\n  <div class=\"clearfix text-formatted field field--name-body field--type-text field--label-above\">\n    <div class=\"field__label\">Body<\/div>\n              <div class=\"field__item\"><p>Hello, unsaved world!<\/p><\/div>\n          <\/div>\n'",207],";",["T_WHITESPACE","\n\n    ",212],["T_VARIABLE","$renderer",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","renderRoot",214],"(",["T_VARIABLE","$build",214],"[",["T_LNUMBER","1",214],"]",")",";",["T_WHITESPACE","\n    ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","assertEqual",215],"(",["T_VARIABLE","$build",215],"[",["T_LNUMBER","1",215],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#markup'",215],"]",",",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'default | '",215],["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","unsavedReferencedEntity",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","label",215],"(",")",["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_VARIABLE","$expected_rendered_name_field_2",215],["T_WHITESPACE"," ",215],".",["T_WHITESPACE"," ",215],["T_VARIABLE","$expected_rendered_body_field_2",215],",",["T_WHITESPACE"," ",215],["T_STRING","sprintf",215],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a unsaved entity.'",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$formatter",215],")",")",";",["T_WHITESPACE","\n  ",215],"}",["T_WHITESPACE","\n\n  ",216],["T_DOC_COMMENT","\/**\n   * Tests the recursive rendering protection of the entity formatter.\n   *\/",218],["T_WHITESPACE","\n  ",220],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","testEntityFormatterRecursiveRendering",221],"(",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n    ",221],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Render\\RendererInterface $renderer *\/",222],["T_WHITESPACE","\n    ",222],["T_VARIABLE","$renderer",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","container",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","get",223],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",223],")",";",["T_WHITESPACE","\n    ",223],["T_VARIABLE","$formatter",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'entity_reference_entity_view'",224],";",["T_WHITESPACE","\n    ",224],["T_VARIABLE","$view_builder",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","entityManager",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getViewBuilder",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","entityType",225],")",";",["T_WHITESPACE","\n\n    ",225],["T_COMMENT","\/\/ Set the default view mode to use the 'entity_reference_entity_view'\n",227],["T_WHITESPACE","    ",228],["T_COMMENT","\/\/ formatter.\n",228],["T_WHITESPACE","    ",229],["T_STRING","entity_get_display",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","entityType",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","bundle",229],",",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'default'",229],")",["T_WHITESPACE","\n      ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","setComponent",230],"(",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","fieldName",230],",",["T_WHITESPACE"," ",230],"[",["T_WHITESPACE","\n        ",230],["T_CONSTANT_ENCAPSED_STRING","'type'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$formatter",231],",",["T_WHITESPACE","\n      ",231],"]",")",["T_WHITESPACE","\n      ",232],["T_OBJECT_OPERATOR","->",233],["T_STRING","save",233],"(",")",";",["T_WHITESPACE","\n\n    ",233],["T_VARIABLE","$referencing_entity_1",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_STRING","entity_create",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","entityType",235],",",["T_WHITESPACE"," ",235],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","randomMachineName",235],"(",")","]",")",";",["T_WHITESPACE","\n    ",235],["T_VARIABLE","$referencing_entity_1",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","save",236],"(",")",";",["T_WHITESPACE","\n\n    ",236],["T_COMMENT","\/\/ Create a self-reference.\n",238],["T_WHITESPACE","    ",239],["T_VARIABLE","$referencing_entity_1",239],["T_OBJECT_OPERATOR","->",239],"{",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","fieldName",239],"}",["T_OBJECT_OPERATOR","->",239],["T_STRING","entity",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$referencing_entity_1",239],";",["T_WHITESPACE","\n    ",239],["T_VARIABLE","$referencing_entity_1",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","save",240],"(",")",";",["T_WHITESPACE","\n\n    ",240],["T_COMMENT","\/\/ Check that the recursive rendering stops after it reaches the specified\n",242],["T_WHITESPACE","    ",243],["T_COMMENT","\/\/ limit.\n",243],["T_WHITESPACE","    ",244],["T_VARIABLE","$build",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$view_builder",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","view",244],"(",["T_VARIABLE","$referencing_entity_1",244],",",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","'default'",244],")",";",["T_WHITESPACE","\n    ",244],["T_VARIABLE","$output",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$renderer",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","renderRoot",245],"(",["T_VARIABLE","$build",245],")",";",["T_WHITESPACE","\n\n    ",245],["T_COMMENT","\/\/ The title of entity_test entities is printed twice by default, so we have\n",247],["T_WHITESPACE","    ",248],["T_COMMENT","\/\/ to multiply the formatter's recursive rendering protection limit by 2.\n",248],["T_WHITESPACE","    ",249],["T_COMMENT","\/\/ Additionally, we have to take into account 2 additional occurrences of\n",249],["T_WHITESPACE","    ",250],["T_COMMENT","\/\/ the entity title because we're rendering the full entity, not just the\n",250],["T_WHITESPACE","    ",251],["T_COMMENT","\/\/ reference field.\n",251],["T_WHITESPACE","    ",252],["T_VARIABLE","$expected_occurrences",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_STRING","EntityReferenceEntityFormatter",252],["T_DOUBLE_COLON","::",252],["T_STRING","RECURSIVE_RENDER_LIMIT",252],["T_WHITESPACE"," ",252],"*",["T_WHITESPACE"," ",252],["T_LNUMBER","2",252],["T_WHITESPACE"," ",252],"+",["T_WHITESPACE"," ",252],["T_LNUMBER","2",252],";",["T_WHITESPACE","\n    ",252],["T_VARIABLE","$actual_occurrences",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_STRING","substr_count",253],"(",["T_VARIABLE","$output",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$referencing_entity_1",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","name",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","value",253],")",";",["T_WHITESPACE","\n    ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","assertEqual",254],"(",["T_VARIABLE","$actual_occurrences",254],",",["T_WHITESPACE"," ",254],["T_VARIABLE","$expected_occurrences",254],")",";",["T_WHITESPACE","\n\n    ",254],["T_COMMENT","\/\/ Repeat the process with another entity in order to check that the\n",256],["T_WHITESPACE","    ",257],["T_COMMENT","\/\/ 'recursive_render_id' counter is generated properly.\n",257],["T_WHITESPACE","    ",258],["T_VARIABLE","$referencing_entity_2",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_STRING","entity_create",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","entityType",258],",",["T_WHITESPACE"," ",258],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","randomMachineName",258],"(",")","]",")",";",["T_WHITESPACE","\n    ",258],["T_VARIABLE","$referencing_entity_2",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","save",259],"(",")",";",["T_WHITESPACE","\n    ",259],["T_VARIABLE","$referencing_entity_2",260],["T_OBJECT_OPERATOR","->",260],"{",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","fieldName",260],"}",["T_OBJECT_OPERATOR","->",260],["T_STRING","entity",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_VARIABLE","$referencing_entity_2",260],";",["T_WHITESPACE","\n    ",260],["T_VARIABLE","$referencing_entity_2",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","save",261],"(",")",";",["T_WHITESPACE","\n\n    ",261],["T_VARIABLE","$build",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$view_builder",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","view",263],"(",["T_VARIABLE","$referencing_entity_2",263],",",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'default'",263],")",";",["T_WHITESPACE","\n    ",263],["T_VARIABLE","$output",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$renderer",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","renderRoot",264],"(",["T_VARIABLE","$build",264],")",";",["T_WHITESPACE","\n\n    ",264],["T_VARIABLE","$actual_occurrences",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_STRING","substr_count",266],"(",["T_VARIABLE","$output",266],",",["T_WHITESPACE"," ",266],["T_VARIABLE","$referencing_entity_2",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","name",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","value",266],")",";",["T_WHITESPACE","\n    ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","assertEqual",267],"(",["T_VARIABLE","$actual_occurrences",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$expected_occurrences",267],")",";",["T_WHITESPACE","\n\n    ",267],["T_COMMENT","\/\/ Now render both entities at the same time and check again.\n",269],["T_WHITESPACE","    ",270],["T_VARIABLE","$build",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$view_builder",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","viewMultiple",270],"(","[",["T_VARIABLE","$referencing_entity_1",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$referencing_entity_2",270],"]",",",["T_WHITESPACE"," ",270],["T_CONSTANT_ENCAPSED_STRING","'default'",270],")",";",["T_WHITESPACE","\n    ",270],["T_VARIABLE","$output",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$renderer",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","renderRoot",271],"(",["T_VARIABLE","$build",271],")",";",["T_WHITESPACE","\n\n    ",271],["T_VARIABLE","$actual_occurrences",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","substr_count",273],"(",["T_VARIABLE","$output",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$referencing_entity_1",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","name",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","value",273],")",";",["T_WHITESPACE","\n    ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","assertEqual",274],"(",["T_VARIABLE","$actual_occurrences",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$expected_occurrences",274],")",";",["T_WHITESPACE","\n\n    ",274],["T_VARIABLE","$actual_occurrences",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_STRING","substr_count",276],"(",["T_VARIABLE","$output",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$referencing_entity_2",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","name",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","value",276],")",";",["T_WHITESPACE","\n    ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","assertEqual",277],"(",["T_VARIABLE","$actual_occurrences",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$expected_occurrences",277],")",";",["T_WHITESPACE","\n  ",277],"}",["T_WHITESPACE","\n\n  ",278],["T_DOC_COMMENT","\/**\n   * Renders the same entity referenced from different places.\n   *\/",280],["T_WHITESPACE","\n  ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","testEntityReferenceRecursiveProtectionWithManyRenderedEntities",283],"(",")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n    ",283],["T_VARIABLE","$formatter",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_CONSTANT_ENCAPSED_STRING","'entity_reference_entity_view'",284],";",["T_WHITESPACE","\n    ",284],["T_VARIABLE","$view_builder",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","entityManager",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getViewBuilder",285],"(",["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","entityType",285],")",";",["T_WHITESPACE","\n\n    ",285],["T_COMMENT","\/\/ Set the default view mode to use the 'entity_reference_entity_view'\n",287],["T_WHITESPACE","    ",288],["T_COMMENT","\/\/ formatter.\n",288],["T_WHITESPACE","    ",289],["T_STRING","entity_get_display",289],"(",["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","entityType",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","bundle",289],",",["T_WHITESPACE"," ",289],["T_CONSTANT_ENCAPSED_STRING","'default'",289],")",["T_WHITESPACE","\n      ",289],["T_OBJECT_OPERATOR","->",290],["T_STRING","setComponent",290],"(",["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","fieldName",290],",",["T_WHITESPACE"," ",290],"[",["T_WHITESPACE","\n        ",290],["T_CONSTANT_ENCAPSED_STRING","'type'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$formatter",291],",",["T_WHITESPACE","\n      ",291],"]",")",["T_WHITESPACE","\n      ",292],["T_OBJECT_OPERATOR","->",293],["T_STRING","save",293],"(",")",";",["T_WHITESPACE","\n\n    ",293],["T_VARIABLE","$storage",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","entityManager",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getStorage",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","entityType",295],")",";",["T_WHITESPACE","\n    ",295],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\ContentEntityInterface $referenced_entity *\/",296],["T_WHITESPACE","\n    ",296],["T_VARIABLE","$referenced_entity",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$storage",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","create",297],"(","[",["T_CONSTANT_ENCAPSED_STRING","'name'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","randomMachineName",297],"(",")","]",")",";",["T_WHITESPACE","\n\n    ",297],["T_VARIABLE","$range",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_STRING","range",299],"(",["T_LNUMBER","0",299],",",["T_WHITESPACE"," ",299],["T_LNUMBER","30",299],")",";",["T_WHITESPACE","\n    ",299],["T_VARIABLE","$referencing_entities",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_STRING","array_map",300],"(",["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],"(",")",["T_WHITESPACE"," ",300],["T_USE","use",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$storage",300],",",["T_WHITESPACE"," ",300],["T_VARIABLE","$referenced_entity",300],")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n      ",300],["T_VARIABLE","$referencing_entity",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_VARIABLE","$storage",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","create",301],"(","[",["T_WHITESPACE","\n        ",301],["T_CONSTANT_ENCAPSED_STRING","'name'",302],["T_WHITESPACE"," ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","randomMachineName",302],"(",")",",",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","fieldName",303],["T_WHITESPACE"," ",303],["T_DOUBLE_ARROW","=>",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$referenced_entity",303],",",["T_WHITESPACE","\n      ",303],"]",")",";",["T_WHITESPACE","\n      ",304],["T_VARIABLE","$referencing_entity",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","save",305],"(",")",";",["T_WHITESPACE","\n      ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$referencing_entity",306],";",["T_WHITESPACE","\n    ",306],"}",",",["T_WHITESPACE"," ",307],["T_VARIABLE","$range",307],")",";",["T_WHITESPACE","\n\n    ",307],["T_VARIABLE","$build",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$view_builder",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","viewMultiple",309],"(",["T_VARIABLE","$referencing_entities",309],",",["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'default'",309],")",";",["T_WHITESPACE","\n    ",309],["T_VARIABLE","$output",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","render",310],"(",["T_VARIABLE","$build",310],")",";",["T_WHITESPACE","\n\n    ",310],["T_COMMENT","\/\/ The title of entity_test entities is printed twice by default, so we have\n",312],["T_WHITESPACE","    ",313],["T_COMMENT","\/\/ to multiply the formatter's recursive rendering protection limit by 2.\n",313],["T_WHITESPACE","    ",314],["T_COMMENT","\/\/ Additionally, we have to take into account 2 additional occurrences of\n",314],["T_WHITESPACE","    ",315],["T_COMMENT","\/\/ the entity title because we're rendering the full entity, not just the\n",315],["T_WHITESPACE","    ",316],["T_COMMENT","\/\/ reference field.\n",316],["T_WHITESPACE","    ",317],["T_VARIABLE","$expected_occurrences",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_LNUMBER","30",317],["T_WHITESPACE"," ",317],"*",["T_WHITESPACE"," ",317],["T_LNUMBER","2",317],["T_WHITESPACE"," ",317],"+",["T_WHITESPACE"," ",317],["T_LNUMBER","2",317],";",["T_WHITESPACE","\n    ",317],["T_VARIABLE","$actual_occurrences",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_STRING","substr_count",318],"(",["T_VARIABLE","$output",318],",",["T_WHITESPACE"," ",318],["T_VARIABLE","$referenced_entity",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","get",318],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",318],")",["T_OBJECT_OPERATOR","->",318],["T_STRING","value",318],")",";",["T_WHITESPACE","\n    ",318],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","assertEquals",319],"(",["T_VARIABLE","$expected_occurrences",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$actual_occurrences",319],")",";",["T_WHITESPACE","\n  ",319],"}",["T_WHITESPACE","\n\n\n  ",320],["T_DOC_COMMENT","\/**\n   * Tests the label formatter.\n   *\/",323],["T_WHITESPACE","\n  ",325],["T_PUBLIC","public",326],["T_WHITESPACE"," ",326],["T_FUNCTION","function",326],["T_WHITESPACE"," ",326],["T_STRING","testLabelFormatter",326],"(",")",["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n    ",326],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","installEntitySchema",327],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test_label'",327],")",";",["T_WHITESPACE","\n    ",327],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Render\\RendererInterface $renderer *\/",328],["T_WHITESPACE","\n    ",328],["T_VARIABLE","$renderer",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","container",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",329],")",";",["T_WHITESPACE","\n    ",329],["T_VARIABLE","$formatter",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_CONSTANT_ENCAPSED_STRING","'entity_reference_label'",330],";",["T_WHITESPACE","\n\n    ",330],["T_COMMENT","\/\/ The 'link' settings is TRUE by default.\n",332],["T_WHITESPACE","    ",333],["T_VARIABLE","$build",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","buildRenderArray",333],"(","[",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","referencedEntity",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","unsavedReferencedEntity",333],"]",",",["T_WHITESPACE"," ",333],["T_VARIABLE","$formatter",333],")",";",["T_WHITESPACE","\n\n    ",333],["T_VARIABLE","$expected_field_cacheability",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],"[",["T_WHITESPACE","\n      ",335],["T_CONSTANT_ENCAPSED_STRING","'contexts'",336],["T_WHITESPACE"," ",336],["T_DOUBLE_ARROW","=>",336],["T_WHITESPACE"," ",336],"[","]",",",["T_WHITESPACE","\n      ",336],["T_CONSTANT_ENCAPSED_STRING","'tags'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],"[","]",",",["T_WHITESPACE","\n      ",337],["T_CONSTANT_ENCAPSED_STRING","'max-age'",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_STRING","Cache",338],["T_DOUBLE_COLON","::",338],["T_STRING","PERMANENT",338],",",["T_WHITESPACE","\n    ",338],"]",";",["T_WHITESPACE","\n    ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","assertEqual",340],"(",["T_VARIABLE","$build",340],"[",["T_CONSTANT_ENCAPSED_STRING","'#cache'",340],"]",",",["T_WHITESPACE"," ",340],["T_VARIABLE","$expected_field_cacheability",340],",",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'The field render array contains the entity access cacheability metadata'",340],")",";",["T_WHITESPACE","\n    ",340],["T_VARIABLE","$expected_item_1",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_ARRAY","array",341],"(",["T_WHITESPACE","\n      ",341],["T_CONSTANT_ENCAPSED_STRING","'#type'",342],["T_WHITESPACE"," ",342],["T_DOUBLE_ARROW","=>",342],["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","'link'",342],",",["T_WHITESPACE","\n      ",342],["T_CONSTANT_ENCAPSED_STRING","'#title'",343],["T_WHITESPACE"," ",343],["T_DOUBLE_ARROW","=>",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","referencedEntity",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","label",343],"(",")",",",["T_WHITESPACE","\n      ",343],["T_CONSTANT_ENCAPSED_STRING","'#url'",344],["T_WHITESPACE"," ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","referencedEntity",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","urlInfo",344],"(",")",",",["T_WHITESPACE","\n      ",344],["T_CONSTANT_ENCAPSED_STRING","'#options'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","referencedEntity",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","urlInfo",345],"(",")",["T_OBJECT_OPERATOR","->",345],["T_STRING","getOptions",345],"(",")",",",["T_WHITESPACE","\n      ",345],["T_CONSTANT_ENCAPSED_STRING","'#cache'",346],["T_WHITESPACE"," ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],["T_ARRAY","array",346],"(",["T_WHITESPACE","\n        ",346],["T_CONSTANT_ENCAPSED_STRING","'contexts'",347],["T_WHITESPACE"," ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],"[",["T_WHITESPACE","\n          ",347],["T_CONSTANT_ENCAPSED_STRING","'user.permissions'",348],",",["T_WHITESPACE","\n        ",348],"]",",",["T_WHITESPACE","\n        ",349],["T_CONSTANT_ENCAPSED_STRING","'tags'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","referencedEntity",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getCacheTags",350],"(",")",",",["T_WHITESPACE","\n      ",350],")",",",["T_WHITESPACE","\n    ",351],")",";",["T_WHITESPACE","\n    ",352],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","assertEqual",353],"(",["T_VARIABLE","$renderer",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","renderRoot",353],"(",["T_VARIABLE","$build",353],"[",["T_LNUMBER","0",353],"]",")",",",["T_WHITESPACE"," ",353],["T_VARIABLE","$renderer",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","renderRoot",353],"(",["T_VARIABLE","$expected_item_1",353],")",",",["T_WHITESPACE"," ",353],["T_STRING","sprintf",353],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a saved entity.'",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$formatter",353],")",")",";",["T_WHITESPACE","\n    ",353],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","assertEqual",354],"(",["T_STRING","CacheableMetadata",354],["T_DOUBLE_COLON","::",354],["T_STRING","createFromRenderArray",354],"(",["T_VARIABLE","$build",354],"[",["T_LNUMBER","0",354],"]",")",",",["T_WHITESPACE"," ",354],["T_STRING","CacheableMetadata",354],["T_DOUBLE_COLON","::",354],["T_STRING","createFromRenderArray",354],"(",["T_VARIABLE","$expected_item_1",354],")",")",";",["T_WHITESPACE","\n\n    ",354],["T_COMMENT","\/\/ The second referenced entity is \"autocreated\", therefore not saved and\n",356],["T_WHITESPACE","    ",357],["T_COMMENT","\/\/ lacking any URL info.\n",357],["T_WHITESPACE","    ",358],["T_VARIABLE","$expected_item_2",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_ARRAY","array",358],"(",["T_WHITESPACE","\n      ",358],["T_CONSTANT_ENCAPSED_STRING","'#plain_text'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","unsavedReferencedEntity",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","label",359],"(",")",",",["T_WHITESPACE","\n      ",359],["T_CONSTANT_ENCAPSED_STRING","'#cache'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_ARRAY","array",360],"(",["T_WHITESPACE","\n        ",360],["T_CONSTANT_ENCAPSED_STRING","'contexts'",361],["T_WHITESPACE"," ",361],["T_DOUBLE_ARROW","=>",361],["T_WHITESPACE"," ",361],"[",["T_WHITESPACE","\n          ",361],["T_CONSTANT_ENCAPSED_STRING","'user.permissions'",362],",",["T_WHITESPACE","\n        ",362],"]",",",["T_WHITESPACE","\n        ",363],["T_CONSTANT_ENCAPSED_STRING","'tags'",364],["T_WHITESPACE"," ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","unsavedReferencedEntity",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getCacheTags",364],"(",")",",",["T_WHITESPACE","\n        ",364],["T_CONSTANT_ENCAPSED_STRING","'max-age'",365],["T_WHITESPACE"," ",365],["T_DOUBLE_ARROW","=>",365],["T_WHITESPACE"," ",365],["T_STRING","Cache",365],["T_DOUBLE_COLON","::",365],["T_STRING","PERMANENT",365],",",["T_WHITESPACE","\n      ",365],")",",",["T_WHITESPACE","\n    ",366],")",";",["T_WHITESPACE","\n    ",367],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","assertEqual",368],"(",["T_VARIABLE","$build",368],"[",["T_LNUMBER","1",368],"]",",",["T_WHITESPACE"," ",368],["T_VARIABLE","$expected_item_2",368],",",["T_WHITESPACE"," ",368],["T_STRING","sprintf",368],"(",["T_CONSTANT_ENCAPSED_STRING","'The render array returned by the %s formatter is correct for an item with a unsaved entity.'",368],",",["T_WHITESPACE"," ",368],["T_VARIABLE","$formatter",368],")",")",";",["T_WHITESPACE","\n\n    ",368],["T_COMMENT","\/\/ Test with the 'link' setting set to FALSE.\n",370],["T_WHITESPACE","    ",371],["T_VARIABLE","$build",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","buildRenderArray",371],"(","[",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","referencedEntity",371],",",["T_WHITESPACE"," ",371],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","unsavedReferencedEntity",371],"]",",",["T_WHITESPACE"," ",371],["T_VARIABLE","$formatter",371],",",["T_WHITESPACE"," ",371],["T_ARRAY","array",371],"(",["T_CONSTANT_ENCAPSED_STRING","'link'",371],["T_WHITESPACE"," ",371],["T_DOUBLE_ARROW","=>",371],["T_WHITESPACE"," ",371],["T_STRING","FALSE",371],")",")",";",["T_WHITESPACE","\n    ",371],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","assertEqual",372],"(",["T_VARIABLE","$build",372],"[",["T_LNUMBER","0",372],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#plain_text'",372],"]",",",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","referencedEntity",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","label",372],"(",")",",",["T_WHITESPACE"," ",372],["T_STRING","sprintf",372],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a saved entity.'",372],",",["T_WHITESPACE"," ",372],["T_VARIABLE","$formatter",372],")",")",";",["T_WHITESPACE","\n    ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","assertEqual",373],"(",["T_VARIABLE","$build",373],"[",["T_LNUMBER","1",373],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#plain_text'",373],"]",",",["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","unsavedReferencedEntity",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","label",373],"(",")",",",["T_WHITESPACE"," ",373],["T_STRING","sprintf",373],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an item with a unsaved entity.'",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$formatter",373],")",")",";",["T_WHITESPACE","\n\n    ",373],["T_COMMENT","\/\/ Test an entity type that doesn't have any link templates, which means\n",375],["T_WHITESPACE","    ",376],["T_COMMENT","\/\/ \\Drupal\\Core\\Entity\\EntityInterface::urlInfo() will throw an exception\n",376],["T_WHITESPACE","    ",377],["T_COMMENT","\/\/ and the label formatter will output only the label instead of a link.\n",377],["T_WHITESPACE","    ",378],["T_VARIABLE","$field_storage_config",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_STRING","FieldStorageConfig",378],["T_DOUBLE_COLON","::",378],["T_STRING","loadByName",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","entityType",378],",",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","fieldName",378],")",";",["T_WHITESPACE","\n    ",378],["T_VARIABLE","$field_storage_config",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","setSetting",379],"(",["T_CONSTANT_ENCAPSED_STRING","'target_type'",379],",",["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","'entity_test_label'",379],")",";",["T_WHITESPACE","\n    ",379],["T_VARIABLE","$field_storage_config",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","save",380],"(",")",";",["T_WHITESPACE","\n\n    ",380],["T_VARIABLE","$referenced_entity_with_no_link_template",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_STRING","EntityTestLabel",382],["T_DOUBLE_COLON","::",382],["T_STRING","create",382],"(",["T_ARRAY","array",382],"(",["T_WHITESPACE","\n      ",382],["T_CONSTANT_ENCAPSED_STRING","'name'",383],["T_WHITESPACE"," ",383],["T_DOUBLE_ARROW","=>",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","randomMachineName",383],"(",")",",",["T_WHITESPACE","\n    ",383],")",")",";",["T_WHITESPACE","\n    ",384],["T_VARIABLE","$referenced_entity_with_no_link_template",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","save",385],"(",")",";",["T_WHITESPACE","\n\n    ",385],["T_VARIABLE","$build",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","buildRenderArray",387],"(","[",["T_VARIABLE","$referenced_entity_with_no_link_template",387],"]",",",["T_WHITESPACE"," ",387],["T_VARIABLE","$formatter",387],",",["T_WHITESPACE"," ",387],["T_ARRAY","array",387],"(",["T_CONSTANT_ENCAPSED_STRING","'link'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_STRING","TRUE",387],")",")",";",["T_WHITESPACE","\n    ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","assertEqual",388],"(",["T_VARIABLE","$build",388],"[",["T_LNUMBER","0",388],"]","[",["T_CONSTANT_ENCAPSED_STRING","'#plain_text'",388],"]",",",["T_WHITESPACE"," ",388],["T_VARIABLE","$referenced_entity_with_no_link_template",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","label",388],"(",")",",",["T_WHITESPACE"," ",388],["T_STRING","sprintf",388],"(",["T_CONSTANT_ENCAPSED_STRING","'The markup returned by the %s formatter is correct for an entity type with no valid link template.'",388],",",["T_WHITESPACE"," ",388],["T_VARIABLE","$formatter",388],")",")",";",["T_WHITESPACE","\n  ",388],"}",["T_WHITESPACE","\n\n  ",389],["T_DOC_COMMENT","\/**\n   * Sets field values and returns a render array as built by\n   * \\Drupal\\Core\\Field\\FieldItemListInterface::view().\n   *\n   * @param \\Drupal\\Core\\Entity\\EntityInterface[] $referenced_entities\n   *   An array of entity objects that will be referenced.\n   * @param string $formatter\n   *   The formatted plugin that will be used for building the render array.\n   * @param array $formatter_options\n   *   Settings specific to the formatter. Defaults to the formatter's default\n   *   settings.\n   *\n   * @return array\n   *   A render array.\n   *\/",391],["T_WHITESPACE","\n  ",405],["T_PROTECTED","protected",406],["T_WHITESPACE"," ",406],["T_FUNCTION","function",406],["T_WHITESPACE"," ",406],["T_STRING","buildRenderArray",406],"(",["T_ARRAY","array",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$referenced_entities",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$formatter",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$formatter_options",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_ARRAY","array",406],"(",")",")",["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n    ",406],["T_COMMENT","\/\/ Create the entity that will have the entity reference field.\n",407],["T_WHITESPACE","    ",408],["T_VARIABLE","$referencing_entity",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","container",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","get",408],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",408],")",["T_WHITESPACE","\n      ",408],["T_OBJECT_OPERATOR","->",409],["T_STRING","getStorage",409],"(",["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","entityType",409],")",["T_WHITESPACE","\n      ",409],["T_OBJECT_OPERATOR","->",410],["T_STRING","create",410],"(",["T_ARRAY","array",410],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",410],["T_WHITESPACE"," ",410],["T_DOUBLE_ARROW","=>",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","randomMachineName",410],"(",")",")",")",";",["T_WHITESPACE","\n\n    ",410],["T_VARIABLE","$items",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$referencing_entity",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","get",412],"(",["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","fieldName",412],")",";",["T_WHITESPACE","\n\n    ",412],["T_COMMENT","\/\/ Assign the referenced entities.\n",414],["T_WHITESPACE","    ",415],["T_FOREACH","foreach",415],["T_WHITESPACE"," ",415],"(",["T_VARIABLE","$referenced_entities",415],["T_WHITESPACE"," ",415],["T_AS","as",415],["T_WHITESPACE"," ",415],["T_VARIABLE","$referenced_entity",415],")",["T_WHITESPACE"," ",415],"{",["T_WHITESPACE","\n      ",415],["T_VARIABLE","$items",416],"[","]",["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",416],["T_WHITESPACE"," ",416],["T_DOUBLE_ARROW","=>",416],["T_WHITESPACE"," ",416],["T_VARIABLE","$referenced_entity",416],"]",";",["T_WHITESPACE","\n    ",416],"}",["T_WHITESPACE","\n\n    ",417],["T_COMMENT","\/\/ Build the renderable array for the field.\n",419],["T_WHITESPACE","    ",420],["T_RETURN","return",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$items",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","view",420],"(",["T_ARRAY","array",420],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",420],["T_WHITESPACE"," ",420],["T_DOUBLE_ARROW","=>",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$formatter",420],",",["T_WHITESPACE"," ",420],["T_CONSTANT_ENCAPSED_STRING","'settings'",420],["T_WHITESPACE"," ",420],["T_DOUBLE_ARROW","=>",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$formatter_options",420],")",")",";",["T_WHITESPACE","\n  ",420],"}",["T_WHITESPACE","\n\n",421],"}",["T_WHITESPACE","\n",423]]