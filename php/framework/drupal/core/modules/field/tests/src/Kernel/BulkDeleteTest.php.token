[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","field",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","EntityInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","field",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","FieldConfig",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","field",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","FieldStorageConfig",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Bulk delete storages and fields, and clean up afterwards.\n *\n * @group field\n *\/",9],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","BulkDeleteTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_STRING","FieldKernelTestBase",14],["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n\n  ",14],["T_DOC_COMMENT","\/**\n   * The fields to use in this test.\n   *\n   * @var array\n   *\/",16],["T_WHITESPACE","\n  ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$fieldStorages",21],";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * The entities to use in this test.\n   *\n   * @var array\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$entities",28],";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * The entities to use in this test, keyed by bundle.\n   *\n   * @var array\n   *\/",30],["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$entitiesByBundles",35],";",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * The bundles for the entities used in this test.\n   *\n   * @var array\n   *\/",37],["T_WHITESPACE","\n  ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$bundles",42],";",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * The entity type to be used in the test classes.\n   *\n   * @var string\n   *\/",44],["T_WHITESPACE","\n  ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$entityTypeId",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",49],";",["T_WHITESPACE","\n\n  ",49],["T_DOC_COMMENT","\/**\n   * Tests that the expected hooks have been invoked on the expected entities.\n   *\n   * @param $expected_hooks\n   *   An array keyed by hook name, with one entry per expected invocation.\n   *   Each entry is the value of the \"$entity\" parameter the hook is expected\n   *   to have been passed.\n   * @param $actual_hooks\n   *   The array of actual hook invocations recorded by field_test_memorize().\n   *\/",51],["T_WHITESPACE","\n  ",60],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","checkHooksInvocations",61],"(",["T_VARIABLE","$expected_hooks",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$actual_hooks",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n    ",61],["T_FOREACH","foreach",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$expected_hooks",62],["T_WHITESPACE"," ",62],["T_AS","as",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$hook",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$invocations",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n      ",62],["T_VARIABLE","$actual_invocations",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$actual_hooks",63],"[",["T_VARIABLE","$hook",63],"]",";",["T_WHITESPACE","\n\n      ",63],["T_COMMENT","\/\/ Check that the number of invocations is correct.\n",65],["T_WHITESPACE","      ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertEqual",66],"(",["T_STRING","count",66],"(",["T_VARIABLE","$actual_invocations",66],")",",",["T_WHITESPACE"," ",66],["T_STRING","count",66],"(",["T_VARIABLE","$invocations",66],")",",",["T_WHITESPACE"," ",66],"\"",["T_VARIABLE","$hook",66],["T_ENCAPSED_AND_WHITESPACE","() was called the expected number of times.",66],"\"",")",";",["T_WHITESPACE","\n\n      ",66],["T_COMMENT","\/\/ Check that the hook was called for each expected argument.\n",68],["T_WHITESPACE","      ",69],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$invocations",69],["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$argument",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$found",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","FALSE",70],";",["T_WHITESPACE","\n        ",70],["T_FOREACH","foreach",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$actual_invocations",71],["T_WHITESPACE"," ",71],["T_AS","as",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$actual_arguments",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n          ",71],["T_COMMENT","\/\/ The argument we are looking for is either an array of entities as\n",72],["T_WHITESPACE","          ",73],["T_COMMENT","\/\/ the second argument or a single entity object as the first.\n",73],["T_WHITESPACE","          ",74],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$argument",74],["T_WHITESPACE"," ",74],["T_INSTANCEOF","instanceof",74],["T_WHITESPACE"," ",74],["T_STRING","EntityInterface",74],["T_WHITESPACE"," ",74],["T_BOOLEAN_AND","&&",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$actual_arguments",74],"[",["T_LNUMBER","0",74],"]",["T_OBJECT_OPERATOR","->",74],["T_STRING","id",74],"(",")",["T_WHITESPACE"," ",74],["T_IS_EQUAL","==",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$argument",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","id",74],"(",")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$found",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","TRUE",75],";",["T_WHITESPACE","\n            ",75],["T_BREAK","break",76],";",["T_WHITESPACE","\n          ",76],"}",["T_WHITESPACE","\n          ",77],["T_COMMENT","\/\/ In case of an array, compare the array size and make sure it\n",78],["T_WHITESPACE","          ",79],["T_COMMENT","\/\/ contains the same elements.\n",79],["T_WHITESPACE","          ",80],["T_ELSEIF","elseif",80],["T_WHITESPACE"," ",80],"(",["T_STRING","is_array",80],"(",["T_VARIABLE","$argument",80],")",["T_WHITESPACE"," ",80],["T_BOOLEAN_AND","&&",80],["T_WHITESPACE"," ",80],["T_STRING","count",80],"(",["T_VARIABLE","$actual_arguments",80],"[",["T_LNUMBER","1",80],"]",")",["T_WHITESPACE"," ",80],["T_IS_EQUAL","==",80],["T_WHITESPACE"," ",80],["T_STRING","count",80],"(",["T_VARIABLE","$argument",80],")",["T_WHITESPACE"," ",80],["T_BOOLEAN_AND","&&",80],["T_WHITESPACE"," ",80],["T_STRING","count",80],"(",["T_STRING","array_diff_key",80],"(",["T_VARIABLE","$actual_arguments",80],"[",["T_LNUMBER","1",80],"]",",",["T_WHITESPACE"," ",80],["T_VARIABLE","$argument",80],")",")",["T_WHITESPACE"," ",80],["T_IS_EQUAL","==",80],["T_WHITESPACE"," ",80],["T_LNUMBER","0",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$found",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","TRUE",81],";",["T_WHITESPACE","\n            ",81],["T_BREAK","break",82],";",["T_WHITESPACE","\n          ",82],"}",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","assertTrue",85],"(",["T_VARIABLE","$found",85],",",["T_WHITESPACE"," ",85],"\"",["T_VARIABLE","$hook",85],["T_ENCAPSED_AND_WHITESPACE","() was called on expected argument",85],"\"",")",";",["T_WHITESPACE","\n      ",85],"}",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n  ",87],"}",["T_WHITESPACE","\n\n  ",88],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","setUp",90],"(",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n    ",90],["T_STRING","parent",91],["T_DOUBLE_COLON","::",91],["T_STRING","setUp",91],"(",")",";",["T_WHITESPACE","\n\n    ",91],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","fieldStorages",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","entities",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",")",";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","entitiesByBundles",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_ARRAY","array",95],"(",")",";",["T_WHITESPACE","\n\n    ",95],["T_COMMENT","\/\/ Create two bundles.\n",97],["T_WHITESPACE","    ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","bundles",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'bb_1'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'bb_1'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'bb_2'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'bb_2'",98],")",";",["T_WHITESPACE","\n    ",98],["T_FOREACH","foreach",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","bundles",99],["T_WHITESPACE"," ",99],["T_AS","as",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$name",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$desc",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_STRING","entity_test_create_bundle",100],"(",["T_VARIABLE","$name",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$desc",100],")",";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_COMMENT","\/\/ Create two field storages.\n",103],["T_WHITESPACE","    ",104],["T_VARIABLE","$field_storage",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","FieldStorageConfig",104],["T_DOUBLE_COLON","::",104],["T_STRING","create",104],"(",["T_ARRAY","array",104],"(",["T_WHITESPACE","\n      ",104],["T_CONSTANT_ENCAPSED_STRING","'field_name'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'bf_1'",105],",",["T_WHITESPACE","\n      ",105],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","entityTypeId",106],",",["T_WHITESPACE","\n      ",106],["T_CONSTANT_ENCAPSED_STRING","'type'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'test_field'",107],",",["T_WHITESPACE","\n      ",107],["T_CONSTANT_ENCAPSED_STRING","'cardinality'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_LNUMBER","1",108],["T_WHITESPACE","\n    ",108],")",")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$field_storage",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","save",110],"(",")",";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","fieldStorages",111],"[","]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$field_storage",111],";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$field_storage",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","FieldStorageConfig",112],["T_DOUBLE_COLON","::",112],["T_STRING","create",112],"(",["T_ARRAY","array",112],"(",["T_WHITESPACE","\n      ",112],["T_CONSTANT_ENCAPSED_STRING","'field_name'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'bf_2'",113],",",["T_WHITESPACE","\n      ",113],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","entityTypeId",114],",",["T_WHITESPACE","\n      ",114],["T_CONSTANT_ENCAPSED_STRING","'type'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'test_field'",115],",",["T_WHITESPACE","\n      ",115],["T_CONSTANT_ENCAPSED_STRING","'cardinality'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_LNUMBER","4",116],["T_WHITESPACE","\n    ",116],")",")",";",["T_WHITESPACE","\n    ",117],["T_VARIABLE","$field_storage",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","save",118],"(",")",";",["T_WHITESPACE","\n    ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","fieldStorages",119],"[","]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$field_storage",119],";",["T_WHITESPACE","\n\n    ",119],["T_COMMENT","\/\/ For each bundle, create each field, and 10 entities with values for the\n",121],["T_WHITESPACE","    ",122],["T_COMMENT","\/\/ fields.\n",122],["T_WHITESPACE","    ",123],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","bundles",123],["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$bundle",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n      ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","fieldStorages",124],["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$field_storage",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n        ",124],["T_STRING","FieldConfig",125],["T_DOUBLE_COLON","::",125],["T_STRING","create",125],"(","[",["T_WHITESPACE","\n          ",125],["T_CONSTANT_ENCAPSED_STRING","'field_storage'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$field_storage",126],",",["T_WHITESPACE","\n          ",126],["T_CONSTANT_ENCAPSED_STRING","'bundle'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$bundle",127],",",["T_WHITESPACE","\n        ",127],"]",")",["T_OBJECT_OPERATOR","->",128],["T_STRING","save",128],"(",")",";",["T_WHITESPACE","\n      ",128],"}",["T_WHITESPACE","\n      ",129],["T_FOR","for",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$i",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_LNUMBER","0",130],";",["T_WHITESPACE"," ",130],["T_VARIABLE","$i",130],["T_WHITESPACE"," ",130],"<",["T_WHITESPACE"," ",130],["T_LNUMBER","10",130],";",["T_WHITESPACE"," ",130],["T_VARIABLE","$i",130],["T_INC","++",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$entity",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","container",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","get",131],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",131],")",["T_WHITESPACE","\n          ",131],["T_OBJECT_OPERATOR","->",132],["T_STRING","getStorage",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","entityTypeId",132],")",["T_WHITESPACE","\n          ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","create",133],"(",["T_ARRAY","array",133],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$bundle",133],")",")",";",["T_WHITESPACE","\n        ",133],["T_FOREACH","foreach",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","fieldStorages",134],["T_WHITESPACE"," ",134],["T_AS","as",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$field_storage",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n          ",134],["T_VARIABLE","$entity",135],["T_OBJECT_OPERATOR","->",135],"{",["T_VARIABLE","$field_storage",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getName",135],"(",")","}",["T_OBJECT_OPERATOR","->",135],["T_STRING","setValue",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_generateTestFieldValues",135],"(",["T_VARIABLE","$field_storage",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getCardinality",135],"(",")",")",")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$entity",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","save",137],"(",")",";",["T_WHITESPACE","\n      ",137],"}",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","entities",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","container",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","get",140],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",140],")",["T_WHITESPACE","\n      ",140],["T_OBJECT_OPERATOR","->",141],["T_STRING","getStorage",141],"(",["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","entityTypeId",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","loadMultiple",141],"(",")",";",["T_WHITESPACE","\n    ",141],["T_FOREACH","foreach",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","entities",142],["T_WHITESPACE"," ",142],["T_AS","as",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$entity",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n      ",142],["T_COMMENT","\/\/ This test relies on the entities having stale field definitions\n",143],["T_WHITESPACE","      ",144],["T_COMMENT","\/\/ so that the deleted field can be accessed on them. Access the field\n",144],["T_WHITESPACE","      ",145],["T_COMMENT","\/\/ now, so that they are always loaded.\n",145],["T_WHITESPACE","      ",146],["T_VARIABLE","$entity",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","bf_1",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","value",146],";",["T_WHITESPACE","\n\n      ",146],["T_COMMENT","\/\/ Also keep track of the entities per bundle.\n",148],["T_WHITESPACE","      ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","entitiesByBundles",149],"[",["T_VARIABLE","$entity",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","bundle",149],"(",")","]","[",["T_VARIABLE","$entity",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","id",149],"(",")","]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$entity",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n  ",150],"}",["T_WHITESPACE","\n\n  ",151],["T_DOC_COMMENT","\/**\n   * Verify that deleting a field leaves the field data items in the database\n   * and that the appropriate Field API functions can operate on the deleted\n   * data and field definition.\n   *\n   * This tests how EntityFieldQuery interacts with field deletion and could be\n   * moved to FieldCrudTestCase, but depends on this class's setUp().\n   *\/",153],["T_WHITESPACE","\n  ",160],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","testDeleteField",161],"(",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$bundle",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","reset",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","bundles",162],")",";",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$field_storage",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","reset",163],"(",["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","fieldStorages",163],")",";",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$field_name",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$field_storage",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getName",164],"(",")",";",["T_WHITESPACE","\n    ",164],["T_VARIABLE","$factory",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_NS_SEPARATOR","\\",165],["T_STRING","Drupal",165],["T_DOUBLE_COLON","::",165],["T_STRING","service",165],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.query'",165],")",";",["T_WHITESPACE","\n\n    ",165],["T_COMMENT","\/\/ There are 10 entities of this bundle.\n",167],["T_WHITESPACE","    ",168],["T_VARIABLE","$found",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$factory",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","get",168],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",168],")",["T_WHITESPACE","\n      ",168],["T_OBJECT_OPERATOR","->",169],["T_STRING","condition",169],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$bundle",169],")",["T_WHITESPACE","\n      ",169],["T_OBJECT_OPERATOR","->",170],["T_STRING","execute",170],"(",")",";",["T_WHITESPACE","\n    ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","assertEqual",171],"(",["T_STRING","count",171],"(",["T_VARIABLE","$found",171],")",",",["T_WHITESPACE"," ",171],["T_LNUMBER","10",171],",",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'Correct number of entities found before deleting'",171],")",";",["T_WHITESPACE","\n\n    ",171],["T_COMMENT","\/\/ Delete the field.\n",173],["T_WHITESPACE","    ",174],["T_VARIABLE","$field",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","FieldConfig",174],["T_DOUBLE_COLON","::",174],["T_STRING","loadByName",174],"(",["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","entityTypeId",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$bundle",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$field_name",174],")",";",["T_WHITESPACE","\n    ",174],["T_VARIABLE","$field",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","delete",175],"(",")",";",["T_WHITESPACE","\n\n    ",175],["T_COMMENT","\/\/ The field still exists, deleted.\n",177],["T_WHITESPACE","    ",178],["T_VARIABLE","$fields",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","entity_load_multiple_by_properties",178],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",178],",",["T_WHITESPACE"," ",178],["T_ARRAY","array",178],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_uuid'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$field_storage",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","uuid",178],"(",")",",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'deleted'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_STRING","TRUE",178],",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_STRING","TRUE",178],")",")",";",["T_WHITESPACE","\n    ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","assertEqual",179],"(",["T_STRING","count",179],"(",["T_VARIABLE","$fields",179],")",",",["T_WHITESPACE"," ",179],["T_LNUMBER","1",179],",",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'There is one deleted field'",179],")",";",["T_WHITESPACE","\n    ",179],["T_VARIABLE","$field",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$fields",180],"[",["T_VARIABLE","$field",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","uuid",180],"(",")","]",";",["T_WHITESPACE","\n    ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","assertEqual",181],"(",["T_VARIABLE","$field",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getTargetBundle",181],"(",")",",",["T_WHITESPACE"," ",181],["T_VARIABLE","$bundle",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'The deleted field is for the correct bundle'",181],")",";",["T_WHITESPACE","\n\n    ",181],["T_COMMENT","\/\/ Check that the actual stored content did not change during delete.\n",183],["T_WHITESPACE","    ",184],["T_VARIABLE","$storage",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_NS_SEPARATOR","\\",184],["T_STRING","Drupal",184],["T_DOUBLE_COLON","::",184],["T_STRING","entityManager",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getStorage",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","entityTypeId",184],")",";",["T_WHITESPACE","\n    ",184],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\Sql\\DefaultTableMapping $table_mapping *\/",185],["T_WHITESPACE","\n    ",185],["T_VARIABLE","$table_mapping",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$storage",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getTableMapping",186],"(",")",";",["T_WHITESPACE","\n    ",186],["T_VARIABLE","$table",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$table_mapping",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getDedicatedDataTableName",187],"(",["T_VARIABLE","$field_storage",187],")",";",["T_WHITESPACE","\n    ",187],["T_VARIABLE","$column",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$table_mapping",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getFieldColumnName",188],"(",["T_VARIABLE","$field_storage",188],",",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'value'",188],")",";",["T_WHITESPACE","\n    ",188],["T_VARIABLE","$result",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","db_select",189],"(",["T_VARIABLE","$table",189],",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'t'",189],")",["T_WHITESPACE","\n      ",189],["T_OBJECT_OPERATOR","->",190],["T_STRING","fields",190],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",190],")",["T_WHITESPACE","\n      ",190],["T_OBJECT_OPERATOR","->",191],["T_STRING","execute",191],"(",")",";",["T_WHITESPACE","\n    ",191],["T_FOREACH","foreach",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$result",192],["T_WHITESPACE"," ",192],["T_AS","as",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$row",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n      ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","assertEqual",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","entities",193],"[",["T_VARIABLE","$row",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","entity_id",193],"]",["T_OBJECT_OPERATOR","->",193],"{",["T_VARIABLE","$field_name",193],"}",["T_OBJECT_OPERATOR","->",193],["T_STRING","value",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$row",193],["T_OBJECT_OPERATOR","->",193],["T_VARIABLE","$column",193],")",";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_COMMENT","\/\/ There are 0 entities of this bundle with non-deleted data.\n",196],["T_WHITESPACE","    ",197],["T_VARIABLE","$found",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$factory",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","get",197],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",197],")",["T_WHITESPACE","\n      ",197],["T_OBJECT_OPERATOR","->",198],["T_STRING","condition",198],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$bundle",198],")",["T_WHITESPACE","\n      ",198],["T_OBJECT_OPERATOR","->",199],["T_STRING","condition",199],"(","\"",["T_VARIABLE","$field_name",199],["T_ENCAPSED_AND_WHITESPACE",".deleted",199],"\"",",",["T_WHITESPACE"," ",199],["T_LNUMBER","0",199],")",["T_WHITESPACE","\n      ",199],["T_OBJECT_OPERATOR","->",200],["T_STRING","execute",200],"(",")",";",["T_WHITESPACE","\n    ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","assertFalse",201],"(",["T_VARIABLE","$found",201],",",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'No entities found after deleting'",201],")",";",["T_WHITESPACE","\n\n    ",201],["T_COMMENT","\/\/ There are 10 entities of this bundle when deleted fields are allowed, and\n",203],["T_WHITESPACE","    ",204],["T_COMMENT","\/\/ their values are correct.\n",204],["T_WHITESPACE","    ",205],["T_VARIABLE","$found",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$factory",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","get",205],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",205],")",["T_WHITESPACE","\n      ",205],["T_OBJECT_OPERATOR","->",206],["T_STRING","condition",206],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",206],",",["T_WHITESPACE"," ",206],["T_VARIABLE","$bundle",206],")",["T_WHITESPACE","\n      ",206],["T_OBJECT_OPERATOR","->",207],["T_STRING","condition",207],"(","\"",["T_VARIABLE","$field_name",207],["T_ENCAPSED_AND_WHITESPACE",".deleted",207],"\"",",",["T_WHITESPACE"," ",207],["T_LNUMBER","1",207],")",["T_WHITESPACE","\n      ",207],["T_OBJECT_OPERATOR","->",208],["T_STRING","sort",208],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",208],")",["T_WHITESPACE","\n      ",208],["T_OBJECT_OPERATOR","->",209],["T_STRING","execute",209],"(",")",";",["T_WHITESPACE","\n    ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","assertEqual",210],"(",["T_STRING","count",210],"(",["T_VARIABLE","$found",210],")",",",["T_WHITESPACE"," ",210],["T_LNUMBER","10",210],",",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'Correct number of entities found after deleting'",210],")",";",["T_WHITESPACE","\n    ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","assertFalse",211],"(",["T_STRING","array_diff",211],"(",["T_VARIABLE","$found",211],",",["T_WHITESPACE"," ",211],["T_STRING","array_keys",211],"(",["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","entities",211],")",")",")",";",["T_WHITESPACE","\n  ",211],"}",["T_WHITESPACE","\n\n  ",212],["T_DOC_COMMENT","\/**\n   * Tests that recreating a field with the name as a deleted field works.\n   *\/",214],["T_WHITESPACE","\n  ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","testPurgeWithDeletedAndActiveField",217],"(",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n    ",217],["T_VARIABLE","$bundle",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","reset",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","bundles",218],")",";",["T_WHITESPACE","\n    ",218],["T_COMMENT","\/\/ Create another field storage.\n",219],["T_WHITESPACE","    ",220],["T_VARIABLE","$field_name",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'bf_3'",220],";",["T_WHITESPACE","\n    ",220],["T_VARIABLE","$deleted_field_storage",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_STRING","FieldStorageConfig",221],["T_DOUBLE_COLON","::",221],["T_STRING","create",221],"(",["T_ARRAY","array",221],"(",["T_WHITESPACE","\n      ",221],["T_CONSTANT_ENCAPSED_STRING","'field_name'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$field_name",222],",",["T_WHITESPACE","\n      ",222],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","entityTypeId",223],",",["T_WHITESPACE","\n      ",223],["T_CONSTANT_ENCAPSED_STRING","'type'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'test_field'",224],",",["T_WHITESPACE","\n      ",224],["T_CONSTANT_ENCAPSED_STRING","'cardinality'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_LNUMBER","1",225],["T_WHITESPACE","\n    ",225],")",")",";",["T_WHITESPACE","\n    ",226],["T_VARIABLE","$deleted_field_storage",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","save",227],"(",")",";",["T_WHITESPACE","\n    ",227],["T_COMMENT","\/\/ Create the field.\n",228],["T_WHITESPACE","    ",229],["T_STRING","FieldConfig",229],["T_DOUBLE_COLON","::",229],["T_STRING","create",229],"(","[",["T_WHITESPACE","\n      ",229],["T_CONSTANT_ENCAPSED_STRING","'field_storage'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$deleted_field_storage",230],",",["T_WHITESPACE","\n      ",230],["T_CONSTANT_ENCAPSED_STRING","'bundle'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$bundle",231],",",["T_WHITESPACE","\n    ",231],"]",")",["T_OBJECT_OPERATOR","->",232],["T_STRING","save",232],"(",")",";",["T_WHITESPACE","\n\n    ",232],["T_FOR","for",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$i",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_LNUMBER","0",234],";",["T_WHITESPACE"," ",234],["T_VARIABLE","$i",234],["T_WHITESPACE"," ",234],"<",["T_WHITESPACE"," ",234],["T_LNUMBER","20",234],";",["T_WHITESPACE"," ",234],["T_VARIABLE","$i",234],["T_INC","++",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n      ",234],["T_VARIABLE","$entity",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","container",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","get",235],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",235],")",["T_WHITESPACE","\n        ",235],["T_OBJECT_OPERATOR","->",236],["T_STRING","getStorage",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","entityTypeId",236],")",["T_WHITESPACE","\n        ",236],["T_OBJECT_OPERATOR","->",237],["T_STRING","create",237],"(",["T_ARRAY","array",237],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$bundle",237],")",")",";",["T_WHITESPACE","\n      ",237],["T_VARIABLE","$entity",238],["T_OBJECT_OPERATOR","->",238],"{",["T_VARIABLE","$field_name",238],"}",["T_OBJECT_OPERATOR","->",238],["T_STRING","setValue",238],"(",["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_generateTestFieldValues",238],"(",["T_LNUMBER","1",238],")",")",";",["T_WHITESPACE","\n      ",238],["T_VARIABLE","$entity",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","save",239],"(",")",";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_COMMENT","\/\/ Delete the field.\n",242],["T_WHITESPACE","    ",243],["T_VARIABLE","$deleted_field",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","FieldConfig",243],["T_DOUBLE_COLON","::",243],["T_STRING","loadByName",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","entityTypeId",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$bundle",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$field_name",243],")",";",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$deleted_field",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","delete",244],"(",")",";",["T_WHITESPACE","\n    ",244],["T_VARIABLE","$deleted_field_uuid",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$deleted_field",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","uuid",245],"(",")",";",["T_WHITESPACE","\n\n    ",245],["T_COMMENT","\/\/ Reload the field storage.\n",247],["T_WHITESPACE","    ",248],["T_VARIABLE","$field_storages",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","entity_load_multiple_by_properties",248],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",248],",",["T_WHITESPACE"," ",248],["T_ARRAY","array",248],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$deleted_field_storage",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","uuid",248],"(",")",",",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_STRING","TRUE",248],")",")",";",["T_WHITESPACE","\n    ",248],["T_VARIABLE","$deleted_field_storage",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_STRING","reset",249],"(",["T_VARIABLE","$field_storages",249],")",";",["T_WHITESPACE","\n\n    ",249],["T_COMMENT","\/\/ Create the field again.\n",251],["T_WHITESPACE","    ",252],["T_VARIABLE","$field_storage",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_STRING","FieldStorageConfig",252],["T_DOUBLE_COLON","::",252],["T_STRING","create",252],"(",["T_ARRAY","array",252],"(",["T_WHITESPACE","\n      ",252],["T_CONSTANT_ENCAPSED_STRING","'field_name'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$field_name",253],",",["T_WHITESPACE","\n      ",253],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","entityTypeId",254],",",["T_WHITESPACE","\n      ",254],["T_CONSTANT_ENCAPSED_STRING","'type'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","'test_field'",255],",",["T_WHITESPACE","\n      ",255],["T_CONSTANT_ENCAPSED_STRING","'cardinality'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_LNUMBER","1",256],["T_WHITESPACE","\n    ",256],")",")",";",["T_WHITESPACE","\n    ",257],["T_VARIABLE","$field_storage",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","save",258],"(",")",";",["T_WHITESPACE","\n    ",258],["T_STRING","FieldConfig",259],["T_DOUBLE_COLON","::",259],["T_STRING","create",259],"(","[",["T_WHITESPACE","\n      ",259],["T_CONSTANT_ENCAPSED_STRING","'field_storage'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$field_storage",260],",",["T_WHITESPACE","\n      ",260],["T_CONSTANT_ENCAPSED_STRING","'bundle'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$bundle",261],",",["T_WHITESPACE","\n    ",261],"]",")",["T_OBJECT_OPERATOR","->",262],["T_STRING","save",262],"(",")",";",["T_WHITESPACE","\n\n    ",262],["T_COMMENT","\/\/ The field still exists, deleted, with the same field name.\n",264],["T_WHITESPACE","    ",265],["T_VARIABLE","$fields",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_STRING","entity_load_multiple_by_properties",265],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",265],",",["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$deleted_field_uuid",265],",",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_STRING","TRUE",265],")",")",";",["T_WHITESPACE","\n    ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","assertTrue",266],"(",["T_ISSET","isset",266],"(",["T_VARIABLE","$fields",266],"[",["T_VARIABLE","$deleted_field_uuid",266],"]",")",["T_WHITESPACE"," ",266],["T_BOOLEAN_AND","&&",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$fields",266],"[",["T_VARIABLE","$deleted_field_uuid",266],"]",["T_OBJECT_OPERATOR","->",266],["T_STRING","isDeleted",266],"(",")",",",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'The field exists and is deleted'",266],")",";",["T_WHITESPACE","\n    ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","assertTrue",267],"(",["T_ISSET","isset",267],"(",["T_VARIABLE","$fields",267],"[",["T_VARIABLE","$deleted_field_uuid",267],"]",")",["T_WHITESPACE"," ",267],["T_BOOLEAN_AND","&&",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$fields",267],"[",["T_VARIABLE","$deleted_field_uuid",267],"]",["T_OBJECT_OPERATOR","->",267],["T_STRING","getName",267],"(",")",["T_WHITESPACE"," ",267],["T_IS_EQUAL","==",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$field_name",267],")",";",["T_WHITESPACE","\n\n    ",267],["T_FOR","for",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$i",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_LNUMBER","0",269],";",["T_WHITESPACE"," ",269],["T_VARIABLE","$i",269],["T_WHITESPACE"," ",269],"<",["T_WHITESPACE"," ",269],["T_LNUMBER","10",269],";",["T_WHITESPACE"," ",269],["T_VARIABLE","$i",269],["T_INC","++",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n      ",269],["T_VARIABLE","$entity",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","container",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","get",270],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",270],")",["T_WHITESPACE","\n        ",270],["T_OBJECT_OPERATOR","->",271],["T_STRING","getStorage",271],"(",["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","entityTypeId",271],")",["T_WHITESPACE","\n        ",271],["T_OBJECT_OPERATOR","->",272],["T_STRING","create",272],"(",["T_ARRAY","array",272],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$bundle",272],")",")",";",["T_WHITESPACE","\n      ",272],["T_VARIABLE","$entity",273],["T_OBJECT_OPERATOR","->",273],"{",["T_VARIABLE","$field_name",273],"}",["T_OBJECT_OPERATOR","->",273],["T_STRING","setValue",273],"(",["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_generateTestFieldValues",273],"(",["T_LNUMBER","1",273],")",")",";",["T_WHITESPACE","\n      ",273],["T_VARIABLE","$entity",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","save",274],"(",")",";",["T_WHITESPACE","\n    ",274],"}",["T_WHITESPACE","\n\n    ",275],["T_COMMENT","\/\/ Check that the two field storages have different tables.\n",277],["T_WHITESPACE","    ",278],["T_VARIABLE","$storage",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_NS_SEPARATOR","\\",278],["T_STRING","Drupal",278],["T_DOUBLE_COLON","::",278],["T_STRING","entityManager",278],"(",")",["T_OBJECT_OPERATOR","->",278],["T_STRING","getStorage",278],"(",["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","entityTypeId",278],")",";",["T_WHITESPACE","\n    ",278],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\Sql\\DefaultTableMapping $table_mapping *\/",279],["T_WHITESPACE","\n    ",279],["T_VARIABLE","$table_mapping",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_VARIABLE","$storage",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getTableMapping",280],"(",")",";",["T_WHITESPACE","\n    ",280],["T_VARIABLE","$deleted_table_name",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$table_mapping",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getDedicatedDataTableName",281],"(",["T_VARIABLE","$deleted_field_storage",281],",",["T_WHITESPACE"," ",281],["T_STRING","TRUE",281],")",";",["T_WHITESPACE","\n    ",281],["T_VARIABLE","$active_table_name",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$table_mapping",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getDedicatedDataTableName",282],"(",["T_VARIABLE","$field_storage",282],")",";",["T_WHITESPACE","\n\n    ",282],["T_STRING","field_purge_batch",284],"(",["T_LNUMBER","50",284],")",";",["T_WHITESPACE","\n\n    ",284],["T_COMMENT","\/\/ Ensure the new field still has its table and the deleted one has been\n",286],["T_WHITESPACE","    ",287],["T_COMMENT","\/\/ removed.\n",287],["T_WHITESPACE","    ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","assertTrue",288],"(",["T_NS_SEPARATOR","\\",288],["T_STRING","Drupal",288],["T_DOUBLE_COLON","::",288],["T_STRING","database",288],"(",")",["T_OBJECT_OPERATOR","->",288],["T_STRING","schema",288],"(",")",["T_OBJECT_OPERATOR","->",288],["T_STRING","tableExists",288],"(",["T_VARIABLE","$active_table_name",288],")",")",";",["T_WHITESPACE","\n    ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","assertFalse",289],"(",["T_NS_SEPARATOR","\\",289],["T_STRING","Drupal",289],["T_DOUBLE_COLON","::",289],["T_STRING","database",289],"(",")",["T_OBJECT_OPERATOR","->",289],["T_STRING","schema",289],"(",")",["T_OBJECT_OPERATOR","->",289],["T_STRING","tableExists",289],"(",["T_VARIABLE","$deleted_table_name",289],")",")",";",["T_WHITESPACE","\n\n    ",289],["T_COMMENT","\/\/ The field has been removed from the system.\n",291],["T_WHITESPACE","    ",292],["T_VARIABLE","$fields",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_STRING","entity_load_multiple_by_properties",292],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",292],",",["T_WHITESPACE"," ",292],["T_ARRAY","array",292],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_uuid'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$deleted_field_storage",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","uuid",292],"(",")",",",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'deleted'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_STRING","TRUE",292],",",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_STRING","TRUE",292],")",")",";",["T_WHITESPACE","\n    ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","assertEqual",293],"(",["T_STRING","count",293],"(",["T_VARIABLE","$fields",293],")",",",["T_WHITESPACE"," ",293],["T_LNUMBER","0",293],",",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'The field is gone'",293],")",";",["T_WHITESPACE","\n\n    ",293],["T_COMMENT","\/\/ Verify there are still 10 entries in the main table.\n",295],["T_WHITESPACE","    ",296],["T_VARIABLE","$count",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_NS_SEPARATOR","\\",296],["T_STRING","Drupal",296],["T_DOUBLE_COLON","::",296],["T_STRING","database",296],"(",")",["T_WHITESPACE","\n      ",296],["T_OBJECT_OPERATOR","->",297],["T_STRING","select",297],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test__'",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_VARIABLE","$field_name",297],",",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'f'",297],")",["T_WHITESPACE","\n      ",297],["T_OBJECT_OPERATOR","->",298],["T_STRING","fields",298],"(",["T_CONSTANT_ENCAPSED_STRING","'f'",298],",",["T_WHITESPACE"," ",298],["T_ARRAY","array",298],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",298],")",")",["T_WHITESPACE","\n      ",298],["T_OBJECT_OPERATOR","->",299],["T_STRING","condition",299],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle'",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$bundle",299],")",["T_WHITESPACE","\n      ",299],["T_OBJECT_OPERATOR","->",300],["T_STRING","countQuery",300],"(",")",["T_WHITESPACE","\n      ",300],["T_OBJECT_OPERATOR","->",301],["T_STRING","execute",301],"(",")",["T_WHITESPACE","\n      ",301],["T_OBJECT_OPERATOR","->",302],["T_STRING","fetchField",302],"(",")",";",["T_WHITESPACE","\n    ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","assertEqual",303],"(",["T_VARIABLE","$count",303],",",["T_WHITESPACE"," ",303],["T_LNUMBER","10",303],")",";",["T_WHITESPACE","\n  ",303],"}",["T_WHITESPACE","\n\n  ",304],["T_DOC_COMMENT","\/**\n   * Verify that field data items and fields are purged when a field storage is\n   * deleted.\n   *\/",306],["T_WHITESPACE","\n  ",309],["T_FUNCTION","function",310],["T_WHITESPACE"," ",310],["T_STRING","testPurgeField",310],"(",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n    ",310],["T_COMMENT","\/\/ Start recording hook invocations.\n",311],["T_WHITESPACE","    ",312],["T_STRING","field_test_memorize",312],"(",")",";",["T_WHITESPACE","\n\n    ",312],["T_VARIABLE","$bundle",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","reset",314],"(",["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","bundles",314],")",";",["T_WHITESPACE","\n    ",314],["T_VARIABLE","$field_storage",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_STRING","reset",315],"(",["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","fieldStorages",315],")",";",["T_WHITESPACE","\n    ",315],["T_VARIABLE","$field_name",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$field_storage",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getName",316],"(",")",";",["T_WHITESPACE","\n\n    ",316],["T_COMMENT","\/\/ Delete the field.\n",318],["T_WHITESPACE","    ",319],["T_VARIABLE","$field",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_STRING","FieldConfig",319],["T_DOUBLE_COLON","::",319],["T_STRING","loadByName",319],"(",["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","entityTypeId",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$bundle",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$field_name",319],")",";",["T_WHITESPACE","\n    ",319],["T_VARIABLE","$field",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","delete",320],"(",")",";",["T_WHITESPACE","\n\n    ",320],["T_COMMENT","\/\/ No field hooks were called.\n",322],["T_WHITESPACE","    ",323],["T_VARIABLE","$mem",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","field_test_memorize",323],"(",")",";",["T_WHITESPACE","\n    ",323],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","assertEqual",324],"(",["T_STRING","count",324],"(",["T_VARIABLE","$mem",324],")",",",["T_WHITESPACE"," ",324],["T_LNUMBER","0",324],",",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","'No field hooks were called'",324],")",";",["T_WHITESPACE","\n\n    ",324],["T_VARIABLE","$batch_size",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_LNUMBER","2",326],";",["T_WHITESPACE","\n    ",326],["T_FOR","for",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$count",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_LNUMBER","8",327],";",["T_WHITESPACE"," ",327],["T_VARIABLE","$count",327],["T_WHITESPACE"," ",327],["T_IS_GREATER_OR_EQUAL",">=",327],["T_WHITESPACE"," ",327],["T_LNUMBER","0",327],";",["T_WHITESPACE"," ",327],["T_VARIABLE","$count",327],["T_WHITESPACE"," ",327],["T_MINUS_EQUAL","-=",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$batch_size",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n      ",327],["T_COMMENT","\/\/ Purge two entities.\n",328],["T_WHITESPACE","      ",329],["T_STRING","field_purge_batch",329],"(",["T_VARIABLE","$batch_size",329],")",";",["T_WHITESPACE","\n\n      ",329],["T_COMMENT","\/\/ There are $count deleted entities left.\n",331],["T_WHITESPACE","      ",332],["T_VARIABLE","$found",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Drupal",332],["T_DOUBLE_COLON","::",332],["T_STRING","entityQuery",332],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_test'",332],")",["T_WHITESPACE","\n        ",332],["T_OBJECT_OPERATOR","->",333],["T_STRING","condition",333],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$bundle",333],")",["T_WHITESPACE","\n        ",333],["T_OBJECT_OPERATOR","->",334],["T_STRING","condition",334],"(",["T_VARIABLE","$field_name",334],["T_WHITESPACE"," ",334],".",["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","'.deleted'",334],",",["T_WHITESPACE"," ",334],["T_LNUMBER","1",334],")",["T_WHITESPACE","\n        ",334],["T_OBJECT_OPERATOR","->",335],["T_STRING","execute",335],"(",")",";",["T_WHITESPACE","\n      ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","assertEqual",336],"(",["T_STRING","count",336],"(",["T_VARIABLE","$found",336],")",",",["T_WHITESPACE"," ",336],["T_VARIABLE","$count",336],",",["T_WHITESPACE"," ",336],["T_CONSTANT_ENCAPSED_STRING","'Correct number of entities found after purging 2'",336],")",";",["T_WHITESPACE","\n    ",336],"}",["T_WHITESPACE","\n\n    ",337],["T_COMMENT","\/\/ Check hooks invocations.\n",339],["T_WHITESPACE","    ",340],["T_COMMENT","\/\/ FieldItemInterface::delete() should have been called once for each entity in the\n",340],["T_WHITESPACE","    ",341],["T_COMMENT","\/\/ bundle.\n",341],["T_WHITESPACE","    ",342],["T_VARIABLE","$actual_hooks",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","field_test_memorize",342],"(",")",";",["T_WHITESPACE","\n    ",342],["T_VARIABLE","$hooks",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_ARRAY","array",343],"(",")",";",["T_WHITESPACE","\n    ",343],["T_VARIABLE","$entities",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","entitiesByBundles",344],"[",["T_VARIABLE","$bundle",344],"]",";",["T_WHITESPACE","\n    ",344],["T_FOREACH","foreach",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$entities",345],["T_WHITESPACE"," ",345],["T_AS","as",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$id",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$entity",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n      ",345],["T_VARIABLE","$hooks",346],"[",["T_CONSTANT_ENCAPSED_STRING","'field_test_field_delete'",346],"]","[","]",["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_VARIABLE","$entity",346],";",["T_WHITESPACE","\n    ",346],"}",["T_WHITESPACE","\n    ",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","checkHooksInvocations",348],"(",["T_VARIABLE","$hooks",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$actual_hooks",348],")",";",["T_WHITESPACE","\n\n    ",348],["T_COMMENT","\/\/ The field still exists, deleted.\n",350],["T_WHITESPACE","    ",351],["T_VARIABLE","$fields",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","entity_load_multiple_by_properties",351],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",351],",",["T_WHITESPACE"," ",351],["T_ARRAY","array",351],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_uuid'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_VARIABLE","$field_storage",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","uuid",351],"(",")",",",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'deleted'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_STRING","TRUE",351],",",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_STRING","TRUE",351],")",")",";",["T_WHITESPACE","\n    ",351],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","assertEqual",352],"(",["T_STRING","count",352],"(",["T_VARIABLE","$fields",352],")",",",["T_WHITESPACE"," ",352],["T_LNUMBER","1",352],",",["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'There is one deleted field'",352],")",";",["T_WHITESPACE","\n\n    ",352],["T_COMMENT","\/\/ Purge the field.\n",354],["T_WHITESPACE","    ",355],["T_STRING","field_purge_batch",355],"(",["T_VARIABLE","$batch_size",355],")",";",["T_WHITESPACE","\n\n    ",355],["T_COMMENT","\/\/ The field is gone.\n",357],["T_WHITESPACE","    ",358],["T_VARIABLE","$fields",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","entity_load_multiple_by_properties",358],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",358],",",["T_WHITESPACE"," ",358],["T_ARRAY","array",358],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_uuid'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$field_storage",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","uuid",358],"(",")",",",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'deleted'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_STRING","TRUE",358],",",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_STRING","TRUE",358],")",")",";",["T_WHITESPACE","\n    ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","assertEqual",359],"(",["T_STRING","count",359],"(",["T_VARIABLE","$fields",359],")",",",["T_WHITESPACE"," ",359],["T_LNUMBER","0",359],",",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'The field is gone'",359],")",";",["T_WHITESPACE","\n\n    ",359],["T_COMMENT","\/\/ The field storage still exists, not deleted, because it has a second\n",361],["T_WHITESPACE","    ",362],["T_COMMENT","\/\/ field.\n",362],["T_WHITESPACE","    ",363],["T_VARIABLE","$storages",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_STRING","entity_load_multiple_by_properties",363],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",363],",",["T_WHITESPACE"," ",363],["T_ARRAY","array",363],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$field_storage",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","uuid",363],"(",")",",",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_STRING","TRUE",363],")",")",";",["T_WHITESPACE","\n    ",363],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","assertTrue",364],"(",["T_ISSET","isset",364],"(",["T_VARIABLE","$storages",364],"[",["T_VARIABLE","$field_storage",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","uuid",364],"(",")","]",")",",",["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","'The field storage exists and is not deleted'",364],")",";",["T_WHITESPACE","\n  ",364],"}",["T_WHITESPACE","\n\n  ",365],["T_DOC_COMMENT","\/**\n   * Verify that field storages are preserved and purged correctly as multiple\n   * fields are deleted and purged.\n   *\/",367],["T_WHITESPACE","\n  ",370],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","testPurgeFieldStorage",371],"(",")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n    ",371],["T_COMMENT","\/\/ Start recording hook invocations.\n",372],["T_WHITESPACE","    ",373],["T_STRING","field_test_memorize",373],"(",")",";",["T_WHITESPACE","\n\n    ",373],["T_VARIABLE","$field_storage",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_STRING","reset",375],"(",["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","fieldStorages",375],")",";",["T_WHITESPACE","\n    ",375],["T_VARIABLE","$field_name",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$field_storage",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getName",376],"(",")",";",["T_WHITESPACE","\n\n    ",376],["T_COMMENT","\/\/ Delete the first field.\n",378],["T_WHITESPACE","    ",379],["T_VARIABLE","$bundle",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_STRING","reset",379],"(",["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","bundles",379],")",";",["T_WHITESPACE","\n    ",379],["T_VARIABLE","$field",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_STRING","FieldConfig",380],["T_DOUBLE_COLON","::",380],["T_STRING","loadByName",380],"(",["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","entityTypeId",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$bundle",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$field_name",380],")",";",["T_WHITESPACE","\n    ",380],["T_VARIABLE","$field",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","delete",381],"(",")",";",["T_WHITESPACE","\n\n    ",381],["T_COMMENT","\/\/ Assert that FieldItemInterface::delete() was not called yet.\n",383],["T_WHITESPACE","    ",384],["T_VARIABLE","$mem",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","field_test_memorize",384],"(",")",";",["T_WHITESPACE","\n    ",384],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","assertEqual",385],"(",["T_STRING","count",385],"(",["T_VARIABLE","$mem",385],")",",",["T_WHITESPACE"," ",385],["T_LNUMBER","0",385],",",["T_WHITESPACE"," ",385],["T_CONSTANT_ENCAPSED_STRING","'No field hooks were called.'",385],")",";",["T_WHITESPACE","\n\n    ",385],["T_COMMENT","\/\/ Purge the data.\n",387],["T_WHITESPACE","    ",388],["T_STRING","field_purge_batch",388],"(",["T_LNUMBER","10",388],")",";",["T_WHITESPACE","\n\n    ",388],["T_COMMENT","\/\/ Check hooks invocations.\n",390],["T_WHITESPACE","    ",391],["T_COMMENT","\/\/ FieldItemInterface::delete() should have been called once for each entity in the\n",391],["T_WHITESPACE","    ",392],["T_COMMENT","\/\/ bundle.\n",392],["T_WHITESPACE","    ",393],["T_VARIABLE","$actual_hooks",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_STRING","field_test_memorize",393],"(",")",";",["T_WHITESPACE","\n    ",393],["T_VARIABLE","$hooks",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_ARRAY","array",394],"(",")",";",["T_WHITESPACE","\n    ",394],["T_VARIABLE","$entities",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","entitiesByBundles",395],"[",["T_VARIABLE","$bundle",395],"]",";",["T_WHITESPACE","\n    ",395],["T_FOREACH","foreach",396],["T_WHITESPACE"," ",396],"(",["T_VARIABLE","$entities",396],["T_WHITESPACE"," ",396],["T_AS","as",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$id",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$entity",396],")",["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n      ",396],["T_VARIABLE","$hooks",397],"[",["T_CONSTANT_ENCAPSED_STRING","'field_test_field_delete'",397],"]","[","]",["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_VARIABLE","$entity",397],";",["T_WHITESPACE","\n    ",397],"}",["T_WHITESPACE","\n    ",398],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","checkHooksInvocations",399],"(",["T_VARIABLE","$hooks",399],",",["T_WHITESPACE"," ",399],["T_VARIABLE","$actual_hooks",399],")",";",["T_WHITESPACE","\n\n    ",399],["T_COMMENT","\/\/ The field still exists, deleted.\n",401],["T_WHITESPACE","    ",402],["T_VARIABLE","$fields",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_STRING","entity_load_multiple_by_properties",402],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",402],",",["T_WHITESPACE"," ",402],["T_ARRAY","array",402],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$field",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","uuid",402],"(",")",",",["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_STRING","TRUE",402],")",")",";",["T_WHITESPACE","\n    ",402],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","assertTrue",403],"(",["T_ISSET","isset",403],"(",["T_VARIABLE","$fields",403],"[",["T_VARIABLE","$field",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","uuid",403],"(",")","]",")",["T_WHITESPACE"," ",403],["T_BOOLEAN_AND","&&",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$fields",403],"[",["T_VARIABLE","$field",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","uuid",403],"(",")","]",["T_OBJECT_OPERATOR","->",403],["T_STRING","isDeleted",403],"(",")",",",["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","'The field exists and is deleted'",403],")",";",["T_WHITESPACE","\n\n    ",403],["T_COMMENT","\/\/ Purge again to purge the field.\n",405],["T_WHITESPACE","    ",406],["T_STRING","field_purge_batch",406],"(",["T_LNUMBER","0",406],")",";",["T_WHITESPACE","\n\n    ",406],["T_COMMENT","\/\/ The field is gone.\n",408],["T_WHITESPACE","    ",409],["T_VARIABLE","$fields",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_STRING","entity_load_multiple_by_properties",409],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",409],",",["T_WHITESPACE"," ",409],["T_ARRAY","array",409],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",409],["T_WHITESPACE"," ",409],["T_DOUBLE_ARROW","=>",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$field",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","uuid",409],"(",")",",",["T_WHITESPACE"," ",409],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",409],["T_WHITESPACE"," ",409],["T_DOUBLE_ARROW","=>",409],["T_WHITESPACE"," ",409],["T_STRING","TRUE",409],")",")",";",["T_WHITESPACE","\n    ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","assertEqual",410],"(",["T_STRING","count",410],"(",["T_VARIABLE","$fields",410],")",",",["T_WHITESPACE"," ",410],["T_LNUMBER","0",410],",",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","'The field is purged.'",410],")",";",["T_WHITESPACE","\n    ",410],["T_COMMENT","\/\/ The field storage still exists, not deleted.\n",411],["T_WHITESPACE","    ",412],["T_VARIABLE","$storages",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_STRING","entity_load_multiple_by_properties",412],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",412],",",["T_WHITESPACE"," ",412],["T_ARRAY","array",412],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",412],["T_WHITESPACE"," ",412],["T_DOUBLE_ARROW","=>",412],["T_WHITESPACE"," ",412],["T_VARIABLE","$field_storage",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","uuid",412],"(",")",",",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",412],["T_WHITESPACE"," ",412],["T_DOUBLE_ARROW","=>",412],["T_WHITESPACE"," ",412],["T_STRING","TRUE",412],")",")",";",["T_WHITESPACE","\n    ",412],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","assertTrue",413],"(",["T_ISSET","isset",413],"(",["T_VARIABLE","$storages",413],"[",["T_VARIABLE","$field_storage",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","uuid",413],"(",")","]",")",["T_WHITESPACE"," ",413],["T_BOOLEAN_AND","&&",413],["T_WHITESPACE"," ",413],"!",["T_VARIABLE","$storages",413],"[",["T_VARIABLE","$field_storage",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","uuid",413],"(",")","]",["T_OBJECT_OPERATOR","->",413],["T_STRING","isDeleted",413],"(",")",",",["T_WHITESPACE"," ",413],["T_CONSTANT_ENCAPSED_STRING","'The field storage exists and is not deleted'",413],")",";",["T_WHITESPACE","\n\n    ",413],["T_COMMENT","\/\/ Delete the second field.\n",415],["T_WHITESPACE","    ",416],["T_VARIABLE","$bundle",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_STRING","next",416],"(",["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","bundles",416],")",";",["T_WHITESPACE","\n    ",416],["T_VARIABLE","$field",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_STRING","FieldConfig",417],["T_DOUBLE_COLON","::",417],["T_STRING","loadByName",417],"(",["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","entityTypeId",417],",",["T_WHITESPACE"," ",417],["T_VARIABLE","$bundle",417],",",["T_WHITESPACE"," ",417],["T_VARIABLE","$field_name",417],")",";",["T_WHITESPACE","\n    ",417],["T_VARIABLE","$field",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","delete",418],"(",")",";",["T_WHITESPACE","\n\n    ",418],["T_COMMENT","\/\/ Assert that FieldItemInterface::delete() was not called yet.\n",420],["T_WHITESPACE","    ",421],["T_VARIABLE","$mem",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","field_test_memorize",421],"(",")",";",["T_WHITESPACE","\n    ",421],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","assertEqual",422],"(",["T_STRING","count",422],"(",["T_VARIABLE","$mem",422],")",",",["T_WHITESPACE"," ",422],["T_LNUMBER","0",422],",",["T_WHITESPACE"," ",422],["T_CONSTANT_ENCAPSED_STRING","'No field hooks were called.'",422],")",";",["T_WHITESPACE","\n\n    ",422],["T_COMMENT","\/\/ Purge the data.\n",424],["T_WHITESPACE","    ",425],["T_STRING","field_purge_batch",425],"(",["T_LNUMBER","10",425],")",";",["T_WHITESPACE","\n\n    ",425],["T_COMMENT","\/\/ Check hooks invocations (same as above, for the 2nd bundle).\n",427],["T_WHITESPACE","    ",428],["T_VARIABLE","$actual_hooks",428],["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_STRING","field_test_memorize",428],"(",")",";",["T_WHITESPACE","\n    ",428],["T_VARIABLE","$hooks",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_ARRAY","array",429],"(",")",";",["T_WHITESPACE","\n    ",429],["T_VARIABLE","$entities",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","entitiesByBundles",430],"[",["T_VARIABLE","$bundle",430],"]",";",["T_WHITESPACE","\n    ",430],["T_FOREACH","foreach",431],["T_WHITESPACE"," ",431],"(",["T_VARIABLE","$entities",431],["T_WHITESPACE"," ",431],["T_AS","as",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$id",431],["T_WHITESPACE"," ",431],["T_DOUBLE_ARROW","=>",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$entity",431],")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n      ",431],["T_VARIABLE","$hooks",432],"[",["T_CONSTANT_ENCAPSED_STRING","'field_test_field_delete'",432],"]","[","]",["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$entity",432],";",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n    ",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","checkHooksInvocations",434],"(",["T_VARIABLE","$hooks",434],",",["T_WHITESPACE"," ",434],["T_VARIABLE","$actual_hooks",434],")",";",["T_WHITESPACE","\n\n    ",434],["T_COMMENT","\/\/ The field and the storage still exist, deleted.\n",436],["T_WHITESPACE","    ",437],["T_VARIABLE","$fields",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_STRING","entity_load_multiple_by_properties",437],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",437],",",["T_WHITESPACE"," ",437],["T_ARRAY","array",437],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],["T_VARIABLE","$field",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","uuid",437],"(",")",",",["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],["T_STRING","TRUE",437],")",")",";",["T_WHITESPACE","\n    ",437],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","assertTrue",438],"(",["T_ISSET","isset",438],"(",["T_VARIABLE","$fields",438],"[",["T_VARIABLE","$field",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","uuid",438],"(",")","]",")",["T_WHITESPACE"," ",438],["T_BOOLEAN_AND","&&",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$fields",438],"[",["T_VARIABLE","$field",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","uuid",438],"(",")","]",["T_OBJECT_OPERATOR","->",438],["T_STRING","isDeleted",438],"(",")",",",["T_WHITESPACE"," ",438],["T_CONSTANT_ENCAPSED_STRING","'The field exists and is deleted'",438],")",";",["T_WHITESPACE","\n    ",438],["T_VARIABLE","$storages",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_STRING","entity_load_multiple_by_properties",439],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",439],",",["T_WHITESPACE"," ",439],["T_ARRAY","array",439],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",439],["T_WHITESPACE"," ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$field_storage",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","uuid",439],"(",")",",",["T_WHITESPACE"," ",439],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",439],["T_WHITESPACE"," ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_STRING","TRUE",439],")",")",";",["T_WHITESPACE","\n    ",439],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","assertTrue",440],"(",["T_ISSET","isset",440],"(",["T_VARIABLE","$storages",440],"[",["T_VARIABLE","$field_storage",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","uuid",440],"(",")","]",")",["T_WHITESPACE"," ",440],["T_BOOLEAN_AND","&&",440],["T_WHITESPACE"," ",440],["T_VARIABLE","$storages",440],"[",["T_VARIABLE","$field_storage",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","uuid",440],"(",")","]",["T_OBJECT_OPERATOR","->",440],["T_STRING","isDeleted",440],"(",")",",",["T_WHITESPACE"," ",440],["T_CONSTANT_ENCAPSED_STRING","'The field storage exists and is deleted'",440],")",";",["T_WHITESPACE","\n\n    ",440],["T_COMMENT","\/\/ Purge again to purge the field and the storage.\n",442],["T_WHITESPACE","    ",443],["T_STRING","field_purge_batch",443],"(",["T_LNUMBER","0",443],")",";",["T_WHITESPACE","\n\n    ",443],["T_COMMENT","\/\/ The field and the storage are gone.\n",445],["T_WHITESPACE","    ",446],["T_VARIABLE","$fields",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_STRING","entity_load_multiple_by_properties",446],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config'",446],",",["T_WHITESPACE"," ",446],["T_ARRAY","array",446],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",446],["T_WHITESPACE"," ",446],["T_DOUBLE_ARROW","=>",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$field",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","uuid",446],"(",")",",",["T_WHITESPACE"," ",446],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",446],["T_WHITESPACE"," ",446],["T_DOUBLE_ARROW","=>",446],["T_WHITESPACE"," ",446],["T_STRING","TRUE",446],")",")",";",["T_WHITESPACE","\n    ",446],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","assertEqual",447],"(",["T_STRING","count",447],"(",["T_VARIABLE","$fields",447],")",",",["T_WHITESPACE"," ",447],["T_LNUMBER","0",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'The field is purged.'",447],")",";",["T_WHITESPACE","\n    ",447],["T_VARIABLE","$storages",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_STRING","entity_load_multiple_by_properties",448],"(",["T_CONSTANT_ENCAPSED_STRING","'field_storage_config'",448],",",["T_WHITESPACE"," ",448],["T_ARRAY","array",448],"(",["T_CONSTANT_ENCAPSED_STRING","'uuid'",448],["T_WHITESPACE"," ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_VARIABLE","$field_storage",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","uuid",448],"(",")",",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'include_deleted'",448],["T_WHITESPACE"," ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_STRING","TRUE",448],")",")",";",["T_WHITESPACE","\n    ",448],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","assertEqual",449],"(",["T_STRING","count",449],"(",["T_VARIABLE","$storages",449],")",",",["T_WHITESPACE"," ",449],["T_LNUMBER","0",449],",",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'The field storage is purged.'",449],")",";",["T_WHITESPACE","\n  ",449],"}",["T_WHITESPACE","\n\n",450],"}",["T_WHITESPACE","\n",452]]