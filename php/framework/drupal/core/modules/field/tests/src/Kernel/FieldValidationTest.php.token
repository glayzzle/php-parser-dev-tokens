[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","field",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Kernel",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Tests field validation.\n *\n * @group field\n *\/",5],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","FieldValidationTest",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_STRING","FieldKernelTestBase",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * @var string\n   *\/",12],["T_WHITESPACE","\n  ",14],["T_PRIVATE","private",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$entityType",15],";",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * @var string\n   *\/",17],["T_WHITESPACE","\n  ",19],["T_PRIVATE","private",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$bundle",20],";",["T_WHITESPACE","\n\n  ",20],["T_DOC_COMMENT","\/**\n   * @var \\Drupal\\Core\\Entity\\EntityInterface\n   *\/",22],["T_WHITESPACE","\n  ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$entity",25],";",["T_WHITESPACE","\n\n  ",25],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_FUNCTION","function",27],["T_WHITESPACE"," ",27],["T_STRING","setUp",27],"(",")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n    ",27],["T_STRING","parent",28],["T_DOUBLE_COLON","::",28],["T_STRING","setUp",28],"(",")",";",["T_WHITESPACE","\n\n    ",28],["T_COMMENT","\/\/ Create a field and storage of type 'test_field', on the 'entity_test'\n",30],["T_WHITESPACE","    ",31],["T_COMMENT","\/\/ entity type.\n",31],["T_WHITESPACE","    ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","entityType",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",32],";",["T_WHITESPACE","\n    ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","bundle",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'entity_test'",33],";",["T_WHITESPACE","\n    ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","createFieldWithStorage",34],"(",["T_CONSTANT_ENCAPSED_STRING","''",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","entityType",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","bundle",34],")",";",["T_WHITESPACE","\n\n    ",34],["T_COMMENT","\/\/ Create an 'entity_test' entity.\n",36],["T_WHITESPACE","    ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","entity",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","entity_create",37],"(",["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","entityType",37],",",["T_WHITESPACE"," ",37],["T_ARRAY","array",37],"(",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'type'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","bundle",38],",",["T_WHITESPACE","\n    ",38],")",")",";",["T_WHITESPACE","\n  ",39],"}",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * Tests that the number of values is validated against the field cardinality.\n   *\/",42],["T_WHITESPACE","\n  ",44],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testCardinalityConstraint",45],"(",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$cardinality",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","fieldTestData",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","field_storage",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getCardinality",46],"(",")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$entity",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","entity",47],";",["T_WHITESPACE","\n\n    ",47],["T_FOR","for",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$delta",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","0",49],";",["T_WHITESPACE"," ",49],["T_VARIABLE","$delta",49],["T_WHITESPACE"," ",49],"<",["T_WHITESPACE"," ",49],["T_VARIABLE","$cardinality",49],["T_WHITESPACE"," ",49],"+",["T_WHITESPACE"," ",49],["T_LNUMBER","1",49],";",["T_WHITESPACE"," ",49],["T_VARIABLE","$delta",49],["T_INC","++",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n      ",49],["T_VARIABLE","$entity",50],["T_OBJECT_OPERATOR","->",50],"{",["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","fieldTestData",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","field_name",50],"}","[","]",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_ARRAY","array",50],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_LNUMBER","1",50],")",";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Validate the field.\n",53],["T_WHITESPACE","    ",54],["T_VARIABLE","$violations",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$entity",54],["T_OBJECT_OPERATOR","->",54],"{",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","fieldTestData",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","field_name",54],"}",["T_OBJECT_OPERATOR","->",54],["T_STRING","validate",54],"(",")",";",["T_WHITESPACE","\n\n    ",54],["T_COMMENT","\/\/ Check that the expected constraint violations are reported.\n",56],["T_WHITESPACE","    ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertEqual",57],"(",["T_STRING","count",57],"(",["T_VARIABLE","$violations",57],")",",",["T_WHITESPACE"," ",57],["T_LNUMBER","1",57],")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertEqual",58],"(",["T_VARIABLE","$violations",58],"[",["T_LNUMBER","0",58],"]",["T_OBJECT_OPERATOR","->",58],["T_STRING","getPropertyPath",58],"(",")",",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","''",58],")",";",["T_WHITESPACE","\n    ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertEqual",59],"(",["T_VARIABLE","$violations",59],"[",["T_LNUMBER","0",59],"]",["T_OBJECT_OPERATOR","->",59],["T_STRING","getMessage",59],"(",")",",",["T_WHITESPACE"," ",59],["T_STRING","t",59],"(",["T_CONSTANT_ENCAPSED_STRING","'%name: this field cannot hold more than @count values.'",59],",",["T_WHITESPACE"," ",59],["T_ARRAY","array",59],"(",["T_CONSTANT_ENCAPSED_STRING","'%name'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","fieldTestData",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","field",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getLabel",59],"(",")",",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'@count'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$cardinality",59],")",")",")",";",["T_WHITESPACE","\n  ",59],"}",["T_WHITESPACE","\n\n  ",60],["T_DOC_COMMENT","\/**\n   * Tests that constraints defined by the field type are validated.\n   *\/",62],["T_WHITESPACE","\n  ",64],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","testFieldConstraints",65],"(",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$cardinality",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","fieldTestData",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","field_storage",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getCardinality",66],"(",")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$entity",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","entity",67],";",["T_WHITESPACE","\n\n    ",67],["T_COMMENT","\/\/ The test is only valid if the field cardinality is greater than 2.\n",69],["T_WHITESPACE","    ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertTrue",70],"(",["T_VARIABLE","$cardinality",70],["T_WHITESPACE"," ",70],["T_IS_GREATER_OR_EQUAL",">=",70],["T_WHITESPACE"," ",70],["T_LNUMBER","2",70],")",";",["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/\/ Set up values for the field.\n",72],["T_WHITESPACE","    ",73],["T_VARIABLE","$expected_violations",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",")",";",["T_WHITESPACE","\n    ",73],["T_FOR","for",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$delta",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_LNUMBER","0",74],";",["T_WHITESPACE"," ",74],["T_VARIABLE","$delta",74],["T_WHITESPACE"," ",74],"<",["T_WHITESPACE"," ",74],["T_VARIABLE","$cardinality",74],";",["T_WHITESPACE"," ",74],["T_VARIABLE","$delta",74],["T_INC","++",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n      ",74],["T_COMMENT","\/\/ All deltas except '1' have incorrect values.\n",75],["T_WHITESPACE","      ",76],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$delta",76],["T_WHITESPACE"," ",76],["T_IS_EQUAL","==",76],["T_WHITESPACE"," ",76],["T_LNUMBER","1",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$value",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_LNUMBER","1",77],";",["T_WHITESPACE","\n      ",77],"}",["T_WHITESPACE","\n      ",78],["T_ELSE","else",79],["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$value",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],"-",["T_LNUMBER","1",80],";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$expected_violations",81],"[",["T_VARIABLE","$delta",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'.value'",81],"]","[","]",["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","t",81],"(",["T_CONSTANT_ENCAPSED_STRING","'%name does not accept the value -1.'",81],",",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",["T_CONSTANT_ENCAPSED_STRING","'%name'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","fieldTestData",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","field",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getLabel",81],"(",")",")",")",";",["T_WHITESPACE","\n      ",81],"}",["T_WHITESPACE","\n      ",82],["T_VARIABLE","$entity",83],["T_OBJECT_OPERATOR","->",83],"{",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","fieldTestData",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","field_name",83],"}","[","]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$value",83],";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_COMMENT","\/\/ Validate the field.\n",86],["T_WHITESPACE","    ",87],["T_VARIABLE","$violations",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$entity",87],["T_OBJECT_OPERATOR","->",87],"{",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","fieldTestData",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","field_name",87],"}",["T_OBJECT_OPERATOR","->",87],["T_STRING","validate",87],"(",")",";",["T_WHITESPACE","\n\n    ",87],["T_COMMENT","\/\/ Check that the expected constraint violations are reported.\n",89],["T_WHITESPACE","    ",90],["T_VARIABLE","$violations_by_path",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_ARRAY","array",90],"(",")",";",["T_WHITESPACE","\n    ",90],["T_FOREACH","foreach",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$violations",91],["T_WHITESPACE"," ",91],["T_AS","as",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$violation",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n      ",91],["T_VARIABLE","$violations_by_path",92],"[",["T_VARIABLE","$violation",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getPropertyPath",92],"(",")","]","[","]",["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$violation",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getMessage",92],"(",")",";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertEqual",94],"(",["T_VARIABLE","$violations_by_path",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$expected_violations",94],")",";",["T_WHITESPACE","\n  ",94],"}",["T_WHITESPACE","\n\n",95],"}",["T_WHITESPACE","\n",97]]