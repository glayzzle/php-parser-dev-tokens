[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","content_moderation",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Validation",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Constraint",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","content_moderation",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ModerationState",5],["T_WHITESPACE"," ",5],["T_AS","as",5],["T_WHITESPACE"," ",5],["T_STRING","ModerationStateEntity",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","DependencyInjection",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ContainerInjectionInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntityTypeManagerInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","content_moderation",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ModerationInformationInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","content_moderation",10],["T_NS_SEPARATOR","\\",10],["T_STRING","StateTransitionValidation",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Symfony",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Component",11],["T_NS_SEPARATOR","\\",11],["T_STRING","DependencyInjection",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ContainerInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Validator",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Constraint",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Symfony",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Component",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Validator",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ConstraintValidator",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Checks if a moderation state transition is valid.\n *\/",15],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","ModerationStateConstraintValidator",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_STRING","ConstraintValidator",18],["T_WHITESPACE"," ",18],["T_IMPLEMENTS","implements",18],["T_WHITESPACE"," ",18],["T_STRING","ContainerInjectionInterface",18],["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * The state transition validation.\n   *\n   * @var \\Drupal\\content_moderation\\StateTransitionValidation\n   *\/",20],["T_WHITESPACE","\n  ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$validation",25],";",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * The entity type manager.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityTypeManagerInterface\n   *\/",27],["T_WHITESPACE","\n  ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$entityTypeManager",32],";",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * The moderation info.\n   *\n   * @var \\Drupal\\content_moderation\\ModerationInformationInterface\n   *\/",34],["T_WHITESPACE","\n  ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$moderationInformation",39],";",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * Creates a new ModerationStateConstraintValidator instance.\n   *\n   * @param \\Drupal\\Core\\Entity\\EntityTypeManagerInterface $entity_type_manager\n   *   The entity type manager.\n   * @param \\Drupal\\content_moderation\\StateTransitionValidation $validation\n   *   The state transition validation.\n   * @param \\Drupal\\content_moderation\\ModerationInformationInterface $moderation_information\n   *   The moderation information.\n   *\/",41],["T_WHITESPACE","\n  ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","__construct",51],"(",["T_STRING","EntityTypeManagerInterface",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$entity_type_manager",51],",",["T_WHITESPACE"," ",51],["T_STRING","StateTransitionValidation",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$validation",51],",",["T_WHITESPACE"," ",51],["T_STRING","ModerationInformationInterface",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$moderation_information",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","validation",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$validation",52],";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","entityTypeManager",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$entity_type_manager",53],";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","moderationInformation",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$moderation_information",54],";",["T_WHITESPACE","\n  ",54],"}",["T_WHITESPACE","\n\n  ",55],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",57],["T_WHITESPACE","\n  ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_STATIC","static",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","create",60],"(",["T_STRING","ContainerInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$container",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n    ",60],["T_RETURN","return",61],["T_WHITESPACE"," ",61],["T_NEW","new",61],["T_WHITESPACE"," ",61],["T_STATIC","static",61],"(",["T_WHITESPACE","\n      ",61],["T_VARIABLE","$container",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","get",62],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",62],")",",",["T_WHITESPACE","\n      ",62],["T_VARIABLE","$container",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","get",63],"(",["T_CONSTANT_ENCAPSED_STRING","'content_moderation.state_transition_validation'",63],")",",",["T_WHITESPACE","\n      ",63],["T_VARIABLE","$container",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","get",64],"(",["T_CONSTANT_ENCAPSED_STRING","'content_moderation.moderation_information'",64],")",["T_WHITESPACE","\n    ",64],")",";",["T_WHITESPACE","\n  ",65],"}",["T_WHITESPACE","\n\n  ",66],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",68],["T_WHITESPACE","\n  ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","validate",71],"(",["T_VARIABLE","$value",71],",",["T_WHITESPACE"," ",71],["T_STRING","Constraint",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$constraint",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n    ",71],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Entity\\EntityInterface $entity *\/",72],["T_WHITESPACE","\n    ",72],["T_VARIABLE","$entity",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$value",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getEntity",73],"(",")",";",["T_WHITESPACE","\n\n    ",73],["T_COMMENT","\/\/ Ignore entities that are not subject to moderation anyway.\n",75],["T_WHITESPACE","    ",76],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","moderationInformation",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","isModeratedEntity",76],"(",["T_VARIABLE","$entity",76],")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n      ",76],["T_RETURN","return",77],";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_COMMENT","\/\/ Ignore entities that are being created for the first time.\n",80],["T_WHITESPACE","    ",81],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$entity",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","isNew",81],"(",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n      ",81],["T_RETURN","return",82],";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_COMMENT","\/\/ Ignore entities that are being moderated for the first time, such as\n",85],["T_WHITESPACE","    ",86],["T_COMMENT","\/\/ when they existed before moderation was enabled for this entity type.\n",86],["T_WHITESPACE","    ",87],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","isFirstTimeModeration",87],"(",["T_VARIABLE","$entity",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_RETURN","return",88],";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_VARIABLE","$original_entity",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","moderationInformation",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getLatestRevision",91],"(",["T_VARIABLE","$entity",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getEntityTypeId",91],"(",")",",",["T_WHITESPACE"," ",91],["T_VARIABLE","$entity",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","id",91],"(",")",")",";",["T_WHITESPACE","\n    ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(","!",["T_VARIABLE","$entity",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","isDefaultTranslation",92],"(",")",["T_WHITESPACE"," ",92],["T_BOOLEAN_AND","&&",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$original_entity",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","hasTranslation",92],"(",["T_VARIABLE","$entity",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","language",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","getId",92],"(",")",")",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n      ",92],["T_VARIABLE","$original_entity",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$original_entity",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getTranslation",93],"(",["T_VARIABLE","$entity",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","language",93],"(",")",["T_OBJECT_OPERATOR","->",93],["T_STRING","getId",93],"(",")",")",";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$entity",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","moderation_state",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","target_id",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$new_state_id",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$entity",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","moderation_state",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","target_id",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n    ",98],["T_ELSE","else",99],["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_VARIABLE","$new_state_id",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$default",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","entityTypeManager",100],["T_WHITESPACE","\n        ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","getStorage",101],"(",["T_VARIABLE","$entity",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getEntityType",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","getBundleEntityType",101],"(",")",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","load",101],"(",["T_VARIABLE","$entity",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","bundle",101],"(",")",")",["T_WHITESPACE","\n        ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","getThirdPartySetting",102],"(",["T_CONSTANT_ENCAPSED_STRING","'content_moderation'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'default_moderation_state'",102],")",";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n    ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$new_state_id",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n      ",104],["T_VARIABLE","$new_state",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","ModerationStateEntity",105],["T_DOUBLE_COLON","::",105],["T_STRING","load",105],"(",["T_VARIABLE","$new_state_id",105],")",";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n    ",106],["T_COMMENT","\/\/ @todo - what if $new_state_id references something that does not exist or\n",107],["T_WHITESPACE","    ",108],["T_COMMENT","\/\/   is null.\n",108],["T_WHITESPACE","    ",109],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","validation",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","isTransitionAllowed",109],"(",["T_VARIABLE","$original_entity",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","moderation_state",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","entity",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$new_state",109],")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n      ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","context",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","addViolation",110],"(",["T_VARIABLE","$constraint",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","message",110],",",["T_WHITESPACE"," ",110],"[",["T_CONSTANT_ENCAPSED_STRING","'%from'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$original_entity",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","moderation_state",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","entity",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","label",110],"(",")",",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'%to'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$new_state",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","label",110],"(",")","]",")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n  ",111],"}",["T_WHITESPACE","\n\n  ",112],["T_DOC_COMMENT","\/**\n   * Determines if this entity is being moderated for the first time.\n   *\n   * If the previous version of the entity has no moderation state, we assume\n   * that means it predates the presence of moderation states.\n   *\n   * @param \\Drupal\\Core\\Entity\\EntityInterface $entity\n   *   The entity being moderated.\n   *\n   * @return bool\n   *   TRUE if this is the entity's first time being moderated, FALSE otherwise.\n   *\/",114],["T_WHITESPACE","\n  ",125],["T_PROTECTED","protected",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","isFirstTimeModeration",126],"(",["T_STRING","EntityInterface",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$entity",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$original_entity",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","moderationInformation",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getLatestRevision",127],"(",["T_VARIABLE","$entity",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getEntityTypeId",127],"(",")",",",["T_WHITESPACE"," ",127],["T_VARIABLE","$entity",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","id",127],"(",")",")",";",["T_WHITESPACE","\n\n    ",127],["T_VARIABLE","$original_id",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$original_entity",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","moderation_state",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","target_id",129],";",["T_WHITESPACE","\n\n    ",129],["T_RETURN","return",131],["T_WHITESPACE"," ",131],"!","(",["T_VARIABLE","$entity",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","moderation_state",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","target_id",131],["T_WHITESPACE"," ",131],["T_BOOLEAN_AND","&&",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$original_entity",131],["T_WHITESPACE"," ",131],["T_BOOLEAN_AND","&&",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$original_id",131],")",";",["T_WHITESPACE","\n  ",131],"}",["T_WHITESPACE","\n\n",132],"}",["T_WHITESPACE","\n",134]]