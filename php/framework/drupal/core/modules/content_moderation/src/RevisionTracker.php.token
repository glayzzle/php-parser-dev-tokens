[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","content_moderation",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Connection",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Database",6],["T_NS_SEPARATOR","\\",6],["T_STRING","DatabaseExceptionWrapper",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Database",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SchemaObjectExistsException",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Tracks metadata about revisions across entities.\n *\/",9],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","RevisionTracker",12],["T_WHITESPACE"," ",12],["T_IMPLEMENTS","implements",12],["T_WHITESPACE"," ",12],["T_STRING","RevisionTrackerInterface",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * The name of the SQL table we use for tracking.\n   *\n   * @var string\n   *\/",14],["T_WHITESPACE","\n  ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$tableName",19],";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * The database connection.\n   *\n   * @var \\Drupal\\Core\\Database\\Connection\n   *\/",21],["T_WHITESPACE","\n  ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$connection",26],";",["T_WHITESPACE","\n\n  ",26],["T_DOC_COMMENT","\/**\n   * Constructs a new RevisionTracker.\n   *\n   * @param \\Drupal\\Core\\Database\\Connection $connection\n   *   The database connection.\n   * @param string $table\n   *   The table that should be used for tracking.\n   *\/",28],["T_WHITESPACE","\n  ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","__construct",36],"(",["T_STRING","Connection",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$connection",36],",",["T_WHITESPACE"," ",36],["T_VARIABLE","$table",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'content_revision_tracker'",36],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","connection",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$connection",37],";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","tableName",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$table",38],";",["T_WHITESPACE","\n  ",38],"}",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",41],["T_WHITESPACE","\n  ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","setLatestRevision",44],"(",["T_VARIABLE","$entity_type_id",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$entity_id",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$langcode",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$revision_id",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n    ",44],["T_TRY","try",45],["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n      ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","recordLatestRevision",46],"(",["T_VARIABLE","$entity_type_id",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$entity_id",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$langcode",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$revision_id",46],")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n    ",47],["T_CATCH","catch",48],["T_WHITESPACE"," ",48],"(",["T_STRING","DatabaseExceptionWrapper",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$e",48],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n      ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","ensureTableExists",49],"(",")",";",["T_WHITESPACE","\n      ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","recordLatestRevision",50],"(",["T_VARIABLE","$entity_type_id",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$entity_id",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$langcode",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$revision_id",50],")",";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],";",["T_WHITESPACE","\n  ",53],"}",["T_WHITESPACE","\n\n  ",54],["T_DOC_COMMENT","\/**\n   * Records the latest revision of a given entity.\n   *\n   * @param string $entity_type_id\n   *   The machine name of the type of entity.\n   * @param string $entity_id\n   *   The Entity ID in question.\n   * @param string $langcode\n   *   The langcode of the revision we're saving. Each language has its own\n   *   effective tree of entity revisions, so in different languages\n   *   different revisions will be \"latest\".\n   * @param int $revision_id\n   *   The revision ID that is now the latest revision.\n   *\n   * @return int\n   *   One of the valid returns from a merge query's execute method.\n   *\/",56],["T_WHITESPACE","\n  ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","recordLatestRevision",73],"(",["T_VARIABLE","$entity_type_id",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$entity_id",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$langcode",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$revision_id",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n    ",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","connection",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","merge",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","tableName",74],")",["T_WHITESPACE","\n      ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","keys",75],"(","[",["T_WHITESPACE","\n        ",75],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$entity_type_id",76],",",["T_WHITESPACE","\n        ",76],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$entity_id",77],",",["T_WHITESPACE","\n        ",77],["T_CONSTANT_ENCAPSED_STRING","'langcode'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$langcode",78],",",["T_WHITESPACE","\n      ",78],"]",")",["T_WHITESPACE","\n      ",79],["T_OBJECT_OPERATOR","->",80],["T_STRING","fields",80],"(","[",["T_WHITESPACE","\n        ",80],["T_CONSTANT_ENCAPSED_STRING","'revision_id'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$revision_id",81],",",["T_WHITESPACE","\n      ",81],"]",")",["T_WHITESPACE","\n      ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","execute",83],"(",")",";",["T_WHITESPACE","\n  ",83],"}",["T_WHITESPACE","\n\n  ",84],["T_DOC_COMMENT","\/**\n   * Checks if the table exists and create it if not.\n   *\n   * @return bool\n   *   TRUE if the table was created, FALSE otherwise.\n   *\/",86],["T_WHITESPACE","\n  ",91],["T_PROTECTED","protected",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","ensureTableExists",92],"(",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n    ",92],["T_TRY","try",93],["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n      ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(","!",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","connection",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","schema",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","tableExists",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","tableName",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","connection",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","schema",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","createTable",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","tableName",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","schemaDefinition",95],"(",")",")",";",["T_WHITESPACE","\n        ",95],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_STRING","TRUE",96],";",["T_WHITESPACE","\n      ",96],"}",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n    ",98],["T_CATCH","catch",99],["T_WHITESPACE"," ",99],"(",["T_STRING","SchemaObjectExistsException",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$e",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n      ",99],["T_COMMENT","\/\/ If another process has already created the table, attempting to\n",100],["T_WHITESPACE","      ",101],["T_COMMENT","\/\/ recreate it will throw an exception. In this case just catch the\n",101],["T_WHITESPACE","      ",102],["T_COMMENT","\/\/ exception and do nothing.\n",102],["T_WHITESPACE","      ",103],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_STRING","TRUE",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n    ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_STRING","FALSE",105],";",["T_WHITESPACE","\n  ",105],"}",["T_WHITESPACE","\n\n  ",106],["T_DOC_COMMENT","\/**\n   * Defines the schema for the tracker table.\n   *\n   * @return array\n   *   The schema API definition for the SQL storage table.\n   *\/",108],["T_WHITESPACE","\n  ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","schemaDefinition",114],"(",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$schema",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],"[",["T_WHITESPACE","\n      ",115],["T_CONSTANT_ENCAPSED_STRING","'description'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'Tracks the latest revision for any entity'",116],",",["T_WHITESPACE","\n      ",116],["T_CONSTANT_ENCAPSED_STRING","'fields'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],"[",["T_WHITESPACE","\n        ",117],["T_CONSTANT_ENCAPSED_STRING","'entity_type'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],"[",["T_WHITESPACE","\n          ",118],["T_CONSTANT_ENCAPSED_STRING","'description'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'The entity type'",119],",",["T_WHITESPACE","\n          ",119],["T_CONSTANT_ENCAPSED_STRING","'type'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'varchar_ascii'",120],",",["T_WHITESPACE","\n          ",120],["T_CONSTANT_ENCAPSED_STRING","'length'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_LNUMBER","255",121],",",["T_WHITESPACE","\n          ",121],["T_CONSTANT_ENCAPSED_STRING","'not null'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_STRING","TRUE",122],",",["T_WHITESPACE","\n          ",122],["T_CONSTANT_ENCAPSED_STRING","'default'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","''",123],",",["T_WHITESPACE","\n        ",123],"]",",",["T_WHITESPACE","\n        ",124],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],"[",["T_WHITESPACE","\n          ",125],["T_CONSTANT_ENCAPSED_STRING","'description'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'The entity ID'",126],",",["T_WHITESPACE","\n          ",126],["T_CONSTANT_ENCAPSED_STRING","'type'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'int'",127],",",["T_WHITESPACE","\n          ",127],["T_CONSTANT_ENCAPSED_STRING","'length'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_LNUMBER","255",128],",",["T_WHITESPACE","\n          ",128],["T_CONSTANT_ENCAPSED_STRING","'not null'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_STRING","TRUE",129],",",["T_WHITESPACE","\n          ",129],["T_CONSTANT_ENCAPSED_STRING","'default'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_LNUMBER","0",130],",",["T_WHITESPACE","\n        ",130],"]",",",["T_WHITESPACE","\n        ",131],["T_CONSTANT_ENCAPSED_STRING","'langcode'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],"[",["T_WHITESPACE","\n          ",132],["T_CONSTANT_ENCAPSED_STRING","'description'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'The language of the entity revision'",133],",",["T_WHITESPACE","\n          ",133],["T_CONSTANT_ENCAPSED_STRING","'type'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'varchar'",134],",",["T_WHITESPACE","\n          ",134],["T_CONSTANT_ENCAPSED_STRING","'length'",135],["T_WHITESPACE"," ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_LNUMBER","12",135],",",["T_WHITESPACE","\n          ",135],["T_CONSTANT_ENCAPSED_STRING","'not null'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_STRING","TRUE",136],",",["T_WHITESPACE","\n          ",136],["T_CONSTANT_ENCAPSED_STRING","'default'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","''",137],",",["T_WHITESPACE","\n        ",137],"]",",",["T_WHITESPACE","\n        ",138],["T_CONSTANT_ENCAPSED_STRING","'revision_id'",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],"[",["T_WHITESPACE","\n          ",139],["T_CONSTANT_ENCAPSED_STRING","'description'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'The latest revision ID for this entity'",140],",",["T_WHITESPACE","\n          ",140],["T_CONSTANT_ENCAPSED_STRING","'type'",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'int'",141],",",["T_WHITESPACE","\n          ",141],["T_CONSTANT_ENCAPSED_STRING","'not null'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_STRING","TRUE",142],",",["T_WHITESPACE","\n          ",142],["T_CONSTANT_ENCAPSED_STRING","'default'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_LNUMBER","0",143],",",["T_WHITESPACE","\n        ",143],"]",",",["T_WHITESPACE","\n      ",144],"]",",",["T_WHITESPACE","\n      ",145],["T_CONSTANT_ENCAPSED_STRING","'primary key'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",146],",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",146],",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'langcode'",146],"]",",",["T_WHITESPACE","\n    ",146],"]",";",["T_WHITESPACE","\n\n    ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$schema",149],";",["T_WHITESPACE","\n  ",149],"}",["T_WHITESPACE","\n\n",150],"}",["T_WHITESPACE","\n",152]]