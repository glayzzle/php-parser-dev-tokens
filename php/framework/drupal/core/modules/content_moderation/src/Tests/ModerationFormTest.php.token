[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","content_moderation",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Tests the moderation form, specifically on nodes.\n *\n * @group content_moderation\n *\/",5],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","ModerationFormTest",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_STRING","ModerationStateTestBase",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",12],["T_WHITESPACE","\n  ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_FUNCTION","function",15],["T_WHITESPACE"," ",15],["T_STRING","setUp",15],"(",")",["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n    ",15],["T_STRING","parent",16],["T_DOUBLE_COLON","::",16],["T_STRING","setUp",16],"(",")",";",["T_WHITESPACE","\n    ",16],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","drupalLogin",17],"(",["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","adminUser",17],")",";",["T_WHITESPACE","\n    ",17],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","createContentTypeFromUi",18],"(",["T_CONSTANT_ENCAPSED_STRING","'Moderated content'",18],",",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'moderated_content'",18],",",["T_WHITESPACE"," ",18],["T_STRING","TRUE",18],",",["T_WHITESPACE"," ",18],"[",["T_WHITESPACE","\n      ",18],["T_CONSTANT_ENCAPSED_STRING","'draft'",19],",",["T_WHITESPACE","\n      ",19],["T_CONSTANT_ENCAPSED_STRING","'published'",20],",",["T_WHITESPACE","\n    ",20],"]",",",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'draft'",21],")",";",["T_WHITESPACE","\n    ",21],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","grantUserPermissionToCreateContentOfType",22],"(",["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","adminUser",22],",",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'moderated_content'",22],")",";",["T_WHITESPACE","\n  ",22],"}",["T_WHITESPACE","\n\n  ",23],["T_DOC_COMMENT","\/**\n   * Tests the moderation form that shows on the latest version page.\n   *\n   * The latest version page only shows if there is a forward revision. There\n   * is only a forward revision if a draft revision is created on a node where\n   * the default revision is not a published moderation state.\n   *\n   * @see \\Drupal\\content_moderation\\EntityOperations\n   * @see \\Drupal\\content_moderation\\Tests\\ModerationStateBlockTest::testCustomBlockModeration\n   *\/",25],["T_WHITESPACE","\n  ",34],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","testModerationForm",35],"(",")",["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n    ",35],["T_COMMENT","\/\/ Create new moderated content in draft.\n",36],["T_WHITESPACE","    ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","drupalPostForm",37],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/add\/moderated_content'",37],",",["T_WHITESPACE"," ",37],"[",["T_WHITESPACE","\n      ",37],["T_CONSTANT_ENCAPSED_STRING","'title[0][value]'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'Some moderated content'",38],",",["T_WHITESPACE","\n      ",38],["T_CONSTANT_ENCAPSED_STRING","'body[0][value]'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'First version of the content.'",39],",",["T_WHITESPACE","\n    ",39],"]",",",["T_WHITESPACE"," ",40],["T_STRING","t",40],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and Create New Draft'",40],")",")",";",["T_WHITESPACE","\n\n    ",40],["T_VARIABLE","$node",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","drupalGetNodeByTitle",42],"(",["T_CONSTANT_ENCAPSED_STRING","'Some moderated content'",42],")",";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$canonical_path",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","sprintf",43],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/%d'",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$node",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","id",43],"(",")",")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$edit_path",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","sprintf",44],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/%d\/edit'",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$node",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","id",44],"(",")",")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$latest_version_path",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","sprintf",45],"(",["T_CONSTANT_ENCAPSED_STRING","'node\/%d\/latest'",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$node",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","id",45],"(",")",")",";",["T_WHITESPACE","\n\n    ",45],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertTrue",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","adminUser",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","hasPermission",47],"(",["T_CONSTANT_ENCAPSED_STRING","'edit any moderated_content content'",47],")",")",";",["T_WHITESPACE","\n\n    ",47],["T_COMMENT","\/\/ The latest version page should not show, because there is no forward\n",49],["T_WHITESPACE","    ",50],["T_COMMENT","\/\/ revision.\n",50],["T_WHITESPACE","    ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalGet",51],"(",["T_VARIABLE","$latest_version_path",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","assertResponse",52],"(",["T_LNUMBER","403",52],")",";",["T_WHITESPACE","\n\n    ",52],["T_COMMENT","\/\/ Update the draft.\n",54],["T_WHITESPACE","    ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","drupalPostForm",55],"(",["T_VARIABLE","$edit_path",55],",",["T_WHITESPACE"," ",55],"[",["T_WHITESPACE","\n      ",55],["T_CONSTANT_ENCAPSED_STRING","'body[0][value]'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'Second version of the content.'",56],",",["T_WHITESPACE","\n    ",56],"]",",",["T_WHITESPACE"," ",57],["T_STRING","t",57],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and Create New Draft'",57],")",")",";",["T_WHITESPACE","\n\n    ",57],["T_COMMENT","\/\/ The latest version page should not show, because there is still no\n",59],["T_WHITESPACE","    ",60],["T_COMMENT","\/\/ forward revision.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","drupalGet",61],"(",["T_VARIABLE","$latest_version_path",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertResponse",62],"(",["T_LNUMBER","403",62],")",";",["T_WHITESPACE","\n\n    ",62],["T_COMMENT","\/\/ Publish the draft.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","drupalPostForm",65],"(",["T_VARIABLE","$edit_path",65],",",["T_WHITESPACE"," ",65],"[",["T_WHITESPACE","\n      ",65],["T_CONSTANT_ENCAPSED_STRING","'body[0][value]'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'Third version of the content.'",66],",",["T_WHITESPACE","\n    ",66],"]",",",["T_WHITESPACE"," ",67],["T_STRING","t",67],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and Publish'",67],")",")",";",["T_WHITESPACE","\n\n    ",67],["T_COMMENT","\/\/ The published view should not have a moderation form, because it is the\n",69],["T_WHITESPACE","    ",70],["T_COMMENT","\/\/ default revision.\n",70],["T_WHITESPACE","    ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","drupalGet",71],"(",["T_VARIABLE","$canonical_path",71],")",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertResponse",72],"(",["T_LNUMBER","200",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","assertNoText",73],"(",["T_CONSTANT_ENCAPSED_STRING","'Status'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'The node view page has no moderation form.'",73],")",";",["T_WHITESPACE","\n\n    ",73],["T_COMMENT","\/\/ The latest version page should not show, because there is still no\n",75],["T_WHITESPACE","    ",76],["T_COMMENT","\/\/ forward revision.\n",76],["T_WHITESPACE","    ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","drupalGet",77],"(",["T_VARIABLE","$latest_version_path",77],")",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertResponse",78],"(",["T_LNUMBER","403",78],")",";",["T_WHITESPACE","\n\n    ",78],["T_COMMENT","\/\/ Make a forward revision.\n",80],["T_WHITESPACE","    ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","drupalPostForm",81],"(",["T_VARIABLE","$edit_path",81],",",["T_WHITESPACE"," ",81],"[",["T_WHITESPACE","\n      ",81],["T_CONSTANT_ENCAPSED_STRING","'body[0][value]'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'Fourth version of the content.'",82],",",["T_WHITESPACE","\n    ",82],"]",",",["T_WHITESPACE"," ",83],["T_STRING","t",83],"(",["T_CONSTANT_ENCAPSED_STRING","'Save and Create New Draft'",83],")",")",";",["T_WHITESPACE","\n\n    ",83],["T_COMMENT","\/\/ The published view should not have a moderation form, because it is the\n",85],["T_WHITESPACE","    ",86],["T_COMMENT","\/\/ default revision.\n",86],["T_WHITESPACE","    ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","drupalGet",87],"(",["T_VARIABLE","$canonical_path",87],")",";",["T_WHITESPACE","\n    ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertResponse",88],"(",["T_LNUMBER","200",88],")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertNoText",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Status'",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'The node view page has no moderation form.'",89],")",";",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ The latest version page should show the moderation form and have \"Draft\"\n",91],["T_WHITESPACE","    ",92],["T_COMMENT","\/\/ status, because the forward revision is in \"Draft\".\n",92],["T_WHITESPACE","    ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","drupalGet",93],"(",["T_VARIABLE","$latest_version_path",93],")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertResponse",94],"(",["T_LNUMBER","200",94],")",";",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertText",95],"(",["T_CONSTANT_ENCAPSED_STRING","'Status'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'Form text found on the latest-version page.'",95],")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","assertText",96],"(",["T_CONSTANT_ENCAPSED_STRING","'Draft'",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'Correct status found on the latest-version page.'",96],")",";",["T_WHITESPACE","\n\n    ",96],["T_COMMENT","\/\/ Submit the moderation form to change status to published.\n",98],["T_WHITESPACE","    ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","drupalPostForm",99],"(",["T_VARIABLE","$latest_version_path",99],",",["T_WHITESPACE"," ",99],"[",["T_WHITESPACE","\n      ",99],["T_CONSTANT_ENCAPSED_STRING","'new_state'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'published'",100],",",["T_WHITESPACE","\n    ",100],"]",",",["T_WHITESPACE"," ",101],["T_STRING","t",101],"(",["T_CONSTANT_ENCAPSED_STRING","'Apply'",101],")",")",";",["T_WHITESPACE","\n\n    ",101],["T_COMMENT","\/\/ The latest version page should not show, because there is no\n",103],["T_WHITESPACE","    ",104],["T_COMMENT","\/\/ forward revision.\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","drupalGet",105],"(",["T_VARIABLE","$latest_version_path",105],")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertResponse",106],"(",["T_LNUMBER","403",106],")",";",["T_WHITESPACE","\n  ",106],"}",["T_WHITESPACE","\n\n",107],"}",["T_WHITESPACE","\n",109]]