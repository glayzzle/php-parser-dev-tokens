[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","block_content",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","block_content",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Entity",5],["T_NS_SEPARATOR","\\",5],["T_STRING","BlockContent",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests $block_content->save() for saving content.\n *\n * @group block_content\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","BlockContentSaveTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","BlockContentTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",14],["T_WHITESPACE","\n  ",18],["T_PUBLIC","public",19],["T_WHITESPACE"," ",19],["T_STATIC","static",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$modules",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_ARRAY","array",19],"(",["T_CONSTANT_ENCAPSED_STRING","'block_content_test'",19],")",";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * Sets the test up.\n   *\/",21],["T_WHITESPACE","\n  ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","setUp",24],"(",")",["T_WHITESPACE"," ",24],"{",["T_WHITESPACE","\n    ",24],["T_STRING","parent",25],["T_DOUBLE_COLON","::",25],["T_STRING","setUp",25],"(",")",";",["T_WHITESPACE","\n\n    ",25],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","drupalLogin",27],"(",["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","adminUser",27],")",";",["T_WHITESPACE","\n  ",27],"}",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * Checks whether custom block IDs are saved properly during an import.\n   *\/",30],["T_WHITESPACE","\n  ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","testImport",33],"(",")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n    ",33],["T_COMMENT","\/\/ Custom block ID must be a number that is not in the database.\n",34],["T_WHITESPACE","    ",35],["T_VARIABLE","$max_id",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","db_query",35],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT MAX(id) FROM {block_content}'",35],")",["T_OBJECT_OPERATOR","->",35],["T_STRING","fetchField",35],"(",")",";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$test_id",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$max_id",36],["T_WHITESPACE"," ",36],"+",["T_WHITESPACE"," ",36],["T_STRING","mt_rand",36],"(",["T_LNUMBER","1000",36],",",["T_WHITESPACE"," ",36],["T_LNUMBER","1000000",36],")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$info",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","randomMachineName",37],"(",["T_LNUMBER","8",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$block_array",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",["T_WHITESPACE","\n      ",38],["T_CONSTANT_ENCAPSED_STRING","'info'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$info",39],",",["T_WHITESPACE","\n      ",39],["T_CONSTANT_ENCAPSED_STRING","'body'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_ARRAY","array",40],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","randomMachineName",40],"(",["T_LNUMBER","32",40],")",")",",",["T_WHITESPACE","\n      ",40],["T_CONSTANT_ENCAPSED_STRING","'type'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'basic'",41],",",["T_WHITESPACE","\n      ",41],["T_CONSTANT_ENCAPSED_STRING","'id'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$test_id",42],["T_WHITESPACE","\n    ",42],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$block",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","BlockContent",44],["T_DOUBLE_COLON","::",44],["T_STRING","create",44],"(",["T_VARIABLE","$block_array",44],")",";",["T_WHITESPACE","\n    ",44],["T_VARIABLE","$block",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","enforceIsNew",45],"(",["T_STRING","TRUE",45],")",";",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$block",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","save",46],"(",")",";",["T_WHITESPACE","\n\n    ",46],["T_COMMENT","\/\/ Verify that block_submit did not wipe the provided id.\n",48],["T_WHITESPACE","    ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertEqual",49],"(",["T_VARIABLE","$block",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","id",49],"(",")",",",["T_WHITESPACE"," ",49],["T_VARIABLE","$test_id",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'Block imported using provide id'",49],")",";",["T_WHITESPACE","\n\n    ",49],["T_COMMENT","\/\/ Test the import saved.\n",51],["T_WHITESPACE","    ",52],["T_VARIABLE","$block_by_id",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","BlockContent",52],["T_DOUBLE_COLON","::",52],["T_STRING","load",52],"(",["T_VARIABLE","$test_id",52],")",";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","assertTrue",53],"(",["T_VARIABLE","$block_by_id",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Custom block load by block ID.'",53],")",";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertIdentical",54],"(",["T_VARIABLE","$block_by_id",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","body",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","value",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$block_array",54],"[",["T_CONSTANT_ENCAPSED_STRING","'body'",54],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",54],"]",")",";",["T_WHITESPACE","\n  ",54],"}",["T_WHITESPACE","\n\n  ",55],["T_DOC_COMMENT","\/**\n   * Tests determining changes in hook_block_presave().\n   *\n   * Verifies the static block load cache is cleared upon save.\n   *\/",57],["T_WHITESPACE","\n  ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","testDeterminingChanges",62],"(",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n    ",62],["T_COMMENT","\/\/ Initial creation.\n",63],["T_WHITESPACE","    ",64],["T_VARIABLE","$block",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","createBlockContent",64],"(",["T_CONSTANT_ENCAPSED_STRING","'test_changes'",64],")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertEqual",65],"(",["T_VARIABLE","$block",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getChangedTime",65],"(",")",",",["T_WHITESPACE"," ",65],["T_STRING","REQUEST_TIME",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'Creating a block sets default \"changed\" timestamp.'",65],")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ Update the block without applying changes.\n",67],["T_WHITESPACE","    ",68],["T_VARIABLE","$block",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","save",68],"(",")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEqual",69],"(",["T_VARIABLE","$block",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","label",69],"(",")",",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'test_changes'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'No changes have been determined.'",69],")",";",["T_WHITESPACE","\n\n    ",69],["T_COMMENT","\/\/ Apply changes.\n",71],["T_WHITESPACE","    ",72],["T_VARIABLE","$block",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","setInfo",72],"(",["T_CONSTANT_ENCAPSED_STRING","'updated'",72],")",";",["T_WHITESPACE","\n    ",72],["T_VARIABLE","$block",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","save",73],"(",")",";",["T_WHITESPACE","\n\n    ",73],["T_COMMENT","\/\/ The hook implementations block_content_test_block_content_presave() and\n",75],["T_WHITESPACE","    ",76],["T_COMMENT","\/\/ block_content_test_block_content_update() determine changes and change\n",76],["T_WHITESPACE","    ",77],["T_COMMENT","\/\/ the title as well as programmatically set the 'changed' timestamp.\n",77],["T_WHITESPACE","    ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertEqual",78],"(",["T_VARIABLE","$block",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","label",78],"(",")",",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'updated_presave_update'",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'Changes have been determined.'",78],")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertEqual",79],"(",["T_VARIABLE","$block",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getChangedTime",79],"(",")",",",["T_WHITESPACE"," ",79],["T_LNUMBER","979534800",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'Saving a custom block uses \"changed\" timestamp set in presave hook.'",79],")",";",["T_WHITESPACE","\n\n    ",79],["T_COMMENT","\/\/ Test the static block load cache to be cleared.\n",81],["T_WHITESPACE","    ",82],["T_VARIABLE","$block",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","BlockContent",82],["T_DOUBLE_COLON","::",82],["T_STRING","load",82],"(",["T_VARIABLE","$block",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","id",82],"(",")",")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertEqual",83],"(",["T_VARIABLE","$block",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","label",83],"(",")",",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'updated_presave'",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'Static cache has been cleared.'",83],")",";",["T_WHITESPACE","\n  ",83],"}",["T_WHITESPACE","\n\n  ",84],["T_DOC_COMMENT","\/**\n   * Tests saving a block on block insert.\n   *\n   * This test ensures that a block has been fully saved when\n   * hook_block_content_insert() is invoked, so that the block can be saved again\n   * in a hook implementation without errors.\n   *\n   * @see block_test_block_insert()\n   *\/",86],["T_WHITESPACE","\n  ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","testBlockContentSaveOnInsert",95],"(",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n    ",95],["T_COMMENT","\/\/ block_content_test_block_content_insert() triggers a save on insert if the\n",96],["T_WHITESPACE","    ",97],["T_COMMENT","\/\/ title equals 'new'.\n",97],["T_WHITESPACE","    ",98],["T_VARIABLE","$block",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","createBlockContent",98],"(",["T_CONSTANT_ENCAPSED_STRING","'new'",98],")",";",["T_WHITESPACE","\n    ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","assertEqual",99],"(",["T_VARIABLE","$block",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","label",99],"(",")",",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'BlockContent '",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$block",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","id",99],"(",")",",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'Custom block saved on block insert.'",99],")",";",["T_WHITESPACE","\n  ",99],"}",["T_WHITESPACE","\n\n",100],"}",["T_WHITESPACE","\n",102]]