[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","hal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Normalizer",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","NestedArray",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","EntityInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityManagerInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Extension",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ModuleHandlerInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","rest",9],["T_NS_SEPARATOR","\\",9],["T_STRING","LinkManager",9],["T_NS_SEPARATOR","\\",9],["T_STRING","LinkManagerInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Symfony",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Component",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Serializer",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Exception",10],["T_NS_SEPARATOR","\\",10],["T_STRING","UnexpectedValueException",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Converts the Drupal entity object structure to a HAL array structure.\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","ContentEntityNormalizer",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","NormalizerBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * The interface or class that this Normalizer supports.\n   *\n   * @var string\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$supportedInterfaceOrClass",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Entity\\ContentEntityInterface'",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The hypermedia link manager.\n   *\n   * @var \\Drupal\\rest\\LinkManager\\LinkManagerInterface\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$linkManager",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * The entity manager.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityManagerInterface\n   *\/",31],["T_WHITESPACE","\n  ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$entityManager",36],";",["T_WHITESPACE","\n\n  ",36],["T_DOC_COMMENT","\/**\n   * The module handler.\n   *\n   * @var \\Drupal\\Core\\Extension\\ModuleHandlerInterface\n   *\/",38],["T_WHITESPACE","\n  ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$moduleHandler",43],";",["T_WHITESPACE","\n\n\n  ",43],["T_DOC_COMMENT","\/**\n   * Constructs an ContentEntityNormalizer object.\n   *\n   * @param \\Drupal\\rest\\LinkManager\\LinkManagerInterface $link_manager\n   *   The hypermedia link manager.\n   *\/",46],["T_WHITESPACE","\n  ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","__construct",52],"(",["T_STRING","LinkManagerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$link_manager",52],",",["T_WHITESPACE"," ",52],["T_STRING","EntityManagerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$entity_manager",52],",",["T_WHITESPACE"," ",52],["T_STRING","ModuleHandlerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$module_handler",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","linkManager",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$link_manager",53],";",["T_WHITESPACE","\n    ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","entityManager",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$entity_manager",54],";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","moduleHandler",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$module_handler",55],";",["T_WHITESPACE","\n  ",55],"}",["T_WHITESPACE","\n\n  ",56],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",58],["T_WHITESPACE","\n  ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","normalize",61],"(",["T_VARIABLE","$entity",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$format",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","NULL",61],",",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$context",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$context",62],["T_WHITESPACE"," ",62],["T_PLUS_EQUAL","+=",62],["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_WHITESPACE","\n      ",62],["T_CONSTANT_ENCAPSED_STRING","'account'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_STRING","NULL",63],",",["T_WHITESPACE","\n      ",63],["T_CONSTANT_ENCAPSED_STRING","'included_fields'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","NULL",64],",",["T_WHITESPACE","\n    ",64],")",";",["T_WHITESPACE","\n\n    ",65],["T_COMMENT","\/\/ Create the array of normalized fields, starting with the URI.\n",67],["T_WHITESPACE","    ",68],["T_DOC_COMMENT","\/** @var $entity \\Drupal\\Core\\Entity\\ContentEntityInterface *\/",68],["T_WHITESPACE","\n    ",68],["T_VARIABLE","$normalized",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_WHITESPACE","\n      ",69],["T_CONSTANT_ENCAPSED_STRING","'_links'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_ARRAY","array",70],"(",["T_WHITESPACE","\n        ",70],["T_CONSTANT_ENCAPSED_STRING","'self'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_ARRAY","array",71],"(",["T_WHITESPACE","\n          ",71],["T_CONSTANT_ENCAPSED_STRING","'href'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getEntityUri",72],"(",["T_VARIABLE","$entity",72],")",",",["T_WHITESPACE","\n        ",72],")",",",["T_WHITESPACE","\n        ",73],["T_CONSTANT_ENCAPSED_STRING","'type'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_ARRAY","array",74],"(",["T_WHITESPACE","\n          ",74],["T_CONSTANT_ENCAPSED_STRING","'href'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","linkManager",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getTypeUri",75],"(",["T_VARIABLE","$entity",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getEntityTypeId",75],"(",")",",",["T_WHITESPACE"," ",75],["T_VARIABLE","$entity",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","bundle",75],"(",")",",",["T_WHITESPACE"," ",75],["T_VARIABLE","$context",75],")",",",["T_WHITESPACE","\n        ",75],")",",",["T_WHITESPACE","\n      ",76],")",",",["T_WHITESPACE","\n    ",77],")",";",["T_WHITESPACE","\n\n    ",78],["T_COMMENT","\/\/ If the fields to use were specified, only output those field values.\n",80],["T_WHITESPACE","    ",81],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_ISSET","isset",81],"(",["T_VARIABLE","$context",81],"[",["T_CONSTANT_ENCAPSED_STRING","'included_fields'",81],"]",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n      ",81],["T_VARIABLE","$fields",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_ARRAY","array",82],"(",")",";",["T_WHITESPACE","\n      ",82],["T_FOREACH","foreach",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$context",83],"[",["T_CONSTANT_ENCAPSED_STRING","'included_fields'",83],"]",["T_WHITESPACE"," ",83],["T_AS","as",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$field_name",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$fields",84],"[","]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$entity",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","get",84],"(",["T_VARIABLE","$field_name",84],")",";",["T_WHITESPACE","\n      ",84],"}",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n    ",86],["T_ELSE","else",87],["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_VARIABLE","$fields",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$entity",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getFields",88],"(",")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n    ",89],["T_FOREACH","foreach",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$fields",90],["T_WHITESPACE"," ",90],["T_AS","as",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$field",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n      ",90],["T_COMMENT","\/\/ Continue if the current user does not have access to view this field.\n",91],["T_WHITESPACE","      ",92],["T_IF","if",92],["T_WHITESPACE"," ",92],"(","!",["T_VARIABLE","$field",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","access",92],"(",["T_CONSTANT_ENCAPSED_STRING","'view'",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$context",92],"[",["T_CONSTANT_ENCAPSED_STRING","'account'",92],"]",")",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n        ",92],["T_CONTINUE","continue",93],";",["T_WHITESPACE","\n      ",93],"}",["T_WHITESPACE","\n\n      ",94],["T_VARIABLE","$normalized_property",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","serializer",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","normalize",96],"(",["T_VARIABLE","$field",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$format",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$context",96],")",";",["T_WHITESPACE","\n      ",96],["T_VARIABLE","$normalized",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","NestedArray",97],["T_DOUBLE_COLON","::",97],["T_STRING","mergeDeep",97],"(",["T_VARIABLE","$normalized",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$normalized_property",97],")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$normalized",100],";",["T_WHITESPACE","\n  ",100],"}",["T_WHITESPACE","\n\n  ",101],["T_DOC_COMMENT","\/**\n   * Implements \\Symfony\\Component\\Serializer\\Normalizer\\DenormalizerInterface::denormalize().\n   *\n   * @param array $data\n   *   Entity data to restore.\n   * @param string $class\n   *   Unused, entity_create() is used to instantiate entity objects.\n   * @param string $format\n   *   Format the given data was extracted from.\n   * @param array $context\n   *   Options available to the denormalizer. Keys that can be used:\n   *   - request_method: if set to \"patch\" the denormalization will clear out\n   *     all default values for entity fields before applying $data to the\n   *     entity.\n   *\n   * @return \\Drupal\\Core\\Entity\\EntityInterface\n   *   An unserialized entity object containing the data in $data.\n   *\n   * @throws \\Symfony\\Component\\Serializer\\Exception\\UnexpectedValueException\n   *\/",103],["T_WHITESPACE","\n  ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","denormalize",123],"(",["T_VARIABLE","$data",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$class",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$format",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","NULL",123],",",["T_WHITESPACE"," ",123],["T_ARRAY","array",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$context",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_ARRAY","array",123],"(",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n    ",123],["T_COMMENT","\/\/ Get type, necessary for determining which bundle to create.\n",124],["T_WHITESPACE","    ",125],["T_IF","if",125],["T_WHITESPACE"," ",125],"(","!",["T_ISSET","isset",125],"(",["T_VARIABLE","$data",125],"[",["T_CONSTANT_ENCAPSED_STRING","'_links'",125],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type'",125],"]",")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n      ",125],["T_THROW","throw",126],["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_STRING","UnexpectedValueException",126],"(",["T_CONSTANT_ENCAPSED_STRING","'The type link relation must be specified.'",126],")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_COMMENT","\/\/ Create the entity.\n",129],["T_WHITESPACE","    ",130],["T_VARIABLE","$typed_data_ids",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getTypedDataIds",130],"(",["T_VARIABLE","$data",130],"[",["T_CONSTANT_ENCAPSED_STRING","'_links'",130],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type'",130],"]",",",["T_WHITESPACE"," ",130],["T_VARIABLE","$context",130],")",";",["T_WHITESPACE","\n    ",130],["T_VARIABLE","$entity_type",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","entityManager",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getDefinition",131],"(",["T_VARIABLE","$typed_data_ids",131],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",131],"]",")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$default_langcode_key",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$entity_type",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getKey",132],"(",["T_CONSTANT_ENCAPSED_STRING","'default_langcode'",132],")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$langcode_key",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$entity_type",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getKey",133],"(",["T_CONSTANT_ENCAPSED_STRING","'langcode'",133],")",";",["T_WHITESPACE","\n    ",133],["T_VARIABLE","$values",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_ARRAY","array",134],"(",")",";",["T_WHITESPACE","\n\n    ",134],["T_COMMENT","\/\/ Figure out the language to use.\n",136],["T_WHITESPACE","    ",137],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_ISSET","isset",137],"(",["T_VARIABLE","$data",137],"[",["T_VARIABLE","$default_langcode_key",137],"]",")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n      ",137],["T_COMMENT","\/\/ Find the field item for which the default_lancode value is set to 1 and\n",138],["T_WHITESPACE","      ",139],["T_COMMENT","\/\/ set the langcode the right default language.\n",139],["T_WHITESPACE","      ",140],["T_FOREACH","foreach",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$data",140],"[",["T_VARIABLE","$default_langcode_key",140],"]",["T_WHITESPACE"," ",140],["T_AS","as",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$item",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(","!",["T_EMPTY","empty",141],"(",["T_VARIABLE","$item",141],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",141],"]",")",["T_WHITESPACE"," ",141],["T_BOOLEAN_AND","&&",141],["T_WHITESPACE"," ",141],["T_ISSET","isset",141],"(",["T_VARIABLE","$item",141],"[",["T_CONSTANT_ENCAPSED_STRING","'lang'",141],"]",")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n          ",141],["T_VARIABLE","$values",142],"[",["T_VARIABLE","$langcode_key",142],"]",["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$item",142],"[",["T_CONSTANT_ENCAPSED_STRING","'lang'",142],"]",";",["T_WHITESPACE","\n          ",142],["T_BREAK","break",143],";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n      ",144],"}",["T_WHITESPACE","\n      ",145],["T_COMMENT","\/\/ Remove the default langcode so it does not get iterated over below.\n",146],["T_WHITESPACE","      ",147],["T_UNSET","unset",147],"(",["T_VARIABLE","$data",147],"[",["T_VARIABLE","$default_langcode_key",147],"]",")",";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$entity_type",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","hasKey",150],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle'",150],")",")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n      ",150],["T_VARIABLE","$bundle_key",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$entity_type",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getKey",151],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle'",151],")",";",["T_WHITESPACE","\n      ",151],["T_VARIABLE","$values",152],"[",["T_VARIABLE","$bundle_key",152],"]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$typed_data_ids",152],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle'",152],"]",";",["T_WHITESPACE","\n      ",152],["T_COMMENT","\/\/ Unset the bundle key from data, if it's there.\n",153],["T_WHITESPACE","      ",154],["T_UNSET","unset",154],"(",["T_VARIABLE","$data",154],"[",["T_VARIABLE","$bundle_key",154],"]",")",";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_VARIABLE","$entity",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","entityManager",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getStorage",157],"(",["T_VARIABLE","$typed_data_ids",157],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",157],"]",")",["T_OBJECT_OPERATOR","->",157],["T_STRING","create",157],"(",["T_VARIABLE","$values",157],")",";",["T_WHITESPACE","\n\n    ",157],["T_COMMENT","\/\/ Remove links from data array.\n",159],["T_WHITESPACE","    ",160],["T_UNSET","unset",160],"(",["T_VARIABLE","$data",160],"[",["T_CONSTANT_ENCAPSED_STRING","'_links'",160],"]",")",";",["T_WHITESPACE","\n    ",160],["T_COMMENT","\/\/ Get embedded resources and remove from data array.\n",161],["T_WHITESPACE","    ",162],["T_VARIABLE","$embedded",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_ARRAY","array",162],"(",")",";",["T_WHITESPACE","\n    ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_ISSET","isset",163],"(",["T_VARIABLE","$data",163],"[",["T_CONSTANT_ENCAPSED_STRING","'_embedded'",163],"]",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n      ",163],["T_VARIABLE","$embedded",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$data",164],"[",["T_CONSTANT_ENCAPSED_STRING","'_embedded'",164],"]",";",["T_WHITESPACE","\n      ",164],["T_UNSET","unset",165],"(",["T_VARIABLE","$data",165],"[",["T_CONSTANT_ENCAPSED_STRING","'_embedded'",165],"]",")",";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_COMMENT","\/\/ Flatten the embedded values.\n",168],["T_WHITESPACE","    ",169],["T_FOREACH","foreach",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$embedded",169],["T_WHITESPACE"," ",169],["T_AS","as",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$relation",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$field",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n      ",169],["T_VARIABLE","$field_ids",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","linkManager",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getRelationInternalIds",170],"(",["T_VARIABLE","$relation",170],")",";",["T_WHITESPACE","\n      ",170],["T_IF","if",171],["T_WHITESPACE"," ",171],"(","!",["T_EMPTY","empty",171],"(",["T_VARIABLE","$field_ids",171],")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$field_name",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$field_ids",172],"[",["T_CONSTANT_ENCAPSED_STRING","'field_name'",172],"]",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$data",173],"[",["T_VARIABLE","$field_name",173],"]",["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$field",173],";",["T_WHITESPACE","\n      ",173],"}",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_COMMENT","\/\/ Pass the names of the fields whose values can be merged.\n",177],["T_WHITESPACE","    ",178],["T_VARIABLE","$entity",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_restSubmittedFields",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","array_keys",178],"(",["T_VARIABLE","$data",178],")",";",["T_WHITESPACE","\n\n    ",178],["T_COMMENT","\/\/ Iterate through remaining items in data array. These should all\n",180],["T_WHITESPACE","    ",181],["T_COMMENT","\/\/ correspond to fields.\n",181],["T_WHITESPACE","    ",182],["T_FOREACH","foreach",182],["T_WHITESPACE"," ",182],"(",["T_VARIABLE","$data",182],["T_WHITESPACE"," ",182],["T_AS","as",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$field_name",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$field_data",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n      ",182],["T_VARIABLE","$items",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$entity",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","get",183],"(",["T_VARIABLE","$field_name",183],")",";",["T_WHITESPACE","\n      ",183],["T_COMMENT","\/\/ Remove any values that were set as a part of entity creation (e.g\n",184],["T_WHITESPACE","      ",185],["T_COMMENT","\/\/ uuid). If the incoming field data is set to an empty array, this will\n",185],["T_WHITESPACE","      ",186],["T_COMMENT","\/\/ also have the effect of emptying the field in REST module.\n",186],["T_WHITESPACE","      ",187],["T_VARIABLE","$items",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setValue",187],"(",["T_ARRAY","array",187],"(",")",")",";",["T_WHITESPACE","\n      ",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$field_data",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n        ",188],["T_COMMENT","\/\/ Denormalize the field data into the FieldItemList object.\n",189],["T_WHITESPACE","        ",190],["T_VARIABLE","$context",190],"[",["T_CONSTANT_ENCAPSED_STRING","'target_instance'",190],"]",["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$items",190],";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","serializer",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","denormalize",191],"(",["T_VARIABLE","$field_data",191],",",["T_WHITESPACE"," ",191],["T_STRING","get_class",191],"(",["T_VARIABLE","$items",191],")",",",["T_WHITESPACE"," ",191],["T_VARIABLE","$format",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$context",191],")",";",["T_WHITESPACE","\n      ",191],"}",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$entity",195],";",["T_WHITESPACE","\n  ",195],"}",["T_WHITESPACE","\n\n  ",196],["T_DOC_COMMENT","\/**\n   * Constructs the entity URI.\n   *\n   * @param \\Drupal\\Core\\Entity\\EntityInterface $entity\n   *   The entity.\n   * @return string\n   *   The entity URI.\n   *\/",198],["T_WHITESPACE","\n  ",205],["T_PROTECTED","protected",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","getEntityUri",206],"(",["T_STRING","EntityInterface",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$entity",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n    ",206],["T_COMMENT","\/\/ Some entity types don't provide a canonical link template, at least call\n",207],["T_WHITESPACE","    ",208],["T_COMMENT","\/\/ out to ->url().\n",208],["T_WHITESPACE","    ",209],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$entity",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","isNew",209],"(",")",["T_WHITESPACE"," ",209],["T_BOOLEAN_OR","||",209],["T_WHITESPACE"," ",209],"!",["T_VARIABLE","$entity",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","hasLinkTemplate",209],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",209],")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n      ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$entity",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","url",210],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",210],",",["T_WHITESPACE"," ",210],"[","]",")",";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n    ",211],["T_VARIABLE","$url",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$entity",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","urlInfo",212],"(",["T_CONSTANT_ENCAPSED_STRING","'canonical'",212],",",["T_WHITESPACE"," ",212],"[",["T_CONSTANT_ENCAPSED_STRING","'absolute'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_STRING","TRUE",212],"]",")",";",["T_WHITESPACE","\n    ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$url",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","setRouteParameter",213],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'hal_json'",213],")",["T_OBJECT_OPERATOR","->",213],["T_STRING","toString",213],"(",")",";",["T_WHITESPACE","\n  ",213],"}",["T_WHITESPACE","\n\n  ",214],["T_DOC_COMMENT","\/**\n   * Gets the typed data IDs for a type URI.\n   *\n   * @param array $types\n   *   The type array(s) (value of the 'type' attribute of the incoming data).\n   * @param array $context\n   *   Context from the normalizer\/serializer operation.\n   *\n   * @return array\n   *   The typed data IDs.\n   *\/",216],["T_WHITESPACE","\n  ",226],["T_PROTECTED","protected",227],["T_WHITESPACE"," ",227],["T_FUNCTION","function",227],["T_WHITESPACE"," ",227],["T_STRING","getTypedDataIds",227],"(",["T_VARIABLE","$types",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$context",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_ARRAY","array",227],"(",")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n    ",227],["T_COMMENT","\/\/ The 'type' can potentially contain an array of type objects. By default,\n",228],["T_WHITESPACE","    ",229],["T_COMMENT","\/\/ Drupal only uses a single type in serializing, but allows for multiple\n",229],["T_WHITESPACE","    ",230],["T_COMMENT","\/\/ types when deserializing.\n",230],["T_WHITESPACE","    ",231],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_ISSET","isset",231],"(",["T_VARIABLE","$types",231],"[",["T_CONSTANT_ENCAPSED_STRING","'href'",231],"]",")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n      ",231],["T_VARIABLE","$types",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_ARRAY","array",232],"(",["T_VARIABLE","$types",232],")",";",["T_WHITESPACE","\n    ",232],"}",["T_WHITESPACE","\n\n    ",233],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_EMPTY","empty",235],"(",["T_VARIABLE","$types",235],")",")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n      ",235],["T_THROW","throw",236],["T_WHITESPACE"," ",236],["T_NEW","new",236],["T_WHITESPACE"," ",236],["T_STRING","UnexpectedValueException",236],"(",["T_CONSTANT_ENCAPSED_STRING","'No entity type(s) specified'",236],")",";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_FOREACH","foreach",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$types",239],["T_WHITESPACE"," ",239],["T_AS","as",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$type",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n      ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_ISSET","isset",240],"(",["T_VARIABLE","$type",240],"[",["T_CONSTANT_ENCAPSED_STRING","'href'",240],"]",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n        ",240],["T_THROW","throw",241],["T_WHITESPACE"," ",241],["T_NEW","new",241],["T_WHITESPACE"," ",241],["T_STRING","UnexpectedValueException",241],"(",["T_CONSTANT_ENCAPSED_STRING","'Type must contain an \\'href\\' attribute.'",241],")",";",["T_WHITESPACE","\n      ",241],"}",["T_WHITESPACE","\n\n      ",242],["T_VARIABLE","$type_uri",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$type",244],"[",["T_CONSTANT_ENCAPSED_STRING","'href'",244],"]",";",["T_WHITESPACE","\n\n      ",244],["T_COMMENT","\/\/ Check whether the URI corresponds to a known type on this site. Break\n",246],["T_WHITESPACE","      ",247],["T_COMMENT","\/\/ once one does.\n",247],["T_WHITESPACE","      ",248],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$typed_data_ids",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","linkManager",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getTypeInternalIds",248],"(",["T_VARIABLE","$type",248],"[",["T_CONSTANT_ENCAPSED_STRING","'href'",248],"]",",",["T_WHITESPACE"," ",248],["T_VARIABLE","$context",248],")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n        ",248],["T_BREAK","break",249],";",["T_WHITESPACE","\n      ",249],"}",["T_WHITESPACE","\n    ",250],"}",["T_WHITESPACE","\n\n    ",251],["T_COMMENT","\/\/ If none of the URIs correspond to an entity type on this site, no entity\n",253],["T_WHITESPACE","    ",254],["T_COMMENT","\/\/ can be created. Throw an exception.\n",254],["T_WHITESPACE","    ",255],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_EMPTY","empty",255],"(",["T_VARIABLE","$typed_data_ids",255],")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n      ",255],["T_THROW","throw",256],["T_WHITESPACE"," ",256],["T_NEW","new",256],["T_WHITESPACE"," ",256],["T_STRING","UnexpectedValueException",256],"(",["T_STRING","sprintf",256],"(",["T_CONSTANT_ENCAPSED_STRING","'Type %s does not correspond to an entity on this site.'",256],",",["T_WHITESPACE"," ",256],["T_VARIABLE","$type_uri",256],")",")",";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$typed_data_ids",259],";",["T_WHITESPACE","\n  ",259],"}",["T_WHITESPACE","\n\n",260],"}",["T_WHITESPACE","\n",262]]