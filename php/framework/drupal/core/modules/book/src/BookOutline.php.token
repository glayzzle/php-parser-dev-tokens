[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","book",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * Provides handling to render the book outline.\n *\/",5],["T_WHITESPACE","\n",7],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","BookOutline",8],["T_WHITESPACE"," ",8],"{",["T_WHITESPACE","\n\n  ",8],["T_DOC_COMMENT","\/**\n   * The book manager.\n   *\n   * @var \\Drupal\\book\\BookManagerInterface\n   *\/",10],["T_WHITESPACE","\n  ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$bookManager",15],";",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * Constructs a new BookOutline.\n   *\n   * @param \\Drupal\\book\\BookManagerInterface $book_manager\n   *   The book manager.\n   *\/",17],["T_WHITESPACE","\n  ",22],["T_PUBLIC","public",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","__construct",23],"(",["T_STRING","BookManagerInterface",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$book_manager",23],")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n    ",23],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","bookManager",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_VARIABLE","$book_manager",24],";",["T_WHITESPACE","\n  ",24],"}",["T_WHITESPACE","\n\n  ",25],["T_DOC_COMMENT","\/**\n   * Fetches the book link for the previous page of the book.\n   *\n   * @param array $book_link\n   *   A fully loaded book link that is part of the book hierarchy.\n   *\n   * @return array\n   *   A fully loaded book link for the page before the one represented in\n   *   $book_link.\n   *\/",27],["T_WHITESPACE","\n  ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","prevLink",37],"(",["T_ARRAY","array",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$book_link",37],")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n    ",37],["T_COMMENT","\/\/ If the parent is zero, we are at the start of a book.\n",38],["T_WHITESPACE","    ",39],["T_IF","if",39],["T_WHITESPACE"," ",39],"(",["T_VARIABLE","$book_link",39],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",39],"]",["T_WHITESPACE"," ",39],["T_IS_EQUAL","==",39],["T_WHITESPACE"," ",39],["T_LNUMBER","0",39],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n      ",39],["T_RETURN","return",40],["T_WHITESPACE"," ",40],["T_STRING","NULL",40],";",["T_WHITESPACE","\n    ",40],"}",["T_WHITESPACE","\n    ",41],["T_COMMENT","\/\/ Assigning the array to $flat resets the array pointer for use with each().\n",42],["T_WHITESPACE","    ",43],["T_VARIABLE","$flat",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","bookManager",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","bookTreeGetFlat",43],"(",["T_VARIABLE","$book_link",43],")",";",["T_WHITESPACE","\n    ",43],["T_VARIABLE","$curr",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","NULL",44],";",["T_WHITESPACE","\n    ",44],["T_DO","do",45],["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n      ",45],["T_VARIABLE","$prev",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$curr",46],";",["T_WHITESPACE","\n      ",46],["T_LIST","list",47],"(",["T_VARIABLE","$key",47],",",["T_WHITESPACE"," ",47],["T_VARIABLE","$curr",47],")",["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","each",47],"(",["T_VARIABLE","$flat",47],")",";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE"," ",48],["T_WHILE","while",48],["T_WHITESPACE"," ",48],"(",["T_VARIABLE","$key",48],["T_WHITESPACE"," ",48],["T_BOOLEAN_AND","&&",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$key",48],["T_WHITESPACE"," ",48],["T_IS_NOT_EQUAL","!=",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$book_link",48],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",48],"]",")",";",["T_WHITESPACE","\n\n    ",48],["T_IF","if",50],["T_WHITESPACE"," ",50],"(",["T_VARIABLE","$key",50],["T_WHITESPACE"," ",50],["T_IS_EQUAL","==",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$book_link",50],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",50],"]",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n      ",50],["T_COMMENT","\/\/ The previous page in the book may be a child of the previous visible link.\n",51],["T_WHITESPACE","      ",52],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$prev",52],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",52],"]",["T_WHITESPACE"," ",52],["T_IS_EQUAL","==",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$book_link",52],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",52],"]",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n        ",52],["T_COMMENT","\/\/ The subtree will have only one link at the top level - get its data.\n",53],["T_WHITESPACE","        ",54],["T_VARIABLE","$tree",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","bookManager",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","bookSubtreeData",54],"(",["T_VARIABLE","$prev",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$data",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","array_shift",55],"(",["T_VARIABLE","$tree",55],")",";",["T_WHITESPACE","\n        ",55],["T_COMMENT","\/\/ The link of interest is the last child - iterate to find the deepest one.\n",56],["T_WHITESPACE","        ",57],["T_WHILE","while",57],["T_WHITESPACE"," ",57],"(",["T_VARIABLE","$data",57],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",57],"]",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n          ",57],["T_VARIABLE","$data",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","end",58],"(",["T_VARIABLE","$data",58],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",58],"]",")",";",["T_WHITESPACE","\n        ",58],"}",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","bookManager",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","bookLinkTranslate",60],"(",["T_VARIABLE","$data",60],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",60],"]",")",";",["T_WHITESPACE","\n        ",60],["T_RETURN","return",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$data",61],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",61],"]",";",["T_WHITESPACE","\n      ",61],"}",["T_WHITESPACE","\n      ",62],["T_ELSE","else",63],["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","bookManager",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","bookLinkTranslate",64],"(",["T_VARIABLE","$prev",64],")",";",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$prev",65],";",["T_WHITESPACE","\n      ",65],"}",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n  ",67],"}",["T_WHITESPACE","\n\n  ",68],["T_DOC_COMMENT","\/**\n   * Fetches the book link for the next page of the book.\n   *\n   * @param array $book_link\n   *   A fully loaded book link that is part of the book hierarchy.\n   *\n   * @return array\n   *   A fully loaded book link for the page after the one represented in\n   *   $book_link.\n   *\/",70],["T_WHITESPACE","\n  ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","nextLink",80],"(",["T_ARRAY","array",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$book_link",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n    ",80],["T_COMMENT","\/\/ Assigning the array to $flat resets the array pointer for use with each().\n",81],["T_WHITESPACE","    ",82],["T_VARIABLE","$flat",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","bookManager",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","bookTreeGetFlat",82],"(",["T_VARIABLE","$book_link",82],")",";",["T_WHITESPACE","\n    ",82],["T_DO","do",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n      ",83],["T_LIST","list",84],"(",["T_VARIABLE","$key",84],",",")",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","each",84],"(",["T_VARIABLE","$flat",84],")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE"," ",85],["T_WHILE","while",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$key",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$key",85],["T_WHITESPACE"," ",85],["T_IS_NOT_EQUAL","!=",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$book_link",85],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",85],"]",")",";",["T_WHITESPACE","\n\n    ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$key",87],["T_WHITESPACE"," ",87],["T_IS_EQUAL","==",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$book_link",87],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",87],"]",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_VARIABLE","$next",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","current",88],"(",["T_VARIABLE","$flat",88],")",";",["T_WHITESPACE","\n      ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$next",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","bookManager",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","bookLinkTranslate",90],"(",["T_VARIABLE","$next",90],")",";",["T_WHITESPACE","\n      ",90],"}",["T_WHITESPACE","\n      ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$next",92],";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n  ",93],"}",["T_WHITESPACE","\n\n  ",94],["T_DOC_COMMENT","\/**\n   * Formats the book links for the child pages of the current page.\n   *\n   * @param array $book_link\n   *   A fully loaded book link that is part of the book hierarchy.\n   *\n   * @return array\n   *   HTML for the links to the child pages of the current page.\n   *\/",96],["T_WHITESPACE","\n  ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","childrenLinks",105],"(",["T_ARRAY","array",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$book_link",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$flat",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","bookManager",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","bookTreeGetFlat",106],"(",["T_VARIABLE","$book_link",106],")",";",["T_WHITESPACE","\n\n    ",106],["T_VARIABLE","$children",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_ARRAY","array",108],"(",")",";",["T_WHITESPACE","\n\n    ",108],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_VARIABLE","$book_link",110],"[",["T_CONSTANT_ENCAPSED_STRING","'has_children'",110],"]",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n      ",110],["T_COMMENT","\/\/ Walk through the array until we find the current page.\n",111],["T_WHITESPACE","      ",112],["T_DO","do",112],["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$link",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","array_shift",113],"(",["T_VARIABLE","$flat",113],")",";",["T_WHITESPACE","\n      ",113],"}",["T_WHITESPACE"," ",114],["T_WHILE","while",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$link",114],["T_WHITESPACE"," ",114],["T_BOOLEAN_AND","&&",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$link",114],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",114],"]",["T_WHITESPACE"," ",114],["T_IS_NOT_EQUAL","!=",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$book_link",114],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",114],"]",")",")",";",["T_WHITESPACE","\n      ",114],["T_COMMENT","\/\/ Continue though the array and collect the links whose parent is this page.\n",115],["T_WHITESPACE","      ",116],["T_WHILE","while",116],["T_WHITESPACE"," ",116],"(","(",["T_VARIABLE","$link",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","array_shift",116],"(",["T_VARIABLE","$flat",116],")",")",["T_WHITESPACE"," ",116],["T_BOOLEAN_AND","&&",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$link",116],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",116],"]",["T_WHITESPACE"," ",116],["T_IS_EQUAL","==",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$book_link",116],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",116],"]",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$data",117],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",117],"]",["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$link",117],";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$data",118],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",118],"]",["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","''",118],";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$children",119],"[","]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$data",119],";",["T_WHITESPACE","\n      ",119],"}",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$children",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n      ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","bookManager",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","bookTreeOutput",124],"(",["T_VARIABLE","$children",124],")",";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n    ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","''",126],";",["T_WHITESPACE","\n  ",126],"}",["T_WHITESPACE","\n\n",127],"}",["T_WHITESPACE","\n",129]]