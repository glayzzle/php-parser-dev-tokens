[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","book",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Database",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Connection",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Defines a storage class for books outline.\n *\/",7],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","BookOutlineStorage",10],["T_WHITESPACE"," ",10],["T_IMPLEMENTS","implements",10],["T_WHITESPACE"," ",10],["T_STRING","BookOutlineStorageInterface",10],["T_WHITESPACE"," ",10],"{",["T_WHITESPACE","\n\n  ",10],["T_DOC_COMMENT","\/**\n   * Database Service Object.\n   *\n   * @var \\Drupal\\Core\\Database\\Connection\n   *\/",12],["T_WHITESPACE","\n  ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$connection",17],";",["T_WHITESPACE","\n\n  ",17],["T_DOC_COMMENT","\/**\n   * Constructs a BookOutlineStorage object.\n   *\/",19],["T_WHITESPACE","\n  ",21],["T_PUBLIC","public",22],["T_WHITESPACE"," ",22],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","__construct",22],"(",["T_STRING","Connection",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$connection",22],")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n    ",22],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","connection",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_VARIABLE","$connection",23],";",["T_WHITESPACE","\n  ",23],"}",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",26],["T_WHITESPACE","\n  ",28],["T_PUBLIC","public",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","getBooks",29],"(",")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n    ",29],["T_RETURN","return",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","connection",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","query",30],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT DISTINCT(bid) FROM {book}\"",30],")",["T_OBJECT_OPERATOR","->",30],["T_STRING","fetchCol",30],"(",")",";",["T_WHITESPACE","\n  ",30],"}",["T_WHITESPACE","\n\n  ",31],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",33],["T_WHITESPACE","\n  ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","hasBooks",36],"(",")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n    ",36],["T_RETURN","return",37],["T_WHITESPACE"," ",37],["T_BOOL_CAST","(bool)",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","connection",37],["T_WHITESPACE","\n      ",37],["T_OBJECT_OPERATOR","->",38],["T_STRING","query",38],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT count(bid) FROM {book}'",38],")",["T_WHITESPACE","\n      ",38],["T_OBJECT_OPERATOR","->",39],["T_STRING","fetchField",39],"(",")",";",["T_WHITESPACE","\n  ",39],"}",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",42],["T_WHITESPACE","\n  ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","loadMultiple",45],"(",["T_VARIABLE","$nids",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$access",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","TRUE",45],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$query",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","connection",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","select",46],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'b'",46],",",["T_WHITESPACE"," ",46],["T_ARRAY","array",46],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch'",46],["T_WHITESPACE"," ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_NS_SEPARATOR","\\",46],["T_STRING","PDO",46],["T_DOUBLE_COLON","::",46],["T_STRING","FETCH_ASSOC",46],")",")",";",["T_WHITESPACE","\n    ",46],["T_VARIABLE","$query",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","fields",47],"(",["T_CONSTANT_ENCAPSED_STRING","'b'",47],")",";",["T_WHITESPACE","\n    ",47],["T_VARIABLE","$query",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","condition",48],"(",["T_CONSTANT_ENCAPSED_STRING","'b.nid'",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$nids",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'IN'",48],")",";",["T_WHITESPACE","\n\n    ",48],["T_IF","if",50],["T_WHITESPACE"," ",50],"(",["T_VARIABLE","$access",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n      ",50],["T_VARIABLE","$query",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","addTag",51],"(",["T_CONSTANT_ENCAPSED_STRING","'node_access'",51],")",";",["T_WHITESPACE","\n      ",51],["T_VARIABLE","$query",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","addMetaData",52],"(",["T_CONSTANT_ENCAPSED_STRING","'base_table'",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'book'",52],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$query",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","execute",55],"(",")",";",["T_WHITESPACE","\n  ",55],"}",["T_WHITESPACE","\n\n  ",56],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",58],["T_WHITESPACE","\n  ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","getChildRelativeDepth",61],"(",["T_VARIABLE","$book_link",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$max_depth",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$query",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","connection",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","select",62],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",62],")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$query",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","addField",63],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'depth'",63],")",";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$query",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","condition",64],"(",["T_CONSTANT_ENCAPSED_STRING","'bid'",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$book_link",64],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",64],"]",")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$query",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","orderBy",65],"(",["T_CONSTANT_ENCAPSED_STRING","'depth'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'DESC'",65],")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$query",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","range",66],"(",["T_LNUMBER","0",66],",",["T_WHITESPACE"," ",66],["T_LNUMBER","1",66],")",";",["T_WHITESPACE","\n\n    ",66],["T_VARIABLE","$i",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_LNUMBER","1",68],";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$p",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'p1'",69],";",["T_WHITESPACE","\n    ",69],["T_WHILE","while",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$i",70],["T_WHITESPACE"," ",70],["T_IS_SMALLER_OR_EQUAL","<=",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$max_depth",70],["T_WHITESPACE"," ",70],["T_BOOLEAN_AND","&&",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$book_link",70],"[",["T_VARIABLE","$p",70],"]",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n      ",70],["T_VARIABLE","$query",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","condition",71],"(",["T_VARIABLE","$p",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$book_link",71],"[",["T_VARIABLE","$p",71],"]",")",";",["T_WHITESPACE","\n      ",71],["T_VARIABLE","$p",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'p'",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_INC","++",72],["T_VARIABLE","$i",72],";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$query",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","execute",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","fetchField",75],"(",")",";",["T_WHITESPACE","\n  ",75],"}",["T_WHITESPACE","\n\n  ",76],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",78],["T_WHITESPACE","\n  ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","delete",81],"(",["T_VARIABLE","$nid",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n    ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","connection",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","delete",82],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",82],")",["T_WHITESPACE","\n      ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","condition",83],"(",["T_CONSTANT_ENCAPSED_STRING","'nid'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$nid",83],")",["T_WHITESPACE","\n      ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","execute",84],"(",")",";",["T_WHITESPACE","\n  ",84],"}",["T_WHITESPACE","\n\n  ",85],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",87],["T_WHITESPACE","\n  ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","loadBookChildren",90],"(",["T_VARIABLE","$pid",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n    ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","connection",91],["T_WHITESPACE","\n      ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","query",92],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT * FROM {book} WHERE pid = :pid\"",92],",",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",["T_CONSTANT_ENCAPSED_STRING","':pid'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$pid",92],")",")",["T_WHITESPACE","\n      ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","fetchAllAssoc",93],"(",["T_CONSTANT_ENCAPSED_STRING","'nid'",93],",",["T_WHITESPACE"," ",93],["T_NS_SEPARATOR","\\",93],["T_STRING","PDO",93],["T_DOUBLE_COLON","::",93],["T_STRING","FETCH_ASSOC",93],")",";",["T_WHITESPACE","\n  ",93],"}",["T_WHITESPACE","\n\n  ",94],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",96],["T_WHITESPACE","\n  ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","getBookMenuTree",99],"(",["T_VARIABLE","$bid",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$parameters",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$min_depth",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$max_depth",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n    ",99],["T_VARIABLE","$query",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","connection",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","select",100],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",100],")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$query",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","fields",101],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",101],")",";",["T_WHITESPACE","\n    ",101],["T_FOR","for",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$i",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_LNUMBER","1",102],";",["T_WHITESPACE"," ",102],["T_VARIABLE","$i",102],["T_WHITESPACE"," ",102],["T_IS_SMALLER_OR_EQUAL","<=",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$max_depth",102],";",["T_WHITESPACE"," ",102],["T_VARIABLE","$i",102],["T_INC","++",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n      ",102],["T_VARIABLE","$query",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","orderBy",103],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$i",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'ASC'",103],")",";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$query",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","condition",105],"(",["T_CONSTANT_ENCAPSED_STRING","'bid'",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$bid",105],")",";",["T_WHITESPACE","\n    ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(","!",["T_EMPTY","empty",106],"(",["T_VARIABLE","$parameters",106],"[",["T_CONSTANT_ENCAPSED_STRING","'expanded'",106],"]",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n      ",106],["T_VARIABLE","$query",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","condition",107],"(",["T_CONSTANT_ENCAPSED_STRING","'pid'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$parameters",107],"[",["T_CONSTANT_ENCAPSED_STRING","'expanded'",107],"]",",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'IN'",107],")",";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n    ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$min_depth",109],["T_WHITESPACE"," ",109],["T_IS_NOT_EQUAL","!=",109],["T_WHITESPACE"," ",109],["T_LNUMBER","1",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n      ",109],["T_VARIABLE","$query",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","condition",110],"(",["T_CONSTANT_ENCAPSED_STRING","'depth'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$min_depth",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'>='",110],")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n    ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_ISSET","isset",112],"(",["T_VARIABLE","$parameters",112],"[",["T_CONSTANT_ENCAPSED_STRING","'max_depth'",112],"]",")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n      ",112],["T_VARIABLE","$query",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","condition",113],"(",["T_CONSTANT_ENCAPSED_STRING","'depth'",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$parameters",113],"[",["T_CONSTANT_ENCAPSED_STRING","'max_depth'",113],"]",",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'<='",113],")",";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n    ",114],["T_COMMENT","\/\/ Add custom query conditions, if any were passed.\n",115],["T_WHITESPACE","    ",116],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_ISSET","isset",116],"(",["T_VARIABLE","$parameters",116],"[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",116],"]",")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n      ",116],["T_FOREACH","foreach",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$parameters",117],"[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",117],"]",["T_WHITESPACE"," ",117],["T_AS","as",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$column",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$value",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$query",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","condition",118],"(",["T_VARIABLE","$column",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$value",118],")",";",["T_WHITESPACE","\n      ",118],"}",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$query",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","execute",122],"(",")",";",["T_WHITESPACE","\n  ",122],"}",["T_WHITESPACE","\n\n  ",123],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",125],["T_WHITESPACE","\n  ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","insert",128],"(",["T_VARIABLE","$link",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$parents",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n    ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","connection",129],["T_WHITESPACE","\n      ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","insert",130],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",130],")",["T_WHITESPACE","\n      ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","fields",131],"(",["T_ARRAY","array",131],"(",["T_WHITESPACE","\n        ",131],["T_CONSTANT_ENCAPSED_STRING","'nid'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$link",132],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",132],"]",",",["T_WHITESPACE","\n        ",132],["T_CONSTANT_ENCAPSED_STRING","'bid'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$link",133],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",133],"]",",",["T_WHITESPACE","\n        ",133],["T_CONSTANT_ENCAPSED_STRING","'pid'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$link",134],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",134],"]",",",["T_WHITESPACE","\n        ",134],["T_CONSTANT_ENCAPSED_STRING","'weight'",135],["T_WHITESPACE"," ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$link",135],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",135],"]",",",["T_WHITESPACE","\n        ",135],")",["T_WHITESPACE"," ",136],"+",["T_WHITESPACE"," ",136],["T_VARIABLE","$parents",136],["T_WHITESPACE","\n      ",136],")",["T_WHITESPACE","\n      ",137],["T_OBJECT_OPERATOR","->",138],["T_STRING","execute",138],"(",")",";",["T_WHITESPACE","\n  ",138],"}",["T_WHITESPACE","\n\n  ",139],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",141],["T_WHITESPACE","\n  ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","update",144],"(",["T_VARIABLE","$nid",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$fields",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n    ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","connection",145],["T_WHITESPACE","\n      ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","update",146],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",146],")",["T_WHITESPACE","\n      ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","fields",147],"(",["T_VARIABLE","$fields",147],")",["T_WHITESPACE","\n      ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","condition",148],"(",["T_CONSTANT_ENCAPSED_STRING","'nid'",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$nid",148],")",["T_WHITESPACE","\n      ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","execute",149],"(",")",";",["T_WHITESPACE","\n  ",149],"}",["T_WHITESPACE","\n\n  ",150],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",152],["T_WHITESPACE","\n  ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","updateMovedChildren",155],"(",["T_VARIABLE","$bid",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$original",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$expressions",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$shift",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$query",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","connection",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","update",156],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",156],")",";",["T_WHITESPACE","\n    ",156],["T_VARIABLE","$query",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","fields",157],"(",["T_ARRAY","array",157],"(",["T_CONSTANT_ENCAPSED_STRING","'bid'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$bid",157],")",")",";",["T_WHITESPACE","\n\n    ",157],["T_FOREACH","foreach",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$expressions",159],["T_WHITESPACE"," ",159],["T_AS","as",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$expression",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n      ",159],["T_VARIABLE","$query",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","expression",160],"(",["T_VARIABLE","$expression",160],"[",["T_LNUMBER","0",160],"]",",",["T_WHITESPACE"," ",160],["T_VARIABLE","$expression",160],"[",["T_LNUMBER","1",160],"]",",",["T_WHITESPACE"," ",160],["T_VARIABLE","$expression",160],"[",["T_LNUMBER","2",160],"]",")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n\n    ",161],["T_VARIABLE","$query",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","expression",163],"(",["T_CONSTANT_ENCAPSED_STRING","'depth'",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'depth + :depth'",163],",",["T_WHITESPACE"," ",163],["T_ARRAY","array",163],"(",["T_CONSTANT_ENCAPSED_STRING","':depth'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$shift",163],")",")",";",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$query",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","condition",164],"(",["T_CONSTANT_ENCAPSED_STRING","'bid'",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$original",164],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",164],"]",")",";",["T_WHITESPACE","\n    ",164],["T_VARIABLE","$p",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'p1'",165],";",["T_WHITESPACE","\n    ",165],["T_FOR","for",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$i",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_LNUMBER","1",166],";",["T_WHITESPACE"," ",166],"!",["T_EMPTY","empty",166],"(",["T_VARIABLE","$original",166],"[",["T_VARIABLE","$p",166],"]",")",";",["T_WHITESPACE"," ",166],["T_VARIABLE","$p",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'p'",166],["T_WHITESPACE"," ",166],".",["T_WHITESPACE"," ",166],["T_INC","++",166],["T_VARIABLE","$i",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n      ",166],["T_VARIABLE","$query",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","condition",167],"(",["T_VARIABLE","$p",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$original",167],"[",["T_VARIABLE","$p",167],"]",")",";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$query",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","execute",170],"(",")",";",["T_WHITESPACE","\n  ",170],"}",["T_WHITESPACE","\n\n  ",171],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",173],["T_WHITESPACE","\n  ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","countOriginalLinkChildren",176],"(",["T_VARIABLE","$original",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n    ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","connection",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","select",177],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",177],",",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'b'",177],")",["T_WHITESPACE","\n      ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","condition",178],"(",["T_CONSTANT_ENCAPSED_STRING","'bid'",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$original",178],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",178],"]",")",["T_WHITESPACE","\n      ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","condition",179],"(",["T_CONSTANT_ENCAPSED_STRING","'pid'",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$original",179],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",179],"]",")",["T_WHITESPACE","\n      ",179],["T_OBJECT_OPERATOR","->",180],["T_STRING","condition",180],"(",["T_CONSTANT_ENCAPSED_STRING","'nid'",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$original",180],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",180],"]",",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'<>'",180],")",["T_WHITESPACE","\n      ",180],["T_OBJECT_OPERATOR","->",181],["T_STRING","countQuery",181],"(",")",["T_WHITESPACE","\n      ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","execute",182],"(",")",["T_OBJECT_OPERATOR","->",182],["T_STRING","fetchField",182],"(",")",";",["T_WHITESPACE","\n  ",182],"}",["T_WHITESPACE","\n\n  ",183],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",185],["T_WHITESPACE","\n  ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","getBookSubtree",188],"(",["T_VARIABLE","$link",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$max_depth",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n    ",188],["T_VARIABLE","$query",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","db_select",189],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",189],",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'b'",189],",",["T_WHITESPACE"," ",189],["T_ARRAY","array",189],"(",["T_CONSTANT_ENCAPSED_STRING","'fetch'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_NS_SEPARATOR","\\",189],["T_STRING","PDO",189],["T_DOUBLE_COLON","::",189],["T_STRING","FETCH_ASSOC",189],")",")",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$query",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","fields",190],"(",["T_CONSTANT_ENCAPSED_STRING","'b'",190],")",";",["T_WHITESPACE","\n    ",190],["T_VARIABLE","$query",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","condition",191],"(",["T_CONSTANT_ENCAPSED_STRING","'b.bid'",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$link",191],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",191],"]",")",";",["T_WHITESPACE","\n\n    ",191],["T_FOR","for",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$i",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_LNUMBER","1",193],";",["T_WHITESPACE"," ",193],["T_VARIABLE","$i",193],["T_WHITESPACE"," ",193],["T_IS_SMALLER_OR_EQUAL","<=",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$max_depth",193],["T_WHITESPACE"," ",193],["T_BOOLEAN_AND","&&",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$link",193],"[","\"",["T_ENCAPSED_AND_WHITESPACE","p",193],["T_VARIABLE","$i",193],"\"","]",";",["T_WHITESPACE"," ",193],["T_INC","++",193],["T_VARIABLE","$i",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n      ",193],["T_VARIABLE","$query",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","condition",194],"(","\"",["T_ENCAPSED_AND_WHITESPACE","p",194],["T_VARIABLE","$i",194],"\"",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$link",194],"[","\"",["T_ENCAPSED_AND_WHITESPACE","p",194],["T_VARIABLE","$i",194],"\"","]",")",";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n    ",195],["T_FOR","for",196],["T_WHITESPACE"," ",196],"(",["T_VARIABLE","$i",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_LNUMBER","1",196],";",["T_WHITESPACE"," ",196],["T_VARIABLE","$i",196],["T_WHITESPACE"," ",196],["T_IS_SMALLER_OR_EQUAL","<=",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$max_depth",196],";",["T_WHITESPACE"," ",196],["T_INC","++",196],["T_VARIABLE","$i",196],")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n      ",196],["T_VARIABLE","$query",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","orderBy",197],"(","\"",["T_ENCAPSED_AND_WHITESPACE","p",197],["T_VARIABLE","$i",197],"\"",")",";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n    ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$query",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","execute",199],"(",")",";",["T_WHITESPACE","\n  ",199],"}",["T_WHITESPACE","\n\n",200],"}",["T_WHITESPACE","\n",202]]