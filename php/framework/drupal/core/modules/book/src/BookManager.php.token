[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","book",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Utility",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Unicode",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Cache",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityManagerInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Form",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FormStateInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Render",9],["T_NS_SEPARATOR","\\",9],["T_STRING","RendererInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Core",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Session",10],["T_NS_SEPARATOR","\\",10],["T_STRING","AccountInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Core",11],["T_NS_SEPARATOR","\\",11],["T_STRING","StringTranslation",11],["T_NS_SEPARATOR","\\",11],["T_STRING","TranslationInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","StringTranslation",12],["T_NS_SEPARATOR","\\",12],["T_STRING","StringTranslationTrait",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Drupal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Core",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Config",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ConfigFactoryInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Drupal",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Template",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Attribute",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Drupal",15],["T_NS_SEPARATOR","\\",15],["T_STRING","node",15],["T_NS_SEPARATOR","\\",15],["T_STRING","NodeInterface",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Defines a book manager.\n *\/",17],["T_WHITESPACE","\n",19],["T_CLASS","class",20],["T_WHITESPACE"," ",20],["T_STRING","BookManager",20],["T_WHITESPACE"," ",20],["T_IMPLEMENTS","implements",20],["T_WHITESPACE"," ",20],["T_STRING","BookManagerInterface",20],["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n  ",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","StringTranslationTrait",21],";",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * Defines the maximum supported depth of the book tree.\n   *\/",23],["T_WHITESPACE","\n  ",25],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","BOOK_MAX_DEPTH",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_LNUMBER","9",26],";",["T_WHITESPACE","\n\n  ",26],["T_DOC_COMMENT","\/**\n   * Entity manager Service Object.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityManagerInterface\n   *\/",28],["T_WHITESPACE","\n  ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$entityManager",33],";",["T_WHITESPACE","\n\n  ",33],["T_DOC_COMMENT","\/**\n   * Config Factory Service Object.\n   *\n   * @var \\Drupal\\Core\\Config\\ConfigFactoryInterface\n   *\/",35],["T_WHITESPACE","\n  ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$configFactory",40],";",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * Books Array.\n   *\n   * @var array\n   *\/",42],["T_WHITESPACE","\n  ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$books",47],";",["T_WHITESPACE","\n\n  ",47],["T_DOC_COMMENT","\/**\n   * Book outline storage.\n   *\n   * @var \\Drupal\\book\\BookOutlineStorageInterface\n   *\/",49],["T_WHITESPACE","\n  ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$bookOutlineStorage",54],";",["T_WHITESPACE","\n\n  ",54],["T_DOC_COMMENT","\/**\n   * Stores flattened book trees.\n   *\n   * @var array\n   *\/",56],["T_WHITESPACE","\n  ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$bookTreeFlattened",61],";",["T_WHITESPACE","\n\n  ",61],["T_DOC_COMMENT","\/**\n   * The renderer.\n   *\n   * @var \\Drupal\\Core\\Render\\RendererInterface\n   *\/",63],["T_WHITESPACE","\n  ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$renderer",68],";",["T_WHITESPACE","\n\n  ",68],["T_DOC_COMMENT","\/**\n   * Constructs a BookManager object.\n   *\/",70],["T_WHITESPACE","\n  ",72],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","__construct",73],"(",["T_STRING","EntityManagerInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$entity_manager",73],",",["T_WHITESPACE"," ",73],["T_STRING","TranslationInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$translation",73],",",["T_WHITESPACE"," ",73],["T_STRING","ConfigFactoryInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$config_factory",73],",",["T_WHITESPACE"," ",73],["T_STRING","BookOutlineStorageInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$book_outline_storage",73],",",["T_WHITESPACE"," ",73],["T_STRING","RendererInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$renderer",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n    ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","entityManager",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$entity_manager",74],";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","stringTranslation",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$translation",75],";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","configFactory",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$config_factory",76],";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","bookOutlineStorage",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$book_outline_storage",77],";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","renderer",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$renderer",78],";",["T_WHITESPACE","\n  ",78],"}",["T_WHITESPACE","\n\n  ",79],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",81],["T_WHITESPACE","\n  ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","getAllBooks",84],"(",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n    ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_ISSET","isset",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","books",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n      ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","loadBooks",86],"(",")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n    ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","books",88],";",["T_WHITESPACE","\n  ",88],"}",["T_WHITESPACE","\n\n  ",89],["T_DOC_COMMENT","\/**\n   * Loads Books Array.\n   *\/",91],["T_WHITESPACE","\n  ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","loadBooks",94],"(",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","books",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_ARRAY","array",95],"(",")",";",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$nids",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","bookOutlineStorage",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getBooks",96],"(",")",";",["T_WHITESPACE","\n\n    ",96],["T_IF","if",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$nids",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n      ",98],["T_VARIABLE","$book_links",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","bookOutlineStorage",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","loadMultiple",99],"(",["T_VARIABLE","$nids",99],")",";",["T_WHITESPACE","\n      ",99],["T_VARIABLE","$nodes",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","entityManager",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getStorage",100],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",100],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","loadMultiple",100],"(",["T_VARIABLE","$nids",100],")",";",["T_WHITESPACE","\n      ",100],["T_COMMENT","\/\/ @todo: Sort by weight and translated title.\n",101],["T_WHITESPACE","\n      ",102],["T_COMMENT","\/\/ @todo: use route name for links, not system path.\n",103],["T_WHITESPACE","      ",104],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$book_links",104],["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$link",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$nid",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$link",105],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",105],"]",";",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_ISSET","isset",106],"(",["T_VARIABLE","$nodes",106],"[",["T_VARIABLE","$nid",106],"]",")",["T_WHITESPACE"," ",106],["T_BOOLEAN_AND","&&",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$nodes",106],"[",["T_VARIABLE","$nid",106],"]",["T_OBJECT_OPERATOR","->",106],["T_STRING","status",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n          ",106],["T_VARIABLE","$link",107],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",107],"]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$nodes",107],"[",["T_VARIABLE","$nid",107],"]",["T_OBJECT_OPERATOR","->",107],["T_STRING","urlInfo",107],"(",")",";",["T_WHITESPACE","\n          ",107],["T_VARIABLE","$link",108],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",108],"]",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$nodes",108],"[",["T_VARIABLE","$nid",108],"]",["T_OBJECT_OPERATOR","->",108],["T_STRING","label",108],"(",")",";",["T_WHITESPACE","\n          ",108],["T_VARIABLE","$link",109],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",109],"]",["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$nodes",109],"[",["T_VARIABLE","$nid",109],"]",["T_OBJECT_OPERATOR","->",109],["T_STRING","bundle",109],"(",")",";",["T_WHITESPACE","\n          ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","books",110],"[",["T_VARIABLE","$link",110],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",110],"]","]",["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$link",110],";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n      ",111],"}",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n  ",113],"}",["T_WHITESPACE","\n\n  ",114],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",116],["T_WHITESPACE","\n  ",118],["T_PUBLIC","public",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","getLinkDefaults",119],"(",["T_VARIABLE","$nid",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n    ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_ARRAY","array",120],"(",["T_WHITESPACE","\n      ",120],["T_CONSTANT_ENCAPSED_STRING","'original_bid'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_LNUMBER","0",121],",",["T_WHITESPACE","\n      ",121],["T_CONSTANT_ENCAPSED_STRING","'nid'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$nid",122],",",["T_WHITESPACE","\n      ",122],["T_CONSTANT_ENCAPSED_STRING","'bid'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_LNUMBER","0",123],",",["T_WHITESPACE","\n      ",123],["T_CONSTANT_ENCAPSED_STRING","'pid'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_LNUMBER","0",124],",",["T_WHITESPACE","\n      ",124],["T_CONSTANT_ENCAPSED_STRING","'has_children'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_LNUMBER","0",125],",",["T_WHITESPACE","\n      ",125],["T_CONSTANT_ENCAPSED_STRING","'weight'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_LNUMBER","0",126],",",["T_WHITESPACE","\n      ",126],["T_CONSTANT_ENCAPSED_STRING","'options'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",")",",",["T_WHITESPACE","\n    ",127],")",";",["T_WHITESPACE","\n  ",128],"}",["T_WHITESPACE","\n\n  ",129],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",131],["T_WHITESPACE","\n  ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","getParentDepthLimit",134],"(",["T_ARRAY","array",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$book_link",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n    ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_STATIC","static",135],["T_DOUBLE_COLON","::",135],["T_STRING","BOOK_MAX_DEPTH",135],["T_WHITESPACE"," ",135],"-",["T_WHITESPACE"," ",135],["T_LNUMBER","1",135],["T_WHITESPACE"," ",135],"-",["T_WHITESPACE"," ",135],"(","(",["T_VARIABLE","$book_link",135],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",135],"]",["T_WHITESPACE"," ",135],["T_BOOLEAN_AND","&&",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$book_link",135],"[",["T_CONSTANT_ENCAPSED_STRING","'has_children'",135],"]",")",["T_WHITESPACE"," ",135],"?",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","findChildrenRelativeDepth",135],"(",["T_VARIABLE","$book_link",135],")",["T_WHITESPACE"," ",135],":",["T_WHITESPACE"," ",135],["T_LNUMBER","0",135],")",";",["T_WHITESPACE","\n  ",135],"}",["T_WHITESPACE","\n\n  ",136],["T_DOC_COMMENT","\/**\n   * Determine the relative depth of the children of a given book link.\n   *\n   * @param array $book_link\n   *   The book link.\n   *\n   * @return int\n   *   The difference between the max depth in the book tree and the depth of\n   *   the passed book link.\n   *\/",138],["T_WHITESPACE","\n  ",147],["T_PROTECTED","protected",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","findChildrenRelativeDepth",148],"(",["T_ARRAY","array",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$book_link",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n    ",148],["T_VARIABLE","$max_depth",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","bookOutlineStorage",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getChildRelativeDepth",149],"(",["T_VARIABLE","$book_link",149],",",["T_WHITESPACE"," ",149],["T_STATIC","static",149],["T_DOUBLE_COLON","::",149],["T_STRING","BOOK_MAX_DEPTH",149],")",";",["T_WHITESPACE","\n    ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$max_depth",150],["T_WHITESPACE"," ",150],">",["T_WHITESPACE"," ",150],["T_VARIABLE","$book_link",150],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",150],"]",")",["T_WHITESPACE"," ",150],"?",["T_WHITESPACE"," ",150],["T_VARIABLE","$max_depth",150],["T_WHITESPACE"," ",150],"-",["T_WHITESPACE"," ",150],["T_VARIABLE","$book_link",150],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",150],"]",["T_WHITESPACE"," ",150],":",["T_WHITESPACE"," ",150],["T_LNUMBER","0",150],";",["T_WHITESPACE","\n  ",150],"}",["T_WHITESPACE","\n\n  ",151],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",153],["T_WHITESPACE","\n  ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","addFormElements",156],"(",["T_ARRAY","array",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$form",156],",",["T_WHITESPACE"," ",156],["T_STRING","FormStateInterface",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$form_state",156],",",["T_WHITESPACE"," ",156],["T_STRING","NodeInterface",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$node",156],",",["T_WHITESPACE"," ",156],["T_STRING","AccountInterface",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$account",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$collapsed",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","TRUE",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n    ",156],["T_COMMENT","\/\/ If the form is being processed during the Ajax callback of our book bid\n",157],["T_WHITESPACE","    ",158],["T_COMMENT","\/\/ dropdown, then $form_state will hold the value that was selected.\n",158],["T_WHITESPACE","    ",159],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$form_state",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","hasValue",159],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",159],")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n      ",159],["T_VARIABLE","$node",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","book",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$form_state",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getValue",160],"(",["T_CONSTANT_ENCAPSED_STRING","'book'",160],")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$form",162],"[",["T_CONSTANT_ENCAPSED_STRING","'book'",162],"]",["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_ARRAY","array",162],"(",["T_WHITESPACE","\n      ",162],["T_CONSTANT_ENCAPSED_STRING","'#type'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'details'",163],",",["T_WHITESPACE","\n      ",163],["T_CONSTANT_ENCAPSED_STRING","'#title'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","t",164],"(",["T_CONSTANT_ENCAPSED_STRING","'Book outline'",164],")",",",["T_WHITESPACE","\n      ",164],["T_CONSTANT_ENCAPSED_STRING","'#weight'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_LNUMBER","10",165],",",["T_WHITESPACE","\n      ",165],["T_CONSTANT_ENCAPSED_STRING","'#open'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],"!",["T_VARIABLE","$collapsed",166],",",["T_WHITESPACE","\n      ",166],["T_CONSTANT_ENCAPSED_STRING","'#group'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'advanced'",167],",",["T_WHITESPACE","\n      ",167],["T_CONSTANT_ENCAPSED_STRING","'#attributes'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_ARRAY","array",168],"(",["T_WHITESPACE","\n        ",168],["T_CONSTANT_ENCAPSED_STRING","'class'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_ARRAY","array",169],"(",["T_CONSTANT_ENCAPSED_STRING","'book-outline-form'",169],")",",",["T_WHITESPACE","\n      ",169],")",",",["T_WHITESPACE","\n      ",170],["T_CONSTANT_ENCAPSED_STRING","'#attached'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_ARRAY","array",171],"(",["T_WHITESPACE","\n        ",171],["T_CONSTANT_ENCAPSED_STRING","'library'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",["T_CONSTANT_ENCAPSED_STRING","'book\/drupal.book'",172],")",",",["T_WHITESPACE","\n      ",172],")",",",["T_WHITESPACE","\n      ",173],["T_CONSTANT_ENCAPSED_STRING","'#tree'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_STRING","TRUE",174],",",["T_WHITESPACE","\n    ",174],")",";",["T_WHITESPACE","\n    ",175],["T_FOREACH","foreach",176],["T_WHITESPACE"," ",176],"(",["T_ARRAY","array",176],"(",["T_CONSTANT_ENCAPSED_STRING","'nid'",176],",",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'has_children'",176],",",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'original_bid'",176],",",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'parent_depth_limit'",176],")",["T_WHITESPACE"," ",176],["T_AS","as",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$key",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n      ",176],["T_VARIABLE","$form",177],"[",["T_CONSTANT_ENCAPSED_STRING","'book'",177],"]","[",["T_VARIABLE","$key",177],"]",["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_ARRAY","array",177],"(",["T_WHITESPACE","\n        ",177],["T_CONSTANT_ENCAPSED_STRING","'#type'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'value'",178],",",["T_WHITESPACE","\n        ",178],["T_CONSTANT_ENCAPSED_STRING","'#value'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$node",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","book",179],"[",["T_VARIABLE","$key",179],"]",",",["T_WHITESPACE","\n      ",179],")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_VARIABLE","$form",183],"[",["T_CONSTANT_ENCAPSED_STRING","'book'",183],"]","[",["T_CONSTANT_ENCAPSED_STRING","'pid'",183],"]",["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","addParentSelectFormElements",183],"(",["T_VARIABLE","$node",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","book",183],")",";",["T_WHITESPACE","\n\n    ",183],["T_COMMENT","\/\/ @see \\Drupal\\book\\Form\\BookAdminEditForm::bookAdminTableTree(). The\n",185],["T_WHITESPACE","    ",186],["T_COMMENT","\/\/ weight may be larger than 15.\n",186],["T_WHITESPACE","    ",187],["T_VARIABLE","$form",187],"[",["T_CONSTANT_ENCAPSED_STRING","'book'",187],"]","[",["T_CONSTANT_ENCAPSED_STRING","'weight'",187],"]",["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",["T_WHITESPACE","\n      ",187],["T_CONSTANT_ENCAPSED_STRING","'#type'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'weight'",188],",",["T_WHITESPACE","\n      ",188],["T_CONSTANT_ENCAPSED_STRING","'#title'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","t",189],"(",["T_CONSTANT_ENCAPSED_STRING","'Weight'",189],")",",",["T_WHITESPACE","\n      ",189],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$node",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","book",190],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",190],"]",",",["T_WHITESPACE","\n      ",190],["T_CONSTANT_ENCAPSED_STRING","'#delta'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_STRING","max",191],"(",["T_LNUMBER","15",191],",",["T_WHITESPACE"," ",191],["T_STRING","abs",191],"(",["T_VARIABLE","$node",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","book",191],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",191],"]",")",")",",",["T_WHITESPACE","\n      ",191],["T_CONSTANT_ENCAPSED_STRING","'#weight'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_LNUMBER","5",192],",",["T_WHITESPACE","\n      ",192],["T_CONSTANT_ENCAPSED_STRING","'#description'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","t",193],"(",["T_CONSTANT_ENCAPSED_STRING","'Pages at a given level are ordered first by weight and then by title.'",193],")",",",["T_WHITESPACE","\n    ",193],")",";",["T_WHITESPACE","\n    ",194],["T_VARIABLE","$options",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_ARRAY","array",195],"(",")",";",["T_WHITESPACE","\n    ",195],["T_VARIABLE","$nid",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],"!",["T_VARIABLE","$node",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","isNew",196],"(",")",["T_WHITESPACE"," ",196],"?",["T_WHITESPACE"," ",196],["T_VARIABLE","$node",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","id",196],"(",")",["T_WHITESPACE"," ",196],":",["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'new'",196],";",["T_WHITESPACE","\n    ",196],["T_IF","if",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$node",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","id",197],"(",")",["T_WHITESPACE"," ",197],["T_BOOLEAN_AND","&&",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$nid",197],["T_WHITESPACE"," ",197],["T_IS_EQUAL","==",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$node",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","book",197],"[",["T_CONSTANT_ENCAPSED_STRING","'original_bid'",197],"]",")",["T_WHITESPACE"," ",197],["T_BOOLEAN_AND","&&",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$node",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","book",197],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_depth_limit'",197],"]",["T_WHITESPACE"," ",197],["T_IS_EQUAL","==",197],["T_WHITESPACE"," ",197],["T_LNUMBER","0",197],")",")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n      ",197],["T_COMMENT","\/\/ This is the top level node in a maximum depth book and thus cannot be\n",198],["T_WHITESPACE","      ",199],["T_COMMENT","\/\/ moved.\n",199],["T_WHITESPACE","      ",200],["T_VARIABLE","$options",200],"[",["T_VARIABLE","$node",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","id",200],"(",")","]",["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$node",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","label",200],"(",")",";",["T_WHITESPACE","\n    ",200],"}",["T_WHITESPACE","\n    ",201],["T_ELSE","else",202],["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n      ",202],["T_FOREACH","foreach",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getAllBooks",203],"(",")",["T_WHITESPACE"," ",203],["T_AS","as",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$book",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$options",204],"[",["T_VARIABLE","$book",204],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",204],"]","]",["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$book",204],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",204],"]",";",["T_WHITESPACE","\n      ",204],"}",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n\n    ",206],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$account",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","hasPermission",208],"(",["T_CONSTANT_ENCAPSED_STRING","'create new books'",208],")",["T_WHITESPACE"," ",208],["T_BOOLEAN_AND","&&",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$nid",208],["T_WHITESPACE"," ",208],["T_IS_EQUAL","==",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'new'",208],["T_WHITESPACE"," ",208],["T_BOOLEAN_OR","||",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$nid",208],["T_WHITESPACE"," ",208],["T_IS_NOT_EQUAL","!=",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$node",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","book",208],"[",["T_CONSTANT_ENCAPSED_STRING","'original_bid'",208],"]",")",")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n      ",208],["T_COMMENT","\/\/ The node can become a new book, if it is not one already.\n",209],["T_WHITESPACE","      ",210],["T_VARIABLE","$options",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_ARRAY","array",210],"(",["T_VARIABLE","$nid",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","t",210],"(",["T_CONSTANT_ENCAPSED_STRING","'- Create a new book -'",210],")",")",["T_WHITESPACE"," ",210],"+",["T_WHITESPACE"," ",210],["T_VARIABLE","$options",210],";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n    ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(","!",["T_VARIABLE","$node",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","book",212],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",212],"]",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n      ",212],["T_COMMENT","\/\/ The node is not currently in the hierarchy.\n",213],["T_WHITESPACE","      ",214],["T_VARIABLE","$options",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_ARRAY","array",214],"(",["T_LNUMBER","0",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","t",214],"(",["T_CONSTANT_ENCAPSED_STRING","'- None -'",214],")",")",["T_WHITESPACE"," ",214],"+",["T_WHITESPACE"," ",214],["T_VARIABLE","$options",214],";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_COMMENT","\/\/ Add a drop-down to select the destination book.\n",217],["T_WHITESPACE","    ",218],["T_VARIABLE","$form",218],"[",["T_CONSTANT_ENCAPSED_STRING","'book'",218],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bid'",218],"]",["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_ARRAY","array",218],"(",["T_WHITESPACE","\n      ",218],["T_CONSTANT_ENCAPSED_STRING","'#type'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'select'",219],",",["T_WHITESPACE","\n      ",219],["T_CONSTANT_ENCAPSED_STRING","'#title'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","t",220],"(",["T_CONSTANT_ENCAPSED_STRING","'Book'",220],")",",",["T_WHITESPACE","\n      ",220],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$node",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","book",221],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",221],"]",",",["T_WHITESPACE","\n      ",221],["T_CONSTANT_ENCAPSED_STRING","'#options'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$options",222],",",["T_WHITESPACE","\n      ",222],["T_CONSTANT_ENCAPSED_STRING","'#access'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_BOOL_CAST","(bool)",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$options",223],",",["T_WHITESPACE","\n      ",223],["T_CONSTANT_ENCAPSED_STRING","'#description'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","t",224],"(",["T_CONSTANT_ENCAPSED_STRING","'Your page will be a part of the selected book.'",224],")",",",["T_WHITESPACE","\n      ",224],["T_CONSTANT_ENCAPSED_STRING","'#weight'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],"-",["T_LNUMBER","5",225],",",["T_WHITESPACE","\n      ",225],["T_CONSTANT_ENCAPSED_STRING","'#attributes'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_CONSTANT_ENCAPSED_STRING","'class'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_CONSTANT_ENCAPSED_STRING","'book-title-select'",226],")",")",",",["T_WHITESPACE","\n      ",226],["T_CONSTANT_ENCAPSED_STRING","'#ajax'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_ARRAY","array",227],"(",["T_WHITESPACE","\n        ",227],["T_CONSTANT_ENCAPSED_STRING","'callback'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'book_form_update'",228],",",["T_WHITESPACE","\n        ",228],["T_CONSTANT_ENCAPSED_STRING","'wrapper'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'edit-book-plid-wrapper'",229],",",["T_WHITESPACE","\n        ",229],["T_CONSTANT_ENCAPSED_STRING","'effect'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'fade'",230],",",["T_WHITESPACE","\n        ",230],["T_CONSTANT_ENCAPSED_STRING","'speed'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'fast'",231],",",["T_WHITESPACE","\n      ",231],")",",",["T_WHITESPACE","\n    ",232],")",";",["T_WHITESPACE","\n    ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$form",234],";",["T_WHITESPACE","\n  ",234],"}",["T_WHITESPACE","\n\n  ",235],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",237],["T_WHITESPACE","\n  ",239],["T_PUBLIC","public",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","checkNodeIsRemovable",240],"(",["T_STRING","NodeInterface",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$node",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n    ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],"(","!",["T_EMPTY","empty",241],"(",["T_VARIABLE","$node",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","book",241],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",241],"]",")",["T_WHITESPACE"," ",241],["T_BOOLEAN_AND","&&",241],["T_WHITESPACE"," ",241],"(","(",["T_VARIABLE","$node",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","book",241],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",241],"]",["T_WHITESPACE"," ",241],["T_IS_NOT_EQUAL","!=",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$node",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","id",241],"(",")",")",["T_WHITESPACE"," ",241],["T_BOOLEAN_OR","||",241],["T_WHITESPACE"," ",241],"!",["T_VARIABLE","$node",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","book",241],"[",["T_CONSTANT_ENCAPSED_STRING","'has_children'",241],"]",")",")",";",["T_WHITESPACE","\n  ",241],"}",["T_WHITESPACE","\n\n  ",242],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",244],["T_WHITESPACE","\n  ",246],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","updateOutline",247],"(",["T_STRING","NodeInterface",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$node",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n    ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_EMPTY","empty",248],"(",["T_VARIABLE","$node",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","book",248],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",248],"]",")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n      ",248],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_STRING","FALSE",249],";",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_IF","if",252],["T_WHITESPACE"," ",252],"(","!",["T_EMPTY","empty",252],"(",["T_VARIABLE","$node",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","book",252],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",252],"]",")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n      ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$node",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","book",253],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",253],"]",["T_WHITESPACE"," ",253],["T_IS_EQUAL","==",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'new'",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n        ",253],["T_COMMENT","\/\/ New nodes that are their own book.\n",254],["T_WHITESPACE","        ",255],["T_VARIABLE","$node",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","book",255],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",255],"]",["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$node",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","id",255],"(",")",";",["T_WHITESPACE","\n      ",255],"}",["T_WHITESPACE","\n      ",256],["T_ELSEIF","elseif",257],["T_WHITESPACE"," ",257],"(","!",["T_ISSET","isset",257],"(",["T_VARIABLE","$node",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","book",257],"[",["T_CONSTANT_ENCAPSED_STRING","'original_bid'",257],"]",")",")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$node",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","book",258],"[",["T_CONSTANT_ENCAPSED_STRING","'original_bid'",258],"]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$node",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","book",258],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",258],"]",";",["T_WHITESPACE","\n      ",258],"}",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n\n    ",260],["T_COMMENT","\/\/ Ensure we create a new book link if either the node itself is new, or the\n",262],["T_WHITESPACE","    ",263],["T_COMMENT","\/\/ bid was selected the first time, so that the original_bid is still empty.\n",263],["T_WHITESPACE","    ",264],["T_VARIABLE","$new",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_EMPTY","empty",264],"(",["T_VARIABLE","$node",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","book",264],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",264],"]",")",["T_WHITESPACE"," ",264],["T_BOOLEAN_OR","||",264],["T_WHITESPACE"," ",264],["T_EMPTY","empty",264],"(",["T_VARIABLE","$node",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","book",264],"[",["T_CONSTANT_ENCAPSED_STRING","'original_bid'",264],"]",")",";",["T_WHITESPACE","\n\n    ",264],["T_VARIABLE","$node",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","book",266],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",266],"]",["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$node",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","id",266],"(",")",";",["T_WHITESPACE","\n\n    ",266],["T_COMMENT","\/\/ Create a new book from a node.\n",268],["T_WHITESPACE","    ",269],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$node",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","book",269],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",269],"]",["T_WHITESPACE"," ",269],["T_IS_EQUAL","==",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$node",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","id",269],"(",")",")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n      ",269],["T_VARIABLE","$node",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","book",270],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",270],"]",["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_LNUMBER","0",270],";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n    ",271],["T_ELSEIF","elseif",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$node",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","book",272],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",272],"]",["T_WHITESPACE"," ",272],"<",["T_WHITESPACE"," ",272],["T_LNUMBER","0",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n      ",272],["T_COMMENT","\/\/ -1 is the default value in BookManager::addParentSelectFormElements().\n",273],["T_WHITESPACE","      ",274],["T_COMMENT","\/\/ The node save should have set the bid equal to the node ID, but\n",274],["T_WHITESPACE","      ",275],["T_COMMENT","\/\/ handle it here if it did not.\n",275],["T_WHITESPACE","      ",276],["T_VARIABLE","$node",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","book",276],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",276],"]",["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$node",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","book",276],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",276],"]",";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n    ",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","saveBookLink",278],"(",["T_VARIABLE","$node",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","book",278],",",["T_WHITESPACE"," ",278],["T_VARIABLE","$new",278],")",";",["T_WHITESPACE","\n  ",278],"}",["T_WHITESPACE","\n\n  ",279],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",281],["T_WHITESPACE","\n  ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","getBookParents",284],"(",["T_ARRAY","array",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$item",284],",",["T_WHITESPACE"," ",284],["T_ARRAY","array",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$parent",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_ARRAY","array",284],"(",")",")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n    ",284],["T_VARIABLE","$book",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_ARRAY","array",285],"(",")",";",["T_WHITESPACE","\n    ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_VARIABLE","$item",286],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",286],"]",["T_WHITESPACE"," ",286],["T_IS_EQUAL","==",286],["T_WHITESPACE"," ",286],["T_LNUMBER","0",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n      ",286],["T_VARIABLE","$book",287],"[",["T_CONSTANT_ENCAPSED_STRING","'p1'",287],"]",["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$item",287],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",287],"]",";",["T_WHITESPACE","\n      ",287],["T_FOR","for",288],["T_WHITESPACE"," ",288],"(",["T_VARIABLE","$i",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_LNUMBER","2",288],";",["T_WHITESPACE"," ",288],["T_VARIABLE","$i",288],["T_WHITESPACE"," ",288],["T_IS_SMALLER_OR_EQUAL","<=",288],["T_WHITESPACE"," ",288],["T_STATIC","static",288],["T_DOUBLE_COLON","::",288],["T_STRING","BOOK_MAX_DEPTH",288],";",["T_WHITESPACE"," ",288],["T_VARIABLE","$i",288],["T_INC","++",288],")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$parent_property",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],"\"",["T_ENCAPSED_AND_WHITESPACE","p",289],["T_VARIABLE","$i",289],"\"",";",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$book",290],"[",["T_VARIABLE","$parent_property",290],"]",["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_LNUMBER","0",290],";",["T_WHITESPACE","\n      ",290],"}",["T_WHITESPACE","\n      ",291],["T_VARIABLE","$book",292],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",292],"]",["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_LNUMBER","1",292],";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n    ",293],["T_ELSE","else",294],["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n      ",294],["T_VARIABLE","$i",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_LNUMBER","1",295],";",["T_WHITESPACE","\n      ",295],["T_VARIABLE","$book",296],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",296],"]",["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$parent",296],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",296],"]",["T_WHITESPACE"," ",296],"+",["T_WHITESPACE"," ",296],["T_LNUMBER","1",296],";",["T_WHITESPACE","\n      ",296],["T_WHILE","while",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$i",297],["T_WHITESPACE"," ",297],"<",["T_WHITESPACE"," ",297],["T_VARIABLE","$book",297],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",297],"]",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n        ",297],["T_VARIABLE","$p",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'p'",298],["T_WHITESPACE"," ",298],".",["T_WHITESPACE"," ",298],["T_VARIABLE","$i",298],["T_INC","++",298],";",["T_WHITESPACE","\n        ",298],["T_VARIABLE","$book",299],"[",["T_VARIABLE","$p",299],"]",["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$parent",299],"[",["T_VARIABLE","$p",299],"]",";",["T_WHITESPACE","\n      ",299],"}",["T_WHITESPACE","\n      ",300],["T_VARIABLE","$p",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'p'",301],["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_VARIABLE","$i",301],["T_INC","++",301],";",["T_WHITESPACE","\n      ",301],["T_COMMENT","\/\/ The parent (p1 - p9) corresponding to the depth always equals the nid.\n",302],["T_WHITESPACE","      ",303],["T_VARIABLE","$book",303],"[",["T_VARIABLE","$p",303],"]",["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$item",303],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",303],"]",";",["T_WHITESPACE","\n      ",303],["T_WHILE","while",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$i",304],["T_WHITESPACE"," ",304],["T_IS_SMALLER_OR_EQUAL","<=",304],["T_WHITESPACE"," ",304],["T_STATIC","static",304],["T_DOUBLE_COLON","::",304],["T_STRING","BOOK_MAX_DEPTH",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$p",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_CONSTANT_ENCAPSED_STRING","'p'",305],["T_WHITESPACE"," ",305],".",["T_WHITESPACE"," ",305],["T_VARIABLE","$i",305],["T_INC","++",305],";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$book",306],"[",["T_VARIABLE","$p",306],"]",["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_LNUMBER","0",306],";",["T_WHITESPACE","\n      ",306],"}",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n    ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$book",309],";",["T_WHITESPACE","\n  ",309],"}",["T_WHITESPACE","\n\n  ",310],["T_DOC_COMMENT","\/**\n   * Builds the parent selection form element for the node form or outline tab.\n   *\n   * This function is also called when generating a new set of options during\n   * the Ajax callback, so an array is returned that can be used to replace an\n   * existing form element.\n   *\n   * @param array $book_link\n   *   A fully loaded book link that is part of the book hierarchy.\n   *\n   * @return array\n   *   A parent selection form element.\n   *\/",312],["T_WHITESPACE","\n  ",324],["T_PROTECTED","protected",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","addParentSelectFormElements",325],"(",["T_ARRAY","array",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$book_link",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n    ",325],["T_VARIABLE","$config",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","configFactory",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","get",326],"(",["T_CONSTANT_ENCAPSED_STRING","'book.settings'",326],")",";",["T_WHITESPACE","\n    ",326],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$config",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","get",327],"(",["T_CONSTANT_ENCAPSED_STRING","'override_parent_selector'",327],")",")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n      ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_ARRAY","array",328],"(",")",";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n    ",329],["T_COMMENT","\/\/ Offer a message or a drop-down to choose a different parent page.\n",330],["T_WHITESPACE","    ",331],["T_VARIABLE","$form",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_ARRAY","array",331],"(",["T_WHITESPACE","\n      ",331],["T_CONSTANT_ENCAPSED_STRING","'#type'",332],["T_WHITESPACE"," ",332],["T_DOUBLE_ARROW","=>",332],["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'hidden'",332],",",["T_WHITESPACE","\n      ",332],["T_CONSTANT_ENCAPSED_STRING","'#value'",333],["T_WHITESPACE"," ",333],["T_DOUBLE_ARROW","=>",333],["T_WHITESPACE"," ",333],"-",["T_LNUMBER","1",333],",",["T_WHITESPACE","\n      ",333],["T_CONSTANT_ENCAPSED_STRING","'#prefix'",334],["T_WHITESPACE"," ",334],["T_DOUBLE_ARROW","=>",334],["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","'<div id=\"edit-book-plid-wrapper\">'",334],",",["T_WHITESPACE","\n      ",334],["T_CONSTANT_ENCAPSED_STRING","'#suffix'",335],["T_WHITESPACE"," ",335],["T_DOUBLE_ARROW","=>",335],["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'<\/div>'",335],",",["T_WHITESPACE","\n    ",335],")",";",["T_WHITESPACE","\n\n    ",336],["T_IF","if",338],["T_WHITESPACE"," ",338],"(",["T_VARIABLE","$book_link",338],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",338],"]",["T_WHITESPACE"," ",338],["T_IS_IDENTICAL","===",338],["T_WHITESPACE"," ",338],["T_VARIABLE","$book_link",338],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",338],"]",")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n      ",338],["T_COMMENT","\/\/ This is a book - at the top level.\n",339],["T_WHITESPACE","      ",340],["T_IF","if",340],["T_WHITESPACE"," ",340],"(",["T_VARIABLE","$book_link",340],"[",["T_CONSTANT_ENCAPSED_STRING","'original_bid'",340],"]",["T_WHITESPACE"," ",340],["T_IS_IDENTICAL","===",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$book_link",340],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",340],"]",")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n        ",340],["T_VARIABLE","$form",341],"[",["T_CONSTANT_ENCAPSED_STRING","'#prefix'",341],"]",["T_WHITESPACE"," ",341],["T_CONCAT_EQUAL",".=",341],["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'<em>'",341],["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","t",341],"(",["T_CONSTANT_ENCAPSED_STRING","'This is the top-level page in this book.'",341],")",["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'<\/em>'",341],";",["T_WHITESPACE","\n      ",341],"}",["T_WHITESPACE","\n      ",342],["T_ELSE","else",343],["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n        ",343],["T_VARIABLE","$form",344],"[",["T_CONSTANT_ENCAPSED_STRING","'#prefix'",344],"]",["T_WHITESPACE"," ",344],["T_CONCAT_EQUAL",".=",344],["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","'<em>'",344],["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","t",344],"(",["T_CONSTANT_ENCAPSED_STRING","'This will be the top-level page in this book.'",344],")",["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","'<\/em>'",344],";",["T_WHITESPACE","\n      ",344],"}",["T_WHITESPACE","\n    ",345],"}",["T_WHITESPACE","\n    ",346],["T_ELSEIF","elseif",347],["T_WHITESPACE"," ",347],"(","!",["T_VARIABLE","$book_link",347],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",347],"]",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n      ",347],["T_VARIABLE","$form",348],"[",["T_CONSTANT_ENCAPSED_STRING","'#prefix'",348],"]",["T_WHITESPACE"," ",348],["T_CONCAT_EQUAL",".=",348],["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","'<em>'",348],["T_WHITESPACE"," ",348],".",["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","t",348],"(",["T_CONSTANT_ENCAPSED_STRING","'No book selected.'",348],")",["T_WHITESPACE"," ",348],".",["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","'<\/em>'",348],";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n    ",349],["T_ELSE","else",350],["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n      ",350],["T_VARIABLE","$form",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_ARRAY","array",351],"(",["T_WHITESPACE","\n        ",351],["T_CONSTANT_ENCAPSED_STRING","'#type'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'select'",352],",",["T_WHITESPACE","\n        ",352],["T_CONSTANT_ENCAPSED_STRING","'#title'",353],["T_WHITESPACE"," ",353],["T_DOUBLE_ARROW","=>",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","t",353],"(",["T_CONSTANT_ENCAPSED_STRING","'Parent item'",353],")",",",["T_WHITESPACE","\n        ",353],["T_CONSTANT_ENCAPSED_STRING","'#default_value'",354],["T_WHITESPACE"," ",354],["T_DOUBLE_ARROW","=>",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$book_link",354],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",354],"]",",",["T_WHITESPACE","\n        ",354],["T_CONSTANT_ENCAPSED_STRING","'#description'",355],["T_WHITESPACE"," ",355],["T_DOUBLE_ARROW","=>",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","t",355],"(",["T_CONSTANT_ENCAPSED_STRING","'The parent page in the book. The maximum depth for a book and all child pages is @maxdepth. Some pages in the selected book may not be available as parents if selecting them would exceed this limit.'",355],",",["T_WHITESPACE"," ",355],["T_ARRAY","array",355],"(",["T_CONSTANT_ENCAPSED_STRING","'@maxdepth'",355],["T_WHITESPACE"," ",355],["T_DOUBLE_ARROW","=>",355],["T_WHITESPACE"," ",355],["T_STATIC","static",355],["T_DOUBLE_COLON","::",355],["T_STRING","BOOK_MAX_DEPTH",355],")",")",",",["T_WHITESPACE","\n        ",355],["T_CONSTANT_ENCAPSED_STRING","'#options'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getTableOfContents",356],"(",["T_VARIABLE","$book_link",356],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",356],"]",",",["T_WHITESPACE"," ",356],["T_VARIABLE","$book_link",356],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_depth_limit'",356],"]",",",["T_WHITESPACE"," ",356],["T_ARRAY","array",356],"(",["T_VARIABLE","$book_link",356],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",356],"]",")",")",",",["T_WHITESPACE","\n        ",356],["T_CONSTANT_ENCAPSED_STRING","'#attributes'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_ARRAY","array",357],"(",["T_CONSTANT_ENCAPSED_STRING","'class'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_ARRAY","array",357],"(",["T_CONSTANT_ENCAPSED_STRING","'book-title-select'",357],")",")",",",["T_WHITESPACE","\n        ",357],["T_CONSTANT_ENCAPSED_STRING","'#prefix'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'<div id=\"edit-book-plid-wrapper\">'",358],",",["T_WHITESPACE","\n        ",358],["T_CONSTANT_ENCAPSED_STRING","'#suffix'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'<\/div>'",359],",",["T_WHITESPACE","\n      ",359],")",";",["T_WHITESPACE","\n    ",360],"}",["T_WHITESPACE","\n    ",361],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","renderer",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","addCacheableDependency",362],"(",["T_VARIABLE","$form",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$config",362],")",";",["T_WHITESPACE","\n\n    ",362],["T_RETURN","return",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$form",364],";",["T_WHITESPACE","\n  ",364],"}",["T_WHITESPACE","\n\n  ",365],["T_DOC_COMMENT","\/**\n   * Recursively processes and formats book links for getTableOfContents().\n   *\n   * This helper function recursively modifies the table of contents array for\n   * each item in the book tree, ignoring items in the exclude array or at a\n   * depth greater than the limit. Truncates titles over thirty characters and\n   * appends an indentation string incremented by depth.\n   *\n   * @param array $tree\n   *   The data structure of the book's outline tree. Includes hidden links.\n   * @param string $indent\n   *   A string appended to each node title. Increments by '--' per depth\n   *   level.\n   * @param array $toc\n   *   Reference to the table of contents array. This is modified in place, so\n   *   the function does not have a return value.\n   * @param array $exclude\n   *   Optional array of Node ID values. Any link whose node ID is in this\n   *   array will be excluded (along with its children).\n   * @param int $depth_limit\n   *   Any link deeper than this value will be excluded (along with its\n   *   children).\n   *\/",367],["T_WHITESPACE","\n  ",389],["T_PROTECTED","protected",390],["T_WHITESPACE"," ",390],["T_FUNCTION","function",390],["T_WHITESPACE"," ",390],["T_STRING","recurseTableOfContents",390],"(",["T_ARRAY","array",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$tree",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$indent",390],",",["T_WHITESPACE"," ",390],["T_ARRAY","array",390],["T_WHITESPACE"," ",390],"&",["T_VARIABLE","$toc",390],",",["T_WHITESPACE"," ",390],["T_ARRAY","array",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$exclude",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$depth_limit",390],")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n    ",390],["T_VARIABLE","$nids",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_ARRAY","array",391],"(",")",";",["T_WHITESPACE","\n    ",391],["T_FOREACH","foreach",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$tree",392],["T_WHITESPACE"," ",392],["T_AS","as",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$data",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n      ",392],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$data",393],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",393],"]","[",["T_CONSTANT_ENCAPSED_STRING","'depth'",393],"]",["T_WHITESPACE"," ",393],">",["T_WHITESPACE"," ",393],["T_VARIABLE","$depth_limit",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n        ",393],["T_COMMENT","\/\/ Don't iterate through any links on this level.\n",394],["T_WHITESPACE","        ",395],["T_RETURN","return",395],";",["T_WHITESPACE","\n      ",395],"}",["T_WHITESPACE","\n      ",396],["T_IF","if",397],["T_WHITESPACE"," ",397],"(","!",["T_STRING","in_array",397],"(",["T_VARIABLE","$data",397],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",397],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",397],"]",",",["T_WHITESPACE"," ",397],["T_VARIABLE","$exclude",397],")",")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n        ",397],["T_VARIABLE","$nids",398],"[","]",["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_VARIABLE","$data",398],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",398],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",398],"]",";",["T_WHITESPACE","\n      ",398],"}",["T_WHITESPACE","\n    ",399],"}",["T_WHITESPACE","\n\n    ",400],["T_VARIABLE","$nodes",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","entityManager",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","getStorage",402],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",402],")",["T_OBJECT_OPERATOR","->",402],["T_STRING","loadMultiple",402],"(",["T_VARIABLE","$nids",402],")",";",["T_WHITESPACE","\n\n    ",402],["T_FOREACH","foreach",404],["T_WHITESPACE"," ",404],"(",["T_VARIABLE","$tree",404],["T_WHITESPACE"," ",404],["T_AS","as",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$data",404],")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n      ",404],["T_VARIABLE","$nid",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_VARIABLE","$data",405],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",405],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",405],"]",";",["T_WHITESPACE","\n      ",405],["T_COMMENT","\/\/ Check for excluded or missing node.\n",406],["T_WHITESPACE","      ",407],["T_IF","if",407],["T_WHITESPACE"," ",407],"(",["T_EMPTY","empty",407],"(",["T_VARIABLE","$nodes",407],"[",["T_VARIABLE","$nid",407],"]",")",")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n        ",407],["T_CONTINUE","continue",408],";",["T_WHITESPACE","\n      ",408],"}",["T_WHITESPACE","\n      ",409],["T_VARIABLE","$toc",410],"[",["T_VARIABLE","$nid",410],"]",["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$indent",410],["T_WHITESPACE"," ",410],".",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","' '",410],["T_WHITESPACE"," ",410],".",["T_WHITESPACE"," ",410],["T_STRING","Unicode",410],["T_DOUBLE_COLON","::",410],["T_STRING","truncate",410],"(",["T_VARIABLE","$nodes",410],"[",["T_VARIABLE","$nid",410],"]",["T_OBJECT_OPERATOR","->",410],["T_STRING","label",410],"(",")",",",["T_WHITESPACE"," ",410],["T_LNUMBER","30",410],",",["T_WHITESPACE"," ",410],["T_STRING","TRUE",410],",",["T_WHITESPACE"," ",410],["T_STRING","TRUE",410],")",";",["T_WHITESPACE","\n      ",410],["T_IF","if",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$data",411],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",411],"]",")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n        ",411],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","recurseTableOfContents",412],"(",["T_VARIABLE","$data",412],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",412],"]",",",["T_WHITESPACE"," ",412],["T_VARIABLE","$indent",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","'--'",412],",",["T_WHITESPACE"," ",412],["T_VARIABLE","$toc",412],",",["T_WHITESPACE"," ",412],["T_VARIABLE","$exclude",412],",",["T_WHITESPACE"," ",412],["T_VARIABLE","$depth_limit",412],")",";",["T_WHITESPACE","\n      ",412],"}",["T_WHITESPACE","\n    ",413],"}",["T_WHITESPACE","\n  ",414],"}",["T_WHITESPACE","\n\n  ",415],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",417],["T_WHITESPACE","\n  ",419],["T_PUBLIC","public",420],["T_WHITESPACE"," ",420],["T_FUNCTION","function",420],["T_WHITESPACE"," ",420],["T_STRING","getTableOfContents",420],"(",["T_VARIABLE","$bid",420],",",["T_WHITESPACE"," ",420],["T_VARIABLE","$depth_limit",420],",",["T_WHITESPACE"," ",420],["T_ARRAY","array",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$exclude",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_ARRAY","array",420],"(",")",")",["T_WHITESPACE"," ",420],"{",["T_WHITESPACE","\n    ",420],["T_VARIABLE","$tree",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","bookTreeAllData",421],"(",["T_VARIABLE","$bid",421],")",";",["T_WHITESPACE","\n    ",421],["T_VARIABLE","$toc",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_ARRAY","array",422],"(",")",";",["T_WHITESPACE","\n    ",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","recurseTableOfContents",423],"(",["T_VARIABLE","$tree",423],",",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","''",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$toc",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$exclude",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$depth_limit",423],")",";",["T_WHITESPACE","\n\n    ",423],["T_RETURN","return",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$toc",425],";",["T_WHITESPACE","\n  ",425],"}",["T_WHITESPACE","\n\n  ",426],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",428],["T_WHITESPACE","\n  ",430],["T_PUBLIC","public",431],["T_WHITESPACE"," ",431],["T_FUNCTION","function",431],["T_WHITESPACE"," ",431],["T_STRING","deleteFromBook",431],"(",["T_VARIABLE","$nid",431],")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n    ",431],["T_VARIABLE","$original",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","loadBookLink",432],"(",["T_VARIABLE","$nid",432],",",["T_WHITESPACE"," ",432],["T_STRING","FALSE",432],")",";",["T_WHITESPACE","\n    ",432],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","bookOutlineStorage",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","delete",433],"(",["T_VARIABLE","$nid",433],")",";",["T_WHITESPACE","\n\n    ",433],["T_IF","if",435],["T_WHITESPACE"," ",435],"(",["T_VARIABLE","$nid",435],["T_WHITESPACE"," ",435],["T_IS_EQUAL","==",435],["T_WHITESPACE"," ",435],["T_VARIABLE","$original",435],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",435],"]",")",["T_WHITESPACE"," ",435],"{",["T_WHITESPACE","\n      ",435],["T_COMMENT","\/\/ Handle deletion of a top-level post.\n",436],["T_WHITESPACE","      ",437],["T_VARIABLE","$result",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","bookOutlineStorage",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","loadBookChildren",437],"(",["T_VARIABLE","$nid",437],")",";",["T_WHITESPACE","\n      ",437],["T_VARIABLE","$children",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","entityManager",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","getStorage",438],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",438],")",["T_OBJECT_OPERATOR","->",438],["T_STRING","loadMultiple",438],"(",["T_STRING","array_keys",438],"(",["T_VARIABLE","$result",438],")",")",";",["T_WHITESPACE","\n      ",438],["T_FOREACH","foreach",439],["T_WHITESPACE"," ",439],"(",["T_VARIABLE","$children",439],["T_WHITESPACE"," ",439],["T_AS","as",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$child",439],")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n        ",439],["T_VARIABLE","$child",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","book",440],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",440],"]",["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_VARIABLE","$child",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","id",440],"(",")",";",["T_WHITESPACE","\n        ",440],["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","updateOutline",441],"(",["T_VARIABLE","$child",441],")",";",["T_WHITESPACE","\n      ",441],"}",["T_WHITESPACE","\n    ",442],"}",["T_WHITESPACE","\n    ",443],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","updateOriginalParent",444],"(",["T_VARIABLE","$original",444],")",";",["T_WHITESPACE","\n    ",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","books",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_STRING","NULL",445],";",["T_WHITESPACE","\n    ",445],["T_STRING","Cache",446],["T_DOUBLE_COLON","::",446],["T_STRING","invalidateTags",446],"(",["T_ARRAY","array",446],"(",["T_CONSTANT_ENCAPSED_STRING","'bid:'",446],["T_WHITESPACE"," ",446],".",["T_WHITESPACE"," ",446],["T_VARIABLE","$original",446],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",446],"]",")",")",";",["T_WHITESPACE","\n  ",446],"}",["T_WHITESPACE","\n\n  ",447],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",449],["T_WHITESPACE","\n  ",451],["T_PUBLIC","public",452],["T_WHITESPACE"," ",452],["T_FUNCTION","function",452],["T_WHITESPACE"," ",452],["T_STRING","bookTreeAllData",452],"(",["T_VARIABLE","$bid",452],",",["T_WHITESPACE"," ",452],["T_VARIABLE","$link",452],["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],["T_STRING","NULL",452],",",["T_WHITESPACE"," ",452],["T_VARIABLE","$max_depth",452],["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],["T_STRING","NULL",452],")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n    ",452],["T_VARIABLE","$tree",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],"&",["T_STRING","drupal_static",453],"(",["T_METHOD_C","__METHOD__",453],",",["T_WHITESPACE"," ",453],["T_ARRAY","array",453],"(",")",")",";",["T_WHITESPACE","\n    ",453],["T_VARIABLE","$language_interface",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_NS_SEPARATOR","\\",454],["T_STRING","Drupal",454],["T_DOUBLE_COLON","::",454],["T_STRING","languageManager",454],"(",")",["T_OBJECT_OPERATOR","->",454],["T_STRING","getCurrentLanguage",454],"(",")",";",["T_WHITESPACE","\n\n    ",454],["T_COMMENT","\/\/ Use $nid as a flag for whether the data being loaded is for the whole\n",456],["T_WHITESPACE","    ",457],["T_COMMENT","\/\/ tree.\n",457],["T_WHITESPACE","    ",458],["T_VARIABLE","$nid",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_ISSET","isset",458],"(",["T_VARIABLE","$link",458],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",458],"]",")",["T_WHITESPACE"," ",458],"?",["T_WHITESPACE"," ",458],["T_VARIABLE","$link",458],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",458],"]",["T_WHITESPACE"," ",458],":",["T_WHITESPACE"," ",458],["T_LNUMBER","0",458],";",["T_WHITESPACE","\n    ",458],["T_COMMENT","\/\/ Generate a cache ID (cid) specific for this $bid, $link, $language, and\n",459],["T_WHITESPACE","    ",460],["T_COMMENT","\/\/ depth.\n",460],["T_WHITESPACE","    ",461],["T_VARIABLE","$cid",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_CONSTANT_ENCAPSED_STRING","'book-links:'",461],["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_VARIABLE","$bid",461],["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_CONSTANT_ENCAPSED_STRING","':all:'",461],["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_VARIABLE","$nid",461],["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_CONSTANT_ENCAPSED_STRING","':'",461],["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_VARIABLE","$language_interface",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","getId",461],"(",")",["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_CONSTANT_ENCAPSED_STRING","':'",461],["T_WHITESPACE"," ",461],".",["T_WHITESPACE"," ",461],["T_INT_CAST","(int)",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$max_depth",461],";",["T_WHITESPACE","\n\n    ",461],["T_IF","if",463],["T_WHITESPACE"," ",463],"(","!",["T_ISSET","isset",463],"(",["T_VARIABLE","$tree",463],"[",["T_VARIABLE","$cid",463],"]",")",")",["T_WHITESPACE"," ",463],"{",["T_WHITESPACE","\n      ",463],["T_COMMENT","\/\/ If the tree data was not in the static cache, build $tree_parameters.\n",464],["T_WHITESPACE","      ",465],["T_VARIABLE","$tree_parameters",465],["T_WHITESPACE"," ",465],"=",["T_WHITESPACE"," ",465],["T_ARRAY","array",465],"(",["T_WHITESPACE","\n        ",465],["T_CONSTANT_ENCAPSED_STRING","'min_depth'",466],["T_WHITESPACE"," ",466],["T_DOUBLE_ARROW","=>",466],["T_WHITESPACE"," ",466],["T_LNUMBER","1",466],",",["T_WHITESPACE","\n        ",466],["T_CONSTANT_ENCAPSED_STRING","'max_depth'",467],["T_WHITESPACE"," ",467],["T_DOUBLE_ARROW","=>",467],["T_WHITESPACE"," ",467],["T_VARIABLE","$max_depth",467],",",["T_WHITESPACE","\n      ",467],")",";",["T_WHITESPACE","\n      ",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(",["T_VARIABLE","$nid",469],")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n        ",469],["T_VARIABLE","$active_trail",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","getActiveTrailIds",470],"(",["T_VARIABLE","$bid",470],",",["T_WHITESPACE"," ",470],["T_VARIABLE","$link",470],")",";",["T_WHITESPACE","\n        ",470],["T_VARIABLE","$tree_parameters",471],"[",["T_CONSTANT_ENCAPSED_STRING","'expanded'",471],"]",["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$active_trail",471],";",["T_WHITESPACE","\n        ",471],["T_VARIABLE","$tree_parameters",472],"[",["T_CONSTANT_ENCAPSED_STRING","'active_trail'",472],"]",["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_VARIABLE","$active_trail",472],";",["T_WHITESPACE","\n        ",472],["T_VARIABLE","$tree_parameters",473],"[",["T_CONSTANT_ENCAPSED_STRING","'active_trail'",473],"]","[","]",["T_WHITESPACE"," ",473],"=",["T_WHITESPACE"," ",473],["T_VARIABLE","$nid",473],";",["T_WHITESPACE","\n      ",473],"}",["T_WHITESPACE","\n\n      ",474],["T_COMMENT","\/\/ Build the tree using the parameters; the resulting tree will be cached.\n",476],["T_WHITESPACE","      ",477],["T_VARIABLE","$tree",477],"[",["T_VARIABLE","$cid",477],"]",["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","bookTreeBuild",477],"(",["T_VARIABLE","$bid",477],",",["T_WHITESPACE"," ",477],["T_VARIABLE","$tree_parameters",477],")",";",["T_WHITESPACE","\n    ",477],"}",["T_WHITESPACE","\n\n    ",478],["T_RETURN","return",480],["T_WHITESPACE"," ",480],["T_VARIABLE","$tree",480],"[",["T_VARIABLE","$cid",480],"]",";",["T_WHITESPACE","\n  ",480],"}",["T_WHITESPACE","\n\n  ",481],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",483],["T_WHITESPACE","\n  ",485],["T_PUBLIC","public",486],["T_WHITESPACE"," ",486],["T_FUNCTION","function",486],["T_WHITESPACE"," ",486],["T_STRING","getActiveTrailIds",486],"(",["T_VARIABLE","$bid",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$link",486],")",["T_WHITESPACE"," ",486],"{",["T_WHITESPACE","\n    ",486],["T_COMMENT","\/\/ The tree is for a single item, so we need to match the values in its\n",487],["T_WHITESPACE","    ",488],["T_COMMENT","\/\/ p columns and 0 (the top level) with the plid values of other links.\n",488],["T_WHITESPACE","    ",489],["T_VARIABLE","$active_trail",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_ARRAY","array",489],"(",["T_LNUMBER","0",489],")",";",["T_WHITESPACE","\n    ",489],["T_FOR","for",490],["T_WHITESPACE"," ",490],"(",["T_VARIABLE","$i",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_LNUMBER","1",490],";",["T_WHITESPACE"," ",490],["T_VARIABLE","$i",490],["T_WHITESPACE"," ",490],"<",["T_WHITESPACE"," ",490],["T_STATIC","static",490],["T_DOUBLE_COLON","::",490],["T_STRING","BOOK_MAX_DEPTH",490],";",["T_WHITESPACE"," ",490],["T_VARIABLE","$i",490],["T_INC","++",490],")",["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n      ",490],["T_IF","if",491],["T_WHITESPACE"," ",491],"(","!",["T_EMPTY","empty",491],"(",["T_VARIABLE","$link",491],"[","\"",["T_ENCAPSED_AND_WHITESPACE","p",491],["T_VARIABLE","$i",491],"\"","]",")",")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n        ",491],["T_VARIABLE","$active_trail",492],"[","]",["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_VARIABLE","$link",492],"[","\"",["T_ENCAPSED_AND_WHITESPACE","p",492],["T_VARIABLE","$i",492],"\"","]",";",["T_WHITESPACE","\n      ",492],"}",["T_WHITESPACE","\n    ",493],"}",["T_WHITESPACE","\n    ",494],["T_RETURN","return",495],["T_WHITESPACE"," ",495],["T_VARIABLE","$active_trail",495],";",["T_WHITESPACE","\n  ",495],"}",["T_WHITESPACE","\n\n  ",496],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",498],["T_WHITESPACE","\n  ",500],["T_PUBLIC","public",501],["T_WHITESPACE"," ",501],["T_FUNCTION","function",501],["T_WHITESPACE"," ",501],["T_STRING","bookTreeOutput",501],"(",["T_ARRAY","array",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$tree",501],")",["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n    ",501],["T_VARIABLE","$items",502],["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","buildItems",502],"(",["T_VARIABLE","$tree",502],")",";",["T_WHITESPACE","\n\n    ",502],["T_VARIABLE","$build",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],"[","]",";",["T_WHITESPACE","\n\n    ",504],["T_IF","if",506],["T_WHITESPACE"," ",506],"(",["T_VARIABLE","$items",506],")",["T_WHITESPACE"," ",506],"{",["T_WHITESPACE","\n      ",506],["T_COMMENT","\/\/ Make sure drupal_render() does not re-order the links.\n",507],["T_WHITESPACE","      ",508],["T_VARIABLE","$build",508],"[",["T_CONSTANT_ENCAPSED_STRING","'#sorted'",508],"]",["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_STRING","TRUE",508],";",["T_WHITESPACE","\n      ",508],["T_COMMENT","\/\/ Get the book id from the last link.\n",509],["T_WHITESPACE","      ",510],["T_VARIABLE","$item",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_STRING","end",510],"(",["T_VARIABLE","$items",510],")",";",["T_WHITESPACE","\n      ",510],["T_COMMENT","\/\/ Add the theme wrapper for outer markup.\n",511],["T_WHITESPACE","      ",512],["T_COMMENT","\/\/ Allow menu-specific theme overrides.\n",512],["T_WHITESPACE","      ",513],["T_VARIABLE","$build",513],"[",["T_CONSTANT_ENCAPSED_STRING","'#theme'",513],"]",["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_CONSTANT_ENCAPSED_STRING","'book_tree__book_toc_'",513],["T_WHITESPACE"," ",513],".",["T_WHITESPACE"," ",513],["T_VARIABLE","$item",513],"[",["T_CONSTANT_ENCAPSED_STRING","'original_link'",513],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bid'",513],"]",";",["T_WHITESPACE","\n      ",513],["T_VARIABLE","$build",514],"[",["T_CONSTANT_ENCAPSED_STRING","'#items'",514],"]",["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_VARIABLE","$items",514],";",["T_WHITESPACE","\n      ",514],["T_COMMENT","\/\/ Set cache tag.\n",515],["T_WHITESPACE","      ",516],["T_VARIABLE","$build",516],"[",["T_CONSTANT_ENCAPSED_STRING","'#cache'",516],"]","[",["T_CONSTANT_ENCAPSED_STRING","'tags'",516],"]","[","]",["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_CONSTANT_ENCAPSED_STRING","'config:system.book.'",516],["T_WHITESPACE"," ",516],".",["T_WHITESPACE"," ",516],["T_VARIABLE","$item",516],"[",["T_CONSTANT_ENCAPSED_STRING","'original_link'",516],"]","[",["T_CONSTANT_ENCAPSED_STRING","'bid'",516],"]",";",["T_WHITESPACE","\n    ",516],"}",["T_WHITESPACE","\n\n    ",517],["T_RETURN","return",519],["T_WHITESPACE"," ",519],["T_VARIABLE","$build",519],";",["T_WHITESPACE","\n  ",519],"}",["T_WHITESPACE","\n\n  ",520],["T_DOC_COMMENT","\/**\n   * Builds the #items property for a book tree's renderable array.\n   *\n   * Helper function for ::bookTreeOutput().\n   *\n   * @param array $tree\n   *   A data structure representing the tree.\n   *\n   * @return array\n   *   The value to use for the #items property of a renderable menu.\n   *\/",522],["T_WHITESPACE","\n  ",532],["T_PROTECTED","protected",533],["T_WHITESPACE"," ",533],["T_FUNCTION","function",533],["T_WHITESPACE"," ",533],["T_STRING","buildItems",533],"(",["T_ARRAY","array",533],["T_WHITESPACE"," ",533],["T_VARIABLE","$tree",533],")",["T_WHITESPACE"," ",533],"{",["T_WHITESPACE","\n    ",533],["T_VARIABLE","$items",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],"[","]",";",["T_WHITESPACE","\n\n    ",534],["T_FOREACH","foreach",536],["T_WHITESPACE"," ",536],"(",["T_VARIABLE","$tree",536],["T_WHITESPACE"," ",536],["T_AS","as",536],["T_WHITESPACE"," ",536],["T_VARIABLE","$data",536],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n      ",536],["T_VARIABLE","$element",537],["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],"[","]",";",["T_WHITESPACE","\n\n      ",537],["T_COMMENT","\/\/ Generally we only deal with visible links, but just in case.\n",539],["T_WHITESPACE","      ",540],["T_IF","if",540],["T_WHITESPACE"," ",540],"(","!",["T_VARIABLE","$data",540],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",540],"]","[",["T_CONSTANT_ENCAPSED_STRING","'access'",540],"]",")",["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n        ",540],["T_CONTINUE","continue",541],";",["T_WHITESPACE","\n      ",541],"}",["T_WHITESPACE","\n      ",542],["T_COMMENT","\/\/ Set a class for the <li> tag. Since $data['below'] may contain local\n",543],["T_WHITESPACE","      ",544],["T_COMMENT","\/\/ tasks, only set 'expanded' to true if the link also has children within\n",544],["T_WHITESPACE","      ",545],["T_COMMENT","\/\/ the current book.\n",545],["T_WHITESPACE","      ",546],["T_VARIABLE","$element",546],"[",["T_CONSTANT_ENCAPSED_STRING","'is_expanded'",546],"]",["T_WHITESPACE"," ",546],"=",["T_WHITESPACE"," ",546],["T_STRING","FALSE",546],";",["T_WHITESPACE","\n      ",546],["T_VARIABLE","$element",547],"[",["T_CONSTANT_ENCAPSED_STRING","'is_collapsed'",547],"]",["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_STRING","FALSE",547],";",["T_WHITESPACE","\n      ",547],["T_IF","if",548],["T_WHITESPACE"," ",548],"(",["T_VARIABLE","$data",548],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",548],"]","[",["T_CONSTANT_ENCAPSED_STRING","'has_children'",548],"]",["T_WHITESPACE"," ",548],["T_BOOLEAN_AND","&&",548],["T_WHITESPACE"," ",548],["T_VARIABLE","$data",548],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",548],"]",")",["T_WHITESPACE"," ",548],"{",["T_WHITESPACE","\n        ",548],["T_VARIABLE","$element",549],"[",["T_CONSTANT_ENCAPSED_STRING","'is_expanded'",549],"]",["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_STRING","TRUE",549],";",["T_WHITESPACE","\n      ",549],"}",["T_WHITESPACE","\n      ",550],["T_ELSEIF","elseif",551],["T_WHITESPACE"," ",551],"(",["T_VARIABLE","$data",551],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",551],"]","[",["T_CONSTANT_ENCAPSED_STRING","'has_children'",551],"]",")",["T_WHITESPACE"," ",551],"{",["T_WHITESPACE","\n        ",551],["T_VARIABLE","$element",552],"[",["T_CONSTANT_ENCAPSED_STRING","'is_collapsed'",552],"]",["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_STRING","TRUE",552],";",["T_WHITESPACE","\n      ",552],"}",["T_WHITESPACE","\n\n      ",553],["T_COMMENT","\/\/ Set a helper variable to indicate whether the link is in the active\n",555],["T_WHITESPACE","      ",556],["T_COMMENT","\/\/ trail.\n",556],["T_WHITESPACE","      ",557],["T_VARIABLE","$element",557],"[",["T_CONSTANT_ENCAPSED_STRING","'in_active_trail'",557],"]",["T_WHITESPACE"," ",557],"=",["T_WHITESPACE"," ",557],["T_STRING","FALSE",557],";",["T_WHITESPACE","\n      ",557],["T_IF","if",558],["T_WHITESPACE"," ",558],"(",["T_VARIABLE","$data",558],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",558],"]","[",["T_CONSTANT_ENCAPSED_STRING","'in_active_trail'",558],"]",")",["T_WHITESPACE"," ",558],"{",["T_WHITESPACE","\n        ",558],["T_VARIABLE","$element",559],"[",["T_CONSTANT_ENCAPSED_STRING","'in_active_trail'",559],"]",["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_STRING","TRUE",559],";",["T_WHITESPACE","\n      ",559],"}",["T_WHITESPACE","\n\n      ",560],["T_COMMENT","\/\/ Allow book-specific theme overrides.\n",562],["T_WHITESPACE","      ",563],["T_VARIABLE","$element",563],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",563],"]",["T_WHITESPACE"," ",563],"=",["T_WHITESPACE"," ",563],["T_NEW","new",563],["T_WHITESPACE"," ",563],["T_STRING","Attribute",563],"(",")",";",["T_WHITESPACE","\n      ",563],["T_VARIABLE","$element",564],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",564],"]",["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_VARIABLE","$data",564],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",564],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title'",564],"]",";",["T_WHITESPACE","\n      ",564],["T_VARIABLE","$node",565],["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],["T_VARIABLE","$this",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","entityManager",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","getStorage",565],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",565],")",["T_OBJECT_OPERATOR","->",565],["T_STRING","load",565],"(",["T_VARIABLE","$data",565],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",565],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",565],"]",")",";",["T_WHITESPACE","\n      ",565],["T_VARIABLE","$element",566],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",566],"]",["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_VARIABLE","$node",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","urlInfo",566],"(",")",";",["T_WHITESPACE","\n      ",566],["T_VARIABLE","$element",567],"[",["T_CONSTANT_ENCAPSED_STRING","'localized_options'",567],"]",["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],"!",["T_EMPTY","empty",567],"(",["T_VARIABLE","$data",567],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",567],"]","[",["T_CONSTANT_ENCAPSED_STRING","'localized_options'",567],"]",")",["T_WHITESPACE"," ",567],"?",["T_WHITESPACE"," ",567],["T_VARIABLE","$data",567],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",567],"]","[",["T_CONSTANT_ENCAPSED_STRING","'localized_options'",567],"]",["T_WHITESPACE"," ",567],":",["T_WHITESPACE"," ",567],"[","]",";",["T_WHITESPACE","\n      ",567],["T_VARIABLE","$element",568],"[",["T_CONSTANT_ENCAPSED_STRING","'localized_options'",568],"]","[",["T_CONSTANT_ENCAPSED_STRING","'set_active_class'",568],"]",["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_STRING","TRUE",568],";",["T_WHITESPACE","\n      ",568],["T_VARIABLE","$element",569],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",569],"]",["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_VARIABLE","$data",569],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",569],"]",["T_WHITESPACE"," ",569],"?",["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","buildItems",569],"(",["T_VARIABLE","$data",569],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",569],"]",")",["T_WHITESPACE"," ",569],":",["T_WHITESPACE"," ",569],"[","]",";",["T_WHITESPACE","\n      ",569],["T_VARIABLE","$element",570],"[",["T_CONSTANT_ENCAPSED_STRING","'original_link'",570],"]",["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_VARIABLE","$data",570],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",570],"]",";",["T_WHITESPACE","\n      ",570],["T_COMMENT","\/\/ Index using the link's unique nid.\n",571],["T_WHITESPACE","      ",572],["T_VARIABLE","$items",572],"[",["T_VARIABLE","$data",572],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",572],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",572],"]","]",["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_VARIABLE","$element",572],";",["T_WHITESPACE","\n    ",572],"}",["T_WHITESPACE","\n\n    ",573],["T_RETURN","return",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$items",575],";",["T_WHITESPACE","\n  ",575],"}",["T_WHITESPACE","\n\n  ",576],["T_DOC_COMMENT","\/**\n   * Builds a book tree, translates links, and checks access.\n   *\n   * @param int $bid\n   *   The Book ID to find links for.\n   * @param array $parameters\n   *   (optional) An associative array of build parameters. Possible keys:\n   *   - expanded: An array of parent link IDs to return only book links that\n   *     are children of one of the parent link IDs in this list. If empty,\n   *     the whole outline is built, unless 'only_active_trail' is TRUE.\n   *   - active_trail: An array of node IDs, representing the currently active\n   *     book link.\n   *   - only_active_trail: Whether to only return links that are in the active\n   *     trail. This option is ignored if 'expanded' is non-empty.\n   *   - min_depth: The minimum depth of book links in the resulting tree.\n   *     Defaults to 1, which is to build the whole tree for the book.\n   *   - max_depth: The maximum depth of book links in the resulting tree.\n   *   - conditions: An associative array of custom database select query\n   *     condition key\/value pairs; see\n   *     \\Drupal\\book\\BookOutlineStorage::getBookMenuTree() for the actual\n   *     query.\n   *\n   * @return array\n   *   A fully built book tree.\n   *\/",578],["T_WHITESPACE","\n  ",602],["T_PROTECTED","protected",603],["T_WHITESPACE"," ",603],["T_FUNCTION","function",603],["T_WHITESPACE"," ",603],["T_STRING","bookTreeBuild",603],"(",["T_VARIABLE","$bid",603],",",["T_WHITESPACE"," ",603],["T_ARRAY","array",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$parameters",603],["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],["T_ARRAY","array",603],"(",")",")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n    ",603],["T_COMMENT","\/\/ Build the book tree.\n",604],["T_WHITESPACE","    ",605],["T_VARIABLE","$data",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_VARIABLE","$this",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","doBookTreeBuild",605],"(",["T_VARIABLE","$bid",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$parameters",605],")",";",["T_WHITESPACE","\n    ",605],["T_COMMENT","\/\/ Check access for the current user to each item in the tree.\n",606],["T_WHITESPACE","    ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","bookTreeCheckAccess",607],"(",["T_VARIABLE","$data",607],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",607],"]",",",["T_WHITESPACE"," ",607],["T_VARIABLE","$data",607],"[",["T_CONSTANT_ENCAPSED_STRING","'node_links'",607],"]",")",";",["T_WHITESPACE","\n    ",607],["T_RETURN","return",608],["T_WHITESPACE"," ",608],["T_VARIABLE","$data",608],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",608],"]",";",["T_WHITESPACE","\n  ",608],"}",["T_WHITESPACE","\n\n  ",609],["T_DOC_COMMENT","\/**\n   * Builds a book tree.\n   *\n   * This function may be used build the data for a menu tree only, for example\n   * to further massage the data manually before further processing happens.\n   * _menu_tree_check_access() needs to be invoked afterwards.\n   *\n   * @param int $bid\n   *   The book ID to find links for.\n   * @param array $parameters\n   *   (optional) An associative array of build parameters. Possible keys:\n   *   - expanded: An array of parent link IDs to return only book links that\n   *     are children of one of the parent link IDs in this list. If empty,\n   *     the whole outline is built, unless 'only_active_trail' is TRUE.\n   *   - active_trail: An array of node IDs, representing the currently active\n   *     book link.\n   *   - only_active_trail: Whether to only return links that are in the active\n   *     trail. This option is ignored if 'expanded' is non-empty.\n   *   - min_depth: The minimum depth of book links in the resulting tree.\n   *     Defaults to 1, which is to build the whole tree for the book.\n   *   - max_depth: The maximum depth of book links in the resulting tree.\n   *   - conditions: An associative array of custom database select query\n   *     condition key\/value pairs; see\n   *     \\Drupal\\book\\BookOutlineStorage::getBookMenuTree() for the actual\n   *     query.\n   *\n   * @return array\n   *   An array with links representing the tree structure of the book.\n   *\n   * @see \\Drupal\\book\\BookOutlineStorageInterface::getBookMenuTree()\n   *\/",611],["T_WHITESPACE","\n  ",641],["T_PROTECTED","protected",642],["T_WHITESPACE"," ",642],["T_FUNCTION","function",642],["T_WHITESPACE"," ",642],["T_STRING","doBookTreeBuild",642],"(",["T_VARIABLE","$bid",642],",",["T_WHITESPACE"," ",642],["T_ARRAY","array",642],["T_WHITESPACE"," ",642],["T_VARIABLE","$parameters",642],["T_WHITESPACE"," ",642],"=",["T_WHITESPACE"," ",642],["T_ARRAY","array",642],"(",")",")",["T_WHITESPACE"," ",642],"{",["T_WHITESPACE","\n    ",642],["T_COMMENT","\/\/ Static cache of already built menu trees.\n",643],["T_WHITESPACE","    ",644],["T_VARIABLE","$trees",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],"&",["T_STRING","drupal_static",644],"(",["T_METHOD_C","__METHOD__",644],",",["T_WHITESPACE"," ",644],["T_ARRAY","array",644],"(",")",")",";",["T_WHITESPACE","\n    ",644],["T_VARIABLE","$language_interface",645],["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_NS_SEPARATOR","\\",645],["T_STRING","Drupal",645],["T_DOUBLE_COLON","::",645],["T_STRING","languageManager",645],"(",")",["T_OBJECT_OPERATOR","->",645],["T_STRING","getCurrentLanguage",645],"(",")",";",["T_WHITESPACE","\n\n    ",645],["T_COMMENT","\/\/ Build the cache id; sort parents to prevent duplicate storage and remove\n",647],["T_WHITESPACE","    ",648],["T_COMMENT","\/\/ default parameter values.\n",648],["T_WHITESPACE","    ",649],["T_IF","if",649],["T_WHITESPACE"," ",649],"(",["T_ISSET","isset",649],"(",["T_VARIABLE","$parameters",649],"[",["T_CONSTANT_ENCAPSED_STRING","'expanded'",649],"]",")",")",["T_WHITESPACE"," ",649],"{",["T_WHITESPACE","\n      ",649],["T_STRING","sort",650],"(",["T_VARIABLE","$parameters",650],"[",["T_CONSTANT_ENCAPSED_STRING","'expanded'",650],"]",")",";",["T_WHITESPACE","\n    ",650],"}",["T_WHITESPACE","\n    ",651],["T_VARIABLE","$tree_cid",652],["T_WHITESPACE"," ",652],"=",["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","'book-links:'",652],["T_WHITESPACE"," ",652],".",["T_WHITESPACE"," ",652],["T_VARIABLE","$bid",652],["T_WHITESPACE"," ",652],".",["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","':tree-data:'",652],["T_WHITESPACE"," ",652],".",["T_WHITESPACE"," ",652],["T_VARIABLE","$language_interface",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","getId",652],"(",")",["T_WHITESPACE"," ",652],".",["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","':'",652],["T_WHITESPACE"," ",652],".",["T_WHITESPACE"," ",652],["T_STRING","hash",652],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",652],",",["T_WHITESPACE"," ",652],["T_STRING","serialize",652],"(",["T_VARIABLE","$parameters",652],")",")",";",["T_WHITESPACE","\n\n    ",652],["T_COMMENT","\/\/ If we do not have this tree in the static cache, check {cache_data}.\n",654],["T_WHITESPACE","    ",655],["T_IF","if",655],["T_WHITESPACE"," ",655],"(","!",["T_ISSET","isset",655],"(",["T_VARIABLE","$trees",655],"[",["T_VARIABLE","$tree_cid",655],"]",")",")",["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n      ",655],["T_VARIABLE","$cache",656],["T_WHITESPACE"," ",656],"=",["T_WHITESPACE"," ",656],["T_NS_SEPARATOR","\\",656],["T_STRING","Drupal",656],["T_DOUBLE_COLON","::",656],["T_STRING","cache",656],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",656],")",["T_OBJECT_OPERATOR","->",656],["T_STRING","get",656],"(",["T_VARIABLE","$tree_cid",656],")",";",["T_WHITESPACE","\n      ",656],["T_IF","if",657],["T_WHITESPACE"," ",657],"(",["T_VARIABLE","$cache",657],["T_WHITESPACE"," ",657],["T_BOOLEAN_AND","&&",657],["T_WHITESPACE"," ",657],["T_VARIABLE","$cache",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","data",657],")",["T_WHITESPACE"," ",657],"{",["T_WHITESPACE","\n        ",657],["T_VARIABLE","$trees",658],"[",["T_VARIABLE","$tree_cid",658],"]",["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_VARIABLE","$cache",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","data",658],";",["T_WHITESPACE","\n      ",658],"}",["T_WHITESPACE","\n    ",659],"}",["T_WHITESPACE","\n\n    ",660],["T_IF","if",662],["T_WHITESPACE"," ",662],"(","!",["T_ISSET","isset",662],"(",["T_VARIABLE","$trees",662],"[",["T_VARIABLE","$tree_cid",662],"]",")",")",["T_WHITESPACE"," ",662],"{",["T_WHITESPACE","\n      ",662],["T_VARIABLE","$min_depth",663],["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],"(",["T_ISSET","isset",663],"(",["T_VARIABLE","$parameters",663],"[",["T_CONSTANT_ENCAPSED_STRING","'min_depth'",663],"]",")",["T_WHITESPACE"," ",663],"?",["T_WHITESPACE"," ",663],["T_VARIABLE","$parameters",663],"[",["T_CONSTANT_ENCAPSED_STRING","'min_depth'",663],"]",["T_WHITESPACE"," ",663],":",["T_WHITESPACE"," ",663],["T_LNUMBER","1",663],")",";",["T_WHITESPACE","\n      ",663],["T_VARIABLE","$result",664],["T_WHITESPACE"," ",664],"=",["T_WHITESPACE"," ",664],["T_VARIABLE","$this",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","bookOutlineStorage",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","getBookMenuTree",664],"(",["T_VARIABLE","$bid",664],",",["T_WHITESPACE"," ",664],["T_VARIABLE","$parameters",664],",",["T_WHITESPACE"," ",664],["T_VARIABLE","$min_depth",664],",",["T_WHITESPACE"," ",664],["T_STATIC","static",664],["T_DOUBLE_COLON","::",664],["T_STRING","BOOK_MAX_DEPTH",664],")",";",["T_WHITESPACE","\n\n      ",664],["T_COMMENT","\/\/ Build an ordered array of links using the query result object.\n",666],["T_WHITESPACE","      ",667],["T_VARIABLE","$links",667],["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_ARRAY","array",667],"(",")",";",["T_WHITESPACE","\n      ",667],["T_FOREACH","foreach",668],["T_WHITESPACE"," ",668],"(",["T_VARIABLE","$result",668],["T_WHITESPACE"," ",668],["T_AS","as",668],["T_WHITESPACE"," ",668],["T_VARIABLE","$link",668],")",["T_WHITESPACE"," ",668],"{",["T_WHITESPACE","\n        ",668],["T_VARIABLE","$link",669],["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_ARRAY_CAST","(array)",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$link",669],";",["T_WHITESPACE","\n        ",669],["T_VARIABLE","$links",670],"[",["T_VARIABLE","$link",670],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",670],"]","]",["T_WHITESPACE"," ",670],"=",["T_WHITESPACE"," ",670],["T_VARIABLE","$link",670],";",["T_WHITESPACE","\n      ",670],"}",["T_WHITESPACE","\n      ",671],["T_VARIABLE","$active_trail",672],["T_WHITESPACE"," ",672],"=",["T_WHITESPACE"," ",672],"(",["T_ISSET","isset",672],"(",["T_VARIABLE","$parameters",672],"[",["T_CONSTANT_ENCAPSED_STRING","'active_trail'",672],"]",")",["T_WHITESPACE"," ",672],"?",["T_WHITESPACE"," ",672],["T_VARIABLE","$parameters",672],"[",["T_CONSTANT_ENCAPSED_STRING","'active_trail'",672],"]",["T_WHITESPACE"," ",672],":",["T_WHITESPACE"," ",672],["T_ARRAY","array",672],"(",")",")",";",["T_WHITESPACE","\n      ",672],["T_VARIABLE","$data",673],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",673],"]",["T_WHITESPACE"," ",673],"=",["T_WHITESPACE"," ",673],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","buildBookOutlineData",673],"(",["T_VARIABLE","$links",673],",",["T_WHITESPACE"," ",673],["T_VARIABLE","$active_trail",673],",",["T_WHITESPACE"," ",673],["T_VARIABLE","$min_depth",673],")",";",["T_WHITESPACE","\n      ",673],["T_VARIABLE","$data",674],"[",["T_CONSTANT_ENCAPSED_STRING","'node_links'",674],"]",["T_WHITESPACE"," ",674],"=",["T_WHITESPACE"," ",674],["T_ARRAY","array",674],"(",")",";",["T_WHITESPACE","\n      ",674],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","bookTreeCollectNodeLinks",675],"(",["T_VARIABLE","$data",675],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",675],"]",",",["T_WHITESPACE"," ",675],["T_VARIABLE","$data",675],"[",["T_CONSTANT_ENCAPSED_STRING","'node_links'",675],"]",")",";",["T_WHITESPACE","\n\n      ",675],["T_COMMENT","\/\/ Cache the data, if it is not already in the cache.\n",677],["T_WHITESPACE","      ",678],["T_NS_SEPARATOR","\\",678],["T_STRING","Drupal",678],["T_DOUBLE_COLON","::",678],["T_STRING","cache",678],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",678],")",["T_OBJECT_OPERATOR","->",678],["T_STRING","set",678],"(",["T_VARIABLE","$tree_cid",678],",",["T_WHITESPACE"," ",678],["T_VARIABLE","$data",678],",",["T_WHITESPACE"," ",678],["T_STRING","Cache",678],["T_DOUBLE_COLON","::",678],["T_STRING","PERMANENT",678],",",["T_WHITESPACE"," ",678],["T_ARRAY","array",678],"(",["T_CONSTANT_ENCAPSED_STRING","'bid:'",678],["T_WHITESPACE"," ",678],".",["T_WHITESPACE"," ",678],["T_VARIABLE","$bid",678],")",")",";",["T_WHITESPACE","\n      ",678],["T_VARIABLE","$trees",679],"[",["T_VARIABLE","$tree_cid",679],"]",["T_WHITESPACE"," ",679],"=",["T_WHITESPACE"," ",679],["T_VARIABLE","$data",679],";",["T_WHITESPACE","\n    ",679],"}",["T_WHITESPACE","\n\n    ",680],["T_RETURN","return",682],["T_WHITESPACE"," ",682],["T_VARIABLE","$trees",682],"[",["T_VARIABLE","$tree_cid",682],"]",";",["T_WHITESPACE","\n  ",682],"}",["T_WHITESPACE","\n\n  ",683],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",685],["T_WHITESPACE","\n  ",687],["T_PUBLIC","public",688],["T_WHITESPACE"," ",688],["T_FUNCTION","function",688],["T_WHITESPACE"," ",688],["T_STRING","bookTreeCollectNodeLinks",688],"(","&",["T_VARIABLE","$tree",688],",",["T_WHITESPACE"," ",688],"&",["T_VARIABLE","$node_links",688],")",["T_WHITESPACE"," ",688],"{",["T_WHITESPACE","\n    ",688],["T_COMMENT","\/\/ All book links are nodes.\n",689],["T_WHITESPACE","    ",690],["T_COMMENT","\/\/ @todo clean this up.\n",690],["T_WHITESPACE","    ",691],["T_FOREACH","foreach",691],["T_WHITESPACE"," ",691],"(",["T_VARIABLE","$tree",691],["T_WHITESPACE"," ",691],["T_AS","as",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$key",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$v",691],")",["T_WHITESPACE"," ",691],"{",["T_WHITESPACE","\n      ",691],["T_VARIABLE","$nid",692],["T_WHITESPACE"," ",692],"=",["T_WHITESPACE"," ",692],["T_VARIABLE","$v",692],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",692],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",692],"]",";",["T_WHITESPACE","\n      ",692],["T_VARIABLE","$node_links",693],"[",["T_VARIABLE","$nid",693],"]","[",["T_VARIABLE","$tree",693],"[",["T_VARIABLE","$key",693],"]","[",["T_CONSTANT_ENCAPSED_STRING","'link'",693],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",693],"]","]",["T_WHITESPACE"," ",693],"=",["T_WHITESPACE"," ",693],"&",["T_VARIABLE","$tree",693],"[",["T_VARIABLE","$key",693],"]","[",["T_CONSTANT_ENCAPSED_STRING","'link'",693],"]",";",["T_WHITESPACE","\n      ",693],["T_VARIABLE","$tree",694],"[",["T_VARIABLE","$key",694],"]","[",["T_CONSTANT_ENCAPSED_STRING","'link'",694],"]","[",["T_CONSTANT_ENCAPSED_STRING","'access'",694],"]",["T_WHITESPACE"," ",694],"=",["T_WHITESPACE"," ",694],["T_STRING","FALSE",694],";",["T_WHITESPACE","\n      ",694],["T_IF","if",695],["T_WHITESPACE"," ",695],"(",["T_VARIABLE","$tree",695],"[",["T_VARIABLE","$key",695],"]","[",["T_CONSTANT_ENCAPSED_STRING","'below'",695],"]",")",["T_WHITESPACE"," ",695],"{",["T_WHITESPACE","\n        ",695],["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","bookTreeCollectNodeLinks",696],"(",["T_VARIABLE","$tree",696],"[",["T_VARIABLE","$key",696],"]","[",["T_CONSTANT_ENCAPSED_STRING","'below'",696],"]",",",["T_WHITESPACE"," ",696],["T_VARIABLE","$node_links",696],")",";",["T_WHITESPACE","\n      ",696],"}",["T_WHITESPACE","\n    ",697],"}",["T_WHITESPACE","\n  ",698],"}",["T_WHITESPACE","\n\n  ",699],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",701],["T_WHITESPACE","\n  ",703],["T_PUBLIC","public",704],["T_WHITESPACE"," ",704],["T_FUNCTION","function",704],["T_WHITESPACE"," ",704],["T_STRING","bookTreeGetFlat",704],"(",["T_ARRAY","array",704],["T_WHITESPACE"," ",704],["T_VARIABLE","$book_link",704],")",["T_WHITESPACE"," ",704],"{",["T_WHITESPACE","\n    ",704],["T_IF","if",705],["T_WHITESPACE"," ",705],"(","!",["T_ISSET","isset",705],"(",["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","bookTreeFlattened",705],"[",["T_VARIABLE","$book_link",705],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",705],"]","]",")",")",["T_WHITESPACE"," ",705],"{",["T_WHITESPACE","\n      ",705],["T_COMMENT","\/\/ Call $this->bookTreeAllData() to take advantage of caching.\n",706],["T_WHITESPACE","      ",707],["T_VARIABLE","$tree",707],["T_WHITESPACE"," ",707],"=",["T_WHITESPACE"," ",707],["T_VARIABLE","$this",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","bookTreeAllData",707],"(",["T_VARIABLE","$book_link",707],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",707],"]",",",["T_WHITESPACE"," ",707],["T_VARIABLE","$book_link",707],",",["T_WHITESPACE"," ",707],["T_VARIABLE","$book_link",707],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",707],"]",["T_WHITESPACE"," ",707],"+",["T_WHITESPACE"," ",707],["T_LNUMBER","1",707],")",";",["T_WHITESPACE","\n      ",707],["T_VARIABLE","$this",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","bookTreeFlattened",708],"[",["T_VARIABLE","$book_link",708],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",708],"]","]",["T_WHITESPACE"," ",708],"=",["T_WHITESPACE"," ",708],["T_ARRAY","array",708],"(",")",";",["T_WHITESPACE","\n      ",708],["T_VARIABLE","$this",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","flatBookTree",709],"(",["T_VARIABLE","$tree",709],",",["T_WHITESPACE"," ",709],["T_VARIABLE","$this",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","bookTreeFlattened",709],"[",["T_VARIABLE","$book_link",709],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",709],"]","]",")",";",["T_WHITESPACE","\n    ",709],"}",["T_WHITESPACE","\n\n    ",710],["T_RETURN","return",712],["T_WHITESPACE"," ",712],["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","bookTreeFlattened",712],"[",["T_VARIABLE","$book_link",712],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",712],"]","]",";",["T_WHITESPACE","\n  ",712],"}",["T_WHITESPACE","\n\n  ",713],["T_DOC_COMMENT","\/**\n   * Recursively converts a tree of menu links to a flat array.\n   *\n   * @param array $tree\n   *   A tree of menu links in an array.\n   * @param array $flat\n   *   A flat array of the menu links from $tree, passed by reference.\n   *\n   * @see static::bookTreeGetFlat()\n   *\/",715],["T_WHITESPACE","\n  ",724],["T_PROTECTED","protected",725],["T_WHITESPACE"," ",725],["T_FUNCTION","function",725],["T_WHITESPACE"," ",725],["T_STRING","flatBookTree",725],"(",["T_ARRAY","array",725],["T_WHITESPACE"," ",725],["T_VARIABLE","$tree",725],",",["T_WHITESPACE"," ",725],["T_ARRAY","array",725],["T_WHITESPACE"," ",725],"&",["T_VARIABLE","$flat",725],")",["T_WHITESPACE"," ",725],"{",["T_WHITESPACE","\n    ",725],["T_FOREACH","foreach",726],["T_WHITESPACE"," ",726],"(",["T_VARIABLE","$tree",726],["T_WHITESPACE"," ",726],["T_AS","as",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$data",726],")",["T_WHITESPACE"," ",726],"{",["T_WHITESPACE","\n      ",726],["T_VARIABLE","$flat",727],"[",["T_VARIABLE","$data",727],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",727],"]","[",["T_CONSTANT_ENCAPSED_STRING","'nid'",727],"]","]",["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_VARIABLE","$data",727],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",727],"]",";",["T_WHITESPACE","\n      ",727],["T_IF","if",728],["T_WHITESPACE"," ",728],"(",["T_VARIABLE","$data",728],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",728],"]",")",["T_WHITESPACE"," ",728],"{",["T_WHITESPACE","\n        ",728],["T_VARIABLE","$this",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","flatBookTree",729],"(",["T_VARIABLE","$data",729],"[",["T_CONSTANT_ENCAPSED_STRING","'below'",729],"]",",",["T_WHITESPACE"," ",729],["T_VARIABLE","$flat",729],")",";",["T_WHITESPACE","\n      ",729],"}",["T_WHITESPACE","\n    ",730],"}",["T_WHITESPACE","\n  ",731],"}",["T_WHITESPACE","\n\n  ",732],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",734],["T_WHITESPACE","\n  ",736],["T_PUBLIC","public",737],["T_WHITESPACE"," ",737],["T_FUNCTION","function",737],["T_WHITESPACE"," ",737],["T_STRING","loadBookLink",737],"(",["T_VARIABLE","$nid",737],",",["T_WHITESPACE"," ",737],["T_VARIABLE","$translate",737],["T_WHITESPACE"," ",737],"=",["T_WHITESPACE"," ",737],["T_STRING","TRUE",737],")",["T_WHITESPACE"," ",737],"{",["T_WHITESPACE","\n    ",737],["T_VARIABLE","$links",738],["T_WHITESPACE"," ",738],"=",["T_WHITESPACE"," ",738],["T_VARIABLE","$this",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","loadBookLinks",738],"(",["T_ARRAY","array",738],"(",["T_VARIABLE","$nid",738],")",",",["T_WHITESPACE"," ",738],["T_VARIABLE","$translate",738],")",";",["T_WHITESPACE","\n    ",738],["T_RETURN","return",739],["T_WHITESPACE"," ",739],["T_ISSET","isset",739],"(",["T_VARIABLE","$links",739],"[",["T_VARIABLE","$nid",739],"]",")",["T_WHITESPACE"," ",739],"?",["T_WHITESPACE"," ",739],["T_VARIABLE","$links",739],"[",["T_VARIABLE","$nid",739],"]",["T_WHITESPACE"," ",739],":",["T_WHITESPACE"," ",739],["T_STRING","FALSE",739],";",["T_WHITESPACE","\n  ",739],"}",["T_WHITESPACE","\n\n  ",740],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",742],["T_WHITESPACE","\n  ",744],["T_PUBLIC","public",745],["T_WHITESPACE"," ",745],["T_FUNCTION","function",745],["T_WHITESPACE"," ",745],["T_STRING","loadBookLinks",745],"(",["T_VARIABLE","$nids",745],",",["T_WHITESPACE"," ",745],["T_VARIABLE","$translate",745],["T_WHITESPACE"," ",745],"=",["T_WHITESPACE"," ",745],["T_STRING","TRUE",745],")",["T_WHITESPACE"," ",745],"{",["T_WHITESPACE","\n    ",745],["T_VARIABLE","$result",746],["T_WHITESPACE"," ",746],"=",["T_WHITESPACE"," ",746],["T_VARIABLE","$this",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","bookOutlineStorage",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","loadMultiple",746],"(",["T_VARIABLE","$nids",746],",",["T_WHITESPACE"," ",746],["T_VARIABLE","$translate",746],")",";",["T_WHITESPACE","\n    ",746],["T_VARIABLE","$links",747],["T_WHITESPACE"," ",747],"=",["T_WHITESPACE"," ",747],["T_ARRAY","array",747],"(",")",";",["T_WHITESPACE","\n    ",747],["T_FOREACH","foreach",748],["T_WHITESPACE"," ",748],"(",["T_VARIABLE","$result",748],["T_WHITESPACE"," ",748],["T_AS","as",748],["T_WHITESPACE"," ",748],["T_VARIABLE","$link",748],")",["T_WHITESPACE"," ",748],"{",["T_WHITESPACE","\n      ",748],["T_IF","if",749],["T_WHITESPACE"," ",749],"(",["T_VARIABLE","$translate",749],")",["T_WHITESPACE"," ",749],"{",["T_WHITESPACE","\n        ",749],["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","bookLinkTranslate",750],"(",["T_VARIABLE","$link",750],")",";",["T_WHITESPACE","\n      ",750],"}",["T_WHITESPACE","\n      ",751],["T_VARIABLE","$links",752],"[",["T_VARIABLE","$link",752],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",752],"]","]",["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_VARIABLE","$link",752],";",["T_WHITESPACE","\n    ",752],"}",["T_WHITESPACE","\n\n    ",753],["T_RETURN","return",755],["T_WHITESPACE"," ",755],["T_VARIABLE","$links",755],";",["T_WHITESPACE","\n  ",755],"}",["T_WHITESPACE","\n\n  ",756],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",758],["T_WHITESPACE","\n  ",760],["T_PUBLIC","public",761],["T_WHITESPACE"," ",761],["T_FUNCTION","function",761],["T_WHITESPACE"," ",761],["T_STRING","saveBookLink",761],"(",["T_ARRAY","array",761],["T_WHITESPACE"," ",761],["T_VARIABLE","$link",761],",",["T_WHITESPACE"," ",761],["T_VARIABLE","$new",761],")",["T_WHITESPACE"," ",761],"{",["T_WHITESPACE","\n    ",761],["T_COMMENT","\/\/ Keep track of Book IDs for cache clear.\n",762],["T_WHITESPACE","    ",763],["T_VARIABLE","$affected_bids",763],"[",["T_VARIABLE","$link",763],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",763],"]","]",["T_WHITESPACE"," ",763],"=",["T_WHITESPACE"," ",763],["T_VARIABLE","$link",763],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",763],"]",";",["T_WHITESPACE","\n    ",763],["T_VARIABLE","$link",764],["T_WHITESPACE"," ",764],["T_PLUS_EQUAL","+=",764],["T_WHITESPACE"," ",764],["T_VARIABLE","$this",764],["T_OBJECT_OPERATOR","->",764],["T_STRING","getLinkDefaults",764],"(",["T_VARIABLE","$link",764],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",764],"]",")",";",["T_WHITESPACE","\n    ",764],["T_IF","if",765],["T_WHITESPACE"," ",765],"(",["T_VARIABLE","$new",765],")",["T_WHITESPACE"," ",765],"{",["T_WHITESPACE","\n      ",765],["T_COMMENT","\/\/ Insert new.\n",766],["T_WHITESPACE","      ",767],["T_VARIABLE","$parents",767],["T_WHITESPACE"," ",767],"=",["T_WHITESPACE"," ",767],["T_VARIABLE","$this",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","getBookParents",767],"(",["T_VARIABLE","$link",767],",",["T_WHITESPACE"," ",767],["T_ARRAY_CAST","(array)",767],["T_WHITESPACE"," ",767],["T_VARIABLE","$this",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","loadBookLink",767],"(",["T_VARIABLE","$link",767],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",767],"]",",",["T_WHITESPACE"," ",767],["T_STRING","FALSE",767],")",")",";",["T_WHITESPACE","\n      ",767],["T_VARIABLE","$this",768],["T_OBJECT_OPERATOR","->",768],["T_STRING","bookOutlineStorage",768],["T_OBJECT_OPERATOR","->",768],["T_STRING","insert",768],"(",["T_VARIABLE","$link",768],",",["T_WHITESPACE"," ",768],["T_VARIABLE","$parents",768],")",";",["T_WHITESPACE","\n\n      ",768],["T_COMMENT","\/\/ Update the has_children status of the parent.\n",770],["T_WHITESPACE","      ",771],["T_VARIABLE","$this",771],["T_OBJECT_OPERATOR","->",771],["T_STRING","updateParent",771],"(",["T_VARIABLE","$link",771],")",";",["T_WHITESPACE","\n    ",771],"}",["T_WHITESPACE","\n    ",772],["T_ELSE","else",773],["T_WHITESPACE"," ",773],"{",["T_WHITESPACE","\n      ",773],["T_VARIABLE","$original",774],["T_WHITESPACE"," ",774],"=",["T_WHITESPACE"," ",774],["T_VARIABLE","$this",774],["T_OBJECT_OPERATOR","->",774],["T_STRING","loadBookLink",774],"(",["T_VARIABLE","$link",774],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",774],"]",",",["T_WHITESPACE"," ",774],["T_STRING","FALSE",774],")",";",["T_WHITESPACE","\n      ",774],["T_COMMENT","\/\/ Using the Book ID as the key keeps this unique.\n",775],["T_WHITESPACE","      ",776],["T_VARIABLE","$affected_bids",776],"[",["T_VARIABLE","$original",776],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",776],"]","]",["T_WHITESPACE"," ",776],"=",["T_WHITESPACE"," ",776],["T_VARIABLE","$original",776],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",776],"]",";",["T_WHITESPACE","\n      ",776],["T_COMMENT","\/\/ Handle links that are moving.\n",777],["T_WHITESPACE","      ",778],["T_IF","if",778],["T_WHITESPACE"," ",778],"(",["T_VARIABLE","$link",778],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",778],"]",["T_WHITESPACE"," ",778],["T_IS_NOT_EQUAL","!=",778],["T_WHITESPACE"," ",778],["T_VARIABLE","$original",778],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",778],"]",["T_WHITESPACE"," ",778],["T_BOOLEAN_OR","||",778],["T_WHITESPACE"," ",778],["T_VARIABLE","$link",778],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",778],"]",["T_WHITESPACE"," ",778],["T_IS_NOT_EQUAL","!=",778],["T_WHITESPACE"," ",778],["T_VARIABLE","$original",778],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",778],"]",")",["T_WHITESPACE"," ",778],"{",["T_WHITESPACE","\n        ",778],["T_COMMENT","\/\/ Update the bid for this page and all children.\n",779],["T_WHITESPACE","        ",780],["T_IF","if",780],["T_WHITESPACE"," ",780],"(",["T_VARIABLE","$link",780],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",780],"]",["T_WHITESPACE"," ",780],["T_IS_EQUAL","==",780],["T_WHITESPACE"," ",780],["T_LNUMBER","0",780],")",["T_WHITESPACE"," ",780],"{",["T_WHITESPACE","\n          ",780],["T_VARIABLE","$link",781],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",781],"]",["T_WHITESPACE"," ",781],"=",["T_WHITESPACE"," ",781],["T_LNUMBER","1",781],";",["T_WHITESPACE","\n          ",781],["T_VARIABLE","$parent",782],["T_WHITESPACE"," ",782],"=",["T_WHITESPACE"," ",782],["T_ARRAY","array",782],"(",")",";",["T_WHITESPACE","\n        ",782],"}",["T_WHITESPACE","\n        ",783],["T_COMMENT","\/\/ In case the form did not specify a proper PID we use the BID as new\n",784],["T_WHITESPACE","        ",785],["T_COMMENT","\/\/ parent.\n",785],["T_WHITESPACE","        ",786],["T_ELSEIF","elseif",786],["T_WHITESPACE"," ",786],"(","(",["T_VARIABLE","$parent_link",786],["T_WHITESPACE"," ",786],"=",["T_WHITESPACE"," ",786],["T_VARIABLE","$this",786],["T_OBJECT_OPERATOR","->",786],["T_STRING","loadBookLink",786],"(",["T_VARIABLE","$link",786],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",786],"]",",",["T_WHITESPACE"," ",786],["T_STRING","FALSE",786],")",")",["T_WHITESPACE"," ",786],["T_BOOLEAN_AND","&&",786],["T_WHITESPACE"," ",786],["T_VARIABLE","$parent_link",786],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",786],"]",["T_WHITESPACE"," ",786],["T_IS_NOT_EQUAL","!=",786],["T_WHITESPACE"," ",786],["T_VARIABLE","$link",786],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",786],"]",")",["T_WHITESPACE"," ",786],"{",["T_WHITESPACE","\n          ",786],["T_VARIABLE","$link",787],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",787],"]",["T_WHITESPACE"," ",787],"=",["T_WHITESPACE"," ",787],["T_VARIABLE","$link",787],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",787],"]",";",["T_WHITESPACE","\n          ",787],["T_VARIABLE","$parent",788],["T_WHITESPACE"," ",788],"=",["T_WHITESPACE"," ",788],["T_VARIABLE","$this",788],["T_OBJECT_OPERATOR","->",788],["T_STRING","loadBookLink",788],"(",["T_VARIABLE","$link",788],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",788],"]",",",["T_WHITESPACE"," ",788],["T_STRING","FALSE",788],")",";",["T_WHITESPACE","\n          ",788],["T_VARIABLE","$link",789],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",789],"]",["T_WHITESPACE"," ",789],"=",["T_WHITESPACE"," ",789],["T_VARIABLE","$parent",789],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",789],"]",["T_WHITESPACE"," ",789],"+",["T_WHITESPACE"," ",789],["T_LNUMBER","1",789],";",["T_WHITESPACE","\n        ",789],"}",["T_WHITESPACE","\n        ",790],["T_ELSE","else",791],["T_WHITESPACE"," ",791],"{",["T_WHITESPACE","\n          ",791],["T_VARIABLE","$parent",792],["T_WHITESPACE"," ",792],"=",["T_WHITESPACE"," ",792],["T_VARIABLE","$this",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","loadBookLink",792],"(",["T_VARIABLE","$link",792],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",792],"]",",",["T_WHITESPACE"," ",792],["T_STRING","FALSE",792],")",";",["T_WHITESPACE","\n          ",792],["T_VARIABLE","$link",793],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",793],"]",["T_WHITESPACE"," ",793],"=",["T_WHITESPACE"," ",793],["T_VARIABLE","$parent",793],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",793],"]",["T_WHITESPACE"," ",793],"+",["T_WHITESPACE"," ",793],["T_LNUMBER","1",793],";",["T_WHITESPACE","\n        ",793],"}",["T_WHITESPACE","\n        ",794],["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","setParents",795],"(",["T_VARIABLE","$link",795],",",["T_WHITESPACE"," ",795],["T_VARIABLE","$parent",795],")",";",["T_WHITESPACE","\n        ",795],["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","moveChildren",796],"(",["T_VARIABLE","$link",796],",",["T_WHITESPACE"," ",796],["T_VARIABLE","$original",796],")",";",["T_WHITESPACE","\n\n        ",796],["T_COMMENT","\/\/ Update the has_children status of the original parent.\n",798],["T_WHITESPACE","        ",799],["T_VARIABLE","$this",799],["T_OBJECT_OPERATOR","->",799],["T_STRING","updateOriginalParent",799],"(",["T_VARIABLE","$original",799],")",";",["T_WHITESPACE","\n        ",799],["T_COMMENT","\/\/ Update the has_children status of the new parent.\n",800],["T_WHITESPACE","        ",801],["T_VARIABLE","$this",801],["T_OBJECT_OPERATOR","->",801],["T_STRING","updateParent",801],"(",["T_VARIABLE","$link",801],")",";",["T_WHITESPACE","\n      ",801],"}",["T_WHITESPACE","\n      ",802],["T_COMMENT","\/\/ Update the weight and pid.\n",803],["T_WHITESPACE","      ",804],["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","bookOutlineStorage",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","update",804],"(",["T_VARIABLE","$link",804],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",804],"]",",",["T_WHITESPACE"," ",804],["T_ARRAY","array",804],"(",["T_WHITESPACE","\n        ",804],["T_CONSTANT_ENCAPSED_STRING","'weight'",805],["T_WHITESPACE"," ",805],["T_DOUBLE_ARROW","=>",805],["T_WHITESPACE"," ",805],["T_VARIABLE","$link",805],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",805],"]",",",["T_WHITESPACE","\n        ",805],["T_CONSTANT_ENCAPSED_STRING","'pid'",806],["T_WHITESPACE"," ",806],["T_DOUBLE_ARROW","=>",806],["T_WHITESPACE"," ",806],["T_VARIABLE","$link",806],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",806],"]",",",["T_WHITESPACE","\n        ",806],["T_CONSTANT_ENCAPSED_STRING","'bid'",807],["T_WHITESPACE"," ",807],["T_DOUBLE_ARROW","=>",807],["T_WHITESPACE"," ",807],["T_VARIABLE","$link",807],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",807],"]",",",["T_WHITESPACE","\n      ",807],")",")",";",["T_WHITESPACE","\n    ",808],"}",["T_WHITESPACE","\n    ",809],["T_VARIABLE","$cache_tags",810],["T_WHITESPACE"," ",810],"=",["T_WHITESPACE"," ",810],"[","]",";",["T_WHITESPACE","\n    ",810],["T_FOREACH","foreach",811],["T_WHITESPACE"," ",811],"(",["T_VARIABLE","$affected_bids",811],["T_WHITESPACE"," ",811],["T_AS","as",811],["T_WHITESPACE"," ",811],["T_VARIABLE","$bid",811],")",["T_WHITESPACE"," ",811],"{",["T_WHITESPACE","\n      ",811],["T_VARIABLE","$cache_tags",812],"[","]",["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'bid:'",812],["T_WHITESPACE"," ",812],".",["T_WHITESPACE"," ",812],["T_VARIABLE","$bid",812],";",["T_WHITESPACE","\n    ",812],"}",["T_WHITESPACE","\n    ",813],["T_STRING","Cache",814],["T_DOUBLE_COLON","::",814],["T_STRING","invalidateTags",814],"(",["T_VARIABLE","$cache_tags",814],")",";",["T_WHITESPACE","\n    ",814],["T_RETURN","return",815],["T_WHITESPACE"," ",815],["T_VARIABLE","$link",815],";",["T_WHITESPACE","\n  ",815],"}",["T_WHITESPACE","\n\n  ",816],["T_DOC_COMMENT","\/**\n   * Moves children from the original parent to the updated link.\n   *\n   * @param array $link\n   *   The link being saved.\n   * @param array $original\n   *   The original parent of $link.\n   *\/",818],["T_WHITESPACE","\n  ",825],["T_PROTECTED","protected",826],["T_WHITESPACE"," ",826],["T_FUNCTION","function",826],["T_WHITESPACE"," ",826],["T_STRING","moveChildren",826],"(",["T_ARRAY","array",826],["T_WHITESPACE"," ",826],["T_VARIABLE","$link",826],",",["T_WHITESPACE"," ",826],["T_ARRAY","array",826],["T_WHITESPACE"," ",826],["T_VARIABLE","$original",826],")",["T_WHITESPACE"," ",826],"{",["T_WHITESPACE","\n    ",826],["T_VARIABLE","$p",827],["T_WHITESPACE"," ",827],"=",["T_WHITESPACE"," ",827],["T_CONSTANT_ENCAPSED_STRING","'p1'",827],";",["T_WHITESPACE","\n    ",827],["T_VARIABLE","$expressions",828],["T_WHITESPACE"," ",828],"=",["T_WHITESPACE"," ",828],["T_ARRAY","array",828],"(",")",";",["T_WHITESPACE","\n    ",828],["T_FOR","for",829],["T_WHITESPACE"," ",829],"(",["T_VARIABLE","$i",829],["T_WHITESPACE"," ",829],"=",["T_WHITESPACE"," ",829],["T_LNUMBER","1",829],";",["T_WHITESPACE"," ",829],["T_VARIABLE","$i",829],["T_WHITESPACE"," ",829],["T_IS_SMALLER_OR_EQUAL","<=",829],["T_WHITESPACE"," ",829],["T_VARIABLE","$link",829],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",829],"]",";",["T_WHITESPACE"," ",829],["T_VARIABLE","$p",829],["T_WHITESPACE"," ",829],"=",["T_WHITESPACE"," ",829],["T_CONSTANT_ENCAPSED_STRING","'p'",829],["T_WHITESPACE"," ",829],".",["T_WHITESPACE"," ",829],["T_INC","++",829],["T_VARIABLE","$i",829],")",["T_WHITESPACE"," ",829],"{",["T_WHITESPACE","\n      ",829],["T_VARIABLE","$expressions",830],"[","]",["T_WHITESPACE"," ",830],"=",["T_WHITESPACE"," ",830],["T_ARRAY","array",830],"(",["T_VARIABLE","$p",830],",",["T_WHITESPACE"," ",830],"\"",["T_ENCAPSED_AND_WHITESPACE",":p_",830],["T_VARIABLE","$i",830],"\"",",",["T_WHITESPACE"," ",830],["T_ARRAY","array",830],"(","\"",["T_ENCAPSED_AND_WHITESPACE",":p_",830],["T_VARIABLE","$i",830],"\"",["T_WHITESPACE"," ",830],["T_DOUBLE_ARROW","=>",830],["T_WHITESPACE"," ",830],["T_VARIABLE","$link",830],"[",["T_VARIABLE","$p",830],"]",")",")",";",["T_WHITESPACE","\n    ",830],"}",["T_WHITESPACE","\n    ",831],["T_VARIABLE","$j",832],["T_WHITESPACE"," ",832],"=",["T_WHITESPACE"," ",832],["T_VARIABLE","$original",832],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",832],"]",["T_WHITESPACE"," ",832],"+",["T_WHITESPACE"," ",832],["T_LNUMBER","1",832],";",["T_WHITESPACE","\n    ",832],["T_WHILE","while",833],["T_WHITESPACE"," ",833],"(",["T_VARIABLE","$i",833],["T_WHITESPACE"," ",833],["T_IS_SMALLER_OR_EQUAL","<=",833],["T_WHITESPACE"," ",833],["T_STATIC","static",833],["T_DOUBLE_COLON","::",833],["T_STRING","BOOK_MAX_DEPTH",833],["T_WHITESPACE"," ",833],["T_BOOLEAN_AND","&&",833],["T_WHITESPACE"," ",833],["T_VARIABLE","$j",833],["T_WHITESPACE"," ",833],["T_IS_SMALLER_OR_EQUAL","<=",833],["T_WHITESPACE"," ",833],["T_STATIC","static",833],["T_DOUBLE_COLON","::",833],["T_STRING","BOOK_MAX_DEPTH",833],")",["T_WHITESPACE"," ",833],"{",["T_WHITESPACE","\n      ",833],["T_VARIABLE","$expressions",834],"[","]",["T_WHITESPACE"," ",834],"=",["T_WHITESPACE"," ",834],["T_ARRAY","array",834],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",834],["T_WHITESPACE"," ",834],".",["T_WHITESPACE"," ",834],["T_VARIABLE","$i",834],["T_INC","++",834],",",["T_WHITESPACE"," ",834],["T_CONSTANT_ENCAPSED_STRING","'p'",834],["T_WHITESPACE"," ",834],".",["T_WHITESPACE"," ",834],["T_VARIABLE","$j",834],["T_INC","++",834],",",["T_WHITESPACE"," ",834],["T_ARRAY","array",834],"(",")",")",";",["T_WHITESPACE","\n    ",834],"}",["T_WHITESPACE","\n    ",835],["T_WHILE","while",836],["T_WHITESPACE"," ",836],"(",["T_VARIABLE","$i",836],["T_WHITESPACE"," ",836],["T_IS_SMALLER_OR_EQUAL","<=",836],["T_WHITESPACE"," ",836],["T_STATIC","static",836],["T_DOUBLE_COLON","::",836],["T_STRING","BOOK_MAX_DEPTH",836],")",["T_WHITESPACE"," ",836],"{",["T_WHITESPACE","\n      ",836],["T_VARIABLE","$expressions",837],"[","]",["T_WHITESPACE"," ",837],"=",["T_WHITESPACE"," ",837],["T_ARRAY","array",837],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",837],["T_WHITESPACE"," ",837],".",["T_WHITESPACE"," ",837],["T_VARIABLE","$i",837],["T_INC","++",837],",",["T_WHITESPACE"," ",837],["T_LNUMBER","0",837],",",["T_WHITESPACE"," ",837],["T_ARRAY","array",837],"(",")",")",";",["T_WHITESPACE","\n    ",837],"}",["T_WHITESPACE","\n\n    ",838],["T_VARIABLE","$shift",840],["T_WHITESPACE"," ",840],"=",["T_WHITESPACE"," ",840],["T_VARIABLE","$link",840],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",840],"]",["T_WHITESPACE"," ",840],"-",["T_WHITESPACE"," ",840],["T_VARIABLE","$original",840],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",840],"]",";",["T_WHITESPACE","\n    ",840],["T_IF","if",841],["T_WHITESPACE"," ",841],"(",["T_VARIABLE","$shift",841],["T_WHITESPACE"," ",841],">",["T_WHITESPACE"," ",841],["T_LNUMBER","0",841],")",["T_WHITESPACE"," ",841],"{",["T_WHITESPACE","\n      ",841],["T_COMMENT","\/\/ The order of expressions must be reversed so the new values don't\n",842],["T_WHITESPACE","      ",843],["T_COMMENT","\/\/ overwrite the old ones before they can be used because \"Single-table\n",843],["T_WHITESPACE","      ",844],["T_COMMENT","\/\/ UPDATE assignments are generally evaluated from left to right\"\n",844],["T_WHITESPACE","      ",845],["T_COMMENT","\/\/ @see http:\/\/dev.mysql.com\/doc\/refman\/5.0\/en\/update.html\n",845],["T_WHITESPACE","      ",846],["T_VARIABLE","$expressions",846],["T_WHITESPACE"," ",846],"=",["T_WHITESPACE"," ",846],["T_STRING","array_reverse",846],"(",["T_VARIABLE","$expressions",846],")",";",["T_WHITESPACE","\n    ",846],"}",["T_WHITESPACE","\n\n    ",847],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","bookOutlineStorage",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","updateMovedChildren",849],"(",["T_VARIABLE","$link",849],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",849],"]",",",["T_WHITESPACE"," ",849],["T_VARIABLE","$original",849],",",["T_WHITESPACE"," ",849],["T_VARIABLE","$expressions",849],",",["T_WHITESPACE"," ",849],["T_VARIABLE","$shift",849],")",";",["T_WHITESPACE","\n  ",849],"}",["T_WHITESPACE","\n\n  ",850],["T_DOC_COMMENT","\/**\n   * Sets the has_children flag of the parent of the node.\n   *\n   * This method is mostly called when a book link is moved\/created etc. So we\n   * want to update the has_children flag of the new parent book link.\n   *\n   * @param array $link\n   *   The book link, data reflecting its new position, whose new parent we want\n   *   to update.\n   *\n   * @return bool\n   *   TRUE if the update was successful (either there is no parent to update,\n   *   or the parent was updated successfully), FALSE on failure.\n   *\/",852],["T_WHITESPACE","\n  ",865],["T_PROTECTED","protected",866],["T_WHITESPACE"," ",866],["T_FUNCTION","function",866],["T_WHITESPACE"," ",866],["T_STRING","updateParent",866],"(",["T_ARRAY","array",866],["T_WHITESPACE"," ",866],["T_VARIABLE","$link",866],")",["T_WHITESPACE"," ",866],"{",["T_WHITESPACE","\n    ",866],["T_IF","if",867],["T_WHITESPACE"," ",867],"(",["T_VARIABLE","$link",867],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",867],"]",["T_WHITESPACE"," ",867],["T_IS_EQUAL","==",867],["T_WHITESPACE"," ",867],["T_LNUMBER","0",867],")",["T_WHITESPACE"," ",867],"{",["T_WHITESPACE","\n      ",867],["T_COMMENT","\/\/ Nothing to update.\n",868],["T_WHITESPACE","      ",869],["T_RETURN","return",869],["T_WHITESPACE"," ",869],["T_STRING","TRUE",869],";",["T_WHITESPACE","\n    ",869],"}",["T_WHITESPACE","\n    ",870],["T_RETURN","return",871],["T_WHITESPACE"," ",871],["T_VARIABLE","$this",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","bookOutlineStorage",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","update",871],"(",["T_VARIABLE","$link",871],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",871],"]",",",["T_WHITESPACE"," ",871],["T_ARRAY","array",871],"(",["T_CONSTANT_ENCAPSED_STRING","'has_children'",871],["T_WHITESPACE"," ",871],["T_DOUBLE_ARROW","=>",871],["T_WHITESPACE"," ",871],["T_LNUMBER","1",871],")",")",";",["T_WHITESPACE","\n  ",871],"}",["T_WHITESPACE","\n\n  ",872],["T_DOC_COMMENT","\/**\n   * Updates the has_children flag of the parent of the original node.\n   *\n   * This method is called when a book link is moved or deleted. So we want to\n   * update the has_children flag of the parent node.\n   *\n   * @param array $original\n   *   The original link whose parent we want to update.\n   *\n   * @return bool\n   *   TRUE if the update was successful (either there was no original parent to\n   *   update, or the original parent was updated successfully), FALSE on\n   *   failure.\n   *\/",874],["T_WHITESPACE","\n  ",887],["T_PROTECTED","protected",888],["T_WHITESPACE"," ",888],["T_FUNCTION","function",888],["T_WHITESPACE"," ",888],["T_STRING","updateOriginalParent",888],"(",["T_ARRAY","array",888],["T_WHITESPACE"," ",888],["T_VARIABLE","$original",888],")",["T_WHITESPACE"," ",888],"{",["T_WHITESPACE","\n    ",888],["T_IF","if",889],["T_WHITESPACE"," ",889],"(",["T_VARIABLE","$original",889],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",889],"]",["T_WHITESPACE"," ",889],["T_IS_EQUAL","==",889],["T_WHITESPACE"," ",889],["T_LNUMBER","0",889],")",["T_WHITESPACE"," ",889],"{",["T_WHITESPACE","\n      ",889],["T_COMMENT","\/\/ There were no parents of this link. Nothing to update.\n",890],["T_WHITESPACE","      ",891],["T_RETURN","return",891],["T_WHITESPACE"," ",891],["T_STRING","TRUE",891],";",["T_WHITESPACE","\n    ",891],"}",["T_WHITESPACE","\n    ",892],["T_COMMENT","\/\/ Check if $original had at least one child.\n",893],["T_WHITESPACE","    ",894],["T_VARIABLE","$original_number_of_children",894],["T_WHITESPACE"," ",894],"=",["T_WHITESPACE"," ",894],["T_VARIABLE","$this",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","bookOutlineStorage",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","countOriginalLinkChildren",894],"(",["T_VARIABLE","$original",894],")",";",["T_WHITESPACE","\n\n    ",894],["T_VARIABLE","$parent_has_children",896],["T_WHITESPACE"," ",896],"=",["T_WHITESPACE"," ",896],"(",["T_BOOL_CAST","(bool)",896],["T_WHITESPACE"," ",896],["T_VARIABLE","$original_number_of_children",896],")",["T_WHITESPACE"," ",896],"?",["T_WHITESPACE"," ",896],["T_LNUMBER","1",896],["T_WHITESPACE"," ",896],":",["T_WHITESPACE"," ",896],["T_LNUMBER","0",896],";",["T_WHITESPACE","\n    ",896],["T_COMMENT","\/\/ Update the parent. If the original link did not have children, then the\n",897],["T_WHITESPACE","    ",898],["T_COMMENT","\/\/ parent now does not have children. If the original had children, then the\n",898],["T_WHITESPACE","    ",899],["T_COMMENT","\/\/ the parent has children now (still).\n",899],["T_WHITESPACE","    ",900],["T_RETURN","return",900],["T_WHITESPACE"," ",900],["T_VARIABLE","$this",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","bookOutlineStorage",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","update",900],"(",["T_VARIABLE","$original",900],"[",["T_CONSTANT_ENCAPSED_STRING","'pid'",900],"]",",",["T_WHITESPACE"," ",900],["T_ARRAY","array",900],"(",["T_CONSTANT_ENCAPSED_STRING","'has_children'",900],["T_WHITESPACE"," ",900],["T_DOUBLE_ARROW","=>",900],["T_WHITESPACE"," ",900],["T_VARIABLE","$parent_has_children",900],")",")",";",["T_WHITESPACE","\n  ",900],"}",["T_WHITESPACE","\n\n  ",901],["T_DOC_COMMENT","\/**\n   * Sets the p1 through p9 properties for a book link being saved.\n   *\n   * @param array $link\n   *   The book link to update, passed by reference.\n   * @param array $parent\n   *   The parent values to set.\n   *\/",903],["T_WHITESPACE","\n  ",910],["T_PROTECTED","protected",911],["T_WHITESPACE"," ",911],["T_FUNCTION","function",911],["T_WHITESPACE"," ",911],["T_STRING","setParents",911],"(",["T_ARRAY","array",911],["T_WHITESPACE"," ",911],"&",["T_VARIABLE","$link",911],",",["T_WHITESPACE"," ",911],["T_ARRAY","array",911],["T_WHITESPACE"," ",911],["T_VARIABLE","$parent",911],")",["T_WHITESPACE"," ",911],"{",["T_WHITESPACE","\n    ",911],["T_VARIABLE","$i",912],["T_WHITESPACE"," ",912],"=",["T_WHITESPACE"," ",912],["T_LNUMBER","1",912],";",["T_WHITESPACE","\n    ",912],["T_WHILE","while",913],["T_WHITESPACE"," ",913],"(",["T_VARIABLE","$i",913],["T_WHITESPACE"," ",913],"<",["T_WHITESPACE"," ",913],["T_VARIABLE","$link",913],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",913],"]",")",["T_WHITESPACE"," ",913],"{",["T_WHITESPACE","\n      ",913],["T_VARIABLE","$p",914],["T_WHITESPACE"," ",914],"=",["T_WHITESPACE"," ",914],["T_CONSTANT_ENCAPSED_STRING","'p'",914],["T_WHITESPACE"," ",914],".",["T_WHITESPACE"," ",914],["T_VARIABLE","$i",914],["T_INC","++",914],";",["T_WHITESPACE","\n      ",914],["T_VARIABLE","$link",915],"[",["T_VARIABLE","$p",915],"]",["T_WHITESPACE"," ",915],"=",["T_WHITESPACE"," ",915],["T_VARIABLE","$parent",915],"[",["T_VARIABLE","$p",915],"]",";",["T_WHITESPACE","\n    ",915],"}",["T_WHITESPACE","\n    ",916],["T_VARIABLE","$p",917],["T_WHITESPACE"," ",917],"=",["T_WHITESPACE"," ",917],["T_CONSTANT_ENCAPSED_STRING","'p'",917],["T_WHITESPACE"," ",917],".",["T_WHITESPACE"," ",917],["T_VARIABLE","$i",917],["T_INC","++",917],";",["T_WHITESPACE","\n    ",917],["T_COMMENT","\/\/ The parent (p1 - p9) corresponding to the depth always equals the nid.\n",918],["T_WHITESPACE","    ",919],["T_VARIABLE","$link",919],"[",["T_VARIABLE","$p",919],"]",["T_WHITESPACE"," ",919],"=",["T_WHITESPACE"," ",919],["T_VARIABLE","$link",919],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",919],"]",";",["T_WHITESPACE","\n    ",919],["T_WHILE","while",920],["T_WHITESPACE"," ",920],"(",["T_VARIABLE","$i",920],["T_WHITESPACE"," ",920],["T_IS_SMALLER_OR_EQUAL","<=",920],["T_WHITESPACE"," ",920],["T_STATIC","static",920],["T_DOUBLE_COLON","::",920],["T_STRING","BOOK_MAX_DEPTH",920],")",["T_WHITESPACE"," ",920],"{",["T_WHITESPACE","\n      ",920],["T_VARIABLE","$p",921],["T_WHITESPACE"," ",921],"=",["T_WHITESPACE"," ",921],["T_CONSTANT_ENCAPSED_STRING","'p'",921],["T_WHITESPACE"," ",921],".",["T_WHITESPACE"," ",921],["T_VARIABLE","$i",921],["T_INC","++",921],";",["T_WHITESPACE","\n      ",921],["T_VARIABLE","$link",922],"[",["T_VARIABLE","$p",922],"]",["T_WHITESPACE"," ",922],"=",["T_WHITESPACE"," ",922],["T_LNUMBER","0",922],";",["T_WHITESPACE","\n    ",922],"}",["T_WHITESPACE","\n  ",923],"}",["T_WHITESPACE","\n\n  ",924],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",926],["T_WHITESPACE","\n  ",928],["T_PUBLIC","public",929],["T_WHITESPACE"," ",929],["T_FUNCTION","function",929],["T_WHITESPACE"," ",929],["T_STRING","bookTreeCheckAccess",929],"(","&",["T_VARIABLE","$tree",929],",",["T_WHITESPACE"," ",929],["T_VARIABLE","$node_links",929],["T_WHITESPACE"," ",929],"=",["T_WHITESPACE"," ",929],["T_ARRAY","array",929],"(",")",")",["T_WHITESPACE"," ",929],"{",["T_WHITESPACE","\n    ",929],["T_IF","if",930],["T_WHITESPACE"," ",930],"(",["T_VARIABLE","$node_links",930],")",["T_WHITESPACE"," ",930],"{",["T_WHITESPACE","\n      ",930],["T_COMMENT","\/\/ @todo Extract that into its own method.\n",931],["T_WHITESPACE","      ",932],["T_VARIABLE","$nids",932],["T_WHITESPACE"," ",932],"=",["T_WHITESPACE"," ",932],["T_STRING","array_keys",932],"(",["T_VARIABLE","$node_links",932],")",";",["T_WHITESPACE","\n\n      ",932],["T_COMMENT","\/\/ @todo This should be actually filtering on the desired node status\n",934],["T_WHITESPACE","      ",935],["T_COMMENT","\/\/   field language and just fall back to the default language.\n",935],["T_WHITESPACE","      ",936],["T_VARIABLE","$nids",936],["T_WHITESPACE"," ",936],"=",["T_WHITESPACE"," ",936],["T_NS_SEPARATOR","\\",936],["T_STRING","Drupal",936],["T_DOUBLE_COLON","::",936],["T_STRING","entityQuery",936],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",936],")",["T_WHITESPACE","\n        ",936],["T_OBJECT_OPERATOR","->",937],["T_STRING","condition",937],"(",["T_CONSTANT_ENCAPSED_STRING","'nid'",937],",",["T_WHITESPACE"," ",937],["T_VARIABLE","$nids",937],",",["T_WHITESPACE"," ",937],["T_CONSTANT_ENCAPSED_STRING","'IN'",937],")",["T_WHITESPACE","\n        ",937],["T_OBJECT_OPERATOR","->",938],["T_STRING","condition",938],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",938],",",["T_WHITESPACE"," ",938],["T_LNUMBER","1",938],")",["T_WHITESPACE","\n        ",938],["T_OBJECT_OPERATOR","->",939],["T_STRING","execute",939],"(",")",";",["T_WHITESPACE","\n\n      ",939],["T_FOREACH","foreach",941],["T_WHITESPACE"," ",941],"(",["T_VARIABLE","$nids",941],["T_WHITESPACE"," ",941],["T_AS","as",941],["T_WHITESPACE"," ",941],["T_VARIABLE","$nid",941],")",["T_WHITESPACE"," ",941],"{",["T_WHITESPACE","\n        ",941],["T_FOREACH","foreach",942],["T_WHITESPACE"," ",942],"(",["T_VARIABLE","$node_links",942],"[",["T_VARIABLE","$nid",942],"]",["T_WHITESPACE"," ",942],["T_AS","as",942],["T_WHITESPACE"," ",942],["T_VARIABLE","$mlid",942],["T_WHITESPACE"," ",942],["T_DOUBLE_ARROW","=>",942],["T_WHITESPACE"," ",942],["T_VARIABLE","$link",942],")",["T_WHITESPACE"," ",942],"{",["T_WHITESPACE","\n          ",942],["T_VARIABLE","$node_links",943],"[",["T_VARIABLE","$nid",943],"]","[",["T_VARIABLE","$mlid",943],"]","[",["T_CONSTANT_ENCAPSED_STRING","'access'",943],"]",["T_WHITESPACE"," ",943],"=",["T_WHITESPACE"," ",943],["T_STRING","TRUE",943],";",["T_WHITESPACE","\n        ",943],"}",["T_WHITESPACE","\n      ",944],"}",["T_WHITESPACE","\n    ",945],"}",["T_WHITESPACE","\n    ",946],["T_VARIABLE","$this",947],["T_OBJECT_OPERATOR","->",947],["T_STRING","doBookTreeCheckAccess",947],"(",["T_VARIABLE","$tree",947],")",";",["T_WHITESPACE","\n  ",947],"}",["T_WHITESPACE","\n\n  ",948],["T_DOC_COMMENT","\/**\n   * Sorts the menu tree and recursively checks access for each item.\n   *\n   * @param array $tree\n   *   The book tree to operate on.\n   *\/",950],["T_WHITESPACE","\n  ",955],["T_PROTECTED","protected",956],["T_WHITESPACE"," ",956],["T_FUNCTION","function",956],["T_WHITESPACE"," ",956],["T_STRING","doBookTreeCheckAccess",956],"(","&",["T_VARIABLE","$tree",956],")",["T_WHITESPACE"," ",956],"{",["T_WHITESPACE","\n    ",956],["T_VARIABLE","$new_tree",957],["T_WHITESPACE"," ",957],"=",["T_WHITESPACE"," ",957],["T_ARRAY","array",957],"(",")",";",["T_WHITESPACE","\n    ",957],["T_FOREACH","foreach",958],["T_WHITESPACE"," ",958],"(",["T_VARIABLE","$tree",958],["T_WHITESPACE"," ",958],["T_AS","as",958],["T_WHITESPACE"," ",958],["T_VARIABLE","$key",958],["T_WHITESPACE"," ",958],["T_DOUBLE_ARROW","=>",958],["T_WHITESPACE"," ",958],["T_VARIABLE","$v",958],")",["T_WHITESPACE"," ",958],"{",["T_WHITESPACE","\n      ",958],["T_VARIABLE","$item",959],["T_WHITESPACE"," ",959],"=",["T_WHITESPACE"," ",959],"&",["T_VARIABLE","$tree",959],"[",["T_VARIABLE","$key",959],"]","[",["T_CONSTANT_ENCAPSED_STRING","'link'",959],"]",";",["T_WHITESPACE","\n      ",959],["T_VARIABLE","$this",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","bookLinkTranslate",960],"(",["T_VARIABLE","$item",960],")",";",["T_WHITESPACE","\n      ",960],["T_IF","if",961],["T_WHITESPACE"," ",961],"(",["T_VARIABLE","$item",961],"[",["T_CONSTANT_ENCAPSED_STRING","'access'",961],"]",")",["T_WHITESPACE"," ",961],"{",["T_WHITESPACE","\n        ",961],["T_IF","if",962],["T_WHITESPACE"," ",962],"(",["T_VARIABLE","$tree",962],"[",["T_VARIABLE","$key",962],"]","[",["T_CONSTANT_ENCAPSED_STRING","'below'",962],"]",")",["T_WHITESPACE"," ",962],"{",["T_WHITESPACE","\n          ",962],["T_VARIABLE","$this",963],["T_OBJECT_OPERATOR","->",963],["T_STRING","doBookTreeCheckAccess",963],"(",["T_VARIABLE","$tree",963],"[",["T_VARIABLE","$key",963],"]","[",["T_CONSTANT_ENCAPSED_STRING","'below'",963],"]",")",";",["T_WHITESPACE","\n        ",963],"}",["T_WHITESPACE","\n        ",964],["T_COMMENT","\/\/ The weights are made a uniform 5 digits by adding 50000 as an offset.\n",965],["T_WHITESPACE","        ",966],["T_COMMENT","\/\/ After calling $this->bookLinkTranslate(), $item['title'] has the\n",966],["T_WHITESPACE","        ",967],["T_COMMENT","\/\/ translated title. Adding the nid to the end of the index insures that\n",967],["T_WHITESPACE","        ",968],["T_COMMENT","\/\/ it is unique.\n",968],["T_WHITESPACE","        ",969],["T_VARIABLE","$new_tree",969],"[","(",["T_LNUMBER","50000",969],["T_WHITESPACE"," ",969],"+",["T_WHITESPACE"," ",969],["T_VARIABLE","$item",969],"[",["T_CONSTANT_ENCAPSED_STRING","'weight'",969],"]",")",["T_WHITESPACE"," ",969],".",["T_WHITESPACE"," ",969],["T_CONSTANT_ENCAPSED_STRING","' '",969],["T_WHITESPACE"," ",969],".",["T_WHITESPACE"," ",969],["T_VARIABLE","$item",969],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",969],"]",["T_WHITESPACE"," ",969],".",["T_WHITESPACE"," ",969],["T_CONSTANT_ENCAPSED_STRING","' '",969],["T_WHITESPACE"," ",969],".",["T_WHITESPACE"," ",969],["T_VARIABLE","$item",969],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",969],"]","]",["T_WHITESPACE"," ",969],"=",["T_WHITESPACE"," ",969],["T_VARIABLE","$tree",969],"[",["T_VARIABLE","$key",969],"]",";",["T_WHITESPACE","\n      ",969],"}",["T_WHITESPACE","\n    ",970],"}",["T_WHITESPACE","\n    ",971],["T_COMMENT","\/\/ Sort siblings in the tree based on the weights and localized titles.\n",972],["T_WHITESPACE","    ",973],["T_STRING","ksort",973],"(",["T_VARIABLE","$new_tree",973],")",";",["T_WHITESPACE","\n    ",973],["T_VARIABLE","$tree",974],["T_WHITESPACE"," ",974],"=",["T_WHITESPACE"," ",974],["T_VARIABLE","$new_tree",974],";",["T_WHITESPACE","\n  ",974],"}",["T_WHITESPACE","\n\n  ",975],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",977],["T_WHITESPACE","\n  ",979],["T_PUBLIC","public",980],["T_WHITESPACE"," ",980],["T_FUNCTION","function",980],["T_WHITESPACE"," ",980],["T_STRING","bookLinkTranslate",980],"(","&",["T_VARIABLE","$link",980],")",["T_WHITESPACE"," ",980],"{",["T_WHITESPACE","\n    ",980],["T_VARIABLE","$node",981],["T_WHITESPACE"," ",981],"=",["T_WHITESPACE"," ",981],["T_STRING","NULL",981],";",["T_WHITESPACE","\n    ",981],["T_COMMENT","\/\/ Access will already be set in the tree functions.\n",982],["T_WHITESPACE","    ",983],["T_IF","if",983],["T_WHITESPACE"," ",983],"(","!",["T_ISSET","isset",983],"(",["T_VARIABLE","$link",983],"[",["T_CONSTANT_ENCAPSED_STRING","'access'",983],"]",")",")",["T_WHITESPACE"," ",983],"{",["T_WHITESPACE","\n      ",983],["T_VARIABLE","$node",984],["T_WHITESPACE"," ",984],"=",["T_WHITESPACE"," ",984],["T_VARIABLE","$this",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","entityManager",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","getStorage",984],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",984],")",["T_OBJECT_OPERATOR","->",984],["T_STRING","load",984],"(",["T_VARIABLE","$link",984],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",984],"]",")",";",["T_WHITESPACE","\n      ",984],["T_VARIABLE","$link",985],"[",["T_CONSTANT_ENCAPSED_STRING","'access'",985],"]",["T_WHITESPACE"," ",985],"=",["T_WHITESPACE"," ",985],["T_VARIABLE","$node",985],["T_WHITESPACE"," ",985],["T_BOOLEAN_AND","&&",985],["T_WHITESPACE"," ",985],["T_VARIABLE","$node",985],["T_OBJECT_OPERATOR","->",985],["T_STRING","access",985],"(",["T_CONSTANT_ENCAPSED_STRING","'view'",985],")",";",["T_WHITESPACE","\n    ",985],"}",["T_WHITESPACE","\n    ",986],["T_COMMENT","\/\/ For performance, don't localize a link the user can't access.\n",987],["T_WHITESPACE","    ",988],["T_IF","if",988],["T_WHITESPACE"," ",988],"(",["T_VARIABLE","$link",988],"[",["T_CONSTANT_ENCAPSED_STRING","'access'",988],"]",")",["T_WHITESPACE"," ",988],"{",["T_WHITESPACE","\n      ",988],["T_COMMENT","\/\/ @todo - load the nodes en-mass rather than individually.\n",989],["T_WHITESPACE","      ",990],["T_IF","if",990],["T_WHITESPACE"," ",990],"(","!",["T_VARIABLE","$node",990],")",["T_WHITESPACE"," ",990],"{",["T_WHITESPACE","\n        ",990],["T_VARIABLE","$node",991],["T_WHITESPACE"," ",991],"=",["T_WHITESPACE"," ",991],["T_VARIABLE","$this",991],["T_OBJECT_OPERATOR","->",991],["T_STRING","entityManager",991],["T_OBJECT_OPERATOR","->",991],["T_STRING","getStorage",991],"(",["T_CONSTANT_ENCAPSED_STRING","'node'",991],")",["T_WHITESPACE","\n          ",991],["T_OBJECT_OPERATOR","->",992],["T_STRING","load",992],"(",["T_VARIABLE","$link",992],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",992],"]",")",";",["T_WHITESPACE","\n      ",992],"}",["T_WHITESPACE","\n      ",993],["T_COMMENT","\/\/ The node label will be the value for the current user's language.\n",994],["T_WHITESPACE","      ",995],["T_VARIABLE","$link",995],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",995],"]",["T_WHITESPACE"," ",995],"=",["T_WHITESPACE"," ",995],["T_VARIABLE","$node",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","label",995],"(",")",";",["T_WHITESPACE","\n      ",995],["T_VARIABLE","$link",996],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",996],"]",["T_WHITESPACE"," ",996],"=",["T_WHITESPACE"," ",996],["T_ARRAY","array",996],"(",")",";",["T_WHITESPACE","\n    ",996],"}",["T_WHITESPACE","\n    ",997],["T_RETURN","return",998],["T_WHITESPACE"," ",998],["T_VARIABLE","$link",998],";",["T_WHITESPACE","\n  ",998],"}",["T_WHITESPACE","\n\n  ",999],["T_DOC_COMMENT","\/**\n   * Sorts and returns the built data representing a book tree.\n   *\n   * @param array $links\n   *   A flat array of book links that are part of the book. Each array element\n   *   is an associative array of information about the book link, containing\n   *   the fields from the {book} table. This array must be ordered depth-first.\n   * @param array $parents\n   *   An array of the node ID values that are in the path from the current\n   *   page to the root of the book tree.\n   * @param int $depth\n   *   The minimum depth to include in the returned book tree.\n   *\n   * @return array\n   *   An array of book links in the form of a tree. Each item in the tree is an\n   *   associative array containing:\n   *   - link: The book link item from $links, with additional element\n   *     'in_active_trail' (TRUE if the link ID was in $parents).\n   *   - below: An array containing the sub-tree of this item, where each\n   *     element is a tree item array with 'link' and 'below' elements. This\n   *     array will be empty if the book link has no items in its sub-tree\n   *     having a depth greater than or equal to $depth.\n   *\/",1001],["T_WHITESPACE","\n  ",1023],["T_PROTECTED","protected",1024],["T_WHITESPACE"," ",1024],["T_FUNCTION","function",1024],["T_WHITESPACE"," ",1024],["T_STRING","buildBookOutlineData",1024],"(",["T_ARRAY","array",1024],["T_WHITESPACE"," ",1024],["T_VARIABLE","$links",1024],",",["T_WHITESPACE"," ",1024],["T_ARRAY","array",1024],["T_WHITESPACE"," ",1024],["T_VARIABLE","$parents",1024],["T_WHITESPACE"," ",1024],"=",["T_WHITESPACE"," ",1024],["T_ARRAY","array",1024],"(",")",",",["T_WHITESPACE"," ",1024],["T_VARIABLE","$depth",1024],["T_WHITESPACE"," ",1024],"=",["T_WHITESPACE"," ",1024],["T_LNUMBER","1",1024],")",["T_WHITESPACE"," ",1024],"{",["T_WHITESPACE","\n    ",1024],["T_COMMENT","\/\/ Reverse the array so we can use the more efficient array_pop() function.\n",1025],["T_WHITESPACE","    ",1026],["T_VARIABLE","$links",1026],["T_WHITESPACE"," ",1026],"=",["T_WHITESPACE"," ",1026],["T_STRING","array_reverse",1026],"(",["T_VARIABLE","$links",1026],")",";",["T_WHITESPACE","\n    ",1026],["T_RETURN","return",1027],["T_WHITESPACE"," ",1027],["T_VARIABLE","$this",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","buildBookOutlineRecursive",1027],"(",["T_VARIABLE","$links",1027],",",["T_WHITESPACE"," ",1027],["T_VARIABLE","$parents",1027],",",["T_WHITESPACE"," ",1027],["T_VARIABLE","$depth",1027],")",";",["T_WHITESPACE","\n  ",1027],"}",["T_WHITESPACE","\n\n  ",1028],["T_DOC_COMMENT","\/**\n   * Builds the data representing a book tree.\n   *\n   * The function is a bit complex because the rendering of a link depends on\n   * the next book link.\n   *\n   * @param array $links\n   *   A flat array of book links that are part of the book. Each array element\n   *   is an associative array of information about the book link, containing\n   *   the fields from the {book} table. This array must be ordered depth-first.\n   * @param array $parents\n   *   An array of the node ID values that are in the path from the current page\n   *   to the root of the book tree.\n   * @param int $depth\n   *   The minimum depth to include in the returned book tree.\n   *\n   * @return array\n   *   Book tree.\n   *\/",1030],["T_WHITESPACE","\n  ",1048],["T_PROTECTED","protected",1049],["T_WHITESPACE"," ",1049],["T_FUNCTION","function",1049],["T_WHITESPACE"," ",1049],["T_STRING","buildBookOutlineRecursive",1049],"(","&",["T_VARIABLE","$links",1049],",",["T_WHITESPACE"," ",1049],["T_VARIABLE","$parents",1049],",",["T_WHITESPACE"," ",1049],["T_VARIABLE","$depth",1049],")",["T_WHITESPACE"," ",1049],"{",["T_WHITESPACE","\n    ",1049],["T_VARIABLE","$tree",1050],["T_WHITESPACE"," ",1050],"=",["T_WHITESPACE"," ",1050],["T_ARRAY","array",1050],"(",")",";",["T_WHITESPACE","\n    ",1050],["T_WHILE","while",1051],["T_WHITESPACE"," ",1051],"(",["T_VARIABLE","$item",1051],["T_WHITESPACE"," ",1051],"=",["T_WHITESPACE"," ",1051],["T_STRING","array_pop",1051],"(",["T_VARIABLE","$links",1051],")",")",["T_WHITESPACE"," ",1051],"{",["T_WHITESPACE","\n      ",1051],["T_COMMENT","\/\/ We need to determine if we're on the path to root so we can later build\n",1052],["T_WHITESPACE","      ",1053],["T_COMMENT","\/\/ the correct active trail.\n",1053],["T_WHITESPACE","      ",1054],["T_VARIABLE","$item",1054],"[",["T_CONSTANT_ENCAPSED_STRING","'in_active_trail'",1054],"]",["T_WHITESPACE"," ",1054],"=",["T_WHITESPACE"," ",1054],["T_STRING","in_array",1054],"(",["T_VARIABLE","$item",1054],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",1054],"]",",",["T_WHITESPACE"," ",1054],["T_VARIABLE","$parents",1054],")",";",["T_WHITESPACE","\n      ",1054],["T_COMMENT","\/\/ Add the current link to the tree.\n",1055],["T_WHITESPACE","      ",1056],["T_VARIABLE","$tree",1056],"[",["T_VARIABLE","$item",1056],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",1056],"]","]",["T_WHITESPACE"," ",1056],"=",["T_WHITESPACE"," ",1056],["T_ARRAY","array",1056],"(",["T_WHITESPACE","\n        ",1056],["T_CONSTANT_ENCAPSED_STRING","'link'",1057],["T_WHITESPACE"," ",1057],["T_DOUBLE_ARROW","=>",1057],["T_WHITESPACE"," ",1057],["T_VARIABLE","$item",1057],",",["T_WHITESPACE","\n        ",1057],["T_CONSTANT_ENCAPSED_STRING","'below'",1058],["T_WHITESPACE"," ",1058],["T_DOUBLE_ARROW","=>",1058],["T_WHITESPACE"," ",1058],["T_ARRAY","array",1058],"(",")",",",["T_WHITESPACE","\n      ",1058],")",";",["T_WHITESPACE","\n      ",1059],["T_COMMENT","\/\/ Look ahead to the next link, but leave it on the array so it's\n",1060],["T_WHITESPACE","      ",1061],["T_COMMENT","\/\/ available to other recursive function calls if we return or build a\n",1061],["T_WHITESPACE","      ",1062],["T_COMMENT","\/\/ sub-tree.\n",1062],["T_WHITESPACE","      ",1063],["T_VARIABLE","$next",1063],["T_WHITESPACE"," ",1063],"=",["T_WHITESPACE"," ",1063],["T_STRING","end",1063],"(",["T_VARIABLE","$links",1063],")",";",["T_WHITESPACE","\n      ",1063],["T_COMMENT","\/\/ Check whether the next link is the first in a new sub-tree.\n",1064],["T_WHITESPACE","      ",1065],["T_IF","if",1065],["T_WHITESPACE"," ",1065],"(",["T_VARIABLE","$next",1065],["T_WHITESPACE"," ",1065],["T_BOOLEAN_AND","&&",1065],["T_WHITESPACE"," ",1065],["T_VARIABLE","$next",1065],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",1065],"]",["T_WHITESPACE"," ",1065],">",["T_WHITESPACE"," ",1065],["T_VARIABLE","$depth",1065],")",["T_WHITESPACE"," ",1065],"{",["T_WHITESPACE","\n        ",1065],["T_COMMENT","\/\/ Recursively call buildBookOutlineRecursive to build the sub-tree.\n",1066],["T_WHITESPACE","        ",1067],["T_VARIABLE","$tree",1067],"[",["T_VARIABLE","$item",1067],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",1067],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'below'",1067],"]",["T_WHITESPACE"," ",1067],"=",["T_WHITESPACE"," ",1067],["T_VARIABLE","$this",1067],["T_OBJECT_OPERATOR","->",1067],["T_STRING","buildBookOutlineRecursive",1067],"(",["T_VARIABLE","$links",1067],",",["T_WHITESPACE"," ",1067],["T_VARIABLE","$parents",1067],",",["T_WHITESPACE"," ",1067],["T_VARIABLE","$next",1067],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",1067],"]",")",";",["T_WHITESPACE","\n        ",1067],["T_COMMENT","\/\/ Fetch next link after filling the sub-tree.\n",1068],["T_WHITESPACE","        ",1069],["T_VARIABLE","$next",1069],["T_WHITESPACE"," ",1069],"=",["T_WHITESPACE"," ",1069],["T_STRING","end",1069],"(",["T_VARIABLE","$links",1069],")",";",["T_WHITESPACE","\n      ",1069],"}",["T_WHITESPACE","\n      ",1070],["T_COMMENT","\/\/ Determine if we should exit the loop and $request = return.\n",1071],["T_WHITESPACE","      ",1072],["T_IF","if",1072],["T_WHITESPACE"," ",1072],"(","!",["T_VARIABLE","$next",1072],["T_WHITESPACE"," ",1072],["T_BOOLEAN_OR","||",1072],["T_WHITESPACE"," ",1072],["T_VARIABLE","$next",1072],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",1072],"]",["T_WHITESPACE"," ",1072],"<",["T_WHITESPACE"," ",1072],["T_VARIABLE","$depth",1072],")",["T_WHITESPACE"," ",1072],"{",["T_WHITESPACE","\n        ",1072],["T_BREAK","break",1073],";",["T_WHITESPACE","\n      ",1073],"}",["T_WHITESPACE","\n    ",1074],"}",["T_WHITESPACE","\n    ",1075],["T_RETURN","return",1076],["T_WHITESPACE"," ",1076],["T_VARIABLE","$tree",1076],";",["T_WHITESPACE","\n  ",1076],"}",["T_WHITESPACE","\n\n  ",1077],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",1079],["T_WHITESPACE","\n  ",1081],["T_PUBLIC","public",1082],["T_WHITESPACE"," ",1082],["T_FUNCTION","function",1082],["T_WHITESPACE"," ",1082],["T_STRING","bookSubtreeData",1082],"(",["T_VARIABLE","$link",1082],")",["T_WHITESPACE"," ",1082],"{",["T_WHITESPACE","\n    ",1082],["T_VARIABLE","$tree",1083],["T_WHITESPACE"," ",1083],"=",["T_WHITESPACE"," ",1083],"&",["T_STRING","drupal_static",1083],"(",["T_METHOD_C","__METHOD__",1083],",",["T_WHITESPACE"," ",1083],["T_ARRAY","array",1083],"(",")",")",";",["T_WHITESPACE","\n\n    ",1083],["T_COMMENT","\/\/ Generate a cache ID (cid) specific for this $link.\n",1085],["T_WHITESPACE","    ",1086],["T_VARIABLE","$cid",1086],["T_WHITESPACE"," ",1086],"=",["T_WHITESPACE"," ",1086],["T_CONSTANT_ENCAPSED_STRING","'book-links:subtree-cid:'",1086],["T_WHITESPACE"," ",1086],".",["T_WHITESPACE"," ",1086],["T_VARIABLE","$link",1086],"[",["T_CONSTANT_ENCAPSED_STRING","'nid'",1086],"]",";",["T_WHITESPACE","\n\n    ",1086],["T_IF","if",1088],["T_WHITESPACE"," ",1088],"(","!",["T_ISSET","isset",1088],"(",["T_VARIABLE","$tree",1088],"[",["T_VARIABLE","$cid",1088],"]",")",")",["T_WHITESPACE"," ",1088],"{",["T_WHITESPACE","\n      ",1088],["T_VARIABLE","$tree_cid_cache",1089],["T_WHITESPACE"," ",1089],"=",["T_WHITESPACE"," ",1089],["T_NS_SEPARATOR","\\",1089],["T_STRING","Drupal",1089],["T_DOUBLE_COLON","::",1089],["T_STRING","cache",1089],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",1089],")",["T_OBJECT_OPERATOR","->",1089],["T_STRING","get",1089],"(",["T_VARIABLE","$cid",1089],")",";",["T_WHITESPACE","\n\n      ",1089],["T_IF","if",1091],["T_WHITESPACE"," ",1091],"(",["T_VARIABLE","$tree_cid_cache",1091],["T_WHITESPACE"," ",1091],["T_BOOLEAN_AND","&&",1091],["T_WHITESPACE"," ",1091],["T_VARIABLE","$tree_cid_cache",1091],["T_OBJECT_OPERATOR","->",1091],["T_STRING","data",1091],")",["T_WHITESPACE"," ",1091],"{",["T_WHITESPACE","\n        ",1091],["T_COMMENT","\/\/ If the cache entry exists, it will just be the cid for the actual\n",1092],["T_WHITESPACE","        ",1093],["T_COMMENT","\/\/ data. This avoids duplication of large amounts of data.\n",1093],["T_WHITESPACE","        ",1094],["T_VARIABLE","$cache",1094],["T_WHITESPACE"," ",1094],"=",["T_WHITESPACE"," ",1094],["T_NS_SEPARATOR","\\",1094],["T_STRING","Drupal",1094],["T_DOUBLE_COLON","::",1094],["T_STRING","cache",1094],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",1094],")",["T_OBJECT_OPERATOR","->",1094],["T_STRING","get",1094],"(",["T_VARIABLE","$tree_cid_cache",1094],["T_OBJECT_OPERATOR","->",1094],["T_STRING","data",1094],")",";",["T_WHITESPACE","\n\n        ",1094],["T_IF","if",1096],["T_WHITESPACE"," ",1096],"(",["T_VARIABLE","$cache",1096],["T_WHITESPACE"," ",1096],["T_BOOLEAN_AND","&&",1096],["T_WHITESPACE"," ",1096],["T_ISSET","isset",1096],"(",["T_VARIABLE","$cache",1096],["T_OBJECT_OPERATOR","->",1096],["T_STRING","data",1096],")",")",["T_WHITESPACE"," ",1096],"{",["T_WHITESPACE","\n          ",1096],["T_VARIABLE","$data",1097],["T_WHITESPACE"," ",1097],"=",["T_WHITESPACE"," ",1097],["T_VARIABLE","$cache",1097],["T_OBJECT_OPERATOR","->",1097],["T_STRING","data",1097],";",["T_WHITESPACE","\n        ",1097],"}",["T_WHITESPACE","\n      ",1098],"}",["T_WHITESPACE","\n\n      ",1099],["T_COMMENT","\/\/ If the subtree data was not in the cache, $data will be NULL.\n",1101],["T_WHITESPACE","      ",1102],["T_IF","if",1102],["T_WHITESPACE"," ",1102],"(","!",["T_ISSET","isset",1102],"(",["T_VARIABLE","$data",1102],")",")",["T_WHITESPACE"," ",1102],"{",["T_WHITESPACE","\n        ",1102],["T_VARIABLE","$result",1103],["T_WHITESPACE"," ",1103],"=",["T_WHITESPACE"," ",1103],["T_VARIABLE","$this",1103],["T_OBJECT_OPERATOR","->",1103],["T_STRING","bookOutlineStorage",1103],["T_OBJECT_OPERATOR","->",1103],["T_STRING","getBookSubtree",1103],"(",["T_VARIABLE","$link",1103],",",["T_WHITESPACE"," ",1103],["T_STATIC","static",1103],["T_DOUBLE_COLON","::",1103],["T_STRING","BOOK_MAX_DEPTH",1103],")",";",["T_WHITESPACE","\n        ",1103],["T_VARIABLE","$links",1104],["T_WHITESPACE"," ",1104],"=",["T_WHITESPACE"," ",1104],["T_ARRAY","array",1104],"(",")",";",["T_WHITESPACE","\n        ",1104],["T_FOREACH","foreach",1105],["T_WHITESPACE"," ",1105],"(",["T_VARIABLE","$result",1105],["T_WHITESPACE"," ",1105],["T_AS","as",1105],["T_WHITESPACE"," ",1105],["T_VARIABLE","$item",1105],")",["T_WHITESPACE"," ",1105],"{",["T_WHITESPACE","\n          ",1105],["T_VARIABLE","$links",1106],"[","]",["T_WHITESPACE"," ",1106],"=",["T_WHITESPACE"," ",1106],["T_VARIABLE","$item",1106],";",["T_WHITESPACE","\n        ",1106],"}",["T_WHITESPACE","\n        ",1107],["T_VARIABLE","$data",1108],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",1108],"]",["T_WHITESPACE"," ",1108],"=",["T_WHITESPACE"," ",1108],["T_VARIABLE","$this",1108],["T_OBJECT_OPERATOR","->",1108],["T_STRING","buildBookOutlineData",1108],"(",["T_VARIABLE","$links",1108],",",["T_WHITESPACE"," ",1108],["T_ARRAY","array",1108],"(",")",",",["T_WHITESPACE"," ",1108],["T_VARIABLE","$link",1108],"[",["T_CONSTANT_ENCAPSED_STRING","'depth'",1108],"]",")",";",["T_WHITESPACE","\n        ",1108],["T_VARIABLE","$data",1109],"[",["T_CONSTANT_ENCAPSED_STRING","'node_links'",1109],"]",["T_WHITESPACE"," ",1109],"=",["T_WHITESPACE"," ",1109],["T_ARRAY","array",1109],"(",")",";",["T_WHITESPACE","\n        ",1109],["T_VARIABLE","$this",1110],["T_OBJECT_OPERATOR","->",1110],["T_STRING","bookTreeCollectNodeLinks",1110],"(",["T_VARIABLE","$data",1110],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",1110],"]",",",["T_WHITESPACE"," ",1110],["T_VARIABLE","$data",1110],"[",["T_CONSTANT_ENCAPSED_STRING","'node_links'",1110],"]",")",";",["T_WHITESPACE","\n        ",1110],["T_COMMENT","\/\/ Compute the real cid for book subtree data.\n",1111],["T_WHITESPACE","        ",1112],["T_VARIABLE","$tree_cid",1112],["T_WHITESPACE"," ",1112],"=",["T_WHITESPACE"," ",1112],["T_CONSTANT_ENCAPSED_STRING","'book-links:subtree-data:'",1112],["T_WHITESPACE"," ",1112],".",["T_WHITESPACE"," ",1112],["T_STRING","hash",1112],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",1112],",",["T_WHITESPACE"," ",1112],["T_STRING","serialize",1112],"(",["T_VARIABLE","$data",1112],")",")",";",["T_WHITESPACE","\n        ",1112],["T_COMMENT","\/\/ Cache the data, if it is not already in the cache.\n",1113],["T_WHITESPACE","\n        ",1114],["T_IF","if",1115],["T_WHITESPACE"," ",1115],"(","!",["T_NS_SEPARATOR","\\",1115],["T_STRING","Drupal",1115],["T_DOUBLE_COLON","::",1115],["T_STRING","cache",1115],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",1115],")",["T_OBJECT_OPERATOR","->",1115],["T_STRING","get",1115],"(",["T_VARIABLE","$tree_cid",1115],")",")",["T_WHITESPACE"," ",1115],"{",["T_WHITESPACE","\n          ",1115],["T_NS_SEPARATOR","\\",1116],["T_STRING","Drupal",1116],["T_DOUBLE_COLON","::",1116],["T_STRING","cache",1116],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",1116],")",["T_OBJECT_OPERATOR","->",1116],["T_STRING","set",1116],"(",["T_VARIABLE","$tree_cid",1116],",",["T_WHITESPACE"," ",1116],["T_VARIABLE","$data",1116],",",["T_WHITESPACE"," ",1116],["T_STRING","Cache",1116],["T_DOUBLE_COLON","::",1116],["T_STRING","PERMANENT",1116],",",["T_WHITESPACE"," ",1116],["T_ARRAY","array",1116],"(",["T_CONSTANT_ENCAPSED_STRING","'bid:'",1116],["T_WHITESPACE"," ",1116],".",["T_WHITESPACE"," ",1116],["T_VARIABLE","$link",1116],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",1116],"]",")",")",";",["T_WHITESPACE","\n        ",1116],"}",["T_WHITESPACE","\n        ",1117],["T_COMMENT","\/\/ Cache the cid of the (shared) data using the book and item-specific\n",1118],["T_WHITESPACE","        ",1119],["T_COMMENT","\/\/ cid.\n",1119],["T_WHITESPACE","        ",1120],["T_NS_SEPARATOR","\\",1120],["T_STRING","Drupal",1120],["T_DOUBLE_COLON","::",1120],["T_STRING","cache",1120],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",1120],")",["T_OBJECT_OPERATOR","->",1120],["T_STRING","set",1120],"(",["T_VARIABLE","$cid",1120],",",["T_WHITESPACE"," ",1120],["T_VARIABLE","$tree_cid",1120],",",["T_WHITESPACE"," ",1120],["T_STRING","Cache",1120],["T_DOUBLE_COLON","::",1120],["T_STRING","PERMANENT",1120],",",["T_WHITESPACE"," ",1120],["T_ARRAY","array",1120],"(",["T_CONSTANT_ENCAPSED_STRING","'bid:'",1120],["T_WHITESPACE"," ",1120],".",["T_WHITESPACE"," ",1120],["T_VARIABLE","$link",1120],"[",["T_CONSTANT_ENCAPSED_STRING","'bid'",1120],"]",")",")",";",["T_WHITESPACE","\n      ",1120],"}",["T_WHITESPACE","\n      ",1121],["T_COMMENT","\/\/ Check access for the current user to each item in the tree.\n",1122],["T_WHITESPACE","      ",1123],["T_VARIABLE","$this",1123],["T_OBJECT_OPERATOR","->",1123],["T_STRING","bookTreeCheckAccess",1123],"(",["T_VARIABLE","$data",1123],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",1123],"]",",",["T_WHITESPACE"," ",1123],["T_VARIABLE","$data",1123],"[",["T_CONSTANT_ENCAPSED_STRING","'node_links'",1123],"]",")",";",["T_WHITESPACE","\n      ",1123],["T_VARIABLE","$tree",1124],"[",["T_VARIABLE","$cid",1124],"]",["T_WHITESPACE"," ",1124],"=",["T_WHITESPACE"," ",1124],["T_VARIABLE","$data",1124],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",1124],"]",";",["T_WHITESPACE","\n    ",1124],"}",["T_WHITESPACE","\n\n    ",1125],["T_RETURN","return",1127],["T_WHITESPACE"," ",1127],["T_VARIABLE","$tree",1127],"[",["T_VARIABLE","$cid",1127],"]",";",["T_WHITESPACE","\n  ",1127],"}",["T_WHITESPACE","\n\n",1128],"}",["T_WHITESPACE","\n",1130]]