[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate_drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","migrate",3],["T_NS_SEPARATOR","\\",3],["T_STRING","source",3],["T_NS_SEPARATOR","\\",3],["T_STRING","d7",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","migrate_drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Plugin",5],["T_NS_SEPARATOR","\\",5],["T_STRING","migrate",5],["T_NS_SEPARATOR","\\",5],["T_STRING","source",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DrupalSqlBase",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Base class for D7 source plugins which need to collect field values from\n * the Field API.\n *\/",7],["T_WHITESPACE","\n",10],["T_ABSTRACT","abstract",11],["T_WHITESPACE"," ",11],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","FieldableEntity",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_STRING","DrupalSqlBase",11],["T_WHITESPACE"," ",11],"{",["T_WHITESPACE","\n\n  ",11],["T_DOC_COMMENT","\/**\n   * Returns all non-deleted field instances attached to a specific entity type.\n   *\n   * @param string $entity_type\n   *   The entity type ID.\n   * @param string|null $bundle\n   *   (optional) The bundle.\n   *\n   * @return array[]\n   *   The field instances, keyed by field name.\n   *\/",13],["T_WHITESPACE","\n  ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","getFields",24],"(",["T_VARIABLE","$entity_type",24],",",["T_WHITESPACE"," ",24],["T_VARIABLE","$bundle",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","NULL",24],")",["T_WHITESPACE"," ",24],"{",["T_WHITESPACE","\n    ",24],["T_RETURN","return",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","select",25],"(",["T_CONSTANT_ENCAPSED_STRING","'field_config_instance'",25],",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'fci'",25],")",["T_WHITESPACE","\n      ",25],["T_OBJECT_OPERATOR","->",26],["T_STRING","fields",26],"(",["T_CONSTANT_ENCAPSED_STRING","'fci'",26],")",["T_WHITESPACE","\n      ",26],["T_OBJECT_OPERATOR","->",27],["T_STRING","condition",27],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",27],",",["T_WHITESPACE"," ",27],["T_VARIABLE","$entity_type",27],")",["T_WHITESPACE","\n      ",27],["T_OBJECT_OPERATOR","->",28],["T_STRING","condition",28],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle'",28],",",["T_WHITESPACE"," ",28],["T_ISSET","isset",28],"(",["T_VARIABLE","$bundle",28],")",["T_WHITESPACE"," ",28],"?",["T_WHITESPACE"," ",28],["T_VARIABLE","$bundle",28],["T_WHITESPACE"," ",28],":",["T_WHITESPACE"," ",28],["T_VARIABLE","$entity_type",28],")",["T_WHITESPACE","\n      ",28],["T_OBJECT_OPERATOR","->",29],["T_STRING","condition",29],"(",["T_CONSTANT_ENCAPSED_STRING","'deleted'",29],",",["T_WHITESPACE"," ",29],["T_LNUMBER","0",29],")",["T_WHITESPACE","\n      ",29],["T_OBJECT_OPERATOR","->",30],["T_STRING","execute",30],"(",")",["T_WHITESPACE","\n      ",30],["T_OBJECT_OPERATOR","->",31],["T_STRING","fetchAllAssoc",31],"(",["T_CONSTANT_ENCAPSED_STRING","'field_name'",31],")",";",["T_WHITESPACE","\n  ",31],"}",["T_WHITESPACE","\n\n  ",32],["T_DOC_COMMENT","\/**\n   * Retrieves field values for a single field of a single entity.\n   *\n   * @param string $entity_type\n   *   The entity type.\n   * @param string $field\n   *   The field name.\n   * @param int $entity_id\n   *   The entity ID.\n   * @param int|null $revision_id\n   *   (optional) The entity revision ID.\n   *\n   * @return array\n   *   The raw field values, keyed by delta.\n   *\n   * @todo Support multilingual field values.\n   *\/",34],["T_WHITESPACE","\n  ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","getFieldValues",51],"(",["T_VARIABLE","$entity_type",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$field",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$entity_id",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$revision_id",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","NULL",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$table",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],"(",["T_ISSET","isset",52],"(",["T_VARIABLE","$revision_id",52],")",["T_WHITESPACE"," ",52],"?",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'field_revision_'",52],["T_WHITESPACE"," ",52],":",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'field_data_'",52],")",["T_WHITESPACE"," ",52],".",["T_WHITESPACE"," ",52],["T_VARIABLE","$field",52],";",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$query",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","select",53],"(",["T_VARIABLE","$table",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'t'",53],")",["T_WHITESPACE","\n      ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","fields",54],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",54],")",["T_WHITESPACE","\n      ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","condition",55],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type'",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$entity_type",55],")",["T_WHITESPACE","\n      ",55],["T_OBJECT_OPERATOR","->",56],["T_STRING","condition",56],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$entity_id",56],")",["T_WHITESPACE","\n      ",56],["T_OBJECT_OPERATOR","->",57],["T_STRING","condition",57],"(",["T_CONSTANT_ENCAPSED_STRING","'deleted'",57],",",["T_WHITESPACE"," ",57],["T_LNUMBER","0",57],")",";",["T_WHITESPACE","\n    ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_ISSET","isset",58],"(",["T_VARIABLE","$revision_id",58],")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n      ",58],["T_VARIABLE","$query",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","condition",59],"(",["T_CONSTANT_ENCAPSED_STRING","'revision_id'",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$revision_id",59],")",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$values",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],"[","]",";",["T_WHITESPACE","\n    ",61],["T_FOREACH","foreach",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$query",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","execute",62],"(",")",["T_WHITESPACE"," ",62],["T_AS","as",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$row",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n      ",62],["T_FOREACH","foreach",63],["T_WHITESPACE"," ",63],"(",["T_VARIABLE","$row",63],["T_WHITESPACE"," ",63],["T_AS","as",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$key",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$value",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$delta",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$row",64],"[",["T_CONSTANT_ENCAPSED_STRING","'delta'",64],"]",";",["T_WHITESPACE","\n        ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_STRING","strpos",65],"(",["T_VARIABLE","$key",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$field",65],")",["T_WHITESPACE"," ",65],["T_IS_IDENTICAL","===",65],["T_WHITESPACE"," ",65],["T_LNUMBER","0",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n          ",65],["T_VARIABLE","$column",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","substr",66],"(",["T_VARIABLE","$key",66],",",["T_WHITESPACE"," ",66],["T_STRING","strlen",66],"(",["T_VARIABLE","$field",66],")",["T_WHITESPACE"," ",66],"+",["T_WHITESPACE"," ",66],["T_LNUMBER","1",66],")",";",["T_WHITESPACE","\n          ",66],["T_VARIABLE","$values",67],"[",["T_VARIABLE","$delta",67],"]","[",["T_VARIABLE","$column",67],"]",["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$value",67],";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n      ",68],"}",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n    ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$values",71],";",["T_WHITESPACE","\n  ",71],"}",["T_WHITESPACE","\n\n",72],"}",["T_WHITESPACE","\n",74]]