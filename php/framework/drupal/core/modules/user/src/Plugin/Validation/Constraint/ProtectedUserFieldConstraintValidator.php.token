[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Plugin",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Validation",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Constraint",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DependencyInjection",5],["T_NS_SEPARATOR","\\",5],["T_STRING","ContainerInjectionInterface",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Session",6],["T_NS_SEPARATOR","\\",6],["T_STRING","AccountProxyInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","user",7],["T_NS_SEPARATOR","\\",7],["T_STRING","UserStorageInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Symfony",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Component",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DependencyInjection",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ContainerInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Symfony",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Component",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Validator",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Constraint",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Symfony",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Component",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Validator",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ConstraintValidator",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Validates the ProtectedUserFieldConstraint constraint.\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","ProtectedUserFieldConstraintValidator",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","ConstraintValidator",15],["T_WHITESPACE"," ",15],["T_IMPLEMENTS","implements",15],["T_WHITESPACE"," ",15],["T_STRING","ContainerInjectionInterface",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * User storage handler.\n   *\n   * @var \\Drupal\\user\\UserStorageInterface\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$userStorage",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * The current user.\n   *\n   * @var \\Drupal\\Core\\Session\\AccountProxyInterface\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$currentUser",29],";",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * Constructs the object.\n   *\n   * @param \\Drupal\\user\\UserStorageInterface $user_storage\n   *   The user storage handler.\n   * @param \\Drupal\\Core\\Session\\AccountProxyInterface $current_user\n   *   The current user.\n   *\/",31],["T_WHITESPACE","\n  ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_STRING","UserStorageInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$user_storage",39],",",["T_WHITESPACE"," ",39],["T_STRING","AccountProxyInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$current_user",39],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n    ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","userStorage",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$user_storage",40],";",["T_WHITESPACE","\n    ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","currentUser",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$current_user",41],";",["T_WHITESPACE","\n  ",41],"}",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",44],["T_WHITESPACE","\n  ",46],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_STATIC","static",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","create",47],"(",["T_STRING","ContainerInterface",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$container",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n    ",47],["T_RETURN","return",48],["T_WHITESPACE"," ",48],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_STATIC","static",48],"(",["T_WHITESPACE","\n      ",48],["T_VARIABLE","$container",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","get",49],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","getStorage",49],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",49],")",",",["T_WHITESPACE","\n      ",49],["T_VARIABLE","$container",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","get",50],"(",["T_CONSTANT_ENCAPSED_STRING","'current_user'",50],")",["T_WHITESPACE","\n    ",50],")",";",["T_WHITESPACE","\n  ",51],"}",["T_WHITESPACE","\n\n  ",52],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",54],["T_WHITESPACE","\n  ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","validate",57],"(",["T_VARIABLE","$items",57],",",["T_WHITESPACE"," ",57],["T_STRING","Constraint",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$constraint",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n    ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(","!",["T_ISSET","isset",58],"(",["T_VARIABLE","$items",58],")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n      ",58],["T_RETURN","return",59],";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n    ",60],["T_COMMENT","\/* @var \\Drupal\\Core\\Field\\FieldItemListInterface $items *\/",61],["T_WHITESPACE","\n    ",61],["T_VARIABLE","$field",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$items",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getFieldDefinition",62],"(",")",";",["T_WHITESPACE","\n\n    ",62],["T_COMMENT","\/* @var \\Drupal\\user\\UserInterface $account *\/",64],["T_WHITESPACE","\n    ",64],["T_VARIABLE","$account",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$items",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getEntity",65],"(",")",";",["T_WHITESPACE","\n    ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(","!",["T_ISSET","isset",66],"(",["T_VARIABLE","$account",66],")",["T_WHITESPACE"," ",66],["T_BOOLEAN_OR","||",66],["T_WHITESPACE"," ",66],"!",["T_EMPTY","empty",66],"(",["T_VARIABLE","$account",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_skipProtectedUserFieldConstraint",66],")",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n      ",66],["T_COMMENT","\/\/ Looks like we are validating a field not being part of a user, or the\n",67],["T_WHITESPACE","      ",68],["T_COMMENT","\/\/ constraint should be skipped, so do nothing.\n",68],["T_WHITESPACE","      ",69],["T_RETURN","return",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/\/ Only validate for existing entities and if this is the current user.\n",72],["T_WHITESPACE","    ",73],["T_IF","if",73],["T_WHITESPACE"," ",73],"(","!",["T_VARIABLE","$account",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","isNew",73],"(",")",["T_WHITESPACE"," ",73],["T_BOOLEAN_AND","&&",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$account",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","id",73],"(",")",["T_WHITESPACE"," ",73],["T_IS_EQUAL","==",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","currentUser",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","id",73],"(",")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n\n      ",73],["T_COMMENT","\/* @var \\Drupal\\user\\UserInterface $account_unchanged *\/",75],["T_WHITESPACE","\n      ",75],["T_VARIABLE","$account_unchanged",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","userStorage",76],["T_WHITESPACE","\n        ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","loadUnchanged",77],"(",["T_VARIABLE","$account",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","id",77],"(",")",")",";",["T_WHITESPACE","\n\n      ",77],["T_VARIABLE","$changed",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","FALSE",79],";",["T_WHITESPACE","\n\n      ",79],["T_COMMENT","\/\/ Special case for the password, it being empty means that the existing\n",81],["T_WHITESPACE","      ",82],["T_COMMENT","\/\/ password should not be changed, ignore empty password fields.\n",82],["T_WHITESPACE","      ",83],["T_VARIABLE","$value",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$items",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","value",83],";",["T_WHITESPACE","\n      ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$field",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getName",84],"(",")",["T_WHITESPACE"," ",84],["T_IS_NOT_EQUAL","!=",84],["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'pass'",84],["T_WHITESPACE"," ",84],["T_BOOLEAN_OR","||",84],["T_WHITESPACE"," ",84],"!",["T_EMPTY","empty",84],"(",["T_VARIABLE","$value",84],")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n        ",84],["T_COMMENT","\/\/ Compare the values of the field this is being validated on.\n",85],["T_WHITESPACE","        ",86],["T_VARIABLE","$changed",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$items",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getValue",86],"(",")",["T_WHITESPACE"," ",86],["T_IS_NOT_EQUAL","!=",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$account_unchanged",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","get",86],"(",["T_VARIABLE","$field",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getName",86],"(",")",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","getValue",86],"(",")",";",["T_WHITESPACE","\n      ",86],"}",["T_WHITESPACE","\n      ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$changed",88],["T_WHITESPACE"," ",88],["T_BOOLEAN_AND","&&",88],["T_WHITESPACE"," ",88],"(","!",["T_VARIABLE","$account",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","checkExistingPassword",88],"(",["T_VARIABLE","$account_unchanged",88],")",")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","context",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","addViolation",89],"(",["T_VARIABLE","$constraint",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","message",89],",",["T_WHITESPACE"," ",89],["T_ARRAY","array",89],"(",["T_CONSTANT_ENCAPSED_STRING","'%name'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$field",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getLabel",89],"(",")",")",")",";",["T_WHITESPACE","\n      ",89],"}",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n  ",91],"}",["T_WHITESPACE","\n\n",92],"}",["T_WHITESPACE","\n",94]]