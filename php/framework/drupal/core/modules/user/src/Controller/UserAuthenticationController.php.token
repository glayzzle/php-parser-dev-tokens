[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Controller",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Access",5],["T_NS_SEPARATOR","\\",5],["T_STRING","CsrfTokenGenerator",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Controller",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ControllerBase",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Core",7],["T_NS_SEPARATOR","\\",7],["T_STRING","DependencyInjection",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ContainerInjectionInterface",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Core",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Flood",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FloodInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Drupal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Core",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Routing",9],["T_NS_SEPARATOR","\\",9],["T_STRING","RouteProviderInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Drupal",10],["T_NS_SEPARATOR","\\",10],["T_STRING","user",10],["T_NS_SEPARATOR","\\",10],["T_STRING","UserAuthInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Drupal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","user",11],["T_NS_SEPARATOR","\\",11],["T_STRING","UserInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Drupal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","user",12],["T_NS_SEPARATOR","\\",12],["T_STRING","UserStorageInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Symfony",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Component",13],["T_NS_SEPARATOR","\\",13],["T_STRING","DependencyInjection",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ContainerInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Request",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpFoundation",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Response",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpKernel",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Exception",16],["T_NS_SEPARATOR","\\",16],["T_STRING","AccessDeniedHttpException",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","HttpKernel",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Exception",17],["T_NS_SEPARATOR","\\",17],["T_STRING","BadRequestHttpException",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Serializer",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Encoder",18],["T_NS_SEPARATOR","\\",18],["T_STRING","JsonEncoder",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Serializer",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Serializer",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * Provides controllers for login, login status and logout via HTTP requests.\n *\/",21],["T_WHITESPACE","\n",23],["T_CLASS","class",24],["T_WHITESPACE"," ",24],["T_STRING","UserAuthenticationController",24],["T_WHITESPACE"," ",24],["T_EXTENDS","extends",24],["T_WHITESPACE"," ",24],["T_STRING","ControllerBase",24],["T_WHITESPACE"," ",24],["T_IMPLEMENTS","implements",24],["T_WHITESPACE"," ",24],["T_STRING","ContainerInjectionInterface",24],["T_WHITESPACE"," ",24],"{",["T_WHITESPACE","\n\n  ",24],["T_DOC_COMMENT","\/**\n   * String sent in responses, to describe the user as being logged in.\n   *\n   * @var string\n   *\/",26],["T_WHITESPACE","\n  ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","LOGGED_IN",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_LNUMBER","1",31],";",["T_WHITESPACE","\n\n  ",31],["T_DOC_COMMENT","\/**\n   * String sent in responses, to describe the user as being logged out.\n   *\n   * @var string\n   *\/",33],["T_WHITESPACE","\n  ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","LOGGED_OUT",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_LNUMBER","0",38],";",["T_WHITESPACE","\n\n  ",38],["T_DOC_COMMENT","\/**\n   * The flood controller.\n   *\n   * @var \\Drupal\\Core\\Flood\\FloodInterface\n   *\/",40],["T_WHITESPACE","\n  ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$flood",45],";",["T_WHITESPACE","\n\n  ",45],["T_DOC_COMMENT","\/**\n   * The user storage.\n   *\n   * @var \\Drupal\\user\\UserStorageInterface\n   *\/",47],["T_WHITESPACE","\n  ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$userStorage",52],";",["T_WHITESPACE","\n\n  ",52],["T_DOC_COMMENT","\/**\n   * The CSRF token generator.\n   *\n   * @var \\Drupal\\Core\\Access\\CsrfTokenGenerator\n   *\/",54],["T_WHITESPACE","\n  ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$csrfToken",59],";",["T_WHITESPACE","\n\n  ",59],["T_DOC_COMMENT","\/**\n   * The user authentication.\n   *\n   * @var \\Drupal\\user\\UserAuthInterface\n   *\/",61],["T_WHITESPACE","\n  ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$userAuth",66],";",["T_WHITESPACE","\n\n  ",66],["T_DOC_COMMENT","\/**\n   * The route provider.\n   *\n   * @var \\Drupal\\Core\\Routing\\RouteProviderInterface\n   *\/",68],["T_WHITESPACE","\n  ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$routeProvider",73],";",["T_WHITESPACE","\n\n  ",73],["T_DOC_COMMENT","\/**\n   * The serializer.\n   *\n   * @var \\Symfony\\Component\\Serializer\\Serializer\n   *\/",75],["T_WHITESPACE","\n  ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$serializer",80],";",["T_WHITESPACE","\n\n  ",80],["T_DOC_COMMENT","\/**\n   * The available serialization formats.\n   *\n   * @var array\n   *\/",82],["T_WHITESPACE","\n  ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$serializerFormats",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],"[","]",";",["T_WHITESPACE","\n\n  ",87],["T_DOC_COMMENT","\/**\n   * Constructs a new UserAuthenticationController object.\n   *\n   * @param \\Drupal\\Core\\Flood\\FloodInterface $flood\n   *   The flood controller.\n   * @param \\Drupal\\user\\UserStorageInterface $user_storage\n   *   The user storage.\n   * @param \\Drupal\\Core\\Access\\CsrfTokenGenerator $csrf_token\n   *   The CSRF token generator.\n   * @param \\Drupal\\user\\UserAuthInterface $user_auth\n   *   The user authentication.\n   * @param \\Drupal\\Core\\Routing\\RouteProviderInterface $route_provider\n   *   The route provider.\n   * @param \\Symfony\\Component\\Serializer\\Serializer $serializer\n   *   The serializer.\n   * @param array $serializer_formats\n   *   The available serialization formats.\n   *\/",89],["T_WHITESPACE","\n  ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","__construct",107],"(",["T_STRING","FloodInterface",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$flood",107],",",["T_WHITESPACE"," ",107],["T_STRING","UserStorageInterface",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$user_storage",107],",",["T_WHITESPACE"," ",107],["T_STRING","CsrfTokenGenerator",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$csrf_token",107],",",["T_WHITESPACE"," ",107],["T_STRING","UserAuthInterface",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$user_auth",107],",",["T_WHITESPACE"," ",107],["T_STRING","RouteProviderInterface",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$route_provider",107],",",["T_WHITESPACE"," ",107],["T_STRING","Serializer",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$serializer",107],",",["T_WHITESPACE"," ",107],["T_ARRAY","array",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$serializer_formats",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n    ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","flood",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$flood",108],";",["T_WHITESPACE","\n    ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","userStorage",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$user_storage",109],";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","csrfToken",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$csrf_token",110],";",["T_WHITESPACE","\n    ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","userAuth",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$user_auth",111],";",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","serializer",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$serializer",112],";",["T_WHITESPACE","\n    ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","serializerFormats",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$serializer_formats",113],";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","routeProvider",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$route_provider",114],";",["T_WHITESPACE","\n  ",114],"}",["T_WHITESPACE","\n\n  ",115],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",117],["T_WHITESPACE","\n  ",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_STATIC","static",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","create",120],"(",["T_STRING","ContainerInterface",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$container",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n    ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$container",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","hasParameter",121],"(",["T_CONSTANT_ENCAPSED_STRING","'serializer.formats'",121],")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$container",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","has",121],"(",["T_CONSTANT_ENCAPSED_STRING","'serializer'",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n      ",121],["T_VARIABLE","$serializer",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$container",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","get",122],"(",["T_CONSTANT_ENCAPSED_STRING","'serializer'",122],")",";",["T_WHITESPACE","\n      ",122],["T_VARIABLE","$formats",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$container",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getParameter",123],"(",["T_CONSTANT_ENCAPSED_STRING","'serializer.formats'",123],")",";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n    ",124],["T_ELSE","else",125],["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n      ",125],["T_VARIABLE","$formats",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],"[",["T_CONSTANT_ENCAPSED_STRING","'json'",126],"]",";",["T_WHITESPACE","\n      ",126],["T_VARIABLE","$encoders",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],"[",["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","JsonEncoder",127],"(",")","]",";",["T_WHITESPACE","\n      ",127],["T_VARIABLE","$serializer",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_STRING","Serializer",128],"(","[","]",",",["T_WHITESPACE"," ",128],["T_VARIABLE","$encoders",128],")",";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_NEW","new",131],["T_WHITESPACE"," ",131],["T_STATIC","static",131],"(",["T_WHITESPACE","\n      ",131],["T_VARIABLE","$container",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","get",132],"(",["T_CONSTANT_ENCAPSED_STRING","'flood'",132],")",",",["T_WHITESPACE","\n      ",132],["T_VARIABLE","$container",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","get",133],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type.manager'",133],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","getStorage",133],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",133],")",",",["T_WHITESPACE","\n      ",133],["T_VARIABLE","$container",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","get",134],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_token'",134],")",",",["T_WHITESPACE","\n      ",134],["T_VARIABLE","$container",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","get",135],"(",["T_CONSTANT_ENCAPSED_STRING","'user.auth'",135],")",",",["T_WHITESPACE","\n      ",135],["T_VARIABLE","$container",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","get",136],"(",["T_CONSTANT_ENCAPSED_STRING","'router.route_provider'",136],")",",",["T_WHITESPACE","\n      ",136],["T_VARIABLE","$serializer",137],",",["T_WHITESPACE","\n      ",137],["T_VARIABLE","$formats",138],["T_WHITESPACE","\n    ",138],")",";",["T_WHITESPACE","\n  ",139],"}",["T_WHITESPACE","\n\n  ",140],["T_DOC_COMMENT","\/**\n   * Logs in a user.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The request.\n   *\n   * @return \\Symfony\\Component\\HttpFoundation\\Response\n   *   A response which contains the ID and CSRF token.\n   *\/",142],["T_WHITESPACE","\n  ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","login",151],"(",["T_STRING","Request",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$request",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$format",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getRequestFormat",152],"(",["T_VARIABLE","$request",152],")",";",["T_WHITESPACE","\n\n    ",152],["T_VARIABLE","$content",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$request",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getContent",154],"(",")",";",["T_WHITESPACE","\n    ",154],["T_VARIABLE","$credentials",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","serializer",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","decode",155],"(",["T_VARIABLE","$content",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$format",155],")",";",["T_WHITESPACE","\n    ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(","!",["T_ISSET","isset",156],"(",["T_VARIABLE","$credentials",156],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",156],"]",")",["T_WHITESPACE"," ",156],["T_BOOLEAN_AND","&&",156],["T_WHITESPACE"," ",156],"!",["T_ISSET","isset",156],"(",["T_VARIABLE","$credentials",156],"[",["T_CONSTANT_ENCAPSED_STRING","'pass'",156],"]",")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n      ",156],["T_THROW","throw",157],["T_WHITESPACE"," ",157],["T_NEW","new",157],["T_WHITESPACE"," ",157],["T_STRING","BadRequestHttpException",157],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing credentials.'",157],")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_IF","if",160],["T_WHITESPACE"," ",160],"(","!",["T_ISSET","isset",160],"(",["T_VARIABLE","$credentials",160],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",160],"]",")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n      ",160],["T_THROW","throw",161],["T_WHITESPACE"," ",161],["T_NEW","new",161],["T_WHITESPACE"," ",161],["T_STRING","BadRequestHttpException",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing credentials.name.'",161],")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n    ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(","!",["T_ISSET","isset",163],"(",["T_VARIABLE","$credentials",163],"[",["T_CONSTANT_ENCAPSED_STRING","'pass'",163],"]",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n      ",163],["T_THROW","throw",164],["T_WHITESPACE"," ",164],["T_NEW","new",164],["T_WHITESPACE"," ",164],["T_STRING","BadRequestHttpException",164],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing credentials.pass.'",164],")",";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","floodControl",167],"(",["T_VARIABLE","$request",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$credentials",167],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",167],"]",")",";",["T_WHITESPACE","\n\n    ",167],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","userIsBlocked",169],"(",["T_VARIABLE","$credentials",169],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",169],"]",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n      ",169],["T_THROW","throw",170],["T_WHITESPACE"," ",170],["T_NEW","new",170],["T_WHITESPACE"," ",170],["T_STRING","BadRequestHttpException",170],"(",["T_CONSTANT_ENCAPSED_STRING","'The user has not been activated or is blocked.'",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$uid",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","userAuth",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","authenticate",173],"(",["T_VARIABLE","$credentials",173],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",173],"]",",",["T_WHITESPACE"," ",173],["T_VARIABLE","$credentials",173],"[",["T_CONSTANT_ENCAPSED_STRING","'pass'",173],"]",")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n      ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","flood",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","clear",174],"(",["T_CONSTANT_ENCAPSED_STRING","'user.http_login'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getLoginFloodIdentifier",174],"(",["T_VARIABLE","$request",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$credentials",174],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",174],"]",")",")",";",["T_WHITESPACE","\n      ",174],["T_DOC_COMMENT","\/** @var \\Drupal\\user\\UserInterface $user *\/",175],["T_WHITESPACE","\n      ",175],["T_VARIABLE","$user",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","userStorage",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","load",176],"(",["T_VARIABLE","$uid",176],")",";",["T_WHITESPACE","\n      ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","userLoginFinalize",177],"(",["T_VARIABLE","$user",177],")",";",["T_WHITESPACE","\n\n      ",177],["T_COMMENT","\/\/ Send basic metadata about the logged in user.\n",179],["T_WHITESPACE","      ",180],["T_VARIABLE","$response_data",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],"[","]",";",["T_WHITESPACE","\n      ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$user",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","get",181],"(",["T_CONSTANT_ENCAPSED_STRING","'uid'",181],")",["T_OBJECT_OPERATOR","->",181],["T_STRING","access",181],"(",["T_CONSTANT_ENCAPSED_STRING","'view'",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$user",181],")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$response_data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'current_user'",182],"]","[",["T_CONSTANT_ENCAPSED_STRING","'uid'",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$user",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","id",182],"(",")",";",["T_WHITESPACE","\n      ",182],"}",["T_WHITESPACE","\n      ",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$user",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","get",184],"(",["T_CONSTANT_ENCAPSED_STRING","'roles'",184],")",["T_OBJECT_OPERATOR","->",184],["T_STRING","access",184],"(",["T_CONSTANT_ENCAPSED_STRING","'view'",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$user",184],")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$response_data",185],"[",["T_CONSTANT_ENCAPSED_STRING","'current_user'",185],"]","[",["T_CONSTANT_ENCAPSED_STRING","'roles'",185],"]",["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$user",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getRoles",185],"(",")",";",["T_WHITESPACE","\n      ",185],"}",["T_WHITESPACE","\n      ",186],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$user",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","get",187],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",187],")",["T_OBJECT_OPERATOR","->",187],["T_STRING","access",187],"(",["T_CONSTANT_ENCAPSED_STRING","'view'",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$user",187],")",")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$response_data",188],"[",["T_CONSTANT_ENCAPSED_STRING","'current_user'",188],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",188],"]",["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$user",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getAccountName",188],"(",")",";",["T_WHITESPACE","\n      ",188],"}",["T_WHITESPACE","\n      ",189],["T_VARIABLE","$response_data",190],"[",["T_CONSTANT_ENCAPSED_STRING","'csrf_token'",190],"]",["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","csrfToken",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","get",190],"(",["T_CONSTANT_ENCAPSED_STRING","'rest'",190],")",";",["T_WHITESPACE","\n\n      ",190],["T_VARIABLE","$logout_route",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","routeProvider",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getRouteByName",192],"(",["T_CONSTANT_ENCAPSED_STRING","'user.logout.http'",192],")",";",["T_WHITESPACE","\n      ",192],["T_COMMENT","\/\/ Trim '\/' off path to match \\Drupal\\Core\\Access\\CsrfAccessCheck.\n",193],["T_WHITESPACE","      ",194],["T_VARIABLE","$logout_path",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","ltrim",194],"(",["T_VARIABLE","$logout_route",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getPath",194],"(",")",",",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'\/'",194],")",";",["T_WHITESPACE","\n      ",194],["T_VARIABLE","$response_data",195],"[",["T_CONSTANT_ENCAPSED_STRING","'logout_token'",195],"]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","csrfToken",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","get",195],"(",["T_VARIABLE","$logout_path",195],")",";",["T_WHITESPACE","\n\n      ",195],["T_VARIABLE","$encoded_response_data",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","serializer",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","encode",197],"(",["T_VARIABLE","$response_data",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$format",197],")",";",["T_WHITESPACE","\n      ",197],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_NEW","new",198],["T_WHITESPACE"," ",198],["T_STRING","Response",198],"(",["T_VARIABLE","$encoded_response_data",198],")",";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_VARIABLE","$flood_config",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","config",201],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",201],")",";",["T_WHITESPACE","\n    ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$identifier",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getLoginFloodIdentifier",202],"(",["T_VARIABLE","$request",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$credentials",202],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",202],"]",")",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n      ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","flood",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","register",203],"(",["T_CONSTANT_ENCAPSED_STRING","'user.http_login'",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$flood_config",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","get",203],"(",["T_CONSTANT_ENCAPSED_STRING","'user_window'",203],")",",",["T_WHITESPACE"," ",203],["T_VARIABLE","$identifier",203],")",";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n    ",204],["T_COMMENT","\/\/ Always register an IP-based failed login event.\n",205],["T_WHITESPACE","    ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","flood",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","register",206],"(",["T_CONSTANT_ENCAPSED_STRING","'user.failed_login_ip'",206],",",["T_WHITESPACE"," ",206],["T_VARIABLE","$flood_config",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","get",206],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_window'",206],")",")",";",["T_WHITESPACE","\n    ",206],["T_THROW","throw",207],["T_WHITESPACE"," ",207],["T_NEW","new",207],["T_WHITESPACE"," ",207],["T_STRING","BadRequestHttpException",207],"(",["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",207],")",";",["T_WHITESPACE","\n  ",207],"}",["T_WHITESPACE","\n\n  ",208],["T_DOC_COMMENT","\/**\n   * Verifies if the user is blocked.\n   *\n   * @param string $name\n   *   The username.\n   *\n   * @return bool\n   *   TRUE if the user is blocked, otherwise FALSE.\n   *\/",210],["T_WHITESPACE","\n  ",218],["T_PROTECTED","protected",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","userIsBlocked",219],"(",["T_VARIABLE","$name",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n    ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_STRING","user_is_blocked",220],"(",["T_VARIABLE","$name",220],")",";",["T_WHITESPACE","\n  ",220],"}",["T_WHITESPACE","\n\n  ",221],["T_DOC_COMMENT","\/**\n   * Finalizes the user login.\n   *\n   * @param \\Drupal\\user\\UserInterface $user\n   *   The user.\n   *\/",223],["T_WHITESPACE","\n  ",228],["T_PROTECTED","protected",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","userLoginFinalize",229],"(",["T_STRING","UserInterface",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$user",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n    ",229],["T_STRING","user_login_finalize",230],"(",["T_VARIABLE","$user",230],")",";",["T_WHITESPACE","\n  ",230],"}",["T_WHITESPACE","\n\n  ",231],["T_DOC_COMMENT","\/**\n   * Logs out a user.\n   *\n   * @return \\Symfony\\Component\\HttpFoundation\\Response\n   *   The response object.\n   *\/",233],["T_WHITESPACE","\n  ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","logout",239],"(",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n    ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","userLogout",240],"(",")",";",["T_WHITESPACE","\n    ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_NEW","new",241],["T_WHITESPACE"," ",241],["T_STRING","Response",241],"(",["T_STRING","NULL",241],",",["T_WHITESPACE"," ",241],["T_LNUMBER","204",241],")",";",["T_WHITESPACE","\n  ",241],"}",["T_WHITESPACE","\n\n  ",242],["T_DOC_COMMENT","\/**\n   * Logs the user out.\n   *\/",244],["T_WHITESPACE","\n  ",246],["T_PROTECTED","protected",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","userLogout",247],"(",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n    ",247],["T_STRING","user_logout",248],"(",")",";",["T_WHITESPACE","\n  ",248],"}",["T_WHITESPACE","\n\n  ",249],["T_DOC_COMMENT","\/**\n   * Checks whether a user is logged in or not.\n   *\n   * @return \\Symfony\\Component\\HttpFoundation\\Response\n   *   The response.\n   *\/",251],["T_WHITESPACE","\n  ",256],["T_PUBLIC","public",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","loginStatus",257],"(",")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n    ",257],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","currentUser",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","isAuthenticated",258],"(",")",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n      ",258],["T_VARIABLE","$response",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_NEW","new",259],["T_WHITESPACE"," ",259],["T_STRING","Response",259],"(",["T_STRING","self",259],["T_DOUBLE_COLON","::",259],["T_STRING","LOGGED_IN",259],")",";",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n    ",260],["T_ELSE","else",261],["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n      ",261],["T_VARIABLE","$response",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_NEW","new",262],["T_WHITESPACE"," ",262],["T_STRING","Response",262],"(",["T_STRING","self",262],["T_DOUBLE_COLON","::",262],["T_STRING","LOGGED_OUT",262],")",";",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n    ",263],["T_VARIABLE","$response",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","headers",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","set",264],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",264],",",["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",264],")",";",["T_WHITESPACE","\n    ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$response",265],";",["T_WHITESPACE","\n  ",265],"}",["T_WHITESPACE","\n\n  ",266],["T_DOC_COMMENT","\/**\n   * Gets the format of the current request.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The current request.\n   *\n   * @return string\n   *   The format of the request.\n   *\/",268],["T_WHITESPACE","\n  ",276],["T_PROTECTED","protected",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","getRequestFormat",277],"(",["T_STRING","Request",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$request",277],")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n    ",277],["T_VARIABLE","$format",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$request",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getRequestFormat",278],"(",")",";",["T_WHITESPACE","\n    ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(","!",["T_STRING","in_array",279],"(",["T_VARIABLE","$format",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","serializerFormats",279],")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n      ",279],["T_THROW","throw",280],["T_WHITESPACE"," ",280],["T_NEW","new",280],["T_WHITESPACE"," ",280],["T_STRING","BadRequestHttpException",280],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Unrecognized format: ",280],["T_VARIABLE","$format",280],["T_ENCAPSED_AND_WHITESPACE",".",280],"\"",")",";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n    ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$format",282],";",["T_WHITESPACE","\n  ",282],"}",["T_WHITESPACE","\n\n  ",283],["T_DOC_COMMENT","\/**\n   * Enforces flood control for the current login request.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The current request.\n   * @param string $username\n   *   The user name sent for login credentials.\n   *\/",285],["T_WHITESPACE","\n  ",292],["T_PROTECTED","protected",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","floodControl",293],"(",["T_STRING","Request",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$request",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$username",293],")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n    ",293],["T_VARIABLE","$flood_config",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","config",294],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",294],")",";",["T_WHITESPACE","\n    ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(","!",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","flood",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","isAllowed",295],"(",["T_CONSTANT_ENCAPSED_STRING","'user.failed_login_ip'",295],",",["T_WHITESPACE"," ",295],["T_VARIABLE","$flood_config",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","get",295],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",295],")",",",["T_WHITESPACE"," ",295],["T_VARIABLE","$flood_config",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","get",295],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_window'",295],")",")",")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n      ",295],["T_THROW","throw",296],["T_WHITESPACE"," ",296],["T_NEW","new",296],["T_WHITESPACE"," ",296],["T_STRING","AccessDeniedHttpException",296],"(",["T_CONSTANT_ENCAPSED_STRING","'Access is blocked because of IP based flood prevention.'",296],",",["T_WHITESPACE"," ",296],["T_STRING","NULL",296],",",["T_WHITESPACE"," ",296],["T_STRING","Response",296],["T_DOUBLE_COLON","::",296],["T_STRING","HTTP_TOO_MANY_REQUESTS",296],")",";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_IF","if",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$identifier",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getLoginFloodIdentifier",299],"(",["T_VARIABLE","$request",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$username",299],")",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n      ",299],["T_COMMENT","\/\/ Don't allow login if the limit for this user has been reached.\n",300],["T_WHITESPACE","      ",301],["T_COMMENT","\/\/ Default is to allow 5 failed attempts every 6 hours.\n",301],["T_WHITESPACE","      ",302],["T_IF","if",302],["T_WHITESPACE"," ",302],"(","!",["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","flood",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","isAllowed",302],"(",["T_CONSTANT_ENCAPSED_STRING","'user.http_login'",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$flood_config",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","get",302],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",302],")",",",["T_WHITESPACE"," ",302],["T_VARIABLE","$flood_config",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","get",302],"(",["T_CONSTANT_ENCAPSED_STRING","'user_window'",302],")",",",["T_WHITESPACE"," ",302],["T_VARIABLE","$identifier",302],")",")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n        ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$flood_config",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","get",303],"(",["T_CONSTANT_ENCAPSED_STRING","'uid_only'",303],")",")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n          ",303],["T_VARIABLE","$error_message",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_STRING","sprintf",304],"(",["T_CONSTANT_ENCAPSED_STRING","'There have been more than %s failed login attempts for this account. It is temporarily blocked. Try again later or request a new password.'",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$flood_config",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","get",304],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",304],")",")",";",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n          ",306],["T_VARIABLE","$error_message",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'Too many failed login attempts from your IP address. This IP address is temporarily blocked.'",307],";",["T_WHITESPACE","\n        ",307],"}",["T_WHITESPACE","\n        ",308],["T_THROW","throw",309],["T_WHITESPACE"," ",309],["T_NEW","new",309],["T_WHITESPACE"," ",309],["T_STRING","AccessDeniedHttpException",309],"(",["T_VARIABLE","$error_message",309],",",["T_WHITESPACE"," ",309],["T_STRING","NULL",309],",",["T_WHITESPACE"," ",309],["T_STRING","Response",309],["T_DOUBLE_COLON","::",309],["T_STRING","HTTP_TOO_MANY_REQUESTS",309],")",";",["T_WHITESPACE","\n      ",309],"}",["T_WHITESPACE","\n    ",310],"}",["T_WHITESPACE","\n  ",311],"}",["T_WHITESPACE","\n\n  ",312],["T_DOC_COMMENT","\/**\n   * Gets the login identifier for user login flood control.\n   *\n   * @param \\Symfony\\Component\\HttpFoundation\\Request $request\n   *   The current request.\n   * @param string $username\n   *   The username supplied in login credentials.\n   *\n   * @return string\n   *   The login identifier or if the user does not exist an empty string.\n   *\/",314],["T_WHITESPACE","\n  ",324],["T_PROTECTED","protected",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","getLoginFloodIdentifier",325],"(",["T_STRING","Request",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$request",325],",",["T_WHITESPACE"," ",325],["T_VARIABLE","$username",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n    ",325],["T_VARIABLE","$flood_config",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","config",326],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",326],")",";",["T_WHITESPACE","\n    ",326],["T_VARIABLE","$accounts",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","userStorage",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","loadByProperties",327],"(","[",["T_CONSTANT_ENCAPSED_STRING","'name'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$username",327],",",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'status'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_LNUMBER","1",327],"]",")",";",["T_WHITESPACE","\n    ",327],["T_IF","if",328],["T_WHITESPACE"," ",328],"(",["T_VARIABLE","$account",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_STRING","reset",328],"(",["T_VARIABLE","$accounts",328],")",")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n      ",328],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$flood_config",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","get",329],"(",["T_CONSTANT_ENCAPSED_STRING","'uid_only'",329],")",")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n        ",329],["T_COMMENT","\/\/ Register flood events based on the uid only, so they apply for any\n",330],["T_WHITESPACE","        ",331],["T_COMMENT","\/\/ IP address. This is the most secure option.\n",331],["T_WHITESPACE","        ",332],["T_VARIABLE","$identifier",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$account",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","id",332],"(",")",";",["T_WHITESPACE","\n      ",332],"}",["T_WHITESPACE","\n      ",333],["T_ELSE","else",334],["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n        ",334],["T_COMMENT","\/\/ The default identifier is a combination of uid and IP address. This\n",335],["T_WHITESPACE","        ",336],["T_COMMENT","\/\/ is less secure but more resistant to denial-of-service attacks that\n",336],["T_WHITESPACE","        ",337],["T_COMMENT","\/\/ could lock out all users with public user names.\n",337],["T_WHITESPACE","        ",338],["T_VARIABLE","$identifier",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_VARIABLE","$account",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","id",338],"(",")",["T_WHITESPACE"," ",338],".",["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","'-'",338],["T_WHITESPACE"," ",338],".",["T_WHITESPACE"," ",338],["T_VARIABLE","$request",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getClientIp",338],"(",")",";",["T_WHITESPACE","\n      ",338],"}",["T_WHITESPACE","\n      ",339],["T_RETURN","return",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$identifier",340],";",["T_WHITESPACE","\n    ",340],"}",["T_WHITESPACE","\n    ",341],["T_RETURN","return",342],["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","''",342],";",["T_WHITESPACE","\n  ",342],"}",["T_WHITESPACE","\n\n",343],"}",["T_WHITESPACE","\n",345]]