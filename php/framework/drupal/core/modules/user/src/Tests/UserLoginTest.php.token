[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","simpletest",5],["T_NS_SEPARATOR","\\",5],["T_STRING","WebTestBase",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","user",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Entity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","User",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Ensure that login works as expected.\n *\n * @group user\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","UserLoginTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","WebTestBase",13],["T_WHITESPACE"," ",13],"{",["T_WHITESPACE","\n\n  ",13],["T_DOC_COMMENT","\/**\n   * Tests login with destination.\n   *\/",15],["T_WHITESPACE","\n  ",17],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","testLoginCacheTagsAndDestination",18],"(",")",["T_WHITESPACE"," ",18],"{",["T_WHITESPACE","\n    ",18],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","drupalGet",19],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/login'",19],")",";",["T_WHITESPACE","\n    ",19],["T_COMMENT","\/\/ The user login form says \"Enter your <site name> username.\", hence it\n",20],["T_WHITESPACE","    ",21],["T_COMMENT","\/\/ depends on config:system.site, and its cache tags should be present.\n",21],["T_WHITESPACE","    ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","assertCacheTag",22],"(",["T_CONSTANT_ENCAPSED_STRING","'config:system.site'",22],")",";",["T_WHITESPACE","\n\n    ",22],["T_VARIABLE","$user",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","drupalCreateUser",24],"(",["T_ARRAY","array",24],"(",")",")",";",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","drupalGet",25],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/login'",25],",",["T_WHITESPACE"," ",25],["T_ARRAY","array",25],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_ARRAY","array",25],"(",["T_CONSTANT_ENCAPSED_STRING","'destination'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'foo'",25],")",")",")",";",["T_WHITESPACE","\n    ",25],["T_VARIABLE","$edit",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_ARRAY","array",26],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$user",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","getUserName",26],"(",")",",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'pass'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$user",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","pass_raw",26],")",";",["T_WHITESPACE","\n    ",26],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","drupalPostForm",27],"(",["T_STRING","NULL",27],",",["T_WHITESPACE"," ",27],["T_VARIABLE","$edit",27],",",["T_WHITESPACE"," ",27],["T_STRING","t",27],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",27],")",")",";",["T_WHITESPACE","\n    ",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","assertUrl",28],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",28],",",["T_WHITESPACE"," ",28],"[","]",",",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'Redirected to the correct URL'",28],")",";",["T_WHITESPACE","\n  ",28],"}",["T_WHITESPACE","\n\n  ",29],["T_DOC_COMMENT","\/**\n   * Test the global login flood control.\n   *\/",31],["T_WHITESPACE","\n  ",33],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","testGlobalLoginFloodControl",34],"(",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n    ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","config",35],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",35],")",["T_WHITESPACE","\n      ",35],["T_OBJECT_OPERATOR","->",36],["T_STRING","set",36],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",36],",",["T_WHITESPACE"," ",36],["T_LNUMBER","10",36],")",["T_WHITESPACE","\n      ",36],["T_COMMENT","\/\/ Set a high per-user limit out so that it is not relevant in the test.\n",37],["T_WHITESPACE","      ",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","set",38],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",38],",",["T_WHITESPACE"," ",38],["T_LNUMBER","4000",38],")",["T_WHITESPACE","\n      ",38],["T_OBJECT_OPERATOR","->",39],["T_STRING","save",39],"(",")",";",["T_WHITESPACE","\n\n    ",39],["T_VARIABLE","$user1",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","drupalCreateUser",41],"(",["T_ARRAY","array",41],"(",")",")",";",["T_WHITESPACE","\n    ",41],["T_VARIABLE","$incorrect_user1",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CLONE","clone",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$user1",42],";",["T_WHITESPACE","\n    ",42],["T_VARIABLE","$incorrect_user1",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","pass_raw",43],["T_WHITESPACE"," ",43],["T_CONCAT_EQUAL",".=",43],["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'incorrect'",43],";",["T_WHITESPACE","\n\n    ",43],["T_COMMENT","\/\/ Try 2 failed logins.\n",45],["T_WHITESPACE","    ",46],["T_FOR","for",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$i",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_LNUMBER","0",46],";",["T_WHITESPACE"," ",46],["T_VARIABLE","$i",46],["T_WHITESPACE"," ",46],"<",["T_WHITESPACE"," ",46],["T_LNUMBER","2",46],";",["T_WHITESPACE"," ",46],["T_VARIABLE","$i",46],["T_INC","++",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n      ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertFailedLogin",47],"(",["T_VARIABLE","$incorrect_user1",47],")",";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/\/ A successful login will not reset the IP-based flood control count.\n",50],["T_WHITESPACE","    ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalLogin",51],"(",["T_VARIABLE","$user1",51],")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","drupalLogout",52],"(",")",";",["T_WHITESPACE","\n\n    ",52],["T_COMMENT","\/\/ Try 8 more failed logins, they should not trigger the flood control\n",54],["T_WHITESPACE","    ",55],["T_COMMENT","\/\/ mechanism.\n",55],["T_WHITESPACE","    ",56],["T_FOR","for",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$i",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_LNUMBER","0",56],";",["T_WHITESPACE"," ",56],["T_VARIABLE","$i",56],["T_WHITESPACE"," ",56],"<",["T_WHITESPACE"," ",56],["T_LNUMBER","8",56],";",["T_WHITESPACE"," ",56],["T_VARIABLE","$i",56],["T_INC","++",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n      ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertFailedLogin",57],"(",["T_VARIABLE","$incorrect_user1",57],")",";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ The next login trial should result in an IP-based flood error message.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertFailedLogin",61],"(",["T_VARIABLE","$incorrect_user1",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'ip'",61],")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ A login with the correct password should also result in a flood error\n",63],["T_WHITESPACE","    ",64],["T_COMMENT","\/\/ message.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertFailedLogin",65],"(",["T_VARIABLE","$user1",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'ip'",65],")",";",["T_WHITESPACE","\n  ",65],"}",["T_WHITESPACE","\n\n  ",66],["T_DOC_COMMENT","\/**\n   * Test the per-user login flood control.\n   *\/",68],["T_WHITESPACE","\n  ",70],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","testPerUserLoginFloodControl",71],"(",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","config",72],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",72],")",["T_WHITESPACE","\n      ",72],["T_COMMENT","\/\/ Set a high global limit out so that it is not relevant in the test.\n",73],["T_WHITESPACE","      ",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","set",74],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",74],",",["T_WHITESPACE"," ",74],["T_LNUMBER","4000",74],")",["T_WHITESPACE","\n      ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","set",75],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",75],",",["T_WHITESPACE"," ",75],["T_LNUMBER","3",75],")",["T_WHITESPACE","\n      ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","save",76],"(",")",";",["T_WHITESPACE","\n\n    ",76],["T_VARIABLE","$user1",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","drupalCreateUser",78],"(",["T_ARRAY","array",78],"(",")",")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$incorrect_user1",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_CLONE","clone",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$user1",79],";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$incorrect_user1",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","pass_raw",80],["T_WHITESPACE"," ",80],["T_CONCAT_EQUAL",".=",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'incorrect'",80],";",["T_WHITESPACE","\n\n    ",80],["T_VARIABLE","$user2",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","drupalCreateUser",82],"(",["T_ARRAY","array",82],"(",")",")",";",["T_WHITESPACE","\n\n    ",82],["T_COMMENT","\/\/ Try 2 failed logins.\n",84],["T_WHITESPACE","    ",85],["T_FOR","for",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$i",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_LNUMBER","0",85],";",["T_WHITESPACE"," ",85],["T_VARIABLE","$i",85],["T_WHITESPACE"," ",85],"<",["T_WHITESPACE"," ",85],["T_LNUMBER","2",85],";",["T_WHITESPACE"," ",85],["T_VARIABLE","$i",85],["T_INC","++",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n      ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertFailedLogin",86],"(",["T_VARIABLE","$incorrect_user1",86],")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_COMMENT","\/\/ A successful login will reset the per-user flood control count.\n",89],["T_WHITESPACE","    ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","drupalLogin",90],"(",["T_VARIABLE","$user1",90],")",";",["T_WHITESPACE","\n    ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","drupalLogout",91],"(",")",";",["T_WHITESPACE","\n\n    ",91],["T_COMMENT","\/\/ Try 3 failed logins for user 1, they will not trigger flood control.\n",93],["T_WHITESPACE","    ",94],["T_FOR","for",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$i",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_LNUMBER","0",94],";",["T_WHITESPACE"," ",94],["T_VARIABLE","$i",94],["T_WHITESPACE"," ",94],"<",["T_WHITESPACE"," ",94],["T_LNUMBER","3",94],";",["T_WHITESPACE"," ",94],["T_VARIABLE","$i",94],["T_INC","++",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n      ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertFailedLogin",95],"(",["T_VARIABLE","$incorrect_user1",95],")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_COMMENT","\/\/ Try one successful attempt for user 2, it should not trigger any\n",98],["T_WHITESPACE","    ",99],["T_COMMENT","\/\/ flood control.\n",99],["T_WHITESPACE","    ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","drupalLogin",100],"(",["T_VARIABLE","$user2",100],")",";",["T_WHITESPACE","\n    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","drupalLogout",101],"(",")",";",["T_WHITESPACE","\n\n    ",101],["T_COMMENT","\/\/ Try one more attempt for user 1, it should be rejected, even if the\n",103],["T_WHITESPACE","    ",104],["T_COMMENT","\/\/ correct password has been used.\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","assertFailedLogin",105],"(",["T_VARIABLE","$user1",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'user'",105],")",";",["T_WHITESPACE","\n  ",105],"}",["T_WHITESPACE","\n\n  ",106],["T_DOC_COMMENT","\/**\n   * Test that user password is re-hashed upon login after changing $count_log2.\n   *\/",108],["T_WHITESPACE","\n  ",110],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","testPasswordRehashOnLogin",111],"(",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n    ",111],["T_COMMENT","\/\/ Determine default log2 for phpass hashing algorithm\n",112],["T_WHITESPACE","    ",113],["T_VARIABLE","$default_count_log2",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_LNUMBER","16",113],";",["T_WHITESPACE","\n\n    ",113],["T_COMMENT","\/\/ Retrieve instance of password hashing algorithm\n",115],["T_WHITESPACE","    ",116],["T_VARIABLE","$password_hasher",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","container",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","get",116],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",116],")",";",["T_WHITESPACE","\n\n    ",116],["T_COMMENT","\/\/ Create a new user and authenticate.\n",118],["T_WHITESPACE","    ",119],["T_VARIABLE","$account",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","drupalCreateUser",119],"(",["T_ARRAY","array",119],"(",")",")",";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$password",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$account",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","pass_raw",120],";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","drupalLogin",121],"(",["T_VARIABLE","$account",121],")",";",["T_WHITESPACE","\n    ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","drupalLogout",122],"(",")",";",["T_WHITESPACE","\n    ",122],["T_COMMENT","\/\/ Load the stored user. The password hash should reflect $default_count_log2.\n",123],["T_WHITESPACE","    ",124],["T_VARIABLE","$user_storage",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","container",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","get",124],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","getStorage",124],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",124],")",";",["T_WHITESPACE","\n    ",124],["T_VARIABLE","$account",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","User",125],["T_DOUBLE_COLON","::",125],["T_STRING","load",125],"(",["T_VARIABLE","$account",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","id",125],"(",")",")",";",["T_WHITESPACE","\n    ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","assertIdentical",126],"(",["T_VARIABLE","$password_hasher",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getCountLog2",126],"(",["T_VARIABLE","$account",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getPassword",126],"(",")",")",",",["T_WHITESPACE"," ",126],["T_VARIABLE","$default_count_log2",126],")",";",["T_WHITESPACE","\n\n    ",126],["T_COMMENT","\/\/ Change the required number of iterations by loading a test-module\n",128],["T_WHITESPACE","    ",129],["T_COMMENT","\/\/ containing the necessary container builder code and then verify that the\n",129],["T_WHITESPACE","    ",130],["T_COMMENT","\/\/ users password gets rehashed during the login.\n",130],["T_WHITESPACE","    ",131],["T_VARIABLE","$overridden_count_log2",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_LNUMBER","19",131],";",["T_WHITESPACE","\n    ",131],["T_NS_SEPARATOR","\\",132],["T_STRING","Drupal",132],["T_DOUBLE_COLON","::",132],["T_STRING","service",132],"(",["T_CONSTANT_ENCAPSED_STRING","'module_installer'",132],")",["T_OBJECT_OPERATOR","->",132],["T_STRING","install",132],"(",["T_ARRAY","array",132],"(",["T_CONSTANT_ENCAPSED_STRING","'user_custom_phpass_params_test'",132],")",")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","resetAll",133],"(",")",";",["T_WHITESPACE","\n\n    ",133],["T_VARIABLE","$account",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","pass_raw",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$password",135],";",["T_WHITESPACE","\n    ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","drupalLogin",136],"(",["T_VARIABLE","$account",136],")",";",["T_WHITESPACE","\n    ",136],["T_COMMENT","\/\/ Load the stored user, which should have a different password hash now.\n",137],["T_WHITESPACE","    ",138],["T_VARIABLE","$user_storage",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","resetCache",138],"(",["T_ARRAY","array",138],"(",["T_VARIABLE","$account",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","id",138],"(",")",")",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$account",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$user_storage",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","load",139],"(",["T_VARIABLE","$account",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","id",139],"(",")",")",";",["T_WHITESPACE","\n    ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","assertIdentical",140],"(",["T_VARIABLE","$password_hasher",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getCountLog2",140],"(",["T_VARIABLE","$account",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getPassword",140],"(",")",")",",",["T_WHITESPACE"," ",140],["T_VARIABLE","$overridden_count_log2",140],")",";",["T_WHITESPACE","\n    ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","assertTrue",141],"(",["T_VARIABLE","$password_hasher",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","check",141],"(",["T_VARIABLE","$password",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$account",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getPassword",141],"(",")",")",")",";",["T_WHITESPACE","\n  ",141],"}",["T_WHITESPACE","\n\n  ",142],["T_DOC_COMMENT","\/**\n   * Make an unsuccessful login attempt.\n   *\n   * @param \\Drupal\\user\\Entity\\User $account\n   *   A user object with name and pass_raw attributes for the login attempt.\n   * @param mixed $flood_trigger\n   *   (optional) Whether or not to expect that the flood control mechanism\n   *    will be triggered. Defaults to NULL.\n   *   - Set to 'user' to expect a 'too many failed logins error.\n   *   - Set to any value to expect an error for too many failed logins per IP\n   *   .\n   *   - Set to NULL to expect a failed login.\n   *\/",144],["T_WHITESPACE","\n  ",156],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","assertFailedLogin",157],"(",["T_VARIABLE","$account",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$flood_trigger",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","NULL",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n    ",157],["T_VARIABLE","$edit",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_ARRAY","array",158],"(",["T_WHITESPACE","\n      ",158],["T_CONSTANT_ENCAPSED_STRING","'name'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$account",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getUsername",159],"(",")",",",["T_WHITESPACE","\n      ",159],["T_CONSTANT_ENCAPSED_STRING","'pass'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$account",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","pass_raw",160],",",["T_WHITESPACE","\n    ",160],")",";",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","drupalPostForm",162],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/login'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$edit",162],",",["T_WHITESPACE"," ",162],["T_STRING","t",162],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",162],")",")",";",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertNoFieldByXPath",163],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/\/input[@name='pass' and @value!='']\"",163],",",["T_WHITESPACE"," ",163],["T_STRING","NULL",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'Password value attribute is blank.'",163],")",";",["T_WHITESPACE","\n    ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_ISSET","isset",164],"(",["T_VARIABLE","$flood_trigger",164],")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n      ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$flood_trigger",165],["T_WHITESPACE"," ",165],["T_IS_EQUAL","==",165],["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'user'",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","assertRaw",166],"(",["T_NS_SEPARATOR","\\",166],["T_STRING","Drupal",166],["T_DOUBLE_COLON","::",166],["T_STRING","translation",166],"(",")",["T_OBJECT_OPERATOR","->",166],["T_STRING","formatPlural",166],"(",["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","config",166],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",166],")",["T_OBJECT_OPERATOR","->",166],["T_STRING","get",166],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",166],")",",",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'There has been more than one failed login attempt for this account. It is temporarily blocked. Try again later or <a href=\":url\">request a new password<\/a>.'",166],",",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'There have been more than @count failed login attempts for this account. It is temporarily blocked. Try again later or <a href=\":url\">request a new password<\/a>.'",166],",",["T_WHITESPACE"," ",166],["T_ARRAY","array",166],"(",["T_CONSTANT_ENCAPSED_STRING","':url'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Drupal",166],["T_DOUBLE_COLON","::",166],["T_STRING","url",166],"(",["T_CONSTANT_ENCAPSED_STRING","'user.pass'",166],")",")",")",")",";",["T_WHITESPACE","\n      ",166],"}",["T_WHITESPACE","\n      ",167],["T_ELSE","else",168],["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n        ",168],["T_COMMENT","\/\/ No uid, so the limit is IP-based.\n",169],["T_WHITESPACE","        ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","assertRaw",170],"(",["T_STRING","t",170],"(",["T_CONSTANT_ENCAPSED_STRING","'Too many failed login attempts from your IP address. This IP address is temporarily blocked. Try again later or <a href=\":url\">request a new password<\/a>.'",170],",",["T_WHITESPACE"," ",170],["T_ARRAY","array",170],"(",["T_CONSTANT_ENCAPSED_STRING","':url'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_NS_SEPARATOR","\\",170],["T_STRING","Drupal",170],["T_DOUBLE_COLON","::",170],["T_STRING","url",170],"(",["T_CONSTANT_ENCAPSED_STRING","'user.pass'",170],")",")",")",")",";",["T_WHITESPACE","\n      ",170],"}",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n    ",172],["T_ELSE","else",173],["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n      ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","assertText",174],"(",["T_STRING","t",174],"(",["T_CONSTANT_ENCAPSED_STRING","'Unrecognized username or password. Forgot your password?'",174],")",")",";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n  ",175],"}",["T_WHITESPACE","\n\n",176],"}",["T_WHITESPACE","\n",178]]