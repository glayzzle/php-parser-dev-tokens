[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","simpletest",5],["T_NS_SEPARATOR","\\",5],["T_STRING","WebTestBase",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","user",6],["T_NS_SEPARATOR","\\",6],["T_STRING","RoleInterface",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","user",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Entity",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Role",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Verify that role permissions can be added and removed via the permissions\n * page.\n *\n * @group user\n *\/",9],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","UserPermissionsTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","WebTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * User with admin privileges.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",17],["T_WHITESPACE","\n  ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$adminUser",22],";",["T_WHITESPACE","\n\n  ",22],["T_DOC_COMMENT","\/**\n   * User's role ID.\n   *\n   * @var string\n   *\/",24],["T_WHITESPACE","\n  ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$rid",29],";",["T_WHITESPACE","\n\n  ",29],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","setUp",31],"(",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n    ",31],["T_STRING","parent",32],["T_DOUBLE_COLON","::",32],["T_STRING","setUp",32],"(",")",";",["T_WHITESPACE","\n\n    ",32],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","adminUser",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","drupalCreateUser",34],"(",["T_ARRAY","array",34],"(",["T_CONSTANT_ENCAPSED_STRING","'administer permissions'",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'administer site configuration'",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'administer modules'",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'administer account settings'",34],")",")",";",["T_WHITESPACE","\n\n    ",34],["T_COMMENT","\/\/ Find the new role ID.\n",36],["T_WHITESPACE","    ",37],["T_VARIABLE","$all_rids",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","adminUser",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getRoles",37],"(",")",";",["T_WHITESPACE","\n    ",37],["T_UNSET","unset",38],"(",["T_VARIABLE","$all_rids",38],"[",["T_STRING","array_search",38],"(",["T_STRING","RoleInterface",38],["T_DOUBLE_COLON","::",38],["T_STRING","AUTHENTICATED_ID",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$all_rids",38],")","]",")",";",["T_WHITESPACE","\n    ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","rid",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","reset",39],"(",["T_VARIABLE","$all_rids",39],")",";",["T_WHITESPACE","\n  ",39],"}",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * Test changing user permissions through the permissions page.\n   *\/",42],["T_WHITESPACE","\n  ",44],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testUserPermissionChanges",45],"(",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$permissions_hash_generator",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","container",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","get",46],"(",["T_CONSTANT_ENCAPSED_STRING","'user_permissions_hash_generator'",46],")",";",["T_WHITESPACE","\n\n    ",46],["T_VARIABLE","$storage",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","container",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","get",48],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",48],")",["T_OBJECT_OPERATOR","->",48],["T_STRING","getStorage",48],"(",["T_CONSTANT_ENCAPSED_STRING","'user_role'",48],")",";",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/\/ Create an additional role and mark it as admin role.\n",50],["T_WHITESPACE","    ",51],["T_STRING","Role",51],["T_DOUBLE_COLON","::",51],["T_STRING","create",51],"(","[",["T_CONSTANT_ENCAPSED_STRING","'is_admin'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_STRING","TRUE",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'id'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'administrator'",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'label'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'Administrator'",51],"]",")",["T_OBJECT_OPERATOR","->",51],["T_STRING","save",51],"(",")",";",["T_WHITESPACE","\n    ",51],["T_VARIABLE","$storage",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","resetCache",52],"(",")",";",["T_WHITESPACE","\n\n    ",52],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","drupalLogin",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","adminUser",54],")",";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$rid",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","rid",55],";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$account",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","adminUser",56],";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$previous_permissions_hash",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$permissions_hash_generator",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","generate",57],"(",["T_VARIABLE","$account",57],")",";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertIdentical",58],"(",["T_VARIABLE","$previous_permissions_hash",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$permissions_hash_generator",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","generate",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","loggedInUser",58],")",")",";",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ Add a permission.\n",60],["T_WHITESPACE","    ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertFalse",61],"(",["T_VARIABLE","$account",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","hasPermission",61],"(",["T_CONSTANT_ENCAPSED_STRING","'administer users'",61],")",",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'User does not have \"administer users\" permission.'",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$edit",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$edit",63],"[",["T_VARIABLE","$rid",63],["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'[administer users]'",63],"]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","TRUE",63],";",["T_WHITESPACE","\n    ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","drupalPostForm",64],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/people\/permissions'",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$edit",64],",",["T_WHITESPACE"," ",64],["T_STRING","t",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Save permissions'",64],")",")",";",["T_WHITESPACE","\n    ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertText",65],"(",["T_STRING","t",65],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",65],")",",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'Successful save message displayed.'",65],")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$storage",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","resetCache",66],"(",")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertTrue",67],"(",["T_VARIABLE","$account",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","hasPermission",67],"(",["T_CONSTANT_ENCAPSED_STRING","'administer users'",67],")",",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'User now has \"administer users\" permission.'",67],")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$current_permissions_hash",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$permissions_hash_generator",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","generate",68],"(",["T_VARIABLE","$account",68],")",";",["T_WHITESPACE","\n    ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertIdentical",69],"(",["T_VARIABLE","$current_permissions_hash",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$permissions_hash_generator",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","generate",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","loggedInUser",69],")",")",";",["T_WHITESPACE","\n    ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertNotEqual",70],"(",["T_VARIABLE","$previous_permissions_hash",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$current_permissions_hash",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'Permissions hash has changed.'",70],")",";",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$previous_permissions_hash",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$current_permissions_hash",71],";",["T_WHITESPACE","\n\n    ",71],["T_COMMENT","\/\/ Remove a permission.\n",73],["T_WHITESPACE","    ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","assertTrue",74],"(",["T_VARIABLE","$account",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","hasPermission",74],"(",["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",74],")",",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'User has \"access user profiles\" permission.'",74],")",";",["T_WHITESPACE","\n    ",74],["T_VARIABLE","$edit",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_ARRAY","array",75],"(",")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$edit",76],"[",["T_VARIABLE","$rid",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'[access user profiles]'",76],"]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","FALSE",76],";",["T_WHITESPACE","\n    ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","drupalPostForm",77],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/people\/permissions'",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$edit",77],",",["T_WHITESPACE"," ",77],["T_STRING","t",77],"(",["T_CONSTANT_ENCAPSED_STRING","'Save permissions'",77],")",")",";",["T_WHITESPACE","\n    ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertText",78],"(",["T_STRING","t",78],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",78],")",",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'Successful save message displayed.'",78],")",";",["T_WHITESPACE","\n    ",78],["T_VARIABLE","$storage",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","resetCache",79],"(",")",";",["T_WHITESPACE","\n    ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","assertFalse",80],"(",["T_VARIABLE","$account",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","hasPermission",80],"(",["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",80],")",",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'User no longer has \"access user profiles\" permission.'",80],")",";",["T_WHITESPACE","\n    ",80],["T_VARIABLE","$current_permissions_hash",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$permissions_hash_generator",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","generate",81],"(",["T_VARIABLE","$account",81],")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertIdentical",82],"(",["T_VARIABLE","$current_permissions_hash",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$permissions_hash_generator",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","generate",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","loggedInUser",82],")",")",";",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertNotEqual",83],"(",["T_VARIABLE","$previous_permissions_hash",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$current_permissions_hash",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'Permissions hash has changed.'",83],")",";",["T_WHITESPACE","\n\n    ",83],["T_COMMENT","\/\/ Ensure that the admin role doesn't have any checkboxes.\n",85],["T_WHITESPACE","    ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","drupalGet",86],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/people\/permissions'",86],")",";",["T_WHITESPACE","\n    ",86],["T_FOREACH","foreach",87],["T_WHITESPACE"," ",87],"(",["T_STRING","array_keys",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","container",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","get",87],"(",["T_CONSTANT_ENCAPSED_STRING","'user.permissions'",87],")",["T_OBJECT_OPERATOR","->",87],["T_STRING","getPermissions",87],"(",")",")",["T_WHITESPACE"," ",87],["T_AS","as",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$permission",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n      ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertNoFieldByName",88],"(",["T_CONSTANT_ENCAPSED_STRING","'administrator['",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_VARIABLE","$permission",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","']'",88],")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Test assigning of permissions for the administrator role.\n   *\/",92],["T_WHITESPACE","\n  ",94],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","testAdministratorRole",95],"(",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n    ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","drupalLogin",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","adminUser",96],")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","drupalGet",97],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/people\/accounts'",97],")",";",["T_WHITESPACE","\n\n    ",97],["T_COMMENT","\/\/ Verify that the administration role is none by default.\n",99],["T_WHITESPACE","    ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","assertOptionSelected",100],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-user-admin-role'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","''",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'Administration role defaults to none.'",100],")",";",["T_WHITESPACE","\n\n    ",100],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertFalse",102],"(",["T_STRING","Role",102],["T_DOUBLE_COLON","::",102],["T_STRING","load",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","rid",102],")",["T_OBJECT_OPERATOR","->",102],["T_STRING","isAdmin",102],"(",")",")",";",["T_WHITESPACE","\n\n    ",102],["T_COMMENT","\/\/ Set the user's role to be the administrator role.\n",104],["T_WHITESPACE","    ",105],["T_VARIABLE","$edit",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",")",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$edit",106],"[",["T_CONSTANT_ENCAPSED_STRING","'user_admin_role'",106],"]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","rid",106],";",["T_WHITESPACE","\n    ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","drupalPostForm",107],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/people\/accounts'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$edit",107],",",["T_WHITESPACE"," ",107],["T_STRING","t",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Save configuration'",107],")",")",";",["T_WHITESPACE","\n\n    ",107],["T_NS_SEPARATOR","\\",109],["T_STRING","Drupal",109],["T_DOUBLE_COLON","::",109],["T_STRING","entityManager",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","getStorage",109],"(",["T_CONSTANT_ENCAPSED_STRING","'user_role'",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","resetCache",109],"(",")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertTrue",110],"(",["T_STRING","Role",110],["T_DOUBLE_COLON","::",110],["T_STRING","load",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","rid",110],")",["T_OBJECT_OPERATOR","->",110],["T_STRING","isAdmin",110],"(",")",")",";",["T_WHITESPACE","\n\n    ",110],["T_COMMENT","\/\/ Enable aggregator module and ensure the 'administer news feeds'\n",112],["T_WHITESPACE","    ",113],["T_COMMENT","\/\/ permission is assigned by default.\n",113],["T_WHITESPACE","    ",114],["T_NS_SEPARATOR","\\",114],["T_STRING","Drupal",114],["T_DOUBLE_COLON","::",114],["T_STRING","service",114],"(",["T_CONSTANT_ENCAPSED_STRING","'module_installer'",114],")",["T_OBJECT_OPERATOR","->",114],["T_STRING","install",114],"(",["T_ARRAY","array",114],"(",["T_CONSTANT_ENCAPSED_STRING","'aggregator'",114],")",")",";",["T_WHITESPACE","\n\n    ",114],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","assertTrue",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","adminUser",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","hasPermission",116],"(",["T_CONSTANT_ENCAPSED_STRING","'administer news feeds'",116],")",",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'The permission was automatically assigned to the administrator role'",116],")",";",["T_WHITESPACE","\n\n    ",116],["T_COMMENT","\/\/ Ensure that selecting '- None -' removes the admin role.\n",118],["T_WHITESPACE","    ",119],["T_VARIABLE","$edit",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_ARRAY","array",119],"(",")",";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$edit",120],"[",["T_CONSTANT_ENCAPSED_STRING","'user_admin_role'",120],"]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","''",120],";",["T_WHITESPACE","\n    ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","drupalPostForm",121],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/people\/accounts'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$edit",121],",",["T_WHITESPACE"," ",121],["T_STRING","t",121],"(",["T_CONSTANT_ENCAPSED_STRING","'Save configuration'",121],")",")",";",["T_WHITESPACE","\n\n    ",121],["T_NS_SEPARATOR","\\",123],["T_STRING","Drupal",123],["T_DOUBLE_COLON","::",123],["T_STRING","entityManager",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getStorage",123],"(",["T_CONSTANT_ENCAPSED_STRING","'user_role'",123],")",["T_OBJECT_OPERATOR","->",123],["T_STRING","resetCache",123],"(",")",";",["T_WHITESPACE","\n    ",123],["T_NS_SEPARATOR","\\",124],["T_STRING","Drupal",124],["T_DOUBLE_COLON","::",124],["T_STRING","configFactory",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","reset",124],"(",")",";",["T_WHITESPACE","\n    ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","assertFalse",125],"(",["T_STRING","Role",125],["T_DOUBLE_COLON","::",125],["T_STRING","load",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","rid",125],")",["T_OBJECT_OPERATOR","->",125],["T_STRING","isAdmin",125],"(",")",")",";",["T_WHITESPACE","\n\n    ",125],["T_COMMENT","\/\/ Manually create two admin roles, in that case the single select should be\n",127],["T_WHITESPACE","    ",128],["T_COMMENT","\/\/ hidden.\n",128],["T_WHITESPACE","    ",129],["T_STRING","Role",129],["T_DOUBLE_COLON","::",129],["T_STRING","create",129],"(","[",["T_CONSTANT_ENCAPSED_STRING","'id'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'admin_role_0'",129],",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'is_admin'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_STRING","TRUE",129],",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'label'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'Admin role 0'",129],"]",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","save",129],"(",")",";",["T_WHITESPACE","\n    ",129],["T_STRING","Role",130],["T_DOUBLE_COLON","::",130],["T_STRING","create",130],"(","[",["T_CONSTANT_ENCAPSED_STRING","'id'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'admin_role_1'",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'is_admin'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_STRING","TRUE",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'label'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'Admin role 1'",130],"]",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","save",130],"(",")",";",["T_WHITESPACE","\n    ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","drupalGet",131],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config\/people\/accounts'",131],")",";",["T_WHITESPACE","\n    ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","assertNoFieldByName",132],"(",["T_CONSTANT_ENCAPSED_STRING","'user_admin_role'",132],")",";",["T_WHITESPACE","\n  ",132],"}",["T_WHITESPACE","\n\n  ",133],["T_DOC_COMMENT","\/**\n   * Verify proper permission changes by user_role_change_permissions().\n   *\/",135],["T_WHITESPACE","\n  ",137],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","testUserRoleChangePermissions",138],"(",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$permissions_hash_generator",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","container",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","get",139],"(",["T_CONSTANT_ENCAPSED_STRING","'user_permissions_hash_generator'",139],")",";",["T_WHITESPACE","\n\n    ",139],["T_VARIABLE","$rid",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","rid",141],";",["T_WHITESPACE","\n    ",141],["T_VARIABLE","$account",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","adminUser",142],";",["T_WHITESPACE","\n    ",142],["T_VARIABLE","$previous_permissions_hash",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$permissions_hash_generator",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","generate",143],"(",["T_VARIABLE","$account",143],")",";",["T_WHITESPACE","\n\n    ",143],["T_COMMENT","\/\/ Verify current permissions.\n",145],["T_WHITESPACE","    ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","assertFalse",146],"(",["T_VARIABLE","$account",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","hasPermission",146],"(",["T_CONSTANT_ENCAPSED_STRING","'administer users'",146],")",",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'User does not have \"administer users\" permission.'",146],")",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","assertTrue",147],"(",["T_VARIABLE","$account",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","hasPermission",147],"(",["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",147],")",",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'User has \"access user profiles\" permission.'",147],")",";",["T_WHITESPACE","\n    ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","assertTrue",148],"(",["T_VARIABLE","$account",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","hasPermission",148],"(",["T_CONSTANT_ENCAPSED_STRING","'administer site configuration'",148],")",",",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'User has \"administer site configuration\" permission.'",148],")",";",["T_WHITESPACE","\n\n    ",148],["T_COMMENT","\/\/ Change permissions.\n",150],["T_WHITESPACE","    ",151],["T_VARIABLE","$permissions",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_ARRAY","array",151],"(",["T_WHITESPACE","\n      ",151],["T_CONSTANT_ENCAPSED_STRING","'administer users'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_LNUMBER","1",152],",",["T_WHITESPACE","\n      ",152],["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_LNUMBER","0",153],",",["T_WHITESPACE","\n    ",153],")",";",["T_WHITESPACE","\n    ",154],["T_STRING","user_role_change_permissions",155],"(",["T_VARIABLE","$rid",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$permissions",155],")",";",["T_WHITESPACE","\n\n    ",155],["T_COMMENT","\/\/ Verify proper permission changes.\n",157],["T_WHITESPACE","    ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","assertTrue",158],"(",["T_VARIABLE","$account",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","hasPermission",158],"(",["T_CONSTANT_ENCAPSED_STRING","'administer users'",158],")",",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'User now has \"administer users\" permission.'",158],")",";",["T_WHITESPACE","\n    ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertFalse",159],"(",["T_VARIABLE","$account",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","hasPermission",159],"(",["T_CONSTANT_ENCAPSED_STRING","'access user profiles'",159],")",",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'User no longer has \"access user profiles\" permission.'",159],")",";",["T_WHITESPACE","\n    ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","assertTrue",160],"(",["T_VARIABLE","$account",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","hasPermission",160],"(",["T_CONSTANT_ENCAPSED_STRING","'administer site configuration'",160],")",",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'User still has \"administer site configuration\" permission.'",160],")",";",["T_WHITESPACE","\n\n    ",160],["T_COMMENT","\/\/ Verify the permissions hash has changed.\n",162],["T_WHITESPACE","    ",163],["T_VARIABLE","$current_permissions_hash",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$permissions_hash_generator",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","generate",163],"(",["T_VARIABLE","$account",163],")",";",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","assertNotEqual",164],"(",["T_VARIABLE","$previous_permissions_hash",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$current_permissions_hash",164],",",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'Permissions hash has changed.'",164],")",";",["T_WHITESPACE","\n  ",164],"}",["T_WHITESPACE","\n\n",165],"}",["T_WHITESPACE","\n",167]]