[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","simpletest",5],["T_NS_SEPARATOR","\\",5],["T_STRING","WebTestBase",5],";",["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tests that users can be assigned and unassigned roles.\n *\n * @group user\n *\/",7],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","UserRolesAssignmentTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","WebTestBase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_PROTECTED","protected",14],["T_WHITESPACE"," ",14],["T_FUNCTION","function",14],["T_WHITESPACE"," ",14],["T_STRING","setUp",14],"(",")",["T_WHITESPACE"," ",14],"{",["T_WHITESPACE","\n    ",14],["T_STRING","parent",15],["T_DOUBLE_COLON","::",15],["T_STRING","setUp",15],"(",")",";",["T_WHITESPACE","\n    ",15],["T_VARIABLE","$admin_user",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","drupalCreateUser",16],"(",["T_ARRAY","array",16],"(",["T_CONSTANT_ENCAPSED_STRING","'administer permissions'",16],",",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'administer users'",16],")",")",";",["T_WHITESPACE","\n    ",16],["T_VARIABLE","$this",17],["T_OBJECT_OPERATOR","->",17],["T_STRING","drupalLogin",17],"(",["T_VARIABLE","$admin_user",17],")",";",["T_WHITESPACE","\n  ",17],"}",["T_WHITESPACE","\n\n  ",18],["T_DOC_COMMENT","\/**\n   * Tests that a user can be assigned a role and that the role can be removed\n   * again.\n   *\/",20],["T_WHITESPACE","\n  ",23],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","testAssignAndRemoveRole",24],"(",")",["T_WHITESPACE","  ",24],"{",["T_WHITESPACE","\n    ",24],["T_VARIABLE","$rid",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","drupalCreateRole",25],"(",["T_ARRAY","array",25],"(",["T_CONSTANT_ENCAPSED_STRING","'administer users'",25],")",")",";",["T_WHITESPACE","\n    ",25],["T_VARIABLE","$account",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","drupalCreateUser",26],"(",")",";",["T_WHITESPACE","\n\n    ",26],["T_COMMENT","\/\/ Assign the role to the user.\n",28],["T_WHITESPACE","    ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","drupalPostForm",29],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/'",29],["T_WHITESPACE"," ",29],".",["T_WHITESPACE"," ",29],["T_VARIABLE","$account",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","id",29],"(",")",["T_WHITESPACE"," ",29],".",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",29],",",["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(","\"",["T_ENCAPSED_AND_WHITESPACE","roles[",29],["T_VARIABLE","$rid",29],["T_ENCAPSED_AND_WHITESPACE","]",29],"\"",["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$rid",29],")",",",["T_WHITESPACE"," ",29],["T_STRING","t",29],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",29],")",")",";",["T_WHITESPACE","\n    ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","assertText",30],"(",["T_STRING","t",30],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",30],")",")",";",["T_WHITESPACE","\n    ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","assertFieldChecked",31],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-roles-'",31],["T_WHITESPACE"," ",31],".",["T_WHITESPACE"," ",31],["T_VARIABLE","$rid",31],",",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'Role is assigned.'",31],")",";",["T_WHITESPACE","\n    ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","userLoadAndCheckRoleAssigned",32],"(",["T_VARIABLE","$account",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$rid",32],")",";",["T_WHITESPACE","\n\n    ",32],["T_COMMENT","\/\/ Remove the role from the user.\n",34],["T_WHITESPACE","    ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","drupalPostForm",35],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/'",35],["T_WHITESPACE"," ",35],".",["T_WHITESPACE"," ",35],["T_VARIABLE","$account",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","id",35],"(",")",["T_WHITESPACE"," ",35],".",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",35],",",["T_WHITESPACE"," ",35],["T_ARRAY","array",35],"(","\"",["T_ENCAPSED_AND_WHITESPACE","roles[",35],["T_VARIABLE","$rid",35],["T_ENCAPSED_AND_WHITESPACE","]",35],"\"",["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_STRING","FALSE",35],")",",",["T_WHITESPACE"," ",35],["T_STRING","t",35],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",35],")",")",";",["T_WHITESPACE","\n    ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","assertText",36],"(",["T_STRING","t",36],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",36],")",")",";",["T_WHITESPACE","\n    ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","assertNoFieldChecked",37],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-roles-'",37],["T_WHITESPACE"," ",37],".",["T_WHITESPACE"," ",37],["T_VARIABLE","$rid",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'Role is removed from user.'",37],")",";",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","userLoadAndCheckRoleAssigned",38],"(",["T_VARIABLE","$account",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$rid",38],",",["T_WHITESPACE"," ",38],["T_STRING","FALSE",38],")",";",["T_WHITESPACE","\n  ",38],"}",["T_WHITESPACE","\n\n  ",39],["T_DOC_COMMENT","\/**\n   * Tests that when creating a user the role can be assigned. And that it can\n   * be removed again.\n   *\/",41],["T_WHITESPACE","\n  ",44],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testCreateUserWithRole",45],"(",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_VARIABLE","$rid",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","drupalCreateRole",46],"(",["T_ARRAY","array",46],"(",["T_CONSTANT_ENCAPSED_STRING","'administer users'",46],")",")",";",["T_WHITESPACE","\n    ",46],["T_COMMENT","\/\/ Create a new user and add the role at the same time.\n",47],["T_WHITESPACE","    ",48],["T_VARIABLE","$edit",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_WHITESPACE","\n      ",48],["T_CONSTANT_ENCAPSED_STRING","'name'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","randomMachineName",49],"(",")",",",["T_WHITESPACE","\n      ",49],["T_CONSTANT_ENCAPSED_STRING","'mail'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","randomMachineName",50],"(",")",["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'@example.com'",50],",",["T_WHITESPACE","\n      ",50],["T_CONSTANT_ENCAPSED_STRING","'pass[pass1]'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$pass",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","randomString",51],"(",")",",",["T_WHITESPACE","\n      ",51],["T_CONSTANT_ENCAPSED_STRING","'pass[pass2]'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$pass",52],",",["T_WHITESPACE","\n      ",52],"\"",["T_ENCAPSED_AND_WHITESPACE","roles[",53],["T_VARIABLE","$rid",53],["T_ENCAPSED_AND_WHITESPACE","]",53],"\"",["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$rid",53],",",["T_WHITESPACE","\n    ",53],")",";",["T_WHITESPACE","\n    ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","drupalPostForm",55],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/people\/create'",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$edit",55],",",["T_WHITESPACE"," ",55],["T_STRING","t",55],"(",["T_CONSTANT_ENCAPSED_STRING","'Create new account'",55],")",")",";",["T_WHITESPACE","\n    ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertText",56],"(",["T_STRING","t",56],"(",["T_CONSTANT_ENCAPSED_STRING","'Created a new user account for @name.'",56],",",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$edit",56],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",56],"]",")",")",")",";",["T_WHITESPACE","\n    ",56],["T_COMMENT","\/\/ Get the newly added user.\n",57],["T_WHITESPACE","    ",58],["T_VARIABLE","$account",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","user_load_by_name",58],"(",["T_VARIABLE","$edit",58],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",58],"]",")",";",["T_WHITESPACE","\n\n    ",58],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","drupalGet",60],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/'",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_VARIABLE","$account",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","id",60],"(",")",["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",60],")",";",["T_WHITESPACE","\n    ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertFieldChecked",61],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-roles-'",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_VARIABLE","$rid",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'Role is assigned.'",61],")",";",["T_WHITESPACE","\n    ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","userLoadAndCheckRoleAssigned",62],"(",["T_VARIABLE","$account",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$rid",62],")",";",["T_WHITESPACE","\n\n    ",62],["T_COMMENT","\/\/ Remove the role again.\n",64],["T_WHITESPACE","    ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","drupalPostForm",65],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/'",65],["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_VARIABLE","$account",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","id",65],"(",")",["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",65],",",["T_WHITESPACE"," ",65],["T_ARRAY","array",65],"(","\"",["T_ENCAPSED_AND_WHITESPACE","roles[",65],["T_VARIABLE","$rid",65],["T_ENCAPSED_AND_WHITESPACE","]",65],"\"",["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_STRING","FALSE",65],")",",",["T_WHITESPACE"," ",65],["T_STRING","t",65],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",65],")",")",";",["T_WHITESPACE","\n    ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertText",66],"(",["T_STRING","t",66],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",66],")",")",";",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertNoFieldChecked",67],"(",["T_CONSTANT_ENCAPSED_STRING","'edit-roles-'",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_VARIABLE","$rid",67],",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'Role is removed from user.'",67],")",";",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","userLoadAndCheckRoleAssigned",68],"(",["T_VARIABLE","$account",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$rid",68],",",["T_WHITESPACE"," ",68],["T_STRING","FALSE",68],")",";",["T_WHITESPACE","\n  ",68],"}",["T_WHITESPACE","\n\n  ",69],["T_DOC_COMMENT","\/**\n   * Check role on user object.\n   *\n   * @param object $account\n   *   The user account to check.\n   * @param string $rid\n   *   The role ID to search for.\n   * @param bool $is_assigned\n   *   (optional) Whether to assert that $rid exists (TRUE) or not (FALSE).\n   *   Defaults to TRUE.\n   *\/",71],["T_WHITESPACE","\n  ",81],["T_PRIVATE","private",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","userLoadAndCheckRoleAssigned",82],"(",["T_VARIABLE","$account",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$rid",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$is_assigned",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","TRUE",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n    ",82],["T_VARIABLE","$user_storage",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","container",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","get",83],"(",["T_CONSTANT_ENCAPSED_STRING","'entity.manager'",83],")",["T_OBJECT_OPERATOR","->",83],["T_STRING","getStorage",83],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",83],")",";",["T_WHITESPACE","\n    ",83],["T_VARIABLE","$user_storage",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","resetCache",84],"(",["T_ARRAY","array",84],"(",["T_VARIABLE","$account",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","id",84],"(",")",")",")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$account",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$user_storage",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","load",85],"(",["T_VARIABLE","$account",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","id",85],"(",")",")",";",["T_WHITESPACE","\n    ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$is_assigned",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n      ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertFalse",87],"(",["T_STRING","array_search",87],"(",["T_VARIABLE","$rid",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$account",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getRoles",87],"(",")",")",["T_WHITESPACE"," ",87],["T_IS_IDENTICAL","===",87],["T_WHITESPACE"," ",87],["T_STRING","FALSE",87],",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'The role is present in the user object.'",87],")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n    ",88],["T_ELSE","else",89],["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n      ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertTrue",90],"(",["T_STRING","array_search",90],"(",["T_VARIABLE","$rid",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$account",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getRoles",90],"(",")",")",["T_WHITESPACE"," ",90],["T_IS_IDENTICAL","===",90],["T_WHITESPACE"," ",90],["T_STRING","FALSE",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'The role is not present in the user object.'",90],")",";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n  ",91],"}",["T_WHITESPACE","\n\n",92],"}",["T_WHITESPACE","\n",94]]