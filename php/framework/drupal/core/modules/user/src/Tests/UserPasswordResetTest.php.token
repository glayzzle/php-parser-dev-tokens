[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Render",5],["T_NS_SEPARATOR","\\",5],["T_STRING","FormattableMarkup",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Url",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","system",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Tests",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Cache",7],["T_NS_SEPARATOR","\\",7],["T_STRING","PageCacheTagsTestBase",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","user",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Entity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","User",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Ensure that password reset methods work as expected.\n *\n * @group user\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","UserPasswordResetTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","PageCacheTagsTestBase",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n  ",15],["T_DOC_COMMENT","\/**\n   * The profile to install as a basis for testing.\n   *\n   * This test uses the standard profile to test the password reset in\n   * combination with an ajax request provided by the user picture configuration\n   * in the standard profile.\n   *\n   * @var string\n   *\/",17],["T_WHITESPACE","\n  ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$profile",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'standard'",26],";",["T_WHITESPACE","\n\n  ",26],["T_DOC_COMMENT","\/**\n   * The user object to test password resetting.\n   *\n   * @var \\Drupal\\user\\UserInterface\n   *\/",28],["T_WHITESPACE","\n  ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$account",33],";",["T_WHITESPACE","\n\n  ",33],["T_DOC_COMMENT","\/**\n   * Modules to enable.\n   *\n   * @var array\n   *\/",35],["T_WHITESPACE","\n  ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_STATIC","static",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$modules",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],"[",["T_CONSTANT_ENCAPSED_STRING","'block'",40],"]",";",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",42],["T_WHITESPACE","\n  ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","setUp",45],"(",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n    ",45],["T_STRING","parent",46],["T_DOUBLE_COLON","::",46],["T_STRING","setUp",46],"(",")",";",["T_WHITESPACE","\n\n    ",46],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","drupalPlaceBlock",48],"(",["T_CONSTANT_ENCAPSED_STRING","'system_menu_block:account'",48],")",";",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/\/ Create a user.\n",50],["T_WHITESPACE","    ",51],["T_VARIABLE","$account",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","drupalCreateUser",51],"(",")",";",["T_WHITESPACE","\n\n    ",51],["T_COMMENT","\/\/ Activate user by logging in.\n",53],["T_WHITESPACE","    ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","drupalLogin",54],"(",["T_VARIABLE","$account",54],")",";",["T_WHITESPACE","\n\n    ",54],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","account",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","User",56],["T_DOUBLE_COLON","::",56],["T_STRING","load",56],"(",["T_VARIABLE","$account",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","id",56],"(",")",")",";",["T_WHITESPACE","\n    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","account",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","pass_raw",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$account",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","pass_raw",57],";",["T_WHITESPACE","\n    ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","drupalLogout",58],"(",")",";",["T_WHITESPACE","\n\n    ",58],["T_COMMENT","\/\/ Set the last login time that is used to generate the one-time link so\n",60],["T_WHITESPACE","    ",61],["T_COMMENT","\/\/ that it is definitely over a second ago.\n",61],["T_WHITESPACE","    ",62],["T_VARIABLE","$account",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","login",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","REQUEST_TIME",62],["T_WHITESPACE"," ",62],"-",["T_WHITESPACE"," ",62],["T_STRING","mt_rand",62],"(",["T_LNUMBER","10",62],",",["T_WHITESPACE"," ",62],["T_LNUMBER","100000",62],")",";",["T_WHITESPACE","\n    ",62],["T_STRING","db_update",63],"(",["T_CONSTANT_ENCAPSED_STRING","'users_field_data'",63],")",["T_WHITESPACE","\n      ",63],["T_OBJECT_OPERATOR","->",64],["T_STRING","fields",64],"(",["T_ARRAY","array",64],"(",["T_CONSTANT_ENCAPSED_STRING","'login'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$account",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getLastLoginTime",64],"(",")",")",")",["T_WHITESPACE","\n      ",64],["T_OBJECT_OPERATOR","->",65],["T_STRING","condition",65],"(",["T_CONSTANT_ENCAPSED_STRING","'uid'",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$account",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","id",65],"(",")",")",["T_WHITESPACE","\n      ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","execute",66],"(",")",";",["T_WHITESPACE","\n  ",66],"}",["T_WHITESPACE","\n\n  ",67],["T_DOC_COMMENT","\/**\n   * Tests password reset functionality.\n   *\/",69],["T_WHITESPACE","\n  ",71],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","testUserPasswordReset",72],"(",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n    ",72],["T_COMMENT","\/\/ Verify that accessing the password reset form without having the session\n",73],["T_WHITESPACE","    ",74],["T_COMMENT","\/\/ variables set results in an access denied message.\n",74],["T_WHITESPACE","    ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","drupalGet",75],"(",["T_STRING","Url",75],["T_DOUBLE_COLON","::",75],["T_STRING","fromRoute",75],"(",["T_CONSTANT_ENCAPSED_STRING","'user.reset.form'",75],",",["T_WHITESPACE"," ",75],"[",["T_CONSTANT_ENCAPSED_STRING","'uid'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","account",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","id",75],"(",")","]",")",")",";",["T_WHITESPACE","\n    ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertResponse",76],"(",["T_LNUMBER","403",76],")",";",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/\/ Try to reset the password for an invalid account.\n",78],["T_WHITESPACE","    ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","drupalGet",79],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",79],")",";",["T_WHITESPACE","\n\n    ",79],["T_VARIABLE","$edit",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","randomMachineName",81],"(",["T_LNUMBER","32",81],")",")",";",["T_WHITESPACE","\n    ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","drupalPostForm",82],"(",["T_STRING","NULL",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$edit",82],",",["T_WHITESPACE"," ",82],["T_STRING","t",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",82],")",")",";",["T_WHITESPACE","\n\n    ",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertText",84],"(",["T_STRING","t",84],"(",["T_CONSTANT_ENCAPSED_STRING","'@name is not recognized as a username or an email address.'",84],",",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$edit",84],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",84],"]",")",")",",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'Validation error message shown when trying to request password for invalid account.'",84],")",";",["T_WHITESPACE","\n    ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","assertEqual",85],"(",["T_STRING","count",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","drupalGetMails",85],"(",["T_ARRAY","array",85],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'user_password_reset'",85],")",")",")",",",["T_WHITESPACE"," ",85],["T_LNUMBER","0",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'No email was sent when requesting a password for an invalid account.'",85],")",";",["T_WHITESPACE","\n\n    ",85],["T_COMMENT","\/\/ Reset the password by username via the password reset page.\n",87],["T_WHITESPACE","    ",88],["T_VARIABLE","$edit",88],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",88],"]",["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","account",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getUsername",88],"(",")",";",["T_WHITESPACE","\n    ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","drupalPostForm",89],"(",["T_STRING","NULL",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$edit",89],",",["T_WHITESPACE"," ",89],["T_STRING","t",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",89],")",")",";",["T_WHITESPACE","\n\n    ",89],["T_COMMENT","\/\/ Verify that the user was sent an email.\n",91],["T_WHITESPACE","    ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","assertMail",92],"(",["T_CONSTANT_ENCAPSED_STRING","'to'",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","account",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getEmail",92],"(",")",",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'Password email sent to user.'",92],")",";",["T_WHITESPACE","\n    ",92],["T_VARIABLE","$subject",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","t",93],"(",["T_CONSTANT_ENCAPSED_STRING","'Replacement login information for @username at @site'",93],",",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",["T_CONSTANT_ENCAPSED_STRING","'@username'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","account",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getUsername",93],"(",")",",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'@site'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","config",93],"(",["T_CONSTANT_ENCAPSED_STRING","'system.site'",93],")",["T_OBJECT_OPERATOR","->",93],["T_STRING","get",93],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",93],")",")",")",";",["T_WHITESPACE","\n    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertMail",94],"(",["T_CONSTANT_ENCAPSED_STRING","'subject'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$subject",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'Password reset email subject is correct.'",94],")",";",["T_WHITESPACE","\n\n    ",94],["T_VARIABLE","$resetURL",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getResetURL",96],"(",")",";",["T_WHITESPACE","\n    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","drupalGet",97],"(",["T_VARIABLE","$resetURL",97],")",";",["T_WHITESPACE","\n    ",97],["T_COMMENT","\/\/ Ensure that the current url does not contain the hash and timestamp.\n",98],["T_WHITESPACE","    ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","assertUrl",99],"(",["T_STRING","Url",99],["T_DOUBLE_COLON","::",99],["T_STRING","fromRoute",99],"(",["T_CONSTANT_ENCAPSED_STRING","'user.reset.form'",99],",",["T_WHITESPACE"," ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'uid'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","account",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","id",99],"(",")","]",")",")",";",["T_WHITESPACE","\n\n    ",99],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertFalse",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","drupalGetHeader",101],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",101],")",")",";",["T_WHITESPACE","\n\n    ",101],["T_COMMENT","\/\/ Ensure the password reset URL is not cached.\n",103],["T_WHITESPACE","    ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","drupalGet",104],"(",["T_VARIABLE","$resetURL",104],")",";",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","assertFalse",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","drupalGetHeader",105],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Drupal-Cache'",105],")",")",";",["T_WHITESPACE","\n\n    ",105],["T_COMMENT","\/\/ Check the one-time login page.\n",107],["T_WHITESPACE","    ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertText",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","account",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getUsername",108],"(",")",",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'One-time login page contains the correct username.'",108],")",";",["T_WHITESPACE","\n    ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assertText",109],"(",["T_STRING","t",109],"(",["T_CONSTANT_ENCAPSED_STRING","'This login can be used only once.'",109],")",",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'Found warning about one-time login.'",109],")",";",["T_WHITESPACE","\n    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertTitle",110],"(",["T_STRING","t",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Reset password | Drupal'",110],")",",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'Page title is \"Reset password\".'",110],")",";",["T_WHITESPACE","\n\n    ",110],["T_COMMENT","\/\/ Check successful login.\n",112],["T_WHITESPACE","    ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","drupalPostForm",113],"(",["T_STRING","NULL",113],",",["T_WHITESPACE"," ",113],["T_STRING","NULL",113],",",["T_WHITESPACE"," ",113],["T_STRING","t",113],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",113],")",")",";",["T_WHITESPACE","\n    ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","assertLink",114],"(",["T_STRING","t",114],"(",["T_CONSTANT_ENCAPSED_STRING","'Log out'",114],")",")",";",["T_WHITESPACE","\n    ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","assertTitle",115],"(",["T_STRING","t",115],"(",["T_CONSTANT_ENCAPSED_STRING","'@name | @site'",115],",",["T_WHITESPACE"," ",115],["T_ARRAY","array",115],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","account",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getUsername",115],"(",")",",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'@site'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","config",115],"(",["T_CONSTANT_ENCAPSED_STRING","'system.site'",115],")",["T_OBJECT_OPERATOR","->",115],["T_STRING","get",115],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",115],")",")",")",",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'Logged in using password reset link.'",115],")",";",["T_WHITESPACE","\n\n    ",115],["T_COMMENT","\/\/ Make sure the ajax request from uploading a user picture does not\n",117],["T_WHITESPACE","    ",118],["T_COMMENT","\/\/ invalidate the reset token.\n",118],["T_WHITESPACE","    ",119],["T_VARIABLE","$image",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","current",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","drupalGetTestFiles",119],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",119],")",")",";",["T_WHITESPACE","\n    ",119],["T_VARIABLE","$edit",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_ARRAY","array",120],"(",["T_WHITESPACE","\n      ",120],["T_CONSTANT_ENCAPSED_STRING","'files[user_picture_0]'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_STRING","drupal_realpath",121],"(",["T_VARIABLE","$image",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","uri",121],")",",",["T_WHITESPACE","\n    ",121],")",";",["T_WHITESPACE","\n    ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","drupalPostAjaxForm",123],"(",["T_STRING","NULL",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$edit",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'user_picture_0_upload_button'",123],")",";",["T_WHITESPACE","\n\n    ",123],["T_COMMENT","\/\/ Change the forgotten password.\n",125],["T_WHITESPACE","    ",126],["T_VARIABLE","$password",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","user_password",126],"(",")",";",["T_WHITESPACE","\n    ",126],["T_VARIABLE","$edit",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","'pass[pass1]'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$password",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'pass[pass2]'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$password",127],")",";",["T_WHITESPACE","\n    ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","drupalPostForm",128],"(",["T_STRING","NULL",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$edit",128],",",["T_WHITESPACE"," ",128],["T_STRING","t",128],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",128],")",")",";",["T_WHITESPACE","\n    ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","assertText",129],"(",["T_STRING","t",129],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",129],")",",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'Forgotten password changed.'",129],")",";",["T_WHITESPACE","\n\n    ",129],["T_COMMENT","\/\/ Verify that the password reset session has been destroyed.\n",131],["T_WHITESPACE","    ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","drupalPostForm",132],"(",["T_STRING","NULL",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$edit",132],",",["T_WHITESPACE"," ",132],["T_STRING","t",132],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",132],")",")",";",["T_WHITESPACE","\n    ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","assertText",133],"(",["T_STRING","t",133],"(",["T_CONSTANT_ENCAPSED_STRING","'Your current password is missing or incorrect; it\\'s required to change the Password.'",133],")",",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'Password needed to make profile changes.'",133],")",";",["T_WHITESPACE","\n\n    ",133],["T_COMMENT","\/\/ Log out, and try to log in again using the same one-time link.\n",135],["T_WHITESPACE","    ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","drupalLogout",136],"(",")",";",["T_WHITESPACE","\n    ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","drupalGet",137],"(",["T_VARIABLE","$resetURL",137],")",";",["T_WHITESPACE","\n    ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","drupalPostForm",138],"(",["T_STRING","NULL",138],",",["T_WHITESPACE"," ",138],["T_STRING","NULL",138],",",["T_WHITESPACE"," ",138],["T_STRING","t",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",138],")",")",";",["T_WHITESPACE","\n    ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertText",139],"(",["T_STRING","t",139],"(",["T_CONSTANT_ENCAPSED_STRING","'You have tried to use a one-time login link that has either been used or is no longer valid. Please request a new one using the form below.'",139],")",",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'One-time link is no longer valid.'",139],")",";",["T_WHITESPACE","\n\n    ",139],["T_COMMENT","\/\/ Request a new password again, this time using the email address.\n",141],["T_WHITESPACE","    ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","drupalGet",142],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",142],")",";",["T_WHITESPACE","\n    ",142],["T_COMMENT","\/\/ Count email messages before to compare with after.\n",143],["T_WHITESPACE","    ",144],["T_VARIABLE","$before",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","count",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","drupalGetMails",144],"(",["T_ARRAY","array",144],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'user_password_reset'",144],")",")",")",";",["T_WHITESPACE","\n    ",144],["T_VARIABLE","$edit",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","account",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getEmail",145],"(",")",")",";",["T_WHITESPACE","\n    ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","drupalPostForm",146],"(",["T_STRING","NULL",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$edit",146],",",["T_WHITESPACE"," ",146],["T_STRING","t",146],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",146],")",")",";",["T_WHITESPACE","\n    ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","assertTrue",147],"(",["T_WHITESPACE"," ",147],["T_STRING","count",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","drupalGetMails",147],"(",["T_ARRAY","array",147],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'user_password_reset'",147],")",")",")",["T_WHITESPACE"," ",147],["T_IS_IDENTICAL","===",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$before",147],["T_WHITESPACE"," ",147],"+",["T_WHITESPACE"," ",147],["T_LNUMBER","1",147],",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'Email sent when requesting password reset using email address.'",147],")",";",["T_WHITESPACE","\n\n    ",147],["T_COMMENT","\/\/ Visit the user edit page without pass-reset-token and make sure it does\n",149],["T_WHITESPACE","    ",150],["T_COMMENT","\/\/ not cause an error.\n",150],["T_WHITESPACE","    ",151],["T_VARIABLE","$resetURL",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getResetURL",151],"(",")",";",["T_WHITESPACE","\n    ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","drupalGet",152],"(",["T_VARIABLE","$resetURL",152],")",";",["T_WHITESPACE","\n    ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","drupalPostForm",153],"(",["T_STRING","NULL",153],",",["T_WHITESPACE"," ",153],["T_STRING","NULL",153],",",["T_WHITESPACE"," ",153],["T_STRING","t",153],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",153],")",")",";",["T_WHITESPACE","\n    ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","drupalGet",154],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/'",154],["T_WHITESPACE"," ",154],".",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","account",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","id",154],"(",")",["T_WHITESPACE"," ",154],".",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'\/edit'",154],")",";",["T_WHITESPACE","\n    ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","assertNoText",155],"(",["T_CONSTANT_ENCAPSED_STRING","'Expected user_string to be a string, NULL given'",155],")",";",["T_WHITESPACE","\n    ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","drupalLogout",156],"(",")",";",["T_WHITESPACE","\n\n    ",156],["T_COMMENT","\/\/ Create a password reset link as if the request time was 60 seconds older than the allowed limit.\n",158],["T_WHITESPACE","    ",159],["T_VARIABLE","$timeout",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","config",159],"(",["T_CONSTANT_ENCAPSED_STRING","'user.settings'",159],")",["T_OBJECT_OPERATOR","->",159],["T_STRING","get",159],"(",["T_CONSTANT_ENCAPSED_STRING","'password_reset_timeout'",159],")",";",["T_WHITESPACE","\n    ",159],["T_VARIABLE","$bogus_timestamp",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","REQUEST_TIME",160],["T_WHITESPACE"," ",160],"-",["T_WHITESPACE"," ",160],["T_VARIABLE","$timeout",160],["T_WHITESPACE"," ",160],"-",["T_WHITESPACE"," ",160],["T_LNUMBER","60",160],";",["T_WHITESPACE","\n    ",160],["T_VARIABLE","$_uid",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","account",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","id",161],"(",")",";",["T_WHITESPACE","\n    ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","drupalGet",162],"(","\"",["T_ENCAPSED_AND_WHITESPACE","user\/reset\/",162],["T_VARIABLE","$_uid",162],["T_ENCAPSED_AND_WHITESPACE","\/",162],["T_VARIABLE","$bogus_timestamp",162],["T_ENCAPSED_AND_WHITESPACE","\/",162],"\"",["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_STRING","user_pass_rehash",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","account",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$bogus_timestamp",162],")",")",";",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","drupalPostForm",163],"(",["T_STRING","NULL",163],",",["T_WHITESPACE"," ",163],["T_STRING","NULL",163],",",["T_WHITESPACE"," ",163],["T_STRING","t",163],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",163],")",")",";",["T_WHITESPACE","\n    ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","assertText",164],"(",["T_STRING","t",164],"(",["T_CONSTANT_ENCAPSED_STRING","'You have tried to use a one-time login link that has expired. Please request a new one using the form below.'",164],")",",",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'Expired password reset request rejected.'",164],")",";",["T_WHITESPACE","\n\n    ",164],["T_COMMENT","\/\/ Create a user, block the account, and verify that a login link is denied.\n",166],["T_WHITESPACE","    ",167],["T_VARIABLE","$timestamp",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","REQUEST_TIME",167],["T_WHITESPACE"," ",167],"-",["T_WHITESPACE"," ",167],["T_LNUMBER","1",167],";",["T_WHITESPACE","\n    ",167],["T_VARIABLE","$blocked_account",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","drupalCreateUser",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","block",168],"(",")",";",["T_WHITESPACE","\n    ",168],["T_VARIABLE","$blocked_account",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","save",169],"(",")",";",["T_WHITESPACE","\n    ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","drupalGet",170],"(",["T_CONSTANT_ENCAPSED_STRING","\"user\/reset\/\"",170],["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],["T_VARIABLE","$blocked_account",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","id",170],"(",")",["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],"\"",["T_ENCAPSED_AND_WHITESPACE","\/",170],["T_VARIABLE","$timestamp",170],["T_ENCAPSED_AND_WHITESPACE","\/",170],"\"",["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],["T_STRING","user_pass_rehash",170],"(",["T_VARIABLE","$blocked_account",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$timestamp",170],")",")",";",["T_WHITESPACE","\n    ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","assertResponse",171],"(",["T_LNUMBER","403",171],")",";",["T_WHITESPACE","\n\n    ",171],["T_COMMENT","\/\/ Verify a blocked user can not request a new password.\n",173],["T_WHITESPACE","    ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","drupalGet",174],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",174],")",";",["T_WHITESPACE","\n    ",174],["T_COMMENT","\/\/ Count email messages before to compare with after.\n",175],["T_WHITESPACE","    ",176],["T_VARIABLE","$before",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","count",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","drupalGetMails",176],"(",["T_ARRAY","array",176],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'user_password_reset'",176],")",")",")",";",["T_WHITESPACE","\n    ",176],["T_VARIABLE","$edit",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_ARRAY","array",177],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$blocked_account",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getUsername",177],"(",")",")",";",["T_WHITESPACE","\n    ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","drupalPostForm",178],"(",["T_STRING","NULL",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$edit",178],",",["T_WHITESPACE"," ",178],["T_STRING","t",178],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",178],")",")",";",["T_WHITESPACE","\n    ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","assertRaw",179],"(",["T_STRING","t",179],"(",["T_CONSTANT_ENCAPSED_STRING","'%name is blocked or has not been activated yet.'",179],",",["T_WHITESPACE"," ",179],["T_ARRAY","array",179],"(",["T_CONSTANT_ENCAPSED_STRING","'%name'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$blocked_account",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getUsername",179],"(",")",")",")",",",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'Notified user blocked accounts can not request a new password'",179],")",";",["T_WHITESPACE","\n    ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","assertTrue",180],"(",["T_STRING","count",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","drupalGetMails",180],"(",["T_ARRAY","array",180],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'user_password_reset'",180],")",")",")",["T_WHITESPACE"," ",180],["T_IS_IDENTICAL","===",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$before",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'No email was sent when requesting password reset for a blocked account'",180],")",";",["T_WHITESPACE","\n\n    ",180],["T_COMMENT","\/\/ Verify a password reset link is invalidated when the user's email address changes.\n",182],["T_WHITESPACE","    ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","drupalGet",183],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",183],")",";",["T_WHITESPACE","\n    ",183],["T_VARIABLE","$edit",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_ARRAY","array",184],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","account",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getUsername",184],"(",")",")",";",["T_WHITESPACE","\n    ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","drupalPostForm",185],"(",["T_STRING","NULL",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$edit",185],",",["T_WHITESPACE"," ",185],["T_STRING","t",185],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",185],")",")",";",["T_WHITESPACE","\n    ",185],["T_VARIABLE","$old_email_reset_link",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getResetURL",186],"(",")",";",["T_WHITESPACE","\n    ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","account",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setEmail",187],"(",["T_CONSTANT_ENCAPSED_STRING","\"1\"",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","account",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getEmail",187],"(",")",")",";",["T_WHITESPACE","\n    ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","account",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","save",188],"(",")",";",["T_WHITESPACE","\n    ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","drupalGet",189],"(",["T_VARIABLE","$old_email_reset_link",189],")",";",["T_WHITESPACE","\n    ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","drupalPostForm",190],"(",["T_STRING","NULL",190],",",["T_WHITESPACE"," ",190],["T_STRING","NULL",190],",",["T_WHITESPACE"," ",190],["T_STRING","t",190],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",190],")",")",";",["T_WHITESPACE","\n    ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","assertText",191],"(",["T_STRING","t",191],"(",["T_CONSTANT_ENCAPSED_STRING","'You have tried to use a one-time login link that has either been used or is no longer valid. Please request a new one using the form below.'",191],")",",",["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'One-time link is no longer valid.'",191],")",";",["T_WHITESPACE","\n\n    ",191],["T_COMMENT","\/\/ Verify a password reset link will automatically log a user when \/login is\n",193],["T_WHITESPACE","    ",194],["T_COMMENT","\/\/ appended.\n",194],["T_WHITESPACE","    ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","drupalGet",195],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",195],")",";",["T_WHITESPACE","\n    ",195],["T_VARIABLE","$edit",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","account",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getUsername",196],"(",")",")",";",["T_WHITESPACE","\n    ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","drupalPostForm",197],"(",["T_STRING","NULL",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$edit",197],",",["T_WHITESPACE"," ",197],["T_STRING","t",197],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",197],")",")",";",["T_WHITESPACE","\n    ",197],["T_VARIABLE","$reset_url",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getResetURL",198],"(",")",";",["T_WHITESPACE","\n    ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","drupalGet",199],"(",["T_VARIABLE","$reset_url",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'\/login'",199],")",";",["T_WHITESPACE","\n    ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","assertLink",200],"(",["T_STRING","t",200],"(",["T_CONSTANT_ENCAPSED_STRING","'Log out'",200],")",")",";",["T_WHITESPACE","\n    ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","assertTitle",201],"(",["T_STRING","t",201],"(",["T_CONSTANT_ENCAPSED_STRING","'@name | @site'",201],",",["T_WHITESPACE"," ",201],["T_ARRAY","array",201],"(",["T_CONSTANT_ENCAPSED_STRING","'@name'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","account",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getUsername",201],"(",")",",",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'@site'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","config",201],"(",["T_CONSTANT_ENCAPSED_STRING","'system.site'",201],")",["T_OBJECT_OPERATOR","->",201],["T_STRING","get",201],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",201],")",")",")",",",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'Logged in using password reset link.'",201],")",";",["T_WHITESPACE","\n\n    ",201],["T_COMMENT","\/\/ Ensure blocked and deleted accounts can't access the user.reset.login\n",203],["T_WHITESPACE","    ",204],["T_COMMENT","\/\/ route.\n",204],["T_WHITESPACE","    ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","drupalLogout",205],"(",")",";",["T_WHITESPACE","\n    ",205],["T_VARIABLE","$timestamp",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_STRING","REQUEST_TIME",206],["T_WHITESPACE"," ",206],"-",["T_WHITESPACE"," ",206],["T_LNUMBER","1",206],";",["T_WHITESPACE","\n    ",206],["T_VARIABLE","$blocked_account",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","drupalCreateUser",207],"(",")",["T_OBJECT_OPERATOR","->",207],["T_STRING","block",207],"(",")",";",["T_WHITESPACE","\n    ",207],["T_VARIABLE","$blocked_account",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","save",208],"(",")",";",["T_WHITESPACE","\n    ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","drupalGet",209],"(",["T_CONSTANT_ENCAPSED_STRING","\"user\/reset\/\"",209],["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_VARIABLE","$blocked_account",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","id",209],"(",")",["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],"\"",["T_ENCAPSED_AND_WHITESPACE","\/",209],["T_VARIABLE","$timestamp",209],["T_ENCAPSED_AND_WHITESPACE","\/",209],"\"",["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_STRING","user_pass_rehash",209],"(",["T_VARIABLE","$blocked_account",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$timestamp",209],")",["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'\/login'",209],")",";",["T_WHITESPACE","\n    ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","assertResponse",210],"(",["T_LNUMBER","403",210],")",";",["T_WHITESPACE","\n\n    ",210],["T_VARIABLE","$blocked_account",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","delete",212],"(",")",";",["T_WHITESPACE","\n    ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","drupalGet",213],"(",["T_CONSTANT_ENCAPSED_STRING","\"user\/reset\/\"",213],["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_VARIABLE","$blocked_account",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","id",213],"(",")",["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],"\"",["T_ENCAPSED_AND_WHITESPACE","\/",213],["T_VARIABLE","$timestamp",213],["T_ENCAPSED_AND_WHITESPACE","\/",213],"\"",["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_STRING","user_pass_rehash",213],"(",["T_VARIABLE","$blocked_account",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$timestamp",213],")",["T_WHITESPACE"," ",213],".",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'\/login'",213],")",";",["T_WHITESPACE","\n    ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","assertResponse",214],"(",["T_LNUMBER","403",214],")",";",["T_WHITESPACE","\n  ",214],"}",["T_WHITESPACE","\n\n  ",215],["T_DOC_COMMENT","\/**\n   * Retrieves password reset email and extracts the login link.\n   *\/",217],["T_WHITESPACE","\n  ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","getResetURL",220],"(",")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n    ",220],["T_COMMENT","\/\/ Assume the most recent email.\n",221],["T_WHITESPACE","    ",222],["T_VARIABLE","$_emails",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","drupalGetMails",222],"(",")",";",["T_WHITESPACE","\n    ",222],["T_VARIABLE","$email",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","end",223],"(",["T_VARIABLE","$_emails",223],")",";",["T_WHITESPACE","\n    ",223],["T_VARIABLE","$urls",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_ARRAY","array",224],"(",")",";",["T_WHITESPACE","\n    ",224],["T_STRING","preg_match",225],"(",["T_CONSTANT_ENCAPSED_STRING","'#.+user\/reset\/.+#'",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$email",225],"[",["T_CONSTANT_ENCAPSED_STRING","'body'",225],"]",",",["T_WHITESPACE"," ",225],["T_VARIABLE","$urls",225],")",";",["T_WHITESPACE","\n\n    ",225],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$urls",227],"[",["T_LNUMBER","0",227],"]",";",["T_WHITESPACE","\n  ",227],"}",["T_WHITESPACE","\n\n  ",228],["T_DOC_COMMENT","\/**\n   * Test user password reset while logged in.\n   *\/",230],["T_WHITESPACE","\n  ",232],["T_PUBLIC","public",233],["T_WHITESPACE"," ",233],["T_FUNCTION","function",233],["T_WHITESPACE"," ",233],["T_STRING","testUserPasswordResetLoggedIn",233],"(",")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n    ",233],["T_VARIABLE","$another_account",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","drupalCreateUser",234],"(",")",";",["T_WHITESPACE","\n    ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","drupalLogin",235],"(",["T_VARIABLE","$another_account",235],")",";",["T_WHITESPACE","\n    ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","drupalGet",236],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",236],")",";",["T_WHITESPACE","\n    ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","drupalPostForm",237],"(",["T_STRING","NULL",237],",",["T_WHITESPACE"," ",237],["T_STRING","NULL",237],",",["T_WHITESPACE"," ",237],["T_STRING","t",237],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",237],")",")",";",["T_WHITESPACE","\n\n    ",237],["T_COMMENT","\/\/ Click the reset URL while logged and change our password.\n",239],["T_WHITESPACE","    ",240],["T_VARIABLE","$resetURL",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getResetURL",240],"(",")",";",["T_WHITESPACE","\n    ",240],["T_COMMENT","\/\/ Log in as a different user.\n",241],["T_WHITESPACE","    ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","drupalLogin",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","account",242],")",";",["T_WHITESPACE","\n    ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","drupalGet",243],"(",["T_VARIABLE","$resetURL",243],")",";",["T_WHITESPACE","\n    ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","assertRaw",244],"(",["T_NEW","new",244],["T_WHITESPACE"," ",244],["T_STRING","FormattableMarkup",244],"(",["T_WHITESPACE","\n      ",244],["T_CONSTANT_ENCAPSED_STRING","'Another user (%other_user) is already logged into the site on this computer, but you tried to use a one-time link for user %resetting_user. Please <a href=\":logout\">log out<\/a> and try using the link again.'",245],",",["T_WHITESPACE","\n      ",245],"[",["T_CONSTANT_ENCAPSED_STRING","'%other_user'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","account",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getUsername",246],"(",")",",",["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'%resetting_user'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$another_account",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getUsername",246],"(",")",",",["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","':logout'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_STRING","Url",246],["T_DOUBLE_COLON","::",246],["T_STRING","fromRoute",246],"(",["T_CONSTANT_ENCAPSED_STRING","'user.logout'",246],")",["T_OBJECT_OPERATOR","->",246],["T_STRING","toString",246],"(",")","]",["T_WHITESPACE","\n    ",246],")",")",";",["T_WHITESPACE","\n\n    ",247],["T_VARIABLE","$another_account",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","delete",249],"(",")",";",["T_WHITESPACE","\n    ",249],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","drupalGet",250],"(",["T_VARIABLE","$resetURL",250],")",";",["T_WHITESPACE","\n    ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","assertText",251],"(",["T_CONSTANT_ENCAPSED_STRING","'The one-time login link you clicked is invalid.'",251],")",";",["T_WHITESPACE","\n\n    ",251],["T_COMMENT","\/\/ Log in.\n",253],["T_WHITESPACE","    ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","drupalLogin",254],"(",["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","account",254],")",";",["T_WHITESPACE","\n\n    ",254],["T_COMMENT","\/\/ Reset the password by username via the password reset page.\n",256],["T_WHITESPACE","    ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","drupalGet",257],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",257],")",";",["T_WHITESPACE","\n    ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","drupalPostForm",258],"(",["T_STRING","NULL",258],",",["T_WHITESPACE"," ",258],["T_STRING","NULL",258],",",["T_WHITESPACE"," ",258],["T_STRING","t",258],"(",["T_CONSTANT_ENCAPSED_STRING","'Submit'",258],")",")",";",["T_WHITESPACE","\n\n    ",258],["T_COMMENT","\/\/ Click the reset URL while logged and change our password.\n",260],["T_WHITESPACE","    ",261],["T_VARIABLE","$resetURL",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getResetURL",261],"(",")",";",["T_WHITESPACE","\n    ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","drupalGet",262],"(",["T_VARIABLE","$resetURL",262],")",";",["T_WHITESPACE","\n    ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","drupalPostForm",263],"(",["T_STRING","NULL",263],",",["T_WHITESPACE"," ",263],["T_STRING","NULL",263],",",["T_WHITESPACE"," ",263],["T_STRING","t",263],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",263],")",")",";",["T_WHITESPACE","\n\n    ",263],["T_COMMENT","\/\/ Change the password.\n",265],["T_WHITESPACE","    ",266],["T_VARIABLE","$password",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_STRING","user_password",266],"(",")",";",["T_WHITESPACE","\n    ",266],["T_VARIABLE","$edit",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_ARRAY","array",267],"(",["T_CONSTANT_ENCAPSED_STRING","'pass[pass1]'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$password",267],",",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'pass[pass2]'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$password",267],")",";",["T_WHITESPACE","\n    ",267],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","drupalPostForm",268],"(",["T_STRING","NULL",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$edit",268],",",["T_WHITESPACE"," ",268],["T_STRING","t",268],"(",["T_CONSTANT_ENCAPSED_STRING","'Save'",268],")",")",";",["T_WHITESPACE","\n    ",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","assertText",269],"(",["T_STRING","t",269],"(",["T_CONSTANT_ENCAPSED_STRING","'The changes have been saved.'",269],")",",",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'Password changed.'",269],")",";",["T_WHITESPACE","\n\n    ",269],["T_COMMENT","\/\/ Logged in users should not be able to access the user.reset.login or the\n",271],["T_WHITESPACE","    ",272],["T_COMMENT","\/\/ user.reset.form routes.\n",272],["T_WHITESPACE","    ",273],["T_VARIABLE","$timestamp",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","REQUEST_TIME",273],["T_WHITESPACE"," ",273],"-",["T_WHITESPACE"," ",273],["T_LNUMBER","1",273],";",["T_WHITESPACE","\n    ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","drupalGet",274],"(",["T_CONSTANT_ENCAPSED_STRING","\"user\/reset\/\"",274],["T_WHITESPACE"," ",274],".",["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","account",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","id",274],"(",")",["T_WHITESPACE"," ",274],".",["T_WHITESPACE"," ",274],"\"",["T_ENCAPSED_AND_WHITESPACE","\/",274],["T_VARIABLE","$timestamp",274],["T_ENCAPSED_AND_WHITESPACE","\/",274],"\"",["T_WHITESPACE"," ",274],".",["T_WHITESPACE"," ",274],["T_STRING","user_pass_rehash",274],"(",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","account",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$timestamp",274],")",["T_WHITESPACE"," ",274],".",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'\/login'",274],")",";",["T_WHITESPACE","\n    ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","assertResponse",275],"(",["T_LNUMBER","403",275],")",";",["T_WHITESPACE","\n    ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","drupalGet",276],"(",["T_CONSTANT_ENCAPSED_STRING","\"user\/reset\/\"",276],["T_WHITESPACE"," ",276],".",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","account",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","id",276],"(",")",")",";",["T_WHITESPACE","\n    ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","assertResponse",277],"(",["T_LNUMBER","403",277],")",";",["T_WHITESPACE","\n  ",277],"}",["T_WHITESPACE","\n\n  ",278],["T_DOC_COMMENT","\/**\n   * Prefill the text box on incorrect login via link to password reset page.\n   *\/",280],["T_WHITESPACE","\n  ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","testUserResetPasswordTextboxFilled",283],"(",")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n    ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","drupalGet",284],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/login'",284],")",";",["T_WHITESPACE","\n    ",284],["T_VARIABLE","$edit",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_ARRAY","array",285],"(",["T_WHITESPACE","\n      ",285],["T_CONSTANT_ENCAPSED_STRING","'name'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","randomMachineName",286],"(",")",",",["T_WHITESPACE","\n      ",286],["T_CONSTANT_ENCAPSED_STRING","'pass'",287],["T_WHITESPACE"," ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","randomMachineName",287],"(",")",",",["T_WHITESPACE","\n    ",287],")",";",["T_WHITESPACE","\n    ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","drupalPostForm",289],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/login'",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$edit",289],",",["T_WHITESPACE"," ",289],["T_STRING","t",289],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",289],")",")",";",["T_WHITESPACE","\n    ",289],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","assertRaw",290],"(",["T_STRING","t",290],"(",["T_CONSTANT_ENCAPSED_STRING","'Unrecognized username or password. <a href=\":password\">Forgot your password?<\/a>'",290],",",["T_WHITESPACE","\n      ",290],["T_ARRAY","array",291],"(",["T_CONSTANT_ENCAPSED_STRING","':password'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_NS_SEPARATOR","\\",291],["T_STRING","Drupal",291],["T_DOUBLE_COLON","::",291],["T_STRING","url",291],"(",["T_CONSTANT_ENCAPSED_STRING","'user.pass'",291],",",["T_WHITESPACE"," ",291],"[","]",",",["T_WHITESPACE"," ",291],["T_ARRAY","array",291],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_ARRAY","array",291],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$edit",291],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",291],"]",")",")",")",")",")",")",";",["T_WHITESPACE","\n    ",291],["T_UNSET","unset",292],"(",["T_VARIABLE","$edit",292],"[",["T_CONSTANT_ENCAPSED_STRING","'pass'",292],"]",")",";",["T_WHITESPACE","\n    ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","drupalGet",293],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",293],",",["T_WHITESPACE"," ",293],["T_ARRAY","array",293],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",293],["T_WHITESPACE"," ",293],["T_DOUBLE_ARROW","=>",293],["T_WHITESPACE"," ",293],["T_ARRAY","array",293],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",293],["T_WHITESPACE"," ",293],["T_DOUBLE_ARROW","=>",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$edit",293],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",293],"]",")",")",")",";",["T_WHITESPACE","\n    ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","assertFieldByName",294],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",294],",",["T_WHITESPACE"," ",294],["T_VARIABLE","$edit",294],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",294],"]",",",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'User name found.'",294],")",";",["T_WHITESPACE","\n    ",294],["T_COMMENT","\/\/ Ensure the name field value is not cached.\n",295],["T_WHITESPACE","    ",296],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","drupalGet",296],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",296],")",";",["T_WHITESPACE","\n    ",296],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","assertNoFieldByName",297],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",297],",",["T_WHITESPACE"," ",297],["T_VARIABLE","$edit",297],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",297],"]",",",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'User name not found.'",297],")",";",["T_WHITESPACE","\n  ",297],"}",["T_WHITESPACE","\n\n  ",298],["T_DOC_COMMENT","\/**\n   * Make sure that users cannot forge password reset URLs of other users.\n   *\/",300],["T_WHITESPACE","\n  ",302],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","testResetImpersonation",303],"(",")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n    ",303],["T_COMMENT","\/\/ Create two identical user accounts except for the user name. They must\n",304],["T_WHITESPACE","    ",305],["T_COMMENT","\/\/ have the same empty password, so we can't use $this->drupalCreateUser().\n",305],["T_WHITESPACE","    ",306],["T_VARIABLE","$edit",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_ARRAY","array",306],"(",")",";",["T_WHITESPACE","\n    ",306],["T_VARIABLE","$edit",307],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",307],"]",["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","randomMachineName",307],"(",")",";",["T_WHITESPACE","\n    ",307],["T_VARIABLE","$edit",308],"[",["T_CONSTANT_ENCAPSED_STRING","'mail'",308],"]",["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$edit",308],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",308],"]",["T_WHITESPACE"," ",308],".",["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'@example.com'",308],";",["T_WHITESPACE","\n    ",308],["T_VARIABLE","$edit",309],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",309],"]",["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_LNUMBER","1",309],";",["T_WHITESPACE","\n    ",309],["T_VARIABLE","$user1",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_STRING","User",310],["T_DOUBLE_COLON","::",310],["T_STRING","create",310],"(",["T_VARIABLE","$edit",310],")",";",["T_WHITESPACE","\n    ",310],["T_VARIABLE","$user1",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","save",311],"(",")",";",["T_WHITESPACE","\n\n    ",311],["T_VARIABLE","$edit",313],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",313],"]",["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","randomMachineName",313],"(",")",";",["T_WHITESPACE","\n    ",313],["T_VARIABLE","$user2",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","User",314],["T_DOUBLE_COLON","::",314],["T_STRING","create",314],"(",["T_VARIABLE","$edit",314],")",";",["T_WHITESPACE","\n    ",314],["T_VARIABLE","$user2",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","save",315],"(",")",";",["T_WHITESPACE","\n\n    ",315],["T_COMMENT","\/\/ Unique password hashes are automatically generated, the only way to\n",317],["T_WHITESPACE","    ",318],["T_COMMENT","\/\/ change that is to update it directly in the database.\n",318],["T_WHITESPACE","    ",319],["T_STRING","db_update",319],"(",["T_CONSTANT_ENCAPSED_STRING","'users_field_data'",319],")",["T_WHITESPACE","\n      ",319],["T_OBJECT_OPERATOR","->",320],["T_STRING","fields",320],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_STRING","NULL",320],"]",")",["T_WHITESPACE","\n      ",320],["T_OBJECT_OPERATOR","->",321],["T_STRING","condition",321],"(",["T_CONSTANT_ENCAPSED_STRING","'uid'",321],",",["T_WHITESPACE"," ",321],"[",["T_VARIABLE","$user1",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","id",321],"(",")",",",["T_WHITESPACE"," ",321],["T_VARIABLE","$user2",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","id",321],"(",")","]",",",["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'IN'",321],")",["T_WHITESPACE","\n      ",321],["T_OBJECT_OPERATOR","->",322],["T_STRING","execute",322],"(",")",";",["T_WHITESPACE","\n    ",322],["T_NS_SEPARATOR","\\",323],["T_STRING","Drupal",323],["T_DOUBLE_COLON","::",323],["T_STRING","entityManager",323],"(",")",["T_OBJECT_OPERATOR","->",323],["T_STRING","getStorage",323],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",323],")",["T_OBJECT_OPERATOR","->",323],["T_STRING","resetCache",323],"(",")",";",["T_WHITESPACE","\n    ",323],["T_VARIABLE","$user1",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_STRING","User",324],["T_DOUBLE_COLON","::",324],["T_STRING","load",324],"(",["T_VARIABLE","$user1",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","id",324],"(",")",")",";",["T_WHITESPACE","\n    ",324],["T_VARIABLE","$user2",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_STRING","User",325],["T_DOUBLE_COLON","::",325],["T_STRING","load",325],"(",["T_VARIABLE","$user2",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","id",325],"(",")",")",";",["T_WHITESPACE","\n\n    ",325],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","assertEqual",327],"(",["T_VARIABLE","$user1",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getPassword",327],"(",")",",",["T_WHITESPACE"," ",327],["T_VARIABLE","$user2",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getPassword",327],"(",")",",",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'Both users have the same password hash.'",327],")",";",["T_WHITESPACE","\n\n    ",327],["T_COMMENT","\/\/ The password reset URL must not be valid for the second user when only\n",329],["T_WHITESPACE","    ",330],["T_COMMENT","\/\/ the user ID is changed in the URL.\n",330],["T_WHITESPACE","    ",331],["T_VARIABLE","$reset_url",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_STRING","user_pass_reset_url",331],"(",["T_VARIABLE","$user1",331],")",";",["T_WHITESPACE","\n    ",331],["T_VARIABLE","$attack_reset_url",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","str_replace",332],"(","\"",["T_ENCAPSED_AND_WHITESPACE","user\/reset\/",332],["T_CURLY_OPEN","{",332],["T_VARIABLE","$user1",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","id",332],"(",")","}","\"",",",["T_WHITESPACE"," ",332],"\"",["T_ENCAPSED_AND_WHITESPACE","user\/reset\/",332],["T_CURLY_OPEN","{",332],["T_VARIABLE","$user2",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","id",332],"(",")","}","\"",",",["T_WHITESPACE"," ",332],["T_VARIABLE","$reset_url",332],")",";",["T_WHITESPACE","\n    ",332],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","drupalGet",333],"(",["T_VARIABLE","$attack_reset_url",333],")",";",["T_WHITESPACE","\n    ",333],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","drupalPostForm",334],"(",["T_STRING","NULL",334],",",["T_WHITESPACE"," ",334],["T_STRING","NULL",334],",",["T_WHITESPACE"," ",334],["T_STRING","t",334],"(",["T_CONSTANT_ENCAPSED_STRING","'Log in'",334],")",")",";",["T_WHITESPACE","\n    ",334],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","assertNoText",335],"(",["T_VARIABLE","$user2",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","getUsername",335],"(",")",",",["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'The invalid password reset page does not show the user name.'",335],")",";",["T_WHITESPACE","\n    ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","assertUrl",336],"(",["T_CONSTANT_ENCAPSED_STRING","'user\/password'",336],",",["T_WHITESPACE"," ",336],["T_ARRAY","array",336],"(",")",",",["T_WHITESPACE"," ",336],["T_CONSTANT_ENCAPSED_STRING","'The user is redirected to the password reset request page.'",336],")",";",["T_WHITESPACE","\n    ",336],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","assertText",337],"(",["T_CONSTANT_ENCAPSED_STRING","'You have tried to use a one-time login link that has either been used or is no longer valid. Please request a new one using the form below.'",337],")",";",["T_WHITESPACE","\n  ",337],"}",["T_WHITESPACE","\n\n",338],"}",["T_WHITESPACE","\n",340]]