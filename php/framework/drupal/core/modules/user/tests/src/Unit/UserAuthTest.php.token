[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Unit",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Tests",5],["T_NS_SEPARATOR","\\",5],["T_STRING","UnitTestCase",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","user",6],["T_NS_SEPARATOR","\\",6],["T_STRING","UserAuth",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * @coversDefaultClass \\Drupal\\user\\UserAuth\n * @group user\n *\/",8],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","UserAuthTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_STRING","UnitTestCase",12],["T_WHITESPACE"," ",12],"{",["T_WHITESPACE","\n\n  ",12],["T_DOC_COMMENT","\/**\n   * The mock user storage.\n   *\n   * @var \\Drupal\\Core\\Entity\\EntityStorageInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",14],["T_WHITESPACE","\n  ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$userStorage",19],";",["T_WHITESPACE","\n\n  ",19],["T_DOC_COMMENT","\/**\n   * The mocked password service.\n   *\n   * @var \\Drupal\\Core\\Password\\PasswordInterface|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",21],["T_WHITESPACE","\n  ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$passwordService",26],";",["T_WHITESPACE","\n\n  ",26],["T_DOC_COMMENT","\/**\n   * The mock user.\n   *\n   * @var \\Drupal\\user\\Entity\\User|\\PHPUnit_Framework_MockObject_MockObject\n   *\/",28],["T_WHITESPACE","\n  ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$testUser",33],";",["T_WHITESPACE","\n\n  ",33],["T_DOC_COMMENT","\/**\n   * The user auth object under test.\n   *\n   * @var \\Drupal\\user\\UserAuth\n   *\/",35],["T_WHITESPACE","\n  ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$userAuth",40],";",["T_WHITESPACE","\n\n  ",40],["T_DOC_COMMENT","\/**\n   * The test username.\n   *\n   * @var string\n   *\/",42],["T_WHITESPACE","\n  ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$username",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'test_user'",47],";",["T_WHITESPACE","\n\n  ",47],["T_DOC_COMMENT","\/**\n   * The test password.\n   *\n   * @var string\n   *\/",49],["T_WHITESPACE","\n  ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$password",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'password'",54],";",["T_WHITESPACE","\n\n  ",54],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",56],["T_WHITESPACE","\n  ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","setUp",59],"(",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n    ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","userStorage",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getMock",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Entity\\EntityStorageInterface'",60],")",";",["T_WHITESPACE","\n\n    ",60],["T_VARIABLE","$entity_manager",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getMock",62],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Entity\\EntityManagerInterface'",62],")",";",["T_WHITESPACE","\n    ",62],["T_VARIABLE","$entity_manager",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","expects",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","any",63],"(",")",")",["T_WHITESPACE","\n      ",63],["T_OBJECT_OPERATOR","->",64],["T_STRING","method",64],"(",["T_CONSTANT_ENCAPSED_STRING","'getStorage'",64],")",["T_WHITESPACE","\n      ",64],["T_OBJECT_OPERATOR","->",65],["T_STRING","with",65],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",65],")",["T_WHITESPACE","\n      ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","will",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","returnValue",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","userStorage",66],")",")",";",["T_WHITESPACE","\n\n    ",66],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","passwordService",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getMock",68],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\Core\\Password\\PasswordInterface'",68],")",";",["T_WHITESPACE","\n\n    ",68],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","testUser",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getMockBuilder",70],"(",["T_CONSTANT_ENCAPSED_STRING","'Drupal\\user\\Entity\\User'",70],")",["T_WHITESPACE","\n      ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","disableOriginalConstructor",71],"(",")",["T_WHITESPACE","\n      ",71],["T_OBJECT_OPERATOR","->",72],["T_STRING","setMethods",72],"(",["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'setPassword'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'save'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'getPassword'",72],")",")",["T_WHITESPACE","\n      ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","getMock",73],"(",")",";",["T_WHITESPACE","\n\n    ",73],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","userAuth",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_NEW","new",75],["T_WHITESPACE"," ",75],["T_STRING","UserAuth",75],"(",["T_VARIABLE","$entity_manager",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","passwordService",75],")",";",["T_WHITESPACE","\n  ",75],"}",["T_WHITESPACE","\n\n  ",76],["T_DOC_COMMENT","\/**\n   * Tests failing authentication with missing credential parameters.\n   *\n   * @covers ::authenticate\n   *\n   * @dataProvider providerTestAuthenticateWithMissingCredentials\n   *\/",78],["T_WHITESPACE","\n  ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","testAuthenticateWithMissingCredentials",85],"(",["T_VARIABLE","$username",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$password",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n    ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","userStorage",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","expects",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","never",86],"(",")",")",["T_WHITESPACE","\n      ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","method",87],"(",["T_CONSTANT_ENCAPSED_STRING","'loadByProperties'",87],")",";",["T_WHITESPACE","\n\n    ",87],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertFalse",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","userAuth",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","authenticate",89],"(",["T_VARIABLE","$username",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$password",89],")",")",";",["T_WHITESPACE","\n  ",89],"}",["T_WHITESPACE","\n\n  ",90],["T_DOC_COMMENT","\/**\n   * Data provider for testAuthenticateWithMissingCredentials().\n   *\n   * @return array\n   *\/",92],["T_WHITESPACE","\n  ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","providerTestAuthenticateWithMissingCredentials",97],"(",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n    ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_WHITESPACE","\n      ",98],["T_ARRAY","array",99],"(",["T_STRING","NULL",99],",",["T_WHITESPACE"," ",99],["T_STRING","NULL",99],")",",",["T_WHITESPACE","\n      ",99],["T_ARRAY","array",100],"(",["T_STRING","NULL",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","''",100],")",",",["T_WHITESPACE","\n      ",100],["T_ARRAY","array",101],"(",["T_CONSTANT_ENCAPSED_STRING","''",101],",",["T_WHITESPACE"," ",101],["T_STRING","NULL",101],")",",",["T_WHITESPACE","\n      ",101],["T_ARRAY","array",102],"(",["T_CONSTANT_ENCAPSED_STRING","''",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","''",102],")",",",["T_WHITESPACE","\n    ",102],")",";",["T_WHITESPACE","\n  ",103],"}",["T_WHITESPACE","\n\n  ",104],["T_DOC_COMMENT","\/**\n   * Tests the authenticate method with no account returned.\n   *\n   * @covers ::authenticate\n   *\/",106],["T_WHITESPACE","\n  ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","testAuthenticateWithNoAccountReturned",111],"(",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n    ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","userStorage",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","expects",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","once",112],"(",")",")",["T_WHITESPACE","\n      ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","method",113],"(",["T_CONSTANT_ENCAPSED_STRING","'loadByProperties'",113],")",["T_WHITESPACE","\n      ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","with",114],"(",["T_ARRAY","array",114],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","username",114],")",")",["T_WHITESPACE","\n      ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","will",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","returnValue",115],"(",["T_ARRAY","array",115],"(",")",")",")",";",["T_WHITESPACE","\n\n    ",115],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","assertFalse",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","userAuth",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","authenticate",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","username",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","password",117],")",")",";",["T_WHITESPACE","\n  ",117],"}",["T_WHITESPACE","\n\n  ",118],["T_DOC_COMMENT","\/**\n   * Tests the authenticate method with an incorrect password.\n   *\n   * @covers ::authenticate\n   *\/",120],["T_WHITESPACE","\n  ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","testAuthenticateWithIncorrectPassword",125],"(",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n    ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","userStorage",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","expects",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","once",126],"(",")",")",["T_WHITESPACE","\n      ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","method",127],"(",["T_CONSTANT_ENCAPSED_STRING","'loadByProperties'",127],")",["T_WHITESPACE","\n      ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","with",128],"(",["T_ARRAY","array",128],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","username",128],")",")",["T_WHITESPACE","\n      ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","will",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","returnValue",129],"(",["T_ARRAY","array",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","testUser",129],")",")",")",";",["T_WHITESPACE","\n\n    ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","passwordService",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","expects",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","once",131],"(",")",")",["T_WHITESPACE","\n      ",131],["T_OBJECT_OPERATOR","->",132],["T_STRING","method",132],"(",["T_CONSTANT_ENCAPSED_STRING","'check'",132],")",["T_WHITESPACE","\n      ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","with",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","password",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","testUser",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getPassword",133],"(",")",")",["T_WHITESPACE","\n      ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","will",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","returnValue",134],"(",["T_STRING","FALSE",134],")",")",";",["T_WHITESPACE","\n\n    ",134],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertFalse",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","userAuth",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","authenticate",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","username",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","password",136],")",")",";",["T_WHITESPACE","\n  ",136],"}",["T_WHITESPACE","\n\n  ",137],["T_DOC_COMMENT","\/**\n   * Tests the authenticate method with a correct password.\n   *\n   * @covers ::authenticate\n   *\/",139],["T_WHITESPACE","\n  ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","testAuthenticateWithCorrectPassword",144],"(",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n    ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","testUser",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","expects",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","once",145],"(",")",")",["T_WHITESPACE","\n      ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","method",146],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",146],")",["T_WHITESPACE","\n      ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","will",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","returnValue",147],"(",["T_LNUMBER","1",147],")",")",";",["T_WHITESPACE","\n\n    ",147],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","userStorage",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","expects",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","once",149],"(",")",")",["T_WHITESPACE","\n      ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","method",150],"(",["T_CONSTANT_ENCAPSED_STRING","'loadByProperties'",150],")",["T_WHITESPACE","\n      ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","with",151],"(",["T_ARRAY","array",151],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","username",151],")",")",["T_WHITESPACE","\n      ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","will",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","returnValue",152],"(",["T_ARRAY","array",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","testUser",152],")",")",")",";",["T_WHITESPACE","\n\n    ",152],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","passwordService",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","expects",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","once",154],"(",")",")",["T_WHITESPACE","\n      ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","method",155],"(",["T_CONSTANT_ENCAPSED_STRING","'check'",155],")",["T_WHITESPACE","\n      ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","with",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","password",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","testUser",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getPassword",156],"(",")",")",["T_WHITESPACE","\n      ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","will",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","returnValue",157],"(",["T_STRING","TRUE",157],")",")",";",["T_WHITESPACE","\n\n    ",157],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertsame",159],"(",["T_LNUMBER","1",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","userAuth",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","authenticate",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","username",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","password",159],")",")",";",["T_WHITESPACE","\n  ",159],"}",["T_WHITESPACE","\n\n  ",160],["T_DOC_COMMENT","\/**\n   * Tests the authenticate method with a correct password.\n   *\n   * We discovered in https:\/\/www.drupal.org\/node\/2563751 that logging in with a\n   * password that is literally \"0\" was not possible. This test ensures that\n   * this regression can't happen again.\n   *\n   * @covers ::authenticate\n   *\/",162],["T_WHITESPACE","\n  ",170],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","testAuthenticateWithZeroPassword",171],"(",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n    ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","testUser",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","expects",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","once",172],"(",")",")",["T_WHITESPACE","\n      ",172],["T_OBJECT_OPERATOR","->",173],["T_STRING","method",173],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",173],")",["T_WHITESPACE","\n      ",173],["T_OBJECT_OPERATOR","->",174],["T_STRING","will",174],"(",["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","returnValue",174],"(",["T_LNUMBER","2",174],")",")",";",["T_WHITESPACE","\n\n    ",174],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","userStorage",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","expects",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","once",176],"(",")",")",["T_WHITESPACE","\n      ",176],["T_OBJECT_OPERATOR","->",177],["T_STRING","method",177],"(",["T_CONSTANT_ENCAPSED_STRING","'loadByProperties'",177],")",["T_WHITESPACE","\n      ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","with",178],"(",["T_ARRAY","array",178],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","username",178],")",")",["T_WHITESPACE","\n      ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","will",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","returnValue",179],"(",["T_ARRAY","array",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","testUser",179],")",")",")",";",["T_WHITESPACE","\n\n    ",179],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","passwordService",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","expects",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","once",181],"(",")",")",["T_WHITESPACE","\n      ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","method",182],"(",["T_CONSTANT_ENCAPSED_STRING","'check'",182],")",["T_WHITESPACE","\n      ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","with",183],"(",["T_LNUMBER","0",183],",",["T_WHITESPACE"," ",183],["T_LNUMBER","0",183],")",["T_WHITESPACE","\n      ",183],["T_OBJECT_OPERATOR","->",184],["T_STRING","will",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","returnValue",184],"(",["T_STRING","TRUE",184],")",")",";",["T_WHITESPACE","\n\n    ",184],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","assertsame",186],"(",["T_LNUMBER","2",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","userAuth",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","authenticate",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","username",186],",",["T_WHITESPACE"," ",186],["T_LNUMBER","0",186],")",")",";",["T_WHITESPACE","\n  ",186],"}",["T_WHITESPACE","\n\n  ",187],["T_DOC_COMMENT","\/**\n   * Tests the authenticate method with a correct password and new password hash.\n   *\n   * @covers ::authenticate\n   *\/",189],["T_WHITESPACE","\n  ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","testAuthenticateWithCorrectPasswordAndNewPasswordHash",194],"(",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n    ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","testUser",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","expects",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","once",195],"(",")",")",["T_WHITESPACE","\n      ",195],["T_OBJECT_OPERATOR","->",196],["T_STRING","method",196],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",196],")",["T_WHITESPACE","\n      ",196],["T_OBJECT_OPERATOR","->",197],["T_STRING","will",197],"(",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","returnValue",197],"(",["T_LNUMBER","1",197],")",")",";",["T_WHITESPACE","\n    ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","testUser",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","expects",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","once",198],"(",")",")",["T_WHITESPACE","\n      ",198],["T_OBJECT_OPERATOR","->",199],["T_STRING","method",199],"(",["T_CONSTANT_ENCAPSED_STRING","'setPassword'",199],")",["T_WHITESPACE","\n      ",199],["T_OBJECT_OPERATOR","->",200],["T_STRING","with",200],"(",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","password",200],")",";",["T_WHITESPACE","\n    ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","testUser",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","expects",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","once",201],"(",")",")",["T_WHITESPACE","\n      ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","method",202],"(",["T_CONSTANT_ENCAPSED_STRING","'save'",202],")",";",["T_WHITESPACE","\n\n    ",202],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","userStorage",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","expects",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","once",204],"(",")",")",["T_WHITESPACE","\n      ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","method",205],"(",["T_CONSTANT_ENCAPSED_STRING","'loadByProperties'",205],")",["T_WHITESPACE","\n      ",205],["T_OBJECT_OPERATOR","->",206],["T_STRING","with",206],"(",["T_ARRAY","array",206],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","username",206],")",")",["T_WHITESPACE","\n      ",206],["T_OBJECT_OPERATOR","->",207],["T_STRING","will",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","returnValue",207],"(",["T_ARRAY","array",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","testUser",207],")",")",")",";",["T_WHITESPACE","\n\n    ",207],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","passwordService",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","expects",209],"(",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","once",209],"(",")",")",["T_WHITESPACE","\n      ",209],["T_OBJECT_OPERATOR","->",210],["T_STRING","method",210],"(",["T_CONSTANT_ENCAPSED_STRING","'check'",210],")",["T_WHITESPACE","\n      ",210],["T_OBJECT_OPERATOR","->",211],["T_STRING","with",211],"(",["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","password",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","testUser",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getPassword",211],"(",")",")",["T_WHITESPACE","\n      ",211],["T_OBJECT_OPERATOR","->",212],["T_STRING","will",212],"(",["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","returnValue",212],"(",["T_STRING","TRUE",212],")",")",";",["T_WHITESPACE","\n    ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","passwordService",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","expects",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","once",213],"(",")",")",["T_WHITESPACE","\n      ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","method",214],"(",["T_CONSTANT_ENCAPSED_STRING","'needsRehash'",214],")",["T_WHITESPACE","\n      ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","with",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","testUser",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getPassword",215],"(",")",")",["T_WHITESPACE","\n      ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","will",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","returnValue",216],"(",["T_STRING","TRUE",216],")",")",";",["T_WHITESPACE","\n\n    ",216],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","assertsame",218],"(",["T_LNUMBER","1",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","userAuth",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","authenticate",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","username",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","password",218],")",")",";",["T_WHITESPACE","\n  ",218],"}",["T_WHITESPACE","\n\n",219],"}",["T_WHITESPACE","\n",221]]