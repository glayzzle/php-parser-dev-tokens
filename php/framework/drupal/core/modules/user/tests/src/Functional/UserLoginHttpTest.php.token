[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Drupal",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","user",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Functional",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Drupal",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Core",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Flood",5],["T_NS_SEPARATOR","\\",5],["T_STRING","DatabaseBackend",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Drupal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Url",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Drupal",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Tests",7],["T_NS_SEPARATOR","\\",7],["T_STRING","BrowserTestBase",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Drupal",8],["T_NS_SEPARATOR","\\",8],["T_STRING","user",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Controller",8],["T_NS_SEPARATOR","\\",8],["T_STRING","UserAuthenticationController",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","GuzzleHttp",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Cookie",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CookieJar",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Psr",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Http",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Message",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ResponseInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Symfony",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Component",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Serializer",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Encoder",11],["T_NS_SEPARATOR","\\",11],["T_STRING","JsonEncoder",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Serializer",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Encoder",12],["T_NS_SEPARATOR","\\",12],["T_STRING","XmlEncoder",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Drupal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","hal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Encoder",13],["T_NS_SEPARATOR","\\",13],["T_STRING","JsonEncoder",13],["T_WHITESPACE"," ",13],["T_AS","as",13],["T_WHITESPACE"," ",13],["T_STRING","HALJsonEncoder",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Serializer",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Serializer",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Tests login via direct HTTP.\n *\n * @group user\n *\/",16],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","UserLoginHttpTest",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","BrowserTestBase",21],["T_WHITESPACE"," ",21],"{",["T_WHITESPACE","\n\n  ",21],["T_DOC_COMMENT","\/**\n   * Modules to install.\n   *\n   * @var array\n   *\/",23],["T_WHITESPACE","\n  ",27],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_STATIC","static",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$modules",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],"[",["T_CONSTANT_ENCAPSED_STRING","'hal'",28],"]",";",["T_WHITESPACE","\n\n  ",28],["T_DOC_COMMENT","\/**\n   * The cookie jar.\n   *\n   * @var \\GuzzleHttp\\Cookie\\CookieJar\n   *\/",30],["T_WHITESPACE","\n  ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$cookies",35],";",["T_WHITESPACE","\n\n  ",35],["T_DOC_COMMENT","\/**\n   * The serializer.\n   *\n   * @var \\Symfony\\Component\\Serializer\\Serializer\n   *\/",37],["T_WHITESPACE","\n  ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$serializer",42],";",["T_WHITESPACE","\n\n  ",42],["T_DOC_COMMENT","\/**\n   * {@inheritdoc}\n   *\/",44],["T_WHITESPACE","\n  ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","setUp",47],"(",")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n    ",47],["T_STRING","parent",48],["T_DOUBLE_COLON","::",48],["T_STRING","setUp",48],"(",")",";",["T_WHITESPACE","\n    ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","cookies",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_NEW","new",49],["T_WHITESPACE"," ",49],["T_STRING","CookieJar",49],"(",")",";",["T_WHITESPACE","\n    ",49],["T_VARIABLE","$encoders",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],"[",["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","JsonEncoder",50],"(",")",",",["T_WHITESPACE"," ",50],["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","XmlEncoder",50],"(",")",",",["T_WHITESPACE"," ",50],["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","HALJsonEncoder",50],"(",")","]",";",["T_WHITESPACE","\n    ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","serializer",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_NEW","new",51],["T_WHITESPACE"," ",51],["T_STRING","Serializer",51],"(","[","]",",",["T_WHITESPACE"," ",51],["T_VARIABLE","$encoders",51],")",";",["T_WHITESPACE","\n  ",51],"}",["T_WHITESPACE","\n\n  ",52],["T_DOC_COMMENT","\/**\n   * Executes a login HTTP request.\n   *\n   * @param string $name\n   *   The username.\n   * @param string $pass\n   *   The user password.\n   * @param string $format\n   *   The format to use to make the request.\n   *\n   * @return \\Psr\\Http\\Message\\ResponseInterface The HTTP response.\n   *   The HTTP response.\n   *\/",54],["T_WHITESPACE","\n  ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","loginRequest",67],"(",["T_VARIABLE","$name",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$pass",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$format",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'json'",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n    ",67],["T_VARIABLE","$user_login_url",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","Url",68],["T_DOUBLE_COLON","::",68],["T_STRING","fromRoute",68],"(",["T_CONSTANT_ENCAPSED_STRING","'user.login.http'",68],")",["T_WHITESPACE","\n      ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","setRouteParameter",69],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$format",69],")",["T_WHITESPACE","\n      ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","setAbsolute",70],"(",")",";",["T_WHITESPACE","\n\n    ",70],["T_VARIABLE","$request_body",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],"[","]",";",["T_WHITESPACE","\n    ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_ISSET","isset",73],"(",["T_VARIABLE","$name",73],")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n      ",73],["T_VARIABLE","$request_body",74],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",74],"]",["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$name",74],";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n    ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_ISSET","isset",76],"(",["T_VARIABLE","$pass",76],")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n      ",76],["T_VARIABLE","$request_body",77],"[",["T_CONSTANT_ENCAPSED_STRING","'pass'",77],"]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$pass",77],";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_VARIABLE","$result",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Drupal",80],["T_DOUBLE_COLON","::",80],["T_STRING","httpClient",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","post",80],"(",["T_VARIABLE","$user_login_url",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","toString",80],"(",")",",",["T_WHITESPACE"," ",80],"[",["T_WHITESPACE","\n      ",80],["T_CONSTANT_ENCAPSED_STRING","'body'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","serializer",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","encode",81],"(",["T_VARIABLE","$request_body",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$format",81],")",",",["T_WHITESPACE","\n      ",81],["T_CONSTANT_ENCAPSED_STRING","'headers'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],"[",["T_WHITESPACE","\n        ",82],["T_CONSTANT_ENCAPSED_STRING","'Accept'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],"\"",["T_ENCAPSED_AND_WHITESPACE","application\/",83],["T_VARIABLE","$format",83],"\"",",",["T_WHITESPACE","\n      ",83],"]",",",["T_WHITESPACE","\n      ",84],["T_CONSTANT_ENCAPSED_STRING","'http_errors'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_STRING","FALSE",85],",",["T_WHITESPACE","\n      ",85],["T_CONSTANT_ENCAPSED_STRING","'cookies'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","cookies",86],",",["T_WHITESPACE","\n    ",86],"]",")",";",["T_WHITESPACE","\n    ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$result",88],";",["T_WHITESPACE","\n  ",88],"}",["T_WHITESPACE","\n\n  ",89],["T_DOC_COMMENT","\/**\n   * Tests user session life cycle.\n   *\/",91],["T_WHITESPACE","\n  ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","testLogin",94],"(",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n    ",94],["T_VARIABLE","$client",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Drupal",95],["T_DOUBLE_COLON","::",95],["T_STRING","httpClient",95],"(",")",";",["T_WHITESPACE","\n    ",95],["T_FOREACH","foreach",96],["T_WHITESPACE"," ",96],"(","[",["T_STRING","FALSE",96],",",["T_WHITESPACE"," ",96],["T_STRING","TRUE",96],"]",["T_WHITESPACE"," ",96],["T_AS","as",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$serialization_enabled_option",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n      ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$serialization_enabled_option",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n        ",97],["T_DOC_COMMENT","\/** @var \\Drupal\\Core\\Extension\\ModuleInstaller $module_installer *\/",98],["T_WHITESPACE","\n        ",98],["T_VARIABLE","$module_installer",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","container",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","get",99],"(",["T_CONSTANT_ENCAPSED_STRING","'module_installer'",99],")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$module_installer",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","install",100],"(","[",["T_CONSTANT_ENCAPSED_STRING","'serialization'",100],"]",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$formats",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],"[",["T_CONSTANT_ENCAPSED_STRING","'json'",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'xml'",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'hal_json'",101],"]",";",["T_WHITESPACE","\n      ",101],"}",["T_WHITESPACE","\n      ",102],["T_ELSE","else",103],["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n        ",103],["T_COMMENT","\/\/ Without the serialization module only JSON is supported.\n",104],["T_WHITESPACE","        ",105],["T_VARIABLE","$formats",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],"[",["T_CONSTANT_ENCAPSED_STRING","'json'",105],"]",";",["T_WHITESPACE","\n      ",105],"}",["T_WHITESPACE","\n      ",106],["T_FOREACH","foreach",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$formats",107],["T_WHITESPACE"," ",107],["T_AS","as",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$format",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n        ",107],["T_COMMENT","\/\/ Create new user for each iteration to reset flood.\n",108],["T_WHITESPACE","        ",109],["T_COMMENT","\/\/ Grant the user administer users permissions to they can see the\n",109],["T_WHITESPACE","        ",110],["T_COMMENT","\/\/ 'roles' field.\n",110],["T_WHITESPACE","        ",111],["T_VARIABLE","$account",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","drupalCreateUser",111],"(","[",["T_CONSTANT_ENCAPSED_STRING","'administer users'",111],"]",")",";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$name",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$account",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getUsername",112],"(",")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$pass",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$account",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","passRaw",113],";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$login_status_url",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getLoginStatusUrlString",115],"(",["T_VARIABLE","$format",115],")",";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$response",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$client",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","get",116],"(",["T_VARIABLE","$login_status_url",116],")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","assertHttpResponse",117],"(",["T_VARIABLE","$response",117],",",["T_WHITESPACE"," ",117],["T_LNUMBER","200",117],",",["T_WHITESPACE"," ",117],["T_STRING","UserAuthenticationController",117],["T_DOUBLE_COLON","::",117],["T_STRING","LOGGED_OUT",117],")",";",["T_WHITESPACE","\n\n        ",117],["T_COMMENT","\/\/ Flooded.\n",119],["T_WHITESPACE","        ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","config",120],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",120],")",["T_WHITESPACE","\n          ",120],["T_OBJECT_OPERATOR","->",121],["T_STRING","set",121],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",121],",",["T_WHITESPACE"," ",121],["T_LNUMBER","3",121],")",["T_WHITESPACE","\n          ",121],["T_OBJECT_OPERATOR","->",122],["T_STRING","save",122],"(",")",";",["T_WHITESPACE","\n\n        ",122],["T_VARIABLE","$response",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","loginRequest",124],"(",["T_VARIABLE","$name",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'wrong-pass'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$format",124],")",";",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","assertHttpResponseWithMessage",125],"(",["T_VARIABLE","$response",125],",",["T_WHITESPACE"," ",125],["T_LNUMBER","400",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$format",125],")",";",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$response",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","loginRequest",127],"(",["T_VARIABLE","$name",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'wrong-pass'",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$format",127],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","assertHttpResponseWithMessage",128],"(",["T_VARIABLE","$response",128],",",["T_WHITESPACE"," ",128],["T_LNUMBER","400",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$format",128],")",";",["T_WHITESPACE","\n\n        ",128],["T_VARIABLE","$response",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","loginRequest",130],"(",["T_VARIABLE","$name",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'wrong-pass'",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$format",130],")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertHttpResponseWithMessage",131],"(",["T_VARIABLE","$response",131],",",["T_WHITESPACE"," ",131],["T_LNUMBER","400",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$format",131],")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$response",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","loginRequest",133],"(",["T_VARIABLE","$name",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'wrong-pass'",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$format",133],")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertHttpResponseWithMessage",134],"(",["T_VARIABLE","$response",134],",",["T_WHITESPACE"," ",134],["T_LNUMBER","403",134],",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'Too many failed login attempts from your IP address. This IP address is temporarily blocked.'",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$format",134],")",";",["T_WHITESPACE","\n\n        ",134],["T_COMMENT","\/\/ After testing the flood control we can increase the limit.\n",136],["T_WHITESPACE","        ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","config",137],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",137],")",["T_WHITESPACE","\n          ",137],["T_OBJECT_OPERATOR","->",138],["T_STRING","set",138],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",138],",",["T_WHITESPACE"," ",138],["T_LNUMBER","100",138],")",["T_WHITESPACE","\n          ",138],["T_OBJECT_OPERATOR","->",139],["T_STRING","save",139],"(",")",";",["T_WHITESPACE","\n\n        ",139],["T_VARIABLE","$response",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","loginRequest",141],"(",["T_STRING","NULL",141],",",["T_WHITESPACE"," ",141],["T_STRING","NULL",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$format",141],")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","assertHttpResponseWithMessage",142],"(",["T_VARIABLE","$response",142],",",["T_WHITESPACE"," ",142],["T_LNUMBER","400",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'Missing credentials.'",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$format",142],")",";",["T_WHITESPACE","\n\n        ",142],["T_VARIABLE","$response",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","loginRequest",144],"(",["T_STRING","NULL",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$pass",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$format",144],")",";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","assertHttpResponseWithMessage",145],"(",["T_VARIABLE","$response",145],",",["T_WHITESPACE"," ",145],["T_LNUMBER","400",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'Missing credentials.name.'",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$format",145],")",";",["T_WHITESPACE","\n\n        ",145],["T_VARIABLE","$response",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","loginRequest",147],"(",["T_VARIABLE","$name",147],",",["T_WHITESPACE"," ",147],["T_STRING","NULL",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$format",147],")",";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","assertHttpResponseWithMessage",148],"(",["T_VARIABLE","$response",148],",",["T_WHITESPACE"," ",148],["T_LNUMBER","400",148],",",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'Missing credentials.pass.'",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$format",148],")",";",["T_WHITESPACE","\n\n        ",148],["T_COMMENT","\/\/ Blocked.\n",150],["T_WHITESPACE","        ",151],["T_VARIABLE","$account",151],["T_WHITESPACE","\n          ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","block",152],"(",")",["T_WHITESPACE","\n          ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","save",153],"(",")",";",["T_WHITESPACE","\n\n        ",153],["T_VARIABLE","$response",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","loginRequest",155],"(",["T_VARIABLE","$name",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$pass",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$format",155],")",";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","assertHttpResponseWithMessage",156],"(",["T_VARIABLE","$response",156],",",["T_WHITESPACE"," ",156],["T_LNUMBER","400",156],",",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'The user has not been activated or is blocked.'",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$format",156],")",";",["T_WHITESPACE","\n\n        ",156],["T_VARIABLE","$account",158],["T_WHITESPACE","\n          ",158],["T_OBJECT_OPERATOR","->",159],["T_STRING","activate",159],"(",")",["T_WHITESPACE","\n          ",159],["T_OBJECT_OPERATOR","->",160],["T_STRING","save",160],"(",")",";",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$response",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","loginRequest",162],"(",["T_VARIABLE","$name",162],",",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'garbage'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$format",162],")",";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertHttpResponseWithMessage",163],"(",["T_VARIABLE","$response",163],",",["T_WHITESPACE"," ",163],["T_LNUMBER","400",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$format",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_VARIABLE","$response",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","loginRequest",165],"(",["T_CONSTANT_ENCAPSED_STRING","'garbage'",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$pass",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$format",165],")",";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","assertHttpResponseWithMessage",166],"(",["T_VARIABLE","$response",166],",",["T_WHITESPACE"," ",166],["T_LNUMBER","400",166],",",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$format",166],")",";",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$response",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","loginRequest",168],"(",["T_VARIABLE","$name",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$pass",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$format",168],")",";",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","assertEquals",169],"(",["T_LNUMBER","200",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$response",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getStatusCode",169],"(",")",")",";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$result_data",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","serializer",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","decode",170],"(",["T_VARIABLE","$response",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getBody",170],"(",")",",",["T_WHITESPACE"," ",170],["T_VARIABLE","$format",170],")",";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","assertEquals",171],"(",["T_VARIABLE","$name",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$result_data",171],"[",["T_CONSTANT_ENCAPSED_STRING","'current_user'",171],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",171],"]",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","assertEquals",172],"(",["T_VARIABLE","$account",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","id",172],"(",")",",",["T_WHITESPACE"," ",172],["T_VARIABLE","$result_data",172],"[",["T_CONSTANT_ENCAPSED_STRING","'current_user'",172],"]","[",["T_CONSTANT_ENCAPSED_STRING","'uid'",172],"]",")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","assertEquals",173],"(",["T_VARIABLE","$account",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getRoles",173],"(",")",",",["T_WHITESPACE"," ",173],["T_VARIABLE","$result_data",173],"[",["T_CONSTANT_ENCAPSED_STRING","'current_user'",173],"]","[",["T_CONSTANT_ENCAPSED_STRING","'roles'",173],"]",")",";",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$logout_token",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$result_data",174],"[",["T_CONSTANT_ENCAPSED_STRING","'logout_token'",174],"]",";",["T_WHITESPACE","\n\n        ",174],["T_VARIABLE","$response",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$client",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","get",176],"(",["T_VARIABLE","$login_status_url",176],",",["T_WHITESPACE"," ",176],"[",["T_CONSTANT_ENCAPSED_STRING","'cookies'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","cookies",176],"]",")",";",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","assertHttpResponse",177],"(",["T_VARIABLE","$response",177],",",["T_WHITESPACE"," ",177],["T_LNUMBER","200",177],",",["T_WHITESPACE"," ",177],["T_STRING","UserAuthenticationController",177],["T_DOUBLE_COLON","::",177],["T_STRING","LOGGED_IN",177],")",";",["T_WHITESPACE","\n\n        ",177],["T_VARIABLE","$response",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","logoutRequest",179],"(",["T_VARIABLE","$format",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$logout_token",179],")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","assertEquals",180],"(",["T_LNUMBER","204",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$response",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getStatusCode",180],"(",")",")",";",["T_WHITESPACE","\n\n        ",180],["T_VARIABLE","$response",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$client",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","get",182],"(",["T_VARIABLE","$login_status_url",182],",",["T_WHITESPACE"," ",182],"[",["T_CONSTANT_ENCAPSED_STRING","'cookies'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","cookies",182],"]",")",";",["T_WHITESPACE","\n        ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","assertHttpResponse",183],"(",["T_VARIABLE","$response",183],",",["T_WHITESPACE"," ",183],["T_LNUMBER","200",183],",",["T_WHITESPACE"," ",183],["T_STRING","UserAuthenticationController",183],["T_DOUBLE_COLON","::",183],["T_STRING","LOGGED_OUT",183],")",";",["T_WHITESPACE","\n\n        ",183],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","resetFlood",185],"(",")",";",["T_WHITESPACE","\n      ",185],"}",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n  ",187],"}",["T_WHITESPACE","\n\n  ",188],["T_DOC_COMMENT","\/**\n   * Gets a value for a given key from the response.\n   *\n   * @param \\Psr\\Http\\Message\\ResponseInterface $response\n   *   The response object.\n   * @param string $key\n   *   The key for the value.\n   * @param string $format\n   *   The encoded format.\n   *\n   * @return mixed\n   *   The value for the key.\n   *\/",190],["T_WHITESPACE","\n  ",202],["T_PROTECTED","protected",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","getResultValue",203],"(",["T_STRING","ResponseInterface",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$response",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$key",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$format",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n    ",203],["T_VARIABLE","$decoded",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","serializer",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","decode",204],"(",["T_STRING_CAST","(string)",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$response",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getBody",204],"(",")",",",["T_WHITESPACE"," ",204],["T_VARIABLE","$format",204],")",";",["T_WHITESPACE","\n    ",204],["T_IF","if",205],["T_WHITESPACE"," ",205],"(",["T_STRING","is_array",205],"(",["T_VARIABLE","$decoded",205],")",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n      ",205],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$decoded",206],"[",["T_VARIABLE","$key",206],"]",";",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n    ",207],["T_ELSE","else",208],["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n      ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$decoded",209],["T_OBJECT_OPERATOR","->",209],"{",["T_VARIABLE","$key",209],"}",";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n  ",210],"}",["T_WHITESPACE","\n\n  ",211],["T_DOC_COMMENT","\/**\n   * Resets all flood entries.\n   *\/",213],["T_WHITESPACE","\n  ",215],["T_PROTECTED","protected",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","resetFlood",216],"(",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n    ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","container",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","get",217],"(",["T_CONSTANT_ENCAPSED_STRING","'database'",217],")",["T_OBJECT_OPERATOR","->",217],["T_STRING","delete",217],"(",["T_STRING","DatabaseBackend",217],["T_DOUBLE_COLON","::",217],["T_STRING","TABLE_NAME",217],")",["T_OBJECT_OPERATOR","->",217],["T_STRING","execute",217],"(",")",";",["T_WHITESPACE","\n  ",217],"}",["T_WHITESPACE","\n\n  ",218],["T_DOC_COMMENT","\/**\n   * Tests the global login flood control.\n   *\n   * @see \\Drupal\\basic_auth\\Tests\\Authentication\\BasicAuthTest::testGlobalLoginFloodControl\n   * @see \\Drupal\\user\\Tests\\UserLoginTest::testGlobalLoginFloodControl\n   *\/",220],["T_WHITESPACE","\n  ",225],["T_PUBLIC","public",226],["T_WHITESPACE"," ",226],["T_FUNCTION","function",226],["T_WHITESPACE"," ",226],["T_STRING","testGlobalLoginFloodControl",226],"(",")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n    ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","config",227],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",227],")",["T_WHITESPACE","\n      ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","set",228],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",228],",",["T_WHITESPACE"," ",228],["T_LNUMBER","2",228],")",["T_WHITESPACE","\n      ",228],["T_COMMENT","\/\/ Set a high per-user limit out so that it is not relevant in the test.\n",229],["T_WHITESPACE","      ",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","set",230],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",230],",",["T_WHITESPACE"," ",230],["T_LNUMBER","4000",230],")",["T_WHITESPACE","\n      ",230],["T_OBJECT_OPERATOR","->",231],["T_STRING","save",231],"(",")",";",["T_WHITESPACE","\n\n    ",231],["T_VARIABLE","$user",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","drupalCreateUser",233],"(","[","]",")",";",["T_WHITESPACE","\n    ",233],["T_VARIABLE","$incorrect_user",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_CLONE","clone",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$user",234],";",["T_WHITESPACE","\n    ",234],["T_VARIABLE","$incorrect_user",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","passRaw",235],["T_WHITESPACE"," ",235],["T_CONCAT_EQUAL",".=",235],["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'incorrect'",235],";",["T_WHITESPACE","\n\n    ",235],["T_COMMENT","\/\/ Try 2 failed logins.\n",237],["T_WHITESPACE","    ",238],["T_FOR","for",238],["T_WHITESPACE"," ",238],"(",["T_VARIABLE","$i",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_LNUMBER","0",238],";",["T_WHITESPACE"," ",238],["T_VARIABLE","$i",238],["T_WHITESPACE"," ",238],"<",["T_WHITESPACE"," ",238],["T_LNUMBER","2",238],";",["T_WHITESPACE"," ",238],["T_VARIABLE","$i",238],["T_INC","++",238],")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n      ",238],["T_VARIABLE","$response",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","loginRequest",239],"(",["T_VARIABLE","$incorrect_user",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getUsername",239],"(",")",",",["T_WHITESPACE"," ",239],["T_VARIABLE","$incorrect_user",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","passRaw",239],")",";",["T_WHITESPACE","\n      ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","assertEquals",240],"(",["T_CONSTANT_ENCAPSED_STRING","'400'",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$response",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getStatusCode",240],"(",")",")",";",["T_WHITESPACE","\n    ",240],"}",["T_WHITESPACE","\n\n    ",241],["T_COMMENT","\/\/ IP limit has reached to its limit. Even valid user credentials will fail.\n",243],["T_WHITESPACE","    ",244],["T_VARIABLE","$response",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","loginRequest",244],"(",["T_VARIABLE","$user",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getUsername",244],"(",")",",",["T_WHITESPACE"," ",244],["T_VARIABLE","$user",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","passRaw",244],")",";",["T_WHITESPACE","\n    ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","assertHttpResponseWithMessage",245],"(",["T_VARIABLE","$response",245],",",["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","'403'",245],",",["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","'Access is blocked because of IP based flood prevention.'",245],")",";",["T_WHITESPACE","\n  ",245],"}",["T_WHITESPACE","\n\n  ",246],["T_DOC_COMMENT","\/**\n   * Checks a response for status code and body.\n   *\n   * @param \\Psr\\Http\\Message\\ResponseInterface $response\n   *   The response object.\n   * @param int $expected_code\n   *   The expected status code.\n   * @param mixed $expected_body\n   *   The expected response body.\n   *\/",248],["T_WHITESPACE","\n  ",257],["T_PROTECTED","protected",258],["T_WHITESPACE"," ",258],["T_FUNCTION","function",258],["T_WHITESPACE"," ",258],["T_STRING","assertHttpResponse",258],"(",["T_STRING","ResponseInterface",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$response",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$expected_code",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$expected_body",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n    ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","assertEquals",259],"(",["T_VARIABLE","$expected_code",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$response",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getStatusCode",259],"(",")",")",";",["T_WHITESPACE","\n    ",259],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","assertEquals",260],"(",["T_VARIABLE","$expected_body",260],",",["T_WHITESPACE"," ",260],["T_STRING_CAST","(string)",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$response",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getBody",260],"(",")",")",";",["T_WHITESPACE","\n  ",260],"}",["T_WHITESPACE","\n\n  ",261],["T_DOC_COMMENT","\/**\n   * Checks a response for status code and message.\n   *\n   * @param \\Psr\\Http\\Message\\ResponseInterface $response\n   *   The response object.\n   * @param int $expected_code\n   *   The expected status code.\n   * @param string $expected_message\n   *   The expected message encoded in response.\n   * @param string $format\n   *   The format that the response is encoded in.\n   *\/",263],["T_WHITESPACE","\n  ",274],["T_PROTECTED","protected",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","assertHttpResponseWithMessage",275],"(",["T_STRING","ResponseInterface",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$response",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$expected_code",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$expected_message",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$format",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_CONSTANT_ENCAPSED_STRING","'json'",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n    ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","assertEquals",276],"(",["T_VARIABLE","$expected_code",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$response",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getStatusCode",276],"(",")",")",";",["T_WHITESPACE","\n    ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","assertEquals",277],"(",["T_VARIABLE","$expected_message",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getResultValue",277],"(",["T_VARIABLE","$response",277],",",["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","'message'",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$format",277],")",")",";",["T_WHITESPACE","\n  ",277],"}",["T_WHITESPACE","\n\n  ",278],["T_DOC_COMMENT","\/**\n   * Test the per-user login flood control.\n   *\n   * @see \\Drupal\\user\\Tests\\UserLoginTest::testPerUserLoginFloodControl\n   * @see \\Drupal\\basic_auth\\Tests\\Authentication\\BasicAuthTest::testPerUserLoginFloodControl\n   *\/",280],["T_WHITESPACE","\n  ",285],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","testPerUserLoginFloodControl",286],"(",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n    ",286],["T_FOREACH","foreach",287],["T_WHITESPACE"," ",287],"(","[",["T_STRING","TRUE",287],",",["T_WHITESPACE"," ",287],["T_STRING","FALSE",287],"]",["T_WHITESPACE"," ",287],["T_AS","as",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$uid_only_setting",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n      ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","config",288],"(",["T_CONSTANT_ENCAPSED_STRING","'user.flood'",288],")",["T_WHITESPACE","\n        ",288],["T_COMMENT","\/\/ Set a high global limit out so that it is not relevant in the test.\n",289],["T_WHITESPACE","        ",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","set",290],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_limit'",290],",",["T_WHITESPACE"," ",290],["T_LNUMBER","4000",290],")",["T_WHITESPACE","\n        ",290],["T_OBJECT_OPERATOR","->",291],["T_STRING","set",291],"(",["T_CONSTANT_ENCAPSED_STRING","'user_limit'",291],",",["T_WHITESPACE"," ",291],["T_LNUMBER","3",291],")",["T_WHITESPACE","\n        ",291],["T_OBJECT_OPERATOR","->",292],["T_STRING","set",292],"(",["T_CONSTANT_ENCAPSED_STRING","'uid_only'",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$uid_only_setting",292],")",["T_WHITESPACE","\n        ",292],["T_OBJECT_OPERATOR","->",293],["T_STRING","save",293],"(",")",";",["T_WHITESPACE","\n\n      ",293],["T_VARIABLE","$user1",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","drupalCreateUser",295],"(","[","]",")",";",["T_WHITESPACE","\n      ",295],["T_VARIABLE","$incorrect_user1",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_CLONE","clone",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$user1",296],";",["T_WHITESPACE","\n      ",296],["T_VARIABLE","$incorrect_user1",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","passRaw",297],["T_WHITESPACE"," ",297],["T_CONCAT_EQUAL",".=",297],["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'incorrect'",297],";",["T_WHITESPACE","\n\n      ",297],["T_VARIABLE","$user2",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","drupalCreateUser",299],"(","[","]",")",";",["T_WHITESPACE","\n\n      ",299],["T_COMMENT","\/\/ Try 2 failed logins.\n",301],["T_WHITESPACE","      ",302],["T_FOR","for",302],["T_WHITESPACE"," ",302],"(",["T_VARIABLE","$i",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_LNUMBER","0",302],";",["T_WHITESPACE"," ",302],["T_VARIABLE","$i",302],["T_WHITESPACE"," ",302],"<",["T_WHITESPACE"," ",302],["T_LNUMBER","2",302],";",["T_WHITESPACE"," ",302],["T_VARIABLE","$i",302],["T_INC","++",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$response",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","loginRequest",303],"(",["T_VARIABLE","$incorrect_user1",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getUsername",303],"(",")",",",["T_WHITESPACE"," ",303],["T_VARIABLE","$incorrect_user1",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","passRaw",303],")",";",["T_WHITESPACE","\n        ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","assertHttpResponseWithMessage",304],"(",["T_VARIABLE","$response",304],",",["T_WHITESPACE"," ",304],["T_LNUMBER","400",304],",",["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",304],")",";",["T_WHITESPACE","\n      ",304],"}",["T_WHITESPACE","\n\n      ",305],["T_COMMENT","\/\/ A successful login will reset the per-user flood control count.\n",307],["T_WHITESPACE","      ",308],["T_VARIABLE","$response",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","loginRequest",308],"(",["T_VARIABLE","$user1",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getUsername",308],"(",")",",",["T_WHITESPACE"," ",308],["T_VARIABLE","$user1",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","passRaw",308],")",";",["T_WHITESPACE","\n      ",308],["T_VARIABLE","$result_data",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","serializer",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","decode",309],"(",["T_VARIABLE","$response",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getBody",309],"(",")",",",["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'json'",309],")",";",["T_WHITESPACE","\n      ",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","logoutRequest",310],"(",["T_CONSTANT_ENCAPSED_STRING","'json'",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$result_data",310],"[",["T_CONSTANT_ENCAPSED_STRING","'logout_token'",310],"]",")",";",["T_WHITESPACE","\n\n      ",310],["T_COMMENT","\/\/ Try 3 failed logins for user 1, they will not trigger flood control.\n",312],["T_WHITESPACE","      ",313],["T_FOR","for",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$i",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_LNUMBER","0",313],";",["T_WHITESPACE"," ",313],["T_VARIABLE","$i",313],["T_WHITESPACE"," ",313],"<",["T_WHITESPACE"," ",313],["T_LNUMBER","3",313],";",["T_WHITESPACE"," ",313],["T_VARIABLE","$i",313],["T_INC","++",313],")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n        ",313],["T_VARIABLE","$response",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","loginRequest",314],"(",["T_VARIABLE","$incorrect_user1",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getUsername",314],"(",")",",",["T_WHITESPACE"," ",314],["T_VARIABLE","$incorrect_user1",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","passRaw",314],")",";",["T_WHITESPACE","\n        ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","assertHttpResponseWithMessage",315],"(",["T_VARIABLE","$response",315],",",["T_WHITESPACE"," ",315],["T_LNUMBER","400",315],",",["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","'Sorry, unrecognized username or password.'",315],")",";",["T_WHITESPACE","\n      ",315],"}",["T_WHITESPACE","\n\n      ",316],["T_COMMENT","\/\/ Try one successful attempt for user 2, it should not trigger any\n",318],["T_WHITESPACE","      ",319],["T_COMMENT","\/\/ flood control.\n",319],["T_WHITESPACE","      ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","drupalLogin",320],"(",["T_VARIABLE","$user2",320],")",";",["T_WHITESPACE","\n      ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","drupalLogout",321],"(",")",";",["T_WHITESPACE","\n\n      ",321],["T_COMMENT","\/\/ Try one more attempt for user 1, it should be rejected, even if the\n",323],["T_WHITESPACE","      ",324],["T_COMMENT","\/\/ correct password has been used.\n",324],["T_WHITESPACE","      ",325],["T_VARIABLE","$response",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","loginRequest",325],"(",["T_VARIABLE","$user1",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getUsername",325],"(",")",",",["T_WHITESPACE"," ",325],["T_VARIABLE","$user1",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","passRaw",325],")",";",["T_WHITESPACE","\n      ",325],["T_COMMENT","\/\/ Depending on the uid_only setting the error message will be different.\n",326],["T_WHITESPACE","      ",327],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$uid_only_setting",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n        ",327],["T_VARIABLE","$excepted_message",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'There have been more than 3 failed login attempts for this account. It is temporarily blocked. Try again later or request a new password.'",328],";",["T_WHITESPACE","\n      ",328],"}",["T_WHITESPACE","\n      ",329],["T_ELSE","else",330],["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n        ",330],["T_VARIABLE","$excepted_message",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'Too many failed login attempts from your IP address. This IP address is temporarily blocked.'",331],";",["T_WHITESPACE","\n      ",331],"}",["T_WHITESPACE","\n      ",332],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","assertHttpResponseWithMessage",333],"(",["T_VARIABLE","$response",333],",",["T_WHITESPACE"," ",333],["T_LNUMBER","403",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$excepted_message",333],")",";",["T_WHITESPACE","\n    ",333],"}",["T_WHITESPACE","\n\n  ",334],"}",["T_WHITESPACE","\n\n  ",336],["T_DOC_COMMENT","\/**\n   * Executes a logout HTTP request.\n   *\n   * @param string $format\n   *   The format to use to make the request.\n   * @param string $logout_token\n   *   The csrf token for user logout.\n   *\n   * @return \\Psr\\Http\\Message\\ResponseInterface The HTTP response.\n   *   The HTTP response.\n   *\/",338],["T_WHITESPACE","\n  ",348],["T_PROTECTED","protected",349],["T_WHITESPACE"," ",349],["T_FUNCTION","function",349],["T_WHITESPACE"," ",349],["T_STRING","logoutRequest",349],"(",["T_VARIABLE","$format",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'json'",349],",",["T_WHITESPACE"," ",349],["T_VARIABLE","$logout_token",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","''",349],")",["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n    ",349],["T_DOC_COMMENT","\/** @var \\GuzzleHttp\\Client $client *\/",350],["T_WHITESPACE","\n    ",350],["T_VARIABLE","$client",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","container",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","get",351],"(",["T_CONSTANT_ENCAPSED_STRING","'http_client'",351],")",";",["T_WHITESPACE","\n    ",351],["T_VARIABLE","$user_logout_url",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_STRING","Url",352],["T_DOUBLE_COLON","::",352],["T_STRING","fromRoute",352],"(",["T_CONSTANT_ENCAPSED_STRING","'user.logout.http'",352],")",["T_WHITESPACE","\n      ",352],["T_OBJECT_OPERATOR","->",353],["T_STRING","setRouteParameter",353],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$format",353],")",["T_WHITESPACE","\n      ",353],["T_OBJECT_OPERATOR","->",354],["T_STRING","setAbsolute",354],"(",")",";",["T_WHITESPACE","\n    ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_VARIABLE","$logout_token",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n      ",355],["T_VARIABLE","$user_logout_url",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","setOption",356],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",356],",",["T_WHITESPACE"," ",356],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_VARIABLE","$logout_token",356],"]",")",";",["T_WHITESPACE","\n    ",356],"}",["T_WHITESPACE","\n    ",357],["T_VARIABLE","$post_options",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],"[",["T_WHITESPACE","\n      ",358],["T_CONSTANT_ENCAPSED_STRING","'headers'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],"[",["T_WHITESPACE","\n        ",359],["T_CONSTANT_ENCAPSED_STRING","'Accept'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],"\"",["T_ENCAPSED_AND_WHITESPACE","application\/",360],["T_VARIABLE","$format",360],"\"",",",["T_WHITESPACE","\n      ",360],"]",",",["T_WHITESPACE","\n      ",361],["T_CONSTANT_ENCAPSED_STRING","'http_errors'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_STRING","FALSE",362],",",["T_WHITESPACE","\n      ",362],["T_CONSTANT_ENCAPSED_STRING","'cookies'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","cookies",363],",",["T_WHITESPACE","\n    ",363],"]",";",["T_WHITESPACE","\n\n    ",364],["T_VARIABLE","$response",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$client",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","post",366],"(",["T_VARIABLE","$user_logout_url",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","toString",366],"(",")",",",["T_WHITESPACE"," ",366],["T_VARIABLE","$post_options",366],")",";",["T_WHITESPACE","\n    ",366],["T_RETURN","return",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$response",367],";",["T_WHITESPACE","\n  ",367],"}",["T_WHITESPACE","\n\n  ",368],["T_DOC_COMMENT","\/**\n   * Test csrf protection of User Logout route.\n   *\/",370],["T_WHITESPACE","\n  ",372],["T_PUBLIC","public",373],["T_WHITESPACE"," ",373],["T_FUNCTION","function",373],["T_WHITESPACE"," ",373],["T_STRING","testLogoutCsrfProtection",373],"(",")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n    ",373],["T_VARIABLE","$client",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_NS_SEPARATOR","\\",374],["T_STRING","Drupal",374],["T_DOUBLE_COLON","::",374],["T_STRING","httpClient",374],"(",")",";",["T_WHITESPACE","\n    ",374],["T_VARIABLE","$login_status_url",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getLoginStatusUrlString",375],"(",")",";",["T_WHITESPACE","\n    ",375],["T_VARIABLE","$account",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","drupalCreateUser",376],"(",")",";",["T_WHITESPACE","\n    ",376],["T_VARIABLE","$name",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_VARIABLE","$account",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getUsername",377],"(",")",";",["T_WHITESPACE","\n    ",377],["T_VARIABLE","$pass",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$account",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","passRaw",378],";",["T_WHITESPACE","\n\n    ",378],["T_VARIABLE","$response",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","loginRequest",380],"(",["T_VARIABLE","$name",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$pass",380],")",";",["T_WHITESPACE","\n    ",380],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","assertEquals",381],"(",["T_LNUMBER","200",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$response",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getStatusCode",381],"(",")",")",";",["T_WHITESPACE","\n    ",381],["T_VARIABLE","$result_data",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","serializer",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","decode",382],"(",["T_VARIABLE","$response",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","getBody",382],"(",")",",",["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'json'",382],")",";",["T_WHITESPACE","\n\n    ",382],["T_VARIABLE","$logout_token",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$result_data",384],"[",["T_CONSTANT_ENCAPSED_STRING","'logout_token'",384],"]",";",["T_WHITESPACE","\n\n    ",384],["T_COMMENT","\/\/ Test third party site posting to current site with logout request.\n",386],["T_WHITESPACE","    ",387],["T_COMMENT","\/\/ This should not logout the current user because it lacks the CSRF\n",387],["T_WHITESPACE","    ",388],["T_COMMENT","\/\/ token.\n",388],["T_WHITESPACE","    ",389],["T_VARIABLE","$response",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","logoutRequest",389],"(",["T_CONSTANT_ENCAPSED_STRING","'json'",389],")",";",["T_WHITESPACE","\n    ",389],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","assertEquals",390],"(",["T_LNUMBER","403",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$response",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","getStatusCode",390],"(",")",")",";",["T_WHITESPACE","\n\n    ",390],["T_COMMENT","\/\/ Ensure still logged in.\n",392],["T_WHITESPACE","    ",393],["T_VARIABLE","$response",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_VARIABLE","$client",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","get",393],"(",["T_VARIABLE","$login_status_url",393],",",["T_WHITESPACE"," ",393],"[",["T_CONSTANT_ENCAPSED_STRING","'cookies'",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","cookies",393],"]",")",";",["T_WHITESPACE","\n    ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","assertHttpResponse",394],"(",["T_VARIABLE","$response",394],",",["T_WHITESPACE"," ",394],["T_LNUMBER","200",394],",",["T_WHITESPACE"," ",394],["T_STRING","UserAuthenticationController",394],["T_DOUBLE_COLON","::",394],["T_STRING","LOGGED_IN",394],")",";",["T_WHITESPACE","\n\n    ",394],["T_COMMENT","\/\/ Try with an incorrect token.\n",396],["T_WHITESPACE","    ",397],["T_VARIABLE","$response",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","logoutRequest",397],"(",["T_CONSTANT_ENCAPSED_STRING","'json'",397],",",["T_WHITESPACE"," ",397],["T_CONSTANT_ENCAPSED_STRING","'not-the-correct-token'",397],")",";",["T_WHITESPACE","\n    ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","assertEquals",398],"(",["T_LNUMBER","403",398],",",["T_WHITESPACE"," ",398],["T_VARIABLE","$response",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getStatusCode",398],"(",")",")",";",["T_WHITESPACE","\n\n    ",398],["T_COMMENT","\/\/ Ensure still logged in.\n",400],["T_WHITESPACE","    ",401],["T_VARIABLE","$response",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_VARIABLE","$client",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","get",401],"(",["T_VARIABLE","$login_status_url",401],",",["T_WHITESPACE"," ",401],"[",["T_CONSTANT_ENCAPSED_STRING","'cookies'",401],["T_WHITESPACE"," ",401],["T_DOUBLE_ARROW","=>",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","cookies",401],"]",")",";",["T_WHITESPACE","\n    ",401],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","assertHttpResponse",402],"(",["T_VARIABLE","$response",402],",",["T_WHITESPACE"," ",402],["T_LNUMBER","200",402],",",["T_WHITESPACE"," ",402],["T_STRING","UserAuthenticationController",402],["T_DOUBLE_COLON","::",402],["T_STRING","LOGGED_IN",402],")",";",["T_WHITESPACE","\n\n    ",402],["T_COMMENT","\/\/ Try a logout request with correct token.\n",404],["T_WHITESPACE","    ",405],["T_VARIABLE","$response",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","logoutRequest",405],"(",["T_CONSTANT_ENCAPSED_STRING","'json'",405],",",["T_WHITESPACE"," ",405],["T_VARIABLE","$logout_token",405],")",";",["T_WHITESPACE","\n    ",405],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","assertEquals",406],"(",["T_LNUMBER","204",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$response",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getStatusCode",406],"(",")",")",";",["T_WHITESPACE","\n\n    ",406],["T_COMMENT","\/\/ Ensure actually logged out.\n",408],["T_WHITESPACE","    ",409],["T_VARIABLE","$response",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$client",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","get",409],"(",["T_VARIABLE","$login_status_url",409],",",["T_WHITESPACE"," ",409],"[",["T_CONSTANT_ENCAPSED_STRING","'cookies'",409],["T_WHITESPACE"," ",409],["T_DOUBLE_ARROW","=>",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","cookies",409],"]",")",";",["T_WHITESPACE","\n    ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","assertHttpResponse",410],"(",["T_VARIABLE","$response",410],",",["T_WHITESPACE"," ",410],["T_LNUMBER","200",410],",",["T_WHITESPACE"," ",410],["T_STRING","UserAuthenticationController",410],["T_DOUBLE_COLON","::",410],["T_STRING","LOGGED_OUT",410],")",";",["T_WHITESPACE","\n  ",410],"}",["T_WHITESPACE","\n\n  ",411],["T_DOC_COMMENT","\/**\n   * Gets the URL string for checking login.\n   *\n   * @param string $format\n   *   The format to use to make the request.\n   *\n   * @return string\n   *   The URL string.\n   *\/",413],["T_WHITESPACE","\n  ",421],["T_PROTECTED","protected",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","getLoginStatusUrlString",422],"(",["T_VARIABLE","$format",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_CONSTANT_ENCAPSED_STRING","'json'",422],")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n    ",422],["T_VARIABLE","$user_login_status_url",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_STRING","Url",423],["T_DOUBLE_COLON","::",423],["T_STRING","fromRoute",423],"(",["T_CONSTANT_ENCAPSED_STRING","'user.login_status.http'",423],")",";",["T_WHITESPACE","\n    ",423],["T_VARIABLE","$user_login_status_url",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","setRouteParameter",424],"(",["T_CONSTANT_ENCAPSED_STRING","'_format'",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$format",424],")",";",["T_WHITESPACE","\n    ",424],["T_VARIABLE","$user_login_status_url",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","setAbsolute",425],"(",")",";",["T_WHITESPACE","\n    ",425],["T_RETURN","return",426],["T_WHITESPACE"," ",426],["T_VARIABLE","$user_login_status_url",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","toString",426],"(",")",";",["T_WHITESPACE","\n  ",426],"}",["T_WHITESPACE","\n\n",427],"}",["T_WHITESPACE","\n",429]]