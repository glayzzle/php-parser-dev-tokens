[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Shell",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Cache",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Cache",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Console",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Shell",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Datasource",19],["T_NS_SEPARATOR","\\",19],["T_STRING","ConnectionManager",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * ORM Cache Shell.\n *\n * Provides a CLI interface to the ORM metadata caching features.\n * This tool is intended to be used by deployment scripts so that you\n * can prevent thundering herd effects on the metadata cache when new\n * versions of your application are deployed, or when migrations\n * requiring updated metadata are required.\n *\/",21],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","OrmCacheShell",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Shell",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Build metadata.\n     *\n     * @param string|null $name The name of the table to build cache data for.\n     * @return bool\n     *\/",33],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","build",39],"(",["T_VARIABLE","$name",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","null",39],")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$schema",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","_getSchema",41],"(",")",";",["T_WHITESPACE","\n        ",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(","!",["T_VARIABLE","$schema",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n            ",42],["T_RETURN","return",43],["T_WHITESPACE"," ",43],["T_STRING","false",43],";",["T_WHITESPACE","\n        ",43],"}",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$tables",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],"[",["T_VARIABLE","$name",45],"]",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_EMPTY","empty",46],"(",["T_VARIABLE","$name",46],")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$tables",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$schema",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","listTables",47],"(",")",";",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n        ",48],["T_FOREACH","foreach",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$tables",49],["T_WHITESPACE"," ",49],["T_AS","as",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$table",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n            ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_io",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","verbose",50],"(",["T_CONSTANT_ENCAPSED_STRING","'Building metadata cache for '",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$table",50],")",";",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$schema",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","describe",51],"(",["T_VARIABLE","$table",51],",",["T_WHITESPACE"," ",51],"[",["T_CONSTANT_ENCAPSED_STRING","'forceRefresh'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_STRING","true",51],"]",")",";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","out",53],"(",["T_CONSTANT_ENCAPSED_STRING","'<success>Cache build complete<\/success>'",53],")",";",["T_WHITESPACE","\n\n        ",53],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_STRING","true",55],";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Clear metadata.\n     *\n     * @param string|null $name The name of the table to clear cache data for.\n     * @return bool\n     *\/",58],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","clear",64],"(",["T_VARIABLE","$name",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","null",64],")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$schema",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_getSchema",66],"(",")",";",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_VARIABLE","$schema",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_STRING","false",68],";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$tables",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],"[",["T_VARIABLE","$name",70],"]",";",["T_WHITESPACE","\n        ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(",["T_EMPTY","empty",71],"(",["T_VARIABLE","$name",71],")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$tables",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$schema",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","listTables",72],"(",")",";",["T_WHITESPACE","\n        ",72],"}",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$configName",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$schema",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","cacheMetadata",74],"(",")",";",["T_WHITESPACE","\n\n        ",74],["T_FOREACH","foreach",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$tables",76],["T_WHITESPACE"," ",76],["T_AS","as",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$table",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_io",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","verbose",77],"(",["T_STRING","sprintf",77],"(",["T_WHITESPACE","\n                ",77],["T_CONSTANT_ENCAPSED_STRING","'Clearing metadata cache from \"%s\" for %s'",78],",",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$configName",79],",",["T_WHITESPACE","\n                ",79],["T_VARIABLE","$table",80],["T_WHITESPACE","\n            ",80],")",")",";",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$key",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$schema",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","cacheKey",82],"(",["T_VARIABLE","$table",82],")",";",["T_WHITESPACE","\n            ",82],["T_STRING","Cache",83],["T_DOUBLE_COLON","::",83],["T_STRING","delete",83],"(",["T_VARIABLE","$key",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$configName",83],")",";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","out",85],"(",["T_CONSTANT_ENCAPSED_STRING","'<success>Cache clear complete<\/success>'",85],")",";",["T_WHITESPACE","\n\n        ",85],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","true",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Helper method to get the schema collection.\n     *\n     * @return false|\\Cake\\Database\\Schema\\Collection\n     *\/",90],["T_WHITESPACE","\n    ",94],["T_PROTECTED","protected",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","_getSchema",95],"(",")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$source",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","ConnectionManager",97],["T_DOUBLE_COLON","::",97],["T_STRING","get",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","params",97],"[",["T_CONSTANT_ENCAPSED_STRING","'connection'",97],"]",")",";",["T_WHITESPACE","\n        ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_STRING","method_exists",98],"(",["T_VARIABLE","$source",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'schemaCollection'",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$msg",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","sprintf",99],"(",["T_WHITESPACE","\n                ",99],["T_CONSTANT_ENCAPSED_STRING","'The \"%s\" connection is not compatible with orm caching, '",100],["T_WHITESPACE"," ",100],".",["T_WHITESPACE","\n                ",100],["T_CONSTANT_ENCAPSED_STRING","'as it does not implement a \"schemaCollection()\" method.'",101],",",["T_WHITESPACE","\n                ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","params",102],"[",["T_CONSTANT_ENCAPSED_STRING","'connection'",102],"]",["T_WHITESPACE","\n            ",102],")",";",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","error",104],"(",["T_VARIABLE","$msg",104],")",";",["T_WHITESPACE","\n\n            ",104],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_STRING","false",106],";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$config",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$source",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","config",108],"(",")",";",["T_WHITESPACE","\n        ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_EMPTY","empty",109],"(",["T_VARIABLE","$config",109],"[",["T_CONSTANT_ENCAPSED_STRING","'cacheMetadata'",109],"]",")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_io",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","verbose",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Metadata cache was disabled in config. Enabling to clear cache.'",110],")",";",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$source",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","cacheMetadata",111],"(",["T_STRING","true",111],")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$source",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","schemaCollection",114],"(",")",";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Get the option parser for this shell.\n     *\n     * @return \\Cake\\Console\\ConsoleOptionParser\n     *\/",117],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","getOptionParser",122],"(",")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$parser",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","parent",124],["T_DOUBLE_COLON","::",124],["T_STRING","getOptionParser",124],"(",")",";",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$parser",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","addSubcommand",125],"(",["T_CONSTANT_ENCAPSED_STRING","'clear'",125],",",["T_WHITESPACE"," ",125],"[",["T_WHITESPACE","\n            ",125],["T_CONSTANT_ENCAPSED_STRING","'help'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'Clear all metadata caches for the connection. If a '",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE","\n                ",126],["T_CONSTANT_ENCAPSED_STRING","'table name is provided, only that table will be removed.'",127],",",["T_WHITESPACE","\n        ",127],"]",")",["T_OBJECT_OPERATOR","->",128],["T_STRING","addSubcommand",128],"(",["T_CONSTANT_ENCAPSED_STRING","'build'",128],",",["T_WHITESPACE"," ",128],"[",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","'help'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'Build all metadata caches for the connection. If a '",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE","\n            ",129],["T_CONSTANT_ENCAPSED_STRING","'table name is provided, only that table will be cached.'",130],",",["T_WHITESPACE","\n        ",130],"]",")",["T_OBJECT_OPERATOR","->",131],["T_STRING","addOption",131],"(",["T_CONSTANT_ENCAPSED_STRING","'connection'",131],",",["T_WHITESPACE"," ",131],"[",["T_WHITESPACE","\n            ",131],["T_CONSTANT_ENCAPSED_STRING","'help'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'The connection to build\/clear metadata cache data for.'",132],",",["T_WHITESPACE","\n            ",132],["T_CONSTANT_ENCAPSED_STRING","'short'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'c'",133],",",["T_WHITESPACE","\n            ",133],["T_CONSTANT_ENCAPSED_STRING","'default'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'default'",134],",",["T_WHITESPACE","\n        ",134],"]",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","addArgument",135],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",135],",",["T_WHITESPACE"," ",135],"[",["T_WHITESPACE","\n            ",135],["T_CONSTANT_ENCAPSED_STRING","'help'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'A specific table you want to clear\/refresh cached data for.'",136],",",["T_WHITESPACE","\n            ",136],["T_CONSTANT_ENCAPSED_STRING","'optional'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_STRING","true",137],",",["T_WHITESPACE","\n        ",137],"]",")",";",["T_WHITESPACE","\n\n        ",138],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$parser",140],";",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n",141],"}",["T_WHITESPACE","\n",142]]