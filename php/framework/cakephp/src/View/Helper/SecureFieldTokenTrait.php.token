[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.1.2\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","View",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Helper",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Utility",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Security",17],";",["T_WHITESPACE","\n\n",17],["T_DOC_COMMENT","\/**\n * Provides methods for building token data that is\n * compatible with SecurityComponent.\n *\/",19],["T_WHITESPACE","\n",22],["T_TRAIT","trait",23],["T_WHITESPACE"," ",23],["T_STRING","SecureFieldTokenTrait",23],["T_WHITESPACE","\n",23],"{",["T_WHITESPACE","\n    ",24],["T_DOC_COMMENT","\/**\n     * Generate the token data for the provided inputs.\n     *\n     * @param string $url The URL the form is being submitted to.\n     * @param array $fields If set specifies the list of fields to use when\n     *    generating the hash.\n     * @param array $unlockedFields The list of fields that are excluded from\n     *    field validation.\n     * @return array The token data.\n     *\/",25],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","_buildFieldToken",35],"(",["T_VARIABLE","$url",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$fields",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$unlockedFields",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],"[","]",")",["T_WHITESPACE","\n    ",35],"{",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$locked",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],"[","]",";",["T_WHITESPACE","\n        ",37],["T_FOREACH","foreach",38],["T_WHITESPACE"," ",38],"(",["T_VARIABLE","$fields",38],["T_WHITESPACE"," ",38],["T_AS","as",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$key",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$value",38],")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n            ",38],["T_IF","if",39],["T_WHITESPACE"," ",39],"(",["T_STRING","is_numeric",39],"(",["T_VARIABLE","$value",39],")",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n                ",39],["T_VARIABLE","$value",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING_CAST","(string)",40],["T_VARIABLE","$value",40],";",["T_WHITESPACE","\n            ",40],"}",["T_WHITESPACE","\n            ",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(","!",["T_STRING","is_int",42],"(",["T_VARIABLE","$key",42],")",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n                ",42],["T_VARIABLE","$locked",43],"[",["T_VARIABLE","$key",43],"]",["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$value",43],";",["T_WHITESPACE","\n                ",43],["T_UNSET","unset",44],"(",["T_VARIABLE","$fields",44],"[",["T_VARIABLE","$key",44],"]",")",";",["T_WHITESPACE","\n            ",44],"}",["T_WHITESPACE","\n        ",45],"}",["T_WHITESPACE","\n\n        ",46],["T_STRING","sort",48],"(",["T_VARIABLE","$unlockedFields",48],",",["T_WHITESPACE"," ",48],["T_STRING","SORT_STRING",48],")",";",["T_WHITESPACE","\n        ",48],["T_STRING","sort",49],"(",["T_VARIABLE","$fields",49],",",["T_WHITESPACE"," ",49],["T_STRING","SORT_STRING",49],")",";",["T_WHITESPACE","\n        ",49],["T_STRING","ksort",50],"(",["T_VARIABLE","$locked",50],",",["T_WHITESPACE"," ",50],["T_STRING","SORT_STRING",50],")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$fields",51],["T_WHITESPACE"," ",51],["T_PLUS_EQUAL","+=",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$locked",51],";",["T_WHITESPACE","\n\n        ",51],["T_VARIABLE","$locked",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","implode",53],"(",["T_STRING","array_keys",53],"(",["T_VARIABLE","$locked",53],")",",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'|'",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$unlocked",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","implode",54],"(",["T_VARIABLE","$unlockedFields",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'|'",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$hashParts",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$url",56],",",["T_WHITESPACE","\n            ",56],["T_STRING","serialize",57],"(",["T_VARIABLE","$fields",57],")",",",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$unlocked",58],",",["T_WHITESPACE","\n            ",58],["T_STRING","Security",59],["T_DOUBLE_COLON","::",59],["T_STRING","salt",59],"(",")",["T_WHITESPACE","\n        ",59],"]",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$fields",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","Security",61],["T_DOUBLE_COLON","::",61],["T_STRING","hash",61],"(",["T_STRING","implode",61],"(",["T_CONSTANT_ENCAPSED_STRING","''",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$hashParts",61],")",",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'sha1'",61],")",";",["T_WHITESPACE","\n\n        ",61],["T_RETURN","return",63],["T_WHITESPACE"," ",63],"[",["T_WHITESPACE","\n            ",63],["T_CONSTANT_ENCAPSED_STRING","'fields'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","urlencode",64],"(",["T_VARIABLE","$fields",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","':'",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_VARIABLE","$locked",64],")",",",["T_WHITESPACE","\n            ",64],["T_CONSTANT_ENCAPSED_STRING","'unlocked'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_STRING","urlencode",65],"(",["T_VARIABLE","$unlocked",65],")",",",["T_WHITESPACE","\n        ",65],"]",";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n",67],"}",["T_WHITESPACE","\n",68]]