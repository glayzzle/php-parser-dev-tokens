[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Utility",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Crypto",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Mcrypt implementation of crypto features for Cake\\Utility\\Security\n *\n * This class is not intended to be used directly and should only\n * be used in the context of Cake\\Utility\\Security.\n *\n * @deprecated 3.3.0 It is recommended to use {@see Cake\\Utility\\Crypto\\OpenSsl} instead.\n * @internal\n *\/",17],["T_WHITESPACE","\n",25],["T_CLASS","class",26],["T_WHITESPACE"," ",26],["T_STRING","Mcrypt",26],["T_WHITESPACE","\n",26],"{",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * Encrypts\/Decrypts a text using the given key using rijndael method.\n     *\n     * @param string $text Encrypted string to decrypt, normal string to encrypt\n     * @param string $key Key to use as the encryption key for encrypted data.\n     * @param string $operation Operation to perform, encrypt or decrypt\n     * @throws \\LogicException When there are errors.\n     * @return string Encrytped binary string data, or decrypted data depending on operation.\n     *\/",29],["T_WHITESPACE","\n    ",37],["T_PUBLIC","public",38],["T_WHITESPACE"," ",38],["T_STATIC","static",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","rijndael",38],"(",["T_VARIABLE","$text",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$key",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$operation",38],")",["T_WHITESPACE","\n    ",38],"{",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$algorithm",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING","MCRYPT_RIJNDAEL_256",40],";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$mode",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","MCRYPT_MODE_CBC",41],";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$ivSize",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","mcrypt_get_iv_size",42],"(",["T_VARIABLE","$algorithm",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$mode",42],")",";",["T_WHITESPACE","\n\n        ",42],["T_VARIABLE","$cryptKey",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","mb_substr",44],"(",["T_VARIABLE","$key",44],",",["T_WHITESPACE"," ",44],["T_LNUMBER","0",44],",",["T_WHITESPACE"," ",44],["T_LNUMBER","32",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'8bit'",44],")",";",["T_WHITESPACE","\n\n        ",44],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$operation",46],["T_WHITESPACE"," ",46],["T_IS_IDENTICAL","===",46],["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'encrypt'",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$iv",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","mcrypt_create_iv",47],"(",["T_VARIABLE","$ivSize",47],",",["T_WHITESPACE"," ",47],["T_STRING","MCRYPT_DEV_URANDOM",47],")",";",["T_WHITESPACE","\n\n            ",47],["T_RETURN","return",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$iv",49],["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'$$'",49],["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_STRING","mcrypt_encrypt",49],"(",["T_VARIABLE","$algorithm",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$cryptKey",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$text",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$mode",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$iv",49],")",";",["T_WHITESPACE","\n        ",49],"}",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$iv",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","mb_substr",51],"(",["T_VARIABLE","$text",51],",",["T_WHITESPACE"," ",51],["T_LNUMBER","0",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$ivSize",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'8bit'",51],")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$text",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","mb_substr",52],"(",["T_VARIABLE","$text",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$ivSize",52],["T_WHITESPACE"," ",52],"+",["T_WHITESPACE"," ",52],["T_LNUMBER","2",52],",",["T_WHITESPACE"," ",52],["T_STRING","null",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'8bit'",52],")",";",["T_WHITESPACE","\n\n        ",52],["T_RETURN","return",54],["T_WHITESPACE"," ",54],["T_STRING","rtrim",54],"(",["T_STRING","mcrypt_decrypt",54],"(",["T_VARIABLE","$algorithm",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$cryptKey",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$text",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$mode",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$iv",54],")",",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",54],")",";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Encrypt a value using AES-256.\n     *\n     * *Caveat* You cannot properly encrypt\/decrypt data with trailing null bytes.\n     * Any trailing null bytes will be removed on decryption due to how PHP pads messages\n     * with nulls prior to encryption.\n     *\n     * @param string $plain The value to encrypt.\n     * @param string $key The 256 bit\/32 byte key to use as a cipher key.\n     * @return string Encrypted data.\n     * @throws \\InvalidArgumentException On invalid data or key.\n     *\/",57],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_STATIC","static",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","encrypt",69],"(",["T_VARIABLE","$plain",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$key",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$algorithm",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","MCRYPT_RIJNDAEL_128",71],";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$mode",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","MCRYPT_MODE_CBC",72],";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$ivSize",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","mcrypt_get_iv_size",74],"(",["T_VARIABLE","$algorithm",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$mode",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$iv",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","mcrypt_create_iv",75],"(",["T_VARIABLE","$ivSize",75],",",["T_WHITESPACE"," ",75],["T_STRING","MCRYPT_DEV_URANDOM",75],")",";",["T_WHITESPACE","\n\n        ",75],["T_COMMENT","\/\/ Pad out plain to make it AES compatible.\n",77],["T_WHITESPACE","        ",78],["T_VARIABLE","$pad",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$ivSize",78],["T_WHITESPACE"," ",78],"-",["T_WHITESPACE"," ",78],"(",["T_STRING","mb_strlen",78],"(",["T_VARIABLE","$plain",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'8bit'",78],")",["T_WHITESPACE"," ",78],"%",["T_WHITESPACE"," ",78],["T_VARIABLE","$ivSize",78],")",")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$plain",79],["T_WHITESPACE"," ",79],["T_CONCAT_EQUAL",".=",79],["T_WHITESPACE"," ",79],["T_STRING","str_repeat",79],"(",["T_STRING","chr",79],"(",["T_VARIABLE","$pad",79],")",",",["T_WHITESPACE"," ",79],["T_VARIABLE","$pad",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$iv",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_STRING","mcrypt_encrypt",81],"(",["T_VARIABLE","$algorithm",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$key",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$plain",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$mode",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$iv",81],")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Decrypt a value using AES-256.\n     *\n     * @param string $cipher The ciphertext to decrypt.\n     * @param string $key The 256 bit\/32 byte key to use as a cipher key.\n     * @return string Decrypted data. Any trailing null bytes will be removed.\n     * @throws \\InvalidArgumentException On invalid data or key.\n     *\/",84],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_STATIC","static",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","decrypt",92],"(",["T_VARIABLE","$cipher",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$key",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$algorithm",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","MCRYPT_RIJNDAEL_128",94],";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$mode",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","MCRYPT_MODE_CBC",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$ivSize",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","mcrypt_get_iv_size",96],"(",["T_VARIABLE","$algorithm",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$mode",96],")",";",["T_WHITESPACE","\n\n        ",96],["T_VARIABLE","$iv",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","mb_substr",98],"(",["T_VARIABLE","$cipher",98],",",["T_WHITESPACE"," ",98],["T_LNUMBER","0",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$ivSize",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'8bit'",98],")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$cipher",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","mb_substr",99],"(",["T_VARIABLE","$cipher",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$ivSize",99],",",["T_WHITESPACE"," ",99],["T_STRING","null",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'8bit'",99],")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$plain",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","mcrypt_decrypt",100],"(",["T_VARIABLE","$algorithm",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$key",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$cipher",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$mode",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$iv",100],")",";",["T_WHITESPACE","\n\n        ",100],["T_COMMENT","\/\/ Remove PKCS#7 padding or Null bytes\n",102],["T_WHITESPACE","        ",103],["T_COMMENT","\/\/ Newer values will be PKCS#7 padded, while old\n",103],["T_WHITESPACE","        ",104],["T_COMMENT","\/\/ mcrypt values will be null byte padded.\n",104],["T_WHITESPACE","        ",105],["T_VARIABLE","$padChar",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","mb_substr",105],"(",["T_VARIABLE","$plain",105],",",["T_WHITESPACE"," ",105],"-",["T_LNUMBER","1",105],",",["T_WHITESPACE"," ",105],["T_STRING","null",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'8bit'",105],")",";",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$padChar",106],["T_WHITESPACE"," ",106],["T_IS_IDENTICAL","===",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_STRING","trim",107],"(",["T_VARIABLE","$plain",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$padLen",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","ord",109],"(",["T_VARIABLE","$padChar",109],")",";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$result",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","mb_substr",110],"(",["T_VARIABLE","$plain",110],",",["T_WHITESPACE"," ",110],["T_LNUMBER","0",110],",",["T_WHITESPACE"," ",110],"-",["T_VARIABLE","$padLen",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'8bit'",110],")",";",["T_WHITESPACE","\n\n        ",110],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$result",112],["T_WHITESPACE"," ",112],["T_IS_IDENTICAL","===",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","''",112],["T_WHITESPACE"," ",112],"?",["T_WHITESPACE"," ",112],["T_STRING","false",112],["T_WHITESPACE"," ",112],":",["T_WHITESPACE"," ",112],["T_VARIABLE","$result",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n",113],"}",["T_WHITESPACE","\n",114]]