[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Utility",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Crypto",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","LogicException",17],";",["T_WHITESPACE","\n\n",17],["T_DOC_COMMENT","\/**\n * OpenSSL implementation of crypto features for Cake\\Utility\\Security\n *\n * OpenSSL should be favored over mcrypt as it is actively maintained and\n * more widely available.\n *\n * This class is not intended to be used directly and should only\n * be used in the context of Cake\\Utility\\Security.\n *\n * @internal\n *\/",19],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","OpenSsl",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Not implemented\n     *\n     * @param string $text Encrypted string to decrypt, normal string to encrypt\n     * @param string $key Key to use as the encryption key for encrypted data.\n     * @param string $operation Operation to perform, encrypt or decrypt\n     * @throws \\LogicException Rijndael compatibility does not exist with Openssl.\n     * @return void\n     *\/",33],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_STATIC","static",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","rijndael",42],"(",["T_VARIABLE","$text",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$key",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$operation",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_THROW","throw",44],["T_WHITESPACE"," ",44],["T_NEW","new",44],["T_WHITESPACE"," ",44],["T_STRING","LogicException",44],"(",["T_CONSTANT_ENCAPSED_STRING","'rijndael is not compatible with OpenSSL. Use mcrypt instead.'",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Encrypt a value using AES-256.\n     *\n     * *Caveat* You cannot properly encrypt\/decrypt data with trailing null bytes.\n     * Any trailing null bytes will be removed on decryption due to how PHP pads messages\n     * with nulls prior to encryption.\n     *\n     * @param string $plain The value to encrypt.\n     * @param string $key The 256 bit\/32 byte key to use as a cipher key.\n     * @param string|null $hmacSalt The salt to use for the HMAC process. Leave null to use Security.salt.\n     * @return string Encrypted data.\n     * @throws \\InvalidArgumentException On invalid data or key.\n     *\/",47],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_STATIC","static",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","encrypt",60],"(",["T_VARIABLE","$plain",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$key",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$hmacSalt",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","null",60],")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$method",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'AES-256-CBC'",62],";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$ivSize",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","openssl_cipher_iv_length",63],"(",["T_VARIABLE","$method",63],")",";",["T_WHITESPACE","\n\n        ",63],["T_VARIABLE","$iv",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","openssl_random_pseudo_bytes",65],"(",["T_VARIABLE","$ivSize",65],")",";",["T_WHITESPACE","\n\n        ",65],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$iv",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_STRING","openssl_encrypt",67],"(",["T_VARIABLE","$plain",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$method",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$key",67],",",["T_WHITESPACE"," ",67],["T_STRING","OPENSSL_RAW_DATA",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$iv",67],")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Decrypt a value using AES-256.\n     *\n     * @param string $cipher The ciphertext to decrypt.\n     * @param string $key The 256 bit\/32 byte key to use as a cipher key.\n     * @return string Decrypted data. Any trailing null bytes will be removed.\n     * @throws \\InvalidArgumentException On invalid data or key.\n     *\/",70],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_STATIC","static",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","decrypt",78],"(",["T_VARIABLE","$cipher",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$key",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$method",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'AES-256-CBC'",80],";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$ivSize",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","openssl_cipher_iv_length",81],"(",["T_VARIABLE","$method",81],")",";",["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$iv",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","mb_substr",83],"(",["T_VARIABLE","$cipher",83],",",["T_WHITESPACE"," ",83],["T_LNUMBER","0",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$ivSize",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'8bit'",83],")",";",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$cipher",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","mb_substr",85],"(",["T_VARIABLE","$cipher",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$ivSize",85],",",["T_WHITESPACE"," ",85],["T_STRING","null",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'8bit'",85],")",";",["T_WHITESPACE","\n\n        ",85],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","openssl_decrypt",87],"(",["T_VARIABLE","$cipher",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$method",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$key",87],",",["T_WHITESPACE"," ",87],["T_STRING","OPENSSL_RAW_DATA",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$iv",87],")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n",88],"}",["T_WHITESPACE","\n",89]]