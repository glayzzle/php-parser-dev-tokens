[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ORM",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Behavior",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Database",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Expression",17],["T_NS_SEPARATOR","\\",17],["T_STRING","IdentifierExpression",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Datasource",18],["T_NS_SEPARATOR","\\",18],["T_STRING","EntityInterface",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Datasource",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Exception",19],["T_NS_SEPARATOR","\\",19],["T_STRING","RecordNotFoundException",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Event",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Event",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","ORM",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Behavior",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","ORM",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Query",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","InvalidArgumentException",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","RuntimeException",24],";",["T_WHITESPACE","\n\n",24],["T_DOC_COMMENT","\/**\n * Makes the table to which this is attached to behave like a nested set and\n * provides methods for managing and retrieving information out of the derived\n * hierarchical structure.\n *\n * Tables attaching this behavior are required to have a column referencing the\n * parent row, and two other numeric columns (lft and rght) where the implicit\n * order will be cached.\n *\n * For more information on what is a nested set and a how it works refer to\n * http:\/\/www.sitepoint.com\/hierarchical-data-database-2\/\n *\/",26],["T_WHITESPACE","\n",37],["T_CLASS","class",38],["T_WHITESPACE"," ",38],["T_STRING","TreeBehavior",38],["T_WHITESPACE"," ",38],["T_EXTENDS","extends",38],["T_WHITESPACE"," ",38],["T_STRING","Behavior",38],["T_WHITESPACE","\n",38],"{",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Cached copy of the first column in a table's primary key.\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_primaryKey",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Default config\n     *\n     * These are merged with user-provided configuration when the behavior is used.\n     *\n     * @var array\n     *\/",48],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_defaultConfig",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[",["T_WHITESPACE","\n        ",55],["T_CONSTANT_ENCAPSED_STRING","'implementedFinders'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],"[",["T_WHITESPACE","\n            ",56],["T_CONSTANT_ENCAPSED_STRING","'path'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'findPath'",57],",",["T_WHITESPACE","\n            ",57],["T_CONSTANT_ENCAPSED_STRING","'children'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'findChildren'",58],",",["T_WHITESPACE","\n            ",58],["T_CONSTANT_ENCAPSED_STRING","'treeList'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'findTreeList'",59],",",["T_WHITESPACE","\n        ",59],"]",",",["T_WHITESPACE","\n        ",60],["T_CONSTANT_ENCAPSED_STRING","'implementedMethods'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],"[",["T_WHITESPACE","\n            ",61],["T_CONSTANT_ENCAPSED_STRING","'childCount'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'childCount'",62],",",["T_WHITESPACE","\n            ",62],["T_CONSTANT_ENCAPSED_STRING","'moveUp'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'moveUp'",63],",",["T_WHITESPACE","\n            ",63],["T_CONSTANT_ENCAPSED_STRING","'moveDown'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'moveDown'",64],",",["T_WHITESPACE","\n            ",64],["T_CONSTANT_ENCAPSED_STRING","'recover'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'recover'",65],",",["T_WHITESPACE","\n            ",65],["T_CONSTANT_ENCAPSED_STRING","'removeFromTree'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'removeFromTree'",66],",",["T_WHITESPACE","\n            ",66],["T_CONSTANT_ENCAPSED_STRING","'getLevel'",67],["T_WHITESPACE"," ",67],["T_DOUBLE_ARROW","=>",67],["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'getLevel'",67],",",["T_WHITESPACE","\n            ",67],["T_CONSTANT_ENCAPSED_STRING","'formatTreeList'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'formatTreeList'",68],",",["T_WHITESPACE","\n        ",68],"]",",",["T_WHITESPACE","\n        ",69],["T_CONSTANT_ENCAPSED_STRING","'parent'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",70],",",["T_WHITESPACE","\n        ",70],["T_CONSTANT_ENCAPSED_STRING","'left'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'lft'",71],",",["T_WHITESPACE","\n        ",71],["T_CONSTANT_ENCAPSED_STRING","'right'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'rght'",72],",",["T_WHITESPACE","\n        ",72],["T_CONSTANT_ENCAPSED_STRING","'scope'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_STRING","null",73],",",["T_WHITESPACE","\n        ",73],["T_CONSTANT_ENCAPSED_STRING","'level'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_STRING","null",74],",",["T_WHITESPACE","\n        ",74],["T_CONSTANT_ENCAPSED_STRING","'recoverOrder'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_STRING","null",75],",",["T_WHITESPACE","\n    ",75],"]",";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * {@inheritDoc}\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","initialize",81],"(",["T_ARRAY","array",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$config",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_config",83],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",83],"]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_NEW","new",83],["T_WHITESPACE"," ",83],["T_STRING","IdentifierExpression",83],"(",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_config",83],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",83],"]",")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_config",84],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",84],"]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","IdentifierExpression",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_config",84],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",84],"]",")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Before save listener.\n     * Transparently manages setting the lft and rght fields if the parent field is\n     * included in the parameters to be saved.\n     *\n     * @param \\Cake\\Event\\Event $event The beforeSave event that was fired\n     * @param \\Cake\\Datasource\\EntityInterface $entity the entity that is going to be saved\n     * @return void\n     * @throws \\RuntimeException if the parent to set for the node is invalid\n     *\/",87],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","beforeSave",97],"(",["T_STRING","Event",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$event",97],",",["T_WHITESPACE"," ",97],["T_STRING","EntityInterface",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$entity",97],")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$isNew",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$entity",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","isNew",99],"(",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$config",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","config",100],"(",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$parent",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$entity",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","get",101],"(",["T_VARIABLE","$config",101],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",101],"]",")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$primaryKey",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_getPrimaryKey",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$dirty",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$entity",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","dirty",103],"(",["T_VARIABLE","$config",103],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",103],"]",")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$level",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$config",104],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",104],"]",";",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$parent",106],["T_WHITESPACE"," ",106],["T_BOOLEAN_AND","&&",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$entity",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","get",106],"(",["T_VARIABLE","$primaryKey",106],")",["T_WHITESPACE"," ",106],["T_IS_EQUAL","==",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$parent",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_THROW","throw",107],["T_WHITESPACE"," ",107],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","RuntimeException",107],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot set a node's parent as itself\"",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_VARIABLE","$isNew",110],["T_WHITESPACE"," ",110],["T_BOOLEAN_AND","&&",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$parent",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$parentNode",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_getNode",111],"(",["T_VARIABLE","$parent",111],")",";",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$edge",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$parentNode",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","get",112],"(",["T_VARIABLE","$config",112],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",112],"]",")",";",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$entity",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","set",113],"(",["T_VARIABLE","$config",113],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",113],"]",",",["T_WHITESPACE"," ",113],["T_VARIABLE","$edge",113],")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$entity",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","set",114],"(",["T_VARIABLE","$config",114],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",114],"]",",",["T_WHITESPACE"," ",114],["T_VARIABLE","$edge",114],["T_WHITESPACE"," ",114],"+",["T_WHITESPACE"," ",114],["T_LNUMBER","1",114],")",";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_sync",115],"(",["T_LNUMBER","2",115],",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'+'",115],",",["T_WHITESPACE"," ",115],"\"",["T_ENCAPSED_AND_WHITESPACE",">= ",115],["T_CURLY_OPEN","{",115],["T_VARIABLE","$edge",115],"}","\"",")",";",["T_WHITESPACE","\n\n            ",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$level",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                ",117],["T_VARIABLE","$entity",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","set",118],"(",["T_VARIABLE","$level",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$parentNode",118],"[",["T_VARIABLE","$level",118],"]",["T_WHITESPACE"," ",118],"+",["T_WHITESPACE"," ",118],["T_LNUMBER","1",118],")",";",["T_WHITESPACE","\n            ",118],"}",["T_WHITESPACE","\n\n            ",119],["T_RETURN","return",121],";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n\n        ",122],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$isNew",124],["T_WHITESPACE"," ",124],["T_BOOLEAN_AND","&&",124],["T_WHITESPACE"," ",124],"!",["T_VARIABLE","$parent",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$edge",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_getMax",125],"(",")",";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$entity",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","set",126],"(",["T_VARIABLE","$config",126],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",126],"]",",",["T_WHITESPACE"," ",126],["T_VARIABLE","$edge",126],["T_WHITESPACE"," ",126],"+",["T_WHITESPACE"," ",126],["T_LNUMBER","1",126],")",";",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$entity",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","set",127],"(",["T_VARIABLE","$config",127],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",127],"]",",",["T_WHITESPACE"," ",127],["T_VARIABLE","$edge",127],["T_WHITESPACE"," ",127],"+",["T_WHITESPACE"," ",127],["T_LNUMBER","2",127],")",";",["T_WHITESPACE","\n\n            ",127],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$level",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$entity",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","set",130],"(",["T_VARIABLE","$level",130],",",["T_WHITESPACE"," ",130],["T_LNUMBER","0",130],")",";",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE","\n\n            ",131],["T_RETURN","return",133],";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n\n        ",134],["T_IF","if",136],["T_WHITESPACE"," ",136],"(","!",["T_VARIABLE","$isNew",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$dirty",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$parent",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_setParent",137],"(",["T_VARIABLE","$entity",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$parent",137],")",";",["T_WHITESPACE","\n\n            ",137],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$level",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$parentNode",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_getNode",140],"(",["T_VARIABLE","$parent",140],")",";",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$entity",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","set",141],"(",["T_VARIABLE","$level",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$parentNode",141],"[",["T_VARIABLE","$level",141],"]",["T_WHITESPACE"," ",141],"+",["T_WHITESPACE"," ",141],["T_LNUMBER","1",141],")",";",["T_WHITESPACE","\n            ",141],"}",["T_WHITESPACE","\n\n            ",142],["T_RETURN","return",144],";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_IF","if",147],["T_WHITESPACE"," ",147],"(","!",["T_VARIABLE","$isNew",147],["T_WHITESPACE"," ",147],["T_BOOLEAN_AND","&&",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$dirty",147],["T_WHITESPACE"," ",147],["T_BOOLEAN_AND","&&",147],["T_WHITESPACE"," ",147],"!",["T_VARIABLE","$parent",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_setAsRoot",148],"(",["T_VARIABLE","$entity",148],")",";",["T_WHITESPACE","\n\n            ",148],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$level",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n                ",150],["T_VARIABLE","$entity",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","set",151],"(",["T_VARIABLE","$level",151],",",["T_WHITESPACE"," ",151],["T_LNUMBER","0",151],")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * After save listener.\n     *\n     * Manages updating level of descendants of currently saved entity.\n     *\n     * @param \\Cake\\Event\\Event $event The afterSave event that was fired\n     * @param \\Cake\\Datasource\\EntityInterface $entity the entity that is going to be saved\n     * @return void\n     *\/",156],["T_WHITESPACE","\n    ",164],["T_PUBLIC","public",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","afterSave",165],"(",["T_STRING","Event",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$event",165],",",["T_WHITESPACE"," ",165],["T_STRING","EntityInterface",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$entity",165],")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(","!",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_config",167],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",167],"]",["T_WHITESPACE"," ",167],["T_BOOLEAN_OR","||",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$entity",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","isNew",167],"(",")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_RETURN","return",168],";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n\n        ",169],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_setChildrenLevel",171],"(",["T_VARIABLE","$entity",171],")",";",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * Set level for descendants.\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity whose descendants need to be updated.\n     * @return void\n     *\/",174],["T_WHITESPACE","\n    ",179],["T_PROTECTED","protected",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","_setChildrenLevel",180],"(",["T_VARIABLE","$entity",180],")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$config",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","config",182],"(",")",";",["T_WHITESPACE","\n\n        ",182],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$entity",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","get",184],"(",["T_VARIABLE","$config",184],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",184],"]",")",["T_WHITESPACE"," ",184],"+",["T_WHITESPACE"," ",184],["T_LNUMBER","1",184],["T_WHITESPACE"," ",184],["T_IS_IDENTICAL","===",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$entity",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","get",184],"(",["T_VARIABLE","$config",184],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",184],"]",")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_RETURN","return",185],";",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n\n        ",186],["T_VARIABLE","$primaryKey",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_getPrimaryKey",188],"(",")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$primaryKeyValue",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$entity",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","get",189],"(",["T_VARIABLE","$primaryKey",189],")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$depths",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],"[",["T_VARIABLE","$primaryKeyValue",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$entity",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","get",190],"(",["T_VARIABLE","$config",190],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",190],"]",")","]",";",["T_WHITESPACE","\n\n        ",190],["T_VARIABLE","$children",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_table",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","find",192],"(",["T_CONSTANT_ENCAPSED_STRING","'children'",192],",",["T_WHITESPACE"," ",192],"[",["T_WHITESPACE","\n            ",192],["T_CONSTANT_ENCAPSED_STRING","'for'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$primaryKeyValue",193],",",["T_WHITESPACE","\n            ",193],["T_CONSTANT_ENCAPSED_STRING","'fields'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],"[",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_getPrimaryKey",194],"(",")",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$config",194],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",194],"]",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$config",194],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",194],"]","]",",",["T_WHITESPACE","\n            ",194],["T_CONSTANT_ENCAPSED_STRING","'order'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$config",195],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",195],"]",",",["T_WHITESPACE","\n        ",195],"]",")",";",["T_WHITESPACE","\n\n        ",196],["T_COMMENT","\/* @var \\Cake\\ORM\\Entity $node *\/",198],["T_WHITESPACE","\n        ",198],["T_FOREACH","foreach",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$children",199],["T_WHITESPACE"," ",199],["T_AS","as",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$node",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$parentIdValue",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$node",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","get",200],"(",["T_VARIABLE","$config",200],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",200],"]",")",";",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$depth",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$depths",201],"[",["T_VARIABLE","$parentIdValue",201],"]",["T_WHITESPACE"," ",201],"+",["T_WHITESPACE"," ",201],["T_LNUMBER","1",201],";",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$depths",202],"[",["T_VARIABLE","$node",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","get",202],"(",["T_VARIABLE","$primaryKey",202],")","]",["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$depth",202],";",["T_WHITESPACE","\n\n            ",202],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_table",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","updateAll",204],"(",["T_WHITESPACE","\n                ",204],"[",["T_VARIABLE","$config",205],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",205],"]",["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$depth",205],"]",",",["T_WHITESPACE","\n                ",205],"[",["T_VARIABLE","$primaryKey",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$node",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","get",206],"(",["T_VARIABLE","$primaryKey",206],")","]",["T_WHITESPACE","\n            ",206],")",";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * Also deletes the nodes in the subtree of the entity to be delete\n     *\n     * @param \\Cake\\Event\\Event $event The beforeDelete event that was fired\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity that is going to be saved\n     * @return void\n     *\/",211],["T_WHITESPACE","\n    ",217],["T_PUBLIC","public",218],["T_WHITESPACE"," ",218],["T_FUNCTION","function",218],["T_WHITESPACE"," ",218],["T_STRING","beforeDelete",218],"(",["T_STRING","Event",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$event",218],",",["T_WHITESPACE"," ",218],["T_STRING","EntityInterface",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$entity",218],")",["T_WHITESPACE","\n    ",218],"{",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$config",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","config",220],"(",")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_ensureFields",221],"(",["T_VARIABLE","$entity",221],")",";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$left",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$entity",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","get",222],"(",["T_VARIABLE","$config",222],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",222],"]",")",";",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$right",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$entity",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","get",223],"(",["T_VARIABLE","$config",223],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",223],"]",")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$diff",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$right",224],["T_WHITESPACE"," ",224],"-",["T_WHITESPACE"," ",224],["T_VARIABLE","$left",224],["T_WHITESPACE"," ",224],"+",["T_WHITESPACE"," ",224],["T_LNUMBER","1",224],";",["T_WHITESPACE","\n\n        ",224],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$diff",226],["T_WHITESPACE"," ",226],">",["T_WHITESPACE"," ",226],["T_LNUMBER","2",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_table",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","deleteAll",227],"(",["T_FUNCTION","function",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$exp",227],")",["T_WHITESPACE"," ",227],["T_USE","use",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$config",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$left",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$right",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                ",227],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$exp",228],["T_WHITESPACE","\n                    ",228],["T_OBJECT_OPERATOR","->",229],["T_STRING","gte",229],"(",["T_VARIABLE","$config",229],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",229],"]",",",["T_WHITESPACE"," ",229],["T_VARIABLE","$left",229],["T_WHITESPACE"," ",229],"+",["T_WHITESPACE"," ",229],["T_LNUMBER","1",229],")",["T_WHITESPACE","\n                    ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","lte",230],"(",["T_VARIABLE","$config",230],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",230],"]",",",["T_WHITESPACE"," ",230],["T_VARIABLE","$right",230],["T_WHITESPACE"," ",230],"-",["T_WHITESPACE"," ",230],["T_LNUMBER","1",230],")",";",["T_WHITESPACE","\n            ",230],"}",")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n\n        ",232],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_sync",234],"(",["T_VARIABLE","$diff",234],",",["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'-'",234],",",["T_WHITESPACE"," ",234],"\"",["T_ENCAPSED_AND_WHITESPACE","> ",234],["T_CURLY_OPEN","{",234],["T_VARIABLE","$right",234],"}","\"",")",";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n\n    ",235],["T_DOC_COMMENT","\/**\n     * Sets the correct left and right values for the passed entity so it can be\n     * updated to a new parent. It also makes the hole in the tree so the node\n     * move can be done without corrupting the structure.\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity to re-parent\n     * @param mixed $parent the id of the parent to set\n     * @return void\n     * @throws \\RuntimeException if the parent to set to the entity is not valid\n     *\/",237],["T_WHITESPACE","\n    ",246],["T_PROTECTED","protected",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","_setParent",247],"(",["T_VARIABLE","$entity",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$parent",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$config",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","config",249],"(",")",";",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$parentNode",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_getNode",250],"(",["T_VARIABLE","$parent",250],")",";",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_ensureFields",251],"(",["T_VARIABLE","$entity",251],")",";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$parentLeft",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$parentNode",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","get",252],"(",["T_VARIABLE","$config",252],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",252],"]",")",";",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$parentRight",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$parentNode",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","get",253],"(",["T_VARIABLE","$config",253],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",253],"]",")",";",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$right",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$entity",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","get",254],"(",["T_VARIABLE","$config",254],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",254],"]",")",";",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$left",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$entity",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","get",255],"(",["T_VARIABLE","$config",255],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",255],"]",")",";",["T_WHITESPACE","\n\n        ",255],["T_IF","if",257],["T_WHITESPACE"," ",257],"(",["T_VARIABLE","$parentLeft",257],["T_WHITESPACE"," ",257],">",["T_WHITESPACE"," ",257],["T_VARIABLE","$left",257],["T_WHITESPACE"," ",257],["T_BOOLEAN_AND","&&",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$parentLeft",257],["T_WHITESPACE"," ",257],"<",["T_WHITESPACE"," ",257],["T_VARIABLE","$right",257],")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n            ",257],["T_THROW","throw",258],["T_WHITESPACE"," ",258],["T_NEW","new",258],["T_WHITESPACE"," ",258],["T_STRING","RuntimeException",258],"(",["T_STRING","sprintf",258],"(",["T_WHITESPACE","\n                ",258],["T_CONSTANT_ENCAPSED_STRING","'Cannot use node \"%s\" as parent for entity \"%s\"'",259],",",["T_WHITESPACE","\n                ",259],["T_VARIABLE","$parent",260],",",["T_WHITESPACE","\n                ",260],["T_VARIABLE","$entity",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","get",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_getPrimaryKey",261],"(",")",")",["T_WHITESPACE","\n            ",261],")",")",";",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE","\n\n        ",263],["T_COMMENT","\/\/ Values for moving to the left\n",265],["T_WHITESPACE","        ",266],["T_VARIABLE","$diff",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$right",266],["T_WHITESPACE"," ",266],"-",["T_WHITESPACE"," ",266],["T_VARIABLE","$left",266],["T_WHITESPACE"," ",266],"+",["T_WHITESPACE"," ",266],["T_LNUMBER","1",266],";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$targetLeft",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$parentRight",267],";",["T_WHITESPACE","\n        ",267],["T_VARIABLE","$targetRight",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_VARIABLE","$diff",268],["T_WHITESPACE"," ",268],"+",["T_WHITESPACE"," ",268],["T_VARIABLE","$parentRight",268],["T_WHITESPACE"," ",268],"-",["T_WHITESPACE"," ",268],["T_LNUMBER","1",268],";",["T_WHITESPACE","\n        ",268],["T_VARIABLE","$min",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$parentRight",269],";",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$max",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$left",270],["T_WHITESPACE"," ",270],"-",["T_WHITESPACE"," ",270],["T_LNUMBER","1",270],";",["T_WHITESPACE","\n\n        ",270],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$left",272],["T_WHITESPACE"," ",272],"<",["T_WHITESPACE"," ",272],["T_VARIABLE","$targetLeft",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_COMMENT","\/\/ Moving to the right\n",273],["T_WHITESPACE","            ",274],["T_VARIABLE","$targetLeft",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$parentRight",274],["T_WHITESPACE"," ",274],"-",["T_WHITESPACE"," ",274],["T_VARIABLE","$diff",274],";",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$targetRight",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$parentRight",275],["T_WHITESPACE"," ",275],"-",["T_WHITESPACE"," ",275],["T_LNUMBER","1",275],";",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$min",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$right",276],["T_WHITESPACE"," ",276],"+",["T_WHITESPACE"," ",276],["T_LNUMBER","1",276],";",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$max",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$parentRight",277],["T_WHITESPACE"," ",277],"-",["T_WHITESPACE"," ",277],["T_LNUMBER","1",277],";",["T_WHITESPACE","\n            ",277],["T_VARIABLE","$diff",278],["T_WHITESPACE"," ",278],["T_MUL_EQUAL","*=",278],["T_WHITESPACE"," ",278],"-",["T_LNUMBER","1",278],";",["T_WHITESPACE","\n        ",278],"}",["T_WHITESPACE","\n\n        ",279],["T_IF","if",281],["T_WHITESPACE"," ",281],"(",["T_VARIABLE","$right",281],["T_WHITESPACE"," ",281],"-",["T_WHITESPACE"," ",281],["T_VARIABLE","$left",281],["T_WHITESPACE"," ",281],">",["T_WHITESPACE"," ",281],["T_LNUMBER","1",281],")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n            ",281],["T_COMMENT","\/\/ Correcting internal subtree\n",282],["T_WHITESPACE","            ",283],["T_VARIABLE","$internalLeft",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$left",283],["T_WHITESPACE"," ",283],"+",["T_WHITESPACE"," ",283],["T_LNUMBER","1",283],";",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$internalRight",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$right",284],["T_WHITESPACE"," ",284],"-",["T_WHITESPACE"," ",284],["T_LNUMBER","1",284],";",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","_sync",285],"(",["T_VARIABLE","$targetLeft",285],["T_WHITESPACE"," ",285],"-",["T_WHITESPACE"," ",285],["T_VARIABLE","$left",285],",",["T_WHITESPACE"," ",285],["T_CONSTANT_ENCAPSED_STRING","'+'",285],",",["T_WHITESPACE"," ",285],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",285],["T_CURLY_OPEN","{",285],["T_VARIABLE","$internalLeft",285],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",285],["T_CURLY_OPEN","{",285],["T_VARIABLE","$internalRight",285],"}","\"",",",["T_WHITESPACE"," ",285],["T_STRING","true",285],")",";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n\n        ",286],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_sync",288],"(",["T_VARIABLE","$diff",288],",",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'+'",288],",",["T_WHITESPACE"," ",288],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",288],["T_CURLY_OPEN","{",288],["T_VARIABLE","$min",288],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",288],["T_CURLY_OPEN","{",288],["T_VARIABLE","$max",288],"}","\"",")",";",["T_WHITESPACE","\n\n        ",288],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$right",290],["T_WHITESPACE"," ",290],"-",["T_WHITESPACE"," ",290],["T_VARIABLE","$left",290],["T_WHITESPACE"," ",290],">",["T_WHITESPACE"," ",290],["T_LNUMBER","1",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n            ",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_unmarkInternalTree",291],"(",")",";",["T_WHITESPACE","\n        ",291],"}",["T_WHITESPACE","\n\n        ",292],["T_COMMENT","\/\/ Allocating new position\n",294],["T_WHITESPACE","        ",295],["T_VARIABLE","$entity",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","set",295],"(",["T_VARIABLE","$config",295],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",295],"]",",",["T_WHITESPACE"," ",295],["T_VARIABLE","$targetLeft",295],")",";",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$entity",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","set",296],"(",["T_VARIABLE","$config",296],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",296],"]",",",["T_WHITESPACE"," ",296],["T_VARIABLE","$targetRight",296],")",";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Updates the left and right column for the passed entity so it can be set as\n     * a new root in the tree. It also modifies the ordering in the rest of the tree\n     * so the structure remains valid\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity to set as a new root\n     * @return void\n     *\/",299],["T_WHITESPACE","\n    ",306],["T_PROTECTED","protected",307],["T_WHITESPACE"," ",307],["T_FUNCTION","function",307],["T_WHITESPACE"," ",307],["T_STRING","_setAsRoot",307],"(",["T_VARIABLE","$entity",307],")",["T_WHITESPACE","\n    ",307],"{",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$config",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","config",309],"(",")",";",["T_WHITESPACE","\n        ",309],["T_VARIABLE","$edge",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","_getMax",310],"(",")",";",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","_ensureFields",311],"(",["T_VARIABLE","$entity",311],")",";",["T_WHITESPACE","\n        ",311],["T_VARIABLE","$right",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$entity",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","get",312],"(",["T_VARIABLE","$config",312],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",312],"]",")",";",["T_WHITESPACE","\n        ",312],["T_VARIABLE","$left",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$entity",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","get",313],"(",["T_VARIABLE","$config",313],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",313],"]",")",";",["T_WHITESPACE","\n        ",313],["T_VARIABLE","$diff",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$right",314],["T_WHITESPACE"," ",314],"-",["T_WHITESPACE"," ",314],["T_VARIABLE","$left",314],";",["T_WHITESPACE","\n\n        ",314],["T_IF","if",316],["T_WHITESPACE"," ",316],"(",["T_VARIABLE","$right",316],["T_WHITESPACE"," ",316],"-",["T_WHITESPACE"," ",316],["T_VARIABLE","$left",316],["T_WHITESPACE"," ",316],">",["T_WHITESPACE"," ",316],["T_LNUMBER","1",316],")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n            ",316],["T_COMMENT","\/\/Correcting internal subtree\n",317],["T_WHITESPACE","            ",318],["T_VARIABLE","$internalLeft",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$left",318],["T_WHITESPACE"," ",318],"+",["T_WHITESPACE"," ",318],["T_LNUMBER","1",318],";",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$internalRight",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$right",319],["T_WHITESPACE"," ",319],"-",["T_WHITESPACE"," ",319],["T_LNUMBER","1",319],";",["T_WHITESPACE","\n            ",319],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_sync",320],"(",["T_VARIABLE","$edge",320],["T_WHITESPACE"," ",320],"-",["T_WHITESPACE"," ",320],["T_VARIABLE","$diff",320],["T_WHITESPACE"," ",320],"-",["T_WHITESPACE"," ",320],["T_VARIABLE","$left",320],",",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'+'",320],",",["T_WHITESPACE"," ",320],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",320],["T_CURLY_OPEN","{",320],["T_VARIABLE","$internalLeft",320],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",320],["T_CURLY_OPEN","{",320],["T_VARIABLE","$internalRight",320],"}","\"",",",["T_WHITESPACE"," ",320],["T_STRING","true",320],")",";",["T_WHITESPACE","\n        ",320],"}",["T_WHITESPACE","\n\n        ",321],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_sync",323],"(",["T_VARIABLE","$diff",323],["T_WHITESPACE"," ",323],"+",["T_WHITESPACE"," ",323],["T_LNUMBER","1",323],",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'-'",323],",",["T_WHITESPACE"," ",323],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",323],["T_CURLY_OPEN","{",323],["T_VARIABLE","$right",323],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",323],["T_CURLY_OPEN","{",323],["T_VARIABLE","$edge",323],"}","\"",")",";",["T_WHITESPACE","\n\n        ",323],["T_IF","if",325],["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$right",325],["T_WHITESPACE"," ",325],"-",["T_WHITESPACE"," ",325],["T_VARIABLE","$left",325],["T_WHITESPACE"," ",325],">",["T_WHITESPACE"," ",325],["T_LNUMBER","1",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","_unmarkInternalTree",326],"(",")",";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n\n        ",327],["T_VARIABLE","$entity",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","set",329],"(",["T_VARIABLE","$config",329],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",329],"]",",",["T_WHITESPACE"," ",329],["T_VARIABLE","$edge",329],["T_WHITESPACE"," ",329],"-",["T_WHITESPACE"," ",329],["T_VARIABLE","$diff",329],")",";",["T_WHITESPACE","\n        ",329],["T_VARIABLE","$entity",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","set",330],"(",["T_VARIABLE","$config",330],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",330],"]",",",["T_WHITESPACE"," ",330],["T_VARIABLE","$edge",330],")",";",["T_WHITESPACE","\n    ",330],"}",["T_WHITESPACE","\n\n    ",331],["T_DOC_COMMENT","\/**\n     * Helper method used to invert the sign of the left and right columns that are\n     * less than 0. They were set to negative values before so their absolute value\n     * wouldn't change while performing other tree transformations.\n     *\n     * @return void\n     *\/",333],["T_WHITESPACE","\n    ",339],["T_PROTECTED","protected",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","_unmarkInternalTree",340],"(",")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$config",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","config",342],"(",")",";",["T_WHITESPACE","\n        ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_table",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","updateAll",343],"(",["T_WHITESPACE","\n            ",343],["T_FUNCTION","function",344],["T_WHITESPACE"," ",344],"(",["T_VARIABLE","$exp",344],")",["T_WHITESPACE"," ",344],["T_USE","use",344],["T_WHITESPACE"," ",344],"(",["T_VARIABLE","$config",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                ",344],["T_VARIABLE","$leftInverse",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_CLONE","clone",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$exp",345],";",["T_WHITESPACE","\n                ",345],["T_VARIABLE","$leftInverse",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","type",346],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",346],")",["T_OBJECT_OPERATOR","->",346],["T_STRING","add",346],"(",["T_CONSTANT_ENCAPSED_STRING","'-1'",346],")",";",["T_WHITESPACE","\n                ",346],["T_VARIABLE","$rightInverse",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_CLONE","clone",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$leftInverse",347],";",["T_WHITESPACE","\n\n                ",347],["T_RETURN","return",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$exp",349],["T_WHITESPACE","\n                    ",349],["T_OBJECT_OPERATOR","->",350],["T_STRING","eq",350],"(",["T_VARIABLE","$config",350],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",350],"]",",",["T_WHITESPACE"," ",350],["T_VARIABLE","$leftInverse",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","add",350],"(",["T_VARIABLE","$config",350],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",350],"]",")",")",["T_WHITESPACE","\n                    ",350],["T_OBJECT_OPERATOR","->",351],["T_STRING","eq",351],"(",["T_VARIABLE","$config",351],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",351],"]",",",["T_WHITESPACE"," ",351],["T_VARIABLE","$rightInverse",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","add",351],"(",["T_VARIABLE","$config",351],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",351],"]",")",")",";",["T_WHITESPACE","\n            ",351],"}",",",["T_WHITESPACE","\n            ",352],["T_FUNCTION","function",353],["T_WHITESPACE"," ",353],"(",["T_VARIABLE","$exp",353],")",["T_WHITESPACE"," ",353],["T_USE","use",353],["T_WHITESPACE"," ",353],"(",["T_VARIABLE","$config",353],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n                ",353],["T_RETURN","return",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$exp",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","lt",354],"(",["T_VARIABLE","$config",354],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",354],"]",",",["T_WHITESPACE"," ",354],["T_LNUMBER","0",354],")",";",["T_WHITESPACE","\n            ",354],"}",["T_WHITESPACE","\n        ",355],")",";",["T_WHITESPACE","\n    ",356],"}",["T_WHITESPACE","\n\n    ",357],["T_DOC_COMMENT","\/**\n     * Custom finder method which can be used to return the list of nodes from the root\n     * to a specific node in the tree. This custom finder requires that the key 'for'\n     * is passed in the options containing the id of the node to get its path for.\n     *\n     * @param \\Cake\\ORM\\Query $query The constructed query to modify\n     * @param array $options the list of options for the query\n     * @return \\Cake\\ORM\\Query\n     * @throws \\InvalidArgumentException If the 'for' key is missing in options\n     *\/",359],["T_WHITESPACE","\n    ",368],["T_PUBLIC","public",369],["T_WHITESPACE"," ",369],["T_FUNCTION","function",369],["T_WHITESPACE"," ",369],["T_STRING","findPath",369],"(",["T_STRING","Query",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$query",369],",",["T_WHITESPACE"," ",369],["T_ARRAY","array",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$options",369],")",["T_WHITESPACE","\n    ",369],"{",["T_WHITESPACE","\n        ",370],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_EMPTY","empty",371],"(",["T_VARIABLE","$options",371],"[",["T_CONSTANT_ENCAPSED_STRING","'for'",371],"]",")",")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n            ",371],["T_THROW","throw",372],["T_WHITESPACE"," ",372],["T_NEW","new",372],["T_WHITESPACE"," ",372],["T_STRING","InvalidArgumentException",372],"(",["T_CONSTANT_ENCAPSED_STRING","\"The 'for' key is required for find('path')\"",372],")",";",["T_WHITESPACE","\n        ",372],"}",["T_WHITESPACE","\n\n        ",373],["T_VARIABLE","$config",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","config",375],"(",")",";",["T_WHITESPACE","\n        ",375],["T_LIST","list",376],"(",["T_VARIABLE","$left",376],",",["T_WHITESPACE"," ",376],["T_VARIABLE","$right",376],")",["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_STRING","array_map",376],"(",["T_WHITESPACE","\n            ",376],["T_FUNCTION","function",377],["T_WHITESPACE"," ",377],"(",["T_VARIABLE","$field",377],")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n                ",377],["T_RETURN","return",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_table",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","aliasField",378],"(",["T_VARIABLE","$field",378],")",";",["T_WHITESPACE","\n            ",378],"}",",",["T_WHITESPACE","\n            ",379],"[",["T_VARIABLE","$config",380],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",380],"]",",",["T_WHITESPACE"," ",380],["T_VARIABLE","$config",380],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",380],"]","]",["T_WHITESPACE","\n        ",380],")",";",["T_WHITESPACE","\n\n        ",381],["T_VARIABLE","$node",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_table",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","get",383],"(",["T_VARIABLE","$options",383],"[",["T_CONSTANT_ENCAPSED_STRING","'for'",383],"]",",",["T_WHITESPACE"," ",383],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",383],["T_WHITESPACE"," ",383],["T_DOUBLE_ARROW","=>",383],["T_WHITESPACE"," ",383],"[",["T_VARIABLE","$left",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$right",383],"]","]",")",";",["T_WHITESPACE","\n\n        ",383],["T_RETURN","return",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","_scope",385],"(",["T_VARIABLE","$query",385],")",["T_WHITESPACE","\n            ",385],["T_OBJECT_OPERATOR","->",386],["T_STRING","where",386],"(","[",["T_WHITESPACE","\n                ",386],"\"",["T_VARIABLE","$left",387],["T_ENCAPSED_AND_WHITESPACE"," <=",387],"\"",["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$node",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","get",387],"(",["T_VARIABLE","$config",387],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",387],"]",")",",",["T_WHITESPACE","\n                ",387],"\"",["T_VARIABLE","$right",388],["T_ENCAPSED_AND_WHITESPACE"," >=",388],"\"",["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$node",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","get",388],"(",["T_VARIABLE","$config",388],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",388],"]",")",",",["T_WHITESPACE","\n            ",388],"]",")",["T_WHITESPACE","\n            ",389],["T_OBJECT_OPERATOR","->",390],["T_STRING","order",390],"(","[",["T_VARIABLE","$left",390],["T_WHITESPACE"," ",390],["T_DOUBLE_ARROW","=>",390],["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'ASC'",390],"]",")",";",["T_WHITESPACE","\n    ",390],"}",["T_WHITESPACE","\n\n    ",391],["T_DOC_COMMENT","\/**\n     * Get the number of children nodes.\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The entity to count children for\n     * @param bool $direct whether to count all nodes in the subtree or just\n     * direct children\n     * @return int Number of children nodes.\n     *\/",393],["T_WHITESPACE","\n    ",400],["T_PUBLIC","public",401],["T_WHITESPACE"," ",401],["T_FUNCTION","function",401],["T_WHITESPACE"," ",401],["T_STRING","childCount",401],"(",["T_STRING","EntityInterface",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$node",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$direct",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","false",401],")",["T_WHITESPACE","\n    ",401],"{",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$config",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","config",403],"(",")",";",["T_WHITESPACE","\n        ",403],["T_VARIABLE","$parent",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","_table",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","aliasField",404],"(",["T_VARIABLE","$config",404],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",404],"]",")",";",["T_WHITESPACE","\n\n        ",404],["T_IF","if",406],["T_WHITESPACE"," ",406],"(",["T_VARIABLE","$direct",406],")",["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n            ",406],["T_RETURN","return",407],["T_WHITESPACE"," ",407],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","_scope",407],"(",["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","_table",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","find",407],"(",")",")",["T_WHITESPACE","\n                ",407],["T_OBJECT_OPERATOR","->",408],["T_STRING","where",408],"(","[",["T_VARIABLE","$parent",408],["T_WHITESPACE"," ",408],["T_DOUBLE_ARROW","=>",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$node",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","get",408],"(",["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_getPrimaryKey",408],"(",")",")","]",")",["T_WHITESPACE","\n                ",408],["T_OBJECT_OPERATOR","->",409],["T_STRING","count",409],"(",")",";",["T_WHITESPACE","\n        ",409],"}",["T_WHITESPACE","\n\n        ",410],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","_ensureFields",412],"(",["T_VARIABLE","$node",412],")",";",["T_WHITESPACE","\n\n        ",412],["T_RETURN","return",414],["T_WHITESPACE"," ",414],"(",["T_VARIABLE","$node",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","get",414],"(",["T_VARIABLE","$config",414],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",414],"]",")",["T_WHITESPACE"," ",414],"-",["T_WHITESPACE"," ",414],["T_VARIABLE","$node",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","get",414],"(",["T_VARIABLE","$config",414],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",414],"]",")",["T_WHITESPACE"," ",414],"-",["T_WHITESPACE"," ",414],["T_LNUMBER","1",414],")",["T_WHITESPACE"," ",414],"\/",["T_WHITESPACE"," ",414],["T_LNUMBER","2",414],";",["T_WHITESPACE","\n    ",414],"}",["T_WHITESPACE","\n\n    ",415],["T_DOC_COMMENT","\/**\n     * Get the children nodes of the current model\n     *\n     * Available options are:\n     *\n     * - for: The id of the record to read.\n     * - direct: Boolean, whether to return only the direct (true), or all (false) children,\n     *   defaults to false (all children).\n     *\n     * If the direct option is set to true, only the direct children are returned (based upon the parent_id field)\n     *\n     * @param \\Cake\\ORM\\Query $query Query.\n     * @param array $options Array of options as described above\n     * @return \\Cake\\ORM\\Query\n     * @throws \\InvalidArgumentException When the 'for' key is not passed in $options\n     *\/",417],["T_WHITESPACE","\n    ",432],["T_PUBLIC","public",433],["T_WHITESPACE"," ",433],["T_FUNCTION","function",433],["T_WHITESPACE"," ",433],["T_STRING","findChildren",433],"(",["T_STRING","Query",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$query",433],",",["T_WHITESPACE"," ",433],["T_ARRAY","array",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$options",433],")",["T_WHITESPACE","\n    ",433],"{",["T_WHITESPACE","\n        ",434],["T_VARIABLE","$config",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","config",435],"(",")",";",["T_WHITESPACE","\n        ",435],["T_VARIABLE","$options",436],["T_WHITESPACE"," ",436],["T_PLUS_EQUAL","+=",436],["T_WHITESPACE"," ",436],"[",["T_CONSTANT_ENCAPSED_STRING","'for'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_STRING","null",436],",",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","'direct'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_STRING","false",436],"]",";",["T_WHITESPACE","\n        ",436],["T_LIST","list",437],"(",["T_VARIABLE","$parent",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$left",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$right",437],")",["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_STRING","array_map",437],"(",["T_WHITESPACE","\n            ",437],["T_FUNCTION","function",438],["T_WHITESPACE"," ",438],"(",["T_VARIABLE","$field",438],")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n                ",438],["T_RETURN","return",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","_table",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","aliasField",439],"(",["T_VARIABLE","$field",439],")",";",["T_WHITESPACE","\n            ",439],"}",",",["T_WHITESPACE","\n            ",440],"[",["T_VARIABLE","$config",441],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",441],"]",",",["T_WHITESPACE"," ",441],["T_VARIABLE","$config",441],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",441],"]",",",["T_WHITESPACE"," ",441],["T_VARIABLE","$config",441],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",441],"]","]",["T_WHITESPACE","\n        ",441],")",";",["T_WHITESPACE","\n\n        ",442],["T_LIST","list",444],"(",["T_VARIABLE","$for",444],",",["T_WHITESPACE"," ",444],["T_VARIABLE","$direct",444],")",["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],"[",["T_VARIABLE","$options",444],"[",["T_CONSTANT_ENCAPSED_STRING","'for'",444],"]",",",["T_WHITESPACE"," ",444],["T_VARIABLE","$options",444],"[",["T_CONSTANT_ENCAPSED_STRING","'direct'",444],"]","]",";",["T_WHITESPACE","\n\n        ",444],["T_IF","if",446],["T_WHITESPACE"," ",446],"(",["T_EMPTY","empty",446],"(",["T_VARIABLE","$for",446],")",")",["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n            ",446],["T_THROW","throw",447],["T_WHITESPACE"," ",447],["T_NEW","new",447],["T_WHITESPACE"," ",447],["T_STRING","InvalidArgumentException",447],"(",["T_CONSTANT_ENCAPSED_STRING","\"The 'for' key is required for find('children')\"",447],")",";",["T_WHITESPACE","\n        ",447],"}",["T_WHITESPACE","\n\n        ",448],["T_IF","if",450],["T_WHITESPACE"," ",450],"(",["T_VARIABLE","$query",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","clause",450],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",450],")",["T_WHITESPACE"," ",450],["T_IS_IDENTICAL","===",450],["T_WHITESPACE"," ",450],["T_STRING","null",450],")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n            ",450],["T_VARIABLE","$query",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","order",451],"(","[",["T_VARIABLE","$left",451],["T_WHITESPACE"," ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","'ASC'",451],"]",")",";",["T_WHITESPACE","\n        ",451],"}",["T_WHITESPACE","\n\n        ",452],["T_IF","if",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$direct",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n            ",454],["T_RETURN","return",455],["T_WHITESPACE"," ",455],["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","_scope",455],"(",["T_VARIABLE","$query",455],")",["T_OBJECT_OPERATOR","->",455],["T_STRING","where",455],"(","[",["T_VARIABLE","$parent",455],["T_WHITESPACE"," ",455],["T_DOUBLE_ARROW","=>",455],["T_WHITESPACE"," ",455],["T_VARIABLE","$for",455],"]",")",";",["T_WHITESPACE","\n        ",455],"}",["T_WHITESPACE","\n\n        ",456],["T_VARIABLE","$node",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_getNode",458],"(",["T_VARIABLE","$for",458],")",";",["T_WHITESPACE","\n\n        ",458],["T_RETURN","return",460],["T_WHITESPACE"," ",460],["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","_scope",460],"(",["T_VARIABLE","$query",460],")",["T_WHITESPACE","\n            ",460],["T_OBJECT_OPERATOR","->",461],["T_STRING","where",461],"(","[",["T_WHITESPACE","\n                ",461],"\"",["T_CURLY_OPEN","{",462],["T_VARIABLE","$right",462],"}",["T_ENCAPSED_AND_WHITESPACE"," <",462],"\"",["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$node",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","get",462],"(",["T_VARIABLE","$config",462],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",462],"]",")",",",["T_WHITESPACE","\n                ",462],"\"",["T_CURLY_OPEN","{",463],["T_VARIABLE","$left",463],"}",["T_ENCAPSED_AND_WHITESPACE"," >",463],"\"",["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$node",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","get",463],"(",["T_VARIABLE","$config",463],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",463],"]",")",",",["T_WHITESPACE","\n            ",463],"]",")",";",["T_WHITESPACE","\n    ",464],"}",["T_WHITESPACE","\n\n    ",465],["T_DOC_COMMENT","\/**\n     * Gets a representation of the elements in the tree as a flat list where the keys are\n     * the primary key for the table and the values are the display field for the table.\n     * Values are prefixed to visually indicate relative depth in the tree.\n     *\n     * ### Options\n     *\n     * - keyPath: A dot separated path to fetch the field to use for the array key, or a closure to\n     *   return the key out of the provided row.\n     * - valuePath: A dot separated path to fetch the field to use for the array value, or a closure to\n     *   return the value out of the provided row.\n     * - spacer: A string to be used as prefix for denoting the depth in the tree for each item\n     *\n     * @param \\Cake\\ORM\\Query $query Query.\n     * @param array $options Array of options as described above.\n     * @return \\Cake\\ORM\\Query\n     *\/",467],["T_WHITESPACE","\n    ",483],["T_PUBLIC","public",484],["T_WHITESPACE"," ",484],["T_FUNCTION","function",484],["T_WHITESPACE"," ",484],["T_STRING","findTreeList",484],"(",["T_STRING","Query",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$query",484],",",["T_WHITESPACE"," ",484],["T_ARRAY","array",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$options",484],")",["T_WHITESPACE","\n    ",484],"{",["T_WHITESPACE","\n        ",485],["T_VARIABLE","$left",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","_table",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","aliasField",486],"(",["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","config",486],"(",["T_CONSTANT_ENCAPSED_STRING","'left'",486],")",")",";",["T_WHITESPACE","\n\n        ",486],["T_VARIABLE","$results",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_VARIABLE","$this",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","_scope",488],"(",["T_VARIABLE","$query",488],")",["T_WHITESPACE","\n            ",488],["T_OBJECT_OPERATOR","->",489],["T_STRING","find",489],"(",["T_CONSTANT_ENCAPSED_STRING","'threaded'",489],",",["T_WHITESPACE"," ",489],"[",["T_WHITESPACE","\n                ",489],["T_CONSTANT_ENCAPSED_STRING","'parentField'",490],["T_WHITESPACE"," ",490],["T_DOUBLE_ARROW","=>",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","config",490],"(",["T_CONSTANT_ENCAPSED_STRING","'parent'",490],")",",",["T_WHITESPACE","\n                ",490],["T_CONSTANT_ENCAPSED_STRING","'order'",491],["T_WHITESPACE"," ",491],["T_DOUBLE_ARROW","=>",491],["T_WHITESPACE"," ",491],"[",["T_VARIABLE","$left",491],["T_WHITESPACE"," ",491],["T_DOUBLE_ARROW","=>",491],["T_WHITESPACE"," ",491],["T_CONSTANT_ENCAPSED_STRING","'ASC'",491],"]",",",["T_WHITESPACE","\n            ",491],"]",")",";",["T_WHITESPACE","\n\n        ",492],["T_RETURN","return",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","formatTreeList",494],"(",["T_VARIABLE","$results",494],",",["T_WHITESPACE"," ",494],["T_VARIABLE","$options",494],")",";",["T_WHITESPACE","\n    ",494],"}",["T_WHITESPACE","\n\n    ",495],["T_DOC_COMMENT","\/**\n     * Formats query as a flat list where the keys are the primary key for the table\n     * and the values are the display field for the table. Values are prefixed to visually\n     * indicate relative depth in the tree.\n     *\n     * ### Options\n     *\n     * - keyPath: A dot separated path to the field that will be the result array key, or a closure to\n     *   return the key from the provided row.\n     * - valuePath: A dot separated path to the field that is the array's value, or a closure to\n     *   return the value from the provided row.\n     * - spacer: A string to be used as prefix for denoting the depth in the tree for each item.\n     *\n     * @param \\Cake\\ORM\\Query $query The query object to format.\n     * @param array $options Array of options as described above.\n     * @return \\Cake\\ORM\\Query Augmented query.\n     *\/",497],["T_WHITESPACE","\n    ",513],["T_PUBLIC","public",514],["T_WHITESPACE"," ",514],["T_FUNCTION","function",514],["T_WHITESPACE"," ",514],["T_STRING","formatTreeList",514],"(",["T_STRING","Query",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$query",514],",",["T_WHITESPACE"," ",514],["T_ARRAY","array",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$options",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],"[","]",")",["T_WHITESPACE","\n    ",514],"{",["T_WHITESPACE","\n        ",515],["T_RETURN","return",516],["T_WHITESPACE"," ",516],["T_VARIABLE","$query",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","formatResults",516],"(",["T_FUNCTION","function",516],["T_WHITESPACE"," ",516],"(",["T_VARIABLE","$results",516],")",["T_WHITESPACE"," ",516],["T_USE","use",516],["T_WHITESPACE"," ",516],"(",["T_VARIABLE","$options",516],")",["T_WHITESPACE"," ",516],"{",["T_WHITESPACE","\n            ",516],["T_VARIABLE","$options",517],["T_WHITESPACE"," ",517],["T_PLUS_EQUAL","+=",517],["T_WHITESPACE"," ",517],"[",["T_WHITESPACE","\n                ",517],["T_CONSTANT_ENCAPSED_STRING","'keyPath'",518],["T_WHITESPACE"," ",518],["T_DOUBLE_ARROW","=>",518],["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","_getPrimaryKey",518],"(",")",",",["T_WHITESPACE","\n                ",518],["T_CONSTANT_ENCAPSED_STRING","'valuePath'",519],["T_WHITESPACE"," ",519],["T_DOUBLE_ARROW","=>",519],["T_WHITESPACE"," ",519],["T_VARIABLE","$this",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","_table",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","displayField",519],"(",")",",",["T_WHITESPACE","\n                ",519],["T_CONSTANT_ENCAPSED_STRING","'spacer'",520],["T_WHITESPACE"," ",520],["T_DOUBLE_ARROW","=>",520],["T_WHITESPACE"," ",520],["T_CONSTANT_ENCAPSED_STRING","'_'",520],",",["T_WHITESPACE","\n            ",520],"]",";",["T_WHITESPACE","\n\n            ",521],["T_RETURN","return",523],["T_WHITESPACE"," ",523],["T_VARIABLE","$results",523],["T_WHITESPACE","\n                ",523],["T_OBJECT_OPERATOR","->",524],["T_STRING","listNested",524],"(",")",["T_WHITESPACE","\n                ",524],["T_OBJECT_OPERATOR","->",525],["T_STRING","printer",525],"(",["T_VARIABLE","$options",525],"[",["T_CONSTANT_ENCAPSED_STRING","'valuePath'",525],"]",",",["T_WHITESPACE"," ",525],["T_VARIABLE","$options",525],"[",["T_CONSTANT_ENCAPSED_STRING","'keyPath'",525],"]",",",["T_WHITESPACE"," ",525],["T_VARIABLE","$options",525],"[",["T_CONSTANT_ENCAPSED_STRING","'spacer'",525],"]",")",";",["T_WHITESPACE","\n        ",525],"}",")",";",["T_WHITESPACE","\n    ",526],"}",["T_WHITESPACE","\n\n    ",527],["T_DOC_COMMENT","\/**\n     * Removes the current node from the tree, by positioning it as a new root\n     * and re-parents all children up one level.\n     *\n     * Note that the node will not be deleted just moved away from its current position\n     * without moving its children with it.\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The node to remove from the tree\n     * @return \\Cake\\ORM\\Entity|false the node after being removed from the tree or\n     * false on error\n     *\/",529],["T_WHITESPACE","\n    ",539],["T_PUBLIC","public",540],["T_WHITESPACE"," ",540],["T_FUNCTION","function",540],["T_WHITESPACE"," ",540],["T_STRING","removeFromTree",540],"(",["T_STRING","EntityInterface",540],["T_WHITESPACE"," ",540],["T_VARIABLE","$node",540],")",["T_WHITESPACE","\n    ",540],"{",["T_WHITESPACE","\n        ",541],["T_RETURN","return",542],["T_WHITESPACE"," ",542],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","_table",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","connection",542],"(",")",["T_OBJECT_OPERATOR","->",542],["T_STRING","transactional",542],"(",["T_FUNCTION","function",542],["T_WHITESPACE"," ",542],"(",")",["T_WHITESPACE"," ",542],["T_USE","use",542],["T_WHITESPACE"," ",542],"(",["T_VARIABLE","$node",542],")",["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n            ",542],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","_ensureFields",543],"(",["T_VARIABLE","$node",543],")",";",["T_WHITESPACE","\n\n            ",543],["T_RETURN","return",545],["T_WHITESPACE"," ",545],["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","_removeFromTree",545],"(",["T_VARIABLE","$node",545],")",";",["T_WHITESPACE","\n        ",545],"}",")",";",["T_WHITESPACE","\n    ",546],"}",["T_WHITESPACE","\n\n    ",547],["T_DOC_COMMENT","\/**\n     * Helper function containing the actual code for removeFromTree\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The node to remove from the tree\n     * @return \\Cake\\ORM\\Entity|false the node after being removed from the tree or\n     * false on error\n     *\/",549],["T_WHITESPACE","\n    ",555],["T_PROTECTED","protected",556],["T_WHITESPACE"," ",556],["T_FUNCTION","function",556],["T_WHITESPACE"," ",556],["T_STRING","_removeFromTree",556],"(",["T_VARIABLE","$node",556],")",["T_WHITESPACE","\n    ",556],"{",["T_WHITESPACE","\n        ",557],["T_VARIABLE","$config",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","config",558],"(",")",";",["T_WHITESPACE","\n        ",558],["T_VARIABLE","$left",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_VARIABLE","$node",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","get",559],"(",["T_VARIABLE","$config",559],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",559],"]",")",";",["T_WHITESPACE","\n        ",559],["T_VARIABLE","$right",560],["T_WHITESPACE"," ",560],"=",["T_WHITESPACE"," ",560],["T_VARIABLE","$node",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","get",560],"(",["T_VARIABLE","$config",560],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",560],"]",")",";",["T_WHITESPACE","\n        ",560],["T_VARIABLE","$parent",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_VARIABLE","$node",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","get",561],"(",["T_VARIABLE","$config",561],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",561],"]",")",";",["T_WHITESPACE","\n\n        ",561],["T_VARIABLE","$node",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","set",563],"(",["T_VARIABLE","$config",563],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",563],"]",",",["T_WHITESPACE"," ",563],["T_STRING","null",563],")",";",["T_WHITESPACE","\n\n        ",563],["T_IF","if",565],["T_WHITESPACE"," ",565],"(",["T_VARIABLE","$right",565],["T_WHITESPACE"," ",565],"-",["T_WHITESPACE"," ",565],["T_VARIABLE","$left",565],["T_WHITESPACE"," ",565],["T_IS_EQUAL","==",565],["T_WHITESPACE"," ",565],["T_LNUMBER","1",565],")",["T_WHITESPACE"," ",565],"{",["T_WHITESPACE","\n            ",565],["T_RETURN","return",566],["T_WHITESPACE"," ",566],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","_table",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","save",566],"(",["T_VARIABLE","$node",566],")",";",["T_WHITESPACE","\n        ",566],"}",["T_WHITESPACE","\n\n        ",567],["T_VARIABLE","$primary",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","_getPrimaryKey",569],"(",")",";",["T_WHITESPACE","\n        ",569],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","_table",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","updateAll",570],"(",["T_WHITESPACE","\n            ",570],"[",["T_VARIABLE","$config",571],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",571],"]",["T_WHITESPACE"," ",571],["T_DOUBLE_ARROW","=>",571],["T_WHITESPACE"," ",571],["T_VARIABLE","$parent",571],"]",",",["T_WHITESPACE","\n            ",571],"[",["T_VARIABLE","$config",572],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",572],"]",["T_WHITESPACE"," ",572],["T_DOUBLE_ARROW","=>",572],["T_WHITESPACE"," ",572],["T_VARIABLE","$node",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","get",572],"(",["T_VARIABLE","$primary",572],")","]",["T_WHITESPACE","\n        ",572],")",";",["T_WHITESPACE","\n        ",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_sync",574],"(",["T_LNUMBER","1",574],",",["T_WHITESPACE"," ",574],["T_CONSTANT_ENCAPSED_STRING","'-'",574],",",["T_WHITESPACE"," ",574],["T_CONSTANT_ENCAPSED_STRING","'BETWEEN '",574],["T_WHITESPACE"," ",574],".",["T_WHITESPACE"," ",574],"(",["T_VARIABLE","$left",574],["T_WHITESPACE"," ",574],"+",["T_WHITESPACE"," ",574],["T_LNUMBER","1",574],")",["T_WHITESPACE"," ",574],".",["T_WHITESPACE"," ",574],["T_CONSTANT_ENCAPSED_STRING","' AND '",574],["T_WHITESPACE"," ",574],".",["T_WHITESPACE"," ",574],"(",["T_VARIABLE","$right",574],["T_WHITESPACE"," ",574],"-",["T_WHITESPACE"," ",574],["T_LNUMBER","1",574],")",")",";",["T_WHITESPACE","\n        ",574],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","_sync",575],"(",["T_LNUMBER","2",575],",",["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'-'",575],",",["T_WHITESPACE"," ",575],"\"",["T_ENCAPSED_AND_WHITESPACE","> ",575],["T_CURLY_OPEN","{",575],["T_VARIABLE","$right",575],"}","\"",")",";",["T_WHITESPACE","\n        ",575],["T_VARIABLE","$edge",576],["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","_getMax",576],"(",")",";",["T_WHITESPACE","\n        ",576],["T_VARIABLE","$node",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","set",577],"(",["T_VARIABLE","$config",577],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",577],"]",",",["T_WHITESPACE"," ",577],["T_VARIABLE","$edge",577],["T_WHITESPACE"," ",577],"+",["T_WHITESPACE"," ",577],["T_LNUMBER","1",577],")",";",["T_WHITESPACE","\n        ",577],["T_VARIABLE","$node",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","set",578],"(",["T_VARIABLE","$config",578],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",578],"]",",",["T_WHITESPACE"," ",578],["T_VARIABLE","$edge",578],["T_WHITESPACE"," ",578],"+",["T_WHITESPACE"," ",578],["T_LNUMBER","2",578],")",";",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$fields",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],"[",["T_VARIABLE","$config",579],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",579],"]",",",["T_WHITESPACE"," ",579],["T_VARIABLE","$config",579],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",579],"]",",",["T_WHITESPACE"," ",579],["T_VARIABLE","$config",579],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",579],"]","]",";",["T_WHITESPACE","\n\n        ",579],["T_VARIABLE","$this",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","_table",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","updateAll",581],"(",["T_VARIABLE","$node",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","extract",581],"(",["T_VARIABLE","$fields",581],")",",",["T_WHITESPACE"," ",581],"[",["T_VARIABLE","$primary",581],["T_WHITESPACE"," ",581],["T_DOUBLE_ARROW","=>",581],["T_WHITESPACE"," ",581],["T_VARIABLE","$node",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","get",581],"(",["T_VARIABLE","$primary",581],")","]",")",";",["T_WHITESPACE","\n\n        ",581],["T_FOREACH","foreach",583],["T_WHITESPACE"," ",583],"(",["T_VARIABLE","$fields",583],["T_WHITESPACE"," ",583],["T_AS","as",583],["T_WHITESPACE"," ",583],["T_VARIABLE","$field",583],")",["T_WHITESPACE"," ",583],"{",["T_WHITESPACE","\n            ",583],["T_VARIABLE","$node",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","dirty",584],"(",["T_VARIABLE","$field",584],",",["T_WHITESPACE"," ",584],["T_STRING","false",584],")",";",["T_WHITESPACE","\n        ",584],"}",["T_WHITESPACE","\n\n        ",585],["T_RETURN","return",587],["T_WHITESPACE"," ",587],["T_VARIABLE","$node",587],";",["T_WHITESPACE","\n    ",587],"}",["T_WHITESPACE","\n\n    ",588],["T_DOC_COMMENT","\/**\n     * Reorders the node without changing its parent.\n     *\n     * If the node is the first child, or is a top level node with no previous node\n     * this method will return false\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The node to move\n     * @param int|bool $number How many places to move the node, or true to move to first position\n     * @throws \\Cake\\Datasource\\Exception\\RecordNotFoundException When node was not found\n     * @return \\Cake\\ORM\\Entity|bool $node The node after being moved or false on failure\n     *\/",590],["T_WHITESPACE","\n    ",600],["T_PUBLIC","public",601],["T_WHITESPACE"," ",601],["T_FUNCTION","function",601],["T_WHITESPACE"," ",601],["T_STRING","moveUp",601],"(",["T_STRING","EntityInterface",601],["T_WHITESPACE"," ",601],["T_VARIABLE","$node",601],",",["T_WHITESPACE"," ",601],["T_VARIABLE","$number",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],["T_LNUMBER","1",601],")",["T_WHITESPACE","\n    ",601],"{",["T_WHITESPACE","\n        ",602],["T_IF","if",603],["T_WHITESPACE"," ",603],"(",["T_VARIABLE","$number",603],["T_WHITESPACE"," ",603],"<",["T_WHITESPACE"," ",603],["T_LNUMBER","1",603],")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n            ",603],["T_RETURN","return",604],["T_WHITESPACE"," ",604],["T_STRING","false",604],";",["T_WHITESPACE","\n        ",604],"}",["T_WHITESPACE","\n\n        ",605],["T_RETURN","return",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","_table",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","connection",607],"(",")",["T_OBJECT_OPERATOR","->",607],["T_STRING","transactional",607],"(",["T_FUNCTION","function",607],["T_WHITESPACE"," ",607],"(",")",["T_WHITESPACE"," ",607],["T_USE","use",607],["T_WHITESPACE"," ",607],"(",["T_VARIABLE","$node",607],",",["T_WHITESPACE"," ",607],["T_VARIABLE","$number",607],")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n            ",607],["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","_ensureFields",608],"(",["T_VARIABLE","$node",608],")",";",["T_WHITESPACE","\n\n            ",608],["T_RETURN","return",610],["T_WHITESPACE"," ",610],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","_moveUp",610],"(",["T_VARIABLE","$node",610],",",["T_WHITESPACE"," ",610],["T_VARIABLE","$number",610],")",";",["T_WHITESPACE","\n        ",610],"}",")",";",["T_WHITESPACE","\n    ",611],"}",["T_WHITESPACE","\n\n    ",612],["T_DOC_COMMENT","\/**\n     * Helper function used with the actual code for moveUp\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The node to move\n     * @param int|bool $number How many places to move the node, or true to move to first position\n     * @throws \\Cake\\Datasource\\Exception\\RecordNotFoundException When node was not found\n     * @return \\Cake\\ORM\\Entity|bool $node The node after being moved or false on failure\n     *\/",614],["T_WHITESPACE","\n    ",621],["T_PROTECTED","protected",622],["T_WHITESPACE"," ",622],["T_FUNCTION","function",622],["T_WHITESPACE"," ",622],["T_STRING","_moveUp",622],"(",["T_VARIABLE","$node",622],",",["T_WHITESPACE"," ",622],["T_VARIABLE","$number",622],")",["T_WHITESPACE","\n    ",622],"{",["T_WHITESPACE","\n        ",623],["T_VARIABLE","$config",624],["T_WHITESPACE"," ",624],"=",["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","config",624],"(",")",";",["T_WHITESPACE","\n        ",624],["T_LIST","list",625],"(",["T_VARIABLE","$parent",625],",",["T_WHITESPACE"," ",625],["T_VARIABLE","$left",625],",",["T_WHITESPACE"," ",625],["T_VARIABLE","$right",625],")",["T_WHITESPACE"," ",625],"=",["T_WHITESPACE"," ",625],"[",["T_VARIABLE","$config",625],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",625],"]",",",["T_WHITESPACE"," ",625],["T_VARIABLE","$config",625],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",625],"]",",",["T_WHITESPACE"," ",625],["T_VARIABLE","$config",625],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",625],"]","]",";",["T_WHITESPACE","\n        ",625],["T_LIST","list",626],"(",["T_VARIABLE","$nodeParent",626],",",["T_WHITESPACE"," ",626],["T_VARIABLE","$nodeLeft",626],",",["T_WHITESPACE"," ",626],["T_VARIABLE","$nodeRight",626],")",["T_WHITESPACE"," ",626],"=",["T_WHITESPACE"," ",626],["T_STRING","array_values",626],"(",["T_VARIABLE","$node",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","extract",626],"(","[",["T_VARIABLE","$parent",626],",",["T_WHITESPACE"," ",626],["T_VARIABLE","$left",626],",",["T_WHITESPACE"," ",626],["T_VARIABLE","$right",626],"]",")",")",";",["T_WHITESPACE","\n\n        ",626],["T_VARIABLE","$targetNode",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_STRING","null",628],";",["T_WHITESPACE","\n        ",628],["T_IF","if",629],["T_WHITESPACE"," ",629],"(",["T_VARIABLE","$number",629],["T_WHITESPACE"," ",629],["T_IS_NOT_IDENTICAL","!==",629],["T_WHITESPACE"," ",629],["T_STRING","true",629],")",["T_WHITESPACE"," ",629],"{",["T_WHITESPACE","\n            ",629],["T_VARIABLE","$targetNode",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","_scope",630],"(",["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","_table",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","find",630],"(",")",")",["T_WHITESPACE","\n                ",630],["T_OBJECT_OPERATOR","->",631],["T_STRING","select",631],"(","[",["T_VARIABLE","$left",631],",",["T_WHITESPACE"," ",631],["T_VARIABLE","$right",631],"]",")",["T_WHITESPACE","\n                ",631],["T_OBJECT_OPERATOR","->",632],["T_STRING","where",632],"(","[","\"",["T_VARIABLE","$parent",632],["T_ENCAPSED_AND_WHITESPACE"," IS",632],"\"",["T_WHITESPACE"," ",632],["T_DOUBLE_ARROW","=>",632],["T_WHITESPACE"," ",632],["T_VARIABLE","$nodeParent",632],"]",")",["T_WHITESPACE","\n                ",632],["T_OBJECT_OPERATOR","->",633],["T_STRING","where",633],"(",["T_FUNCTION","function",633],["T_WHITESPACE"," ",633],"(",["T_VARIABLE","$exp",633],")",["T_WHITESPACE"," ",633],["T_USE","use",633],["T_WHITESPACE"," ",633],"(",["T_VARIABLE","$config",633],",",["T_WHITESPACE"," ",633],["T_VARIABLE","$nodeLeft",633],")",["T_WHITESPACE"," ",633],"{",["T_WHITESPACE","\n                    ",633],["T_RETURN","return",634],["T_WHITESPACE"," ",634],["T_VARIABLE","$exp",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","lt",634],"(",["T_VARIABLE","$config",634],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",634],"]",",",["T_WHITESPACE"," ",634],["T_VARIABLE","$nodeLeft",634],")",";",["T_WHITESPACE","\n                ",634],"}",")",["T_WHITESPACE","\n                ",635],["T_OBJECT_OPERATOR","->",636],["T_STRING","orderDesc",636],"(",["T_VARIABLE","$config",636],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",636],"]",")",["T_WHITESPACE","\n                ",636],["T_OBJECT_OPERATOR","->",637],["T_STRING","offset",637],"(",["T_VARIABLE","$number",637],["T_WHITESPACE"," ",637],"-",["T_WHITESPACE"," ",637],["T_LNUMBER","1",637],")",["T_WHITESPACE","\n                ",637],["T_OBJECT_OPERATOR","->",638],["T_STRING","limit",638],"(",["T_LNUMBER","1",638],")",["T_WHITESPACE","\n                ",638],["T_OBJECT_OPERATOR","->",639],["T_STRING","first",639],"(",")",";",["T_WHITESPACE","\n        ",639],"}",["T_WHITESPACE","\n        ",640],["T_IF","if",641],["T_WHITESPACE"," ",641],"(","!",["T_VARIABLE","$targetNode",641],")",["T_WHITESPACE"," ",641],"{",["T_WHITESPACE","\n            ",641],["T_VARIABLE","$targetNode",642],["T_WHITESPACE"," ",642],"=",["T_WHITESPACE"," ",642],["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","_scope",642],"(",["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","_table",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","find",642],"(",")",")",["T_WHITESPACE","\n                ",642],["T_OBJECT_OPERATOR","->",643],["T_STRING","select",643],"(","[",["T_VARIABLE","$left",643],",",["T_WHITESPACE"," ",643],["T_VARIABLE","$right",643],"]",")",["T_WHITESPACE","\n                ",643],["T_OBJECT_OPERATOR","->",644],["T_STRING","where",644],"(","[","\"",["T_VARIABLE","$parent",644],["T_ENCAPSED_AND_WHITESPACE"," IS",644],"\"",["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$nodeParent",644],"]",")",["T_WHITESPACE","\n                ",644],["T_OBJECT_OPERATOR","->",645],["T_STRING","where",645],"(",["T_FUNCTION","function",645],["T_WHITESPACE"," ",645],"(",["T_VARIABLE","$exp",645],")",["T_WHITESPACE"," ",645],["T_USE","use",645],["T_WHITESPACE"," ",645],"(",["T_VARIABLE","$config",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$nodeLeft",645],")",["T_WHITESPACE"," ",645],"{",["T_WHITESPACE","\n                    ",645],["T_RETURN","return",646],["T_WHITESPACE"," ",646],["T_VARIABLE","$exp",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","lt",646],"(",["T_VARIABLE","$config",646],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",646],"]",",",["T_WHITESPACE"," ",646],["T_VARIABLE","$nodeLeft",646],")",";",["T_WHITESPACE","\n                ",646],"}",")",["T_WHITESPACE","\n                ",647],["T_OBJECT_OPERATOR","->",648],["T_STRING","orderAsc",648],"(",["T_VARIABLE","$config",648],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",648],"]",")",["T_WHITESPACE","\n                ",648],["T_OBJECT_OPERATOR","->",649],["T_STRING","limit",649],"(",["T_LNUMBER","1",649],")",["T_WHITESPACE","\n                ",649],["T_OBJECT_OPERATOR","->",650],["T_STRING","first",650],"(",")",";",["T_WHITESPACE","\n\n            ",650],["T_IF","if",652],["T_WHITESPACE"," ",652],"(","!",["T_VARIABLE","$targetNode",652],")",["T_WHITESPACE"," ",652],"{",["T_WHITESPACE","\n                ",652],["T_RETURN","return",653],["T_WHITESPACE"," ",653],["T_VARIABLE","$node",653],";",["T_WHITESPACE","\n            ",653],"}",["T_WHITESPACE","\n        ",654],"}",["T_WHITESPACE","\n\n        ",655],["T_LIST","list",657],"(",["T_VARIABLE","$targetLeft",657],")",["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],["T_STRING","array_values",657],"(",["T_VARIABLE","$targetNode",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","extract",657],"(","[",["T_VARIABLE","$left",657],",",["T_WHITESPACE"," ",657],["T_VARIABLE","$right",657],"]",")",")",";",["T_WHITESPACE","\n        ",657],["T_VARIABLE","$edge",658],["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_VARIABLE","$this",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","_getMax",658],"(",")",";",["T_WHITESPACE","\n        ",658],["T_VARIABLE","$leftBoundary",659],["T_WHITESPACE"," ",659],"=",["T_WHITESPACE"," ",659],["T_VARIABLE","$targetLeft",659],";",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$rightBoundary",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_VARIABLE","$nodeLeft",660],["T_WHITESPACE"," ",660],"-",["T_WHITESPACE"," ",660],["T_LNUMBER","1",660],";",["T_WHITESPACE","\n\n        ",660],["T_VARIABLE","$nodeToEdge",662],["T_WHITESPACE"," ",662],"=",["T_WHITESPACE"," ",662],["T_VARIABLE","$edge",662],["T_WHITESPACE"," ",662],"-",["T_WHITESPACE"," ",662],["T_VARIABLE","$nodeLeft",662],["T_WHITESPACE"," ",662],"+",["T_WHITESPACE"," ",662],["T_LNUMBER","1",662],";",["T_WHITESPACE","\n        ",662],["T_VARIABLE","$shift",663],["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],["T_VARIABLE","$nodeRight",663],["T_WHITESPACE"," ",663],"-",["T_WHITESPACE"," ",663],["T_VARIABLE","$nodeLeft",663],["T_WHITESPACE"," ",663],"+",["T_WHITESPACE"," ",663],["T_LNUMBER","1",663],";",["T_WHITESPACE","\n        ",663],["T_VARIABLE","$nodeToHole",664],["T_WHITESPACE"," ",664],"=",["T_WHITESPACE"," ",664],["T_VARIABLE","$edge",664],["T_WHITESPACE"," ",664],"-",["T_WHITESPACE"," ",664],["T_VARIABLE","$leftBoundary",664],["T_WHITESPACE"," ",664],"+",["T_WHITESPACE"," ",664],["T_LNUMBER","1",664],";",["T_WHITESPACE","\n        ",664],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","_sync",665],"(",["T_VARIABLE","$nodeToEdge",665],",",["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","'+'",665],",",["T_WHITESPACE"," ",665],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",665],["T_CURLY_OPEN","{",665],["T_VARIABLE","$nodeLeft",665],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",665],["T_CURLY_OPEN","{",665],["T_VARIABLE","$nodeRight",665],"}","\"",")",";",["T_WHITESPACE","\n        ",665],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","_sync",666],"(",["T_VARIABLE","$shift",666],",",["T_WHITESPACE"," ",666],["T_CONSTANT_ENCAPSED_STRING","'+'",666],",",["T_WHITESPACE"," ",666],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",666],["T_CURLY_OPEN","{",666],["T_VARIABLE","$leftBoundary",666],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",666],["T_CURLY_OPEN","{",666],["T_VARIABLE","$rightBoundary",666],"}","\"",")",";",["T_WHITESPACE","\n        ",666],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","_sync",667],"(",["T_VARIABLE","$nodeToHole",667],",",["T_WHITESPACE"," ",667],["T_CONSTANT_ENCAPSED_STRING","'-'",667],",",["T_WHITESPACE"," ",667],"\"",["T_ENCAPSED_AND_WHITESPACE","> ",667],["T_CURLY_OPEN","{",667],["T_VARIABLE","$edge",667],"}","\"",")",";",["T_WHITESPACE","\n\n        ",667],["T_VARIABLE","$node",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","set",669],"(",["T_VARIABLE","$left",669],",",["T_WHITESPACE"," ",669],["T_VARIABLE","$targetLeft",669],")",";",["T_WHITESPACE","\n        ",669],["T_VARIABLE","$node",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","set",670],"(",["T_VARIABLE","$right",670],",",["T_WHITESPACE"," ",670],["T_VARIABLE","$targetLeft",670],["T_WHITESPACE"," ",670],"+",["T_WHITESPACE"," ",670],"(",["T_VARIABLE","$nodeRight",670],["T_WHITESPACE"," ",670],"-",["T_WHITESPACE"," ",670],["T_VARIABLE","$nodeLeft",670],")",")",";",["T_WHITESPACE","\n\n        ",670],["T_VARIABLE","$node",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","dirty",672],"(",["T_VARIABLE","$left",672],",",["T_WHITESPACE"," ",672],["T_STRING","false",672],")",";",["T_WHITESPACE","\n        ",672],["T_VARIABLE","$node",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","dirty",673],"(",["T_VARIABLE","$right",673],",",["T_WHITESPACE"," ",673],["T_STRING","false",673],")",";",["T_WHITESPACE","\n\n        ",673],["T_RETURN","return",675],["T_WHITESPACE"," ",675],["T_VARIABLE","$node",675],";",["T_WHITESPACE","\n    ",675],"}",["T_WHITESPACE","\n\n    ",676],["T_DOC_COMMENT","\/**\n     * Reorders the node without changing the parent.\n     *\n     * If the node is the last child, or is a top level node with no subsequent node\n     * this method will return false\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The node to move\n     * @param int|bool $number How many places to move the node or true to move to last position\n     * @throws \\Cake\\Datasource\\Exception\\RecordNotFoundException When node was not found\n     * @return \\Cake\\ORM\\Entity|bool the entity after being moved or false on failure\n     *\/",678],["T_WHITESPACE","\n    ",688],["T_PUBLIC","public",689],["T_WHITESPACE"," ",689],["T_FUNCTION","function",689],["T_WHITESPACE"," ",689],["T_STRING","moveDown",689],"(",["T_STRING","EntityInterface",689],["T_WHITESPACE"," ",689],["T_VARIABLE","$node",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$number",689],["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_LNUMBER","1",689],")",["T_WHITESPACE","\n    ",689],"{",["T_WHITESPACE","\n        ",690],["T_IF","if",691],["T_WHITESPACE"," ",691],"(",["T_VARIABLE","$number",691],["T_WHITESPACE"," ",691],"<",["T_WHITESPACE"," ",691],["T_LNUMBER","1",691],")",["T_WHITESPACE"," ",691],"{",["T_WHITESPACE","\n            ",691],["T_RETURN","return",692],["T_WHITESPACE"," ",692],["T_STRING","false",692],";",["T_WHITESPACE","\n        ",692],"}",["T_WHITESPACE","\n\n        ",693],["T_RETURN","return",695],["T_WHITESPACE"," ",695],["T_VARIABLE","$this",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","_table",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","connection",695],"(",")",["T_OBJECT_OPERATOR","->",695],["T_STRING","transactional",695],"(",["T_FUNCTION","function",695],["T_WHITESPACE"," ",695],"(",")",["T_WHITESPACE"," ",695],["T_USE","use",695],["T_WHITESPACE"," ",695],"(",["T_VARIABLE","$node",695],",",["T_WHITESPACE"," ",695],["T_VARIABLE","$number",695],")",["T_WHITESPACE"," ",695],"{",["T_WHITESPACE","\n            ",695],["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","_ensureFields",696],"(",["T_VARIABLE","$node",696],")",";",["T_WHITESPACE","\n\n            ",696],["T_RETURN","return",698],["T_WHITESPACE"," ",698],["T_VARIABLE","$this",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","_moveDown",698],"(",["T_VARIABLE","$node",698],",",["T_WHITESPACE"," ",698],["T_VARIABLE","$number",698],")",";",["T_WHITESPACE","\n        ",698],"}",")",";",["T_WHITESPACE","\n    ",699],"}",["T_WHITESPACE","\n\n    ",700],["T_DOC_COMMENT","\/**\n     * Helper function used with the actual code for moveDown\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $node The node to move\n     * @param int|bool $number How many places to move the node, or true to move to last position\n     * @throws \\Cake\\Datasource\\Exception\\RecordNotFoundException When node was not found\n     * @return \\Cake\\ORM\\Entity|bool $node The node after being moved or false on failure\n     *\/",702],["T_WHITESPACE","\n    ",709],["T_PROTECTED","protected",710],["T_WHITESPACE"," ",710],["T_FUNCTION","function",710],["T_WHITESPACE"," ",710],["T_STRING","_moveDown",710],"(",["T_VARIABLE","$node",710],",",["T_WHITESPACE"," ",710],["T_VARIABLE","$number",710],")",["T_WHITESPACE","\n    ",710],"{",["T_WHITESPACE","\n        ",711],["T_VARIABLE","$config",712],["T_WHITESPACE"," ",712],"=",["T_WHITESPACE"," ",712],["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","config",712],"(",")",";",["T_WHITESPACE","\n        ",712],["T_LIST","list",713],"(",["T_VARIABLE","$parent",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$left",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$right",713],")",["T_WHITESPACE"," ",713],"=",["T_WHITESPACE"," ",713],"[",["T_VARIABLE","$config",713],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",713],"]",",",["T_WHITESPACE"," ",713],["T_VARIABLE","$config",713],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",713],"]",",",["T_WHITESPACE"," ",713],["T_VARIABLE","$config",713],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",713],"]","]",";",["T_WHITESPACE","\n        ",713],["T_LIST","list",714],"(",["T_VARIABLE","$nodeParent",714],",",["T_WHITESPACE"," ",714],["T_VARIABLE","$nodeLeft",714],",",["T_WHITESPACE"," ",714],["T_VARIABLE","$nodeRight",714],")",["T_WHITESPACE"," ",714],"=",["T_WHITESPACE"," ",714],["T_STRING","array_values",714],"(",["T_VARIABLE","$node",714],["T_OBJECT_OPERATOR","->",714],["T_STRING","extract",714],"(","[",["T_VARIABLE","$parent",714],",",["T_WHITESPACE"," ",714],["T_VARIABLE","$left",714],",",["T_WHITESPACE"," ",714],["T_VARIABLE","$right",714],"]",")",")",";",["T_WHITESPACE","\n\n        ",714],["T_VARIABLE","$targetNode",716],["T_WHITESPACE"," ",716],"=",["T_WHITESPACE"," ",716],["T_STRING","null",716],";",["T_WHITESPACE","\n        ",716],["T_IF","if",717],["T_WHITESPACE"," ",717],"(",["T_VARIABLE","$number",717],["T_WHITESPACE"," ",717],["T_IS_NOT_IDENTICAL","!==",717],["T_WHITESPACE"," ",717],["T_STRING","true",717],")",["T_WHITESPACE"," ",717],"{",["T_WHITESPACE","\n            ",717],["T_VARIABLE","$targetNode",718],["T_WHITESPACE"," ",718],"=",["T_WHITESPACE"," ",718],["T_VARIABLE","$this",718],["T_OBJECT_OPERATOR","->",718],["T_STRING","_scope",718],"(",["T_VARIABLE","$this",718],["T_OBJECT_OPERATOR","->",718],["T_STRING","_table",718],["T_OBJECT_OPERATOR","->",718],["T_STRING","find",718],"(",")",")",["T_WHITESPACE","\n                ",718],["T_OBJECT_OPERATOR","->",719],["T_STRING","select",719],"(","[",["T_VARIABLE","$left",719],",",["T_WHITESPACE"," ",719],["T_VARIABLE","$right",719],"]",")",["T_WHITESPACE","\n                ",719],["T_OBJECT_OPERATOR","->",720],["T_STRING","where",720],"(","[","\"",["T_VARIABLE","$parent",720],["T_ENCAPSED_AND_WHITESPACE"," IS",720],"\"",["T_WHITESPACE"," ",720],["T_DOUBLE_ARROW","=>",720],["T_WHITESPACE"," ",720],["T_VARIABLE","$nodeParent",720],"]",")",["T_WHITESPACE","\n                ",720],["T_OBJECT_OPERATOR","->",721],["T_STRING","where",721],"(",["T_FUNCTION","function",721],["T_WHITESPACE"," ",721],"(",["T_VARIABLE","$exp",721],")",["T_WHITESPACE"," ",721],["T_USE","use",721],["T_WHITESPACE"," ",721],"(",["T_VARIABLE","$config",721],",",["T_WHITESPACE"," ",721],["T_VARIABLE","$nodeRight",721],")",["T_WHITESPACE"," ",721],"{",["T_WHITESPACE","\n                    ",721],["T_RETURN","return",722],["T_WHITESPACE"," ",722],["T_VARIABLE","$exp",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","gt",722],"(",["T_VARIABLE","$config",722],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",722],"]",",",["T_WHITESPACE"," ",722],["T_VARIABLE","$nodeRight",722],")",";",["T_WHITESPACE","\n                ",722],"}",")",["T_WHITESPACE","\n                ",723],["T_OBJECT_OPERATOR","->",724],["T_STRING","orderAsc",724],"(",["T_VARIABLE","$config",724],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",724],"]",")",["T_WHITESPACE","\n                ",724],["T_OBJECT_OPERATOR","->",725],["T_STRING","offset",725],"(",["T_VARIABLE","$number",725],["T_WHITESPACE"," ",725],"-",["T_WHITESPACE"," ",725],["T_LNUMBER","1",725],")",["T_WHITESPACE","\n                ",725],["T_OBJECT_OPERATOR","->",726],["T_STRING","limit",726],"(",["T_LNUMBER","1",726],")",["T_WHITESPACE","\n                ",726],["T_OBJECT_OPERATOR","->",727],["T_STRING","first",727],"(",")",";",["T_WHITESPACE","\n        ",727],"}",["T_WHITESPACE","\n        ",728],["T_IF","if",729],["T_WHITESPACE"," ",729],"(","!",["T_VARIABLE","$targetNode",729],")",["T_WHITESPACE"," ",729],"{",["T_WHITESPACE","\n            ",729],["T_VARIABLE","$targetNode",730],["T_WHITESPACE"," ",730],"=",["T_WHITESPACE"," ",730],["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","_scope",730],"(",["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","_table",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","find",730],"(",")",")",["T_WHITESPACE","\n                ",730],["T_OBJECT_OPERATOR","->",731],["T_STRING","select",731],"(","[",["T_VARIABLE","$left",731],",",["T_WHITESPACE"," ",731],["T_VARIABLE","$right",731],"]",")",["T_WHITESPACE","\n                ",731],["T_OBJECT_OPERATOR","->",732],["T_STRING","where",732],"(","[","\"",["T_VARIABLE","$parent",732],["T_ENCAPSED_AND_WHITESPACE"," IS",732],"\"",["T_WHITESPACE"," ",732],["T_DOUBLE_ARROW","=>",732],["T_WHITESPACE"," ",732],["T_VARIABLE","$nodeParent",732],"]",")",["T_WHITESPACE","\n                ",732],["T_OBJECT_OPERATOR","->",733],["T_STRING","where",733],"(",["T_FUNCTION","function",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$exp",733],")",["T_WHITESPACE"," ",733],["T_USE","use",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$config",733],",",["T_WHITESPACE"," ",733],["T_VARIABLE","$nodeRight",733],")",["T_WHITESPACE"," ",733],"{",["T_WHITESPACE","\n                    ",733],["T_RETURN","return",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$exp",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","gt",734],"(",["T_VARIABLE","$config",734],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",734],"]",",",["T_WHITESPACE"," ",734],["T_VARIABLE","$nodeRight",734],")",";",["T_WHITESPACE","\n                ",734],"}",")",["T_WHITESPACE","\n                ",735],["T_OBJECT_OPERATOR","->",736],["T_STRING","orderDesc",736],"(",["T_VARIABLE","$config",736],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",736],"]",")",["T_WHITESPACE","\n                ",736],["T_OBJECT_OPERATOR","->",737],["T_STRING","limit",737],"(",["T_LNUMBER","1",737],")",["T_WHITESPACE","\n                ",737],["T_OBJECT_OPERATOR","->",738],["T_STRING","first",738],"(",")",";",["T_WHITESPACE","\n\n            ",738],["T_IF","if",740],["T_WHITESPACE"," ",740],"(","!",["T_VARIABLE","$targetNode",740],")",["T_WHITESPACE"," ",740],"{",["T_WHITESPACE","\n                ",740],["T_RETURN","return",741],["T_WHITESPACE"," ",741],["T_VARIABLE","$node",741],";",["T_WHITESPACE","\n            ",741],"}",["T_WHITESPACE","\n        ",742],"}",["T_WHITESPACE","\n\n        ",743],["T_LIST","list",745],"(",",",["T_WHITESPACE"," ",745],["T_VARIABLE","$targetRight",745],")",["T_WHITESPACE"," ",745],"=",["T_WHITESPACE"," ",745],["T_STRING","array_values",745],"(",["T_VARIABLE","$targetNode",745],["T_OBJECT_OPERATOR","->",745],["T_STRING","extract",745],"(","[",["T_VARIABLE","$left",745],",",["T_WHITESPACE"," ",745],["T_VARIABLE","$right",745],"]",")",")",";",["T_WHITESPACE","\n        ",745],["T_VARIABLE","$edge",746],["T_WHITESPACE"," ",746],"=",["T_WHITESPACE"," ",746],["T_VARIABLE","$this",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","_getMax",746],"(",")",";",["T_WHITESPACE","\n        ",746],["T_VARIABLE","$leftBoundary",747],["T_WHITESPACE"," ",747],"=",["T_WHITESPACE"," ",747],["T_VARIABLE","$nodeRight",747],["T_WHITESPACE"," ",747],"+",["T_WHITESPACE"," ",747],["T_LNUMBER","1",747],";",["T_WHITESPACE","\n        ",747],["T_VARIABLE","$rightBoundary",748],["T_WHITESPACE"," ",748],"=",["T_WHITESPACE"," ",748],["T_VARIABLE","$targetRight",748],";",["T_WHITESPACE","\n\n        ",748],["T_VARIABLE","$nodeToEdge",750],["T_WHITESPACE"," ",750],"=",["T_WHITESPACE"," ",750],["T_VARIABLE","$edge",750],["T_WHITESPACE"," ",750],"-",["T_WHITESPACE"," ",750],["T_VARIABLE","$nodeLeft",750],["T_WHITESPACE"," ",750],"+",["T_WHITESPACE"," ",750],["T_LNUMBER","1",750],";",["T_WHITESPACE","\n        ",750],["T_VARIABLE","$shift",751],["T_WHITESPACE"," ",751],"=",["T_WHITESPACE"," ",751],["T_VARIABLE","$nodeRight",751],["T_WHITESPACE"," ",751],"-",["T_WHITESPACE"," ",751],["T_VARIABLE","$nodeLeft",751],["T_WHITESPACE"," ",751],"+",["T_WHITESPACE"," ",751],["T_LNUMBER","1",751],";",["T_WHITESPACE","\n        ",751],["T_VARIABLE","$nodeToHole",752],["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_VARIABLE","$edge",752],["T_WHITESPACE"," ",752],"-",["T_WHITESPACE"," ",752],["T_VARIABLE","$rightBoundary",752],["T_WHITESPACE"," ",752],"+",["T_WHITESPACE"," ",752],["T_VARIABLE","$shift",752],";",["T_WHITESPACE","\n        ",752],["T_VARIABLE","$this",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","_sync",753],"(",["T_VARIABLE","$nodeToEdge",753],",",["T_WHITESPACE"," ",753],["T_CONSTANT_ENCAPSED_STRING","'+'",753],",",["T_WHITESPACE"," ",753],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",753],["T_CURLY_OPEN","{",753],["T_VARIABLE","$nodeLeft",753],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",753],["T_CURLY_OPEN","{",753],["T_VARIABLE","$nodeRight",753],"}","\"",")",";",["T_WHITESPACE","\n        ",753],["T_VARIABLE","$this",754],["T_OBJECT_OPERATOR","->",754],["T_STRING","_sync",754],"(",["T_VARIABLE","$shift",754],",",["T_WHITESPACE"," ",754],["T_CONSTANT_ENCAPSED_STRING","'-'",754],",",["T_WHITESPACE"," ",754],"\"",["T_ENCAPSED_AND_WHITESPACE","BETWEEN ",754],["T_CURLY_OPEN","{",754],["T_VARIABLE","$leftBoundary",754],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",754],["T_CURLY_OPEN","{",754],["T_VARIABLE","$rightBoundary",754],"}","\"",")",";",["T_WHITESPACE","\n        ",754],["T_VARIABLE","$this",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","_sync",755],"(",["T_VARIABLE","$nodeToHole",755],",",["T_WHITESPACE"," ",755],["T_CONSTANT_ENCAPSED_STRING","'-'",755],",",["T_WHITESPACE"," ",755],"\"",["T_ENCAPSED_AND_WHITESPACE","> ",755],["T_CURLY_OPEN","{",755],["T_VARIABLE","$edge",755],"}","\"",")",";",["T_WHITESPACE","\n\n        ",755],["T_VARIABLE","$node",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","set",757],"(",["T_VARIABLE","$left",757],",",["T_WHITESPACE"," ",757],["T_VARIABLE","$targetRight",757],["T_WHITESPACE"," ",757],"-",["T_WHITESPACE"," ",757],"(",["T_VARIABLE","$nodeRight",757],["T_WHITESPACE"," ",757],"-",["T_WHITESPACE"," ",757],["T_VARIABLE","$nodeLeft",757],")",")",";",["T_WHITESPACE","\n        ",757],["T_VARIABLE","$node",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","set",758],"(",["T_VARIABLE","$right",758],",",["T_WHITESPACE"," ",758],["T_VARIABLE","$targetRight",758],")",";",["T_WHITESPACE","\n\n        ",758],["T_VARIABLE","$node",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","dirty",760],"(",["T_VARIABLE","$left",760],",",["T_WHITESPACE"," ",760],["T_STRING","false",760],")",";",["T_WHITESPACE","\n        ",760],["T_VARIABLE","$node",761],["T_OBJECT_OPERATOR","->",761],["T_STRING","dirty",761],"(",["T_VARIABLE","$right",761],",",["T_WHITESPACE"," ",761],["T_STRING","false",761],")",";",["T_WHITESPACE","\n\n        ",761],["T_RETURN","return",763],["T_WHITESPACE"," ",763],["T_VARIABLE","$node",763],";",["T_WHITESPACE","\n    ",763],"}",["T_WHITESPACE","\n\n    ",764],["T_DOC_COMMENT","\/**\n     * Returns a single node from the tree from its primary key\n     *\n     * @param mixed $id Record id.\n     * @return \\Cake\\ORM\\Entity\n     * @throws \\Cake\\Datasource\\Exception\\RecordNotFoundException When node was not found\n     *\/",766],["T_WHITESPACE","\n    ",772],["T_PROTECTED","protected",773],["T_WHITESPACE"," ",773],["T_FUNCTION","function",773],["T_WHITESPACE"," ",773],["T_STRING","_getNode",773],"(",["T_VARIABLE","$id",773],")",["T_WHITESPACE","\n    ",773],"{",["T_WHITESPACE","\n        ",774],["T_VARIABLE","$config",775],["T_WHITESPACE"," ",775],"=",["T_WHITESPACE"," ",775],["T_VARIABLE","$this",775],["T_OBJECT_OPERATOR","->",775],["T_STRING","config",775],"(",")",";",["T_WHITESPACE","\n        ",775],["T_LIST","list",776],"(",["T_VARIABLE","$parent",776],",",["T_WHITESPACE"," ",776],["T_VARIABLE","$left",776],",",["T_WHITESPACE"," ",776],["T_VARIABLE","$right",776],")",["T_WHITESPACE"," ",776],"=",["T_WHITESPACE"," ",776],"[",["T_VARIABLE","$config",776],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",776],"]",",",["T_WHITESPACE"," ",776],["T_VARIABLE","$config",776],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",776],"]",",",["T_WHITESPACE"," ",776],["T_VARIABLE","$config",776],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",776],"]","]",";",["T_WHITESPACE","\n        ",776],["T_VARIABLE","$primaryKey",777],["T_WHITESPACE"," ",777],"=",["T_WHITESPACE"," ",777],["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","_getPrimaryKey",777],"(",")",";",["T_WHITESPACE","\n        ",777],["T_VARIABLE","$fields",778],["T_WHITESPACE"," ",778],"=",["T_WHITESPACE"," ",778],"[",["T_VARIABLE","$parent",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$left",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$right",778],"]",";",["T_WHITESPACE","\n        ",778],["T_IF","if",779],["T_WHITESPACE"," ",779],"(",["T_VARIABLE","$config",779],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",779],"]",")",["T_WHITESPACE"," ",779],"{",["T_WHITESPACE","\n            ",779],["T_VARIABLE","$fields",780],"[","]",["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_VARIABLE","$config",780],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",780],"]",";",["T_WHITESPACE","\n        ",780],"}",["T_WHITESPACE","\n\n        ",781],["T_VARIABLE","$node",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","_scope",783],"(",["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","_table",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","find",783],"(",")",")",["T_WHITESPACE","\n            ",783],["T_OBJECT_OPERATOR","->",784],["T_STRING","select",784],"(",["T_VARIABLE","$fields",784],")",["T_WHITESPACE","\n            ",784],["T_OBJECT_OPERATOR","->",785],["T_STRING","where",785],"(","[",["T_VARIABLE","$this",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","_table",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","aliasField",785],"(",["T_VARIABLE","$primaryKey",785],")",["T_WHITESPACE"," ",785],["T_DOUBLE_ARROW","=>",785],["T_WHITESPACE"," ",785],["T_VARIABLE","$id",785],"]",")",["T_WHITESPACE","\n            ",785],["T_OBJECT_OPERATOR","->",786],["T_STRING","first",786],"(",")",";",["T_WHITESPACE","\n\n        ",786],["T_IF","if",788],["T_WHITESPACE"," ",788],"(","!",["T_VARIABLE","$node",788],")",["T_WHITESPACE"," ",788],"{",["T_WHITESPACE","\n            ",788],["T_THROW","throw",789],["T_WHITESPACE"," ",789],["T_NEW","new",789],["T_WHITESPACE"," ",789],["T_STRING","RecordNotFoundException",789],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Node \\\"",789],["T_CURLY_OPEN","{",789],["T_VARIABLE","$id",789],"}",["T_ENCAPSED_AND_WHITESPACE","\\\" was not found in the tree.",789],"\"",")",";",["T_WHITESPACE","\n        ",789],"}",["T_WHITESPACE","\n\n        ",790],["T_RETURN","return",792],["T_WHITESPACE"," ",792],["T_VARIABLE","$node",792],";",["T_WHITESPACE","\n    ",792],"}",["T_WHITESPACE","\n\n    ",793],["T_DOC_COMMENT","\/**\n     * Recovers the lft and right column values out of the hierarchy defined by the\n     * parent column.\n     *\n     * @return void\n     *\/",795],["T_WHITESPACE","\n    ",800],["T_PUBLIC","public",801],["T_WHITESPACE"," ",801],["T_FUNCTION","function",801],["T_WHITESPACE"," ",801],["T_STRING","recover",801],"(",")",["T_WHITESPACE","\n    ",801],"{",["T_WHITESPACE","\n        ",802],["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","_table",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","connection",803],"(",")",["T_OBJECT_OPERATOR","->",803],["T_STRING","transactional",803],"(",["T_FUNCTION","function",803],["T_WHITESPACE"," ",803],"(",")",["T_WHITESPACE"," ",803],"{",["T_WHITESPACE","\n            ",803],["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","_recoverTree",804],"(",")",";",["T_WHITESPACE","\n        ",804],"}",")",";",["T_WHITESPACE","\n    ",805],"}",["T_WHITESPACE","\n\n    ",806],["T_DOC_COMMENT","\/**\n     * Recursive method used to recover a single level of the tree\n     *\n     * @param int $counter The Last left column value that was assigned\n     * @param mixed $parentId the parent id of the level to be recovered\n     * @param int $level Node level\n     * @return int The next value to use for the left column\n     *\/",808],["T_WHITESPACE","\n    ",815],["T_PROTECTED","protected",816],["T_WHITESPACE"," ",816],["T_FUNCTION","function",816],["T_WHITESPACE"," ",816],["T_STRING","_recoverTree",816],"(",["T_VARIABLE","$counter",816],["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],["T_LNUMBER","0",816],",",["T_WHITESPACE"," ",816],["T_VARIABLE","$parentId",816],["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],["T_STRING","null",816],",",["T_WHITESPACE"," ",816],["T_VARIABLE","$level",816],["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],"-",["T_LNUMBER","1",816],")",["T_WHITESPACE","\n    ",816],"{",["T_WHITESPACE","\n        ",817],["T_VARIABLE","$config",818],["T_WHITESPACE"," ",818],"=",["T_WHITESPACE"," ",818],["T_VARIABLE","$this",818],["T_OBJECT_OPERATOR","->",818],["T_STRING","config",818],"(",")",";",["T_WHITESPACE","\n        ",818],["T_LIST","list",819],"(",["T_VARIABLE","$parent",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$left",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$right",819],")",["T_WHITESPACE"," ",819],"=",["T_WHITESPACE"," ",819],"[",["T_VARIABLE","$config",819],"[",["T_CONSTANT_ENCAPSED_STRING","'parent'",819],"]",",",["T_WHITESPACE"," ",819],["T_VARIABLE","$config",819],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",819],"]",",",["T_WHITESPACE"," ",819],["T_VARIABLE","$config",819],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",819],"]","]",";",["T_WHITESPACE","\n        ",819],["T_VARIABLE","$primaryKey",820],["T_WHITESPACE"," ",820],"=",["T_WHITESPACE"," ",820],["T_VARIABLE","$this",820],["T_OBJECT_OPERATOR","->",820],["T_STRING","_getPrimaryKey",820],"(",")",";",["T_WHITESPACE","\n        ",820],["T_VARIABLE","$aliasedPrimaryKey",821],["T_WHITESPACE"," ",821],"=",["T_WHITESPACE"," ",821],["T_VARIABLE","$this",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","_table",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","aliasField",821],"(",["T_VARIABLE","$primaryKey",821],")",";",["T_WHITESPACE","\n        ",821],["T_VARIABLE","$order",822],["T_WHITESPACE"," ",822],"=",["T_WHITESPACE"," ",822],["T_VARIABLE","$config",822],"[",["T_CONSTANT_ENCAPSED_STRING","'recoverOrder'",822],"]",["T_WHITESPACE"," ",822],"?",":",["T_WHITESPACE"," ",822],["T_VARIABLE","$aliasedPrimaryKey",822],";",["T_WHITESPACE","\n\n        ",822],["T_VARIABLE","$query",824],["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_VARIABLE","$this",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","_scope",824],"(",["T_VARIABLE","$this",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","_table",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","query",824],"(",")",")",["T_WHITESPACE","\n            ",824],["T_OBJECT_OPERATOR","->",825],["T_STRING","select",825],"(","[",["T_VARIABLE","$aliasedPrimaryKey",825],"]",")",["T_WHITESPACE","\n            ",825],["T_OBJECT_OPERATOR","->",826],["T_STRING","where",826],"(","[",["T_VARIABLE","$this",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","_table",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","aliasField",826],"(",["T_VARIABLE","$parent",826],")",["T_WHITESPACE"," ",826],".",["T_WHITESPACE"," ",826],["T_CONSTANT_ENCAPSED_STRING","' IS'",826],["T_WHITESPACE"," ",826],["T_DOUBLE_ARROW","=>",826],["T_WHITESPACE"," ",826],["T_VARIABLE","$parentId",826],"]",")",["T_WHITESPACE","\n            ",826],["T_OBJECT_OPERATOR","->",827],["T_STRING","order",827],"(",["T_VARIABLE","$order",827],")",["T_WHITESPACE","\n            ",827],["T_OBJECT_OPERATOR","->",828],["T_STRING","hydrate",828],"(",["T_STRING","false",828],")",";",["T_WHITESPACE","\n\n        ",828],["T_VARIABLE","$leftCounter",830],["T_WHITESPACE"," ",830],"=",["T_WHITESPACE"," ",830],["T_VARIABLE","$counter",830],";",["T_WHITESPACE","\n        ",830],["T_VARIABLE","$nextLevel",831],["T_WHITESPACE"," ",831],"=",["T_WHITESPACE"," ",831],["T_VARIABLE","$level",831],["T_WHITESPACE"," ",831],"+",["T_WHITESPACE"," ",831],["T_LNUMBER","1",831],";",["T_WHITESPACE","\n        ",831],["T_FOREACH","foreach",832],["T_WHITESPACE"," ",832],"(",["T_VARIABLE","$query",832],["T_WHITESPACE"," ",832],["T_AS","as",832],["T_WHITESPACE"," ",832],["T_VARIABLE","$row",832],")",["T_WHITESPACE"," ",832],"{",["T_WHITESPACE","\n            ",832],["T_VARIABLE","$counter",833],["T_INC","++",833],";",["T_WHITESPACE","\n            ",833],["T_VARIABLE","$counter",834],["T_WHITESPACE"," ",834],"=",["T_WHITESPACE"," ",834],["T_VARIABLE","$this",834],["T_OBJECT_OPERATOR","->",834],["T_STRING","_recoverTree",834],"(",["T_VARIABLE","$counter",834],",",["T_WHITESPACE"," ",834],["T_VARIABLE","$row",834],"[",["T_VARIABLE","$primaryKey",834],"]",",",["T_WHITESPACE"," ",834],["T_VARIABLE","$nextLevel",834],")",";",["T_WHITESPACE","\n        ",834],"}",["T_WHITESPACE","\n\n        ",835],["T_IF","if",837],["T_WHITESPACE"," ",837],"(",["T_VARIABLE","$parentId",837],["T_WHITESPACE"," ",837],["T_IS_IDENTICAL","===",837],["T_WHITESPACE"," ",837],["T_STRING","null",837],")",["T_WHITESPACE"," ",837],"{",["T_WHITESPACE","\n            ",837],["T_RETURN","return",838],["T_WHITESPACE"," ",838],["T_VARIABLE","$counter",838],";",["T_WHITESPACE","\n        ",838],"}",["T_WHITESPACE","\n\n        ",839],["T_VARIABLE","$fields",841],["T_WHITESPACE"," ",841],"=",["T_WHITESPACE"," ",841],"[",["T_VARIABLE","$left",841],["T_WHITESPACE"," ",841],["T_DOUBLE_ARROW","=>",841],["T_WHITESPACE"," ",841],["T_VARIABLE","$leftCounter",841],",",["T_WHITESPACE"," ",841],["T_VARIABLE","$right",841],["T_WHITESPACE"," ",841],["T_DOUBLE_ARROW","=>",841],["T_WHITESPACE"," ",841],["T_VARIABLE","$counter",841],["T_WHITESPACE"," ",841],"+",["T_WHITESPACE"," ",841],["T_LNUMBER","1",841],"]",";",["T_WHITESPACE","\n        ",841],["T_IF","if",842],["T_WHITESPACE"," ",842],"(",["T_VARIABLE","$config",842],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",842],"]",")",["T_WHITESPACE"," ",842],"{",["T_WHITESPACE","\n            ",842],["T_VARIABLE","$fields",843],"[",["T_VARIABLE","$config",843],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",843],"]","]",["T_WHITESPACE"," ",843],"=",["T_WHITESPACE"," ",843],["T_VARIABLE","$level",843],";",["T_WHITESPACE","\n        ",843],"}",["T_WHITESPACE","\n\n        ",844],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","_table",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","updateAll",846],"(",["T_WHITESPACE","\n            ",846],["T_VARIABLE","$fields",847],",",["T_WHITESPACE","\n            ",847],"[",["T_VARIABLE","$primaryKey",848],["T_WHITESPACE"," ",848],["T_DOUBLE_ARROW","=>",848],["T_WHITESPACE"," ",848],["T_VARIABLE","$parentId",848],"]",["T_WHITESPACE","\n        ",848],")",";",["T_WHITESPACE","\n\n        ",849],["T_RETURN","return",851],["T_WHITESPACE"," ",851],["T_VARIABLE","$counter",851],["T_WHITESPACE"," ",851],"+",["T_WHITESPACE"," ",851],["T_LNUMBER","1",851],";",["T_WHITESPACE","\n    ",851],"}",["T_WHITESPACE","\n\n    ",852],["T_DOC_COMMENT","\/**\n     * Returns the maximum index value in the table.\n     *\n     * @return int\n     *\/",854],["T_WHITESPACE","\n    ",858],["T_PROTECTED","protected",859],["T_WHITESPACE"," ",859],["T_FUNCTION","function",859],["T_WHITESPACE"," ",859],["T_STRING","_getMax",859],"(",")",["T_WHITESPACE","\n    ",859],"{",["T_WHITESPACE","\n        ",860],["T_VARIABLE","$field",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","_config",861],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",861],"]",";",["T_WHITESPACE","\n        ",861],["T_VARIABLE","$rightField",862],["T_WHITESPACE"," ",862],"=",["T_WHITESPACE"," ",862],["T_VARIABLE","$this",862],["T_OBJECT_OPERATOR","->",862],["T_STRING","_config",862],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",862],"]",";",["T_WHITESPACE","\n        ",862],["T_VARIABLE","$edge",863],["T_WHITESPACE"," ",863],"=",["T_WHITESPACE"," ",863],["T_VARIABLE","$this",863],["T_OBJECT_OPERATOR","->",863],["T_STRING","_scope",863],"(",["T_VARIABLE","$this",863],["T_OBJECT_OPERATOR","->",863],["T_STRING","_table",863],["T_OBJECT_OPERATOR","->",863],["T_STRING","find",863],"(",")",")",["T_WHITESPACE","\n            ",863],["T_OBJECT_OPERATOR","->",864],["T_STRING","select",864],"(","[",["T_VARIABLE","$field",864],"]",")",["T_WHITESPACE","\n            ",864],["T_OBJECT_OPERATOR","->",865],["T_STRING","orderDesc",865],"(",["T_VARIABLE","$rightField",865],")",["T_WHITESPACE","\n            ",865],["T_OBJECT_OPERATOR","->",866],["T_STRING","first",866],"(",")",";",["T_WHITESPACE","\n\n        ",866],["T_IF","if",868],["T_WHITESPACE"," ",868],"(",["T_EMPTY","empty",868],"(",["T_VARIABLE","$edge",868],["T_OBJECT_OPERATOR","->",868],"{",["T_VARIABLE","$field",868],"}",")",")",["T_WHITESPACE"," ",868],"{",["T_WHITESPACE","\n            ",868],["T_RETURN","return",869],["T_WHITESPACE"," ",869],["T_LNUMBER","0",869],";",["T_WHITESPACE","\n        ",869],"}",["T_WHITESPACE","\n\n        ",870],["T_RETURN","return",872],["T_WHITESPACE"," ",872],["T_VARIABLE","$edge",872],["T_OBJECT_OPERATOR","->",872],"{",["T_VARIABLE","$field",872],"}",";",["T_WHITESPACE","\n    ",872],"}",["T_WHITESPACE","\n\n    ",873],["T_DOC_COMMENT","\/**\n     * Auxiliary function used to automatically alter the value of both the left and\n     * right columns by a certain amount that match the passed conditions\n     *\n     * @param int $shift the value to use for operating the left and right columns\n     * @param string $dir The operator to use for shifting the value (+\/-)\n     * @param string $conditions a SQL snipped to be used for comparing left or right\n     * against it.\n     * @param bool $mark whether to mark the updated values so that they can not be\n     * modified by future calls to this function.\n     * @return void\n     *\/",875],["T_WHITESPACE","\n    ",886],["T_PROTECTED","protected",887],["T_WHITESPACE"," ",887],["T_FUNCTION","function",887],["T_WHITESPACE"," ",887],["T_STRING","_sync",887],"(",["T_VARIABLE","$shift",887],",",["T_WHITESPACE"," ",887],["T_VARIABLE","$dir",887],",",["T_WHITESPACE"," ",887],["T_VARIABLE","$conditions",887],",",["T_WHITESPACE"," ",887],["T_VARIABLE","$mark",887],["T_WHITESPACE"," ",887],"=",["T_WHITESPACE"," ",887],["T_STRING","false",887],")",["T_WHITESPACE","\n    ",887],"{",["T_WHITESPACE","\n        ",888],["T_VARIABLE","$config",889],["T_WHITESPACE"," ",889],"=",["T_WHITESPACE"," ",889],["T_VARIABLE","$this",889],["T_OBJECT_OPERATOR","->",889],["T_STRING","_config",889],";",["T_WHITESPACE","\n\n        ",889],["T_FOREACH","foreach",891],["T_WHITESPACE"," ",891],"(","[",["T_VARIABLE","$config",891],"[",["T_CONSTANT_ENCAPSED_STRING","'leftField'",891],"]",",",["T_WHITESPACE"," ",891],["T_VARIABLE","$config",891],"[",["T_CONSTANT_ENCAPSED_STRING","'rightField'",891],"]","]",["T_WHITESPACE"," ",891],["T_AS","as",891],["T_WHITESPACE"," ",891],["T_VARIABLE","$field",891],")",["T_WHITESPACE"," ",891],"{",["T_WHITESPACE","\n            ",891],["T_VARIABLE","$query",892],["T_WHITESPACE"," ",892],"=",["T_WHITESPACE"," ",892],["T_VARIABLE","$this",892],["T_OBJECT_OPERATOR","->",892],["T_STRING","_scope",892],"(",["T_VARIABLE","$this",892],["T_OBJECT_OPERATOR","->",892],["T_STRING","_table",892],["T_OBJECT_OPERATOR","->",892],["T_STRING","query",892],"(",")",")",";",["T_WHITESPACE","\n            ",892],["T_VARIABLE","$exp",893],["T_WHITESPACE"," ",893],"=",["T_WHITESPACE"," ",893],["T_VARIABLE","$query",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","newExpr",893],"(",")",";",["T_WHITESPACE","\n\n            ",893],["T_VARIABLE","$movement",895],["T_WHITESPACE"," ",895],"=",["T_WHITESPACE"," ",895],["T_CLONE","clone",895],["T_WHITESPACE"," ",895],["T_VARIABLE","$exp",895],";",["T_WHITESPACE","\n            ",895],["T_VARIABLE","$movement",896],["T_OBJECT_OPERATOR","->",896],["T_STRING","add",896],"(",["T_VARIABLE","$field",896],")",["T_OBJECT_OPERATOR","->",896],["T_STRING","add",896],"(","\"",["T_VARIABLE","$shift",896],"\"",")",["T_OBJECT_OPERATOR","->",896],["T_STRING","tieWith",896],"(",["T_VARIABLE","$dir",896],")",";",["T_WHITESPACE","\n\n            ",896],["T_VARIABLE","$inverse",898],["T_WHITESPACE"," ",898],"=",["T_WHITESPACE"," ",898],["T_CLONE","clone",898],["T_WHITESPACE"," ",898],["T_VARIABLE","$exp",898],";",["T_WHITESPACE","\n            ",898],["T_VARIABLE","$movement",899],["T_WHITESPACE"," ",899],"=",["T_WHITESPACE"," ",899],["T_VARIABLE","$mark",899],["T_WHITESPACE"," ",899],"?",["T_WHITESPACE","\n                ",899],["T_VARIABLE","$inverse",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","add",900],"(",["T_VARIABLE","$movement",900],")",["T_OBJECT_OPERATOR","->",900],["T_STRING","tieWith",900],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",900],")",["T_OBJECT_OPERATOR","->",900],["T_STRING","add",900],"(",["T_CONSTANT_ENCAPSED_STRING","'-1'",900],")",["T_WHITESPACE"," ",900],":",["T_WHITESPACE","\n                ",900],["T_VARIABLE","$movement",901],";",["T_WHITESPACE","\n\n            ",901],["T_VARIABLE","$where",903],["T_WHITESPACE"," ",903],"=",["T_WHITESPACE"," ",903],["T_CLONE","clone",903],["T_WHITESPACE"," ",903],["T_VARIABLE","$exp",903],";",["T_WHITESPACE","\n            ",903],["T_VARIABLE","$where",904],["T_OBJECT_OPERATOR","->",904],["T_STRING","add",904],"(",["T_VARIABLE","$field",904],")",["T_OBJECT_OPERATOR","->",904],["T_STRING","add",904],"(",["T_VARIABLE","$conditions",904],")",["T_OBJECT_OPERATOR","->",904],["T_STRING","tieWith",904],"(",["T_CONSTANT_ENCAPSED_STRING","''",904],")",";",["T_WHITESPACE","\n\n            ",904],["T_VARIABLE","$query",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","update",906],"(",")",["T_WHITESPACE","\n                ",906],["T_OBJECT_OPERATOR","->",907],["T_STRING","set",907],"(",["T_VARIABLE","$exp",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","eq",907],"(",["T_VARIABLE","$field",907],",",["T_WHITESPACE"," ",907],["T_VARIABLE","$movement",907],")",")",["T_WHITESPACE","\n                ",907],["T_OBJECT_OPERATOR","->",908],["T_STRING","where",908],"(",["T_VARIABLE","$where",908],")",";",["T_WHITESPACE","\n\n            ",908],["T_VARIABLE","$query",910],["T_OBJECT_OPERATOR","->",910],["T_STRING","execute",910],"(",")",["T_OBJECT_OPERATOR","->",910],["T_STRING","closeCursor",910],"(",")",";",["T_WHITESPACE","\n        ",910],"}",["T_WHITESPACE","\n    ",911],"}",["T_WHITESPACE","\n\n    ",912],["T_DOC_COMMENT","\/**\n     * Alters the passed query so that it only returns scoped records as defined\n     * in the tree configuration.\n     *\n     * @param \\Cake\\ORM\\Query $query the Query to modify\n     * @return \\Cake\\ORM\\Query\n     *\/",914],["T_WHITESPACE","\n    ",920],["T_PROTECTED","protected",921],["T_WHITESPACE"," ",921],["T_FUNCTION","function",921],["T_WHITESPACE"," ",921],["T_STRING","_scope",921],"(",["T_VARIABLE","$query",921],")",["T_WHITESPACE","\n    ",921],"{",["T_WHITESPACE","\n        ",922],["T_VARIABLE","$config",923],["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_VARIABLE","$this",923],["T_OBJECT_OPERATOR","->",923],["T_STRING","config",923],"(",")",";",["T_WHITESPACE","\n\n        ",923],["T_IF","if",925],["T_WHITESPACE"," ",925],"(",["T_STRING","is_array",925],"(",["T_VARIABLE","$config",925],"[",["T_CONSTANT_ENCAPSED_STRING","'scope'",925],"]",")",")",["T_WHITESPACE"," ",925],"{",["T_WHITESPACE","\n            ",925],["T_RETURN","return",926],["T_WHITESPACE"," ",926],["T_VARIABLE","$query",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","where",926],"(",["T_VARIABLE","$config",926],"[",["T_CONSTANT_ENCAPSED_STRING","'scope'",926],"]",")",";",["T_WHITESPACE","\n        ",926],"}",["T_WHITESPACE","\n        ",927],["T_IF","if",928],["T_WHITESPACE"," ",928],"(",["T_STRING","is_callable",928],"(",["T_VARIABLE","$config",928],"[",["T_CONSTANT_ENCAPSED_STRING","'scope'",928],"]",")",")",["T_WHITESPACE"," ",928],"{",["T_WHITESPACE","\n            ",928],["T_RETURN","return",929],["T_WHITESPACE"," ",929],["T_VARIABLE","$config",929],"[",["T_CONSTANT_ENCAPSED_STRING","'scope'",929],"]","(",["T_VARIABLE","$query",929],")",";",["T_WHITESPACE","\n        ",929],"}",["T_WHITESPACE","\n\n        ",930],["T_RETURN","return",932],["T_WHITESPACE"," ",932],["T_VARIABLE","$query",932],";",["T_WHITESPACE","\n    ",932],"}",["T_WHITESPACE","\n\n    ",933],["T_DOC_COMMENT","\/**\n     * Ensures that the provided entity contains non-empty values for the left and\n     * right fields\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity to ensure fields for\n     * @return void\n     *\/",935],["T_WHITESPACE","\n    ",941],["T_PROTECTED","protected",942],["T_WHITESPACE"," ",942],["T_FUNCTION","function",942],["T_WHITESPACE"," ",942],["T_STRING","_ensureFields",942],"(",["T_VARIABLE","$entity",942],")",["T_WHITESPACE","\n    ",942],"{",["T_WHITESPACE","\n        ",943],["T_VARIABLE","$config",944],["T_WHITESPACE"," ",944],"=",["T_WHITESPACE"," ",944],["T_VARIABLE","$this",944],["T_OBJECT_OPERATOR","->",944],["T_STRING","config",944],"(",")",";",["T_WHITESPACE","\n        ",944],["T_VARIABLE","$fields",945],["T_WHITESPACE"," ",945],"=",["T_WHITESPACE"," ",945],"[",["T_VARIABLE","$config",945],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",945],"]",",",["T_WHITESPACE"," ",945],["T_VARIABLE","$config",945],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",945],"]","]",";",["T_WHITESPACE","\n        ",945],["T_VARIABLE","$values",946],["T_WHITESPACE"," ",946],"=",["T_WHITESPACE"," ",946],["T_STRING","array_filter",946],"(",["T_VARIABLE","$entity",946],["T_OBJECT_OPERATOR","->",946],["T_STRING","extract",946],"(",["T_VARIABLE","$fields",946],")",")",";",["T_WHITESPACE","\n        ",946],["T_IF","if",947],["T_WHITESPACE"," ",947],"(",["T_STRING","count",947],"(",["T_VARIABLE","$values",947],")",["T_WHITESPACE"," ",947],["T_IS_IDENTICAL","===",947],["T_WHITESPACE"," ",947],["T_STRING","count",947],"(",["T_VARIABLE","$fields",947],")",")",["T_WHITESPACE"," ",947],"{",["T_WHITESPACE","\n            ",947],["T_RETURN","return",948],";",["T_WHITESPACE","\n        ",948],"}",["T_WHITESPACE","\n\n        ",949],["T_VARIABLE","$fresh",951],["T_WHITESPACE"," ",951],"=",["T_WHITESPACE"," ",951],["T_VARIABLE","$this",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","_table",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","get",951],"(",["T_VARIABLE","$entity",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","get",951],"(",["T_VARIABLE","$this",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","_getPrimaryKey",951],"(",")",")",",",["T_WHITESPACE"," ",951],["T_VARIABLE","$fields",951],")",";",["T_WHITESPACE","\n        ",951],["T_VARIABLE","$entity",952],["T_OBJECT_OPERATOR","->",952],["T_STRING","set",952],"(",["T_VARIABLE","$fresh",952],["T_OBJECT_OPERATOR","->",952],["T_STRING","extract",952],"(",["T_VARIABLE","$fields",952],")",",",["T_WHITESPACE"," ",952],"[",["T_CONSTANT_ENCAPSED_STRING","'guard'",952],["T_WHITESPACE"," ",952],["T_DOUBLE_ARROW","=>",952],["T_WHITESPACE"," ",952],["T_STRING","false",952],"]",")",";",["T_WHITESPACE","\n\n        ",952],["T_FOREACH","foreach",954],["T_WHITESPACE"," ",954],"(",["T_VARIABLE","$fields",954],["T_WHITESPACE"," ",954],["T_AS","as",954],["T_WHITESPACE"," ",954],["T_VARIABLE","$field",954],")",["T_WHITESPACE"," ",954],"{",["T_WHITESPACE","\n            ",954],["T_VARIABLE","$entity",955],["T_OBJECT_OPERATOR","->",955],["T_STRING","dirty",955],"(",["T_VARIABLE","$field",955],",",["T_WHITESPACE"," ",955],["T_STRING","false",955],")",";",["T_WHITESPACE","\n        ",955],"}",["T_WHITESPACE","\n    ",956],"}",["T_WHITESPACE","\n\n    ",957],["T_DOC_COMMENT","\/**\n     * Returns a single string value representing the primary key of the attached table\n     *\n     * @return string\n     *\/",959],["T_WHITESPACE","\n    ",963],["T_PROTECTED","protected",964],["T_WHITESPACE"," ",964],["T_FUNCTION","function",964],["T_WHITESPACE"," ",964],["T_STRING","_getPrimaryKey",964],"(",")",["T_WHITESPACE","\n    ",964],"{",["T_WHITESPACE","\n        ",965],["T_IF","if",966],["T_WHITESPACE"," ",966],"(","!",["T_VARIABLE","$this",966],["T_OBJECT_OPERATOR","->",966],["T_STRING","_primaryKey",966],")",["T_WHITESPACE"," ",966],"{",["T_WHITESPACE","\n            ",966],["T_VARIABLE","$this",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","_primaryKey",967],["T_WHITESPACE"," ",967],"=",["T_WHITESPACE"," ",967],["T_ARRAY_CAST","(array)",967],["T_VARIABLE","$this",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","_table",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","primaryKey",967],"(",")",";",["T_WHITESPACE","\n            ",967],["T_VARIABLE","$this",968],["T_OBJECT_OPERATOR","->",968],["T_STRING","_primaryKey",968],["T_WHITESPACE"," ",968],"=",["T_WHITESPACE"," ",968],["T_VARIABLE","$this",968],["T_OBJECT_OPERATOR","->",968],["T_STRING","_primaryKey",968],"[",["T_LNUMBER","0",968],"]",";",["T_WHITESPACE","\n        ",968],"}",["T_WHITESPACE","\n\n        ",969],["T_RETURN","return",971],["T_WHITESPACE"," ",971],["T_VARIABLE","$this",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","_primaryKey",971],";",["T_WHITESPACE","\n    ",971],"}",["T_WHITESPACE","\n\n    ",972],["T_DOC_COMMENT","\/**\n     * Returns the depth level of a node in the tree.\n     *\n     * @param int|string|\\Cake\\Datasource\\EntityInterface $entity The entity or primary key get the level of.\n     * @return int|bool Integer of the level or false if the node does not exist.\n     *\/",974],["T_WHITESPACE","\n    ",979],["T_PUBLIC","public",980],["T_WHITESPACE"," ",980],["T_FUNCTION","function",980],["T_WHITESPACE"," ",980],["T_STRING","getLevel",980],"(",["T_VARIABLE","$entity",980],")",["T_WHITESPACE","\n    ",980],"{",["T_WHITESPACE","\n        ",981],["T_VARIABLE","$primaryKey",982],["T_WHITESPACE"," ",982],"=",["T_WHITESPACE"," ",982],["T_VARIABLE","$this",982],["T_OBJECT_OPERATOR","->",982],["T_STRING","_getPrimaryKey",982],"(",")",";",["T_WHITESPACE","\n        ",982],["T_VARIABLE","$id",983],["T_WHITESPACE"," ",983],"=",["T_WHITESPACE"," ",983],["T_VARIABLE","$entity",983],";",["T_WHITESPACE","\n        ",983],["T_IF","if",984],["T_WHITESPACE"," ",984],"(",["T_VARIABLE","$entity",984],["T_WHITESPACE"," ",984],["T_INSTANCEOF","instanceof",984],["T_WHITESPACE"," ",984],["T_STRING","EntityInterface",984],")",["T_WHITESPACE"," ",984],"{",["T_WHITESPACE","\n            ",984],["T_VARIABLE","$id",985],["T_WHITESPACE"," ",985],"=",["T_WHITESPACE"," ",985],["T_VARIABLE","$entity",985],["T_OBJECT_OPERATOR","->",985],["T_STRING","get",985],"(",["T_VARIABLE","$primaryKey",985],")",";",["T_WHITESPACE","\n        ",985],"}",["T_WHITESPACE","\n        ",986],["T_VARIABLE","$config",987],["T_WHITESPACE"," ",987],"=",["T_WHITESPACE"," ",987],["T_VARIABLE","$this",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","config",987],"(",")",";",["T_WHITESPACE","\n        ",987],["T_VARIABLE","$entity",988],["T_WHITESPACE"," ",988],"=",["T_WHITESPACE"," ",988],["T_VARIABLE","$this",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","_table",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","find",988],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",988],")",["T_WHITESPACE","\n            ",988],["T_OBJECT_OPERATOR","->",989],["T_STRING","select",989],"(","[",["T_VARIABLE","$config",989],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",989],"]",",",["T_WHITESPACE"," ",989],["T_VARIABLE","$config",989],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",989],"]","]",")",["T_WHITESPACE","\n            ",989],["T_OBJECT_OPERATOR","->",990],["T_STRING","where",990],"(","[",["T_VARIABLE","$primaryKey",990],["T_WHITESPACE"," ",990],["T_DOUBLE_ARROW","=>",990],["T_WHITESPACE"," ",990],["T_VARIABLE","$id",990],"]",")",["T_WHITESPACE","\n            ",990],["T_OBJECT_OPERATOR","->",991],["T_STRING","first",991],"(",")",";",["T_WHITESPACE","\n\n        ",991],["T_IF","if",993],["T_WHITESPACE"," ",993],"(",["T_VARIABLE","$entity",993],["T_WHITESPACE"," ",993],["T_IS_IDENTICAL","===",993],["T_WHITESPACE"," ",993],["T_STRING","null",993],")",["T_WHITESPACE"," ",993],"{",["T_WHITESPACE","\n            ",993],["T_RETURN","return",994],["T_WHITESPACE"," ",994],["T_STRING","false",994],";",["T_WHITESPACE","\n        ",994],"}",["T_WHITESPACE","\n\n        ",995],["T_VARIABLE","$query",997],["T_WHITESPACE"," ",997],"=",["T_WHITESPACE"," ",997],["T_VARIABLE","$this",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","_table",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","find",997],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",997],")",["T_OBJECT_OPERATOR","->",997],["T_STRING","where",997],"(","[",["T_WHITESPACE","\n            ",997],["T_VARIABLE","$config",998],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",998],"]",["T_WHITESPACE"," ",998],".",["T_WHITESPACE"," ",998],["T_CONSTANT_ENCAPSED_STRING","' <'",998],["T_WHITESPACE"," ",998],["T_DOUBLE_ARROW","=>",998],["T_WHITESPACE"," ",998],["T_VARIABLE","$entity",998],"[",["T_VARIABLE","$config",998],"[",["T_CONSTANT_ENCAPSED_STRING","'left'",998],"]","]",",",["T_WHITESPACE","\n            ",998],["T_VARIABLE","$config",999],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",999],"]",["T_WHITESPACE"," ",999],".",["T_WHITESPACE"," ",999],["T_CONSTANT_ENCAPSED_STRING","' >'",999],["T_WHITESPACE"," ",999],["T_DOUBLE_ARROW","=>",999],["T_WHITESPACE"," ",999],["T_VARIABLE","$entity",999],"[",["T_VARIABLE","$config",999],"[",["T_CONSTANT_ENCAPSED_STRING","'right'",999],"]","]",",",["T_WHITESPACE","\n        ",999],"]",")",";",["T_WHITESPACE","\n\n        ",1000],["T_RETURN","return",1002],["T_WHITESPACE"," ",1002],["T_VARIABLE","$this",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","_scope",1002],"(",["T_VARIABLE","$query",1002],")",["T_OBJECT_OPERATOR","->",1002],["T_STRING","count",1002],"(",")",";",["T_WHITESPACE","\n    ",1002],"}",["T_WHITESPACE","\n",1003],"}",["T_WHITESPACE","\n",1004]]