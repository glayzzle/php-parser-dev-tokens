[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ORM",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Datasource",17],["T_NS_SEPARATOR","\\",17],["T_STRING","RulesChecker",17],["T_WHITESPACE"," ",17],["T_AS","as",17],["T_WHITESPACE"," ",17],["T_STRING","BaseRulesChecker",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ORM",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Rule",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ExistsIn",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","ORM",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Rule",19],["T_NS_SEPARATOR","\\",19],["T_STRING","IsUnique",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","ORM",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Rule",20],["T_NS_SEPARATOR","\\",20],["T_STRING","ValidCount",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * ORM flavoured rules checker.\n *\n * Adds ORM related features to the RulesChecker class.\n *\n * @see \\Cake\\Datasource\\RulesChecker\n *\/",22],["T_WHITESPACE","\n",28],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","RulesChecker",29],["T_WHITESPACE"," ",29],["T_EXTENDS","extends",29],["T_WHITESPACE"," ",29],["T_STRING","BaseRulesChecker",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Returns a callable that can be used as a rule for checking the uniqueness of a value\n     * in the table.\n     *\n     * ### Example:\n     *\n     * ```\n     * $rules->add($rules->isUnique(['email'], 'The email should be unique'));\n     * ```\n     *\n     * @param array $fields The list of fields to check for uniqueness.\n     * @param string|array|null $message The error message to show in case the rule does not pass. Can\n     *   also be an array of options. When an array, the 'message' key can be used to provide a message.\n     * @return callable\n     *\/",32],["T_WHITESPACE","\n    ",46],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","isUnique",47],"(",["T_ARRAY","array",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$fields",47],",",["T_WHITESPACE"," ",47],["T_VARIABLE","$message",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$options",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],"[","]",";",["T_WHITESPACE","\n        ",49],["T_IF","if",50],["T_WHITESPACE"," ",50],"(",["T_STRING","is_array",50],"(",["T_VARIABLE","$message",50],")",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$options",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$message",51],["T_WHITESPACE"," ",51],"+",["T_WHITESPACE"," ",51],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_STRING","null",51],"]",";",["T_WHITESPACE","\n            ",51],["T_VARIABLE","$message",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$options",52],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",52],"]",";",["T_WHITESPACE","\n            ",52],["T_UNSET","unset",53],"(",["T_VARIABLE","$options",53],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",53],"]",")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n        ",54],["T_IF","if",55],["T_WHITESPACE"," ",55],"(","!",["T_VARIABLE","$message",55],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_useI18n",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n                ",56],["T_VARIABLE","$message",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","__d",57],"(",["T_CONSTANT_ENCAPSED_STRING","'cake'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'This value is already in use'",57],")",";",["T_WHITESPACE","\n            ",57],"}",["T_WHITESPACE"," ",58],["T_ELSE","else",58],["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$message",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'This value is already in use'",59],";",["T_WHITESPACE","\n            ",59],"}",["T_WHITESPACE","\n        ",60],"}",["T_WHITESPACE","\n\n        ",61],["T_VARIABLE","$errorField",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","current",63],"(",["T_VARIABLE","$fields",63],")",";",["T_WHITESPACE","\n\n        ",63],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_addError",65],"(",["T_NEW","new",65],["T_WHITESPACE"," ",65],["T_STRING","IsUnique",65],"(",["T_VARIABLE","$fields",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$options",65],")",",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'_isUnique'",65],",",["T_WHITESPACE"," ",65],["T_STRING","compact",65],"(",["T_CONSTANT_ENCAPSED_STRING","'errorField'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'message'",65],")",")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Returns a callable that can be used as a rule for checking that the values\n     * extracted from the entity to check exist as the primary key in another table.\n     *\n     * This is useful for enforcing foreign key integrity checks.\n     *\n     * ### Example:\n     *\n     * ```\n     * $rules->add($rules->existsIn('author_id', 'Authors', 'Invalid Author'));\n     *\n     * $rules->add($rules->existsIn('site_id', new SitesTable(), 'Invalid Site'));\n     * ```\n     *\n     * Available $options are error 'message' and 'allowNullableNulls' flag.\n     * 'message' sets a custom error message.\n     * Set 'allowNullableNulls' to true to accept composite foreign keys where one or more nullable columns are null.\n     *\n     * @param string|array $field The field or list of fields to check for existence by\n     * primary key lookup in the other table.\n     * @param object|string $table The table name where the fields existence will be checked.\n     * @param string|array|null $message The error message to show in case the rule does not pass. Can\n     *   also be an array of options. When an array, the 'message' key can be used to provide a message.\n     * @return callable\n     *\/",68],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","existsIn",93],"(",["T_VARIABLE","$field",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$table",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$message",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","null",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$options",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],"[","]",";",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_STRING","is_array",96],"(",["T_VARIABLE","$message",96],")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$options",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$message",97],["T_WHITESPACE"," ",97],"+",["T_WHITESPACE"," ",97],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_STRING","null",97],"]",";",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$message",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$options",98],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",98],"]",";",["T_WHITESPACE","\n            ",98],["T_UNSET","unset",99],"(",["T_VARIABLE","$options",99],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",99],"]",")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_VARIABLE","$message",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_useI18n",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$message",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","__d",104],"(",["T_CONSTANT_ENCAPSED_STRING","'cake'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'This value does not exist'",104],")",";",["T_WHITESPACE","\n            ",104],"}",["T_WHITESPACE"," ",105],["T_ELSE","else",105],["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                ",105],["T_VARIABLE","$message",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'This value does not exist'",106],";",["T_WHITESPACE","\n            ",106],"}",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$errorField",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","is_string",110],"(",["T_VARIABLE","$field",110],")",["T_WHITESPACE"," ",110],"?",["T_WHITESPACE"," ",110],["T_VARIABLE","$field",110],["T_WHITESPACE"," ",110],":",["T_WHITESPACE"," ",110],["T_STRING","current",110],"(",["T_VARIABLE","$field",110],")",";",["T_WHITESPACE","\n\n        ",110],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_addError",112],"(",["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_STRING","ExistsIn",112],"(",["T_VARIABLE","$field",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$table",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$options",112],")",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'_existsIn'",112],",",["T_WHITESPACE"," ",112],["T_STRING","compact",112],"(",["T_CONSTANT_ENCAPSED_STRING","'errorField'",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'message'",112],")",")",";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Validates the count of associated records.\n     *\n     * @param string $field The field to check the count on.\n     * @param int $count The expected count.\n     * @param string $operator The operator for the count comparison.\n     * @param string|null $message The error message to show in case the rule does not pass.\n     * @return callable\n     *\/",115],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","validCount",124],"(",["T_VARIABLE","$field",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$count",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_LNUMBER","0",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$operator",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'>'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$message",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","null",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(","!",["T_VARIABLE","$message",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_useI18n",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$message",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","__d",128],"(",["T_CONSTANT_ENCAPSED_STRING","'cake'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'The count does not match {0}{1}'",128],",",["T_WHITESPACE"," ",128],"[",["T_VARIABLE","$operator",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$count",128],"]",")",";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$message",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","sprintf",130],"(",["T_CONSTANT_ENCAPSED_STRING","'The count does not match %s%d'",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$operator",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$count",130],")",";",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n\n        ",132],["T_VARIABLE","$errorField",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$field",134],";",["T_WHITESPACE","\n\n        ",134],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_addError",136],"(",["T_NEW","new",136],["T_WHITESPACE"," ",136],["T_STRING","ValidCount",136],"(",["T_VARIABLE","$field",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$count",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$operator",136],")",",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'_validCount'",136],",",["T_WHITESPACE"," ",136],["T_STRING","compact",136],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'operator'",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'errorField'",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'message'",136],")",")",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n",137],"}",["T_WHITESPACE","\n",138]]