[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ORM",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Rule",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Datasource",17],["T_NS_SEPARATOR","\\",17],["T_STRING","EntityInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ORM",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Association",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","RuntimeException",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * Checks that the value provided in a field exists as the primary key of another\n * table.\n *\/",21],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","ExistsIn",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * The list of fields to check\n     *\n     * @var array\n     *\/",28],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$_fields",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * The repository where the field will be looked for\n     *\n     * @var array\n     *\/",35],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$_repository",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Options for the constructor\n     *\n     * @var array\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_options",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],"[","]",";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * Available option for $options is 'allowNullableNulls' flag.\n     * Set to true to accept composite foreign keys where one or more nullable columns are null.\n     *\n     * @param string|array $fields The field or fields to check existence as primary key.\n     * @param object|string $repository The repository where the field will be looked for,\n     * or the association name for the repository.\n     * @param array $options The options that modify the rules behavior.\n     *\/",49],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","__construct",60],"(",["T_VARIABLE","$fields",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$repository",60],",",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$options",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],"[","]",")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$options",62],["T_WHITESPACE"," ",62],["T_PLUS_EQUAL","+=",62],["T_WHITESPACE"," ",62],"[",["T_CONSTANT_ENCAPSED_STRING","'allowNullableNulls'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_STRING","false",62],"]",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_options",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$options",63],";",["T_WHITESPACE","\n\n        ",63],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_fields",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_ARRAY_CAST","(array)",65],["T_VARIABLE","$fields",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_repository",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$repository",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Performs the existence check\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity from where to extract the fields\n     * @param array $options Options passed to the check,\n     * where the `repository` key is required.\n     * @throws \\RuntimeException When the rule refers to an undefined association.\n     * @return bool\n     *\/",69],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","__invoke",78],"(",["T_STRING","EntityInterface",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$entity",78],",",["T_WHITESPACE"," ",78],["T_ARRAY","array",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$options",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","is_string",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_repository",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$repository",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$options",81],"[",["T_CONSTANT_ENCAPSED_STRING","'repository'",81],"]",["T_OBJECT_OPERATOR","->",81],["T_STRING","association",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_repository",81],")",";",["T_WHITESPACE","\n            ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(","!",["T_VARIABLE","$repository",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                ",82],["T_THROW","throw",83],["T_WHITESPACE"," ",83],["T_NEW","new",83],["T_WHITESPACE"," ",83],["T_STRING","RuntimeException",83],"(",["T_STRING","sprintf",83],"(",["T_WHITESPACE","\n                    ",83],["T_CONSTANT_ENCAPSED_STRING","\"ExistsIn rule for '%s' is invalid. '%s' is not associated with '%s'.\"",84],",",["T_WHITESPACE","\n                    ",84],["T_STRING","implode",85],"(",["T_CONSTANT_ENCAPSED_STRING","', '",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_fields",85],")",",",["T_WHITESPACE","\n                    ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_repository",86],",",["T_WHITESPACE","\n                    ",86],["T_STRING","get_class",87],"(",["T_VARIABLE","$options",87],"[",["T_CONSTANT_ENCAPSED_STRING","'repository'",87],"]",")",["T_WHITESPACE","\n                ",87],")",")",";",["T_WHITESPACE","\n            ",88],"}",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_repository",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$repository",90],";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$source",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$target",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_repository",93],";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$isAssociation",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$target",94],["T_WHITESPACE"," ",94],["T_INSTANCEOF","instanceof",94],["T_WHITESPACE"," ",94],["T_STRING","Association",94],";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$bindingKey",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$isAssociation",95],["T_WHITESPACE"," ",95],"?",["T_WHITESPACE"," ",95],["T_ARRAY_CAST","(array)",95],["T_VARIABLE","$target",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","bindingKey",95],"(",")",["T_WHITESPACE"," ",95],":",["T_WHITESPACE"," ",95],["T_ARRAY_CAST","(array)",95],["T_VARIABLE","$target",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","primaryKey",95],"(",")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$realTarget",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$isAssociation",96],["T_WHITESPACE"," ",96],"?",["T_WHITESPACE"," ",96],["T_VARIABLE","$target",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","target",96],"(",")",["T_WHITESPACE"," ",96],":",["T_WHITESPACE"," ",96],["T_VARIABLE","$target",96],";",["T_WHITESPACE","\n\n        ",96],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_EMPTY","empty",98],"(",["T_VARIABLE","$options",98],"[",["T_CONSTANT_ENCAPSED_STRING","'_sourceTable'",98],"]",")",["T_WHITESPACE"," ",98],["T_BOOLEAN_AND","&&",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$realTarget",98],["T_WHITESPACE"," ",98],["T_IS_IDENTICAL","===",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$options",98],"[",["T_CONSTANT_ENCAPSED_STRING","'_sourceTable'",98],"]",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_STRING","true",99],";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_EMPTY","empty",102],"(",["T_VARIABLE","$options",102],"[",["T_CONSTANT_ENCAPSED_STRING","'repository'",102],"]",")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$source",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$options",103],"[",["T_CONSTANT_ENCAPSED_STRING","'repository'",103],"]",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$source",105],["T_WHITESPACE"," ",105],["T_INSTANCEOF","instanceof",105],["T_WHITESPACE"," ",105],["T_STRING","Association",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$source",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$source",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","source",106],"(",")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_VARIABLE","$entity",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","extract",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_fields",109],",",["T_WHITESPACE"," ",109],["T_STRING","true",109],")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_STRING","true",110],";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n\n        ",111],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_fieldsAreNull",113],"(",["T_VARIABLE","$entity",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$source",113],")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","true",114],";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n\n        ",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_options",117],"[",["T_CONSTANT_ENCAPSED_STRING","'allowNullableNulls'",117],"]",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$schema",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$source",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","schema",118],"(",")",";",["T_WHITESPACE","\n            ",118],["T_FOREACH","foreach",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_fields",119],["T_WHITESPACE"," ",119],["T_AS","as",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$i",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$field",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$schema",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","column",120],"(",["T_VARIABLE","$field",120],")",["T_WHITESPACE"," ",120],["T_BOOLEAN_AND","&&",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$schema",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","isNullable",120],"(",["T_VARIABLE","$field",120],")",["T_WHITESPACE"," ",120],["T_BOOLEAN_AND","&&",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$entity",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","get",120],"(",["T_VARIABLE","$field",120],")",["T_WHITESPACE"," ",120],["T_IS_IDENTICAL","===",120],["T_WHITESPACE"," ",120],["T_STRING","null",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                    ",120],["T_UNSET","unset",121],"(",["T_VARIABLE","$bindingKey",121],"[",["T_VARIABLE","$i",121],"]",")",";",["T_WHITESPACE","\n                    ",121],["T_UNSET","unset",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_fields",122],"[",["T_VARIABLE","$i",122],"]",")",";",["T_WHITESPACE","\n                ",122],"}",["T_WHITESPACE","\n            ",123],"}",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$primary",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","array_map",127],"(",["T_WHITESPACE","\n            ",127],"[",["T_VARIABLE","$target",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'aliasField'",128],"]",",",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$bindingKey",129],["T_WHITESPACE","\n        ",129],")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$conditions",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","array_combine",131],"(",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$primary",132],",",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$entity",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","extract",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_fields",133],")",["T_WHITESPACE","\n        ",133],")",";",["T_WHITESPACE","\n\n        ",134],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$target",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","exists",136],"(",["T_VARIABLE","$conditions",136],")",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Checks whether or not the given entity fields are nullable and null.\n     *\n     * @param \\Cake\\Datasource\\EntityInterface $entity The entity to check.\n     * @param \\Cake\\ORM\\Table $source The table to use schema from.\n     * @return bool\n     *\/",139],["T_WHITESPACE","\n    ",145],["T_PROTECTED","protected",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","_fieldsAreNull",146],"(",["T_VARIABLE","$entity",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$source",146],")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$nulls",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_LNUMBER","0",148],";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$schema",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$source",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","schema",149],"(",")",";",["T_WHITESPACE","\n        ",149],["T_FOREACH","foreach",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_fields",150],["T_WHITESPACE"," ",150],["T_AS","as",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$field",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$schema",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","column",151],"(",["T_VARIABLE","$field",151],")",["T_WHITESPACE"," ",151],["T_BOOLEAN_AND","&&",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$schema",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","isNullable",151],"(",["T_VARIABLE","$field",151],")",["T_WHITESPACE"," ",151],["T_BOOLEAN_AND","&&",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$entity",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","get",151],"(",["T_VARIABLE","$field",151],")",["T_WHITESPACE"," ",151],["T_IS_IDENTICAL","===",151],["T_WHITESPACE"," ",151],["T_STRING","null",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$nulls",152],["T_INC","++",152],";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n        ",154],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$nulls",156],["T_WHITESPACE"," ",156],["T_IS_IDENTICAL","===",156],["T_WHITESPACE"," ",156],["T_STRING","count",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_fields",156],")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n",157],"}",["T_WHITESPACE","\n",158]]