[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Datasource",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Cache",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Cache",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Cache",18],["T_NS_SEPARATOR","\\",18],["T_STRING","CacheEngine",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","RuntimeException",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Traversable",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * Handles caching queries and loading results from the cache.\n *\n * Used by Cake\\Datasource\\QueryTrait internally.\n *\n * @see \\Cake\\Datasource\\QueryTrait::cache() for the public interface.\n *\/",22],["T_WHITESPACE","\n",28],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","QueryCacher",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * @param string|\\Closure $key The key or function to generate a key.\n     * @param string|\\Cake\\Cache\\CacheEngine $config The cache config name or cache engine instance.\n     * @throws \\RuntimeException\n     *\/",32],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_VARIABLE","$key",39],",",["T_WHITESPACE"," ",39],["T_VARIABLE","$config",39],")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_IF","if",41],["T_WHITESPACE"," ",41],"(","!",["T_STRING","is_string",41],"(",["T_VARIABLE","$key",41],")",["T_WHITESPACE"," ",41],["T_BOOLEAN_AND","&&",41],["T_WHITESPACE"," ",41],"!",["T_STRING","is_callable",41],"(",["T_VARIABLE","$key",41],")",")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n            ",41],["T_THROW","throw",42],["T_WHITESPACE"," ",42],["T_NEW","new",42],["T_WHITESPACE"," ",42],["T_STRING","RuntimeException",42],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache keys must be strings or callables.'",42],")",";",["T_WHITESPACE","\n        ",42],"}",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","_key",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$key",44],";",["T_WHITESPACE","\n\n        ",44],["T_IF","if",46],["T_WHITESPACE"," ",46],"(","!",["T_STRING","is_string",46],"(",["T_VARIABLE","$config",46],")",["T_WHITESPACE"," ",46],["T_BOOLEAN_AND","&&",46],["T_WHITESPACE"," ",46],"!","(",["T_VARIABLE","$config",46],["T_WHITESPACE"," ",46],["T_INSTANCEOF","instanceof",46],["T_WHITESPACE"," ",46],["T_STRING","CacheEngine",46],")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_THROW","throw",47],["T_WHITESPACE"," ",47],["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_STRING","RuntimeException",47],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache configs must be strings or CacheEngine instances.'",47],")",";",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_config",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$config",49],";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Load the cached results from the cache or run the query.\n     *\n     * @param object $query The query the cache read is for.\n     * @return \\Cake\\ORM\\ResultSet|null Either the cached results or null.\n     *\/",52],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","fetch",58],"(",["T_VARIABLE","$query",58],")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$key",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_resolveKey",60],"(",["T_VARIABLE","$query",60],")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$storage",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_resolveCacher",61],"(",")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$result",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$storage",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","read",62],"(",["T_VARIABLE","$key",62],")",";",["T_WHITESPACE","\n        ",62],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_EMPTY","empty",63],"(",["T_VARIABLE","$result",63],")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n            ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_STRING","null",64],";",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n\n        ",65],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$result",67],";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Store the result set into the cache.\n     *\n     * @param object $query The query the cache read is for.\n     * @param \\Traversable $results The result set to store.\n     * @return bool True if the data was successfully cached, false on failure\n     *\/",70],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","store",77],"(",["T_VARIABLE","$query",77],",",["T_WHITESPACE"," ",77],["T_STRING","Traversable",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$results",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$key",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_resolveKey",79],"(",["T_VARIABLE","$query",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$storage",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_resolveCacher",80],"(",")",";",["T_WHITESPACE","\n\n        ",80],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$storage",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","write",82],"(",["T_VARIABLE","$key",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$results",82],")",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Get\/generate the cache key.\n     *\n     * @param object $query The query to generate a key for.\n     * @return string\n     * @throws \\RuntimeException\n     *\/",85],["T_WHITESPACE","\n    ",91],["T_PROTECTED","protected",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","_resolveKey",92],"(",["T_VARIABLE","$query",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","is_string",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_key",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_key",95],";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$func",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_key",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$key",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$func",98],"(",["T_VARIABLE","$query",98],")",";",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_STRING","is_string",99],"(",["T_VARIABLE","$key",99],")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$msg",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","sprintf",100],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache key functions must return a string. Got %s.'",100],",",["T_WHITESPACE"," ",100],["T_STRING","var_export",100],"(",["T_VARIABLE","$key",100],",",["T_WHITESPACE"," ",100],["T_STRING","true",100],")",")",";",["T_WHITESPACE","\n            ",100],["T_THROW","throw",101],["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_STRING","RuntimeException",101],"(",["T_VARIABLE","$msg",101],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$key",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Get the cache engine.\n     *\n     * @return \\Cake\\Cache\\CacheEngine\n     *\/",107],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","_resolveCacher",112],"(",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_STRING","is_string",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_config",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_STRING","Cache",115],["T_DOUBLE_COLON","::",115],["T_STRING","engine",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_config",115],")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n\n        ",116],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_config",118],";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n",119],"}",["T_WHITESPACE","\n",120]]