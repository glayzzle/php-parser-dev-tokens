[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @since         3.3.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",13],["T_NAMESPACE","namespace",14],["T_WHITESPACE"," ",14],["T_STRING","Cake",14],["T_NS_SEPARATOR","\\",14],["T_STRING","TestSuite",14],";",["T_WHITESPACE","\n\n",14],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Cake",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Core",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Configure",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Event",17],["T_NS_SEPARATOR","\\",17],["T_STRING","EventManager",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Http",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ResponseTransformer",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Http",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Server",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Http",20],["T_NS_SEPARATOR","\\",20],["T_STRING","ServerRequestFactory",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","LogicException",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","ReflectionClass",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","ReflectionException",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Zend",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Diactoros",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Stream",24],";",["T_WHITESPACE","\n\n",24],["T_DOC_COMMENT","\/**\n * Dispatches a request capturing the response for integration\n * testing purposes into the Cake\\Http stack.\n *\n * @internal\n *\/",26],["T_WHITESPACE","\n",31],["T_CLASS","class",32],["T_WHITESPACE"," ",32],["T_STRING","MiddlewareDispatcher",32],["T_WHITESPACE","\n",32],"{",["T_WHITESPACE","\n    ",33],["T_DOC_COMMENT","\/**\n     * The test case being run.\n     *\n     * @var \\Cake\\TestSuite\\IntegrationTestCase\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$_test",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * The application class name\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_class",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Constructor arguments for your application class.\n     *\n     * @var array\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$_constructorArgs",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param \\Cake\\TestSuite\\IntegrationTestCase $test The test case to run.\n     * @param string|null $class The application class name. Defaults to App\\Application.\n     * @param array|null $constructorArgs The constructor arguments for your application class.\n     *   Defaults to `['.\/config']`\n     *\/",55],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","__construct",63],"(",["T_VARIABLE","$test",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$class",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","null",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$constructorArgs",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","null",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_test",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$test",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_class",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$class",66],["T_WHITESPACE"," ",66],"?",":",["T_WHITESPACE"," ",66],["T_STRING","Configure",66],["T_DOUBLE_COLON","::",66],["T_STRING","read",66],"(",["T_CONSTANT_ENCAPSED_STRING","'App.namespace'",66],")",["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'\\Application'",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_constructorArgs",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$constructorArgs",67],["T_WHITESPACE"," ",67],"?",":",["T_WHITESPACE"," ",67],"[",["T_CONSTANT_ENCAPSED_STRING","'.\/config'",67],"]",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Run a request and get the response.\n     *\n     * @param \\Cake\\Network\\Request $request The request to execute.\n     * @return \\Cake\\Network\\Response The generated response.\n     *\/",70],["T_WHITESPACE","\n    ",75],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","execute",76],"(",["T_VARIABLE","$request",76],")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_TRY","try",78],["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$reflect",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_STRING","ReflectionClass",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_class",79],")",";",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$app",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$reflect",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","newInstanceArgs",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_constructorArgs",80],")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE"," ",81],["T_CATCH","catch",81],["T_WHITESPACE"," ",81],"(",["T_STRING","ReflectionException",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$e",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_THROW","throw",82],["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","LogicException",82],"(",["T_STRING","sprintf",82],"(",["T_WHITESPACE","\n                ",82],["T_CONSTANT_ENCAPSED_STRING","'Cannot load \"%s\" for use in integration testing.'",83],",",["T_WHITESPACE","\n                ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_class",84],["T_WHITESPACE","\n            ",84],")",")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n\n        ",86],["T_COMMENT","\/\/ Spy on the controller using the initialize hook instead\n",88],["T_WHITESPACE","        ",89],["T_COMMENT","\/\/ of the dispatcher hooks as those will be going away one day.\n",89],["T_WHITESPACE","        ",90],["T_STRING","EventManager",90],["T_DOUBLE_COLON","::",90],["T_STRING","instance",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","on",90],"(",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","'Controller.initialize'",91],",",["T_WHITESPACE","\n            ",91],"[",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_test",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'controllerSpy'",92],"]",["T_WHITESPACE","\n        ",92],")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$server",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_STRING","Server",95],"(",["T_VARIABLE","$app",95],")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$psrRequest",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_createRequest",96],"(",["T_VARIABLE","$request",96],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$response",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$server",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","run",97],"(",["T_VARIABLE","$psrRequest",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_STRING","ResponseTransformer",99],["T_DOUBLE_COLON","::",99],["T_STRING","toCake",99],"(",["T_VARIABLE","$response",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Create a PSR7 request from the request spec.\n     *\n     * @param array $spec The request spec.\n     * @return Psr\\Http\\Message\\RequestInterface\n     *\/",102],["T_WHITESPACE","\n    ",107],["T_PROTECTED","protected",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","_createRequest",108],"(",["T_VARIABLE","$spec",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_ISSET","isset",110],"(",["T_VARIABLE","$spec",110],"[",["T_CONSTANT_ENCAPSED_STRING","'input'",110],"]",")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$spec",111],"[",["T_CONSTANT_ENCAPSED_STRING","'post'",111],"]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],"[","]",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$request",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","ServerRequestFactory",113],["T_DOUBLE_COLON","::",113],["T_STRING","fromGlobals",113],"(",["T_WHITESPACE","\n            ",113],["T_STRING","array_merge",114],"(",["T_VARIABLE","$_SERVER",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$spec",114],"[",["T_CONSTANT_ENCAPSED_STRING","'environment'",114],"]",",",["T_WHITESPACE"," ",114],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_URI'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$spec",114],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",114],"]","]",")",",",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$spec",115],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",115],"]",",",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$spec",116],"[",["T_CONSTANT_ENCAPSED_STRING","'post'",116],"]",",",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$spec",117],"[",["T_CONSTANT_ENCAPSED_STRING","'cookies'",117],"]",["T_WHITESPACE","\n        ",117],")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$request",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$request",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","withAttribute",119],"(",["T_CONSTANT_ENCAPSED_STRING","'session'",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$spec",119],"[",["T_CONSTANT_ENCAPSED_STRING","'session'",119],"]",")",";",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_ISSET","isset",121],"(",["T_VARIABLE","$spec",121],"[",["T_CONSTANT_ENCAPSED_STRING","'input'",121],"]",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$stream",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","Stream",122],"(",["T_CONSTANT_ENCAPSED_STRING","'php:\/\/memory'",122],",",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'rw'",122],")",";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$stream",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","write",123],"(",["T_VARIABLE","$spec",123],"[",["T_CONSTANT_ENCAPSED_STRING","'input'",123],"]",")",";",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$stream",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","rewind",124],"(",")",";",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$request",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$request",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","withBody",125],"(",["T_VARIABLE","$stream",125],")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n\n        ",126],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$request",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n",129],"}",["T_WHITESPACE","\n",130]]