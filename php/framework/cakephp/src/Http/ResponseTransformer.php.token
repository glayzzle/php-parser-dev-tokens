[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.3.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Http",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Network",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Response",17],["T_WHITESPACE"," ",17],["T_AS","as",17],["T_WHITESPACE"," ",17],["T_STRING","CakeResponse",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Psr",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Http",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Message",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ResponseInterface",18],["T_WHITESPACE"," ",18],["T_AS","as",18],["T_WHITESPACE"," ",18],["T_STRING","PsrResponse",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Zend",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Diactoros",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Response",19],["T_WHITESPACE"," ",19],["T_AS","as",19],["T_WHITESPACE"," ",19],["T_STRING","DiactorosResponse",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Zend",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Diactoros",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Stream",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * This class converts PSR7 responses into CakePHP ones and back again.\n *\n * By bridging the CakePHP and PSR7 responses together, applications\n * can be embedded as PSR7 middleware in a fully compatible way.\n *\n * @internal\n *\/",22],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","ResponseTransformer",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * Convert a PSR7 Response into a CakePHP one.\n     *\n     * @param \\Psr\\Http\\Message\\ResponseInterface $response The response to convert.\n     * @return \\Cake\\Network\\Response The equivalent CakePHP response\n     *\/",32],["T_WHITESPACE","\n    ",37],["T_PUBLIC","public",38],["T_WHITESPACE"," ",38],["T_STATIC","static",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","toCake",38],"(",["T_STRING","PsrResponse",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$response",38],")",["T_WHITESPACE","\n    ",38],"{",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$body",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STATIC","static",40],["T_DOUBLE_COLON","::",40],["T_STRING","getBody",40],"(",["T_VARIABLE","$response",40],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$data",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],"[",["T_WHITESPACE","\n            ",41],["T_CONSTANT_ENCAPSED_STRING","'status'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$response",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getStatusCode",42],"(",")",",",["T_WHITESPACE","\n            ",42],["T_CONSTANT_ENCAPSED_STRING","'body'",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$body",43],"[",["T_CONSTANT_ENCAPSED_STRING","'body'",43],"]",",",["T_WHITESPACE","\n        ",43],"]",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$cake",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_NEW","new",45],["T_WHITESPACE"," ",45],["T_STRING","CakeResponse",45],"(",["T_VARIABLE","$data",45],")",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$body",46],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",46],"]",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$cake",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","file",47],"(",["T_VARIABLE","$body",47],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",47],"]",")",";",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$cookies",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STATIC","static",49],["T_DOUBLE_COLON","::",49],["T_STRING","parseCookies",49],"(",["T_VARIABLE","$response",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getHeader",49],"(",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",49],")",")",";",["T_WHITESPACE","\n        ",49],["T_FOREACH","foreach",50],["T_WHITESPACE"," ",50],"(",["T_VARIABLE","$cookies",50],["T_WHITESPACE"," ",50],["T_AS","as",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$cookie",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$cake",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","cookie",51],"(",["T_VARIABLE","$cookie",51],")",";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$headers",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STATIC","static",53],["T_DOUBLE_COLON","::",53],["T_STRING","collapseHeaders",53],"(",["T_VARIABLE","$response",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$cake",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","header",54],"(",["T_VARIABLE","$headers",54],")",";",["T_WHITESPACE","\n\n        ",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(","!",["T_EMPTY","empty",56],"(",["T_VARIABLE","$headers",56],"[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",56],"]",")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$cake",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","type",57],"(",["T_VARIABLE","$headers",57],"[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",57],"]",")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n\n        ",58],["T_RETURN","return",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$cake",60],";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Get the response body from a PSR7 Response.\n     *\n     * @param \\Psr\\Http\\Message\\ResponseInterface $response The response to convert.\n     * @return array A hash of 'body' and 'file'\n     *\/",63],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_STATIC","static",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","getBody",69],"(",["T_STRING","PsrResponse",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$response",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$stream",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$response",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getBody",71],"(",")",";",["T_WHITESPACE","\n        ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$stream",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getMetadata",72],"(",["T_CONSTANT_ENCAPSED_STRING","'wrapper_type'",72],")",["T_WHITESPACE"," ",72],["T_IS_IDENTICAL","===",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'plainfile'",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],"[",["T_CONSTANT_ENCAPSED_STRING","'body'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","''",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'file'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$stream",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getMetadata",73],"(",["T_CONSTANT_ENCAPSED_STRING","'uri'",73],")","]",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n        ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$stream",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getSize",75],"(",")",["T_WHITESPACE"," ",75],["T_IS_IDENTICAL","===",75],["T_WHITESPACE"," ",75],["T_LNUMBER","0",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],"[",["T_CONSTANT_ENCAPSED_STRING","'body'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","''",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'file'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_STRING","false",76],"]",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$stream",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","rewind",78],"(",")",";",["T_WHITESPACE","\n\n        ",78],["T_RETURN","return",80],["T_WHITESPACE"," ",80],"[",["T_CONSTANT_ENCAPSED_STRING","'body'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$stream",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getContents",80],"(",")",",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'file'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_STRING","false",80],"]",";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Parse the Set-Cookie headers in a PSR7 response\n     * into the format CakePHP expects.\n     *\n     * @param array $cookieHeader A list of Set-Cookie headers.\n     * @return array Parsed cookie data.\n     *\/",83],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_STATIC","static",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","parseCookies",90],"(",["T_ARRAY","array",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$cookieHeader",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$cookies",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],"[","]",";",["T_WHITESPACE","\n        ",92],["T_FOREACH","foreach",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$cookieHeader",93],["T_WHITESPACE"," ",93],["T_AS","as",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$cookie",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","strpos",94],"(",["T_VARIABLE","$cookie",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'\";\"'",94],")",["T_WHITESPACE"," ",94],["T_IS_NOT_IDENTICAL","!==",94],["T_WHITESPACE"," ",94],["T_STRING","false",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$cookie",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","str_replace",95],"(",["T_CONSTANT_ENCAPSED_STRING","'\";\"'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","\"{__cookie_replace__}\"",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$cookie",95],")",";",["T_WHITESPACE","\n                ",95],["T_VARIABLE","$parts",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","preg_split",96],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\;[ \\t]*\/'",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$cookie",96],")",";",["T_WHITESPACE","\n                ",96],["T_VARIABLE","$parts",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","str_replace",97],"(",["T_CONSTANT_ENCAPSED_STRING","\"{__cookie_replace__}\"",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'\";\"'",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$parts",97],")",";",["T_WHITESPACE","\n            ",97],"}",["T_WHITESPACE"," ",98],["T_ELSE","else",98],["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n                ",98],["T_VARIABLE","$parts",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","preg_split",99],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\;[ \\t]*\/'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$cookie",99],")",";",["T_WHITESPACE","\n            ",99],"}",["T_WHITESPACE","\n\n            ",100],["T_LIST","list",102],"(",["T_VARIABLE","$name",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$value",102],")",["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","explode",102],"(",["T_CONSTANT_ENCAPSED_STRING","'='",102],",",["T_WHITESPACE"," ",102],["T_STRING","array_shift",102],"(",["T_VARIABLE","$parts",102],")",",",["T_WHITESPACE"," ",102],["T_LNUMBER","2",102],")",";",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$parsed",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$name",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'value'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_STRING","urldecode",103],"(",["T_VARIABLE","$value",103],")","]",";",["T_WHITESPACE","\n\n            ",103],["T_FOREACH","foreach",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$parts",105],["T_WHITESPACE"," ",105],["T_AS","as",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$part",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_STRING","strpos",106],"(",["T_VARIABLE","$part",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'='",106],")",["T_WHITESPACE"," ",106],["T_IS_NOT_IDENTICAL","!==",106],["T_WHITESPACE"," ",106],["T_STRING","false",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                    ",106],["T_LIST","list",107],"(",["T_VARIABLE","$key",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$value",107],")",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","explode",107],"(",["T_CONSTANT_ENCAPSED_STRING","'='",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$part",107],")",";",["T_WHITESPACE","\n                ",107],"}",["T_WHITESPACE"," ",108],["T_ELSE","else",108],["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                    ",108],["T_VARIABLE","$key",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$part",109],";",["T_WHITESPACE","\n                    ",109],["T_VARIABLE","$value",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","true",110],";",["T_WHITESPACE","\n                ",110],"}",["T_WHITESPACE","\n\n                ",111],["T_VARIABLE","$key",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","strtolower",113],"(",["T_VARIABLE","$key",113],")",";",["T_WHITESPACE","\n                ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$key",114],["T_WHITESPACE"," ",114],["T_IS_IDENTICAL","===",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'httponly'",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                    ",114],["T_VARIABLE","$key",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'httpOnly'",115],";",["T_WHITESPACE","\n                ",115],"}",["T_WHITESPACE","\n                ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$key",117],["T_WHITESPACE"," ",117],["T_IS_IDENTICAL","===",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'expires'",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                    ",117],["T_VARIABLE","$key",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'expire'",118],";",["T_WHITESPACE","\n                    ",118],["T_VARIABLE","$value",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","strtotime",119],"(",["T_VARIABLE","$value",119],")",";",["T_WHITESPACE","\n                ",119],"}",["T_WHITESPACE","\n                ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_ISSET","isset",121],"(",["T_VARIABLE","$parsed",121],"[",["T_VARIABLE","$key",121],"]",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$parsed",122],"[",["T_VARIABLE","$key",122],"]",["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$value",122],";",["T_WHITESPACE","\n                ",122],"}",["T_WHITESPACE","\n            ",123],"}",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$cookies",125],"[","]",["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$parsed",125],";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n\n        ",126],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$cookies",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Convert a PSR7 Response headers into a flat array\n     *\n     * @param \\Psr\\Http\\Message\\ResponseInterface $response The response to convert.\n     * @return \\Cake\\Network\\Response The equivalent CakePHP response\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PROTECTED","protected",137],["T_WHITESPACE"," ",137],["T_STATIC","static",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","collapseHeaders",137],"(",["T_STRING","PsrResponse",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$response",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$out",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],"[","]",";",["T_WHITESPACE","\n        ",139],["T_FOREACH","foreach",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$response",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getHeaders",140],"(",")",["T_WHITESPACE"," ",140],["T_AS","as",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$name",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$value",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_STRING","count",141],"(",["T_VARIABLE","$value",141],")",["T_WHITESPACE"," ",141],["T_IS_IDENTICAL","===",141],["T_WHITESPACE"," ",141],["T_LNUMBER","1",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$out",142],"[",["T_VARIABLE","$name",142],"]",["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$value",142],"[",["T_LNUMBER","0",142],"]",";",["T_WHITESPACE","\n            ",142],"}",["T_WHITESPACE"," ",143],["T_ELSE","else",143],["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$out",144],"[",["T_VARIABLE","$name",144],"]",["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$value",144],";",["T_WHITESPACE","\n            ",144],"}",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n\n        ",146],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$out",148],";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Convert a CakePHP response into a PSR7 one.\n     *\n     * @param \\Cake\\Network\\Response $response The CakePHP response to convert\n     * @return \\Psr\\Http\\Message\\ResponseInterface $response The equivalent PSR7 response.\n     *\/",151],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_STATIC","static",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","toPsr",157],"(",["T_STRING","CakeResponse",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$response",157],")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$status",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$response",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","statusCode",159],"(",")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$headers",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$response",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","header",160],"(",")",";",["T_WHITESPACE","\n        ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(","!",["T_ISSET","isset",161],"(",["T_VARIABLE","$headers",161],"[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",161],"]",")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$headers",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STATIC","static",162],["T_DOUBLE_COLON","::",162],["T_STRING","setContentType",162],"(",["T_VARIABLE","$headers",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$response",162],")",";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$cookies",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$response",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","cookie",164],"(",")",";",["T_WHITESPACE","\n        ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$cookies",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$headers",166],"[",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",166],"]",["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STATIC","static",166],["T_DOUBLE_COLON","::",166],["T_STRING","buildCookieHeader",166],"(",["T_VARIABLE","$cookies",166],")",";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$stream",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STATIC","static",168],["T_DOUBLE_COLON","::",168],["T_STRING","getStream",168],"(",["T_VARIABLE","$response",168],")",";",["T_WHITESPACE","\n\n        ",168],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_NEW","new",170],["T_WHITESPACE"," ",170],["T_STRING","DiactorosResponse",170],"(",["T_VARIABLE","$stream",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$status",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$headers",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * Add in the Content-Type header if necessary.\n     *\n     * @param array $headers The headers to update\n     * @param \\Cake\\Network\\Response $response The CakePHP response to convert\n     * @return array The updated headers.\n     *\/",173],["T_WHITESPACE","\n    ",179],["T_PROTECTED","protected",180],["T_WHITESPACE"," ",180],["T_STATIC","static",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","setContentType",180],"(",["T_VARIABLE","$headers",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$response",180],")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_ISSET","isset",182],"(",["T_VARIABLE","$headers",182],"[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",182],"]",")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$headers",183],";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n        ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_STRING","in_array",185],"(",["T_VARIABLE","$response",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","statusCode",185],"(",")",",",["T_WHITESPACE"," ",185],"[",["T_LNUMBER","204",185],",",["T_WHITESPACE"," ",185],["T_LNUMBER","304",185],"]",")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$headers",186],";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$whitelist",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],"[",["T_WHITESPACE","\n            ",189],["T_CONSTANT_ENCAPSED_STRING","'application\/javascript'",190],",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'application\/json'",190],",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'application\/xml'",190],",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'application\/rss+xml'",190],["T_WHITESPACE","\n        ",190],"]",";",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$type",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$response",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","type",193],"(",")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$charset",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$response",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","charset",194],"(",")",";",["T_WHITESPACE","\n\n        ",194],["T_VARIABLE","$hasCharset",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","false",196],";",["T_WHITESPACE","\n        ",196],["T_IF","if",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$charset",197],["T_WHITESPACE"," ",197],["T_BOOLEAN_AND","&&",197],["T_WHITESPACE"," ",197],"(",["T_STRING","strpos",197],"(",["T_VARIABLE","$type",197],",",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'text\/'",197],")",["T_WHITESPACE"," ",197],["T_IS_IDENTICAL","===",197],["T_WHITESPACE"," ",197],["T_LNUMBER","0",197],["T_WHITESPACE"," ",197],["T_BOOLEAN_OR","||",197],["T_WHITESPACE"," ",197],["T_STRING","in_array",197],"(",["T_VARIABLE","$type",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$whitelist",197],")",")",")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$hasCharset",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","true",198],";",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE","\n\n        ",199],["T_VARIABLE","$value",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$type",201],";",["T_WHITESPACE","\n        ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$hasCharset",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$value",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],"\"",["T_CURLY_OPEN","{",203],["T_VARIABLE","$type",203],"}",["T_ENCAPSED_AND_WHITESPACE","; charset=",203],["T_CURLY_OPEN","{",203],["T_VARIABLE","$charset",203],"}","\"",";",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$headers",205],"[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",205],"]",["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$value",205],";",["T_WHITESPACE","\n\n        ",205],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$headers",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Convert an array of cookies into header lines.\n     *\n     * @param array $cookies The cookies to serialize.\n     * @return array A list of cookie header values.\n     *\/",210],["T_WHITESPACE","\n    ",215],["T_PROTECTED","protected",216],["T_WHITESPACE"," ",216],["T_STATIC","static",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","buildCookieHeader",216],"(",["T_VARIABLE","$cookies",216],")",["T_WHITESPACE","\n    ",216],"{",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$headers",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],"[","]",";",["T_WHITESPACE","\n        ",218],["T_FOREACH","foreach",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$cookies",219],["T_WHITESPACE"," ",219],["T_AS","as",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$cookie",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$parts",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],"[",["T_WHITESPACE","\n                ",220],["T_STRING","sprintf",221],"(",["T_CONSTANT_ENCAPSED_STRING","'%s=%s'",221],",",["T_WHITESPACE"," ",221],["T_STRING","urlencode",221],"(",["T_VARIABLE","$cookie",221],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",221],"]",")",",",["T_WHITESPACE"," ",221],["T_STRING","urlencode",221],"(",["T_VARIABLE","$cookie",221],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",221],"]",")",")",["T_WHITESPACE","\n            ",221],"]",";",["T_WHITESPACE","\n            ",222],["T_IF","if",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$cookie",223],"[",["T_CONSTANT_ENCAPSED_STRING","'expire'",223],"]",")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n                ",223],["T_VARIABLE","$cookie",224],"[",["T_CONSTANT_ENCAPSED_STRING","'expire'",224],"]",["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_STRING","gmdate",224],"(",["T_CONSTANT_ENCAPSED_STRING","'D, d M Y H:i:s T'",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$cookie",224],"[",["T_CONSTANT_ENCAPSED_STRING","'expire'",224],"]",")",";",["T_WHITESPACE","\n            ",224],"}",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$attributes",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],"[",["T_WHITESPACE","\n                ",226],["T_CONSTANT_ENCAPSED_STRING","'expire'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'Expires=%s'",227],",",["T_WHITESPACE","\n                ",227],["T_CONSTANT_ENCAPSED_STRING","'path'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'Path=%s'",228],",",["T_WHITESPACE","\n                ",228],["T_CONSTANT_ENCAPSED_STRING","'domain'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'Domain=%s'",229],",",["T_WHITESPACE","\n                ",229],["T_CONSTANT_ENCAPSED_STRING","'httpOnly'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'HttpOnly'",230],",",["T_WHITESPACE","\n                ",230],["T_CONSTANT_ENCAPSED_STRING","'secure'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'Secure'",231],",",["T_WHITESPACE","\n            ",231],"]",";",["T_WHITESPACE","\n            ",232],["T_FOREACH","foreach",233],["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$attributes",233],["T_WHITESPACE"," ",233],["T_AS","as",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$key",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$attr",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n                ",233],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$cookie",234],"[",["T_VARIABLE","$key",234],"]",")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n                    ",234],["T_VARIABLE","$parts",235],"[","]",["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_STRING","sprintf",235],"(",["T_VARIABLE","$attr",235],",",["T_WHITESPACE"," ",235],["T_VARIABLE","$cookie",235],"[",["T_VARIABLE","$key",235],"]",")",";",["T_WHITESPACE","\n                ",235],"}",["T_WHITESPACE","\n            ",236],"}",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$headers",238],"[","]",["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_STRING","implode",238],"(",["T_CONSTANT_ENCAPSED_STRING","'; '",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$parts",238],")",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n\n        ",239],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$headers",241],";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Get the stream for the new response.\n     *\n     * @param \\Cake\\Network\\Response $response The cake response to extract the body from.\n     * @return \\Psr\\Http\\Message\\StreamInterface|string The stream.\n     *\/",244],["T_WHITESPACE","\n    ",249],["T_PROTECTED","protected",250],["T_WHITESPACE"," ",250],["T_STATIC","static",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","getStream",250],"(",["T_VARIABLE","$response",250],")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$stream",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'php:\/\/memory'",252],";",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$body",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$response",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","body",253],"(",")",";",["T_WHITESPACE","\n        ",253],["T_IF","if",254],["T_WHITESPACE"," ",254],"(",["T_STRING","is_string",254],"(",["T_VARIABLE","$body",254],")",["T_WHITESPACE"," ",254],["T_BOOLEAN_AND","&&",254],["T_WHITESPACE"," ",254],["T_STRING","strlen",254],"(",["T_VARIABLE","$body",254],")",")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$stream",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_NEW","new",255],["T_WHITESPACE"," ",255],["T_STRING","Stream",255],"(",["T_CONSTANT_ENCAPSED_STRING","'php:\/\/memory'",255],",",["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","'wb'",255],")",";",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$stream",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","write",256],"(",["T_VARIABLE","$body",256],")",";",["T_WHITESPACE","\n\n            ",256],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$stream",258],";",["T_WHITESPACE","\n        ",258],"}",["T_WHITESPACE","\n        ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_STRING","is_callable",260],"(",["T_VARIABLE","$body",260],")",")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$stream",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_NEW","new",261],["T_WHITESPACE"," ",261],["T_STRING","CallbackStream",261],"(",["T_VARIABLE","$body",261],")",";",["T_WHITESPACE","\n\n            ",261],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$stream",263],";",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$file",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_VARIABLE","$response",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getFile",265],"(",")",";",["T_WHITESPACE","\n        ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$file",266],")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$stream",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_NEW","new",267],["T_WHITESPACE"," ",267],["T_STRING","Stream",267],"(",["T_VARIABLE","$file",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","path",267],",",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'rb'",267],")",";",["T_WHITESPACE","\n\n            ",267],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$stream",269],";",["T_WHITESPACE","\n        ",269],"}",["T_WHITESPACE","\n\n        ",270],["T_RETURN","return",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$stream",272],";",["T_WHITESPACE","\n    ",272],"}",["T_WHITESPACE","\n",273],"}",["T_WHITESPACE","\n",274]]