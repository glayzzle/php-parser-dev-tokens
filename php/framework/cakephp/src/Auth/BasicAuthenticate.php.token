[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         2.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Auth",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Network",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Exception",17],["T_NS_SEPARATOR","\\",17],["T_STRING","UnauthorizedException",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Network",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Request",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Network",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Response",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * Basic Authentication adapter for AuthComponent.\n *\n * Provides Basic HTTP authentication support for AuthComponent. Basic Auth will\n * authenticate users against the configured userModel and verify the username\n * and passwords match.\n *\n * ### Using Basic auth\n *\n * In your controller's components array, add auth + the required config\n * ```\n *  public $components = [\n *      'Auth' => [\n *          'authenticate' => ['Basic']\n *      ]\n *  ];\n * ```\n *\n * You should also set `AuthComponent::$sessionKey = false;` in your AppController's\n * beforeFilter() to prevent CakePHP from sending a session cookie to the client.\n *\n * Since HTTP Basic Authentication is stateless you don't need a login() action\n * in your controller. The user credentials will be checked on each request. If\n * valid credentials are not provided, required authentication headers will be sent\n * by this authentication provider which triggers the login dialog in the browser\/client.\n *\n * You may also want to use `$this->Auth->unauthorizedRedirect = false;`.\n * By default, unauthorized users are redirected to the referrer URL,\n * `AuthComponent::$loginAction`, or '\/'. If unauthorizedRedirect is set to\n * false, a ForbiddenException exception is thrown instead of redirecting.\n *\/",21],["T_WHITESPACE","\n",51],["T_CLASS","class",52],["T_WHITESPACE"," ",52],["T_STRING","BasicAuthenticate",52],["T_WHITESPACE"," ",52],["T_EXTENDS","extends",52],["T_WHITESPACE"," ",52],["T_STRING","BaseAuthenticate",52],["T_WHITESPACE","\n",52],"{",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Authenticate a user using HTTP auth. Will use the configured User model and attempt a\n     * login using HTTP auth.\n     *\n     * @param \\Cake\\Network\\Request $request The request to authenticate with.\n     * @param \\Cake\\Network\\Response $response The response to add headers to.\n     * @return mixed Either false on failure, or an array of user data on success.\n     *\/",55],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","authenticate",63],"(",["T_STRING","Request",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$request",63],",",["T_WHITESPACE"," ",63],["T_STRING","Response",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$response",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getUser",65],"(",["T_VARIABLE","$request",65],")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Get a user based on information in the request. Used by cookie-less auth for stateless clients.\n     *\n     * @param \\Cake\\Network\\Request $request Request object.\n     * @return mixed Either false or an array of user information\n     *\/",68],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","getUser",74],"(",["T_STRING","Request",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$request",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$username",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$request",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","env",76],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$pass",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$request",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","env",77],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_IF","if",79],["T_WHITESPACE"," ",79],"(","!",["T_STRING","is_string",79],"(",["T_VARIABLE","$username",79],")",["T_WHITESPACE"," ",79],["T_BOOLEAN_OR","||",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$username",79],["T_WHITESPACE"," ",79],["T_IS_IDENTICAL","===",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","''",79],["T_WHITESPACE"," ",79],["T_BOOLEAN_OR","||",79],["T_WHITESPACE"," ",79],"!",["T_STRING","is_string",79],"(",["T_VARIABLE","$pass",79],")",["T_WHITESPACE"," ",79],["T_BOOLEAN_OR","||",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$pass",79],["T_WHITESPACE"," ",79],["T_IS_IDENTICAL","===",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","''",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_STRING","false",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_findUser",83],"(",["T_VARIABLE","$username",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$pass",83],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Handles an unauthenticated access attempt by sending appropriate login headers\n     *\n     * @param \\Cake\\Network\\Request $request A request object.\n     * @param \\Cake\\Network\\Response $response A response object.\n     * @return void\n     * @throws \\Cake\\Network\\Exception\\UnauthorizedException\n     *\/",86],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","unauthenticated",94],"(",["T_STRING","Request",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$request",94],",",["T_WHITESPACE"," ",94],["T_STRING","Response",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$response",94],")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$Exception",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_STRING","UnauthorizedException",96],"(",")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$Exception",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","responseHeader",97],"(","[",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","loginHeaders",97],"(",["T_VARIABLE","$request",97],")","]",")",";",["T_WHITESPACE","\n        ",97],["T_THROW","throw",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$Exception",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Generate the login headers\n     *\n     * @param \\Cake\\Network\\Request $request Request object.\n     * @return string Headers for logging in.\n     *\/",101],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","loginHeaders",107],"(",["T_STRING","Request",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$request",107],")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$realm",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","config",109],"(",["T_CONSTANT_ENCAPSED_STRING","'realm'",109],")",["T_WHITESPACE"," ",109],"?",":",["T_WHITESPACE"," ",109],["T_VARIABLE","$request",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","env",109],"(",["T_CONSTANT_ENCAPSED_STRING","'SERVER_NAME'",109],")",";",["T_WHITESPACE","\n\n        ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_STRING","sprintf",111],"(",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Basic realm=\"%s\"'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$realm",111],")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n",112],"}",["T_WHITESPACE","\n",113]]