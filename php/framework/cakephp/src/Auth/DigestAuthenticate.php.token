[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         2.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Auth",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Controller",17],["T_NS_SEPARATOR","\\",17],["T_STRING","ComponentRegistry",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Network",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Request",18],";",["T_WHITESPACE","\n\n",18],["T_DOC_COMMENT","\/**\n * Digest Authentication adapter for AuthComponent.\n *\n * Provides Digest HTTP authentication support for AuthComponent.\n *\n * ### Using Digest auth\n *\n * In your controller's components array, add auth + the required config\n * ```\n *  public $components = [\n *      'Auth' => [\n *          'authenticate' => ['Digest']\n *      ]\n *  ];\n * ```\n *\n * You should also set `AuthComponent::$sessionKey = false;` in your AppController's\n * beforeFilter() to prevent CakePHP from sending a session cookie to the client.\n *\n * Since HTTP Digest Authentication is stateless you don't need a login() action\n * in your controller. The user credentials will be checked on each request. If\n * valid credentials are not provided, required authentication headers will be sent\n * by this authentication provider which triggers the login dialog in the browser\/client.\n *\n * You may also want to use `$this->Auth->unauthorizedRedirect = false;`.\n * This causes AuthComponent to throw a ForbiddenException exception instead of\n * redirecting to another page.\n *\n * ### Generating passwords compatible with Digest authentication.\n *\n * DigestAuthenticate requires a special password hash that conforms to RFC2617.\n * You can generate this password using `DigestAuthenticate::password()`\n *\n * ```\n * $digestPass = DigestAuthenticate::password($username, $password, env('SERVER_NAME'));\n * ```\n *\n * If you wish to use digest authentication alongside other authentication methods,\n * it's recommended that you store the digest authentication separately. For\n * example `User.digest_pass` could be used for a digest password, while\n * `User.password` would store the password hash for use with other methods like\n * Basic or Form.\n *\/",20],["T_WHITESPACE","\n",62],["T_CLASS","class",63],["T_WHITESPACE"," ",63],["T_STRING","DigestAuthenticate",63],["T_WHITESPACE"," ",63],["T_EXTENDS","extends",63],["T_WHITESPACE"," ",63],["T_STRING","BasicAuthenticate",63],["T_WHITESPACE","\n",63],"{",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * Besides the keys specified in BaseAuthenticate::$_defaultConfig,\n     * DigestAuthenticate uses the following extra keys:\n     *\n     * - `realm` The realm authentication is for, Defaults to the servername.\n     * - `nonce` A nonce used for authentication. Defaults to `uniqid()`.\n     * - `qop` Defaults to 'auth', no other values are supported at this time.\n     * - `opaque` A string that must be returned unchanged by clients.\n     *    Defaults to `md5($config['realm'])`\n     *\n     * @param \\Cake\\Controller\\ComponentRegistry $registry The Component registry\n     *   used on this request.\n     * @param array $config Array of config to use.\n     *\/",66],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","__construct",82],"(",["T_STRING","ComponentRegistry",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$registry",82],",",["T_WHITESPACE"," ",82],["T_ARRAY","array",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$config",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],"[","]",")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_registry",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$registry",84],";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","config",86],"(","[",["T_WHITESPACE","\n            ",86],["T_CONSTANT_ENCAPSED_STRING","'realm'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_STRING","null",87],",",["T_WHITESPACE","\n            ",87],["T_CONSTANT_ENCAPSED_STRING","'qop'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'auth'",88],",",["T_WHITESPACE","\n            ",88],["T_CONSTANT_ENCAPSED_STRING","'nonce'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_STRING","uniqid",89],"(",["T_CONSTANT_ENCAPSED_STRING","''",89],")",",",["T_WHITESPACE","\n            ",89],["T_CONSTANT_ENCAPSED_STRING","'opaque'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_STRING","null",90],",",["T_WHITESPACE","\n        ",90],"]",")",";",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","config",93],"(",["T_VARIABLE","$config",93],")",";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Get a user based on information in the request. Used by cookie-less auth for stateless clients.\n     *\n     * @param \\Cake\\Network\\Request $request Request object.\n     * @return mixed Either false or an array of user information\n     *\/",96],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","getUser",102],"(",["T_STRING","Request",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$request",102],")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$digest",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_getDigest",104],"(",["T_VARIABLE","$request",104],")",";",["T_WHITESPACE","\n        ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_EMPTY","empty",105],"(",["T_VARIABLE","$digest",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_STRING","false",106],";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$user",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_findUser",109],"(",["T_VARIABLE","$digest",109],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",109],"]",")",";",["T_WHITESPACE","\n        ",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_EMPTY","empty",110],"(",["T_VARIABLE","$user",110],")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_STRING","false",111],";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_VARIABLE","$field",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_config",114],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",114],"]","[",["T_CONSTANT_ENCAPSED_STRING","'password'",114],"]",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$password",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$user",115],"[",["T_VARIABLE","$field",115],"]",";",["T_WHITESPACE","\n        ",115],["T_UNSET","unset",116],"(",["T_VARIABLE","$user",116],"[",["T_VARIABLE","$field",116],"]",")",";",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$hash",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","generateResponseHash",118],"(",["T_VARIABLE","$digest",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$password",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$request",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","env",118],"(",["T_CONSTANT_ENCAPSED_STRING","'ORIGINAL_REQUEST_METHOD'",118],")",")",";",["T_WHITESPACE","\n        ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$digest",119],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",119],"]",["T_WHITESPACE"," ",119],["T_IS_IDENTICAL","===",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$hash",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$user",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n\n        ",121],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_STRING","false",123],";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Gets the digest headers from the request\/environment.\n     *\n     * @param \\Cake\\Network\\Request $request Request object.\n     * @return array Array of digest information.\n     *\/",126],["T_WHITESPACE","\n    ",131],["T_PROTECTED","protected",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","_getDigest",132],"(",["T_STRING","Request",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$request",132],")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$digest",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$request",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","env",134],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",134],")",";",["T_WHITESPACE","\n        ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_EMPTY","empty",135],"(",["T_VARIABLE","$digest",135],")",["T_WHITESPACE"," ",135],["T_BOOLEAN_AND","&&",135],["T_WHITESPACE"," ",135],["T_STRING","function_exists",135],"(",["T_CONSTANT_ENCAPSED_STRING","'apache_request_headers'",135],")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$headers",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","apache_request_headers",136],"(",")",";",["T_WHITESPACE","\n            ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(","!",["T_EMPTY","empty",137],"(",["T_VARIABLE","$headers",137],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",137],"]",")",["T_WHITESPACE"," ",137],["T_BOOLEAN_AND","&&",137],["T_WHITESPACE"," ",137],["T_STRING","substr",137],"(",["T_VARIABLE","$headers",137],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",137],"]",",",["T_WHITESPACE"," ",137],["T_LNUMBER","0",137],",",["T_WHITESPACE"," ",137],["T_LNUMBER","7",137],")",["T_WHITESPACE"," ",137],["T_IS_IDENTICAL","===",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'Digest '",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                ",137],["T_VARIABLE","$digest",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","substr",138],"(",["T_VARIABLE","$headers",138],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",138],"]",",",["T_WHITESPACE"," ",138],["T_LNUMBER","7",138],")",";",["T_WHITESPACE","\n            ",138],"}",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_EMPTY","empty",141],"(",["T_VARIABLE","$digest",141],")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_STRING","false",142],";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n\n        ",143],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","parseAuthData",145],"(",["T_VARIABLE","$digest",145],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Parse the digest authentication headers and split them up.\n     *\n     * @param string $digest The raw digest authentication headers.\n     * @return array|null An array of digest authentication headers\n     *\/",148],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","parseAuthData",154],"(",["T_VARIABLE","$digest",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_STRING","substr",156],"(",["T_VARIABLE","$digest",156],",",["T_WHITESPACE"," ",156],["T_LNUMBER","0",156],",",["T_WHITESPACE"," ",156],["T_LNUMBER","7",156],")",["T_WHITESPACE"," ",156],["T_IS_IDENTICAL","===",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'Digest '",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$digest",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","substr",157],"(",["T_VARIABLE","$digest",157],",",["T_WHITESPACE"," ",157],["T_LNUMBER","7",157],")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$keys",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$match",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],"[","]",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$req",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'nc'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'cnonce'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'qop'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'username'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'uri'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'response'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","1",160],"]",";",["T_WHITESPACE","\n        ",160],["T_STRING","preg_match_all",161],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(\\w+)=([\\'\"]?)([a-zA-Z0-9\\:\\#\\%\\?\\&@=\\.\\\/_-]+)\\2\/'",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$digest",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$match",161],",",["T_WHITESPACE"," ",161],["T_STRING","PREG_SET_ORDER",161],")",";",["T_WHITESPACE","\n\n        ",161],["T_FOREACH","foreach",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$match",163],["T_WHITESPACE"," ",163],["T_AS","as",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$i",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$keys",164],"[",["T_VARIABLE","$i",164],"[",["T_LNUMBER","1",164],"]","]",["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$i",164],"[",["T_LNUMBER","3",164],"]",";",["T_WHITESPACE","\n            ",164],["T_UNSET","unset",165],"(",["T_VARIABLE","$req",165],"[",["T_VARIABLE","$i",165],"[",["T_LNUMBER","1",165],"]","]",")",";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_EMPTY","empty",168],"(",["T_VARIABLE","$req",168],")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$keys",169],";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n\n        ",170],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_STRING","null",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Generate the response hash for a given digest array.\n     *\n     * @param array $digest Digest information containing data from DigestAuthenticate::parseAuthData().\n     * @param string $password The digest hash password generated with DigestAuthenticate::password()\n     * @param string $method Request method\n     * @return string Response hash\n     *\/",175],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","generateResponseHash",183],"(",["T_VARIABLE","$digest",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$password",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$method",183],")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_STRING","md5",185],"(",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$password",186],["T_WHITESPACE"," ",186],".",["T_WHITESPACE","\n            ",186],["T_CONSTANT_ENCAPSED_STRING","':'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$digest",187],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",187],"]",["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","':'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$digest",187],"[",["T_CONSTANT_ENCAPSED_STRING","'nc'",187],"]",["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","':'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$digest",187],"[",["T_CONSTANT_ENCAPSED_STRING","'cnonce'",187],"]",["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","':'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$digest",187],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",187],"]",["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","':'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE","\n            ",187],["T_STRING","md5",188],"(",["T_VARIABLE","$method",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","':'",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_VARIABLE","$digest",188],"[",["T_CONSTANT_ENCAPSED_STRING","'uri'",188],"]",")",["T_WHITESPACE","\n        ",188],")",";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_DOC_COMMENT","\/**\n     * Creates an auth digest password hash to store\n     *\n     * @param string $username The username to use in the digest hash.\n     * @param string $password The unhashed password to make a digest hash for.\n     * @param string $realm The realm the password is for.\n     * @return string the hashed password that can later be used with Digest authentication.\n     *\/",192],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_STATIC","static",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","password",200],"(",["T_VARIABLE","$username",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$password",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$realm",200],")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_STRING","md5",202],"(",["T_VARIABLE","$username",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","':'",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_VARIABLE","$realm",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","':'",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_VARIABLE","$password",202],")",";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Generate the login headers\n     *\n     * @param \\Cake\\Network\\Request $request Request object.\n     * @return string Headers for logging in.\n     *\/",205],["T_WHITESPACE","\n    ",210],["T_PUBLIC","public",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","loginHeaders",211],"(",["T_STRING","Request",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$request",211],")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$realm",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_config",213],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",213],"]",["T_WHITESPACE"," ",213],"?",":",["T_WHITESPACE"," ",213],["T_VARIABLE","$request",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","env",213],"(",["T_CONSTANT_ENCAPSED_STRING","'SERVER_NAME'",213],")",";",["T_WHITESPACE","\n\n        ",213],["T_VARIABLE","$options",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],"[",["T_WHITESPACE","\n            ",215],["T_CONSTANT_ENCAPSED_STRING","'realm'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$realm",216],",",["T_WHITESPACE","\n            ",216],["T_CONSTANT_ENCAPSED_STRING","'qop'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_config",217],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",217],"]",",",["T_WHITESPACE","\n            ",217],["T_CONSTANT_ENCAPSED_STRING","'nonce'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_config",218],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",218],"]",",",["T_WHITESPACE","\n            ",218],["T_CONSTANT_ENCAPSED_STRING","'opaque'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_config",219],"[",["T_CONSTANT_ENCAPSED_STRING","'opaque'",219],"]",["T_WHITESPACE"," ",219],"?",":",["T_WHITESPACE"," ",219],["T_STRING","md5",219],"(",["T_VARIABLE","$realm",219],")",["T_WHITESPACE","\n        ",219],"]",";",["T_WHITESPACE","\n\n        ",220],["T_VARIABLE","$opts",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],"[","]",";",["T_WHITESPACE","\n        ",222],["T_FOREACH","foreach",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$options",223],["T_WHITESPACE"," ",223],["T_AS","as",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$k",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$v",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n            ",223],["T_VARIABLE","$opts",224],"[","]",["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_STRING","sprintf",224],"(",["T_CONSTANT_ENCAPSED_STRING","'%s=\"%s\"'",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$k",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$v",224],")",";",["T_WHITESPACE","\n        ",224],"}",["T_WHITESPACE","\n\n        ",225],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Digest '",227],["T_WHITESPACE"," ",227],".",["T_WHITESPACE"," ",227],["T_STRING","implode",227],"(",["T_CONSTANT_ENCAPSED_STRING","','",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$opts",227],")",";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n",228],"}",["T_WHITESPACE","\n",229]]