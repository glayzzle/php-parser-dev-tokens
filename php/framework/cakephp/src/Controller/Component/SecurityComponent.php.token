[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         0.10.8\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Controller",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Controller",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Controller",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Controller",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Controller",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Exception",19],["T_NS_SEPARATOR","\\",19],["T_STRING","AuthSecurityException",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Controller",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Exception",20],["T_NS_SEPARATOR","\\",20],["T_STRING","SecurityException",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Core",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Configure",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Event",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Event",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Cake",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Network",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Exception",23],["T_NS_SEPARATOR","\\",23],["T_STRING","BadRequestException",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Cake",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Network",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Request",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Cake",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Utility",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Hash",25],";",["T_WHITESPACE","\n",25],["T_USE","use",26],["T_WHITESPACE"," ",26],["T_STRING","Cake",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Utility",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Security",26],";",["T_WHITESPACE","\n\n",26],["T_DOC_COMMENT","\/**\n * The Security Component creates an easy way to integrate tighter security in\n * your application. It provides methods for various tasks like:\n *\n * - Restricting which HTTP methods your application accepts.\n * - Form tampering protection\n * - Requiring that SSL be used.\n * - Limiting cross controller communication.\n *\n * @link http:\/\/book.cakephp.org\/3.0\/en\/controllers\/components\/security.html\n *\/",28],["T_WHITESPACE","\n",38],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","SecurityComponent",39],["T_WHITESPACE"," ",39],["T_EXTENDS","extends",39],["T_WHITESPACE"," ",39],["T_STRING","Component",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Default message used for exceptions thrown\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","DEFAULT_EXCEPTION_MESSAGE",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'The request has been black-holed'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Default config\n     *\n     * - `blackHoleCallback` - The controller method that will be called if this\n     *   request is black-hole'd.\n     * - `requireSecure` - List of actions that require an SSL-secured connection.\n     * - `requireAuth` - List of actions that require a valid authentication key. Deprecated as of 3.2.2\n     * - `allowedControllers` - Controllers from which actions of the current\n     *   controller are allowed to receive requests.\n     * - `allowedActions` - Actions from which actions of the current controller\n     *   are allowed to receive requests.\n     * - `unlockedFields` - Form fields to exclude from POST validation. Fields can\n     *   be unlocked either in the Component, or with FormHelper::unlockField().\n     *   Fields that have been unlocked are not required to be part of the POST\n     *   and hidden unlocked fields do not have their values checked.\n     * - `unlockedActions` - Actions to exclude from POST validation checks.\n     *   Other checks like requireAuth(), requireSecure() etc. will still be applied.\n     * - `validatePost` -  Whether to validate POST data. Set to false to disable\n     *   for data coming from 3rd party services, etc.\n     *\n     * @var array\n     *\/",47],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_defaultConfig",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],"[",["T_WHITESPACE","\n        ",69],["T_CONSTANT_ENCAPSED_STRING","'blackHoleCallback'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_STRING","null",70],",",["T_WHITESPACE","\n        ",70],["T_CONSTANT_ENCAPSED_STRING","'requireSecure'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],"[","]",",",["T_WHITESPACE","\n        ",71],["T_CONSTANT_ENCAPSED_STRING","'requireAuth'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],"[","]",",",["T_WHITESPACE","\n        ",72],["T_CONSTANT_ENCAPSED_STRING","'allowedControllers'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],"[","]",",",["T_WHITESPACE","\n        ",73],["T_CONSTANT_ENCAPSED_STRING","'allowedActions'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],"[","]",",",["T_WHITESPACE","\n        ",74],["T_CONSTANT_ENCAPSED_STRING","'unlockedFields'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],"[","]",",",["T_WHITESPACE","\n        ",75],["T_CONSTANT_ENCAPSED_STRING","'unlockedActions'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],"[","]",",",["T_WHITESPACE","\n        ",76],["T_CONSTANT_ENCAPSED_STRING","'validatePost'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_STRING","true",77],["T_WHITESPACE","\n    ",77],"]",";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Holds the current action of the controller\n     *\n     * @var string\n     *\/",80],["T_WHITESPACE","\n    ",84],["T_PROTECTED","protected",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$_action",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","null",85],";",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Request object\n     *\n     * @var \\Cake\\Network\\Request\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$request",92],";",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * The Session object\n     *\n     * @var \\Cake\\Network\\Session\n     *\/",94],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$session",99],";",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Component startup. All security checking happens here.\n     *\n     * @param \\Cake\\Event\\Event $event An Event instance\n     * @return mixed\n     *\/",101],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","startup",107],"(",["T_STRING","Event",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$event",107],")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$controller",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$event",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","subject",109],"(",")",";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","session",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","request",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","session",110],"(",")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_action",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","request",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","params",111],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",111],"]",";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$hasData",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],"!",["T_EMPTY","empty",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","request",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","data",112],")",";",["T_WHITESPACE","\n        ",112],["T_TRY","try",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_secureRequired",114],"(",["T_VARIABLE","$controller",114],")",";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_authRequired",115],"(",["T_VARIABLE","$controller",115],")",";",["T_WHITESPACE","\n\n            ",115],["T_VARIABLE","$isNotRequestAction",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],"(",["T_WHITESPACE","\n                ",117],"!",["T_ISSET","isset",118],"(",["T_VARIABLE","$controller",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","request",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","params",118],"[",["T_CONSTANT_ENCAPSED_STRING","'requested'",118],"]",")",["T_WHITESPACE"," ",118],["T_BOOLEAN_OR","||",118],["T_WHITESPACE","\n                ",118],["T_VARIABLE","$controller",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","request",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","params",119],"[",["T_CONSTANT_ENCAPSED_STRING","'requested'",119],"]",["T_WHITESPACE"," ",119],["T_IS_NOT_EQUAL","!=",119],["T_WHITESPACE"," ",119],["T_LNUMBER","1",119],["T_WHITESPACE","\n            ",119],")",";",["T_WHITESPACE","\n\n            ",120],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_action",122],["T_WHITESPACE"," ",122],["T_IS_IDENTICAL","===",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_config",122],"[",["T_CONSTANT_ENCAPSED_STRING","'blackHoleCallback'",122],"]",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                ",122],["T_THROW","throw",123],["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","AuthSecurityException",123],"(",["T_STRING","sprintf",123],"(",["T_CONSTANT_ENCAPSED_STRING","'Action %s is defined as the blackhole callback.'",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_action",123],")",")",";",["T_WHITESPACE","\n            ",123],"}",["T_WHITESPACE","\n\n            ",124],["T_IF","if",126],["T_WHITESPACE"," ",126],"(","!",["T_STRING","in_array",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_action",126],",",["T_WHITESPACE"," ",126],["T_ARRAY_CAST","(array)",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_config",126],"[",["T_CONSTANT_ENCAPSED_STRING","'unlockedActions'",126],"]",")",["T_WHITESPACE"," ",126],["T_BOOLEAN_AND","&&",126],["T_WHITESPACE","\n                ",126],["T_VARIABLE","$hasData",127],["T_WHITESPACE"," ",127],["T_BOOLEAN_AND","&&",127],["T_WHITESPACE","\n                ",127],["T_VARIABLE","$isNotRequestAction",128],["T_WHITESPACE"," ",128],["T_BOOLEAN_AND","&&",128],["T_WHITESPACE","\n                ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_config",129],"[",["T_CONSTANT_ENCAPSED_STRING","'validatePost'",129],"]",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                    ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_validatePost",130],"(",["T_VARIABLE","$controller",130],")",";",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE"," ",132],["T_CATCH","catch",132],["T_WHITESPACE"," ",132],"(",["T_STRING","SecurityException",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$se",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","blackHole",133],"(",["T_VARIABLE","$controller",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$se",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getType",133],"(",")",",",["T_WHITESPACE"," ",133],["T_VARIABLE","$se",133],")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n\n        ",134],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","generateToken",136],"(",["T_VARIABLE","$controller",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","request",136],")",";",["T_WHITESPACE","\n        ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$hasData",137],["T_WHITESPACE"," ",137],["T_BOOLEAN_AND","&&",137],["T_WHITESPACE"," ",137],["T_STRING","is_array",137],"(",["T_VARIABLE","$controller",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","request",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","data",137],")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_UNSET","unset",138],"(",["T_VARIABLE","$controller",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","request",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","data",138],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",138],"]",")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Events supported by this component.\n     *\n     * @return array\n     *\/",142],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","implementedEvents",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],"[",["T_WHITESPACE","\n            ",149],["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'startup'",150],",",["T_WHITESPACE","\n        ",150],"]",";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Sets the actions that require a request that is SSL-secured, or empty for all actions\n     *\n     * @param string|array|null $actions Actions list\n     * @return void\n     *\/",154],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","requireSecure",160],"(",["T_VARIABLE","$actions",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","null",160],")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_requireMethod",162],"(",["T_CONSTANT_ENCAPSED_STRING","'Secure'",162],",",["T_WHITESPACE"," ",162],["T_ARRAY_CAST","(array)",162],["T_VARIABLE","$actions",162],")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Sets the actions that require whitelisted form submissions.\n     *\n     * Adding actions with this method will enforce the restrictions\n     * set in SecurityComponent::$allowedControllers and\n     * SecurityComponent::$allowedActions.\n     *\n     * @param string|array $actions Actions list\n     * @return void\n     * @deprecated 3.2.2 This feature is confusing and not useful.\n     *\/",165],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","requireAuth",176],"(",["T_VARIABLE","$actions",176],")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_requireMethod",178],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",178],",",["T_WHITESPACE"," ",178],["T_ARRAY_CAST","(array)",178],["T_VARIABLE","$actions",178],")",";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Black-hole an invalid request with a 400 error or custom callback. If SecurityComponent::$blackHoleCallback\n     * is specified, it will use this callback by executing the method indicated in $error\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @param string $error Error method\n     * @param \\Cake\\Controller\\Exception\\SecurityException|null $exception Additional debug info describing the cause\n     * @return mixed If specified, controller blackHoleCallback's response, or no return otherwise\n     * @see \\Cake\\Controller\\Component\\SecurityComponent::$blackHoleCallback\n     * @link http:\/\/book.cakephp.org\/3.0\/en\/controllers\/components\/security.html#handling-blackhole-callbacks\n     * @throws \\Cake\\Network\\Exception\\BadRequestException\n     *\/",181],["T_WHITESPACE","\n    ",192],["T_PUBLIC","public",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","blackHole",193],"(",["T_STRING","Controller",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$controller",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$error",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","''",193],",",["T_WHITESPACE"," ",193],["T_STRING","SecurityException",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$exception",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","null",193],")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(","!",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_config",195],"[",["T_CONSTANT_ENCAPSED_STRING","'blackHoleCallback'",195],"]",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_throwException",196],"(",["T_VARIABLE","$exception",196],")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n\n        ",197],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_callback",199],"(",["T_VARIABLE","$controller",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_config",199],"[",["T_CONSTANT_ENCAPSED_STRING","'blackHoleCallback'",199],"]",",",["T_WHITESPACE"," ",199],"[",["T_VARIABLE","$error",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$exception",199],"]",")",";",["T_WHITESPACE","\n    ",199],"}",["T_WHITESPACE","\n\n    ",200],["T_DOC_COMMENT","\/**\n     * Check debug status and throw an Exception based on the existing one\n     *\n     * @param \\Cake\\Controller\\Exception\\SecurityException|null $exception Additional debug info describing the cause\n     * @throws \\Cake\\Network\\Exception\\BadRequestException\n     * @return void\n     *\/",202],["T_WHITESPACE","\n    ",208],["T_PROTECTED","protected",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","_throwException",209],"(",["T_VARIABLE","$exception",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING","null",209],")",["T_WHITESPACE","\n    ",209],"{",["T_WHITESPACE","\n        ",210],["T_IF","if",211],["T_WHITESPACE"," ",211],"(",["T_VARIABLE","$exception",211],["T_WHITESPACE"," ",211],["T_IS_NOT_IDENTICAL","!==",211],["T_WHITESPACE"," ",211],["T_STRING","null",211],")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n            ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(","!",["T_STRING","Configure",212],["T_DOUBLE_COLON","::",212],["T_STRING","read",212],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",212],")",["T_WHITESPACE"," ",212],["T_BOOLEAN_AND","&&",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$exception",212],["T_WHITESPACE"," ",212],["T_INSTANCEOF","instanceof",212],["T_WHITESPACE"," ",212],["T_STRING","SecurityException",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n                ",212],["T_VARIABLE","$exception",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","setReason",213],"(",["T_VARIABLE","$exception",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getMessage",213],"(",")",")",";",["T_WHITESPACE","\n                ",213],["T_VARIABLE","$exception",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","setMessage",214],"(",["T_STRING","self",214],["T_DOUBLE_COLON","::",214],["T_STRING","DEFAULT_EXCEPTION_MESSAGE",214],")",";",["T_WHITESPACE","\n            ",214],"}",["T_WHITESPACE","\n            ",215],["T_THROW","throw",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$exception",216],";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE","\n        ",217],["T_THROW","throw",218],["T_WHITESPACE"," ",218],["T_NEW","new",218],["T_WHITESPACE"," ",218],["T_STRING","BadRequestException",218],"(",["T_STRING","self",218],["T_DOUBLE_COLON","::",218],["T_STRING","DEFAULT_EXCEPTION_MESSAGE",218],")",";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Sets the actions that require a $method HTTP request, or empty for all actions\n     *\n     * @param string $method The HTTP method to assign controller actions to\n     * @param array $actions Controller actions to set the required HTTP method to.\n     * @return void\n     *\/",221],["T_WHITESPACE","\n    ",227],["T_PROTECTED","protected",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","_requireMethod",228],"(",["T_VARIABLE","$method",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$actions",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],"[","]",")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_ISSET","isset",230],"(",["T_VARIABLE","$actions",230],"[",["T_LNUMBER","0",230],"]",")",["T_WHITESPACE"," ",230],["T_BOOLEAN_AND","&&",230],["T_WHITESPACE"," ",230],["T_STRING","is_array",230],"(",["T_VARIABLE","$actions",230],"[",["T_LNUMBER","0",230],"]",")",")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$actions",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$actions",231],"[",["T_LNUMBER","0",231],"]",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","config",233],"(",["T_CONSTANT_ENCAPSED_STRING","'require'",233],["T_WHITESPACE"," ",233],".",["T_WHITESPACE"," ",233],["T_VARIABLE","$method",233],",",["T_WHITESPACE"," ",233],"(",["T_EMPTY","empty",233],"(",["T_VARIABLE","$actions",233],")",")",["T_WHITESPACE"," ",233],"?",["T_WHITESPACE"," ",233],"[",["T_CONSTANT_ENCAPSED_STRING","'*'",233],"]",["T_WHITESPACE"," ",233],":",["T_WHITESPACE"," ",233],["T_VARIABLE","$actions",233],")",";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * Check if access requires secure connection\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @return bool true if secure connection required\n     *\/",236],["T_WHITESPACE","\n    ",241],["T_PROTECTED","protected",242],["T_WHITESPACE"," ",242],["T_FUNCTION","function",242],["T_WHITESPACE"," ",242],["T_STRING","_secureRequired",242],"(",["T_STRING","Controller",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$controller",242],")",["T_WHITESPACE","\n    ",242],"{",["T_WHITESPACE","\n        ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_STRING","is_array",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_config",244],"[",["T_CONSTANT_ENCAPSED_STRING","'requireSecure'",244],"]",")",["T_WHITESPACE"," ",244],["T_BOOLEAN_AND","&&",244],["T_WHITESPACE","\n            ",244],"!",["T_EMPTY","empty",245],"(",["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_config",245],"[",["T_CONSTANT_ENCAPSED_STRING","'requireSecure'",245],"]",")",["T_WHITESPACE","\n        ",245],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$requireSecure",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_config",247],"[",["T_CONSTANT_ENCAPSED_STRING","'requireSecure'",247],"]",";",["T_WHITESPACE","\n\n            ",247],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_STRING","in_array",249],"(",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_action",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$requireSecure",249],")",["T_WHITESPACE"," ",249],["T_BOOLEAN_OR","||",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$requireSecure",249],["T_WHITESPACE"," ",249],["T_IS_IDENTICAL","===",249],["T_WHITESPACE"," ",249],"[",["T_CONSTANT_ENCAPSED_STRING","'*'",249],"]",")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                ",249],["T_IF","if",250],["T_WHITESPACE"," ",250],"(","!",["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","request",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","is",250],"(",["T_CONSTANT_ENCAPSED_STRING","'ssl'",250],")",")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                    ",250],["T_THROW","throw",251],["T_WHITESPACE"," ",251],["T_NEW","new",251],["T_WHITESPACE"," ",251],["T_STRING","SecurityException",251],"(",["T_WHITESPACE","\n                        ",251],["T_CONSTANT_ENCAPSED_STRING","'Request is not SSL and the action is required to be secure'",252],["T_WHITESPACE","\n                    ",252],")",";",["T_WHITESPACE","\n                ",253],"}",["T_WHITESPACE","\n            ",254],"}",["T_WHITESPACE","\n        ",255],"}",["T_WHITESPACE","\n\n        ",256],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_STRING","true",258],";",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n\n    ",259],["T_DOC_COMMENT","\/**\n     * Check if authentication is required\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @return bool true if authentication required\n     * @deprecated 3.2.2 This feature is confusing and not useful.\n     *\/",261],["T_WHITESPACE","\n    ",267],["T_PROTECTED","protected",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","_authRequired",268],"(",["T_STRING","Controller",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$controller",268],")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_STRING","is_array",270],"(",["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_config",270],"[",["T_CONSTANT_ENCAPSED_STRING","'requireAuth'",270],"]",")",["T_WHITESPACE"," ",270],["T_BOOLEAN_AND","&&",270],["T_WHITESPACE","\n            ",270],"!",["T_EMPTY","empty",271],"(",["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_config",271],"[",["T_CONSTANT_ENCAPSED_STRING","'requireAuth'",271],"]",")",["T_WHITESPACE"," ",271],["T_BOOLEAN_AND","&&",271],["T_WHITESPACE","\n            ",271],"!",["T_EMPTY","empty",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","request",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","data",272],")",["T_WHITESPACE","\n        ",272],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$requireAuth",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_config",274],"[",["T_CONSTANT_ENCAPSED_STRING","'requireAuth'",274],"]",";",["T_WHITESPACE","\n\n            ",274],["T_IF","if",276],["T_WHITESPACE"," ",276],"(",["T_STRING","in_array",276],"(",["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","request",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","params",276],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",276],"]",",",["T_WHITESPACE"," ",276],["T_VARIABLE","$requireAuth",276],")",["T_WHITESPACE"," ",276],["T_BOOLEAN_OR","||",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$requireAuth",276],["T_WHITESPACE"," ",276],["T_IS_EQUAL","==",276],["T_WHITESPACE"," ",276],"[",["T_CONSTANT_ENCAPSED_STRING","'*'",276],"]",")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n                ",276],["T_IF","if",277],["T_WHITESPACE"," ",277],"(","!",["T_ISSET","isset",277],"(",["T_VARIABLE","$controller",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","request",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","data",277],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",277],"]",")",")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n                    ",277],["T_THROW","throw",278],["T_WHITESPACE"," ",278],["T_NEW","new",278],["T_WHITESPACE"," ",278],["T_STRING","AuthSecurityException",278],"(",["T_CONSTANT_ENCAPSED_STRING","'\\'_Token\\' was not found in request data.'",278],")",";",["T_WHITESPACE","\n                ",278],"}",["T_WHITESPACE","\n\n                ",279],["T_IF","if",281],["T_WHITESPACE"," ",281],"(",["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","session",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","check",281],"(",["T_CONSTANT_ENCAPSED_STRING","'_Token'",281],")",")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n                    ",281],["T_VARIABLE","$tData",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","session",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","read",282],"(",["T_CONSTANT_ENCAPSED_STRING","'_Token'",282],")",";",["T_WHITESPACE","\n\n                    ",282],["T_IF","if",284],["T_WHITESPACE"," ",284],"(","!",["T_EMPTY","empty",284],"(",["T_VARIABLE","$tData",284],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedControllers'",284],"]",")",["T_WHITESPACE"," ",284],["T_BOOLEAN_AND","&&",284],["T_WHITESPACE","\n                        ",284],"!",["T_STRING","in_array",285],"(",["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","request",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","params",285],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",285],"]",",",["T_WHITESPACE"," ",285],["T_VARIABLE","$tData",285],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedControllers'",285],"]",")",")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                        ",285],["T_THROW","throw",286],["T_WHITESPACE"," ",286],["T_NEW","new",286],["T_WHITESPACE"," ",286],["T_STRING","AuthSecurityException",286],"(",["T_WHITESPACE","\n                            ",286],["T_STRING","sprintf",287],"(",["T_WHITESPACE","\n                                ",287],["T_CONSTANT_ENCAPSED_STRING","'Controller \\'%s\\' was not found in allowed controllers: \\'%s\\'.'",288],",",["T_WHITESPACE","\n                                ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","request",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","params",289],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",289],"]",",",["T_WHITESPACE","\n                                ",289],["T_STRING","implode",290],"(",["T_CONSTANT_ENCAPSED_STRING","', '",290],",",["T_WHITESPACE"," ",290],["T_ARRAY_CAST","(array)",290],["T_VARIABLE","$tData",290],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedControllers'",290],"]",")",["T_WHITESPACE","\n                            ",290],")",["T_WHITESPACE","\n                        ",291],")",";",["T_WHITESPACE","\n                    ",292],"}",["T_WHITESPACE","\n                    ",293],["T_IF","if",294],["T_WHITESPACE"," ",294],"(","!",["T_EMPTY","empty",294],"(",["T_VARIABLE","$tData",294],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedActions'",294],"]",")",["T_WHITESPACE"," ",294],["T_BOOLEAN_AND","&&",294],["T_WHITESPACE","\n                        ",294],"!",["T_STRING","in_array",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","request",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","params",295],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",295],"]",",",["T_WHITESPACE"," ",295],["T_VARIABLE","$tData",295],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedActions'",295],"]",")",["T_WHITESPACE","\n                    ",295],")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n                        ",296],["T_THROW","throw",297],["T_WHITESPACE"," ",297],["T_NEW","new",297],["T_WHITESPACE"," ",297],["T_STRING","AuthSecurityException",297],"(",["T_WHITESPACE","\n                            ",297],["T_STRING","sprintf",298],"(",["T_WHITESPACE","\n                                ",298],["T_CONSTANT_ENCAPSED_STRING","'Action \\'%s::%s\\' was not found in allowed actions: \\'%s\\'.'",299],",",["T_WHITESPACE","\n                                ",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","request",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","params",300],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",300],"]",",",["T_WHITESPACE","\n                                ",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","request",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","params",301],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",301],"]",",",["T_WHITESPACE","\n                                ",301],["T_STRING","implode",302],"(",["T_CONSTANT_ENCAPSED_STRING","', '",302],",",["T_WHITESPACE"," ",302],["T_ARRAY_CAST","(array)",302],["T_VARIABLE","$tData",302],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedActions'",302],"]",")",["T_WHITESPACE","\n                            ",302],")",["T_WHITESPACE","\n                        ",303],")",";",["T_WHITESPACE","\n                    ",304],"}",["T_WHITESPACE","\n                ",305],"}",["T_WHITESPACE"," ",306],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                    ",306],["T_THROW","throw",307],["T_WHITESPACE"," ",307],["T_NEW","new",307],["T_WHITESPACE"," ",307],["T_STRING","AuthSecurityException",307],"(",["T_CONSTANT_ENCAPSED_STRING","'\\'_Token\\' was not found in session.'",307],")",";",["T_WHITESPACE","\n                ",307],"}",["T_WHITESPACE","\n            ",308],"}",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE","\n\n        ",310],["T_RETURN","return",312],["T_WHITESPACE"," ",312],["T_STRING","true",312],";",["T_WHITESPACE","\n    ",312],"}",["T_WHITESPACE","\n\n    ",313],["T_DOC_COMMENT","\/**\n     * Validate submitted form\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @throws \\Cake\\Controller\\Exception\\AuthSecurityException\n     * @return bool true if submitted form is valid\n     *\/",315],["T_WHITESPACE","\n    ",321],["T_PROTECTED","protected",322],["T_WHITESPACE"," ",322],["T_FUNCTION","function",322],["T_WHITESPACE"," ",322],["T_STRING","_validatePost",322],"(",["T_STRING","Controller",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$controller",322],")",["T_WHITESPACE","\n    ",322],"{",["T_WHITESPACE","\n        ",323],["T_IF","if",324],["T_WHITESPACE"," ",324],"(",["T_EMPTY","empty",324],"(",["T_VARIABLE","$controller",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","request",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","data",324],")",")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_STRING","true",325],";",["T_WHITESPACE","\n        ",325],"}",["T_WHITESPACE","\n        ",326],["T_VARIABLE","$token",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_validToken",327],"(",["T_VARIABLE","$controller",327],")",";",["T_WHITESPACE","\n        ",327],["T_VARIABLE","$hashParts",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_hashParts",328],"(",["T_VARIABLE","$controller",328],")",";",["T_WHITESPACE","\n        ",328],["T_VARIABLE","$check",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_STRING","Security",329],["T_DOUBLE_COLON","::",329],["T_STRING","hash",329],"(",["T_STRING","implode",329],"(",["T_CONSTANT_ENCAPSED_STRING","''",329],",",["T_WHITESPACE"," ",329],["T_VARIABLE","$hashParts",329],")",",",["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'sha1'",329],")",";",["T_WHITESPACE","\n\n        ",329],["T_IF","if",331],["T_WHITESPACE"," ",331],"(",["T_VARIABLE","$token",331],["T_WHITESPACE"," ",331],["T_IS_IDENTICAL","===",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$check",331],")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n            ",331],["T_RETURN","return",332],["T_WHITESPACE"," ",332],["T_STRING","true",332],";",["T_WHITESPACE","\n        ",332],"}",["T_WHITESPACE","\n\n        ",333],["T_VARIABLE","$msg",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","self",335],["T_DOUBLE_COLON","::",335],["T_STRING","DEFAULT_EXCEPTION_MESSAGE",335],";",["T_WHITESPACE","\n        ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_STRING","Configure",336],["T_DOUBLE_COLON","::",336],["T_STRING","read",336],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",336],")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n            ",336],["T_VARIABLE","$msg",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_debugPostTokenNotMatching",337],"(",["T_VARIABLE","$controller",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$hashParts",337],")",";",["T_WHITESPACE","\n        ",337],"}",["T_WHITESPACE","\n\n        ",338],["T_THROW","throw",340],["T_WHITESPACE"," ",340],["T_NEW","new",340],["T_WHITESPACE"," ",340],["T_STRING","AuthSecurityException",340],"(",["T_VARIABLE","$msg",340],")",";",["T_WHITESPACE","\n    ",340],"}",["T_WHITESPACE","\n\n    ",341],["T_DOC_COMMENT","\/**\n     * Check if token is valid\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @throws \\Cake\\Controller\\Exception\\SecurityException\n     * @return string fields token\n     *\/",343],["T_WHITESPACE","\n    ",349],["T_PROTECTED","protected",350],["T_WHITESPACE"," ",350],["T_FUNCTION","function",350],["T_WHITESPACE"," ",350],["T_STRING","_validToken",350],"(",["T_STRING","Controller",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$controller",350],")",["T_WHITESPACE","\n    ",350],"{",["T_WHITESPACE","\n        ",351],["T_VARIABLE","$check",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_VARIABLE","$controller",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","request",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","data",352],";",["T_WHITESPACE","\n\n        ",352],["T_VARIABLE","$message",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_CONSTANT_ENCAPSED_STRING","'\\'%s\\' was not found in request data.'",354],";",["T_WHITESPACE","\n        ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(","!",["T_ISSET","isset",355],"(",["T_VARIABLE","$check",355],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",355],"]",")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_THROW","throw",356],["T_WHITESPACE"," ",356],["T_NEW","new",356],["T_WHITESPACE"," ",356],["T_STRING","AuthSecurityException",356],"(",["T_STRING","sprintf",356],"(",["T_VARIABLE","$message",356],",",["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","'_Token'",356],")",")",";",["T_WHITESPACE","\n        ",356],"}",["T_WHITESPACE","\n        ",357],["T_IF","if",358],["T_WHITESPACE"," ",358],"(","!",["T_ISSET","isset",358],"(",["T_VARIABLE","$check",358],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",358],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fields'",358],"]",")",")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_THROW","throw",359],["T_WHITESPACE"," ",359],["T_NEW","new",359],["T_WHITESPACE"," ",359],["T_STRING","AuthSecurityException",359],"(",["T_STRING","sprintf",359],"(",["T_VARIABLE","$message",359],",",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'_Token.fields'",359],")",")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n        ",360],["T_IF","if",361],["T_WHITESPACE"," ",361],"(","!",["T_ISSET","isset",361],"(",["T_VARIABLE","$check",361],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",361],"]","[",["T_CONSTANT_ENCAPSED_STRING","'unlocked'",361],"]",")",")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n            ",361],["T_THROW","throw",362],["T_WHITESPACE"," ",362],["T_NEW","new",362],["T_WHITESPACE"," ",362],["T_STRING","AuthSecurityException",362],"(",["T_STRING","sprintf",362],"(",["T_VARIABLE","$message",362],",",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","'_Token.unlocked'",362],")",")",";",["T_WHITESPACE","\n        ",362],"}",["T_WHITESPACE","\n        ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(",["T_STRING","Configure",364],["T_DOUBLE_COLON","::",364],["T_STRING","read",364],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",364],")",["T_WHITESPACE"," ",364],["T_BOOLEAN_AND","&&",364],["T_WHITESPACE"," ",364],"!",["T_ISSET","isset",364],"(",["T_VARIABLE","$check",364],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",364],"]","[",["T_CONSTANT_ENCAPSED_STRING","'debug'",364],"]",")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_THROW","throw",365],["T_WHITESPACE"," ",365],["T_NEW","new",365],["T_WHITESPACE"," ",365],["T_STRING","SecurityException",365],"(",["T_STRING","sprintf",365],"(",["T_VARIABLE","$message",365],",",["T_WHITESPACE"," ",365],["T_CONSTANT_ENCAPSED_STRING","'_Token.debug'",365],")",")",";",["T_WHITESPACE","\n        ",365],"}",["T_WHITESPACE","\n        ",366],["T_IF","if",367],["T_WHITESPACE"," ",367],"(","!",["T_STRING","Configure",367],["T_DOUBLE_COLON","::",367],["T_STRING","read",367],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",367],")",["T_WHITESPACE"," ",367],["T_BOOLEAN_AND","&&",367],["T_WHITESPACE"," ",367],["T_ISSET","isset",367],"(",["T_VARIABLE","$check",367],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",367],"]","[",["T_CONSTANT_ENCAPSED_STRING","'debug'",367],"]",")",")",["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n            ",367],["T_THROW","throw",368],["T_WHITESPACE"," ",368],["T_NEW","new",368],["T_WHITESPACE"," ",368],["T_STRING","SecurityException",368],"(",["T_CONSTANT_ENCAPSED_STRING","'Unexpected \\'_Token.debug\\' found in request data'",368],")",";",["T_WHITESPACE","\n        ",368],"}",["T_WHITESPACE","\n\n        ",369],["T_VARIABLE","$token",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","urldecode",371],"(",["T_VARIABLE","$check",371],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",371],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fields'",371],"]",")",";",["T_WHITESPACE","\n        ",371],["T_IF","if",372],["T_WHITESPACE"," ",372],"(",["T_STRING","strpos",372],"(",["T_VARIABLE","$token",372],",",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","':'",372],")",")",["T_WHITESPACE"," ",372],"{",["T_WHITESPACE","\n            ",372],["T_LIST","list",373],"(",["T_VARIABLE","$token",373],",",["T_WHITESPACE"," ",373],")",["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","explode",373],"(",["T_CONSTANT_ENCAPSED_STRING","':'",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$token",373],",",["T_WHITESPACE"," ",373],["T_LNUMBER","2",373],")",";",["T_WHITESPACE","\n        ",373],"}",["T_WHITESPACE","\n\n        ",374],["T_RETURN","return",376],["T_WHITESPACE"," ",376],["T_VARIABLE","$token",376],";",["T_WHITESPACE","\n    ",376],"}",["T_WHITESPACE","\n\n    ",377],["T_DOC_COMMENT","\/**\n     * Return hash parts for the Token generation\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @return array\n     *\/",379],["T_WHITESPACE","\n    ",384],["T_PROTECTED","protected",385],["T_WHITESPACE"," ",385],["T_FUNCTION","function",385],["T_WHITESPACE"," ",385],["T_STRING","_hashParts",385],"(",["T_STRING","Controller",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$controller",385],")",["T_WHITESPACE","\n    ",385],"{",["T_WHITESPACE","\n        ",386],["T_VARIABLE","$fieldList",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","_fieldsList",387],"(",["T_VARIABLE","$controller",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","request",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","data",387],")",";",["T_WHITESPACE","\n        ",387],["T_VARIABLE","$unlocked",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","_sortedUnlocked",388],"(",["T_VARIABLE","$controller",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","request",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","data",388],")",";",["T_WHITESPACE","\n\n        ",388],["T_RETURN","return",390],["T_WHITESPACE"," ",390],"[",["T_WHITESPACE","\n            ",390],["T_VARIABLE","$controller",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","request",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","here",391],"(",")",",",["T_WHITESPACE","\n            ",391],["T_STRING","serialize",392],"(",["T_VARIABLE","$fieldList",392],")",",",["T_WHITESPACE","\n            ",392],["T_VARIABLE","$unlocked",393],",",["T_WHITESPACE","\n            ",393],["T_STRING","Security",394],["T_DOUBLE_COLON","::",394],["T_STRING","salt",394],"(",")",["T_WHITESPACE","\n        ",394],"]",";",["T_WHITESPACE","\n    ",395],"}",["T_WHITESPACE","\n\n    ",396],["T_DOC_COMMENT","\/**\n     * Return the fields list for the hash calculation\n     *\n     * @param array $check Data array\n     * @return array\n     *\/",398],["T_WHITESPACE","\n    ",403],["T_PROTECTED","protected",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","_fieldsList",404],"(",["T_ARRAY","array",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$check",404],")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_VARIABLE","$locked",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_CONSTANT_ENCAPSED_STRING","''",406],";",["T_WHITESPACE","\n        ",406],["T_VARIABLE","$token",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_STRING","urldecode",407],"(",["T_VARIABLE","$check",407],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",407],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fields'",407],"]",")",";",["T_WHITESPACE","\n        ",407],["T_VARIABLE","$unlocked",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_unlocked",408],"(",["T_VARIABLE","$check",408],")",";",["T_WHITESPACE","\n\n        ",408],["T_IF","if",410],["T_WHITESPACE"," ",410],"(",["T_STRING","strpos",410],"(",["T_VARIABLE","$token",410],",",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","':'",410],")",")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n            ",410],["T_LIST","list",411],"(",["T_VARIABLE","$token",411],",",["T_WHITESPACE"," ",411],["T_VARIABLE","$locked",411],")",["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_STRING","explode",411],"(",["T_CONSTANT_ENCAPSED_STRING","':'",411],",",["T_WHITESPACE"," ",411],["T_VARIABLE","$token",411],",",["T_WHITESPACE"," ",411],["T_LNUMBER","2",411],")",";",["T_WHITESPACE","\n        ",411],"}",["T_WHITESPACE","\n        ",412],["T_UNSET","unset",413],"(",["T_VARIABLE","$check",413],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",413],"]",",",["T_WHITESPACE"," ",413],["T_VARIABLE","$check",413],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",413],"]",")",";",["T_WHITESPACE","\n\n        ",413],["T_VARIABLE","$locked",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","explode",415],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$locked",415],")",";",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$unlocked",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_STRING","explode",416],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$unlocked",416],")",";",["T_WHITESPACE","\n\n        ",416],["T_VARIABLE","$fields",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_STRING","Hash",418],["T_DOUBLE_COLON","::",418],["T_STRING","flatten",418],"(",["T_VARIABLE","$check",418],")",";",["T_WHITESPACE","\n        ",418],["T_VARIABLE","$fieldList",419],["T_WHITESPACE"," ",419],"=",["T_WHITESPACE"," ",419],["T_STRING","array_keys",419],"(",["T_VARIABLE","$fields",419],")",";",["T_WHITESPACE","\n        ",419],["T_VARIABLE","$multi",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_VARIABLE","$lockedFields",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],"[","]",";",["T_WHITESPACE","\n        ",420],["T_VARIABLE","$isUnlocked",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","false",421],";",["T_WHITESPACE","\n\n        ",421],["T_FOREACH","foreach",423],["T_WHITESPACE"," ",423],"(",["T_VARIABLE","$fieldList",423],["T_WHITESPACE"," ",423],["T_AS","as",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$i",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$key",423],")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n            ",423],["T_IF","if",424],["T_WHITESPACE"," ",424],"(",["T_STRING","preg_match",424],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(\\.\\d+){1,10}$\/'",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$key",424],")",")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n                ",424],["T_VARIABLE","$multi",425],"[",["T_VARIABLE","$i",425],"]",["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_STRING","preg_replace",425],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(\\.\\d+){1,10}$\/'",425],",",["T_WHITESPACE"," ",425],["T_CONSTANT_ENCAPSED_STRING","''",425],",",["T_WHITESPACE"," ",425],["T_VARIABLE","$key",425],")",";",["T_WHITESPACE","\n                ",425],["T_UNSET","unset",426],"(",["T_VARIABLE","$fieldList",426],"[",["T_VARIABLE","$i",426],"]",")",";",["T_WHITESPACE","\n            ",426],"}",["T_WHITESPACE"," ",427],["T_ELSE","else",427],["T_WHITESPACE"," ",427],"{",["T_WHITESPACE","\n                ",427],["T_VARIABLE","$fieldList",428],"[",["T_VARIABLE","$i",428],"]",["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_STRING_CAST","(string)",428],["T_VARIABLE","$key",428],";",["T_WHITESPACE","\n            ",428],"}",["T_WHITESPACE","\n        ",429],"}",["T_WHITESPACE","\n        ",430],["T_IF","if",431],["T_WHITESPACE"," ",431],"(","!",["T_EMPTY","empty",431],"(",["T_VARIABLE","$multi",431],")",")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n            ",431],["T_VARIABLE","$fieldList",432],["T_WHITESPACE"," ",432],["T_PLUS_EQUAL","+=",432],["T_WHITESPACE"," ",432],["T_STRING","array_unique",432],"(",["T_VARIABLE","$multi",432],")",";",["T_WHITESPACE","\n        ",432],"}",["T_WHITESPACE","\n\n        ",433],["T_VARIABLE","$unlockedFields",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_STRING","array_unique",435],"(",["T_WHITESPACE","\n            ",435],["T_STRING","array_merge",436],"(",["T_ARRAY_CAST","(array)",436],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","config",436],"(",["T_CONSTANT_ENCAPSED_STRING","'disabledFields'",436],")",",",["T_WHITESPACE"," ",436],["T_ARRAY_CAST","(array)",436],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","_config",436],"[",["T_CONSTANT_ENCAPSED_STRING","'unlockedFields'",436],"]",",",["T_WHITESPACE"," ",436],["T_VARIABLE","$unlocked",436],")",["T_WHITESPACE","\n        ",436],")",";",["T_WHITESPACE","\n\n        ",437],["T_FOREACH","foreach",439],["T_WHITESPACE"," ",439],"(",["T_VARIABLE","$fieldList",439],["T_WHITESPACE"," ",439],["T_AS","as",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$i",439],["T_WHITESPACE"," ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$key",439],")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n            ",439],["T_VARIABLE","$isLocked",440],["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],"(",["T_STRING","is_array",440],"(",["T_VARIABLE","$locked",440],")",["T_WHITESPACE"," ",440],["T_BOOLEAN_AND","&&",440],["T_WHITESPACE"," ",440],["T_STRING","in_array",440],"(",["T_VARIABLE","$key",440],",",["T_WHITESPACE"," ",440],["T_VARIABLE","$locked",440],")",")",";",["T_WHITESPACE","\n\n            ",440],["T_IF","if",442],["T_WHITESPACE"," ",442],"(","!",["T_EMPTY","empty",442],"(",["T_VARIABLE","$unlockedFields",442],")",")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n                ",442],["T_FOREACH","foreach",443],["T_WHITESPACE"," ",443],"(",["T_VARIABLE","$unlockedFields",443],["T_WHITESPACE"," ",443],["T_AS","as",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$off",443],")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n                    ",443],["T_VARIABLE","$off",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_STRING","explode",444],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",444],",",["T_WHITESPACE"," ",444],["T_VARIABLE","$off",444],")",";",["T_WHITESPACE","\n                    ",444],["T_VARIABLE","$field",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_STRING","array_values",445],"(",["T_STRING","array_intersect",445],"(",["T_STRING","explode",445],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$key",445],")",",",["T_WHITESPACE"," ",445],["T_VARIABLE","$off",445],")",")",";",["T_WHITESPACE","\n                    ",445],["T_VARIABLE","$isUnlocked",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],"(",["T_VARIABLE","$field",446],["T_WHITESPACE"," ",446],["T_IS_IDENTICAL","===",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$off",446],")",";",["T_WHITESPACE","\n                    ",446],["T_IF","if",447],["T_WHITESPACE"," ",447],"(",["T_VARIABLE","$isUnlocked",447],")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n                        ",447],["T_BREAK","break",448],";",["T_WHITESPACE","\n                    ",448],"}",["T_WHITESPACE","\n                ",449],"}",["T_WHITESPACE","\n            ",450],"}",["T_WHITESPACE","\n\n            ",451],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_VARIABLE","$isUnlocked",453],["T_WHITESPACE"," ",453],["T_BOOLEAN_OR","||",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$isLocked",453],")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n                ",453],["T_UNSET","unset",454],"(",["T_VARIABLE","$fieldList",454],"[",["T_VARIABLE","$i",454],"]",")",";",["T_WHITESPACE","\n                ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$isLocked",455],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                    ",455],["T_VARIABLE","$lockedFields",456],"[",["T_VARIABLE","$key",456],"]",["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_VARIABLE","$fields",456],"[",["T_VARIABLE","$key",456],"]",";",["T_WHITESPACE","\n                ",456],"}",["T_WHITESPACE","\n            ",457],"}",["T_WHITESPACE","\n        ",458],"}",["T_WHITESPACE","\n        ",459],["T_STRING","sort",460],"(",["T_VARIABLE","$fieldList",460],",",["T_WHITESPACE"," ",460],["T_STRING","SORT_STRING",460],")",";",["T_WHITESPACE","\n        ",460],["T_STRING","ksort",461],"(",["T_VARIABLE","$lockedFields",461],",",["T_WHITESPACE"," ",461],["T_STRING","SORT_STRING",461],")",";",["T_WHITESPACE","\n        ",461],["T_VARIABLE","$fieldList",462],["T_WHITESPACE"," ",462],["T_PLUS_EQUAL","+=",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$lockedFields",462],";",["T_WHITESPACE","\n\n        ",462],["T_RETURN","return",464],["T_WHITESPACE"," ",464],["T_VARIABLE","$fieldList",464],";",["T_WHITESPACE","\n    ",464],"}",["T_WHITESPACE","\n\n\n    ",465],["T_DOC_COMMENT","\/**\n     * Get the unlocked string\n     *\n     * @param array $data Data array\n     * @return string\n     *\/",468],["T_WHITESPACE","\n    ",473],["T_PROTECTED","protected",474],["T_WHITESPACE"," ",474],["T_FUNCTION","function",474],["T_WHITESPACE"," ",474],["T_STRING","_unlocked",474],"(",["T_ARRAY","array",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$data",474],")",["T_WHITESPACE","\n    ",474],"{",["T_WHITESPACE","\n        ",475],["T_RETURN","return",476],["T_WHITESPACE"," ",476],["T_STRING","urldecode",476],"(",["T_VARIABLE","$data",476],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",476],"]","[",["T_CONSTANT_ENCAPSED_STRING","'unlocked'",476],"]",")",";",["T_WHITESPACE","\n    ",476],"}",["T_WHITESPACE","\n\n    ",477],["T_DOC_COMMENT","\/**\n     * Get the sorted unlocked string\n     *\n     * @param array $data Data array\n     * @return string\n     *\/",479],["T_WHITESPACE","\n    ",484],["T_PROTECTED","protected",485],["T_WHITESPACE"," ",485],["T_FUNCTION","function",485],["T_WHITESPACE"," ",485],["T_STRING","_sortedUnlocked",485],"(",["T_VARIABLE","$data",485],")",["T_WHITESPACE","\n    ",485],"{",["T_WHITESPACE","\n        ",486],["T_VARIABLE","$unlocked",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","_unlocked",487],"(",["T_VARIABLE","$data",487],")",";",["T_WHITESPACE","\n        ",487],["T_VARIABLE","$unlocked",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_STRING","explode",488],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",488],",",["T_WHITESPACE"," ",488],["T_VARIABLE","$unlocked",488],")",";",["T_WHITESPACE","\n        ",488],["T_STRING","sort",489],"(",["T_VARIABLE","$unlocked",489],",",["T_WHITESPACE"," ",489],["T_STRING","SORT_STRING",489],")",";",["T_WHITESPACE","\n\n        ",489],["T_RETURN","return",491],["T_WHITESPACE"," ",491],["T_STRING","implode",491],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",491],",",["T_WHITESPACE"," ",491],["T_VARIABLE","$unlocked",491],")",";",["T_WHITESPACE","\n    ",491],"}",["T_WHITESPACE","\n\n    ",492],["T_DOC_COMMENT","\/**\n     * Create a message for humans to understand why Security token is not matching\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @param array $hashParts Elements used to generate the Token hash\n     * @return string Message explaining why the tokens are not matching\n     *\/",494],["T_WHITESPACE","\n    ",500],["T_PROTECTED","protected",501],["T_WHITESPACE"," ",501],["T_FUNCTION","function",501],["T_WHITESPACE"," ",501],["T_STRING","_debugPostTokenNotMatching",501],"(",["T_STRING","Controller",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$controller",501],",",["T_WHITESPACE"," ",501],["T_VARIABLE","$hashParts",501],")",["T_WHITESPACE","\n    ",501],"{",["T_WHITESPACE","\n        ",502],["T_VARIABLE","$messages",503],["T_WHITESPACE"," ",503],"=",["T_WHITESPACE"," ",503],"[","]",";",["T_WHITESPACE","\n        ",503],["T_VARIABLE","$expectedParts",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_STRING","json_decode",504],"(",["T_STRING","urldecode",504],"(",["T_VARIABLE","$controller",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","request",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","data",504],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",504],"]","[",["T_CONSTANT_ENCAPSED_STRING","'debug'",504],"]",")",",",["T_WHITESPACE"," ",504],["T_STRING","true",504],")",";",["T_WHITESPACE","\n        ",504],["T_IF","if",505],["T_WHITESPACE"," ",505],"(","!",["T_STRING","is_array",505],"(",["T_VARIABLE","$expectedParts",505],")",["T_WHITESPACE"," ",505],["T_BOOLEAN_OR","||",505],["T_WHITESPACE"," ",505],["T_STRING","count",505],"(",["T_VARIABLE","$expectedParts",505],")",["T_WHITESPACE"," ",505],["T_IS_NOT_IDENTICAL","!==",505],["T_WHITESPACE"," ",505],["T_LNUMBER","3",505],")",["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n            ",505],["T_RETURN","return",506],["T_WHITESPACE"," ",506],["T_CONSTANT_ENCAPSED_STRING","'Invalid security debug token.'",506],";",["T_WHITESPACE","\n        ",506],"}",["T_WHITESPACE","\n        ",507],["T_VARIABLE","$expectedUrl",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_STRING","Hash",508],["T_DOUBLE_COLON","::",508],["T_STRING","get",508],"(",["T_VARIABLE","$expectedParts",508],",",["T_WHITESPACE"," ",508],["T_LNUMBER","0",508],")",";",["T_WHITESPACE","\n        ",508],["T_VARIABLE","$url",509],["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_STRING","Hash",509],["T_DOUBLE_COLON","::",509],["T_STRING","get",509],"(",["T_VARIABLE","$hashParts",509],",",["T_WHITESPACE"," ",509],["T_LNUMBER","0",509],")",";",["T_WHITESPACE","\n        ",509],["T_IF","if",510],["T_WHITESPACE"," ",510],"(",["T_VARIABLE","$expectedUrl",510],["T_WHITESPACE"," ",510],["T_IS_NOT_IDENTICAL","!==",510],["T_WHITESPACE"," ",510],["T_VARIABLE","$url",510],")",["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n            ",510],["T_VARIABLE","$messages",511],"[","]",["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_STRING","sprintf",511],"(",["T_CONSTANT_ENCAPSED_STRING","'URL mismatch in POST data (expected \\'%s\\' but found \\'%s\\')'",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$expectedUrl",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$url",511],")",";",["T_WHITESPACE","\n        ",511],"}",["T_WHITESPACE","\n        ",512],["T_VARIABLE","$expectedFields",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_STRING","Hash",513],["T_DOUBLE_COLON","::",513],["T_STRING","get",513],"(",["T_VARIABLE","$expectedParts",513],",",["T_WHITESPACE"," ",513],["T_LNUMBER","1",513],")",";",["T_WHITESPACE","\n        ",513],["T_VARIABLE","$dataFields",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_STRING","Hash",514],["T_DOUBLE_COLON","::",514],["T_STRING","get",514],"(",["T_VARIABLE","$hashParts",514],",",["T_WHITESPACE"," ",514],["T_LNUMBER","1",514],")",";",["T_WHITESPACE","\n        ",514],["T_IF","if",515],["T_WHITESPACE"," ",515],"(",["T_VARIABLE","$dataFields",515],")",["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n            ",515],["T_VARIABLE","$dataFields",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_STRING","unserialize",516],"(",["T_VARIABLE","$dataFields",516],")",";",["T_WHITESPACE","\n        ",516],"}",["T_WHITESPACE","\n        ",517],["T_VARIABLE","$fieldsMessages",518],["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","_debugCheckFields",518],"(",["T_WHITESPACE","\n            ",518],["T_VARIABLE","$dataFields",519],",",["T_WHITESPACE","\n            ",519],["T_VARIABLE","$expectedFields",520],",",["T_WHITESPACE","\n            ",520],["T_CONSTANT_ENCAPSED_STRING","'Unexpected field \\'%s\\' in POST data'",521],",",["T_WHITESPACE","\n            ",521],["T_CONSTANT_ENCAPSED_STRING","'Tampered field \\'%s\\' in POST data (expected value \\'%s\\' but found \\'%s\\')'",522],",",["T_WHITESPACE","\n            ",522],["T_CONSTANT_ENCAPSED_STRING","'Missing field \\'%s\\' in POST data'",523],["T_WHITESPACE","\n        ",523],")",";",["T_WHITESPACE","\n        ",524],["T_VARIABLE","$expectedUnlockedFields",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_STRING","Hash",525],["T_DOUBLE_COLON","::",525],["T_STRING","get",525],"(",["T_VARIABLE","$expectedParts",525],",",["T_WHITESPACE"," ",525],["T_LNUMBER","2",525],")",";",["T_WHITESPACE","\n        ",525],["T_VARIABLE","$dataUnlockedFields",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_STRING","Hash",526],["T_DOUBLE_COLON","::",526],["T_STRING","get",526],"(",["T_VARIABLE","$hashParts",526],",",["T_WHITESPACE"," ",526],["T_LNUMBER","2",526],")",["T_WHITESPACE"," ",526],"?",":",["T_WHITESPACE"," ",526],"[","]",";",["T_WHITESPACE","\n        ",526],["T_IF","if",527],["T_WHITESPACE"," ",527],"(",["T_VARIABLE","$dataUnlockedFields",527],")",["T_WHITESPACE"," ",527],"{",["T_WHITESPACE","\n            ",527],["T_VARIABLE","$dataUnlockedFields",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_STRING","explode",528],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",528],",",["T_WHITESPACE"," ",528],["T_VARIABLE","$dataUnlockedFields",528],")",";",["T_WHITESPACE","\n        ",528],"}",["T_WHITESPACE","\n        ",529],["T_VARIABLE","$unlockFieldsMessages",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","_debugCheckFields",530],"(",["T_WHITESPACE","\n            ",530],["T_VARIABLE","$dataUnlockedFields",531],",",["T_WHITESPACE","\n            ",531],["T_VARIABLE","$expectedUnlockedFields",532],",",["T_WHITESPACE","\n            ",532],["T_CONSTANT_ENCAPSED_STRING","'Unexpected unlocked field \\'%s\\' in POST data'",533],",",["T_WHITESPACE","\n            ",533],["T_STRING","null",534],",",["T_WHITESPACE","\n            ",534],["T_CONSTANT_ENCAPSED_STRING","'Missing unlocked field: \\'%s\\''",535],["T_WHITESPACE","\n        ",535],")",";",["T_WHITESPACE","\n\n        ",536],["T_VARIABLE","$messages",538],["T_WHITESPACE"," ",538],"=",["T_WHITESPACE"," ",538],["T_STRING","array_merge",538],"(",["T_VARIABLE","$messages",538],",",["T_WHITESPACE"," ",538],["T_VARIABLE","$fieldsMessages",538],",",["T_WHITESPACE"," ",538],["T_VARIABLE","$unlockFieldsMessages",538],")",";",["T_WHITESPACE","\n\n        ",538],["T_RETURN","return",540],["T_WHITESPACE"," ",540],["T_STRING","implode",540],"(",["T_CONSTANT_ENCAPSED_STRING","', '",540],",",["T_WHITESPACE"," ",540],["T_VARIABLE","$messages",540],")",";",["T_WHITESPACE","\n    ",540],"}",["T_WHITESPACE","\n\n    ",541],["T_DOC_COMMENT","\/**\n     * Iterates data array to check against expected\n     *\n     * @param array $dataFields Fields array, containing the POST data fields\n     * @param array $expectedFields Fields array, containing the expected fields we should have in POST\n     * @param string $intKeyMessage Message string if unexpected found in data fields indexed by int (not protected)\n     * @param string $stringKeyMessage Message string if tampered found in data fields indexed by string (protected)\n     * @param string $missingMessage Message string if missing field\n     * @return array Messages\n     *\/",543],["T_WHITESPACE","\n    ",552],["T_PROTECTED","protected",553],["T_WHITESPACE"," ",553],["T_FUNCTION","function",553],["T_WHITESPACE"," ",553],["T_STRING","_debugCheckFields",553],"(",["T_VARIABLE","$dataFields",553],",",["T_WHITESPACE"," ",553],["T_VARIABLE","$expectedFields",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],"[","]",",",["T_WHITESPACE"," ",553],["T_VARIABLE","$intKeyMessage",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_CONSTANT_ENCAPSED_STRING","''",553],",",["T_WHITESPACE"," ",553],["T_VARIABLE","$stringKeyMessage",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_CONSTANT_ENCAPSED_STRING","''",553],",",["T_WHITESPACE"," ",553],["T_VARIABLE","$missingMessage",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_CONSTANT_ENCAPSED_STRING","''",553],")",["T_WHITESPACE","\n    ",553],"{",["T_WHITESPACE","\n        ",554],["T_VARIABLE","$messages",555],["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","_matchExistingFields",555],"(",["T_VARIABLE","$dataFields",555],",",["T_WHITESPACE"," ",555],["T_VARIABLE","$expectedFields",555],",",["T_WHITESPACE"," ",555],["T_VARIABLE","$intKeyMessage",555],",",["T_WHITESPACE"," ",555],["T_VARIABLE","$stringKeyMessage",555],")",";",["T_WHITESPACE","\n        ",555],["T_VARIABLE","$expectedFieldsMessage",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_VARIABLE","$this",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","_debugExpectedFields",556],"(",["T_VARIABLE","$expectedFields",556],",",["T_WHITESPACE"," ",556],["T_VARIABLE","$missingMessage",556],")",";",["T_WHITESPACE","\n        ",556],["T_IF","if",557],["T_WHITESPACE"," ",557],"(",["T_VARIABLE","$expectedFieldsMessage",557],["T_WHITESPACE"," ",557],["T_IS_NOT_IDENTICAL","!==",557],["T_WHITESPACE"," ",557],["T_STRING","null",557],")",["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n            ",557],["T_VARIABLE","$messages",558],"[","]",["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_VARIABLE","$expectedFieldsMessage",558],";",["T_WHITESPACE","\n        ",558],"}",["T_WHITESPACE","\n\n        ",559],["T_RETURN","return",561],["T_WHITESPACE"," ",561],["T_VARIABLE","$messages",561],";",["T_WHITESPACE","\n    ",561],"}",["T_WHITESPACE","\n\n    ",562],["T_DOC_COMMENT","\/**\n     * Manually add form tampering prevention token information into the provided\n     * request object.\n     *\n     * @param \\Cake\\Network\\Request $request The request object to add into.\n     * @return bool\n     *\/",564],["T_WHITESPACE","\n    ",570],["T_PUBLIC","public",571],["T_WHITESPACE"," ",571],["T_FUNCTION","function",571],["T_WHITESPACE"," ",571],["T_STRING","generateToken",571],"(",["T_STRING","Request",571],["T_WHITESPACE"," ",571],["T_VARIABLE","$request",571],")",["T_WHITESPACE","\n    ",571],"{",["T_WHITESPACE","\n        ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(",["T_ISSET","isset",573],"(",["T_VARIABLE","$request",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","params",573],"[",["T_CONSTANT_ENCAPSED_STRING","'requested'",573],"]",")",["T_WHITESPACE"," ",573],["T_BOOLEAN_AND","&&",573],["T_WHITESPACE"," ",573],["T_VARIABLE","$request",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","params",573],"[",["T_CONSTANT_ENCAPSED_STRING","'requested'",573],"]",["T_WHITESPACE"," ",573],["T_IS_IDENTICAL","===",573],["T_WHITESPACE"," ",573],["T_LNUMBER","1",573],")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_IF","if",574],["T_WHITESPACE"," ",574],"(",["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","session",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","check",574],"(",["T_CONSTANT_ENCAPSED_STRING","'_Token'",574],")",")",["T_WHITESPACE"," ",574],"{",["T_WHITESPACE","\n                ",574],["T_VARIABLE","$request",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","params",575],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",575],"]",["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","session",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","read",575],"(",["T_CONSTANT_ENCAPSED_STRING","'_Token'",575],")",";",["T_WHITESPACE","\n            ",575],"}",["T_WHITESPACE","\n\n            ",576],["T_RETURN","return",578],["T_WHITESPACE"," ",578],["T_STRING","false",578],";",["T_WHITESPACE","\n        ",578],"}",["T_WHITESPACE","\n        ",579],["T_VARIABLE","$token",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],"[",["T_WHITESPACE","\n            ",580],["T_CONSTANT_ENCAPSED_STRING","'allowedControllers'",581],["T_WHITESPACE"," ",581],["T_DOUBLE_ARROW","=>",581],["T_WHITESPACE"," ",581],["T_VARIABLE","$this",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","_config",581],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedControllers'",581],"]",",",["T_WHITESPACE","\n            ",581],["T_CONSTANT_ENCAPSED_STRING","'allowedActions'",582],["T_WHITESPACE"," ",582],["T_DOUBLE_ARROW","=>",582],["T_WHITESPACE"," ",582],["T_VARIABLE","$this",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","_config",582],"[",["T_CONSTANT_ENCAPSED_STRING","'allowedActions'",582],"]",",",["T_WHITESPACE","\n            ",582],["T_CONSTANT_ENCAPSED_STRING","'unlockedFields'",583],["T_WHITESPACE"," ",583],["T_DOUBLE_ARROW","=>",583],["T_WHITESPACE"," ",583],["T_VARIABLE","$this",583],["T_OBJECT_OPERATOR","->",583],["T_STRING","_config",583],"[",["T_CONSTANT_ENCAPSED_STRING","'unlockedFields'",583],"]",",",["T_WHITESPACE","\n        ",583],"]",";",["T_WHITESPACE","\n\n        ",584],["T_VARIABLE","$this",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","session",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","write",586],"(",["T_CONSTANT_ENCAPSED_STRING","'_Token'",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$token",586],")",";",["T_WHITESPACE","\n        ",586],["T_VARIABLE","$request",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","params",587],"[",["T_CONSTANT_ENCAPSED_STRING","'_Token'",587],"]",["T_WHITESPACE"," ",587],"=",["T_WHITESPACE"," ",587],"[",["T_WHITESPACE","\n            ",587],["T_CONSTANT_ENCAPSED_STRING","'unlockedFields'",588],["T_WHITESPACE"," ",588],["T_DOUBLE_ARROW","=>",588],["T_WHITESPACE"," ",588],["T_VARIABLE","$token",588],"[",["T_CONSTANT_ENCAPSED_STRING","'unlockedFields'",588],"]",["T_WHITESPACE","\n        ",588],"]",";",["T_WHITESPACE","\n\n        ",589],["T_RETURN","return",591],["T_WHITESPACE"," ",591],["T_STRING","true",591],";",["T_WHITESPACE","\n    ",591],"}",["T_WHITESPACE","\n\n    ",592],["T_DOC_COMMENT","\/**\n     * Calls a controller callback method\n     *\n     * @param \\Cake\\Controller\\Controller $controller Instantiating controller\n     * @param string $method Method to execute\n     * @param array $params Parameters to send to method\n     * @return mixed Controller callback method's response\n     * @throws \\Cake\\Network\\Exception\\BadRequestException When a the blackholeCallback is not callable.\n     *\/",594],["T_WHITESPACE","\n    ",602],["T_PROTECTED","protected",603],["T_WHITESPACE"," ",603],["T_FUNCTION","function",603],["T_WHITESPACE"," ",603],["T_STRING","_callback",603],"(",["T_STRING","Controller",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$controller",603],",",["T_WHITESPACE"," ",603],["T_VARIABLE","$method",603],",",["T_WHITESPACE"," ",603],["T_VARIABLE","$params",603],["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],"[","]",")",["T_WHITESPACE","\n    ",603],"{",["T_WHITESPACE","\n        ",604],["T_IF","if",605],["T_WHITESPACE"," ",605],"(","!",["T_STRING","is_callable",605],"(","[",["T_VARIABLE","$controller",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$method",605],"]",")",")",["T_WHITESPACE"," ",605],"{",["T_WHITESPACE","\n            ",605],["T_THROW","throw",606],["T_WHITESPACE"," ",606],["T_NEW","new",606],["T_WHITESPACE"," ",606],["T_STRING","BadRequestException",606],"(",["T_CONSTANT_ENCAPSED_STRING","'The request has been black-holed'",606],")",";",["T_WHITESPACE","\n        ",606],"}",["T_WHITESPACE","\n\n        ",607],["T_RETURN","return",609],["T_WHITESPACE"," ",609],["T_STRING","call_user_func_array",609],"(","[","&",["T_VARIABLE","$controller",609],",",["T_WHITESPACE"," ",609],["T_VARIABLE","$method",609],"]",",",["T_WHITESPACE"," ",609],["T_EMPTY","empty",609],"(",["T_VARIABLE","$params",609],")",["T_WHITESPACE"," ",609],"?",["T_WHITESPACE"," ",609],["T_STRING","null",609],["T_WHITESPACE"," ",609],":",["T_WHITESPACE"," ",609],["T_VARIABLE","$params",609],")",";",["T_WHITESPACE","\n    ",609],"}",["T_WHITESPACE","\n\n    ",610],["T_DOC_COMMENT","\/**\n     * Generate array of messages for the existing fields in POST data, matching dataFields in $expectedFields\n     * will be unset\n     *\n     * @param array $dataFields Fields array, containing the POST data fields\n     * @param array $expectedFields Fields array, containing the expected fields we should have in POST\n     * @param string $intKeyMessage Message string if unexpected found in data fields indexed by int (not protected)\n     * @param string $stringKeyMessage Message string if tampered found in data fields indexed by string (protected)\n     * @return array Error messages\n     *\/",612],["T_WHITESPACE","\n    ",621],["T_PROTECTED","protected",622],["T_WHITESPACE"," ",622],["T_FUNCTION","function",622],["T_WHITESPACE"," ",622],["T_STRING","_matchExistingFields",622],"(",["T_VARIABLE","$dataFields",622],",",["T_WHITESPACE"," ",622],"&",["T_VARIABLE","$expectedFields",622],",",["T_WHITESPACE"," ",622],["T_VARIABLE","$intKeyMessage",622],",",["T_WHITESPACE"," ",622],["T_VARIABLE","$stringKeyMessage",622],")",["T_WHITESPACE","\n    ",622],"{",["T_WHITESPACE","\n        ",623],["T_VARIABLE","$messages",624],["T_WHITESPACE"," ",624],"=",["T_WHITESPACE"," ",624],"[","]",";",["T_WHITESPACE","\n        ",624],["T_FOREACH","foreach",625],["T_WHITESPACE"," ",625],"(",["T_ARRAY_CAST","(array)",625],["T_VARIABLE","$dataFields",625],["T_WHITESPACE"," ",625],["T_AS","as",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$key",625],["T_WHITESPACE"," ",625],["T_DOUBLE_ARROW","=>",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$value",625],")",["T_WHITESPACE"," ",625],"{",["T_WHITESPACE","\n            ",625],["T_IF","if",626],["T_WHITESPACE"," ",626],"(",["T_STRING","is_int",626],"(",["T_VARIABLE","$key",626],")",")",["T_WHITESPACE"," ",626],"{",["T_WHITESPACE","\n                ",626],["T_VARIABLE","$foundKey",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_STRING","array_search",627],"(",["T_VARIABLE","$value",627],",",["T_WHITESPACE"," ",627],["T_ARRAY_CAST","(array)",627],["T_VARIABLE","$expectedFields",627],")",";",["T_WHITESPACE","\n                ",627],["T_IF","if",628],["T_WHITESPACE"," ",628],"(",["T_VARIABLE","$foundKey",628],["T_WHITESPACE"," ",628],["T_IS_IDENTICAL","===",628],["T_WHITESPACE"," ",628],["T_STRING","false",628],")",["T_WHITESPACE"," ",628],"{",["T_WHITESPACE","\n                    ",628],["T_VARIABLE","$messages",629],"[","]",["T_WHITESPACE"," ",629],"=",["T_WHITESPACE"," ",629],["T_STRING","sprintf",629],"(",["T_VARIABLE","$intKeyMessage",629],",",["T_WHITESPACE"," ",629],["T_VARIABLE","$value",629],")",";",["T_WHITESPACE","\n                ",629],"}",["T_WHITESPACE"," ",630],["T_ELSE","else",630],["T_WHITESPACE"," ",630],"{",["T_WHITESPACE","\n                    ",630],["T_UNSET","unset",631],"(",["T_VARIABLE","$expectedFields",631],"[",["T_VARIABLE","$foundKey",631],"]",")",";",["T_WHITESPACE","\n                ",631],"}",["T_WHITESPACE","\n            ",632],"}",["T_WHITESPACE"," ",633],["T_ELSEIF","elseif",633],["T_WHITESPACE"," ",633],"(",["T_STRING","is_string",633],"(",["T_VARIABLE","$key",633],")",")",["T_WHITESPACE"," ",633],"{",["T_WHITESPACE","\n                ",633],["T_IF","if",634],["T_WHITESPACE"," ",634],"(",["T_ISSET","isset",634],"(",["T_VARIABLE","$expectedFields",634],"[",["T_VARIABLE","$key",634],"]",")",["T_WHITESPACE"," ",634],["T_BOOLEAN_AND","&&",634],["T_WHITESPACE"," ",634],["T_VARIABLE","$value",634],["T_WHITESPACE"," ",634],["T_IS_NOT_IDENTICAL","!==",634],["T_WHITESPACE"," ",634],["T_VARIABLE","$expectedFields",634],"[",["T_VARIABLE","$key",634],"]",")",["T_WHITESPACE"," ",634],"{",["T_WHITESPACE","\n                    ",634],["T_VARIABLE","$messages",635],"[","]",["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_STRING","sprintf",635],"(",["T_VARIABLE","$stringKeyMessage",635],",",["T_WHITESPACE"," ",635],["T_VARIABLE","$key",635],",",["T_WHITESPACE"," ",635],["T_VARIABLE","$expectedFields",635],"[",["T_VARIABLE","$key",635],"]",",",["T_WHITESPACE"," ",635],["T_VARIABLE","$value",635],")",";",["T_WHITESPACE","\n                ",635],"}",["T_WHITESPACE","\n                ",636],["T_UNSET","unset",637],"(",["T_VARIABLE","$expectedFields",637],"[",["T_VARIABLE","$key",637],"]",")",";",["T_WHITESPACE","\n            ",637],"}",["T_WHITESPACE","\n        ",638],"}",["T_WHITESPACE","\n\n        ",639],["T_RETURN","return",641],["T_WHITESPACE"," ",641],["T_VARIABLE","$messages",641],";",["T_WHITESPACE","\n    ",641],"}",["T_WHITESPACE","\n\n    ",642],["T_DOC_COMMENT","\/**\n     * Generate debug message for the expected fields\n     *\n     * @param array $expectedFields Expected fields\n     * @param string $missingMessage Message template\n     * @return string Error message about expected fields\n     *\/",644],["T_WHITESPACE","\n    ",650],["T_PROTECTED","protected",651],["T_WHITESPACE"," ",651],["T_FUNCTION","function",651],["T_WHITESPACE"," ",651],["T_STRING","_debugExpectedFields",651],"(",["T_VARIABLE","$expectedFields",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],"[","]",",",["T_WHITESPACE"," ",651],["T_VARIABLE","$missingMessage",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_CONSTANT_ENCAPSED_STRING","''",651],")",["T_WHITESPACE","\n    ",651],"{",["T_WHITESPACE","\n        ",652],["T_IF","if",653],["T_WHITESPACE"," ",653],"(",["T_STRING","count",653],"(",["T_VARIABLE","$expectedFields",653],")",["T_WHITESPACE"," ",653],["T_IS_IDENTICAL","===",653],["T_WHITESPACE"," ",653],["T_LNUMBER","0",653],")",["T_WHITESPACE"," ",653],"{",["T_WHITESPACE","\n            ",653],["T_RETURN","return",654],["T_WHITESPACE"," ",654],["T_STRING","null",654],";",["T_WHITESPACE","\n        ",654],"}",["T_WHITESPACE","\n\n        ",655],["T_VARIABLE","$expectedFieldNames",657],["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],"[","]",";",["T_WHITESPACE","\n        ",657],["T_FOREACH","foreach",658],["T_WHITESPACE"," ",658],"(",["T_ARRAY_CAST","(array)",658],["T_VARIABLE","$expectedFields",658],["T_WHITESPACE"," ",658],["T_AS","as",658],["T_WHITESPACE"," ",658],["T_VARIABLE","$key",658],["T_WHITESPACE"," ",658],["T_DOUBLE_ARROW","=>",658],["T_WHITESPACE"," ",658],["T_VARIABLE","$expectedField",658],")",["T_WHITESPACE"," ",658],"{",["T_WHITESPACE","\n            ",658],["T_IF","if",659],["T_WHITESPACE"," ",659],"(",["T_STRING","is_int",659],"(",["T_VARIABLE","$key",659],")",")",["T_WHITESPACE"," ",659],"{",["T_WHITESPACE","\n                ",659],["T_VARIABLE","$expectedFieldNames",660],"[","]",["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_VARIABLE","$expectedField",660],";",["T_WHITESPACE","\n            ",660],"}",["T_WHITESPACE"," ",661],["T_ELSE","else",661],["T_WHITESPACE"," ",661],"{",["T_WHITESPACE","\n                ",661],["T_VARIABLE","$expectedFieldNames",662],"[","]",["T_WHITESPACE"," ",662],"=",["T_WHITESPACE"," ",662],["T_VARIABLE","$key",662],";",["T_WHITESPACE","\n            ",662],"}",["T_WHITESPACE","\n        ",663],"}",["T_WHITESPACE","\n\n        ",664],["T_RETURN","return",666],["T_WHITESPACE"," ",666],["T_STRING","sprintf",666],"(",["T_VARIABLE","$missingMessage",666],",",["T_WHITESPACE"," ",666],["T_STRING","implode",666],"(",["T_CONSTANT_ENCAPSED_STRING","', '",666],",",["T_WHITESPACE"," ",666],["T_VARIABLE","$expectedFieldNames",666],")",")",";",["T_WHITESPACE","\n    ",666],"}",["T_WHITESPACE","\n",667],"}",["T_WHITESPACE","\n",668]]