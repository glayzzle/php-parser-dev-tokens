[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Database Session save handler. Allows saving session information into a model.\n *\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         2.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n\n",16],["T_NAMESPACE","namespace",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Network",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Session",18],";",["T_WHITESPACE","\n\n",18],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","ORM",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Entity",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","ORM",21],["T_NS_SEPARATOR","\\",21],["T_STRING","TableRegistry",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","SessionHandlerInterface",22],";",["T_WHITESPACE","\n\n",22],["T_DOC_COMMENT","\/**\n * DatabaseSession provides methods to be used with Session.\n *\/",24],["T_WHITESPACE","\n",26],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","DatabaseSession",27],["T_WHITESPACE"," ",27],["T_IMPLEMENTS","implements",27],["T_WHITESPACE"," ",27],["T_STRING","SessionHandlerInterface",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Reference to the table handling the session data\n     *\n     * @var \\Cake\\ORM\\Table\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$_table",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Number of seconds to mark the session as expired\n     *\n     * @var int\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_timeout",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Constructor. Looks at Session configuration information and\n     * sets up the session model.\n     *\n     * @param array $config The configuration for this engine. It requires the 'model'\n     * key to be present corresponding to the Table to use for managing the sessions.\n     *\/",44],["T_WHITESPACE","\n    ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","__construct",51],"(",["T_ARRAY","array",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$config",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],"[","]",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$tableLocator",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_ISSET","isset",53],"(",["T_VARIABLE","$config",53],"[",["T_CONSTANT_ENCAPSED_STRING","'tableLocator'",53],"]",")",["T_WHITESPACE"," ",53],"?",["T_WHITESPACE"," ",53],["T_VARIABLE","$config",53],"[",["T_CONSTANT_ENCAPSED_STRING","'tableLocator'",53],"]",["T_WHITESPACE"," ",53],":",["T_WHITESPACE"," ",53],["T_STRING","TableRegistry",53],["T_DOUBLE_COLON","::",53],["T_STRING","locator",53],"(",")",";",["T_WHITESPACE","\n\n        ",53],["T_IF","if",55],["T_WHITESPACE"," ",55],"(",["T_EMPTY","empty",55],"(",["T_VARIABLE","$config",55],"[",["T_CONSTANT_ENCAPSED_STRING","'model'",55],"]",")",")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$config",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$tableLocator",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","exists",56],"(",["T_CONSTANT_ENCAPSED_STRING","'Sessions'",56],")",["T_WHITESPACE"," ",56],"?",["T_WHITESPACE"," ",56],"[","]",["T_WHITESPACE"," ",56],":",["T_WHITESPACE"," ",56],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'sessions'",56],"]",";",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_table",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$tableLocator",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","get",57],"(",["T_CONSTANT_ENCAPSED_STRING","'Sessions'",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$config",57],")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE"," ",58],["T_ELSE","else",58],["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_table",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$tableLocator",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","get",59],"(",["T_VARIABLE","$config",59],"[",["T_CONSTANT_ENCAPSED_STRING","'model'",59],"]",")",";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n\n        ",60],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_timeout",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","ini_get",62],"(",["T_CONSTANT_ENCAPSED_STRING","'session.gc_maxlifetime'",62],")",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Method called on open of a database session.\n     *\n     * @param string $savePath The path where to store\/retrieve the session.\n     * @param string $name The session name.\n     * @return bool Success\n     *\/",65],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","open",72],"(",["T_VARIABLE","$savePath",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$name",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_STRING","true",74],";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Method called on close of a database session.\n     *\n     * @return bool Success\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","close",82],"(",")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_STRING","true",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Method used to read from a database session.\n     *\n     * @param int|string $id The key of the value to read\n     * @return string The value of the key or empty if it does not exist\n     *\/",87],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","read",93],"(",["T_VARIABLE","$id",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$result",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_table",95],["T_WHITESPACE","\n            ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","find",96],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",96],")",["T_WHITESPACE","\n            ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","select",97],"(","[",["T_CONSTANT_ENCAPSED_STRING","'data'",97],"]",")",["T_WHITESPACE","\n            ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","where",98],"(","[",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_table",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","primaryKey",98],"(",")",["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$id",98],"]",")",["T_WHITESPACE","\n            ",98],["T_OBJECT_OPERATOR","->",99],["T_STRING","hydrate",99],"(",["T_STRING","false",99],")",["T_WHITESPACE","\n            ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","first",100],"(",")",";",["T_WHITESPACE","\n\n        ",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_EMPTY","empty",102],"(",["T_VARIABLE","$result",102],")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","''",103],";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_STRING","is_string",106],"(",["T_VARIABLE","$result",106],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",106],"]",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$result",107],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",107],"]",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$session",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","stream_get_contents",110],"(",["T_VARIABLE","$result",110],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",110],"]",")",";",["T_WHITESPACE","\n\n        ",110],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$session",112],["T_WHITESPACE"," ",112],["T_IS_IDENTICAL","===",112],["T_WHITESPACE"," ",112],["T_STRING","false",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","''",113],";",["T_WHITESPACE","\n        ",113],"}",["T_WHITESPACE","\n\n        ",114],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$session",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Helper function called on write for database sessions.\n     *\n     * @param int $id ID that uniquely identifies session in database\n     * @param mixed $data The value of the data to be saved.\n     * @return bool True for successful write, false otherwise.\n     *\/",119],["T_WHITESPACE","\n    ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","write",126],"(",["T_VARIABLE","$id",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$data",126],")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(","!",["T_VARIABLE","$id",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","false",129],";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$expires",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","time",131],"(",")",["T_WHITESPACE"," ",131],"+",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_timeout",131],";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$record",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","compact",132],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'expires'",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$record",133],"[",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_table",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","primaryKey",133],"(",")","]",["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$id",133],";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$result",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_table",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","save",134],"(",["T_NEW","new",134],["T_WHITESPACE"," ",134],["T_STRING","Entity",134],"(",["T_VARIABLE","$record",134],")",")",";",["T_WHITESPACE","\n\n        ",134],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_BOOL_CAST","(bool)",136],["T_VARIABLE","$result",136],";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Method called on the destruction of a database session.\n     *\n     * @param int $id ID that uniquely identifies session in database\n     * @return bool True for successful delete, false otherwise.\n     *\/",139],["T_WHITESPACE","\n    ",144],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","destroy",145],"(",["T_VARIABLE","$id",145],")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_table",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","delete",147],"(",["T_NEW","new",147],["T_WHITESPACE"," ",147],["T_STRING","Entity",147],"(",["T_WHITESPACE","\n            ",147],"[",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_table",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","primaryKey",148],"(",")",["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$id",148],"]",",",["T_WHITESPACE","\n            ",148],"[",["T_CONSTANT_ENCAPSED_STRING","'markNew'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_STRING","false",149],"]",["T_WHITESPACE","\n        ",149],")",")",";",["T_WHITESPACE","\n\n        ",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_STRING","true",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Helper function called on gc for database sessions.\n     *\n     * @param string $maxlifetime Sessions that have not updated for the last maxlifetime seconds will be removed.\n     * @return bool True on success, false on failure.\n     *\/",155],["T_WHITESPACE","\n    ",160],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","gc",161],"(",["T_VARIABLE","$maxlifetime",161],")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_table",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","deleteAll",163],"(","[",["T_CONSTANT_ENCAPSED_STRING","'expires <'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_STRING","time",163],"(",")","]",")",";",["T_WHITESPACE","\n\n        ",163],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_STRING","true",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n",166],"}",["T_WHITESPACE","\n",167]]