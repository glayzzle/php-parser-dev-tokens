[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",13],["T_NAMESPACE","namespace",14],["T_WHITESPACE"," ",14],["T_STRING","Cake",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Test",14],["T_NS_SEPARATOR","\\",14],["T_STRING","TestCase",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Network",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Http",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Auth",14],";",["T_WHITESPACE","\n\n",14],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Cake",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Http",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Client",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Http",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Client",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Auth",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Digest",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Http",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Client",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Request",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Http",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Client",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Response",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","TestSuite",20],["T_NS_SEPARATOR","\\",20],["T_STRING","TestCase",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * Digest authentication test\n *\/",22],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","DigestTest",25],["T_WHITESPACE"," ",25],["T_EXTENDS","extends",25],["T_WHITESPACE"," ",25],["T_STRING","TestCase",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\PHPUnit_Framework_MockObject_MockObject|\\Cake\\Http\\Client\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$client",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * @var \\Cake\\Http\\Client\\Auth\\Digest\n     *\/",33],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$auth",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Setup\n     *\n     * @return void\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","setUp",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_STRING","parent",45],["T_DOUBLE_COLON","::",45],["T_STRING","setUp",45],"(",")",";",["T_WHITESPACE","\n\n        ",45],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","client",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getClientMock",47],"(",")",";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","auth",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_STRING","Digest",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","client",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @return \\PHPUnit_Framework_MockObject_MockObject|\\Cake\\Http\\Client\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","getClientMock",54],"(",")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getMockBuilder",56],"(",["T_STRING","Client",56],["T_DOUBLE_COLON","::",56],["T_CLASS","class",56],")",["T_WHITESPACE","\n            ",56],["T_OBJECT_OPERATOR","->",57],["T_STRING","setMethods",57],"(","[",["T_CONSTANT_ENCAPSED_STRING","'send'",57],"]",")",["T_WHITESPACE","\n            ",57],["T_OBJECT_OPERATOR","->",58],["T_STRING","getMock",58],"(",")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * test getting data from additional request method\n     *\n     * @return void\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","testRealmAndNonceFromExtraRequest",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$headers",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],"[",["T_WHITESPACE","\n            ",68],["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Digest realm=\"The batcave\",nonce=\"4cded326c6c51\"'",69],["T_WHITESPACE","\n        ",69],"]",";",["T_WHITESPACE","\n\n        ",70],["T_VARIABLE","$response",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","Response",72],"(",["T_VARIABLE","$headers",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","''",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","client",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","expects",73],"(",["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","once",73],"(",")",")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","method",74],"(",["T_CONSTANT_ENCAPSED_STRING","'send'",74],")",["T_WHITESPACE","\n            ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","will",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","returnValue",75],"(",["T_VARIABLE","$response",75],")",")",";",["T_WHITESPACE","\n\n        ",75],["T_VARIABLE","$auth",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'admin'",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'password'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'1234'",77],"]",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$request",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_NEW","new",78],["T_WHITESPACE"," ",78],["T_STRING","Request",78],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/some\/path'",78],",",["T_WHITESPACE"," ",78],["T_STRING","Request",78],["T_DOUBLE_COLON","::",78],["T_STRING","METHOD_GET",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$request",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","auth",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","authentication",79],"(",["T_VARIABLE","$request",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$auth",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$result",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$request",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getHeaderLine",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",81],")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertContains",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Digest'",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$result",82],")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertContains",83],"(",["T_CONSTANT_ENCAPSED_STRING","'realm=\"The batcave\"'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$result",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertContains",84],"(",["T_CONSTANT_ENCAPSED_STRING","'nonce=\"4cded326c6c51\"'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$result",84],")",";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","assertContains",85],"(",["T_CONSTANT_ENCAPSED_STRING","'response=\"a21a874c0b29165929f5d24d1aad2c47\"'",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$result",85],")",";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertContains",86],"(",["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/some\/path\"'",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$result",86],")",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertNotContains",87],"(",["T_CONSTANT_ENCAPSED_STRING","'qop='",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$result",87],")",";",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertNotContains",88],"(",["T_CONSTANT_ENCAPSED_STRING","'nc='",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$result",88],")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * testQop method\n     *\n     * @return void\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","testQop",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$headers",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],"[",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Digest realm=\"The batcave\",nonce=\"4cded326c6c51\",qop=\"auth\"'",99],["T_WHITESPACE","\n        ",99],"]",";",["T_WHITESPACE","\n\n        ",100],["T_VARIABLE","$response",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_STRING","Response",102],"(",["T_VARIABLE","$headers",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","''",102],")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","client",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","expects",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","once",103],"(",")",")",["T_WHITESPACE","\n            ",103],["T_OBJECT_OPERATOR","->",104],["T_STRING","method",104],"(",["T_CONSTANT_ENCAPSED_STRING","'send'",104],")",["T_WHITESPACE","\n            ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","will",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","returnValue",105],"(",["T_VARIABLE","$response",105],")",")",";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$auth",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'admin'",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'password'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'1234'",107],"]",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$request",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","Request",108],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/some\/path'",108],",",["T_WHITESPACE"," ",108],["T_STRING","Request",108],["T_DOUBLE_COLON","::",108],["T_STRING","METHOD_GET",108],")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$request",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","auth",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","authentication",109],"(",["T_VARIABLE","$request",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$auth",109],")",";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$result",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$request",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getHeaderLine",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",110],")",";",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertContains",112],"(",["T_CONSTANT_ENCAPSED_STRING","'qop=\"auth\"'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$result",112],")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertContains",113],"(",["T_CONSTANT_ENCAPSED_STRING","'nc=00000001'",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$result",113],")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","assertRegexp",114],"(",["T_CONSTANT_ENCAPSED_STRING","'\/cnonce=\"[a-z0-9]+\"\/'",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$result",114],")",";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * testOpaque method\n     *\n     * @return void\n     *\/",117],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","testOpaque",122],"(",")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$headers",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],"[",["T_WHITESPACE","\n            ",124],["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Digest realm=\"The batcave\",nonce=\"4cded326c6c51\",opaque=\"d8ea7aa61a1693024c4cc3a516f49b3c\"'",125],["T_WHITESPACE","\n        ",125],"]",";",["T_WHITESPACE","\n\n        ",126],["T_VARIABLE","$response",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_STRING","Response",128],"(",["T_VARIABLE","$headers",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","''",128],")",";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","client",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","expects",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","once",129],"(",")",")",["T_WHITESPACE","\n            ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","method",130],"(",["T_CONSTANT_ENCAPSED_STRING","'send'",130],")",["T_WHITESPACE","\n            ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","will",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","returnValue",131],"(",["T_VARIABLE","$response",131],")",")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$auth",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'admin'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'password'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'1234'",133],"]",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$request",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_NEW","new",134],["T_WHITESPACE"," ",134],["T_STRING","Request",134],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/some\/path'",134],",",["T_WHITESPACE"," ",134],["T_STRING","Request",134],["T_DOUBLE_COLON","::",134],["T_STRING","METHOD_GET",134],")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$request",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","auth",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","authentication",135],"(",["T_VARIABLE","$request",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$auth",135],")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$result",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$request",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getHeaderLine",136],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",136],")",";",["T_WHITESPACE","\n\n        ",136],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertContains",138],"(",["T_CONSTANT_ENCAPSED_STRING","'opaque=\"d8ea7aa61a1693024c4cc3a516f49b3c\"'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$result",138],")",";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n",139],"}",["T_WHITESPACE","\n",140]]