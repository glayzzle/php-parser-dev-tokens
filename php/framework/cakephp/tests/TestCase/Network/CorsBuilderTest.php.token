[["T_OPEN_TAG","<?php\n",1],["T_NAMESPACE","namespace",2],["T_WHITESPACE"," ",2],["T_STRING","Cake",2],["T_NS_SEPARATOR","\\",2],["T_STRING","Test",2],["T_NS_SEPARATOR","\\",2],["T_STRING","TestCase",2],["T_NS_SEPARATOR","\\",2],["T_STRING","Network",2],";",["T_WHITESPACE","\n\n",2],["T_USE","use",4],["T_WHITESPACE"," ",4],["T_STRING","Cake",4],["T_NS_SEPARATOR","\\",4],["T_STRING","Network",4],["T_NS_SEPARATOR","\\",4],["T_STRING","CorsBuilder",4],";",["T_WHITESPACE","\n",4],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Cake",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Network",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Response",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Cake",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TestSuite",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TestCase",6],";",["T_WHITESPACE","\n\n",6],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","CorsBuilderTest",8],["T_WHITESPACE"," ",8],["T_EXTENDS","extends",8],["T_WHITESPACE"," ",8],["T_STRING","TestCase",8],["T_WHITESPACE","\n",8],"{",["T_WHITESPACE","\n    ",9],["T_DOC_COMMENT","\/**\n     * test allowOrigin() setting allow-origin\n     *\n     * @return void\n     *\/",10],["T_WHITESPACE","\n    ",14],["T_PUBLIC","public",15],["T_WHITESPACE"," ",15],["T_FUNCTION","function",15],["T_WHITESPACE"," ",15],["T_STRING","testAllowOriginNoOrigin",15],"(",")",["T_WHITESPACE","\n    ",15],"{",["T_WHITESPACE","\n        ",16],["T_VARIABLE","$response",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_NEW","new",17],["T_WHITESPACE"," ",17],["T_STRING","Response",17],"(",")",";",["T_WHITESPACE","\n        ",17],["T_VARIABLE","$builder",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_NEW","new",18],["T_WHITESPACE"," ",18],["T_STRING","CorsBuilder",18],"(",["T_VARIABLE","$response",18],",",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","''",18],")",";",["T_WHITESPACE","\n        ",18],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","assertSame",19],"(",["T_VARIABLE","$builder",19],",",["T_WHITESPACE"," ",19],["T_VARIABLE","$builder",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","allowOrigin",19],"(","[",["T_CONSTANT_ENCAPSED_STRING","'*.example.com'",19],",",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'*.foo.com'",19],"]",")",")",";",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","assertNoHeader",20],"(",["T_VARIABLE","$builder",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","build",20],"(",")",",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Origin'",20],")",";",["T_WHITESPACE","\n    ",20],"}",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * test allowOrigin() setting allow-origin\n     *\n     * @return void\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","testAllowOrigin",28],"(",")",["T_WHITESPACE","\n    ",28],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$response",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_NEW","new",30],["T_WHITESPACE"," ",30],["T_STRING","Response",30],"(",")",";",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$builder",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_NEW","new",31],["T_WHITESPACE"," ",31],["T_STRING","CorsBuilder",31],"(",["T_VARIABLE","$response",31],",",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",31],")",";",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","assertSame",32],"(",["T_VARIABLE","$builder",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$builder",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","allowOrigin",32],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",32],")",")",";",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","assertHeader",33],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",33],",",["T_WHITESPACE"," ",33],["T_VARIABLE","$builder",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","build",33],"(",")",",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",33],")",";",["T_WHITESPACE","\n\n        ",33],["T_VARIABLE","$response",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_NEW","new",35],["T_WHITESPACE"," ",35],["T_STRING","Response",35],"(",")",";",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$builder",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_NEW","new",36],["T_WHITESPACE"," ",36],["T_STRING","CorsBuilder",36],"(",["T_VARIABLE","$response",36],",",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",36],")",";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","assertSame",37],"(",["T_VARIABLE","$builder",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$builder",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","allowOrigin",37],"(","[",["T_CONSTANT_ENCAPSED_STRING","'*.example.com'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'*.foo.com'",37],"]",")",")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$builder",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","build",38],"(",")",";",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","assertHeader",39],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",39],",",["T_WHITESPACE"," ",39],["T_VARIABLE","$builder",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","build",39],"(",")",",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",39],")",";",["T_WHITESPACE","\n\n        ",39],["T_VARIABLE","$response",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_NEW","new",41],["T_WHITESPACE"," ",41],["T_STRING","Response",41],"(",")",";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$builder",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_NEW","new",42],["T_WHITESPACE"," ",42],["T_STRING","CorsBuilder",42],"(",["T_VARIABLE","$response",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",42],")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","assertSame",43],"(",["T_VARIABLE","$builder",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$builder",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","allowOrigin",43],"(",["T_CONSTANT_ENCAPSED_STRING","'*.example.com'",43],")",")",";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","assertHeader",44],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$builder",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","build",44],"(",")",",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * test allowOrigin() with SSL\n     *\n     * @return void\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","testAllowOriginSsl",52],"(",")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$response",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_NEW","new",54],["T_WHITESPACE"," ",54],["T_STRING","Response",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$builder",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_NEW","new",55],["T_WHITESPACE"," ",55],["T_STRING","CorsBuilder",55],"(",["T_VARIABLE","$response",55],",",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.example.com'",55],",",["T_WHITESPACE"," ",55],["T_STRING","true",55],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertSame",56],"(",["T_VARIABLE","$builder",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$builder",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","allowOrigin",56],"(",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",56],")",")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertNoHeader",57],"(",["T_VARIABLE","$response",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$response",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_STRING","Response",59],"(",")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$builder",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_NEW","new",60],["T_WHITESPACE"," ",60],["T_STRING","CorsBuilder",60],"(",["T_VARIABLE","$response",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",60],",",["T_WHITESPACE"," ",60],["T_STRING","true",60],")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertSame",61],"(",["T_VARIABLE","$builder",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$builder",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","allowOrigin",61],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/example.com'",61],")",")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertNoHeader",62],"(",["T_VARIABLE","$builder",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","build",62],"(",")",",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$response",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_NEW","new",64],["T_WHITESPACE"," ",64],["T_STRING","Response",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$builder",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_NEW","new",65],["T_WHITESPACE"," ",65],["T_STRING","CorsBuilder",65],"(",["T_VARIABLE","$response",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.example.com'",65],")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertSame",66],"(",["T_VARIABLE","$builder",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$builder",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","allowOrigin",66],"(",["T_CONSTANT_ENCAPSED_STRING","'https:\/\/example.com'",66],")",")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertNoHeader",67],"(",["T_VARIABLE","$builder",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","build",67],"(",")",",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",67],")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","testAllowMethods",70],"(",")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$response",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","Response",72],"(",")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$builder",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","CorsBuilder",73],"(",["T_VARIABLE","$response",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",73],")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$builder",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","allowOrigin",74],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertSame",75],"(",["T_VARIABLE","$builder",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$builder",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","allowMethods",75],"(","[",["T_CONSTANT_ENCAPSED_STRING","'GET'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'POST'",75],"]",")",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertHeader",76],"(",["T_CONSTANT_ENCAPSED_STRING","'GET, POST'",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$builder",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","build",76],"(",")",",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Methods'",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","testAllowCredentials",79],"(",")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$response",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_NEW","new",81],["T_WHITESPACE"," ",81],["T_STRING","Response",81],"(",")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$builder",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","CorsBuilder",82],"(",["T_VARIABLE","$response",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",82],")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$builder",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","allowOrigin",83],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertSame",84],"(",["T_VARIABLE","$builder",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$builder",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","allowCredentials",84],"(",")",")",";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","assertHeader",85],"(",["T_CONSTANT_ENCAPSED_STRING","'true'",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$builder",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","build",85],"(",")",",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Credentials'",85],")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","testAllowHeaders",88],"(",")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$response",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_STRING","Response",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$builder",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_NEW","new",91],["T_WHITESPACE"," ",91],["T_STRING","CorsBuilder",91],"(",["T_VARIABLE","$response",91],",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",91],")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$builder",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","allowOrigin",92],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",92],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertSame",93],"(",["T_VARIABLE","$builder",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$builder",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","allowHeaders",93],"(","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'Accept'",93],"]",")",")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertHeader",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type, Accept'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$builder",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","build",94],"(",")",",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Headers'",94],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","testExposeHeaders",97],"(",")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$response",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_STRING","Response",99],"(",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$builder",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_NEW","new",100],["T_WHITESPACE"," ",100],["T_STRING","CorsBuilder",100],"(",["T_VARIABLE","$response",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",100],")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$builder",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","allowOrigin",101],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",101],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertSame",102],"(",["T_VARIABLE","$builder",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$builder",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","exposeHeaders",102],"(","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'Accept'",102],"]",")",")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertHeader",103],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type, Accept'",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$builder",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","build",103],"(",")",",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Expose-Headers'",103],")",";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","testMaxAge",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$response",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","Response",108],"(",")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$builder",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_NEW","new",109],["T_WHITESPACE"," ",109],["T_STRING","CorsBuilder",109],"(",["T_VARIABLE","$response",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",109],")",";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$builder",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","allowOrigin",110],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",110],")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","assertSame",111],"(",["T_VARIABLE","$builder",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$builder",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","maxAge",111],"(",["T_LNUMBER","300",111],")",")",";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertHeader",112],"(",["T_CONSTANT_ENCAPSED_STRING","'300'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$builder",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","build",112],"(",")",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Max-Age'",112],")",";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * When no origin is allowed, none of the other headers should be applied.\n     *\n     * @return void\n     *\/",115],["T_WHITESPACE","\n    ",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","testNoAllowedOriginNoHeadersSet",120],"(",")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$response",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","Response",122],"(",")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$builder",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","CorsBuilder",123],"(",["T_VARIABLE","$response",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",123],")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$response",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$builder",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","allowCredentials",124],"(",")",["T_WHITESPACE","\n            ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","allowMethods",125],"(","[",["T_CONSTANT_ENCAPSED_STRING","'GET'",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'POST'",125],"]",")",["T_WHITESPACE","\n            ",125],["T_OBJECT_OPERATOR","->",126],["T_STRING","allowHeaders",126],"(","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",126],"]",")",["T_WHITESPACE","\n            ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","exposeHeaders",127],"(","[",["T_CONSTANT_ENCAPSED_STRING","'X-CSRF-Token'",127],"]",")",["T_WHITESPACE","\n            ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","maxAge",128],"(",["T_LNUMBER","300",128],")",["T_WHITESPACE","\n            ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","build",129],"(",")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","assertNoHeader",130],"(",["T_VARIABLE","$response",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",130],")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertNoHeader",131],"(",["T_VARIABLE","$response",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Headers'",131],")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","assertNoHeader",132],"(",["T_VARIABLE","$response",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Expose-Headers'",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","assertNoHeader",133],"(",["T_VARIABLE","$response",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Methods'",133],")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertNoHeader",134],"(",["T_VARIABLE","$response",134],",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Authentication'",134],")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertNoHeader",135],"(",["T_VARIABLE","$response",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Max-Age'",135],")",";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * When an invalid origin is used, none of the other headers should be applied.\n     *\n     * @return void\n     *\/",138],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","testInvalidAllowedOriginNoHeadersSet",143],"(",")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$response",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_NEW","new",145],["T_WHITESPACE"," ",145],["T_STRING","Response",145],"(",")",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$builder",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_NEW","new",146],["T_WHITESPACE"," ",146],["T_STRING","CorsBuilder",146],"(",["T_VARIABLE","$response",146],",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com'",146],")",";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$response",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$builder",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","allowOrigin",147],"(","[",["T_CONSTANT_ENCAPSED_STRING","'http:\/\/google.com'",147],"]",")",["T_WHITESPACE","\n            ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","allowCredentials",148],"(",")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","allowMethods",149],"(","[",["T_CONSTANT_ENCAPSED_STRING","'GET'",149],",",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'POST'",149],"]",")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","allowHeaders",150],"(","[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",150],"]",")",["T_WHITESPACE","\n            ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","exposeHeaders",151],"(","[",["T_CONSTANT_ENCAPSED_STRING","'X-CSRF-Token'",151],"]",")",["T_WHITESPACE","\n            ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","maxAge",152],"(",["T_LNUMBER","300",152],")",["T_WHITESPACE","\n            ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","build",153],"(",")",";",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","assertNoHeader",154],"(",["T_VARIABLE","$response",154],",",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",154],")",";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","assertNoHeader",155],"(",["T_VARIABLE","$response",155],",",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Headers'",155],")",";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","assertNoHeader",156],"(",["T_VARIABLE","$response",156],",",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Expose-Headers'",156],")",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","assertNoHeader",157],"(",["T_VARIABLE","$response",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Methods'",157],")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","assertNoHeader",158],"(",["T_VARIABLE","$response",158],",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Authentication'",158],")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertNoHeader",159],"(",["T_VARIABLE","$response",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Max-Age'",159],")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Helper for checking header values.\n     *\n     * @param string $expected The expected value\n     * @param \\Cake\\Network\\Response $response The Response object.\n     * @params string $header The header key to check\n     *\/",162],["T_WHITESPACE","\n    ",168],["T_PROTECTED","protected",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","assertHeader",169],"(",["T_VARIABLE","$expected",169],",",["T_WHITESPACE"," ",169],["T_STRING","Response",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$response",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$header",169],")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$headers",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$response",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","header",171],"(",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","assertArrayHasKey",172],"(",["T_VARIABLE","$header",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$headers",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'Header key not found.'",172],")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","assertEquals",173],"(",["T_VARIABLE","$expected",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$headers",173],"[",["T_VARIABLE","$header",173],"]",",",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'Header value not found.'",173],")",";",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Helper for checking header values.\n     *\n     * @param \\Cake\\Network\\Response $response The Response object.\n     * @params string $header The header key to check\n     *\/",176],["T_WHITESPACE","\n    ",181],["T_PROTECTED","protected",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","assertNoHeader",182],"(",["T_STRING","Response",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$response",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$header",182],")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$headers",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$response",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","header",184],"(",")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertArrayNotHasKey",185],"(",["T_VARIABLE","$header",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$headers",185],",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'Header key was found.'",185],")",";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n",186],"}",["T_WHITESPACE","\n",187]]