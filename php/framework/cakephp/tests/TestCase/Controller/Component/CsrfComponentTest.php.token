[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Controller",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Controller",17],["T_NS_SEPARATOR","\\",17],["T_STRING","ComponentRegistry",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Controller",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","CsrfComponent",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Event",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Event",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","I18n",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Time",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Network",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Request",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Network",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Response",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Cake",23],["T_NS_SEPARATOR","\\",23],["T_STRING","TestSuite",23],["T_NS_SEPARATOR","\\",23],["T_STRING","TestCase",23],";",["T_WHITESPACE","\n\n",23],["T_DOC_COMMENT","\/**\n * CsrfComponent test.\n *\/",25],["T_WHITESPACE","\n",27],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","CsrfComponentTest",28],["T_WHITESPACE"," ",28],["T_EXTENDS","extends",28],["T_WHITESPACE"," ",28],["T_STRING","TestCase",28],["T_WHITESPACE","\n",28],"{",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * setup\n     *\n     * @return void\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","setUp",36],"(",")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_STRING","parent",38],["T_DOUBLE_COLON","::",38],["T_STRING","setUp",38],"(",")",";",["T_WHITESPACE","\n\n        ",38],["T_VARIABLE","$controller",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getMockBuilder",40],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",40],")",["T_WHITESPACE","\n            ",40],["T_OBJECT_OPERATOR","->",41],["T_STRING","setMethods",41],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",41],"]",")",["T_WHITESPACE","\n            ",41],["T_OBJECT_OPERATOR","->",42],["T_STRING","getMock",42],"(",")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","registry",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_NEW","new",43],["T_WHITESPACE"," ",43],["T_STRING","ComponentRegistry",43],"(",["T_VARIABLE","$controller",43],")",";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","component",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_NEW","new",44],["T_WHITESPACE"," ",44],["T_STRING","CsrfComponent",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","registry",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * teardown\n     *\n     * @return void\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","tearDown",52],"(",")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_STRING","parent",54],["T_DOUBLE_COLON","::",54],["T_STRING","tearDown",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_UNSET","unset",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","component",55],")",";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Test setting the cookie value\n     *\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",58],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","testSettingCookie",64],"(",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$controller",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMockBuilder",66],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",66],")",["T_WHITESPACE","\n            ",66],["T_OBJECT_OPERATOR","->",67],["T_STRING","setMethods",67],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",67],"]",")",["T_WHITESPACE","\n            ",67],["T_OBJECT_OPERATOR","->",68],["T_STRING","getMock",68],"(",")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$controller",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","request",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_NEW","new",69],["T_WHITESPACE"," ",69],["T_STRING","Request",69],"(","[",["T_WHITESPACE","\n            ",69],["T_CONSTANT_ENCAPSED_STRING","'environment'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'GET'",70],"]",",",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'webroot'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'\/dir\/'",71],",",["T_WHITESPACE","\n        ",71],"]",")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$controller",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","response",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","Response",73],"(",")",";",["T_WHITESPACE","\n\n        ",73],["T_VARIABLE","$event",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_NEW","new",75],["T_WHITESPACE"," ",75],["T_STRING","Event",75],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$controller",75],")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","component",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","startup",76],"(",["T_VARIABLE","$event",76],")",";",["T_WHITESPACE","\n\n        ",76],["T_VARIABLE","$cookie",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$controller",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","response",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","cookie",78],"(",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertNotEmpty",79],"(",["T_VARIABLE","$cookie",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'Should set a token.'",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","assertRegExp",80],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[a-f0-9]+$\/'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$cookie",80],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",80],"]",",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'Should look like a hash.'",80],")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","assertEquals",81],"(",["T_LNUMBER","0",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$cookie",81],"[",["T_CONSTANT_ENCAPSED_STRING","'expire'",81],"]",",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'session duration.'",81],")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertEquals",82],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dir\/'",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$cookie",82],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",82],"]",",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'session path.'",82],")",";",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertEquals",84],"(",["T_VARIABLE","$cookie",84],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",84],"]",",",["T_WHITESPACE"," ",84],["T_VARIABLE","$controller",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","request",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","params",84],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",84],"]",")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Data provider for HTTP method tests.\n     *\n     * HEAD and GET do not populate $_POST or request->data.\n     *\n     * @return void\n     *\/",87],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_STATIC","static",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","safeHttpMethodProvider",94],"(",")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_RETURN","return",96],["T_WHITESPACE"," ",96],"[",["T_WHITESPACE","\n            ",96],"[",["T_CONSTANT_ENCAPSED_STRING","'GET'",97],"]",",",["T_WHITESPACE","\n            ",97],"[",["T_CONSTANT_ENCAPSED_STRING","'HEAD'",98],"]",",",["T_WHITESPACE","\n        ",98],"]",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Test that the CSRF tokens are not required for idempotent operations\n     *\n     * @dataProvider safeHttpMethodProvider\n     * @return void\n     *\/",102],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","testSafeMethodNoCsrfRequired",108],"(",["T_VARIABLE","$method",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$controller",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getMockBuilder",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",110],")",["T_WHITESPACE","\n            ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","setMethods",111],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",111],"]",")",["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","getMock",112],"(",")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$controller",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","request",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Request",113],"(","[",["T_WHITESPACE","\n            ",113],["T_CONSTANT_ENCAPSED_STRING","'environment'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],"[",["T_WHITESPACE","\n                ",114],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$method",115],",",["T_WHITESPACE","\n                ",115],["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_CSRF_TOKEN'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'nope'",116],",",["T_WHITESPACE","\n            ",116],"]",",",["T_WHITESPACE","\n            ",117],["T_CONSTANT_ENCAPSED_STRING","'cookies'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'testing123'",118],"]",["T_WHITESPACE","\n        ",118],"]",")",";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$controller",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","response",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_NEW","new",120],["T_WHITESPACE"," ",120],["T_STRING","Response",120],"(",")",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$event",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","Event",122],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$controller",122],")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$result",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","component",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","startup",123],"(",["T_VARIABLE","$event",123],")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","assertNull",124],"(",["T_VARIABLE","$result",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'No exception means valid.'",124],")",";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Data provider for HTTP methods that can contain request bodies.\n     *\n     * @return void\n     *\/",127],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_STATIC","static",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","httpMethodProvider",132],"(",")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],"[",["T_WHITESPACE","\n            ",134],"[",["T_CONSTANT_ENCAPSED_STRING","'OPTIONS'",135],"]",",",["T_WHITESPACE"," ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'PATCH'",135],"]",",",["T_WHITESPACE"," ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'PUT'",135],"]",",",["T_WHITESPACE"," ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'POST'",135],"]",",",["T_WHITESPACE"," ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'DELETE'",135],"]",",",["T_WHITESPACE"," ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'PURGE'",135],"]",",",["T_WHITESPACE"," ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'INVALIDMETHOD'",135],"]",["T_WHITESPACE","\n        ",135],"]",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Test that the X-CSRF-Token works with the various http methods.\n     *\n     * @dataProvider httpMethodProvider\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",139],["T_WHITESPACE","\n    ",145],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","testValidTokenInHeader",146],"(",["T_VARIABLE","$method",146],")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$controller",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getMockBuilder",148],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",148],")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","setMethods",149],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",149],"]",")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","getMock",150],"(",")",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$controller",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","request",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_NEW","new",151],["T_WHITESPACE"," ",151],["T_STRING","Request",151],"(","[",["T_WHITESPACE","\n            ",151],["T_CONSTANT_ENCAPSED_STRING","'environment'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],"[",["T_WHITESPACE","\n                ",152],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$method",153],",",["T_WHITESPACE","\n                ",153],["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_CSRF_TOKEN'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'testing123'",154],",",["T_WHITESPACE","\n            ",154],"]",",",["T_WHITESPACE","\n            ",155],["T_CONSTANT_ENCAPSED_STRING","'post'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],"[",["T_CONSTANT_ENCAPSED_STRING","'a'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'b'",156],"]",",",["T_WHITESPACE","\n            ",156],["T_CONSTANT_ENCAPSED_STRING","'cookies'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'testing123'",157],"]",["T_WHITESPACE","\n        ",157],"]",")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$controller",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","response",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_NEW","new",159],["T_WHITESPACE"," ",159],["T_STRING","Response",159],"(",")",";",["T_WHITESPACE","\n\n        ",159],["T_VARIABLE","$event",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_NEW","new",161],["T_WHITESPACE"," ",161],["T_STRING","Event",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$controller",161],")",";",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$result",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","component",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","startup",162],"(",["T_VARIABLE","$event",162],")",";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertNull",163],"(",["T_VARIABLE","$result",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'No exception means valid.'",163],")",";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Test that the X-CSRF-Token works with the various http methods.\n     *\n     * @dataProvider httpMethodProvider\n     * @expectedException \\Cake\\Network\\Exception\\InvalidCsrfTokenException\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",166],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","testInvalidTokenInHeader",174],"(",["T_VARIABLE","$method",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$controller",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getMockBuilder",176],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",176],")",["T_WHITESPACE","\n            ",176],["T_OBJECT_OPERATOR","->",177],["T_STRING","setMethods",177],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",177],"]",")",["T_WHITESPACE","\n            ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","getMock",178],"(",")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$controller",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","request",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_NEW","new",179],["T_WHITESPACE"," ",179],["T_STRING","Request",179],"(","[",["T_WHITESPACE","\n            ",179],["T_CONSTANT_ENCAPSED_STRING","'environment'",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],"[",["T_WHITESPACE","\n                ",180],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$method",181],",",["T_WHITESPACE","\n                ",181],["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_CSRF_TOKEN'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","'nope'",182],",",["T_WHITESPACE","\n            ",182],"]",",",["T_WHITESPACE","\n            ",183],["T_CONSTANT_ENCAPSED_STRING","'post'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],"[",["T_CONSTANT_ENCAPSED_STRING","'a'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'b'",184],"]",",",["T_WHITESPACE","\n            ",184],["T_CONSTANT_ENCAPSED_STRING","'cookies'",185],["T_WHITESPACE"," ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",185],["T_WHITESPACE"," ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'testing123'",185],"]",["T_WHITESPACE","\n        ",185],"]",")",";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$controller",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","response",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_NEW","new",187],["T_WHITESPACE"," ",187],["T_STRING","Response",187],"(",")",";",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$event",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_NEW","new",189],["T_WHITESPACE"," ",189],["T_STRING","Event",189],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$controller",189],")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","component",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","startup",190],"(",["T_VARIABLE","$event",190],")",";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Test that request data works with the various http methods.\n     *\n     * @dataProvider httpMethodProvider\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",193],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","testValidTokenRequestData",200],"(",["T_VARIABLE","$method",200],")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$controller",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getMockBuilder",202],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",202],")",["T_WHITESPACE","\n            ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","setMethods",203],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",203],"]",")",["T_WHITESPACE","\n            ",203],["T_OBJECT_OPERATOR","->",204],["T_STRING","getMock",204],"(",")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$controller",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","request",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_NEW","new",205],["T_WHITESPACE"," ",205],["T_STRING","Request",205],"(","[",["T_WHITESPACE","\n            ",205],["T_CONSTANT_ENCAPSED_STRING","'environment'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],"[",["T_WHITESPACE","\n                ",206],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$method",207],",",["T_WHITESPACE","\n            ",207],"]",",",["T_WHITESPACE","\n            ",208],["T_CONSTANT_ENCAPSED_STRING","'post'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'testing123'",209],"]",",",["T_WHITESPACE","\n            ",209],["T_CONSTANT_ENCAPSED_STRING","'cookies'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'testing123'",210],"]",["T_WHITESPACE","\n        ",210],"]",")",";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$controller",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","response",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_NEW","new",212],["T_WHITESPACE"," ",212],["T_STRING","Response",212],"(",")",";",["T_WHITESPACE","\n\n        ",212],["T_VARIABLE","$event",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_NEW","new",214],["T_WHITESPACE"," ",214],["T_STRING","Event",214],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$controller",214],")",";",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$result",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","component",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","startup",215],"(",["T_VARIABLE","$event",215],")",";",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","assertNull",216],"(",["T_VARIABLE","$result",216],",",["T_WHITESPACE"," ",216],["T_CONSTANT_ENCAPSED_STRING","'No exception means valid.'",216],")",";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","assertFalse",217],"(",["T_ISSET","isset",217],"(",["T_VARIABLE","$controller",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","request",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","data",217],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",217],"]",")",")",";",["T_WHITESPACE","\n    ",217],"}",["T_WHITESPACE","\n\n    ",218],["T_DOC_COMMENT","\/**\n     * Test that request data works with the various http methods.\n     *\n     * @dataProvider httpMethodProvider\n     * @expectedException \\Cake\\Network\\Exception\\InvalidCsrfTokenException\n     * @return void\n     *\/",220],["T_WHITESPACE","\n    ",226],["T_PUBLIC","public",227],["T_WHITESPACE"," ",227],["T_FUNCTION","function",227],["T_WHITESPACE"," ",227],["T_STRING","testInvalidTokenRequestData",227],"(",["T_VARIABLE","$method",227],")",["T_WHITESPACE","\n    ",227],"{",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$controller",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getMockBuilder",229],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",229],")",["T_WHITESPACE","\n            ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","setMethods",230],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",230],"]",")",["T_WHITESPACE","\n            ",230],["T_OBJECT_OPERATOR","->",231],["T_STRING","getMock",231],"(",")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$controller",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","request",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_NEW","new",232],["T_WHITESPACE"," ",232],["T_STRING","Request",232],"(","[",["T_WHITESPACE","\n            ",232],["T_CONSTANT_ENCAPSED_STRING","'environment'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],"[",["T_WHITESPACE","\n                ",233],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$method",234],",",["T_WHITESPACE","\n            ",234],"]",",",["T_WHITESPACE","\n            ",235],["T_CONSTANT_ENCAPSED_STRING","'post'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'nope'",236],"]",",",["T_WHITESPACE","\n            ",236],["T_CONSTANT_ENCAPSED_STRING","'cookies'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'testing123'",237],"]",["T_WHITESPACE","\n        ",237],"]",")",";",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$controller",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","response",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_NEW","new",239],["T_WHITESPACE"," ",239],["T_STRING","Response",239],"(",")",";",["T_WHITESPACE","\n\n        ",239],["T_VARIABLE","$event",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_NEW","new",241],["T_WHITESPACE"," ",241],["T_STRING","Event",241],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$controller",241],")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","component",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","startup",242],"(",["T_VARIABLE","$event",242],")",";",["T_WHITESPACE","\n    ",242],"}",["T_WHITESPACE","\n\n    ",243],["T_DOC_COMMENT","\/**\n     * Test that missing post field fails\n     *\n     * @expectedException \\Cake\\Network\\Exception\\InvalidCsrfTokenException\n     * @return void\n     *\/",245],["T_WHITESPACE","\n    ",250],["T_PUBLIC","public",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","testInvalidTokenRequestDataMissing",251],"(",")",["T_WHITESPACE","\n    ",251],"{",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$controller",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getMockBuilder",253],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",253],")",["T_WHITESPACE","\n            ",253],["T_OBJECT_OPERATOR","->",254],["T_STRING","setMethods",254],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",254],"]",")",["T_WHITESPACE","\n            ",254],["T_OBJECT_OPERATOR","->",255],["T_STRING","getMock",255],"(",")",";",["T_WHITESPACE","\n        ",255],["T_VARIABLE","$controller",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","request",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_NEW","new",256],["T_WHITESPACE"," ",256],["T_STRING","Request",256],"(","[",["T_WHITESPACE","\n            ",256],["T_CONSTANT_ENCAPSED_STRING","'environment'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],"[",["T_WHITESPACE","\n                ",257],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'POST'",258],",",["T_WHITESPACE","\n            ",258],"]",",",["T_WHITESPACE","\n            ",259],["T_CONSTANT_ENCAPSED_STRING","'post'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],"[","]",",",["T_WHITESPACE","\n            ",260],["T_CONSTANT_ENCAPSED_STRING","'cookies'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'testing123'",261],"]",["T_WHITESPACE","\n        ",261],"]",")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$controller",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","response",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_NEW","new",263],["T_WHITESPACE"," ",263],["T_STRING","Response",263],"(",")",";",["T_WHITESPACE","\n\n        ",263],["T_VARIABLE","$event",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_NEW","new",265],["T_WHITESPACE"," ",265],["T_STRING","Event",265],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",265],",",["T_WHITESPACE"," ",265],["T_VARIABLE","$controller",265],")",";",["T_WHITESPACE","\n        ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","component",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","startup",266],"(",["T_VARIABLE","$event",266],")",";",["T_WHITESPACE","\n    ",266],"}",["T_WHITESPACE","\n\n    ",267],["T_DOC_COMMENT","\/**\n     * Test that missing header and cookie fails\n     *\n     * @dataProvider httpMethodProvider\n     * @expectedException \\Cake\\Network\\Exception\\InvalidCsrfTokenException\n     * @return void\n     *\/",269],["T_WHITESPACE","\n    ",275],["T_PUBLIC","public",276],["T_WHITESPACE"," ",276],["T_FUNCTION","function",276],["T_WHITESPACE"," ",276],["T_STRING","testInvalidTokenMissingCookie",276],"(",["T_VARIABLE","$method",276],")",["T_WHITESPACE","\n    ",276],"{",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$controller",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getMockBuilder",278],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",278],")",["T_WHITESPACE","\n            ",278],["T_OBJECT_OPERATOR","->",279],["T_STRING","setMethods",279],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",279],"]",")",["T_WHITESPACE","\n            ",279],["T_OBJECT_OPERATOR","->",280],["T_STRING","getMock",280],"(",")",";",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$controller",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","request",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_NEW","new",281],["T_WHITESPACE"," ",281],["T_STRING","Request",281],"(","[",["T_WHITESPACE","\n            ",281],["T_CONSTANT_ENCAPSED_STRING","'environment'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],"[",["T_WHITESPACE","\n                ",282],["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",283],["T_WHITESPACE"," ",283],["T_DOUBLE_ARROW","=>",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$method",283],["T_WHITESPACE","\n            ",283],"]",",",["T_WHITESPACE","\n            ",284],["T_CONSTANT_ENCAPSED_STRING","'post'",285],["T_WHITESPACE"," ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",285],["T_WHITESPACE"," ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_CONSTANT_ENCAPSED_STRING","'could-be-valid'",285],"]",",",["T_WHITESPACE","\n            ",285],["T_CONSTANT_ENCAPSED_STRING","'cookies'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],"[","]",["T_WHITESPACE","\n        ",286],"]",")",";",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$controller",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","response",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_NEW","new",288],["T_WHITESPACE"," ",288],["T_STRING","Response",288],"(",")",";",["T_WHITESPACE","\n\n        ",288],["T_VARIABLE","$event",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_NEW","new",290],["T_WHITESPACE"," ",290],["T_STRING","Event",290],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$controller",290],")",";",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","component",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","startup",291],"(",["T_VARIABLE","$event",291],")",";",["T_WHITESPACE","\n    ",291],"}",["T_WHITESPACE","\n\n    ",292],["T_DOC_COMMENT","\/**\n     * Test that CSRF checks are not applied to request action requests.\n     *\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",294],["T_WHITESPACE","\n    ",299],["T_PUBLIC","public",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","testCsrfValidationSkipsRequestAction",300],"(",")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$controller",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getMockBuilder",302],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",302],")",["T_WHITESPACE","\n            ",302],["T_OBJECT_OPERATOR","->",303],["T_STRING","setMethods",303],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",303],"]",")",["T_WHITESPACE","\n            ",303],["T_OBJECT_OPERATOR","->",304],["T_STRING","getMock",304],"(",")",";",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$controller",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","request",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_NEW","new",305],["T_WHITESPACE"," ",305],["T_STRING","Request",305],"(","[",["T_WHITESPACE","\n            ",305],["T_CONSTANT_ENCAPSED_STRING","'environment'",306],["T_WHITESPACE"," ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",306],["T_WHITESPACE"," ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],["T_CONSTANT_ENCAPSED_STRING","'POST'",306],"]",",",["T_WHITESPACE","\n            ",306],["T_CONSTANT_ENCAPSED_STRING","'params'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],"[",["T_CONSTANT_ENCAPSED_STRING","'requested'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_LNUMBER","1",307],"]",",",["T_WHITESPACE","\n            ",307],["T_CONSTANT_ENCAPSED_STRING","'post'",308],["T_WHITESPACE"," ",308],["T_DOUBLE_ARROW","=>",308],["T_WHITESPACE"," ",308],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",308],["T_WHITESPACE"," ",308],["T_DOUBLE_ARROW","=>",308],["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'nope'",308],"]",",",["T_WHITESPACE","\n            ",308],["T_CONSTANT_ENCAPSED_STRING","'cookies'",309],["T_WHITESPACE"," ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",309],["T_WHITESPACE"," ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'testing123'",309],"]",["T_WHITESPACE","\n        ",309],"]",")",";",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$controller",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","response",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_NEW","new",311],["T_WHITESPACE"," ",311],["T_STRING","Response",311],"(",")",";",["T_WHITESPACE","\n\n        ",311],["T_VARIABLE","$event",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_NEW","new",313],["T_WHITESPACE"," ",313],["T_STRING","Event",313],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$controller",313],")",";",["T_WHITESPACE","\n        ",313],["T_VARIABLE","$result",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","component",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","startup",314],"(",["T_VARIABLE","$event",314],")",";",["T_WHITESPACE","\n        ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","assertNull",315],"(",["T_VARIABLE","$result",315],",",["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","'No error.'",315],")",";",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","assertEquals",316],"(",["T_CONSTANT_ENCAPSED_STRING","'testing123'",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$controller",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","request",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","params",316],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",316],"]",")",";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Test that the configuration options work.\n     *\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",319],["T_WHITESPACE","\n    ",324],["T_PUBLIC","public",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","testConfigurationCookieCreate",325],"(",")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_VARIABLE","$controller",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getMockBuilder",327],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",327],")",["T_WHITESPACE","\n            ",327],["T_OBJECT_OPERATOR","->",328],["T_STRING","setMethods",328],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",328],"]",")",["T_WHITESPACE","\n            ",328],["T_OBJECT_OPERATOR","->",329],["T_STRING","getMock",329],"(",")",";",["T_WHITESPACE","\n        ",329],["T_VARIABLE","$controller",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","request",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_NEW","new",330],["T_WHITESPACE"," ",330],["T_STRING","Request",330],"(","[",["T_WHITESPACE","\n            ",330],["T_CONSTANT_ENCAPSED_STRING","'environment'",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'GET'",331],"]",",",["T_WHITESPACE","\n            ",331],["T_CONSTANT_ENCAPSED_STRING","'webroot'",332],["T_WHITESPACE"," ",332],["T_DOUBLE_ARROW","=>",332],["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'\/dir\/'",332],["T_WHITESPACE","\n        ",332],"]",")",";",["T_WHITESPACE","\n        ",333],["T_VARIABLE","$controller",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","response",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_NEW","new",334],["T_WHITESPACE"," ",334],["T_STRING","Response",334],"(",")",";",["T_WHITESPACE","\n\n        ",334],["T_VARIABLE","$component",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_NEW","new",336],["T_WHITESPACE"," ",336],["T_STRING","CsrfComponent",336],"(",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","registry",336],",",["T_WHITESPACE"," ",336],"[",["T_WHITESPACE","\n            ",336],["T_CONSTANT_ENCAPSED_STRING","'cookieName'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'token'",337],",",["T_WHITESPACE","\n            ",337],["T_CONSTANT_ENCAPSED_STRING","'expiry'",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","'+1 hour'",338],",",["T_WHITESPACE","\n            ",338],["T_CONSTANT_ENCAPSED_STRING","'secure'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_STRING","true",339],",",["T_WHITESPACE","\n            ",339],["T_CONSTANT_ENCAPSED_STRING","'httpOnly'",340],["T_WHITESPACE"," ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_STRING","true",340],["T_WHITESPACE","\n        ",340],"]",")",";",["T_WHITESPACE","\n\n        ",341],["T_VARIABLE","$event",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_NEW","new",343],["T_WHITESPACE"," ",343],["T_STRING","Event",343],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",343],",",["T_WHITESPACE"," ",343],["T_VARIABLE","$controller",343],")",";",["T_WHITESPACE","\n        ",343],["T_VARIABLE","$component",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","startup",344],"(",["T_VARIABLE","$event",344],")",";",["T_WHITESPACE","\n\n        ",344],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","assertEmpty",346],"(",["T_VARIABLE","$controller",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","response",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","cookie",346],"(",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",346],")",")",";",["T_WHITESPACE","\n        ",346],["T_VARIABLE","$cookie",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$controller",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","response",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","cookie",347],"(",["T_CONSTANT_ENCAPSED_STRING","'token'",347],")",";",["T_WHITESPACE","\n        ",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","assertNotEmpty",348],"(",["T_VARIABLE","$cookie",348],",",["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","'Should set a token.'",348],")",";",["T_WHITESPACE","\n        ",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","assertRegExp",349],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[a-f0-9]+$\/'",349],",",["T_WHITESPACE"," ",349],["T_VARIABLE","$cookie",349],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",349],"]",",",["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'Should look like a hash.'",349],")",";",["T_WHITESPACE","\n        ",349],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","assertWithinRange",350],"(","(",["T_NEW","new",350],["T_WHITESPACE"," ",350],["T_STRING","Time",350],"(",["T_CONSTANT_ENCAPSED_STRING","'+1 hour'",350],")",")",["T_OBJECT_OPERATOR","->",350],["T_STRING","format",350],"(",["T_CONSTANT_ENCAPSED_STRING","'U'",350],")",",",["T_WHITESPACE"," ",350],["T_VARIABLE","$cookie",350],"[",["T_CONSTANT_ENCAPSED_STRING","'expire'",350],"]",",",["T_WHITESPACE"," ",350],["T_LNUMBER","1",350],",",["T_WHITESPACE"," ",350],["T_CONSTANT_ENCAPSED_STRING","'session duration.'",350],")",";",["T_WHITESPACE","\n        ",350],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","assertEquals",351],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dir\/'",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$cookie",351],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",351],"]",",",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'session path.'",351],")",";",["T_WHITESPACE","\n        ",351],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","assertTrue",352],"(",["T_VARIABLE","$cookie",352],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",352],"]",",",["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'cookie security flag missing'",352],")",";",["T_WHITESPACE","\n        ",352],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","assertTrue",353],"(",["T_VARIABLE","$cookie",353],"[",["T_CONSTANT_ENCAPSED_STRING","'httpOnly'",353],"]",",",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","'cookie httpOnly flag missing'",353],")",";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n    ",354],["T_DOC_COMMENT","\/**\n     * Test that the configuration options work.\n     *\n     * @return void\n     * @triggers Controller.startup $controller\n     *\/",356],["T_WHITESPACE","\n    ",361],["T_PUBLIC","public",362],["T_WHITESPACE"," ",362],["T_FUNCTION","function",362],["T_WHITESPACE"," ",362],["T_STRING","testConfigurationValidate",362],"(",")",["T_WHITESPACE","\n    ",362],"{",["T_WHITESPACE","\n        ",363],["T_VARIABLE","$controller",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getMockBuilder",364],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",364],")",["T_WHITESPACE","\n            ",364],["T_OBJECT_OPERATOR","->",365],["T_STRING","setMethods",365],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",365],"]",")",["T_WHITESPACE","\n            ",365],["T_OBJECT_OPERATOR","->",366],["T_STRING","getMock",366],"(",")",";",["T_WHITESPACE","\n        ",366],["T_VARIABLE","$controller",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","request",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_NEW","new",367],["T_WHITESPACE"," ",367],["T_STRING","Request",367],"(","[",["T_WHITESPACE","\n            ",367],["T_CONSTANT_ENCAPSED_STRING","'environment'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'POST'",368],"]",",",["T_WHITESPACE","\n            ",368],["T_CONSTANT_ENCAPSED_STRING","'cookies'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],"[",["T_CONSTANT_ENCAPSED_STRING","'csrfToken'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_CONSTANT_ENCAPSED_STRING","'nope'",369],",",["T_WHITESPACE"," ",369],["T_CONSTANT_ENCAPSED_STRING","'token'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_CONSTANT_ENCAPSED_STRING","'yes'",369],"]",",",["T_WHITESPACE","\n            ",369],["T_CONSTANT_ENCAPSED_STRING","'post'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],"[",["T_CONSTANT_ENCAPSED_STRING","'_csrfToken'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'no match'",370],",",["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'token'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'yes'",370],"]",",",["T_WHITESPACE","\n        ",370],"]",")",";",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$controller",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","response",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_NEW","new",372],["T_WHITESPACE"," ",372],["T_STRING","Response",372],"(",")",";",["T_WHITESPACE","\n\n        ",372],["T_VARIABLE","$component",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_NEW","new",374],["T_WHITESPACE"," ",374],["T_STRING","CsrfComponent",374],"(",["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","registry",374],",",["T_WHITESPACE"," ",374],"[",["T_WHITESPACE","\n            ",374],["T_CONSTANT_ENCAPSED_STRING","'cookieName'",375],["T_WHITESPACE"," ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],["T_CONSTANT_ENCAPSED_STRING","'token'",375],",",["T_WHITESPACE","\n            ",375],["T_CONSTANT_ENCAPSED_STRING","'field'",376],["T_WHITESPACE"," ",376],["T_DOUBLE_ARROW","=>",376],["T_WHITESPACE"," ",376],["T_CONSTANT_ENCAPSED_STRING","'token'",376],",",["T_WHITESPACE","\n            ",376],["T_CONSTANT_ENCAPSED_STRING","'expiry'",377],["T_WHITESPACE"," ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],["T_LNUMBER","90",377],",",["T_WHITESPACE","\n        ",377],"]",")",";",["T_WHITESPACE","\n\n        ",378],["T_VARIABLE","$event",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_NEW","new",380],["T_WHITESPACE"," ",380],["T_STRING","Event",380],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$controller",380],")",";",["T_WHITESPACE","\n        ",380],["T_VARIABLE","$result",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$component",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","startup",381],"(",["T_VARIABLE","$event",381],")",";",["T_WHITESPACE","\n        ",381],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","assertNull",382],"(",["T_VARIABLE","$result",382],",",["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'Config settings should work.'",382],")",";",["T_WHITESPACE","\n    ",382],"}",["T_WHITESPACE","\n",383],"}",["T_WHITESPACE","\n",384]]