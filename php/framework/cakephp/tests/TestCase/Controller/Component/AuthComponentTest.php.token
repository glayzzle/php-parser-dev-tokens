[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         1.2.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Controller",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Auth",17],["T_NS_SEPARATOR","\\",17],["T_STRING","BaseAuthorize",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Auth",18],["T_NS_SEPARATOR","\\",18],["T_STRING","FormAuthenticate",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Controller",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","AuthComponent",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Core",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Configure",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Event",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Event",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Event",22],["T_NS_SEPARATOR","\\",22],["T_STRING","EventManager",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Cake",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Network",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Request",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Cake",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Network",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Response",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Cake",25],["T_NS_SEPARATOR","\\",25],["T_STRING","ORM",25],["T_NS_SEPARATOR","\\",25],["T_STRING","TableRegistry",25],";",["T_WHITESPACE","\n",25],["T_USE","use",26],["T_WHITESPACE"," ",26],["T_STRING","Cake",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Routing",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Router",26],";",["T_WHITESPACE","\n",26],["T_USE","use",27],["T_WHITESPACE"," ",27],["T_STRING","Cake",27],["T_NS_SEPARATOR","\\",27],["T_STRING","TestSuite",27],["T_NS_SEPARATOR","\\",27],["T_STRING","TestCase",27],";",["T_WHITESPACE","\n",27],["T_USE","use",28],["T_WHITESPACE"," ",28],["T_STRING","Cake",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Utility",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Security",28],";",["T_WHITESPACE","\n",28],["T_USE","use",29],["T_WHITESPACE"," ",29],["T_STRING","TestApp",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Controller",29],["T_NS_SEPARATOR","\\",29],["T_STRING","AuthTestController",29],";",["T_WHITESPACE","\n",29],["T_USE","use",30],["T_WHITESPACE"," ",30],["T_STRING","TestApp",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Controller",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Component",30],["T_NS_SEPARATOR","\\",30],["T_STRING","TestAuthComponent",30],";",["T_WHITESPACE","\n\n",30],["T_DOC_COMMENT","\/**\n * AuthComponentTest class\n *\/",32],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","AuthComponentTest",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","TestCase",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * name property\n     *\n     * @var string\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$name",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'Auth'",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * fixtures property\n     *\n     * @var array\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$fixtures",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],"[",["T_CONSTANT_ENCAPSED_STRING","'core.auth_users'",50],",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'core.users'",50],"]",";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * setUp method\n     *\n     * @return void\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","setUp",57],"(",")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_STRING","parent",59],["T_DOUBLE_COLON","::",59],["T_STRING","setUp",59],"(",")",";",["T_WHITESPACE","\n\n        ",59],["T_STRING","Security",61],["T_DOUBLE_COLON","::",61],["T_STRING","salt",61],"(",["T_CONSTANT_ENCAPSED_STRING","'YJfIxfs2guVoUubWDYhG93b0qyJfIxfs2guwvniR2G0FgaC9mi'",61],")",";",["T_WHITESPACE","\n        ",61],["T_STRING","Configure",62],["T_DOUBLE_COLON","::",62],["T_STRING","write",62],"(",["T_CONSTANT_ENCAPSED_STRING","'App.namespace'",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'TestApp'",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_STRING","Router",64],["T_DOUBLE_COLON","::",64],["T_STRING","scope",64],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",64],",",["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$routes",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$routes",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","fallbacks",65],"(",["T_CONSTANT_ENCAPSED_STRING","'InflectedRoute'",65],")",";",["T_WHITESPACE","\n        ",65],"}",")",";",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$request",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_STRING","Request",68],"(",")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$response",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getMockBuilder",69],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",69],")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","setMethods",70],"(","[",["T_CONSTANT_ENCAPSED_STRING","'stop'",70],"]",")",["T_WHITESPACE","\n            ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","getMock",71],"(",")",";",["T_WHITESPACE","\n\n        ",71],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","Controller",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","AuthTestController",73],"(",["T_VARIABLE","$request",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$response",73],")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","Auth",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_NEW","new",74],["T_WHITESPACE"," ",74],["T_STRING","TestAuthComponent",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","Controller",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","components",74],"(",")",")",";",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$Users",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","TableRegistry",76],["T_DOUBLE_COLON","::",76],["T_STRING","get",76],"(",["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$Users",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","updateAll",77],"(","[",["T_CONSTANT_ENCAPSED_STRING","'password'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_STRING","password_hash",77],"(",["T_CONSTANT_ENCAPSED_STRING","'cake'",77],",",["T_WHITESPACE"," ",77],["T_STRING","PASSWORD_BCRYPT",77],")","]",",",["T_WHITESPACE"," ",77],"[","]",")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * tearDown method\n     *\n     * @return void\n     *\/",80],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","tearDown",85],"(",")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_STRING","parent",87],["T_DOUBLE_COLON","::",87],["T_STRING","tearDown",87],"(",")",";",["T_WHITESPACE","\n\n        ",87],["T_VARIABLE","$_SESSION",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],"[","]",";",["T_WHITESPACE","\n        ",89],["T_UNSET","unset",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","Controller",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","Auth",90],")",";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * testNoAuth method\n     *\n     * @return void\n     *\/",93],["T_WHITESPACE","\n    ",97],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","testNoAuth",98],"(",")",["T_WHITESPACE","\n    ",98],"{",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","assertFalse",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","Auth",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","isAuthorized",100],"(",")",")",";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * testIsErrorOrTests\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",103],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","testIsErrorOrTests",109],"(",")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$event",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","Event",111],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","Controller",111],")",";",["T_WHITESPACE","\n\n        ",111],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","Controller",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","name",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'Error'",113],";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","assertNull",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","Controller",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","Auth",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","startup",114],"(",["T_VARIABLE","$event",114],")",")",";",["T_WHITESPACE","\n\n        ",114],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","Controller",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","name",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'Post'",116],";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","Controller",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","request",117],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",117],"]",["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'thisdoesnotexist'",117],";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","assertNull",118],"(",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","Controller",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","Auth",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","startup",118],"(",["T_VARIABLE","$event",118],")",")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * testIdentify method\n     *\n     * @return void\n     *\/",121],["T_WHITESPACE","\n    ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","testIdentify",126],"(",")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$AuthLoginFormAuthenticate",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getMockBuilder",128],"(",["T_STRING","FormAuthenticate",128],["T_DOUBLE_COLON","::",128],["T_CLASS","class",128],")",["T_WHITESPACE","\n            ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","setMethods",129],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",129],"]",")",["T_WHITESPACE","\n            ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","disableOriginalConstructor",130],"(",")",["T_WHITESPACE","\n            ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","getMock",131],"(",")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","Auth",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","authenticate",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],"[",["T_WHITESPACE","\n            ",132],["T_CONSTANT_ENCAPSED_STRING","'AuthLoginForm'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],"[",["T_WHITESPACE","\n                ",133],["T_CONSTANT_ENCAPSED_STRING","'userModel'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",134],["T_WHITESPACE","\n            ",134],"]",["T_WHITESPACE","\n        ",135],"]",";",["T_WHITESPACE","\n\n        ",136],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","Auth",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setAuthenticateObject",138],"(",["T_LNUMBER","0",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$AuthLoginFormAuthenticate",138],")",";",["T_WHITESPACE","\n\n        ",138],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","Auth",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","request",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","data",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],"[",["T_WHITESPACE","\n            ",140],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],"[",["T_WHITESPACE","\n                ",141],["T_CONSTANT_ENCAPSED_STRING","'username'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'mark'",142],",",["T_WHITESPACE","\n                ",142],["T_CONSTANT_ENCAPSED_STRING","'password'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_STRING","Security",143],["T_DOUBLE_COLON","::",143],["T_STRING","hash",143],"(",["T_CONSTANT_ENCAPSED_STRING","'cake'",143],",",["T_WHITESPACE"," ",143],["T_STRING","null",143],",",["T_WHITESPACE"," ",143],["T_STRING","true",143],")",["T_WHITESPACE","\n            ",143],"]",["T_WHITESPACE","\n        ",144],"]",";",["T_WHITESPACE","\n\n        ",145],["T_VARIABLE","$user",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],"[",["T_WHITESPACE","\n            ",147],["T_CONSTANT_ENCAPSED_STRING","'id'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_LNUMBER","1",148],",",["T_WHITESPACE","\n            ",148],["T_CONSTANT_ENCAPSED_STRING","'username'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'mark'",149],["T_WHITESPACE","\n        ",149],"]",";",["T_WHITESPACE","\n\n        ",150],["T_VARIABLE","$AuthLoginFormAuthenticate",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","expects",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","once",152],"(",")",")",["T_WHITESPACE","\n            ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","method",153],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",153],")",["T_WHITESPACE","\n            ",153],["T_OBJECT_OPERATOR","->",154],["T_STRING","with",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","Auth",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","request",154],")",["T_WHITESPACE","\n            ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","will",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","returnValue",155],"(",["T_VARIABLE","$user",155],")",")",";",["T_WHITESPACE","\n\n        ",155],["T_VARIABLE","$result",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","Auth",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","identify",157],"(",")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","assertEquals",158],"(",["T_VARIABLE","$user",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$result",158],")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertSame",159],"(",["T_VARIABLE","$AuthLoginFormAuthenticate",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","Auth",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","authenticationProvider",159],"(",")",")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Test identify with user record as ArrayObject instance.\n     *\n     * @return void\n     *\/",162],["T_WHITESPACE","\n    ",166],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","testIdentifyArrayAccess",167],"(",")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$AuthLoginFormAuthenticate",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getMockBuilder",169],"(",["T_STRING","FormAuthenticate",169],["T_DOUBLE_COLON","::",169],["T_CLASS","class",169],")",["T_WHITESPACE","\n            ",169],["T_OBJECT_OPERATOR","->",170],["T_STRING","setMethods",170],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",170],"]",")",["T_WHITESPACE","\n            ",170],["T_OBJECT_OPERATOR","->",171],["T_STRING","disableOriginalConstructor",171],"(",")",["T_WHITESPACE","\n            ",171],["T_OBJECT_OPERATOR","->",172],["T_STRING","getMock",172],"(",")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","Auth",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","authenticate",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],"[",["T_WHITESPACE","\n            ",173],["T_CONSTANT_ENCAPSED_STRING","'AuthLoginForm'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],"[",["T_WHITESPACE","\n                ",174],["T_CONSTANT_ENCAPSED_STRING","'userModel'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",175],["T_WHITESPACE","\n            ",175],"]",["T_WHITESPACE","\n        ",176],"]",";",["T_WHITESPACE","\n\n        ",177],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","Auth",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","setAuthenticateObject",179],"(",["T_LNUMBER","0",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$AuthLoginFormAuthenticate",179],")",";",["T_WHITESPACE","\n\n        ",179],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","Auth",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","request",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","data",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],"[",["T_WHITESPACE","\n            ",181],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],"[",["T_WHITESPACE","\n                ",182],["T_CONSTANT_ENCAPSED_STRING","'username'",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","'mark'",183],",",["T_WHITESPACE","\n                ",183],["T_CONSTANT_ENCAPSED_STRING","'password'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_STRING","Security",184],["T_DOUBLE_COLON","::",184],["T_STRING","hash",184],"(",["T_CONSTANT_ENCAPSED_STRING","'cake'",184],",",["T_WHITESPACE"," ",184],["T_STRING","null",184],",",["T_WHITESPACE"," ",184],["T_STRING","true",184],")",["T_WHITESPACE","\n            ",184],"]",["T_WHITESPACE","\n        ",185],"]",";",["T_WHITESPACE","\n\n        ",186],["T_VARIABLE","$user",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_NEW","new",188],["T_WHITESPACE"," ",188],["T_NS_SEPARATOR","\\",188],["T_STRING","ArrayObject",188],"(","[",["T_WHITESPACE","\n            ",188],["T_CONSTANT_ENCAPSED_STRING","'id'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_LNUMBER","1",189],",",["T_WHITESPACE","\n            ",189],["T_CONSTANT_ENCAPSED_STRING","'username'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'mark'",190],["T_WHITESPACE","\n        ",190],"]",")",";",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$AuthLoginFormAuthenticate",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","expects",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","once",193],"(",")",")",["T_WHITESPACE","\n            ",193],["T_OBJECT_OPERATOR","->",194],["T_STRING","method",194],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",194],")",["T_WHITESPACE","\n            ",194],["T_OBJECT_OPERATOR","->",195],["T_STRING","with",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","Auth",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","request",195],")",["T_WHITESPACE","\n            ",195],["T_OBJECT_OPERATOR","->",196],["T_STRING","will",196],"(",["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","returnValue",196],"(",["T_VARIABLE","$user",196],")",")",";",["T_WHITESPACE","\n\n        ",196],["T_VARIABLE","$result",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","Auth",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","identify",198],"(",")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","assertEquals",199],"(",["T_VARIABLE","$user",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$result",199],")",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","assertSame",200],"(",["T_VARIABLE","$AuthLoginFormAuthenticate",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","Auth",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","authenticationProvider",200],"(",")",")",";",["T_WHITESPACE","\n    ",200],"}",["T_WHITESPACE","\n\n    ",201],["T_DOC_COMMENT","\/**\n     * testRedirectVarClearing method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",203],["T_WHITESPACE","\n    ",208],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","testRedirectVarClearing",209],"(",")",["T_WHITESPACE","\n    ",209],"{",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","Controller",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","request",211],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",211],"]",["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'auth_test'",211],";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","Controller",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","request",212],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",212],"]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","'add'",212],";",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","Controller",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","request",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","here",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/add'",213],";",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","assertNull",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","Auth",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","session",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","read",214],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",214],")",")",";",["T_WHITESPACE","\n\n        ",214],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","Auth",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","config",216],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",216],",",["T_WHITESPACE"," ",216],"[",["T_CONSTANT_ENCAPSED_STRING","'Form'",216],"]",")",";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$event",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_NEW","new",217],["T_WHITESPACE"," ",217],["T_STRING","Event",217],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","Controller",217],")",";",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","Auth",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","startup",218],"(",["T_VARIABLE","$event",218],")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","assertEquals",219],"(",["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/add'",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","Auth",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","session",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","read",219],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",219],")",")",";",["T_WHITESPACE","\n\n        ",219],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","Auth",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","storage",221],"(",")",["T_OBJECT_OPERATOR","->",221],["T_STRING","write",221],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'admad'",221],"]",")",";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","Auth",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","startup",222],"(",["T_VARIABLE","$event",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","Controller",222],")",";",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","assertNull",223],"(",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","Auth",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","session",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","read",223],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",223],")",")",";",["T_WHITESPACE","\n    ",223],"}",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * testAuthorizeFalse method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",226],["T_WHITESPACE","\n    ",231],["T_PUBLIC","public",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","testAuthorizeFalse",232],"(",")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$event",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_NEW","new",234],["T_WHITESPACE"," ",234],["T_STRING","Event",234],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",234],",",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","Controller",234],")",";",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$Users",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_STRING","TableRegistry",235],["T_DOUBLE_COLON","::",235],["T_STRING","get",235],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",235],")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$user",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$Users",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","find",236],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",236],")",["T_OBJECT_OPERATOR","->",236],["T_STRING","hydrate",236],"(",["T_STRING","false",236],")",["T_OBJECT_OPERATOR","->",236],["T_STRING","first",236],"(",")",";",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","Controller",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","Auth",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","storage",237],"(",")",["T_OBJECT_OPERATOR","->",237],["T_STRING","write",237],"(",["T_VARIABLE","$user",237],")",";",["T_WHITESPACE","\n        ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","Controller",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","Auth",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","config",238],"(",["T_CONSTANT_ENCAPSED_STRING","'userModel'",238],",",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'Users'",238],")",";",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","Controller",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","Auth",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","config",239],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",239],",",["T_WHITESPACE"," ",239],["T_STRING","false",239],")",";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","Controller",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","request",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","addParams",240],"(",["T_STRING","Router",240],["T_DOUBLE_COLON","::",240],["T_STRING","parse",240],"(",["T_CONSTANT_ENCAPSED_STRING","'auth_test\/add'",240],")",")",";",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$result",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","Controller",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","Auth",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","startup",241],"(",["T_VARIABLE","$event",241],")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","assertNull",242],"(",["T_VARIABLE","$result",242],")",";",["T_WHITESPACE","\n\n        ",242],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","Controller",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","Auth",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","storage",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","delete",244],"(",")",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$result",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","Controller",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","Auth",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","startup",245],"(",["T_VARIABLE","$event",245],")",";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","assertTrue",246],"(",["T_VARIABLE","$event",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","isStopped",246],"(",")",")",";",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","assertInstanceOf",247],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$result",247],")",";",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","assertTrue",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","Auth",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","session",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","check",248],"(",["T_CONSTANT_ENCAPSED_STRING","'Flash.auth'",248],")",")",";",["T_WHITESPACE","\n\n        ",248],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","Controller",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","request",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","addParams",250],"(",["T_STRING","Router",250],["T_DOUBLE_COLON","::",250],["T_STRING","parse",250],"(",["T_CONSTANT_ENCAPSED_STRING","'auth_test\/camelCase'",250],")",")",";",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$result",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","Controller",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","Auth",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","startup",251],"(",["T_VARIABLE","$event",251],")",";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","assertInstanceOf",252],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$result",252],")",";",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * testIsAuthorizedMissingFile function\n     *\n     * @expectedException \\Cake\\Core\\Exception\\Exception\n     * @return void\n     *\/",255],["T_WHITESPACE","\n    ",260],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","testIsAuthorizedMissingFile",261],"(",")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","Controller",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","Auth",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","config",263],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",263],",",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'Missing'",263],")",";",["T_WHITESPACE","\n        ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","Controller",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","Auth",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","isAuthorized",264],"(","[",["T_CONSTANT_ENCAPSED_STRING","'User'",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_LNUMBER","1",264],"]","]",")",";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * test that isAuthorized calls methods correctly\n     *\n     * @return void\n     *\/",267],["T_WHITESPACE","\n    ",271],["T_PUBLIC","public",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","testIsAuthorizedDelegation",272],"(",")",["T_WHITESPACE","\n    ",272],"{",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$AuthMockOneAuthorize",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getMockBuilder",274],"(",["T_STRING","BaseAuthorize",274],["T_DOUBLE_COLON","::",274],["T_CLASS","class",274],")",["T_WHITESPACE","\n            ",274],["T_OBJECT_OPERATOR","->",275],["T_STRING","setMethods",275],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authorize'",275],"]",")",["T_WHITESPACE","\n            ",275],["T_OBJECT_OPERATOR","->",276],["T_STRING","disableOriginalConstructor",276],"(",")",["T_WHITESPACE","\n            ",276],["T_OBJECT_OPERATOR","->",277],["T_STRING","getMock",277],"(",")",";",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$AuthMockTwoAuthorize",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getMockBuilder",278],"(",["T_STRING","BaseAuthorize",278],["T_DOUBLE_COLON","::",278],["T_CLASS","class",278],")",["T_WHITESPACE","\n            ",278],["T_OBJECT_OPERATOR","->",279],["T_STRING","setMethods",279],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authorize'",279],"]",")",["T_WHITESPACE","\n            ",279],["T_OBJECT_OPERATOR","->",280],["T_STRING","disableOriginalConstructor",280],"(",")",["T_WHITESPACE","\n            ",280],["T_OBJECT_OPERATOR","->",281],["T_STRING","getMock",281],"(",")",";",["T_WHITESPACE","\n        ",281],["T_VARIABLE","$AuthMockThreeAuthorize",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getMockBuilder",282],"(",["T_STRING","BaseAuthorize",282],["T_DOUBLE_COLON","::",282],["T_CLASS","class",282],")",["T_WHITESPACE","\n            ",282],["T_OBJECT_OPERATOR","->",283],["T_STRING","setMethods",283],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authorize'",283],"]",")",["T_WHITESPACE","\n            ",283],["T_OBJECT_OPERATOR","->",284],["T_STRING","disableOriginalConstructor",284],"(",")",["T_WHITESPACE","\n            ",284],["T_OBJECT_OPERATOR","->",285],["T_STRING","getMock",285],"(",")",";",["T_WHITESPACE","\n\n        ",285],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","Auth",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","setAuthorizeObject",287],"(",["T_LNUMBER","0",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$AuthMockOneAuthorize",287],")",";",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","Auth",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","setAuthorizeObject",288],"(",["T_LNUMBER","1",288],",",["T_WHITESPACE"," ",288],["T_VARIABLE","$AuthMockTwoAuthorize",288],")",";",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","Auth",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","setAuthorizeObject",289],"(",["T_LNUMBER","2",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$AuthMockThreeAuthorize",289],")",";",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$request",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","Auth",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","request",290],";",["T_WHITESPACE","\n\n        ",290],["T_VARIABLE","$AuthMockOneAuthorize",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","expects",292],"(",["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","once",292],"(",")",")",["T_WHITESPACE","\n            ",292],["T_OBJECT_OPERATOR","->",293],["T_STRING","method",293],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",293],")",["T_WHITESPACE","\n            ",293],["T_OBJECT_OPERATOR","->",294],["T_STRING","with",294],"(","[",["T_CONSTANT_ENCAPSED_STRING","'User'",294],"]",",",["T_WHITESPACE"," ",294],["T_VARIABLE","$request",294],")",["T_WHITESPACE","\n            ",294],["T_OBJECT_OPERATOR","->",295],["T_STRING","will",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","returnValue",295],"(",["T_STRING","false",295],")",")",";",["T_WHITESPACE","\n\n        ",295],["T_VARIABLE","$AuthMockTwoAuthorize",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","expects",297],"(",["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","once",297],"(",")",")",["T_WHITESPACE","\n            ",297],["T_OBJECT_OPERATOR","->",298],["T_STRING","method",298],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",298],")",["T_WHITESPACE","\n            ",298],["T_OBJECT_OPERATOR","->",299],["T_STRING","with",299],"(","[",["T_CONSTANT_ENCAPSED_STRING","'User'",299],"]",",",["T_WHITESPACE"," ",299],["T_VARIABLE","$request",299],")",["T_WHITESPACE","\n            ",299],["T_OBJECT_OPERATOR","->",300],["T_STRING","will",300],"(",["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","returnValue",300],"(",["T_STRING","true",300],")",")",";",["T_WHITESPACE","\n\n        ",300],["T_VARIABLE","$AuthMockThreeAuthorize",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","expects",302],"(",["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","never",302],"(",")",")",["T_WHITESPACE","\n            ",302],["T_OBJECT_OPERATOR","->",303],["T_STRING","method",303],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",303],")",";",["T_WHITESPACE","\n\n        ",303],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","assertTrue",305],"(",["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","Auth",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","isAuthorized",305],"(","[",["T_CONSTANT_ENCAPSED_STRING","'User'",305],"]",",",["T_WHITESPACE"," ",305],["T_VARIABLE","$request",305],")",")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","assertSame",306],"(",["T_VARIABLE","$AuthMockTwoAuthorize",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","Auth",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","authorizationProvider",306],"(",")",")",";",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n\n    ",307],["T_DOC_COMMENT","\/**\n     * test isAuthorized passing it an ArrayObject instance.\n     *\n     * @return void\n     *\/",309],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","testIsAuthorizedWithArrayObject",314],"(",")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$AuthMockOneAuthorize",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getMockBuilder",316],"(",["T_STRING","BaseAuthorize",316],["T_DOUBLE_COLON","::",316],["T_CLASS","class",316],")",["T_WHITESPACE","\n            ",316],["T_OBJECT_OPERATOR","->",317],["T_STRING","setMethods",317],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authorize'",317],"]",")",["T_WHITESPACE","\n            ",317],["T_OBJECT_OPERATOR","->",318],["T_STRING","disableOriginalConstructor",318],"(",")",["T_WHITESPACE","\n            ",318],["T_OBJECT_OPERATOR","->",319],["T_STRING","getMock",319],"(",")",";",["T_WHITESPACE","\n\n        ",319],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","Auth",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","setAuthorizeObject",321],"(",["T_LNUMBER","0",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$AuthMockOneAuthorize",321],")",";",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$request",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","Auth",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","request",322],";",["T_WHITESPACE","\n\n        ",322],["T_VARIABLE","$user",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_NEW","new",324],["T_WHITESPACE"," ",324],["T_NS_SEPARATOR","\\",324],["T_STRING","ArrayObject",324],"(","[",["T_CONSTANT_ENCAPSED_STRING","'User'",324],"]",")",";",["T_WHITESPACE","\n\n        ",324],["T_VARIABLE","$AuthMockOneAuthorize",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","expects",326],"(",["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","once",326],"(",")",")",["T_WHITESPACE","\n            ",326],["T_OBJECT_OPERATOR","->",327],["T_STRING","method",327],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",327],")",["T_WHITESPACE","\n            ",327],["T_OBJECT_OPERATOR","->",328],["T_STRING","with",328],"(",["T_VARIABLE","$user",328],",",["T_WHITESPACE"," ",328],["T_VARIABLE","$request",328],")",["T_WHITESPACE","\n            ",328],["T_OBJECT_OPERATOR","->",329],["T_STRING","will",329],"(",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","returnValue",329],"(",["T_STRING","true",329],")",")",";",["T_WHITESPACE","\n\n        ",329],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","assertTrue",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","Auth",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","isAuthorized",331],"(",["T_VARIABLE","$user",331],",",["T_WHITESPACE"," ",331],["T_VARIABLE","$request",331],")",")",";",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","assertSame",332],"(",["T_VARIABLE","$AuthMockOneAuthorize",332],",",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","Auth",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","authorizationProvider",332],"(",")",")",";",["T_WHITESPACE","\n    ",332],"}",["T_WHITESPACE","\n\n    ",333],["T_DOC_COMMENT","\/**\n     * test that isAuthorized will use the session user if none is given.\n     *\n     * @return void\n     *\/",335],["T_WHITESPACE","\n    ",339],["T_PUBLIC","public",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","testIsAuthorizedUsingUserInSession",340],"(",")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$AuthMockFourAuthorize",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getMockBuilder",342],"(",["T_STRING","BaseAuthorize",342],["T_DOUBLE_COLON","::",342],["T_CLASS","class",342],")",["T_WHITESPACE","\n            ",342],["T_OBJECT_OPERATOR","->",343],["T_STRING","setMethods",343],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authorize'",343],"]",")",["T_WHITESPACE","\n            ",343],["T_OBJECT_OPERATOR","->",344],["T_STRING","disableOriginalConstructor",344],"(",")",["T_WHITESPACE","\n            ",344],["T_OBJECT_OPERATOR","->",345],["T_STRING","getMock",345],"(",")",";",["T_WHITESPACE","\n        ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","Auth",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","config",346],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",346],",",["T_WHITESPACE"," ",346],"[",["T_CONSTANT_ENCAPSED_STRING","'AuthMockFour'",346],"]",")",";",["T_WHITESPACE","\n        ",346],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","Auth",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","setAuthorizeObject",347],"(",["T_LNUMBER","0",347],",",["T_WHITESPACE"," ",347],["T_VARIABLE","$AuthMockFourAuthorize",347],")",";",["T_WHITESPACE","\n\n        ",347],["T_VARIABLE","$user",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],"[",["T_CONSTANT_ENCAPSED_STRING","'user'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'mark'",349],"]",";",["T_WHITESPACE","\n        ",349],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","Auth",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","session",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","write",350],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.User'",350],",",["T_WHITESPACE"," ",350],["T_VARIABLE","$user",350],")",";",["T_WHITESPACE","\n        ",350],["T_VARIABLE","$request",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","Controller",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","request",351],";",["T_WHITESPACE","\n\n        ",351],["T_VARIABLE","$AuthMockFourAuthorize",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","expects",353],"(",["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","once",353],"(",")",")",["T_WHITESPACE","\n            ",353],["T_OBJECT_OPERATOR","->",354],["T_STRING","method",354],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",354],")",["T_WHITESPACE","\n            ",354],["T_OBJECT_OPERATOR","->",355],["T_STRING","with",355],"(",["T_VARIABLE","$user",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$request",355],")",["T_WHITESPACE","\n            ",355],["T_OBJECT_OPERATOR","->",356],["T_STRING","will",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","returnValue",356],"(",["T_STRING","true",356],")",")",";",["T_WHITESPACE","\n\n        ",356],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","assertTrue",358],"(",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","Auth",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","isAuthorized",358],"(",["T_STRING","null",358],",",["T_WHITESPACE"," ",358],["T_VARIABLE","$request",358],")",")",";",["T_WHITESPACE","\n    ",358],"}",["T_WHITESPACE","\n\n    ",359],["T_DOC_COMMENT","\/**\n     * test that loadAuthorize resets the loaded objects each time.\n     *\n     * @return void\n     *\/",361],["T_WHITESPACE","\n    ",365],["T_PUBLIC","public",366],["T_WHITESPACE"," ",366],["T_FUNCTION","function",366],["T_WHITESPACE"," ",366],["T_STRING","testLoadAuthorizeResets",366],"(",")",["T_WHITESPACE","\n    ",366],"{",["T_WHITESPACE","\n        ",367],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","Controller",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","Auth",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","config",368],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",368],",",["T_WHITESPACE"," ",368],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",368],"]",")",";",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$result",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","Controller",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","Auth",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","constructAuthorize",369],"(",")",";",["T_WHITESPACE","\n        ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","assertCount",370],"(",["T_LNUMBER","1",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$result",370],")",";",["T_WHITESPACE","\n\n        ",370],["T_VARIABLE","$result",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","Controller",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","Auth",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","constructAuthorize",372],"(",")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","assertCount",373],"(",["T_LNUMBER","1",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$result",373],")",";",["T_WHITESPACE","\n    ",373],"}",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * testLoadAuthenticateNoFile function\n     *\n     * @expectedException \\Cake\\Core\\Exception\\Exception\n     * @return void\n     *\/",376],["T_WHITESPACE","\n    ",381],["T_PUBLIC","public",382],["T_WHITESPACE"," ",382],["T_FUNCTION","function",382],["T_WHITESPACE"," ",382],["T_STRING","testLoadAuthenticateNoFile",382],"(",")",["T_WHITESPACE","\n    ",382],"{",["T_WHITESPACE","\n        ",383],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","Controller",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","Auth",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","config",384],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'Missing'",384],")",";",["T_WHITESPACE","\n        ",384],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","Controller",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","Auth",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","identify",385],"(",["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","Controller",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","request",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","Controller",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","response",385],")",";",["T_WHITESPACE","\n    ",385],"}",["T_WHITESPACE","\n\n    ",386],["T_DOC_COMMENT","\/**\n     * test the * key with authenticate\n     *\n     * @return void\n     *\/",388],["T_WHITESPACE","\n    ",392],["T_PUBLIC","public",393],["T_WHITESPACE"," ",393],["T_FUNCTION","function",393],["T_WHITESPACE"," ",393],["T_STRING","testAllConfigWithAuthorize",393],"(",")",["T_WHITESPACE","\n    ",393],"{",["T_WHITESPACE","\n        ",394],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","Controller",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","Auth",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","config",395],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",395],",",["T_WHITESPACE"," ",395],"[",["T_WHITESPACE","\n            ",395],["T_STRING","AuthComponent",396],["T_DOUBLE_COLON","::",396],["T_STRING","ALL",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],"[",["T_CONSTANT_ENCAPSED_STRING","'actionPath'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_CONSTANT_ENCAPSED_STRING","'controllers\/'",396],"]",",",["T_WHITESPACE","\n            ",396],["T_CONSTANT_ENCAPSED_STRING","'Controller'",397],",",["T_WHITESPACE","\n        ",397],"]",")",";",["T_WHITESPACE","\n        ",398],["T_VARIABLE","$objects",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_STRING","array_values",399],"(",["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","Controller",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","Auth",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","constructAuthorize",399],"(",")",")",";",["T_WHITESPACE","\n        ",399],["T_VARIABLE","$result",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_VARIABLE","$objects",400],"[",["T_LNUMBER","0",400],"]",";",["T_WHITESPACE","\n        ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","assertEquals",401],"(",["T_CONSTANT_ENCAPSED_STRING","'controllers\/'",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$result",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","config",401],"(",["T_CONSTANT_ENCAPSED_STRING","'actionPath'",401],")",")",";",["T_WHITESPACE","\n    ",401],"}",["T_WHITESPACE","\n\n    ",402],["T_DOC_COMMENT","\/**\n     * test that loadAuthorize resets the loaded objects each time.\n     *\n     * @return void\n     *\/",404],["T_WHITESPACE","\n    ",408],["T_PUBLIC","public",409],["T_WHITESPACE"," ",409],["T_FUNCTION","function",409],["T_WHITESPACE"," ",409],["T_STRING","testLoadAuthenticateResets",409],"(",")",["T_WHITESPACE","\n    ",409],"{",["T_WHITESPACE","\n        ",410],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","Controller",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","Auth",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","config",411],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",411],",",["T_WHITESPACE"," ",411],"[",["T_CONSTANT_ENCAPSED_STRING","'Form'",411],"]",")",";",["T_WHITESPACE","\n        ",411],["T_VARIABLE","$result",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","Controller",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","Auth",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","constructAuthenticate",412],"(",")",";",["T_WHITESPACE","\n        ",412],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","assertCount",413],"(",["T_LNUMBER","1",413],",",["T_WHITESPACE"," ",413],["T_VARIABLE","$result",413],")",";",["T_WHITESPACE","\n\n        ",413],["T_VARIABLE","$result",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","Controller",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","Auth",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","constructAuthenticate",415],"(",")",";",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","assertCount",416],"(",["T_LNUMBER","1",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$result",416],")",";",["T_WHITESPACE","\n    ",416],"}",["T_WHITESPACE","\n\n    ",417],["T_DOC_COMMENT","\/**\n     * test the * key with authenticate\n     *\n     * @return void\n     *\/",419],["T_WHITESPACE","\n    ",423],["T_PUBLIC","public",424],["T_WHITESPACE"," ",424],["T_FUNCTION","function",424],["T_WHITESPACE"," ",424],["T_STRING","testAllConfigWithAuthenticate",424],"(",")",["T_WHITESPACE","\n    ",424],"{",["T_WHITESPACE","\n        ",425],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","Controller",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","Auth",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","config",426],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",426],",",["T_WHITESPACE"," ",426],"[",["T_WHITESPACE","\n            ",426],["T_STRING","AuthComponent",427],["T_DOUBLE_COLON","::",427],["T_STRING","ALL",427],["T_WHITESPACE"," ",427],["T_DOUBLE_ARROW","=>",427],["T_WHITESPACE"," ",427],"[",["T_CONSTANT_ENCAPSED_STRING","'userModel'",427],["T_WHITESPACE"," ",427],["T_DOUBLE_ARROW","=>",427],["T_WHITESPACE"," ",427],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",427],"]",",",["T_WHITESPACE","\n            ",427],["T_CONSTANT_ENCAPSED_STRING","'Form'",428],["T_WHITESPACE","\n        ",428],"]",")",";",["T_WHITESPACE","\n        ",429],["T_VARIABLE","$objects",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_STRING","array_values",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","Controller",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","Auth",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","constructAuthenticate",430],"(",")",")",";",["T_WHITESPACE","\n        ",430],["T_VARIABLE","$result",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$objects",431],"[",["T_LNUMBER","0",431],"]",";",["T_WHITESPACE","\n        ",431],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","assertEquals",432],"(",["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",432],",",["T_WHITESPACE"," ",432],["T_VARIABLE","$result",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","config",432],"(",["T_CONSTANT_ENCAPSED_STRING","'userModel'",432],")",")",";",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n\n    ",433],["T_DOC_COMMENT","\/**\n     * test defining the same Authenticate object but with different password hashers\n     *\n     * @return void\n     *\/",435],["T_WHITESPACE","\n    ",439],["T_PUBLIC","public",440],["T_WHITESPACE"," ",440],["T_FUNCTION","function",440],["T_WHITESPACE"," ",440],["T_STRING","testSameAuthenticateWithDifferentHashers",440],"(",")",["T_WHITESPACE","\n    ",440],"{",["T_WHITESPACE","\n        ",441],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","Controller",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","Auth",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","config",442],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",442],",",["T_WHITESPACE"," ",442],"[",["T_WHITESPACE","\n            ",442],["T_CONSTANT_ENCAPSED_STRING","'FormSimple'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],"[",["T_CONSTANT_ENCAPSED_STRING","'className'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'Form'",443],",",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'passwordHasher'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'Default'",443],"]",",",["T_WHITESPACE","\n            ",443],["T_CONSTANT_ENCAPSED_STRING","'FormBlowfish'",444],["T_WHITESPACE"," ",444],["T_DOUBLE_ARROW","=>",444],["T_WHITESPACE"," ",444],"[",["T_CONSTANT_ENCAPSED_STRING","'className'",444],["T_WHITESPACE"," ",444],["T_DOUBLE_ARROW","=>",444],["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'Form'",444],",",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'passwordHasher'",444],["T_WHITESPACE"," ",444],["T_DOUBLE_ARROW","=>",444],["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'Fallback'",444],"]",",",["T_WHITESPACE","\n        ",444],"]",")",";",["T_WHITESPACE","\n\n        ",445],["T_VARIABLE","$objects",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","Controller",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","Auth",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","constructAuthenticate",447],"(",")",";",["T_WHITESPACE","\n        ",447],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","assertCount",448],"(",["T_LNUMBER","2",448],",",["T_WHITESPACE"," ",448],["T_VARIABLE","$objects",448],")",";",["T_WHITESPACE","\n\n        ",448],["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","assertInstanceOf",450],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\FormAuthenticate'",450],",",["T_WHITESPACE"," ",450],["T_VARIABLE","$objects",450],"[",["T_CONSTANT_ENCAPSED_STRING","'FormSimple'",450],"]",")",";",["T_WHITESPACE","\n        ",450],["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","assertInstanceOf",451],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\FormAuthenticate'",451],",",["T_WHITESPACE"," ",451],["T_VARIABLE","$objects",451],"[",["T_CONSTANT_ENCAPSED_STRING","'FormBlowfish'",451],"]",")",";",["T_WHITESPACE","\n\n        ",451],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","assertInstanceOf",453],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\DefaultPasswordHasher'",453],",",["T_WHITESPACE"," ",453],["T_VARIABLE","$objects",453],"[",["T_CONSTANT_ENCAPSED_STRING","'FormSimple'",453],"]",["T_OBJECT_OPERATOR","->",453],["T_STRING","passwordHasher",453],"(",")",")",";",["T_WHITESPACE","\n        ",453],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","assertInstanceOf",454],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\FallbackPasswordHasher'",454],",",["T_WHITESPACE"," ",454],["T_VARIABLE","$objects",454],"[",["T_CONSTANT_ENCAPSED_STRING","'FormBlowfish'",454],"]",["T_OBJECT_OPERATOR","->",454],["T_STRING","passwordHasher",454],"(",")",")",";",["T_WHITESPACE","\n    ",454],"}",["T_WHITESPACE","\n\n    ",455],["T_DOC_COMMENT","\/**\n     * Tests that deny always takes precedence over allow\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",457],["T_WHITESPACE","\n    ",462],["T_PUBLIC","public",463],["T_WHITESPACE"," ",463],["T_FUNCTION","function",463],["T_WHITESPACE"," ",463],["T_STRING","testAllowDenyAll",463],"(",")",["T_WHITESPACE","\n    ",463],"{",["T_WHITESPACE","\n        ",464],["T_VARIABLE","$event",465],["T_WHITESPACE"," ",465],"=",["T_WHITESPACE"," ",465],["T_NEW","new",465],["T_WHITESPACE"," ",465],["T_STRING","Event",465],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",465],",",["T_WHITESPACE"," ",465],["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","Controller",465],")",";",["T_WHITESPACE","\n        ",465],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","Controller",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","Auth",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","allow",466],"(",")",";",["T_WHITESPACE","\n        ",466],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","Controller",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","Auth",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","deny",467],"(","[",["T_CONSTANT_ENCAPSED_STRING","'add'",467],",",["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",467],"]",")",";",["T_WHITESPACE","\n\n        ",467],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","Controller",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","request",469],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",469],"]",["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'delete'",469],";",["T_WHITESPACE","\n        ",469],["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","assertNull",470],"(",["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","Controller",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","Auth",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","startup",470],"(",["T_VARIABLE","$event",470],")",")",";",["T_WHITESPACE","\n\n        ",470],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","Controller",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","request",472],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",472],"]",["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_CONSTANT_ENCAPSED_STRING","'add'",472],";",["T_WHITESPACE","\n        ",472],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","assertInstanceOf",473],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",473],",",["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","Controller",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","Auth",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","startup",473],"(",["T_VARIABLE","$event",473],")",")",";",["T_WHITESPACE","\n\n        ",473],["T_VARIABLE","$this",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","Controller",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","request",475],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",475],"]",["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",475],";",["T_WHITESPACE","\n        ",475],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","assertInstanceOf",476],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",476],",",["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","Controller",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","Auth",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","startup",476],"(",["T_VARIABLE","$event",476],")",")",";",["T_WHITESPACE","\n\n        ",476],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","Controller",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","Auth",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","allow",478],"(",")",";",["T_WHITESPACE","\n        ",478],["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","Controller",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","Auth",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","deny",479],"(","[",["T_CONSTANT_ENCAPSED_STRING","'add'",479],",",["T_WHITESPACE"," ",479],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",479],"]",")",";",["T_WHITESPACE","\n\n        ",479],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","Controller",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","request",481],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",481],"]",["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_CONSTANT_ENCAPSED_STRING","'delete'",481],";",["T_WHITESPACE","\n        ",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","assertNull",482],"(",["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","Controller",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","Auth",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","startup",482],"(",["T_VARIABLE","$event",482],")",")",";",["T_WHITESPACE","\n\n        ",482],["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","Controller",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","request",484],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",484],"]",["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",484],";",["T_WHITESPACE","\n        ",484],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","assertInstanceOf",485],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","Controller",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","Auth",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","startup",485],"(",["T_VARIABLE","$event",485],")",")",";",["T_WHITESPACE","\n\n        ",485],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","Controller",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","Auth",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","allow",487],"(",")",";",["T_WHITESPACE","\n        ",487],["T_VARIABLE","$this",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","Controller",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","Auth",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","deny",488],"(",")",";",["T_WHITESPACE","\n\n        ",488],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","Controller",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","request",490],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",490],"]",["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",490],";",["T_WHITESPACE","\n        ",490],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","assertInstanceOf",491],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",491],",",["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","Controller",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","Auth",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","startup",491],"(",["T_VARIABLE","$event",491],")",")",";",["T_WHITESPACE","\n\n        ",491],["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","Controller",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","request",493],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",493],"]",["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_CONSTANT_ENCAPSED_STRING","'add'",493],";",["T_WHITESPACE","\n        ",493],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","assertInstanceOf",494],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",494],",",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","Controller",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","Auth",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","startup",494],"(",["T_VARIABLE","$event",494],")",")",";",["T_WHITESPACE","\n\n        ",494],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","Controller",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","Auth",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","allow",496],"(",["T_CONSTANT_ENCAPSED_STRING","'camelCase'",496],")",";",["T_WHITESPACE","\n        ",496],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","Controller",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","Auth",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","deny",497],"(",")",";",["T_WHITESPACE","\n\n        ",497],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","Controller",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","request",499],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",499],"]",["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",499],";",["T_WHITESPACE","\n        ",499],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","assertInstanceOf",500],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",500],",",["T_WHITESPACE"," ",500],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","Controller",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","Auth",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","startup",500],"(",["T_VARIABLE","$event",500],")",")",";",["T_WHITESPACE","\n\n        ",500],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","Controller",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","request",502],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",502],"]",["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_CONSTANT_ENCAPSED_STRING","'login'",502],";",["T_WHITESPACE","\n        ",502],["T_VARIABLE","$this",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","assertInstanceOf",503],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",503],",",["T_WHITESPACE"," ",503],["T_VARIABLE","$this",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","Controller",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","Auth",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","startup",503],"(",["T_VARIABLE","$event",503],")",")",";",["T_WHITESPACE","\n\n        ",503],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","Controller",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","Auth",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","deny",505],"(",")",";",["T_WHITESPACE","\n        ",505],["T_VARIABLE","$this",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","Controller",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","Auth",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","allow",506],"(",["T_STRING","null",506],")",";",["T_WHITESPACE","\n\n        ",506],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","Controller",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","request",508],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",508],"]",["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",508],";",["T_WHITESPACE","\n        ",508],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","assertNull",509],"(",["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","Controller",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","Auth",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","startup",509],"(",["T_VARIABLE","$event",509],")",")",";",["T_WHITESPACE","\n\n        ",509],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","Controller",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","Auth",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","allow",511],"(",")",";",["T_WHITESPACE","\n        ",511],["T_VARIABLE","$this",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","Controller",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","Auth",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","deny",512],"(",["T_STRING","null",512],")",";",["T_WHITESPACE","\n\n        ",512],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","Controller",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","request",514],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",514],"]",["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",514],";",["T_WHITESPACE","\n        ",514],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","assertInstanceOf",515],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","Controller",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","Auth",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","startup",515],"(",["T_VARIABLE","$event",515],")",")",";",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n\n    ",516],["T_DOC_COMMENT","\/**\n     * test that deny() converts camel case inputs to lowercase.\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",518],["T_WHITESPACE","\n    ",523],["T_PUBLIC","public",524],["T_WHITESPACE"," ",524],["T_FUNCTION","function",524],["T_WHITESPACE"," ",524],["T_STRING","testDenyWithCamelCaseMethods",524],"(",")",["T_WHITESPACE","\n    ",524],"{",["T_WHITESPACE","\n        ",525],["T_VARIABLE","$event",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_NEW","new",526],["T_WHITESPACE"," ",526],["T_STRING","Event",526],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",526],",",["T_WHITESPACE"," ",526],["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","Controller",526],")",";",["T_WHITESPACE","\n        ",526],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","Controller",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","Auth",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","allow",527],"(",")",";",["T_WHITESPACE","\n        ",527],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","Controller",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","Auth",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","deny",528],"(","[",["T_CONSTANT_ENCAPSED_STRING","'add'",528],",",["T_WHITESPACE"," ",528],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",528],"]",")",";",["T_WHITESPACE","\n\n        ",528],["T_VARIABLE","$url",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/camelCase'",530],";",["T_WHITESPACE","\n        ",530],["T_VARIABLE","$this",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","Controller",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","request",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","addParams",531],"(",["T_STRING","Router",531],["T_DOUBLE_COLON","::",531],["T_STRING","parse",531],"(",["T_VARIABLE","$url",531],")",")",";",["T_WHITESPACE","\n        ",531],["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","Controller",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","request",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","query",532],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",532],"]",["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_STRING","Router",532],["T_DOUBLE_COLON","::",532],["T_STRING","normalize",532],"(",["T_VARIABLE","$url",532],")",";",["T_WHITESPACE","\n\n        ",532],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","assertInstanceOf",534],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",534],",",["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","Controller",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","Auth",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","startup",534],"(",["T_VARIABLE","$event",534],")",")",";",["T_WHITESPACE","\n\n        ",534],["T_VARIABLE","$url",536],["T_WHITESPACE"," ",536],"=",["T_WHITESPACE"," ",536],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/CamelCase'",536],";",["T_WHITESPACE","\n        ",536],["T_VARIABLE","$this",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","Controller",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","request",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","addParams",537],"(",["T_STRING","Router",537],["T_DOUBLE_COLON","::",537],["T_STRING","parse",537],"(",["T_VARIABLE","$url",537],")",")",";",["T_WHITESPACE","\n        ",537],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","Controller",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","request",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","query",538],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",538],"]",["T_WHITESPACE"," ",538],"=",["T_WHITESPACE"," ",538],["T_STRING","Router",538],["T_DOUBLE_COLON","::",538],["T_STRING","normalize",538],"(",["T_VARIABLE","$url",538],")",";",["T_WHITESPACE","\n        ",538],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","assertInstanceOf",539],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",539],",",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","Controller",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","Auth",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","startup",539],"(",["T_VARIABLE","$event",539],")",")",";",["T_WHITESPACE","\n    ",539],"}",["T_WHITESPACE","\n\n    ",540],["T_DOC_COMMENT","\/**\n     * test that allow() and allowedActions work with camelCase method names.\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",542],["T_WHITESPACE","\n    ",547],["T_PUBLIC","public",548],["T_WHITESPACE"," ",548],["T_FUNCTION","function",548],["T_WHITESPACE"," ",548],["T_STRING","testAllowedActionsWithCamelCaseMethods",548],"(",")",["T_WHITESPACE","\n    ",548],"{",["T_WHITESPACE","\n        ",549],["T_VARIABLE","$event",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_NEW","new",550],["T_WHITESPACE"," ",550],["T_STRING","Event",550],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",550],",",["T_WHITESPACE"," ",550],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","Controller",550],")",";",["T_WHITESPACE","\n        ",550],["T_VARIABLE","$url",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/camelCase'",551],";",["T_WHITESPACE","\n        ",551],["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","Controller",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","request",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","addParams",552],"(",["T_STRING","Router",552],["T_DOUBLE_COLON","::",552],["T_STRING","parse",552],"(",["T_VARIABLE","$url",552],")",")",";",["T_WHITESPACE","\n        ",552],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","Controller",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","request",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","query",553],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",553],"]",["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_STRING","Router",553],["T_DOUBLE_COLON","::",553],["T_STRING","normalize",553],"(",["T_VARIABLE","$url",553],")",";",["T_WHITESPACE","\n        ",553],["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","Controller",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","Auth",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","loginAction",554],["T_WHITESPACE"," ",554],"=",["T_WHITESPACE"," ",554],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",554],["T_WHITESPACE"," ",554],["T_DOUBLE_ARROW","=>",554],["T_WHITESPACE"," ",554],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",554],",",["T_WHITESPACE"," ",554],["T_CONSTANT_ENCAPSED_STRING","'action'",554],["T_WHITESPACE"," ",554],["T_DOUBLE_ARROW","=>",554],["T_WHITESPACE"," ",554],["T_CONSTANT_ENCAPSED_STRING","'login'",554],"]",";",["T_WHITESPACE","\n        ",554],["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","Controller",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","Auth",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","userModel",555],["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",555],";",["T_WHITESPACE","\n        ",555],["T_VARIABLE","$this",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","Controller",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","Auth",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","allow",556],"(",")",";",["T_WHITESPACE","\n        ",556],["T_VARIABLE","$result",557],["T_WHITESPACE"," ",557],"=",["T_WHITESPACE"," ",557],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","Controller",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","Auth",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","startup",557],"(",["T_VARIABLE","$event",557],")",";",["T_WHITESPACE","\n        ",557],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","assertNull",558],"(",["T_VARIABLE","$result",558],",",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","'startup() should return null, as action is allowed. %s'",558],")",";",["T_WHITESPACE","\n\n        ",558],["T_VARIABLE","$url",560],["T_WHITESPACE"," ",560],"=",["T_WHITESPACE"," ",560],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/camelCase'",560],";",["T_WHITESPACE","\n        ",560],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","Controller",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","request",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","addParams",561],"(",["T_STRING","Router",561],["T_DOUBLE_COLON","::",561],["T_STRING","parse",561],"(",["T_VARIABLE","$url",561],")",")",";",["T_WHITESPACE","\n        ",561],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","Controller",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","request",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","query",562],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",562],"]",["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],["T_STRING","Router",562],["T_DOUBLE_COLON","::",562],["T_STRING","normalize",562],"(",["T_VARIABLE","$url",562],")",";",["T_WHITESPACE","\n        ",562],["T_VARIABLE","$this",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","Controller",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","Auth",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","loginAction",563],["T_WHITESPACE"," ",563],"=",["T_WHITESPACE"," ",563],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",563],["T_WHITESPACE"," ",563],["T_DOUBLE_ARROW","=>",563],["T_WHITESPACE"," ",563],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",563],",",["T_WHITESPACE"," ",563],["T_CONSTANT_ENCAPSED_STRING","'action'",563],["T_WHITESPACE"," ",563],["T_DOUBLE_ARROW","=>",563],["T_WHITESPACE"," ",563],["T_CONSTANT_ENCAPSED_STRING","'login'",563],"]",";",["T_WHITESPACE","\n        ",563],["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","Controller",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","Auth",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","userModel",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",564],";",["T_WHITESPACE","\n        ",564],["T_VARIABLE","$this",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","Controller",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","Auth",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","allowedActions",565],["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],"[",["T_CONSTANT_ENCAPSED_STRING","'delete'",565],",",["T_WHITESPACE"," ",565],["T_CONSTANT_ENCAPSED_STRING","'camelCase'",565],",",["T_WHITESPACE"," ",565],["T_CONSTANT_ENCAPSED_STRING","'add'",565],"]",";",["T_WHITESPACE","\n        ",565],["T_VARIABLE","$result",566],["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","Controller",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","Auth",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","startup",566],"(",["T_VARIABLE","$event",566],")",";",["T_WHITESPACE","\n        ",566],["T_VARIABLE","$this",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","assertNull",567],"(",["T_VARIABLE","$result",567],",",["T_WHITESPACE"," ",567],["T_CONSTANT_ENCAPSED_STRING","'startup() should return null, as action is allowed. %s'",567],")",";",["T_WHITESPACE","\n\n        ",567],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","Controller",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","Auth",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","allowedActions",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],"[",["T_CONSTANT_ENCAPSED_STRING","'delete'",569],",",["T_WHITESPACE"," ",569],["T_CONSTANT_ENCAPSED_STRING","'add'",569],"]",";",["T_WHITESPACE","\n        ",569],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","assertInstanceOf",570],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",570],",",["T_WHITESPACE"," ",570],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","Controller",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","Auth",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","startup",570],"(",["T_VARIABLE","$event",570],")",")",";",["T_WHITESPACE","\n\n        ",570],["T_VARIABLE","$url",572],["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/delete'",572],";",["T_WHITESPACE","\n        ",572],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","Controller",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","request",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","addParams",573],"(",["T_STRING","Router",573],["T_DOUBLE_COLON","::",573],["T_STRING","parse",573],"(",["T_VARIABLE","$url",573],")",")",";",["T_WHITESPACE","\n        ",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","Controller",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","request",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","query",574],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",574],"]",["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_STRING","Router",574],["T_DOUBLE_COLON","::",574],["T_STRING","normalize",574],"(",["T_VARIABLE","$url",574],")",";",["T_WHITESPACE","\n        ",574],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","Controller",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","Auth",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","loginAction",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",575],",",["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'action'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'login'",575],"]",";",["T_WHITESPACE","\n        ",575],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","Controller",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","Auth",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","userModel",576],["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",576],";",["T_WHITESPACE","\n\n        ",576],["T_VARIABLE","$this",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","Controller",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","Auth",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","allow",578],"(","[",["T_CONSTANT_ENCAPSED_STRING","'delete'",578],",",["T_WHITESPACE"," ",578],["T_CONSTANT_ENCAPSED_STRING","'add'",578],"]",")",";",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$result",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","Controller",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","Auth",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","startup",579],"(",["T_VARIABLE","$event",579],")",";",["T_WHITESPACE","\n        ",579],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","assertNull",580],"(",["T_VARIABLE","$result",580],",",["T_WHITESPACE"," ",580],["T_CONSTANT_ENCAPSED_STRING","'startup() should return null, as action is allowed. %s'",580],")",";",["T_WHITESPACE","\n    ",580],"}",["T_WHITESPACE","\n\n    ",581],["T_DOC_COMMENT","\/**\n     * testAllowedActionsSetWithAllowMethod method\n     *\n     * @return void\n     *\/",583],["T_WHITESPACE","\n    ",587],["T_PUBLIC","public",588],["T_WHITESPACE"," ",588],["T_FUNCTION","function",588],["T_WHITESPACE"," ",588],["T_STRING","testAllowedActionsSetWithAllowMethod",588],"(",")",["T_WHITESPACE","\n    ",588],"{",["T_WHITESPACE","\n        ",589],["T_VARIABLE","$url",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/action_name'",590],";",["T_WHITESPACE","\n        ",590],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","Controller",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","request",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","addParams",591],"(",["T_STRING","Router",591],["T_DOUBLE_COLON","::",591],["T_STRING","parse",591],"(",["T_VARIABLE","$url",591],")",")",";",["T_WHITESPACE","\n        ",591],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","Controller",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","request",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","query",592],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",592],"]",["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_STRING","Router",592],["T_DOUBLE_COLON","::",592],["T_STRING","normalize",592],"(",["T_VARIABLE","$url",592],")",";",["T_WHITESPACE","\n        ",592],["T_VARIABLE","$this",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","Controller",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","Auth",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","allow",593],"(","[",["T_CONSTANT_ENCAPSED_STRING","'action_name'",593],",",["T_WHITESPACE"," ",593],["T_CONSTANT_ENCAPSED_STRING","'anotherAction'",593],"]",")",";",["T_WHITESPACE","\n        ",593],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","assertEquals",594],"(","[",["T_CONSTANT_ENCAPSED_STRING","'action_name'",594],",",["T_WHITESPACE"," ",594],["T_CONSTANT_ENCAPSED_STRING","'anotherAction'",594],"]",",",["T_WHITESPACE"," ",594],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","Controller",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","Auth",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","allowedActions",594],")",";",["T_WHITESPACE","\n    ",594],"}",["T_WHITESPACE","\n\n    ",595],["T_DOC_COMMENT","\/**\n     * testLoginRedirect method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",597],["T_WHITESPACE","\n    ",602],["T_PUBLIC","public",603],["T_WHITESPACE"," ",603],["T_FUNCTION","function",603],["T_WHITESPACE"," ",603],["T_STRING","testLoginRedirect",603],"(",")",["T_WHITESPACE","\n    ",603],"{",["T_WHITESPACE","\n        ",604],["T_VARIABLE","$url",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/camelCase'",605],";",["T_WHITESPACE","\n\n        ",605],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","Auth",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","session",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","write",607],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",607],",",["T_WHITESPACE"," ",607],"[",["T_WHITESPACE","\n            ",607],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","'1'",608],",",["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","'username'",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","'nate'",608],"]",["T_WHITESPACE","\n        ",608],"]",")",";",["T_WHITESPACE","\n\n        ",609],["T_VARIABLE","$this",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","Auth",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","request",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","addParams",611],"(",["T_STRING","Router",611],["T_DOUBLE_COLON","::",611],["T_STRING","parse",611],"(",["T_CONSTANT_ENCAPSED_STRING","'users\/login'",611],")",")",";",["T_WHITESPACE","\n        ",611],["T_VARIABLE","$this",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","Auth",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","request",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","url",612],["T_WHITESPACE"," ",612],"=",["T_WHITESPACE"," ",612],["T_CONSTANT_ENCAPSED_STRING","'users\/login'",612],";",["T_WHITESPACE","\n        ",612],["T_VARIABLE","$this",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","Auth",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","request",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","env",613],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_REFERER'",613],",",["T_WHITESPACE"," ",613],["T_STRING","false",613],")",";",["T_WHITESPACE","\n\n        ",613],["T_VARIABLE","$this",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","Auth",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","config",615],"(",["T_CONSTANT_ENCAPSED_STRING","'loginRedirect'",615],",",["T_WHITESPACE"," ",615],"[",["T_WHITESPACE","\n            ",615],["T_CONSTANT_ENCAPSED_STRING","'controller'",616],["T_WHITESPACE"," ",616],["T_DOUBLE_ARROW","=>",616],["T_WHITESPACE"," ",616],["T_CONSTANT_ENCAPSED_STRING","'pages'",616],",",["T_WHITESPACE","\n            ",616],["T_CONSTANT_ENCAPSED_STRING","'action'",617],["T_WHITESPACE"," ",617],["T_DOUBLE_ARROW","=>",617],["T_WHITESPACE"," ",617],["T_CONSTANT_ENCAPSED_STRING","'display'",617],",",["T_WHITESPACE","\n            ",617],["T_CONSTANT_ENCAPSED_STRING","'welcome'",618],["T_WHITESPACE","\n        ",618],"]",")",";",["T_WHITESPACE","\n        ",619],["T_VARIABLE","$event",620],["T_WHITESPACE"," ",620],"=",["T_WHITESPACE"," ",620],["T_NEW","new",620],["T_WHITESPACE"," ",620],["T_STRING","Event",620],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",620],",",["T_WHITESPACE"," ",620],["T_VARIABLE","$this",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","Controller",620],")",";",["T_WHITESPACE","\n        ",620],["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","Auth",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","startup",621],"(",["T_VARIABLE","$event",621],")",";",["T_WHITESPACE","\n        ",621],["T_VARIABLE","$expected",622],["T_WHITESPACE"," ",622],"=",["T_WHITESPACE"," ",622],["T_STRING","Router",622],["T_DOUBLE_COLON","::",622],["T_STRING","normalize",622],"(",["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","Auth",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","config",622],"(",["T_CONSTANT_ENCAPSED_STRING","'loginRedirect'",622],")",")",";",["T_WHITESPACE","\n        ",622],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","assertEquals",623],"(",["T_VARIABLE","$expected",623],",",["T_WHITESPACE"," ",623],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","Auth",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","redirectUrl",623],"(",")",")",";",["T_WHITESPACE","\n\n        ",623],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","Auth",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","session",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","delete",625],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",625],")",";",["T_WHITESPACE","\n\n        ",625],["T_VARIABLE","$url",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_CONSTANT_ENCAPSED_STRING","'\/posts\/view\/1'",627],";",["T_WHITESPACE","\n\n        ",627],["T_VARIABLE","$this",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","Auth",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","session",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","write",629],"(",["T_WHITESPACE","\n            ",629],["T_CONSTANT_ENCAPSED_STRING","'Auth'",630],",",["T_WHITESPACE","\n            ",630],"[",["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",631],["T_WHITESPACE"," ",631],["T_DOUBLE_ARROW","=>",631],["T_WHITESPACE"," ",631],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",631],["T_WHITESPACE"," ",631],["T_DOUBLE_ARROW","=>",631],["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'1'",631],",",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'username'",631],["T_WHITESPACE"," ",631],["T_DOUBLE_ARROW","=>",631],["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'nate'",631],"]","]",["T_WHITESPACE","\n        ",631],")",";",["T_WHITESPACE","\n        ",632],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","Controller",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","testUrl",633],["T_WHITESPACE"," ",633],"=",["T_WHITESPACE"," ",633],["T_STRING","null",633],";",["T_WHITESPACE","\n        ",633],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","Auth",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","request",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","addParams",634],"(",["T_STRING","Router",634],["T_DOUBLE_COLON","::",634],["T_STRING","parse",634],"(",["T_VARIABLE","$url",634],")",")",";",["T_WHITESPACE","\n        ",634],["T_VARIABLE","$this",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","Auth",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","request",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","env",635],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_REFERER'",635],",",["T_WHITESPACE"," ",635],["T_STRING","false",635],")",";",["T_WHITESPACE","\n\n        ",635],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","Auth",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","config",637],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",637],",",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","'controller'",637],")",";",["T_WHITESPACE","\n\n        ",637],["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","Auth",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","config",639],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",639],",",["T_WHITESPACE"," ",639],"[",["T_WHITESPACE","\n            ",639],["T_CONSTANT_ENCAPSED_STRING","'controller'",640],["T_WHITESPACE"," ",640],["T_DOUBLE_ARROW","=>",640],["T_WHITESPACE"," ",640],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",640],",",["T_WHITESPACE"," ",640],["T_CONSTANT_ENCAPSED_STRING","'action'",640],["T_WHITESPACE"," ",640],["T_DOUBLE_ARROW","=>",640],["T_WHITESPACE"," ",640],["T_CONSTANT_ENCAPSED_STRING","'login'",640],["T_WHITESPACE","\n        ",640],"]",")",";",["T_WHITESPACE","\n        ",641],["T_VARIABLE","$event",642],["T_WHITESPACE"," ",642],"=",["T_WHITESPACE"," ",642],["T_NEW","new",642],["T_WHITESPACE"," ",642],["T_STRING","Event",642],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",642],",",["T_WHITESPACE"," ",642],["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","Controller",642],")",";",["T_WHITESPACE","\n        ",642],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","Auth",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","startup",643],"(",["T_VARIABLE","$event",643],")",";",["T_WHITESPACE","\n        ",643],["T_VARIABLE","$expected",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_STRING","Router",644],["T_DOUBLE_COLON","::",644],["T_STRING","normalize",644],"(",["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/login'",644],")",";",["T_WHITESPACE","\n        ",644],["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","assertEquals",645],"(",["T_VARIABLE","$expected",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","Controller",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","testUrl",645],")",";",["T_WHITESPACE","\n\n        ",645],["T_COMMENT","\/\/ Auth.redirect gets set when accessing a protected action without being authenticated\n",647],["T_WHITESPACE","        ",648],["T_VARIABLE","$this",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","Auth",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","session",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","delete",648],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",648],")",";",["T_WHITESPACE","\n        ",648],["T_VARIABLE","$url",649],["T_WHITESPACE"," ",649],"=",["T_WHITESPACE"," ",649],["T_CONSTANT_ENCAPSED_STRING","'\/posts\/view\/1'",649],";",["T_WHITESPACE","\n        ",649],["T_VARIABLE","$this",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","Auth",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","request",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","addParams",650],"(",["T_STRING","Router",650],["T_DOUBLE_COLON","::",650],["T_STRING","parse",650],"(",["T_VARIABLE","$url",650],")",")",";",["T_WHITESPACE","\n        ",650],["T_VARIABLE","$this",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","Auth",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","request",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","url",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_VARIABLE","$this",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","Auth",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","request",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","here",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_STRING","Router",651],["T_DOUBLE_COLON","::",651],["T_STRING","normalize",651],"(",["T_VARIABLE","$url",651],")",";",["T_WHITESPACE","\n        ",651],["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","Auth",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","config",652],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",652],",",["T_WHITESPACE"," ",652],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",652],["T_WHITESPACE"," ",652],["T_DOUBLE_ARROW","=>",652],["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",652],",",["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","'action'",652],["T_WHITESPACE"," ",652],["T_DOUBLE_ARROW","=>",652],["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","'login'",652],"]",")",";",["T_WHITESPACE","\n        ",652],["T_VARIABLE","$event",653],["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_NEW","new",653],["T_WHITESPACE"," ",653],["T_STRING","Event",653],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",653],",",["T_WHITESPACE"," ",653],["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","Controller",653],")",";",["T_WHITESPACE","\n        ",653],["T_VARIABLE","$this",654],["T_OBJECT_OPERATOR","->",654],["T_STRING","Auth",654],["T_OBJECT_OPERATOR","->",654],["T_STRING","startup",654],"(",["T_VARIABLE","$event",654],")",";",["T_WHITESPACE","\n        ",654],["T_VARIABLE","$expected",655],["T_WHITESPACE"," ",655],"=",["T_WHITESPACE"," ",655],["T_STRING","Router",655],["T_DOUBLE_COLON","::",655],["T_STRING","normalize",655],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/view\/1'",655],")",";",["T_WHITESPACE","\n        ",655],["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","assertEquals",656],"(",["T_VARIABLE","$expected",656],",",["T_WHITESPACE"," ",656],["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","Auth",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","session",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","read",656],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",656],")",")",";",["T_WHITESPACE","\n\n        ",656],["T_COMMENT","\/\/ QueryString parameters are preserved when setting Auth.redirect\n",658],["T_WHITESPACE","        ",659],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","Auth",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","session",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","delete",659],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",659],")",";",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$url",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","'\/posts\/view\/29'",660],";",["T_WHITESPACE","\n        ",660],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","Auth",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","request",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","addParams",661],"(",["T_STRING","Router",661],["T_DOUBLE_COLON","::",661],["T_STRING","parse",661],"(",["T_VARIABLE","$url",661],")",")",";",["T_WHITESPACE","\n        ",661],["T_VARIABLE","$this",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","Auth",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","request",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","url",662],["T_WHITESPACE"," ",662],"=",["T_WHITESPACE"," ",662],["T_VARIABLE","$this",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","Auth",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","request",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","here",662],["T_WHITESPACE"," ",662],"=",["T_WHITESPACE"," ",662],["T_STRING","Router",662],["T_DOUBLE_COLON","::",662],["T_STRING","normalize",662],"(",["T_VARIABLE","$url",662],")",";",["T_WHITESPACE","\n        ",662],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","Auth",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","request",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","query",663],["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],"[",["T_WHITESPACE","\n            ",663],["T_CONSTANT_ENCAPSED_STRING","'print'",664],["T_WHITESPACE"," ",664],["T_DOUBLE_ARROW","=>",664],["T_WHITESPACE"," ",664],["T_CONSTANT_ENCAPSED_STRING","'true'",664],",",["T_WHITESPACE","\n            ",664],["T_CONSTANT_ENCAPSED_STRING","'refer'",665],["T_WHITESPACE"," ",665],["T_DOUBLE_ARROW","=>",665],["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","'menu'",665],["T_WHITESPACE","\n        ",665],"]",";",["T_WHITESPACE","\n\n        ",666],["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","Auth",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","config",668],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",668],",",["T_WHITESPACE"," ",668],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",668],["T_WHITESPACE"," ",668],["T_DOUBLE_ARROW","=>",668],["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",668],",",["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'action'",668],["T_WHITESPACE"," ",668],["T_DOUBLE_ARROW","=>",668],["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'login'",668],"]",")",";",["T_WHITESPACE","\n        ",668],["T_VARIABLE","$event",669],["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_NEW","new",669],["T_WHITESPACE"," ",669],["T_STRING","Event",669],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",669],",",["T_WHITESPACE"," ",669],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","Controller",669],")",";",["T_WHITESPACE","\n        ",669],["T_VARIABLE","$this",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","Auth",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","startup",670],"(",["T_VARIABLE","$event",670],")",";",["T_WHITESPACE","\n        ",670],["T_VARIABLE","$expected",671],["T_WHITESPACE"," ",671],"=",["T_WHITESPACE"," ",671],["T_STRING","Router",671],["T_DOUBLE_COLON","::",671],["T_STRING","normalize",671],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/view\/29?print=true&refer=menu'",671],")",";",["T_WHITESPACE","\n        ",671],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","assertEquals",672],"(",["T_VARIABLE","$expected",672],",",["T_WHITESPACE"," ",672],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","Auth",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","session",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","read",672],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",672],")",")",";",["T_WHITESPACE","\n\n        ",672],["T_COMMENT","\/\/ Different base urls.\n",674],["T_WHITESPACE","        ",675],["T_VARIABLE","$appConfig",675],["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_STRING","Configure",675],["T_DOUBLE_COLON","::",675],["T_STRING","read",675],"(",["T_CONSTANT_ENCAPSED_STRING","'App'",675],")",";",["T_WHITESPACE","\n\n        ",675],["T_STRING","Configure",677],["T_DOUBLE_COLON","::",677],["T_STRING","write",677],"(",["T_CONSTANT_ENCAPSED_STRING","'App'",677],",",["T_WHITESPACE"," ",677],"[",["T_WHITESPACE","\n            ",677],["T_CONSTANT_ENCAPSED_STRING","'dir'",678],["T_WHITESPACE"," ",678],["T_DOUBLE_ARROW","=>",678],["T_WHITESPACE"," ",678],["T_STRING","APP_DIR",678],",",["T_WHITESPACE","\n            ",678],["T_CONSTANT_ENCAPSED_STRING","'webroot'",679],["T_WHITESPACE"," ",679],["T_DOUBLE_ARROW","=>",679],["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'webroot'",679],",",["T_WHITESPACE","\n            ",679],["T_CONSTANT_ENCAPSED_STRING","'base'",680],["T_WHITESPACE"," ",680],["T_DOUBLE_ARROW","=>",680],["T_WHITESPACE"," ",680],["T_STRING","false",680],",",["T_WHITESPACE","\n            ",680],["T_CONSTANT_ENCAPSED_STRING","'baseUrl'",681],["T_WHITESPACE"," ",681],["T_DOUBLE_ARROW","=>",681],["T_WHITESPACE"," ",681],["T_CONSTANT_ENCAPSED_STRING","'\/cake\/index.php'",681],["T_WHITESPACE","\n        ",681],"]",")",";",["T_WHITESPACE","\n\n        ",682],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","Auth",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","session",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","delete",684],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",684],")",";",["T_WHITESPACE","\n\n        ",684],["T_VARIABLE","$url",686],["T_WHITESPACE"," ",686],"=",["T_WHITESPACE"," ",686],["T_CONSTANT_ENCAPSED_STRING","'\/posts\/add'",686],";",["T_WHITESPACE","\n        ",686],["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","Auth",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","request",687],["T_WHITESPACE"," ",687],"=",["T_WHITESPACE"," ",687],["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","Controller",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","request",687],["T_WHITESPACE"," ",687],"=",["T_WHITESPACE"," ",687],["T_NEW","new",687],["T_WHITESPACE"," ",687],["T_STRING","Request",687],"(",["T_VARIABLE","$url",687],")",";",["T_WHITESPACE","\n        ",687],["T_VARIABLE","$this",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","Auth",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","request",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","addParams",688],"(",["T_STRING","Router",688],["T_DOUBLE_COLON","::",688],["T_STRING","parse",688],"(",["T_VARIABLE","$url",688],")",")",";",["T_WHITESPACE","\n        ",688],["T_VARIABLE","$this",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","Auth",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","request",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","url",689],["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_STRING","Router",689],["T_DOUBLE_COLON","::",689],["T_STRING","normalize",689],"(",["T_VARIABLE","$url",689],")",";",["T_WHITESPACE","\n\n        ",689],["T_VARIABLE","$this",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","Auth",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","config",691],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",691],",",["T_WHITESPACE"," ",691],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_CONSTANT_ENCAPSED_STRING","'users'",691],",",["T_WHITESPACE"," ",691],["T_CONSTANT_ENCAPSED_STRING","'action'",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_CONSTANT_ENCAPSED_STRING","'login'",691],"]",")",";",["T_WHITESPACE","\n        ",691],["T_VARIABLE","$event",692],["T_WHITESPACE"," ",692],"=",["T_WHITESPACE"," ",692],["T_NEW","new",692],["T_WHITESPACE"," ",692],["T_STRING","Event",692],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",692],",",["T_WHITESPACE"," ",692],["T_VARIABLE","$this",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","Controller",692],")",";",["T_WHITESPACE","\n        ",692],["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","Auth",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","startup",693],"(",["T_VARIABLE","$event",693],")",";",["T_WHITESPACE","\n        ",693],["T_VARIABLE","$expected",694],["T_WHITESPACE"," ",694],"=",["T_WHITESPACE"," ",694],["T_STRING","Router",694],["T_DOUBLE_COLON","::",694],["T_STRING","normalize",694],"(",["T_CONSTANT_ENCAPSED_STRING","'\/posts\/add'",694],")",";",["T_WHITESPACE","\n        ",694],["T_VARIABLE","$this",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","assertEquals",695],"(",["T_VARIABLE","$expected",695],",",["T_WHITESPACE"," ",695],["T_VARIABLE","$this",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","Auth",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","session",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","read",695],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",695],")",")",";",["T_WHITESPACE","\n\n        ",695],["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","Auth",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","session",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","delete",697],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",697],")",";",["T_WHITESPACE","\n        ",697],["T_STRING","Configure",698],["T_DOUBLE_COLON","::",698],["T_STRING","write",698],"(",["T_CONSTANT_ENCAPSED_STRING","'App'",698],",",["T_WHITESPACE"," ",698],["T_VARIABLE","$appConfig",698],")",";",["T_WHITESPACE","\n\n        ",698],["T_COMMENT","\/\/ External Authed Action\n",700],["T_WHITESPACE","        ",701],["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","Auth",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","session",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","delete",701],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",701],")",";",["T_WHITESPACE","\n        ",701],["T_VARIABLE","$url",702],["T_WHITESPACE"," ",702],"=",["T_WHITESPACE"," ",702],["T_CONSTANT_ENCAPSED_STRING","'\/posts\/view\/1'",702],";",["T_WHITESPACE","\n        ",702],["T_VARIABLE","$request",703],["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_NEW","new",703],["T_WHITESPACE"," ",703],["T_STRING","Request",703],"(",["T_VARIABLE","$url",703],")",";",["T_WHITESPACE","\n        ",703],["T_VARIABLE","$request",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","env",704],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_REFERER'",704],",",["T_WHITESPACE"," ",704],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/webmail.example.com\/view\/message'",704],")",";",["T_WHITESPACE","\n        ",704],["T_VARIABLE","$request",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","query",705],["T_WHITESPACE"," ",705],"=",["T_WHITESPACE"," ",705],"[","]",";",["T_WHITESPACE","\n        ",705],["T_VARIABLE","$this",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","Auth",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","request",706],["T_WHITESPACE"," ",706],"=",["T_WHITESPACE"," ",706],["T_VARIABLE","$this",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","Controller",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","request",706],["T_WHITESPACE"," ",706],"=",["T_WHITESPACE"," ",706],["T_VARIABLE","$request",706],";",["T_WHITESPACE","\n        ",706],["T_VARIABLE","$this",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","Auth",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","request",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","addParams",707],"(",["T_STRING","Router",707],["T_DOUBLE_COLON","::",707],["T_STRING","parse",707],"(",["T_VARIABLE","$url",707],")",")",";",["T_WHITESPACE","\n        ",707],["T_VARIABLE","$this",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","Auth",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","request",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","url",708],["T_WHITESPACE"," ",708],"=",["T_WHITESPACE"," ",708],["T_VARIABLE","$this",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","Auth",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","request",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","here",708],["T_WHITESPACE"," ",708],"=",["T_WHITESPACE"," ",708],["T_STRING","Router",708],["T_DOUBLE_COLON","::",708],["T_STRING","normalize",708],"(",["T_VARIABLE","$url",708],")",";",["T_WHITESPACE","\n        ",708],["T_VARIABLE","$this",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","Auth",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","config",709],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",709],",",["T_WHITESPACE"," ",709],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",709],["T_WHITESPACE"," ",709],["T_DOUBLE_ARROW","=>",709],["T_WHITESPACE"," ",709],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",709],",",["T_WHITESPACE"," ",709],["T_CONSTANT_ENCAPSED_STRING","'action'",709],["T_WHITESPACE"," ",709],["T_DOUBLE_ARROW","=>",709],["T_WHITESPACE"," ",709],["T_CONSTANT_ENCAPSED_STRING","'login'",709],"]",")",";",["T_WHITESPACE","\n        ",709],["T_VARIABLE","$event",710],["T_WHITESPACE"," ",710],"=",["T_WHITESPACE"," ",710],["T_NEW","new",710],["T_WHITESPACE"," ",710],["T_STRING","Event",710],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",710],",",["T_WHITESPACE"," ",710],["T_VARIABLE","$this",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","Controller",710],")",";",["T_WHITESPACE","\n        ",710],["T_VARIABLE","$this",711],["T_OBJECT_OPERATOR","->",711],["T_STRING","Auth",711],["T_OBJECT_OPERATOR","->",711],["T_STRING","startup",711],"(",["T_VARIABLE","$event",711],")",";",["T_WHITESPACE","\n        ",711],["T_VARIABLE","$expected",712],["T_WHITESPACE"," ",712],"=",["T_WHITESPACE"," ",712],["T_STRING","Router",712],["T_DOUBLE_COLON","::",712],["T_STRING","normalize",712],"(",["T_CONSTANT_ENCAPSED_STRING","'\/posts\/view\/1'",712],")",";",["T_WHITESPACE","\n        ",712],["T_VARIABLE","$this",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","assertEquals",713],"(",["T_VARIABLE","$expected",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$this",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","Auth",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","session",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","read",713],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",713],")",")",";",["T_WHITESPACE","\n\n        ",713],["T_VARIABLE","$this",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","Auth",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","session",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","delete",715],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",715],")",";",["T_WHITESPACE","\n    ",715],"}",["T_WHITESPACE","\n\n    ",716],["T_DOC_COMMENT","\/**\n     * testNoLoginRedirectForAuthenticatedUser method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",718],["T_WHITESPACE","\n    ",723],["T_PUBLIC","public",724],["T_WHITESPACE"," ",724],["T_FUNCTION","function",724],["T_WHITESPACE"," ",724],["T_STRING","testNoLoginRedirectForAuthenticatedUser",724],"(",")",["T_WHITESPACE","\n    ",724],"{",["T_WHITESPACE","\n        ",725],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","Controller",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","request",726],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",726],"]",["T_WHITESPACE"," ",726],"=",["T_WHITESPACE"," ",726],["T_CONSTANT_ENCAPSED_STRING","'auth_test'",726],";",["T_WHITESPACE","\n        ",726],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","Controller",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","request",727],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",727],"]",["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_CONSTANT_ENCAPSED_STRING","'login'",727],";",["T_WHITESPACE","\n        ",727],["T_VARIABLE","$this",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","Controller",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","here",728],["T_WHITESPACE"," ",728],"=",["T_WHITESPACE"," ",728],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/login'",728],";",["T_WHITESPACE","\n        ",728],["T_VARIABLE","$this",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","Auth",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","request",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","url",729],["T_WHITESPACE"," ",729],"=",["T_WHITESPACE"," ",729],["T_CONSTANT_ENCAPSED_STRING","'auth_test\/login'",729],";",["T_WHITESPACE","\n\n        ",729],["T_VARIABLE","$this",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","Auth",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","session",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","write",731],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.User.id'",731],",",["T_WHITESPACE"," ",731],["T_CONSTANT_ENCAPSED_STRING","'1'",731],")",";",["T_WHITESPACE","\n        ",731],["T_VARIABLE","$this",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","Auth",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","config",732],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",732],",",["T_WHITESPACE"," ",732],"[",["T_CONSTANT_ENCAPSED_STRING","'Form'",732],"]",")",";",["T_WHITESPACE","\n        ",732],["T_VARIABLE","$this",733],["T_OBJECT_OPERATOR","->",733],["T_STRING","getMockBuilder",733],"(",["T_STRING","BaseAuthorize",733],["T_DOUBLE_COLON","::",733],["T_CLASS","class",733],")",["T_WHITESPACE","\n            ",733],["T_OBJECT_OPERATOR","->",734],["T_STRING","setMethods",734],"(","[",["T_CONSTANT_ENCAPSED_STRING","'authorize'",734],"]",")",["T_WHITESPACE","\n            ",734],["T_OBJECT_OPERATOR","->",735],["T_STRING","disableOriginalConstructor",735],"(",")",["T_WHITESPACE","\n            ",735],["T_OBJECT_OPERATOR","->",736],["T_STRING","setMockClassName",736],"(",["T_CONSTANT_ENCAPSED_STRING","'NoLoginRedirectMockAuthorize'",736],")",["T_WHITESPACE","\n            ",736],["T_OBJECT_OPERATOR","->",737],["T_STRING","getMock",737],"(",")",";",["T_WHITESPACE","\n        ",737],["T_VARIABLE","$this",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","Auth",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","config",738],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",738],",",["T_WHITESPACE"," ",738],"[",["T_CONSTANT_ENCAPSED_STRING","'NoLoginRedirectMockAuthorize'",738],"]",")",";",["T_WHITESPACE","\n        ",738],["T_VARIABLE","$this",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","Auth",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","config",739],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",739],",",["T_WHITESPACE"," ",739],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",739],["T_WHITESPACE"," ",739],["T_DOUBLE_ARROW","=>",739],["T_WHITESPACE"," ",739],["T_CONSTANT_ENCAPSED_STRING","'auth_test'",739],",",["T_WHITESPACE"," ",739],["T_CONSTANT_ENCAPSED_STRING","'action'",739],["T_WHITESPACE"," ",739],["T_DOUBLE_ARROW","=>",739],["T_WHITESPACE"," ",739],["T_CONSTANT_ENCAPSED_STRING","'login'",739],"]",")",";",["T_WHITESPACE","\n\n        ",739],["T_VARIABLE","$event",741],["T_WHITESPACE"," ",741],"=",["T_WHITESPACE"," ",741],["T_NEW","new",741],["T_WHITESPACE"," ",741],["T_STRING","Event",741],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",741],",",["T_WHITESPACE"," ",741],["T_VARIABLE","$this",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","Controller",741],")",";",["T_WHITESPACE","\n        ",741],["T_VARIABLE","$return",742],["T_WHITESPACE"," ",742],"=",["T_WHITESPACE"," ",742],["T_VARIABLE","$this",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","Auth",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","startup",742],"(",["T_VARIABLE","$event",742],")",";",["T_WHITESPACE","\n        ",742],["T_VARIABLE","$this",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","assertNull",743],"(",["T_VARIABLE","$return",743],")",";",["T_WHITESPACE","\n        ",743],["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","assertNull",744],"(",["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","Controller",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","testUrl",744],")",";",["T_WHITESPACE","\n    ",744],"}",["T_WHITESPACE","\n\n    ",745],["T_DOC_COMMENT","\/**\n     * Default to loginRedirect, if set, on authError.\n     *\n     * @return void\n     * @triggers Controller.startup $Controller\n     *\/",747],["T_WHITESPACE","\n    ",752],["T_PUBLIC","public",753],["T_WHITESPACE"," ",753],["T_FUNCTION","function",753],["T_WHITESPACE"," ",753],["T_STRING","testDefaultToLoginRedirect",753],"(",")",["T_WHITESPACE","\n    ",753],"{",["T_WHITESPACE","\n        ",754],["T_VARIABLE","$url",755],["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_CONSTANT_ENCAPSED_STRING","'\/party\/on'",755],";",["T_WHITESPACE","\n        ",755],["T_VARIABLE","$this",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","Auth",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","request",756],["T_WHITESPACE"," ",756],"=",["T_WHITESPACE"," ",756],["T_VARIABLE","$request",756],["T_WHITESPACE"," ",756],"=",["T_WHITESPACE"," ",756],["T_NEW","new",756],["T_WHITESPACE"," ",756],["T_STRING","Request",756],"(",["T_VARIABLE","$url",756],")",";",["T_WHITESPACE","\n        ",756],["T_VARIABLE","$request",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","env",757],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_REFERER'",757],",",["T_WHITESPACE"," ",757],["T_STRING","false",757],")",";",["T_WHITESPACE","\n        ",757],["T_VARIABLE","$request",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","addParams",758],"(",["T_STRING","Router",758],["T_DOUBLE_COLON","::",758],["T_STRING","parse",758],"(",["T_VARIABLE","$url",758],")",")",";",["T_WHITESPACE","\n        ",758],["T_VARIABLE","$request",759],["T_OBJECT_OPERATOR","->",759],["T_STRING","addPaths",759],"(","[",["T_WHITESPACE","\n            ",759],["T_CONSTANT_ENCAPSED_STRING","'base'",760],["T_WHITESPACE"," ",760],["T_DOUBLE_ARROW","=>",760],["T_WHITESPACE"," ",760],["T_CONSTANT_ENCAPSED_STRING","'dirname'",760],",",["T_WHITESPACE","\n            ",760],["T_CONSTANT_ENCAPSED_STRING","'webroot'",761],["T_WHITESPACE"," ",761],["T_DOUBLE_ARROW","=>",761],["T_WHITESPACE"," ",761],["T_CONSTANT_ENCAPSED_STRING","'\/dirname\/'",761],",",["T_WHITESPACE","\n        ",761],"]",")",";",["T_WHITESPACE","\n        ",762],["T_STRING","Router",763],["T_DOUBLE_COLON","::",763],["T_STRING","pushRequest",763],"(",["T_VARIABLE","$request",763],")",";",["T_WHITESPACE","\n\n        ",763],["T_VARIABLE","$this",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","Auth",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","config",765],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",765],",",["T_WHITESPACE"," ",765],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",765],"]",")",";",["T_WHITESPACE","\n        ",765],["T_VARIABLE","$this",766],["T_OBJECT_OPERATOR","->",766],["T_STRING","Auth",766],["T_OBJECT_OPERATOR","->",766],["T_STRING","setUser",766],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",766],["T_WHITESPACE"," ",766],["T_DOUBLE_ARROW","=>",766],["T_WHITESPACE"," ",766],["T_CONSTANT_ENCAPSED_STRING","'mariano'",766],",",["T_WHITESPACE"," ",766],["T_CONSTANT_ENCAPSED_STRING","'password'",766],["T_WHITESPACE"," ",766],["T_DOUBLE_ARROW","=>",766],["T_WHITESPACE"," ",766],["T_CONSTANT_ENCAPSED_STRING","'cake'",766],"]",")",";",["T_WHITESPACE","\n        ",766],["T_VARIABLE","$this",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","Auth",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","config",767],"(",["T_CONSTANT_ENCAPSED_STRING","'loginRedirect'",767],",",["T_WHITESPACE"," ",767],"[",["T_WHITESPACE","\n            ",767],["T_CONSTANT_ENCAPSED_STRING","'controller'",768],["T_WHITESPACE"," ",768],["T_DOUBLE_ARROW","=>",768],["T_WHITESPACE"," ",768],["T_CONSTANT_ENCAPSED_STRING","'something'",768],",",["T_WHITESPACE","\n            ",768],["T_CONSTANT_ENCAPSED_STRING","'action'",769],["T_WHITESPACE"," ",769],["T_DOUBLE_ARROW","=>",769],["T_WHITESPACE"," ",769],["T_CONSTANT_ENCAPSED_STRING","'else'",769],["T_WHITESPACE","\n        ",769],"]",")",";",["T_WHITESPACE","\n\n        ",770],["T_VARIABLE","$response",772],["T_WHITESPACE"," ",772],"=",["T_WHITESPACE"," ",772],["T_NEW","new",772],["T_WHITESPACE"," ",772],["T_STRING","Response",772],"(",")",";",["T_WHITESPACE","\n        ",772],["T_VARIABLE","$Controller",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","getMockBuilder",773],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",773],")",["T_WHITESPACE","\n            ",773],["T_OBJECT_OPERATOR","->",774],["T_STRING","setMethods",774],"(","[",["T_CONSTANT_ENCAPSED_STRING","'on'",774],",",["T_WHITESPACE"," ",774],["T_CONSTANT_ENCAPSED_STRING","'redirect'",774],"]",")",["T_WHITESPACE","\n            ",774],["T_OBJECT_OPERATOR","->",775],["T_STRING","setConstructorArgs",775],"(","[",["T_VARIABLE","$request",775],",",["T_WHITESPACE"," ",775],["T_VARIABLE","$response",775],"]",")",["T_WHITESPACE","\n            ",775],["T_OBJECT_OPERATOR","->",776],["T_STRING","getMock",776],"(",")",";",["T_WHITESPACE","\n        ",776],["T_VARIABLE","$event",777],["T_WHITESPACE"," ",777],"=",["T_WHITESPACE"," ",777],["T_NEW","new",777],["T_WHITESPACE"," ",777],["T_STRING","Event",777],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",777],",",["T_WHITESPACE"," ",777],["T_VARIABLE","$Controller",777],")",";",["T_WHITESPACE","\n\n        ",777],["T_COMMENT","\/\/ Should not contain basedir when redirect is called.\n",779],["T_WHITESPACE","        ",780],["T_VARIABLE","$expected",780],["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_CONSTANT_ENCAPSED_STRING","'\/something\/else'",780],";",["T_WHITESPACE","\n        ",780],["T_VARIABLE","$Controller",781],["T_OBJECT_OPERATOR","->",781],["T_STRING","expects",781],"(",["T_VARIABLE","$this",781],["T_OBJECT_OPERATOR","->",781],["T_STRING","once",781],"(",")",")",["T_WHITESPACE","\n            ",781],["T_OBJECT_OPERATOR","->",782],["T_STRING","method",782],"(",["T_CONSTANT_ENCAPSED_STRING","'redirect'",782],")",["T_WHITESPACE","\n            ",782],["T_OBJECT_OPERATOR","->",783],["T_STRING","with",783],"(",["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","equalTo",783],"(",["T_VARIABLE","$expected",783],")",")",";",["T_WHITESPACE","\n        ",783],["T_VARIABLE","$this",784],["T_OBJECT_OPERATOR","->",784],["T_STRING","Auth",784],["T_OBJECT_OPERATOR","->",784],["T_STRING","startup",784],"(",["T_VARIABLE","$event",784],")",";",["T_WHITESPACE","\n    ",784],"}",["T_WHITESPACE","\n\n    ",785],["T_DOC_COMMENT","\/**\n     * testRedirectToUnauthorizedRedirect\n     *\n     * @return void\n     * @triggers Controller.startup $Controller\n     *\/",787],["T_WHITESPACE","\n    ",792],["T_PUBLIC","public",793],["T_WHITESPACE"," ",793],["T_FUNCTION","function",793],["T_WHITESPACE"," ",793],["T_STRING","testRedirectToUnauthorizedRedirect",793],"(",")",["T_WHITESPACE","\n    ",793],"{",["T_WHITESPACE","\n        ",794],["T_VARIABLE","$url",795],["T_WHITESPACE"," ",795],"=",["T_WHITESPACE"," ",795],["T_CONSTANT_ENCAPSED_STRING","'\/party\/on'",795],";",["T_WHITESPACE","\n        ",795],["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","Auth",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","Flash",796],["T_WHITESPACE"," ",796],"=",["T_WHITESPACE"," ",796],["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","getMockBuilder",796],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Component\\FlashComponent'",796],")",["T_WHITESPACE","\n            ",796],["T_OBJECT_OPERATOR","->",797],["T_STRING","setMethods",797],"(","[",["T_CONSTANT_ENCAPSED_STRING","'set'",797],"]",")",["T_WHITESPACE","\n            ",797],["T_OBJECT_OPERATOR","->",798],["T_STRING","setConstructorArgs",798],"(","[",["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","Controller",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","components",798],"(",")","]",")",["T_WHITESPACE","\n            ",798],["T_OBJECT_OPERATOR","->",799],["T_STRING","getMock",799],"(",")",";",["T_WHITESPACE","\n        ",799],["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","Auth",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","request",800],["T_WHITESPACE"," ",800],"=",["T_WHITESPACE"," ",800],["T_VARIABLE","$request",800],["T_WHITESPACE"," ",800],"=",["T_WHITESPACE"," ",800],["T_NEW","new",800],["T_WHITESPACE"," ",800],["T_STRING","Request",800],"(","[",["T_WHITESPACE","\n            ",800],["T_CONSTANT_ENCAPSED_STRING","'url'",801],["T_WHITESPACE"," ",801],["T_DOUBLE_ARROW","=>",801],["T_WHITESPACE"," ",801],["T_VARIABLE","$url",801],",",["T_WHITESPACE","\n            ",801],["T_CONSTANT_ENCAPSED_STRING","'session'",802],["T_WHITESPACE"," ",802],["T_DOUBLE_ARROW","=>",802],["T_WHITESPACE"," ",802],["T_VARIABLE","$this",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","Auth",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","session",802],["T_WHITESPACE","\n        ",802],"]",")",";",["T_WHITESPACE","\n        ",803],["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","Auth",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","request",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","addParams",804],"(",["T_STRING","Router",804],["T_DOUBLE_COLON","::",804],["T_STRING","parse",804],"(",["T_VARIABLE","$url",804],")",")",";",["T_WHITESPACE","\n        ",804],["T_VARIABLE","$this",805],["T_OBJECT_OPERATOR","->",805],["T_STRING","Auth",805],["T_OBJECT_OPERATOR","->",805],["T_STRING","config",805],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",805],",",["T_WHITESPACE"," ",805],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",805],"]",")",";",["T_WHITESPACE","\n        ",805],["T_VARIABLE","$this",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","Auth",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","setUser",806],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",806],["T_WHITESPACE"," ",806],["T_DOUBLE_ARROW","=>",806],["T_WHITESPACE"," ",806],["T_CONSTANT_ENCAPSED_STRING","'admad'",806],",",["T_WHITESPACE"," ",806],["T_CONSTANT_ENCAPSED_STRING","'password'",806],["T_WHITESPACE"," ",806],["T_DOUBLE_ARROW","=>",806],["T_WHITESPACE"," ",806],["T_CONSTANT_ENCAPSED_STRING","'cake'",806],"]",")",";",["T_WHITESPACE","\n\n        ",806],["T_VARIABLE","$expected",808],["T_WHITESPACE"," ",808],"=",["T_WHITESPACE"," ",808],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",808],["T_WHITESPACE"," ",808],["T_DOUBLE_ARROW","=>",808],["T_WHITESPACE"," ",808],["T_CONSTANT_ENCAPSED_STRING","'no_can_do'",808],",",["T_WHITESPACE"," ",808],["T_CONSTANT_ENCAPSED_STRING","'action'",808],["T_WHITESPACE"," ",808],["T_DOUBLE_ARROW","=>",808],["T_WHITESPACE"," ",808],["T_CONSTANT_ENCAPSED_STRING","'jack'",808],"]",";",["T_WHITESPACE","\n        ",808],["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","Auth",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","config",809],"(",["T_CONSTANT_ENCAPSED_STRING","'unauthorizedRedirect'",809],",",["T_WHITESPACE"," ",809],["T_VARIABLE","$expected",809],")",";",["T_WHITESPACE","\n\n        ",809],["T_VARIABLE","$response",811],["T_WHITESPACE"," ",811],"=",["T_WHITESPACE"," ",811],["T_NEW","new",811],["T_WHITESPACE"," ",811],["T_STRING","Response",811],"(",")",";",["T_WHITESPACE","\n        ",811],["T_VARIABLE","$Controller",812],["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","getMockBuilder",812],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",812],")",["T_WHITESPACE","\n            ",812],["T_OBJECT_OPERATOR","->",813],["T_STRING","setMethods",813],"(","[",["T_CONSTANT_ENCAPSED_STRING","'on'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'redirect'",813],"]",")",["T_WHITESPACE","\n            ",813],["T_OBJECT_OPERATOR","->",814],["T_STRING","setConstructorArgs",814],"(","[",["T_VARIABLE","$request",814],",",["T_WHITESPACE"," ",814],["T_VARIABLE","$response",814],"]",")",["T_WHITESPACE","\n            ",814],["T_OBJECT_OPERATOR","->",815],["T_STRING","getMock",815],"(",")",";",["T_WHITESPACE","\n\n        ",815],["T_VARIABLE","$Controller",817],["T_OBJECT_OPERATOR","->",817],["T_STRING","expects",817],"(",["T_VARIABLE","$this",817],["T_OBJECT_OPERATOR","->",817],["T_STRING","once",817],"(",")",")",["T_WHITESPACE","\n            ",817],["T_OBJECT_OPERATOR","->",818],["T_STRING","method",818],"(",["T_CONSTANT_ENCAPSED_STRING","'redirect'",818],")",["T_WHITESPACE","\n            ",818],["T_OBJECT_OPERATOR","->",819],["T_STRING","with",819],"(",["T_VARIABLE","$this",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","equalTo",819],"(",["T_VARIABLE","$expected",819],")",")",";",["T_WHITESPACE","\n\n        ",819],["T_VARIABLE","$this",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","Auth",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","Flash",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","expects",821],"(",["T_VARIABLE","$this",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","once",821],"(",")",")",["T_WHITESPACE","\n            ",821],["T_OBJECT_OPERATOR","->",822],["T_STRING","method",822],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",822],")",";",["T_WHITESPACE","\n\n        ",822],["T_VARIABLE","$event",824],["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_NEW","new",824],["T_WHITESPACE"," ",824],["T_STRING","Event",824],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",824],",",["T_WHITESPACE"," ",824],["T_VARIABLE","$Controller",824],")",";",["T_WHITESPACE","\n        ",824],["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","Auth",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","startup",825],"(",["T_VARIABLE","$event",825],")",";",["T_WHITESPACE","\n    ",825],"}",["T_WHITESPACE","\n\n    ",826],["T_DOC_COMMENT","\/**\n     * test unauthorized redirect defaults to loginRedirect\n     * which is a string URL.\n     *\n     * @return void\n     *\/",828],["T_WHITESPACE","\n    ",833],["T_PUBLIC","public",834],["T_WHITESPACE"," ",834],["T_FUNCTION","function",834],["T_WHITESPACE"," ",834],["T_STRING","testRedirectToUnauthorizedRedirectLoginAction",834],"(",")",["T_WHITESPACE","\n    ",834],"{",["T_WHITESPACE","\n        ",835],["T_VARIABLE","$url",836],["T_WHITESPACE"," ",836],"=",["T_WHITESPACE"," ",836],["T_CONSTANT_ENCAPSED_STRING","'\/party\/on'",836],";",["T_WHITESPACE","\n        ",836],["T_VARIABLE","$this",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","Auth",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","Flash",837],["T_WHITESPACE"," ",837],"=",["T_WHITESPACE"," ",837],["T_VARIABLE","$this",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","getMockBuilder",837],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Component\\FlashComponent'",837],")",["T_WHITESPACE","\n            ",837],["T_OBJECT_OPERATOR","->",838],["T_STRING","setMethods",838],"(","[",["T_CONSTANT_ENCAPSED_STRING","'set'",838],"]",")",["T_WHITESPACE","\n            ",838],["T_OBJECT_OPERATOR","->",839],["T_STRING","setConstructorArgs",839],"(","[",["T_VARIABLE","$this",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","Controller",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","components",839],"(",")","]",")",["T_WHITESPACE","\n            ",839],["T_OBJECT_OPERATOR","->",840],["T_STRING","getMock",840],"(",")",";",["T_WHITESPACE","\n        ",840],["T_VARIABLE","$this",841],["T_OBJECT_OPERATOR","->",841],["T_STRING","Auth",841],["T_OBJECT_OPERATOR","->",841],["T_STRING","request",841],["T_WHITESPACE"," ",841],"=",["T_WHITESPACE"," ",841],["T_VARIABLE","$request",841],["T_WHITESPACE"," ",841],"=",["T_WHITESPACE"," ",841],["T_NEW","new",841],["T_WHITESPACE"," ",841],["T_STRING","Request",841],"(","[",["T_WHITESPACE","\n            ",841],["T_CONSTANT_ENCAPSED_STRING","'url'",842],["T_WHITESPACE"," ",842],["T_DOUBLE_ARROW","=>",842],["T_WHITESPACE"," ",842],["T_VARIABLE","$url",842],",",["T_WHITESPACE","\n            ",842],["T_CONSTANT_ENCAPSED_STRING","'session'",843],["T_WHITESPACE"," ",843],["T_DOUBLE_ARROW","=>",843],["T_WHITESPACE"," ",843],["T_VARIABLE","$this",843],["T_OBJECT_OPERATOR","->",843],["T_STRING","Auth",843],["T_OBJECT_OPERATOR","->",843],["T_STRING","session",843],["T_WHITESPACE","\n        ",843],"]",")",";",["T_WHITESPACE","\n        ",844],["T_VARIABLE","$this",845],["T_OBJECT_OPERATOR","->",845],["T_STRING","Auth",845],["T_OBJECT_OPERATOR","->",845],["T_STRING","request",845],["T_OBJECT_OPERATOR","->",845],["T_STRING","addParams",845],"(",["T_STRING","Router",845],["T_DOUBLE_COLON","::",845],["T_STRING","parse",845],"(",["T_VARIABLE","$url",845],")",")",";",["T_WHITESPACE","\n        ",845],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","Auth",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","config",846],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",846],",",["T_WHITESPACE"," ",846],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",846],"]",")",";",["T_WHITESPACE","\n        ",846],["T_VARIABLE","$this",847],["T_OBJECT_OPERATOR","->",847],["T_STRING","Auth",847],["T_OBJECT_OPERATOR","->",847],["T_STRING","setUser",847],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",847],["T_WHITESPACE"," ",847],["T_DOUBLE_ARROW","=>",847],["T_WHITESPACE"," ",847],["T_CONSTANT_ENCAPSED_STRING","'admad'",847],",",["T_WHITESPACE"," ",847],["T_CONSTANT_ENCAPSED_STRING","'password'",847],["T_WHITESPACE"," ",847],["T_DOUBLE_ARROW","=>",847],["T_WHITESPACE"," ",847],["T_CONSTANT_ENCAPSED_STRING","'cake'",847],"]",")",";",["T_WHITESPACE","\n\n        ",847],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","Auth",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","config",849],"(",["T_CONSTANT_ENCAPSED_STRING","'unauthorizedRedirect'",849],",",["T_WHITESPACE"," ",849],["T_STRING","true",849],")",";",["T_WHITESPACE","\n        ",849],["T_VARIABLE","$this",850],["T_OBJECT_OPERATOR","->",850],["T_STRING","Auth",850],["T_OBJECT_OPERATOR","->",850],["T_STRING","config",850],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",850],",",["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","'\/users\/login'",850],")",";",["T_WHITESPACE","\n\n        ",850],["T_VARIABLE","$response",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_NEW","new",852],["T_WHITESPACE"," ",852],["T_STRING","Response",852],"(",")",";",["T_WHITESPACE","\n        ",852],["T_VARIABLE","$Controller",853],["T_WHITESPACE"," ",853],"=",["T_WHITESPACE"," ",853],["T_VARIABLE","$this",853],["T_OBJECT_OPERATOR","->",853],["T_STRING","getMockBuilder",853],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",853],")",["T_WHITESPACE","\n            ",853],["T_OBJECT_OPERATOR","->",854],["T_STRING","setMethods",854],"(","[",["T_CONSTANT_ENCAPSED_STRING","'on'",854],",",["T_WHITESPACE"," ",854],["T_CONSTANT_ENCAPSED_STRING","'redirect'",854],"]",")",["T_WHITESPACE","\n            ",854],["T_OBJECT_OPERATOR","->",855],["T_STRING","setConstructorArgs",855],"(","[",["T_VARIABLE","$request",855],",",["T_WHITESPACE"," ",855],["T_VARIABLE","$response",855],"]",")",["T_WHITESPACE","\n            ",855],["T_OBJECT_OPERATOR","->",856],["T_STRING","getMock",856],"(",")",";",["T_WHITESPACE","\n\n        ",856],["T_COMMENT","\/\/ Uses referrer instead of loginAction.\n",858],["T_WHITESPACE","        ",859],["T_VARIABLE","$Controller",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","expects",859],"(",["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","once",859],"(",")",")",["T_WHITESPACE","\n            ",859],["T_OBJECT_OPERATOR","->",860],["T_STRING","method",860],"(",["T_CONSTANT_ENCAPSED_STRING","'redirect'",860],")",["T_WHITESPACE","\n            ",860],["T_OBJECT_OPERATOR","->",861],["T_STRING","with",861],"(",["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","equalTo",861],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",861],")",")",";",["T_WHITESPACE","\n\n        ",861],["T_VARIABLE","$event",863],["T_WHITESPACE"," ",863],"=",["T_WHITESPACE"," ",863],["T_NEW","new",863],["T_WHITESPACE"," ",863],["T_STRING","Event",863],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",863],",",["T_WHITESPACE"," ",863],["T_VARIABLE","$Controller",863],")",";",["T_WHITESPACE","\n        ",863],["T_VARIABLE","$this",864],["T_OBJECT_OPERATOR","->",864],["T_STRING","Auth",864],["T_OBJECT_OPERATOR","->",864],["T_STRING","startup",864],"(",["T_VARIABLE","$event",864],")",";",["T_WHITESPACE","\n    ",864],"}",["T_WHITESPACE","\n\n    ",865],["T_DOC_COMMENT","\/**\n     * testRedirectToUnauthorizedRedirectSuppressedAuthError\n     *\n     * @return void\n     * @triggers Controller.startup $Controller\n     *\/",867],["T_WHITESPACE","\n    ",872],["T_PUBLIC","public",873],["T_WHITESPACE"," ",873],["T_FUNCTION","function",873],["T_WHITESPACE"," ",873],["T_STRING","testRedirectToUnauthorizedRedirectSuppressedAuthError",873],"(",")",["T_WHITESPACE","\n    ",873],"{",["T_WHITESPACE","\n        ",874],["T_VARIABLE","$url",875],["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],["T_CONSTANT_ENCAPSED_STRING","'\/party\/on'",875],";",["T_WHITESPACE","\n        ",875],["T_VARIABLE","$this",876],["T_OBJECT_OPERATOR","->",876],["T_STRING","Auth",876],["T_OBJECT_OPERATOR","->",876],["T_STRING","session",876],["T_WHITESPACE"," ",876],"=",["T_WHITESPACE"," ",876],["T_VARIABLE","$this",876],["T_OBJECT_OPERATOR","->",876],["T_STRING","getMockBuilder",876],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Session'",876],")",["T_WHITESPACE","\n            ",876],["T_OBJECT_OPERATOR","->",877],["T_STRING","setMethods",877],"(","[",["T_CONSTANT_ENCAPSED_STRING","'flash'",877],"]",")",["T_WHITESPACE","\n            ",877],["T_OBJECT_OPERATOR","->",878],["T_STRING","getMock",878],"(",")",";",["T_WHITESPACE","\n        ",878],["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","Auth",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","request",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_VARIABLE","$Request",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_NEW","new",879],["T_WHITESPACE"," ",879],["T_STRING","Request",879],"(",["T_VARIABLE","$url",879],")",";",["T_WHITESPACE","\n        ",879],["T_VARIABLE","$this",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","Auth",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","request",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","addParams",880],"(",["T_STRING","Router",880],["T_DOUBLE_COLON","::",880],["T_STRING","parse",880],"(",["T_VARIABLE","$url",880],")",")",";",["T_WHITESPACE","\n        ",880],["T_VARIABLE","$this",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","Auth",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","config",881],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",881],",",["T_WHITESPACE"," ",881],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",881],"]",")",";",["T_WHITESPACE","\n        ",881],["T_VARIABLE","$this",882],["T_OBJECT_OPERATOR","->",882],["T_STRING","Auth",882],["T_OBJECT_OPERATOR","->",882],["T_STRING","setUser",882],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",882],["T_WHITESPACE"," ",882],["T_DOUBLE_ARROW","=>",882],["T_WHITESPACE"," ",882],["T_CONSTANT_ENCAPSED_STRING","'admad'",882],",",["T_WHITESPACE"," ",882],["T_CONSTANT_ENCAPSED_STRING","'password'",882],["T_WHITESPACE"," ",882],["T_DOUBLE_ARROW","=>",882],["T_WHITESPACE"," ",882],["T_CONSTANT_ENCAPSED_STRING","'cake'",882],"]",")",";",["T_WHITESPACE","\n        ",882],["T_VARIABLE","$expected",883],["T_WHITESPACE"," ",883],"=",["T_WHITESPACE"," ",883],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",883],["T_WHITESPACE"," ",883],["T_DOUBLE_ARROW","=>",883],["T_WHITESPACE"," ",883],["T_CONSTANT_ENCAPSED_STRING","'no_can_do'",883],",",["T_WHITESPACE"," ",883],["T_CONSTANT_ENCAPSED_STRING","'action'",883],["T_WHITESPACE"," ",883],["T_DOUBLE_ARROW","=>",883],["T_WHITESPACE"," ",883],["T_CONSTANT_ENCAPSED_STRING","'jack'",883],"]",";",["T_WHITESPACE","\n        ",883],["T_VARIABLE","$this",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","Auth",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","config",884],"(",["T_CONSTANT_ENCAPSED_STRING","'unauthorizedRedirect'",884],",",["T_WHITESPACE"," ",884],["T_VARIABLE","$expected",884],")",";",["T_WHITESPACE","\n        ",884],["T_VARIABLE","$this",885],["T_OBJECT_OPERATOR","->",885],["T_STRING","Auth",885],["T_OBJECT_OPERATOR","->",885],["T_STRING","config",885],"(",["T_CONSTANT_ENCAPSED_STRING","'authError'",885],",",["T_WHITESPACE"," ",885],["T_STRING","false",885],")",";",["T_WHITESPACE","\n\n        ",885],["T_VARIABLE","$Response",887],["T_WHITESPACE"," ",887],"=",["T_WHITESPACE"," ",887],["T_NEW","new",887],["T_WHITESPACE"," ",887],["T_STRING","Response",887],"(",")",";",["T_WHITESPACE","\n        ",887],["T_VARIABLE","$Controller",888],["T_WHITESPACE"," ",888],"=",["T_WHITESPACE"," ",888],["T_VARIABLE","$this",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","getMockBuilder",888],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",888],")",["T_WHITESPACE","\n            ",888],["T_OBJECT_OPERATOR","->",889],["T_STRING","setMethods",889],"(","[",["T_CONSTANT_ENCAPSED_STRING","'on'",889],",",["T_WHITESPACE"," ",889],["T_CONSTANT_ENCAPSED_STRING","'redirect'",889],"]",")",["T_WHITESPACE","\n            ",889],["T_OBJECT_OPERATOR","->",890],["T_STRING","setConstructorArgs",890],"(","[",["T_VARIABLE","$Request",890],",",["T_WHITESPACE"," ",890],["T_VARIABLE","$Response",890],"]",")",["T_WHITESPACE","\n            ",890],["T_OBJECT_OPERATOR","->",891],["T_STRING","getMock",891],"(",")",";",["T_WHITESPACE","\n\n        ",891],["T_VARIABLE","$Controller",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","expects",893],"(",["T_VARIABLE","$this",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","once",893],"(",")",")",["T_WHITESPACE","\n            ",893],["T_OBJECT_OPERATOR","->",894],["T_STRING","method",894],"(",["T_CONSTANT_ENCAPSED_STRING","'redirect'",894],")",["T_WHITESPACE","\n            ",894],["T_OBJECT_OPERATOR","->",895],["T_STRING","with",895],"(",["T_VARIABLE","$this",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","equalTo",895],"(",["T_VARIABLE","$expected",895],")",")",";",["T_WHITESPACE","\n\n        ",895],["T_VARIABLE","$this",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","Auth",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","session",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","expects",897],"(",["T_VARIABLE","$this",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","never",897],"(",")",")",["T_WHITESPACE","\n            ",897],["T_OBJECT_OPERATOR","->",898],["T_STRING","method",898],"(",["T_CONSTANT_ENCAPSED_STRING","'flash'",898],")",";",["T_WHITESPACE","\n\n        ",898],["T_VARIABLE","$event",900],["T_WHITESPACE"," ",900],"=",["T_WHITESPACE"," ",900],["T_NEW","new",900],["T_WHITESPACE"," ",900],["T_STRING","Event",900],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",900],",",["T_WHITESPACE"," ",900],["T_VARIABLE","$Controller",900],")",";",["T_WHITESPACE","\n        ",900],["T_VARIABLE","$this",901],["T_OBJECT_OPERATOR","->",901],["T_STRING","Auth",901],["T_OBJECT_OPERATOR","->",901],["T_STRING","startup",901],"(",["T_VARIABLE","$event",901],")",";",["T_WHITESPACE","\n    ",901],"}",["T_WHITESPACE","\n\n    ",902],["T_DOC_COMMENT","\/**\n     * Throw ForbiddenException if config `unauthorizedRedirect` is set to false\n     *\n     * @expectedException \\Cake\\Network\\Exception\\ForbiddenException\n     * @return void\n     * @triggers Controller.startup $Controller\n     *\/",904],["T_WHITESPACE","\n    ",910],["T_PUBLIC","public",911],["T_WHITESPACE"," ",911],["T_FUNCTION","function",911],["T_WHITESPACE"," ",911],["T_STRING","testForbiddenException",911],"(",")",["T_WHITESPACE","\n    ",911],"{",["T_WHITESPACE","\n        ",912],["T_VARIABLE","$url",913],["T_WHITESPACE"," ",913],"=",["T_WHITESPACE"," ",913],["T_CONSTANT_ENCAPSED_STRING","'\/party\/on'",913],";",["T_WHITESPACE","\n        ",913],["T_VARIABLE","$this",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","Auth",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","request",914],["T_WHITESPACE"," ",914],"=",["T_WHITESPACE"," ",914],["T_VARIABLE","$request",914],["T_WHITESPACE"," ",914],"=",["T_WHITESPACE"," ",914],["T_NEW","new",914],["T_WHITESPACE"," ",914],["T_STRING","Request",914],"(",["T_VARIABLE","$url",914],")",";",["T_WHITESPACE","\n        ",914],["T_VARIABLE","$this",915],["T_OBJECT_OPERATOR","->",915],["T_STRING","Auth",915],["T_OBJECT_OPERATOR","->",915],["T_STRING","request",915],["T_OBJECT_OPERATOR","->",915],["T_STRING","addParams",915],"(",["T_STRING","Router",915],["T_DOUBLE_COLON","::",915],["T_STRING","parse",915],"(",["T_VARIABLE","$url",915],")",")",";",["T_WHITESPACE","\n        ",915],["T_VARIABLE","$this",916],["T_OBJECT_OPERATOR","->",916],["T_STRING","Auth",916],["T_OBJECT_OPERATOR","->",916],["T_STRING","config",916],"(","[",["T_WHITESPACE","\n            ",916],["T_CONSTANT_ENCAPSED_STRING","'authorize'",917],["T_WHITESPACE"," ",917],["T_DOUBLE_ARROW","=>",917],["T_WHITESPACE"," ",917],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",917],"]",",",["T_WHITESPACE","\n            ",917],["T_CONSTANT_ENCAPSED_STRING","'unauthorizedRedirect'",918],["T_WHITESPACE"," ",918],["T_DOUBLE_ARROW","=>",918],["T_WHITESPACE"," ",918],["T_STRING","false",918],["T_WHITESPACE","\n        ",918],"]",")",";",["T_WHITESPACE","\n        ",919],["T_VARIABLE","$this",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","Auth",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","setUser",920],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",920],["T_WHITESPACE"," ",920],["T_DOUBLE_ARROW","=>",920],["T_WHITESPACE"," ",920],["T_CONSTANT_ENCAPSED_STRING","'baker'",920],",",["T_WHITESPACE"," ",920],["T_CONSTANT_ENCAPSED_STRING","'password'",920],["T_WHITESPACE"," ",920],["T_DOUBLE_ARROW","=>",920],["T_WHITESPACE"," ",920],["T_CONSTANT_ENCAPSED_STRING","'cake'",920],"]",")",";",["T_WHITESPACE","\n\n        ",920],["T_VARIABLE","$response",922],["T_WHITESPACE"," ",922],"=",["T_WHITESPACE"," ",922],["T_NEW","new",922],["T_WHITESPACE"," ",922],["T_STRING","Response",922],"(",")",";",["T_WHITESPACE","\n        ",922],["T_VARIABLE","$Controller",923],["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_VARIABLE","$this",923],["T_OBJECT_OPERATOR","->",923],["T_STRING","getMockBuilder",923],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",923],")",["T_WHITESPACE","\n            ",923],["T_OBJECT_OPERATOR","->",924],["T_STRING","setMethods",924],"(","[",["T_CONSTANT_ENCAPSED_STRING","'on'",924],",",["T_WHITESPACE"," ",924],["T_CONSTANT_ENCAPSED_STRING","'redirect'",924],"]",")",["T_WHITESPACE","\n            ",924],["T_OBJECT_OPERATOR","->",925],["T_STRING","setConstructorArgs",925],"(","[",["T_VARIABLE","$request",925],",",["T_WHITESPACE"," ",925],["T_VARIABLE","$response",925],"]",")",["T_WHITESPACE","\n            ",925],["T_OBJECT_OPERATOR","->",926],["T_STRING","getMock",926],"(",")",";",["T_WHITESPACE","\n\n        ",926],["T_VARIABLE","$event",928],["T_WHITESPACE"," ",928],"=",["T_WHITESPACE"," ",928],["T_NEW","new",928],["T_WHITESPACE"," ",928],["T_STRING","Event",928],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",928],",",["T_WHITESPACE"," ",928],["T_VARIABLE","$Controller",928],")",";",["T_WHITESPACE","\n        ",928],["T_VARIABLE","$this",929],["T_OBJECT_OPERATOR","->",929],["T_STRING","Auth",929],["T_OBJECT_OPERATOR","->",929],["T_STRING","startup",929],"(",["T_VARIABLE","$event",929],")",";",["T_WHITESPACE","\n    ",929],"}",["T_WHITESPACE","\n\n    ",930],["T_DOC_COMMENT","\/**\n     * Test that no redirects or authorization tests occur on the loginAction\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",932],["T_WHITESPACE","\n    ",937],["T_PUBLIC","public",938],["T_WHITESPACE"," ",938],["T_FUNCTION","function",938],["T_WHITESPACE"," ",938],["T_STRING","testNoRedirectOnLoginAction",938],"(",")",["T_WHITESPACE","\n    ",938],"{",["T_WHITESPACE","\n        ",939],["T_VARIABLE","$event",940],["T_WHITESPACE"," ",940],"=",["T_WHITESPACE"," ",940],["T_NEW","new",940],["T_WHITESPACE"," ",940],["T_STRING","Event",940],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",940],",",["T_WHITESPACE"," ",940],["T_VARIABLE","$this",940],["T_OBJECT_OPERATOR","->",940],["T_STRING","Controller",940],")",";",["T_WHITESPACE","\n        ",940],["T_VARIABLE","$controller",941],["T_WHITESPACE"," ",941],"=",["T_WHITESPACE"," ",941],["T_VARIABLE","$this",941],["T_OBJECT_OPERATOR","->",941],["T_STRING","getMockBuilder",941],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Controller'",941],")",["T_WHITESPACE","\n            ",941],["T_OBJECT_OPERATOR","->",942],["T_STRING","setMethods",942],"(","[",["T_CONSTANT_ENCAPSED_STRING","'redirect'",942],"]",")",["T_WHITESPACE","\n            ",942],["T_OBJECT_OPERATOR","->",943],["T_STRING","getMock",943],"(",")",";",["T_WHITESPACE","\n        ",943],["T_VARIABLE","$controller",944],["T_OBJECT_OPERATOR","->",944],["T_STRING","methods",944],["T_WHITESPACE"," ",944],"=",["T_WHITESPACE"," ",944],"[",["T_CONSTANT_ENCAPSED_STRING","'login'",944],"]",";",["T_WHITESPACE","\n\n        ",944],["T_VARIABLE","$url",946],["T_WHITESPACE"," ",946],"=",["T_WHITESPACE"," ",946],["T_CONSTANT_ENCAPSED_STRING","'\/AuthTest\/login'",946],";",["T_WHITESPACE","\n        ",946],["T_VARIABLE","$this",947],["T_OBJECT_OPERATOR","->",947],["T_STRING","Auth",947],["T_OBJECT_OPERATOR","->",947],["T_STRING","request",947],["T_WHITESPACE"," ",947],"=",["T_WHITESPACE"," ",947],["T_VARIABLE","$controller",947],["T_OBJECT_OPERATOR","->",947],["T_STRING","request",947],["T_WHITESPACE"," ",947],"=",["T_WHITESPACE"," ",947],["T_NEW","new",947],["T_WHITESPACE"," ",947],["T_STRING","Request",947],"(",["T_VARIABLE","$url",947],")",";",["T_WHITESPACE","\n        ",947],["T_VARIABLE","$this",948],["T_OBJECT_OPERATOR","->",948],["T_STRING","Auth",948],["T_OBJECT_OPERATOR","->",948],["T_STRING","request",948],["T_OBJECT_OPERATOR","->",948],["T_STRING","addParams",948],"(",["T_STRING","Router",948],["T_DOUBLE_COLON","::",948],["T_STRING","parse",948],"(",["T_VARIABLE","$url",948],")",")",";",["T_WHITESPACE","\n        ",948],["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","Auth",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","config",949],"(","[",["T_WHITESPACE","\n            ",949],["T_CONSTANT_ENCAPSED_STRING","'loginAction'",950],",",["T_WHITESPACE"," ",950],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",950],["T_WHITESPACE"," ",950],["T_DOUBLE_ARROW","=>",950],["T_WHITESPACE"," ",950],["T_CONSTANT_ENCAPSED_STRING","'AuthTest'",950],",",["T_WHITESPACE"," ",950],["T_CONSTANT_ENCAPSED_STRING","'action'",950],["T_WHITESPACE"," ",950],["T_DOUBLE_ARROW","=>",950],["T_WHITESPACE"," ",950],["T_CONSTANT_ENCAPSED_STRING","'login'",950],"]",",",["T_WHITESPACE","\n            ",950],["T_CONSTANT_ENCAPSED_STRING","'authorize'",951],",",["T_WHITESPACE"," ",951],"[",["T_CONSTANT_ENCAPSED_STRING","'Controller'",951],"]",["T_WHITESPACE","\n        ",951],"]",")",";",["T_WHITESPACE","\n\n        ",952],["T_VARIABLE","$controller",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","expects",954],"(",["T_VARIABLE","$this",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","never",954],"(",")",")",["T_WHITESPACE","\n            ",954],["T_OBJECT_OPERATOR","->",955],["T_STRING","method",955],"(",["T_CONSTANT_ENCAPSED_STRING","'redirect'",955],")",";",["T_WHITESPACE","\n\n        ",955],["T_VARIABLE","$this",957],["T_OBJECT_OPERATOR","->",957],["T_STRING","Auth",957],["T_OBJECT_OPERATOR","->",957],["T_STRING","startup",957],"(",["T_VARIABLE","$event",957],")",";",["T_WHITESPACE","\n    ",957],"}",["T_WHITESPACE","\n\n    ",958],["T_DOC_COMMENT","\/**\n     * Ensure that no redirect is performed when a 404 is reached\n     * And the user doesn't have a session.\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",960],["T_WHITESPACE","\n    ",966],["T_PUBLIC","public",967],["T_WHITESPACE"," ",967],["T_FUNCTION","function",967],["T_WHITESPACE"," ",967],["T_STRING","testNoRedirectOn404",967],"(",")",["T_WHITESPACE","\n    ",967],"{",["T_WHITESPACE","\n        ",968],["T_VARIABLE","$event",969],["T_WHITESPACE"," ",969],"=",["T_WHITESPACE"," ",969],["T_NEW","new",969],["T_WHITESPACE"," ",969],["T_STRING","Event",969],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",969],",",["T_WHITESPACE"," ",969],["T_VARIABLE","$this",969],["T_OBJECT_OPERATOR","->",969],["T_STRING","Controller",969],")",";",["T_WHITESPACE","\n        ",969],["T_VARIABLE","$this",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","Auth",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","session",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","delete",970],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",970],")",";",["T_WHITESPACE","\n        ",970],["T_VARIABLE","$this",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","Auth",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","request",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","addParams",971],"(",["T_STRING","Router",971],["T_DOUBLE_COLON","::",971],["T_STRING","parse",971],"(",["T_CONSTANT_ENCAPSED_STRING","'auth_test\/something_totally_wrong'",971],")",")",";",["T_WHITESPACE","\n        ",971],["T_VARIABLE","$result",972],["T_WHITESPACE"," ",972],"=",["T_WHITESPACE"," ",972],["T_VARIABLE","$this",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","Auth",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","startup",972],"(",["T_VARIABLE","$event",972],")",";",["T_WHITESPACE","\n        ",972],["T_VARIABLE","$this",973],["T_OBJECT_OPERATOR","->",973],["T_STRING","assertNull",973],"(",["T_VARIABLE","$result",973],",",["T_WHITESPACE"," ",973],["T_CONSTANT_ENCAPSED_STRING","'Auth redirected a missing action %s'",973],")",";",["T_WHITESPACE","\n    ",973],"}",["T_WHITESPACE","\n\n    ",974],["T_DOC_COMMENT","\/**\n     * testAdminRoute method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",976],["T_WHITESPACE","\n    ",981],["T_PUBLIC","public",982],["T_WHITESPACE"," ",982],["T_FUNCTION","function",982],["T_WHITESPACE"," ",982],["T_STRING","testAdminRoute",982],"(",")",["T_WHITESPACE","\n    ",982],"{",["T_WHITESPACE","\n        ",983],["T_VARIABLE","$event",984],["T_WHITESPACE"," ",984],"=",["T_WHITESPACE"," ",984],["T_NEW","new",984],["T_WHITESPACE"," ",984],["T_STRING","Event",984],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",984],",",["T_WHITESPACE"," ",984],["T_VARIABLE","$this",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","Controller",984],")",";",["T_WHITESPACE","\n        ",984],["T_STRING","Router",985],["T_DOUBLE_COLON","::",985],["T_STRING","reload",985],"(",")",";",["T_WHITESPACE","\n        ",985],["T_STRING","Router",986],["T_DOUBLE_COLON","::",986],["T_STRING","prefix",986],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",986],",",["T_WHITESPACE"," ",986],["T_FUNCTION","function",986],["T_WHITESPACE"," ",986],"(",["T_VARIABLE","$routes",986],")",["T_WHITESPACE"," ",986],"{",["T_WHITESPACE","\n            ",986],["T_VARIABLE","$routes",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","fallbacks",987],"(",["T_CONSTANT_ENCAPSED_STRING","'InflectedRoute'",987],")",";",["T_WHITESPACE","\n        ",987],"}",")",";",["T_WHITESPACE","\n        ",988],["T_STRING","Router",989],["T_DOUBLE_COLON","::",989],["T_STRING","scope",989],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",989],",",["T_WHITESPACE"," ",989],["T_FUNCTION","function",989],["T_WHITESPACE"," ",989],"(",["T_VARIABLE","$routes",989],")",["T_WHITESPACE"," ",989],"{",["T_WHITESPACE","\n            ",989],["T_VARIABLE","$routes",990],["T_OBJECT_OPERATOR","->",990],["T_STRING","fallbacks",990],"(",["T_CONSTANT_ENCAPSED_STRING","'InflectedRoute'",990],")",";",["T_WHITESPACE","\n        ",990],"}",")",";",["T_WHITESPACE","\n\n        ",991],["T_VARIABLE","$url",993],["T_WHITESPACE"," ",993],"=",["T_WHITESPACE"," ",993],["T_CONSTANT_ENCAPSED_STRING","'\/admin\/auth_test\/add'",993],";",["T_WHITESPACE","\n        ",993],["T_VARIABLE","$this",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","Auth",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","request",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","addParams",994],"(",["T_STRING","Router",994],["T_DOUBLE_COLON","::",994],["T_STRING","parse",994],"(",["T_VARIABLE","$url",994],")",")",";",["T_WHITESPACE","\n        ",994],["T_VARIABLE","$this",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","Auth",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","request",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","query",995],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",995],"]",["T_WHITESPACE"," ",995],"=",["T_WHITESPACE"," ",995],["T_STRING","ltrim",995],"(",["T_VARIABLE","$url",995],",",["T_WHITESPACE"," ",995],["T_CONSTANT_ENCAPSED_STRING","'\/'",995],")",";",["T_WHITESPACE","\n        ",995],["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","Auth",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","request",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","base",996],["T_WHITESPACE"," ",996],"=",["T_WHITESPACE"," ",996],["T_CONSTANT_ENCAPSED_STRING","''",996],";",["T_WHITESPACE","\n\n        ",996],["T_STRING","Router",998],["T_DOUBLE_COLON","::",998],["T_STRING","setRequestInfo",998],"(",["T_VARIABLE","$this",998],["T_OBJECT_OPERATOR","->",998],["T_STRING","Auth",998],["T_OBJECT_OPERATOR","->",998],["T_STRING","request",998],")",";",["T_WHITESPACE","\n\n        ",998],["T_VARIABLE","$this",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","Auth",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","config",1000],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1000],",",["T_WHITESPACE"," ",1000],"[",["T_WHITESPACE","\n            ",1000],["T_CONSTANT_ENCAPSED_STRING","'prefix'",1001],["T_WHITESPACE"," ",1001],["T_DOUBLE_ARROW","=>",1001],["T_WHITESPACE"," ",1001],["T_CONSTANT_ENCAPSED_STRING","'admin'",1001],",",["T_WHITESPACE","\n            ",1001],["T_CONSTANT_ENCAPSED_STRING","'controller'",1002],["T_WHITESPACE"," ",1002],["T_DOUBLE_ARROW","=>",1002],["T_WHITESPACE"," ",1002],["T_CONSTANT_ENCAPSED_STRING","'auth_test'",1002],",",["T_WHITESPACE","\n            ",1002],["T_CONSTANT_ENCAPSED_STRING","'action'",1003],["T_WHITESPACE"," ",1003],["T_DOUBLE_ARROW","=>",1003],["T_WHITESPACE"," ",1003],["T_CONSTANT_ENCAPSED_STRING","'login'",1003],["T_WHITESPACE","\n        ",1003],"]",")",";",["T_WHITESPACE","\n\n        ",1004],["T_VARIABLE","$this",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","Auth",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","startup",1006],"(",["T_VARIABLE","$event",1006],")",";",["T_WHITESPACE","\n        ",1006],["T_VARIABLE","$this",1007],["T_OBJECT_OPERATOR","->",1007],["T_STRING","assertEquals",1007],"(",["T_CONSTANT_ENCAPSED_STRING","'\/admin\/auth_test\/login'",1007],",",["T_WHITESPACE"," ",1007],["T_VARIABLE","$this",1007],["T_OBJECT_OPERATOR","->",1007],["T_STRING","Controller",1007],["T_OBJECT_OPERATOR","->",1007],["T_STRING","testUrl",1007],")",";",["T_WHITESPACE","\n    ",1007],"}",["T_WHITESPACE","\n\n    ",1008],["T_DOC_COMMENT","\/**\n     * testAjaxLogin method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1010],["T_WHITESPACE","\n    ",1015],["T_PUBLIC","public",1016],["T_WHITESPACE"," ",1016],["T_FUNCTION","function",1016],["T_WHITESPACE"," ",1016],["T_STRING","testAjaxLogin",1016],"(",")",["T_WHITESPACE","\n    ",1016],"{",["T_WHITESPACE","\n        ",1017],["T_VARIABLE","$this",1018],["T_OBJECT_OPERATOR","->",1018],["T_STRING","Controller",1018],["T_OBJECT_OPERATOR","->",1018],["T_STRING","request",1018],["T_WHITESPACE"," ",1018],"=",["T_WHITESPACE"," ",1018],["T_NEW","new",1018],["T_WHITESPACE"," ",1018],["T_STRING","Request",1018],"(","[",["T_WHITESPACE","\n            ",1018],["T_CONSTANT_ENCAPSED_STRING","'url'",1019],["T_WHITESPACE"," ",1019],["T_DOUBLE_ARROW","=>",1019],["T_WHITESPACE"," ",1019],["T_CONSTANT_ENCAPSED_STRING","'\/ajax_auth\/add'",1019],",",["T_WHITESPACE","\n            ",1019],["T_CONSTANT_ENCAPSED_STRING","'environment'",1020],["T_WHITESPACE"," ",1020],["T_DOUBLE_ARROW","=>",1020],["T_WHITESPACE"," ",1020],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_REQUESTED_WITH'",1020],["T_WHITESPACE"," ",1020],["T_DOUBLE_ARROW","=>",1020],["T_WHITESPACE"," ",1020],["T_CONSTANT_ENCAPSED_STRING","'XMLHttpRequest'",1020],"]",",",["T_WHITESPACE","\n        ",1020],"]",")",";",["T_WHITESPACE","\n        ",1021],["T_VARIABLE","$this",1022],["T_OBJECT_OPERATOR","->",1022],["T_STRING","Controller",1022],["T_OBJECT_OPERATOR","->",1022],["T_STRING","request",1022],["T_OBJECT_OPERATOR","->",1022],["T_STRING","params",1022],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",1022],"]",["T_WHITESPACE"," ",1022],"=",["T_WHITESPACE"," ",1022],["T_CONSTANT_ENCAPSED_STRING","'add'",1022],";",["T_WHITESPACE","\n\n        ",1022],["T_VARIABLE","$event",1024],["T_WHITESPACE"," ",1024],"=",["T_WHITESPACE"," ",1024],["T_NEW","new",1024],["T_WHITESPACE"," ",1024],["T_STRING","Event",1024],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1024],",",["T_WHITESPACE"," ",1024],["T_VARIABLE","$this",1024],["T_OBJECT_OPERATOR","->",1024],["T_STRING","Controller",1024],")",";",["T_WHITESPACE","\n        ",1024],["T_VARIABLE","$this",1025],["T_OBJECT_OPERATOR","->",1025],["T_STRING","Auth",1025],["T_OBJECT_OPERATOR","->",1025],["T_STRING","config",1025],"(",["T_CONSTANT_ENCAPSED_STRING","'ajaxLogin'",1025],",",["T_WHITESPACE"," ",1025],["T_CONSTANT_ENCAPSED_STRING","'test_element'",1025],")",";",["T_WHITESPACE","\n        ",1025],["T_VARIABLE","$this",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","Auth",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","RequestHandler",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","ajaxLayout",1026],["T_WHITESPACE"," ",1026],"=",["T_WHITESPACE"," ",1026],["T_CONSTANT_ENCAPSED_STRING","'ajax2'",1026],";",["T_WHITESPACE","\n\n        ",1026],["T_VARIABLE","$response",1028],["T_WHITESPACE"," ",1028],"=",["T_WHITESPACE"," ",1028],["T_VARIABLE","$this",1028],["T_OBJECT_OPERATOR","->",1028],["T_STRING","Auth",1028],["T_OBJECT_OPERATOR","->",1028],["T_STRING","startup",1028],"(",["T_VARIABLE","$event",1028],")",";",["T_WHITESPACE","\n\n        ",1028],["T_VARIABLE","$this",1030],["T_OBJECT_OPERATOR","->",1030],["T_STRING","assertTrue",1030],"(",["T_VARIABLE","$event",1030],["T_OBJECT_OPERATOR","->",1030],["T_STRING","isStopped",1030],"(",")",")",";",["T_WHITESPACE","\n        ",1030],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","assertEquals",1031],"(",["T_LNUMBER","403",1031],",",["T_WHITESPACE"," ",1031],["T_VARIABLE","$response",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","statusCode",1031],"(",")",")",";",["T_WHITESPACE","\n        ",1031],["T_VARIABLE","$this",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","assertEquals",1032],"(",["T_WHITESPACE","\n            ",1032],["T_CONSTANT_ENCAPSED_STRING","\"Ajax!\\nthis is the test element\"",1033],",",["T_WHITESPACE","\n            ",1033],["T_STRING","str_replace",1034],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1034],",",["T_WHITESPACE"," ",1034],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",1034],",",["T_WHITESPACE"," ",1034],["T_VARIABLE","$response",1034],["T_OBJECT_OPERATOR","->",1034],["T_STRING","body",1034],"(",")",")",["T_WHITESPACE","\n        ",1034],")",";",["T_WHITESPACE","\n    ",1035],"}",["T_WHITESPACE","\n\n    ",1036],["T_DOC_COMMENT","\/**\n     * test ajax unauthenticated\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1038],["T_WHITESPACE","\n    ",1043],["T_PUBLIC","public",1044],["T_WHITESPACE"," ",1044],["T_FUNCTION","function",1044],["T_WHITESPACE"," ",1044],["T_STRING","testAjaxUnauthenticated",1044],"(",")",["T_WHITESPACE","\n    ",1044],"{",["T_WHITESPACE","\n        ",1045],["T_VARIABLE","$this",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","Controller",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","request",1046],["T_WHITESPACE"," ",1046],"=",["T_WHITESPACE"," ",1046],["T_NEW","new",1046],["T_WHITESPACE"," ",1046],["T_STRING","Request",1046],"(","[",["T_WHITESPACE","\n            ",1046],["T_CONSTANT_ENCAPSED_STRING","'url'",1047],["T_WHITESPACE"," ",1047],["T_DOUBLE_ARROW","=>",1047],["T_WHITESPACE"," ",1047],["T_CONSTANT_ENCAPSED_STRING","'\/ajax_auth\/add'",1047],",",["T_WHITESPACE","\n            ",1047],["T_CONSTANT_ENCAPSED_STRING","'environment'",1048],["T_WHITESPACE"," ",1048],["T_DOUBLE_ARROW","=>",1048],["T_WHITESPACE"," ",1048],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_REQUESTED_WITH'",1048],["T_WHITESPACE"," ",1048],["T_DOUBLE_ARROW","=>",1048],["T_WHITESPACE"," ",1048],["T_CONSTANT_ENCAPSED_STRING","'XMLHttpRequest'",1048],"]",",",["T_WHITESPACE","\n        ",1048],"]",")",";",["T_WHITESPACE","\n        ",1049],["T_VARIABLE","$this",1050],["T_OBJECT_OPERATOR","->",1050],["T_STRING","Controller",1050],["T_OBJECT_OPERATOR","->",1050],["T_STRING","request",1050],["T_OBJECT_OPERATOR","->",1050],["T_STRING","params",1050],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",1050],"]",["T_WHITESPACE"," ",1050],"=",["T_WHITESPACE"," ",1050],["T_CONSTANT_ENCAPSED_STRING","'add'",1050],";",["T_WHITESPACE","\n\n        ",1050],["T_VARIABLE","$event",1052],["T_WHITESPACE"," ",1052],"=",["T_WHITESPACE"," ",1052],["T_NEW","new",1052],["T_WHITESPACE"," ",1052],["T_STRING","Event",1052],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1052],",",["T_WHITESPACE"," ",1052],["T_VARIABLE","$this",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","Controller",1052],")",";",["T_WHITESPACE","\n        ",1052],["T_VARIABLE","$response",1053],["T_WHITESPACE"," ",1053],"=",["T_WHITESPACE"," ",1053],["T_VARIABLE","$this",1053],["T_OBJECT_OPERATOR","->",1053],["T_STRING","Auth",1053],["T_OBJECT_OPERATOR","->",1053],["T_STRING","startup",1053],"(",["T_VARIABLE","$event",1053],")",";",["T_WHITESPACE","\n\n        ",1053],["T_VARIABLE","$this",1055],["T_OBJECT_OPERATOR","->",1055],["T_STRING","assertTrue",1055],"(",["T_VARIABLE","$event",1055],["T_OBJECT_OPERATOR","->",1055],["T_STRING","isStopped",1055],"(",")",")",";",["T_WHITESPACE","\n        ",1055],["T_VARIABLE","$this",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","assertEquals",1056],"(",["T_LNUMBER","403",1056],",",["T_WHITESPACE"," ",1056],["T_VARIABLE","$response",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","statusCode",1056],"(",")",")",";",["T_WHITESPACE","\n        ",1056],["T_VARIABLE","$this",1057],["T_OBJECT_OPERATOR","->",1057],["T_STRING","assertArrayNotHasKey",1057],"(",["T_CONSTANT_ENCAPSED_STRING","'Location'",1057],",",["T_WHITESPACE"," ",1057],["T_VARIABLE","$response",1057],["T_OBJECT_OPERATOR","->",1057],["T_STRING","header",1057],"(",")",")",";",["T_WHITESPACE","\n    ",1057],"}",["T_WHITESPACE","\n\n    ",1058],["T_DOC_COMMENT","\/**\n     * testLoginActionRedirect method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1060],["T_WHITESPACE","\n    ",1065],["T_PUBLIC","public",1066],["T_WHITESPACE"," ",1066],["T_FUNCTION","function",1066],["T_WHITESPACE"," ",1066],["T_STRING","testLoginActionRedirect",1066],"(",")",["T_WHITESPACE","\n    ",1066],"{",["T_WHITESPACE","\n        ",1067],["T_VARIABLE","$event",1068],["T_WHITESPACE"," ",1068],"=",["T_WHITESPACE"," ",1068],["T_NEW","new",1068],["T_WHITESPACE"," ",1068],["T_STRING","Event",1068],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1068],",",["T_WHITESPACE"," ",1068],["T_VARIABLE","$this",1068],["T_OBJECT_OPERATOR","->",1068],["T_STRING","Controller",1068],")",";",["T_WHITESPACE","\n        ",1068],["T_STRING","Router",1069],["T_DOUBLE_COLON","::",1069],["T_STRING","reload",1069],"(",")",";",["T_WHITESPACE","\n        ",1069],["T_STRING","Router",1070],["T_DOUBLE_COLON","::",1070],["T_STRING","prefix",1070],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",1070],",",["T_WHITESPACE"," ",1070],["T_FUNCTION","function",1070],["T_WHITESPACE"," ",1070],"(",["T_VARIABLE","$routes",1070],")",["T_WHITESPACE"," ",1070],"{",["T_WHITESPACE","\n            ",1070],["T_VARIABLE","$routes",1071],["T_OBJECT_OPERATOR","->",1071],["T_STRING","fallbacks",1071],"(",["T_CONSTANT_ENCAPSED_STRING","'InflectedRoute'",1071],")",";",["T_WHITESPACE","\n        ",1071],"}",")",";",["T_WHITESPACE","\n        ",1072],["T_STRING","Router",1073],["T_DOUBLE_COLON","::",1073],["T_STRING","scope",1073],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",1073],",",["T_WHITESPACE"," ",1073],["T_FUNCTION","function",1073],["T_WHITESPACE"," ",1073],"(",["T_VARIABLE","$routes",1073],")",["T_WHITESPACE"," ",1073],"{",["T_WHITESPACE","\n            ",1073],["T_VARIABLE","$routes",1074],["T_OBJECT_OPERATOR","->",1074],["T_STRING","fallbacks",1074],"(",["T_CONSTANT_ENCAPSED_STRING","'InflectedRoute'",1074],")",";",["T_WHITESPACE","\n        ",1074],"}",")",";",["T_WHITESPACE","\n\n        ",1075],["T_VARIABLE","$url",1077],["T_WHITESPACE"," ",1077],"=",["T_WHITESPACE"," ",1077],["T_CONSTANT_ENCAPSED_STRING","'\/admin\/auth_test\/login'",1077],";",["T_WHITESPACE","\n        ",1077],["T_VARIABLE","$request",1078],["T_WHITESPACE"," ",1078],"=",["T_WHITESPACE"," ",1078],["T_VARIABLE","$this",1078],["T_OBJECT_OPERATOR","->",1078],["T_STRING","Auth",1078],["T_OBJECT_OPERATOR","->",1078],["T_STRING","request",1078],";",["T_WHITESPACE","\n        ",1078],["T_VARIABLE","$request",1079],["T_OBJECT_OPERATOR","->",1079],["T_STRING","addParams",1079],"(","[",["T_WHITESPACE","\n            ",1079],["T_CONSTANT_ENCAPSED_STRING","'plugin'",1080],["T_WHITESPACE"," ",1080],["T_DOUBLE_ARROW","=>",1080],["T_WHITESPACE"," ",1080],["T_STRING","null",1080],",",["T_WHITESPACE","\n            ",1080],["T_CONSTANT_ENCAPSED_STRING","'controller'",1081],["T_WHITESPACE"," ",1081],["T_DOUBLE_ARROW","=>",1081],["T_WHITESPACE"," ",1081],["T_CONSTANT_ENCAPSED_STRING","'auth_test'",1081],",",["T_WHITESPACE","\n            ",1081],["T_CONSTANT_ENCAPSED_STRING","'action'",1082],["T_WHITESPACE"," ",1082],["T_DOUBLE_ARROW","=>",1082],["T_WHITESPACE"," ",1082],["T_CONSTANT_ENCAPSED_STRING","'login'",1082],",",["T_WHITESPACE","\n            ",1082],["T_CONSTANT_ENCAPSED_STRING","'prefix'",1083],["T_WHITESPACE"," ",1083],["T_DOUBLE_ARROW","=>",1083],["T_WHITESPACE"," ",1083],["T_CONSTANT_ENCAPSED_STRING","'admin'",1083],",",["T_WHITESPACE","\n            ",1083],["T_CONSTANT_ENCAPSED_STRING","'pass'",1084],["T_WHITESPACE"," ",1084],["T_DOUBLE_ARROW","=>",1084],["T_WHITESPACE"," ",1084],"[","]",",",["T_WHITESPACE","\n        ",1084],"]",")",["T_OBJECT_OPERATOR","->",1085],["T_STRING","addPaths",1085],"(","[",["T_WHITESPACE","\n            ",1085],["T_CONSTANT_ENCAPSED_STRING","'base'",1086],["T_WHITESPACE"," ",1086],["T_DOUBLE_ARROW","=>",1086],["T_WHITESPACE"," ",1086],["T_STRING","null",1086],",",["T_WHITESPACE","\n            ",1086],["T_CONSTANT_ENCAPSED_STRING","'here'",1087],["T_WHITESPACE"," ",1087],["T_DOUBLE_ARROW","=>",1087],["T_WHITESPACE"," ",1087],["T_VARIABLE","$url",1087],",",["T_WHITESPACE","\n            ",1087],["T_CONSTANT_ENCAPSED_STRING","'webroot'",1088],["T_WHITESPACE"," ",1088],["T_DOUBLE_ARROW","=>",1088],["T_WHITESPACE"," ",1088],["T_CONSTANT_ENCAPSED_STRING","'\/'",1088],",",["T_WHITESPACE","\n        ",1088],"]",")",";",["T_WHITESPACE","\n        ",1089],["T_VARIABLE","$request",1090],["T_OBJECT_OPERATOR","->",1090],["T_STRING","url",1090],["T_WHITESPACE"," ",1090],"=",["T_WHITESPACE"," ",1090],["T_STRING","ltrim",1090],"(",["T_VARIABLE","$url",1090],",",["T_WHITESPACE"," ",1090],["T_CONSTANT_ENCAPSED_STRING","'\/'",1090],")",";",["T_WHITESPACE","\n        ",1090],["T_STRING","Router",1091],["T_DOUBLE_COLON","::",1091],["T_STRING","setRequestInfo",1091],"(",["T_VARIABLE","$request",1091],")",";",["T_WHITESPACE","\n\n        ",1091],["T_VARIABLE","$this",1093],["T_OBJECT_OPERATOR","->",1093],["T_STRING","Auth",1093],["T_OBJECT_OPERATOR","->",1093],["T_STRING","config",1093],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1093],",",["T_WHITESPACE"," ",1093],"[",["T_WHITESPACE","\n            ",1093],["T_CONSTANT_ENCAPSED_STRING","'prefix'",1094],["T_WHITESPACE"," ",1094],["T_DOUBLE_ARROW","=>",1094],["T_WHITESPACE"," ",1094],["T_CONSTANT_ENCAPSED_STRING","'admin'",1094],",",["T_WHITESPACE","\n            ",1094],["T_CONSTANT_ENCAPSED_STRING","'controller'",1095],["T_WHITESPACE"," ",1095],["T_DOUBLE_ARROW","=>",1095],["T_WHITESPACE"," ",1095],["T_CONSTANT_ENCAPSED_STRING","'auth_test'",1095],",",["T_WHITESPACE","\n            ",1095],["T_CONSTANT_ENCAPSED_STRING","'action'",1096],["T_WHITESPACE"," ",1096],["T_DOUBLE_ARROW","=>",1096],["T_WHITESPACE"," ",1096],["T_CONSTANT_ENCAPSED_STRING","'login'",1096],["T_WHITESPACE","\n        ",1096],"]",")",";",["T_WHITESPACE","\n        ",1097],["T_VARIABLE","$this",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","Auth",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","startup",1098],"(",["T_VARIABLE","$event",1098],")",";",["T_WHITESPACE","\n\n        ",1098],["T_VARIABLE","$this",1100],["T_OBJECT_OPERATOR","->",1100],["T_STRING","assertNull",1100],"(",["T_VARIABLE","$this",1100],["T_OBJECT_OPERATOR","->",1100],["T_STRING","Controller",1100],["T_OBJECT_OPERATOR","->",1100],["T_STRING","testUrl",1100],")",";",["T_WHITESPACE","\n    ",1100],"}",["T_WHITESPACE","\n\n    ",1101],["T_DOC_COMMENT","\/**\n     * Stateless auth methods like Basic should populate data that can be\n     * accessed by $this->user().\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1103],["T_WHITESPACE","\n    ",1109],["T_PUBLIC","public",1110],["T_WHITESPACE"," ",1110],["T_FUNCTION","function",1110],["T_WHITESPACE"," ",1110],["T_STRING","testStatelessAuthWorksWithUser",1110],"(",")",["T_WHITESPACE","\n    ",1110],"{",["T_WHITESPACE","\n        ",1111],["T_VARIABLE","$event",1112],["T_WHITESPACE"," ",1112],"=",["T_WHITESPACE"," ",1112],["T_NEW","new",1112],["T_WHITESPACE"," ",1112],["T_STRING","Event",1112],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1112],",",["T_WHITESPACE"," ",1112],["T_VARIABLE","$this",1112],["T_OBJECT_OPERATOR","->",1112],["T_STRING","Controller",1112],")",";",["T_WHITESPACE","\n        ",1112],["T_VARIABLE","$url",1113],["T_WHITESPACE"," ",1113],"=",["T_WHITESPACE"," ",1113],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/add'",1113],";",["T_WHITESPACE","\n        ",1113],["T_VARIABLE","$this",1114],["T_OBJECT_OPERATOR","->",1114],["T_STRING","Auth",1114],["T_OBJECT_OPERATOR","->",1114],["T_STRING","request",1114],["T_OBJECT_OPERATOR","->",1114],["T_STRING","addParams",1114],"(",["T_STRING","Router",1114],["T_DOUBLE_COLON","::",1114],["T_STRING","parse",1114],"(",["T_VARIABLE","$url",1114],")",")",";",["T_WHITESPACE","\n        ",1114],["T_VARIABLE","$this",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","Auth",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","request",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","env",1115],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",1115],",",["T_WHITESPACE"," ",1115],["T_CONSTANT_ENCAPSED_STRING","'mariano'",1115],")",";",["T_WHITESPACE","\n        ",1115],["T_VARIABLE","$this",1116],["T_OBJECT_OPERATOR","->",1116],["T_STRING","Auth",1116],["T_OBJECT_OPERATOR","->",1116],["T_STRING","request",1116],["T_OBJECT_OPERATOR","->",1116],["T_STRING","env",1116],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",1116],",",["T_WHITESPACE"," ",1116],["T_CONSTANT_ENCAPSED_STRING","'cake'",1116],")",";",["T_WHITESPACE","\n\n        ",1116],["T_VARIABLE","$this",1118],["T_OBJECT_OPERATOR","->",1118],["T_STRING","Auth",1118],["T_OBJECT_OPERATOR","->",1118],["T_STRING","config",1118],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",1118],",",["T_WHITESPACE"," ",1118],"[",["T_WHITESPACE","\n            ",1118],["T_CONSTANT_ENCAPSED_STRING","'Basic'",1119],["T_WHITESPACE"," ",1119],["T_DOUBLE_ARROW","=>",1119],["T_WHITESPACE"," ",1119],"[",["T_CONSTANT_ENCAPSED_STRING","'userModel'",1119],["T_WHITESPACE"," ",1119],["T_DOUBLE_ARROW","=>",1119],["T_WHITESPACE"," ",1119],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",1119],"]",["T_WHITESPACE","\n        ",1119],"]",")",";",["T_WHITESPACE","\n        ",1120],["T_VARIABLE","$this",1121],["T_OBJECT_OPERATOR","->",1121],["T_STRING","Auth",1121],["T_OBJECT_OPERATOR","->",1121],["T_STRING","config",1121],"(",["T_CONSTANT_ENCAPSED_STRING","'storage'",1121],",",["T_WHITESPACE"," ",1121],["T_CONSTANT_ENCAPSED_STRING","'Memory'",1121],")",";",["T_WHITESPACE","\n        ",1121],["T_VARIABLE","$this",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","Auth",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","startup",1122],"(",["T_VARIABLE","$event",1122],")",";",["T_WHITESPACE","\n\n        ",1122],["T_VARIABLE","$result",1124],["T_WHITESPACE"," ",1124],"=",["T_WHITESPACE"," ",1124],["T_VARIABLE","$this",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","Auth",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","user",1124],"(",")",";",["T_WHITESPACE","\n        ",1124],["T_VARIABLE","$this",1125],["T_OBJECT_OPERATOR","->",1125],["T_STRING","assertEquals",1125],"(",["T_CONSTANT_ENCAPSED_STRING","'mariano'",1125],",",["T_WHITESPACE"," ",1125],["T_VARIABLE","$result",1125],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",1125],"]",")",";",["T_WHITESPACE","\n\n        ",1125],["T_VARIABLE","$this",1127],["T_OBJECT_OPERATOR","->",1127],["T_STRING","assertInstanceOf",1127],"(",["T_WHITESPACE","\n            ",1127],["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\BasicAuthenticate'",1128],",",["T_WHITESPACE","\n            ",1128],["T_VARIABLE","$this",1129],["T_OBJECT_OPERATOR","->",1129],["T_STRING","Auth",1129],["T_OBJECT_OPERATOR","->",1129],["T_STRING","authenticationProvider",1129],"(",")",["T_WHITESPACE","\n        ",1129],")",";",["T_WHITESPACE","\n\n        ",1130],["T_VARIABLE","$result",1132],["T_WHITESPACE"," ",1132],"=",["T_WHITESPACE"," ",1132],["T_VARIABLE","$this",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","Auth",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","user",1132],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",1132],")",";",["T_WHITESPACE","\n        ",1132],["T_VARIABLE","$this",1133],["T_OBJECT_OPERATOR","->",1133],["T_STRING","assertEquals",1133],"(",["T_CONSTANT_ENCAPSED_STRING","'mariano'",1133],",",["T_WHITESPACE"," ",1133],["T_VARIABLE","$result",1133],")",";",["T_WHITESPACE","\n        ",1133],["T_VARIABLE","$this",1134],["T_OBJECT_OPERATOR","->",1134],["T_STRING","assertFalse",1134],"(",["T_ISSET","isset",1134],"(",["T_VARIABLE","$_SESSION",1134],")",")",";",["T_WHITESPACE","\n    ",1134],"}",["T_WHITESPACE","\n\n    ",1135],["T_DOC_COMMENT","\/**\n     * test $settings in Controller::$components\n     *\n     * @return void\n     *\/",1137],["T_WHITESPACE","\n    ",1141],["T_PUBLIC","public",1142],["T_WHITESPACE"," ",1142],["T_FUNCTION","function",1142],["T_WHITESPACE"," ",1142],["T_STRING","testComponentSettings",1142],"(",")",["T_WHITESPACE","\n    ",1142],"{",["T_WHITESPACE","\n        ",1143],["T_VARIABLE","$this",1144],["T_OBJECT_OPERATOR","->",1144],["T_STRING","Auth",1144],["T_OBJECT_OPERATOR","->",1144],["T_STRING","config",1144],"(","[",["T_WHITESPACE","\n            ",1144],["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1145],["T_WHITESPACE"," ",1145],["T_DOUBLE_ARROW","=>",1145],["T_WHITESPACE"," ",1145],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1145],["T_WHITESPACE"," ",1145],["T_DOUBLE_ARROW","=>",1145],["T_WHITESPACE"," ",1145],["T_CONSTANT_ENCAPSED_STRING","'people'",1145],",",["T_WHITESPACE"," ",1145],["T_CONSTANT_ENCAPSED_STRING","'action'",1145],["T_WHITESPACE"," ",1145],["T_DOUBLE_ARROW","=>",1145],["T_WHITESPACE"," ",1145],["T_CONSTANT_ENCAPSED_STRING","'login'",1145],"]",",",["T_WHITESPACE","\n            ",1145],["T_CONSTANT_ENCAPSED_STRING","'logoutRedirect'",1146],["T_WHITESPACE"," ",1146],["T_DOUBLE_ARROW","=>",1146],["T_WHITESPACE"," ",1146],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1146],["T_WHITESPACE"," ",1146],["T_DOUBLE_ARROW","=>",1146],["T_WHITESPACE"," ",1146],["T_CONSTANT_ENCAPSED_STRING","'people'",1146],",",["T_WHITESPACE"," ",1146],["T_CONSTANT_ENCAPSED_STRING","'action'",1146],["T_WHITESPACE"," ",1146],["T_DOUBLE_ARROW","=>",1146],["T_WHITESPACE"," ",1146],["T_CONSTANT_ENCAPSED_STRING","'login'",1146],"]",",",["T_WHITESPACE","\n        ",1146],"]",")",";",["T_WHITESPACE","\n\n        ",1147],["T_VARIABLE","$expected",1149],["T_WHITESPACE"," ",1149],"=",["T_WHITESPACE"," ",1149],"[",["T_WHITESPACE","\n            ",1149],["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1150],["T_WHITESPACE"," ",1150],["T_DOUBLE_ARROW","=>",1150],["T_WHITESPACE"," ",1150],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1150],["T_WHITESPACE"," ",1150],["T_DOUBLE_ARROW","=>",1150],["T_WHITESPACE"," ",1150],["T_CONSTANT_ENCAPSED_STRING","'people'",1150],",",["T_WHITESPACE"," ",1150],["T_CONSTANT_ENCAPSED_STRING","'action'",1150],["T_WHITESPACE"," ",1150],["T_DOUBLE_ARROW","=>",1150],["T_WHITESPACE"," ",1150],["T_CONSTANT_ENCAPSED_STRING","'login'",1150],"]",",",["T_WHITESPACE","\n            ",1150],["T_CONSTANT_ENCAPSED_STRING","'logoutRedirect'",1151],["T_WHITESPACE"," ",1151],["T_DOUBLE_ARROW","=>",1151],["T_WHITESPACE"," ",1151],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1151],["T_WHITESPACE"," ",1151],["T_DOUBLE_ARROW","=>",1151],["T_WHITESPACE"," ",1151],["T_CONSTANT_ENCAPSED_STRING","'people'",1151],",",["T_WHITESPACE"," ",1151],["T_CONSTANT_ENCAPSED_STRING","'action'",1151],["T_WHITESPACE"," ",1151],["T_DOUBLE_ARROW","=>",1151],["T_WHITESPACE"," ",1151],["T_CONSTANT_ENCAPSED_STRING","'login'",1151],"]",",",["T_WHITESPACE","\n        ",1151],"]",";",["T_WHITESPACE","\n        ",1152],["T_VARIABLE","$this",1153],["T_OBJECT_OPERATOR","->",1153],["T_STRING","assertEquals",1153],"(",["T_WHITESPACE","\n            ",1153],["T_VARIABLE","$expected",1154],"[",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1154],"]",",",["T_WHITESPACE","\n            ",1154],["T_VARIABLE","$this",1155],["T_OBJECT_OPERATOR","->",1155],["T_STRING","Auth",1155],["T_OBJECT_OPERATOR","->",1155],["T_STRING","config",1155],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1155],")",["T_WHITESPACE","\n        ",1155],")",";",["T_WHITESPACE","\n        ",1156],["T_VARIABLE","$this",1157],["T_OBJECT_OPERATOR","->",1157],["T_STRING","assertEquals",1157],"(",["T_WHITESPACE","\n            ",1157],["T_VARIABLE","$expected",1158],"[",["T_CONSTANT_ENCAPSED_STRING","'logoutRedirect'",1158],"]",",",["T_WHITESPACE","\n            ",1158],["T_VARIABLE","$this",1159],["T_OBJECT_OPERATOR","->",1159],["T_STRING","Auth",1159],["T_OBJECT_OPERATOR","->",1159],["T_STRING","config",1159],"(",["T_CONSTANT_ENCAPSED_STRING","'logoutRedirect'",1159],")",["T_WHITESPACE","\n        ",1159],")",";",["T_WHITESPACE","\n    ",1160],"}",["T_WHITESPACE","\n\n    ",1161],["T_DOC_COMMENT","\/**\n     * test that logout deletes the session variables. and returns the correct URL\n     *\n     * @return void\n     *\/",1163],["T_WHITESPACE","\n    ",1167],["T_PUBLIC","public",1168],["T_WHITESPACE"," ",1168],["T_FUNCTION","function",1168],["T_WHITESPACE"," ",1168],["T_STRING","testLogout",1168],"(",")",["T_WHITESPACE","\n    ",1168],"{",["T_WHITESPACE","\n        ",1169],["T_VARIABLE","$this",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","Auth",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","session",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","write",1170],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.User.id'",1170],",",["T_WHITESPACE"," ",1170],["T_CONSTANT_ENCAPSED_STRING","'1'",1170],")",";",["T_WHITESPACE","\n        ",1170],["T_VARIABLE","$this",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","Auth",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","session",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","write",1171],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1171],",",["T_WHITESPACE"," ",1171],["T_CONSTANT_ENCAPSED_STRING","'\/Users\/login'",1171],")",";",["T_WHITESPACE","\n        ",1171],["T_VARIABLE","$this",1172],["T_OBJECT_OPERATOR","->",1172],["T_STRING","Auth",1172],["T_OBJECT_OPERATOR","->",1172],["T_STRING","config",1172],"(",["T_CONSTANT_ENCAPSED_STRING","'logoutRedirect'",1172],",",["T_WHITESPACE"," ",1172],["T_CONSTANT_ENCAPSED_STRING","'\/'",1172],")",";",["T_WHITESPACE","\n        ",1172],["T_VARIABLE","$result",1173],["T_WHITESPACE"," ",1173],"=",["T_WHITESPACE"," ",1173],["T_VARIABLE","$this",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","Auth",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","logout",1173],"(",")",";",["T_WHITESPACE","\n\n        ",1173],["T_VARIABLE","$this",1175],["T_OBJECT_OPERATOR","->",1175],["T_STRING","assertEquals",1175],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",1175],",",["T_WHITESPACE"," ",1175],["T_VARIABLE","$result",1175],")",";",["T_WHITESPACE","\n        ",1175],["T_VARIABLE","$this",1176],["T_OBJECT_OPERATOR","->",1176],["T_STRING","assertNull",1176],"(",["T_VARIABLE","$this",1176],["T_OBJECT_OPERATOR","->",1176],["T_STRING","Auth",1176],["T_OBJECT_OPERATOR","->",1176],["T_STRING","session",1176],["T_OBJECT_OPERATOR","->",1176],["T_STRING","read",1176],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.AuthUsers'",1176],")",")",";",["T_WHITESPACE","\n        ",1176],["T_VARIABLE","$this",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","assertNull",1177],"(",["T_VARIABLE","$this",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","Auth",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","session",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","read",1177],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1177],")",")",";",["T_WHITESPACE","\n    ",1177],"}",["T_WHITESPACE","\n\n    ",1178],["T_DOC_COMMENT","\/**\n     * Test that Auth.afterIdentify and Auth.logout events are triggered\n     *\n     * @return void\n     *\/",1180],["T_WHITESPACE","\n    ",1184],["T_PUBLIC","public",1185],["T_WHITESPACE"," ",1185],["T_FUNCTION","function",1185],["T_WHITESPACE"," ",1185],["T_STRING","testEventTriggering",1185],"(",")",["T_WHITESPACE","\n    ",1185],"{",["T_WHITESPACE","\n        ",1186],["T_VARIABLE","$this",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","Auth",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","config",1187],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",1187],",",["T_WHITESPACE"," ",1187],"[",["T_WHITESPACE","\n            ",1187],["T_CONSTANT_ENCAPSED_STRING","'Test'",1188],["T_WHITESPACE"," ",1188],["T_DOUBLE_ARROW","=>",1188],["T_WHITESPACE"," ",1188],"[",["T_CONSTANT_ENCAPSED_STRING","'className'",1188],["T_WHITESPACE"," ",1188],["T_DOUBLE_ARROW","=>",1188],["T_WHITESPACE"," ",1188],["T_CONSTANT_ENCAPSED_STRING","'TestApp\\Auth\\TestAuthenticate'",1188],"]",["T_WHITESPACE","\n        ",1188],"]",")",";",["T_WHITESPACE","\n\n        ",1189],["T_VARIABLE","$user",1191],["T_WHITESPACE"," ",1191],"=",["T_WHITESPACE"," ",1191],["T_VARIABLE","$this",1191],["T_OBJECT_OPERATOR","->",1191],["T_STRING","Auth",1191],["T_OBJECT_OPERATOR","->",1191],["T_STRING","identify",1191],"(",")",";",["T_WHITESPACE","\n        ",1191],["T_VARIABLE","$this",1192],["T_OBJECT_OPERATOR","->",1192],["T_STRING","Auth",1192],["T_OBJECT_OPERATOR","->",1192],["T_STRING","logout",1192],"(",")",";",["T_WHITESPACE","\n        ",1192],["T_VARIABLE","$authObject",1193],["T_WHITESPACE"," ",1193],"=",["T_WHITESPACE"," ",1193],["T_VARIABLE","$this",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","Auth",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","authenticationProvider",1193],"(",")",";",["T_WHITESPACE","\n\n        ",1193],["T_VARIABLE","$expected",1195],["T_WHITESPACE"," ",1195],"=",["T_WHITESPACE"," ",1195],"[",["T_CONSTANT_ENCAPSED_STRING","'afterIdentify'",1195],",",["T_WHITESPACE"," ",1195],["T_CONSTANT_ENCAPSED_STRING","'logout'",1195],"]",";",["T_WHITESPACE","\n        ",1195],["T_VARIABLE","$this",1196],["T_OBJECT_OPERATOR","->",1196],["T_STRING","assertEquals",1196],"(",["T_VARIABLE","$expected",1196],",",["T_WHITESPACE"," ",1196],["T_VARIABLE","$authObject",1196],["T_OBJECT_OPERATOR","->",1196],["T_STRING","callStack",1196],")",";",["T_WHITESPACE","\n        ",1196],["T_VARIABLE","$expected",1197],["T_WHITESPACE"," ",1197],"=",["T_WHITESPACE"," ",1197],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",1197],["T_WHITESPACE"," ",1197],["T_DOUBLE_ARROW","=>",1197],["T_WHITESPACE"," ",1197],["T_LNUMBER","1",1197],",",["T_WHITESPACE"," ",1197],["T_CONSTANT_ENCAPSED_STRING","'username'",1197],["T_WHITESPACE"," ",1197],["T_DOUBLE_ARROW","=>",1197],["T_WHITESPACE"," ",1197],["T_CONSTANT_ENCAPSED_STRING","'admad'",1197],"]",";",["T_WHITESPACE","\n        ",1197],["T_VARIABLE","$this",1198],["T_OBJECT_OPERATOR","->",1198],["T_STRING","assertEquals",1198],"(",["T_VARIABLE","$expected",1198],",",["T_WHITESPACE"," ",1198],["T_VARIABLE","$user",1198],")",";",["T_WHITESPACE","\n        ",1198],["T_VARIABLE","$this",1199],["T_OBJECT_OPERATOR","->",1199],["T_STRING","assertInstanceOf",1199],"(",["T_WHITESPACE","\n            ",1199],["T_CONSTANT_ENCAPSED_STRING","'TestApp\\Auth\\TestAuthenticate'",1200],",",["T_WHITESPACE","\n            ",1200],["T_VARIABLE","$authObject",1201],["T_OBJECT_OPERATOR","->",1201],["T_STRING","authenticationProvider",1201],["T_WHITESPACE","\n        ",1201],")",";",["T_WHITESPACE","\n\n        ",1202],["T_COMMENT","\/\/ Callback for Auth.afterIdentify returns a value\n",1204],["T_WHITESPACE","        ",1205],["T_VARIABLE","$authObject",1205],["T_OBJECT_OPERATOR","->",1205],["T_STRING","modifiedUser",1205],["T_WHITESPACE"," ",1205],"=",["T_WHITESPACE"," ",1205],["T_STRING","true",1205],";",["T_WHITESPACE","\n        ",1205],["T_VARIABLE","$user",1206],["T_WHITESPACE"," ",1206],"=",["T_WHITESPACE"," ",1206],["T_VARIABLE","$this",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","Auth",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","identify",1206],"(",")",";",["T_WHITESPACE","\n        ",1206],["T_VARIABLE","$expected",1207],["T_WHITESPACE"," ",1207],"=",["T_WHITESPACE"," ",1207],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",1207],["T_WHITESPACE"," ",1207],["T_DOUBLE_ARROW","=>",1207],["T_WHITESPACE"," ",1207],["T_LNUMBER","1",1207],",",["T_WHITESPACE"," ",1207],["T_CONSTANT_ENCAPSED_STRING","'username'",1207],["T_WHITESPACE"," ",1207],["T_DOUBLE_ARROW","=>",1207],["T_WHITESPACE"," ",1207],["T_CONSTANT_ENCAPSED_STRING","'admad'",1207],",",["T_WHITESPACE"," ",1207],["T_CONSTANT_ENCAPSED_STRING","'extra'",1207],["T_WHITESPACE"," ",1207],["T_DOUBLE_ARROW","=>",1207],["T_WHITESPACE"," ",1207],["T_CONSTANT_ENCAPSED_STRING","'foo'",1207],"]",";",["T_WHITESPACE","\n        ",1207],["T_VARIABLE","$this",1208],["T_OBJECT_OPERATOR","->",1208],["T_STRING","assertEquals",1208],"(",["T_VARIABLE","$expected",1208],",",["T_WHITESPACE"," ",1208],["T_VARIABLE","$user",1208],")",";",["T_WHITESPACE","\n    ",1208],"}",["T_WHITESPACE","\n\n    ",1209],["T_DOC_COMMENT","\/**\n     * testAfterIdentifyForStatelessAuthentication\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1211],["T_WHITESPACE","\n    ",1216],["T_PUBLIC","public",1217],["T_WHITESPACE"," ",1217],["T_FUNCTION","function",1217],["T_WHITESPACE"," ",1217],["T_STRING","testAfterIdentifyForStatelessAuthentication",1217],"(",")",["T_WHITESPACE","\n    ",1217],"{",["T_WHITESPACE","\n        ",1218],["T_VARIABLE","$event",1219],["T_WHITESPACE"," ",1219],"=",["T_WHITESPACE"," ",1219],["T_NEW","new",1219],["T_WHITESPACE"," ",1219],["T_STRING","Event",1219],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1219],",",["T_WHITESPACE"," ",1219],["T_VARIABLE","$this",1219],["T_OBJECT_OPERATOR","->",1219],["T_STRING","Controller",1219],")",";",["T_WHITESPACE","\n        ",1219],["T_VARIABLE","$url",1220],["T_WHITESPACE"," ",1220],"=",["T_WHITESPACE"," ",1220],["T_CONSTANT_ENCAPSED_STRING","'\/auth_test\/add'",1220],";",["T_WHITESPACE","\n        ",1220],["T_VARIABLE","$this",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","Auth",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","request",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","addParams",1221],"(",["T_STRING","Router",1221],["T_DOUBLE_COLON","::",1221],["T_STRING","parse",1221],"(",["T_VARIABLE","$url",1221],")",")",";",["T_WHITESPACE","\n        ",1221],["T_VARIABLE","$this",1222],["T_OBJECT_OPERATOR","->",1222],["T_STRING","Auth",1222],["T_OBJECT_OPERATOR","->",1222],["T_STRING","request",1222],["T_OBJECT_OPERATOR","->",1222],["T_STRING","env",1222],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",1222],",",["T_WHITESPACE"," ",1222],["T_CONSTANT_ENCAPSED_STRING","'mariano'",1222],")",";",["T_WHITESPACE","\n        ",1222],["T_VARIABLE","$this",1223],["T_OBJECT_OPERATOR","->",1223],["T_STRING","Auth",1223],["T_OBJECT_OPERATOR","->",1223],["T_STRING","request",1223],["T_OBJECT_OPERATOR","->",1223],["T_STRING","env",1223],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",1223],",",["T_WHITESPACE"," ",1223],["T_CONSTANT_ENCAPSED_STRING","'cake'",1223],")",";",["T_WHITESPACE","\n\n        ",1223],["T_VARIABLE","$this",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","Auth",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","config",1225],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",1225],",",["T_WHITESPACE"," ",1225],"[",["T_WHITESPACE","\n            ",1225],["T_CONSTANT_ENCAPSED_STRING","'Basic'",1226],["T_WHITESPACE"," ",1226],["T_DOUBLE_ARROW","=>",1226],["T_WHITESPACE"," ",1226],"[",["T_CONSTANT_ENCAPSED_STRING","'userModel'",1226],["T_WHITESPACE"," ",1226],["T_DOUBLE_ARROW","=>",1226],["T_WHITESPACE"," ",1226],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",1226],"]",["T_WHITESPACE","\n        ",1226],"]",")",";",["T_WHITESPACE","\n        ",1227],["T_VARIABLE","$this",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","Auth",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","config",1228],"(",["T_CONSTANT_ENCAPSED_STRING","'storage'",1228],",",["T_WHITESPACE"," ",1228],["T_CONSTANT_ENCAPSED_STRING","'Memory'",1228],")",";",["T_WHITESPACE","\n\n        ",1228],["T_STRING","EventManager",1230],["T_DOUBLE_COLON","::",1230],["T_STRING","instance",1230],"(",")",["T_OBJECT_OPERATOR","->",1230],["T_STRING","on",1230],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.afterIdentify'",1230],",",["T_WHITESPACE"," ",1230],["T_FUNCTION","function",1230],["T_WHITESPACE"," ",1230],"(",["T_VARIABLE","$event",1230],")",["T_WHITESPACE"," ",1230],"{",["T_WHITESPACE","\n            ",1230],["T_VARIABLE","$user",1231],["T_WHITESPACE"," ",1231],"=",["T_WHITESPACE"," ",1231],["T_VARIABLE","$event",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","data",1231],"[",["T_LNUMBER","0",1231],"]",";",["T_WHITESPACE","\n            ",1231],["T_VARIABLE","$user",1232],"[",["T_CONSTANT_ENCAPSED_STRING","'from_callback'",1232],"]",["T_WHITESPACE"," ",1232],"=",["T_WHITESPACE"," ",1232],["T_STRING","true",1232],";",["T_WHITESPACE","\n\n            ",1232],["T_RETURN","return",1234],["T_WHITESPACE"," ",1234],["T_VARIABLE","$user",1234],";",["T_WHITESPACE","\n        ",1234],"}",")",";",["T_WHITESPACE","\n\n        ",1235],["T_VARIABLE","$this",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","Auth",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","startup",1237],"(",["T_VARIABLE","$event",1237],")",";",["T_WHITESPACE","\n        ",1237],["T_VARIABLE","$this",1238],["T_OBJECT_OPERATOR","->",1238],["T_STRING","assertEquals",1238],"(",["T_CONSTANT_ENCAPSED_STRING","'mariano'",1238],",",["T_WHITESPACE"," ",1238],["T_VARIABLE","$this",1238],["T_OBJECT_OPERATOR","->",1238],["T_STRING","Auth",1238],["T_OBJECT_OPERATOR","->",1238],["T_STRING","user",1238],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",1238],")",")",";",["T_WHITESPACE","\n        ",1238],["T_VARIABLE","$this",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","assertTrue",1239],"(",["T_VARIABLE","$this",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","Auth",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","user",1239],"(",["T_CONSTANT_ENCAPSED_STRING","'from_callback'",1239],")",")",";",["T_WHITESPACE","\n    ",1239],"}",["T_WHITESPACE","\n\n    ",1240],["T_DOC_COMMENT","\/**\n     * test setting user info to session.\n     *\n     * @return void\n     *\/",1242],["T_WHITESPACE","\n    ",1246],["T_PUBLIC","public",1247],["T_WHITESPACE"," ",1247],["T_FUNCTION","function",1247],["T_WHITESPACE"," ",1247],["T_STRING","testSetUser",1247],"(",")",["T_WHITESPACE","\n    ",1247],"{",["T_WHITESPACE","\n        ",1248],["T_VARIABLE","$storage",1249],["T_WHITESPACE"," ",1249],"=",["T_WHITESPACE"," ",1249],["T_VARIABLE","$this",1249],["T_OBJECT_OPERATOR","->",1249],["T_STRING","getMockBuilder",1249],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\Storage\\SessionStorage'",1249],")",["T_WHITESPACE","\n            ",1249],["T_OBJECT_OPERATOR","->",1250],["T_STRING","setMethods",1250],"(","[",["T_CONSTANT_ENCAPSED_STRING","'write'",1250],"]",")",["T_WHITESPACE","\n            ",1250],["T_OBJECT_OPERATOR","->",1251],["T_STRING","setConstructorArgs",1251],"(","[",["T_VARIABLE","$this",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","Auth",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","request",1251],",",["T_WHITESPACE"," ",1251],["T_VARIABLE","$this",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","Auth",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","response",1251],"]",")",["T_WHITESPACE","\n            ",1251],["T_OBJECT_OPERATOR","->",1252],["T_STRING","getMock",1252],"(",")",";",["T_WHITESPACE","\n        ",1252],["T_VARIABLE","$this",1253],["T_OBJECT_OPERATOR","->",1253],["T_STRING","Auth",1253],["T_OBJECT_OPERATOR","->",1253],["T_STRING","storage",1253],"(",["T_VARIABLE","$storage",1253],")",";",["T_WHITESPACE","\n\n        ",1253],["T_VARIABLE","$user",1255],["T_WHITESPACE"," ",1255],"=",["T_WHITESPACE"," ",1255],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",1255],["T_WHITESPACE"," ",1255],["T_DOUBLE_ARROW","=>",1255],["T_WHITESPACE"," ",1255],["T_CONSTANT_ENCAPSED_STRING","'mark'",1255],",",["T_WHITESPACE"," ",1255],["T_CONSTANT_ENCAPSED_STRING","'role'",1255],["T_WHITESPACE"," ",1255],["T_DOUBLE_ARROW","=>",1255],["T_WHITESPACE"," ",1255],["T_CONSTANT_ENCAPSED_STRING","'admin'",1255],"]",";",["T_WHITESPACE","\n\n        ",1255],["T_VARIABLE","$storage",1257],["T_OBJECT_OPERATOR","->",1257],["T_STRING","expects",1257],"(",["T_VARIABLE","$this",1257],["T_OBJECT_OPERATOR","->",1257],["T_STRING","once",1257],"(",")",")",["T_WHITESPACE","\n            ",1257],["T_OBJECT_OPERATOR","->",1258],["T_STRING","method",1258],"(",["T_CONSTANT_ENCAPSED_STRING","'write'",1258],")",["T_WHITESPACE","\n            ",1258],["T_OBJECT_OPERATOR","->",1259],["T_STRING","with",1259],"(",["T_VARIABLE","$user",1259],")",";",["T_WHITESPACE","\n\n        ",1259],["T_VARIABLE","$this",1261],["T_OBJECT_OPERATOR","->",1261],["T_STRING","Auth",1261],["T_OBJECT_OPERATOR","->",1261],["T_STRING","setUser",1261],"(",["T_VARIABLE","$user",1261],")",";",["T_WHITESPACE","\n    ",1261],"}",["T_WHITESPACE","\n\n    ",1262],["T_DOC_COMMENT","\/**\n     * testGettingUserAfterSetUser\n     *\n     * @return void\n     *\/",1264],["T_WHITESPACE","\n    ",1268],["T_PUBLIC","public",1269],["T_WHITESPACE"," ",1269],["T_FUNCTION","function",1269],["T_WHITESPACE"," ",1269],["T_STRING","testGettingUserAfterSetUser",1269],"(",")",["T_WHITESPACE","\n    ",1269],"{",["T_WHITESPACE","\n        ",1270],["T_VARIABLE","$this",1271],["T_OBJECT_OPERATOR","->",1271],["T_STRING","assertFalse",1271],"(",["T_BOOL_CAST","(bool)",1271],["T_VARIABLE","$this",1271],["T_OBJECT_OPERATOR","->",1271],["T_STRING","Auth",1271],["T_OBJECT_OPERATOR","->",1271],["T_STRING","user",1271],"(",")",")",";",["T_WHITESPACE","\n\n        ",1271],["T_VARIABLE","$user",1273],["T_WHITESPACE"," ",1273],"=",["T_WHITESPACE"," ",1273],"[",["T_WHITESPACE","\n            ",1273],["T_CONSTANT_ENCAPSED_STRING","'username'",1274],["T_WHITESPACE"," ",1274],["T_DOUBLE_ARROW","=>",1274],["T_WHITESPACE"," ",1274],["T_CONSTANT_ENCAPSED_STRING","'mariano'",1274],",",["T_WHITESPACE","\n            ",1274],["T_CONSTANT_ENCAPSED_STRING","'password'",1275],["T_WHITESPACE"," ",1275],["T_DOUBLE_ARROW","=>",1275],["T_WHITESPACE"," ",1275],["T_CONSTANT_ENCAPSED_STRING","'$2a$10$u05j8FjsvLBNdfhBhc21LOuVMpzpabVXQ9OpC2wO3pSO0q6t7HHMO'",1275],",",["T_WHITESPACE","\n            ",1275],["T_CONSTANT_ENCAPSED_STRING","'created'",1276],["T_WHITESPACE"," ",1276],["T_DOUBLE_ARROW","=>",1276],["T_WHITESPACE"," ",1276],["T_NEW","new",1276],["T_WHITESPACE"," ",1276],["T_NS_SEPARATOR","\\",1276],["T_STRING","DateTime",1276],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",1276],")",",",["T_WHITESPACE","\n            ",1276],["T_CONSTANT_ENCAPSED_STRING","'updated'",1277],["T_WHITESPACE"," ",1277],["T_DOUBLE_ARROW","=>",1277],["T_WHITESPACE"," ",1277],["T_NEW","new",1277],["T_WHITESPACE"," ",1277],["T_NS_SEPARATOR","\\",1277],["T_STRING","DateTime",1277],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",1277],")",["T_WHITESPACE","\n        ",1277],"]",";",["T_WHITESPACE","\n        ",1278],["T_VARIABLE","$this",1279],["T_OBJECT_OPERATOR","->",1279],["T_STRING","Auth",1279],["T_OBJECT_OPERATOR","->",1279],["T_STRING","setUser",1279],"(",["T_VARIABLE","$user",1279],")",";",["T_WHITESPACE","\n        ",1279],["T_VARIABLE","$this",1280],["T_OBJECT_OPERATOR","->",1280],["T_STRING","assertTrue",1280],"(",["T_BOOL_CAST","(bool)",1280],["T_VARIABLE","$this",1280],["T_OBJECT_OPERATOR","->",1280],["T_STRING","Auth",1280],["T_OBJECT_OPERATOR","->",1280],["T_STRING","user",1280],"(",")",")",";",["T_WHITESPACE","\n        ",1280],["T_VARIABLE","$this",1281],["T_OBJECT_OPERATOR","->",1281],["T_STRING","assertEquals",1281],"(",["T_VARIABLE","$user",1281],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",1281],"]",",",["T_WHITESPACE"," ",1281],["T_VARIABLE","$this",1281],["T_OBJECT_OPERATOR","->",1281],["T_STRING","Auth",1281],["T_OBJECT_OPERATOR","->",1281],["T_STRING","user",1281],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",1281],")",")",";",["T_WHITESPACE","\n    ",1281],"}",["T_WHITESPACE","\n\n    ",1282],["T_DOC_COMMENT","\/**\n     * test flash settings.\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller)\n     *\/",1284],["T_WHITESPACE","\n    ",1289],["T_PUBLIC","public",1290],["T_WHITESPACE"," ",1290],["T_FUNCTION","function",1290],["T_WHITESPACE"," ",1290],["T_STRING","testFlashSettings",1290],"(",")",["T_WHITESPACE","\n    ",1290],"{",["T_WHITESPACE","\n        ",1291],["T_VARIABLE","$this",1292],["T_OBJECT_OPERATOR","->",1292],["T_STRING","Auth",1292],["T_OBJECT_OPERATOR","->",1292],["T_STRING","Flash",1292],["T_WHITESPACE"," ",1292],"=",["T_WHITESPACE"," ",1292],["T_VARIABLE","$this",1292],["T_OBJECT_OPERATOR","->",1292],["T_STRING","getMockBuilder",1292],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Controller\\Component\\FlashComponent'",1292],")",["T_WHITESPACE","\n            ",1292],["T_OBJECT_OPERATOR","->",1293],["T_STRING","setConstructorArgs",1293],"(","[",["T_VARIABLE","$this",1293],["T_OBJECT_OPERATOR","->",1293],["T_STRING","Controller",1293],["T_OBJECT_OPERATOR","->",1293],["T_STRING","components",1293],"(",")","]",")",["T_WHITESPACE","\n            ",1293],["T_OBJECT_OPERATOR","->",1294],["T_STRING","getMock",1294],"(",")",";",["T_WHITESPACE","\n        ",1294],["T_VARIABLE","$this",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","Controller",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","request",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","params",1295],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",1295],"]",["T_WHITESPACE"," ",1295],"=",["T_WHITESPACE"," ",1295],["T_CONSTANT_ENCAPSED_STRING","'add'",1295],";",["T_WHITESPACE","\n        ",1295],["T_VARIABLE","$this",1296],["T_OBJECT_OPERATOR","->",1296],["T_STRING","Auth",1296],["T_OBJECT_OPERATOR","->",1296],["T_STRING","startup",1296],"(",["T_NEW","new",1296],["T_WHITESPACE"," ",1296],["T_STRING","Event",1296],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1296],",",["T_WHITESPACE"," ",1296],["T_VARIABLE","$this",1296],["T_OBJECT_OPERATOR","->",1296],["T_STRING","Controller",1296],")",")",";",["T_WHITESPACE","\n\n        ",1296],["T_VARIABLE","$this",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","Auth",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","Flash",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","expects",1298],"(",["T_VARIABLE","$this",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","at",1298],"(",["T_LNUMBER","0",1298],")",")",["T_WHITESPACE","\n            ",1298],["T_OBJECT_OPERATOR","->",1299],["T_STRING","method",1299],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",1299],")",["T_WHITESPACE","\n            ",1299],["T_OBJECT_OPERATOR","->",1300],["T_STRING","with",1300],"(",["T_WHITESPACE","\n                ",1300],["T_CONSTANT_ENCAPSED_STRING","'Auth failure'",1301],",",["T_WHITESPACE","\n                ",1301],"[",["T_WHITESPACE","\n                    ",1302],["T_CONSTANT_ENCAPSED_STRING","'key'",1303],["T_WHITESPACE"," ",1303],["T_DOUBLE_ARROW","=>",1303],["T_WHITESPACE"," ",1303],["T_CONSTANT_ENCAPSED_STRING","'auth-key'",1303],",",["T_WHITESPACE","\n                    ",1303],["T_CONSTANT_ENCAPSED_STRING","'element'",1304],["T_WHITESPACE"," ",1304],["T_DOUBLE_ARROW","=>",1304],["T_WHITESPACE"," ",1304],["T_CONSTANT_ENCAPSED_STRING","'default'",1304],",",["T_WHITESPACE","\n                    ",1304],["T_CONSTANT_ENCAPSED_STRING","'params'",1305],["T_WHITESPACE"," ",1305],["T_DOUBLE_ARROW","=>",1305],["T_WHITESPACE"," ",1305],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",1305],["T_WHITESPACE"," ",1305],["T_DOUBLE_ARROW","=>",1305],["T_WHITESPACE"," ",1305],["T_CONSTANT_ENCAPSED_STRING","'error'",1305],"]",["T_WHITESPACE","\n                ",1305],"]",["T_WHITESPACE","\n            ",1306],")",";",["T_WHITESPACE","\n\n        ",1307],["T_VARIABLE","$this",1309],["T_OBJECT_OPERATOR","->",1309],["T_STRING","Auth",1309],["T_OBJECT_OPERATOR","->",1309],["T_STRING","Flash",1309],["T_OBJECT_OPERATOR","->",1309],["T_STRING","expects",1309],"(",["T_VARIABLE","$this",1309],["T_OBJECT_OPERATOR","->",1309],["T_STRING","at",1309],"(",["T_LNUMBER","1",1309],")",")",["T_WHITESPACE","\n            ",1309],["T_OBJECT_OPERATOR","->",1310],["T_STRING","method",1310],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",1310],")",["T_WHITESPACE","\n            ",1310],["T_OBJECT_OPERATOR","->",1311],["T_STRING","with",1311],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth failure'",1311],",",["T_WHITESPACE"," ",1311],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",1311],["T_WHITESPACE"," ",1311],["T_DOUBLE_ARROW","=>",1311],["T_WHITESPACE"," ",1311],["T_CONSTANT_ENCAPSED_STRING","'auth-key'",1311],",",["T_WHITESPACE"," ",1311],["T_CONSTANT_ENCAPSED_STRING","'element'",1311],["T_WHITESPACE"," ",1311],["T_DOUBLE_ARROW","=>",1311],["T_WHITESPACE"," ",1311],["T_CONSTANT_ENCAPSED_STRING","'custom'",1311],"]",")",";",["T_WHITESPACE","\n\n        ",1311],["T_VARIABLE","$this",1313],["T_OBJECT_OPERATOR","->",1313],["T_STRING","Auth",1313],["T_OBJECT_OPERATOR","->",1313],["T_STRING","config",1313],"(",["T_CONSTANT_ENCAPSED_STRING","'flash'",1313],",",["T_WHITESPACE"," ",1313],"[",["T_WHITESPACE","\n            ",1313],["T_CONSTANT_ENCAPSED_STRING","'key'",1314],["T_WHITESPACE"," ",1314],["T_DOUBLE_ARROW","=>",1314],["T_WHITESPACE"," ",1314],["T_CONSTANT_ENCAPSED_STRING","'auth-key'",1314],["T_WHITESPACE","\n        ",1314],"]",")",";",["T_WHITESPACE","\n        ",1315],["T_VARIABLE","$this",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","Auth",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","flash",1316],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth failure'",1316],")",";",["T_WHITESPACE","\n\n        ",1316],["T_VARIABLE","$this",1318],["T_OBJECT_OPERATOR","->",1318],["T_STRING","Auth",1318],["T_OBJECT_OPERATOR","->",1318],["T_STRING","config",1318],"(",["T_CONSTANT_ENCAPSED_STRING","'flash'",1318],",",["T_WHITESPACE"," ",1318],"[",["T_WHITESPACE","\n            ",1318],["T_CONSTANT_ENCAPSED_STRING","'key'",1319],["T_WHITESPACE"," ",1319],["T_DOUBLE_ARROW","=>",1319],["T_WHITESPACE"," ",1319],["T_CONSTANT_ENCAPSED_STRING","'auth-key'",1319],",",["T_WHITESPACE","\n            ",1319],["T_CONSTANT_ENCAPSED_STRING","'element'",1320],["T_WHITESPACE"," ",1320],["T_DOUBLE_ARROW","=>",1320],["T_WHITESPACE"," ",1320],["T_CONSTANT_ENCAPSED_STRING","'custom'",1320],["T_WHITESPACE","\n        ",1320],"]",",",["T_WHITESPACE"," ",1321],["T_STRING","false",1321],")",";",["T_WHITESPACE","\n        ",1321],["T_VARIABLE","$this",1322],["T_OBJECT_OPERATOR","->",1322],["T_STRING","Auth",1322],["T_OBJECT_OPERATOR","->",1322],["T_STRING","flash",1322],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth failure'",1322],")",";",["T_WHITESPACE","\n    ",1322],"}",["T_WHITESPACE","\n\n    ",1323],["T_DOC_COMMENT","\/**\n     * test the various states of Auth::redirect()\n     *\n     * @return void\n     *\/",1325],["T_WHITESPACE","\n    ",1329],["T_PUBLIC","public",1330],["T_WHITESPACE"," ",1330],["T_FUNCTION","function",1330],["T_WHITESPACE"," ",1330],["T_STRING","testRedirectSet",1330],"(",")",["T_WHITESPACE","\n    ",1330],"{",["T_WHITESPACE","\n        ",1331],["T_VARIABLE","$value",1332],["T_WHITESPACE"," ",1332],"=",["T_WHITESPACE"," ",1332],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1332],["T_WHITESPACE"," ",1332],["T_DOUBLE_ARROW","=>",1332],["T_WHITESPACE"," ",1332],["T_CONSTANT_ENCAPSED_STRING","'users'",1332],",",["T_WHITESPACE"," ",1332],["T_CONSTANT_ENCAPSED_STRING","'action'",1332],["T_WHITESPACE"," ",1332],["T_DOUBLE_ARROW","=>",1332],["T_WHITESPACE"," ",1332],["T_CONSTANT_ENCAPSED_STRING","'home'",1332],"]",";",["T_WHITESPACE","\n        ",1332],["T_VARIABLE","$result",1333],["T_WHITESPACE"," ",1333],"=",["T_WHITESPACE"," ",1333],["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","Auth",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","redirectUrl",1333],"(",["T_VARIABLE","$value",1333],")",";",["T_WHITESPACE","\n        ",1333],["T_VARIABLE","$this",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","assertEquals",1334],"(",["T_CONSTANT_ENCAPSED_STRING","'\/users\/home'",1334],",",["T_WHITESPACE"," ",1334],["T_VARIABLE","$result",1334],")",";",["T_WHITESPACE","\n        ",1334],["T_VARIABLE","$this",1335],["T_OBJECT_OPERATOR","->",1335],["T_STRING","assertEquals",1335],"(",["T_VARIABLE","$value",1335],",",["T_WHITESPACE"," ",1335],["T_VARIABLE","$this",1335],["T_OBJECT_OPERATOR","->",1335],["T_STRING","Auth",1335],["T_OBJECT_OPERATOR","->",1335],["T_STRING","session",1335],["T_OBJECT_OPERATOR","->",1335],["T_STRING","read",1335],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1335],")",")",";",["T_WHITESPACE","\n\n        ",1335],["T_VARIABLE","$request",1337],["T_WHITESPACE"," ",1337],"=",["T_WHITESPACE"," ",1337],["T_NEW","new",1337],["T_WHITESPACE"," ",1337],["T_STRING","Request",1337],"(",")",";",["T_WHITESPACE","\n        ",1337],["T_VARIABLE","$request",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","base",1338],["T_WHITESPACE"," ",1338],"=",["T_WHITESPACE"," ",1338],["T_CONSTANT_ENCAPSED_STRING","'\/base'",1338],";",["T_WHITESPACE","\n        ",1338],["T_STRING","Router",1339],["T_DOUBLE_COLON","::",1339],["T_STRING","setRequestInfo",1339],"(",["T_VARIABLE","$request",1339],")",";",["T_WHITESPACE","\n\n        ",1339],["T_VARIABLE","$result",1341],["T_WHITESPACE"," ",1341],"=",["T_WHITESPACE"," ",1341],["T_VARIABLE","$this",1341],["T_OBJECT_OPERATOR","->",1341],["T_STRING","Auth",1341],["T_OBJECT_OPERATOR","->",1341],["T_STRING","redirectUrl",1341],"(",["T_VARIABLE","$value",1341],")",";",["T_WHITESPACE","\n        ",1341],["T_VARIABLE","$this",1342],["T_OBJECT_OPERATOR","->",1342],["T_STRING","assertEquals",1342],"(",["T_CONSTANT_ENCAPSED_STRING","'\/users\/home'",1342],",",["T_WHITESPACE"," ",1342],["T_VARIABLE","$result",1342],")",";",["T_WHITESPACE","\n    ",1342],"}",["T_WHITESPACE","\n\n    ",1343],["T_DOC_COMMENT","\/**\n     * test redirect using Auth.redirect from the session.\n     *\n     * @return void\n     *\/",1345],["T_WHITESPACE","\n    ",1349],["T_PUBLIC","public",1350],["T_WHITESPACE"," ",1350],["T_FUNCTION","function",1350],["T_WHITESPACE"," ",1350],["T_STRING","testRedirectSessionRead",1350],"(",")",["T_WHITESPACE","\n    ",1350],"{",["T_WHITESPACE","\n        ",1351],["T_VARIABLE","$this",1352],["T_OBJECT_OPERATOR","->",1352],["T_STRING","Auth",1352],["T_OBJECT_OPERATOR","->",1352],["T_STRING","config",1352],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1352],",",["T_WHITESPACE"," ",1352],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1352],["T_WHITESPACE"," ",1352],["T_DOUBLE_ARROW","=>",1352],["T_WHITESPACE"," ",1352],["T_CONSTANT_ENCAPSED_STRING","'users'",1352],",",["T_WHITESPACE"," ",1352],["T_CONSTANT_ENCAPSED_STRING","'action'",1352],["T_WHITESPACE"," ",1352],["T_DOUBLE_ARROW","=>",1352],["T_WHITESPACE"," ",1352],["T_CONSTANT_ENCAPSED_STRING","'login'",1352],"]",")",";",["T_WHITESPACE","\n        ",1352],["T_VARIABLE","$this",1353],["T_OBJECT_OPERATOR","->",1353],["T_STRING","Auth",1353],["T_OBJECT_OPERATOR","->",1353],["T_STRING","session",1353],["T_OBJECT_OPERATOR","->",1353],["T_STRING","write",1353],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1353],",",["T_WHITESPACE"," ",1353],["T_CONSTANT_ENCAPSED_STRING","'\/users\/home'",1353],")",";",["T_WHITESPACE","\n\n        ",1353],["T_VARIABLE","$result",1355],["T_WHITESPACE"," ",1355],"=",["T_WHITESPACE"," ",1355],["T_VARIABLE","$this",1355],["T_OBJECT_OPERATOR","->",1355],["T_STRING","Auth",1355],["T_OBJECT_OPERATOR","->",1355],["T_STRING","redirectUrl",1355],"(",")",";",["T_WHITESPACE","\n        ",1355],["T_VARIABLE","$this",1356],["T_OBJECT_OPERATOR","->",1356],["T_STRING","assertEquals",1356],"(",["T_CONSTANT_ENCAPSED_STRING","'\/users\/home'",1356],",",["T_WHITESPACE"," ",1356],["T_VARIABLE","$result",1356],")",";",["T_WHITESPACE","\n        ",1356],["T_VARIABLE","$this",1357],["T_OBJECT_OPERATOR","->",1357],["T_STRING","assertFalse",1357],"(",["T_VARIABLE","$this",1357],["T_OBJECT_OPERATOR","->",1357],["T_STRING","Auth",1357],["T_OBJECT_OPERATOR","->",1357],["T_STRING","session",1357],["T_OBJECT_OPERATOR","->",1357],["T_STRING","check",1357],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1357],")",")",";",["T_WHITESPACE","\n    ",1357],"}",["T_WHITESPACE","\n\n    ",1358],["T_DOC_COMMENT","\/**\n     * test redirectUrl with duplicate base.\n     *\n     * @return void\n     *\/",1360],["T_WHITESPACE","\n    ",1364],["T_PUBLIC","public",1365],["T_WHITESPACE"," ",1365],["T_FUNCTION","function",1365],["T_WHITESPACE"," ",1365],["T_STRING","testRedirectSessionReadDuplicateBase",1365],"(",")",["T_WHITESPACE","\n    ",1365],"{",["T_WHITESPACE","\n        ",1366],["T_VARIABLE","$this",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","Auth",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","request",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","webroot",1367],["T_WHITESPACE"," ",1367],"=",["T_WHITESPACE"," ",1367],["T_CONSTANT_ENCAPSED_STRING","'\/waves\/'",1367],";",["T_WHITESPACE","\n        ",1367],["T_VARIABLE","$this",1368],["T_OBJECT_OPERATOR","->",1368],["T_STRING","Auth",1368],["T_OBJECT_OPERATOR","->",1368],["T_STRING","request",1368],["T_OBJECT_OPERATOR","->",1368],["T_STRING","base",1368],["T_WHITESPACE"," ",1368],"=",["T_WHITESPACE"," ",1368],["T_CONSTANT_ENCAPSED_STRING","'\/waves'",1368],";",["T_WHITESPACE","\n\n        ",1368],["T_STRING","Router",1370],["T_DOUBLE_COLON","::",1370],["T_STRING","setRequestInfo",1370],"(",["T_VARIABLE","$this",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","Auth",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","request",1370],")",";",["T_WHITESPACE","\n\n        ",1370],["T_VARIABLE","$this",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","Auth",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","session",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","write",1372],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1372],",",["T_WHITESPACE"," ",1372],["T_CONSTANT_ENCAPSED_STRING","'\/waves\/add'",1372],")",";",["T_WHITESPACE","\n\n        ",1372],["T_VARIABLE","$result",1374],["T_WHITESPACE"," ",1374],"=",["T_WHITESPACE"," ",1374],["T_VARIABLE","$this",1374],["T_OBJECT_OPERATOR","->",1374],["T_STRING","Auth",1374],["T_OBJECT_OPERATOR","->",1374],["T_STRING","redirectUrl",1374],"(",")",";",["T_WHITESPACE","\n        ",1374],["T_VARIABLE","$this",1375],["T_OBJECT_OPERATOR","->",1375],["T_STRING","assertEquals",1375],"(",["T_CONSTANT_ENCAPSED_STRING","'\/waves\/add'",1375],",",["T_WHITESPACE"," ",1375],["T_VARIABLE","$result",1375],")",";",["T_WHITESPACE","\n    ",1375],"}",["T_WHITESPACE","\n\n    ",1376],["T_DOC_COMMENT","\/**\n     * test that redirect does not return loginAction if that is what's stored in Auth.redirect.\n     * instead loginRedirect should be used.\n     *\n     * @return void\n     *\/",1378],["T_WHITESPACE","\n    ",1383],["T_PUBLIC","public",1384],["T_WHITESPACE"," ",1384],["T_FUNCTION","function",1384],["T_WHITESPACE"," ",1384],["T_STRING","testRedirectSessionReadEqualToLoginAction",1384],"(",")",["T_WHITESPACE","\n    ",1384],"{",["T_WHITESPACE","\n        ",1385],["T_VARIABLE","$this",1386],["T_OBJECT_OPERATOR","->",1386],["T_STRING","Auth",1386],["T_OBJECT_OPERATOR","->",1386],["T_STRING","config",1386],"(","[",["T_WHITESPACE","\n            ",1386],["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1387],["T_WHITESPACE"," ",1387],["T_DOUBLE_ARROW","=>",1387],["T_WHITESPACE"," ",1387],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1387],["T_WHITESPACE"," ",1387],["T_DOUBLE_ARROW","=>",1387],["T_WHITESPACE"," ",1387],["T_CONSTANT_ENCAPSED_STRING","'users'",1387],",",["T_WHITESPACE"," ",1387],["T_CONSTANT_ENCAPSED_STRING","'action'",1387],["T_WHITESPACE"," ",1387],["T_DOUBLE_ARROW","=>",1387],["T_WHITESPACE"," ",1387],["T_CONSTANT_ENCAPSED_STRING","'login'",1387],"]",",",["T_WHITESPACE","\n            ",1387],["T_CONSTANT_ENCAPSED_STRING","'loginRedirect'",1388],["T_WHITESPACE"," ",1388],["T_DOUBLE_ARROW","=>",1388],["T_WHITESPACE"," ",1388],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1388],["T_WHITESPACE"," ",1388],["T_DOUBLE_ARROW","=>",1388],["T_WHITESPACE"," ",1388],["T_CONSTANT_ENCAPSED_STRING","'users'",1388],",",["T_WHITESPACE"," ",1388],["T_CONSTANT_ENCAPSED_STRING","'action'",1388],["T_WHITESPACE"," ",1388],["T_DOUBLE_ARROW","=>",1388],["T_WHITESPACE"," ",1388],["T_CONSTANT_ENCAPSED_STRING","'home'",1388],"]",["T_WHITESPACE","\n        ",1388],"]",")",";",["T_WHITESPACE","\n        ",1389],["T_VARIABLE","$this",1390],["T_OBJECT_OPERATOR","->",1390],["T_STRING","Auth",1390],["T_OBJECT_OPERATOR","->",1390],["T_STRING","session",1390],["T_OBJECT_OPERATOR","->",1390],["T_STRING","write",1390],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1390],",",["T_WHITESPACE"," ",1390],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1390],["T_WHITESPACE"," ",1390],["T_DOUBLE_ARROW","=>",1390],["T_WHITESPACE"," ",1390],["T_CONSTANT_ENCAPSED_STRING","'users'",1390],",",["T_WHITESPACE"," ",1390],["T_CONSTANT_ENCAPSED_STRING","'action'",1390],["T_WHITESPACE"," ",1390],["T_DOUBLE_ARROW","=>",1390],["T_WHITESPACE"," ",1390],["T_CONSTANT_ENCAPSED_STRING","'login'",1390],"]",")",";",["T_WHITESPACE","\n\n        ",1390],["T_VARIABLE","$result",1392],["T_WHITESPACE"," ",1392],"=",["T_WHITESPACE"," ",1392],["T_VARIABLE","$this",1392],["T_OBJECT_OPERATOR","->",1392],["T_STRING","Auth",1392],["T_OBJECT_OPERATOR","->",1392],["T_STRING","redirectUrl",1392],"(",")",";",["T_WHITESPACE","\n        ",1392],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","assertEquals",1393],"(",["T_CONSTANT_ENCAPSED_STRING","'\/users\/home'",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$result",1393],")",";",["T_WHITESPACE","\n        ",1393],["T_VARIABLE","$this",1394],["T_OBJECT_OPERATOR","->",1394],["T_STRING","assertFalse",1394],"(",["T_VARIABLE","$this",1394],["T_OBJECT_OPERATOR","->",1394],["T_STRING","Auth",1394],["T_OBJECT_OPERATOR","->",1394],["T_STRING","session",1394],["T_OBJECT_OPERATOR","->",1394],["T_STRING","check",1394],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1394],")",")",";",["T_WHITESPACE","\n    ",1394],"}",["T_WHITESPACE","\n\n    ",1395],["T_DOC_COMMENT","\/**\n     * test that the returned URL doesn't contain the base URL.\n     *\n     * @return void This test method doesn't return anything.\n     *\/",1397],["T_WHITESPACE","\n    ",1401],["T_PUBLIC","public",1402],["T_WHITESPACE"," ",1402],["T_FUNCTION","function",1402],["T_WHITESPACE"," ",1402],["T_STRING","testRedirectUrlWithBaseSet",1402],"(",")",["T_WHITESPACE","\n    ",1402],"{",["T_WHITESPACE","\n        ",1403],["T_VARIABLE","$App",1404],["T_WHITESPACE"," ",1404],"=",["T_WHITESPACE"," ",1404],["T_STRING","Configure",1404],["T_DOUBLE_COLON","::",1404],["T_STRING","read",1404],"(",["T_CONSTANT_ENCAPSED_STRING","'App'",1404],")",";",["T_WHITESPACE","\n\n        ",1404],["T_STRING","Configure",1406],["T_DOUBLE_COLON","::",1406],["T_STRING","write",1406],"(",["T_CONSTANT_ENCAPSED_STRING","'App'",1406],",",["T_WHITESPACE"," ",1406],"[",["T_WHITESPACE","\n            ",1406],["T_CONSTANT_ENCAPSED_STRING","'dir'",1407],["T_WHITESPACE"," ",1407],["T_DOUBLE_ARROW","=>",1407],["T_WHITESPACE"," ",1407],["T_STRING","APP_DIR",1407],",",["T_WHITESPACE","\n            ",1407],["T_CONSTANT_ENCAPSED_STRING","'webroot'",1408],["T_WHITESPACE"," ",1408],["T_DOUBLE_ARROW","=>",1408],["T_WHITESPACE"," ",1408],["T_CONSTANT_ENCAPSED_STRING","'webroot'",1408],",",["T_WHITESPACE","\n            ",1408],["T_CONSTANT_ENCAPSED_STRING","'base'",1409],["T_WHITESPACE"," ",1409],["T_DOUBLE_ARROW","=>",1409],["T_WHITESPACE"," ",1409],["T_STRING","false",1409],",",["T_WHITESPACE","\n            ",1409],["T_CONSTANT_ENCAPSED_STRING","'baseUrl'",1410],["T_WHITESPACE"," ",1410],["T_DOUBLE_ARROW","=>",1410],["T_WHITESPACE"," ",1410],["T_CONSTANT_ENCAPSED_STRING","'\/cake\/index.php'",1410],["T_WHITESPACE","\n        ",1410],"]",")",";",["T_WHITESPACE","\n\n        ",1411],["T_VARIABLE","$url",1413],["T_WHITESPACE"," ",1413],"=",["T_WHITESPACE"," ",1413],["T_CONSTANT_ENCAPSED_STRING","'\/users\/login'",1413],";",["T_WHITESPACE","\n        ",1413],["T_VARIABLE","$this",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","Auth",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","request",1414],["T_WHITESPACE"," ",1414],"=",["T_WHITESPACE"," ",1414],["T_VARIABLE","$this",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","Controller",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","request",1414],["T_WHITESPACE"," ",1414],"=",["T_WHITESPACE"," ",1414],["T_NEW","new",1414],["T_WHITESPACE"," ",1414],["T_STRING","Request",1414],"(",["T_VARIABLE","$url",1414],")",";",["T_WHITESPACE","\n        ",1414],["T_VARIABLE","$this",1415],["T_OBJECT_OPERATOR","->",1415],["T_STRING","Auth",1415],["T_OBJECT_OPERATOR","->",1415],["T_STRING","request",1415],["T_OBJECT_OPERATOR","->",1415],["T_STRING","addParams",1415],"(",["T_STRING","Router",1415],["T_DOUBLE_COLON","::",1415],["T_STRING","parse",1415],"(",["T_VARIABLE","$url",1415],")",")",";",["T_WHITESPACE","\n        ",1415],["T_VARIABLE","$this",1416],["T_OBJECT_OPERATOR","->",1416],["T_STRING","Auth",1416],["T_OBJECT_OPERATOR","->",1416],["T_STRING","request",1416],["T_OBJECT_OPERATOR","->",1416],["T_STRING","url",1416],["T_WHITESPACE"," ",1416],"=",["T_WHITESPACE"," ",1416],["T_STRING","Router",1416],["T_DOUBLE_COLON","::",1416],["T_STRING","normalize",1416],"(",["T_VARIABLE","$url",1416],")",";",["T_WHITESPACE","\n\n        ",1416],["T_STRING","Router",1418],["T_DOUBLE_COLON","::",1418],["T_STRING","setRequestInfo",1418],"(",["T_VARIABLE","$this",1418],["T_OBJECT_OPERATOR","->",1418],["T_STRING","Auth",1418],["T_OBJECT_OPERATOR","->",1418],["T_STRING","request",1418],")",";",["T_WHITESPACE","\n\n        ",1418],["T_VARIABLE","$this",1420],["T_OBJECT_OPERATOR","->",1420],["T_STRING","Auth",1420],["T_OBJECT_OPERATOR","->",1420],["T_STRING","config",1420],"(",["T_CONSTANT_ENCAPSED_STRING","'loginAction'",1420],",",["T_WHITESPACE"," ",1420],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1420],["T_WHITESPACE"," ",1420],["T_DOUBLE_ARROW","=>",1420],["T_WHITESPACE"," ",1420],["T_CONSTANT_ENCAPSED_STRING","'users'",1420],",",["T_WHITESPACE"," ",1420],["T_CONSTANT_ENCAPSED_STRING","'action'",1420],["T_WHITESPACE"," ",1420],["T_DOUBLE_ARROW","=>",1420],["T_WHITESPACE"," ",1420],["T_CONSTANT_ENCAPSED_STRING","'login'",1420],"]",")",";",["T_WHITESPACE","\n        ",1420],["T_VARIABLE","$this",1421],["T_OBJECT_OPERATOR","->",1421],["T_STRING","Auth",1421],["T_OBJECT_OPERATOR","->",1421],["T_STRING","config",1421],"(",["T_CONSTANT_ENCAPSED_STRING","'loginRedirect'",1421],",",["T_WHITESPACE"," ",1421],"[",["T_CONSTANT_ENCAPSED_STRING","'controller'",1421],["T_WHITESPACE"," ",1421],["T_DOUBLE_ARROW","=>",1421],["T_WHITESPACE"," ",1421],["T_CONSTANT_ENCAPSED_STRING","'users'",1421],",",["T_WHITESPACE"," ",1421],["T_CONSTANT_ENCAPSED_STRING","'action'",1421],["T_WHITESPACE"," ",1421],["T_DOUBLE_ARROW","=>",1421],["T_WHITESPACE"," ",1421],["T_CONSTANT_ENCAPSED_STRING","'home'",1421],"]",")",";",["T_WHITESPACE","\n\n        ",1421],["T_VARIABLE","$result",1423],["T_WHITESPACE"," ",1423],"=",["T_WHITESPACE"," ",1423],["T_VARIABLE","$this",1423],["T_OBJECT_OPERATOR","->",1423],["T_STRING","Auth",1423],["T_OBJECT_OPERATOR","->",1423],["T_STRING","redirectUrl",1423],"(",")",";",["T_WHITESPACE","\n        ",1423],["T_VARIABLE","$this",1424],["T_OBJECT_OPERATOR","->",1424],["T_STRING","assertEquals",1424],"(",["T_CONSTANT_ENCAPSED_STRING","'\/users\/home'",1424],",",["T_WHITESPACE"," ",1424],["T_VARIABLE","$result",1424],")",";",["T_WHITESPACE","\n        ",1424],["T_VARIABLE","$this",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","assertFalse",1425],"(",["T_VARIABLE","$this",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","Auth",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","session",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","check",1425],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.redirect'",1425],")",")",";",["T_WHITESPACE","\n\n        ",1425],["T_STRING","Configure",1427],["T_DOUBLE_COLON","::",1427],["T_STRING","write",1427],"(",["T_CONSTANT_ENCAPSED_STRING","'App'",1427],",",["T_WHITESPACE"," ",1427],["T_VARIABLE","$App",1427],")",";",["T_WHITESPACE","\n        ",1427],["T_STRING","Router",1428],["T_DOUBLE_COLON","::",1428],["T_STRING","reload",1428],"(",")",";",["T_WHITESPACE","\n    ",1428],"}",["T_WHITESPACE","\n\n    ",1429],["T_DOC_COMMENT","\/**\n     * testUser method\n     *\n     * @return void\n     *\/",1431],["T_WHITESPACE","\n    ",1435],["T_PUBLIC","public",1436],["T_WHITESPACE"," ",1436],["T_FUNCTION","function",1436],["T_WHITESPACE"," ",1436],["T_STRING","testUser",1436],"(",")",["T_WHITESPACE","\n    ",1436],"{",["T_WHITESPACE","\n        ",1437],["T_VARIABLE","$data",1438],["T_WHITESPACE"," ",1438],"=",["T_WHITESPACE"," ",1438],"[",["T_WHITESPACE","\n            ",1438],["T_CONSTANT_ENCAPSED_STRING","'User'",1439],["T_WHITESPACE"," ",1439],["T_DOUBLE_ARROW","=>",1439],["T_WHITESPACE"," ",1439],"[",["T_WHITESPACE","\n                ",1439],["T_CONSTANT_ENCAPSED_STRING","'id'",1440],["T_WHITESPACE"," ",1440],["T_DOUBLE_ARROW","=>",1440],["T_WHITESPACE"," ",1440],["T_CONSTANT_ENCAPSED_STRING","'2'",1440],",",["T_WHITESPACE","\n                ",1440],["T_CONSTANT_ENCAPSED_STRING","'username'",1441],["T_WHITESPACE"," ",1441],["T_DOUBLE_ARROW","=>",1441],["T_WHITESPACE"," ",1441],["T_CONSTANT_ENCAPSED_STRING","'mark'",1441],",",["T_WHITESPACE","\n                ",1441],["T_CONSTANT_ENCAPSED_STRING","'group_id'",1442],["T_WHITESPACE"," ",1442],["T_DOUBLE_ARROW","=>",1442],["T_WHITESPACE"," ",1442],["T_LNUMBER","1",1442],",",["T_WHITESPACE","\n                ",1442],["T_CONSTANT_ENCAPSED_STRING","'Group'",1443],["T_WHITESPACE"," ",1443],["T_DOUBLE_ARROW","=>",1443],["T_WHITESPACE"," ",1443],"[",["T_WHITESPACE","\n                    ",1443],["T_CONSTANT_ENCAPSED_STRING","'id'",1444],["T_WHITESPACE"," ",1444],["T_DOUBLE_ARROW","=>",1444],["T_WHITESPACE"," ",1444],["T_CONSTANT_ENCAPSED_STRING","'1'",1444],",",["T_WHITESPACE","\n                    ",1444],["T_CONSTANT_ENCAPSED_STRING","'name'",1445],["T_WHITESPACE"," ",1445],["T_DOUBLE_ARROW","=>",1445],["T_WHITESPACE"," ",1445],["T_CONSTANT_ENCAPSED_STRING","'Members'",1445],["T_WHITESPACE","\n                ",1445],"]",",",["T_WHITESPACE","\n                ",1446],["T_CONSTANT_ENCAPSED_STRING","'is_admin'",1447],["T_WHITESPACE"," ",1447],["T_DOUBLE_ARROW","=>",1447],["T_WHITESPACE"," ",1447],["T_STRING","false",1447],",",["T_WHITESPACE","\n            ",1447],"]","]",";",["T_WHITESPACE","\n            ",1448],["T_VARIABLE","$this",1449],["T_OBJECT_OPERATOR","->",1449],["T_STRING","Auth",1449],["T_OBJECT_OPERATOR","->",1449],["T_STRING","session",1449],["T_OBJECT_OPERATOR","->",1449],["T_STRING","write",1449],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",1449],",",["T_WHITESPACE"," ",1449],["T_VARIABLE","$data",1449],")",";",["T_WHITESPACE","\n\n            ",1449],["T_VARIABLE","$result",1451],["T_WHITESPACE"," ",1451],"=",["T_WHITESPACE"," ",1451],["T_VARIABLE","$this",1451],["T_OBJECT_OPERATOR","->",1451],["T_STRING","Auth",1451],["T_OBJECT_OPERATOR","->",1451],["T_STRING","user",1451],"(",")",";",["T_WHITESPACE","\n            ",1451],["T_VARIABLE","$this",1452],["T_OBJECT_OPERATOR","->",1452],["T_STRING","assertEquals",1452],"(",["T_VARIABLE","$data",1452],"[",["T_CONSTANT_ENCAPSED_STRING","'User'",1452],"]",",",["T_WHITESPACE"," ",1452],["T_VARIABLE","$result",1452],")",";",["T_WHITESPACE","\n\n            ",1452],["T_VARIABLE","$result",1454],["T_WHITESPACE"," ",1454],"=",["T_WHITESPACE"," ",1454],["T_VARIABLE","$this",1454],["T_OBJECT_OPERATOR","->",1454],["T_STRING","Auth",1454],["T_OBJECT_OPERATOR","->",1454],["T_STRING","user",1454],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",1454],")",";",["T_WHITESPACE","\n            ",1454],["T_VARIABLE","$this",1455],["T_OBJECT_OPERATOR","->",1455],["T_STRING","assertEquals",1455],"(",["T_VARIABLE","$data",1455],"[",["T_CONSTANT_ENCAPSED_STRING","'User'",1455],"]","[",["T_CONSTANT_ENCAPSED_STRING","'username'",1455],"]",",",["T_WHITESPACE"," ",1455],["T_VARIABLE","$result",1455],")",";",["T_WHITESPACE","\n\n            ",1455],["T_VARIABLE","$result",1457],["T_WHITESPACE"," ",1457],"=",["T_WHITESPACE"," ",1457],["T_VARIABLE","$this",1457],["T_OBJECT_OPERATOR","->",1457],["T_STRING","Auth",1457],["T_OBJECT_OPERATOR","->",1457],["T_STRING","user",1457],"(",["T_CONSTANT_ENCAPSED_STRING","'Group.name'",1457],")",";",["T_WHITESPACE","\n            ",1457],["T_VARIABLE","$this",1458],["T_OBJECT_OPERATOR","->",1458],["T_STRING","assertEquals",1458],"(",["T_VARIABLE","$data",1458],"[",["T_CONSTANT_ENCAPSED_STRING","'User'",1458],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Group'",1458],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",1458],"]",",",["T_WHITESPACE"," ",1458],["T_VARIABLE","$result",1458],")",";",["T_WHITESPACE","\n\n            ",1458],["T_VARIABLE","$result",1460],["T_WHITESPACE"," ",1460],"=",["T_WHITESPACE"," ",1460],["T_VARIABLE","$this",1460],["T_OBJECT_OPERATOR","->",1460],["T_STRING","Auth",1460],["T_OBJECT_OPERATOR","->",1460],["T_STRING","user",1460],"(",["T_CONSTANT_ENCAPSED_STRING","'invalid'",1460],")",";",["T_WHITESPACE","\n            ",1460],["T_VARIABLE","$this",1461],["T_OBJECT_OPERATOR","->",1461],["T_STRING","assertEquals",1461],"(",["T_STRING","null",1461],",",["T_WHITESPACE"," ",1461],["T_VARIABLE","$result",1461],")",";",["T_WHITESPACE","\n\n            ",1461],["T_VARIABLE","$result",1463],["T_WHITESPACE"," ",1463],"=",["T_WHITESPACE"," ",1463],["T_VARIABLE","$this",1463],["T_OBJECT_OPERATOR","->",1463],["T_STRING","Auth",1463],["T_OBJECT_OPERATOR","->",1463],["T_STRING","user",1463],"(",["T_CONSTANT_ENCAPSED_STRING","'Company.invalid'",1463],")",";",["T_WHITESPACE","\n            ",1463],["T_VARIABLE","$this",1464],["T_OBJECT_OPERATOR","->",1464],["T_STRING","assertEquals",1464],"(",["T_STRING","null",1464],",",["T_WHITESPACE"," ",1464],["T_VARIABLE","$result",1464],")",";",["T_WHITESPACE","\n\n            ",1464],["T_VARIABLE","$result",1466],["T_WHITESPACE"," ",1466],"=",["T_WHITESPACE"," ",1466],["T_VARIABLE","$this",1466],["T_OBJECT_OPERATOR","->",1466],["T_STRING","Auth",1466],["T_OBJECT_OPERATOR","->",1466],["T_STRING","user",1466],"(",["T_CONSTANT_ENCAPSED_STRING","'is_admin'",1466],")",";",["T_WHITESPACE","\n            ",1466],["T_VARIABLE","$this",1467],["T_OBJECT_OPERATOR","->",1467],["T_STRING","assertFalse",1467],"(",["T_VARIABLE","$result",1467],")",";",["T_WHITESPACE","\n    ",1467],"}",["T_WHITESPACE","\n\n    ",1468],["T_DOC_COMMENT","\/**\n     * testStatelessAuthNoRedirect method\n     *\n     * @expectedException \\Cake\\Network\\Exception\\UnauthorizedException\n     * @expectedExceptionCode 401\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1470],["T_WHITESPACE","\n    ",1477],["T_PUBLIC","public",1478],["T_WHITESPACE"," ",1478],["T_FUNCTION","function",1478],["T_WHITESPACE"," ",1478],["T_STRING","testStatelessAuthNoRedirect",1478],"(",")",["T_WHITESPACE","\n    ",1478],"{",["T_WHITESPACE","\n        ",1479],["T_VARIABLE","$event",1480],["T_WHITESPACE"," ",1480],"=",["T_WHITESPACE"," ",1480],["T_NEW","new",1480],["T_WHITESPACE"," ",1480],["T_STRING","Event",1480],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1480],",",["T_WHITESPACE"," ",1480],["T_VARIABLE","$this",1480],["T_OBJECT_OPERATOR","->",1480],["T_STRING","Controller",1480],")",";",["T_WHITESPACE","\n        ",1480],["T_VARIABLE","$_SESSION",1481],["T_WHITESPACE"," ",1481],"=",["T_WHITESPACE"," ",1481],"[","]",";",["T_WHITESPACE","\n\n        ",1481],["T_VARIABLE","$this",1483],["T_OBJECT_OPERATOR","->",1483],["T_STRING","Auth",1483],["T_OBJECT_OPERATOR","->",1483],["T_STRING","config",1483],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticate'",1483],",",["T_WHITESPACE"," ",1483],"[",["T_CONSTANT_ENCAPSED_STRING","'Basic'",1483],"]",")",";",["T_WHITESPACE","\n        ",1483],["T_VARIABLE","$this",1484],["T_OBJECT_OPERATOR","->",1484],["T_STRING","Controller",1484],["T_OBJECT_OPERATOR","->",1484],["T_STRING","request",1484],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",1484],"]",["T_WHITESPACE"," ",1484],"=",["T_WHITESPACE"," ",1484],["T_CONSTANT_ENCAPSED_STRING","'add'",1484],";",["T_WHITESPACE","\n\n        ",1484],["T_VARIABLE","$result",1486],["T_WHITESPACE"," ",1486],"=",["T_WHITESPACE"," ",1486],["T_VARIABLE","$this",1486],["T_OBJECT_OPERATOR","->",1486],["T_STRING","Auth",1486],["T_OBJECT_OPERATOR","->",1486],["T_STRING","startup",1486],"(",["T_VARIABLE","$event",1486],")",";",["T_WHITESPACE","\n    ",1486],"}",["T_WHITESPACE","\n\n    ",1487],["T_DOC_COMMENT","\/**\n     * testStatelessAuthRedirect method\n     *\n     * @return void\n     * @triggers Controller.startup $this->Controller\n     *\/",1489],["T_WHITESPACE","\n    ",1494],["T_PUBLIC","public",1495],["T_WHITESPACE"," ",1495],["T_FUNCTION","function",1495],["T_WHITESPACE"," ",1495],["T_STRING","testStatelessFollowedByStatefulAuth",1495],"(",")",["T_WHITESPACE","\n    ",1495],"{",["T_WHITESPACE","\n        ",1496],["T_VARIABLE","$this",1497],["T_OBJECT_OPERATOR","->",1497],["T_STRING","Auth",1497],["T_OBJECT_OPERATOR","->",1497],["T_STRING","response",1497],["T_WHITESPACE"," ",1497],"=",["T_WHITESPACE"," ",1497],["T_VARIABLE","$this",1497],["T_OBJECT_OPERATOR","->",1497],["T_STRING","getMockBuilder",1497],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",1497],")",["T_WHITESPACE","\n            ",1497],["T_OBJECT_OPERATOR","->",1498],["T_STRING","setMethods",1498],"(","[",["T_CONSTANT_ENCAPSED_STRING","'stop'",1498],",",["T_WHITESPACE"," ",1498],["T_CONSTANT_ENCAPSED_STRING","'statusCode'",1498],",",["T_WHITESPACE"," ",1498],["T_CONSTANT_ENCAPSED_STRING","'send'",1498],"]",")",["T_WHITESPACE","\n            ",1498],["T_OBJECT_OPERATOR","->",1499],["T_STRING","getMock",1499],"(",")",";",["T_WHITESPACE","\n        ",1499],["T_VARIABLE","$event",1500],["T_WHITESPACE"," ",1500],"=",["T_WHITESPACE"," ",1500],["T_NEW","new",1500],["T_WHITESPACE"," ",1500],["T_STRING","Event",1500],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1500],",",["T_WHITESPACE"," ",1500],["T_VARIABLE","$this",1500],["T_OBJECT_OPERATOR","->",1500],["T_STRING","Controller",1500],")",";",["T_WHITESPACE","\n        ",1500],["T_VARIABLE","$this",1501],["T_OBJECT_OPERATOR","->",1501],["T_STRING","Auth",1501],["T_OBJECT_OPERATOR","->",1501],["T_STRING","authenticate",1501],["T_WHITESPACE"," ",1501],"=",["T_WHITESPACE"," ",1501],"[",["T_CONSTANT_ENCAPSED_STRING","'Basic'",1501],",",["T_WHITESPACE"," ",1501],["T_CONSTANT_ENCAPSED_STRING","'Form'",1501],"]",";",["T_WHITESPACE","\n        ",1501],["T_VARIABLE","$this",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","Controller",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","request",1502],"[",["T_CONSTANT_ENCAPSED_STRING","'action'",1502],"]",["T_WHITESPACE"," ",1502],"=",["T_WHITESPACE"," ",1502],["T_CONSTANT_ENCAPSED_STRING","'add'",1502],";",["T_WHITESPACE","\n\n        ",1502],["T_VARIABLE","$this",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","Auth",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","response",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","expects",1504],"(",["T_VARIABLE","$this",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","never",1504],"(",")",")",["T_OBJECT_OPERATOR","->",1504],["T_STRING","method",1504],"(",["T_CONSTANT_ENCAPSED_STRING","'statusCode'",1504],")",";",["T_WHITESPACE","\n        ",1504],["T_VARIABLE","$this",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","Auth",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","response",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","expects",1505],"(",["T_VARIABLE","$this",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","never",1505],"(",")",")",["T_OBJECT_OPERATOR","->",1505],["T_STRING","method",1505],"(",["T_CONSTANT_ENCAPSED_STRING","'send'",1505],")",";",["T_WHITESPACE","\n\n        ",1505],["T_VARIABLE","$this",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","assertInstanceOf",1507],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Network\\Response'",1507],",",["T_WHITESPACE"," ",1507],["T_VARIABLE","$this",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","Auth",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","startup",1507],"(",["T_VARIABLE","$event",1507],")",")",";",["T_WHITESPACE","\n\n        ",1507],["T_VARIABLE","$this",1509],["T_OBJECT_OPERATOR","->",1509],["T_STRING","assertEquals",1509],"(",["T_CONSTANT_ENCAPSED_STRING","'\/users\/login'",1509],",",["T_WHITESPACE"," ",1509],["T_VARIABLE","$this",1509],["T_OBJECT_OPERATOR","->",1509],["T_STRING","Controller",1509],["T_OBJECT_OPERATOR","->",1509],["T_STRING","testUrl",1509],")",";",["T_WHITESPACE","\n    ",1509],"}",["T_WHITESPACE","\n\n    ",1510],["T_DOC_COMMENT","\/**\n     * test for BC getting\/setting AuthComponent::$sessionKey gets\/sets `key`\n     * config of session storage.\n     *\n     * @return void\n     *\/",1512],["T_WHITESPACE","\n    ",1517],["T_PUBLIC","public",1518],["T_WHITESPACE"," ",1518],["T_FUNCTION","function",1518],["T_WHITESPACE"," ",1518],["T_STRING","testSessionKeyBC",1518],"(",")",["T_WHITESPACE","\n    ",1518],"{",["T_WHITESPACE","\n        ",1519],["T_VARIABLE","$this",1520],["T_OBJECT_OPERATOR","->",1520],["T_STRING","assertEquals",1520],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.User'",1520],",",["T_WHITESPACE"," ",1520],["T_VARIABLE","$this",1520],["T_OBJECT_OPERATOR","->",1520],["T_STRING","Auth",1520],["T_OBJECT_OPERATOR","->",1520],["T_STRING","sessionKey",1520],")",";",["T_WHITESPACE","\n\n        ",1520],["T_VARIABLE","$this",1522],["T_OBJECT_OPERATOR","->",1522],["T_STRING","Auth",1522],["T_OBJECT_OPERATOR","->",1522],["T_STRING","sessionKey",1522],["T_WHITESPACE"," ",1522],"=",["T_WHITESPACE"," ",1522],["T_CONSTANT_ENCAPSED_STRING","'Auth.Member'",1522],";",["T_WHITESPACE","\n        ",1522],["T_VARIABLE","$this",1523],["T_OBJECT_OPERATOR","->",1523],["T_STRING","assertEquals",1523],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.Member'",1523],",",["T_WHITESPACE"," ",1523],["T_VARIABLE","$this",1523],["T_OBJECT_OPERATOR","->",1523],["T_STRING","Auth",1523],["T_OBJECT_OPERATOR","->",1523],["T_STRING","sessionKey",1523],")",";",["T_WHITESPACE","\n        ",1523],["T_VARIABLE","$this",1524],["T_OBJECT_OPERATOR","->",1524],["T_STRING","assertEquals",1524],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth.Member'",1524],",",["T_WHITESPACE"," ",1524],["T_VARIABLE","$this",1524],["T_OBJECT_OPERATOR","->",1524],["T_STRING","Auth",1524],["T_OBJECT_OPERATOR","->",1524],["T_STRING","storage",1524],"(",")",["T_OBJECT_OPERATOR","->",1524],["T_STRING","config",1524],"(",["T_CONSTANT_ENCAPSED_STRING","'key'",1524],")",")",";",["T_WHITESPACE","\n\n        ",1524],["T_VARIABLE","$this",1526],["T_OBJECT_OPERATOR","->",1526],["T_STRING","Auth",1526],["T_OBJECT_OPERATOR","->",1526],["T_STRING","sessionKey",1526],["T_WHITESPACE"," ",1526],"=",["T_WHITESPACE"," ",1526],["T_STRING","false",1526],";",["T_WHITESPACE","\n        ",1526],["T_VARIABLE","$this",1527],["T_OBJECT_OPERATOR","->",1527],["T_STRING","assertInstanceOf",1527],"(",["T_CONSTANT_ENCAPSED_STRING","'Cake\\Auth\\Storage\\MemoryStorage'",1527],",",["T_WHITESPACE"," ",1527],["T_VARIABLE","$this",1527],["T_OBJECT_OPERATOR","->",1527],["T_STRING","Auth",1527],["T_OBJECT_OPERATOR","->",1527],["T_STRING","storage",1527],"(",")",")",";",["T_WHITESPACE","\n    ",1527],"}",["T_WHITESPACE","\n\n    ",1528],["T_DOC_COMMENT","\/**\n     * Test that setting config 'earlyAuth' to true make AuthComponent do the initial\n     * checks in beforeFilter() instead of startup().\n     *\n     * @return void\n     *\/",1530],["T_WHITESPACE","\n    ",1535],["T_PUBLIC","public",1536],["T_WHITESPACE"," ",1536],["T_FUNCTION","function",1536],["T_WHITESPACE"," ",1536],["T_STRING","testCheckAuthInConfig",1536],"(",")",["T_WHITESPACE","\n    ",1536],"{",["T_WHITESPACE","\n        ",1537],["T_VARIABLE","$this",1538],["T_OBJECT_OPERATOR","->",1538],["T_STRING","Controller",1538],["T_OBJECT_OPERATOR","->",1538],["T_STRING","components",1538],"(",")",["T_OBJECT_OPERATOR","->",1538],["T_STRING","set",1538],"(",["T_CONSTANT_ENCAPSED_STRING","'Auth'",1538],",",["T_WHITESPACE"," ",1538],["T_VARIABLE","$this",1538],["T_OBJECT_OPERATOR","->",1538],["T_STRING","Auth",1538],")",";",["T_WHITESPACE","\n        ",1538],["T_VARIABLE","$this",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","Auth",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","earlyAuthTest",1539],["T_WHITESPACE"," ",1539],"=",["T_WHITESPACE"," ",1539],["T_STRING","true",1539],";",["T_WHITESPACE","\n\n        ",1539],["T_VARIABLE","$this",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","Auth",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","authCheckCalledFrom",1541],["T_WHITESPACE"," ",1541],"=",["T_WHITESPACE"," ",1541],["T_STRING","null",1541],";",["T_WHITESPACE","\n        ",1541],["T_VARIABLE","$this",1542],["T_OBJECT_OPERATOR","->",1542],["T_STRING","Controller",1542],["T_OBJECT_OPERATOR","->",1542],["T_STRING","startupProcess",1542],"(",")",";",["T_WHITESPACE","\n        ",1542],["T_VARIABLE","$this",1543],["T_OBJECT_OPERATOR","->",1543],["T_STRING","assertEquals",1543],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.startup'",1543],",",["T_WHITESPACE"," ",1543],["T_VARIABLE","$this",1543],["T_OBJECT_OPERATOR","->",1543],["T_STRING","Auth",1543],["T_OBJECT_OPERATOR","->",1543],["T_STRING","authCheckCalledFrom",1543],")",";",["T_WHITESPACE","\n\n        ",1543],["T_VARIABLE","$this",1545],["T_OBJECT_OPERATOR","->",1545],["T_STRING","Auth",1545],["T_OBJECT_OPERATOR","->",1545],["T_STRING","authCheckCalledFrom",1545],["T_WHITESPACE"," ",1545],"=",["T_WHITESPACE"," ",1545],["T_STRING","null",1545],";",["T_WHITESPACE","\n        ",1545],["T_VARIABLE","$this",1546],["T_OBJECT_OPERATOR","->",1546],["T_STRING","Auth",1546],["T_OBJECT_OPERATOR","->",1546],["T_STRING","config",1546],"(",["T_CONSTANT_ENCAPSED_STRING","'checkAuthIn'",1546],",",["T_WHITESPACE"," ",1546],["T_CONSTANT_ENCAPSED_STRING","'Controller.initialize'",1546],")",";",["T_WHITESPACE","\n        ",1546],["T_VARIABLE","$this",1547],["T_OBJECT_OPERATOR","->",1547],["T_STRING","Controller",1547],["T_OBJECT_OPERATOR","->",1547],["T_STRING","startupProcess",1547],"(",")",";",["T_WHITESPACE","\n        ",1547],["T_VARIABLE","$this",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","assertEquals",1548],"(",["T_CONSTANT_ENCAPSED_STRING","'Controller.initialize'",1548],",",["T_WHITESPACE"," ",1548],["T_VARIABLE","$this",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","Auth",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","authCheckCalledFrom",1548],")",";",["T_WHITESPACE","\n    ",1548],"}",["T_WHITESPACE","\n",1549],"}",["T_WHITESPACE","\n",1550]]