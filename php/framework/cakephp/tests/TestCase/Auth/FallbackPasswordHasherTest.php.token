[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Auth",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Auth",17],["T_NS_SEPARATOR","\\",17],["T_STRING","DefaultPasswordHasher",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Auth",18],["T_NS_SEPARATOR","\\",18],["T_STRING","FallbackPasswordHasher",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Auth",19],["T_NS_SEPARATOR","\\",19],["T_STRING","WeakPasswordHasher",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","TestSuite",20],["T_NS_SEPARATOR","\\",20],["T_STRING","TestCase",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * Test case for FallbackPasswordHasher\n *\/",22],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","FallbackPasswordHasherTest",25],["T_WHITESPACE"," ",25],["T_EXTENDS","extends",25],["T_WHITESPACE"," ",25],["T_STRING","TestCase",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * Tests that only the first hasher is user for hashing a password\n     *\n     * @return void\n     *\/",28],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","testHash",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$hasher",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_NEW","new",35],["T_WHITESPACE"," ",35],["T_STRING","FallbackPasswordHasher",35],"(","[",["T_CONSTANT_ENCAPSED_STRING","'hashers'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],"[",["T_CONSTANT_ENCAPSED_STRING","'Weak'",35],",",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'Default'",35],"]","]",")",";",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$weak",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_NEW","new",36],["T_WHITESPACE"," ",36],["T_STRING","WeakPasswordHasher",36],"(",")",";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","assertSame",37],"(",["T_VARIABLE","$weak",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","hash",37],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",37],")",",",["T_WHITESPACE"," ",37],["T_VARIABLE","$hasher",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","hash",37],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",37],")",")",";",["T_WHITESPACE","\n\n        ",37],["T_VARIABLE","$simple",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_NEW","new",39],["T_WHITESPACE"," ",39],["T_STRING","DefaultPasswordHasher",39],"(",")",";",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$hasher",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_NEW","new",40],["T_WHITESPACE"," ",40],["T_STRING","FallbackPasswordHasher",40],"(","[",["T_CONSTANT_ENCAPSED_STRING","'hashers'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],"[",["T_CONSTANT_ENCAPSED_STRING","'Weak'",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'Default'",40],"]","]",")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","assertSame",41],"(",["T_VARIABLE","$weak",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","hash",41],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",41],")",",",["T_WHITESPACE"," ",41],["T_VARIABLE","$hasher",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","hash",41],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",41],")",")",";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Tests that the check method will check with configured hashers until a match\n     * is found\n     *\n     * @return void\n     *\/",44],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","testCheck",50],"(",")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$hasher",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_NEW","new",52],["T_WHITESPACE"," ",52],["T_STRING","FallbackPasswordHasher",52],"(","[",["T_CONSTANT_ENCAPSED_STRING","'hashers'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],"[",["T_CONSTANT_ENCAPSED_STRING","'Weak'",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'Default'",52],"]","]",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$weak",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_NEW","new",53],["T_WHITESPACE"," ",53],["T_STRING","WeakPasswordHasher",53],"(",")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$simple",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_NEW","new",54],["T_WHITESPACE"," ",54],["T_STRING","DefaultPasswordHasher",54],"(",")",";",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$hash",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$simple",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","hash",56],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$otherHash",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$weak",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","hash",57],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertTrue",58],"(",["T_VARIABLE","$hasher",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","check",58],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$hash",58],")",")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertTrue",59],"(",["T_VARIABLE","$hasher",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","check",59],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$otherHash",59],")",")",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Tests that the check method will work with configured hashers including different\n     * configs per hasher.\n     *\n     * @return void\n     *\/",62],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","testCheckWithConfigs",68],"(",")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$hasher",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","FallbackPasswordHasher",70],"(","[",["T_CONSTANT_ENCAPSED_STRING","'hashers'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],"[",["T_CONSTANT_ENCAPSED_STRING","'Default'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'Weak'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],"[",["T_CONSTANT_ENCAPSED_STRING","'hashType'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'md5'",70],"]","]","]",")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$legacy",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_NEW","new",71],["T_WHITESPACE"," ",71],["T_STRING","WeakPasswordHasher",71],"(","[",["T_CONSTANT_ENCAPSED_STRING","'hashType'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'md5'",71],"]",")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$simple",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","DefaultPasswordHasher",72],"(",")",";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$hash",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$simple",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","hash",74],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$legacyHash",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$legacy",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","hash",75],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",75],")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertTrue",76],"(",["T_VARIABLE","$hash",76],["T_WHITESPACE"," ",76],["T_IS_NOT_IDENTICAL","!==",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$legacyHash",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertTrue",77],"(",["T_VARIABLE","$hasher",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","check",77],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$hash",77],")",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertTrue",78],"(",["T_VARIABLE","$hasher",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","check",78],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$legacyHash",78],")",")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Tests that the password only needs to be re-built according to the first hasher\n     *\n     * @return void\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","testNeedsRehash",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$hasher",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_STRING","FallbackPasswordHasher",88],"(","[",["T_CONSTANT_ENCAPSED_STRING","'hashers'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],"[",["T_CONSTANT_ENCAPSED_STRING","'Default'",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'Weak'",88],"]","]",")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$weak",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_STRING","WeakPasswordHasher",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$otherHash",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$weak",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","hash",90],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",90],")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertTrue",91],"(",["T_VARIABLE","$hasher",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","needsRehash",91],"(",["T_VARIABLE","$otherHash",91],")",")",";",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$simple",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_NEW","new",93],["T_WHITESPACE"," ",93],["T_STRING","DefaultPasswordHasher",93],"(",")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$hash",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$simple",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","hash",94],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",94],")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertFalse",95],"(",["T_VARIABLE","$hasher",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","needsRehash",95],"(",["T_VARIABLE","$hash",95],")",")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n",96],"}",["T_WHITESPACE","\n",97]]