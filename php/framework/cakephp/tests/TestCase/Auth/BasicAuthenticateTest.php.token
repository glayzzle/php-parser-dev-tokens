[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         2.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Auth",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Auth",17],["T_NS_SEPARATOR","\\",17],["T_STRING","BasicAuthenticate",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Controller",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ComponentRegistry",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","I18n",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Time",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Network",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Exception",20],["T_NS_SEPARATOR","\\",20],["T_STRING","UnauthorizedException",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Network",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Request",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Network",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Response",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Cake",23],["T_NS_SEPARATOR","\\",23],["T_STRING","ORM",23],["T_NS_SEPARATOR","\\",23],["T_STRING","TableRegistry",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Cake",24],["T_NS_SEPARATOR","\\",24],["T_STRING","TestSuite",24],["T_NS_SEPARATOR","\\",24],["T_STRING","TestCase",24],";",["T_WHITESPACE","\n\n",24],["T_DOC_COMMENT","\/**\n * Test case for BasicAuthentication\n *\/",26],["T_WHITESPACE","\n",28],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","BasicAuthenticateTest",29],["T_WHITESPACE"," ",29],["T_EXTENDS","extends",29],["T_WHITESPACE"," ",29],["T_STRING","TestCase",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Fixtures\n     *\n     * @var array\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$fixtures",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],"[",["T_CONSTANT_ENCAPSED_STRING","'core.auth_users'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'core.users'",37],"]",";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * setup\n     *\n     * @return void\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","setUp",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_STRING","parent",46],["T_DOUBLE_COLON","::",46],["T_STRING","setUp",46],"(",")",";",["T_WHITESPACE","\n\n        ",46],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","Collection",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getMockBuilder",48],"(",["T_STRING","ComponentRegistry",48],["T_DOUBLE_COLON","::",48],["T_CLASS","class",48],")",["T_OBJECT_OPERATOR","->",48],["T_STRING","getMock",48],"(",")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","auth",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_NEW","new",49],["T_WHITESPACE"," ",49],["T_STRING","BasicAuthenticate",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","Collection",49],",",["T_WHITESPACE"," ",49],"[",["T_WHITESPACE","\n            ",49],["T_CONSTANT_ENCAPSED_STRING","'userModel'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'Users'",50],",",["T_WHITESPACE","\n            ",50],["T_CONSTANT_ENCAPSED_STRING","'realm'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'localhost'",51],["T_WHITESPACE","\n        ",51],"]",")",";",["T_WHITESPACE","\n\n        ",52],["T_VARIABLE","$password",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","password_hash",54],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",54],",",["T_WHITESPACE"," ",54],["T_STRING","PASSWORD_BCRYPT",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$User",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","TableRegistry",55],["T_DOUBLE_COLON","::",55],["T_STRING","get",55],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",55],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$User",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","updateAll",56],"(","[",["T_CONSTANT_ENCAPSED_STRING","'password'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$password",56],"]",",",["T_WHITESPACE"," ",56],"[","]",")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","response",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getMockBuilder",57],"(",["T_STRING","Response",57],["T_DOUBLE_COLON","::",57],["T_CLASS","class",57],")",["T_OBJECT_OPERATOR","->",57],["T_STRING","getMock",57],"(",")",";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * test applying settings in the constructor\n     *\n     * @return void\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","testConstructor",65],"(",")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$object",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_NEW","new",67],["T_WHITESPACE"," ",67],["T_STRING","BasicAuthenticate",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","Collection",67],",",["T_WHITESPACE"," ",67],"[",["T_WHITESPACE","\n            ",67],["T_CONSTANT_ENCAPSED_STRING","'userModel'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'AuthUser'",68],",",["T_WHITESPACE","\n            ",68],["T_CONSTANT_ENCAPSED_STRING","'fields'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'user'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'password'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'password'",69],"]",["T_WHITESPACE","\n        ",69],"]",")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertEquals",71],"(",["T_CONSTANT_ENCAPSED_STRING","'AuthUser'",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$object",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","config",71],"(",["T_CONSTANT_ENCAPSED_STRING","'userModel'",71],")",")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertEquals",72],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'user'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'password'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'password'",72],"]",",",["T_WHITESPACE"," ",72],["T_VARIABLE","$object",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","config",72],"(",["T_CONSTANT_ENCAPSED_STRING","'fields'",72],")",")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",75],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","testAuthenticateNoData",80],"(",")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$request",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","Request",82],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",82],")",";",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","response",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","expects",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","never",84],"(",")",")",["T_WHITESPACE","\n            ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","method",85],"(",["T_CONSTANT_ENCAPSED_STRING","'header'",85],")",";",["T_WHITESPACE","\n\n        ",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertFalse",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","auth",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getUser",87],"(",["T_VARIABLE","$request",87],")",")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",90],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","testAuthenticateNoUsername",95],"(",")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$request",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","Request",97],"(","[",["T_WHITESPACE","\n            ",97],["T_CONSTANT_ENCAPSED_STRING","'url'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",98],",",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'environment'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'foobar'",99],"]",["T_WHITESPACE","\n        ",99],"]",")",";",["T_WHITESPACE","\n\n        ",100],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertFalse",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","auth",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","authenticate",102],"(",["T_VARIABLE","$request",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","response",102],")",")",";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",105],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","testAuthenticateNoPassword",110],"(",")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$request",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_STRING","Request",112],"(","[",["T_WHITESPACE","\n            ",112],["T_CONSTANT_ENCAPSED_STRING","'url'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",113],",",["T_WHITESPACE","\n            ",113],["T_CONSTANT_ENCAPSED_STRING","'environment'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'mariano'",114],"]",["T_WHITESPACE","\n        ",114],"]",")",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","assertFalse",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","auth",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","authenticate",117],"(",["T_VARIABLE","$request",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","response",117],")",")",";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",120],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","testAuthenticateInjection",125],"(",")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$request",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","Request",127],"(","[",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","'url'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",128],",",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","'environment'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],"[",["T_WHITESPACE","\n                ",129],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'> 1'",130],",",["T_WHITESPACE","\n                ",130],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","\"' OR 1 = 1\"",131],["T_WHITESPACE","\n            ",131],"]",["T_WHITESPACE","\n        ",132],"]",")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$request",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","addParams",134],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",134],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertFalse",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","auth",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getUser",136],"(",["T_VARIABLE","$request",136],")",")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertFalse",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","auth",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","authenticate",137],"(",["T_VARIABLE","$request",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","response",137],")",")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Test that username of 0 works.\n     *\n     * @return void\n     *\/",140],["T_WHITESPACE","\n    ",144],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","testAuthenticateUsernameZero",145],"(",")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$User",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","TableRegistry",147],["T_DOUBLE_COLON","::",147],["T_STRING","get",147],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",147],")",";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$User",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","updateAll",148],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'0'",148],"]",",",["T_WHITESPACE"," ",148],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'mariano'",148],"]",")",";",["T_WHITESPACE","\n\n        ",148],["T_VARIABLE","$request",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_NEW","new",150],["T_WHITESPACE"," ",150],["T_STRING","Request",150],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",150],")",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$request",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","data",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],"[",["T_CONSTANT_ENCAPSED_STRING","'User'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],"[",["T_WHITESPACE","\n            ",151],["T_CONSTANT_ENCAPSED_STRING","'user'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'0'",152],",",["T_WHITESPACE","\n            ",152],["T_CONSTANT_ENCAPSED_STRING","'password'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'password'",153],["T_WHITESPACE","\n        ",153],"]","]",";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$_SERVER",155],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",155],"]",["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'0'",155],";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$_SERVER",156],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",156],"]",["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'password'",156],";",["T_WHITESPACE","\n\n        ",156],["T_VARIABLE","$expected",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],"[",["T_WHITESPACE","\n            ",158],["T_CONSTANT_ENCAPSED_STRING","'id'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_LNUMBER","1",159],",",["T_WHITESPACE","\n            ",159],["T_CONSTANT_ENCAPSED_STRING","'username'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'0'",160],",",["T_WHITESPACE","\n            ",160],["T_CONSTANT_ENCAPSED_STRING","'created'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_NEW","new",161],["T_WHITESPACE"," ",161],["T_STRING","Time",161],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",161],")",",",["T_WHITESPACE","\n            ",161],["T_CONSTANT_ENCAPSED_STRING","'updated'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_NEW","new",162],["T_WHITESPACE"," ",162],["T_STRING","Time",162],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",162],")",",",["T_WHITESPACE","\n        ",162],"]",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","assertEquals",164],"(",["T_VARIABLE","$expected",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","auth",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","authenticate",164],"(",["T_VARIABLE","$request",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","response",164],")",")",";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_DOC_COMMENT","\/**\n     * test that challenge headers are sent when no credentials are found.\n     *\n     * @return void\n     *\/",167],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","testAuthenticateChallenge",172],"(",")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$request",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_NEW","new",174],["T_WHITESPACE"," ",174],["T_STRING","Request",174],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",174],")",";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$request",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","addParams",175],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",175],["T_TRY","try",177],["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","auth",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","unauthenticated",178],"(",["T_VARIABLE","$request",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","response",178],")",";",["T_WHITESPACE","\n        ",178],"}",["T_WHITESPACE"," ",179],["T_CATCH","catch",179],["T_WHITESPACE"," ",179],"(",["T_STRING","UnauthorizedException",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$e",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE","\n\n        ",180],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","assertNotEmpty",182],"(",["T_VARIABLE","$e",182],")",";",["T_WHITESPACE","\n\n        ",182],["T_VARIABLE","$expected",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],"[",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Basic realm=\"localhost\"'",184],"]",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertEquals",185],"(",["T_VARIABLE","$expected",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$e",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","responseHeader",185],"(",")",")",";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * test authenticate success\n     *\n     * @return void\n     *\/",188],["T_WHITESPACE","\n    ",192],["T_PUBLIC","public",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","testAuthenticateSuccess",193],"(",")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$request",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_NEW","new",195],["T_WHITESPACE"," ",195],["T_STRING","Request",195],"(","[",["T_WHITESPACE","\n            ",195],["T_CONSTANT_ENCAPSED_STRING","'url'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",196],",",["T_WHITESPACE","\n            ",196],["T_CONSTANT_ENCAPSED_STRING","'environment'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],"[",["T_WHITESPACE","\n                ",197],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'mariano'",198],",",["T_WHITESPACE","\n                ",198],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'password'",199],["T_WHITESPACE","\n            ",199],"]",["T_WHITESPACE","\n        ",200],"]",")",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$request",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","addParams",202],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",202],["T_VARIABLE","$result",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","auth",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","authenticate",204],"(",["T_VARIABLE","$request",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","response",204],")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$expected",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],"[",["T_WHITESPACE","\n            ",205],["T_CONSTANT_ENCAPSED_STRING","'id'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_LNUMBER","1",206],",",["T_WHITESPACE","\n            ",206],["T_CONSTANT_ENCAPSED_STRING","'username'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'mariano'",207],",",["T_WHITESPACE","\n            ",207],["T_CONSTANT_ENCAPSED_STRING","'created'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_NEW","new",208],["T_WHITESPACE"," ",208],["T_STRING","Time",208],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",208],")",",",["T_WHITESPACE","\n            ",208],["T_CONSTANT_ENCAPSED_STRING","'updated'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_NEW","new",209],["T_WHITESPACE"," ",209],["T_STRING","Time",209],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",209],")",["T_WHITESPACE","\n        ",209],"]",";",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","assertEquals",211],"(",["T_VARIABLE","$expected",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$result",211],")",";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * test scope failure.\n     *\n     * @expectedException \\Cake\\Network\\Exception\\UnauthorizedException\n     * @expectedExceptionCode 401\n     * @return void\n     *\/",214],["T_WHITESPACE","\n    ",220],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","testAuthenticateFailReChallenge",221],"(",")",["T_WHITESPACE","\n    ",221],"{",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","auth",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","config",223],"(",["T_CONSTANT_ENCAPSED_STRING","'scope.username'",223],",",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'nate'",223],")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$request",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_NEW","new",224],["T_WHITESPACE"," ",224],["T_STRING","Request",224],"(","[",["T_WHITESPACE","\n            ",224],["T_CONSTANT_ENCAPSED_STRING","'url'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",225],",",["T_WHITESPACE","\n            ",225],["T_CONSTANT_ENCAPSED_STRING","'environment'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],"[",["T_WHITESPACE","\n                ",226],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'mariano'",227],",",["T_WHITESPACE","\n                ",227],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'password'",228],["T_WHITESPACE","\n            ",228],"]",["T_WHITESPACE","\n        ",229],"]",")",";",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$request",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","addParams",231],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",231],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","auth",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","unauthenticated",233],"(",["T_VARIABLE","$request",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","response",233],")",";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n",234],"}",["T_WHITESPACE","\n",235]]