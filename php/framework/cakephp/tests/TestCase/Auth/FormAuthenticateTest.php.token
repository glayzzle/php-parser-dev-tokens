[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         2.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Auth",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Auth",17],["T_NS_SEPARATOR","\\",17],["T_STRING","FormAuthenticate",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Controller",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ComponentRegistry",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Core",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Plugin",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","I18n",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Time",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Network",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Request",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Network",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Response",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Cake",23],["T_NS_SEPARATOR","\\",23],["T_STRING","ORM",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Entity",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Cake",24],["T_NS_SEPARATOR","\\",24],["T_STRING","ORM",24],["T_NS_SEPARATOR","\\",24],["T_STRING","TableRegistry",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Cake",25],["T_NS_SEPARATOR","\\",25],["T_STRING","TestSuite",25],["T_NS_SEPARATOR","\\",25],["T_STRING","TestCase",25],";",["T_WHITESPACE","\n",25],["T_USE","use",26],["T_WHITESPACE"," ",26],["T_STRING","Cake",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Utility",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Security",26],";",["T_WHITESPACE","\n\n",26],["T_DOC_COMMENT","\/**\n * Test case for FormAuthentication\n *\/",28],["T_WHITESPACE","\n",30],["T_CLASS","class",31],["T_WHITESPACE"," ",31],["T_STRING","FormAuthenticateTest",31],["T_WHITESPACE"," ",31],["T_EXTENDS","extends",31],["T_WHITESPACE"," ",31],["T_STRING","TestCase",31],["T_WHITESPACE","\n",31],"{",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Fixtures\n     *\n     * @var array\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$fixtures",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],"[",["T_CONSTANT_ENCAPSED_STRING","'core.auth_users'",39],",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'core.users'",39],"]",";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * setup\n     *\n     * @return void\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","setUp",46],"(",")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_STRING","parent",48],["T_DOUBLE_COLON","::",48],["T_STRING","setUp",48],"(",")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","Collection",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getMockBuilder",49],"(",["T_STRING","ComponentRegistry",49],["T_DOUBLE_COLON","::",49],["T_CLASS","class",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","getMock",49],"(",")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","auth",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","FormAuthenticate",50],"(",["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","Collection",50],",",["T_WHITESPACE"," ",50],"[",["T_WHITESPACE","\n            ",50],["T_CONSTANT_ENCAPSED_STRING","'userModel'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'Users'",51],["T_WHITESPACE","\n        ",51],"]",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$password",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","password_hash",53],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",53],",",["T_WHITESPACE"," ",53],["T_STRING","PASSWORD_DEFAULT",53],")",";",["T_WHITESPACE","\n\n        ",53],["T_STRING","TableRegistry",55],["T_DOUBLE_COLON","::",55],["T_STRING","clear",55],"(",")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$Users",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","TableRegistry",56],["T_DOUBLE_COLON","::",56],["T_STRING","get",56],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$Users",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","updateAll",57],"(","[",["T_CONSTANT_ENCAPSED_STRING","'password'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$password",57],"]",",",["T_WHITESPACE"," ",57],"[","]",")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$AuthUsers",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","TableRegistry",59],["T_DOUBLE_COLON","::",59],["T_STRING","get",59],"(",["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",59],",",["T_WHITESPACE"," ",59],"[",["T_WHITESPACE","\n            ",59],["T_CONSTANT_ENCAPSED_STRING","'className'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'TestApp\\Model\\Table\\AuthUsersTable'",60],["T_WHITESPACE","\n        ",60],"]",")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$AuthUsers",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","updateAll",62],"(","[",["T_CONSTANT_ENCAPSED_STRING","'password'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$password",62],"]",",",["T_WHITESPACE"," ",62],"[","]",")",";",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","response",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getMockBuilder",64],"(",["T_STRING","Response",64],["T_DOUBLE_COLON","::",64],["T_CLASS","class",64],")",["T_OBJECT_OPERATOR","->",64],["T_STRING","getMock",64],"(",")",";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * test applying settings in the constructor\n     *\n     * @return void\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","testConstructor",72],"(",")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$object",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_NEW","new",74],["T_WHITESPACE"," ",74],["T_STRING","FormAuthenticate",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","Collection",74],",",["T_WHITESPACE"," ",74],"[",["T_WHITESPACE","\n            ",74],["T_CONSTANT_ENCAPSED_STRING","'userModel'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",75],",",["T_WHITESPACE","\n            ",75],["T_CONSTANT_ENCAPSED_STRING","'fields'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'user'",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'password'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'password'",76],"]",["T_WHITESPACE","\n        ",76],"]",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertEquals",78],"(",["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$object",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","config",78],"(",["T_CONSTANT_ENCAPSED_STRING","'userModel'",78],")",")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertEquals",79],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'user'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'password'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'password'",79],"]",",",["T_WHITESPACE"," ",79],["T_VARIABLE","$object",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","config",79],"(",["T_CONSTANT_ENCAPSED_STRING","'fields'",79],")",")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","testAuthenticateNoData",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$request",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_STRING","Request",89],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",89],")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$request",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","data",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],"[","]",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertFalse",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","auth",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","authenticate",91],"(",["T_VARIABLE","$request",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","response",91],")",")",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",94],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","testAuthenticateNoUsername",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$request",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_STRING","Request",101],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",101],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$request",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","data",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'foobar'",102],"]",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertFalse",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","auth",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","authenticate",103],"(",["T_VARIABLE","$request",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","response",103],")",")",";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",106],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","testAuthenticateNoPassword",111],"(",")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$request",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Request",113],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",113],")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$request",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","data",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'mariano'",114],"]",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","assertFalse",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","auth",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","authenticate",115],"(",["T_VARIABLE","$request",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","response",115],")",")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * test authenticate password is false method\n     *\n     * @return void\n     *\/",118],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","testAuthenticatePasswordIsFalse",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$request",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_NEW","new",125],["T_WHITESPACE"," ",125],["T_STRING","Request",125],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",125],",",["T_WHITESPACE"," ",125],["T_STRING","false",125],")",";",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$request",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","data",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],"[",["T_WHITESPACE","\n            ",126],["T_CONSTANT_ENCAPSED_STRING","'username'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'mariano'",127],",",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","'password'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_STRING","null",128],["T_WHITESPACE","\n        ",128],"]",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","assertFalse",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","auth",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","authenticate",130],"(",["T_VARIABLE","$request",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","response",130],")",")",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Test for password as empty string with _checkFields() call skipped\n     * Refs https:\/\/github.com\/cakephp\/cakephp\/pull\/2441\n     *\n     * @return void\n     *\/",133],["T_WHITESPACE","\n    ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","testAuthenticatePasswordIsEmptyString",139],"(",")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$request",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_NEW","new",141],["T_WHITESPACE"," ",141],["T_STRING","Request",141],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",141],",",["T_WHITESPACE"," ",141],["T_STRING","false",141],")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$request",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","data",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],"[",["T_WHITESPACE","\n            ",142],["T_CONSTANT_ENCAPSED_STRING","'username'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'mariano'",143],",",["T_WHITESPACE","\n            ",143],["T_CONSTANT_ENCAPSED_STRING","'password'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","''",144],["T_WHITESPACE","\n        ",144],"]",";",["T_WHITESPACE","\n\n        ",145],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","auth",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getMockBuilder",147],"(",["T_STRING","FormAuthenticate",147],["T_DOUBLE_COLON","::",147],["T_CLASS","class",147],")",["T_WHITESPACE","\n            ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","setMethods",148],"(","[",["T_CONSTANT_ENCAPSED_STRING","'_checkFields'",148],"]",")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","setConstructorArgs",149],"(","[",["T_WHITESPACE","\n                ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","Collection",150],",",["T_WHITESPACE","\n                ",150],"[",["T_CONSTANT_ENCAPSED_STRING","'userModel'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'Users'",151],"]",["T_WHITESPACE","\n            ",151],"]",")",["T_WHITESPACE","\n            ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","getMock",153],"(",")",";",["T_WHITESPACE","\n\n        ",153],["T_COMMENT","\/\/ Simulate that check for ensuring password is not empty is missing.\n",155],["T_WHITESPACE","        ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","auth",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","expects",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","once",156],"(",")",")",["T_WHITESPACE","\n            ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","method",157],"(",["T_CONSTANT_ENCAPSED_STRING","'_checkFields'",157],")",["T_WHITESPACE","\n            ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","will",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","returnValue",158],"(",["T_STRING","true",158],")",")",";",["T_WHITESPACE","\n\n        ",158],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","assertFalse",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","auth",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","authenticate",160],"(",["T_VARIABLE","$request",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","response",160],")",")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n\n    ",161],["T_DOC_COMMENT","\/**\n     * test authenticate field is not string\n     *\n     * @return void\n     *\/",163],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","testAuthenticateFieldsAreNotString",168],"(",")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$request",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_NEW","new",170],["T_WHITESPACE"," ",170],["T_STRING","Request",170],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",170],",",["T_WHITESPACE"," ",170],["T_STRING","false",170],")",";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$request",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","data",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],"[",["T_WHITESPACE","\n            ",171],["T_CONSTANT_ENCAPSED_STRING","'username'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],"[",["T_CONSTANT_ENCAPSED_STRING","'mariano'",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'phpnut'",172],"]",",",["T_WHITESPACE","\n            ",172],["T_CONSTANT_ENCAPSED_STRING","'password'",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'my password'",173],["T_WHITESPACE","\n        ",173],"]",";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","assertFalse",175],"(",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","auth",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","authenticate",175],"(",["T_VARIABLE","$request",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","response",175],")",")",";",["T_WHITESPACE","\n\n        ",175],["T_VARIABLE","$request",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","data",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],"[",["T_WHITESPACE","\n            ",177],["T_CONSTANT_ENCAPSED_STRING","'username'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'mariano'",178],",",["T_WHITESPACE","\n            ",178],["T_CONSTANT_ENCAPSED_STRING","'password'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],"[",["T_CONSTANT_ENCAPSED_STRING","'password1'",179],",",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'password2'",179],"]",["T_WHITESPACE","\n        ",179],"]",";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","assertFalse",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","auth",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","authenticate",181],"(",["T_VARIABLE","$request",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","response",181],")",")",";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",184],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","testAuthenticateInjection",189],"(",")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$request",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_NEW","new",191],["T_WHITESPACE"," ",191],["T_STRING","Request",191],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",191],")",";",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$request",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","data",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],"[",["T_WHITESPACE","\n            ",192],["T_CONSTANT_ENCAPSED_STRING","'username'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'> 1'",193],",",["T_WHITESPACE","\n            ",193],["T_CONSTANT_ENCAPSED_STRING","'password'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","\"' OR 1 = 1\"",194],["T_WHITESPACE","\n        ",194],"]",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","assertFalse",196],"(",["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","auth",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","authenticate",196],"(",["T_VARIABLE","$request",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","response",196],")",")",";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n\n    ",197],["T_DOC_COMMENT","\/**\n     * test authenticate success\n     *\n     * @return void\n     *\/",199],["T_WHITESPACE","\n    ",203],["T_PUBLIC","public",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","testAuthenticateSuccess",204],"(",")",["T_WHITESPACE","\n    ",204],"{",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$request",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_NEW","new",206],["T_WHITESPACE"," ",206],["T_STRING","Request",206],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",206],")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$request",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","data",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],"[",["T_WHITESPACE","\n            ",207],["T_CONSTANT_ENCAPSED_STRING","'username'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'mariano'",208],",",["T_WHITESPACE","\n            ",208],["T_CONSTANT_ENCAPSED_STRING","'password'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'password'",209],["T_WHITESPACE","\n        ",209],"]",";",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$result",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","auth",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","authenticate",211],"(",["T_VARIABLE","$request",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","response",211],")",";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$expected",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],"[",["T_WHITESPACE","\n            ",212],["T_CONSTANT_ENCAPSED_STRING","'id'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_LNUMBER","1",213],",",["T_WHITESPACE","\n            ",213],["T_CONSTANT_ENCAPSED_STRING","'username'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'mariano'",214],",",["T_WHITESPACE","\n            ",214],["T_CONSTANT_ENCAPSED_STRING","'created'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_NEW","new",215],["T_WHITESPACE"," ",215],["T_STRING","Time",215],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",215],")",",",["T_WHITESPACE","\n            ",215],["T_CONSTANT_ENCAPSED_STRING","'updated'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_NEW","new",216],["T_WHITESPACE"," ",216],["T_STRING","Time",216],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",216],")",["T_WHITESPACE","\n        ",216],"]",";",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","assertEquals",218],"(",["T_VARIABLE","$expected",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$result",218],")",";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Test that authenticate() includes virtual fields.\n     *\n     * @return void\n     *\/",221],["T_WHITESPACE","\n    ",225],["T_PUBLIC","public",226],["T_WHITESPACE"," ",226],["T_FUNCTION","function",226],["T_WHITESPACE"," ",226],["T_STRING","testAuthenticateIncludesVirtualFields",226],"(",")",["T_WHITESPACE","\n    ",226],"{",["T_WHITESPACE","\n        ",227],["T_VARIABLE","$users",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","TableRegistry",228],["T_DOUBLE_COLON","::",228],["T_STRING","get",228],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",228],")",";",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$users",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","entityClass",229],"(",["T_CONSTANT_ENCAPSED_STRING","'TestApp\\Model\\Entity\\VirtualUser'",229],")",";",["T_WHITESPACE","\n\n        ",229],["T_VARIABLE","$request",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_NEW","new",231],["T_WHITESPACE"," ",231],["T_STRING","Request",231],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",231],")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$request",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","data",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],"[",["T_WHITESPACE","\n            ",232],["T_CONSTANT_ENCAPSED_STRING","'username'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'mariano'",233],",",["T_WHITESPACE","\n            ",233],["T_CONSTANT_ENCAPSED_STRING","'password'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'password'",234],["T_WHITESPACE","\n        ",234],"]",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$result",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","auth",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","authenticate",236],"(",["T_VARIABLE","$request",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","response",236],")",";",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$expected",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],"[",["T_WHITESPACE","\n            ",237],["T_CONSTANT_ENCAPSED_STRING","'id'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],["T_LNUMBER","1",238],",",["T_WHITESPACE","\n            ",238],["T_CONSTANT_ENCAPSED_STRING","'username'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'mariano'",239],",",["T_WHITESPACE","\n            ",239],["T_CONSTANT_ENCAPSED_STRING","'bonus'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_CONSTANT_ENCAPSED_STRING","'bonus'",240],",",["T_WHITESPACE","\n            ",240],["T_CONSTANT_ENCAPSED_STRING","'created'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_NEW","new",241],["T_WHITESPACE"," ",241],["T_STRING","Time",241],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",241],")",",",["T_WHITESPACE","\n            ",241],["T_CONSTANT_ENCAPSED_STRING","'updated'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_NEW","new",242],["T_WHITESPACE"," ",242],["T_STRING","Time",242],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",242],")",["T_WHITESPACE","\n        ",242],"]",";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","assertEquals",244],"(",["T_VARIABLE","$expected",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$result",244],")",";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * test a model in a plugin.\n     *\n     * @return void\n     *\/",247],["T_WHITESPACE","\n    ",251],["T_PUBLIC","public",252],["T_WHITESPACE"," ",252],["T_FUNCTION","function",252],["T_WHITESPACE"," ",252],["T_STRING","testPluginModel",252],"(",")",["T_WHITESPACE","\n    ",252],"{",["T_WHITESPACE","\n        ",253],["T_STRING","Plugin",254],["T_DOUBLE_COLON","::",254],["T_STRING","load",254],"(",["T_CONSTANT_ENCAPSED_STRING","'TestPlugin'",254],")",";",["T_WHITESPACE","\n\n        ",254],["T_VARIABLE","$PluginModel",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_STRING","TableRegistry",256],["T_DOUBLE_COLON","::",256],["T_STRING","get",256],"(",["T_CONSTANT_ENCAPSED_STRING","'TestPlugin.AuthUsers'",256],")",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$user",257],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",257],"]",["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_LNUMBER","1",257],";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$user",258],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",258],"]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'gwoo'",258],";",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$user",259],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",259],"]",["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_STRING","password_hash",259],"(",["T_STRING","Security",259],["T_DOUBLE_COLON","::",259],["T_STRING","salt",259],"(",")",["T_WHITESPACE"," ",259],".",["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'cake'",259],",",["T_WHITESPACE"," ",259],["T_STRING","PASSWORD_BCRYPT",259],")",";",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$PluginModel",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","save",260],"(",["T_NEW","new",260],["T_WHITESPACE"," ",260],["T_STRING","Entity",260],"(",["T_VARIABLE","$user",260],")",")",";",["T_WHITESPACE","\n\n        ",260],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","auth",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","config",262],"(",["T_CONSTANT_ENCAPSED_STRING","'userModel'",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'TestPlugin.AuthUsers'",262],")",";",["T_WHITESPACE","\n\n        ",262],["T_VARIABLE","$request",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_NEW","new",264],["T_WHITESPACE"," ",264],["T_STRING","Request",264],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",264],")",";",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$request",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","data",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],"[",["T_WHITESPACE","\n            ",265],["T_CONSTANT_ENCAPSED_STRING","'username'",266],["T_WHITESPACE"," ",266],["T_DOUBLE_ARROW","=>",266],["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'gwoo'",266],",",["T_WHITESPACE","\n            ",266],["T_CONSTANT_ENCAPSED_STRING","'password'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'cake'",267],["T_WHITESPACE","\n        ",267],"]",";",["T_WHITESPACE","\n\n        ",268],["T_VARIABLE","$result",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","auth",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","authenticate",270],"(",["T_VARIABLE","$request",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","response",270],")",";",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$expected",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],"[",["T_WHITESPACE","\n            ",271],["T_CONSTANT_ENCAPSED_STRING","'id'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_LNUMBER","1",272],",",["T_WHITESPACE","\n            ",272],["T_CONSTANT_ENCAPSED_STRING","'username'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_CONSTANT_ENCAPSED_STRING","'gwoo'",273],",",["T_WHITESPACE","\n            ",273],["T_CONSTANT_ENCAPSED_STRING","'created'",274],["T_WHITESPACE"," ",274],["T_DOUBLE_ARROW","=>",274],["T_WHITESPACE"," ",274],["T_NEW","new",274],["T_WHITESPACE"," ",274],["T_STRING","Time",274],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",274],")",",",["T_WHITESPACE","\n            ",274],["T_CONSTANT_ENCAPSED_STRING","'updated'",275],["T_WHITESPACE"," ",275],["T_DOUBLE_ARROW","=>",275],["T_WHITESPACE"," ",275],["T_NEW","new",275],["T_WHITESPACE"," ",275],["T_STRING","Time",275],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",275],")",["T_WHITESPACE","\n        ",275],"]",";",["T_WHITESPACE","\n        ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","assertEquals",277],"(",["T_VARIABLE","$expected",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$result",277],")",";",["T_WHITESPACE","\n        ",277],["T_STRING","Plugin",278],["T_DOUBLE_COLON","::",278],["T_STRING","unload",278],"(",")",";",["T_WHITESPACE","\n    ",278],"}",["T_WHITESPACE","\n\n    ",279],["T_DOC_COMMENT","\/**\n     * Test using custom finder\n     *\n     * @return void\n     *\/",281],["T_WHITESPACE","\n    ",285],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","testFinder",286],"(",")",["T_WHITESPACE","\n    ",286],"{",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$request",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_NEW","new",288],["T_WHITESPACE"," ",288],["T_STRING","Request",288],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",288],")",";",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$request",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","data",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],"[",["T_WHITESPACE","\n            ",289],["T_CONSTANT_ENCAPSED_STRING","'username'",290],["T_WHITESPACE"," ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_CONSTANT_ENCAPSED_STRING","'mariano'",290],",",["T_WHITESPACE","\n            ",290],["T_CONSTANT_ENCAPSED_STRING","'password'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'password'",291],["T_WHITESPACE","\n        ",291],"]",";",["T_WHITESPACE","\n\n        ",292],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","auth",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","config",294],"(","[",["T_WHITESPACE","\n            ",294],["T_CONSTANT_ENCAPSED_STRING","'userModel'",295],["T_WHITESPACE"," ",295],["T_DOUBLE_ARROW","=>",295],["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",295],",",["T_WHITESPACE","\n            ",295],["T_CONSTANT_ENCAPSED_STRING","'finder'",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'auth'",296],["T_WHITESPACE","\n        ",296],"]",")",";",["T_WHITESPACE","\n\n        ",297],["T_VARIABLE","$result",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","auth",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","authenticate",299],"(",["T_VARIABLE","$request",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","response",299],")",";",["T_WHITESPACE","\n        ",299],["T_VARIABLE","$expected",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],"[",["T_WHITESPACE","\n            ",300],["T_CONSTANT_ENCAPSED_STRING","'id'",301],["T_WHITESPACE"," ",301],["T_DOUBLE_ARROW","=>",301],["T_WHITESPACE"," ",301],["T_LNUMBER","1",301],",",["T_WHITESPACE","\n            ",301],["T_CONSTANT_ENCAPSED_STRING","'username'",302],["T_WHITESPACE"," ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'mariano'",302],",",["T_WHITESPACE","\n        ",302],"]",";",["T_WHITESPACE","\n        ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","assertEquals",304],"(",["T_VARIABLE","$expected",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$result",304],",",["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'Result should not contain \"created\" and \"modified\" fields'",304],")",";",["T_WHITESPACE","\n\n        ",304],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","auth",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","config",306],"(","[",["T_WHITESPACE","\n            ",306],["T_CONSTANT_ENCAPSED_STRING","'finder'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],"[",["T_CONSTANT_ENCAPSED_STRING","'auth'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],"[",["T_CONSTANT_ENCAPSED_STRING","'return_created'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_STRING","true",307],"]","]",["T_WHITESPACE","\n        ",307],"]",")",";",["T_WHITESPACE","\n\n        ",308],["T_VARIABLE","$result",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","auth",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","authenticate",310],"(",["T_VARIABLE","$request",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","response",310],")",";",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$expected",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],"[",["T_WHITESPACE","\n            ",311],["T_CONSTANT_ENCAPSED_STRING","'id'",312],["T_WHITESPACE"," ",312],["T_DOUBLE_ARROW","=>",312],["T_WHITESPACE"," ",312],["T_LNUMBER","1",312],",",["T_WHITESPACE","\n            ",312],["T_CONSTANT_ENCAPSED_STRING","'username'",313],["T_WHITESPACE"," ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","'mariano'",313],",",["T_WHITESPACE","\n            ",313],["T_CONSTANT_ENCAPSED_STRING","'created'",314],["T_WHITESPACE"," ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_NEW","new",314],["T_WHITESPACE"," ",314],["T_STRING","Time",314],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",314],")",",",["T_WHITESPACE","\n        ",314],"]",";",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","assertEquals",316],"(",["T_VARIABLE","$expected",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$result",316],")",";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Test using custom finder\n     *\n     * @return void\n     *\/",319],["T_WHITESPACE","\n    ",323],["T_PUBLIC","public",324],["T_WHITESPACE"," ",324],["T_FUNCTION","function",324],["T_WHITESPACE"," ",324],["T_STRING","testFinderOptions",324],"(",")",["T_WHITESPACE","\n    ",324],"{",["T_WHITESPACE","\n        ",325],["T_VARIABLE","$request",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_NEW","new",326],["T_WHITESPACE"," ",326],["T_STRING","Request",326],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",326],")",";",["T_WHITESPACE","\n        ",326],["T_VARIABLE","$request",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","data",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],"[",["T_WHITESPACE","\n            ",327],["T_CONSTANT_ENCAPSED_STRING","'username'",328],["T_WHITESPACE"," ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'mariano'",328],",",["T_WHITESPACE","\n            ",328],["T_CONSTANT_ENCAPSED_STRING","'password'",329],["T_WHITESPACE"," ",329],["T_DOUBLE_ARROW","=>",329],["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'password'",329],["T_WHITESPACE","\n        ",329],"]",";",["T_WHITESPACE","\n\n        ",330],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","auth",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","config",332],"(","[",["T_WHITESPACE","\n            ",332],["T_CONSTANT_ENCAPSED_STRING","'userModel'",333],["T_WHITESPACE"," ",333],["T_DOUBLE_ARROW","=>",333],["T_WHITESPACE"," ",333],["T_CONSTANT_ENCAPSED_STRING","'AuthUsers'",333],",",["T_WHITESPACE","\n            ",333],["T_CONSTANT_ENCAPSED_STRING","'finder'",334],["T_WHITESPACE"," ",334],["T_DOUBLE_ARROW","=>",334],["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","'username'",334],["T_WHITESPACE","\n        ",334],"]",")",";",["T_WHITESPACE","\n\n        ",335],["T_VARIABLE","$result",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","auth",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","authenticate",337],"(",["T_VARIABLE","$request",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","response",337],")",";",["T_WHITESPACE","\n        ",337],["T_VARIABLE","$expected",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],"[",["T_WHITESPACE","\n            ",338],["T_CONSTANT_ENCAPSED_STRING","'id'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_LNUMBER","1",339],",",["T_WHITESPACE","\n            ",339],["T_CONSTANT_ENCAPSED_STRING","'username'",340],["T_WHITESPACE"," ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'mariano'",340],",",["T_WHITESPACE","\n        ",340],"]",";",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","assertEquals",342],"(",["T_VARIABLE","$expected",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$result",342],")",";",["T_WHITESPACE","\n\n        ",342],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","auth",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","config",344],"(","[",["T_WHITESPACE","\n            ",344],["T_CONSTANT_ENCAPSED_STRING","'finder'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","'nate'",345],"]","]",["T_WHITESPACE","\n        ",345],"]",")",";",["T_WHITESPACE","\n\n        ",346],["T_VARIABLE","$result",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","auth",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","authenticate",348],"(",["T_VARIABLE","$request",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","response",348],")",";",["T_WHITESPACE","\n        ",348],["T_VARIABLE","$expected",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],"[",["T_WHITESPACE","\n            ",349],["T_CONSTANT_ENCAPSED_STRING","'id'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_LNUMBER","5",350],",",["T_WHITESPACE","\n            ",350],["T_CONSTANT_ENCAPSED_STRING","'username'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'nate'",351],",",["T_WHITESPACE","\n        ",351],"]",";",["T_WHITESPACE","\n        ",352],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","assertEquals",353],"(",["T_VARIABLE","$expected",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$result",353],")",";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n    ",354],["T_DOC_COMMENT","\/**\n     * test password hasher settings\n     *\n     * @return void\n     *\/",356],["T_WHITESPACE","\n    ",360],["T_PUBLIC","public",361],["T_WHITESPACE"," ",361],["T_FUNCTION","function",361],["T_WHITESPACE"," ",361],["T_STRING","testPasswordHasherSettings",361],"(",")",["T_WHITESPACE","\n    ",361],"{",["T_WHITESPACE","\n        ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","auth",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","config",363],"(",["T_CONSTANT_ENCAPSED_STRING","'passwordHasher'",363],",",["T_WHITESPACE"," ",363],"[",["T_WHITESPACE","\n            ",363],["T_CONSTANT_ENCAPSED_STRING","'className'",364],["T_WHITESPACE"," ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","'Default'",364],",",["T_WHITESPACE","\n            ",364],["T_CONSTANT_ENCAPSED_STRING","'hashType'",365],["T_WHITESPACE"," ",365],["T_DOUBLE_ARROW","=>",365],["T_WHITESPACE"," ",365],["T_STRING","PASSWORD_BCRYPT",365],["T_WHITESPACE","\n        ",365],"]",")",";",["T_WHITESPACE","\n\n        ",366],["T_VARIABLE","$passwordHasher",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","auth",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","passwordHasher",368],"(",")",";",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$result",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$passwordHasher",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","config",369],"(",")",";",["T_WHITESPACE","\n        ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","assertEquals",370],"(",["T_STRING","PASSWORD_BCRYPT",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$result",370],"[",["T_CONSTANT_ENCAPSED_STRING","'hashType'",370],"]",")",";",["T_WHITESPACE","\n\n        ",370],["T_VARIABLE","$hash",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_STRING","password_hash",372],"(",["T_CONSTANT_ENCAPSED_STRING","'mypass'",372],",",["T_WHITESPACE"," ",372],["T_STRING","PASSWORD_BCRYPT",372],")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$User",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","TableRegistry",373],["T_DOUBLE_COLON","::",373],["T_STRING","get",373],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",373],")",";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$User",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","updateAll",374],"(",["T_WHITESPACE","\n            ",374],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",375],["T_WHITESPACE"," ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$hash",375],"]",",",["T_WHITESPACE","\n            ",375],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",376],["T_WHITESPACE"," ",376],["T_DOUBLE_ARROW","=>",376],["T_WHITESPACE"," ",376],["T_CONSTANT_ENCAPSED_STRING","'mariano'",376],"]",["T_WHITESPACE","\n        ",376],")",";",["T_WHITESPACE","\n\n        ",377],["T_VARIABLE","$request",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_NEW","new",379],["T_WHITESPACE"," ",379],["T_STRING","Request",379],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",379],")",";",["T_WHITESPACE","\n        ",379],["T_VARIABLE","$request",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","data",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],"[",["T_WHITESPACE","\n            ",380],["T_CONSTANT_ENCAPSED_STRING","'username'",381],["T_WHITESPACE"," ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_CONSTANT_ENCAPSED_STRING","'mariano'",381],",",["T_WHITESPACE","\n            ",381],["T_CONSTANT_ENCAPSED_STRING","'password'",382],["T_WHITESPACE"," ",382],["T_DOUBLE_ARROW","=>",382],["T_WHITESPACE"," ",382],["T_CONSTANT_ENCAPSED_STRING","'mypass'",382],["T_WHITESPACE","\n        ",382],"]",";",["T_WHITESPACE","\n\n        ",383],["T_VARIABLE","$result",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","auth",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","authenticate",385],"(",["T_VARIABLE","$request",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","response",385],")",";",["T_WHITESPACE","\n        ",385],["T_VARIABLE","$expected",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],"[",["T_WHITESPACE","\n            ",386],["T_CONSTANT_ENCAPSED_STRING","'id'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_LNUMBER","1",387],",",["T_WHITESPACE","\n            ",387],["T_CONSTANT_ENCAPSED_STRING","'username'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_CONSTANT_ENCAPSED_STRING","'mariano'",388],",",["T_WHITESPACE","\n            ",388],["T_CONSTANT_ENCAPSED_STRING","'created'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_NEW","new",389],["T_WHITESPACE"," ",389],["T_STRING","Time",389],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",389],")",",",["T_WHITESPACE","\n            ",389],["T_CONSTANT_ENCAPSED_STRING","'updated'",390],["T_WHITESPACE"," ",390],["T_DOUBLE_ARROW","=>",390],["T_WHITESPACE"," ",390],["T_NEW","new",390],["T_WHITESPACE"," ",390],["T_STRING","Time",390],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",390],")",["T_WHITESPACE","\n        ",390],"]",";",["T_WHITESPACE","\n        ",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","assertEquals",392],"(",["T_VARIABLE","$expected",392],",",["T_WHITESPACE"," ",392],["T_VARIABLE","$result",392],")",";",["T_WHITESPACE","\n\n        ",392],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","auth",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_NEW","new",394],["T_WHITESPACE"," ",394],["T_STRING","FormAuthenticate",394],"(",["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","Collection",394],",",["T_WHITESPACE"," ",394],"[",["T_WHITESPACE","\n            ",394],["T_CONSTANT_ENCAPSED_STRING","'fields'",395],["T_WHITESPACE"," ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",395],["T_WHITESPACE"," ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_CONSTANT_ENCAPSED_STRING","'username'",395],",",["T_WHITESPACE"," ",395],["T_CONSTANT_ENCAPSED_STRING","'password'",395],["T_WHITESPACE"," ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_CONSTANT_ENCAPSED_STRING","'password'",395],"]",",",["T_WHITESPACE","\n            ",395],["T_CONSTANT_ENCAPSED_STRING","'userModel'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_CONSTANT_ENCAPSED_STRING","'Users'",396],["T_WHITESPACE","\n        ",396],"]",")",";",["T_WHITESPACE","\n        ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","auth",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","config",398],"(",["T_CONSTANT_ENCAPSED_STRING","'passwordHasher'",398],",",["T_WHITESPACE"," ",398],"[",["T_WHITESPACE","\n            ",398],["T_CONSTANT_ENCAPSED_STRING","'className'",399],["T_WHITESPACE"," ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],["T_CONSTANT_ENCAPSED_STRING","'Default'",399],["T_WHITESPACE","\n        ",399],"]",")",";",["T_WHITESPACE","\n        ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","assertEquals",401],"(",["T_VARIABLE","$expected",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","auth",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","authenticate",401],"(",["T_VARIABLE","$request",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","response",401],")",")",";",["T_WHITESPACE","\n\n        ",401],["T_VARIABLE","$User",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","updateAll",403],"(",["T_WHITESPACE","\n            ",403],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",404],["T_WHITESPACE"," ",404],["T_DOUBLE_ARROW","=>",404],["T_WHITESPACE"," ",404],["T_CONSTANT_ENCAPSED_STRING","'$2y$10$\/G9GBQDZhWUM4w\/WLes3b.XBZSK1hGohs5dMi0vh\/oen0l0a7DUyK'",404],"]",",",["T_WHITESPACE","\n            ",404],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",405],["T_WHITESPACE"," ",405],["T_DOUBLE_ARROW","=>",405],["T_WHITESPACE"," ",405],["T_CONSTANT_ENCAPSED_STRING","'mariano'",405],"]",["T_WHITESPACE","\n        ",405],")",";",["T_WHITESPACE","\n        ",406],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","assertFalse",407],"(",["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","auth",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","authenticate",407],"(",["T_VARIABLE","$request",407],",",["T_WHITESPACE"," ",407],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","response",407],")",")",";",["T_WHITESPACE","\n    ",407],"}",["T_WHITESPACE","\n\n    ",408],["T_DOC_COMMENT","\/**\n     * Tests that using default means password don't need to be rehashed\n     *\n     * @return void\n     *\/",410],["T_WHITESPACE","\n    ",414],["T_PUBLIC","public",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","testAuthenticateNoRehash",415],"(",")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_VARIABLE","$request",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_NEW","new",417],["T_WHITESPACE"," ",417],["T_STRING","Request",417],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",417],")",";",["T_WHITESPACE","\n        ",417],["T_VARIABLE","$request",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","data",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],"[",["T_WHITESPACE","\n            ",418],["T_CONSTANT_ENCAPSED_STRING","'username'",419],["T_WHITESPACE"," ",419],["T_DOUBLE_ARROW","=>",419],["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'mariano'",419],",",["T_WHITESPACE","\n            ",419],["T_CONSTANT_ENCAPSED_STRING","'password'",420],["T_WHITESPACE"," ",420],["T_DOUBLE_ARROW","=>",420],["T_WHITESPACE"," ",420],["T_CONSTANT_ENCAPSED_STRING","'password'",420],["T_WHITESPACE","\n        ",420],"]",";",["T_WHITESPACE","\n        ",421],["T_VARIABLE","$result",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","auth",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","authenticate",422],"(",["T_VARIABLE","$request",422],",",["T_WHITESPACE"," ",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","response",422],")",";",["T_WHITESPACE","\n        ",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","assertNotEmpty",423],"(",["T_VARIABLE","$result",423],")",";",["T_WHITESPACE","\n        ",423],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","assertFalse",424],"(",["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","auth",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","needsPasswordRehash",424],"(",")",")",";",["T_WHITESPACE","\n    ",424],"}",["T_WHITESPACE","\n\n    ",425],["T_DOC_COMMENT","\/**\n     * Tests that not using the Default password hasher means that the password\n     * needs to be rehashed\n     *\n     * @return void\n     *\/",427],["T_WHITESPACE","\n    ",432],["T_PUBLIC","public",433],["T_WHITESPACE"," ",433],["T_FUNCTION","function",433],["T_WHITESPACE"," ",433],["T_STRING","testAuthenticateRehash",433],"(",")",["T_WHITESPACE","\n    ",433],"{",["T_WHITESPACE","\n        ",434],["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","auth",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_NEW","new",435],["T_WHITESPACE"," ",435],["T_STRING","FormAuthenticate",435],"(",["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","Collection",435],",",["T_WHITESPACE"," ",435],"[",["T_WHITESPACE","\n            ",435],["T_CONSTANT_ENCAPSED_STRING","'userModel'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","'Users'",436],",",["T_WHITESPACE","\n            ",436],["T_CONSTANT_ENCAPSED_STRING","'passwordHasher'",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","'Weak'",437],["T_WHITESPACE","\n        ",437],"]",")",";",["T_WHITESPACE","\n        ",438],["T_VARIABLE","$password",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","auth",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","passwordHasher",439],"(",")",["T_OBJECT_OPERATOR","->",439],["T_STRING","hash",439],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",439],")",";",["T_WHITESPACE","\n        ",439],["T_STRING","TableRegistry",440],["T_DOUBLE_COLON","::",440],["T_STRING","get",440],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",440],")",["T_OBJECT_OPERATOR","->",440],["T_STRING","updateAll",440],"(","[",["T_CONSTANT_ENCAPSED_STRING","'password'",440],["T_WHITESPACE"," ",440],["T_DOUBLE_ARROW","=>",440],["T_WHITESPACE"," ",440],["T_VARIABLE","$password",440],"]",",",["T_WHITESPACE"," ",440],"[","]",")",";",["T_WHITESPACE","\n\n        ",440],["T_VARIABLE","$request",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_NEW","new",442],["T_WHITESPACE"," ",442],["T_STRING","Request",442],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",442],")",";",["T_WHITESPACE","\n        ",442],["T_VARIABLE","$request",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","data",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],"[",["T_WHITESPACE","\n            ",443],["T_CONSTANT_ENCAPSED_STRING","'username'",444],["T_WHITESPACE"," ",444],["T_DOUBLE_ARROW","=>",444],["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'mariano'",444],",",["T_WHITESPACE","\n            ",444],["T_CONSTANT_ENCAPSED_STRING","'password'",445],["T_WHITESPACE"," ",445],["T_DOUBLE_ARROW","=>",445],["T_WHITESPACE"," ",445],["T_CONSTANT_ENCAPSED_STRING","'password'",445],["T_WHITESPACE","\n        ",445],"]",";",["T_WHITESPACE","\n        ",446],["T_VARIABLE","$result",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","auth",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","authenticate",447],"(",["T_VARIABLE","$request",447],",",["T_WHITESPACE"," ",447],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","response",447],")",";",["T_WHITESPACE","\n        ",447],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","assertNotEmpty",448],"(",["T_VARIABLE","$result",448],")",";",["T_WHITESPACE","\n        ",448],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","assertTrue",449],"(",["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","auth",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","needsPasswordRehash",449],"(",")",")",";",["T_WHITESPACE","\n    ",449],"}",["T_WHITESPACE","\n",450],"}",["T_WHITESPACE","\n",451]]