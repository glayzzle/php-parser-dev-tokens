[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * DigestAuthenticateTest file\n *\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         2.0.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",16],["T_NAMESPACE","namespace",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Test",17],["T_NS_SEPARATOR","\\",17],["T_STRING","TestCase",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Auth",17],";",["T_WHITESPACE","\n\n",17],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Auth",19],["T_NS_SEPARATOR","\\",19],["T_STRING","DigestAuthenticate",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Controller",20],["T_NS_SEPARATOR","\\",20],["T_STRING","ComponentRegistry",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Cake",21],["T_NS_SEPARATOR","\\",21],["T_STRING","I18n",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Time",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Cake",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Network",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Exception",22],["T_NS_SEPARATOR","\\",22],["T_STRING","UnauthorizedException",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Cake",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Network",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Request",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Cake",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Network",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Response",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Cake",25],["T_NS_SEPARATOR","\\",25],["T_STRING","ORM",25],["T_NS_SEPARATOR","\\",25],["T_STRING","TableRegistry",25],";",["T_WHITESPACE","\n",25],["T_USE","use",26],["T_WHITESPACE"," ",26],["T_STRING","Cake",26],["T_NS_SEPARATOR","\\",26],["T_STRING","TestSuite",26],["T_NS_SEPARATOR","\\",26],["T_STRING","TestCase",26],";",["T_WHITESPACE","\n\n",26],["T_DOC_COMMENT","\/**\n * Test case for DigestAuthentication\n *\/",28],["T_WHITESPACE","\n",30],["T_CLASS","class",31],["T_WHITESPACE"," ",31],["T_STRING","DigestAuthenticateTest",31],["T_WHITESPACE"," ",31],["T_EXTENDS","extends",31],["T_WHITESPACE"," ",31],["T_STRING","TestCase",31],["T_WHITESPACE","\n",31],"{",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Fixtures\n     *\n     * @var array\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$fixtures",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],"[",["T_CONSTANT_ENCAPSED_STRING","'core.auth_users'",39],",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'core.users'",39],"]",";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * setup\n     *\n     * @return void\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","setUp",46],"(",")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_STRING","parent",48],["T_DOUBLE_COLON","::",48],["T_STRING","setUp",48],"(",")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","Collection",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getMockBuilder",50],"(",["T_STRING","ComponentRegistry",50],["T_DOUBLE_COLON","::",50],["T_CLASS","class",50],")",["T_OBJECT_OPERATOR","->",50],["T_STRING","getMock",50],"(",")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","auth",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_NEW","new",51],["T_WHITESPACE"," ",51],["T_STRING","DigestAuthenticate",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","Collection",51],",",["T_WHITESPACE"," ",51],"[",["T_WHITESPACE","\n            ",51],["T_CONSTANT_ENCAPSED_STRING","'realm'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'localhost'",52],",",["T_WHITESPACE","\n            ",52],["T_CONSTANT_ENCAPSED_STRING","'nonce'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_LNUMBER","123",53],",",["T_WHITESPACE","\n            ",53],["T_CONSTANT_ENCAPSED_STRING","'opaque'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'123abc'",54],["T_WHITESPACE","\n        ",54],"]",")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$password",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","DigestAuthenticate",57],["T_DOUBLE_COLON","::",57],["T_STRING","password",57],"(",["T_CONSTANT_ENCAPSED_STRING","'mariano'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'cake'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'localhost'",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$User",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","TableRegistry",58],["T_DOUBLE_COLON","::",58],["T_STRING","get",58],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",58],")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$User",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","updateAll",59],"(","[",["T_CONSTANT_ENCAPSED_STRING","'password'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$password",59],"]",",",["T_WHITESPACE"," ",59],"[","]",")",";",["T_WHITESPACE","\n\n        ",59],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","response",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getMockBuilder",61],"(",["T_STRING","Response",61],["T_DOUBLE_COLON","::",61],["T_CLASS","class",61],")",["T_OBJECT_OPERATOR","->",61],["T_STRING","getMock",61],"(",")",";",["T_WHITESPACE","\n    ",61],"}",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * test applying settings in the constructor\n     *\n     * @return void\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","testConstructor",69],"(",")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$object",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_NEW","new",71],["T_WHITESPACE"," ",71],["T_STRING","DigestAuthenticate",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","Collection",71],",",["T_WHITESPACE"," ",71],"[",["T_WHITESPACE","\n            ",71],["T_CONSTANT_ENCAPSED_STRING","'userModel'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'AuthUser'",72],",",["T_WHITESPACE","\n            ",72],["T_CONSTANT_ENCAPSED_STRING","'fields'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'user'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'password'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'pass'",73],"]",",",["T_WHITESPACE","\n            ",73],["T_CONSTANT_ENCAPSED_STRING","'nonce'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_LNUMBER","123456",74],["T_WHITESPACE","\n        ",74],"]",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertEquals",76],"(",["T_CONSTANT_ENCAPSED_STRING","'AuthUser'",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$object",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","config",76],"(",["T_CONSTANT_ENCAPSED_STRING","'userModel'",76],")",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertEquals",77],"(","[",["T_CONSTANT_ENCAPSED_STRING","'username'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'user'",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'password'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'pass'",77],"]",",",["T_WHITESPACE"," ",77],["T_VARIABLE","$object",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","config",77],"(",["T_CONSTANT_ENCAPSED_STRING","'fields'",77],")",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","assertEquals",78],"(",["T_LNUMBER","123456",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$object",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","config",78],"(",["T_CONSTANT_ENCAPSED_STRING","'nonce'",78],")",")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertEquals",79],"(",["T_STRING","env",79],"(",["T_CONSTANT_ENCAPSED_STRING","'SERVER_NAME'",79],")",",",["T_WHITESPACE"," ",79],["T_VARIABLE","$object",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","config",79],"(",["T_CONSTANT_ENCAPSED_STRING","'realm'",79],")",")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @return void\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","testAuthenticateNoData",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$request",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_STRING","Request",89],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",89],")",";",["T_WHITESPACE","\n\n        ",89],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","response",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","expects",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","never",91],"(",")",")",["T_WHITESPACE","\n            ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","method",92],"(",["T_CONSTANT_ENCAPSED_STRING","'header'",92],")",";",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertFalse",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","auth",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getUser",94],"(",["T_VARIABLE","$request",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","response",94],")",")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * test the authenticate method\n     *\n     * @expectedException \\Cake\\Network\\Exception\\UnauthorizedException\n     * @expectedExceptionCode 401\n     * @return void\n     *\/",97],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","testAuthenticateWrongUsername",104],"(",")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$request",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_NEW","new",106],["T_WHITESPACE"," ",106],["T_STRING","Request",106],"(",["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",106],")",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$request",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","addParams",107],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$digest",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_START_HEREDOC","<<<DIGEST\n",109],["T_ENCAPSED_AND_WHITESPACE","Digest username=\"incorrect_user\",\nrealm=\"localhost\",\nnonce=\"123456\",\nuri=\"\/dir\/index.html\",\nqop=auth,\nnc=00000001,\ncnonce=\"0a4f113b\",\nresponse=\"6629fae49393a05397450978507c4ef1\",\nopaque=\"123abc\"\n",110],["T_END_HEREDOC","DIGEST",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$request",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","env",120],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$digest",120],")",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","auth",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","unauthenticated",122],"(",["T_VARIABLE","$request",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","response",122],")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * test that challenge headers are sent when no credentials are found.\n     *\n     * @return void\n     *\/",125],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","testAuthenticateChallenge",130],"(",")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$request",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_STRING","Request",132],"(","[",["T_WHITESPACE","\n            ",132],["T_CONSTANT_ENCAPSED_STRING","'url'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",133],",",["T_WHITESPACE","\n            ",133],["T_CONSTANT_ENCAPSED_STRING","'environment'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'GET'",134],"]",["T_WHITESPACE","\n        ",134],"]",")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$request",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","addParams",136],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",136],["T_TRY","try",138],["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","auth",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","unauthenticated",139],"(",["T_VARIABLE","$request",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","response",139],")",";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE"," ",140],["T_CATCH","catch",140],["T_WHITESPACE"," ",140],"(",["T_STRING","UnauthorizedException",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$e",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","assertNotEmpty",143],"(",["T_VARIABLE","$e",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$expected",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],"[",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Digest realm=\"localhost\",qop=\"auth\",nonce=\"123\",opaque=\"123abc\"'",145],"]",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","assertEquals",146],"(",["T_VARIABLE","$expected",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$e",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","responseHeader",146],"(",")",")",";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * test authenticate success\n     *\n     * @return void\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","testAuthenticateSuccess",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$request",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_NEW","new",156],["T_WHITESPACE"," ",156],["T_STRING","Request",156],"(","[",["T_WHITESPACE","\n            ",156],["T_CONSTANT_ENCAPSED_STRING","'url'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",157],",",["T_WHITESPACE","\n            ",157],["T_CONSTANT_ENCAPSED_STRING","'environment'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'GET'",158],"]",["T_WHITESPACE","\n        ",158],"]",")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$request",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","addParams",160],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$digest",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_START_HEREDOC","<<<DIGEST\n",162],["T_ENCAPSED_AND_WHITESPACE","Digest username=\"mariano\",\nrealm=\"localhost\",\nnonce=\"123\",\nuri=\"\/dir\/index.html\",\nqop=auth,\nnc=1,\ncnonce=\"123\",\nresponse=\"06b257a54befa2ddfb9bfa134224aa29\",\nopaque=\"123abc\"\n",163],["T_END_HEREDOC","DIGEST",172],";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$request",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","env",173],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$digest",173],")",";",["T_WHITESPACE","\n\n        ",173],["T_VARIABLE","$result",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","auth",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","authenticate",175],"(",["T_VARIABLE","$request",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","response",175],")",";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$expected",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],"[",["T_WHITESPACE","\n            ",176],["T_CONSTANT_ENCAPSED_STRING","'id'",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_LNUMBER","1",177],",",["T_WHITESPACE","\n            ",177],["T_CONSTANT_ENCAPSED_STRING","'username'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'mariano'",178],",",["T_WHITESPACE","\n            ",178],["T_CONSTANT_ENCAPSED_STRING","'created'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_NEW","new",179],["T_WHITESPACE"," ",179],["T_STRING","Time",179],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",179],")",",",["T_WHITESPACE","\n            ",179],["T_CONSTANT_ENCAPSED_STRING","'updated'",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],["T_NEW","new",180],["T_WHITESPACE"," ",180],["T_STRING","Time",180],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",180],")",["T_WHITESPACE","\n        ",180],"]",";",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","assertEquals",182],"(",["T_VARIABLE","$expected",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$result",182],")",";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * test authenticate success\n     *\n     * @return void\n     *\/",185],["T_WHITESPACE","\n    ",189],["T_PUBLIC","public",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","testAuthenticateSuccessSimulatedRequestMethod",190],"(",")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$request",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_NEW","new",192],["T_WHITESPACE"," ",192],["T_STRING","Request",192],"(","[",["T_WHITESPACE","\n            ",192],["T_CONSTANT_ENCAPSED_STRING","'url'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",193],",",["T_WHITESPACE","\n            ",193],["T_CONSTANT_ENCAPSED_STRING","'post'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],"[",["T_CONSTANT_ENCAPSED_STRING","'_method'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'PUT'",194],"]",",",["T_WHITESPACE","\n            ",194],["T_CONSTANT_ENCAPSED_STRING","'environment'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'GET'",195],"]",["T_WHITESPACE","\n        ",195],"]",")",";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$request",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","addParams",197],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",197],["T_VARIABLE","$digest",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_START_HEREDOC","<<<DIGEST\n",199],["T_ENCAPSED_AND_WHITESPACE","Digest username=\"mariano\",\nrealm=\"localhost\",\nnonce=\"123\",\nuri=\"\/dir\/index.html\",\nqop=auth,\nnc=1,\ncnonce=\"123\",\nresponse=\"06b257a54befa2ddfb9bfa134224aa29\",\nopaque=\"123abc\"\n",200],["T_END_HEREDOC","DIGEST",209],";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$request",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","env",210],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$digest",210],")",";",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$result",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","auth",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","authenticate",212],"(",["T_VARIABLE","$request",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","response",212],")",";",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$expected",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],"[",["T_WHITESPACE","\n            ",213],["T_CONSTANT_ENCAPSED_STRING","'id'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_LNUMBER","1",214],",",["T_WHITESPACE","\n            ",214],["T_CONSTANT_ENCAPSED_STRING","'username'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'mariano'",215],",",["T_WHITESPACE","\n            ",215],["T_CONSTANT_ENCAPSED_STRING","'created'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_NEW","new",216],["T_WHITESPACE"," ",216],["T_STRING","Time",216],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:16:23'",216],")",",",["T_WHITESPACE","\n            ",216],["T_CONSTANT_ENCAPSED_STRING","'updated'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_NEW","new",217],["T_WHITESPACE"," ",217],["T_STRING","Time",217],"(",["T_CONSTANT_ENCAPSED_STRING","'2007-03-17 01:18:31'",217],")",["T_WHITESPACE","\n        ",217],"]",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","assertEquals",219],"(",["T_VARIABLE","$expected",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$result",219],")",";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n\n    ",220],["T_DOC_COMMENT","\/**\n     * test scope failure.\n     *\n     * @expectedException \\Cake\\Network\\Exception\\UnauthorizedException\n     * @expectedExceptionCode 401\n     * @return void\n     *\/",222],["T_WHITESPACE","\n    ",228],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","testAuthenticateFailReChallenge",229],"(",")",["T_WHITESPACE","\n    ",229],"{",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","auth",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","config",231],"(",["T_CONSTANT_ENCAPSED_STRING","'scope.username'",231],",",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'nate'",231],")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$request",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_NEW","new",232],["T_WHITESPACE"," ",232],["T_STRING","Request",232],"(","[",["T_WHITESPACE","\n            ",232],["T_CONSTANT_ENCAPSED_STRING","'url'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'posts\/index'",233],",",["T_WHITESPACE","\n            ",233],["T_CONSTANT_ENCAPSED_STRING","'environment'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'GET'",234],"]",["T_WHITESPACE","\n        ",234],"]",")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$request",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","addParams",236],"(","[",["T_CONSTANT_ENCAPSED_STRING","'pass'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],"[","]","]",")",";",["T_WHITESPACE","\n\n        ",236],["T_VARIABLE","$digest",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_START_HEREDOC","<<<DIGEST\n",238],["T_ENCAPSED_AND_WHITESPACE","Digest username=\"mariano\",\nrealm=\"localhost\",\nnonce=\"123\",\nuri=\"\/dir\/index.html\",\nqop=auth,\nnc=1,\ncnonce=\"123\",\nresponse=\"6629fae49393a05397450978507c4ef1\",\nopaque=\"123abc\"\n",239],["T_END_HEREDOC","DIGEST",248],";",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$request",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","env",249],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$digest",249],")",";",["T_WHITESPACE","\n\n        ",249],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","auth",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","unauthenticated",251],"(",["T_VARIABLE","$request",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","response",251],")",";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * testLoginHeaders method\n     *\n     * @return void\n     *\/",254],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","testLoginHeaders",259],"(",")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$request",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_NEW","new",261],["T_WHITESPACE"," ",261],["T_STRING","Request",261],"(","[",["T_WHITESPACE","\n            ",261],["T_CONSTANT_ENCAPSED_STRING","'environment'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],"[",["T_CONSTANT_ENCAPSED_STRING","'SERVER_NAME'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'localhost'",262],"]",["T_WHITESPACE","\n        ",262],"]",")",";",["T_WHITESPACE","\n        ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","auth",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_NEW","new",264],["T_WHITESPACE"," ",264],["T_STRING","DigestAuthenticate",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","Collection",264],",",["T_WHITESPACE"," ",264],"[",["T_WHITESPACE","\n            ",264],["T_CONSTANT_ENCAPSED_STRING","'realm'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'localhost'",265],",",["T_WHITESPACE","\n            ",265],["T_CONSTANT_ENCAPSED_STRING","'nonce'",266],["T_WHITESPACE"," ",266],["T_DOUBLE_ARROW","=>",266],["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'123'",266],["T_WHITESPACE","\n        ",266],"]",")",";",["T_WHITESPACE","\n        ",267],["T_VARIABLE","$expected",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate: Digest realm=\"localhost\",qop=\"auth\",nonce=\"123\",opaque=\"421aa90e079fa326b6494f812ad13e79\"'",268],";",["T_WHITESPACE","\n        ",268],["T_VARIABLE","$result",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","auth",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","loginHeaders",269],"(",["T_VARIABLE","$request",269],")",";",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","assertEquals",270],"(",["T_VARIABLE","$expected",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$result",270],")",";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * testParseDigestAuthData method\n     *\n     * @return void\n     *\/",273],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","testParseAuthData",278],"(",")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$digest",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_START_HEREDOC","<<<DIGEST\n",280],["T_ENCAPSED_AND_WHITESPACE","\t\t\tDigest username=\"Mufasa\",\n\t\t\trealm=\"testrealm@host.com\",\n\t\t\tnonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n\t\t\turi=\"\/dir\/index.html?query=string&value=some%20value\",\n\t\t\tqop=auth,\n\t\t\tnc=00000001,\n\t\t\tcnonce=\"0a4f113b\",\n\t\t\tresponse=\"6629fae49393a05397450978507c4ef1\",\n\t\t\topaque=\"5ccc069c403ebaf9f0171e9517f40e41\"\n",281],["T_END_HEREDOC","DIGEST",290],";",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$expected",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],"[",["T_WHITESPACE","\n            ",291],["T_CONSTANT_ENCAPSED_STRING","'username'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'Mufasa'",292],",",["T_WHITESPACE","\n            ",292],["T_CONSTANT_ENCAPSED_STRING","'realm'",293],["T_WHITESPACE"," ",293],["T_DOUBLE_ARROW","=>",293],["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'testrealm@host.com'",293],",",["T_WHITESPACE","\n            ",293],["T_CONSTANT_ENCAPSED_STRING","'nonce'",294],["T_WHITESPACE"," ",294],["T_DOUBLE_ARROW","=>",294],["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'dcd98b7102dd2f0e8b11d0f600bfb0c093'",294],",",["T_WHITESPACE","\n            ",294],["T_CONSTANT_ENCAPSED_STRING","'uri'",295],["T_WHITESPACE"," ",295],["T_DOUBLE_ARROW","=>",295],["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","'\/dir\/index.html?query=string&value=some%20value'",295],",",["T_WHITESPACE","\n            ",295],["T_CONSTANT_ENCAPSED_STRING","'qop'",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'auth'",296],",",["T_WHITESPACE","\n            ",296],["T_CONSTANT_ENCAPSED_STRING","'nc'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'00000001'",297],",",["T_WHITESPACE","\n            ",297],["T_CONSTANT_ENCAPSED_STRING","'cnonce'",298],["T_WHITESPACE"," ",298],["T_DOUBLE_ARROW","=>",298],["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'0a4f113b'",298],",",["T_WHITESPACE","\n            ",298],["T_CONSTANT_ENCAPSED_STRING","'response'",299],["T_WHITESPACE"," ",299],["T_DOUBLE_ARROW","=>",299],["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'6629fae49393a05397450978507c4ef1'",299],",",["T_WHITESPACE","\n            ",299],["T_CONSTANT_ENCAPSED_STRING","'opaque'",300],["T_WHITESPACE"," ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","'5ccc069c403ebaf9f0171e9517f40e41'",300],["T_WHITESPACE","\n        ",300],"]",";",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$result",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","auth",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","parseAuthData",302],"(",["T_VARIABLE","$digest",302],")",";",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","assertSame",303],"(",["T_VARIABLE","$expected",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$result",303],")",";",["T_WHITESPACE","\n\n        ",303],["T_VARIABLE","$result",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","auth",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","parseAuthData",305],"(",["T_CONSTANT_ENCAPSED_STRING","''",305],")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","assertNull",306],"(",["T_VARIABLE","$result",306],")",";",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n\n    ",307],["T_DOC_COMMENT","\/**\n     * Test parsing a full URI. While not part of the spec some mobile clients will do it wrong.\n     *\n     * @return void\n     *\/",309],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","testParseAuthDataFullUri",314],"(",")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$digest",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_START_HEREDOC","<<<DIGEST\n",316],["T_ENCAPSED_AND_WHITESPACE","\t\t\tDigest username=\"admin\",\n\t\t\trealm=\"192.168.0.2\",\n\t\t\tnonce=\"53a7f9b83f61b\",\n\t\t\turi=\"http:\/\/192.168.0.2\/pvcollection\/sites\/pull\/HFD%200001.json#fragment\",\n\t\t\tqop=auth,\n\t\t\tnc=00000001,\n\t\t\tcnonce=\"b85ff144e496e6e18d1c73020566ea3b\",\n\t\t\tresponse=\"5894f5d9cd41d012bac09eeb89d2ddf2\",\n\t\t\topaque=\"6f65e91667cf98dd13464deaf2739fde\"\n",317],["T_END_HEREDOC","DIGEST",326],";",["T_WHITESPACE","\n\n        ",326],["T_VARIABLE","$expected",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/192.168.0.2\/pvcollection\/sites\/pull\/HFD%200001.json#fragment'",328],";",["T_WHITESPACE","\n        ",328],["T_VARIABLE","$result",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","auth",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","parseAuthData",329],"(",["T_VARIABLE","$digest",329],")",";",["T_WHITESPACE","\n        ",329],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","assertSame",330],"(",["T_VARIABLE","$expected",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$result",330],"[",["T_CONSTANT_ENCAPSED_STRING","'uri'",330],"]",")",";",["T_WHITESPACE","\n    ",330],"}",["T_WHITESPACE","\n\n    ",331],["T_DOC_COMMENT","\/**\n     * test parsing digest information with email addresses\n     *\n     * @return void\n     *\/",333],["T_WHITESPACE","\n    ",337],["T_PUBLIC","public",338],["T_WHITESPACE"," ",338],["T_FUNCTION","function",338],["T_WHITESPACE"," ",338],["T_STRING","testParseAuthEmailAddress",338],"(",")",["T_WHITESPACE","\n    ",338],"{",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$digest",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_START_HEREDOC","<<<DIGEST\n",340],["T_ENCAPSED_AND_WHITESPACE","\t\t\tDigest username=\"mark@example.com\",\n\t\t\trealm=\"testrealm@host.com\",\n\t\t\tnonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n\t\t\turi=\"\/dir\/index.html\",\n\t\t\tqop=auth,\n\t\t\tnc=00000001,\n\t\t\tcnonce=\"0a4f113b\",\n\t\t\tresponse=\"6629fae49393a05397450978507c4ef1\",\n\t\t\topaque=\"5ccc069c403ebaf9f0171e9517f40e41\"\n",341],["T_END_HEREDOC","DIGEST",350],";",["T_WHITESPACE","\n        ",350],["T_VARIABLE","$expected",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],"[",["T_WHITESPACE","\n            ",351],["T_CONSTANT_ENCAPSED_STRING","'username'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'mark@example.com'",352],",",["T_WHITESPACE","\n            ",352],["T_CONSTANT_ENCAPSED_STRING","'realm'",353],["T_WHITESPACE"," ",353],["T_DOUBLE_ARROW","=>",353],["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","'testrealm@host.com'",353],",",["T_WHITESPACE","\n            ",353],["T_CONSTANT_ENCAPSED_STRING","'nonce'",354],["T_WHITESPACE"," ",354],["T_DOUBLE_ARROW","=>",354],["T_WHITESPACE"," ",354],["T_CONSTANT_ENCAPSED_STRING","'dcd98b7102dd2f0e8b11d0f600bfb0c093'",354],",",["T_WHITESPACE","\n            ",354],["T_CONSTANT_ENCAPSED_STRING","'uri'",355],["T_WHITESPACE"," ",355],["T_DOUBLE_ARROW","=>",355],["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'\/dir\/index.html'",355],",",["T_WHITESPACE","\n            ",355],["T_CONSTANT_ENCAPSED_STRING","'qop'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","'auth'",356],",",["T_WHITESPACE","\n            ",356],["T_CONSTANT_ENCAPSED_STRING","'nc'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_CONSTANT_ENCAPSED_STRING","'00000001'",357],",",["T_WHITESPACE","\n            ",357],["T_CONSTANT_ENCAPSED_STRING","'cnonce'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'0a4f113b'",358],",",["T_WHITESPACE","\n            ",358],["T_CONSTANT_ENCAPSED_STRING","'response'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'6629fae49393a05397450978507c4ef1'",359],",",["T_WHITESPACE","\n            ",359],["T_CONSTANT_ENCAPSED_STRING","'opaque'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","'5ccc069c403ebaf9f0171e9517f40e41'",360],["T_WHITESPACE","\n        ",360],"]",";",["T_WHITESPACE","\n        ",361],["T_VARIABLE","$result",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","auth",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","parseAuthData",362],"(",["T_VARIABLE","$digest",362],")",";",["T_WHITESPACE","\n        ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","assertSame",363],"(",["T_VARIABLE","$expected",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$result",363],")",";",["T_WHITESPACE","\n    ",363],"}",["T_WHITESPACE","\n\n    ",364],["T_DOC_COMMENT","\/**\n     * test password hashing\n     *\n     * @return void\n     *\/",366],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","testPassword",371],"(",")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$result",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","DigestAuthenticate",373],["T_DOUBLE_COLON","::",373],["T_STRING","password",373],"(",["T_CONSTANT_ENCAPSED_STRING","'mark'",373],",",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'password'",373],",",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'localhost'",373],")",";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$expected",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","md5",374],"(",["T_CONSTANT_ENCAPSED_STRING","'mark:localhost:password'",374],")",";",["T_WHITESPACE","\n        ",374],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","assertEquals",375],"(",["T_VARIABLE","$expected",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$result",375],")",";",["T_WHITESPACE","\n    ",375],"}",["T_WHITESPACE","\n",376],"}",["T_WHITESPACE","\n",377]]