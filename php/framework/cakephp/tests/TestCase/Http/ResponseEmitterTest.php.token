[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         3.3.5\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Http",17],["T_NS_SEPARATOR","\\",17],["T_STRING","CallbackStream",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Http",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ResponseEmitter",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","TestSuite",19],["T_NS_SEPARATOR","\\",19],["T_STRING","TestCase",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Zend",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Diactoros",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Response",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Zend",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Diactoros",21],["T_NS_SEPARATOR","\\",21],["T_STRING","ServerRequestFactory",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Zend",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Diactoros",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Stream",22],";",["T_WHITESPACE","\n\n",22],["T_REQUIRE_ONCE","require_once",24],["T_WHITESPACE"," ",24],["T_DIR","__DIR__",24],["T_WHITESPACE"," ",24],".",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'\/server_mocks.php'",24],";",["T_WHITESPACE","\n\n",24],["T_DOC_COMMENT","\/**\n * Response emitter test.\n *\/",26],["T_WHITESPACE","\n",28],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","ResponseEmitterTest",29],["T_WHITESPACE"," ",29],["T_EXTENDS","extends",29],["T_WHITESPACE"," ",29],["T_STRING","TestCase",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$emitter",31],";",["T_WHITESPACE","\n\n    ",31],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","setUp",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_STRING","parent",35],["T_DOUBLE_COLON","::",35],["T_STRING","setUp",35],"(",")",";",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$GLOBALS",36],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedHeaders'",36],"]",["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$GLOBALS",36],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedCookies'",36],"]",["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],"[","]",";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","emitter",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_NEW","new",37],["T_WHITESPACE"," ",37],["T_STRING","ResponseEmitter",37],"(",")",";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Test emitting simple responses.\n     *\n     * @return void\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testEmitResponseSimple",45],"(",")",["T_WHITESPACE","\n    ",45],"{",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$response",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],"(",["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_STRING","Response",47],"(",")",")",["T_WHITESPACE","\n            ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","withStatus",48],"(",["T_LNUMBER","201",48],")",["T_WHITESPACE","\n            ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","withHeader",49],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'text\/html'",49],")",["T_WHITESPACE","\n            ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","withHeader",50],"(",["T_CONSTANT_ENCAPSED_STRING","'Location'",50],",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/example.com\/cake\/1'",50],")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$response",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getBody",51],"(",")",["T_OBJECT_OPERATOR","->",51],["T_STRING","write",51],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",51],")",";",["T_WHITESPACE","\n\n        ",51],["T_STRING","ob_start",53],"(",")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","emitter",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","emit",54],"(",["T_VARIABLE","$response",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$out",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","ob_get_clean",55],"(",")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertEquals",57],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$out",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$expected",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],"[",["T_WHITESPACE","\n            ",58],["T_CONSTANT_ENCAPSED_STRING","'HTTP\/1.1 201 Created'",59],",",["T_WHITESPACE","\n            ",59],["T_CONSTANT_ENCAPSED_STRING","'Content-Type: text\/html'",60],",",["T_WHITESPACE","\n            ",60],["T_CONSTANT_ENCAPSED_STRING","'Location: http:\/\/example.com\/cake\/1'",61],["T_WHITESPACE","\n        ",61],"]",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertEquals",63],"(",["T_VARIABLE","$expected",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$GLOBALS",63],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedHeaders'",63],"]",")",";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Test emitting responses with cookies\n     *\n     * @return void\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","testEmitResponseCookies",71],"(",")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$response",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],"(",["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","Response",73],"(",")",")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","withAddedHeader",74],"(",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",74],",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","\"simple=val;\\tSecure\"",74],")",["T_WHITESPACE","\n            ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","withAddedHeader",75],"(",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'people=jim,jack,jonny\";\";Path=\/accounts'",75],")",["T_WHITESPACE","\n            ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","withAddedHeader",76],"(",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'google=not=nice;Path=\/accounts; HttpOnly'",76],")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","withAddedHeader",77],"(",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'a=b;  Expires=Wed, 13 Jan 2021 22:23:01 GMT; Domain=www.example.com;'",77],")",["T_WHITESPACE","\n            ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","withAddedHeader",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Set-Cookie'",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'list%5B%5D=a%20b%20c'",78],")",["T_WHITESPACE","\n            ",78],["T_OBJECT_OPERATOR","->",79],["T_STRING","withHeader",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$response",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getBody",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","write",80],"(",["T_CONSTANT_ENCAPSED_STRING","'ok'",80],")",";",["T_WHITESPACE","\n\n        ",80],["T_STRING","ob_start",82],"(",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","emitter",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","emit",83],"(",["T_VARIABLE","$response",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$out",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","ob_get_clean",84],"(",")",";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertEquals",86],"(",["T_CONSTANT_ENCAPSED_STRING","'ok'",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$out",86],")",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$expected",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],"[",["T_WHITESPACE","\n            ",87],["T_CONSTANT_ENCAPSED_STRING","'HTTP\/1.1 200 OK'",88],",",["T_WHITESPACE","\n            ",88],["T_CONSTANT_ENCAPSED_STRING","'Content-Type: text\/plain'",89],["T_WHITESPACE","\n        ",89],"]",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertEquals",91],"(",["T_VARIABLE","$expected",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$GLOBALS",91],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedHeaders'",91],"]",")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$expected",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],"[",["T_WHITESPACE","\n            ",92],"[",["T_WHITESPACE","\n                ",93],["T_CONSTANT_ENCAPSED_STRING","'name'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'simple'",94],",",["T_WHITESPACE","\n                ",94],["T_CONSTANT_ENCAPSED_STRING","'value'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'val'",95],",",["T_WHITESPACE","\n                ",95],["T_CONSTANT_ENCAPSED_STRING","'path'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","''",96],",",["T_WHITESPACE","\n                ",96],["T_CONSTANT_ENCAPSED_STRING","'expire'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_LNUMBER","0",97],",",["T_WHITESPACE","\n                ",97],["T_CONSTANT_ENCAPSED_STRING","'domain'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","''",98],",",["T_WHITESPACE","\n                ",98],["T_CONSTANT_ENCAPSED_STRING","'secure'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_STRING","true",99],",",["T_WHITESPACE","\n                ",99],["T_CONSTANT_ENCAPSED_STRING","'httponly'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_STRING","false",100],["T_WHITESPACE","\n            ",100],"]",",",["T_WHITESPACE","\n            ",101],"[",["T_WHITESPACE","\n                ",102],["T_CONSTANT_ENCAPSED_STRING","'name'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'people'",103],",",["T_WHITESPACE","\n                ",103],["T_CONSTANT_ENCAPSED_STRING","'value'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'jim,jack,jonny\";\"'",104],",",["T_WHITESPACE","\n                ",104],["T_CONSTANT_ENCAPSED_STRING","'path'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'\/accounts'",105],",",["T_WHITESPACE","\n                ",105],["T_CONSTANT_ENCAPSED_STRING","'expire'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_LNUMBER","0",106],",",["T_WHITESPACE","\n                ",106],["T_CONSTANT_ENCAPSED_STRING","'domain'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","''",107],",",["T_WHITESPACE","\n                ",107],["T_CONSTANT_ENCAPSED_STRING","'secure'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_STRING","false",108],",",["T_WHITESPACE","\n                ",108],["T_CONSTANT_ENCAPSED_STRING","'httponly'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_STRING","false",109],["T_WHITESPACE","\n            ",109],"]",",",["T_WHITESPACE","\n            ",110],"[",["T_WHITESPACE","\n                ",111],["T_CONSTANT_ENCAPSED_STRING","'name'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'google'",112],",",["T_WHITESPACE","\n                ",112],["T_CONSTANT_ENCAPSED_STRING","'value'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'not=nice'",113],",",["T_WHITESPACE","\n                ",113],["T_CONSTANT_ENCAPSED_STRING","'path'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'\/accounts'",114],",",["T_WHITESPACE","\n                ",114],["T_CONSTANT_ENCAPSED_STRING","'expire'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_LNUMBER","0",115],",",["T_WHITESPACE","\n                ",115],["T_CONSTANT_ENCAPSED_STRING","'domain'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","''",116],",",["T_WHITESPACE","\n                ",116],["T_CONSTANT_ENCAPSED_STRING","'secure'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_STRING","false",117],",",["T_WHITESPACE","\n                ",117],["T_CONSTANT_ENCAPSED_STRING","'httponly'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_STRING","true",118],["T_WHITESPACE","\n            ",118],"]",",",["T_WHITESPACE","\n            ",119],"[",["T_WHITESPACE","\n                ",120],["T_CONSTANT_ENCAPSED_STRING","'name'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'a'",121],",",["T_WHITESPACE","\n                ",121],["T_CONSTANT_ENCAPSED_STRING","'value'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'b'",122],",",["T_WHITESPACE","\n                ",122],["T_CONSTANT_ENCAPSED_STRING","'path'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","''",123],",",["T_WHITESPACE","\n                ",123],["T_CONSTANT_ENCAPSED_STRING","'expire'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_LNUMBER","1610576581",124],",",["T_WHITESPACE","\n                ",124],["T_CONSTANT_ENCAPSED_STRING","'domain'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'www.example.com'",125],",",["T_WHITESPACE","\n                ",125],["T_CONSTANT_ENCAPSED_STRING","'secure'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_STRING","false",126],",",["T_WHITESPACE","\n                ",126],["T_CONSTANT_ENCAPSED_STRING","'httponly'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_STRING","false",127],["T_WHITESPACE","\n            ",127],"]",",",["T_WHITESPACE","\n            ",128],"[",["T_WHITESPACE","\n                ",129],["T_CONSTANT_ENCAPSED_STRING","'name'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'list[]'",130],",",["T_WHITESPACE","\n                ",130],["T_CONSTANT_ENCAPSED_STRING","'value'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'a b c'",131],",",["T_WHITESPACE","\n                ",131],["T_CONSTANT_ENCAPSED_STRING","'path'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","''",132],",",["T_WHITESPACE","\n                ",132],["T_CONSTANT_ENCAPSED_STRING","'expire'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_LNUMBER","0",133],",",["T_WHITESPACE","\n                ",133],["T_CONSTANT_ENCAPSED_STRING","'domain'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","''",134],",",["T_WHITESPACE","\n                ",134],["T_CONSTANT_ENCAPSED_STRING","'secure'",135],["T_WHITESPACE"," ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_STRING","false",135],",",["T_WHITESPACE","\n                ",135],["T_CONSTANT_ENCAPSED_STRING","'httponly'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_STRING","false",136],["T_WHITESPACE","\n            ",136],"]",",",["T_WHITESPACE","\n        ",137],"]",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertEquals",139],"(",["T_VARIABLE","$expected",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$GLOBALS",139],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedCookies'",139],"]",")",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Test emitting responses using callback streams.\n     *\n     * We use callback streams for closure based responses.\n     *\n     * @return void\n     *\/",142],["T_WHITESPACE","\n    ",148],["T_PUBLIC","public",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","testEmitResponseCallbackStream",149],"(",")",["T_WHITESPACE","\n    ",149],"{",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$stream",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_NEW","new",151],["T_WHITESPACE"," ",151],["T_STRING","CallbackStream",151],"(",["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],"(",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_ECHO","echo",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'It worked'",152],";",["T_WHITESPACE","\n        ",152],"}",")",";",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$response",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],"(",["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_STRING","Response",154],"(",")",")",["T_WHITESPACE","\n            ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","withStatus",155],"(",["T_LNUMBER","201",155],")",["T_WHITESPACE","\n            ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","withBody",156],"(",["T_VARIABLE","$stream",156],")",["T_WHITESPACE","\n            ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","withHeader",157],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",157],")",";",["T_WHITESPACE","\n\n        ",157],["T_STRING","ob_start",159],"(",")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","emitter",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","emit",160],"(",["T_VARIABLE","$response",160],")",";",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$out",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","ob_get_clean",161],"(",")",";",["T_WHITESPACE","\n\n        ",161],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertEquals",163],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$out",163],")",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$expected",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],"[",["T_WHITESPACE","\n            ",164],["T_CONSTANT_ENCAPSED_STRING","'HTTP\/1.1 201 Created'",165],",",["T_WHITESPACE","\n            ",165],["T_CONSTANT_ENCAPSED_STRING","'Content-Type: text\/plain'",166],",",["T_WHITESPACE","\n        ",166],"]",";",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","assertEquals",168],"(",["T_VARIABLE","$expected",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$GLOBALS",168],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedHeaders'",168],"]",")",";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Test valid body ranges.\n     *\n     * @return void\n     *\/",171],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","testEmitResponseBodyRange",176],"(",")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$response",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],"(",["T_NEW","new",178],["T_WHITESPACE"," ",178],["T_STRING","Response",178],"(",")",")",["T_WHITESPACE","\n            ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","withHeader",179],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",179],",",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",179],")",["T_WHITESPACE","\n            ",179],["T_OBJECT_OPERATOR","->",180],["T_STRING","withHeader",180],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Range'",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'bytes 1-4\/9'",180],")",";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$response",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getBody",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","write",181],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",181],")",";",["T_WHITESPACE","\n\n        ",181],["T_STRING","ob_start",183],"(",")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","emitter",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","emit",184],"(",["T_VARIABLE","$response",184],")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$out",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","ob_get_clean",185],"(",")",";",["T_WHITESPACE","\n\n        ",185],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","assertEquals",187],"(",["T_CONSTANT_ENCAPSED_STRING","'t wo'",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$out",187],")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$expected",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],"[",["T_WHITESPACE","\n            ",188],["T_CONSTANT_ENCAPSED_STRING","'HTTP\/1.1 200 OK'",189],",",["T_WHITESPACE","\n            ",189],["T_CONSTANT_ENCAPSED_STRING","'Content-Type: text\/plain'",190],",",["T_WHITESPACE","\n            ",190],["T_CONSTANT_ENCAPSED_STRING","'Content-Range: bytes 1-4\/9'",191],",",["T_WHITESPACE","\n        ",191],"]",";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","assertEquals",193],"(",["T_VARIABLE","$expected",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$GLOBALS",193],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedHeaders'",193],"]",")",";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Test valid body ranges.\n     *\n     * @return void\n     *\/",196],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","testEmitResponseBodyRangeComplete",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$response",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],"(",["T_NEW","new",203],["T_WHITESPACE"," ",203],["T_STRING","Response",203],"(",")",")",["T_WHITESPACE","\n            ",203],["T_OBJECT_OPERATOR","->",204],["T_STRING","withHeader",204],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",204],")",["T_WHITESPACE","\n            ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","withHeader",205],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Range'",205],",",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'bytes 0-20\/9'",205],")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$response",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getBody",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","write",206],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",206],")",";",["T_WHITESPACE","\n\n        ",206],["T_STRING","ob_start",208],"(",")",";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","emitter",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","emit",209],"(",["T_VARIABLE","$response",209],",",["T_WHITESPACE"," ",209],["T_LNUMBER","2",209],")",";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$out",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_STRING","ob_get_clean",210],"(",")",";",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","assertEquals",212],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$out",212],")",";",["T_WHITESPACE","\n    ",212],"}",["T_WHITESPACE","\n\n    ",213],["T_DOC_COMMENT","\/**\n     * Test out of bounds body ranges.\n     *\n     * @return void\n     *\/",215],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","testEmitResponseBodyRangeOverflow",220],"(",")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$response",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],"(",["T_NEW","new",222],["T_WHITESPACE"," ",222],["T_STRING","Response",222],"(",")",")",["T_WHITESPACE","\n            ",222],["T_OBJECT_OPERATOR","->",223],["T_STRING","withHeader",223],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",223],",",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",223],")",["T_WHITESPACE","\n            ",223],["T_OBJECT_OPERATOR","->",224],["T_STRING","withHeader",224],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Range'",224],",",["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'bytes 5-20\/9'",224],")",";",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$response",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getBody",225],"(",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","write",225],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",225],")",";",["T_WHITESPACE","\n\n        ",225],["T_STRING","ob_start",227],"(",")",";",["T_WHITESPACE","\n        ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","emitter",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","emit",228],"(",["T_VARIABLE","$response",228],")",";",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$out",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_STRING","ob_get_clean",229],"(",")",";",["T_WHITESPACE","\n\n        ",229],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","assertEquals",231],"(",["T_CONSTANT_ENCAPSED_STRING","'rked'",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$out",231],")",";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Test malformed content-range header\n     *\n     * @return void\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","testEmitResponseBodyRangeMalformed",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$response",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],"(",["T_NEW","new",241],["T_WHITESPACE"," ",241],["T_STRING","Response",241],"(",")",")",["T_WHITESPACE","\n            ",241],["T_OBJECT_OPERATOR","->",242],["T_STRING","withHeader",242],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",242],",",["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",242],")",["T_WHITESPACE","\n            ",242],["T_OBJECT_OPERATOR","->",243],["T_STRING","withHeader",243],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Range'",243],",",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'bytes 9-ba\/a'",243],")",";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$response",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getBody",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","write",244],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",244],")",";",["T_WHITESPACE","\n\n        ",244],["T_STRING","ob_start",246],"(",")",";",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","emitter",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","emit",247],"(",["T_VARIABLE","$response",247],")",";",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$out",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","ob_get_clean",248],"(",")",";",["T_WHITESPACE","\n\n        ",248],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","assertEquals",250],"(",["T_CONSTANT_ENCAPSED_STRING","'It worked'",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$out",250],")",";",["T_WHITESPACE","\n    ",250],"}",["T_WHITESPACE","\n\n    ",251],["T_DOC_COMMENT","\/**\n     * Test callback streams returning content and ranges\n     *\n     * @return void\n     *\/",253],["T_WHITESPACE","\n    ",257],["T_PUBLIC","public",258],["T_WHITESPACE"," ",258],["T_FUNCTION","function",258],["T_WHITESPACE"," ",258],["T_STRING","testEmitResponseBodyRangeCallbackStream",258],"(",")",["T_WHITESPACE","\n    ",258],"{",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$stream",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_NEW","new",260],["T_WHITESPACE"," ",260],["T_STRING","CallbackStream",260],"(",["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],"(",")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_RETURN","return",261],["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'It worked'",261],";",["T_WHITESPACE","\n        ",261],"}",")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$response",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],"(",["T_NEW","new",263],["T_WHITESPACE"," ",263],["T_STRING","Response",263],"(",")",")",["T_WHITESPACE","\n            ",263],["T_OBJECT_OPERATOR","->",264],["T_STRING","withStatus",264],"(",["T_LNUMBER","201",264],")",["T_WHITESPACE","\n            ",264],["T_OBJECT_OPERATOR","->",265],["T_STRING","withBody",265],"(",["T_VARIABLE","$stream",265],")",["T_WHITESPACE","\n            ",265],["T_OBJECT_OPERATOR","->",266],["T_STRING","withHeader",266],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Range'",266],",",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'bytes 1-4\/9'",266],")",["T_WHITESPACE","\n            ",266],["T_OBJECT_OPERATOR","->",267],["T_STRING","withHeader",267],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",267],",",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'text\/plain'",267],")",";",["T_WHITESPACE","\n\n        ",267],["T_STRING","ob_start",269],"(",")",";",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","emitter",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","emit",270],"(",["T_VARIABLE","$response",270],")",";",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$out",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING","ob_get_clean",271],"(",")",";",["T_WHITESPACE","\n\n        ",271],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","assertEquals",273],"(",["T_CONSTANT_ENCAPSED_STRING","'t wo'",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$out",273],")",";",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$expected",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],"[",["T_WHITESPACE","\n            ",274],["T_CONSTANT_ENCAPSED_STRING","'HTTP\/1.1 201 Created'",275],",",["T_WHITESPACE","\n            ",275],["T_CONSTANT_ENCAPSED_STRING","'Content-Range: bytes 1-4\/9'",276],",",["T_WHITESPACE","\n            ",276],["T_CONSTANT_ENCAPSED_STRING","'Content-Type: text\/plain'",277],",",["T_WHITESPACE","\n        ",277],"]",";",["T_WHITESPACE","\n        ",278],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","assertEquals",279],"(",["T_VARIABLE","$expected",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$GLOBALS",279],"[",["T_CONSTANT_ENCAPSED_STRING","'mockedHeaders'",279],"]",")",";",["T_WHITESPACE","\n    ",279],"}",["T_WHITESPACE","\n",280],"}",["T_WHITESPACE","\n",281]]