[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CakePHP(tm) : Rapid Development Framework (http:\/\/cakephp.org)\n * Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n *\n * Licensed under The MIT License\n * For full copyright and license information, please see the LICENSE.txt\n * Redistributions of files must retain the above copyright notice\n *\n * @copyright     Copyright (c) Cake Software Foundation, Inc. (http:\/\/cakefoundation.org)\n * @link          http:\/\/cakephp.org CakePHP(tm) Project\n * @since         1.2.0\n * @license       http:\/\/www.opensource.org\/licenses\/mit-license.php MIT License\n *\/",2],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Cake",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","TestCase",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Utility",15],";",["T_WHITESPACE","\n\n",15],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Cake",17],["T_NS_SEPARATOR","\\",17],["T_STRING","TestSuite",17],["T_NS_SEPARATOR","\\",17],["T_STRING","TestCase",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Cake",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Utility",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Crypto",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Mcrypt",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Cake",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Utility",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Crypto",19],["T_NS_SEPARATOR","\\",19],["T_STRING","OpenSsl",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Cake",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Utility",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Security",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * SecurityTest class\n *\/",22],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","SecurityTest",25],["T_WHITESPACE"," ",25],["T_EXTENDS","extends",25],["T_WHITESPACE"," ",25],["T_STRING","TestCase",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * testHash method\n     *\n     * @return void\n     *\/",28],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","testHash",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$_hashType",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","Security",35],["T_DOUBLE_COLON","::",35],["T_VARIABLE","$hashType",35],";",["T_WHITESPACE","\n\n        ",35],["T_VARIABLE","$key",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'someKey'",37],";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$hash",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'someHash'",38],";",["T_WHITESPACE","\n\n        ",38],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","assertSame",40],"(",["T_LNUMBER","40",40],",",["T_WHITESPACE"," ",40],["T_STRING","strlen",40],"(",["T_STRING","Security",40],["T_DOUBLE_COLON","::",40],["T_STRING","hash",40],"(",["T_VARIABLE","$key",40],",",["T_WHITESPACE"," ",40],["T_STRING","null",40],",",["T_WHITESPACE"," ",40],["T_STRING","false",40],")",")",")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","assertSame",41],"(",["T_LNUMBER","40",41],",",["T_WHITESPACE"," ",41],["T_STRING","strlen",41],"(",["T_STRING","Security",41],["T_DOUBLE_COLON","::",41],["T_STRING","hash",41],"(",["T_VARIABLE","$key",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'sha1'",41],",",["T_WHITESPACE"," ",41],["T_STRING","false",41],")",")",")",";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","assertSame",42],"(",["T_LNUMBER","40",42],",",["T_WHITESPACE"," ",42],["T_STRING","strlen",42],"(",["T_STRING","Security",42],["T_DOUBLE_COLON","::",42],["T_STRING","hash",42],"(",["T_VARIABLE","$key",42],",",["T_WHITESPACE"," ",42],["T_STRING","null",42],",",["T_WHITESPACE"," ",42],["T_STRING","true",42],")",")",")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","assertSame",43],"(",["T_LNUMBER","40",43],",",["T_WHITESPACE"," ",43],["T_STRING","strlen",43],"(",["T_STRING","Security",43],["T_DOUBLE_COLON","::",43],["T_STRING","hash",43],"(",["T_VARIABLE","$key",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'sha1'",43],",",["T_WHITESPACE"," ",43],["T_STRING","true",43],")",")",")",";",["T_WHITESPACE","\n\n        ",43],["T_VARIABLE","$result",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","Security",45],["T_DOUBLE_COLON","::",45],["T_STRING","hash",45],"(",["T_VARIABLE","$key",45],",",["T_WHITESPACE"," ",45],["T_STRING","null",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$hash",45],")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","assertSame",46],"(",["T_VARIABLE","$result",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'e38fcb877dccb6a94729a81523851c931a46efb1'",46],")",";",["T_WHITESPACE","\n\n        ",46],["T_VARIABLE","$result",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","Security",48],["T_DOUBLE_COLON","::",48],["T_STRING","hash",48],"(",["T_VARIABLE","$key",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'sha1'",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$hash",48],")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertSame",49],"(",["T_VARIABLE","$result",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'e38fcb877dccb6a94729a81523851c931a46efb1'",49],")",";",["T_WHITESPACE","\n\n        ",49],["T_VARIABLE","$hashType",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'sha1'",51],";",["T_WHITESPACE","\n        ",51],["T_STRING","Security",52],["T_DOUBLE_COLON","::",52],["T_STRING","setHash",52],"(",["T_VARIABLE","$hashType",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","assertSame",53],"(",["T_VARIABLE","$hashType",53],",",["T_WHITESPACE"," ",53],["T_STRING","Security",53],["T_DOUBLE_COLON","::",53],["T_VARIABLE","$hashType",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertSame",54],"(",["T_LNUMBER","40",54],",",["T_WHITESPACE"," ",54],["T_STRING","strlen",54],"(",["T_STRING","Security",54],["T_DOUBLE_COLON","::",54],["T_STRING","hash",54],"(",["T_VARIABLE","$key",54],",",["T_WHITESPACE"," ",54],["T_STRING","null",54],",",["T_WHITESPACE"," ",54],["T_STRING","true",54],")",")",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","assertSame",55],"(",["T_LNUMBER","40",55],",",["T_WHITESPACE"," ",55],["T_STRING","strlen",55],"(",["T_STRING","Security",55],["T_DOUBLE_COLON","::",55],["T_STRING","hash",55],"(",["T_VARIABLE","$key",55],",",["T_WHITESPACE"," ",55],["T_STRING","null",55],",",["T_WHITESPACE"," ",55],["T_STRING","false",55],")",")",")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","assertSame",57],"(",["T_LNUMBER","32",57],",",["T_WHITESPACE"," ",57],["T_STRING","strlen",57],"(",["T_STRING","Security",57],["T_DOUBLE_COLON","::",57],["T_STRING","hash",57],"(",["T_VARIABLE","$key",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'md5'",57],",",["T_WHITESPACE"," ",57],["T_STRING","false",57],")",")",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","assertSame",58],"(",["T_LNUMBER","32",58],",",["T_WHITESPACE"," ",58],["T_STRING","strlen",58],"(",["T_STRING","Security",58],["T_DOUBLE_COLON","::",58],["T_STRING","hash",58],"(",["T_VARIABLE","$key",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'md5'",58],",",["T_WHITESPACE"," ",58],["T_STRING","true",58],")",")",")",";",["T_WHITESPACE","\n\n        ",58],["T_VARIABLE","$hashType",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'md5'",60],";",["T_WHITESPACE","\n        ",60],["T_STRING","Security",61],["T_DOUBLE_COLON","::",61],["T_STRING","setHash",61],"(",["T_VARIABLE","$hashType",61],")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","assertSame",62],"(",["T_VARIABLE","$hashType",62],",",["T_WHITESPACE"," ",62],["T_STRING","Security",62],["T_DOUBLE_COLON","::",62],["T_VARIABLE","$hashType",62],")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertSame",63],"(",["T_LNUMBER","32",63],",",["T_WHITESPACE"," ",63],["T_STRING","strlen",63],"(",["T_STRING","Security",63],["T_DOUBLE_COLON","::",63],["T_STRING","hash",63],"(",["T_VARIABLE","$key",63],",",["T_WHITESPACE"," ",63],["T_STRING","null",63],",",["T_WHITESPACE"," ",63],["T_STRING","false",63],")",")",")",";",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertSame",64],"(",["T_LNUMBER","32",64],",",["T_WHITESPACE"," ",64],["T_STRING","strlen",64],"(",["T_STRING","Security",64],["T_DOUBLE_COLON","::",64],["T_STRING","hash",64],"(",["T_VARIABLE","$key",64],",",["T_WHITESPACE"," ",64],["T_STRING","null",64],",",["T_WHITESPACE"," ",64],["T_STRING","true",64],")",")",")",";",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertSame",66],"(",["T_LNUMBER","64",66],",",["T_WHITESPACE"," ",66],["T_STRING","strlen",66],"(",["T_STRING","Security",66],["T_DOUBLE_COLON","::",66],["T_STRING","hash",66],"(",["T_VARIABLE","$key",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'sha256'",66],",",["T_WHITESPACE"," ",66],["T_STRING","false",66],")",")",")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertSame",67],"(",["T_LNUMBER","64",67],",",["T_WHITESPACE"," ",67],["T_STRING","strlen",67],"(",["T_STRING","Security",67],["T_DOUBLE_COLON","::",67],["T_STRING","hash",67],"(",["T_VARIABLE","$key",67],",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'sha256'",67],",",["T_WHITESPACE"," ",67],["T_STRING","true",67],")",")",")",";",["T_WHITESPACE","\n\n        ",67],["T_STRING","Security",69],["T_DOUBLE_COLON","::",69],["T_STRING","setHash",69],"(",["T_VARIABLE","$_hashType",69],")",";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * testRijndael method\n     *\n     * @return void\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","testRijndael",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","skipIf",79],"(","!",["T_STRING","function_exists",79],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt_encrypt'",79],")",["T_WHITESPACE"," ",79],["T_BOOLEAN_OR","||",79],["T_WHITESPACE"," ",79],["T_STRING","version_compare",79],"(",["T_STRING","PHP_VERSION",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'7.1'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'>='",79],")",")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$engine",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","Security",80],["T_DOUBLE_COLON","::",80],["T_STRING","engine",80],"(",")",";",["T_WHITESPACE","\n\n        ",80],["T_STRING","Security",82],["T_DOUBLE_COLON","::",82],["T_STRING","engine",82],"(",["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","Mcrypt",82],"(",")",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$txt",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox jumped over the lazy dog.'",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$key",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'DYhG93b0qyJfIxfs2guVoUubWwvniR2G0FgaC9mi'",84],";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$result",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","Security",86],["T_DOUBLE_COLON","::",86],["T_STRING","rijndael",86],"(",["T_VARIABLE","$txt",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$key",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'encrypt'",86],")",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertEquals",87],"(",["T_VARIABLE","$txt",87],",",["T_WHITESPACE"," ",87],["T_STRING","Security",87],["T_DOUBLE_COLON","::",87],["T_STRING","rijndael",87],"(",["T_VARIABLE","$result",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$key",87],",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'decrypt'",87],")",")",";",["T_WHITESPACE","\n\n        ",87],["T_VARIABLE","$result",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","Security",89],["T_DOUBLE_COLON","::",89],["T_STRING","rijndael",89],"(",["T_CONSTANT_ENCAPSED_STRING","''",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$key",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'encrypt'",89],")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertEquals",90],"(",["T_CONSTANT_ENCAPSED_STRING","''",90],",",["T_WHITESPACE"," ",90],["T_STRING","Security",90],["T_DOUBLE_COLON","::",90],["T_STRING","rijndael",90],"(",["T_VARIABLE","$result",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$key",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'decrypt'",90],")",")",";",["T_WHITESPACE","\n\n        ",90],["T_VARIABLE","$key",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'this is my key of over 32 chars, yes it is'",92],";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$result",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","Security",93],["T_DOUBLE_COLON","::",93],["T_STRING","rijndael",93],"(",["T_VARIABLE","$txt",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$key",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'encrypt'",93],")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assertEquals",94],"(",["T_VARIABLE","$txt",94],",",["T_WHITESPACE"," ",94],["T_STRING","Security",94],["T_DOUBLE_COLON","::",94],["T_STRING","rijndael",94],"(",["T_VARIABLE","$result",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$key",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'decrypt'",94],")",")",";",["T_WHITESPACE","\n\n        ",94],["T_STRING","Security",96],["T_DOUBLE_COLON","::",96],["T_STRING","engine",96],"(",["T_VARIABLE","$engine",96],")",";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * testRijndaelInvalidOperation method\n     *\n     * @expectedException \\InvalidArgumentException\n     * @return void\n     *\/",99],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","testRijndaelInvalidOperation",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$txt",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox jumped over the lazy dog.'",107],";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$key",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'DYhG93b0qyJfIxfs2guVoUubWwvniR2G0FgaC9mi'",108],";",["T_WHITESPACE","\n        ",108],["T_STRING","Security",109],["T_DOUBLE_COLON","::",109],["T_STRING","rijndael",109],"(",["T_VARIABLE","$txt",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$key",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'foo'",109],")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * testRijndaelInvalidKey method\n     *\n     * @expectedException \\InvalidArgumentException\n     * @return void\n     *\/",112],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","testRijndaelInvalidKey",118],"(",")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$txt",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox jumped over the lazy dog.'",120],";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$key",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'too small'",121],";",["T_WHITESPACE","\n        ",121],["T_STRING","Security",122],["T_DOUBLE_COLON","::",122],["T_STRING","rijndael",122],"(",["T_VARIABLE","$txt",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$key",122],",",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'encrypt'",122],")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * Test encrypt\/decrypt.\n     *\n     * @return void\n     *\/",125],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","testEncryptDecrypt",130],"(",")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$txt",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox'",132],";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$key",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'This key is longer than 32 bytes long.'",133],";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$result",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","Security",134],["T_DOUBLE_COLON","::",134],["T_STRING","encrypt",134],"(",["T_VARIABLE","$txt",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$key",134],")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertNotEquals",135],"(",["T_VARIABLE","$txt",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$result",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'Should be encrypted.'",135],")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertNotEquals",136],"(",["T_VARIABLE","$result",136],",",["T_WHITESPACE"," ",136],["T_STRING","Security",136],["T_DOUBLE_COLON","::",136],["T_STRING","encrypt",136],"(",["T_VARIABLE","$txt",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$key",136],")",",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'Each result is unique.'",136],")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertEquals",137],"(",["T_VARIABLE","$txt",137],",",["T_WHITESPACE"," ",137],["T_STRING","Security",137],["T_DOUBLE_COLON","::",137],["T_STRING","decrypt",137],"(",["T_VARIABLE","$result",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$key",137],")",")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Test that changing the key causes decryption to fail.\n     *\n     * @return void\n     *\/",140],["T_WHITESPACE","\n    ",144],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","testDecryptKeyFailure",145],"(",")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$txt",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox'",147],";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$key",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'This key is longer than 32 bytes long.'",148],";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$result",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","Security",149],["T_DOUBLE_COLON","::",149],["T_STRING","encrypt",149],"(",["T_VARIABLE","$txt",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$key",149],")",";",["T_WHITESPACE","\n\n        ",149],["T_VARIABLE","$key",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'Not the same key. This one will fail'",151],";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","assertFalse",152],"(",["T_STRING","Security",152],["T_DOUBLE_COLON","::",152],["T_STRING","decrypt",152],"(",["T_VARIABLE","$txt",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$key",152],")",",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'Modified key will fail.'",152],")",";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Test that decrypt fails when there is an hmac error.\n     *\n     * @return void\n     *\/",155],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","testDecryptHmacFailure",160],"(",")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$txt",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox'",162],";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$key",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'This key is quite long and works well.'",163],";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$salt",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'this is a delicious salt!'",164],";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$result",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","Security",165],["T_DOUBLE_COLON","::",165],["T_STRING","encrypt",165],"(",["T_VARIABLE","$txt",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$key",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$salt",165],")",";",["T_WHITESPACE","\n\n        ",165],["T_COMMENT","\/\/ Change one of the bytes in the hmac.\n",167],["T_WHITESPACE","        ",168],["T_VARIABLE","$result",168],"[",["T_LNUMBER","10",168],"]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'x'",168],";",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","assertFalse",169],"(",["T_STRING","Security",169],["T_DOUBLE_COLON","::",169],["T_STRING","decrypt",169],"(",["T_VARIABLE","$result",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$key",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$salt",169],")",",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'Modified hmac causes failure.'",169],")",";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Test that changing the hmac salt will cause failures.\n     *\n     * @return void\n     *\/",172],["T_WHITESPACE","\n    ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","testDecryptHmacSaltFailure",177],"(",")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$txt",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox'",179],";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$key",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'This key is quite long and works well.'",180],";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$salt",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'this is a delicious salt!'",181],";",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$result",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","Security",182],["T_DOUBLE_COLON","::",182],["T_STRING","encrypt",182],"(",["T_VARIABLE","$txt",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$key",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$salt",182],")",";",["T_WHITESPACE","\n\n        ",182],["T_VARIABLE","$salt",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'humpty dumpty had a great fall.'",184],";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertFalse",185],"(",["T_STRING","Security",185],["T_DOUBLE_COLON","::",185],["T_STRING","decrypt",185],"(",["T_VARIABLE","$result",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$key",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$salt",185],")",",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'Modified salt causes failure.'",185],")",";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Test that short keys cause errors\n     *\n     * @expectedException \\InvalidArgumentException\n     * @expectedExceptionMessage Invalid key for encrypt(), key must be at least 256 bits (32 bytes) long.\n     * @return void\n     *\/",188],["T_WHITESPACE","\n    ",194],["T_PUBLIC","public",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","testEncryptInvalidKey",195],"(",")",["T_WHITESPACE","\n    ",195],"{",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$txt",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox jumped over the lazy dog.'",197],";",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$key",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'this is too short'",198],";",["T_WHITESPACE","\n        ",198],["T_STRING","Security",199],["T_DOUBLE_COLON","::",199],["T_STRING","encrypt",199],"(",["T_VARIABLE","$txt",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$key",199],")",";",["T_WHITESPACE","\n    ",199],"}",["T_WHITESPACE","\n\n    ",200],["T_DOC_COMMENT","\/**\n     * Test encrypting falsey data\n     *\n     * @return void\n     *\/",202],["T_WHITESPACE","\n    ",206],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","testEncryptDecryptFalseyData",207],"(",")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$key",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'This is a key that is long enough to be ok.'",209],";",["T_WHITESPACE","\n\n        ",209],["T_VARIABLE","$result",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","Security",211],["T_DOUBLE_COLON","::",211],["T_STRING","encrypt",211],"(",["T_CONSTANT_ENCAPSED_STRING","''",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$key",211],")",";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","assertSame",212],"(",["T_CONSTANT_ENCAPSED_STRING","''",212],",",["T_WHITESPACE"," ",212],["T_STRING","Security",212],["T_DOUBLE_COLON","::",212],["T_STRING","decrypt",212],"(",["T_VARIABLE","$result",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$key",212],")",")",";",["T_WHITESPACE","\n\n        ",212],["T_VARIABLE","$result",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_STRING","Security",214],["T_DOUBLE_COLON","::",214],["T_STRING","encrypt",214],"(",["T_STRING","false",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$key",214],")",";",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","assertSame",215],"(",["T_CONSTANT_ENCAPSED_STRING","''",215],",",["T_WHITESPACE"," ",215],["T_STRING","Security",215],["T_DOUBLE_COLON","::",215],["T_STRING","decrypt",215],"(",["T_VARIABLE","$result",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$key",215],")",")",";",["T_WHITESPACE","\n\n        ",215],["T_VARIABLE","$result",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","Security",217],["T_DOUBLE_COLON","::",217],["T_STRING","encrypt",217],"(",["T_STRING","null",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$key",217],")",";",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","assertSame",218],"(",["T_CONSTANT_ENCAPSED_STRING","''",218],",",["T_WHITESPACE"," ",218],["T_STRING","Security",218],["T_DOUBLE_COLON","::",218],["T_STRING","decrypt",218],"(",["T_VARIABLE","$result",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$key",218],")",")",";",["T_WHITESPACE","\n\n        ",218],["T_VARIABLE","$result",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","Security",220],["T_DOUBLE_COLON","::",220],["T_STRING","encrypt",220],"(",["T_LNUMBER","0",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$key",220],")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","assertSame",221],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",221],",",["T_WHITESPACE"," ",221],["T_STRING","Security",221],["T_DOUBLE_COLON","::",221],["T_STRING","decrypt",221],"(",["T_VARIABLE","$result",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$key",221],")",")",";",["T_WHITESPACE","\n\n        ",221],["T_VARIABLE","$result",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","Security",223],["T_DOUBLE_COLON","::",223],["T_STRING","encrypt",223],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$key",223],")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","assertSame",224],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",224],",",["T_WHITESPACE"," ",224],["T_STRING","Security",224],["T_DOUBLE_COLON","::",224],["T_STRING","decrypt",224],"(",["T_VARIABLE","$result",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$key",224],")",")",";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_DOC_COMMENT","\/**\n     * Test that short keys cause errors\n     *\n     * @expectedException \\InvalidArgumentException\n     * @expectedExceptionMessage Invalid key for decrypt(), key must be at least 256 bits (32 bytes) long.\n     * @return void\n     *\/",227],["T_WHITESPACE","\n    ",233],["T_PUBLIC","public",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","testDecryptInvalidKey",234],"(",")",["T_WHITESPACE","\n    ",234],"{",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$txt",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'The quick brown fox jumped over the lazy dog.'",236],";",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$key",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'this is too short'",237],";",["T_WHITESPACE","\n        ",237],["T_STRING","Security",238],["T_DOUBLE_COLON","::",238],["T_STRING","decrypt",238],"(",["T_VARIABLE","$txt",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$key",238],")",";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Test that empty data cause errors\n     *\n     * @expectedException \\InvalidArgumentException\n     * @expectedExceptionMessage The data to decrypt cannot be empty.\n     * @return void\n     *\/",241],["T_WHITESPACE","\n    ",247],["T_PUBLIC","public",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","testDecryptInvalidData",248],"(",")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$txt",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","''",250],";",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$key",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'This is a key that is long enough to be ok.'",251],";",["T_WHITESPACE","\n        ",251],["T_STRING","Security",252],["T_DOUBLE_COLON","::",252],["T_STRING","decrypt",252],"(",["T_VARIABLE","$txt",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$key",252],")",";",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Test that values encrypted with open ssl can be decrypted with mcrypt and the reverse.\n     *\n     * @return void\n     *\/",255],["T_WHITESPACE","\n    ",259],["T_PUBLIC","public",260],["T_WHITESPACE"," ",260],["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],["T_STRING","testEngineEquivalence",260],"(",")",["T_WHITESPACE","\n    ",260],"{",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","skipIf",262],"(","!",["T_STRING","function_exists",262],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt_encrypt'",262],")",["T_WHITESPACE"," ",262],["T_BOOLEAN_OR","||",262],["T_WHITESPACE"," ",262],["T_STRING","version_compare",262],"(",["T_STRING","PHP_VERSION",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'7.1'",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'>='",262],")",",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'This needs mcrypt extension to be loaded.'",262],")",";",["T_WHITESPACE","\n\n        ",262],["T_VARIABLE","$restore",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_STRING","Security",264],["T_DOUBLE_COLON","::",264],["T_STRING","engine",264],"(",")",";",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$txt",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","\"Obi-wan you're our only hope\"",265],";",["T_WHITESPACE","\n        ",265],["T_VARIABLE","$key",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'This is my secret key phrase it is quite long.'",266],";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$salt",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'A tasty salt that is delicious'",267],";",["T_WHITESPACE","\n\n        ",267],["T_STRING","Security",269],["T_DOUBLE_COLON","::",269],["T_STRING","engine",269],"(",["T_NEW","new",269],["T_WHITESPACE"," ",269],["T_STRING","Mcrypt",269],"(",")",")",";",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$cipher",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_STRING","Security",270],["T_DOUBLE_COLON","::",270],["T_STRING","encrypt",270],"(",["T_VARIABLE","$txt",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$key",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$salt",270],")",";",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","assertEquals",271],"(",["T_VARIABLE","$txt",271],",",["T_WHITESPACE"," ",271],["T_STRING","Security",271],["T_DOUBLE_COLON","::",271],["T_STRING","decrypt",271],"(",["T_VARIABLE","$cipher",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$key",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$salt",271],")",")",";",["T_WHITESPACE","\n\n        ",271],["T_STRING","Security",273],["T_DOUBLE_COLON","::",273],["T_STRING","engine",273],"(",["T_NEW","new",273],["T_WHITESPACE"," ",273],["T_STRING","OpenSsl",273],"(",")",")",";",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","assertEquals",274],"(",["T_VARIABLE","$txt",274],",",["T_WHITESPACE"," ",274],["T_STRING","Security",274],["T_DOUBLE_COLON","::",274],["T_STRING","decrypt",274],"(",["T_VARIABLE","$cipher",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$key",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$salt",274],")",")",";",["T_WHITESPACE","\n\n        ",274],["T_STRING","Security",276],["T_DOUBLE_COLON","::",276],["T_STRING","engine",276],"(",["T_NEW","new",276],["T_WHITESPACE"," ",276],["T_STRING","OpenSsl",276],"(",")",")",";",["T_WHITESPACE","\n        ",276],["T_VARIABLE","$cipher",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_STRING","Security",277],["T_DOUBLE_COLON","::",277],["T_STRING","encrypt",277],"(",["T_VARIABLE","$txt",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$key",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$salt",277],")",";",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","assertEquals",278],"(",["T_VARIABLE","$txt",278],",",["T_WHITESPACE"," ",278],["T_STRING","Security",278],["T_DOUBLE_COLON","::",278],["T_STRING","decrypt",278],"(",["T_VARIABLE","$cipher",278],",",["T_WHITESPACE"," ",278],["T_VARIABLE","$key",278],",",["T_WHITESPACE"," ",278],["T_VARIABLE","$salt",278],")",")",";",["T_WHITESPACE","\n\n        ",278],["T_STRING","Security",280],["T_DOUBLE_COLON","::",280],["T_STRING","engine",280],"(",["T_NEW","new",280],["T_WHITESPACE"," ",280],["T_STRING","Mcrypt",280],"(",")",")",";",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","assertEquals",281],"(",["T_VARIABLE","$txt",281],",",["T_WHITESPACE"," ",281],["T_STRING","Security",281],["T_DOUBLE_COLON","::",281],["T_STRING","decrypt",281],"(",["T_VARIABLE","$cipher",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$key",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$salt",281],")",")",";",["T_WHITESPACE","\n    ",281],"}",["T_WHITESPACE","\n\n    ",282],["T_DOC_COMMENT","\/**\n     * Tests that the salt can be set and retrieved\n     *\n     * @return void\n     *\/",284],["T_WHITESPACE","\n    ",288],["T_PUBLIC","public",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","testSalt",289],"(",")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_STRING","Security",291],["T_DOUBLE_COLON","::",291],["T_STRING","salt",291],"(",["T_CONSTANT_ENCAPSED_STRING","'foobarbaz'",291],")",";",["T_WHITESPACE","\n        ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","assertEquals",292],"(",["T_CONSTANT_ENCAPSED_STRING","'foobarbaz'",292],",",["T_WHITESPACE"," ",292],["T_STRING","Security",292],["T_DOUBLE_COLON","::",292],["T_STRING","salt",292],"(",")",")",";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n\n    ",293],["T_DOC_COMMENT","\/**\n     * Test the randomBytes method.\n     *\n     * @return void\n     *\/",295],["T_WHITESPACE","\n    ",299],["T_PUBLIC","public",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","testRandomBytes",300],"(",")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$value",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","Security",302],["T_DOUBLE_COLON","::",302],["T_STRING","randomBytes",302],"(",["T_LNUMBER","16",302],")",";",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","assertSame",303],"(",["T_LNUMBER","16",303],",",["T_WHITESPACE"," ",303],["T_STRING","strlen",303],"(",["T_VARIABLE","$value",303],")",")",";",["T_WHITESPACE","\n\n        ",303],["T_VARIABLE","$value",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_STRING","Security",305],["T_DOUBLE_COLON","::",305],["T_STRING","randomBytes",305],"(",["T_LNUMBER","64",305],")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","assertSame",306],"(",["T_LNUMBER","64",306],",",["T_WHITESPACE"," ",306],["T_STRING","strlen",306],"(",["T_VARIABLE","$value",306],")",")",";",["T_WHITESPACE","\n\n        ",306],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","assertRegExp",308],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[^0-9a-f]\/'",308],",",["T_WHITESPACE"," ",308],["T_VARIABLE","$value",308],",",["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'should return a binary string'",308],")",";",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * Test the insecureRandomBytes method\n     *\n     * @return void\n     *\/",311],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","testInsecureRandomBytes",316],"(",")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$value",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_STRING","Security",318],["T_DOUBLE_COLON","::",318],["T_STRING","insecureRandomBytes",318],"(",["T_LNUMBER","16",318],")",";",["T_WHITESPACE","\n        ",318],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","assertSame",319],"(",["T_LNUMBER","16",319],",",["T_WHITESPACE"," ",319],["T_STRING","strlen",319],"(",["T_VARIABLE","$value",319],")",")",";",["T_WHITESPACE","\n\n        ",319],["T_VARIABLE","$value",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_STRING","Security",321],["T_DOUBLE_COLON","::",321],["T_STRING","insecureRandomBytes",321],"(",["T_LNUMBER","64",321],")",";",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","assertSame",322],"(",["T_LNUMBER","64",322],",",["T_WHITESPACE"," ",322],["T_STRING","strlen",322],"(",["T_VARIABLE","$value",322],")",")",";",["T_WHITESPACE","\n\n        ",322],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","assertRegExp",324],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[^0-9a-f]\/'",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$value",324],",",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","'should return a binary string'",324],")",";",["T_WHITESPACE","\n    ",324],"}",["T_WHITESPACE","\n",325],"}",["T_WHITESPACE","\n",326]]