[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * @link http:\/\/www.yiiframework.com\/\n * @copyright Copyright (c) 2008 Yii Software LLC\n * @license http:\/\/www.yiiframework.com\/license\/\n *\/",2],["T_WHITESPACE","\n\n",6],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","yii",8],["T_NS_SEPARATOR","\\",8],["T_STRING","base",8],";",["T_WHITESPACE","\n\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","yii",10],["T_NS_SEPARATOR","\\",10],["T_STRING","helpers",10],["T_NS_SEPARATOR","\\",10],["T_STRING","StringHelper",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Yii",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Security provides a set of methods to handle common security-related tasks.\n *\n * In particular, Security supports the following features:\n *\n * - Encryption\/decryption: [[encryptByKey()]], [[decryptByKey()]], [[encryptByPassword()]] and [[decryptByPassword()]]\n * - Key derivation using standard algorithms: [[pbkdf2()]] and [[hkdf()]]\n * - Data tampering prevention: [[hashData()]] and [[validateData()]]\n * - Password validation: [[generatePasswordHash()]] and [[validatePassword()]]\n *\n * > Note: this class requires 'OpenSSL' PHP extension for random key\/string generation on Windows and\n * for encryption\/decryption on all platforms. For the highest security level PHP version >= 5.5.0 is recommended.\n *\n * For more details and usage information on Security, see the [guide article on security](guide:security-overview).\n *\n * @author Qiang Xue <qiang.xue@gmail.com>\n * @author Tom Worster <fsb@thefsb.org>\n * @author Klimov Paul <klimov.paul@gmail.com>\n * @since 2.0\n *\/",13],["T_WHITESPACE","\n",32],["T_CLASS","class",33],["T_WHITESPACE"," ",33],["T_STRING","Security",33],["T_WHITESPACE"," ",33],["T_EXTENDS","extends",33],["T_WHITESPACE"," ",33],["T_STRING","Component",33],["T_WHITESPACE","\n",33],"{",["T_WHITESPACE","\n    ",34],["T_DOC_COMMENT","\/**\n     * @var string The cipher to use for encryption and decryption.\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PUBLIC","public",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$cipher",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'AES-128-CBC'",38],";",["T_WHITESPACE","\n    ",38],["T_DOC_COMMENT","\/**\n     * @var array[] Look-up table of block sizes and key sizes for each supported OpenSSL cipher.\n     *\n     * In each element, the key is one of the ciphers supported by OpenSSL (@see openssl_get_cipher_methods()).\n     * The value is an array of two integers, the first is the cipher's block size in bytes and the second is\n     * the key size in bytes.\n     *\n     * > Warning: All OpenSSL ciphers that we recommend are in the default value, i.e. AES in CBC mode.\n     *\n     * > Note: Yii's encryption protocol uses the same size for cipher key, HMAC signature key and key\n     * derivation salt.\n     *\/",39],["T_WHITESPACE","\n    ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$allowedCiphers",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],"[",["T_WHITESPACE","\n        ",51],["T_CONSTANT_ENCAPSED_STRING","'AES-128-CBC'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],"[",["T_LNUMBER","16",52],",",["T_WHITESPACE"," ",52],["T_LNUMBER","16",52],"]",",",["T_WHITESPACE","\n        ",52],["T_CONSTANT_ENCAPSED_STRING","'AES-192-CBC'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],"[",["T_LNUMBER","16",53],",",["T_WHITESPACE"," ",53],["T_LNUMBER","24",53],"]",",",["T_WHITESPACE","\n        ",53],["T_CONSTANT_ENCAPSED_STRING","'AES-256-CBC'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],"[",["T_LNUMBER","16",54],",",["T_WHITESPACE"," ",54],["T_LNUMBER","32",54],"]",",",["T_WHITESPACE","\n    ",54],"]",";",["T_WHITESPACE","\n    ",55],["T_DOC_COMMENT","\/**\n     * @var string Hash algorithm for key derivation. Recommend sha256, sha384 or sha512.\n     * @see [hash_algos()](http:\/\/php.net\/manual\/en\/function.hash-algos.php)\n     *\/",56],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$kdfHash",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'sha256'",60],";",["T_WHITESPACE","\n    ",60],["T_DOC_COMMENT","\/**\n     * @var string Hash algorithm for message authentication. Recommend sha256, sha384 or sha512.\n     * @see [hash_algos()](http:\/\/php.net\/manual\/en\/function.hash-algos.php)\n     *\/",61],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$macHash",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'sha256'",65],";",["T_WHITESPACE","\n    ",65],["T_DOC_COMMENT","\/**\n     * @var string HKDF info value for derivation of message authentication key.\n     * @see hkdf()\n     *\/",66],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$authKeyInfo",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'AuthorizationKey'",70],";",["T_WHITESPACE","\n    ",70],["T_DOC_COMMENT","\/**\n     * @var int derivation iterations count.\n     * Set as high as possible to hinder dictionary password attacks.\n     *\/",71],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$derivationIterations",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_LNUMBER","100000",75],";",["T_WHITESPACE","\n    ",75],["T_DOC_COMMENT","\/**\n     * @var string strategy, which should be used to generate password hash.\n     * Available strategies:\n     * - 'password_hash' - use of PHP `password_hash()` function with PASSWORD_DEFAULT algorithm.\n     *   This option is recommended, but it requires PHP version >= 5.5.0\n     * - 'crypt' - use PHP `crypt()` function.\n     * @deprecated since version 2.0.7, [[generatePasswordHash()]] ignores [[passwordHashStrategy]] and\n     * uses `password_hash()` when available or `crypt()` when not.\n     *\/",76],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$passwordHashStrategy",85],";",["T_WHITESPACE","\n    ",85],["T_DOC_COMMENT","\/**\n     * @var int Default cost used for password hashing.\n     * Allowed value is between 4 and 31.\n     * @see generatePasswordHash()\n     * @since 2.0.6\n     *\/",86],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$passwordHashCost",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_LNUMBER","13",92],";",["T_WHITESPACE","\n\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Encrypts data using a password.\n     * Derives keys for encryption and authentication from the password using PBKDF2 and a random salt,\n     * which is deliberately slow to protect against dictionary attacks. Use [[encryptByKey()]] to\n     * encrypt fast using a cryptographic key rather than a password. Key derivation time is\n     * determined by [[$derivationIterations]], which should be set as high as possible.\n     * The encrypted data includes a keyed message authentication code (MAC) so there is no need\n     * to hash input or output data.\n     * > Note: Avoid encrypting with passwords wherever possible. Nothing can protect against\n     * poor-quality or compromised passwords.\n     * @param string $data the data to encrypt\n     * @param string $password the password to use for encryption\n     * @return string the encrypted data\n     * @see decryptByPassword()\n     * @see encryptByKey()\n     *\/",95],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","encryptByPassword",111],"(",["T_VARIABLE","$data",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$password",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","encrypt",113],"(",["T_VARIABLE","$data",113],",",["T_WHITESPACE"," ",113],["T_STRING","true",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$password",113],",",["T_WHITESPACE"," ",113],["T_STRING","null",113],")",";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * Encrypts data using a cryptographic key.\n     * Derives keys for encryption and authentication from the input key using HKDF and a random salt,\n     * which is very fast relative to [[encryptByPassword()]]. The input key must be properly\n     * random -- use [[generateRandomKey()]] to generate keys.\n     * The encrypted data includes a keyed message authentication code (MAC) so there is no need\n     * to hash input or output data.\n     * @param string $data the data to encrypt\n     * @param string $inputKey the input to use for encryption and authentication\n     * @param string $info optional context and application specific information, see [[hkdf()]]\n     * @return string the encrypted data\n     * @see decryptByKey()\n     * @see encryptByPassword()\n     *\/",116],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","encryptByKey",130],"(",["T_VARIABLE","$data",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$inputKey",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$info",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","null",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","encrypt",132],"(",["T_VARIABLE","$data",132],",",["T_WHITESPACE"," ",132],["T_STRING","false",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$inputKey",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$info",132],")",";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * Verifies and decrypts data encrypted with [[encryptByPassword()]].\n     * @param string $data the encrypted data to decrypt\n     * @param string $password the password to use for decryption\n     * @return bool|string the decrypted data or false on authentication failure\n     * @see encryptByPassword()\n     *\/",135],["T_WHITESPACE","\n    ",141],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","decryptByPassword",142],"(",["T_VARIABLE","$data",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$password",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","decrypt",144],"(",["T_VARIABLE","$data",144],",",["T_WHITESPACE"," ",144],["T_STRING","true",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$password",144],",",["T_WHITESPACE"," ",144],["T_STRING","null",144],")",";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Verifies and decrypts data encrypted with [[encryptByKey()]].\n     * @param string $data the encrypted data to decrypt\n     * @param string $inputKey the input to use for encryption and authentication\n     * @param string $info optional context and application specific information, see [[hkdf()]]\n     * @return bool|string the decrypted data or false on authentication failure\n     * @see encryptByKey()\n     *\/",147],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","decryptByKey",155],"(",["T_VARIABLE","$data",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$inputKey",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$info",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","null",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","decrypt",157],"(",["T_VARIABLE","$data",157],",",["T_WHITESPACE"," ",157],["T_STRING","false",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$inputKey",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$info",157],")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Encrypts data.\n     *\n     * @param string $data data to be encrypted\n     * @param bool $passwordBased set true to use password-based key derivation\n     * @param string $secret the encryption password or key\n     * @param string $info context\/application specific information, e.g. a user ID\n     * See [RFC 5869 Section 3.2](https:\/\/tools.ietf.org\/html\/rfc5869#section-3.2) for more details.\n     *\n     * @return string the encrypted data\n     * @throws InvalidConfigException on OpenSSL not loaded\n     * @throws Exception on OpenSSL error\n     * @see decrypt()\n     *\/",160],["T_WHITESPACE","\n    ",173],["T_PROTECTED","protected",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","encrypt",174],"(",["T_VARIABLE","$data",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$passwordBased",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$secret",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$info",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(","!",["T_STRING","extension_loaded",176],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl'",176],")",")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_THROW","throw",177],["T_WHITESPACE"," ",177],["T_NEW","new",177],["T_WHITESPACE"," ",177],["T_STRING","InvalidConfigException",177],"(",["T_CONSTANT_ENCAPSED_STRING","'Encryption requires the OpenSSL PHP extension'",177],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_IF","if",179],["T_WHITESPACE"," ",179],"(","!",["T_ISSET","isset",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","allowedCiphers",179],"[",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","cipher",179],"]","[",["T_LNUMBER","0",179],"]",",",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","allowedCiphers",179],"[",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","cipher",179],"]","[",["T_LNUMBER","1",179],"]",")",")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_THROW","throw",180],["T_WHITESPACE"," ",180],["T_NEW","new",180],["T_WHITESPACE"," ",180],["T_STRING","InvalidConfigException",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","cipher",180],["T_WHITESPACE"," ",180],".",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","' is not an allowed cipher'",180],")",";",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n\n        ",181],["T_LIST","list",183],"(",["T_VARIABLE","$blockSize",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$keySize",183],")",["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","allowedCiphers",183],"[",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","cipher",183],"]",";",["T_WHITESPACE","\n\n        ",183],["T_VARIABLE","$keySalt",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","generateRandomKey",185],"(",["T_VARIABLE","$keySize",185],")",";",["T_WHITESPACE","\n        ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$passwordBased",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$key",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","pbkdf2",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","kdfHash",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$secret",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$keySalt",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","derivationIterations",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$keySize",187],")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE"," ",188],["T_ELSE","else",188],["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$key",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","hkdf",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","kdfHash",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$secret",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$keySalt",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$info",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$keySize",189],")",";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n\n        ",190],["T_VARIABLE","$iv",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","generateRandomKey",192],"(",["T_VARIABLE","$blockSize",192],")",";",["T_WHITESPACE","\n\n        ",192],["T_VARIABLE","$encrypted",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","openssl_encrypt",194],"(",["T_VARIABLE","$data",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","cipher",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$key",194],",",["T_WHITESPACE"," ",194],["T_STRING","OPENSSL_RAW_DATA",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$iv",194],")",";",["T_WHITESPACE","\n        ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$encrypted",195],["T_WHITESPACE"," ",195],["T_IS_IDENTICAL","===",195],["T_WHITESPACE"," ",195],["T_STRING","false",195],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_THROW","throw",196],["T_WHITESPACE"," ",196],["T_NEW","new",196],["T_WHITESPACE"," ",196],["T_NS_SEPARATOR","\\",196],["T_STRING","yii",196],["T_NS_SEPARATOR","\\",196],["T_STRING","base",196],["T_NS_SEPARATOR","\\",196],["T_STRING","Exception",196],"(",["T_CONSTANT_ENCAPSED_STRING","'OpenSSL failure on encryption: '",196],["T_WHITESPACE"," ",196],".",["T_WHITESPACE"," ",196],["T_STRING","openssl_error_string",196],"(",")",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n\n        ",197],["T_VARIABLE","$authKey",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","hkdf",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","kdfHash",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$key",199],",",["T_WHITESPACE"," ",199],["T_STRING","null",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","authKeyInfo",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$keySize",199],")",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$hashed",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","hashData",200],"(",["T_VARIABLE","$iv",200],["T_WHITESPACE"," ",200],".",["T_WHITESPACE"," ",200],["T_VARIABLE","$encrypted",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$authKey",200],")",";",["T_WHITESPACE","\n\n        ",200],["T_COMMENT","\/*\n         * Output: [keySalt][MAC][IV][ciphertext]\n         * - keySalt is KEY_SIZE bytes long\n         * - MAC: message authentication code, length same as the output of MAC_HASH\n         * - IV: initialization vector, length $blockSize\n         *\/",202],["T_WHITESPACE","\n        ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$keySalt",208],["T_WHITESPACE"," ",208],".",["T_WHITESPACE"," ",208],["T_VARIABLE","$hashed",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * Decrypts data.\n     *\n     * @param string $data encrypted data to be decrypted.\n     * @param bool $passwordBased set true to use password-based key derivation\n     * @param string $secret the decryption password or key\n     * @param string $info context\/application specific information, @see encrypt()\n     *\n     * @return bool|string the decrypted data or false on authentication failure\n     * @throws InvalidConfigException on OpenSSL not loaded\n     * @throws Exception on OpenSSL error\n     * @see encrypt()\n     *\/",211],["T_WHITESPACE","\n    ",223],["T_PROTECTED","protected",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","decrypt",224],"(",["T_VARIABLE","$data",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$passwordBased",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$secret",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$info",224],")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(","!",["T_STRING","extension_loaded",226],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl'",226],")",")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_THROW","throw",227],["T_WHITESPACE"," ",227],["T_NEW","new",227],["T_WHITESPACE"," ",227],["T_STRING","InvalidConfigException",227],"(",["T_CONSTANT_ENCAPSED_STRING","'Encryption requires the OpenSSL PHP extension'",227],")",";",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE","\n        ",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(","!",["T_ISSET","isset",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","allowedCiphers",229],"[",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","cipher",229],"]","[",["T_LNUMBER","0",229],"]",",",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","allowedCiphers",229],"[",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","cipher",229],"]","[",["T_LNUMBER","1",229],"]",")",")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n            ",229],["T_THROW","throw",230],["T_WHITESPACE"," ",230],["T_NEW","new",230],["T_WHITESPACE"," ",230],["T_STRING","InvalidConfigException",230],"(",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","cipher",230],["T_WHITESPACE"," ",230],".",["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","' is not an allowed cipher'",230],")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n\n        ",231],["T_LIST","list",233],"(",["T_VARIABLE","$blockSize",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$keySize",233],")",["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","allowedCiphers",233],"[",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","cipher",233],"]",";",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$keySalt",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_STRING","StringHelper",235],["T_DOUBLE_COLON","::",235],["T_STRING","byteSubstr",235],"(",["T_VARIABLE","$data",235],",",["T_WHITESPACE"," ",235],["T_LNUMBER","0",235],",",["T_WHITESPACE"," ",235],["T_VARIABLE","$keySize",235],")",";",["T_WHITESPACE","\n        ",235],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$passwordBased",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$key",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","pbkdf2",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","kdfHash",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$secret",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$keySalt",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","derivationIterations",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$keySize",237],")",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE"," ",238],["T_ELSE","else",238],["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$key",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","hkdf",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","kdfHash",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$secret",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$keySalt",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$info",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$keySize",239],")",";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n\n        ",240],["T_VARIABLE","$authKey",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","hkdf",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","kdfHash",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$key",242],",",["T_WHITESPACE"," ",242],["T_STRING","null",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","authKeyInfo",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$keySize",242],")",";",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$data",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","validateData",243],"(",["T_STRING","StringHelper",243],["T_DOUBLE_COLON","::",243],["T_STRING","byteSubstr",243],"(",["T_VARIABLE","$data",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$keySize",243],",",["T_WHITESPACE"," ",243],["T_STRING","null",243],")",",",["T_WHITESPACE"," ",243],["T_VARIABLE","$authKey",243],")",";",["T_WHITESPACE","\n        ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$data",244],["T_WHITESPACE"," ",244],["T_IS_IDENTICAL","===",244],["T_WHITESPACE"," ",244],["T_STRING","false",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_STRING","false",245],";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n\n        ",246],["T_VARIABLE","$iv",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","StringHelper",248],["T_DOUBLE_COLON","::",248],["T_STRING","byteSubstr",248],"(",["T_VARIABLE","$data",248],",",["T_WHITESPACE"," ",248],["T_LNUMBER","0",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$blockSize",248],")",";",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$encrypted",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_STRING","StringHelper",249],["T_DOUBLE_COLON","::",249],["T_STRING","byteSubstr",249],"(",["T_VARIABLE","$data",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$blockSize",249],",",["T_WHITESPACE"," ",249],["T_STRING","null",249],")",";",["T_WHITESPACE","\n\n        ",249],["T_VARIABLE","$decrypted",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","openssl_decrypt",251],"(",["T_VARIABLE","$encrypted",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","cipher",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$key",251],",",["T_WHITESPACE"," ",251],["T_STRING","OPENSSL_RAW_DATA",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$iv",251],")",";",["T_WHITESPACE","\n        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$decrypted",252],["T_WHITESPACE"," ",252],["T_IS_IDENTICAL","===",252],["T_WHITESPACE"," ",252],["T_STRING","false",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_THROW","throw",253],["T_WHITESPACE"," ",253],["T_NEW","new",253],["T_WHITESPACE"," ",253],["T_NS_SEPARATOR","\\",253],["T_STRING","yii",253],["T_NS_SEPARATOR","\\",253],["T_STRING","base",253],["T_NS_SEPARATOR","\\",253],["T_STRING","Exception",253],"(",["T_CONSTANT_ENCAPSED_STRING","'OpenSSL failure on decryption: '",253],["T_WHITESPACE"," ",253],".",["T_WHITESPACE"," ",253],["T_STRING","openssl_error_string",253],"(",")",")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$decrypted",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Derives a key from the given input key using the standard HKDF algorithm.\n     * Implements HKDF specified in [RFC 5869](https:\/\/tools.ietf.org\/html\/rfc5869).\n     * Recommend use one of the SHA-2 hash algorithms: sha224, sha256, sha384 or sha512.\n     * @param string $algo a hash algorithm supported by `hash_hmac()`, e.g. 'SHA-256'\n     * @param string $inputKey the source key\n     * @param string $salt the random salt\n     * @param string $info optional info to bind the derived key material to application-\n     * and context-specific information, e.g. a user ID or API version, see\n     * [RFC 5869](https:\/\/tools.ietf.org\/html\/rfc5869)\n     * @param int $length length of the output key in bytes. If 0, the output key is\n     * the length of the hash algorithm output.\n     * @throws InvalidParamException when HMAC generation fails.\n     * @return string the derived key\n     *\/",259],["T_WHITESPACE","\n    ",273],["T_PUBLIC","public",274],["T_WHITESPACE"," ",274],["T_FUNCTION","function",274],["T_WHITESPACE"," ",274],["T_STRING","hkdf",274],"(",["T_VARIABLE","$algo",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$inputKey",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$salt",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_STRING","null",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$info",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_STRING","null",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$length",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_LNUMBER","0",274],")",["T_WHITESPACE","\n    ",274],"{",["T_WHITESPACE","\n        ",275],["T_VARIABLE","$test",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],"@",["T_STRING","hash_hmac",276],"(",["T_VARIABLE","$algo",276],",",["T_WHITESPACE"," ",276],["T_CONSTANT_ENCAPSED_STRING","''",276],",",["T_WHITESPACE"," ",276],["T_CONSTANT_ENCAPSED_STRING","''",276],",",["T_WHITESPACE"," ",276],["T_STRING","true",276],")",";",["T_WHITESPACE","\n        ",276],["T_IF","if",277],["T_WHITESPACE"," ",277],"(","!",["T_VARIABLE","$test",277],")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n            ",277],["T_THROW","throw",278],["T_WHITESPACE"," ",278],["T_NEW","new",278],["T_WHITESPACE"," ",278],["T_STRING","InvalidParamException",278],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to generate HMAC with hash algorithm: '",278],["T_WHITESPACE"," ",278],".",["T_WHITESPACE"," ",278],["T_VARIABLE","$algo",278],")",";",["T_WHITESPACE","\n        ",278],"}",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$hashLength",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_STRING","StringHelper",280],["T_DOUBLE_COLON","::",280],["T_STRING","byteLength",280],"(",["T_VARIABLE","$test",280],")",";",["T_WHITESPACE","\n        ",280],["T_IF","if",281],["T_WHITESPACE"," ",281],"(",["T_STRING","is_string",281],"(",["T_VARIABLE","$length",281],")",["T_WHITESPACE"," ",281],["T_BOOLEAN_AND","&&",281],["T_WHITESPACE"," ",281],["T_STRING","preg_match",281],"(",["T_CONSTANT_ENCAPSED_STRING","'{^\\d{1,16}$}'",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$length",281],")",")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$length",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_INT_CAST","(int)",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$length",282],";",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n        ",283],["T_IF","if",284],["T_WHITESPACE"," ",284],"(","!",["T_STRING","is_int",284],"(",["T_VARIABLE","$length",284],")",["T_WHITESPACE"," ",284],["T_BOOLEAN_OR","||",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$length",284],["T_WHITESPACE"," ",284],"<",["T_WHITESPACE"," ",284],["T_LNUMBER","0",284],["T_WHITESPACE"," ",284],["T_BOOLEAN_OR","||",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$length",284],["T_WHITESPACE"," ",284],">",["T_WHITESPACE"," ",284],["T_LNUMBER","255",284],["T_WHITESPACE"," ",284],"*",["T_WHITESPACE"," ",284],["T_VARIABLE","$hashLength",284],")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_THROW","throw",285],["T_WHITESPACE"," ",285],["T_NEW","new",285],["T_WHITESPACE"," ",285],["T_STRING","InvalidParamException",285],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid length'",285],")",";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n        ",286],["T_VARIABLE","$blocks",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$length",287],["T_WHITESPACE"," ",287],["T_IS_NOT_IDENTICAL","!==",287],["T_WHITESPACE"," ",287],["T_LNUMBER","0",287],["T_WHITESPACE"," ",287],"?",["T_WHITESPACE"," ",287],["T_STRING","ceil",287],"(",["T_VARIABLE","$length",287],["T_WHITESPACE"," ",287],"\/",["T_WHITESPACE"," ",287],["T_VARIABLE","$hashLength",287],")",["T_WHITESPACE"," ",287],":",["T_WHITESPACE"," ",287],["T_LNUMBER","1",287],";",["T_WHITESPACE","\n\n        ",287],["T_IF","if",289],["T_WHITESPACE"," ",289],"(",["T_VARIABLE","$salt",289],["T_WHITESPACE"," ",289],["T_IS_IDENTICAL","===",289],["T_WHITESPACE"," ",289],["T_STRING","null",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$salt",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","str_repeat",290],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$hashLength",290],")",";",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE","\n        ",291],["T_VARIABLE","$prKey",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_STRING","hash_hmac",292],"(",["T_VARIABLE","$algo",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$inputKey",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$salt",292],",",["T_WHITESPACE"," ",292],["T_STRING","true",292],")",";",["T_WHITESPACE","\n\n        ",292],["T_VARIABLE","$hmac",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","''",294],";",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$outputKey",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","''",295],";",["T_WHITESPACE","\n        ",295],["T_FOR","for",296],["T_WHITESPACE"," ",296],"(",["T_VARIABLE","$i",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_LNUMBER","1",296],";",["T_WHITESPACE"," ",296],["T_VARIABLE","$i",296],["T_WHITESPACE"," ",296],["T_IS_SMALLER_OR_EQUAL","<=",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$blocks",296],";",["T_WHITESPACE"," ",296],["T_VARIABLE","$i",296],["T_INC","++",296],")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n            ",296],["T_VARIABLE","$hmac",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","hash_hmac",297],"(",["T_VARIABLE","$algo",297],",",["T_WHITESPACE"," ",297],["T_VARIABLE","$hmac",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_VARIABLE","$info",297],["T_WHITESPACE"," ",297],".",["T_WHITESPACE"," ",297],["T_STRING","chr",297],"(",["T_VARIABLE","$i",297],")",",",["T_WHITESPACE"," ",297],["T_VARIABLE","$prKey",297],",",["T_WHITESPACE"," ",297],["T_STRING","true",297],")",";",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$outputKey",298],["T_WHITESPACE"," ",298],["T_CONCAT_EQUAL",".=",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$hmac",298],";",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE","\n\n        ",299],["T_IF","if",301],["T_WHITESPACE"," ",301],"(",["T_VARIABLE","$length",301],["T_WHITESPACE"," ",301],["T_IS_NOT_IDENTICAL","!==",301],["T_WHITESPACE"," ",301],["T_LNUMBER","0",301],")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n            ",301],["T_VARIABLE","$outputKey",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","StringHelper",302],["T_DOUBLE_COLON","::",302],["T_STRING","byteSubstr",302],"(",["T_VARIABLE","$outputKey",302],",",["T_WHITESPACE"," ",302],["T_LNUMBER","0",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$length",302],")",";",["T_WHITESPACE","\n        ",302],"}",["T_WHITESPACE","\n        ",303],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$outputKey",304],";",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n\n    ",305],["T_DOC_COMMENT","\/**\n     * Derives a key from the given password using the standard PBKDF2 algorithm.\n     * Implements HKDF2 specified in [RFC 2898](http:\/\/tools.ietf.org\/html\/rfc2898#section-5.2)\n     * Recommend use one of the SHA-2 hash algorithms: sha224, sha256, sha384 or sha512.\n     * @param string $algo a hash algorithm supported by `hash_hmac()`, e.g. 'SHA-256'\n     * @param string $password the source password\n     * @param string $salt the random salt\n     * @param int $iterations the number of iterations of the hash algorithm. Set as high as\n     * possible to hinder dictionary password attacks.\n     * @param int $length length of the output key in bytes. If 0, the output key is\n     * the length of the hash algorithm output.\n     * @return string the derived key\n     * @throws InvalidParamException when hash generation fails due to invalid params given.\n     *\/",307],["T_WHITESPACE","\n    ",320],["T_PUBLIC","public",321],["T_WHITESPACE"," ",321],["T_FUNCTION","function",321],["T_WHITESPACE"," ",321],["T_STRING","pbkdf2",321],"(",["T_VARIABLE","$algo",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$password",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$salt",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$iterations",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$length",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_LNUMBER","0",321],")",["T_WHITESPACE","\n    ",321],"{",["T_WHITESPACE","\n        ",322],["T_IF","if",323],["T_WHITESPACE"," ",323],"(",["T_STRING","function_exists",323],"(",["T_CONSTANT_ENCAPSED_STRING","'hash_pbkdf2'",323],")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n            ",323],["T_VARIABLE","$outputKey",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_STRING","hash_pbkdf2",324],"(",["T_VARIABLE","$algo",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$password",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$salt",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$iterations",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$length",324],",",["T_WHITESPACE"," ",324],["T_STRING","true",324],")",";",["T_WHITESPACE","\n            ",324],["T_IF","if",325],["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$outputKey",325],["T_WHITESPACE"," ",325],["T_IS_IDENTICAL","===",325],["T_WHITESPACE"," ",325],["T_STRING","false",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                ",325],["T_THROW","throw",326],["T_WHITESPACE"," ",326],["T_NEW","new",326],["T_WHITESPACE"," ",326],["T_STRING","InvalidParamException",326],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid parameters to hash_pbkdf2()'",326],")",";",["T_WHITESPACE","\n            ",326],"}",["T_WHITESPACE","\n            ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$outputKey",328],";",["T_WHITESPACE","\n        ",328],"}",["T_WHITESPACE","\n\n        ",329],["T_COMMENT","\/\/ todo: is there a nice way to reduce the code repetition in hkdf() and pbkdf2()?\n",331],["T_WHITESPACE","        ",332],["T_VARIABLE","$test",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],"@",["T_STRING","hash_hmac",332],"(",["T_VARIABLE","$algo",332],",",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","''",332],",",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","''",332],",",["T_WHITESPACE"," ",332],["T_STRING","true",332],")",";",["T_WHITESPACE","\n        ",332],["T_IF","if",333],["T_WHITESPACE"," ",333],"(","!",["T_VARIABLE","$test",333],")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n            ",333],["T_THROW","throw",334],["T_WHITESPACE"," ",334],["T_NEW","new",334],["T_WHITESPACE"," ",334],["T_STRING","InvalidParamException",334],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to generate HMAC with hash algorithm: '",334],["T_WHITESPACE"," ",334],".",["T_WHITESPACE"," ",334],["T_VARIABLE","$algo",334],")",";",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE","\n        ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_STRING","is_string",336],"(",["T_VARIABLE","$iterations",336],")",["T_WHITESPACE"," ",336],["T_BOOLEAN_AND","&&",336],["T_WHITESPACE"," ",336],["T_STRING","preg_match",336],"(",["T_CONSTANT_ENCAPSED_STRING","'{^\\d{1,16}$}'",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$iterations",336],")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n            ",336],["T_VARIABLE","$iterations",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_INT_CAST","(int)",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$iterations",337],";",["T_WHITESPACE","\n        ",337],"}",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(","!",["T_STRING","is_int",339],"(",["T_VARIABLE","$iterations",339],")",["T_WHITESPACE"," ",339],["T_BOOLEAN_OR","||",339],["T_WHITESPACE"," ",339],["T_VARIABLE","$iterations",339],["T_WHITESPACE"," ",339],"<",["T_WHITESPACE"," ",339],["T_LNUMBER","1",339],")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_THROW","throw",340],["T_WHITESPACE"," ",340],["T_NEW","new",340],["T_WHITESPACE"," ",340],["T_STRING","InvalidParamException",340],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid iterations'",340],")",";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE","\n        ",341],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_STRING","is_string",342],"(",["T_VARIABLE","$length",342],")",["T_WHITESPACE"," ",342],["T_BOOLEAN_AND","&&",342],["T_WHITESPACE"," ",342],["T_STRING","preg_match",342],"(",["T_CONSTANT_ENCAPSED_STRING","'{^\\d{1,16}$}'",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$length",342],")",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$length",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_INT_CAST","(int)",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$length",343],";",["T_WHITESPACE","\n        ",343],"}",["T_WHITESPACE","\n        ",344],["T_IF","if",345],["T_WHITESPACE"," ",345],"(","!",["T_STRING","is_int",345],"(",["T_VARIABLE","$length",345],")",["T_WHITESPACE"," ",345],["T_BOOLEAN_OR","||",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$length",345],["T_WHITESPACE"," ",345],"<",["T_WHITESPACE"," ",345],["T_LNUMBER","0",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n            ",345],["T_THROW","throw",346],["T_WHITESPACE"," ",346],["T_NEW","new",346],["T_WHITESPACE"," ",346],["T_STRING","InvalidParamException",346],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid length'",346],")",";",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE","\n        ",347],["T_VARIABLE","$hashLength",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","StringHelper",348],["T_DOUBLE_COLON","::",348],["T_STRING","byteLength",348],"(",["T_VARIABLE","$test",348],")",";",["T_WHITESPACE","\n        ",348],["T_VARIABLE","$blocks",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_VARIABLE","$length",349],["T_WHITESPACE"," ",349],["T_IS_NOT_IDENTICAL","!==",349],["T_WHITESPACE"," ",349],["T_LNUMBER","0",349],["T_WHITESPACE"," ",349],"?",["T_WHITESPACE"," ",349],["T_STRING","ceil",349],"(",["T_VARIABLE","$length",349],["T_WHITESPACE"," ",349],"\/",["T_WHITESPACE"," ",349],["T_VARIABLE","$hashLength",349],")",["T_WHITESPACE"," ",349],":",["T_WHITESPACE"," ",349],["T_LNUMBER","1",349],";",["T_WHITESPACE","\n\n        ",349],["T_VARIABLE","$outputKey",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","''",351],";",["T_WHITESPACE","\n        ",351],["T_FOR","for",352],["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$j",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_LNUMBER","1",352],";",["T_WHITESPACE"," ",352],["T_VARIABLE","$j",352],["T_WHITESPACE"," ",352],["T_IS_SMALLER_OR_EQUAL","<=",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$blocks",352],";",["T_WHITESPACE"," ",352],["T_VARIABLE","$j",352],["T_INC","++",352],")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n            ",352],["T_VARIABLE","$hmac",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_STRING","hash_hmac",353],"(",["T_VARIABLE","$algo",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$salt",353],["T_WHITESPACE"," ",353],".",["T_WHITESPACE"," ",353],["T_STRING","pack",353],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$j",353],")",",",["T_WHITESPACE"," ",353],["T_VARIABLE","$password",353],",",["T_WHITESPACE"," ",353],["T_STRING","true",353],")",";",["T_WHITESPACE","\n            ",353],["T_VARIABLE","$xorsum",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$hmac",354],";",["T_WHITESPACE","\n            ",354],["T_FOR","for",355],["T_WHITESPACE"," ",355],"(",["T_VARIABLE","$i",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_LNUMBER","1",355],";",["T_WHITESPACE"," ",355],["T_VARIABLE","$i",355],["T_WHITESPACE"," ",355],"<",["T_WHITESPACE"," ",355],["T_VARIABLE","$iterations",355],";",["T_WHITESPACE"," ",355],["T_VARIABLE","$i",355],["T_INC","++",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$hmac",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_STRING","hash_hmac",356],"(",["T_VARIABLE","$algo",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$hmac",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$password",356],",",["T_WHITESPACE"," ",356],["T_STRING","true",356],")",";",["T_WHITESPACE","\n                ",356],["T_VARIABLE","$xorsum",357],["T_WHITESPACE"," ",357],["T_XOR_EQUAL","^=",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$hmac",357],";",["T_WHITESPACE","\n            ",357],"}",["T_WHITESPACE","\n            ",358],["T_VARIABLE","$outputKey",359],["T_WHITESPACE"," ",359],["T_CONCAT_EQUAL",".=",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$xorsum",359],";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n\n        ",360],["T_IF","if",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$length",362],["T_WHITESPACE"," ",362],["T_IS_NOT_IDENTICAL","!==",362],["T_WHITESPACE"," ",362],["T_LNUMBER","0",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_VARIABLE","$outputKey",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_STRING","StringHelper",363],["T_DOUBLE_COLON","::",363],["T_STRING","byteSubstr",363],"(",["T_VARIABLE","$outputKey",363],",",["T_WHITESPACE"," ",363],["T_LNUMBER","0",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$length",363],")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE","\n        ",364],["T_RETURN","return",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$outputKey",365],";",["T_WHITESPACE","\n    ",365],"}",["T_WHITESPACE","\n\n    ",366],["T_DOC_COMMENT","\/**\n     * Prefixes data with a keyed hash value so that it can later be detected if it is tampered.\n     * There is no need to hash inputs or outputs of [[encryptByKey()]] or [[encryptByPassword()]]\n     * as those methods perform the task.\n     * @param string $data the data to be protected\n     * @param string $key the secret key to be used for generating hash. Should be a secure\n     * cryptographic key.\n     * @param bool $rawHash whether the generated hash value is in raw binary format. If false, lowercase\n     * hex digits will be generated.\n     * @return string the data prefixed with the keyed hash\n     * @throws InvalidConfigException when HMAC generation fails.\n     * @see validateData()\n     * @see generateRandomKey()\n     * @see hkdf()\n     * @see pbkdf2()\n     *\/",368],["T_WHITESPACE","\n    ",383],["T_PUBLIC","public",384],["T_WHITESPACE"," ",384],["T_FUNCTION","function",384],["T_WHITESPACE"," ",384],["T_STRING","hashData",384],"(",["T_VARIABLE","$data",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$key",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$rawHash",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","false",384],")",["T_WHITESPACE","\n    ",384],"{",["T_WHITESPACE","\n        ",385],["T_VARIABLE","$hash",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","hash_hmac",386],"(",["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","macHash",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$data",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$key",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$rawHash",386],")",";",["T_WHITESPACE","\n        ",386],["T_IF","if",387],["T_WHITESPACE"," ",387],"(","!",["T_VARIABLE","$hash",387],")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n            ",387],["T_THROW","throw",388],["T_WHITESPACE"," ",388],["T_NEW","new",388],["T_WHITESPACE"," ",388],["T_STRING","InvalidConfigException",388],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to generate HMAC with hash algorithm: '",388],["T_WHITESPACE"," ",388],".",["T_WHITESPACE"," ",388],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","macHash",388],")",";",["T_WHITESPACE","\n        ",388],"}",["T_WHITESPACE","\n        ",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$hash",390],["T_WHITESPACE"," ",390],".",["T_WHITESPACE"," ",390],["T_VARIABLE","$data",390],";",["T_WHITESPACE","\n    ",390],"}",["T_WHITESPACE","\n\n    ",391],["T_DOC_COMMENT","\/**\n     * Validates if the given data is tampered.\n     * @param string $data the data to be validated. The data must be previously\n     * generated by [[hashData()]].\n     * @param string $key the secret key that was previously used to generate the hash for the data in [[hashData()]].\n     * function to see the supported hashing algorithms on your system. This must be the same\n     * as the value passed to [[hashData()]] when generating the hash for the data.\n     * @param bool $rawHash this should take the same value as when you generate the data using [[hashData()]].\n     * It indicates whether the hash value in the data is in binary format. If false, it means the hash value consists\n     * of lowercase hex digits only.\n     * hex digits will be generated.\n     * @return string the real data with the hash stripped off. False if the data is tampered.\n     * @throws InvalidConfigException when HMAC generation fails.\n     * @see hashData()\n     *\/",393],["T_WHITESPACE","\n    ",407],["T_PUBLIC","public",408],["T_WHITESPACE"," ",408],["T_FUNCTION","function",408],["T_WHITESPACE"," ",408],["T_STRING","validateData",408],"(",["T_VARIABLE","$data",408],",",["T_WHITESPACE"," ",408],["T_VARIABLE","$key",408],",",["T_WHITESPACE"," ",408],["T_VARIABLE","$rawHash",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_STRING","false",408],")",["T_WHITESPACE","\n    ",408],"{",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$test",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],"@",["T_STRING","hash_hmac",410],"(",["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","macHash",410],",",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","''",410],",",["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","''",410],",",["T_WHITESPACE"," ",410],["T_VARIABLE","$rawHash",410],")",";",["T_WHITESPACE","\n        ",410],["T_IF","if",411],["T_WHITESPACE"," ",411],"(","!",["T_VARIABLE","$test",411],")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n            ",411],["T_THROW","throw",412],["T_WHITESPACE"," ",412],["T_NEW","new",412],["T_WHITESPACE"," ",412],["T_STRING","InvalidConfigException",412],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to generate HMAC with hash algorithm: '",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE"," ",412],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","macHash",412],")",";",["T_WHITESPACE","\n        ",412],"}",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$hashLength",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_STRING","StringHelper",414],["T_DOUBLE_COLON","::",414],["T_STRING","byteLength",414],"(",["T_VARIABLE","$test",414],")",";",["T_WHITESPACE","\n        ",414],["T_IF","if",415],["T_WHITESPACE"," ",415],"(",["T_STRING","StringHelper",415],["T_DOUBLE_COLON","::",415],["T_STRING","byteLength",415],"(",["T_VARIABLE","$data",415],")",["T_WHITESPACE"," ",415],["T_IS_GREATER_OR_EQUAL",">=",415],["T_WHITESPACE"," ",415],["T_VARIABLE","$hashLength",415],")",["T_WHITESPACE"," ",415],"{",["T_WHITESPACE","\n            ",415],["T_VARIABLE","$hash",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_STRING","StringHelper",416],["T_DOUBLE_COLON","::",416],["T_STRING","byteSubstr",416],"(",["T_VARIABLE","$data",416],",",["T_WHITESPACE"," ",416],["T_LNUMBER","0",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$hashLength",416],")",";",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$pureData",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_STRING","StringHelper",417],["T_DOUBLE_COLON","::",417],["T_STRING","byteSubstr",417],"(",["T_VARIABLE","$data",417],",",["T_WHITESPACE"," ",417],["T_VARIABLE","$hashLength",417],",",["T_WHITESPACE"," ",417],["T_STRING","null",417],")",";",["T_WHITESPACE","\n\n            ",417],["T_VARIABLE","$calculatedHash",419],["T_WHITESPACE"," ",419],"=",["T_WHITESPACE"," ",419],["T_STRING","hash_hmac",419],"(",["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","macHash",419],",",["T_WHITESPACE"," ",419],["T_VARIABLE","$pureData",419],",",["T_WHITESPACE"," ",419],["T_VARIABLE","$key",419],",",["T_WHITESPACE"," ",419],["T_VARIABLE","$rawHash",419],")",";",["T_WHITESPACE","\n\n            ",419],["T_IF","if",421],["T_WHITESPACE"," ",421],"(",["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","compareString",421],"(",["T_VARIABLE","$hash",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$calculatedHash",421],")",")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n                ",421],["T_RETURN","return",422],["T_WHITESPACE"," ",422],["T_VARIABLE","$pureData",422],";",["T_WHITESPACE","\n            ",422],"}",["T_WHITESPACE","\n        ",423],"}",["T_WHITESPACE","\n        ",424],["T_RETURN","return",425],["T_WHITESPACE"," ",425],["T_STRING","false",425],";",["T_WHITESPACE","\n    ",425],"}",["T_WHITESPACE","\n\n    ",426],["T_PRIVATE","private",428],["T_WHITESPACE"," ",428],["T_VARIABLE","$_useLibreSSL",428],";",["T_WHITESPACE","\n    ",428],["T_PRIVATE","private",429],["T_WHITESPACE"," ",429],["T_VARIABLE","$_randomFile",429],";",["T_WHITESPACE","\n\n    ",429],["T_DOC_COMMENT","\/**\n     * Generates specified number of random bytes.\n     * Note that output may not be ASCII.\n     * @see generateRandomString() if you need a string.\n     *\n     * @param int $length the number of bytes to generate\n     * @return string the generated random bytes\n     * @throws InvalidParamException if wrong length is specified\n     * @throws Exception on failure.\n     *\/",431],["T_WHITESPACE","\n    ",440],["T_PUBLIC","public",441],["T_WHITESPACE"," ",441],["T_FUNCTION","function",441],["T_WHITESPACE"," ",441],["T_STRING","generateRandomKey",441],"(",["T_VARIABLE","$length",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_LNUMBER","32",441],")",["T_WHITESPACE","\n    ",441],"{",["T_WHITESPACE","\n        ",442],["T_IF","if",443],["T_WHITESPACE"," ",443],"(","!",["T_STRING","is_int",443],"(",["T_VARIABLE","$length",443],")",")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n            ",443],["T_THROW","throw",444],["T_WHITESPACE"," ",444],["T_NEW","new",444],["T_WHITESPACE"," ",444],["T_STRING","InvalidParamException",444],"(",["T_CONSTANT_ENCAPSED_STRING","'First parameter ($length) must be an integer'",444],")",";",["T_WHITESPACE","\n        ",444],"}",["T_WHITESPACE","\n\n        ",445],["T_IF","if",447],["T_WHITESPACE"," ",447],"(",["T_VARIABLE","$length",447],["T_WHITESPACE"," ",447],"<",["T_WHITESPACE"," ",447],["T_LNUMBER","1",447],")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n            ",447],["T_THROW","throw",448],["T_WHITESPACE"," ",448],["T_NEW","new",448],["T_WHITESPACE"," ",448],["T_STRING","InvalidParamException",448],"(",["T_CONSTANT_ENCAPSED_STRING","'First parameter ($length) must be greater than 0'",448],")",";",["T_WHITESPACE","\n        ",448],"}",["T_WHITESPACE","\n\n        ",449],["T_COMMENT","\/\/ always use random_bytes() if it is available\n",451],["T_WHITESPACE","        ",452],["T_IF","if",452],["T_WHITESPACE"," ",452],"(",["T_STRING","function_exists",452],"(",["T_CONSTANT_ENCAPSED_STRING","'random_bytes'",452],")",")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n            ",452],["T_RETURN","return",453],["T_WHITESPACE"," ",453],["T_STRING","random_bytes",453],"(",["T_VARIABLE","$length",453],")",";",["T_WHITESPACE","\n        ",453],"}",["T_WHITESPACE","\n\n        ",454],["T_COMMENT","\/\/ The recent LibreSSL RNGs are faster and likely better than \/dev\/urandom.\n",456],["T_WHITESPACE","        ",457],["T_COMMENT","\/\/ Parse OPENSSL_VERSION_TEXT because OPENSSL_VERSION_NUMBER is no use for LibreSSL.\n",457],["T_WHITESPACE","        ",458],["T_COMMENT","\/\/ https:\/\/bugs.php.net\/bug.php?id=71143\n",458],["T_WHITESPACE","        ",459],["T_IF","if",459],["T_WHITESPACE"," ",459],"(",["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","_useLibreSSL",459],["T_WHITESPACE"," ",459],["T_IS_IDENTICAL","===",459],["T_WHITESPACE"," ",459],["T_STRING","null",459],")",["T_WHITESPACE"," ",459],"{",["T_WHITESPACE","\n            ",459],["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","_useLibreSSL",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_STRING","defined",460],"(",["T_CONSTANT_ENCAPSED_STRING","'OPENSSL_VERSION_TEXT'",460],")",["T_WHITESPACE","\n                ",460],["T_BOOLEAN_AND","&&",461],["T_WHITESPACE"," ",461],["T_STRING","preg_match",461],"(",["T_CONSTANT_ENCAPSED_STRING","'{^LibreSSL (\\d\\d?)\\.(\\d\\d?)\\.(\\d\\d?)$}'",461],",",["T_WHITESPACE"," ",461],["T_STRING","OPENSSL_VERSION_TEXT",461],",",["T_WHITESPACE"," ",461],["T_VARIABLE","$matches",461],")",["T_WHITESPACE","\n                ",461],["T_BOOLEAN_AND","&&",462],["T_WHITESPACE"," ",462],"(",["T_LNUMBER","10000",462],["T_WHITESPACE"," ",462],"*",["T_WHITESPACE"," ",462],["T_VARIABLE","$matches",462],"[",["T_LNUMBER","1",462],"]",")",["T_WHITESPACE"," ",462],"+",["T_WHITESPACE"," ",462],"(",["T_LNUMBER","100",462],["T_WHITESPACE"," ",462],"*",["T_WHITESPACE"," ",462],["T_VARIABLE","$matches",462],"[",["T_LNUMBER","2",462],"]",")",["T_WHITESPACE"," ",462],"+",["T_WHITESPACE"," ",462],["T_VARIABLE","$matches",462],"[",["T_LNUMBER","3",462],"]",["T_WHITESPACE"," ",462],["T_IS_GREATER_OR_EQUAL",">=",462],["T_WHITESPACE"," ",462],["T_LNUMBER","20105",462],";",["T_WHITESPACE","\n        ",462],"}",["T_WHITESPACE","\n\n        ",463],["T_COMMENT","\/\/ Since 5.4.0, openssl_random_pseudo_bytes() reads from CryptGenRandom on Windows instead\n",465],["T_WHITESPACE","        ",466],["T_COMMENT","\/\/ of using OpenSSL library. LibreSSL is OK everywhere but don't use OpenSSL on non-Windows.\n",466],["T_WHITESPACE","        ",467],["T_IF","if",467],["T_WHITESPACE"," ",467],"(",["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_useLibreSSL",467],["T_WHITESPACE","\n            ",467],["T_BOOLEAN_OR","||",468],["T_WHITESPACE"," ",468],"(",["T_WHITESPACE","\n                ",468],["T_STRING","DIRECTORY_SEPARATOR",469],["T_WHITESPACE"," ",469],["T_IS_NOT_IDENTICAL","!==",469],["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'\/'",469],["T_WHITESPACE","\n                ",469],["T_BOOLEAN_AND","&&",470],["T_WHITESPACE"," ",470],["T_STRING","substr_compare",470],"(",["T_STRING","PHP_OS",470],",",["T_WHITESPACE"," ",470],["T_CONSTANT_ENCAPSED_STRING","'win'",470],",",["T_WHITESPACE"," ",470],["T_LNUMBER","0",470],",",["T_WHITESPACE"," ",470],["T_LNUMBER","3",470],",",["T_WHITESPACE"," ",470],["T_STRING","true",470],")",["T_WHITESPACE"," ",470],["T_IS_IDENTICAL","===",470],["T_WHITESPACE"," ",470],["T_LNUMBER","0",470],["T_WHITESPACE","\n                ",470],["T_BOOLEAN_AND","&&",471],["T_WHITESPACE"," ",471],["T_STRING","function_exists",471],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl_random_pseudo_bytes'",471],")",["T_WHITESPACE","\n            ",471],")",["T_WHITESPACE","\n        ",472],")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$key",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","openssl_random_pseudo_bytes",474],"(",["T_VARIABLE","$length",474],",",["T_WHITESPACE"," ",474],["T_VARIABLE","$cryptoStrong",474],")",";",["T_WHITESPACE","\n            ",474],["T_IF","if",475],["T_WHITESPACE"," ",475],"(",["T_VARIABLE","$cryptoStrong",475],["T_WHITESPACE"," ",475],["T_IS_IDENTICAL","===",475],["T_WHITESPACE"," ",475],["T_STRING","false",475],")",["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n                ",475],["T_THROW","throw",476],["T_WHITESPACE"," ",476],["T_NEW","new",476],["T_WHITESPACE"," ",476],["T_STRING","Exception",476],"(",["T_WHITESPACE","\n                    ",476],["T_CONSTANT_ENCAPSED_STRING","'openssl_random_pseudo_bytes() set $crypto_strong false. Your PHP setup is insecure.'",477],["T_WHITESPACE","\n                ",477],")",";",["T_WHITESPACE","\n            ",478],"}",["T_WHITESPACE","\n            ",479],["T_IF","if",480],["T_WHITESPACE"," ",480],"(",["T_VARIABLE","$key",480],["T_WHITESPACE"," ",480],["T_IS_NOT_IDENTICAL","!==",480],["T_WHITESPACE"," ",480],["T_STRING","false",480],["T_WHITESPACE"," ",480],["T_BOOLEAN_AND","&&",480],["T_WHITESPACE"," ",480],["T_STRING","StringHelper",480],["T_DOUBLE_COLON","::",480],["T_STRING","byteLength",480],"(",["T_VARIABLE","$key",480],")",["T_WHITESPACE"," ",480],["T_IS_IDENTICAL","===",480],["T_WHITESPACE"," ",480],["T_VARIABLE","$length",480],")",["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n                ",480],["T_RETURN","return",481],["T_WHITESPACE"," ",481],["T_VARIABLE","$key",481],";",["T_WHITESPACE","\n            ",481],"}",["T_WHITESPACE","\n        ",482],"}",["T_WHITESPACE","\n\n        ",483],["T_COMMENT","\/\/ mcrypt_create_iv() does not use libmcrypt. Since PHP 5.3.7 it directly reads\n",485],["T_WHITESPACE","        ",486],["T_COMMENT","\/\/ CryptGenRandom on Windows. Elsewhere it directly reads \/dev\/urandom.\n",486],["T_WHITESPACE","        ",487],["T_IF","if",487],["T_WHITESPACE"," ",487],"(",["T_STRING","function_exists",487],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt_create_iv'",487],")",")",["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n            ",487],["T_VARIABLE","$key",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_STRING","mcrypt_create_iv",488],"(",["T_VARIABLE","$length",488],",",["T_WHITESPACE"," ",488],["T_STRING","MCRYPT_DEV_URANDOM",488],")",";",["T_WHITESPACE","\n            ",488],["T_IF","if",489],["T_WHITESPACE"," ",489],"(",["T_STRING","StringHelper",489],["T_DOUBLE_COLON","::",489],["T_STRING","byteLength",489],"(",["T_VARIABLE","$key",489],")",["T_WHITESPACE"," ",489],["T_IS_IDENTICAL","===",489],["T_WHITESPACE"," ",489],["T_VARIABLE","$length",489],")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n                ",489],["T_RETURN","return",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$key",490],";",["T_WHITESPACE","\n            ",490],"}",["T_WHITESPACE","\n        ",491],"}",["T_WHITESPACE","\n\n        ",492],["T_COMMENT","\/\/ If not on Windows, try to open a random device.\n",494],["T_WHITESPACE","        ",495],["T_IF","if",495],["T_WHITESPACE"," ",495],"(",["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_randomFile",495],["T_WHITESPACE"," ",495],["T_IS_IDENTICAL","===",495],["T_WHITESPACE"," ",495],["T_STRING","null",495],["T_WHITESPACE"," ",495],["T_BOOLEAN_AND","&&",495],["T_WHITESPACE"," ",495],["T_STRING","DIRECTORY_SEPARATOR",495],["T_WHITESPACE"," ",495],["T_IS_IDENTICAL","===",495],["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'\/'",495],")",["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n            ",495],["T_COMMENT","\/\/ urandom is a symlink to random on FreeBSD.\n",496],["T_WHITESPACE","            ",497],["T_VARIABLE","$device",497],["T_WHITESPACE"," ",497],"=",["T_WHITESPACE"," ",497],["T_STRING","PHP_OS",497],["T_WHITESPACE"," ",497],["T_IS_IDENTICAL","===",497],["T_WHITESPACE"," ",497],["T_CONSTANT_ENCAPSED_STRING","'FreeBSD'",497],["T_WHITESPACE"," ",497],"?",["T_WHITESPACE"," ",497],["T_CONSTANT_ENCAPSED_STRING","'\/dev\/random'",497],["T_WHITESPACE"," ",497],":",["T_WHITESPACE"," ",497],["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",497],";",["T_WHITESPACE","\n            ",497],["T_COMMENT","\/\/ Check random device for special character device protection mode. Use lstat()\n",498],["T_WHITESPACE","            ",499],["T_COMMENT","\/\/ instead of stat() in case an attacker arranges a symlink to a fake device.\n",499],["T_WHITESPACE","            ",500],["T_VARIABLE","$lstat",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],"@",["T_STRING","lstat",500],"(",["T_VARIABLE","$device",500],")",";",["T_WHITESPACE","\n            ",500],["T_IF","if",501],["T_WHITESPACE"," ",501],"(",["T_VARIABLE","$lstat",501],["T_WHITESPACE"," ",501],["T_IS_NOT_IDENTICAL","!==",501],["T_WHITESPACE"," ",501],["T_STRING","false",501],["T_WHITESPACE"," ",501],["T_BOOLEAN_AND","&&",501],["T_WHITESPACE"," ",501],"(",["T_VARIABLE","$lstat",501],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",501],"]",["T_WHITESPACE"," ",501],"&",["T_WHITESPACE"," ",501],["T_LNUMBER","0170000",501],")",["T_WHITESPACE"," ",501],["T_IS_IDENTICAL","===",501],["T_WHITESPACE"," ",501],["T_LNUMBER","020000",501],")",["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n                ",501],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","_randomFile",502],["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_STRING","fopen",502],"(",["T_VARIABLE","$device",502],",",["T_WHITESPACE"," ",502],["T_CONSTANT_ENCAPSED_STRING","'rb'",502],")",["T_WHITESPACE"," ",502],"?",":",["T_WHITESPACE"," ",502],["T_STRING","null",502],";",["T_WHITESPACE","\n\n                ",502],["T_IF","if",504],["T_WHITESPACE"," ",504],"(",["T_STRING","is_resource",504],"(",["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","_randomFile",504],")",")",["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n                    ",504],["T_COMMENT","\/\/ Reduce PHP stream buffer from default 8192 bytes to optimize data\n",505],["T_WHITESPACE","                    ",506],["T_COMMENT","\/\/ transfer from the random device for smaller values of $length.\n",506],["T_WHITESPACE","                    ",507],["T_COMMENT","\/\/ This also helps to keep future randoms out of user memory space.\n",507],["T_WHITESPACE","                    ",508],["T_VARIABLE","$bufferSize",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_LNUMBER","8",508],";",["T_WHITESPACE","\n\n                    ",508],["T_IF","if",510],["T_WHITESPACE"," ",510],"(",["T_STRING","function_exists",510],"(",["T_CONSTANT_ENCAPSED_STRING","'stream_set_read_buffer'",510],")",")",["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n                        ",510],["T_STRING","stream_set_read_buffer",511],"(",["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","_randomFile",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$bufferSize",511],")",";",["T_WHITESPACE","\n                    ",511],"}",["T_WHITESPACE","\n                    ",512],["T_COMMENT","\/\/ stream_set_read_buffer() isn't implemented on HHVM\n",513],["T_WHITESPACE","                    ",514],["T_IF","if",514],["T_WHITESPACE"," ",514],"(",["T_STRING","function_exists",514],"(",["T_CONSTANT_ENCAPSED_STRING","'stream_set_chunk_size'",514],")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n                        ",514],["T_STRING","stream_set_chunk_size",515],"(",["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","_randomFile",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$bufferSize",515],")",";",["T_WHITESPACE","\n                    ",515],"}",["T_WHITESPACE","\n                ",516],"}",["T_WHITESPACE","\n            ",517],"}",["T_WHITESPACE","\n        ",518],"}",["T_WHITESPACE","\n\n        ",519],["T_IF","if",521],["T_WHITESPACE"," ",521],"(",["T_STRING","is_resource",521],"(",["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","_randomFile",521],")",")",["T_WHITESPACE"," ",521],"{",["T_WHITESPACE","\n            ",521],["T_VARIABLE","$buffer",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_CONSTANT_ENCAPSED_STRING","''",522],";",["T_WHITESPACE","\n            ",522],["T_VARIABLE","$stillNeed",523],["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_VARIABLE","$length",523],";",["T_WHITESPACE","\n            ",523],["T_WHILE","while",524],["T_WHITESPACE"," ",524],"(",["T_VARIABLE","$stillNeed",524],["T_WHITESPACE"," ",524],">",["T_WHITESPACE"," ",524],["T_LNUMBER","0",524],")",["T_WHITESPACE"," ",524],"{",["T_WHITESPACE","\n                ",524],["T_VARIABLE","$someBytes",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_STRING","fread",525],"(",["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","_randomFile",525],",",["T_WHITESPACE"," ",525],["T_VARIABLE","$stillNeed",525],")",";",["T_WHITESPACE","\n                ",525],["T_IF","if",526],["T_WHITESPACE"," ",526],"(",["T_VARIABLE","$someBytes",526],["T_WHITESPACE"," ",526],["T_IS_IDENTICAL","===",526],["T_WHITESPACE"," ",526],["T_STRING","false",526],")",["T_WHITESPACE"," ",526],"{",["T_WHITESPACE","\n                    ",526],["T_BREAK","break",527],";",["T_WHITESPACE","\n                ",527],"}",["T_WHITESPACE","\n                ",528],["T_VARIABLE","$buffer",529],["T_WHITESPACE"," ",529],["T_CONCAT_EQUAL",".=",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$someBytes",529],";",["T_WHITESPACE","\n                ",529],["T_VARIABLE","$stillNeed",530],["T_WHITESPACE"," ",530],["T_MINUS_EQUAL","-=",530],["T_WHITESPACE"," ",530],["T_STRING","StringHelper",530],["T_DOUBLE_COLON","::",530],["T_STRING","byteLength",530],"(",["T_VARIABLE","$someBytes",530],")",";",["T_WHITESPACE","\n                ",530],["T_IF","if",531],["T_WHITESPACE"," ",531],"(",["T_VARIABLE","$stillNeed",531],["T_WHITESPACE"," ",531],["T_IS_IDENTICAL","===",531],["T_WHITESPACE"," ",531],["T_LNUMBER","0",531],")",["T_WHITESPACE"," ",531],"{",["T_WHITESPACE","\n                    ",531],["T_COMMENT","\/\/ Leaving file pointer open in order to make next generation faster by reusing it.\n",532],["T_WHITESPACE","                    ",533],["T_RETURN","return",533],["T_WHITESPACE"," ",533],["T_VARIABLE","$buffer",533],";",["T_WHITESPACE","\n                ",533],"}",["T_WHITESPACE","\n            ",534],"}",["T_WHITESPACE","\n            ",535],["T_STRING","fclose",536],"(",["T_VARIABLE","$this",536],["T_OBJECT_OPERATOR","->",536],["T_STRING","_randomFile",536],")",";",["T_WHITESPACE","\n            ",536],["T_VARIABLE","$this",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","_randomFile",537],["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],["T_STRING","null",537],";",["T_WHITESPACE","\n        ",537],"}",["T_WHITESPACE","\n\n        ",538],["T_THROW","throw",540],["T_WHITESPACE"," ",540],["T_NEW","new",540],["T_WHITESPACE"," ",540],["T_STRING","Exception",540],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to generate a random key'",540],")",";",["T_WHITESPACE","\n    ",540],"}",["T_WHITESPACE","\n\n    ",541],["T_DOC_COMMENT","\/**\n     * Generates a random string of specified length.\n     * The string generated matches [A-Za-z0-9_-]+ and is transparent to URL-encoding.\n     *\n     * @param int $length the length of the key in characters\n     * @return string the generated random key\n     * @throws Exception on failure.\n     *\/",543],["T_WHITESPACE","\n    ",550],["T_PUBLIC","public",551],["T_WHITESPACE"," ",551],["T_FUNCTION","function",551],["T_WHITESPACE"," ",551],["T_STRING","generateRandomString",551],"(",["T_VARIABLE","$length",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_LNUMBER","32",551],")",["T_WHITESPACE","\n    ",551],"{",["T_WHITESPACE","\n        ",552],["T_IF","if",553],["T_WHITESPACE"," ",553],"(","!",["T_STRING","is_int",553],"(",["T_VARIABLE","$length",553],")",")",["T_WHITESPACE"," ",553],"{",["T_WHITESPACE","\n            ",553],["T_THROW","throw",554],["T_WHITESPACE"," ",554],["T_NEW","new",554],["T_WHITESPACE"," ",554],["T_STRING","InvalidParamException",554],"(",["T_CONSTANT_ENCAPSED_STRING","'First parameter ($length) must be an integer'",554],")",";",["T_WHITESPACE","\n        ",554],"}",["T_WHITESPACE","\n\n        ",555],["T_IF","if",557],["T_WHITESPACE"," ",557],"(",["T_VARIABLE","$length",557],["T_WHITESPACE"," ",557],"<",["T_WHITESPACE"," ",557],["T_LNUMBER","1",557],")",["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n            ",557],["T_THROW","throw",558],["T_WHITESPACE"," ",558],["T_NEW","new",558],["T_WHITESPACE"," ",558],["T_STRING","InvalidParamException",558],"(",["T_CONSTANT_ENCAPSED_STRING","'First parameter ($length) must be greater than 0'",558],")",";",["T_WHITESPACE","\n        ",558],"}",["T_WHITESPACE","\n\n        ",559],["T_VARIABLE","$bytes",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","generateRandomKey",561],"(",["T_VARIABLE","$length",561],")",";",["T_WHITESPACE","\n        ",561],["T_COMMENT","\/\/ '=' character(s) returned by base64_encode() are always discarded because\n",562],["T_WHITESPACE","        ",563],["T_COMMENT","\/\/ they are guaranteed to be after position $length in the base64_encode() output.\n",563],["T_WHITESPACE","        ",564],["T_RETURN","return",564],["T_WHITESPACE"," ",564],["T_STRING","strtr",564],"(",["T_STRING","substr",564],"(",["T_STRING","base64_encode",564],"(",["T_VARIABLE","$bytes",564],")",",",["T_WHITESPACE"," ",564],["T_LNUMBER","0",564],",",["T_WHITESPACE"," ",564],["T_VARIABLE","$length",564],")",",",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","'+\/'",564],",",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","'_-'",564],")",";",["T_WHITESPACE","\n    ",564],"}",["T_WHITESPACE","\n\n    ",565],["T_DOC_COMMENT","\/**\n     * Generates a secure hash from a password and a random salt.\n     *\n     * The generated hash can be stored in database.\n     * Later when a password needs to be validated, the hash can be fetched and passed\n     * to [[validatePassword()]]. For example,\n     *\n     * ```php\n     * \/\/ generates the hash (usually done during user registration or when the password is changed)\n     * $hash = Yii::$app->getSecurity()->generatePasswordHash($password);\n     * \/\/ ...save $hash in database...\n     *\n     * \/\/ during login, validate if the password entered is correct using $hash fetched from database\n     * if (Yii::$app->getSecurity()->validatePassword($password, $hash) {\n     *     \/\/ password is good\n     * } else {\n     *     \/\/ password is bad\n     * }\n     * ```\n     *\n     * @param string $password The password to be hashed.\n     * @param int $cost Cost parameter used by the Blowfish hash algorithm.\n     * The higher the value of cost,\n     * the longer it takes to generate the hash and to verify a password against it. Higher cost\n     * therefore slows down a brute-force attack. For best protection against brute-force attacks,\n     * set it to the highest value that is tolerable on production servers. The time taken to\n     * compute the hash doubles for every increment by one of $cost.\n     * @return string The password hash string. When [[passwordHashStrategy]] is set to 'crypt',\n     * the output is always 60 ASCII characters, when set to 'password_hash' the output length\n     * might increase in future versions of PHP (http:\/\/php.net\/manual\/en\/function.password-hash.php)\n     * @throws Exception on bad password parameter or cost parameter.\n     * @see validatePassword()\n     *\/",567],["T_WHITESPACE","\n    ",599],["T_PUBLIC","public",600],["T_WHITESPACE"," ",600],["T_FUNCTION","function",600],["T_WHITESPACE"," ",600],["T_STRING","generatePasswordHash",600],"(",["T_VARIABLE","$password",600],",",["T_WHITESPACE"," ",600],["T_VARIABLE","$cost",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],["T_STRING","null",600],")",["T_WHITESPACE","\n    ",600],"{",["T_WHITESPACE","\n        ",601],["T_IF","if",602],["T_WHITESPACE"," ",602],"(",["T_VARIABLE","$cost",602],["T_WHITESPACE"," ",602],["T_IS_IDENTICAL","===",602],["T_WHITESPACE"," ",602],["T_STRING","null",602],")",["T_WHITESPACE"," ",602],"{",["T_WHITESPACE","\n            ",602],["T_VARIABLE","$cost",603],["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","passwordHashCost",603],";",["T_WHITESPACE","\n        ",603],"}",["T_WHITESPACE","\n\n        ",604],["T_IF","if",606],["T_WHITESPACE"," ",606],"(",["T_STRING","function_exists",606],"(",["T_CONSTANT_ENCAPSED_STRING","'password_hash'",606],")",")",["T_WHITESPACE"," ",606],"{",["T_WHITESPACE","\n            ",606],["T_DOC_COMMENT","\/** @noinspection PhpUndefinedConstantInspection *\/",607],["T_WHITESPACE","\n            ",607],["T_RETURN","return",608],["T_WHITESPACE"," ",608],["T_STRING","password_hash",608],"(",["T_VARIABLE","$password",608],",",["T_WHITESPACE"," ",608],["T_STRING","PASSWORD_DEFAULT",608],",",["T_WHITESPACE"," ",608],"[",["T_CONSTANT_ENCAPSED_STRING","'cost'",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],["T_VARIABLE","$cost",608],"]",")",";",["T_WHITESPACE","\n        ",608],"}",["T_WHITESPACE","\n\n        ",609],["T_VARIABLE","$salt",611],["T_WHITESPACE"," ",611],"=",["T_WHITESPACE"," ",611],["T_VARIABLE","$this",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","generateSalt",611],"(",["T_VARIABLE","$cost",611],")",";",["T_WHITESPACE","\n        ",611],["T_VARIABLE","$hash",612],["T_WHITESPACE"," ",612],"=",["T_WHITESPACE"," ",612],["T_STRING","crypt",612],"(",["T_VARIABLE","$password",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$salt",612],")",";",["T_WHITESPACE","\n        ",612],["T_COMMENT","\/\/ strlen() is safe since crypt() returns only ascii\n",613],["T_WHITESPACE","        ",614],["T_IF","if",614],["T_WHITESPACE"," ",614],"(","!",["T_STRING","is_string",614],"(",["T_VARIABLE","$hash",614],")",["T_WHITESPACE"," ",614],["T_BOOLEAN_OR","||",614],["T_WHITESPACE"," ",614],["T_STRING","strlen",614],"(",["T_VARIABLE","$hash",614],")",["T_WHITESPACE"," ",614],["T_IS_NOT_IDENTICAL","!==",614],["T_WHITESPACE"," ",614],["T_LNUMBER","60",614],")",["T_WHITESPACE"," ",614],"{",["T_WHITESPACE","\n            ",614],["T_THROW","throw",615],["T_WHITESPACE"," ",615],["T_NEW","new",615],["T_WHITESPACE"," ",615],["T_STRING","Exception",615],"(",["T_CONSTANT_ENCAPSED_STRING","'Unknown error occurred while generating hash.'",615],")",";",["T_WHITESPACE","\n        ",615],"}",["T_WHITESPACE","\n\n        ",616],["T_RETURN","return",618],["T_WHITESPACE"," ",618],["T_VARIABLE","$hash",618],";",["T_WHITESPACE","\n    ",618],"}",["T_WHITESPACE","\n\n    ",619],["T_DOC_COMMENT","\/**\n     * Verifies a password against a hash.\n     * @param string $password The password to verify.\n     * @param string $hash The hash to verify the password against.\n     * @return bool whether the password is correct.\n     * @throws InvalidParamException on bad password\/hash parameters or if crypt() with Blowfish hash is not available.\n     * @see generatePasswordHash()\n     *\/",621],["T_WHITESPACE","\n    ",628],["T_PUBLIC","public",629],["T_WHITESPACE"," ",629],["T_FUNCTION","function",629],["T_WHITESPACE"," ",629],["T_STRING","validatePassword",629],"(",["T_VARIABLE","$password",629],",",["T_WHITESPACE"," ",629],["T_VARIABLE","$hash",629],")",["T_WHITESPACE","\n    ",629],"{",["T_WHITESPACE","\n        ",630],["T_IF","if",631],["T_WHITESPACE"," ",631],"(","!",["T_STRING","is_string",631],"(",["T_VARIABLE","$password",631],")",["T_WHITESPACE"," ",631],["T_BOOLEAN_OR","||",631],["T_WHITESPACE"," ",631],["T_VARIABLE","$password",631],["T_WHITESPACE"," ",631],["T_IS_IDENTICAL","===",631],["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","''",631],")",["T_WHITESPACE"," ",631],"{",["T_WHITESPACE","\n            ",631],["T_THROW","throw",632],["T_WHITESPACE"," ",632],["T_NEW","new",632],["T_WHITESPACE"," ",632],["T_STRING","InvalidParamException",632],"(",["T_CONSTANT_ENCAPSED_STRING","'Password must be a string and cannot be empty.'",632],")",";",["T_WHITESPACE","\n        ",632],"}",["T_WHITESPACE","\n\n        ",633],["T_IF","if",635],["T_WHITESPACE"," ",635],"(","!",["T_STRING","preg_match",635],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^\\$2[axy]\\$(\\d\\d)\\$[\\.\\\/0-9A-Za-z]{22}\/'",635],",",["T_WHITESPACE"," ",635],["T_VARIABLE","$hash",635],",",["T_WHITESPACE"," ",635],["T_VARIABLE","$matches",635],")",["T_WHITESPACE","\n            ",635],["T_BOOLEAN_OR","||",636],["T_WHITESPACE"," ",636],["T_VARIABLE","$matches",636],"[",["T_LNUMBER","1",636],"]",["T_WHITESPACE"," ",636],"<",["T_WHITESPACE"," ",636],["T_LNUMBER","4",636],["T_WHITESPACE","\n            ",636],["T_BOOLEAN_OR","||",637],["T_WHITESPACE"," ",637],["T_VARIABLE","$matches",637],"[",["T_LNUMBER","1",637],"]",["T_WHITESPACE"," ",637],">",["T_WHITESPACE"," ",637],["T_LNUMBER","30",637],["T_WHITESPACE","\n        ",637],")",["T_WHITESPACE"," ",638],"{",["T_WHITESPACE","\n            ",638],["T_THROW","throw",639],["T_WHITESPACE"," ",639],["T_NEW","new",639],["T_WHITESPACE"," ",639],["T_STRING","InvalidParamException",639],"(",["T_CONSTANT_ENCAPSED_STRING","'Hash is invalid.'",639],")",";",["T_WHITESPACE","\n        ",639],"}",["T_WHITESPACE","\n\n        ",640],["T_IF","if",642],["T_WHITESPACE"," ",642],"(",["T_STRING","function_exists",642],"(",["T_CONSTANT_ENCAPSED_STRING","'password_verify'",642],")",")",["T_WHITESPACE"," ",642],"{",["T_WHITESPACE","\n            ",642],["T_RETURN","return",643],["T_WHITESPACE"," ",643],["T_STRING","password_verify",643],"(",["T_VARIABLE","$password",643],",",["T_WHITESPACE"," ",643],["T_VARIABLE","$hash",643],")",";",["T_WHITESPACE","\n        ",643],"}",["T_WHITESPACE","\n\n        ",644],["T_VARIABLE","$test",646],["T_WHITESPACE"," ",646],"=",["T_WHITESPACE"," ",646],["T_STRING","crypt",646],"(",["T_VARIABLE","$password",646],",",["T_WHITESPACE"," ",646],["T_VARIABLE","$hash",646],")",";",["T_WHITESPACE","\n        ",646],["T_VARIABLE","$n",647],["T_WHITESPACE"," ",647],"=",["T_WHITESPACE"," ",647],["T_STRING","strlen",647],"(",["T_VARIABLE","$test",647],")",";",["T_WHITESPACE","\n        ",647],["T_IF","if",648],["T_WHITESPACE"," ",648],"(",["T_VARIABLE","$n",648],["T_WHITESPACE"," ",648],["T_IS_NOT_IDENTICAL","!==",648],["T_WHITESPACE"," ",648],["T_LNUMBER","60",648],")",["T_WHITESPACE"," ",648],"{",["T_WHITESPACE","\n            ",648],["T_RETURN","return",649],["T_WHITESPACE"," ",649],["T_STRING","false",649],";",["T_WHITESPACE","\n        ",649],"}",["T_WHITESPACE","\n\n        ",650],["T_RETURN","return",652],["T_WHITESPACE"," ",652],["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","compareString",652],"(",["T_VARIABLE","$test",652],",",["T_WHITESPACE"," ",652],["T_VARIABLE","$hash",652],")",";",["T_WHITESPACE","\n    ",652],"}",["T_WHITESPACE","\n\n    ",653],["T_DOC_COMMENT","\/**\n     * Generates a salt that can be used to generate a password hash.\n     *\n     * The PHP [crypt()](http:\/\/php.net\/manual\/en\/function.crypt.php) built-in function\n     * requires, for the Blowfish hash algorithm, a salt string in a specific format:\n     * \"$2a$\", \"$2x$\" or \"$2y$\", a two digit cost parameter, \"$\", and 22 characters\n     * from the alphabet \".\/0-9A-Za-z\".\n     *\n     * @param int $cost the cost parameter\n     * @return string the random salt value.\n     * @throws InvalidParamException if the cost parameter is out of the range of 4 to 31.\n     *\/",655],["T_WHITESPACE","\n    ",666],["T_PROTECTED","protected",667],["T_WHITESPACE"," ",667],["T_FUNCTION","function",667],["T_WHITESPACE"," ",667],["T_STRING","generateSalt",667],"(",["T_VARIABLE","$cost",667],["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_LNUMBER","13",667],")",["T_WHITESPACE","\n    ",667],"{",["T_WHITESPACE","\n        ",668],["T_VARIABLE","$cost",669],["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_INT_CAST","(int)",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$cost",669],";",["T_WHITESPACE","\n        ",669],["T_IF","if",670],["T_WHITESPACE"," ",670],"(",["T_VARIABLE","$cost",670],["T_WHITESPACE"," ",670],"<",["T_WHITESPACE"," ",670],["T_LNUMBER","4",670],["T_WHITESPACE"," ",670],["T_BOOLEAN_OR","||",670],["T_WHITESPACE"," ",670],["T_VARIABLE","$cost",670],["T_WHITESPACE"," ",670],">",["T_WHITESPACE"," ",670],["T_LNUMBER","31",670],")",["T_WHITESPACE"," ",670],"{",["T_WHITESPACE","\n            ",670],["T_THROW","throw",671],["T_WHITESPACE"," ",671],["T_NEW","new",671],["T_WHITESPACE"," ",671],["T_STRING","InvalidParamException",671],"(",["T_CONSTANT_ENCAPSED_STRING","'Cost must be between 4 and 31.'",671],")",";",["T_WHITESPACE","\n        ",671],"}",["T_WHITESPACE","\n\n        ",672],["T_COMMENT","\/\/ Get a 20-byte random string\n",674],["T_WHITESPACE","        ",675],["T_VARIABLE","$rand",675],["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","generateRandomKey",675],"(",["T_LNUMBER","20",675],")",";",["T_WHITESPACE","\n        ",675],["T_COMMENT","\/\/ Form the prefix that specifies Blowfish (bcrypt) algorithm and cost parameter.\n",676],["T_WHITESPACE","        ",677],["T_VARIABLE","$salt",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_STRING","sprintf",677],"(",["T_CONSTANT_ENCAPSED_STRING","\"$2y$%02d$\"",677],",",["T_WHITESPACE"," ",677],["T_VARIABLE","$cost",677],")",";",["T_WHITESPACE","\n        ",677],["T_COMMENT","\/\/ Append the random salt data in the required base64 format.\n",678],["T_WHITESPACE","        ",679],["T_VARIABLE","$salt",679],["T_WHITESPACE"," ",679],["T_CONCAT_EQUAL",".=",679],["T_WHITESPACE"," ",679],["T_STRING","str_replace",679],"(",["T_CONSTANT_ENCAPSED_STRING","'+'",679],",",["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'.'",679],",",["T_WHITESPACE"," ",679],["T_STRING","substr",679],"(",["T_STRING","base64_encode",679],"(",["T_VARIABLE","$rand",679],")",",",["T_WHITESPACE"," ",679],["T_LNUMBER","0",679],",",["T_WHITESPACE"," ",679],["T_LNUMBER","22",679],")",")",";",["T_WHITESPACE","\n\n        ",679],["T_RETURN","return",681],["T_WHITESPACE"," ",681],["T_VARIABLE","$salt",681],";",["T_WHITESPACE","\n    ",681],"}",["T_WHITESPACE","\n\n    ",682],["T_DOC_COMMENT","\/**\n     * Performs string comparison using timing attack resistant approach.\n     * @see http:\/\/codereview.stackexchange.com\/questions\/13512\n     * @param string $expected string to compare.\n     * @param string $actual user-supplied string.\n     * @return bool whether strings are equal.\n     *\/",684],["T_WHITESPACE","\n    ",690],["T_PUBLIC","public",691],["T_WHITESPACE"," ",691],["T_FUNCTION","function",691],["T_WHITESPACE"," ",691],["T_STRING","compareString",691],"(",["T_VARIABLE","$expected",691],",",["T_WHITESPACE"," ",691],["T_VARIABLE","$actual",691],")",["T_WHITESPACE","\n    ",691],"{",["T_WHITESPACE","\n        ",692],["T_VARIABLE","$expected",693],["T_WHITESPACE"," ",693],["T_CONCAT_EQUAL",".=",693],["T_WHITESPACE"," ",693],["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",693],";",["T_WHITESPACE","\n        ",693],["T_VARIABLE","$actual",694],["T_WHITESPACE"," ",694],["T_CONCAT_EQUAL",".=",694],["T_WHITESPACE"," ",694],["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",694],";",["T_WHITESPACE","\n        ",694],["T_VARIABLE","$expectedLength",695],["T_WHITESPACE"," ",695],"=",["T_WHITESPACE"," ",695],["T_STRING","StringHelper",695],["T_DOUBLE_COLON","::",695],["T_STRING","byteLength",695],"(",["T_VARIABLE","$expected",695],")",";",["T_WHITESPACE","\n        ",695],["T_VARIABLE","$actualLength",696],["T_WHITESPACE"," ",696],"=",["T_WHITESPACE"," ",696],["T_STRING","StringHelper",696],["T_DOUBLE_COLON","::",696],["T_STRING","byteLength",696],"(",["T_VARIABLE","$actual",696],")",";",["T_WHITESPACE","\n        ",696],["T_VARIABLE","$diff",697],["T_WHITESPACE"," ",697],"=",["T_WHITESPACE"," ",697],["T_VARIABLE","$expectedLength",697],["T_WHITESPACE"," ",697],"-",["T_WHITESPACE"," ",697],["T_VARIABLE","$actualLength",697],";",["T_WHITESPACE","\n        ",697],["T_FOR","for",698],["T_WHITESPACE"," ",698],"(",["T_VARIABLE","$i",698],["T_WHITESPACE"," ",698],"=",["T_WHITESPACE"," ",698],["T_LNUMBER","0",698],";",["T_WHITESPACE"," ",698],["T_VARIABLE","$i",698],["T_WHITESPACE"," ",698],"<",["T_WHITESPACE"," ",698],["T_VARIABLE","$actualLength",698],";",["T_WHITESPACE"," ",698],["T_VARIABLE","$i",698],["T_INC","++",698],")",["T_WHITESPACE"," ",698],"{",["T_WHITESPACE","\n            ",698],["T_VARIABLE","$diff",699],["T_WHITESPACE"," ",699],["T_OR_EQUAL","|=",699],["T_WHITESPACE"," ",699],"(",["T_STRING","ord",699],"(",["T_VARIABLE","$actual",699],"[",["T_VARIABLE","$i",699],"]",")",["T_WHITESPACE"," ",699],"^",["T_WHITESPACE"," ",699],["T_STRING","ord",699],"(",["T_VARIABLE","$expected",699],"[",["T_VARIABLE","$i",699],["T_WHITESPACE"," ",699],"%",["T_WHITESPACE"," ",699],["T_VARIABLE","$expectedLength",699],"]",")",")",";",["T_WHITESPACE","\n        ",699],"}",["T_WHITESPACE","\n        ",700],["T_RETURN","return",701],["T_WHITESPACE"," ",701],["T_VARIABLE","$diff",701],["T_WHITESPACE"," ",701],["T_IS_IDENTICAL","===",701],["T_WHITESPACE"," ",701],["T_LNUMBER","0",701],";",["T_WHITESPACE","\n    ",701],"}",["T_WHITESPACE","\n",702],"}",["T_WHITESPACE","\n",703]]