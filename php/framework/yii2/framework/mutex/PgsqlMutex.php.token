[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * @link http:\/\/www.yiiframework.com\/\n * @copyright Copyright (c) 2008 Yii Software LLC\n * @license http:\/\/www.yiiframework.com\/license\/\n *\/",2],["T_WHITESPACE","\n\n",6],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","yii",8],["T_NS_SEPARATOR","\\",8],["T_STRING","mutex",8],";",["T_WHITESPACE","\n\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Yii",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","yii",11],["T_NS_SEPARATOR","\\",11],["T_STRING","base",11],["T_NS_SEPARATOR","\\",11],["T_STRING","InvalidConfigException",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","yii",12],["T_NS_SEPARATOR","\\",12],["T_STRING","base",12],["T_NS_SEPARATOR","\\",12],["T_STRING","InvalidParamException",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * PgsqlMutex implements mutex \"lock\" mechanism via PgSQL locks.\n *\n * Application configuration example:\n *\n * ```\n * [\n *     'components' => [\n *         'db' => [\n *             'class' => 'yii\\db\\Connection',\n *             'dsn' => 'pgsql:host=127.0.0.1;dbname=demo',\n *         ]\n *         'mutex' => [\n *             'class' => 'yii\\mutex\\PgsqlMutex',\n *         ],\n *     ],\n * ]\n * ```\n *\n * @see Mutex\n *\n * @author nineinchnick <janek.jan@gmail.com>\n * @since 2.0.8\n *\/",14],["T_WHITESPACE","\n",37],["T_CLASS","class",38],["T_WHITESPACE"," ",38],["T_STRING","PgsqlMutex",38],["T_WHITESPACE"," ",38],["T_EXTENDS","extends",38],["T_WHITESPACE"," ",38],["T_STRING","DbMutex",38],["T_WHITESPACE","\n",38],"{",["T_WHITESPACE","\n    ",39],["T_DOC_COMMENT","\/**\n     * Initializes PgSQL specific mutex component implementation.\n     * @throws InvalidConfigException if [[db]] is not PgSQL connection.\n     *\/",40],["T_WHITESPACE","\n    ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","init",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_STRING","parent",46],["T_DOUBLE_COLON","::",46],["T_STRING","init",46],"(",")",";",["T_WHITESPACE","\n        ",46],["T_IF","if",47],["T_WHITESPACE"," ",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","db",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","driverName",47],["T_WHITESPACE"," ",47],["T_IS_NOT_IDENTICAL","!==",47],["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n            ",47],["T_THROW","throw",48],["T_WHITESPACE"," ",48],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_STRING","InvalidConfigException",48],"(",["T_CONSTANT_ENCAPSED_STRING","'In order to use PgsqlMutex connection must be configured to use PgSQL database.'",48],")",";",["T_WHITESPACE","\n        ",48],"}",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Converts a string into two 16 bit integer keys using the SHA1 hash function.\n     * @param string $name\n     * @return array contains two 16 bit integer keys\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PRIVATE","private",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","getKeysFromName",57],"(",["T_VARIABLE","$name",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_STRING","array_values",59],"(",["T_STRING","unpack",59],"(",["T_CONSTANT_ENCAPSED_STRING","'n2'",59],",",["T_WHITESPACE"," ",59],["T_STRING","sha1",59],"(",["T_VARIABLE","$name",59],",",["T_WHITESPACE"," ",59],["T_STRING","true",59],")",")",")",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Acquires lock by given name.\n     * @param string $name of the lock to be acquired.\n     * @param int $timeout to wait for lock to become released.\n     * @return bool acquiring result.\n     * @see http:\/\/www.postgresql.org\/docs\/9.0\/static\/functions-admin.html\n     *\/",62],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","acquireLock",69],"(",["T_VARIABLE","$name",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$timeout",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_LNUMBER","0",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$timeout",71],["T_WHITESPACE"," ",71],["T_IS_NOT_IDENTICAL","!==",71],["T_WHITESPACE"," ",71],["T_LNUMBER","0",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_THROW","throw",72],["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","InvalidParamException",72],"(",["T_CONSTANT_ENCAPSED_STRING","'PgsqlMutex does not support timeout.'",72],")",";",["T_WHITESPACE","\n        ",72],"}",["T_WHITESPACE","\n        ",73],["T_LIST","list",74],"(",["T_VARIABLE","$key1",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$key2",74],")",["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getKeysFromName",74],"(",["T_VARIABLE","$name",74],")",";",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_BOOL_CAST","(bool)",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","db",75],["T_WHITESPACE","\n            ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","createCommand",76],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pg_try_advisory_lock(:key1, :key2)'",76],",",["T_WHITESPACE"," ",76],"[",["T_CONSTANT_ENCAPSED_STRING","':key1'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$key1",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","':key2'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$key2",76],"]",")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","queryScalar",77],"(",")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Releases lock by given name.\n     * @param string $name of the lock to be released.\n     * @return bool release result.\n     * @see http:\/\/www.postgresql.org\/docs\/9.0\/static\/functions-admin.html\n     *\/",80],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","releaseLock",86],"(",["T_VARIABLE","$name",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_LIST","list",88],"(",["T_VARIABLE","$key1",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$key2",88],")",["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getKeysFromName",88],"(",["T_VARIABLE","$name",88],")",";",["T_WHITESPACE","\n        ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_BOOL_CAST","(bool)",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","db",89],["T_WHITESPACE","\n            ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","createCommand",90],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pg_advisory_unlock(:key1, :key2)'",90],",",["T_WHITESPACE"," ",90],"[",["T_CONSTANT_ENCAPSED_STRING","':key1'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$key1",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","':key2'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$key2",90],"]",")",["T_WHITESPACE","\n            ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","queryScalar",91],"(",")",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n",92],"}",["T_WHITESPACE","\n",93]]