[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * @link http:\/\/www.yiiframework.com\/\n * @copyright Copyright (c) 2008 Yii Software LLC\n * @license http:\/\/www.yiiframework.com\/license\/\n *\/",2],["T_WHITESPACE","\n\n",6],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","yii",8],["T_NS_SEPARATOR","\\",8],["T_STRING","validators",8],";",["T_WHITESPACE","\n\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Yii",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","yii",11],["T_NS_SEPARATOR","\\",11],["T_STRING","base",11],["T_NS_SEPARATOR","\\",11],["T_STRING","InvalidConfigException",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","yii",12],["T_NS_SEPARATOR","\\",12],["T_STRING","helpers",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Html",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","yii",13],["T_NS_SEPARATOR","\\",13],["T_STRING","helpers",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Json",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","yii",14],["T_NS_SEPARATOR","\\",14],["T_STRING","web",14],["T_NS_SEPARATOR","\\",14],["T_STRING","JsExpression",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * The validator checks if the attribute value is a valid IPv4\/IPv6 address or subnet.\n *\n * It also may change attribute's value if normalization of IPv6 expansion is enabled.\n *\n * The following are examples of validation rules using this validator:\n *\n * ```php\n * ['ip_address', 'ip'], \/\/ IPv4 or IPv6 address\n * ['ip_address', 'ip', 'ipv6' => false], \/\/ IPv4 address (IPv6 is disabled)\n * ['ip_address', 'ip', 'subnet' => true], \/\/ requires a CIDR prefix (like 10.0.0.1\/24) for the IP address\n * ['ip_address', 'ip', 'subnet' => null], \/\/ CIDR prefix is optional\n * ['ip_address', 'ip', 'subnet' => null, 'normalize' => true], \/\/ CIDR prefix is optional and will be added when missing\n * ['ip_address', 'ip', 'ranges' => ['192.168.0.0\/24']], \/\/ only IP addresses from the specified subnet are allowed\n * ['ip_address', 'ip', 'ranges' => ['!192.168.0.0\/24', 'any']], \/\/ any IP is allowed except IP in the specified subnet\n * ['ip_address', 'ip', 'expandIPv6' => true], \/\/ expands IPv6 address to a full notation format\n * ```\n *\n * @property array $ranges The IPv4 or IPv6 ranges that are allowed or forbidden. See [[setRanges()]] for\n * detailed description.\n *\n * @author Dmitry Naumenko <d.naumenko.a@gmail.com>\n * @since 2.0.7\n *\/",16],["T_WHITESPACE","\n",39],["T_CLASS","class",40],["T_WHITESPACE"," ",40],["T_STRING","IpValidator",40],["T_WHITESPACE"," ",40],["T_EXTENDS","extends",40],["T_WHITESPACE"," ",40],["T_STRING","Validator",40],["T_WHITESPACE","\n",40],"{",["T_WHITESPACE","\n    ",41],["T_DOC_COMMENT","\/**\n     * The length of IPv6 address in bits\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","IPV6_ADDRESS_LENGTH",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_LNUMBER","128",45],";",["T_WHITESPACE","\n    ",45],["T_DOC_COMMENT","\/**\n     * The length of IPv4 address in bits\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","IPV4_ADDRESS_LENGTH",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","32",49],";",["T_WHITESPACE","\n    ",49],["T_DOC_COMMENT","\/**\n     * Negation char. Used to negate [[ranges]] or [[networks]]\n     * or to negate validating value when [[negation]] is set to `true`\n     * @see negation\n     * @see networks\n     * @see ranges\n     *\/",50],["T_WHITESPACE","\n    ",56],["T_CONST","const",57],["T_WHITESPACE"," ",57],["T_STRING","NEGATION_CHAR",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'!'",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @var array The network aliases, that can be used in [[ranges]].\n     *  - key - alias name\n     *  - value - array of strings. String can be an IP range, IP address or another alias. String can be\n     *    negated with [[NEGATION_CHAR]] (independent of `negation` option).\n     *\n     * The following aliases are defined by default:\n     *  - `*`: `any`\n     *  - `any`: `0.0.0.0\/0, ::\/0`\n     *  - `private`: `10.0.0.0\/8, 172.16.0.0\/12, 192.168.0.0\/16, fd00::\/8`\n     *  - `multicast`: `224.0.0.0\/4, ff00::\/8`\n     *  - `linklocal`: `169.254.0.0\/16, fe80::\/10`\n     *  - `localhost`: `127.0.0.0\/8', ::1`\n     *  - `documentation`: `192.0.2.0\/24, 198.51.100.0\/24, 203.0.113.0\/24, 2001:db8::\/32`\n     *  - `system`: `multicast, linklocal, localhost, documentation`\n     *\n     *\/",59],["T_WHITESPACE","\n    ",75],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$networks",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],"[",["T_WHITESPACE","\n        ",76],["T_CONSTANT_ENCAPSED_STRING","'*'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'any'",77],"]",",",["T_WHITESPACE","\n        ",77],["T_CONSTANT_ENCAPSED_STRING","'any'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],"[",["T_CONSTANT_ENCAPSED_STRING","'0.0.0.0\/0'",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'::\/0'",78],"]",",",["T_WHITESPACE","\n        ",78],["T_CONSTANT_ENCAPSED_STRING","'private'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],"[",["T_CONSTANT_ENCAPSED_STRING","'10.0.0.0\/8'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'172.16.0.0\/12'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'192.168.0.0\/16'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'fd00::\/8'",79],"]",",",["T_WHITESPACE","\n        ",79],["T_CONSTANT_ENCAPSED_STRING","'multicast'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],"[",["T_CONSTANT_ENCAPSED_STRING","'224.0.0.0\/4'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'ff00::\/8'",80],"]",",",["T_WHITESPACE","\n        ",80],["T_CONSTANT_ENCAPSED_STRING","'linklocal'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],"[",["T_CONSTANT_ENCAPSED_STRING","'169.254.0.0\/16'",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'fe80::\/10'",81],"]",",",["T_WHITESPACE","\n        ",81],["T_CONSTANT_ENCAPSED_STRING","'localhost'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],"[",["T_CONSTANT_ENCAPSED_STRING","'127.0.0.0\/8'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'::1'",82],"]",",",["T_WHITESPACE","\n        ",82],["T_CONSTANT_ENCAPSED_STRING","'documentation'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],"[",["T_CONSTANT_ENCAPSED_STRING","'192.0.2.0\/24'",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'198.51.100.0\/24'",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'203.0.113.0\/24'",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'2001:db8::\/32'",83],"]",",",["T_WHITESPACE","\n        ",83],["T_CONSTANT_ENCAPSED_STRING","'system'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],"[",["T_CONSTANT_ENCAPSED_STRING","'multicast'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'linklocal'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'localhost'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'documentation'",84],"]",",",["T_WHITESPACE","\n    ",84],"]",";",["T_WHITESPACE","\n    ",85],["T_DOC_COMMENT","\/**\n     * @var bool whether the validating value can be an IPv6 address. Defaults to `true`.\n     *\/",86],["T_WHITESPACE","\n    ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$ipv6",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","true",89],";",["T_WHITESPACE","\n    ",89],["T_DOC_COMMENT","\/**\n     * @var bool whether the validating value can be an IPv4 address. Defaults to `true`.\n     *\/",90],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$ipv4",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","true",93],";",["T_WHITESPACE","\n    ",93],["T_DOC_COMMENT","\/**\n     * @var bool whether the address can be an IP with CIDR subnet, like `192.168.10.0\/24`.\n     * The following values are possible:\n     *\n     * - `false` - the address must not have a subnet (default).\n     * - `true` - specifying a subnet is required.\n     * - `null` - specifying a subnet is optional.\n     *\/",94],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$subnet",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","false",102],";",["T_WHITESPACE","\n    ",102],["T_DOC_COMMENT","\/**\n     * @var bool whether to add the CIDR prefix with the smallest length (32 for IPv4 and 128 for IPv6) to an\n     * address without it. Works only when `subnet` is not `false`. For example:\n     *  - `10.0.1.5` will normalized to `10.0.1.5\/32`\n     *  - `2008:db0::1` will be normalized to `2008:db0::1\/128`\n     *    Defaults to `false`.\n     * @see subnet\n     *\/",103],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$normalize",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","false",111],";",["T_WHITESPACE","\n    ",111],["T_DOC_COMMENT","\/**\n     * @var bool whether address may have a [[NEGATION_CHAR]] character at the beginning.\n     * Defaults to `false`.\n     *\/",112],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$negation",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","false",116],";",["T_WHITESPACE","\n    ",116],["T_DOC_COMMENT","\/**\n     * @var bool whether to expand an IPv6 address to the full notation format.\n     * Defaults to `false`.\n     *\/",117],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$expandIPv6",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","false",121],";",["T_WHITESPACE","\n    ",121],["T_DOC_COMMENT","\/**\n     * @var string Regexp-pattern to validate IPv4 address\n     *\/",122],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$ipv4Pattern",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'\/^(?:(?:2(?:[0-4][0-9]|5[0-5])|[0-1]?[0-9]?[0-9])\\.){3}(?:(?:2([0-4][0-9]|5[0-5])|[0-1]?[0-9]?[0-9]))$\/'",125],";",["T_WHITESPACE","\n    ",125],["T_DOC_COMMENT","\/**\n     * @var string Regexp-pattern to validate IPv6 address\n     *\/",126],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$ipv6Pattern",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'\/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$\/'",129],";",["T_WHITESPACE","\n    ",129],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails due to the wrong IP address format.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     *\/",130],["T_WHITESPACE","\n    ",137],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$message",138],";",["T_WHITESPACE","\n    ",138],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails due to the disabled IPv6 validation.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     *\n     * @see ipv6\n     *\/",139],["T_WHITESPACE","\n    ",148],["T_PUBLIC","public",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$ipv6NotAllowed",149],";",["T_WHITESPACE","\n    ",149],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails due to the disabled IPv4 validation.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     *\n     * @see ipv4\n     *\/",150],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$ipv4NotAllowed",160],";",["T_WHITESPACE","\n    ",160],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails due to the wrong CIDR.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     * @see subnet\n     *\/",161],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$wrongCidr",170],";",["T_WHITESPACE","\n    ",170],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails due to subnet [[subnet]] set to 'only',\n     * but the CIDR prefix is not set.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     *\n     * @see subnet\n     *\/",171],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$noSubnet",182],";",["T_WHITESPACE","\n    ",182],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails\n     * due to [[subnet]] is false, but CIDR prefix is present.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     *\n     * @see subnet\n     *\/",183],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$hasSubnet",194],";",["T_WHITESPACE","\n    ",194],["T_DOC_COMMENT","\/**\n     * @var string user-defined error message is used when validation fails due to IP address\n     * is not not allowed by [[ranges]] check.\n     *\n     * You may use the following placeholders in the message:\n     *\n     * - `{attribute}`: the label of the attribute being validated\n     * - `{value}`: the value of the attribute being validated\n     *\n     * @see ranges\n     *\/",195],["T_WHITESPACE","\n    ",205],["T_PUBLIC","public",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$notInRange",206],";",["T_WHITESPACE","\n\n    ",206],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",208],["T_WHITESPACE","\n    ",210],["T_PRIVATE","private",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$_ranges",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],"[","]",";",["T_WHITESPACE","\n\n\n    ",211],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",214],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","init",217],"(",")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_STRING","parent",219],["T_DOUBLE_COLON","::",219],["T_STRING","init",219],"(",")",";",["T_WHITESPACE","\n\n        ",219],["T_IF","if",221],["T_WHITESPACE"," ",221],"(","!",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","ipv4",221],["T_WHITESPACE"," ",221],["T_BOOLEAN_AND","&&",221],["T_WHITESPACE"," ",221],"!",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","ipv6",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_THROW","throw",222],["T_WHITESPACE"," ",222],["T_NEW","new",222],["T_WHITESPACE"," ",222],["T_STRING","InvalidConfigException",222],"(",["T_CONSTANT_ENCAPSED_STRING","'Both IPv4 and IPv6 checks can not be disabled at the same time'",222],")",";",["T_WHITESPACE","\n        ",222],"}",["T_WHITESPACE","\n\n        ",223],["T_IF","if",225],["T_WHITESPACE"," ",225],"(","!",["T_STRING","defined",225],"(",["T_CONSTANT_ENCAPSED_STRING","'AF_INET6'",225],")",["T_WHITESPACE"," ",225],["T_BOOLEAN_AND","&&",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","ipv6",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_THROW","throw",226],["T_WHITESPACE"," ",226],["T_NEW","new",226],["T_WHITESPACE"," ",226],["T_STRING","InvalidConfigException",226],"(",["T_CONSTANT_ENCAPSED_STRING","'IPv6 validation can not be used. PHP is compiled without IPv6'",226],")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n\n        ",227],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","message",229],["T_WHITESPACE"," ",229],["T_IS_IDENTICAL","===",229],["T_WHITESPACE"," ",229],["T_STRING","null",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n            ",229],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","message",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_STRING","Yii",230],["T_DOUBLE_COLON","::",230],["T_STRING","t",230],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",230],",",["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'{attribute} must be a valid IP address.'",230],")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n        ",231],["T_IF","if",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","ipv6NotAllowed",232],["T_WHITESPACE"," ",232],["T_IS_IDENTICAL","===",232],["T_WHITESPACE"," ",232],["T_STRING","null",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","ipv6NotAllowed",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","Yii",233],["T_DOUBLE_COLON","::",233],["T_STRING","t",233],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",233],",",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'{attribute} must not be an IPv6 address.'",233],")",";",["T_WHITESPACE","\n        ",233],"}",["T_WHITESPACE","\n        ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","ipv4NotAllowed",235],["T_WHITESPACE"," ",235],["T_IS_IDENTICAL","===",235],["T_WHITESPACE"," ",235],["T_STRING","null",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","ipv4NotAllowed",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_STRING","Yii",236],["T_DOUBLE_COLON","::",236],["T_STRING","t",236],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",236],",",["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'{attribute} must not be an IPv4 address.'",236],")",";",["T_WHITESPACE","\n        ",236],"}",["T_WHITESPACE","\n        ",237],["T_IF","if",238],["T_WHITESPACE"," ",238],"(",["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","wrongCidr",238],["T_WHITESPACE"," ",238],["T_IS_IDENTICAL","===",238],["T_WHITESPACE"," ",238],["T_STRING","null",238],")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","wrongCidr",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","Yii",239],["T_DOUBLE_COLON","::",239],["T_STRING","t",239],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",239],",",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'{attribute} contains wrong subnet mask.'",239],")",";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","noSubnet",241],["T_WHITESPACE"," ",241],["T_IS_IDENTICAL","===",241],["T_WHITESPACE"," ",241],["T_STRING","null",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","noSubnet",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","Yii",242],["T_DOUBLE_COLON","::",242],["T_STRING","t",242],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",242],",",["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'{attribute} must be an IP address with specified subnet.'",242],")",";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","hasSubnet",244],["T_WHITESPACE"," ",244],["T_IS_IDENTICAL","===",244],["T_WHITESPACE"," ",244],["T_STRING","null",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","hasSubnet",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","Yii",245],["T_DOUBLE_COLON","::",245],["T_STRING","t",245],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",245],",",["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","'{attribute} must not be a subnet.'",245],")",";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","notInRange",247],["T_WHITESPACE"," ",247],["T_IS_IDENTICAL","===",247],["T_WHITESPACE"," ",247],["T_STRING","null",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","notInRange",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","Yii",248],["T_DOUBLE_COLON","::",248],["T_STRING","t",248],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",248],",",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'{attribute} is not in the allowed range.'",248],")",";",["T_WHITESPACE","\n        ",248],"}",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_DOC_COMMENT","\/**\n     * Set the IPv4 or IPv6 ranges that are allowed or forbidden.\n     *\n     * The following preparation tasks are performed:\n     *\n     * - Recursively substitutes aliases (described in [[networks]]) with their values.\n     * - Removes duplicates\n     *\n     * @property array the IPv4 or IPv6 ranges that are allowed or forbidden.\n     * See [[setRanges()]] for detailed description.\n     * @param array $ranges the IPv4 or IPv6 ranges that are allowed or forbidden.\n     *\n     * When the array is empty, or the option not set, all IP addresses are allowed.\n     *\n     * Otherwise, the rules are checked sequentially until the first match is found.\n     * An IP address is forbidden, when it has not matched any of the rules.\n     *\n     * Example:\n     *\n     * ```php\n     * [\n     *      'ranges' => [\n     *          '192.168.10.128'\n     *          '!192.168.10.0\/24',\n     *          'any' \/\/ allows any other IP addresses\n     *      ]\n     * ]\n     * ```\n     *\n     * In this example, access is allowed for all the IPv4 and IPv6 addresses excluding the `192.168.10.0\/24` subnet.\n     * IPv4 address `192.168.10.128` is also allowed, because it is listed before the restriction.\n     *\/",252],["T_WHITESPACE","\n    ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","setRanges",284],"(",["T_VARIABLE","$ranges",284],")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_ranges",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","prepareRanges",286],"(",["T_ARRAY_CAST","(array)",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$ranges",286],")",";",["T_WHITESPACE","\n    ",286],"}",["T_WHITESPACE","\n\n    ",287],["T_DOC_COMMENT","\/**\n     * @return array The IPv4 or IPv6 ranges that are allowed or forbidden.\n     *\/",289],["T_WHITESPACE","\n    ",291],["T_PUBLIC","public",292],["T_WHITESPACE"," ",292],["T_FUNCTION","function",292],["T_WHITESPACE"," ",292],["T_STRING","getRanges",292],"(",")",["T_WHITESPACE","\n    ",292],"{",["T_WHITESPACE","\n        ",293],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_ranges",294],";",["T_WHITESPACE","\n    ",294],"}",["T_WHITESPACE","\n\n    ",295],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",297],["T_WHITESPACE","\n    ",299],["T_PROTECTED","protected",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","validateValue",300],"(",["T_VARIABLE","$value",300],")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$result",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","validateSubnet",302],"(",["T_VARIABLE","$value",302],")",";",["T_WHITESPACE","\n        ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_STRING","is_array",303],"(",["T_VARIABLE","$result",303],")",")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$result",304],"[",["T_LNUMBER","1",304],"]",["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_STRING","array_merge",304],"(","[",["T_CONSTANT_ENCAPSED_STRING","'ip'",304],["T_WHITESPACE"," ",304],["T_DOUBLE_ARROW","=>",304],["T_WHITESPACE"," ",304],["T_STRING","is_array",304],"(",["T_VARIABLE","$value",304],")",["T_WHITESPACE"," ",304],"?",["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'array()'",304],["T_WHITESPACE"," ",304],":",["T_WHITESPACE"," ",304],["T_VARIABLE","$value",304],"]",",",["T_WHITESPACE"," ",304],["T_VARIABLE","$result",304],"[",["T_LNUMBER","1",304],"]",")",";",["T_WHITESPACE","\n            ",304],["T_RETURN","return",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$result",305],";",["T_WHITESPACE","\n        ",305],"}",["T_WHITESPACE"," ",306],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_STRING","null",307],";",["T_WHITESPACE","\n        ",307],"}",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",311],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","validateAttribute",314],"(",["T_VARIABLE","$model",314],",",["T_WHITESPACE"," ",314],["T_VARIABLE","$attribute",314],")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$value",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$model",316],["T_OBJECT_OPERATOR","->",316],["T_VARIABLE","$attribute",316],";",["T_WHITESPACE","\n\n        ",316],["T_VARIABLE","$result",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","validateSubnet",318],"(",["T_VARIABLE","$value",318],")",";",["T_WHITESPACE","\n        ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_STRING","is_array",319],"(",["T_VARIABLE","$result",319],")",")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n            ",319],["T_VARIABLE","$result",320],"[",["T_LNUMBER","1",320],"]",["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","array_merge",320],"(","[",["T_CONSTANT_ENCAPSED_STRING","'ip'",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_STRING","is_array",320],"(",["T_VARIABLE","$value",320],")",["T_WHITESPACE"," ",320],"?",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'array()'",320],["T_WHITESPACE"," ",320],":",["T_WHITESPACE"," ",320],["T_VARIABLE","$value",320],"]",",",["T_WHITESPACE"," ",320],["T_VARIABLE","$result",320],"[",["T_LNUMBER","1",320],"]",")",";",["T_WHITESPACE","\n            ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","addError",321],"(",["T_VARIABLE","$model",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$attribute",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$result",321],"[",["T_LNUMBER","0",321],"]",",",["T_WHITESPACE"," ",321],["T_VARIABLE","$result",321],"[",["T_LNUMBER","1",321],"]",")",";",["T_WHITESPACE","\n        ",321],"}",["T_WHITESPACE"," ",322],["T_ELSE","else",322],["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$model",323],["T_OBJECT_OPERATOR","->",323],["T_VARIABLE","$attribute",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_VARIABLE","$result",323],";",["T_WHITESPACE","\n        ",323],"}",["T_WHITESPACE","\n    ",324],"}",["T_WHITESPACE","\n\n    ",325],["T_DOC_COMMENT","\/**\n     * Validates an IPv4\/IPv6 address or subnet\n     *\n     * @param $ip string\n     * @return string|array\n     * string - the validation was successful;\n     * array  - an error occurred during the validation.\n     * Array[0] contains the text of an error, array[1] contains values for the placeholders in the error message\n     *\/",327],["T_WHITESPACE","\n    ",335],["T_PRIVATE","private",336],["T_WHITESPACE"," ",336],["T_FUNCTION","function",336],["T_WHITESPACE"," ",336],["T_STRING","validateSubnet",336],"(",["T_VARIABLE","$ip",336],")",["T_WHITESPACE","\n    ",336],"{",["T_WHITESPACE","\n        ",337],["T_IF","if",338],["T_WHITESPACE"," ",338],"(","!",["T_STRING","is_string",338],"(",["T_VARIABLE","$ip",338],")",")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n            ",338],["T_RETURN","return",339],["T_WHITESPACE"," ",339],"[",["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","message",339],",",["T_WHITESPACE"," ",339],"[","]","]",";",["T_WHITESPACE","\n        ",339],"}",["T_WHITESPACE","\n\n        ",340],["T_VARIABLE","$negation",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","null",342],";",["T_WHITESPACE","\n        ",342],["T_VARIABLE","$cidr",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_STRING","null",343],";",["T_WHITESPACE","\n        ",343],["T_VARIABLE","$isCidrDefault",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_STRING","false",344],";",["T_WHITESPACE","\n\n        ",344],["T_IF","if",346],["T_WHITESPACE"," ",346],"(",["T_STRING","preg_match",346],"(",["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getIpParsePattern",346],"(",")",",",["T_WHITESPACE"," ",346],["T_VARIABLE","$ip",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$matches",346],")",")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n            ",346],["T_VARIABLE","$negation",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$matches",347],"[",["T_LNUMBER","1",347],"]",["T_WHITESPACE"," ",347],["T_IS_NOT_IDENTICAL","!==",347],["T_WHITESPACE"," ",347],["T_CONSTANT_ENCAPSED_STRING","''",347],")",["T_WHITESPACE"," ",347],"?",["T_WHITESPACE"," ",347],["T_VARIABLE","$matches",347],"[",["T_LNUMBER","1",347],"]",["T_WHITESPACE"," ",347],":",["T_WHITESPACE"," ",347],["T_STRING","null",347],";",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$ip",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$matches",348],"[",["T_LNUMBER","2",348],"]",";",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$cidr",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_ISSET","isset",349],"(",["T_VARIABLE","$matches",349],"[",["T_LNUMBER","4",349],"]",")",["T_WHITESPACE"," ",349],"?",["T_WHITESPACE"," ",349],["T_VARIABLE","$matches",349],"[",["T_LNUMBER","4",349],"]",["T_WHITESPACE"," ",349],":",["T_WHITESPACE"," ",349],["T_STRING","null",349],";",["T_WHITESPACE","\n        ",349],"}",["T_WHITESPACE","\n\n        ",350],["T_IF","if",352],["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","subnet",352],["T_WHITESPACE"," ",352],["T_IS_IDENTICAL","===",352],["T_WHITESPACE"," ",352],["T_STRING","true",352],["T_WHITESPACE"," ",352],["T_BOOLEAN_AND","&&",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$cidr",352],["T_WHITESPACE"," ",352],["T_IS_IDENTICAL","===",352],["T_WHITESPACE"," ",352],["T_STRING","null",352],")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n            ",352],["T_RETURN","return",353],["T_WHITESPACE"," ",353],"[",["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","noSubnet",353],",",["T_WHITESPACE"," ",353],"[","]","]",";",["T_WHITESPACE","\n        ",353],"}",["T_WHITESPACE","\n        ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","subnet",355],["T_WHITESPACE"," ",355],["T_IS_IDENTICAL","===",355],["T_WHITESPACE"," ",355],["T_STRING","false",355],["T_WHITESPACE"," ",355],["T_BOOLEAN_AND","&&",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$cidr",355],["T_WHITESPACE"," ",355],["T_IS_NOT_IDENTICAL","!==",355],["T_WHITESPACE"," ",355],["T_STRING","null",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_RETURN","return",356],["T_WHITESPACE"," ",356],"[",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","hasSubnet",356],",",["T_WHITESPACE"," ",356],"[","]","]",";",["T_WHITESPACE","\n        ",356],"}",["T_WHITESPACE","\n        ",357],["T_IF","if",358],["T_WHITESPACE"," ",358],"(",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","negation",358],["T_WHITESPACE"," ",358],["T_IS_IDENTICAL","===",358],["T_WHITESPACE"," ",358],["T_STRING","false",358],["T_WHITESPACE"," ",358],["T_BOOLEAN_AND","&&",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$negation",358],["T_WHITESPACE"," ",358],["T_IS_NOT_IDENTICAL","!==",358],["T_WHITESPACE"," ",358],["T_STRING","null",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_RETURN","return",359],["T_WHITESPACE"," ",359],"[",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","message",359],",",["T_WHITESPACE"," ",359],"[","]","]",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n\n        ",360],["T_IF","if",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getIpVersion",362],"(",["T_VARIABLE","$ip",362],")",["T_WHITESPACE"," ",362],["T_IS_EQUAL","==",362],["T_WHITESPACE"," ",362],["T_LNUMBER","6",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_IF","if",363],["T_WHITESPACE"," ",363],"(",["T_VARIABLE","$cidr",363],["T_WHITESPACE"," ",363],["T_IS_NOT_IDENTICAL","!==",363],["T_WHITESPACE"," ",363],["T_STRING","null",363],")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n                ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(",["T_VARIABLE","$cidr",364],["T_WHITESPACE"," ",364],">",["T_WHITESPACE"," ",364],["T_STATIC","static",364],["T_DOUBLE_COLON","::",364],["T_STRING","IPV6_ADDRESS_LENGTH",364],["T_WHITESPACE"," ",364],["T_BOOLEAN_OR","||",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$cidr",364],["T_WHITESPACE"," ",364],"<",["T_WHITESPACE"," ",364],["T_LNUMBER","0",364],")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n                    ",364],["T_RETURN","return",365],["T_WHITESPACE"," ",365],"[",["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","wrongCidr",365],",",["T_WHITESPACE"," ",365],"[","]","]",";",["T_WHITESPACE","\n                ",365],"}",["T_WHITESPACE","\n            ",366],"}",["T_WHITESPACE"," ",367],["T_ELSE","else",367],["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n                ",367],["T_VARIABLE","$isCidrDefault",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_STRING","true",368],";",["T_WHITESPACE","\n                ",368],["T_VARIABLE","$cidr",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_STATIC","static",369],["T_DOUBLE_COLON","::",369],["T_STRING","IPV6_ADDRESS_LENGTH",369],";",["T_WHITESPACE","\n            ",369],"}",["T_WHITESPACE","\n\n            ",370],["T_IF","if",372],["T_WHITESPACE"," ",372],"(","!",["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","validateIPv6",372],"(",["T_VARIABLE","$ip",372],")",")",["T_WHITESPACE"," ",372],"{",["T_WHITESPACE","\n                ",372],["T_RETURN","return",373],["T_WHITESPACE"," ",373],"[",["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","message",373],",",["T_WHITESPACE"," ",373],"[","]","]",";",["T_WHITESPACE","\n            ",373],"}",["T_WHITESPACE","\n            ",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(","!",["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","ipv6",375],")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n                ",375],["T_RETURN","return",376],["T_WHITESPACE"," ",376],"[",["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","ipv6NotAllowed",376],",",["T_WHITESPACE"," ",376],"[","]","]",";",["T_WHITESPACE","\n            ",376],"}",["T_WHITESPACE","\n\n            ",377],["T_IF","if",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","expandIPv6",379],")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n                ",379],["T_VARIABLE","$ip",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","expandIPv6",380],"(",["T_VARIABLE","$ip",380],")",";",["T_WHITESPACE","\n            ",380],"}",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE"," ",382],["T_ELSE","else",382],["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n            ",382],["T_IF","if",383],["T_WHITESPACE"," ",383],"(",["T_VARIABLE","$cidr",383],["T_WHITESPACE"," ",383],["T_IS_NOT_IDENTICAL","!==",383],["T_WHITESPACE"," ",383],["T_STRING","null",383],")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n                ",383],["T_IF","if",384],["T_WHITESPACE"," ",384],"(",["T_VARIABLE","$cidr",384],["T_WHITESPACE"," ",384],">",["T_WHITESPACE"," ",384],["T_STATIC","static",384],["T_DOUBLE_COLON","::",384],["T_STRING","IPV4_ADDRESS_LENGTH",384],["T_WHITESPACE"," ",384],["T_BOOLEAN_OR","||",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$cidr",384],["T_WHITESPACE"," ",384],"<",["T_WHITESPACE"," ",384],["T_LNUMBER","0",384],")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n                    ",384],["T_RETURN","return",385],["T_WHITESPACE"," ",385],"[",["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","wrongCidr",385],",",["T_WHITESPACE"," ",385],"[","]","]",";",["T_WHITESPACE","\n                ",385],"}",["T_WHITESPACE","\n            ",386],"}",["T_WHITESPACE"," ",387],["T_ELSE","else",387],["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n                ",387],["T_VARIABLE","$isCidrDefault",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_STRING","true",388],";",["T_WHITESPACE","\n                ",388],["T_VARIABLE","$cidr",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_STATIC","static",389],["T_DOUBLE_COLON","::",389],["T_STRING","IPV4_ADDRESS_LENGTH",389],";",["T_WHITESPACE","\n            ",389],"}",["T_WHITESPACE","\n            ",390],["T_IF","if",391],["T_WHITESPACE"," ",391],"(","!",["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","validateIPv4",391],"(",["T_VARIABLE","$ip",391],")",")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n                ",391],["T_RETURN","return",392],["T_WHITESPACE"," ",392],"[",["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","message",392],",",["T_WHITESPACE"," ",392],"[","]","]",";",["T_WHITESPACE","\n            ",392],"}",["T_WHITESPACE","\n            ",393],["T_IF","if",394],["T_WHITESPACE"," ",394],"(","!",["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","ipv4",394],")",["T_WHITESPACE"," ",394],"{",["T_WHITESPACE","\n                ",394],["T_RETURN","return",395],["T_WHITESPACE"," ",395],"[",["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","ipv4NotAllowed",395],",",["T_WHITESPACE"," ",395],"[","]","]",";",["T_WHITESPACE","\n            ",395],"}",["T_WHITESPACE","\n        ",396],"}",["T_WHITESPACE","\n\n        ",397],["T_IF","if",399],["T_WHITESPACE"," ",399],"(","!",["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","isAllowed",399],"(",["T_VARIABLE","$ip",399],",",["T_WHITESPACE"," ",399],["T_VARIABLE","$cidr",399],")",")",["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n            ",399],["T_RETURN","return",400],["T_WHITESPACE"," ",400],"[",["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","notInRange",400],",",["T_WHITESPACE"," ",400],"[","]","]",";",["T_WHITESPACE","\n        ",400],"}",["T_WHITESPACE","\n\n        ",401],["T_VARIABLE","$result",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_VARIABLE","$negation",403],["T_WHITESPACE"," ",403],".",["T_WHITESPACE"," ",403],["T_VARIABLE","$ip",403],";",["T_WHITESPACE","\n\n        ",403],["T_IF","if",405],["T_WHITESPACE"," ",405],"(",["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","subnet",405],["T_WHITESPACE"," ",405],["T_IS_NOT_IDENTICAL","!==",405],["T_WHITESPACE"," ",405],["T_STRING","false",405],["T_WHITESPACE"," ",405],["T_BOOLEAN_AND","&&",405],["T_WHITESPACE"," ",405],"(","!",["T_VARIABLE","$isCidrDefault",405],["T_WHITESPACE"," ",405],["T_BOOLEAN_OR","||",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$isCidrDefault",405],["T_WHITESPACE"," ",405],["T_BOOLEAN_AND","&&",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","normalize",405],")",")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n            ",405],["T_VARIABLE","$result",406],["T_WHITESPACE"," ",406],["T_CONCAT_EQUAL",".=",406],["T_WHITESPACE"," ",406],"\"",["T_ENCAPSED_AND_WHITESPACE","\/",406],["T_VARIABLE","$cidr",406],"\"",";",["T_WHITESPACE","\n        ",406],"}",["T_WHITESPACE","\n\n        ",407],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$result",409],";",["T_WHITESPACE","\n    ",409],"}",["T_WHITESPACE","\n\n    ",410],["T_DOC_COMMENT","\/**\n     * Expands an IPv6 address to it's full notation. For example `2001:db8::1` will be\n     * expanded to `2001:0db8:0000:0000:0000:0000:0000:0001`\n     *\n     * @param string $ip the original IPv6\n     * @return string the expanded IPv6\n     *\/",412],["T_WHITESPACE","\n    ",418],["T_PRIVATE","private",419],["T_WHITESPACE"," ",419],["T_FUNCTION","function",419],["T_WHITESPACE"," ",419],["T_STRING","expandIPv6",419],"(",["T_VARIABLE","$ip",419],")",["T_WHITESPACE","\n    ",419],"{",["T_WHITESPACE","\n        ",420],["T_VARIABLE","$hex",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","unpack",421],"(",["T_CONSTANT_ENCAPSED_STRING","'H*hex'",421],",",["T_WHITESPACE"," ",421],["T_STRING","inet_pton",421],"(",["T_VARIABLE","$ip",421],")",")",";",["T_WHITESPACE","\n        ",421],["T_RETURN","return",422],["T_WHITESPACE"," ",422],["T_STRING","substr",422],"(",["T_STRING","preg_replace",422],"(",["T_CONSTANT_ENCAPSED_STRING","'\/([a-f0-9]{4})\/i'",422],",",["T_WHITESPACE"," ",422],["T_CONSTANT_ENCAPSED_STRING","'$1:'",422],",",["T_WHITESPACE"," ",422],["T_VARIABLE","$hex",422],"[",["T_CONSTANT_ENCAPSED_STRING","'hex'",422],"]",")",",",["T_WHITESPACE"," ",422],["T_LNUMBER","0",422],",",["T_WHITESPACE"," ",422],"-",["T_LNUMBER","1",422],")",";",["T_WHITESPACE","\n    ",422],"}",["T_WHITESPACE","\n\n    ",423],["T_DOC_COMMENT","\/**\n     * The method checks whether the IP address with specified CIDR is allowed according to the [[ranges]] list.\n     *\n     * @param string $ip\n     * @param int $cidr\n     * @return bool\n     * @see ranges\n     *\/",425],["T_WHITESPACE","\n    ",432],["T_PRIVATE","private",433],["T_WHITESPACE"," ",433],["T_FUNCTION","function",433],["T_WHITESPACE"," ",433],["T_STRING","isAllowed",433],"(",["T_VARIABLE","$ip",433],",",["T_WHITESPACE"," ",433],["T_VARIABLE","$cidr",433],")",["T_WHITESPACE","\n    ",433],"{",["T_WHITESPACE","\n        ",434],["T_IF","if",435],["T_WHITESPACE"," ",435],"(",["T_EMPTY","empty",435],"(",["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","ranges",435],")",")",["T_WHITESPACE"," ",435],"{",["T_WHITESPACE","\n            ",435],["T_RETURN","return",436],["T_WHITESPACE"," ",436],["T_STRING","true",436],";",["T_WHITESPACE","\n        ",436],"}",["T_WHITESPACE","\n\n        ",437],["T_FOREACH","foreach",439],["T_WHITESPACE"," ",439],"(",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","ranges",439],["T_WHITESPACE"," ",439],["T_AS","as",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$string",439],")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n            ",439],["T_LIST","list",440],"(",["T_VARIABLE","$isNegated",440],",",["T_WHITESPACE"," ",440],["T_VARIABLE","$range",440],")",["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","parseNegatedRange",440],"(",["T_VARIABLE","$string",440],")",";",["T_WHITESPACE","\n            ",440],["T_IF","if",441],["T_WHITESPACE"," ",441],"(",["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","inRange",441],"(",["T_VARIABLE","$ip",441],",",["T_WHITESPACE"," ",441],["T_VARIABLE","$cidr",441],",",["T_WHITESPACE"," ",441],["T_VARIABLE","$range",441],")",")",["T_WHITESPACE"," ",441],"{",["T_WHITESPACE","\n                ",441],["T_RETURN","return",442],["T_WHITESPACE"," ",442],"!",["T_VARIABLE","$isNegated",442],";",["T_WHITESPACE","\n            ",442],"}",["T_WHITESPACE","\n        ",443],"}",["T_WHITESPACE","\n\n        ",444],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_STRING","false",446],";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Parses IP address\/range for the negation with [[NEGATION_CHAR]].\n     *\n     * @param $string\n     * @return array `[0 => bool, 1 => string]`\n     *  - boolean: whether the string is negated\n     *  - string: the string without negation (when the negation were present)\n     *\/",449],["T_WHITESPACE","\n    ",456],["T_PRIVATE","private",457],["T_WHITESPACE"," ",457],["T_FUNCTION","function",457],["T_WHITESPACE"," ",457],["T_STRING","parseNegatedRange",457],"(",["T_VARIABLE","$string",457],")",["T_WHITESPACE","\n    ",457],"{",["T_WHITESPACE","\n        ",458],["T_VARIABLE","$isNegated",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_STRING","strpos",459],"(",["T_VARIABLE","$string",459],",",["T_WHITESPACE"," ",459],["T_STATIC","static",459],["T_DOUBLE_COLON","::",459],["T_STRING","NEGATION_CHAR",459],")",["T_WHITESPACE"," ",459],["T_IS_IDENTICAL","===",459],["T_WHITESPACE"," ",459],["T_LNUMBER","0",459],";",["T_WHITESPACE","\n        ",459],["T_RETURN","return",460],["T_WHITESPACE"," ",460],"[",["T_VARIABLE","$isNegated",460],",",["T_WHITESPACE"," ",460],["T_VARIABLE","$isNegated",460],["T_WHITESPACE"," ",460],"?",["T_WHITESPACE"," ",460],["T_STRING","substr",460],"(",["T_VARIABLE","$string",460],",",["T_WHITESPACE"," ",460],["T_STRING","strlen",460],"(",["T_STATIC","static",460],["T_DOUBLE_COLON","::",460],["T_STRING","NEGATION_CHAR",460],")",")",["T_WHITESPACE"," ",460],":",["T_WHITESPACE"," ",460],["T_VARIABLE","$string",460],"]",";",["T_WHITESPACE","\n    ",460],"}",["T_WHITESPACE","\n\n    ",461],["T_DOC_COMMENT","\/**\n     * Prepares array to fill in [[ranges]]:\n     *  - Recursively substitutes aliases, described in [[networks]] with their values\n     *  - Removes duplicates\n     *\n     *\n     * @param $ranges\n     * @return array\n     * @see networks\n     *\/",463],["T_WHITESPACE","\n    ",472],["T_PRIVATE","private",473],["T_WHITESPACE"," ",473],["T_FUNCTION","function",473],["T_WHITESPACE"," ",473],["T_STRING","prepareRanges",473],"(",["T_VARIABLE","$ranges",473],")",["T_WHITESPACE","\n    ",473],"{",["T_WHITESPACE","\n        ",474],["T_VARIABLE","$result",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],"[","]",";",["T_WHITESPACE","\n        ",475],["T_FOREACH","foreach",476],["T_WHITESPACE"," ",476],"(",["T_VARIABLE","$ranges",476],["T_WHITESPACE"," ",476],["T_AS","as",476],["T_WHITESPACE"," ",476],["T_VARIABLE","$string",476],")",["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n            ",476],["T_LIST","list",477],"(",["T_VARIABLE","$isRangeNegated",477],",",["T_WHITESPACE"," ",477],["T_VARIABLE","$range",477],")",["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","parseNegatedRange",477],"(",["T_VARIABLE","$string",477],")",";",["T_WHITESPACE","\n            ",477],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_ISSET","isset",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","networks",478],"[",["T_VARIABLE","$range",478],"]",")",")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n                ",478],["T_VARIABLE","$replacements",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","prepareRanges",479],"(",["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","networks",479],"[",["T_VARIABLE","$range",479],"]",")",";",["T_WHITESPACE","\n                ",479],["T_FOREACH","foreach",480],["T_WHITESPACE"," ",480],"(",["T_VARIABLE","$replacements",480],["T_WHITESPACE"," ",480],["T_AS","as",480],["T_WHITESPACE"," ",480],"&",["T_VARIABLE","$replacement",480],")",["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n                    ",480],["T_LIST","list",481],"(",["T_VARIABLE","$isReplacementNegated",481],",",["T_WHITESPACE"," ",481],["T_VARIABLE","$replacement",481],")",["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","parseNegatedRange",481],"(",["T_VARIABLE","$replacement",481],")",";",["T_WHITESPACE","\n                    ",481],["T_VARIABLE","$result",482],"[","]",["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],"(",["T_VARIABLE","$isRangeNegated",482],["T_WHITESPACE"," ",482],["T_BOOLEAN_AND","&&",482],["T_WHITESPACE"," ",482],"!",["T_VARIABLE","$isReplacementNegated",482],["T_WHITESPACE"," ",482],"?",["T_WHITESPACE"," ",482],["T_STATIC","static",482],["T_DOUBLE_COLON","::",482],["T_STRING","NEGATION_CHAR",482],["T_WHITESPACE"," ",482],":",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","''",482],")",["T_WHITESPACE"," ",482],".",["T_WHITESPACE"," ",482],["T_VARIABLE","$replacement",482],";",["T_WHITESPACE","\n                ",482],"}",["T_WHITESPACE","\n            ",483],"}",["T_WHITESPACE"," ",484],["T_ELSE","else",484],["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n                ",484],["T_VARIABLE","$result",485],"[","]",["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$string",485],";",["T_WHITESPACE","\n            ",485],"}",["T_WHITESPACE","\n        ",486],"}",["T_WHITESPACE","\n        ",487],["T_RETURN","return",488],["T_WHITESPACE"," ",488],["T_STRING","array_unique",488],"(",["T_VARIABLE","$result",488],")",";",["T_WHITESPACE","\n    ",488],"}",["T_WHITESPACE","\n\n    ",489],["T_DOC_COMMENT","\/**\n     * Validates IPv4 address\n     *\n     * @param string $value\n     * @return bool\n     *\/",491],["T_WHITESPACE","\n    ",496],["T_PROTECTED","protected",497],["T_WHITESPACE"," ",497],["T_FUNCTION","function",497],["T_WHITESPACE"," ",497],["T_STRING","validateIPv4",497],"(",["T_VARIABLE","$value",497],")",["T_WHITESPACE","\n    ",497],"{",["T_WHITESPACE","\n        ",498],["T_RETURN","return",499],["T_WHITESPACE"," ",499],["T_STRING","preg_match",499],"(",["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","ipv4Pattern",499],",",["T_WHITESPACE"," ",499],["T_VARIABLE","$value",499],")",["T_WHITESPACE"," ",499],["T_IS_NOT_IDENTICAL","!==",499],["T_WHITESPACE"," ",499],["T_LNUMBER","0",499],";",["T_WHITESPACE","\n    ",499],"}",["T_WHITESPACE","\n\n    ",500],["T_DOC_COMMENT","\/**\n     * Validates IPv6 address\n     *\n     * @param string $value\n     * @return bool\n     *\/",502],["T_WHITESPACE","\n    ",507],["T_PROTECTED","protected",508],["T_WHITESPACE"," ",508],["T_FUNCTION","function",508],["T_WHITESPACE"," ",508],["T_STRING","validateIPv6",508],"(",["T_VARIABLE","$value",508],")",["T_WHITESPACE","\n    ",508],"{",["T_WHITESPACE","\n        ",509],["T_RETURN","return",510],["T_WHITESPACE"," ",510],["T_STRING","preg_match",510],"(",["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","ipv6Pattern",510],",",["T_WHITESPACE"," ",510],["T_VARIABLE","$value",510],")",["T_WHITESPACE"," ",510],["T_IS_NOT_IDENTICAL","!==",510],["T_WHITESPACE"," ",510],["T_LNUMBER","0",510],";",["T_WHITESPACE","\n    ",510],"}",["T_WHITESPACE","\n\n    ",511],["T_DOC_COMMENT","\/**\n     * Gets the IP version\n     *\n     * @param string $ip\n     * @return int\n     *\/",513],["T_WHITESPACE","\n    ",518],["T_PRIVATE","private",519],["T_WHITESPACE"," ",519],["T_FUNCTION","function",519],["T_WHITESPACE"," ",519],["T_STRING","getIpVersion",519],"(",["T_VARIABLE","$ip",519],")",["T_WHITESPACE","\n    ",519],"{",["T_WHITESPACE","\n        ",520],["T_RETURN","return",521],["T_WHITESPACE"," ",521],["T_STRING","strpos",521],"(",["T_VARIABLE","$ip",521],",",["T_WHITESPACE"," ",521],["T_CONSTANT_ENCAPSED_STRING","':'",521],")",["T_WHITESPACE"," ",521],["T_IS_IDENTICAL","===",521],["T_WHITESPACE"," ",521],["T_STRING","false",521],["T_WHITESPACE"," ",521],"?",["T_WHITESPACE"," ",521],["T_LNUMBER","4",521],["T_WHITESPACE"," ",521],":",["T_WHITESPACE"," ",521],["T_LNUMBER","6",521],";",["T_WHITESPACE","\n    ",521],"}",["T_WHITESPACE","\n\n    ",522],["T_DOC_COMMENT","\/**\n     * Used to get the Regexp pattern for initial IP address parsing\n     * @return string\n     *\/",524],["T_WHITESPACE","\n    ",527],["T_PRIVATE","private",528],["T_WHITESPACE"," ",528],["T_FUNCTION","function",528],["T_WHITESPACE"," ",528],["T_STRING","getIpParsePattern",528],"(",")",["T_WHITESPACE","\n    ",528],"{",["T_WHITESPACE","\n        ",529],["T_RETURN","return",530],["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","'\/^('",530],["T_WHITESPACE"," ",530],".",["T_WHITESPACE"," ",530],["T_STRING","preg_quote",530],"(",["T_STATIC","static",530],["T_DOUBLE_COLON","::",530],["T_STRING","NEGATION_CHAR",530],")",["T_WHITESPACE"," ",530],".",["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","'?)(.+?)(\\\/(\\d+))?$\/'",530],";",["T_WHITESPACE","\n    ",530],"}",["T_WHITESPACE","\n\n    ",531],["T_DOC_COMMENT","\/**\n     * Checks whether the IP is in subnet range\n     *\n     * @param string $ip an IPv4 or IPv6 address\n     * @param int $cidr\n     * @param string $range subnet in CIDR format e.g. `10.0.0.0\/8` or `2001:af::\/64`\n     * @return bool\n     *\/",533],["T_WHITESPACE","\n    ",540],["T_PRIVATE","private",541],["T_WHITESPACE"," ",541],["T_FUNCTION","function",541],["T_WHITESPACE"," ",541],["T_STRING","inRange",541],"(",["T_VARIABLE","$ip",541],",",["T_WHITESPACE"," ",541],["T_VARIABLE","$cidr",541],",",["T_WHITESPACE"," ",541],["T_VARIABLE","$range",541],")",["T_WHITESPACE","\n    ",541],"{",["T_WHITESPACE","\n        ",542],["T_VARIABLE","$ipVersion",543],["T_WHITESPACE"," ",543],"=",["T_WHITESPACE"," ",543],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","getIpVersion",543],"(",["T_VARIABLE","$ip",543],")",";",["T_WHITESPACE","\n        ",543],["T_VARIABLE","$binIp",544],["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","ip2bin",544],"(",["T_VARIABLE","$ip",544],")",";",["T_WHITESPACE","\n\n        ",544],["T_VARIABLE","$parts",546],["T_WHITESPACE"," ",546],"=",["T_WHITESPACE"," ",546],["T_STRING","explode",546],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",546],",",["T_WHITESPACE"," ",546],["T_VARIABLE","$range",546],")",";",["T_WHITESPACE","\n        ",546],["T_VARIABLE","$net",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_STRING","array_shift",547],"(",["T_VARIABLE","$parts",547],")",";",["T_WHITESPACE","\n        ",547],["T_VARIABLE","$range_cidr",548],["T_WHITESPACE"," ",548],"=",["T_WHITESPACE"," ",548],["T_STRING","array_shift",548],"(",["T_VARIABLE","$parts",548],")",";",["T_WHITESPACE","\n\n\n        ",548],["T_VARIABLE","$netVersion",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_VARIABLE","$this",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","getIpVersion",551],"(",["T_VARIABLE","$net",551],")",";",["T_WHITESPACE","\n        ",551],["T_IF","if",552],["T_WHITESPACE"," ",552],"(",["T_VARIABLE","$ipVersion",552],["T_WHITESPACE"," ",552],["T_IS_NOT_IDENTICAL","!==",552],["T_WHITESPACE"," ",552],["T_VARIABLE","$netVersion",552],")",["T_WHITESPACE"," ",552],"{",["T_WHITESPACE","\n            ",552],["T_RETURN","return",553],["T_WHITESPACE"," ",553],["T_STRING","false",553],";",["T_WHITESPACE","\n        ",553],"}",["T_WHITESPACE","\n        ",554],["T_IF","if",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$range_cidr",555],["T_WHITESPACE"," ",555],["T_IS_IDENTICAL","===",555],["T_WHITESPACE"," ",555],["T_STRING","null",555],")",["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n            ",555],["T_VARIABLE","$range_cidr",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_VARIABLE","$netVersion",556],["T_WHITESPACE"," ",556],["T_IS_IDENTICAL","===",556],["T_WHITESPACE"," ",556],["T_LNUMBER","4",556],["T_WHITESPACE"," ",556],"?",["T_WHITESPACE"," ",556],["T_STATIC","static",556],["T_DOUBLE_COLON","::",556],["T_STRING","IPV4_ADDRESS_LENGTH",556],["T_WHITESPACE"," ",556],":",["T_WHITESPACE"," ",556],["T_STATIC","static",556],["T_DOUBLE_COLON","::",556],["T_STRING","IPV6_ADDRESS_LENGTH",556],";",["T_WHITESPACE","\n        ",556],"}",["T_WHITESPACE","\n\n        ",557],["T_VARIABLE","$binNet",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","ip2bin",559],"(",["T_VARIABLE","$net",559],")",";",["T_WHITESPACE","\n        ",559],["T_RETURN","return",560],["T_WHITESPACE"," ",560],["T_STRING","substr",560],"(",["T_VARIABLE","$binIp",560],",",["T_WHITESPACE"," ",560],["T_LNUMBER","0",560],",",["T_WHITESPACE"," ",560],["T_VARIABLE","$range_cidr",560],")",["T_WHITESPACE"," ",560],["T_IS_IDENTICAL","===",560],["T_WHITESPACE"," ",560],["T_STRING","substr",560],"(",["T_VARIABLE","$binNet",560],",",["T_WHITESPACE"," ",560],["T_LNUMBER","0",560],",",["T_WHITESPACE"," ",560],["T_VARIABLE","$range_cidr",560],")",["T_WHITESPACE"," ",560],["T_BOOLEAN_AND","&&",560],["T_WHITESPACE"," ",560],["T_VARIABLE","$cidr",560],["T_WHITESPACE"," ",560],["T_IS_GREATER_OR_EQUAL",">=",560],["T_WHITESPACE"," ",560],["T_VARIABLE","$range_cidr",560],";",["T_WHITESPACE","\n    ",560],"}",["T_WHITESPACE","\n\n    ",561],["T_DOC_COMMENT","\/**\n     * Converts IP address to bits representation\n     *\n     * @param string $ip\n     * @return string bits as a string\n     *\/",563],["T_WHITESPACE","\n    ",568],["T_PRIVATE","private",569],["T_WHITESPACE"," ",569],["T_FUNCTION","function",569],["T_WHITESPACE"," ",569],["T_STRING","ip2bin",569],"(",["T_VARIABLE","$ip",569],")",["T_WHITESPACE","\n    ",569],"{",["T_WHITESPACE","\n        ",570],["T_IF","if",571],["T_WHITESPACE"," ",571],"(",["T_VARIABLE","$this",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","getIpVersion",571],"(",["T_VARIABLE","$ip",571],")",["T_WHITESPACE"," ",571],["T_IS_IDENTICAL","===",571],["T_WHITESPACE"," ",571],["T_LNUMBER","4",571],")",["T_WHITESPACE"," ",571],"{",["T_WHITESPACE","\n            ",571],["T_RETURN","return",572],["T_WHITESPACE"," ",572],["T_STRING","str_pad",572],"(",["T_STRING","base_convert",572],"(",["T_STRING","ip2long",572],"(",["T_VARIABLE","$ip",572],")",",",["T_WHITESPACE"," ",572],["T_LNUMBER","10",572],",",["T_WHITESPACE"," ",572],["T_LNUMBER","2",572],")",",",["T_WHITESPACE"," ",572],["T_STATIC","static",572],["T_DOUBLE_COLON","::",572],["T_STRING","IPV4_ADDRESS_LENGTH",572],",",["T_WHITESPACE"," ",572],["T_CONSTANT_ENCAPSED_STRING","'0'",572],",",["T_WHITESPACE"," ",572],["T_STRING","STR_PAD_LEFT",572],")",";",["T_WHITESPACE","\n        ",572],"}",["T_WHITESPACE"," ",573],["T_ELSE","else",573],["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_VARIABLE","$unpack",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_STRING","unpack",574],"(",["T_CONSTANT_ENCAPSED_STRING","'A16'",574],",",["T_WHITESPACE"," ",574],["T_STRING","inet_pton",574],"(",["T_VARIABLE","$ip",574],")",")",";",["T_WHITESPACE","\n            ",574],["T_VARIABLE","$binStr",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],["T_STRING","array_shift",575],"(",["T_VARIABLE","$unpack",575],")",";",["T_WHITESPACE","\n            ",575],["T_VARIABLE","$bytes",576],["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_STATIC","static",576],["T_DOUBLE_COLON","::",576],["T_STRING","IPV6_ADDRESS_LENGTH",576],["T_WHITESPACE"," ",576],"\/",["T_WHITESPACE"," ",576],["T_LNUMBER","8",576],";",["T_WHITESPACE"," ",576],["T_COMMENT","\/\/ 128 bit \/ 8 = 16 bytes\n",576],["T_WHITESPACE","            ",577],["T_VARIABLE","$result",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_CONSTANT_ENCAPSED_STRING","''",577],";",["T_WHITESPACE","\n            ",577],["T_WHILE","while",578],["T_WHITESPACE"," ",578],"(",["T_VARIABLE","$bytes",578],["T_DEC","--",578],["T_WHITESPACE"," ",578],">",["T_WHITESPACE"," ",578],["T_LNUMBER","0",578],")",["T_WHITESPACE"," ",578],"{",["T_WHITESPACE","\n                ",578],["T_VARIABLE","$result",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_STRING","sprintf",579],"(",["T_CONSTANT_ENCAPSED_STRING","'%08b'",579],",",["T_WHITESPACE"," ",579],["T_ISSET","isset",579],"(",["T_VARIABLE","$binStr",579],"[",["T_VARIABLE","$bytes",579],"]",")",["T_WHITESPACE"," ",579],"?",["T_WHITESPACE"," ",579],["T_STRING","ord",579],"(",["T_VARIABLE","$binStr",579],"[",["T_VARIABLE","$bytes",579],"]",")",["T_WHITESPACE"," ",579],":",["T_WHITESPACE"," ",579],["T_CONSTANT_ENCAPSED_STRING","'0'",579],")",["T_WHITESPACE"," ",579],".",["T_WHITESPACE"," ",579],["T_VARIABLE","$result",579],";",["T_WHITESPACE","\n            ",579],"}",["T_WHITESPACE","\n            ",580],["T_RETURN","return",581],["T_WHITESPACE"," ",581],["T_VARIABLE","$result",581],";",["T_WHITESPACE","\n        ",581],"}",["T_WHITESPACE","\n    ",582],"}",["T_WHITESPACE","\n\n    ",583],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",585],["T_WHITESPACE","\n    ",587],["T_PUBLIC","public",588],["T_WHITESPACE"," ",588],["T_FUNCTION","function",588],["T_WHITESPACE"," ",588],["T_STRING","clientValidateAttribute",588],"(",["T_VARIABLE","$model",588],",",["T_WHITESPACE"," ",588],["T_VARIABLE","$attribute",588],",",["T_WHITESPACE"," ",588],["T_VARIABLE","$view",588],")",["T_WHITESPACE","\n    ",588],"{",["T_WHITESPACE","\n        ",589],["T_STRING","ValidationAsset",590],["T_DOUBLE_COLON","::",590],["T_STRING","register",590],"(",["T_VARIABLE","$view",590],")",";",["T_WHITESPACE","\n        ",590],["T_VARIABLE","$options",591],["T_WHITESPACE"," ",591],"=",["T_WHITESPACE"," ",591],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","getClientOptions",591],"(",["T_VARIABLE","$model",591],",",["T_WHITESPACE"," ",591],["T_VARIABLE","$attribute",591],")",";",["T_WHITESPACE","\n\n        ",591],["T_RETURN","return",593],["T_WHITESPACE"," ",593],["T_CONSTANT_ENCAPSED_STRING","'yii.validation.ip(value, messages, '",593],["T_WHITESPACE"," ",593],".",["T_WHITESPACE"," ",593],["T_STRING","Json",593],["T_DOUBLE_COLON","::",593],["T_STRING","htmlEncode",593],"(",["T_VARIABLE","$options",593],")",["T_WHITESPACE"," ",593],".",["T_WHITESPACE"," ",593],["T_CONSTANT_ENCAPSED_STRING","');'",593],";",["T_WHITESPACE","\n    ",593],"}",["T_WHITESPACE","\n\n    ",594],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",596],["T_WHITESPACE","\n    ",598],["T_PUBLIC","public",599],["T_WHITESPACE"," ",599],["T_FUNCTION","function",599],["T_WHITESPACE"," ",599],["T_STRING","getClientOptions",599],"(",["T_VARIABLE","$model",599],",",["T_WHITESPACE"," ",599],["T_VARIABLE","$attribute",599],")",["T_WHITESPACE","\n    ",599],"{",["T_WHITESPACE","\n        ",600],["T_VARIABLE","$messages",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],"[",["T_WHITESPACE","\n            ",601],["T_CONSTANT_ENCAPSED_STRING","'ipv6NotAllowed'",602],["T_WHITESPACE"," ",602],["T_DOUBLE_ARROW","=>",602],["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","ipv6NotAllowed",602],",",["T_WHITESPACE","\n            ",602],["T_CONSTANT_ENCAPSED_STRING","'ipv4NotAllowed'",603],["T_WHITESPACE"," ",603],["T_DOUBLE_ARROW","=>",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","ipv4NotAllowed",603],",",["T_WHITESPACE","\n            ",603],["T_CONSTANT_ENCAPSED_STRING","'message'",604],["T_WHITESPACE"," ",604],["T_DOUBLE_ARROW","=>",604],["T_WHITESPACE"," ",604],["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","message",604],",",["T_WHITESPACE","\n            ",604],["T_CONSTANT_ENCAPSED_STRING","'noSubnet'",605],["T_WHITESPACE"," ",605],["T_DOUBLE_ARROW","=>",605],["T_WHITESPACE"," ",605],["T_VARIABLE","$this",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","noSubnet",605],",",["T_WHITESPACE","\n            ",605],["T_CONSTANT_ENCAPSED_STRING","'hasSubnet'",606],["T_WHITESPACE"," ",606],["T_DOUBLE_ARROW","=>",606],["T_WHITESPACE"," ",606],["T_VARIABLE","$this",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","hasSubnet",606],",",["T_WHITESPACE","\n        ",606],"]",";",["T_WHITESPACE","\n        ",607],["T_FOREACH","foreach",608],["T_WHITESPACE"," ",608],"(",["T_VARIABLE","$messages",608],["T_WHITESPACE"," ",608],["T_AS","as",608],["T_WHITESPACE"," ",608],"&",["T_VARIABLE","$message",608],")",["T_WHITESPACE"," ",608],"{",["T_WHITESPACE","\n            ",608],["T_VARIABLE","$message",609],["T_WHITESPACE"," ",609],"=",["T_WHITESPACE"," ",609],["T_STRING","Yii",609],["T_DOUBLE_COLON","::",609],["T_VARIABLE","$app",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","getI18n",609],"(",")",["T_OBJECT_OPERATOR","->",609],["T_STRING","format",609],"(",["T_VARIABLE","$message",609],",",["T_WHITESPACE"," ",609],"[",["T_WHITESPACE","\n                ",609],["T_CONSTANT_ENCAPSED_STRING","'attribute'",610],["T_WHITESPACE"," ",610],["T_DOUBLE_ARROW","=>",610],["T_WHITESPACE"," ",610],["T_VARIABLE","$model",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","getAttributeLabel",610],"(",["T_VARIABLE","$attribute",610],")",",",["T_WHITESPACE","\n            ",610],"]",",",["T_WHITESPACE"," ",611],["T_STRING","Yii",611],["T_DOUBLE_COLON","::",611],["T_VARIABLE","$app",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","language",611],")",";",["T_WHITESPACE","\n        ",611],"}",["T_WHITESPACE","\n\n        ",612],["T_VARIABLE","$options",614],["T_WHITESPACE"," ",614],"=",["T_WHITESPACE"," ",614],"[",["T_WHITESPACE","\n            ",614],["T_CONSTANT_ENCAPSED_STRING","'ipv4Pattern'",615],["T_WHITESPACE"," ",615],["T_DOUBLE_ARROW","=>",615],["T_WHITESPACE"," ",615],["T_NEW","new",615],["T_WHITESPACE"," ",615],["T_STRING","JsExpression",615],"(",["T_STRING","Html",615],["T_DOUBLE_COLON","::",615],["T_STRING","escapeJsRegularExpression",615],"(",["T_VARIABLE","$this",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","ipv4Pattern",615],")",")",",",["T_WHITESPACE","\n            ",615],["T_CONSTANT_ENCAPSED_STRING","'ipv6Pattern'",616],["T_WHITESPACE"," ",616],["T_DOUBLE_ARROW","=>",616],["T_WHITESPACE"," ",616],["T_NEW","new",616],["T_WHITESPACE"," ",616],["T_STRING","JsExpression",616],"(",["T_STRING","Html",616],["T_DOUBLE_COLON","::",616],["T_STRING","escapeJsRegularExpression",616],"(",["T_VARIABLE","$this",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","ipv6Pattern",616],")",")",",",["T_WHITESPACE","\n            ",616],["T_CONSTANT_ENCAPSED_STRING","'messages'",617],["T_WHITESPACE"," ",617],["T_DOUBLE_ARROW","=>",617],["T_WHITESPACE"," ",617],["T_VARIABLE","$messages",617],",",["T_WHITESPACE","\n            ",617],["T_CONSTANT_ENCAPSED_STRING","'ipv4'",618],["T_WHITESPACE"," ",618],["T_DOUBLE_ARROW","=>",618],["T_WHITESPACE"," ",618],["T_BOOL_CAST","(bool)",618],["T_WHITESPACE"," ",618],["T_VARIABLE","$this",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","ipv4",618],",",["T_WHITESPACE","\n            ",618],["T_CONSTANT_ENCAPSED_STRING","'ipv6'",619],["T_WHITESPACE"," ",619],["T_DOUBLE_ARROW","=>",619],["T_WHITESPACE"," ",619],["T_BOOL_CAST","(bool)",619],["T_WHITESPACE"," ",619],["T_VARIABLE","$this",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","ipv6",619],",",["T_WHITESPACE","\n            ",619],["T_CONSTANT_ENCAPSED_STRING","'ipParsePattern'",620],["T_WHITESPACE"," ",620],["T_DOUBLE_ARROW","=>",620],["T_WHITESPACE"," ",620],["T_NEW","new",620],["T_WHITESPACE"," ",620],["T_STRING","JsExpression",620],"(",["T_STRING","Html",620],["T_DOUBLE_COLON","::",620],["T_STRING","escapeJsRegularExpression",620],"(",["T_VARIABLE","$this",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","getIpParsePattern",620],"(",")",")",")",",",["T_WHITESPACE","\n            ",620],["T_CONSTANT_ENCAPSED_STRING","'negation'",621],["T_WHITESPACE"," ",621],["T_DOUBLE_ARROW","=>",621],["T_WHITESPACE"," ",621],["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","negation",621],",",["T_WHITESPACE","\n            ",621],["T_CONSTANT_ENCAPSED_STRING","'subnet'",622],["T_WHITESPACE"," ",622],["T_DOUBLE_ARROW","=>",622],["T_WHITESPACE"," ",622],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","subnet",622],",",["T_WHITESPACE","\n        ",622],"]",";",["T_WHITESPACE","\n        ",623],["T_IF","if",624],["T_WHITESPACE"," ",624],"(",["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","skipOnEmpty",624],")",["T_WHITESPACE"," ",624],"{",["T_WHITESPACE","\n            ",624],["T_VARIABLE","$options",625],"[",["T_CONSTANT_ENCAPSED_STRING","'skipOnEmpty'",625],"]",["T_WHITESPACE"," ",625],"=",["T_WHITESPACE"," ",625],["T_LNUMBER","1",625],";",["T_WHITESPACE","\n        ",625],"}",["T_WHITESPACE","\n\n        ",626],["T_RETURN","return",628],["T_WHITESPACE"," ",628],["T_VARIABLE","$options",628],";",["T_WHITESPACE","\n    ",628],"}",["T_WHITESPACE","\n",629],"}",["T_WHITESPACE","\n",630]]