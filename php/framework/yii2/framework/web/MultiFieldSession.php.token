[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * @link http:\/\/www.yiiframework.com\/\n * @copyright Copyright (c) 2008 Yii Software LLC\n * @license http:\/\/www.yiiframework.com\/license\/\n *\/",2],["T_WHITESPACE","\n\n",6],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","yii",8],["T_NS_SEPARATOR","\\",8],["T_STRING","web",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * MultiFieldSession is the base class for session storage implementations with multi-field data storage support.\n *\n * With multi-field data storage, session data can be split between several fields in the storage record.\n * Using such a storage allows saving particular session data into separated field, which then can be used\n * to manipulate sessions in the way plain PHP does not allow.\n *\n * For example the ID of the authenticated user can be saved as separated column in the MySQL 'session' table,\n * which allows to query all active sessions for a particular user or terminate them at will.\n *\n * Customizing of the session writing is performed via [[writeCallback]], reading via [[readCallback]].\n *\n * While extending this class you should use [[composeFields()]] method - while writing the session data into the storage and\n * [[extractData()]] - while reading session data from the storage.\n *\n * @property bool $useCustomStorage Whether to use custom storage. This property is read-only.\n *\n * @author Paul Klimov <klimov.paul@gmail.com>\n * @since 2.0.6\n *\/",10],["T_WHITESPACE","\n",29],["T_ABSTRACT","abstract",30],["T_WHITESPACE"," ",30],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","MultiFieldSession",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Session",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * @var callable a callback that will be called during session data reading.\n     * The signature of the callback should be as follows:\n     *\n     * ```\n     * function ($fields)\n     * ```\n     *\n     * where `$fields` is the storage field set for read session and `$session` is this session instance.\n     * If callback returns an array, it will be merged into the session data.\n     *\n     * For example:\n     *\n     * ```php\n     * function ($fields) {\n     *     return [\n     *         'expireDate' => Yii::$app->formatter->asDate($fields['expire']),\n     *     ];\n     * }\n     * ```\n     *\/",32],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$readCallback",53],";",["T_WHITESPACE","\n    ",53],["T_DOC_COMMENT","\/**\n     * @var callable a callback that will be called during session data writing.\n     * The signature of the callback should be as follows:\n     *\n     * ```\n     * function ($session)\n     * ```\n     *\n     * where `$session` is this session instance, this variable can be used to retrieve session data.\n     * Callback should return the actual fields set, which should be saved into the session storage.\n     *\n     * For example:\n     *\n     * ```php\n     * function ($session) {\n     *     return [\n     *         'user_id' => Yii::$app->user->id,\n     *         'ip' => $_SERVER['REMOTE_ADDR'],\n     *         'is_trusted' => $session->get('is_trusted', false),\n     *     ];\n     * }\n     * ```\n     *\/",54],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$writeCallback",77],";",["T_WHITESPACE","\n\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Returns a value indicating whether to use custom session storage.\n     * This method overrides the parent implementation and always returns true.\n     * @return bool whether to use custom storage.\n     *\/",80],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","getUseCustomStorage",85],"(",")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","true",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Composes storage field set for session writing.\n     * @param string $id session id\n     * @param string $data session data\n     * @return array storage fields\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","composeFields",96],"(",["T_VARIABLE","$id",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$data",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$fields",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],"[",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'data'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$data",99],",",["T_WHITESPACE","\n        ",99],"]",";",["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","writeCallback",101],["T_WHITESPACE"," ",101],["T_IS_NOT_IDENTICAL","!==",101],["T_WHITESPACE"," ",101],["T_STRING","null",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$fields",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","array_merge",102],"(",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$fields",103],",",["T_WHITESPACE","\n                ",103],["T_STRING","call_user_func",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","writeCallback",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],")",["T_WHITESPACE","\n            ",104],")",";",["T_WHITESPACE","\n            ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(","!",["T_STRING","is_string",106],"(",["T_VARIABLE","$fields",106],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",106],"]",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                ",106],["T_VARIABLE","$_SESSION",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$fields",107],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",107],"]",";",["T_WHITESPACE","\n                ",107],["T_VARIABLE","$fields",108],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",108],"]",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","session_encode",108],"(",")",";",["T_WHITESPACE","\n            ",108],"}",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_COMMENT","\/\/ ensure 'id' and 'expire' are never affected by [[writeCallback]]\n",111],["T_WHITESPACE","        ",112],["T_VARIABLE","$fields",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","array_merge",112],"(",["T_VARIABLE","$fields",112],",",["T_WHITESPACE"," ",112],"[",["T_WHITESPACE","\n            ",112],["T_CONSTANT_ENCAPSED_STRING","'id'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$id",113],",",["T_WHITESPACE","\n            ",113],["T_CONSTANT_ENCAPSED_STRING","'expire'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_STRING","time",114],"(",")",["T_WHITESPACE"," ",114],"+",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getTimeout",114],"(",")",",",["T_WHITESPACE","\n        ",114],"]",")",";",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$fields",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Extracts session data from storage field set.\n     * @param array $fields storage fields.\n     * @return string session data.\n     *\/",119],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","extractData",124],"(",["T_VARIABLE","$fields",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","readCallback",126],["T_WHITESPACE"," ",126],["T_IS_NOT_IDENTICAL","!==",126],["T_WHITESPACE"," ",126],["T_STRING","null",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(","!",["T_ISSET","isset",127],"(",["T_VARIABLE","$fields",127],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",127],"]",")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$fields",128],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",128],"]",["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","''",128],";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$extraData",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","call_user_func",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","readCallback",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$fields",130],")",";",["T_WHITESPACE","\n            ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(","!",["T_EMPTY","empty",131],"(",["T_VARIABLE","$extraData",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_STRING","session_decode",132],"(",["T_VARIABLE","$fields",132],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",132],"]",")",";",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$_SESSION",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","array_merge",133],"(",["T_ARRAY_CAST","(array)",133],["T_VARIABLE","$_SESSION",133],",",["T_WHITESPACE"," ",133],["T_ARRAY_CAST","(array)",133],["T_VARIABLE","$extraData",133],")",";",["T_WHITESPACE","\n                ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_STRING","session_encode",134],"(",")",";",["T_WHITESPACE","\n            ",134],"}",["T_WHITESPACE","\n            ",135],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$fields",136],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",136],"]",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE"," ",137],["T_ELSE","else",137],["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_ISSET","isset",138],"(",["T_VARIABLE","$fields",138],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",138],"]",")",["T_WHITESPACE"," ",138],"?",["T_WHITESPACE"," ",138],["T_VARIABLE","$fields",138],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",138],"]",["T_WHITESPACE"," ",138],":",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","''",138],";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n",140],"}",["T_WHITESPACE","\n",141]]