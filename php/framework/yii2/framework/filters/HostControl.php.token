[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * @link http:\/\/www.yiiframework.com\/\n * @copyright Copyright (c) 2008 Yii Software LLC\n * @license http:\/\/www.yiiframework.com\/license\/\n *\/",2],["T_WHITESPACE","\n\n",6],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","yii",8],["T_NS_SEPARATOR","\\",8],["T_STRING","filters",8],";",["T_WHITESPACE","\n\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Yii",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","yii",11],["T_NS_SEPARATOR","\\",11],["T_STRING","base",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ActionFilter",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","yii",12],["T_NS_SEPARATOR","\\",12],["T_STRING","web",12],["T_NS_SEPARATOR","\\",12],["T_STRING","NotFoundHttpException",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * HostControl provides simple control over requested host name.\n *\n * This filter provides protection against ['host header' attacks](https:\/\/www.acunetix.com\/vulnerabilities\/web\/host-header-attack),\n * allowing action execution only for specified host names.\n *\n * Application configuration example:\n *\n * ```php\n * return [\n *     'as hostControl' => [\n *         'class' => 'yii\\filters\\HostControl',\n *         'allowedHosts' => [\n *             'example.com',\n *             '*.example.com',\n *         ],\n *     ],\n *     \/\/ ...\n * ];\n * ```\n *\n * Controller configuration example:\n *\n * ```php\n * use yii\\web\\Controller;\n * use yii\\filters\\HostControl;\n *\n * class SiteController extends Controller\n * {\n *     public function behaviors()\n *     {\n *         return [\n *             'hostControl' => [\n *                 'class' => HostControl::className(),\n *                 'allowedHosts' => [\n *                     'example.com',\n *                     '*.example.com',\n *                 ],\n *             ],\n *         ];\n *     }\n *\n *     \/\/ ...\n * }\n * ```\n *\n * > Note: the best way to restrict allowed host names is usage of the web server 'virtual hosts' configuration.\n * This filter should be used only if this configuration is not available or compromised.\n *\n * @author Paul Klimov <klimov.paul@gmail.com>\n * @since 2.0.11\n *\/",14],["T_WHITESPACE","\n",65],["T_CLASS","class",66],["T_WHITESPACE"," ",66],["T_STRING","HostControl",66],["T_WHITESPACE"," ",66],["T_EXTENDS","extends",66],["T_WHITESPACE"," ",66],["T_STRING","ActionFilter",66],["T_WHITESPACE","\n",66],"{",["T_WHITESPACE","\n    ",67],["T_DOC_COMMENT","\/**\n     * @var array|\\Closure|null list of host names, which are allowed.\n     * Each host can be specified as a wildcard pattern. For example:\n     *\n     * ```php\n     * [\n     *     'example.com',\n     *     '*.example.com',\n     * ]\n     * ```\n     *\n     * This field can be specified as a PHP callback of following signature:\n     *\n     * ```php\n     * function (\\yii\\base\\Action $action) {\n     *     \/\/return array of strings\n     * }\n     * ```\n     *\n     * where `$action` is the current [[\\yii\\base\\Action|action]] object.\n     *\n     * If this field is not set - no host name check will be performed.\n     *\/",68],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$allowedHosts",91],";",["T_WHITESPACE","\n    ",91],["T_DOC_COMMENT","\/**\n     * @var callable a callback that will be called if the current host does not match [[allowedHosts]].\n     * If not set, [[denyAccess()]] will be called.\n     *\n     * The signature of the callback should be as follows:\n     *\n     * ```php\n     * function (\\yii\\base\\Action $action)\n     * ```\n     *\n     * where `$action` is the current [[\\yii\\base\\Action|action]] object.\n     *\n     * > Note: while implementing your own host deny processing, make sure you avoid usage of the current requested\n     * host name, creation of absolute URL links, caching page parts and so on.\n     *\/",92],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$denyCallback",107],";",["T_WHITESPACE","\n    ",107],["T_DOC_COMMENT","\/**\n     * @var string|null fallback host info (e.g. `http:\/\/www.yiiframework.com`) used when [[\\yii\\web\\Request::$hostInfo|Request::$hostInfo]] is invalid.\n     * This value will replace [[\\yii\\web\\Request::$hostInfo|Request::$hostInfo]] before [[$denyCallback]] is called to make sure that\n     * an invalid host will not be used for further processing. You can set it to `null` to leave [[\\yii\\web\\Request::$hostInfo|Request::$hostInfo]] untouched.\n     * Default value is empty string (this will result creating relative URLs instead of absolute).\n     * @see \\yii\\web\\Request::getHostInfo()\n     *\/",108],["T_WHITESPACE","\n    ",114],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$fallbackHostInfo",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","''",115],";",["T_WHITESPACE","\n\n\n    ",115],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",118],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","beforeAction",121],"(",["T_VARIABLE","$action",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$allowedHosts",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","allowedHosts",123],";",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$allowedHosts",124],["T_WHITESPACE"," ",124],["T_INSTANCEOF","instanceof",124],["T_WHITESPACE"," ",124],["T_NS_SEPARATOR","\\",124],["T_STRING","Closure",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$allowedHosts",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","call_user_func",125],"(",["T_VARIABLE","$allowedHosts",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$action",125],")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n        ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$allowedHosts",127],["T_WHITESPACE"," ",127],["T_IS_IDENTICAL","===",127],["T_WHITESPACE"," ",127],["T_STRING","null",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_STRING","true",128],";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_IF","if",131],["T_WHITESPACE"," ",131],"(","!",["T_STRING","is_array",131],"(",["T_VARIABLE","$allowedHosts",131],")",["T_WHITESPACE"," ",131],["T_BOOLEAN_AND","&&",131],["T_WHITESPACE"," ",131],"!",["T_VARIABLE","$allowedHosts",131],["T_WHITESPACE"," ",131],["T_INSTANCEOF","instanceof",131],["T_WHITESPACE"," ",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Traversable",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$allowedHosts",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ARRAY_CAST","(array)",132],["T_VARIABLE","$allowedHosts",132],";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$currentHost",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING","Yii",135],["T_DOUBLE_COLON","::",135],["T_VARIABLE","$app",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getRequest",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","getHostName",135],"(",")",";",["T_WHITESPACE","\n\n        ",135],["T_FOREACH","foreach",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$allowedHosts",137],["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$allowedHost",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_STRING","fnmatch",138],"(",["T_VARIABLE","$allowedHost",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$currentHost",138],")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_STRING","true",139],";",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_COMMENT","\/\/ replace invalid host info to prevent using it in further processing\n",143],["T_WHITESPACE","        ",144],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","fallbackHostInfo",144],["T_WHITESPACE"," ",144],["T_IS_NOT_IDENTICAL","!==",144],["T_WHITESPACE"," ",144],["T_STRING","null",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_STRING","Yii",145],["T_DOUBLE_COLON","::",145],["T_VARIABLE","$app",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getRequest",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","setHostInfo",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","fallbackHostInfo",145],")",";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n\n        ",146],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","denyCallback",148],["T_WHITESPACE"," ",148],["T_IS_NOT_IDENTICAL","!==",148],["T_WHITESPACE"," ",148],["T_STRING","null",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_STRING","call_user_func",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","denyCallback",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$action",149],")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE"," ",150],["T_ELSE","else",150],["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","denyAccess",151],"(",["T_VARIABLE","$action",151],")",";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE","\n\n        ",152],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_STRING","false",154],";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_DOC_COMMENT","\/**\n     * Denies the access.\n     * The default implementation will display 404 page right away, terminating the program execution.\n     * You may override this method, creating your own deny access handler. While doing so, make sure you\n     * avoid usage of the current requested host name, creation of absolute URL links, caching page parts and so on.\n     * @param \\yii\\base\\Action $action the action to be executed.\n     * @throws NotFoundHttpException\n     *\/",157],["T_WHITESPACE","\n    ",164],["T_PROTECTED","protected",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","denyAccess",165],"(",["T_VARIABLE","$action",165],")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$exception",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_NEW","new",167],["T_WHITESPACE"," ",167],["T_STRING","NotFoundHttpException",167],"(",["T_STRING","Yii",167],["T_DOUBLE_COLON","::",167],["T_STRING","t",167],"(",["T_CONSTANT_ENCAPSED_STRING","'yii'",167],",",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'Page not found.'",167],")",")",";",["T_WHITESPACE","\n\n        ",167],["T_COMMENT","\/\/ use regular error handling if $this->fallbackHostInfo was set\n",169],["T_WHITESPACE","        ",170],["T_IF","if",170],["T_WHITESPACE"," ",170],"(","!",["T_EMPTY","empty",170],"(",["T_STRING","Yii",170],["T_DOUBLE_COLON","::",170],["T_VARIABLE","$app",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getRequest",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","hostName",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_THROW","throw",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$exception",171],";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n\n        ",172],["T_VARIABLE","$response",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","Yii",174],["T_DOUBLE_COLON","::",174],["T_VARIABLE","$app",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getResponse",174],"(",")",";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$errorHandler",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","Yii",175],["T_DOUBLE_COLON","::",175],["T_VARIABLE","$app",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getErrorHandler",175],"(",")",";",["T_WHITESPACE","\n\n        ",175],["T_VARIABLE","$response",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","setStatusCode",177],"(",["T_VARIABLE","$exception",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","statusCode",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$exception",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getMessage",177],"(",")",")",";",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$response",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","data",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$errorHandler",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","renderFile",178],"(",["T_VARIABLE","$errorHandler",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","errorView",178],",",["T_WHITESPACE"," ",178],"[",["T_CONSTANT_ENCAPSED_STRING","'exception'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$exception",178],"]",")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$response",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","send",179],"(",")",";",["T_WHITESPACE","\n\n        ",179],["T_STRING","Yii",181],["T_DOUBLE_COLON","::",181],["T_VARIABLE","$app",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","end",181],"(",")",";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n",182],"}",["T_WHITESPACE","\n",183]]