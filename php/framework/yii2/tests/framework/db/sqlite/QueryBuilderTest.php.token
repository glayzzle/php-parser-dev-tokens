[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","yiiunit",3],["T_NS_SEPARATOR","\\",3],["T_STRING","framework",3],["T_NS_SEPARATOR","\\",3],["T_STRING","db",3],["T_NS_SEPARATOR","\\",3],["T_STRING","sqlite",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","yii",5],["T_NS_SEPARATOR","\\",5],["T_STRING","db",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Query",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","yii",6],["T_NS_SEPARATOR","\\",6],["T_STRING","db",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Schema",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","yiiunit",7],["T_NS_SEPARATOR","\\",7],["T_STRING","data",7],["T_NS_SEPARATOR","\\",7],["T_STRING","base",7],["T_NS_SEPARATOR","\\",7],["T_STRING","TraversableObject",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * @group db\n * @group sqlite\n *\/",9],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","QueryBuilderTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","yiiunit",13],["T_NS_SEPARATOR","\\",13],["T_STRING","framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","db",13],["T_NS_SEPARATOR","\\",13],["T_STRING","QueryBuilderTest",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$driverName",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",15],";",["T_WHITESPACE","\n\n    ",15],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_FUNCTION","function",17],["T_WHITESPACE"," ",17],["T_STRING","columnTypes",17],"(",")",["T_WHITESPACE","\n    ",17],"{",["T_WHITESPACE","\n        ",18],["T_RETURN","return",19],["T_WHITESPACE"," ",19],["T_STRING","array_merge",19],"(",["T_STRING","parent",19],["T_DOUBLE_COLON","::",19],["T_STRING","columnTypes",19],"(",")",",",["T_WHITESPACE"," ",19],"[",["T_WHITESPACE","\n            ",19],"[",["T_WHITESPACE","\n                ",20],["T_STRING","Schema",21],["T_DOUBLE_COLON","::",21],["T_STRING","TYPE_PK",21],",",["T_WHITESPACE","\n                ",21],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","primaryKey",22],"(",")",["T_OBJECT_OPERATOR","->",22],["T_STRING","first",22],"(",")",["T_OBJECT_OPERATOR","->",22],["T_STRING","after",22],"(",["T_CONSTANT_ENCAPSED_STRING","'col_before'",22],")",",",["T_WHITESPACE","\n                ",22],["T_CONSTANT_ENCAPSED_STRING","'integer PRIMARY KEY AUTOINCREMENT NOT NULL'",23],["T_WHITESPACE","\n            ",23],"]",",",["T_WHITESPACE","\n        ",24],"]",")",";",["T_WHITESPACE","\n    ",25],"}",["T_WHITESPACE","\n\n    ",26],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","conditionProvider",28],"(",")",["T_WHITESPACE","\n    ",28],"{",["T_WHITESPACE","\n        ",29],["T_RETURN","return",30],["T_WHITESPACE"," ",30],["T_STRING","array_merge",30],"(",["T_STRING","parent",30],["T_DOUBLE_COLON","::",30],["T_STRING","conditionProvider",30],"(",")",",",["T_WHITESPACE"," ",30],"[",["T_WHITESPACE","\n            ",30],["T_CONSTANT_ENCAPSED_STRING","'composite in using array objects'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],"[",["T_WHITESPACE","\n                ",31],"[",["T_CONSTANT_ENCAPSED_STRING","'in'",32],",",["T_WHITESPACE"," ",32],["T_NEW","new",32],["T_WHITESPACE"," ",32],["T_STRING","TraversableObject",32],"(","[",["T_CONSTANT_ENCAPSED_STRING","'id'",32],",",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'name'",32],"]",")",",",["T_WHITESPACE"," ",32],["T_NEW","new",32],["T_WHITESPACE"," ",32],["T_STRING","TraversableObject",32],"(","[",["T_WHITESPACE","\n                    ",32],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_LNUMBER","1",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'name'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'oy'",33],"]",",",["T_WHITESPACE","\n                    ",33],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_LNUMBER","2",34],",",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'name'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'yo'",34],"]",",",["T_WHITESPACE","\n                ",34],"]",")","]",",",["T_WHITESPACE","\n                ",35],["T_CONSTANT_ENCAPSED_STRING","'(([[id]] = :qp0 AND [[name]] = :qp1) OR ([[id]] = :qp2 AND [[name]] = :qp3))'",36],",",["T_WHITESPACE","\n                ",36],"[",["T_CONSTANT_ENCAPSED_STRING","':qp0'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_LNUMBER","1",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","':qp1'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'oy'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","':qp2'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_LNUMBER","2",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","':qp3'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'yo'",37],"]",["T_WHITESPACE","\n            ",37],"]",",",["T_WHITESPACE","\n            ",38],["T_CONSTANT_ENCAPSED_STRING","'composite in'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],"[",["T_WHITESPACE","\n                ",39],"[",["T_CONSTANT_ENCAPSED_STRING","'in'",40],",",["T_WHITESPACE"," ",40],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'name'",40],"]",",",["T_WHITESPACE"," ",40],"[","[",["T_CONSTANT_ENCAPSED_STRING","'id'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_LNUMBER","1",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'name'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'oy'",40],"]","]","]",",",["T_WHITESPACE","\n                ",40],["T_CONSTANT_ENCAPSED_STRING","'(([[id]] = :qp0 AND [[name]] = :qp1))'",41],",",["T_WHITESPACE","\n                ",41],"[",["T_CONSTANT_ENCAPSED_STRING","':qp0'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_LNUMBER","1",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","':qp1'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'oy'",42],"]",["T_WHITESPACE","\n            ",42],"]",",",["T_WHITESPACE","\n        ",43],"]",")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","testAddDropPrimaryKey",47],"(",")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","markTestSkipped",49],"(",["T_CONSTANT_ENCAPSED_STRING","'Comments are not supported in SQLite'",49],")",";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","testCommentColumn",52],"(",")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","markTestSkipped",54],"(",["T_CONSTANT_ENCAPSED_STRING","'Comments are not supported in SQLite'",54],")",";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","testCommentTable",57],"(",")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","markTestSkipped",59],"(",["T_CONSTANT_ENCAPSED_STRING","'Comments are not supported in SQLite'",59],")",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","batchInsertProvider",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$data",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","parent",64],["T_DOUBLE_COLON","::",64],["T_STRING","batchInsertProvider",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$data",65],"[",["T_CONSTANT_ENCAPSED_STRING","'escape-danger-chars'",65],"]","[",["T_CONSTANT_ENCAPSED_STRING","'expected'",65],"]",["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO `customer` (`address`) VALUES ('SQL-danger chars are escaped: ''); --')\"",65],";",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$data",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","testBatchInsertOnOlderVersions",69],"(",")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$db",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getConnection",71],"(",")",";",["T_WHITESPACE","\n        ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_STRING","version_compare",72],"(",["T_VARIABLE","$db",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","pdo",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getAttribute",72],"(",["T_NS_SEPARATOR","\\",72],["T_STRING","PDO",72],["T_DOUBLE_COLON","::",72],["T_STRING","ATTR_SERVER_VERSION",72],")",",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'3.7.11'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'>='",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","markTestSkipped",73],"(",["T_CONSTANT_ENCAPSED_STRING","'This test is only relevant for SQLite < 3.7.11'",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$sql",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getQueryBuilder",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","batchInsert",75],"(",["T_CONSTANT_ENCAPSED_STRING","'{{customer}} t'",75],",",["T_WHITESPACE"," ",75],"[",["T_CONSTANT_ENCAPSED_STRING","'t.id'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'t.name'",75],"]",",",["T_WHITESPACE"," ",75],"[","[",["T_LNUMBER","1",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'a'",75],"]",",",["T_WHITESPACE"," ",75],"[",["T_LNUMBER","2",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'b'",75],"]","]",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertEquals",76],"(",["T_CONSTANT_ENCAPSED_STRING","\"INSERT INTO {{customer}} t (`t`.`id`, `t`.`name`) SELECT 1, 'a' UNION SELECT 2, 'b'\"",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$sql",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","testRenameTable",79],"(",")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$sql",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getQueryBuilder",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","renameTable",81],"(",["T_CONSTANT_ENCAPSED_STRING","'table_from'",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'table_to'",81],")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertEquals",82],"(",["T_CONSTANT_ENCAPSED_STRING","\"ALTER TABLE `table_from` RENAME TO `table_to`\"",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$sql",82],")",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",85],["T_WHITESPACE","\n    ",87],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","testBuildUnion",88],"(",")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$expectedQuerySql",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","replaceQuotes",90],"(",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","\"SELECT `id` FROM `TotalExample` `t1` WHERE (w > 0) AND (x < 2) UNION  SELECT `id` FROM `TotalTotalExample` `t2` WHERE w > 5 UNION ALL  SELECT `id` FROM `TotalTotalExample` `t3` WHERE w = 3\"",91],["T_WHITESPACE","\n        ",91],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$query",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_NEW","new",93],["T_WHITESPACE"," ",93],["T_STRING","Query",93],"(",")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$secondQuery",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","Query",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$secondQuery",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","select",95],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",95],")",["T_WHITESPACE","\n            ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","from",96],"(",["T_CONSTANT_ENCAPSED_STRING","'TotalTotalExample t2'",96],")",["T_WHITESPACE","\n            ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","where",97],"(",["T_CONSTANT_ENCAPSED_STRING","'w > 5'",97],")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$thirdQuery",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_STRING","Query",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$thirdQuery",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","select",99],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",99],")",["T_WHITESPACE","\n            ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","from",100],"(",["T_CONSTANT_ENCAPSED_STRING","'TotalTotalExample t3'",100],")",["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","where",101],"(",["T_CONSTANT_ENCAPSED_STRING","'w = 3'",101],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$query",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","select",102],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",102],")",["T_WHITESPACE","\n            ",102],["T_OBJECT_OPERATOR","->",103],["T_STRING","from",103],"(",["T_CONSTANT_ENCAPSED_STRING","'TotalExample t1'",103],")",["T_WHITESPACE","\n            ",103],["T_OBJECT_OPERATOR","->",104],["T_STRING","where",104],"(","[",["T_CONSTANT_ENCAPSED_STRING","'and'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'w > 0'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'x < 2'",104],"]",")",["T_WHITESPACE","\n            ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","union",105],"(",["T_VARIABLE","$secondQuery",105],")",["T_WHITESPACE","\n            ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","union",106],"(",["T_VARIABLE","$thirdQuery",106],",",["T_WHITESPACE"," ",106],["T_STRING","TRUE",106],")",";",["T_WHITESPACE","\n        ",106],["T_LIST","list",107],"(",["T_VARIABLE","$actualQuerySql",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$queryParams",107],")",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getQueryBuilder",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","build",107],"(",["T_VARIABLE","$query",107],")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertEquals",108],"(",["T_VARIABLE","$expectedQuerySql",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$actualQuerySql",108],")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assertEquals",109],"(","[","]",",",["T_WHITESPACE"," ",109],["T_VARIABLE","$queryParams",109],")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n",110],"}",["T_WHITESPACE","\n",111]]