[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","yiiunit",3],["T_NS_SEPARATOR","\\",3],["T_STRING","framework",3],["T_NS_SEPARATOR","\\",3],["T_STRING","db",3],["T_NS_SEPARATOR","\\",3],["T_STRING","sqlite",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","yii",5],["T_NS_SEPARATOR","\\",5],["T_STRING","db",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Connection",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","yii",6],["T_NS_SEPARATOR","\\",6],["T_STRING","db",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Transaction",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","yiiunit",7],["T_NS_SEPARATOR","\\",7],["T_STRING","data",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ar",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ActiveRecord",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","yiiunit",8],["T_NS_SEPARATOR","\\",8],["T_STRING","data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ar",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Customer",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * @group db\n * @group sqlite\n *\/",10],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","ConnectionTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","yiiunit",14],["T_NS_SEPARATOR","\\",14],["T_STRING","framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","db",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ConnectionTest",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$driverName",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",16],";",["T_WHITESPACE","\n\n    ",16],["T_PUBLIC","public",18],["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","testConstruct",18],"(",")",["T_WHITESPACE","\n    ",18],"{",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$connection",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","getConnection",20],"(",["T_STRING","false",20],")",";",["T_WHITESPACE","\n        ",20],["T_VARIABLE","$params",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_VARIABLE","$this",21],["T_OBJECT_OPERATOR","->",21],["T_STRING","database",21],";",["T_WHITESPACE","\n\n        ",21],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","assertEquals",23],"(",["T_VARIABLE","$params",23],"[",["T_CONSTANT_ENCAPSED_STRING","'dsn'",23],"]",",",["T_WHITESPACE"," ",23],["T_VARIABLE","$connection",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","dsn",23],")",";",["T_WHITESPACE","\n    ",23],"}",["T_WHITESPACE","\n\n    ",24],["T_PUBLIC","public",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","testQuoteValue",26],"(",")",["T_WHITESPACE","\n    ",26],"{",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$connection",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","getConnection",28],"(",["T_STRING","false",28],")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","assertEquals",29],"(",["T_LNUMBER","123",29],",",["T_WHITESPACE"," ",29],["T_VARIABLE","$connection",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","quoteValue",29],"(",["T_LNUMBER","123",29],")",")",";",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","assertEquals",30],"(",["T_CONSTANT_ENCAPSED_STRING","\"'string'\"",30],",",["T_WHITESPACE"," ",30],["T_VARIABLE","$connection",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","quoteValue",30],"(",["T_CONSTANT_ENCAPSED_STRING","'string'",30],")",")",";",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","assertEquals",31],"(",["T_CONSTANT_ENCAPSED_STRING","\"'It''s interesting'\"",31],",",["T_WHITESPACE"," ",31],["T_VARIABLE","$connection",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","quoteValue",31],"(",["T_CONSTANT_ENCAPSED_STRING","\"It's interesting\"",31],")",")",";",["T_WHITESPACE","\n    ",31],"}",["T_WHITESPACE","\n\n    ",32],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","testTransactionIsolation",34],"(",")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$connection",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getConnection",36],"(",["T_STRING","true",36],")",";",["T_WHITESPACE","\n\n        ",36],["T_VARIABLE","$transaction",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$connection",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","beginTransaction",38],"(",["T_STRING","Transaction",38],["T_DOUBLE_COLON","::",38],["T_STRING","READ_UNCOMMITTED",38],")",";",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$transaction",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","rollBack",39],"(",")",";",["T_WHITESPACE","\n\n        ",39],["T_VARIABLE","$transaction",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$connection",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","beginTransaction",41],"(",["T_STRING","Transaction",41],["T_DOUBLE_COLON","::",41],["T_STRING","SERIALIZABLE",41],")",";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$transaction",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","rollBack",42],"(",")",";",["T_WHITESPACE","\n    ",42],"}",["T_WHITESPACE","\n\n    ",43],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testMasterSlave",45],"(",")",["T_WHITESPACE","\n    ",45],"{",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$counts",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],"[","[",["T_LNUMBER","0",47],",",["T_WHITESPACE"," ",47],["T_LNUMBER","2",47],"]",",",["T_WHITESPACE"," ",47],"[",["T_LNUMBER","1",47],",",["T_WHITESPACE"," ",47],["T_LNUMBER","2",47],"]",",",["T_WHITESPACE"," ",47],"[",["T_LNUMBER","2",47],",",["T_WHITESPACE"," ",47],["T_LNUMBER","2",47],"]","]",";",["T_WHITESPACE","\n\n        ",47],["T_FOREACH","foreach",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$counts",49],["T_WHITESPACE"," ",49],["T_AS","as",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$count",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n            ",49],["T_LIST","list",50],"(",["T_VARIABLE","$masterCount",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$slaveCount",50],")",["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$count",50],";",["T_WHITESPACE","\n\n            ",50],["T_VARIABLE","$db",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","prepareMasterSlave",52],"(",["T_VARIABLE","$masterCount",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$slaveCount",52],")",";",["T_WHITESPACE","\n\n            ",52],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertTrue",54],"(",["T_VARIABLE","$db",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getSlave",54],"(",")",["T_WHITESPACE"," ",54],["T_INSTANCEOF","instanceof",54],["T_WHITESPACE"," ",54],["T_STRING","Connection",54],")",";",["T_WHITESPACE","\n            ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","assertTrue",55],"(",["T_VARIABLE","$db",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getSlave",55],"(",")",["T_OBJECT_OPERATOR","->",55],["T_STRING","isActive",55],")",";",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertFalse",56],"(",["T_VARIABLE","$db",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","isActive",56],")",";",["T_WHITESPACE","\n\n            ",56],["T_COMMENT","\/\/ test SELECT uses slave\n",58],["T_WHITESPACE","            ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","assertEquals",59],"(",["T_LNUMBER","2",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$db",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","createCommand",59],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT COUNT(*) FROM profile'",59],")",["T_OBJECT_OPERATOR","->",59],["T_STRING","queryScalar",59],"(",")",")",";",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","assertFalse",60],"(",["T_VARIABLE","$db",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","isActive",60],")",";",["T_WHITESPACE","\n\n            ",60],["T_COMMENT","\/\/ test UPDATE uses master\n",62],["T_WHITESPACE","            ",63],["T_VARIABLE","$db",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","createCommand",63],"(",["T_CONSTANT_ENCAPSED_STRING","\"UPDATE profile SET description='test' WHERE id=1\"",63],")",["T_OBJECT_OPERATOR","->",63],["T_STRING","execute",63],"(",")",";",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertTrue",64],"(",["T_VARIABLE","$db",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","isActive",64],")",";",["T_WHITESPACE","\n            ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$masterCount",65],["T_WHITESPACE"," ",65],">",["T_WHITESPACE"," ",65],["T_LNUMBER","0",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertTrue",66],"(",["T_VARIABLE","$db",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMaster",66],"(",")",["T_WHITESPACE"," ",66],["T_INSTANCEOF","instanceof",66],["T_WHITESPACE"," ",66],["T_STRING","Connection",66],")",";",["T_WHITESPACE","\n                ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertTrue",67],"(",["T_VARIABLE","$db",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getMaster",67],"(",")",["T_OBJECT_OPERATOR","->",67],["T_STRING","isActive",67],")",";",["T_WHITESPACE","\n            ",67],"}",["T_WHITESPACE"," ",68],["T_ELSE","else",68],["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n                ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertNull",69],"(",["T_VARIABLE","$db",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getMaster",69],"(",")",")",";",["T_WHITESPACE","\n            ",69],"}",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertNotEquals",71],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$db",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","createCommand",71],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT description FROM profile WHERE id=1\"",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","queryScalar",71],"(",")",")",";",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$result",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$db",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","useMaster",72],"(",["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],"(",["T_STRING","Connection",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$db",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$db",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","createCommand",73],"(",["T_CONSTANT_ENCAPSED_STRING","\"SELECT description FROM profile WHERE id=1\"",73],")",["T_OBJECT_OPERATOR","->",73],["T_STRING","queryScalar",73],"(",")",";",["T_WHITESPACE","\n            ",73],"}",")",";",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertEquals",75],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$result",75],")",";",["T_WHITESPACE","\n\n            ",75],["T_COMMENT","\/\/ test ActiveRecord read\/write split\n",77],["T_WHITESPACE","            ",78],["T_STRING","ActiveRecord",78],["T_DOUBLE_COLON","::",78],["T_VARIABLE","$db",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$db",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","prepareMasterSlave",78],"(",["T_VARIABLE","$masterCount",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$slaveCount",78],")",";",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertFalse",79],"(",["T_VARIABLE","$db",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","isActive",79],")",";",["T_WHITESPACE","\n\n            ",79],["T_VARIABLE","$customer",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","Customer",81],["T_DOUBLE_COLON","::",81],["T_STRING","findOne",81],"(",["T_LNUMBER","1",81],")",";",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertTrue",82],"(",["T_VARIABLE","$customer",82],["T_WHITESPACE"," ",82],["T_INSTANCEOF","instanceof",82],["T_WHITESPACE"," ",82],["T_STRING","Customer",82],")",";",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertEquals",83],"(",["T_CONSTANT_ENCAPSED_STRING","'user1'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$customer",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","name",83],")",";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertFalse",84],"(",["T_VARIABLE","$db",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","isActive",84],")",";",["T_WHITESPACE","\n\n            ",84],["T_VARIABLE","$customer",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","name",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'test'",86],";",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$customer",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","save",87],"(",")",";",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertTrue",88],"(",["T_VARIABLE","$db",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","isActive",88],")",";",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$customer",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","Customer",89],["T_DOUBLE_COLON","::",89],["T_STRING","findOne",89],"(",["T_LNUMBER","1",89],")",";",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","assertTrue",90],"(",["T_VARIABLE","$customer",90],["T_WHITESPACE"," ",90],["T_INSTANCEOF","instanceof",90],["T_WHITESPACE"," ",90],["T_STRING","Customer",90],")",";",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","assertEquals",91],"(",["T_CONSTANT_ENCAPSED_STRING","'user1'",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$customer",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","name",91],")",";",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$result",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$db",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","useMaster",92],"(",["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],"(",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_STRING","Customer",93],["T_DOUBLE_COLON","::",93],["T_STRING","findOne",93],"(",["T_LNUMBER","1",93],")",["T_OBJECT_OPERATOR","->",93],["T_STRING","name",93],";",["T_WHITESPACE","\n            ",93],"}",")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertEquals",95],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$result",95],")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","testMastersShuffled",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$mastersCount",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_LNUMBER","2",101],";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$slavesCount",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_LNUMBER","2",102],";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$retryPerNode",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_LNUMBER","10",103],";",["T_WHITESPACE","\n\n        ",103],["T_VARIABLE","$nodesCount",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$mastersCount",105],["T_WHITESPACE"," ",105],"+",["T_WHITESPACE"," ",105],["T_VARIABLE","$slavesCount",105],";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$hit_slaves",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$hit_masters",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],"[","]",";",["T_WHITESPACE","\n\n        ",107],["T_FOR","for",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$i",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$nodesCount",109],["T_WHITESPACE"," ",109],"*",["T_WHITESPACE"," ",109],["T_VARIABLE","$retryPerNode",109],";",["T_WHITESPACE"," ",109],["T_VARIABLE","$i",109],["T_DEC","--",109],["T_WHITESPACE"," ",109],">",["T_WHITESPACE"," ",109],["T_LNUMBER","0",109],";",["T_WHITESPACE"," ",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$db",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","prepareMasterSlave",110],"(",["T_VARIABLE","$mastersCount",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$slavesCount",110],")",";",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$db",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","shuffleMasters",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","true",111],";",["T_WHITESPACE","\n\n            ",111],["T_VARIABLE","$hit_slaves",113],"[",["T_VARIABLE","$db",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getSlave",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","dsn",113],"]",["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","true",113],";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$hit_masters",114],"[",["T_VARIABLE","$db",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getMaster",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","dsn",114],"]",["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","true",114],";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","assertEquals",117],"(",["T_VARIABLE","$mastersCount",117],",",["T_WHITESPACE"," ",117],["T_STRING","count",117],"(",["T_VARIABLE","$hit_masters",117],")",",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'all masters hit'",117],")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","assertEquals",118],"(",["T_VARIABLE","$slavesCount",118],",",["T_WHITESPACE"," ",118],["T_STRING","count",118],"(",["T_VARIABLE","$hit_slaves",118],")",",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'all slaves hit'",118],")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","testMastersSequential",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$mastersCount",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_LNUMBER","2",123],";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$slavesCount",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_LNUMBER","2",124],";",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$retryPerNode",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_LNUMBER","10",125],";",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$nodesCount",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$mastersCount",127],["T_WHITESPACE"," ",127],"+",["T_WHITESPACE"," ",127],["T_VARIABLE","$slavesCount",127],";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$hit_slaves",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$hit_masters",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],"[","]",";",["T_WHITESPACE","\n\n        ",129],["T_FOR","for",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$i",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$nodesCount",131],["T_WHITESPACE"," ",131],"*",["T_WHITESPACE"," ",131],["T_VARIABLE","$retryPerNode",131],";",["T_WHITESPACE"," ",131],["T_VARIABLE","$i",131],["T_DEC","--",131],["T_WHITESPACE"," ",131],">",["T_WHITESPACE"," ",131],["T_LNUMBER","0",131],";",["T_WHITESPACE"," ",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$db",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","prepareMasterSlave",132],"(",["T_VARIABLE","$mastersCount",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$slavesCount",132],")",";",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$db",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","shuffleMasters",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","false",133],";",["T_WHITESPACE","\n\n            ",133],["T_VARIABLE","$hit_slaves",135],"[",["T_VARIABLE","$db",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getSlave",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","dsn",135],"]",["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING","true",135],";",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$hit_masters",136],"[",["T_VARIABLE","$db",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getMaster",136],"(",")",["T_OBJECT_OPERATOR","->",136],["T_STRING","dsn",136],"]",["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","true",136],";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n\n        ",137],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertEquals",139],"(",["T_LNUMBER","1",139],",",["T_WHITESPACE"," ",139],["T_STRING","count",139],"(",["T_VARIABLE","$hit_masters",139],")",",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'same master hit'",139],")",";",["T_WHITESPACE","\n        ",139],["T_COMMENT","\/\/ slaves are always random\n",140],["T_WHITESPACE","        ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","assertEquals",141],"(",["T_VARIABLE","$slavesCount",141],",",["T_WHITESPACE"," ",141],["T_STRING","count",141],"(",["T_VARIABLE","$hit_slaves",141],")",",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'all slaves hit'",141],")",";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * @param int $masterCount\n     * @param int $slaveCount\n     * @return Connection\n     *\/",144],["T_WHITESPACE","\n    ",148],["T_PROTECTED","protected",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","prepareMasterSlave",149],"(",["T_VARIABLE","$masterCount",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$slaveCount",149],")",["T_WHITESPACE","\n    ",149],"{",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$databases",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_STRING","getParam",151],"(",["T_CONSTANT_ENCAPSED_STRING","'databases'",151],")",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$fixture",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$databases",152],"[",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","driverName",152],"]","[",["T_CONSTANT_ENCAPSED_STRING","'fixture'",152],"]",";",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$basePath",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_NS_SEPARATOR","\\",153],["T_STRING","Yii",153],["T_DOUBLE_COLON","::",153],["T_STRING","getAlias",153],"(",["T_CONSTANT_ENCAPSED_STRING","'@yiiunit\/runtime'",153],")",";",["T_WHITESPACE","\n\n        ",153],["T_VARIABLE","$config",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],"[",["T_WHITESPACE","\n            ",155],["T_CONSTANT_ENCAPSED_STRING","'class'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'yii\\db\\Connection'",156],",",["T_WHITESPACE","\n            ",156],["T_CONSTANT_ENCAPSED_STRING","'dsn'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],"\"",["T_ENCAPSED_AND_WHITESPACE","sqlite:",157],["T_VARIABLE","$basePath",157],["T_ENCAPSED_AND_WHITESPACE","\/yii2test.sq3",157],"\"",",",["T_WHITESPACE","\n        ",157],"]",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","prepareDatabase",159],"(",["T_VARIABLE","$config",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$fixture",159],")",["T_OBJECT_OPERATOR","->",159],["T_STRING","close",159],"(",")",";",["T_WHITESPACE","\n\n        ",159],["T_FOR","for",161],["T_WHITESPACE"," ",161],"(",["T_VARIABLE","$i",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_LNUMBER","0",161],";",["T_WHITESPACE"," ",161],["T_VARIABLE","$i",161],["T_WHITESPACE"," ",161],"<",["T_WHITESPACE"," ",161],["T_VARIABLE","$masterCount",161],";",["T_WHITESPACE"," ",161],["T_INC","++",161],["T_VARIABLE","$i",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$master",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],"[",["T_CONSTANT_ENCAPSED_STRING","'dsn'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],"\"",["T_ENCAPSED_AND_WHITESPACE","sqlite:",162],["T_VARIABLE","$basePath",162],["T_ENCAPSED_AND_WHITESPACE","\/yii2test_master",162],["T_CURLY_OPEN","{",162],["T_VARIABLE","$i",162],"}",["T_ENCAPSED_AND_WHITESPACE",".sq3",162],"\"","]",";",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$db",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","prepareDatabase",163],"(",["T_VARIABLE","$master",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$fixture",163],")",";",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$db",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","close",164],"(",")",";",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$config",165],"[",["T_CONSTANT_ENCAPSED_STRING","'masters'",165],"]","[","]",["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$master",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_FOR","for",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$i",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_LNUMBER","0",168],";",["T_WHITESPACE"," ",168],["T_VARIABLE","$i",168],["T_WHITESPACE"," ",168],"<",["T_WHITESPACE"," ",168],["T_VARIABLE","$slaveCount",168],";",["T_WHITESPACE"," ",168],["T_INC","++",168],["T_VARIABLE","$i",168],")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$slave",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],"[",["T_CONSTANT_ENCAPSED_STRING","'dsn'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],"\"",["T_ENCAPSED_AND_WHITESPACE","sqlite:",169],["T_VARIABLE","$basePath",169],["T_ENCAPSED_AND_WHITESPACE","\/yii2test_slave",169],["T_CURLY_OPEN","{",169],["T_VARIABLE","$i",169],"}",["T_ENCAPSED_AND_WHITESPACE",".sq3",169],"\"","]",";",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$db",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","prepareDatabase",170],"(",["T_VARIABLE","$slave",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$fixture",170],")",";",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$db",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","close",171],"(",")",";",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$config",172],"[",["T_CONSTANT_ENCAPSED_STRING","'slaves'",172],"]","[","]",["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$slave",172],";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n\n        ",173],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Yii",175],["T_DOUBLE_COLON","::",175],["T_STRING","createObject",175],"(",["T_VARIABLE","$config",175],")",";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","testAliasDbPath",178],"(",")",["T_WHITESPACE","\n    ",178],"{",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$config",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],"[",["T_WHITESPACE","\n            ",180],["T_CONSTANT_ENCAPSED_STRING","'dsn'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","\"sqlite:@yiiunit\/runtime\/yii2aliastest.sq3\"",181],",",["T_WHITESPACE","\n        ",181],"]",";",["T_WHITESPACE","\n        ",182],["T_VARIABLE","$connection",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_NEW","new",183],["T_WHITESPACE"," ",183],["T_STRING","Connection",183],"(",["T_VARIABLE","$config",183],")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$connection",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","open",184],"(",")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","assertTrue",185],"(",["T_VARIABLE","$connection",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","isActive",185],")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","assertEquals",186],"(",["T_VARIABLE","$config",186],"[",["T_CONSTANT_ENCAPSED_STRING","'dsn'",186],"]",",",["T_WHITESPACE"," ",186],["T_VARIABLE","$connection",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","dsn",186],")",";",["T_WHITESPACE","\n\n        ",186],["T_VARIABLE","$connection",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","close",188],"(",")",";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n",189],"}",["T_WHITESPACE","\n",190]]