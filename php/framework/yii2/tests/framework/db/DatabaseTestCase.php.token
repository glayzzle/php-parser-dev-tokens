[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","yiiunit",3],["T_NS_SEPARATOR","\\",3],["T_STRING","framework",3],["T_NS_SEPARATOR","\\",3],["T_STRING","db",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","yii",5],["T_NS_SEPARATOR","\\",5],["T_STRING","db",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Connection",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","yiiunit",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TestCase",6],["T_WHITESPACE"," ",6],["T_AS","as",6],["T_WHITESPACE"," ",6],["T_STRING","TestCase",6],";",["T_WHITESPACE","\n\n",6],["T_ABSTRACT","abstract",8],["T_WHITESPACE"," ",8],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","DatabaseTestCase",8],["T_WHITESPACE"," ",8],["T_EXTENDS","extends",8],["T_WHITESPACE"," ",8],["T_STRING","TestCase",8],["T_WHITESPACE","\n",8],"{",["T_WHITESPACE","\n    ",9],["T_PROTECTED","protected",10],["T_WHITESPACE"," ",10],["T_VARIABLE","$database",10],";",["T_WHITESPACE","\n    ",10],["T_DOC_COMMENT","\/**\n     * @var string the driver name of this test class. Must be set by a subclass.\n     *\/",11],["T_WHITESPACE","\n    ",13],["T_PROTECTED","protected",14],["T_WHITESPACE"," ",14],["T_VARIABLE","$driverName",14],";",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * @var Connection\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_PRIVATE","private",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_db",18],";",["T_WHITESPACE","\n\n\n    ",18],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","setUp",21],"(",")",["T_WHITESPACE","\n    ",21],"{",["T_WHITESPACE","\n        ",22],["T_IF","if",23],["T_WHITESPACE"," ",23],"(",["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","driverName",23],["T_WHITESPACE"," ",23],["T_IS_IDENTICAL","===",23],["T_WHITESPACE"," ",23],["T_STRING","null",23],")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n            ",23],["T_THROW","throw",24],["T_WHITESPACE"," ",24],["T_NEW","new",24],["T_WHITESPACE"," ",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Exception",24],"(",["T_CONSTANT_ENCAPSED_STRING","'driverName is not set for a DatabaseTestCase.'",24],")",";",["T_WHITESPACE","\n        ",24],"}",["T_WHITESPACE","\n\n        ",25],["T_STRING","parent",27],["T_DOUBLE_COLON","::",27],["T_STRING","setUp",27],"(",")",";",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$databases",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_STRING","self",28],["T_DOUBLE_COLON","::",28],["T_STRING","getParam",28],"(",["T_CONSTANT_ENCAPSED_STRING","'databases'",28],")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","database",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$databases",29],"[",["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","driverName",29],"]",";",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$pdo_database",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'pdo_'",30],".",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","driverName",30],";",["T_WHITESPACE","\n        ",30],["T_IF","if",31],["T_WHITESPACE"," ",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","driverName",31],["T_WHITESPACE"," ",31],["T_IS_IDENTICAL","===",31],["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'oci'",31],")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n            ",31],["T_VARIABLE","$pdo_database",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'oci8'",32],";",["T_WHITESPACE","\n        ",32],"}",["T_WHITESPACE","\n\n        ",33],["T_IF","if",35],["T_WHITESPACE"," ",35],"(","!",["T_STRING","extension_loaded",35],"(",["T_CONSTANT_ENCAPSED_STRING","'pdo'",35],")",["T_WHITESPACE"," ",35],["T_BOOLEAN_OR","||",35],["T_WHITESPACE"," ",35],"!",["T_STRING","extension_loaded",35],"(",["T_VARIABLE","$pdo_database",35],")",")",["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n            ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","markTestSkipped",36],"(",["T_CONSTANT_ENCAPSED_STRING","'pdo and '",36],".",["T_VARIABLE","$pdo_database",36],".",["T_CONSTANT_ENCAPSED_STRING","' extension are required.'",36],")",";",["T_WHITESPACE","\n        ",36],"}",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","mockApplication",38],"(",")",";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","tearDown",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_db",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n            ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","_db",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","close",44],"(",")",";",["T_WHITESPACE","\n        ",44],"}",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","destroyApplication",46],"(",")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @param  bool $reset whether to clean up the test database\n     * @param  bool $open  whether to open and populate test database\n     * @return \\yii\\db\\Connection\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","getConnection",54],"(",["T_VARIABLE","$reset",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","true",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$open",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","true",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(","!",["T_VARIABLE","$reset",56],["T_WHITESPACE"," ",56],["T_BOOLEAN_AND","&&",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_db",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_db",57],";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$config",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","database",59],";",["T_WHITESPACE","\n        ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_ISSET","isset",60],"(",["T_VARIABLE","$config",60],"[",["T_CONSTANT_ENCAPSED_STRING","'fixture'",60],"]",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$fixture",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$config",61],"[",["T_CONSTANT_ENCAPSED_STRING","'fixture'",61],"]",";",["T_WHITESPACE","\n            ",61],["T_UNSET","unset",62],"(",["T_VARIABLE","$config",62],"[",["T_CONSTANT_ENCAPSED_STRING","'fixture'",62],"]",")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE"," ",63],["T_ELSE","else",63],["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$fixture",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","null",64],";",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n        ",65],["T_TRY","try",66],["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_db",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","prepareDatabase",67],"(",["T_VARIABLE","$config",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$fixture",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$open",67],")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE"," ",68],["T_CATCH","catch",68],["T_WHITESPACE"," ",68],"(",["T_NS_SEPARATOR","\\",68],["T_STRING","Exception",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$e",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","markTestSkipped",69],"(",["T_CONSTANT_ENCAPSED_STRING","\"Something wrong when preparing database: \"",69],["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_VARIABLE","$e",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getMessage",69],"(",")",")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_db",71],";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","prepareDatabase",74],"(",["T_VARIABLE","$config",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$fixture",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$open",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","true",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_ISSET","isset",76],"(",["T_VARIABLE","$config",76],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",76],"]",")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$config",77],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",77],"]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'yii\\db\\Connection'",77],";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n        ",78],["T_COMMENT","\/* @var $db \\yii\\db\\Connection *\/",79],["T_WHITESPACE","\n        ",79],["T_VARIABLE","$db",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Yii",80],["T_DOUBLE_COLON","::",80],["T_STRING","createObject",80],"(",["T_VARIABLE","$config",80],")",";",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(","!",["T_VARIABLE","$open",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$db",82],";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$db",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","open",84],"(",")",";",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$fixture",85],["T_WHITESPACE"," ",85],["T_IS_NOT_IDENTICAL","!==",85],["T_WHITESPACE"," ",85],["T_STRING","null",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","driverName",86],["T_WHITESPACE"," ",86],["T_IS_IDENTICAL","===",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'oci'",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n                ",86],["T_LIST","list",87],"(",["T_VARIABLE","$drops",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$creates",87],")",["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","explode",87],"(",["T_CONSTANT_ENCAPSED_STRING","'\/* STATEMENTS *\/'",87],",",["T_WHITESPACE"," ",87],["T_STRING","file_get_contents",87],"(",["T_VARIABLE","$fixture",87],")",",",["T_WHITESPACE"," ",87],["T_LNUMBER","2",87],")",";",["T_WHITESPACE","\n                ",87],["T_LIST","list",88],"(",["T_VARIABLE","$statements",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$triggers",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$data",88],")",["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","explode",88],"(",["T_CONSTANT_ENCAPSED_STRING","'\/* TRIGGERS *\/'",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$creates",88],",",["T_WHITESPACE"," ",88],["T_LNUMBER","3",88],")",";",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$lines",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","array_merge",89],"(",["T_STRING","explode",89],"(",["T_CONSTANT_ENCAPSED_STRING","'--'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$drops",89],")",",",["T_WHITESPACE"," ",89],["T_STRING","explode",89],"(",["T_CONSTANT_ENCAPSED_STRING","';'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$statements",89],")",",",["T_WHITESPACE"," ",89],["T_STRING","explode",89],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$triggers",89],")",",",["T_WHITESPACE"," ",89],["T_STRING","explode",89],"(",["T_CONSTANT_ENCAPSED_STRING","';'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$data",89],")",")",";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE"," ",90],["T_ELSE","else",90],["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$lines",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_STRING","explode",91],"(",["T_CONSTANT_ENCAPSED_STRING","';'",91],",",["T_WHITESPACE"," ",91],["T_STRING","file_get_contents",91],"(",["T_VARIABLE","$fixture",91],")",")",";",["T_WHITESPACE","\n            ",91],"}",["T_WHITESPACE","\n            ",92],["T_FOREACH","foreach",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$lines",93],["T_WHITESPACE"," ",93],["T_AS","as",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$line",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n                ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","trim",94],"(",["T_VARIABLE","$line",94],")",["T_WHITESPACE"," ",94],["T_IS_NOT_IDENTICAL","!==",94],["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","''",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                    ",94],["T_VARIABLE","$db",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","pdo",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","exec",95],"(",["T_VARIABLE","$line",95],")",";",["T_WHITESPACE","\n                ",95],"}",["T_WHITESPACE","\n            ",96],"}",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n        ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$db",99],";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * adjust dbms specific escaping\n     * @param $sql\n     * @return mixed\n     *\/",102],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","replaceQuotes",107],"(",["T_VARIABLE","$sql",107],")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_SWITCH","switch",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","driverName",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_CASE","case",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'mysql'",110],":",["T_WHITESPACE","\n            ",110],["T_CASE","case",111],["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",111],":",["T_WHITESPACE","\n                ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_STRING","str_replace",112],"(","[",["T_CONSTANT_ENCAPSED_STRING","'[['",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","']]'",112],"]",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'`'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$sql",112],")",";",["T_WHITESPACE","\n            ",112],["T_CASE","case",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'cubrid'",113],":",["T_WHITESPACE","\n            ",113],["T_CASE","case",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",114],":",["T_WHITESPACE","\n            ",114],["T_CASE","case",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'oci'",115],":",["T_WHITESPACE","\n                ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_STRING","str_replace",116],"(","[",["T_CONSTANT_ENCAPSED_STRING","'[['",116],",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","']]'",116],"]",",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'\"'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$sql",116],")",";",["T_WHITESPACE","\n            ",116],["T_CASE","case",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'sqlsrv'",117],":",["T_WHITESPACE","\n                ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_STRING","str_replace",118],"(","[",["T_CONSTANT_ENCAPSED_STRING","'[['",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","']]'",118],"]",",",["T_WHITESPACE"," ",118],"[",["T_CONSTANT_ENCAPSED_STRING","'['",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","']'",118],"]",",",["T_WHITESPACE"," ",118],["T_VARIABLE","$sql",118],")",";",["T_WHITESPACE","\n            ",118],["T_DEFAULT","default",119],":",["T_WHITESPACE","\n                ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$sql",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n",122],"}",["T_WHITESPACE","\n",123]]