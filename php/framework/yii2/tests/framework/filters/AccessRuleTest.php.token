[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","yiiunit",3],["T_NS_SEPARATOR","\\",3],["T_STRING","framework",3],["T_NS_SEPARATOR","\\",3],["T_STRING","filters",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Yii",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","yii",6],["T_NS_SEPARATOR","\\",6],["T_STRING","base",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Action",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","yii",7],["T_NS_SEPARATOR","\\",7],["T_STRING","filters",7],["T_NS_SEPARATOR","\\",7],["T_STRING","AccessRule",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","yii",8],["T_NS_SEPARATOR","\\",8],["T_STRING","filters",8],["T_NS_SEPARATOR","\\",8],["T_STRING","HttpCache",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","yii",9],["T_NS_SEPARATOR","\\",9],["T_STRING","web",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Controller",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","yii",10],["T_NS_SEPARATOR","\\",10],["T_STRING","web",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Request",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","yii",11],["T_NS_SEPARATOR","\\",11],["T_STRING","web",11],["T_NS_SEPARATOR","\\",11],["T_STRING","User",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","yiiunit",12],["T_NS_SEPARATOR","\\",12],["T_STRING","framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","filters",12],["T_NS_SEPARATOR","\\",12],["T_STRING","stubs",12],["T_NS_SEPARATOR","\\",12],["T_STRING","UserIdentity",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * @group filters\n *\/",14],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","AccessRuleTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_NS_SEPARATOR","\\",17],["T_STRING","yiiunit",17],["T_NS_SEPARATOR","\\",17],["T_STRING","TestCase",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_FUNCTION","function",19],["T_WHITESPACE"," ",19],["T_STRING","setUp",19],"(",")",["T_WHITESPACE","\n    ",19],"{",["T_WHITESPACE","\n        ",20],["T_STRING","parent",21],["T_DOUBLE_COLON","::",21],["T_STRING","setUp",21],"(",")",";",["T_WHITESPACE","\n\n        ",21],["T_VARIABLE","$_SERVER",23],"[",["T_CONSTANT_ENCAPSED_STRING","'SCRIPT_FILENAME'",23],"]",["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","\"\/index.php\"",23],";",["T_WHITESPACE","\n        ",23],["T_VARIABLE","$_SERVER",24],"[",["T_CONSTANT_ENCAPSED_STRING","'SCRIPT_NAME'",24],"]",["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","\"\/index.php\"",24],";",["T_WHITESPACE","\n\n        ",24],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","mockWebApplication",26],"(",")",";",["T_WHITESPACE","\n    ",26],"}",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @param string $method\n     * @return Request\n     *\/",29],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","mockRequest",33],"(",["T_VARIABLE","$method",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'GET'",33],")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_DOC_COMMENT","\/** @var Request $request *\/",35],["T_WHITESPACE","\n        ",35],["T_VARIABLE","$request",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getMockBuilder",36],"(",["T_CONSTANT_ENCAPSED_STRING","'\\yii\\web\\Request'",36],")",["T_OBJECT_OPERATOR","->",36],["T_STRING","setMethods",36],"(","[",["T_CONSTANT_ENCAPSED_STRING","'getMethod'",36],"]",")",["T_OBJECT_OPERATOR","->",36],["T_STRING","getMock",36],"(",")",";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$request",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","method",37],"(",["T_CONSTANT_ENCAPSED_STRING","'getMethod'",37],")",["T_OBJECT_OPERATOR","->",37],["T_STRING","willReturn",37],"(",["T_VARIABLE","$method",37],")",";",["T_WHITESPACE","\n        ",37],["T_RETURN","return",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$request",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * @return User\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","mockUser",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_RETURN","return",46],["T_WHITESPACE"," ",46],["T_NEW","new",46],["T_WHITESPACE"," ",46],["T_STRING","User",46],"(","[",["T_WHITESPACE","\n            ",46],["T_CONSTANT_ENCAPSED_STRING","'identityClass'",47],["T_WHITESPACE"," ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_STRING","UserIdentity",47],["T_DOUBLE_COLON","::",47],["T_STRING","className",47],"(",")",",",["T_WHITESPACE","\n            ",47],["T_CONSTANT_ENCAPSED_STRING","'enableAutoLogin'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_STRING","false",48],",",["T_WHITESPACE","\n        ",48],"]",")",";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * @return Action\n     *\/",52],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","mockAction",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$controller",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","Controller",57],"(",["T_CONSTANT_ENCAPSED_STRING","'site'",57],",",["T_WHITESPACE"," ",57],["T_STRING","Yii",57],["T_DOUBLE_COLON","::",57],["T_VARIABLE","$app",57],")",";",["T_WHITESPACE","\n        ",57],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_NEW","new",58],["T_WHITESPACE"," ",58],["T_STRING","Action",58],"(",["T_CONSTANT_ENCAPSED_STRING","'test'",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$controller",58],")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","testMatchAction",61],"(",")",["T_WHITESPACE","\n    ",61],"{",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$action",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","mockAction",63],"(",")",";",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$user",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","mockUser",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$request",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","mockRequest",65],"(",")",";",["T_WHITESPACE","\n\n        ",65],["T_VARIABLE","$rule",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_NEW","new",67],["T_WHITESPACE"," ",67],["T_STRING","AccessRule",67],"(","[",["T_WHITESPACE","\n            ",67],["T_CONSTANT_ENCAPSED_STRING","'allow'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_STRING","true",68],",",["T_WHITESPACE","\n            ",68],["T_CONSTANT_ENCAPSED_STRING","'actions'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'test'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'other'",69],"]",",",["T_WHITESPACE","\n        ",69],"]",")",";",["T_WHITESPACE","\n\n        ",70],["T_VARIABLE","$action",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","id",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'test'",72],";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","assertTrue",73],"(",["T_VARIABLE","$rule",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","allows",73],"(",["T_VARIABLE","$action",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$user",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$request",73],")",")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$action",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","id",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'other'",74],";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertTrue",75],"(",["T_VARIABLE","$rule",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","allows",75],"(",["T_VARIABLE","$action",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$user",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$request",75],")",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$action",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","id",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'foreign'",76],";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertNull",77],"(",["T_VARIABLE","$rule",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","allows",77],"(",["T_VARIABLE","$action",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$user",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$request",77],")",")",";",["T_WHITESPACE","\n\n        ",77],["T_VARIABLE","$rule",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","allow",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","false",79],";",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$action",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","id",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'test'",81],";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","assertFalse",82],"(",["T_VARIABLE","$rule",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","allows",82],"(",["T_VARIABLE","$action",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$user",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$request",82],")",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$action",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","id",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'other'",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertFalse",84],"(",["T_VARIABLE","$rule",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","allows",84],"(",["T_VARIABLE","$action",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$user",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$request",84],")",")",";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$action",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","id",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'foreign'",85],";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertNull",86],"(",["T_VARIABLE","$rule",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","allows",86],"(",["T_VARIABLE","$action",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$user",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$request",86],")",")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_COMMENT","\/\/ TODO test match controller\n",89],["T_WHITESPACE","\n    ",90],["T_COMMENT","\/\/ TODO test match roles\n",91],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","testMatchVerb",93],"(",")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$action",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","mockAction",95],"(",")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$user",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","mockUser",96],"(",")",";",["T_WHITESPACE","\n\n        ",96],["T_VARIABLE","$rule",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_STRING","AccessRule",98],"(","[",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'allow'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_STRING","true",99],",",["T_WHITESPACE","\n            ",99],["T_CONSTANT_ENCAPSED_STRING","'verbs'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],"[",["T_CONSTANT_ENCAPSED_STRING","'POST'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'get'",100],"]",",",["T_WHITESPACE","\n        ",100],"]",")",";",["T_WHITESPACE","\n\n        ",101],["T_VARIABLE","$request",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","mockRequest",103],"(",["T_CONSTANT_ENCAPSED_STRING","'GET'",103],")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","assertTrue",104],"(",["T_VARIABLE","$rule",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","allows",104],"(",["T_VARIABLE","$action",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$user",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$request",104],")",")",";",["T_WHITESPACE","\n\n        ",104],["T_VARIABLE","$request",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","mockRequest",106],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",106],")",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","assertTrue",107],"(",["T_VARIABLE","$rule",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","allows",107],"(",["T_VARIABLE","$action",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$user",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$request",107],")",")",";",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$request",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","mockRequest",109],"(",["T_CONSTANT_ENCAPSED_STRING","'HEAD'",109],")",";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertNull",110],"(",["T_VARIABLE","$rule",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","allows",110],"(",["T_VARIABLE","$action",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$user",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$request",110],")",")",";",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$request",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","mockRequest",112],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",112],")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","assertTrue",113],"(",["T_VARIABLE","$rule",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","allows",113],"(",["T_VARIABLE","$action",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$user",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$request",113],")",")",";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$request",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","mockRequest",115],"(",["T_CONSTANT_ENCAPSED_STRING","'post'",115],")",";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","assertTrue",116],"(",["T_VARIABLE","$rule",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","allows",116],"(",["T_VARIABLE","$action",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$user",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$request",116],")",")",";",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$request",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","mockRequest",118],"(",["T_CONSTANT_ENCAPSED_STRING","'head'",118],")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","assertNull",119],"(",["T_VARIABLE","$rule",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","allows",119],"(",["T_VARIABLE","$action",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$user",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$request",119],")",")",";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_COMMENT","\/\/ TODO test match custom callback\n",122],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","testMatchIP",124],"(",")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$action",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","mockAction",126],"(",")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$user",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","mockUser",127],"(",")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$request",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","mockRequest",128],"(",")",";",["T_WHITESPACE","\n\n        ",128],["T_VARIABLE","$rule",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_NEW","new",130],["T_WHITESPACE"," ",130],["T_STRING","AccessRule",130],"(",")",";",["T_WHITESPACE","\n\n        ",130],["T_COMMENT","\/\/ by default match all IPs\n",132],["T_WHITESPACE","        ",133],["T_VARIABLE","$rule",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","allow",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","true",133],";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertTrue",134],"(",["T_VARIABLE","$rule",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","allows",134],"(",["T_VARIABLE","$action",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$user",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$request",134],")",")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$rule",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","allow",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING","false",135],";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertFalse",136],"(",["T_VARIABLE","$rule",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","allows",136],"(",["T_VARIABLE","$action",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$user",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$request",136],")",")",";",["T_WHITESPACE","\n\n        ",136],["T_COMMENT","\/\/ empty IPs = match all IPs\n",138],["T_WHITESPACE","        ",139],["T_VARIABLE","$rule",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","ips",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],"[","]",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$rule",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","allow",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","true",140],";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","assertTrue",141],"(",["T_VARIABLE","$rule",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","allows",141],"(",["T_VARIABLE","$action",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$user",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$request",141],")",")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$rule",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","allow",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","false",142],";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","assertFalse",143],"(",["T_VARIABLE","$rule",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","allows",143],"(",["T_VARIABLE","$action",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$user",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$request",143],")",")",";",["T_WHITESPACE","\n\n        ",143],["T_COMMENT","\/\/ match, one IP\n",145],["T_WHITESPACE","        ",146],["T_VARIABLE","$_SERVER",146],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",146],"]",["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",146],";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$rule",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","ips",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],"[",["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",147],"]",";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$rule",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","allow",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","true",148],";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","assertTrue",149],"(",["T_VARIABLE","$rule",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","allows",149],"(",["T_VARIABLE","$action",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$user",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$request",149],")",")",";",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$rule",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","allow",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","false",150],";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","assertFalse",151],"(",["T_VARIABLE","$rule",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","allows",151],"(",["T_VARIABLE","$action",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$user",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$request",151],")",")",";",["T_WHITESPACE","\n\n        ",151],["T_COMMENT","\/\/ no match, one IP\n",153],["T_WHITESPACE","        ",154],["T_VARIABLE","$_SERVER",154],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",154],"]",["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",154],";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$rule",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","ips",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],"[",["T_CONSTANT_ENCAPSED_STRING","'192.168.0.1'",155],"]",";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$rule",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","allow",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","true",156],";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","assertNull",157],"(",["T_VARIABLE","$rule",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","allows",157],"(",["T_VARIABLE","$action",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$user",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$request",157],")",")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$rule",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","allow",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","false",158],";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertNull",159],"(",["T_VARIABLE","$rule",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","allows",159],"(",["T_VARIABLE","$action",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$user",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$request",159],")",")",";",["T_WHITESPACE","\n\n        ",159],["T_COMMENT","\/\/ no partial match, one IP\n",161],["T_WHITESPACE","        ",162],["T_VARIABLE","$_SERVER",162],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",162],"]",["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",162],";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$rule",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","ips",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],"[",["T_CONSTANT_ENCAPSED_STRING","'127.0.0.10'",163],"]",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$rule",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","allow",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","true",164],";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","assertNull",165],"(",["T_VARIABLE","$rule",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","allows",165],"(",["T_VARIABLE","$action",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$user",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$request",165],")",")",";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$rule",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","allow",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","false",166],";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","assertNull",167],"(",["T_VARIABLE","$rule",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","allows",167],"(",["T_VARIABLE","$action",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$user",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$request",167],")",")",";",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$_SERVER",168],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",168],"]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'127.0.0.10'",168],";",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$rule",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","ips",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],"[",["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",169],"]",";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$rule",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","allow",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","true",170],";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","assertNull",171],"(",["T_VARIABLE","$rule",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","allows",171],"(",["T_VARIABLE","$action",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$user",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$request",171],")",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$rule",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","allow",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","false",172],";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","assertNull",173],"(",["T_VARIABLE","$rule",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","allows",173],"(",["T_VARIABLE","$action",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$user",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$request",173],")",")",";",["T_WHITESPACE","\n\n        ",173],["T_COMMENT","\/\/ match, one IP IPv6\n",175],["T_WHITESPACE","        ",176],["T_VARIABLE","$_SERVER",176],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",176],"]",["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'::1'",176],";",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$rule",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","ips",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],"[",["T_CONSTANT_ENCAPSED_STRING","'::1'",177],"]",";",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$rule",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","allow",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","true",178],";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","assertTrue",179],"(",["T_VARIABLE","$rule",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","allows",179],"(",["T_VARIABLE","$action",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$user",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$request",179],")",")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$rule",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","allow",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","false",180],";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","assertFalse",181],"(",["T_VARIABLE","$rule",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","allows",181],"(",["T_VARIABLE","$action",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$user",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$request",181],")",")",";",["T_WHITESPACE","\n\n        ",181],["T_COMMENT","\/\/ no match, one IP IPv6\n",183],["T_WHITESPACE","        ",184],["T_VARIABLE","$_SERVER",184],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",184],"]",["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'::1'",184],";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$rule",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","ips",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],"[",["T_CONSTANT_ENCAPSED_STRING","'dead::beaf::1'",185],"]",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$rule",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","allow",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","true",186],";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","assertNull",187],"(",["T_VARIABLE","$rule",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","allows",187],"(",["T_VARIABLE","$action",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$user",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$request",187],")",")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$rule",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","allow",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_STRING","false",188],";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","assertNull",189],"(",["T_VARIABLE","$rule",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","allows",189],"(",["T_VARIABLE","$action",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$user",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$request",189],")",")",";",["T_WHITESPACE","\n\n        ",189],["T_COMMENT","\/\/ no partial match, one IP IPv6\n",191],["T_WHITESPACE","        ",192],["T_VARIABLE","$_SERVER",192],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",192],"]",["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'::1'",192],";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$rule",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","ips",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],"[",["T_CONSTANT_ENCAPSED_STRING","'::123'",193],"]",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$rule",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","allow",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","true",194],";",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","assertNull",195],"(",["T_VARIABLE","$rule",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","allows",195],"(",["T_VARIABLE","$action",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$user",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$request",195],")",")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$rule",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","allow",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","false",196],";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","assertNull",197],"(",["T_VARIABLE","$rule",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","allows",197],"(",["T_VARIABLE","$action",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$user",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$request",197],")",")",";",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$_SERVER",198],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",198],"]",["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'::123'",198],";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$rule",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","ips",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],"[",["T_CONSTANT_ENCAPSED_STRING","'::1'",199],"]",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$rule",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","allow",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","true",200],";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","assertNull",201],"(",["T_VARIABLE","$rule",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","allows",201],"(",["T_VARIABLE","$action",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$user",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$request",201],")",")",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$rule",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","allow",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","false",202],";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","assertNull",203],"(",["T_VARIABLE","$rule",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","allows",203],"(",["T_VARIABLE","$action",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$user",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$request",203],")",")",";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_PUBLIC","public",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","testMatchIPWildcard",206],"(",")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$action",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","mockAction",208],"(",")",";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$user",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","mockUser",209],"(",")",";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$request",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","mockRequest",210],"(",")",";",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$rule",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_NEW","new",212],["T_WHITESPACE"," ",212],["T_STRING","AccessRule",212],"(",")",";",["T_WHITESPACE","\n\n        ",212],["T_COMMENT","\/\/ no match\n",214],["T_WHITESPACE","        ",215],["T_VARIABLE","$_SERVER",215],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",215],"]",["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",215],";",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$rule",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","ips",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],"[",["T_CONSTANT_ENCAPSED_STRING","'192.168.*'",216],"]",";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$rule",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","allow",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","true",217],";",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","assertNull",218],"(",["T_VARIABLE","$rule",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","allows",218],"(",["T_VARIABLE","$action",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$user",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$request",218],")",")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$rule",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","allow",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","false",219],";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","assertNull",220],"(",["T_VARIABLE","$rule",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","allows",220],"(",["T_VARIABLE","$action",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$user",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$request",220],")",")",";",["T_WHITESPACE","\n\n        ",220],["T_COMMENT","\/\/ match\n",222],["T_WHITESPACE","        ",223],["T_VARIABLE","$_SERVER",223],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",223],"]",["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'127.0.0.1'",223],";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$rule",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","ips",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],"[",["T_CONSTANT_ENCAPSED_STRING","'127.0.*'",224],"]",";",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$rule",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","allow",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_STRING","true",225],";",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","assertTrue",226],"(",["T_VARIABLE","$rule",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","allows",226],"(",["T_VARIABLE","$action",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$user",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$request",226],")",")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$rule",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","allow",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","false",227],";",["T_WHITESPACE","\n        ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","assertFalse",228],"(",["T_VARIABLE","$rule",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","allows",228],"(",["T_VARIABLE","$action",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$user",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$request",228],")",")",";",["T_WHITESPACE","\n\n        ",228],["T_COMMENT","\/\/ match, IPv6\n",230],["T_WHITESPACE","        ",231],["T_VARIABLE","$_SERVER",231],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",231],"]",["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'2a01:4f8:120:7202::2'",231],";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$rule",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","ips",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],"[",["T_CONSTANT_ENCAPSED_STRING","'2a01:4f8:120:*'",232],"]",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$rule",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","allow",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","true",233],";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","assertTrue",234],"(",["T_VARIABLE","$rule",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","allows",234],"(",["T_VARIABLE","$action",234],",",["T_WHITESPACE"," ",234],["T_VARIABLE","$user",234],",",["T_WHITESPACE"," ",234],["T_VARIABLE","$request",234],")",")",";",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$rule",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","allow",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_STRING","false",235],";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","assertFalse",236],"(",["T_VARIABLE","$rule",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","allows",236],"(",["T_VARIABLE","$action",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$user",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$request",236],")",")",";",["T_WHITESPACE","\n\n        ",236],["T_COMMENT","\/\/ no match, IPv6\n",238],["T_WHITESPACE","        ",239],["T_VARIABLE","$_SERVER",239],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",239],"]",["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'::1'",239],";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$rule",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","ips",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],"[",["T_CONSTANT_ENCAPSED_STRING","'2a01:4f8:120:*'",240],"]",";",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$rule",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","allow",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","true",241],";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","assertNull",242],"(",["T_VARIABLE","$rule",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","allows",242],"(",["T_VARIABLE","$action",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$user",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$request",242],")",")",";",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$rule",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","allow",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","false",243],";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","assertNull",244],"(",["T_VARIABLE","$rule",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","allows",244],"(",["T_VARIABLE","$action",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$user",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$request",244],")",")",";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n",245],"}",["T_WHITESPACE","\n",247]]