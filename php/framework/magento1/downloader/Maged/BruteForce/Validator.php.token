[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Connect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",3],["T_WHITESPACE","\n",26],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","Maged_BruteForce_Validator",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n    ",28],["T_CONST","const",29],["T_WHITESPACE"," ",29],["T_STRING","MODEL_KEY_ATTEMPTS_COUNT",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","\"brute-force-attempts-count\"",29],";",["T_WHITESPACE","\n    ",29],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","MODEL_KEY_BAD_ATTEMPTS_COUNT",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","\"brute-force-bad-attempts-count\"",30],";",["T_WHITESPACE","\n    ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","MODEL_KEY_LAST_BAD_TIME",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","\"brute-force-last-bad-time\"",31],";",["T_WHITESPACE","\n    ",31],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","MODEL_KEY_DIFF_TIME_TO_ATTEMPT",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","\"brute-force-diff-time-to-attempt\"",32],";",["T_WHITESPACE","\n\n    ",32],["T_CONST","const",34],["T_WHITESPACE"," ",34],["T_STRING","DEFAULT_ATTEMPTS_COUNT",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_LNUMBER","3",34],";",["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","DEFAULT_BAD_ATTEMPTS_COUNT",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_LNUMBER","0",35],";",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","DEFAULT_DIFF_TIME_TO_ATTEMPT",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_LNUMBER","180",36],";",["T_COMMENT","\/\/ 3 minutes\n",36],["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/** @var Maged_Model_BruteForce_ModelConfigInterface *\/",39],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$model",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * BruteForce constructor.\n     * @param Maged_Model_BruteForce_ModelConfigInterface $model\n     *\/",42],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","__construct",46],"(",["T_STRING","Maged_Model_BruteForce_ModelConfigInterface",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$model",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","model",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$model",48],";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @return bool\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","isCanLogin",54],"(",")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$badAttempts",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getBadAttempts",56],"(",")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$configAttemptsCount",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getConfigAttemptsCount",57],"(",")",";",["T_WHITESPACE","\n\n        ",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$badAttempts",59],["T_WHITESPACE"," ",59],["T_IS_GREATER_OR_EQUAL",">=",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$configAttemptsCount",59],["T_WHITESPACE"," ",59],["T_LOGICAL_AND","and",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$badAttempts",59],["T_WHITESPACE"," ",59],"%",["T_WHITESPACE"," ",59],["T_VARIABLE","$configAttemptsCount",59],["T_WHITESPACE"," ",59],["T_IS_IDENTICAL","===",59],["T_WHITESPACE"," ",59],["T_LNUMBER","0",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$lastBadLogin",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","intval",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","model",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","get",60],"(",["T_STRING","self",60],["T_DOUBLE_COLON","::",60],["T_STRING","MODEL_KEY_LAST_BAD_TIME",60],")",")",";",["T_WHITESPACE","\n            ",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(",["T_VARIABLE","$lastBadLogin",61],["T_WHITESPACE"," ",61],">",["T_WHITESPACE"," ",61],["T_LNUMBER","0",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                ",61],["T_VARIABLE","$timeDiff",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","model",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","get",62],"(",["T_STRING","self",62],["T_DOUBLE_COLON","::",62],["T_STRING","MODEL_KEY_DIFF_TIME_TO_ATTEMPT",62],",",["T_WHITESPACE"," ",62],["T_STRING","self",62],["T_DOUBLE_COLON","::",62],["T_STRING","DEFAULT_DIFF_TIME_TO_ATTEMPT",62],")",";",["T_WHITESPACE","\n                ",62],["T_VARIABLE","$currentTime",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","time",63],"(",")",";",["T_WHITESPACE","\n                ",63],["T_VARIABLE","$checkTime",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$lastBadLogin",64],["T_WHITESPACE"," ",64],"+",["T_WHITESPACE"," ",64],["T_VARIABLE","$timeDiff",64],";",["T_WHITESPACE","\n                ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$checkTime",65],["T_WHITESPACE"," ",65],">",["T_WHITESPACE"," ",65],["T_VARIABLE","$currentTime",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                    ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_STRING","false",66],";",["T_WHITESPACE","\n                ",66],"}",["T_WHITESPACE","\n            ",67],"}",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","true",70],";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @return int\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","getBadAttempts",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_INT_CAST","(int)",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","model",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","get",78],"(",["T_STRING","self",78],["T_DOUBLE_COLON","::",78],["T_STRING","MODEL_KEY_BAD_ATTEMPTS_COUNT",78],",",["T_WHITESPACE"," ",78],["T_STRING","self",78],["T_DOUBLE_COLON","::",78],["T_STRING","DEFAULT_BAD_ATTEMPTS_COUNT",78],")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * @return int\n     *\/",81],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","getConfigAttemptsCount",84],"(",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_INT_CAST","(int)",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","model",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","get",86],"(",["T_STRING","self",86],["T_DOUBLE_COLON","::",86],["T_STRING","MODEL_KEY_ATTEMPTS_COUNT",86],",",["T_WHITESPACE"," ",86],["T_STRING","self",86],["T_DOUBLE_COLON","::",86],["T_STRING","DEFAULT_ATTEMPTS_COUNT",86],")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * @return int\n     *\/",89],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","getTimeToAttempt",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_INT_CAST","(int)",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","model",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","get",94],"(",["T_STRING","self",94],["T_DOUBLE_COLON","::",94],["T_STRING","MODEL_KEY_DIFF_TIME_TO_ATTEMPT",94],",",["T_WHITESPACE"," ",94],["T_STRING","self",94],["T_DOUBLE_COLON","::",94],["T_STRING","DEFAULT_DIFF_TIME_TO_ATTEMPT",94],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * @return $this\n     *\/",97],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","doGoodLogin",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","reset",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * @return void\n     *\/",106],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","reset",109],"(",")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","model",111],["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","set",112],"(",["T_STRING","self",112],["T_DOUBLE_COLON","::",112],["T_STRING","MODEL_KEY_BAD_ATTEMPTS_COUNT",112],",",["T_WHITESPACE"," ",112],["T_STRING","self",112],["T_DOUBLE_COLON","::",112],["T_STRING","DEFAULT_BAD_ATTEMPTS_COUNT",112],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","set",113],"(",["T_STRING","self",113],["T_DOUBLE_COLON","::",113],["T_STRING","MODEL_KEY_DIFF_TIME_TO_ATTEMPT",113],",",["T_WHITESPACE"," ",113],["T_STRING","self",113],["T_DOUBLE_COLON","::",113],["T_STRING","DEFAULT_DIFF_TIME_TO_ATTEMPT",113],")",["T_WHITESPACE","\n            ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","delete",114],"(",["T_STRING","self",114],["T_DOUBLE_COLON","::",114],["T_STRING","MODEL_KEY_LAST_BAD_TIME",114],")",["T_WHITESPACE","\n            ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","save",115],"(",")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * @return $this\n     *\/",118],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","doBadLogin",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$badAttempts",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getBadAttempts",123],"(",")",["T_WHITESPACE"," ",123],"+",["T_WHITESPACE"," ",123],["T_LNUMBER","1",123],";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$configAttemptsCount",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getConfigAttemptsCount",124],"(",")",";",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$timeToNextLogin",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getDiffTimeToNextAttempt",125],"(",")",";",["T_WHITESPACE","\n\n        ",125],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$badAttempts",127],["T_WHITESPACE"," ",127],"%",["T_WHITESPACE"," ",127],["T_VARIABLE","$configAttemptsCount",127],["T_WHITESPACE"," ",127],["T_IS_EQUAL","==",127],["T_WHITESPACE"," ",127],["T_LNUMBER","0",127],["T_WHITESPACE"," ",127],["T_LOGICAL_AND","and",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$badAttempts",127],["T_WHITESPACE"," ",127],["T_IS_NOT_EQUAL","!=",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$configAttemptsCount",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$timeToNextLogin",128],["T_WHITESPACE"," ",128],["T_PLUS_EQUAL","+=",128],["T_WHITESPACE"," ",128],["T_STRING","self",128],["T_DOUBLE_COLON","::",128],["T_STRING","DEFAULT_DIFF_TIME_TO_ATTEMPT",128],";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","model",131],["T_WHITESPACE","\n            ",131],["T_OBJECT_OPERATOR","->",132],["T_STRING","set",132],"(",["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","MODEL_KEY_BAD_ATTEMPTS_COUNT",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$badAttempts",132],")",["T_WHITESPACE","\n            ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","set",133],"(",["T_STRING","self",133],["T_DOUBLE_COLON","::",133],["T_STRING","MODEL_KEY_DIFF_TIME_TO_ATTEMPT",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$timeToNextLogin",133],")",["T_WHITESPACE","\n            ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","set",134],"(",["T_STRING","self",134],["T_DOUBLE_COLON","::",134],["T_STRING","MODEL_KEY_ATTEMPTS_COUNT",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$configAttemptsCount",134],")",["T_WHITESPACE","\n            ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","set",135],"(",["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","MODEL_KEY_LAST_BAD_TIME",135],",",["T_WHITESPACE"," ",135],["T_STRING","time",135],"(",")",")",["T_WHITESPACE","\n            ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","save",136],"(",")",";",["T_WHITESPACE","\n\n        ",136],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * @return int\n     *\/",141],["T_WHITESPACE","\n    ",143],["T_PROTECTED","protected",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","getDiffTimeToNextAttempt",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_INT_CAST","(int)",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","model",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","get",146],"(",["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_STRING","MODEL_KEY_DIFF_TIME_TO_ATTEMPT",146],",",["T_WHITESPACE"," ",146],["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_STRING","DEFAULT_DIFF_TIME_TO_ATTEMPT",146],")",";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n",147],"}",["T_WHITESPACE","\n",148]]