[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Connect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Class to create archive.\n *\n * @category    Mage\n * @package     Mage_Connect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Connect_Package_Writer",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n    * Name of package configuration file\n    *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","DEFAULT_NAME_PACKAGE_CONFIG",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'package.xml'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n    * Temporary dir for extract DEFAULT_NAME_PACKAGE.\n    *\/",42],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","PATH_TO_TEMPORARY_DIRECTORY",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'var\/package\/tmp\/'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n    * Files are used in package.\n    *\n    * @var array\n    *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_files",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_ARRAY","array",52],"(",")",";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n    * Archivator is used for extract DEFAULT_NAME_PACKAGE.\n    *\n    * @var Mage_Archive\n    *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_archivator",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","null",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n    * Name of package with extension. Extension should be only one.\n    * \"package.tar.gz\" is not ability, only \"package.tgz\".\n    *\n    * @var string\n    *\/",61],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_namePackage",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'package'",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n    * Temporary directory where package is situated.\n    *\n    * @var string\n    *\/",69],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_temporaryPackageDir",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","''",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n    * Path to archive with package.\n    *\n    * @var mixed\n    *\/",76],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$_pathToArchive",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","''",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n    * Constructor initializes $_file.\n    *\n    * @param array $files\n    * @param string $namePackage\n    * @return Mage_Connect_Package_Reader\n    *\/",83],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","__construct",90],"(",["T_VARIABLE","$files",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$namePackage",90],"=",["T_CONSTANT_ENCAPSED_STRING","''",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_files",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$files",92],";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_namePackage",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$namePackage",93],";",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n    * Retrieve archivator.\n    *\n    * @return Mage_Archive\n    *\/",97],["T_WHITESPACE","\n    ",101],["T_PROTECTED","protected",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","_getArchivator",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_STRING","is_null",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_archivator",104],")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_archivator",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","Mage_Archive",105],"(",")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n        ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_archivator",107],";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n    * Create dir in PATH_TO_TEMPORARY_DIRECTORY and move all files\n    * to this dir.\n    *\n    * @return Mage_Connect_Package_Writer\n    *\/",110],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","composePackage",116],"(",")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],"@",["T_STRING","mkdir",118],"(",["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_STRING","PATH_TO_TEMPORARY_DIRECTORY",118],",",["T_WHITESPACE"," ",118],["T_LNUMBER","0777",118],",",["T_WHITESPACE"," ",118],["T_STRING","true",118],")",";",["T_WHITESPACE","        \n        ",118],["T_VARIABLE","$root",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","self",119],["T_DOUBLE_COLON","::",119],["T_STRING","PATH_TO_TEMPORARY_DIRECTORY",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_STRING","basename",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_namePackage",119],")",";",["T_WHITESPACE","\n        ",119],"@",["T_STRING","mkdir",120],"(",["T_VARIABLE","$root",120],",",["T_WHITESPACE"," ",120],["T_LNUMBER","0777",120],",",["T_WHITESPACE"," ",120],["T_STRING","true",120],")",";",["T_WHITESPACE","\n        ",120],["T_FOREACH","foreach",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_files",121],["T_WHITESPACE"," ",121],["T_AS","as",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$file",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            \n            ",121],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_STRING","is_dir",123],"(",["T_VARIABLE","$file",123],")",["T_WHITESPACE"," ",123],["T_BOOLEAN_OR","||",123],["T_WHITESPACE"," ",123],["T_STRING","is_file",123],"(",["T_VARIABLE","$file",123],")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$fileName",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","basename",124],"(",["T_VARIABLE","$file",124],")",";",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$filePath",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","dirname",125],"(",["T_VARIABLE","$file",125],")",";",["T_WHITESPACE","\n                ",125],"@",["T_STRING","mkdir",126],"(",["T_VARIABLE","$root",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_STRING","DS",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_VARIABLE","$filePath",126],",",["T_WHITESPACE"," ",126],["T_LNUMBER","0777",126],",",["T_WHITESPACE"," ",126],["T_STRING","true",126],")",";",["T_WHITESPACE","\n                ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_STRING","is_file",127],"(",["T_VARIABLE","$file",127],")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                    ",127],["T_STRING","copy",128],"(",["T_VARIABLE","$file",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$root",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_STRING","DS",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_VARIABLE","$filePath",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_STRING","DS",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_VARIABLE","$fileName",128],")",";",["T_WHITESPACE","\n                ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                    ",129],"@",["T_STRING","mkdir",130],"(",["T_VARIABLE","$root",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_STRING","DS",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_VARIABLE","$filePath",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_VARIABLE","$fileName",130],",",["T_WHITESPACE"," ",130],["T_LNUMBER","0777",130],")",";",["T_WHITESPACE","\n                ",130],"}",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_temporaryPackageDir",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$root",134],";",["T_WHITESPACE","\n        ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n    * Add package.xml to temporary package directory.\n    *\n    * @param $content\n    * @return Mage_Connect_Package_Writer\n    *\/",138],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","addPackageXml",144],"(",["T_VARIABLE","$content",144],")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_STRING","file_put_contents",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_temporaryPackageDir",146],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_STRING","DS",146],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_STRING","DEFAULT_NAME_PACKAGE_CONFIG",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$content",146],")",";",["T_WHITESPACE","\n        ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n    * Archives package.\n    *\n    * @return Mage_Connect_Package_Writer\n    *\/",150],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","archivePackage",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_pathToArchive",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_getArchivator",157],"(",")",["T_OBJECT_OPERATOR","->",157],["T_STRING","pack",157],"(",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_temporaryPackageDir",158],",",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_namePackage",159],".",["T_CONSTANT_ENCAPSED_STRING","'.tgz'",159],",",["T_WHITESPACE","\n            ",159],["T_STRING","true",160],")",";",["T_WHITESPACE","\n\n        ",160],["T_COMMENT","\/\/delete temporary dir\n",162],["T_WHITESPACE","        ",163],["T_STRING","Mage_System_Dirs",163],["T_DOUBLE_COLON","::",163],["T_STRING","rm",163],"(",["T_ARRAY","array",163],"(",["T_CONSTANT_ENCAPSED_STRING","\"-r\"",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_temporaryPackageDir",163],")",")",";",["T_WHITESPACE","\n        ",163],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n    \n    ",165],["T_DOC_COMMENT","\/**\n    * Getter for pathToArchive\n    *\n    * @return string\n    *\/",167],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","getPathToArchive",172],"(",")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_pathToArchive",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n",175],"}",["T_WHITESPACE","\n",177]]