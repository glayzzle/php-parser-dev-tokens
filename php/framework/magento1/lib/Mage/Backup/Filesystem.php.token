[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Backup\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Class to work with filesystem backups\n *\n * @category    Mage\n * @package     Mage_Backup\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Backup_Filesystem",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Backup_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Paths that ignored when creating or rolling back snapshot\n     *\n     * @var array\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_ignorePaths",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",")",";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Whether use ftp account for rollback procedure\n     *\n     * @var bool\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_useFtp",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","false",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Ftp host\n     *\n     * @var string\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_ftpHost",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Ftp username\n     *\n     * @var string\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_ftpUser",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Password to ftp account\n     *\n     * @var string\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_ftpPass",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Ftp path to Magento installation\n     *\n     * @var string\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_ftpPath",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Implementation Rollback functionality for Filesystem\n     *\n     * @throws Mage_Exception\n     * @return bool\n     *\/",78],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","rollback",84],"(",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_lastOperationSucceed",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","false",86],";",["T_WHITESPACE","\n\n        ",86],["T_STRING","set_time_limit",88],"(",["T_LNUMBER","0",88],")",";",["T_WHITESPACE","\n        ",88],["T_STRING","ignore_user_abort",89],"(",["T_STRING","true",89],")",";",["T_WHITESPACE","\n\n        ",89],["T_VARIABLE","$rollbackWorker",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_useFtp",91],["T_WHITESPACE"," ",91],"?",["T_WHITESPACE"," ",91],["T_NEW","new",91],["T_WHITESPACE"," ",91],["T_STRING","Mage_Backup_Filesystem_Rollback_Ftp",91],"(",["T_VARIABLE","$this",91],")",["T_WHITESPACE","\n            ",91],":",["T_WHITESPACE"," ",92],["T_NEW","new",92],["T_WHITESPACE"," ",92],["T_STRING","Mage_Backup_Filesystem_Rollback_Fs",92],"(",["T_VARIABLE","$this",92],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$rollbackWorker",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","run",93],"(",")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_lastOperationSucceed",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","true",95],";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Implementation Create Backup functionality for Filesystem\n     *\n     * @throws Mage_Exception\n     * @return boolean\n     *\/",98],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","create",104],"(",")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_STRING","set_time_limit",106],"(",["T_LNUMBER","0",106],")",";",["T_WHITESPACE","\n        ",106],["T_STRING","ignore_user_abort",107],"(",["T_STRING","true",107],")",";",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_lastOperationSucceed",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","false",109],";",["T_WHITESPACE","\n\n        ",109],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_checkBackupsDir",111],"(",")",";",["T_WHITESPACE","\n\n        ",111],["T_VARIABLE","$fsHelper",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Mage_Backup_Filesystem_Helper",113],"(",")",";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$filesInfo",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$fsHelper",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getInfo",115],"(",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getRootDir",116],"(",")",",",["T_WHITESPACE","\n            ",116],["T_STRING","Mage_Backup_Filesystem_Helper",117],["T_DOUBLE_COLON","::",117],["T_STRING","INFO_READABLE",117],["T_WHITESPACE"," ",117],"|",["T_WHITESPACE"," ",117],["T_STRING","Mage_Backup_Filesystem_Helper",117],["T_DOUBLE_COLON","::",117],["T_STRING","INFO_SIZE",117],",",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getIgnorePaths",118],"(",")",["T_WHITESPACE","\n        ",118],")",";",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$filesInfo",121],"[",["T_CONSTANT_ENCAPSED_STRING","'readable'",121],"]",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_THROW","throw",122],["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","Mage_Backup_Exception_NotEnoughPermissions",122],"(",["T_CONSTANT_ENCAPSED_STRING","'Not enough permissions to read files for backup'",122],")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n\n        ",123],["T_VARIABLE","$freeSpace",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","disk_free_space",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getBackupsDir",125],"(",")",")",";",["T_WHITESPACE","\n\n        ",125],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_LNUMBER","2",127],["T_WHITESPACE"," ",127],"*",["T_WHITESPACE"," ",127],["T_VARIABLE","$filesInfo",127],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",127],"]",["T_WHITESPACE"," ",127],">",["T_WHITESPACE"," ",127],["T_VARIABLE","$freeSpace",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_THROW","throw",128],["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_STRING","Mage_Backup_Exception_NotEnoughFreeSpace",128],"(",["T_CONSTANT_ENCAPSED_STRING","'Not enough free space to create backup'",128],")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$tarTmpPath",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_getTarTmpPath",131],"(",")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$tarPacker",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_STRING","Mage_Backup_Archive_Tar",133],"(",")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$tarPacker",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","setSkipFiles",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getIgnorePaths",134],"(",")",")",["T_WHITESPACE","\n            ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","pack",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getRootDir",135],"(",")",",",["T_WHITESPACE"," ",135],["T_VARIABLE","$tarTmpPath",135],",",["T_WHITESPACE"," ",135],["T_STRING","true",135],")",";",["T_WHITESPACE","\n\n        ",135],["T_IF","if",137],["T_WHITESPACE"," ",137],"(","!",["T_STRING","is_file",137],"(",["T_VARIABLE","$tarTmpPath",137],")",["T_WHITESPACE"," ",137],["T_BOOLEAN_OR","||",137],["T_WHITESPACE"," ",137],["T_STRING","filesize",137],"(",["T_VARIABLE","$tarTmpPath",137],")",["T_WHITESPACE"," ",137],["T_IS_EQUAL","==",137],["T_WHITESPACE"," ",137],["T_LNUMBER","0",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_THROW","throw",138],["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","Mage_Exception",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to create backup'",138],")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_VARIABLE","$backupPath",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getBackupPath",141],"(",")",";",["T_WHITESPACE","\n\n        ",141],["T_VARIABLE","$gzPacker",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_STRING","Mage_Archive_Gz",143],"(",")",";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$gzPacker",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","pack",144],"(",["T_VARIABLE","$tarTmpPath",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$backupPath",144],")",";",["T_WHITESPACE","\n\n        ",144],["T_IF","if",146],["T_WHITESPACE"," ",146],"(","!",["T_STRING","is_file",146],"(",["T_VARIABLE","$backupPath",146],")",["T_WHITESPACE"," ",146],["T_BOOLEAN_OR","||",146],["T_WHITESPACE"," ",146],["T_STRING","filesize",146],"(",["T_VARIABLE","$backupPath",146],")",["T_WHITESPACE"," ",146],["T_IS_EQUAL","==",146],["T_WHITESPACE"," ",146],["T_LNUMBER","0",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_THROW","throw",147],["T_WHITESPACE"," ",147],["T_NEW","new",147],["T_WHITESPACE"," ",147],["T_STRING","Mage_Exception",147],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to create backup'",147],")",";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n\n        ",148],"@",["T_STRING","unlink",150],"(",["T_VARIABLE","$tarTmpPath",150],")",";",["T_WHITESPACE","\n\n        ",150],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_lastOperationSucceed",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","true",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Force class to use ftp for rollback procedure\n     *\n     * @param string $host\n     * @param string $username\n     * @param string $password\n     * @param string $path\n     * @return Mage_Backup_Filesystem\n     *\/",155],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","setUseFtp",164],"(",["T_VARIABLE","$host",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$username",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$password",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$path",164],")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_useFtp",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","true",166],";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_ftpHost",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$host",167],";",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_ftpUser",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$username",168],";",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_ftpPass",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$password",169],";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_ftpPath",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$path",170],";",["T_WHITESPACE","\n        ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],";",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * Get backup type\n     *\n     * @see Mage_Backup_Interface::getType()\n     * @return string\n     *\/",174],["T_WHITESPACE","\n    ",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","getType",180],"(",")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","'filesystem'",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Add path that should be ignoring when creating or rolling back backup\n     *\n     * @param string|array $paths\n     * @return Mage_Backup_Filesystem\n     *\/",185],["T_WHITESPACE","\n    ",190],["T_PUBLIC","public",191],["T_WHITESPACE"," ",191],["T_FUNCTION","function",191],["T_WHITESPACE"," ",191],["T_STRING","addIgnorePaths",191],"(",["T_VARIABLE","$paths",191],")",["T_WHITESPACE","\n    ",191],"{",["T_WHITESPACE","\n        ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_STRING","is_string",193],"(",["T_VARIABLE","$paths",193],")",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(","!",["T_STRING","in_array",194],"(",["T_VARIABLE","$paths",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_ignorePaths",194],")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_ignorePaths",195],"[","]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$paths",195],";",["T_WHITESPACE","\n            ",195],"}",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n        ",197],["T_ELSE","else",198],["T_WHITESPACE"," ",198],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_STRING","is_array",198],"(",["T_VARIABLE","$paths",198],")",")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_FOREACH","foreach",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$paths",199],["T_WHITESPACE"," ",199],["T_AS","as",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$path",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","addIgnorePaths",200],"(",["T_VARIABLE","$path",200],")",";",["T_WHITESPACE","\n            ",200],"}",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n\n        ",202],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n\n    ",205],["T_DOC_COMMENT","\/**\n     * Get paths that should be ignored while creating or rolling back backup procedure\n     *\n     * @return array\n     *\/",207],["T_WHITESPACE","\n    ",211],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","getIgnorePaths",212],"(",")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_ignorePaths",214],";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Set directory where backups saved and add it to ignore paths\n     *\n     * @see Mage_Backup_Abstract::setBackupsDir()\n     * @param string $backupsDir\n     * @return Mage_Backup_Filesystem\n     *\/",217],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","setBackupsDir",224],"(",["T_VARIABLE","$backupsDir",224],")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_STRING","parent",226],["T_DOUBLE_COLON","::",226],["T_STRING","setBackupsDir",226],"(",["T_VARIABLE","$backupsDir",226],")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","addIgnorePaths",227],"(",["T_VARIABLE","$backupsDir",227],")",";",["T_WHITESPACE","\n        ",227],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * getter for $_ftpPath variable\n     *\n     * @return string\n     *\/",231],["T_WHITESPACE","\n    ",235],["T_PUBLIC","public",236],["T_WHITESPACE"," ",236],["T_FUNCTION","function",236],["T_WHITESPACE"," ",236],["T_STRING","getFtpPath",236],"(",")",["T_WHITESPACE","\n    ",236],"{",["T_WHITESPACE","\n        ",237],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_ftpPath",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Get ftp connection string\n     *\n     * @return string\n     *\/",241],["T_WHITESPACE","\n    ",245],["T_PUBLIC","public",246],["T_WHITESPACE"," ",246],["T_FUNCTION","function",246],["T_WHITESPACE"," ",246],["T_STRING","getFtpConnectString",246],"(",")",["T_WHITESPACE","\n    ",246],"{",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'ftp:\/\/'",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_ftpUser",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","':'",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_ftpPass",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'@'",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_ftpHost",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_ftpPath",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Check backups directory existance and whether it's writeable\n     *\n     * @throws Mage_Exception\n     *\/",251],["T_WHITESPACE","\n    ",255],["T_PROTECTED","protected",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","_checkBackupsDir",256],"(",")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$backupsDir",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getBackupsDir",258],"(",")",";",["T_WHITESPACE","\n\n        ",258],["T_IF","if",260],["T_WHITESPACE"," ",260],"(","!",["T_STRING","is_dir",260],"(",["T_VARIABLE","$backupsDir",260],")",")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$backupsDirParentDirectory",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","basename",261],"(",["T_VARIABLE","$backupsDir",261],")",";",["T_WHITESPACE","\n\n            ",261],["T_IF","if",263],["T_WHITESPACE"," ",263],"(","!",["T_STRING","is_writeable",263],"(",["T_VARIABLE","$backupsDirParentDirectory",263],")",")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                ",263],["T_THROW","throw",264],["T_WHITESPACE"," ",264],["T_NEW","new",264],["T_WHITESPACE"," ",264],["T_STRING","Mage_Backup_Exception_NotEnoughPermissions",264],"(",["T_CONSTANT_ENCAPSED_STRING","'Cant create backups directory'",264],")",";",["T_WHITESPACE","\n            ",264],"}",["T_WHITESPACE","\n\n            ",265],["T_STRING","mkdir",267],"(",["T_VARIABLE","$backupsDir",267],")",";",["T_WHITESPACE","\n            ",267],["T_STRING","chmod",268],"(",["T_VARIABLE","$backupsDir",268],",",["T_WHITESPACE"," ",268],["T_LNUMBER","0777",268],")",";",["T_WHITESPACE","\n        ",268],"}",["T_WHITESPACE","\n\n        ",269],["T_IF","if",271],["T_WHITESPACE"," ",271],"(","!",["T_STRING","is_writable",271],"(",["T_VARIABLE","$backupsDir",271],")",")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_THROW","throw",272],["T_WHITESPACE"," ",272],["T_NEW","new",272],["T_WHITESPACE"," ",272],["T_STRING","Mage_Backup_Exception_NotEnoughPermissions",272],"(",["T_CONSTANT_ENCAPSED_STRING","'Backups directory is not writeable'",272],")",";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Generate tmp name for tarball\n     *\/",276],["T_WHITESPACE","\n    ",278],["T_PROTECTED","protected",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","_getTarTmpPath",279],"(",")",["T_WHITESPACE","\n    ",279],"{",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$tmpName",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'~tmp-'",281],".",["T_WHITESPACE"," ",281],["T_STRING","microtime",281],"(",["T_STRING","true",281],")",["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'.tar'",281],";",["T_WHITESPACE","\n        ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getBackupsDir",282],"(",")",["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_STRING","DS",282],["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_VARIABLE","$tmpName",282],";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n",283],"}",["T_WHITESPACE","\n",284]]