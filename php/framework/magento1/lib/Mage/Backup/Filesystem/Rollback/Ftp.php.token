[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Backup\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Rollback worker for rolling back via ftp\n *\n * @category    Mage\n * @package     Mage_Backup\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Backup_Filesystem_Rollback_Ftp",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Backup_Filesystem_Rollback_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Ftp client\n     *\n     * @var Mage_System_Ftp\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_ftpClient",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Files rollback implementation via ftp\n     *\n     * @see Mage_Backup_Filesystem_Rollback_Abstract::run()\n     * @throws Mage_Exception\n     *\/",43],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","run",49],"(",")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$snapshotPath",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_snapshot",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getBackupPath",51],"(",")",";",["T_WHITESPACE","\n\n        ",51],["T_IF","if",53],["T_WHITESPACE"," ",53],"(","!",["T_STRING","is_file",53],"(",["T_VARIABLE","$snapshotPath",53],")",["T_WHITESPACE"," ",53],["T_BOOLEAN_OR","||",53],["T_WHITESPACE"," ",53],"!",["T_STRING","is_readable",53],"(",["T_VARIABLE","$snapshotPath",53],")",")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n            ",53],["T_THROW","throw",54],["T_WHITESPACE"," ",54],["T_NEW","new",54],["T_WHITESPACE"," ",54],["T_STRING","Mage_Backup_Exception_CantLoadSnapshot",54],"(",["T_CONSTANT_ENCAPSED_STRING","'Cant load snapshot archive'",54],")",";",["T_WHITESPACE","\n        ",54],"}",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_initFtpClient",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_validateFtp",58],"(",")",";",["T_WHITESPACE","\n\n        ",58],["T_VARIABLE","$tmpDir",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_createTmpDir",60],"(",")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_unpackSnapshot",61],"(",["T_VARIABLE","$tmpDir",61],")",";",["T_WHITESPACE","\n\n        ",61],["T_VARIABLE","$fsHelper",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_NEW","new",63],["T_WHITESPACE"," ",63],["T_STRING","Mage_Backup_Filesystem_Helper",63],"(",")",";",["T_WHITESPACE","\n\n        ",63],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_cleanupFtp",65],"(",")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_uploadBackupToFtp",66],"(",["T_VARIABLE","$tmpDir",66],")",";",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$fsHelper",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","rm",68],"(",["T_VARIABLE","$tmpDir",68],",",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",",",["T_WHITESPACE"," ",68],["T_STRING","true",68],")",";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Initialize ftp client and connect to ftp\n     *\n     * @throws Mage_Backup_Exception_FtpConnectionFailed\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","_initFtpClient",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_TRY","try",78],["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_ftpClient",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_STRING","Mage_System_Ftp",79],"(",")",";",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_ftpClient",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","connect",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_snapshot",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getFtpConnectString",80],"(",")",")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE"," ",81],["T_CATCH","catch",81],["T_WHITESPACE"," ",81],"(",["T_STRING","Exception",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$e",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_THROW","throw",82],["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","Mage_Backup_Exception_FtpConnectionFailed",82],"(",["T_VARIABLE","$e",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getMessage",82],"(",")",")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Perform ftp validation. Check whether ftp account provided points to current magento installation\n     *\n     * @throws Mage_Exception\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","_validateFtp",91],"(",")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$validationFilename",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'~validation-'",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_STRING","microtime",93],"(",["T_STRING","true",93],")",["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'.tmp'",93],";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$validationFilePath",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_snapshot",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getBackupsDir",94],"(",")",["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_STRING","DS",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_VARIABLE","$validationFilename",94],";",["T_WHITESPACE","\n\n        ",94],["T_VARIABLE","$fh",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],"@",["T_STRING","fopen",96],"(",["T_VARIABLE","$validationFilePath",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'w'",96],")",";",["T_WHITESPACE","\n        ",96],"@",["T_STRING","fclose",97],"(",["T_VARIABLE","$fh",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_STRING","is_file",99],"(",["T_VARIABLE","$validationFilePath",99],")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_THROW","throw",100],["T_WHITESPACE"," ",100],["T_NEW","new",100],["T_WHITESPACE"," ",100],["T_STRING","Mage_Exception",100],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to validate ftp account'",100],")",";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n\n        ",101],["T_VARIABLE","$rootDir",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_snapshot",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getRootDir",103],"(",")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$ftpPath",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_snapshot",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getFtpPath",104],"(",")",["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_STRING","DS",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_STRING","str_replace",104],"(",["T_VARIABLE","$rootDir",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","''",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$validationFilePath",104],")",";",["T_WHITESPACE","\n\n        ",104],["T_VARIABLE","$fileExistsOnFtp",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_ftpClient",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","fileExists",106],"(",["T_VARIABLE","$ftpPath",106],")",";",["T_WHITESPACE","\n        ",106],"@",["T_STRING","unlink",107],"(",["T_VARIABLE","$validationFilePath",107],")",";",["T_WHITESPACE","\n\n        ",107],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_VARIABLE","$fileExistsOnFtp",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_THROW","throw",110],["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Mage_Backup_Exception_FtpValidationFailed",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to validate ftp account'",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Unpack snapshot\n     *\n     * @param string $tmpDir\n     *\/",114],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","_unpackSnapshot",119],"(",["T_VARIABLE","$tmpDir",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$snapshotPath",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_snapshot",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getBackupPath",121],"(",")",";",["T_WHITESPACE","\n\n        ",121],["T_VARIABLE","$archiver",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","Mage_Archive",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$archiver",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","unpack",124],"(",["T_VARIABLE","$snapshotPath",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$tmpDir",124],")",";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * @throws Mage_Exception\n     * @return string\n     *\/",127],["T_WHITESPACE","\n    ",130],["T_PROTECTED","protected",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","_createTmpDir",131],"(",")",["T_WHITESPACE","\n    ",131],"{",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$tmpDir",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_snapshot",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getBackupsDir",133],"(",")",["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_STRING","DS",133],["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'~tmp-'",133],["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_STRING","microtime",133],"(",["T_STRING","true",133],")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$result",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],"@",["T_STRING","mkdir",135],"(",["T_VARIABLE","$tmpDir",135],")",";",["T_WHITESPACE","\n\n        ",135],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_STRING","false",137],["T_WHITESPACE"," ",137],["T_IS_IDENTICAL","===",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$result",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_THROW","throw",138],["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","Mage_Backup_Exception_NotEnoughPermissions",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to create directory '",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_VARIABLE","$tmpDir",138],")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$tmpDir",141],";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * Delete magento and all files from ftp\n     *\/",144],["T_WHITESPACE","\n    ",146],["T_PROTECTED","protected",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","_cleanupFtp",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$rootDir",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_snapshot",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getRootDir",149],"(",")",";",["T_WHITESPACE","\n\n        ",149],["T_VARIABLE","$filesystemIterator",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_NEW","new",151],["T_WHITESPACE"," ",151],["T_STRING","RecursiveIteratorIterator",151],"(",["T_WHITESPACE","\n            ",151],["T_NEW","new",152],["T_WHITESPACE"," ",152],["T_STRING","RecursiveDirectoryIterator",152],"(",["T_VARIABLE","$rootDir",152],")",",",["T_WHITESPACE"," ",152],["T_STRING","RecursiveIteratorIterator",152],["T_DOUBLE_COLON","::",152],["T_STRING","CHILD_FIRST",152],["T_WHITESPACE","\n        ",152],")",";",["T_WHITESPACE","\n\n        ",153],["T_VARIABLE","$iterator",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_NEW","new",155],["T_WHITESPACE"," ",155],["T_STRING","Mage_Backup_Filesystem_Iterator_Filter",155],"(",["T_VARIABLE","$filesystemIterator",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_snapshot",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getIgnorePaths",155],"(",")",")",";",["T_WHITESPACE","\n\n        ",155],["T_FOREACH","foreach",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$iterator",157],["T_WHITESPACE"," ",157],["T_AS","as",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$item",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$ftpPath",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_snapshot",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getFtpPath",158],"(",")",["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_STRING","DS",158],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_STRING","str_replace",158],"(",["T_VARIABLE","$rootDir",158],",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","''",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$item",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","__toString",158],"(",")",")",";",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$ftpPath",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","str_replace",159],"(",["T_STRING","DS",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'\/'",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$ftpPath",159],")",";",["T_WHITESPACE","\n\n            ",159],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_ftpClient",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","delete",161],"(",["T_VARIABLE","$ftpPath",161],")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Perform files rollback\n     *\n     * @param string $tmpDir\n     * @throws Mage_Exception\n     *\/",165],["T_WHITESPACE","\n    ",170],["T_PROTECTED","protected",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","_uploadBackupToFtp",171],"(",["T_VARIABLE","$tmpDir",171],")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$filesystemIterator",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_NEW","new",173],["T_WHITESPACE"," ",173],["T_STRING","RecursiveIteratorIterator",173],"(",["T_WHITESPACE","\n            ",173],["T_NEW","new",174],["T_WHITESPACE"," ",174],["T_STRING","RecursiveDirectoryIterator",174],"(",["T_VARIABLE","$tmpDir",174],")",",",["T_WHITESPACE"," ",174],["T_STRING","RecursiveIteratorIterator",174],["T_DOUBLE_COLON","::",174],["T_STRING","SELF_FIRST",174],["T_WHITESPACE","\n        ",174],")",";",["T_WHITESPACE","\n\n        ",175],["T_VARIABLE","$iterator",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_NEW","new",177],["T_WHITESPACE"," ",177],["T_STRING","Mage_Backup_Filesystem_Iterator_Filter",177],"(",["T_VARIABLE","$filesystemIterator",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_snapshot",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getIgnorePaths",177],"(",")",")",";",["T_WHITESPACE","\n\n        ",177],["T_FOREACH","foreach",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$filesystemIterator",179],["T_WHITESPACE"," ",179],["T_AS","as",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$item",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$ftpPath",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_snapshot",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getFtpPath",180],"(",")",["T_WHITESPACE"," ",180],".",["T_WHITESPACE"," ",180],["T_STRING","DS",180],["T_WHITESPACE"," ",180],".",["T_WHITESPACE"," ",180],["T_STRING","str_replace",180],"(",["T_VARIABLE","$tmpDir",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","''",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$item",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","__toString",180],"(",")",")",";",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$ftpPath",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING","str_replace",181],"(",["T_STRING","DS",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'\/'",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$ftpPath",181],")",";",["T_WHITESPACE","\n\n            ",181],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$item",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","isLink",183],"(",")",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                ",183],["T_CONTINUE","continue",184],";",["T_WHITESPACE","\n            ",184],"}",["T_WHITESPACE","\n\n            ",185],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$item",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","isDir",187],"(",")",")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_ftpClient",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","mkdirRecursive",188],"(",["T_VARIABLE","$ftpPath",188],")",";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE"," ",189],["T_ELSE","else",189],["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$result",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_ftpClient",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","put",190],"(",["T_VARIABLE","$ftpPath",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$item",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","__toString",190],"(",")",")",";",["T_WHITESPACE","\n                ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_STRING","false",191],["T_WHITESPACE"," ",191],["T_IS_IDENTICAL","===",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$result",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                    ",191],["T_THROW","throw",192],["T_WHITESPACE"," ",192],["T_NEW","new",192],["T_WHITESPACE"," ",192],["T_STRING","Mage_Backup_Exception_NotEnoughPermissions",192],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to upload file '",192],["T_WHITESPACE","\n                        ",192],".",["T_WHITESPACE"," ",193],["T_VARIABLE","$item",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","__toString",193],"(",")",["T_WHITESPACE"," ",193],".",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","' to ftp'",193],")",";",["T_WHITESPACE","\n                ",193],"}",["T_WHITESPACE","\n            ",194],"}",["T_WHITESPACE","\n        ",195],"}",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n",197],"}",["T_WHITESPACE","\n",198]]