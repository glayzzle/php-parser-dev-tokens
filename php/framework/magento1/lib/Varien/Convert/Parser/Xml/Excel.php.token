[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Varien\n * @package     Varien_Convert\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Convert excel xml parser\n *\n * @category   Varien\n * @package    Varien_Convert\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Varien_Convert_Parser_Xml_Excel",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Varien_Convert_Parser_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * XML instance for a cell data\n     *\n     * @var SimpleXMLElement\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_xmlElement",42],";",["T_WHITESPACE","\n\n    ",42],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","parse",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","validateDataString",46],"(",")",";",["T_WHITESPACE","\n\n        ",46],["T_VARIABLE","$dom",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_STRING","DOMDocument",48],"(",")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$dom",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","loadXML",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getData",49],"(",")",")",";",["T_WHITESPACE","\n\n        ",49],["T_VARIABLE","$worksheets",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$dom",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getElementsByTagName",51],"(",["T_CONSTANT_ENCAPSED_STRING","'Worksheet'",51],")",";",["T_WHITESPACE","\n\n        ",51],["T_FOREACH","foreach",53],["T_WHITESPACE"," ",53],"(",["T_VARIABLE","$worksheets",53],["T_WHITESPACE"," ",53],["T_AS","as",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$worksheet",53],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n            ",53],["T_VARIABLE","$wsName",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$worksheet",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getAttribute",54],"(",["T_CONSTANT_ENCAPSED_STRING","'ss:Name'",54],")",";",["T_WHITESPACE","\n            ",54],["T_VARIABLE","$rows",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$worksheet",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getElementsByTagName",55],"(",["T_CONSTANT_ENCAPSED_STRING","'Row'",55],")",";",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$firstRow",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","true",56],";",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$fieldNames",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",")",";",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$wsData",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",")",";",["T_WHITESPACE","\n            ",58],["T_FOREACH","foreach",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$rows",59],["T_WHITESPACE"," ",59],["T_AS","as",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$row",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                ",59],["T_VARIABLE","$index",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_LNUMBER","1",60],";",["T_WHITESPACE","\n                ",60],["T_VARIABLE","$cells",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$row",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getElementsByTagName",61],"(",["T_CONSTANT_ENCAPSED_STRING","'Cell'",61],")",";",["T_WHITESPACE","\n                ",61],["T_VARIABLE","$rowData",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",")",";",["T_WHITESPACE","\n                ",62],["T_FOREACH","foreach",63],["T_WHITESPACE"," ",63],"(",["T_VARIABLE","$cells",63],["T_WHITESPACE"," ",63],["T_AS","as",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$cell",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n                    ",63],["T_VARIABLE","$value",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$cell",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getElementsByTagName",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Data'",64],")",["T_OBJECT_OPERATOR","->",64],["T_STRING","item",64],"(",["T_LNUMBER","0",64],")",["T_OBJECT_OPERATOR","->",64],["T_STRING","nodeValue",64],";",["T_WHITESPACE","\n                    ",64],["T_VARIABLE","$ind",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$cell",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getAttribute",65],"(",["T_CONSTANT_ENCAPSED_STRING","'ss:Index'",65],")",";",["T_WHITESPACE","\n                    ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(","!",["T_STRING","is_null",66],"(",["T_VARIABLE","$ind",66],")",["T_WHITESPACE"," ",66],["T_BOOLEAN_AND","&&",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$ind",66],">",["T_LNUMBER","0",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n                        ",66],["T_VARIABLE","$index",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$ind",67],";",["T_WHITESPACE","\n                    ",67],"}",["T_WHITESPACE","\n                    ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$firstRow",69],["T_WHITESPACE"," ",69],["T_BOOLEAN_AND","&&",69],["T_WHITESPACE"," ",69],"!",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getVar",69],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                        ",69],["T_VARIABLE","$fieldNames",70],"[",["T_VARIABLE","$index",70],"]",["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'column'",70],".",["T_VARIABLE","$index",70],";",["T_WHITESPACE","\n                    ",70],"}",["T_WHITESPACE","\n                    ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$firstRow",72],["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getVar",72],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                        ",72],["T_VARIABLE","$fieldNames",73],"[",["T_VARIABLE","$index",73],"]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$value",73],";",["T_WHITESPACE","\n                    ",73],"}",["T_WHITESPACE"," ",74],["T_ELSE","else",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                        ",74],["T_VARIABLE","$rowData",75],"[",["T_VARIABLE","$fieldNames",75],"[",["T_VARIABLE","$index",75],"]","]",["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$value",75],";",["T_WHITESPACE","\n                    ",75],"}",["T_WHITESPACE","\n                    ",76],["T_VARIABLE","$index",77],["T_INC","++",77],";",["T_WHITESPACE","\n                ",77],"}",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$firstRow",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","false",79],";",["T_WHITESPACE","\n                ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(","!",["T_EMPTY","empty",80],"(",["T_VARIABLE","$rowData",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n                    ",80],["T_VARIABLE","$wsData",81],"[","]",["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$rowData",81],";",["T_WHITESPACE","\n                ",81],"}",["T_WHITESPACE","\n            ",82],"}",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$data",84],"[",["T_VARIABLE","$wsName",84],"]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$wsData",84],";",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","addException",85],"(",["T_CONSTANT_ENCAPSED_STRING","'Found worksheet \"'",85],".",["T_VARIABLE","$wsName",85],".",["T_CONSTANT_ENCAPSED_STRING","'\" with '",85],".",["T_STRING","sizeof",85],"(",["T_VARIABLE","$wsData",85],")",".",["T_CONSTANT_ENCAPSED_STRING","' row(s)'",85],")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n        ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$wsName",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getVar",87],"(",["T_CONSTANT_ENCAPSED_STRING","'single_sheet'",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_ISSET","isset",88],"(",["T_VARIABLE","$data",88],"[",["T_VARIABLE","$wsName",88],"]",")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$data",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$data",89],"[",["T_VARIABLE","$wsName",89],"]",";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE"," ",90],["T_ELSE","else",90],["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_STRING","reset",91],"(",["T_VARIABLE","$data",91],")",";",["T_WHITESPACE","\n                ",91],["T_VARIABLE","$data",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","current",92],"(",["T_VARIABLE","$data",92],")",";",["T_WHITESPACE","\n            ",92],"}",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","setData",95],"(",["T_VARIABLE","$data",95],")",";",["T_WHITESPACE","\n        ",95],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","unparse",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_VARIABLE","$wsName",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getVar",101],"(",["T_CONSTANT_ENCAPSED_STRING","'single_sheet'",101],")",")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$data",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",["T_VARIABLE","$wsName",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getData",102],"(",")",")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE"," ",103],["T_ELSE","else",103],["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$data",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getData",104],"(",")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","validateDataGrid",107],"(",")",";",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$xml",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'<'",109],".",["T_CONSTANT_ENCAPSED_STRING","'?xml version=\"1.0\"?'",109],".",["T_CONSTANT_ENCAPSED_STRING","'><'",109],".",["T_CONSTANT_ENCAPSED_STRING","'?mso-application progid=\"Excel.Sheet\"?'",109],".",["T_CONSTANT_ENCAPSED_STRING","'>\n<Workbook xmlns:x=\"urn:schemas-microsoft-com:office:excel\"\n  xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"\n  xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\">'",109],";",["T_WHITESPACE","\n\n        ",112],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_STRING","is_array",114],"(",["T_VARIABLE","$data",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_FOREACH","foreach",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$data",115],["T_WHITESPACE"," ",115],["T_AS","as",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$wsName",115],["T_DOUBLE_ARROW","=>",115],["T_VARIABLE","$wsData",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(","!",["T_STRING","is_array",116],"(",["T_VARIABLE","$wsData",116],")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                    ",116],["T_CONTINUE","continue",117],";",["T_WHITESPACE","\n                ",117],"}",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$fields",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getGridFields",119],"(",["T_VARIABLE","$wsData",119],")",";",["T_WHITESPACE","\n\n                ",119],["T_VARIABLE","$xml",121],["T_WHITESPACE"," ",121],["T_CONCAT_EQUAL",".=",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'<Worksheet ss:Name=\"'",121],".",["T_VARIABLE","$wsName",121],".",["T_CONSTANT_ENCAPSED_STRING","'\"><ss:Table>'",121],";",["T_WHITESPACE","\n                ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getVar",122],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",122],")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                    ",122],["T_VARIABLE","$xml",123],["T_WHITESPACE"," ",123],["T_CONCAT_EQUAL",".=",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'<ss:Row>'",123],";",["T_WHITESPACE","\n                    ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$fields",124],["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$fieldName",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                        ",124],["T_VARIABLE","$xml",125],["T_WHITESPACE"," ",125],["T_CONCAT_EQUAL",".=",125],["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'<ss:Cell><Data ss:Type=\"String\">'",125],".",["T_VARIABLE","$fieldName",125],".",["T_CONSTANT_ENCAPSED_STRING","'<\/Data><\/ss:Cell>'",125],";",["T_WHITESPACE","\n                    ",125],"}",["T_WHITESPACE","\n                    ",126],["T_VARIABLE","$xml",127],["T_WHITESPACE"," ",127],["T_CONCAT_EQUAL",".=",127],["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'<\/ss:Row>'",127],";",["T_WHITESPACE","\n                ",127],"}",["T_WHITESPACE","\n                ",128],["T_FOREACH","foreach",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$wsData",129],["T_WHITESPACE"," ",129],["T_AS","as",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$i",129],["T_DOUBLE_ARROW","=>",129],["T_VARIABLE","$row",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                    ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(","!",["T_STRING","is_array",130],"(",["T_VARIABLE","$row",130],")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                        ",130],["T_CONTINUE","continue",131],";",["T_WHITESPACE","\n                    ",131],"}",["T_WHITESPACE","\n                    ",132],["T_VARIABLE","$xml",133],["T_WHITESPACE"," ",133],["T_CONCAT_EQUAL",".=",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'<ss:Row>'",133],";",["T_WHITESPACE","\n                    ",133],["T_FOREACH","foreach",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$fields",134],["T_WHITESPACE"," ",134],["T_AS","as",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$fieldName",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n                        ",134],["T_VARIABLE","$data",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_ISSET","isset",135],"(",["T_VARIABLE","$row",135],"[",["T_VARIABLE","$fieldName",135],"]",")",["T_WHITESPACE"," ",135],"?",["T_WHITESPACE"," ",135],["T_VARIABLE","$row",135],"[",["T_VARIABLE","$fieldName",135],"]",["T_WHITESPACE"," ",135],":",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","''",135],";",["T_WHITESPACE","\n                        ",135],["T_VARIABLE","$fieldType",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","is_numeric",136],"(",["T_VARIABLE","$data",136],")",["T_WHITESPACE"," ",136],"?",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'Number'",136],["T_WHITESPACE"," ",136],":",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'String'",136],";",["T_WHITESPACE","\n                        ",136],["T_VARIABLE","$xml",137],["T_WHITESPACE"," ",137],["T_CONCAT_EQUAL",".=",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'<ss:Cell><Data ss:Type=\"'",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_VARIABLE","$fieldType",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'\">'",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_VARIABLE","$data",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'<\/Data><\/ss:Cell>'",137],";",["T_WHITESPACE","\n                    ",137],"}",["T_WHITESPACE","\n                    ",138],["T_VARIABLE","$xml",139],["T_WHITESPACE"," ",139],["T_CONCAT_EQUAL",".=",139],["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'<\/ss:Row>'",139],";",["T_WHITESPACE","\n                ",139],"}",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$xml",141],["T_WHITESPACE"," ",141],["T_CONCAT_EQUAL",".=",141],["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'<\/ss:Table><\/Worksheet>'",141],";",["T_WHITESPACE","\n            ",141],"}",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$xml",145],["T_WHITESPACE"," ",145],["T_CONCAT_EQUAL",".=",145],["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'<\/Workbook>'",145],";",["T_WHITESPACE","\n\n        ",145],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","setData",147],"(",["T_VARIABLE","$xml",147],")",";",["T_WHITESPACE","\n\n        ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Retrieve Excel 2003 XML Document header XML fragment\n     *\n     * @param string $sheetName the Worksheet name\n     * @return string\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","getHeaderXml",158],"(",["T_VARIABLE","$sheetName",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","''",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_EMPTY","empty",160],"(",["T_VARIABLE","$sheetName",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$sheetName",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'Sheet 1'",161],";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$sheetName",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","htmlspecialchars",163],"(",["T_VARIABLE","$sheetName",163],")",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$xml",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'<'",164],".",["T_CONSTANT_ENCAPSED_STRING","'?xml version=\"1.0\"?'",164],".",["T_CONSTANT_ENCAPSED_STRING","'><'",164],".",["T_CONSTANT_ENCAPSED_STRING","'?mso-application progid=\"Excel.Sheet\"?'",164],["T_WHITESPACE","\n            ",164],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'><Workbook'",165],["T_WHITESPACE","\n            ",165],".",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","' xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"'",166],["T_WHITESPACE","\n            ",166],".",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","' xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\"'",167],["T_WHITESPACE","\n            ",167],".",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","' xmlns:x=\"urn:schemas-microsoft-com:office:excel\"'",168],["T_WHITESPACE","\n            ",168],".",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","' xmlns:x2=\"http:\/\/schemas.microsoft.com\/office\/excel\/2003\/xml\"'",169],["T_WHITESPACE","\n            ",169],".",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","' xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"'",170],["T_WHITESPACE","\n            ",170],".",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","' xmlns:o=\"urn:schemas-microsoft-com:office:office\"'",171],["T_WHITESPACE","\n            ",171],".",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","' xmlns:html=\"http:\/\/www.w3.org\/TR\/REC-html40\"'",172],["T_WHITESPACE","\n            ",172],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","' xmlns:c=\"urn:schemas-microsoft-com:office:component:spreadsheet\">'",173],["T_WHITESPACE","\n            ",173],".",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'<OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\">'",174],["T_WHITESPACE","\n            ",174],".",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'<\/OfficeDocumentSettings>'",175],["T_WHITESPACE","\n            ",175],".",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\">'",176],["T_WHITESPACE","\n            ",176],".",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'<\/ExcelWorkbook>'",177],["T_WHITESPACE","\n            ",177],".",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'<Worksheet ss:Name=\"'",178],["T_WHITESPACE"," ",178],".",["T_WHITESPACE"," ",178],["T_VARIABLE","$sheetName",178],["T_WHITESPACE"," ",178],".",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'\">'",178],["T_WHITESPACE","\n            ",178],".",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'<Table>'",179],";",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$xml",180],";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Retrieve Excel 2003 XML Document footer XML fragment\n     *\n     * @return string\n     *\/",183],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","getFooterXml",188],"(",")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'<\/Table><\/Worksheet><\/Workbook>'",190],";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Convert an array to Excel 2003 XML Document a Row XML fragment\n     *\n     * @param array $row\n     * @return string\n     *\/",193],["T_WHITESPACE","\n    ",198],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","getRowXml",199],"(",["T_ARRAY","array",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$row",199],")",["T_WHITESPACE","\n    ",199],"{",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$xmlHeader",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'<'",201],".",["T_CONSTANT_ENCAPSED_STRING","'?xml version=\"1.0\"?'",201],".",["T_CONSTANT_ENCAPSED_STRING","'>'",201],["T_WHITESPACE"," ",201],".",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",201],";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$xmlRegexp",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'\/^<cell><row>(.*)?<\\\/row><\\\/cell>\\s?$\/ms'",202],";",["T_WHITESPACE","\n\n        ",202],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_STRING","is_null",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_xmlElement",204],")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$xmlString",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$xmlHeader",205],["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'<cell><row><\/row><\/cell>'",205],";",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_xmlElement",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_NEW","new",206],["T_WHITESPACE"," ",206],["T_STRING","SimpleXMLElement",206],"(",["T_VARIABLE","$xmlString",206],",",["T_WHITESPACE"," ",206],["T_STRING","LIBXML_NOBLANKS",206],")",";",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE","\n\n        ",207],["T_VARIABLE","$xmlData",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_ARRAY","array",209],"(",")",";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$xmlData",210],"[","]",["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'<Row>'",210],";",["T_WHITESPACE","\n        ",210],["T_FOREACH","foreach",211],["T_WHITESPACE"," ",211],"(",["T_VARIABLE","$row",211],["T_WHITESPACE"," ",211],["T_AS","as",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$value",211],")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n            ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_xmlElement",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","row",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","htmlspecialchars",212],"(",["T_VARIABLE","$value",212],")",";",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$value",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","str_replace",213],"(",["T_VARIABLE","$xmlHeader",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","''",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_xmlElement",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","asXML",213],"(",")",")",";",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$value",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_STRING","preg_replace",214],"(",["T_VARIABLE","$xmlRegexp",214],",",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'\\\\1'",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$value",214],")",";",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$dataType",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","\"String\"",215],";",["T_WHITESPACE","\n            ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_STRING","is_numeric",216],"(",["T_VARIABLE","$value",216],")",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                ",216],["T_VARIABLE","$dataType",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_CONSTANT_ENCAPSED_STRING","\"Number\"",217],";",["T_WHITESPACE","\n                ",217],["T_COMMENT","\/\/ is_numeric(' 96000') returns true, but Excel argues about space\n",218],["T_WHITESPACE","                ",219],["T_VARIABLE","$value",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","trim",219],"(",["T_VARIABLE","$value",219],")",";",["T_WHITESPACE","\n            ",219],"}",["T_WHITESPACE","\n            ",220],["T_VARIABLE","$value",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_STRING","str_replace",221],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",221],",",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'&#10;'",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$value",221],")",";",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$value",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_STRING","str_replace",222],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\"",222],",",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'&#10;'",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$value",222],")",";",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$value",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","str_replace",223],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",223],",",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'&#10;'",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$value",223],")",";",["T_WHITESPACE","\n\n            ",223],["T_VARIABLE","$xmlData",225],"[","]",["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'<Cell><Data ss:Type=\"'",225],".",["T_VARIABLE","$dataType",225],".",["T_CONSTANT_ENCAPSED_STRING","'\">'",225],".",["T_VARIABLE","$value",225],".",["T_CONSTANT_ENCAPSED_STRING","'<\/Data><\/Cell>'",225],";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$xmlData",227],"[","]",["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'<\/Row>'",227],";",["T_WHITESPACE","\n\n        ",227],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_STRING","join",229],"(",["T_CONSTANT_ENCAPSED_STRING","''",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$xmlData",229],")",";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n",230],"}",["T_WHITESPACE","\n",231]]