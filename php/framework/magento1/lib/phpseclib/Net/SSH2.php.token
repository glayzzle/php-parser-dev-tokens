[["T_OPEN_TAG","<?php\n",1],["T_COMMENT","\/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: *\/",2],["T_WHITESPACE","\n\n",2],["T_DOC_COMMENT","\/**\n * Pure-PHP implementation of SSHv2.\n *\n * PHP versions 4 and 5\n *\n * Here are some examples of how to use this library:\n * <code>\n * <?php\n *    include('Net\/SSH2.php');\n *\n *    $ssh = new Net_SSH2('www.domain.tld');\n *    if (!$ssh->login('username', 'password')) {\n *        exit('Login Failed');\n *    }\n *\n *    echo $ssh->exec('pwd');\n *    echo $ssh->exec('ls -la');\n * ?>\n * <\/code>\n *\n * <code>\n * <?php\n *    include('Crypt\/RSA.php');\n *    include('Net\/SSH2.php');\n *\n *    $key = new Crypt_RSA();\n *    \/\/$key->setPassword('whatever');\n *    $key->loadKey(file_get_contents('privatekey'));\n *\n *    $ssh = new Net_SSH2('www.domain.tld');\n *    if (!$ssh->login('username', $key)) {\n *        exit('Login Failed');\n *    }\n *\n *    echo $ssh->exec('pwd');\n *    echo $ssh->exec('ls -la');\n * ?>\n * <\/code>\n *\n * LICENSE: This library is free software; you can redistribute it and\/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place, Suite 330, Boston,\n * MA  02111-1307  USA\n *\n * @category   Net\n * @package    Net_SSH2\n * @author     Jim Wigginton <terrafrost@php.net>\n * @copyright  MMVII Jim Wigginton\n * @license    http:\/\/www.gnu.org\/licenses\/lgpl.txt\n * @version    $Id: SSH2.php,v 1.46 2010\/04\/27 21:29:36 terrafrost Exp $\n * @link       http:\/\/phpseclib.sourceforge.net\n *\/",4],["T_WHITESPACE","\n\n",65],["T_DOC_COMMENT","\/**\n * Include Math_BigInteger\n *\n * Used to do Diffie-Hellman key exchange and DSA\/RSA signature verification.\n *\/",67],["T_WHITESPACE","\n",71],["T_REQUIRE_ONCE","require_once",72],"(",["T_CONSTANT_ENCAPSED_STRING","'phpseclib\/Math\/BigInteger.php'",72],")",";",["T_WHITESPACE","\n\n",72],["T_DOC_COMMENT","\/**\n * Include Crypt_Random\n *\/",74],["T_WHITESPACE","\n",76],["T_REQUIRE_ONCE","require_once",77],"(",["T_CONSTANT_ENCAPSED_STRING","'phpseclib\/Crypt\/Random.php'",77],")",";",["T_WHITESPACE","\n\n",77],["T_DOC_COMMENT","\/**\n * Include Crypt_Hash\n *\/",79],["T_WHITESPACE","\n",81],["T_REQUIRE_ONCE","require_once",82],"(",["T_CONSTANT_ENCAPSED_STRING","'phpseclib\/Crypt\/Hash.php'",82],")",";",["T_WHITESPACE","\n\n",82],["T_DOC_COMMENT","\/**\n * Include Crypt_TripleDES\n *\/",84],["T_WHITESPACE","\n",86],["T_REQUIRE_ONCE","require_once",87],"(",["T_CONSTANT_ENCAPSED_STRING","'phpseclib\/Crypt\/TripleDES.php'",87],")",";",["T_WHITESPACE","\n\n",87],["T_DOC_COMMENT","\/**\n * Include Crypt_RC4\n *\/",89],["T_WHITESPACE","\n",91],["T_REQUIRE_ONCE","require_once",92],"(",["T_CONSTANT_ENCAPSED_STRING","'phpseclib\/Crypt\/RC4.php'",92],")",";",["T_WHITESPACE","\n\n",92],["T_DOC_COMMENT","\/**\n * Include Crypt_AES\n *\/",94],["T_WHITESPACE","\n",96],["T_REQUIRE_ONCE","require_once",97],"(",["T_CONSTANT_ENCAPSED_STRING","'phpseclib\/Crypt\/AES.php'",97],")",";",["T_WHITESPACE","\n\n",97],["T_COMMENT","\/**#@+\n * Execution Bitmap Masks\n *\n * @see Net_SSH2::bitmap\n * @access private\n *\/",99],["T_WHITESPACE","\n",104],["T_STRING","define",105],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MASK_CONSTRUCTOR'",105],",",["T_WHITESPACE"," ",105],["T_LNUMBER","0x00000001",105],")",";",["T_WHITESPACE","\n",105],["T_STRING","define",106],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MASK_LOGIN'",106],",",["T_WHITESPACE","       ",106],["T_LNUMBER","0x00000002",106],")",";",["T_WHITESPACE","\n",106],["T_COMMENT","\/**#@-*\/",107],["T_WHITESPACE","\n\n",107],["T_COMMENT","\/**#@+\n * Channel constants\n *\n * RFC4254 refers not to client and server channels but rather to sender and recipient channels.  we don't refer\n * to them in that way because RFC4254 toggles the meaning. the client sends a SSH_MSG_CHANNEL_OPEN message with\n * a sender channel and the server sends a SSH_MSG_CHANNEL_OPEN_CONFIRMATION in response, with a sender and a\n * recepient channel.  at first glance, you might conclude that SSH_MSG_CHANNEL_OPEN_CONFIRMATION's sender channel\n * would be the same thing as SSH_MSG_CHANNEL_OPEN's sender channel, but it's not, per this snipet:\n *     The 'recipient channel' is the channel number given in the original\n *     open request, and 'sender channel' is the channel number allocated by\n *     the other side.\n *\n * @see Net_SSH2::_send_channel_packet()\n * @see Net_SSH2::_get_channel_packet()\n * @access private\n *\/",109],["T_WHITESPACE","\n",124],["T_STRING","define",125],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_CHANNEL_EXEC'",125],",",["T_WHITESPACE"," ",125],["T_LNUMBER","0",125],")",";",["T_WHITESPACE"," ",125],["T_COMMENT","\/\/ PuTTy uses 0x100\n",125],["T_COMMENT","\/**#@-*\/",126],["T_WHITESPACE","\n\n",126],["T_COMMENT","\/**#@+\n * @access public\n * @see Net_SSH2::getLog()\n *\/",128],["T_WHITESPACE","\n",131],["T_DOC_COMMENT","\/**\n * Returns the message numbers\n *\/",132],["T_WHITESPACE","\n",134],["T_STRING","define",135],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOG_SIMPLE'",135],",",["T_WHITESPACE","  ",135],["T_LNUMBER","1",135],")",";",["T_WHITESPACE","\n",135],["T_DOC_COMMENT","\/**\n * Returns the message content\n *\/",136],["T_WHITESPACE","\n",138],["T_STRING","define",139],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOG_COMPLEX'",139],",",["T_WHITESPACE"," ",139],["T_LNUMBER","2",139],")",";",["T_WHITESPACE","\n",139],["T_COMMENT","\/**#@-*\/",140],["T_WHITESPACE","\n\n",140],["T_DOC_COMMENT","\/**\n * Pure-PHP implementation of SSHv2.\n *\n * @author  Jim Wigginton <terrafrost@php.net>\n * @version 0.1.0\n * @access  public\n * @package Net_SSH2\n *\/",142],["T_WHITESPACE","\n",149],["T_CLASS","class",150],["T_WHITESPACE"," ",150],["T_STRING","Net_SSH2",150],["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n    ",150],["T_DOC_COMMENT","\/**\n     * The SSH identifier\n     *\n     * @var String\n     * @access private\n     *\/",151],["T_WHITESPACE","\n    ",156],["T_VAR","var",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$identifier",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'SSH-2.0-phpseclib_0.2'",157],";",["T_WHITESPACE","\n\n    ",157],["T_DOC_COMMENT","\/**\n     * The Socket Object\n     *\n     * @var Object\n     * @access private\n     *\/",159],["T_WHITESPACE","\n    ",164],["T_VAR","var",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$fsock",165],";",["T_WHITESPACE","\n\n    ",165],["T_DOC_COMMENT","\/**\n     * Execution Bitmap\n     *\n     * The bits that are set reprsent functions that have been called already.  This is used to determine\n     * if a requisite function has been successfully executed.  If not, an error should be thrown.\n     *\n     * @var Integer\n     * @access private\n     *\/",167],["T_WHITESPACE","\n    ",175],["T_VAR","var",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$bitmap",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_LNUMBER","0",176],";",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Error information\n     *\n     * @see Net_SSH2::getErrors()\n     * @see Net_SSH2::getLastError()\n     * @var String\n     * @access private\n     *\/",178],["T_WHITESPACE","\n    ",185],["T_VAR","var",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$errors",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_ARRAY","array",186],"(",")",";",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Server Identifier\n     *\n     * @see Net_SSH2::getServerIdentification()\n     * @var String\n     * @access private\n     *\/",188],["T_WHITESPACE","\n    ",194],["T_VAR","var",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$server_identifier",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","''",195],";",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Key Exchange Algorithms\n     *\n     * @see Net_SSH2::getKexAlgorithims()\n     * @var Array\n     * @access private\n     *\/",197],["T_WHITESPACE","\n    ",203],["T_VAR","var",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$kex_algorithms",204],";",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Server Host Key Algorithms\n     *\n     * @see Net_SSH2::getServerHostKeyAlgorithms()\n     * @var Array\n     * @access private\n     *\/",206],["T_WHITESPACE","\n    ",212],["T_VAR","var",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$server_host_key_algorithms",213],";",["T_WHITESPACE","\n\n    ",213],["T_DOC_COMMENT","\/**\n     * Encryption Algorithms: Client to Server\n     *\n     * @see Net_SSH2::getEncryptionAlgorithmsClient2Server()\n     * @var Array\n     * @access private\n     *\/",215],["T_WHITESPACE","\n    ",221],["T_VAR","var",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$encryption_algorithms_client_to_server",222],";",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Encryption Algorithms: Server to Client\n     *\n     * @see Net_SSH2::getEncryptionAlgorithmsServer2Client()\n     * @var Array\n     * @access private\n     *\/",224],["T_WHITESPACE","\n    ",230],["T_VAR","var",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$encryption_algorithms_server_to_client",231],";",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * MAC Algorithms: Client to Server\n     *\n     * @see Net_SSH2::getMACAlgorithmsClient2Server()\n     * @var Array\n     * @access private\n     *\/",233],["T_WHITESPACE","\n    ",239],["T_VAR","var",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$mac_algorithms_client_to_server",240],";",["T_WHITESPACE","\n\n    ",240],["T_DOC_COMMENT","\/**\n     * MAC Algorithms: Server to Client\n     *\n     * @see Net_SSH2::getMACAlgorithmsServer2Client()\n     * @var Array\n     * @access private\n     *\/",242],["T_WHITESPACE","\n    ",248],["T_VAR","var",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$mac_algorithms_server_to_client",249],";",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Compression Algorithms: Client to Server\n     *\n     * @see Net_SSH2::getCompressionAlgorithmsClient2Server()\n     * @var Array\n     * @access private\n     *\/",251],["T_WHITESPACE","\n    ",257],["T_VAR","var",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$compression_algorithms_client_to_server",258],";",["T_WHITESPACE","\n\n    ",258],["T_DOC_COMMENT","\/**\n     * Compression Algorithms: Server to Client\n     *\n     * @see Net_SSH2::getCompressionAlgorithmsServer2Client()\n     * @var Array\n     * @access private\n     *\/",260],["T_WHITESPACE","\n    ",266],["T_VAR","var",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$compression_algorithms_server_to_client",267],";",["T_WHITESPACE","\n\n    ",267],["T_DOC_COMMENT","\/**\n     * Languages: Server to Client\n     *\n     * @see Net_SSH2::getLanguagesServer2Client()\n     * @var Array\n     * @access private\n     *\/",269],["T_WHITESPACE","\n    ",275],["T_VAR","var",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$languages_server_to_client",276],";",["T_WHITESPACE","\n\n    ",276],["T_DOC_COMMENT","\/**\n     * Languages: Client to Server\n     *\n     * @see Net_SSH2::getLanguagesClient2Server()\n     * @var Array\n     * @access private\n     *\/",278],["T_WHITESPACE","\n    ",284],["T_VAR","var",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$languages_client_to_server",285],";",["T_WHITESPACE","\n\n    ",285],["T_DOC_COMMENT","\/**\n     * Block Size for Server to Client Encryption\n     *\n     * \"Note that the length of the concatenation of 'packet_length',\n     *  'padding_length', 'payload', and 'random padding' MUST be a multiple\n     *  of the cipher block size or 8, whichever is larger.  This constraint\n     *  MUST be enforced, even when using stream ciphers.\"\n     *\n     *  -- http:\/\/tools.ietf.org\/html\/rfc4253#section-6\n     *\n     * @see Net_SSH2::Net_SSH2()\n     * @see Net_SSH2::_send_binary_packet()\n     * @var Integer\n     * @access private\n     *\/",287],["T_WHITESPACE","\n    ",301],["T_VAR","var",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$encrypt_block_size",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_LNUMBER","8",302],";",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Block Size for Client to Server Encryption\n     *\n     * @see Net_SSH2::Net_SSH2()\n     * @see Net_SSH2::_get_binary_packet()\n     * @var Integer\n     * @access private\n     *\/",304],["T_WHITESPACE","\n    ",311],["T_VAR","var",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$decrypt_block_size",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_LNUMBER","8",312],";",["T_WHITESPACE","\n\n    ",312],["T_DOC_COMMENT","\/**\n     * Server to Client Encryption Object\n     *\n     * @see Net_SSH2::_get_binary_packet()\n     * @var Object\n     * @access private\n     *\/",314],["T_WHITESPACE","\n    ",320],["T_VAR","var",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$decrypt",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_STRING","false",321],";",["T_WHITESPACE","\n\n    ",321],["T_DOC_COMMENT","\/**\n     * Client to Server Encryption Object\n     *\n     * @see Net_SSH2::_send_binary_packet()\n     * @var Object\n     * @access private\n     *\/",323],["T_WHITESPACE","\n    ",329],["T_VAR","var",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$encrypt",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","false",330],";",["T_WHITESPACE","\n\n    ",330],["T_DOC_COMMENT","\/**\n     * Client to Server HMAC Object\n     *\n     * @see Net_SSH2::_send_binary_packet()\n     * @var Object\n     * @access private\n     *\/",332],["T_WHITESPACE","\n    ",338],["T_VAR","var",339],["T_WHITESPACE"," ",339],["T_VARIABLE","$hmac_create",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","false",339],";",["T_WHITESPACE","\n\n    ",339],["T_DOC_COMMENT","\/**\n     * Server to Client HMAC Object\n     *\n     * @see Net_SSH2::_get_binary_packet()\n     * @var Object\n     * @access private\n     *\/",341],["T_WHITESPACE","\n    ",347],["T_VAR","var",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$hmac_check",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","false",348],";",["T_WHITESPACE","\n\n    ",348],["T_DOC_COMMENT","\/**\n     * Size of server to client HMAC\n     *\n     * We need to know how big the HMAC will be for the server to client direction so that we know how many bytes to read.\n     * For the client to server side, the HMAC object will make the HMAC as long as it needs to be.  All we need to do is\n     * append it.\n     *\n     * @see Net_SSH2::_get_binary_packet()\n     * @var Integer\n     * @access private\n     *\/",350],["T_WHITESPACE","\n    ",360],["T_VAR","var",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$hmac_size",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_STRING","false",361],";",["T_WHITESPACE","\n\n    ",361],["T_DOC_COMMENT","\/**\n     * Server Public Host Key\n     *\n     * @see Net_SSH2::getServerPublicHostKey()\n     * @var String\n     * @access private\n     *\/",363],["T_WHITESPACE","\n    ",369],["T_VAR","var",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$server_public_host_key",370],";",["T_WHITESPACE","\n\n    ",370],["T_DOC_COMMENT","\/**\n     * Session identifer\n     *\n     * \"The exchange hash H from the first key exchange is additionally\n     *  used as the session identifier, which is a unique identifier for\n     *  this connection.\"\n     *\n     *  -- http:\/\/tools.ietf.org\/html\/rfc4253#section-7.2\n     *\n     * @see Net_SSH2::_key_exchange()\n     * @var String\n     * @access private\n     *\/",372],["T_WHITESPACE","\n    ",384],["T_VAR","var",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$session_id",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_STRING","false",385],";",["T_WHITESPACE","\n\n    ",385],["T_DOC_COMMENT","\/**\n     * Message Numbers\n     *\n     * @see Net_SSH2::Net_SSH2()\n     * @var Array\n     * @access private\n     *\/",387],["T_WHITESPACE","\n    ",393],["T_VAR","var",394],["T_WHITESPACE"," ",394],["T_VARIABLE","$message_numbers",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_ARRAY","array",394],"(",")",";",["T_WHITESPACE","\n\n    ",394],["T_DOC_COMMENT","\/**\n     * Disconnection Message 'reason codes' defined in RFC4253\n     *\n     * @see Net_SSH2::Net_SSH2()\n     * @var Array\n     * @access private\n     *\/",396],["T_WHITESPACE","\n    ",402],["T_VAR","var",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$disconnect_reasons",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_ARRAY","array",403],"(",")",";",["T_WHITESPACE","\n\n    ",403],["T_DOC_COMMENT","\/**\n     * SSH_MSG_CHANNEL_OPEN_FAILURE 'reason codes', defined in RFC4254\n     *\n     * @see Net_SSH2::Net_SSH2()\n     * @var Array\n     * @access private\n     *\/",405],["T_WHITESPACE","\n    ",411],["T_VAR","var",412],["T_WHITESPACE"," ",412],["T_VARIABLE","$channel_open_failure_reasons",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_ARRAY","array",412],"(",")",";",["T_WHITESPACE","\n\n    ",412],["T_DOC_COMMENT","\/**\n     * Terminal Modes\n     *\n     * @link http:\/\/tools.ietf.org\/html\/rfc4254#section-8\n     * @see Net_SSH2::Net_SSH2()\n     * @var Array\n     * @access private\n     *\/",414],["T_WHITESPACE","\n    ",421],["T_VAR","var",422],["T_WHITESPACE"," ",422],["T_VARIABLE","$terminal_modes",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_ARRAY","array",422],"(",")",";",["T_WHITESPACE","\n\n    ",422],["T_DOC_COMMENT","\/**\n     * SSH_MSG_CHANNEL_EXTENDED_DATA's data_type_codes\n     *\n     * @link http:\/\/tools.ietf.org\/html\/rfc4254#section-5.2\n     * @see Net_SSH2::Net_SSH2()\n     * @var Array\n     * @access private\n     *\/",424],["T_WHITESPACE","\n    ",431],["T_VAR","var",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$channel_extended_data_type_codes",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_ARRAY","array",432],"(",")",";",["T_WHITESPACE","\n\n    ",432],["T_DOC_COMMENT","\/**\n     * Send Sequence Number\n     *\n     * See 'Section 6.4.  Data Integrity' of rfc4253 for more info.\n     *\n     * @see Net_SSH2::_send_binary_packet()\n     * @var Integer\n     * @access private\n     *\/",434],["T_WHITESPACE","\n    ",442],["T_VAR","var",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$send_seq_no",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_LNUMBER","0",443],";",["T_WHITESPACE","\n\n    ",443],["T_DOC_COMMENT","\/**\n     * Get Sequence Number\n     *\n     * See 'Section 6.4.  Data Integrity' of rfc4253 for more info.\n     *\n     * @see Net_SSH2::_get_binary_packet()\n     * @var Integer\n     * @access private\n     *\/",445],["T_WHITESPACE","\n    ",453],["T_VAR","var",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$get_seq_no",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_LNUMBER","0",454],";",["T_WHITESPACE","\n\n    ",454],["T_DOC_COMMENT","\/**\n     * Server Channels\n     *\n     * Maps client channels to server channels\n     *\n     * @see Net_SSH2::_get_channel_packet()\n     * @see Net_SSH2::exec()\n     * @var Array\n     * @access private\n     *\/",456],["T_WHITESPACE","\n    ",465],["T_VAR","var",466],["T_WHITESPACE"," ",466],["T_VARIABLE","$server_channels",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_ARRAY","array",466],"(",")",";",["T_WHITESPACE","\n\n    ",466],["T_DOC_COMMENT","\/**\n     * Channel Buffers\n     *\n     * If a client requests a packet from one channel but receives two packets from another those packets should\n     * be placed in a buffer\n     *\n     * @see Net_SSH2::_get_channel_packet()\n     * @see Net_SSH2::exec()\n     * @var Array\n     * @access private\n     *\/",468],["T_WHITESPACE","\n    ",478],["T_VAR","var",479],["T_WHITESPACE"," ",479],["T_VARIABLE","$channel_buffers",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_ARRAY","array",479],"(",")",";",["T_WHITESPACE","\n\n    ",479],["T_DOC_COMMENT","\/**\n     * Channel Status\n     *\n     * Contains the type of the last sent message\n     *\n     * @see Net_SSH2::_get_channel_packet()\n     * @var Array\n     * @access private\n     *\/",481],["T_WHITESPACE","\n    ",489],["T_VAR","var",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$channel_status",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_ARRAY","array",490],"(",")",";",["T_WHITESPACE","\n\n    ",490],["T_DOC_COMMENT","\/**\n     * Packet Size\n     *\n     * Maximum packet size indexed by channel\n     *\n     * @see Net_SSH2::_send_channel_packet()\n     * @var Array\n     * @access private\n     *\/",492],["T_WHITESPACE","\n    ",500],["T_VAR","var",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$packet_size_client_to_server",501],["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_ARRAY","array",501],"(",")",";",["T_WHITESPACE","\n\n    ",501],["T_DOC_COMMENT","\/**\n     * Message Number Log\n     *\n     * @see Net_SSH2::getLog()\n     * @var Array\n     * @access private\n     *\/",503],["T_WHITESPACE","\n    ",509],["T_VAR","var",510],["T_WHITESPACE"," ",510],["T_VARIABLE","$message_number_log",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_ARRAY","array",510],"(",")",";",["T_WHITESPACE","\n\n    ",510],["T_DOC_COMMENT","\/**\n     * Message Log\n     *\n     * @see Net_SSH2::getLog()\n     * @var Array\n     * @access private\n     *\/",512],["T_WHITESPACE","\n    ",518],["T_VAR","var",519],["T_WHITESPACE"," ",519],["T_VARIABLE","$message_log",519],["T_WHITESPACE"," ",519],"=",["T_WHITESPACE"," ",519],["T_ARRAY","array",519],"(",")",";",["T_WHITESPACE","\n\n    ",519],["T_DOC_COMMENT","\/**\n     * The Window Size\n     *\n     * Bytes the other party can send before it must wait for the window to be adjusted (0x7FFFFFFF = 4GB)\n     *\n     * @var Integer\n     * @see Net_SSH2::_send_channel_packet()\n     * @see Net_SSH2::exec()\n     * @access private\n     *\/",521],["T_WHITESPACE","\n    ",530],["T_VAR","var",531],["T_WHITESPACE"," ",531],["T_VARIABLE","$window_size",531],["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_LNUMBER","0x7FFFFFFF",531],";",["T_WHITESPACE","\n\n    ",531],["T_DOC_COMMENT","\/**\n     * Window size\n     *\n     * Window size indexed by channel\n     *\n     * @see Net_SSH2::_send_channel_packet()\n     * @var Array\n     * @access private\n     *\/",533],["T_WHITESPACE","\n    ",541],["T_VAR","var",542],["T_WHITESPACE"," ",542],["T_VARIABLE","$window_size_client_to_server",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_ARRAY","array",542],"(",")",";",["T_WHITESPACE","\n\n    ",542],["T_DOC_COMMENT","\/**\n     * Server signature\n     *\n     * Verified against $this->session_id\n     *\n     * @see Net_SSH2::getServerPublicHostKey()\n     * @var String\n     * @access private\n     *\/",544],["T_WHITESPACE","\n    ",552],["T_VAR","var",553],["T_WHITESPACE"," ",553],["T_VARIABLE","$signature",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_CONSTANT_ENCAPSED_STRING","''",553],";",["T_WHITESPACE","\n\n    ",553],["T_DOC_COMMENT","\/**\n     * Server signature format\n     *\n     * ssh-rsa or ssh-dss.\n     *\n     * @see Net_SSH2::getServerPublicHostKey()\n     * @var String\n     * @access private\n     *\/",555],["T_WHITESPACE","\n    ",563],["T_VAR","var",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$signature_format",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","''",564],";",["T_WHITESPACE","\n\n    ",564],["T_DOC_COMMENT","\/**\n     * Default Constructor.\n     *\n     * Connects to an SSHv2 server\n     *\n     * @param String $host\n     * @param optional Integer $port\n     * @param optional Integer $timeout\n     * @return Net_SSH2\n     * @access public\n     *\/",566],["T_WHITESPACE","\n    ",576],["T_FUNCTION","function",577],["T_WHITESPACE"," ",577],["T_STRING","Net_SSH2",577],"(",["T_VARIABLE","$host",577],",",["T_WHITESPACE"," ",577],["T_VARIABLE","$port",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_LNUMBER","22",577],",",["T_WHITESPACE"," ",577],["T_VARIABLE","$timeout",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_LNUMBER","10",577],")",["T_WHITESPACE","\n    ",577],"{",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","message_numbers",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_ARRAY","array",579],"(",["T_WHITESPACE","\n            ",579],["T_LNUMBER","1",580],["T_WHITESPACE"," ",580],["T_DOUBLE_ARROW","=>",580],["T_WHITESPACE"," ",580],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_DISCONNECT'",580],",",["T_WHITESPACE","\n            ",580],["T_LNUMBER","2",581],["T_WHITESPACE"," ",581],["T_DOUBLE_ARROW","=>",581],["T_WHITESPACE"," ",581],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_IGNORE'",581],",",["T_WHITESPACE","\n            ",581],["T_LNUMBER","3",582],["T_WHITESPACE"," ",582],["T_DOUBLE_ARROW","=>",582],["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_UNIMPLEMENTED'",582],",",["T_WHITESPACE","\n            ",582],["T_LNUMBER","4",583],["T_WHITESPACE"," ",583],["T_DOUBLE_ARROW","=>",583],["T_WHITESPACE"," ",583],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_DEBUG'",583],",",["T_WHITESPACE","\n            ",583],["T_LNUMBER","5",584],["T_WHITESPACE"," ",584],["T_DOUBLE_ARROW","=>",584],["T_WHITESPACE"," ",584],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_SERVICE_REQUEST'",584],",",["T_WHITESPACE","\n            ",584],["T_LNUMBER","6",585],["T_WHITESPACE"," ",585],["T_DOUBLE_ARROW","=>",585],["T_WHITESPACE"," ",585],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_SERVICE_ACCEPT'",585],",",["T_WHITESPACE","\n            ",585],["T_LNUMBER","20",586],["T_WHITESPACE"," ",586],["T_DOUBLE_ARROW","=>",586],["T_WHITESPACE"," ",586],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_KEXINIT'",586],",",["T_WHITESPACE","\n            ",586],["T_LNUMBER","21",587],["T_WHITESPACE"," ",587],["T_DOUBLE_ARROW","=>",587],["T_WHITESPACE"," ",587],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_NEWKEYS'",587],",",["T_WHITESPACE","\n            ",587],["T_LNUMBER","30",588],["T_WHITESPACE"," ",588],["T_DOUBLE_ARROW","=>",588],["T_WHITESPACE"," ",588],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_KEXDH_INIT'",588],",",["T_WHITESPACE","\n            ",588],["T_LNUMBER","31",589],["T_WHITESPACE"," ",589],["T_DOUBLE_ARROW","=>",589],["T_WHITESPACE"," ",589],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_KEXDH_REPLY'",589],",",["T_WHITESPACE","\n            ",589],["T_LNUMBER","50",590],["T_WHITESPACE"," ",590],["T_DOUBLE_ARROW","=>",590],["T_WHITESPACE"," ",590],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_REQUEST'",590],",",["T_WHITESPACE","\n            ",590],["T_LNUMBER","51",591],["T_WHITESPACE"," ",591],["T_DOUBLE_ARROW","=>",591],["T_WHITESPACE"," ",591],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_FAILURE'",591],",",["T_WHITESPACE","\n            ",591],["T_LNUMBER","52",592],["T_WHITESPACE"," ",592],["T_DOUBLE_ARROW","=>",592],["T_WHITESPACE"," ",592],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_SUCCESS'",592],",",["T_WHITESPACE","\n            ",592],["T_LNUMBER","53",593],["T_WHITESPACE"," ",593],["T_DOUBLE_ARROW","=>",593],["T_WHITESPACE"," ",593],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_BANNER'",593],",",["T_WHITESPACE","\n\n            ",593],["T_LNUMBER","80",595],["T_WHITESPACE"," ",595],["T_DOUBLE_ARROW","=>",595],["T_WHITESPACE"," ",595],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_GLOBAL_REQUEST'",595],",",["T_WHITESPACE","\n            ",595],["T_LNUMBER","81",596],["T_WHITESPACE"," ",596],["T_DOUBLE_ARROW","=>",596],["T_WHITESPACE"," ",596],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_REQUEST_SUCCESS'",596],",",["T_WHITESPACE","\n            ",596],["T_LNUMBER","82",597],["T_WHITESPACE"," ",597],["T_DOUBLE_ARROW","=>",597],["T_WHITESPACE"," ",597],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_REQUEST_FAILURE'",597],",",["T_WHITESPACE","\n            ",597],["T_LNUMBER","90",598],["T_WHITESPACE"," ",598],["T_DOUBLE_ARROW","=>",598],["T_WHITESPACE"," ",598],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_OPEN'",598],",",["T_WHITESPACE","\n            ",598],["T_LNUMBER","91",599],["T_WHITESPACE"," ",599],["T_DOUBLE_ARROW","=>",599],["T_WHITESPACE"," ",599],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_OPEN_CONFIRMATION'",599],",",["T_WHITESPACE","\n            ",599],["T_LNUMBER","92",600],["T_WHITESPACE"," ",600],["T_DOUBLE_ARROW","=>",600],["T_WHITESPACE"," ",600],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_OPEN_FAILURE'",600],",",["T_WHITESPACE","\n            ",600],["T_LNUMBER","93",601],["T_WHITESPACE"," ",601],["T_DOUBLE_ARROW","=>",601],["T_WHITESPACE"," ",601],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_WINDOW_ADJUST'",601],",",["T_WHITESPACE","\n            ",601],["T_LNUMBER","94",602],["T_WHITESPACE"," ",602],["T_DOUBLE_ARROW","=>",602],["T_WHITESPACE"," ",602],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_DATA'",602],",",["T_WHITESPACE","\n            ",602],["T_LNUMBER","95",603],["T_WHITESPACE"," ",603],["T_DOUBLE_ARROW","=>",603],["T_WHITESPACE"," ",603],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_EXTENDED_DATA'",603],",",["T_WHITESPACE","\n            ",603],["T_LNUMBER","96",604],["T_WHITESPACE"," ",604],["T_DOUBLE_ARROW","=>",604],["T_WHITESPACE"," ",604],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_EOF'",604],",",["T_WHITESPACE","\n            ",604],["T_LNUMBER","97",605],["T_WHITESPACE"," ",605],["T_DOUBLE_ARROW","=>",605],["T_WHITESPACE"," ",605],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_CLOSE'",605],",",["T_WHITESPACE","\n            ",605],["T_LNUMBER","98",606],["T_WHITESPACE"," ",606],["T_DOUBLE_ARROW","=>",606],["T_WHITESPACE"," ",606],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_REQUEST'",606],",",["T_WHITESPACE","\n            ",606],["T_LNUMBER","99",607],["T_WHITESPACE"," ",607],["T_DOUBLE_ARROW","=>",607],["T_WHITESPACE"," ",607],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_SUCCESS'",607],",",["T_WHITESPACE","\n            ",607],["T_LNUMBER","100",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_CHANNEL_FAILURE'",608],["T_WHITESPACE","\n        ",608],")",";",["T_WHITESPACE","\n        ",609],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","disconnect_reasons",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_ARRAY","array",610],"(",["T_WHITESPACE","\n            ",610],["T_LNUMBER","1",611],["T_WHITESPACE"," ",611],["T_DOUBLE_ARROW","=>",611],["T_WHITESPACE"," ",611],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_HOST_NOT_ALLOWED_TO_CONNECT'",611],",",["T_WHITESPACE","\n            ",611],["T_LNUMBER","2",612],["T_WHITESPACE"," ",612],["T_DOUBLE_ARROW","=>",612],["T_WHITESPACE"," ",612],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_PROTOCOL_ERROR'",612],",",["T_WHITESPACE","\n            ",612],["T_LNUMBER","3",613],["T_WHITESPACE"," ",613],["T_DOUBLE_ARROW","=>",613],["T_WHITESPACE"," ",613],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED'",613],",",["T_WHITESPACE","\n            ",613],["T_LNUMBER","4",614],["T_WHITESPACE"," ",614],["T_DOUBLE_ARROW","=>",614],["T_WHITESPACE"," ",614],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_RESERVED'",614],",",["T_WHITESPACE","\n            ",614],["T_LNUMBER","5",615],["T_WHITESPACE"," ",615],["T_DOUBLE_ARROW","=>",615],["T_WHITESPACE"," ",615],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_MAC_ERROR'",615],",",["T_WHITESPACE","\n            ",615],["T_LNUMBER","6",616],["T_WHITESPACE"," ",616],["T_DOUBLE_ARROW","=>",616],["T_WHITESPACE"," ",616],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_COMPRESSION_ERROR'",616],",",["T_WHITESPACE","\n            ",616],["T_LNUMBER","7",617],["T_WHITESPACE"," ",617],["T_DOUBLE_ARROW","=>",617],["T_WHITESPACE"," ",617],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_SERVICE_NOT_AVAILABLE'",617],",",["T_WHITESPACE","\n            ",617],["T_LNUMBER","8",618],["T_WHITESPACE"," ",618],["T_DOUBLE_ARROW","=>",618],["T_WHITESPACE"," ",618],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_PROTOCOL_VERSION_NOT_SUPPORTED'",618],",",["T_WHITESPACE","\n            ",618],["T_LNUMBER","9",619],["T_WHITESPACE"," ",619],["T_DOUBLE_ARROW","=>",619],["T_WHITESPACE"," ",619],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_HOST_KEY_NOT_VERIFIABLE'",619],",",["T_WHITESPACE","\n            ",619],["T_LNUMBER","10",620],["T_WHITESPACE"," ",620],["T_DOUBLE_ARROW","=>",620],["T_WHITESPACE"," ",620],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_CONNECTION_LOST'",620],",",["T_WHITESPACE","\n            ",620],["T_LNUMBER","11",621],["T_WHITESPACE"," ",621],["T_DOUBLE_ARROW","=>",621],["T_WHITESPACE"," ",621],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_BY_APPLICATION'",621],",",["T_WHITESPACE","\n            ",621],["T_LNUMBER","12",622],["T_WHITESPACE"," ",622],["T_DOUBLE_ARROW","=>",622],["T_WHITESPACE"," ",622],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_TOO_MANY_CONNECTIONS'",622],",",["T_WHITESPACE","\n            ",622],["T_LNUMBER","13",623],["T_WHITESPACE"," ",623],["T_DOUBLE_ARROW","=>",623],["T_WHITESPACE"," ",623],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_AUTH_CANCELLED_BY_USER'",623],",",["T_WHITESPACE","\n            ",623],["T_LNUMBER","14",624],["T_WHITESPACE"," ",624],["T_DOUBLE_ARROW","=>",624],["T_WHITESPACE"," ",624],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_NO_MORE_AUTH_METHODS_AVAILABLE'",624],",",["T_WHITESPACE","\n            ",624],["T_LNUMBER","15",625],["T_WHITESPACE"," ",625],["T_DOUBLE_ARROW","=>",625],["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_DISCONNECT_ILLEGAL_USER_NAME'",625],["T_WHITESPACE","\n        ",625],")",";",["T_WHITESPACE","\n        ",626],["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","channel_open_failure_reasons",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_ARRAY","array",627],"(",["T_WHITESPACE","\n            ",627],["T_LNUMBER","1",628],["T_WHITESPACE"," ",628],["T_DOUBLE_ARROW","=>",628],["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_OPEN_ADMINISTRATIVELY_PROHIBITED'",628],["T_WHITESPACE","\n        ",628],")",";",["T_WHITESPACE","\n        ",629],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","terminal_modes",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_ARRAY","array",630],"(",["T_WHITESPACE","\n            ",630],["T_LNUMBER","0",631],["T_WHITESPACE"," ",631],["T_DOUBLE_ARROW","=>",631],["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_TTY_OP_END'",631],["T_WHITESPACE","\n        ",631],")",";",["T_WHITESPACE","\n        ",632],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","channel_extended_data_type_codes",633],["T_WHITESPACE"," ",633],"=",["T_WHITESPACE"," ",633],["T_ARRAY","array",633],"(",["T_WHITESPACE","\n            ",633],["T_LNUMBER","1",634],["T_WHITESPACE"," ",634],["T_DOUBLE_ARROW","=>",634],["T_WHITESPACE"," ",634],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_EXTENDED_DATA_STDERR'",634],["T_WHITESPACE","\n        ",634],")",";",["T_WHITESPACE","\n\n        ",635],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","_define_array",637],"(",["T_WHITESPACE","\n            ",637],["T_VARIABLE","$this",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","message_numbers",638],",",["T_WHITESPACE","\n            ",638],["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","disconnect_reasons",639],",",["T_WHITESPACE","\n            ",639],["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","channel_open_failure_reasons",640],",",["T_WHITESPACE","\n            ",640],["T_VARIABLE","$this",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","terminal_modes",641],",",["T_WHITESPACE","\n            ",641],["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","channel_extended_data_type_codes",642],",",["T_WHITESPACE","\n            ",642],["T_ARRAY","array",643],"(",["T_LNUMBER","60",643],["T_WHITESPACE"," ",643],["T_DOUBLE_ARROW","=>",643],["T_WHITESPACE"," ",643],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_PASSWD_CHANGEREQ'",643],")",",",["T_WHITESPACE","\n            ",643],["T_ARRAY","array",644],"(",["T_LNUMBER","60",644],["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_PK_OK'",644],")",["T_WHITESPACE","\n        ",644],")",";",["T_WHITESPACE","\n\n        ",645],["T_VARIABLE","$this",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","fsock",647],["T_WHITESPACE"," ",647],"=",["T_WHITESPACE"," ",647],"@",["T_STRING","fsockopen",647],"(",["T_VARIABLE","$host",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$port",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$errno",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$errstr",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$timeout",647],")",";",["T_WHITESPACE","\n        ",647],["T_IF","if",648],["T_WHITESPACE"," ",648],"(","!",["T_VARIABLE","$this",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","fsock",648],")",["T_WHITESPACE"," ",648],"{",["T_WHITESPACE","\n            ",648],["T_STRING","user_error",649],"(",["T_STRING","rtrim",649],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Cannot connect to ",649],["T_VARIABLE","$host",649],["T_ENCAPSED_AND_WHITESPACE",". Error ",649],["T_VARIABLE","$errno",649],["T_ENCAPSED_AND_WHITESPACE",". ",649],["T_VARIABLE","$errstr",649],"\"",")",",",["T_WHITESPACE"," ",649],["T_STRING","E_USER_NOTICE",649],")",";",["T_WHITESPACE","\n            ",649],["T_RETURN","return",650],";",["T_WHITESPACE","\n        ",650],"}",["T_WHITESPACE","\n\n        ",651],["T_COMMENT","\/* According to the SSH2 specs,\n\n          \"The server MAY send other lines of data before sending the version\n           string.  Each line SHOULD be terminated by a Carriage Return and Line\n           Feed.  Such lines MUST NOT begin with \"SSH-\", and SHOULD be encoded\n           in ISO-10646 UTF-8 [RFC3629] (language is not specified).  Clients\n           MUST be able to process such lines.\" *\/",653],["T_WHITESPACE","\n        ",659],["T_VARIABLE","$temp",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","''",660],";",["T_WHITESPACE","\n        ",660],["T_VARIABLE","$extra",661],["T_WHITESPACE"," ",661],"=",["T_WHITESPACE"," ",661],["T_CONSTANT_ENCAPSED_STRING","''",661],";",["T_WHITESPACE","\n        ",661],["T_WHILE","while",662],["T_WHITESPACE"," ",662],"(","!",["T_STRING","feof",662],"(",["T_VARIABLE","$this",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","fsock",662],")",["T_WHITESPACE"," ",662],["T_BOOLEAN_AND","&&",662],["T_WHITESPACE"," ",662],"!",["T_STRING","preg_match",662],"(",["T_CONSTANT_ENCAPSED_STRING","'#^SSH-(\\d\\.\\d+)#'",662],",",["T_WHITESPACE"," ",662],["T_VARIABLE","$temp",662],",",["T_WHITESPACE"," ",662],["T_VARIABLE","$matches",662],")",")",["T_WHITESPACE"," ",662],"{",["T_WHITESPACE","\n            ",662],["T_IF","if",663],["T_WHITESPACE"," ",663],"(",["T_STRING","substr",663],"(",["T_VARIABLE","$temp",663],",",["T_WHITESPACE"," ",663],"-",["T_LNUMBER","2",663],")",["T_WHITESPACE"," ",663],["T_IS_EQUAL","==",663],["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",663],")",["T_WHITESPACE"," ",663],"{",["T_WHITESPACE","\n                ",663],["T_VARIABLE","$extra",664],["T_CONCAT_EQUAL",".=",664],["T_WHITESPACE"," ",664],["T_VARIABLE","$temp",664],";",["T_WHITESPACE","\n                ",664],["T_VARIABLE","$temp",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","''",665],";",["T_WHITESPACE","\n            ",665],"}",["T_WHITESPACE","\n            ",666],["T_VARIABLE","$temp",667],["T_CONCAT_EQUAL",".=",667],["T_WHITESPACE"," ",667],["T_STRING","fgets",667],"(",["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","fsock",667],",",["T_WHITESPACE"," ",667],["T_LNUMBER","255",667],")",";",["T_WHITESPACE","\n        ",667],"}",["T_WHITESPACE","\n\n        ",668],["T_VARIABLE","$ext",670],["T_WHITESPACE"," ",670],"=",["T_WHITESPACE"," ",670],["T_ARRAY","array",670],"(",")",";",["T_WHITESPACE","\n        ",670],["T_IF","if",671],["T_WHITESPACE"," ",671],"(",["T_STRING","extension_loaded",671],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",671],")",")",["T_WHITESPACE"," ",671],"{",["T_WHITESPACE","\n            ",671],["T_VARIABLE","$ext",672],"[","]",["T_WHITESPACE"," ",672],"=",["T_WHITESPACE"," ",672],["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",672],";",["T_WHITESPACE","\n        ",672],"}",["T_WHITESPACE","\n        ",673],["T_IF","if",674],["T_WHITESPACE"," ",674],"(",["T_STRING","extension_loaded",674],"(",["T_CONSTANT_ENCAPSED_STRING","'gmp'",674],")",")",["T_WHITESPACE"," ",674],"{",["T_WHITESPACE","\n            ",674],["T_VARIABLE","$ext",675],"[","]",["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_CONSTANT_ENCAPSED_STRING","'gmp'",675],";",["T_WHITESPACE","\n        ",675],"}",["T_WHITESPACE"," ",676],["T_ELSE","else",676],["T_WHITESPACE"," ",676],["T_IF","if",676],["T_WHITESPACE"," ",676],"(",["T_STRING","extension_loaded",676],"(",["T_CONSTANT_ENCAPSED_STRING","'bcmath'",676],")",")",["T_WHITESPACE"," ",676],"{",["T_WHITESPACE","\n            ",676],["T_VARIABLE","$ext",677],"[","]",["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'bcmath'",677],";",["T_WHITESPACE","\n        ",677],"}",["T_WHITESPACE","\n\n        ",678],["T_IF","if",680],["T_WHITESPACE"," ",680],"(","!",["T_EMPTY","empty",680],"(",["T_VARIABLE","$ext",680],")",")",["T_WHITESPACE"," ",680],"{",["T_WHITESPACE","\n            ",680],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","identifier",681],["T_CONCAT_EQUAL",".=",681],["T_WHITESPACE"," ",681],["T_CONSTANT_ENCAPSED_STRING","' ('",681],["T_WHITESPACE"," ",681],".",["T_WHITESPACE"," ",681],["T_STRING","implode",681],"(",["T_CONSTANT_ENCAPSED_STRING","', '",681],",",["T_WHITESPACE"," ",681],["T_VARIABLE","$ext",681],")",["T_WHITESPACE"," ",681],".",["T_WHITESPACE"," ",681],["T_CONSTANT_ENCAPSED_STRING","')'",681],";",["T_WHITESPACE","\n        ",681],"}",["T_WHITESPACE","\n\n        ",682],["T_IF","if",684],["T_WHITESPACE"," ",684],"(",["T_STRING","defined",684],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",684],")",")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n            ",684],["T_VARIABLE","$this",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","message_number_log",685],"[","]",["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_CONSTANT_ENCAPSED_STRING","'<-'",685],";",["T_WHITESPACE","\n            ",685],["T_VARIABLE","$this",686],["T_OBJECT_OPERATOR","->",686],["T_STRING","message_number_log",686],"[","]",["T_WHITESPACE"," ",686],"=",["T_WHITESPACE"," ",686],["T_CONSTANT_ENCAPSED_STRING","'->'",686],";",["T_WHITESPACE","\n\n            ",686],["T_IF","if",688],["T_WHITESPACE"," ",688],"(",["T_STRING","NET_SSH2_LOGGING",688],["T_WHITESPACE"," ",688],["T_IS_EQUAL","==",688],["T_WHITESPACE"," ",688],["T_STRING","NET_SSH2_LOG_COMPLEX",688],")",["T_WHITESPACE"," ",688],"{",["T_WHITESPACE","\n                ",688],["T_VARIABLE","$this",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","message_log",689],"[","]",["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_VARIABLE","$temp",689],";",["T_WHITESPACE","\n                ",689],["T_VARIABLE","$this",690],["T_OBJECT_OPERATOR","->",690],["T_STRING","message_log",690],"[","]",["T_WHITESPACE"," ",690],"=",["T_WHITESPACE"," ",690],["T_VARIABLE","$this",690],["T_OBJECT_OPERATOR","->",690],["T_STRING","identifier",690],["T_WHITESPACE"," ",690],".",["T_WHITESPACE"," ",690],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",690],";",["T_WHITESPACE","\n            ",690],"}",["T_WHITESPACE","\n        ",691],"}",["T_WHITESPACE","\n\n        ",692],["T_VARIABLE","$this",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","server_identifier",694],["T_WHITESPACE"," ",694],"=",["T_WHITESPACE"," ",694],["T_STRING","trim",694],"(",["T_VARIABLE","$temp",694],",",["T_WHITESPACE"," ",694],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",694],")",";",["T_WHITESPACE","\n        ",694],["T_IF","if",695],["T_WHITESPACE"," ",695],"(","!",["T_EMPTY","empty",695],"(",["T_VARIABLE","$extra",695],")",")",["T_WHITESPACE"," ",695],"{",["T_WHITESPACE","\n            ",695],["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","errors",696],"[","]",["T_WHITESPACE"," ",696],"=",["T_WHITESPACE"," ",696],["T_STRING","utf8_decode",696],"(",["T_VARIABLE","$extra",696],")",";",["T_WHITESPACE","\n        ",696],"}",["T_WHITESPACE","\n\n        ",697],["T_IF","if",699],["T_WHITESPACE"," ",699],"(",["T_VARIABLE","$matches",699],"[",["T_LNUMBER","1",699],"]",["T_WHITESPACE"," ",699],["T_IS_NOT_EQUAL","!=",699],["T_WHITESPACE"," ",699],["T_CONSTANT_ENCAPSED_STRING","'1.99'",699],["T_WHITESPACE"," ",699],["T_BOOLEAN_AND","&&",699],["T_WHITESPACE"," ",699],["T_VARIABLE","$matches",699],"[",["T_LNUMBER","1",699],"]",["T_WHITESPACE"," ",699],["T_IS_NOT_EQUAL","!=",699],["T_WHITESPACE"," ",699],["T_CONSTANT_ENCAPSED_STRING","'2.0'",699],")",["T_WHITESPACE"," ",699],"{",["T_WHITESPACE","\n            ",699],["T_STRING","user_error",700],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Cannot connect to SSH ",700],["T_VARIABLE","$matches",700],"[",["T_NUM_STRING","1",700],"]",["T_ENCAPSED_AND_WHITESPACE"," servers",700],"\"",",",["T_WHITESPACE"," ",700],["T_STRING","E_USER_NOTICE",700],")",";",["T_WHITESPACE","\n            ",700],["T_RETURN","return",701],";",["T_WHITESPACE","\n        ",701],"}",["T_WHITESPACE","\n\n        ",702],["T_STRING","fputs",704],"(",["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","fsock",704],",",["T_WHITESPACE"," ",704],["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","identifier",704],["T_WHITESPACE"," ",704],".",["T_WHITESPACE"," ",704],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",704],")",";",["T_WHITESPACE","\n\n        ",704],["T_VARIABLE","$response",706],["T_WHITESPACE"," ",706],"=",["T_WHITESPACE"," ",706],["T_VARIABLE","$this",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","_get_binary_packet",706],"(",")",";",["T_WHITESPACE","\n        ",706],["T_IF","if",707],["T_WHITESPACE"," ",707],"(",["T_VARIABLE","$response",707],["T_WHITESPACE"," ",707],["T_IS_IDENTICAL","===",707],["T_WHITESPACE"," ",707],["T_STRING","false",707],")",["T_WHITESPACE"," ",707],"{",["T_WHITESPACE","\n            ",707],["T_STRING","user_error",708],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",708],",",["T_WHITESPACE"," ",708],["T_STRING","E_USER_NOTICE",708],")",";",["T_WHITESPACE","\n            ",708],["T_RETURN","return",709],";",["T_WHITESPACE","\n        ",709],"}",["T_WHITESPACE","\n\n        ",710],["T_IF","if",712],["T_WHITESPACE"," ",712],"(",["T_STRING","ord",712],"(",["T_VARIABLE","$response",712],"[",["T_LNUMBER","0",712],"]",")",["T_WHITESPACE"," ",712],["T_IS_NOT_EQUAL","!=",712],["T_WHITESPACE"," ",712],["T_STRING","NET_SSH2_MSG_KEXINIT",712],")",["T_WHITESPACE"," ",712],"{",["T_WHITESPACE","\n            ",712],["T_STRING","user_error",713],"(",["T_CONSTANT_ENCAPSED_STRING","'Expected SSH_MSG_KEXINIT'",713],",",["T_WHITESPACE"," ",713],["T_STRING","E_USER_NOTICE",713],")",";",["T_WHITESPACE","\n            ",713],["T_RETURN","return",714],";",["T_WHITESPACE","\n        ",714],"}",["T_WHITESPACE","\n\n        ",715],["T_IF","if",717],["T_WHITESPACE"," ",717],"(","!",["T_VARIABLE","$this",717],["T_OBJECT_OPERATOR","->",717],["T_STRING","_key_exchange",717],"(",["T_VARIABLE","$response",717],")",")",["T_WHITESPACE"," ",717],"{",["T_WHITESPACE","\n            ",717],["T_RETURN","return",718],";",["T_WHITESPACE","\n        ",718],"}",["T_WHITESPACE","\n\n        ",719],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","bitmap",721],["T_WHITESPACE"," ",721],"=",["T_WHITESPACE"," ",721],["T_STRING","NET_SSH2_MASK_CONSTRUCTOR",721],";",["T_WHITESPACE","\n    ",721],"}",["T_WHITESPACE","\n\n    ",722],["T_DOC_COMMENT","\/**\n     * Key Exchange\n     *\n     * @param String $kexinit_payload_server\n     * @access private\n     *\/",724],["T_WHITESPACE","\n    ",729],["T_FUNCTION","function",730],["T_WHITESPACE"," ",730],["T_STRING","_key_exchange",730],"(",["T_VARIABLE","$kexinit_payload_server",730],")",["T_WHITESPACE","\n    ",730],"{",["T_WHITESPACE","\n        ",731],["T_STATIC","static",732],["T_WHITESPACE"," ",732],["T_VARIABLE","$kex_algorithms",732],["T_WHITESPACE"," ",732],"=",["T_WHITESPACE"," ",732],["T_ARRAY","array",732],"(",["T_WHITESPACE","\n            ",732],["T_CONSTANT_ENCAPSED_STRING","'diffie-hellman-group1-sha1'",733],",",["T_WHITESPACE"," ",733],["T_COMMENT","\/\/ REQUIRED\n",733],["T_WHITESPACE","            ",734],["T_CONSTANT_ENCAPSED_STRING","'diffie-hellman-group14-sha1'",734],["T_WHITESPACE"," ",734],["T_COMMENT","\/\/ REQUIRED\n",734],["T_WHITESPACE","        ",735],")",";",["T_WHITESPACE","\n\n        ",735],["T_STATIC","static",737],["T_WHITESPACE"," ",737],["T_VARIABLE","$server_host_key_algorithms",737],["T_WHITESPACE"," ",737],"=",["T_WHITESPACE"," ",737],["T_ARRAY","array",737],"(",["T_WHITESPACE","\n            ",737],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",738],",",["T_WHITESPACE"," ",738],["T_COMMENT","\/\/ RECOMMENDED  sign   Raw RSA Key\n",738],["T_WHITESPACE","            ",739],["T_CONSTANT_ENCAPSED_STRING","'ssh-dss'",739],["T_WHITESPACE","  ",739],["T_COMMENT","\/\/ REQUIRED     sign   Raw DSS Key\n",739],["T_WHITESPACE","        ",740],")",";",["T_WHITESPACE","\n\n        ",740],["T_STATIC","static",742],["T_WHITESPACE"," ",742],["T_VARIABLE","$encryption_algorithms",742],["T_WHITESPACE"," ",742],"=",["T_WHITESPACE"," ",742],["T_ARRAY","array",742],"(",["T_WHITESPACE","\n            ",742],["T_COMMENT","\/\/ from <http:\/\/tools.ietf.org\/html\/rfc4345#section-4>:\n",743],["T_WHITESPACE","            ",744],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",744],",",["T_WHITESPACE","\n            ",744],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",745],",",["T_WHITESPACE","\n\n            ",745],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",747],",",["T_WHITESPACE","    ",747],["T_COMMENT","\/\/ OPTIONAL          the ARCFOUR stream cipher with a 128-bit key\n",747],["T_WHITESPACE","\n            ",748],["T_CONSTANT_ENCAPSED_STRING","'aes128-cbc'",749],",",["T_WHITESPACE"," ",749],["T_COMMENT","\/\/ RECOMMENDED       AES with a 128-bit key\n",749],["T_WHITESPACE","            ",750],["T_CONSTANT_ENCAPSED_STRING","'aes192-cbc'",750],",",["T_WHITESPACE"," ",750],["T_COMMENT","\/\/ OPTIONAL          AES with a 192-bit key\n",750],["T_WHITESPACE","            ",751],["T_CONSTANT_ENCAPSED_STRING","'aes256-cbc'",751],",",["T_WHITESPACE"," ",751],["T_COMMENT","\/\/ OPTIONAL          AES in CBC mode, with a 256-bit key\n",751],["T_WHITESPACE","\n            ",752],["T_COMMENT","\/\/ from <http:\/\/tools.ietf.org\/html\/rfc4344#section-4>:\n",753],["T_WHITESPACE","            ",754],["T_CONSTANT_ENCAPSED_STRING","'aes128-ctr'",754],",",["T_WHITESPACE"," ",754],["T_COMMENT","\/\/ RECOMMENDED       AES (Rijndael) in SDCTR mode, with 128-bit key\n",754],["T_WHITESPACE","            ",755],["T_CONSTANT_ENCAPSED_STRING","'aes192-ctr'",755],",",["T_WHITESPACE"," ",755],["T_COMMENT","\/\/ RECOMMENDED       AES with 192-bit key\n",755],["T_WHITESPACE","            ",756],["T_CONSTANT_ENCAPSED_STRING","'aes256-ctr'",756],",",["T_WHITESPACE"," ",756],["T_COMMENT","\/\/ RECOMMENDED       AES with 256-bit key\n",756],["T_WHITESPACE","            ",757],["T_CONSTANT_ENCAPSED_STRING","'3des-ctr'",757],",",["T_WHITESPACE","   ",757],["T_COMMENT","\/\/ RECOMMENDED       Three-key 3DES in SDCTR mode\n",757],["T_WHITESPACE","\n            ",758],["T_CONSTANT_ENCAPSED_STRING","'3des-cbc'",759],",",["T_WHITESPACE","   ",759],["T_COMMENT","\/\/ REQUIRED          three-key 3DES in CBC mode\n",759],["T_WHITESPACE","            ",760],["T_CONSTANT_ENCAPSED_STRING","'none'",760],["T_WHITESPACE","        ",760],["T_COMMENT","\/\/ OPTIONAL          no encryption; NOT RECOMMENDED\n",760],["T_WHITESPACE","        ",761],")",";",["T_WHITESPACE","\n\n        ",761],["T_STATIC","static",763],["T_WHITESPACE"," ",763],["T_VARIABLE","$mac_algorithms",763],["T_WHITESPACE"," ",763],"=",["T_WHITESPACE"," ",763],["T_ARRAY","array",763],"(",["T_WHITESPACE","\n            ",763],["T_CONSTANT_ENCAPSED_STRING","'hmac-sha1-96'",764],",",["T_WHITESPACE"," ",764],["T_COMMENT","\/\/ RECOMMENDED     first 96 bits of HMAC-SHA1 (digest length = 12, key length = 20)\n",764],["T_WHITESPACE","            ",765],["T_CONSTANT_ENCAPSED_STRING","'hmac-sha1'",765],",",["T_WHITESPACE","    ",765],["T_COMMENT","\/\/ REQUIRED        HMAC-SHA1 (digest length = key length = 20)\n",765],["T_WHITESPACE","            ",766],["T_CONSTANT_ENCAPSED_STRING","'hmac-md5-96'",766],",",["T_WHITESPACE","  ",766],["T_COMMENT","\/\/ OPTIONAL        first 96 bits of HMAC-MD5 (digest length = 12, key length = 16)\n",766],["T_WHITESPACE","            ",767],["T_CONSTANT_ENCAPSED_STRING","'hmac-md5'",767],",",["T_WHITESPACE","     ",767],["T_COMMENT","\/\/ OPTIONAL        HMAC-MD5 (digest length = key length = 16)\n",767],["T_WHITESPACE","            ",768],["T_CONSTANT_ENCAPSED_STRING","'none'",768],["T_WHITESPACE","          ",768],["T_COMMENT","\/\/ OPTIONAL        no MAC; NOT RECOMMENDED\n",768],["T_WHITESPACE","        ",769],")",";",["T_WHITESPACE","\n\n        ",769],["T_STATIC","static",771],["T_WHITESPACE"," ",771],["T_VARIABLE","$compression_algorithms",771],["T_WHITESPACE"," ",771],"=",["T_WHITESPACE"," ",771],["T_ARRAY","array",771],"(",["T_WHITESPACE","\n            ",771],["T_CONSTANT_ENCAPSED_STRING","'none'",772],["T_WHITESPACE","   ",772],["T_COMMENT","\/\/ REQUIRED        no compression\n",772],["T_WHITESPACE","            ",773],["T_COMMENT","\/\/'zlib' \/\/ OPTIONAL        ZLIB (LZ77) compression\n",773],["T_WHITESPACE","        ",774],")",";",["T_WHITESPACE","\n\n        ",774],["T_STATIC","static",776],["T_WHITESPACE"," ",776],["T_VARIABLE","$str_kex_algorithms",776],",",["T_WHITESPACE"," ",776],["T_VARIABLE","$str_server_host_key_algorithms",776],",",["T_WHITESPACE","\n               ",776],["T_VARIABLE","$encryption_algorithms_server_to_client",777],",",["T_WHITESPACE"," ",777],["T_VARIABLE","$mac_algorithms_server_to_client",777],",",["T_WHITESPACE"," ",777],["T_VARIABLE","$compression_algorithms_server_to_client",777],",",["T_WHITESPACE","\n               ",777],["T_VARIABLE","$encryption_algorithms_client_to_server",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$mac_algorithms_client_to_server",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$compression_algorithms_client_to_server",778],";",["T_WHITESPACE","\n\n        ",778],["T_IF","if",780],["T_WHITESPACE"," ",780],"(",["T_EMPTY","empty",780],"(",["T_VARIABLE","$str_kex_algorithms",780],")",")",["T_WHITESPACE"," ",780],"{",["T_WHITESPACE","\n            ",780],["T_VARIABLE","$str_kex_algorithms",781],["T_WHITESPACE"," ",781],"=",["T_WHITESPACE"," ",781],["T_STRING","implode",781],"(",["T_CONSTANT_ENCAPSED_STRING","','",781],",",["T_WHITESPACE"," ",781],["T_VARIABLE","$kex_algorithms",781],")",";",["T_WHITESPACE","\n            ",781],["T_VARIABLE","$str_server_host_key_algorithms",782],["T_WHITESPACE"," ",782],"=",["T_WHITESPACE"," ",782],["T_STRING","implode",782],"(",["T_CONSTANT_ENCAPSED_STRING","','",782],",",["T_WHITESPACE"," ",782],["T_VARIABLE","$server_host_key_algorithms",782],")",";",["T_WHITESPACE","\n            ",782],["T_VARIABLE","$encryption_algorithms_server_to_client",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],["T_VARIABLE","$encryption_algorithms_client_to_server",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],["T_STRING","implode",783],"(",["T_CONSTANT_ENCAPSED_STRING","','",783],",",["T_WHITESPACE"," ",783],["T_VARIABLE","$encryption_algorithms",783],")",";",["T_WHITESPACE","\n            ",783],["T_VARIABLE","$mac_algorithms_server_to_client",784],["T_WHITESPACE"," ",784],"=",["T_WHITESPACE"," ",784],["T_VARIABLE","$mac_algorithms_client_to_server",784],["T_WHITESPACE"," ",784],"=",["T_WHITESPACE"," ",784],["T_STRING","implode",784],"(",["T_CONSTANT_ENCAPSED_STRING","','",784],",",["T_WHITESPACE"," ",784],["T_VARIABLE","$mac_algorithms",784],")",";",["T_WHITESPACE","\n            ",784],["T_VARIABLE","$compression_algorithms_server_to_client",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_VARIABLE","$compression_algorithms_client_to_server",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_STRING","implode",785],"(",["T_CONSTANT_ENCAPSED_STRING","','",785],",",["T_WHITESPACE"," ",785],["T_VARIABLE","$compression_algorithms",785],")",";",["T_WHITESPACE","\n        ",785],"}",["T_WHITESPACE","\n\n        ",786],["T_VARIABLE","$client_cookie",788],["T_WHITESPACE"," ",788],"=",["T_WHITESPACE"," ",788],["T_CONSTANT_ENCAPSED_STRING","''",788],";",["T_WHITESPACE","\n        ",788],["T_FOR","for",789],["T_WHITESPACE"," ",789],"(",["T_VARIABLE","$i",789],["T_WHITESPACE"," ",789],"=",["T_WHITESPACE"," ",789],["T_LNUMBER","0",789],";",["T_WHITESPACE"," ",789],["T_VARIABLE","$i",789],["T_WHITESPACE"," ",789],"<",["T_WHITESPACE"," ",789],["T_LNUMBER","16",789],";",["T_WHITESPACE"," ",789],["T_VARIABLE","$i",789],["T_INC","++",789],")",["T_WHITESPACE"," ",789],"{",["T_WHITESPACE","\n            ",789],["T_VARIABLE","$client_cookie",790],["T_CONCAT_EQUAL",".=",790],["T_WHITESPACE"," ",790],["T_STRING","chr",790],"(",["T_STRING","crypt_random",790],"(",["T_LNUMBER","0",790],",",["T_WHITESPACE"," ",790],["T_LNUMBER","255",790],")",")",";",["T_WHITESPACE","\n        ",790],"}",["T_WHITESPACE","\n\n        ",791],["T_VARIABLE","$response",793],["T_WHITESPACE"," ",793],"=",["T_WHITESPACE"," ",793],["T_VARIABLE","$kexinit_payload_server",793],";",["T_WHITESPACE","\n        ",793],["T_VARIABLE","$this",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","_string_shift",794],"(",["T_VARIABLE","$response",794],",",["T_WHITESPACE"," ",794],["T_LNUMBER","1",794],")",";",["T_WHITESPACE"," ",794],["T_COMMENT","\/\/ skip past the message number (it should be SSH_MSG_KEXINIT)\n",794],["T_WHITESPACE","        ",795],["T_VARIABLE","$server_cookie",795],["T_WHITESPACE"," ",795],"=",["T_WHITESPACE"," ",795],["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","_string_shift",795],"(",["T_VARIABLE","$response",795],",",["T_WHITESPACE"," ",795],["T_LNUMBER","16",795],")",";",["T_WHITESPACE","\n\n        ",795],["T_VARIABLE","$temp",797],["T_WHITESPACE"," ",797],"=",["T_WHITESPACE"," ",797],["T_STRING","unpack",797],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",797],",",["T_WHITESPACE"," ",797],["T_VARIABLE","$this",797],["T_OBJECT_OPERATOR","->",797],["T_STRING","_string_shift",797],"(",["T_VARIABLE","$response",797],",",["T_WHITESPACE"," ",797],["T_LNUMBER","4",797],")",")",";",["T_WHITESPACE","\n        ",797],["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","kex_algorithms",798],["T_WHITESPACE"," ",798],"=",["T_WHITESPACE"," ",798],["T_STRING","explode",798],"(",["T_CONSTANT_ENCAPSED_STRING","','",798],",",["T_WHITESPACE"," ",798],["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","_string_shift",798],"(",["T_VARIABLE","$response",798],",",["T_WHITESPACE"," ",798],["T_VARIABLE","$temp",798],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",798],"]",")",")",";",["T_WHITESPACE","\n\n        ",798],["T_VARIABLE","$temp",800],["T_WHITESPACE"," ",800],"=",["T_WHITESPACE"," ",800],["T_STRING","unpack",800],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",800],",",["T_WHITESPACE"," ",800],["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","_string_shift",800],"(",["T_VARIABLE","$response",800],",",["T_WHITESPACE"," ",800],["T_LNUMBER","4",800],")",")",";",["T_WHITESPACE","\n        ",800],["T_VARIABLE","$this",801],["T_OBJECT_OPERATOR","->",801],["T_STRING","server_host_key_algorithms",801],["T_WHITESPACE"," ",801],"=",["T_WHITESPACE"," ",801],["T_STRING","explode",801],"(",["T_CONSTANT_ENCAPSED_STRING","','",801],",",["T_WHITESPACE"," ",801],["T_VARIABLE","$this",801],["T_OBJECT_OPERATOR","->",801],["T_STRING","_string_shift",801],"(",["T_VARIABLE","$response",801],",",["T_WHITESPACE"," ",801],["T_VARIABLE","$temp",801],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",801],"]",")",")",";",["T_WHITESPACE","\n\n        ",801],["T_VARIABLE","$temp",803],["T_WHITESPACE"," ",803],"=",["T_WHITESPACE"," ",803],["T_STRING","unpack",803],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",803],",",["T_WHITESPACE"," ",803],["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","_string_shift",803],"(",["T_VARIABLE","$response",803],",",["T_WHITESPACE"," ",803],["T_LNUMBER","4",803],")",")",";",["T_WHITESPACE","\n        ",803],["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","encryption_algorithms_client_to_server",804],["T_WHITESPACE"," ",804],"=",["T_WHITESPACE"," ",804],["T_STRING","explode",804],"(",["T_CONSTANT_ENCAPSED_STRING","','",804],",",["T_WHITESPACE"," ",804],["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","_string_shift",804],"(",["T_VARIABLE","$response",804],",",["T_WHITESPACE"," ",804],["T_VARIABLE","$temp",804],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",804],"]",")",")",";",["T_WHITESPACE","\n\n        ",804],["T_VARIABLE","$temp",806],["T_WHITESPACE"," ",806],"=",["T_WHITESPACE"," ",806],["T_STRING","unpack",806],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",806],",",["T_WHITESPACE"," ",806],["T_VARIABLE","$this",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","_string_shift",806],"(",["T_VARIABLE","$response",806],",",["T_WHITESPACE"," ",806],["T_LNUMBER","4",806],")",")",";",["T_WHITESPACE","\n        ",806],["T_VARIABLE","$this",807],["T_OBJECT_OPERATOR","->",807],["T_STRING","encryption_algorithms_server_to_client",807],["T_WHITESPACE"," ",807],"=",["T_WHITESPACE"," ",807],["T_STRING","explode",807],"(",["T_CONSTANT_ENCAPSED_STRING","','",807],",",["T_WHITESPACE"," ",807],["T_VARIABLE","$this",807],["T_OBJECT_OPERATOR","->",807],["T_STRING","_string_shift",807],"(",["T_VARIABLE","$response",807],",",["T_WHITESPACE"," ",807],["T_VARIABLE","$temp",807],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",807],"]",")",")",";",["T_WHITESPACE","\n\n        ",807],["T_VARIABLE","$temp",809],["T_WHITESPACE"," ",809],"=",["T_WHITESPACE"," ",809],["T_STRING","unpack",809],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",809],",",["T_WHITESPACE"," ",809],["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","_string_shift",809],"(",["T_VARIABLE","$response",809],",",["T_WHITESPACE"," ",809],["T_LNUMBER","4",809],")",")",";",["T_WHITESPACE","\n        ",809],["T_VARIABLE","$this",810],["T_OBJECT_OPERATOR","->",810],["T_STRING","mac_algorithms_client_to_server",810],["T_WHITESPACE"," ",810],"=",["T_WHITESPACE"," ",810],["T_STRING","explode",810],"(",["T_CONSTANT_ENCAPSED_STRING","','",810],",",["T_WHITESPACE"," ",810],["T_VARIABLE","$this",810],["T_OBJECT_OPERATOR","->",810],["T_STRING","_string_shift",810],"(",["T_VARIABLE","$response",810],",",["T_WHITESPACE"," ",810],["T_VARIABLE","$temp",810],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",810],"]",")",")",";",["T_WHITESPACE","\n\n        ",810],["T_VARIABLE","$temp",812],["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_STRING","unpack",812],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",812],",",["T_WHITESPACE"," ",812],["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","_string_shift",812],"(",["T_VARIABLE","$response",812],",",["T_WHITESPACE"," ",812],["T_LNUMBER","4",812],")",")",";",["T_WHITESPACE","\n        ",812],["T_VARIABLE","$this",813],["T_OBJECT_OPERATOR","->",813],["T_STRING","mac_algorithms_server_to_client",813],["T_WHITESPACE"," ",813],"=",["T_WHITESPACE"," ",813],["T_STRING","explode",813],"(",["T_CONSTANT_ENCAPSED_STRING","','",813],",",["T_WHITESPACE"," ",813],["T_VARIABLE","$this",813],["T_OBJECT_OPERATOR","->",813],["T_STRING","_string_shift",813],"(",["T_VARIABLE","$response",813],",",["T_WHITESPACE"," ",813],["T_VARIABLE","$temp",813],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",813],"]",")",")",";",["T_WHITESPACE","\n\n        ",813],["T_VARIABLE","$temp",815],["T_WHITESPACE"," ",815],"=",["T_WHITESPACE"," ",815],["T_STRING","unpack",815],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",815],",",["T_WHITESPACE"," ",815],["T_VARIABLE","$this",815],["T_OBJECT_OPERATOR","->",815],["T_STRING","_string_shift",815],"(",["T_VARIABLE","$response",815],",",["T_WHITESPACE"," ",815],["T_LNUMBER","4",815],")",")",";",["T_WHITESPACE","\n        ",815],["T_VARIABLE","$this",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","compression_algorithms_client_to_server",816],["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],["T_STRING","explode",816],"(",["T_CONSTANT_ENCAPSED_STRING","','",816],",",["T_WHITESPACE"," ",816],["T_VARIABLE","$this",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","_string_shift",816],"(",["T_VARIABLE","$response",816],",",["T_WHITESPACE"," ",816],["T_VARIABLE","$temp",816],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",816],"]",")",")",";",["T_WHITESPACE","\n\n        ",816],["T_VARIABLE","$temp",818],["T_WHITESPACE"," ",818],"=",["T_WHITESPACE"," ",818],["T_STRING","unpack",818],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$this",818],["T_OBJECT_OPERATOR","->",818],["T_STRING","_string_shift",818],"(",["T_VARIABLE","$response",818],",",["T_WHITESPACE"," ",818],["T_LNUMBER","4",818],")",")",";",["T_WHITESPACE","\n        ",818],["T_VARIABLE","$this",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","compression_algorithms_server_to_client",819],["T_WHITESPACE"," ",819],"=",["T_WHITESPACE"," ",819],["T_STRING","explode",819],"(",["T_CONSTANT_ENCAPSED_STRING","','",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$this",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","_string_shift",819],"(",["T_VARIABLE","$response",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$temp",819],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",819],"]",")",")",";",["T_WHITESPACE","\n\n        ",819],["T_VARIABLE","$temp",821],["T_WHITESPACE"," ",821],"=",["T_WHITESPACE"," ",821],["T_STRING","unpack",821],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",821],",",["T_WHITESPACE"," ",821],["T_VARIABLE","$this",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","_string_shift",821],"(",["T_VARIABLE","$response",821],",",["T_WHITESPACE"," ",821],["T_LNUMBER","4",821],")",")",";",["T_WHITESPACE","\n        ",821],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","languages_client_to_server",822],["T_WHITESPACE"," ",822],"=",["T_WHITESPACE"," ",822],["T_STRING","explode",822],"(",["T_CONSTANT_ENCAPSED_STRING","','",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","_string_shift",822],"(",["T_VARIABLE","$response",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$temp",822],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",822],"]",")",")",";",["T_WHITESPACE","\n\n        ",822],["T_VARIABLE","$temp",824],["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_STRING","unpack",824],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",824],",",["T_WHITESPACE"," ",824],["T_VARIABLE","$this",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","_string_shift",824],"(",["T_VARIABLE","$response",824],",",["T_WHITESPACE"," ",824],["T_LNUMBER","4",824],")",")",";",["T_WHITESPACE","\n        ",824],["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","languages_server_to_client",825],["T_WHITESPACE"," ",825],"=",["T_WHITESPACE"," ",825],["T_STRING","explode",825],"(",["T_CONSTANT_ENCAPSED_STRING","','",825],",",["T_WHITESPACE"," ",825],["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","_string_shift",825],"(",["T_VARIABLE","$response",825],",",["T_WHITESPACE"," ",825],["T_VARIABLE","$temp",825],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",825],"]",")",")",";",["T_WHITESPACE","\n\n        ",825],["T_STRING","extract",827],"(",["T_STRING","unpack",827],"(",["T_CONSTANT_ENCAPSED_STRING","'Cfirst_kex_packet_follows'",827],",",["T_WHITESPACE"," ",827],["T_VARIABLE","$this",827],["T_OBJECT_OPERATOR","->",827],["T_STRING","_string_shift",827],"(",["T_VARIABLE","$response",827],",",["T_WHITESPACE"," ",827],["T_LNUMBER","1",827],")",")",")",";",["T_WHITESPACE","\n        ",827],["T_VARIABLE","$first_kex_packet_follows",828],["T_WHITESPACE"," ",828],"=",["T_WHITESPACE"," ",828],["T_VARIABLE","$first_kex_packet_follows",828],["T_WHITESPACE"," ",828],["T_IS_NOT_EQUAL","!=",828],["T_WHITESPACE"," ",828],["T_LNUMBER","0",828],";",["T_WHITESPACE","\n\n        ",828],["T_COMMENT","\/\/ the sending of SSH2_MSG_KEXINIT could go in one of two places.  this is the second place.\n",830],["T_WHITESPACE","        ",831],["T_VARIABLE","$kexinit_payload_client",831],["T_WHITESPACE"," ",831],"=",["T_WHITESPACE"," ",831],["T_STRING","pack",831],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*Na*Na*Na*Na*Na*Na*Na*Na*Na*Na*CN'",831],",",["T_WHITESPACE","\n            ",831],["T_STRING","NET_SSH2_MSG_KEXINIT",832],",",["T_WHITESPACE"," ",832],["T_VARIABLE","$client_cookie",832],",",["T_WHITESPACE"," ",832],["T_STRING","strlen",832],"(",["T_VARIABLE","$str_kex_algorithms",832],")",",",["T_WHITESPACE"," ",832],["T_VARIABLE","$str_kex_algorithms",832],",",["T_WHITESPACE","\n            ",832],["T_STRING","strlen",833],"(",["T_VARIABLE","$str_server_host_key_algorithms",833],")",",",["T_WHITESPACE"," ",833],["T_VARIABLE","$str_server_host_key_algorithms",833],",",["T_WHITESPACE"," ",833],["T_STRING","strlen",833],"(",["T_VARIABLE","$encryption_algorithms_client_to_server",833],")",",",["T_WHITESPACE","\n            ",833],["T_VARIABLE","$encryption_algorithms_client_to_server",834],",",["T_WHITESPACE"," ",834],["T_STRING","strlen",834],"(",["T_VARIABLE","$encryption_algorithms_server_to_client",834],")",",",["T_WHITESPACE"," ",834],["T_VARIABLE","$encryption_algorithms_server_to_client",834],",",["T_WHITESPACE","\n            ",834],["T_STRING","strlen",835],"(",["T_VARIABLE","$mac_algorithms_client_to_server",835],")",",",["T_WHITESPACE"," ",835],["T_VARIABLE","$mac_algorithms_client_to_server",835],",",["T_WHITESPACE"," ",835],["T_STRING","strlen",835],"(",["T_VARIABLE","$mac_algorithms_server_to_client",835],")",",",["T_WHITESPACE","\n            ",835],["T_VARIABLE","$mac_algorithms_server_to_client",836],",",["T_WHITESPACE"," ",836],["T_STRING","strlen",836],"(",["T_VARIABLE","$compression_algorithms_client_to_server",836],")",",",["T_WHITESPACE"," ",836],["T_VARIABLE","$compression_algorithms_client_to_server",836],",",["T_WHITESPACE","\n            ",836],["T_STRING","strlen",837],"(",["T_VARIABLE","$compression_algorithms_server_to_client",837],")",",",["T_WHITESPACE"," ",837],["T_VARIABLE","$compression_algorithms_server_to_client",837],",",["T_WHITESPACE"," ",837],["T_LNUMBER","0",837],",",["T_WHITESPACE"," ",837],["T_CONSTANT_ENCAPSED_STRING","''",837],",",["T_WHITESPACE"," ",837],["T_LNUMBER","0",837],",",["T_WHITESPACE"," ",837],["T_CONSTANT_ENCAPSED_STRING","''",837],",",["T_WHITESPACE","\n            ",837],["T_LNUMBER","0",838],",",["T_WHITESPACE"," ",838],["T_LNUMBER","0",838],["T_WHITESPACE","\n        ",838],")",";",["T_WHITESPACE","\n\n        ",839],["T_IF","if",841],["T_WHITESPACE"," ",841],"(","!",["T_VARIABLE","$this",841],["T_OBJECT_OPERATOR","->",841],["T_STRING","_send_binary_packet",841],"(",["T_VARIABLE","$kexinit_payload_client",841],")",")",["T_WHITESPACE"," ",841],"{",["T_WHITESPACE","\n            ",841],["T_RETURN","return",842],["T_WHITESPACE"," ",842],["T_STRING","false",842],";",["T_WHITESPACE","\n        ",842],"}",["T_WHITESPACE","\n        ",843],["T_COMMENT","\/\/ here ends the second place.\n",844],["T_WHITESPACE","\n        ",845],["T_COMMENT","\/\/ we need to decide upon the symmetric encryption algorithms before we do the diffie-hellman key exchange\n",846],["T_WHITESPACE","        ",847],["T_FOR","for",847],["T_WHITESPACE"," ",847],"(",["T_VARIABLE","$i",847],["T_WHITESPACE"," ",847],"=",["T_WHITESPACE"," ",847],["T_LNUMBER","0",847],";",["T_WHITESPACE"," ",847],["T_VARIABLE","$i",847],["T_WHITESPACE"," ",847],"<",["T_WHITESPACE"," ",847],["T_STRING","count",847],"(",["T_VARIABLE","$encryption_algorithms",847],")",["T_WHITESPACE"," ",847],["T_BOOLEAN_AND","&&",847],["T_WHITESPACE"," ",847],"!",["T_STRING","in_array",847],"(",["T_VARIABLE","$encryption_algorithms",847],"[",["T_VARIABLE","$i",847],"]",",",["T_WHITESPACE"," ",847],["T_VARIABLE","$this",847],["T_OBJECT_OPERATOR","->",847],["T_STRING","encryption_algorithms_server_to_client",847],")",";",["T_WHITESPACE"," ",847],["T_VARIABLE","$i",847],["T_INC","++",847],")",";",["T_WHITESPACE","\n        ",847],["T_IF","if",848],["T_WHITESPACE"," ",848],"(",["T_VARIABLE","$i",848],["T_WHITESPACE"," ",848],["T_IS_EQUAL","==",848],["T_WHITESPACE"," ",848],["T_STRING","count",848],"(",["T_VARIABLE","$encryption_algorithms",848],")",")",["T_WHITESPACE"," ",848],"{",["T_WHITESPACE","\n            ",848],["T_STRING","user_error",849],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible server to client encryption algorithms found'",849],",",["T_WHITESPACE"," ",849],["T_STRING","E_USER_NOTICE",849],")",";",["T_WHITESPACE","\n            ",849],["T_RETURN","return",850],["T_WHITESPACE"," ",850],["T_VARIABLE","$this",850],["T_OBJECT_OPERATOR","->",850],["T_STRING","_disconnect",850],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",850],")",";",["T_WHITESPACE","\n        ",850],"}",["T_WHITESPACE","\n\n        ",851],["T_COMMENT","\/\/ we don't initialize any crypto-objects, yet - we do that, later. for now, we need the lengths to make the\n",853],["T_WHITESPACE","        ",854],["T_COMMENT","\/\/ diffie-hellman key exchange as fast as possible\n",854],["T_WHITESPACE","        ",855],["T_VARIABLE","$decrypt",855],["T_WHITESPACE"," ",855],"=",["T_WHITESPACE"," ",855],["T_VARIABLE","$encryption_algorithms",855],"[",["T_VARIABLE","$i",855],"]",";",["T_WHITESPACE","\n        ",855],["T_SWITCH","switch",856],["T_WHITESPACE"," ",856],"(",["T_VARIABLE","$decrypt",856],")",["T_WHITESPACE"," ",856],"{",["T_WHITESPACE","\n            ",856],["T_CASE","case",857],["T_WHITESPACE"," ",857],["T_CONSTANT_ENCAPSED_STRING","'3des-cbc'",857],":",["T_WHITESPACE","\n            ",857],["T_CASE","case",858],["T_WHITESPACE"," ",858],["T_CONSTANT_ENCAPSED_STRING","'3des-ctr'",858],":",["T_WHITESPACE","\n                ",858],["T_VARIABLE","$decryptKeyLength",859],["T_WHITESPACE"," ",859],"=",["T_WHITESPACE"," ",859],["T_LNUMBER","24",859],";",["T_WHITESPACE"," ",859],["T_COMMENT","\/\/ eg. 192 \/ 8\n",859],["T_WHITESPACE","                ",860],["T_BREAK","break",860],";",["T_WHITESPACE","\n            ",860],["T_CASE","case",861],["T_WHITESPACE"," ",861],["T_CONSTANT_ENCAPSED_STRING","'aes256-cbc'",861],":",["T_WHITESPACE","\n            ",861],["T_CASE","case",862],["T_WHITESPACE"," ",862],["T_CONSTANT_ENCAPSED_STRING","'aes256-ctr'",862],":",["T_WHITESPACE","\n                ",862],["T_VARIABLE","$decryptKeyLength",863],["T_WHITESPACE"," ",863],"=",["T_WHITESPACE"," ",863],["T_LNUMBER","32",863],";",["T_WHITESPACE"," ",863],["T_COMMENT","\/\/ eg. 256 \/ 8\n",863],["T_WHITESPACE","                ",864],["T_BREAK","break",864],";",["T_WHITESPACE","\n            ",864],["T_CASE","case",865],["T_WHITESPACE"," ",865],["T_CONSTANT_ENCAPSED_STRING","'aes192-cbc'",865],":",["T_WHITESPACE","\n            ",865],["T_CASE","case",866],["T_WHITESPACE"," ",866],["T_CONSTANT_ENCAPSED_STRING","'aes192-ctr'",866],":",["T_WHITESPACE","\n                ",866],["T_VARIABLE","$decryptKeyLength",867],["T_WHITESPACE"," ",867],"=",["T_WHITESPACE"," ",867],["T_LNUMBER","24",867],";",["T_WHITESPACE"," ",867],["T_COMMENT","\/\/ eg. 192 \/ 8\n",867],["T_WHITESPACE","                ",868],["T_BREAK","break",868],";",["T_WHITESPACE","\n            ",868],["T_CASE","case",869],["T_WHITESPACE"," ",869],["T_CONSTANT_ENCAPSED_STRING","'aes128-cbc'",869],":",["T_WHITESPACE","\n            ",869],["T_CASE","case",870],["T_WHITESPACE"," ",870],["T_CONSTANT_ENCAPSED_STRING","'aes128-ctr'",870],":",["T_WHITESPACE","\n                ",870],["T_VARIABLE","$decryptKeyLength",871],["T_WHITESPACE"," ",871],"=",["T_WHITESPACE"," ",871],["T_LNUMBER","16",871],";",["T_WHITESPACE"," ",871],["T_COMMENT","\/\/ eg. 128 \/ 8\n",871],["T_WHITESPACE","                ",872],["T_BREAK","break",872],";",["T_WHITESPACE","\n            ",872],["T_CASE","case",873],["T_WHITESPACE"," ",873],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",873],":",["T_WHITESPACE","\n            ",873],["T_CASE","case",874],["T_WHITESPACE"," ",874],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",874],":",["T_WHITESPACE","\n                ",874],["T_VARIABLE","$decryptKeyLength",875],["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],["T_LNUMBER","16",875],";",["T_WHITESPACE"," ",875],["T_COMMENT","\/\/ eg. 128 \/ 8\n",875],["T_WHITESPACE","                ",876],["T_BREAK","break",876],";",["T_WHITESPACE","\n            ",876],["T_CASE","case",877],["T_WHITESPACE"," ",877],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",877],":",["T_WHITESPACE","\n                ",877],["T_VARIABLE","$decryptKeyLength",878],["T_WHITESPACE"," ",878],"=",["T_WHITESPACE"," ",878],["T_LNUMBER","32",878],";",["T_WHITESPACE"," ",878],["T_COMMENT","\/\/ eg. 128 \/ 8\n",878],["T_WHITESPACE","                ",879],["T_BREAK","break",879],";",["T_WHITESPACE","\n            ",879],["T_CASE","case",880],["T_WHITESPACE"," ",880],["T_CONSTANT_ENCAPSED_STRING","'none'",880],";",["T_WHITESPACE","\n                ",880],["T_VARIABLE","$decryptKeyLength",881],["T_WHITESPACE"," ",881],"=",["T_WHITESPACE"," ",881],["T_LNUMBER","0",881],";",["T_WHITESPACE","\n        ",881],"}",["T_WHITESPACE","\n\n        ",882],["T_FOR","for",884],["T_WHITESPACE"," ",884],"(",["T_VARIABLE","$i",884],["T_WHITESPACE"," ",884],"=",["T_WHITESPACE"," ",884],["T_LNUMBER","0",884],";",["T_WHITESPACE"," ",884],["T_VARIABLE","$i",884],["T_WHITESPACE"," ",884],"<",["T_WHITESPACE"," ",884],["T_STRING","count",884],"(",["T_VARIABLE","$encryption_algorithms",884],")",["T_WHITESPACE"," ",884],["T_BOOLEAN_AND","&&",884],["T_WHITESPACE"," ",884],"!",["T_STRING","in_array",884],"(",["T_VARIABLE","$encryption_algorithms",884],"[",["T_VARIABLE","$i",884],"]",",",["T_WHITESPACE"," ",884],["T_VARIABLE","$this",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","encryption_algorithms_client_to_server",884],")",";",["T_WHITESPACE"," ",884],["T_VARIABLE","$i",884],["T_INC","++",884],")",";",["T_WHITESPACE","\n        ",884],["T_IF","if",885],["T_WHITESPACE"," ",885],"(",["T_VARIABLE","$i",885],["T_WHITESPACE"," ",885],["T_IS_EQUAL","==",885],["T_WHITESPACE"," ",885],["T_STRING","count",885],"(",["T_VARIABLE","$encryption_algorithms",885],")",")",["T_WHITESPACE"," ",885],"{",["T_WHITESPACE","\n            ",885],["T_STRING","user_error",886],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible client to server encryption algorithms found'",886],",",["T_WHITESPACE"," ",886],["T_STRING","E_USER_NOTICE",886],")",";",["T_WHITESPACE","\n            ",886],["T_RETURN","return",887],["T_WHITESPACE"," ",887],["T_VARIABLE","$this",887],["T_OBJECT_OPERATOR","->",887],["T_STRING","_disconnect",887],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",887],")",";",["T_WHITESPACE","\n        ",887],"}",["T_WHITESPACE","\n\n        ",888],["T_VARIABLE","$encrypt",890],["T_WHITESPACE"," ",890],"=",["T_WHITESPACE"," ",890],["T_VARIABLE","$encryption_algorithms",890],"[",["T_VARIABLE","$i",890],"]",";",["T_WHITESPACE","\n        ",890],["T_SWITCH","switch",891],["T_WHITESPACE"," ",891],"(",["T_VARIABLE","$encrypt",891],")",["T_WHITESPACE"," ",891],"{",["T_WHITESPACE","\n            ",891],["T_CASE","case",892],["T_WHITESPACE"," ",892],["T_CONSTANT_ENCAPSED_STRING","'3des-cbc'",892],":",["T_WHITESPACE","\n            ",892],["T_CASE","case",893],["T_WHITESPACE"," ",893],["T_CONSTANT_ENCAPSED_STRING","'3des-ctr'",893],":",["T_WHITESPACE","\n                ",893],["T_VARIABLE","$encryptKeyLength",894],["T_WHITESPACE"," ",894],"=",["T_WHITESPACE"," ",894],["T_LNUMBER","24",894],";",["T_WHITESPACE","\n                ",894],["T_BREAK","break",895],";",["T_WHITESPACE","\n            ",895],["T_CASE","case",896],["T_WHITESPACE"," ",896],["T_CONSTANT_ENCAPSED_STRING","'aes256-cbc'",896],":",["T_WHITESPACE","\n            ",896],["T_CASE","case",897],["T_WHITESPACE"," ",897],["T_CONSTANT_ENCAPSED_STRING","'aes256-ctr'",897],":",["T_WHITESPACE","\n                ",897],["T_VARIABLE","$encryptKeyLength",898],["T_WHITESPACE"," ",898],"=",["T_WHITESPACE"," ",898],["T_LNUMBER","32",898],";",["T_WHITESPACE","\n                ",898],["T_BREAK","break",899],";",["T_WHITESPACE","\n            ",899],["T_CASE","case",900],["T_WHITESPACE"," ",900],["T_CONSTANT_ENCAPSED_STRING","'aes192-cbc'",900],":",["T_WHITESPACE","\n            ",900],["T_CASE","case",901],["T_WHITESPACE"," ",901],["T_CONSTANT_ENCAPSED_STRING","'aes192-ctr'",901],":",["T_WHITESPACE","\n                ",901],["T_VARIABLE","$encryptKeyLength",902],["T_WHITESPACE"," ",902],"=",["T_WHITESPACE"," ",902],["T_LNUMBER","24",902],";",["T_WHITESPACE","\n                ",902],["T_BREAK","break",903],";",["T_WHITESPACE","\n            ",903],["T_CASE","case",904],["T_WHITESPACE"," ",904],["T_CONSTANT_ENCAPSED_STRING","'aes128-cbc'",904],":",["T_WHITESPACE","\n            ",904],["T_CASE","case",905],["T_WHITESPACE"," ",905],["T_CONSTANT_ENCAPSED_STRING","'aes128-ctr'",905],":",["T_WHITESPACE","\n                ",905],["T_VARIABLE","$encryptKeyLength",906],["T_WHITESPACE"," ",906],"=",["T_WHITESPACE"," ",906],["T_LNUMBER","16",906],";",["T_WHITESPACE","\n                ",906],["T_BREAK","break",907],";",["T_WHITESPACE","\n            ",907],["T_CASE","case",908],["T_WHITESPACE"," ",908],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",908],":",["T_WHITESPACE","\n            ",908],["T_CASE","case",909],["T_WHITESPACE"," ",909],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",909],":",["T_WHITESPACE","\n                ",909],["T_VARIABLE","$encryptKeyLength",910],["T_WHITESPACE"," ",910],"=",["T_WHITESPACE"," ",910],["T_LNUMBER","16",910],";",["T_WHITESPACE","\n                ",910],["T_BREAK","break",911],";",["T_WHITESPACE","\n            ",911],["T_CASE","case",912],["T_WHITESPACE"," ",912],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",912],":",["T_WHITESPACE","\n                ",912],["T_VARIABLE","$encryptKeyLength",913],["T_WHITESPACE"," ",913],"=",["T_WHITESPACE"," ",913],["T_LNUMBER","32",913],";",["T_WHITESPACE","\n                ",913],["T_BREAK","break",914],";",["T_WHITESPACE","\n            ",914],["T_CASE","case",915],["T_WHITESPACE"," ",915],["T_CONSTANT_ENCAPSED_STRING","'none'",915],";",["T_WHITESPACE","\n                ",915],["T_VARIABLE","$encryptKeyLength",916],["T_WHITESPACE"," ",916],"=",["T_WHITESPACE"," ",916],["T_LNUMBER","0",916],";",["T_WHITESPACE","\n        ",916],"}",["T_WHITESPACE","\n\n        ",917],["T_VARIABLE","$keyLength",919],["T_WHITESPACE"," ",919],"=",["T_WHITESPACE"," ",919],["T_VARIABLE","$decryptKeyLength",919],["T_WHITESPACE"," ",919],">",["T_WHITESPACE"," ",919],["T_VARIABLE","$encryptKeyLength",919],["T_WHITESPACE"," ",919],"?",["T_WHITESPACE"," ",919],["T_VARIABLE","$decryptKeyLength",919],["T_WHITESPACE"," ",919],":",["T_WHITESPACE"," ",919],["T_VARIABLE","$encryptKeyLength",919],";",["T_WHITESPACE","\n\n        ",919],["T_COMMENT","\/\/ through diffie-hellman key exchange a symmetric key is obtained\n",921],["T_WHITESPACE","        ",922],["T_FOR","for",922],["T_WHITESPACE"," ",922],"(",["T_VARIABLE","$i",922],["T_WHITESPACE"," ",922],"=",["T_WHITESPACE"," ",922],["T_LNUMBER","0",922],";",["T_WHITESPACE"," ",922],["T_VARIABLE","$i",922],["T_WHITESPACE"," ",922],"<",["T_WHITESPACE"," ",922],["T_STRING","count",922],"(",["T_VARIABLE","$kex_algorithms",922],")",["T_WHITESPACE"," ",922],["T_BOOLEAN_AND","&&",922],["T_WHITESPACE"," ",922],"!",["T_STRING","in_array",922],"(",["T_VARIABLE","$kex_algorithms",922],"[",["T_VARIABLE","$i",922],"]",",",["T_WHITESPACE"," ",922],["T_VARIABLE","$this",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","kex_algorithms",922],")",";",["T_WHITESPACE"," ",922],["T_VARIABLE","$i",922],["T_INC","++",922],")",";",["T_WHITESPACE","\n        ",922],["T_IF","if",923],["T_WHITESPACE"," ",923],"(",["T_VARIABLE","$i",923],["T_WHITESPACE"," ",923],["T_IS_EQUAL","==",923],["T_WHITESPACE"," ",923],["T_STRING","count",923],"(",["T_VARIABLE","$kex_algorithms",923],")",")",["T_WHITESPACE"," ",923],"{",["T_WHITESPACE","\n            ",923],["T_STRING","user_error",924],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible key exchange algorithms found'",924],",",["T_WHITESPACE"," ",924],["T_STRING","E_USER_NOTICE",924],")",";",["T_WHITESPACE","\n            ",924],["T_RETURN","return",925],["T_WHITESPACE"," ",925],["T_VARIABLE","$this",925],["T_OBJECT_OPERATOR","->",925],["T_STRING","_disconnect",925],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",925],")",";",["T_WHITESPACE","\n        ",925],"}",["T_WHITESPACE","\n\n        ",926],["T_SWITCH","switch",928],["T_WHITESPACE"," ",928],"(",["T_VARIABLE","$kex_algorithms",928],"[",["T_VARIABLE","$i",928],"]",")",["T_WHITESPACE"," ",928],"{",["T_WHITESPACE","\n            ",928],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc2409#section-6.2 and \n",929],["T_WHITESPACE","            ",930],["T_COMMENT","\/\/ http:\/\/tools.ietf.org\/html\/rfc2412, appendex E\n",930],["T_WHITESPACE","            ",931],["T_CASE","case",931],["T_WHITESPACE"," ",931],["T_CONSTANT_ENCAPSED_STRING","'diffie-hellman-group1-sha1'",931],":",["T_WHITESPACE","\n                ",931],["T_VARIABLE","$p",932],["T_WHITESPACE"," ",932],"=",["T_WHITESPACE"," ",932],["T_STRING","pack",932],"(",["T_CONSTANT_ENCAPSED_STRING","'H256'",932],",",["T_WHITESPACE"," ",932],["T_CONSTANT_ENCAPSED_STRING","'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74'",932],["T_WHITESPACE"," ",932],".",["T_WHITESPACE"," \n                                  ",932],["T_CONSTANT_ENCAPSED_STRING","'020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437'",933],["T_WHITESPACE"," ",933],".",["T_WHITESPACE"," \n                                  ",933],["T_CONSTANT_ENCAPSED_STRING","'4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED'",934],["T_WHITESPACE"," ",934],".",["T_WHITESPACE"," \n                                  ",934],["T_CONSTANT_ENCAPSED_STRING","'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE65381FFFFFFFFFFFFFFFF'",935],")",";",["T_WHITESPACE","\n                ",935],["T_VARIABLE","$keyLength",936],["T_WHITESPACE"," ",936],"=",["T_WHITESPACE"," ",936],["T_VARIABLE","$keyLength",936],["T_WHITESPACE"," ",936],"<",["T_WHITESPACE"," ",936],["T_LNUMBER","160",936],["T_WHITESPACE"," ",936],"?",["T_WHITESPACE"," ",936],["T_VARIABLE","$keyLength",936],["T_WHITESPACE"," ",936],":",["T_WHITESPACE"," ",936],["T_LNUMBER","160",936],";",["T_WHITESPACE","\n                ",936],["T_VARIABLE","$hash",937],["T_WHITESPACE"," ",937],"=",["T_WHITESPACE"," ",937],["T_CONSTANT_ENCAPSED_STRING","'sha1'",937],";",["T_WHITESPACE","\n                ",937],["T_BREAK","break",938],";",["T_WHITESPACE","\n            ",938],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc3526#section-3\n",939],["T_WHITESPACE","            ",940],["T_CASE","case",940],["T_WHITESPACE"," ",940],["T_CONSTANT_ENCAPSED_STRING","'diffie-hellman-group14-sha1'",940],":",["T_WHITESPACE","\n                ",940],["T_VARIABLE","$p",941],["T_WHITESPACE"," ",941],"=",["T_WHITESPACE"," ",941],["T_STRING","pack",941],"(",["T_CONSTANT_ENCAPSED_STRING","'H512'",941],",",["T_WHITESPACE"," ",941],["T_CONSTANT_ENCAPSED_STRING","'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74'",941],["T_WHITESPACE"," ",941],".",["T_WHITESPACE"," \n                                  ",941],["T_CONSTANT_ENCAPSED_STRING","'020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437'",942],["T_WHITESPACE"," ",942],".",["T_WHITESPACE"," \n                                  ",942],["T_CONSTANT_ENCAPSED_STRING","'4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED'",943],["T_WHITESPACE"," ",943],".",["T_WHITESPACE"," \n                                  ",943],["T_CONSTANT_ENCAPSED_STRING","'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05'",944],["T_WHITESPACE"," ",944],".",["T_WHITESPACE"," \n                                  ",944],["T_CONSTANT_ENCAPSED_STRING","'98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB'",945],["T_WHITESPACE"," ",945],".",["T_WHITESPACE"," \n                                  ",945],["T_CONSTANT_ENCAPSED_STRING","'9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B'",946],["T_WHITESPACE"," ",946],".",["T_WHITESPACE"," \n                                  ",946],["T_CONSTANT_ENCAPSED_STRING","'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718'",947],["T_WHITESPACE"," ",947],".",["T_WHITESPACE"," \n                                  ",947],["T_CONSTANT_ENCAPSED_STRING","'3995497CEA956AE515D2261898FA051015728E5A8AACAA68FFFFFFFFFFFFFFFF'",948],")",";",["T_WHITESPACE","\n                ",948],["T_VARIABLE","$keyLength",949],["T_WHITESPACE"," ",949],"=",["T_WHITESPACE"," ",949],["T_VARIABLE","$keyLength",949],["T_WHITESPACE"," ",949],"<",["T_WHITESPACE"," ",949],["T_LNUMBER","160",949],["T_WHITESPACE"," ",949],"?",["T_WHITESPACE"," ",949],["T_VARIABLE","$keyLength",949],["T_WHITESPACE"," ",949],":",["T_WHITESPACE"," ",949],["T_LNUMBER","160",949],";",["T_WHITESPACE","\n                ",949],["T_VARIABLE","$hash",950],["T_WHITESPACE"," ",950],"=",["T_WHITESPACE"," ",950],["T_CONSTANT_ENCAPSED_STRING","'sha1'",950],";",["T_WHITESPACE","\n        ",950],"}",["T_WHITESPACE","\n\n        ",951],["T_VARIABLE","$p",953],["T_WHITESPACE"," ",953],"=",["T_WHITESPACE"," ",953],["T_NEW","new",953],["T_WHITESPACE"," ",953],["T_STRING","Math_BigInteger",953],"(",["T_VARIABLE","$p",953],",",["T_WHITESPACE"," ",953],["T_LNUMBER","256",953],")",";",["T_WHITESPACE","\n        ",953],["T_COMMENT","\/\/$q = $p->bitwise_rightShift(1);\n",954],["T_WHITESPACE","\n        ",955],["T_COMMENT","\/* To increase the speed of the key exchange, both client and server may\n           reduce the size of their private exponents.  It should be at least\n           twice as long as the key material that is generated from the shared\n           secret.  For more details, see the paper by van Oorschot and Wiener\n           [VAN-OORSCHOT].\n\n           -- http:\/\/tools.ietf.org\/html\/rfc4419#section-6.2 *\/",956],["T_WHITESPACE","\n        ",962],["T_VARIABLE","$q",963],["T_WHITESPACE"," ",963],"=",["T_WHITESPACE"," ",963],["T_NEW","new",963],["T_WHITESPACE"," ",963],["T_STRING","Math_BigInteger",963],"(",["T_LNUMBER","1",963],")",";",["T_WHITESPACE","\n        ",963],["T_VARIABLE","$q",964],["T_WHITESPACE"," ",964],"=",["T_WHITESPACE"," ",964],["T_VARIABLE","$q",964],["T_OBJECT_OPERATOR","->",964],["T_STRING","bitwise_leftShift",964],"(",["T_LNUMBER","2",964],["T_WHITESPACE"," ",964],"*",["T_WHITESPACE"," ",964],["T_VARIABLE","$keyLength",964],")",";",["T_WHITESPACE","\n        ",964],["T_VARIABLE","$q",965],["T_WHITESPACE"," ",965],"=",["T_WHITESPACE"," ",965],["T_VARIABLE","$q",965],["T_OBJECT_OPERATOR","->",965],["T_STRING","subtract",965],"(",["T_NEW","new",965],["T_WHITESPACE"," ",965],["T_STRING","Math_BigInteger",965],"(",["T_LNUMBER","1",965],")",")",";",["T_WHITESPACE","\n\n        ",965],["T_VARIABLE","$g",967],["T_WHITESPACE"," ",967],"=",["T_WHITESPACE"," ",967],["T_NEW","new",967],["T_WHITESPACE"," ",967],["T_STRING","Math_BigInteger",967],"(",["T_LNUMBER","2",967],")",";",["T_WHITESPACE","\n        ",967],["T_VARIABLE","$x",968],["T_WHITESPACE"," ",968],"=",["T_WHITESPACE"," ",968],["T_NEW","new",968],["T_WHITESPACE"," ",968],["T_STRING","Math_BigInteger",968],"(",")",";",["T_WHITESPACE","\n        ",968],["T_VARIABLE","$x",969],["T_OBJECT_OPERATOR","->",969],["T_STRING","setRandomGenerator",969],"(",["T_CONSTANT_ENCAPSED_STRING","'crypt_random'",969],")",";",["T_WHITESPACE","\n        ",969],["T_VARIABLE","$x",970],["T_WHITESPACE"," ",970],"=",["T_WHITESPACE"," ",970],["T_VARIABLE","$x",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","random",970],"(",["T_NEW","new",970],["T_WHITESPACE"," ",970],["T_STRING","Math_BigInteger",970],"(",["T_LNUMBER","1",970],")",",",["T_WHITESPACE"," ",970],["T_VARIABLE","$q",970],")",";",["T_WHITESPACE","\n        ",970],["T_VARIABLE","$e",971],["T_WHITESPACE"," ",971],"=",["T_WHITESPACE"," ",971],["T_VARIABLE","$g",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","modPow",971],"(",["T_VARIABLE","$x",971],",",["T_WHITESPACE"," ",971],["T_VARIABLE","$p",971],")",";",["T_WHITESPACE","\n\n        ",971],["T_VARIABLE","$eBytes",973],["T_WHITESPACE"," ",973],"=",["T_WHITESPACE"," ",973],["T_VARIABLE","$e",973],["T_OBJECT_OPERATOR","->",973],["T_STRING","toBytes",973],"(",["T_STRING","true",973],")",";",["T_WHITESPACE","\n        ",973],["T_VARIABLE","$data",974],["T_WHITESPACE"," ",974],"=",["T_WHITESPACE"," ",974],["T_STRING","pack",974],"(",["T_CONSTANT_ENCAPSED_STRING","'CNa*'",974],",",["T_WHITESPACE"," ",974],["T_STRING","NET_SSH2_MSG_KEXDH_INIT",974],",",["T_WHITESPACE"," ",974],["T_STRING","strlen",974],"(",["T_VARIABLE","$eBytes",974],")",",",["T_WHITESPACE"," ",974],["T_VARIABLE","$eBytes",974],")",";",["T_WHITESPACE","\n\n        ",974],["T_IF","if",976],["T_WHITESPACE"," ",976],"(","!",["T_VARIABLE","$this",976],["T_OBJECT_OPERATOR","->",976],["T_STRING","_send_binary_packet",976],"(",["T_VARIABLE","$data",976],")",")",["T_WHITESPACE"," ",976],"{",["T_WHITESPACE","\n            ",976],["T_STRING","user_error",977],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",977],",",["T_WHITESPACE"," ",977],["T_STRING","E_USER_NOTICE",977],")",";",["T_WHITESPACE","\n            ",977],["T_RETURN","return",978],["T_WHITESPACE"," ",978],["T_STRING","false",978],";",["T_WHITESPACE","\n        ",978],"}",["T_WHITESPACE","\n\n        ",979],["T_VARIABLE","$response",981],["T_WHITESPACE"," ",981],"=",["T_WHITESPACE"," ",981],["T_VARIABLE","$this",981],["T_OBJECT_OPERATOR","->",981],["T_STRING","_get_binary_packet",981],"(",")",";",["T_WHITESPACE","\n        ",981],["T_IF","if",982],["T_WHITESPACE"," ",982],"(",["T_VARIABLE","$response",982],["T_WHITESPACE"," ",982],["T_IS_IDENTICAL","===",982],["T_WHITESPACE"," ",982],["T_STRING","false",982],")",["T_WHITESPACE"," ",982],"{",["T_WHITESPACE","\n            ",982],["T_STRING","user_error",983],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",983],",",["T_WHITESPACE"," ",983],["T_STRING","E_USER_NOTICE",983],")",";",["T_WHITESPACE","\n            ",983],["T_RETURN","return",984],["T_WHITESPACE"," ",984],["T_STRING","false",984],";",["T_WHITESPACE","\n        ",984],"}",["T_WHITESPACE","\n        ",985],["T_STRING","extract",986],"(",["T_STRING","unpack",986],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype'",986],",",["T_WHITESPACE"," ",986],["T_VARIABLE","$this",986],["T_OBJECT_OPERATOR","->",986],["T_STRING","_string_shift",986],"(",["T_VARIABLE","$response",986],",",["T_WHITESPACE"," ",986],["T_LNUMBER","1",986],")",")",")",";",["T_WHITESPACE","\n\n        ",986],["T_IF","if",988],["T_WHITESPACE"," ",988],"(",["T_VARIABLE","$type",988],["T_WHITESPACE"," ",988],["T_IS_NOT_EQUAL","!=",988],["T_WHITESPACE"," ",988],["T_STRING","NET_SSH2_MSG_KEXDH_REPLY",988],")",["T_WHITESPACE"," ",988],"{",["T_WHITESPACE","\n            ",988],["T_STRING","user_error",989],"(",["T_CONSTANT_ENCAPSED_STRING","'Expected SSH_MSG_KEXDH_REPLY'",989],",",["T_WHITESPACE"," ",989],["T_STRING","E_USER_NOTICE",989],")",";",["T_WHITESPACE","\n            ",989],["T_RETURN","return",990],["T_WHITESPACE"," ",990],["T_STRING","false",990],";",["T_WHITESPACE","\n        ",990],"}",["T_WHITESPACE","\n\n        ",991],["T_VARIABLE","$temp",993],["T_WHITESPACE"," ",993],"=",["T_WHITESPACE"," ",993],["T_STRING","unpack",993],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",993],",",["T_WHITESPACE"," ",993],["T_VARIABLE","$this",993],["T_OBJECT_OPERATOR","->",993],["T_STRING","_string_shift",993],"(",["T_VARIABLE","$response",993],",",["T_WHITESPACE"," ",993],["T_LNUMBER","4",993],")",")",";",["T_WHITESPACE","\n        ",993],["T_VARIABLE","$this",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","server_public_host_key",994],["T_WHITESPACE"," ",994],"=",["T_WHITESPACE"," ",994],["T_VARIABLE","$server_public_host_key",994],["T_WHITESPACE"," ",994],"=",["T_WHITESPACE"," ",994],["T_VARIABLE","$this",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","_string_shift",994],"(",["T_VARIABLE","$response",994],",",["T_WHITESPACE"," ",994],["T_VARIABLE","$temp",994],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",994],"]",")",";",["T_WHITESPACE","\n\n        ",994],["T_VARIABLE","$temp",996],["T_WHITESPACE"," ",996],"=",["T_WHITESPACE"," ",996],["T_STRING","unpack",996],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",996],",",["T_WHITESPACE"," ",996],["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","_string_shift",996],"(",["T_VARIABLE","$server_public_host_key",996],",",["T_WHITESPACE"," ",996],["T_LNUMBER","4",996],")",")",";",["T_WHITESPACE","\n        ",996],["T_VARIABLE","$public_key_format",997],["T_WHITESPACE"," ",997],"=",["T_WHITESPACE"," ",997],["T_VARIABLE","$this",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","_string_shift",997],"(",["T_VARIABLE","$server_public_host_key",997],",",["T_WHITESPACE"," ",997],["T_VARIABLE","$temp",997],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",997],"]",")",";",["T_WHITESPACE","\n\n        ",997],["T_VARIABLE","$temp",999],["T_WHITESPACE"," ",999],"=",["T_WHITESPACE"," ",999],["T_STRING","unpack",999],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",999],",",["T_WHITESPACE"," ",999],["T_VARIABLE","$this",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","_string_shift",999],"(",["T_VARIABLE","$response",999],",",["T_WHITESPACE"," ",999],["T_LNUMBER","4",999],")",")",";",["T_WHITESPACE","\n        ",999],["T_VARIABLE","$fBytes",1000],["T_WHITESPACE"," ",1000],"=",["T_WHITESPACE"," ",1000],["T_VARIABLE","$this",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","_string_shift",1000],"(",["T_VARIABLE","$response",1000],",",["T_WHITESPACE"," ",1000],["T_VARIABLE","$temp",1000],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",1000],"]",")",";",["T_WHITESPACE","\n        ",1000],["T_VARIABLE","$f",1001],["T_WHITESPACE"," ",1001],"=",["T_WHITESPACE"," ",1001],["T_NEW","new",1001],["T_WHITESPACE"," ",1001],["T_STRING","Math_BigInteger",1001],"(",["T_VARIABLE","$fBytes",1001],",",["T_WHITESPACE"," ",1001],"-",["T_LNUMBER","256",1001],")",";",["T_WHITESPACE","\n\n        ",1001],["T_VARIABLE","$temp",1003],["T_WHITESPACE"," ",1003],"=",["T_WHITESPACE"," ",1003],["T_STRING","unpack",1003],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1003],",",["T_WHITESPACE"," ",1003],["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","_string_shift",1003],"(",["T_VARIABLE","$response",1003],",",["T_WHITESPACE"," ",1003],["T_LNUMBER","4",1003],")",")",";",["T_WHITESPACE","\n        ",1003],["T_VARIABLE","$this",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","signature",1004],["T_WHITESPACE"," ",1004],"=",["T_WHITESPACE"," ",1004],["T_VARIABLE","$this",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","_string_shift",1004],"(",["T_VARIABLE","$response",1004],",",["T_WHITESPACE"," ",1004],["T_VARIABLE","$temp",1004],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",1004],"]",")",";",["T_WHITESPACE","\n\n        ",1004],["T_VARIABLE","$temp",1006],["T_WHITESPACE"," ",1006],"=",["T_WHITESPACE"," ",1006],["T_STRING","unpack",1006],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1006],",",["T_WHITESPACE"," ",1006],["T_VARIABLE","$this",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","_string_shift",1006],"(",["T_VARIABLE","$this",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","signature",1006],",",["T_WHITESPACE"," ",1006],["T_LNUMBER","4",1006],")",")",";",["T_WHITESPACE","\n        ",1006],["T_VARIABLE","$this",1007],["T_OBJECT_OPERATOR","->",1007],["T_STRING","signature_format",1007],["T_WHITESPACE"," ",1007],"=",["T_WHITESPACE"," ",1007],["T_VARIABLE","$this",1007],["T_OBJECT_OPERATOR","->",1007],["T_STRING","_string_shift",1007],"(",["T_VARIABLE","$this",1007],["T_OBJECT_OPERATOR","->",1007],["T_STRING","signature",1007],",",["T_WHITESPACE"," ",1007],["T_VARIABLE","$temp",1007],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",1007],"]",")",";",["T_WHITESPACE","\n\n        ",1007],["T_VARIABLE","$key",1009],["T_WHITESPACE"," ",1009],"=",["T_WHITESPACE"," ",1009],["T_VARIABLE","$f",1009],["T_OBJECT_OPERATOR","->",1009],["T_STRING","modPow",1009],"(",["T_VARIABLE","$x",1009],",",["T_WHITESPACE"," ",1009],["T_VARIABLE","$p",1009],")",";",["T_WHITESPACE","\n        ",1009],["T_VARIABLE","$keyBytes",1010],["T_WHITESPACE"," ",1010],"=",["T_WHITESPACE"," ",1010],["T_VARIABLE","$key",1010],["T_OBJECT_OPERATOR","->",1010],["T_STRING","toBytes",1010],"(",["T_STRING","true",1010],")",";",["T_WHITESPACE","\n\n        ",1010],["T_IF","if",1012],["T_WHITESPACE"," ",1012],"(",["T_VARIABLE","$this",1012],["T_OBJECT_OPERATOR","->",1012],["T_STRING","session_id",1012],["T_WHITESPACE"," ",1012],["T_IS_IDENTICAL","===",1012],["T_WHITESPACE"," ",1012],["T_STRING","false",1012],")",["T_WHITESPACE"," ",1012],"{",["T_WHITESPACE","\n            ",1012],["T_VARIABLE","$source",1013],["T_WHITESPACE"," ",1013],"=",["T_WHITESPACE"," ",1013],["T_STRING","pack",1013],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*Na*Na*Na*Na*Na*Na*Na*'",1013],",",["T_WHITESPACE","\n                ",1013],["T_STRING","strlen",1014],"(",["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","identifier",1014],")",",",["T_WHITESPACE"," ",1014],["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","identifier",1014],",",["T_WHITESPACE"," ",1014],["T_STRING","strlen",1014],"(",["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","server_identifier",1014],")",",",["T_WHITESPACE"," ",1014],["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","server_identifier",1014],",",["T_WHITESPACE","\n                ",1014],["T_STRING","strlen",1015],"(",["T_VARIABLE","$kexinit_payload_client",1015],")",",",["T_WHITESPACE"," ",1015],["T_VARIABLE","$kexinit_payload_client",1015],",",["T_WHITESPACE"," ",1015],["T_STRING","strlen",1015],"(",["T_VARIABLE","$kexinit_payload_server",1015],")",",",["T_WHITESPACE","\n                ",1015],["T_VARIABLE","$kexinit_payload_server",1016],",",["T_WHITESPACE"," ",1016],["T_STRING","strlen",1016],"(",["T_VARIABLE","$this",1016],["T_OBJECT_OPERATOR","->",1016],["T_STRING","server_public_host_key",1016],")",",",["T_WHITESPACE"," ",1016],["T_VARIABLE","$this",1016],["T_OBJECT_OPERATOR","->",1016],["T_STRING","server_public_host_key",1016],",",["T_WHITESPACE"," ",1016],["T_STRING","strlen",1016],"(",["T_VARIABLE","$eBytes",1016],")",",",["T_WHITESPACE","\n                ",1016],["T_VARIABLE","$eBytes",1017],",",["T_WHITESPACE"," ",1017],["T_STRING","strlen",1017],"(",["T_VARIABLE","$fBytes",1017],")",",",["T_WHITESPACE"," ",1017],["T_VARIABLE","$fBytes",1017],",",["T_WHITESPACE"," ",1017],["T_STRING","strlen",1017],"(",["T_VARIABLE","$keyBytes",1017],")",",",["T_WHITESPACE"," ",1017],["T_VARIABLE","$keyBytes",1017],["T_WHITESPACE","\n            ",1017],")",";",["T_WHITESPACE","\n\n            ",1018],["T_VARIABLE","$source",1020],["T_WHITESPACE"," ",1020],"=",["T_WHITESPACE"," ",1020],["T_STRING","pack",1020],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1020],",",["T_WHITESPACE"," ",1020],["T_VARIABLE","$hash",1020],"(",["T_VARIABLE","$source",1020],")",")",";",["T_WHITESPACE","\n\n            ",1020],["T_VARIABLE","$this",1022],["T_OBJECT_OPERATOR","->",1022],["T_STRING","session_id",1022],["T_WHITESPACE"," ",1022],"=",["T_WHITESPACE"," ",1022],["T_VARIABLE","$source",1022],";",["T_WHITESPACE","\n        ",1022],"}",["T_WHITESPACE","\n\n        ",1023],["T_FOR","for",1025],["T_WHITESPACE"," ",1025],"(",["T_VARIABLE","$i",1025],["T_WHITESPACE"," ",1025],"=",["T_WHITESPACE"," ",1025],["T_LNUMBER","0",1025],";",["T_WHITESPACE"," ",1025],["T_VARIABLE","$i",1025],["T_WHITESPACE"," ",1025],"<",["T_WHITESPACE"," ",1025],["T_STRING","count",1025],"(",["T_VARIABLE","$server_host_key_algorithms",1025],")",["T_WHITESPACE"," ",1025],["T_BOOLEAN_AND","&&",1025],["T_WHITESPACE"," ",1025],"!",["T_STRING","in_array",1025],"(",["T_VARIABLE","$server_host_key_algorithms",1025],"[",["T_VARIABLE","$i",1025],"]",",",["T_WHITESPACE"," ",1025],["T_VARIABLE","$this",1025],["T_OBJECT_OPERATOR","->",1025],["T_STRING","server_host_key_algorithms",1025],")",";",["T_WHITESPACE"," ",1025],["T_VARIABLE","$i",1025],["T_INC","++",1025],")",";",["T_WHITESPACE","\n        ",1025],["T_IF","if",1026],["T_WHITESPACE"," ",1026],"(",["T_VARIABLE","$i",1026],["T_WHITESPACE"," ",1026],["T_IS_EQUAL","==",1026],["T_WHITESPACE"," ",1026],["T_STRING","count",1026],"(",["T_VARIABLE","$server_host_key_algorithms",1026],")",")",["T_WHITESPACE"," ",1026],"{",["T_WHITESPACE","\n            ",1026],["T_STRING","user_error",1027],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible server host key algorithms found'",1027],",",["T_WHITESPACE"," ",1027],["T_STRING","E_USER_NOTICE",1027],")",";",["T_WHITESPACE","\n            ",1027],["T_RETURN","return",1028],["T_WHITESPACE"," ",1028],["T_VARIABLE","$this",1028],["T_OBJECT_OPERATOR","->",1028],["T_STRING","_disconnect",1028],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",1028],")",";",["T_WHITESPACE","\n        ",1028],"}",["T_WHITESPACE","\n\n        ",1029],["T_IF","if",1031],["T_WHITESPACE"," ",1031],"(",["T_VARIABLE","$public_key_format",1031],["T_WHITESPACE"," ",1031],["T_IS_NOT_EQUAL","!=",1031],["T_WHITESPACE"," ",1031],["T_VARIABLE","$server_host_key_algorithms",1031],"[",["T_VARIABLE","$i",1031],"]",["T_WHITESPACE"," ",1031],["T_BOOLEAN_OR","||",1031],["T_WHITESPACE"," ",1031],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","signature_format",1031],["T_WHITESPACE"," ",1031],["T_IS_NOT_EQUAL","!=",1031],["T_WHITESPACE"," ",1031],["T_VARIABLE","$server_host_key_algorithms",1031],"[",["T_VARIABLE","$i",1031],"]",")",["T_WHITESPACE"," ",1031],"{",["T_WHITESPACE","\n            ",1031],["T_STRING","user_error",1032],"(",["T_CONSTANT_ENCAPSED_STRING","'Sever Host Key Algorithm Mismatch'",1032],",",["T_WHITESPACE"," ",1032],["T_STRING","E_USER_NOTICE",1032],")",";",["T_WHITESPACE","\n            ",1032],["T_RETURN","return",1033],["T_WHITESPACE"," ",1033],["T_VARIABLE","$this",1033],["T_OBJECT_OPERATOR","->",1033],["T_STRING","_disconnect",1033],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",1033],")",";",["T_WHITESPACE","\n        ",1033],"}",["T_WHITESPACE","\n\n        ",1034],["T_VARIABLE","$packet",1036],["T_WHITESPACE"," ",1036],"=",["T_WHITESPACE"," ",1036],["T_STRING","pack",1036],"(",["T_CONSTANT_ENCAPSED_STRING","'C'",1036],",",["T_WHITESPACE","\n            ",1036],["T_STRING","NET_SSH2_MSG_NEWKEYS",1037],["T_WHITESPACE","\n        ",1037],")",";",["T_WHITESPACE","\n\n        ",1038],["T_IF","if",1040],["T_WHITESPACE"," ",1040],"(","!",["T_VARIABLE","$this",1040],["T_OBJECT_OPERATOR","->",1040],["T_STRING","_send_binary_packet",1040],"(",["T_VARIABLE","$packet",1040],")",")",["T_WHITESPACE"," ",1040],"{",["T_WHITESPACE","\n            ",1040],["T_RETURN","return",1041],["T_WHITESPACE"," ",1041],["T_STRING","false",1041],";",["T_WHITESPACE","\n        ",1041],"}",["T_WHITESPACE","\n\n        ",1042],["T_VARIABLE","$response",1044],["T_WHITESPACE"," ",1044],"=",["T_WHITESPACE"," ",1044],["T_VARIABLE","$this",1044],["T_OBJECT_OPERATOR","->",1044],["T_STRING","_get_binary_packet",1044],"(",")",";",["T_WHITESPACE","\n\n        ",1044],["T_IF","if",1046],["T_WHITESPACE"," ",1046],"(",["T_VARIABLE","$response",1046],["T_WHITESPACE"," ",1046],["T_IS_IDENTICAL","===",1046],["T_WHITESPACE"," ",1046],["T_STRING","false",1046],")",["T_WHITESPACE"," ",1046],"{",["T_WHITESPACE","\n            ",1046],["T_STRING","user_error",1047],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",1047],",",["T_WHITESPACE"," ",1047],["T_STRING","E_USER_NOTICE",1047],")",";",["T_WHITESPACE","\n            ",1047],["T_RETURN","return",1048],["T_WHITESPACE"," ",1048],["T_STRING","false",1048],";",["T_WHITESPACE","\n        ",1048],"}",["T_WHITESPACE","\n\n        ",1049],["T_STRING","extract",1051],"(",["T_STRING","unpack",1051],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype'",1051],",",["T_WHITESPACE"," ",1051],["T_VARIABLE","$this",1051],["T_OBJECT_OPERATOR","->",1051],["T_STRING","_string_shift",1051],"(",["T_VARIABLE","$response",1051],",",["T_WHITESPACE"," ",1051],["T_LNUMBER","1",1051],")",")",")",";",["T_WHITESPACE","\n\n        ",1051],["T_IF","if",1053],["T_WHITESPACE"," ",1053],"(",["T_VARIABLE","$type",1053],["T_WHITESPACE"," ",1053],["T_IS_NOT_EQUAL","!=",1053],["T_WHITESPACE"," ",1053],["T_STRING","NET_SSH2_MSG_NEWKEYS",1053],")",["T_WHITESPACE"," ",1053],"{",["T_WHITESPACE","\n            ",1053],["T_STRING","user_error",1054],"(",["T_CONSTANT_ENCAPSED_STRING","'Expected SSH_MSG_NEWKEYS'",1054],",",["T_WHITESPACE"," ",1054],["T_STRING","E_USER_NOTICE",1054],")",";",["T_WHITESPACE","\n            ",1054],["T_RETURN","return",1055],["T_WHITESPACE"," ",1055],["T_STRING","false",1055],";",["T_WHITESPACE","\n        ",1055],"}",["T_WHITESPACE","\n\n        ",1056],["T_SWITCH","switch",1058],["T_WHITESPACE"," ",1058],"(",["T_VARIABLE","$encrypt",1058],")",["T_WHITESPACE"," ",1058],"{",["T_WHITESPACE","\n            ",1058],["T_CASE","case",1059],["T_WHITESPACE"," ",1059],["T_CONSTANT_ENCAPSED_STRING","'3des-cbc'",1059],":",["T_WHITESPACE","\n                ",1059],["T_VARIABLE","$this",1060],["T_OBJECT_OPERATOR","->",1060],["T_STRING","encrypt",1060],["T_WHITESPACE"," ",1060],"=",["T_WHITESPACE"," ",1060],["T_NEW","new",1060],["T_WHITESPACE"," ",1060],["T_STRING","Crypt_TripleDES",1060],"(",")",";",["T_WHITESPACE","\n                ",1060],["T_COMMENT","\/\/ $this->encrypt_block_size = 64 \/ 8 == the default\n",1061],["T_WHITESPACE","                ",1062],["T_BREAK","break",1062],";",["T_WHITESPACE","\n            ",1062],["T_CASE","case",1063],["T_WHITESPACE"," ",1063],["T_CONSTANT_ENCAPSED_STRING","'3des-ctr'",1063],":",["T_WHITESPACE","\n                ",1063],["T_VARIABLE","$this",1064],["T_OBJECT_OPERATOR","->",1064],["T_STRING","encrypt",1064],["T_WHITESPACE"," ",1064],"=",["T_WHITESPACE"," ",1064],["T_NEW","new",1064],["T_WHITESPACE"," ",1064],["T_STRING","Crypt_TripleDES",1064],"(",["T_STRING","CRYPT_DES_MODE_CTR",1064],")",";",["T_WHITESPACE","\n                ",1064],["T_COMMENT","\/\/ $this->encrypt_block_size = 64 \/ 8 == the default\n",1065],["T_WHITESPACE","                ",1066],["T_BREAK","break",1066],";",["T_WHITESPACE","\n            ",1066],["T_CASE","case",1067],["T_WHITESPACE"," ",1067],["T_CONSTANT_ENCAPSED_STRING","'aes256-cbc'",1067],":",["T_WHITESPACE","\n            ",1067],["T_CASE","case",1068],["T_WHITESPACE"," ",1068],["T_CONSTANT_ENCAPSED_STRING","'aes192-cbc'",1068],":",["T_WHITESPACE","\n            ",1068],["T_CASE","case",1069],["T_WHITESPACE"," ",1069],["T_CONSTANT_ENCAPSED_STRING","'aes128-cbc'",1069],":",["T_WHITESPACE","\n                ",1069],["T_VARIABLE","$this",1070],["T_OBJECT_OPERATOR","->",1070],["T_STRING","encrypt",1070],["T_WHITESPACE"," ",1070],"=",["T_WHITESPACE"," ",1070],["T_NEW","new",1070],["T_WHITESPACE"," ",1070],["T_STRING","Crypt_AES",1070],"(",")",";",["T_WHITESPACE","\n                ",1070],["T_VARIABLE","$this",1071],["T_OBJECT_OPERATOR","->",1071],["T_STRING","encrypt_block_size",1071],["T_WHITESPACE"," ",1071],"=",["T_WHITESPACE"," ",1071],["T_LNUMBER","16",1071],";",["T_WHITESPACE"," ",1071],["T_COMMENT","\/\/ eg. 128 \/ 8\n",1071],["T_WHITESPACE","                ",1072],["T_BREAK","break",1072],";",["T_WHITESPACE","\n            ",1072],["T_CASE","case",1073],["T_WHITESPACE"," ",1073],["T_CONSTANT_ENCAPSED_STRING","'aes256-ctr'",1073],":",["T_WHITESPACE","\n            ",1073],["T_CASE","case",1074],["T_WHITESPACE"," ",1074],["T_CONSTANT_ENCAPSED_STRING","'aes192-ctr'",1074],":",["T_WHITESPACE","\n            ",1074],["T_CASE","case",1075],["T_WHITESPACE"," ",1075],["T_CONSTANT_ENCAPSED_STRING","'aes128-ctr'",1075],":",["T_WHITESPACE","\n                ",1075],["T_VARIABLE","$this",1076],["T_OBJECT_OPERATOR","->",1076],["T_STRING","encrypt",1076],["T_WHITESPACE"," ",1076],"=",["T_WHITESPACE"," ",1076],["T_NEW","new",1076],["T_WHITESPACE"," ",1076],["T_STRING","Crypt_AES",1076],"(",["T_STRING","CRYPT_AES_MODE_CTR",1076],")",";",["T_WHITESPACE","\n                ",1076],["T_VARIABLE","$this",1077],["T_OBJECT_OPERATOR","->",1077],["T_STRING","encrypt_block_size",1077],["T_WHITESPACE"," ",1077],"=",["T_WHITESPACE"," ",1077],["T_LNUMBER","16",1077],";",["T_WHITESPACE"," ",1077],["T_COMMENT","\/\/ eg. 128 \/ 8\n",1077],["T_WHITESPACE","                ",1078],["T_BREAK","break",1078],";",["T_WHITESPACE","\n            ",1078],["T_CASE","case",1079],["T_WHITESPACE"," ",1079],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",1079],":",["T_WHITESPACE","\n            ",1079],["T_CASE","case",1080],["T_WHITESPACE"," ",1080],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",1080],":",["T_WHITESPACE","\n            ",1080],["T_CASE","case",1081],["T_WHITESPACE"," ",1081],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",1081],":",["T_WHITESPACE","\n                ",1081],["T_VARIABLE","$this",1082],["T_OBJECT_OPERATOR","->",1082],["T_STRING","encrypt",1082],["T_WHITESPACE"," ",1082],"=",["T_WHITESPACE"," ",1082],["T_NEW","new",1082],["T_WHITESPACE"," ",1082],["T_STRING","Crypt_RC4",1082],"(",")",";",["T_WHITESPACE","\n                ",1082],["T_BREAK","break",1083],";",["T_WHITESPACE","\n            ",1083],["T_CASE","case",1084],["T_WHITESPACE"," ",1084],["T_CONSTANT_ENCAPSED_STRING","'none'",1084],";",["T_WHITESPACE","\n                ",1084],["T_COMMENT","\/\/$this->encrypt = new Crypt_Null();\n",1085],["T_WHITESPACE","        ",1086],"}",["T_WHITESPACE","\n\n        ",1086],["T_SWITCH","switch",1088],["T_WHITESPACE"," ",1088],"(",["T_VARIABLE","$decrypt",1088],")",["T_WHITESPACE"," ",1088],"{",["T_WHITESPACE","\n            ",1088],["T_CASE","case",1089],["T_WHITESPACE"," ",1089],["T_CONSTANT_ENCAPSED_STRING","'3des-cbc'",1089],":",["T_WHITESPACE","\n                ",1089],["T_VARIABLE","$this",1090],["T_OBJECT_OPERATOR","->",1090],["T_STRING","decrypt",1090],["T_WHITESPACE"," ",1090],"=",["T_WHITESPACE"," ",1090],["T_NEW","new",1090],["T_WHITESPACE"," ",1090],["T_STRING","Crypt_TripleDES",1090],"(",")",";",["T_WHITESPACE","\n                ",1090],["T_BREAK","break",1091],";",["T_WHITESPACE","\n            ",1091],["T_CASE","case",1092],["T_WHITESPACE"," ",1092],["T_CONSTANT_ENCAPSED_STRING","'3des-ctr'",1092],":",["T_WHITESPACE","\n                ",1092],["T_VARIABLE","$this",1093],["T_OBJECT_OPERATOR","->",1093],["T_STRING","decrypt",1093],["T_WHITESPACE"," ",1093],"=",["T_WHITESPACE"," ",1093],["T_NEW","new",1093],["T_WHITESPACE"," ",1093],["T_STRING","Crypt_TripleDES",1093],"(",["T_STRING","CRYPT_DES_MODE_CTR",1093],")",";",["T_WHITESPACE","\n                ",1093],["T_BREAK","break",1094],";",["T_WHITESPACE","\n            ",1094],["T_CASE","case",1095],["T_WHITESPACE"," ",1095],["T_CONSTANT_ENCAPSED_STRING","'aes256-cbc'",1095],":",["T_WHITESPACE","\n            ",1095],["T_CASE","case",1096],["T_WHITESPACE"," ",1096],["T_CONSTANT_ENCAPSED_STRING","'aes192-cbc'",1096],":",["T_WHITESPACE","\n            ",1096],["T_CASE","case",1097],["T_WHITESPACE"," ",1097],["T_CONSTANT_ENCAPSED_STRING","'aes128-cbc'",1097],":",["T_WHITESPACE","\n                ",1097],["T_VARIABLE","$this",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","decrypt",1098],["T_WHITESPACE"," ",1098],"=",["T_WHITESPACE"," ",1098],["T_NEW","new",1098],["T_WHITESPACE"," ",1098],["T_STRING","Crypt_AES",1098],"(",")",";",["T_WHITESPACE","\n                ",1098],["T_VARIABLE","$this",1099],["T_OBJECT_OPERATOR","->",1099],["T_STRING","decrypt_block_size",1099],["T_WHITESPACE"," ",1099],"=",["T_WHITESPACE"," ",1099],["T_LNUMBER","16",1099],";",["T_WHITESPACE","\n                ",1099],["T_BREAK","break",1100],";",["T_WHITESPACE","\n            ",1100],["T_CASE","case",1101],["T_WHITESPACE"," ",1101],["T_CONSTANT_ENCAPSED_STRING","'aes256-ctr'",1101],":",["T_WHITESPACE","\n            ",1101],["T_CASE","case",1102],["T_WHITESPACE"," ",1102],["T_CONSTANT_ENCAPSED_STRING","'aes192-ctr'",1102],":",["T_WHITESPACE","\n            ",1102],["T_CASE","case",1103],["T_WHITESPACE"," ",1103],["T_CONSTANT_ENCAPSED_STRING","'aes128-ctr'",1103],":",["T_WHITESPACE","\n                ",1103],["T_VARIABLE","$this",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","decrypt",1104],["T_WHITESPACE"," ",1104],"=",["T_WHITESPACE"," ",1104],["T_NEW","new",1104],["T_WHITESPACE"," ",1104],["T_STRING","Crypt_AES",1104],"(",["T_STRING","CRYPT_AES_MODE_CTR",1104],")",";",["T_WHITESPACE","\n                ",1104],["T_VARIABLE","$this",1105],["T_OBJECT_OPERATOR","->",1105],["T_STRING","decrypt_block_size",1105],["T_WHITESPACE"," ",1105],"=",["T_WHITESPACE"," ",1105],["T_LNUMBER","16",1105],";",["T_WHITESPACE","\n                ",1105],["T_BREAK","break",1106],";",["T_WHITESPACE","\n            ",1106],["T_CASE","case",1107],["T_WHITESPACE"," ",1107],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",1107],":",["T_WHITESPACE","\n            ",1107],["T_CASE","case",1108],["T_WHITESPACE"," ",1108],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",1108],":",["T_WHITESPACE","\n            ",1108],["T_CASE","case",1109],["T_WHITESPACE"," ",1109],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",1109],":",["T_WHITESPACE","\n                ",1109],["T_VARIABLE","$this",1110],["T_OBJECT_OPERATOR","->",1110],["T_STRING","decrypt",1110],["T_WHITESPACE"," ",1110],"=",["T_WHITESPACE"," ",1110],["T_NEW","new",1110],["T_WHITESPACE"," ",1110],["T_STRING","Crypt_RC4",1110],"(",")",";",["T_WHITESPACE","\n                ",1110],["T_BREAK","break",1111],";",["T_WHITESPACE","\n            ",1111],["T_CASE","case",1112],["T_WHITESPACE"," ",1112],["T_CONSTANT_ENCAPSED_STRING","'none'",1112],";",["T_WHITESPACE","\n                ",1112],["T_COMMENT","\/\/$this->decrypt = new Crypt_Null();\n",1113],["T_WHITESPACE","        ",1114],"}",["T_WHITESPACE","\n\n        ",1114],["T_VARIABLE","$keyBytes",1116],["T_WHITESPACE"," ",1116],"=",["T_WHITESPACE"," ",1116],["T_STRING","pack",1116],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*'",1116],",",["T_WHITESPACE"," ",1116],["T_STRING","strlen",1116],"(",["T_VARIABLE","$keyBytes",1116],")",",",["T_WHITESPACE"," ",1116],["T_VARIABLE","$keyBytes",1116],")",";",["T_WHITESPACE","\n\n        ",1116],["T_IF","if",1118],["T_WHITESPACE"," ",1118],"(",["T_VARIABLE","$this",1118],["T_OBJECT_OPERATOR","->",1118],["T_STRING","encrypt",1118],")",["T_WHITESPACE"," ",1118],"{",["T_WHITESPACE","\n            ",1118],["T_VARIABLE","$this",1119],["T_OBJECT_OPERATOR","->",1119],["T_STRING","encrypt",1119],["T_OBJECT_OPERATOR","->",1119],["T_STRING","enableContinuousBuffer",1119],"(",")",";",["T_WHITESPACE","\n            ",1119],["T_VARIABLE","$this",1120],["T_OBJECT_OPERATOR","->",1120],["T_STRING","encrypt",1120],["T_OBJECT_OPERATOR","->",1120],["T_STRING","disablePadding",1120],"(",")",";",["T_WHITESPACE","\n\n            ",1120],["T_VARIABLE","$iv",1122],["T_WHITESPACE"," ",1122],"=",["T_WHITESPACE"," ",1122],["T_STRING","pack",1122],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1122],",",["T_WHITESPACE"," ",1122],["T_VARIABLE","$hash",1122],"(",["T_VARIABLE","$keyBytes",1122],["T_WHITESPACE"," ",1122],".",["T_WHITESPACE"," ",1122],["T_VARIABLE","$this",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","session_id",1122],["T_WHITESPACE"," ",1122],".",["T_WHITESPACE"," ",1122],["T_CONSTANT_ENCAPSED_STRING","'A'",1122],["T_WHITESPACE"," ",1122],".",["T_WHITESPACE"," ",1122],["T_VARIABLE","$this",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","session_id",1122],")",")",";",["T_WHITESPACE","\n            ",1122],["T_WHILE","while",1123],["T_WHITESPACE"," ",1123],"(",["T_VARIABLE","$this",1123],["T_OBJECT_OPERATOR","->",1123],["T_STRING","encrypt_block_size",1123],["T_WHITESPACE"," ",1123],">",["T_WHITESPACE"," ",1123],["T_STRING","strlen",1123],"(",["T_VARIABLE","$iv",1123],")",")",["T_WHITESPACE"," ",1123],"{",["T_WHITESPACE","\n                ",1123],["T_VARIABLE","$iv",1124],["T_CONCAT_EQUAL",".=",1124],["T_WHITESPACE"," ",1124],["T_STRING","pack",1124],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1124],",",["T_WHITESPACE"," ",1124],["T_VARIABLE","$hash",1124],"(",["T_VARIABLE","$keyBytes",1124],["T_WHITESPACE"," ",1124],".",["T_WHITESPACE"," ",1124],["T_VARIABLE","$this",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","session_id",1124],["T_WHITESPACE"," ",1124],".",["T_WHITESPACE"," ",1124],["T_VARIABLE","$iv",1124],")",")",";",["T_WHITESPACE","\n            ",1124],"}",["T_WHITESPACE","\n            ",1125],["T_VARIABLE","$this",1126],["T_OBJECT_OPERATOR","->",1126],["T_STRING","encrypt",1126],["T_OBJECT_OPERATOR","->",1126],["T_STRING","setIV",1126],"(",["T_STRING","substr",1126],"(",["T_VARIABLE","$iv",1126],",",["T_WHITESPACE"," ",1126],["T_LNUMBER","0",1126],",",["T_WHITESPACE"," ",1126],["T_VARIABLE","$this",1126],["T_OBJECT_OPERATOR","->",1126],["T_STRING","encrypt_block_size",1126],")",")",";",["T_WHITESPACE","\n\n            ",1126],["T_VARIABLE","$key",1128],["T_WHITESPACE"," ",1128],"=",["T_WHITESPACE"," ",1128],["T_STRING","pack",1128],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1128],",",["T_WHITESPACE"," ",1128],["T_VARIABLE","$hash",1128],"(",["T_VARIABLE","$keyBytes",1128],["T_WHITESPACE"," ",1128],".",["T_WHITESPACE"," ",1128],["T_VARIABLE","$this",1128],["T_OBJECT_OPERATOR","->",1128],["T_STRING","session_id",1128],["T_WHITESPACE"," ",1128],".",["T_WHITESPACE"," ",1128],["T_CONSTANT_ENCAPSED_STRING","'C'",1128],["T_WHITESPACE"," ",1128],".",["T_WHITESPACE"," ",1128],["T_VARIABLE","$this",1128],["T_OBJECT_OPERATOR","->",1128],["T_STRING","session_id",1128],")",")",";",["T_WHITESPACE","\n            ",1128],["T_WHILE","while",1129],["T_WHITESPACE"," ",1129],"(",["T_VARIABLE","$encryptKeyLength",1129],["T_WHITESPACE"," ",1129],">",["T_WHITESPACE"," ",1129],["T_STRING","strlen",1129],"(",["T_VARIABLE","$key",1129],")",")",["T_WHITESPACE"," ",1129],"{",["T_WHITESPACE","\n                ",1129],["T_VARIABLE","$key",1130],["T_CONCAT_EQUAL",".=",1130],["T_WHITESPACE"," ",1130],["T_STRING","pack",1130],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1130],",",["T_WHITESPACE"," ",1130],["T_VARIABLE","$hash",1130],"(",["T_VARIABLE","$keyBytes",1130],["T_WHITESPACE"," ",1130],".",["T_WHITESPACE"," ",1130],["T_VARIABLE","$this",1130],["T_OBJECT_OPERATOR","->",1130],["T_STRING","session_id",1130],["T_WHITESPACE"," ",1130],".",["T_WHITESPACE"," ",1130],["T_VARIABLE","$key",1130],")",")",";",["T_WHITESPACE","\n            ",1130],"}",["T_WHITESPACE","\n            ",1131],["T_VARIABLE","$this",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","encrypt",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","setKey",1132],"(",["T_STRING","substr",1132],"(",["T_VARIABLE","$key",1132],",",["T_WHITESPACE"," ",1132],["T_LNUMBER","0",1132],",",["T_WHITESPACE"," ",1132],["T_VARIABLE","$encryptKeyLength",1132],")",")",";",["T_WHITESPACE","\n        ",1132],"}",["T_WHITESPACE","\n\n        ",1133],["T_IF","if",1135],["T_WHITESPACE"," ",1135],"(",["T_VARIABLE","$this",1135],["T_OBJECT_OPERATOR","->",1135],["T_STRING","decrypt",1135],")",["T_WHITESPACE"," ",1135],"{",["T_WHITESPACE","\n            ",1135],["T_VARIABLE","$this",1136],["T_OBJECT_OPERATOR","->",1136],["T_STRING","decrypt",1136],["T_OBJECT_OPERATOR","->",1136],["T_STRING","enableContinuousBuffer",1136],"(",")",";",["T_WHITESPACE","\n            ",1136],["T_VARIABLE","$this",1137],["T_OBJECT_OPERATOR","->",1137],["T_STRING","decrypt",1137],["T_OBJECT_OPERATOR","->",1137],["T_STRING","disablePadding",1137],"(",")",";",["T_WHITESPACE","\n\n            ",1137],["T_VARIABLE","$iv",1139],["T_WHITESPACE"," ",1139],"=",["T_WHITESPACE"," ",1139],["T_STRING","pack",1139],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1139],",",["T_WHITESPACE"," ",1139],["T_VARIABLE","$hash",1139],"(",["T_VARIABLE","$keyBytes",1139],["T_WHITESPACE"," ",1139],".",["T_WHITESPACE"," ",1139],["T_VARIABLE","$this",1139],["T_OBJECT_OPERATOR","->",1139],["T_STRING","session_id",1139],["T_WHITESPACE"," ",1139],".",["T_WHITESPACE"," ",1139],["T_CONSTANT_ENCAPSED_STRING","'B'",1139],["T_WHITESPACE"," ",1139],".",["T_WHITESPACE"," ",1139],["T_VARIABLE","$this",1139],["T_OBJECT_OPERATOR","->",1139],["T_STRING","session_id",1139],")",")",";",["T_WHITESPACE","\n            ",1139],["T_WHILE","while",1140],["T_WHITESPACE"," ",1140],"(",["T_VARIABLE","$this",1140],["T_OBJECT_OPERATOR","->",1140],["T_STRING","decrypt_block_size",1140],["T_WHITESPACE"," ",1140],">",["T_WHITESPACE"," ",1140],["T_STRING","strlen",1140],"(",["T_VARIABLE","$iv",1140],")",")",["T_WHITESPACE"," ",1140],"{",["T_WHITESPACE","\n                ",1140],["T_VARIABLE","$iv",1141],["T_CONCAT_EQUAL",".=",1141],["T_WHITESPACE"," ",1141],["T_STRING","pack",1141],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1141],",",["T_WHITESPACE"," ",1141],["T_VARIABLE","$hash",1141],"(",["T_VARIABLE","$keyBytes",1141],["T_WHITESPACE"," ",1141],".",["T_WHITESPACE"," ",1141],["T_VARIABLE","$this",1141],["T_OBJECT_OPERATOR","->",1141],["T_STRING","session_id",1141],["T_WHITESPACE"," ",1141],".",["T_WHITESPACE"," ",1141],["T_VARIABLE","$iv",1141],")",")",";",["T_WHITESPACE","\n            ",1141],"}",["T_WHITESPACE","\n            ",1142],["T_VARIABLE","$this",1143],["T_OBJECT_OPERATOR","->",1143],["T_STRING","decrypt",1143],["T_OBJECT_OPERATOR","->",1143],["T_STRING","setIV",1143],"(",["T_STRING","substr",1143],"(",["T_VARIABLE","$iv",1143],",",["T_WHITESPACE"," ",1143],["T_LNUMBER","0",1143],",",["T_WHITESPACE"," ",1143],["T_VARIABLE","$this",1143],["T_OBJECT_OPERATOR","->",1143],["T_STRING","decrypt_block_size",1143],")",")",";",["T_WHITESPACE","\n\n            ",1143],["T_VARIABLE","$key",1145],["T_WHITESPACE"," ",1145],"=",["T_WHITESPACE"," ",1145],["T_STRING","pack",1145],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1145],",",["T_WHITESPACE"," ",1145],["T_VARIABLE","$hash",1145],"(",["T_VARIABLE","$keyBytes",1145],["T_WHITESPACE"," ",1145],".",["T_WHITESPACE"," ",1145],["T_VARIABLE","$this",1145],["T_OBJECT_OPERATOR","->",1145],["T_STRING","session_id",1145],["T_WHITESPACE"," ",1145],".",["T_WHITESPACE"," ",1145],["T_CONSTANT_ENCAPSED_STRING","'D'",1145],["T_WHITESPACE"," ",1145],".",["T_WHITESPACE"," ",1145],["T_VARIABLE","$this",1145],["T_OBJECT_OPERATOR","->",1145],["T_STRING","session_id",1145],")",")",";",["T_WHITESPACE","\n            ",1145],["T_WHILE","while",1146],["T_WHITESPACE"," ",1146],"(",["T_VARIABLE","$decryptKeyLength",1146],["T_WHITESPACE"," ",1146],">",["T_WHITESPACE"," ",1146],["T_STRING","strlen",1146],"(",["T_VARIABLE","$key",1146],")",")",["T_WHITESPACE"," ",1146],"{",["T_WHITESPACE","\n                ",1146],["T_VARIABLE","$key",1147],["T_CONCAT_EQUAL",".=",1147],["T_WHITESPACE"," ",1147],["T_STRING","pack",1147],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1147],",",["T_WHITESPACE"," ",1147],["T_VARIABLE","$hash",1147],"(",["T_VARIABLE","$keyBytes",1147],["T_WHITESPACE"," ",1147],".",["T_WHITESPACE"," ",1147],["T_VARIABLE","$this",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","session_id",1147],["T_WHITESPACE"," ",1147],".",["T_WHITESPACE"," ",1147],["T_VARIABLE","$key",1147],")",")",";",["T_WHITESPACE","\n            ",1147],"}",["T_WHITESPACE","\n            ",1148],["T_VARIABLE","$this",1149],["T_OBJECT_OPERATOR","->",1149],["T_STRING","decrypt",1149],["T_OBJECT_OPERATOR","->",1149],["T_STRING","setKey",1149],"(",["T_STRING","substr",1149],"(",["T_VARIABLE","$key",1149],",",["T_WHITESPACE"," ",1149],["T_LNUMBER","0",1149],",",["T_WHITESPACE"," ",1149],["T_VARIABLE","$decryptKeyLength",1149],")",")",";",["T_WHITESPACE","\n        ",1149],"}",["T_WHITESPACE","\n\n        ",1150],["T_COMMENT","\/* The \"arcfour128\" algorithm is the RC4 cipher, as described in\n           [SCHNEIER], using a 128-bit key.  The first 1536 bytes of keystream\n           generated by the cipher MUST be discarded, and the first byte of the\n           first encrypted packet MUST be encrypted using the 1537th byte of\n           keystream.\n\n           -- http:\/\/tools.ietf.org\/html\/rfc4345#section-4 *\/",1152],["T_WHITESPACE","\n        ",1158],["T_IF","if",1159],["T_WHITESPACE"," ",1159],"(",["T_VARIABLE","$encrypt",1159],["T_WHITESPACE"," ",1159],["T_IS_EQUAL","==",1159],["T_WHITESPACE"," ",1159],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",1159],["T_WHITESPACE"," ",1159],["T_BOOLEAN_OR","||",1159],["T_WHITESPACE"," ",1159],["T_VARIABLE","$encrypt",1159],["T_WHITESPACE"," ",1159],["T_IS_EQUAL","==",1159],["T_WHITESPACE"," ",1159],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",1159],")",["T_WHITESPACE"," ",1159],"{",["T_WHITESPACE","\n            ",1159],["T_VARIABLE","$this",1160],["T_OBJECT_OPERATOR","->",1160],["T_STRING","encrypt",1160],["T_OBJECT_OPERATOR","->",1160],["T_STRING","encrypt",1160],"(",["T_STRING","str_repeat",1160],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",1160],",",["T_WHITESPACE"," ",1160],["T_LNUMBER","1536",1160],")",")",";",["T_WHITESPACE","\n        ",1160],"}",["T_WHITESPACE","\n        ",1161],["T_IF","if",1162],["T_WHITESPACE"," ",1162],"(",["T_VARIABLE","$decrypt",1162],["T_WHITESPACE"," ",1162],["T_IS_EQUAL","==",1162],["T_WHITESPACE"," ",1162],["T_CONSTANT_ENCAPSED_STRING","'arcfour128'",1162],["T_WHITESPACE"," ",1162],["T_BOOLEAN_OR","||",1162],["T_WHITESPACE"," ",1162],["T_VARIABLE","$decrypt",1162],["T_WHITESPACE"," ",1162],["T_IS_EQUAL","==",1162],["T_WHITESPACE"," ",1162],["T_CONSTANT_ENCAPSED_STRING","'arcfour256'",1162],")",["T_WHITESPACE"," ",1162],"{",["T_WHITESPACE","\n            ",1162],["T_VARIABLE","$this",1163],["T_OBJECT_OPERATOR","->",1163],["T_STRING","decrypt",1163],["T_OBJECT_OPERATOR","->",1163],["T_STRING","decrypt",1163],"(",["T_STRING","str_repeat",1163],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",1163],",",["T_WHITESPACE"," ",1163],["T_LNUMBER","1536",1163],")",")",";",["T_WHITESPACE","\n        ",1163],"}",["T_WHITESPACE","\n\n        ",1164],["T_FOR","for",1166],["T_WHITESPACE"," ",1166],"(",["T_VARIABLE","$i",1166],["T_WHITESPACE"," ",1166],"=",["T_WHITESPACE"," ",1166],["T_LNUMBER","0",1166],";",["T_WHITESPACE"," ",1166],["T_VARIABLE","$i",1166],["T_WHITESPACE"," ",1166],"<",["T_WHITESPACE"," ",1166],["T_STRING","count",1166],"(",["T_VARIABLE","$mac_algorithms",1166],")",["T_WHITESPACE"," ",1166],["T_BOOLEAN_AND","&&",1166],["T_WHITESPACE"," ",1166],"!",["T_STRING","in_array",1166],"(",["T_VARIABLE","$mac_algorithms",1166],"[",["T_VARIABLE","$i",1166],"]",",",["T_WHITESPACE"," ",1166],["T_VARIABLE","$this",1166],["T_OBJECT_OPERATOR","->",1166],["T_STRING","mac_algorithms_client_to_server",1166],")",";",["T_WHITESPACE"," ",1166],["T_VARIABLE","$i",1166],["T_INC","++",1166],")",";",["T_WHITESPACE","\n        ",1166],["T_IF","if",1167],["T_WHITESPACE"," ",1167],"(",["T_VARIABLE","$i",1167],["T_WHITESPACE"," ",1167],["T_IS_EQUAL","==",1167],["T_WHITESPACE"," ",1167],["T_STRING","count",1167],"(",["T_VARIABLE","$mac_algorithms",1167],")",")",["T_WHITESPACE"," ",1167],"{",["T_WHITESPACE","\n            ",1167],["T_STRING","user_error",1168],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible client to server message authentication algorithms found'",1168],",",["T_WHITESPACE"," ",1168],["T_STRING","E_USER_NOTICE",1168],")",";",["T_WHITESPACE","\n            ",1168],["T_RETURN","return",1169],["T_WHITESPACE"," ",1169],["T_VARIABLE","$this",1169],["T_OBJECT_OPERATOR","->",1169],["T_STRING","_disconnect",1169],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",1169],")",";",["T_WHITESPACE","\n        ",1169],"}",["T_WHITESPACE","\n\n        ",1170],["T_VARIABLE","$createKeyLength",1172],["T_WHITESPACE"," ",1172],"=",["T_WHITESPACE"," ",1172],["T_LNUMBER","0",1172],";",["T_WHITESPACE"," ",1172],["T_COMMENT","\/\/ ie. $mac_algorithms[$i] == 'none'\n",1172],["T_WHITESPACE","        ",1173],["T_SWITCH","switch",1173],["T_WHITESPACE"," ",1173],"(",["T_VARIABLE","$mac_algorithms",1173],"[",["T_VARIABLE","$i",1173],"]",")",["T_WHITESPACE"," ",1173],"{",["T_WHITESPACE","\n            ",1173],["T_CASE","case",1174],["T_WHITESPACE"," ",1174],["T_CONSTANT_ENCAPSED_STRING","'hmac-sha1'",1174],":",["T_WHITESPACE","\n                ",1174],["T_VARIABLE","$this",1175],["T_OBJECT_OPERATOR","->",1175],["T_STRING","hmac_create",1175],["T_WHITESPACE"," ",1175],"=",["T_WHITESPACE"," ",1175],["T_NEW","new",1175],["T_WHITESPACE"," ",1175],["T_STRING","Crypt_Hash",1175],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1'",1175],")",";",["T_WHITESPACE","\n                ",1175],["T_VARIABLE","$createKeyLength",1176],["T_WHITESPACE"," ",1176],"=",["T_WHITESPACE"," ",1176],["T_LNUMBER","20",1176],";",["T_WHITESPACE","\n                ",1176],["T_BREAK","break",1177],";",["T_WHITESPACE","\n            ",1177],["T_CASE","case",1178],["T_WHITESPACE"," ",1178],["T_CONSTANT_ENCAPSED_STRING","'hmac-sha1-96'",1178],":",["T_WHITESPACE","\n                ",1178],["T_VARIABLE","$this",1179],["T_OBJECT_OPERATOR","->",1179],["T_STRING","hmac_create",1179],["T_WHITESPACE"," ",1179],"=",["T_WHITESPACE"," ",1179],["T_NEW","new",1179],["T_WHITESPACE"," ",1179],["T_STRING","Crypt_Hash",1179],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1-96'",1179],")",";",["T_WHITESPACE","\n                ",1179],["T_VARIABLE","$createKeyLength",1180],["T_WHITESPACE"," ",1180],"=",["T_WHITESPACE"," ",1180],["T_LNUMBER","20",1180],";",["T_WHITESPACE","\n                ",1180],["T_BREAK","break",1181],";",["T_WHITESPACE","\n            ",1181],["T_CASE","case",1182],["T_WHITESPACE"," ",1182],["T_CONSTANT_ENCAPSED_STRING","'hmac-md5'",1182],":",["T_WHITESPACE","\n                ",1182],["T_VARIABLE","$this",1183],["T_OBJECT_OPERATOR","->",1183],["T_STRING","hmac_create",1183],["T_WHITESPACE"," ",1183],"=",["T_WHITESPACE"," ",1183],["T_NEW","new",1183],["T_WHITESPACE"," ",1183],["T_STRING","Crypt_Hash",1183],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",1183],")",";",["T_WHITESPACE","\n                ",1183],["T_VARIABLE","$createKeyLength",1184],["T_WHITESPACE"," ",1184],"=",["T_WHITESPACE"," ",1184],["T_LNUMBER","16",1184],";",["T_WHITESPACE","\n                ",1184],["T_BREAK","break",1185],";",["T_WHITESPACE","\n            ",1185],["T_CASE","case",1186],["T_WHITESPACE"," ",1186],["T_CONSTANT_ENCAPSED_STRING","'hmac-md5-96'",1186],":",["T_WHITESPACE","\n                ",1186],["T_VARIABLE","$this",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","hmac_create",1187],["T_WHITESPACE"," ",1187],"=",["T_WHITESPACE"," ",1187],["T_NEW","new",1187],["T_WHITESPACE"," ",1187],["T_STRING","Crypt_Hash",1187],"(",["T_CONSTANT_ENCAPSED_STRING","'md5-96'",1187],")",";",["T_WHITESPACE","\n                ",1187],["T_VARIABLE","$createKeyLength",1188],["T_WHITESPACE"," ",1188],"=",["T_WHITESPACE"," ",1188],["T_LNUMBER","16",1188],";",["T_WHITESPACE","\n        ",1188],"}",["T_WHITESPACE","\n\n        ",1189],["T_FOR","for",1191],["T_WHITESPACE"," ",1191],"(",["T_VARIABLE","$i",1191],["T_WHITESPACE"," ",1191],"=",["T_WHITESPACE"," ",1191],["T_LNUMBER","0",1191],";",["T_WHITESPACE"," ",1191],["T_VARIABLE","$i",1191],["T_WHITESPACE"," ",1191],"<",["T_WHITESPACE"," ",1191],["T_STRING","count",1191],"(",["T_VARIABLE","$mac_algorithms",1191],")",["T_WHITESPACE"," ",1191],["T_BOOLEAN_AND","&&",1191],["T_WHITESPACE"," ",1191],"!",["T_STRING","in_array",1191],"(",["T_VARIABLE","$mac_algorithms",1191],"[",["T_VARIABLE","$i",1191],"]",",",["T_WHITESPACE"," ",1191],["T_VARIABLE","$this",1191],["T_OBJECT_OPERATOR","->",1191],["T_STRING","mac_algorithms_server_to_client",1191],")",";",["T_WHITESPACE"," ",1191],["T_VARIABLE","$i",1191],["T_INC","++",1191],")",";",["T_WHITESPACE","\n        ",1191],["T_IF","if",1192],["T_WHITESPACE"," ",1192],"(",["T_VARIABLE","$i",1192],["T_WHITESPACE"," ",1192],["T_IS_EQUAL","==",1192],["T_WHITESPACE"," ",1192],["T_STRING","count",1192],"(",["T_VARIABLE","$mac_algorithms",1192],")",")",["T_WHITESPACE"," ",1192],"{",["T_WHITESPACE","\n            ",1192],["T_STRING","user_error",1193],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible server to client message authentication algorithms found'",1193],",",["T_WHITESPACE"," ",1193],["T_STRING","E_USER_NOTICE",1193],")",";",["T_WHITESPACE","\n            ",1193],["T_RETURN","return",1194],["T_WHITESPACE"," ",1194],["T_VARIABLE","$this",1194],["T_OBJECT_OPERATOR","->",1194],["T_STRING","_disconnect",1194],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",1194],")",";",["T_WHITESPACE","\n        ",1194],"}",["T_WHITESPACE","\n\n        ",1195],["T_VARIABLE","$checkKeyLength",1197],["T_WHITESPACE"," ",1197],"=",["T_WHITESPACE"," ",1197],["T_LNUMBER","0",1197],";",["T_WHITESPACE","\n        ",1197],["T_VARIABLE","$this",1198],["T_OBJECT_OPERATOR","->",1198],["T_STRING","hmac_size",1198],["T_WHITESPACE"," ",1198],"=",["T_WHITESPACE"," ",1198],["T_LNUMBER","0",1198],";",["T_WHITESPACE","\n        ",1198],["T_SWITCH","switch",1199],["T_WHITESPACE"," ",1199],"(",["T_VARIABLE","$mac_algorithms",1199],"[",["T_VARIABLE","$i",1199],"]",")",["T_WHITESPACE"," ",1199],"{",["T_WHITESPACE","\n            ",1199],["T_CASE","case",1200],["T_WHITESPACE"," ",1200],["T_CONSTANT_ENCAPSED_STRING","'hmac-sha1'",1200],":",["T_WHITESPACE","\n                ",1200],["T_VARIABLE","$this",1201],["T_OBJECT_OPERATOR","->",1201],["T_STRING","hmac_check",1201],["T_WHITESPACE"," ",1201],"=",["T_WHITESPACE"," ",1201],["T_NEW","new",1201],["T_WHITESPACE"," ",1201],["T_STRING","Crypt_Hash",1201],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1'",1201],")",";",["T_WHITESPACE","\n                ",1201],["T_VARIABLE","$checkKeyLength",1202],["T_WHITESPACE"," ",1202],"=",["T_WHITESPACE"," ",1202],["T_LNUMBER","20",1202],";",["T_WHITESPACE","\n                ",1202],["T_VARIABLE","$this",1203],["T_OBJECT_OPERATOR","->",1203],["T_STRING","hmac_size",1203],["T_WHITESPACE"," ",1203],"=",["T_WHITESPACE"," ",1203],["T_LNUMBER","20",1203],";",["T_WHITESPACE","\n                ",1203],["T_BREAK","break",1204],";",["T_WHITESPACE","\n            ",1204],["T_CASE","case",1205],["T_WHITESPACE"," ",1205],["T_CONSTANT_ENCAPSED_STRING","'hmac-sha1-96'",1205],":",["T_WHITESPACE","\n                ",1205],["T_VARIABLE","$this",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","hmac_check",1206],["T_WHITESPACE"," ",1206],"=",["T_WHITESPACE"," ",1206],["T_NEW","new",1206],["T_WHITESPACE"," ",1206],["T_STRING","Crypt_Hash",1206],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1-96'",1206],")",";",["T_WHITESPACE","\n                ",1206],["T_VARIABLE","$checkKeyLength",1207],["T_WHITESPACE"," ",1207],"=",["T_WHITESPACE"," ",1207],["T_LNUMBER","20",1207],";",["T_WHITESPACE","\n                ",1207],["T_VARIABLE","$this",1208],["T_OBJECT_OPERATOR","->",1208],["T_STRING","hmac_size",1208],["T_WHITESPACE"," ",1208],"=",["T_WHITESPACE"," ",1208],["T_LNUMBER","12",1208],";",["T_WHITESPACE","\n                ",1208],["T_BREAK","break",1209],";",["T_WHITESPACE","\n            ",1209],["T_CASE","case",1210],["T_WHITESPACE"," ",1210],["T_CONSTANT_ENCAPSED_STRING","'hmac-md5'",1210],":",["T_WHITESPACE","\n                ",1210],["T_VARIABLE","$this",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","hmac_check",1211],["T_WHITESPACE"," ",1211],"=",["T_WHITESPACE"," ",1211],["T_NEW","new",1211],["T_WHITESPACE"," ",1211],["T_STRING","Crypt_Hash",1211],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",1211],")",";",["T_WHITESPACE","\n                ",1211],["T_VARIABLE","$checkKeyLength",1212],["T_WHITESPACE"," ",1212],"=",["T_WHITESPACE"," ",1212],["T_LNUMBER","16",1212],";",["T_WHITESPACE","\n                ",1212],["T_VARIABLE","$this",1213],["T_OBJECT_OPERATOR","->",1213],["T_STRING","hmac_size",1213],["T_WHITESPACE"," ",1213],"=",["T_WHITESPACE"," ",1213],["T_LNUMBER","16",1213],";",["T_WHITESPACE","\n                ",1213],["T_BREAK","break",1214],";",["T_WHITESPACE","\n            ",1214],["T_CASE","case",1215],["T_WHITESPACE"," ",1215],["T_CONSTANT_ENCAPSED_STRING","'hmac-md5-96'",1215],":",["T_WHITESPACE","\n                ",1215],["T_VARIABLE","$this",1216],["T_OBJECT_OPERATOR","->",1216],["T_STRING","hmac_check",1216],["T_WHITESPACE"," ",1216],"=",["T_WHITESPACE"," ",1216],["T_NEW","new",1216],["T_WHITESPACE"," ",1216],["T_STRING","Crypt_Hash",1216],"(",["T_CONSTANT_ENCAPSED_STRING","'md5-96'",1216],")",";",["T_WHITESPACE","\n                ",1216],["T_VARIABLE","$checkKeyLength",1217],["T_WHITESPACE"," ",1217],"=",["T_WHITESPACE"," ",1217],["T_LNUMBER","16",1217],";",["T_WHITESPACE","\n                ",1217],["T_VARIABLE","$this",1218],["T_OBJECT_OPERATOR","->",1218],["T_STRING","hmac_size",1218],["T_WHITESPACE"," ",1218],"=",["T_WHITESPACE"," ",1218],["T_LNUMBER","12",1218],";",["T_WHITESPACE","\n        ",1218],"}",["T_WHITESPACE","\n\n        ",1219],["T_VARIABLE","$key",1221],["T_WHITESPACE"," ",1221],"=",["T_WHITESPACE"," ",1221],["T_STRING","pack",1221],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1221],",",["T_WHITESPACE"," ",1221],["T_VARIABLE","$hash",1221],"(",["T_VARIABLE","$keyBytes",1221],["T_WHITESPACE"," ",1221],".",["T_WHITESPACE"," ",1221],["T_VARIABLE","$this",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","session_id",1221],["T_WHITESPACE"," ",1221],".",["T_WHITESPACE"," ",1221],["T_CONSTANT_ENCAPSED_STRING","'E'",1221],["T_WHITESPACE"," ",1221],".",["T_WHITESPACE"," ",1221],["T_VARIABLE","$this",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","session_id",1221],")",")",";",["T_WHITESPACE","\n        ",1221],["T_WHILE","while",1222],["T_WHITESPACE"," ",1222],"(",["T_VARIABLE","$createKeyLength",1222],["T_WHITESPACE"," ",1222],">",["T_WHITESPACE"," ",1222],["T_STRING","strlen",1222],"(",["T_VARIABLE","$key",1222],")",")",["T_WHITESPACE"," ",1222],"{",["T_WHITESPACE","\n            ",1222],["T_VARIABLE","$key",1223],["T_CONCAT_EQUAL",".=",1223],["T_WHITESPACE"," ",1223],["T_STRING","pack",1223],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1223],",",["T_WHITESPACE"," ",1223],["T_VARIABLE","$hash",1223],"(",["T_VARIABLE","$keyBytes",1223],["T_WHITESPACE"," ",1223],".",["T_WHITESPACE"," ",1223],["T_VARIABLE","$this",1223],["T_OBJECT_OPERATOR","->",1223],["T_STRING","session_id",1223],["T_WHITESPACE"," ",1223],".",["T_WHITESPACE"," ",1223],["T_VARIABLE","$key",1223],")",")",";",["T_WHITESPACE","\n        ",1223],"}",["T_WHITESPACE","\n        ",1224],["T_VARIABLE","$this",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","hmac_create",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","setKey",1225],"(",["T_STRING","substr",1225],"(",["T_VARIABLE","$key",1225],",",["T_WHITESPACE"," ",1225],["T_LNUMBER","0",1225],",",["T_WHITESPACE"," ",1225],["T_VARIABLE","$createKeyLength",1225],")",")",";",["T_WHITESPACE","\n\n        ",1225],["T_VARIABLE","$key",1227],["T_WHITESPACE"," ",1227],"=",["T_WHITESPACE"," ",1227],["T_STRING","pack",1227],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1227],",",["T_WHITESPACE"," ",1227],["T_VARIABLE","$hash",1227],"(",["T_VARIABLE","$keyBytes",1227],["T_WHITESPACE"," ",1227],".",["T_WHITESPACE"," ",1227],["T_VARIABLE","$this",1227],["T_OBJECT_OPERATOR","->",1227],["T_STRING","session_id",1227],["T_WHITESPACE"," ",1227],".",["T_WHITESPACE"," ",1227],["T_CONSTANT_ENCAPSED_STRING","'F'",1227],["T_WHITESPACE"," ",1227],".",["T_WHITESPACE"," ",1227],["T_VARIABLE","$this",1227],["T_OBJECT_OPERATOR","->",1227],["T_STRING","session_id",1227],")",")",";",["T_WHITESPACE","\n        ",1227],["T_WHILE","while",1228],["T_WHITESPACE"," ",1228],"(",["T_VARIABLE","$checkKeyLength",1228],["T_WHITESPACE"," ",1228],">",["T_WHITESPACE"," ",1228],["T_STRING","strlen",1228],"(",["T_VARIABLE","$key",1228],")",")",["T_WHITESPACE"," ",1228],"{",["T_WHITESPACE","\n            ",1228],["T_VARIABLE","$key",1229],["T_CONCAT_EQUAL",".=",1229],["T_WHITESPACE"," ",1229],["T_STRING","pack",1229],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1229],",",["T_WHITESPACE"," ",1229],["T_VARIABLE","$hash",1229],"(",["T_VARIABLE","$keyBytes",1229],["T_WHITESPACE"," ",1229],".",["T_WHITESPACE"," ",1229],["T_VARIABLE","$this",1229],["T_OBJECT_OPERATOR","->",1229],["T_STRING","session_id",1229],["T_WHITESPACE"," ",1229],".",["T_WHITESPACE"," ",1229],["T_VARIABLE","$key",1229],")",")",";",["T_WHITESPACE","\n        ",1229],"}",["T_WHITESPACE","\n        ",1230],["T_VARIABLE","$this",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","hmac_check",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","setKey",1231],"(",["T_STRING","substr",1231],"(",["T_VARIABLE","$key",1231],",",["T_WHITESPACE"," ",1231],["T_LNUMBER","0",1231],",",["T_WHITESPACE"," ",1231],["T_VARIABLE","$checkKeyLength",1231],")",")",";",["T_WHITESPACE","\n\n        ",1231],["T_FOR","for",1233],["T_WHITESPACE"," ",1233],"(",["T_VARIABLE","$i",1233],["T_WHITESPACE"," ",1233],"=",["T_WHITESPACE"," ",1233],["T_LNUMBER","0",1233],";",["T_WHITESPACE"," ",1233],["T_VARIABLE","$i",1233],["T_WHITESPACE"," ",1233],"<",["T_WHITESPACE"," ",1233],["T_STRING","count",1233],"(",["T_VARIABLE","$compression_algorithms",1233],")",["T_WHITESPACE"," ",1233],["T_BOOLEAN_AND","&&",1233],["T_WHITESPACE"," ",1233],"!",["T_STRING","in_array",1233],"(",["T_VARIABLE","$compression_algorithms",1233],"[",["T_VARIABLE","$i",1233],"]",",",["T_WHITESPACE"," ",1233],["T_VARIABLE","$this",1233],["T_OBJECT_OPERATOR","->",1233],["T_STRING","compression_algorithms_server_to_client",1233],")",";",["T_WHITESPACE"," ",1233],["T_VARIABLE","$i",1233],["T_INC","++",1233],")",";",["T_WHITESPACE","\n        ",1233],["T_IF","if",1234],["T_WHITESPACE"," ",1234],"(",["T_VARIABLE","$i",1234],["T_WHITESPACE"," ",1234],["T_IS_EQUAL","==",1234],["T_WHITESPACE"," ",1234],["T_STRING","count",1234],"(",["T_VARIABLE","$compression_algorithms",1234],")",")",["T_WHITESPACE"," ",1234],"{",["T_WHITESPACE","\n            ",1234],["T_STRING","user_error",1235],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible server to client compression algorithms found'",1235],",",["T_WHITESPACE"," ",1235],["T_STRING","E_USER_NOTICE",1235],")",";",["T_WHITESPACE","\n            ",1235],["T_RETURN","return",1236],["T_WHITESPACE"," ",1236],["T_VARIABLE","$this",1236],["T_OBJECT_OPERATOR","->",1236],["T_STRING","_disconnect",1236],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",1236],")",";",["T_WHITESPACE","\n        ",1236],"}",["T_WHITESPACE","\n        ",1237],["T_VARIABLE","$this",1238],["T_OBJECT_OPERATOR","->",1238],["T_STRING","decompress",1238],["T_WHITESPACE"," ",1238],"=",["T_WHITESPACE"," ",1238],["T_VARIABLE","$compression_algorithms",1238],"[",["T_VARIABLE","$i",1238],"]",["T_WHITESPACE"," ",1238],["T_IS_EQUAL","==",1238],["T_WHITESPACE"," ",1238],["T_CONSTANT_ENCAPSED_STRING","'zlib'",1238],";",["T_WHITESPACE","\n\n        ",1238],["T_FOR","for",1240],["T_WHITESPACE"," ",1240],"(",["T_VARIABLE","$i",1240],["T_WHITESPACE"," ",1240],"=",["T_WHITESPACE"," ",1240],["T_LNUMBER","0",1240],";",["T_WHITESPACE"," ",1240],["T_VARIABLE","$i",1240],["T_WHITESPACE"," ",1240],"<",["T_WHITESPACE"," ",1240],["T_STRING","count",1240],"(",["T_VARIABLE","$compression_algorithms",1240],")",["T_WHITESPACE"," ",1240],["T_BOOLEAN_AND","&&",1240],["T_WHITESPACE"," ",1240],"!",["T_STRING","in_array",1240],"(",["T_VARIABLE","$compression_algorithms",1240],"[",["T_VARIABLE","$i",1240],"]",",",["T_WHITESPACE"," ",1240],["T_VARIABLE","$this",1240],["T_OBJECT_OPERATOR","->",1240],["T_STRING","compression_algorithms_client_to_server",1240],")",";",["T_WHITESPACE"," ",1240],["T_VARIABLE","$i",1240],["T_INC","++",1240],")",";",["T_WHITESPACE","\n        ",1240],["T_IF","if",1241],["T_WHITESPACE"," ",1241],"(",["T_VARIABLE","$i",1241],["T_WHITESPACE"," ",1241],["T_IS_EQUAL","==",1241],["T_WHITESPACE"," ",1241],["T_STRING","count",1241],"(",["T_VARIABLE","$compression_algorithms",1241],")",")",["T_WHITESPACE"," ",1241],"{",["T_WHITESPACE","\n            ",1241],["T_STRING","user_error",1242],"(",["T_CONSTANT_ENCAPSED_STRING","'No compatible client to server compression algorithms found'",1242],",",["T_WHITESPACE"," ",1242],["T_STRING","E_USER_NOTICE",1242],")",";",["T_WHITESPACE","\n            ",1242],["T_RETURN","return",1243],["T_WHITESPACE"," ",1243],["T_VARIABLE","$this",1243],["T_OBJECT_OPERATOR","->",1243],["T_STRING","_disconnect",1243],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",1243],")",";",["T_WHITESPACE","\n        ",1243],"}",["T_WHITESPACE","\n        ",1244],["T_VARIABLE","$this",1245],["T_OBJECT_OPERATOR","->",1245],["T_STRING","compress",1245],["T_WHITESPACE"," ",1245],"=",["T_WHITESPACE"," ",1245],["T_VARIABLE","$compression_algorithms",1245],"[",["T_VARIABLE","$i",1245],"]",["T_WHITESPACE"," ",1245],["T_IS_EQUAL","==",1245],["T_WHITESPACE"," ",1245],["T_CONSTANT_ENCAPSED_STRING","'zlib'",1245],";",["T_WHITESPACE","\n\n        ",1245],["T_RETURN","return",1247],["T_WHITESPACE"," ",1247],["T_STRING","true",1247],";",["T_WHITESPACE","\n    ",1247],"}",["T_WHITESPACE","\n\n    ",1248],["T_DOC_COMMENT","\/**\n     * Login\n     *\n     * @param String $username\n     * @param optional String $password\n     * @return Boolean\n     * @access public\n     * @internal It might be worthwhile, at some point, to protect against {@link http:\/\/tools.ietf.org\/html\/rfc4251#section-9.3.9 traffic analysis}\n     *           by sending dummy SSH_MSG_IGNORE messages.\n     *\/",1250],["T_WHITESPACE","\n    ",1259],["T_FUNCTION","function",1260],["T_WHITESPACE"," ",1260],["T_STRING","login",1260],"(",["T_VARIABLE","$username",1260],",",["T_WHITESPACE"," ",1260],["T_VARIABLE","$password",1260],["T_WHITESPACE"," ",1260],"=",["T_WHITESPACE"," ",1260],["T_CONSTANT_ENCAPSED_STRING","''",1260],")",["T_WHITESPACE","\n    ",1260],"{",["T_WHITESPACE","\n        ",1261],["T_IF","if",1262],["T_WHITESPACE"," ",1262],"(","!","(",["T_VARIABLE","$this",1262],["T_OBJECT_OPERATOR","->",1262],["T_STRING","bitmap",1262],["T_WHITESPACE"," ",1262],"&",["T_WHITESPACE"," ",1262],["T_STRING","NET_SSH2_MASK_CONSTRUCTOR",1262],")",")",["T_WHITESPACE"," ",1262],"{",["T_WHITESPACE","\n            ",1262],["T_RETURN","return",1263],["T_WHITESPACE"," ",1263],["T_STRING","false",1263],";",["T_WHITESPACE","\n        ",1263],"}",["T_WHITESPACE","\n\n        ",1264],["T_VARIABLE","$packet",1266],["T_WHITESPACE"," ",1266],"=",["T_WHITESPACE"," ",1266],["T_STRING","pack",1266],"(",["T_CONSTANT_ENCAPSED_STRING","'CNa*'",1266],",",["T_WHITESPACE","\n            ",1266],["T_STRING","NET_SSH2_MSG_SERVICE_REQUEST",1267],",",["T_WHITESPACE"," ",1267],["T_STRING","strlen",1267],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-userauth'",1267],")",",",["T_WHITESPACE"," ",1267],["T_CONSTANT_ENCAPSED_STRING","'ssh-userauth'",1267],["T_WHITESPACE","\n        ",1267],")",";",["T_WHITESPACE","\n\n        ",1268],["T_IF","if",1270],["T_WHITESPACE"," ",1270],"(","!",["T_VARIABLE","$this",1270],["T_OBJECT_OPERATOR","->",1270],["T_STRING","_send_binary_packet",1270],"(",["T_VARIABLE","$packet",1270],")",")",["T_WHITESPACE"," ",1270],"{",["T_WHITESPACE","\n            ",1270],["T_RETURN","return",1271],["T_WHITESPACE"," ",1271],["T_STRING","false",1271],";",["T_WHITESPACE","\n        ",1271],"}",["T_WHITESPACE","\n\n        ",1272],["T_VARIABLE","$response",1274],["T_WHITESPACE"," ",1274],"=",["T_WHITESPACE"," ",1274],["T_VARIABLE","$this",1274],["T_OBJECT_OPERATOR","->",1274],["T_STRING","_get_binary_packet",1274],"(",")",";",["T_WHITESPACE","\n        ",1274],["T_IF","if",1275],["T_WHITESPACE"," ",1275],"(",["T_VARIABLE","$response",1275],["T_WHITESPACE"," ",1275],["T_IS_IDENTICAL","===",1275],["T_WHITESPACE"," ",1275],["T_STRING","false",1275],")",["T_WHITESPACE"," ",1275],"{",["T_WHITESPACE","\n            ",1275],["T_STRING","user_error",1276],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",1276],",",["T_WHITESPACE"," ",1276],["T_STRING","E_USER_NOTICE",1276],")",";",["T_WHITESPACE","\n            ",1276],["T_RETURN","return",1277],["T_WHITESPACE"," ",1277],["T_STRING","false",1277],";",["T_WHITESPACE","\n        ",1277],"}",["T_WHITESPACE","\n\n        ",1278],["T_STRING","extract",1280],"(",["T_STRING","unpack",1280],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype'",1280],",",["T_WHITESPACE"," ",1280],["T_VARIABLE","$this",1280],["T_OBJECT_OPERATOR","->",1280],["T_STRING","_string_shift",1280],"(",["T_VARIABLE","$response",1280],",",["T_WHITESPACE"," ",1280],["T_LNUMBER","1",1280],")",")",")",";",["T_WHITESPACE","\n\n        ",1280],["T_IF","if",1282],["T_WHITESPACE"," ",1282],"(",["T_VARIABLE","$type",1282],["T_WHITESPACE"," ",1282],["T_IS_NOT_EQUAL","!=",1282],["T_WHITESPACE"," ",1282],["T_STRING","NET_SSH2_MSG_SERVICE_ACCEPT",1282],")",["T_WHITESPACE"," ",1282],"{",["T_WHITESPACE","\n            ",1282],["T_STRING","user_error",1283],"(",["T_CONSTANT_ENCAPSED_STRING","'Expected SSH_MSG_SERVICE_ACCEPT'",1283],",",["T_WHITESPACE"," ",1283],["T_STRING","E_USER_NOTICE",1283],")",";",["T_WHITESPACE","\n            ",1283],["T_RETURN","return",1284],["T_WHITESPACE"," ",1284],["T_STRING","false",1284],";",["T_WHITESPACE","\n        ",1284],"}",["T_WHITESPACE","\n\n        ",1285],["T_COMMENT","\/\/ although PHP5's get_class() preserves the case, PHP4's does not\n",1287],["T_WHITESPACE","        ",1288],["T_IF","if",1288],["T_WHITESPACE"," ",1288],"(",["T_STRING","is_object",1288],"(",["T_VARIABLE","$password",1288],")",["T_WHITESPACE"," ",1288],["T_BOOLEAN_AND","&&",1288],["T_WHITESPACE"," ",1288],["T_STRING","strtolower",1288],"(",["T_STRING","get_class",1288],"(",["T_VARIABLE","$password",1288],")",")",["T_WHITESPACE"," ",1288],["T_IS_EQUAL","==",1288],["T_WHITESPACE"," ",1288],["T_CONSTANT_ENCAPSED_STRING","'crypt_rsa'",1288],")",["T_WHITESPACE","  ",1288],"{",["T_WHITESPACE","\n            ",1288],["T_RETURN","return",1289],["T_WHITESPACE"," ",1289],["T_VARIABLE","$this",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","_privatekey_login",1289],"(",["T_VARIABLE","$username",1289],",",["T_WHITESPACE"," ",1289],["T_VARIABLE","$password",1289],")",";",["T_WHITESPACE","\n        ",1289],"}",["T_WHITESPACE","\n\n        ",1290],["T_VARIABLE","$utf8_password",1292],["T_WHITESPACE"," ",1292],"=",["T_WHITESPACE"," ",1292],["T_STRING","utf8_encode",1292],"(",["T_VARIABLE","$password",1292],")",";",["T_WHITESPACE","\n        ",1292],["T_VARIABLE","$packet",1293],["T_WHITESPACE"," ",1293],"=",["T_WHITESPACE"," ",1293],["T_STRING","pack",1293],"(",["T_CONSTANT_ENCAPSED_STRING","'CNa*Na*Na*CNa*'",1293],",",["T_WHITESPACE","\n            ",1293],["T_STRING","NET_SSH2_MSG_USERAUTH_REQUEST",1294],",",["T_WHITESPACE"," ",1294],["T_STRING","strlen",1294],"(",["T_VARIABLE","$username",1294],")",",",["T_WHITESPACE"," ",1294],["T_VARIABLE","$username",1294],",",["T_WHITESPACE"," ",1294],["T_STRING","strlen",1294],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-connection'",1294],")",",",["T_WHITESPACE"," ",1294],["T_CONSTANT_ENCAPSED_STRING","'ssh-connection'",1294],",",["T_WHITESPACE","\n            ",1294],["T_STRING","strlen",1295],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",1295],")",",",["T_WHITESPACE"," ",1295],["T_CONSTANT_ENCAPSED_STRING","'password'",1295],",",["T_WHITESPACE"," ",1295],["T_LNUMBER","0",1295],",",["T_WHITESPACE"," ",1295],["T_STRING","strlen",1295],"(",["T_VARIABLE","$utf8_password",1295],")",",",["T_WHITESPACE"," ",1295],["T_VARIABLE","$utf8_password",1295],["T_WHITESPACE","\n        ",1295],")",";",["T_WHITESPACE","\n\n        ",1296],["T_IF","if",1298],["T_WHITESPACE"," ",1298],"(","!",["T_VARIABLE","$this",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","_send_binary_packet",1298],"(",["T_VARIABLE","$packet",1298],")",")",["T_WHITESPACE"," ",1298],"{",["T_WHITESPACE","\n            ",1298],["T_RETURN","return",1299],["T_WHITESPACE"," ",1299],["T_STRING","false",1299],";",["T_WHITESPACE","\n        ",1299],"}",["T_WHITESPACE","\n\n        ",1300],["T_COMMENT","\/\/ remove the username and password from the last logged packet\n",1302],["T_WHITESPACE","        ",1303],["T_IF","if",1303],["T_WHITESPACE"," ",1303],"(",["T_STRING","defined",1303],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",1303],")",["T_WHITESPACE"," ",1303],["T_BOOLEAN_AND","&&",1303],["T_WHITESPACE"," ",1303],["T_STRING","NET_SSH2_LOGGING",1303],["T_WHITESPACE"," ",1303],["T_IS_EQUAL","==",1303],["T_WHITESPACE"," ",1303],["T_STRING","NET_SSH2_LOG_COMPLEX",1303],")",["T_WHITESPACE"," ",1303],"{",["T_WHITESPACE","\n            ",1303],["T_VARIABLE","$packet",1304],["T_WHITESPACE"," ",1304],"=",["T_WHITESPACE"," ",1304],["T_STRING","pack",1304],"(",["T_CONSTANT_ENCAPSED_STRING","'CNa*Na*Na*CNa*'",1304],",",["T_WHITESPACE","\n                ",1304],["T_STRING","NET_SSH2_MSG_USERAUTH_REQUEST",1305],",",["T_WHITESPACE"," ",1305],["T_STRING","strlen",1305],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",1305],")",",",["T_WHITESPACE"," ",1305],["T_CONSTANT_ENCAPSED_STRING","'username'",1305],",",["T_WHITESPACE"," ",1305],["T_STRING","strlen",1305],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-connection'",1305],")",",",["T_WHITESPACE"," ",1305],["T_CONSTANT_ENCAPSED_STRING","'ssh-connection'",1305],",",["T_WHITESPACE","\n                ",1305],["T_STRING","strlen",1306],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",1306],")",",",["T_WHITESPACE"," ",1306],["T_CONSTANT_ENCAPSED_STRING","'password'",1306],",",["T_WHITESPACE"," ",1306],["T_LNUMBER","0",1306],",",["T_WHITESPACE"," ",1306],["T_STRING","strlen",1306],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",1306],")",",",["T_WHITESPACE"," ",1306],["T_CONSTANT_ENCAPSED_STRING","'password'",1306],["T_WHITESPACE","\n            ",1306],")",";",["T_WHITESPACE","\n            ",1307],["T_VARIABLE","$this",1308],["T_OBJECT_OPERATOR","->",1308],["T_STRING","message_log",1308],"[",["T_STRING","count",1308],"(",["T_VARIABLE","$this",1308],["T_OBJECT_OPERATOR","->",1308],["T_STRING","message_log",1308],")",["T_WHITESPACE"," ",1308],"-",["T_WHITESPACE"," ",1308],["T_LNUMBER","1",1308],"]",["T_WHITESPACE"," ",1308],"=",["T_WHITESPACE"," ",1308],["T_VARIABLE","$packet",1308],";",["T_WHITESPACE","\n        ",1308],"}",["T_WHITESPACE","\n\n        ",1309],["T_VARIABLE","$response",1311],["T_WHITESPACE"," ",1311],"=",["T_WHITESPACE"," ",1311],["T_VARIABLE","$this",1311],["T_OBJECT_OPERATOR","->",1311],["T_STRING","_get_binary_packet",1311],"(",")",";",["T_WHITESPACE","\n        ",1311],["T_IF","if",1312],["T_WHITESPACE"," ",1312],"(",["T_VARIABLE","$response",1312],["T_WHITESPACE"," ",1312],["T_IS_IDENTICAL","===",1312],["T_WHITESPACE"," ",1312],["T_STRING","false",1312],")",["T_WHITESPACE"," ",1312],"{",["T_WHITESPACE","\n            ",1312],["T_STRING","user_error",1313],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",1313],",",["T_WHITESPACE"," ",1313],["T_STRING","E_USER_NOTICE",1313],")",";",["T_WHITESPACE","\n            ",1313],["T_RETURN","return",1314],["T_WHITESPACE"," ",1314],["T_STRING","false",1314],";",["T_WHITESPACE","\n        ",1314],"}",["T_WHITESPACE","\n\n        ",1315],["T_STRING","extract",1317],"(",["T_STRING","unpack",1317],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype'",1317],",",["T_WHITESPACE"," ",1317],["T_VARIABLE","$this",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","_string_shift",1317],"(",["T_VARIABLE","$response",1317],",",["T_WHITESPACE"," ",1317],["T_LNUMBER","1",1317],")",")",")",";",["T_WHITESPACE","\n\n        ",1317],["T_SWITCH","switch",1319],["T_WHITESPACE"," ",1319],"(",["T_VARIABLE","$type",1319],")",["T_WHITESPACE"," ",1319],"{",["T_WHITESPACE","\n            ",1319],["T_CASE","case",1320],["T_WHITESPACE"," ",1320],["T_STRING","NET_SSH2_MSG_USERAUTH_PASSWD_CHANGEREQ",1320],":",["T_WHITESPACE"," ",1320],["T_COMMENT","\/\/ in theory, the password can be changed\n",1320],["T_WHITESPACE","                ",1321],["T_IF","if",1321],["T_WHITESPACE"," ",1321],"(",["T_STRING","defined",1321],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",1321],")",")",["T_WHITESPACE"," ",1321],"{",["T_WHITESPACE","\n                    ",1321],["T_VARIABLE","$this",1322],["T_OBJECT_OPERATOR","->",1322],["T_STRING","message_number_log",1322],"[",["T_STRING","count",1322],"(",["T_VARIABLE","$this",1322],["T_OBJECT_OPERATOR","->",1322],["T_STRING","message_number_log",1322],")",["T_WHITESPACE"," ",1322],"-",["T_WHITESPACE"," ",1322],["T_LNUMBER","1",1322],"]",["T_WHITESPACE"," ",1322],"=",["T_WHITESPACE"," ",1322],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_PASSWD_CHANGEREQ'",1322],";",["T_WHITESPACE","\n                ",1322],"}",["T_WHITESPACE","\n                ",1323],["T_STRING","extract",1324],"(",["T_STRING","unpack",1324],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1324],",",["T_WHITESPACE"," ",1324],["T_VARIABLE","$this",1324],["T_OBJECT_OPERATOR","->",1324],["T_STRING","_string_shift",1324],"(",["T_VARIABLE","$response",1324],",",["T_WHITESPACE"," ",1324],["T_LNUMBER","4",1324],")",")",")",";",["T_WHITESPACE","\n                ",1324],["T_VARIABLE","$this",1325],["T_OBJECT_OPERATOR","->",1325],["T_STRING","errors",1325],"[","]",["T_WHITESPACE"," ",1325],"=",["T_WHITESPACE"," ",1325],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_USERAUTH_PASSWD_CHANGEREQ: '",1325],["T_WHITESPACE"," ",1325],".",["T_WHITESPACE"," ",1325],["T_STRING","utf8_decode",1325],"(",["T_VARIABLE","$this",1325],["T_OBJECT_OPERATOR","->",1325],["T_STRING","_string_shift",1325],"(",["T_VARIABLE","$response",1325],",",["T_WHITESPACE"," ",1325],["T_VARIABLE","$length",1325],")",")",";",["T_WHITESPACE","\n                ",1325],["T_RETURN","return",1326],["T_WHITESPACE"," ",1326],["T_VARIABLE","$this",1326],["T_OBJECT_OPERATOR","->",1326],["T_STRING","_disconnect",1326],"(",["T_STRING","NET_SSH2_DISCONNECT_AUTH_CANCELLED_BY_USER",1326],")",";",["T_WHITESPACE","\n            ",1326],["T_CASE","case",1327],["T_WHITESPACE"," ",1327],["T_STRING","NET_SSH2_MSG_USERAUTH_FAILURE",1327],":",["T_WHITESPACE","\n                ",1327],["T_COMMENT","\/\/ either the login is bad or the server employees multi-factor authentication\n",1328],["T_WHITESPACE","                ",1329],["T_RETURN","return",1329],["T_WHITESPACE"," ",1329],["T_STRING","false",1329],";",["T_WHITESPACE","\n            ",1329],["T_CASE","case",1330],["T_WHITESPACE"," ",1330],["T_STRING","NET_SSH2_MSG_USERAUTH_SUCCESS",1330],":",["T_WHITESPACE","\n                ",1330],["T_VARIABLE","$this",1331],["T_OBJECT_OPERATOR","->",1331],["T_STRING","bitmap",1331],["T_WHITESPACE"," ",1331],["T_OR_EQUAL","|=",1331],["T_WHITESPACE"," ",1331],["T_STRING","NET_SSH2_MASK_LOGIN",1331],";",["T_WHITESPACE","\n                ",1331],["T_RETURN","return",1332],["T_WHITESPACE"," ",1332],["T_STRING","true",1332],";",["T_WHITESPACE","\n        ",1332],"}",["T_WHITESPACE","\n\n        ",1333],["T_RETURN","return",1335],["T_WHITESPACE"," ",1335],["T_STRING","false",1335],";",["T_WHITESPACE","\n    ",1335],"}",["T_WHITESPACE","\n\n    ",1336],["T_DOC_COMMENT","\/**\n     * Login with an RSA private key\n     *\n     * @param String $username\n     * @param Crypt_RSA $password\n     * @return Boolean\n     * @access private\n     * @internal It might be worthwhile, at some point, to protect against {@link http:\/\/tools.ietf.org\/html\/rfc4251#section-9.3.9 traffic analysis}\n     *           by sending dummy SSH_MSG_IGNORE messages.\n     *\/",1338],["T_WHITESPACE","\n    ",1347],["T_FUNCTION","function",1348],["T_WHITESPACE"," ",1348],["T_STRING","_privatekey_login",1348],"(",["T_VARIABLE","$username",1348],",",["T_WHITESPACE"," ",1348],["T_VARIABLE","$privatekey",1348],")",["T_WHITESPACE","\n    ",1348],"{",["T_WHITESPACE","\n        ",1349],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc4253#page-15\n",1350],["T_WHITESPACE","        ",1351],["T_VARIABLE","$publickey",1351],["T_WHITESPACE"," ",1351],"=",["T_WHITESPACE"," ",1351],["T_VARIABLE","$privatekey",1351],["T_OBJECT_OPERATOR","->",1351],["T_STRING","getPublicKey",1351],"(",["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_RAW",1351],")",";",["T_WHITESPACE","\n        ",1351],["T_IF","if",1352],["T_WHITESPACE"," ",1352],"(",["T_VARIABLE","$publickey",1352],["T_WHITESPACE"," ",1352],["T_IS_IDENTICAL","===",1352],["T_WHITESPACE"," ",1352],["T_STRING","false",1352],")",["T_WHITESPACE"," ",1352],"{",["T_WHITESPACE","\n            ",1352],["T_RETURN","return",1353],["T_WHITESPACE"," ",1353],["T_STRING","false",1353],";",["T_WHITESPACE","\n        ",1353],"}",["T_WHITESPACE","\n\n        ",1354],["T_VARIABLE","$publickey",1356],["T_WHITESPACE"," ",1356],"=",["T_WHITESPACE"," ",1356],["T_ARRAY","array",1356],"(",["T_WHITESPACE","\n            ",1356],["T_CONSTANT_ENCAPSED_STRING","'e'",1357],["T_WHITESPACE"," ",1357],["T_DOUBLE_ARROW","=>",1357],["T_WHITESPACE"," ",1357],["T_VARIABLE","$publickey",1357],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",1357],"]",["T_OBJECT_OPERATOR","->",1357],["T_STRING","toBytes",1357],"(",["T_STRING","true",1357],")",",",["T_WHITESPACE","\n            ",1357],["T_CONSTANT_ENCAPSED_STRING","'n'",1358],["T_WHITESPACE"," ",1358],["T_DOUBLE_ARROW","=>",1358],["T_WHITESPACE"," ",1358],["T_VARIABLE","$publickey",1358],"[",["T_CONSTANT_ENCAPSED_STRING","'n'",1358],"]",["T_OBJECT_OPERATOR","->",1358],["T_STRING","toBytes",1358],"(",["T_STRING","true",1358],")",["T_WHITESPACE","\n        ",1358],")",";",["T_WHITESPACE","\n        ",1359],["T_VARIABLE","$publickey",1360],["T_WHITESPACE"," ",1360],"=",["T_WHITESPACE"," ",1360],["T_STRING","pack",1360],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*Na*Na*'",1360],",",["T_WHITESPACE","\n            ",1360],["T_STRING","strlen",1361],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",1361],")",",",["T_WHITESPACE"," ",1361],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",1361],",",["T_WHITESPACE"," ",1361],["T_STRING","strlen",1361],"(",["T_VARIABLE","$publickey",1361],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",1361],"]",")",",",["T_WHITESPACE"," ",1361],["T_VARIABLE","$publickey",1361],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",1361],"]",",",["T_WHITESPACE"," ",1361],["T_STRING","strlen",1361],"(",["T_VARIABLE","$publickey",1361],"[",["T_CONSTANT_ENCAPSED_STRING","'n'",1361],"]",")",",",["T_WHITESPACE"," ",1361],["T_VARIABLE","$publickey",1361],"[",["T_CONSTANT_ENCAPSED_STRING","'n'",1361],"]",["T_WHITESPACE","\n        ",1361],")",";",["T_WHITESPACE","\n\n        ",1362],["T_VARIABLE","$part1",1364],["T_WHITESPACE"," ",1364],"=",["T_WHITESPACE"," ",1364],["T_STRING","pack",1364],"(",["T_CONSTANT_ENCAPSED_STRING","'CNa*Na*Na*'",1364],",",["T_WHITESPACE","\n            ",1364],["T_STRING","NET_SSH2_MSG_USERAUTH_REQUEST",1365],",",["T_WHITESPACE"," ",1365],["T_STRING","strlen",1365],"(",["T_VARIABLE","$username",1365],")",",",["T_WHITESPACE"," ",1365],["T_VARIABLE","$username",1365],",",["T_WHITESPACE"," ",1365],["T_STRING","strlen",1365],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-connection'",1365],")",",",["T_WHITESPACE"," ",1365],["T_CONSTANT_ENCAPSED_STRING","'ssh-connection'",1365],",",["T_WHITESPACE","\n            ",1365],["T_STRING","strlen",1366],"(",["T_CONSTANT_ENCAPSED_STRING","'publickey'",1366],")",",",["T_WHITESPACE"," ",1366],["T_CONSTANT_ENCAPSED_STRING","'publickey'",1366],["T_WHITESPACE","\n        ",1366],")",";",["T_WHITESPACE","\n        ",1367],["T_VARIABLE","$part2",1368],["T_WHITESPACE"," ",1368],"=",["T_WHITESPACE"," ",1368],["T_STRING","pack",1368],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*Na*'",1368],",",["T_WHITESPACE"," ",1368],["T_STRING","strlen",1368],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",1368],")",",",["T_WHITESPACE"," ",1368],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",1368],",",["T_WHITESPACE"," ",1368],["T_STRING","strlen",1368],"(",["T_VARIABLE","$publickey",1368],")",",",["T_WHITESPACE"," ",1368],["T_VARIABLE","$publickey",1368],")",";",["T_WHITESPACE","\n\n        ",1368],["T_VARIABLE","$packet",1370],["T_WHITESPACE"," ",1370],"=",["T_WHITESPACE"," ",1370],["T_VARIABLE","$part1",1370],["T_WHITESPACE"," ",1370],".",["T_WHITESPACE"," ",1370],["T_STRING","chr",1370],"(",["T_LNUMBER","0",1370],")",["T_WHITESPACE"," ",1370],".",["T_WHITESPACE"," ",1370],["T_VARIABLE","$part2",1370],";",["T_WHITESPACE","\n\n        ",1370],["T_IF","if",1372],["T_WHITESPACE"," ",1372],"(","!",["T_VARIABLE","$this",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","_send_binary_packet",1372],"(",["T_VARIABLE","$packet",1372],")",")",["T_WHITESPACE"," ",1372],"{",["T_WHITESPACE","\n            ",1372],["T_RETURN","return",1373],["T_WHITESPACE"," ",1373],["T_STRING","false",1373],";",["T_WHITESPACE","\n        ",1373],"}",["T_WHITESPACE","\n\n        ",1374],["T_VARIABLE","$response",1376],["T_WHITESPACE"," ",1376],"=",["T_WHITESPACE"," ",1376],["T_VARIABLE","$this",1376],["T_OBJECT_OPERATOR","->",1376],["T_STRING","_get_binary_packet",1376],"(",")",";",["T_WHITESPACE","\n        ",1376],["T_IF","if",1377],["T_WHITESPACE"," ",1377],"(",["T_VARIABLE","$response",1377],["T_WHITESPACE"," ",1377],["T_IS_IDENTICAL","===",1377],["T_WHITESPACE"," ",1377],["T_STRING","false",1377],")",["T_WHITESPACE"," ",1377],"{",["T_WHITESPACE","\n            ",1377],["T_STRING","user_error",1378],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",1378],",",["T_WHITESPACE"," ",1378],["T_STRING","E_USER_NOTICE",1378],")",";",["T_WHITESPACE","\n            ",1378],["T_RETURN","return",1379],["T_WHITESPACE"," ",1379],["T_STRING","false",1379],";",["T_WHITESPACE","\n        ",1379],"}",["T_WHITESPACE","\n\n        ",1380],["T_STRING","extract",1382],"(",["T_STRING","unpack",1382],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype'",1382],",",["T_WHITESPACE"," ",1382],["T_VARIABLE","$this",1382],["T_OBJECT_OPERATOR","->",1382],["T_STRING","_string_shift",1382],"(",["T_VARIABLE","$response",1382],",",["T_WHITESPACE"," ",1382],["T_LNUMBER","1",1382],")",")",")",";",["T_WHITESPACE","\n\n        ",1382],["T_SWITCH","switch",1384],["T_WHITESPACE"," ",1384],"(",["T_VARIABLE","$type",1384],")",["T_WHITESPACE"," ",1384],"{",["T_WHITESPACE","\n            ",1384],["T_CASE","case",1385],["T_WHITESPACE"," ",1385],["T_STRING","NET_SSH2_MSG_USERAUTH_FAILURE",1385],":",["T_WHITESPACE","\n                ",1385],["T_STRING","extract",1386],"(",["T_STRING","unpack",1386],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1386],",",["T_WHITESPACE"," ",1386],["T_VARIABLE","$this",1386],["T_OBJECT_OPERATOR","->",1386],["T_STRING","_string_shift",1386],"(",["T_VARIABLE","$response",1386],",",["T_WHITESPACE"," ",1386],["T_LNUMBER","4",1386],")",")",")",";",["T_WHITESPACE","\n                ",1386],["T_VARIABLE","$this",1387],["T_OBJECT_OPERATOR","->",1387],["T_STRING","errors",1387],"[","]",["T_WHITESPACE"," ",1387],"=",["T_WHITESPACE"," ",1387],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_USERAUTH_FAILURE: '",1387],["T_WHITESPACE"," ",1387],".",["T_WHITESPACE"," ",1387],["T_VARIABLE","$this",1387],["T_OBJECT_OPERATOR","->",1387],["T_STRING","_string_shift",1387],"(",["T_VARIABLE","$response",1387],",",["T_WHITESPACE"," ",1387],["T_VARIABLE","$length",1387],")",";",["T_WHITESPACE","\n                ",1387],["T_RETURN","return",1388],["T_WHITESPACE"," ",1388],["T_VARIABLE","$this",1388],["T_OBJECT_OPERATOR","->",1388],["T_STRING","_disconnect",1388],"(",["T_STRING","NET_SSH2_DISCONNECT_AUTH_CANCELLED_BY_USER",1388],")",";",["T_WHITESPACE","\n            ",1388],["T_CASE","case",1389],["T_WHITESPACE"," ",1389],["T_STRING","NET_SSH2_MSG_USERAUTH_PK_OK",1389],":",["T_WHITESPACE","\n                ",1389],["T_COMMENT","\/\/ we'll just take it on faith that the public key blob and the public key algorithm name are as\n",1390],["T_WHITESPACE","                ",1391],["T_COMMENT","\/\/ they should be\n",1391],["T_WHITESPACE","                ",1392],["T_IF","if",1392],["T_WHITESPACE"," ",1392],"(",["T_STRING","defined",1392],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",1392],")",")",["T_WHITESPACE"," ",1392],"{",["T_WHITESPACE","\n                    ",1392],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","message_number_log",1393],"[",["T_STRING","count",1393],"(",["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","message_number_log",1393],")",["T_WHITESPACE"," ",1393],"-",["T_WHITESPACE"," ",1393],["T_LNUMBER","1",1393],"]",["T_WHITESPACE"," ",1393],"=",["T_WHITESPACE"," ",1393],["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_MSG_USERAUTH_PK_OK'",1393],";",["T_WHITESPACE","\n                ",1393],"}",["T_WHITESPACE","\n        ",1394],"}",["T_WHITESPACE","\n\n        ",1395],["T_VARIABLE","$packet",1397],["T_WHITESPACE"," ",1397],"=",["T_WHITESPACE"," ",1397],["T_VARIABLE","$part1",1397],["T_WHITESPACE"," ",1397],".",["T_WHITESPACE"," ",1397],["T_STRING","chr",1397],"(",["T_LNUMBER","1",1397],")",["T_WHITESPACE"," ",1397],".",["T_WHITESPACE"," ",1397],["T_VARIABLE","$part2",1397],";",["T_WHITESPACE","\n        ",1397],["T_VARIABLE","$privatekey",1398],["T_OBJECT_OPERATOR","->",1398],["T_STRING","setSignatureMode",1398],"(",["T_STRING","CRYPT_RSA_SIGNATURE_PKCS1",1398],")",";",["T_WHITESPACE","\n        ",1398],["T_VARIABLE","$signature",1399],["T_WHITESPACE"," ",1399],"=",["T_WHITESPACE"," ",1399],["T_VARIABLE","$privatekey",1399],["T_OBJECT_OPERATOR","->",1399],["T_STRING","sign",1399],"(",["T_STRING","pack",1399],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*a*'",1399],",",["T_WHITESPACE"," ",1399],["T_STRING","strlen",1399],"(",["T_VARIABLE","$this",1399],["T_OBJECT_OPERATOR","->",1399],["T_STRING","session_id",1399],")",",",["T_WHITESPACE"," ",1399],["T_VARIABLE","$this",1399],["T_OBJECT_OPERATOR","->",1399],["T_STRING","session_id",1399],",",["T_WHITESPACE"," ",1399],["T_VARIABLE","$packet",1399],")",")",";",["T_WHITESPACE","\n        ",1399],["T_VARIABLE","$signature",1400],["T_WHITESPACE"," ",1400],"=",["T_WHITESPACE"," ",1400],["T_STRING","pack",1400],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*Na*'",1400],",",["T_WHITESPACE"," ",1400],["T_STRING","strlen",1400],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",1400],")",",",["T_WHITESPACE"," ",1400],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",1400],",",["T_WHITESPACE"," ",1400],["T_STRING","strlen",1400],"(",["T_VARIABLE","$signature",1400],")",",",["T_WHITESPACE"," ",1400],["T_VARIABLE","$signature",1400],")",";",["T_WHITESPACE","\n        ",1400],["T_VARIABLE","$packet",1401],["T_CONCAT_EQUAL",".=",1401],["T_WHITESPACE"," ",1401],["T_STRING","pack",1401],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*'",1401],",",["T_WHITESPACE"," ",1401],["T_STRING","strlen",1401],"(",["T_VARIABLE","$signature",1401],")",",",["T_WHITESPACE"," ",1401],["T_VARIABLE","$signature",1401],")",";",["T_WHITESPACE","\n\n        ",1401],["T_IF","if",1403],["T_WHITESPACE"," ",1403],"(","!",["T_VARIABLE","$this",1403],["T_OBJECT_OPERATOR","->",1403],["T_STRING","_send_binary_packet",1403],"(",["T_VARIABLE","$packet",1403],")",")",["T_WHITESPACE"," ",1403],"{",["T_WHITESPACE","\n            ",1403],["T_RETURN","return",1404],["T_WHITESPACE"," ",1404],["T_STRING","false",1404],";",["T_WHITESPACE","\n        ",1404],"}",["T_WHITESPACE","\n\n        ",1405],["T_VARIABLE","$response",1407],["T_WHITESPACE"," ",1407],"=",["T_WHITESPACE"," ",1407],["T_VARIABLE","$this",1407],["T_OBJECT_OPERATOR","->",1407],["T_STRING","_get_binary_packet",1407],"(",")",";",["T_WHITESPACE","\n        ",1407],["T_IF","if",1408],["T_WHITESPACE"," ",1408],"(",["T_VARIABLE","$response",1408],["T_WHITESPACE"," ",1408],["T_IS_IDENTICAL","===",1408],["T_WHITESPACE"," ",1408],["T_STRING","false",1408],")",["T_WHITESPACE"," ",1408],"{",["T_WHITESPACE","\n            ",1408],["T_STRING","user_error",1409],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",1409],",",["T_WHITESPACE"," ",1409],["T_STRING","E_USER_NOTICE",1409],")",";",["T_WHITESPACE","\n            ",1409],["T_RETURN","return",1410],["T_WHITESPACE"," ",1410],["T_STRING","false",1410],";",["T_WHITESPACE","\n        ",1410],"}",["T_WHITESPACE","\n\n        ",1411],["T_STRING","extract",1413],"(",["T_STRING","unpack",1413],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype'",1413],",",["T_WHITESPACE"," ",1413],["T_VARIABLE","$this",1413],["T_OBJECT_OPERATOR","->",1413],["T_STRING","_string_shift",1413],"(",["T_VARIABLE","$response",1413],",",["T_WHITESPACE"," ",1413],["T_LNUMBER","1",1413],")",")",")",";",["T_WHITESPACE","\n\n        ",1413],["T_SWITCH","switch",1415],["T_WHITESPACE"," ",1415],"(",["T_VARIABLE","$type",1415],")",["T_WHITESPACE"," ",1415],"{",["T_WHITESPACE","\n            ",1415],["T_CASE","case",1416],["T_WHITESPACE"," ",1416],["T_STRING","NET_SSH2_MSG_USERAUTH_FAILURE",1416],":",["T_WHITESPACE","\n                ",1416],["T_COMMENT","\/\/ either the login is bad or the server employees multi-factor authentication\n",1417],["T_WHITESPACE","                ",1418],["T_RETURN","return",1418],["T_WHITESPACE"," ",1418],["T_STRING","false",1418],";",["T_WHITESPACE","\n            ",1418],["T_CASE","case",1419],["T_WHITESPACE"," ",1419],["T_STRING","NET_SSH2_MSG_USERAUTH_SUCCESS",1419],":",["T_WHITESPACE","\n                ",1419],["T_VARIABLE","$this",1420],["T_OBJECT_OPERATOR","->",1420],["T_STRING","bitmap",1420],["T_WHITESPACE"," ",1420],["T_OR_EQUAL","|=",1420],["T_WHITESPACE"," ",1420],["T_STRING","NET_SSH2_MASK_LOGIN",1420],";",["T_WHITESPACE","\n                ",1420],["T_RETURN","return",1421],["T_WHITESPACE"," ",1421],["T_STRING","true",1421],";",["T_WHITESPACE","\n        ",1421],"}",["T_WHITESPACE","\n\n        ",1422],["T_RETURN","return",1424],["T_WHITESPACE"," ",1424],["T_STRING","false",1424],";",["T_WHITESPACE","\n    ",1424],"}",["T_WHITESPACE","\n\n    ",1425],["T_DOC_COMMENT","\/**\n     * Execute Command\n     *\n     * @param String $command\n     * @return String\n     * @access public\n     *\/",1427],["T_WHITESPACE","\n    ",1433],["T_FUNCTION","function",1434],["T_WHITESPACE"," ",1434],["T_STRING","exec",1434],"(",["T_VARIABLE","$command",1434],")",["T_WHITESPACE","\n    ",1434],"{",["T_WHITESPACE","\n        ",1435],["T_IF","if",1436],["T_WHITESPACE"," ",1436],"(","!","(",["T_VARIABLE","$this",1436],["T_OBJECT_OPERATOR","->",1436],["T_STRING","bitmap",1436],["T_WHITESPACE"," ",1436],"&",["T_WHITESPACE"," ",1436],["T_STRING","NET_SSH2_MASK_LOGIN",1436],")",")",["T_WHITESPACE"," ",1436],"{",["T_WHITESPACE","\n            ",1436],["T_RETURN","return",1437],["T_WHITESPACE"," ",1437],["T_STRING","false",1437],";",["T_WHITESPACE","\n        ",1437],"}",["T_WHITESPACE","\n\n        ",1438],["T_COMMENT","\/\/ RFC4254 defines the (client) window size as \"bytes the other party can send before it must wait for the window to\n",1440],["T_WHITESPACE","        ",1441],["T_COMMENT","\/\/ be adjusted\".  0x7FFFFFFF is, at 4GB, the max size.  technically, it should probably be decremented, but, \n",1441],["T_WHITESPACE","        ",1442],["T_COMMENT","\/\/ honestly, if you're transfering more than 4GB, you probably shouldn't be using phpseclib, anyway.\n",1442],["T_WHITESPACE","        ",1443],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc4254#section-5.2 for more info\n",1443],["T_WHITESPACE","        ",1444],["T_VARIABLE","$this",1444],["T_OBJECT_OPERATOR","->",1444],["T_STRING","window_size_client_to_server",1444],"[",["T_STRING","NET_SSH2_CHANNEL_EXEC",1444],"]",["T_WHITESPACE"," ",1444],"=",["T_WHITESPACE"," ",1444],["T_LNUMBER","0x7FFFFFFF",1444],";",["T_WHITESPACE","\n        ",1444],["T_COMMENT","\/\/ 0x8000 is the maximum max packet size, per http:\/\/tools.ietf.org\/html\/rfc4253#section-6.1, although since PuTTy\n",1445],["T_WHITESPACE","        ",1446],["T_COMMENT","\/\/ uses 0x4000, that's what will be used here, as well.\n",1446],["T_WHITESPACE","        ",1447],["T_VARIABLE","$packet_size",1447],["T_WHITESPACE"," ",1447],"=",["T_WHITESPACE"," ",1447],["T_LNUMBER","0x4000",1447],";",["T_WHITESPACE","\n\n        ",1447],["T_VARIABLE","$packet",1449],["T_WHITESPACE"," ",1449],"=",["T_WHITESPACE"," ",1449],["T_STRING","pack",1449],"(",["T_CONSTANT_ENCAPSED_STRING","'CNa*N3'",1449],",",["T_WHITESPACE","\n            ",1449],["T_STRING","NET_SSH2_MSG_CHANNEL_OPEN",1450],",",["T_WHITESPACE"," ",1450],["T_STRING","strlen",1450],"(",["T_CONSTANT_ENCAPSED_STRING","'session'",1450],")",",",["T_WHITESPACE"," ",1450],["T_CONSTANT_ENCAPSED_STRING","'session'",1450],",",["T_WHITESPACE"," ",1450],["T_STRING","NET_SSH2_CHANNEL_EXEC",1450],",",["T_WHITESPACE"," ",1450],["T_VARIABLE","$this",1450],["T_OBJECT_OPERATOR","->",1450],["T_STRING","window_size_client_to_server",1450],"[",["T_STRING","NET_SSH2_CHANNEL_EXEC",1450],"]",",",["T_WHITESPACE"," ",1450],["T_VARIABLE","$packet_size",1450],")",";",["T_WHITESPACE","\n\n        ",1450],["T_IF","if",1452],["T_WHITESPACE"," ",1452],"(","!",["T_VARIABLE","$this",1452],["T_OBJECT_OPERATOR","->",1452],["T_STRING","_send_binary_packet",1452],"(",["T_VARIABLE","$packet",1452],")",")",["T_WHITESPACE"," ",1452],"{",["T_WHITESPACE","\n            ",1452],["T_RETURN","return",1453],["T_WHITESPACE"," ",1453],["T_STRING","false",1453],";",["T_WHITESPACE","\n        ",1453],"}",["T_WHITESPACE","\n\n        ",1454],["T_VARIABLE","$this",1456],["T_OBJECT_OPERATOR","->",1456],["T_STRING","channel_status",1456],"[",["T_STRING","NET_SSH2_CHANNEL_EXEC",1456],"]",["T_WHITESPACE"," ",1456],"=",["T_WHITESPACE"," ",1456],["T_STRING","NET_SSH2_MSG_CHANNEL_OPEN",1456],";",["T_WHITESPACE","\n\n        ",1456],["T_VARIABLE","$response",1458],["T_WHITESPACE"," ",1458],"=",["T_WHITESPACE"," ",1458],["T_VARIABLE","$this",1458],["T_OBJECT_OPERATOR","->",1458],["T_STRING","_get_channel_packet",1458],"(",["T_STRING","NET_SSH2_CHANNEL_EXEC",1458],")",";",["T_WHITESPACE","\n        ",1458],["T_IF","if",1459],["T_WHITESPACE"," ",1459],"(",["T_VARIABLE","$response",1459],["T_WHITESPACE"," ",1459],["T_IS_IDENTICAL","===",1459],["T_WHITESPACE"," ",1459],["T_STRING","false",1459],")",["T_WHITESPACE"," ",1459],"{",["T_WHITESPACE","\n            ",1459],["T_RETURN","return",1460],["T_WHITESPACE"," ",1460],["T_STRING","false",1460],";",["T_WHITESPACE","\n        ",1460],"}",["T_WHITESPACE","\n\n        ",1461],["T_COMMENT","\/\/ sending a pty-req SSH_MSG_CHANNEL_REQUEST message is unnecessary and, in fact, in most cases, slows things\n",1463],["T_WHITESPACE","        ",1464],["T_COMMENT","\/\/ down.  the one place where it might be desirable is if you're doing something like Net_SSH2::exec('ping localhost &').\n",1464],["T_WHITESPACE","        ",1465],["T_COMMENT","\/\/ with a pty-req SSH_MSG_cHANNEL_REQUEST, exec() will return immediately and the ping process will then\n",1465],["T_WHITESPACE","        ",1466],["T_COMMENT","\/\/ then immediately terminate.  without such a request exec() will loop indefinitely.  the ping process won't end but\n",1466],["T_WHITESPACE","        ",1467],["T_COMMENT","\/\/ neither will your script.\n",1467],["T_WHITESPACE","\n        ",1468],["T_COMMENT","\/\/ although, in theory, the size of SSH_MSG_CHANNEL_REQUEST could exceed the maximum packet size established by\n",1469],["T_WHITESPACE","        ",1470],["T_COMMENT","\/\/ SSH_MSG_CHANNEL_OPEN_CONFIRMATION, RFC4254#section-5.1 states that the \"maximum packet size\" refers to the \n",1470],["T_WHITESPACE","        ",1471],["T_COMMENT","\/\/ \"maximum size of an individual data packet\". ie. SSH_MSG_CHANNEL_DATA.  RFC4254#section-5.2 corroborates.\n",1471],["T_WHITESPACE","        ",1472],["T_VARIABLE","$packet",1472],["T_WHITESPACE"," ",1472],"=",["T_WHITESPACE"," ",1472],["T_STRING","pack",1472],"(",["T_CONSTANT_ENCAPSED_STRING","'CNNa*CNa*'",1472],",",["T_WHITESPACE","\n            ",1472],["T_STRING","NET_SSH2_MSG_CHANNEL_REQUEST",1473],",",["T_WHITESPACE"," ",1473],["T_VARIABLE","$this",1473],["T_OBJECT_OPERATOR","->",1473],["T_STRING","server_channels",1473],"[",["T_STRING","NET_SSH2_CHANNEL_EXEC",1473],"]",",",["T_WHITESPACE"," ",1473],["T_STRING","strlen",1473],"(",["T_CONSTANT_ENCAPSED_STRING","'exec'",1473],")",",",["T_WHITESPACE"," ",1473],["T_CONSTANT_ENCAPSED_STRING","'exec'",1473],",",["T_WHITESPACE"," ",1473],["T_LNUMBER","1",1473],",",["T_WHITESPACE"," ",1473],["T_STRING","strlen",1473],"(",["T_VARIABLE","$command",1473],")",",",["T_WHITESPACE"," ",1473],["T_VARIABLE","$command",1473],")",";",["T_WHITESPACE","\n        ",1473],["T_IF","if",1474],["T_WHITESPACE"," ",1474],"(","!",["T_VARIABLE","$this",1474],["T_OBJECT_OPERATOR","->",1474],["T_STRING","_send_binary_packet",1474],"(",["T_VARIABLE","$packet",1474],")",")",["T_WHITESPACE"," ",1474],"{",["T_WHITESPACE","\n            ",1474],["T_RETURN","return",1475],["T_WHITESPACE"," ",1475],["T_STRING","false",1475],";",["T_WHITESPACE","\n        ",1475],"}",["T_WHITESPACE","\n\n        ",1476],["T_VARIABLE","$this",1478],["T_OBJECT_OPERATOR","->",1478],["T_STRING","channel_status",1478],"[",["T_STRING","NET_SSH2_CHANNEL_EXEC",1478],"]",["T_WHITESPACE"," ",1478],"=",["T_WHITESPACE"," ",1478],["T_STRING","NET_SSH2_MSG_CHANNEL_REQUEST",1478],";",["T_WHITESPACE","\n\n        ",1478],["T_VARIABLE","$response",1480],["T_WHITESPACE"," ",1480],"=",["T_WHITESPACE"," ",1480],["T_VARIABLE","$this",1480],["T_OBJECT_OPERATOR","->",1480],["T_STRING","_get_channel_packet",1480],"(",["T_STRING","NET_SSH2_CHANNEL_EXEC",1480],")",";",["T_WHITESPACE","\n        ",1480],["T_IF","if",1481],["T_WHITESPACE"," ",1481],"(",["T_VARIABLE","$response",1481],["T_WHITESPACE"," ",1481],["T_IS_IDENTICAL","===",1481],["T_WHITESPACE"," ",1481],["T_STRING","false",1481],")",["T_WHITESPACE"," ",1481],"{",["T_WHITESPACE","\n            ",1481],["T_RETURN","return",1482],["T_WHITESPACE"," ",1482],["T_STRING","false",1482],";",["T_WHITESPACE","\n        ",1482],"}",["T_WHITESPACE","\n\n        ",1483],["T_VARIABLE","$this",1485],["T_OBJECT_OPERATOR","->",1485],["T_STRING","channel_status",1485],"[",["T_STRING","NET_SSH2_CHANNEL_EXEC",1485],"]",["T_WHITESPACE"," ",1485],"=",["T_WHITESPACE"," ",1485],["T_STRING","NET_SSH2_MSG_CHANNEL_DATA",1485],";",["T_WHITESPACE","\n\n        ",1485],["T_VARIABLE","$output",1487],["T_WHITESPACE"," ",1487],"=",["T_WHITESPACE"," ",1487],["T_CONSTANT_ENCAPSED_STRING","''",1487],";",["T_WHITESPACE","\n        ",1487],["T_WHILE","while",1488],["T_WHITESPACE"," ",1488],"(",["T_STRING","true",1488],")",["T_WHITESPACE"," ",1488],"{",["T_WHITESPACE","\n            ",1488],["T_VARIABLE","$temp",1489],["T_WHITESPACE"," ",1489],"=",["T_WHITESPACE"," ",1489],["T_VARIABLE","$this",1489],["T_OBJECT_OPERATOR","->",1489],["T_STRING","_get_channel_packet",1489],"(",["T_STRING","NET_SSH2_CHANNEL_EXEC",1489],")",";",["T_WHITESPACE","\n            ",1489],["T_SWITCH","switch",1490],["T_WHITESPACE"," ",1490],"(",["T_STRING","true",1490],")",["T_WHITESPACE"," ",1490],"{",["T_WHITESPACE","\n                ",1490],["T_CASE","case",1491],["T_WHITESPACE"," ",1491],["T_VARIABLE","$temp",1491],["T_WHITESPACE"," ",1491],["T_IS_IDENTICAL","===",1491],["T_WHITESPACE"," ",1491],["T_STRING","true",1491],":",["T_WHITESPACE","\n                    ",1491],["T_RETURN","return",1492],["T_WHITESPACE"," ",1492],["T_VARIABLE","$output",1492],";",["T_WHITESPACE","\n                ",1492],["T_CASE","case",1493],["T_WHITESPACE"," ",1493],["T_VARIABLE","$temp",1493],["T_WHITESPACE"," ",1493],["T_IS_IDENTICAL","===",1493],["T_WHITESPACE"," ",1493],["T_STRING","false",1493],":",["T_WHITESPACE","\n                    ",1493],["T_RETURN","return",1494],["T_WHITESPACE"," ",1494],["T_STRING","false",1494],";",["T_WHITESPACE","\n                ",1494],["T_DEFAULT","default",1495],":",["T_WHITESPACE","\n                    ",1495],["T_VARIABLE","$output",1496],["T_CONCAT_EQUAL",".=",1496],["T_WHITESPACE"," ",1496],["T_VARIABLE","$temp",1496],";",["T_WHITESPACE","\n            ",1496],"}",["T_WHITESPACE","\n        ",1497],"}",["T_WHITESPACE","\n    ",1498],"}",["T_WHITESPACE","\n\n    ",1499],["T_DOC_COMMENT","\/**\n     * Disconnect\n     *\n     * @access public\n     *\/",1501],["T_WHITESPACE","\n    ",1505],["T_FUNCTION","function",1506],["T_WHITESPACE"," ",1506],["T_STRING","disconnect",1506],"(",")",["T_WHITESPACE","\n    ",1506],"{",["T_WHITESPACE","\n        ",1507],["T_VARIABLE","$this",1508],["T_OBJECT_OPERATOR","->",1508],["T_STRING","_disconnect",1508],"(",["T_STRING","NET_SSH2_DISCONNECT_BY_APPLICATION",1508],")",";",["T_WHITESPACE","\n    ",1508],"}",["T_WHITESPACE","\n\n    ",1509],["T_DOC_COMMENT","\/**\n     * Destructor.\n     *\n     * Will be called, automatically, if you're supporting just PHP5.  If you're supporting PHP4, you'll need to call\n     * disconnect().\n     *\n     * @access public\n     *\/",1511],["T_WHITESPACE","\n    ",1518],["T_FUNCTION","function",1519],["T_WHITESPACE"," ",1519],["T_STRING","__destruct",1519],"(",")",["T_WHITESPACE","\n    ",1519],"{",["T_WHITESPACE","\n        ",1520],["T_VARIABLE","$this",1521],["T_OBJECT_OPERATOR","->",1521],["T_STRING","disconnect",1521],"(",")",";",["T_WHITESPACE","\n    ",1521],"}",["T_WHITESPACE","\n\n    ",1522],["T_DOC_COMMENT","\/**\n     * Gets Binary Packets\n     *\n     * See '6. Binary Packet Protocol' of rfc4253 for more info.\n     *\n     * @see Net_SSH2::_send_binary_packet()\n     * @return String\n     * @access private\n     *\/",1524],["T_WHITESPACE","\n    ",1532],["T_FUNCTION","function",1533],["T_WHITESPACE"," ",1533],["T_STRING","_get_binary_packet",1533],"(",")",["T_WHITESPACE","\n    ",1533],"{",["T_WHITESPACE","\n        ",1534],["T_IF","if",1535],["T_WHITESPACE"," ",1535],"(",["T_STRING","feof",1535],"(",["T_VARIABLE","$this",1535],["T_OBJECT_OPERATOR","->",1535],["T_STRING","fsock",1535],")",")",["T_WHITESPACE"," ",1535],"{",["T_WHITESPACE","\n            ",1535],["T_STRING","user_error",1536],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed prematurely'",1536],",",["T_WHITESPACE"," ",1536],["T_STRING","E_USER_NOTICE",1536],")",";",["T_WHITESPACE","\n            ",1536],["T_RETURN","return",1537],["T_WHITESPACE"," ",1537],["T_STRING","false",1537],";",["T_WHITESPACE","\n        ",1537],"}",["T_WHITESPACE","\n\n        ",1538],["T_VARIABLE","$start",1540],["T_WHITESPACE"," ",1540],"=",["T_WHITESPACE"," ",1540],["T_STRING","strtok",1540],"(",["T_STRING","microtime",1540],"(",")",",",["T_WHITESPACE"," ",1540],["T_CONSTANT_ENCAPSED_STRING","' '",1540],")",["T_WHITESPACE"," ",1540],"+",["T_WHITESPACE"," ",1540],["T_STRING","strtok",1540],"(",["T_CONSTANT_ENCAPSED_STRING","''",1540],")",";",["T_WHITESPACE"," ",1540],["T_COMMENT","\/\/ http:\/\/php.net\/microtime#61838\n",1540],["T_WHITESPACE","        ",1541],["T_VARIABLE","$raw",1541],["T_WHITESPACE"," ",1541],"=",["T_WHITESPACE"," ",1541],["T_STRING","fread",1541],"(",["T_VARIABLE","$this",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","fsock",1541],",",["T_WHITESPACE"," ",1541],["T_VARIABLE","$this",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","decrypt_block_size",1541],")",";",["T_WHITESPACE","\n        ",1541],["T_VARIABLE","$stop",1542],["T_WHITESPACE"," ",1542],"=",["T_WHITESPACE"," ",1542],["T_STRING","strtok",1542],"(",["T_STRING","microtime",1542],"(",")",",",["T_WHITESPACE"," ",1542],["T_CONSTANT_ENCAPSED_STRING","' '",1542],")",["T_WHITESPACE"," ",1542],"+",["T_WHITESPACE"," ",1542],["T_STRING","strtok",1542],"(",["T_CONSTANT_ENCAPSED_STRING","''",1542],")",";",["T_WHITESPACE","\n\n        ",1542],["T_IF","if",1544],["T_WHITESPACE"," ",1544],"(",["T_VARIABLE","$this",1544],["T_OBJECT_OPERATOR","->",1544],["T_STRING","decrypt",1544],["T_WHITESPACE"," ",1544],["T_IS_NOT_IDENTICAL","!==",1544],["T_WHITESPACE"," ",1544],["T_STRING","false",1544],")",["T_WHITESPACE"," ",1544],"{",["T_WHITESPACE","\n            ",1544],["T_VARIABLE","$raw",1545],["T_WHITESPACE"," ",1545],"=",["T_WHITESPACE"," ",1545],["T_VARIABLE","$this",1545],["T_OBJECT_OPERATOR","->",1545],["T_STRING","decrypt",1545],["T_OBJECT_OPERATOR","->",1545],["T_STRING","decrypt",1545],"(",["T_VARIABLE","$raw",1545],")",";",["T_WHITESPACE","\n        ",1545],"}",["T_WHITESPACE","\n\n        ",1546],["T_STRING","extract",1548],"(",["T_STRING","unpack",1548],"(",["T_CONSTANT_ENCAPSED_STRING","'Npacket_length\/Cpadding_length'",1548],",",["T_WHITESPACE"," ",1548],["T_VARIABLE","$this",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","_string_shift",1548],"(",["T_VARIABLE","$raw",1548],",",["T_WHITESPACE"," ",1548],["T_LNUMBER","5",1548],")",")",")",";",["T_WHITESPACE","\n\n        ",1548],["T_VARIABLE","$remaining_length",1550],["T_WHITESPACE"," ",1550],"=",["T_WHITESPACE"," ",1550],["T_VARIABLE","$packet_length",1550],["T_WHITESPACE"," ",1550],"+",["T_WHITESPACE"," ",1550],["T_LNUMBER","4",1550],["T_WHITESPACE"," ",1550],"-",["T_WHITESPACE"," ",1550],["T_VARIABLE","$this",1550],["T_OBJECT_OPERATOR","->",1550],["T_STRING","decrypt_block_size",1550],";",["T_WHITESPACE","\n        ",1550],["T_VARIABLE","$buffer",1551],["T_WHITESPACE"," ",1551],"=",["T_WHITESPACE"," ",1551],["T_CONSTANT_ENCAPSED_STRING","''",1551],";",["T_WHITESPACE","\n        ",1551],["T_WHILE","while",1552],["T_WHITESPACE"," ",1552],"(",["T_VARIABLE","$remaining_length",1552],["T_WHITESPACE"," ",1552],">",["T_WHITESPACE"," ",1552],["T_LNUMBER","0",1552],")",["T_WHITESPACE"," ",1552],"{",["T_WHITESPACE","\n            ",1552],["T_VARIABLE","$temp",1553],["T_WHITESPACE"," ",1553],"=",["T_WHITESPACE"," ",1553],["T_STRING","fread",1553],"(",["T_VARIABLE","$this",1553],["T_OBJECT_OPERATOR","->",1553],["T_STRING","fsock",1553],",",["T_WHITESPACE"," ",1553],["T_VARIABLE","$remaining_length",1553],")",";",["T_WHITESPACE","\n            ",1553],["T_VARIABLE","$buffer",1554],["T_CONCAT_EQUAL",".=",1554],["T_WHITESPACE"," ",1554],["T_VARIABLE","$temp",1554],";",["T_WHITESPACE","\n            ",1554],["T_VARIABLE","$remaining_length",1555],["T_MINUS_EQUAL","-=",1555],["T_WHITESPACE"," ",1555],["T_STRING","strlen",1555],"(",["T_VARIABLE","$temp",1555],")",";",["T_WHITESPACE","\n        ",1555],"}",["T_WHITESPACE","\n        ",1556],["T_IF","if",1557],["T_WHITESPACE"," ",1557],"(","!",["T_EMPTY","empty",1557],"(",["T_VARIABLE","$buffer",1557],")",")",["T_WHITESPACE"," ",1557],"{",["T_WHITESPACE","\n            ",1557],["T_VARIABLE","$raw",1558],["T_CONCAT_EQUAL",".=",1558],["T_WHITESPACE"," ",1558],["T_VARIABLE","$this",1558],["T_OBJECT_OPERATOR","->",1558],["T_STRING","decrypt",1558],["T_WHITESPACE"," ",1558],["T_IS_NOT_IDENTICAL","!==",1558],["T_WHITESPACE"," ",1558],["T_STRING","false",1558],["T_WHITESPACE"," ",1558],"?",["T_WHITESPACE"," ",1558],["T_VARIABLE","$this",1558],["T_OBJECT_OPERATOR","->",1558],["T_STRING","decrypt",1558],["T_OBJECT_OPERATOR","->",1558],["T_STRING","decrypt",1558],"(",["T_VARIABLE","$buffer",1558],")",["T_WHITESPACE"," ",1558],":",["T_WHITESPACE"," ",1558],["T_VARIABLE","$buffer",1558],";",["T_WHITESPACE","\n            ",1558],["T_VARIABLE","$buffer",1559],["T_WHITESPACE"," ",1559],"=",["T_WHITESPACE"," ",1559],["T_VARIABLE","$temp",1559],["T_WHITESPACE"," ",1559],"=",["T_WHITESPACE"," ",1559],["T_CONSTANT_ENCAPSED_STRING","''",1559],";",["T_WHITESPACE","\n        ",1559],"}",["T_WHITESPACE","\n\n        ",1560],["T_VARIABLE","$payload",1562],["T_WHITESPACE"," ",1562],"=",["T_WHITESPACE"," ",1562],["T_VARIABLE","$this",1562],["T_OBJECT_OPERATOR","->",1562],["T_STRING","_string_shift",1562],"(",["T_VARIABLE","$raw",1562],",",["T_WHITESPACE"," ",1562],["T_VARIABLE","$packet_length",1562],["T_WHITESPACE"," ",1562],"-",["T_WHITESPACE"," ",1562],["T_VARIABLE","$padding_length",1562],["T_WHITESPACE"," ",1562],"-",["T_WHITESPACE"," ",1562],["T_LNUMBER","1",1562],")",";",["T_WHITESPACE","\n        ",1562],["T_VARIABLE","$padding",1563],["T_WHITESPACE"," ",1563],"=",["T_WHITESPACE"," ",1563],["T_VARIABLE","$this",1563],["T_OBJECT_OPERATOR","->",1563],["T_STRING","_string_shift",1563],"(",["T_VARIABLE","$raw",1563],",",["T_WHITESPACE"," ",1563],["T_VARIABLE","$padding_length",1563],")",";",["T_WHITESPACE"," ",1563],["T_COMMENT","\/\/ should leave $raw empty\n",1563],["T_WHITESPACE","\n        ",1564],["T_IF","if",1565],["T_WHITESPACE"," ",1565],"(",["T_VARIABLE","$this",1565],["T_OBJECT_OPERATOR","->",1565],["T_STRING","hmac_check",1565],["T_WHITESPACE"," ",1565],["T_IS_NOT_IDENTICAL","!==",1565],["T_WHITESPACE"," ",1565],["T_STRING","false",1565],")",["T_WHITESPACE"," ",1565],"{",["T_WHITESPACE","\n            ",1565],["T_VARIABLE","$hmac",1566],["T_WHITESPACE"," ",1566],"=",["T_WHITESPACE"," ",1566],["T_STRING","fread",1566],"(",["T_VARIABLE","$this",1566],["T_OBJECT_OPERATOR","->",1566],["T_STRING","fsock",1566],",",["T_WHITESPACE"," ",1566],["T_VARIABLE","$this",1566],["T_OBJECT_OPERATOR","->",1566],["T_STRING","hmac_size",1566],")",";",["T_WHITESPACE","\n            ",1566],["T_IF","if",1567],["T_WHITESPACE"," ",1567],"(",["T_VARIABLE","$hmac",1567],["T_WHITESPACE"," ",1567],["T_IS_NOT_EQUAL","!=",1567],["T_WHITESPACE"," ",1567],["T_VARIABLE","$this",1567],["T_OBJECT_OPERATOR","->",1567],["T_STRING","hmac_check",1567],["T_OBJECT_OPERATOR","->",1567],["T_STRING","hash",1567],"(",["T_STRING","pack",1567],"(",["T_CONSTANT_ENCAPSED_STRING","'NNCa*'",1567],",",["T_WHITESPACE"," ",1567],["T_VARIABLE","$this",1567],["T_OBJECT_OPERATOR","->",1567],["T_STRING","get_seq_no",1567],",",["T_WHITESPACE"," ",1567],["T_VARIABLE","$packet_length",1567],",",["T_WHITESPACE"," ",1567],["T_VARIABLE","$padding_length",1567],",",["T_WHITESPACE"," ",1567],["T_VARIABLE","$payload",1567],["T_WHITESPACE"," ",1567],".",["T_WHITESPACE"," ",1567],["T_VARIABLE","$padding",1567],")",")",")",["T_WHITESPACE"," ",1567],"{",["T_WHITESPACE","\n                ",1567],["T_STRING","user_error",1568],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid HMAC'",1568],",",["T_WHITESPACE"," ",1568],["T_STRING","E_USER_NOTICE",1568],")",";",["T_WHITESPACE","\n                ",1568],["T_RETURN","return",1569],["T_WHITESPACE"," ",1569],["T_STRING","false",1569],";",["T_WHITESPACE","\n            ",1569],"}",["T_WHITESPACE","\n        ",1570],"}",["T_WHITESPACE","\n\n        ",1571],["T_COMMENT","\/\/if ($this->decompress) {\n",1573],["T_WHITESPACE","        ",1574],["T_COMMENT","\/\/    $payload = gzinflate(substr($payload, 2));\n",1574],["T_WHITESPACE","        ",1575],["T_COMMENT","\/\/}\n",1575],["T_WHITESPACE","\n        ",1576],["T_VARIABLE","$this",1577],["T_OBJECT_OPERATOR","->",1577],["T_STRING","get_seq_no",1577],["T_INC","++",1577],";",["T_WHITESPACE","\n\n        ",1577],["T_IF","if",1579],["T_WHITESPACE"," ",1579],"(",["T_STRING","defined",1579],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",1579],")",")",["T_WHITESPACE"," ",1579],"{",["T_WHITESPACE","\n            ",1579],["T_VARIABLE","$temp",1580],["T_WHITESPACE"," ",1580],"=",["T_WHITESPACE"," ",1580],["T_ISSET","isset",1580],"(",["T_VARIABLE","$this",1580],["T_OBJECT_OPERATOR","->",1580],["T_STRING","message_numbers",1580],"[",["T_STRING","ord",1580],"(",["T_VARIABLE","$payload",1580],"[",["T_LNUMBER","0",1580],"]",")","]",")",["T_WHITESPACE"," ",1580],"?",["T_WHITESPACE"," ",1580],["T_VARIABLE","$this",1580],["T_OBJECT_OPERATOR","->",1580],["T_STRING","message_numbers",1580],"[",["T_STRING","ord",1580],"(",["T_VARIABLE","$payload",1580],"[",["T_LNUMBER","0",1580],"]",")","]",["T_WHITESPACE"," ",1580],":",["T_WHITESPACE"," ",1580],["T_CONSTANT_ENCAPSED_STRING","'UNKNOWN'",1580],";",["T_WHITESPACE","\n            ",1580],["T_VARIABLE","$this",1581],["T_OBJECT_OPERATOR","->",1581],["T_STRING","message_number_log",1581],"[","]",["T_WHITESPACE"," ",1581],"=",["T_WHITESPACE"," ",1581],["T_CONSTANT_ENCAPSED_STRING","'<- '",1581],["T_WHITESPACE"," ",1581],".",["T_WHITESPACE"," ",1581],["T_VARIABLE","$temp",1581],["T_WHITESPACE"," ",1581],".",["T_WHITESPACE","\n                                          ",1581],["T_CONSTANT_ENCAPSED_STRING","' ('",1582],["T_WHITESPACE"," ",1582],".",["T_WHITESPACE"," ",1582],["T_STRING","round",1582],"(",["T_VARIABLE","$stop",1582],["T_WHITESPACE"," ",1582],"-",["T_WHITESPACE"," ",1582],["T_VARIABLE","$start",1582],",",["T_WHITESPACE"," ",1582],["T_LNUMBER","4",1582],")",["T_WHITESPACE"," ",1582],".",["T_WHITESPACE"," ",1582],["T_CONSTANT_ENCAPSED_STRING","'s)'",1582],";",["T_WHITESPACE","\n            ",1582],["T_IF","if",1583],["T_WHITESPACE"," ",1583],"(",["T_STRING","NET_SSH2_LOGGING",1583],["T_WHITESPACE"," ",1583],["T_IS_EQUAL","==",1583],["T_WHITESPACE"," ",1583],["T_STRING","NET_SSH2_LOG_COMPLEX",1583],")",["T_WHITESPACE"," ",1583],"{",["T_WHITESPACE","\n                ",1583],["T_VARIABLE","$this",1584],["T_OBJECT_OPERATOR","->",1584],["T_STRING","message_log",1584],"[","]",["T_WHITESPACE"," ",1584],"=",["T_WHITESPACE"," ",1584],["T_STRING","substr",1584],"(",["T_VARIABLE","$payload",1584],",",["T_WHITESPACE"," ",1584],["T_LNUMBER","1",1584],")",";",["T_WHITESPACE","\n            ",1584],"}",["T_WHITESPACE","\n        ",1585],"}",["T_WHITESPACE","\n\n        ",1586],["T_RETURN","return",1588],["T_WHITESPACE"," ",1588],["T_VARIABLE","$this",1588],["T_OBJECT_OPERATOR","->",1588],["T_STRING","_filter",1588],"(",["T_VARIABLE","$payload",1588],")",";",["T_WHITESPACE","\n    ",1588],"}",["T_WHITESPACE","\n\n    ",1589],["T_DOC_COMMENT","\/**\n     * Filter Binary Packets\n     *\n     * Because some binary packets need to be ignored...\n     *\n     * @see Net_SSH2::_get_binary_packet()\n     * @return String\n     * @access private\n     *\/",1591],["T_WHITESPACE","\n    ",1599],["T_FUNCTION","function",1600],["T_WHITESPACE"," ",1600],["T_STRING","_filter",1600],"(",["T_VARIABLE","$payload",1600],")",["T_WHITESPACE","\n    ",1600],"{",["T_WHITESPACE","\n        ",1601],["T_SWITCH","switch",1602],["T_WHITESPACE"," ",1602],"(",["T_STRING","ord",1602],"(",["T_VARIABLE","$payload",1602],"[",["T_LNUMBER","0",1602],"]",")",")",["T_WHITESPACE"," ",1602],"{",["T_WHITESPACE","\n            ",1602],["T_CASE","case",1603],["T_WHITESPACE"," ",1603],["T_STRING","NET_SSH2_MSG_DISCONNECT",1603],":",["T_WHITESPACE","\n                ",1603],["T_VARIABLE","$this",1604],["T_OBJECT_OPERATOR","->",1604],["T_STRING","_string_shift",1604],"(",["T_VARIABLE","$payload",1604],",",["T_WHITESPACE"," ",1604],["T_LNUMBER","1",1604],")",";",["T_WHITESPACE","\n                ",1604],["T_STRING","extract",1605],"(",["T_STRING","unpack",1605],"(",["T_CONSTANT_ENCAPSED_STRING","'Nreason_code\/Nlength'",1605],",",["T_WHITESPACE"," ",1605],["T_VARIABLE","$this",1605],["T_OBJECT_OPERATOR","->",1605],["T_STRING","_string_shift",1605],"(",["T_VARIABLE","$payload",1605],",",["T_WHITESPACE"," ",1605],["T_LNUMBER","8",1605],")",")",")",";",["T_WHITESPACE","\n                ",1605],["T_VARIABLE","$this",1606],["T_OBJECT_OPERATOR","->",1606],["T_STRING","errors",1606],"[","]",["T_WHITESPACE"," ",1606],"=",["T_WHITESPACE"," ",1606],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_DISCONNECT: '",1606],["T_WHITESPACE"," ",1606],".",["T_WHITESPACE"," ",1606],["T_VARIABLE","$this",1606],["T_OBJECT_OPERATOR","->",1606],["T_STRING","disconnect_reasons",1606],"[",["T_VARIABLE","$reason_code",1606],"]",["T_WHITESPACE"," ",1606],".",["T_WHITESPACE"," ",1606],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1606],["T_WHITESPACE"," ",1606],".",["T_WHITESPACE"," ",1606],["T_STRING","utf8_decode",1606],"(",["T_VARIABLE","$this",1606],["T_OBJECT_OPERATOR","->",1606],["T_STRING","_string_shift",1606],"(",["T_VARIABLE","$payload",1606],",",["T_WHITESPACE"," ",1606],["T_VARIABLE","$length",1606],")",")",";",["T_WHITESPACE","\n                ",1606],["T_VARIABLE","$this",1607],["T_OBJECT_OPERATOR","->",1607],["T_STRING","bitmask",1607],["T_WHITESPACE"," ",1607],"=",["T_WHITESPACE"," ",1607],["T_LNUMBER","0",1607],";",["T_WHITESPACE","\n                ",1607],["T_RETURN","return",1608],["T_WHITESPACE"," ",1608],["T_STRING","false",1608],";",["T_WHITESPACE","\n            ",1608],["T_CASE","case",1609],["T_WHITESPACE"," ",1609],["T_STRING","NET_SSH2_MSG_IGNORE",1609],":",["T_WHITESPACE","\n                ",1609],["T_VARIABLE","$payload",1610],["T_WHITESPACE"," ",1610],"=",["T_WHITESPACE"," ",1610],["T_VARIABLE","$this",1610],["T_OBJECT_OPERATOR","->",1610],["T_STRING","_get_binary_packet",1610],"(",")",";",["T_WHITESPACE","\n                ",1610],["T_BREAK","break",1611],";",["T_WHITESPACE","\n            ",1611],["T_CASE","case",1612],["T_WHITESPACE"," ",1612],["T_STRING","NET_SSH2_MSG_DEBUG",1612],":",["T_WHITESPACE","\n                ",1612],["T_VARIABLE","$this",1613],["T_OBJECT_OPERATOR","->",1613],["T_STRING","_string_shift",1613],"(",["T_VARIABLE","$payload",1613],",",["T_WHITESPACE"," ",1613],["T_LNUMBER","2",1613],")",";",["T_WHITESPACE","\n                ",1613],["T_STRING","extract",1614],"(",["T_STRING","unpack",1614],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1614],",",["T_WHITESPACE"," ",1614],["T_VARIABLE","$this",1614],["T_OBJECT_OPERATOR","->",1614],["T_STRING","_string_shift",1614],"(",["T_VARIABLE","$payload",1614],",",["T_WHITESPACE"," ",1614],["T_LNUMBER","4",1614],")",")",")",";",["T_WHITESPACE","\n                ",1614],["T_VARIABLE","$this",1615],["T_OBJECT_OPERATOR","->",1615],["T_STRING","errors",1615],"[","]",["T_WHITESPACE"," ",1615],"=",["T_WHITESPACE"," ",1615],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_DEBUG: '",1615],["T_WHITESPACE"," ",1615],".",["T_WHITESPACE"," ",1615],["T_STRING","utf8_decode",1615],"(",["T_VARIABLE","$this",1615],["T_OBJECT_OPERATOR","->",1615],["T_STRING","_string_shift",1615],"(",["T_VARIABLE","$payload",1615],",",["T_WHITESPACE"," ",1615],["T_VARIABLE","$length",1615],")",")",";",["T_WHITESPACE","\n                ",1615],["T_VARIABLE","$payload",1616],["T_WHITESPACE"," ",1616],"=",["T_WHITESPACE"," ",1616],["T_VARIABLE","$this",1616],["T_OBJECT_OPERATOR","->",1616],["T_STRING","_get_binary_packet",1616],"(",")",";",["T_WHITESPACE","\n                ",1616],["T_BREAK","break",1617],";",["T_WHITESPACE","\n            ",1617],["T_CASE","case",1618],["T_WHITESPACE"," ",1618],["T_STRING","NET_SSH2_MSG_UNIMPLEMENTED",1618],":",["T_WHITESPACE","\n                ",1618],["T_RETURN","return",1619],["T_WHITESPACE"," ",1619],["T_STRING","false",1619],";",["T_WHITESPACE","\n            ",1619],["T_CASE","case",1620],["T_WHITESPACE"," ",1620],["T_STRING","NET_SSH2_MSG_KEXINIT",1620],":",["T_WHITESPACE","\n                ",1620],["T_IF","if",1621],["T_WHITESPACE"," ",1621],"(",["T_VARIABLE","$this",1621],["T_OBJECT_OPERATOR","->",1621],["T_STRING","session_id",1621],["T_WHITESPACE"," ",1621],["T_IS_NOT_IDENTICAL","!==",1621],["T_WHITESPACE"," ",1621],["T_STRING","false",1621],")",["T_WHITESPACE"," ",1621],"{",["T_WHITESPACE","\n                    ",1621],["T_IF","if",1622],["T_WHITESPACE"," ",1622],"(","!",["T_VARIABLE","$this",1622],["T_OBJECT_OPERATOR","->",1622],["T_STRING","_key_exchange",1622],"(",["T_VARIABLE","$payload",1622],")",")",["T_WHITESPACE"," ",1622],"{",["T_WHITESPACE","\n                        ",1622],["T_VARIABLE","$this",1623],["T_OBJECT_OPERATOR","->",1623],["T_STRING","bitmask",1623],["T_WHITESPACE"," ",1623],"=",["T_WHITESPACE"," ",1623],["T_LNUMBER","0",1623],";",["T_WHITESPACE","\n                        ",1623],["T_RETURN","return",1624],["T_WHITESPACE"," ",1624],["T_STRING","false",1624],";",["T_WHITESPACE","\n                    ",1624],"}",["T_WHITESPACE","\n                    ",1625],["T_VARIABLE","$payload",1626],["T_WHITESPACE"," ",1626],"=",["T_WHITESPACE"," ",1626],["T_VARIABLE","$this",1626],["T_OBJECT_OPERATOR","->",1626],["T_STRING","_get_binary_packet",1626],"(",")",";",["T_WHITESPACE","\n                ",1626],"}",["T_WHITESPACE","\n        ",1627],"}",["T_WHITESPACE","\n\n        ",1628],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc4252#section-5.4; only called when the encryption has been activated and when we haven't already logged in\n",1630],["T_WHITESPACE","        ",1631],["T_IF","if",1631],["T_WHITESPACE"," ",1631],"(","(",["T_VARIABLE","$this",1631],["T_OBJECT_OPERATOR","->",1631],["T_STRING","bitmap",1631],["T_WHITESPACE"," ",1631],"&",["T_WHITESPACE"," ",1631],["T_STRING","NET_SSH2_MASK_CONSTRUCTOR",1631],")",["T_WHITESPACE"," ",1631],["T_BOOLEAN_AND","&&",1631],["T_WHITESPACE"," ",1631],"!","(",["T_VARIABLE","$this",1631],["T_OBJECT_OPERATOR","->",1631],["T_STRING","bitmap",1631],["T_WHITESPACE"," ",1631],"&",["T_WHITESPACE"," ",1631],["T_STRING","NET_SSH2_MASK_LOGIN",1631],")",["T_WHITESPACE"," ",1631],["T_BOOLEAN_AND","&&",1631],["T_WHITESPACE"," ",1631],["T_STRING","ord",1631],"(",["T_VARIABLE","$payload",1631],"[",["T_LNUMBER","0",1631],"]",")",["T_WHITESPACE"," ",1631],["T_IS_EQUAL","==",1631],["T_WHITESPACE"," ",1631],["T_STRING","NET_SSH2_MSG_USERAUTH_BANNER",1631],")",["T_WHITESPACE"," ",1631],"{",["T_WHITESPACE","\n            ",1631],["T_VARIABLE","$this",1632],["T_OBJECT_OPERATOR","->",1632],["T_STRING","_string_shift",1632],"(",["T_VARIABLE","$payload",1632],",",["T_WHITESPACE"," ",1632],["T_LNUMBER","1",1632],")",";",["T_WHITESPACE","\n            ",1632],["T_STRING","extract",1633],"(",["T_STRING","unpack",1633],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1633],",",["T_WHITESPACE"," ",1633],["T_VARIABLE","$this",1633],["T_OBJECT_OPERATOR","->",1633],["T_STRING","_string_shift",1633],"(",["T_VARIABLE","$payload",1633],",",["T_WHITESPACE"," ",1633],["T_LNUMBER","4",1633],")",")",")",";",["T_WHITESPACE","\n            ",1633],["T_VARIABLE","$this",1634],["T_OBJECT_OPERATOR","->",1634],["T_STRING","errors",1634],"[","]",["T_WHITESPACE"," ",1634],"=",["T_WHITESPACE"," ",1634],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_USERAUTH_BANNER: '",1634],["T_WHITESPACE"," ",1634],".",["T_WHITESPACE"," ",1634],["T_STRING","utf8_decode",1634],"(",["T_VARIABLE","$this",1634],["T_OBJECT_OPERATOR","->",1634],["T_STRING","_string_shift",1634],"(",["T_VARIABLE","$payload",1634],",",["T_WHITESPACE"," ",1634],["T_VARIABLE","$length",1634],")",")",";",["T_WHITESPACE","\n            ",1634],["T_VARIABLE","$payload",1635],["T_WHITESPACE"," ",1635],"=",["T_WHITESPACE"," ",1635],["T_VARIABLE","$this",1635],["T_OBJECT_OPERATOR","->",1635],["T_STRING","_get_binary_packet",1635],"(",")",";",["T_WHITESPACE","\n        ",1635],"}",["T_WHITESPACE","\n\n        ",1636],["T_COMMENT","\/\/ only called when we've already logged in\n",1638],["T_WHITESPACE","        ",1639],["T_IF","if",1639],["T_WHITESPACE"," ",1639],"(","(",["T_VARIABLE","$this",1639],["T_OBJECT_OPERATOR","->",1639],["T_STRING","bitmap",1639],["T_WHITESPACE"," ",1639],"&",["T_WHITESPACE"," ",1639],["T_STRING","NET_SSH2_MASK_CONSTRUCTOR",1639],")",["T_WHITESPACE"," ",1639],["T_BOOLEAN_AND","&&",1639],["T_WHITESPACE"," ",1639],"(",["T_VARIABLE","$this",1639],["T_OBJECT_OPERATOR","->",1639],["T_STRING","bitmap",1639],["T_WHITESPACE"," ",1639],"&",["T_WHITESPACE"," ",1639],["T_STRING","NET_SSH2_MASK_LOGIN",1639],")",")",["T_WHITESPACE"," ",1639],"{",["T_WHITESPACE","\n            ",1639],["T_SWITCH","switch",1640],["T_WHITESPACE"," ",1640],"(",["T_STRING","ord",1640],"(",["T_VARIABLE","$payload",1640],"[",["T_LNUMBER","0",1640],"]",")",")",["T_WHITESPACE"," ",1640],"{",["T_WHITESPACE","\n                ",1640],["T_CASE","case",1641],["T_WHITESPACE"," ",1641],["T_STRING","NET_SSH2_MSG_GLOBAL_REQUEST",1641],":",["T_WHITESPACE"," ",1641],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc4254#section-4\n",1641],["T_WHITESPACE","                    ",1642],["T_VARIABLE","$this",1642],["T_OBJECT_OPERATOR","->",1642],["T_STRING","_string_shift",1642],"(",["T_VARIABLE","$payload",1642],",",["T_WHITESPACE"," ",1642],["T_LNUMBER","1",1642],")",";",["T_WHITESPACE","\n                    ",1642],["T_STRING","extract",1643],"(",["T_STRING","unpack",1643],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1643],",",["T_WHITESPACE"," ",1643],["T_VARIABLE","$this",1643],["T_OBJECT_OPERATOR","->",1643],["T_STRING","_string_shift",1643],"(",["T_VARIABLE","$payload",1643],")",")",")",";",["T_WHITESPACE","\n                    ",1643],["T_VARIABLE","$this",1644],["T_OBJECT_OPERATOR","->",1644],["T_STRING","errors",1644],"[","]",["T_WHITESPACE"," ",1644],"=",["T_WHITESPACE"," ",1644],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_GLOBAL_REQUEST: '",1644],["T_WHITESPACE"," ",1644],".",["T_WHITESPACE"," ",1644],["T_STRING","utf8_decode",1644],"(",["T_VARIABLE","$this",1644],["T_OBJECT_OPERATOR","->",1644],["T_STRING","_string_shift",1644],"(",["T_VARIABLE","$payload",1644],",",["T_WHITESPACE"," ",1644],["T_VARIABLE","$length",1644],")",")",";",["T_WHITESPACE","\n\n                    ",1644],["T_IF","if",1646],["T_WHITESPACE"," ",1646],"(","!",["T_VARIABLE","$this",1646],["T_OBJECT_OPERATOR","->",1646],["T_STRING","_send_binary_packet",1646],"(",["T_STRING","pack",1646],"(",["T_CONSTANT_ENCAPSED_STRING","'C'",1646],",",["T_WHITESPACE"," ",1646],["T_STRING","NET_SSH2_MSG_REQUEST_FAILURE",1646],")",")",")",["T_WHITESPACE"," ",1646],"{",["T_WHITESPACE","\n                        ",1646],["T_RETURN","return",1647],["T_WHITESPACE"," ",1647],["T_VARIABLE","$this",1647],["T_OBJECT_OPERATOR","->",1647],["T_STRING","_disconnect",1647],"(",["T_STRING","NET_SSH2_DISCONNECT_BY_APPLICATION",1647],")",";",["T_WHITESPACE","\n                    ",1647],"}",["T_WHITESPACE","\n\n                    ",1648],["T_VARIABLE","$payload",1650],["T_WHITESPACE"," ",1650],"=",["T_WHITESPACE"," ",1650],["T_VARIABLE","$this",1650],["T_OBJECT_OPERATOR","->",1650],["T_STRING","_get_binary_packet",1650],"(",")",";",["T_WHITESPACE","\n                    ",1650],["T_BREAK","break",1651],";",["T_WHITESPACE","\n                ",1651],["T_CASE","case",1652],["T_WHITESPACE"," ",1652],["T_STRING","NET_SSH2_MSG_CHANNEL_OPEN",1652],":",["T_WHITESPACE"," ",1652],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc4254#section-5.1\n",1652],["T_WHITESPACE","                    ",1653],["T_VARIABLE","$this",1653],["T_OBJECT_OPERATOR","->",1653],["T_STRING","_string_shift",1653],"(",["T_VARIABLE","$payload",1653],",",["T_WHITESPACE"," ",1653],["T_LNUMBER","1",1653],")",";",["T_WHITESPACE","\n                    ",1653],["T_STRING","extract",1654],"(",["T_STRING","unpack",1654],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",1654],",",["T_WHITESPACE"," ",1654],["T_VARIABLE","$this",1654],["T_OBJECT_OPERATOR","->",1654],["T_STRING","_string_shift",1654],"(",["T_VARIABLE","$payload",1654],",",["T_WHITESPACE"," ",1654],["T_LNUMBER","4",1654],")",")",")",";",["T_WHITESPACE","\n                    ",1654],["T_VARIABLE","$this",1655],["T_OBJECT_OPERATOR","->",1655],["T_STRING","errors",1655],"[","]",["T_WHITESPACE"," ",1655],"=",["T_WHITESPACE"," ",1655],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_CHANNEL_OPEN: '",1655],["T_WHITESPACE"," ",1655],".",["T_WHITESPACE"," ",1655],["T_STRING","utf8_decode",1655],"(",["T_VARIABLE","$this",1655],["T_OBJECT_OPERATOR","->",1655],["T_STRING","_string_shift",1655],"(",["T_VARIABLE","$payload",1655],",",["T_WHITESPACE"," ",1655],["T_VARIABLE","$length",1655],")",")",";",["T_WHITESPACE","\n\n                    ",1655],["T_VARIABLE","$this",1657],["T_OBJECT_OPERATOR","->",1657],["T_STRING","_string_shift",1657],"(",["T_VARIABLE","$payload",1657],",",["T_WHITESPACE"," ",1657],["T_LNUMBER","4",1657],")",";",["T_WHITESPACE"," ",1657],["T_COMMENT","\/\/ skip over client channel\n",1657],["T_WHITESPACE","                    ",1658],["T_STRING","extract",1658],"(",["T_STRING","unpack",1658],"(",["T_CONSTANT_ENCAPSED_STRING","'Nserver_channel'",1658],",",["T_WHITESPACE"," ",1658],["T_VARIABLE","$this",1658],["T_OBJECT_OPERATOR","->",1658],["T_STRING","_string_shift",1658],"(",["T_VARIABLE","$payload",1658],",",["T_WHITESPACE"," ",1658],["T_LNUMBER","4",1658],")",")",")",";",["T_WHITESPACE","\n\n                    ",1658],["T_VARIABLE","$packet",1660],["T_WHITESPACE"," ",1660],"=",["T_WHITESPACE"," ",1660],["T_STRING","pack",1660],"(",["T_CONSTANT_ENCAPSED_STRING","'CN3a*Na*'",1660],",",["T_WHITESPACE","\n                        ",1660],["T_STRING","NET_SSH2_MSG_REQUEST_FAILURE",1661],",",["T_WHITESPACE"," ",1661],["T_VARIABLE","$server_channel",1661],",",["T_WHITESPACE"," ",1661],["T_STRING","NET_SSH2_OPEN_ADMINISTRATIVELY_PROHIBITED",1661],",",["T_WHITESPACE"," ",1661],["T_LNUMBER","0",1661],",",["T_WHITESPACE"," ",1661],["T_CONSTANT_ENCAPSED_STRING","''",1661],",",["T_WHITESPACE"," ",1661],["T_LNUMBER","0",1661],",",["T_WHITESPACE"," ",1661],["T_CONSTANT_ENCAPSED_STRING","''",1661],")",";",["T_WHITESPACE","\n\n                    ",1661],["T_IF","if",1663],["T_WHITESPACE"," ",1663],"(","!",["T_VARIABLE","$this",1663],["T_OBJECT_OPERATOR","->",1663],["T_STRING","_send_binary_packet",1663],"(",["T_VARIABLE","$packet",1663],")",")",["T_WHITESPACE"," ",1663],"{",["T_WHITESPACE","\n                        ",1663],["T_RETURN","return",1664],["T_WHITESPACE"," ",1664],["T_VARIABLE","$this",1664],["T_OBJECT_OPERATOR","->",1664],["T_STRING","_disconnect",1664],"(",["T_STRING","NET_SSH2_DISCONNECT_BY_APPLICATION",1664],")",";",["T_WHITESPACE","\n                    ",1664],"}",["T_WHITESPACE","\n\n                    ",1665],["T_VARIABLE","$payload",1667],["T_WHITESPACE"," ",1667],"=",["T_WHITESPACE"," ",1667],["T_VARIABLE","$this",1667],["T_OBJECT_OPERATOR","->",1667],["T_STRING","_get_binary_packet",1667],"(",")",";",["T_WHITESPACE","\n                    ",1667],["T_BREAK","break",1668],";",["T_WHITESPACE","\n                ",1668],["T_CASE","case",1669],["T_WHITESPACE"," ",1669],["T_STRING","NET_SSH2_MSG_CHANNEL_WINDOW_ADJUST",1669],":",["T_WHITESPACE","\n                    ",1669],["T_VARIABLE","$payload",1670],["T_WHITESPACE"," ",1670],"=",["T_WHITESPACE"," ",1670],["T_VARIABLE","$this",1670],["T_OBJECT_OPERATOR","->",1670],["T_STRING","_get_binary_packet",1670],"(",")",";",["T_WHITESPACE","\n            ",1670],"}",["T_WHITESPACE","\n        ",1671],"}",["T_WHITESPACE","\n\n        ",1672],["T_RETURN","return",1674],["T_WHITESPACE"," ",1674],["T_VARIABLE","$payload",1674],";",["T_WHITESPACE","\n    ",1674],"}",["T_WHITESPACE","\n\n    ",1675],["T_DOC_COMMENT","\/**\n     * Gets channel data\n     *\n     * Returns the data as a string if it's available and false if not.\n     *\n     * @param $client_channel\n     * @return Mixed\n     * @access private\n     *\/",1677],["T_WHITESPACE","\n    ",1685],["T_FUNCTION","function",1686],["T_WHITESPACE"," ",1686],["T_STRING","_get_channel_packet",1686],"(",["T_VARIABLE","$client_channel",1686],")",["T_WHITESPACE","\n    ",1686],"{",["T_WHITESPACE","\n        ",1687],["T_IF","if",1688],["T_WHITESPACE"," ",1688],"(","!",["T_EMPTY","empty",1688],"(",["T_VARIABLE","$this",1688],["T_OBJECT_OPERATOR","->",1688],["T_STRING","channel_buffers",1688],"[",["T_VARIABLE","$client_channel",1688],"]",")",")",["T_WHITESPACE"," ",1688],"{",["T_WHITESPACE","\n            ",1688],["T_RETURN","return",1689],["T_WHITESPACE"," ",1689],["T_STRING","array_shift",1689],"(",["T_VARIABLE","$this",1689],["T_OBJECT_OPERATOR","->",1689],["T_STRING","channel_buffers",1689],"[",["T_VARIABLE","$client_channel",1689],"]",")",";",["T_WHITESPACE","\n        ",1689],"}",["T_WHITESPACE","\n\n        ",1690],["T_WHILE","while",1692],["T_WHITESPACE"," ",1692],"(",["T_STRING","true",1692],")",["T_WHITESPACE"," ",1692],"{",["T_WHITESPACE","\n            ",1692],["T_VARIABLE","$response",1693],["T_WHITESPACE"," ",1693],"=",["T_WHITESPACE"," ",1693],["T_VARIABLE","$this",1693],["T_OBJECT_OPERATOR","->",1693],["T_STRING","_get_binary_packet",1693],"(",")",";",["T_WHITESPACE","\n            ",1693],["T_IF","if",1694],["T_WHITESPACE"," ",1694],"(",["T_VARIABLE","$response",1694],["T_WHITESPACE"," ",1694],["T_IS_IDENTICAL","===",1694],["T_WHITESPACE"," ",1694],["T_STRING","false",1694],")",["T_WHITESPACE"," ",1694],"{",["T_WHITESPACE","\n                ",1694],["T_STRING","user_error",1695],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed by server'",1695],",",["T_WHITESPACE"," ",1695],["T_STRING","E_USER_NOTICE",1695],")",";",["T_WHITESPACE","\n                ",1695],["T_RETURN","return",1696],["T_WHITESPACE"," ",1696],["T_STRING","false",1696],";",["T_WHITESPACE","\n            ",1696],"}",["T_WHITESPACE","\n\n            ",1697],["T_STRING","extract",1699],"(",["T_STRING","unpack",1699],"(",["T_CONSTANT_ENCAPSED_STRING","'Ctype\/Nchannel'",1699],",",["T_WHITESPACE"," ",1699],["T_VARIABLE","$this",1699],["T_OBJECT_OPERATOR","->",1699],["T_STRING","_string_shift",1699],"(",["T_VARIABLE","$response",1699],",",["T_WHITESPACE"," ",1699],["T_LNUMBER","5",1699],")",")",")",";",["T_WHITESPACE","\n\n            ",1699],["T_SWITCH","switch",1701],["T_WHITESPACE"," ",1701],"(",["T_VARIABLE","$this",1701],["T_OBJECT_OPERATOR","->",1701],["T_STRING","channel_status",1701],"[",["T_VARIABLE","$channel",1701],"]",")",["T_WHITESPACE"," ",1701],"{",["T_WHITESPACE","\n                ",1701],["T_CASE","case",1702],["T_WHITESPACE"," ",1702],["T_STRING","NET_SSH2_MSG_CHANNEL_OPEN",1702],":",["T_WHITESPACE","\n                    ",1702],["T_SWITCH","switch",1703],["T_WHITESPACE"," ",1703],"(",["T_VARIABLE","$type",1703],")",["T_WHITESPACE"," ",1703],"{",["T_WHITESPACE","\n                        ",1703],["T_CASE","case",1704],["T_WHITESPACE"," ",1704],["T_STRING","NET_SSH2_MSG_CHANNEL_OPEN_CONFIRMATION",1704],":",["T_WHITESPACE","\n                            ",1704],["T_STRING","extract",1705],"(",["T_STRING","unpack",1705],"(",["T_CONSTANT_ENCAPSED_STRING","'Nserver_channel'",1705],",",["T_WHITESPACE"," ",1705],["T_VARIABLE","$this",1705],["T_OBJECT_OPERATOR","->",1705],["T_STRING","_string_shift",1705],"(",["T_VARIABLE","$response",1705],",",["T_WHITESPACE"," ",1705],["T_LNUMBER","4",1705],")",")",")",";",["T_WHITESPACE","\n                            ",1705],["T_VARIABLE","$this",1706],["T_OBJECT_OPERATOR","->",1706],["T_STRING","server_channels",1706],"[",["T_VARIABLE","$client_channel",1706],"]",["T_WHITESPACE"," ",1706],"=",["T_WHITESPACE"," ",1706],["T_VARIABLE","$server_channel",1706],";",["T_WHITESPACE","\n                            ",1706],["T_VARIABLE","$this",1707],["T_OBJECT_OPERATOR","->",1707],["T_STRING","_string_shift",1707],"(",["T_VARIABLE","$response",1707],",",["T_WHITESPACE"," ",1707],["T_LNUMBER","4",1707],")",";",["T_WHITESPACE"," ",1707],["T_COMMENT","\/\/ skip over (server) window size\n",1707],["T_WHITESPACE","                            ",1708],["T_VARIABLE","$temp",1708],["T_WHITESPACE"," ",1708],"=",["T_WHITESPACE"," ",1708],["T_STRING","unpack",1708],"(",["T_CONSTANT_ENCAPSED_STRING","'Npacket_size_client_to_server'",1708],",",["T_WHITESPACE"," ",1708],["T_VARIABLE","$this",1708],["T_OBJECT_OPERATOR","->",1708],["T_STRING","_string_shift",1708],"(",["T_VARIABLE","$response",1708],",",["T_WHITESPACE"," ",1708],["T_LNUMBER","4",1708],")",")",";",["T_WHITESPACE","\n                            ",1708],["T_VARIABLE","$this",1709],["T_OBJECT_OPERATOR","->",1709],["T_STRING","packet_size_client_to_server",1709],"[",["T_VARIABLE","$client_channel",1709],"]",["T_WHITESPACE"," ",1709],"=",["T_WHITESPACE"," ",1709],["T_VARIABLE","$temp",1709],"[",["T_CONSTANT_ENCAPSED_STRING","'packet_size_client_to_server'",1709],"]",";",["T_WHITESPACE","\n                            ",1709],["T_RETURN","return",1710],["T_WHITESPACE"," ",1710],["T_STRING","true",1710],";",["T_WHITESPACE","\n                        ",1710],["T_COMMENT","\/\/case NET_SSH2_MSG_CHANNEL_OPEN_FAILURE:\n",1711],["T_WHITESPACE","                        ",1712],["T_DEFAULT","default",1712],":",["T_WHITESPACE","\n                            ",1712],["T_STRING","user_error",1713],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to open channel'",1713],",",["T_WHITESPACE"," ",1713],["T_STRING","E_USER_NOTICE",1713],")",";",["T_WHITESPACE","\n                            ",1713],["T_RETURN","return",1714],["T_WHITESPACE"," ",1714],["T_VARIABLE","$this",1714],["T_OBJECT_OPERATOR","->",1714],["T_STRING","_disconnect",1714],"(",["T_STRING","NET_SSH2_DISCONNECT_BY_APPLICATION",1714],")",";",["T_WHITESPACE","\n                    ",1714],"}",["T_WHITESPACE","\n                    ",1715],["T_BREAK","break",1716],";",["T_WHITESPACE","\n                ",1716],["T_CASE","case",1717],["T_WHITESPACE"," ",1717],["T_STRING","NET_SSH2_MSG_CHANNEL_REQUEST",1717],":",["T_WHITESPACE","\n                    ",1717],["T_SWITCH","switch",1718],["T_WHITESPACE"," ",1718],"(",["T_VARIABLE","$type",1718],")",["T_WHITESPACE"," ",1718],"{",["T_WHITESPACE","\n                        ",1718],["T_CASE","case",1719],["T_WHITESPACE"," ",1719],["T_STRING","NET_SSH2_MSG_CHANNEL_SUCCESS",1719],":",["T_WHITESPACE","\n                            ",1719],["T_RETURN","return",1720],["T_WHITESPACE"," ",1720],["T_STRING","true",1720],";",["T_WHITESPACE","\n                        ",1720],["T_COMMENT","\/\/case NET_SSH2_MSG_CHANNEL_FAILURE:\n",1721],["T_WHITESPACE","                        ",1722],["T_DEFAULT","default",1722],":",["T_WHITESPACE","\n                            ",1722],["T_STRING","user_error",1723],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to request pseudo-terminal'",1723],",",["T_WHITESPACE"," ",1723],["T_STRING","E_USER_NOTICE",1723],")",";",["T_WHITESPACE","\n                            ",1723],["T_RETURN","return",1724],["T_WHITESPACE"," ",1724],["T_VARIABLE","$this",1724],["T_OBJECT_OPERATOR","->",1724],["T_STRING","_disconnect",1724],"(",["T_STRING","NET_SSH2_DISCONNECT_BY_APPLICATION",1724],")",";",["T_WHITESPACE","\n                    ",1724],"}",["T_WHITESPACE","\n\n            ",1725],"}",["T_WHITESPACE","\n\n            ",1727],["T_SWITCH","switch",1729],["T_WHITESPACE"," ",1729],"(",["T_VARIABLE","$type",1729],")",["T_WHITESPACE"," ",1729],"{",["T_WHITESPACE","\n                ",1729],["T_CASE","case",1730],["T_WHITESPACE"," ",1730],["T_STRING","NET_SSH2_MSG_CHANNEL_DATA",1730],":",["T_WHITESPACE","\n                    ",1730],["T_IF","if",1731],["T_WHITESPACE"," ",1731],"(",["T_VARIABLE","$client_channel",1731],["T_WHITESPACE"," ",1731],["T_IS_EQUAL","==",1731],["T_WHITESPACE"," ",1731],["T_STRING","NET_SSH2_CHANNEL_EXEC",1731],")",["T_WHITESPACE"," ",1731],"{",["T_WHITESPACE","\n                        ",1731],["T_COMMENT","\/\/ SCP requires null packets, such as this, be sent.  further, in the case of the ssh.com SSH server\n",1732],["T_WHITESPACE","                        ",1733],["T_COMMENT","\/\/ this actually seems to make things twice as fast.  more to the point, the message right after \n",1733],["T_WHITESPACE","                        ",1734],["T_COMMENT","\/\/ SSH_MSG_CHANNEL_DATA (usually SSH_MSG_IGNORE) won't block for as long as it would have otherwise.\n",1734],["T_WHITESPACE","                        ",1735],["T_COMMENT","\/\/ in OpenSSH it slows things down but only by a couple thousandths of a second.\n",1735],["T_WHITESPACE","                        ",1736],["T_VARIABLE","$this",1736],["T_OBJECT_OPERATOR","->",1736],["T_STRING","_send_channel_packet",1736],"(",["T_VARIABLE","$client_channel",1736],",",["T_WHITESPACE"," ",1736],["T_STRING","chr",1736],"(",["T_LNUMBER","0",1736],")",")",";",["T_WHITESPACE","\n                    ",1736],"}",["T_WHITESPACE","\n                    ",1737],["T_STRING","extract",1738],"(",["T_STRING","unpack",1738],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1738],",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$this",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","_string_shift",1738],"(",["T_VARIABLE","$response",1738],",",["T_WHITESPACE"," ",1738],["T_LNUMBER","4",1738],")",")",")",";",["T_WHITESPACE","\n                    ",1738],["T_VARIABLE","$data",1739],["T_WHITESPACE"," ",1739],"=",["T_WHITESPACE"," ",1739],["T_VARIABLE","$this",1739],["T_OBJECT_OPERATOR","->",1739],["T_STRING","_string_shift",1739],"(",["T_VARIABLE","$response",1739],",",["T_WHITESPACE"," ",1739],["T_VARIABLE","$length",1739],")",";",["T_WHITESPACE","\n                    ",1739],["T_IF","if",1740],["T_WHITESPACE"," ",1740],"(",["T_VARIABLE","$client_channel",1740],["T_WHITESPACE"," ",1740],["T_IS_EQUAL","==",1740],["T_WHITESPACE"," ",1740],["T_VARIABLE","$channel",1740],")",["T_WHITESPACE"," ",1740],"{",["T_WHITESPACE","\n                        ",1740],["T_RETURN","return",1741],["T_WHITESPACE"," ",1741],["T_VARIABLE","$data",1741],";",["T_WHITESPACE","\n                    ",1741],"}",["T_WHITESPACE","\n                    ",1742],["T_IF","if",1743],["T_WHITESPACE"," ",1743],"(","!",["T_ISSET","isset",1743],"(",["T_VARIABLE","$this",1743],["T_OBJECT_OPERATOR","->",1743],["T_STRING","channel_buffers",1743],"[",["T_VARIABLE","$client_channel",1743],"]",")",")",["T_WHITESPACE"," ",1743],"{",["T_WHITESPACE","\n                        ",1743],["T_VARIABLE","$this",1744],["T_OBJECT_OPERATOR","->",1744],["T_STRING","channel_buffers",1744],"[",["T_VARIABLE","$client_channel",1744],"]",["T_WHITESPACE"," ",1744],"=",["T_WHITESPACE"," ",1744],["T_ARRAY","array",1744],"(",")",";",["T_WHITESPACE","\n                    ",1744],"}",["T_WHITESPACE","\n                    ",1745],["T_VARIABLE","$this",1746],["T_OBJECT_OPERATOR","->",1746],["T_STRING","channel_buffers",1746],"[",["T_VARIABLE","$client_channel",1746],"]","[","]",["T_WHITESPACE"," ",1746],"=",["T_WHITESPACE"," ",1746],["T_VARIABLE","$data",1746],";",["T_WHITESPACE","\n                    ",1746],["T_BREAK","break",1747],";",["T_WHITESPACE","\n                ",1747],["T_CASE","case",1748],["T_WHITESPACE"," ",1748],["T_STRING","NET_SSH2_MSG_CHANNEL_EXTENDED_DATA",1748],":",["T_WHITESPACE","\n                    ",1748],["T_IF","if",1749],["T_WHITESPACE"," ",1749],"(",["T_VARIABLE","$client_channel",1749],["T_WHITESPACE"," ",1749],["T_IS_EQUAL","==",1749],["T_WHITESPACE"," ",1749],["T_STRING","NET_SSH2_CHANNEL_EXEC",1749],")",["T_WHITESPACE"," ",1749],"{",["T_WHITESPACE","\n                        ",1749],["T_VARIABLE","$this",1750],["T_OBJECT_OPERATOR","->",1750],["T_STRING","_send_channel_packet",1750],"(",["T_VARIABLE","$client_channel",1750],",",["T_WHITESPACE"," ",1750],["T_STRING","chr",1750],"(",["T_LNUMBER","0",1750],")",")",";",["T_WHITESPACE","\n                    ",1750],"}",["T_WHITESPACE","\n                    ",1751],["T_COMMENT","\/\/ currently, there's only one possible value for $data_type_code: NET_SSH2_EXTENDED_DATA_STDERR\n",1752],["T_WHITESPACE","                    ",1753],["T_STRING","extract",1753],"(",["T_STRING","unpack",1753],"(",["T_CONSTANT_ENCAPSED_STRING","'Ndata_type_code\/Nlength'",1753],",",["T_WHITESPACE"," ",1753],["T_VARIABLE","$this",1753],["T_OBJECT_OPERATOR","->",1753],["T_STRING","_string_shift",1753],"(",["T_VARIABLE","$response",1753],",",["T_WHITESPACE"," ",1753],["T_LNUMBER","8",1753],")",")",")",";",["T_WHITESPACE","\n                    ",1753],["T_VARIABLE","$data",1754],["T_WHITESPACE"," ",1754],"=",["T_WHITESPACE"," ",1754],["T_VARIABLE","$this",1754],["T_OBJECT_OPERATOR","->",1754],["T_STRING","_string_shift",1754],"(",["T_VARIABLE","$response",1754],",",["T_WHITESPACE"," ",1754],["T_VARIABLE","$length",1754],")",";",["T_WHITESPACE","\n                    ",1754],["T_IF","if",1755],["T_WHITESPACE"," ",1755],"(",["T_VARIABLE","$client_channel",1755],["T_WHITESPACE"," ",1755],["T_IS_EQUAL","==",1755],["T_WHITESPACE"," ",1755],["T_VARIABLE","$channel",1755],")",["T_WHITESPACE"," ",1755],"{",["T_WHITESPACE","\n                        ",1755],["T_RETURN","return",1756],["T_WHITESPACE"," ",1756],["T_VARIABLE","$data",1756],";",["T_WHITESPACE","\n                    ",1756],"}",["T_WHITESPACE","\n                    ",1757],["T_IF","if",1758],["T_WHITESPACE"," ",1758],"(","!",["T_ISSET","isset",1758],"(",["T_VARIABLE","$this",1758],["T_OBJECT_OPERATOR","->",1758],["T_STRING","channel_buffers",1758],"[",["T_VARIABLE","$client_channel",1758],"]",")",")",["T_WHITESPACE"," ",1758],"{",["T_WHITESPACE","\n                        ",1758],["T_VARIABLE","$this",1759],["T_OBJECT_OPERATOR","->",1759],["T_STRING","channel_buffers",1759],"[",["T_VARIABLE","$client_channel",1759],"]",["T_WHITESPACE"," ",1759],"=",["T_WHITESPACE"," ",1759],["T_ARRAY","array",1759],"(",")",";",["T_WHITESPACE","\n                    ",1759],"}",["T_WHITESPACE","\n                    ",1760],["T_VARIABLE","$this",1761],["T_OBJECT_OPERATOR","->",1761],["T_STRING","channel_buffers",1761],"[",["T_VARIABLE","$client_channel",1761],"]","[","]",["T_WHITESPACE"," ",1761],"=",["T_WHITESPACE"," ",1761],["T_VARIABLE","$data",1761],";",["T_WHITESPACE","\n                    ",1761],["T_BREAK","break",1762],";",["T_WHITESPACE","\n                ",1762],["T_CASE","case",1763],["T_WHITESPACE"," ",1763],["T_STRING","NET_SSH2_MSG_CHANNEL_REQUEST",1763],":",["T_WHITESPACE","\n                    ",1763],["T_STRING","extract",1764],"(",["T_STRING","unpack",1764],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1764],",",["T_WHITESPACE"," ",1764],["T_VARIABLE","$this",1764],["T_OBJECT_OPERATOR","->",1764],["T_STRING","_string_shift",1764],"(",["T_VARIABLE","$response",1764],",",["T_WHITESPACE"," ",1764],["T_LNUMBER","4",1764],")",")",")",";",["T_WHITESPACE","\n                    ",1764],["T_VARIABLE","$value",1765],["T_WHITESPACE"," ",1765],"=",["T_WHITESPACE"," ",1765],["T_VARIABLE","$this",1765],["T_OBJECT_OPERATOR","->",1765],["T_STRING","_string_shift",1765],"(",["T_VARIABLE","$response",1765],",",["T_WHITESPACE"," ",1765],["T_VARIABLE","$length",1765],")",";",["T_WHITESPACE","\n                    ",1765],["T_SWITCH","switch",1766],["T_WHITESPACE"," ",1766],"(",["T_VARIABLE","$value",1766],")",["T_WHITESPACE"," ",1766],"{",["T_WHITESPACE","\n                        ",1766],["T_CASE","case",1767],["T_WHITESPACE"," ",1767],["T_CONSTANT_ENCAPSED_STRING","'exit-signal'",1767],":",["T_WHITESPACE","\n                            ",1767],["T_VARIABLE","$this",1768],["T_OBJECT_OPERATOR","->",1768],["T_STRING","_string_shift",1768],"(",["T_VARIABLE","$response",1768],",",["T_WHITESPACE"," ",1768],["T_LNUMBER","1",1768],")",";",["T_WHITESPACE","\n                            ",1768],["T_STRING","extract",1769],"(",["T_STRING","unpack",1769],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1769],",",["T_WHITESPACE"," ",1769],["T_VARIABLE","$this",1769],["T_OBJECT_OPERATOR","->",1769],["T_STRING","_string_shift",1769],"(",["T_VARIABLE","$response",1769],",",["T_WHITESPACE"," ",1769],["T_LNUMBER","4",1769],")",")",")",";",["T_WHITESPACE","\n                            ",1769],["T_VARIABLE","$this",1770],["T_OBJECT_OPERATOR","->",1770],["T_STRING","errors",1770],"[","]",["T_WHITESPACE"," ",1770],"=",["T_WHITESPACE"," ",1770],["T_CONSTANT_ENCAPSED_STRING","'SSH_MSG_CHANNEL_REQUEST (exit-signal): '",1770],["T_WHITESPACE"," ",1770],".",["T_WHITESPACE"," ",1770],["T_VARIABLE","$this",1770],["T_OBJECT_OPERATOR","->",1770],["T_STRING","_string_shift",1770],"(",["T_VARIABLE","$response",1770],",",["T_WHITESPACE"," ",1770],["T_VARIABLE","$length",1770],")",";",["T_WHITESPACE","\n                            ",1770],["T_VARIABLE","$this",1771],["T_OBJECT_OPERATOR","->",1771],["T_STRING","_string_shift",1771],"(",["T_VARIABLE","$response",1771],",",["T_WHITESPACE"," ",1771],["T_LNUMBER","1",1771],")",";",["T_WHITESPACE","\n                            ",1771],["T_STRING","extract",1772],"(",["T_STRING","unpack",1772],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",1772],",",["T_WHITESPACE"," ",1772],["T_VARIABLE","$this",1772],["T_OBJECT_OPERATOR","->",1772],["T_STRING","_string_shift",1772],"(",["T_VARIABLE","$response",1772],",",["T_WHITESPACE"," ",1772],["T_LNUMBER","4",1772],")",")",")",";",["T_WHITESPACE","\n                            ",1772],["T_IF","if",1773],["T_WHITESPACE"," ",1773],"(",["T_VARIABLE","$length",1773],")",["T_WHITESPACE"," ",1773],"{",["T_WHITESPACE","\n                                ",1773],["T_VARIABLE","$this",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","errors",1774],"[",["T_STRING","count",1774],"(",["T_VARIABLE","$this",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","errors",1774],")","]",["T_CONCAT_EQUAL",".=",1774],["T_WHITESPACE"," ",1774],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1774],["T_WHITESPACE"," ",1774],".",["T_WHITESPACE"," ",1774],["T_VARIABLE","$this",1774],["T_OBJECT_OPERATOR","->",1774],["T_STRING","_string_shift",1774],"(",["T_VARIABLE","$response",1774],",",["T_WHITESPACE"," ",1774],["T_VARIABLE","$length",1774],")",";",["T_WHITESPACE","\n                            ",1774],"}",["T_WHITESPACE","\n                        ",1775],["T_COMMENT","\/\/case 'exit-status':\n",1776],["T_WHITESPACE","                        ",1777],["T_DEFAULT","default",1777],":",["T_WHITESPACE","\n                            ",1777],["T_COMMENT","\/\/ \"Some systems may not implement signals, in which case they SHOULD ignore this message.\"\n",1778],["T_WHITESPACE","                            ",1779],["T_COMMENT","\/\/  -- http:\/\/tools.ietf.org\/html\/rfc4254#section-6.9\n",1779],["T_WHITESPACE","                            ",1780],["T_BREAK","break",1780],";",["T_WHITESPACE","\n                    ",1780],"}",["T_WHITESPACE","\n                    ",1781],["T_BREAK","break",1782],";",["T_WHITESPACE","\n                ",1782],["T_CASE","case",1783],["T_WHITESPACE"," ",1783],["T_STRING","NET_SSH2_MSG_CHANNEL_CLOSE",1783],":",["T_WHITESPACE","\n                    ",1783],["T_VARIABLE","$this",1784],["T_OBJECT_OPERATOR","->",1784],["T_STRING","_send_binary_packet",1784],"(",["T_STRING","pack",1784],"(",["T_CONSTANT_ENCAPSED_STRING","'CN'",1784],",",["T_WHITESPACE"," ",1784],["T_STRING","NET_SSH2_MSG_CHANNEL_CLOSE",1784],",",["T_WHITESPACE"," ",1784],["T_VARIABLE","$this",1784],["T_OBJECT_OPERATOR","->",1784],["T_STRING","server_channels",1784],"[",["T_VARIABLE","$channel",1784],"]",")",")",";",["T_WHITESPACE","\n                    ",1784],["T_RETURN","return",1785],["T_WHITESPACE"," ",1785],["T_STRING","true",1785],";",["T_WHITESPACE","\n                ",1785],["T_CASE","case",1786],["T_WHITESPACE"," ",1786],["T_STRING","NET_SSH2_MSG_CHANNEL_EOF",1786],":",["T_WHITESPACE","\n                    ",1786],["T_BREAK","break",1787],";",["T_WHITESPACE","\n                ",1787],["T_DEFAULT","default",1788],":",["T_WHITESPACE","\n                    ",1788],["T_STRING","user_error",1789],"(",["T_CONSTANT_ENCAPSED_STRING","'Error reading channel data'",1789],",",["T_WHITESPACE"," ",1789],["T_STRING","E_USER_NOTICE",1789],")",";",["T_WHITESPACE","\n                    ",1789],["T_RETURN","return",1790],["T_WHITESPACE"," ",1790],["T_VARIABLE","$this",1790],["T_OBJECT_OPERATOR","->",1790],["T_STRING","_disconnect",1790],"(",["T_STRING","NET_SSH2_DISCONNECT_BY_APPLICATION",1790],")",";",["T_WHITESPACE","\n            ",1790],"}",["T_WHITESPACE","\n        ",1791],"}",["T_WHITESPACE","\n    ",1792],"}",["T_WHITESPACE","\n\n    ",1793],["T_DOC_COMMENT","\/**\n     * Sends Binary Packets\n     *\n     * See '6. Binary Packet Protocol' of rfc4253 for more info.\n     *\n     * @param String $data\n     * @see Net_SSH2::_get_binary_packet()\n     * @return Boolean\n     * @access private\n     *\/",1795],["T_WHITESPACE","\n    ",1804],["T_FUNCTION","function",1805],["T_WHITESPACE"," ",1805],["T_STRING","_send_binary_packet",1805],"(",["T_VARIABLE","$data",1805],")",["T_WHITESPACE","\n    ",1805],"{",["T_WHITESPACE","\n        ",1806],["T_IF","if",1807],["T_WHITESPACE"," ",1807],"(",["T_STRING","feof",1807],"(",["T_VARIABLE","$this",1807],["T_OBJECT_OPERATOR","->",1807],["T_STRING","fsock",1807],")",")",["T_WHITESPACE"," ",1807],"{",["T_WHITESPACE","\n            ",1807],["T_STRING","user_error",1808],"(",["T_CONSTANT_ENCAPSED_STRING","'Connection closed prematurely'",1808],",",["T_WHITESPACE"," ",1808],["T_STRING","E_USER_NOTICE",1808],")",";",["T_WHITESPACE","\n            ",1808],["T_RETURN","return",1809],["T_WHITESPACE"," ",1809],["T_STRING","false",1809],";",["T_WHITESPACE","\n        ",1809],"}",["T_WHITESPACE","\n\n        ",1810],["T_COMMENT","\/\/if ($this->compress) {\n",1812],["T_WHITESPACE","        ",1813],["T_COMMENT","\/\/    \/\/ the -4 removes the checksum:\n",1813],["T_WHITESPACE","        ",1814],["T_COMMENT","\/\/    \/\/ http:\/\/php.net\/function.gzcompress#57710\n",1814],["T_WHITESPACE","        ",1815],["T_COMMENT","\/\/    $data = substr(gzcompress($data), 0, -4);\n",1815],["T_WHITESPACE","        ",1816],["T_COMMENT","\/\/}\n",1816],["T_WHITESPACE","\n        ",1817],["T_COMMENT","\/\/ 4 (packet length) + 1 (padding length) + 4 (minimal padding amount) == 9\n",1818],["T_WHITESPACE","        ",1819],["T_VARIABLE","$packet_length",1819],["T_WHITESPACE"," ",1819],"=",["T_WHITESPACE"," ",1819],["T_STRING","strlen",1819],"(",["T_VARIABLE","$data",1819],")",["T_WHITESPACE"," ",1819],"+",["T_WHITESPACE"," ",1819],["T_LNUMBER","9",1819],";",["T_WHITESPACE","\n        ",1819],["T_COMMENT","\/\/ round up to the nearest $this->encrypt_block_size\n",1820],["T_WHITESPACE","        ",1821],["T_VARIABLE","$packet_length",1821],["T_PLUS_EQUAL","+=",1821],["T_WHITESPACE"," ",1821],"(","(",["T_VARIABLE","$this",1821],["T_OBJECT_OPERATOR","->",1821],["T_STRING","encrypt_block_size",1821],["T_WHITESPACE"," ",1821],"-",["T_WHITESPACE"," ",1821],["T_LNUMBER","1",1821],")",["T_WHITESPACE"," ",1821],"*",["T_WHITESPACE"," ",1821],["T_VARIABLE","$packet_length",1821],")",["T_WHITESPACE"," ",1821],"%",["T_WHITESPACE"," ",1821],["T_VARIABLE","$this",1821],["T_OBJECT_OPERATOR","->",1821],["T_STRING","encrypt_block_size",1821],";",["T_WHITESPACE","\n        ",1821],["T_COMMENT","\/\/ subtracting strlen($data) is obvious - subtracting 5 is necessary because of packet_length and padding_length\n",1822],["T_WHITESPACE","        ",1823],["T_VARIABLE","$padding_length",1823],["T_WHITESPACE"," ",1823],"=",["T_WHITESPACE"," ",1823],["T_VARIABLE","$packet_length",1823],["T_WHITESPACE"," ",1823],"-",["T_WHITESPACE"," ",1823],["T_STRING","strlen",1823],"(",["T_VARIABLE","$data",1823],")",["T_WHITESPACE"," ",1823],"-",["T_WHITESPACE"," ",1823],["T_LNUMBER","5",1823],";",["T_WHITESPACE","\n\n        ",1823],["T_VARIABLE","$padding",1825],["T_WHITESPACE"," ",1825],"=",["T_WHITESPACE"," ",1825],["T_CONSTANT_ENCAPSED_STRING","''",1825],";",["T_WHITESPACE","\n        ",1825],["T_FOR","for",1826],["T_WHITESPACE"," ",1826],"(",["T_VARIABLE","$i",1826],["T_WHITESPACE"," ",1826],"=",["T_WHITESPACE"," ",1826],["T_LNUMBER","0",1826],";",["T_WHITESPACE"," ",1826],["T_VARIABLE","$i",1826],["T_WHITESPACE"," ",1826],"<",["T_WHITESPACE"," ",1826],["T_VARIABLE","$padding_length",1826],";",["T_WHITESPACE"," ",1826],["T_VARIABLE","$i",1826],["T_INC","++",1826],")",["T_WHITESPACE"," ",1826],"{",["T_WHITESPACE","\n            ",1826],["T_VARIABLE","$padding",1827],["T_CONCAT_EQUAL",".=",1827],["T_WHITESPACE"," ",1827],["T_STRING","chr",1827],"(",["T_STRING","crypt_random",1827],"(",["T_LNUMBER","0",1827],",",["T_WHITESPACE"," ",1827],["T_LNUMBER","255",1827],")",")",";",["T_WHITESPACE","\n        ",1827],"}",["T_WHITESPACE","\n\n        ",1828],["T_COMMENT","\/\/ we subtract 4 from packet_length because the packet_length field isn't supposed to include itself\n",1830],["T_WHITESPACE","        ",1831],["T_VARIABLE","$packet",1831],["T_WHITESPACE"," ",1831],"=",["T_WHITESPACE"," ",1831],["T_STRING","pack",1831],"(",["T_CONSTANT_ENCAPSED_STRING","'NCa*'",1831],",",["T_WHITESPACE"," ",1831],["T_VARIABLE","$packet_length",1831],["T_WHITESPACE"," ",1831],"-",["T_WHITESPACE"," ",1831],["T_LNUMBER","4",1831],",",["T_WHITESPACE"," ",1831],["T_VARIABLE","$padding_length",1831],",",["T_WHITESPACE"," ",1831],["T_VARIABLE","$data",1831],["T_WHITESPACE"," ",1831],".",["T_WHITESPACE"," ",1831],["T_VARIABLE","$padding",1831],")",";",["T_WHITESPACE","\n\n        ",1831],["T_VARIABLE","$hmac",1833],["T_WHITESPACE"," ",1833],"=",["T_WHITESPACE"," ",1833],["T_VARIABLE","$this",1833],["T_OBJECT_OPERATOR","->",1833],["T_STRING","hmac_create",1833],["T_WHITESPACE"," ",1833],["T_IS_NOT_IDENTICAL","!==",1833],["T_WHITESPACE"," ",1833],["T_STRING","false",1833],["T_WHITESPACE"," ",1833],"?",["T_WHITESPACE"," ",1833],["T_VARIABLE","$this",1833],["T_OBJECT_OPERATOR","->",1833],["T_STRING","hmac_create",1833],["T_OBJECT_OPERATOR","->",1833],["T_STRING","hash",1833],"(",["T_STRING","pack",1833],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*'",1833],",",["T_WHITESPACE"," ",1833],["T_VARIABLE","$this",1833],["T_OBJECT_OPERATOR","->",1833],["T_STRING","send_seq_no",1833],",",["T_WHITESPACE"," ",1833],["T_VARIABLE","$packet",1833],")",")",["T_WHITESPACE"," ",1833],":",["T_WHITESPACE"," ",1833],["T_CONSTANT_ENCAPSED_STRING","''",1833],";",["T_WHITESPACE","\n        ",1833],["T_VARIABLE","$this",1834],["T_OBJECT_OPERATOR","->",1834],["T_STRING","send_seq_no",1834],["T_INC","++",1834],";",["T_WHITESPACE","\n\n        ",1834],["T_IF","if",1836],["T_WHITESPACE"," ",1836],"(",["T_VARIABLE","$this",1836],["T_OBJECT_OPERATOR","->",1836],["T_STRING","encrypt",1836],["T_WHITESPACE"," ",1836],["T_IS_NOT_IDENTICAL","!==",1836],["T_WHITESPACE"," ",1836],["T_STRING","false",1836],")",["T_WHITESPACE"," ",1836],"{",["T_WHITESPACE","\n            ",1836],["T_VARIABLE","$packet",1837],["T_WHITESPACE"," ",1837],"=",["T_WHITESPACE"," ",1837],["T_VARIABLE","$this",1837],["T_OBJECT_OPERATOR","->",1837],["T_STRING","encrypt",1837],["T_OBJECT_OPERATOR","->",1837],["T_STRING","encrypt",1837],"(",["T_VARIABLE","$packet",1837],")",";",["T_WHITESPACE","\n        ",1837],"}",["T_WHITESPACE","\n\n        ",1838],["T_VARIABLE","$packet",1840],["T_CONCAT_EQUAL",".=",1840],["T_WHITESPACE"," ",1840],["T_VARIABLE","$hmac",1840],";",["T_WHITESPACE","\n\n        ",1840],["T_VARIABLE","$start",1842],["T_WHITESPACE"," ",1842],"=",["T_WHITESPACE"," ",1842],["T_STRING","strtok",1842],"(",["T_STRING","microtime",1842],"(",")",",",["T_WHITESPACE"," ",1842],["T_CONSTANT_ENCAPSED_STRING","' '",1842],")",["T_WHITESPACE"," ",1842],"+",["T_WHITESPACE"," ",1842],["T_STRING","strtok",1842],"(",["T_CONSTANT_ENCAPSED_STRING","''",1842],")",";",["T_WHITESPACE"," ",1842],["T_COMMENT","\/\/ http:\/\/php.net\/microtime#61838\n",1842],["T_WHITESPACE","        ",1843],["T_VARIABLE","$result",1843],["T_WHITESPACE"," ",1843],"=",["T_WHITESPACE"," ",1843],["T_STRING","strlen",1843],"(",["T_VARIABLE","$packet",1843],")",["T_WHITESPACE"," ",1843],["T_IS_EQUAL","==",1843],["T_WHITESPACE"," ",1843],["T_STRING","fputs",1843],"(",["T_VARIABLE","$this",1843],["T_OBJECT_OPERATOR","->",1843],["T_STRING","fsock",1843],",",["T_WHITESPACE"," ",1843],["T_VARIABLE","$packet",1843],")",";",["T_WHITESPACE","\n        ",1843],["T_VARIABLE","$stop",1844],["T_WHITESPACE"," ",1844],"=",["T_WHITESPACE"," ",1844],["T_STRING","strtok",1844],"(",["T_STRING","microtime",1844],"(",")",",",["T_WHITESPACE"," ",1844],["T_CONSTANT_ENCAPSED_STRING","' '",1844],")",["T_WHITESPACE"," ",1844],"+",["T_WHITESPACE"," ",1844],["T_STRING","strtok",1844],"(",["T_CONSTANT_ENCAPSED_STRING","''",1844],")",";",["T_WHITESPACE","\n\n        ",1844],["T_IF","if",1846],["T_WHITESPACE"," ",1846],"(",["T_STRING","defined",1846],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",1846],")",")",["T_WHITESPACE"," ",1846],"{",["T_WHITESPACE","\n            ",1846],["T_VARIABLE","$temp",1847],["T_WHITESPACE"," ",1847],"=",["T_WHITESPACE"," ",1847],["T_ISSET","isset",1847],"(",["T_VARIABLE","$this",1847],["T_OBJECT_OPERATOR","->",1847],["T_STRING","message_numbers",1847],"[",["T_STRING","ord",1847],"(",["T_VARIABLE","$data",1847],"[",["T_LNUMBER","0",1847],"]",")","]",")",["T_WHITESPACE"," ",1847],"?",["T_WHITESPACE"," ",1847],["T_VARIABLE","$this",1847],["T_OBJECT_OPERATOR","->",1847],["T_STRING","message_numbers",1847],"[",["T_STRING","ord",1847],"(",["T_VARIABLE","$data",1847],"[",["T_LNUMBER","0",1847],"]",")","]",["T_WHITESPACE"," ",1847],":",["T_WHITESPACE"," ",1847],["T_CONSTANT_ENCAPSED_STRING","'UNKNOWN'",1847],";",["T_WHITESPACE","\n            ",1847],["T_VARIABLE","$this",1848],["T_OBJECT_OPERATOR","->",1848],["T_STRING","message_number_log",1848],"[","]",["T_WHITESPACE"," ",1848],"=",["T_WHITESPACE"," ",1848],["T_CONSTANT_ENCAPSED_STRING","'-> '",1848],["T_WHITESPACE"," ",1848],".",["T_WHITESPACE"," ",1848],["T_VARIABLE","$temp",1848],["T_WHITESPACE"," ",1848],".",["T_WHITESPACE","\n                                          ",1848],["T_CONSTANT_ENCAPSED_STRING","' ('",1849],["T_WHITESPACE"," ",1849],".",["T_WHITESPACE"," ",1849],["T_STRING","round",1849],"(",["T_VARIABLE","$stop",1849],["T_WHITESPACE"," ",1849],"-",["T_WHITESPACE"," ",1849],["T_VARIABLE","$start",1849],",",["T_WHITESPACE"," ",1849],["T_LNUMBER","4",1849],")",["T_WHITESPACE"," ",1849],".",["T_WHITESPACE"," ",1849],["T_CONSTANT_ENCAPSED_STRING","'s)'",1849],";",["T_WHITESPACE","\n            ",1849],["T_IF","if",1850],["T_WHITESPACE"," ",1850],"(",["T_STRING","NET_SSH2_LOGGING",1850],["T_WHITESPACE"," ",1850],["T_IS_EQUAL","==",1850],["T_WHITESPACE"," ",1850],["T_STRING","NET_SSH2_LOG_COMPLEX",1850],")",["T_WHITESPACE"," ",1850],"{",["T_WHITESPACE","\n                ",1850],["T_VARIABLE","$this",1851],["T_OBJECT_OPERATOR","->",1851],["T_STRING","message_log",1851],"[","]",["T_WHITESPACE"," ",1851],"=",["T_WHITESPACE"," ",1851],["T_STRING","substr",1851],"(",["T_VARIABLE","$data",1851],",",["T_WHITESPACE"," ",1851],["T_LNUMBER","1",1851],")",";",["T_WHITESPACE","\n            ",1851],"}",["T_WHITESPACE","\n        ",1852],"}",["T_WHITESPACE","\n\n        ",1853],["T_RETURN","return",1855],["T_WHITESPACE"," ",1855],["T_VARIABLE","$result",1855],";",["T_WHITESPACE","\n    ",1855],"}",["T_WHITESPACE","\n\n    ",1856],["T_DOC_COMMENT","\/**\n     * Sends channel data\n     *\n     * Spans multiple SSH_MSG_CHANNEL_DATAs if appropriate\n     *\n     * @param Integer $client_channel\n     * @param String $data\n     * @return Boolean\n     * @access private\n     *\/",1858],["T_WHITESPACE","\n    ",1867],["T_FUNCTION","function",1868],["T_WHITESPACE"," ",1868],["T_STRING","_send_channel_packet",1868],"(",["T_VARIABLE","$client_channel",1868],",",["T_WHITESPACE"," ",1868],["T_VARIABLE","$data",1868],")",["T_WHITESPACE","\n    ",1868],"{",["T_WHITESPACE","\n        ",1869],["T_WHILE","while",1870],["T_WHITESPACE"," ",1870],"(",["T_STRING","strlen",1870],"(",["T_VARIABLE","$data",1870],")",["T_WHITESPACE"," ",1870],">",["T_WHITESPACE"," ",1870],["T_VARIABLE","$this",1870],["T_OBJECT_OPERATOR","->",1870],["T_STRING","packet_size_client_to_server",1870],"[",["T_VARIABLE","$client_channel",1870],"]",")",["T_WHITESPACE"," ",1870],"{",["T_WHITESPACE","\n            ",1870],["T_COMMENT","\/\/ resize the window, if appropriate\n",1871],["T_WHITESPACE","            ",1872],["T_VARIABLE","$this",1872],["T_OBJECT_OPERATOR","->",1872],["T_STRING","window_size_client_to_server",1872],"[",["T_VARIABLE","$client_channel",1872],"]",["T_MINUS_EQUAL","-=",1872],["T_WHITESPACE"," ",1872],["T_VARIABLE","$this",1872],["T_OBJECT_OPERATOR","->",1872],["T_STRING","packet_size_client_to_server",1872],"[",["T_VARIABLE","$client_channel",1872],"]",";",["T_WHITESPACE","\n            ",1872],["T_IF","if",1873],["T_WHITESPACE"," ",1873],"(",["T_VARIABLE","$this",1873],["T_OBJECT_OPERATOR","->",1873],["T_STRING","window_size_client_to_server",1873],"[",["T_VARIABLE","$client_channel",1873],"]",["T_WHITESPACE"," ",1873],"<",["T_WHITESPACE"," ",1873],["T_LNUMBER","0",1873],")",["T_WHITESPACE"," ",1873],"{",["T_WHITESPACE","\n                ",1873],["T_VARIABLE","$packet",1874],["T_WHITESPACE"," ",1874],"=",["T_WHITESPACE"," ",1874],["T_STRING","pack",1874],"(",["T_CONSTANT_ENCAPSED_STRING","'CNN'",1874],",",["T_WHITESPACE"," ",1874],["T_STRING","NET_SSH2_MSG_CHANNEL_WINDOW_ADJUST",1874],",",["T_WHITESPACE"," ",1874],["T_VARIABLE","$this",1874],["T_OBJECT_OPERATOR","->",1874],["T_STRING","server_channels",1874],"[",["T_VARIABLE","$client_channel",1874],"]",",",["T_WHITESPACE"," ",1874],["T_VARIABLE","$this",1874],["T_OBJECT_OPERATOR","->",1874],["T_STRING","window_size",1874],")",";",["T_WHITESPACE","\n                ",1874],["T_IF","if",1875],["T_WHITESPACE"," ",1875],"(","!",["T_VARIABLE","$this",1875],["T_OBJECT_OPERATOR","->",1875],["T_STRING","_send_binary_packet",1875],"(",["T_VARIABLE","$packet",1875],")",")",["T_WHITESPACE"," ",1875],"{",["T_WHITESPACE","\n                    ",1875],["T_RETURN","return",1876],["T_WHITESPACE"," ",1876],["T_STRING","false",1876],";",["T_WHITESPACE","\n                ",1876],"}",["T_WHITESPACE","\n                ",1877],["T_VARIABLE","$this",1878],["T_OBJECT_OPERATOR","->",1878],["T_STRING","window_size_client_to_server",1878],"[",["T_VARIABLE","$client_channel",1878],"]",["T_PLUS_EQUAL","+=",1878],["T_WHITESPACE"," ",1878],["T_VARIABLE","$this",1878],["T_OBJECT_OPERATOR","->",1878],["T_STRING","window_size",1878],";",["T_WHITESPACE","\n            ",1878],"}",["T_WHITESPACE","\n\n            ",1879],["T_VARIABLE","$packet",1881],["T_WHITESPACE"," ",1881],"=",["T_WHITESPACE"," ",1881],["T_STRING","pack",1881],"(",["T_CONSTANT_ENCAPSED_STRING","'CN2a*'",1881],",",["T_WHITESPACE","\n                ",1881],["T_STRING","NET_SSH2_MSG_CHANNEL_DATA",1882],",",["T_WHITESPACE","\n                ",1882],["T_VARIABLE","$this",1883],["T_OBJECT_OPERATOR","->",1883],["T_STRING","server_channels",1883],"[",["T_VARIABLE","$client_channel",1883],"]",",",["T_WHITESPACE","\n                ",1883],["T_VARIABLE","$this",1884],["T_OBJECT_OPERATOR","->",1884],["T_STRING","packet_size_client_to_server",1884],"[",["T_VARIABLE","$client_channel",1884],"]",",",["T_WHITESPACE","\n                ",1884],["T_VARIABLE","$this",1885],["T_OBJECT_OPERATOR","->",1885],["T_STRING","_string_shift",1885],"(",["T_VARIABLE","$data",1885],",",["T_WHITESPACE"," ",1885],["T_VARIABLE","$this",1885],["T_OBJECT_OPERATOR","->",1885],["T_STRING","packet_size_client_to_server",1885],"[",["T_VARIABLE","$client_channel",1885],"]",")",["T_WHITESPACE","\n            ",1885],")",";",["T_WHITESPACE","\n\n            ",1886],["T_IF","if",1888],["T_WHITESPACE"," ",1888],"(","!",["T_VARIABLE","$this",1888],["T_OBJECT_OPERATOR","->",1888],["T_STRING","_send_binary_packet",1888],"(",["T_VARIABLE","$packet",1888],")",")",["T_WHITESPACE"," ",1888],"{",["T_WHITESPACE","\n                ",1888],["T_RETURN","return",1889],["T_WHITESPACE"," ",1889],["T_STRING","false",1889],";",["T_WHITESPACE","\n            ",1889],"}",["T_WHITESPACE","\n        ",1890],"}",["T_WHITESPACE","\n\n        ",1891],["T_COMMENT","\/\/ resize the window, if appropriate\n",1893],["T_WHITESPACE","        ",1894],["T_VARIABLE","$this",1894],["T_OBJECT_OPERATOR","->",1894],["T_STRING","window_size_client_to_server",1894],"[",["T_VARIABLE","$client_channel",1894],"]",["T_MINUS_EQUAL","-=",1894],["T_WHITESPACE"," ",1894],["T_STRING","strlen",1894],"(",["T_VARIABLE","$data",1894],")",";",["T_WHITESPACE","\n        ",1894],["T_IF","if",1895],["T_WHITESPACE"," ",1895],"(",["T_VARIABLE","$this",1895],["T_OBJECT_OPERATOR","->",1895],["T_STRING","window_size_client_to_server",1895],"[",["T_VARIABLE","$client_channel",1895],"]",["T_WHITESPACE"," ",1895],"<",["T_WHITESPACE"," ",1895],["T_LNUMBER","0",1895],")",["T_WHITESPACE"," ",1895],"{",["T_WHITESPACE","\n            ",1895],["T_VARIABLE","$packet",1896],["T_WHITESPACE"," ",1896],"=",["T_WHITESPACE"," ",1896],["T_STRING","pack",1896],"(",["T_CONSTANT_ENCAPSED_STRING","'CNN'",1896],",",["T_WHITESPACE"," ",1896],["T_STRING","NET_SSH2_MSG_CHANNEL_WINDOW_ADJUST",1896],",",["T_WHITESPACE"," ",1896],["T_VARIABLE","$this",1896],["T_OBJECT_OPERATOR","->",1896],["T_STRING","server_channels",1896],"[",["T_VARIABLE","$client_channel",1896],"]",",",["T_WHITESPACE"," ",1896],["T_VARIABLE","$this",1896],["T_OBJECT_OPERATOR","->",1896],["T_STRING","window_size",1896],")",";",["T_WHITESPACE","\n            ",1896],["T_IF","if",1897],["T_WHITESPACE"," ",1897],"(","!",["T_VARIABLE","$this",1897],["T_OBJECT_OPERATOR","->",1897],["T_STRING","_send_binary_packet",1897],"(",["T_VARIABLE","$packet",1897],")",")",["T_WHITESPACE"," ",1897],"{",["T_WHITESPACE","\n                ",1897],["T_RETURN","return",1898],["T_WHITESPACE"," ",1898],["T_STRING","false",1898],";",["T_WHITESPACE","\n            ",1898],"}",["T_WHITESPACE","\n            ",1899],["T_VARIABLE","$this",1900],["T_OBJECT_OPERATOR","->",1900],["T_STRING","window_size_client_to_server",1900],"[",["T_VARIABLE","$client_channel",1900],"]",["T_PLUS_EQUAL","+=",1900],["T_WHITESPACE"," ",1900],["T_VARIABLE","$this",1900],["T_OBJECT_OPERATOR","->",1900],["T_STRING","window_size",1900],";",["T_WHITESPACE","\n        ",1900],"}",["T_WHITESPACE","\n\n        ",1901],["T_RETURN","return",1903],["T_WHITESPACE"," ",1903],["T_VARIABLE","$this",1903],["T_OBJECT_OPERATOR","->",1903],["T_STRING","_send_binary_packet",1903],"(",["T_STRING","pack",1903],"(",["T_CONSTANT_ENCAPSED_STRING","'CN2a*'",1903],",",["T_WHITESPACE","\n            ",1903],["T_STRING","NET_SSH2_MSG_CHANNEL_DATA",1904],",",["T_WHITESPACE","\n            ",1904],["T_VARIABLE","$this",1905],["T_OBJECT_OPERATOR","->",1905],["T_STRING","server_channels",1905],"[",["T_VARIABLE","$client_channel",1905],"]",",",["T_WHITESPACE","\n            ",1905],["T_STRING","strlen",1906],"(",["T_VARIABLE","$data",1906],")",",",["T_WHITESPACE","\n            ",1906],["T_VARIABLE","$data",1907],")",")",";",["T_WHITESPACE","\n    ",1907],"}",["T_WHITESPACE","\n\n    ",1908],["T_DOC_COMMENT","\/**\n     * Disconnect\n     *\n     * @param Integer $reason\n     * @return Boolean\n     * @access private\n     *\/",1910],["T_WHITESPACE","\n    ",1916],["T_FUNCTION","function",1917],["T_WHITESPACE"," ",1917],["T_STRING","_disconnect",1917],"(",["T_VARIABLE","$reason",1917],")",["T_WHITESPACE","\n    ",1917],"{",["T_WHITESPACE","\n        ",1918],["T_IF","if",1919],["T_WHITESPACE"," ",1919],"(",["T_VARIABLE","$this",1919],["T_OBJECT_OPERATOR","->",1919],["T_STRING","bitmap",1919],")",["T_WHITESPACE"," ",1919],"{",["T_WHITESPACE","\n            ",1919],["T_VARIABLE","$data",1920],["T_WHITESPACE"," ",1920],"=",["T_WHITESPACE"," ",1920],["T_STRING","pack",1920],"(",["T_CONSTANT_ENCAPSED_STRING","'CNNa*Na*'",1920],",",["T_WHITESPACE"," ",1920],["T_STRING","NET_SSH2_MSG_DISCONNECT",1920],",",["T_WHITESPACE"," ",1920],["T_VARIABLE","$reason",1920],",",["T_WHITESPACE"," ",1920],["T_LNUMBER","0",1920],",",["T_WHITESPACE"," ",1920],["T_CONSTANT_ENCAPSED_STRING","''",1920],",",["T_WHITESPACE"," ",1920],["T_LNUMBER","0",1920],",",["T_WHITESPACE"," ",1920],["T_CONSTANT_ENCAPSED_STRING","''",1920],")",";",["T_WHITESPACE","\n            ",1920],["T_VARIABLE","$this",1921],["T_OBJECT_OPERATOR","->",1921],["T_STRING","_send_binary_packet",1921],"(",["T_VARIABLE","$data",1921],")",";",["T_WHITESPACE","\n            ",1921],["T_VARIABLE","$this",1922],["T_OBJECT_OPERATOR","->",1922],["T_STRING","bitmap",1922],["T_WHITESPACE"," ",1922],"=",["T_WHITESPACE"," ",1922],["T_LNUMBER","0",1922],";",["T_WHITESPACE","\n            ",1922],["T_STRING","fclose",1923],"(",["T_VARIABLE","$this",1923],["T_OBJECT_OPERATOR","->",1923],["T_STRING","fsock",1923],")",";",["T_WHITESPACE","\n            ",1923],["T_RETURN","return",1924],["T_WHITESPACE"," ",1924],["T_STRING","false",1924],";",["T_WHITESPACE","\n        ",1924],"}",["T_WHITESPACE","\n    ",1925],"}",["T_WHITESPACE","\n\n    ",1926],["T_DOC_COMMENT","\/**\n     * String Shift\n     *\n     * Inspired by array_shift\n     *\n     * @param String $string\n     * @param optional Integer $index\n     * @return String\n     * @access private\n     *\/",1928],["T_WHITESPACE","\n    ",1937],["T_FUNCTION","function",1938],["T_WHITESPACE"," ",1938],["T_STRING","_string_shift",1938],"(","&",["T_VARIABLE","$string",1938],",",["T_WHITESPACE"," ",1938],["T_VARIABLE","$index",1938],["T_WHITESPACE"," ",1938],"=",["T_WHITESPACE"," ",1938],["T_LNUMBER","1",1938],")",["T_WHITESPACE","\n    ",1938],"{",["T_WHITESPACE","\n        ",1939],["T_VARIABLE","$substr",1940],["T_WHITESPACE"," ",1940],"=",["T_WHITESPACE"," ",1940],["T_STRING","substr",1940],"(",["T_VARIABLE","$string",1940],",",["T_WHITESPACE"," ",1940],["T_LNUMBER","0",1940],",",["T_WHITESPACE"," ",1940],["T_VARIABLE","$index",1940],")",";",["T_WHITESPACE","\n        ",1940],["T_VARIABLE","$string",1941],["T_WHITESPACE"," ",1941],"=",["T_WHITESPACE"," ",1941],["T_STRING","substr",1941],"(",["T_VARIABLE","$string",1941],",",["T_WHITESPACE"," ",1941],["T_VARIABLE","$index",1941],")",";",["T_WHITESPACE","\n        ",1941],["T_RETURN","return",1942],["T_WHITESPACE"," ",1942],["T_VARIABLE","$substr",1942],";",["T_WHITESPACE","\n    ",1942],"}",["T_WHITESPACE","\n\n    ",1943],["T_DOC_COMMENT","\/**\n     * Define Array\n     *\n     * Takes any number of arrays whose indices are integers and whose values are strings and defines a bunch of\n     * named constants from it, using the value as the name of the constant and the index as the value of the constant.\n     * If any of the constants that would be defined already exists, none of the constants will be defined.\n     *\n     * @param Array $array\n     * @access private\n     *\/",1945],["T_WHITESPACE","\n    ",1954],["T_FUNCTION","function",1955],["T_WHITESPACE"," ",1955],["T_STRING","_define_array",1955],"(",")",["T_WHITESPACE","\n    ",1955],"{",["T_WHITESPACE","\n        ",1956],["T_VARIABLE","$args",1957],["T_WHITESPACE"," ",1957],"=",["T_WHITESPACE"," ",1957],["T_STRING","func_get_args",1957],"(",")",";",["T_WHITESPACE","\n        ",1957],["T_FOREACH","foreach",1958],["T_WHITESPACE"," ",1958],"(",["T_VARIABLE","$args",1958],["T_WHITESPACE"," ",1958],["T_AS","as",1958],["T_WHITESPACE"," ",1958],["T_VARIABLE","$arg",1958],")",["T_WHITESPACE"," ",1958],"{",["T_WHITESPACE","\n            ",1958],["T_FOREACH","foreach",1959],["T_WHITESPACE"," ",1959],"(",["T_VARIABLE","$arg",1959],["T_WHITESPACE"," ",1959],["T_AS","as",1959],["T_WHITESPACE"," ",1959],["T_VARIABLE","$key",1959],["T_DOUBLE_ARROW","=>",1959],["T_VARIABLE","$value",1959],")",["T_WHITESPACE"," ",1959],"{",["T_WHITESPACE","\n                ",1959],["T_IF","if",1960],["T_WHITESPACE"," ",1960],"(","!",["T_STRING","defined",1960],"(",["T_VARIABLE","$value",1960],")",")",["T_WHITESPACE"," ",1960],"{",["T_WHITESPACE","\n                    ",1960],["T_STRING","define",1961],"(",["T_VARIABLE","$value",1961],",",["T_WHITESPACE"," ",1961],["T_VARIABLE","$key",1961],")",";",["T_WHITESPACE","\n                ",1961],"}",["T_WHITESPACE"," ",1962],["T_ELSE","else",1962],["T_WHITESPACE"," ",1962],"{",["T_WHITESPACE","\n                    ",1962],["T_BREAK","break",1963],["T_WHITESPACE"," ",1963],["T_LNUMBER","2",1963],";",["T_WHITESPACE","\n                ",1963],"}",["T_WHITESPACE","\n            ",1964],"}",["T_WHITESPACE","\n        ",1965],"}",["T_WHITESPACE","\n    ",1966],"}",["T_WHITESPACE","\n\n    ",1967],["T_DOC_COMMENT","\/**\n     * Returns a log of the packets that have been sent and received.\n     *\n     * Returns a string if NET_SSH2_LOGGING == NET_SSH2_LOG_COMPLEX, an array if NET_SSH2_LOGGING == NET_SSH2_LOG_SIMPLE and false if !defined('NET_SSH2_LOGGING')\n     *\n     * @access public\n     * @return String or Array\n     *\/",1969],["T_WHITESPACE","\n    ",1976],["T_FUNCTION","function",1977],["T_WHITESPACE"," ",1977],["T_STRING","getLog",1977],"(",")",["T_WHITESPACE","\n    ",1977],"{",["T_WHITESPACE","\n        ",1978],["T_IF","if",1979],["T_WHITESPACE"," ",1979],"(","!",["T_STRING","defined",1979],"(",["T_CONSTANT_ENCAPSED_STRING","'NET_SSH2_LOGGING'",1979],")",")",["T_WHITESPACE"," ",1979],"{",["T_WHITESPACE","\n            ",1979],["T_RETURN","return",1980],["T_WHITESPACE"," ",1980],["T_STRING","false",1980],";",["T_WHITESPACE","\n        ",1980],"}",["T_WHITESPACE","\n\n        ",1981],["T_SWITCH","switch",1983],["T_WHITESPACE"," ",1983],"(",["T_STRING","NET_SSH2_LOGGING",1983],")",["T_WHITESPACE"," ",1983],"{",["T_WHITESPACE","\n            ",1983],["T_CASE","case",1984],["T_WHITESPACE"," ",1984],["T_STRING","NET_SSH2_LOG_SIMPLE",1984],":",["T_WHITESPACE","\n                ",1984],["T_RETURN","return",1985],["T_WHITESPACE"," ",1985],["T_VARIABLE","$this",1985],["T_OBJECT_OPERATOR","->",1985],["T_STRING","message_number_log",1985],";",["T_WHITESPACE","\n                ",1985],["T_BREAK","break",1986],";",["T_WHITESPACE","\n            ",1986],["T_CASE","case",1987],["T_WHITESPACE"," ",1987],["T_STRING","NET_SSH2_LOG_COMPLEX",1987],":",["T_WHITESPACE","\n                ",1987],["T_RETURN","return",1988],["T_WHITESPACE"," ",1988],["T_VARIABLE","$this",1988],["T_OBJECT_OPERATOR","->",1988],["T_STRING","_format_log",1988],"(",["T_VARIABLE","$this",1988],["T_OBJECT_OPERATOR","->",1988],["T_STRING","message_log",1988],",",["T_WHITESPACE"," ",1988],["T_VARIABLE","$this",1988],["T_OBJECT_OPERATOR","->",1988],["T_STRING","message_number_log",1988],")",";",["T_WHITESPACE","\n                ",1988],["T_BREAK","break",1989],";",["T_WHITESPACE","\n            ",1989],["T_DEFAULT","default",1990],":",["T_WHITESPACE","\n                ",1990],["T_RETURN","return",1991],["T_WHITESPACE"," ",1991],["T_STRING","false",1991],";",["T_WHITESPACE","\n        ",1991],"}",["T_WHITESPACE","\n    ",1992],"}",["T_WHITESPACE","\n\n    ",1993],["T_DOC_COMMENT","\/**\n     * Formats a log for printing\n     *\n     * @param Array $message_log\n     * @param Array $message_number_log\n     * @access private\n     * @return String\n     *\/",1995],["T_WHITESPACE","\n    ",2002],["T_FUNCTION","function",2003],["T_WHITESPACE"," ",2003],["T_STRING","_format_log",2003],"(",["T_VARIABLE","$message_log",2003],",",["T_WHITESPACE"," ",2003],["T_VARIABLE","$message_number_log",2003],")",["T_WHITESPACE","\n    ",2003],"{",["T_WHITESPACE","\n        ",2004],["T_STATIC","static",2005],["T_WHITESPACE"," ",2005],["T_VARIABLE","$boundary",2005],["T_WHITESPACE"," ",2005],"=",["T_WHITESPACE"," ",2005],["T_CONSTANT_ENCAPSED_STRING","':'",2005],",",["T_WHITESPACE"," ",2005],["T_VARIABLE","$long_width",2005],["T_WHITESPACE"," ",2005],"=",["T_WHITESPACE"," ",2005],["T_LNUMBER","65",2005],",",["T_WHITESPACE"," ",2005],["T_VARIABLE","$short_width",2005],["T_WHITESPACE"," ",2005],"=",["T_WHITESPACE"," ",2005],["T_LNUMBER","16",2005],";",["T_WHITESPACE","\n\n        ",2005],["T_VARIABLE","$output",2007],["T_WHITESPACE"," ",2007],"=",["T_WHITESPACE"," ",2007],["T_CONSTANT_ENCAPSED_STRING","''",2007],";",["T_WHITESPACE","\n        ",2007],["T_FOR","for",2008],["T_WHITESPACE"," ",2008],"(",["T_VARIABLE","$i",2008],["T_WHITESPACE"," ",2008],"=",["T_WHITESPACE"," ",2008],["T_LNUMBER","0",2008],";",["T_WHITESPACE"," ",2008],["T_VARIABLE","$i",2008],["T_WHITESPACE"," ",2008],"<",["T_WHITESPACE"," ",2008],["T_STRING","count",2008],"(",["T_VARIABLE","$message_log",2008],")",";",["T_WHITESPACE"," ",2008],["T_VARIABLE","$i",2008],["T_INC","++",2008],")",["T_WHITESPACE"," ",2008],"{",["T_WHITESPACE","\n            ",2008],["T_VARIABLE","$output",2009],["T_CONCAT_EQUAL",".=",2009],["T_WHITESPACE"," ",2009],["T_VARIABLE","$message_number_log",2009],"[",["T_VARIABLE","$i",2009],"]",["T_WHITESPACE"," ",2009],".",["T_WHITESPACE"," ",2009],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",2009],";",["T_WHITESPACE","\n            ",2009],["T_VARIABLE","$current_log",2010],["T_WHITESPACE"," ",2010],"=",["T_WHITESPACE"," ",2010],["T_VARIABLE","$message_log",2010],"[",["T_VARIABLE","$i",2010],"]",";",["T_WHITESPACE","\n            ",2010],["T_VARIABLE","$j",2011],["T_WHITESPACE"," ",2011],"=",["T_WHITESPACE"," ",2011],["T_LNUMBER","0",2011],";",["T_WHITESPACE","\n            ",2011],["T_DO","do",2012],["T_WHITESPACE"," ",2012],"{",["T_WHITESPACE","\n                ",2012],["T_IF","if",2013],["T_WHITESPACE"," ",2013],"(","!",["T_EMPTY","empty",2013],"(",["T_VARIABLE","$current_log",2013],")",")",["T_WHITESPACE"," ",2013],"{",["T_WHITESPACE","\n                    ",2013],["T_VARIABLE","$output",2014],["T_CONCAT_EQUAL",".=",2014],["T_WHITESPACE"," ",2014],["T_STRING","str_pad",2014],"(",["T_STRING","dechex",2014],"(",["T_VARIABLE","$j",2014],")",",",["T_WHITESPACE"," ",2014],["T_LNUMBER","7",2014],",",["T_WHITESPACE"," ",2014],["T_CONSTANT_ENCAPSED_STRING","'0'",2014],",",["T_WHITESPACE"," ",2014],["T_STRING","STR_PAD_LEFT",2014],")",["T_WHITESPACE"," ",2014],".",["T_WHITESPACE"," ",2014],["T_CONSTANT_ENCAPSED_STRING","'0  '",2014],";",["T_WHITESPACE","\n                ",2014],"}",["T_WHITESPACE","\n                ",2015],["T_VARIABLE","$fragment",2016],["T_WHITESPACE"," ",2016],"=",["T_WHITESPACE"," ",2016],["T_VARIABLE","$this",2016],["T_OBJECT_OPERATOR","->",2016],["T_STRING","_string_shift",2016],"(",["T_VARIABLE","$current_log",2016],",",["T_WHITESPACE"," ",2016],["T_VARIABLE","$short_width",2016],")",";",["T_WHITESPACE","\n                ",2016],["T_VARIABLE","$hex",2017],["T_WHITESPACE"," ",2017],"=",["T_WHITESPACE"," ",2017],["T_STRING","substr",2017],"(",["T_WHITESPACE","\n                           ",2017],["T_STRING","preg_replace",2018],"(",["T_WHITESPACE","\n                               ",2018],["T_CONSTANT_ENCAPSED_STRING","'#(.)#es'",2019],",",["T_WHITESPACE","\n                               ",2019],["T_CONSTANT_ENCAPSED_STRING","'\"'",2020],["T_WHITESPACE"," ",2020],".",["T_WHITESPACE"," ",2020],["T_VARIABLE","$boundary",2020],["T_WHITESPACE"," ",2020],".",["T_WHITESPACE"," ",2020],["T_CONSTANT_ENCAPSED_STRING","'\" . str_pad(dechex(ord(substr(\"\\\\1\", -1))), 2, \"0\", STR_PAD_LEFT)'",2020],",",["T_WHITESPACE","\n                               ",2020],["T_VARIABLE","$fragment",2021],")",",",["T_WHITESPACE","\n                           ",2021],["T_STRING","strlen",2022],"(",["T_VARIABLE","$boundary",2022],")",["T_WHITESPACE","\n                       ",2022],")",";",["T_WHITESPACE","\n                ",2023],["T_COMMENT","\/\/ replace non ASCII printable characters with dots\n",2024],["T_WHITESPACE","                ",2025],["T_COMMENT","\/\/ http:\/\/en.wikipedia.org\/wiki\/ASCII#ASCII_printable_characters\n",2025],["T_WHITESPACE","                ",2026],["T_COMMENT","\/\/ also replace < with a . since < messes up the output on web browsers\n",2026],["T_WHITESPACE","                ",2027],["T_VARIABLE","$raw",2027],["T_WHITESPACE"," ",2027],"=",["T_WHITESPACE"," ",2027],["T_STRING","preg_replace",2027],"(",["T_CONSTANT_ENCAPSED_STRING","'#[^\\x20-\\x7E]|<#'",2027],",",["T_WHITESPACE"," ",2027],["T_CONSTANT_ENCAPSED_STRING","'.'",2027],",",["T_WHITESPACE"," ",2027],["T_VARIABLE","$fragment",2027],")",";",["T_WHITESPACE","\n                ",2027],["T_VARIABLE","$output",2028],["T_CONCAT_EQUAL",".=",2028],["T_WHITESPACE"," ",2028],["T_STRING","str_pad",2028],"(",["T_VARIABLE","$hex",2028],",",["T_WHITESPACE"," ",2028],["T_VARIABLE","$long_width",2028],["T_WHITESPACE"," ",2028],"-",["T_WHITESPACE"," ",2028],["T_VARIABLE","$short_width",2028],",",["T_WHITESPACE"," ",2028],["T_CONSTANT_ENCAPSED_STRING","' '",2028],")",["T_WHITESPACE"," ",2028],".",["T_WHITESPACE"," ",2028],["T_VARIABLE","$raw",2028],["T_WHITESPACE"," ",2028],".",["T_WHITESPACE"," ",2028],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",2028],";",["T_WHITESPACE","\n                ",2028],["T_VARIABLE","$j",2029],["T_INC","++",2029],";",["T_WHITESPACE","\n            ",2029],"}",["T_WHITESPACE"," ",2030],["T_WHILE","while",2030],["T_WHITESPACE"," ",2030],"(","!",["T_EMPTY","empty",2030],"(",["T_VARIABLE","$current_log",2030],")",")",";",["T_WHITESPACE","\n            ",2030],["T_VARIABLE","$output",2031],["T_CONCAT_EQUAL",".=",2031],["T_WHITESPACE"," ",2031],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",2031],";",["T_WHITESPACE","\n        ",2031],"}",["T_WHITESPACE","\n\n        ",2032],["T_RETURN","return",2034],["T_WHITESPACE"," ",2034],["T_VARIABLE","$output",2034],";",["T_WHITESPACE","\n    ",2034],"}",["T_WHITESPACE","\n\n    ",2035],["T_DOC_COMMENT","\/**\n     * Returns all errors\n     *\n     * @return String\n     * @access public\n     *\/",2037],["T_WHITESPACE","\n    ",2042],["T_FUNCTION","function",2043],["T_WHITESPACE"," ",2043],["T_STRING","getErrors",2043],"(",")",["T_WHITESPACE","\n    ",2043],"{",["T_WHITESPACE","\n        ",2044],["T_RETURN","return",2045],["T_WHITESPACE"," ",2045],["T_VARIABLE","$this",2045],["T_OBJECT_OPERATOR","->",2045],["T_STRING","errors",2045],";",["T_WHITESPACE","\n    ",2045],"}",["T_WHITESPACE","\n\n    ",2046],["T_DOC_COMMENT","\/**\n     * Returns the last error\n     *\n     * @return String\n     * @access public\n     *\/",2048],["T_WHITESPACE","\n    ",2053],["T_FUNCTION","function",2054],["T_WHITESPACE"," ",2054],["T_STRING","getLastError",2054],"(",")",["T_WHITESPACE","\n    ",2054],"{",["T_WHITESPACE","\n        ",2055],["T_RETURN","return",2056],["T_WHITESPACE"," ",2056],["T_VARIABLE","$this",2056],["T_OBJECT_OPERATOR","->",2056],["T_STRING","errors",2056],"[",["T_STRING","count",2056],"(",["T_VARIABLE","$this",2056],["T_OBJECT_OPERATOR","->",2056],["T_STRING","errors",2056],")",["T_WHITESPACE"," ",2056],"-",["T_WHITESPACE"," ",2056],["T_LNUMBER","1",2056],"]",";",["T_WHITESPACE","\n    ",2056],"}",["T_WHITESPACE","\n\n    ",2057],["T_DOC_COMMENT","\/**\n     * Return the server identification.\n     *\n     * @return String\n     * @access public\n     *\/",2059],["T_WHITESPACE","\n    ",2064],["T_FUNCTION","function",2065],["T_WHITESPACE"," ",2065],["T_STRING","getServerIdentification",2065],"(",")",["T_WHITESPACE","\n    ",2065],"{",["T_WHITESPACE","\n        ",2066],["T_RETURN","return",2067],["T_WHITESPACE"," ",2067],["T_VARIABLE","$this",2067],["T_OBJECT_OPERATOR","->",2067],["T_STRING","server_identifier",2067],";",["T_WHITESPACE","\n    ",2067],"}",["T_WHITESPACE","\n\n    ",2068],["T_DOC_COMMENT","\/**\n     * Return a list of the key exchange algorithms the server supports.\n     *\n     * @return Array\n     * @access public\n     *\/",2070],["T_WHITESPACE","\n    ",2075],["T_FUNCTION","function",2076],["T_WHITESPACE"," ",2076],["T_STRING","getKexAlgorithms",2076],"(",")",["T_WHITESPACE","\n    ",2076],"{",["T_WHITESPACE","\n        ",2077],["T_RETURN","return",2078],["T_WHITESPACE"," ",2078],["T_VARIABLE","$this",2078],["T_OBJECT_OPERATOR","->",2078],["T_STRING","kex_algorithms",2078],";",["T_WHITESPACE","\n    ",2078],"}",["T_WHITESPACE","\n\n    ",2079],["T_DOC_COMMENT","\/**\n     * Return a list of the host key (public key) algorithms the server supports.\n     *\n     * @return Array\n     * @access public\n     *\/",2081],["T_WHITESPACE","\n    ",2086],["T_FUNCTION","function",2087],["T_WHITESPACE"," ",2087],["T_STRING","getServerHostKeyAlgorithms",2087],"(",")",["T_WHITESPACE","\n    ",2087],"{",["T_WHITESPACE","\n        ",2088],["T_RETURN","return",2089],["T_WHITESPACE"," ",2089],["T_VARIABLE","$this",2089],["T_OBJECT_OPERATOR","->",2089],["T_STRING","server_host_key_algorithms",2089],";",["T_WHITESPACE","\n    ",2089],"}",["T_WHITESPACE","\n\n    ",2090],["T_DOC_COMMENT","\/**\n     * Return a list of the (symmetric key) encryption algorithms the server supports, when receiving stuff from the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2092],["T_WHITESPACE","\n    ",2097],["T_FUNCTION","function",2098],["T_WHITESPACE"," ",2098],["T_STRING","getEncryptionAlgorithmsClient2Server",2098],"(",")",["T_WHITESPACE","\n    ",2098],"{",["T_WHITESPACE","\n        ",2099],["T_RETURN","return",2100],["T_WHITESPACE"," ",2100],["T_VARIABLE","$this",2100],["T_OBJECT_OPERATOR","->",2100],["T_STRING","encryption_algorithms_client_to_server",2100],";",["T_WHITESPACE","\n    ",2100],"}",["T_WHITESPACE","\n\n    ",2101],["T_DOC_COMMENT","\/**\n     * Return a list of the (symmetric key) encryption algorithms the server supports, when sending stuff to the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2103],["T_WHITESPACE","\n    ",2108],["T_FUNCTION","function",2109],["T_WHITESPACE"," ",2109],["T_STRING","getEncryptionAlgorithmsServer2Client",2109],"(",")",["T_WHITESPACE","\n    ",2109],"{",["T_WHITESPACE","\n        ",2110],["T_RETURN","return",2111],["T_WHITESPACE"," ",2111],["T_VARIABLE","$this",2111],["T_OBJECT_OPERATOR","->",2111],["T_STRING","encryption_algorithms_server_to_client",2111],";",["T_WHITESPACE","\n    ",2111],"}",["T_WHITESPACE","\n\n    ",2112],["T_DOC_COMMENT","\/**\n     * Return a list of the MAC algorithms the server supports, when receiving stuff from the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2114],["T_WHITESPACE","\n    ",2119],["T_FUNCTION","function",2120],["T_WHITESPACE"," ",2120],["T_STRING","getMACAlgorithmsClient2Server",2120],"(",")",["T_WHITESPACE","\n    ",2120],"{",["T_WHITESPACE","\n        ",2121],["T_RETURN","return",2122],["T_WHITESPACE"," ",2122],["T_VARIABLE","$this",2122],["T_OBJECT_OPERATOR","->",2122],["T_STRING","mac_algorithms_client_to_server",2122],";",["T_WHITESPACE","\n    ",2122],"}",["T_WHITESPACE","\n\n    ",2123],["T_DOC_COMMENT","\/**\n     * Return a list of the MAC algorithms the server supports, when sending stuff to the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2125],["T_WHITESPACE","\n    ",2130],["T_FUNCTION","function",2131],["T_WHITESPACE"," ",2131],["T_STRING","getMACAlgorithmsServer2Client",2131],"(",")",["T_WHITESPACE","\n    ",2131],"{",["T_WHITESPACE","\n        ",2132],["T_RETURN","return",2133],["T_WHITESPACE"," ",2133],["T_VARIABLE","$this",2133],["T_OBJECT_OPERATOR","->",2133],["T_STRING","mac_algorithms_server_to_client",2133],";",["T_WHITESPACE","\n    ",2133],"}",["T_WHITESPACE","\n\n    ",2134],["T_DOC_COMMENT","\/**\n     * Return a list of the compression algorithms the server supports, when receiving stuff from the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2136],["T_WHITESPACE","\n    ",2141],["T_FUNCTION","function",2142],["T_WHITESPACE"," ",2142],["T_STRING","getCompressionAlgorithmsClient2Server",2142],"(",")",["T_WHITESPACE","\n    ",2142],"{",["T_WHITESPACE","\n        ",2143],["T_RETURN","return",2144],["T_WHITESPACE"," ",2144],["T_VARIABLE","$this",2144],["T_OBJECT_OPERATOR","->",2144],["T_STRING","compression_algorithms_client_to_server",2144],";",["T_WHITESPACE","\n    ",2144],"}",["T_WHITESPACE","\n\n    ",2145],["T_DOC_COMMENT","\/**\n     * Return a list of the compression algorithms the server supports, when sending stuff to the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2147],["T_WHITESPACE","\n    ",2152],["T_FUNCTION","function",2153],["T_WHITESPACE"," ",2153],["T_STRING","getCompressionAlgorithmsServer2Client",2153],"(",")",["T_WHITESPACE","\n    ",2153],"{",["T_WHITESPACE","\n        ",2154],["T_RETURN","return",2155],["T_WHITESPACE"," ",2155],["T_VARIABLE","$this",2155],["T_OBJECT_OPERATOR","->",2155],["T_STRING","compression_algorithms_server_to_client",2155],";",["T_WHITESPACE","\n    ",2155],"}",["T_WHITESPACE","\n\n    ",2156],["T_DOC_COMMENT","\/**\n     * Return a list of the languages the server supports, when sending stuff to the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2158],["T_WHITESPACE","\n    ",2163],["T_FUNCTION","function",2164],["T_WHITESPACE"," ",2164],["T_STRING","getLanguagesServer2Client",2164],"(",")",["T_WHITESPACE","\n    ",2164],"{",["T_WHITESPACE","\n        ",2165],["T_RETURN","return",2166],["T_WHITESPACE"," ",2166],["T_VARIABLE","$this",2166],["T_OBJECT_OPERATOR","->",2166],["T_STRING","languages_server_to_client",2166],";",["T_WHITESPACE","\n    ",2166],"}",["T_WHITESPACE","\n\n    ",2167],["T_DOC_COMMENT","\/**\n     * Return a list of the languages the server supports, when receiving stuff from the client.\n     *\n     * @return Array\n     * @access public\n     *\/",2169],["T_WHITESPACE","\n    ",2174],["T_FUNCTION","function",2175],["T_WHITESPACE"," ",2175],["T_STRING","getLanguagesClient2Server",2175],"(",")",["T_WHITESPACE","\n    ",2175],"{",["T_WHITESPACE","\n        ",2176],["T_RETURN","return",2177],["T_WHITESPACE"," ",2177],["T_VARIABLE","$this",2177],["T_OBJECT_OPERATOR","->",2177],["T_STRING","languages_client_to_server",2177],";",["T_WHITESPACE","\n    ",2177],"}",["T_WHITESPACE","\n\n    ",2178],["T_DOC_COMMENT","\/**\n     * Returns the server public host key.\n     *\n     * Caching this the first time you connect to a server and checking the result on subsequent connections\n     * is recommended.  Returns false if the server signature is not signed correctly with the public host key.\n     *\n     * @return Mixed\n     * @access public\n     *\/",2180],["T_WHITESPACE","\n    ",2188],["T_FUNCTION","function",2189],["T_WHITESPACE"," ",2189],["T_STRING","getServerPublicHostKey",2189],"(",")",["T_WHITESPACE","\n    ",2189],"{",["T_WHITESPACE","\n        ",2190],["T_VARIABLE","$signature",2191],["T_WHITESPACE"," ",2191],"=",["T_WHITESPACE"," ",2191],["T_VARIABLE","$this",2191],["T_OBJECT_OPERATOR","->",2191],["T_STRING","signature",2191],";",["T_WHITESPACE","\n        ",2191],["T_VARIABLE","$server_public_host_key",2192],["T_WHITESPACE"," ",2192],"=",["T_WHITESPACE"," ",2192],["T_VARIABLE","$this",2192],["T_OBJECT_OPERATOR","->",2192],["T_STRING","server_public_host_key",2192],";",["T_WHITESPACE","\n\n        ",2192],["T_STRING","extract",2194],"(",["T_STRING","unpack",2194],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2194],",",["T_WHITESPACE"," ",2194],["T_VARIABLE","$this",2194],["T_OBJECT_OPERATOR","->",2194],["T_STRING","_string_shift",2194],"(",["T_VARIABLE","$server_public_host_key",2194],",",["T_WHITESPACE"," ",2194],["T_LNUMBER","4",2194],")",")",")",";",["T_WHITESPACE","\n        ",2194],["T_VARIABLE","$this",2195],["T_OBJECT_OPERATOR","->",2195],["T_STRING","_string_shift",2195],"(",["T_VARIABLE","$server_public_host_key",2195],",",["T_WHITESPACE"," ",2195],["T_VARIABLE","$length",2195],")",";",["T_WHITESPACE","\n\n        ",2195],["T_SWITCH","switch",2197],["T_WHITESPACE"," ",2197],"(",["T_VARIABLE","$this",2197],["T_OBJECT_OPERATOR","->",2197],["T_STRING","signature_format",2197],")",["T_WHITESPACE"," ",2197],"{",["T_WHITESPACE","\n            ",2197],["T_CASE","case",2198],["T_WHITESPACE"," ",2198],["T_CONSTANT_ENCAPSED_STRING","'ssh-dss'",2198],":",["T_WHITESPACE","\n                ",2198],["T_VARIABLE","$temp",2199],["T_WHITESPACE"," ",2199],"=",["T_WHITESPACE"," ",2199],["T_STRING","unpack",2199],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2199],",",["T_WHITESPACE"," ",2199],["T_VARIABLE","$this",2199],["T_OBJECT_OPERATOR","->",2199],["T_STRING","_string_shift",2199],"(",["T_VARIABLE","$server_public_host_key",2199],",",["T_WHITESPACE"," ",2199],["T_LNUMBER","4",2199],")",")",";",["T_WHITESPACE","\n                ",2199],["T_VARIABLE","$p",2200],["T_WHITESPACE"," ",2200],"=",["T_WHITESPACE"," ",2200],["T_NEW","new",2200],["T_WHITESPACE"," ",2200],["T_STRING","Math_BigInteger",2200],"(",["T_VARIABLE","$this",2200],["T_OBJECT_OPERATOR","->",2200],["T_STRING","_string_shift",2200],"(",["T_VARIABLE","$server_public_host_key",2200],",",["T_WHITESPACE"," ",2200],["T_VARIABLE","$temp",2200],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2200],"]",")",",",["T_WHITESPACE"," ",2200],"-",["T_LNUMBER","256",2200],")",";",["T_WHITESPACE","\n\n                ",2200],["T_VARIABLE","$temp",2202],["T_WHITESPACE"," ",2202],"=",["T_WHITESPACE"," ",2202],["T_STRING","unpack",2202],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2202],",",["T_WHITESPACE"," ",2202],["T_VARIABLE","$this",2202],["T_OBJECT_OPERATOR","->",2202],["T_STRING","_string_shift",2202],"(",["T_VARIABLE","$server_public_host_key",2202],",",["T_WHITESPACE"," ",2202],["T_LNUMBER","4",2202],")",")",";",["T_WHITESPACE","\n                ",2202],["T_VARIABLE","$q",2203],["T_WHITESPACE"," ",2203],"=",["T_WHITESPACE"," ",2203],["T_NEW","new",2203],["T_WHITESPACE"," ",2203],["T_STRING","Math_BigInteger",2203],"(",["T_VARIABLE","$this",2203],["T_OBJECT_OPERATOR","->",2203],["T_STRING","_string_shift",2203],"(",["T_VARIABLE","$server_public_host_key",2203],",",["T_WHITESPACE"," ",2203],["T_VARIABLE","$temp",2203],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2203],"]",")",",",["T_WHITESPACE"," ",2203],"-",["T_LNUMBER","256",2203],")",";",["T_WHITESPACE","\n\n                ",2203],["T_VARIABLE","$temp",2205],["T_WHITESPACE"," ",2205],"=",["T_WHITESPACE"," ",2205],["T_STRING","unpack",2205],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2205],",",["T_WHITESPACE"," ",2205],["T_VARIABLE","$this",2205],["T_OBJECT_OPERATOR","->",2205],["T_STRING","_string_shift",2205],"(",["T_VARIABLE","$server_public_host_key",2205],",",["T_WHITESPACE"," ",2205],["T_LNUMBER","4",2205],")",")",";",["T_WHITESPACE","\n                ",2205],["T_VARIABLE","$g",2206],["T_WHITESPACE"," ",2206],"=",["T_WHITESPACE"," ",2206],["T_NEW","new",2206],["T_WHITESPACE"," ",2206],["T_STRING","Math_BigInteger",2206],"(",["T_VARIABLE","$this",2206],["T_OBJECT_OPERATOR","->",2206],["T_STRING","_string_shift",2206],"(",["T_VARIABLE","$server_public_host_key",2206],",",["T_WHITESPACE"," ",2206],["T_VARIABLE","$temp",2206],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2206],"]",")",",",["T_WHITESPACE"," ",2206],"-",["T_LNUMBER","256",2206],")",";",["T_WHITESPACE","\n\n                ",2206],["T_VARIABLE","$temp",2208],["T_WHITESPACE"," ",2208],"=",["T_WHITESPACE"," ",2208],["T_STRING","unpack",2208],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2208],",",["T_WHITESPACE"," ",2208],["T_VARIABLE","$this",2208],["T_OBJECT_OPERATOR","->",2208],["T_STRING","_string_shift",2208],"(",["T_VARIABLE","$server_public_host_key",2208],",",["T_WHITESPACE"," ",2208],["T_LNUMBER","4",2208],")",")",";",["T_WHITESPACE","\n                ",2208],["T_VARIABLE","$y",2209],["T_WHITESPACE"," ",2209],"=",["T_WHITESPACE"," ",2209],["T_NEW","new",2209],["T_WHITESPACE"," ",2209],["T_STRING","Math_BigInteger",2209],"(",["T_VARIABLE","$this",2209],["T_OBJECT_OPERATOR","->",2209],["T_STRING","_string_shift",2209],"(",["T_VARIABLE","$server_public_host_key",2209],",",["T_WHITESPACE"," ",2209],["T_VARIABLE","$temp",2209],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2209],"]",")",",",["T_WHITESPACE"," ",2209],"-",["T_LNUMBER","256",2209],")",";",["T_WHITESPACE","\n\n                ",2209],["T_COMMENT","\/* The value for 'dss_signature_blob' is encoded as a string containing\n                   r, followed by s (which are 160-bit integers, without lengths or\n                   padding, unsigned, and in network byte order). *\/",2211],["T_WHITESPACE","\n                ",2213],["T_VARIABLE","$temp",2214],["T_WHITESPACE"," ",2214],"=",["T_WHITESPACE"," ",2214],["T_STRING","unpack",2214],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2214],",",["T_WHITESPACE"," ",2214],["T_VARIABLE","$this",2214],["T_OBJECT_OPERATOR","->",2214],["T_STRING","_string_shift",2214],"(",["T_VARIABLE","$signature",2214],",",["T_WHITESPACE"," ",2214],["T_LNUMBER","4",2214],")",")",";",["T_WHITESPACE","\n                ",2214],["T_IF","if",2215],["T_WHITESPACE"," ",2215],"(",["T_VARIABLE","$temp",2215],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2215],"]",["T_WHITESPACE"," ",2215],["T_IS_NOT_EQUAL","!=",2215],["T_WHITESPACE"," ",2215],["T_LNUMBER","40",2215],")",["T_WHITESPACE"," ",2215],"{",["T_WHITESPACE","\n                    ",2215],["T_STRING","user_error",2216],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",2216],",",["T_WHITESPACE"," ",2216],["T_STRING","E_USER_NOTICE",2216],")",";",["T_WHITESPACE","\n                    ",2216],["T_RETURN","return",2217],["T_WHITESPACE"," ",2217],["T_VARIABLE","$this",2217],["T_OBJECT_OPERATOR","->",2217],["T_STRING","_disconnect",2217],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",2217],")",";",["T_WHITESPACE","\n                ",2217],"}",["T_WHITESPACE","\n\n                ",2218],["T_VARIABLE","$r",2220],["T_WHITESPACE"," ",2220],"=",["T_WHITESPACE"," ",2220],["T_NEW","new",2220],["T_WHITESPACE"," ",2220],["T_STRING","Math_BigInteger",2220],"(",["T_VARIABLE","$this",2220],["T_OBJECT_OPERATOR","->",2220],["T_STRING","_string_shift",2220],"(",["T_VARIABLE","$signature",2220],",",["T_WHITESPACE"," ",2220],["T_LNUMBER","20",2220],")",",",["T_WHITESPACE"," ",2220],["T_LNUMBER","256",2220],")",";",["T_WHITESPACE","\n                ",2220],["T_VARIABLE","$s",2221],["T_WHITESPACE"," ",2221],"=",["T_WHITESPACE"," ",2221],["T_NEW","new",2221],["T_WHITESPACE"," ",2221],["T_STRING","Math_BigInteger",2221],"(",["T_VARIABLE","$this",2221],["T_OBJECT_OPERATOR","->",2221],["T_STRING","_string_shift",2221],"(",["T_VARIABLE","$signature",2221],",",["T_WHITESPACE"," ",2221],["T_LNUMBER","20",2221],")",",",["T_WHITESPACE"," ",2221],["T_LNUMBER","256",2221],")",";",["T_WHITESPACE","\n\n                ",2221],["T_IF","if",2223],["T_WHITESPACE"," ",2223],"(",["T_VARIABLE","$r",2223],["T_OBJECT_OPERATOR","->",2223],["T_STRING","compare",2223],"(",["T_VARIABLE","$q",2223],")",["T_WHITESPACE"," ",2223],["T_IS_GREATER_OR_EQUAL",">=",2223],["T_WHITESPACE"," ",2223],["T_LNUMBER","0",2223],["T_WHITESPACE"," ",2223],["T_BOOLEAN_OR","||",2223],["T_WHITESPACE"," ",2223],["T_VARIABLE","$s",2223],["T_OBJECT_OPERATOR","->",2223],["T_STRING","compare",2223],"(",["T_VARIABLE","$q",2223],")",["T_WHITESPACE"," ",2223],["T_IS_GREATER_OR_EQUAL",">=",2223],["T_WHITESPACE"," ",2223],["T_LNUMBER","0",2223],")",["T_WHITESPACE"," ",2223],"{",["T_WHITESPACE","\n                    ",2223],["T_STRING","user_error",2224],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",2224],",",["T_WHITESPACE"," ",2224],["T_STRING","E_USER_NOTICE",2224],")",";",["T_WHITESPACE","\n                    ",2224],["T_RETURN","return",2225],["T_WHITESPACE"," ",2225],["T_VARIABLE","$this",2225],["T_OBJECT_OPERATOR","->",2225],["T_STRING","_disconnect",2225],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",2225],")",";",["T_WHITESPACE","\n                ",2225],"}",["T_WHITESPACE","\n\n                ",2226],["T_VARIABLE","$w",2228],["T_WHITESPACE"," ",2228],"=",["T_WHITESPACE"," ",2228],["T_VARIABLE","$s",2228],["T_OBJECT_OPERATOR","->",2228],["T_STRING","modInverse",2228],"(",["T_VARIABLE","$q",2228],")",";",["T_WHITESPACE","\n\n                ",2228],["T_VARIABLE","$u1",2230],["T_WHITESPACE"," ",2230],"=",["T_WHITESPACE"," ",2230],["T_VARIABLE","$w",2230],["T_OBJECT_OPERATOR","->",2230],["T_STRING","multiply",2230],"(",["T_NEW","new",2230],["T_WHITESPACE"," ",2230],["T_STRING","Math_BigInteger",2230],"(",["T_STRING","sha1",2230],"(",["T_VARIABLE","$this",2230],["T_OBJECT_OPERATOR","->",2230],["T_STRING","session_id",2230],")",",",["T_WHITESPACE"," ",2230],["T_LNUMBER","16",2230],")",")",";",["T_WHITESPACE","\n                ",2230],["T_LIST","list",2231],"(",",",["T_WHITESPACE"," ",2231],["T_VARIABLE","$u1",2231],")",["T_WHITESPACE"," ",2231],"=",["T_WHITESPACE"," ",2231],["T_VARIABLE","$u1",2231],["T_OBJECT_OPERATOR","->",2231],["T_STRING","divide",2231],"(",["T_VARIABLE","$q",2231],")",";",["T_WHITESPACE","\n\n                ",2231],["T_VARIABLE","$u2",2233],["T_WHITESPACE"," ",2233],"=",["T_WHITESPACE"," ",2233],["T_VARIABLE","$w",2233],["T_OBJECT_OPERATOR","->",2233],["T_STRING","multiply",2233],"(",["T_VARIABLE","$r",2233],")",";",["T_WHITESPACE","\n                ",2233],["T_LIST","list",2234],"(",",",["T_WHITESPACE"," ",2234],["T_VARIABLE","$u2",2234],")",["T_WHITESPACE"," ",2234],"=",["T_WHITESPACE"," ",2234],["T_VARIABLE","$u2",2234],["T_OBJECT_OPERATOR","->",2234],["T_STRING","divide",2234],"(",["T_VARIABLE","$q",2234],")",";",["T_WHITESPACE","\n\n                ",2234],["T_VARIABLE","$g",2236],["T_WHITESPACE"," ",2236],"=",["T_WHITESPACE"," ",2236],["T_VARIABLE","$g",2236],["T_OBJECT_OPERATOR","->",2236],["T_STRING","modPow",2236],"(",["T_VARIABLE","$u1",2236],",",["T_WHITESPACE"," ",2236],["T_VARIABLE","$p",2236],")",";",["T_WHITESPACE","\n                ",2236],["T_VARIABLE","$y",2237],["T_WHITESPACE"," ",2237],"=",["T_WHITESPACE"," ",2237],["T_VARIABLE","$y",2237],["T_OBJECT_OPERATOR","->",2237],["T_STRING","modPow",2237],"(",["T_VARIABLE","$u2",2237],",",["T_WHITESPACE"," ",2237],["T_VARIABLE","$p",2237],")",";",["T_WHITESPACE","\n\n                ",2237],["T_VARIABLE","$v",2239],["T_WHITESPACE"," ",2239],"=",["T_WHITESPACE"," ",2239],["T_VARIABLE","$g",2239],["T_OBJECT_OPERATOR","->",2239],["T_STRING","multiply",2239],"(",["T_VARIABLE","$y",2239],")",";",["T_WHITESPACE","\n                ",2239],["T_LIST","list",2240],"(",",",["T_WHITESPACE"," ",2240],["T_VARIABLE","$v",2240],")",["T_WHITESPACE"," ",2240],"=",["T_WHITESPACE"," ",2240],["T_VARIABLE","$v",2240],["T_OBJECT_OPERATOR","->",2240],["T_STRING","divide",2240],"(",["T_VARIABLE","$p",2240],")",";",["T_WHITESPACE","\n                ",2240],["T_LIST","list",2241],"(",",",["T_WHITESPACE"," ",2241],["T_VARIABLE","$v",2241],")",["T_WHITESPACE"," ",2241],"=",["T_WHITESPACE"," ",2241],["T_VARIABLE","$v",2241],["T_OBJECT_OPERATOR","->",2241],["T_STRING","divide",2241],"(",["T_VARIABLE","$q",2241],")",";",["T_WHITESPACE","\n\n                ",2241],["T_IF","if",2243],["T_WHITESPACE"," ",2243],"(","!",["T_VARIABLE","$v",2243],["T_OBJECT_OPERATOR","->",2243],["T_STRING","equals",2243],"(",["T_VARIABLE","$r",2243],")",")",["T_WHITESPACE"," ",2243],"{",["T_WHITESPACE","\n                    ",2243],["T_STRING","user_error",2244],"(",["T_CONSTANT_ENCAPSED_STRING","'Bad server signature'",2244],",",["T_WHITESPACE"," ",2244],["T_STRING","E_USER_NOTICE",2244],")",";",["T_WHITESPACE","\n                    ",2244],["T_RETURN","return",2245],["T_WHITESPACE"," ",2245],["T_VARIABLE","$this",2245],["T_OBJECT_OPERATOR","->",2245],["T_STRING","_disconnect",2245],"(",["T_STRING","NET_SSH2_DISCONNECT_HOST_KEY_NOT_VERIFIABLE",2245],")",";",["T_WHITESPACE","\n                ",2245],"}",["T_WHITESPACE","\n\n                ",2246],["T_BREAK","break",2248],";",["T_WHITESPACE","\n            ",2248],["T_CASE","case",2249],["T_WHITESPACE"," ",2249],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",2249],":",["T_WHITESPACE","\n                ",2249],["T_VARIABLE","$temp",2250],["T_WHITESPACE"," ",2250],"=",["T_WHITESPACE"," ",2250],["T_STRING","unpack",2250],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2250],",",["T_WHITESPACE"," ",2250],["T_VARIABLE","$this",2250],["T_OBJECT_OPERATOR","->",2250],["T_STRING","_string_shift",2250],"(",["T_VARIABLE","$server_public_host_key",2250],",",["T_WHITESPACE"," ",2250],["T_LNUMBER","4",2250],")",")",";",["T_WHITESPACE","\n                ",2250],["T_VARIABLE","$e",2251],["T_WHITESPACE"," ",2251],"=",["T_WHITESPACE"," ",2251],["T_NEW","new",2251],["T_WHITESPACE"," ",2251],["T_STRING","Math_BigInteger",2251],"(",["T_VARIABLE","$this",2251],["T_OBJECT_OPERATOR","->",2251],["T_STRING","_string_shift",2251],"(",["T_VARIABLE","$server_public_host_key",2251],",",["T_WHITESPACE"," ",2251],["T_VARIABLE","$temp",2251],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2251],"]",")",",",["T_WHITESPACE"," ",2251],"-",["T_LNUMBER","256",2251],")",";",["T_WHITESPACE","\n\n                ",2251],["T_VARIABLE","$temp",2253],["T_WHITESPACE"," ",2253],"=",["T_WHITESPACE"," ",2253],["T_STRING","unpack",2253],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2253],",",["T_WHITESPACE"," ",2253],["T_VARIABLE","$this",2253],["T_OBJECT_OPERATOR","->",2253],["T_STRING","_string_shift",2253],"(",["T_VARIABLE","$server_public_host_key",2253],",",["T_WHITESPACE"," ",2253],["T_LNUMBER","4",2253],")",")",";",["T_WHITESPACE","\n                ",2253],["T_VARIABLE","$n",2254],["T_WHITESPACE"," ",2254],"=",["T_WHITESPACE"," ",2254],["T_NEW","new",2254],["T_WHITESPACE"," ",2254],["T_STRING","Math_BigInteger",2254],"(",["T_VARIABLE","$this",2254],["T_OBJECT_OPERATOR","->",2254],["T_STRING","_string_shift",2254],"(",["T_VARIABLE","$server_public_host_key",2254],",",["T_WHITESPACE"," ",2254],["T_VARIABLE","$temp",2254],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2254],"]",")",",",["T_WHITESPACE"," ",2254],"-",["T_LNUMBER","256",2254],")",";",["T_WHITESPACE","\n                ",2254],["T_VARIABLE","$nLength",2255],["T_WHITESPACE"," ",2255],"=",["T_WHITESPACE"," ",2255],["T_VARIABLE","$temp",2255],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2255],"]",";",["T_WHITESPACE","\n\n                ",2255],["T_COMMENT","\/*\n                $temp = unpack('Nlength', $this->_string_shift($signature, 4));\n                $signature = $this->_string_shift($signature, $temp['length']);\n\n                if (!class_exists('Crypt_RSA')) {\n                    require_once('Crypt\/RSA.php');\n                }\n\n                $rsa = new Crypt_RSA();\n                $rsa->setSignatureMode(CRYPT_RSA_SIGNATURE_PKCS1);\n                $rsa->loadKey(array('e' => $e, 'n' => $n), CRYPT_RSA_PUBLIC_FORMAT_RAW);\n                if (!$rsa->verify($this->session_id, $signature)) {\n                    user_error('Bad server signature', E_USER_NOTICE);\n                    return $this->_disconnect(NET_SSH2_DISCONNECT_HOST_KEY_NOT_VERIFIABLE);\n                }\n                *\/",2257],["T_WHITESPACE","\n\n                ",2272],["T_VARIABLE","$temp",2274],["T_WHITESPACE"," ",2274],"=",["T_WHITESPACE"," ",2274],["T_STRING","unpack",2274],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",2274],",",["T_WHITESPACE"," ",2274],["T_VARIABLE","$this",2274],["T_OBJECT_OPERATOR","->",2274],["T_STRING","_string_shift",2274],"(",["T_VARIABLE","$signature",2274],",",["T_WHITESPACE"," ",2274],["T_LNUMBER","4",2274],")",")",";",["T_WHITESPACE","\n                ",2274],["T_VARIABLE","$s",2275],["T_WHITESPACE"," ",2275],"=",["T_WHITESPACE"," ",2275],["T_NEW","new",2275],["T_WHITESPACE"," ",2275],["T_STRING","Math_BigInteger",2275],"(",["T_VARIABLE","$this",2275],["T_OBJECT_OPERATOR","->",2275],["T_STRING","_string_shift",2275],"(",["T_VARIABLE","$signature",2275],",",["T_WHITESPACE"," ",2275],["T_VARIABLE","$temp",2275],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",2275],"]",")",",",["T_WHITESPACE"," ",2275],["T_LNUMBER","256",2275],")",";",["T_WHITESPACE","\n\n                ",2275],["T_COMMENT","\/\/ validate an RSA signature per \"8.2 RSASSA-PKCS1-v1_5\", \"5.2.2 RSAVP1\", and \"9.1 EMSA-PSS\" in the\n",2277],["T_WHITESPACE","                ",2278],["T_COMMENT","\/\/ following URL:\n",2278],["T_WHITESPACE","                ",2279],["T_COMMENT","\/\/ ftp:\/\/ftp.rsasecurity.com\/pub\/pkcs\/pkcs-1\/pkcs-1v2-1.pdf\n",2279],["T_WHITESPACE","\n                ",2280],["T_COMMENT","\/\/ also, see SSHRSA.c (rsa2_verifysig) in PuTTy's source.\n",2281],["T_WHITESPACE","\n                ",2282],["T_IF","if",2283],["T_WHITESPACE"," ",2283],"(",["T_VARIABLE","$s",2283],["T_OBJECT_OPERATOR","->",2283],["T_STRING","compare",2283],"(",["T_NEW","new",2283],["T_WHITESPACE"," ",2283],["T_STRING","Math_BigInteger",2283],"(",")",")",["T_WHITESPACE"," ",2283],"<",["T_WHITESPACE"," ",2283],["T_LNUMBER","0",2283],["T_WHITESPACE"," ",2283],["T_BOOLEAN_OR","||",2283],["T_WHITESPACE"," ",2283],["T_VARIABLE","$s",2283],["T_OBJECT_OPERATOR","->",2283],["T_STRING","compare",2283],"(",["T_VARIABLE","$n",2283],["T_OBJECT_OPERATOR","->",2283],["T_STRING","subtract",2283],"(",["T_NEW","new",2283],["T_WHITESPACE"," ",2283],["T_STRING","Math_BigInteger",2283],"(",["T_LNUMBER","1",2283],")",")",")",["T_WHITESPACE"," ",2283],">",["T_WHITESPACE"," ",2283],["T_LNUMBER","0",2283],")",["T_WHITESPACE"," ",2283],"{",["T_WHITESPACE","\n                    ",2283],["T_STRING","user_error",2284],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",2284],",",["T_WHITESPACE"," ",2284],["T_STRING","E_USER_NOTICE",2284],")",";",["T_WHITESPACE","\n                    ",2284],["T_RETURN","return",2285],["T_WHITESPACE"," ",2285],["T_VARIABLE","$this",2285],["T_OBJECT_OPERATOR","->",2285],["T_STRING","_disconnect",2285],"(",["T_STRING","NET_SSH2_DISCONNECT_KEY_EXCHANGE_FAILED",2285],")",";",["T_WHITESPACE","\n                ",2285],"}",["T_WHITESPACE","\n\n                ",2286],["T_VARIABLE","$s",2288],["T_WHITESPACE"," ",2288],"=",["T_WHITESPACE"," ",2288],["T_VARIABLE","$s",2288],["T_OBJECT_OPERATOR","->",2288],["T_STRING","modPow",2288],"(",["T_VARIABLE","$e",2288],",",["T_WHITESPACE"," ",2288],["T_VARIABLE","$n",2288],")",";",["T_WHITESPACE","\n                ",2288],["T_VARIABLE","$s",2289],["T_WHITESPACE"," ",2289],"=",["T_WHITESPACE"," ",2289],["T_VARIABLE","$s",2289],["T_OBJECT_OPERATOR","->",2289],["T_STRING","toBytes",2289],"(",")",";",["T_WHITESPACE","\n\n                ",2289],["T_VARIABLE","$h",2291],["T_WHITESPACE"," ",2291],"=",["T_WHITESPACE"," ",2291],["T_STRING","pack",2291],"(",["T_CONSTANT_ENCAPSED_STRING","'N4H*'",2291],",",["T_WHITESPACE"," ",2291],["T_LNUMBER","0x00302130",2291],",",["T_WHITESPACE"," ",2291],["T_LNUMBER","0x0906052B",2291],",",["T_WHITESPACE"," ",2291],["T_LNUMBER","0x0E03021A",2291],",",["T_WHITESPACE"," ",2291],["T_LNUMBER","0x05000414",2291],",",["T_WHITESPACE"," ",2291],["T_STRING","sha1",2291],"(",["T_VARIABLE","$this",2291],["T_OBJECT_OPERATOR","->",2291],["T_STRING","session_id",2291],")",")",";",["T_WHITESPACE","\n                ",2291],["T_VARIABLE","$h",2292],["T_WHITESPACE"," ",2292],"=",["T_WHITESPACE"," ",2292],["T_STRING","chr",2292],"(",["T_LNUMBER","0x01",2292],")",["T_WHITESPACE"," ",2292],".",["T_WHITESPACE"," ",2292],["T_STRING","str_repeat",2292],"(",["T_STRING","chr",2292],"(",["T_LNUMBER","0xFF",2292],")",",",["T_WHITESPACE"," ",2292],["T_VARIABLE","$nLength",2292],["T_WHITESPACE"," ",2292],"-",["T_WHITESPACE"," ",2292],["T_LNUMBER","3",2292],["T_WHITESPACE"," ",2292],"-",["T_WHITESPACE"," ",2292],["T_STRING","strlen",2292],"(",["T_VARIABLE","$h",2292],")",")",["T_WHITESPACE"," ",2292],".",["T_WHITESPACE"," ",2292],["T_VARIABLE","$h",2292],";",["T_WHITESPACE","\n\n                ",2292],["T_IF","if",2294],["T_WHITESPACE"," ",2294],"(",["T_VARIABLE","$s",2294],["T_WHITESPACE"," ",2294],["T_IS_NOT_EQUAL","!=",2294],["T_WHITESPACE"," ",2294],["T_VARIABLE","$h",2294],")",["T_WHITESPACE"," ",2294],"{",["T_WHITESPACE","\n                    ",2294],["T_STRING","user_error",2295],"(",["T_CONSTANT_ENCAPSED_STRING","'Bad server signature'",2295],",",["T_WHITESPACE"," ",2295],["T_STRING","E_USER_NOTICE",2295],")",";",["T_WHITESPACE","\n                    ",2295],["T_RETURN","return",2296],["T_WHITESPACE"," ",2296],["T_VARIABLE","$this",2296],["T_OBJECT_OPERATOR","->",2296],["T_STRING","_disconnect",2296],"(",["T_STRING","NET_SSH2_DISCONNECT_HOST_KEY_NOT_VERIFIABLE",2296],")",";",["T_WHITESPACE","\n                ",2296],"}",["T_WHITESPACE","\n        ",2297],"}",["T_WHITESPACE","\n\n        ",2298],["T_RETURN","return",2300],["T_WHITESPACE"," ",2300],["T_VARIABLE","$this",2300],["T_OBJECT_OPERATOR","->",2300],["T_STRING","server_public_host_key",2300],";",["T_WHITESPACE","\n    ",2300],"}",["T_WHITESPACE","\n",2301],"}",["T_WHITESPACE","\n",2302]]