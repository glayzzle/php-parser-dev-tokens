[["T_OPEN_TAG","<?php\n",1],["T_COMMENT","\/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: *\/",2],["T_WHITESPACE","\n\n",2],["T_DOC_COMMENT","\/**\n * Pure-PHP implementation of Triple DES.\n *\n * Uses mcrypt, if available, and an internal implementation, otherwise.  Operates in the EDE3 mode (encrypt-decrypt-encrypt).\n *\n * PHP versions 4 and 5\n *\n * Here's a short example of how to use this library:\n * <code>\n * <?php\n *    include('Crypt\/TripleDES.php');\n *\n *    $des = new Crypt_TripleDES();\n *\n *    $des->setKey('abcdefghijklmnopqrstuvwx');\n *\n *    $size = 10 * 1024;\n *    $plaintext = '';\n *    for ($i = 0; $i < $size; $i++) {\n *        $plaintext.= 'a';\n *    }\n *\n *    echo $des->decrypt($des->encrypt($plaintext));\n * ?>\n * <\/code>\n *\n * LICENSE: This library is free software; you can redistribute it and\/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place, Suite 330, Boston,\n * MA  02111-1307  USA\n *\n * @category   Crypt\n * @package    Crypt_TripleDES\n * @author     Jim Wigginton <terrafrost@php.net>\n * @copyright  MMVII Jim Wigginton\n * @license    http:\/\/www.gnu.org\/licenses\/lgpl.txt\n * @version    $Id: TripleDES.php,v 1.13 2010\/02\/26 03:40:25 terrafrost Exp $\n * @link       http:\/\/phpseclib.sourceforge.net\n *\/",4],["T_WHITESPACE","\n\n",52],["T_DOC_COMMENT","\/**\n * Include Crypt_DES\n *\/",54],["T_WHITESPACE","\n",56],["T_REQUIRE_ONCE","require_once",57],["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'DES.php'",57],";",["T_WHITESPACE","\n\n",57],["T_DOC_COMMENT","\/**\n * Encrypt \/ decrypt using inner chaining\n *\n * Inner chaining is used by SSH-1 and is generally considered to be less secure then outer chaining (CRYPT_DES_MODE_CBC3).\n *\/",59],["T_WHITESPACE","\n",63],["T_STRING","define",64],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_DES_MODE_3CBC'",64],",",["T_WHITESPACE"," ",64],["T_LNUMBER","3",64],")",";",["T_WHITESPACE","\n\n",64],["T_DOC_COMMENT","\/**\n * Encrypt \/ decrypt using outer chaining\n *\n * Outer chaining is used by SSH-2 and when the mode is set to CRYPT_DES_MODE_CBC.\n *\/",66],["T_WHITESPACE","\n",70],["T_STRING","define",71],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_DES_MODE_CBC3'",71],",",["T_WHITESPACE"," ",71],["T_STRING","CRYPT_DES_MODE_CBC",71],")",";",["T_WHITESPACE","\n\n",71],["T_DOC_COMMENT","\/**\n * Pure-PHP implementation of Triple DES.\n *\n * @author  Jim Wigginton <terrafrost@php.net>\n * @version 0.1.0\n * @access  public\n * @package Crypt_TerraDES\n *\/",73],["T_WHITESPACE","\n",80],["T_CLASS","class",81],["T_WHITESPACE"," ",81],["T_STRING","Crypt_TripleDES",81],["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n    ",81],["T_DOC_COMMENT","\/**\n     * The Three Keys\n     *\n     * @see Crypt_TripleDES::setKey()\n     * @var String\n     * @access private\n     *\/",82],["T_WHITESPACE","\n    ",88],["T_VAR","var",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$key",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\\0\\0\\0\\0\"",89],";",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * The Encryption Mode\n     *\n     * @see Crypt_TripleDES::Crypt_TripleDES()\n     * @var Integer\n     * @access private\n     *\/",91],["T_WHITESPACE","\n    ",97],["T_VAR","var",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$mode",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","CRYPT_DES_MODE_CBC",98],";",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Continuous Buffer status\n     *\n     * @see Crypt_TripleDES::enableContinuousBuffer()\n     * @var Boolean\n     * @access private\n     *\/",100],["T_WHITESPACE","\n    ",106],["T_VAR","var",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$continuousBuffer",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","false",107],";",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Padding status\n     *\n     * @see Crypt_TripleDES::enablePadding()\n     * @var Boolean\n     * @access private\n     *\/",109],["T_WHITESPACE","\n    ",115],["T_VAR","var",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$padding",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","true",116],";",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * The Initialization Vector\n     *\n     * @see Crypt_TripleDES::setIV()\n     * @var String\n     * @access private\n     *\/",118],["T_WHITESPACE","\n    ",124],["T_VAR","var",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$iv",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\\0\\0\\0\\0\"",125],";",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * A \"sliding\" Initialization Vector\n     *\n     * @see Crypt_TripleDES::enableContinuousBuffer()\n     * @var String\n     * @access private\n     *\/",127],["T_WHITESPACE","\n    ",133],["T_VAR","var",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$encryptIV",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\\0\\0\\0\\0\"",134],";",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * A \"sliding\" Initialization Vector\n     *\n     * @see Crypt_TripleDES::enableContinuousBuffer()\n     * @var String\n     * @access private\n     *\/",136],["T_WHITESPACE","\n    ",142],["T_VAR","var",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$decryptIV",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\\0\\0\\0\\0\"",143],";",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * The Crypt_DES objects\n     *\n     * @var Array\n     * @access private\n     *\/",145],["T_WHITESPACE","\n    ",150],["T_VAR","var",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$des",151],";",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * mcrypt resource for encryption\n     *\n     * The mcrypt resource can be recreated every time something needs to be created or it can be created just once.\n     * Since mcrypt operates in continuous mode, by default, it'll need to be recreated when in non-continuous mode.\n     *\n     * @see Crypt_AES::encrypt()\n     * @var String\n     * @access private\n     *\/",153],["T_WHITESPACE","\n    ",162],["T_VAR","var",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$enmcrypt",163],";",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * mcrypt resource for decryption\n     *\n     * The mcrypt resource can be recreated every time something needs to be created or it can be created just once.\n     * Since mcrypt operates in continuous mode, by default, it'll need to be recreated when in non-continuous mode.\n     *\n     * @see Crypt_AES::decrypt()\n     * @var String\n     * @access private\n     *\/",165],["T_WHITESPACE","\n    ",174],["T_VAR","var",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$demcrypt",175],";",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Does the (en|de)mcrypt resource need to be (re)initialized?\n     *\n     * @see setKey()\n     * @see setIV()\n     * @var Boolean\n     * @access private\n     *\/",177],["T_WHITESPACE","\n    ",184],["T_VAR","var",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$changed",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","true",185],";",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Default Constructor.\n     *\n     * Determines whether or not the mcrypt extension should be used.  $mode should only, at present, be\n     * CRYPT_DES_MODE_ECB or CRYPT_DES_MODE_CBC.  If not explictly set, CRYPT_DES_MODE_CBC will be used.\n     *\n     * @param optional Integer $mode\n     * @return Crypt_TripleDES\n     * @access public\n     *\/",187],["T_WHITESPACE","\n    ",196],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","Crypt_TripleDES",197],"(",["T_VARIABLE","$mode",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_STRING","CRYPT_DES_MODE_CBC",197],")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_WHITESPACE"," ",199],"!",["T_STRING","defined",199],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_DES_MODE'",199],")",["T_WHITESPACE"," ",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_SWITCH","switch",200],["T_WHITESPACE"," ",200],"(",["T_STRING","true",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_CASE","case",201],["T_WHITESPACE"," ",201],["T_STRING","extension_loaded",201],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",201],")",":",["T_WHITESPACE","\n                    ",201],["T_COMMENT","\/\/ i'd check to see if des was supported, by doing in_array('des', mcrypt_list_algorithms('')),\n",202],["T_WHITESPACE","                    ",203],["T_COMMENT","\/\/ but since that can be changed after the object has been created, there doesn't seem to be\n",203],["T_WHITESPACE","                    ",204],["T_COMMENT","\/\/ a lot of point...\n",204],["T_WHITESPACE","                    ",205],["T_STRING","define",205],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_DES_MODE'",205],",",["T_WHITESPACE"," ",205],["T_STRING","CRYPT_DES_MODE_MCRYPT",205],")",";",["T_WHITESPACE","\n                    ",205],["T_BREAK","break",206],";",["T_WHITESPACE","\n                ",206],["T_DEFAULT","default",207],":",["T_WHITESPACE","\n                    ",207],["T_STRING","define",208],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_DES_MODE'",208],",",["T_WHITESPACE"," ",208],["T_STRING","CRYPT_DES_MODE_INTERNAL",208],")",";",["T_WHITESPACE","\n            ",208],"}",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n\n        ",210],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_WHITESPACE"," ",212],["T_VARIABLE","$mode",212],["T_WHITESPACE"," ",212],["T_IS_EQUAL","==",212],["T_WHITESPACE"," ",212],["T_STRING","CRYPT_DES_MODE_3CBC",212],["T_WHITESPACE"," ",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","mode",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","CRYPT_DES_MODE_3CBC",213],";",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","des",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_ARRAY","array",214],"(",["T_WHITESPACE","\n                ",214],["T_NEW","new",215],["T_WHITESPACE"," ",215],["T_STRING","Crypt_DES",215],"(",["T_STRING","CRYPT_DES_MODE_CBC",215],")",",",["T_WHITESPACE","\n                ",215],["T_NEW","new",216],["T_WHITESPACE"," ",216],["T_STRING","Crypt_DES",216],"(",["T_STRING","CRYPT_DES_MODE_CBC",216],")",",",["T_WHITESPACE","\n                ",216],["T_NEW","new",217],["T_WHITESPACE"," ",217],["T_STRING","Crypt_DES",217],"(",["T_STRING","CRYPT_DES_MODE_CBC",217],")",["T_WHITESPACE","\n            ",217],")",";",["T_WHITESPACE","\n\n            ",218],["T_COMMENT","\/\/ we're going to be doing the padding, ourselves, so disable it in the Crypt_DES objects\n",220],["T_WHITESPACE","            ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","des",221],"[",["T_LNUMBER","0",221],"]",["T_OBJECT_OPERATOR","->",221],["T_STRING","disablePadding",221],"(",")",";",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","des",222],"[",["T_LNUMBER","1",222],"]",["T_OBJECT_OPERATOR","->",222],["T_STRING","disablePadding",222],"(",")",";",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","des",223],"[",["T_LNUMBER","2",223],"]",["T_OBJECT_OPERATOR","->",223],["T_STRING","disablePadding",223],"(",")",";",["T_WHITESPACE","\n\n            ",223],["T_RETURN","return",225],";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n\n        ",226],["T_SWITCH","switch",228],["T_WHITESPACE"," ",228],"(",["T_WHITESPACE"," ",228],["T_STRING","CRYPT_DES_MODE",228],["T_WHITESPACE"," ",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_CASE","case",229],["T_WHITESPACE"," ",229],["T_STRING","CRYPT_DES_MODE_MCRYPT",229],":",["T_WHITESPACE","\n                ",229],["T_SWITCH","switch",230],["T_WHITESPACE"," ",230],"(",["T_VARIABLE","$mode",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                    ",230],["T_CASE","case",231],["T_WHITESPACE"," ",231],["T_STRING","CRYPT_DES_MODE_ECB",231],":",["T_WHITESPACE","\n                        ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","mode",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_STRING","MCRYPT_MODE_ECB",232],";",["T_WHITESPACE","\n                        ",232],["T_BREAK","break",233],";",["T_WHITESPACE","\n                    ",233],["T_CASE","case",234],["T_WHITESPACE"," ",234],["T_STRING","CRYPT_DES_MODE_CTR",234],":",["T_WHITESPACE","\n                        ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","mode",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'ctr'",235],";",["T_WHITESPACE","\n                        ",235],["T_BREAK","break",236],";",["T_WHITESPACE","\n                    ",236],["T_CASE","case",237],["T_WHITESPACE"," ",237],["T_STRING","CRYPT_DES_MODE_CBC",237],":",["T_WHITESPACE","\n                    ",237],["T_DEFAULT","default",238],":",["T_WHITESPACE","\n                        ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","mode",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","MCRYPT_MODE_CBC",239],";",["T_WHITESPACE","\n                ",239],"}",["T_WHITESPACE","\n\n                ",240],["T_BREAK","break",242],";",["T_WHITESPACE","\n            ",242],["T_DEFAULT","default",243],":",["T_WHITESPACE","\n                ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","des",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",["T_WHITESPACE","\n                    ",244],["T_NEW","new",245],["T_WHITESPACE"," ",245],["T_STRING","Crypt_DES",245],"(",["T_STRING","CRYPT_DES_MODE_ECB",245],")",",",["T_WHITESPACE","\n                    ",245],["T_NEW","new",246],["T_WHITESPACE"," ",246],["T_STRING","Crypt_DES",246],"(",["T_STRING","CRYPT_DES_MODE_ECB",246],")",",",["T_WHITESPACE","\n                    ",246],["T_NEW","new",247],["T_WHITESPACE"," ",247],["T_STRING","Crypt_DES",247],"(",["T_STRING","CRYPT_DES_MODE_ECB",247],")",["T_WHITESPACE","\n                ",247],")",";",["T_WHITESPACE","\n \n                ",248],["T_COMMENT","\/\/ we're going to be doing the padding, ourselves, so disable it in the Crypt_DES objects\n",250],["T_WHITESPACE","                ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","des",251],"[",["T_LNUMBER","0",251],"]",["T_OBJECT_OPERATOR","->",251],["T_STRING","disablePadding",251],"(",")",";",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","des",252],"[",["T_LNUMBER","1",252],"]",["T_OBJECT_OPERATOR","->",252],["T_STRING","disablePadding",252],"(",")",";",["T_WHITESPACE","\n                ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","des",253],"[",["T_LNUMBER","2",253],"]",["T_OBJECT_OPERATOR","->",253],["T_STRING","disablePadding",253],"(",")",";",["T_WHITESPACE","\n\n                ",253],["T_SWITCH","switch",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$mode",255],")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n                    ",255],["T_CASE","case",256],["T_WHITESPACE"," ",256],["T_STRING","CRYPT_DES_MODE_ECB",256],":",["T_WHITESPACE","\n                    ",256],["T_CASE","case",257],["T_WHITESPACE"," ",257],["T_STRING","CRYPT_DES_MODE_CTR",257],":",["T_WHITESPACE","\n                    ",257],["T_CASE","case",258],["T_WHITESPACE"," ",258],["T_STRING","CRYPT_DES_MODE_CBC",258],":",["T_WHITESPACE","\n                        ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","mode",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$mode",259],";",["T_WHITESPACE","\n                        ",259],["T_BREAK","break",260],";",["T_WHITESPACE","\n                    ",260],["T_DEFAULT","default",261],":",["T_WHITESPACE","\n                        ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","mode",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_STRING","CRYPT_DES_MODE_CBC",262],";",["T_WHITESPACE","\n                ",262],"}",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Sets the key.\n     *\n     * Keys can be of any length.  Triple DES, itself, can use 128-bit (eg. strlen($key) == 16) or\n     * 192-bit (eg. strlen($key) == 24) keys.  This function pads and truncates $key as appropriate.\n     *\n     * DES also requires that every eighth bit be a parity bit, however, we'll ignore that.\n     *\n     * If the key is not explicitly set, it'll be assumed to be all zero's.\n     *\n     * @access public\n     * @param String $key\n     *\/",267],["T_WHITESPACE","\n    ",279],["T_FUNCTION","function",280],["T_WHITESPACE"," ",280],["T_STRING","setKey",280],"(",["T_VARIABLE","$key",280],")",["T_WHITESPACE","\n    ",280],"{",["T_WHITESPACE","\n        ",281],["T_VARIABLE","$length",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","strlen",282],"(",["T_VARIABLE","$key",282],")",";",["T_WHITESPACE","\n        ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_VARIABLE","$length",283],["T_WHITESPACE"," ",283],">",["T_WHITESPACE"," ",283],["T_LNUMBER","8",283],")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$key",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_STRING","str_pad",284],"(",["T_VARIABLE","$key",284],",",["T_WHITESPACE"," ",284],["T_LNUMBER","24",284],",",["T_WHITESPACE"," ",284],["T_STRING","chr",284],"(",["T_LNUMBER","0",284],")",")",";",["T_WHITESPACE","\n            ",284],["T_COMMENT","\/\/ if $key is between 64 and 128-bits, use the first 64-bits as the last, per this:\n",285],["T_WHITESPACE","            ",286],["T_COMMENT","\/\/ http:\/\/php.net\/function.mcrypt-encrypt#47973\n",286],["T_WHITESPACE","            ",287],["T_COMMENT","\/\/$key = $length <= 16 ? substr_replace($key, substr($key, 0, 8), 16) : substr($key, 0, 24);\n",287],["T_WHITESPACE","        ",288],"}",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","key",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$key",289],";",["T_WHITESPACE","\n        ",289],["T_SWITCH","switch",290],["T_WHITESPACE"," ",290],"(",["T_STRING","true",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n            ",290],["T_CASE","case",291],["T_WHITESPACE"," ",291],["T_STRING","CRYPT_DES_MODE",291],["T_WHITESPACE"," ",291],["T_IS_EQUAL","==",291],["T_WHITESPACE"," ",291],["T_STRING","CRYPT_DES_MODE_INTERNAL",291],":",["T_WHITESPACE","\n            ",291],["T_CASE","case",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","mode",292],["T_WHITESPACE"," ",292],["T_IS_EQUAL","==",292],["T_WHITESPACE"," ",292],["T_STRING","CRYPT_DES_MODE_3CBC",292],":",["T_WHITESPACE","\n                ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","des",293],"[",["T_LNUMBER","0",293],"]",["T_OBJECT_OPERATOR","->",293],["T_STRING","setKey",293],"(",["T_STRING","substr",293],"(",["T_VARIABLE","$key",293],",",["T_WHITESPACE","  ",293],["T_LNUMBER","0",293],",",["T_WHITESPACE"," ",293],["T_LNUMBER","8",293],")",")",";",["T_WHITESPACE","\n                ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","des",294],"[",["T_LNUMBER","1",294],"]",["T_OBJECT_OPERATOR","->",294],["T_STRING","setKey",294],"(",["T_STRING","substr",294],"(",["T_VARIABLE","$key",294],",",["T_WHITESPACE","  ",294],["T_LNUMBER","8",294],",",["T_WHITESPACE"," ",294],["T_LNUMBER","8",294],")",")",";",["T_WHITESPACE","\n                ",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","des",295],"[",["T_LNUMBER","2",295],"]",["T_OBJECT_OPERATOR","->",295],["T_STRING","setKey",295],"(",["T_STRING","substr",295],"(",["T_VARIABLE","$key",295],",",["T_WHITESPACE"," ",295],["T_LNUMBER","16",295],",",["T_WHITESPACE"," ",295],["T_LNUMBER","8",295],")",")",";",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n        ",296],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","changed",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","true",297],";",["T_WHITESPACE","\n    ",297],"}",["T_WHITESPACE","\n\n    ",298],["T_DOC_COMMENT","\/**\n     * Sets the initialization vector. (optional)\n     *\n     * SetIV is not required when CRYPT_DES_MODE_ECB is being used.  If not explictly set, it'll be assumed\n     * to be all zero's.\n     *\n     * @access public\n     * @param String $iv\n     *\/",300],["T_WHITESPACE","\n    ",308],["T_FUNCTION","function",309],["T_WHITESPACE"," ",309],["T_STRING","setIV",309],"(",["T_VARIABLE","$iv",309],")",["T_WHITESPACE","\n    ",309],"{",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","encryptIV",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","decryptIV",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","iv",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_STRING","str_pad",311],"(",["T_STRING","substr",311],"(",["T_VARIABLE","$iv",311],",",["T_WHITESPACE"," ",311],["T_LNUMBER","0",311],",",["T_WHITESPACE"," ",311],["T_LNUMBER","8",311],")",",",["T_WHITESPACE"," ",311],["T_LNUMBER","8",311],",",["T_WHITESPACE"," ",311],["T_STRING","chr",311],"(",["T_LNUMBER","0",311],")",")",";",["T_WHITESPACE","\n        ",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","mode",312],["T_WHITESPACE"," ",312],["T_IS_EQUAL","==",312],["T_WHITESPACE"," ",312],["T_STRING","CRYPT_DES_MODE_3CBC",312],")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n            ",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","des",313],"[",["T_LNUMBER","0",313],"]",["T_OBJECT_OPERATOR","->",313],["T_STRING","setIV",313],"(",["T_VARIABLE","$iv",313],")",";",["T_WHITESPACE","\n            ",313],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","des",314],"[",["T_LNUMBER","1",314],"]",["T_OBJECT_OPERATOR","->",314],["T_STRING","setIV",314],"(",["T_VARIABLE","$iv",314],")",";",["T_WHITESPACE","\n            ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","des",315],"[",["T_LNUMBER","2",315],"]",["T_OBJECT_OPERATOR","->",315],["T_STRING","setIV",315],"(",["T_VARIABLE","$iv",315],")",";",["T_WHITESPACE","\n        ",315],"}",["T_WHITESPACE","\n        ",316],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","changed",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","true",317],";",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n\n    ",318],["T_DOC_COMMENT","\/**\n     * Generate CTR XOR encryption key\n     *\n     * Encrypt the output of this and XOR it against the ciphertext \/ plaintext to get the\n     * plaintext \/ ciphertext in CTR mode.\n     *\n     * @see Crypt_DES::decrypt()\n     * @see Crypt_DES::encrypt()\n     * @access public\n     * @param Integer $length\n     * @param String $iv\n     *\/",320],["T_WHITESPACE","\n    ",331],["T_FUNCTION","function",332],["T_WHITESPACE"," ",332],["T_STRING","_generate_xor",332],"(",["T_VARIABLE","$length",332],",",["T_WHITESPACE"," ",332],"&",["T_VARIABLE","$iv",332],")",["T_WHITESPACE","\n    ",332],"{",["T_WHITESPACE","\n        ",333],["T_VARIABLE","$xor",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","''",334],";",["T_WHITESPACE","\n        ",334],["T_VARIABLE","$num_blocks",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],"(",["T_VARIABLE","$length",335],["T_WHITESPACE"," ",335],"+",["T_WHITESPACE"," ",335],["T_LNUMBER","7",335],")",["T_WHITESPACE"," ",335],["T_SR",">>",335],["T_WHITESPACE"," ",335],["T_LNUMBER","3",335],";",["T_WHITESPACE","\n        ",335],["T_FOR","for",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$i",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_LNUMBER","0",336],";",["T_WHITESPACE"," ",336],["T_VARIABLE","$i",336],["T_WHITESPACE"," ",336],"<",["T_WHITESPACE"," ",336],["T_VARIABLE","$num_blocks",336],";",["T_WHITESPACE"," ",336],["T_VARIABLE","$i",336],["T_INC","++",336],")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n            ",336],["T_VARIABLE","$xor",337],["T_CONCAT_EQUAL",".=",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$iv",337],";",["T_WHITESPACE","\n            ",337],["T_FOR","for",338],["T_WHITESPACE"," ",338],"(",["T_VARIABLE","$j",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_LNUMBER","4",338],";",["T_WHITESPACE"," ",338],["T_VARIABLE","$j",338],["T_WHITESPACE"," ",338],["T_IS_SMALLER_OR_EQUAL","<=",338],["T_WHITESPACE"," ",338],["T_LNUMBER","8",338],";",["T_WHITESPACE"," ",338],["T_VARIABLE","$j",338],["T_PLUS_EQUAL","+=",338],["T_LNUMBER","4",338],")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n                ",338],["T_VARIABLE","$temp",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","substr",339],"(",["T_VARIABLE","$iv",339],",",["T_WHITESPACE"," ",339],"-",["T_VARIABLE","$j",339],",",["T_WHITESPACE"," ",339],["T_LNUMBER","4",339],")",";",["T_WHITESPACE","\n                ",339],["T_SWITCH","switch",340],["T_WHITESPACE"," ",340],"(",["T_VARIABLE","$temp",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n                    ",340],["T_CASE","case",341],["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","\"\\xFF\\xFF\\xFF\\xFF\"",341],":",["T_WHITESPACE","\n                        ",341],["T_VARIABLE","$iv",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","substr_replace",342],"(",["T_VARIABLE","$iv",342],",",["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","\"\\x00\\x00\\x00\\x00\"",342],",",["T_WHITESPACE"," ",342],"-",["T_VARIABLE","$j",342],",",["T_WHITESPACE"," ",342],["T_LNUMBER","4",342],")",";",["T_WHITESPACE","\n                        ",342],["T_BREAK","break",343],";",["T_WHITESPACE","\n                    ",343],["T_CASE","case",344],["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","\"\\x7F\\xFF\\xFF\\xFF\"",344],":",["T_WHITESPACE","\n                        ",344],["T_VARIABLE","$iv",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_STRING","substr_replace",345],"(",["T_VARIABLE","$iv",345],",",["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","\"\\x80\\x00\\x00\\x00\"",345],",",["T_WHITESPACE"," ",345],"-",["T_VARIABLE","$j",345],",",["T_WHITESPACE"," ",345],["T_LNUMBER","4",345],")",";",["T_WHITESPACE","\n                        ",345],["T_BREAK","break",346],["T_WHITESPACE"," ",346],["T_LNUMBER","2",346],";",["T_WHITESPACE","\n                    ",346],["T_DEFAULT","default",347],":",["T_WHITESPACE","\n                        ",347],["T_STRING","extract",348],"(",["T_STRING","unpack",348],"(",["T_CONSTANT_ENCAPSED_STRING","'Ncount'",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$temp",348],")",")",";",["T_WHITESPACE","\n                        ",348],["T_VARIABLE","$iv",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_STRING","substr_replace",349],"(",["T_VARIABLE","$iv",349],",",["T_WHITESPACE"," ",349],["T_STRING","pack",349],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",349],",",["T_WHITESPACE"," ",349],["T_VARIABLE","$count",349],["T_WHITESPACE"," ",349],"+",["T_WHITESPACE"," ",349],["T_LNUMBER","1",349],")",",",["T_WHITESPACE"," ",349],"-",["T_VARIABLE","$j",349],",",["T_WHITESPACE"," ",349],["T_LNUMBER","4",349],")",";",["T_WHITESPACE","\n                        ",349],["T_BREAK","break",350],["T_WHITESPACE"," ",350],["T_LNUMBER","2",350],";",["T_WHITESPACE","\n                ",350],"}",["T_WHITESPACE","\n            ",351],"}",["T_WHITESPACE","\n        ",352],"}",["T_WHITESPACE","\n\n        ",353],["T_RETURN","return",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$xor",355],";",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n\n    ",356],["T_DOC_COMMENT","\/**\n     * Encrypts a message.\n     *\n     * @access public\n     * @param String $plaintext\n     *\/",358],["T_WHITESPACE","\n    ",363],["T_FUNCTION","function",364],["T_WHITESPACE"," ",364],["T_STRING","encrypt",364],"(",["T_VARIABLE","$plaintext",364],")",["T_WHITESPACE","\n    ",364],"{",["T_WHITESPACE","\n        ",365],["T_IF","if",366],["T_WHITESPACE"," ",366],"(",["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","mode",366],["T_WHITESPACE"," ",366],["T_IS_NOT_EQUAL","!=",366],["T_WHITESPACE"," ",366],["T_STRING","CRYPT_DES_MODE_CTR",366],["T_WHITESPACE"," ",366],["T_BOOLEAN_AND","&&",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","mode",366],["T_WHITESPACE"," ",366],["T_IS_NOT_EQUAL","!=",366],["T_WHITESPACE"," ",366],["T_CONSTANT_ENCAPSED_STRING","'ctr'",366],")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$plaintext",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_pad",367],"(",["T_VARIABLE","$plaintext",367],")",";",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE","\n\n        ",368],["T_COMMENT","\/\/ if the key is smaller then 8, do what we'd normally do\n",370],["T_WHITESPACE","        ",371],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","mode",371],["T_WHITESPACE"," ",371],["T_IS_EQUAL","==",371],["T_WHITESPACE"," ",371],["T_STRING","CRYPT_DES_MODE_3CBC",371],["T_WHITESPACE"," ",371],["T_BOOLEAN_AND","&&",371],["T_WHITESPACE"," ",371],["T_STRING","strlen",371],"(",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","key",371],")",["T_WHITESPACE"," ",371],">",["T_WHITESPACE"," ",371],["T_LNUMBER","8",371],")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n            ",371],["T_VARIABLE","$ciphertext",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","des",372],"[",["T_LNUMBER","2",372],"]",["T_OBJECT_OPERATOR","->",372],["T_STRING","encrypt",372],"(",["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","des",372],"[",["T_LNUMBER","1",372],"]",["T_OBJECT_OPERATOR","->",372],["T_STRING","decrypt",372],"(",["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","des",372],"[",["T_LNUMBER","0",372],"]",["T_OBJECT_OPERATOR","->",372],["T_STRING","encrypt",372],"(",["T_VARIABLE","$plaintext",372],")",")",")",";",["T_WHITESPACE","\n\n            ",372],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$ciphertext",374],";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE","\n\n        ",375],["T_IF","if",377],["T_WHITESPACE"," ",377],"(",["T_WHITESPACE"," ",377],["T_STRING","CRYPT_DES_MODE",377],["T_WHITESPACE"," ",377],["T_IS_EQUAL","==",377],["T_WHITESPACE"," ",377],["T_STRING","CRYPT_DES_MODE_MCRYPT",377],["T_WHITESPACE"," ",377],")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n            ",377],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","changed",378],")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n                ",378],["T_IF","if",379],["T_WHITESPACE"," ",379],"(","!",["T_ISSET","isset",379],"(",["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","enmcrypt",379],")",")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n                    ",379],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","enmcrypt",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_STRING","mcrypt_module_open",380],"(",["T_STRING","MCRYPT_3DES",380],",",["T_WHITESPACE"," ",380],["T_CONSTANT_ENCAPSED_STRING","''",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","mode",380],",",["T_WHITESPACE"," ",380],["T_CONSTANT_ENCAPSED_STRING","''",380],")",";",["T_WHITESPACE","\n                ",380],"}",["T_WHITESPACE","\n                ",381],["T_STRING","mcrypt_generic_init",382],"(",["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","enmcrypt",382],",",["T_WHITESPACE"," ",382],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","key",382],",",["T_WHITESPACE"," ",382],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","encryptIV",382],")",";",["T_WHITESPACE","\n                ",382],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","changed",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_STRING","false",383],";",["T_WHITESPACE","\n            ",383],"}",["T_WHITESPACE","\n\n            ",384],["T_VARIABLE","$ciphertext",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","mcrypt_generic",386],"(",["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","enmcrypt",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$plaintext",386],")",";",["T_WHITESPACE","\n\n            ",386],["T_IF","if",388],["T_WHITESPACE"," ",388],"(","!",["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","continuousBuffer",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_STRING","mcrypt_generic_init",389],"(",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","enmcrypt",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","key",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","encryptIV",389],")",";",["T_WHITESPACE","\n            ",389],"}",["T_WHITESPACE","\n\n            ",390],["T_RETURN","return",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$ciphertext",392],";",["T_WHITESPACE","\n        ",392],"}",["T_WHITESPACE","\n\n        ",393],["T_IF","if",395],["T_WHITESPACE"," ",395],"(",["T_STRING","strlen",395],"(",["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","key",395],")",["T_WHITESPACE"," ",395],["T_IS_SMALLER_OR_EQUAL","<=",395],["T_WHITESPACE"," ",395],["T_LNUMBER","8",395],")",["T_WHITESPACE"," ",395],"{",["T_WHITESPACE","\n            ",395],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","des",396],"[",["T_LNUMBER","0",396],"]",["T_OBJECT_OPERATOR","->",396],["T_STRING","mode",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","mode",396],";",["T_WHITESPACE","\n\n            ",396],["T_RETURN","return",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","des",398],"[",["T_LNUMBER","0",398],"]",["T_OBJECT_OPERATOR","->",398],["T_STRING","encrypt",398],"(",["T_VARIABLE","$plaintext",398],")",";",["T_WHITESPACE","\n        ",398],"}",["T_WHITESPACE","\n\n        ",399],["T_COMMENT","\/\/ we pad with chr(0) since that's what mcrypt_generic does.  to quote from http:\/\/php.net\/function.mcrypt-generic :\n",401],["T_WHITESPACE","        ",402],["T_COMMENT","\/\/ \"The data is padded with \"\\0\" to make sure the length of the data is n * blocksize.\"\n",402],["T_WHITESPACE","        ",403],["T_VARIABLE","$plaintext",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_STRING","str_pad",403],"(",["T_VARIABLE","$plaintext",403],",",["T_WHITESPACE"," ",403],["T_STRING","ceil",403],"(",["T_STRING","strlen",403],"(",["T_VARIABLE","$plaintext",403],")",["T_WHITESPACE"," ",403],"\/",["T_WHITESPACE"," ",403],["T_LNUMBER","8",403],")",["T_WHITESPACE"," ",403],"*",["T_WHITESPACE"," ",403],["T_LNUMBER","8",403],",",["T_WHITESPACE"," ",403],["T_STRING","chr",403],"(",["T_LNUMBER","0",403],")",")",";",["T_WHITESPACE","\n\n        ",403],["T_VARIABLE","$des",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","des",405],";",["T_WHITESPACE","\n\n        ",405],["T_VARIABLE","$ciphertext",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","''",407],";",["T_WHITESPACE","\n        ",407],["T_SWITCH","switch",408],["T_WHITESPACE"," ",408],"(",["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","mode",408],")",["T_WHITESPACE"," ",408],"{",["T_WHITESPACE","\n            ",408],["T_CASE","case",409],["T_WHITESPACE"," ",409],["T_STRING","CRYPT_DES_MODE_ECB",409],":",["T_WHITESPACE","\n                ",409],["T_FOR","for",410],["T_WHITESPACE"," ",410],"(",["T_VARIABLE","$i",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_LNUMBER","0",410],";",["T_WHITESPACE"," ",410],["T_VARIABLE","$i",410],["T_WHITESPACE"," ",410],"<",["T_WHITESPACE"," ",410],["T_STRING","strlen",410],"(",["T_VARIABLE","$plaintext",410],")",";",["T_WHITESPACE"," ",410],["T_VARIABLE","$i",410],["T_PLUS_EQUAL","+=",410],["T_LNUMBER","8",410],")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n                    ",410],["T_VARIABLE","$block",411],["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_STRING","substr",411],"(",["T_VARIABLE","$plaintext",411],",",["T_WHITESPACE"," ",411],["T_VARIABLE","$i",411],",",["T_WHITESPACE"," ",411],["T_LNUMBER","8",411],")",";",["T_WHITESPACE","\n                    ",411],["T_VARIABLE","$block",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$des",412],"[",["T_LNUMBER","0",412],"]",["T_OBJECT_OPERATOR","->",412],["T_STRING","_processBlock",412],"(",["T_VARIABLE","$block",412],",",["T_WHITESPACE"," ",412],["T_STRING","CRYPT_DES_ENCRYPT",412],")",";",["T_WHITESPACE","\n                    ",412],["T_VARIABLE","$block",413],["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_VARIABLE","$des",413],"[",["T_LNUMBER","1",413],"]",["T_OBJECT_OPERATOR","->",413],["T_STRING","_processBlock",413],"(",["T_VARIABLE","$block",413],",",["T_WHITESPACE"," ",413],["T_STRING","CRYPT_DES_DECRYPT",413],")",";",["T_WHITESPACE","\n                    ",413],["T_VARIABLE","$block",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$des",414],"[",["T_LNUMBER","2",414],"]",["T_OBJECT_OPERATOR","->",414],["T_STRING","_processBlock",414],"(",["T_VARIABLE","$block",414],",",["T_WHITESPACE"," ",414],["T_STRING","CRYPT_DES_ENCRYPT",414],")",";",["T_WHITESPACE","\n                    ",414],["T_VARIABLE","$ciphertext",415],["T_CONCAT_EQUAL",".=",415],["T_WHITESPACE"," ",415],["T_VARIABLE","$block",415],";",["T_WHITESPACE","\n                ",415],"}",["T_WHITESPACE","\n                ",416],["T_BREAK","break",417],";",["T_WHITESPACE","\n            ",417],["T_CASE","case",418],["T_WHITESPACE"," ",418],["T_STRING","CRYPT_DES_MODE_CBC",418],":",["T_WHITESPACE","\n                ",418],["T_VARIABLE","$xor",419],["T_WHITESPACE"," ",419],"=",["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","encryptIV",419],";",["T_WHITESPACE","\n                ",419],["T_FOR","for",420],["T_WHITESPACE"," ",420],"(",["T_VARIABLE","$i",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_LNUMBER","0",420],";",["T_WHITESPACE"," ",420],["T_VARIABLE","$i",420],["T_WHITESPACE"," ",420],"<",["T_WHITESPACE"," ",420],["T_STRING","strlen",420],"(",["T_VARIABLE","$plaintext",420],")",";",["T_WHITESPACE"," ",420],["T_VARIABLE","$i",420],["T_PLUS_EQUAL","+=",420],["T_LNUMBER","8",420],")",["T_WHITESPACE"," ",420],"{",["T_WHITESPACE","\n                    ",420],["T_VARIABLE","$block",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","substr",421],"(",["T_VARIABLE","$plaintext",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$i",421],",",["T_WHITESPACE"," ",421],["T_LNUMBER","8",421],")",["T_WHITESPACE"," ",421],"^",["T_WHITESPACE"," ",421],["T_VARIABLE","$xor",421],";",["T_WHITESPACE","\n                    ",421],["T_VARIABLE","$block",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_VARIABLE","$des",422],"[",["T_LNUMBER","0",422],"]",["T_OBJECT_OPERATOR","->",422],["T_STRING","_processBlock",422],"(",["T_VARIABLE","$block",422],",",["T_WHITESPACE"," ",422],["T_STRING","CRYPT_DES_ENCRYPT",422],")",";",["T_WHITESPACE","\n                    ",422],["T_VARIABLE","$block",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_VARIABLE","$des",423],"[",["T_LNUMBER","1",423],"]",["T_OBJECT_OPERATOR","->",423],["T_STRING","_processBlock",423],"(",["T_VARIABLE","$block",423],",",["T_WHITESPACE"," ",423],["T_STRING","CRYPT_DES_DECRYPT",423],")",";",["T_WHITESPACE","\n                    ",423],["T_VARIABLE","$block",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_VARIABLE","$des",424],"[",["T_LNUMBER","2",424],"]",["T_OBJECT_OPERATOR","->",424],["T_STRING","_processBlock",424],"(",["T_VARIABLE","$block",424],",",["T_WHITESPACE"," ",424],["T_STRING","CRYPT_DES_ENCRYPT",424],")",";",["T_WHITESPACE","\n                    ",424],["T_VARIABLE","$xor",425],["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$block",425],";",["T_WHITESPACE","\n                    ",425],["T_VARIABLE","$ciphertext",426],["T_CONCAT_EQUAL",".=",426],["T_WHITESPACE"," ",426],["T_VARIABLE","$block",426],";",["T_WHITESPACE","\n                ",426],"}",["T_WHITESPACE","\n                ",427],["T_IF","if",428],["T_WHITESPACE"," ",428],"(",["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","continuousBuffer",428],")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n                    ",428],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","encryptIV",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_VARIABLE","$xor",429],";",["T_WHITESPACE","\n                ",429],"}",["T_WHITESPACE","\n                ",430],["T_BREAK","break",431],";",["T_WHITESPACE","\n            ",431],["T_CASE","case",432],["T_WHITESPACE"," ",432],["T_STRING","CRYPT_DES_MODE_CTR",432],":",["T_WHITESPACE","\n                ",432],["T_VARIABLE","$xor",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","encryptIV",433],";",["T_WHITESPACE","\n                ",433],["T_FOR","for",434],["T_WHITESPACE"," ",434],"(",["T_VARIABLE","$i",434],["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_LNUMBER","0",434],";",["T_WHITESPACE"," ",434],["T_VARIABLE","$i",434],["T_WHITESPACE"," ",434],"<",["T_WHITESPACE"," ",434],["T_STRING","strlen",434],"(",["T_VARIABLE","$plaintext",434],")",";",["T_WHITESPACE"," ",434],["T_VARIABLE","$i",434],["T_PLUS_EQUAL","+=",434],["T_LNUMBER","8",434],")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n                    ",434],["T_VARIABLE","$key",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","_generate_xor",435],"(",["T_LNUMBER","8",435],",",["T_WHITESPACE"," ",435],["T_VARIABLE","$xor",435],")",";",["T_WHITESPACE","\n                    ",435],["T_VARIABLE","$key",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$des",436],"[",["T_LNUMBER","0",436],"]",["T_OBJECT_OPERATOR","->",436],["T_STRING","_processBlock",436],"(",["T_VARIABLE","$key",436],",",["T_WHITESPACE"," ",436],["T_STRING","CRYPT_DES_ENCRYPT",436],")",";",["T_WHITESPACE","\n                    ",436],["T_VARIABLE","$key",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_VARIABLE","$des",437],"[",["T_LNUMBER","1",437],"]",["T_OBJECT_OPERATOR","->",437],["T_STRING","_processBlock",437],"(",["T_VARIABLE","$key",437],",",["T_WHITESPACE"," ",437],["T_STRING","CRYPT_DES_DECRYPT",437],")",";",["T_WHITESPACE","\n                    ",437],["T_VARIABLE","$key",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$des",438],"[",["T_LNUMBER","2",438],"]",["T_OBJECT_OPERATOR","->",438],["T_STRING","_processBlock",438],"(",["T_VARIABLE","$key",438],",",["T_WHITESPACE"," ",438],["T_STRING","CRYPT_DES_ENCRYPT",438],")",";",["T_WHITESPACE","\n                    ",438],["T_VARIABLE","$block",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_STRING","substr",439],"(",["T_VARIABLE","$plaintext",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$i",439],",",["T_WHITESPACE"," ",439],["T_LNUMBER","8",439],")",";",["T_WHITESPACE","\n                    ",439],["T_VARIABLE","$ciphertext",440],["T_CONCAT_EQUAL",".=",440],["T_WHITESPACE"," ",440],["T_VARIABLE","$block",440],["T_WHITESPACE"," ",440],"^",["T_WHITESPACE"," ",440],["T_VARIABLE","$key",440],";",["T_WHITESPACE","\n                ",440],"}",["T_WHITESPACE","\n                ",441],["T_IF","if",442],["T_WHITESPACE"," ",442],"(",["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","continuousBuffer",442],")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n                    ",442],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","encryptIV",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_VARIABLE","$xor",443],";",["T_WHITESPACE","\n                ",443],"}",["T_WHITESPACE","\n        ",444],"}",["T_WHITESPACE","\n\n        ",445],["T_RETURN","return",447],["T_WHITESPACE"," ",447],["T_VARIABLE","$ciphertext",447],";",["T_WHITESPACE","\n    ",447],"}",["T_WHITESPACE","\n\n    ",448],["T_DOC_COMMENT","\/**\n     * Decrypts a message.\n     *\n     * @access public\n     * @param String $ciphertext\n     *\/",450],["T_WHITESPACE","\n    ",455],["T_FUNCTION","function",456],["T_WHITESPACE"," ",456],["T_STRING","decrypt",456],"(",["T_VARIABLE","$ciphertext",456],")",["T_WHITESPACE","\n    ",456],"{",["T_WHITESPACE","\n        ",457],["T_IF","if",458],["T_WHITESPACE"," ",458],"(",["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","mode",458],["T_WHITESPACE"," ",458],["T_IS_EQUAL","==",458],["T_WHITESPACE"," ",458],["T_STRING","CRYPT_DES_MODE_3CBC",458],["T_WHITESPACE"," ",458],["T_BOOLEAN_AND","&&",458],["T_WHITESPACE"," ",458],["T_STRING","strlen",458],"(",["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","key",458],")",["T_WHITESPACE"," ",458],">",["T_WHITESPACE"," ",458],["T_LNUMBER","8",458],")",["T_WHITESPACE"," ",458],"{",["T_WHITESPACE","\n            ",458],["T_VARIABLE","$plaintext",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","des",459],"[",["T_LNUMBER","0",459],"]",["T_OBJECT_OPERATOR","->",459],["T_STRING","decrypt",459],"(",["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","des",459],"[",["T_LNUMBER","1",459],"]",["T_OBJECT_OPERATOR","->",459],["T_STRING","encrypt",459],"(",["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","des",459],"[",["T_LNUMBER","2",459],"]",["T_OBJECT_OPERATOR","->",459],["T_STRING","decrypt",459],"(",["T_VARIABLE","$ciphertext",459],")",")",")",";",["T_WHITESPACE","\n\n            ",459],["T_RETURN","return",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$this",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","_unpad",461],"(",["T_VARIABLE","$plaintext",461],")",";",["T_WHITESPACE","\n        ",461],"}",["T_WHITESPACE","\n\n        ",462],["T_COMMENT","\/\/ we pad with chr(0) since that's what mcrypt_generic does.  to quote from http:\/\/php.net\/function.mcrypt-generic :\n",464],["T_WHITESPACE","        ",465],["T_COMMENT","\/\/ \"The data is padded with \"\\0\" to make sure the length of the data is n * blocksize.\"\n",465],["T_WHITESPACE","        ",466],["T_VARIABLE","$ciphertext",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_STRING","str_pad",466],"(",["T_VARIABLE","$ciphertext",466],",",["T_WHITESPACE"," ",466],"(",["T_STRING","strlen",466],"(",["T_VARIABLE","$ciphertext",466],")",["T_WHITESPACE"," ",466],"+",["T_WHITESPACE"," ",466],["T_LNUMBER","7",466],")",["T_WHITESPACE"," ",466],"&",["T_WHITESPACE"," ",466],["T_LNUMBER","0xFFFFFFF8",466],",",["T_WHITESPACE"," ",466],["T_STRING","chr",466],"(",["T_LNUMBER","0",466],")",")",";",["T_WHITESPACE","\n\n        ",466],["T_IF","if",468],["T_WHITESPACE"," ",468],"(",["T_WHITESPACE"," ",468],["T_STRING","CRYPT_DES_MODE",468],["T_WHITESPACE"," ",468],["T_IS_EQUAL","==",468],["T_WHITESPACE"," ",468],["T_STRING","CRYPT_DES_MODE_MCRYPT",468],["T_WHITESPACE"," ",468],")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n            ",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(",["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","changed",469],")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n                ",469],["T_IF","if",470],["T_WHITESPACE"," ",470],"(","!",["T_ISSET","isset",470],"(",["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","demcrypt",470],")",")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n                    ",470],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","demcrypt",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_STRING","mcrypt_module_open",471],"(",["T_STRING","MCRYPT_3DES",471],",",["T_WHITESPACE"," ",471],["T_CONSTANT_ENCAPSED_STRING","''",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","mode",471],",",["T_WHITESPACE"," ",471],["T_CONSTANT_ENCAPSED_STRING","''",471],")",";",["T_WHITESPACE","\n                ",471],"}",["T_WHITESPACE","\n                ",472],["T_STRING","mcrypt_generic_init",473],"(",["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","demcrypt",473],",",["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","key",473],",",["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","decryptIV",473],")",";",["T_WHITESPACE","\n                ",473],["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","changed",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","false",474],";",["T_WHITESPACE","\n            ",474],"}",["T_WHITESPACE","\n\n            ",475],["T_VARIABLE","$plaintext",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_STRING","mdecrypt_generic",477],"(",["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","demcrypt",477],",",["T_WHITESPACE"," ",477],["T_VARIABLE","$ciphertext",477],")",";",["T_WHITESPACE","\n\n            ",477],["T_IF","if",479],["T_WHITESPACE"," ",479],"(","!",["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","continuousBuffer",479],")",["T_WHITESPACE"," ",479],"{",["T_WHITESPACE","\n                ",479],["T_STRING","mcrypt_generic_init",480],"(",["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","demcrypt",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","key",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","decryptIV",480],")",";",["T_WHITESPACE","\n            ",480],"}",["T_WHITESPACE","\n\n            ",481],["T_RETURN","return",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","mode",483],["T_WHITESPACE"," ",483],["T_IS_NOT_EQUAL","!=",483],["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'ctr'",483],["T_WHITESPACE"," ",483],"?",["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","_unpad",483],"(",["T_VARIABLE","$plaintext",483],")",["T_WHITESPACE"," ",483],":",["T_WHITESPACE"," ",483],["T_VARIABLE","$plaintext",483],";",["T_WHITESPACE","\n        ",483],"}",["T_WHITESPACE","\n\n        ",484],["T_IF","if",486],["T_WHITESPACE"," ",486],"(",["T_STRING","strlen",486],"(",["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","key",486],")",["T_WHITESPACE"," ",486],["T_IS_SMALLER_OR_EQUAL","<=",486],["T_WHITESPACE"," ",486],["T_LNUMBER","8",486],")",["T_WHITESPACE"," ",486],"{",["T_WHITESPACE","\n            ",486],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","des",487],"[",["T_LNUMBER","0",487],"]",["T_OBJECT_OPERATOR","->",487],["T_STRING","mode",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","mode",487],";",["T_WHITESPACE","\n\n            ",487],["T_RETURN","return",489],["T_WHITESPACE"," ",489],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","_unpad",489],"(",["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","des",489],"[",["T_LNUMBER","0",489],"]",["T_OBJECT_OPERATOR","->",489],["T_STRING","decrypt",489],"(",["T_VARIABLE","$plaintext",489],")",")",";",["T_WHITESPACE","\n        ",489],"}",["T_WHITESPACE","\n\n        ",490],["T_VARIABLE","$des",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","des",492],";",["T_WHITESPACE","\n\n        ",492],["T_VARIABLE","$plaintext",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_CONSTANT_ENCAPSED_STRING","''",494],";",["T_WHITESPACE","\n        ",494],["T_SWITCH","switch",495],["T_WHITESPACE"," ",495],"(",["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","mode",495],")",["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n            ",495],["T_CASE","case",496],["T_WHITESPACE"," ",496],["T_STRING","CRYPT_DES_MODE_ECB",496],":",["T_WHITESPACE","\n                ",496],["T_FOR","for",497],["T_WHITESPACE"," ",497],"(",["T_VARIABLE","$i",497],["T_WHITESPACE"," ",497],"=",["T_WHITESPACE"," ",497],["T_LNUMBER","0",497],";",["T_WHITESPACE"," ",497],["T_VARIABLE","$i",497],["T_WHITESPACE"," ",497],"<",["T_WHITESPACE"," ",497],["T_STRING","strlen",497],"(",["T_VARIABLE","$ciphertext",497],")",";",["T_WHITESPACE"," ",497],["T_VARIABLE","$i",497],["T_PLUS_EQUAL","+=",497],["T_LNUMBER","8",497],")",["T_WHITESPACE"," ",497],"{",["T_WHITESPACE","\n                    ",497],["T_VARIABLE","$block",498],["T_WHITESPACE"," ",498],"=",["T_WHITESPACE"," ",498],["T_STRING","substr",498],"(",["T_VARIABLE","$ciphertext",498],",",["T_WHITESPACE"," ",498],["T_VARIABLE","$i",498],",",["T_WHITESPACE"," ",498],["T_LNUMBER","8",498],")",";",["T_WHITESPACE","\n                    ",498],["T_VARIABLE","$block",499],["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_VARIABLE","$des",499],"[",["T_LNUMBER","2",499],"]",["T_OBJECT_OPERATOR","->",499],["T_STRING","_processBlock",499],"(",["T_VARIABLE","$block",499],",",["T_WHITESPACE"," ",499],["T_STRING","CRYPT_DES_DECRYPT",499],")",";",["T_WHITESPACE","\n                    ",499],["T_VARIABLE","$block",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_VARIABLE","$des",500],"[",["T_LNUMBER","1",500],"]",["T_OBJECT_OPERATOR","->",500],["T_STRING","_processBlock",500],"(",["T_VARIABLE","$block",500],",",["T_WHITESPACE"," ",500],["T_STRING","CRYPT_DES_ENCRYPT",500],")",";",["T_WHITESPACE","\n                    ",500],["T_VARIABLE","$block",501],["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_VARIABLE","$des",501],"[",["T_LNUMBER","0",501],"]",["T_OBJECT_OPERATOR","->",501],["T_STRING","_processBlock",501],"(",["T_VARIABLE","$block",501],",",["T_WHITESPACE"," ",501],["T_STRING","CRYPT_DES_DECRYPT",501],")",";",["T_WHITESPACE","\n                    ",501],["T_VARIABLE","$plaintext",502],["T_CONCAT_EQUAL",".=",502],["T_WHITESPACE"," ",502],["T_VARIABLE","$block",502],";",["T_WHITESPACE","\n                ",502],"}",["T_WHITESPACE","\n                ",503],["T_BREAK","break",504],";",["T_WHITESPACE","\n            ",504],["T_CASE","case",505],["T_WHITESPACE"," ",505],["T_STRING","CRYPT_DES_MODE_CBC",505],":",["T_WHITESPACE","\n                ",505],["T_VARIABLE","$xor",506],["T_WHITESPACE"," ",506],"=",["T_WHITESPACE"," ",506],["T_VARIABLE","$this",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","decryptIV",506],";",["T_WHITESPACE","\n                ",506],["T_FOR","for",507],["T_WHITESPACE"," ",507],"(",["T_VARIABLE","$i",507],["T_WHITESPACE"," ",507],"=",["T_WHITESPACE"," ",507],["T_LNUMBER","0",507],";",["T_WHITESPACE"," ",507],["T_VARIABLE","$i",507],["T_WHITESPACE"," ",507],"<",["T_WHITESPACE"," ",507],["T_STRING","strlen",507],"(",["T_VARIABLE","$ciphertext",507],")",";",["T_WHITESPACE"," ",507],["T_VARIABLE","$i",507],["T_PLUS_EQUAL","+=",507],["T_LNUMBER","8",507],")",["T_WHITESPACE"," ",507],"{",["T_WHITESPACE","\n                    ",507],["T_VARIABLE","$orig",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_VARIABLE","$block",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_STRING","substr",508],"(",["T_VARIABLE","$ciphertext",508],",",["T_WHITESPACE"," ",508],["T_VARIABLE","$i",508],",",["T_WHITESPACE"," ",508],["T_LNUMBER","8",508],")",";",["T_WHITESPACE","\n                    ",508],["T_VARIABLE","$block",509],["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_VARIABLE","$des",509],"[",["T_LNUMBER","2",509],"]",["T_OBJECT_OPERATOR","->",509],["T_STRING","_processBlock",509],"(",["T_VARIABLE","$block",509],",",["T_WHITESPACE"," ",509],["T_STRING","CRYPT_DES_DECRYPT",509],")",";",["T_WHITESPACE","\n                    ",509],["T_VARIABLE","$block",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_VARIABLE","$des",510],"[",["T_LNUMBER","1",510],"]",["T_OBJECT_OPERATOR","->",510],["T_STRING","_processBlock",510],"(",["T_VARIABLE","$block",510],",",["T_WHITESPACE"," ",510],["T_STRING","CRYPT_DES_ENCRYPT",510],")",";",["T_WHITESPACE","\n                    ",510],["T_VARIABLE","$block",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_VARIABLE","$des",511],"[",["T_LNUMBER","0",511],"]",["T_OBJECT_OPERATOR","->",511],["T_STRING","_processBlock",511],"(",["T_VARIABLE","$block",511],",",["T_WHITESPACE"," ",511],["T_STRING","CRYPT_DES_DECRYPT",511],")",";",["T_WHITESPACE","\n                    ",511],["T_VARIABLE","$plaintext",512],["T_CONCAT_EQUAL",".=",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$block",512],["T_WHITESPACE"," ",512],"^",["T_WHITESPACE"," ",512],["T_VARIABLE","$xor",512],";",["T_WHITESPACE","\n                    ",512],["T_VARIABLE","$xor",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_VARIABLE","$orig",513],";",["T_WHITESPACE","\n                ",513],"}",["T_WHITESPACE","\n                ",514],["T_IF","if",515],["T_WHITESPACE"," ",515],"(",["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","continuousBuffer",515],")",["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n                    ",515],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","decryptIV",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$xor",516],";",["T_WHITESPACE","\n                ",516],"}",["T_WHITESPACE","\n                ",517],["T_BREAK","break",518],";",["T_WHITESPACE","\n            ",518],["T_CASE","case",519],["T_WHITESPACE"," ",519],["T_STRING","CRYPT_DES_MODE_CTR",519],":",["T_WHITESPACE","\n                ",519],["T_VARIABLE","$xor",520],["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","decryptIV",520],";",["T_WHITESPACE","\n                ",520],["T_FOR","for",521],["T_WHITESPACE"," ",521],"(",["T_VARIABLE","$i",521],["T_WHITESPACE"," ",521],"=",["T_WHITESPACE"," ",521],["T_LNUMBER","0",521],";",["T_WHITESPACE"," ",521],["T_VARIABLE","$i",521],["T_WHITESPACE"," ",521],"<",["T_WHITESPACE"," ",521],["T_STRING","strlen",521],"(",["T_VARIABLE","$ciphertext",521],")",";",["T_WHITESPACE"," ",521],["T_VARIABLE","$i",521],["T_PLUS_EQUAL","+=",521],["T_LNUMBER","8",521],")",["T_WHITESPACE"," ",521],"{",["T_WHITESPACE","\n                    ",521],["T_VARIABLE","$key",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","_generate_xor",522],"(",["T_LNUMBER","8",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$xor",522],")",";",["T_WHITESPACE","\n                    ",522],["T_VARIABLE","$key",523],["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_VARIABLE","$des",523],"[",["T_LNUMBER","0",523],"]",["T_OBJECT_OPERATOR","->",523],["T_STRING","_processBlock",523],"(",["T_VARIABLE","$key",523],",",["T_WHITESPACE"," ",523],["T_STRING","CRYPT_DES_ENCRYPT",523],")",";",["T_WHITESPACE","\n                    ",523],["T_VARIABLE","$key",524],["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_VARIABLE","$des",524],"[",["T_LNUMBER","1",524],"]",["T_OBJECT_OPERATOR","->",524],["T_STRING","_processBlock",524],"(",["T_VARIABLE","$key",524],",",["T_WHITESPACE"," ",524],["T_STRING","CRYPT_DES_DECRYPT",524],")",";",["T_WHITESPACE","\n                    ",524],["T_VARIABLE","$key",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_VARIABLE","$des",525],"[",["T_LNUMBER","2",525],"]",["T_OBJECT_OPERATOR","->",525],["T_STRING","_processBlock",525],"(",["T_VARIABLE","$key",525],",",["T_WHITESPACE"," ",525],["T_STRING","CRYPT_DES_ENCRYPT",525],")",";",["T_WHITESPACE","\n                    ",525],["T_VARIABLE","$block",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_STRING","substr",526],"(",["T_VARIABLE","$ciphertext",526],",",["T_WHITESPACE"," ",526],["T_VARIABLE","$i",526],",",["T_WHITESPACE"," ",526],["T_LNUMBER","8",526],")",";",["T_WHITESPACE","\n                    ",526],["T_VARIABLE","$plaintext",527],["T_CONCAT_EQUAL",".=",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$block",527],["T_WHITESPACE"," ",527],"^",["T_WHITESPACE"," ",527],["T_VARIABLE","$key",527],";",["T_WHITESPACE","\n                ",527],"}",["T_WHITESPACE","\n                ",528],["T_IF","if",529],["T_WHITESPACE"," ",529],"(",["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","continuousBuffer",529],")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n                    ",529],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","decryptIV",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_VARIABLE","$xor",530],";",["T_WHITESPACE","\n                ",530],"}",["T_WHITESPACE","\n        ",531],"}",["T_WHITESPACE","\n\n        ",532],["T_RETURN","return",534],["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","mode",534],["T_WHITESPACE"," ",534],["T_IS_NOT_EQUAL","!=",534],["T_WHITESPACE"," ",534],["T_STRING","CRYPT_DES_MODE_CTR",534],["T_WHITESPACE"," ",534],"?",["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","_unpad",534],"(",["T_VARIABLE","$plaintext",534],")",["T_WHITESPACE"," ",534],":",["T_WHITESPACE"," ",534],["T_VARIABLE","$plaintext",534],";",["T_WHITESPACE","\n    ",534],"}",["T_WHITESPACE","\n\n    ",535],["T_DOC_COMMENT","\/**\n     * Treat consecutive \"packets\" as if they are a continuous buffer.\n     *\n     * Say you have a 16-byte plaintext $plaintext.  Using the default behavior, the two following code snippets\n     * will yield different outputs:\n     *\n     * <code>\n     *    echo $des->encrypt(substr($plaintext, 0, 8));\n     *    echo $des->encrypt(substr($plaintext, 8, 8));\n     * <\/code>\n     * <code>\n     *    echo $des->encrypt($plaintext);\n     * <\/code>\n     *\n     * The solution is to enable the continuous buffer.  Although this will resolve the above discrepancy, it creates\n     * another, as demonstrated with the following:\n     *\n     * <code>\n     *    $des->encrypt(substr($plaintext, 0, 8));\n     *    echo $des->decrypt($des->encrypt(substr($plaintext, 8, 8)));\n     * <\/code>\n     * <code>\n     *    echo $des->decrypt($des->encrypt(substr($plaintext, 8, 8)));\n     * <\/code>\n     *\n     * With the continuous buffer disabled, these would yield the same output.  With it enabled, they yield different\n     * outputs.  The reason is due to the fact that the initialization vector's change after every encryption \/\n     * decryption round when the continuous buffer is enabled.  When it's disabled, they remain constant.\n     *\n     * Put another way, when the continuous buffer is enabled, the state of the Crypt_DES() object changes after each\n     * encryption \/ decryption round, whereas otherwise, it'd remain constant.  For this reason, it's recommended that\n     * continuous buffers not be used.  They do offer better security and are, in fact, sometimes required (SSH uses them),\n     * however, they are also less intuitive and more likely to cause you problems.\n     *\n     * @see Crypt_TripleDES::disableContinuousBuffer()\n     * @access public\n     *\/",537],["T_WHITESPACE","\n    ",573],["T_FUNCTION","function",574],["T_WHITESPACE"," ",574],["T_STRING","enableContinuousBuffer",574],"(",")",["T_WHITESPACE","\n    ",574],"{",["T_WHITESPACE","\n        ",575],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","continuousBuffer",576],["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_STRING","true",576],";",["T_WHITESPACE","\n        ",576],["T_IF","if",577],["T_WHITESPACE"," ",577],"(",["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","mode",577],["T_WHITESPACE"," ",577],["T_IS_EQUAL","==",577],["T_WHITESPACE"," ",577],["T_STRING","CRYPT_DES_MODE_3CBC",577],")",["T_WHITESPACE"," ",577],"{",["T_WHITESPACE","\n            ",577],["T_VARIABLE","$this",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","des",578],"[",["T_LNUMBER","0",578],"]",["T_OBJECT_OPERATOR","->",578],["T_STRING","enableContinuousBuffer",578],"(",")",";",["T_WHITESPACE","\n            ",578],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","des",579],"[",["T_LNUMBER","1",579],"]",["T_OBJECT_OPERATOR","->",579],["T_STRING","enableContinuousBuffer",579],"(",")",";",["T_WHITESPACE","\n            ",579],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","des",580],"[",["T_LNUMBER","2",580],"]",["T_OBJECT_OPERATOR","->",580],["T_STRING","enableContinuousBuffer",580],"(",")",";",["T_WHITESPACE","\n        ",580],"}",["T_WHITESPACE","\n    ",581],"}",["T_WHITESPACE","\n\n    ",582],["T_DOC_COMMENT","\/**\n     * Treat consecutive packets as if they are a discontinuous buffer.\n     *\n     * The default behavior.\n     *\n     * @see Crypt_TripleDES::enableContinuousBuffer()\n     * @access public\n     *\/",584],["T_WHITESPACE","\n    ",591],["T_FUNCTION","function",592],["T_WHITESPACE"," ",592],["T_STRING","disableContinuousBuffer",592],"(",")",["T_WHITESPACE","\n    ",592],"{",["T_WHITESPACE","\n        ",593],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","continuousBuffer",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_STRING","false",594],";",["T_WHITESPACE","\n        ",594],["T_VARIABLE","$this",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","encryptIV",595],["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_VARIABLE","$this",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","iv",595],";",["T_WHITESPACE","\n        ",595],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","decryptIV",596],["T_WHITESPACE"," ",596],"=",["T_WHITESPACE"," ",596],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","iv",596],";",["T_WHITESPACE","\n\n        ",596],["T_IF","if",598],["T_WHITESPACE"," ",598],"(",["T_VARIABLE","$this",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","mode",598],["T_WHITESPACE"," ",598],["T_IS_EQUAL","==",598],["T_WHITESPACE"," ",598],["T_STRING","CRYPT_DES_MODE_3CBC",598],")",["T_WHITESPACE"," ",598],"{",["T_WHITESPACE","\n            ",598],["T_VARIABLE","$this",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","des",599],"[",["T_LNUMBER","0",599],"]",["T_OBJECT_OPERATOR","->",599],["T_STRING","disableContinuousBuffer",599],"(",")",";",["T_WHITESPACE","\n            ",599],["T_VARIABLE","$this",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","des",600],"[",["T_LNUMBER","1",600],"]",["T_OBJECT_OPERATOR","->",600],["T_STRING","disableContinuousBuffer",600],"(",")",";",["T_WHITESPACE","\n            ",600],["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","des",601],"[",["T_LNUMBER","2",601],"]",["T_OBJECT_OPERATOR","->",601],["T_STRING","disableContinuousBuffer",601],"(",")",";",["T_WHITESPACE","\n        ",601],"}",["T_WHITESPACE","\n    ",602],"}",["T_WHITESPACE","\n\n    ",603],["T_DOC_COMMENT","\/**\n     * Pad \"packets\".\n     *\n     * DES works by encrypting eight bytes at a time.  If you ever need to encrypt or decrypt something that's not\n     * a multiple of eight, it becomes necessary to pad the input so that it's length is a multiple of eight.\n     *\n     * Padding is enabled by default.  Sometimes, however, it is undesirable to pad strings.  Such is the case in SSH1,\n     * where \"packets\" are padded with random bytes before being encrypted.  Unpad these packets and you risk stripping\n     * away characters that shouldn't be stripped away. (SSH knows how many bytes are added because the length is\n     * transmitted separately)\n     *\n     * @see Crypt_TripleDES::disablePadding()\n     * @access public\n     *\/",605],["T_WHITESPACE","\n    ",618],["T_FUNCTION","function",619],["T_WHITESPACE"," ",619],["T_STRING","enablePadding",619],"(",")",["T_WHITESPACE","\n    ",619],"{",["T_WHITESPACE","\n        ",620],["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","padding",621],["T_WHITESPACE"," ",621],"=",["T_WHITESPACE"," ",621],["T_STRING","true",621],";",["T_WHITESPACE","\n    ",621],"}",["T_WHITESPACE","\n\n    ",622],["T_DOC_COMMENT","\/**\n     * Do not pad packets.\n     *\n     * @see Crypt_TripleDES::enablePadding()\n     * @access public\n     *\/",624],["T_WHITESPACE","\n    ",629],["T_FUNCTION","function",630],["T_WHITESPACE"," ",630],["T_STRING","disablePadding",630],"(",")",["T_WHITESPACE","\n    ",630],"{",["T_WHITESPACE","\n        ",631],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","padding",632],["T_WHITESPACE"," ",632],"=",["T_WHITESPACE"," ",632],["T_STRING","false",632],";",["T_WHITESPACE","\n    ",632],"}",["T_WHITESPACE","\n\n    ",633],["T_DOC_COMMENT","\/**\n     * Pads a string\n     *\n     * Pads a string using the RSA PKCS padding standards so that its length is a multiple of the blocksize (8).\n     * 8 - (strlen($text) & 7) bytes are added, each of which is equal to chr(8 - (strlen($text) & 7)\n     *\n     * If padding is disabled and $text is not a multiple of the blocksize, the string will be padded regardless\n     * and padding will, hence forth, be enabled.\n     *\n     * @see Crypt_TripleDES::_unpad()\n     * @access private\n     *\/",635],["T_WHITESPACE","\n    ",646],["T_FUNCTION","function",647],["T_WHITESPACE"," ",647],["T_STRING","_pad",647],"(",["T_VARIABLE","$text",647],")",["T_WHITESPACE","\n    ",647],"{",["T_WHITESPACE","\n        ",648],["T_VARIABLE","$length",649],["T_WHITESPACE"," ",649],"=",["T_WHITESPACE"," ",649],["T_STRING","strlen",649],"(",["T_VARIABLE","$text",649],")",";",["T_WHITESPACE","\n\n        ",649],["T_IF","if",651],["T_WHITESPACE"," ",651],"(","!",["T_VARIABLE","$this",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","padding",651],")",["T_WHITESPACE"," ",651],"{",["T_WHITESPACE","\n            ",651],["T_IF","if",652],["T_WHITESPACE"," ",652],"(","(",["T_VARIABLE","$length",652],["T_WHITESPACE"," ",652],"&",["T_WHITESPACE"," ",652],["T_LNUMBER","7",652],")",["T_WHITESPACE"," ",652],["T_IS_EQUAL","==",652],["T_WHITESPACE"," ",652],["T_LNUMBER","0",652],")",["T_WHITESPACE"," ",652],"{",["T_WHITESPACE","\n                ",652],["T_RETURN","return",653],["T_WHITESPACE"," ",653],["T_VARIABLE","$text",653],";",["T_WHITESPACE","\n            ",653],"}",["T_WHITESPACE"," ",654],["T_ELSE","else",654],["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n                ",654],["T_STRING","user_error",655],"(","\"",["T_ENCAPSED_AND_WHITESPACE","The plaintext's length (",655],["T_VARIABLE","$length",655],["T_ENCAPSED_AND_WHITESPACE",") is not a multiple of the block size (8)",655],"\"",",",["T_WHITESPACE"," ",655],["T_STRING","E_USER_NOTICE",655],")",";",["T_WHITESPACE","\n                ",655],["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","padding",656],["T_WHITESPACE"," ",656],"=",["T_WHITESPACE"," ",656],["T_STRING","true",656],";",["T_WHITESPACE","\n            ",656],"}",["T_WHITESPACE","\n        ",657],"}",["T_WHITESPACE","\n\n        ",658],["T_VARIABLE","$pad",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_LNUMBER","8",660],["T_WHITESPACE"," ",660],"-",["T_WHITESPACE"," ",660],"(",["T_VARIABLE","$length",660],["T_WHITESPACE"," ",660],"&",["T_WHITESPACE"," ",660],["T_LNUMBER","7",660],")",";",["T_WHITESPACE","\n        ",660],["T_RETURN","return",661],["T_WHITESPACE"," ",661],["T_STRING","str_pad",661],"(",["T_VARIABLE","$text",661],",",["T_WHITESPACE"," ",661],["T_VARIABLE","$length",661],["T_WHITESPACE"," ",661],"+",["T_WHITESPACE"," ",661],["T_VARIABLE","$pad",661],",",["T_WHITESPACE"," ",661],["T_STRING","chr",661],"(",["T_VARIABLE","$pad",661],")",")",";",["T_WHITESPACE","\n    ",661],"}",["T_WHITESPACE","\n\n    ",662],["T_DOC_COMMENT","\/**\n     * Unpads a string\n     *\n     * If padding is enabled and the reported padding length is invalid the encryption key will be assumed to be wrong\n     * and false will be returned.\n     *\n     * @see Crypt_TripleDES::_pad()\n     * @access private\n     *\/",664],["T_WHITESPACE","\n    ",672],["T_FUNCTION","function",673],["T_WHITESPACE"," ",673],["T_STRING","_unpad",673],"(",["T_VARIABLE","$text",673],")",["T_WHITESPACE","\n    ",673],"{",["T_WHITESPACE","\n        ",674],["T_IF","if",675],["T_WHITESPACE"," ",675],"(","!",["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","padding",675],")",["T_WHITESPACE"," ",675],"{",["T_WHITESPACE","\n            ",675],["T_RETURN","return",676],["T_WHITESPACE"," ",676],["T_VARIABLE","$text",676],";",["T_WHITESPACE","\n        ",676],"}",["T_WHITESPACE","\n\n        ",677],["T_VARIABLE","$length",679],["T_WHITESPACE"," ",679],"=",["T_WHITESPACE"," ",679],["T_STRING","ord",679],"(",["T_VARIABLE","$text",679],"[",["T_STRING","strlen",679],"(",["T_VARIABLE","$text",679],")",["T_WHITESPACE"," ",679],"-",["T_WHITESPACE"," ",679],["T_LNUMBER","1",679],"]",")",";",["T_WHITESPACE","\n\n        ",679],["T_IF","if",681],["T_WHITESPACE"," ",681],"(","!",["T_VARIABLE","$length",681],["T_WHITESPACE"," ",681],["T_BOOLEAN_OR","||",681],["T_WHITESPACE"," ",681],["T_VARIABLE","$length",681],["T_WHITESPACE"," ",681],">",["T_WHITESPACE"," ",681],["T_LNUMBER","8",681],")",["T_WHITESPACE"," ",681],"{",["T_WHITESPACE","\n            ",681],["T_RETURN","return",682],["T_WHITESPACE"," ",682],["T_STRING","false",682],";",["T_WHITESPACE","\n        ",682],"}",["T_WHITESPACE","\n\n        ",683],["T_RETURN","return",685],["T_WHITESPACE"," ",685],["T_STRING","substr",685],"(",["T_VARIABLE","$text",685],",",["T_WHITESPACE"," ",685],["T_LNUMBER","0",685],",",["T_WHITESPACE"," ",685],"-",["T_VARIABLE","$length",685],")",";",["T_WHITESPACE","\n    ",685],"}",["T_WHITESPACE","\n",686],"}",["T_WHITESPACE","\n\n",687],["T_COMMENT","\/\/ vim: ts=4:sw=4:et:\n",689],["T_COMMENT","\/\/ vim6: fdl=1:\n",690]]