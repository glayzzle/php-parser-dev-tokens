[["T_OPEN_TAG","<?php\n",1],["T_COMMENT","\/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: *\/",2],["T_WHITESPACE","\n\n",2],["T_DOC_COMMENT","\/**\n * Random Number Generator\n *\n * PHP versions 4 and 5\n *\n * Here's a short example of how to use this library:\n * <code>\n * <?php\n *    include('Crypt\/Random.php');\n *\n *    echo crypt_random();\n * ?>\n * <\/code>\n *\n * LICENSE: This library is free software; you can redistribute it and\/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place, Suite 330, Boston,\n * MA  02111-1307  USA\n *\n * @category   Crypt\n * @package    Crypt_Random\n * @author     Jim Wigginton <terrafrost@php.net>\n * @copyright  MMVII Jim Wigginton\n * @license    http:\/\/www.gnu.org\/licenses\/lgpl.txt\n * @version    $Id: Random.php,v 1.9 2010\/04\/24 06:40:48 terrafrost Exp $\n * @link       http:\/\/phpseclib.sourceforge.net\n *\/",4],["T_WHITESPACE","\n\n",40],["T_DOC_COMMENT","\/**\n * Generate a random value.\n *\n * On 32-bit machines, the largest distance that can exist between $min and $max is 2**31.\n * If $min and $max are farther apart than that then the last ($max - range) numbers.\n *\n * Depending on how this is being used, it may be worth while to write a replacement.  For example,\n * a PHP-based web app that stores its data in an SQL database can collect more entropy than this function\n * can.\n *\n * @param optional Integer $min\n * @param optional Integer $max\n * @return Integer\n * @access public\n *\/",42],["T_WHITESPACE","\n",56],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","crypt_random",57],"(",["T_VARIABLE","$min",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","0",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$max",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","0x7FFFFFFF",57],")",["T_WHITESPACE","\n",57],"{",["T_WHITESPACE","\n    ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$min",59],["T_WHITESPACE"," ",59],["T_IS_EQUAL","==",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$max",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n        ",59],["T_RETURN","return",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$min",60],";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/\/ see http:\/\/en.wikipedia.org\/wiki\/\/dev\/random\n",63],["T_WHITESPACE","    ",64],["T_COMMENT","\/\/ if open_basedir is enabled file_exists() will ouput an \"open_basedir restriction in effect\" warning,\n",64],["T_WHITESPACE","    ",65],["T_COMMENT","\/\/ so we suppress it.\n",65],["T_WHITESPACE","    ",66],["T_IF","if",66],["T_WHITESPACE"," ",66],"(","@",["T_STRING","file_exists",66],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",66],")",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n        ",66],["T_STATIC","static",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$fp",67],";",["T_WHITESPACE","\n        ",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(","!",["T_VARIABLE","$fp",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$fp",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_STRING","fopen",69],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'rb'",69],")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_STRING","extract",71],"(",["T_STRING","unpack",71],"(",["T_CONSTANT_ENCAPSED_STRING","'Nrandom'",71],",",["T_WHITESPACE"," ",71],["T_STRING","fread",71],"(",["T_VARIABLE","$fp",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","4",71],")",")",")",";",["T_WHITESPACE","\n\n        ",71],["T_COMMENT","\/\/ say $min = 0 and $max = 3.  if we didn't do abs() then we could have stuff like this:\n",73],["T_WHITESPACE","        ",74],["T_COMMENT","\/\/ -4 % 3 + 0 = -1, even though -1 < $min\n",74],["T_WHITESPACE","        ",75],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_STRING","abs",75],"(",["T_VARIABLE","$random",75],")",["T_WHITESPACE"," ",75],"%",["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$max",75],["T_WHITESPACE"," ",75],"-",["T_WHITESPACE"," ",75],["T_VARIABLE","$min",75],")",["T_WHITESPACE"," ",75],"+",["T_WHITESPACE"," ",75],["T_VARIABLE","$min",75],";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_COMMENT","\/* Prior to PHP 4.2.0, mt_srand() had to be called before mt_rand() could be called.\n       Prior to PHP 5.2.6, mt_rand()'s automatic seeding was subpar, as elaborated here:\n\n       http:\/\/www.suspekt.org\/2008\/08\/17\/mt_srand-and-not-so-random-numbers\/\n\n       The seeding routine is pretty much ripped from PHP's own internal GENERATE_SEED() macro:\n\n       http:\/\/svn.php.net\/viewvc\/php\/php-src\/branches\/PHP_5_3_2\/ext\/standard\/php_rand.h?view=markup *\/",78],["T_WHITESPACE","\n    ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_STRING","version_compare",86],"(",["T_STRING","PHP_VERSION",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'5.2.5'",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'<='",86],")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE"," \n        ",86],["T_STATIC","static",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$seeded",87],";",["T_WHITESPACE","\n        ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(","!",["T_ISSET","isset",88],"(",["T_VARIABLE","$seeded",88],")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$seeded",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","true",89],";",["T_WHITESPACE","\n            ",89],["T_STRING","mt_srand",90],"(",["T_STRING","fmod",90],"(",["T_STRING","time",90],"(",")",["T_WHITESPACE"," ",90],"*",["T_WHITESPACE"," ",90],["T_STRING","getmypid",90],"(",")",",",["T_WHITESPACE"," ",90],["T_LNUMBER","0x7FFFFFFF",90],")",["T_WHITESPACE"," ",90],"^",["T_WHITESPACE"," ",90],["T_STRING","fmod",90],"(",["T_LNUMBER","1000000",90],["T_WHITESPACE"," ",90],"*",["T_WHITESPACE"," ",90],["T_STRING","lcg_value",90],"(",")",",",["T_WHITESPACE"," ",90],["T_LNUMBER","0x7FFFFFFF",90],")",")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_STATIC","static",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$crypto",94],";",["T_WHITESPACE","\n\n    ",94],["T_COMMENT","\/\/ The CSPRNG's Yarrow and Fortuna periodically reseed.  This function can be reseeded by hitting F5\n",96],["T_WHITESPACE","    ",97],["T_COMMENT","\/\/ in the browser and reloading the page.\n",97],["T_WHITESPACE","\n    ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_ISSET","isset",99],"(",["T_VARIABLE","$crypto",99],")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$key",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$iv",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","''",100],";",["T_WHITESPACE","\n        ",100],["T_FOR","for",101],["T_WHITESPACE"," ",101],"(",["T_VARIABLE","$i",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_LNUMBER","0",101],";",["T_WHITESPACE"," ",101],["T_VARIABLE","$i",101],["T_WHITESPACE"," ",101],"<",["T_WHITESPACE"," ",101],["T_LNUMBER","8",101],";",["T_WHITESPACE"," ",101],["T_VARIABLE","$i",101],["T_INC","++",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$key",102],["T_CONCAT_EQUAL",".=",102],["T_WHITESPACE"," ",102],["T_STRING","pack",102],"(",["T_CONSTANT_ENCAPSED_STRING","'n'",102],",",["T_WHITESPACE"," ",102],["T_STRING","mt_rand",102],"(",["T_LNUMBER","0",102],",",["T_WHITESPACE"," ",102],["T_LNUMBER","0xFFFF",102],")",")",";",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$iv",103],["T_WHITESPACE"," ",103],["T_CONCAT_EQUAL",".=",103],["T_WHITESPACE"," ",103],["T_STRING","pack",103],"(",["T_CONSTANT_ENCAPSED_STRING","'n'",103],",",["T_WHITESPACE"," ",103],["T_STRING","mt_rand",103],"(",["T_LNUMBER","0",103],",",["T_WHITESPACE"," ",103],["T_LNUMBER","0xFFFF",103],")",")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_SWITCH","switch",105],["T_WHITESPACE"," ",105],"(",["T_STRING","true",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_CASE","case",106],["T_WHITESPACE"," ",106],["T_STRING","class_exists",106],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_AES'",106],")",":",["T_WHITESPACE","\n                ",106],["T_VARIABLE","$crypto",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","Crypt_AES",107],"(",["T_STRING","CRYPT_AES_MODE_CTR",107],")",";",["T_WHITESPACE","\n                ",107],["T_BREAK","break",108],";",["T_WHITESPACE","\n            ",108],["T_CASE","case",109],["T_WHITESPACE"," ",109],["T_STRING","class_exists",109],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_TripleDES'",109],")",":",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$crypto",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Crypt_TripleDES",110],"(",["T_STRING","CRYPT_DES_MODE_CTR",110],")",";",["T_WHITESPACE","\n                ",110],["T_BREAK","break",111],";",["T_WHITESPACE","\n            ",111],["T_CASE","case",112],["T_WHITESPACE"," ",112],["T_STRING","class_exists",112],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_DES'",112],")",":",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$crypto",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Crypt_DES",113],"(",["T_STRING","CRYPT_DES_MODE_CTR",113],")",";",["T_WHITESPACE","\n                ",113],["T_BREAK","break",114],";",["T_WHITESPACE","\n            ",114],["T_CASE","case",115],["T_WHITESPACE"," ",115],["T_STRING","class_exists",115],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_RC4'",115],")",":",["T_WHITESPACE","\n                ",115],["T_VARIABLE","$crypto",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_STRING","Crypt_RC4",116],"(",")",";",["T_WHITESPACE","\n                ",116],["T_BREAK","break",117],";",["T_WHITESPACE","\n            ",117],["T_DEFAULT","default",118],":",["T_WHITESPACE","\n                ",118],["T_STRING","extract",119],"(",["T_STRING","unpack",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Nrandom'",119],",",["T_WHITESPACE"," ",119],["T_STRING","pack",119],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",119],",",["T_WHITESPACE"," ",119],["T_STRING","sha1",119],"(",["T_STRING","mt_rand",119],"(",["T_LNUMBER","0",119],",",["T_WHITESPACE"," ",119],["T_LNUMBER","0x7FFFFFFF",119],")",")",")",")",")",";",["T_WHITESPACE","\n                ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_STRING","abs",120],"(",["T_VARIABLE","$random",120],")",["T_WHITESPACE"," ",120],"%",["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$max",120],["T_WHITESPACE"," ",120],"-",["T_WHITESPACE"," ",120],["T_VARIABLE","$min",120],")",["T_WHITESPACE"," ",120],"+",["T_WHITESPACE"," ",120],["T_VARIABLE","$min",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$crypto",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setKey",122],"(",["T_VARIABLE","$key",122],")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$crypto",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","setIV",123],"(",["T_VARIABLE","$iv",123],")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$crypto",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","enableContinuousBuffer",124],"(",")",";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_STRING","extract",127],"(",["T_STRING","unpack",127],"(",["T_CONSTANT_ENCAPSED_STRING","'Nrandom'",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$crypto",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","encrypt",127],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\"",127],")",")",")",";",["T_WHITESPACE","\n    ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_STRING","abs",128],"(",["T_VARIABLE","$random",128],")",["T_WHITESPACE"," ",128],"%",["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$max",128],["T_WHITESPACE"," ",128],"-",["T_WHITESPACE"," ",128],["T_VARIABLE","$min",128],")",["T_WHITESPACE"," ",128],"+",["T_WHITESPACE"," ",128],["T_VARIABLE","$min",128],";",["T_WHITESPACE","\n",128],"}",["T_WHITESPACE","\n",129]]