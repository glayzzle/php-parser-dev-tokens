[["T_OPEN_TAG","<?php\n",1],["T_COMMENT","\/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: *\/",2],["T_WHITESPACE","\n\n",2],["T_DOC_COMMENT","\/**\n * Pure-PHP PKCS#1 (v2.1) compliant implementation of RSA.\n *\n * PHP versions 4 and 5\n *\n * Here's an example of how to encrypt and decrypt text with this library:\n * <code>\n * <?php\n *    include('Crypt\/RSA.php');\n *\n *    $rsa = new Crypt_RSA();\n *    extract($rsa->createKey());\n *\n *    $plaintext = 'terrafrost';\n *\n *    $rsa->loadKey($privatekey);\n *    $ciphertext = $rsa->encrypt($plaintext);\n *\n *    $rsa->loadKey($publickey);\n *    echo $rsa->decrypt($ciphertext);\n * ?>\n * <\/code>\n *\n * Here's an example of how to create signatures and verify signatures with this library:\n * <code>\n * <?php\n *    include('Crypt\/RSA.php');\n *\n *    $rsa = new Crypt_RSA();\n *    extract($rsa->createKey());\n *\n *    $plaintext = 'terrafrost';\n *\n *    $rsa->loadKey($privatekey);\n *    $signature = $rsa->sign($plaintext);\n *\n *    $rsa->loadKey($publickey);\n *    echo $rsa->verify($plaintext, $signature) ? 'verified' : 'unverified';\n * ?>\n * <\/code>\n *\n * LICENSE: This library is free software; you can redistribute it and\/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place, Suite 330, Boston,\n * MA  02111-1307  USA\n *\n * @category   Crypt\n * @package    Crypt_RSA\n * @author     Jim Wigginton <terrafrost@php.net>\n * @copyright  MMIX Jim Wigginton\n * @license    http:\/\/www.gnu.org\/licenses\/lgpl.txt\n * @version    $Id: RSA.php,v 1.15 2010\/04\/10 15:57:02 terrafrost Exp $\n * @link       http:\/\/phpseclib.sourceforge.net\n *\/",4],["T_WHITESPACE","\n\n",67],["T_DOC_COMMENT","\/**\n * Include Math_BigInteger\n *\/",69],["T_WHITESPACE","\n",71],["T_REQUIRE_ONCE","require_once",72],"(",["T_CONSTANT_ENCAPSED_STRING","'Math\/BigInteger.php'",72],")",";",["T_WHITESPACE","\n\n",72],["T_DOC_COMMENT","\/**\n * Include Crypt_Random\n *\/",74],["T_WHITESPACE","\n",76],["T_REQUIRE_ONCE","require_once",77],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt\/Random.php'",77],")",";",["T_WHITESPACE","\n\n",77],["T_DOC_COMMENT","\/**\n * Include Crypt_Hash\n *\/",79],["T_WHITESPACE","\n",81],["T_REQUIRE_ONCE","require_once",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt\/Hash.php'",82],")",";",["T_WHITESPACE","\n\n",82],["T_COMMENT","\/**#@+\n * @access public\n * @see Crypt_RSA::encrypt()\n * @see Crypt_RSA::decrypt()\n *\/",84],["T_WHITESPACE","\n",88],["T_DOC_COMMENT","\/**\n * Use {@link http:\/\/en.wikipedia.org\/wiki\/Optimal_Asymmetric_Encryption_Padding Optimal Asymmetric Encryption Padding}\n * (OAEP) for encryption \/ decryption.\n *\n * Uses sha1 by default.\n *\n * @see Crypt_RSA::setHash()\n * @see Crypt_RSA::setMGFHash()\n *\/",89],["T_WHITESPACE","\n",97],["T_STRING","define",98],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_ENCRYPTION_OAEP'",98],",",["T_WHITESPACE","  ",98],["T_LNUMBER","1",98],")",";",["T_WHITESPACE","\n",98],["T_DOC_COMMENT","\/**\n * Use PKCS#1 padding.\n *\n * Although CRYPT_RSA_ENCRYPTION_OAEP offers more security, including PKCS#1 padding is necessary for purposes of backwards\n * compatability with protocols (like SSH-1) written before OAEP's introduction.\n *\/",99],["T_WHITESPACE","\n",104],["T_STRING","define",105],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_ENCRYPTION_PKCS1'",105],",",["T_WHITESPACE"," ",105],["T_LNUMBER","2",105],")",";",["T_WHITESPACE","\n",105],["T_COMMENT","\/**#@-*\/",106],["T_WHITESPACE","\n\n",106],["T_COMMENT","\/**#@+\n * @access public\n * @see Crypt_RSA::sign()\n * @see Crypt_RSA::verify()\n * @see Crypt_RSA::setHash()\n *\/",108],["T_WHITESPACE","\n",113],["T_DOC_COMMENT","\/**\n * Use the Probabilistic Signature Scheme for signing\n *\n * Uses sha1 by default.\n *\n * @see Crypt_RSA::setSaltLength()\n * @see Crypt_RSA::setMGFHash()\n *\/",114],["T_WHITESPACE","\n",121],["T_STRING","define",122],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_SIGNATURE_PSS'",122],",",["T_WHITESPACE","  ",122],["T_LNUMBER","1",122],")",";",["T_WHITESPACE","\n",122],["T_DOC_COMMENT","\/**\n * Use the PKCS#1 scheme by default.\n *\n * Although CRYPT_RSA_SIGNATURE_PSS offers more security, including PKCS#1 signing is necessary for purposes of backwards\n * compatability with protocols (like SSH-2) written before PSS's introduction.\n *\/",123],["T_WHITESPACE","\n",128],["T_STRING","define",129],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_SIGNATURE_PKCS1'",129],",",["T_WHITESPACE"," ",129],["T_LNUMBER","2",129],")",";",["T_WHITESPACE","\n",129],["T_COMMENT","\/**#@-*\/",130],["T_WHITESPACE","\n\n",130],["T_COMMENT","\/**#@+\n * @access private\n * @see Crypt_RSA::createKey()\n *\/",132],["T_WHITESPACE","\n",135],["T_DOC_COMMENT","\/**\n * ASN1 Integer\n *\/",136],["T_WHITESPACE","\n",138],["T_STRING","define",139],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_ASN1_INTEGER'",139],",",["T_WHITESPACE","   ",139],["T_LNUMBER","2",139],")",";",["T_WHITESPACE","\n",139],["T_DOC_COMMENT","\/**\n * ASN1 Sequence (with the constucted bit set)\n *\/",140],["T_WHITESPACE","\n",142],["T_STRING","define",143],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_ASN1_SEQUENCE'",143],",",["T_WHITESPACE"," ",143],["T_LNUMBER","48",143],")",";",["T_WHITESPACE","\n",143],["T_COMMENT","\/**#@-*\/",144],["T_WHITESPACE","\n\n",144],["T_COMMENT","\/**#@+\n * @access private\n * @see Crypt_RSA::Crypt_RSA()\n *\/",146],["T_WHITESPACE","\n",149],["T_DOC_COMMENT","\/**\n * To use the pure-PHP implementation\n *\/",150],["T_WHITESPACE","\n",152],["T_STRING","define",153],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_MODE_INTERNAL'",153],",",["T_WHITESPACE"," ",153],["T_LNUMBER","1",153],")",";",["T_WHITESPACE","\n",153],["T_DOC_COMMENT","\/**\n * To use the OpenSSL library\n *\n * (if enabled; otherwise, the internal implementation will be used)\n *\/",154],["T_WHITESPACE","\n",158],["T_STRING","define",159],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_MODE_OPENSSL'",159],",",["T_WHITESPACE"," ",159],["T_LNUMBER","2",159],")",";",["T_WHITESPACE","\n",159],["T_COMMENT","\/**#@-*\/",160],["T_WHITESPACE","\n\n",160],["T_COMMENT","\/**#@+\n * @access public\n * @see Crypt_RSA::createKey()\n * @see Crypt_RSA::setPrivateKeyFormat()\n *\/",162],["T_WHITESPACE","\n",166],["T_DOC_COMMENT","\/**\n * PKCS#1 formatted private key\n *\n * Used by OpenSSH\n *\/",167],["T_WHITESPACE","\n",171],["T_STRING","define",172],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_PRIVATE_FORMAT_PKCS1'",172],",",["T_WHITESPACE"," ",172],["T_LNUMBER","0",172],")",";",["T_WHITESPACE","\n",172],["T_COMMENT","\/**#@-*\/",173],["T_WHITESPACE","\n\n",173],["T_COMMENT","\/**#@+\n * @access public\n * @see Crypt_RSA::createKey()\n * @see Crypt_RSA::setPublicKeyFormat()\n *\/",175],["T_WHITESPACE","\n",179],["T_DOC_COMMENT","\/**\n * Raw public key\n *\n * An array containing two Math_BigInteger objects.\n *\n * The exponent can be indexed with any of the following:\n *\n * 0, e, exponent, publicExponent\n *\n * The modulus can be indexed with any of the following:\n *\n * 1, n, modulo, modulus\n *\/",180],["T_WHITESPACE","\n",192],["T_STRING","define",193],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_PUBLIC_FORMAT_RAW'",193],",",["T_WHITESPACE"," ",193],["T_LNUMBER","1",193],")",";",["T_WHITESPACE","\n",193],["T_DOC_COMMENT","\/**\n * PKCS#1 formatted public key\n *\/",194],["T_WHITESPACE","\n",196],["T_STRING","define",197],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_PUBLIC_FORMAT_PKCS1'",197],",",["T_WHITESPACE"," ",197],["T_LNUMBER","2",197],")",";",["T_WHITESPACE","\n",197],["T_DOC_COMMENT","\/**\n * OpenSSH formatted public key\n *\n * Place in $HOME\/.ssh\/authorized_keys\n *\/",198],["T_WHITESPACE","\n",202],["T_STRING","define",203],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_PUBLIC_FORMAT_OPENSSH'",203],",",["T_WHITESPACE"," ",203],["T_LNUMBER","3",203],")",";",["T_WHITESPACE","\n",203],["T_COMMENT","\/**#@-*\/",204],["T_WHITESPACE","\n\n",204],["T_DOC_COMMENT","\/**\n * Pure-PHP PKCS#1 compliant implementation of RSA.\n *\n * @author  Jim Wigginton <terrafrost@php.net>\n * @version 0.1.0\n * @access  public\n * @package Crypt_RSA\n *\/",206],["T_WHITESPACE","\n",213],["T_CLASS","class",214],["T_WHITESPACE"," ",214],["T_STRING","Crypt_RSA",214],["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n    ",214],["T_DOC_COMMENT","\/**\n     * Precomputed Zero\n     *\n     * @var Array\n     * @access private\n     *\/",215],["T_WHITESPACE","\n    ",220],["T_VAR","var",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$zero",221],";",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Precomputed One\n     *\n     * @var Array\n     * @access private\n     *\/",223],["T_WHITESPACE","\n    ",228],["T_VAR","var",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$one",229],";",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * Private Key Format\n     *\n     * @var Integer\n     * @access private\n     *\/",231],["T_WHITESPACE","\n    ",236],["T_VAR","var",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$privateKeyFormat",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_STRING","CRYPT_RSA_PRIVATE_FORMAT_PKCS1",237],";",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Public Key Format\n     *\n     * @var Integer\n     * @access public\n     *\/",239],["T_WHITESPACE","\n    ",244],["T_VAR","var",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$publicKeyFormat",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_PKCS1",245],";",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Modulus (ie. n)\n     *\n     * @var Math_BigInteger\n     * @access private\n     *\/",247],["T_WHITESPACE","\n    ",252],["T_VAR","var",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$modulus",253],";",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Modulus length\n     *\n     * @var Math_BigInteger\n     * @access private\n     *\/",255],["T_WHITESPACE","\n    ",260],["T_VAR","var",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$k",261],";",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Exponent (ie. e or d)\n     *\n     * @var Math_BigInteger\n     * @access private\n     *\/",263],["T_WHITESPACE","\n    ",268],["T_VAR","var",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$exponent",269],";",["T_WHITESPACE","\n\n    ",269],["T_DOC_COMMENT","\/**\n     * Primes for Chinese Remainder Theorem (ie. p and q)\n     *\n     * @var Array\n     * @access private\n     *\/",271],["T_WHITESPACE","\n    ",276],["T_VAR","var",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$primes",277],";",["T_WHITESPACE","\n\n    ",277],["T_DOC_COMMENT","\/**\n     * Exponents for Chinese Remainder Theorem (ie. dP and dQ)\n     *\n     * @var Array\n     * @access private\n     *\/",279],["T_WHITESPACE","\n    ",284],["T_VAR","var",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$exponents",285],";",["T_WHITESPACE","\n\n    ",285],["T_DOC_COMMENT","\/**\n     * Coefficients for Chinese Remainder Theorem (ie. qInv)\n     *\n     * @var Array\n     * @access private\n     *\/",287],["T_WHITESPACE","\n    ",292],["T_VAR","var",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$coefficients",293],";",["T_WHITESPACE","\n\n    ",293],["T_DOC_COMMENT","\/**\n     * Hash name\n     *\n     * @var String\n     * @access private\n     *\/",295],["T_WHITESPACE","\n    ",300],["T_VAR","var",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$hashName",301],";",["T_WHITESPACE","\n\n    ",301],["T_DOC_COMMENT","\/**\n     * Hash function\n     *\n     * @var Crypt_Hash\n     * @access private\n     *\/",303],["T_WHITESPACE","\n    ",308],["T_VAR","var",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$hash",309],";",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * Length of hash function output\n     *\n     * @var Integer\n     * @access private\n     *\/",311],["T_WHITESPACE","\n    ",316],["T_VAR","var",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$hLen",317],";",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Length of salt\n     *\n     * @var Integer\n     * @access private\n     *\/",319],["T_WHITESPACE","\n    ",324],["T_VAR","var",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$sLen",325],";",["T_WHITESPACE","\n\n    ",325],["T_DOC_COMMENT","\/**\n     * Hash function for the Mask Generation Function\n     *\n     * @var Crypt_Hash\n     * @access private\n     *\/",327],["T_WHITESPACE","\n    ",332],["T_VAR","var",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$mgfHash",333],";",["T_WHITESPACE","\n\n    ",333],["T_DOC_COMMENT","\/**\n     * Length of MGF hash function output\n     *\n     * @var Integer\n     * @access private\n     *\/",335],["T_WHITESPACE","\n    ",340],["T_VAR","var",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$mgfHLen",341],";",["T_WHITESPACE","\n\n    ",341],["T_DOC_COMMENT","\/**\n     * Encryption mode\n     *\n     * @var Integer\n     * @access private\n     *\/",343],["T_WHITESPACE","\n    ",348],["T_VAR","var",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$encryptionMode",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_STRING","CRYPT_RSA_ENCRYPTION_OAEP",349],";",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * Signature mode\n     *\n     * @var Integer\n     * @access private\n     *\/",351],["T_WHITESPACE","\n    ",356],["T_VAR","var",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$signatureMode",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_STRING","CRYPT_RSA_SIGNATURE_PSS",357],";",["T_WHITESPACE","\n\n    ",357],["T_DOC_COMMENT","\/**\n     * Public Exponent\n     *\n     * @var Mixed\n     * @access private\n     *\/",359],["T_WHITESPACE","\n    ",364],["T_VAR","var",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$publicExponent",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_STRING","false",365],";",["T_WHITESPACE","\n\n    ",365],["T_DOC_COMMENT","\/**\n     * Password\n     *\n     * @var String\n     * @access private\n     *\/",367],["T_WHITESPACE","\n    ",372],["T_VAR","var",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$password",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","''",373],";",["T_WHITESPACE","\n\n    ",373],["T_DOC_COMMENT","\/**\n     * The constructor\n     *\n     * If you want to make use of the openssl extension, you'll need to set the mode manually, yourself.  The reason\n     * Crypt_RSA doesn't do it is because OpenSSL doesn't fail gracefully.  openssl_pkey_new(), in particular, requires\n     * openssl.cnf be present somewhere and, unfortunately, the only real way to find out is too late.\n     *\n     * @return Crypt_RSA\n     * @access public\n     *\/",375],["T_WHITESPACE","\n    ",384],["T_FUNCTION","function",385],["T_WHITESPACE"," ",385],["T_STRING","Crypt_RSA",385],"(",")",["T_WHITESPACE","\n    ",385],"{",["T_WHITESPACE","\n        ",386],["T_IF","if",387],["T_WHITESPACE"," ",387],"(",["T_WHITESPACE"," ",387],"!",["T_STRING","defined",387],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_MODE'",387],")",["T_WHITESPACE"," ",387],")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n            ",387],["T_SWITCH","switch",388],["T_WHITESPACE"," ",388],"(",["T_STRING","true",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_COMMENT","\/\/case extension_loaded('openssl') && version_compare(PHP_VERSION, '4.2.0', '>='):\n",389],["T_WHITESPACE","                ",390],["T_COMMENT","\/\/    define('CRYPT_RSA_MODE', CRYPT_RSA_MODE_OPENSSL);\n",390],["T_WHITESPACE","                ",391],["T_COMMENT","\/\/    break;\n",391],["T_WHITESPACE","                ",392],["T_DEFAULT","default",392],":",["T_WHITESPACE","\n                    ",392],["T_STRING","define",393],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_MODE'",393],",",["T_WHITESPACE"," ",393],["T_STRING","CRYPT_RSA_MODE_INTERNAL",393],")",";",["T_WHITESPACE","\n            ",393],"}",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n\n        ",395],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","zero",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_NEW","new",397],["T_WHITESPACE"," ",397],["T_STRING","Math_BigInteger",397],"(",")",";",["T_WHITESPACE","\n        ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","one",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_NEW","new",398],["T_WHITESPACE"," ",398],["T_STRING","Math_BigInteger",398],"(",["T_LNUMBER","1",398],")",";",["T_WHITESPACE","\n\n        ",398],["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","hash",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_NEW","new",400],["T_WHITESPACE"," ",400],["T_STRING","Crypt_Hash",400],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1'",400],")",";",["T_WHITESPACE","\n        ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","hLen",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","hash",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getLength",401],"(",")",";",["T_WHITESPACE","\n        ",401],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","hashName",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'sha1'",402],";",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","mgfHash",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_NEW","new",403],["T_WHITESPACE"," ",403],["T_STRING","Crypt_Hash",403],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1'",403],")",";",["T_WHITESPACE","\n        ",403],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","mgfHLen",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","mgfHash",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","getLength",404],"(",")",";",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_DOC_COMMENT","\/**\n     * Create public \/ private key pair\n     *\n     * Returns an array with the following three elements:\n     *  - 'privatekey': The private key.\n     *  - 'publickey':  The public key.\n     *  - 'partialkey': A partially computed key (if the execution time exceeded $timeout).\n     *                  Will need to be passed back to Crypt_RSA::createKey() as the third parameter for further processing.\n     *\n     * @access public\n     * @param optional Integer $bits\n     * @param optional Integer $timeout\n     * @param optional Math_BigInteger $p\n     *\/",407],["T_WHITESPACE","\n    ",420],["T_FUNCTION","function",421],["T_WHITESPACE"," ",421],["T_STRING","createKey",421],"(",["T_VARIABLE","$bits",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_LNUMBER","1024",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$timeout",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","false",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$partial",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_ARRAY","array",421],"(",")",")",["T_WHITESPACE","\n    ",421],"{",["T_WHITESPACE","\n        ",422],["T_IF","if",423],["T_WHITESPACE"," ",423],"(",["T_WHITESPACE"," ",423],["T_STRING","CRYPT_RSA_MODE",423],["T_WHITESPACE"," ",423],["T_IS_EQUAL","==",423],["T_WHITESPACE"," ",423],["T_STRING","CRYPT_RSA_MODE_OPENSSL",423],["T_WHITESPACE"," ",423],")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n            ",423],["T_VARIABLE","$rsa",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_STRING","openssl_pkey_new",424],"(",["T_ARRAY","array",424],"(",["T_CONSTANT_ENCAPSED_STRING","'private_key_bits'",424],["T_WHITESPACE"," ",424],["T_DOUBLE_ARROW","=>",424],["T_WHITESPACE"," ",424],["T_VARIABLE","$bits",424],")",")",";",["T_WHITESPACE","\n            ",424],["T_STRING","openssl_pkey_export",425],"(",["T_VARIABLE","$rsa",425],",",["T_WHITESPACE"," ",425],["T_VARIABLE","$privatekey",425],")",";",["T_WHITESPACE","\n            ",425],["T_VARIABLE","$publickey",426],["T_WHITESPACE"," ",426],"=",["T_WHITESPACE"," ",426],["T_STRING","openssl_pkey_get_details",426],"(",["T_VARIABLE","$rsa",426],")",";",["T_WHITESPACE","\n            ",426],["T_VARIABLE","$publickey",427],["T_WHITESPACE"," ",427],"=",["T_WHITESPACE"," ",427],["T_VARIABLE","$publickey",427],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",427],"]",";",["T_WHITESPACE","\n\n            ",427],["T_IF","if",429],["T_WHITESPACE"," ",429],"(",["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","privateKeyFormat",429],["T_WHITESPACE"," ",429],["T_IS_NOT_EQUAL","!=",429],["T_WHITESPACE"," ",429],["T_STRING","CRYPT_RSA_PRIVATE_FORMAT_PKCS1",429],")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n                ",429],["T_VARIABLE","$privatekey",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_STRING","call_user_func_array",430],"(",["T_ARRAY","array",430],"(",["T_VARIABLE","$this",430],",",["T_WHITESPACE"," ",430],["T_CONSTANT_ENCAPSED_STRING","'_convertPrivateKey'",430],")",",",["T_WHITESPACE"," ",430],["T_STRING","array_values",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_parseKey",430],"(",["T_VARIABLE","$privatekey",430],",",["T_WHITESPACE"," ",430],["T_STRING","CRYPT_RSA_PRIVATE_FORMAT_PKCS1",430],")",")",")",";",["T_WHITESPACE","\n                ",430],["T_VARIABLE","$publickey",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_STRING","call_user_func_array",431],"(",["T_ARRAY","array",431],"(",["T_VARIABLE","$this",431],",",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'_convertPublicKey'",431],")",",",["T_WHITESPACE"," ",431],["T_STRING","array_values",431],"(",["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","_parseKey",431],"(",["T_VARIABLE","$publickey",431],",",["T_WHITESPACE"," ",431],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_PKCS1",431],")",")",")",";",["T_WHITESPACE","\n            ",431],"}",["T_WHITESPACE","\n\n            ",432],["T_RETURN","return",434],["T_WHITESPACE"," ",434],["T_ARRAY","array",434],"(",["T_WHITESPACE","\n                ",434],["T_CONSTANT_ENCAPSED_STRING","'privatekey'",435],["T_WHITESPACE"," ",435],["T_DOUBLE_ARROW","=>",435],["T_WHITESPACE"," ",435],["T_VARIABLE","$privatekey",435],",",["T_WHITESPACE","\n                ",435],["T_CONSTANT_ENCAPSED_STRING","'publickey'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$publickey",436],",",["T_WHITESPACE","\n                ",436],["T_CONSTANT_ENCAPSED_STRING","'partialkey'",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],["T_STRING","false",437],["T_WHITESPACE","\n            ",437],")",";",["T_WHITESPACE","\n        ",438],"}",["T_WHITESPACE","\n\n        ",439],["T_STATIC","static",441],["T_WHITESPACE"," ",441],["T_VARIABLE","$e",441],";",["T_WHITESPACE","\n        ",441],["T_IF","if",442],["T_WHITESPACE"," ",442],"(","!",["T_ISSET","isset",442],"(",["T_VARIABLE","$e",442],")",")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n            ",442],["T_IF","if",443],["T_WHITESPACE"," ",443],"(","!",["T_STRING","defined",443],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_EXPONENT'",443],")",")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n                ",443],["T_COMMENT","\/\/ http:\/\/en.wikipedia.org\/wiki\/65537_%28number%29\n",444],["T_WHITESPACE","                ",445],["T_STRING","define",445],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_EXPONENT'",445],",",["T_WHITESPACE"," ",445],["T_CONSTANT_ENCAPSED_STRING","'65537'",445],")",";",["T_WHITESPACE","\n            ",445],"}",["T_WHITESPACE","\n            ",446],["T_IF","if",447],["T_WHITESPACE"," ",447],"(","!",["T_STRING","defined",447],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_COMMENT'",447],")",")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n                ",447],["T_STRING","define",448],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_COMMENT'",448],",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'phpseclib-generated-key'",448],")",";",["T_WHITESPACE","\n            ",448],"}",["T_WHITESPACE","\n            ",449],["T_COMMENT","\/\/ per <http:\/\/cseweb.ucsd.edu\/~hovav\/dist\/survey.pdf#page=5>, this number ought not result in primes smaller\n",450],["T_WHITESPACE","            ",451],["T_COMMENT","\/\/ than 256 bits.\n",451],["T_WHITESPACE","            ",452],["T_IF","if",452],["T_WHITESPACE"," ",452],"(","!",["T_STRING","defined",452],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_SMALLEST_PRIME'",452],")",")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n                ",452],["T_STRING","define",453],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_SMALLEST_PRIME'",453],",",["T_WHITESPACE"," ",453],["T_LNUMBER","4096",453],")",";",["T_WHITESPACE","\n            ",453],"}",["T_WHITESPACE","\n\n            ",454],["T_VARIABLE","$e",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_NEW","new",456],["T_WHITESPACE"," ",456],["T_STRING","Math_BigInteger",456],"(",["T_STRING","CRYPT_RSA_EXPONENT",456],")",";",["T_WHITESPACE","\n        ",456],"}",["T_WHITESPACE","\n\n        ",457],["T_STRING","extract",459],"(",["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","_generateMinMax",459],"(",["T_VARIABLE","$bits",459],")",")",";",["T_WHITESPACE","\n        ",459],["T_VARIABLE","$absoluteMin",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_VARIABLE","$min",460],";",["T_WHITESPACE","\n        ",460],["T_VARIABLE","$temp",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_VARIABLE","$bits",461],["T_WHITESPACE"," ",461],["T_SR",">>",461],["T_WHITESPACE"," ",461],["T_LNUMBER","1",461],";",["T_WHITESPACE","\n        ",461],["T_IF","if",462],["T_WHITESPACE"," ",462],"(",["T_VARIABLE","$temp",462],["T_WHITESPACE"," ",462],">",["T_WHITESPACE"," ",462],["T_STRING","CRYPT_RSA_SMALLEST_PRIME",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_VARIABLE","$num_primes",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_STRING","floor",463],"(",["T_VARIABLE","$bits",463],["T_WHITESPACE"," ",463],"\/",["T_WHITESPACE"," ",463],["T_STRING","CRYPT_RSA_SMALLEST_PRIME",463],")",";",["T_WHITESPACE","\n            ",463],["T_VARIABLE","$temp",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_STRING","CRYPT_RSA_SMALLEST_PRIME",464],";",["T_WHITESPACE","\n        ",464],"}",["T_WHITESPACE"," ",465],["T_ELSE","else",465],["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n            ",465],["T_VARIABLE","$num_primes",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_LNUMBER","2",466],";",["T_WHITESPACE","\n        ",466],"}",["T_WHITESPACE","\n        ",467],["T_STRING","extract",468],"(",["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_generateMinMax",468],"(",["T_VARIABLE","$temp",468],["T_WHITESPACE"," ",468],"+",["T_WHITESPACE"," ",468],["T_VARIABLE","$bits",468],["T_WHITESPACE"," ",468],"%",["T_WHITESPACE"," ",468],["T_VARIABLE","$temp",468],")",")",";",["T_WHITESPACE","\n        ",468],["T_VARIABLE","$finalMax",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$max",469],";",["T_WHITESPACE","\n        ",469],["T_STRING","extract",470],"(",["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","_generateMinMax",470],"(",["T_VARIABLE","$temp",470],")",")",";",["T_WHITESPACE","\n\n        ",470],["T_VARIABLE","$generator",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_NEW","new",472],["T_WHITESPACE"," ",472],["T_STRING","Math_BigInteger",472],"(",")",";",["T_WHITESPACE","\n        ",472],["T_VARIABLE","$generator",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","setRandomGenerator",473],"(",["T_CONSTANT_ENCAPSED_STRING","'crypt_random'",473],")",";",["T_WHITESPACE","\n\n        ",473],["T_VARIABLE","$n",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_VARIABLE","$this",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","one",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","copy",475],"(",")",";",["T_WHITESPACE","\n        ",475],["T_IF","if",476],["T_WHITESPACE"," ",476],"(","!",["T_EMPTY","empty",476],"(",["T_VARIABLE","$partial",476],")",")",["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n            ",476],["T_STRING","extract",477],"(",["T_STRING","unserialize",477],"(",["T_VARIABLE","$partial",477],")",")",";",["T_WHITESPACE","\n        ",477],"}",["T_WHITESPACE"," ",478],["T_ELSE","else",478],["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n            ",478],["T_VARIABLE","$exponents",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_VARIABLE","$coefficients",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_VARIABLE","$primes",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_ARRAY","array",479],"(",")",";",["T_WHITESPACE","\n            ",479],["T_VARIABLE","$lcm",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_ARRAY","array",480],"(",["T_WHITESPACE","\n                ",480],["T_CONSTANT_ENCAPSED_STRING","'top'",481],["T_WHITESPACE"," ",481],["T_DOUBLE_ARROW","=>",481],["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","one",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","copy",481],"(",")",",",["T_WHITESPACE","\n                ",481],["T_CONSTANT_ENCAPSED_STRING","'bottom'",482],["T_WHITESPACE"," ",482],["T_DOUBLE_ARROW","=>",482],["T_WHITESPACE"," ",482],["T_STRING","false",482],["T_WHITESPACE","\n            ",482],")",";",["T_WHITESPACE","\n        ",483],"}",["T_WHITESPACE","\n\n        ",484],["T_VARIABLE","$start",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_STRING","time",486],"(",")",";",["T_WHITESPACE","\n        ",486],["T_VARIABLE","$i0",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_STRING","count",487],"(",["T_VARIABLE","$primes",487],")",["T_WHITESPACE"," ",487],"+",["T_WHITESPACE"," ",487],["T_LNUMBER","1",487],";",["T_WHITESPACE","\n\n        ",487],["T_DO","do",489],["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n            ",489],["T_FOR","for",490],["T_WHITESPACE"," ",490],"(",["T_VARIABLE","$i",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_VARIABLE","$i0",490],";",["T_WHITESPACE"," ",490],["T_VARIABLE","$i",490],["T_WHITESPACE"," ",490],["T_IS_SMALLER_OR_EQUAL","<=",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$num_primes",490],";",["T_WHITESPACE"," ",490],["T_VARIABLE","$i",490],["T_INC","++",490],")",["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n                ",490],["T_IF","if",491],["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$timeout",491],["T_WHITESPACE"," ",491],["T_IS_NOT_IDENTICAL","!==",491],["T_WHITESPACE"," ",491],["T_STRING","false",491],")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n                    ",491],["T_VARIABLE","$timeout",492],["T_MINUS_EQUAL","-=",492],["T_WHITESPACE"," ",492],["T_STRING","time",492],"(",")",["T_WHITESPACE"," ",492],"-",["T_WHITESPACE"," ",492],["T_VARIABLE","$start",492],";",["T_WHITESPACE","\n                    ",492],["T_VARIABLE","$start",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_STRING","time",493],"(",")",";",["T_WHITESPACE","\n                    ",493],["T_IF","if",494],["T_WHITESPACE"," ",494],"(",["T_VARIABLE","$timeout",494],["T_WHITESPACE"," ",494],["T_IS_SMALLER_OR_EQUAL","<=",494],["T_WHITESPACE"," ",494],["T_LNUMBER","0",494],")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n                        ",494],["T_RETURN","return",495],["T_WHITESPACE"," ",495],["T_STRING","serialize",495],"(",["T_ARRAY","array",495],"(",["T_WHITESPACE","\n                            ",495],["T_CONSTANT_ENCAPSED_STRING","'privatekey'",496],["T_WHITESPACE"," ",496],["T_DOUBLE_ARROW","=>",496],["T_WHITESPACE"," ",496],["T_CONSTANT_ENCAPSED_STRING","''",496],",",["T_WHITESPACE","\n                            ",496],["T_CONSTANT_ENCAPSED_STRING","'publickey'",497],["T_WHITESPACE","  ",497],["T_DOUBLE_ARROW","=>",497],["T_WHITESPACE"," ",497],["T_CONSTANT_ENCAPSED_STRING","''",497],",",["T_WHITESPACE","\n                            ",497],["T_CONSTANT_ENCAPSED_STRING","'partialkey'",498],["T_WHITESPACE"," ",498],["T_DOUBLE_ARROW","=>",498],["T_WHITESPACE"," ",498],["T_ARRAY","array",498],"(",["T_WHITESPACE","\n                                ",498],["T_CONSTANT_ENCAPSED_STRING","'primes'",499],["T_WHITESPACE"," ",499],["T_DOUBLE_ARROW","=>",499],["T_WHITESPACE"," ",499],["T_VARIABLE","$primes",499],",",["T_WHITESPACE","\n                                ",499],["T_CONSTANT_ENCAPSED_STRING","'coefficients'",500],["T_WHITESPACE"," ",500],["T_DOUBLE_ARROW","=>",500],["T_WHITESPACE"," ",500],["T_VARIABLE","$coefficients",500],",",["T_WHITESPACE","\n                                ",500],["T_CONSTANT_ENCAPSED_STRING","'lcm'",501],["T_WHITESPACE"," ",501],["T_DOUBLE_ARROW","=>",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$lcm",501],",",["T_WHITESPACE","\n                                ",501],["T_CONSTANT_ENCAPSED_STRING","'exponents'",502],["T_WHITESPACE"," ",502],["T_DOUBLE_ARROW","=>",502],["T_WHITESPACE"," ",502],["T_VARIABLE","$exponents",502],["T_WHITESPACE","\n                            ",502],")",["T_WHITESPACE","\n                        ",503],")",")",";",["T_WHITESPACE","\n                    ",504],"}",["T_WHITESPACE","\n                ",505],"}",["T_WHITESPACE","\n\n                ",506],["T_IF","if",508],["T_WHITESPACE"," ",508],"(",["T_VARIABLE","$i",508],["T_WHITESPACE"," ",508],["T_IS_EQUAL","==",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$num_primes",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n                    ",508],["T_LIST","list",509],"(",["T_VARIABLE","$min",509],",",["T_WHITESPACE"," ",509],["T_VARIABLE","$temp",509],")",["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_VARIABLE","$absoluteMin",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","divide",509],"(",["T_VARIABLE","$n",509],")",";",["T_WHITESPACE","\n                    ",509],["T_IF","if",510],["T_WHITESPACE"," ",510],"(","!",["T_VARIABLE","$temp",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","equals",510],"(",["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","zero",510],")",")",["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n                        ",510],["T_VARIABLE","$min",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_VARIABLE","$min",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","add",511],"(",["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","one",511],")",";",["T_WHITESPACE"," ",511],["T_COMMENT","\/\/ ie. ceil()\n",511],["T_WHITESPACE","                    ",512],"}",["T_WHITESPACE","\n                    ",512],["T_VARIABLE","$primes",513],"[",["T_VARIABLE","$i",513],"]",["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_VARIABLE","$generator",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","randomPrime",513],"(",["T_VARIABLE","$min",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$finalMax",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$timeout",513],")",";",["T_WHITESPACE","\n                ",513],"}",["T_WHITESPACE"," ",514],["T_ELSE","else",514],["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n                    ",514],["T_VARIABLE","$primes",515],"[",["T_VARIABLE","$i",515],"]",["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_VARIABLE","$generator",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","randomPrime",515],"(",["T_VARIABLE","$min",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$max",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$timeout",515],")",";",["T_WHITESPACE","\n                ",515],"}",["T_WHITESPACE","\n\n                ",516],["T_IF","if",518],["T_WHITESPACE"," ",518],"(",["T_VARIABLE","$primes",518],"[",["T_VARIABLE","$i",518],"]",["T_WHITESPACE"," ",518],["T_IS_IDENTICAL","===",518],["T_WHITESPACE"," ",518],["T_STRING","false",518],")",["T_WHITESPACE"," ",518],"{",["T_WHITESPACE"," ",518],["T_COMMENT","\/\/ if we've reached the timeout\n",518],["T_WHITESPACE","                    ",519],["T_RETURN","return",519],["T_WHITESPACE"," ",519],["T_ARRAY","array",519],"(",["T_WHITESPACE","\n                        ",519],["T_CONSTANT_ENCAPSED_STRING","'privatekey'",520],["T_WHITESPACE"," ",520],["T_DOUBLE_ARROW","=>",520],["T_WHITESPACE"," ",520],["T_CONSTANT_ENCAPSED_STRING","''",520],",",["T_WHITESPACE","\n                        ",520],["T_CONSTANT_ENCAPSED_STRING","'publickey'",521],["T_WHITESPACE","  ",521],["T_DOUBLE_ARROW","=>",521],["T_WHITESPACE"," ",521],["T_CONSTANT_ENCAPSED_STRING","''",521],",",["T_WHITESPACE","\n                        ",521],["T_CONSTANT_ENCAPSED_STRING","'partialkey'",522],["T_WHITESPACE"," ",522],["T_DOUBLE_ARROW","=>",522],["T_WHITESPACE"," ",522],["T_EMPTY","empty",522],"(",["T_VARIABLE","$primes",522],")",["T_WHITESPACE"," ",522],"?",["T_WHITESPACE"," ",522],["T_CONSTANT_ENCAPSED_STRING","''",522],["T_WHITESPACE"," ",522],":",["T_WHITESPACE"," ",522],["T_STRING","serialize",522],"(",["T_ARRAY","array",522],"(",["T_WHITESPACE","\n                            ",522],["T_CONSTANT_ENCAPSED_STRING","'primes'",523],["T_WHITESPACE"," ",523],["T_DOUBLE_ARROW","=>",523],["T_WHITESPACE"," ",523],["T_STRING","array_slice",523],"(",["T_VARIABLE","$primes",523],",",["T_WHITESPACE"," ",523],["T_LNUMBER","0",523],",",["T_WHITESPACE"," ",523],["T_VARIABLE","$i",523],["T_WHITESPACE"," ",523],"-",["T_WHITESPACE"," ",523],["T_LNUMBER","1",523],")",",",["T_WHITESPACE","\n                            ",523],["T_CONSTANT_ENCAPSED_STRING","'coefficients'",524],["T_WHITESPACE"," ",524],["T_DOUBLE_ARROW","=>",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$coefficients",524],",",["T_WHITESPACE","\n                            ",524],["T_CONSTANT_ENCAPSED_STRING","'lcm'",525],["T_WHITESPACE"," ",525],["T_DOUBLE_ARROW","=>",525],["T_WHITESPACE"," ",525],["T_VARIABLE","$lcm",525],",",["T_WHITESPACE","\n                            ",525],["T_CONSTANT_ENCAPSED_STRING","'exponents'",526],["T_WHITESPACE"," ",526],["T_DOUBLE_ARROW","=>",526],["T_WHITESPACE"," ",526],["T_VARIABLE","$exponents",526],["T_WHITESPACE","\n                        ",526],")",")",["T_WHITESPACE","\n                    ",527],")",";",["T_WHITESPACE","\n                ",528],"}",["T_WHITESPACE","\n\n                ",529],["T_COMMENT","\/\/ the first coefficient is calculated differently from the rest\n",531],["T_WHITESPACE","                ",532],["T_COMMENT","\/\/ ie. instead of being $primes[1]->modInverse($primes[2]), it's $primes[2]->modInverse($primes[1])\n",532],["T_WHITESPACE","                ",533],["T_IF","if",533],["T_WHITESPACE"," ",533],"(",["T_VARIABLE","$i",533],["T_WHITESPACE"," ",533],">",["T_WHITESPACE"," ",533],["T_LNUMBER","2",533],")",["T_WHITESPACE"," ",533],"{",["T_WHITESPACE","\n                    ",533],["T_VARIABLE","$coefficients",534],"[",["T_VARIABLE","$i",534],"]",["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_VARIABLE","$n",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","modInverse",534],"(",["T_VARIABLE","$primes",534],"[",["T_VARIABLE","$i",534],"]",")",";",["T_WHITESPACE","\n                ",534],"}",["T_WHITESPACE","\n\n                ",535],["T_VARIABLE","$n",537],["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],["T_VARIABLE","$n",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","multiply",537],"(",["T_VARIABLE","$primes",537],"[",["T_VARIABLE","$i",537],"]",")",";",["T_WHITESPACE","\n\n                ",537],["T_VARIABLE","$temp",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$primes",539],"[",["T_VARIABLE","$i",539],"]",["T_OBJECT_OPERATOR","->",539],["T_STRING","subtract",539],"(",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","one",539],")",";",["T_WHITESPACE","\n\n                ",539],["T_COMMENT","\/\/ textbook RSA implementations use Euler's totient function instead of the least common multiple.\n",541],["T_WHITESPACE","                ",542],["T_COMMENT","\/\/ see http:\/\/en.wikipedia.org\/wiki\/Euler%27s_totient_function\n",542],["T_WHITESPACE","                ",543],["T_VARIABLE","$lcm",543],"[",["T_CONSTANT_ENCAPSED_STRING","'top'",543],"]",["T_WHITESPACE"," ",543],"=",["T_WHITESPACE"," ",543],["T_VARIABLE","$lcm",543],"[",["T_CONSTANT_ENCAPSED_STRING","'top'",543],"]",["T_OBJECT_OPERATOR","->",543],["T_STRING","multiply",543],"(",["T_VARIABLE","$temp",543],")",";",["T_WHITESPACE","\n                ",543],["T_VARIABLE","$lcm",544],"[",["T_CONSTANT_ENCAPSED_STRING","'bottom'",544],"]",["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_VARIABLE","$lcm",544],"[",["T_CONSTANT_ENCAPSED_STRING","'bottom'",544],"]",["T_WHITESPACE"," ",544],["T_IS_IDENTICAL","===",544],["T_WHITESPACE"," ",544],["T_STRING","false",544],["T_WHITESPACE"," ",544],"?",["T_WHITESPACE"," ",544],["T_VARIABLE","$temp",544],["T_WHITESPACE"," ",544],":",["T_WHITESPACE"," ",544],["T_VARIABLE","$lcm",544],"[",["T_CONSTANT_ENCAPSED_STRING","'bottom'",544],"]",["T_OBJECT_OPERATOR","->",544],["T_STRING","gcd",544],"(",["T_VARIABLE","$temp",544],")",";",["T_WHITESPACE","\n\n                ",544],["T_VARIABLE","$exponents",546],"[",["T_VARIABLE","$i",546],"]",["T_WHITESPACE"," ",546],"=",["T_WHITESPACE"," ",546],["T_VARIABLE","$e",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","modInverse",546],"(",["T_VARIABLE","$temp",546],")",";",["T_WHITESPACE","\n            ",546],"}",["T_WHITESPACE","\n\n            ",547],["T_LIST","list",549],"(",["T_VARIABLE","$lcm",549],")",["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_VARIABLE","$lcm",549],"[",["T_CONSTANT_ENCAPSED_STRING","'top'",549],"]",["T_OBJECT_OPERATOR","->",549],["T_STRING","divide",549],"(",["T_VARIABLE","$lcm",549],"[",["T_CONSTANT_ENCAPSED_STRING","'bottom'",549],"]",")",";",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$gcd",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$lcm",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","gcd",550],"(",["T_VARIABLE","$e",550],")",";",["T_WHITESPACE","\n            ",550],["T_VARIABLE","$i0",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_LNUMBER","1",551],";",["T_WHITESPACE","\n        ",551],"}",["T_WHITESPACE"," ",552],["T_WHILE","while",552],["T_WHITESPACE"," ",552],"(","!",["T_VARIABLE","$gcd",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","equals",552],"(",["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","one",552],")",")",";",["T_WHITESPACE","\n\n        ",552],["T_VARIABLE","$d",554],["T_WHITESPACE"," ",554],"=",["T_WHITESPACE"," ",554],["T_VARIABLE","$e",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","modInverse",554],"(",["T_VARIABLE","$lcm",554],")",";",["T_WHITESPACE","\n\n        ",554],["T_VARIABLE","$coefficients",556],"[",["T_LNUMBER","2",556],"]",["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_VARIABLE","$primes",556],"[",["T_LNUMBER","2",556],"]",["T_OBJECT_OPERATOR","->",556],["T_STRING","modInverse",556],"(",["T_VARIABLE","$primes",556],"[",["T_LNUMBER","1",556],"]",")",";",["T_WHITESPACE","\n\n        ",556],["T_COMMENT","\/\/ from <http:\/\/tools.ietf.org\/html\/rfc3447#appendix-A.1.2>:\n",558],["T_WHITESPACE","        ",559],["T_COMMENT","\/\/ RSAPrivateKey ::= SEQUENCE {\n",559],["T_WHITESPACE","        ",560],["T_COMMENT","\/\/     version           Version,\n",560],["T_WHITESPACE","        ",561],["T_COMMENT","\/\/     modulus           INTEGER,  -- n\n",561],["T_WHITESPACE","        ",562],["T_COMMENT","\/\/     publicExponent    INTEGER,  -- e\n",562],["T_WHITESPACE","        ",563],["T_COMMENT","\/\/     privateExponent   INTEGER,  -- d\n",563],["T_WHITESPACE","        ",564],["T_COMMENT","\/\/     prime1            INTEGER,  -- p\n",564],["T_WHITESPACE","        ",565],["T_COMMENT","\/\/     prime2            INTEGER,  -- q\n",565],["T_WHITESPACE","        ",566],["T_COMMENT","\/\/     exponent1         INTEGER,  -- d mod (p-1)\n",566],["T_WHITESPACE","        ",567],["T_COMMENT","\/\/     exponent2         INTEGER,  -- d mod (q-1)\n",567],["T_WHITESPACE","        ",568],["T_COMMENT","\/\/     coefficient       INTEGER,  -- (inverse of q) mod p\n",568],["T_WHITESPACE","        ",569],["T_COMMENT","\/\/     otherPrimeInfos   OtherPrimeInfos OPTIONAL\n",569],["T_WHITESPACE","        ",570],["T_COMMENT","\/\/ }\n",570],["T_WHITESPACE","\n        ",571],["T_RETURN","return",572],["T_WHITESPACE"," ",572],["T_ARRAY","array",572],"(",["T_WHITESPACE","\n            ",572],["T_CONSTANT_ENCAPSED_STRING","'privatekey'",573],["T_WHITESPACE"," ",573],["T_DOUBLE_ARROW","=>",573],["T_WHITESPACE"," ",573],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","_convertPrivateKey",573],"(",["T_VARIABLE","$n",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$e",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$d",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$primes",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$exponents",573],",",["T_WHITESPACE"," ",573],["T_VARIABLE","$coefficients",573],")",",",["T_WHITESPACE","\n            ",573],["T_CONSTANT_ENCAPSED_STRING","'publickey'",574],["T_WHITESPACE","  ",574],["T_DOUBLE_ARROW","=>",574],["T_WHITESPACE"," ",574],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_convertPublicKey",574],"(",["T_VARIABLE","$n",574],",",["T_WHITESPACE"," ",574],["T_VARIABLE","$e",574],")",",",["T_WHITESPACE","\n            ",574],["T_CONSTANT_ENCAPSED_STRING","'partialkey'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_STRING","false",575],["T_WHITESPACE","\n        ",575],")",";",["T_WHITESPACE","\n    ",576],"}",["T_WHITESPACE","\n\n    ",577],["T_DOC_COMMENT","\/**\n     * Convert a private key to the appropriate format.\n     *\n     * @access private\n     * @see setPrivateKeyFormat()\n     * @param String $RSAPrivateKey\n     * @return String\n     *\/",579],["T_WHITESPACE","\n    ",586],["T_FUNCTION","function",587],["T_WHITESPACE"," ",587],["T_STRING","_convertPrivateKey",587],"(",["T_VARIABLE","$n",587],",",["T_WHITESPACE"," ",587],["T_VARIABLE","$e",587],",",["T_WHITESPACE"," ",587],["T_VARIABLE","$d",587],",",["T_WHITESPACE"," ",587],["T_VARIABLE","$primes",587],",",["T_WHITESPACE"," ",587],["T_VARIABLE","$exponents",587],",",["T_WHITESPACE"," ",587],["T_VARIABLE","$coefficients",587],")",["T_WHITESPACE","\n    ",587],"{",["T_WHITESPACE","\n        ",588],["T_VARIABLE","$num_primes",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_STRING","count",589],"(",["T_VARIABLE","$primes",589],")",";",["T_WHITESPACE","\n        ",589],["T_VARIABLE","$raw",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_ARRAY","array",590],"(",["T_WHITESPACE","\n            ",590],["T_CONSTANT_ENCAPSED_STRING","'version'",591],["T_WHITESPACE"," ",591],["T_DOUBLE_ARROW","=>",591],["T_WHITESPACE"," ",591],["T_VARIABLE","$num_primes",591],["T_WHITESPACE"," ",591],["T_IS_EQUAL","==",591],["T_WHITESPACE"," ",591],["T_LNUMBER","2",591],["T_WHITESPACE"," ",591],"?",["T_WHITESPACE"," ",591],["T_STRING","chr",591],"(",["T_LNUMBER","0",591],")",["T_WHITESPACE"," ",591],":",["T_WHITESPACE"," ",591],["T_STRING","chr",591],"(",["T_LNUMBER","1",591],")",",",["T_WHITESPACE"," ",591],["T_COMMENT","\/\/ two-prime vs. multi\n",591],["T_WHITESPACE","            ",592],["T_CONSTANT_ENCAPSED_STRING","'modulus'",592],["T_WHITESPACE"," ",592],["T_DOUBLE_ARROW","=>",592],["T_WHITESPACE"," ",592],["T_VARIABLE","$n",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","toBytes",592],"(",["T_STRING","true",592],")",",",["T_WHITESPACE","\n            ",592],["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",593],["T_WHITESPACE"," ",593],["T_DOUBLE_ARROW","=>",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$e",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","toBytes",593],"(",["T_STRING","true",593],")",",",["T_WHITESPACE","\n            ",593],["T_CONSTANT_ENCAPSED_STRING","'privateExponent'",594],["T_WHITESPACE"," ",594],["T_DOUBLE_ARROW","=>",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$d",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","toBytes",594],"(",["T_STRING","true",594],")",",",["T_WHITESPACE","\n            ",594],["T_CONSTANT_ENCAPSED_STRING","'prime1'",595],["T_WHITESPACE"," ",595],["T_DOUBLE_ARROW","=>",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$primes",595],"[",["T_LNUMBER","1",595],"]",["T_OBJECT_OPERATOR","->",595],["T_STRING","toBytes",595],"(",["T_STRING","true",595],")",",",["T_WHITESPACE","\n            ",595],["T_CONSTANT_ENCAPSED_STRING","'prime2'",596],["T_WHITESPACE"," ",596],["T_DOUBLE_ARROW","=>",596],["T_WHITESPACE"," ",596],["T_VARIABLE","$primes",596],"[",["T_LNUMBER","2",596],"]",["T_OBJECT_OPERATOR","->",596],["T_STRING","toBytes",596],"(",["T_STRING","true",596],")",",",["T_WHITESPACE","\n            ",596],["T_CONSTANT_ENCAPSED_STRING","'exponent1'",597],["T_WHITESPACE"," ",597],["T_DOUBLE_ARROW","=>",597],["T_WHITESPACE"," ",597],["T_VARIABLE","$exponents",597],"[",["T_LNUMBER","1",597],"]",["T_OBJECT_OPERATOR","->",597],["T_STRING","toBytes",597],"(",["T_STRING","true",597],")",",",["T_WHITESPACE","\n            ",597],["T_CONSTANT_ENCAPSED_STRING","'exponent2'",598],["T_WHITESPACE"," ",598],["T_DOUBLE_ARROW","=>",598],["T_WHITESPACE"," ",598],["T_VARIABLE","$exponents",598],"[",["T_LNUMBER","2",598],"]",["T_OBJECT_OPERATOR","->",598],["T_STRING","toBytes",598],"(",["T_STRING","true",598],")",",",["T_WHITESPACE","\n            ",598],["T_CONSTANT_ENCAPSED_STRING","'coefficient'",599],["T_WHITESPACE"," ",599],["T_DOUBLE_ARROW","=>",599],["T_WHITESPACE"," ",599],["T_VARIABLE","$coefficients",599],"[",["T_LNUMBER","2",599],"]",["T_OBJECT_OPERATOR","->",599],["T_STRING","toBytes",599],"(",["T_STRING","true",599],")",["T_WHITESPACE","\n        ",599],")",";",["T_WHITESPACE","\n\n        ",600],["T_COMMENT","\/\/ if the format in question does not support multi-prime rsa and multi-prime rsa was used,\n",602],["T_WHITESPACE","        ",603],["T_COMMENT","\/\/ call _convertPublicKey() instead.\n",603],["T_WHITESPACE","        ",604],["T_SWITCH","switch",604],["T_WHITESPACE"," ",604],"(",["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","privateKeyFormat",604],")",["T_WHITESPACE"," ",604],"{",["T_WHITESPACE","\n            ",604],["T_DEFAULT","default",605],":",["T_WHITESPACE"," ",605],["T_COMMENT","\/\/ eg. CRYPT_RSA_PRIVATE_FORMAT_PKCS1\n",605],["T_WHITESPACE","                ",606],["T_VARIABLE","$components",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_ARRAY","array",606],"(",")",";",["T_WHITESPACE","\n                ",606],["T_FOREACH","foreach",607],["T_WHITESPACE"," ",607],"(",["T_VARIABLE","$raw",607],["T_WHITESPACE"," ",607],["T_AS","as",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$name",607],["T_WHITESPACE"," ",607],["T_DOUBLE_ARROW","=>",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$value",607],")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n                    ",607],["T_VARIABLE","$components",608],"[",["T_VARIABLE","$name",608],"]",["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_STRING","pack",608],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",608],",",["T_WHITESPACE"," ",608],["T_STRING","CRYPT_RSA_ASN1_INTEGER",608],",",["T_WHITESPACE"," ",608],["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","_encodeLength",608],"(",["T_STRING","strlen",608],"(",["T_VARIABLE","$value",608],")",")",",",["T_WHITESPACE"," ",608],["T_VARIABLE","$value",608],")",";",["T_WHITESPACE","\n                ",608],"}",["T_WHITESPACE","\n\n                ",609],["T_VARIABLE","$RSAPrivateKey",611],["T_WHITESPACE"," ",611],"=",["T_WHITESPACE"," ",611],["T_STRING","implode",611],"(",["T_CONSTANT_ENCAPSED_STRING","''",611],",",["T_WHITESPACE"," ",611],["T_VARIABLE","$components",611],")",";",["T_WHITESPACE","\n\n                ",611],["T_IF","if",613],["T_WHITESPACE"," ",613],"(",["T_VARIABLE","$num_primes",613],["T_WHITESPACE"," ",613],">",["T_WHITESPACE"," ",613],["T_LNUMBER","2",613],")",["T_WHITESPACE"," ",613],"{",["T_WHITESPACE","\n                    ",613],["T_VARIABLE","$OtherPrimeInfos",614],["T_WHITESPACE"," ",614],"=",["T_WHITESPACE"," ",614],["T_CONSTANT_ENCAPSED_STRING","''",614],";",["T_WHITESPACE","\n                    ",614],["T_FOR","for",615],["T_WHITESPACE"," ",615],"(",["T_VARIABLE","$i",615],["T_WHITESPACE"," ",615],"=",["T_WHITESPACE"," ",615],["T_LNUMBER","3",615],";",["T_WHITESPACE"," ",615],["T_VARIABLE","$i",615],["T_WHITESPACE"," ",615],["T_IS_SMALLER_OR_EQUAL","<=",615],["T_WHITESPACE"," ",615],["T_VARIABLE","$num_primes",615],";",["T_WHITESPACE"," ",615],["T_VARIABLE","$i",615],["T_INC","++",615],")",["T_WHITESPACE"," ",615],"{",["T_WHITESPACE","\n                        ",615],["T_COMMENT","\/\/ OtherPrimeInfos ::= SEQUENCE SIZE(1..MAX) OF OtherPrimeInfo\n",616],["T_WHITESPACE","                        ",617],["T_COMMENT","\/\/\n",617],["T_WHITESPACE","                        ",618],["T_COMMENT","\/\/ OtherPrimeInfo ::= SEQUENCE {\n",618],["T_WHITESPACE","                        ",619],["T_COMMENT","\/\/     prime             INTEGER,  -- ri\n",619],["T_WHITESPACE","                        ",620],["T_COMMENT","\/\/     exponent          INTEGER,  -- di\n",620],["T_WHITESPACE","                        ",621],["T_COMMENT","\/\/     coefficient       INTEGER   -- ti\n",621],["T_WHITESPACE","                        ",622],["T_COMMENT","\/\/ }\n",622],["T_WHITESPACE","                        ",623],["T_VARIABLE","$OtherPrimeInfo",623],["T_WHITESPACE"," ",623],"=",["T_WHITESPACE"," ",623],["T_STRING","pack",623],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",623],",",["T_WHITESPACE"," ",623],["T_STRING","CRYPT_RSA_ASN1_INTEGER",623],",",["T_WHITESPACE"," ",623],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","_encodeLength",623],"(",["T_STRING","strlen",623],"(",["T_VARIABLE","$primes",623],"[",["T_VARIABLE","$i",623],"]",["T_OBJECT_OPERATOR","->",623],["T_STRING","toBytes",623],"(",["T_STRING","true",623],")",")",")",",",["T_WHITESPACE"," ",623],["T_VARIABLE","$primes",623],"[",["T_VARIABLE","$i",623],"]",["T_OBJECT_OPERATOR","->",623],["T_STRING","toBytes",623],"(",["T_STRING","true",623],")",")",";",["T_WHITESPACE","\n                        ",623],["T_VARIABLE","$OtherPrimeInfo",624],["T_CONCAT_EQUAL",".=",624],["T_WHITESPACE"," ",624],["T_STRING","pack",624],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",624],",",["T_WHITESPACE"," ",624],["T_STRING","CRYPT_RSA_ASN1_INTEGER",624],",",["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","_encodeLength",624],"(",["T_STRING","strlen",624],"(",["T_VARIABLE","$exponents",624],"[",["T_VARIABLE","$i",624],"]",["T_OBJECT_OPERATOR","->",624],["T_STRING","toBytes",624],"(",["T_STRING","true",624],")",")",")",",",["T_WHITESPACE"," ",624],["T_VARIABLE","$exponents",624],"[",["T_VARIABLE","$i",624],"]",["T_OBJECT_OPERATOR","->",624],["T_STRING","toBytes",624],"(",["T_STRING","true",624],")",")",";",["T_WHITESPACE","\n                        ",624],["T_VARIABLE","$OtherPrimeInfo",625],["T_CONCAT_EQUAL",".=",625],["T_WHITESPACE"," ",625],["T_STRING","pack",625],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",625],",",["T_WHITESPACE"," ",625],["T_STRING","CRYPT_RSA_ASN1_INTEGER",625],",",["T_WHITESPACE"," ",625],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","_encodeLength",625],"(",["T_STRING","strlen",625],"(",["T_VARIABLE","$coefficients",625],"[",["T_VARIABLE","$i",625],"]",["T_OBJECT_OPERATOR","->",625],["T_STRING","toBytes",625],"(",["T_STRING","true",625],")",")",")",",",["T_WHITESPACE"," ",625],["T_VARIABLE","$coefficients",625],"[",["T_VARIABLE","$i",625],"]",["T_OBJECT_OPERATOR","->",625],["T_STRING","toBytes",625],"(",["T_STRING","true",625],")",")",";",["T_WHITESPACE","\n                        ",625],["T_VARIABLE","$OtherPrimeInfos",626],["T_CONCAT_EQUAL",".=",626],["T_WHITESPACE"," ",626],["T_STRING","pack",626],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",626],",",["T_WHITESPACE"," ",626],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",626],",",["T_WHITESPACE"," ",626],["T_VARIABLE","$this",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","_encodeLength",626],"(",["T_STRING","strlen",626],"(",["T_VARIABLE","$OtherPrimeInfo",626],")",")",",",["T_WHITESPACE"," ",626],["T_VARIABLE","$OtherPrimeInfo",626],")",";",["T_WHITESPACE","\n                    ",626],"}",["T_WHITESPACE","\n                    ",627],["T_VARIABLE","$RSAPrivateKey",628],["T_CONCAT_EQUAL",".=",628],["T_WHITESPACE"," ",628],["T_STRING","pack",628],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",628],",",["T_WHITESPACE"," ",628],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",628],",",["T_WHITESPACE"," ",628],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","_encodeLength",628],"(",["T_STRING","strlen",628],"(",["T_VARIABLE","$OtherPrimeInfos",628],")",")",",",["T_WHITESPACE"," ",628],["T_VARIABLE","$OtherPrimeInfos",628],")",";",["T_WHITESPACE","\n                ",628],"}",["T_WHITESPACE","\n\n                ",629],["T_VARIABLE","$RSAPrivateKey",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_STRING","pack",631],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",631],",",["T_WHITESPACE"," ",631],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",631],",",["T_WHITESPACE"," ",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","_encodeLength",631],"(",["T_STRING","strlen",631],"(",["T_VARIABLE","$RSAPrivateKey",631],")",")",",",["T_WHITESPACE"," ",631],["T_VARIABLE","$RSAPrivateKey",631],")",";",["T_WHITESPACE","\n\n                ",631],["T_IF","if",633],["T_WHITESPACE"," ",633],"(","!",["T_EMPTY","empty",633],"(",["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","password",633],")",")",["T_WHITESPACE"," ",633],"{",["T_WHITESPACE","\n                    ",633],["T_VARIABLE","$iv",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","_random",634],"(",["T_LNUMBER","8",634],")",";",["T_WHITESPACE","\n                    ",634],["T_VARIABLE","$symkey",635],["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_STRING","pack",635],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",635],",",["T_WHITESPACE"," ",635],["T_STRING","md5",635],"(",["T_VARIABLE","$this",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","password",635],["T_WHITESPACE"," ",635],".",["T_WHITESPACE"," ",635],["T_VARIABLE","$iv",635],")",")",";",["T_WHITESPACE"," ",635],["T_COMMENT","\/\/ symkey is short for symmetric key\n",635],["T_WHITESPACE","                    ",636],["T_VARIABLE","$symkey",636],["T_CONCAT_EQUAL",".=",636],["T_WHITESPACE"," ",636],["T_STRING","substr",636],"(",["T_STRING","pack",636],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",636],",",["T_WHITESPACE"," ",636],["T_STRING","md5",636],"(",["T_VARIABLE","$symkey",636],["T_WHITESPACE"," ",636],".",["T_WHITESPACE"," ",636],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","password",636],["T_WHITESPACE"," ",636],".",["T_WHITESPACE"," ",636],["T_VARIABLE","$iv",636],")",")",",",["T_WHITESPACE"," ",636],["T_LNUMBER","0",636],",",["T_WHITESPACE"," ",636],["T_LNUMBER","8",636],")",";",["T_WHITESPACE","\n                    ",636],["T_IF","if",637],["T_WHITESPACE"," ",637],"(","!",["T_STRING","class_exists",637],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_TripleDES'",637],")",")",["T_WHITESPACE"," ",637],"{",["T_WHITESPACE","\n                        ",637],["T_REQUIRE_ONCE","require_once",638],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt\/TripleDES.php'",638],")",";",["T_WHITESPACE","\n                    ",638],"}",["T_WHITESPACE","\n                    ",639],["T_VARIABLE","$des",640],["T_WHITESPACE"," ",640],"=",["T_WHITESPACE"," ",640],["T_NEW","new",640],["T_WHITESPACE"," ",640],["T_STRING","Crypt_TripleDES",640],"(",")",";",["T_WHITESPACE","\n                    ",640],["T_VARIABLE","$des",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","setKey",641],"(",["T_VARIABLE","$symkey",641],")",";",["T_WHITESPACE","\n                    ",641],["T_VARIABLE","$des",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","setIV",642],"(",["T_VARIABLE","$iv",642],")",";",["T_WHITESPACE","\n                    ",642],["T_VARIABLE","$iv",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_STRING","strtoupper",643],"(",["T_STRING","bin2hex",643],"(",["T_VARIABLE","$iv",643],")",")",";",["T_WHITESPACE","\n                    ",643],["T_VARIABLE","$RSAPrivateKey",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_CONSTANT_ENCAPSED_STRING","\"-----BEGIN RSA PRIVATE KEY-----\\r\\n\"",644],["T_WHITESPACE"," ",644],".",["T_WHITESPACE","\n                                     ",644],["T_CONSTANT_ENCAPSED_STRING","\"Proc-Type: 4,ENCRYPTED\\r\\n\"",645],["T_WHITESPACE"," ",645],".",["T_WHITESPACE","\n                                     ",645],"\"",["T_ENCAPSED_AND_WHITESPACE","DEK-Info: DES-EDE3-CBC,",646],["T_VARIABLE","$iv",646],["T_ENCAPSED_AND_WHITESPACE","\\r\\n",646],"\"",["T_WHITESPACE"," ",646],".",["T_WHITESPACE","\n                                     ",646],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",647],["T_WHITESPACE"," ",647],".",["T_WHITESPACE","\n                                     ",647],["T_STRING","chunk_split",648],"(",["T_STRING","base64_encode",648],"(",["T_VARIABLE","$des",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","encrypt",648],"(",["T_VARIABLE","$RSAPrivateKey",648],")",")",")",["T_WHITESPACE"," ",648],".",["T_WHITESPACE","\n                                     ",648],["T_CONSTANT_ENCAPSED_STRING","'-----END RSA PRIVATE KEY-----'",649],";",["T_WHITESPACE","\n                ",649],"}",["T_WHITESPACE"," ",650],["T_ELSE","else",650],["T_WHITESPACE"," ",650],"{",["T_WHITESPACE","\n                    ",650],["T_VARIABLE","$RSAPrivateKey",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_CONSTANT_ENCAPSED_STRING","\"-----BEGIN RSA PRIVATE KEY-----\\r\\n\"",651],["T_WHITESPACE"," ",651],".",["T_WHITESPACE","\n                                     ",651],["T_STRING","chunk_split",652],"(",["T_STRING","base64_encode",652],"(",["T_VARIABLE","$RSAPrivateKey",652],")",")",["T_WHITESPACE"," ",652],".",["T_WHITESPACE","\n                                     ",652],["T_CONSTANT_ENCAPSED_STRING","'-----END RSA PRIVATE KEY-----'",653],";",["T_WHITESPACE","\n                ",653],"}",["T_WHITESPACE","\n\n                ",654],["T_RETURN","return",656],["T_WHITESPACE"," ",656],["T_VARIABLE","$RSAPrivateKey",656],";",["T_WHITESPACE","\n        ",656],"}",["T_WHITESPACE","\n    ",657],"}",["T_WHITESPACE","\n\n    ",658],["T_DOC_COMMENT","\/**\n     * Convert a public key to the appropriate format\n     *\n     * @access private\n     * @see setPublicKeyFormat()\n     * @param String $RSAPrivateKey\n     * @return String\n     *\/",660],["T_WHITESPACE","\n    ",667],["T_FUNCTION","function",668],["T_WHITESPACE"," ",668],["T_STRING","_convertPublicKey",668],"(",["T_VARIABLE","$n",668],",",["T_WHITESPACE"," ",668],["T_VARIABLE","$e",668],")",["T_WHITESPACE","\n    ",668],"{",["T_WHITESPACE","\n        ",669],["T_VARIABLE","$modulus",670],["T_WHITESPACE"," ",670],"=",["T_WHITESPACE"," ",670],["T_VARIABLE","$n",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","toBytes",670],"(",["T_STRING","true",670],")",";",["T_WHITESPACE","\n        ",670],["T_VARIABLE","$publicExponent",671],["T_WHITESPACE"," ",671],"=",["T_WHITESPACE"," ",671],["T_VARIABLE","$e",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","toBytes",671],"(",["T_STRING","true",671],")",";",["T_WHITESPACE","\n\n        ",671],["T_SWITCH","switch",673],["T_WHITESPACE"," ",673],"(",["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","publicKeyFormat",673],")",["T_WHITESPACE"," ",673],"{",["T_WHITESPACE","\n            ",673],["T_CASE","case",674],["T_WHITESPACE"," ",674],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_RAW",674],":",["T_WHITESPACE","\n                ",674],["T_RETURN","return",675],["T_WHITESPACE"," ",675],["T_ARRAY","array",675],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",675],["T_WHITESPACE"," ",675],["T_DOUBLE_ARROW","=>",675],["T_WHITESPACE"," ",675],["T_VARIABLE","$e",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","copy",675],"(",")",",",["T_WHITESPACE"," ",675],["T_CONSTANT_ENCAPSED_STRING","'n'",675],["T_WHITESPACE"," ",675],["T_DOUBLE_ARROW","=>",675],["T_WHITESPACE"," ",675],["T_VARIABLE","$n",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","copy",675],"(",")",")",";",["T_WHITESPACE","\n            ",675],["T_CASE","case",676],["T_WHITESPACE"," ",676],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_OPENSSH",676],":",["T_WHITESPACE","\n                ",676],["T_COMMENT","\/\/ from <http:\/\/tools.ietf.org\/html\/rfc4253#page-15>:\n",677],["T_WHITESPACE","                ",678],["T_COMMENT","\/\/ string    \"ssh-rsa\"\n",678],["T_WHITESPACE","                ",679],["T_COMMENT","\/\/ mpint     e\n",679],["T_WHITESPACE","                ",680],["T_COMMENT","\/\/ mpint     n\n",680],["T_WHITESPACE","                ",681],["T_VARIABLE","$RSAPublicKey",681],["T_WHITESPACE"," ",681],"=",["T_WHITESPACE"," ",681],["T_STRING","pack",681],"(",["T_CONSTANT_ENCAPSED_STRING","'Na*Na*Na*'",681],",",["T_WHITESPACE"," ",681],["T_STRING","strlen",681],"(",["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",681],")",",",["T_WHITESPACE"," ",681],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa'",681],",",["T_WHITESPACE"," ",681],["T_STRING","strlen",681],"(",["T_VARIABLE","$publicExponent",681],")",",",["T_WHITESPACE"," ",681],["T_VARIABLE","$publicExponent",681],",",["T_WHITESPACE"," ",681],["T_STRING","strlen",681],"(",["T_VARIABLE","$modulus",681],")",",",["T_WHITESPACE"," ",681],["T_VARIABLE","$modulus",681],")",";",["T_WHITESPACE","\n                ",681],["T_VARIABLE","$RSAPublicKey",682],["T_WHITESPACE"," ",682],"=",["T_WHITESPACE"," ",682],["T_CONSTANT_ENCAPSED_STRING","'ssh-rsa '",682],["T_WHITESPACE"," ",682],".",["T_WHITESPACE"," ",682],["T_STRING","base64_encode",682],"(",["T_VARIABLE","$RSAPublicKey",682],")",["T_WHITESPACE"," ",682],".",["T_WHITESPACE"," ",682],["T_CONSTANT_ENCAPSED_STRING","' '",682],["T_WHITESPACE"," ",682],".",["T_WHITESPACE"," ",682],["T_STRING","CRYPT_RSA_COMMENT",682],";",["T_WHITESPACE","\n\n                ",682],["T_RETURN","return",684],["T_WHITESPACE"," ",684],["T_VARIABLE","$RSAPublicKey",684],";",["T_WHITESPACE","\n            ",684],["T_DEFAULT","default",685],":",["T_WHITESPACE"," ",685],["T_COMMENT","\/\/ eg. CRYPT_RSA_PUBLIC_FORMAT_PKCS1\n",685],["T_WHITESPACE","                ",686],["T_COMMENT","\/\/ from <http:\/\/tools.ietf.org\/html\/rfc3447#appendix-A.1.1>:\n",686],["T_WHITESPACE","                ",687],["T_COMMENT","\/\/ RSAPublicKey ::= SEQUENCE {\n",687],["T_WHITESPACE","                ",688],["T_COMMENT","\/\/     modulus           INTEGER,  -- n\n",688],["T_WHITESPACE","                ",689],["T_COMMENT","\/\/     publicExponent    INTEGER   -- e\n",689],["T_WHITESPACE","                ",690],["T_COMMENT","\/\/ }\n",690],["T_WHITESPACE","                ",691],["T_VARIABLE","$components",691],["T_WHITESPACE"," ",691],"=",["T_WHITESPACE"," ",691],["T_ARRAY","array",691],"(",["T_WHITESPACE","\n                    ",691],["T_CONSTANT_ENCAPSED_STRING","'modulus'",692],["T_WHITESPACE"," ",692],["T_DOUBLE_ARROW","=>",692],["T_WHITESPACE"," ",692],["T_STRING","pack",692],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",692],",",["T_WHITESPACE"," ",692],["T_STRING","CRYPT_RSA_ASN1_INTEGER",692],",",["T_WHITESPACE"," ",692],["T_VARIABLE","$this",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","_encodeLength",692],"(",["T_STRING","strlen",692],"(",["T_VARIABLE","$modulus",692],")",")",",",["T_WHITESPACE"," ",692],["T_VARIABLE","$modulus",692],")",",",["T_WHITESPACE","\n                    ",692],["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",693],["T_WHITESPACE"," ",693],["T_DOUBLE_ARROW","=>",693],["T_WHITESPACE"," ",693],["T_STRING","pack",693],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*'",693],",",["T_WHITESPACE"," ",693],["T_STRING","CRYPT_RSA_ASN1_INTEGER",693],",",["T_WHITESPACE"," ",693],["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","_encodeLength",693],"(",["T_STRING","strlen",693],"(",["T_VARIABLE","$publicExponent",693],")",")",",",["T_WHITESPACE"," ",693],["T_VARIABLE","$publicExponent",693],")",["T_WHITESPACE","\n                ",693],")",";",["T_WHITESPACE","\n\n                ",694],["T_VARIABLE","$RSAPublicKey",696],["T_WHITESPACE"," ",696],"=",["T_WHITESPACE"," ",696],["T_STRING","pack",696],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*a*a*'",696],",",["T_WHITESPACE","\n                    ",696],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",697],",",["T_WHITESPACE"," ",697],["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","_encodeLength",697],"(",["T_STRING","strlen",697],"(",["T_VARIABLE","$components",697],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",697],"]",")",["T_WHITESPACE"," ",697],"+",["T_WHITESPACE"," ",697],["T_STRING","strlen",697],"(",["T_VARIABLE","$components",697],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",697],"]",")",")",",",["T_WHITESPACE","\n                    ",697],["T_VARIABLE","$components",698],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",698],"]",",",["T_WHITESPACE"," ",698],["T_VARIABLE","$components",698],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",698],"]",["T_WHITESPACE","\n                ",698],")",";",["T_WHITESPACE","\n\n                ",699],["T_VARIABLE","$RSAPublicKey",701],["T_WHITESPACE"," ",701],"=",["T_WHITESPACE"," ",701],["T_CONSTANT_ENCAPSED_STRING","\"-----BEGIN PUBLIC KEY-----\\r\\n\"",701],["T_WHITESPACE"," ",701],".",["T_WHITESPACE","\n                                 ",701],["T_STRING","chunk_split",702],"(",["T_STRING","base64_encode",702],"(",["T_VARIABLE","$RSAPublicKey",702],")",")",["T_WHITESPACE"," ",702],".",["T_WHITESPACE","\n                                 ",702],["T_CONSTANT_ENCAPSED_STRING","'-----END PUBLIC KEY-----'",703],";",["T_WHITESPACE","\n\n                ",703],["T_RETURN","return",705],["T_WHITESPACE"," ",705],["T_VARIABLE","$RSAPublicKey",705],";",["T_WHITESPACE","\n        ",705],"}",["T_WHITESPACE","\n    ",706],"}",["T_WHITESPACE","\n\n    ",707],["T_DOC_COMMENT","\/**\n     * Break a public or private key down into its constituant components\n     *\n     * @access private\n     * @see _convertPublicKey()\n     * @see _convertPrivateKey()\n     * @param String $key\n     * @param Integer $type\n     * @return Array\n     *\/",709],["T_WHITESPACE","\n    ",718],["T_FUNCTION","function",719],["T_WHITESPACE"," ",719],["T_STRING","_parseKey",719],"(",["T_VARIABLE","$key",719],",",["T_WHITESPACE"," ",719],["T_VARIABLE","$type",719],")",["T_WHITESPACE","\n    ",719],"{",["T_WHITESPACE","\n        ",720],["T_SWITCH","switch",721],["T_WHITESPACE"," ",721],"(",["T_VARIABLE","$type",721],")",["T_WHITESPACE"," ",721],"{",["T_WHITESPACE","\n            ",721],["T_CASE","case",722],["T_WHITESPACE"," ",722],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_RAW",722],":",["T_WHITESPACE","\n                ",722],["T_IF","if",723],["T_WHITESPACE"," ",723],"(","!",["T_STRING","is_array",723],"(",["T_VARIABLE","$key",723],")",")",["T_WHITESPACE"," ",723],"{",["T_WHITESPACE","\n                    ",723],["T_RETURN","return",724],["T_WHITESPACE"," ",724],["T_STRING","false",724],";",["T_WHITESPACE","\n                ",724],"}",["T_WHITESPACE","\n                ",725],["T_VARIABLE","$components",726],["T_WHITESPACE"," ",726],"=",["T_WHITESPACE"," ",726],["T_ARRAY","array",726],"(",")",";",["T_WHITESPACE","\n                ",726],["T_SWITCH","switch",727],["T_WHITESPACE"," ",727],"(",["T_STRING","true",727],")",["T_WHITESPACE"," ",727],"{",["T_WHITESPACE","\n                    ",727],["T_CASE","case",728],["T_WHITESPACE"," ",728],["T_ISSET","isset",728],"(",["T_VARIABLE","$key",728],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",728],"]",")",":",["T_WHITESPACE","\n                        ",728],["T_VARIABLE","$components",729],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",729],"]",["T_WHITESPACE"," ",729],"=",["T_WHITESPACE"," ",729],["T_VARIABLE","$key",729],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",729],"]",["T_OBJECT_OPERATOR","->",729],["T_STRING","copy",729],"(",")",";",["T_WHITESPACE","\n                        ",729],["T_BREAK","break",730],";",["T_WHITESPACE","\n                    ",730],["T_CASE","case",731],["T_WHITESPACE"," ",731],["T_ISSET","isset",731],"(",["T_VARIABLE","$key",731],"[",["T_CONSTANT_ENCAPSED_STRING","'exponent'",731],"]",")",":",["T_WHITESPACE","\n                        ",731],["T_VARIABLE","$components",732],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",732],"]",["T_WHITESPACE"," ",732],"=",["T_WHITESPACE"," ",732],["T_VARIABLE","$key",732],"[",["T_CONSTANT_ENCAPSED_STRING","'exponent'",732],"]",["T_OBJECT_OPERATOR","->",732],["T_STRING","copy",732],"(",")",";",["T_WHITESPACE","\n                        ",732],["T_BREAK","break",733],";",["T_WHITESPACE","\n                    ",733],["T_CASE","case",734],["T_WHITESPACE"," ",734],["T_ISSET","isset",734],"(",["T_VARIABLE","$key",734],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",734],"]",")",":",["T_WHITESPACE","\n                        ",734],["T_VARIABLE","$components",735],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",735],"]",["T_WHITESPACE"," ",735],"=",["T_WHITESPACE"," ",735],["T_VARIABLE","$key",735],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",735],"]",["T_OBJECT_OPERATOR","->",735],["T_STRING","copy",735],"(",")",";",["T_WHITESPACE","\n                        ",735],["T_BREAK","break",736],";",["T_WHITESPACE","\n                    ",736],["T_CASE","case",737],["T_WHITESPACE"," ",737],["T_ISSET","isset",737],"(",["T_VARIABLE","$key",737],"[",["T_LNUMBER","0",737],"]",")",":",["T_WHITESPACE","\n                        ",737],["T_VARIABLE","$components",738],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",738],"]",["T_WHITESPACE"," ",738],"=",["T_WHITESPACE"," ",738],["T_VARIABLE","$key",738],"[",["T_LNUMBER","0",738],"]",["T_OBJECT_OPERATOR","->",738],["T_STRING","copy",738],"(",")",";",["T_WHITESPACE","\n                ",738],"}",["T_WHITESPACE","\n                ",739],["T_SWITCH","switch",740],["T_WHITESPACE"," ",740],"(",["T_STRING","true",740],")",["T_WHITESPACE"," ",740],"{",["T_WHITESPACE","\n                    ",740],["T_CASE","case",741],["T_WHITESPACE"," ",741],["T_ISSET","isset",741],"(",["T_VARIABLE","$key",741],"[",["T_CONSTANT_ENCAPSED_STRING","'n'",741],"]",")",":",["T_WHITESPACE","\n                        ",741],["T_VARIABLE","$components",742],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",742],"]",["T_WHITESPACE"," ",742],"=",["T_WHITESPACE"," ",742],["T_VARIABLE","$key",742],"[",["T_CONSTANT_ENCAPSED_STRING","'n'",742],"]",["T_OBJECT_OPERATOR","->",742],["T_STRING","copy",742],"(",")",";",["T_WHITESPACE","\n                        ",742],["T_BREAK","break",743],";",["T_WHITESPACE","\n                    ",743],["T_CASE","case",744],["T_WHITESPACE"," ",744],["T_ISSET","isset",744],"(",["T_VARIABLE","$key",744],"[",["T_CONSTANT_ENCAPSED_STRING","'modulo'",744],"]",")",":",["T_WHITESPACE","\n                        ",744],["T_VARIABLE","$components",745],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",745],"]",["T_WHITESPACE"," ",745],"=",["T_WHITESPACE"," ",745],["T_VARIABLE","$key",745],"[",["T_CONSTANT_ENCAPSED_STRING","'modulo'",745],"]",["T_OBJECT_OPERATOR","->",745],["T_STRING","copy",745],"(",")",";",["T_WHITESPACE","\n                        ",745],["T_BREAK","break",746],";",["T_WHITESPACE","\n                    ",746],["T_CASE","case",747],["T_WHITESPACE"," ",747],["T_ISSET","isset",747],"(",["T_VARIABLE","$key",747],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",747],"]",")",":",["T_WHITESPACE","\n                        ",747],["T_VARIABLE","$components",748],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",748],"]",["T_WHITESPACE"," ",748],"=",["T_WHITESPACE"," ",748],["T_VARIABLE","$key",748],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",748],"]",["T_OBJECT_OPERATOR","->",748],["T_STRING","copy",748],"(",")",";",["T_WHITESPACE","\n                        ",748],["T_BREAK","break",749],";",["T_WHITESPACE","\n                    ",749],["T_CASE","case",750],["T_WHITESPACE"," ",750],["T_ISSET","isset",750],"(",["T_VARIABLE","$key",750],"[",["T_LNUMBER","1",750],"]",")",":",["T_WHITESPACE","\n                        ",750],["T_VARIABLE","$components",751],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",751],"]",["T_WHITESPACE"," ",751],"=",["T_WHITESPACE"," ",751],["T_VARIABLE","$key",751],"[",["T_LNUMBER","1",751],"]",["T_OBJECT_OPERATOR","->",751],["T_STRING","copy",751],"(",")",";",["T_WHITESPACE","\n                ",751],"}",["T_WHITESPACE","\n                ",752],["T_RETURN","return",753],["T_WHITESPACE"," ",753],["T_VARIABLE","$components",753],";",["T_WHITESPACE","\n            ",753],["T_CASE","case",754],["T_WHITESPACE"," ",754],["T_STRING","CRYPT_RSA_PRIVATE_FORMAT_PKCS1",754],":",["T_WHITESPACE","\n            ",754],["T_CASE","case",755],["T_WHITESPACE"," ",755],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_PKCS1",755],":",["T_WHITESPACE","\n                ",755],["T_COMMENT","\/* Although PKCS#1 proposes a format that public and private keys can use, encrypting them is\n                   \"outside the scope\" of PKCS#1.  PKCS#1 then refers you to PKCS#12 and PKCS#15 if you're wanting to\n                   protect private keys, however, that's not what OpenSSL* does.  OpenSSL protects private keys by adding\n                   two new \"fields\" to the key - DEK-Info and Proc-Type.  These fields are discussed here:\n\n                   http:\/\/tools.ietf.org\/html\/rfc1421#section-4.6.1.1\n                   http:\/\/tools.ietf.org\/html\/rfc1421#section-4.6.1.3\n\n                   DES-EDE3-CBC as an algorithm, however, is not discussed anywhere, near as I can tell.\n                   DES-CBC and DES-EDE are discussed in RFC1423, however, DES-EDE3-CBC isn't, nor is its key derivation\n                   function.  As is, the definitive authority on this encoding scheme isn't the IETF but rather OpenSSL's\n                   own implementation.  ie. the implementation *is* the standard and any bugs that may exist in that \n                   implementation are part of the standard, as well.\n\n                   * OpenSSL is the de facto standard.  It's utilized by OpenSSH and other projects *\/",756],["T_WHITESPACE","\n                ",770],["T_IF","if",771],["T_WHITESPACE"," ",771],"(",["T_STRING","preg_match",771],"(",["T_CONSTANT_ENCAPSED_STRING","'#DEK-Info: (.+),(.+)#'",771],",",["T_WHITESPACE"," ",771],["T_VARIABLE","$key",771],",",["T_WHITESPACE"," ",771],["T_VARIABLE","$matches",771],")",")",["T_WHITESPACE"," ",771],"{",["T_WHITESPACE","\n                    ",771],["T_VARIABLE","$iv",772],["T_WHITESPACE"," ",772],"=",["T_WHITESPACE"," ",772],["T_STRING","pack",772],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",772],",",["T_WHITESPACE"," ",772],["T_STRING","trim",772],"(",["T_VARIABLE","$matches",772],"[",["T_LNUMBER","2",772],"]",")",")",";",["T_WHITESPACE","\n                    ",772],["T_VARIABLE","$symkey",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_STRING","pack",773],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",773],",",["T_WHITESPACE"," ",773],["T_STRING","md5",773],"(",["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","password",773],["T_WHITESPACE"," ",773],".",["T_WHITESPACE"," ",773],["T_VARIABLE","$iv",773],")",")",";",["T_WHITESPACE"," ",773],["T_COMMENT","\/\/ symkey is short for symmetric key\n",773],["T_WHITESPACE","                    ",774],["T_VARIABLE","$symkey",774],["T_CONCAT_EQUAL",".=",774],["T_WHITESPACE"," ",774],["T_STRING","substr",774],"(",["T_STRING","pack",774],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",774],",",["T_WHITESPACE"," ",774],["T_STRING","md5",774],"(",["T_VARIABLE","$symkey",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_VARIABLE","$this",774],["T_OBJECT_OPERATOR","->",774],["T_STRING","password",774],["T_WHITESPACE"," ",774],".",["T_WHITESPACE"," ",774],["T_VARIABLE","$iv",774],")",")",",",["T_WHITESPACE"," ",774],["T_LNUMBER","0",774],",",["T_WHITESPACE"," ",774],["T_LNUMBER","8",774],")",";",["T_WHITESPACE","\n                    ",774],["T_VARIABLE","$ciphertext",775],["T_WHITESPACE"," ",775],"=",["T_WHITESPACE"," ",775],["T_STRING","preg_replace",775],"(",["T_CONSTANT_ENCAPSED_STRING","'#.+(\\r|\\n|\\r\\n)\\1|[\\r\\n]|-.+-#s'",775],",",["T_WHITESPACE"," ",775],["T_CONSTANT_ENCAPSED_STRING","''",775],",",["T_WHITESPACE"," ",775],["T_VARIABLE","$key",775],")",";",["T_WHITESPACE","\n                    ",775],["T_VARIABLE","$ciphertext",776],["T_WHITESPACE"," ",776],"=",["T_WHITESPACE"," ",776],["T_STRING","preg_match",776],"(",["T_CONSTANT_ENCAPSED_STRING","'#^[a-zA-Z\\d\/+]*={0,2}$#'",776],",",["T_WHITESPACE"," ",776],["T_VARIABLE","$ciphertext",776],")",["T_WHITESPACE"," ",776],"?",["T_WHITESPACE"," ",776],["T_STRING","base64_decode",776],"(",["T_VARIABLE","$ciphertext",776],")",["T_WHITESPACE"," ",776],":",["T_WHITESPACE"," ",776],["T_STRING","false",776],";",["T_WHITESPACE","\n                    ",776],["T_IF","if",777],["T_WHITESPACE"," ",777],"(",["T_VARIABLE","$ciphertext",777],["T_WHITESPACE"," ",777],["T_IS_IDENTICAL","===",777],["T_WHITESPACE"," ",777],["T_STRING","false",777],")",["T_WHITESPACE"," ",777],"{",["T_WHITESPACE","\n                        ",777],["T_VARIABLE","$ciphertext",778],["T_WHITESPACE"," ",778],"=",["T_WHITESPACE"," ",778],["T_VARIABLE","$key",778],";",["T_WHITESPACE","\n                    ",778],"}",["T_WHITESPACE","\n                    ",779],["T_SWITCH","switch",780],["T_WHITESPACE"," ",780],"(",["T_VARIABLE","$matches",780],"[",["T_LNUMBER","1",780],"]",")",["T_WHITESPACE"," ",780],"{",["T_WHITESPACE","\n                        ",780],["T_CASE","case",781],["T_WHITESPACE"," ",781],["T_CONSTANT_ENCAPSED_STRING","'DES-EDE3-CBC'",781],":",["T_WHITESPACE","\n                            ",781],["T_IF","if",782],["T_WHITESPACE"," ",782],"(","!",["T_STRING","class_exists",782],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_TripleDES'",782],")",")",["T_WHITESPACE"," ",782],"{",["T_WHITESPACE","\n                                ",782],["T_REQUIRE_ONCE","require_once",783],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt\/TripleDES.php'",783],")",";",["T_WHITESPACE","\n                            ",783],"}",["T_WHITESPACE","\n                            ",784],["T_VARIABLE","$crypto",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_NEW","new",785],["T_WHITESPACE"," ",785],["T_STRING","Crypt_TripleDES",785],"(",")",";",["T_WHITESPACE","\n                            ",785],["T_BREAK","break",786],";",["T_WHITESPACE","\n                        ",786],["T_CASE","case",787],["T_WHITESPACE"," ",787],["T_CONSTANT_ENCAPSED_STRING","'DES-CBC'",787],":",["T_WHITESPACE","\n                            ",787],["T_IF","if",788],["T_WHITESPACE"," ",788],"(","!",["T_STRING","class_exists",788],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt_DES'",788],")",")",["T_WHITESPACE"," ",788],"{",["T_WHITESPACE","\n                                ",788],["T_REQUIRE_ONCE","require_once",789],"(",["T_CONSTANT_ENCAPSED_STRING","'Crypt\/DES.php'",789],")",";",["T_WHITESPACE","\n                            ",789],"}",["T_WHITESPACE","\n                            ",790],["T_VARIABLE","$crypto",791],["T_WHITESPACE"," ",791],"=",["T_WHITESPACE"," ",791],["T_NEW","new",791],["T_WHITESPACE"," ",791],["T_STRING","Crypt_DES",791],"(",")",";",["T_WHITESPACE","\n                            ",791],["T_BREAK","break",792],";",["T_WHITESPACE","\n                        ",792],["T_DEFAULT","default",793],":",["T_WHITESPACE","\n                            ",793],["T_RETURN","return",794],["T_WHITESPACE"," ",794],["T_STRING","false",794],";",["T_WHITESPACE","\n                    ",794],"}",["T_WHITESPACE","\n                    ",795],["T_VARIABLE","$crypto",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","setKey",796],"(",["T_VARIABLE","$symkey",796],")",";",["T_WHITESPACE","\n                    ",796],["T_VARIABLE","$crypto",797],["T_OBJECT_OPERATOR","->",797],["T_STRING","setIV",797],"(",["T_VARIABLE","$iv",797],")",";",["T_WHITESPACE","\n                    ",797],["T_VARIABLE","$decoded",798],["T_WHITESPACE"," ",798],"=",["T_WHITESPACE"," ",798],["T_VARIABLE","$crypto",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","decrypt",798],"(",["T_VARIABLE","$ciphertext",798],")",";",["T_WHITESPACE","\n                ",798],"}",["T_WHITESPACE"," ",799],["T_ELSE","else",799],["T_WHITESPACE"," ",799],"{",["T_WHITESPACE","\n                    ",799],["T_VARIABLE","$decoded",800],["T_WHITESPACE"," ",800],"=",["T_WHITESPACE"," ",800],["T_STRING","preg_replace",800],"(",["T_CONSTANT_ENCAPSED_STRING","'#-.+-|[\\r\\n]#'",800],",",["T_WHITESPACE"," ",800],["T_CONSTANT_ENCAPSED_STRING","''",800],",",["T_WHITESPACE"," ",800],["T_VARIABLE","$key",800],")",";",["T_WHITESPACE","\n                    ",800],["T_VARIABLE","$decoded",801],["T_WHITESPACE"," ",801],"=",["T_WHITESPACE"," ",801],["T_STRING","preg_match",801],"(",["T_CONSTANT_ENCAPSED_STRING","'#^[a-zA-Z\\d\/+]*={0,2}$#'",801],",",["T_WHITESPACE"," ",801],["T_VARIABLE","$decoded",801],")",["T_WHITESPACE"," ",801],"?",["T_WHITESPACE"," ",801],["T_STRING","base64_decode",801],"(",["T_VARIABLE","$decoded",801],")",["T_WHITESPACE"," ",801],":",["T_WHITESPACE"," ",801],["T_STRING","false",801],";",["T_WHITESPACE","\n                ",801],"}",["T_WHITESPACE","\n\n                ",802],["T_IF","if",804],["T_WHITESPACE"," ",804],"(",["T_VARIABLE","$decoded",804],["T_WHITESPACE"," ",804],["T_IS_NOT_IDENTICAL","!==",804],["T_WHITESPACE"," ",804],["T_STRING","false",804],")",["T_WHITESPACE"," ",804],"{",["T_WHITESPACE","\n                    ",804],["T_VARIABLE","$key",805],["T_WHITESPACE"," ",805],"=",["T_WHITESPACE"," ",805],["T_VARIABLE","$decoded",805],";",["T_WHITESPACE","\n                ",805],"}",["T_WHITESPACE","\n\n                ",806],["T_VARIABLE","$components",808],["T_WHITESPACE"," ",808],"=",["T_WHITESPACE"," ",808],["T_ARRAY","array",808],"(",")",";",["T_WHITESPACE","\n\n                ",808],["T_IF","if",810],["T_WHITESPACE"," ",810],"(",["T_STRING","ord",810],"(",["T_VARIABLE","$this",810],["T_OBJECT_OPERATOR","->",810],["T_STRING","_string_shift",810],"(",["T_VARIABLE","$key",810],")",")",["T_WHITESPACE"," ",810],["T_IS_NOT_EQUAL","!=",810],["T_WHITESPACE"," ",810],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",810],")",["T_WHITESPACE"," ",810],"{",["T_WHITESPACE","\n                    ",810],["T_RETURN","return",811],["T_WHITESPACE"," ",811],["T_STRING","false",811],";",["T_WHITESPACE","\n                ",811],"}",["T_WHITESPACE","\n                ",812],["T_IF","if",813],["T_WHITESPACE"," ",813],"(",["T_VARIABLE","$this",813],["T_OBJECT_OPERATOR","->",813],["T_STRING","_decodeLength",813],"(",["T_VARIABLE","$key",813],")",["T_WHITESPACE"," ",813],["T_IS_NOT_EQUAL","!=",813],["T_WHITESPACE"," ",813],["T_STRING","strlen",813],"(",["T_VARIABLE","$key",813],")",")",["T_WHITESPACE"," ",813],"{",["T_WHITESPACE","\n                    ",813],["T_RETURN","return",814],["T_WHITESPACE"," ",814],["T_STRING","false",814],";",["T_WHITESPACE","\n                ",814],"}",["T_WHITESPACE","\n\n                ",815],["T_VARIABLE","$tag",817],["T_WHITESPACE"," ",817],"=",["T_WHITESPACE"," ",817],["T_STRING","ord",817],"(",["T_VARIABLE","$this",817],["T_OBJECT_OPERATOR","->",817],["T_STRING","_string_shift",817],"(",["T_VARIABLE","$key",817],")",")",";",["T_WHITESPACE","\n                ",817],["T_IF","if",818],["T_WHITESPACE"," ",818],"(",["T_VARIABLE","$tag",818],["T_WHITESPACE"," ",818],["T_IS_EQUAL","==",818],["T_WHITESPACE"," ",818],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",818],")",["T_WHITESPACE"," ",818],"{",["T_WHITESPACE","\n                    ",818],["T_COMMENT","\/* intended for keys for which OpenSSL's asn1parse returns the following:\n\n                        0:d=0  hl=4 l= 290 cons: SEQUENCE\n                        4:d=1  hl=2 l=  13 cons:  SEQUENCE\n                        6:d=2  hl=2 l=   9 prim:   OBJECT            :rsaEncryption\n                       17:d=2  hl=2 l=   0 prim:   NULL\n                       19:d=1  hl=4 l= 271 prim:  BIT STRING *\/",819],["T_WHITESPACE","\n                    ",825],["T_VARIABLE","$this",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","_string_shift",826],"(",["T_VARIABLE","$key",826],",",["T_WHITESPACE"," ",826],["T_VARIABLE","$this",826],["T_OBJECT_OPERATOR","->",826],["T_STRING","_decodeLength",826],"(",["T_VARIABLE","$key",826],")",")",";",["T_WHITESPACE","\n                    ",826],["T_VARIABLE","$this",827],["T_OBJECT_OPERATOR","->",827],["T_STRING","_string_shift",827],"(",["T_VARIABLE","$key",827],")",";",["T_WHITESPACE"," ",827],["T_COMMENT","\/\/ skip over the BIT STRING tag\n",827],["T_WHITESPACE","                    ",828],["T_VARIABLE","$this",828],["T_OBJECT_OPERATOR","->",828],["T_STRING","_decodeLength",828],"(",["T_VARIABLE","$key",828],")",";",["T_WHITESPACE"," ",828],["T_COMMENT","\/\/ skip over the BIT STRING length\n",828],["T_WHITESPACE","                    ",829],["T_COMMENT","\/\/ \"The initial octet shall encode, as an unsigned binary integer wtih bit 1 as the least significant bit, the number of\n",829],["T_WHITESPACE","                    ",830],["T_COMMENT","\/\/  unused bits in teh final subsequent octet. The number shall be in the range zero to seven.\"\n",830],["T_WHITESPACE","                    ",831],["T_COMMENT","\/\/  -- http:\/\/www.itu.int\/ITU-T\/studygroups\/com17\/languages\/X.690-0207.pdf (section 8.6.2.2)\n",831],["T_WHITESPACE","                    ",832],["T_VARIABLE","$this",832],["T_OBJECT_OPERATOR","->",832],["T_STRING","_string_shift",832],"(",["T_VARIABLE","$key",832],")",";",["T_WHITESPACE","\n                    ",832],["T_IF","if",833],["T_WHITESPACE"," ",833],"(",["T_STRING","ord",833],"(",["T_VARIABLE","$this",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","_string_shift",833],"(",["T_VARIABLE","$key",833],")",")",["T_WHITESPACE"," ",833],["T_IS_NOT_EQUAL","!=",833],["T_WHITESPACE"," ",833],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",833],")",["T_WHITESPACE"," ",833],"{",["T_WHITESPACE","\n                        ",833],["T_RETURN","return",834],["T_WHITESPACE"," ",834],["T_STRING","false",834],";",["T_WHITESPACE","\n                    ",834],"}",["T_WHITESPACE","\n                    ",835],["T_IF","if",836],["T_WHITESPACE"," ",836],"(",["T_VARIABLE","$this",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","_decodeLength",836],"(",["T_VARIABLE","$key",836],")",["T_WHITESPACE"," ",836],["T_IS_NOT_EQUAL","!=",836],["T_WHITESPACE"," ",836],["T_STRING","strlen",836],"(",["T_VARIABLE","$key",836],")",")",["T_WHITESPACE"," ",836],"{",["T_WHITESPACE","\n                        ",836],["T_RETURN","return",837],["T_WHITESPACE"," ",837],["T_STRING","false",837],";",["T_WHITESPACE","\n                    ",837],"}",["T_WHITESPACE","\n                    ",838],["T_VARIABLE","$tag",839],["T_WHITESPACE"," ",839],"=",["T_WHITESPACE"," ",839],["T_STRING","ord",839],"(",["T_VARIABLE","$this",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","_string_shift",839],"(",["T_VARIABLE","$key",839],")",")",";",["T_WHITESPACE","\n                ",839],"}",["T_WHITESPACE","\n                ",840],["T_IF","if",841],["T_WHITESPACE"," ",841],"(",["T_VARIABLE","$tag",841],["T_WHITESPACE"," ",841],["T_IS_NOT_EQUAL","!=",841],["T_WHITESPACE"," ",841],["T_STRING","CRYPT_RSA_ASN1_INTEGER",841],")",["T_WHITESPACE"," ",841],"{",["T_WHITESPACE","\n                    ",841],["T_RETURN","return",842],["T_WHITESPACE"," ",842],["T_STRING","false",842],";",["T_WHITESPACE","\n                ",842],"}",["T_WHITESPACE","\n\n                ",843],["T_VARIABLE","$length",845],["T_WHITESPACE"," ",845],"=",["T_WHITESPACE"," ",845],["T_VARIABLE","$this",845],["T_OBJECT_OPERATOR","->",845],["T_STRING","_decodeLength",845],"(",["T_VARIABLE","$key",845],")",";",["T_WHITESPACE","\n                ",845],["T_VARIABLE","$temp",846],["T_WHITESPACE"," ",846],"=",["T_WHITESPACE"," ",846],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","_string_shift",846],"(",["T_VARIABLE","$key",846],",",["T_WHITESPACE"," ",846],["T_VARIABLE","$length",846],")",";",["T_WHITESPACE","\n                ",846],["T_IF","if",847],["T_WHITESPACE"," ",847],"(",["T_STRING","strlen",847],"(",["T_VARIABLE","$temp",847],")",["T_WHITESPACE"," ",847],["T_IS_NOT_EQUAL","!=",847],["T_WHITESPACE"," ",847],["T_LNUMBER","1",847],["T_WHITESPACE"," ",847],["T_BOOLEAN_OR","||",847],["T_WHITESPACE"," ",847],["T_STRING","ord",847],"(",["T_VARIABLE","$temp",847],")",["T_WHITESPACE"," ",847],">",["T_WHITESPACE"," ",847],["T_LNUMBER","2",847],")",["T_WHITESPACE"," ",847],"{",["T_WHITESPACE","\n                    ",847],["T_VARIABLE","$components",848],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",848],"]",["T_WHITESPACE"," ",848],"=",["T_WHITESPACE"," ",848],["T_NEW","new",848],["T_WHITESPACE"," ",848],["T_STRING","Math_BigInteger",848],"(",["T_VARIABLE","$temp",848],",",["T_WHITESPACE"," ",848],"-",["T_LNUMBER","256",848],")",";",["T_WHITESPACE","\n                    ",848],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","_string_shift",849],"(",["T_VARIABLE","$key",849],")",";",["T_WHITESPACE"," ",849],["T_COMMENT","\/\/ skip over CRYPT_RSA_ASN1_INTEGER\n",849],["T_WHITESPACE","                    ",850],["T_VARIABLE","$length",850],["T_WHITESPACE"," ",850],"=",["T_WHITESPACE"," ",850],["T_VARIABLE","$this",850],["T_OBJECT_OPERATOR","->",850],["T_STRING","_decodeLength",850],"(",["T_VARIABLE","$key",850],")",";",["T_WHITESPACE","\n                    ",850],["T_VARIABLE","$components",851],"[",["T_VARIABLE","$type",851],["T_WHITESPACE"," ",851],["T_IS_EQUAL","==",851],["T_WHITESPACE"," ",851],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_PKCS1",851],["T_WHITESPACE"," ",851],"?",["T_WHITESPACE"," ",851],["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",851],["T_WHITESPACE"," ",851],":",["T_WHITESPACE"," ",851],["T_CONSTANT_ENCAPSED_STRING","'privateExponent'",851],"]",["T_WHITESPACE"," ",851],"=",["T_WHITESPACE"," ",851],["T_NEW","new",851],["T_WHITESPACE"," ",851],["T_STRING","Math_BigInteger",851],"(",["T_VARIABLE","$this",851],["T_OBJECT_OPERATOR","->",851],["T_STRING","_string_shift",851],"(",["T_VARIABLE","$key",851],",",["T_WHITESPACE"," ",851],["T_VARIABLE","$length",851],")",",",["T_WHITESPACE"," ",851],"-",["T_LNUMBER","256",851],")",";",["T_WHITESPACE","\n\n                    ",851],["T_RETURN","return",853],["T_WHITESPACE"," ",853],["T_VARIABLE","$components",853],";",["T_WHITESPACE","\n                ",853],"}",["T_WHITESPACE","\n                ",854],["T_IF","if",855],["T_WHITESPACE"," ",855],"(",["T_STRING","ord",855],"(",["T_VARIABLE","$this",855],["T_OBJECT_OPERATOR","->",855],["T_STRING","_string_shift",855],"(",["T_VARIABLE","$key",855],")",")",["T_WHITESPACE"," ",855],["T_IS_NOT_EQUAL","!=",855],["T_WHITESPACE"," ",855],["T_STRING","CRYPT_RSA_ASN1_INTEGER",855],")",["T_WHITESPACE"," ",855],"{",["T_WHITESPACE","\n                    ",855],["T_RETURN","return",856],["T_WHITESPACE"," ",856],["T_STRING","false",856],";",["T_WHITESPACE","\n                ",856],"}",["T_WHITESPACE","\n                ",857],["T_VARIABLE","$length",858],["T_WHITESPACE"," ",858],"=",["T_WHITESPACE"," ",858],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","_decodeLength",858],"(",["T_VARIABLE","$key",858],")",";",["T_WHITESPACE","\n                ",858],["T_VARIABLE","$components",859],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",859],"]",["T_WHITESPACE"," ",859],"=",["T_WHITESPACE"," ",859],["T_NEW","new",859],["T_WHITESPACE"," ",859],["T_STRING","Math_BigInteger",859],"(",["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","_string_shift",859],"(",["T_VARIABLE","$key",859],",",["T_WHITESPACE"," ",859],["T_VARIABLE","$length",859],")",",",["T_WHITESPACE"," ",859],"-",["T_LNUMBER","256",859],")",";",["T_WHITESPACE","\n                ",859],["T_VARIABLE","$this",860],["T_OBJECT_OPERATOR","->",860],["T_STRING","_string_shift",860],"(",["T_VARIABLE","$key",860],")",";",["T_WHITESPACE","\n                ",860],["T_VARIABLE","$length",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","_decodeLength",861],"(",["T_VARIABLE","$key",861],")",";",["T_WHITESPACE","\n                ",861],["T_VARIABLE","$components",862],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",862],"]",["T_WHITESPACE"," ",862],"=",["T_WHITESPACE"," ",862],["T_NEW","new",862],["T_WHITESPACE"," ",862],["T_STRING","Math_BigInteger",862],"(",["T_VARIABLE","$this",862],["T_OBJECT_OPERATOR","->",862],["T_STRING","_string_shift",862],"(",["T_VARIABLE","$key",862],",",["T_WHITESPACE"," ",862],["T_VARIABLE","$length",862],")",",",["T_WHITESPACE"," ",862],"-",["T_LNUMBER","256",862],")",";",["T_WHITESPACE","\n                ",862],["T_VARIABLE","$this",863],["T_OBJECT_OPERATOR","->",863],["T_STRING","_string_shift",863],"(",["T_VARIABLE","$key",863],")",";",["T_WHITESPACE","\n                ",863],["T_VARIABLE","$length",864],["T_WHITESPACE"," ",864],"=",["T_WHITESPACE"," ",864],["T_VARIABLE","$this",864],["T_OBJECT_OPERATOR","->",864],["T_STRING","_decodeLength",864],"(",["T_VARIABLE","$key",864],")",";",["T_WHITESPACE","\n                ",864],["T_VARIABLE","$components",865],"[",["T_CONSTANT_ENCAPSED_STRING","'privateExponent'",865],"]",["T_WHITESPACE"," ",865],"=",["T_WHITESPACE"," ",865],["T_NEW","new",865],["T_WHITESPACE"," ",865],["T_STRING","Math_BigInteger",865],"(",["T_VARIABLE","$this",865],["T_OBJECT_OPERATOR","->",865],["T_STRING","_string_shift",865],"(",["T_VARIABLE","$key",865],",",["T_WHITESPACE"," ",865],["T_VARIABLE","$length",865],")",",",["T_WHITESPACE"," ",865],"-",["T_LNUMBER","256",865],")",";",["T_WHITESPACE","\n                ",865],["T_VARIABLE","$this",866],["T_OBJECT_OPERATOR","->",866],["T_STRING","_string_shift",866],"(",["T_VARIABLE","$key",866],")",";",["T_WHITESPACE","\n                ",866],["T_VARIABLE","$length",867],["T_WHITESPACE"," ",867],"=",["T_WHITESPACE"," ",867],["T_VARIABLE","$this",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","_decodeLength",867],"(",["T_VARIABLE","$key",867],")",";",["T_WHITESPACE","\n                ",867],["T_VARIABLE","$components",868],"[",["T_CONSTANT_ENCAPSED_STRING","'primes'",868],"]",["T_WHITESPACE"," ",868],"=",["T_WHITESPACE"," ",868],["T_ARRAY","array",868],"(",["T_LNUMBER","1",868],["T_WHITESPACE"," ",868],["T_DOUBLE_ARROW","=>",868],["T_WHITESPACE"," ",868],["T_NEW","new",868],["T_WHITESPACE"," ",868],["T_STRING","Math_BigInteger",868],"(",["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","_string_shift",868],"(",["T_VARIABLE","$key",868],",",["T_WHITESPACE"," ",868],["T_VARIABLE","$length",868],")",",",["T_WHITESPACE"," ",868],"-",["T_LNUMBER","256",868],")",")",";",["T_WHITESPACE","\n                ",868],["T_VARIABLE","$this",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","_string_shift",869],"(",["T_VARIABLE","$key",869],")",";",["T_WHITESPACE","\n                ",869],["T_VARIABLE","$length",870],["T_WHITESPACE"," ",870],"=",["T_WHITESPACE"," ",870],["T_VARIABLE","$this",870],["T_OBJECT_OPERATOR","->",870],["T_STRING","_decodeLength",870],"(",["T_VARIABLE","$key",870],")",";",["T_WHITESPACE","\n                ",870],["T_VARIABLE","$components",871],"[",["T_CONSTANT_ENCAPSED_STRING","'primes'",871],"]","[","]",["T_WHITESPACE"," ",871],"=",["T_WHITESPACE"," ",871],["T_NEW","new",871],["T_WHITESPACE"," ",871],["T_STRING","Math_BigInteger",871],"(",["T_VARIABLE","$this",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","_string_shift",871],"(",["T_VARIABLE","$key",871],",",["T_WHITESPACE"," ",871],["T_VARIABLE","$length",871],")",",",["T_WHITESPACE"," ",871],"-",["T_LNUMBER","256",871],")",";",["T_WHITESPACE","\n                ",871],["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","_string_shift",872],"(",["T_VARIABLE","$key",872],")",";",["T_WHITESPACE","\n                ",872],["T_VARIABLE","$length",873],["T_WHITESPACE"," ",873],"=",["T_WHITESPACE"," ",873],["T_VARIABLE","$this",873],["T_OBJECT_OPERATOR","->",873],["T_STRING","_decodeLength",873],"(",["T_VARIABLE","$key",873],")",";",["T_WHITESPACE","\n                ",873],["T_VARIABLE","$components",874],"[",["T_CONSTANT_ENCAPSED_STRING","'exponents'",874],"]",["T_WHITESPACE"," ",874],"=",["T_WHITESPACE"," ",874],["T_ARRAY","array",874],"(",["T_LNUMBER","1",874],["T_WHITESPACE"," ",874],["T_DOUBLE_ARROW","=>",874],["T_WHITESPACE"," ",874],["T_NEW","new",874],["T_WHITESPACE"," ",874],["T_STRING","Math_BigInteger",874],"(",["T_VARIABLE","$this",874],["T_OBJECT_OPERATOR","->",874],["T_STRING","_string_shift",874],"(",["T_VARIABLE","$key",874],",",["T_WHITESPACE"," ",874],["T_VARIABLE","$length",874],")",",",["T_WHITESPACE"," ",874],"-",["T_LNUMBER","256",874],")",")",";",["T_WHITESPACE","\n                ",874],["T_VARIABLE","$this",875],["T_OBJECT_OPERATOR","->",875],["T_STRING","_string_shift",875],"(",["T_VARIABLE","$key",875],")",";",["T_WHITESPACE","\n                ",875],["T_VARIABLE","$length",876],["T_WHITESPACE"," ",876],"=",["T_WHITESPACE"," ",876],["T_VARIABLE","$this",876],["T_OBJECT_OPERATOR","->",876],["T_STRING","_decodeLength",876],"(",["T_VARIABLE","$key",876],")",";",["T_WHITESPACE","\n                ",876],["T_VARIABLE","$components",877],"[",["T_CONSTANT_ENCAPSED_STRING","'exponents'",877],"]","[","]",["T_WHITESPACE"," ",877],"=",["T_WHITESPACE"," ",877],["T_NEW","new",877],["T_WHITESPACE"," ",877],["T_STRING","Math_BigInteger",877],"(",["T_VARIABLE","$this",877],["T_OBJECT_OPERATOR","->",877],["T_STRING","_string_shift",877],"(",["T_VARIABLE","$key",877],",",["T_WHITESPACE"," ",877],["T_VARIABLE","$length",877],")",",",["T_WHITESPACE"," ",877],"-",["T_LNUMBER","256",877],")",";",["T_WHITESPACE","\n                ",877],["T_VARIABLE","$this",878],["T_OBJECT_OPERATOR","->",878],["T_STRING","_string_shift",878],"(",["T_VARIABLE","$key",878],")",";",["T_WHITESPACE","\n                ",878],["T_VARIABLE","$length",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","_decodeLength",879],"(",["T_VARIABLE","$key",879],")",";",["T_WHITESPACE","\n                ",879],["T_VARIABLE","$components",880],"[",["T_CONSTANT_ENCAPSED_STRING","'coefficients'",880],"]",["T_WHITESPACE"," ",880],"=",["T_WHITESPACE"," ",880],["T_ARRAY","array",880],"(",["T_LNUMBER","2",880],["T_WHITESPACE"," ",880],["T_DOUBLE_ARROW","=>",880],["T_WHITESPACE"," ",880],["T_NEW","new",880],["T_WHITESPACE"," ",880],["T_STRING","Math_BigInteger",880],"(",["T_VARIABLE","$this",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","_string_shift",880],"(",["T_VARIABLE","$key",880],",",["T_WHITESPACE"," ",880],["T_VARIABLE","$length",880],")",",",["T_WHITESPACE"," ",880],"-",["T_LNUMBER","256",880],")",")",";",["T_WHITESPACE","\n\n                ",880],["T_IF","if",882],["T_WHITESPACE"," ",882],"(","!",["T_EMPTY","empty",882],"(",["T_VARIABLE","$key",882],")",")",["T_WHITESPACE"," ",882],"{",["T_WHITESPACE","\n                    ",882],["T_IF","if",883],["T_WHITESPACE"," ",883],"(",["T_STRING","ord",883],"(",["T_VARIABLE","$this",883],["T_OBJECT_OPERATOR","->",883],["T_STRING","_string_shift",883],"(",["T_VARIABLE","$key",883],")",")",["T_WHITESPACE"," ",883],["T_IS_NOT_EQUAL","!=",883],["T_WHITESPACE"," ",883],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",883],")",["T_WHITESPACE"," ",883],"{",["T_WHITESPACE","\n                        ",883],["T_RETURN","return",884],["T_WHITESPACE"," ",884],["T_STRING","false",884],";",["T_WHITESPACE","\n                    ",884],"}",["T_WHITESPACE","\n                    ",885],["T_VARIABLE","$this",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","_decodeLength",886],"(",["T_VARIABLE","$key",886],")",";",["T_WHITESPACE","\n                    ",886],["T_WHILE","while",887],["T_WHITESPACE"," ",887],"(","!",["T_EMPTY","empty",887],"(",["T_VARIABLE","$key",887],")",")",["T_WHITESPACE"," ",887],"{",["T_WHITESPACE","\n                        ",887],["T_IF","if",888],["T_WHITESPACE"," ",888],"(",["T_STRING","ord",888],"(",["T_VARIABLE","$this",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","_string_shift",888],"(",["T_VARIABLE","$key",888],")",")",["T_WHITESPACE"," ",888],["T_IS_NOT_EQUAL","!=",888],["T_WHITESPACE"," ",888],["T_STRING","CRYPT_RSA_ASN1_SEQUENCE",888],")",["T_WHITESPACE"," ",888],"{",["T_WHITESPACE","\n                            ",888],["T_RETURN","return",889],["T_WHITESPACE"," ",889],["T_STRING","false",889],";",["T_WHITESPACE","\n                        ",889],"}",["T_WHITESPACE","\n                        ",890],["T_VARIABLE","$this",891],["T_OBJECT_OPERATOR","->",891],["T_STRING","_decodeLength",891],"(",["T_VARIABLE","$key",891],")",";",["T_WHITESPACE","\n                        ",891],["T_VARIABLE","$key",892],["T_WHITESPACE"," ",892],"=",["T_WHITESPACE"," ",892],["T_STRING","substr",892],"(",["T_VARIABLE","$key",892],",",["T_WHITESPACE"," ",892],["T_LNUMBER","1",892],")",";",["T_WHITESPACE","\n                        ",892],["T_VARIABLE","$length",893],["T_WHITESPACE"," ",893],"=",["T_WHITESPACE"," ",893],["T_VARIABLE","$this",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","_decodeLength",893],"(",["T_VARIABLE","$key",893],")",";",["T_WHITESPACE","\n                        ",893],["T_VARIABLE","$components",894],"[",["T_CONSTANT_ENCAPSED_STRING","'primes'",894],"]","[","]",["T_WHITESPACE"," ",894],"=",["T_WHITESPACE"," ",894],["T_NEW","new",894],["T_WHITESPACE"," ",894],["T_STRING","Math_BigInteger",894],"(",["T_VARIABLE","$this",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","_string_shift",894],"(",["T_VARIABLE","$key",894],",",["T_WHITESPACE"," ",894],["T_VARIABLE","$length",894],")",",",["T_WHITESPACE"," ",894],"-",["T_LNUMBER","256",894],")",";",["T_WHITESPACE","\n                        ",894],["T_VARIABLE","$this",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","_string_shift",895],"(",["T_VARIABLE","$key",895],")",";",["T_WHITESPACE","\n                        ",895],["T_VARIABLE","$length",896],["T_WHITESPACE"," ",896],"=",["T_WHITESPACE"," ",896],["T_VARIABLE","$this",896],["T_OBJECT_OPERATOR","->",896],["T_STRING","_decodeLength",896],"(",["T_VARIABLE","$key",896],")",";",["T_WHITESPACE","\n                        ",896],["T_VARIABLE","$components",897],"[",["T_CONSTANT_ENCAPSED_STRING","'exponents'",897],"]","[","]",["T_WHITESPACE"," ",897],"=",["T_WHITESPACE"," ",897],["T_NEW","new",897],["T_WHITESPACE"," ",897],["T_STRING","Math_BigInteger",897],"(",["T_VARIABLE","$this",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","_string_shift",897],"(",["T_VARIABLE","$key",897],",",["T_WHITESPACE"," ",897],["T_VARIABLE","$length",897],")",",",["T_WHITESPACE"," ",897],"-",["T_LNUMBER","256",897],")",";",["T_WHITESPACE","\n                        ",897],["T_VARIABLE","$this",898],["T_OBJECT_OPERATOR","->",898],["T_STRING","_string_shift",898],"(",["T_VARIABLE","$key",898],")",";",["T_WHITESPACE","\n                        ",898],["T_VARIABLE","$length",899],["T_WHITESPACE"," ",899],"=",["T_WHITESPACE"," ",899],["T_VARIABLE","$this",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","_decodeLength",899],"(",["T_VARIABLE","$key",899],")",";",["T_WHITESPACE","\n                        ",899],["T_VARIABLE","$components",900],"[",["T_CONSTANT_ENCAPSED_STRING","'coefficients'",900],"]","[","]",["T_WHITESPACE"," ",900],"=",["T_WHITESPACE"," ",900],["T_NEW","new",900],["T_WHITESPACE"," ",900],["T_STRING","Math_BigInteger",900],"(",["T_VARIABLE","$this",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","_string_shift",900],"(",["T_VARIABLE","$key",900],",",["T_WHITESPACE"," ",900],["T_VARIABLE","$length",900],")",",",["T_WHITESPACE"," ",900],"-",["T_LNUMBER","256",900],")",";",["T_WHITESPACE","\n                    ",900],"}",["T_WHITESPACE","\n                ",901],"}",["T_WHITESPACE","\n\n                ",902],["T_RETURN","return",904],["T_WHITESPACE"," ",904],["T_VARIABLE","$components",904],";",["T_WHITESPACE","\n            ",904],["T_CASE","case",905],["T_WHITESPACE"," ",905],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_OPENSSH",905],":",["T_WHITESPACE","\n                ",905],["T_VARIABLE","$key",906],["T_WHITESPACE"," ",906],"=",["T_WHITESPACE"," ",906],["T_STRING","base64_decode",906],"(",["T_STRING","preg_replace",906],"(",["T_CONSTANT_ENCAPSED_STRING","'#^ssh-rsa | .+$#'",906],",",["T_WHITESPACE"," ",906],["T_CONSTANT_ENCAPSED_STRING","''",906],",",["T_WHITESPACE"," ",906],["T_VARIABLE","$key",906],")",")",";",["T_WHITESPACE","\n                ",906],["T_IF","if",907],["T_WHITESPACE"," ",907],"(",["T_VARIABLE","$key",907],["T_WHITESPACE"," ",907],["T_IS_IDENTICAL","===",907],["T_WHITESPACE"," ",907],["T_STRING","false",907],")",["T_WHITESPACE"," ",907],"{",["T_WHITESPACE","\n                    ",907],["T_RETURN","return",908],["T_WHITESPACE"," ",908],["T_STRING","false",908],";",["T_WHITESPACE","\n                ",908],"}",["T_WHITESPACE","\n\n                ",909],["T_VARIABLE","$cleanup",911],["T_WHITESPACE"," ",911],"=",["T_WHITESPACE"," ",911],["T_STRING","substr",911],"(",["T_VARIABLE","$key",911],",",["T_WHITESPACE"," ",911],["T_LNUMBER","0",911],",",["T_WHITESPACE"," ",911],["T_LNUMBER","11",911],")",["T_WHITESPACE"," ",911],["T_IS_EQUAL","==",911],["T_WHITESPACE"," ",911],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\7ssh-rsa\"",911],";",["T_WHITESPACE","\n\n                ",911],["T_STRING","extract",913],"(",["T_STRING","unpack",913],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",913],",",["T_WHITESPACE"," ",913],["T_VARIABLE","$this",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","_string_shift",913],"(",["T_VARIABLE","$key",913],",",["T_WHITESPACE"," ",913],["T_LNUMBER","4",913],")",")",")",";",["T_WHITESPACE","\n                ",913],["T_VARIABLE","$publicExponent",914],["T_WHITESPACE"," ",914],"=",["T_WHITESPACE"," ",914],["T_NEW","new",914],["T_WHITESPACE"," ",914],["T_STRING","Math_BigInteger",914],"(",["T_VARIABLE","$this",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","_string_shift",914],"(",["T_VARIABLE","$key",914],",",["T_WHITESPACE"," ",914],["T_VARIABLE","$length",914],")",",",["T_WHITESPACE"," ",914],"-",["T_LNUMBER","256",914],")",";",["T_WHITESPACE","\n                ",914],["T_STRING","extract",915],"(",["T_STRING","unpack",915],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",915],",",["T_WHITESPACE"," ",915],["T_VARIABLE","$this",915],["T_OBJECT_OPERATOR","->",915],["T_STRING","_string_shift",915],"(",["T_VARIABLE","$key",915],",",["T_WHITESPACE"," ",915],["T_LNUMBER","4",915],")",")",")",";",["T_WHITESPACE","\n                ",915],["T_VARIABLE","$modulus",916],["T_WHITESPACE"," ",916],"=",["T_WHITESPACE"," ",916],["T_NEW","new",916],["T_WHITESPACE"," ",916],["T_STRING","Math_BigInteger",916],"(",["T_VARIABLE","$this",916],["T_OBJECT_OPERATOR","->",916],["T_STRING","_string_shift",916],"(",["T_VARIABLE","$key",916],",",["T_WHITESPACE"," ",916],["T_VARIABLE","$length",916],")",",",["T_WHITESPACE"," ",916],"-",["T_LNUMBER","256",916],")",";",["T_WHITESPACE","\n\n                ",916],["T_IF","if",918],["T_WHITESPACE"," ",918],"(",["T_VARIABLE","$cleanup",918],["T_WHITESPACE"," ",918],["T_BOOLEAN_AND","&&",918],["T_WHITESPACE"," ",918],["T_STRING","strlen",918],"(",["T_VARIABLE","$key",918],")",")",["T_WHITESPACE"," ",918],"{",["T_WHITESPACE","\n                    ",918],["T_STRING","extract",919],"(",["T_STRING","unpack",919],"(",["T_CONSTANT_ENCAPSED_STRING","'Nlength'",919],",",["T_WHITESPACE"," ",919],["T_VARIABLE","$this",919],["T_OBJECT_OPERATOR","->",919],["T_STRING","_string_shift",919],"(",["T_VARIABLE","$key",919],",",["T_WHITESPACE"," ",919],["T_LNUMBER","4",919],")",")",")",";",["T_WHITESPACE","\n                    ",919],["T_RETURN","return",920],["T_WHITESPACE"," ",920],["T_ARRAY","array",920],"(",["T_WHITESPACE","\n                        ",920],["T_CONSTANT_ENCAPSED_STRING","'modulus'",921],["T_WHITESPACE"," ",921],["T_DOUBLE_ARROW","=>",921],["T_WHITESPACE"," ",921],["T_NEW","new",921],["T_WHITESPACE"," ",921],["T_STRING","Math_BigInteger",921],"(",["T_VARIABLE","$this",921],["T_OBJECT_OPERATOR","->",921],["T_STRING","_string_shift",921],"(",["T_VARIABLE","$key",921],",",["T_WHITESPACE"," ",921],["T_VARIABLE","$length",921],")",",",["T_WHITESPACE"," ",921],"-",["T_LNUMBER","256",921],")",",",["T_WHITESPACE","\n                        ",921],["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",922],["T_WHITESPACE"," ",922],["T_DOUBLE_ARROW","=>",922],["T_WHITESPACE"," ",922],["T_VARIABLE","$modulus",922],["T_WHITESPACE","\n                    ",922],")",";",["T_WHITESPACE","\n                ",923],"}",["T_WHITESPACE"," ",924],["T_ELSE","else",924],["T_WHITESPACE"," ",924],"{",["T_WHITESPACE","\n                    ",924],["T_RETURN","return",925],["T_WHITESPACE"," ",925],["T_ARRAY","array",925],"(",["T_WHITESPACE","\n                        ",925],["T_CONSTANT_ENCAPSED_STRING","'modulus'",926],["T_WHITESPACE"," ",926],["T_DOUBLE_ARROW","=>",926],["T_WHITESPACE"," ",926],["T_VARIABLE","$modulus",926],",",["T_WHITESPACE","\n                        ",926],["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",927],["T_WHITESPACE"," ",927],["T_DOUBLE_ARROW","=>",927],["T_WHITESPACE"," ",927],["T_VARIABLE","$publicExponent",927],["T_WHITESPACE","\n                    ",927],")",";",["T_WHITESPACE","\n                ",928],"}",["T_WHITESPACE","\n        ",929],"}",["T_WHITESPACE","\n    ",930],"}",["T_WHITESPACE","\n\n    ",931],["T_DOC_COMMENT","\/**\n     * Loads a public or private key\n     *\n     * Returns true on success and false on failure (ie. an incorrect password was provided or the key was malformed)\n     *\n     * @access public\n     * @param String $key\n     * @param Integer $type optional\n     *\/",933],["T_WHITESPACE","\n    ",941],["T_FUNCTION","function",942],["T_WHITESPACE"," ",942],["T_STRING","loadKey",942],"(",["T_VARIABLE","$key",942],",",["T_WHITESPACE"," ",942],["T_VARIABLE","$type",942],["T_WHITESPACE"," ",942],"=",["T_WHITESPACE"," ",942],["T_STRING","CRYPT_RSA_PRIVATE_FORMAT_PKCS1",942],")",["T_WHITESPACE","\n    ",942],"{",["T_WHITESPACE","\n        ",943],["T_VARIABLE","$components",944],["T_WHITESPACE"," ",944],"=",["T_WHITESPACE"," ",944],["T_VARIABLE","$this",944],["T_OBJECT_OPERATOR","->",944],["T_STRING","_parseKey",944],"(",["T_VARIABLE","$key",944],",",["T_WHITESPACE"," ",944],["T_VARIABLE","$type",944],")",";",["T_WHITESPACE","\n        ",944],["T_IF","if",945],["T_WHITESPACE"," ",945],"(",["T_VARIABLE","$components",945],["T_WHITESPACE"," ",945],["T_IS_IDENTICAL","===",945],["T_WHITESPACE"," ",945],["T_STRING","false",945],")",["T_WHITESPACE"," ",945],"{",["T_WHITESPACE","\n            ",945],["T_RETURN","return",946],["T_WHITESPACE"," ",946],["T_STRING","false",946],";",["T_WHITESPACE","\n        ",946],"}",["T_WHITESPACE","\n\n        ",947],["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","modulus",949],["T_WHITESPACE"," ",949],"=",["T_WHITESPACE"," ",949],["T_VARIABLE","$components",949],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",949],"]",";",["T_WHITESPACE","\n        ",949],["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","k",950],["T_WHITESPACE"," ",950],"=",["T_WHITESPACE"," ",950],["T_STRING","strlen",950],"(",["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","modulus",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","toBytes",950],"(",")",")",";",["T_WHITESPACE","\n        ",950],["T_VARIABLE","$this",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","exponent",951],["T_WHITESPACE"," ",951],"=",["T_WHITESPACE"," ",951],["T_ISSET","isset",951],"(",["T_VARIABLE","$components",951],"[",["T_CONSTANT_ENCAPSED_STRING","'privateExponent'",951],"]",")",["T_WHITESPACE"," ",951],"?",["T_WHITESPACE"," ",951],["T_VARIABLE","$components",951],"[",["T_CONSTANT_ENCAPSED_STRING","'privateExponent'",951],"]",["T_WHITESPACE"," ",951],":",["T_WHITESPACE"," ",951],["T_VARIABLE","$components",951],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",951],"]",";",["T_WHITESPACE","\n        ",951],["T_IF","if",952],["T_WHITESPACE"," ",952],"(",["T_ISSET","isset",952],"(",["T_VARIABLE","$components",952],"[",["T_CONSTANT_ENCAPSED_STRING","'primes'",952],"]",")",")",["T_WHITESPACE"," ",952],"{",["T_WHITESPACE","\n            ",952],["T_VARIABLE","$this",953],["T_OBJECT_OPERATOR","->",953],["T_STRING","primes",953],["T_WHITESPACE"," ",953],"=",["T_WHITESPACE"," ",953],["T_VARIABLE","$components",953],"[",["T_CONSTANT_ENCAPSED_STRING","'primes'",953],"]",";",["T_WHITESPACE","\n            ",953],["T_VARIABLE","$this",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","exponents",954],["T_WHITESPACE"," ",954],"=",["T_WHITESPACE"," ",954],["T_VARIABLE","$components",954],"[",["T_CONSTANT_ENCAPSED_STRING","'exponents'",954],"]",";",["T_WHITESPACE","\n            ",954],["T_VARIABLE","$this",955],["T_OBJECT_OPERATOR","->",955],["T_STRING","coefficients",955],["T_WHITESPACE"," ",955],"=",["T_WHITESPACE"," ",955],["T_VARIABLE","$components",955],"[",["T_CONSTANT_ENCAPSED_STRING","'coefficients'",955],"]",";",["T_WHITESPACE","\n            ",955],["T_VARIABLE","$this",956],["T_OBJECT_OPERATOR","->",956],["T_STRING","publicExponent",956],["T_WHITESPACE"," ",956],"=",["T_WHITESPACE"," ",956],["T_VARIABLE","$components",956],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",956],"]",";",["T_WHITESPACE","\n        ",956],"}",["T_WHITESPACE"," ",957],["T_ELSE","else",957],["T_WHITESPACE"," ",957],"{",["T_WHITESPACE","\n            ",957],["T_VARIABLE","$this",958],["T_OBJECT_OPERATOR","->",958],["T_STRING","primes",958],["T_WHITESPACE"," ",958],"=",["T_WHITESPACE"," ",958],["T_ARRAY","array",958],"(",")",";",["T_WHITESPACE","\n            ",958],["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","exponents",959],["T_WHITESPACE"," ",959],"=",["T_WHITESPACE"," ",959],["T_ARRAY","array",959],"(",")",";",["T_WHITESPACE","\n            ",959],["T_VARIABLE","$this",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","coefficients",960],["T_WHITESPACE"," ",960],"=",["T_WHITESPACE"," ",960],["T_ARRAY","array",960],"(",")",";",["T_WHITESPACE","\n            ",960],["T_VARIABLE","$this",961],["T_OBJECT_OPERATOR","->",961],["T_STRING","publicExponent",961],["T_WHITESPACE"," ",961],"=",["T_WHITESPACE"," ",961],["T_STRING","false",961],";",["T_WHITESPACE","\n        ",961],"}",["T_WHITESPACE","\n\n        ",962],["T_RETURN","return",964],["T_WHITESPACE"," ",964],["T_STRING","true",964],";",["T_WHITESPACE","\n    ",964],"}",["T_WHITESPACE","\n\n    ",965],["T_DOC_COMMENT","\/**\n     * Sets the password\n     *\n     * Private keys can be encrypted with a password.  To unset the password, pass in the empty string or false.\n     * Or rather, pass in $password such that empty($password) is true.\n     *\n     * @see createKey()\n     * @see loadKey()\n     * @access public\n     * @param String $password\n     *\/",967],["T_WHITESPACE","\n    ",977],["T_FUNCTION","function",978],["T_WHITESPACE"," ",978],["T_STRING","setPassword",978],"(",["T_VARIABLE","$password",978],")",["T_WHITESPACE","\n    ",978],"{",["T_WHITESPACE","\n        ",979],["T_VARIABLE","$this",980],["T_OBJECT_OPERATOR","->",980],["T_STRING","password",980],["T_WHITESPACE"," ",980],"=",["T_WHITESPACE"," ",980],["T_VARIABLE","$password",980],";",["T_WHITESPACE","\n    ",980],"}",["T_WHITESPACE","\n\n    ",981],["T_DOC_COMMENT","\/**\n     * Defines the public key\n     *\n     * Some private key formats define the public exponent and some don't.  Those that don't define it are problematic when\n     * used in certain contexts.  For example, in SSH-2, RSA authentication works by sending the public key along with a\n     * message signed by the private key to the server.  The SSH-2 server looks the public key up in an index of public keys\n     * and if it's present then proceeds to verify the signature.  Problem is, if your private key doesn't include the public\n     * exponent this won't work unless you manually add the public exponent.\n     *\n     * Do note that when a new key is loaded the index will be cleared.\n     *\n     * Returns true on success, false on failure\n     *\n     * @see getPublicKey()\n     * @access public\n     * @param String $key\n     * @param Integer $type optional\n     * @return Boolean\n     *\/",983],["T_WHITESPACE","\n    ",1001],["T_FUNCTION","function",1002],["T_WHITESPACE"," ",1002],["T_STRING","setPublicKey",1002],"(",["T_VARIABLE","$key",1002],",",["T_WHITESPACE"," ",1002],["T_VARIABLE","$type",1002],["T_WHITESPACE"," ",1002],"=",["T_WHITESPACE"," ",1002],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_PKCS1",1002],")",["T_WHITESPACE","\n    ",1002],"{",["T_WHITESPACE","\n        ",1003],["T_VARIABLE","$components",1004],["T_WHITESPACE"," ",1004],"=",["T_WHITESPACE"," ",1004],["T_VARIABLE","$this",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","_parseKey",1004],"(",["T_VARIABLE","$key",1004],",",["T_WHITESPACE"," ",1004],["T_VARIABLE","$type",1004],")",";",["T_WHITESPACE","\n        ",1004],["T_IF","if",1005],["T_WHITESPACE"," ",1005],"(",["T_EMPTY","empty",1005],"(",["T_VARIABLE","$this",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","modulus",1005],")",["T_WHITESPACE"," ",1005],["T_BOOLEAN_OR","||",1005],["T_WHITESPACE"," ",1005],"!",["T_VARIABLE","$this",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","modulus",1005],["T_OBJECT_OPERATOR","->",1005],["T_STRING","equals",1005],"(",["T_VARIABLE","$components",1005],"[",["T_CONSTANT_ENCAPSED_STRING","'modulus'",1005],"]",")",")",["T_WHITESPACE"," ",1005],"{",["T_WHITESPACE","\n            ",1005],["T_RETURN","return",1006],["T_WHITESPACE"," ",1006],["T_STRING","false",1006],";",["T_WHITESPACE","\n        ",1006],"}",["T_WHITESPACE","\n        ",1007],["T_VARIABLE","$this",1008],["T_OBJECT_OPERATOR","->",1008],["T_STRING","publicExponent",1008],["T_WHITESPACE"," ",1008],"=",["T_WHITESPACE"," ",1008],["T_VARIABLE","$components",1008],"[",["T_CONSTANT_ENCAPSED_STRING","'publicExponent'",1008],"]",";",["T_WHITESPACE","\n    ",1008],"}",["T_WHITESPACE","\n\n    ",1009],["T_DOC_COMMENT","\/**\n     * Returns the public key\n     *\n     * The public key is only returned under two circumstances - if the private key had the public key embedded within it\n     * or if the public key was set via setPublicKey().  If the currently loaded key is supposed to be the public key this\n     * function won't return it since this library, for the most part, doesn't distinguish between public and private keys.\n     *\n     * @see getPublicKey()\n     * @access public\n     * @param String $key\n     * @param Integer $type optional\n     *\/",1011],["T_WHITESPACE","\n    ",1022],["T_FUNCTION","function",1023],["T_WHITESPACE"," ",1023],["T_STRING","getPublicKey",1023],"(",["T_VARIABLE","$type",1023],["T_WHITESPACE"," ",1023],"=",["T_WHITESPACE"," ",1023],["T_STRING","CRYPT_RSA_PUBLIC_FORMAT_PKCS1",1023],")",["T_WHITESPACE","\n    ",1023],"{",["T_WHITESPACE","\n        ",1024],["T_IF","if",1025],["T_WHITESPACE"," ",1025],"(",["T_EMPTY","empty",1025],"(",["T_VARIABLE","$this",1025],["T_OBJECT_OPERATOR","->",1025],["T_STRING","modulus",1025],")",["T_WHITESPACE"," ",1025],["T_BOOLEAN_OR","||",1025],["T_WHITESPACE"," ",1025],["T_EMPTY","empty",1025],"(",["T_VARIABLE","$this",1025],["T_OBJECT_OPERATOR","->",1025],["T_STRING","publicExponent",1025],")",")",["T_WHITESPACE"," ",1025],"{",["T_WHITESPACE","\n            ",1025],["T_RETURN","return",1026],["T_WHITESPACE"," ",1026],["T_STRING","false",1026],";",["T_WHITESPACE","\n        ",1026],"}",["T_WHITESPACE","\n\n        ",1027],["T_VARIABLE","$oldFormat",1029],["T_WHITESPACE"," ",1029],"=",["T_WHITESPACE"," ",1029],["T_VARIABLE","$this",1029],["T_OBJECT_OPERATOR","->",1029],["T_STRING","publicKeyFormat",1029],";",["T_WHITESPACE","\n        ",1029],["T_VARIABLE","$this",1030],["T_OBJECT_OPERATOR","->",1030],["T_STRING","publicKeyFormat",1030],["T_WHITESPACE"," ",1030],"=",["T_WHITESPACE"," ",1030],["T_VARIABLE","$type",1030],";",["T_WHITESPACE","\n        ",1030],["T_VARIABLE","$temp",1031],["T_WHITESPACE"," ",1031],"=",["T_WHITESPACE"," ",1031],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","_convertPublicKey",1031],"(",["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","modulus",1031],",",["T_WHITESPACE"," ",1031],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","publicExponent",1031],")",";",["T_WHITESPACE","\n        ",1031],["T_VARIABLE","$this",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","publicKeyFormat",1032],["T_WHITESPACE"," ",1032],"=",["T_WHITESPACE"," ",1032],["T_VARIABLE","$oldFormat",1032],";",["T_WHITESPACE","\n        ",1032],["T_RETURN","return",1033],["T_WHITESPACE"," ",1033],["T_VARIABLE","$temp",1033],";",["T_WHITESPACE","\n    ",1033],"}",["T_WHITESPACE","\n\n    ",1034],["T_DOC_COMMENT","\/**\n     * Generates the smallest and largest numbers requiring $bits bits\n     *\n     * @access private\n     * @param Integer $bits\n     * @return Array\n     *\/",1036],["T_WHITESPACE","\n    ",1042],["T_FUNCTION","function",1043],["T_WHITESPACE"," ",1043],["T_STRING","_generateMinMax",1043],"(",["T_VARIABLE","$bits",1043],")",["T_WHITESPACE","\n    ",1043],"{",["T_WHITESPACE","\n        ",1044],["T_VARIABLE","$bytes",1045],["T_WHITESPACE"," ",1045],"=",["T_WHITESPACE"," ",1045],["T_VARIABLE","$bits",1045],["T_WHITESPACE"," ",1045],["T_SR",">>",1045],["T_WHITESPACE"," ",1045],["T_LNUMBER","3",1045],";",["T_WHITESPACE","\n        ",1045],["T_VARIABLE","$min",1046],["T_WHITESPACE"," ",1046],"=",["T_WHITESPACE"," ",1046],["T_STRING","str_repeat",1046],"(",["T_STRING","chr",1046],"(",["T_LNUMBER","0",1046],")",",",["T_WHITESPACE"," ",1046],["T_VARIABLE","$bytes",1046],")",";",["T_WHITESPACE","\n        ",1046],["T_VARIABLE","$max",1047],["T_WHITESPACE"," ",1047],"=",["T_WHITESPACE"," ",1047],["T_STRING","str_repeat",1047],"(",["T_STRING","chr",1047],"(",["T_LNUMBER","0xFF",1047],")",",",["T_WHITESPACE"," ",1047],["T_VARIABLE","$bytes",1047],")",";",["T_WHITESPACE","\n        ",1047],["T_VARIABLE","$msb",1048],["T_WHITESPACE"," ",1048],"=",["T_WHITESPACE"," ",1048],["T_VARIABLE","$bits",1048],["T_WHITESPACE"," ",1048],"&",["T_WHITESPACE"," ",1048],["T_LNUMBER","7",1048],";",["T_WHITESPACE","\n        ",1048],["T_IF","if",1049],["T_WHITESPACE"," ",1049],"(",["T_VARIABLE","$msb",1049],")",["T_WHITESPACE"," ",1049],"{",["T_WHITESPACE","\n            ",1049],["T_VARIABLE","$min",1050],["T_WHITESPACE"," ",1050],"=",["T_WHITESPACE"," ",1050],["T_STRING","chr",1050],"(",["T_LNUMBER","1",1050],["T_WHITESPACE"," ",1050],["T_SL","<<",1050],["T_WHITESPACE"," ",1050],"(",["T_VARIABLE","$msb",1050],["T_WHITESPACE"," ",1050],"-",["T_WHITESPACE"," ",1050],["T_LNUMBER","1",1050],")",")",["T_WHITESPACE"," ",1050],".",["T_WHITESPACE"," ",1050],["T_VARIABLE","$min",1050],";",["T_WHITESPACE","\n            ",1050],["T_VARIABLE","$max",1051],["T_WHITESPACE"," ",1051],"=",["T_WHITESPACE"," ",1051],["T_STRING","chr",1051],"(","(",["T_LNUMBER","1",1051],["T_WHITESPACE"," ",1051],["T_SL","<<",1051],["T_WHITESPACE"," ",1051],["T_VARIABLE","$msb",1051],")",["T_WHITESPACE"," ",1051],"-",["T_WHITESPACE"," ",1051],["T_LNUMBER","1",1051],")",["T_WHITESPACE"," ",1051],".",["T_WHITESPACE"," ",1051],["T_VARIABLE","$max",1051],";",["T_WHITESPACE","\n        ",1051],"}",["T_WHITESPACE"," ",1052],["T_ELSE","else",1052],["T_WHITESPACE"," ",1052],"{",["T_WHITESPACE","\n            ",1052],["T_VARIABLE","$min",1053],"[",["T_LNUMBER","0",1053],"]",["T_WHITESPACE"," ",1053],"=",["T_WHITESPACE"," ",1053],["T_STRING","chr",1053],"(",["T_LNUMBER","0x80",1053],")",";",["T_WHITESPACE","\n        ",1053],"}",["T_WHITESPACE","\n\n        ",1054],["T_RETURN","return",1056],["T_WHITESPACE"," ",1056],["T_ARRAY","array",1056],"(",["T_WHITESPACE","\n            ",1056],["T_CONSTANT_ENCAPSED_STRING","'min'",1057],["T_WHITESPACE"," ",1057],["T_DOUBLE_ARROW","=>",1057],["T_WHITESPACE"," ",1057],["T_NEW","new",1057],["T_WHITESPACE"," ",1057],["T_STRING","Math_BigInteger",1057],"(",["T_VARIABLE","$min",1057],",",["T_WHITESPACE"," ",1057],["T_LNUMBER","256",1057],")",",",["T_WHITESPACE","\n            ",1057],["T_CONSTANT_ENCAPSED_STRING","'max'",1058],["T_WHITESPACE"," ",1058],["T_DOUBLE_ARROW","=>",1058],["T_WHITESPACE"," ",1058],["T_NEW","new",1058],["T_WHITESPACE"," ",1058],["T_STRING","Math_BigInteger",1058],"(",["T_VARIABLE","$max",1058],",",["T_WHITESPACE"," ",1058],["T_LNUMBER","256",1058],")",["T_WHITESPACE","\n        ",1058],")",";",["T_WHITESPACE","\n    ",1059],"}",["T_WHITESPACE","\n\n    ",1060],["T_DOC_COMMENT","\/**\n     * DER-decode the length\n     *\n     * DER supports lengths up to (2**8)**127, however, we'll only support lengths up to (2**8)**4.  See\n     * {@link http:\/\/itu.int\/ITU-T\/studygroups\/com17\/languages\/X.690-0207.pdf#p=13 X.690 \u00ef\u00bf\u00bd 8.1.3} for more information.\n     *\n     * @access private\n     * @param String $string\n     * @return Integer\n     *\/",1062],["T_WHITESPACE","\n    ",1071],["T_FUNCTION","function",1072],["T_WHITESPACE"," ",1072],["T_STRING","_decodeLength",1072],"(","&",["T_VARIABLE","$string",1072],")",["T_WHITESPACE","\n    ",1072],"{",["T_WHITESPACE","\n        ",1073],["T_VARIABLE","$length",1074],["T_WHITESPACE"," ",1074],"=",["T_WHITESPACE"," ",1074],["T_STRING","ord",1074],"(",["T_VARIABLE","$this",1074],["T_OBJECT_OPERATOR","->",1074],["T_STRING","_string_shift",1074],"(",["T_VARIABLE","$string",1074],")",")",";",["T_WHITESPACE","\n        ",1074],["T_IF","if",1075],["T_WHITESPACE"," ",1075],"(",["T_WHITESPACE"," ",1075],["T_VARIABLE","$length",1075],["T_WHITESPACE"," ",1075],"&",["T_WHITESPACE"," ",1075],["T_LNUMBER","0x80",1075],["T_WHITESPACE"," ",1075],")",["T_WHITESPACE"," ",1075],"{",["T_WHITESPACE"," ",1075],["T_COMMENT","\/\/ definite length, long form\n",1075],["T_WHITESPACE","            ",1076],["T_VARIABLE","$length",1076],["T_AND_EQUAL","&=",1076],["T_WHITESPACE"," ",1076],["T_LNUMBER","0x7F",1076],";",["T_WHITESPACE","\n            ",1076],["T_VARIABLE","$temp",1077],["T_WHITESPACE"," ",1077],"=",["T_WHITESPACE"," ",1077],["T_VARIABLE","$this",1077],["T_OBJECT_OPERATOR","->",1077],["T_STRING","_string_shift",1077],"(",["T_VARIABLE","$string",1077],",",["T_WHITESPACE"," ",1077],["T_VARIABLE","$length",1077],")",";",["T_WHITESPACE","\n            ",1077],["T_LIST","list",1078],"(",",",["T_WHITESPACE"," ",1078],["T_VARIABLE","$length",1078],")",["T_WHITESPACE"," ",1078],"=",["T_WHITESPACE"," ",1078],["T_STRING","unpack",1078],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",1078],",",["T_WHITESPACE"," ",1078],["T_STRING","substr",1078],"(",["T_STRING","str_pad",1078],"(",["T_VARIABLE","$temp",1078],",",["T_WHITESPACE"," ",1078],["T_LNUMBER","4",1078],",",["T_WHITESPACE"," ",1078],["T_STRING","chr",1078],"(",["T_LNUMBER","0",1078],")",",",["T_WHITESPACE"," ",1078],["T_STRING","STR_PAD_LEFT",1078],")",",",["T_WHITESPACE"," ",1078],"-",["T_LNUMBER","4",1078],")",")",";",["T_WHITESPACE","\n        ",1078],"}",["T_WHITESPACE","\n        ",1079],["T_RETURN","return",1080],["T_WHITESPACE"," ",1080],["T_VARIABLE","$length",1080],";",["T_WHITESPACE","\n    ",1080],"}",["T_WHITESPACE","\n\n    ",1081],["T_DOC_COMMENT","\/**\n     * DER-encode the length\n     *\n     * DER supports lengths up to (2**8)**127, however, we'll only support lengths up to (2**8)**4.  See\n     * {@link http:\/\/itu.int\/ITU-T\/studygroups\/com17\/languages\/X.690-0207.pdf#p=13 X.690 \u00ef\u00bf\u00bd 8.1.3} for more information.\n     *\n     * @access private\n     * @param Integer $length\n     * @return String\n     *\/",1083],["T_WHITESPACE","\n    ",1092],["T_FUNCTION","function",1093],["T_WHITESPACE"," ",1093],["T_STRING","_encodeLength",1093],"(",["T_VARIABLE","$length",1093],")",["T_WHITESPACE","\n    ",1093],"{",["T_WHITESPACE","\n        ",1094],["T_IF","if",1095],["T_WHITESPACE"," ",1095],"(",["T_VARIABLE","$length",1095],["T_WHITESPACE"," ",1095],["T_IS_SMALLER_OR_EQUAL","<=",1095],["T_WHITESPACE"," ",1095],["T_LNUMBER","0x7F",1095],")",["T_WHITESPACE"," ",1095],"{",["T_WHITESPACE","\n            ",1095],["T_RETURN","return",1096],["T_WHITESPACE"," ",1096],["T_STRING","chr",1096],"(",["T_VARIABLE","$length",1096],")",";",["T_WHITESPACE","\n        ",1096],"}",["T_WHITESPACE","\n\n        ",1097],["T_VARIABLE","$temp",1099],["T_WHITESPACE"," ",1099],"=",["T_WHITESPACE"," ",1099],["T_STRING","ltrim",1099],"(",["T_STRING","pack",1099],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",1099],",",["T_WHITESPACE"," ",1099],["T_VARIABLE","$length",1099],")",",",["T_WHITESPACE"," ",1099],["T_STRING","chr",1099],"(",["T_LNUMBER","0",1099],")",")",";",["T_WHITESPACE","\n        ",1099],["T_RETURN","return",1100],["T_WHITESPACE"," ",1100],["T_STRING","pack",1100],"(",["T_CONSTANT_ENCAPSED_STRING","'Ca*'",1100],",",["T_WHITESPACE"," ",1100],["T_LNUMBER","0x80",1100],["T_WHITESPACE"," ",1100],"|",["T_WHITESPACE"," ",1100],["T_STRING","strlen",1100],"(",["T_VARIABLE","$temp",1100],")",",",["T_WHITESPACE"," ",1100],["T_VARIABLE","$temp",1100],")",";",["T_WHITESPACE","\n    ",1100],"}",["T_WHITESPACE","\n\n    ",1101],["T_DOC_COMMENT","\/**\n     * String Shift\n     *\n     * Inspired by array_shift\n     *\n     * @param String $string\n     * @param optional Integer $index\n     * @return String\n     * @access private\n     *\/",1103],["T_WHITESPACE","\n    ",1112],["T_FUNCTION","function",1113],["T_WHITESPACE"," ",1113],["T_STRING","_string_shift",1113],"(","&",["T_VARIABLE","$string",1113],",",["T_WHITESPACE"," ",1113],["T_VARIABLE","$index",1113],["T_WHITESPACE"," ",1113],"=",["T_WHITESPACE"," ",1113],["T_LNUMBER","1",1113],")",["T_WHITESPACE","\n    ",1113],"{",["T_WHITESPACE","\n        ",1114],["T_VARIABLE","$substr",1115],["T_WHITESPACE"," ",1115],"=",["T_WHITESPACE"," ",1115],["T_STRING","substr",1115],"(",["T_VARIABLE","$string",1115],",",["T_WHITESPACE"," ",1115],["T_LNUMBER","0",1115],",",["T_WHITESPACE"," ",1115],["T_VARIABLE","$index",1115],")",";",["T_WHITESPACE","\n        ",1115],["T_VARIABLE","$string",1116],["T_WHITESPACE"," ",1116],"=",["T_WHITESPACE"," ",1116],["T_STRING","substr",1116],"(",["T_VARIABLE","$string",1116],",",["T_WHITESPACE"," ",1116],["T_VARIABLE","$index",1116],")",";",["T_WHITESPACE","\n        ",1116],["T_RETURN","return",1117],["T_WHITESPACE"," ",1117],["T_VARIABLE","$substr",1117],";",["T_WHITESPACE","\n    ",1117],"}",["T_WHITESPACE","\n\n    ",1118],["T_DOC_COMMENT","\/**\n     * Determines the private key format\n     *\n     * @see createKey()\n     * @access public\n     * @param Integer $format\n     *\/",1120],["T_WHITESPACE","\n    ",1126],["T_FUNCTION","function",1127],["T_WHITESPACE"," ",1127],["T_STRING","setPrivateKeyFormat",1127],"(",["T_VARIABLE","$format",1127],")",["T_WHITESPACE","\n    ",1127],"{",["T_WHITESPACE","\n        ",1128],["T_VARIABLE","$this",1129],["T_OBJECT_OPERATOR","->",1129],["T_STRING","privateKeyFormat",1129],["T_WHITESPACE"," ",1129],"=",["T_WHITESPACE"," ",1129],["T_VARIABLE","$format",1129],";",["T_WHITESPACE","\n    ",1129],"}",["T_WHITESPACE","\n\n    ",1130],["T_DOC_COMMENT","\/**\n     * Determines the public key format\n     *\n     * @see createKey()\n     * @access public\n     * @param Integer $format\n     *\/",1132],["T_WHITESPACE","\n    ",1138],["T_FUNCTION","function",1139],["T_WHITESPACE"," ",1139],["T_STRING","setPublicKeyFormat",1139],"(",["T_VARIABLE","$format",1139],")",["T_WHITESPACE","\n    ",1139],"{",["T_WHITESPACE","\n        ",1140],["T_VARIABLE","$this",1141],["T_OBJECT_OPERATOR","->",1141],["T_STRING","publicKeyFormat",1141],["T_WHITESPACE"," ",1141],"=",["T_WHITESPACE"," ",1141],["T_VARIABLE","$format",1141],";",["T_WHITESPACE","\n    ",1141],"}",["T_WHITESPACE","\n\n    ",1142],["T_DOC_COMMENT","\/**\n     * Determines which hashing function should be used\n     *\n     * Used with signature production \/ verification and (if the encryption mode is CRYPT_RSA_ENCRYPTION_OAEP) encryption and\n     * decryption.  If $hash isn't supported, sha1 is used.\n     *\n     * @access public\n     * @param String $hash\n     *\/",1144],["T_WHITESPACE","\n    ",1152],["T_FUNCTION","function",1153],["T_WHITESPACE"," ",1153],["T_STRING","setHash",1153],"(",["T_VARIABLE","$hash",1153],")",["T_WHITESPACE","\n    ",1153],"{",["T_WHITESPACE","\n        ",1154],["T_COMMENT","\/\/ Crypt_Hash supports algorithms that PKCS#1 doesn't support.  md5-96 and sha1-96, for example.\n",1155],["T_WHITESPACE","        ",1156],["T_SWITCH","switch",1156],["T_WHITESPACE"," ",1156],"(",["T_VARIABLE","$hash",1156],")",["T_WHITESPACE"," ",1156],"{",["T_WHITESPACE","\n            ",1156],["T_CASE","case",1157],["T_WHITESPACE"," ",1157],["T_CONSTANT_ENCAPSED_STRING","'md2'",1157],":",["T_WHITESPACE","\n            ",1157],["T_CASE","case",1158],["T_WHITESPACE"," ",1158],["T_CONSTANT_ENCAPSED_STRING","'md5'",1158],":",["T_WHITESPACE","\n            ",1158],["T_CASE","case",1159],["T_WHITESPACE"," ",1159],["T_CONSTANT_ENCAPSED_STRING","'sha1'",1159],":",["T_WHITESPACE","\n            ",1159],["T_CASE","case",1160],["T_WHITESPACE"," ",1160],["T_CONSTANT_ENCAPSED_STRING","'sha256'",1160],":",["T_WHITESPACE","\n            ",1160],["T_CASE","case",1161],["T_WHITESPACE"," ",1161],["T_CONSTANT_ENCAPSED_STRING","'sha384'",1161],":",["T_WHITESPACE","\n            ",1161],["T_CASE","case",1162],["T_WHITESPACE"," ",1162],["T_CONSTANT_ENCAPSED_STRING","'sha512'",1162],":",["T_WHITESPACE","\n                ",1162],["T_VARIABLE","$this",1163],["T_OBJECT_OPERATOR","->",1163],["T_STRING","hash",1163],["T_WHITESPACE"," ",1163],"=",["T_WHITESPACE"," ",1163],["T_NEW","new",1163],["T_WHITESPACE"," ",1163],["T_STRING","Crypt_Hash",1163],"(",["T_VARIABLE","$hash",1163],")",";",["T_WHITESPACE","\n                ",1163],["T_VARIABLE","$this",1164],["T_OBJECT_OPERATOR","->",1164],["T_STRING","hashName",1164],["T_WHITESPACE"," ",1164],"=",["T_WHITESPACE"," ",1164],["T_VARIABLE","$hash",1164],";",["T_WHITESPACE","\n                ",1164],["T_BREAK","break",1165],";",["T_WHITESPACE","\n            ",1165],["T_DEFAULT","default",1166],":",["T_WHITESPACE","\n                ",1166],["T_VARIABLE","$this",1167],["T_OBJECT_OPERATOR","->",1167],["T_STRING","hash",1167],["T_WHITESPACE"," ",1167],"=",["T_WHITESPACE"," ",1167],["T_NEW","new",1167],["T_WHITESPACE"," ",1167],["T_STRING","Crypt_Hash",1167],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1'",1167],")",";",["T_WHITESPACE","\n                ",1167],["T_VARIABLE","$this",1168],["T_OBJECT_OPERATOR","->",1168],["T_STRING","hashName",1168],["T_WHITESPACE"," ",1168],"=",["T_WHITESPACE"," ",1168],["T_CONSTANT_ENCAPSED_STRING","'sha1'",1168],";",["T_WHITESPACE","\n        ",1168],"}",["T_WHITESPACE","\n        ",1169],["T_VARIABLE","$this",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","hLen",1170],["T_WHITESPACE"," ",1170],"=",["T_WHITESPACE"," ",1170],["T_VARIABLE","$this",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","hash",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","getLength",1170],"(",")",";",["T_WHITESPACE","\n    ",1170],"}",["T_WHITESPACE","\n\n    ",1171],["T_DOC_COMMENT","\/**\n     * Determines which hashing function should be used for the mask generation function\n     *\n     * The mask generation function is used by CRYPT_RSA_ENCRYPTION_OAEP and CRYPT_RSA_SIGNATURE_PSS and although it's\n     * best if Hash and MGFHash are set to the same thing this is not a requirement.\n     *\n     * @access public\n     * @param String $hash\n     *\/",1173],["T_WHITESPACE","\n    ",1181],["T_FUNCTION","function",1182],["T_WHITESPACE"," ",1182],["T_STRING","setMGFHash",1182],"(",["T_VARIABLE","$hash",1182],")",["T_WHITESPACE","\n    ",1182],"{",["T_WHITESPACE","\n        ",1183],["T_COMMENT","\/\/ Crypt_Hash supports algorithms that PKCS#1 doesn't support.  md5-96 and sha1-96, for example.\n",1184],["T_WHITESPACE","        ",1185],["T_SWITCH","switch",1185],["T_WHITESPACE"," ",1185],"(",["T_VARIABLE","$hash",1185],")",["T_WHITESPACE"," ",1185],"{",["T_WHITESPACE","\n            ",1185],["T_CASE","case",1186],["T_WHITESPACE"," ",1186],["T_CONSTANT_ENCAPSED_STRING","'md2'",1186],":",["T_WHITESPACE","\n            ",1186],["T_CASE","case",1187],["T_WHITESPACE"," ",1187],["T_CONSTANT_ENCAPSED_STRING","'md5'",1187],":",["T_WHITESPACE","\n            ",1187],["T_CASE","case",1188],["T_WHITESPACE"," ",1188],["T_CONSTANT_ENCAPSED_STRING","'sha1'",1188],":",["T_WHITESPACE","\n            ",1188],["T_CASE","case",1189],["T_WHITESPACE"," ",1189],["T_CONSTANT_ENCAPSED_STRING","'sha256'",1189],":",["T_WHITESPACE","\n            ",1189],["T_CASE","case",1190],["T_WHITESPACE"," ",1190],["T_CONSTANT_ENCAPSED_STRING","'sha384'",1190],":",["T_WHITESPACE","\n            ",1190],["T_CASE","case",1191],["T_WHITESPACE"," ",1191],["T_CONSTANT_ENCAPSED_STRING","'sha512'",1191],":",["T_WHITESPACE","\n                ",1191],["T_VARIABLE","$this",1192],["T_OBJECT_OPERATOR","->",1192],["T_STRING","mgfHash",1192],["T_WHITESPACE"," ",1192],"=",["T_WHITESPACE"," ",1192],["T_NEW","new",1192],["T_WHITESPACE"," ",1192],["T_STRING","Crypt_Hash",1192],"(",["T_VARIABLE","$hash",1192],")",";",["T_WHITESPACE","\n                ",1192],["T_BREAK","break",1193],";",["T_WHITESPACE","\n            ",1193],["T_DEFAULT","default",1194],":",["T_WHITESPACE","\n                ",1194],["T_VARIABLE","$this",1195],["T_OBJECT_OPERATOR","->",1195],["T_STRING","mgfHash",1195],["T_WHITESPACE"," ",1195],"=",["T_WHITESPACE"," ",1195],["T_NEW","new",1195],["T_WHITESPACE"," ",1195],["T_STRING","Crypt_Hash",1195],"(",["T_CONSTANT_ENCAPSED_STRING","'sha1'",1195],")",";",["T_WHITESPACE","\n        ",1195],"}",["T_WHITESPACE","\n        ",1196],["T_VARIABLE","$this",1197],["T_OBJECT_OPERATOR","->",1197],["T_STRING","mgfHLen",1197],["T_WHITESPACE"," ",1197],"=",["T_WHITESPACE"," ",1197],["T_VARIABLE","$this",1197],["T_OBJECT_OPERATOR","->",1197],["T_STRING","mgfHash",1197],["T_OBJECT_OPERATOR","->",1197],["T_STRING","getLength",1197],"(",")",";",["T_WHITESPACE","\n    ",1197],"}",["T_WHITESPACE","\n\n    ",1198],["T_DOC_COMMENT","\/**\n     * Determines the salt length\n     *\n     * To quote from {@link http:\/\/tools.ietf.org\/html\/rfc3447#page-38 RFC3447#page-38}:\n     *\n     *    Typical salt lengths in octets are hLen (the length of the output\n     *    of the hash function Hash) and 0.\n     *\n     * @access public\n     * @param Integer $format\n     *\/",1200],["T_WHITESPACE","\n    ",1210],["T_FUNCTION","function",1211],["T_WHITESPACE"," ",1211],["T_STRING","setSaltLength",1211],"(",["T_VARIABLE","$sLen",1211],")",["T_WHITESPACE","\n    ",1211],"{",["T_WHITESPACE","\n        ",1212],["T_VARIABLE","$this",1213],["T_OBJECT_OPERATOR","->",1213],["T_STRING","sLen",1213],["T_WHITESPACE"," ",1213],"=",["T_WHITESPACE"," ",1213],["T_VARIABLE","$sLen",1213],";",["T_WHITESPACE","\n    ",1213],"}",["T_WHITESPACE","\n\n    ",1214],["T_DOC_COMMENT","\/**\n     * Generates a random string x bytes long\n     *\n     * @access public\n     * @param Integer $bytes\n     * @param optional Integer $nonzero\n     * @return String\n     *\/",1216],["T_WHITESPACE","\n    ",1223],["T_FUNCTION","function",1224],["T_WHITESPACE"," ",1224],["T_STRING","_random",1224],"(",["T_VARIABLE","$bytes",1224],",",["T_WHITESPACE"," ",1224],["T_VARIABLE","$nonzero",1224],["T_WHITESPACE"," ",1224],"=",["T_WHITESPACE"," ",1224],["T_STRING","false",1224],")",["T_WHITESPACE","\n    ",1224],"{",["T_WHITESPACE","\n        ",1225],["T_VARIABLE","$temp",1226],["T_WHITESPACE"," ",1226],"=",["T_WHITESPACE"," ",1226],["T_CONSTANT_ENCAPSED_STRING","''",1226],";",["T_WHITESPACE","\n        ",1226],["T_IF","if",1227],["T_WHITESPACE"," ",1227],"(",["T_VARIABLE","$nonzero",1227],")",["T_WHITESPACE"," ",1227],"{",["T_WHITESPACE","\n            ",1227],["T_FOR","for",1228],["T_WHITESPACE"," ",1228],"(",["T_VARIABLE","$i",1228],["T_WHITESPACE"," ",1228],"=",["T_WHITESPACE"," ",1228],["T_LNUMBER","0",1228],";",["T_WHITESPACE"," ",1228],["T_VARIABLE","$i",1228],["T_WHITESPACE"," ",1228],"<",["T_WHITESPACE"," ",1228],["T_VARIABLE","$bytes",1228],";",["T_WHITESPACE"," ",1228],["T_VARIABLE","$i",1228],["T_INC","++",1228],")",["T_WHITESPACE"," ",1228],"{",["T_WHITESPACE","\n                ",1228],["T_VARIABLE","$temp",1229],["T_CONCAT_EQUAL",".=",1229],["T_WHITESPACE"," ",1229],["T_STRING","chr",1229],"(",["T_STRING","crypt_random",1229],"(",["T_LNUMBER","1",1229],",",["T_WHITESPACE"," ",1229],["T_LNUMBER","255",1229],")",")",";",["T_WHITESPACE","\n            ",1229],"}",["T_WHITESPACE","\n        ",1230],"}",["T_WHITESPACE"," ",1231],["T_ELSE","else",1231],["T_WHITESPACE"," ",1231],"{",["T_WHITESPACE","\n            ",1231],["T_VARIABLE","$ints",1232],["T_WHITESPACE"," ",1232],"=",["T_WHITESPACE"," ",1232],"(",["T_VARIABLE","$bytes",1232],["T_WHITESPACE"," ",1232],"+",["T_WHITESPACE"," ",1232],["T_LNUMBER","1",1232],")",["T_WHITESPACE"," ",1232],["T_SR",">>",1232],["T_WHITESPACE"," ",1232],["T_LNUMBER","2",1232],";",["T_WHITESPACE","\n            ",1232],["T_FOR","for",1233],["T_WHITESPACE"," ",1233],"(",["T_VARIABLE","$i",1233],["T_WHITESPACE"," ",1233],"=",["T_WHITESPACE"," ",1233],["T_LNUMBER","0",1233],";",["T_WHITESPACE"," ",1233],["T_VARIABLE","$i",1233],["T_WHITESPACE"," ",1233],"<",["T_WHITESPACE"," ",1233],["T_VARIABLE","$ints",1233],";",["T_WHITESPACE"," ",1233],["T_VARIABLE","$i",1233],["T_INC","++",1233],")",["T_WHITESPACE"," ",1233],"{",["T_WHITESPACE","\n                ",1233],["T_VARIABLE","$temp",1234],["T_CONCAT_EQUAL",".=",1234],["T_WHITESPACE"," ",1234],["T_STRING","pack",1234],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",1234],",",["T_WHITESPACE"," ",1234],["T_STRING","crypt_random",1234],"(",")",")",";",["T_WHITESPACE","\n            ",1234],"}",["T_WHITESPACE","\n            ",1235],["T_VARIABLE","$temp",1236],["T_WHITESPACE"," ",1236],"=",["T_WHITESPACE"," ",1236],["T_STRING","substr",1236],"(",["T_VARIABLE","$temp",1236],",",["T_WHITESPACE"," ",1236],["T_LNUMBER","0",1236],",",["T_WHITESPACE"," ",1236],["T_VARIABLE","$bytes",1236],")",";",["T_WHITESPACE","\n        ",1236],"}",["T_WHITESPACE","\n        ",1237],["T_RETURN","return",1238],["T_WHITESPACE"," ",1238],["T_VARIABLE","$temp",1238],";",["T_WHITESPACE","\n    ",1238],"}",["T_WHITESPACE","\n\n    ",1239],["T_DOC_COMMENT","\/**\n     * Integer-to-Octet-String primitive\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-4.1 RFC3447#section-4.1}.\n     *\n     * @access private\n     * @param Math_BigInteger $x\n     * @param Integer $xLen\n     * @return String\n     *\/",1241],["T_WHITESPACE","\n    ",1250],["T_FUNCTION","function",1251],["T_WHITESPACE"," ",1251],["T_STRING","_i2osp",1251],"(",["T_VARIABLE","$x",1251],",",["T_WHITESPACE"," ",1251],["T_VARIABLE","$xLen",1251],")",["T_WHITESPACE","\n    ",1251],"{",["T_WHITESPACE","\n        ",1252],["T_VARIABLE","$x",1253],["T_WHITESPACE"," ",1253],"=",["T_WHITESPACE"," ",1253],["T_VARIABLE","$x",1253],["T_OBJECT_OPERATOR","->",1253],["T_STRING","toBytes",1253],"(",")",";",["T_WHITESPACE","\n        ",1253],["T_IF","if",1254],["T_WHITESPACE"," ",1254],"(",["T_STRING","strlen",1254],"(",["T_VARIABLE","$x",1254],")",["T_WHITESPACE"," ",1254],">",["T_WHITESPACE"," ",1254],["T_VARIABLE","$xLen",1254],")",["T_WHITESPACE"," ",1254],"{",["T_WHITESPACE","\n            ",1254],["T_STRING","user_error",1255],"(",["T_CONSTANT_ENCAPSED_STRING","'Integer too large'",1255],",",["T_WHITESPACE"," ",1255],["T_STRING","E_USER_NOTICE",1255],")",";",["T_WHITESPACE","\n            ",1255],["T_RETURN","return",1256],["T_WHITESPACE"," ",1256],["T_STRING","false",1256],";",["T_WHITESPACE","\n        ",1256],"}",["T_WHITESPACE","\n        ",1257],["T_RETURN","return",1258],["T_WHITESPACE"," ",1258],["T_STRING","str_pad",1258],"(",["T_VARIABLE","$x",1258],",",["T_WHITESPACE"," ",1258],["T_VARIABLE","$xLen",1258],",",["T_WHITESPACE"," ",1258],["T_STRING","chr",1258],"(",["T_LNUMBER","0",1258],")",",",["T_WHITESPACE"," ",1258],["T_STRING","STR_PAD_LEFT",1258],")",";",["T_WHITESPACE","\n    ",1258],"}",["T_WHITESPACE","\n\n    ",1259],["T_DOC_COMMENT","\/**\n     * Octet-String-to-Integer primitive\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-4.2 RFC3447#section-4.2}.\n     *\n     * @access private\n     * @param String $x\n     * @return Math_BigInteger\n     *\/",1261],["T_WHITESPACE","\n    ",1269],["T_FUNCTION","function",1270],["T_WHITESPACE"," ",1270],["T_STRING","_os2ip",1270],"(",["T_VARIABLE","$x",1270],")",["T_WHITESPACE","\n    ",1270],"{",["T_WHITESPACE","\n        ",1271],["T_RETURN","return",1272],["T_WHITESPACE"," ",1272],["T_NEW","new",1272],["T_WHITESPACE"," ",1272],["T_STRING","Math_BigInteger",1272],"(",["T_VARIABLE","$x",1272],",",["T_WHITESPACE"," ",1272],["T_LNUMBER","256",1272],")",";",["T_WHITESPACE","\n    ",1272],"}",["T_WHITESPACE","\n\n    ",1273],["T_DOC_COMMENT","\/**\n     * Exponentiate with or without Chinese Remainder Theorem\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-5.1.1 RFC3447#section-5.1.2}.\n     *\n     * @access private\n     * @param Math_BigInteger $x\n     * @return Math_BigInteger\n     *\/",1275],["T_WHITESPACE","\n    ",1283],["T_FUNCTION","function",1284],["T_WHITESPACE"," ",1284],["T_STRING","_exponentiate",1284],"(",["T_VARIABLE","$x",1284],")",["T_WHITESPACE","\n    ",1284],"{",["T_WHITESPACE","\n        ",1285],["T_IF","if",1286],["T_WHITESPACE"," ",1286],"(",["T_EMPTY","empty",1286],"(",["T_VARIABLE","$this",1286],["T_OBJECT_OPERATOR","->",1286],["T_STRING","primes",1286],")",["T_WHITESPACE"," ",1286],["T_BOOLEAN_OR","||",1286],["T_WHITESPACE"," ",1286],["T_EMPTY","empty",1286],"(",["T_VARIABLE","$this",1286],["T_OBJECT_OPERATOR","->",1286],["T_STRING","coefficients",1286],")",["T_WHITESPACE"," ",1286],["T_BOOLEAN_OR","||",1286],["T_WHITESPACE"," ",1286],["T_EMPTY","empty",1286],"(",["T_VARIABLE","$this",1286],["T_OBJECT_OPERATOR","->",1286],["T_STRING","exponents",1286],")",")",["T_WHITESPACE"," ",1286],"{",["T_WHITESPACE","\n            ",1286],["T_RETURN","return",1287],["T_WHITESPACE"," ",1287],["T_VARIABLE","$x",1287],["T_OBJECT_OPERATOR","->",1287],["T_STRING","modPow",1287],"(",["T_VARIABLE","$this",1287],["T_OBJECT_OPERATOR","->",1287],["T_STRING","exponent",1287],",",["T_WHITESPACE"," ",1287],["T_VARIABLE","$this",1287],["T_OBJECT_OPERATOR","->",1287],["T_STRING","modulus",1287],")",";",["T_WHITESPACE","\n        ",1287],"}",["T_WHITESPACE","\n\n        ",1288],["T_VARIABLE","$num_primes",1290],["T_WHITESPACE"," ",1290],"=",["T_WHITESPACE"," ",1290],["T_STRING","count",1290],"(",["T_VARIABLE","$this",1290],["T_OBJECT_OPERATOR","->",1290],["T_STRING","primes",1290],")",";",["T_WHITESPACE","\n\n        ",1290],["T_IF","if",1292],["T_WHITESPACE"," ",1292],"(",["T_STRING","defined",1292],"(",["T_CONSTANT_ENCAPSED_STRING","'CRYPT_RSA_DISABLE_BLINDING'",1292],")",")",["T_WHITESPACE"," ",1292],"{",["T_WHITESPACE","\n            ",1292],["T_VARIABLE","$m_i",1293],["T_WHITESPACE"," ",1293],"=",["T_WHITESPACE"," ",1293],["T_ARRAY","array",1293],"(",["T_WHITESPACE","\n                ",1293],["T_LNUMBER","1",1294],["T_WHITESPACE"," ",1294],["T_DOUBLE_ARROW","=>",1294],["T_WHITESPACE"," ",1294],["T_VARIABLE","$x",1294],["T_OBJECT_OPERATOR","->",1294],["T_STRING","modPow",1294],"(",["T_VARIABLE","$this",1294],["T_OBJECT_OPERATOR","->",1294],["T_STRING","exponents",1294],"[",["T_LNUMBER","1",1294],"]",",",["T_WHITESPACE"," ",1294],["T_VARIABLE","$this",1294],["T_OBJECT_OPERATOR","->",1294],["T_STRING","primes",1294],"[",["T_LNUMBER","1",1294],"]",")",",",["T_WHITESPACE","\n                ",1294],["T_LNUMBER","2",1295],["T_WHITESPACE"," ",1295],["T_DOUBLE_ARROW","=>",1295],["T_WHITESPACE"," ",1295],["T_VARIABLE","$x",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","modPow",1295],"(",["T_VARIABLE","$this",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","exponents",1295],"[",["T_LNUMBER","2",1295],"]",",",["T_WHITESPACE"," ",1295],["T_VARIABLE","$this",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","primes",1295],"[",["T_LNUMBER","2",1295],"]",")",["T_WHITESPACE","\n            ",1295],")",";",["T_WHITESPACE","\n            ",1296],["T_VARIABLE","$h",1297],["T_WHITESPACE"," ",1297],"=",["T_WHITESPACE"," ",1297],["T_VARIABLE","$m_i",1297],"[",["T_LNUMBER","1",1297],"]",["T_OBJECT_OPERATOR","->",1297],["T_STRING","subtract",1297],"(",["T_VARIABLE","$m_i",1297],"[",["T_LNUMBER","2",1297],"]",")",";",["T_WHITESPACE","\n            ",1297],["T_VARIABLE","$h",1298],["T_WHITESPACE"," ",1298],"=",["T_WHITESPACE"," ",1298],["T_VARIABLE","$h",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","multiply",1298],"(",["T_VARIABLE","$this",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","coefficients",1298],"[",["T_LNUMBER","2",1298],"]",")",";",["T_WHITESPACE","\n            ",1298],["T_LIST","list",1299],"(",",",["T_WHITESPACE"," ",1299],["T_VARIABLE","$h",1299],")",["T_WHITESPACE"," ",1299],"=",["T_WHITESPACE"," ",1299],["T_VARIABLE","$h",1299],["T_OBJECT_OPERATOR","->",1299],["T_STRING","divide",1299],"(",["T_VARIABLE","$this",1299],["T_OBJECT_OPERATOR","->",1299],["T_STRING","primes",1299],"[",["T_LNUMBER","1",1299],"]",")",";",["T_WHITESPACE","\n            ",1299],["T_VARIABLE","$m",1300],["T_WHITESPACE"," ",1300],"=",["T_WHITESPACE"," ",1300],["T_VARIABLE","$m_i",1300],"[",["T_LNUMBER","2",1300],"]",["T_OBJECT_OPERATOR","->",1300],["T_STRING","add",1300],"(",["T_VARIABLE","$h",1300],["T_OBJECT_OPERATOR","->",1300],["T_STRING","multiply",1300],"(",["T_VARIABLE","$this",1300],["T_OBJECT_OPERATOR","->",1300],["T_STRING","primes",1300],"[",["T_LNUMBER","2",1300],"]",")",")",";",["T_WHITESPACE","\n\n            ",1300],["T_VARIABLE","$r",1302],["T_WHITESPACE"," ",1302],"=",["T_WHITESPACE"," ",1302],["T_VARIABLE","$this",1302],["T_OBJECT_OPERATOR","->",1302],["T_STRING","primes",1302],"[",["T_LNUMBER","1",1302],"]",";",["T_WHITESPACE","\n            ",1302],["T_FOR","for",1303],["T_WHITESPACE"," ",1303],"(",["T_VARIABLE","$i",1303],["T_WHITESPACE"," ",1303],"=",["T_WHITESPACE"," ",1303],["T_LNUMBER","3",1303],";",["T_WHITESPACE"," ",1303],["T_VARIABLE","$i",1303],["T_WHITESPACE"," ",1303],["T_IS_SMALLER_OR_EQUAL","<=",1303],["T_WHITESPACE"," ",1303],["T_VARIABLE","$num_primes",1303],";",["T_WHITESPACE"," ",1303],["T_VARIABLE","$i",1303],["T_INC","++",1303],")",["T_WHITESPACE"," ",1303],"{",["T_WHITESPACE","\n                ",1303],["T_VARIABLE","$m_i",1304],["T_WHITESPACE"," ",1304],"=",["T_WHITESPACE"," ",1304],["T_VARIABLE","$x",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","modPow",1304],"(",["T_VARIABLE","$this",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","exponents",1304],"[",["T_VARIABLE","$i",1304],"]",",",["T_WHITESPACE"," ",1304],["T_VARIABLE","$this",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","primes",1304],"[",["T_VARIABLE","$i",1304],"]",")",";",["T_WHITESPACE","\n\n                ",1304],["T_VARIABLE","$r",1306],["T_WHITESPACE"," ",1306],"=",["T_WHITESPACE"," ",1306],["T_VARIABLE","$r",1306],["T_OBJECT_OPERATOR","->",1306],["T_STRING","multiply",1306],"(",["T_VARIABLE","$this",1306],["T_OBJECT_OPERATOR","->",1306],["T_STRING","primes",1306],"[",["T_VARIABLE","$i",1306],["T_WHITESPACE"," ",1306],"-",["T_WHITESPACE"," ",1306],["T_LNUMBER","1",1306],"]",")",";",["T_WHITESPACE","\n\n                ",1306],["T_VARIABLE","$h",1308],["T_WHITESPACE"," ",1308],"=",["T_WHITESPACE"," ",1308],["T_VARIABLE","$m_i",1308],["T_OBJECT_OPERATOR","->",1308],["T_STRING","subtract",1308],"(",["T_VARIABLE","$m",1308],")",";",["T_WHITESPACE","\n                ",1308],["T_VARIABLE","$h",1309],["T_WHITESPACE"," ",1309],"=",["T_WHITESPACE"," ",1309],["T_VARIABLE","$h",1309],["T_OBJECT_OPERATOR","->",1309],["T_STRING","multiply",1309],"(",["T_VARIABLE","$this",1309],["T_OBJECT_OPERATOR","->",1309],["T_STRING","coefficients",1309],"[",["T_VARIABLE","$i",1309],"]",")",";",["T_WHITESPACE","\n                ",1309],["T_LIST","list",1310],"(",",",["T_WHITESPACE"," ",1310],["T_VARIABLE","$h",1310],")",["T_WHITESPACE"," ",1310],"=",["T_WHITESPACE"," ",1310],["T_VARIABLE","$h",1310],["T_OBJECT_OPERATOR","->",1310],["T_STRING","divide",1310],"(",["T_VARIABLE","$this",1310],["T_OBJECT_OPERATOR","->",1310],["T_STRING","primes",1310],"[",["T_VARIABLE","$i",1310],"]",")",";",["T_WHITESPACE","\n\n                ",1310],["T_VARIABLE","$m",1312],["T_WHITESPACE"," ",1312],"=",["T_WHITESPACE"," ",1312],["T_VARIABLE","$m",1312],["T_OBJECT_OPERATOR","->",1312],["T_STRING","add",1312],"(",["T_VARIABLE","$r",1312],["T_OBJECT_OPERATOR","->",1312],["T_STRING","multiply",1312],"(",["T_VARIABLE","$h",1312],")",")",";",["T_WHITESPACE","\n            ",1312],"}",["T_WHITESPACE","\n        ",1313],"}",["T_WHITESPACE"," ",1314],["T_ELSE","else",1314],["T_WHITESPACE"," ",1314],"{",["T_WHITESPACE","\n            ",1314],["T_VARIABLE","$smallest",1315],["T_WHITESPACE"," ",1315],"=",["T_WHITESPACE"," ",1315],["T_VARIABLE","$this",1315],["T_OBJECT_OPERATOR","->",1315],["T_STRING","primes",1315],"[",["T_LNUMBER","1",1315],"]",";",["T_WHITESPACE","\n            ",1315],["T_FOR","for",1316],["T_WHITESPACE"," ",1316],"(",["T_VARIABLE","$i",1316],["T_WHITESPACE"," ",1316],"=",["T_WHITESPACE"," ",1316],["T_LNUMBER","2",1316],";",["T_WHITESPACE"," ",1316],["T_VARIABLE","$i",1316],["T_WHITESPACE"," ",1316],["T_IS_SMALLER_OR_EQUAL","<=",1316],["T_WHITESPACE"," ",1316],["T_VARIABLE","$num_primes",1316],";",["T_WHITESPACE"," ",1316],["T_VARIABLE","$i",1316],["T_INC","++",1316],")",["T_WHITESPACE"," ",1316],"{",["T_WHITESPACE","\n                ",1316],["T_IF","if",1317],["T_WHITESPACE"," ",1317],"(",["T_VARIABLE","$smallest",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","compare",1317],"(",["T_VARIABLE","$this",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","primes",1317],"[",["T_VARIABLE","$i",1317],"]",")",["T_WHITESPACE"," ",1317],">",["T_WHITESPACE"," ",1317],["T_LNUMBER","0",1317],")",["T_WHITESPACE"," ",1317],"{",["T_WHITESPACE","\n                    ",1317],["T_VARIABLE","$smallest",1318],["T_WHITESPACE"," ",1318],"=",["T_WHITESPACE"," ",1318],["T_VARIABLE","$this",1318],["T_OBJECT_OPERATOR","->",1318],["T_STRING","primes",1318],"[",["T_VARIABLE","$i",1318],"]",";",["T_WHITESPACE","\n                ",1318],"}",["T_WHITESPACE","\n            ",1319],"}",["T_WHITESPACE","\n\n            ",1320],["T_VARIABLE","$one",1322],["T_WHITESPACE"," ",1322],"=",["T_WHITESPACE"," ",1322],["T_NEW","new",1322],["T_WHITESPACE"," ",1322],["T_STRING","Math_BigInteger",1322],"(",["T_LNUMBER","1",1322],")",";",["T_WHITESPACE","\n            ",1322],["T_VARIABLE","$one",1323],["T_OBJECT_OPERATOR","->",1323],["T_STRING","setRandomGenerator",1323],"(",["T_CONSTANT_ENCAPSED_STRING","'crypt_random'",1323],")",";",["T_WHITESPACE","\n\n            ",1323],["T_VARIABLE","$r",1325],["T_WHITESPACE"," ",1325],"=",["T_WHITESPACE"," ",1325],["T_VARIABLE","$one",1325],["T_OBJECT_OPERATOR","->",1325],["T_STRING","random",1325],"(",["T_VARIABLE","$one",1325],",",["T_WHITESPACE"," ",1325],["T_VARIABLE","$smallest",1325],["T_OBJECT_OPERATOR","->",1325],["T_STRING","subtract",1325],"(",["T_VARIABLE","$one",1325],")",")",";",["T_WHITESPACE","\n\n            ",1325],["T_VARIABLE","$m_i",1327],["T_WHITESPACE"," ",1327],"=",["T_WHITESPACE"," ",1327],["T_ARRAY","array",1327],"(",["T_WHITESPACE","\n                ",1327],["T_LNUMBER","1",1328],["T_WHITESPACE"," ",1328],["T_DOUBLE_ARROW","=>",1328],["T_WHITESPACE"," ",1328],["T_VARIABLE","$this",1328],["T_OBJECT_OPERATOR","->",1328],["T_STRING","_blind",1328],"(",["T_VARIABLE","$x",1328],",",["T_WHITESPACE"," ",1328],["T_VARIABLE","$r",1328],",",["T_WHITESPACE"," ",1328],["T_LNUMBER","1",1328],")",",",["T_WHITESPACE","\n                ",1328],["T_LNUMBER","2",1329],["T_WHITESPACE"," ",1329],["T_DOUBLE_ARROW","=>",1329],["T_WHITESPACE"," ",1329],["T_VARIABLE","$this",1329],["T_OBJECT_OPERATOR","->",1329],["T_STRING","_blind",1329],"(",["T_VARIABLE","$x",1329],",",["T_WHITESPACE"," ",1329],["T_VARIABLE","$r",1329],",",["T_WHITESPACE"," ",1329],["T_LNUMBER","2",1329],")",["T_WHITESPACE","\n            ",1329],")",";",["T_WHITESPACE","\n            ",1330],["T_VARIABLE","$h",1331],["T_WHITESPACE"," ",1331],"=",["T_WHITESPACE"," ",1331],["T_VARIABLE","$m_i",1331],"[",["T_LNUMBER","1",1331],"]",["T_OBJECT_OPERATOR","->",1331],["T_STRING","subtract",1331],"(",["T_VARIABLE","$m_i",1331],"[",["T_LNUMBER","2",1331],"]",")",";",["T_WHITESPACE","\n            ",1331],["T_VARIABLE","$h",1332],["T_WHITESPACE"," ",1332],"=",["T_WHITESPACE"," ",1332],["T_VARIABLE","$h",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","multiply",1332],"(",["T_VARIABLE","$this",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","coefficients",1332],"[",["T_LNUMBER","2",1332],"]",")",";",["T_WHITESPACE","\n            ",1332],["T_LIST","list",1333],"(",",",["T_WHITESPACE"," ",1333],["T_VARIABLE","$h",1333],")",["T_WHITESPACE"," ",1333],"=",["T_WHITESPACE"," ",1333],["T_VARIABLE","$h",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","divide",1333],"(",["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","primes",1333],"[",["T_LNUMBER","1",1333],"]",")",";",["T_WHITESPACE","\n            ",1333],["T_VARIABLE","$m",1334],["T_WHITESPACE"," ",1334],"=",["T_WHITESPACE"," ",1334],["T_VARIABLE","$m_i",1334],"[",["T_LNUMBER","2",1334],"]",["T_OBJECT_OPERATOR","->",1334],["T_STRING","add",1334],"(",["T_VARIABLE","$h",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","multiply",1334],"(",["T_VARIABLE","$this",1334],["T_OBJECT_OPERATOR","->",1334],["T_STRING","primes",1334],"[",["T_LNUMBER","2",1334],"]",")",")",";",["T_WHITESPACE","\n\n            ",1334],["T_VARIABLE","$r",1336],["T_WHITESPACE"," ",1336],"=",["T_WHITESPACE"," ",1336],["T_VARIABLE","$this",1336],["T_OBJECT_OPERATOR","->",1336],["T_STRING","primes",1336],"[",["T_LNUMBER","1",1336],"]",";",["T_WHITESPACE","\n            ",1336],["T_FOR","for",1337],["T_WHITESPACE"," ",1337],"(",["T_VARIABLE","$i",1337],["T_WHITESPACE"," ",1337],"=",["T_WHITESPACE"," ",1337],["T_LNUMBER","3",1337],";",["T_WHITESPACE"," ",1337],["T_VARIABLE","$i",1337],["T_WHITESPACE"," ",1337],["T_IS_SMALLER_OR_EQUAL","<=",1337],["T_WHITESPACE"," ",1337],["T_VARIABLE","$num_primes",1337],";",["T_WHITESPACE"," ",1337],["T_VARIABLE","$i",1337],["T_INC","++",1337],")",["T_WHITESPACE"," ",1337],"{",["T_WHITESPACE","\n                ",1337],["T_VARIABLE","$m_i",1338],["T_WHITESPACE"," ",1338],"=",["T_WHITESPACE"," ",1338],["T_VARIABLE","$this",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","_blind",1338],"(",["T_VARIABLE","$x",1338],",",["T_WHITESPACE"," ",1338],["T_VARIABLE","$r",1338],",",["T_WHITESPACE"," ",1338],["T_VARIABLE","$i",1338],")",";",["T_WHITESPACE","\n\n                ",1338],["T_VARIABLE","$r",1340],["T_WHITESPACE"," ",1340],"=",["T_WHITESPACE"," ",1340],["T_VARIABLE","$r",1340],["T_OBJECT_OPERATOR","->",1340],["T_STRING","multiply",1340],"(",["T_VARIABLE","$this",1340],["T_OBJECT_OPERATOR","->",1340],["T_STRING","primes",1340],"[",["T_VARIABLE","$i",1340],["T_WHITESPACE"," ",1340],"-",["T_WHITESPACE"," ",1340],["T_LNUMBER","1",1340],"]",")",";",["T_WHITESPACE","\n\n                ",1340],["T_VARIABLE","$h",1342],["T_WHITESPACE"," ",1342],"=",["T_WHITESPACE"," ",1342],["T_VARIABLE","$m_i",1342],["T_OBJECT_OPERATOR","->",1342],["T_STRING","subtract",1342],"(",["T_VARIABLE","$m",1342],")",";",["T_WHITESPACE","\n                ",1342],["T_VARIABLE","$h",1343],["T_WHITESPACE"," ",1343],"=",["T_WHITESPACE"," ",1343],["T_VARIABLE","$h",1343],["T_OBJECT_OPERATOR","->",1343],["T_STRING","multiply",1343],"(",["T_VARIABLE","$this",1343],["T_OBJECT_OPERATOR","->",1343],["T_STRING","coefficients",1343],"[",["T_VARIABLE","$i",1343],"]",")",";",["T_WHITESPACE","\n                ",1343],["T_LIST","list",1344],"(",",",["T_WHITESPACE"," ",1344],["T_VARIABLE","$h",1344],")",["T_WHITESPACE"," ",1344],"=",["T_WHITESPACE"," ",1344],["T_VARIABLE","$h",1344],["T_OBJECT_OPERATOR","->",1344],["T_STRING","divide",1344],"(",["T_VARIABLE","$this",1344],["T_OBJECT_OPERATOR","->",1344],["T_STRING","primes",1344],"[",["T_VARIABLE","$i",1344],"]",")",";",["T_WHITESPACE","\n\n                ",1344],["T_VARIABLE","$m",1346],["T_WHITESPACE"," ",1346],"=",["T_WHITESPACE"," ",1346],["T_VARIABLE","$m",1346],["T_OBJECT_OPERATOR","->",1346],["T_STRING","add",1346],"(",["T_VARIABLE","$r",1346],["T_OBJECT_OPERATOR","->",1346],["T_STRING","multiply",1346],"(",["T_VARIABLE","$h",1346],")",")",";",["T_WHITESPACE","\n            ",1346],"}",["T_WHITESPACE","\n        ",1347],"}",["T_WHITESPACE","\n\n        ",1348],["T_RETURN","return",1350],["T_WHITESPACE"," ",1350],["T_VARIABLE","$m",1350],";",["T_WHITESPACE","\n    ",1350],"}",["T_WHITESPACE","\n\n    ",1351],["T_DOC_COMMENT","\/**\n     * Performs RSA Blinding\n     *\n     * Protects against timing attacks by employing RSA Blinding.\n     * Returns $x->modPow($this->exponents[$i], $this->primes[$i])\n     *\n     * @access private\n     * @param Math_BigInteger $x\n     * @param Math_BigInteger $r\n     * @param Integer $i\n     * @return Math_BigInteger\n     *\/",1353],["T_WHITESPACE","\n    ",1364],["T_FUNCTION","function",1365],["T_WHITESPACE"," ",1365],["T_STRING","_blind",1365],"(",["T_VARIABLE","$x",1365],",",["T_WHITESPACE"," ",1365],["T_VARIABLE","$r",1365],",",["T_WHITESPACE"," ",1365],["T_VARIABLE","$i",1365],")",["T_WHITESPACE","\n    ",1365],"{",["T_WHITESPACE","\n        ",1366],["T_VARIABLE","$x",1367],["T_WHITESPACE"," ",1367],"=",["T_WHITESPACE"," ",1367],["T_VARIABLE","$x",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","multiply",1367],"(",["T_VARIABLE","$r",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","modPow",1367],"(",["T_VARIABLE","$this",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","publicExponent",1367],",",["T_WHITESPACE"," ",1367],["T_VARIABLE","$this",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","primes",1367],"[",["T_VARIABLE","$i",1367],"]",")",")",";",["T_WHITESPACE","\n\n        ",1367],["T_VARIABLE","$x",1369],["T_WHITESPACE"," ",1369],"=",["T_WHITESPACE"," ",1369],["T_VARIABLE","$x",1369],["T_OBJECT_OPERATOR","->",1369],["T_STRING","modPow",1369],"(",["T_VARIABLE","$this",1369],["T_OBJECT_OPERATOR","->",1369],["T_STRING","exponents",1369],"[",["T_VARIABLE","$i",1369],"]",",",["T_WHITESPACE"," ",1369],["T_VARIABLE","$this",1369],["T_OBJECT_OPERATOR","->",1369],["T_STRING","primes",1369],"[",["T_VARIABLE","$i",1369],"]",")",";",["T_WHITESPACE","\n\n        ",1369],["T_VARIABLE","$r",1371],["T_WHITESPACE"," ",1371],"=",["T_WHITESPACE"," ",1371],["T_VARIABLE","$r",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","modInverse",1371],"(",["T_VARIABLE","$this",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","primes",1371],"[",["T_VARIABLE","$i",1371],"]",")",";",["T_WHITESPACE","\n        ",1371],["T_VARIABLE","$x",1372],["T_WHITESPACE"," ",1372],"=",["T_WHITESPACE"," ",1372],["T_VARIABLE","$x",1372],["T_OBJECT_OPERATOR","->",1372],["T_STRING","multiply",1372],"(",["T_VARIABLE","$r",1372],")",";",["T_WHITESPACE","\n        ",1372],["T_LIST","list",1373],"(",",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$x",1373],")",["T_WHITESPACE"," ",1373],"=",["T_WHITESPACE"," ",1373],["T_VARIABLE","$x",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","divide",1373],"(",["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","primes",1373],"[",["T_VARIABLE","$i",1373],"]",")",";",["T_WHITESPACE","\n\n        ",1373],["T_RETURN","return",1375],["T_WHITESPACE"," ",1375],["T_VARIABLE","$x",1375],";",["T_WHITESPACE","\n    ",1375],"}",["T_WHITESPACE","\n\n    ",1376],["T_DOC_COMMENT","\/**\n     * RSAEP\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-5.1.1 RFC3447#section-5.1.1}.\n     *\n     * @access private\n     * @param Math_BigInteger $m\n     * @return Math_BigInteger\n     *\/",1378],["T_WHITESPACE","\n    ",1386],["T_FUNCTION","function",1387],["T_WHITESPACE"," ",1387],["T_STRING","_rsaep",1387],"(",["T_VARIABLE","$m",1387],")",["T_WHITESPACE","\n    ",1387],"{",["T_WHITESPACE","\n        ",1388],["T_IF","if",1389],["T_WHITESPACE"," ",1389],"(",["T_VARIABLE","$m",1389],["T_OBJECT_OPERATOR","->",1389],["T_STRING","compare",1389],"(",["T_VARIABLE","$this",1389],["T_OBJECT_OPERATOR","->",1389],["T_STRING","zero",1389],")",["T_WHITESPACE"," ",1389],"<",["T_WHITESPACE"," ",1389],["T_LNUMBER","0",1389],["T_WHITESPACE"," ",1389],["T_BOOLEAN_OR","||",1389],["T_WHITESPACE"," ",1389],["T_VARIABLE","$m",1389],["T_OBJECT_OPERATOR","->",1389],["T_STRING","compare",1389],"(",["T_VARIABLE","$this",1389],["T_OBJECT_OPERATOR","->",1389],["T_STRING","modulus",1389],")",["T_WHITESPACE"," ",1389],">",["T_WHITESPACE"," ",1389],["T_LNUMBER","0",1389],")",["T_WHITESPACE"," ",1389],"{",["T_WHITESPACE","\n            ",1389],["T_STRING","user_error",1390],"(",["T_CONSTANT_ENCAPSED_STRING","'Message representative out of range'",1390],",",["T_WHITESPACE"," ",1390],["T_STRING","E_USER_NOTICE",1390],")",";",["T_WHITESPACE","\n            ",1390],["T_RETURN","return",1391],["T_WHITESPACE"," ",1391],["T_STRING","false",1391],";",["T_WHITESPACE","\n        ",1391],"}",["T_WHITESPACE","\n        ",1392],["T_RETURN","return",1393],["T_WHITESPACE"," ",1393],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","_exponentiate",1393],"(",["T_VARIABLE","$m",1393],")",";",["T_WHITESPACE","\n    ",1393],"}",["T_WHITESPACE","\n\n    ",1394],["T_DOC_COMMENT","\/**\n     * RSADP\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-5.1.2 RFC3447#section-5.1.2}.\n     *\n     * @access private\n     * @param Math_BigInteger $c\n     * @return Math_BigInteger\n     *\/",1396],["T_WHITESPACE","\n    ",1404],["T_FUNCTION","function",1405],["T_WHITESPACE"," ",1405],["T_STRING","_rsadp",1405],"(",["T_VARIABLE","$c",1405],")",["T_WHITESPACE","\n    ",1405],"{",["T_WHITESPACE","\n        ",1406],["T_IF","if",1407],["T_WHITESPACE"," ",1407],"(",["T_VARIABLE","$c",1407],["T_OBJECT_OPERATOR","->",1407],["T_STRING","compare",1407],"(",["T_VARIABLE","$this",1407],["T_OBJECT_OPERATOR","->",1407],["T_STRING","zero",1407],")",["T_WHITESPACE"," ",1407],"<",["T_WHITESPACE"," ",1407],["T_LNUMBER","0",1407],["T_WHITESPACE"," ",1407],["T_BOOLEAN_OR","||",1407],["T_WHITESPACE"," ",1407],["T_VARIABLE","$c",1407],["T_OBJECT_OPERATOR","->",1407],["T_STRING","compare",1407],"(",["T_VARIABLE","$this",1407],["T_OBJECT_OPERATOR","->",1407],["T_STRING","modulus",1407],")",["T_WHITESPACE"," ",1407],">",["T_WHITESPACE"," ",1407],["T_LNUMBER","0",1407],")",["T_WHITESPACE"," ",1407],"{",["T_WHITESPACE","\n            ",1407],["T_STRING","user_error",1408],"(",["T_CONSTANT_ENCAPSED_STRING","'Ciphertext representative out of range'",1408],",",["T_WHITESPACE"," ",1408],["T_STRING","E_USER_NOTICE",1408],")",";",["T_WHITESPACE","\n            ",1408],["T_RETURN","return",1409],["T_WHITESPACE"," ",1409],["T_STRING","false",1409],";",["T_WHITESPACE","\n        ",1409],"}",["T_WHITESPACE","\n        ",1410],["T_RETURN","return",1411],["T_WHITESPACE"," ",1411],["T_VARIABLE","$this",1411],["T_OBJECT_OPERATOR","->",1411],["T_STRING","_exponentiate",1411],"(",["T_VARIABLE","$c",1411],")",";",["T_WHITESPACE","\n    ",1411],"}",["T_WHITESPACE","\n\n    ",1412],["T_DOC_COMMENT","\/**\n     * RSASP1\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-5.2.1 RFC3447#section-5.2.1}.\n     *\n     * @access private\n     * @param Math_BigInteger $m\n     * @return Math_BigInteger\n     *\/",1414],["T_WHITESPACE","\n    ",1422],["T_FUNCTION","function",1423],["T_WHITESPACE"," ",1423],["T_STRING","_rsasp1",1423],"(",["T_VARIABLE","$m",1423],")",["T_WHITESPACE","\n    ",1423],"{",["T_WHITESPACE","\n        ",1424],["T_IF","if",1425],["T_WHITESPACE"," ",1425],"(",["T_VARIABLE","$m",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","compare",1425],"(",["T_VARIABLE","$this",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","zero",1425],")",["T_WHITESPACE"," ",1425],"<",["T_WHITESPACE"," ",1425],["T_LNUMBER","0",1425],["T_WHITESPACE"," ",1425],["T_BOOLEAN_OR","||",1425],["T_WHITESPACE"," ",1425],["T_VARIABLE","$m",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","compare",1425],"(",["T_VARIABLE","$this",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","modulus",1425],")",["T_WHITESPACE"," ",1425],">",["T_WHITESPACE"," ",1425],["T_LNUMBER","0",1425],")",["T_WHITESPACE"," ",1425],"{",["T_WHITESPACE","\n            ",1425],["T_STRING","user_error",1426],"(",["T_CONSTANT_ENCAPSED_STRING","'Message representative out of range'",1426],",",["T_WHITESPACE"," ",1426],["T_STRING","E_USER_NOTICE",1426],")",";",["T_WHITESPACE","\n            ",1426],["T_RETURN","return",1427],["T_WHITESPACE"," ",1427],["T_STRING","false",1427],";",["T_WHITESPACE","\n        ",1427],"}",["T_WHITESPACE","\n        ",1428],["T_RETURN","return",1429],["T_WHITESPACE"," ",1429],["T_VARIABLE","$this",1429],["T_OBJECT_OPERATOR","->",1429],["T_STRING","_exponentiate",1429],"(",["T_VARIABLE","$m",1429],")",";",["T_WHITESPACE","\n    ",1429],"}",["T_WHITESPACE","\n\n    ",1430],["T_DOC_COMMENT","\/**\n     * RSAVP1\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-5.2.2 RFC3447#section-5.2.2}.\n     *\n     * @access private\n     * @param Math_BigInteger $s\n     * @return Math_BigInteger\n     *\/",1432],["T_WHITESPACE","\n    ",1440],["T_FUNCTION","function",1441],["T_WHITESPACE"," ",1441],["T_STRING","_rsavp1",1441],"(",["T_VARIABLE","$s",1441],")",["T_WHITESPACE","\n    ",1441],"{",["T_WHITESPACE","\n        ",1442],["T_IF","if",1443],["T_WHITESPACE"," ",1443],"(",["T_VARIABLE","$s",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","compare",1443],"(",["T_VARIABLE","$this",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","zero",1443],")",["T_WHITESPACE"," ",1443],"<",["T_WHITESPACE"," ",1443],["T_LNUMBER","0",1443],["T_WHITESPACE"," ",1443],["T_BOOLEAN_OR","||",1443],["T_WHITESPACE"," ",1443],["T_VARIABLE","$s",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","compare",1443],"(",["T_VARIABLE","$this",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","modulus",1443],")",["T_WHITESPACE"," ",1443],">",["T_WHITESPACE"," ",1443],["T_LNUMBER","0",1443],")",["T_WHITESPACE"," ",1443],"{",["T_WHITESPACE","\n            ",1443],["T_STRING","user_error",1444],"(",["T_CONSTANT_ENCAPSED_STRING","'Signature representative out of range'",1444],",",["T_WHITESPACE"," ",1444],["T_STRING","E_USER_NOTICE",1444],")",";",["T_WHITESPACE","\n            ",1444],["T_RETURN","return",1445],["T_WHITESPACE"," ",1445],["T_STRING","false",1445],";",["T_WHITESPACE","\n        ",1445],"}",["T_WHITESPACE","\n        ",1446],["T_RETURN","return",1447],["T_WHITESPACE"," ",1447],["T_VARIABLE","$this",1447],["T_OBJECT_OPERATOR","->",1447],["T_STRING","_exponentiate",1447],"(",["T_VARIABLE","$s",1447],")",";",["T_WHITESPACE","\n    ",1447],"}",["T_WHITESPACE","\n\n    ",1448],["T_DOC_COMMENT","\/**\n     * MGF1\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#appendix-B.2.1 RFC3447#appendix-B.2.1}.\n     *\n     * @access private\n     * @param String $mgfSeed\n     * @param Integer $mgfLen\n     * @return String\n     *\/",1450],["T_WHITESPACE","\n    ",1459],["T_FUNCTION","function",1460],["T_WHITESPACE"," ",1460],["T_STRING","_mgf1",1460],"(",["T_VARIABLE","$mgfSeed",1460],",",["T_WHITESPACE"," ",1460],["T_VARIABLE","$maskLen",1460],")",["T_WHITESPACE","\n    ",1460],"{",["T_WHITESPACE","\n        ",1461],["T_COMMENT","\/\/ if $maskLen would yield strings larger than 4GB, PKCS#1 suggests a \"Mask too long\" error be output.\n",1462],["T_WHITESPACE","\n        ",1463],["T_VARIABLE","$t",1464],["T_WHITESPACE"," ",1464],"=",["T_WHITESPACE"," ",1464],["T_CONSTANT_ENCAPSED_STRING","''",1464],";",["T_WHITESPACE","\n        ",1464],["T_VARIABLE","$count",1465],["T_WHITESPACE"," ",1465],"=",["T_WHITESPACE"," ",1465],["T_STRING","ceil",1465],"(",["T_VARIABLE","$maskLen",1465],["T_WHITESPACE"," ",1465],"\/",["T_WHITESPACE"," ",1465],["T_VARIABLE","$this",1465],["T_OBJECT_OPERATOR","->",1465],["T_STRING","mgfHLen",1465],")",";",["T_WHITESPACE","\n        ",1465],["T_FOR","for",1466],["T_WHITESPACE"," ",1466],"(",["T_VARIABLE","$i",1466],["T_WHITESPACE"," ",1466],"=",["T_WHITESPACE"," ",1466],["T_LNUMBER","0",1466],";",["T_WHITESPACE"," ",1466],["T_VARIABLE","$i",1466],["T_WHITESPACE"," ",1466],"<",["T_WHITESPACE"," ",1466],["T_VARIABLE","$count",1466],";",["T_WHITESPACE"," ",1466],["T_VARIABLE","$i",1466],["T_INC","++",1466],")",["T_WHITESPACE"," ",1466],"{",["T_WHITESPACE","\n            ",1466],["T_VARIABLE","$c",1467],["T_WHITESPACE"," ",1467],"=",["T_WHITESPACE"," ",1467],["T_STRING","pack",1467],"(",["T_CONSTANT_ENCAPSED_STRING","'N'",1467],",",["T_WHITESPACE"," ",1467],["T_VARIABLE","$i",1467],")",";",["T_WHITESPACE","\n            ",1467],["T_VARIABLE","$t",1468],["T_CONCAT_EQUAL",".=",1468],["T_WHITESPACE"," ",1468],["T_VARIABLE","$this",1468],["T_OBJECT_OPERATOR","->",1468],["T_STRING","mgfHash",1468],["T_OBJECT_OPERATOR","->",1468],["T_STRING","hash",1468],"(",["T_VARIABLE","$mgfSeed",1468],["T_WHITESPACE"," ",1468],".",["T_WHITESPACE"," ",1468],["T_VARIABLE","$c",1468],")",";",["T_WHITESPACE","\n        ",1468],"}",["T_WHITESPACE","\n\n        ",1469],["T_RETURN","return",1471],["T_WHITESPACE"," ",1471],["T_STRING","substr",1471],"(",["T_VARIABLE","$t",1471],",",["T_WHITESPACE"," ",1471],["T_LNUMBER","0",1471],",",["T_WHITESPACE"," ",1471],["T_VARIABLE","$maskLen",1471],")",";",["T_WHITESPACE","\n    ",1471],"}",["T_WHITESPACE","\n\n    ",1472],["T_DOC_COMMENT","\/**\n     * RSAES-OAEP-ENCRYPT\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-7.1.1 RFC3447#section-7.1.1} and\n     * {http:\/\/en.wikipedia.org\/wiki\/Optimal_Asymmetric_Encryption_Padding OAES}.\n     *\n     * @access private\n     * @param String $m\n     * @param String $l\n     * @return String\n     *\/",1474],["T_WHITESPACE","\n    ",1484],["T_FUNCTION","function",1485],["T_WHITESPACE"," ",1485],["T_STRING","_rsaes_oaep_encrypt",1485],"(",["T_VARIABLE","$m",1485],",",["T_WHITESPACE"," ",1485],["T_VARIABLE","$l",1485],["T_WHITESPACE"," ",1485],"=",["T_WHITESPACE"," ",1485],["T_CONSTANT_ENCAPSED_STRING","''",1485],")",["T_WHITESPACE","\n    ",1485],"{",["T_WHITESPACE","\n        ",1486],["T_VARIABLE","$mLen",1487],["T_WHITESPACE"," ",1487],"=",["T_WHITESPACE"," ",1487],["T_STRING","strlen",1487],"(",["T_VARIABLE","$m",1487],")",";",["T_WHITESPACE","\n\n        ",1487],["T_COMMENT","\/\/ Length checking\n",1489],["T_WHITESPACE","\n        ",1490],["T_COMMENT","\/\/ if $l is larger than two million terrabytes and you're using sha1, PKCS#1 suggests a \"Label too long\" error\n",1491],["T_WHITESPACE","        ",1492],["T_COMMENT","\/\/ be output.\n",1492],["T_WHITESPACE","\n        ",1493],["T_IF","if",1494],["T_WHITESPACE"," ",1494],"(",["T_VARIABLE","$mLen",1494],["T_WHITESPACE"," ",1494],">",["T_WHITESPACE"," ",1494],["T_VARIABLE","$this",1494],["T_OBJECT_OPERATOR","->",1494],["T_STRING","k",1494],["T_WHITESPACE"," ",1494],"-",["T_WHITESPACE"," ",1494],["T_LNUMBER","2",1494],["T_WHITESPACE"," ",1494],"*",["T_WHITESPACE"," ",1494],["T_VARIABLE","$this",1494],["T_OBJECT_OPERATOR","->",1494],["T_STRING","hLen",1494],["T_WHITESPACE"," ",1494],"-",["T_WHITESPACE"," ",1494],["T_LNUMBER","2",1494],")",["T_WHITESPACE"," ",1494],"{",["T_WHITESPACE","\n            ",1494],["T_STRING","user_error",1495],"(",["T_CONSTANT_ENCAPSED_STRING","'Message too long'",1495],",",["T_WHITESPACE"," ",1495],["T_STRING","E_USER_NOTICE",1495],")",";",["T_WHITESPACE","\n            ",1495],["T_RETURN","return",1496],["T_WHITESPACE"," ",1496],["T_STRING","false",1496],";",["T_WHITESPACE","\n        ",1496],"}",["T_WHITESPACE","\n\n        ",1497],["T_COMMENT","\/\/ EME-OAEP encoding\n",1499],["T_WHITESPACE","\n        ",1500],["T_VARIABLE","$lHash",1501],["T_WHITESPACE"," ",1501],"=",["T_WHITESPACE"," ",1501],["T_VARIABLE","$this",1501],["T_OBJECT_OPERATOR","->",1501],["T_STRING","hash",1501],["T_OBJECT_OPERATOR","->",1501],["T_STRING","hash",1501],"(",["T_VARIABLE","$l",1501],")",";",["T_WHITESPACE","\n        ",1501],["T_VARIABLE","$ps",1502],["T_WHITESPACE"," ",1502],"=",["T_WHITESPACE"," ",1502],["T_STRING","str_repeat",1502],"(",["T_STRING","chr",1502],"(",["T_LNUMBER","0",1502],")",",",["T_WHITESPACE"," ",1502],["T_VARIABLE","$this",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","k",1502],["T_WHITESPACE"," ",1502],"-",["T_WHITESPACE"," ",1502],["T_VARIABLE","$mLen",1502],["T_WHITESPACE"," ",1502],"-",["T_WHITESPACE"," ",1502],["T_LNUMBER","2",1502],["T_WHITESPACE"," ",1502],"*",["T_WHITESPACE"," ",1502],["T_VARIABLE","$this",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","hLen",1502],["T_WHITESPACE"," ",1502],"-",["T_WHITESPACE"," ",1502],["T_LNUMBER","2",1502],")",";",["T_WHITESPACE","\n        ",1502],["T_VARIABLE","$db",1503],["T_WHITESPACE"," ",1503],"=",["T_WHITESPACE"," ",1503],["T_VARIABLE","$lHash",1503],["T_WHITESPACE"," ",1503],".",["T_WHITESPACE"," ",1503],["T_VARIABLE","$ps",1503],["T_WHITESPACE"," ",1503],".",["T_WHITESPACE"," ",1503],["T_STRING","chr",1503],"(",["T_LNUMBER","1",1503],")",["T_WHITESPACE"," ",1503],".",["T_WHITESPACE"," ",1503],["T_VARIABLE","$m",1503],";",["T_WHITESPACE","\n        ",1503],["T_VARIABLE","$seed",1504],["T_WHITESPACE"," ",1504],"=",["T_WHITESPACE"," ",1504],["T_VARIABLE","$this",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","_random",1504],"(",["T_VARIABLE","$this",1504],["T_OBJECT_OPERATOR","->",1504],["T_STRING","hLen",1504],")",";",["T_WHITESPACE","\n        ",1504],["T_VARIABLE","$dbMask",1505],["T_WHITESPACE"," ",1505],"=",["T_WHITESPACE"," ",1505],["T_VARIABLE","$this",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","_mgf1",1505],"(",["T_VARIABLE","$seed",1505],",",["T_WHITESPACE"," ",1505],["T_VARIABLE","$this",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","k",1505],["T_WHITESPACE"," ",1505],"-",["T_WHITESPACE"," ",1505],["T_VARIABLE","$this",1505],["T_OBJECT_OPERATOR","->",1505],["T_STRING","hLen",1505],["T_WHITESPACE"," ",1505],"-",["T_WHITESPACE"," ",1505],["T_LNUMBER","1",1505],")",";",["T_WHITESPACE","\n        ",1505],["T_VARIABLE","$maskedDB",1506],["T_WHITESPACE"," ",1506],"=",["T_WHITESPACE"," ",1506],["T_VARIABLE","$db",1506],["T_WHITESPACE"," ",1506],"^",["T_WHITESPACE"," ",1506],["T_VARIABLE","$dbMask",1506],";",["T_WHITESPACE","\n        ",1506],["T_VARIABLE","$seedMask",1507],["T_WHITESPACE"," ",1507],"=",["T_WHITESPACE"," ",1507],["T_VARIABLE","$this",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","_mgf1",1507],"(",["T_VARIABLE","$maskedDB",1507],",",["T_WHITESPACE"," ",1507],["T_VARIABLE","$this",1507],["T_OBJECT_OPERATOR","->",1507],["T_STRING","hLen",1507],")",";",["T_WHITESPACE","\n        ",1507],["T_VARIABLE","$maskedSeed",1508],["T_WHITESPACE"," ",1508],"=",["T_WHITESPACE"," ",1508],["T_VARIABLE","$seed",1508],["T_WHITESPACE"," ",1508],"^",["T_WHITESPACE"," ",1508],["T_VARIABLE","$seedMask",1508],";",["T_WHITESPACE","\n        ",1508],["T_VARIABLE","$em",1509],["T_WHITESPACE"," ",1509],"=",["T_WHITESPACE"," ",1509],["T_STRING","chr",1509],"(",["T_LNUMBER","0",1509],")",["T_WHITESPACE"," ",1509],".",["T_WHITESPACE"," ",1509],["T_VARIABLE","$maskedSeed",1509],["T_WHITESPACE"," ",1509],".",["T_WHITESPACE"," ",1509],["T_VARIABLE","$maskedDB",1509],";",["T_WHITESPACE","\n\n        ",1509],["T_COMMENT","\/\/ RSA encryption\n",1511],["T_WHITESPACE","\n        ",1512],["T_VARIABLE","$m",1513],["T_WHITESPACE"," ",1513],"=",["T_WHITESPACE"," ",1513],["T_VARIABLE","$this",1513],["T_OBJECT_OPERATOR","->",1513],["T_STRING","_os2ip",1513],"(",["T_VARIABLE","$em",1513],")",";",["T_WHITESPACE","\n        ",1513],["T_VARIABLE","$c",1514],["T_WHITESPACE"," ",1514],"=",["T_WHITESPACE"," ",1514],["T_VARIABLE","$this",1514],["T_OBJECT_OPERATOR","->",1514],["T_STRING","_rsaep",1514],"(",["T_VARIABLE","$m",1514],")",";",["T_WHITESPACE","\n        ",1514],["T_VARIABLE","$c",1515],["T_WHITESPACE"," ",1515],"=",["T_WHITESPACE"," ",1515],["T_VARIABLE","$this",1515],["T_OBJECT_OPERATOR","->",1515],["T_STRING","_i2osp",1515],"(",["T_VARIABLE","$c",1515],",",["T_WHITESPACE"," ",1515],["T_VARIABLE","$this",1515],["T_OBJECT_OPERATOR","->",1515],["T_STRING","k",1515],")",";",["T_WHITESPACE","\n\n        ",1515],["T_COMMENT","\/\/ Output the ciphertext C\n",1517],["T_WHITESPACE","\n        ",1518],["T_RETURN","return",1519],["T_WHITESPACE"," ",1519],["T_VARIABLE","$c",1519],";",["T_WHITESPACE","\n    ",1519],"}",["T_WHITESPACE","\n\n    ",1520],["T_DOC_COMMENT","\/**\n     * RSAES-OAEP-DECRYPT\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-7.1.2 RFC3447#section-7.1.2}.  The fact that the error\n     * messages aren't distinguishable from one another hinders debugging, but, to quote from RFC3447#section-7.1.2:\n     * \n     *    Note.  Care must be taken to ensure that an opponent cannot\n     *    distinguish the different error conditions in Step 3.g, whether by\n     *    error message or timing, or, more generally, learn partial\n     *    information about the encoded message EM.  Otherwise an opponent may\n     *    be able to obtain useful information about the decryption of the\n     *    ciphertext C, leading to a chosen-ciphertext attack such as the one\n     *    observed by Manger [36].\n     *\n     * As for $l...  to quote from {@link http:\/\/tools.ietf.org\/html\/rfc3447#page-17 RFC3447#page-17}:\n     *\n     *    Both the encryption and the decryption operations of RSAES-OAEP take\n     *    the value of a label L as input.  In this version of PKCS #1, L is\n     *    the empty string; other uses of the label are outside the scope of\n     *    this document.\n     *\n     * @access private\n     * @param String $c\n     * @param String $l\n     * @return String\n     *\/",1522],["T_WHITESPACE","\n    ",1547],["T_FUNCTION","function",1548],["T_WHITESPACE"," ",1548],["T_STRING","_rsaes_oaep_decrypt",1548],"(",["T_VARIABLE","$c",1548],",",["T_WHITESPACE"," ",1548],["T_VARIABLE","$l",1548],["T_WHITESPACE"," ",1548],"=",["T_WHITESPACE"," ",1548],["T_CONSTANT_ENCAPSED_STRING","''",1548],")",["T_WHITESPACE","\n    ",1548],"{",["T_WHITESPACE","\n        ",1549],["T_COMMENT","\/\/ Length checking\n",1550],["T_WHITESPACE","\n        ",1551],["T_COMMENT","\/\/ if $l is larger than two million terrabytes and you're using sha1, PKCS#1 suggests a \"Label too long\" error\n",1552],["T_WHITESPACE","        ",1553],["T_COMMENT","\/\/ be output.\n",1553],["T_WHITESPACE","\n        ",1554],["T_IF","if",1555],["T_WHITESPACE"," ",1555],"(",["T_STRING","strlen",1555],"(",["T_VARIABLE","$c",1555],")",["T_WHITESPACE"," ",1555],["T_IS_NOT_EQUAL","!=",1555],["T_WHITESPACE"," ",1555],["T_VARIABLE","$this",1555],["T_OBJECT_OPERATOR","->",1555],["T_STRING","k",1555],["T_WHITESPACE"," ",1555],["T_BOOLEAN_OR","||",1555],["T_WHITESPACE"," ",1555],["T_VARIABLE","$this",1555],["T_OBJECT_OPERATOR","->",1555],["T_STRING","k",1555],["T_WHITESPACE"," ",1555],"<",["T_WHITESPACE"," ",1555],["T_LNUMBER","2",1555],["T_WHITESPACE"," ",1555],"*",["T_WHITESPACE"," ",1555],["T_VARIABLE","$this",1555],["T_OBJECT_OPERATOR","->",1555],["T_STRING","hLen",1555],["T_WHITESPACE"," ",1555],"+",["T_WHITESPACE"," ",1555],["T_LNUMBER","2",1555],")",["T_WHITESPACE"," ",1555],"{",["T_WHITESPACE","\n            ",1555],["T_STRING","user_error",1556],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1556],",",["T_WHITESPACE"," ",1556],["T_STRING","E_USER_NOTICE",1556],")",";",["T_WHITESPACE","\n            ",1556],["T_RETURN","return",1557],["T_WHITESPACE"," ",1557],["T_STRING","false",1557],";",["T_WHITESPACE","\n        ",1557],"}",["T_WHITESPACE","\n\n        ",1558],["T_COMMENT","\/\/ RSA decryption\n",1560],["T_WHITESPACE","\n        ",1561],["T_VARIABLE","$c",1562],["T_WHITESPACE"," ",1562],"=",["T_WHITESPACE"," ",1562],["T_VARIABLE","$this",1562],["T_OBJECT_OPERATOR","->",1562],["T_STRING","_os2ip",1562],"(",["T_VARIABLE","$c",1562],")",";",["T_WHITESPACE","\n        ",1562],["T_VARIABLE","$m",1563],["T_WHITESPACE"," ",1563],"=",["T_WHITESPACE"," ",1563],["T_VARIABLE","$this",1563],["T_OBJECT_OPERATOR","->",1563],["T_STRING","_rsadp",1563],"(",["T_VARIABLE","$c",1563],")",";",["T_WHITESPACE","\n        ",1563],["T_IF","if",1564],["T_WHITESPACE"," ",1564],"(",["T_VARIABLE","$m",1564],["T_WHITESPACE"," ",1564],["T_IS_IDENTICAL","===",1564],["T_WHITESPACE"," ",1564],["T_STRING","false",1564],")",["T_WHITESPACE"," ",1564],"{",["T_WHITESPACE","\n            ",1564],["T_STRING","user_error",1565],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1565],",",["T_WHITESPACE"," ",1565],["T_STRING","E_USER_NOTICE",1565],")",";",["T_WHITESPACE","\n            ",1565],["T_RETURN","return",1566],["T_WHITESPACE"," ",1566],["T_STRING","false",1566],";",["T_WHITESPACE","\n        ",1566],"}",["T_WHITESPACE","\n        ",1567],["T_VARIABLE","$em",1568],["T_WHITESPACE"," ",1568],"=",["T_WHITESPACE"," ",1568],["T_VARIABLE","$this",1568],["T_OBJECT_OPERATOR","->",1568],["T_STRING","_i2osp",1568],"(",["T_VARIABLE","$m",1568],",",["T_WHITESPACE"," ",1568],["T_VARIABLE","$this",1568],["T_OBJECT_OPERATOR","->",1568],["T_STRING","k",1568],")",";",["T_WHITESPACE","\n\n        ",1568],["T_COMMENT","\/\/ EME-OAEP decoding\n",1570],["T_WHITESPACE","\n        ",1571],["T_VARIABLE","$lHash",1572],["T_WHITESPACE"," ",1572],"=",["T_WHITESPACE"," ",1572],["T_VARIABLE","$this",1572],["T_OBJECT_OPERATOR","->",1572],["T_STRING","hash",1572],["T_OBJECT_OPERATOR","->",1572],["T_STRING","hash",1572],"(",["T_VARIABLE","$l",1572],")",";",["T_WHITESPACE","\n        ",1572],["T_VARIABLE","$y",1573],["T_WHITESPACE"," ",1573],"=",["T_WHITESPACE"," ",1573],["T_STRING","ord",1573],"(",["T_VARIABLE","$em",1573],"[",["T_LNUMBER","0",1573],"]",")",";",["T_WHITESPACE","\n        ",1573],["T_VARIABLE","$maskedSeed",1574],["T_WHITESPACE"," ",1574],"=",["T_WHITESPACE"," ",1574],["T_STRING","substr",1574],"(",["T_VARIABLE","$em",1574],",",["T_WHITESPACE"," ",1574],["T_LNUMBER","1",1574],",",["T_WHITESPACE"," ",1574],["T_VARIABLE","$this",1574],["T_OBJECT_OPERATOR","->",1574],["T_STRING","hLen",1574],")",";",["T_WHITESPACE","\n        ",1574],["T_VARIABLE","$maskedDB",1575],["T_WHITESPACE"," ",1575],"=",["T_WHITESPACE"," ",1575],["T_STRING","substr",1575],"(",["T_VARIABLE","$em",1575],",",["T_WHITESPACE"," ",1575],["T_VARIABLE","$this",1575],["T_OBJECT_OPERATOR","->",1575],["T_STRING","hLen",1575],["T_WHITESPACE"," ",1575],"+",["T_WHITESPACE"," ",1575],["T_LNUMBER","1",1575],")",";",["T_WHITESPACE","\n        ",1575],["T_VARIABLE","$seedMask",1576],["T_WHITESPACE"," ",1576],"=",["T_WHITESPACE"," ",1576],["T_VARIABLE","$this",1576],["T_OBJECT_OPERATOR","->",1576],["T_STRING","_mgf1",1576],"(",["T_VARIABLE","$maskedDB",1576],",",["T_WHITESPACE"," ",1576],["T_VARIABLE","$this",1576],["T_OBJECT_OPERATOR","->",1576],["T_STRING","hLen",1576],")",";",["T_WHITESPACE","\n        ",1576],["T_VARIABLE","$seed",1577],["T_WHITESPACE"," ",1577],"=",["T_WHITESPACE"," ",1577],["T_VARIABLE","$maskedSeed",1577],["T_WHITESPACE"," ",1577],"^",["T_WHITESPACE"," ",1577],["T_VARIABLE","$seedMask",1577],";",["T_WHITESPACE","\n        ",1577],["T_VARIABLE","$dbMask",1578],["T_WHITESPACE"," ",1578],"=",["T_WHITESPACE"," ",1578],["T_VARIABLE","$this",1578],["T_OBJECT_OPERATOR","->",1578],["T_STRING","_mgf1",1578],"(",["T_VARIABLE","$seed",1578],",",["T_WHITESPACE"," ",1578],["T_VARIABLE","$this",1578],["T_OBJECT_OPERATOR","->",1578],["T_STRING","k",1578],["T_WHITESPACE"," ",1578],"-",["T_WHITESPACE"," ",1578],["T_VARIABLE","$this",1578],["T_OBJECT_OPERATOR","->",1578],["T_STRING","hLen",1578],["T_WHITESPACE"," ",1578],"-",["T_WHITESPACE"," ",1578],["T_LNUMBER","1",1578],")",";",["T_WHITESPACE","\n        ",1578],["T_VARIABLE","$db",1579],["T_WHITESPACE"," ",1579],"=",["T_WHITESPACE"," ",1579],["T_VARIABLE","$maskedDB",1579],["T_WHITESPACE"," ",1579],"^",["T_WHITESPACE"," ",1579],["T_VARIABLE","$dbMask",1579],";",["T_WHITESPACE","\n        ",1579],["T_VARIABLE","$lHash2",1580],["T_WHITESPACE"," ",1580],"=",["T_WHITESPACE"," ",1580],["T_STRING","substr",1580],"(",["T_VARIABLE","$db",1580],",",["T_WHITESPACE"," ",1580],["T_LNUMBER","0",1580],",",["T_WHITESPACE"," ",1580],["T_VARIABLE","$this",1580],["T_OBJECT_OPERATOR","->",1580],["T_STRING","hLen",1580],")",";",["T_WHITESPACE","\n        ",1580],["T_VARIABLE","$m",1581],["T_WHITESPACE"," ",1581],"=",["T_WHITESPACE"," ",1581],["T_STRING","substr",1581],"(",["T_VARIABLE","$db",1581],",",["T_WHITESPACE"," ",1581],["T_VARIABLE","$this",1581],["T_OBJECT_OPERATOR","->",1581],["T_STRING","hLen",1581],")",";",["T_WHITESPACE","\n        ",1581],["T_IF","if",1582],["T_WHITESPACE"," ",1582],"(",["T_VARIABLE","$lHash",1582],["T_WHITESPACE"," ",1582],["T_IS_NOT_EQUAL","!=",1582],["T_WHITESPACE"," ",1582],["T_VARIABLE","$lHash2",1582],")",["T_WHITESPACE"," ",1582],"{",["T_WHITESPACE","\n            ",1582],["T_STRING","user_error",1583],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1583],",",["T_WHITESPACE"," ",1583],["T_STRING","E_USER_NOTICE",1583],")",";",["T_WHITESPACE","\n            ",1583],["T_RETURN","return",1584],["T_WHITESPACE"," ",1584],["T_STRING","false",1584],";",["T_WHITESPACE","\n        ",1584],"}",["T_WHITESPACE","\n        ",1585],["T_VARIABLE","$m",1586],["T_WHITESPACE"," ",1586],"=",["T_WHITESPACE"," ",1586],["T_STRING","ltrim",1586],"(",["T_VARIABLE","$m",1586],",",["T_WHITESPACE"," ",1586],["T_STRING","chr",1586],"(",["T_LNUMBER","0",1586],")",")",";",["T_WHITESPACE","\n        ",1586],["T_IF","if",1587],["T_WHITESPACE"," ",1587],"(",["T_STRING","ord",1587],"(",["T_VARIABLE","$m",1587],"[",["T_LNUMBER","0",1587],"]",")",["T_WHITESPACE"," ",1587],["T_IS_NOT_EQUAL","!=",1587],["T_WHITESPACE"," ",1587],["T_LNUMBER","1",1587],")",["T_WHITESPACE"," ",1587],"{",["T_WHITESPACE","\n            ",1587],["T_STRING","user_error",1588],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1588],",",["T_WHITESPACE"," ",1588],["T_STRING","E_USER_NOTICE",1588],")",";",["T_WHITESPACE","\n            ",1588],["T_RETURN","return",1589],["T_WHITESPACE"," ",1589],["T_STRING","false",1589],";",["T_WHITESPACE","\n        ",1589],"}",["T_WHITESPACE","\n\n        ",1590],["T_COMMENT","\/\/ Output the message M\n",1592],["T_WHITESPACE","\n        ",1593],["T_RETURN","return",1594],["T_WHITESPACE"," ",1594],["T_STRING","substr",1594],"(",["T_VARIABLE","$m",1594],",",["T_WHITESPACE"," ",1594],["T_LNUMBER","1",1594],")",";",["T_WHITESPACE","\n    ",1594],"}",["T_WHITESPACE","\n\n    ",1595],["T_DOC_COMMENT","\/**\n     * RSAES-PKCS1-V1_5-ENCRYPT\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-7.2.1 RFC3447#section-7.2.1}.\n     *\n     * @access private\n     * @param String $m\n     * @return String\n     *\/",1597],["T_WHITESPACE","\n    ",1605],["T_FUNCTION","function",1606],["T_WHITESPACE"," ",1606],["T_STRING","_rsaes_pkcs1_v1_5_encrypt",1606],"(",["T_VARIABLE","$m",1606],")",["T_WHITESPACE","\n    ",1606],"{",["T_WHITESPACE","\n        ",1607],["T_VARIABLE","$mLen",1608],["T_WHITESPACE"," ",1608],"=",["T_WHITESPACE"," ",1608],["T_STRING","strlen",1608],"(",["T_VARIABLE","$m",1608],")",";",["T_WHITESPACE","\n\n        ",1608],["T_COMMENT","\/\/ Length checking\n",1610],["T_WHITESPACE","\n        ",1611],["T_IF","if",1612],["T_WHITESPACE"," ",1612],"(",["T_VARIABLE","$mLen",1612],["T_WHITESPACE"," ",1612],">",["T_WHITESPACE"," ",1612],["T_VARIABLE","$this",1612],["T_OBJECT_OPERATOR","->",1612],["T_STRING","k",1612],["T_WHITESPACE"," ",1612],"-",["T_WHITESPACE"," ",1612],["T_LNUMBER","11",1612],")",["T_WHITESPACE"," ",1612],"{",["T_WHITESPACE","\n            ",1612],["T_STRING","user_error",1613],"(",["T_CONSTANT_ENCAPSED_STRING","'Message too long'",1613],",",["T_WHITESPACE"," ",1613],["T_STRING","E_USER_NOTICE",1613],")",";",["T_WHITESPACE","\n            ",1613],["T_RETURN","return",1614],["T_WHITESPACE"," ",1614],["T_STRING","false",1614],";",["T_WHITESPACE","\n        ",1614],"}",["T_WHITESPACE","\n\n        ",1615],["T_COMMENT","\/\/ EME-PKCS1-v1_5 encoding\n",1617],["T_WHITESPACE","\n        ",1618],["T_VARIABLE","$ps",1619],["T_WHITESPACE"," ",1619],"=",["T_WHITESPACE"," ",1619],["T_VARIABLE","$this",1619],["T_OBJECT_OPERATOR","->",1619],["T_STRING","_random",1619],"(",["T_VARIABLE","$this",1619],["T_OBJECT_OPERATOR","->",1619],["T_STRING","k",1619],["T_WHITESPACE"," ",1619],"-",["T_WHITESPACE"," ",1619],["T_VARIABLE","$mLen",1619],["T_WHITESPACE"," ",1619],"-",["T_WHITESPACE"," ",1619],["T_LNUMBER","3",1619],",",["T_WHITESPACE"," ",1619],["T_STRING","true",1619],")",";",["T_WHITESPACE","\n        ",1619],["T_VARIABLE","$em",1620],["T_WHITESPACE"," ",1620],"=",["T_WHITESPACE"," ",1620],["T_STRING","chr",1620],"(",["T_LNUMBER","0",1620],")",["T_WHITESPACE"," ",1620],".",["T_WHITESPACE"," ",1620],["T_STRING","chr",1620],"(",["T_LNUMBER","2",1620],")",["T_WHITESPACE"," ",1620],".",["T_WHITESPACE"," ",1620],["T_VARIABLE","$ps",1620],["T_WHITESPACE"," ",1620],".",["T_WHITESPACE"," ",1620],["T_STRING","chr",1620],"(",["T_LNUMBER","0",1620],")",["T_WHITESPACE"," ",1620],".",["T_WHITESPACE"," ",1620],["T_VARIABLE","$m",1620],";",["T_WHITESPACE","\n\n        ",1620],["T_COMMENT","\/\/ RSA encryption\n",1622],["T_WHITESPACE","        ",1623],["T_VARIABLE","$m",1623],["T_WHITESPACE"," ",1623],"=",["T_WHITESPACE"," ",1623],["T_VARIABLE","$this",1623],["T_OBJECT_OPERATOR","->",1623],["T_STRING","_os2ip",1623],"(",["T_VARIABLE","$em",1623],")",";",["T_WHITESPACE","\n        ",1623],["T_VARIABLE","$c",1624],["T_WHITESPACE"," ",1624],"=",["T_WHITESPACE"," ",1624],["T_VARIABLE","$this",1624],["T_OBJECT_OPERATOR","->",1624],["T_STRING","_rsaep",1624],"(",["T_VARIABLE","$m",1624],")",";",["T_WHITESPACE","\n        ",1624],["T_VARIABLE","$c",1625],["T_WHITESPACE"," ",1625],"=",["T_WHITESPACE"," ",1625],["T_VARIABLE","$this",1625],["T_OBJECT_OPERATOR","->",1625],["T_STRING","_i2osp",1625],"(",["T_VARIABLE","$c",1625],",",["T_WHITESPACE"," ",1625],["T_VARIABLE","$this",1625],["T_OBJECT_OPERATOR","->",1625],["T_STRING","k",1625],")",";",["T_WHITESPACE","\n\n        ",1625],["T_COMMENT","\/\/ Output the ciphertext C\n",1627],["T_WHITESPACE","\n        ",1628],["T_RETURN","return",1629],["T_WHITESPACE"," ",1629],["T_VARIABLE","$c",1629],";",["T_WHITESPACE","\n    ",1629],"}",["T_WHITESPACE","\n\n    ",1630],["T_DOC_COMMENT","\/**\n     * RSAES-PKCS1-V1_5-DECRYPT\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-7.2.2 RFC3447#section-7.2.2}.\n     *\n     * For compatability purposes, this function departs slightly from the description given in RFC3447.\n     * The reason being that RFC2313#section-8.1 (PKCS#1 v1.5) states that ciphertext's encrypted by the\n     * private key should have the second byte set to either 0 or 1 and that ciphertext's encrypted by the\n     * public key should have the second byte set to 2.  In RFC3447 (PKCS#1 v2.1), the second byte is supposed\n     * to be 2 regardless of which key is used.  for compatability purposes, we'll just check to make sure the\n     * second byte is 2 or less.  If it is, we'll accept the decrypted string as valid.\n     *\n     * As a consequence of this, a private key encrypted ciphertext produced with Crypt_RSA may not decrypt\n     * with a strictly PKCS#1 v1.5 compliant RSA implementation.  Public key encrypted ciphertext's should but\n     * not private key encrypted ciphertext's.\n     *\n     * @access private\n     * @param String $c\n     * @return String\n     *\/",1632],["T_WHITESPACE","\n    ",1651],["T_FUNCTION","function",1652],["T_WHITESPACE"," ",1652],["T_STRING","_rsaes_pkcs1_v1_5_decrypt",1652],"(",["T_VARIABLE","$c",1652],")",["T_WHITESPACE","\n    ",1652],"{",["T_WHITESPACE","\n        ",1653],["T_COMMENT","\/\/ Length checking\n",1654],["T_WHITESPACE","\n        ",1655],["T_IF","if",1656],["T_WHITESPACE"," ",1656],"(",["T_STRING","strlen",1656],"(",["T_VARIABLE","$c",1656],")",["T_WHITESPACE"," ",1656],["T_IS_NOT_EQUAL","!=",1656],["T_WHITESPACE"," ",1656],["T_VARIABLE","$this",1656],["T_OBJECT_OPERATOR","->",1656],["T_STRING","k",1656],")",["T_WHITESPACE"," ",1656],"{",["T_WHITESPACE"," ",1656],["T_COMMENT","\/\/ or if k < 11\n",1656],["T_WHITESPACE","            ",1657],["T_STRING","user_error",1657],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1657],",",["T_WHITESPACE"," ",1657],["T_STRING","E_USER_NOTICE",1657],")",";",["T_WHITESPACE","\n            ",1657],["T_RETURN","return",1658],["T_WHITESPACE"," ",1658],["T_STRING","false",1658],";",["T_WHITESPACE","\n        ",1658],"}",["T_WHITESPACE","\n\n        ",1659],["T_COMMENT","\/\/ RSA decryption\n",1661],["T_WHITESPACE","\n        ",1662],["T_VARIABLE","$c",1663],["T_WHITESPACE"," ",1663],"=",["T_WHITESPACE"," ",1663],["T_VARIABLE","$this",1663],["T_OBJECT_OPERATOR","->",1663],["T_STRING","_os2ip",1663],"(",["T_VARIABLE","$c",1663],")",";",["T_WHITESPACE","\n        ",1663],["T_VARIABLE","$m",1664],["T_WHITESPACE"," ",1664],"=",["T_WHITESPACE"," ",1664],["T_VARIABLE","$this",1664],["T_OBJECT_OPERATOR","->",1664],["T_STRING","_rsadp",1664],"(",["T_VARIABLE","$c",1664],")",";",["T_WHITESPACE","\n        ",1664],["T_IF","if",1665],["T_WHITESPACE"," ",1665],"(",["T_VARIABLE","$m",1665],["T_WHITESPACE"," ",1665],["T_IS_IDENTICAL","===",1665],["T_WHITESPACE"," ",1665],["T_STRING","false",1665],")",["T_WHITESPACE"," ",1665],"{",["T_WHITESPACE","\n            ",1665],["T_STRING","user_error",1666],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1666],",",["T_WHITESPACE"," ",1666],["T_STRING","E_USER_NOTICE",1666],")",";",["T_WHITESPACE","\n            ",1666],["T_RETURN","return",1667],["T_WHITESPACE"," ",1667],["T_STRING","false",1667],";",["T_WHITESPACE","\n        ",1667],"}",["T_WHITESPACE","\n        ",1668],["T_VARIABLE","$em",1669],["T_WHITESPACE"," ",1669],"=",["T_WHITESPACE"," ",1669],["T_VARIABLE","$this",1669],["T_OBJECT_OPERATOR","->",1669],["T_STRING","_i2osp",1669],"(",["T_VARIABLE","$m",1669],",",["T_WHITESPACE"," ",1669],["T_VARIABLE","$this",1669],["T_OBJECT_OPERATOR","->",1669],["T_STRING","k",1669],")",";",["T_WHITESPACE","\n\n        ",1669],["T_COMMENT","\/\/ EME-PKCS1-v1_5 decoding\n",1671],["T_WHITESPACE","\n        ",1672],["T_IF","if",1673],["T_WHITESPACE"," ",1673],"(",["T_STRING","ord",1673],"(",["T_VARIABLE","$em",1673],"[",["T_LNUMBER","0",1673],"]",")",["T_WHITESPACE"," ",1673],["T_IS_NOT_EQUAL","!=",1673],["T_WHITESPACE"," ",1673],["T_LNUMBER","0",1673],["T_WHITESPACE"," ",1673],["T_BOOLEAN_OR","||",1673],["T_WHITESPACE"," ",1673],["T_STRING","ord",1673],"(",["T_VARIABLE","$em",1673],"[",["T_LNUMBER","1",1673],"]",")",["T_WHITESPACE"," ",1673],">",["T_WHITESPACE"," ",1673],["T_LNUMBER","2",1673],")",["T_WHITESPACE"," ",1673],"{",["T_WHITESPACE","\n            ",1673],["T_STRING","user_error",1674],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1674],",",["T_WHITESPACE"," ",1674],["T_STRING","E_USER_NOTICE",1674],")",";",["T_WHITESPACE","\n            ",1674],["T_RETURN","return",1675],["T_WHITESPACE"," ",1675],["T_STRING","false",1675],";",["T_WHITESPACE","\n        ",1675],"}",["T_WHITESPACE","\n\n        ",1676],["T_VARIABLE","$ps",1678],["T_WHITESPACE"," ",1678],"=",["T_WHITESPACE"," ",1678],["T_STRING","substr",1678],"(",["T_VARIABLE","$em",1678],",",["T_WHITESPACE"," ",1678],["T_LNUMBER","2",1678],",",["T_WHITESPACE"," ",1678],["T_STRING","strpos",1678],"(",["T_VARIABLE","$em",1678],",",["T_WHITESPACE"," ",1678],["T_STRING","chr",1678],"(",["T_LNUMBER","0",1678],")",",",["T_WHITESPACE"," ",1678],["T_LNUMBER","2",1678],")",["T_WHITESPACE"," ",1678],"-",["T_WHITESPACE"," ",1678],["T_LNUMBER","2",1678],")",";",["T_WHITESPACE","\n        ",1678],["T_VARIABLE","$m",1679],["T_WHITESPACE"," ",1679],"=",["T_WHITESPACE"," ",1679],["T_STRING","substr",1679],"(",["T_VARIABLE","$em",1679],",",["T_WHITESPACE"," ",1679],["T_STRING","strlen",1679],"(",["T_VARIABLE","$ps",1679],")",["T_WHITESPACE"," ",1679],"+",["T_WHITESPACE"," ",1679],["T_LNUMBER","3",1679],")",";",["T_WHITESPACE","\n\n        ",1679],["T_IF","if",1681],["T_WHITESPACE"," ",1681],"(",["T_STRING","strlen",1681],"(",["T_VARIABLE","$ps",1681],")",["T_WHITESPACE"," ",1681],"<",["T_WHITESPACE"," ",1681],["T_LNUMBER","8",1681],")",["T_WHITESPACE"," ",1681],"{",["T_WHITESPACE","\n            ",1681],["T_STRING","user_error",1682],"(",["T_CONSTANT_ENCAPSED_STRING","'Decryption error'",1682],",",["T_WHITESPACE"," ",1682],["T_STRING","E_USER_NOTICE",1682],")",";",["T_WHITESPACE","\n            ",1682],["T_RETURN","return",1683],["T_WHITESPACE"," ",1683],["T_STRING","false",1683],";",["T_WHITESPACE","\n        ",1683],"}",["T_WHITESPACE","\n\n        ",1684],["T_COMMENT","\/\/ Output M\n",1686],["T_WHITESPACE","\n        ",1687],["T_RETURN","return",1688],["T_WHITESPACE"," ",1688],["T_VARIABLE","$m",1688],";",["T_WHITESPACE","\n    ",1688],"}",["T_WHITESPACE","\n\n    ",1689],["T_DOC_COMMENT","\/**\n     * EMSA-PSS-ENCODE\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-9.1.1 RFC3447#section-9.1.1}.\n     *\n     * @access private\n     * @param String $m\n     * @param Integer $emBits\n     *\/",1691],["T_WHITESPACE","\n    ",1699],["T_FUNCTION","function",1700],["T_WHITESPACE"," ",1700],["T_STRING","_emsa_pss_encode",1700],"(",["T_VARIABLE","$m",1700],",",["T_WHITESPACE"," ",1700],["T_VARIABLE","$emBits",1700],")",["T_WHITESPACE","\n    ",1700],"{",["T_WHITESPACE","\n        ",1701],["T_COMMENT","\/\/ if $m is larger than two million terrabytes and you're using sha1, PKCS#1 suggests a \"Label too long\" error\n",1702],["T_WHITESPACE","        ",1703],["T_COMMENT","\/\/ be output.\n",1703],["T_WHITESPACE","\n        ",1704],["T_VARIABLE","$emLen",1705],["T_WHITESPACE"," ",1705],"=",["T_WHITESPACE"," ",1705],"(",["T_VARIABLE","$emBits",1705],["T_WHITESPACE"," ",1705],"+",["T_WHITESPACE"," ",1705],["T_LNUMBER","1",1705],")",["T_WHITESPACE"," ",1705],["T_SR",">>",1705],["T_WHITESPACE"," ",1705],["T_LNUMBER","3",1705],";",["T_WHITESPACE"," ",1705],["T_COMMENT","\/\/ ie. ceil($emBits \/ 8)\n",1705],["T_WHITESPACE","        ",1706],["T_VARIABLE","$sLen",1706],["T_WHITESPACE"," ",1706],"=",["T_WHITESPACE"," ",1706],["T_VARIABLE","$this",1706],["T_OBJECT_OPERATOR","->",1706],["T_STRING","sLen",1706],["T_WHITESPACE"," ",1706],["T_IS_EQUAL","==",1706],["T_WHITESPACE"," ",1706],["T_STRING","false",1706],["T_WHITESPACE"," ",1706],"?",["T_WHITESPACE"," ",1706],["T_VARIABLE","$this",1706],["T_OBJECT_OPERATOR","->",1706],["T_STRING","hLen",1706],["T_WHITESPACE"," ",1706],":",["T_WHITESPACE"," ",1706],["T_VARIABLE","$this",1706],["T_OBJECT_OPERATOR","->",1706],["T_STRING","sLen",1706],";",["T_WHITESPACE","\n\n        ",1706],["T_VARIABLE","$mHash",1708],["T_WHITESPACE"," ",1708],"=",["T_WHITESPACE"," ",1708],["T_VARIABLE","$this",1708],["T_OBJECT_OPERATOR","->",1708],["T_STRING","hash",1708],["T_OBJECT_OPERATOR","->",1708],["T_STRING","hash",1708],"(",["T_VARIABLE","$m",1708],")",";",["T_WHITESPACE","\n        ",1708],["T_IF","if",1709],["T_WHITESPACE"," ",1709],"(",["T_VARIABLE","$emLen",1709],["T_WHITESPACE"," ",1709],"<",["T_WHITESPACE"," ",1709],["T_VARIABLE","$this",1709],["T_OBJECT_OPERATOR","->",1709],["T_STRING","hLen",1709],["T_WHITESPACE"," ",1709],"+",["T_WHITESPACE"," ",1709],["T_VARIABLE","$sLen",1709],["T_WHITESPACE"," ",1709],"+",["T_WHITESPACE"," ",1709],["T_LNUMBER","2",1709],")",["T_WHITESPACE"," ",1709],"{",["T_WHITESPACE","\n            ",1709],["T_STRING","user_error",1710],"(",["T_CONSTANT_ENCAPSED_STRING","'Encoding error'",1710],",",["T_WHITESPACE"," ",1710],["T_STRING","E_USER_NOTICE",1710],")",";",["T_WHITESPACE","\n            ",1710],["T_RETURN","return",1711],["T_WHITESPACE"," ",1711],["T_STRING","false",1711],";",["T_WHITESPACE","\n        ",1711],"}",["T_WHITESPACE","\n\n        ",1712],["T_VARIABLE","$salt",1714],["T_WHITESPACE"," ",1714],"=",["T_WHITESPACE"," ",1714],["T_VARIABLE","$this",1714],["T_OBJECT_OPERATOR","->",1714],["T_STRING","_random",1714],"(",["T_VARIABLE","$sLen",1714],")",";",["T_WHITESPACE","\n        ",1714],["T_VARIABLE","$m2",1715],["T_WHITESPACE"," ",1715],"=",["T_WHITESPACE"," ",1715],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\\0\\0\\0\\0\"",1715],["T_WHITESPACE"," ",1715],".",["T_WHITESPACE"," ",1715],["T_VARIABLE","$mHash",1715],["T_WHITESPACE"," ",1715],".",["T_WHITESPACE"," ",1715],["T_VARIABLE","$salt",1715],";",["T_WHITESPACE","\n        ",1715],["T_VARIABLE","$h",1716],["T_WHITESPACE"," ",1716],"=",["T_WHITESPACE"," ",1716],["T_VARIABLE","$this",1716],["T_OBJECT_OPERATOR","->",1716],["T_STRING","hash",1716],["T_OBJECT_OPERATOR","->",1716],["T_STRING","hash",1716],"(",["T_VARIABLE","$m2",1716],")",";",["T_WHITESPACE","\n        ",1716],["T_VARIABLE","$ps",1717],["T_WHITESPACE"," ",1717],"=",["T_WHITESPACE"," ",1717],["T_STRING","str_repeat",1717],"(",["T_STRING","chr",1717],"(",["T_LNUMBER","0",1717],")",",",["T_WHITESPACE"," ",1717],["T_VARIABLE","$emLen",1717],["T_WHITESPACE"," ",1717],"-",["T_WHITESPACE"," ",1717],["T_VARIABLE","$sLen",1717],["T_WHITESPACE"," ",1717],"-",["T_WHITESPACE"," ",1717],["T_VARIABLE","$this",1717],["T_OBJECT_OPERATOR","->",1717],["T_STRING","hLen",1717],["T_WHITESPACE"," ",1717],"-",["T_WHITESPACE"," ",1717],["T_LNUMBER","2",1717],")",";",["T_WHITESPACE","\n        ",1717],["T_VARIABLE","$db",1718],["T_WHITESPACE"," ",1718],"=",["T_WHITESPACE"," ",1718],["T_VARIABLE","$ps",1718],["T_WHITESPACE"," ",1718],".",["T_WHITESPACE"," ",1718],["T_STRING","chr",1718],"(",["T_LNUMBER","1",1718],")",["T_WHITESPACE"," ",1718],".",["T_WHITESPACE"," ",1718],["T_VARIABLE","$salt",1718],";",["T_WHITESPACE","\n        ",1718],["T_VARIABLE","$dbMask",1719],["T_WHITESPACE"," ",1719],"=",["T_WHITESPACE"," ",1719],["T_VARIABLE","$this",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","_mgf1",1719],"(",["T_VARIABLE","$h",1719],",",["T_WHITESPACE"," ",1719],["T_VARIABLE","$emLen",1719],["T_WHITESPACE"," ",1719],"-",["T_WHITESPACE"," ",1719],["T_VARIABLE","$this",1719],["T_OBJECT_OPERATOR","->",1719],["T_STRING","hLen",1719],["T_WHITESPACE"," ",1719],"-",["T_WHITESPACE"," ",1719],["T_LNUMBER","1",1719],")",";",["T_WHITESPACE","\n        ",1719],["T_VARIABLE","$maskedDB",1720],["T_WHITESPACE"," ",1720],"=",["T_WHITESPACE"," ",1720],["T_VARIABLE","$db",1720],["T_WHITESPACE"," ",1720],"^",["T_WHITESPACE"," ",1720],["T_VARIABLE","$dbMask",1720],";",["T_WHITESPACE","\n        ",1720],["T_VARIABLE","$maskedDB",1721],"[",["T_LNUMBER","0",1721],"]",["T_WHITESPACE"," ",1721],"=",["T_WHITESPACE"," ",1721],"~",["T_STRING","chr",1721],"(",["T_LNUMBER","0xFF",1721],["T_WHITESPACE"," ",1721],["T_SL","<<",1721],["T_WHITESPACE"," ",1721],"(",["T_VARIABLE","$emBits",1721],["T_WHITESPACE"," ",1721],"&",["T_WHITESPACE"," ",1721],["T_LNUMBER","7",1721],")",")",["T_WHITESPACE"," ",1721],"&",["T_WHITESPACE"," ",1721],["T_VARIABLE","$maskedDB",1721],"[",["T_LNUMBER","0",1721],"]",";",["T_WHITESPACE","\n        ",1721],["T_VARIABLE","$em",1722],["T_WHITESPACE"," ",1722],"=",["T_WHITESPACE"," ",1722],["T_VARIABLE","$maskedDB",1722],["T_WHITESPACE"," ",1722],".",["T_WHITESPACE"," ",1722],["T_VARIABLE","$h",1722],["T_WHITESPACE"," ",1722],".",["T_WHITESPACE"," ",1722],["T_STRING","chr",1722],"(",["T_LNUMBER","0xBC",1722],")",";",["T_WHITESPACE","\n\n        ",1722],["T_RETURN","return",1724],["T_WHITESPACE"," ",1724],["T_VARIABLE","$em",1724],";",["T_WHITESPACE","\n    ",1724],"}",["T_WHITESPACE","\n\n    ",1725],["T_DOC_COMMENT","\/**\n     * EMSA-PSS-VERIFY\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-9.1.2 RFC3447#section-9.1.2}.\n     *\n     * @access private\n     * @param String $m\n     * @param String $em\n     * @param Integer $emBits\n     * @return String\n     *\/",1727],["T_WHITESPACE","\n    ",1737],["T_FUNCTION","function",1738],["T_WHITESPACE"," ",1738],["T_STRING","_emsa_pss_verify",1738],"(",["T_VARIABLE","$m",1738],",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$em",1738],",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$emBits",1738],")",["T_WHITESPACE","\n    ",1738],"{",["T_WHITESPACE","\n        ",1739],["T_COMMENT","\/\/ if $m is larger than two million terrabytes and you're using sha1, PKCS#1 suggests a \"Label too long\" error\n",1740],["T_WHITESPACE","        ",1741],["T_COMMENT","\/\/ be output.\n",1741],["T_WHITESPACE","\n        ",1742],["T_VARIABLE","$emLen",1743],["T_WHITESPACE"," ",1743],"=",["T_WHITESPACE"," ",1743],"(",["T_VARIABLE","$emBits",1743],["T_WHITESPACE"," ",1743],"+",["T_WHITESPACE"," ",1743],["T_LNUMBER","1",1743],")",["T_WHITESPACE"," ",1743],["T_SR",">>",1743],["T_WHITESPACE"," ",1743],["T_LNUMBER","3",1743],";",["T_WHITESPACE"," ",1743],["T_COMMENT","\/\/ ie. ceil($emBits \/ 8);\n",1743],["T_WHITESPACE","        ",1744],["T_VARIABLE","$sLen",1744],["T_WHITESPACE"," ",1744],"=",["T_WHITESPACE"," ",1744],["T_VARIABLE","$this",1744],["T_OBJECT_OPERATOR","->",1744],["T_STRING","sLen",1744],["T_WHITESPACE"," ",1744],["T_IS_EQUAL","==",1744],["T_WHITESPACE"," ",1744],["T_STRING","false",1744],["T_WHITESPACE"," ",1744],"?",["T_WHITESPACE"," ",1744],["T_VARIABLE","$this",1744],["T_OBJECT_OPERATOR","->",1744],["T_STRING","hLen",1744],["T_WHITESPACE"," ",1744],":",["T_WHITESPACE"," ",1744],["T_VARIABLE","$this",1744],["T_OBJECT_OPERATOR","->",1744],["T_STRING","sLen",1744],";",["T_WHITESPACE","\n\n        ",1744],["T_VARIABLE","$mHash",1746],["T_WHITESPACE"," ",1746],"=",["T_WHITESPACE"," ",1746],["T_VARIABLE","$this",1746],["T_OBJECT_OPERATOR","->",1746],["T_STRING","hash",1746],["T_OBJECT_OPERATOR","->",1746],["T_STRING","hash",1746],"(",["T_VARIABLE","$m",1746],")",";",["T_WHITESPACE","\n        ",1746],["T_IF","if",1747],["T_WHITESPACE"," ",1747],"(",["T_VARIABLE","$emLen",1747],["T_WHITESPACE"," ",1747],"<",["T_WHITESPACE"," ",1747],["T_VARIABLE","$this",1747],["T_OBJECT_OPERATOR","->",1747],["T_STRING","hLen",1747],["T_WHITESPACE"," ",1747],"+",["T_WHITESPACE"," ",1747],["T_VARIABLE","$sLen",1747],["T_WHITESPACE"," ",1747],"+",["T_WHITESPACE"," ",1747],["T_LNUMBER","2",1747],")",["T_WHITESPACE"," ",1747],"{",["T_WHITESPACE","\n            ",1747],["T_RETURN","return",1748],["T_WHITESPACE"," ",1748],["T_STRING","false",1748],";",["T_WHITESPACE","\n        ",1748],"}",["T_WHITESPACE","\n\n        ",1749],["T_IF","if",1751],["T_WHITESPACE"," ",1751],"(",["T_VARIABLE","$em",1751],"[",["T_STRING","strlen",1751],"(",["T_VARIABLE","$em",1751],")",["T_WHITESPACE"," ",1751],"-",["T_WHITESPACE"," ",1751],["T_LNUMBER","1",1751],"]",["T_WHITESPACE"," ",1751],["T_IS_NOT_EQUAL","!=",1751],["T_WHITESPACE"," ",1751],["T_STRING","chr",1751],"(",["T_LNUMBER","0xBC",1751],")",")",["T_WHITESPACE"," ",1751],"{",["T_WHITESPACE","\n            ",1751],["T_RETURN","return",1752],["T_WHITESPACE"," ",1752],["T_STRING","false",1752],";",["T_WHITESPACE","\n        ",1752],"}",["T_WHITESPACE","\n\n        ",1753],["T_VARIABLE","$maskedDB",1755],["T_WHITESPACE"," ",1755],"=",["T_WHITESPACE"," ",1755],["T_STRING","substr",1755],"(",["T_VARIABLE","$em",1755],",",["T_WHITESPACE"," ",1755],["T_LNUMBER","0",1755],",",["T_WHITESPACE"," ",1755],["T_VARIABLE","$em",1755],["T_WHITESPACE"," ",1755],"-",["T_WHITESPACE"," ",1755],["T_VARIABLE","$this",1755],["T_OBJECT_OPERATOR","->",1755],["T_STRING","hLen",1755],["T_WHITESPACE"," ",1755],"-",["T_WHITESPACE"," ",1755],["T_LNUMBER","1",1755],")",";",["T_WHITESPACE","\n        ",1755],["T_VARIABLE","$h",1756],["T_WHITESPACE"," ",1756],"=",["T_WHITESPACE"," ",1756],["T_STRING","substr",1756],"(",["T_VARIABLE","$em",1756],",",["T_WHITESPACE"," ",1756],["T_VARIABLE","$em",1756],["T_WHITESPACE"," ",1756],"-",["T_WHITESPACE"," ",1756],["T_VARIABLE","$this",1756],["T_OBJECT_OPERATOR","->",1756],["T_STRING","hLen",1756],["T_WHITESPACE"," ",1756],"-",["T_WHITESPACE"," ",1756],["T_LNUMBER","1",1756],",",["T_WHITESPACE"," ",1756],["T_VARIABLE","$this",1756],["T_OBJECT_OPERATOR","->",1756],["T_STRING","hLen",1756],")",";",["T_WHITESPACE","\n        ",1756],["T_VARIABLE","$temp",1757],["T_WHITESPACE"," ",1757],"=",["T_WHITESPACE"," ",1757],["T_STRING","chr",1757],"(",["T_LNUMBER","0xFF",1757],["T_WHITESPACE"," ",1757],["T_SL","<<",1757],["T_WHITESPACE"," ",1757],"(",["T_VARIABLE","$emBits",1757],["T_WHITESPACE"," ",1757],"&",["T_WHITESPACE"," ",1757],["T_LNUMBER","7",1757],")",")",";",["T_WHITESPACE","\n        ",1757],["T_IF","if",1758],["T_WHITESPACE"," ",1758],"(","(","~",["T_VARIABLE","$maskedDB",1758],"[",["T_LNUMBER","0",1758],"]",["T_WHITESPACE"," ",1758],"&",["T_WHITESPACE"," ",1758],["T_VARIABLE","$temp",1758],")",["T_WHITESPACE"," ",1758],["T_IS_NOT_EQUAL","!=",1758],["T_WHITESPACE"," ",1758],["T_VARIABLE","$temp",1758],")",["T_WHITESPACE"," ",1758],"{",["T_WHITESPACE","\n            ",1758],["T_RETURN","return",1759],["T_WHITESPACE"," ",1759],["T_STRING","false",1759],";",["T_WHITESPACE","\n        ",1759],"}",["T_WHITESPACE","\n        ",1760],["T_VARIABLE","$dbMask",1761],["T_WHITESPACE"," ",1761],"=",["T_WHITESPACE"," ",1761],["T_VARIABLE","$this",1761],["T_OBJECT_OPERATOR","->",1761],["T_STRING","_mgf1",1761],"(",["T_VARIABLE","$h",1761],",",["T_WHITESPACE"," ",1761],["T_VARIABLE","$emLen",1761],["T_WHITESPACE"," ",1761],"-",["T_WHITESPACE"," ",1761],["T_VARIABLE","$this",1761],["T_OBJECT_OPERATOR","->",1761],["T_STRING","hLen",1761],["T_WHITESPACE"," ",1761],"-",["T_WHITESPACE"," ",1761],["T_LNUMBER","1",1761],")",";",["T_WHITESPACE","\n        ",1761],["T_VARIABLE","$db",1762],["T_WHITESPACE"," ",1762],"=",["T_WHITESPACE"," ",1762],["T_VARIABLE","$maskedDB",1762],["T_WHITESPACE"," ",1762],"^",["T_WHITESPACE"," ",1762],["T_VARIABLE","$dbMask",1762],";",["T_WHITESPACE","\n        ",1762],["T_VARIABLE","$db",1763],"[",["T_LNUMBER","0",1763],"]",["T_WHITESPACE"," ",1763],"=",["T_WHITESPACE"," ",1763],"~",["T_STRING","chr",1763],"(",["T_LNUMBER","0xFF",1763],["T_WHITESPACE"," ",1763],["T_SL","<<",1763],["T_WHITESPACE"," ",1763],"(",["T_VARIABLE","$emBits",1763],["T_WHITESPACE"," ",1763],"&",["T_WHITESPACE"," ",1763],["T_LNUMBER","7",1763],")",")",["T_WHITESPACE"," ",1763],"&",["T_WHITESPACE"," ",1763],["T_VARIABLE","$db",1763],"[",["T_LNUMBER","0",1763],"]",";",["T_WHITESPACE","\n        ",1763],["T_VARIABLE","$temp",1764],["T_WHITESPACE"," ",1764],"=",["T_WHITESPACE"," ",1764],["T_VARIABLE","$emLen",1764],["T_WHITESPACE"," ",1764],"-",["T_WHITESPACE"," ",1764],["T_VARIABLE","$this",1764],["T_OBJECT_OPERATOR","->",1764],["T_STRING","hLen",1764],["T_WHITESPACE"," ",1764],"-",["T_WHITESPACE"," ",1764],["T_VARIABLE","$sLen",1764],["T_WHITESPACE"," ",1764],"-",["T_WHITESPACE"," ",1764],["T_LNUMBER","2",1764],";",["T_WHITESPACE","\n        ",1764],["T_IF","if",1765],["T_WHITESPACE"," ",1765],"(",["T_STRING","substr",1765],"(",["T_VARIABLE","$db",1765],",",["T_WHITESPACE"," ",1765],["T_LNUMBER","0",1765],",",["T_WHITESPACE"," ",1765],["T_VARIABLE","$temp",1765],")",["T_WHITESPACE"," ",1765],["T_IS_NOT_EQUAL","!=",1765],["T_WHITESPACE"," ",1765],["T_STRING","str_repeat",1765],"(",["T_STRING","chr",1765],"(",["T_LNUMBER","0",1765],")",",",["T_WHITESPACE"," ",1765],["T_VARIABLE","$temp",1765],")",["T_WHITESPACE"," ",1765],["T_BOOLEAN_OR","||",1765],["T_WHITESPACE"," ",1765],["T_STRING","ord",1765],"(",["T_VARIABLE","$db",1765],"[",["T_VARIABLE","$temp",1765],"]",")",["T_WHITESPACE"," ",1765],["T_IS_NOT_EQUAL","!=",1765],["T_WHITESPACE"," ",1765],["T_LNUMBER","1",1765],")",["T_WHITESPACE"," ",1765],"{",["T_WHITESPACE","\n            ",1765],["T_RETURN","return",1766],["T_WHITESPACE"," ",1766],["T_STRING","false",1766],";",["T_WHITESPACE","\n        ",1766],"}",["T_WHITESPACE","\n        ",1767],["T_VARIABLE","$salt",1768],["T_WHITESPACE"," ",1768],"=",["T_WHITESPACE"," ",1768],["T_STRING","substr",1768],"(",["T_VARIABLE","$db",1768],",",["T_WHITESPACE"," ",1768],["T_VARIABLE","$temp",1768],["T_WHITESPACE"," ",1768],"+",["T_WHITESPACE"," ",1768],["T_LNUMBER","1",1768],")",";",["T_WHITESPACE"," ",1768],["T_COMMENT","\/\/ should be $sLen long\n",1768],["T_WHITESPACE","        ",1769],["T_VARIABLE","$m2",1769],["T_WHITESPACE"," ",1769],"=",["T_WHITESPACE"," ",1769],["T_CONSTANT_ENCAPSED_STRING","\"\\0\\0\\0\\0\\0\\0\\0\\0\"",1769],["T_WHITESPACE"," ",1769],".",["T_WHITESPACE"," ",1769],["T_VARIABLE","$mHash",1769],["T_WHITESPACE"," ",1769],".",["T_WHITESPACE"," ",1769],["T_VARIABLE","$salt",1769],";",["T_WHITESPACE","\n        ",1769],["T_VARIABLE","$h2",1770],["T_WHITESPACE"," ",1770],"=",["T_WHITESPACE"," ",1770],["T_VARIABLE","$this",1770],["T_OBJECT_OPERATOR","->",1770],["T_STRING","hash",1770],["T_OBJECT_OPERATOR","->",1770],["T_STRING","hash",1770],"(",["T_VARIABLE","$m2",1770],")",";",["T_WHITESPACE","\n        ",1770],["T_RETURN","return",1771],["T_WHITESPACE"," ",1771],["T_VARIABLE","$h",1771],["T_WHITESPACE"," ",1771],["T_IS_EQUAL","==",1771],["T_WHITESPACE"," ",1771],["T_VARIABLE","$h2",1771],";",["T_WHITESPACE","\n    ",1771],"}",["T_WHITESPACE","\n\n    ",1772],["T_DOC_COMMENT","\/**\n     * RSASSA-PSS-SIGN\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-8.1.1 RFC3447#section-8.1.1}.\n     *\n     * @access private\n     * @param String $m\n     * @return String\n     *\/",1774],["T_WHITESPACE","\n    ",1782],["T_FUNCTION","function",1783],["T_WHITESPACE"," ",1783],["T_STRING","_rsassa_pss_sign",1783],"(",["T_VARIABLE","$m",1783],")",["T_WHITESPACE","\n    ",1783],"{",["T_WHITESPACE","\n        ",1784],["T_COMMENT","\/\/ EMSA-PSS encoding\n",1785],["T_WHITESPACE","\n        ",1786],["T_VARIABLE","$em",1787],["T_WHITESPACE"," ",1787],"=",["T_WHITESPACE"," ",1787],["T_VARIABLE","$this",1787],["T_OBJECT_OPERATOR","->",1787],["T_STRING","_emsa_pss_encode",1787],"(",["T_VARIABLE","$m",1787],",",["T_WHITESPACE"," ",1787],["T_LNUMBER","8",1787],["T_WHITESPACE"," ",1787],"*",["T_WHITESPACE"," ",1787],["T_VARIABLE","$this",1787],["T_OBJECT_OPERATOR","->",1787],["T_STRING","k",1787],["T_WHITESPACE"," ",1787],"-",["T_WHITESPACE"," ",1787],["T_LNUMBER","1",1787],")",";",["T_WHITESPACE","\n\n        ",1787],["T_COMMENT","\/\/ RSA signature\n",1789],["T_WHITESPACE","\n        ",1790],["T_VARIABLE","$m",1791],["T_WHITESPACE"," ",1791],"=",["T_WHITESPACE"," ",1791],["T_VARIABLE","$this",1791],["T_OBJECT_OPERATOR","->",1791],["T_STRING","_os2ip",1791],"(",["T_VARIABLE","$em",1791],")",";",["T_WHITESPACE","\n        ",1791],["T_VARIABLE","$s",1792],["T_WHITESPACE"," ",1792],"=",["T_WHITESPACE"," ",1792],["T_VARIABLE","$this",1792],["T_OBJECT_OPERATOR","->",1792],["T_STRING","_rsasp1",1792],"(",["T_VARIABLE","$m",1792],")",";",["T_WHITESPACE","\n        ",1792],["T_VARIABLE","$s",1793],["T_WHITESPACE"," ",1793],"=",["T_WHITESPACE"," ",1793],["T_VARIABLE","$this",1793],["T_OBJECT_OPERATOR","->",1793],["T_STRING","_i2osp",1793],"(",["T_VARIABLE","$s",1793],",",["T_WHITESPACE"," ",1793],["T_VARIABLE","$this",1793],["T_OBJECT_OPERATOR","->",1793],["T_STRING","k",1793],")",";",["T_WHITESPACE","\n\n        ",1793],["T_COMMENT","\/\/ Output the signature S\n",1795],["T_WHITESPACE","\n        ",1796],["T_RETURN","return",1797],["T_WHITESPACE"," ",1797],["T_VARIABLE","$s",1797],";",["T_WHITESPACE","\n    ",1797],"}",["T_WHITESPACE","\n\n    ",1798],["T_DOC_COMMENT","\/**\n     * RSASSA-PSS-VERIFY\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-8.1.2 RFC3447#section-8.1.2}.\n     *\n     * @access private\n     * @param String $m\n     * @param String $s\n     * @return String\n     *\/",1800],["T_WHITESPACE","\n    ",1809],["T_FUNCTION","function",1810],["T_WHITESPACE"," ",1810],["T_STRING","_rsassa_pss_verify",1810],"(",["T_VARIABLE","$m",1810],",",["T_WHITESPACE"," ",1810],["T_VARIABLE","$s",1810],")",["T_WHITESPACE","\n    ",1810],"{",["T_WHITESPACE","\n        ",1811],["T_COMMENT","\/\/ Length checking\n",1812],["T_WHITESPACE","\n        ",1813],["T_IF","if",1814],["T_WHITESPACE"," ",1814],"(",["T_STRING","strlen",1814],"(",["T_VARIABLE","$s",1814],")",["T_WHITESPACE"," ",1814],["T_IS_NOT_EQUAL","!=",1814],["T_WHITESPACE"," ",1814],["T_VARIABLE","$this",1814],["T_OBJECT_OPERATOR","->",1814],["T_STRING","k",1814],")",["T_WHITESPACE"," ",1814],"{",["T_WHITESPACE","\n            ",1814],["T_STRING","user_error",1815],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",1815],",",["T_WHITESPACE"," ",1815],["T_STRING","E_USER_NOTICE",1815],")",";",["T_WHITESPACE","\n            ",1815],["T_RETURN","return",1816],["T_WHITESPACE"," ",1816],["T_STRING","false",1816],";",["T_WHITESPACE","\n        ",1816],"}",["T_WHITESPACE","\n\n        ",1817],["T_COMMENT","\/\/ RSA verification\n",1819],["T_WHITESPACE","\n        ",1820],["T_VARIABLE","$modBits",1821],["T_WHITESPACE"," ",1821],"=",["T_WHITESPACE"," ",1821],["T_LNUMBER","8",1821],["T_WHITESPACE"," ",1821],"*",["T_WHITESPACE"," ",1821],["T_VARIABLE","$this",1821],["T_OBJECT_OPERATOR","->",1821],["T_STRING","k",1821],";",["T_WHITESPACE","\n\n        ",1821],["T_VARIABLE","$s2",1823],["T_WHITESPACE"," ",1823],"=",["T_WHITESPACE"," ",1823],["T_VARIABLE","$this",1823],["T_OBJECT_OPERATOR","->",1823],["T_STRING","_os2ip",1823],"(",["T_VARIABLE","$s",1823],")",";",["T_WHITESPACE","\n        ",1823],["T_VARIABLE","$m2",1824],["T_WHITESPACE"," ",1824],"=",["T_WHITESPACE"," ",1824],["T_VARIABLE","$this",1824],["T_OBJECT_OPERATOR","->",1824],["T_STRING","_rsavp1",1824],"(",["T_VARIABLE","$s2",1824],")",";",["T_WHITESPACE","\n        ",1824],["T_IF","if",1825],["T_WHITESPACE"," ",1825],"(",["T_VARIABLE","$m2",1825],["T_WHITESPACE"," ",1825],["T_IS_IDENTICAL","===",1825],["T_WHITESPACE"," ",1825],["T_STRING","false",1825],")",["T_WHITESPACE"," ",1825],"{",["T_WHITESPACE","\n            ",1825],["T_STRING","user_error",1826],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",1826],",",["T_WHITESPACE"," ",1826],["T_STRING","E_USER_NOTICE",1826],")",";",["T_WHITESPACE","\n            ",1826],["T_RETURN","return",1827],["T_WHITESPACE"," ",1827],["T_STRING","false",1827],";",["T_WHITESPACE","\n        ",1827],"}",["T_WHITESPACE","\n        ",1828],["T_VARIABLE","$em",1829],["T_WHITESPACE"," ",1829],"=",["T_WHITESPACE"," ",1829],["T_VARIABLE","$this",1829],["T_OBJECT_OPERATOR","->",1829],["T_STRING","_i2osp",1829],"(",["T_VARIABLE","$m2",1829],",",["T_WHITESPACE"," ",1829],["T_VARIABLE","$modBits",1829],["T_WHITESPACE"," ",1829],["T_SR",">>",1829],["T_WHITESPACE"," ",1829],["T_LNUMBER","3",1829],")",";",["T_WHITESPACE","\n        ",1829],["T_IF","if",1830],["T_WHITESPACE"," ",1830],"(",["T_VARIABLE","$em",1830],["T_WHITESPACE"," ",1830],["T_IS_IDENTICAL","===",1830],["T_WHITESPACE"," ",1830],["T_STRING","false",1830],")",["T_WHITESPACE"," ",1830],"{",["T_WHITESPACE","\n            ",1830],["T_STRING","user_error",1831],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",1831],",",["T_WHITESPACE"," ",1831],["T_STRING","E_USER_NOTICE",1831],")",";",["T_WHITESPACE","\n            ",1831],["T_RETURN","return",1832],["T_WHITESPACE"," ",1832],["T_STRING","false",1832],";",["T_WHITESPACE","\n        ",1832],"}",["T_WHITESPACE","\n\n        ",1833],["T_COMMENT","\/\/ EMSA-PSS verification\n",1835],["T_WHITESPACE","\n        ",1836],["T_RETURN","return",1837],["T_WHITESPACE"," ",1837],["T_VARIABLE","$this",1837],["T_OBJECT_OPERATOR","->",1837],["T_STRING","_emsa_pss_verify",1837],"(",["T_VARIABLE","$m",1837],",",["T_WHITESPACE"," ",1837],["T_VARIABLE","$em",1837],",",["T_WHITESPACE"," ",1837],["T_VARIABLE","$modBits",1837],["T_WHITESPACE"," ",1837],"-",["T_WHITESPACE"," ",1837],["T_LNUMBER","1",1837],")",";",["T_WHITESPACE","\n    ",1837],"}",["T_WHITESPACE","\n\n    ",1838],["T_DOC_COMMENT","\/**\n     * EMSA-PKCS1-V1_5-ENCODE\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-9.2 RFC3447#section-9.2}.\n     *\n     * @access private\n     * @param String $m\n     * @param Integer $emLen\n     * @return String\n     *\/",1840],["T_WHITESPACE","\n    ",1849],["T_FUNCTION","function",1850],["T_WHITESPACE"," ",1850],["T_STRING","_emsa_pkcs1_v1_5_encode",1850],"(",["T_VARIABLE","$m",1850],",",["T_WHITESPACE"," ",1850],["T_VARIABLE","$emLen",1850],")",["T_WHITESPACE","\n    ",1850],"{",["T_WHITESPACE","\n        ",1851],["T_VARIABLE","$h",1852],["T_WHITESPACE"," ",1852],"=",["T_WHITESPACE"," ",1852],["T_VARIABLE","$this",1852],["T_OBJECT_OPERATOR","->",1852],["T_STRING","hash",1852],["T_OBJECT_OPERATOR","->",1852],["T_STRING","hash",1852],"(",["T_VARIABLE","$m",1852],")",";",["T_WHITESPACE","\n        ",1852],["T_IF","if",1853],["T_WHITESPACE"," ",1853],"(",["T_VARIABLE","$h",1853],["T_WHITESPACE"," ",1853],["T_IS_IDENTICAL","===",1853],["T_WHITESPACE"," ",1853],["T_STRING","false",1853],")",["T_WHITESPACE"," ",1853],"{",["T_WHITESPACE","\n            ",1853],["T_RETURN","return",1854],["T_WHITESPACE"," ",1854],["T_STRING","false",1854],";",["T_WHITESPACE","\n        ",1854],"}",["T_WHITESPACE","\n\n        ",1855],["T_COMMENT","\/\/ see http:\/\/tools.ietf.org\/html\/rfc3447#page-43\n",1857],["T_WHITESPACE","        ",1858],["T_SWITCH","switch",1858],["T_WHITESPACE"," ",1858],"(",["T_VARIABLE","$this",1858],["T_OBJECT_OPERATOR","->",1858],["T_STRING","hashName",1858],")",["T_WHITESPACE"," ",1858],"{",["T_WHITESPACE","\n            ",1858],["T_CASE","case",1859],["T_WHITESPACE"," ",1859],["T_CONSTANT_ENCAPSED_STRING","'md2'",1859],":",["T_WHITESPACE","\n                ",1859],["T_VARIABLE","$t",1860],["T_WHITESPACE"," ",1860],"=",["T_WHITESPACE"," ",1860],["T_STRING","pack",1860],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1860],",",["T_WHITESPACE"," ",1860],["T_CONSTANT_ENCAPSED_STRING","'3020300c06082a864886f70d020205000410'",1860],")",";",["T_WHITESPACE","\n                ",1860],["T_BREAK","break",1861],";",["T_WHITESPACE","\n            ",1861],["T_CASE","case",1862],["T_WHITESPACE"," ",1862],["T_CONSTANT_ENCAPSED_STRING","'md5'",1862],":",["T_WHITESPACE","\n                ",1862],["T_VARIABLE","$t",1863],["T_WHITESPACE"," ",1863],"=",["T_WHITESPACE"," ",1863],["T_STRING","pack",1863],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1863],",",["T_WHITESPACE"," ",1863],["T_CONSTANT_ENCAPSED_STRING","'3020300c06082a864886f70d020505000410'",1863],")",";",["T_WHITESPACE","\n                ",1863],["T_BREAK","break",1864],";",["T_WHITESPACE","\n            ",1864],["T_CASE","case",1865],["T_WHITESPACE"," ",1865],["T_CONSTANT_ENCAPSED_STRING","'sha1'",1865],":",["T_WHITESPACE","\n                ",1865],["T_VARIABLE","$t",1866],["T_WHITESPACE"," ",1866],"=",["T_WHITESPACE"," ",1866],["T_STRING","pack",1866],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1866],",",["T_WHITESPACE"," ",1866],["T_CONSTANT_ENCAPSED_STRING","'3021300906052b0e03021a05000414'",1866],")",";",["T_WHITESPACE","\n                ",1866],["T_BREAK","break",1867],";",["T_WHITESPACE","\n            ",1867],["T_CASE","case",1868],["T_WHITESPACE"," ",1868],["T_CONSTANT_ENCAPSED_STRING","'sha256'",1868],":",["T_WHITESPACE","\n                ",1868],["T_VARIABLE","$t",1869],["T_WHITESPACE"," ",1869],"=",["T_WHITESPACE"," ",1869],["T_STRING","pack",1869],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1869],",",["T_WHITESPACE"," ",1869],["T_CONSTANT_ENCAPSED_STRING","'3031300d060960864801650304020105000420'",1869],")",";",["T_WHITESPACE","\n                ",1869],["T_BREAK","break",1870],";",["T_WHITESPACE","\n            ",1870],["T_CASE","case",1871],["T_WHITESPACE"," ",1871],["T_CONSTANT_ENCAPSED_STRING","'sha384'",1871],":",["T_WHITESPACE","\n                ",1871],["T_VARIABLE","$t",1872],["T_WHITESPACE"," ",1872],"=",["T_WHITESPACE"," ",1872],["T_STRING","pack",1872],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1872],",",["T_WHITESPACE"," ",1872],["T_CONSTANT_ENCAPSED_STRING","'3041300d060960864801650304020205000430'",1872],")",";",["T_WHITESPACE","\n                ",1872],["T_BREAK","break",1873],";",["T_WHITESPACE","\n            ",1873],["T_CASE","case",1874],["T_WHITESPACE"," ",1874],["T_CONSTANT_ENCAPSED_STRING","'sha512'",1874],":",["T_WHITESPACE","\n                ",1874],["T_VARIABLE","$t",1875],["T_WHITESPACE"," ",1875],"=",["T_WHITESPACE"," ",1875],["T_STRING","pack",1875],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",1875],",",["T_WHITESPACE"," ",1875],["T_CONSTANT_ENCAPSED_STRING","'3051300d060960864801650304020305000440'",1875],")",";",["T_WHITESPACE","\n        ",1875],"}",["T_WHITESPACE","\n        ",1876],["T_VARIABLE","$t",1877],["T_CONCAT_EQUAL",".=",1877],["T_WHITESPACE"," ",1877],["T_VARIABLE","$h",1877],";",["T_WHITESPACE","\n        ",1877],["T_VARIABLE","$tLen",1878],["T_WHITESPACE"," ",1878],"=",["T_WHITESPACE"," ",1878],["T_STRING","strlen",1878],"(",["T_VARIABLE","$t",1878],")",";",["T_WHITESPACE","\n\n        ",1878],["T_IF","if",1880],["T_WHITESPACE"," ",1880],"(",["T_VARIABLE","$emLen",1880],["T_WHITESPACE"," ",1880],"<",["T_WHITESPACE"," ",1880],["T_VARIABLE","$tLen",1880],["T_WHITESPACE"," ",1880],"+",["T_WHITESPACE"," ",1880],["T_LNUMBER","11",1880],")",["T_WHITESPACE"," ",1880],"{",["T_WHITESPACE","\n            ",1880],["T_STRING","user_error",1881],"(",["T_CONSTANT_ENCAPSED_STRING","'Intended encoded message length too short'",1881],",",["T_WHITESPACE"," ",1881],["T_STRING","E_USER_NOTICE",1881],")",";",["T_WHITESPACE","\n            ",1881],["T_RETURN","return",1882],["T_WHITESPACE"," ",1882],["T_STRING","false",1882],";",["T_WHITESPACE","\n        ",1882],"}",["T_WHITESPACE","\n\n        ",1883],["T_VARIABLE","$ps",1885],["T_WHITESPACE"," ",1885],"=",["T_WHITESPACE"," ",1885],["T_STRING","str_repeat",1885],"(",["T_STRING","chr",1885],"(",["T_LNUMBER","0xFF",1885],")",",",["T_WHITESPACE"," ",1885],["T_VARIABLE","$emLen",1885],["T_WHITESPACE"," ",1885],"-",["T_WHITESPACE"," ",1885],["T_VARIABLE","$tLen",1885],["T_WHITESPACE"," ",1885],"-",["T_WHITESPACE"," ",1885],["T_LNUMBER","3",1885],")",";",["T_WHITESPACE","\n\n        ",1885],["T_VARIABLE","$em",1887],["T_WHITESPACE"," ",1887],"=",["T_WHITESPACE"," ",1887],"\"",["T_ENCAPSED_AND_WHITESPACE","\\0\\1",1887],["T_VARIABLE","$ps",1887],["T_ENCAPSED_AND_WHITESPACE","\\0",1887],["T_VARIABLE","$t",1887],"\"",";",["T_WHITESPACE","\n\n        ",1887],["T_RETURN","return",1889],["T_WHITESPACE"," ",1889],["T_VARIABLE","$em",1889],";",["T_WHITESPACE","\n    ",1889],"}",["T_WHITESPACE","\n\n    ",1890],["T_DOC_COMMENT","\/**\n     * RSASSA-PKCS1-V1_5-SIGN\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-8.2.1 RFC3447#section-8.2.1}.\n     *\n     * @access private\n     * @param String $m\n     * @return String\n     *\/",1892],["T_WHITESPACE","\n    ",1900],["T_FUNCTION","function",1901],["T_WHITESPACE"," ",1901],["T_STRING","_rsassa_pkcs1_v1_5_sign",1901],"(",["T_VARIABLE","$m",1901],")",["T_WHITESPACE","\n    ",1901],"{",["T_WHITESPACE","\n        ",1902],["T_COMMENT","\/\/ EMSA-PKCS1-v1_5 encoding\n",1903],["T_WHITESPACE","\n        ",1904],["T_VARIABLE","$em",1905],["T_WHITESPACE"," ",1905],"=",["T_WHITESPACE"," ",1905],["T_VARIABLE","$this",1905],["T_OBJECT_OPERATOR","->",1905],["T_STRING","_emsa_pkcs1_v1_5_encode",1905],"(",["T_VARIABLE","$m",1905],",",["T_WHITESPACE"," ",1905],["T_VARIABLE","$this",1905],["T_OBJECT_OPERATOR","->",1905],["T_STRING","k",1905],")",";",["T_WHITESPACE","\n        ",1905],["T_IF","if",1906],["T_WHITESPACE"," ",1906],"(",["T_VARIABLE","$em",1906],["T_WHITESPACE"," ",1906],["T_IS_IDENTICAL","===",1906],["T_WHITESPACE"," ",1906],["T_STRING","false",1906],")",["T_WHITESPACE"," ",1906],"{",["T_WHITESPACE","\n            ",1906],["T_STRING","user_error",1907],"(",["T_CONSTANT_ENCAPSED_STRING","'RSA modulus too short'",1907],",",["T_WHITESPACE"," ",1907],["T_STRING","E_USER_NOTICE",1907],")",";",["T_WHITESPACE","\n            ",1907],["T_RETURN","return",1908],["T_WHITESPACE"," ",1908],["T_STRING","false",1908],";",["T_WHITESPACE","\n        ",1908],"}",["T_WHITESPACE","\n\n        ",1909],["T_COMMENT","\/\/ RSA signature\n",1911],["T_WHITESPACE","\n        ",1912],["T_VARIABLE","$m",1913],["T_WHITESPACE"," ",1913],"=",["T_WHITESPACE"," ",1913],["T_VARIABLE","$this",1913],["T_OBJECT_OPERATOR","->",1913],["T_STRING","_os2ip",1913],"(",["T_VARIABLE","$em",1913],")",";",["T_WHITESPACE","\n        ",1913],["T_VARIABLE","$s",1914],["T_WHITESPACE"," ",1914],"=",["T_WHITESPACE"," ",1914],["T_VARIABLE","$this",1914],["T_OBJECT_OPERATOR","->",1914],["T_STRING","_rsasp1",1914],"(",["T_VARIABLE","$m",1914],")",";",["T_WHITESPACE","\n        ",1914],["T_VARIABLE","$s",1915],["T_WHITESPACE"," ",1915],"=",["T_WHITESPACE"," ",1915],["T_VARIABLE","$this",1915],["T_OBJECT_OPERATOR","->",1915],["T_STRING","_i2osp",1915],"(",["T_VARIABLE","$s",1915],",",["T_WHITESPACE"," ",1915],["T_VARIABLE","$this",1915],["T_OBJECT_OPERATOR","->",1915],["T_STRING","k",1915],")",";",["T_WHITESPACE","\n\n        ",1915],["T_COMMENT","\/\/ Output the signature S\n",1917],["T_WHITESPACE","\n        ",1918],["T_RETURN","return",1919],["T_WHITESPACE"," ",1919],["T_VARIABLE","$s",1919],";",["T_WHITESPACE","\n    ",1919],"}",["T_WHITESPACE","\n\n    ",1920],["T_DOC_COMMENT","\/**\n     * RSASSA-PKCS1-V1_5-VERIFY\n     *\n     * See {@link http:\/\/tools.ietf.org\/html\/rfc3447#section-8.2.2 RFC3447#section-8.2.2}.\n     *\n     * @access private\n     * @param String $m\n     * @return String\n     *\/",1922],["T_WHITESPACE","\n    ",1930],["T_FUNCTION","function",1931],["T_WHITESPACE"," ",1931],["T_STRING","_rsassa_pkcs1_v1_5_verify",1931],"(",["T_VARIABLE","$m",1931],",",["T_WHITESPACE"," ",1931],["T_VARIABLE","$s",1931],")",["T_WHITESPACE","\n    ",1931],"{",["T_WHITESPACE","\n        ",1932],["T_COMMENT","\/\/ Length checking\n",1933],["T_WHITESPACE","\n        ",1934],["T_IF","if",1935],["T_WHITESPACE"," ",1935],"(",["T_STRING","strlen",1935],"(",["T_VARIABLE","$s",1935],")",["T_WHITESPACE"," ",1935],["T_IS_NOT_EQUAL","!=",1935],["T_WHITESPACE"," ",1935],["T_VARIABLE","$this",1935],["T_OBJECT_OPERATOR","->",1935],["T_STRING","k",1935],")",["T_WHITESPACE"," ",1935],"{",["T_WHITESPACE","\n            ",1935],["T_STRING","user_error",1936],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",1936],",",["T_WHITESPACE"," ",1936],["T_STRING","E_USER_NOTICE",1936],")",";",["T_WHITESPACE","\n            ",1936],["T_RETURN","return",1937],["T_WHITESPACE"," ",1937],["T_STRING","false",1937],";",["T_WHITESPACE","\n        ",1937],"}",["T_WHITESPACE","\n\n        ",1938],["T_COMMENT","\/\/ RSA verification\n",1940],["T_WHITESPACE","\n        ",1941],["T_VARIABLE","$s",1942],["T_WHITESPACE"," ",1942],"=",["T_WHITESPACE"," ",1942],["T_VARIABLE","$this",1942],["T_OBJECT_OPERATOR","->",1942],["T_STRING","_os2ip",1942],"(",["T_VARIABLE","$s",1942],")",";",["T_WHITESPACE","\n        ",1942],["T_VARIABLE","$m2",1943],["T_WHITESPACE"," ",1943],"=",["T_WHITESPACE"," ",1943],["T_VARIABLE","$this",1943],["T_OBJECT_OPERATOR","->",1943],["T_STRING","_rsavp1",1943],"(",["T_VARIABLE","$s",1943],")",";",["T_WHITESPACE","\n        ",1943],["T_IF","if",1944],["T_WHITESPACE"," ",1944],"(",["T_VARIABLE","$m2",1944],["T_WHITESPACE"," ",1944],["T_IS_IDENTICAL","===",1944],["T_WHITESPACE"," ",1944],["T_STRING","false",1944],")",["T_WHITESPACE"," ",1944],"{",["T_WHITESPACE","\n            ",1944],["T_STRING","user_error",1945],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",1945],",",["T_WHITESPACE"," ",1945],["T_STRING","E_USER_NOTICE",1945],")",";",["T_WHITESPACE","\n            ",1945],["T_RETURN","return",1946],["T_WHITESPACE"," ",1946],["T_STRING","false",1946],";",["T_WHITESPACE","\n        ",1946],"}",["T_WHITESPACE","\n        ",1947],["T_VARIABLE","$em",1948],["T_WHITESPACE"," ",1948],"=",["T_WHITESPACE"," ",1948],["T_VARIABLE","$this",1948],["T_OBJECT_OPERATOR","->",1948],["T_STRING","_i2osp",1948],"(",["T_VARIABLE","$m2",1948],",",["T_WHITESPACE"," ",1948],["T_VARIABLE","$this",1948],["T_OBJECT_OPERATOR","->",1948],["T_STRING","k",1948],")",";",["T_WHITESPACE","\n        ",1948],["T_IF","if",1949],["T_WHITESPACE"," ",1949],"(",["T_VARIABLE","$em",1949],["T_WHITESPACE"," ",1949],["T_IS_IDENTICAL","===",1949],["T_WHITESPACE"," ",1949],["T_STRING","false",1949],")",["T_WHITESPACE"," ",1949],"{",["T_WHITESPACE","\n            ",1949],["T_STRING","user_error",1950],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",1950],",",["T_WHITESPACE"," ",1950],["T_STRING","E_USER_NOTICE",1950],")",";",["T_WHITESPACE","\n            ",1950],["T_RETURN","return",1951],["T_WHITESPACE"," ",1951],["T_STRING","false",1951],";",["T_WHITESPACE","\n        ",1951],"}",["T_WHITESPACE","\n\n        ",1952],["T_COMMENT","\/\/ EMSA-PKCS1-v1_5 encoding\n",1954],["T_WHITESPACE","\n        ",1955],["T_VARIABLE","$em2",1956],["T_WHITESPACE"," ",1956],"=",["T_WHITESPACE"," ",1956],["T_VARIABLE","$this",1956],["T_OBJECT_OPERATOR","->",1956],["T_STRING","_emsa_pkcs1_v1_5_encode",1956],"(",["T_VARIABLE","$m",1956],",",["T_WHITESPACE"," ",1956],["T_VARIABLE","$this",1956],["T_OBJECT_OPERATOR","->",1956],["T_STRING","k",1956],")",";",["T_WHITESPACE","\n        ",1956],["T_IF","if",1957],["T_WHITESPACE"," ",1957],"(",["T_VARIABLE","$em2",1957],["T_WHITESPACE"," ",1957],["T_IS_IDENTICAL","===",1957],["T_WHITESPACE"," ",1957],["T_STRING","false",1957],")",["T_WHITESPACE"," ",1957],"{",["T_WHITESPACE","\n            ",1957],["T_STRING","user_error",1958],"(",["T_CONSTANT_ENCAPSED_STRING","'RSA modulus too short'",1958],",",["T_WHITESPACE"," ",1958],["T_STRING","E_USER_NOTICE",1958],")",";",["T_WHITESPACE","\n            ",1958],["T_RETURN","return",1959],["T_WHITESPACE"," ",1959],["T_STRING","false",1959],";",["T_WHITESPACE","\n        ",1959],"}",["T_WHITESPACE","\n\n        ",1960],["T_COMMENT","\/\/ Compare\n",1962],["T_WHITESPACE","\n        ",1963],["T_RETURN","return",1964],["T_WHITESPACE"," ",1964],["T_VARIABLE","$em",1964],["T_WHITESPACE"," ",1964],["T_IS_IDENTICAL","===",1964],["T_WHITESPACE"," ",1964],["T_VARIABLE","$em2",1964],";",["T_WHITESPACE","\n    ",1964],"}",["T_WHITESPACE","\n\n    ",1965],["T_DOC_COMMENT","\/**\n     * Set Encryption Mode\n     *\n     * Valid values include CRYPT_RSA_ENCRYPTION_OAEP and CRYPT_RSA_ENCRYPTION_PKCS1.\n     *\n     * @access public\n     * @param Integer $mode\n     *\/",1967],["T_WHITESPACE","\n    ",1974],["T_FUNCTION","function",1975],["T_WHITESPACE"," ",1975],["T_STRING","setEncryptionMode",1975],"(",["T_VARIABLE","$mode",1975],")",["T_WHITESPACE","\n    ",1975],"{",["T_WHITESPACE","\n        ",1976],["T_VARIABLE","$this",1977],["T_OBJECT_OPERATOR","->",1977],["T_STRING","encryptionMode",1977],["T_WHITESPACE"," ",1977],"=",["T_WHITESPACE"," ",1977],["T_VARIABLE","$mode",1977],";",["T_WHITESPACE","\n    ",1977],"}",["T_WHITESPACE","\n\n    ",1978],["T_DOC_COMMENT","\/**\n     * Set Signature Mode\n     *\n     * Valid values include CRYPT_RSA_SIGNATURE_PSS and CRYPT_RSA_SIGNATURE_PKCS1\n     *\n     * @access public\n     * @param Integer $mode\n     *\/",1980],["T_WHITESPACE","\n    ",1987],["T_FUNCTION","function",1988],["T_WHITESPACE"," ",1988],["T_STRING","setSignatureMode",1988],"(",["T_VARIABLE","$mode",1988],")",["T_WHITESPACE","\n    ",1988],"{",["T_WHITESPACE","\n        ",1989],["T_VARIABLE","$this",1990],["T_OBJECT_OPERATOR","->",1990],["T_STRING","signatureMode",1990],["T_WHITESPACE"," ",1990],"=",["T_WHITESPACE"," ",1990],["T_VARIABLE","$mode",1990],";",["T_WHITESPACE","\n    ",1990],"}",["T_WHITESPACE","\n\n    ",1991],["T_DOC_COMMENT","\/**\n     * Encryption\n     *\n     * Both CRYPT_RSA_ENCRYPTION_OAEP and CRYPT_RSA_ENCRYPTION_PKCS1 both place limits on how long $plaintext can be.\n     * If $plaintext exceeds those limits it will be broken up so that it does and the resultant ciphertext's will\n     * be concatenated together.\n     *\n     * @see decrypt()\n     * @access public\n     * @param String $plaintext\n     * @return String\n     *\/",1993],["T_WHITESPACE","\n    ",2004],["T_FUNCTION","function",2005],["T_WHITESPACE"," ",2005],["T_STRING","encrypt",2005],"(",["T_VARIABLE","$plaintext",2005],")",["T_WHITESPACE","\n    ",2005],"{",["T_WHITESPACE","\n        ",2006],["T_SWITCH","switch",2007],["T_WHITESPACE"," ",2007],"(",["T_VARIABLE","$this",2007],["T_OBJECT_OPERATOR","->",2007],["T_STRING","encryptionMode",2007],")",["T_WHITESPACE"," ",2007],"{",["T_WHITESPACE","\n            ",2007],["T_CASE","case",2008],["T_WHITESPACE"," ",2008],["T_STRING","CRYPT_RSA_ENCRYPTION_PKCS1",2008],":",["T_WHITESPACE","\n                ",2008],["T_VARIABLE","$length",2009],["T_WHITESPACE"," ",2009],"=",["T_WHITESPACE"," ",2009],["T_VARIABLE","$this",2009],["T_OBJECT_OPERATOR","->",2009],["T_STRING","k",2009],["T_WHITESPACE"," ",2009],"-",["T_WHITESPACE"," ",2009],["T_LNUMBER","11",2009],";",["T_WHITESPACE","\n                ",2009],["T_IF","if",2010],["T_WHITESPACE"," ",2010],"(",["T_VARIABLE","$length",2010],["T_WHITESPACE"," ",2010],["T_IS_SMALLER_OR_EQUAL","<=",2010],["T_WHITESPACE"," ",2010],["T_LNUMBER","0",2010],")",["T_WHITESPACE"," ",2010],"{",["T_WHITESPACE","\n                    ",2010],["T_RETURN","return",2011],["T_WHITESPACE"," ",2011],["T_STRING","false",2011],";",["T_WHITESPACE","\n                ",2011],"}",["T_WHITESPACE","\n\n                ",2012],["T_VARIABLE","$plaintext",2014],["T_WHITESPACE"," ",2014],"=",["T_WHITESPACE"," ",2014],["T_STRING","str_split",2014],"(",["T_VARIABLE","$plaintext",2014],",",["T_WHITESPACE"," ",2014],["T_VARIABLE","$length",2014],")",";",["T_WHITESPACE","\n                ",2014],["T_VARIABLE","$ciphertext",2015],["T_WHITESPACE"," ",2015],"=",["T_WHITESPACE"," ",2015],["T_CONSTANT_ENCAPSED_STRING","''",2015],";",["T_WHITESPACE","\n                ",2015],["T_FOREACH","foreach",2016],["T_WHITESPACE"," ",2016],"(",["T_VARIABLE","$plaintext",2016],["T_WHITESPACE"," ",2016],["T_AS","as",2016],["T_WHITESPACE"," ",2016],["T_VARIABLE","$m",2016],")",["T_WHITESPACE"," ",2016],"{",["T_WHITESPACE","\n                    ",2016],["T_VARIABLE","$ciphertext",2017],["T_CONCAT_EQUAL",".=",2017],["T_WHITESPACE"," ",2017],["T_VARIABLE","$this",2017],["T_OBJECT_OPERATOR","->",2017],["T_STRING","_rsaes_pkcs1_v1_5_encrypt",2017],"(",["T_VARIABLE","$m",2017],")",";",["T_WHITESPACE","\n                ",2017],"}",["T_WHITESPACE","\n                ",2018],["T_RETURN","return",2019],["T_WHITESPACE"," ",2019],["T_VARIABLE","$ciphertext",2019],";",["T_WHITESPACE","\n            ",2019],["T_COMMENT","\/\/case CRYPT_RSA_ENCRYPTION_OAEP:\n",2020],["T_WHITESPACE","            ",2021],["T_DEFAULT","default",2021],":",["T_WHITESPACE","\n                ",2021],["T_VARIABLE","$length",2022],["T_WHITESPACE"," ",2022],"=",["T_WHITESPACE"," ",2022],["T_VARIABLE","$this",2022],["T_OBJECT_OPERATOR","->",2022],["T_STRING","k",2022],["T_WHITESPACE"," ",2022],"-",["T_WHITESPACE"," ",2022],["T_LNUMBER","2",2022],["T_WHITESPACE"," ",2022],"*",["T_WHITESPACE"," ",2022],["T_VARIABLE","$this",2022],["T_OBJECT_OPERATOR","->",2022],["T_STRING","hLen",2022],["T_WHITESPACE"," ",2022],"-",["T_WHITESPACE"," ",2022],["T_LNUMBER","2",2022],";",["T_WHITESPACE","\n                ",2022],["T_IF","if",2023],["T_WHITESPACE"," ",2023],"(",["T_VARIABLE","$length",2023],["T_WHITESPACE"," ",2023],["T_IS_SMALLER_OR_EQUAL","<=",2023],["T_WHITESPACE"," ",2023],["T_LNUMBER","0",2023],")",["T_WHITESPACE"," ",2023],"{",["T_WHITESPACE","\n                    ",2023],["T_RETURN","return",2024],["T_WHITESPACE"," ",2024],["T_STRING","false",2024],";",["T_WHITESPACE","\n                ",2024],"}",["T_WHITESPACE","\n\n                ",2025],["T_VARIABLE","$plaintext",2027],["T_WHITESPACE"," ",2027],"=",["T_WHITESPACE"," ",2027],["T_STRING","str_split",2027],"(",["T_VARIABLE","$plaintext",2027],",",["T_WHITESPACE"," ",2027],["T_VARIABLE","$length",2027],")",";",["T_WHITESPACE","\n                ",2027],["T_VARIABLE","$ciphertext",2028],["T_WHITESPACE"," ",2028],"=",["T_WHITESPACE"," ",2028],["T_CONSTANT_ENCAPSED_STRING","''",2028],";",["T_WHITESPACE","\n                ",2028],["T_FOREACH","foreach",2029],["T_WHITESPACE"," ",2029],"(",["T_VARIABLE","$plaintext",2029],["T_WHITESPACE"," ",2029],["T_AS","as",2029],["T_WHITESPACE"," ",2029],["T_VARIABLE","$m",2029],")",["T_WHITESPACE"," ",2029],"{",["T_WHITESPACE","\n                    ",2029],["T_VARIABLE","$ciphertext",2030],["T_CONCAT_EQUAL",".=",2030],["T_WHITESPACE"," ",2030],["T_VARIABLE","$this",2030],["T_OBJECT_OPERATOR","->",2030],["T_STRING","_rsaes_oaep_encrypt",2030],"(",["T_VARIABLE","$m",2030],")",";",["T_WHITESPACE","\n                ",2030],"}",["T_WHITESPACE","\n                ",2031],["T_RETURN","return",2032],["T_WHITESPACE"," ",2032],["T_VARIABLE","$ciphertext",2032],";",["T_WHITESPACE","\n        ",2032],"}",["T_WHITESPACE","\n    ",2033],"}",["T_WHITESPACE","\n\n    ",2034],["T_DOC_COMMENT","\/**\n     * Decryption\n     *\n     * @see encrypt()\n     * @access public\n     * @param String $plaintext\n     * @return String\n     *\/",2036],["T_WHITESPACE","\n    ",2043],["T_FUNCTION","function",2044],["T_WHITESPACE"," ",2044],["T_STRING","decrypt",2044],"(",["T_VARIABLE","$ciphertext",2044],")",["T_WHITESPACE","\n    ",2044],"{",["T_WHITESPACE","\n        ",2045],["T_IF","if",2046],["T_WHITESPACE"," ",2046],"(",["T_VARIABLE","$this",2046],["T_OBJECT_OPERATOR","->",2046],["T_STRING","k",2046],["T_WHITESPACE"," ",2046],["T_IS_SMALLER_OR_EQUAL","<=",2046],["T_WHITESPACE"," ",2046],["T_LNUMBER","0",2046],")",["T_WHITESPACE"," ",2046],"{",["T_WHITESPACE","\n            ",2046],["T_RETURN","return",2047],["T_WHITESPACE"," ",2047],["T_STRING","false",2047],";",["T_WHITESPACE","\n        ",2047],"}",["T_WHITESPACE","\n\n        ",2048],["T_VARIABLE","$ciphertext",2050],["T_WHITESPACE"," ",2050],"=",["T_WHITESPACE"," ",2050],["T_STRING","str_split",2050],"(",["T_VARIABLE","$ciphertext",2050],",",["T_WHITESPACE"," ",2050],["T_VARIABLE","$this",2050],["T_OBJECT_OPERATOR","->",2050],["T_STRING","k",2050],")",";",["T_WHITESPACE","\n        ",2050],["T_VARIABLE","$plaintext",2051],["T_WHITESPACE"," ",2051],"=",["T_WHITESPACE"," ",2051],["T_CONSTANT_ENCAPSED_STRING","''",2051],";",["T_WHITESPACE","\n\n        ",2051],["T_SWITCH","switch",2053],["T_WHITESPACE"," ",2053],"(",["T_VARIABLE","$this",2053],["T_OBJECT_OPERATOR","->",2053],["T_STRING","encryptionMode",2053],")",["T_WHITESPACE"," ",2053],"{",["T_WHITESPACE","\n            ",2053],["T_CASE","case",2054],["T_WHITESPACE"," ",2054],["T_STRING","CRYPT_RSA_ENCRYPTION_PKCS1",2054],":",["T_WHITESPACE","\n                ",2054],["T_VARIABLE","$decrypt",2055],["T_WHITESPACE"," ",2055],"=",["T_WHITESPACE"," ",2055],["T_CONSTANT_ENCAPSED_STRING","'_rsaes_pkcs1_v1_5_decrypt'",2055],";",["T_WHITESPACE","\n                ",2055],["T_BREAK","break",2056],";",["T_WHITESPACE","\n            ",2056],["T_COMMENT","\/\/case CRYPT_RSA_ENCRYPTION_OAEP:\n",2057],["T_WHITESPACE","            ",2058],["T_DEFAULT","default",2058],":",["T_WHITESPACE","\n                ",2058],["T_VARIABLE","$decrypt",2059],["T_WHITESPACE"," ",2059],"=",["T_WHITESPACE"," ",2059],["T_CONSTANT_ENCAPSED_STRING","'_rsaes_oaep_decrypt'",2059],";",["T_WHITESPACE","\n        ",2059],"}",["T_WHITESPACE","\n\n        ",2060],["T_FOREACH","foreach",2062],["T_WHITESPACE"," ",2062],"(",["T_VARIABLE","$ciphertext",2062],["T_WHITESPACE"," ",2062],["T_AS","as",2062],["T_WHITESPACE"," ",2062],["T_VARIABLE","$c",2062],")",["T_WHITESPACE"," ",2062],"{",["T_WHITESPACE","\n            ",2062],["T_VARIABLE","$temp",2063],["T_WHITESPACE"," ",2063],"=",["T_WHITESPACE"," ",2063],["T_VARIABLE","$this",2063],["T_OBJECT_OPERATOR","->",2063],["T_VARIABLE","$decrypt",2063],"(",["T_VARIABLE","$c",2063],")",";",["T_WHITESPACE","\n            ",2063],["T_IF","if",2064],["T_WHITESPACE"," ",2064],"(",["T_VARIABLE","$temp",2064],["T_WHITESPACE"," ",2064],["T_IS_IDENTICAL","===",2064],["T_WHITESPACE"," ",2064],["T_STRING","false",2064],")",["T_WHITESPACE"," ",2064],"{",["T_WHITESPACE","\n                ",2064],["T_RETURN","return",2065],["T_WHITESPACE"," ",2065],["T_STRING","false",2065],";",["T_WHITESPACE","\n            ",2065],"}",["T_WHITESPACE","\n            ",2066],["T_VARIABLE","$plaintext",2067],["T_CONCAT_EQUAL",".=",2067],["T_WHITESPACE"," ",2067],["T_VARIABLE","$temp",2067],";",["T_WHITESPACE","\n        ",2067],"}",["T_WHITESPACE","\n\n        ",2068],["T_RETURN","return",2070],["T_WHITESPACE"," ",2070],["T_VARIABLE","$plaintext",2070],";",["T_WHITESPACE","\n    ",2070],"}",["T_WHITESPACE","\n\n    ",2071],["T_DOC_COMMENT","\/**\n     * Create a signature\n     *\n     * @see verify()\n     * @access public\n     * @param String $message\n     * @return String\n     *\/",2073],["T_WHITESPACE","\n    ",2080],["T_FUNCTION","function",2081],["T_WHITESPACE"," ",2081],["T_STRING","sign",2081],"(",["T_VARIABLE","$message",2081],")",["T_WHITESPACE","\n    ",2081],"{",["T_WHITESPACE","\n        ",2082],["T_IF","if",2083],["T_WHITESPACE"," ",2083],"(",["T_EMPTY","empty",2083],"(",["T_VARIABLE","$this",2083],["T_OBJECT_OPERATOR","->",2083],["T_STRING","modulus",2083],")",["T_WHITESPACE"," ",2083],["T_BOOLEAN_OR","||",2083],["T_WHITESPACE"," ",2083],["T_EMPTY","empty",2083],"(",["T_VARIABLE","$this",2083],["T_OBJECT_OPERATOR","->",2083],["T_STRING","exponent",2083],")",")",["T_WHITESPACE"," ",2083],"{",["T_WHITESPACE","\n            ",2083],["T_RETURN","return",2084],["T_WHITESPACE"," ",2084],["T_STRING","false",2084],";",["T_WHITESPACE","\n        ",2084],"}",["T_WHITESPACE","\n\n        ",2085],["T_SWITCH","switch",2087],["T_WHITESPACE"," ",2087],"(",["T_VARIABLE","$this",2087],["T_OBJECT_OPERATOR","->",2087],["T_STRING","signatureMode",2087],")",["T_WHITESPACE"," ",2087],"{",["T_WHITESPACE","\n            ",2087],["T_CASE","case",2088],["T_WHITESPACE"," ",2088],["T_STRING","CRYPT_RSA_SIGNATURE_PKCS1",2088],":",["T_WHITESPACE","\n                ",2088],["T_RETURN","return",2089],["T_WHITESPACE"," ",2089],["T_VARIABLE","$this",2089],["T_OBJECT_OPERATOR","->",2089],["T_STRING","_rsassa_pkcs1_v1_5_sign",2089],"(",["T_VARIABLE","$message",2089],")",";",["T_WHITESPACE","\n            ",2089],["T_COMMENT","\/\/case CRYPT_RSA_SIGNATURE_PSS:\n",2090],["T_WHITESPACE","            ",2091],["T_DEFAULT","default",2091],":",["T_WHITESPACE","\n                ",2091],["T_RETURN","return",2092],["T_WHITESPACE"," ",2092],["T_VARIABLE","$this",2092],["T_OBJECT_OPERATOR","->",2092],["T_STRING","_rsassa_pss_sign",2092],"(",["T_VARIABLE","$message",2092],")",";",["T_WHITESPACE","\n        ",2092],"}",["T_WHITESPACE","\n    ",2093],"}",["T_WHITESPACE","\n\n    ",2094],["T_DOC_COMMENT","\/**\n     * Verifies a signature\n     *\n     * @see sign()\n     * @access public\n     * @param String $message\n     * @param String $signature\n     * @return Boolean\n     *\/",2096],["T_WHITESPACE","\n    ",2104],["T_FUNCTION","function",2105],["T_WHITESPACE"," ",2105],["T_STRING","verify",2105],"(",["T_VARIABLE","$message",2105],",",["T_WHITESPACE"," ",2105],["T_VARIABLE","$signature",2105],")",["T_WHITESPACE","\n    ",2105],"{",["T_WHITESPACE","\n        ",2106],["T_IF","if",2107],["T_WHITESPACE"," ",2107],"(",["T_EMPTY","empty",2107],"(",["T_VARIABLE","$this",2107],["T_OBJECT_OPERATOR","->",2107],["T_STRING","modulus",2107],")",["T_WHITESPACE"," ",2107],["T_BOOLEAN_OR","||",2107],["T_WHITESPACE"," ",2107],["T_EMPTY","empty",2107],"(",["T_VARIABLE","$this",2107],["T_OBJECT_OPERATOR","->",2107],["T_STRING","exponent",2107],")",")",["T_WHITESPACE"," ",2107],"{",["T_WHITESPACE","\n            ",2107],["T_RETURN","return",2108],["T_WHITESPACE"," ",2108],["T_STRING","false",2108],";",["T_WHITESPACE","\n        ",2108],"}",["T_WHITESPACE","\n\n        ",2109],["T_SWITCH","switch",2111],["T_WHITESPACE"," ",2111],"(",["T_VARIABLE","$this",2111],["T_OBJECT_OPERATOR","->",2111],["T_STRING","signatureMode",2111],")",["T_WHITESPACE"," ",2111],"{",["T_WHITESPACE","\n            ",2111],["T_CASE","case",2112],["T_WHITESPACE"," ",2112],["T_STRING","CRYPT_RSA_SIGNATURE_PKCS1",2112],":",["T_WHITESPACE","\n                ",2112],["T_RETURN","return",2113],["T_WHITESPACE"," ",2113],["T_VARIABLE","$this",2113],["T_OBJECT_OPERATOR","->",2113],["T_STRING","_rsassa_pkcs1_v1_5_verify",2113],"(",["T_VARIABLE","$message",2113],",",["T_WHITESPACE"," ",2113],["T_VARIABLE","$signature",2113],")",";",["T_WHITESPACE","\n            ",2113],["T_COMMENT","\/\/case CRYPT_RSA_SIGNATURE_PSS:\n",2114],["T_WHITESPACE","            ",2115],["T_DEFAULT","default",2115],":",["T_WHITESPACE","\n                ",2115],["T_RETURN","return",2116],["T_WHITESPACE"," ",2116],["T_VARIABLE","$this",2116],["T_OBJECT_OPERATOR","->",2116],["T_STRING","_rsassa_pss_verify",2116],"(",["T_VARIABLE","$message",2116],",",["T_WHITESPACE"," ",2116],["T_VARIABLE","$signature",2116],")",";",["T_WHITESPACE","\n        ",2116],"}",["T_WHITESPACE","\n    ",2117],"}",["T_WHITESPACE","\n",2118],"}",["T_WHITESPACE","\n",2119]]