[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Auth\n * @subpackage Zend_Auth_Adapter_Http\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n\n",21],["T_DOC_COMMENT","\/**\n * @see Zend_Auth_Adapter_Http_Resolver_Interface\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Interface.php';\n",27],["T_WHITESPACE","\n\n",28],["T_DOC_COMMENT","\/**\n * HTTP Authentication File Resolver\n *\n * @category   Zend\n * @package    Zend_Auth\n * @subpackage Zend_Auth_Adapter_Http\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",30],["T_WHITESPACE","\n",38],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Auth_Adapter_Http_Resolver_File",39],["T_WHITESPACE"," ",39],["T_IMPLEMENTS","implements",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Interface",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n    ",40],["T_DOC_COMMENT","\/**\n     * Path to credentials file\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_file",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param  string $path Complete filename where the credentials are stored\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","__construct",53],"(",["T_VARIABLE","$path",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","''",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_IF","if",55],["T_WHITESPACE"," ",55],"(","!",["T_EMPTY","empty",55],"(",["T_VARIABLE","$path",55],")",")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","setFile",56],"(",["T_VARIABLE","$path",56],")",";",["T_WHITESPACE","\n        ",56],"}",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Set the path to the credentials file\n     *\n     * @param  string $path\n     * @throws Zend_Auth_Adapter_Http_Resolver_Exception\n     * @return Zend_Auth_Adapter_Http_Resolver_File Provides a fluent interface\n     *\/",60],["T_WHITESPACE","\n    ",66],["T_PUBLIC","public",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","setFile",67],"(",["T_VARIABLE","$path",67],")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_EMPTY","empty",69],"(",["T_VARIABLE","$path",69],")",["T_WHITESPACE"," ",69],["T_BOOLEAN_OR","||",69],["T_WHITESPACE"," ",69],"!",["T_STRING","is_readable",69],"(",["T_VARIABLE","$path",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Http_Resolver_Exception\n             *\/",70],["T_WHITESPACE","\n            ",72],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Exception.php';\n",73],["T_WHITESPACE","            ",74],["T_THROW","throw",74],["T_WHITESPACE"," ",74],["T_NEW","new",74],["T_WHITESPACE"," ",74],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Exception",74],"(",["T_CONSTANT_ENCAPSED_STRING","'Path not readable: '",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_VARIABLE","$path",74],")",";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_file",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$path",76],";",["T_WHITESPACE","\n\n        ",76],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Returns the path to the credentials file\n     *\n     * @return string\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","getFile",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_file",88],";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Resolve credentials\n     *\n     * Only the first matching username\/realm combination in the file is\n     * returned. If the file contains credentials for Digest authentication,\n     * the returned string is the password hash, or h(a1) from RFC 2617. The\n     * returned string is the plain-text password for Basic authentication.\n     *\n     * The expected format of the file is:\n     *   username:realm:sharedSecret\n     *\n     * That is, each line consists of the user's username, the applicable\n     * authentication realm, and the password or hash, each delimited by\n     * colons.\n     *\n     * @param  string $username Username\n     * @param  string $realm    Authentication Realm\n     * @throws Zend_Auth_Adapter_Http_Resolver_Exception\n     * @return string|false User's shared secret, if the user is found in the\n     *         realm, false otherwise.\n     *\/",91],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","resolve",112],"(",["T_VARIABLE","$username",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$realm",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_EMPTY","empty",114],"(",["T_VARIABLE","$username",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Http_Resolver_Exception\n             *\/",115],["T_WHITESPACE","\n            ",117],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Exception.php';\n",118],["T_WHITESPACE","            ",119],["T_THROW","throw",119],["T_WHITESPACE"," ",119],["T_NEW","new",119],["T_WHITESPACE"," ",119],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Exception",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Username is required'",119],")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE"," ",120],["T_ELSE","else",120],["T_WHITESPACE"," ",120],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_STRING","ctype_print",120],"(",["T_VARIABLE","$username",120],")",["T_WHITESPACE"," ",120],["T_BOOLEAN_OR","||",120],["T_WHITESPACE"," ",120],["T_STRING","strpos",120],"(",["T_VARIABLE","$username",120],",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","':'",120],")",["T_WHITESPACE"," ",120],["T_IS_NOT_IDENTICAL","!==",120],["T_WHITESPACE"," ",120],["T_STRING","false",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Http_Resolver_Exception\n             *\/",121],["T_WHITESPACE","\n            ",123],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Exception.php';\n",124],["T_WHITESPACE","            ",125],["T_THROW","throw",125],["T_WHITESPACE"," ",125],["T_NEW","new",125],["T_WHITESPACE"," ",125],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Exception",125],"(",["T_CONSTANT_ENCAPSED_STRING","'Username must consist only of printable characters, '",125],["T_WHITESPACE","\n                                                              ",125],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'excluding the colon'",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_EMPTY","empty",128],"(",["T_VARIABLE","$realm",128],")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Http_Resolver_Exception\n             *\/",129],["T_WHITESPACE","\n            ",131],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Exception.php';\n",132],["T_WHITESPACE","            ",133],["T_THROW","throw",133],["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Exception",133],"(",["T_CONSTANT_ENCAPSED_STRING","'Realm is required'",133],")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_ELSE","else",134],["T_WHITESPACE"," ",134],["T_IF","if",134],["T_WHITESPACE"," ",134],"(","!",["T_STRING","ctype_print",134],"(",["T_VARIABLE","$realm",134],")",["T_WHITESPACE"," ",134],["T_BOOLEAN_OR","||",134],["T_WHITESPACE"," ",134],["T_STRING","strpos",134],"(",["T_VARIABLE","$realm",134],",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","':'",134],")",["T_WHITESPACE"," ",134],["T_IS_NOT_IDENTICAL","!==",134],["T_WHITESPACE"," ",134],["T_STRING","false",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Http_Resolver_Exception\n             *\/",135],["T_WHITESPACE","\n            ",137],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Exception.php';\n",138],["T_WHITESPACE","            ",139],["T_THROW","throw",139],["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Exception",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Realm must consist only of printable characters, '",139],["T_WHITESPACE","\n                                                              ",139],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'excluding the colon.'",140],")",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_COMMENT","\/\/ Open file, read through looking for matching credentials\n",143],["T_WHITESPACE","        ",144],["T_VARIABLE","$fp",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],"@",["T_STRING","fopen",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_file",144],",",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'r'",144],")",";",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(","!",["T_VARIABLE","$fp",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Http_Resolver_Exception\n             *\/",146],["T_WHITESPACE","\n            ",148],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Http\/Resolver\/Exception.php';\n",149],["T_WHITESPACE","            ",150],["T_THROW","throw",150],["T_WHITESPACE"," ",150],["T_NEW","new",150],["T_WHITESPACE"," ",150],["T_STRING","Zend_Auth_Adapter_Http_Resolver_Exception",150],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to open password file: '",150],["T_WHITESPACE"," ",150],".",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_file",150],")",";",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n\n        ",151],["T_COMMENT","\/\/ No real validation is done on the contents of the password file. The\n",153],["T_WHITESPACE","        ",154],["T_COMMENT","\/\/ assumption is that we trust the administrators to keep it secure.\n",154],["T_WHITESPACE","        ",155],["T_WHILE","while",155],["T_WHITESPACE"," ",155],"(","(",["T_VARIABLE","$line",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","fgetcsv",155],"(",["T_VARIABLE","$fp",155],",",["T_WHITESPACE"," ",155],["T_LNUMBER","512",155],",",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","':'",155],")",")",["T_WHITESPACE"," ",155],["T_IS_NOT_IDENTICAL","!==",155],["T_WHITESPACE"," ",155],["T_STRING","false",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n            ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$line",156],"[",["T_LNUMBER","0",156],"]",["T_WHITESPACE"," ",156],["T_IS_EQUAL","==",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$username",156],["T_WHITESPACE"," ",156],["T_BOOLEAN_AND","&&",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$line",156],"[",["T_LNUMBER","1",156],"]",["T_WHITESPACE"," ",156],["T_IS_EQUAL","==",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$realm",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n                ",156],["T_VARIABLE","$password",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$line",157],"[",["T_LNUMBER","2",157],"]",";",["T_WHITESPACE","\n                ",157],["T_STRING","fclose",158],"(",["T_VARIABLE","$fp",158],")",";",["T_WHITESPACE","\n                ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$password",159],";",["T_WHITESPACE","\n            ",159],"}",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n\n        ",161],["T_STRING","fclose",163],"(",["T_VARIABLE","$fp",163],")",";",["T_WHITESPACE","\n        ",163],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_STRING","false",164],";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n",165],"}",["T_WHITESPACE","\n",166]]