[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Auth\n * @subpackage Zend_Auth_Adapter_Http\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n\n",21],["T_DOC_COMMENT","\/**\n * @see Zend_Auth_Adapter_Interface\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Interface.php';\n",27],["T_WHITESPACE","\n\n",28],["T_DOC_COMMENT","\/**\n * HTTP Authentication Adapter\n *\n * Implements a pretty good chunk of RFC 2617.\n *\n * @category   Zend\n * @package    Zend_Auth\n * @subpackage Zend_Auth_Adapter_Http\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @todo       Support auth-int\n * @todo       Track nonces, nonce-count, opaque for replay protection and stale support\n * @todo       Support Authentication-Info header\n *\/",30],["T_WHITESPACE","\n",43],["T_CLASS","class",44],["T_WHITESPACE"," ",44],["T_STRING","Zend_Auth_Adapter_Http",44],["T_WHITESPACE"," ",44],["T_IMPLEMENTS","implements",44],["T_WHITESPACE"," ",44],["T_STRING","Zend_Auth_Adapter_Interface",44],["T_WHITESPACE","\n",44],"{",["T_WHITESPACE","\n    ",45],["T_DOC_COMMENT","\/**\n     * Reference to the HTTP Request object\n     *\n     * @var Zend_Controller_Request_Http\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$_request",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Reference to the HTTP Response object\n     *\n     * @var Zend_Controller_Response_Http\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_response",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Object that looks up user credentials for the Basic scheme\n     *\n     * @var Zend_Auth_Adapter_Http_Resolver_Interface\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_basicResolver",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Object that looks up user credentials for the Digest scheme\n     *\n     * @var Zend_Auth_Adapter_Http_Resolver_Interface\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$_digestResolver",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * List of authentication schemes supported by this class\n     *\n     * @var array\n     *\/",74],["T_WHITESPACE","\n    ",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$_supportedSchemes",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",["T_CONSTANT_ENCAPSED_STRING","'basic'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'digest'",79],")",";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * List of schemes this class will accept from the client\n     *\n     * @var array\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_acceptSchemes",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Space-delimited list of protected domains for Digest Auth\n     *\n     * @var string\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_PROTECTED","protected",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$_domains",93],";",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * The protection realm to use\n     *\n     * @var string\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$_realm",100],";",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Nonce timeout period\n     *\n     * @var integer\n     *\/",102],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$_nonceTimeout",107],";",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Whether to send the opaque value in the header. True by default\n     *\n     * @var boolean\n     *\/",109],["T_WHITESPACE","\n    ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$_useOpaque",114],";",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * List of the supported digest algorithms. I want to support both MD5 and\n     * MD5-sess, but MD5-sess won't make it into the first version.\n     *\n     * @var array\n     *\/",116],["T_WHITESPACE","\n    ",121],["T_PROTECTED","protected",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$_supportedAlgos",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",["T_CONSTANT_ENCAPSED_STRING","'MD5'",122],")",";",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * The actual algorithm to use. Defaults to MD5\n     *\n     * @var string\n     *\/",124],["T_WHITESPACE","\n    ",128],["T_PROTECTED","protected",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$_algo",129],";",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * List of supported qop options. My intetion is to support both 'auth' and\n     * 'auth-int', but 'auth-int' won't make it into the first version.\n     *\n     * @var array\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PROTECTED","protected",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$_supportedQops",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_ARRAY","array",137],"(",["T_CONSTANT_ENCAPSED_STRING","'auth'",137],")",";",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Whether or not to do Proxy Authentication instead of origin server\n     * authentication (send 407's instead of 401's). Off by default.\n     *\n     * @var boolean\n     *\/",139],["T_WHITESPACE","\n    ",144],["T_PROTECTED","protected",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$_imaProxy",145],";",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Flag indicating the client is IE and didn't bother to return the opaque string\n     *\n     * @var boolean\n     *\/",147],["T_WHITESPACE","\n    ",151],["T_PROTECTED","protected",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$_ieNoOpaque",152],";",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param  array $config Configuration settings:\n     *    'accept_schemes' => 'basic'|'digest'|'basic digest'\n     *    'realm' => <string>\n     *    'digest_domains' => <string> Space-delimited list of URIs\n     *    'nonce_timeout' => <int>\n     *    'use_opaque' => <bool> Whether to send the opaque value in the header\n     *    'alogrithm' => <string> See $_supportedAlgos. Default: MD5\n     *    'proxy_auth' => <bool> Whether to do authentication as a Proxy\n     * @throws Zend_Auth_Adapter_Exception\n     *\/",154],["T_WHITESPACE","\n    ",166],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","__construct",167],"(",["T_ARRAY","array",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$config",167],")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_IF","if",169],["T_WHITESPACE"," ",169],"(","!",["T_STRING","extension_loaded",169],"(",["T_CONSTANT_ENCAPSED_STRING","'hash'",169],")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",170],["T_WHITESPACE","\n            ",172],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",173],["T_WHITESPACE","            ",174],["T_THROW","throw",174],["T_WHITESPACE"," ",174],["T_NEW","new",174],["T_WHITESPACE"," ",174],["T_STRING","Zend_Auth_Adapter_Exception",174],"(",["T_CLASS_C","__CLASS__",174],["T_WHITESPACE","  ",174],".",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","' requires the \\'hash\\' extension'",174],")",";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE","\n\n        ",175],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_request",177],["T_WHITESPACE","  ",177],"=",["T_WHITESPACE"," ",177],["T_STRING","null",177],";",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_response",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","null",178],";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_ieNoOpaque",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING","false",179],";",["T_WHITESPACE","\n\n\n        ",179],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_EMPTY","empty",182],"(",["T_VARIABLE","$config",182],"[",["T_CONSTANT_ENCAPSED_STRING","'accept_schemes'",182],"]",")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",183],["T_WHITESPACE","\n            ",185],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",186],["T_WHITESPACE","            ",187],["T_THROW","throw",187],["T_WHITESPACE"," ",187],["T_NEW","new",187],["T_WHITESPACE"," ",187],["T_STRING","Zend_Auth_Adapter_Exception",187],"(",["T_CONSTANT_ENCAPSED_STRING","'Config key \\'accept_schemes\\' is required'",187],")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n\n        ",188],["T_VARIABLE","$schemes",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","explode",190],"(",["T_CONSTANT_ENCAPSED_STRING","' '",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$config",190],"[",["T_CONSTANT_ENCAPSED_STRING","'accept_schemes'",190],"]",")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_acceptSchemes",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","array_intersect",191],"(",["T_VARIABLE","$schemes",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_supportedSchemes",191],")",";",["T_WHITESPACE","\n        ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_EMPTY","empty",192],"(",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_acceptSchemes",192],")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",193],["T_WHITESPACE","\n            ",195],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",196],["T_WHITESPACE","            ",197],["T_THROW","throw",197],["T_WHITESPACE"," ",197],["T_NEW","new",197],["T_WHITESPACE"," ",197],["T_STRING","Zend_Auth_Adapter_Exception",197],"(",["T_CONSTANT_ENCAPSED_STRING","'No supported schemes given in \\'accept_schemes\\'. Valid values: '",197],["T_WHITESPACE","\n                                                ",197],".",["T_WHITESPACE"," ",198],["T_STRING","implode",198],"(",["T_CONSTANT_ENCAPSED_STRING","', '",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_supportedSchemes",198],")",")",";",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE","\n\n        ",199],["T_COMMENT","\/\/ Double-quotes are used to delimit the realm string in the HTTP header,\n",201],["T_WHITESPACE","        ",202],["T_COMMENT","\/\/ and colons are field delimiters in the password file.\n",202],["T_WHITESPACE","        ",203],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_EMPTY","empty",203],"(",["T_VARIABLE","$config",203],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",203],"]",")",["T_WHITESPACE"," ",203],["T_BOOLEAN_OR","||",203],["T_WHITESPACE","\n            ",203],"!",["T_STRING","ctype_print",204],"(",["T_VARIABLE","$config",204],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",204],"]",")",["T_WHITESPACE"," ",204],["T_BOOLEAN_OR","||",204],["T_WHITESPACE","\n            ",204],["T_STRING","strpos",205],"(",["T_VARIABLE","$config",205],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",205],"]",",",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","':'",205],")",["T_WHITESPACE"," ",205],["T_IS_NOT_IDENTICAL","!==",205],["T_WHITESPACE"," ",205],["T_STRING","false",205],["T_WHITESPACE"," ",205],["T_BOOLEAN_OR","||",205],["T_WHITESPACE","\n            ",205],["T_STRING","strpos",206],"(",["T_VARIABLE","$config",206],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",206],"]",",",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'\"'",206],")",["T_WHITESPACE"," ",206],["T_IS_NOT_IDENTICAL","!==",206],["T_WHITESPACE"," ",206],["T_STRING","false",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n            ",206],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",207],["T_WHITESPACE","\n            ",209],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",210],["T_WHITESPACE","            ",211],["T_THROW","throw",211],["T_WHITESPACE"," ",211],["T_NEW","new",211],["T_WHITESPACE"," ",211],["T_STRING","Zend_Auth_Adapter_Exception",211],"(",["T_CONSTANT_ENCAPSED_STRING","'Config key \\'realm\\' is required, and must contain only printable '",211],["T_WHITESPACE","\n                                                ",211],".",["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","'characters, excluding quotation marks and colons'",212],")",";",["T_WHITESPACE","\n        ",212],"}",["T_WHITESPACE"," ",213],["T_ELSE","else",213],["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_realm",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$config",214],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",214],"]",";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n\n        ",215],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_STRING","in_array",217],"(",["T_CONSTANT_ENCAPSED_STRING","'digest'",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_acceptSchemes",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_IF","if",218],["T_WHITESPACE"," ",218],"(",["T_EMPTY","empty",218],"(",["T_VARIABLE","$config",218],"[",["T_CONSTANT_ENCAPSED_STRING","'digest_domains'",218],"]",")",["T_WHITESPACE"," ",218],["T_BOOLEAN_OR","||",218],["T_WHITESPACE","\n                ",218],"!",["T_STRING","ctype_print",219],"(",["T_VARIABLE","$config",219],"[",["T_CONSTANT_ENCAPSED_STRING","'digest_domains'",219],"]",")",["T_WHITESPACE"," ",219],["T_BOOLEAN_OR","||",219],["T_WHITESPACE","\n                ",219],["T_STRING","strpos",220],"(",["T_VARIABLE","$config",220],"[",["T_CONSTANT_ENCAPSED_STRING","'digest_domains'",220],"]",",",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'\"'",220],")",["T_WHITESPACE"," ",220],["T_IS_NOT_IDENTICAL","!==",220],["T_WHITESPACE"," ",220],["T_STRING","false",220],")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n                ",220],["T_DOC_COMMENT","\/**\n                 * @see Zend_Auth_Adapter_Exception\n                 *\/",221],["T_WHITESPACE","\n                ",223],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",224],["T_WHITESPACE","                ",225],["T_THROW","throw",225],["T_WHITESPACE"," ",225],["T_NEW","new",225],["T_WHITESPACE"," ",225],["T_STRING","Zend_Auth_Adapter_Exception",225],"(",["T_CONSTANT_ENCAPSED_STRING","'Config key \\'digest_domains\\' is required, and must contain '",225],["T_WHITESPACE","\n                                                    ",225],".",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'only printable characters, excluding quotation marks'",226],")",";",["T_WHITESPACE","\n            ",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_domains",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$config",228],"[",["T_CONSTANT_ENCAPSED_STRING","'digest_domains'",228],"]",";",["T_WHITESPACE","\n            ",228],"}",["T_WHITESPACE","\n\n            ",229],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_EMPTY","empty",231],"(",["T_VARIABLE","$config",231],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce_timeout'",231],"]",")",["T_WHITESPACE"," ",231],["T_BOOLEAN_OR","||",231],["T_WHITESPACE","\n                ",231],"!",["T_STRING","is_numeric",232],"(",["T_VARIABLE","$config",232],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce_timeout'",232],"]",")",")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                ",232],["T_DOC_COMMENT","\/**\n                 * @see Zend_Auth_Adapter_Exception\n                 *\/",233],["T_WHITESPACE","\n                ",235],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",236],["T_WHITESPACE","                ",237],["T_THROW","throw",237],["T_WHITESPACE"," ",237],["T_NEW","new",237],["T_WHITESPACE"," ",237],["T_STRING","Zend_Auth_Adapter_Exception",237],"(",["T_CONSTANT_ENCAPSED_STRING","'Config key \\'nonce_timeout\\' is required, and must be an '",237],["T_WHITESPACE","\n                                                    ",237],".",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'integer'",238],")",";",["T_WHITESPACE","\n            ",238],"}",["T_WHITESPACE"," ",239],["T_ELSE","else",239],["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_nonceTimeout",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_INT_CAST","(int)",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$config",240],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce_timeout'",240],"]",";",["T_WHITESPACE","\n            ",240],"}",["T_WHITESPACE","\n\n            ",241],["T_COMMENT","\/\/ We use the opaque value unless explicitly told not to\n",243],["T_WHITESPACE","            ",244],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_ISSET","isset",244],"(",["T_VARIABLE","$config",244],"[",["T_CONSTANT_ENCAPSED_STRING","'use_opaque'",244],"]",")",["T_WHITESPACE"," ",244],["T_BOOLEAN_AND","&&",244],["T_WHITESPACE"," ",244],["T_STRING","false",244],["T_WHITESPACE"," ",244],["T_IS_EQUAL","==",244],["T_WHITESPACE"," ",244],["T_BOOL_CAST","(bool)",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$config",244],"[",["T_CONSTANT_ENCAPSED_STRING","'use_opaque'",244],"]",")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n                ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_useOpaque",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","false",245],";",["T_WHITESPACE","\n            ",245],"}",["T_WHITESPACE"," ",246],["T_ELSE","else",246],["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_useOpaque",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","true",247],";",["T_WHITESPACE","\n            ",247],"}",["T_WHITESPACE","\n\n            ",248],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_ISSET","isset",250],"(",["T_VARIABLE","$config",250],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",250],"]",")",["T_WHITESPACE"," ",250],["T_BOOLEAN_AND","&&",250],["T_WHITESPACE"," ",250],["T_STRING","in_array",250],"(",["T_VARIABLE","$config",250],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",250],"]",",",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_supportedAlgos",250],")",")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_algo",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$config",251],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",251],"]",";",["T_WHITESPACE","\n            ",251],"}",["T_WHITESPACE"," ",252],["T_ELSE","else",252],["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_algo",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'MD5'",253],";",["T_WHITESPACE","\n            ",253],"}",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n\n        ",255],["T_COMMENT","\/\/ Don't be a proxy unless explicitly told to do so\n",257],["T_WHITESPACE","        ",258],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_ISSET","isset",258],"(",["T_VARIABLE","$config",258],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_auth'",258],"]",")",["T_WHITESPACE"," ",258],["T_BOOLEAN_AND","&&",258],["T_WHITESPACE"," ",258],["T_STRING","true",258],["T_WHITESPACE"," ",258],["T_IS_EQUAL","==",258],["T_WHITESPACE"," ",258],["T_BOOL_CAST","(bool)",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$config",258],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_auth'",258],"]",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n            ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_imaProxy",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_STRING","true",259],";",["T_WHITESPACE","  ",259],["T_COMMENT","\/\/ I'm a Proxy\n",259],["T_WHITESPACE","        ",260],"}",["T_WHITESPACE"," ",260],["T_ELSE","else",260],["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_imaProxy",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","false",261],";",["T_WHITESPACE","\n        ",261],"}",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n\n    ",263],["T_DOC_COMMENT","\/**\n     * Setter for the _basicResolver property\n     *\n     * @param  Zend_Auth_Adapter_Http_Resolver_Interface $resolver\n     * @return Zend_Auth_Adapter_Http Provides a fluent interface\n     *\/",265],["T_WHITESPACE","\n    ",270],["T_PUBLIC","public",271],["T_WHITESPACE"," ",271],["T_FUNCTION","function",271],["T_WHITESPACE"," ",271],["T_STRING","setBasicResolver",271],"(",["T_STRING","Zend_Auth_Adapter_Http_Resolver_Interface",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$resolver",271],")",["T_WHITESPACE","\n    ",271],"{",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_basicResolver",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$resolver",273],";",["T_WHITESPACE","\n\n        ",273],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n\n    ",276],["T_DOC_COMMENT","\/**\n     * Getter for the _basicResolver property\n     *\n     * @return Zend_Auth_Adapter_Http_Resolver_Interface\n     *\/",278],["T_WHITESPACE","\n    ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","getBasicResolver",283],"(",")",["T_WHITESPACE","\n    ",283],"{",["T_WHITESPACE","\n        ",284],["T_RETURN","return",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","_basicResolver",285],";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_DOC_COMMENT","\/**\n     * Setter for the _digestResolver property\n     *\n     * @param  Zend_Auth_Adapter_Http_Resolver_Interface $resolver\n     * @return Zend_Auth_Adapter_Http Provides a fluent interface\n     *\/",288],["T_WHITESPACE","\n    ",293],["T_PUBLIC","public",294],["T_WHITESPACE"," ",294],["T_FUNCTION","function",294],["T_WHITESPACE"," ",294],["T_STRING","setDigestResolver",294],"(",["T_STRING","Zend_Auth_Adapter_Http_Resolver_Interface",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$resolver",294],")",["T_WHITESPACE","\n    ",294],"{",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","_digestResolver",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$resolver",296],";",["T_WHITESPACE","\n\n        ",296],["T_RETURN","return",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],";",["T_WHITESPACE","\n    ",298],"}",["T_WHITESPACE","\n\n    ",299],["T_DOC_COMMENT","\/**\n     * Getter for the _digestResolver property\n     *\n     * @return Zend_Auth_Adapter_Http_Resolver_Interface\n     *\/",301],["T_WHITESPACE","\n    ",305],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","getDigestResolver",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_RETURN","return",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","_digestResolver",308],";",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * Setter for the Request object\n     *\n     * @param  Zend_Controller_Request_Http $request\n     * @return Zend_Auth_Adapter_Http Provides a fluent interface\n     *\/",311],["T_WHITESPACE","\n    ",316],["T_PUBLIC","public",317],["T_WHITESPACE"," ",317],["T_FUNCTION","function",317],["T_WHITESPACE"," ",317],["T_STRING","setRequest",317],"(",["T_STRING","Zend_Controller_Request_Http",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$request",317],")",["T_WHITESPACE","\n    ",317],"{",["T_WHITESPACE","\n        ",318],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","_request",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$request",319],";",["T_WHITESPACE","\n\n        ",319],["T_RETURN","return",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n\n    ",322],["T_DOC_COMMENT","\/**\n     * Getter for the Request object\n     *\n     * @return Zend_Controller_Request_Http\n     *\/",324],["T_WHITESPACE","\n    ",328],["T_PUBLIC","public",329],["T_WHITESPACE"," ",329],["T_FUNCTION","function",329],["T_WHITESPACE"," ",329],["T_STRING","getRequest",329],"(",")",["T_WHITESPACE","\n    ",329],"{",["T_WHITESPACE","\n        ",330],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_request",331],";",["T_WHITESPACE","\n    ",331],"}",["T_WHITESPACE","\n\n    ",332],["T_DOC_COMMENT","\/**\n     * Setter for the Response object\n     *\n     * @param  Zend_Controller_Response_Http $response\n     * @return Zend_Auth_Adapter_Http Provides a fluent interface\n     *\/",334],["T_WHITESPACE","\n    ",339],["T_PUBLIC","public",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","setResponse",340],"(",["T_STRING","Zend_Controller_Response_Http",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$response",340],")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_response",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_VARIABLE","$response",342],";",["T_WHITESPACE","\n\n        ",342],["T_RETURN","return",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],";",["T_WHITESPACE","\n    ",344],"}",["T_WHITESPACE","\n\n    ",345],["T_DOC_COMMENT","\/**\n     * Getter for the Response object\n     *\n     * @return Zend_Controller_Response_Http\n     *\/",347],["T_WHITESPACE","\n    ",351],["T_PUBLIC","public",352],["T_WHITESPACE"," ",352],["T_FUNCTION","function",352],["T_WHITESPACE"," ",352],["T_STRING","getResponse",352],"(",")",["T_WHITESPACE","\n    ",352],"{",["T_WHITESPACE","\n        ",353],["T_RETURN","return",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","_response",354],";",["T_WHITESPACE","\n    ",354],"}",["T_WHITESPACE","\n\n    ",355],["T_DOC_COMMENT","\/**\n     * Authenticate\n     *\n     * @throws Zend_Auth_Adapter_Exception\n     * @return Zend_Auth_Result\n     *\/",357],["T_WHITESPACE","\n    ",362],["T_PUBLIC","public",363],["T_WHITESPACE"," ",363],["T_FUNCTION","function",363],["T_WHITESPACE"," ",363],["T_STRING","authenticate",363],"(",")",["T_WHITESPACE","\n    ",363],"{",["T_WHITESPACE","\n        ",364],["T_IF","if",365],["T_WHITESPACE"," ",365],"(",["T_EMPTY","empty",365],"(",["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","_request",365],")",["T_WHITESPACE"," ",365],["T_BOOLEAN_OR","||",365],["T_WHITESPACE","\n            ",365],["T_EMPTY","empty",366],"(",["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","_response",366],")",")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",367],["T_WHITESPACE","\n            ",369],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",370],["T_WHITESPACE","            ",371],["T_THROW","throw",371],["T_WHITESPACE"," ",371],["T_NEW","new",371],["T_WHITESPACE"," ",371],["T_STRING","Zend_Auth_Adapter_Exception",371],"(",["T_CONSTANT_ENCAPSED_STRING","'Request and Response objects must be set before calling '",371],["T_WHITESPACE","\n                                                ",371],".",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'authenticate()'",372],")",";",["T_WHITESPACE","\n        ",372],"}",["T_WHITESPACE","\n\n        ",373],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_imaProxy",375],")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_VARIABLE","$getHeader",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_CONSTANT_ENCAPSED_STRING","'Proxy-Authorization'",376],";",["T_WHITESPACE","\n        ",376],"}",["T_WHITESPACE"," ",377],["T_ELSE","else",377],["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n            ",377],["T_VARIABLE","$getHeader",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'Authorization'",378],";",["T_WHITESPACE","\n        ",378],"}",["T_WHITESPACE","\n\n        ",379],["T_VARIABLE","$authHeader",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_request",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getHeader",381],"(",["T_VARIABLE","$getHeader",381],")",";",["T_WHITESPACE","\n        ",381],["T_IF","if",382],["T_WHITESPACE"," ",382],"(","!",["T_VARIABLE","$authHeader",382],")",["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n            ",382],["T_RETURN","return",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_challengeClient",383],"(",")",";",["T_WHITESPACE","\n        ",383],"}",["T_WHITESPACE","\n\n        ",384],["T_LIST","list",386],"(",["T_VARIABLE","$clientScheme",386],")",["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","explode",386],"(",["T_CONSTANT_ENCAPSED_STRING","' '",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$authHeader",386],")",";",["T_WHITESPACE","\n        ",386],["T_VARIABLE","$clientScheme",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_STRING","strtolower",387],"(",["T_VARIABLE","$clientScheme",387],")",";",["T_WHITESPACE","\n\n        ",387],["T_COMMENT","\/\/ The server can issue multiple challenges, but the client should\n",389],["T_WHITESPACE","        ",390],["T_COMMENT","\/\/ answer with only the selected auth scheme.\n",390],["T_WHITESPACE","        ",391],["T_IF","if",391],["T_WHITESPACE"," ",391],"(","!",["T_STRING","in_array",391],"(",["T_VARIABLE","$clientScheme",391],",",["T_WHITESPACE"," ",391],["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","_supportedSchemes",391],")",")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n            ",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_response",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","setHttpResponseCode",392],"(",["T_LNUMBER","400",392],")",";",["T_WHITESPACE","\n            ",392],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_NEW","new",393],["T_WHITESPACE"," ",393],["T_STRING","Zend_Auth_Result",393],"(",["T_WHITESPACE","\n                ",393],["T_STRING","Zend_Auth_Result",394],["T_DOUBLE_COLON","::",394],["T_STRING","FAILURE_UNCATEGORIZED",394],",",["T_WHITESPACE","\n                ",394],["T_ARRAY","array",395],"(",")",",",["T_WHITESPACE","\n                ",395],["T_ARRAY","array",396],"(",["T_CONSTANT_ENCAPSED_STRING","'Client requested an incorrect or unsupported authentication scheme'",396],")",["T_WHITESPACE","\n            ",396],")",";",["T_WHITESPACE","\n        ",397],"}",["T_WHITESPACE","\n\n        ",398],["T_COMMENT","\/\/ client sent a scheme that is not the one required\n",400],["T_WHITESPACE","        ",401],["T_IF","if",401],["T_WHITESPACE"," ",401],"(","!",["T_STRING","in_array",401],"(",["T_VARIABLE","$clientScheme",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_acceptSchemes",401],")",")",["T_WHITESPACE"," ",401],"{",["T_WHITESPACE","\n            ",401],["T_COMMENT","\/\/ challenge again the client\n",402],["T_WHITESPACE","            ",403],["T_RETURN","return",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","_challengeClient",403],"(",")",";",["T_WHITESPACE","\n        ",403],"}",["T_WHITESPACE","\n\n        ",404],["T_SWITCH","switch",406],["T_WHITESPACE"," ",406],"(",["T_VARIABLE","$clientScheme",406],")",["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n            ",406],["T_CASE","case",407],["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","'basic'",407],":",["T_WHITESPACE","\n                ",407],["T_VARIABLE","$result",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_basicAuth",408],"(",["T_VARIABLE","$authHeader",408],")",";",["T_WHITESPACE","\n                ",408],["T_BREAK","break",409],";",["T_WHITESPACE","\n            ",409],["T_CASE","case",410],["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","'digest'",410],":",["T_WHITESPACE","\n                ",410],["T_VARIABLE","$result",411],["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","_digestAuth",411],"(",["T_VARIABLE","$authHeader",411],")",";",["T_WHITESPACE","\n            ",411],["T_BREAK","break",412],";",["T_WHITESPACE","\n            ",412],["T_DEFAULT","default",413],":",["T_WHITESPACE","\n                ",413],["T_DOC_COMMENT","\/**\n                 * @see Zend_Auth_Adapter_Exception\n                 *\/",414],["T_WHITESPACE","\n                ",416],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",417],["T_WHITESPACE","                ",418],["T_THROW","throw",418],["T_WHITESPACE"," ",418],["T_NEW","new",418],["T_WHITESPACE"," ",418],["T_STRING","Zend_Auth_Adapter_Exception",418],"(",["T_CONSTANT_ENCAPSED_STRING","'Unsupported authentication scheme'",418],")",";",["T_WHITESPACE","\n        ",418],"}",["T_WHITESPACE","\n\n        ",419],["T_RETURN","return",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$result",421],";",["T_WHITESPACE","\n    ",421],"}",["T_WHITESPACE","\n\n    ",422],["T_DOC_COMMENT","\/**\n     * Challenge Client\n     *\n     * Sets a 401 or 407 Unauthorized response code, and creates the\n     * appropriate Authenticate header(s) to prompt for credentials.\n     *\n     * @return Zend_Auth_Result Always returns a non-identity Auth result\n     *\/",424],["T_WHITESPACE","\n    ",431],["T_PROTECTED","protected",432],["T_WHITESPACE"," ",432],["T_FUNCTION","function",432],["T_WHITESPACE"," ",432],["T_STRING","_challengeClient",432],"(",")",["T_WHITESPACE","\n    ",432],"{",["T_WHITESPACE","\n        ",433],["T_IF","if",434],["T_WHITESPACE"," ",434],"(",["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","_imaProxy",434],")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n            ",434],["T_VARIABLE","$statusCode",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_LNUMBER","407",435],";",["T_WHITESPACE","\n            ",435],["T_VARIABLE","$headerName",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","'Proxy-Authenticate'",436],";",["T_WHITESPACE","\n        ",436],"}",["T_WHITESPACE"," ",437],["T_ELSE","else",437],["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n            ",437],["T_VARIABLE","$statusCode",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_LNUMBER","401",438],";",["T_WHITESPACE","\n            ",438],["T_VARIABLE","$headerName",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate'",439],";",["T_WHITESPACE","\n        ",439],"}",["T_WHITESPACE","\n\n        ",440],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","_response",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","setHttpResponseCode",442],"(",["T_VARIABLE","$statusCode",442],")",";",["T_WHITESPACE","\n\n        ",442],["T_COMMENT","\/\/ Send a challenge in each acceptable authentication scheme\n",444],["T_WHITESPACE","        ",445],["T_IF","if",445],["T_WHITESPACE"," ",445],"(",["T_STRING","in_array",445],"(",["T_CONSTANT_ENCAPSED_STRING","'basic'",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","_acceptSchemes",445],")",")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n            ",445],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_response",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","setHeader",446],"(",["T_VARIABLE","$headerName",446],",",["T_WHITESPACE"," ",446],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_basicHeader",446],"(",")",")",";",["T_WHITESPACE","\n        ",446],"}",["T_WHITESPACE","\n        ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_STRING","in_array",448],"(",["T_CONSTANT_ENCAPSED_STRING","'digest'",448],",",["T_WHITESPACE"," ",448],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","_acceptSchemes",448],")",")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n            ",448],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","_response",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","setHeader",449],"(",["T_VARIABLE","$headerName",449],",",["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","_digestHeader",449],"(",")",")",";",["T_WHITESPACE","\n        ",449],"}",["T_WHITESPACE","\n        ",450],["T_RETURN","return",451],["T_WHITESPACE"," ",451],["T_NEW","new",451],["T_WHITESPACE"," ",451],["T_STRING","Zend_Auth_Result",451],"(",["T_WHITESPACE","\n            ",451],["T_STRING","Zend_Auth_Result",452],["T_DOUBLE_COLON","::",452],["T_STRING","FAILURE_CREDENTIAL_INVALID",452],",",["T_WHITESPACE","\n            ",452],["T_ARRAY","array",453],"(",")",",",["T_WHITESPACE","\n            ",453],["T_ARRAY","array",454],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid or absent credentials; challenging client'",454],")",["T_WHITESPACE","\n        ",454],")",";",["T_WHITESPACE","\n    ",455],"}",["T_WHITESPACE","\n\n    ",456],["T_DOC_COMMENT","\/**\n     * Basic Header\n     *\n     * Generates a Proxy- or WWW-Authenticate header value in the Basic\n     * authentication scheme.\n     *\n     * @return string Authenticate header value\n     *\/",458],["T_WHITESPACE","\n    ",465],["T_PROTECTED","protected",466],["T_WHITESPACE"," ",466],["T_FUNCTION","function",466],["T_WHITESPACE"," ",466],["T_STRING","_basicHeader",466],"(",")",["T_WHITESPACE","\n    ",466],"{",["T_WHITESPACE","\n        ",467],["T_RETURN","return",468],["T_WHITESPACE"," ",468],["T_CONSTANT_ENCAPSED_STRING","'Basic realm=\"'",468],["T_WHITESPACE"," ",468],".",["T_WHITESPACE"," ",468],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_realm",468],["T_WHITESPACE"," ",468],".",["T_WHITESPACE"," ",468],["T_CONSTANT_ENCAPSED_STRING","'\"'",468],";",["T_WHITESPACE","\n    ",468],"}",["T_WHITESPACE","\n\n    ",469],["T_DOC_COMMENT","\/**\n     * Digest Header\n     *\n     * Generates a Proxy- or WWW-Authenticate header value in the Digest\n     * authentication scheme.\n     *\n     * @return string Authenticate header value\n     *\/",471],["T_WHITESPACE","\n    ",478],["T_PROTECTED","protected",479],["T_WHITESPACE"," ",479],["T_FUNCTION","function",479],["T_WHITESPACE"," ",479],["T_STRING","_digestHeader",479],"(",")",["T_WHITESPACE","\n    ",479],"{",["T_WHITESPACE","\n        ",480],["T_VARIABLE","$wwwauth",481],["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_CONSTANT_ENCAPSED_STRING","'Digest realm=\"'",481],["T_WHITESPACE"," ",481],".",["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","_realm",481],["T_WHITESPACE"," ",481],".",["T_WHITESPACE"," ",481],["T_CONSTANT_ENCAPSED_STRING","'\", '",481],["T_WHITESPACE","\n                 ",481],".",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'domain=\"'",482],["T_WHITESPACE"," ",482],".",["T_WHITESPACE"," ",482],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_domains",482],["T_WHITESPACE"," ",482],".",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'\", '",482],["T_WHITESPACE","\n                 ",482],".",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"'",483],["T_WHITESPACE"," ",483],".",["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","_calcNonce",483],"(",")",["T_WHITESPACE"," ",483],".",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'\", '",483],["T_WHITESPACE","\n                 ",483],".",["T_WHITESPACE"," ",484],"(",["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","_useOpaque",484],["T_WHITESPACE"," ",484],"?",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'opaque=\"'",484],["T_WHITESPACE"," ",484],".",["T_WHITESPACE"," ",484],["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","_calcOpaque",484],"(",")",["T_WHITESPACE"," ",484],".",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'\", '",484],["T_WHITESPACE"," ",484],":",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","''",484],")",["T_WHITESPACE","\n                 ",484],".",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","'algorithm=\"'",485],["T_WHITESPACE"," ",485],".",["T_WHITESPACE"," ",485],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","_algo",485],["T_WHITESPACE"," ",485],".",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","'\", '",485],["T_WHITESPACE","\n                 ",485],".",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'qop=\"'",486],["T_WHITESPACE"," ",486],".",["T_WHITESPACE"," ",486],["T_STRING","implode",486],"(",["T_CONSTANT_ENCAPSED_STRING","','",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","_supportedQops",486],")",["T_WHITESPACE"," ",486],".",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'\"'",486],";",["T_WHITESPACE","\n\n        ",486],["T_RETURN","return",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$wwwauth",488],";",["T_WHITESPACE","\n    ",488],"}",["T_WHITESPACE","\n\n    ",489],["T_DOC_COMMENT","\/**\n     * Basic Authentication\n     *\n     * @param  string $header Client's Authorization header\n     * @throws Zend_Auth_Adapter_Exception\n     * @return Zend_Auth_Result\n     *\/",491],["T_WHITESPACE","\n    ",497],["T_PROTECTED","protected",498],["T_WHITESPACE"," ",498],["T_FUNCTION","function",498],["T_WHITESPACE"," ",498],["T_STRING","_basicAuth",498],"(",["T_VARIABLE","$header",498],")",["T_WHITESPACE","\n    ",498],"{",["T_WHITESPACE","\n        ",499],["T_IF","if",500],["T_WHITESPACE"," ",500],"(",["T_EMPTY","empty",500],"(",["T_VARIABLE","$header",500],")",")",["T_WHITESPACE"," ",500],"{",["T_WHITESPACE","\n            ",500],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",501],["T_WHITESPACE","\n            ",503],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",504],["T_WHITESPACE","            ",505],["T_THROW","throw",505],["T_WHITESPACE"," ",505],["T_NEW","new",505],["T_WHITESPACE"," ",505],["T_STRING","Zend_Auth_Adapter_Exception",505],"(",["T_CONSTANT_ENCAPSED_STRING","'The value of the client Authorization header is required'",505],")",";",["T_WHITESPACE","\n        ",505],"}",["T_WHITESPACE","\n        ",506],["T_IF","if",507],["T_WHITESPACE"," ",507],"(",["T_EMPTY","empty",507],"(",["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","_basicResolver",507],")",")",["T_WHITESPACE"," ",507],"{",["T_WHITESPACE","\n            ",507],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",508],["T_WHITESPACE","\n            ",510],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",511],["T_WHITESPACE","            ",512],["T_THROW","throw",512],["T_WHITESPACE"," ",512],["T_NEW","new",512],["T_WHITESPACE"," ",512],["T_STRING","Zend_Auth_Adapter_Exception",512],"(",["T_CONSTANT_ENCAPSED_STRING","'A basicResolver object must be set before doing Basic '",512],["T_WHITESPACE","\n                                                ",512],".",["T_WHITESPACE"," ",513],["T_CONSTANT_ENCAPSED_STRING","'authentication'",513],")",";",["T_WHITESPACE","\n        ",513],"}",["T_WHITESPACE","\n\n        ",514],["T_COMMENT","\/\/ Decode the Authorization header\n",516],["T_WHITESPACE","        ",517],["T_VARIABLE","$auth",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],["T_STRING","substr",517],"(",["T_VARIABLE","$header",517],",",["T_WHITESPACE"," ",517],["T_STRING","strlen",517],"(",["T_CONSTANT_ENCAPSED_STRING","'Basic '",517],")",")",";",["T_WHITESPACE","\n        ",517],["T_VARIABLE","$auth",518],["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],["T_STRING","base64_decode",518],"(",["T_VARIABLE","$auth",518],")",";",["T_WHITESPACE","\n        ",518],["T_IF","if",519],["T_WHITESPACE"," ",519],"(","!",["T_VARIABLE","$auth",519],")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n            ",519],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",520],["T_WHITESPACE","\n            ",522],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",523],["T_WHITESPACE","            ",524],["T_THROW","throw",524],["T_WHITESPACE"," ",524],["T_NEW","new",524],["T_WHITESPACE"," ",524],["T_STRING","Zend_Auth_Adapter_Exception",524],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to base64_decode Authorization header value'",524],")",";",["T_WHITESPACE","\n        ",524],"}",["T_WHITESPACE","\n\n        ",525],["T_COMMENT","\/\/ See ZF-1253. Validate the credentials the same way the digest\n",527],["T_WHITESPACE","        ",528],["T_COMMENT","\/\/ implementation does. If invalid credentials are detected,\n",528],["T_WHITESPACE","        ",529],["T_COMMENT","\/\/ re-challenge the client.\n",529],["T_WHITESPACE","        ",530],["T_IF","if",530],["T_WHITESPACE"," ",530],"(","!",["T_STRING","ctype_print",530],"(",["T_VARIABLE","$auth",530],")",")",["T_WHITESPACE"," ",530],"{",["T_WHITESPACE","\n            ",530],["T_RETURN","return",531],["T_WHITESPACE"," ",531],["T_VARIABLE","$this",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","_challengeClient",531],"(",")",";",["T_WHITESPACE","\n        ",531],"}",["T_WHITESPACE","\n        ",532],["T_COMMENT","\/\/ Fix for ZF-1515: Now re-challenges on empty username or password\n",533],["T_WHITESPACE","        ",534],["T_VARIABLE","$creds",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_STRING","array_filter",534],"(",["T_STRING","explode",534],"(",["T_CONSTANT_ENCAPSED_STRING","':'",534],",",["T_WHITESPACE"," ",534],["T_VARIABLE","$auth",534],")",")",";",["T_WHITESPACE","\n        ",534],["T_IF","if",535],["T_WHITESPACE"," ",535],"(",["T_STRING","count",535],"(",["T_VARIABLE","$creds",535],")",["T_WHITESPACE"," ",535],["T_IS_NOT_EQUAL","!=",535],["T_WHITESPACE"," ",535],["T_LNUMBER","2",535],")",["T_WHITESPACE"," ",535],"{",["T_WHITESPACE","\n            ",535],["T_RETURN","return",536],["T_WHITESPACE"," ",536],["T_VARIABLE","$this",536],["T_OBJECT_OPERATOR","->",536],["T_STRING","_challengeClient",536],"(",")",";",["T_WHITESPACE","\n        ",536],"}",["T_WHITESPACE","\n\n        ",537],["T_VARIABLE","$password",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_basicResolver",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","resolve",539],"(",["T_VARIABLE","$creds",539],"[",["T_LNUMBER","0",539],"]",",",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_realm",539],")",";",["T_WHITESPACE","\n        ",539],["T_IF","if",540],["T_WHITESPACE"," ",540],"(",["T_VARIABLE","$password",540],["T_WHITESPACE"," ",540],["T_BOOLEAN_AND","&&",540],["T_WHITESPACE"," ",540],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","_secureStringCompare",540],"(",["T_VARIABLE","$password",540],",",["T_WHITESPACE"," ",540],["T_VARIABLE","$creds",540],"[",["T_LNUMBER","1",540],"]",")",")",["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n            ",540],["T_VARIABLE","$identity",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_ARRAY","array",541],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",541],["T_DOUBLE_ARROW","=>",541],["T_VARIABLE","$creds",541],"[",["T_LNUMBER","0",541],"]",",",["T_WHITESPACE"," ",541],["T_CONSTANT_ENCAPSED_STRING","'realm'",541],["T_DOUBLE_ARROW","=>",541],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","_realm",541],")",";",["T_WHITESPACE","\n            ",541],["T_RETURN","return",542],["T_WHITESPACE"," ",542],["T_NEW","new",542],["T_WHITESPACE"," ",542],["T_STRING","Zend_Auth_Result",542],"(",["T_STRING","Zend_Auth_Result",542],["T_DOUBLE_COLON","::",542],["T_STRING","SUCCESS",542],",",["T_WHITESPACE"," ",542],["T_VARIABLE","$identity",542],")",";",["T_WHITESPACE","\n        ",542],"}",["T_WHITESPACE"," ",543],["T_ELSE","else",543],["T_WHITESPACE"," ",543],"{",["T_WHITESPACE","\n            ",543],["T_RETURN","return",544],["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","_challengeClient",544],"(",")",";",["T_WHITESPACE","\n        ",544],"}",["T_WHITESPACE","\n    ",545],"}",["T_WHITESPACE","\n\n    ",546],["T_DOC_COMMENT","\/**\n     * Digest Authentication\n     *\n     * @param  string $header Client's Authorization header\n     * @throws Zend_Auth_Adapter_Exception\n     * @return Zend_Auth_Result Valid auth result only on successful auth\n     *\/",548],["T_WHITESPACE","\n    ",554],["T_PROTECTED","protected",555],["T_WHITESPACE"," ",555],["T_FUNCTION","function",555],["T_WHITESPACE"," ",555],["T_STRING","_digestAuth",555],"(",["T_VARIABLE","$header",555],")",["T_WHITESPACE","\n    ",555],"{",["T_WHITESPACE","\n        ",556],["T_IF","if",557],["T_WHITESPACE"," ",557],"(",["T_EMPTY","empty",557],"(",["T_VARIABLE","$header",557],")",")",["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n            ",557],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",558],["T_WHITESPACE","\n            ",560],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",561],["T_WHITESPACE","            ",562],["T_THROW","throw",562],["T_WHITESPACE"," ",562],["T_NEW","new",562],["T_WHITESPACE"," ",562],["T_STRING","Zend_Auth_Adapter_Exception",562],"(",["T_CONSTANT_ENCAPSED_STRING","'The value of the client Authorization header is required'",562],")",";",["T_WHITESPACE","\n        ",562],"}",["T_WHITESPACE","\n        ",563],["T_IF","if",564],["T_WHITESPACE"," ",564],"(",["T_EMPTY","empty",564],"(",["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","_digestResolver",564],")",")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n            ",564],["T_DOC_COMMENT","\/**\n             * @see Zend_Auth_Adapter_Exception\n             *\/",565],["T_WHITESPACE","\n            ",567],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",568],["T_WHITESPACE","            ",569],["T_THROW","throw",569],["T_WHITESPACE"," ",569],["T_NEW","new",569],["T_WHITESPACE"," ",569],["T_STRING","Zend_Auth_Adapter_Exception",569],"(",["T_CONSTANT_ENCAPSED_STRING","'A digestResolver object must be set before doing Digest authentication'",569],")",";",["T_WHITESPACE","\n        ",569],"}",["T_WHITESPACE","\n\n        ",570],["T_VARIABLE","$data",572],["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","_parseDigestAuth",572],"(",["T_VARIABLE","$header",572],")",";",["T_WHITESPACE","\n        ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(",["T_VARIABLE","$data",573],["T_WHITESPACE"," ",573],["T_IS_IDENTICAL","===",573],["T_WHITESPACE"," ",573],["T_STRING","false",573],")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_response",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","setHttpResponseCode",574],"(",["T_LNUMBER","400",574],")",";",["T_WHITESPACE","\n            ",574],["T_RETURN","return",575],["T_WHITESPACE"," ",575],["T_NEW","new",575],["T_WHITESPACE"," ",575],["T_STRING","Zend_Auth_Result",575],"(",["T_WHITESPACE","\n                ",575],["T_STRING","Zend_Auth_Result",576],["T_DOUBLE_COLON","::",576],["T_STRING","FAILURE_UNCATEGORIZED",576],",",["T_WHITESPACE","\n                ",576],["T_ARRAY","array",577],"(",")",",",["T_WHITESPACE","\n                ",577],["T_ARRAY","array",578],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid Authorization header format'",578],")",["T_WHITESPACE","\n            ",578],")",";",["T_WHITESPACE","\n        ",579],"}",["T_WHITESPACE","\n\n        ",580],["T_COMMENT","\/\/ See ZF-1052. This code was a bit too unforgiving of invalid\n",582],["T_WHITESPACE","        ",583],["T_COMMENT","\/\/ usernames. Now, if the username is bad, we re-challenge the client.\n",583],["T_WHITESPACE","        ",584],["T_IF","if",584],["T_WHITESPACE"," ",584],"(",["T_CONSTANT_ENCAPSED_STRING","'::invalid::'",584],["T_WHITESPACE"," ",584],["T_IS_EQUAL","==",584],["T_WHITESPACE"," ",584],["T_VARIABLE","$data",584],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",584],"]",")",["T_WHITESPACE"," ",584],"{",["T_WHITESPACE","\n            ",584],["T_RETURN","return",585],["T_WHITESPACE"," ",585],["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","_challengeClient",585],"(",")",";",["T_WHITESPACE","\n        ",585],"}",["T_WHITESPACE","\n\n        ",586],["T_COMMENT","\/\/ Verify that the client sent back the same nonce\n",588],["T_WHITESPACE","        ",589],["T_IF","if",589],["T_WHITESPACE"," ",589],"(",["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","_calcNonce",589],"(",")",["T_WHITESPACE"," ",589],["T_IS_NOT_EQUAL","!=",589],["T_WHITESPACE"," ",589],["T_VARIABLE","$data",589],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",589],"]",")",["T_WHITESPACE"," ",589],"{",["T_WHITESPACE","\n            ",589],["T_RETURN","return",590],["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","_challengeClient",590],"(",")",";",["T_WHITESPACE","\n        ",590],"}",["T_WHITESPACE","\n        ",591],["T_COMMENT","\/\/ The opaque value is also required to match, but of course IE doesn't\n",592],["T_WHITESPACE","        ",593],["T_COMMENT","\/\/ play ball.\n",593],["T_WHITESPACE","        ",594],["T_IF","if",594],["T_WHITESPACE"," ",594],"(","!",["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","_ieNoOpaque",594],["T_WHITESPACE"," ",594],["T_BOOLEAN_AND","&&",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","_calcOpaque",594],"(",")",["T_WHITESPACE"," ",594],["T_IS_NOT_EQUAL","!=",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$data",594],"[",["T_CONSTANT_ENCAPSED_STRING","'opaque'",594],"]",")",["T_WHITESPACE"," ",594],"{",["T_WHITESPACE","\n            ",594],["T_RETURN","return",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$this",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","_challengeClient",595],"(",")",";",["T_WHITESPACE","\n        ",595],"}",["T_WHITESPACE","\n\n        ",596],["T_COMMENT","\/\/ Look up the user's password hash. If not found, deny access.\n",598],["T_WHITESPACE","        ",599],["T_COMMENT","\/\/ This makes no assumptions about how the password hash was\n",599],["T_WHITESPACE","        ",600],["T_COMMENT","\/\/ constructed beyond that it must have been built in such a way as\n",600],["T_WHITESPACE","        ",601],["T_COMMENT","\/\/ to be recreatable with the current settings of this object.\n",601],["T_WHITESPACE","        ",602],["T_VARIABLE","$ha1",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","_digestResolver",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","resolve",602],"(",["T_VARIABLE","$data",602],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",602],"]",",",["T_WHITESPACE"," ",602],["T_VARIABLE","$data",602],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",602],"]",")",";",["T_WHITESPACE","\n        ",602],["T_IF","if",603],["T_WHITESPACE"," ",603],"(",["T_VARIABLE","$ha1",603],["T_WHITESPACE"," ",603],["T_IS_IDENTICAL","===",603],["T_WHITESPACE"," ",603],["T_STRING","false",603],")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n            ",603],["T_RETURN","return",604],["T_WHITESPACE"," ",604],["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","_challengeClient",604],"(",")",";",["T_WHITESPACE","\n        ",604],"}",["T_WHITESPACE","\n\n        ",605],["T_COMMENT","\/\/ If MD5-sess is used, a1 value is made of the user's password\n",607],["T_WHITESPACE","        ",608],["T_COMMENT","\/\/ hash with the server and client nonce appended, separated by\n",608],["T_WHITESPACE","        ",609],["T_COMMENT","\/\/ colons.\n",609],["T_WHITESPACE","        ",610],["T_IF","if",610],["T_WHITESPACE"," ",610],"(",["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","_algo",610],["T_WHITESPACE"," ",610],["T_IS_EQUAL","==",610],["T_WHITESPACE"," ",610],["T_CONSTANT_ENCAPSED_STRING","'MD5-sess'",610],")",["T_WHITESPACE"," ",610],"{",["T_WHITESPACE","\n            ",610],["T_VARIABLE","$ha1",611],["T_WHITESPACE"," ",611],"=",["T_WHITESPACE"," ",611],["T_STRING","hash",611],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",611],",",["T_WHITESPACE"," ",611],["T_VARIABLE","$ha1",611],["T_WHITESPACE"," ",611],".",["T_WHITESPACE"," ",611],["T_CONSTANT_ENCAPSED_STRING","':'",611],["T_WHITESPACE"," ",611],".",["T_WHITESPACE"," ",611],["T_VARIABLE","$data",611],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",611],"]",["T_WHITESPACE"," ",611],".",["T_WHITESPACE"," ",611],["T_CONSTANT_ENCAPSED_STRING","':'",611],["T_WHITESPACE"," ",611],".",["T_WHITESPACE"," ",611],["T_VARIABLE","$data",611],"[",["T_CONSTANT_ENCAPSED_STRING","'cnonce'",611],"]",")",";",["T_WHITESPACE","\n        ",611],"}",["T_WHITESPACE","\n\n        ",612],["T_COMMENT","\/\/ Calculate h(a2). The value of this hash depends on the qop\n",614],["T_WHITESPACE","        ",615],["T_COMMENT","\/\/ option selected by the client and the supported hash functions\n",615],["T_WHITESPACE","        ",616],["T_SWITCH","switch",616],["T_WHITESPACE"," ",616],"(",["T_VARIABLE","$data",616],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",616],"]",")",["T_WHITESPACE"," ",616],"{",["T_WHITESPACE","\n            ",616],["T_CASE","case",617],["T_WHITESPACE"," ",617],["T_CONSTANT_ENCAPSED_STRING","'auth'",617],":",["T_WHITESPACE","\n                ",617],["T_VARIABLE","$a2",618],["T_WHITESPACE"," ",618],"=",["T_WHITESPACE"," ",618],["T_VARIABLE","$this",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","_request",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getMethod",618],"(",")",["T_WHITESPACE"," ",618],".",["T_WHITESPACE"," ",618],["T_CONSTANT_ENCAPSED_STRING","':'",618],["T_WHITESPACE"," ",618],".",["T_WHITESPACE"," ",618],["T_VARIABLE","$data",618],"[",["T_CONSTANT_ENCAPSED_STRING","'uri'",618],"]",";",["T_WHITESPACE","\n                ",618],["T_BREAK","break",619],";",["T_WHITESPACE","\n            ",619],["T_CASE","case",620],["T_WHITESPACE"," ",620],["T_CONSTANT_ENCAPSED_STRING","'auth-int'",620],":",["T_WHITESPACE","\n                ",620],["T_COMMENT","\/\/ Should be REQUEST_METHOD . ':' . uri . ':' . hash(entity-body),\n",621],["T_WHITESPACE","                ",622],["T_COMMENT","\/\/ but this isn't supported yet, so fall through to default case\n",622],["T_WHITESPACE","            ",623],["T_DEFAULT","default",623],":",["T_WHITESPACE","\n                ",623],["T_DOC_COMMENT","\/**\n                 * @see Zend_Auth_Adapter_Exception\n                 *\/",624],["T_WHITESPACE","\n                ",626],["T_COMMENT","#require_once 'Zend\/Auth\/Adapter\/Exception.php';\n",627],["T_WHITESPACE","                ",628],["T_THROW","throw",628],["T_WHITESPACE"," ",628],["T_NEW","new",628],["T_WHITESPACE"," ",628],["T_STRING","Zend_Auth_Adapter_Exception",628],"(",["T_CONSTANT_ENCAPSED_STRING","'Client requested an unsupported qop option'",628],")",";",["T_WHITESPACE","\n        ",628],"}",["T_WHITESPACE","\n        ",629],["T_COMMENT","\/\/ Using hash() should make parameterizing the hash algorithm\n",630],["T_WHITESPACE","        ",631],["T_COMMENT","\/\/ easier\n",631],["T_WHITESPACE","        ",632],["T_VARIABLE","$ha2",632],["T_WHITESPACE"," ",632],"=",["T_WHITESPACE"," ",632],["T_STRING","hash",632],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",632],",",["T_WHITESPACE"," ",632],["T_VARIABLE","$a2",632],")",";",["T_WHITESPACE","\n\n\n        ",632],["T_COMMENT","\/\/ Calculate the server's version of the request-digest. This must\n",635],["T_WHITESPACE","        ",636],["T_COMMENT","\/\/ match $data['response']. See RFC 2617, section 3.2.2.1\n",636],["T_WHITESPACE","        ",637],["T_VARIABLE","$message",637],["T_WHITESPACE"," ",637],"=",["T_WHITESPACE"," ",637],["T_VARIABLE","$data",637],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",637],"]",["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","':'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$data",637],"[",["T_CONSTANT_ENCAPSED_STRING","'nc'",637],"]",["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","':'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$data",637],"[",["T_CONSTANT_ENCAPSED_STRING","'cnonce'",637],"]",["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","':'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$data",637],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",637],"]",["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","':'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$ha2",637],";",["T_WHITESPACE","\n        ",637],["T_VARIABLE","$digest",638],["T_WHITESPACE","  ",638],"=",["T_WHITESPACE"," ",638],["T_STRING","hash",638],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",638],",",["T_WHITESPACE"," ",638],["T_VARIABLE","$ha1",638],["T_WHITESPACE"," ",638],".",["T_WHITESPACE"," ",638],["T_CONSTANT_ENCAPSED_STRING","':'",638],["T_WHITESPACE"," ",638],".",["T_WHITESPACE"," ",638],["T_VARIABLE","$message",638],")",";",["T_WHITESPACE","\n\n        ",638],["T_COMMENT","\/\/ If our digest matches the client's let them in, otherwise return\n",640],["T_WHITESPACE","        ",641],["T_COMMENT","\/\/ a 401 code and exit to prevent access to the protected resource.\n",641],["T_WHITESPACE","        ",642],["T_IF","if",642],["T_WHITESPACE"," ",642],"(",["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","_secureStringCompare",642],"(",["T_VARIABLE","$digest",642],",",["T_WHITESPACE"," ",642],["T_VARIABLE","$data",642],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",642],"]",")",")",["T_WHITESPACE"," ",642],"{",["T_WHITESPACE","\n            ",642],["T_VARIABLE","$identity",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_ARRAY","array",643],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",643],["T_DOUBLE_ARROW","=>",643],["T_VARIABLE","$data",643],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",643],"]",",",["T_WHITESPACE"," ",643],["T_CONSTANT_ENCAPSED_STRING","'realm'",643],["T_DOUBLE_ARROW","=>",643],["T_VARIABLE","$data",643],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",643],"]",")",";",["T_WHITESPACE","\n            ",643],["T_RETURN","return",644],["T_WHITESPACE"," ",644],["T_NEW","new",644],["T_WHITESPACE"," ",644],["T_STRING","Zend_Auth_Result",644],"(",["T_STRING","Zend_Auth_Result",644],["T_DOUBLE_COLON","::",644],["T_STRING","SUCCESS",644],",",["T_WHITESPACE"," ",644],["T_VARIABLE","$identity",644],")",";",["T_WHITESPACE","\n        ",644],"}",["T_WHITESPACE"," ",645],["T_ELSE","else",645],["T_WHITESPACE"," ",645],"{",["T_WHITESPACE","\n            ",645],["T_RETURN","return",646],["T_WHITESPACE"," ",646],["T_VARIABLE","$this",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","_challengeClient",646],"(",")",";",["T_WHITESPACE","\n        ",646],"}",["T_WHITESPACE","\n    ",647],"}",["T_WHITESPACE","\n\n    ",648],["T_DOC_COMMENT","\/**\n     * Calculate Nonce\n     *\n     * @return string The nonce value\n     *\/",650],["T_WHITESPACE","\n    ",654],["T_PROTECTED","protected",655],["T_WHITESPACE"," ",655],["T_FUNCTION","function",655],["T_WHITESPACE"," ",655],["T_STRING","_calcNonce",655],"(",")",["T_WHITESPACE","\n    ",655],"{",["T_WHITESPACE","\n        ",656],["T_COMMENT","\/\/ Once subtle consequence of this timeout calculation is that it\n",657],["T_WHITESPACE","        ",658],["T_COMMENT","\/\/ actually divides all of time into _nonceTimeout-sized sections, such\n",658],["T_WHITESPACE","        ",659],["T_COMMENT","\/\/ that the value of timeout is the point in time of the next\n",659],["T_WHITESPACE","        ",660],["T_COMMENT","\/\/ approaching \"boundary\" of a section. This allows the server to\n",660],["T_WHITESPACE","        ",661],["T_COMMENT","\/\/ consistently generate the same timeout (and hence the same nonce\n",661],["T_WHITESPACE","        ",662],["T_COMMENT","\/\/ value) across requests, but only as long as one of those\n",662],["T_WHITESPACE","        ",663],["T_COMMENT","\/\/ \"boundaries\" is not crossed between requests. If that happens, the\n",663],["T_WHITESPACE","        ",664],["T_COMMENT","\/\/ nonce will change on its own, and effectively log the user out. This\n",664],["T_WHITESPACE","        ",665],["T_COMMENT","\/\/ would be surprising if the user just logged in.\n",665],["T_WHITESPACE","        ",666],["T_VARIABLE","$timeout",666],["T_WHITESPACE"," ",666],"=",["T_WHITESPACE"," ",666],["T_STRING","ceil",666],"(",["T_STRING","time",666],"(",")",["T_WHITESPACE"," ",666],"\/",["T_WHITESPACE"," ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","_nonceTimeout",666],")",["T_WHITESPACE"," ",666],"*",["T_WHITESPACE"," ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","_nonceTimeout",666],";",["T_WHITESPACE","\n\n        ",666],["T_VARIABLE","$nonce",668],["T_WHITESPACE"," ",668],"=",["T_WHITESPACE"," ",668],["T_STRING","hash",668],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",668],",",["T_WHITESPACE"," ",668],["T_VARIABLE","$timeout",668],["T_WHITESPACE"," ",668],".",["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","':'",668],["T_WHITESPACE"," ",668],".",["T_WHITESPACE"," ",668],["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","_request",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","getServer",668],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",668],")",["T_WHITESPACE"," ",668],".",["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","':'",668],["T_WHITESPACE"," ",668],".",["T_WHITESPACE"," ",668],["T_CLASS_C","__CLASS__",668],")",";",["T_WHITESPACE","\n        ",668],["T_RETURN","return",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$nonce",669],";",["T_WHITESPACE","\n    ",669],"}",["T_WHITESPACE","\n\n    ",670],["T_DOC_COMMENT","\/**\n     * Calculate Opaque\n     *\n     * The opaque string can be anything; the client must return it exactly as\n     * it was sent. It may be useful to store data in this string in some\n     * applications. Ideally, a new value for this would be generated each time\n     * a WWW-Authenticate header is sent (in order to reduce predictability),\n     * but we would have to be able to create the same exact value across at\n     * least two separate requests from the same client.\n     *\n     * @return string The opaque value\n     *\/",672],["T_WHITESPACE","\n    ",683],["T_PROTECTED","protected",684],["T_WHITESPACE"," ",684],["T_FUNCTION","function",684],["T_WHITESPACE"," ",684],["T_STRING","_calcOpaque",684],"(",")",["T_WHITESPACE","\n    ",684],"{",["T_WHITESPACE","\n        ",685],["T_RETURN","return",686],["T_WHITESPACE"," ",686],["T_STRING","hash",686],"(",["T_CONSTANT_ENCAPSED_STRING","'md5'",686],",",["T_WHITESPACE"," ",686],["T_CONSTANT_ENCAPSED_STRING","'Opaque Data:'",686],["T_WHITESPACE"," ",686],".",["T_WHITESPACE"," ",686],["T_CLASS_C","__CLASS__",686],")",";",["T_WHITESPACE","\n    ",686],"}",["T_WHITESPACE","\n\n    ",687],["T_DOC_COMMENT","\/**\n     * Parse Digest Authorization header\n     *\n     * @param  string $header Client's Authorization: HTTP header\n     * @return array|false Data elements from header, or false if any part of\n     *         the header is invalid\n     *\/",689],["T_WHITESPACE","\n    ",695],["T_PROTECTED","protected",696],["T_WHITESPACE"," ",696],["T_FUNCTION","function",696],["T_WHITESPACE"," ",696],["T_STRING","_parseDigestAuth",696],"(",["T_VARIABLE","$header",696],")",["T_WHITESPACE","\n    ",696],"{",["T_WHITESPACE","\n        ",697],["T_VARIABLE","$temp",698],["T_WHITESPACE"," ",698],"=",["T_WHITESPACE"," ",698],["T_STRING","null",698],";",["T_WHITESPACE","\n        ",698],["T_VARIABLE","$data",699],["T_WHITESPACE"," ",699],"=",["T_WHITESPACE"," ",699],["T_ARRAY","array",699],"(",")",";",["T_WHITESPACE","\n\n        ",699],["T_COMMENT","\/\/ See ZF-1052. Detect invalid usernames instead of just returning a\n",701],["T_WHITESPACE","        ",702],["T_COMMENT","\/\/ 400 code.\n",702],["T_WHITESPACE","        ",703],["T_VARIABLE","$ret",703],["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_STRING","preg_match",703],"(",["T_CONSTANT_ENCAPSED_STRING","'\/username=\"([^\"]+)\"\/'",703],",",["T_WHITESPACE"," ",703],["T_VARIABLE","$header",703],",",["T_WHITESPACE"," ",703],["T_VARIABLE","$temp",703],")",";",["T_WHITESPACE","\n        ",703],["T_IF","if",704],["T_WHITESPACE"," ",704],"(","!",["T_VARIABLE","$ret",704],["T_WHITESPACE"," ",704],["T_BOOLEAN_OR","||",704],["T_WHITESPACE"," ",704],["T_EMPTY","empty",704],"(",["T_VARIABLE","$temp",704],"[",["T_LNUMBER","1",704],"]",")",["T_WHITESPACE","\n                  ",704],["T_BOOLEAN_OR","||",705],["T_WHITESPACE"," ",705],"!",["T_STRING","ctype_print",705],"(",["T_VARIABLE","$temp",705],"[",["T_LNUMBER","1",705],"]",")",["T_WHITESPACE","\n                  ",705],["T_BOOLEAN_OR","||",706],["T_WHITESPACE"," ",706],["T_STRING","strpos",706],"(",["T_VARIABLE","$temp",706],"[",["T_LNUMBER","1",706],"]",",",["T_WHITESPACE"," ",706],["T_CONSTANT_ENCAPSED_STRING","':'",706],")",["T_WHITESPACE"," ",706],["T_IS_NOT_IDENTICAL","!==",706],["T_WHITESPACE"," ",706],["T_STRING","false",706],")",["T_WHITESPACE"," ",706],"{",["T_WHITESPACE","\n            ",706],["T_VARIABLE","$data",707],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",707],"]",["T_WHITESPACE"," ",707],"=",["T_WHITESPACE"," ",707],["T_CONSTANT_ENCAPSED_STRING","'::invalid::'",707],";",["T_WHITESPACE","\n        ",707],"}",["T_WHITESPACE"," ",708],["T_ELSE","else",708],["T_WHITESPACE"," ",708],"{",["T_WHITESPACE","\n            ",708],["T_VARIABLE","$data",709],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",709],"]",["T_WHITESPACE"," ",709],"=",["T_WHITESPACE"," ",709],["T_VARIABLE","$temp",709],"[",["T_LNUMBER","1",709],"]",";",["T_WHITESPACE","\n        ",709],"}",["T_WHITESPACE","\n        ",710],["T_VARIABLE","$temp",711],["T_WHITESPACE"," ",711],"=",["T_WHITESPACE"," ",711],["T_STRING","null",711],";",["T_WHITESPACE","\n\n        ",711],["T_VARIABLE","$ret",713],["T_WHITESPACE"," ",713],"=",["T_WHITESPACE"," ",713],["T_STRING","preg_match",713],"(",["T_CONSTANT_ENCAPSED_STRING","'\/realm=\"([^\"]+)\"\/'",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$header",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$temp",713],")",";",["T_WHITESPACE","\n        ",713],["T_IF","if",714],["T_WHITESPACE"," ",714],"(","!",["T_VARIABLE","$ret",714],["T_WHITESPACE"," ",714],["T_BOOLEAN_OR","||",714],["T_WHITESPACE"," ",714],["T_EMPTY","empty",714],"(",["T_VARIABLE","$temp",714],"[",["T_LNUMBER","1",714],"]",")",")",["T_WHITESPACE"," ",714],"{",["T_WHITESPACE","\n            ",714],["T_RETURN","return",715],["T_WHITESPACE"," ",715],["T_STRING","false",715],";",["T_WHITESPACE","\n        ",715],"}",["T_WHITESPACE","\n        ",716],["T_IF","if",717],["T_WHITESPACE"," ",717],"(","!",["T_STRING","ctype_print",717],"(",["T_VARIABLE","$temp",717],"[",["T_LNUMBER","1",717],"]",")",["T_WHITESPACE"," ",717],["T_BOOLEAN_OR","||",717],["T_WHITESPACE"," ",717],["T_STRING","strpos",717],"(",["T_VARIABLE","$temp",717],"[",["T_LNUMBER","1",717],"]",",",["T_WHITESPACE"," ",717],["T_CONSTANT_ENCAPSED_STRING","':'",717],")",["T_WHITESPACE"," ",717],["T_IS_NOT_IDENTICAL","!==",717],["T_WHITESPACE"," ",717],["T_STRING","false",717],")",["T_WHITESPACE"," ",717],"{",["T_WHITESPACE","\n            ",717],["T_RETURN","return",718],["T_WHITESPACE"," ",718],["T_STRING","false",718],";",["T_WHITESPACE","\n        ",718],"}",["T_WHITESPACE"," ",719],["T_ELSE","else",719],["T_WHITESPACE"," ",719],"{",["T_WHITESPACE","\n            ",719],["T_VARIABLE","$data",720],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",720],"]",["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$temp",720],"[",["T_LNUMBER","1",720],"]",";",["T_WHITESPACE","\n        ",720],"}",["T_WHITESPACE","\n        ",721],["T_VARIABLE","$temp",722],["T_WHITESPACE"," ",722],"=",["T_WHITESPACE"," ",722],["T_STRING","null",722],";",["T_WHITESPACE","\n\n        ",722],["T_VARIABLE","$ret",724],["T_WHITESPACE"," ",724],"=",["T_WHITESPACE"," ",724],["T_STRING","preg_match",724],"(",["T_CONSTANT_ENCAPSED_STRING","'\/nonce=\"([^\"]+)\"\/'",724],",",["T_WHITESPACE"," ",724],["T_VARIABLE","$header",724],",",["T_WHITESPACE"," ",724],["T_VARIABLE","$temp",724],")",";",["T_WHITESPACE","\n        ",724],["T_IF","if",725],["T_WHITESPACE"," ",725],"(","!",["T_VARIABLE","$ret",725],["T_WHITESPACE"," ",725],["T_BOOLEAN_OR","||",725],["T_WHITESPACE"," ",725],["T_EMPTY","empty",725],"(",["T_VARIABLE","$temp",725],"[",["T_LNUMBER","1",725],"]",")",")",["T_WHITESPACE"," ",725],"{",["T_WHITESPACE","\n            ",725],["T_RETURN","return",726],["T_WHITESPACE"," ",726],["T_STRING","false",726],";",["T_WHITESPACE","\n        ",726],"}",["T_WHITESPACE","\n        ",727],["T_IF","if",728],["T_WHITESPACE"," ",728],"(","!",["T_STRING","ctype_xdigit",728],"(",["T_VARIABLE","$temp",728],"[",["T_LNUMBER","1",728],"]",")",")",["T_WHITESPACE"," ",728],"{",["T_WHITESPACE","\n            ",728],["T_RETURN","return",729],["T_WHITESPACE"," ",729],["T_STRING","false",729],";",["T_WHITESPACE","\n        ",729],"}",["T_WHITESPACE"," ",730],["T_ELSE","else",730],["T_WHITESPACE"," ",730],"{",["T_WHITESPACE","\n            ",730],["T_VARIABLE","$data",731],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",731],"]",["T_WHITESPACE"," ",731],"=",["T_WHITESPACE"," ",731],["T_VARIABLE","$temp",731],"[",["T_LNUMBER","1",731],"]",";",["T_WHITESPACE","\n        ",731],"}",["T_WHITESPACE","\n        ",732],["T_VARIABLE","$temp",733],["T_WHITESPACE"," ",733],"=",["T_WHITESPACE"," ",733],["T_STRING","null",733],";",["T_WHITESPACE","\n\n        ",733],["T_VARIABLE","$ret",735],["T_WHITESPACE"," ",735],"=",["T_WHITESPACE"," ",735],["T_STRING","preg_match",735],"(",["T_CONSTANT_ENCAPSED_STRING","'\/uri=\"([^\"]+)\"\/'",735],",",["T_WHITESPACE"," ",735],["T_VARIABLE","$header",735],",",["T_WHITESPACE"," ",735],["T_VARIABLE","$temp",735],")",";",["T_WHITESPACE","\n        ",735],["T_IF","if",736],["T_WHITESPACE"," ",736],"(","!",["T_VARIABLE","$ret",736],["T_WHITESPACE"," ",736],["T_BOOLEAN_OR","||",736],["T_WHITESPACE"," ",736],["T_EMPTY","empty",736],"(",["T_VARIABLE","$temp",736],"[",["T_LNUMBER","1",736],"]",")",")",["T_WHITESPACE"," ",736],"{",["T_WHITESPACE","\n            ",736],["T_RETURN","return",737],["T_WHITESPACE"," ",737],["T_STRING","false",737],";",["T_WHITESPACE","\n        ",737],"}",["T_WHITESPACE","\n        ",738],["T_COMMENT","\/\/ Section 3.2.2.5 in RFC 2617 says the authenticating server must\n",739],["T_WHITESPACE","        ",740],["T_COMMENT","\/\/ verify that the URI field in the Authorization header is for the\n",740],["T_WHITESPACE","        ",741],["T_COMMENT","\/\/ same resource requested in the Request Line.\n",741],["T_WHITESPACE","        ",742],["T_VARIABLE","$rUri",742],["T_WHITESPACE"," ",742],"=",["T_WHITESPACE"," ",742],"@",["T_STRING","parse_url",742],"(",["T_VARIABLE","$this",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","_request",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","getRequestUri",742],"(",")",")",";",["T_WHITESPACE","\n        ",742],["T_VARIABLE","$cUri",743],["T_WHITESPACE"," ",743],"=",["T_WHITESPACE"," ",743],"@",["T_STRING","parse_url",743],"(",["T_VARIABLE","$temp",743],"[",["T_LNUMBER","1",743],"]",")",";",["T_WHITESPACE","\n        ",743],["T_IF","if",744],["T_WHITESPACE"," ",744],"(",["T_STRING","false",744],["T_WHITESPACE"," ",744],["T_IS_IDENTICAL","===",744],["T_WHITESPACE"," ",744],["T_VARIABLE","$rUri",744],["T_WHITESPACE"," ",744],["T_BOOLEAN_OR","||",744],["T_WHITESPACE"," ",744],["T_STRING","false",744],["T_WHITESPACE"," ",744],["T_IS_IDENTICAL","===",744],["T_WHITESPACE"," ",744],["T_VARIABLE","$cUri",744],")",["T_WHITESPACE"," ",744],"{",["T_WHITESPACE","\n            ",744],["T_RETURN","return",745],["T_WHITESPACE"," ",745],["T_STRING","false",745],";",["T_WHITESPACE","\n        ",745],"}",["T_WHITESPACE"," ",746],["T_ELSE","else",746],["T_WHITESPACE"," ",746],"{",["T_WHITESPACE","\n            ",746],["T_COMMENT","\/\/ Make sure the path portion of both URIs is the same\n",747],["T_WHITESPACE","            ",748],["T_IF","if",748],["T_WHITESPACE"," ",748],"(",["T_VARIABLE","$rUri",748],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",748],"]",["T_WHITESPACE"," ",748],["T_IS_NOT_EQUAL","!=",748],["T_WHITESPACE"," ",748],["T_VARIABLE","$cUri",748],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",748],"]",")",["T_WHITESPACE"," ",748],"{",["T_WHITESPACE","\n                ",748],["T_RETURN","return",749],["T_WHITESPACE"," ",749],["T_STRING","false",749],";",["T_WHITESPACE","\n            ",749],"}",["T_WHITESPACE","\n            ",750],["T_COMMENT","\/\/ Section 3.2.2.5 seems to suggest that the value of the URI\n",751],["T_WHITESPACE","            ",752],["T_COMMENT","\/\/ Authorization field should be made into an absolute URI if the\n",752],["T_WHITESPACE","            ",753],["T_COMMENT","\/\/ Request URI is absolute, but it's vague, and that's a bunch of\n",753],["T_WHITESPACE","            ",754],["T_COMMENT","\/\/ code I don't want to write right now.\n",754],["T_WHITESPACE","            ",755],["T_VARIABLE","$data",755],"[",["T_CONSTANT_ENCAPSED_STRING","'uri'",755],"]",["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_VARIABLE","$temp",755],"[",["T_LNUMBER","1",755],"]",";",["T_WHITESPACE","\n        ",755],"}",["T_WHITESPACE","\n        ",756],["T_VARIABLE","$temp",757],["T_WHITESPACE"," ",757],"=",["T_WHITESPACE"," ",757],["T_STRING","null",757],";",["T_WHITESPACE","\n\n        ",757],["T_VARIABLE","$ret",759],["T_WHITESPACE"," ",759],"=",["T_WHITESPACE"," ",759],["T_STRING","preg_match",759],"(",["T_CONSTANT_ENCAPSED_STRING","'\/response=\"([^\"]+)\"\/'",759],",",["T_WHITESPACE"," ",759],["T_VARIABLE","$header",759],",",["T_WHITESPACE"," ",759],["T_VARIABLE","$temp",759],")",";",["T_WHITESPACE","\n        ",759],["T_IF","if",760],["T_WHITESPACE"," ",760],"(","!",["T_VARIABLE","$ret",760],["T_WHITESPACE"," ",760],["T_BOOLEAN_OR","||",760],["T_WHITESPACE"," ",760],["T_EMPTY","empty",760],"(",["T_VARIABLE","$temp",760],"[",["T_LNUMBER","1",760],"]",")",")",["T_WHITESPACE"," ",760],"{",["T_WHITESPACE","\n            ",760],["T_RETURN","return",761],["T_WHITESPACE"," ",761],["T_STRING","false",761],";",["T_WHITESPACE","\n        ",761],"}",["T_WHITESPACE","\n        ",762],["T_IF","if",763],["T_WHITESPACE"," ",763],"(",["T_LNUMBER","32",763],["T_WHITESPACE"," ",763],["T_IS_NOT_EQUAL","!=",763],["T_WHITESPACE"," ",763],["T_STRING","strlen",763],"(",["T_VARIABLE","$temp",763],"[",["T_LNUMBER","1",763],"]",")",["T_WHITESPACE"," ",763],["T_BOOLEAN_OR","||",763],["T_WHITESPACE"," ",763],"!",["T_STRING","ctype_xdigit",763],"(",["T_VARIABLE","$temp",763],"[",["T_LNUMBER","1",763],"]",")",")",["T_WHITESPACE"," ",763],"{",["T_WHITESPACE","\n            ",763],["T_RETURN","return",764],["T_WHITESPACE"," ",764],["T_STRING","false",764],";",["T_WHITESPACE","\n        ",764],"}",["T_WHITESPACE"," ",765],["T_ELSE","else",765],["T_WHITESPACE"," ",765],"{",["T_WHITESPACE","\n            ",765],["T_VARIABLE","$data",766],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",766],"]",["T_WHITESPACE"," ",766],"=",["T_WHITESPACE"," ",766],["T_VARIABLE","$temp",766],"[",["T_LNUMBER","1",766],"]",";",["T_WHITESPACE","\n        ",766],"}",["T_WHITESPACE","\n        ",767],["T_VARIABLE","$temp",768],["T_WHITESPACE"," ",768],"=",["T_WHITESPACE"," ",768],["T_STRING","null",768],";",["T_WHITESPACE","\n\n        ",768],["T_COMMENT","\/\/ The spec says this should default to MD5 if omitted. OK, so how does\n",770],["T_WHITESPACE","        ",771],["T_COMMENT","\/\/ that square with the algo we send out in the WWW-Authenticate header,\n",771],["T_WHITESPACE","        ",772],["T_COMMENT","\/\/ if it can easily be overridden by the client?\n",772],["T_WHITESPACE","        ",773],["T_VARIABLE","$ret",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_STRING","preg_match",773],"(",["T_CONSTANT_ENCAPSED_STRING","'\/algorithm=\"?('",773],["T_WHITESPACE"," ",773],".",["T_WHITESPACE"," ",773],["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","_algo",773],["T_WHITESPACE"," ",773],".",["T_WHITESPACE"," ",773],["T_CONSTANT_ENCAPSED_STRING","')\"?\/'",773],",",["T_WHITESPACE"," ",773],["T_VARIABLE","$header",773],",",["T_WHITESPACE"," ",773],["T_VARIABLE","$temp",773],")",";",["T_WHITESPACE","\n        ",773],["T_IF","if",774],["T_WHITESPACE"," ",774],"(",["T_VARIABLE","$ret",774],["T_WHITESPACE"," ",774],["T_BOOLEAN_AND","&&",774],["T_WHITESPACE"," ",774],"!",["T_EMPTY","empty",774],"(",["T_VARIABLE","$temp",774],"[",["T_LNUMBER","1",774],"]",")",["T_WHITESPACE","\n                 ",774],["T_BOOLEAN_AND","&&",775],["T_WHITESPACE"," ",775],["T_STRING","in_array",775],"(",["T_VARIABLE","$temp",775],"[",["T_LNUMBER","1",775],"]",",",["T_WHITESPACE"," ",775],["T_VARIABLE","$this",775],["T_OBJECT_OPERATOR","->",775],["T_STRING","_supportedAlgos",775],")",")",["T_WHITESPACE"," ",775],"{",["T_WHITESPACE","\n            ",775],["T_VARIABLE","$data",776],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",776],"]",["T_WHITESPACE"," ",776],"=",["T_WHITESPACE"," ",776],["T_VARIABLE","$temp",776],"[",["T_LNUMBER","1",776],"]",";",["T_WHITESPACE","\n        ",776],"}",["T_WHITESPACE"," ",777],["T_ELSE","else",777],["T_WHITESPACE"," ",777],"{",["T_WHITESPACE","\n            ",777],["T_VARIABLE","$data",778],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",778],"]",["T_WHITESPACE"," ",778],"=",["T_WHITESPACE"," ",778],["T_CONSTANT_ENCAPSED_STRING","'MD5'",778],";",["T_WHITESPACE","  ",778],["T_COMMENT","\/\/ = $this->_algo; ?\n",778],["T_WHITESPACE","        ",779],"}",["T_WHITESPACE","\n        ",779],["T_VARIABLE","$temp",780],["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_STRING","null",780],";",["T_WHITESPACE","\n\n        ",780],["T_COMMENT","\/\/ Not optional in this implementation\n",782],["T_WHITESPACE","        ",783],["T_VARIABLE","$ret",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],["T_STRING","preg_match",783],"(",["T_CONSTANT_ENCAPSED_STRING","'\/cnonce=\"([^\"]+)\"\/'",783],",",["T_WHITESPACE"," ",783],["T_VARIABLE","$header",783],",",["T_WHITESPACE"," ",783],["T_VARIABLE","$temp",783],")",";",["T_WHITESPACE","\n        ",783],["T_IF","if",784],["T_WHITESPACE"," ",784],"(","!",["T_VARIABLE","$ret",784],["T_WHITESPACE"," ",784],["T_BOOLEAN_OR","||",784],["T_WHITESPACE"," ",784],["T_EMPTY","empty",784],"(",["T_VARIABLE","$temp",784],"[",["T_LNUMBER","1",784],"]",")",")",["T_WHITESPACE"," ",784],"{",["T_WHITESPACE","\n            ",784],["T_RETURN","return",785],["T_WHITESPACE"," ",785],["T_STRING","false",785],";",["T_WHITESPACE","\n        ",785],"}",["T_WHITESPACE","\n        ",786],["T_IF","if",787],["T_WHITESPACE"," ",787],"(","!",["T_STRING","ctype_print",787],"(",["T_VARIABLE","$temp",787],"[",["T_LNUMBER","1",787],"]",")",")",["T_WHITESPACE"," ",787],"{",["T_WHITESPACE","\n            ",787],["T_RETURN","return",788],["T_WHITESPACE"," ",788],["T_STRING","false",788],";",["T_WHITESPACE","\n        ",788],"}",["T_WHITESPACE"," ",789],["T_ELSE","else",789],["T_WHITESPACE"," ",789],"{",["T_WHITESPACE","\n            ",789],["T_VARIABLE","$data",790],"[",["T_CONSTANT_ENCAPSED_STRING","'cnonce'",790],"]",["T_WHITESPACE"," ",790],"=",["T_WHITESPACE"," ",790],["T_VARIABLE","$temp",790],"[",["T_LNUMBER","1",790],"]",";",["T_WHITESPACE","\n        ",790],"}",["T_WHITESPACE","\n        ",791],["T_VARIABLE","$temp",792],["T_WHITESPACE"," ",792],"=",["T_WHITESPACE"," ",792],["T_STRING","null",792],";",["T_WHITESPACE","\n\n        ",792],["T_COMMENT","\/\/ If the server sent an opaque value, the client must send it back\n",794],["T_WHITESPACE","        ",795],["T_IF","if",795],["T_WHITESPACE"," ",795],"(",["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","_useOpaque",795],")",["T_WHITESPACE"," ",795],"{",["T_WHITESPACE","\n            ",795],["T_VARIABLE","$ret",796],["T_WHITESPACE"," ",796],"=",["T_WHITESPACE"," ",796],["T_STRING","preg_match",796],"(",["T_CONSTANT_ENCAPSED_STRING","'\/opaque=\"([^\"]+)\"\/'",796],",",["T_WHITESPACE"," ",796],["T_VARIABLE","$header",796],",",["T_WHITESPACE"," ",796],["T_VARIABLE","$temp",796],")",";",["T_WHITESPACE","\n            ",796],["T_IF","if",797],["T_WHITESPACE"," ",797],"(","!",["T_VARIABLE","$ret",797],["T_WHITESPACE"," ",797],["T_BOOLEAN_OR","||",797],["T_WHITESPACE"," ",797],["T_EMPTY","empty",797],"(",["T_VARIABLE","$temp",797],"[",["T_LNUMBER","1",797],"]",")",")",["T_WHITESPACE"," ",797],"{",["T_WHITESPACE","\n\n                ",797],["T_COMMENT","\/\/ Big surprise: IE isn't RFC 2617-compliant.\n",799],["T_WHITESPACE","                ",800],["T_IF","if",800],["T_WHITESPACE"," ",800],"(",["T_STRING","false",800],["T_WHITESPACE"," ",800],["T_IS_NOT_IDENTICAL","!==",800],["T_WHITESPACE"," ",800],["T_STRING","strpos",800],"(",["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","_request",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","getHeader",800],"(",["T_CONSTANT_ENCAPSED_STRING","'User-Agent'",800],")",",",["T_WHITESPACE"," ",800],["T_CONSTANT_ENCAPSED_STRING","'MSIE'",800],")",")",["T_WHITESPACE"," ",800],"{",["T_WHITESPACE","\n                    ",800],["T_VARIABLE","$temp",801],"[",["T_LNUMBER","1",801],"]",["T_WHITESPACE"," ",801],"=",["T_WHITESPACE"," ",801],["T_CONSTANT_ENCAPSED_STRING","''",801],";",["T_WHITESPACE","\n                    ",801],["T_VARIABLE","$this",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","_ieNoOpaque",802],["T_WHITESPACE"," ",802],"=",["T_WHITESPACE"," ",802],["T_STRING","true",802],";",["T_WHITESPACE","\n                ",802],"}",["T_WHITESPACE"," ",803],["T_ELSE","else",803],["T_WHITESPACE"," ",803],"{",["T_WHITESPACE","\n                    ",803],["T_RETURN","return",804],["T_WHITESPACE"," ",804],["T_STRING","false",804],";",["T_WHITESPACE","\n                ",804],"}",["T_WHITESPACE","\n            ",805],"}",["T_WHITESPACE","\n            ",806],["T_COMMENT","\/\/ This implementation only sends MD5 hex strings in the opaque value\n",807],["T_WHITESPACE","            ",808],["T_IF","if",808],["T_WHITESPACE"," ",808],"(","!",["T_VARIABLE","$this",808],["T_OBJECT_OPERATOR","->",808],["T_STRING","_ieNoOpaque",808],["T_WHITESPACE"," ",808],["T_BOOLEAN_AND","&&",808],["T_WHITESPACE","\n                ",808],"(",["T_LNUMBER","32",809],["T_WHITESPACE"," ",809],["T_IS_NOT_EQUAL","!=",809],["T_WHITESPACE"," ",809],["T_STRING","strlen",809],"(",["T_VARIABLE","$temp",809],"[",["T_LNUMBER","1",809],"]",")",["T_WHITESPACE"," ",809],["T_BOOLEAN_OR","||",809],["T_WHITESPACE"," ",809],"!",["T_STRING","ctype_xdigit",809],"(",["T_VARIABLE","$temp",809],"[",["T_LNUMBER","1",809],"]",")",")",")",["T_WHITESPACE"," ",809],"{",["T_WHITESPACE","\n                ",809],["T_RETURN","return",810],["T_WHITESPACE"," ",810],["T_STRING","false",810],";",["T_WHITESPACE","\n            ",810],"}",["T_WHITESPACE"," ",811],["T_ELSE","else",811],["T_WHITESPACE"," ",811],"{",["T_WHITESPACE","\n                ",811],["T_VARIABLE","$data",812],"[",["T_CONSTANT_ENCAPSED_STRING","'opaque'",812],"]",["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_VARIABLE","$temp",812],"[",["T_LNUMBER","1",812],"]",";",["T_WHITESPACE","\n            ",812],"}",["T_WHITESPACE","\n            ",813],["T_VARIABLE","$temp",814],["T_WHITESPACE"," ",814],"=",["T_WHITESPACE"," ",814],["T_STRING","null",814],";",["T_WHITESPACE","\n        ",814],"}",["T_WHITESPACE","\n\n        ",815],["T_COMMENT","\/\/ Not optional in this implementation, but must be one of the supported\n",817],["T_WHITESPACE","        ",818],["T_COMMENT","\/\/ qop types\n",818],["T_WHITESPACE","        ",819],["T_VARIABLE","$ret",819],["T_WHITESPACE"," ",819],"=",["T_WHITESPACE"," ",819],["T_STRING","preg_match",819],"(",["T_CONSTANT_ENCAPSED_STRING","'\/qop=\"?('",819],["T_WHITESPACE"," ",819],".",["T_WHITESPACE"," ",819],["T_STRING","implode",819],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$this",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","_supportedQops",819],")",["T_WHITESPACE"," ",819],".",["T_WHITESPACE"," ",819],["T_CONSTANT_ENCAPSED_STRING","')\"?\/'",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$header",819],",",["T_WHITESPACE"," ",819],["T_VARIABLE","$temp",819],")",";",["T_WHITESPACE","\n        ",819],["T_IF","if",820],["T_WHITESPACE"," ",820],"(","!",["T_VARIABLE","$ret",820],["T_WHITESPACE"," ",820],["T_BOOLEAN_OR","||",820],["T_WHITESPACE"," ",820],["T_EMPTY","empty",820],"(",["T_VARIABLE","$temp",820],"[",["T_LNUMBER","1",820],"]",")",")",["T_WHITESPACE"," ",820],"{",["T_WHITESPACE","\n            ",820],["T_RETURN","return",821],["T_WHITESPACE"," ",821],["T_STRING","false",821],";",["T_WHITESPACE","\n        ",821],"}",["T_WHITESPACE","\n        ",822],["T_IF","if",823],["T_WHITESPACE"," ",823],"(","!",["T_STRING","in_array",823],"(",["T_VARIABLE","$temp",823],"[",["T_LNUMBER","1",823],"]",",",["T_WHITESPACE"," ",823],["T_VARIABLE","$this",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","_supportedQops",823],")",")",["T_WHITESPACE"," ",823],"{",["T_WHITESPACE","\n            ",823],["T_RETURN","return",824],["T_WHITESPACE"," ",824],["T_STRING","false",824],";",["T_WHITESPACE","\n        ",824],"}",["T_WHITESPACE"," ",825],["T_ELSE","else",825],["T_WHITESPACE"," ",825],"{",["T_WHITESPACE","\n            ",825],["T_VARIABLE","$data",826],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",826],"]",["T_WHITESPACE"," ",826],"=",["T_WHITESPACE"," ",826],["T_VARIABLE","$temp",826],"[",["T_LNUMBER","1",826],"]",";",["T_WHITESPACE","\n        ",826],"}",["T_WHITESPACE","\n        ",827],["T_VARIABLE","$temp",828],["T_WHITESPACE"," ",828],"=",["T_WHITESPACE"," ",828],["T_STRING","null",828],";",["T_WHITESPACE","\n\n        ",828],["T_COMMENT","\/\/ Not optional in this implementation. The spec says this value\n",830],["T_WHITESPACE","        ",831],["T_COMMENT","\/\/ shouldn't be a quoted string, but apparently some implementations\n",831],["T_WHITESPACE","        ",832],["T_COMMENT","\/\/ quote it anyway. See ZF-1544.\n",832],["T_WHITESPACE","        ",833],["T_VARIABLE","$ret",833],["T_WHITESPACE"," ",833],"=",["T_WHITESPACE"," ",833],["T_STRING","preg_match",833],"(",["T_CONSTANT_ENCAPSED_STRING","'\/nc=\"?([0-9A-Fa-f]{8})\"?\/'",833],",",["T_WHITESPACE"," ",833],["T_VARIABLE","$header",833],",",["T_WHITESPACE"," ",833],["T_VARIABLE","$temp",833],")",";",["T_WHITESPACE","\n        ",833],["T_IF","if",834],["T_WHITESPACE"," ",834],"(","!",["T_VARIABLE","$ret",834],["T_WHITESPACE"," ",834],["T_BOOLEAN_OR","||",834],["T_WHITESPACE"," ",834],["T_EMPTY","empty",834],"(",["T_VARIABLE","$temp",834],"[",["T_LNUMBER","1",834],"]",")",")",["T_WHITESPACE"," ",834],"{",["T_WHITESPACE","\n            ",834],["T_RETURN","return",835],["T_WHITESPACE"," ",835],["T_STRING","false",835],";",["T_WHITESPACE","\n        ",835],"}",["T_WHITESPACE","\n        ",836],["T_IF","if",837],["T_WHITESPACE"," ",837],"(",["T_LNUMBER","8",837],["T_WHITESPACE"," ",837],["T_IS_NOT_EQUAL","!=",837],["T_WHITESPACE"," ",837],["T_STRING","strlen",837],"(",["T_VARIABLE","$temp",837],"[",["T_LNUMBER","1",837],"]",")",["T_WHITESPACE"," ",837],["T_BOOLEAN_OR","||",837],["T_WHITESPACE"," ",837],"!",["T_STRING","ctype_xdigit",837],"(",["T_VARIABLE","$temp",837],"[",["T_LNUMBER","1",837],"]",")",")",["T_WHITESPACE"," ",837],"{",["T_WHITESPACE","\n            ",837],["T_RETURN","return",838],["T_WHITESPACE"," ",838],["T_STRING","false",838],";",["T_WHITESPACE","\n        ",838],"}",["T_WHITESPACE"," ",839],["T_ELSE","else",839],["T_WHITESPACE"," ",839],"{",["T_WHITESPACE","\n            ",839],["T_VARIABLE","$data",840],"[",["T_CONSTANT_ENCAPSED_STRING","'nc'",840],"]",["T_WHITESPACE"," ",840],"=",["T_WHITESPACE"," ",840],["T_VARIABLE","$temp",840],"[",["T_LNUMBER","1",840],"]",";",["T_WHITESPACE","\n        ",840],"}",["T_WHITESPACE","\n        ",841],["T_VARIABLE","$temp",842],["T_WHITESPACE"," ",842],"=",["T_WHITESPACE"," ",842],["T_STRING","null",842],";",["T_WHITESPACE","\n\n        ",842],["T_RETURN","return",844],["T_WHITESPACE"," ",844],["T_VARIABLE","$data",844],";",["T_WHITESPACE","\n    ",844],"}",["T_WHITESPACE","\n\n    ",845],["T_DOC_COMMENT","\/**\n     * Securely compare two strings for equality while avoided C level memcmp()\n     * optimisations capable of leaking timing information useful to an attacker\n     * attempting to iteratively guess the unknown string (e.g. password) being\n     * compared against.\n     *\n     * @param string $a\n     * @param string $b\n     * @return bool\n     *\/",847],["T_WHITESPACE","\n    ",856],["T_PROTECTED","protected",857],["T_WHITESPACE"," ",857],["T_FUNCTION","function",857],["T_WHITESPACE"," ",857],["T_STRING","_secureStringCompare",857],"(",["T_VARIABLE","$a",857],",",["T_WHITESPACE"," ",857],["T_VARIABLE","$b",857],")",["T_WHITESPACE","\n    ",857],"{",["T_WHITESPACE","\n        ",858],["T_IF","if",859],["T_WHITESPACE"," ",859],"(",["T_STRING","strlen",859],"(",["T_VARIABLE","$a",859],")",["T_WHITESPACE"," ",859],["T_IS_NOT_IDENTICAL","!==",859],["T_WHITESPACE"," ",859],["T_STRING","strlen",859],"(",["T_VARIABLE","$b",859],")",")",["T_WHITESPACE"," ",859],"{",["T_WHITESPACE","\n            ",859],["T_RETURN","return",860],["T_WHITESPACE"," ",860],["T_STRING","false",860],";",["T_WHITESPACE","\n        ",860],"}",["T_WHITESPACE","\n        ",861],["T_VARIABLE","$result",862],["T_WHITESPACE"," ",862],"=",["T_WHITESPACE"," ",862],["T_LNUMBER","0",862],";",["T_WHITESPACE","\n        ",862],["T_FOR","for",863],["T_WHITESPACE"," ",863],"(",["T_VARIABLE","$i",863],["T_WHITESPACE"," ",863],"=",["T_WHITESPACE"," ",863],["T_LNUMBER","0",863],";",["T_WHITESPACE"," ",863],["T_VARIABLE","$i",863],["T_WHITESPACE"," ",863],"<",["T_WHITESPACE"," ",863],["T_STRING","strlen",863],"(",["T_VARIABLE","$a",863],")",";",["T_WHITESPACE"," ",863],["T_VARIABLE","$i",863],["T_INC","++",863],")",["T_WHITESPACE"," ",863],"{",["T_WHITESPACE","\n            ",863],["T_VARIABLE","$result",864],["T_WHITESPACE"," ",864],["T_OR_EQUAL","|=",864],["T_WHITESPACE"," ",864],["T_STRING","ord",864],"(",["T_VARIABLE","$a",864],"[",["T_VARIABLE","$i",864],"]",")",["T_WHITESPACE"," ",864],"^",["T_WHITESPACE"," ",864],["T_STRING","ord",864],"(",["T_VARIABLE","$b",864],"[",["T_VARIABLE","$i",864],"]",")",";",["T_WHITESPACE","\n        ",864],"}",["T_WHITESPACE","\n        ",865],["T_RETURN","return",866],["T_WHITESPACE"," ",866],["T_VARIABLE","$result",866],["T_WHITESPACE"," ",866],["T_IS_EQUAL","==",866],["T_WHITESPACE"," ",866],["T_LNUMBER","0",866],";",["T_WHITESPACE","\n    ",866],"}",["T_WHITESPACE","\n",867],"}",["T_WHITESPACE","\n",868]]