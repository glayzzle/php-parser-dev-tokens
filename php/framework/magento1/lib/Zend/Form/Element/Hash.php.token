[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Form\n * @subpackage Element\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",2],["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/** Zend_Form_Element_Xhtml *\/",22],["T_WHITESPACE","\n",22],["T_COMMENT","#require_once 'Zend\/Form\/Element\/Xhtml.php';\n",23],["T_WHITESPACE","\n",24],["T_DOC_COMMENT","\/**\n * CSRF form protection\n *\n * @category   Zend\n * @package    Zend_Form\n * @subpackage Element\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",25],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Form_Element_Hash",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Form_Element_Xhtml",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Use formHidden view helper by default\n     * @var string\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$helper",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'formHidden'",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Actual hash used.\n     *\n     * @var mixed\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_hash",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Salt for CSRF token\n     * @var string\n     *\/",50],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_salt",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'salt'",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * @var Zend_Session_Namespace\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_session",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * TTL for CSRF token\n     * @var int\n     *\/",61],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_timeout",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_LNUMBER","300",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * Creates session namespace for CSRF token, and adds validator for CSRF\n     * token.\n     *\n     * @param  string|array|Zend_Config $spec\n     * @param  array|Zend_Config $options\n     * @return void\n     *\/",67],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","__construct",77],"(",["T_VARIABLE","$spec",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$options",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","null",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_STRING","parent",79],["T_DOUBLE_COLON","::",79],["T_STRING","__construct",79],"(",["T_VARIABLE","$spec",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$options",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setAllowEmpty",81],"(",["T_STRING","false",81],")",["T_WHITESPACE","\n             ",81],["T_OBJECT_OPERATOR","->",82],["T_STRING","setRequired",82],"(",["T_STRING","true",82],")",["T_WHITESPACE","\n             ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","initCsrfValidator",83],"(",")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Set session object\n     *\n     * @param  Zend_Session_Namespace $session\n     * @return Zend_Form_Element_Hash\n     *\/",86],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","setSession",92],"(",["T_VARIABLE","$session",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_session",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$session",94],";",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Get session object\n     *\n     * Instantiate session object if none currently exists\n     *\n     * @return Zend_Session_Namespace\n     *\/",98],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","getSession",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_STRING","null",107],["T_WHITESPACE"," ",107],["T_IS_IDENTICAL","===",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_session",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_COMMENT","#require_once 'Zend\/Session\/Namespace.php';\n",108],["T_WHITESPACE","            ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_session",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_NEW","new",109],["T_WHITESPACE"," ",109],["T_STRING","Zend_Session_Namespace",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getSessionName",109],"(",")",")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_session",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Initialize CSRF validator\n     *\n     * Creates Session namespace, and initializes CSRF token in session.\n     * Additionally, adds validator for validating CSRF token.\n     *\n     * @return Zend_Form_Element_Hash\n     *\/",114],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","initCsrfValidator",122],"(",")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$session",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getSession",124],"(",")",";",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_ISSET","isset",125],"(",["T_VARIABLE","$session",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","hash",125],")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$rightHash",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$session",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","hash",126],";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE"," ",127],["T_ELSE","else",127],["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$rightHash",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","null",128],";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","addValidator",131],"(",["T_CONSTANT_ENCAPSED_STRING","'Identical'",131],",",["T_WHITESPACE"," ",131],["T_STRING","true",131],",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",["T_VARIABLE","$rightHash",131],")",")",";",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * Salt for CSRF token\n     *\n     * @param  string $salt\n     * @return Zend_Form_Element_Hash\n     *\/",135],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","setSalt",141],"(",["T_VARIABLE","$salt",141],")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_salt",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING_CAST","(string)",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$salt",143],";",["T_WHITESPACE","\n        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Retrieve salt for CSRF token\n     *\n     * @return string\n     *\/",147],["T_WHITESPACE","\n    ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","getSalt",152],"(",")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_salt",154],";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_DOC_COMMENT","\/**\n     * Retrieve CSRF token\n     *\n     * If no CSRF token currently exists, generates one.\n     *\n     * @return string\n     *\/",157],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","getHash",164],"(",")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_IF","if",166],["T_WHITESPACE"," ",166],"(",["T_STRING","null",166],["T_WHITESPACE"," ",166],["T_IS_IDENTICAL","===",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_hash",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_generateHash",167],"(",")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n        ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_hash",169],";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Get session namespace for CSRF token\n     *\n     * Generates a session namespace based on salt, element name, and class.\n     *\n     * @return string\n     *\/",172],["T_WHITESPACE","\n    ",178],["T_PUBLIC","public",179],["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],["T_STRING","getSessionName",179],"(",")",["T_WHITESPACE","\n    ",179],"{",["T_WHITESPACE","\n        ",180],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_CLASS_C","__CLASS__",181],["T_WHITESPACE"," ",181],".",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'_'",181],["T_WHITESPACE"," ",181],".",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getSalt",181],"(",")",["T_WHITESPACE"," ",181],".",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'_'",181],["T_WHITESPACE"," ",181],".",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getName",181],"(",")",";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Set timeout for CSRF session token\n     *\n     * @param  int $ttl\n     * @return Zend_Form_Element_Hash\n     *\/",184],["T_WHITESPACE","\n    ",189],["T_PUBLIC","public",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","setTimeout",190],"(",["T_VARIABLE","$ttl",190],")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_timeout",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_INT_CAST","(int)",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$ttl",192],";",["T_WHITESPACE","\n        ",192],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Get CSRF session token timeout\n     *\n     * @return int\n     *\/",196],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getTimeout",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_timeout",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Override getLabel() to always be empty\n     *\n     * @return null\n     *\/",206],["T_WHITESPACE","\n    ",210],["T_PUBLIC","public",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","getLabel",211],"(",")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_STRING","null",213],";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Initialize CSRF token in session\n     *\n     * @return void\n     *\/",216],["T_WHITESPACE","\n    ",220],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","initCsrfToken",221],"(",")",["T_WHITESPACE","\n    ",221],"{",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$session",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getSession",223],"(",")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$session",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","setExpirationHops",224],"(",["T_LNUMBER","1",224],",",["T_WHITESPACE"," ",224],["T_STRING","null",224],",",["T_WHITESPACE"," ",224],["T_STRING","true",224],")",";",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$session",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","setExpirationSeconds",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getTimeout",225],"(",")",")",";",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$session",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","hash",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getHash",226],"(",")",";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Render CSRF token in form\n     *\n     * @param  Zend_View_Interface $view\n     * @return string\n     *\/",229],["T_WHITESPACE","\n    ",234],["T_PUBLIC","public",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","render",235],"(",["T_STRING","Zend_View_Interface",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$view",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_STRING","null",235],")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","initCsrfToken",237],"(",")",";",["T_WHITESPACE","\n        ",237],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_STRING","parent",238],["T_DOUBLE_COLON","::",238],["T_STRING","render",238],"(",["T_VARIABLE","$view",238],")",";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Generate CSRF token\n     *\n     * Generates CSRF token and stores both in {@link $_hash} and element\n     * value.\n     *\n     * @return void\n     *\/",241],["T_WHITESPACE","\n    ",248],["T_PROTECTED","protected",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","_generateHash",249],"(",")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_hash",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","md5",251],"(",["T_WHITESPACE","\n            ",251],["T_STRING","mt_rand",252],"(",["T_LNUMBER","1",252],",",["T_LNUMBER","1000000",252],")",["T_WHITESPACE","\n            ",252],".",["T_WHITESPACE","  ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getSalt",253],"(",")",["T_WHITESPACE","\n            ",253],".",["T_WHITESPACE","  ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getName",254],"(",")",["T_WHITESPACE","\n            ",254],".",["T_WHITESPACE","  ",255],["T_STRING","mt_rand",255],"(",["T_LNUMBER","1",255],",",["T_LNUMBER","1000000",255],")",["T_WHITESPACE","\n        ",255],")",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","setValue",257],"(",["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_hash",257],")",";",["T_WHITESPACE","\n    ",257],"}",["T_WHITESPACE","\n",258],"}",["T_WHITESPACE","\n",259]]