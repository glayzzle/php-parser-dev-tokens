[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Gdata\n * @subpackage Gdata\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",3],["T_WHITESPACE","\n\n",22],["T_DOC_COMMENT","\/**\n * @see Zend_Http_Client_Adapter_Proxy\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once 'Zend\/Http\/Client\/Adapter\/Proxy.php';\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/**\n * Extends the proxy HTTP adapter to handle streams instead of discrete body\n * strings.\n *\n * @category   Zend\n * @package    Zend_Gdata\n * @subpackage Gdata\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",29],["T_WHITESPACE","\n",38],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Gdata_HttpAdapterStreamingProxy",39],["T_WHITESPACE"," ",39],["T_EXTENDS","extends",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Http_Client_Adapter_Proxy",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n    ",40],["T_DOC_COMMENT","\/**\n     * The amount read from a stream source at a time.\n     *\n     * @var integer\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","CHUNK_SIZE",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_LNUMBER","1024",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Send request to the proxy server with streaming support\n     *\n     * @param string        $method\n     * @param Zend_Uri_Http $uri\n     * @param string        $http_ver\n     * @param array         $headers\n     * @param string        $body\n     * @return string Request as string\n     *\/",48],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","write",58],"(",["T_VARIABLE","$method",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$uri",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$http_ver",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'1.1'",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$headers",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",")",",",["T_WHITESPACE"," ",58],["T_VARIABLE","$body",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","''",58],")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_COMMENT","\/\/ If no proxy is set, throw an error\n",60],["T_WHITESPACE","        ",61],["T_IF","if",61],["T_WHITESPACE"," ",61],"(","!",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","config",61],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_host'",61],"]",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_COMMENT","#require_once 'Zend\/Http\/Client\/Adapter\/Exception.php';\n",62],["T_WHITESPACE","            ",63],["T_THROW","throw",63],["T_WHITESPACE"," ",63],["T_NEW","new",63],["T_WHITESPACE"," ",63],["T_STRING","Zend_Http_Client_Adapter_Exception",63],"(",["T_CONSTANT_ENCAPSED_STRING","'No proxy host set!'",63],")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n\n        ",64],["T_COMMENT","\/\/ Make sure we're properly connected\n",66],["T_WHITESPACE","        ",67],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","socket",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_COMMENT","#require_once 'Zend\/Http\/Client\/Adapter\/Exception.php';\n",68],["T_WHITESPACE","            ",69],["T_THROW","throw",69],["T_WHITESPACE"," ",69],["T_NEW","new",69],["T_WHITESPACE"," ",69],["T_STRING","Zend_Http_Client_Adapter_Exception",69],"(",["T_WHITESPACE","\n                ",69],["T_CONSTANT_ENCAPSED_STRING","'Trying to write but we are not connected'",70],")",";",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE","\n\n        ",71],["T_VARIABLE","$host",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","config",73],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_host'",73],"]",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$port",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","config",74],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_port'",74],"]",";",["T_WHITESPACE","\n\n        ",74],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","connected_to",76],"[",["T_LNUMBER","0",76],"]",["T_WHITESPACE"," ",76],["T_IS_NOT_EQUAL","!=",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$host",76],["T_WHITESPACE"," ",76],["T_BOOLEAN_OR","||",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","connected_to",76],"[",["T_LNUMBER","1",76],"]",["T_WHITESPACE"," ",76],["T_IS_NOT_EQUAL","!=",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$port",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_COMMENT","#require_once 'Zend\/Http\/Client\/Adapter\/Exception.php';\n",77],["T_WHITESPACE","            ",78],["T_THROW","throw",78],["T_WHITESPACE"," ",78],["T_NEW","new",78],["T_WHITESPACE"," ",78],["T_STRING","Zend_Http_Client_Adapter_Exception",78],"(",["T_WHITESPACE","\n                ",78],["T_CONSTANT_ENCAPSED_STRING","'Trying to write but we are connected to the wrong proxy '",79],["T_WHITESPACE"," ",79],".",["T_WHITESPACE","\n                ",79],["T_CONSTANT_ENCAPSED_STRING","'server'",80],")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_COMMENT","\/\/ Add Proxy-Authorization header\n",83],["T_WHITESPACE","        ",84],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","config",84],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_user'",84],"]",["T_WHITESPACE"," ",84],["T_BOOLEAN_AND","&&",84],["T_WHITESPACE"," ",84],"!",["T_WHITESPACE"," ",84],["T_ISSET","isset",84],"(",["T_VARIABLE","$headers",84],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy-authorization'",84],"]",")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$headers",85],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy-authorization'",85],"]",["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","Zend_Http_Client",85],["T_DOUBLE_COLON","::",85],["T_STRING","encodeAuthHeader",85],"(",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","config",86],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_user'",86],"]",",",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","config",86],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_pass'",86],"]",",",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","config",86],"[",["T_CONSTANT_ENCAPSED_STRING","'proxy_auth'",86],"]",["T_WHITESPACE","\n            ",86],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n\n        ",88],["T_COMMENT","\/\/ if we are proxying HTTPS, preform CONNECT handshake with the proxy\n",90],["T_WHITESPACE","        ",91],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$uri",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getScheme",91],"(",")",["T_WHITESPACE"," ",91],["T_IS_EQUAL","==",91],["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'https'",91],["T_WHITESPACE"," ",91],["T_BOOLEAN_AND","&&",91],["T_WHITESPACE"," ",91],"(","!",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","negotiated",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","connectHandshake",92],"(",["T_VARIABLE","$uri",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getHost",92],"(",")",",",["T_WHITESPACE"," ",92],["T_VARIABLE","$uri",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getPort",92],"(",")",",",["T_WHITESPACE"," ",92],["T_VARIABLE","$http_ver",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$headers",92],")",";",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","negotiated",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","true",93],";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n\n        ",94],["T_COMMENT","\/\/ Save request method for later\n",96],["T_WHITESPACE","        ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","method",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$method",97],";",["T_WHITESPACE","\n\n        ",97],["T_COMMENT","\/\/ Build request headers\n",99],["T_WHITESPACE","        ",100],["T_VARIABLE","$request",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],"\"",["T_CURLY_OPEN","{",100],["T_VARIABLE","$method",100],"}",["T_ENCAPSED_AND_WHITESPACE"," ",100],["T_CURLY_OPEN","{",100],["T_VARIABLE","$uri",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","__toString",100],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," HTTP\/",100],["T_CURLY_OPEN","{",100],["T_VARIABLE","$http_ver",100],"}",["T_ENCAPSED_AND_WHITESPACE","\\r\\n",100],"\"",";",["T_WHITESPACE","\n\n        ",100],["T_COMMENT","\/\/ Add all headers to the request string\n",102],["T_WHITESPACE","        ",103],["T_FOREACH","foreach",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$headers",103],["T_WHITESPACE"," ",103],["T_AS","as",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$k",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$v",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_STRING","is_string",104],"(",["T_VARIABLE","$k",104],")",")",["T_WHITESPACE"," ",104],["T_VARIABLE","$v",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],"\"",["T_VARIABLE","$k",104],["T_ENCAPSED_AND_WHITESPACE",": ",104],["T_VARIABLE","$v",104],"\"",";",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$request",105],["T_WHITESPACE"," ",105],["T_CONCAT_EQUAL",".=",105],["T_WHITESPACE"," ",105],"\"",["T_VARIABLE","$v",105],["T_ENCAPSED_AND_WHITESPACE","\\r\\n",105],"\"",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n\n        ",106],["T_VARIABLE","$request",108],["T_WHITESPACE"," ",108],["T_CONCAT_EQUAL",".=",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",108],";",["T_WHITESPACE","\n\n        ",108],["T_COMMENT","\/\/ Send the request headers\n",110],["T_WHITESPACE","        ",111],["T_IF","if",111],["T_WHITESPACE"," ",111],"(","!",["T_WHITESPACE"," ",111],"@",["T_STRING","fwrite",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","socket",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$request",111],")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_COMMENT","#require_once 'Zend\/Http\/Client\/Adapter\/Exception.php';\n",112],["T_WHITESPACE","            ",113],["T_THROW","throw",113],["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Zend_Http_Client_Adapter_Exception",113],"(",["T_WHITESPACE","\n                ",113],["T_CONSTANT_ENCAPSED_STRING","'Error writing request to proxy server'",114],")",";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n\n        ",115],["T_COMMENT","\/\/ Read from $body, write to socket\n",117],["T_WHITESPACE","        ",118],["T_VARIABLE","$chunk",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$body",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","read",118],"(",["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_STRING","CHUNK_SIZE",118],")",";",["T_WHITESPACE","\n        ",118],["T_WHILE","while",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$chunk",119],["T_WHITESPACE"," ",119],["T_IS_NOT_IDENTICAL","!==",119],["T_WHITESPACE"," ",119],["T_STRING","false",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!","@",["T_STRING","fwrite",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","socket",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$chunk",120],")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                ",120],["T_COMMENT","#require_once 'Zend\/Http\/Client\/Adapter\/Exception.php';\n",121],["T_WHITESPACE","                ",122],["T_THROW","throw",122],["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","Zend_Http_Client_Adapter_Exception",122],"(",["T_WHITESPACE","\n                    ",122],["T_CONSTANT_ENCAPSED_STRING","'Error writing request to server'",123],["T_WHITESPACE","\n                ",123],")",";",["T_WHITESPACE","\n            ",124],"}",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$chunk",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$body",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","read",126],"(",["T_STRING","self",126],["T_DOUBLE_COLON","::",126],["T_STRING","CHUNK_SIZE",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$body",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","closeFileHandle",128],"(",")",";",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'Large upload, request is not cached.'",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n",131],"}",["T_WHITESPACE","\n",132]]