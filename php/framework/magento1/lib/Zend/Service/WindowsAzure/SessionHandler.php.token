[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @subpackage Session\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/**\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @subpackage Session\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",23],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Zend_Service_WindowsAzure_SessionHandler",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n\t",31],["T_DOC_COMMENT","\/**\n\t * Maximal property size in table storage.\n\t * \n\t * @var int\n\t * @see http:\/\/msdn.microsoft.com\/en-us\/library\/dd179338.aspx\n\t *\/",32],["T_WHITESPACE","\n\t",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","MAX_TS_PROPERTY_SIZE",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_LNUMBER","65536",38],";",["T_WHITESPACE","\n\t\n\t",38],["T_DOC_COMMENT","\/** Storage backend type *\/",40],["T_WHITESPACE","\n\t",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","STORAGE_TYPE_TABLE",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'table'",41],";",["T_WHITESPACE","\n\t",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","STORAGE_TYPE_BLOB",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'blob'",42],";",["T_WHITESPACE","\n\t\n    ",42],["T_DOC_COMMENT","\/**\n     * Storage back-end\n     * \n     * @var Zend_Service_WindowsAzure_Storage_Table|Zend_Service_WindowsAzure_Storage_Blob\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_storage",49],";",["T_WHITESPACE","\n    \n    ",49],["T_DOC_COMMENT","\/**\n     * Storage backend type\n     * \n     * @var string\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_storageType",56],";",["T_WHITESPACE","\n    \n    ",56],["T_DOC_COMMENT","\/**\n     * Session container name\n     * \n     * @var string\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_sessionContainer",63],";",["T_WHITESPACE","\n    \n    ",63],["T_DOC_COMMENT","\/**\n     * Session container partition\n     * \n     * @var string\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_sessionContainerPartition",70],";",["T_WHITESPACE","\n\t\n    ",70],["T_DOC_COMMENT","\/**\n     * Creates a new Zend_Service_WindowsAzure_SessionHandler instance\n     * \n     * @param Zend_Service_WindowsAzure_Storage_Table|Zend_Service_WindowsAzure_Storage_Blob $storage Storage back-end, can be table storage and blob storage\n     * @param string $sessionContainer Session container name\n     * @param string $sessionContainerPartition Session container partition\n     *\/",72],["T_WHITESPACE","\n    ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","__construct",79],"(",["T_STRING","Zend_Service_WindowsAzure_Storage",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$storage",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$sessionContainer",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'phpsessions'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$sessionContainerPartition",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'sessions'",79],")",["T_WHITESPACE","\n\t",79],"{",["T_WHITESPACE","\n\t\t",80],["T_COMMENT","\/\/ Validate $storage\n",81],["T_WHITESPACE","\t\t",82],["T_IF","if",82],["T_WHITESPACE"," ",82],"(","!","(",["T_VARIABLE","$storage",82],["T_WHITESPACE"," ",82],["T_INSTANCEOF","instanceof",82],["T_WHITESPACE"," ",82],["T_STRING","Zend_Service_WindowsAzure_Storage_Table",82],["T_WHITESPACE"," ",82],["T_BOOLEAN_OR","||",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$storage",82],["T_WHITESPACE"," ",82],["T_INSTANCEOF","instanceof",82],["T_WHITESPACE"," ",82],["T_STRING","Zend_Service_WindowsAzure_Storage_Blob",82],")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n\t\t\t",82],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Exception.php';\n",83],["T_WHITESPACE","\t\t\t",84],["T_THROW","throw",84],["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","Zend_Service_WindowsAzure_Exception",84],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid storage back-end given. Storage back-end should be of type Zend_Service_WindowsAzure_Storage_Table or Zend_Service_WindowsAzure_Storage_Blob.'",84],")",";",["T_WHITESPACE","\n\t\t",84],"}",["T_WHITESPACE","\n\t\t\n\t\t",85],["T_COMMENT","\/\/ Validate other parameters\n",87],["T_WHITESPACE","\t\t",88],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$sessionContainer",88],["T_WHITESPACE"," ",88],["T_IS_EQUAL","==",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","''",88],["T_WHITESPACE"," ",88],["T_BOOLEAN_OR","||",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$sessionContainerPartition",88],["T_WHITESPACE"," ",88],["T_IS_EQUAL","==",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","''",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n\t\t\t",88],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Exception.php';\n",89],["T_WHITESPACE","\t\t\t",90],["T_THROW","throw",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_STRING","Zend_Service_WindowsAzure_Exception",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Session container and session partition should be specified.'",90],")",";",["T_WHITESPACE","\n\t\t",90],"}",["T_WHITESPACE","\n\t\t\n\t\t",91],["T_COMMENT","\/\/ Determine storage type\n",93],["T_WHITESPACE","\t\t",94],["T_VARIABLE","$storageType",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","self",94],["T_DOUBLE_COLON","::",94],["T_STRING","STORAGE_TYPE_TABLE",94],";",["T_WHITESPACE","\n\t\t",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$storage",95],["T_WHITESPACE"," ",95],["T_INSTANCEOF","instanceof",95],["T_WHITESPACE"," ",95],["T_STRING","Zend_Service_WindowsAzure_Storage_Blob",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n\t\t\t",95],["T_VARIABLE","$storageType",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","self",96],["T_DOUBLE_COLON","::",96],["T_STRING","STORAGE_TYPE_BLOB",96],";",["T_WHITESPACE","\n\t\t",96],"}",["T_WHITESPACE","\n\t\t\n\t    ",97],["T_COMMENT","\/\/ Set properties\n",99],["T_WHITESPACE","\t\t",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_storage",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$storage",100],";",["T_WHITESPACE","\n\t\t",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_storageType",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$storageType",101],";",["T_WHITESPACE","\n\t\t",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_sessionContainer",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$sessionContainer",102],";",["T_WHITESPACE","\n\t\t",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_sessionContainerPartition",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$sessionContainerPartition",103],";",["T_WHITESPACE","\n\t",103],"}",["T_WHITESPACE","\n\t\n\t",104],["T_DOC_COMMENT","\/**\n\t * Registers the current session handler as PHP's session handler\n\t * \n\t * @return boolean\n\t *\/",106],["T_WHITESPACE","\n\t",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","register",111],"(",")",["T_WHITESPACE","\n\t",111],"{",["T_WHITESPACE","\n        ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_STRING","session_set_save_handler",113],"(",["T_ARRAY","array",113],"(",["T_VARIABLE","$this",113],",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'open'",113],")",",",["T_WHITESPACE","\n                                        ",113],["T_ARRAY","array",114],"(",["T_VARIABLE","$this",114],",",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'close'",114],")",",",["T_WHITESPACE","\n                                        ",114],["T_ARRAY","array",115],"(",["T_VARIABLE","$this",115],",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'read'",115],")",",",["T_WHITESPACE","\n                                        ",115],["T_ARRAY","array",116],"(",["T_VARIABLE","$this",116],",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'write'",116],")",",",["T_WHITESPACE","\n                                        ",116],["T_ARRAY","array",117],"(",["T_VARIABLE","$this",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'destroy'",117],")",",",["T_WHITESPACE","\n                                        ",117],["T_ARRAY","array",118],"(",["T_VARIABLE","$this",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'gc'",118],")",["T_WHITESPACE","\n        ",118],")",";",["T_WHITESPACE","\n\t",119],"}",["T_WHITESPACE","\n\t\n    ",120],["T_DOC_COMMENT","\/**\n     * Open the session store\n     * \n     * @return bool\n     *\/",122],["T_WHITESPACE","\n    ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","open",127],"(",")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n    \t",128],["T_COMMENT","\/\/ Make sure storage container exists\n",129],["T_WHITESPACE","    \t",130],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_storageType",130],["T_WHITESPACE"," ",130],["T_IS_EQUAL","==",130],["T_WHITESPACE"," ",130],["T_STRING","self",130],["T_DOUBLE_COLON","::",130],["T_STRING","STORAGE_TYPE_TABLE",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n    \t\t",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_storage",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","createTableIfNotExists",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_sessionContainer",131],")",";",["T_WHITESPACE","\n    \t",131],"}",["T_WHITESPACE"," ",132],["T_ELSE","else",132],["T_WHITESPACE"," ",132],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_storageType",132],["T_WHITESPACE"," ",132],["T_IS_EQUAL","==",132],["T_WHITESPACE"," ",132],["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","STORAGE_TYPE_BLOB",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n    \t\t",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_storage",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","createContainerIfNotExists",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_sessionContainer",133],")",";",["T_WHITESPACE","\n    \t",133],"}",["T_WHITESPACE","\n    \t\n\t\t",134],["T_COMMENT","\/\/ Ok!\n",136],["T_WHITESPACE","\t\t",137],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_STRING","true",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Close the session store\n     * \n     * @return bool\n     *\/",140],["T_WHITESPACE","\n    ",144],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","close",145],"(",")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_STRING","true",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n    \n    ",148],["T_DOC_COMMENT","\/**\n     * Read a specific session\n     * \n     * @param int $id Session Id\n     * @return string\n     *\/",150],["T_WHITESPACE","\n    ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","read",156],"(",["T_VARIABLE","$id",156],")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n    \t",157],["T_COMMENT","\/\/ Read data\n",158],["T_WHITESPACE","       \t",159],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_storageType",159],["T_WHITESPACE"," ",159],["T_IS_EQUAL","==",159],["T_WHITESPACE"," ",159],["T_STRING","self",159],["T_DOUBLE_COLON","::",159],["T_STRING","STORAGE_TYPE_TABLE",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n    \t\t",159],["T_COMMENT","\/\/ In table storage\n",160],["T_WHITESPACE","\t        ",161],["T_TRY","try",161],["T_WHITESPACE","\n\t        ",161],"{",["T_WHITESPACE","\n\t            ",162],["T_VARIABLE","$sessionRecord",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_storage",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","retrieveEntityById",163],"(",["T_WHITESPACE","\n\t                ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_sessionContainer",164],",",["T_WHITESPACE","\n\t                ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_sessionContainerPartition",165],",",["T_WHITESPACE","\n\t                ",165],["T_VARIABLE","$id",166],["T_WHITESPACE","\n\t            ",166],")",";",["T_WHITESPACE","\n\t            ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_STRING","unserialize",168],"(",["T_STRING","base64_decode",168],"(",["T_VARIABLE","$sessionRecord",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","serializedData",168],")",")",";",["T_WHITESPACE","\n\t        ",168],"}",["T_WHITESPACE","\n\t        ",169],["T_CATCH","catch",170],["T_WHITESPACE"," ",170],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$ex",170],")",["T_WHITESPACE","\n\t        ",170],"{",["T_WHITESPACE","\n\t            ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","''",172],";",["T_WHITESPACE","\n\t        ",172],"}",["T_WHITESPACE","\n       \t",173],"}",["T_WHITESPACE"," ",174],["T_ELSE","else",174],["T_WHITESPACE"," ",174],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_storageType",174],["T_WHITESPACE"," ",174],["T_IS_EQUAL","==",174],["T_WHITESPACE"," ",174],["T_STRING","self",174],["T_DOUBLE_COLON","::",174],["T_STRING","STORAGE_TYPE_BLOB",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n    \t\t",174],["T_COMMENT","\/\/ In blob storage\n",175],["T_WHITESPACE","    \t    ",176],["T_TRY","try",176],["T_WHITESPACE","\n\t        ",176],"{",["T_WHITESPACE","\n    \t\t\t",177],["T_VARIABLE","$data",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_storage",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getBlobData",178],"(",["T_WHITESPACE","\n    \t\t\t\t",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_sessionContainer",179],",",["T_WHITESPACE","\n    \t\t\t\t",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_sessionContainerPartition",180],["T_WHITESPACE"," ",180],".",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'\/'",180],["T_WHITESPACE"," ",180],".",["T_WHITESPACE"," ",180],["T_VARIABLE","$id",180],["T_WHITESPACE","\n    \t\t\t",180],")",";",["T_WHITESPACE","\n\t            ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_STRING","unserialize",182],"(",["T_STRING","base64_decode",182],"(",["T_VARIABLE","$data",182],")",")",";",["T_WHITESPACE","\n\t        ",182],"}",["T_WHITESPACE","\n\t        ",183],["T_CATCH","catch",184],["T_WHITESPACE"," ",184],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$ex",184],")",["T_WHITESPACE","\n\t        ",184],"{",["T_WHITESPACE","\n\t            ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_STRING","false",186],";",["T_WHITESPACE","\n\t        ",186],"}",["T_WHITESPACE","\n    \t",187],"}",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n    \n    ",189],["T_DOC_COMMENT","\/**\n     * Write a specific session\n     * \n     * @param int $id Session Id\n     * @param string $serializedData Serialized PHP object\n     * @throws Exception\n     *\/",191],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","write",198],"(",["T_VARIABLE","$id",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$serializedData",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n    \t",199],["T_COMMENT","\/\/ Encode data\n",200],["T_WHITESPACE","    \t",201],["T_VARIABLE","$serializedData",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","base64_encode",201],"(",["T_STRING","serialize",201],"(",["T_VARIABLE","$serializedData",201],")",")",";",["T_WHITESPACE","\n    \t",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_STRING","strlen",202],"(",["T_VARIABLE","$serializedData",202],")",["T_WHITESPACE"," ",202],["T_IS_GREATER_OR_EQUAL",">=",202],["T_WHITESPACE"," ",202],["T_STRING","self",202],["T_DOUBLE_COLON","::",202],["T_STRING","MAX_TS_PROPERTY_SIZE",202],["T_WHITESPACE"," ",202],["T_BOOLEAN_AND","&&",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_storageType",202],["T_WHITESPACE"," ",202],["T_IS_EQUAL","==",202],["T_WHITESPACE"," ",202],["T_STRING","self",202],["T_DOUBLE_COLON","::",202],["T_STRING","STORAGE_TYPE_TABLE",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n    \t\t",202],["T_THROW","throw",203],["T_WHITESPACE"," ",203],["T_NEW","new",203],["T_WHITESPACE"," ",203],["T_STRING","Zend_Service_WindowsAzure_Exception",203],"(",["T_CONSTANT_ENCAPSED_STRING","'Session data exceeds the maximum allowed size of '",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_STRING","self",203],["T_DOUBLE_COLON","::",203],["T_STRING","MAX_TS_PROPERTY_SIZE",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","' bytes that can be stored using table storage. Consider switching to a blob storage back-end or try reducing session data size.'",203],")",";",["T_WHITESPACE","\n    \t",203],"}",["T_WHITESPACE","\n    \t\n    \t",204],["T_COMMENT","\/\/ Store data\n",206],["T_WHITESPACE","       \t",207],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_storageType",207],["T_WHITESPACE"," ",207],["T_IS_EQUAL","==",207],["T_WHITESPACE"," ",207],["T_STRING","self",207],["T_DOUBLE_COLON","::",207],["T_STRING","STORAGE_TYPE_TABLE",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n    \t\t",207],["T_COMMENT","\/\/ In table storage\n",208],["T_WHITESPACE","       \t    ",209],["T_VARIABLE","$sessionRecord",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_NEW","new",209],["T_WHITESPACE"," ",209],["T_STRING","Zend_Service_WindowsAzure_Storage_DynamicTableEntity",209],"(",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_sessionContainerPartition",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$id",209],")",";",["T_WHITESPACE","\n\t        ",209],["T_VARIABLE","$sessionRecord",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","sessionExpires",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_STRING","time",210],"(",")",";",["T_WHITESPACE","\n\t        ",210],["T_VARIABLE","$sessionRecord",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","serializedData",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$serializedData",211],";",["T_WHITESPACE","\n\t        \n\t        ",211],["T_VARIABLE","$sessionRecord",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","setAzurePropertyType",213],"(",["T_CONSTANT_ENCAPSED_STRING","'sessionExpires'",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'Edm.Int32'",213],")",";",["T_WHITESPACE","\n\t\n\t        ",213],["T_TRY","try",215],["T_WHITESPACE","\n\t        ",215],"{",["T_WHITESPACE","\n\t            ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_storage",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","updateEntity",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_sessionContainer",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$sessionRecord",217],")",";",["T_WHITESPACE","\n\t        ",217],"}",["T_WHITESPACE","\n\t        ",218],["T_CATCH","catch",219],["T_WHITESPACE"," ",219],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$unknownRecord",219],")",["T_WHITESPACE","\n\t        ",219],"{",["T_WHITESPACE","\n\t            ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_storage",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","insertEntity",221],"(",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_sessionContainer",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$sessionRecord",221],")",";",["T_WHITESPACE","\n\t        ",221],"}",["T_WHITESPACE","\n    \t",222],"}",["T_WHITESPACE"," ",223],["T_ELSE","else",223],["T_WHITESPACE"," ",223],["T_IF","if",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_storageType",223],["T_WHITESPACE"," ",223],["T_IS_EQUAL","==",223],["T_WHITESPACE"," ",223],["T_STRING","self",223],["T_DOUBLE_COLON","::",223],["T_STRING","STORAGE_TYPE_BLOB",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n    \t\t",223],["T_COMMENT","\/\/ In blob storage\n",224],["T_WHITESPACE","    \t\t",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_storage",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","putBlobData",225],"(",["T_WHITESPACE","\n    \t\t\t",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_sessionContainer",226],",",["T_WHITESPACE","\n    \t\t\t",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_sessionContainerPartition",227],["T_WHITESPACE"," ",227],".",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'\/'",227],["T_WHITESPACE"," ",227],".",["T_WHITESPACE"," ",227],["T_VARIABLE","$id",227],",",["T_WHITESPACE","\n    \t\t\t",227],["T_VARIABLE","$serializedData",228],",",["T_WHITESPACE","\n    \t\t\t",228],["T_ARRAY","array",229],"(",["T_CONSTANT_ENCAPSED_STRING","'sessionexpires'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_STRING","time",229],"(",")",")",["T_WHITESPACE","\n    \t\t",229],")",";",["T_WHITESPACE","\n    \t",230],"}",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n    \n    ",232],["T_DOC_COMMENT","\/**\n     * Destroy a specific session\n     * \n     * @param int $id Session Id\n     * @return boolean\n     *\/",234],["T_WHITESPACE","\n    ",239],["T_PUBLIC","public",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","destroy",240],"(",["T_VARIABLE","$id",240],")",["T_WHITESPACE","\n    ",240],"{",["T_WHITESPACE","\n\t\t",241],["T_COMMENT","\/\/ Destroy data\n",242],["T_WHITESPACE","       \t",243],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_storageType",243],["T_WHITESPACE"," ",243],["T_IS_EQUAL","==",243],["T_WHITESPACE"," ",243],["T_STRING","self",243],["T_DOUBLE_COLON","::",243],["T_STRING","STORAGE_TYPE_TABLE",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n    \t\t",243],["T_COMMENT","\/\/ In table storage\n",244],["T_WHITESPACE","       \t    ",245],["T_TRY","try",245],["T_WHITESPACE","\n\t        ",245],"{",["T_WHITESPACE","\n\t            ",246],["T_VARIABLE","$sessionRecord",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_storage",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","retrieveEntityById",247],"(",["T_WHITESPACE","\n\t                ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_sessionContainer",248],",",["T_WHITESPACE","\n\t                ",248],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_sessionContainerPartition",249],",",["T_WHITESPACE","\n\t                ",249],["T_VARIABLE","$id",250],["T_WHITESPACE","\n\t            ",250],")",";",["T_WHITESPACE","\n\t            ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_storage",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","deleteEntity",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_sessionContainer",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$sessionRecord",252],")",";",["T_WHITESPACE","\n\t            \n\t            ",252],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_STRING","true",254],";",["T_WHITESPACE","\n\t        ",254],"}",["T_WHITESPACE","\n\t        ",255],["T_CATCH","catch",256],["T_WHITESPACE"," ",256],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$ex",256],")",["T_WHITESPACE","\n\t        ",256],"{",["T_WHITESPACE","\n\t            ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_STRING","false",258],";",["T_WHITESPACE","\n\t        ",258],"}",["T_WHITESPACE","\n    \t",259],"}",["T_WHITESPACE"," ",260],["T_ELSE","else",260],["T_WHITESPACE"," ",260],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_storageType",260],["T_WHITESPACE"," ",260],["T_IS_EQUAL","==",260],["T_WHITESPACE"," ",260],["T_STRING","self",260],["T_DOUBLE_COLON","::",260],["T_STRING","STORAGE_TYPE_BLOB",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n    \t\t",260],["T_COMMENT","\/\/ In blob storage\n",261],["T_WHITESPACE","    \t    ",262],["T_TRY","try",262],["T_WHITESPACE","\n\t        ",262],"{",["T_WHITESPACE","\n    \t\t\t",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_storage",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","deleteBlob",264],"(",["T_WHITESPACE","\n    \t\t\t\t",264],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_sessionContainer",265],",",["T_WHITESPACE","\n    \t\t\t\t",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_sessionContainerPartition",266],["T_WHITESPACE"," ",266],".",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'\/'",266],["T_WHITESPACE"," ",266],".",["T_WHITESPACE"," ",266],["T_VARIABLE","$id",266],["T_WHITESPACE","\n    \t\t\t",266],")",";",["T_WHITESPACE","\n\t            \n\t            ",267],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_STRING","true",269],";",["T_WHITESPACE","\n\t        ",269],"}",["T_WHITESPACE","\n\t        ",270],["T_CATCH","catch",271],["T_WHITESPACE"," ",271],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$ex",271],")",["T_WHITESPACE","\n\t        ",271],"{",["T_WHITESPACE","\n\t            ",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_STRING","false",273],";",["T_WHITESPACE","\n\t        ",273],"}",["T_WHITESPACE","\n    \t",274],"}",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n    \n    ",276],["T_DOC_COMMENT","\/**\n     * Garbage collector\n     * \n     * @param int $lifeTime Session maximal lifetime\n     * @see session.gc_divisor  100\n     * @see session.gc_maxlifetime 1440\n     * @see session.gc_probability 1\n     * @usage Execution rate 1\/100 (session.gc_probability\/session.gc_divisor)\n     * @return boolean\n     *\/",278],["T_WHITESPACE","\n    ",287],["T_PUBLIC","public",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","gc",288],"(",["T_VARIABLE","$lifeTime",288],")",["T_WHITESPACE","\n    ",288],"{",["T_WHITESPACE","\n       \t",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_storageType",290],["T_WHITESPACE"," ",290],["T_IS_EQUAL","==",290],["T_WHITESPACE"," ",290],["T_STRING","self",290],["T_DOUBLE_COLON","::",290],["T_STRING","STORAGE_TYPE_TABLE",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n    \t\t",290],["T_COMMENT","\/\/ In table storage\n",291],["T_WHITESPACE","       \t    ",292],["T_TRY","try",292],["T_WHITESPACE","\n\t        ",292],"{",["T_WHITESPACE","\n\t            ",293],["T_VARIABLE","$result",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_storage",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","retrieveEntities",294],"(",["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_sessionContainer",294],",",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'PartitionKey eq \\''",294],["T_WHITESPACE"," ",294],".",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_sessionContainerPartition",294],["T_WHITESPACE"," ",294],".",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'\\' and sessionExpires lt '",294],["T_WHITESPACE"," ",294],".",["T_WHITESPACE"," ",294],"(",["T_STRING","time",294],"(",")",["T_WHITESPACE"," ",294],"-",["T_WHITESPACE"," ",294],["T_VARIABLE","$lifeTime",294],")",")",";",["T_WHITESPACE","\n\t            ",294],["T_FOREACH","foreach",295],["T_WHITESPACE"," ",295],"(",["T_VARIABLE","$result",295],["T_WHITESPACE"," ",295],["T_AS","as",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$sessionRecord",295],")",["T_WHITESPACE","\n\t            ",295],"{",["T_WHITESPACE","\n\t                ",296],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_storage",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","deleteEntity",297],"(",["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_sessionContainer",297],",",["T_WHITESPACE"," ",297],["T_VARIABLE","$sessionRecord",297],")",";",["T_WHITESPACE","\n\t            ",297],"}",["T_WHITESPACE","\n\t            ",298],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_STRING","true",299],";",["T_WHITESPACE","\n\t        ",299],"}",["T_WHITESPACE","\n\t        ",300],["T_CATCH","catch",301],["T_WHITESPACE"," ",301],"(",["T_STRING","Zend_Service_WindowsAzure_exception",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$ex",301],")",["T_WHITESPACE","\n\t        ",301],"{",["T_WHITESPACE","\n\t            ",302],["T_RETURN","return",303],["T_WHITESPACE"," ",303],["T_STRING","false",303],";",["T_WHITESPACE","\n\t        ",303],"}",["T_WHITESPACE","\n    \t",304],"}",["T_WHITESPACE"," ",305],["T_ELSE","else",305],["T_WHITESPACE"," ",305],["T_IF","if",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","_storageType",305],["T_WHITESPACE"," ",305],["T_IS_EQUAL","==",305],["T_WHITESPACE"," ",305],["T_STRING","self",305],["T_DOUBLE_COLON","::",305],["T_STRING","STORAGE_TYPE_BLOB",305],")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n    \t\t",305],["T_COMMENT","\/\/ In blob storage\n",306],["T_WHITESPACE","    \t    ",307],["T_TRY","try",307],["T_WHITESPACE","\n\t        ",307],"{",["T_WHITESPACE","\n\t            ",308],["T_VARIABLE","$result",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_storage",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","listBlobs",309],"(",["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_sessionContainer",309],",",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_sessionContainerPartition",309],",",["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","''",309],",",["T_WHITESPACE"," ",309],["T_STRING","null",309],",",["T_WHITESPACE"," ",309],["T_STRING","null",309],",",["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'metadata'",309],")",";",["T_WHITESPACE","\n\t            ",309],["T_FOREACH","foreach",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$result",310],["T_WHITESPACE"," ",310],["T_AS","as",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$sessionRecord",310],")",["T_WHITESPACE","\n\t            ",310],"{",["T_WHITESPACE","\n\t            \t",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$sessionRecord",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","Metadata",312],"[",["T_CONSTANT_ENCAPSED_STRING","'sessionexpires'",312],"]",["T_WHITESPACE"," ",312],"<",["T_WHITESPACE"," ",312],"(",["T_STRING","time",312],"(",")",["T_WHITESPACE"," ",312],"-",["T_WHITESPACE"," ",312],["T_VARIABLE","$lifeTime",312],")",")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n\t                \t",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_storage",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","deleteBlob",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_sessionContainer",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$sessionRecord",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","Name",313],")",";",["T_WHITESPACE","\n\t            \t",313],"}",["T_WHITESPACE","\n\t            ",314],"}",["T_WHITESPACE","\n\t            ",315],["T_RETURN","return",316],["T_WHITESPACE"," ",316],["T_STRING","true",316],";",["T_WHITESPACE","\n\t        ",316],"}",["T_WHITESPACE","\n\t        ",317],["T_CATCH","catch",318],["T_WHITESPACE"," ",318],"(",["T_STRING","Zend_Service_WindowsAzure_exception",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$ex",318],")",["T_WHITESPACE","\n\t        ",318],"{",["T_WHITESPACE","\n\t            ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_STRING","false",320],";",["T_WHITESPACE","\n\t        ",320],"}",["T_WHITESPACE","\n    \t",321],"}",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n",323],"}",["T_WHITESPACE","\n",324]]