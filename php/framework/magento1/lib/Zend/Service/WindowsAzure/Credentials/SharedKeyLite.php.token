[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * @see Zend_Service_WindowsAzure_Credentials_CredentialsAbstract\n *\/",22],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Credentials\/CredentialsAbstract.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/**\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",27],["T_WHITESPACE"," \n",32],["T_CLASS","class",33],["T_WHITESPACE"," ",33],["T_STRING","Zend_Service_WindowsAzure_Credentials_SharedKeyLite",33],["T_WHITESPACE","\n    ",33],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n\t * Sign request URL with credentials\n\t *\n\t * @param string $requestUrl Request URL\n\t * @param string $resourceType Resource type\n\t * @param string $requiredPermission Required permission\n\t * @return string Signed request URL\n\t *\/",36],["T_WHITESPACE","\n\t",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","signRequestUrl",44],"(",["T_WHITESPACE","\n\t\t",44],["T_VARIABLE","$requestUrl",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","''",45],",",["T_WHITESPACE","\n\t\t",45],["T_VARIABLE","$resourceType",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","Zend_Service_WindowsAzure_Storage",46],["T_DOUBLE_COLON","::",46],["T_STRING","RESOURCE_UNKNOWN",46],",",["T_WHITESPACE","\n\t\t",46],["T_VARIABLE","$requiredPermission",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",47],["T_DOUBLE_COLON","::",47],["T_STRING","PERMISSION_READ",47],["T_WHITESPACE","\n\t",47],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n\t    ",48],["T_RETURN","return",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$requestUrl",49],";",["T_WHITESPACE","\n\t",49],"}",["T_WHITESPACE","\n\t\n\t",50],["T_DOC_COMMENT","\/**\n\t * Sign request headers with credentials\n\t *\n\t * @param string $httpVerb HTTP verb the request will use\n\t * @param string $path Path for the request\n\t * @param string $queryString Query string for the request\n\t * @param array $headers x-ms headers to add\n\t * @param boolean $forTableStorage Is the request for table storage?\n\t * @param string $resourceType Resource type\n\t * @param string $requiredPermission Required permission\n\t * @param mixed  $rawData Raw post data\n\t * @return array Array of headers\n\t *\/",52],["T_WHITESPACE","\n\t",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","signRequestHeaders",65],"(",["T_WHITESPACE","\n\t\t",65],["T_VARIABLE","$httpVerb",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Zend_Http_Client",66],["T_DOUBLE_COLON","::",66],["T_STRING","GET",66],",",["T_WHITESPACE","\n\t\t",66],["T_VARIABLE","$path",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'\/'",67],",",["T_WHITESPACE","\n\t\t",67],["T_VARIABLE","$queryString",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","''",68],",",["T_WHITESPACE","\n\t\t",68],["T_VARIABLE","$headers",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_STRING","null",69],",",["T_WHITESPACE","\n\t\t",69],["T_VARIABLE","$forTableStorage",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","false",70],",",["T_WHITESPACE","\n\t\t",70],["T_VARIABLE","$resourceType",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","Zend_Service_WindowsAzure_Storage",71],["T_DOUBLE_COLON","::",71],["T_STRING","RESOURCE_UNKNOWN",71],",",["T_WHITESPACE","\n\t\t",71],["T_VARIABLE","$requiredPermission",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",72],["T_DOUBLE_COLON","::",72],["T_STRING","PERMISSION_READ",72],",",["T_WHITESPACE","\n\t\t",72],["T_VARIABLE","$rawData",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","null",73],["T_WHITESPACE","\n\t",73],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t",74],["T_COMMENT","\/\/ Table storage?\n",75],["T_WHITESPACE","\t\t",76],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_VARIABLE","$forTableStorage",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n\t\t\t",76],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Credentials\/Exception.php';\n",77],["T_WHITESPACE","\t\t\t",78],["T_THROW","throw",78],["T_WHITESPACE"," ",78],["T_NEW","new",78],["T_WHITESPACE"," ",78],["T_STRING","Zend_Service_WindowsAzure_Credentials_Exception",78],"(",["T_CONSTANT_ENCAPSED_STRING","'The Windows Azure SDK for PHP does not support SharedKeyLite authentication on blob or queue storage. Use SharedKey authentication instead.'",78],")",";",["T_WHITESPACE","\n\t\t",78],"}",["T_WHITESPACE","\n\t\t\n\t\t",79],["T_COMMENT","\/\/ Determine path\n",81],["T_WHITESPACE","\t\t",82],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_usePathStyleUri",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n\t\t\t",82],["T_VARIABLE","$path",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","substr",83],"(",["T_VARIABLE","$path",83],",",["T_WHITESPACE"," ",83],["T_STRING","strpos",83],"(",["T_VARIABLE","$path",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'\/'",83],")",")",";",["T_WHITESPACE","\n\t\t",83],"}",["T_WHITESPACE","\n\n\t\t",84],["T_COMMENT","\/\/ Determine query\n",86],["T_WHITESPACE","\t\t",87],["T_VARIABLE","$queryString",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_prepareQueryStringForSigning",87],"(",["T_VARIABLE","$queryString",87],")",";",["T_WHITESPACE","\n\n\t\t",87],["T_COMMENT","\/\/ Build canonicalized resource string\n",89],["T_WHITESPACE","\t\t",90],["T_VARIABLE","$canonicalizedResource",90],["T_WHITESPACE","  ",90],"=",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'\/'",90],["T_WHITESPACE"," ",90],".",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_accountName",90],";",["T_WHITESPACE","\n\t\t",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_usePathStyleUri",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n\t\t\t",91],["T_VARIABLE","$canonicalizedResource",92],["T_WHITESPACE"," ",92],["T_CONCAT_EQUAL",".=",92],["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'\/'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_accountName",92],";",["T_WHITESPACE","\n\t\t",92],"}",["T_WHITESPACE","\n\t\t",93],["T_VARIABLE","$canonicalizedResource",94],["T_WHITESPACE"," ",94],["T_CONCAT_EQUAL",".=",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$path",94],";",["T_WHITESPACE","\n\t\t",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$queryString",95],["T_WHITESPACE"," ",95],["T_IS_NOT_IDENTICAL","!==",95],["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","''",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n\t\t    ",95],["T_VARIABLE","$canonicalizedResource",96],["T_WHITESPACE"," ",96],["T_CONCAT_EQUAL",".=",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$queryString",96],";",["T_WHITESPACE","\n\t\t",96],"}",["T_WHITESPACE","\n\n\t\t",97],["T_COMMENT","\/\/ Request date\n",99],["T_WHITESPACE","\t\t",100],["T_VARIABLE","$requestDate",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","''",100],";",["T_WHITESPACE","\n\t\t",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_ISSET","isset",101],"(",["T_VARIABLE","$headers",101],"[",["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",101],["T_DOUBLE_COLON","::",101],["T_STRING","PREFIX_STORAGE_HEADER",101],["T_WHITESPACE"," ",101],".",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'date'",101],"]",")",")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n\t\t    ",101],["T_VARIABLE","$requestDate",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$headers",102],"[",["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",102],["T_DOUBLE_COLON","::",102],["T_STRING","PREFIX_STORAGE_HEADER",102],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'date'",102],"]",";",["T_WHITESPACE","\n\t\t",102],"}",["T_WHITESPACE"," ",103],["T_ELSE","else",103],["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n\t\t    ",103],["T_VARIABLE","$requestDate",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","gmdate",104],"(",["T_CONSTANT_ENCAPSED_STRING","'D, d M Y H:i:s'",104],",",["T_WHITESPACE"," ",104],["T_STRING","time",104],"(",")",")",["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","' GMT'",104],";",["T_WHITESPACE"," ",104],["T_COMMENT","\/\/ RFC 1123\n",104],["T_WHITESPACE","\t\t",105],"}",["T_WHITESPACE","\n\n\t\t",105],["T_COMMENT","\/\/ Create string to sign   \n",107],["T_WHITESPACE","\t\t",108],["T_VARIABLE","$stringToSign",108],["T_WHITESPACE","   ",108],"=",["T_WHITESPACE"," ",108],["T_ARRAY","array",108],"(",")",";",["T_WHITESPACE","\n    \t",108],["T_VARIABLE","$stringToSign",109],"[","]",["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$requestDate",109],";",["T_WHITESPACE"," ",109],["T_COMMENT","\/\/ Date\n",109],["T_WHITESPACE","    \t",110],["T_VARIABLE","$stringToSign",110],"[","]",["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$canonicalizedResource",110],";",["T_WHITESPACE","\t\t \t\t\t",110],["T_COMMENT","\/\/ Canonicalized resource\n",110],["T_WHITESPACE","    \t",111],["T_VARIABLE","$stringToSign",111],["T_WHITESPACE","   ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","implode",111],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$stringToSign",111],")",";",["T_WHITESPACE","\n    \t",111],["T_VARIABLE","$signString",112],["T_WHITESPACE","     ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","base64_encode",112],"(",["T_STRING","hash_hmac",112],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$stringToSign",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_accountKey",112],",",["T_WHITESPACE"," ",112],["T_STRING","true",112],")",")",";",["T_WHITESPACE","\n\n    \t",112],["T_COMMENT","\/\/ Sign request\n",114],["T_WHITESPACE","    \t",115],["T_VARIABLE","$headers",115],"[",["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",115],["T_DOUBLE_COLON","::",115],["T_STRING","PREFIX_STORAGE_HEADER",115],["T_WHITESPACE"," ",115],".",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'date'",115],"]",["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$requestDate",115],";",["T_WHITESPACE","\n    \t",115],["T_VARIABLE","$headers",116],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",116],"]",["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'SharedKeyLite '",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_accountName",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","':'",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_VARIABLE","$signString",116],";",["T_WHITESPACE","\n    \t\n    \t",116],["T_COMMENT","\/\/ Return headers\n",118],["T_WHITESPACE","    \t",119],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$headers",119],";",["T_WHITESPACE","\n\t",119],"}",["T_WHITESPACE","\n\t\n\t",120],["T_DOC_COMMENT","\/**\n\t * Prepare query string for signing\n\t * \n\t * @param  string $value Original query string\n\t * @return string        Query string for signing\n\t *\/",122],["T_WHITESPACE","\n\t",127],["T_PROTECTED","protected",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","_prepareQueryStringForSigning",128],"(",["T_VARIABLE","$value",128],")",["T_WHITESPACE","\n\t",128],"{",["T_WHITESPACE","\n\t    ",129],["T_COMMENT","\/\/ Check for 'comp='\n",130],["T_WHITESPACE","\t    ",131],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","strpos",131],"(",["T_VARIABLE","$value",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'comp='",131],")",["T_WHITESPACE"," ",131],["T_IS_IDENTICAL","===",131],["T_WHITESPACE"," ",131],["T_STRING","false",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n\t        ",131],["T_COMMENT","\/\/ If not found, no query string needed\n",132],["T_WHITESPACE","\t        ",133],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","''",133],";",["T_WHITESPACE","\n\t    ",133],"}",["T_WHITESPACE"," ",134],["T_ELSE","else",134],["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n\t        ",134],["T_COMMENT","\/\/ If found, make sure it is the only parameter being used      \n",135],["T_WHITESPACE","    \t\t",136],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_STRING","strlen",136],"(",["T_VARIABLE","$value",136],")",["T_WHITESPACE"," ",136],">",["T_WHITESPACE"," ",136],["T_LNUMBER","0",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_STRING","strpos",136],"(",["T_VARIABLE","$value",136],",",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'?'",136],")",["T_WHITESPACE"," ",136],["T_IS_IDENTICAL","===",136],["T_WHITESPACE"," ",136],["T_LNUMBER","0",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n    \t\t\t",136],["T_VARIABLE","$value",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","substr",137],"(",["T_VARIABLE","$value",137],",",["T_WHITESPACE"," ",137],["T_LNUMBER","1",137],")",";",["T_WHITESPACE","\n    \t\t",137],"}",["T_WHITESPACE","\n    \t\t\n    \t\t",138],["T_COMMENT","\/\/ Split parts\n",140],["T_WHITESPACE","    \t\t",141],["T_VARIABLE","$queryParts",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","explode",141],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$value",141],")",";",["T_WHITESPACE","\n    \t\t",141],["T_FOREACH","foreach",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$queryParts",142],["T_WHITESPACE"," ",142],["T_AS","as",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$queryPart",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n    \t\t    ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_STRING","strpos",143],"(",["T_VARIABLE","$queryPart",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'comp='",143],")",["T_WHITESPACE"," ",143],["T_IS_NOT_IDENTICAL","!==",143],["T_WHITESPACE"," ",143],["T_STRING","false",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n    \t\t        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'?'",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_VARIABLE","$queryPart",144],";",["T_WHITESPACE","\n    \t\t    ",144],"}",["T_WHITESPACE","\n    \t\t",145],"}",["T_WHITESPACE","\n\n    \t\t",146],["T_COMMENT","\/\/ Should never happen...\n",148],["T_WHITESPACE","\t\t\t",149],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","''",149],";",["T_WHITESPACE","\n\t    ",149],"}",["T_WHITESPACE","\n\t",150],"}",["T_WHITESPACE","\n",151],"}",["T_WHITESPACE","\n",152]]