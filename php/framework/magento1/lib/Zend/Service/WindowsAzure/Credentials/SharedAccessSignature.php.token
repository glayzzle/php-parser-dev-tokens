[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * @see Zend_Service_WindowsAzure_Credentials_CredentialsAbstract\n *\/",22],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Credentials\/CredentialsAbstract.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/**\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",27],["T_WHITESPACE"," \n",32],["T_CLASS","class",33],["T_WHITESPACE"," ",33],["T_STRING","Zend_Service_WindowsAzure_Credentials_SharedAccessSignature",33],["T_WHITESPACE","\n    ",33],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Permission set\n     * \n     * @var array\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_permissionSet",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",")",";",["T_WHITESPACE","\n    \n\t",41],["T_DOC_COMMENT","\/**\n\t * Creates a new Zend_Service_WindowsAzure_Credentials_SharedAccessSignature instance\n\t *\n\t * @param string $accountName Account name for Windows Azure\n\t * @param string $accountKey Account key for Windows Azure\n\t * @param boolean $usePathStyleUri Use path-style URI's\n\t * @param array $permissionSet Permission set\n\t *\/",43],["T_WHITESPACE","\n\t",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","__construct",51],"(",["T_WHITESPACE","\n\t\t",51],["T_VARIABLE","$accountName",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",52],["T_DOUBLE_COLON","::",52],["T_STRING","DEVSTORE_ACCOUNT",52],",",["T_WHITESPACE","\n\t\t",52],["T_VARIABLE","$accountKey",53],["T_WHITESPACE","  ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",53],["T_DOUBLE_COLON","::",53],["T_STRING","DEVSTORE_KEY",53],",",["T_WHITESPACE","\n\t\t",53],["T_VARIABLE","$usePathStyleUri",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","false",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$permissionSet",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_ARRAY","array",54],"(",")",["T_WHITESPACE","\n\t",54],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n\t    ",55],["T_STRING","parent",56],["T_DOUBLE_COLON","::",56],["T_STRING","__construct",56],"(",["T_VARIABLE","$accountName",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$accountKey",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$usePathStyleUri",56],")",";",["T_WHITESPACE","\n\t    ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_permissionSet",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$permissionSet",57],";",["T_WHITESPACE","\n\t",57],"}",["T_WHITESPACE","\n\t\n\t",58],["T_DOC_COMMENT","\/**\n\t * Get permission set\n\t * \n\t * @return array\n\t *\/",60],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getPermissionSet",65],"(",")",["T_WHITESPACE","\n\t",65],"{",["T_WHITESPACE","\n\t    ",66],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_permissionSet",67],";",["T_WHITESPACE","   \n\t",67],"}",["T_WHITESPACE","\n\t\n\t",68],["T_DOC_COMMENT","\/**\n\t * Set permisison set\n\t * \n\t * Warning: fine-grained permissions should be added prior to coarse-grained permissions.\n\t * For example: first add blob permissions, end with container-wide permissions.\n\t * \n\t * Warning: the signed access signature URL must match the account name of the\n\t * Zend_Service_WindowsAzure_Credentials_Zend_Service_WindowsAzure_Credentials_SharedAccessSignature instance\n\t * \n\t * @param  array $value Permission set\n\t * @return void\n\t *\/",70],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","setPermissionSet",82],"(",["T_VARIABLE","$value",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_ARRAY","array",82],"(",")",")",["T_WHITESPACE","\n\t",82],"{",["T_WHITESPACE","\n\t\t",83],["T_FOREACH","foreach",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$value",84],["T_WHITESPACE"," ",84],["T_AS","as",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$url",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n\t\t\t",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_STRING","strpos",85],"(",["T_VARIABLE","$url",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_accountName",85],")",["T_WHITESPACE"," ",85],["T_IS_IDENTICAL","===",85],["T_WHITESPACE"," ",85],["T_STRING","false",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n\t\t\t\t",85],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Exception.php';\n",86],["T_WHITESPACE","\t\t\t\t",87],["T_THROW","throw",87],["T_WHITESPACE"," ",87],["T_NEW","new",87],["T_WHITESPACE"," ",87],["T_STRING","Zend_Service_WindowsAzure_Exception",87],"(",["T_CONSTANT_ENCAPSED_STRING","'The permission set can only contain URLs for the account name specified in the Zend_Service_WindowsAzure_Credentials_SharedAccessSignature instance.'",87],")",";",["T_WHITESPACE","\n\t\t\t",87],"}",["T_WHITESPACE","\n\t\t",88],"}",["T_WHITESPACE","\n\t    ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_permissionSet",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$value",90],";",["T_WHITESPACE","\n\t",90],"}",["T_WHITESPACE","\n    \n    ",91],["T_DOC_COMMENT","\/**\n     * Create signature\n     * \n     * @param string $path \t\t   Path for the request\n     * @param string $resource     Signed resource - container (c) - blob (b)\n     * @param string $permissions  Signed permissions - read (r), write (w), delete (d) and list (l)\n     * @param string $start        The time at which the Shared Access Signature becomes valid.\n     * @param string $expiry       The time at which the Shared Access Signature becomes invalid.\n     * @param string $identifier   Signed identifier\n     * @return string \n     *\/",93],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","createSignature",104],"(",["T_WHITESPACE","\n    \t",104],["T_VARIABLE","$path",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'\/'",105],",",["T_WHITESPACE","\n    \t",105],["T_VARIABLE","$resource",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'b'",106],",",["T_WHITESPACE","\n    \t",106],["T_VARIABLE","$permissions",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'r'",107],",",["T_WHITESPACE","\n    \t",107],["T_VARIABLE","$start",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","''",108],",",["T_WHITESPACE","\n    \t",108],["T_VARIABLE","$expiry",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","''",109],",",["T_WHITESPACE","\n    \t",109],["T_VARIABLE","$identifier",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","''",110],["T_WHITESPACE","\n    ",110],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n\t\t",111],["T_COMMENT","\/\/ Determine path\n",112],["T_WHITESPACE","\t\t",113],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_usePathStyleUri",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n\t\t\t",113],["T_VARIABLE","$path",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","substr",114],"(",["T_VARIABLE","$path",114],",",["T_WHITESPACE"," ",114],["T_STRING","strpos",114],"(",["T_VARIABLE","$path",114],",",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'\/'",114],")",")",";",["T_WHITESPACE","\n\t\t",114],"}",["T_WHITESPACE","\n\t\t\t\n\t\t",115],["T_COMMENT","\/\/ Add trailing slash to $path\n",117],["T_WHITESPACE","\t\t",118],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_STRING","substr",118],"(",["T_VARIABLE","$path",118],",",["T_WHITESPACE"," ",118],["T_LNUMBER","0",118],",",["T_WHITESPACE"," ",118],["T_LNUMBER","1",118],")",["T_WHITESPACE"," ",118],["T_IS_NOT_IDENTICAL","!==",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'\/'",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n\t\t    ",118],["T_VARIABLE","$path",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'\/'",119],["T_WHITESPACE"," ",119],".",["T_WHITESPACE"," ",119],["T_VARIABLE","$path",119],";",["T_WHITESPACE","\n\t\t",119],"}",["T_WHITESPACE","\n\n\t\t",120],["T_COMMENT","\/\/ Build canonicalized resource string\n",122],["T_WHITESPACE","\t\t",123],["T_VARIABLE","$canonicalizedResource",123],["T_WHITESPACE","  ",123],"=",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'\/'",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_accountName",123],";",["T_WHITESPACE","\n\t\t",123],["T_COMMENT","\/*if ($this->_usePathStyleUri) {\n\t\t\t$canonicalizedResource .= '\/' . $this->_accountName;\n\t\t}*\/",124],["T_WHITESPACE","\n\t\t",126],["T_VARIABLE","$canonicalizedResource",127],["T_WHITESPACE"," ",127],["T_CONCAT_EQUAL",".=",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$path",127],";",["T_WHITESPACE","\n\t\t    \n\t\t",127],["T_COMMENT","\/\/ Create string to sign   \n",129],["T_WHITESPACE","\t\t",130],["T_VARIABLE","$stringToSign",130],["T_WHITESPACE","   ",130],"=",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",")",";",["T_WHITESPACE","\n\t\t",130],["T_VARIABLE","$stringToSign",131],"[","]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$permissions",131],";",["T_WHITESPACE","\n    \t",131],["T_VARIABLE","$stringToSign",132],"[","]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$start",132],";",["T_WHITESPACE","\n    \t",132],["T_VARIABLE","$stringToSign",133],"[","]",["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$expiry",133],";",["T_WHITESPACE","\n    \t",133],["T_VARIABLE","$stringToSign",134],"[","]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$canonicalizedResource",134],";",["T_WHITESPACE","\n    \t",134],["T_VARIABLE","$stringToSign",135],"[","]",["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$identifier",135],";",["T_WHITESPACE","\n\n    \t",135],["T_VARIABLE","$stringToSign",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","implode",137],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$stringToSign",137],")",";",["T_WHITESPACE","\n    \t",137],["T_VARIABLE","$signature",138],["T_WHITESPACE","    ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","base64_encode",138],"(",["T_STRING","hash_hmac",138],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$stringToSign",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_accountKey",138],",",["T_WHITESPACE"," ",138],["T_STRING","true",138],")",")",";",["T_WHITESPACE","\n\t\n    \t",138],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$signature",140],";",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n\n    ",141],["T_DOC_COMMENT","\/**\n     * Create signed query string\n     * \n     * @param string $path \t\t   Path for the request\n     * @param string $queryString  Query string for the request\n     * @param string $resource     Signed resource - container (c) - blob (b)\n     * @param string $permissions  Signed permissions - read (r), write (w), delete (d) and list (l)\n     * @param string $start        The time at which the Shared Access Signature becomes valid.\n     * @param string $expiry       The time at which the Shared Access Signature becomes invalid.\n     * @param string $identifier   Signed identifier\n     * @return string \n     *\/",143],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","createSignedQueryString",155],"(",["T_WHITESPACE","\n    \t",155],["T_VARIABLE","$path",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'\/'",156],",",["T_WHITESPACE","\n    \t",156],["T_VARIABLE","$queryString",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","''",157],",",["T_WHITESPACE","\n    \t",157],["T_VARIABLE","$resource",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'b'",158],",",["T_WHITESPACE","\n    \t",158],["T_VARIABLE","$permissions",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'r'",159],",",["T_WHITESPACE","\n    \t",159],["T_VARIABLE","$start",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","''",160],",",["T_WHITESPACE","\n    \t",160],["T_VARIABLE","$expiry",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","''",161],",",["T_WHITESPACE","\n    \t",161],["T_VARIABLE","$identifier",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","''",162],["T_WHITESPACE","\n    ",162],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n        ",163],["T_COMMENT","\/\/ Parts\n",164],["T_WHITESPACE","        ",165],["T_VARIABLE","$parts",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",")",";",["T_WHITESPACE","\n        ",165],["T_IF","if",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$start",166],["T_WHITESPACE"," ",166],["T_IS_NOT_IDENTICAL","!==",166],["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","''",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$parts",167],"[","]",["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'st='",167],["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_STRING","urlencode",167],"(",["T_VARIABLE","$start",167],")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$parts",169],"[","]",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'se='",169],["T_WHITESPACE"," ",169],".",["T_WHITESPACE"," ",169],["T_STRING","urlencode",169],"(",["T_VARIABLE","$expiry",169],")",";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$parts",170],"[","]",["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'sr='",170],["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],["T_VARIABLE","$resource",170],";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$parts",171],"[","]",["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'sp='",171],["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_VARIABLE","$permissions",171],";",["T_WHITESPACE","\n        ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$identifier",172],["T_WHITESPACE"," ",172],["T_IS_NOT_IDENTICAL","!==",172],["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","''",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$parts",173],"[","]",["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'si='",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_STRING","urlencode",173],"(",["T_VARIABLE","$identifier",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$parts",175],"[","]",["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'sig='",175],["T_WHITESPACE"," ",175],".",["T_WHITESPACE"," ",175],["T_STRING","urlencode",175],"(",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","createSignature",175],"(",["T_VARIABLE","$path",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$resource",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$permissions",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$start",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$expiry",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$identifier",175],")",")",";",["T_WHITESPACE","\n\n        ",175],["T_COMMENT","\/\/ Assemble parts and query string\n",177],["T_WHITESPACE","        ",178],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$queryString",178],["T_WHITESPACE"," ",178],["T_IS_NOT_EQUAL","!=",178],["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","''",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$queryString",179],["T_WHITESPACE"," ",179],["T_CONCAT_EQUAL",".=",179],["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'&'",179],";",["T_WHITESPACE","\n\t    ",179],"}",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$queryString",181],["T_WHITESPACE"," ",181],["T_CONCAT_EQUAL",".=",181],["T_WHITESPACE"," ",181],["T_STRING","implode",181],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$parts",181],")",";",["T_WHITESPACE","\n\n        ",181],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$queryString",183],";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n    \n    ",184],["T_DOC_COMMENT","\/**\n\t * Permission matches request?\n\t *\n\t * @param string $permissionUrl Permission URL\n\t * @param string $requestUrl Request URL\n\t * @param string $resourceType Resource type\n\t * @param string $requiredPermission Required permission\n\t * @return string Signed request URL\n\t *\/",186],["T_WHITESPACE","\n    ",194],["T_PUBLIC","public",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","permissionMatchesRequest",195],"(",["T_WHITESPACE","\n    \t",195],["T_VARIABLE","$permissionUrl",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","''",196],",",["T_WHITESPACE","\n    \t",196],["T_VARIABLE","$requestUrl",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","''",197],",",["T_WHITESPACE","\n    \t",197],["T_VARIABLE","$resourceType",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","Zend_Service_WindowsAzure_Storage",198],["T_DOUBLE_COLON","::",198],["T_STRING","RESOURCE_UNKNOWN",198],",",["T_WHITESPACE","\n    \t",198],["T_VARIABLE","$requiredPermission",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",199],["T_DOUBLE_COLON","::",199],["T_STRING","PERMISSION_READ",199],["T_WHITESPACE","\n    ",199],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n        ",200],["T_COMMENT","\/\/ Build requirements\n",201],["T_WHITESPACE","        ",202],["T_VARIABLE","$requiredResourceType",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$resourceType",202],";",["T_WHITESPACE","\n        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$requiredResourceType",203],["T_WHITESPACE"," ",203],["T_IS_EQUAL","==",203],["T_WHITESPACE"," ",203],["T_STRING","Zend_Service_WindowsAzure_Storage",203],["T_DOUBLE_COLON","::",203],["T_STRING","RESOURCE_BLOB",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$requiredResourceType",204],["T_WHITESPACE"," ",204],["T_CONCAT_EQUAL",".=",204],["T_WHITESPACE"," ",204],["T_STRING","Zend_Service_WindowsAzure_Storage",204],["T_DOUBLE_COLON","::",204],["T_STRING","RESOURCE_CONTAINER",204],";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n\n        ",205],["T_COMMENT","\/\/ Parse permission url\n",207],["T_WHITESPACE","\t    ",208],["T_VARIABLE","$parsedPermissionUrl",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","parse_url",208],"(",["T_VARIABLE","$permissionUrl",208],")",";",["T_WHITESPACE","\n\t    \n\t    ",208],["T_COMMENT","\/\/ Parse permission properties\n",210],["T_WHITESPACE","\t    ",211],["T_VARIABLE","$permissionParts",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","explode",211],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$parsedPermissionUrl",211],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",211],"]",")",";",["T_WHITESPACE","\n\t    \n\t    ",211],["T_COMMENT","\/\/ Parse request url\n",213],["T_WHITESPACE","\t    ",214],["T_VARIABLE","$parsedRequestUrl",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_STRING","parse_url",214],"(",["T_VARIABLE","$requestUrl",214],")",";",["T_WHITESPACE","\n\t    \n\t    ",214],["T_COMMENT","\/\/ Check if permission matches request\n",216],["T_WHITESPACE","\t    ",217],["T_VARIABLE","$matches",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","true",217],";",["T_WHITESPACE","\n\t    ",217],["T_FOREACH","foreach",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$permissionParts",218],["T_WHITESPACE"," ",218],["T_AS","as",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$part",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n\t        ",218],["T_LIST","list",219],"(",["T_VARIABLE","$property",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$value",219],")",["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","explode",219],"(",["T_CONSTANT_ENCAPSED_STRING","'='",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$part",219],",",["T_WHITESPACE"," ",219],["T_LNUMBER","2",219],")",";",["T_WHITESPACE","\n\t        \n\t        ",219],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$property",221],["T_WHITESPACE"," ",221],["T_IS_EQUAL","==",221],["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'sr'",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n\t            ",221],["T_VARIABLE","$matches",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$matches",222],["T_WHITESPACE"," ",222],["T_BOOLEAN_AND","&&",222],["T_WHITESPACE"," ",222],"(",["T_STRING","strpbrk",222],"(",["T_VARIABLE","$value",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$requiredResourceType",222],")",["T_WHITESPACE"," ",222],["T_IS_NOT_IDENTICAL","!==",222],["T_WHITESPACE"," ",222],["T_STRING","false",222],")",";",["T_WHITESPACE","\n\t        ",222],"}",["T_WHITESPACE","\n\t        \n\t    \t",223],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$property",225],["T_WHITESPACE"," ",225],["T_IS_EQUAL","==",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'sp'",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n\t            ",225],["T_VARIABLE","$matches",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$matches",226],["T_WHITESPACE"," ",226],["T_BOOLEAN_AND","&&",226],["T_WHITESPACE"," ",226],"(",["T_STRING","strpbrk",226],"(",["T_VARIABLE","$value",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$requiredPermission",226],")",["T_WHITESPACE"," ",226],["T_IS_NOT_IDENTICAL","!==",226],["T_WHITESPACE"," ",226],["T_STRING","false",226],")",";",["T_WHITESPACE","\n\t        ",226],"}",["T_WHITESPACE","\n\t    ",227],"}",["T_WHITESPACE","\n\t    \n\t    ",228],["T_COMMENT","\/\/ Ok, but... does the resource match?\n",230],["T_WHITESPACE","\t    ",231],["T_VARIABLE","$matches",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$matches",231],["T_WHITESPACE"," ",231],["T_BOOLEAN_AND","&&",231],["T_WHITESPACE"," ",231],"(",["T_STRING","strpos",231],"(",["T_VARIABLE","$parsedRequestUrl",231],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",231],"]",",",["T_WHITESPACE"," ",231],["T_VARIABLE","$parsedPermissionUrl",231],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",231],"]",")",["T_WHITESPACE"," ",231],["T_IS_NOT_IDENTICAL","!==",231],["T_WHITESPACE"," ",231],["T_STRING","false",231],")",";",["T_WHITESPACE","\n\t    \n        ",231],["T_COMMENT","\/\/ Return\n",233],["T_WHITESPACE","\t    ",234],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$matches",234],";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","    \n    \n    ",235],["T_DOC_COMMENT","\/**\n\t * Sign request URL with credentials\n\t *\n\t * @param string $requestUrl Request URL\n\t * @param string $resourceType Resource type\n\t * @param string $requiredPermission Required permission\n\t * @return string Signed request URL\n\t *\/",237],["T_WHITESPACE","\n\t",244],["T_PUBLIC","public",245],["T_WHITESPACE"," ",245],["T_FUNCTION","function",245],["T_WHITESPACE"," ",245],["T_STRING","signRequestUrl",245],"(",["T_WHITESPACE","\n\t\t",245],["T_VARIABLE","$requestUrl",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","''",246],",",["T_WHITESPACE","\n\t\t",246],["T_VARIABLE","$resourceType",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","Zend_Service_WindowsAzure_Storage",247],["T_DOUBLE_COLON","::",247],["T_STRING","RESOURCE_UNKNOWN",247],",",["T_WHITESPACE","\n\t\t",247],["T_VARIABLE","$requiredPermission",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",248],["T_DOUBLE_COLON","::",248],["T_STRING","PERMISSION_READ",248],["T_WHITESPACE","\n\t",248],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n\t    ",249],["T_COMMENT","\/\/ Look for a matching permission\n",250],["T_WHITESPACE","\t    ",251],["T_FOREACH","foreach",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getPermissionSet",251],"(",")",["T_WHITESPACE"," ",251],["T_AS","as",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$permittedUrl",251],")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n\t        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","permissionMatchesRequest",252],"(",["T_VARIABLE","$permittedUrl",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$requestUrl",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$resourceType",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$requiredPermission",252],")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n\t            ",252],["T_COMMENT","\/\/ This matches, append signature data\n",253],["T_WHITESPACE","\t            ",254],["T_VARIABLE","$parsedPermittedUrl",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_STRING","parse_url",254],"(",["T_VARIABLE","$permittedUrl",254],")",";",["T_WHITESPACE","\n\n\t            ",254],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_STRING","strpos",256],"(",["T_VARIABLE","$requestUrl",256],",",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'?'",256],")",["T_WHITESPACE"," ",256],["T_IS_IDENTICAL","===",256],["T_WHITESPACE"," ",256],["T_STRING","false",256],")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n\t                ",256],["T_VARIABLE","$requestUrl",257],["T_WHITESPACE"," ",257],["T_CONCAT_EQUAL",".=",257],["T_WHITESPACE"," ",257],["T_CONSTANT_ENCAPSED_STRING","'?'",257],";",["T_WHITESPACE","\n\t            ",257],"}",["T_WHITESPACE"," ",258],["T_ELSE","else",258],["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n\t                ",258],["T_VARIABLE","$requestUrl",259],["T_WHITESPACE"," ",259],["T_CONCAT_EQUAL",".=",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'&'",259],";",["T_WHITESPACE","\n\t            ",259],"}",["T_WHITESPACE","\n\t            \n\t            ",260],["T_VARIABLE","$requestUrl",262],["T_WHITESPACE"," ",262],["T_CONCAT_EQUAL",".=",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$parsedPermittedUrl",262],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",262],"]",";",["T_WHITESPACE","\n\n\t            ",262],["T_COMMENT","\/\/ Return url\n",264],["T_WHITESPACE","\t            ",265],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$requestUrl",265],";",["T_WHITESPACE","\n\t        ",265],"}",["T_WHITESPACE","\n\t    ",266],"}",["T_WHITESPACE","\n\t    \n\t    ",267],["T_COMMENT","\/\/ Return url, will be unsigned...\n",269],["T_WHITESPACE","\t    ",270],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$requestUrl",270],";",["T_WHITESPACE","\n\t",270],"}",["T_WHITESPACE","\n    \n\t",271],["T_DOC_COMMENT","\/**\n\t * Sign request with credentials\n\t *\n\t * @param string $httpVerb HTTP verb the request will use\n\t * @param string $path Path for the request\n\t * @param string $queryString Query string for the request\n\t * @param array $headers x-ms headers to add\n\t * @param boolean $forTableStorage Is the request for table storage?\n\t * @param string $resourceType Resource type\n\t * @param string $requiredPermission Required permission\n\t * @param mixed  $rawData Raw post data\n\t * @return array Array of headers\n\t *\/",273],["T_WHITESPACE","\n\t",285],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","signRequestHeaders",286],"(",["T_WHITESPACE","\n\t\t",286],["T_VARIABLE","$httpVerb",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_STRING","Zend_Http_Client",287],["T_DOUBLE_COLON","::",287],["T_STRING","GET",287],",",["T_WHITESPACE","\n\t\t",287],["T_VARIABLE","$path",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'\/'",288],",",["T_WHITESPACE","\n\t\t",288],["T_VARIABLE","$queryString",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_CONSTANT_ENCAPSED_STRING","''",289],",",["T_WHITESPACE","\n\t\t",289],["T_VARIABLE","$headers",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","null",290],",",["T_WHITESPACE","\n\t\t",290],["T_VARIABLE","$forTableStorage",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","false",291],",",["T_WHITESPACE","\n\t\t",291],["T_VARIABLE","$resourceType",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_STRING","Zend_Service_WindowsAzure_Storage",292],["T_DOUBLE_COLON","::",292],["T_STRING","RESOURCE_UNKNOWN",292],",",["T_WHITESPACE","\n\t\t",292],["T_VARIABLE","$requiredPermission",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_STRING","Zend_Service_WindowsAzure_Credentials_CredentialsAbstract",293],["T_DOUBLE_COLON","::",293],["T_STRING","PERMISSION_READ",293],",",["T_WHITESPACE","\n\t\t",293],["T_VARIABLE","$rawData",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_STRING","null",294],["T_WHITESPACE","\n\t",294],")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n\t    ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$headers",296],";",["T_WHITESPACE","\n\t",296],"}",["T_WHITESPACE","\n",297],"}",["T_WHITESPACE","\n",298]]