[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @subpackage Storage\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/**\n * @see Zend_Log_Writer_Abstract\n *\/",23],["T_WHITESPACE","\n",25],["T_COMMENT","#require_once 'Zend\/Log\/Writer\/Abstract.php';\n",26],["T_WHITESPACE","\n",27],["T_DOC_COMMENT","\/**\n * @category   Zend\n * @package    Zend_Service_WindowsAzure\n * @subpackage Log\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Service_WindowsAzure_Log_Writer_WindowsAzure",35],["T_WHITESPACE","\n    ",35],["T_EXTENDS","extends",36],["T_WHITESPACE"," ",36],["T_STRING","Zend_Log_Writer_Abstract",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_DOC_COMMENT","\/**\n     * @var Zend_Service_Log_Formatter_Interface\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_formatter",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Connection to a windows Azure\n     *\n     * @var Zend_Service_Service_WindowsAzure_Storage_Table\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_tableStorageConnection",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","null",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Name of the table to use for logging purposes\n     *\n     * @var string\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_tableName",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Whether to keep all messages to be logged in an external buffer until the script ends and\n     * only then to send the messages in batch to the logging component.\n     *\n     * @var bool\n     *\/",57],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_bufferMessages",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","false",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * If message buffering is activated, it will store all the messages in this buffer and only\n     * write them to table storage (in a batch transaction) when the script ends.\n     *\n     * @var array\n     *\/",65],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_messageBuffer",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_ARRAY","array",71],"(",")",";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @param Zend_Service_Service_WindowsAzure_Storage_Table|Zend_Service_WindowsAzure_Storage_Table $tableStorageConnection\n     * @param string                                                                                  $tableName\n     * @param bool                                                                                    $createTable create the Windows Azure table for logging if it does not exist\n     * @param bool                                                                                    $bufferMessages\n     * @throws Zend_Service_Log_Exception\n     *\/",73],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","__construct",80],"(",["T_WHITESPACE","\n        ",80],["T_STRING","Zend_Service_WindowsAzure_Storage_Table",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$tableStorageConnection",81],",",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$tableName",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$createTable",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","true",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$bufferMessages",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","true",82],["T_WHITESPACE","\n    ",82],")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$tableStorageConnection",85],["T_WHITESPACE"," ",85],["T_IS_EQUAL","==",85],["T_WHITESPACE"," ",85],["T_STRING","null",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_COMMENT","#require_once 'Zend\/Service\/Log\/Exception.php';\n",86],["T_WHITESPACE","            ",87],["T_THROW","throw",87],["T_WHITESPACE"," ",87],["T_NEW","new",87],["T_WHITESPACE"," ",87],["T_STRING","Zend_Service_Log_Exception",87],"(",["T_WHITESPACE","\n                ",87],["T_CONSTANT_ENCAPSED_STRING","'No connection to the Windows Azure tables provided.'",88],["T_WHITESPACE","\n            ",88],")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n\n        ",90],["T_IF","if",92],["T_WHITESPACE"," ",92],"(","!",["T_STRING","is_string",92],"(",["T_VARIABLE","$tableName",92],")",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_COMMENT","#require_once 'Zend\/Service\/Log\/Exception.php';\n",93],["T_WHITESPACE","            ",94],["T_THROW","throw",94],["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","Zend_Service_Log_Exception",94],"(",["T_WHITESPACE","\n                ",94],["T_CONSTANT_ENCAPSED_STRING","'Provided Windows Azure table name must be a string.'",95],["T_WHITESPACE","\n            ",95],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_tableStorageConnection",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$tableStorageConnection",99],";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_tableName",100],["T_WHITESPACE","              ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$tableName",100],";",["T_WHITESPACE","\n\n        ",100],["T_COMMENT","\/\/ create the logging table if it does not exist. It will add some overhead, so it's optional\n",102],["T_WHITESPACE","        ",103],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$createTable",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_tableStorageConnection",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","createTableIfNotExists",104],"(",["T_WHITESPACE","\n                ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_tableName",105],["T_WHITESPACE","\n            ",105],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_COMMENT","\/\/ keep messages to be logged in an internal buffer and only send them over the wire when\n",109],["T_WHITESPACE","        ",110],["T_COMMENT","\/\/ the script execution ends\n",110],["T_WHITESPACE","        ",111],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$bufferMessages",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_bufferMessages",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$bufferMessages",112],";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_formatter",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE","\n            ",115],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_STRING","Zend_Service_WindowsAzure_Log_Formatter_WindowsAzure",116],"(",")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * If the log messages have been stored in the internal buffer, just send them\n     * to table storage.\n     *\/",119],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","shutdown",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_STRING","parent",125],["T_DOUBLE_COLON","::",125],["T_STRING","shutdown",125],"(",")",";",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_bufferMessages",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_tableStorageConnection",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","startBatch",127],"(",")",";",["T_WHITESPACE","\n            ",127],["T_FOREACH","foreach",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_messageBuffer",128],["T_WHITESPACE"," ",128],["T_AS","as",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$logEntity",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n                ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_tableStorageConnection",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","insertEntity",129],"(",["T_WHITESPACE","\n                    ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_tableName",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$logEntity",130],["T_WHITESPACE","\n                ",130],")",";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_tableStorageConnection",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","commit",133],"(",")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Create a new instance of Zend_Service_Log_Writer_WindowsAzure\n     *\n     * @param  array $config\n     * @return Zend_Service_Log_Writer_WindowsAzure\n     * @throws Zend_Service_Log_Exception\n     *\/",137],["T_WHITESPACE","\n    ",143],["T_STATIC","static",144],["T_WHITESPACE"," ",144],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","factory",144],"(",["T_VARIABLE","$config",144],")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$config",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_STRING","_parseConfig",146],"(",["T_VARIABLE","$config",146],")",";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$config",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","array_merge",147],"(",["T_WHITESPACE","\n            ",147],["T_ARRAY","array",148],"(",["T_WHITESPACE","\n                 ",148],["T_CONSTANT_ENCAPSED_STRING","'connection'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_STRING","null",149],",",["T_WHITESPACE","\n                 ",149],["T_CONSTANT_ENCAPSED_STRING","'tableName'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_STRING","null",150],",",["T_WHITESPACE","\n                 ",150],["T_CONSTANT_ENCAPSED_STRING","'createTable'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_STRING","true",151],",",["T_WHITESPACE","\n            ",151],")",",",["T_WHITESPACE"," ",152],["T_VARIABLE","$config",152],["T_WHITESPACE","\n        ",152],")",";",["T_WHITESPACE","\n\n        ",153],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_NEW","new",155],["T_WHITESPACE"," ",155],["T_STRING","self",155],"(",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$config",156],"[",["T_CONSTANT_ENCAPSED_STRING","'connection'",156],"]",",",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$config",157],"[",["T_CONSTANT_ENCAPSED_STRING","'tableName'",157],"]",",",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$config",158],"[",["T_CONSTANT_ENCAPSED_STRING","'createTable'",158],"]",["T_WHITESPACE","\n        ",158],")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * The only formatter accepted is already  loaded in the constructor\n     *\n     * @todo enable custom formatters using the WindowsAzure_Storage_DynamicTableEntity class\n     *\/",162],["T_WHITESPACE","\n    ",166],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","setFormatter",167],"(",["T_WHITESPACE","\n        ",167],["T_STRING","Zend_Service_Log_Formatter_Interface",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$formatter",168],["T_WHITESPACE","\n    ",168],")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_COMMENT","#require_once 'Zend\/Service\/Log\/Exception.php';\n",171],["T_WHITESPACE","        ",172],["T_THROW","throw",172],["T_WHITESPACE"," ",172],["T_NEW","new",172],["T_WHITESPACE"," ",172],["T_STRING","Zend_Service_Log_Exception",172],"(",["T_WHITESPACE","\n            ",172],["T_STRING","get_class",173],"(",["T_VARIABLE","$this",173],")",["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","' does not support formatting'",173],")",";",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Write a message to the table storage. If buffering is activated, then messages will just be\n     * added to an internal buffer.\n     *\n     * @param  array $event\n     * @return void\n     * @todo   format the event using a formatted, not in this method\n     *\/",176],["T_WHITESPACE","\n    ",183],["T_PROTECTED","protected",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","_write",184],"(",["T_VARIABLE","$event",184],")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$logEntity",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_formatter",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","format",186],"(",["T_VARIABLE","$event",186],")",";",["T_WHITESPACE","\n\n        ",186],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_bufferMessages",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_messageBuffer",189],"[","]",["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$logEntity",189],";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE"," ",190],["T_ELSE","else",190],["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_tableStorageConnection",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","insertEntity",191],"(",["T_WHITESPACE","\n                ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_tableName",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$logEntity",192],["T_WHITESPACE","\n            ",192],")",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n",195],"}",["T_WHITESPACE","\n",196]]