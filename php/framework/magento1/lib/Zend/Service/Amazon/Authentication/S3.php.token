[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Service_Amazon\n * @subpackage Authentication\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",2],["T_WHITESPACE","\n\n\n",20],["T_DOC_COMMENT","\/**\n * @see Zend_Service_Amazon_Authentication\n *\/",23],["T_WHITESPACE","\n",25],["T_COMMENT","#require_once 'Zend\/Service\/Amazon\/Authentication.php';\n",26],["T_WHITESPACE","\n",27],["T_DOC_COMMENT","\/**\n * @see Zend_Crypt_Hmac\n *\/",28],["T_WHITESPACE","\n",30],["T_COMMENT","#require_once 'Zend\/Crypt\/Hmac.php';\n",31],["T_WHITESPACE","\n",32],["T_DOC_COMMENT","\/**\n * @category   Zend\n * @package    Zend_Service_Amazon\n * @subpackage Authentication\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",33],["T_WHITESPACE","\n",39],["T_CLASS","class",40],["T_WHITESPACE"," ",40],["T_STRING","Zend_Service_Amazon_Authentication_S3",40],["T_WHITESPACE"," ",40],["T_EXTENDS","extends",40],["T_WHITESPACE"," ",40],["T_STRING","Zend_Service_Amazon_Authentication",40],["T_WHITESPACE","\n",40],"{",["T_WHITESPACE","\n    ",41],["T_DOC_COMMENT","\/**\n     * Add the S3 Authorization signature to the request headers\n     *\n     * @param  string $method\n     * @param  string $path\n     * @param  array &$headers\n     * @return string\n     *\/",42],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","generateSignature",50],"(",["T_VARIABLE","$method",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$path",50],",",["T_WHITESPACE"," ",50],"&",["T_VARIABLE","$headers",50],")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_IF","if",52],["T_WHITESPACE"," ",52],"(","!",["T_WHITESPACE"," ",52],["T_STRING","is_array",52],"(",["T_VARIABLE","$headers",52],")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_VARIABLE","$headers",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_ARRAY","array",53],"(",["T_VARIABLE","$headers",53],")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$type",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$md5",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$date",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","''",56],";",["T_WHITESPACE","\n\n        ",56],["T_COMMENT","\/\/ Search for the Content-type, Content-MD5 and Date headers\n",58],["T_WHITESPACE","        ",59],["T_FOREACH","foreach",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$headers",59],["T_WHITESPACE"," ",59],["T_AS","as",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$key",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$val",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_STRING","strcasecmp",60],"(",["T_VARIABLE","$key",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'content-type'",60],")",["T_WHITESPACE"," ",60],["T_IS_EQUAL","==",60],["T_WHITESPACE"," ",60],["T_LNUMBER","0",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                ",60],["T_VARIABLE","$type",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$val",61],";",["T_WHITESPACE","\n            ",61],"}",["T_WHITESPACE"," ",62],["T_ELSE","else",62],["T_WHITESPACE"," ",62],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_STRING","strcasecmp",62],"(",["T_VARIABLE","$key",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'content-md5'",62],")",["T_WHITESPACE"," ",62],["T_IS_EQUAL","==",62],["T_WHITESPACE"," ",62],["T_LNUMBER","0",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n                ",62],["T_VARIABLE","$md5",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$val",63],";",["T_WHITESPACE","\n            ",63],"}",["T_WHITESPACE"," ",64],["T_ELSE","else",64],["T_WHITESPACE"," ",64],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_STRING","strcasecmp",64],"(",["T_VARIABLE","$key",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'date'",64],")",["T_WHITESPACE"," ",64],["T_IS_EQUAL","==",64],["T_WHITESPACE"," ",64],["T_LNUMBER","0",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                ",64],["T_VARIABLE","$date",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$val",65],";",["T_WHITESPACE","\n            ",65],"}",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_COMMENT","\/\/ If we have an x-amz-date header, use that instead of the normal Date\n",69],["T_WHITESPACE","        ",70],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_ISSET","isset",70],"(",["T_VARIABLE","$headers",70],"[",["T_CONSTANT_ENCAPSED_STRING","'x-amz-date'",70],"]",")",["T_WHITESPACE"," ",70],["T_BOOLEAN_AND","&&",70],["T_WHITESPACE"," ",70],["T_ISSET","isset",70],"(",["T_VARIABLE","$date",70],")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$date",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","''",71],";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$sig_str",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],"\"",["T_VARIABLE","$method",74],["T_ENCAPSED_AND_WHITESPACE","\\n",74],["T_VARIABLE","$md5",74],["T_ENCAPSED_AND_WHITESPACE","\\n",74],["T_VARIABLE","$type",74],["T_ENCAPSED_AND_WHITESPACE","\\n",74],["T_VARIABLE","$date",74],["T_ENCAPSED_AND_WHITESPACE","\\n",74],"\"",";",["T_WHITESPACE","\n\n        ",74],["T_COMMENT","\/\/ For x-amz- headers, combine like keys, lowercase them, sort them\n",76],["T_WHITESPACE","        ",77],["T_COMMENT","\/\/ alphabetically and remove excess spaces around values\n",77],["T_WHITESPACE","        ",78],["T_VARIABLE","$amz_headers",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_ARRAY","array",78],"(",")",";",["T_WHITESPACE","\n        ",78],["T_FOREACH","foreach",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$headers",79],["T_WHITESPACE"," ",79],["T_AS","as",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$key",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$val",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$key",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","strtolower",80],"(",["T_VARIABLE","$key",80],")",";",["T_WHITESPACE","\n            ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_STRING","substr",81],"(",["T_VARIABLE","$key",81],",",["T_WHITESPACE"," ",81],["T_LNUMBER","0",81],",",["T_WHITESPACE"," ",81],["T_LNUMBER","6",81],")",["T_WHITESPACE"," ",81],["T_IS_EQUAL","==",81],["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'x-amz-'",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n                ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_STRING","is_array",82],"(",["T_VARIABLE","$val",82],")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                    ",82],["T_VARIABLE","$amz_headers",83],"[",["T_VARIABLE","$key",83],"]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$val",83],";",["T_WHITESPACE","\n                ",83],"}",["T_WHITESPACE"," ",84],["T_ELSE","else",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                    ",84],["T_VARIABLE","$amz_headers",85],"[",["T_VARIABLE","$key",85],"]","[","]",["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","preg_replace",85],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\s+\/'",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","' '",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$val",85],")",";",["T_WHITESPACE","\n                ",85],"}",["T_WHITESPACE","\n            ",86],"}",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(","!",["T_EMPTY","empty",89],"(",["T_VARIABLE","$amz_headers",89],")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_STRING","ksort",90],"(",["T_VARIABLE","$amz_headers",90],")",";",["T_WHITESPACE","\n            ",90],["T_FOREACH","foreach",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$amz_headers",91],["T_WHITESPACE"," ",91],["T_AS","as",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$key",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$val",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_VARIABLE","$sig_str",92],["T_WHITESPACE"," ",92],["T_CONCAT_EQUAL",".=",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$key",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","':'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_STRING","implode",92],"(",["T_CONSTANT_ENCAPSED_STRING","','",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$val",92],")",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",92],";",["T_WHITESPACE","\n            ",92],"}",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n\n        ",94],["T_VARIABLE","$sig_str",96],["T_WHITESPACE"," ",96],["T_CONCAT_EQUAL",".=",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'\/'",96],".",["T_STRING","parse_url",96],"(",["T_VARIABLE","$path",96],",",["T_WHITESPACE"," ",96],["T_STRING","PHP_URL_PATH",96],")",";",["T_WHITESPACE","\n        ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_STRING","strpos",97],"(",["T_VARIABLE","$path",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'?location'",97],")",["T_WHITESPACE"," ",97],["T_IS_NOT_IDENTICAL","!==",97],["T_WHITESPACE"," ",97],["T_STRING","false",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$sig_str",98],["T_WHITESPACE"," ",98],["T_CONCAT_EQUAL",".=",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'?location'",98],";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE"," ",99],["T_ELSE","else",99],["T_WHITESPACE","\n            ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_STRING","strpos",100],"(",["T_VARIABLE","$path",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'?acl'",100],")",["T_WHITESPACE"," ",100],["T_IS_NOT_IDENTICAL","!==",100],["T_WHITESPACE"," ",100],["T_STRING","false",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$sig_str",101],["T_WHITESPACE"," ",101],["T_CONCAT_EQUAL",".=",101],["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'?acl'",101],";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE"," ",102],["T_ELSE","else",102],["T_WHITESPACE","\n                ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_STRING","strpos",103],"(",["T_VARIABLE","$path",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'?torrent'",103],")",["T_WHITESPACE"," ",103],["T_IS_NOT_IDENTICAL","!==",103],["T_WHITESPACE"," ",103],["T_STRING","false",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                    ",103],["T_VARIABLE","$sig_str",104],["T_WHITESPACE"," ",104],["T_CONCAT_EQUAL",".=",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'?torrent'",104],";",["T_WHITESPACE","\n                ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$signature",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","base64_encode",107],"(",["T_STRING","Zend_Crypt_Hmac",107],["T_DOUBLE_COLON","::",107],["T_STRING","compute",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_secretKey",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'sha1'",107],",",["T_WHITESPACE"," ",107],["T_STRING","utf8_encode",107],"(",["T_VARIABLE","$sig_str",107],")",",",["T_WHITESPACE"," ",107],["T_STRING","Zend_Crypt_Hmac",107],["T_DOUBLE_COLON","::",107],["T_STRING","BINARY",107],")",")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$headers",108],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",108],"]",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'AWS '",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_accessKey",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","':'",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$signature",108],";",["T_WHITESPACE","\n\n        ",108],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$sig_str",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n",111],"}",["T_WHITESPACE","\n",112]]