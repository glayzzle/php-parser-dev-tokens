[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Filter\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * @see Zend_Filter_Encrypt_Interface\n *\/",22],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Filter\/Encrypt\/Interface.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/**\n * Encryption adapter for openssl\n *\n * @category   Zend\n * @package    Zend_Filter\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",27],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Filter_Encrypt_Openssl",35],["T_WHITESPACE"," ",35],["T_IMPLEMENTS","implements",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Filter_Encrypt_Interface",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Definitions for encryption\n     * array(\n     *     'public'   => public keys\n     *     'private'  => private keys\n     *     'envelope' => resulting envelope keys\n     * )\n     *\/",37],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_keys",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_WHITESPACE","\n        ",45],["T_CONSTANT_ENCAPSED_STRING","'public'",46],["T_WHITESPACE","   ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_ARRAY","array",46],"(",")",",",["T_WHITESPACE","\n        ",46],["T_CONSTANT_ENCAPSED_STRING","'private'",47],["T_WHITESPACE","  ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_ARRAY","array",47],"(",")",",",["T_WHITESPACE","\n        ",47],["T_CONSTANT_ENCAPSED_STRING","'envelope'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",["T_WHITESPACE","\n    ",48],")",";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Internal passphrase\n     *\n     * @var string\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_passphrase",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Internal compression\n     *\n     * @var array\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_compression",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Internal create package\n     *\n     * @var boolean\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_package",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","false",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Class constructor\n     * Available options\n     *   'public'      => public key\n     *   'private'     => private key\n     *   'envelope'    => envelope key\n     *   'passphrase'  => passphrase\n     *   'compression' => compress value with this compression adapter\n     *   'package'     => pack envelope keys into encrypted string, simplifies decryption\n     *\n     * @param string|array $options Options for this adapter\n     *\/",72],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","__construct",84],"(",["T_VARIABLE","$options",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",")",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(","!",["T_STRING","extension_loaded",86],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl'",86],")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",87],["T_WHITESPACE","            ",88],["T_THROW","throw",88],["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_STRING","Zend_Filter_Exception",88],"(",["T_CONSTANT_ENCAPSED_STRING","'This filter needs the openssl extension'",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$options",91],["T_WHITESPACE"," ",91],["T_INSTANCEOF","instanceof",91],["T_WHITESPACE"," ",91],["T_STRING","Zend_Config",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$options",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$options",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","toArray",92],"(",")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n\n        ",93],["T_IF","if",95],["T_WHITESPACE"," ",95],"(","!",["T_STRING","is_array",95],"(",["T_VARIABLE","$options",95],")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$options",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_CONSTANT_ENCAPSED_STRING","'public'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$options",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n\n        ",97],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_STRING","array_key_exists",99],"(",["T_CONSTANT_ENCAPSED_STRING","'passphrase'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$options",99],")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","setPassphrase",100],"(",["T_VARIABLE","$options",100],"[",["T_CONSTANT_ENCAPSED_STRING","'passphrase'",100],"]",")",";",["T_WHITESPACE","\n            ",100],["T_UNSET","unset",101],"(",["T_VARIABLE","$options",101],"[",["T_CONSTANT_ENCAPSED_STRING","'passphrase'",101],"]",")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_STRING","array_key_exists",104],"(",["T_CONSTANT_ENCAPSED_STRING","'compression'",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$options",104],")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","setCompression",105],"(",["T_VARIABLE","$options",105],"[",["T_CONSTANT_ENCAPSED_STRING","'compression'",105],"]",")",";",["T_WHITESPACE","\n            ",105],["T_UNSET","unset",106],"(",["T_VARIABLE","$options",106],"[",["T_CONSTANT_ENCAPSED_STRING","'compress'",106],"]",")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_STRING","array_key_exists",109],"(",["T_CONSTANT_ENCAPSED_STRING","'package'",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$options",109],")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","setPackage",110],"(",["T_VARIABLE","$options",110],"[",["T_CONSTANT_ENCAPSED_STRING","'package'",110],"]",")",";",["T_WHITESPACE","\n            ",110],["T_UNSET","unset",111],"(",["T_VARIABLE","$options",111],"[",["T_CONSTANT_ENCAPSED_STRING","'package'",111],"]",")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_setKeys",114],"(",["T_VARIABLE","$options",114],")",";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Sets the encryption keys\n     *\n     * @param  string|array $keys Key with type association\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",117],["T_WHITESPACE","\n    ",122],["T_PROTECTED","protected",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","_setKeys",123],"(",["T_VARIABLE","$keys",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(","!",["T_STRING","is_array",125],"(",["T_VARIABLE","$keys",125],")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",126],["T_WHITESPACE","            ",127],["T_THROW","throw",127],["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","Zend_Filter_Exception",127],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid options argument provided to filter'",127],")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_FOREACH","foreach",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$keys",130],["T_WHITESPACE"," ",130],["T_AS","as",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$type",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$key",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","ctype_print",131],"(",["T_VARIABLE","$key",131],")",["T_WHITESPACE"," ",131],["T_BOOLEAN_AND","&&",131],["T_WHITESPACE"," ",131],["T_STRING","is_file",131],"(",["T_STRING","realpath",131],"(",["T_VARIABLE","$key",131],")",")",["T_WHITESPACE"," ",131],["T_BOOLEAN_AND","&&",131],["T_WHITESPACE"," ",131],["T_STRING","is_readable",131],"(",["T_VARIABLE","$key",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$file",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","fopen",132],"(",["T_VARIABLE","$key",132],",",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'r'",132],")",";",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$cert",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","fread",133],"(",["T_VARIABLE","$file",133],",",["T_WHITESPACE"," ",133],["T_LNUMBER","8192",133],")",";",["T_WHITESPACE","\n                ",133],["T_STRING","fclose",134],"(",["T_VARIABLE","$file",134],")",";",["T_WHITESPACE","\n            ",134],"}",["T_WHITESPACE"," ",135],["T_ELSE","else",135],["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$cert",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$key",136],";",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$key",137],["T_WHITESPACE","  ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","count",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_keys",137],"[",["T_VARIABLE","$type",137],"]",")",";",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE","\n\n            ",138],["T_SWITCH","switch",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$type",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                ",140],["T_CASE","case",141],["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'public'",141],":",["T_WHITESPACE","\n                    ",141],["T_VARIABLE","$test",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","openssl_pkey_get_public",142],"(",["T_VARIABLE","$cert",142],")",";",["T_WHITESPACE","\n                    ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$test",143],["T_WHITESPACE"," ",143],["T_IS_IDENTICAL","===",143],["T_WHITESPACE"," ",143],["T_STRING","false",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                        ",143],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",144],["T_WHITESPACE","                        ",145],["T_THROW","throw",145],["T_WHITESPACE"," ",145],["T_NEW","new",145],["T_WHITESPACE"," ",145],["T_STRING","Zend_Filter_Exception",145],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Public key '",145],["T_CURLY_OPEN","{",145],["T_VARIABLE","$cert",145],"}",["T_ENCAPSED_AND_WHITESPACE","' not valid",145],"\"",")",";",["T_WHITESPACE","\n                    ",145],"}",["T_WHITESPACE","\n\n                    ",146],["T_STRING","openssl_free_key",148],"(",["T_VARIABLE","$test",148],")",";",["T_WHITESPACE","\n                    ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_keys",149],"[",["T_CONSTANT_ENCAPSED_STRING","'public'",149],"]","[",["T_VARIABLE","$key",149],"]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$cert",149],";",["T_WHITESPACE","\n                    ",149],["T_BREAK","break",150],";",["T_WHITESPACE","\n                ",150],["T_CASE","case",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'private'",151],":",["T_WHITESPACE","\n                    ",151],["T_VARIABLE","$test",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","openssl_pkey_get_private",152],"(",["T_VARIABLE","$cert",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_passphrase",152],")",";",["T_WHITESPACE","\n                    ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$test",153],["T_WHITESPACE"," ",153],["T_IS_IDENTICAL","===",153],["T_WHITESPACE"," ",153],["T_STRING","false",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n                        ",153],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",154],["T_WHITESPACE","                        ",155],["T_THROW","throw",155],["T_WHITESPACE"," ",155],["T_NEW","new",155],["T_WHITESPACE"," ",155],["T_STRING","Zend_Filter_Exception",155],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Private key '",155],["T_CURLY_OPEN","{",155],["T_VARIABLE","$cert",155],"}",["T_ENCAPSED_AND_WHITESPACE","' not valid",155],"\"",")",";",["T_WHITESPACE","\n                    ",155],"}",["T_WHITESPACE","\n\n                    ",156],["T_STRING","openssl_free_key",158],"(",["T_VARIABLE","$test",158],")",";",["T_WHITESPACE","\n                    ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_keys",159],"[",["T_CONSTANT_ENCAPSED_STRING","'private'",159],"]","[",["T_VARIABLE","$key",159],"]",["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$cert",159],";",["T_WHITESPACE","\n                    ",159],["T_BREAK","break",160],";",["T_WHITESPACE","\n                ",160],["T_CASE","case",161],["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'envelope'",161],":",["T_WHITESPACE","\n                    ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_keys",162],"[",["T_CONSTANT_ENCAPSED_STRING","'envelope'",162],"]","[",["T_VARIABLE","$key",162],"]",["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$cert",162],";",["T_WHITESPACE","\n                    ",162],["T_BREAK","break",163],";",["T_WHITESPACE","\n                ",163],["T_DEFAULT","default",164],":",["T_WHITESPACE","\n                    ",164],["T_BREAK","break",165],";",["T_WHITESPACE","\n            ",165],"}",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n\n        ",167],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Returns all public keys\n     *\n     * @return array\n     *\/",172],["T_WHITESPACE","\n    ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","getPublicKey",177],"(",")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$key",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_keys",179],"[",["T_CONSTANT_ENCAPSED_STRING","'public'",179],"]",";",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$key",180],";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Sets public keys\n     *\n     * @param  string|array $key Public keys\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",183],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","setPublicKey",189],"(",["T_VARIABLE","$key",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_STRING","is_array",191],"(",["T_VARIABLE","$key",191],")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_FOREACH","foreach",192],"(",["T_VARIABLE","$key",192],["T_WHITESPACE"," ",192],["T_AS","as",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$type",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$option",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$type",193],["T_WHITESPACE"," ",193],["T_IS_NOT_IDENTICAL","!==",193],["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'public'",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n                    ",193],["T_VARIABLE","$key",194],"[",["T_CONSTANT_ENCAPSED_STRING","'public'",194],"]",["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$option",194],";",["T_WHITESPACE","\n                    ",194],["T_UNSET","unset",195],"(",["T_VARIABLE","$key",195],"[",["T_VARIABLE","$type",195],"]",")",";",["T_WHITESPACE","\n                ",195],"}",["T_WHITESPACE","\n            ",196],"}",["T_WHITESPACE","\n        ",197],"}",["T_WHITESPACE"," ",198],["T_ELSE","else",198],["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$key",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_ARRAY","array",199],"(",["T_CONSTANT_ENCAPSED_STRING","'public'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$key",199],")",";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_setKeys",202],"(",["T_VARIABLE","$key",202],")",";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Returns all private keys\n     *\n     * @return array\n     *\/",205],["T_WHITESPACE","\n    ",209],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","getPrivateKey",210],"(",")",["T_WHITESPACE","\n    ",210],"{",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$key",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_keys",212],"[",["T_CONSTANT_ENCAPSED_STRING","'private'",212],"]",";",["T_WHITESPACE","\n        ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$key",213],";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Sets private keys\n     *\n     * @param  string $key Private key\n     * @param  string $passphrase\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",216],["T_WHITESPACE","\n    ",222],["T_PUBLIC","public",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","setPrivateKey",223],"(",["T_VARIABLE","$key",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$passphrase",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","null",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_STRING","is_array",225],"(",["T_VARIABLE","$key",225],")",")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_FOREACH","foreach",226],"(",["T_VARIABLE","$key",226],["T_WHITESPACE"," ",226],["T_AS","as",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$type",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$option",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n                ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$type",227],["T_WHITESPACE"," ",227],["T_IS_NOT_IDENTICAL","!==",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'private'",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                    ",227],["T_VARIABLE","$key",228],"[",["T_CONSTANT_ENCAPSED_STRING","'private'",228],"]",["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$option",228],";",["T_WHITESPACE","\n                    ",228],["T_UNSET","unset",229],"(",["T_VARIABLE","$key",229],"[",["T_VARIABLE","$type",229],"]",")",";",["T_WHITESPACE","\n                ",229],"}",["T_WHITESPACE","\n            ",230],"}",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE"," ",232],["T_ELSE","else",232],["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$key",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_ARRAY","array",233],"(",["T_CONSTANT_ENCAPSED_STRING","'private'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$key",233],")",";",["T_WHITESPACE","\n        ",233],"}",["T_WHITESPACE","\n\n        ",234],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$passphrase",236],["T_WHITESPACE"," ",236],["T_IS_NOT_IDENTICAL","!==",236],["T_WHITESPACE"," ",236],["T_STRING","null",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","setPassphrase",237],"(",["T_VARIABLE","$passphrase",237],")",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE","\n\n        ",238],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_setKeys",240],"(",["T_VARIABLE","$key",240],")",";",["T_WHITESPACE","\n    ",240],"}",["T_WHITESPACE","\n\n    ",241],["T_DOC_COMMENT","\/**\n     * Returns all envelope keys\n     *\n     * @return array\n     *\/",243],["T_WHITESPACE","\n    ",247],["T_PUBLIC","public",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","getEnvelopeKey",248],"(",")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$key",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_keys",250],"[",["T_CONSTANT_ENCAPSED_STRING","'envelope'",250],"]",";",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$key",251],";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Sets envelope keys\n     *\n     * @param  string|array $options Envelope keys\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",254],["T_WHITESPACE","\n    ",259],["T_PUBLIC","public",260],["T_WHITESPACE"," ",260],["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],["T_STRING","setEnvelopeKey",260],"(",["T_VARIABLE","$key",260],")",["T_WHITESPACE","\n    ",260],"{",["T_WHITESPACE","\n        ",261],["T_IF","if",262],["T_WHITESPACE"," ",262],"(",["T_STRING","is_array",262],"(",["T_VARIABLE","$key",262],")",")",["T_WHITESPACE"," ",262],"{",["T_WHITESPACE","\n            ",262],["T_FOREACH","foreach",263],"(",["T_VARIABLE","$key",263],["T_WHITESPACE"," ",263],["T_AS","as",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$type",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$option",263],")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                ",263],["T_IF","if",264],["T_WHITESPACE"," ",264],"(",["T_VARIABLE","$type",264],["T_WHITESPACE"," ",264],["T_IS_NOT_IDENTICAL","!==",264],["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'envelope'",264],")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n                    ",264],["T_VARIABLE","$key",265],"[",["T_CONSTANT_ENCAPSED_STRING","'envelope'",265],"]",["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_VARIABLE","$option",265],";",["T_WHITESPACE","\n                    ",265],["T_UNSET","unset",266],"(",["T_VARIABLE","$key",266],"[",["T_VARIABLE","$type",266],"]",")",";",["T_WHITESPACE","\n                ",266],"}",["T_WHITESPACE","\n            ",267],"}",["T_WHITESPACE","\n        ",268],"}",["T_WHITESPACE"," ",269],["T_ELSE","else",269],["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$key",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_ARRAY","array",270],"(",["T_CONSTANT_ENCAPSED_STRING","'envelope'",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$key",270],")",";",["T_WHITESPACE","\n        ",270],"}",["T_WHITESPACE","\n\n        ",271],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_setKeys",273],"(",["T_VARIABLE","$key",273],")",";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Returns the passphrase\n     *\n     * @return string\n     *\/",276],["T_WHITESPACE","\n    ",280],["T_PUBLIC","public",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","getPassphrase",281],"(",")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_passphrase",283],";",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n\n    ",284],["T_DOC_COMMENT","\/**\n     * Sets a new passphrase\n     *\n     * @param string $passphrase\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",286],["T_WHITESPACE","\n    ",291],["T_PUBLIC","public",292],["T_WHITESPACE"," ",292],["T_FUNCTION","function",292],["T_WHITESPACE"," ",292],["T_STRING","setPassphrase",292],"(",["T_VARIABLE","$passphrase",292],")",["T_WHITESPACE","\n    ",292],"{",["T_WHITESPACE","\n        ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_passphrase",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$passphrase",294],";",["T_WHITESPACE","\n        ",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],";",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_DOC_COMMENT","\/**\n     * Returns the compression\n     *\n     * @return array\n     *\/",298],["T_WHITESPACE","\n    ",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","getCompression",303],"(",")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_RETURN","return",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","_compression",305],";",["T_WHITESPACE","\n    ",305],"}",["T_WHITESPACE","\n\n    ",306],["T_DOC_COMMENT","\/**\n     * Sets a internal compression for values to encrypt\n     *\n     * @param string|array $compression\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",308],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","setCompression",314],"(",["T_VARIABLE","$compression",314],")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_IF","if",316],["T_WHITESPACE"," ",316],"(",["T_STRING","is_string",316],"(",["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_compression",316],")",")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n            ",316],["T_VARIABLE","$compression",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_ARRAY","array",317],"(",["T_CONSTANT_ENCAPSED_STRING","'adapter'",317],["T_WHITESPACE"," ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$compression",317],")",";",["T_WHITESPACE","\n        ",317],"}",["T_WHITESPACE","\n\n        ",318],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_compression",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$compression",320],";",["T_WHITESPACE","\n        ",320],["T_RETURN","return",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n\n    ",322],["T_DOC_COMMENT","\/**\n     * Returns if header should be packaged\n     *\n     * @return boolean\n     *\/",324],["T_WHITESPACE","\n    ",328],["T_PUBLIC","public",329],["T_WHITESPACE"," ",329],["T_FUNCTION","function",329],["T_WHITESPACE"," ",329],["T_STRING","getPackage",329],"(",")",["T_WHITESPACE","\n    ",329],"{",["T_WHITESPACE","\n        ",330],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_package",331],";",["T_WHITESPACE","\n    ",331],"}",["T_WHITESPACE","\n\n    ",332],["T_DOC_COMMENT","\/**\n     * Sets if the envelope keys should be included in the encrypted value\n     *\n     * @param boolean $package\n     * @return Zend_Filter_Encrypt_Openssl\n     *\/",334],["T_WHITESPACE","\n    ",339],["T_PUBLIC","public",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","setPackage",340],"(",["T_VARIABLE","$package",340],")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_package",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_BOOL_CAST","(boolean)",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$package",342],";",["T_WHITESPACE","\n        ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],";",["T_WHITESPACE","\n    ",343],"}",["T_WHITESPACE","\n\n    ",344],["T_DOC_COMMENT","\/**\n     * Encrypts $value with the defined settings\n     * Note that you also need the \"encrypted\" keys to be able to decrypt\n     *\n     * @param  string $value Content to encrypt\n     * @return string The encrypted content\n     * @throws Zend_Filter_Exception\n     *\/",346],["T_WHITESPACE","\n    ",353],["T_PUBLIC","public",354],["T_WHITESPACE"," ",354],["T_FUNCTION","function",354],["T_WHITESPACE"," ",354],["T_STRING","encrypt",354],"(",["T_VARIABLE","$value",354],")",["T_WHITESPACE","\n    ",354],"{",["T_WHITESPACE","\n        ",355],["T_VARIABLE","$encrypted",356],["T_WHITESPACE","     ",356],"=",["T_WHITESPACE"," ",356],["T_ARRAY","array",356],"(",")",";",["T_WHITESPACE","\n        ",356],["T_VARIABLE","$encryptedkeys",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_ARRAY","array",357],"(",")",";",["T_WHITESPACE","\n\n        ",357],["T_IF","if",359],["T_WHITESPACE"," ",359],"(",["T_STRING","count",359],"(",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_keys",359],"[",["T_CONSTANT_ENCAPSED_STRING","'public'",359],"]",")",["T_WHITESPACE"," ",359],["T_IS_EQUAL","==",359],["T_WHITESPACE"," ",359],["T_LNUMBER","0",359],")",["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n            ",359],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",360],["T_WHITESPACE","            ",361],["T_THROW","throw",361],["T_WHITESPACE"," ",361],["T_NEW","new",361],["T_WHITESPACE"," ",361],["T_STRING","Zend_Filter_Exception",361],"(",["T_CONSTANT_ENCAPSED_STRING","'Openssl can not encrypt without public keys'",361],")",";",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n\n        ",362],["T_VARIABLE","$keys",364],["T_WHITESPACE","         ",364],"=",["T_WHITESPACE"," ",364],["T_ARRAY","array",364],"(",")",";",["T_WHITESPACE","\n        ",364],["T_VARIABLE","$fingerprints",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_ARRAY","array",365],"(",")",";",["T_WHITESPACE","\n        ",365],["T_VARIABLE","$count",366],["T_WHITESPACE","        ",366],"=",["T_WHITESPACE"," ",366],"-",["T_LNUMBER","1",366],";",["T_WHITESPACE","\n        ",366],["T_FOREACH","foreach",367],"(",["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_keys",367],"[",["T_CONSTANT_ENCAPSED_STRING","'public'",367],"]",["T_WHITESPACE"," ",367],["T_AS","as",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$key",367],["T_WHITESPACE"," ",367],["T_DOUBLE_ARROW","=>",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$cert",367],")",["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n            ",367],["T_VARIABLE","$keys",368],"[",["T_VARIABLE","$key",368],"]",["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_STRING","openssl_pkey_get_public",368],"(",["T_VARIABLE","$cert",368],")",";",["T_WHITESPACE","\n            ",368],["T_IF","if",369],["T_WHITESPACE"," ",369],"(",["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_package",369],")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n                ",369],["T_VARIABLE","$details",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],["T_STRING","openssl_pkey_get_details",370],"(",["T_VARIABLE","$keys",370],"[",["T_VARIABLE","$key",370],"]",")",";",["T_WHITESPACE","\n                ",370],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_VARIABLE","$details",371],["T_WHITESPACE"," ",371],["T_IS_IDENTICAL","===",371],["T_WHITESPACE"," ",371],["T_STRING","false",371],")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n                    ",371],["T_VARIABLE","$details",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_ARRAY","array",372],"(",["T_CONSTANT_ENCAPSED_STRING","'key'",372],["T_WHITESPACE"," ",372],["T_DOUBLE_ARROW","=>",372],["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'ZendFramework'",372],")",";",["T_WHITESPACE","\n                ",372],"}",["T_WHITESPACE","\n\n                ",373],["T_INC","++",375],["T_VARIABLE","$count",375],";",["T_WHITESPACE","\n                ",375],["T_VARIABLE","$fingerprints",376],"[",["T_VARIABLE","$count",376],"]",["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_STRING","md5",376],"(",["T_VARIABLE","$details",376],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",376],"]",")",";",["T_WHITESPACE","\n            ",376],"}",["T_WHITESPACE","\n        ",377],"}",["T_WHITESPACE","\n\n        ",378],["T_COMMENT","\/\/ compress prior to encryption\n",380],["T_WHITESPACE","        ",381],["T_IF","if",381],["T_WHITESPACE"," ",381],"(","!",["T_EMPTY","empty",381],"(",["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_compression",381],")",")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n            ",381],["T_COMMENT","#require_once 'Zend\/Filter\/Compress.php';\n",382],["T_WHITESPACE","            ",383],["T_VARIABLE","$compress",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_NEW","new",383],["T_WHITESPACE"," ",383],["T_STRING","Zend_Filter_Compress",383],"(",["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_compression",383],")",";",["T_WHITESPACE","\n            ",383],["T_VARIABLE","$value",384],["T_WHITESPACE","    ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$compress",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","filter",384],"(",["T_VARIABLE","$value",384],")",";",["T_WHITESPACE","\n        ",384],"}",["T_WHITESPACE","\n\n        ",385],["T_VARIABLE","$crypt",387],["T_WHITESPACE","  ",387],"=",["T_WHITESPACE"," ",387],["T_STRING","openssl_seal",387],"(",["T_VARIABLE","$value",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$encrypted",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$encryptedkeys",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$keys",387],")",";",["T_WHITESPACE","\n        ",387],["T_FOREACH","foreach",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$keys",388],["T_WHITESPACE"," ",388],["T_AS","as",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$key",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n            ",388],["T_STRING","openssl_free_key",389],"(",["T_VARIABLE","$key",389],")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n\n        ",390],["T_IF","if",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$crypt",392],["T_WHITESPACE"," ",392],["T_IS_IDENTICAL","===",392],["T_WHITESPACE"," ",392],["T_STRING","false",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n            ",392],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",393],["T_WHITESPACE","            ",394],["T_THROW","throw",394],["T_WHITESPACE"," ",394],["T_NEW","new",394],["T_WHITESPACE"," ",394],["T_STRING","Zend_Filter_Exception",394],"(",["T_CONSTANT_ENCAPSED_STRING","'Openssl was not able to encrypt your content with the given options'",394],")",";",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n\n        ",395],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","_keys",397],"[",["T_CONSTANT_ENCAPSED_STRING","'envelope'",397],"]",["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_VARIABLE","$encryptedkeys",397],";",["T_WHITESPACE","\n\n        ",397],["T_COMMENT","\/\/ Pack data and envelope keys into single string\n",399],["T_WHITESPACE","        ",400],["T_IF","if",400],["T_WHITESPACE"," ",400],"(",["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","_package",400],")",["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n            ",400],["T_VARIABLE","$header",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","pack",401],"(",["T_CONSTANT_ENCAPSED_STRING","'n'",401],",",["T_WHITESPACE"," ",401],["T_STRING","count",401],"(",["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_keys",401],"[",["T_CONSTANT_ENCAPSED_STRING","'envelope'",401],"]",")",")",";",["T_WHITESPACE","\n            ",401],["T_FOREACH","foreach",402],"(",["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","_keys",402],"[",["T_CONSTANT_ENCAPSED_STRING","'envelope'",402],"]",["T_WHITESPACE"," ",402],["T_AS","as",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$key",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$envKey",402],")",["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n                ",402],["T_VARIABLE","$header",403],["T_WHITESPACE"," ",403],["T_CONCAT_EQUAL",".=",403],["T_WHITESPACE"," ",403],["T_STRING","pack",403],"(",["T_CONSTANT_ENCAPSED_STRING","'H32n'",403],",",["T_WHITESPACE"," ",403],["T_VARIABLE","$fingerprints",403],"[",["T_VARIABLE","$key",403],"]",",",["T_WHITESPACE"," ",403],["T_STRING","strlen",403],"(",["T_VARIABLE","$envKey",403],")",")",["T_WHITESPACE"," ",403],".",["T_WHITESPACE"," ",403],["T_VARIABLE","$envKey",403],";",["T_WHITESPACE","\n            ",403],"}",["T_WHITESPACE","\n\n            ",404],["T_VARIABLE","$encrypted",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$header",406],["T_WHITESPACE"," ",406],".",["T_WHITESPACE"," ",406],["T_VARIABLE","$encrypted",406],";",["T_WHITESPACE","\n        ",406],"}",["T_WHITESPACE","\n\n        ",407],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$encrypted",409],";",["T_WHITESPACE","\n    ",409],"}",["T_WHITESPACE","\n\n    ",410],["T_DOC_COMMENT","\/**\n     * Defined by Zend_Filter_Interface\n     *\n     * Decrypts $value with the defined settings\n     *\n     * @param  string $value Content to decrypt\n     * @return string The decrypted content\n     * @throws Zend_Filter_Exception\n     *\/",412],["T_WHITESPACE","\n    ",420],["T_PUBLIC","public",421],["T_WHITESPACE"," ",421],["T_FUNCTION","function",421],["T_WHITESPACE"," ",421],["T_STRING","decrypt",421],"(",["T_VARIABLE","$value",421],")",["T_WHITESPACE","\n    ",421],"{",["T_WHITESPACE","\n        ",422],["T_VARIABLE","$decrypted",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","\"\"",423],";",["T_WHITESPACE","\n        ",423],["T_VARIABLE","$envelope",424],["T_WHITESPACE","  ",424],"=",["T_WHITESPACE"," ",424],["T_STRING","current",424],"(",["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getEnvelopeKey",424],"(",")",")",";",["T_WHITESPACE","\n\n        ",424],["T_IF","if",426],["T_WHITESPACE"," ",426],"(",["T_STRING","count",426],"(",["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","_keys",426],"[",["T_CONSTANT_ENCAPSED_STRING","'private'",426],"]",")",["T_WHITESPACE"," ",426],["T_IS_NOT_IDENTICAL","!==",426],["T_WHITESPACE"," ",426],["T_LNUMBER","1",426],")",["T_WHITESPACE"," ",426],"{",["T_WHITESPACE","\n            ",426],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",427],["T_WHITESPACE","            ",428],["T_THROW","throw",428],["T_WHITESPACE"," ",428],["T_NEW","new",428],["T_WHITESPACE"," ",428],["T_STRING","Zend_Filter_Exception",428],"(",["T_CONSTANT_ENCAPSED_STRING","'Please give a private key for decryption with Openssl'",428],")",";",["T_WHITESPACE","\n        ",428],"}",["T_WHITESPACE","\n\n        ",429],["T_IF","if",431],["T_WHITESPACE"," ",431],"(","!",["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","_package",431],["T_WHITESPACE"," ",431],["T_BOOLEAN_AND","&&",431],["T_WHITESPACE"," ",431],["T_EMPTY","empty",431],"(",["T_VARIABLE","$envelope",431],")",")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n            ",431],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",432],["T_WHITESPACE","            ",433],["T_THROW","throw",433],["T_WHITESPACE"," ",433],["T_NEW","new",433],["T_WHITESPACE"," ",433],["T_STRING","Zend_Filter_Exception",433],"(",["T_CONSTANT_ENCAPSED_STRING","'Please give a envelope key for decryption with Openssl'",433],")",";",["T_WHITESPACE","\n        ",433],"}",["T_WHITESPACE","\n\n        ",434],["T_FOREACH","foreach",436],"(",["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","_keys",436],"[",["T_CONSTANT_ENCAPSED_STRING","'private'",436],"]",["T_WHITESPACE"," ",436],["T_AS","as",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$key",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$cert",436],")",["T_WHITESPACE"," ",436],"{",["T_WHITESPACE","\n            ",436],["T_VARIABLE","$keys",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_STRING","openssl_pkey_get_private",437],"(",["T_VARIABLE","$cert",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","getPassphrase",437],"(",")",")",";",["T_WHITESPACE","\n        ",437],"}",["T_WHITESPACE","\n\n        ",438],["T_IF","if",440],["T_WHITESPACE"," ",440],"(",["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","_package",440],")",["T_WHITESPACE"," ",440],"{",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$details",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_STRING","openssl_pkey_get_details",441],"(",["T_VARIABLE","$keys",441],")",";",["T_WHITESPACE","\n            ",441],["T_IF","if",442],["T_WHITESPACE"," ",442],"(",["T_VARIABLE","$details",442],["T_WHITESPACE"," ",442],["T_IS_NOT_IDENTICAL","!==",442],["T_WHITESPACE"," ",442],["T_STRING","false",442],")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n                ",442],["T_VARIABLE","$fingerprint",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_STRING","md5",443],"(",["T_VARIABLE","$details",443],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",443],"]",")",";",["T_WHITESPACE","\n            ",443],"}",["T_WHITESPACE"," ",444],["T_ELSE","else",444],["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n                ",444],["T_VARIABLE","$fingerprint",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_STRING","md5",445],"(",["T_CONSTANT_ENCAPSED_STRING","\"ZendFramework\"",445],")",";",["T_WHITESPACE","\n            ",445],"}",["T_WHITESPACE","\n\n            ",446],["T_VARIABLE","$count",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_STRING","unpack",448],"(",["T_CONSTANT_ENCAPSED_STRING","'ncount'",448],",",["T_WHITESPACE"," ",448],["T_VARIABLE","$value",448],")",";",["T_WHITESPACE","\n            ",448],["T_VARIABLE","$count",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$count",449],"[",["T_CONSTANT_ENCAPSED_STRING","'count'",449],"]",";",["T_WHITESPACE","\n            ",449],["T_VARIABLE","$length",450],["T_WHITESPACE","  ",450],"=",["T_WHITESPACE"," ",450],["T_LNUMBER","2",450],";",["T_WHITESPACE","\n            ",450],["T_FOR","for",451],"(",["T_VARIABLE","$i",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_VARIABLE","$count",451],";",["T_WHITESPACE"," ",451],["T_VARIABLE","$i",451],["T_WHITESPACE"," ",451],">",["T_WHITESPACE"," ",451],["T_LNUMBER","0",451],";",["T_WHITESPACE"," ",451],["T_DEC","--",451],["T_VARIABLE","$i",451],")",["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n                ",451],["T_VARIABLE","$header",452],["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],["T_STRING","unpack",452],"(",["T_CONSTANT_ENCAPSED_STRING","'H32print\/nsize'",452],",",["T_WHITESPACE"," ",452],["T_STRING","substr",452],"(",["T_VARIABLE","$value",452],",",["T_WHITESPACE"," ",452],["T_VARIABLE","$length",452],",",["T_WHITESPACE"," ",452],["T_LNUMBER","18",452],")",")",";",["T_WHITESPACE","\n                ",452],["T_VARIABLE","$length",453],["T_WHITESPACE","  ",453],["T_PLUS_EQUAL","+=",453],["T_WHITESPACE"," ",453],["T_LNUMBER","18",453],";",["T_WHITESPACE","\n                ",453],["T_IF","if",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$header",454],"[",["T_CONSTANT_ENCAPSED_STRING","'print'",454],"]",["T_WHITESPACE"," ",454],["T_IS_EQUAL","==",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$fingerprint",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n                    ",454],["T_VARIABLE","$envelope",455],["T_WHITESPACE"," ",455],"=",["T_WHITESPACE"," ",455],["T_STRING","substr",455],"(",["T_VARIABLE","$value",455],",",["T_WHITESPACE"," ",455],["T_VARIABLE","$length",455],",",["T_WHITESPACE"," ",455],["T_VARIABLE","$header",455],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",455],"]",")",";",["T_WHITESPACE","\n                ",455],"}",["T_WHITESPACE","\n\n                ",456],["T_VARIABLE","$length",458],["T_WHITESPACE"," ",458],["T_PLUS_EQUAL","+=",458],["T_WHITESPACE"," ",458],["T_VARIABLE","$header",458],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",458],"]",";",["T_WHITESPACE","\n            ",458],"}",["T_WHITESPACE","\n\n            ",459],["T_COMMENT","\/\/ remainder of string is the value to decrypt\n",461],["T_WHITESPACE","            ",462],["T_VARIABLE","$value",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_STRING","substr",462],"(",["T_VARIABLE","$value",462],",",["T_WHITESPACE"," ",462],["T_VARIABLE","$length",462],")",";",["T_WHITESPACE","\n        ",462],"}",["T_WHITESPACE","\n\n        ",463],["T_VARIABLE","$crypt",465],["T_WHITESPACE","  ",465],"=",["T_WHITESPACE"," ",465],["T_STRING","openssl_open",465],"(",["T_VARIABLE","$value",465],",",["T_WHITESPACE"," ",465],["T_VARIABLE","$decrypted",465],",",["T_WHITESPACE"," ",465],["T_VARIABLE","$envelope",465],",",["T_WHITESPACE"," ",465],["T_VARIABLE","$keys",465],")",";",["T_WHITESPACE","\n        ",465],["T_STRING","openssl_free_key",466],"(",["T_VARIABLE","$keys",466],")",";",["T_WHITESPACE","\n\n        ",466],["T_IF","if",468],["T_WHITESPACE"," ",468],"(",["T_VARIABLE","$crypt",468],["T_WHITESPACE"," ",468],["T_IS_IDENTICAL","===",468],["T_WHITESPACE"," ",468],["T_STRING","false",468],")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n            ",468],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",469],["T_WHITESPACE","            ",470],["T_THROW","throw",470],["T_WHITESPACE"," ",470],["T_NEW","new",470],["T_WHITESPACE"," ",470],["T_STRING","Zend_Filter_Exception",470],"(",["T_CONSTANT_ENCAPSED_STRING","'Openssl was not able to decrypt you content with the given options'",470],")",";",["T_WHITESPACE","\n        ",470],"}",["T_WHITESPACE","\n\n        ",471],["T_COMMENT","\/\/ decompress after decryption\n",473],["T_WHITESPACE","        ",474],["T_IF","if",474],["T_WHITESPACE"," ",474],"(","!",["T_EMPTY","empty",474],"(",["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","_compression",474],")",")",["T_WHITESPACE"," ",474],"{",["T_WHITESPACE","\n            ",474],["T_COMMENT","#require_once 'Zend\/Filter\/Decompress.php';\n",475],["T_WHITESPACE","            ",476],["T_VARIABLE","$decompress",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_NEW","new",476],["T_WHITESPACE"," ",476],["T_STRING","Zend_Filter_Decompress",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_compression",476],")",";",["T_WHITESPACE","\n            ",476],["T_VARIABLE","$decrypted",477],["T_WHITESPACE","  ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$decompress",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","filter",477],"(",["T_VARIABLE","$decrypted",477],")",";",["T_WHITESPACE","\n        ",477],"}",["T_WHITESPACE","\n\n        ",478],["T_RETURN","return",480],["T_WHITESPACE"," ",480],["T_VARIABLE","$decrypted",480],";",["T_WHITESPACE","\n    ",480],"}",["T_WHITESPACE","\n\n    ",481],["T_DOC_COMMENT","\/**\n     * Returns the adapter name\n     *\n     * @return string\n     *\/",483],["T_WHITESPACE","\n    ",487],["T_PUBLIC","public",488],["T_WHITESPACE"," ",488],["T_FUNCTION","function",488],["T_WHITESPACE"," ",488],["T_STRING","toString",488],"(",")",["T_WHITESPACE","\n    ",488],"{",["T_WHITESPACE","\n        ",489],["T_RETURN","return",490],["T_WHITESPACE"," ",490],["T_CONSTANT_ENCAPSED_STRING","'Openssl'",490],";",["T_WHITESPACE","\n    ",490],"}",["T_WHITESPACE","\n",491],"}",["T_WHITESPACE","\n",492]]