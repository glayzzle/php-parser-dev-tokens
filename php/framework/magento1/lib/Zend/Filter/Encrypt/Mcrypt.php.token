[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Filter\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * @see Zend_Filter_Encrypt_Interface\n *\/",22],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Filter\/Encrypt\/Interface.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/**\n * Encryption adapter for mcrypt\n *\n * @category   Zend\n * @package    Zend_Filter\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",27],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Filter_Encrypt_Mcrypt",35],["T_WHITESPACE"," ",35],["T_IMPLEMENTS","implements",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Filter_Encrypt_Interface",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Definitions for encryption\n     * array(\n     *     'key' => encryption key string\n     *     'algorithm' => algorithm to use\n     *     'algorithm_directory' => directory where to find the algorithm\n     *     'mode' => encryption mode to use\n     *     'modedirectory' => directory where to find the mode\n     * )\n     *\/",37],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_encryption",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_ARRAY","array",47],"(",["T_WHITESPACE","\n        ",47],["T_CONSTANT_ENCAPSED_STRING","'key'",48],["T_WHITESPACE","                 ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'ZendFramework'",48],",",["T_WHITESPACE","\n        ",48],["T_CONSTANT_ENCAPSED_STRING","'algorithm'",49],["T_WHITESPACE","           ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'blowfish'",49],",",["T_WHITESPACE","\n        ",49],["T_CONSTANT_ENCAPSED_STRING","'algorithm_directory'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","''",50],",",["T_WHITESPACE","\n        ",50],["T_CONSTANT_ENCAPSED_STRING","'mode'",51],["T_WHITESPACE","                ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'cbc'",51],",",["T_WHITESPACE","\n        ",51],["T_CONSTANT_ENCAPSED_STRING","'mode_directory'",52],["T_WHITESPACE","      ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","''",52],",",["T_WHITESPACE","\n        ",52],["T_CONSTANT_ENCAPSED_STRING","'vector'",53],["T_WHITESPACE","              ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_STRING","null",53],",",["T_WHITESPACE","\n        ",53],["T_CONSTANT_ENCAPSED_STRING","'salt'",54],["T_WHITESPACE","                ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_STRING","false",54],["T_WHITESPACE","\n    ",54],")",";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Internal compression\n     *\n     * @var array\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_compression",62],";",["T_WHITESPACE","\n\n    ",62],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_STATIC","static",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_srandCalled",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","false",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Class constructor\n     *\n     * @param string|array|Zend_Config $options Cryption Options\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","__construct",71],"(",["T_VARIABLE","$options",71],")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(","!",["T_STRING","extension_loaded",73],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",73],")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n            ",73],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",74],["T_WHITESPACE","            ",75],["T_THROW","throw",75],["T_WHITESPACE"," ",75],["T_NEW","new",75],["T_WHITESPACE"," ",75],["T_STRING","Zend_Filter_Exception",75],"(",["T_CONSTANT_ENCAPSED_STRING","'This filter needs the mcrypt extension'",75],")",";",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n\n        ",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$options",78],["T_WHITESPACE"," ",78],["T_INSTANCEOF","instanceof",78],["T_WHITESPACE"," ",78],["T_STRING","Zend_Config",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$options",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$options",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","toArray",79],"(",")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE"," ",80],["T_ELSEIF","elseif",80],["T_WHITESPACE"," ",80],"(",["T_STRING","is_string",80],"(",["T_VARIABLE","$options",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$options",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",["T_CONSTANT_ENCAPSED_STRING","'key'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$options",81],")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE"," ",82],["T_ELSEIF","elseif",82],["T_WHITESPACE"," ",82],"(","!",["T_STRING","is_array",82],"(",["T_VARIABLE","$options",82],")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",83],["T_WHITESPACE","            ",84],["T_THROW","throw",84],["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","Zend_Filter_Exception",84],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid options argument provided to filter'",84],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n\n        ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_STRING","array_key_exists",87],"(",["T_CONSTANT_ENCAPSED_STRING","'compression'",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$options",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","setCompression",88],"(",["T_VARIABLE","$options",88],"[",["T_CONSTANT_ENCAPSED_STRING","'compression'",88],"]",")",";",["T_WHITESPACE","\n            ",88],["T_UNSET","unset",89],"(",["T_VARIABLE","$options",89],"[",["T_CONSTANT_ENCAPSED_STRING","'compress'",89],"]",")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n\n        ",90],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","setEncryption",92],"(",["T_VARIABLE","$options",92],")",";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Returns the set encryption options\n     *\n     * @return array\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","getEncryption",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_encryption",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Sets new encryption options\n     *\n     * @param  string|array $options Encryption options\n     * @return Zend_Filter_File_Encryption\n     *\/",105],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","setEncryption",111],"(",["T_VARIABLE","$options",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_STRING","is_string",113],"(",["T_VARIABLE","$options",113],")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$options",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_CONSTANT_ENCAPSED_STRING","'key'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$options",114],")",";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n\n        ",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(","!",["T_STRING","is_array",117],"(",["T_VARIABLE","$options",117],")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",118],["T_WHITESPACE","            ",119],["T_THROW","throw",119],["T_WHITESPACE"," ",119],["T_NEW","new",119],["T_WHITESPACE"," ",119],["T_STRING","Zend_Filter_Exception",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid options argument provided to filter'",119],")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$options",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$options",122],["T_WHITESPACE"," ",122],"+",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getEncryption",122],"(",")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$algorithms",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","mcrypt_list_algorithms",123],"(",["T_VARIABLE","$options",123],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm_directory'",123],"]",")",";",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(","!",["T_STRING","in_array",124],"(",["T_VARIABLE","$options",124],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",124],"]",",",["T_WHITESPACE"," ",124],["T_VARIABLE","$algorithms",124],")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",125],["T_WHITESPACE","            ",126],["T_THROW","throw",126],["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_STRING","Zend_Filter_Exception",126],"(","\"",["T_ENCAPSED_AND_WHITESPACE","The algorithm '",126],["T_CURLY_OPEN","{",126],["T_VARIABLE","$options",126],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",126],"]","}",["T_ENCAPSED_AND_WHITESPACE","' is not supported",126],"\"",")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$modes",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","mcrypt_list_modes",129],"(",["T_VARIABLE","$options",129],"[",["T_CONSTANT_ENCAPSED_STRING","'mode_directory'",129],"]",")",";",["T_WHITESPACE","\n        ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(","!",["T_STRING","in_array",130],"(",["T_VARIABLE","$options",130],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",130],"]",",",["T_WHITESPACE"," ",130],["T_VARIABLE","$modes",130],")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",131],["T_WHITESPACE","            ",132],["T_THROW","throw",132],["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_STRING","Zend_Filter_Exception",132],"(","\"",["T_ENCAPSED_AND_WHITESPACE","The mode '",132],["T_CURLY_OPEN","{",132],["T_VARIABLE","$options",132],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",132],"]","}",["T_ENCAPSED_AND_WHITESPACE","' is not supported",132],"\"",")",";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n\n        ",133],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_STRING","mcrypt_module_self_test",135],"(",["T_VARIABLE","$options",135],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",135],"]",",",["T_WHITESPACE"," ",135],["T_VARIABLE","$options",135],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm_directory'",135],"]",")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",136],["T_WHITESPACE","            ",137],["T_THROW","throw",137],["T_WHITESPACE"," ",137],["T_NEW","new",137],["T_WHITESPACE"," ",137],["T_STRING","Zend_Filter_Exception",137],"(",["T_CONSTANT_ENCAPSED_STRING","'The given algorithm can not be used due an internal mcrypt problem'",137],")",";",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n\n        ",138],["T_IF","if",140],["T_WHITESPACE"," ",140],"(","!",["T_ISSET","isset",140],"(",["T_VARIABLE","$options",140],"[",["T_CONSTANT_ENCAPSED_STRING","'vector'",140],"]",")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$options",141],"[",["T_CONSTANT_ENCAPSED_STRING","'vector'",141],"]",["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","null",141],";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n\n        ",142],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_encryption",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$options",144],";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","setVector",145],"(",["T_VARIABLE","$options",145],"[",["T_CONSTANT_ENCAPSED_STRING","'vector'",145],"]",")",";",["T_WHITESPACE","\n\n        ",145],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Returns the set vector\n     *\n     * @return string\n     *\/",150],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","getVector",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_encryption",157],"[",["T_CONSTANT_ENCAPSED_STRING","'vector'",157],"]",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Sets the initialization vector\n     *\n     * @param string $vector (Optional) Vector to set\n     * @return Zend_Filter_Encrypt_Mcrypt\n     *\/",160],["T_WHITESPACE","\n    ",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","setVector",166],"(",["T_VARIABLE","$vector",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","null",166],")",["T_WHITESPACE","\n    ",166],"{",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$cipher",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_openCipher",168],"(",")",";",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$size",169],["T_WHITESPACE","   ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","mcrypt_enc_get_iv_size",169],"(",["T_VARIABLE","$cipher",169],")",";",["T_WHITESPACE","\n        ",169],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_EMPTY","empty",170],"(",["T_VARIABLE","$vector",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_srand",171],"(",")",";",["T_WHITESPACE","\n            ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_STRING","strtoupper",172],"(",["T_STRING","substr",172],"(",["T_STRING","PHP_OS",172],",",["T_WHITESPACE"," ",172],["T_LNUMBER","0",172],",",["T_WHITESPACE"," ",172],["T_LNUMBER","3",172],")",")",["T_WHITESPACE"," ",172],["T_IS_IDENTICAL","===",172],["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'WIN'",172],["T_WHITESPACE"," ",172],["T_BOOLEAN_AND","&&",172],["T_WHITESPACE"," ",172],["T_STRING","version_compare",172],"(",["T_STRING","PHP_VERSION",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'5.3.0'",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'<'",172],")",")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n                ",172],["T_VARIABLE","$method",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","MCRYPT_RAND",173],";",["T_WHITESPACE","\n            ",173],"}",["T_WHITESPACE"," ",174],["T_ELSE","else",174],["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n                ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_STRING","file_exists",175],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",175],")",["T_WHITESPACE"," ",175],["T_BOOLEAN_OR","||",175],["T_WHITESPACE"," ",175],"(",["T_STRING","strtoupper",175],"(",["T_STRING","substr",175],"(",["T_STRING","PHP_OS",175],",",["T_WHITESPACE"," ",175],["T_LNUMBER","0",175],",",["T_WHITESPACE"," ",175],["T_LNUMBER","3",175],")",")",["T_WHITESPACE"," ",175],["T_IS_IDENTICAL","===",175],["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'WIN'",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n                    ",175],["T_VARIABLE","$method",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","MCRYPT_DEV_URANDOM",176],";",["T_WHITESPACE","\n                ",176],"}",["T_WHITESPACE"," ",177],["T_ELSEIF","elseif",177],["T_WHITESPACE"," ",177],"(",["T_STRING","file_exists",177],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/random'",177],")",")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                    ",177],["T_VARIABLE","$method",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","MCRYPT_DEV_RANDOM",178],";",["T_WHITESPACE","\n                ",178],"}",["T_WHITESPACE"," ",179],["T_ELSE","else",179],["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n                    ",179],["T_VARIABLE","$method",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","MCRYPT_RAND",180],";",["T_WHITESPACE","\n                ",180],"}",["T_WHITESPACE","\n            ",181],"}",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$vector",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_STRING","mcrypt_create_iv",183],"(",["T_VARIABLE","$size",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$method",183],")",";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE"," ",184],["T_ELSE","else",184],["T_WHITESPACE"," ",184],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_STRING","strlen",184],"(",["T_VARIABLE","$vector",184],")",["T_WHITESPACE"," ",184],["T_IS_NOT_EQUAL","!=",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$size",184],")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",185],["T_WHITESPACE","            ",186],["T_THROW","throw",186],["T_WHITESPACE"," ",186],["T_NEW","new",186],["T_WHITESPACE"," ",186],["T_STRING","Zend_Filter_Exception",186],"(",["T_CONSTANT_ENCAPSED_STRING","'The given vector has a wrong size for the set algorithm'",186],")",";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_encryption",189],"[",["T_CONSTANT_ENCAPSED_STRING","'vector'",189],"]",["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$vector",189],";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_closeCipher",190],"(",["T_VARIABLE","$cipher",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Returns the compression\n     *\n     * @return array\n     *\/",195],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","getCompression",200],"(",")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_compression",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Sets a internal compression for values to encrypt\n     *\n     * @param string|array $compression\n     * @return Zend_Filter_Encrypt_Mcrypt\n     *\/",205],["T_WHITESPACE","\n    ",210],["T_PUBLIC","public",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","setCompression",211],"(",["T_VARIABLE","$compression",211],")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(",["T_STRING","is_string",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_compression",213],")",")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$compression",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_ARRAY","array",214],"(",["T_CONSTANT_ENCAPSED_STRING","'adapter'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$compression",214],")",";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n\n        ",215],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_compression",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$compression",217],";",["T_WHITESPACE","\n        ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Defined by Zend_Filter_Interface\n     *\n     * Encrypts $value with the defined settings\n     *\n     * @param  string $value The content to encrypt\n     * @return string The encrypted content\n     *\/",221],["T_WHITESPACE","\n    ",228],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","encrypt",229],"(",["T_VARIABLE","$value",229],")",["T_WHITESPACE","\n    ",229],"{",["T_WHITESPACE","\n        ",230],["T_COMMENT","\/\/ compress prior to encryption\n",231],["T_WHITESPACE","        ",232],["T_IF","if",232],["T_WHITESPACE"," ",232],"(","!",["T_EMPTY","empty",232],"(",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_compression",232],")",")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_COMMENT","#require_once 'Zend\/Filter\/Compress.php';\n",233],["T_WHITESPACE","            ",234],["T_VARIABLE","$compress",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_NEW","new",234],["T_WHITESPACE"," ",234],["T_STRING","Zend_Filter_Compress",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_compression",234],")",";",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$value",235],["T_WHITESPACE","    ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$compress",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","filter",235],"(",["T_VARIABLE","$value",235],")",";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n\n        ",236],["T_VARIABLE","$cipher",238],["T_WHITESPACE","  ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_openCipher",238],"(",")",";",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_initCipher",239],"(",["T_VARIABLE","$cipher",239],")",";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$encrypted",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","mcrypt_generic",240],"(",["T_VARIABLE","$cipher",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$value",240],")",";",["T_WHITESPACE","\n        ",240],["T_STRING","mcrypt_generic_deinit",241],"(",["T_VARIABLE","$cipher",241],")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_closeCipher",242],"(",["T_VARIABLE","$cipher",242],")",";",["T_WHITESPACE","\n\n        ",242],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$encrypted",244],";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Defined by Zend_Filter_Interface\n     *\n     * Decrypts $value with the defined settings\n     *\n     * @param  string $value Content to decrypt\n     * @return string The decrypted content\n     *\/",247],["T_WHITESPACE","\n    ",254],["T_PUBLIC","public",255],["T_WHITESPACE"," ",255],["T_FUNCTION","function",255],["T_WHITESPACE"," ",255],["T_STRING","decrypt",255],"(",["T_VARIABLE","$value",255],")",["T_WHITESPACE","\n    ",255],"{",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$cipher",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_openCipher",257],"(",")",";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_initCipher",258],"(",["T_VARIABLE","$cipher",258],")",";",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$decrypted",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_STRING","mdecrypt_generic",259],"(",["T_VARIABLE","$cipher",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$value",259],")",";",["T_WHITESPACE","\n        ",259],["T_STRING","mcrypt_generic_deinit",260],"(",["T_VARIABLE","$cipher",260],")",";",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_closeCipher",261],"(",["T_VARIABLE","$cipher",261],")",";",["T_WHITESPACE","\n\n        ",261],["T_COMMENT","\/\/ decompress after decryption\n",263],["T_WHITESPACE","        ",264],["T_IF","if",264],["T_WHITESPACE"," ",264],"(","!",["T_EMPTY","empty",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_compression",264],")",")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n            ",264],["T_COMMENT","#require_once 'Zend\/Filter\/Decompress.php';\n",265],["T_WHITESPACE","            ",266],["T_VARIABLE","$decompress",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_NEW","new",266],["T_WHITESPACE"," ",266],["T_STRING","Zend_Filter_Decompress",266],"(",["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_compression",266],")",";",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$decrypted",267],["T_WHITESPACE","  ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$decompress",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","filter",267],"(",["T_VARIABLE","$decrypted",267],")",";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n\n        ",268],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$decrypted",270],";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * Returns the adapter name\n     *\n     * @return string\n     *\/",273],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","toString",278],"(",")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'Mcrypt'",280],";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Open a cipher\n     *\n     * @throws Zend_Filter_Exception When the cipher can not be opened\n     * @return resource Returns the opened cipher\n     *\/",283],["T_WHITESPACE","\n    ",288],["T_PROTECTED","protected",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","_openCipher",289],"(",")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$cipher",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","mcrypt_module_open",291],"(",["T_WHITESPACE","\n            ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_encryption",292],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",292],"]",",",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_encryption",293],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm_directory'",293],"]",",",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_encryption",294],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",294],"]",",",["T_WHITESPACE","\n            ",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_encryption",295],"[",["T_CONSTANT_ENCAPSED_STRING","'mode_directory'",295],"]",")",";",["T_WHITESPACE","\n\n        ",295],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$cipher",297],["T_WHITESPACE"," ",297],["T_IS_IDENTICAL","===",297],["T_WHITESPACE"," ",297],["T_STRING","false",297],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",298],["T_WHITESPACE","            ",299],["T_THROW","throw",299],["T_WHITESPACE"," ",299],["T_NEW","new",299],["T_WHITESPACE"," ",299],["T_STRING","Zend_Filter_Exception",299],"(",["T_CONSTANT_ENCAPSED_STRING","'Mcrypt can not be opened with your settings'",299],")",";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n\n        ",300],["T_RETURN","return",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$cipher",302],";",["T_WHITESPACE","\n    ",302],"}",["T_WHITESPACE","\n\n    ",303],["T_DOC_COMMENT","\/**\n     * Close a cipher\n     *\n     * @param  resource $cipher Cipher to close\n     * @return Zend_Filter_Encrypt_Mcrypt\n     *\/",305],["T_WHITESPACE","\n    ",310],["T_PROTECTED","protected",311],["T_WHITESPACE"," ",311],["T_FUNCTION","function",311],["T_WHITESPACE"," ",311],["T_STRING","_closeCipher",311],"(",["T_VARIABLE","$cipher",311],")",["T_WHITESPACE","\n    ",311],"{",["T_WHITESPACE","\n        ",312],["T_STRING","mcrypt_module_close",313],"(",["T_VARIABLE","$cipher",313],")",";",["T_WHITESPACE","\n\n        ",313],["T_RETURN","return",315],["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],";",["T_WHITESPACE","\n    ",315],"}",["T_WHITESPACE","\n\n    ",316],["T_DOC_COMMENT","\/**\n     * Initialises the cipher with the set key\n     *\n     * @param  resource $cipher\n     * @throws\n     * @return resource\n     *\/",318],["T_WHITESPACE","\n    ",324],["T_PROTECTED","protected",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","_initCipher",325],"(",["T_VARIABLE","$cipher",325],")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_VARIABLE","$key",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_encryption",327],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",327],"]",";",["T_WHITESPACE","\n\n        ",327],["T_VARIABLE","$keysizes",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_STRING","mcrypt_enc_get_supported_key_sizes",329],"(",["T_VARIABLE","$cipher",329],")",";",["T_WHITESPACE","\n        ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_EMPTY","empty",330],"(",["T_VARIABLE","$keysizes",330],")",["T_WHITESPACE"," ",330],["T_BOOLEAN_OR","||",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_encryption",330],"[",["T_CONSTANT_ENCAPSED_STRING","'salt'",330],"]",["T_WHITESPACE"," ",330],["T_IS_EQUAL","==",330],["T_WHITESPACE"," ",330],["T_STRING","true",330],")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_srand",331],"(",")",";",["T_WHITESPACE","\n            ",331],["T_VARIABLE","$keysize",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","mcrypt_enc_get_key_size",332],"(",["T_VARIABLE","$cipher",332],")",";",["T_WHITESPACE","\n            ",332],["T_VARIABLE","$key",333],["T_WHITESPACE","     ",333],"=",["T_WHITESPACE"," ",333],["T_STRING","substr",333],"(",["T_STRING","md5",333],"(",["T_VARIABLE","$key",333],")",",",["T_WHITESPACE"," ",333],["T_LNUMBER","0",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$keysize",333],")",";",["T_WHITESPACE","\n        ",333],"}",["T_WHITESPACE"," ",334],["T_ELSE","else",334],["T_WHITESPACE"," ",334],["T_IF","if",334],["T_WHITESPACE"," ",334],"(","!",["T_STRING","in_array",334],"(",["T_STRING","strlen",334],"(",["T_VARIABLE","$key",334],")",",",["T_WHITESPACE"," ",334],["T_VARIABLE","$keysizes",334],")",")",["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n            ",334],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",335],["T_WHITESPACE","            ",336],["T_THROW","throw",336],["T_WHITESPACE"," ",336],["T_NEW","new",336],["T_WHITESPACE"," ",336],["T_STRING","Zend_Filter_Exception",336],"(",["T_CONSTANT_ENCAPSED_STRING","'The given key has a wrong size for the set algorithm'",336],")",";",["T_WHITESPACE","\n        ",336],"}",["T_WHITESPACE","\n\n        ",337],["T_VARIABLE","$result",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","mcrypt_generic_init",339],"(",["T_VARIABLE","$cipher",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$key",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_encryption",339],"[",["T_CONSTANT_ENCAPSED_STRING","'vector'",339],"]",")",";",["T_WHITESPACE","\n        ",339],["T_IF","if",340],["T_WHITESPACE"," ",340],"(",["T_VARIABLE","$result",340],["T_WHITESPACE"," ",340],"<",["T_WHITESPACE"," ",340],["T_LNUMBER","0",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n            ",340],["T_COMMENT","#require_once 'Zend\/Filter\/Exception.php';\n",341],["T_WHITESPACE","            ",342],["T_THROW","throw",342],["T_WHITESPACE"," ",342],["T_NEW","new",342],["T_WHITESPACE"," ",342],["T_STRING","Zend_Filter_Exception",342],"(",["T_CONSTANT_ENCAPSED_STRING","'Mcrypt could not be initialize with the given setting'",342],")",";",["T_WHITESPACE","\n        ",342],"}",["T_WHITESPACE","\n\n        ",343],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],";",["T_WHITESPACE","\n    ",345],"}",["T_WHITESPACE","\n\n    ",346],["T_DOC_COMMENT","\/**\n     * _srand() interception\n     *\n     * @see ZF-8742\n     *\/",348],["T_WHITESPACE","\n    ",352],["T_PROTECTED","protected",353],["T_WHITESPACE"," ",353],["T_FUNCTION","function",353],["T_WHITESPACE"," ",353],["T_STRING","_srand",353],"(",")",["T_WHITESPACE","\n    ",353],"{",["T_WHITESPACE","\n        ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_STRING","version_compare",355],"(",["T_STRING","PHP_VERSION",355],",",["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'5.3.0'",355],",",["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'>='",355],")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_RETURN","return",356],";",["T_WHITESPACE","\n        ",356],"}",["T_WHITESPACE","\n\n        ",357],["T_IF","if",359],["T_WHITESPACE"," ",359],"(","!",["T_STRING","self",359],["T_DOUBLE_COLON","::",359],["T_VARIABLE","$_srandCalled",359],")",["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n            ",359],["T_STRING","srand",360],"(",["T_DOUBLE_CAST","(double)",360],["T_WHITESPACE"," ",360],["T_STRING","microtime",360],"(",")",["T_WHITESPACE"," ",360],"*",["T_WHITESPACE"," ",360],["T_LNUMBER","1000000",360],")",";",["T_WHITESPACE","\n            ",360],["T_STRING","self",361],["T_DOUBLE_COLON","::",361],["T_VARIABLE","$_srandCalled",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_STRING","true",361],";",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n",363],"}",["T_WHITESPACE","\n",364]]