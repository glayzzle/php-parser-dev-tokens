[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Search_Lucene\n * @subpackage Document\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n\n",21],["T_DOC_COMMENT","\/** Zend_Search_Lucene_Document *\/",24],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Document.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/** Zend_Xml_Security *\/",27],["T_WHITESPACE","\n",27],["T_COMMENT","#require_once 'Zend\/Xml\/Security.php';\n",28],["T_WHITESPACE","\n",29],["T_DOC_COMMENT","\/**\n * OpenXML document.\n *\n * @category   Zend\n * @package    Zend_Search_Lucene\n * @subpackage Document\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",30],["T_WHITESPACE","\n",38],["T_ABSTRACT","abstract",39],["T_WHITESPACE"," ",39],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Search_Lucene_Document_OpenXml",39],["T_WHITESPACE"," ",39],["T_EXTENDS","extends",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Search_Lucene_Document",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n    ",40],["T_DOC_COMMENT","\/**\n     * Xml Schema - Relationships\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","SCHEMA_RELATIONSHIP",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/package\/2006\/relationships'",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Xml Schema - Office document\n     *\n     * @var string\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","SCHEMA_OFFICEDOCUMENT",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/officeDocument'",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Xml Schema - Core properties\n     *\n     * @var string\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_CONST","const",60],["T_WHITESPACE"," ",60],["T_STRING","SCHEMA_COREPROPERTIES",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/package\/2006\/relationships\/metadata\/core-properties'",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Xml Schema - Dublin Core\n     *\n     * @var string\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_CONST","const",67],["T_WHITESPACE"," ",67],["T_STRING","SCHEMA_DUBLINCORE",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/purl.org\/dc\/elements\/1.1\/'",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Xml Schema - Dublin Core Terms\n     *\n     * @var string\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_CONST","const",74],["T_WHITESPACE"," ",74],["T_STRING","SCHEMA_DUBLINCORETERMS",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/purl.org\/dc\/terms\/'",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Extract metadata from document\n     *\n     * @param ZipArchive $package    ZipArchive OpenXML package\n     * @return array    Key-value pairs containing document meta data\n     *\/",76],["T_WHITESPACE","\n    ",81],["T_PROTECTED","protected",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","extractMetaData",82],"(",["T_STRING","ZipArchive",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$package",82],")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_COMMENT","\/\/ Data holders\n",84],["T_WHITESPACE","        ",85],["T_VARIABLE","$coreProperties",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",")",";",["T_WHITESPACE","\n\n        ",85],["T_COMMENT","\/\/ Read relations and search for core properties\n",87],["T_WHITESPACE","        ",88],["T_VARIABLE","$relations",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","Zend_Xml_Security",88],["T_DOUBLE_COLON","::",88],["T_STRING","scan",88],"(",["T_VARIABLE","$package",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getFromName",88],"(",["T_CONSTANT_ENCAPSED_STRING","\"_rels\/.rels\"",88],")",")",";",["T_WHITESPACE","\n        ",88],["T_FOREACH","foreach",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$relations",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","Relationship",89],["T_WHITESPACE"," ",89],["T_AS","as",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$rel",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$rel",90],"[",["T_CONSTANT_ENCAPSED_STRING","\"Type\"",90],"]",["T_WHITESPACE"," ",90],["T_IS_EQUAL","==",90],["T_WHITESPACE"," ",90],["T_STRING","Zend_Search_Lucene_Document_OpenXml",90],["T_DOUBLE_COLON","::",90],["T_STRING","SCHEMA_COREPROPERTIES",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_COMMENT","\/\/ Found core properties! Read in contents...\n",91],["T_WHITESPACE","                ",92],["T_VARIABLE","$contents",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","Zend_Xml_Security",92],["T_DOUBLE_COLON","::",92],["T_STRING","scan",92],"(",["T_WHITESPACE","\n                    ",92],["T_VARIABLE","$package",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getFromName",93],"(",["T_STRING","dirname",93],"(",["T_VARIABLE","$rel",93],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",93],"]",")",["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_STRING","basename",93],"(",["T_VARIABLE","$rel",93],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",93],"]",")",")",["T_WHITESPACE","\n                ",93],")",";",["T_WHITESPACE","\n\n                ",94],["T_FOREACH","foreach",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$contents",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","children",96],"(",["T_STRING","Zend_Search_Lucene_Document_OpenXml",96],["T_DOUBLE_COLON","::",96],["T_STRING","SCHEMA_DUBLINCORE",96],")",["T_WHITESPACE"," ",96],["T_AS","as",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$child",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                    ",96],["T_VARIABLE","$coreProperties",97],"[",["T_VARIABLE","$child",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getName",97],"(",")","]",["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING_CAST","(string)",97],["T_VARIABLE","$child",97],";",["T_WHITESPACE","\n                ",97],"}",["T_WHITESPACE","\n                ",98],["T_FOREACH","foreach",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$contents",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","children",99],"(",["T_STRING","Zend_Search_Lucene_Document_OpenXml",99],["T_DOUBLE_COLON","::",99],["T_STRING","SCHEMA_COREPROPERTIES",99],")",["T_WHITESPACE"," ",99],["T_AS","as",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$child",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n                    ",99],["T_VARIABLE","$coreProperties",100],"[",["T_VARIABLE","$child",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getName",100],"(",")","]",["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING_CAST","(string)",100],["T_VARIABLE","$child",100],";",["T_WHITESPACE","\n                ",100],"}",["T_WHITESPACE","\n                ",101],["T_FOREACH","foreach",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$contents",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","children",102],"(",["T_STRING","Zend_Search_Lucene_Document_OpenXml",102],["T_DOUBLE_COLON","::",102],["T_STRING","SCHEMA_DUBLINCORETERMS",102],")",["T_WHITESPACE"," ",102],["T_AS","as",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$child",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                    ",102],["T_VARIABLE","$coreProperties",103],"[",["T_VARIABLE","$child",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getName",103],"(",")","]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING_CAST","(string)",103],["T_VARIABLE","$child",103],";",["T_WHITESPACE","\n                ",103],"}",["T_WHITESPACE","\n            ",104],"}",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n\n        ",106],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$coreProperties",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Determine absolute zip path\n     *\n     * @param string $path\n     * @return string\n     *\/",111],["T_WHITESPACE","\n    ",116],["T_PROTECTED","protected",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","absoluteZipPath",117],"(",["T_VARIABLE","$path",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$path",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","str_replace",118],"(",["T_ARRAY","array",118],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",118],",",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",118],")",",",["T_WHITESPACE"," ",118],["T_STRING","DIRECTORY_SEPARATOR",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$path",118],")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$parts",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","array_filter",119],"(",["T_STRING","explode",119],"(",["T_STRING","DIRECTORY_SEPARATOR",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$path",119],")",",",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'strlen'",119],")",";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$absolutes",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_ARRAY","array",120],"(",")",";",["T_WHITESPACE","\n        ",120],["T_FOREACH","foreach",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$parts",121],["T_WHITESPACE"," ",121],["T_AS","as",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$part",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",122],["T_WHITESPACE"," ",122],["T_IS_EQUAL","==",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$part",122],")",["T_WHITESPACE"," ",122],["T_CONTINUE","continue",122],";",["T_WHITESPACE","\n            ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_CONSTANT_ENCAPSED_STRING","'..'",123],["T_WHITESPACE"," ",123],["T_IS_EQUAL","==",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$part",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_STRING","array_pop",124],"(",["T_VARIABLE","$absolutes",124],")",";",["T_WHITESPACE","\n            ",124],"}",["T_WHITESPACE"," ",125],["T_ELSE","else",125],["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$absolutes",126],"[","]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$part",126],";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n        ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","implode",129],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$absolutes",129],")",";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n",130],"}",["T_WHITESPACE","\n",131]]