[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Search_Lucene\n * @subpackage Document\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n\n",21],["T_DOC_COMMENT","\/** Zend_Search_Lucene_Document_OpenXml *\/",24],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Document\/OpenXml.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/** Zend_Xml_Security *\/",27],["T_WHITESPACE","\n",27],["T_COMMENT","#require_once 'Zend\/Xml\/Security.php';\n",28],["T_WHITESPACE","\n",29],["T_DOC_COMMENT","\/**\n * Xlsx document.\n *\n * @category   Zend\n * @package    Zend_Search_Lucene\n * @subpackage Document\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",30],["T_WHITESPACE","\n",38],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Search_Lucene_Document_Xlsx",39],["T_WHITESPACE"," ",39],["T_EXTENDS","extends",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Search_Lucene_Document_OpenXml",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n    ",40],["T_DOC_COMMENT","\/**\n     * Xml Schema - SpreadsheetML\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","SCHEMA_SPREADSHEETML",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/spreadsheetml\/2006\/main'",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Xml Schema - DrawingML\n     *\n     * @var string\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","SCHEMA_DRAWINGML",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/drawingml\/2006\/main'",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Xml Schema - Shared Strings\n     *\n     * @var string\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_CONST","const",60],["T_WHITESPACE"," ",60],["T_STRING","SCHEMA_SHAREDSTRINGS",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/sharedStrings'",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Xml Schema - Worksheet relation\n     *\n     * @var string\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_CONST","const",67],["T_WHITESPACE"," ",67],["T_STRING","SCHEMA_WORKSHEETRELATION",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/worksheet'",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Xml Schema - Slide notes relation\n     *\n     * @var string\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_CONST","const",74],["T_WHITESPACE"," ",74],["T_STRING","SCHEMA_SLIDENOTESRELATION",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/notesSlide'",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Object constructor\n     *\n     * @param string  $fileName\n     * @param boolean $storeContent\n     * @throws Zend_Search_Lucene_Exception\n     *\/",76],["T_WHITESPACE","\n    ",82],["T_PRIVATE","private",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","__construct",83],"(",["T_VARIABLE","$fileName",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$storeContent",83],")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_STRING","class_exists",85],"(",["T_CONSTANT_ENCAPSED_STRING","'ZipArchive'",85],",",["T_WHITESPACE"," ",85],["T_STRING","false",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Exception.php';\n",86],["T_WHITESPACE","            ",87],["T_THROW","throw",87],["T_WHITESPACE"," ",87],["T_NEW","new",87],["T_WHITESPACE"," ",87],["T_STRING","Zend_Search_Lucene_Exception",87],"(",["T_CONSTANT_ENCAPSED_STRING","'MS Office documents processing functionality requires Zip extension to be loaded'",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n\n        ",88],["T_COMMENT","\/\/ Document data holders\n",90],["T_WHITESPACE","        ",91],["T_VARIABLE","$sharedStrings",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$worksheets",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$documentBody",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$coreProperties",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",")",";",["T_WHITESPACE","\n\n        ",94],["T_COMMENT","\/\/ Open OpenXML package\n",96],["T_WHITESPACE","        ",97],["T_VARIABLE","$package",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","ZipArchive",97],"(",")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$package",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","open",98],"(",["T_VARIABLE","$fileName",98],")",";",["T_WHITESPACE","\n\n        ",98],["T_COMMENT","\/\/ Read relations and search for officeDocument\n",100],["T_WHITESPACE","        ",101],["T_VARIABLE","$relationsXml",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$package",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getFromName",101],"(",["T_CONSTANT_ENCAPSED_STRING","'_rels\/.rels'",101],")",";",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$relationsXml",102],["T_WHITESPACE"," ",102],["T_IS_IDENTICAL","===",102],["T_WHITESPACE"," ",102],["T_STRING","false",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Exception.php';\n",103],["T_WHITESPACE","            ",104],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_STRING","Zend_Search_Lucene_Exception",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid archive or corrupted .xlsx file.'",104],")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$relations",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","Zend_Xml_Security",106],["T_DOUBLE_COLON","::",106],["T_STRING","scan",106],"(",["T_VARIABLE","$relationsXml",106],")",";",["T_WHITESPACE","\n        ",106],["T_FOREACH","foreach",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$relations",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","Relationship",107],["T_WHITESPACE"," ",107],["T_AS","as",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$rel",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$rel",108],"[",["T_CONSTANT_ENCAPSED_STRING","\"Type\"",108],"]",["T_WHITESPACE"," ",108],["T_IS_EQUAL","==",108],["T_WHITESPACE"," ",108],["T_STRING","Zend_Search_Lucene_Document_OpenXml",108],["T_DOUBLE_COLON","::",108],["T_STRING","SCHEMA_OFFICEDOCUMENT",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                ",108],["T_COMMENT","\/\/ Found office document! Read relations for workbook...\n",109],["T_WHITESPACE","                ",110],["T_VARIABLE","$workbookRelations",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","Zend_Xml_Security",110],["T_DOUBLE_COLON","::",110],["T_STRING","scan",110],"(",["T_VARIABLE","$package",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getFromName",110],"(",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","absoluteZipPath",110],"(",["T_STRING","dirname",110],"(",["T_VARIABLE","$rel",110],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",110],"]",")",["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","\"\/_rels\/\"",110],["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_STRING","basename",110],"(",["T_VARIABLE","$rel",110],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",110],"]",")",["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","\".rels\"",110],")",")",["T_WHITESPACE"," ",110],")",";",["T_WHITESPACE","\n                ",110],["T_VARIABLE","$workbookRelations",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","registerXPathNamespace",111],"(",["T_CONSTANT_ENCAPSED_STRING","\"rel\"",111],",",["T_WHITESPACE"," ",111],["T_STRING","Zend_Search_Lucene_Document_OpenXml",111],["T_DOUBLE_COLON","::",111],["T_STRING","SCHEMA_RELATIONSHIP",111],")",";",["T_WHITESPACE","\n\n                ",111],["T_COMMENT","\/\/ Read shared strings\n",113],["T_WHITESPACE","                ",114],["T_VARIABLE","$sharedStringsPath",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$workbookRelations",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","xpath",114],"(",["T_CONSTANT_ENCAPSED_STRING","\"rel:Relationship[@Type='\"",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_STRING","Zend_Search_Lucene_Document_Xlsx",114],["T_DOUBLE_COLON","::",114],["T_STRING","SCHEMA_SHAREDSTRINGS",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","\"']\"",114],")",";",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$sharedStringsPath",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING_CAST","(string)",115],["T_VARIABLE","$sharedStringsPath",115],"[",["T_LNUMBER","0",115],"]","[",["T_CONSTANT_ENCAPSED_STRING","'Target'",115],"]",";",["T_WHITESPACE","\n                ",115],["T_VARIABLE","$xmlStrings",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","Zend_Xml_Security",116],["T_DOUBLE_COLON","::",116],["T_STRING","scan",116],"(",["T_VARIABLE","$package",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getFromName",116],"(",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","absoluteZipPath",116],"(",["T_STRING","dirname",116],"(",["T_VARIABLE","$rel",116],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",116],"]",")",["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_VARIABLE","$sharedStringsPath",116],")",")",["T_WHITESPACE"," ",116],")",";",["T_WHITESPACE","\n                ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_ISSET","isset",117],"(",["T_VARIABLE","$xmlStrings",117],")",["T_WHITESPACE"," ",117],["T_BOOLEAN_AND","&&",117],["T_WHITESPACE"," ",117],["T_ISSET","isset",117],"(",["T_VARIABLE","$xmlStrings",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","si",117],")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                    ",117],["T_FOREACH","foreach",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$xmlStrings",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","si",118],["T_WHITESPACE"," ",118],["T_AS","as",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$val",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                        ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_ISSET","isset",119],"(",["T_VARIABLE","$val",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","t",119],")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                            ",119],["T_VARIABLE","$sharedStrings",120],"[","]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING_CAST","(string)",120],["T_VARIABLE","$val",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","t",120],";",["T_WHITESPACE","\n                        ",120],"}",["T_WHITESPACE"," ",121],["T_ELSEIF","elseif",121],["T_WHITESPACE"," ",121],"(",["T_ISSET","isset",121],"(",["T_VARIABLE","$val",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","r",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                            ",121],["T_VARIABLE","$sharedStrings",122],"[","]",["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_parseRichText",122],"(",["T_VARIABLE","$val",122],")",";",["T_WHITESPACE","\n                        ",122],"}",["T_WHITESPACE","\n                    ",123],"}",["T_WHITESPACE","\n                ",124],"}",["T_WHITESPACE","\n\n                ",125],["T_COMMENT","\/\/ Loop relations for workbook and extract worksheets...\n",127],["T_WHITESPACE","                ",128],["T_FOREACH","foreach",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$workbookRelations",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","Relationship",128],["T_WHITESPACE"," ",128],["T_AS","as",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$workbookRelation",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n                    ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$workbookRelation",129],"[",["T_CONSTANT_ENCAPSED_STRING","\"Type\"",129],"]",["T_WHITESPACE"," ",129],["T_IS_EQUAL","==",129],["T_WHITESPACE"," ",129],["T_STRING","Zend_Search_Lucene_Document_Xlsx",129],["T_DOUBLE_COLON","::",129],["T_STRING","SCHEMA_WORKSHEETRELATION",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                        ",129],["T_VARIABLE","$worksheets",130],"[",["T_WHITESPACE"," ",130],["T_STRING","str_replace",130],"(",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'rId'",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","''",130],",",["T_WHITESPACE"," ",130],["T_STRING_CAST","(string)",130],["T_VARIABLE","$workbookRelation",130],"[",["T_CONSTANT_ENCAPSED_STRING","\"Id\"",130],"]",")",["T_WHITESPACE"," ",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","Zend_Xml_Security",130],["T_DOUBLE_COLON","::",130],["T_STRING","scan",130],"(",["T_WHITESPACE","\n                            ",130],["T_VARIABLE","$package",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getFromName",131],"(",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","absoluteZipPath",131],"(",["T_STRING","dirname",131],"(",["T_VARIABLE","$rel",131],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",131],"]",")",["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",131],["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_STRING","dirname",131],"(",["T_VARIABLE","$workbookRelation",131],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",131],"]",")",["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",131],["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_STRING","basename",131],"(",["T_VARIABLE","$workbookRelation",131],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",131],"]",")",")",["T_WHITESPACE"," ",131],")",["T_WHITESPACE","\n                        ",131],")",";",["T_WHITESPACE","\n                    ",132],"}",["T_WHITESPACE","\n                ",133],"}",["T_WHITESPACE","\n\n                ",134],["T_BREAK","break",136],";",["T_WHITESPACE","\n            ",136],"}",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n\n        ",138],["T_COMMENT","\/\/ Sort worksheets\n",140],["T_WHITESPACE","        ",141],["T_STRING","ksort",141],"(",["T_VARIABLE","$worksheets",141],")",";",["T_WHITESPACE","\n\n        ",141],["T_COMMENT","\/\/ Extract contents from worksheets\n",143],["T_WHITESPACE","        ",144],["T_FOREACH","foreach",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$worksheets",144],["T_WHITESPACE"," ",144],["T_AS","as",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$sheetKey",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$worksheet",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_FOREACH","foreach",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$worksheet",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","sheetData",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","row",145],["T_WHITESPACE"," ",145],["T_AS","as",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$row",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n                ",145],["T_FOREACH","foreach",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$row",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","c",146],["T_WHITESPACE"," ",146],["T_AS","as",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$c",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                    ",146],["T_COMMENT","\/\/ Determine data type\n",147],["T_WHITESPACE","                    ",148],["T_VARIABLE","$dataType",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING_CAST","(string)",148],["T_VARIABLE","$c",148],"[",["T_CONSTANT_ENCAPSED_STRING","\"t\"",148],"]",";",["T_WHITESPACE","\n                    ",148],["T_SWITCH","switch",149],["T_WHITESPACE"," ",149],"(",["T_VARIABLE","$dataType",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                        ",149],["T_CASE","case",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","\"s\"",150],":",["T_WHITESPACE","\n                            ",150],["T_COMMENT","\/\/ Value is a shared string\n",151],["T_WHITESPACE","                            ",152],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_STRING_CAST","(string)",152],["T_VARIABLE","$c",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","v",152],["T_WHITESPACE"," ",152],["T_IS_NOT_EQUAL","!=",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","''",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n                                ",152],["T_VARIABLE","$value",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$sharedStrings",153],"[",["T_STRING","intval",153],"(",["T_VARIABLE","$c",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","v",153],")","]",";",["T_WHITESPACE","\n                            ",153],"}",["T_WHITESPACE"," ",154],["T_ELSE","else",154],["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n                                ",154],["T_VARIABLE","$value",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","''",155],";",["T_WHITESPACE","\n                            ",155],"}",["T_WHITESPACE","\n\n                            ",156],["T_BREAK","break",158],";",["T_WHITESPACE","\n\n                        ",158],["T_CASE","case",160],["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","\"b\"",160],":",["T_WHITESPACE","\n                            ",160],["T_COMMENT","\/\/ Value is boolean\n",161],["T_WHITESPACE","                            ",162],["T_VARIABLE","$value",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING_CAST","(string)",162],["T_VARIABLE","$c",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","v",162],";",["T_WHITESPACE","\n                            ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$value",163],["T_WHITESPACE"," ",163],["T_IS_EQUAL","==",163],["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'0'",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n                                ",163],["T_VARIABLE","$value",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","false",164],";",["T_WHITESPACE","\n                            ",164],"}",["T_WHITESPACE"," ",165],["T_ELSE","else",165],["T_WHITESPACE"," ",165],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$value",165],["T_WHITESPACE"," ",165],["T_IS_EQUAL","==",165],["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'1'",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n                                ",165],["T_VARIABLE","$value",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","true",166],";",["T_WHITESPACE","\n                            ",166],"}",["T_WHITESPACE"," ",167],["T_ELSE","else",167],["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n                                ",167],["T_VARIABLE","$value",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_BOOL_CAST","(bool)",168],["T_VARIABLE","$c",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","v",168],";",["T_WHITESPACE","\n                            ",168],"}",["T_WHITESPACE","\n\n                            ",169],["T_BREAK","break",171],";",["T_WHITESPACE","\n\n                        ",171],["T_CASE","case",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","\"inlineStr\"",173],":",["T_WHITESPACE","\n                            ",173],["T_COMMENT","\/\/ Value is rich text inline\n",174],["T_WHITESPACE","                            ",175],["T_VARIABLE","$value",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_parseRichText",175],"(",["T_VARIABLE","$c",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","is",175],")",";",["T_WHITESPACE","\n\n                            ",175],["T_BREAK","break",177],";",["T_WHITESPACE","\n\n                        ",177],["T_CASE","case",179],["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","\"e\"",179],":",["T_WHITESPACE","\n                            ",179],["T_COMMENT","\/\/ Value is an error message\n",180],["T_WHITESPACE","                            ",181],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_STRING_CAST","(string)",181],["T_VARIABLE","$c",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","v",181],["T_WHITESPACE"," ",181],["T_IS_NOT_EQUAL","!=",181],["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","''",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                                ",181],["T_VARIABLE","$value",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING_CAST","(string)",182],["T_VARIABLE","$c",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","v",182],";",["T_WHITESPACE","\n                            ",182],"}",["T_WHITESPACE"," ",183],["T_ELSE","else",183],["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                                ",183],["T_VARIABLE","$value",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","''",184],";",["T_WHITESPACE","\n                            ",184],"}",["T_WHITESPACE","\n\n                            ",185],["T_BREAK","break",187],";",["T_WHITESPACE","\n\n                        ",187],["T_DEFAULT","default",189],":",["T_WHITESPACE","\n                            ",189],["T_COMMENT","\/\/ Value is a string\n",190],["T_WHITESPACE","                            ",191],["T_VARIABLE","$value",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING_CAST","(string)",191],["T_VARIABLE","$c",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","v",191],";",["T_WHITESPACE","\n\n                            ",191],["T_COMMENT","\/\/ Check for numeric values\n",193],["T_WHITESPACE","                            ",194],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_STRING","is_numeric",194],"(",["T_VARIABLE","$value",194],")",["T_WHITESPACE"," ",194],["T_BOOLEAN_AND","&&",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$dataType",194],["T_WHITESPACE"," ",194],["T_IS_NOT_EQUAL","!=",194],["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'s'",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n                                ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$value",195],["T_WHITESPACE"," ",195],["T_IS_EQUAL","==",195],["T_WHITESPACE"," ",195],["T_INT_CAST","(int)",195],["T_VARIABLE","$value",195],")",["T_WHITESPACE"," ",195],["T_VARIABLE","$value",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_INT_CAST","(int)",195],["T_VARIABLE","$value",195],";",["T_WHITESPACE","\n                                ",195],["T_ELSEIF","elseif",196],["T_WHITESPACE"," ",196],"(",["T_VARIABLE","$value",196],["T_WHITESPACE"," ",196],["T_IS_EQUAL","==",196],["T_WHITESPACE"," ",196],["T_DOUBLE_CAST","(float)",196],["T_VARIABLE","$value",196],")",["T_WHITESPACE"," ",196],["T_VARIABLE","$value",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_DOUBLE_CAST","(float)",196],["T_VARIABLE","$value",196],";",["T_WHITESPACE","\n                                ",196],["T_ELSEIF","elseif",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$value",197],["T_WHITESPACE"," ",197],["T_IS_EQUAL","==",197],["T_WHITESPACE"," ",197],["T_DOUBLE_CAST","(double)",197],["T_VARIABLE","$value",197],")",["T_WHITESPACE"," ",197],["T_VARIABLE","$value",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_DOUBLE_CAST","(double)",197],["T_VARIABLE","$value",197],";",["T_WHITESPACE","\n                            ",197],"}",["T_WHITESPACE","\n                    ",198],"}",["T_WHITESPACE","\n\n                    ",199],["T_VARIABLE","$documentBody",201],"[","]",["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$value",201],";",["T_WHITESPACE","\n                ",201],"}",["T_WHITESPACE","\n            ",202],"}",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n\n        ",204],["T_COMMENT","\/\/ Read core properties\n",206],["T_WHITESPACE","        ",207],["T_VARIABLE","$coreProperties",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","extractMetaData",207],"(",["T_VARIABLE","$package",207],")",";",["T_WHITESPACE","\n\n        ",207],["T_COMMENT","\/\/ Close file\n",209],["T_WHITESPACE","        ",210],["T_VARIABLE","$package",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","close",210],"(",")",";",["T_WHITESPACE","\n\n        ",210],["T_COMMENT","\/\/ Store filename\n",212],["T_WHITESPACE","        ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","addField",213],"(",["T_STRING","Zend_Search_Lucene_Field",213],["T_DOUBLE_COLON","::",213],["T_STRING","Text",213],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$fileName",213],",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",213],")",")",";",["T_WHITESPACE","\n\n        ",213],["T_COMMENT","\/\/ Store contents\n",215],["T_WHITESPACE","        ",216],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$storeContent",216],")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","addField",217],"(",["T_STRING","Zend_Search_Lucene_Field",217],["T_DOUBLE_COLON","::",217],["T_STRING","Text",217],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",217],",",["T_WHITESPACE"," ",217],["T_STRING","implode",217],"(",["T_CONSTANT_ENCAPSED_STRING","' '",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$documentBody",217],")",",",["T_WHITESPACE"," ",217],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",217],")",")",";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE"," ",218],["T_ELSE","else",218],["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","addField",219],"(",["T_STRING","Zend_Search_Lucene_Field",219],["T_DOUBLE_COLON","::",219],["T_STRING","UnStored",219],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",219],",",["T_WHITESPACE"," ",219],["T_STRING","implode",219],"(",["T_CONSTANT_ENCAPSED_STRING","' '",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$documentBody",219],")",",",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",219],")",")",";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n\n        ",220],["T_COMMENT","\/\/ Store meta data properties\n",222],["T_WHITESPACE","        ",223],["T_FOREACH","foreach",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$coreProperties",223],["T_WHITESPACE"," ",223],["T_AS","as",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$key",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$value",223],")",["T_WHITESPACE","\n        ",223],"{",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","addField",225],"(",["T_STRING","Zend_Search_Lucene_Field",225],["T_DOUBLE_COLON","::",225],["T_STRING","Text",225],"(",["T_VARIABLE","$key",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$value",225],",",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",225],")",")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n\n        ",226],["T_COMMENT","\/\/ Store title (if not present in meta data)\n",228],["T_WHITESPACE","        ",229],["T_IF","if",229],["T_WHITESPACE"," ",229],"(","!",["T_ISSET","isset",229],"(",["T_VARIABLE","$coreProperties",229],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",229],"]",")",")",["T_WHITESPACE","\n        ",229],"{",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","addField",231],"(",["T_STRING","Zend_Search_Lucene_Field",231],["T_DOUBLE_COLON","::",231],["T_STRING","Text",231],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$fileName",231],",",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",231],")",")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n    ",232],"}",["T_WHITESPACE","\n\n    ",233],["T_DOC_COMMENT","\/**\n     * Parse rich text XML\n     *\n     * @param SimpleXMLElement $is\n     * @return string\n     *\/",235],["T_WHITESPACE","\n    ",240],["T_PRIVATE","private",241],["T_WHITESPACE"," ",241],["T_FUNCTION","function",241],["T_WHITESPACE"," ",241],["T_STRING","_parseRichText",241],"(",["T_VARIABLE","$is",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","null",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$value",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_ARRAY","array",242],"(",")",";",["T_WHITESPACE","\n\n        ",242],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_ISSET","isset",244],"(",["T_VARIABLE","$is",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","t",244],")",")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$value",245],"[","]",["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING_CAST","(string)",245],["T_VARIABLE","$is",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","t",245],";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE"," ",246],["T_ELSE","else",246],["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_FOREACH","foreach",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$is",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","r",247],["T_WHITESPACE"," ",247],["T_AS","as",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$run",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n                ",247],["T_VARIABLE","$value",248],"[","]",["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING_CAST","(string)",248],["T_VARIABLE","$run",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","t",248],";",["T_WHITESPACE","\n            ",248],"}",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n\n        ",250],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_STRING","implode",252],"(",["T_CONSTANT_ENCAPSED_STRING","''",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$value",252],")",";",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Load Xlsx document from a file\n     *\n     * @param string  $fileName\n     * @param boolean $storeContent\n     * @return Zend_Search_Lucene_Document_Xlsx\n     *\/",255],["T_WHITESPACE","\n    ",261],["T_PUBLIC","public",262],["T_WHITESPACE"," ",262],["T_STATIC","static",262],["T_WHITESPACE"," ",262],["T_FUNCTION","function",262],["T_WHITESPACE"," ",262],["T_STRING","loadXlsxFile",262],"(",["T_VARIABLE","$fileName",262],",",["T_WHITESPACE"," ",262],["T_VARIABLE","$storeContent",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_STRING","false",262],")",["T_WHITESPACE","\n    ",262],"{",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_NEW","new",264],["T_WHITESPACE"," ",264],["T_STRING","Zend_Search_Lucene_Document_Xlsx",264],"(",["T_VARIABLE","$fileName",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$storeContent",264],")",";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n",265],"}",["T_WHITESPACE","\n",266]]