[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Search_Lucene\n * @subpackage Document\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/** Zend_Xml_Security *\/",23],["T_WHITESPACE","\n",23],["T_COMMENT","#require_once 'Zend\/Xml\/Security.php';\n",24],["T_WHITESPACE","\n",25],["T_DOC_COMMENT","\/** Zend_Search_Lucene_Document_OpenXml *\/",26],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Document\/OpenXml.php';\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/**\n * Pptx document.\n *\n * @category   Zend\n * @package    Zend_Search_Lucene\n * @subpackage Document\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",29],["T_WHITESPACE","\n",37],["T_CLASS","class",38],["T_WHITESPACE"," ",38],["T_STRING","Zend_Search_Lucene_Document_Pptx",38],["T_WHITESPACE"," ",38],["T_EXTENDS","extends",38],["T_WHITESPACE"," ",38],["T_STRING","Zend_Search_Lucene_Document_OpenXml",38],["T_WHITESPACE","\n",38],"{",["T_WHITESPACE","\n    ",39],["T_DOC_COMMENT","\/**\n     * Xml Schema - PresentationML\n     *\n     * @var string\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","SCHEMA_PRESENTATIONML",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/presentationml\/2006\/main'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Xml Schema - DrawingML\n     *\n     * @var string\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_CONST","const",52],["T_WHITESPACE"," ",52],["T_STRING","SCHEMA_DRAWINGML",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/drawingml\/2006\/main'",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Xml Schema - Slide relation\n     *\n     * @var string\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_CONST","const",59],["T_WHITESPACE"," ",59],["T_STRING","SCHEMA_SLIDERELATION",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/slide'",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Xml Schema - Slide notes relation\n     *\n     * @var string\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_CONST","const",66],["T_WHITESPACE"," ",66],["T_STRING","SCHEMA_SLIDENOTESRELATION",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\/notesSlide'",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Object constructor\n     *\n     * @param string  $fileName\n     * @param boolean $storeContent\n     * @throws Zend_Search_Lucene_Exception\n     *\/",68],["T_WHITESPACE","\n    ",74],["T_PRIVATE","private",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","__construct",75],"(",["T_VARIABLE","$fileName",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$storeContent",75],")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_IF","if",77],["T_WHITESPACE"," ",77],"(","!",["T_STRING","class_exists",77],"(",["T_CONSTANT_ENCAPSED_STRING","'ZipArchive'",77],",",["T_WHITESPACE"," ",77],["T_STRING","false",77],")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Exception.php';\n",78],["T_WHITESPACE","            ",79],["T_THROW","throw",79],["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_STRING","Zend_Search_Lucene_Exception",79],"(",["T_CONSTANT_ENCAPSED_STRING","'MS Office documents processing functionality requires Zip extension to be loaded'",79],")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n\n        ",80],["T_COMMENT","\/\/ Document data holders\n",82],["T_WHITESPACE","        ",83],["T_VARIABLE","$slides",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$slideNotes",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",")",";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$documentBody",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",")",";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$coreProperties",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",")",";",["T_WHITESPACE","\n\n        ",86],["T_COMMENT","\/\/ Open OpenXML package\n",88],["T_WHITESPACE","        ",89],["T_VARIABLE","$package",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_STRING","ZipArchive",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$package",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","open",90],"(",["T_VARIABLE","$fileName",90],")",";",["T_WHITESPACE","\n\n        ",90],["T_COMMENT","\/\/ Read relations and search for officeDocument\n",92],["T_WHITESPACE","        ",93],["T_VARIABLE","$relationsXml",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$package",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getFromName",93],"(",["T_CONSTANT_ENCAPSED_STRING","'_rels\/.rels'",93],")",";",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$relationsXml",94],["T_WHITESPACE"," ",94],["T_IS_IDENTICAL","===",94],["T_WHITESPACE"," ",94],["T_STRING","false",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_COMMENT","#require_once 'Zend\/Search\/Lucene\/Exception.php';\n",95],["T_WHITESPACE","            ",96],["T_THROW","throw",96],["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_STRING","Zend_Search_Lucene_Exception",96],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid archive or corrupted .pptx file.'",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$relations",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","Zend_Xml_Security",98],["T_DOUBLE_COLON","::",98],["T_STRING","scan",98],"(",["T_VARIABLE","$relationsXml",98],")",";",["T_WHITESPACE","\n        ",98],["T_FOREACH","foreach",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$relations",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","Relationship",99],["T_WHITESPACE"," ",99],["T_AS","as",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$rel",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$rel",100],"[",["T_CONSTANT_ENCAPSED_STRING","\"Type\"",100],"]",["T_WHITESPACE"," ",100],["T_IS_EQUAL","==",100],["T_WHITESPACE"," ",100],["T_STRING","Zend_Search_Lucene_Document_OpenXml",100],["T_DOUBLE_COLON","::",100],["T_STRING","SCHEMA_OFFICEDOCUMENT",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_COMMENT","\/\/ Found office document! Search for slides...\n",101],["T_WHITESPACE","                ",102],["T_VARIABLE","$slideRelations",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","Zend_Xml_Security",102],["T_DOUBLE_COLON","::",102],["T_STRING","scan",102],"(",["T_VARIABLE","$package",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getFromName",102],"(",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","absoluteZipPath",102],"(",["T_STRING","dirname",102],"(",["T_VARIABLE","$rel",102],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",102],"]",")",["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","\"\/_rels\/\"",102],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_STRING","basename",102],"(",["T_VARIABLE","$rel",102],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",102],"]",")",["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","\".rels\"",102],")",")",["T_WHITESPACE"," ",102],")",";",["T_WHITESPACE","\n                ",102],["T_FOREACH","foreach",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$slideRelations",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","Relationship",103],["T_WHITESPACE"," ",103],["T_AS","as",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$slideRel",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                    ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$slideRel",104],"[",["T_CONSTANT_ENCAPSED_STRING","\"Type\"",104],"]",["T_WHITESPACE"," ",104],["T_IS_EQUAL","==",104],["T_WHITESPACE"," ",104],["T_STRING","Zend_Search_Lucene_Document_Pptx",104],["T_DOUBLE_COLON","::",104],["T_STRING","SCHEMA_SLIDERELATION",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                        ",104],["T_COMMENT","\/\/ Found slide!\n",105],["T_WHITESPACE","                        ",106],["T_VARIABLE","$slides",106],"[",["T_WHITESPACE"," ",106],["T_STRING","str_replace",106],"(",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'rId'",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","''",106],",",["T_WHITESPACE"," ",106],["T_STRING_CAST","(string)",106],["T_VARIABLE","$slideRel",106],"[",["T_CONSTANT_ENCAPSED_STRING","\"Id\"",106],"]",["T_WHITESPACE"," ",106],")",["T_WHITESPACE"," ",106],"]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","Zend_Xml_Security",106],["T_DOUBLE_COLON","::",106],["T_STRING","scan",106],"(",["T_WHITESPACE","\n                            ",106],["T_VARIABLE","$package",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getFromName",107],"(",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","absoluteZipPath",107],"(",["T_STRING","dirname",107],"(",["T_VARIABLE","$rel",107],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",107],"]",")",["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_STRING","dirname",107],"(",["T_VARIABLE","$slideRel",107],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",107],"]",")",["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_STRING","basename",107],"(",["T_VARIABLE","$slideRel",107],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",107],"]",")",")",["T_WHITESPACE"," ",107],")",["T_WHITESPACE","\n                        ",107],")",";",["T_WHITESPACE","\n\n                        ",108],["T_COMMENT","\/\/ Search for slide notes\n",110],["T_WHITESPACE","                        ",111],["T_VARIABLE","$slideNotesRelations",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","Zend_Xml_Security",111],["T_DOUBLE_COLON","::",111],["T_STRING","scan",111],"(",["T_VARIABLE","$package",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getFromName",111],"(",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","absoluteZipPath",111],"(",["T_STRING","dirname",111],"(",["T_VARIABLE","$rel",111],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_STRING","dirname",111],"(",["T_VARIABLE","$slideRel",111],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\"\/_rels\/\"",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_STRING","basename",111],"(",["T_VARIABLE","$slideRel",111],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",111],"]",")",["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","\".rels\"",111],")",")",["T_WHITESPACE"," ",111],")",";",["T_WHITESPACE","\n                        ",111],["T_FOREACH","foreach",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$slideNotesRelations",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","Relationship",112],["T_WHITESPACE"," ",112],["T_AS","as",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$slideNoteRel",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                            ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$slideNoteRel",113],"[",["T_CONSTANT_ENCAPSED_STRING","\"Type\"",113],"]",["T_WHITESPACE"," ",113],["T_IS_EQUAL","==",113],["T_WHITESPACE"," ",113],["T_STRING","Zend_Search_Lucene_Document_Pptx",113],["T_DOUBLE_COLON","::",113],["T_STRING","SCHEMA_SLIDENOTESRELATION",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                                ",113],["T_COMMENT","\/\/ Found slide notes!\n",114],["T_WHITESPACE","                                ",115],["T_VARIABLE","$slideNotes",115],"[",["T_WHITESPACE"," ",115],["T_STRING","str_replace",115],"(",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'rId'",115],",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","''",115],",",["T_WHITESPACE"," ",115],["T_STRING_CAST","(string)",115],["T_VARIABLE","$slideRel",115],"[",["T_CONSTANT_ENCAPSED_STRING","\"Id\"",115],"]",["T_WHITESPACE"," ",115],")",["T_WHITESPACE"," ",115],"]",["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","Zend_Xml_Security",115],["T_DOUBLE_COLON","::",115],["T_STRING","scan",115],"(",["T_WHITESPACE","\n                                    ",115],["T_VARIABLE","$package",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getFromName",116],"(",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","absoluteZipPath",116],"(",["T_STRING","dirname",116],"(",["T_VARIABLE","$rel",116],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",116],"]",")",["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_STRING","dirname",116],"(",["T_VARIABLE","$slideRel",116],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",116],"]",")",["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_STRING","dirname",116],"(",["T_VARIABLE","$slideNoteRel",116],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",116],"]",")",["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_STRING","basename",116],"(",["T_VARIABLE","$slideNoteRel",116],"[",["T_CONSTANT_ENCAPSED_STRING","\"Target\"",116],"]",")",")",["T_WHITESPACE"," ",116],")",["T_WHITESPACE","\n                                ",116],")",";",["T_WHITESPACE","\n\n                                ",117],["T_BREAK","break",119],";",["T_WHITESPACE","\n                            ",119],"}",["T_WHITESPACE","\n                        ",120],"}",["T_WHITESPACE","\n                    ",121],"}",["T_WHITESPACE","\n                ",122],"}",["T_WHITESPACE","\n\n                ",123],["T_BREAK","break",125],";",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_COMMENT","\/\/ Sort slides\n",129],["T_WHITESPACE","        ",130],["T_STRING","ksort",130],"(",["T_VARIABLE","$slides",130],")",";",["T_WHITESPACE","\n        ",130],["T_STRING","ksort",131],"(",["T_VARIABLE","$slideNotes",131],")",";",["T_WHITESPACE","\n\n        ",131],["T_COMMENT","\/\/ Extract contents from slides\n",133],["T_WHITESPACE","        ",134],["T_FOREACH","foreach",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$slides",134],["T_WHITESPACE"," ",134],["T_AS","as",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$slideKey",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$slide",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_COMMENT","\/\/ Register namespaces\n",135],["T_WHITESPACE","            ",136],["T_VARIABLE","$slide",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","registerXPathNamespace",136],"(",["T_CONSTANT_ENCAPSED_STRING","\"p\"",136],",",["T_WHITESPACE"," ",136],["T_STRING","Zend_Search_Lucene_Document_Pptx",136],["T_DOUBLE_COLON","::",136],["T_STRING","SCHEMA_PRESENTATIONML",136],")",";",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$slide",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","registerXPathNamespace",137],"(",["T_CONSTANT_ENCAPSED_STRING","\"a\"",137],",",["T_WHITESPACE"," ",137],["T_STRING","Zend_Search_Lucene_Document_Pptx",137],["T_DOUBLE_COLON","::",137],["T_STRING","SCHEMA_DRAWINGML",137],")",";",["T_WHITESPACE","\n\n            ",137],["T_COMMENT","\/\/ Fetch all text\n",139],["T_WHITESPACE","            ",140],["T_VARIABLE","$textElements",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$slide",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","xpath",140],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/a:t'",140],")",";",["T_WHITESPACE","\n            ",140],["T_FOREACH","foreach",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$textElements",141],["T_WHITESPACE"," ",141],["T_AS","as",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$textElement",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$documentBody",142],"[","]",["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING_CAST","(string)",142],["T_VARIABLE","$textElement",142],";",["T_WHITESPACE","\n            ",142],"}",["T_WHITESPACE","\n\n            ",143],["T_COMMENT","\/\/ Extract contents from slide notes\n",145],["T_WHITESPACE","            ",146],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_ISSET","isset",146],"(",["T_VARIABLE","$slideNotes",146],"[",["T_VARIABLE","$slideKey",146],"]",")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                ",146],["T_COMMENT","\/\/ Fetch slide note\n",147],["T_WHITESPACE","                ",148],["T_VARIABLE","$slideNote",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$slideNotes",148],"[",["T_VARIABLE","$slideKey",148],"]",";",["T_WHITESPACE","\n\n                ",148],["T_COMMENT","\/\/ Register namespaces\n",150],["T_WHITESPACE","                ",151],["T_VARIABLE","$slideNote",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","registerXPathNamespace",151],"(",["T_CONSTANT_ENCAPSED_STRING","\"p\"",151],",",["T_WHITESPACE"," ",151],["T_STRING","Zend_Search_Lucene_Document_Pptx",151],["T_DOUBLE_COLON","::",151],["T_STRING","SCHEMA_PRESENTATIONML",151],")",";",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$slideNote",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","registerXPathNamespace",152],"(",["T_CONSTANT_ENCAPSED_STRING","\"a\"",152],",",["T_WHITESPACE"," ",152],["T_STRING","Zend_Search_Lucene_Document_Pptx",152],["T_DOUBLE_COLON","::",152],["T_STRING","SCHEMA_DRAWINGML",152],")",";",["T_WHITESPACE","\n\n                ",152],["T_COMMENT","\/\/ Fetch all text\n",154],["T_WHITESPACE","                ",155],["T_VARIABLE","$textElements",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$slideNote",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","xpath",155],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/a:t'",155],")",";",["T_WHITESPACE","\n                ",155],["T_FOREACH","foreach",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$textElements",156],["T_WHITESPACE"," ",156],["T_AS","as",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$textElement",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n                    ",156],["T_VARIABLE","$documentBody",157],"[","]",["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING_CAST","(string)",157],["T_VARIABLE","$textElement",157],";",["T_WHITESPACE","\n                ",157],"}",["T_WHITESPACE","\n            ",158],"}",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n\n        ",160],["T_COMMENT","\/\/ Read core properties\n",162],["T_WHITESPACE","        ",163],["T_VARIABLE","$coreProperties",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","extractMetaData",163],"(",["T_VARIABLE","$package",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_COMMENT","\/\/ Close file\n",165],["T_WHITESPACE","        ",166],["T_VARIABLE","$package",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","close",166],"(",")",";",["T_WHITESPACE","\n\n        ",166],["T_COMMENT","\/\/ Store filename\n",168],["T_WHITESPACE","        ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","addField",169],"(",["T_STRING","Zend_Search_Lucene_Field",169],["T_DOUBLE_COLON","::",169],["T_STRING","Text",169],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$fileName",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",169],")",")",";",["T_WHITESPACE","\n\n            ",169],["T_COMMENT","\/\/ Store contents\n",171],["T_WHITESPACE","        ",172],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$storeContent",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","addField",173],"(",["T_STRING","Zend_Search_Lucene_Field",173],["T_DOUBLE_COLON","::",173],["T_STRING","Text",173],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",173],",",["T_WHITESPACE"," ",173],["T_STRING","implode",173],"(",["T_CONSTANT_ENCAPSED_STRING","' '",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$documentBody",173],")",",",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",173],")",")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE"," ",174],["T_ELSE","else",174],["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","addField",175],"(",["T_STRING","Zend_Search_Lucene_Field",175],["T_DOUBLE_COLON","::",175],["T_STRING","UnStored",175],"(",["T_CONSTANT_ENCAPSED_STRING","'body'",175],",",["T_WHITESPACE"," ",175],["T_STRING","implode",175],"(",["T_CONSTANT_ENCAPSED_STRING","' '",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$documentBody",175],")",",",["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",175],")",")",";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n\n        ",176],["T_COMMENT","\/\/ Store meta data properties\n",178],["T_WHITESPACE","        ",179],["T_FOREACH","foreach",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$coreProperties",179],["T_WHITESPACE"," ",179],["T_AS","as",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$key",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$value",179],")",["T_WHITESPACE","\n        ",179],"{",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","addField",181],"(",["T_STRING","Zend_Search_Lucene_Field",181],["T_DOUBLE_COLON","::",181],["T_STRING","Text",181],"(",["T_VARIABLE","$key",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$value",181],",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",181],")",")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n\n        ",182],["T_COMMENT","\/\/ Store title (if not present in meta data)\n",184],["T_WHITESPACE","        ",185],["T_IF","if",185],["T_WHITESPACE"," ",185],"(","!",["T_ISSET","isset",185],"(",["T_VARIABLE","$coreProperties",185],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",185],"]",")",")",["T_WHITESPACE","\n        ",185],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","addField",187],"(",["T_STRING","Zend_Search_Lucene_Field",187],["T_DOUBLE_COLON","::",187],["T_STRING","Text",187],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$fileName",187],",",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",187],")",")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Load Pptx document from a file\n     *\n     * @param string  $fileName\n     * @param boolean $storeContent\n     * @return Zend_Search_Lucene_Document_Pptx\n     *\/",191],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_STATIC","static",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","loadPptxFile",198],"(",["T_VARIABLE","$fileName",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$storeContent",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","false",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_RETURN","return",200],["T_WHITESPACE"," ",200],["T_NEW","new",200],["T_WHITESPACE"," ",200],["T_STRING","Zend_Search_Lucene_Document_Pptx",200],"(",["T_VARIABLE","$fileName",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$storeContent",200],")",";",["T_WHITESPACE","\n    ",200],"}",["T_WHITESPACE","\n",201],"}",["T_WHITESPACE","\n",202]]