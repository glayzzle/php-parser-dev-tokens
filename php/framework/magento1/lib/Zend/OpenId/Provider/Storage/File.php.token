[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Provider\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",3],["T_WHITESPACE","\n\n",22],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId_Provider_Storage\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once \"Zend\/OpenId\/Provider\/Storage.php\";\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/**\n * External storage implemmentation using serialized files\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Provider\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",29],["T_WHITESPACE","\n",37],["T_CLASS","class",38],["T_WHITESPACE"," ",38],["T_STRING","Zend_OpenId_Provider_Storage_File",38],["T_WHITESPACE"," ",38],["T_EXTENDS","extends",38],["T_WHITESPACE"," ",38],["T_STRING","Zend_OpenId_Provider_Storage",38],["T_WHITESPACE","\n",38],"{",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Directory name to store data files in\n     *\n     * @var string $_dir\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PRIVATE","private",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_dir",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Constructs storage object and creates storage directory\n     *\n     * @param string $dir directory name to store data files in\n     * @throws Zend_OpenId_Exception\n     *\/",48],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","__construct",54],"(",["T_VARIABLE","$dir",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$dir",56],["T_WHITESPACE"," ",56],["T_IS_IDENTICAL","===",56],["T_WHITESPACE"," ",56],["T_STRING","null",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$tmp",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","getenv",57],"(",["T_CONSTANT_ENCAPSED_STRING","'TMP'",57],")",";",["T_WHITESPACE","\n            ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_EMPTY","empty",58],"(",["T_VARIABLE","$tmp",58],")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$tmp",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","getenv",59],"(",["T_CONSTANT_ENCAPSED_STRING","'TEMP'",59],")",";",["T_WHITESPACE","\n                ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_EMPTY","empty",60],"(",["T_VARIABLE","$tmp",60],")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                    ",60],["T_VARIABLE","$tmp",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","\"\/tmp\"",61],";",["T_WHITESPACE","\n                ",61],"}",["T_WHITESPACE","\n            ",62],"}",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$user",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","get_current_user",64],"(",")",";",["T_WHITESPACE","\n            ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_STRING","is_string",65],"(",["T_VARIABLE","$user",65],")",["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],"!",["T_EMPTY","empty",65],"(",["T_VARIABLE","$user",65],")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$tmp",66],["T_WHITESPACE"," ",66],["T_CONCAT_EQUAL",".=",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'\/'",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$user",66],";",["T_WHITESPACE","\n            ",66],"}",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$dir",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$tmp",68],["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'\/openid\/provider'",68],";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_dir",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$dir",70],";",["T_WHITESPACE","\n        ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(","!",["T_STRING","is_dir",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_dir",71],")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(","!","@",["T_STRING","mkdir",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_dir",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","0700",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","1",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_THROW","throw",73],["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","Zend_OpenId_Exception",73],"(",["T_WHITESPACE","\n                    ",73],"\"",["T_ENCAPSED_AND_WHITESPACE","Cannot access storage directory ",74],["T_VARIABLE","$dir",74],"\"",",",["T_WHITESPACE","\n                    ",74],["T_STRING","Zend_OpenId_Exception",75],["T_DOUBLE_COLON","::",75],["T_STRING","ERROR_STORAGE",75],")",";",["T_WHITESPACE","\n            ",75],"}",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(","(",["T_VARIABLE","$f",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","fopen",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_dir",78],".",["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'w+'",78],")",")",["T_WHITESPACE"," ",78],["T_IS_IDENTICAL","===",78],["T_WHITESPACE"," ",78],["T_STRING","null",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_THROW","throw",79],["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_STRING","Zend_OpenId_Exception",79],"(",["T_WHITESPACE","\n                ",79],["T_CONSTANT_ENCAPSED_STRING","'Cannot create a lock file in the directory '",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$dir",80],",",["T_WHITESPACE","\n                ",80],["T_STRING","Zend_OpenId_Exception",81],["T_DOUBLE_COLON","::",81],["T_STRING","ERROR_STORAGE",81],")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_STRING","fclose",83],"(",["T_VARIABLE","$f",83],")",";",["T_WHITESPACE","\n        ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(","(",["T_VARIABLE","$f",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","fopen",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_dir",84],".",["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'w+'",84],")",")",["T_WHITESPACE"," ",84],["T_IS_IDENTICAL","===",84],["T_WHITESPACE"," ",84],["T_STRING","null",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_THROW","throw",85],["T_WHITESPACE"," ",85],["T_NEW","new",85],["T_WHITESPACE"," ",85],["T_STRING","Zend_OpenId_Exception",85],"(",["T_WHITESPACE","\n                ",85],["T_CONSTANT_ENCAPSED_STRING","'Cannot create a lock file in the directory '",86],["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_VARIABLE","$dir",86],",",["T_WHITESPACE","\n                ",86],["T_STRING","Zend_OpenId_Exception",87],["T_DOUBLE_COLON","::",87],["T_STRING","ERROR_STORAGE",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n        ",88],["T_STRING","fclose",89],"(",["T_VARIABLE","$f",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Stores information about session identified by $handle\n     *\n     * @param string $handle assiciation handle\n     * @param string $macFunc HMAC function (sha1 or sha256)\n     * @param string $secret shared secret\n     * @param string $expires expiration UNIX time\n     * @return bool\n     *\/",92],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","addAssociation",101],"(",["T_VARIABLE","$handle",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$macFunc",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$secret",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$expires",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$name",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_dir",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_'",103],["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_STRING","md5",103],"(",["T_VARIABLE","$handle",103],")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$lock",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],"@",["T_STRING","fopen",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_dir",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'w+'",104],")",";",["T_WHITESPACE","\n        ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$lock",105],["T_WHITESPACE"," ",105],["T_IS_IDENTICAL","===",105],["T_WHITESPACE"," ",105],["T_STRING","false",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_STRING","false",106],";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(","!",["T_STRING","flock",108],"(",["T_VARIABLE","$lock",108],",",["T_WHITESPACE"," ",108],["T_STRING","LOCK_EX",108],")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_STRING","fclose",109],"(",["T_VARIABLE","$lock",109],")",";",["T_WHITESPACE","\n            ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_STRING","false",110],";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_TRY","try",112],["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$f",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],"@",["T_STRING","fopen",113],"(",["T_VARIABLE","$name",113],",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'w+'",113],")",";",["T_WHITESPACE","\n            ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$f",114],["T_WHITESPACE"," ",114],["T_IS_IDENTICAL","===",114],["T_WHITESPACE"," ",114],["T_STRING","false",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                ",114],["T_STRING","fclose",115],"(",["T_VARIABLE","$lock",115],")",";",["T_WHITESPACE","\n                ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_STRING","false",116],";",["T_WHITESPACE","\n            ",116],"}",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$data",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","serialize",118],"(",["T_ARRAY","array",118],"(",["T_VARIABLE","$handle",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$macFunc",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$secret",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$expires",118],")",")",";",["T_WHITESPACE","\n            ",118],["T_STRING","fwrite",119],"(",["T_VARIABLE","$f",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$data",119],")",";",["T_WHITESPACE","\n            ",119],["T_STRING","fclose",120],"(",["T_VARIABLE","$f",120],")",";",["T_WHITESPACE","\n            ",120],["T_STRING","fclose",121],"(",["T_VARIABLE","$lock",121],")",";",["T_WHITESPACE","\n            ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_STRING","true",122],";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE"," ",123],["T_CATCH","catch",123],["T_WHITESPACE"," ",123],"(",["T_STRING","Exception",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$e",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_STRING","fclose",124],"(",["T_VARIABLE","$lock",124],")",";",["T_WHITESPACE","\n            ",124],["T_THROW","throw",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$e",125],";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Gets information about association identified by $handle\n     * Returns true if given association found and not expired and false\n     * otherwise\n     *\n     * @param string $handle assiciation handle\n     * @param string &$macFunc HMAC function (sha1 or sha256)\n     * @param string &$secret shared secret\n     * @param string &$expires expiration UNIX time\n     * @return bool\n     *\/",129],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","getAssociation",140],"(",["T_VARIABLE","$handle",140],",",["T_WHITESPACE"," ",140],"&",["T_VARIABLE","$macFunc",140],",",["T_WHITESPACE"," ",140],"&",["T_VARIABLE","$secret",140],",",["T_WHITESPACE"," ",140],"&",["T_VARIABLE","$expires",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$name",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_dir",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_'",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_STRING","md5",142],"(",["T_VARIABLE","$handle",142],")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$lock",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],"@",["T_STRING","fopen",143],"(",["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_dir",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'w+'",143],")",";",["T_WHITESPACE","\n        ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$lock",144],["T_WHITESPACE"," ",144],["T_IS_IDENTICAL","===",144],["T_WHITESPACE"," ",144],["T_STRING","false",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_STRING","false",145],";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n        ",146],["T_IF","if",147],["T_WHITESPACE"," ",147],"(","!",["T_STRING","flock",147],"(",["T_VARIABLE","$lock",147],",",["T_WHITESPACE"," ",147],["T_STRING","LOCK_EX",147],")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_STRING","fclose",148],"(",["T_VARIABLE","$lock",148],")",";",["T_WHITESPACE","\n            ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","false",149],";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n        ",150],["T_TRY","try",151],["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$f",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],"@",["T_STRING","fopen",152],"(",["T_VARIABLE","$name",152],",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'r'",152],")",";",["T_WHITESPACE","\n            ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$f",153],["T_WHITESPACE"," ",153],["T_IS_IDENTICAL","===",153],["T_WHITESPACE"," ",153],["T_STRING","false",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n                ",153],["T_STRING","fclose",154],"(",["T_VARIABLE","$lock",154],")",";",["T_WHITESPACE","\n                ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_STRING","false",155],";",["T_WHITESPACE","\n            ",155],"}",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$ret",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","false",157],";",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$data",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","stream_get_contents",158],"(",["T_VARIABLE","$f",158],")",";",["T_WHITESPACE","\n            ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(","!",["T_EMPTY","empty",159],"(",["T_VARIABLE","$data",159],")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                ",159],["T_LIST","list",160],"(",["T_VARIABLE","$storedHandle",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$macFunc",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$secret",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$expires",160],")",["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","unserialize",160],"(",["T_VARIABLE","$data",160],")",";",["T_WHITESPACE","\n                ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(",["T_VARIABLE","$handle",161],["T_WHITESPACE"," ",161],["T_IS_IDENTICAL","===",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$storedHandle",161],["T_WHITESPACE"," ",161],["T_BOOLEAN_AND","&&",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$expires",161],["T_WHITESPACE"," ",161],">",["T_WHITESPACE"," ",161],["T_STRING","time",161],"(",")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n                    ",161],["T_VARIABLE","$ret",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","true",162],";",["T_WHITESPACE","\n                ",162],"}",["T_WHITESPACE"," ",163],["T_ELSE","else",163],["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n                    ",163],["T_STRING","fclose",164],"(",["T_VARIABLE","$f",164],")",";",["T_WHITESPACE","\n                    ",164],"@",["T_STRING","unlink",165],"(",["T_VARIABLE","$name",165],")",";",["T_WHITESPACE","\n                    ",165],["T_STRING","fclose",166],"(",["T_VARIABLE","$lock",166],")",";",["T_WHITESPACE","\n                    ",166],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_STRING","false",167],";",["T_WHITESPACE","\n                ",167],"}",["T_WHITESPACE","\n            ",168],"}",["T_WHITESPACE","\n            ",169],["T_STRING","fclose",170],"(",["T_VARIABLE","$f",170],")",";",["T_WHITESPACE","\n            ",170],["T_STRING","fclose",171],"(",["T_VARIABLE","$lock",171],")",";",["T_WHITESPACE","\n            ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$ret",172],";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE"," ",173],["T_CATCH","catch",173],["T_WHITESPACE"," ",173],"(",["T_STRING","Exception",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$e",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n            ",173],["T_STRING","fclose",174],"(",["T_VARIABLE","$lock",174],")",";",["T_WHITESPACE","\n            ",174],["T_THROW","throw",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$e",175],";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Removes information about association identified by $handle\n     *\n     * @param string $handle assiciation handle\n     * @return bool\n     *\/",179],["T_WHITESPACE","\n    ",184],["T_PUBLIC","public",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","delAssociation",185],"(",["T_VARIABLE","$handle",185],")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$name",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_dir",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_'",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_STRING","md5",187],"(",["T_VARIABLE","$handle",187],")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$lock",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],"@",["T_STRING","fopen",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_dir",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",188],",",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'w+'",188],")",";",["T_WHITESPACE","\n        ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$lock",189],["T_WHITESPACE"," ",189],["T_IS_IDENTICAL","===",189],["T_WHITESPACE"," ",189],["T_STRING","false",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_STRING","false",190],";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n        ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(","!",["T_STRING","flock",192],"(",["T_VARIABLE","$lock",192],",",["T_WHITESPACE"," ",192],["T_STRING","LOCK_EX",192],")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_STRING","fclose",193],"(",["T_VARIABLE","$lock",193],")",";",["T_WHITESPACE","\n            ",193],["T_RETURN","return",194],["T_WHITESPACE"," ",194],["T_STRING","false",194],";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n        ",195],["T_TRY","try",196],["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n            ",196],"@",["T_STRING","unlink",197],"(",["T_VARIABLE","$name",197],")",";",["T_WHITESPACE","\n            ",197],["T_STRING","fclose",198],"(",["T_VARIABLE","$lock",198],")",";",["T_WHITESPACE","\n            ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_STRING","true",199],";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE"," ",200],["T_CATCH","catch",200],["T_WHITESPACE"," ",200],"(",["T_STRING","Exception",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$e",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_STRING","fclose",201],"(",["T_VARIABLE","$lock",201],")",";",["T_WHITESPACE","\n            ",201],["T_THROW","throw",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$e",202],";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Register new user with given $id and $password\n     * Returns true in case of success and false if user with given $id already\n     * exists\n     *\n     * @param string $id user identity URL\n     * @param string $password encoded user password\n     * @return bool\n     *\/",206],["T_WHITESPACE","\n    ",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","addUser",215],"(",["T_VARIABLE","$id",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$password",215],")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$name",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_dir",217],["T_WHITESPACE"," ",217],".",["T_WHITESPACE"," ",217],["T_CONSTANT_ENCAPSED_STRING","'\/user_'",217],["T_WHITESPACE"," ",217],".",["T_WHITESPACE"," ",217],["T_STRING","md5",217],"(",["T_VARIABLE","$id",217],")",";",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$lock",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],"@",["T_STRING","fopen",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_dir",218],["T_WHITESPACE"," ",218],".",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",218],",",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","'w+'",218],")",";",["T_WHITESPACE","\n        ",218],["T_IF","if",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$lock",219],["T_WHITESPACE"," ",219],["T_IS_IDENTICAL","===",219],["T_WHITESPACE"," ",219],["T_STRING","false",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n            ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_STRING","false",220],";",["T_WHITESPACE","\n        ",220],"}",["T_WHITESPACE","\n        ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(","!",["T_STRING","flock",222],"(",["T_VARIABLE","$lock",222],",",["T_WHITESPACE"," ",222],["T_STRING","LOCK_EX",222],")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_STRING","fclose",223],"(",["T_VARIABLE","$lock",223],")",";",["T_WHITESPACE","\n            ",223],["T_RETURN","return",224],["T_WHITESPACE"," ",224],["T_STRING","false",224],";",["T_WHITESPACE","\n        ",224],"}",["T_WHITESPACE","\n        ",225],["T_TRY","try",226],["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$f",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],"@",["T_STRING","fopen",227],"(",["T_VARIABLE","$name",227],",",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'x'",227],")",";",["T_WHITESPACE","\n            ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$f",228],["T_WHITESPACE"," ",228],["T_IS_IDENTICAL","===",228],["T_WHITESPACE"," ",228],["T_STRING","false",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n                ",228],["T_STRING","fclose",229],"(",["T_VARIABLE","$lock",229],")",";",["T_WHITESPACE","\n                ",229],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_STRING","false",230],";",["T_WHITESPACE","\n            ",230],"}",["T_WHITESPACE","\n            ",231],["T_VARIABLE","$data",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_STRING","serialize",232],"(",["T_ARRAY","array",232],"(",["T_VARIABLE","$id",232],",",["T_WHITESPACE"," ",232],["T_VARIABLE","$password",232],",",["T_WHITESPACE"," ",232],["T_ARRAY","array",232],"(",")",")",")",";",["T_WHITESPACE","\n            ",232],["T_STRING","fwrite",233],"(",["T_VARIABLE","$f",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$data",233],")",";",["T_WHITESPACE","\n            ",233],["T_STRING","fclose",234],"(",["T_VARIABLE","$f",234],")",";",["T_WHITESPACE","\n            ",234],["T_STRING","fclose",235],"(",["T_VARIABLE","$lock",235],")",";",["T_WHITESPACE","\n            ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_STRING","true",236],";",["T_WHITESPACE","\n        ",236],"}",["T_WHITESPACE"," ",237],["T_CATCH","catch",237],["T_WHITESPACE"," ",237],"(",["T_STRING","Exception",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$e",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_STRING","fclose",238],"(",["T_VARIABLE","$lock",238],")",";",["T_WHITESPACE","\n            ",238],["T_THROW","throw",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$e",239],";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n    ",240],"}",["T_WHITESPACE","\n\n    ",241],["T_DOC_COMMENT","\/**\n     * Returns true if user with given $id exists and false otherwise\n     *\n     * @param string $id user identity URL\n     * @return bool\n     *\/",243],["T_WHITESPACE","\n    ",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","hasUser",249],"(",["T_VARIABLE","$id",249],")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$name",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_dir",251],["T_WHITESPACE"," ",251],".",["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'\/user_'",251],["T_WHITESPACE"," ",251],".",["T_WHITESPACE"," ",251],["T_STRING","md5",251],"(",["T_VARIABLE","$id",251],")",";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$lock",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],"@",["T_STRING","fopen",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_dir",252],["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",252],",",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'w+'",252],")",";",["T_WHITESPACE","\n        ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$lock",253],["T_WHITESPACE"," ",253],["T_IS_IDENTICAL","===",253],["T_WHITESPACE"," ",253],["T_STRING","false",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n            ",253],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_STRING","false",254],";",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n        ",255],["T_IF","if",256],["T_WHITESPACE"," ",256],"(","!",["T_STRING","flock",256],"(",["T_VARIABLE","$lock",256],",",["T_WHITESPACE"," ",256],["T_STRING","LOCK_SH",256],")",")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n            ",256],["T_STRING","fclose",257],"(",["T_VARIABLE","$lock",257],")",";",["T_WHITESPACE","\n            ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_STRING","false",258],";",["T_WHITESPACE","\n        ",258],"}",["T_WHITESPACE","\n        ",259],["T_TRY","try",260],["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$f",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],"@",["T_STRING","fopen",261],"(",["T_VARIABLE","$name",261],",",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'r'",261],")",";",["T_WHITESPACE","\n            ",261],["T_IF","if",262],["T_WHITESPACE"," ",262],"(",["T_VARIABLE","$f",262],["T_WHITESPACE"," ",262],["T_IS_IDENTICAL","===",262],["T_WHITESPACE"," ",262],["T_STRING","false",262],")",["T_WHITESPACE"," ",262],"{",["T_WHITESPACE","\n                ",262],["T_STRING","fclose",263],"(",["T_VARIABLE","$lock",263],")",";",["T_WHITESPACE","\n                ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_STRING","false",264],";",["T_WHITESPACE","\n            ",264],"}",["T_WHITESPACE","\n            ",265],["T_VARIABLE","$ret",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_STRING","false",266],";",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$data",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","stream_get_contents",267],"(",["T_VARIABLE","$f",267],")",";",["T_WHITESPACE","\n            ",267],["T_IF","if",268],["T_WHITESPACE"," ",268],"(","!",["T_EMPTY","empty",268],"(",["T_VARIABLE","$data",268],")",")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n                ",268],["T_LIST","list",269],"(",["T_VARIABLE","$storedId",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$storedPassword",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$trusted",269],")",["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","unserialize",269],"(",["T_VARIABLE","$data",269],")",";",["T_WHITESPACE","\n                ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_VARIABLE","$id",270],["T_WHITESPACE"," ",270],["T_IS_IDENTICAL","===",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$storedId",270],")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n                    ",270],["T_VARIABLE","$ret",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING","true",271],";",["T_WHITESPACE","\n                ",271],"}",["T_WHITESPACE","\n            ",272],"}",["T_WHITESPACE","\n            ",273],["T_STRING","fclose",274],"(",["T_VARIABLE","$f",274],")",";",["T_WHITESPACE","\n            ",274],["T_STRING","fclose",275],"(",["T_VARIABLE","$lock",275],")",";",["T_WHITESPACE","\n            ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$ret",276],";",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE"," ",277],["T_CATCH","catch",277],["T_WHITESPACE"," ",277],"(",["T_STRING","Exception",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$e",277],")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n            ",277],["T_STRING","fclose",278],"(",["T_VARIABLE","$lock",278],")",";",["T_WHITESPACE","\n            ",278],["T_THROW","throw",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$e",279],";",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Verify if user with given $id exists and has specified $password\n     *\n     * @param string $id user identity URL\n     * @param string $password user password\n     * @return bool\n     *\/",283],["T_WHITESPACE","\n    ",289],["T_PUBLIC","public",290],["T_WHITESPACE"," ",290],["T_FUNCTION","function",290],["T_WHITESPACE"," ",290],["T_STRING","checkUser",290],"(",["T_VARIABLE","$id",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$password",290],")",["T_WHITESPACE","\n    ",290],"{",["T_WHITESPACE","\n        ",291],["T_VARIABLE","$name",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_dir",292],["T_WHITESPACE"," ",292],".",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'\/user_'",292],["T_WHITESPACE"," ",292],".",["T_WHITESPACE"," ",292],["T_STRING","md5",292],"(",["T_VARIABLE","$id",292],")",";",["T_WHITESPACE","\n        ",292],["T_VARIABLE","$lock",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],"@",["T_STRING","fopen",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_dir",293],["T_WHITESPACE"," ",293],".",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",293],",",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'w+'",293],")",";",["T_WHITESPACE","\n        ",293],["T_IF","if",294],["T_WHITESPACE"," ",294],"(",["T_VARIABLE","$lock",294],["T_WHITESPACE"," ",294],["T_IS_IDENTICAL","===",294],["T_WHITESPACE"," ",294],["T_STRING","false",294],")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_STRING","false",295],";",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n        ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(","!",["T_STRING","flock",297],"(",["T_VARIABLE","$lock",297],",",["T_WHITESPACE"," ",297],["T_STRING","LOCK_SH",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_STRING","fclose",298],"(",["T_VARIABLE","$lock",298],")",";",["T_WHITESPACE","\n            ",298],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_STRING","false",299],";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n        ",300],["T_TRY","try",301],["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n            ",301],["T_VARIABLE","$f",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],"@",["T_STRING","fopen",302],"(",["T_VARIABLE","$name",302],",",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'r'",302],")",";",["T_WHITESPACE","\n            ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$f",303],["T_WHITESPACE"," ",303],["T_IS_IDENTICAL","===",303],["T_WHITESPACE"," ",303],["T_STRING","false",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n                ",303],["T_STRING","fclose",304],"(",["T_VARIABLE","$lock",304],")",";",["T_WHITESPACE","\n                ",304],["T_RETURN","return",305],["T_WHITESPACE"," ",305],["T_STRING","false",305],";",["T_WHITESPACE","\n            ",305],"}",["T_WHITESPACE","\n            ",306],["T_VARIABLE","$ret",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_STRING","false",307],";",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$data",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","stream_get_contents",308],"(",["T_VARIABLE","$f",308],")",";",["T_WHITESPACE","\n            ",308],["T_IF","if",309],["T_WHITESPACE"," ",309],"(","!",["T_EMPTY","empty",309],"(",["T_VARIABLE","$data",309],")",")",["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n                ",309],["T_LIST","list",310],"(",["T_VARIABLE","$storedId",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$storedPassword",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$trusted",310],")",["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_STRING","unserialize",310],"(",["T_VARIABLE","$data",310],")",";",["T_WHITESPACE","\n                ",310],["T_IF","if",311],["T_WHITESPACE"," ",311],"(",["T_VARIABLE","$id",311],["T_WHITESPACE"," ",311],["T_IS_IDENTICAL","===",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$storedId",311],["T_WHITESPACE"," ",311],["T_BOOLEAN_AND","&&",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$password",311],["T_WHITESPACE"," ",311],["T_IS_IDENTICAL","===",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$storedPassword",311],")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n                    ",311],["T_VARIABLE","$ret",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_STRING","true",312],";",["T_WHITESPACE","\n                ",312],"}",["T_WHITESPACE","\n            ",313],"}",["T_WHITESPACE","\n            ",314],["T_STRING","fclose",315],"(",["T_VARIABLE","$f",315],")",";",["T_WHITESPACE","\n            ",315],["T_STRING","fclose",316],"(",["T_VARIABLE","$lock",316],")",";",["T_WHITESPACE","\n            ",316],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$ret",317],";",["T_WHITESPACE","\n        ",317],"}",["T_WHITESPACE"," ",318],["T_CATCH","catch",318],["T_WHITESPACE"," ",318],"(",["T_STRING","Exception",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$e",318],")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_STRING","fclose",319],"(",["T_VARIABLE","$lock",319],")",";",["T_WHITESPACE","\n            ",319],["T_THROW","throw",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$e",320],";",["T_WHITESPACE","\n        ",320],"}",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n\n    ",322],["T_DOC_COMMENT","\/**\n     * Removes information abou specified user\n     *\n     * @param string $id user identity URL\n     * @return bool\n     *\/",324],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","delUser",330],"(",["T_VARIABLE","$id",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$name",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_dir",332],["T_WHITESPACE"," ",332],".",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'\/user_'",332],["T_WHITESPACE"," ",332],".",["T_WHITESPACE"," ",332],["T_STRING","md5",332],"(",["T_VARIABLE","$id",332],")",";",["T_WHITESPACE","\n        ",332],["T_VARIABLE","$lock",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],"@",["T_STRING","fopen",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_dir",333],["T_WHITESPACE"," ",333],".",["T_WHITESPACE"," ",333],["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",333],",",["T_WHITESPACE"," ",333],["T_CONSTANT_ENCAPSED_STRING","'w+'",333],")",";",["T_WHITESPACE","\n        ",333],["T_IF","if",334],["T_WHITESPACE"," ",334],"(",["T_VARIABLE","$lock",334],["T_WHITESPACE"," ",334],["T_IS_IDENTICAL","===",334],["T_WHITESPACE"," ",334],["T_STRING","false",334],")",["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n            ",334],["T_RETURN","return",335],["T_WHITESPACE"," ",335],["T_STRING","false",335],";",["T_WHITESPACE","\n        ",335],"}",["T_WHITESPACE","\n        ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(","!",["T_STRING","flock",337],"(",["T_VARIABLE","$lock",337],",",["T_WHITESPACE"," ",337],["T_STRING","LOCK_EX",337],")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_STRING","fclose",338],"(",["T_VARIABLE","$lock",338],")",";",["T_WHITESPACE","\n            ",338],["T_RETURN","return",339],["T_WHITESPACE"," ",339],["T_STRING","false",339],";",["T_WHITESPACE","\n        ",339],"}",["T_WHITESPACE","\n        ",340],["T_TRY","try",341],["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],"@",["T_STRING","unlink",342],"(",["T_VARIABLE","$name",342],")",";",["T_WHITESPACE","\n            ",342],["T_STRING","fclose",343],"(",["T_VARIABLE","$lock",343],")",";",["T_WHITESPACE","\n            ",343],["T_RETURN","return",344],["T_WHITESPACE"," ",344],["T_STRING","true",344],";",["T_WHITESPACE","\n        ",344],"}",["T_WHITESPACE"," ",345],["T_CATCH","catch",345],["T_WHITESPACE"," ",345],"(",["T_STRING","Exception",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$e",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n            ",345],["T_STRING","fclose",346],"(",["T_VARIABLE","$lock",346],")",";",["T_WHITESPACE","\n            ",346],["T_THROW","throw",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$e",347],";",["T_WHITESPACE","\n        ",347],"}",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * Returns array of all trusted\/untrusted sites for given user identified\n     * by $id\n     *\n     * @param string $id user identity URL\n     * @return array\n     *\/",351],["T_WHITESPACE","\n    ",357],["T_PUBLIC","public",358],["T_WHITESPACE"," ",358],["T_FUNCTION","function",358],["T_WHITESPACE"," ",358],["T_STRING","getTrustedSites",358],"(",["T_VARIABLE","$id",358],")",["T_WHITESPACE","\n    ",358],"{",["T_WHITESPACE","\n        ",359],["T_VARIABLE","$name",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_dir",360],["T_WHITESPACE"," ",360],".",["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","'\/user_'",360],["T_WHITESPACE"," ",360],".",["T_WHITESPACE"," ",360],["T_STRING","md5",360],"(",["T_VARIABLE","$id",360],")",";",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$lock",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],"@",["T_STRING","fopen",361],"(",["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","_dir",361],["T_WHITESPACE"," ",361],".",["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",361],",",["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'w+'",361],")",";",["T_WHITESPACE","\n        ",361],["T_IF","if",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$lock",362],["T_WHITESPACE"," ",362],["T_IS_IDENTICAL","===",362],["T_WHITESPACE"," ",362],["T_STRING","false",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_RETURN","return",363],["T_WHITESPACE"," ",363],["T_STRING","false",363],";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE","\n        ",364],["T_IF","if",365],["T_WHITESPACE"," ",365],"(","!",["T_STRING","flock",365],"(",["T_VARIABLE","$lock",365],",",["T_WHITESPACE"," ",365],["T_STRING","LOCK_SH",365],")",")",["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n            ",365],["T_STRING","fclose",366],"(",["T_VARIABLE","$lock",366],")",";",["T_WHITESPACE","\n            ",366],["T_RETURN","return",367],["T_WHITESPACE"," ",367],["T_STRING","false",367],";",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE","\n        ",368],["T_TRY","try",369],["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n            ",369],["T_VARIABLE","$f",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],"@",["T_STRING","fopen",370],"(",["T_VARIABLE","$name",370],",",["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'r'",370],")",";",["T_WHITESPACE","\n            ",370],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_VARIABLE","$f",371],["T_WHITESPACE"," ",371],["T_IS_IDENTICAL","===",371],["T_WHITESPACE"," ",371],["T_STRING","false",371],")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n                ",371],["T_STRING","fclose",372],"(",["T_VARIABLE","$lock",372],")",";",["T_WHITESPACE","\n                ",372],["T_RETURN","return",373],["T_WHITESPACE"," ",373],["T_STRING","false",373],";",["T_WHITESPACE","\n            ",373],"}",["T_WHITESPACE","\n            ",374],["T_VARIABLE","$ret",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_STRING","false",375],";",["T_WHITESPACE","\n            ",375],["T_VARIABLE","$data",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_STRING","stream_get_contents",376],"(",["T_VARIABLE","$f",376],")",";",["T_WHITESPACE","\n            ",376],["T_IF","if",377],["T_WHITESPACE"," ",377],"(","!",["T_EMPTY","empty",377],"(",["T_VARIABLE","$data",377],")",")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n                ",377],["T_LIST","list",378],"(",["T_VARIABLE","$storedId",378],",",["T_WHITESPACE"," ",378],["T_VARIABLE","$storedPassword",378],",",["T_WHITESPACE"," ",378],["T_VARIABLE","$trusted",378],")",["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_STRING","unserialize",378],"(",["T_VARIABLE","$data",378],")",";",["T_WHITESPACE","\n                ",378],["T_IF","if",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$id",379],["T_WHITESPACE"," ",379],["T_IS_IDENTICAL","===",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$storedId",379],")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n                    ",379],["T_VARIABLE","$ret",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$trusted",380],";",["T_WHITESPACE","\n                ",380],"}",["T_WHITESPACE","\n            ",381],"}",["T_WHITESPACE","\n            ",382],["T_STRING","fclose",383],"(",["T_VARIABLE","$f",383],")",";",["T_WHITESPACE","\n            ",383],["T_STRING","fclose",384],"(",["T_VARIABLE","$lock",384],")",";",["T_WHITESPACE","\n            ",384],["T_RETURN","return",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$ret",385],";",["T_WHITESPACE","\n        ",385],"}",["T_WHITESPACE"," ",386],["T_CATCH","catch",386],["T_WHITESPACE"," ",386],"(",["T_STRING","Exception",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$e",386],")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n            ",386],["T_STRING","fclose",387],"(",["T_VARIABLE","$lock",387],")",";",["T_WHITESPACE","\n            ",387],["T_THROW","throw",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$e",388],";",["T_WHITESPACE","\n        ",388],"}",["T_WHITESPACE","\n    ",389],"}",["T_WHITESPACE","\n\n    ",390],["T_DOC_COMMENT","\/**\n     * Stores information about trusted\/untrusted site for given user\n     *\n     * @param string $id user identity URL\n     * @param string $site site URL\n     * @param mixed $trusted trust data from extension or just a boolean value\n     * @return bool\n     *\/",392],["T_WHITESPACE","\n    ",399],["T_PUBLIC","public",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","addSite",400],"(",["T_VARIABLE","$id",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$site",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$trusted",400],")",["T_WHITESPACE","\n    ",400],"{",["T_WHITESPACE","\n        ",401],["T_VARIABLE","$name",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","_dir",402],["T_WHITESPACE"," ",402],".",["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'\/user_'",402],["T_WHITESPACE"," ",402],".",["T_WHITESPACE"," ",402],["T_STRING","md5",402],"(",["T_VARIABLE","$id",402],")",";",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$lock",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],"@",["T_STRING","fopen",403],"(",["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","_dir",403],["T_WHITESPACE"," ",403],".",["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","'\/user.lock'",403],",",["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","'w+'",403],")",";",["T_WHITESPACE","\n        ",403],["T_IF","if",404],["T_WHITESPACE"," ",404],"(",["T_VARIABLE","$lock",404],["T_WHITESPACE"," ",404],["T_IS_IDENTICAL","===",404],["T_WHITESPACE"," ",404],["T_STRING","false",404],")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n            ",404],["T_RETURN","return",405],["T_WHITESPACE"," ",405],["T_STRING","false",405],";",["T_WHITESPACE","\n        ",405],"}",["T_WHITESPACE","\n        ",406],["T_IF","if",407],["T_WHITESPACE"," ",407],"(","!",["T_STRING","flock",407],"(",["T_VARIABLE","$lock",407],",",["T_WHITESPACE"," ",407],["T_STRING","LOCK_EX",407],")",")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n            ",407],["T_STRING","fclose",408],"(",["T_VARIABLE","$lock",408],")",";",["T_WHITESPACE","\n            ",408],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_STRING","false",409],";",["T_WHITESPACE","\n        ",409],"}",["T_WHITESPACE","\n        ",410],["T_TRY","try",411],["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n            ",411],["T_VARIABLE","$f",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],"@",["T_STRING","fopen",412],"(",["T_VARIABLE","$name",412],",",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","'r+'",412],")",";",["T_WHITESPACE","\n            ",412],["T_IF","if",413],["T_WHITESPACE"," ",413],"(",["T_VARIABLE","$f",413],["T_WHITESPACE"," ",413],["T_IS_IDENTICAL","===",413],["T_WHITESPACE"," ",413],["T_STRING","false",413],")",["T_WHITESPACE"," ",413],"{",["T_WHITESPACE","\n                ",413],["T_STRING","fclose",414],"(",["T_VARIABLE","$lock",414],")",";",["T_WHITESPACE","\n                ",414],["T_RETURN","return",415],["T_WHITESPACE"," ",415],["T_STRING","false",415],";",["T_WHITESPACE","\n            ",415],"}",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$ret",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_STRING","false",417],";",["T_WHITESPACE","\n            ",417],["T_VARIABLE","$data",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_STRING","stream_get_contents",418],"(",["T_VARIABLE","$f",418],")",";",["T_WHITESPACE","\n            ",418],["T_IF","if",419],["T_WHITESPACE"," ",419],"(","!",["T_EMPTY","empty",419],"(",["T_VARIABLE","$data",419],")",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                ",419],["T_LIST","list",420],"(",["T_VARIABLE","$storedId",420],",",["T_WHITESPACE"," ",420],["T_VARIABLE","$storedPassword",420],",",["T_WHITESPACE"," ",420],["T_VARIABLE","$sites",420],")",["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_STRING","unserialize",420],"(",["T_VARIABLE","$data",420],")",";",["T_WHITESPACE","\n                ",420],["T_IF","if",421],["T_WHITESPACE"," ",421],"(",["T_VARIABLE","$id",421],["T_WHITESPACE"," ",421],["T_IS_IDENTICAL","===",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$storedId",421],")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n                    ",421],["T_IF","if",422],["T_WHITESPACE"," ",422],"(",["T_VARIABLE","$trusted",422],["T_WHITESPACE"," ",422],["T_IS_IDENTICAL","===",422],["T_WHITESPACE"," ",422],["T_STRING","null",422],")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n                        ",422],["T_UNSET","unset",423],"(",["T_VARIABLE","$sites",423],"[",["T_VARIABLE","$site",423],"]",")",";",["T_WHITESPACE","\n                    ",423],"}",["T_WHITESPACE"," ",424],["T_ELSE","else",424],["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n                        ",424],["T_VARIABLE","$sites",425],"[",["T_VARIABLE","$site",425],"]",["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$trusted",425],";",["T_WHITESPACE","\n                    ",425],"}",["T_WHITESPACE","\n                    ",426],["T_STRING","rewind",427],"(",["T_VARIABLE","$f",427],")",";",["T_WHITESPACE","\n                    ",427],["T_STRING","ftruncate",428],"(",["T_VARIABLE","$f",428],",",["T_WHITESPACE"," ",428],["T_LNUMBER","0",428],")",";",["T_WHITESPACE","\n                    ",428],["T_VARIABLE","$data",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_STRING","serialize",429],"(",["T_ARRAY","array",429],"(",["T_VARIABLE","$id",429],",",["T_WHITESPACE"," ",429],["T_VARIABLE","$storedPassword",429],",",["T_WHITESPACE"," ",429],["T_VARIABLE","$sites",429],")",")",";",["T_WHITESPACE","\n                    ",429],["T_STRING","fwrite",430],"(",["T_VARIABLE","$f",430],",",["T_WHITESPACE"," ",430],["T_VARIABLE","$data",430],")",";",["T_WHITESPACE","\n                    ",430],["T_VARIABLE","$ret",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_STRING","true",431],";",["T_WHITESPACE","\n                ",431],"}",["T_WHITESPACE","\n            ",432],"}",["T_WHITESPACE","\n            ",433],["T_STRING","fclose",434],"(",["T_VARIABLE","$f",434],")",";",["T_WHITESPACE","\n            ",434],["T_STRING","fclose",435],"(",["T_VARIABLE","$lock",435],")",";",["T_WHITESPACE","\n            ",435],["T_RETURN","return",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$ret",436],";",["T_WHITESPACE","\n        ",436],"}",["T_WHITESPACE"," ",437],["T_CATCH","catch",437],["T_WHITESPACE"," ",437],"(",["T_STRING","Exception",437],["T_WHITESPACE"," ",437],["T_VARIABLE","$e",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n            ",437],["T_STRING","fclose",438],"(",["T_VARIABLE","$lock",438],")",";",["T_WHITESPACE","\n            ",438],["T_THROW","throw",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$e",439],";",["T_WHITESPACE","\n        ",439],"}",["T_WHITESPACE","\n    ",440],"}",["T_WHITESPACE","\n",441],"}",["T_WHITESPACE","\n",442]]