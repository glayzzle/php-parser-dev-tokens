[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Consumer\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",3],["T_WHITESPACE","\n\n",22],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId_Consumer_Storage\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once \"Zend\/OpenId\/Consumer\/Storage.php\";\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/**\n * External storage implemmentation using serialized files\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Consumer\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",29],["T_WHITESPACE","\n",37],["T_CLASS","class",38],["T_WHITESPACE"," ",38],["T_STRING","Zend_OpenId_Consumer_Storage_File",38],["T_WHITESPACE"," ",38],["T_EXTENDS","extends",38],["T_WHITESPACE"," ",38],["T_STRING","Zend_OpenId_Consumer_Storage",38],["T_WHITESPACE","\n",38],"{",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Directory name to store data files in\n     *\n     * @var string $_dir\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PRIVATE","private",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_dir",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Constructs storage object and creates storage directory\n     *\n     * @param string $dir directory name to store data files in\n     * @throws Zend_OpenId_Exception\n     *\/",48],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","__construct",54],"(",["T_VARIABLE","$dir",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$dir",56],["T_WHITESPACE"," ",56],["T_IS_IDENTICAL","===",56],["T_WHITESPACE"," ",56],["T_STRING","null",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$tmp",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","getenv",57],"(",["T_CONSTANT_ENCAPSED_STRING","'TMP'",57],")",";",["T_WHITESPACE","\n            ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_EMPTY","empty",58],"(",["T_VARIABLE","$tmp",58],")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$tmp",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","getenv",59],"(",["T_CONSTANT_ENCAPSED_STRING","'TEMP'",59],")",";",["T_WHITESPACE","\n                ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_EMPTY","empty",60],"(",["T_VARIABLE","$tmp",60],")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                    ",60],["T_VARIABLE","$tmp",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","\"\/tmp\"",61],";",["T_WHITESPACE","\n                ",61],"}",["T_WHITESPACE","\n            ",62],"}",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$user",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","get_current_user",64],"(",")",";",["T_WHITESPACE","\n            ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_STRING","is_string",65],"(",["T_VARIABLE","$user",65],")",["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],"!",["T_EMPTY","empty",65],"(",["T_VARIABLE","$user",65],")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$tmp",66],["T_WHITESPACE"," ",66],["T_CONCAT_EQUAL",".=",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'\/'",66],["T_WHITESPACE"," ",66],".",["T_WHITESPACE"," ",66],["T_VARIABLE","$user",66],";",["T_WHITESPACE","\n            ",66],"}",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$dir",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$tmp",68],["T_WHITESPACE"," ",68],".",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'\/openid\/consumer'",68],";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_dir",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$dir",70],";",["T_WHITESPACE","\n        ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(","!",["T_STRING","is_dir",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_dir",71],")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(","!","@",["T_STRING","mkdir",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_dir",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","0700",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","1",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_DOC_COMMENT","\/**\n                 * @see Zend_OpenId_Exception\n                 *\/",73],["T_WHITESPACE","\n                ",75],["T_COMMENT","#require_once 'Zend\/OpenId\/Exception.php';\n",76],["T_WHITESPACE","                ",77],["T_THROW","throw",77],["T_WHITESPACE"," ",77],["T_NEW","new",77],["T_WHITESPACE"," ",77],["T_STRING","Zend_OpenId_Exception",77],"(",["T_WHITESPACE","\n                    ",77],["T_CONSTANT_ENCAPSED_STRING","'Cannot access storage directory '",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_VARIABLE","$dir",78],",",["T_WHITESPACE","\n                    ",78],["T_STRING","Zend_OpenId_Exception",79],["T_DOUBLE_COLON","::",79],["T_STRING","ERROR_STORAGE",79],")",";",["T_WHITESPACE","\n            ",79],"}",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n        ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(","(",["T_VARIABLE","$f",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","fopen",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_dir",82],".",["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'w+'",82],")",")",["T_WHITESPACE"," ",82],["T_IS_IDENTICAL","===",82],["T_WHITESPACE"," ",82],["T_STRING","null",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_DOC_COMMENT","\/**\n             * @see Zend_OpenId_Exception\n             *\/",83],["T_WHITESPACE","\n            ",85],["T_COMMENT","#require_once 'Zend\/OpenId\/Exception.php';\n",86],["T_WHITESPACE","            ",87],["T_THROW","throw",87],["T_WHITESPACE"," ",87],["T_NEW","new",87],["T_WHITESPACE"," ",87],["T_STRING","Zend_OpenId_Exception",87],"(",["T_WHITESPACE","\n                ",87],["T_CONSTANT_ENCAPSED_STRING","'Cannot create a lock file in the directory '",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_VARIABLE","$dir",88],",",["T_WHITESPACE","\n                ",88],["T_STRING","Zend_OpenId_Exception",89],["T_DOUBLE_COLON","::",89],["T_STRING","ERROR_STORAGE",89],")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n        ",90],["T_STRING","fclose",91],"(",["T_VARIABLE","$f",91],")",";",["T_WHITESPACE","\n        ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(","(",["T_VARIABLE","$f",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","fopen",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_dir",92],".",["T_CONSTANT_ENCAPSED_STRING","'\/discovery.lock'",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'w+'",92],")",")",["T_WHITESPACE"," ",92],["T_IS_IDENTICAL","===",92],["T_WHITESPACE"," ",92],["T_STRING","null",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_DOC_COMMENT","\/**\n             * @see Zend_OpenId_Exception\n             *\/",93],["T_WHITESPACE","\n            ",95],["T_COMMENT","#require_once 'Zend\/OpenId\/Exception.php';\n",96],["T_WHITESPACE","            ",97],["T_THROW","throw",97],["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","Zend_OpenId_Exception",97],"(",["T_WHITESPACE","\n                ",97],["T_CONSTANT_ENCAPSED_STRING","'Cannot create a lock file in the directory '",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_VARIABLE","$dir",98],",",["T_WHITESPACE","\n                ",98],["T_STRING","Zend_OpenId_Exception",99],["T_DOUBLE_COLON","::",99],["T_STRING","ERROR_STORAGE",99],")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n        ",100],["T_STRING","fclose",101],"(",["T_VARIABLE","$f",101],")",";",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","(",["T_VARIABLE","$f",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","fopen",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_dir",102],".",["T_CONSTANT_ENCAPSED_STRING","'\/nonce.lock'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'w+'",102],")",")",["T_WHITESPACE"," ",102],["T_IS_IDENTICAL","===",102],["T_WHITESPACE"," ",102],["T_STRING","null",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_DOC_COMMENT","\/**\n             * @see Zend_OpenId_Exception\n             *\/",103],["T_WHITESPACE","\n            ",105],["T_COMMENT","#require_once 'Zend\/OpenId\/Exception.php';\n",106],["T_WHITESPACE","            ",107],["T_THROW","throw",107],["T_WHITESPACE"," ",107],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","Zend_OpenId_Exception",107],"(",["T_WHITESPACE","\n                ",107],["T_CONSTANT_ENCAPSED_STRING","'Cannot create a lock file in the directory '",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$dir",108],",",["T_WHITESPACE","\n                ",108],["T_STRING","Zend_OpenId_Exception",109],["T_DOUBLE_COLON","::",109],["T_STRING","ERROR_STORAGE",109],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_STRING","fclose",111],"(",["T_VARIABLE","$f",111],")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Stores information about association identified by $url\/$handle\n     *\n     * @param string $url OpenID server URL\n     * @param string $handle assiciation handle\n     * @param string $macFunc HMAC function (sha1 or sha256)\n     * @param string $secret shared secret\n     * @param long $expires expiration UNIX time\n     * @return bool\n     *\/",114],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","addAssociation",124],"(",["T_VARIABLE","$url",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$handle",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$macFunc",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$secret",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$expires",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$name1",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_dir",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_url_'",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_STRING","md5",126],"(",["T_VARIABLE","$url",126],")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$name2",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_dir",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_handle_'",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_STRING","md5",127],"(",["T_VARIABLE","$handle",127],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$lock",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],"@",["T_STRING","fopen",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_dir",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'w+'",128],")",";",["T_WHITESPACE","\n        ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$lock",129],["T_WHITESPACE"," ",129],["T_IS_IDENTICAL","===",129],["T_WHITESPACE"," ",129],["T_STRING","false",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_STRING","false",130],";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n        ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(","!",["T_STRING","flock",132],"(",["T_VARIABLE","$lock",132],",",["T_WHITESPACE"," ",132],["T_STRING","LOCK_EX",132],")",")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_STRING","fclose",133],"(",["T_VARIABLE","$lock",133],")",";",["T_WHITESPACE","\n            ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_STRING","false",134],";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n        ",135],["T_TRY","try",136],["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$f",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],"@",["T_STRING","fopen",137],"(",["T_VARIABLE","$name1",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'w+'",137],")",";",["T_WHITESPACE","\n            ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$f",138],["T_WHITESPACE"," ",138],["T_IS_IDENTICAL","===",138],["T_WHITESPACE"," ",138],["T_STRING","false",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_STRING","fclose",139],"(",["T_VARIABLE","$lock",139],")",";",["T_WHITESPACE","\n                ",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_STRING","false",140],";",["T_WHITESPACE","\n            ",140],"}",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$data",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","serialize",142],"(",["T_ARRAY","array",142],"(",["T_VARIABLE","$url",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$handle",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$macFunc",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$secret",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$expires",142],")",")",";",["T_WHITESPACE","\n            ",142],["T_STRING","fwrite",143],"(",["T_VARIABLE","$f",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$data",143],")",";",["T_WHITESPACE","\n            ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_STRING","function_exists",144],"(",["T_CONSTANT_ENCAPSED_STRING","'symlink'",144],")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                ",144],"@",["T_STRING","unlink",145],"(",["T_VARIABLE","$name2",145],")",";",["T_WHITESPACE","\n                ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_STRING","symlink",146],"(",["T_VARIABLE","$name1",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$name2",146],")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                    ",146],["T_STRING","fclose",147],"(",["T_VARIABLE","$f",147],")",";",["T_WHITESPACE","\n                    ",147],["T_STRING","fclose",148],"(",["T_VARIABLE","$lock",148],")",";",["T_WHITESPACE","\n                    ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","true",149],";",["T_WHITESPACE","\n                ",149],"}",["T_WHITESPACE","\n            ",150],"}",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$f2",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],"@",["T_STRING","fopen",152],"(",["T_VARIABLE","$name2",152],",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'w+'",152],")",";",["T_WHITESPACE","\n            ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$f2",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n                ",153],["T_STRING","fwrite",154],"(",["T_VARIABLE","$f2",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$data",154],")",";",["T_WHITESPACE","\n                ",154],["T_STRING","fclose",155],"(",["T_VARIABLE","$f2",155],")",";",["T_WHITESPACE","\n                ",155],"@",["T_STRING","unlink",156],"(",["T_VARIABLE","$name1",156],")",";",["T_WHITESPACE","\n                ",156],["T_VARIABLE","$ret",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","true",157],";",["T_WHITESPACE","\n            ",157],"}",["T_WHITESPACE"," ",158],["T_ELSE","else",158],["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n                ",158],["T_VARIABLE","$ret",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","false",159],";",["T_WHITESPACE","\n            ",159],"}",["T_WHITESPACE","\n            ",160],["T_STRING","fclose",161],"(",["T_VARIABLE","$f",161],")",";",["T_WHITESPACE","\n            ",161],["T_STRING","fclose",162],"(",["T_VARIABLE","$lock",162],")",";",["T_WHITESPACE","\n            ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$ret",163],";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE"," ",164],["T_CATCH","catch",164],["T_WHITESPACE"," ",164],"(",["T_STRING","Exception",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$e",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_STRING","fclose",165],"(",["T_VARIABLE","$lock",165],")",";",["T_WHITESPACE","\n            ",165],["T_THROW","throw",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$e",166],";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Gets information about association identified by $url\n     * Returns true if given association found and not expired and false\n     * otherwise\n     *\n     * @param string $url OpenID server URL\n     * @param string &$handle assiciation handle\n     * @param string &$macFunc HMAC function (sha1 or sha256)\n     * @param string &$secret shared secret\n     * @param long &$expires expiration UNIX time\n     * @return bool\n     *\/",170],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","getAssociation",182],"(",["T_VARIABLE","$url",182],",",["T_WHITESPACE"," ",182],"&",["T_VARIABLE","$handle",182],",",["T_WHITESPACE"," ",182],"&",["T_VARIABLE","$macFunc",182],",",["T_WHITESPACE"," ",182],"&",["T_VARIABLE","$secret",182],",",["T_WHITESPACE"," ",182],"&",["T_VARIABLE","$expires",182],")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$name1",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_dir",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_url_'",184],["T_WHITESPACE"," ",184],".",["T_WHITESPACE"," ",184],["T_STRING","md5",184],"(",["T_VARIABLE","$url",184],")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$lock",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],"@",["T_STRING","fopen",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_dir",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",185],",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'w+'",185],")",";",["T_WHITESPACE","\n        ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$lock",186],["T_WHITESPACE"," ",186],["T_IS_IDENTICAL","===",186],["T_WHITESPACE"," ",186],["T_STRING","false",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_STRING","false",187],";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n        ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(","!",["T_STRING","flock",189],"(",["T_VARIABLE","$lock",189],",",["T_WHITESPACE"," ",189],["T_STRING","LOCK_EX",189],")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_STRING","fclose",190],"(",["T_VARIABLE","$lock",190],")",";",["T_WHITESPACE","\n            ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_STRING","false",191],";",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n        ",192],["T_TRY","try",193],["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$f",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],"@",["T_STRING","fopen",194],"(",["T_VARIABLE","$name1",194],",",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'r'",194],")",";",["T_WHITESPACE","\n            ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$f",195],["T_WHITESPACE"," ",195],["T_IS_IDENTICAL","===",195],["T_WHITESPACE"," ",195],["T_STRING","false",195],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_STRING","fclose",196],"(",["T_VARIABLE","$lock",196],")",";",["T_WHITESPACE","\n                ",196],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_STRING","false",197],";",["T_WHITESPACE","\n            ",197],"}",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$ret",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","false",199],";",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$data",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","stream_get_contents",200],"(",["T_VARIABLE","$f",200],")",";",["T_WHITESPACE","\n            ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(","!",["T_EMPTY","empty",201],"(",["T_VARIABLE","$data",201],")",")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n                ",201],["T_LIST","list",202],"(",["T_VARIABLE","$storedUrl",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$handle",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$macFunc",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$secret",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$expires",202],")",["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","unserialize",202],"(",["T_VARIABLE","$data",202],")",";",["T_WHITESPACE","\n                ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$url",203],["T_WHITESPACE"," ",203],["T_IS_IDENTICAL","===",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$storedUrl",203],["T_WHITESPACE"," ",203],["T_BOOLEAN_AND","&&",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$expires",203],["T_WHITESPACE"," ",203],">",["T_WHITESPACE"," ",203],["T_STRING","time",203],"(",")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                    ",203],["T_VARIABLE","$ret",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_STRING","true",204],";",["T_WHITESPACE","\n                ",204],"}",["T_WHITESPACE"," ",205],["T_ELSE","else",205],["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                    ",205],["T_VARIABLE","$name2",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_dir",206],["T_WHITESPACE"," ",206],".",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_handle_'",206],["T_WHITESPACE"," ",206],".",["T_WHITESPACE"," ",206],["T_STRING","md5",206],"(",["T_VARIABLE","$handle",206],")",";",["T_WHITESPACE","\n                    ",206],["T_STRING","fclose",207],"(",["T_VARIABLE","$f",207],")",";",["T_WHITESPACE","\n                    ",207],"@",["T_STRING","unlink",208],"(",["T_VARIABLE","$name2",208],")",";",["T_WHITESPACE","\n                    ",208],"@",["T_STRING","unlink",209],"(",["T_VARIABLE","$name1",209],")",";",["T_WHITESPACE","\n                    ",209],["T_STRING","fclose",210],"(",["T_VARIABLE","$lock",210],")",";",["T_WHITESPACE","\n                    ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_STRING","false",211],";",["T_WHITESPACE","\n                ",211],"}",["T_WHITESPACE","\n            ",212],"}",["T_WHITESPACE","\n            ",213],["T_STRING","fclose",214],"(",["T_VARIABLE","$f",214],")",";",["T_WHITESPACE","\n            ",214],["T_STRING","fclose",215],"(",["T_VARIABLE","$lock",215],")",";",["T_WHITESPACE","\n            ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$ret",216],";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE"," ",217],["T_CATCH","catch",217],["T_WHITESPACE"," ",217],"(",["T_STRING","Exception",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$e",217],")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_STRING","fclose",218],"(",["T_VARIABLE","$lock",218],")",";",["T_WHITESPACE","\n            ",218],["T_THROW","throw",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$e",219],";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Gets information about association identified by $handle\n     * Returns true if given association found and not expired and false\n     * otherwise\n     *\n     * @param string $handle assiciation handle\n     * @param string &$url OpenID server URL\n     * @param string &$macFunc HMAC function (sha1 or sha256)\n     * @param string &$secret shared secret\n     * @param long &$expires expiration UNIX time\n     * @return bool\n     *\/",223],["T_WHITESPACE","\n    ",234],["T_PUBLIC","public",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","getAssociationByHandle",235],"(",["T_VARIABLE","$handle",235],",",["T_WHITESPACE"," ",235],"&",["T_VARIABLE","$url",235],",",["T_WHITESPACE"," ",235],"&",["T_VARIABLE","$macFunc",235],",",["T_WHITESPACE"," ",235],"&",["T_VARIABLE","$secret",235],",",["T_WHITESPACE"," ",235],"&",["T_VARIABLE","$expires",235],")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$name2",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_dir",237],["T_WHITESPACE"," ",237],".",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_handle_'",237],["T_WHITESPACE"," ",237],".",["T_WHITESPACE"," ",237],["T_STRING","md5",237],"(",["T_VARIABLE","$handle",237],")",";",["T_WHITESPACE","\n        ",237],["T_VARIABLE","$lock",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],"@",["T_STRING","fopen",238],"(",["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_dir",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",238],",",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'w+'",238],")",";",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$lock",239],["T_WHITESPACE"," ",239],["T_IS_IDENTICAL","===",239],["T_WHITESPACE"," ",239],["T_STRING","false",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_STRING","false",240],";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n        ",241],["T_IF","if",242],["T_WHITESPACE"," ",242],"(","!",["T_STRING","flock",242],"(",["T_VARIABLE","$lock",242],",",["T_WHITESPACE"," ",242],["T_STRING","LOCK_EX",242],")",")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n            ",242],["T_STRING","fclose",243],"(",["T_VARIABLE","$lock",243],")",";",["T_WHITESPACE","\n            ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_STRING","false",244],";",["T_WHITESPACE","\n        ",244],"}",["T_WHITESPACE","\n        ",245],["T_TRY","try",246],["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$f",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],"@",["T_STRING","fopen",247],"(",["T_VARIABLE","$name2",247],",",["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'r'",247],")",";",["T_WHITESPACE","\n            ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$f",248],["T_WHITESPACE"," ",248],["T_IS_IDENTICAL","===",248],["T_WHITESPACE"," ",248],["T_STRING","false",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                ",248],["T_STRING","fclose",249],"(",["T_VARIABLE","$lock",249],")",";",["T_WHITESPACE","\n                ",249],["T_RETURN","return",250],["T_WHITESPACE"," ",250],["T_STRING","false",250],";",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE","\n            ",251],["T_VARIABLE","$ret",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_STRING","false",252],";",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$data",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_STRING","stream_get_contents",253],"(",["T_VARIABLE","$f",253],")",";",["T_WHITESPACE","\n            ",253],["T_IF","if",254],["T_WHITESPACE"," ",254],"(","!",["T_EMPTY","empty",254],"(",["T_VARIABLE","$data",254],")",")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n                ",254],["T_LIST","list",255],"(",["T_VARIABLE","$url",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$storedHandle",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$macFunc",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$secret",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$expires",255],")",["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","unserialize",255],"(",["T_VARIABLE","$data",255],")",";",["T_WHITESPACE","\n                ",255],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_VARIABLE","$handle",256],["T_WHITESPACE"," ",256],["T_IS_IDENTICAL","===",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$storedHandle",256],["T_WHITESPACE"," ",256],["T_BOOLEAN_AND","&&",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$expires",256],["T_WHITESPACE"," ",256],">",["T_WHITESPACE"," ",256],["T_STRING","time",256],"(",")",")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n                    ",256],["T_VARIABLE","$ret",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_STRING","true",257],";",["T_WHITESPACE","\n                ",257],"}",["T_WHITESPACE"," ",258],["T_ELSE","else",258],["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                    ",258],["T_STRING","fclose",259],"(",["T_VARIABLE","$f",259],")",";",["T_WHITESPACE","\n                    ",259],"@",["T_STRING","unlink",260],"(",["T_VARIABLE","$name2",260],")",";",["T_WHITESPACE","\n                    ",260],["T_VARIABLE","$name1",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_dir",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_url_'",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_STRING","md5",261],"(",["T_VARIABLE","$url",261],")",";",["T_WHITESPACE","\n                    ",261],"@",["T_STRING","unlink",262],"(",["T_VARIABLE","$name1",262],")",";",["T_WHITESPACE","\n                    ",262],["T_STRING","fclose",263],"(",["T_VARIABLE","$lock",263],")",";",["T_WHITESPACE","\n                    ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_STRING","false",264],";",["T_WHITESPACE","\n                ",264],"}",["T_WHITESPACE","\n            ",265],"}",["T_WHITESPACE","\n            ",266],["T_STRING","fclose",267],"(",["T_VARIABLE","$f",267],")",";",["T_WHITESPACE","\n            ",267],["T_STRING","fclose",268],"(",["T_VARIABLE","$lock",268],")",";",["T_WHITESPACE","\n            ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$ret",269],";",["T_WHITESPACE","\n        ",269],"}",["T_WHITESPACE"," ",270],["T_CATCH","catch",270],["T_WHITESPACE"," ",270],"(",["T_STRING","Exception",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$e",270],")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n            ",270],["T_STRING","fclose",271],"(",["T_VARIABLE","$lock",271],")",";",["T_WHITESPACE","\n            ",271],["T_THROW","throw",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$e",272],";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Deletes association identified by $url\n     *\n     * @param string $url OpenID server URL\n     * @return bool\n     *\/",276],["T_WHITESPACE","\n    ",281],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","delAssociation",282],"(",["T_VARIABLE","$url",282],")",["T_WHITESPACE","\n    ",282],"{",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$name1",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","_dir",284],["T_WHITESPACE"," ",284],".",["T_WHITESPACE"," ",284],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_url_'",284],["T_WHITESPACE"," ",284],".",["T_WHITESPACE"," ",284],["T_STRING","md5",284],"(",["T_VARIABLE","$url",284],")",";",["T_WHITESPACE","\n        ",284],["T_VARIABLE","$lock",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],"@",["T_STRING","fopen",285],"(",["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","_dir",285],["T_WHITESPACE"," ",285],".",["T_WHITESPACE"," ",285],["T_CONSTANT_ENCAPSED_STRING","'\/assoc.lock'",285],",",["T_WHITESPACE"," ",285],["T_CONSTANT_ENCAPSED_STRING","'w+'",285],")",";",["T_WHITESPACE","\n        ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_VARIABLE","$lock",286],["T_WHITESPACE"," ",286],["T_IS_IDENTICAL","===",286],["T_WHITESPACE"," ",286],["T_STRING","false",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n            ",286],["T_RETURN","return",287],["T_WHITESPACE"," ",287],["T_STRING","false",287],";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n        ",288],["T_IF","if",289],["T_WHITESPACE"," ",289],"(","!",["T_STRING","flock",289],"(",["T_VARIABLE","$lock",289],",",["T_WHITESPACE"," ",289],["T_STRING","LOCK_EX",289],")",")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n            ",289],["T_STRING","fclose",290],"(",["T_VARIABLE","$lock",290],")",";",["T_WHITESPACE","\n            ",290],["T_RETURN","return",291],["T_WHITESPACE"," ",291],["T_STRING","false",291],";",["T_WHITESPACE","\n        ",291],"}",["T_WHITESPACE","\n        ",292],["T_TRY","try",293],["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$f",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],"@",["T_STRING","fopen",294],"(",["T_VARIABLE","$name1",294],",",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'r'",294],")",";",["T_WHITESPACE","\n            ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_VARIABLE","$f",295],["T_WHITESPACE"," ",295],["T_IS_IDENTICAL","===",295],["T_WHITESPACE"," ",295],["T_STRING","false",295],")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n                ",295],["T_STRING","fclose",296],"(",["T_VARIABLE","$lock",296],")",";",["T_WHITESPACE","\n                ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_STRING","false",297],";",["T_WHITESPACE","\n            ",297],"}",["T_WHITESPACE","\n            ",298],["T_VARIABLE","$data",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_STRING","stream_get_contents",299],"(",["T_VARIABLE","$f",299],")",";",["T_WHITESPACE","\n            ",299],["T_IF","if",300],["T_WHITESPACE"," ",300],"(","!",["T_EMPTY","empty",300],"(",["T_VARIABLE","$data",300],")",")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n                ",300],["T_LIST","list",301],"(",["T_VARIABLE","$storedUrl",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$handle",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$macFunc",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$secret",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$expires",301],")",["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_STRING","unserialize",301],"(",["T_VARIABLE","$data",301],")",";",["T_WHITESPACE","\n                ",301],["T_IF","if",302],["T_WHITESPACE"," ",302],"(",["T_VARIABLE","$url",302],["T_WHITESPACE"," ",302],["T_IS_IDENTICAL","===",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$storedUrl",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n                    ",302],["T_VARIABLE","$name2",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_dir",303],["T_WHITESPACE"," ",303],".",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'\/assoc_handle_'",303],["T_WHITESPACE"," ",303],".",["T_WHITESPACE"," ",303],["T_STRING","md5",303],"(",["T_VARIABLE","$handle",303],")",";",["T_WHITESPACE","\n                    ",303],["T_STRING","fclose",304],"(",["T_VARIABLE","$f",304],")",";",["T_WHITESPACE","\n                    ",304],"@",["T_STRING","unlink",305],"(",["T_VARIABLE","$name2",305],")",";",["T_WHITESPACE","\n                    ",305],"@",["T_STRING","unlink",306],"(",["T_VARIABLE","$name1",306],")",";",["T_WHITESPACE","\n                    ",306],["T_STRING","fclose",307],"(",["T_VARIABLE","$lock",307],")",";",["T_WHITESPACE","\n                    ",307],["T_RETURN","return",308],["T_WHITESPACE"," ",308],["T_STRING","true",308],";",["T_WHITESPACE","\n                ",308],"}",["T_WHITESPACE","\n            ",309],"}",["T_WHITESPACE","\n            ",310],["T_STRING","fclose",311],"(",["T_VARIABLE","$f",311],")",";",["T_WHITESPACE","\n            ",311],["T_STRING","fclose",312],"(",["T_VARIABLE","$lock",312],")",";",["T_WHITESPACE","\n            ",312],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_STRING","true",313],";",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE"," ",314],["T_CATCH","catch",314],["T_WHITESPACE"," ",314],"(",["T_STRING","Exception",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$e",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n            ",314],["T_STRING","fclose",315],"(",["T_VARIABLE","$lock",315],")",";",["T_WHITESPACE","\n            ",315],["T_THROW","throw",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$e",316],";",["T_WHITESPACE","\n        ",316],"}",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n\n    ",318],["T_DOC_COMMENT","\/**\n     * Stores information discovered from identity $id\n     *\n     * @param string $id identity\n     * @param string $realId discovered real identity URL\n     * @param string $server discovered OpenID server URL\n     * @param float $version discovered OpenID protocol version\n     * @param long $expires expiration UNIX time\n     * @return bool\n     *\/",320],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","addDiscoveryInfo",330],"(",["T_VARIABLE","$id",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$realId",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$server",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$version",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$expires",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$name",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_dir",332],["T_WHITESPACE"," ",332],".",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'\/discovery_'",332],["T_WHITESPACE"," ",332],".",["T_WHITESPACE"," ",332],["T_STRING","md5",332],"(",["T_VARIABLE","$id",332],")",";",["T_WHITESPACE","\n        ",332],["T_VARIABLE","$lock",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],"@",["T_STRING","fopen",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_dir",333],["T_WHITESPACE"," ",333],".",["T_WHITESPACE"," ",333],["T_CONSTANT_ENCAPSED_STRING","'\/discovery.lock'",333],",",["T_WHITESPACE"," ",333],["T_CONSTANT_ENCAPSED_STRING","'w+'",333],")",";",["T_WHITESPACE","\n        ",333],["T_IF","if",334],["T_WHITESPACE"," ",334],"(",["T_VARIABLE","$lock",334],["T_WHITESPACE"," ",334],["T_IS_IDENTICAL","===",334],["T_WHITESPACE"," ",334],["T_STRING","false",334],")",["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n            ",334],["T_RETURN","return",335],["T_WHITESPACE"," ",335],["T_STRING","false",335],";",["T_WHITESPACE","\n        ",335],"}",["T_WHITESPACE","\n        ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(","!",["T_STRING","flock",337],"(",["T_VARIABLE","$lock",337],",",["T_WHITESPACE"," ",337],["T_STRING","LOCK_EX",337],")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_STRING","fclose",338],"(",["T_VARIABLE","$lock",338],")",";",["T_WHITESPACE","\n            ",338],["T_RETURN","return",339],["T_WHITESPACE"," ",339],["T_STRING","false",339],";",["T_WHITESPACE","\n        ",339],"}",["T_WHITESPACE","\n        ",340],["T_TRY","try",341],["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],["T_VARIABLE","$f",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],"@",["T_STRING","fopen",342],"(",["T_VARIABLE","$name",342],",",["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","'w+'",342],")",";",["T_WHITESPACE","\n            ",342],["T_IF","if",343],["T_WHITESPACE"," ",343],"(",["T_VARIABLE","$f",343],["T_WHITESPACE"," ",343],["T_IS_IDENTICAL","===",343],["T_WHITESPACE"," ",343],["T_STRING","false",343],")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n                ",343],["T_STRING","fclose",344],"(",["T_VARIABLE","$lock",344],")",";",["T_WHITESPACE","\n                ",344],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_STRING","false",345],";",["T_WHITESPACE","\n            ",345],"}",["T_WHITESPACE","\n            ",346],["T_VARIABLE","$data",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_STRING","serialize",347],"(",["T_ARRAY","array",347],"(",["T_VARIABLE","$id",347],",",["T_WHITESPACE"," ",347],["T_VARIABLE","$realId",347],",",["T_WHITESPACE"," ",347],["T_VARIABLE","$server",347],",",["T_WHITESPACE"," ",347],["T_VARIABLE","$version",347],",",["T_WHITESPACE"," ",347],["T_VARIABLE","$expires",347],")",")",";",["T_WHITESPACE","\n            ",347],["T_STRING","fwrite",348],"(",["T_VARIABLE","$f",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$data",348],")",";",["T_WHITESPACE","\n            ",348],["T_STRING","fclose",349],"(",["T_VARIABLE","$f",349],")",";",["T_WHITESPACE","\n            ",349],["T_STRING","fclose",350],"(",["T_VARIABLE","$lock",350],")",";",["T_WHITESPACE","\n            ",350],["T_RETURN","return",351],["T_WHITESPACE"," ",351],["T_STRING","true",351],";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE"," ",352],["T_CATCH","catch",352],["T_WHITESPACE"," ",352],"(",["T_STRING","Exception",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$e",352],")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n            ",352],["T_STRING","fclose",353],"(",["T_VARIABLE","$lock",353],")",";",["T_WHITESPACE","\n            ",353],["T_THROW","throw",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$e",354],";",["T_WHITESPACE","\n        ",354],"}",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n\n    ",356],["T_DOC_COMMENT","\/**\n     * Gets information discovered from identity $id\n     * Returns true if such information exists and false otherwise\n     *\n     * @param string $id identity\n     * @param string &$realId discovered real identity URL\n     * @param string &$server discovered OpenID server URL\n     * @param float &$version discovered OpenID protocol version\n     * @param long &$expires expiration UNIX time\n     * @return bool\n     *\/",358],["T_WHITESPACE","\n    ",368],["T_PUBLIC","public",369],["T_WHITESPACE"," ",369],["T_FUNCTION","function",369],["T_WHITESPACE"," ",369],["T_STRING","getDiscoveryInfo",369],"(",["T_VARIABLE","$id",369],",",["T_WHITESPACE"," ",369],"&",["T_VARIABLE","$realId",369],",",["T_WHITESPACE"," ",369],"&",["T_VARIABLE","$server",369],",",["T_WHITESPACE"," ",369],"&",["T_VARIABLE","$version",369],",",["T_WHITESPACE"," ",369],"&",["T_VARIABLE","$expires",369],")",["T_WHITESPACE","\n    ",369],"{",["T_WHITESPACE","\n        ",370],["T_VARIABLE","$name",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","_dir",371],["T_WHITESPACE"," ",371],".",["T_WHITESPACE"," ",371],["T_CONSTANT_ENCAPSED_STRING","'\/discovery_'",371],["T_WHITESPACE"," ",371],".",["T_WHITESPACE"," ",371],["T_STRING","md5",371],"(",["T_VARIABLE","$id",371],")",";",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$lock",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],"@",["T_STRING","fopen",372],"(",["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_dir",372],["T_WHITESPACE"," ",372],".",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'\/discovery.lock'",372],",",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'w+'",372],")",";",["T_WHITESPACE","\n        ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(",["T_VARIABLE","$lock",373],["T_WHITESPACE"," ",373],["T_IS_IDENTICAL","===",373],["T_WHITESPACE"," ",373],["T_STRING","false",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_STRING","false",374],";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE","\n        ",375],["T_IF","if",376],["T_WHITESPACE"," ",376],"(","!",["T_STRING","flock",376],"(",["T_VARIABLE","$lock",376],",",["T_WHITESPACE"," ",376],["T_STRING","LOCK_EX",376],")",")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n            ",376],["T_STRING","fclose",377],"(",["T_VARIABLE","$lock",377],")",";",["T_WHITESPACE","\n            ",377],["T_RETURN","return",378],["T_WHITESPACE"," ",378],["T_STRING","false",378],";",["T_WHITESPACE","\n        ",378],"}",["T_WHITESPACE","\n        ",379],["T_TRY","try",380],["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n            ",380],["T_VARIABLE","$f",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],"@",["T_STRING","fopen",381],"(",["T_VARIABLE","$name",381],",",["T_WHITESPACE"," ",381],["T_CONSTANT_ENCAPSED_STRING","'r'",381],")",";",["T_WHITESPACE","\n            ",381],["T_IF","if",382],["T_WHITESPACE"," ",382],"(",["T_VARIABLE","$f",382],["T_WHITESPACE"," ",382],["T_IS_IDENTICAL","===",382],["T_WHITESPACE"," ",382],["T_STRING","false",382],")",["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n                ",382],["T_STRING","fclose",383],"(",["T_VARIABLE","$lock",383],")",";",["T_WHITESPACE","\n                ",383],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_STRING","false",384],";",["T_WHITESPACE","\n            ",384],"}",["T_WHITESPACE","\n            ",385],["T_VARIABLE","$ret",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","false",386],";",["T_WHITESPACE","\n            ",386],["T_VARIABLE","$data",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_STRING","stream_get_contents",387],"(",["T_VARIABLE","$f",387],")",";",["T_WHITESPACE","\n            ",387],["T_IF","if",388],["T_WHITESPACE"," ",388],"(","!",["T_EMPTY","empty",388],"(",["T_VARIABLE","$data",388],")",")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_LIST","list",389],"(",["T_VARIABLE","$storedId",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$realId",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$server",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$version",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$expires",389],")",["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_STRING","unserialize",389],"(",["T_VARIABLE","$data",389],")",";",["T_WHITESPACE","\n                ",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_VARIABLE","$id",390],["T_WHITESPACE"," ",390],["T_IS_IDENTICAL","===",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$storedId",390],["T_WHITESPACE"," ",390],["T_BOOLEAN_AND","&&",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$expires",390],["T_WHITESPACE"," ",390],">",["T_WHITESPACE"," ",390],["T_STRING","time",390],"(",")",")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n                    ",390],["T_VARIABLE","$ret",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_STRING","true",391],";",["T_WHITESPACE","\n                ",391],"}",["T_WHITESPACE"," ",392],["T_ELSE","else",392],["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n                    ",392],["T_STRING","fclose",393],"(",["T_VARIABLE","$f",393],")",";",["T_WHITESPACE","\n                    ",393],"@",["T_STRING","unlink",394],"(",["T_VARIABLE","$name",394],")",";",["T_WHITESPACE","\n                    ",394],["T_STRING","fclose",395],"(",["T_VARIABLE","$lock",395],")",";",["T_WHITESPACE","\n                    ",395],["T_RETURN","return",396],["T_WHITESPACE"," ",396],["T_STRING","false",396],";",["T_WHITESPACE","\n                ",396],"}",["T_WHITESPACE","\n            ",397],"}",["T_WHITESPACE","\n            ",398],["T_STRING","fclose",399],"(",["T_VARIABLE","$f",399],")",";",["T_WHITESPACE","\n            ",399],["T_STRING","fclose",400],"(",["T_VARIABLE","$lock",400],")",";",["T_WHITESPACE","\n            ",400],["T_RETURN","return",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$ret",401],";",["T_WHITESPACE","\n        ",401],"}",["T_WHITESPACE"," ",402],["T_CATCH","catch",402],["T_WHITESPACE"," ",402],"(",["T_STRING","Exception",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$e",402],")",["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n            ",402],["T_STRING","fclose",403],"(",["T_VARIABLE","$lock",403],")",";",["T_WHITESPACE","\n            ",403],["T_THROW","throw",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$e",404],";",["T_WHITESPACE","\n        ",404],"}",["T_WHITESPACE","\n    ",405],"}",["T_WHITESPACE","\n\n    ",406],["T_DOC_COMMENT","\/**\n     * Removes cached information discovered from identity $id\n     *\n     * @param string $id identity\n     * @return bool\n     *\/",408],["T_WHITESPACE","\n    ",413],["T_PUBLIC","public",414],["T_WHITESPACE"," ",414],["T_FUNCTION","function",414],["T_WHITESPACE"," ",414],["T_STRING","delDiscoveryInfo",414],"(",["T_VARIABLE","$id",414],")",["T_WHITESPACE","\n    ",414],"{",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$name",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","_dir",416],["T_WHITESPACE"," ",416],".",["T_WHITESPACE"," ",416],["T_CONSTANT_ENCAPSED_STRING","'\/discovery_'",416],["T_WHITESPACE"," ",416],".",["T_WHITESPACE"," ",416],["T_STRING","md5",416],"(",["T_VARIABLE","$id",416],")",";",["T_WHITESPACE","\n        ",416],["T_VARIABLE","$lock",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],"@",["T_STRING","fopen",417],"(",["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","_dir",417],["T_WHITESPACE"," ",417],".",["T_WHITESPACE"," ",417],["T_CONSTANT_ENCAPSED_STRING","'\/discovery.lock'",417],",",["T_WHITESPACE"," ",417],["T_CONSTANT_ENCAPSED_STRING","'w+'",417],")",";",["T_WHITESPACE","\n        ",417],["T_IF","if",418],["T_WHITESPACE"," ",418],"(",["T_VARIABLE","$lock",418],["T_WHITESPACE"," ",418],["T_IS_IDENTICAL","===",418],["T_WHITESPACE"," ",418],["T_STRING","false",418],")",["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n            ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_STRING","false",419],";",["T_WHITESPACE","\n        ",419],"}",["T_WHITESPACE","\n        ",420],["T_IF","if",421],["T_WHITESPACE"," ",421],"(","!",["T_STRING","flock",421],"(",["T_VARIABLE","$lock",421],",",["T_WHITESPACE"," ",421],["T_STRING","LOCK_EX",421],")",")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n            ",421],["T_STRING","fclose",422],"(",["T_VARIABLE","$lock",422],")",";",["T_WHITESPACE","\n            ",422],["T_RETURN","return",423],["T_WHITESPACE"," ",423],["T_STRING","false",423],";",["T_WHITESPACE","\n        ",423],"}",["T_WHITESPACE","\n        ",424],["T_TRY","try",425],["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n            ",425],"@",["T_STRING","unlink",426],"(",["T_VARIABLE","$name",426],")",";",["T_WHITESPACE","\n            ",426],["T_STRING","fclose",427],"(",["T_VARIABLE","$lock",427],")",";",["T_WHITESPACE","\n            ",427],["T_RETURN","return",428],["T_WHITESPACE"," ",428],["T_STRING","true",428],";",["T_WHITESPACE","\n        ",428],"}",["T_WHITESPACE"," ",429],["T_CATCH","catch",429],["T_WHITESPACE"," ",429],"(",["T_STRING","Exception",429],["T_WHITESPACE"," ",429],["T_VARIABLE","$e",429],")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n            ",429],["T_STRING","fclose",430],"(",["T_VARIABLE","$lock",430],")",";",["T_WHITESPACE","\n            ",430],["T_THROW","throw",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$e",431],";",["T_WHITESPACE","\n        ",431],"}",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n\n    ",433],["T_DOC_COMMENT","\/**\n     * The function checks the uniqueness of openid.response_nonce\n     *\n     * @param string $provider openid.openid_op_endpoint field from authentication response\n     * @param  string $nonce openid.response_nonce field from authentication response\n     * @return bool\n     *\/",435],["T_WHITESPACE","\n    ",441],["T_PUBLIC","public",442],["T_WHITESPACE"," ",442],["T_FUNCTION","function",442],["T_WHITESPACE"," ",442],["T_STRING","isUniqueNonce",442],"(",["T_VARIABLE","$provider",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$nonce",442],")",["T_WHITESPACE","\n    ",442],"{",["T_WHITESPACE","\n        ",443],["T_VARIABLE","$name",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","_dir",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'\/nonce_'",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_STRING","md5",444],"(",["T_VARIABLE","$provider",444],".",["T_CONSTANT_ENCAPSED_STRING","';'",444],".",["T_VARIABLE","$nonce",444],")",";",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$lock",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],"@",["T_STRING","fopen",445],"(",["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","_dir",445],["T_WHITESPACE"," ",445],".",["T_WHITESPACE"," ",445],["T_CONSTANT_ENCAPSED_STRING","'\/nonce.lock'",445],",",["T_WHITESPACE"," ",445],["T_CONSTANT_ENCAPSED_STRING","'w+'",445],")",";",["T_WHITESPACE","\n        ",445],["T_IF","if",446],["T_WHITESPACE"," ",446],"(",["T_VARIABLE","$lock",446],["T_WHITESPACE"," ",446],["T_IS_IDENTICAL","===",446],["T_WHITESPACE"," ",446],["T_STRING","false",446],")",["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n            ",446],["T_RETURN","return",447],["T_WHITESPACE"," ",447],["T_STRING","false",447],";",["T_WHITESPACE","\n        ",447],"}",["T_WHITESPACE","\n        ",448],["T_IF","if",449],["T_WHITESPACE"," ",449],"(","!",["T_STRING","flock",449],"(",["T_VARIABLE","$lock",449],",",["T_WHITESPACE"," ",449],["T_STRING","LOCK_EX",449],")",")",["T_WHITESPACE"," ",449],"{",["T_WHITESPACE","\n            ",449],["T_STRING","fclose",450],"(",["T_VARIABLE","$lock",450],")",";",["T_WHITESPACE","\n            ",450],["T_RETURN","return",451],["T_WHITESPACE"," ",451],["T_STRING","false",451],";",["T_WHITESPACE","\n        ",451],"}",["T_WHITESPACE","\n        ",452],["T_TRY","try",453],["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n            ",453],["T_VARIABLE","$f",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],"@",["T_STRING","fopen",454],"(",["T_VARIABLE","$name",454],",",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'x'",454],")",";",["T_WHITESPACE","\n            ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$f",455],["T_WHITESPACE"," ",455],["T_IS_IDENTICAL","===",455],["T_WHITESPACE"," ",455],["T_STRING","false",455],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                ",455],["T_STRING","fclose",456],"(",["T_VARIABLE","$lock",456],")",";",["T_WHITESPACE","\n                ",456],["T_RETURN","return",457],["T_WHITESPACE"," ",457],["T_STRING","false",457],";",["T_WHITESPACE","\n            ",457],"}",["T_WHITESPACE","\n            ",458],["T_STRING","fwrite",459],"(",["T_VARIABLE","$f",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$provider",459],".",["T_CONSTANT_ENCAPSED_STRING","';'",459],".",["T_VARIABLE","$nonce",459],")",";",["T_WHITESPACE","\n            ",459],["T_STRING","fclose",460],"(",["T_VARIABLE","$f",460],")",";",["T_WHITESPACE","\n            ",460],["T_STRING","fclose",461],"(",["T_VARIABLE","$lock",461],")",";",["T_WHITESPACE","\n            ",461],["T_RETURN","return",462],["T_WHITESPACE"," ",462],["T_STRING","true",462],";",["T_WHITESPACE","\n        ",462],"}",["T_WHITESPACE"," ",463],["T_CATCH","catch",463],["T_WHITESPACE"," ",463],"(",["T_STRING","Exception",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$e",463],")",["T_WHITESPACE"," ",463],"{",["T_WHITESPACE","\n            ",463],["T_STRING","fclose",464],"(",["T_VARIABLE","$lock",464],")",";",["T_WHITESPACE","\n            ",464],["T_THROW","throw",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$e",465],";",["T_WHITESPACE","\n        ",465],"}",["T_WHITESPACE","\n    ",466],"}",["T_WHITESPACE","\n\n    ",467],["T_DOC_COMMENT","\/**\n     * Removes data from the uniqueness database that is older then given date\n     *\n     * @param mixed $date date of expired data\n     *\/",469],["T_WHITESPACE","\n    ",473],["T_PUBLIC","public",474],["T_WHITESPACE"," ",474],["T_FUNCTION","function",474],["T_WHITESPACE"," ",474],["T_STRING","purgeNonces",474],"(",["T_VARIABLE","$date",474],"=",["T_STRING","null",474],")",["T_WHITESPACE","\n    ",474],"{",["T_WHITESPACE","\n        ",475],["T_VARIABLE","$lock",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],"@",["T_STRING","fopen",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_dir",476],["T_WHITESPACE"," ",476],".",["T_WHITESPACE"," ",476],["T_CONSTANT_ENCAPSED_STRING","'\/nonce.lock'",476],",",["T_WHITESPACE"," ",476],["T_CONSTANT_ENCAPSED_STRING","'w+'",476],")",";",["T_WHITESPACE","\n        ",476],["T_IF","if",477],["T_WHITESPACE"," ",477],"(",["T_VARIABLE","$lock",477],["T_WHITESPACE"," ",477],["T_IS_NOT_IDENTICAL","!==",477],["T_WHITESPACE"," ",477],["T_STRING","false",477],")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n            ",477],["T_STRING","flock",478],"(",["T_VARIABLE","$lock",478],",",["T_WHITESPACE"," ",478],["T_STRING","LOCK_EX",478],")",";",["T_WHITESPACE","\n        ",478],"}",["T_WHITESPACE","\n        ",479],["T_TRY","try",480],["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n            ",480],["T_IF","if",481],["T_WHITESPACE"," ",481],"(","!",["T_STRING","is_int",481],"(",["T_VARIABLE","$date",481],")",["T_WHITESPACE"," ",481],["T_BOOLEAN_AND","&&",481],["T_WHITESPACE"," ",481],"!",["T_STRING","is_string",481],"(",["T_VARIABLE","$date",481],")",")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n                ",481],["T_VARIABLE","$nonceFiles",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_STRING","glob",482],"(",["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_dir",482],["T_WHITESPACE"," ",482],".",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'\/nonce_*'",482],")",";",["T_WHITESPACE","\n                ",482],["T_FOREACH","foreach",483],["T_WHITESPACE"," ",483],"(",["T_ARRAY_CAST","(array)",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$nonceFiles",483],["T_WHITESPACE"," ",483],["T_AS","as",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$name",483],")",["T_WHITESPACE"," ",483],"{",["T_WHITESPACE","\n                    ",483],"@",["T_STRING","unlink",484],"(",["T_VARIABLE","$name",484],")",";",["T_WHITESPACE","\n                ",484],"}",["T_WHITESPACE","\n                ",485],["T_UNSET","unset",486],"(",["T_VARIABLE","$nonceFiles",486],")",";",["T_WHITESPACE","\n            ",486],"}",["T_WHITESPACE"," ",487],["T_ELSE","else",487],["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n                ",487],["T_IF","if",488],["T_WHITESPACE"," ",488],"(",["T_STRING","is_string",488],"(",["T_VARIABLE","$date",488],")",")",["T_WHITESPACE"," ",488],"{",["T_WHITESPACE","\n                    ",488],["T_VARIABLE","$time",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_STRING","time",489],"(",["T_VARIABLE","$date",489],")",";",["T_WHITESPACE","\n                ",489],"}",["T_WHITESPACE"," ",490],["T_ELSE","else",490],["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n                    ",490],["T_VARIABLE","$time",491],["T_WHITESPACE"," ",491],"=",["T_WHITESPACE"," ",491],["T_VARIABLE","$date",491],";",["T_WHITESPACE","\n                ",491],"}",["T_WHITESPACE","\n                ",492],["T_VARIABLE","$nonceFiles",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_STRING","glob",493],"(",["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","_dir",493],["T_WHITESPACE"," ",493],".",["T_WHITESPACE"," ",493],["T_CONSTANT_ENCAPSED_STRING","'\/nonce_*'",493],")",";",["T_WHITESPACE","\n                ",493],["T_FOREACH","foreach",494],["T_WHITESPACE"," ",494],"(",["T_ARRAY_CAST","(array)",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$nonceFiles",494],["T_WHITESPACE"," ",494],["T_AS","as",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$name",494],")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n                    ",494],["T_IF","if",495],["T_WHITESPACE"," ",495],"(",["T_STRING","filemtime",495],"(",["T_VARIABLE","$name",495],")",["T_WHITESPACE"," ",495],"<",["T_WHITESPACE"," ",495],["T_VARIABLE","$time",495],")",["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n                        ",495],"@",["T_STRING","unlink",496],"(",["T_VARIABLE","$name",496],")",";",["T_WHITESPACE","\n                    ",496],"}",["T_WHITESPACE","\n                ",497],"}",["T_WHITESPACE","\n                ",498],["T_UNSET","unset",499],"(",["T_VARIABLE","$nonceFiles",499],")",";",["T_WHITESPACE","\n            ",499],"}",["T_WHITESPACE","\n            ",500],["T_IF","if",501],["T_WHITESPACE"," ",501],"(",["T_VARIABLE","$lock",501],["T_WHITESPACE"," ",501],["T_IS_NOT_IDENTICAL","!==",501],["T_WHITESPACE"," ",501],["T_STRING","false",501],")",["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n                ",501],["T_STRING","fclose",502],"(",["T_VARIABLE","$lock",502],")",";",["T_WHITESPACE","\n            ",502],"}",["T_WHITESPACE","\n        ",503],"}",["T_WHITESPACE"," ",504],["T_CATCH","catch",504],["T_WHITESPACE"," ",504],"(",["T_STRING","Exception",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$e",504],")",["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n            ",504],["T_IF","if",505],["T_WHITESPACE"," ",505],"(",["T_VARIABLE","$lock",505],["T_WHITESPACE"," ",505],["T_IS_NOT_IDENTICAL","!==",505],["T_WHITESPACE"," ",505],["T_STRING","false",505],")",["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n                ",505],["T_STRING","fclose",506],"(",["T_VARIABLE","$lock",506],")",";",["T_WHITESPACE","\n            ",506],"}",["T_WHITESPACE","\n            ",507],["T_THROW","throw",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$e",508],";",["T_WHITESPACE","\n        ",508],"}",["T_WHITESPACE","\n    ",509],"}",["T_WHITESPACE","\n",510],"}",["T_WHITESPACE","\n",511]]