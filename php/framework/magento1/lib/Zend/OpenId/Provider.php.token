[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Provider\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",3],["T_WHITESPACE","\n\n",22],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once \"Zend\/OpenId.php\";\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId_Extension\n *\/",29],["T_WHITESPACE","\n",31],["T_COMMENT","#require_once \"Zend\/OpenId\/Extension.php\";\n",32],["T_WHITESPACE","\n",33],["T_DOC_COMMENT","\/**\n * OpenID provider (server) implementation\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Provider\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",34],["T_WHITESPACE","\n",42],["T_CLASS","class",43],["T_WHITESPACE"," ",43],["T_STRING","Zend_OpenId_Provider",43],["T_WHITESPACE","\n",43],"{",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Reference to an implementation of storage object\n     *\n     * @var Zend_OpenId_Provider_Storage $_storage\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PRIVATE","private",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$_storage",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Reference to an implementation of user object\n     *\n     * @var Zend_OpenId_Provider_User $_user\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PRIVATE","private",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_user",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Time to live of association session in secconds\n     *\n     * @var integer $_sessionTtl\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PRIVATE","private",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_sessionTtl",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * URL to peform interactive user login\n     *\n     * @var string $_loginUrl\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PRIVATE","private",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$_loginUrl",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * URL to peform interactive validation of consumer by user\n     *\n     * @var string $_trustUrl\n     *\/",74],["T_WHITESPACE","\n    ",78],["T_PRIVATE","private",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$_trustUrl",79],";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * The OP Endpoint URL\n     *\n     * @var string $_opEndpoint\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PRIVATE","private",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_opEndpoint",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Constructs a Zend_OpenId_Provider object with given parameters.\n     *\n     * @param string $loginUrl is an URL that provides login screen for\n     *  end-user (by default it is the same URL with additional GET variable\n     *  openid.action=login)\n     * @param string $trustUrl is an URL that shows a question if end-user\n     *  trust to given consumer (by default it is the same URL with additional\n     *  GET variable openid.action=trust)\n     * @param Zend_OpenId_Provider_User $user is an object for communication\n     *  with User-Agent and store information about logged-in user (it is a\n     *  Zend_OpenId_Provider_User_Session object by default)\n     * @param Zend_OpenId_Provider_Storage $storage is an object for keeping\n     *  persistent database (it is a Zend_OpenId_Provider_Storage_File object\n     *  by default)\n     * @param integer $sessionTtl is a default time to live for association\n     *   session in seconds (1 hour by default). Consumer must reestablish\n     *   association after that time.\n     *\/",88],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","__construct",107],"(",["T_VARIABLE","$loginUrl",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","null",107],",",["T_WHITESPACE","\n                                ",107],["T_VARIABLE","$trustUrl",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","null",108],",",["T_WHITESPACE","\n                                ",108],["T_STRING","Zend_OpenId_Provider_User",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$user",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","null",109],",",["T_WHITESPACE","\n                                ",109],["T_STRING","Zend_OpenId_Provider_Storage",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$storage",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","null",110],",",["T_WHITESPACE","\n                                ",110],["T_VARIABLE","$sessionTtl",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_LNUMBER","3600",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$loginUrl",113],["T_WHITESPACE"," ",113],["T_IS_IDENTICAL","===",113],["T_WHITESPACE"," ",113],["T_STRING","null",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$loginUrl",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","Zend_OpenId",114],["T_DOUBLE_COLON","::",114],["T_STRING","selfUrl",114],"(",")",["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'?openid.action=login'",114],";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE"," ",115],["T_ELSE","else",115],["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$loginUrl",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","Zend_OpenId",116],["T_DOUBLE_COLON","::",116],["T_STRING","absoluteUrl",116],"(",["T_VARIABLE","$loginUrl",116],")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_loginUrl",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$loginUrl",118],";",["T_WHITESPACE","\n        ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$trustUrl",119],["T_WHITESPACE"," ",119],["T_IS_IDENTICAL","===",119],["T_WHITESPACE"," ",119],["T_STRING","null",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$trustUrl",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","Zend_OpenId",120],["T_DOUBLE_COLON","::",120],["T_STRING","selfUrl",120],"(",")",["T_WHITESPACE"," ",120],".",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'?openid.action=trust'",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE"," ",121],["T_ELSE","else",121],["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$trustUrl",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_STRING","Zend_OpenId",122],["T_DOUBLE_COLON","::",122],["T_STRING","absoluteUrl",122],"(",["T_VARIABLE","$trustUrl",122],")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_trustUrl",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$trustUrl",124],";",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$user",125],["T_WHITESPACE"," ",125],["T_IS_IDENTICAL","===",125],["T_WHITESPACE"," ",125],["T_STRING","null",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_COMMENT","#require_once \"Zend\/OpenId\/Provider\/User\/Session.php\";\n",126],["T_WHITESPACE","            ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_user",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","Zend_OpenId_Provider_User_Session",127],"(",")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE"," ",128],["T_ELSE","else",128],["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_user",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$user",129],";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n        ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$storage",131],["T_WHITESPACE"," ",131],["T_IS_IDENTICAL","===",131],["T_WHITESPACE"," ",131],["T_STRING","null",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_COMMENT","#require_once \"Zend\/OpenId\/Provider\/Storage\/File.php\";\n",132],["T_WHITESPACE","            ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_storage",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_STRING","Zend_OpenId_Provider_Storage_File",133],"(",")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_ELSE","else",134],["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_storage",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$storage",135],";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_sessionTtl",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$sessionTtl",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Sets the OP Endpoint URL\n     *\n     * @param string $url the OP Endpoint URL\n     * @return null\n     *\/",140],["T_WHITESPACE","\n    ",145],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","setOpEndpoint",146],"(",["T_VARIABLE","$url",146],")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_opEndpoint",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$url",148],";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Registers a new user with given $id and $password\n     * Returns true in case of success and false if user with given $id already\n     * exists\n     *\n     * @param string $id user identity URL\n     * @param string $password encoded user password\n     * @return bool\n     *\/",151],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","register",160],"(",["T_VARIABLE","$id",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$password",160],")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_IF","if",162],["T_WHITESPACE"," ",162],"(","!",["T_STRING","Zend_OpenId",162],["T_DOUBLE_COLON","::",162],["T_STRING","normalize",162],"(",["T_VARIABLE","$id",162],")",["T_WHITESPACE"," ",162],["T_BOOLEAN_OR","||",162],["T_WHITESPACE"," ",162],["T_EMPTY","empty",162],"(",["T_VARIABLE","$id",162],")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","false",163],";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE","\n        ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_storage",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","addUser",165],"(",["T_VARIABLE","$id",165],",",["T_WHITESPACE"," ",165],["T_STRING","md5",165],"(",["T_VARIABLE","$id",165],".",["T_VARIABLE","$password",165],")",")",";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Returns true if user with given $id exists and false otherwise\n     *\n     * @param string $id user identity URL\n     * @return bool\n     *\/",168],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","hasUser",174],"(",["T_VARIABLE","$id",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n        ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(","!",["T_STRING","Zend_OpenId",175],["T_DOUBLE_COLON","::",175],["T_STRING","normalize",175],"(",["T_VARIABLE","$id",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_STRING","false",176],";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n        ",177],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_storage",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","hasUser",178],"(",["T_VARIABLE","$id",178],")",";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Performs login of user with given $id and $password\n     * Returns true in case of success and false otherwise\n     *\n     * @param string $id user identity URL\n     * @param string $password user password\n     * @return bool\n     *\/",181],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","login",189],"(",["T_VARIABLE","$id",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$password",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(","!",["T_STRING","Zend_OpenId",191],["T_DOUBLE_COLON","::",191],["T_STRING","normalize",191],"(",["T_VARIABLE","$id",191],")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","false",192],";",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n        ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(","!",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_storage",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","checkUser",194],"(",["T_VARIABLE","$id",194],",",["T_WHITESPACE"," ",194],["T_STRING","md5",194],"(",["T_VARIABLE","$id",194],".",["T_VARIABLE","$password",194],")",")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_STRING","false",195],";",["T_WHITESPACE","\n        ",195],"}",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","_user",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","setLoggedInUser",197],"(",["T_VARIABLE","$id",197],")",";",["T_WHITESPACE","\n        ",197],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_STRING","true",198],";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Performs logout. Clears information about logged in user.\n     *\n     * @return void\n     *\/",201],["T_WHITESPACE","\n    ",205],["T_PUBLIC","public",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","logout",206],"(",")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_user",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","delLoggedInUser",208],"(",")",";",["T_WHITESPACE","\n        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_STRING","true",209],";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Returns identity URL of current logged in user or false\n     *\n     * @return mixed\n     *\/",212],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","getLoggedInUser",217],"(",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n        ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_user",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getLoggedInUser",218],"(",")",";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Retrieve consumer's root URL from request query.\n     * Returns URL or false in case of failure\n     *\n     * @param array $params query arguments\n     * @return mixed\n     *\/",221],["T_WHITESPACE","\n    ",227],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","getSiteRoot",228],"(",["T_VARIABLE","$params",228],")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_VARIABLE","$version",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_DNUMBER","1.1",230],";",["T_WHITESPACE","\n        ",230],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_ISSET","isset",231],"(",["T_VARIABLE","$params",231],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",231],"]",")",["T_WHITESPACE"," ",231],["T_BOOLEAN_AND","&&",231],["T_WHITESPACE","\n            ",231],["T_VARIABLE","$params",232],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",232],"]",["T_WHITESPACE"," ",232],["T_IS_EQUAL","==",232],["T_WHITESPACE"," ",232],["T_STRING","Zend_OpenId",232],["T_DOUBLE_COLON","::",232],["T_STRING","NS_2_0",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$version",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_DNUMBER","2.0",233],";",["T_WHITESPACE","\n        ",233],"}",["T_WHITESPACE","\n        ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$version",235],["T_WHITESPACE"," ",235],["T_IS_GREATER_OR_EQUAL",">=",235],["T_WHITESPACE"," ",235],["T_DNUMBER","2.0",235],["T_WHITESPACE"," ",235],["T_BOOLEAN_AND","&&",235],["T_WHITESPACE"," ",235],["T_ISSET","isset",235],"(",["T_VARIABLE","$params",235],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_realm'",235],"]",")",")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$root",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$params",236],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_realm'",236],"]",";",["T_WHITESPACE","\n        ",236],"}",["T_WHITESPACE"," ",237],["T_ELSE","else",237],["T_WHITESPACE"," ",237],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$version",237],["T_WHITESPACE"," ",237],"<",["T_WHITESPACE"," ",237],["T_DNUMBER","2.0",237],["T_WHITESPACE"," ",237],["T_BOOLEAN_AND","&&",237],["T_WHITESPACE"," ",237],["T_ISSET","isset",237],"(",["T_VARIABLE","$params",237],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_trust_root'",237],"]",")",")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$root",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$params",238],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_trust_root'",238],"]",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE"," ",239],["T_ELSE","else",239],["T_WHITESPACE"," ",239],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_ISSET","isset",239],"(",["T_VARIABLE","$params",239],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",239],"]",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$root",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$params",240],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",240],"]",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE"," ",241],["T_ELSE","else",241],["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_STRING","false",242],";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_STRING","Zend_OpenId",244],["T_DOUBLE_COLON","::",244],["T_STRING","normalizeUrl",244],"(",["T_VARIABLE","$root",244],")",["T_WHITESPACE"," ",244],["T_BOOLEAN_AND","&&",244],["T_WHITESPACE"," ",244],"!",["T_EMPTY","empty",244],"(",["T_VARIABLE","$root",244],")",")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$root",245],";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n        ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_STRING","false",247],";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_DOC_COMMENT","\/**\n     * Allows consumer with given root URL to authenticate current logged\n     * in user. Returns true on success and false on error.\n     *\n     * @param string $root root URL\n     * @param mixed $extensions extension object or array of extensions objects\n     * @return bool\n     *\/",250],["T_WHITESPACE","\n    ",257],["T_PUBLIC","public",258],["T_WHITESPACE"," ",258],["T_FUNCTION","function",258],["T_WHITESPACE"," ",258],["T_STRING","allowSite",258],"(",["T_VARIABLE","$root",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$extensions",258],"=",["T_STRING","null",258],")",["T_WHITESPACE","\n    ",258],"{",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$id",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getLoggedInUser",260],"(",")",";",["T_WHITESPACE","\n        ",260],["T_IF","if",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$id",261],["T_WHITESPACE"," ",261],["T_IS_IDENTICAL","===",261],["T_WHITESPACE"," ",261],["T_STRING","false",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n            ",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],["T_STRING","false",262],";",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE","\n        ",263],["T_IF","if",264],["T_WHITESPACE"," ",264],"(",["T_VARIABLE","$extensions",264],["T_WHITESPACE"," ",264],["T_IS_NOT_IDENTICAL","!==",264],["T_WHITESPACE"," ",264],["T_STRING","null",264],")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n            ",264],["T_VARIABLE","$data",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",")",";",["T_WHITESPACE","\n            ",265],["T_STRING","Zend_OpenId_Extension",266],["T_DOUBLE_COLON","::",266],["T_STRING","forAll",266],"(",["T_VARIABLE","$extensions",266],",",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'getTrustData'",266],",",["T_WHITESPACE"," ",266],["T_VARIABLE","$data",266],")",";",["T_WHITESPACE","\n        ",266],"}",["T_WHITESPACE"," ",267],["T_ELSE","else",267],["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n            ",267],["T_VARIABLE","$data",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","true",268],";",["T_WHITESPACE","\n        ",268],"}",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_storage",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","addSite",270],"(",["T_VARIABLE","$id",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$root",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$data",270],")",";",["T_WHITESPACE","\n        ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_STRING","true",271],";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Prohibit consumer with given root URL to authenticate current logged\n     * in user. Returns true on success and false on error.\n     *\n     * @param string $root root URL\n     * @return bool\n     *\/",274],["T_WHITESPACE","\n    ",280],["T_PUBLIC","public",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","denySite",281],"(",["T_VARIABLE","$root",281],")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$id",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getLoggedInUser",283],"(",")",";",["T_WHITESPACE","\n        ",283],["T_IF","if",284],["T_WHITESPACE"," ",284],"(",["T_VARIABLE","$id",284],["T_WHITESPACE"," ",284],["T_IS_IDENTICAL","===",284],["T_WHITESPACE"," ",284],["T_STRING","false",284],")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_RETURN","return",285],["T_WHITESPACE"," ",285],["T_STRING","false",285],";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n        ",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","_storage",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","addSite",287],"(",["T_VARIABLE","$id",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$root",287],",",["T_WHITESPACE"," ",287],["T_STRING","false",287],")",";",["T_WHITESPACE","\n        ",287],["T_RETURN","return",288],["T_WHITESPACE"," ",288],["T_STRING","true",288],";",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n\n    ",289],["T_DOC_COMMENT","\/**\n     * Delete consumer with given root URL from known sites of current logged\n     * in user. Next time this consumer will try to authenticate the user,\n     * Provider will ask user's confirmation.\n     * Returns true on success and false on error.\n     *\n     * @param string $root root URL\n     * @return bool\n     *\/",291],["T_WHITESPACE","\n    ",299],["T_PUBLIC","public",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","delSite",300],"(",["T_VARIABLE","$root",300],")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$id",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getLoggedInUser",302],"(",")",";",["T_WHITESPACE","\n        ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$id",303],["T_WHITESPACE"," ",303],["T_IS_IDENTICAL","===",303],["T_WHITESPACE"," ",303],["T_STRING","false",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_STRING","false",304],";",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_storage",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","addSite",306],"(",["T_VARIABLE","$id",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$root",306],",",["T_WHITESPACE"," ",306],["T_STRING","null",306],")",";",["T_WHITESPACE","\n        ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_STRING","true",307],";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * Returns list of known consumers for current logged in user or false\n     * if he is not logged in.\n     *\n     * @return mixed\n     *\/",310],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","getTrustedSites",316],"(",")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$id",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getLoggedInUser",318],"(",")",";",["T_WHITESPACE","\n        ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$id",319],["T_WHITESPACE"," ",319],["T_IS_IDENTICAL","===",319],["T_WHITESPACE"," ",319],["T_STRING","false",319],")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n            ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_STRING","false",320],";",["T_WHITESPACE","\n        ",320],"}",["T_WHITESPACE","\n        ",321],["T_RETURN","return",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_storage",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getTrustedSites",322],"(",["T_VARIABLE","$id",322],")",";",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n\n    ",323],["T_DOC_COMMENT","\/**\n     * Handles HTTP request from consumer\n     *\n     * @param array $params GET or POST variables. If this parameter is omited\n     *  or set to null, then $_GET or $_POST superglobal variable is used\n     *  according to REQUEST_METHOD.\n     * @param mixed $extensions extension object or array of extensions objects\n     * @param Zend_Controller_Response_Abstract $response an optional response\n     *  object to perform HTTP or HTML form redirection\n     * @return mixed\n     *\/",325],["T_WHITESPACE","\n    ",335],["T_PUBLIC","public",336],["T_WHITESPACE"," ",336],["T_FUNCTION","function",336],["T_WHITESPACE"," ",336],["T_STRING","handle",336],"(",["T_VARIABLE","$params",336],"=",["T_STRING","null",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$extensions",336],"=",["T_STRING","null",336],",",["T_WHITESPACE","\n                           ",336],["T_STRING","Zend_Controller_Response_Abstract",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$response",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_STRING","null",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$params",339],["T_WHITESPACE"," ",339],["T_IS_IDENTICAL","===",339],["T_WHITESPACE"," ",339],["T_STRING","null",339],")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_IF","if",340],["T_WHITESPACE"," ",340],"(",["T_VARIABLE","$_SERVER",340],"[",["T_CONSTANT_ENCAPSED_STRING","\"REQUEST_METHOD\"",340],"]",["T_WHITESPACE"," ",340],["T_IS_EQUAL","==",340],["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","\"GET\"",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n                ",340],["T_VARIABLE","$params",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$_GET",341],";",["T_WHITESPACE","\n            ",341],"}",["T_WHITESPACE"," ",342],["T_ELSE","else",342],["T_WHITESPACE"," ",342],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$_SERVER",342],"[",["T_CONSTANT_ENCAPSED_STRING","\"REQUEST_METHOD\"",342],"]",["T_WHITESPACE"," ",342],["T_IS_EQUAL","==",342],["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","\"POST\"",342],")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                ",342],["T_VARIABLE","$params",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_VARIABLE","$_POST",343],";",["T_WHITESPACE","\n            ",343],"}",["T_WHITESPACE"," ",344],["T_ELSE","else",344],["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                ",344],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_STRING","false",345],";",["T_WHITESPACE","\n            ",345],"}",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE","\n        ",347],["T_VARIABLE","$version",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_DNUMBER","1.1",348],";",["T_WHITESPACE","\n        ",348],["T_IF","if",349],["T_WHITESPACE"," ",349],"(",["T_ISSET","isset",349],"(",["T_VARIABLE","$params",349],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",349],"]",")",["T_WHITESPACE"," ",349],["T_BOOLEAN_AND","&&",349],["T_WHITESPACE","\n            ",349],["T_VARIABLE","$params",350],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",350],"]",["T_WHITESPACE"," ",350],["T_IS_EQUAL","==",350],["T_WHITESPACE"," ",350],["T_STRING","Zend_OpenId",350],["T_DOUBLE_COLON","::",350],["T_STRING","NS_2_0",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_VARIABLE","$version",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_DNUMBER","2.0",351],";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n        ",352],["T_IF","if",353],["T_WHITESPACE"," ",353],"(",["T_ISSET","isset",353],"(",["T_VARIABLE","$params",353],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",353],"]",")",")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n            ",353],["T_IF","if",354],["T_WHITESPACE"," ",354],"(",["T_VARIABLE","$params",354],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",354],"]",["T_WHITESPACE"," ",354],["T_IS_EQUAL","==",354],["T_WHITESPACE"," ",354],["T_CONSTANT_ENCAPSED_STRING","'associate'",354],")",["T_WHITESPACE"," ",354],"{",["T_WHITESPACE","\n                ",354],["T_VARIABLE","$response",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","_associate",355],"(",["T_VARIABLE","$version",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$params",355],")",";",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$ret",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","''",356],";",["T_WHITESPACE","\n                ",356],["T_FOREACH","foreach",357],["T_WHITESPACE"," ",357],"(",["T_VARIABLE","$response",357],["T_WHITESPACE"," ",357],["T_AS","as",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$key",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$val",357],")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n                    ",357],["T_VARIABLE","$ret",358],["T_WHITESPACE"," ",358],["T_CONCAT_EQUAL",".=",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$key",358],["T_WHITESPACE"," ",358],".",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","':'",358],["T_WHITESPACE"," ",358],".",["T_WHITESPACE"," ",358],["T_VARIABLE","$val",358],["T_WHITESPACE"," ",358],".",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",358],";",["T_WHITESPACE","\n                ",358],"}",["T_WHITESPACE","\n                ",359],["T_RETURN","return",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$ret",360],";",["T_WHITESPACE","\n            ",360],"}",["T_WHITESPACE"," ",361],["T_ELSE","else",361],["T_WHITESPACE"," ",361],["T_IF","if",361],["T_WHITESPACE"," ",361],"(",["T_VARIABLE","$params",361],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",361],"]",["T_WHITESPACE"," ",361],["T_IS_EQUAL","==",361],["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'checkid_immediate'",361],")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n                ",361],["T_VARIABLE","$ret",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_checkId",362],"(",["T_VARIABLE","$version",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$params",362],",",["T_WHITESPACE"," ",362],["T_LNUMBER","1",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$extensions",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$response",362],")",";",["T_WHITESPACE","\n                ",362],["T_IF","if",363],["T_WHITESPACE"," ",363],"(",["T_STRING","is_bool",363],"(",["T_VARIABLE","$ret",363],")",")",["T_WHITESPACE"," ",363],["T_RETURN","return",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$ret",363],";",["T_WHITESPACE","\n                ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(","!",["T_EMPTY","empty",364],"(",["T_VARIABLE","$params",364],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",364],"]",")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n                    ",364],["T_STRING","Zend_OpenId",365],["T_DOUBLE_COLON","::",365],["T_STRING","redirect",365],"(",["T_VARIABLE","$params",365],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",365],"]",",",["T_WHITESPACE"," ",365],["T_VARIABLE","$ret",365],",",["T_WHITESPACE"," ",365],["T_VARIABLE","$response",365],")",";",["T_WHITESPACE","\n                ",365],"}",["T_WHITESPACE","\n                ",366],["T_RETURN","return",367],["T_WHITESPACE"," ",367],["T_STRING","true",367],";",["T_WHITESPACE","\n            ",367],"}",["T_WHITESPACE"," ",368],["T_ELSE","else",368],["T_WHITESPACE"," ",368],["T_IF","if",368],["T_WHITESPACE"," ",368],"(",["T_VARIABLE","$params",368],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",368],"]",["T_WHITESPACE"," ",368],["T_IS_EQUAL","==",368],["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'checkid_setup'",368],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n                ",368],["T_VARIABLE","$ret",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_checkId",369],"(",["T_VARIABLE","$version",369],",",["T_WHITESPACE"," ",369],["T_VARIABLE","$params",369],",",["T_WHITESPACE"," ",369],["T_LNUMBER","0",369],",",["T_WHITESPACE"," ",369],["T_VARIABLE","$extensions",369],",",["T_WHITESPACE"," ",369],["T_VARIABLE","$response",369],")",";",["T_WHITESPACE","\n                ",369],["T_IF","if",370],["T_WHITESPACE"," ",370],"(",["T_STRING","is_bool",370],"(",["T_VARIABLE","$ret",370],")",")",["T_WHITESPACE"," ",370],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$ret",370],";",["T_WHITESPACE","\n                ",370],["T_IF","if",371],["T_WHITESPACE"," ",371],"(","!",["T_EMPTY","empty",371],"(",["T_VARIABLE","$params",371],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",371],"]",")",")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n                    ",371],["T_STRING","Zend_OpenId",372],["T_DOUBLE_COLON","::",372],["T_STRING","redirect",372],"(",["T_VARIABLE","$params",372],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",372],"]",",",["T_WHITESPACE"," ",372],["T_VARIABLE","$ret",372],",",["T_WHITESPACE"," ",372],["T_VARIABLE","$response",372],")",";",["T_WHITESPACE","\n                ",372],"}",["T_WHITESPACE","\n                ",373],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_STRING","true",374],";",["T_WHITESPACE","\n            ",374],"}",["T_WHITESPACE"," ",375],["T_ELSE","else",375],["T_WHITESPACE"," ",375],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_VARIABLE","$params",375],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",375],"]",["T_WHITESPACE"," ",375],["T_IS_EQUAL","==",375],["T_WHITESPACE"," ",375],["T_CONSTANT_ENCAPSED_STRING","'check_authentication'",375],")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n                ",375],["T_VARIABLE","$response",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_checkAuthentication",376],"(",["T_VARIABLE","$version",376],",",["T_WHITESPACE"," ",376],["T_VARIABLE","$params",376],")",";",["T_WHITESPACE","\n                ",376],["T_VARIABLE","$ret",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_CONSTANT_ENCAPSED_STRING","''",377],";",["T_WHITESPACE","\n                ",377],["T_FOREACH","foreach",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$response",378],["T_WHITESPACE"," ",378],["T_AS","as",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$key",378],["T_WHITESPACE"," ",378],["T_DOUBLE_ARROW","=>",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$val",378],")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n                    ",378],["T_VARIABLE","$ret",379],["T_WHITESPACE"," ",379],["T_CONCAT_EQUAL",".=",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$key",379],["T_WHITESPACE"," ",379],".",["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","':'",379],["T_WHITESPACE"," ",379],".",["T_WHITESPACE"," ",379],["T_VARIABLE","$val",379],["T_WHITESPACE"," ",379],".",["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",379],";",["T_WHITESPACE","\n                ",379],"}",["T_WHITESPACE","\n                ",380],["T_RETURN","return",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$ret",381],";",["T_WHITESPACE","\n            ",381],"}",["T_WHITESPACE","\n        ",382],"}",["T_WHITESPACE","\n        ",383],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_STRING","false",384],";",["T_WHITESPACE","\n    ",384],"}",["T_WHITESPACE","\n\n    ",385],["T_DOC_COMMENT","\/**\n     * Generates a secret key for given hash function, returns RAW key or false\n     * if function is not supported\n     *\n     * @param string $func hash function (sha1 or sha256)\n     * @return mixed\n     *\/",387],["T_WHITESPACE","\n    ",393],["T_PROTECTED","protected",394],["T_WHITESPACE"," ",394],["T_FUNCTION","function",394],["T_WHITESPACE"," ",394],["T_STRING","_genSecret",394],"(",["T_VARIABLE","$func",394],")",["T_WHITESPACE","\n    ",394],"{",["T_WHITESPACE","\n        ",395],["T_IF","if",396],["T_WHITESPACE"," ",396],"(",["T_VARIABLE","$func",396],["T_WHITESPACE"," ",396],["T_IS_EQUAL","==",396],["T_WHITESPACE"," ",396],["T_CONSTANT_ENCAPSED_STRING","'sha1'",396],")",["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n            ",396],["T_VARIABLE","$macLen",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_LNUMBER","20",397],";",["T_WHITESPACE"," ",397],["T_COMMENT","\/* 160 bit *\/",397],["T_WHITESPACE","\n        ",397],"}",["T_WHITESPACE"," ",398],["T_ELSE","else",398],["T_WHITESPACE"," ",398],["T_IF","if",398],["T_WHITESPACE"," ",398],"(",["T_VARIABLE","$func",398],["T_WHITESPACE"," ",398],["T_IS_EQUAL","==",398],["T_WHITESPACE"," ",398],["T_CONSTANT_ENCAPSED_STRING","'sha256'",398],")",["T_WHITESPACE"," ",398],"{",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$macLen",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_LNUMBER","32",399],";",["T_WHITESPACE"," ",399],["T_COMMENT","\/* 256 bit *\/",399],["T_WHITESPACE","\n        ",399],"}",["T_WHITESPACE"," ",400],["T_ELSE","else",400],["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n            ",400],["T_RETURN","return",401],["T_WHITESPACE"," ",401],["T_STRING","false",401],";",["T_WHITESPACE","\n        ",401],"}",["T_WHITESPACE","\n        ",402],["T_RETURN","return",403],["T_WHITESPACE"," ",403],["T_STRING","Zend_OpenId",403],["T_DOUBLE_COLON","::",403],["T_STRING","randomBytes",403],"(",["T_VARIABLE","$macLen",403],")",";",["T_WHITESPACE","\n    ",403],"}",["T_WHITESPACE","\n\n    ",404],["T_DOC_COMMENT","\/**\n     * Processes association request from OpenID consumerm generates secret\n     * shared key and send it back using Diffie-Hellman encruption.\n     * Returns array of variables to push back to consumer.\n     *\n     * @param float $version OpenID version\n     * @param array $params GET or POST request variables\n     * @return array\n     *\/",406],["T_WHITESPACE","\n    ",414],["T_PROTECTED","protected",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","_associate",415],"(",["T_VARIABLE","$version",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$params",415],")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_VARIABLE","$ret",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_ARRAY","array",417],"(",")",";",["T_WHITESPACE","\n\n        ",417],["T_IF","if",419],["T_WHITESPACE"," ",419],"(",["T_VARIABLE","$version",419],["T_WHITESPACE"," ",419],["T_IS_GREATER_OR_EQUAL",">=",419],["T_WHITESPACE"," ",419],["T_DNUMBER","2.0",419],")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n            ",419],["T_VARIABLE","$ret",420],"[",["T_CONSTANT_ENCAPSED_STRING","'ns'",420],"]",["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_STRING","Zend_OpenId",420],["T_DOUBLE_COLON","::",420],["T_STRING","NS_2_0",420],";",["T_WHITESPACE","\n        ",420],"}",["T_WHITESPACE","\n\n        ",421],["T_IF","if",423],["T_WHITESPACE"," ",423],"(",["T_ISSET","isset",423],"(",["T_VARIABLE","$params",423],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_type'",423],"]",")",["T_WHITESPACE"," ",423],["T_BOOLEAN_AND","&&",423],["T_WHITESPACE","\n            ",423],["T_VARIABLE","$params",424],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_type'",424],"]",["T_WHITESPACE"," ",424],["T_IS_EQUAL","==",424],["T_WHITESPACE"," ",424],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA1'",424],")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n            ",424],["T_VARIABLE","$macFunc",425],["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_CONSTANT_ENCAPSED_STRING","'sha1'",425],";",["T_WHITESPACE","\n        ",425],"}",["T_WHITESPACE"," ",426],["T_ELSE","else",426],["T_WHITESPACE"," ",426],["T_IF","if",426],["T_WHITESPACE"," ",426],"(",["T_ISSET","isset",426],"(",["T_VARIABLE","$params",426],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_type'",426],"]",")",["T_WHITESPACE"," ",426],["T_BOOLEAN_AND","&&",426],["T_WHITESPACE","\n            ",426],["T_VARIABLE","$params",427],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_type'",427],"]",["T_WHITESPACE"," ",427],["T_IS_EQUAL","==",427],["T_WHITESPACE"," ",427],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA256'",427],["T_WHITESPACE"," ",427],["T_BOOLEAN_AND","&&",427],["T_WHITESPACE","\n            ",427],["T_VARIABLE","$version",428],["T_WHITESPACE"," ",428],["T_IS_GREATER_OR_EQUAL",">=",428],["T_WHITESPACE"," ",428],["T_DNUMBER","2.0",428],")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n            ",428],["T_VARIABLE","$macFunc",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_CONSTANT_ENCAPSED_STRING","'sha256'",429],";",["T_WHITESPACE","\n        ",429],"}",["T_WHITESPACE"," ",430],["T_ELSE","else",430],["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n            ",430],["T_VARIABLE","$ret",431],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",431],"]",["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_CONSTANT_ENCAPSED_STRING","'Wrong \"openid.assoc_type\"'",431],";",["T_WHITESPACE","\n            ",431],["T_VARIABLE","$ret",432],"[",["T_CONSTANT_ENCAPSED_STRING","'error-code'",432],"]",["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'unsupported-type'",432],";",["T_WHITESPACE","\n            ",432],["T_RETURN","return",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$ret",433],";",["T_WHITESPACE","\n        ",433],"}",["T_WHITESPACE","\n\n        ",434],["T_VARIABLE","$ret",436],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_type'",436],"]",["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$params",436],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_type'",436],"]",";",["T_WHITESPACE","\n\n        ",436],["T_VARIABLE","$secret",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","_genSecret",438],"(",["T_VARIABLE","$macFunc",438],")",";",["T_WHITESPACE","\n\n        ",438],["T_IF","if",440],["T_WHITESPACE"," ",440],"(",["T_EMPTY","empty",440],"(",["T_VARIABLE","$params",440],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",440],"]",")",["T_WHITESPACE"," ",440],["T_BOOLEAN_OR","||",440],["T_WHITESPACE","\n            ",440],["T_VARIABLE","$params",441],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",441],"]",["T_WHITESPACE"," ",441],["T_IS_EQUAL","==",441],["T_WHITESPACE"," ",441],["T_CONSTANT_ENCAPSED_STRING","'no-encryption'",441],")",["T_WHITESPACE"," ",441],"{",["T_WHITESPACE","\n            ",441],["T_VARIABLE","$ret",442],"[",["T_CONSTANT_ENCAPSED_STRING","'mac_key'",442],"]",["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_STRING","base64_encode",442],"(",["T_VARIABLE","$secret",442],")",";",["T_WHITESPACE","\n        ",442],"}",["T_WHITESPACE"," ",443],["T_ELSE","else",443],["T_WHITESPACE"," ",443],["T_IF","if",443],["T_WHITESPACE"," ",443],"(",["T_ISSET","isset",443],"(",["T_VARIABLE","$params",443],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",443],"]",")",["T_WHITESPACE"," ",443],["T_BOOLEAN_AND","&&",443],["T_WHITESPACE","\n            ",443],["T_VARIABLE","$params",444],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",444],"]",["T_WHITESPACE"," ",444],["T_IS_EQUAL","==",444],["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA1'",444],")",["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n            ",444],["T_VARIABLE","$dhFunc",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_CONSTANT_ENCAPSED_STRING","'sha1'",445],";",["T_WHITESPACE","\n        ",445],"}",["T_WHITESPACE"," ",446],["T_ELSE","else",446],["T_WHITESPACE"," ",446],["T_IF","if",446],["T_WHITESPACE"," ",446],"(",["T_ISSET","isset",446],"(",["T_VARIABLE","$params",446],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",446],"]",")",["T_WHITESPACE"," ",446],["T_BOOLEAN_AND","&&",446],["T_WHITESPACE","\n            ",446],["T_VARIABLE","$params",447],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",447],"]",["T_WHITESPACE"," ",447],["T_IS_EQUAL","==",447],["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA256'",447],["T_WHITESPACE"," ",447],["T_BOOLEAN_AND","&&",447],["T_WHITESPACE","\n            ",447],["T_VARIABLE","$version",448],["T_WHITESPACE"," ",448],["T_IS_GREATER_OR_EQUAL",">=",448],["T_WHITESPACE"," ",448],["T_DNUMBER","2.0",448],")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n            ",448],["T_VARIABLE","$dhFunc",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'sha256'",449],";",["T_WHITESPACE","\n        ",449],"}",["T_WHITESPACE"," ",450],["T_ELSE","else",450],["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n            ",450],["T_VARIABLE","$ret",451],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",451],"]",["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","'Wrong \"openid.session_type\"'",451],";",["T_WHITESPACE","\n            ",451],["T_VARIABLE","$ret",452],"[",["T_CONSTANT_ENCAPSED_STRING","'error-code'",452],"]",["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],["T_CONSTANT_ENCAPSED_STRING","'unsupported-type'",452],";",["T_WHITESPACE","\n            ",452],["T_RETURN","return",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$ret",453],";",["T_WHITESPACE","\n        ",453],"}",["T_WHITESPACE","\n\n        ",454],["T_IF","if",456],["T_WHITESPACE"," ",456],"(",["T_ISSET","isset",456],"(",["T_VARIABLE","$params",456],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",456],"]",")",")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n            ",456],["T_VARIABLE","$ret",457],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",457],"]",["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_VARIABLE","$params",457],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_session_type'",457],"]",";",["T_WHITESPACE","\n        ",457],"}",["T_WHITESPACE","\n\n        ",458],["T_IF","if",460],["T_WHITESPACE"," ",460],"(",["T_ISSET","isset",460],"(",["T_VARIABLE","$dhFunc",460],")",")",["T_WHITESPACE"," ",460],"{",["T_WHITESPACE","\n            ",460],["T_IF","if",461],["T_WHITESPACE"," ",461],"(",["T_EMPTY","empty",461],"(",["T_VARIABLE","$params",461],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_dh_consumer_public'",461],"]",")",")",["T_WHITESPACE"," ",461],"{",["T_WHITESPACE","\n                ",461],["T_VARIABLE","$ret",462],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",462],"]",["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_CONSTANT_ENCAPSED_STRING","'Wrong \"openid.dh_consumer_public\"'",462],";",["T_WHITESPACE","\n                ",462],["T_RETURN","return",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$ret",463],";",["T_WHITESPACE","\n            ",463],"}",["T_WHITESPACE","\n            ",464],["T_IF","if",465],["T_WHITESPACE"," ",465],"(",["T_EMPTY","empty",465],"(",["T_VARIABLE","$params",465],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_dh_gen'",465],"]",")",")",["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n                ",465],["T_VARIABLE","$g",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_STRING","pack",466],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",466],",",["T_WHITESPACE"," ",466],["T_STRING","Zend_OpenId",466],["T_DOUBLE_COLON","::",466],["T_STRING","DH_G",466],")",";",["T_WHITESPACE","\n            ",466],"}",["T_WHITESPACE"," ",467],["T_ELSE","else",467],["T_WHITESPACE"," ",467],"{",["T_WHITESPACE","\n                ",467],["T_VARIABLE","$g",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_STRING","base64_decode",468],"(",["T_VARIABLE","$params",468],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_dh_gen'",468],"]",")",";",["T_WHITESPACE","\n            ",468],"}",["T_WHITESPACE","\n            ",469],["T_IF","if",470],["T_WHITESPACE"," ",470],"(",["T_EMPTY","empty",470],"(",["T_VARIABLE","$params",470],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_dh_modulus'",470],"]",")",")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n                ",470],["T_VARIABLE","$p",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_STRING","pack",471],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",471],",",["T_WHITESPACE"," ",471],["T_STRING","Zend_OpenId",471],["T_DOUBLE_COLON","::",471],["T_STRING","DH_P",471],")",";",["T_WHITESPACE","\n            ",471],"}",["T_WHITESPACE"," ",472],["T_ELSE","else",472],["T_WHITESPACE"," ",472],"{",["T_WHITESPACE","\n                ",472],["T_VARIABLE","$p",473],["T_WHITESPACE"," ",473],"=",["T_WHITESPACE"," ",473],["T_STRING","base64_decode",473],"(",["T_VARIABLE","$params",473],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_dh_modulus'",473],"]",")",";",["T_WHITESPACE","\n            ",473],"}",["T_WHITESPACE","\n\n            ",474],["T_VARIABLE","$dh",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_STRING","Zend_OpenId",476],["T_DOUBLE_COLON","::",476],["T_STRING","createDhKey",476],"(",["T_VARIABLE","$p",476],",",["T_WHITESPACE"," ",476],["T_VARIABLE","$g",476],")",";",["T_WHITESPACE","\n            ",476],["T_VARIABLE","$dh_details",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_STRING","Zend_OpenId",477],["T_DOUBLE_COLON","::",477],["T_STRING","getDhKeyDetails",477],"(",["T_VARIABLE","$dh",477],")",";",["T_WHITESPACE","\n\n            ",477],["T_VARIABLE","$sec",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_STRING","Zend_OpenId",479],["T_DOUBLE_COLON","::",479],["T_STRING","computeDhSecret",479],"(",["T_WHITESPACE","\n                ",479],["T_STRING","base64_decode",480],"(",["T_VARIABLE","$params",480],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_dh_consumer_public'",480],"]",")",",",["T_WHITESPACE"," ",480],["T_VARIABLE","$dh",480],")",";",["T_WHITESPACE","\n            ",480],["T_IF","if",481],["T_WHITESPACE"," ",481],"(",["T_VARIABLE","$sec",481],["T_WHITESPACE"," ",481],["T_IS_IDENTICAL","===",481],["T_WHITESPACE"," ",481],["T_STRING","false",481],")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n                ",481],["T_VARIABLE","$ret",482],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",482],"]",["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'Wrong \"openid.session_type\"'",482],";",["T_WHITESPACE","\n                ",482],["T_VARIABLE","$ret",483],"[",["T_CONSTANT_ENCAPSED_STRING","'error-code'",483],"]",["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'unsupported-type'",483],";",["T_WHITESPACE","\n                ",483],["T_RETURN","return",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$ret",484],";",["T_WHITESPACE","\n            ",484],"}",["T_WHITESPACE","\n            ",485],["T_VARIABLE","$sec",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_STRING","Zend_OpenId",486],["T_DOUBLE_COLON","::",486],["T_STRING","digest",486],"(",["T_VARIABLE","$dhFunc",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$sec",486],")",";",["T_WHITESPACE","\n            ",486],["T_VARIABLE","$ret",487],"[",["T_CONSTANT_ENCAPSED_STRING","'dh_server_public'",487],"]",["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_STRING","base64_encode",487],"(",["T_WHITESPACE","\n                ",487],["T_STRING","Zend_OpenId",488],["T_DOUBLE_COLON","::",488],["T_STRING","btwoc",488],"(",["T_VARIABLE","$dh_details",488],"[",["T_CONSTANT_ENCAPSED_STRING","'pub_key'",488],"]",")",")",";",["T_WHITESPACE","\n            ",488],["T_VARIABLE","$ret",489],"[",["T_CONSTANT_ENCAPSED_STRING","'enc_mac_key'",489],"]",["T_WHITESPACE","      ",489],"=",["T_WHITESPACE"," ",489],["T_STRING","base64_encode",489],"(",["T_VARIABLE","$secret",489],["T_WHITESPACE"," ",489],"^",["T_WHITESPACE"," ",489],["T_VARIABLE","$sec",489],")",";",["T_WHITESPACE","\n        ",489],"}",["T_WHITESPACE","\n\n        ",490],["T_VARIABLE","$handle",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_STRING","uniqid",492],"(",")",";",["T_WHITESPACE","\n        ",492],["T_VARIABLE","$expiresIn",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","_sessionTtl",493],";",["T_WHITESPACE","\n\n        ",493],["T_VARIABLE","$ret",495],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_handle'",495],"]",["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_VARIABLE","$handle",495],";",["T_WHITESPACE","\n        ",495],["T_VARIABLE","$ret",496],"[",["T_CONSTANT_ENCAPSED_STRING","'expires_in'",496],"]",["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$expiresIn",496],";",["T_WHITESPACE","\n\n        ",496],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","_storage",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","addAssociation",498],"(",["T_VARIABLE","$handle",498],",",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$macFunc",499],",",["T_WHITESPACE"," ",499],["T_VARIABLE","$secret",499],",",["T_WHITESPACE"," ",499],["T_STRING","time",499],"(",")",["T_WHITESPACE"," ",499],"+",["T_WHITESPACE"," ",499],["T_VARIABLE","$expiresIn",499],")",";",["T_WHITESPACE","\n\n        ",499],["T_RETURN","return",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$ret",501],";",["T_WHITESPACE","\n    ",501],"}",["T_WHITESPACE","\n\n    ",502],["T_DOC_COMMENT","\/**\n     * Performs authentication (or authentication check).\n     *\n     * @param float $version OpenID version\n     * @param array $params GET or POST request variables\n     * @param bool $immediate enables or disables interaction with user\n     * @param mixed $extensions extension object or array of extensions objects\n     * @param Zend_Controller_Response_Abstract $response\n     * @return array\n     *\/",504],["T_WHITESPACE","\n    ",513],["T_PROTECTED","protected",514],["T_WHITESPACE"," ",514],["T_FUNCTION","function",514],["T_WHITESPACE"," ",514],["T_STRING","_checkId",514],"(",["T_VARIABLE","$version",514],",",["T_WHITESPACE"," ",514],["T_VARIABLE","$params",514],",",["T_WHITESPACE"," ",514],["T_VARIABLE","$immediate",514],",",["T_WHITESPACE"," ",514],["T_VARIABLE","$extensions",514],"=",["T_STRING","null",514],",",["T_WHITESPACE","\n        ",514],["T_STRING","Zend_Controller_Response_Abstract",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$response",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_STRING","null",515],")",["T_WHITESPACE","\n    ",515],"{",["T_WHITESPACE","\n        ",516],["T_VARIABLE","$ret",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],["T_ARRAY","array",517],"(",")",";",["T_WHITESPACE","\n\n        ",517],["T_IF","if",519],["T_WHITESPACE"," ",519],"(",["T_VARIABLE","$version",519],["T_WHITESPACE"," ",519],["T_IS_GREATER_OR_EQUAL",">=",519],["T_WHITESPACE"," ",519],["T_DNUMBER","2.0",519],")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n            ",519],["T_VARIABLE","$ret",520],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.ns'",520],"]",["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_STRING","Zend_OpenId",520],["T_DOUBLE_COLON","::",520],["T_STRING","NS_2_0",520],";",["T_WHITESPACE","\n        ",520],"}",["T_WHITESPACE","\n        ",521],["T_VARIABLE","$root",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","getSiteRoot",522],"(",["T_VARIABLE","$params",522],")",";",["T_WHITESPACE","\n        ",522],["T_IF","if",523],["T_WHITESPACE"," ",523],"(",["T_VARIABLE","$root",523],["T_WHITESPACE"," ",523],["T_IS_IDENTICAL","===",523],["T_WHITESPACE"," ",523],["T_STRING","false",523],")",["T_WHITESPACE"," ",523],"{",["T_WHITESPACE","\n            ",523],["T_RETURN","return",524],["T_WHITESPACE"," ",524],["T_STRING","false",524],";",["T_WHITESPACE","\n        ",524],"}",["T_WHITESPACE","\n\n        ",525],["T_IF","if",527],["T_WHITESPACE"," ",527],"(",["T_ISSET","isset",527],"(",["T_VARIABLE","$params",527],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",527],"]",")",["T_WHITESPACE"," ",527],["T_BOOLEAN_AND","&&",527],["T_WHITESPACE","\n            ",527],"!",["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","_storage",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","hasUser",528],"(",["T_VARIABLE","$params",528],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",528],"]",")",")",["T_WHITESPACE"," ",528],"{",["T_WHITESPACE","\n            ",528],["T_VARIABLE","$ret",529],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",529],"]",["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],"(",["T_VARIABLE","$immediate",529],["T_WHITESPACE"," ",529],["T_BOOLEAN_AND","&&",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$version",529],["T_WHITESPACE"," ",529],["T_IS_GREATER_OR_EQUAL",">=",529],["T_WHITESPACE"," ",529],["T_DNUMBER","2.0",529],")",["T_WHITESPACE"," ",529],"?",["T_WHITESPACE"," ",529],["T_CONSTANT_ENCAPSED_STRING","'setup_needed'",529],":",["T_WHITESPACE"," ",529],["T_CONSTANT_ENCAPSED_STRING","'cancel'",529],";",["T_WHITESPACE","\n            ",529],["T_RETURN","return",530],["T_WHITESPACE"," ",530],["T_VARIABLE","$ret",530],";",["T_WHITESPACE","\n        ",530],"}",["T_WHITESPACE","\n\n        ",531],["T_COMMENT","\/* Check if user already logged in into the server *\/",533],["T_WHITESPACE","\n        ",533],["T_IF","if",534],["T_WHITESPACE"," ",534],"(","!",["T_ISSET","isset",534],"(",["T_VARIABLE","$params",534],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",534],"]",")",["T_WHITESPACE"," ",534],["T_BOOLEAN_OR","||",534],["T_WHITESPACE","\n            ",534],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","_user",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","getLoggedInUser",535],"(",")",["T_WHITESPACE"," ",535],["T_IS_NOT_IDENTICAL","!==",535],["T_WHITESPACE"," ",535],["T_VARIABLE","$params",535],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",535],"]",")",["T_WHITESPACE"," ",535],"{",["T_WHITESPACE","\n            ",535],["T_VARIABLE","$params2",536],["T_WHITESPACE"," ",536],"=",["T_WHITESPACE"," ",536],["T_ARRAY","array",536],"(",")",";",["T_WHITESPACE","\n            ",536],["T_FOREACH","foreach",537],["T_WHITESPACE"," ",537],"(",["T_VARIABLE","$params",537],["T_WHITESPACE"," ",537],["T_AS","as",537],["T_WHITESPACE"," ",537],["T_VARIABLE","$key",537],["T_WHITESPACE"," ",537],["T_DOUBLE_ARROW","=>",537],["T_WHITESPACE"," ",537],["T_VARIABLE","$val",537],")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n                ",537],["T_IF","if",538],["T_WHITESPACE"," ",538],"(",["T_STRING","strpos",538],"(",["T_VARIABLE","$key",538],",",["T_WHITESPACE"," ",538],["T_CONSTANT_ENCAPSED_STRING","'openid_ns_'",538],")",["T_WHITESPACE"," ",538],["T_IS_IDENTICAL","===",538],["T_WHITESPACE"," ",538],["T_LNUMBER","0",538],")",["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n                    ",538],["T_VARIABLE","$key",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_CONSTANT_ENCAPSED_STRING","'openid.ns.'",539],["T_WHITESPACE"," ",539],".",["T_WHITESPACE"," ",539],["T_STRING","substr",539],"(",["T_VARIABLE","$key",539],",",["T_WHITESPACE"," ",539],["T_STRING","strlen",539],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_ns_'",539],")",")",";",["T_WHITESPACE","\n                ",539],"}",["T_WHITESPACE"," ",540],["T_ELSE","else",540],["T_WHITESPACE"," ",540],["T_IF","if",540],["T_WHITESPACE"," ",540],"(",["T_STRING","strpos",540],"(",["T_VARIABLE","$key",540],",",["T_WHITESPACE"," ",540],["T_CONSTANT_ENCAPSED_STRING","'openid_sreg_'",540],")",["T_WHITESPACE"," ",540],["T_IS_IDENTICAL","===",540],["T_WHITESPACE"," ",540],["T_LNUMBER","0",540],")",["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n                    ",540],["T_VARIABLE","$key",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_CONSTANT_ENCAPSED_STRING","'openid.sreg.'",541],["T_WHITESPACE"," ",541],".",["T_WHITESPACE"," ",541],["T_STRING","substr",541],"(",["T_VARIABLE","$key",541],",",["T_WHITESPACE"," ",541],["T_STRING","strlen",541],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_sreg_'",541],")",")",";",["T_WHITESPACE","\n                ",541],"}",["T_WHITESPACE"," ",542],["T_ELSE","else",542],["T_WHITESPACE"," ",542],["T_IF","if",542],["T_WHITESPACE"," ",542],"(",["T_STRING","strpos",542],"(",["T_VARIABLE","$key",542],",",["T_WHITESPACE"," ",542],["T_CONSTANT_ENCAPSED_STRING","'openid_'",542],")",["T_WHITESPACE"," ",542],["T_IS_IDENTICAL","===",542],["T_WHITESPACE"," ",542],["T_LNUMBER","0",542],")",["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n                    ",542],["T_VARIABLE","$key",543],["T_WHITESPACE"," ",543],"=",["T_WHITESPACE"," ",543],["T_CONSTANT_ENCAPSED_STRING","'openid.'",543],["T_WHITESPACE"," ",543],".",["T_WHITESPACE"," ",543],["T_STRING","substr",543],"(",["T_VARIABLE","$key",543],",",["T_WHITESPACE"," ",543],["T_STRING","strlen",543],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_'",543],")",")",";",["T_WHITESPACE","\n                ",543],"}",["T_WHITESPACE","\n                ",544],["T_VARIABLE","$params2",545],"[",["T_VARIABLE","$key",545],"]",["T_WHITESPACE"," ",545],"=",["T_WHITESPACE"," ",545],["T_VARIABLE","$val",545],";",["T_WHITESPACE","\n            ",545],"}",["T_WHITESPACE","\n            ",546],["T_IF","if",547],["T_WHITESPACE"," ",547],"(",["T_VARIABLE","$immediate",547],")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n                ",547],["T_VARIABLE","$params2",548],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",548],"]",["T_WHITESPACE"," ",548],"=",["T_WHITESPACE"," ",548],["T_CONSTANT_ENCAPSED_STRING","'checkid_setup'",548],";",["T_WHITESPACE","\n                ",548],["T_VARIABLE","$ret",549],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",549],"]",["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],"(",["T_VARIABLE","$version",549],["T_WHITESPACE"," ",549],["T_IS_GREATER_OR_EQUAL",">=",549],["T_WHITESPACE"," ",549],["T_DNUMBER","2.0",549],")",["T_WHITESPACE"," ",549],"?",["T_WHITESPACE"," ",549],["T_CONSTANT_ENCAPSED_STRING","'setup_needed'",549],":",["T_WHITESPACE"," ",549],["T_CONSTANT_ENCAPSED_STRING","'id_res'",549],";",["T_WHITESPACE","\n                ",549],["T_VARIABLE","$ret",550],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.user_setup_url'",550],"]",["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","_loginUrl",550],["T_WHITESPACE","\n                    ",550],".",["T_WHITESPACE"," ",551],"(",["T_STRING","strpos",551],"(",["T_VARIABLE","$this",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","_loginUrl",551],",",["T_WHITESPACE"," ",551],["T_CONSTANT_ENCAPSED_STRING","'?'",551],")",["T_WHITESPACE"," ",551],["T_IS_IDENTICAL","===",551],["T_WHITESPACE"," ",551],["T_STRING","false",551],["T_WHITESPACE"," ",551],"?",["T_WHITESPACE"," ",551],["T_CONSTANT_ENCAPSED_STRING","'?'",551],["T_WHITESPACE"," ",551],":",["T_WHITESPACE"," ",551],["T_CONSTANT_ENCAPSED_STRING","'&'",551],")",["T_WHITESPACE","\n                    ",551],".",["T_WHITESPACE"," ",552],["T_STRING","Zend_OpenId",552],["T_DOUBLE_COLON","::",552],["T_STRING","paramsToQuery",552],"(",["T_VARIABLE","$params2",552],")",";",["T_WHITESPACE","\n                ",552],["T_RETURN","return",553],["T_WHITESPACE"," ",553],["T_VARIABLE","$ret",553],";",["T_WHITESPACE","\n            ",553],"}",["T_WHITESPACE"," ",554],["T_ELSE","else",554],["T_WHITESPACE"," ",554],"{",["T_WHITESPACE","\n                ",554],["T_COMMENT","\/* Redirect to Server Login Screen *\/",555],["T_WHITESPACE","\n                ",555],["T_STRING","Zend_OpenId",556],["T_DOUBLE_COLON","::",556],["T_STRING","redirect",556],"(",["T_VARIABLE","$this",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","_loginUrl",556],",",["T_WHITESPACE"," ",556],["T_VARIABLE","$params2",556],",",["T_WHITESPACE"," ",556],["T_VARIABLE","$response",556],")",";",["T_WHITESPACE","\n                ",556],["T_RETURN","return",557],["T_WHITESPACE"," ",557],["T_STRING","true",557],";",["T_WHITESPACE","\n            ",557],"}",["T_WHITESPACE","\n        ",558],"}",["T_WHITESPACE","\n\n        ",559],["T_IF","if",561],["T_WHITESPACE"," ",561],"(","!",["T_STRING","Zend_OpenId_Extension",561],["T_DOUBLE_COLON","::",561],["T_STRING","forAll",561],"(",["T_VARIABLE","$extensions",561],",",["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","'parseRequest'",561],",",["T_WHITESPACE"," ",561],["T_VARIABLE","$params",561],")",")",["T_WHITESPACE"," ",561],"{",["T_WHITESPACE","\n            ",561],["T_VARIABLE","$ret",562],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",562],"]",["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],"(",["T_VARIABLE","$immediate",562],["T_WHITESPACE"," ",562],["T_BOOLEAN_AND","&&",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$version",562],["T_WHITESPACE"," ",562],["T_IS_GREATER_OR_EQUAL",">=",562],["T_WHITESPACE"," ",562],["T_DNUMBER","2.0",562],")",["T_WHITESPACE"," ",562],"?",["T_WHITESPACE"," ",562],["T_CONSTANT_ENCAPSED_STRING","'setup_needed'",562],":",["T_WHITESPACE"," ",562],["T_CONSTANT_ENCAPSED_STRING","'cancel'",562],";",["T_WHITESPACE","\n            ",562],["T_RETURN","return",563],["T_WHITESPACE"," ",563],["T_VARIABLE","$ret",563],";",["T_WHITESPACE","\n        ",563],"}",["T_WHITESPACE","\n\n        ",564],["T_COMMENT","\/* Check if user trusts to the consumer *\/",566],["T_WHITESPACE","\n        ",566],["T_VARIABLE","$trusted",567],["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_STRING","null",567],";",["T_WHITESPACE","\n        ",567],["T_VARIABLE","$sites",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","_storage",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","getTrustedSites",568],"(",["T_VARIABLE","$params",568],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",568],"]",")",";",["T_WHITESPACE","\n        ",568],["T_IF","if",569],["T_WHITESPACE"," ",569],"(",["T_ISSET","isset",569],"(",["T_VARIABLE","$params",569],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",569],"]",")",")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$root",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_VARIABLE","$params",570],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",570],"]",";",["T_WHITESPACE","\n        ",570],"}",["T_WHITESPACE","\n        ",571],["T_IF","if",572],["T_WHITESPACE"," ",572],"(",["T_ISSET","isset",572],"(",["T_VARIABLE","$sites",572],"[",["T_VARIABLE","$root",572],"]",")",")",["T_WHITESPACE"," ",572],"{",["T_WHITESPACE","\n            ",572],["T_VARIABLE","$trusted",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_VARIABLE","$sites",573],"[",["T_VARIABLE","$root",573],"]",";",["T_WHITESPACE","\n        ",573],"}",["T_WHITESPACE"," ",574],["T_ELSE","else",574],["T_WHITESPACE"," ",574],"{",["T_WHITESPACE","\n            ",574],["T_FOREACH","foreach",575],["T_WHITESPACE"," ",575],"(",["T_VARIABLE","$sites",575],["T_WHITESPACE"," ",575],["T_AS","as",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$site",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$t",575],")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n                ",575],["T_IF","if",576],["T_WHITESPACE"," ",576],"(",["T_STRING","strpos",576],"(",["T_VARIABLE","$root",576],",",["T_WHITESPACE"," ",576],["T_VARIABLE","$site",576],")",["T_WHITESPACE"," ",576],["T_IS_IDENTICAL","===",576],["T_WHITESPACE"," ",576],["T_LNUMBER","0",576],")",["T_WHITESPACE"," ",576],"{",["T_WHITESPACE","\n                    ",576],["T_VARIABLE","$trusted",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_VARIABLE","$t",577],";",["T_WHITESPACE","\n                    ",577],["T_BREAK","break",578],";",["T_WHITESPACE","\n                ",578],"}",["T_WHITESPACE"," ",579],["T_ELSE","else",579],["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n                    ",579],["T_COMMENT","\/* OpenID 2.0 (9.2) check for realm wild-card matching *\/",580],["T_WHITESPACE","\n                    ",580],["T_VARIABLE","$n",581],["T_WHITESPACE"," ",581],"=",["T_WHITESPACE"," ",581],["T_STRING","strpos",581],"(",["T_VARIABLE","$site",581],",",["T_WHITESPACE"," ",581],["T_CONSTANT_ENCAPSED_STRING","':\/\/*.'",581],")",";",["T_WHITESPACE","\n                    ",581],["T_IF","if",582],["T_WHITESPACE"," ",582],"(",["T_VARIABLE","$n",582],["T_WHITESPACE"," ",582],["T_IS_NOT_EQUAL","!=",582],["T_WHITESPACE"," ",582],["T_STRING","false",582],")",["T_WHITESPACE"," ",582],"{",["T_WHITESPACE","\n                        ",582],["T_VARIABLE","$regex",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],["T_CONSTANT_ENCAPSED_STRING","'\/^'",583],["T_WHITESPACE","\n                               ",583],".",["T_WHITESPACE"," ",584],["T_STRING","preg_quote",584],"(",["T_STRING","substr",584],"(",["T_VARIABLE","$site",584],",",["T_WHITESPACE"," ",584],["T_LNUMBER","0",584],",",["T_WHITESPACE"," ",584],["T_VARIABLE","$n",584],"+",["T_LNUMBER","3",584],")",",",["T_WHITESPACE"," ",584],["T_CONSTANT_ENCAPSED_STRING","'\/'",584],")",["T_WHITESPACE","\n                               ",584],".",["T_WHITESPACE"," ",585],["T_CONSTANT_ENCAPSED_STRING","'[A-Za-z1-9_\\.]+?'",585],["T_WHITESPACE","\n                               ",585],".",["T_WHITESPACE"," ",586],["T_STRING","preg_quote",586],"(",["T_STRING","substr",586],"(",["T_VARIABLE","$site",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$n",586],"+",["T_LNUMBER","4",586],")",",",["T_WHITESPACE"," ",586],["T_CONSTANT_ENCAPSED_STRING","'\/'",586],")",["T_WHITESPACE","\n                               ",586],".",["T_WHITESPACE"," ",587],["T_CONSTANT_ENCAPSED_STRING","'\/'",587],";",["T_WHITESPACE","\n                        ",587],["T_IF","if",588],["T_WHITESPACE"," ",588],"(",["T_STRING","preg_match",588],"(",["T_VARIABLE","$regex",588],",",["T_WHITESPACE"," ",588],["T_VARIABLE","$root",588],")",")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n                            ",588],["T_VARIABLE","$trusted",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_VARIABLE","$t",589],";",["T_WHITESPACE","\n                            ",589],["T_BREAK","break",590],";",["T_WHITESPACE","\n                        ",590],"}",["T_WHITESPACE","\n                    ",591],"}",["T_WHITESPACE","\n                ",592],"}",["T_WHITESPACE","\n            ",593],"}",["T_WHITESPACE","\n        ",594],"}",["T_WHITESPACE","\n\n        ",595],["T_IF","if",597],["T_WHITESPACE"," ",597],"(",["T_STRING","is_array",597],"(",["T_VARIABLE","$trusted",597],")",")",["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n            ",597],["T_IF","if",598],["T_WHITESPACE"," ",598],"(","!",["T_STRING","Zend_OpenId_Extension",598],["T_DOUBLE_COLON","::",598],["T_STRING","forAll",598],"(",["T_VARIABLE","$extensions",598],",",["T_WHITESPACE"," ",598],["T_CONSTANT_ENCAPSED_STRING","'checkTrustData'",598],",",["T_WHITESPACE"," ",598],["T_VARIABLE","$trusted",598],")",")",["T_WHITESPACE"," ",598],"{",["T_WHITESPACE","\n                ",598],["T_VARIABLE","$trusted",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_STRING","null",599],";",["T_WHITESPACE","\n            ",599],"}",["T_WHITESPACE","\n        ",600],"}",["T_WHITESPACE","\n\n        ",601],["T_IF","if",603],["T_WHITESPACE"," ",603],"(",["T_VARIABLE","$trusted",603],["T_WHITESPACE"," ",603],["T_IS_IDENTICAL","===",603],["T_WHITESPACE"," ",603],["T_STRING","false",603],")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n            ",603],["T_VARIABLE","$ret",604],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",604],"]",["T_WHITESPACE"," ",604],"=",["T_WHITESPACE"," ",604],["T_CONSTANT_ENCAPSED_STRING","'cancel'",604],";",["T_WHITESPACE","\n            ",604],["T_RETURN","return",605],["T_WHITESPACE"," ",605],["T_VARIABLE","$ret",605],";",["T_WHITESPACE","\n        ",605],"}",["T_WHITESPACE"," ",606],["T_ELSE","else",606],["T_WHITESPACE"," ",606],["T_IF","if",606],["T_WHITESPACE"," ",606],"(",["T_VARIABLE","$trusted",606],["T_WHITESPACE"," ",606],["T_IS_IDENTICAL","===",606],["T_WHITESPACE"," ",606],["T_STRING","null",606],")",["T_WHITESPACE"," ",606],"{",["T_WHITESPACE","\n            ",606],["T_COMMENT","\/* Redirect to Server Trust Screen *\/",607],["T_WHITESPACE","\n            ",607],["T_VARIABLE","$params2",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_ARRAY","array",608],"(",")",";",["T_WHITESPACE","\n            ",608],["T_FOREACH","foreach",609],["T_WHITESPACE"," ",609],"(",["T_VARIABLE","$params",609],["T_WHITESPACE"," ",609],["T_AS","as",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$key",609],["T_WHITESPACE"," ",609],["T_DOUBLE_ARROW","=>",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$val",609],")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n                ",609],["T_IF","if",610],["T_WHITESPACE"," ",610],"(",["T_STRING","strpos",610],"(",["T_VARIABLE","$key",610],",",["T_WHITESPACE"," ",610],["T_CONSTANT_ENCAPSED_STRING","'openid_ns_'",610],")",["T_WHITESPACE"," ",610],["T_IS_IDENTICAL","===",610],["T_WHITESPACE"," ",610],["T_LNUMBER","0",610],")",["T_WHITESPACE"," ",610],"{",["T_WHITESPACE","\n                    ",610],["T_VARIABLE","$key",611],["T_WHITESPACE"," ",611],"=",["T_WHITESPACE"," ",611],["T_CONSTANT_ENCAPSED_STRING","'openid.ns.'",611],["T_WHITESPACE"," ",611],".",["T_WHITESPACE"," ",611],["T_STRING","substr",611],"(",["T_VARIABLE","$key",611],",",["T_WHITESPACE"," ",611],["T_STRING","strlen",611],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_ns_'",611],")",")",";",["T_WHITESPACE","\n                ",611],"}",["T_WHITESPACE"," ",612],["T_ELSE","else",612],["T_WHITESPACE"," ",612],["T_IF","if",612],["T_WHITESPACE"," ",612],"(",["T_STRING","strpos",612],"(",["T_VARIABLE","$key",612],",",["T_WHITESPACE"," ",612],["T_CONSTANT_ENCAPSED_STRING","'openid_sreg_'",612],")",["T_WHITESPACE"," ",612],["T_IS_IDENTICAL","===",612],["T_WHITESPACE"," ",612],["T_LNUMBER","0",612],")",["T_WHITESPACE"," ",612],"{",["T_WHITESPACE","\n                    ",612],["T_VARIABLE","$key",613],["T_WHITESPACE"," ",613],"=",["T_WHITESPACE"," ",613],["T_CONSTANT_ENCAPSED_STRING","'openid.sreg.'",613],["T_WHITESPACE"," ",613],".",["T_WHITESPACE"," ",613],["T_STRING","substr",613],"(",["T_VARIABLE","$key",613],",",["T_WHITESPACE"," ",613],["T_STRING","strlen",613],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_sreg_'",613],")",")",";",["T_WHITESPACE","\n                ",613],"}",["T_WHITESPACE"," ",614],["T_ELSE","else",614],["T_WHITESPACE"," ",614],["T_IF","if",614],["T_WHITESPACE"," ",614],"(",["T_STRING","strpos",614],"(",["T_VARIABLE","$key",614],",",["T_WHITESPACE"," ",614],["T_CONSTANT_ENCAPSED_STRING","'openid_'",614],")",["T_WHITESPACE"," ",614],["T_IS_IDENTICAL","===",614],["T_WHITESPACE"," ",614],["T_LNUMBER","0",614],")",["T_WHITESPACE"," ",614],"{",["T_WHITESPACE","\n                    ",614],["T_VARIABLE","$key",615],["T_WHITESPACE"," ",615],"=",["T_WHITESPACE"," ",615],["T_CONSTANT_ENCAPSED_STRING","'openid.'",615],["T_WHITESPACE"," ",615],".",["T_WHITESPACE"," ",615],["T_STRING","substr",615],"(",["T_VARIABLE","$key",615],",",["T_WHITESPACE"," ",615],["T_STRING","strlen",615],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_'",615],")",")",";",["T_WHITESPACE","\n                ",615],"}",["T_WHITESPACE","\n                ",616],["T_VARIABLE","$params2",617],"[",["T_VARIABLE","$key",617],"]",["T_WHITESPACE"," ",617],"=",["T_WHITESPACE"," ",617],["T_VARIABLE","$val",617],";",["T_WHITESPACE","\n            ",617],"}",["T_WHITESPACE","\n            ",618],["T_IF","if",619],["T_WHITESPACE"," ",619],"(",["T_VARIABLE","$immediate",619],")",["T_WHITESPACE"," ",619],"{",["T_WHITESPACE","\n                ",619],["T_VARIABLE","$params2",620],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",620],"]",["T_WHITESPACE"," ",620],"=",["T_WHITESPACE"," ",620],["T_CONSTANT_ENCAPSED_STRING","'checkid_setup'",620],";",["T_WHITESPACE","\n                ",620],["T_VARIABLE","$ret",621],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",621],"]",["T_WHITESPACE"," ",621],"=",["T_WHITESPACE"," ",621],"(",["T_VARIABLE","$version",621],["T_WHITESPACE"," ",621],["T_IS_GREATER_OR_EQUAL",">=",621],["T_WHITESPACE"," ",621],["T_DNUMBER","2.0",621],")",["T_WHITESPACE"," ",621],"?",["T_WHITESPACE"," ",621],["T_CONSTANT_ENCAPSED_STRING","'setup_needed'",621],":",["T_WHITESPACE"," ",621],["T_CONSTANT_ENCAPSED_STRING","'id_res'",621],";",["T_WHITESPACE","\n                ",621],["T_VARIABLE","$ret",622],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.user_setup_url'",622],"]",["T_WHITESPACE"," ",622],"=",["T_WHITESPACE"," ",622],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","_trustUrl",622],["T_WHITESPACE","\n                    ",622],".",["T_WHITESPACE"," ",623],"(",["T_STRING","strpos",623],"(",["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","_trustUrl",623],",",["T_WHITESPACE"," ",623],["T_CONSTANT_ENCAPSED_STRING","'?'",623],")",["T_WHITESPACE"," ",623],["T_IS_IDENTICAL","===",623],["T_WHITESPACE"," ",623],["T_STRING","false",623],["T_WHITESPACE"," ",623],"?",["T_WHITESPACE"," ",623],["T_CONSTANT_ENCAPSED_STRING","'?'",623],["T_WHITESPACE"," ",623],":",["T_WHITESPACE"," ",623],["T_CONSTANT_ENCAPSED_STRING","'&'",623],")",["T_WHITESPACE","\n                    ",623],".",["T_WHITESPACE"," ",624],["T_STRING","Zend_OpenId",624],["T_DOUBLE_COLON","::",624],["T_STRING","paramsToQuery",624],"(",["T_VARIABLE","$params2",624],")",";",["T_WHITESPACE","\n                ",624],["T_RETURN","return",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$ret",625],";",["T_WHITESPACE","\n            ",625],"}",["T_WHITESPACE"," ",626],["T_ELSE","else",626],["T_WHITESPACE"," ",626],"{",["T_WHITESPACE","\n                ",626],["T_STRING","Zend_OpenId",627],["T_DOUBLE_COLON","::",627],["T_STRING","redirect",627],"(",["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","_trustUrl",627],",",["T_WHITESPACE"," ",627],["T_VARIABLE","$params2",627],",",["T_WHITESPACE"," ",627],["T_VARIABLE","$response",627],")",";",["T_WHITESPACE","\n                ",627],["T_RETURN","return",628],["T_WHITESPACE"," ",628],["T_STRING","true",628],";",["T_WHITESPACE","\n            ",628],"}",["T_WHITESPACE","\n        ",629],"}",["T_WHITESPACE","\n\n        ",630],["T_RETURN","return",632],["T_WHITESPACE"," ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","_respond",632],"(",["T_VARIABLE","$version",632],",",["T_WHITESPACE"," ",632],["T_VARIABLE","$ret",632],",",["T_WHITESPACE"," ",632],["T_VARIABLE","$params",632],",",["T_WHITESPACE"," ",632],["T_VARIABLE","$extensions",632],")",";",["T_WHITESPACE","\n    ",632],"}",["T_WHITESPACE","\n\n    ",633],["T_DOC_COMMENT","\/**\n     * Perepares information to send back to consumer's authentication request,\n     * signs it using shared secret and send back through HTTP redirection\n     *\n     * @param array $params GET or POST request variables\n     * @param mixed $extensions extension object or array of extensions objects\n     * @param Zend_Controller_Response_Abstract $response an optional response\n     *  object to perform HTTP or HTML form redirection\n     * @return bool\n     *\/",635],["T_WHITESPACE","\n    ",644],["T_PUBLIC","public",645],["T_WHITESPACE"," ",645],["T_FUNCTION","function",645],["T_WHITESPACE"," ",645],["T_STRING","respondToConsumer",645],"(",["T_VARIABLE","$params",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$extensions",645],"=",["T_STRING","null",645],",",["T_WHITESPACE","\n                           ",645],["T_STRING","Zend_Controller_Response_Abstract",646],["T_WHITESPACE"," ",646],["T_VARIABLE","$response",646],["T_WHITESPACE"," ",646],"=",["T_WHITESPACE"," ",646],["T_STRING","null",646],")",["T_WHITESPACE","\n    ",646],"{",["T_WHITESPACE","\n        ",647],["T_VARIABLE","$version",648],["T_WHITESPACE"," ",648],"=",["T_WHITESPACE"," ",648],["T_DNUMBER","1.1",648],";",["T_WHITESPACE","\n        ",648],["T_IF","if",649],["T_WHITESPACE"," ",649],"(",["T_ISSET","isset",649],"(",["T_VARIABLE","$params",649],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",649],"]",")",["T_WHITESPACE"," ",649],["T_BOOLEAN_AND","&&",649],["T_WHITESPACE","\n            ",649],["T_VARIABLE","$params",650],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",650],"]",["T_WHITESPACE"," ",650],["T_IS_EQUAL","==",650],["T_WHITESPACE"," ",650],["T_STRING","Zend_OpenId",650],["T_DOUBLE_COLON","::",650],["T_STRING","NS_2_0",650],")",["T_WHITESPACE"," ",650],"{",["T_WHITESPACE","\n            ",650],["T_VARIABLE","$version",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_DNUMBER","2.0",651],";",["T_WHITESPACE","\n        ",651],"}",["T_WHITESPACE","\n        ",652],["T_VARIABLE","$ret",653],["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_ARRAY","array",653],"(",")",";",["T_WHITESPACE","\n        ",653],["T_IF","if",654],["T_WHITESPACE"," ",654],"(",["T_VARIABLE","$version",654],["T_WHITESPACE"," ",654],["T_IS_GREATER_OR_EQUAL",">=",654],["T_WHITESPACE"," ",654],["T_DNUMBER","2.0",654],")",["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n            ",654],["T_VARIABLE","$ret",655],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.ns'",655],"]",["T_WHITESPACE"," ",655],"=",["T_WHITESPACE"," ",655],["T_STRING","Zend_OpenId",655],["T_DOUBLE_COLON","::",655],["T_STRING","NS_2_0",655],";",["T_WHITESPACE","\n        ",655],"}",["T_WHITESPACE","\n        ",656],["T_VARIABLE","$ret",657],["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],["T_VARIABLE","$this",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","_respond",657],"(",["T_VARIABLE","$version",657],",",["T_WHITESPACE"," ",657],["T_VARIABLE","$ret",657],",",["T_WHITESPACE"," ",657],["T_VARIABLE","$params",657],",",["T_WHITESPACE"," ",657],["T_VARIABLE","$extensions",657],")",";",["T_WHITESPACE","\n        ",657],["T_IF","if",658],["T_WHITESPACE"," ",658],"(","!",["T_EMPTY","empty",658],"(",["T_VARIABLE","$params",658],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",658],"]",")",")",["T_WHITESPACE"," ",658],"{",["T_WHITESPACE","\n            ",658],["T_STRING","Zend_OpenId",659],["T_DOUBLE_COLON","::",659],["T_STRING","redirect",659],"(",["T_VARIABLE","$params",659],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",659],"]",",",["T_WHITESPACE"," ",659],["T_VARIABLE","$ret",659],",",["T_WHITESPACE"," ",659],["T_VARIABLE","$response",659],")",";",["T_WHITESPACE","\n        ",659],"}",["T_WHITESPACE","\n        ",660],["T_RETURN","return",661],["T_WHITESPACE"," ",661],["T_STRING","true",661],";",["T_WHITESPACE","\n    ",661],"}",["T_WHITESPACE","\n\n    ",662],["T_DOC_COMMENT","\/**\n     * Perepares information to send back to consumer's authentication request\n     * and signs it using shared secret.\n     *\n     * @param float $version OpenID protcol version\n     * @param array $ret arguments to be send back to consumer\n     * @param array $params GET or POST request variables\n     * @param mixed $extensions extension object or array of extensions objects\n     * @return array\n     *\/",664],["T_WHITESPACE","\n    ",673],["T_PROTECTED","protected",674],["T_WHITESPACE"," ",674],["T_FUNCTION","function",674],["T_WHITESPACE"," ",674],["T_STRING","_respond",674],"(",["T_VARIABLE","$version",674],",",["T_WHITESPACE"," ",674],["T_VARIABLE","$ret",674],",",["T_WHITESPACE"," ",674],["T_VARIABLE","$params",674],",",["T_WHITESPACE"," ",674],["T_VARIABLE","$extensions",674],"=",["T_STRING","null",674],")",["T_WHITESPACE","\n    ",674],"{",["T_WHITESPACE","\n        ",675],["T_IF","if",676],["T_WHITESPACE"," ",676],"(",["T_EMPTY","empty",676],"(",["T_VARIABLE","$params",676],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",676],"]",")",["T_WHITESPACE"," ",676],["T_BOOLEAN_OR","||",676],["T_WHITESPACE","\n            ",676],"!",["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","_storage",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","getAssociation",677],"(",["T_VARIABLE","$params",677],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",677],"]",",",["T_WHITESPACE","\n                ",677],["T_VARIABLE","$macFunc",678],",",["T_WHITESPACE"," ",678],["T_VARIABLE","$secret",678],",",["T_WHITESPACE"," ",678],["T_VARIABLE","$expires",678],")",")",["T_WHITESPACE"," ",678],"{",["T_WHITESPACE","\n            ",678],["T_COMMENT","\/* Use dumb mode *\/",679],["T_WHITESPACE","\n            ",679],["T_IF","if",680],["T_WHITESPACE"," ",680],"(","!",["T_EMPTY","empty",680],"(",["T_VARIABLE","$params",680],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",680],"]",")",")",["T_WHITESPACE"," ",680],"{",["T_WHITESPACE","\n                ",680],["T_VARIABLE","$ret",681],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.invalidate_handle'",681],"]",["T_WHITESPACE"," ",681],"=",["T_WHITESPACE"," ",681],["T_VARIABLE","$params",681],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",681],"]",";",["T_WHITESPACE","\n            ",681],"}",["T_WHITESPACE","\n            ",682],["T_VARIABLE","$macFunc",683],["T_WHITESPACE"," ",683],"=",["T_WHITESPACE"," ",683],["T_VARIABLE","$version",683],["T_WHITESPACE"," ",683],["T_IS_GREATER_OR_EQUAL",">=",683],["T_WHITESPACE"," ",683],["T_DNUMBER","2.0",683],["T_WHITESPACE"," ",683],"?",["T_WHITESPACE"," ",683],["T_CONSTANT_ENCAPSED_STRING","'sha256'",683],["T_WHITESPACE"," ",683],":",["T_WHITESPACE"," ",683],["T_CONSTANT_ENCAPSED_STRING","'sha1'",683],";",["T_WHITESPACE","\n            ",683],["T_VARIABLE","$secret",684],["T_WHITESPACE"," ",684],"=",["T_WHITESPACE"," ",684],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","_genSecret",684],"(",["T_VARIABLE","$macFunc",684],")",";",["T_WHITESPACE","\n            ",684],["T_VARIABLE","$handle",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_STRING","uniqid",685],"(",")",";",["T_WHITESPACE","\n            ",685],["T_VARIABLE","$expiresIn",686],["T_WHITESPACE"," ",686],"=",["T_WHITESPACE"," ",686],["T_VARIABLE","$this",686],["T_OBJECT_OPERATOR","->",686],["T_STRING","_sessionTtl",686],";",["T_WHITESPACE","\n            ",686],["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","_storage",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","addAssociation",687],"(",["T_VARIABLE","$handle",687],",",["T_WHITESPACE","\n                ",687],["T_VARIABLE","$macFunc",688],",",["T_WHITESPACE"," ",688],["T_VARIABLE","$secret",688],",",["T_WHITESPACE"," ",688],["T_STRING","time",688],"(",")",["T_WHITESPACE"," ",688],"+",["T_WHITESPACE"," ",688],["T_VARIABLE","$expiresIn",688],")",";",["T_WHITESPACE","\n            ",688],["T_VARIABLE","$ret",689],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_handle'",689],"]",["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_VARIABLE","$handle",689],";",["T_WHITESPACE","\n        ",689],"}",["T_WHITESPACE"," ",690],["T_ELSE","else",690],["T_WHITESPACE"," ",690],"{",["T_WHITESPACE","\n            ",690],["T_VARIABLE","$ret",691],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_handle'",691],"]",["T_WHITESPACE"," ",691],"=",["T_WHITESPACE"," ",691],["T_VARIABLE","$params",691],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",691],"]",";",["T_WHITESPACE","\n        ",691],"}",["T_WHITESPACE","\n        ",692],["T_IF","if",693],["T_WHITESPACE"," ",693],"(",["T_ISSET","isset",693],"(",["T_VARIABLE","$params",693],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",693],"]",")",")",["T_WHITESPACE"," ",693],"{",["T_WHITESPACE","\n            ",693],["T_VARIABLE","$ret",694],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.return_to'",694],"]",["T_WHITESPACE"," ",694],"=",["T_WHITESPACE"," ",694],["T_VARIABLE","$params",694],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",694],"]",";",["T_WHITESPACE","\n        ",694],"}",["T_WHITESPACE","\n        ",695],["T_IF","if",696],["T_WHITESPACE"," ",696],"(",["T_ISSET","isset",696],"(",["T_VARIABLE","$params",696],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",696],"]",")",")",["T_WHITESPACE"," ",696],"{",["T_WHITESPACE","\n            ",696],["T_VARIABLE","$ret",697],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.claimed_id'",697],"]",["T_WHITESPACE"," ",697],"=",["T_WHITESPACE"," ",697],["T_VARIABLE","$params",697],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",697],"]",";",["T_WHITESPACE","\n        ",697],"}",["T_WHITESPACE","\n        ",698],["T_IF","if",699],["T_WHITESPACE"," ",699],"(",["T_ISSET","isset",699],"(",["T_VARIABLE","$params",699],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",699],"]",")",")",["T_WHITESPACE"," ",699],"{",["T_WHITESPACE","\n            ",699],["T_VARIABLE","$ret",700],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.identity'",700],"]",["T_WHITESPACE"," ",700],"=",["T_WHITESPACE"," ",700],["T_VARIABLE","$params",700],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",700],"]",";",["T_WHITESPACE","\n        ",700],"}",["T_WHITESPACE","\n\n        ",701],["T_IF","if",703],["T_WHITESPACE"," ",703],"(",["T_VARIABLE","$version",703],["T_WHITESPACE"," ",703],["T_IS_GREATER_OR_EQUAL",">=",703],["T_WHITESPACE"," ",703],["T_DNUMBER","2.0",703],")",["T_WHITESPACE"," ",703],"{",["T_WHITESPACE","\n            ",703],["T_IF","if",704],["T_WHITESPACE"," ",704],"(","!",["T_EMPTY","empty",704],"(",["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","_opEndpoint",704],")",")",["T_WHITESPACE"," ",704],"{",["T_WHITESPACE","\n                ",704],["T_VARIABLE","$ret",705],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.op_endpoint'",705],"]",["T_WHITESPACE"," ",705],"=",["T_WHITESPACE"," ",705],["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","_opEndpoint",705],";",["T_WHITESPACE","\n            ",705],"}",["T_WHITESPACE"," ",706],["T_ELSE","else",706],["T_WHITESPACE"," ",706],"{",["T_WHITESPACE","\n                ",706],["T_VARIABLE","$ret",707],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.op_endpoint'",707],"]",["T_WHITESPACE"," ",707],"=",["T_WHITESPACE"," ",707],["T_STRING","Zend_OpenId",707],["T_DOUBLE_COLON","::",707],["T_STRING","selfUrl",707],"(",")",";",["T_WHITESPACE","\n            ",707],"}",["T_WHITESPACE","\n        ",708],"}",["T_WHITESPACE","\n        ",709],["T_VARIABLE","$ret",710],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.response_nonce'",710],"]",["T_WHITESPACE"," ",710],"=",["T_WHITESPACE"," ",710],["T_STRING","gmdate",710],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d\\TH:i:s\\Z'",710],")",["T_WHITESPACE"," ",710],".",["T_WHITESPACE"," ",710],["T_STRING","uniqid",710],"(",")",";",["T_WHITESPACE","\n        ",710],["T_VARIABLE","$ret",711],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",711],"]",["T_WHITESPACE"," ",711],"=",["T_WHITESPACE"," ",711],["T_CONSTANT_ENCAPSED_STRING","'id_res'",711],";",["T_WHITESPACE","\n\n        ",711],["T_STRING","Zend_OpenId_Extension",713],["T_DOUBLE_COLON","::",713],["T_STRING","forAll",713],"(",["T_VARIABLE","$extensions",713],",",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'prepareResponse'",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$ret",713],")",";",["T_WHITESPACE","\n\n        ",713],["T_VARIABLE","$signed",715],["T_WHITESPACE"," ",715],"=",["T_WHITESPACE"," ",715],["T_CONSTANT_ENCAPSED_STRING","''",715],";",["T_WHITESPACE","\n        ",715],["T_VARIABLE","$data",716],["T_WHITESPACE"," ",716],"=",["T_WHITESPACE"," ",716],["T_CONSTANT_ENCAPSED_STRING","''",716],";",["T_WHITESPACE","\n        ",716],["T_FOREACH","foreach",717],["T_WHITESPACE"," ",717],"(",["T_VARIABLE","$ret",717],["T_WHITESPACE"," ",717],["T_AS","as",717],["T_WHITESPACE"," ",717],["T_VARIABLE","$key",717],["T_WHITESPACE"," ",717],["T_DOUBLE_ARROW","=>",717],["T_WHITESPACE"," ",717],["T_VARIABLE","$val",717],")",["T_WHITESPACE"," ",717],"{",["T_WHITESPACE","\n            ",717],["T_IF","if",718],["T_WHITESPACE"," ",718],"(",["T_STRING","strpos",718],"(",["T_VARIABLE","$key",718],",",["T_WHITESPACE"," ",718],["T_CONSTANT_ENCAPSED_STRING","'openid.'",718],")",["T_WHITESPACE"," ",718],["T_IS_IDENTICAL","===",718],["T_WHITESPACE"," ",718],["T_LNUMBER","0",718],")",["T_WHITESPACE"," ",718],"{",["T_WHITESPACE","\n                ",718],["T_VARIABLE","$key",719],["T_WHITESPACE"," ",719],"=",["T_WHITESPACE"," ",719],["T_STRING","substr",719],"(",["T_VARIABLE","$key",719],",",["T_WHITESPACE"," ",719],["T_STRING","strlen",719],"(",["T_CONSTANT_ENCAPSED_STRING","'openid.'",719],")",")",";",["T_WHITESPACE","\n                ",719],["T_IF","if",720],["T_WHITESPACE"," ",720],"(","!",["T_EMPTY","empty",720],"(",["T_VARIABLE","$signed",720],")",")",["T_WHITESPACE"," ",720],"{",["T_WHITESPACE","\n                    ",720],["T_VARIABLE","$signed",721],["T_WHITESPACE"," ",721],["T_CONCAT_EQUAL",".=",721],["T_WHITESPACE"," ",721],["T_CONSTANT_ENCAPSED_STRING","','",721],";",["T_WHITESPACE","\n                ",721],"}",["T_WHITESPACE","\n                ",722],["T_VARIABLE","$signed",723],["T_WHITESPACE"," ",723],["T_CONCAT_EQUAL",".=",723],["T_WHITESPACE"," ",723],["T_VARIABLE","$key",723],";",["T_WHITESPACE","\n                ",723],["T_VARIABLE","$data",724],["T_WHITESPACE"," ",724],["T_CONCAT_EQUAL",".=",724],["T_WHITESPACE"," ",724],["T_VARIABLE","$key",724],["T_WHITESPACE"," ",724],".",["T_WHITESPACE"," ",724],["T_CONSTANT_ENCAPSED_STRING","':'",724],["T_WHITESPACE"," ",724],".",["T_WHITESPACE"," ",724],["T_VARIABLE","$val",724],["T_WHITESPACE"," ",724],".",["T_WHITESPACE"," ",724],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",724],";",["T_WHITESPACE","\n            ",724],"}",["T_WHITESPACE","\n        ",725],"}",["T_WHITESPACE","\n        ",726],["T_VARIABLE","$signed",727],["T_WHITESPACE"," ",727],["T_CONCAT_EQUAL",".=",727],["T_WHITESPACE"," ",727],["T_CONSTANT_ENCAPSED_STRING","',signed'",727],";",["T_WHITESPACE","\n        ",727],["T_VARIABLE","$data",728],["T_WHITESPACE"," ",728],["T_CONCAT_EQUAL",".=",728],["T_WHITESPACE"," ",728],["T_CONSTANT_ENCAPSED_STRING","'signed:'",728],["T_WHITESPACE"," ",728],".",["T_WHITESPACE"," ",728],["T_VARIABLE","$signed",728],["T_WHITESPACE"," ",728],".",["T_WHITESPACE"," ",728],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",728],";",["T_WHITESPACE","\n        ",728],["T_VARIABLE","$ret",729],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.signed'",729],"]",["T_WHITESPACE"," ",729],"=",["T_WHITESPACE"," ",729],["T_VARIABLE","$signed",729],";",["T_WHITESPACE","\n\n        ",729],["T_VARIABLE","$ret",731],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.sig'",731],"]",["T_WHITESPACE"," ",731],"=",["T_WHITESPACE"," ",731],["T_STRING","base64_encode",731],"(",["T_WHITESPACE","\n            ",731],["T_STRING","Zend_OpenId",732],["T_DOUBLE_COLON","::",732],["T_STRING","hashHmac",732],"(",["T_VARIABLE","$macFunc",732],",",["T_WHITESPACE"," ",732],["T_VARIABLE","$data",732],",",["T_WHITESPACE"," ",732],["T_VARIABLE","$secret",732],")",")",";",["T_WHITESPACE","\n\n        ",732],["T_RETURN","return",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$ret",734],";",["T_WHITESPACE","\n    ",734],"}",["T_WHITESPACE","\n\n    ",735],["T_DOC_COMMENT","\/**\n     * Performs authentication validation for dumb consumers\n     * Returns array of variables to push back to consumer.\n     * It MUST contain 'is_valid' variable with value 'true' or 'false'.\n     *\n     * @param float $version OpenID version\n     * @param array $params GET or POST request variables\n     * @return array\n     *\/",737],["T_WHITESPACE","\n    ",745],["T_PROTECTED","protected",746],["T_WHITESPACE"," ",746],["T_FUNCTION","function",746],["T_WHITESPACE"," ",746],["T_STRING","_checkAuthentication",746],"(",["T_VARIABLE","$version",746],",",["T_WHITESPACE"," ",746],["T_VARIABLE","$params",746],")",["T_WHITESPACE","\n    ",746],"{",["T_WHITESPACE","\n        ",747],["T_VARIABLE","$ret",748],["T_WHITESPACE"," ",748],"=",["T_WHITESPACE"," ",748],["T_ARRAY","array",748],"(",")",";",["T_WHITESPACE","\n        ",748],["T_IF","if",749],["T_WHITESPACE"," ",749],"(",["T_VARIABLE","$version",749],["T_WHITESPACE"," ",749],["T_IS_GREATER_OR_EQUAL",">=",749],["T_WHITESPACE"," ",749],["T_DNUMBER","2.0",749],")",["T_WHITESPACE"," ",749],"{",["T_WHITESPACE","\n            ",749],["T_VARIABLE","$ret",750],"[",["T_CONSTANT_ENCAPSED_STRING","'ns'",750],"]",["T_WHITESPACE"," ",750],"=",["T_WHITESPACE"," ",750],["T_STRING","Zend_OpenId",750],["T_DOUBLE_COLON","::",750],["T_STRING","NS_2_0",750],";",["T_WHITESPACE","\n        ",750],"}",["T_WHITESPACE","\n        ",751],["T_VARIABLE","$ret",752],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",752],"]",["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_CONSTANT_ENCAPSED_STRING","'id_res'",752],";",["T_WHITESPACE","\n\n        ",752],["T_IF","if",754],["T_WHITESPACE"," ",754],"(",["T_EMPTY","empty",754],"(",["T_VARIABLE","$params",754],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",754],"]",")",["T_WHITESPACE"," ",754],["T_BOOLEAN_OR","||",754],["T_WHITESPACE","\n            ",754],["T_EMPTY","empty",755],"(",["T_VARIABLE","$params",755],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_signed'",755],"]",")",["T_WHITESPACE"," ",755],["T_BOOLEAN_OR","||",755],["T_WHITESPACE","\n            ",755],["T_EMPTY","empty",756],"(",["T_VARIABLE","$params",756],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_sig'",756],"]",")",["T_WHITESPACE"," ",756],["T_BOOLEAN_OR","||",756],["T_WHITESPACE","\n            ",756],"!",["T_VARIABLE","$this",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","_storage",757],["T_OBJECT_OPERATOR","->",757],["T_STRING","getAssociation",757],"(",["T_VARIABLE","$params",757],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",757],"]",",",["T_WHITESPACE","\n                ",757],["T_VARIABLE","$macFunc",758],",",["T_WHITESPACE"," ",758],["T_VARIABLE","$secret",758],",",["T_WHITESPACE"," ",758],["T_VARIABLE","$expires",758],")",")",["T_WHITESPACE"," ",758],"{",["T_WHITESPACE","\n            ",758],["T_VARIABLE","$ret",759],"[",["T_CONSTANT_ENCAPSED_STRING","'is_valid'",759],"]",["T_WHITESPACE"," ",759],"=",["T_WHITESPACE"," ",759],["T_CONSTANT_ENCAPSED_STRING","'false'",759],";",["T_WHITESPACE","\n            ",759],["T_RETURN","return",760],["T_WHITESPACE"," ",760],["T_VARIABLE","$ret",760],";",["T_WHITESPACE","\n        ",760],"}",["T_WHITESPACE","\n\n        ",761],["T_VARIABLE","$signed",763],["T_WHITESPACE"," ",763],"=",["T_WHITESPACE"," ",763],["T_STRING","explode",763],"(",["T_CONSTANT_ENCAPSED_STRING","','",763],",",["T_WHITESPACE"," ",763],["T_VARIABLE","$params",763],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_signed'",763],"]",")",";",["T_WHITESPACE","\n        ",763],["T_VARIABLE","$data",764],["T_WHITESPACE"," ",764],"=",["T_WHITESPACE"," ",764],["T_CONSTANT_ENCAPSED_STRING","''",764],";",["T_WHITESPACE","\n        ",764],["T_FOREACH","foreach",765],["T_WHITESPACE"," ",765],"(",["T_VARIABLE","$signed",765],["T_WHITESPACE"," ",765],["T_AS","as",765],["T_WHITESPACE"," ",765],["T_VARIABLE","$key",765],")",["T_WHITESPACE"," ",765],"{",["T_WHITESPACE","\n            ",765],["T_VARIABLE","$data",766],["T_WHITESPACE"," ",766],["T_CONCAT_EQUAL",".=",766],["T_WHITESPACE"," ",766],["T_VARIABLE","$key",766],["T_WHITESPACE"," ",766],".",["T_WHITESPACE"," ",766],["T_CONSTANT_ENCAPSED_STRING","':'",766],";",["T_WHITESPACE","\n            ",766],["T_IF","if",767],["T_WHITESPACE"," ",767],"(",["T_VARIABLE","$key",767],["T_WHITESPACE"," ",767],["T_IS_EQUAL","==",767],["T_WHITESPACE"," ",767],["T_CONSTANT_ENCAPSED_STRING","'mode'",767],")",["T_WHITESPACE"," ",767],"{",["T_WHITESPACE","\n                ",767],["T_VARIABLE","$data",768],["T_WHITESPACE"," ",768],["T_CONCAT_EQUAL",".=",768],["T_WHITESPACE"," ",768],["T_CONSTANT_ENCAPSED_STRING","\"id_res\\n\"",768],";",["T_WHITESPACE","\n            ",768],"}",["T_WHITESPACE"," ",769],["T_ELSE","else",769],["T_WHITESPACE"," ",769],"{",["T_WHITESPACE","\n                ",769],["T_VARIABLE","$data",770],["T_WHITESPACE"," ",770],["T_CONCAT_EQUAL",".=",770],["T_WHITESPACE"," ",770],["T_VARIABLE","$params",770],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_'",770],["T_WHITESPACE"," ",770],".",["T_WHITESPACE"," ",770],["T_STRING","strtr",770],"(",["T_VARIABLE","$key",770],",",["T_CONSTANT_ENCAPSED_STRING","'.'",770],",",["T_CONSTANT_ENCAPSED_STRING","'_'",770],")","]",".",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",770],";",["T_WHITESPACE","\n            ",770],"}",["T_WHITESPACE","\n        ",771],"}",["T_WHITESPACE","\n        ",772],["T_IF","if",773],["T_WHITESPACE"," ",773],"(",["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","_secureStringCompare",773],"(",["T_STRING","base64_decode",773],"(",["T_VARIABLE","$params",773],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_sig'",773],"]",")",",",["T_WHITESPACE","\n            ",773],["T_STRING","Zend_OpenId",774],["T_DOUBLE_COLON","::",774],["T_STRING","hashHmac",774],"(",["T_VARIABLE","$macFunc",774],",",["T_WHITESPACE"," ",774],["T_VARIABLE","$data",774],",",["T_WHITESPACE"," ",774],["T_VARIABLE","$secret",774],")",")",")",["T_WHITESPACE"," ",774],"{",["T_WHITESPACE","\n            ",774],["T_VARIABLE","$ret",775],"[",["T_CONSTANT_ENCAPSED_STRING","'is_valid'",775],"]",["T_WHITESPACE"," ",775],"=",["T_WHITESPACE"," ",775],["T_CONSTANT_ENCAPSED_STRING","'true'",775],";",["T_WHITESPACE","\n        ",775],"}",["T_WHITESPACE"," ",776],["T_ELSE","else",776],["T_WHITESPACE"," ",776],"{",["T_WHITESPACE","\n            ",776],["T_VARIABLE","$ret",777],"[",["T_CONSTANT_ENCAPSED_STRING","'is_valid'",777],"]",["T_WHITESPACE"," ",777],"=",["T_WHITESPACE"," ",777],["T_CONSTANT_ENCAPSED_STRING","'false'",777],";",["T_WHITESPACE","\n        ",777],"}",["T_WHITESPACE","\n        ",778],["T_RETURN","return",779],["T_WHITESPACE"," ",779],["T_VARIABLE","$ret",779],";",["T_WHITESPACE","\n    ",779],"}",["T_WHITESPACE","\n\n    ",780],["T_DOC_COMMENT","\/**\n     * Securely compare two strings for equality while avoided C level memcmp()\n     * optimisations capable of leaking timing information useful to an attacker\n     * attempting to iteratively guess the unknown string (e.g. password) being\n     * compared against.\n     *\n     * @param string $a\n     * @param string $b\n     * @return bool\n     *\/",782],["T_WHITESPACE","\n    ",791],["T_PROTECTED","protected",792],["T_WHITESPACE"," ",792],["T_FUNCTION","function",792],["T_WHITESPACE"," ",792],["T_STRING","_secureStringCompare",792],"(",["T_VARIABLE","$a",792],",",["T_WHITESPACE"," ",792],["T_VARIABLE","$b",792],")",["T_WHITESPACE","\n    ",792],"{",["T_WHITESPACE","\n        ",793],["T_IF","if",794],["T_WHITESPACE"," ",794],"(",["T_STRING","strlen",794],"(",["T_VARIABLE","$a",794],")",["T_WHITESPACE"," ",794],["T_IS_NOT_IDENTICAL","!==",794],["T_WHITESPACE"," ",794],["T_STRING","strlen",794],"(",["T_VARIABLE","$b",794],")",")",["T_WHITESPACE"," ",794],"{",["T_WHITESPACE","\n            ",794],["T_RETURN","return",795],["T_WHITESPACE"," ",795],["T_STRING","false",795],";",["T_WHITESPACE","\n        ",795],"}",["T_WHITESPACE","\n        ",796],["T_VARIABLE","$result",797],["T_WHITESPACE"," ",797],"=",["T_WHITESPACE"," ",797],["T_LNUMBER","0",797],";",["T_WHITESPACE","\n        ",797],["T_FOR","for",798],["T_WHITESPACE"," ",798],"(",["T_VARIABLE","$i",798],["T_WHITESPACE"," ",798],"=",["T_WHITESPACE"," ",798],["T_LNUMBER","0",798],";",["T_WHITESPACE"," ",798],["T_VARIABLE","$i",798],["T_WHITESPACE"," ",798],"<",["T_WHITESPACE"," ",798],["T_STRING","strlen",798],"(",["T_VARIABLE","$a",798],")",";",["T_WHITESPACE"," ",798],["T_VARIABLE","$i",798],["T_INC","++",798],")",["T_WHITESPACE"," ",798],"{",["T_WHITESPACE","\n            ",798],["T_VARIABLE","$result",799],["T_WHITESPACE"," ",799],["T_OR_EQUAL","|=",799],["T_WHITESPACE"," ",799],["T_STRING","ord",799],"(",["T_VARIABLE","$a",799],"[",["T_VARIABLE","$i",799],"]",")",["T_WHITESPACE"," ",799],"^",["T_WHITESPACE"," ",799],["T_STRING","ord",799],"(",["T_VARIABLE","$b",799],"[",["T_VARIABLE","$i",799],"]",")",";",["T_WHITESPACE","\n        ",799],"}",["T_WHITESPACE","\n        ",800],["T_RETURN","return",801],["T_WHITESPACE"," ",801],["T_VARIABLE","$result",801],["T_WHITESPACE"," ",801],["T_IS_EQUAL","==",801],["T_WHITESPACE"," ",801],["T_LNUMBER","0",801],";",["T_WHITESPACE","\n    ",801],"}",["T_WHITESPACE","\n",802],"}",["T_WHITESPACE","\n",803]]