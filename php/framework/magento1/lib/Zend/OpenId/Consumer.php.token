[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Consumer\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id: Consumer.php 24593 2012-01-05 20:35:02Z matthew $\n *\/",3],["T_WHITESPACE","\n\n",22],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId\n *\/",24],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once \"Zend\/OpenId.php\";\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId_Extension\n *\/",29],["T_WHITESPACE","\n",31],["T_COMMENT","#require_once \"Zend\/OpenId\/Extension.php\";\n",32],["T_WHITESPACE","\n",33],["T_DOC_COMMENT","\/**\n * @see Zend_OpenId_Consumer_Storage\n *\/",34],["T_WHITESPACE","\n",36],["T_COMMENT","#require_once \"Zend\/OpenId\/Consumer\/Storage.php\";\n",37],["T_WHITESPACE","\n",38],["T_DOC_COMMENT","\/**\n * @see Zend_Http_Client\n *\/",39],["T_WHITESPACE","\n",41],["T_COMMENT","#require_once 'Zend\/Http\/Client.php';\n",42],["T_WHITESPACE","\n",43],["T_DOC_COMMENT","\/**\n * OpenID consumer implementation\n *\n * @category   Zend\n * @package    Zend_OpenId\n * @subpackage Zend_OpenId_Consumer\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",44],["T_WHITESPACE","\n",52],["T_CLASS","class",53],["T_WHITESPACE"," ",53],["T_STRING","Zend_OpenId_Consumer",53],["T_WHITESPACE","\n",53],"{",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Parameters required for signature\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_signParams",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_ARRAY","array",59],"(",["T_CONSTANT_ENCAPSED_STRING","'op_endpoint'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'return_to'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'response_nonce'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'assoc_handle'",59],")",";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Reference to an implementation of storage object\n     *\n     * @var Zend_OpenId_Consumer_Storage $_storage\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_storage",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","null",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Enables or disables consumer to use association with server based on\n     * Diffie-Hellman key agreement\n     *\n     * @var Zend_OpenId_Consumer_Storage $_dumbMode\n     *\/",68],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_dumbMode",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","false",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Internal cache to prevent unnecessary access to storage\n     *\n     * @var array $_cache\n     *\/",76],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$_cache",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",")",";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * HTTP client to make HTTP requests\n     *\n     * @var Zend_Http_Client $_httpClient\n     *\/",83],["T_WHITESPACE","\n    ",87],["T_PRIVATE","private",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$_httpClient",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","null",88],";",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * HTTP session to store climed_id between requests\n     *\n     * @var Zend_Session_Namespace $_session\n     *\/",90],["T_WHITESPACE","\n    ",94],["T_PRIVATE","private",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$_session",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","null",95],";",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Last error message for logi, check or verify failure\n     *\n     * @var string $_error\n     *\/",97],["T_WHITESPACE","\n    ",101],["T_PRIVATE","private",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$_error",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","''",102],";",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Constructs a Zend_OpenId_Consumer object with given $storage.\n     * Enables or disables future association with server based on\n     * Diffie-Hellman key agreement.\n     *\n     * @param Zend_OpenId_Consumer_Storage $storage implementation of custom\n     *  storage object\n     * @param bool $dumbMode Enables or disables consumer to use association\n     *  with server based on Diffie-Hellman key agreement\n     *\/",104],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","__construct",114],"(",["T_STRING","Zend_OpenId_Consumer_Storage",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$storage",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","null",114],",",["T_WHITESPACE","\n                                ",114],["T_VARIABLE","$dumbMode",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","false",115],")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$storage",117],["T_WHITESPACE"," ",117],["T_IS_IDENTICAL","===",117],["T_WHITESPACE"," ",117],["T_STRING","null",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_COMMENT","#require_once \"Zend\/OpenId\/Consumer\/Storage\/File.php\";\n",118],["T_WHITESPACE","            ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_storage",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_NEW","new",119],["T_WHITESPACE"," ",119],["T_STRING","Zend_OpenId_Consumer_Storage_File",119],"(",")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE"," ",120],["T_ELSE","else",120],["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_storage",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$storage",121],";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_dumbMode",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$dumbMode",123],";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Performs check (with possible user interaction) of OpenID identity.\n     *\n     * This is the first step of OpenID authentication process.\n     * On success the function does not return (it does HTTP redirection to\n     * server and exits). On failure it returns false.\n     *\n     * @param string $id OpenID identity\n     * @param string $returnTo URL to redirect response from server to\n     * @param string $root HTTP URL to identify consumer on server\n     * @param mixed $extensions extension object or array of extensions objects\n     * @param Zend_Controller_Response_Abstract $response an optional response\n     *  object to perform HTTP or HTML form redirection\n     * @return bool\n     *\/",126],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","login",141],"(",["T_VARIABLE","$id",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$returnTo",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","null",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$root",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","null",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$extensions",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","null",141],",",["T_WHITESPACE","\n                          ",141],["T_STRING","Zend_Controller_Response_Abstract",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$response",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","null",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_checkId",144],"(",["T_WHITESPACE","\n            ",144],["T_STRING","false",145],",",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$id",146],",",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$returnTo",147],",",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$root",148],",",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$extensions",149],",",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$response",150],")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Performs immediate check (without user interaction) of OpenID identity.\n     *\n     * This is the first step of OpenID authentication process.\n     * On success the function does not return (it does HTTP redirection to\n     * server and exits). On failure it returns false.\n     *\n     * @param string $id OpenID identity\n     * @param string $returnTo HTTP URL to redirect response from server to\n     * @param string $root HTTP URL to identify consumer on server\n     * @param mixed $extensions extension object or array of extensions objects\n     * @param Zend_Controller_Response_Abstract $response an optional response\n     *  object to perform HTTP or HTML form redirection\n     * @return bool\n     *\/",153],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","check",168],"(",["T_VARIABLE","$id",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$returnTo",168],"=",["T_STRING","null",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$root",168],"=",["T_STRING","null",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$extensions",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","null",168],",",["T_WHITESPACE","\n                          ",168],["T_STRING","Zend_Controller_Response_Abstract",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$response",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","null",169],")",["T_WHITESPACE","\n\n    ",169],"{",["T_WHITESPACE","\n        ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_checkId",172],"(",["T_WHITESPACE","\n            ",172],["T_STRING","true",173],",",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$id",174],",",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$returnTo",175],",",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$root",176],",",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$extensions",177],",",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$response",178],")",";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Verifies authentication response from OpenID server.\n     *\n     * This is the second step of OpenID authentication process.\n     * The function returns true on successful authentication and false on\n     * failure.\n     *\n     * @param array $params HTTP query data from OpenID server\n     * @param string &$identity this argument is set to end-user's claimed\n     *  identifier or OpenID provider local identifier.\n     * @param mixed $extensions extension object or array of extensions objects\n     * @return bool\n     *\/",181],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","verify",194],"(",["T_VARIABLE","$params",194],",",["T_WHITESPACE"," ",194],"&",["T_VARIABLE","$identity",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","\"\"",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$extensions",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","null",194],")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_setError",196],"(",["T_CONSTANT_ENCAPSED_STRING","''",196],")",";",["T_WHITESPACE","\n\n        ",196],["T_VARIABLE","$version",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_DNUMBER","1.1",198],";",["T_WHITESPACE","\n        ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_ISSET","isset",199],"(",["T_VARIABLE","$params",199],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",199],"]",")",["T_WHITESPACE"," ",199],["T_BOOLEAN_AND","&&",199],["T_WHITESPACE","\n            ",199],["T_VARIABLE","$params",200],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_ns'",200],"]",["T_WHITESPACE"," ",200],["T_IS_EQUAL","==",200],["T_WHITESPACE"," ",200],["T_STRING","Zend_OpenId",200],["T_DOUBLE_COLON","::",200],["T_STRING","NS_2_0",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$version",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_DNUMBER","2.0",201],";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n\n        ",202],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_ISSET","isset",204],"(",["T_VARIABLE","$params",204],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_claimed_id\"",204],"]",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$identity",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$params",205],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_claimed_id\"",205],"]",";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE"," ",206],["T_ELSE","else",206],["T_WHITESPACE"," ",206],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_ISSET","isset",206],"(",["T_VARIABLE","$params",206],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_identity\"",206],"]",")",")","{",["T_WHITESPACE","\n            ",206],["T_VARIABLE","$identity",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$params",207],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_identity\"",207],"]",";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE"," ",208],["T_ELSE","else",208],["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$identity",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","\"\"",209],";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n\n        ",210],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$version",212],["T_WHITESPACE"," ",212],"<",["T_WHITESPACE"," ",212],["T_DNUMBER","2.0",212],["T_WHITESPACE"," ",212],["T_BOOLEAN_AND","&&",212],["T_WHITESPACE"," ",212],"!",["T_ISSET","isset",212],"(",["T_VARIABLE","$params",212],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_claimed_id\"",212],"]",")",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_session",213],["T_WHITESPACE"," ",213],["T_IS_NOT_IDENTICAL","!==",213],["T_WHITESPACE"," ",213],["T_STRING","null",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_session",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","identity",214],["T_WHITESPACE"," ",214],["T_IS_IDENTICAL","===",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$identity",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n                    ",214],["T_VARIABLE","$identity",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_session",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","claimed_id",215],";",["T_WHITESPACE","\n                ",215],"}",["T_WHITESPACE","\n            ",216],"}",["T_WHITESPACE"," ",217],["T_ELSE","else",217],["T_WHITESPACE"," ",217],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_STRING","defined",217],"(",["T_CONSTANT_ENCAPSED_STRING","'SID'",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_IF","if",218],["T_WHITESPACE"," ",218],"(",["T_ISSET","isset",218],"(",["T_VARIABLE","$_SESSION",218],"[",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",218],"]","[",["T_CONSTANT_ENCAPSED_STRING","\"identity\"",218],"]",")",["T_WHITESPACE"," ",218],["T_BOOLEAN_AND","&&",218],["T_WHITESPACE","\n                    ",218],["T_ISSET","isset",219],"(",["T_VARIABLE","$_SESSION",219],"[",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",219],"]","[",["T_CONSTANT_ENCAPSED_STRING","\"claimed_id\"",219],"]",")",["T_WHITESPACE"," ",219],["T_BOOLEAN_AND","&&",219],["T_WHITESPACE","\n                    ",219],["T_VARIABLE","$_SESSION",220],"[",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",220],"]","[",["T_CONSTANT_ENCAPSED_STRING","\"identity\"",220],"]",["T_WHITESPACE"," ",220],["T_IS_IDENTICAL","===",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$identity",220],")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n                    ",220],["T_VARIABLE","$identity",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$_SESSION",221],"[",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",221],"]","[",["T_CONSTANT_ENCAPSED_STRING","\"claimed_id\"",221],"]",";",["T_WHITESPACE","\n                ",221],"}",["T_WHITESPACE","\n            ",222],"}",["T_WHITESPACE"," ",223],["T_ELSE","else",223],["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n                ",223],["T_COMMENT","#require_once \"Zend\/Session\/Namespace.php\";\n",224],["T_WHITESPACE","                ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_session",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_NEW","new",225],["T_WHITESPACE"," ",225],["T_STRING","Zend_Session_Namespace",225],"(",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",225],")",";",["T_WHITESPACE","\n                ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_session",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","identity",226],["T_WHITESPACE"," ",226],["T_IS_IDENTICAL","===",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$identity",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n                    ",226],["T_VARIABLE","$identity",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_session",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","claimed_id",227],";",["T_WHITESPACE","\n                ",227],"}",["T_WHITESPACE","\n            ",228],"}",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n\n        ",230],["T_IF","if",232],["T_WHITESPACE"," ",232],"(",["T_EMPTY","empty",232],"(",["T_VARIABLE","$params",232],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",232],"]",")",")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_setError",233],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.mode\"",233],")",";",["T_WHITESPACE","\n            ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_STRING","false",234],";",["T_WHITESPACE","\n        ",234],"}",["T_WHITESPACE","\n        ",235],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_EMPTY","empty",236],"(",["T_VARIABLE","$params",236],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",236],"]",")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_setError",237],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.return_to\"",237],")",";",["T_WHITESPACE","\n            ",237],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_STRING","false",238],";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_EMPTY","empty",240],"(",["T_VARIABLE","$params",240],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_signed'",240],"]",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_setError",241],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.signed\"",241],")",";",["T_WHITESPACE","\n            ",241],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_STRING","false",242],";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_EMPTY","empty",244],"(",["T_VARIABLE","$params",244],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_sig'",244],"]",")",")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_setError",245],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.sig\"",245],")",";",["T_WHITESPACE","\n            ",245],["T_RETURN","return",246],["T_WHITESPACE"," ",246],["T_STRING","false",246],";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n        ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$params",248],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",248],"]",["T_WHITESPACE"," ",248],["T_IS_NOT_EQUAL","!=",248],["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'id_res'",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_setError",249],"(",["T_CONSTANT_ENCAPSED_STRING","\"Wrong openid.mode '\"",249],".",["T_VARIABLE","$params",249],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_mode'",249],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"' != 'id_res'\"",249],")",";",["T_WHITESPACE","\n            ",249],["T_RETURN","return",250],["T_WHITESPACE"," ",250],["T_STRING","false",250],";",["T_WHITESPACE","\n        ",250],"}",["T_WHITESPACE","\n        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_EMPTY","empty",252],"(",["T_VARIABLE","$params",252],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",252],"]",")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_setError",253],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.assoc_handle\"",253],")",";",["T_WHITESPACE","\n            ",253],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_STRING","false",254],";",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n        ",255],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_VARIABLE","$params",256],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",256],"]",["T_WHITESPACE"," ",256],["T_IS_NOT_EQUAL","!=",256],["T_WHITESPACE"," ",256],["T_STRING","Zend_OpenId",256],["T_DOUBLE_COLON","::",256],["T_STRING","selfUrl",256],"(",")",")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n            ",256],["T_COMMENT","\/* Ignore query part in openid.return_to *\/",257],["T_WHITESPACE","\n            ",257],["T_VARIABLE","$pos",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_STRING","strpos",258],"(",["T_VARIABLE","$params",258],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",258],"]",",",["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'?'",258],")",";",["T_WHITESPACE","\n            ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$pos",259],["T_WHITESPACE"," ",259],["T_IS_IDENTICAL","===",259],["T_WHITESPACE"," ",259],["T_STRING","false",259],["T_WHITESPACE"," ",259],["T_BOOLEAN_OR","||",259],["T_WHITESPACE","\n                ",259],["T_STRING","SUBSTR",260],"(",["T_VARIABLE","$params",260],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",260],"]",",",["T_WHITESPACE"," ",260],["T_LNUMBER","0",260],["T_WHITESPACE"," ",260],",",["T_WHITESPACE"," ",260],["T_VARIABLE","$pos",260],")",["T_WHITESPACE"," ",260],["T_IS_NOT_EQUAL","!=",260],["T_WHITESPACE"," ",260],["T_STRING","Zend_OpenId",260],["T_DOUBLE_COLON","::",260],["T_STRING","selfUrl",260],"(",")",")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n\n                ",260],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","_setError",262],"(",["T_CONSTANT_ENCAPSED_STRING","\"Wrong openid.return_to '\"",262],".",["T_WHITESPACE","\n                    ",262],["T_VARIABLE","$params",263],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_return_to'",263],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"' != '\"",263],["T_WHITESPACE"," ",263],".",["T_WHITESPACE"," ",263],["T_STRING","Zend_OpenId",263],["T_DOUBLE_COLON","::",263],["T_STRING","selfUrl",263],"(",")",["T_WHITESPACE"," ",263],".",["T_CONSTANT_ENCAPSED_STRING","\"'\"",263],")",";",["T_WHITESPACE","\n                ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_STRING","false",264],";",["T_WHITESPACE","\n            ",264],"}",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n        ",266],["T_IF","if",267],["T_WHITESPACE"," ",267],"(",["T_VARIABLE","$version",267],["T_WHITESPACE"," ",267],["T_IS_GREATER_OR_EQUAL",">=",267],["T_WHITESPACE"," ",267],["T_DNUMBER","2.0",267],")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n            ",267],["T_IF","if",268],["T_WHITESPACE"," ",268],"(",["T_EMPTY","empty",268],"(",["T_VARIABLE","$params",268],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_response_nonce'",268],"]",")",")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n                ",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_setError",269],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.response_nonce\"",269],")",";",["T_WHITESPACE","\n                ",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_STRING","false",270],";",["T_WHITESPACE","\n            ",270],"}",["T_WHITESPACE","\n            ",271],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_EMPTY","empty",272],"(",["T_VARIABLE","$params",272],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",272],"]",")",")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n                ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_setError",273],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.op_endpoint\"",273],")",";",["T_WHITESPACE","\n                ",273],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_STRING","false",274],";",["T_WHITESPACE","\n            ",274],["T_COMMENT","\/* OpenID 2.0 (11.3) Checking the Nonce *\/",275],["T_WHITESPACE","\n            ",275],"}",["T_WHITESPACE"," ",276],["T_ELSE","else",276],["T_WHITESPACE"," ",276],["T_IF","if",276],["T_WHITESPACE"," ",276],"(","!",["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_storage",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","isUniqueNonce",276],"(",["T_VARIABLE","$params",276],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",276],"]",",",["T_WHITESPACE"," ",276],["T_VARIABLE","$params",276],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_response_nonce'",276],"]",")",")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n                ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_setError",277],"(",["T_CONSTANT_ENCAPSED_STRING","\"Duplicate openid.response_nonce\"",277],")",";",["T_WHITESPACE","\n                ",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_STRING","false",278],";",["T_WHITESPACE","\n            ",278],"}",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n\n        ",280],["T_IF","if",282],["T_WHITESPACE"," ",282],"(","!",["T_EMPTY","empty",282],"(",["T_VARIABLE","$params",282],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_invalidate_handle'",282],"]",")",")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n            ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_storage",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getAssociationByHandle",283],"(",["T_WHITESPACE","\n                ",283],["T_VARIABLE","$params",284],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_invalidate_handle'",284],"]",",",["T_WHITESPACE","\n                ",284],["T_VARIABLE","$url",285],",",["T_WHITESPACE","\n                ",285],["T_VARIABLE","$macFunc",286],",",["T_WHITESPACE","\n                ",286],["T_VARIABLE","$secret",287],",",["T_WHITESPACE","\n                ",287],["T_VARIABLE","$expires",288],")",")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n                ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","_storage",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","delAssociation",289],"(",["T_VARIABLE","$url",289],")",";",["T_WHITESPACE","\n            ",289],"}",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE","\n\n        ",291],["T_IF","if",293],["T_WHITESPACE"," ",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_storage",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getAssociationByHandle",293],"(",["T_WHITESPACE","\n                ",293],["T_VARIABLE","$params",294],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_assoc_handle'",294],"]",",",["T_WHITESPACE","\n                ",294],["T_VARIABLE","$url",295],",",["T_WHITESPACE","\n                ",295],["T_VARIABLE","$macFunc",296],",",["T_WHITESPACE","\n                ",296],["T_VARIABLE","$secret",297],",",["T_WHITESPACE","\n                ",297],["T_VARIABLE","$expires",298],")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n            ",298],["T_COMMENT","\/\/ Security fix - check the association bewteen op_endpoint and assoc_handle\n",299],["T_WHITESPACE","            ",300],["T_IF","if",300],["T_WHITESPACE"," ",300],"(",["T_ISSET","isset",300],"(",["T_VARIABLE","$params",300],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",300],"]",")",["T_WHITESPACE"," ",300],["T_BOOLEAN_AND","&&",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$url",300],["T_WHITESPACE"," ",300],["T_IS_NOT_IDENTICAL","!==",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$params",300],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",300],"]",")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n                ",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_setError",301],"(",["T_CONSTANT_ENCAPSED_STRING","\"The op_endpoint URI is not the same of URI associated with the assoc_handle\"",301],")",";",["T_WHITESPACE","\n                ",301],["T_RETURN","return",302],["T_WHITESPACE"," ",302],["T_STRING","false",302],";",["T_WHITESPACE","\n            ",302],"}",["T_WHITESPACE","       \n            ",303],["T_VARIABLE","$signed",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_STRING","explode",304],"(",["T_CONSTANT_ENCAPSED_STRING","','",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$params",304],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_signed'",304],"]",")",";",["T_WHITESPACE","\n            ",304],["T_COMMENT","\/\/ Check the parameters for the signature\n",305],["T_WHITESPACE","            ",306],["T_COMMENT","\/\/ @see https:\/\/openid.net\/specs\/openid-authentication-2_0.html#positive_assertions\n",306],["T_WHITESPACE","            ",307],["T_VARIABLE","$toCheck",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","_signParams",307],";",["T_WHITESPACE","\n            ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_ISSET","isset",308],"(",["T_VARIABLE","$params",308],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",308],"]",")",["T_WHITESPACE"," ",308],["T_BOOLEAN_AND","&&",308],["T_WHITESPACE"," ",308],["T_ISSET","isset",308],"(",["T_VARIABLE","$params",308],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",308],"]",")",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n                ",308],["T_VARIABLE","$toCheck",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_STRING","array_merge",309],"(",["T_VARIABLE","$toCheck",309],",",["T_WHITESPACE"," ",309],["T_ARRAY","array",309],"(",["T_CONSTANT_ENCAPSED_STRING","'claimed_id'",309],",",["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'identity'",309],")",")",";",["T_WHITESPACE","\n            ",309],"}",["T_WHITESPACE","\n            ",310],["T_FOREACH","foreach",311],["T_WHITESPACE"," ",311],"(",["T_VARIABLE","$toCheck",311],["T_WHITESPACE"," ",311],["T_AS","as",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$param",311],")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n                ",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(","!",["T_STRING","in_array",312],"(",["T_VARIABLE","$param",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$signed",312],",",["T_WHITESPACE"," ",312],["T_STRING","true",312],")",")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                    ",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_setError",313],"(","\"",["T_ENCAPSED_AND_WHITESPACE","The required parameter ",313],["T_VARIABLE","$param",313],["T_ENCAPSED_AND_WHITESPACE"," is missing in the signed",313],"\"",")",";",["T_WHITESPACE","\n                    ",313],["T_RETURN","return",314],["T_WHITESPACE"," ",314],["T_STRING","false",314],";",["T_WHITESPACE","\n                ",314],"}",["T_WHITESPACE","\n            ",315],"}",["T_WHITESPACE","\n            \n            ",316],["T_VARIABLE","$data",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","''",318],";",["T_WHITESPACE","\n            ",318],["T_FOREACH","foreach",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$signed",319],["T_WHITESPACE"," ",319],["T_AS","as",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$key",319],")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                ",319],["T_VARIABLE","$data",320],["T_WHITESPACE"," ",320],["T_CONCAT_EQUAL",".=",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$key",320],["T_WHITESPACE"," ",320],".",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","':'",320],["T_WHITESPACE"," ",320],".",["T_WHITESPACE"," ",320],["T_VARIABLE","$params",320],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_'",320],["T_WHITESPACE"," ",320],".",["T_WHITESPACE"," ",320],["T_STRING","strtr",320],"(",["T_VARIABLE","$key",320],",",["T_CONSTANT_ENCAPSED_STRING","'.'",320],",",["T_CONSTANT_ENCAPSED_STRING","'_'",320],")","]",["T_WHITESPACE"," ",320],".",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",320],";",["T_WHITESPACE","\n            ",320],"}",["T_WHITESPACE","\n            ",321],["T_IF","if",322],["T_WHITESPACE"," ",322],"(",["T_STRING","base64_decode",322],"(",["T_VARIABLE","$params",322],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_sig'",322],"]",")",["T_WHITESPACE"," ",322],["T_IS_EQUAL","==",322],["T_WHITESPACE","\n                ",322],["T_STRING","Zend_OpenId",323],["T_DOUBLE_COLON","::",323],["T_STRING","hashHmac",323],"(",["T_VARIABLE","$macFunc",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$data",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$secret",323],")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n                ",323],["T_IF","if",324],["T_WHITESPACE"," ",324],"(","!",["T_STRING","Zend_OpenId_Extension",324],["T_DOUBLE_COLON","::",324],["T_STRING","forAll",324],"(",["T_VARIABLE","$extensions",324],",",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","'parseResponse'",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$params",324],")",")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n                    ",324],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_setError",325],"(",["T_CONSTANT_ENCAPSED_STRING","\"Extension::parseResponse failure\"",325],")",";",["T_WHITESPACE","\n                    ",325],["T_RETURN","return",326],["T_WHITESPACE"," ",326],["T_STRING","false",326],";",["T_WHITESPACE","\n                ",326],"}",["T_WHITESPACE","\n                ",327],["T_COMMENT","\/* OpenID 2.0 (11.2) Verifying Discovered Information *\/",328],["T_WHITESPACE","\n                ",328],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_ISSET","isset",329],"(",["T_VARIABLE","$params",329],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",329],"]",")",")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n                    ",329],["T_VARIABLE","$id",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$params",330],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",330],"]",";",["T_WHITESPACE","\n                    ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(","!",["T_STRING","Zend_OpenId",331],["T_DOUBLE_COLON","::",331],["T_STRING","normalize",331],"(",["T_VARIABLE","$id",331],")",")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n                        ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_setError",332],"(",["T_CONSTANT_ENCAPSED_STRING","\"Normalization failed\"",332],")",";",["T_WHITESPACE","\n                        ",332],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_STRING","false",333],";",["T_WHITESPACE","\n                    ",333],"}",["T_WHITESPACE"," ",334],["T_ELSE","else",334],["T_WHITESPACE"," ",334],["T_IF","if",334],["T_WHITESPACE"," ",334],"(","!",["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_discovery",334],"(",["T_VARIABLE","$id",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$discovered_server",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$discovered_version",334],")",")",["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n                        ",334],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_setError",335],"(",["T_CONSTANT_ENCAPSED_STRING","\"Discovery failed: \"",335],["T_WHITESPACE"," ",335],".",["T_WHITESPACE"," ",335],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","getError",335],"(",")",")",";",["T_WHITESPACE","\n                        ",335],["T_RETURN","return",336],["T_WHITESPACE"," ",336],["T_STRING","false",336],";",["T_WHITESPACE","\n                    ",336],"}",["T_WHITESPACE"," ",337],["T_ELSE","else",337],["T_WHITESPACE"," ",337],["T_IF","if",337],["T_WHITESPACE"," ",337],"(","(","!",["T_EMPTY","empty",337],"(",["T_VARIABLE","$params",337],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",337],"]",")",["T_WHITESPACE"," ",337],["T_BOOLEAN_AND","&&",337],["T_WHITESPACE","\n                                ",337],["T_VARIABLE","$params",338],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_identity\"",338],"]",["T_WHITESPACE"," ",338],["T_IS_NOT_EQUAL","!=",338],["T_WHITESPACE"," ",338],["T_VARIABLE","$id",338],")",["T_WHITESPACE"," ",338],["T_BOOLEAN_OR","||",338],["T_WHITESPACE","\n                               ",338],"(","!",["T_EMPTY","empty",339],"(",["T_VARIABLE","$params",339],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",339],"]",")",["T_WHITESPACE"," ",339],["T_BOOLEAN_AND","&&",339],["T_WHITESPACE","\n                                ",339],["T_VARIABLE","$params",340],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",340],"]",["T_WHITESPACE"," ",340],["T_IS_NOT_EQUAL","!=",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$discovered_server",340],")",["T_WHITESPACE"," ",340],["T_BOOLEAN_OR","||",340],["T_WHITESPACE","\n                               ",340],["T_VARIABLE","$discovered_version",341],["T_WHITESPACE"," ",341],["T_IS_NOT_EQUAL","!=",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$version",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                        ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_setError",342],"(",["T_CONSTANT_ENCAPSED_STRING","\"Discovery information verification failed\"",342],")",";",["T_WHITESPACE","\n                        ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_STRING","false",343],";",["T_WHITESPACE","\n                    ",343],"}",["T_WHITESPACE","\n                ",344],"}",["T_WHITESPACE","\n                ",345],["T_RETURN","return",346],["T_WHITESPACE"," ",346],["T_STRING","true",346],";",["T_WHITESPACE","\n            ",346],"}",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_storage",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","delAssociation",348],"(",["T_VARIABLE","$url",348],")",";",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","_setError",349],"(",["T_CONSTANT_ENCAPSED_STRING","\"Signature check failed\"",349],")",";",["T_WHITESPACE","\n            ",349],["T_RETURN","return",350],["T_WHITESPACE"," ",350],["T_STRING","false",350],";",["T_WHITESPACE","\n        ",350],"}",["T_WHITESPACE","\n        ",351],["T_ELSE","else",352],["T_WHITESPACE","\n        ",352],"{",["T_WHITESPACE","\n            ",353],["T_COMMENT","\/* Use dumb mode *\/",354],["T_WHITESPACE","\n            ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_ISSET","isset",355],"(",["T_VARIABLE","$params",355],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",355],"]",")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$id",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_VARIABLE","$params",356],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_claimed_id'",356],"]",";",["T_WHITESPACE","\n            ",356],"}",["T_WHITESPACE"," ",357],["T_ELSE","else",357],["T_WHITESPACE"," ",357],["T_IF","if",357],["T_WHITESPACE"," ",357],"(",["T_ISSET","isset",357],"(",["T_VARIABLE","$params",357],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",357],"]",")",")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n                ",357],["T_VARIABLE","$id",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$params",358],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",358],"]",";",["T_WHITESPACE","\n            ",358],"}",["T_WHITESPACE"," ",359],["T_ELSE","else",359],["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n                ",359],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_setError",360],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing openid.claimed_id and openid.identity\"",360],")",";",["T_WHITESPACE","\n                ",360],["T_RETURN","return",361],["T_WHITESPACE"," ",361],["T_STRING","false",361],";",["T_WHITESPACE","\n            ",361],"}",["T_WHITESPACE","\n\n            ",362],["T_IF","if",364],["T_WHITESPACE"," ",364],"(","!",["T_STRING","Zend_OpenId",364],["T_DOUBLE_COLON","::",364],["T_STRING","normalize",364],"(",["T_VARIABLE","$id",364],")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n                ",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","_setError",365],"(",["T_CONSTANT_ENCAPSED_STRING","\"Normalization failed\"",365],")",";",["T_WHITESPACE","\n                ",365],["T_RETURN","return",366],["T_WHITESPACE"," ",366],["T_STRING","false",366],";",["T_WHITESPACE","\n            ",366],"}",["T_WHITESPACE"," ",367],["T_ELSE","else",367],["T_WHITESPACE"," ",367],["T_IF","if",367],["T_WHITESPACE"," ",367],"(","!",["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_discovery",367],"(",["T_VARIABLE","$id",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$server",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$discovered_version",367],")",")",["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n                ",367],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","_setError",368],"(",["T_CONSTANT_ENCAPSED_STRING","\"Discovery failed: \"",368],["T_WHITESPACE"," ",368],".",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","getError",368],"(",")",")",";",["T_WHITESPACE","\n                ",368],["T_RETURN","return",369],["T_WHITESPACE"," ",369],["T_STRING","false",369],";",["T_WHITESPACE","\n            ",369],"}",["T_WHITESPACE","\n\n            ",370],["T_COMMENT","\/* OpenID 2.0 (11.2) Verifying Discovered Information *\/",372],["T_WHITESPACE","\n            ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(","(",["T_ISSET","isset",373],"(",["T_VARIABLE","$params",373],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_identity'",373],"]",")",["T_WHITESPACE"," ",373],["T_BOOLEAN_AND","&&",373],["T_WHITESPACE","\n                 ",373],["T_VARIABLE","$params",374],"[",["T_CONSTANT_ENCAPSED_STRING","\"openid_identity\"",374],"]",["T_WHITESPACE"," ",374],["T_IS_NOT_EQUAL","!=",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$id",374],")",["T_WHITESPACE"," ",374],["T_BOOLEAN_OR","||",374],["T_WHITESPACE","\n                ",374],"(",["T_ISSET","isset",375],"(",["T_VARIABLE","$params",375],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",375],"]",")",["T_WHITESPACE"," ",375],["T_BOOLEAN_AND","&&",375],["T_WHITESPACE","\n                 ",375],["T_VARIABLE","$params",376],"[",["T_CONSTANT_ENCAPSED_STRING","'openid_op_endpoint'",376],"]",["T_WHITESPACE"," ",376],["T_IS_NOT_EQUAL","!=",376],["T_WHITESPACE"," ",376],["T_VARIABLE","$server",376],")",["T_WHITESPACE"," ",376],["T_BOOLEAN_OR","||",376],["T_WHITESPACE","\n                ",376],["T_VARIABLE","$discovered_version",377],["T_WHITESPACE"," ",377],["T_IS_NOT_EQUAL","!=",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$version",377],")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n                ",377],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_setError",378],"(",["T_CONSTANT_ENCAPSED_STRING","\"Discovery information verification failed\"",378],")",";",["T_WHITESPACE","\n                ",378],["T_RETURN","return",379],["T_WHITESPACE"," ",379],["T_STRING","false",379],";",["T_WHITESPACE","\n            ",379],"}",["T_WHITESPACE","\n\n            ",380],["T_VARIABLE","$params2",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_ARRAY","array",382],"(",")",";",["T_WHITESPACE","\n            ",382],["T_FOREACH","foreach",383],["T_WHITESPACE"," ",383],"(",["T_VARIABLE","$params",383],["T_WHITESPACE"," ",383],["T_AS","as",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$key",383],["T_WHITESPACE"," ",383],["T_DOUBLE_ARROW","=>",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$val",383],")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n                ",383],["T_IF","if",384],["T_WHITESPACE"," ",384],"(",["T_STRING","strpos",384],"(",["T_VARIABLE","$key",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'openid_ns_'",384],")",["T_WHITESPACE"," ",384],["T_IS_IDENTICAL","===",384],["T_WHITESPACE"," ",384],["T_LNUMBER","0",384],")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n                    ",384],["T_VARIABLE","$key",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_CONSTANT_ENCAPSED_STRING","'openid.ns.'",385],["T_WHITESPACE"," ",385],".",["T_WHITESPACE"," ",385],["T_STRING","substr",385],"(",["T_VARIABLE","$key",385],",",["T_WHITESPACE"," ",385],["T_STRING","strlen",385],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_ns_'",385],")",")",";",["T_WHITESPACE","\n                ",385],"}",["T_WHITESPACE"," ",386],["T_ELSE","else",386],["T_WHITESPACE"," ",386],["T_IF","if",386],["T_WHITESPACE"," ",386],"(",["T_STRING","strpos",386],"(",["T_VARIABLE","$key",386],",",["T_WHITESPACE"," ",386],["T_CONSTANT_ENCAPSED_STRING","'openid_sreg_'",386],")",["T_WHITESPACE"," ",386],["T_IS_IDENTICAL","===",386],["T_WHITESPACE"," ",386],["T_LNUMBER","0",386],")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n                    ",386],["T_VARIABLE","$key",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_CONSTANT_ENCAPSED_STRING","'openid.sreg.'",387],["T_WHITESPACE"," ",387],".",["T_WHITESPACE"," ",387],["T_STRING","substr",387],"(",["T_VARIABLE","$key",387],",",["T_WHITESPACE"," ",387],["T_STRING","strlen",387],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_sreg_'",387],")",")",";",["T_WHITESPACE","\n                ",387],"}",["T_WHITESPACE"," ",388],["T_ELSE","else",388],["T_WHITESPACE"," ",388],["T_IF","if",388],["T_WHITESPACE"," ",388],"(",["T_STRING","strpos",388],"(",["T_VARIABLE","$key",388],",",["T_WHITESPACE"," ",388],["T_CONSTANT_ENCAPSED_STRING","'openid_'",388],")",["T_WHITESPACE"," ",388],["T_IS_IDENTICAL","===",388],["T_WHITESPACE"," ",388],["T_LNUMBER","0",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                    ",388],["T_VARIABLE","$key",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_CONSTANT_ENCAPSED_STRING","'openid.'",389],["T_WHITESPACE"," ",389],".",["T_WHITESPACE"," ",389],["T_STRING","substr",389],"(",["T_VARIABLE","$key",389],",",["T_WHITESPACE"," ",389],["T_STRING","strlen",389],"(",["T_CONSTANT_ENCAPSED_STRING","'openid_'",389],")",")",";",["T_WHITESPACE","\n                ",389],"}",["T_WHITESPACE","\n                ",390],["T_VARIABLE","$params2",391],"[",["T_VARIABLE","$key",391],"]",["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_VARIABLE","$val",391],";",["T_WHITESPACE","\n            ",391],"}",["T_WHITESPACE","\n            ",392],["T_VARIABLE","$params2",393],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",393],"]",["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_CONSTANT_ENCAPSED_STRING","'check_authentication'",393],";",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$ret",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","_httpRequest",394],"(",["T_VARIABLE","$server",394],",",["T_WHITESPACE"," ",394],["T_CONSTANT_ENCAPSED_STRING","'POST'",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$params2",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$status",394],")",";",["T_WHITESPACE","\n            ",394],["T_IF","if",395],["T_WHITESPACE"," ",395],"(",["T_VARIABLE","$status",395],["T_WHITESPACE"," ",395],["T_IS_NOT_EQUAL","!=",395],["T_WHITESPACE"," ",395],["T_LNUMBER","200",395],")",["T_WHITESPACE"," ",395],"{",["T_WHITESPACE","\n                ",395],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","_setError",396],"(",["T_CONSTANT_ENCAPSED_STRING","\"'Dumb' signature verification HTTP request failed\"",396],")",";",["T_WHITESPACE","\n                ",396],["T_RETURN","return",397],["T_WHITESPACE"," ",397],["T_STRING","false",397],";",["T_WHITESPACE","\n            ",397],"}",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$r",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_ARRAY","array",399],"(",")",";",["T_WHITESPACE","\n            ",399],["T_IF","if",400],["T_WHITESPACE"," ",400],"(",["T_STRING","is_string",400],"(",["T_VARIABLE","$ret",400],")",")",["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n                ",400],["T_FOREACH","foreach",401],"(",["T_STRING","explode",401],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$ret",401],")",["T_WHITESPACE"," ",401],["T_AS","as",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$line",401],")",["T_WHITESPACE"," ",401],"{",["T_WHITESPACE","\n                    ",401],["T_VARIABLE","$line",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_STRING","trim",402],"(",["T_VARIABLE","$line",402],")",";",["T_WHITESPACE","\n                    ",402],["T_IF","if",403],["T_WHITESPACE"," ",403],"(","!",["T_EMPTY","empty",403],"(",["T_VARIABLE","$line",403],")",")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n                        ",403],["T_VARIABLE","$x",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_STRING","explode",404],"(",["T_CONSTANT_ENCAPSED_STRING","':'",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$line",404],",",["T_WHITESPACE"," ",404],["T_LNUMBER","2",404],")",";",["T_WHITESPACE","\n                        ",404],["T_IF","if",405],["T_WHITESPACE"," ",405],"(",["T_STRING","is_array",405],"(",["T_VARIABLE","$x",405],")",["T_WHITESPACE"," ",405],["T_BOOLEAN_AND","&&",405],["T_WHITESPACE"," ",405],["T_STRING","count",405],"(",["T_VARIABLE","$x",405],")",["T_WHITESPACE"," ",405],["T_IS_EQUAL","==",405],["T_WHITESPACE"," ",405],["T_LNUMBER","2",405],")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n                            ",405],["T_LIST","list",406],"(",["T_VARIABLE","$key",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$value",406],")",["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$x",406],";",["T_WHITESPACE","\n                            ",406],["T_VARIABLE","$r",407],"[",["T_STRING","trim",407],"(",["T_VARIABLE","$key",407],")","]",["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_STRING","trim",407],"(",["T_VARIABLE","$value",407],")",";",["T_WHITESPACE","\n                        ",407],"}",["T_WHITESPACE","\n                    ",408],"}",["T_WHITESPACE","\n                ",409],"}",["T_WHITESPACE","\n            ",410],"}",["T_WHITESPACE","\n            ",411],["T_VARIABLE","$ret",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$r",412],";",["T_WHITESPACE","\n            ",412],["T_IF","if",413],["T_WHITESPACE"," ",413],"(","!",["T_EMPTY","empty",413],"(",["T_VARIABLE","$ret",413],"[",["T_CONSTANT_ENCAPSED_STRING","'invalidate_handle'",413],"]",")",")",["T_WHITESPACE"," ",413],"{",["T_WHITESPACE","\n                ",413],["T_IF","if",414],["T_WHITESPACE"," ",414],"(",["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","_storage",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getAssociationByHandle",414],"(",["T_WHITESPACE","\n                    ",414],["T_VARIABLE","$ret",415],"[",["T_CONSTANT_ENCAPSED_STRING","'invalidate_handle'",415],"]",",",["T_WHITESPACE","\n                    ",415],["T_VARIABLE","$url",416],",",["T_WHITESPACE","\n                    ",416],["T_VARIABLE","$macFunc",417],",",["T_WHITESPACE","\n                    ",417],["T_VARIABLE","$secret",418],",",["T_WHITESPACE","\n                    ",418],["T_VARIABLE","$expires",419],")",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                    ",419],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","_storage",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","delAssociation",420],"(",["T_VARIABLE","$url",420],")",";",["T_WHITESPACE","\n                ",420],"}",["T_WHITESPACE","\n            ",421],"}",["T_WHITESPACE","\n            ",422],["T_IF","if",423],["T_WHITESPACE"," ",423],"(",["T_ISSET","isset",423],"(",["T_VARIABLE","$ret",423],"[",["T_CONSTANT_ENCAPSED_STRING","'is_valid'",423],"]",")",["T_WHITESPACE"," ",423],["T_BOOLEAN_AND","&&",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$ret",423],"[",["T_CONSTANT_ENCAPSED_STRING","'is_valid'",423],"]",["T_WHITESPACE"," ",423],["T_IS_EQUAL","==",423],["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'true'",423],")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n                ",423],["T_IF","if",424],["T_WHITESPACE"," ",424],"(","!",["T_STRING","Zend_OpenId_Extension",424],["T_DOUBLE_COLON","::",424],["T_STRING","forAll",424],"(",["T_VARIABLE","$extensions",424],",",["T_WHITESPACE"," ",424],["T_CONSTANT_ENCAPSED_STRING","'parseResponse'",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$params",424],")",")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n                    ",424],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","_setError",425],"(",["T_CONSTANT_ENCAPSED_STRING","\"Extension::parseResponse failure\"",425],")",";",["T_WHITESPACE","\n                    ",425],["T_RETURN","return",426],["T_WHITESPACE"," ",426],["T_STRING","false",426],";",["T_WHITESPACE","\n                ",426],"}",["T_WHITESPACE","\n                ",427],["T_RETURN","return",428],["T_WHITESPACE"," ",428],["T_STRING","true",428],";",["T_WHITESPACE","\n            ",428],"}",["T_WHITESPACE","\n            ",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_setError",430],"(",["T_CONSTANT_ENCAPSED_STRING","\"'Dumb' signature verification failed\"",430],")",";",["T_WHITESPACE","\n            ",430],["T_RETURN","return",431],["T_WHITESPACE"," ",431],["T_STRING","false",431],";",["T_WHITESPACE","\n        ",431],"}",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n\n    ",433],["T_DOC_COMMENT","\/**\n     * Store assiciation in internal chace and external storage\n     *\n     * @param string $url OpenID server url\n     * @param string $handle association handle\n     * @param string $macFunc HMAC function (sha1 or sha256)\n     * @param string $secret shared secret\n     * @param integer $expires expiration UNIX time\n     * @return void\n     *\/",435],["T_WHITESPACE","\n    ",444],["T_PROTECTED","protected",445],["T_WHITESPACE"," ",445],["T_FUNCTION","function",445],["T_WHITESPACE"," ",445],["T_STRING","_addAssociation",445],"(",["T_VARIABLE","$url",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$handle",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$macFunc",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$secret",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$expires",445],")",["T_WHITESPACE","\n    ",445],"{",["T_WHITESPACE","\n        ",446],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","_cache",447],"[",["T_VARIABLE","$url",447],"]",["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_ARRAY","array",447],"(",["T_VARIABLE","$handle",447],",",["T_WHITESPACE"," ",447],["T_VARIABLE","$macFunc",447],",",["T_WHITESPACE"," ",447],["T_VARIABLE","$secret",447],",",["T_WHITESPACE"," ",447],["T_VARIABLE","$expires",447],")",";",["T_WHITESPACE","\n        ",447],["T_RETURN","return",448],["T_WHITESPACE"," ",448],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","_storage",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","addAssociation",448],"(",["T_WHITESPACE","\n            ",448],["T_VARIABLE","$url",449],",",["T_WHITESPACE","\n            ",449],["T_VARIABLE","$handle",450],",",["T_WHITESPACE","\n            ",450],["T_VARIABLE","$macFunc",451],",",["T_WHITESPACE","\n            ",451],["T_VARIABLE","$secret",452],",",["T_WHITESPACE","\n            ",452],["T_VARIABLE","$expires",453],")",";",["T_WHITESPACE","\n    ",453],"}",["T_WHITESPACE","\n\n    ",454],["T_DOC_COMMENT","\/**\n     * Retrive assiciation information for given $url from internal cahce or\n     * external storage\n     *\n     * @param string $url OpenID server url\n     * @param string &$handle association handle\n     * @param string &$macFunc HMAC function (sha1 or sha256)\n     * @param string &$secret shared secret\n     * @param integer &$expires expiration UNIX time\n     * @return void\n     *\/",456],["T_WHITESPACE","\n    ",466],["T_PROTECTED","protected",467],["T_WHITESPACE"," ",467],["T_FUNCTION","function",467],["T_WHITESPACE"," ",467],["T_STRING","_getAssociation",467],"(",["T_VARIABLE","$url",467],",",["T_WHITESPACE"," ",467],"&",["T_VARIABLE","$handle",467],",",["T_WHITESPACE"," ",467],"&",["T_VARIABLE","$macFunc",467],",",["T_WHITESPACE"," ",467],"&",["T_VARIABLE","$secret",467],",",["T_WHITESPACE"," ",467],"&",["T_VARIABLE","$expires",467],")",["T_WHITESPACE","\n    ",467],"{",["T_WHITESPACE","\n        ",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(",["T_ISSET","isset",469],"(",["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_cache",469],"[",["T_VARIABLE","$url",469],"]",")",")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n            ",469],["T_VARIABLE","$handle",470],["T_WHITESPACE","   ",470],"=",["T_WHITESPACE"," ",470],["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","_cache",470],"[",["T_VARIABLE","$url",470],"]","[",["T_LNUMBER","0",470],"]",";",["T_WHITESPACE","\n            ",470],["T_VARIABLE","$macFunc",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_cache",471],"[",["T_VARIABLE","$url",471],"]","[",["T_LNUMBER","1",471],"]",";",["T_WHITESPACE","\n            ",471],["T_VARIABLE","$secret",472],["T_WHITESPACE","   ",472],"=",["T_WHITESPACE"," ",472],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","_cache",472],"[",["T_VARIABLE","$url",472],"]","[",["T_LNUMBER","2",472],"]",";",["T_WHITESPACE","\n            ",472],["T_VARIABLE","$expires",473],["T_WHITESPACE","  ",473],"=",["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","_cache",473],"[",["T_VARIABLE","$url",473],"]","[",["T_LNUMBER","3",473],"]",";",["T_WHITESPACE","\n            ",473],["T_RETURN","return",474],["T_WHITESPACE"," ",474],["T_STRING","true",474],";",["T_WHITESPACE","\n        ",474],"}",["T_WHITESPACE","\n        ",475],["T_IF","if",476],["T_WHITESPACE"," ",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_storage",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getAssociation",476],"(",["T_WHITESPACE","\n                ",476],["T_VARIABLE","$url",477],",",["T_WHITESPACE","\n                ",477],["T_VARIABLE","$handle",478],",",["T_WHITESPACE","\n                ",478],["T_VARIABLE","$macFunc",479],",",["T_WHITESPACE","\n                ",479],["T_VARIABLE","$secret",480],",",["T_WHITESPACE","\n                ",480],["T_VARIABLE","$expires",481],")",")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n            ",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_cache",482],"[",["T_VARIABLE","$url",482],"]",["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_ARRAY","array",482],"(",["T_VARIABLE","$handle",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$macFunc",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$secret",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$expires",482],")",";",["T_WHITESPACE","\n            ",482],["T_RETURN","return",483],["T_WHITESPACE"," ",483],["T_STRING","true",483],";",["T_WHITESPACE","\n        ",483],"}",["T_WHITESPACE","\n        ",484],["T_RETURN","return",485],["T_WHITESPACE"," ",485],["T_STRING","false",485],";",["T_WHITESPACE","\n    ",485],"}",["T_WHITESPACE","\n\n    ",486],["T_DOC_COMMENT","\/**\n     * Performs HTTP request to given $url using given HTTP $method.\n     * Send additinal query specified by variable\/value array,\n     * On success returns HTTP response without headers, false on failure.\n     *\n     * @param string $url OpenID server url\n     * @param string $method HTTP request method 'GET' or 'POST'\n     * @param array $params additional qwery parameters to be passed with\n     * @param int &$staus HTTP status code\n     *  request\n     * @return mixed\n     *\/",488],["T_WHITESPACE","\n    ",499],["T_PROTECTED","protected",500],["T_WHITESPACE"," ",500],["T_FUNCTION","function",500],["T_WHITESPACE"," ",500],["T_STRING","_httpRequest",500],"(",["T_VARIABLE","$url",500],",",["T_WHITESPACE"," ",500],["T_VARIABLE","$method",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_CONSTANT_ENCAPSED_STRING","'GET'",500],",",["T_WHITESPACE"," ",500],["T_ARRAY","array",500],["T_WHITESPACE"," ",500],["T_VARIABLE","$params",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_ARRAY","array",500],"(",")",",",["T_WHITESPACE"," ",500],"&",["T_VARIABLE","$status",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_STRING","null",500],")",["T_WHITESPACE","\n    ",500],"{",["T_WHITESPACE","\n        ",501],["T_VARIABLE","$client",502],["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","_httpClient",502],";",["T_WHITESPACE","\n        ",502],["T_IF","if",503],["T_WHITESPACE"," ",503],"(",["T_VARIABLE","$client",503],["T_WHITESPACE"," ",503],["T_IS_IDENTICAL","===",503],["T_WHITESPACE"," ",503],["T_STRING","null",503],")",["T_WHITESPACE"," ",503],"{",["T_WHITESPACE","\n            ",503],["T_VARIABLE","$client",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_NEW","new",504],["T_WHITESPACE"," ",504],["T_STRING","Zend_Http_Client",504],"(",["T_WHITESPACE","\n                    ",504],["T_VARIABLE","$url",505],",",["T_WHITESPACE","\n                    ",505],["T_ARRAY","array",506],"(",["T_WHITESPACE","\n                        ",506],["T_CONSTANT_ENCAPSED_STRING","'maxredirects'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_LNUMBER","4",507],",",["T_WHITESPACE","\n                        ",507],["T_CONSTANT_ENCAPSED_STRING","'timeout'",508],["T_WHITESPACE","      ",508],["T_DOUBLE_ARROW","=>",508],["T_WHITESPACE"," ",508],["T_LNUMBER","15",508],",",["T_WHITESPACE","\n                        ",508],["T_CONSTANT_ENCAPSED_STRING","'useragent'",509],["T_WHITESPACE","    ",509],["T_DOUBLE_ARROW","=>",509],["T_WHITESPACE"," ",509],["T_CONSTANT_ENCAPSED_STRING","'Zend_OpenId'",509],["T_WHITESPACE","\n                    ",509],")",["T_WHITESPACE","\n                ",510],")",";",["T_WHITESPACE","\n        ",511],"}",["T_WHITESPACE"," ",512],["T_ELSE","else",512],["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n            ",512],["T_VARIABLE","$client",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","setUri",513],"(",["T_VARIABLE","$url",513],")",";",["T_WHITESPACE","\n        ",513],"}",["T_WHITESPACE","\n\n        ",514],["T_VARIABLE","$client",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","resetParameters",516],"(",")",";",["T_WHITESPACE","\n        ",516],["T_IF","if",517],["T_WHITESPACE"," ",517],"(",["T_VARIABLE","$method",517],["T_WHITESPACE"," ",517],["T_IS_EQUAL","==",517],["T_WHITESPACE"," ",517],["T_CONSTANT_ENCAPSED_STRING","'POST'",517],")",["T_WHITESPACE"," ",517],"{",["T_WHITESPACE","\n            ",517],["T_VARIABLE","$client",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","setMethod",518],"(",["T_STRING","Zend_Http_Client",518],["T_DOUBLE_COLON","::",518],["T_STRING","POST",518],")",";",["T_WHITESPACE","\n            ",518],["T_VARIABLE","$client",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","setParameterPost",519],"(",["T_VARIABLE","$params",519],")",";",["T_WHITESPACE","\n        ",519],"}",["T_WHITESPACE"," ",520],["T_ELSE","else",520],["T_WHITESPACE"," ",520],"{",["T_WHITESPACE","\n            ",520],["T_VARIABLE","$client",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","setMethod",521],"(",["T_STRING","Zend_Http_Client",521],["T_DOUBLE_COLON","::",521],["T_STRING","GET",521],")",";",["T_WHITESPACE","\n            ",521],["T_VARIABLE","$client",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","setParameterGet",522],"(",["T_VARIABLE","$params",522],")",";",["T_WHITESPACE","\n        ",522],"}",["T_WHITESPACE","\n\n        ",523],["T_TRY","try",525],["T_WHITESPACE"," ",525],"{",["T_WHITESPACE","\n            ",525],["T_VARIABLE","$response",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_VARIABLE","$client",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","request",526],"(",")",";",["T_WHITESPACE","\n        ",526],"}",["T_WHITESPACE"," ",527],["T_CATCH","catch",527],["T_WHITESPACE"," ",527],"(",["T_STRING","Exception",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$e",527],")",["T_WHITESPACE"," ",527],"{",["T_WHITESPACE","\n            ",527],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","_setError",528],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP Request failed: '",528],["T_WHITESPACE"," ",528],".",["T_WHITESPACE"," ",528],["T_VARIABLE","$e",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","getMessage",528],"(",")",")",";",["T_WHITESPACE","\n            ",528],["T_RETURN","return",529],["T_WHITESPACE"," ",529],["T_STRING","false",529],";",["T_WHITESPACE","\n        ",529],"}",["T_WHITESPACE","\n        ",530],["T_VARIABLE","$status",531],["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_VARIABLE","$response",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","getStatus",531],"(",")",";",["T_WHITESPACE","\n        ",531],["T_VARIABLE","$body",532],["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_VARIABLE","$response",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","getBody",532],"(",")",";",["T_WHITESPACE","\n        ",532],["T_IF","if",533],["T_WHITESPACE"," ",533],"(",["T_VARIABLE","$status",533],["T_WHITESPACE"," ",533],["T_IS_EQUAL","==",533],["T_WHITESPACE"," ",533],["T_LNUMBER","200",533],["T_WHITESPACE"," ",533],["T_BOOLEAN_OR","||",533],["T_WHITESPACE"," ",533],"(",["T_VARIABLE","$status",533],["T_WHITESPACE"," ",533],["T_IS_EQUAL","==",533],["T_WHITESPACE"," ",533],["T_LNUMBER","400",533],["T_WHITESPACE"," ",533],["T_BOOLEAN_AND","&&",533],["T_WHITESPACE"," ",533],"!",["T_EMPTY","empty",533],"(",["T_VARIABLE","$body",533],")",")",")",["T_WHITESPACE"," ",533],"{",["T_WHITESPACE","\n            ",533],["T_RETURN","return",534],["T_WHITESPACE"," ",534],["T_VARIABLE","$body",534],";",["T_WHITESPACE","\n        ",534],"}",["T_ELSE","else",535],"{",["T_WHITESPACE","\n            ",535],["T_VARIABLE","$this",536],["T_OBJECT_OPERATOR","->",536],["T_STRING","_setError",536],"(",["T_CONSTANT_ENCAPSED_STRING","'Bad HTTP response'",536],")",";",["T_WHITESPACE","\n            ",536],["T_RETURN","return",537],["T_WHITESPACE"," ",537],["T_STRING","false",537],";",["T_WHITESPACE","\n        ",537],"}",["T_WHITESPACE","\n    ",538],"}",["T_WHITESPACE","\n\n    ",539],["T_DOC_COMMENT","\/**\n     * Create (or reuse existing) association between OpenID consumer and\n     * OpenID server based on Diffie-Hellman key agreement. Returns true\n     * on success and false on failure.\n     *\n     * @param string $url OpenID server url\n     * @param float $version OpenID protocol version\n     * @param string $priv_key for testing only\n     * @return bool\n     *\/",541],["T_WHITESPACE","\n    ",550],["T_PROTECTED","protected",551],["T_WHITESPACE"," ",551],["T_FUNCTION","function",551],["T_WHITESPACE"," ",551],["T_STRING","_associate",551],"(",["T_VARIABLE","$url",551],",",["T_WHITESPACE"," ",551],["T_VARIABLE","$version",551],",",["T_WHITESPACE"," ",551],["T_VARIABLE","$priv_key",551],"=",["T_STRING","null",551],")",["T_WHITESPACE","\n    ",551],"{",["T_WHITESPACE","\n\n        ",552],["T_COMMENT","\/* Check if we already have association in chace or storage *\/",554],["T_WHITESPACE","\n        ",554],["T_IF","if",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","_getAssociation",555],"(",["T_WHITESPACE","\n                ",555],["T_VARIABLE","$url",556],",",["T_WHITESPACE","\n                ",556],["T_VARIABLE","$handle",557],",",["T_WHITESPACE","\n                ",557],["T_VARIABLE","$macFunc",558],",",["T_WHITESPACE","\n                ",558],["T_VARIABLE","$secret",559],",",["T_WHITESPACE","\n                ",559],["T_VARIABLE","$expires",560],")",")",["T_WHITESPACE"," ",560],"{",["T_WHITESPACE","\n            ",560],["T_RETURN","return",561],["T_WHITESPACE"," ",561],["T_STRING","true",561],";",["T_WHITESPACE","\n        ",561],"}",["T_WHITESPACE","\n\n        ",562],["T_IF","if",564],["T_WHITESPACE"," ",564],"(",["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","_dumbMode",564],")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n            ",564],["T_COMMENT","\/* Use dumb mode *\/",565],["T_WHITESPACE","\n            ",565],["T_RETURN","return",566],["T_WHITESPACE"," ",566],["T_STRING","true",566],";",["T_WHITESPACE","\n        ",566],"}",["T_WHITESPACE","\n\n        ",567],["T_VARIABLE","$params",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_ARRAY","array",569],"(",")",";",["T_WHITESPACE","\n\n        ",569],["T_IF","if",571],["T_WHITESPACE"," ",571],"(",["T_VARIABLE","$version",571],["T_WHITESPACE"," ",571],["T_IS_GREATER_OR_EQUAL",">=",571],["T_WHITESPACE"," ",571],["T_DNUMBER","2.0",571],")",["T_WHITESPACE"," ",571],"{",["T_WHITESPACE","\n            ",571],["T_VARIABLE","$params",572],["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_ARRAY","array",572],"(",["T_WHITESPACE","\n                ",572],["T_CONSTANT_ENCAPSED_STRING","'openid.ns'",573],["T_WHITESPACE","           ",573],["T_DOUBLE_ARROW","=>",573],["T_WHITESPACE"," ",573],["T_STRING","Zend_OpenId",573],["T_DOUBLE_COLON","::",573],["T_STRING","NS_2_0",573],",",["T_WHITESPACE","\n                ",573],["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",574],["T_WHITESPACE","         ",574],["T_DOUBLE_ARROW","=>",574],["T_WHITESPACE"," ",574],["T_CONSTANT_ENCAPSED_STRING","'associate'",574],",",["T_WHITESPACE","\n                ",574],["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_type'",575],["T_WHITESPACE","   ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA256'",575],",",["T_WHITESPACE","\n                ",575],["T_CONSTANT_ENCAPSED_STRING","'openid.session_type'",576],["T_WHITESPACE"," ",576],["T_DOUBLE_ARROW","=>",576],["T_WHITESPACE"," ",576],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA256'",576],",",["T_WHITESPACE","\n            ",576],")",";",["T_WHITESPACE","\n        ",577],"}",["T_WHITESPACE"," ",578],["T_ELSE","else",578],["T_WHITESPACE"," ",578],"{",["T_WHITESPACE","\n            ",578],["T_VARIABLE","$params",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_ARRAY","array",579],"(",["T_WHITESPACE","\n                ",579],["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",580],["T_WHITESPACE","         ",580],["T_DOUBLE_ARROW","=>",580],["T_WHITESPACE"," ",580],["T_CONSTANT_ENCAPSED_STRING","'associate'",580],",",["T_WHITESPACE","\n                ",580],["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_type'",581],["T_WHITESPACE","   ",581],["T_DOUBLE_ARROW","=>",581],["T_WHITESPACE"," ",581],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA1'",581],",",["T_WHITESPACE","\n                ",581],["T_CONSTANT_ENCAPSED_STRING","'openid.session_type'",582],["T_WHITESPACE"," ",582],["T_DOUBLE_ARROW","=>",582],["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA1'",582],",",["T_WHITESPACE","\n            ",582],")",";",["T_WHITESPACE","\n        ",583],"}",["T_WHITESPACE","\n\n        ",584],["T_VARIABLE","$dh",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","Zend_OpenId",586],["T_DOUBLE_COLON","::",586],["T_STRING","createDhKey",586],"(",["T_STRING","pack",586],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",586],",",["T_WHITESPACE"," ",586],["T_STRING","Zend_OpenId",586],["T_DOUBLE_COLON","::",586],["T_STRING","DH_P",586],")",",",["T_WHITESPACE","\n                                       ",586],["T_STRING","pack",587],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",587],",",["T_WHITESPACE"," ",587],["T_STRING","Zend_OpenId",587],["T_DOUBLE_COLON","::",587],["T_STRING","DH_G",587],")",",",["T_WHITESPACE","\n                                       ",587],["T_VARIABLE","$priv_key",588],")",";",["T_WHITESPACE","\n        ",588],["T_VARIABLE","$dh_details",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_STRING","Zend_OpenId",589],["T_DOUBLE_COLON","::",589],["T_STRING","getDhKeyDetails",589],"(",["T_VARIABLE","$dh",589],")",";",["T_WHITESPACE","\n\n        ",589],["T_VARIABLE","$params",591],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.dh_modulus'",591],"]",["T_WHITESPACE","         ",591],"=",["T_WHITESPACE"," ",591],["T_STRING","base64_encode",591],"(",["T_WHITESPACE","\n            ",591],["T_STRING","Zend_OpenId",592],["T_DOUBLE_COLON","::",592],["T_STRING","btwoc",592],"(",["T_VARIABLE","$dh_details",592],"[",["T_CONSTANT_ENCAPSED_STRING","'p'",592],"]",")",")",";",["T_WHITESPACE","\n        ",592],["T_VARIABLE","$params",593],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.dh_gen'",593],"]",["T_WHITESPACE","             ",593],"=",["T_WHITESPACE"," ",593],["T_STRING","base64_encode",593],"(",["T_WHITESPACE","\n            ",593],["T_STRING","Zend_OpenId",594],["T_DOUBLE_COLON","::",594],["T_STRING","btwoc",594],"(",["T_VARIABLE","$dh_details",594],"[",["T_CONSTANT_ENCAPSED_STRING","'g'",594],"]",")",")",";",["T_WHITESPACE","\n        ",594],["T_VARIABLE","$params",595],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.dh_consumer_public'",595],"]",["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_STRING","base64_encode",595],"(",["T_WHITESPACE","\n            ",595],["T_STRING","Zend_OpenId",596],["T_DOUBLE_COLON","::",596],["T_STRING","btwoc",596],"(",["T_VARIABLE","$dh_details",596],"[",["T_CONSTANT_ENCAPSED_STRING","'pub_key'",596],"]",")",")",";",["T_WHITESPACE","\n\n        ",596],["T_WHILE","while",598],"(",["T_LNUMBER","1",598],")",["T_WHITESPACE"," ",598],"{",["T_WHITESPACE","\n            ",598],["T_VARIABLE","$ret",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_VARIABLE","$this",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","_httpRequest",599],"(",["T_VARIABLE","$url",599],",",["T_WHITESPACE"," ",599],["T_CONSTANT_ENCAPSED_STRING","'POST'",599],",",["T_WHITESPACE"," ",599],["T_VARIABLE","$params",599],",",["T_WHITESPACE"," ",599],["T_VARIABLE","$status",599],")",";",["T_WHITESPACE","\n            ",599],["T_IF","if",600],["T_WHITESPACE"," ",600],"(",["T_VARIABLE","$ret",600],["T_WHITESPACE"," ",600],["T_IS_IDENTICAL","===",600],["T_WHITESPACE"," ",600],["T_STRING","false",600],")",["T_WHITESPACE"," ",600],"{",["T_WHITESPACE","\n                ",600],["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","_setError",601],"(",["T_CONSTANT_ENCAPSED_STRING","\"HTTP request failed\"",601],")",";",["T_WHITESPACE","\n                ",601],["T_RETURN","return",602],["T_WHITESPACE"," ",602],["T_STRING","false",602],";",["T_WHITESPACE","\n            ",602],"}",["T_WHITESPACE","\n\n            ",603],["T_VARIABLE","$r",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_ARRAY","array",605],"(",")",";",["T_WHITESPACE","\n            ",605],["T_VARIABLE","$bad_response",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_STRING","false",606],";",["T_WHITESPACE","\n            ",606],["T_FOREACH","foreach",607],"(",["T_STRING","explode",607],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",607],",",["T_WHITESPACE"," ",607],["T_VARIABLE","$ret",607],")",["T_WHITESPACE"," ",607],["T_AS","as",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$line",607],")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n                ",607],["T_VARIABLE","$line",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_STRING","trim",608],"(",["T_VARIABLE","$line",608],")",";",["T_WHITESPACE","\n                ",608],["T_IF","if",609],["T_WHITESPACE"," ",609],"(","!",["T_EMPTY","empty",609],"(",["T_VARIABLE","$line",609],")",")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n                    ",609],["T_VARIABLE","$x",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_STRING","explode",610],"(",["T_CONSTANT_ENCAPSED_STRING","':'",610],",",["T_WHITESPACE"," ",610],["T_VARIABLE","$line",610],",",["T_WHITESPACE"," ",610],["T_LNUMBER","2",610],")",";",["T_WHITESPACE","\n                    ",610],["T_IF","if",611],["T_WHITESPACE"," ",611],"(",["T_STRING","is_array",611],"(",["T_VARIABLE","$x",611],")",["T_WHITESPACE"," ",611],["T_BOOLEAN_AND","&&",611],["T_WHITESPACE"," ",611],["T_STRING","count",611],"(",["T_VARIABLE","$x",611],")",["T_WHITESPACE"," ",611],["T_IS_EQUAL","==",611],["T_WHITESPACE"," ",611],["T_LNUMBER","2",611],")",["T_WHITESPACE"," ",611],"{",["T_WHITESPACE","\n                        ",611],["T_LIST","list",612],"(",["T_VARIABLE","$key",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$value",612],")",["T_WHITESPACE"," ",612],"=",["T_WHITESPACE"," ",612],["T_VARIABLE","$x",612],";",["T_WHITESPACE","\n                        ",612],["T_VARIABLE","$r",613],"[",["T_STRING","trim",613],"(",["T_VARIABLE","$key",613],")","]",["T_WHITESPACE"," ",613],"=",["T_WHITESPACE"," ",613],["T_STRING","trim",613],"(",["T_VARIABLE","$value",613],")",";",["T_WHITESPACE","\n                    ",613],"}",["T_WHITESPACE"," ",614],["T_ELSE","else",614],["T_WHITESPACE"," ",614],"{",["T_WHITESPACE","\n                        ",614],["T_VARIABLE","$bad_response",615],["T_WHITESPACE"," ",615],"=",["T_WHITESPACE"," ",615],["T_STRING","true",615],";",["T_WHITESPACE","\n                    ",615],"}",["T_WHITESPACE","\n                ",616],"}",["T_WHITESPACE","\n            ",617],"}",["T_WHITESPACE","\n            ",618],["T_IF","if",619],["T_WHITESPACE"," ",619],"(",["T_VARIABLE","$bad_response",619],["T_WHITESPACE"," ",619],["T_BOOLEAN_AND","&&",619],["T_WHITESPACE"," ",619],["T_STRING","strpos",619],"(",["T_VARIABLE","$ret",619],",",["T_WHITESPACE"," ",619],["T_CONSTANT_ENCAPSED_STRING","'Unknown session type'",619],")",["T_WHITESPACE"," ",619],["T_IS_NOT_IDENTICAL","!==",619],["T_WHITESPACE"," ",619],["T_STRING","false",619],")",["T_WHITESPACE"," ",619],"{",["T_WHITESPACE","\n                ",619],["T_VARIABLE","$r",620],"[",["T_CONSTANT_ENCAPSED_STRING","'error_code'",620],"]",["T_WHITESPACE"," ",620],"=",["T_WHITESPACE"," ",620],["T_CONSTANT_ENCAPSED_STRING","'unsupported-type'",620],";",["T_WHITESPACE","\n            ",620],"}",["T_WHITESPACE","\n            ",621],["T_VARIABLE","$ret",622],["T_WHITESPACE"," ",622],"=",["T_WHITESPACE"," ",622],["T_VARIABLE","$r",622],";",["T_WHITESPACE","\n\n            ",622],["T_IF","if",624],["T_WHITESPACE"," ",624],"(",["T_ISSET","isset",624],"(",["T_VARIABLE","$ret",624],"[",["T_CONSTANT_ENCAPSED_STRING","'error_code'",624],"]",")",["T_WHITESPACE"," ",624],["T_BOOLEAN_AND","&&",624],["T_WHITESPACE","\n                ",624],["T_VARIABLE","$ret",625],"[",["T_CONSTANT_ENCAPSED_STRING","'error_code'",625],"]",["T_WHITESPACE"," ",625],["T_IS_EQUAL","==",625],["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","'unsupported-type'",625],")",["T_WHITESPACE"," ",625],"{",["T_WHITESPACE","\n                ",625],["T_IF","if",626],["T_WHITESPACE"," ",626],"(",["T_VARIABLE","$params",626],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.session_type'",626],"]",["T_WHITESPACE"," ",626],["T_IS_EQUAL","==",626],["T_WHITESPACE"," ",626],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA256'",626],")",["T_WHITESPACE"," ",626],"{",["T_WHITESPACE","\n                    ",626],["T_VARIABLE","$params",627],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.session_type'",627],"]",["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA1'",627],";",["T_WHITESPACE","\n                    ",627],["T_VARIABLE","$params",628],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_type'",628],"]",["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA1'",628],";",["T_WHITESPACE","\n                ",628],"}",["T_WHITESPACE"," ",629],["T_ELSE","else",629],["T_WHITESPACE"," ",629],["T_IF","if",629],["T_WHITESPACE"," ",629],"(",["T_VARIABLE","$params",629],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.session_type'",629],"]",["T_WHITESPACE"," ",629],["T_IS_EQUAL","==",629],["T_WHITESPACE"," ",629],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA1'",629],")",["T_WHITESPACE"," ",629],"{",["T_WHITESPACE","\n                    ",629],["T_VARIABLE","$params",630],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.session_type'",630],"]",["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_CONSTANT_ENCAPSED_STRING","'no-encryption'",630],";",["T_WHITESPACE","\n                ",630],"}",["T_WHITESPACE"," ",631],["T_ELSE","else",631],["T_WHITESPACE"," ",631],"{",["T_WHITESPACE","\n                    ",631],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","_setError",632],"(",["T_CONSTANT_ENCAPSED_STRING","\"The OpenID service responded with: \"",632],["T_WHITESPACE"," ",632],".",["T_WHITESPACE"," ",632],["T_VARIABLE","$ret",632],"[",["T_CONSTANT_ENCAPSED_STRING","'error_code'",632],"]",")",";",["T_WHITESPACE","\n                    ",632],["T_RETURN","return",633],["T_WHITESPACE"," ",633],["T_STRING","false",633],";",["T_WHITESPACE","\n                ",633],"}",["T_WHITESPACE","\n            ",634],"}",["T_WHITESPACE"," ",635],["T_ELSE","else",635],["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n                ",635],["T_BREAK","break",636],";",["T_WHITESPACE","\n            ",636],"}",["T_WHITESPACE","\n        ",637],"}",["T_WHITESPACE","\n\n        ",638],["T_IF","if",640],["T_WHITESPACE"," ",640],"(",["T_VARIABLE","$status",640],["T_WHITESPACE"," ",640],["T_IS_NOT_EQUAL","!=",640],["T_WHITESPACE"," ",640],["T_LNUMBER","200",640],")",["T_WHITESPACE"," ",640],"{",["T_WHITESPACE","\n            ",640],["T_VARIABLE","$this",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","_setError",641],"(",["T_CONSTANT_ENCAPSED_STRING","\"The server responded with status code: \"",641],["T_WHITESPACE"," ",641],".",["T_WHITESPACE"," ",641],["T_VARIABLE","$status",641],")",";",["T_WHITESPACE","\n            ",641],["T_RETURN","return",642],["T_WHITESPACE"," ",642],["T_STRING","false",642],";",["T_WHITESPACE","\n        ",642],"}",["T_WHITESPACE","\n\n        ",643],["T_IF","if",645],["T_WHITESPACE"," ",645],"(",["T_VARIABLE","$version",645],["T_WHITESPACE"," ",645],["T_IS_GREATER_OR_EQUAL",">=",645],["T_WHITESPACE"," ",645],["T_DNUMBER","2.0",645],["T_WHITESPACE"," ",645],["T_BOOLEAN_AND","&&",645],["T_WHITESPACE","\n            ",645],["T_ISSET","isset",646],"(",["T_VARIABLE","$ret",646],"[",["T_CONSTANT_ENCAPSED_STRING","'ns'",646],"]",")",["T_WHITESPACE"," ",646],["T_BOOLEAN_AND","&&",646],["T_WHITESPACE","\n            ",646],["T_VARIABLE","$ret",647],"[",["T_CONSTANT_ENCAPSED_STRING","'ns'",647],"]",["T_WHITESPACE"," ",647],["T_IS_NOT_EQUAL","!=",647],["T_WHITESPACE"," ",647],["T_STRING","Zend_OpenId",647],["T_DOUBLE_COLON","::",647],["T_STRING","NS_2_0",647],")",["T_WHITESPACE"," ",647],"{",["T_WHITESPACE","\n            ",647],["T_VARIABLE","$this",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","_setError",648],"(",["T_CONSTANT_ENCAPSED_STRING","\"Wrong namespace definition in the server response\"",648],")",";",["T_WHITESPACE","\n            ",648],["T_RETURN","return",649],["T_WHITESPACE"," ",649],["T_STRING","false",649],";",["T_WHITESPACE","\n        ",649],"}",["T_WHITESPACE","\n\n        ",650],["T_IF","if",652],["T_WHITESPACE"," ",652],"(","!",["T_ISSET","isset",652],"(",["T_VARIABLE","$ret",652],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_handle'",652],"]",")",["T_WHITESPACE"," ",652],["T_BOOLEAN_OR","||",652],["T_WHITESPACE","\n            ",652],"!",["T_ISSET","isset",653],"(",["T_VARIABLE","$ret",653],"[",["T_CONSTANT_ENCAPSED_STRING","'expires_in'",653],"]",")",["T_WHITESPACE"," ",653],["T_BOOLEAN_OR","||",653],["T_WHITESPACE","\n            ",653],"!",["T_ISSET","isset",654],"(",["T_VARIABLE","$ret",654],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_type'",654],"]",")",["T_WHITESPACE"," ",654],["T_BOOLEAN_OR","||",654],["T_WHITESPACE","\n            ",654],["T_VARIABLE","$params",655],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_type'",655],"]",["T_WHITESPACE"," ",655],["T_IS_NOT_EQUAL","!=",655],["T_WHITESPACE"," ",655],["T_VARIABLE","$ret",655],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_type'",655],"]",")",["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n            ",655],["T_IF","if",656],["T_WHITESPACE"," ",656],"(",["T_VARIABLE","$params",656],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_type'",656],"]",["T_WHITESPACE"," ",656],["T_IS_NOT_EQUAL","!=",656],["T_WHITESPACE"," ",656],["T_VARIABLE","$ret",656],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_type'",656],"]",")",["T_WHITESPACE"," ",656],"{",["T_WHITESPACE","\n                ",656],["T_VARIABLE","$this",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","_setError",657],"(",["T_CONSTANT_ENCAPSED_STRING","\"The returned assoc_type differed from the supplied openid.assoc_type\"",657],")",";",["T_WHITESPACE","\n            ",657],"}",["T_WHITESPACE"," ",658],["T_ELSE","else",658],["T_WHITESPACE"," ",658],"{",["T_WHITESPACE","\n                ",658],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","_setError",659],"(",["T_CONSTANT_ENCAPSED_STRING","\"Missing required data from provider (assoc_handle, expires_in, assoc_type are required)\"",659],")",";",["T_WHITESPACE","\n            ",659],"}",["T_WHITESPACE","\n            ",660],["T_RETURN","return",661],["T_WHITESPACE"," ",661],["T_STRING","false",661],";",["T_WHITESPACE","\n        ",661],"}",["T_WHITESPACE","\n\n        ",662],["T_VARIABLE","$handle",664],["T_WHITESPACE","     ",664],"=",["T_WHITESPACE"," ",664],["T_VARIABLE","$ret",664],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_handle'",664],"]",";",["T_WHITESPACE","\n        ",664],["T_VARIABLE","$expiresIn",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_VARIABLE","$ret",665],"[",["T_CONSTANT_ENCAPSED_STRING","'expires_in'",665],"]",";",["T_WHITESPACE","\n\n        ",665],["T_IF","if",667],["T_WHITESPACE"," ",667],"(",["T_VARIABLE","$ret",667],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_type'",667],"]",["T_WHITESPACE"," ",667],["T_IS_EQUAL","==",667],["T_WHITESPACE"," ",667],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA1'",667],")",["T_WHITESPACE"," ",667],"{",["T_WHITESPACE","\n            ",667],["T_VARIABLE","$macFunc",668],["T_WHITESPACE"," ",668],"=",["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'sha1'",668],";",["T_WHITESPACE","\n        ",668],"}",["T_WHITESPACE"," ",669],["T_ELSE","else",669],["T_WHITESPACE"," ",669],["T_IF","if",669],["T_WHITESPACE"," ",669],"(",["T_VARIABLE","$ret",669],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_type'",669],"]",["T_WHITESPACE"," ",669],["T_IS_EQUAL","==",669],["T_WHITESPACE"," ",669],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA256'",669],["T_WHITESPACE"," ",669],["T_BOOLEAN_AND","&&",669],["T_WHITESPACE","\n            ",669],["T_VARIABLE","$version",670],["T_WHITESPACE"," ",670],["T_IS_GREATER_OR_EQUAL",">=",670],["T_WHITESPACE"," ",670],["T_DNUMBER","2.0",670],")",["T_WHITESPACE"," ",670],"{",["T_WHITESPACE","\n            ",670],["T_VARIABLE","$macFunc",671],["T_WHITESPACE"," ",671],"=",["T_WHITESPACE"," ",671],["T_CONSTANT_ENCAPSED_STRING","'sha256'",671],";",["T_WHITESPACE","\n        ",671],"}",["T_WHITESPACE"," ",672],["T_ELSE","else",672],["T_WHITESPACE"," ",672],"{",["T_WHITESPACE","\n            ",672],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","_setError",673],"(",["T_CONSTANT_ENCAPSED_STRING","\"Unsupported assoc_type\"",673],")",";",["T_WHITESPACE","\n            ",673],["T_RETURN","return",674],["T_WHITESPACE"," ",674],["T_STRING","false",674],";",["T_WHITESPACE","\n        ",674],"}",["T_WHITESPACE","\n\n        ",675],["T_IF","if",677],["T_WHITESPACE"," ",677],"(","(",["T_EMPTY","empty",677],"(",["T_VARIABLE","$ret",677],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",677],"]",")",["T_WHITESPACE"," ",677],["T_BOOLEAN_OR","||",677],["T_WHITESPACE","\n             ",677],"(",["T_VARIABLE","$version",678],["T_WHITESPACE"," ",678],["T_IS_GREATER_OR_EQUAL",">=",678],["T_WHITESPACE"," ",678],["T_DNUMBER","2.0",678],["T_WHITESPACE"," ",678],["T_BOOLEAN_AND","&&",678],["T_WHITESPACE"," ",678],["T_VARIABLE","$ret",678],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",678],"]",["T_WHITESPACE"," ",678],["T_IS_EQUAL","==",678],["T_WHITESPACE"," ",678],["T_CONSTANT_ENCAPSED_STRING","'no-encryption'",678],")",")",["T_WHITESPACE"," ",678],["T_BOOLEAN_AND","&&",678],["T_WHITESPACE","\n             ",678],["T_ISSET","isset",679],"(",["T_VARIABLE","$ret",679],"[",["T_CONSTANT_ENCAPSED_STRING","'mac_key'",679],"]",")",")",["T_WHITESPACE"," ",679],"{",["T_WHITESPACE","\n            ",679],["T_VARIABLE","$secret",680],["T_WHITESPACE"," ",680],"=",["T_WHITESPACE"," ",680],["T_STRING","base64_decode",680],"(",["T_VARIABLE","$ret",680],"[",["T_CONSTANT_ENCAPSED_STRING","'mac_key'",680],"]",")",";",["T_WHITESPACE","\n        ",680],"}",["T_WHITESPACE"," ",681],["T_ELSE","else",681],["T_WHITESPACE"," ",681],["T_IF","if",681],["T_WHITESPACE"," ",681],"(",["T_ISSET","isset",681],"(",["T_VARIABLE","$ret",681],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",681],"]",")",["T_WHITESPACE"," ",681],["T_BOOLEAN_AND","&&",681],["T_WHITESPACE","\n            ",681],["T_VARIABLE","$ret",682],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",682],"]",["T_WHITESPACE"," ",682],["T_IS_EQUAL","==",682],["T_WHITESPACE"," ",682],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA1'",682],["T_WHITESPACE"," ",682],["T_BOOLEAN_AND","&&",682],["T_WHITESPACE","\n            ",682],"!",["T_EMPTY","empty",683],"(",["T_VARIABLE","$ret",683],"[",["T_CONSTANT_ENCAPSED_STRING","'dh_server_public'",683],"]",")",["T_WHITESPACE"," ",683],["T_BOOLEAN_AND","&&",683],["T_WHITESPACE","\n            ",683],"!",["T_EMPTY","empty",684],"(",["T_VARIABLE","$ret",684],"[",["T_CONSTANT_ENCAPSED_STRING","'enc_mac_key'",684],"]",")",")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n            ",684],["T_VARIABLE","$dhFunc",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_CONSTANT_ENCAPSED_STRING","'sha1'",685],";",["T_WHITESPACE","\n        ",685],"}",["T_WHITESPACE"," ",686],["T_ELSE","else",686],["T_WHITESPACE"," ",686],["T_IF","if",686],["T_WHITESPACE"," ",686],"(",["T_ISSET","isset",686],"(",["T_VARIABLE","$ret",686],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",686],"]",")",["T_WHITESPACE"," ",686],["T_BOOLEAN_AND","&&",686],["T_WHITESPACE","\n            ",686],["T_VARIABLE","$ret",687],"[",["T_CONSTANT_ENCAPSED_STRING","'session_type'",687],"]",["T_WHITESPACE"," ",687],["T_IS_EQUAL","==",687],["T_WHITESPACE"," ",687],["T_CONSTANT_ENCAPSED_STRING","'DH-SHA256'",687],["T_WHITESPACE"," ",687],["T_BOOLEAN_AND","&&",687],["T_WHITESPACE","\n            ",687],["T_VARIABLE","$version",688],["T_WHITESPACE"," ",688],["T_IS_GREATER_OR_EQUAL",">=",688],["T_WHITESPACE"," ",688],["T_DNUMBER","2.0",688],["T_WHITESPACE"," ",688],["T_BOOLEAN_AND","&&",688],["T_WHITESPACE","\n            ",688],"!",["T_EMPTY","empty",689],"(",["T_VARIABLE","$ret",689],"[",["T_CONSTANT_ENCAPSED_STRING","'dh_server_public'",689],"]",")",["T_WHITESPACE"," ",689],["T_BOOLEAN_AND","&&",689],["T_WHITESPACE","\n            ",689],"!",["T_EMPTY","empty",690],"(",["T_VARIABLE","$ret",690],"[",["T_CONSTANT_ENCAPSED_STRING","'enc_mac_key'",690],"]",")",")",["T_WHITESPACE"," ",690],"{",["T_WHITESPACE","\n            ",690],["T_VARIABLE","$dhFunc",691],["T_WHITESPACE"," ",691],"=",["T_WHITESPACE"," ",691],["T_CONSTANT_ENCAPSED_STRING","'sha256'",691],";",["T_WHITESPACE","\n        ",691],"}",["T_WHITESPACE"," ",692],["T_ELSE","else",692],["T_WHITESPACE"," ",692],"{",["T_WHITESPACE","\n            ",692],["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","_setError",693],"(",["T_CONSTANT_ENCAPSED_STRING","\"Unsupported session_type\"",693],")",";",["T_WHITESPACE","\n            ",693],["T_RETURN","return",694],["T_WHITESPACE"," ",694],["T_STRING","false",694],";",["T_WHITESPACE","\n        ",694],"}",["T_WHITESPACE","\n        ",695],["T_IF","if",696],["T_WHITESPACE"," ",696],"(",["T_ISSET","isset",696],"(",["T_VARIABLE","$dhFunc",696],")",")",["T_WHITESPACE"," ",696],"{",["T_WHITESPACE","\n            ",696],["T_VARIABLE","$serverPub",697],["T_WHITESPACE"," ",697],"=",["T_WHITESPACE"," ",697],["T_STRING","base64_decode",697],"(",["T_VARIABLE","$ret",697],"[",["T_CONSTANT_ENCAPSED_STRING","'dh_server_public'",697],"]",")",";",["T_WHITESPACE","\n            ",697],["T_VARIABLE","$dhSec",698],["T_WHITESPACE"," ",698],"=",["T_WHITESPACE"," ",698],["T_STRING","Zend_OpenId",698],["T_DOUBLE_COLON","::",698],["T_STRING","computeDhSecret",698],"(",["T_VARIABLE","$serverPub",698],",",["T_WHITESPACE"," ",698],["T_VARIABLE","$dh",698],")",";",["T_WHITESPACE","\n            ",698],["T_IF","if",699],["T_WHITESPACE"," ",699],"(",["T_VARIABLE","$dhSec",699],["T_WHITESPACE"," ",699],["T_IS_IDENTICAL","===",699],["T_WHITESPACE"," ",699],["T_STRING","false",699],")",["T_WHITESPACE"," ",699],"{",["T_WHITESPACE","\n                ",699],["T_VARIABLE","$this",700],["T_OBJECT_OPERATOR","->",700],["T_STRING","_setError",700],"(",["T_CONSTANT_ENCAPSED_STRING","\"DH secret comutation failed\"",700],")",";",["T_WHITESPACE","\n                ",700],["T_RETURN","return",701],["T_WHITESPACE"," ",701],["T_STRING","false",701],";",["T_WHITESPACE","\n            ",701],"}",["T_WHITESPACE","\n            ",702],["T_VARIABLE","$sec",703],["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_STRING","Zend_OpenId",703],["T_DOUBLE_COLON","::",703],["T_STRING","digest",703],"(",["T_VARIABLE","$dhFunc",703],",",["T_WHITESPACE"," ",703],["T_VARIABLE","$dhSec",703],")",";",["T_WHITESPACE","\n            ",703],["T_IF","if",704],["T_WHITESPACE"," ",704],"(",["T_VARIABLE","$sec",704],["T_WHITESPACE"," ",704],["T_IS_IDENTICAL","===",704],["T_WHITESPACE"," ",704],["T_STRING","false",704],")",["T_WHITESPACE"," ",704],"{",["T_WHITESPACE","\n                ",704],["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","_setError",705],"(",["T_CONSTANT_ENCAPSED_STRING","\"Could not create digest\"",705],")",";",["T_WHITESPACE","\n                ",705],["T_RETURN","return",706],["T_WHITESPACE"," ",706],["T_STRING","false",706],";",["T_WHITESPACE","\n            ",706],"}",["T_WHITESPACE","\n            ",707],["T_VARIABLE","$secret",708],["T_WHITESPACE"," ",708],"=",["T_WHITESPACE"," ",708],["T_VARIABLE","$sec",708],["T_WHITESPACE"," ",708],"^",["T_WHITESPACE"," ",708],["T_STRING","base64_decode",708],"(",["T_VARIABLE","$ret",708],"[",["T_CONSTANT_ENCAPSED_STRING","'enc_mac_key'",708],"]",")",";",["T_WHITESPACE","\n        ",708],"}",["T_WHITESPACE","\n        ",709],["T_IF","if",710],["T_WHITESPACE"," ",710],"(",["T_VARIABLE","$macFunc",710],["T_WHITESPACE"," ",710],["T_IS_EQUAL","==",710],["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'sha1'",710],")",["T_WHITESPACE"," ",710],"{",["T_WHITESPACE","\n            ",710],["T_IF","if",711],["T_WHITESPACE"," ",711],"(",["T_STRING","Zend_OpenId",711],["T_DOUBLE_COLON","::",711],["T_STRING","strlen",711],"(",["T_VARIABLE","$secret",711],")",["T_WHITESPACE"," ",711],["T_IS_NOT_EQUAL","!=",711],["T_WHITESPACE"," ",711],["T_LNUMBER","20",711],")",["T_WHITESPACE"," ",711],"{",["T_WHITESPACE","\n                ",711],["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","_setError",712],"(",["T_CONSTANT_ENCAPSED_STRING","\"The length of the sha1 secret must be 20\"",712],")",";",["T_WHITESPACE","\n                ",712],["T_RETURN","return",713],["T_WHITESPACE"," ",713],["T_STRING","false",713],";",["T_WHITESPACE","\n            ",713],"}",["T_WHITESPACE","\n        ",714],"}",["T_WHITESPACE"," ",715],["T_ELSE","else",715],["T_WHITESPACE"," ",715],["T_IF","if",715],["T_WHITESPACE"," ",715],"(",["T_VARIABLE","$macFunc",715],["T_WHITESPACE"," ",715],["T_IS_EQUAL","==",715],["T_WHITESPACE"," ",715],["T_CONSTANT_ENCAPSED_STRING","'sha256'",715],")",["T_WHITESPACE"," ",715],"{",["T_WHITESPACE","\n            ",715],["T_IF","if",716],["T_WHITESPACE"," ",716],"(",["T_STRING","Zend_OpenId",716],["T_DOUBLE_COLON","::",716],["T_STRING","strlen",716],"(",["T_VARIABLE","$secret",716],")",["T_WHITESPACE"," ",716],["T_IS_NOT_EQUAL","!=",716],["T_WHITESPACE"," ",716],["T_LNUMBER","32",716],")",["T_WHITESPACE"," ",716],"{",["T_WHITESPACE","\n                ",716],["T_VARIABLE","$this",717],["T_OBJECT_OPERATOR","->",717],["T_STRING","_setError",717],"(",["T_CONSTANT_ENCAPSED_STRING","\"The length of the sha256 secret must be 32\"",717],")",";",["T_WHITESPACE","\n                ",717],["T_RETURN","return",718],["T_WHITESPACE"," ",718],["T_STRING","false",718],";",["T_WHITESPACE","\n            ",718],"}",["T_WHITESPACE","\n        ",719],"}",["T_WHITESPACE","\n        ",720],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","_addAssociation",721],"(",["T_WHITESPACE","\n            ",721],["T_VARIABLE","$url",722],",",["T_WHITESPACE","\n            ",722],["T_VARIABLE","$handle",723],",",["T_WHITESPACE","\n            ",723],["T_VARIABLE","$macFunc",724],",",["T_WHITESPACE","\n            ",724],["T_VARIABLE","$secret",725],",",["T_WHITESPACE","\n            ",725],["T_STRING","time",726],"(",")",["T_WHITESPACE"," ",726],"+",["T_WHITESPACE"," ",726],["T_VARIABLE","$expiresIn",726],")",";",["T_WHITESPACE","\n        ",726],["T_RETURN","return",727],["T_WHITESPACE"," ",727],["T_STRING","true",727],";",["T_WHITESPACE","\n    ",727],"}",["T_WHITESPACE","\n\n    ",728],["T_DOC_COMMENT","\/**\n     * Performs discovery of identity and finds OpenID URL, OpenID server URL\n     * and OpenID protocol version. Returns true on succees and false on\n     * failure.\n     *\n     * @param string &$id OpenID identity URL\n     * @param string &$server OpenID server URL\n     * @param float &$version OpenID protocol version\n     * @return bool\n     * @todo OpenID 2.0 (7.3) XRI and Yadis discovery\n     *\/",730],["T_WHITESPACE","\n    ",740],["T_PROTECTED","protected",741],["T_WHITESPACE"," ",741],["T_FUNCTION","function",741],["T_WHITESPACE"," ",741],["T_STRING","_discovery",741],"(","&",["T_VARIABLE","$id",741],",",["T_WHITESPACE"," ",741],"&",["T_VARIABLE","$server",741],",",["T_WHITESPACE"," ",741],"&",["T_VARIABLE","$version",741],")",["T_WHITESPACE","\n    ",741],"{",["T_WHITESPACE","\n        ",742],["T_VARIABLE","$realId",743],["T_WHITESPACE"," ",743],"=",["T_WHITESPACE"," ",743],["T_VARIABLE","$id",743],";",["T_WHITESPACE","\n        ",743],["T_IF","if",744],["T_WHITESPACE"," ",744],"(",["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","_storage",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","getDiscoveryInfo",744],"(",["T_WHITESPACE","\n                ",744],["T_VARIABLE","$id",745],",",["T_WHITESPACE","\n                ",745],["T_VARIABLE","$realId",746],",",["T_WHITESPACE","\n                ",746],["T_VARIABLE","$server",747],",",["T_WHITESPACE","\n                ",747],["T_VARIABLE","$version",748],",",["T_WHITESPACE","\n                ",748],["T_VARIABLE","$expire",749],")",")",["T_WHITESPACE"," ",749],"{",["T_WHITESPACE","\n            ",749],["T_VARIABLE","$id",750],["T_WHITESPACE"," ",750],"=",["T_WHITESPACE"," ",750],["T_VARIABLE","$realId",750],";",["T_WHITESPACE","\n            ",750],["T_RETURN","return",751],["T_WHITESPACE"," ",751],["T_STRING","true",751],";",["T_WHITESPACE","\n        ",751],"}",["T_WHITESPACE","\n\n        ",752],["T_VARIABLE","$response",754],["T_WHITESPACE"," ",754],"=",["T_WHITESPACE"," ",754],["T_VARIABLE","$this",754],["T_OBJECT_OPERATOR","->",754],["T_STRING","_httpRequest",754],"(",["T_VARIABLE","$id",754],",",["T_WHITESPACE"," ",754],["T_CONSTANT_ENCAPSED_STRING","'GET'",754],",",["T_WHITESPACE"," ",754],["T_ARRAY","array",754],"(",")",",",["T_WHITESPACE"," ",754],["T_VARIABLE","$status",754],")",";",["T_WHITESPACE","\n        ",754],["T_IF","if",755],["T_WHITESPACE"," ",755],"(",["T_VARIABLE","$status",755],["T_WHITESPACE"," ",755],["T_IS_NOT_EQUAL","!=",755],["T_WHITESPACE"," ",755],["T_LNUMBER","200",755],["T_WHITESPACE"," ",755],["T_BOOLEAN_OR","||",755],["T_WHITESPACE"," ",755],"!",["T_STRING","is_string",755],"(",["T_VARIABLE","$response",755],")",")",["T_WHITESPACE"," ",755],"{",["T_WHITESPACE","\n            ",755],["T_RETURN","return",756],["T_WHITESPACE"," ",756],["T_STRING","false",756],";",["T_WHITESPACE","\n        ",756],"}",["T_WHITESPACE","\n\n        ",757],["T_COMMENT","\/* OpenID 2.0 (7.3) XRI and Yadis discovery *\/",759],["T_WHITESPACE","\n        ",759],["T_IF","if",760],["T_WHITESPACE"," ",760],"(",["T_STRING","preg_match",760],"(",["T_WHITESPACE","\n                ",760],["T_CONSTANT_ENCAPSED_STRING","'\/<meta[^>]*http-equiv=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?X-XRDS-Location[ \\t]*[^\"\\']*\\\\1[^>]*content=([\"\\'])([^\"\\']+)\\\\2[^>]*\\\/?>\/i'",761],",",["T_WHITESPACE","\n                ",761],["T_VARIABLE","$response",762],",",["T_WHITESPACE","\n                ",762],["T_VARIABLE","$r",763],")",")",["T_WHITESPACE"," ",763],"{",["T_WHITESPACE","\n            ",763],["T_VARIABLE","$XRDS",764],["T_WHITESPACE"," ",764],"=",["T_WHITESPACE"," ",764],["T_VARIABLE","$r",764],"[",["T_LNUMBER","3",764],"]",";",["T_WHITESPACE","\n            ",764],["T_VARIABLE","$version",765],["T_WHITESPACE"," ",765],"=",["T_WHITESPACE"," ",765],["T_DNUMBER","2.0",765],";",["T_WHITESPACE","\n            ",765],["T_VARIABLE","$response",766],["T_WHITESPACE"," ",766],"=",["T_WHITESPACE"," ",766],["T_VARIABLE","$this",766],["T_OBJECT_OPERATOR","->",766],["T_STRING","_httpRequest",766],"(",["T_VARIABLE","$XRDS",766],")",";",["T_WHITESPACE"," \n            ",766],["T_IF","if",767],["T_WHITESPACE"," ",767],"(",["T_STRING","preg_match",767],"(",["T_WHITESPACE","\n                    ",767],["T_CONSTANT_ENCAPSED_STRING","'\/<URI>([^\\t]*)<\\\/URI>\/i'",768],",",["T_WHITESPACE","\n                    ",768],["T_VARIABLE","$response",769],",",["T_WHITESPACE","\n                    ",769],["T_VARIABLE","$x",770],")",")",["T_WHITESPACE"," ",770],"{",["T_WHITESPACE","\n                ",770],["T_VARIABLE","$server",771],["T_WHITESPACE"," ",771],"=",["T_WHITESPACE"," ",771],["T_VARIABLE","$x",771],"[",["T_LNUMBER","1",771],"]",";",["T_WHITESPACE","\n                ",771],["T_COMMENT","\/\/ $realId \n",772],["T_WHITESPACE","                ",773],["T_VARIABLE","$realId",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select'",773],";",["T_WHITESPACE","\n            ",773],"}",["T_WHITESPACE","\n            ",774],["T_ELSE","else",775],["T_WHITESPACE"," ",775],"{",["T_WHITESPACE","\n                ",775],["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","_setError",776],"(",["T_CONSTANT_ENCAPSED_STRING","\"Unable to get URI for XRDS discovery\"",776],")",";",["T_WHITESPACE","\n            ",776],"}",["T_WHITESPACE","\n        ",777],"}",["T_WHITESPACE","\n\n        ",778],["T_COMMENT","\/* HTML-based discovery *\/",780],["T_WHITESPACE","\n        ",780],["T_ELSE","else",781],["T_WHITESPACE"," ",781],["T_IF","if",781],["T_WHITESPACE"," ",781],"(",["T_STRING","preg_match",781],"(",["T_WHITESPACE","\n                ",781],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid2.provider[ \\t]*[^\"\\']*\\\\1[^>]*href=([\"\\'])([^\"\\']+)\\\\2[^>]*\\\/?>\/i'",782],",",["T_WHITESPACE","\n                ",782],["T_VARIABLE","$response",783],",",["T_WHITESPACE","\n                ",783],["T_VARIABLE","$r",784],")",")",["T_WHITESPACE"," ",784],"{",["T_WHITESPACE","\n            ",784],["T_VARIABLE","$version",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_DNUMBER","2.0",785],";",["T_WHITESPACE","\n            ",785],["T_VARIABLE","$server",786],["T_WHITESPACE"," ",786],"=",["T_WHITESPACE"," ",786],["T_VARIABLE","$r",786],"[",["T_LNUMBER","3",786],"]",";",["T_WHITESPACE","\n        ",786],"}",["T_WHITESPACE"," ",787],["T_ELSE","else",787],["T_WHITESPACE"," ",787],["T_IF","if",787],["T_WHITESPACE"," ",787],"(",["T_STRING","preg_match",787],"(",["T_WHITESPACE","\n                ",787],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*href=([\"\\'])([^\"\\']+)\\\\1[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid2.provider[ \\t]*[^\"\\']*\\\\3[^>]*\\\/?>\/i'",788],",",["T_WHITESPACE","\n                ",788],["T_VARIABLE","$response",789],",",["T_WHITESPACE","\n                ",789],["T_VARIABLE","$r",790],")",")",["T_WHITESPACE"," ",790],"{",["T_WHITESPACE","\n            ",790],["T_VARIABLE","$version",791],["T_WHITESPACE"," ",791],"=",["T_WHITESPACE"," ",791],["T_DNUMBER","2.0",791],";",["T_WHITESPACE","\n            ",791],["T_VARIABLE","$server",792],["T_WHITESPACE"," ",792],"=",["T_WHITESPACE"," ",792],["T_VARIABLE","$r",792],"[",["T_LNUMBER","2",792],"]",";",["T_WHITESPACE","\n        ",792],"}",["T_WHITESPACE"," ",793],["T_ELSE","else",793],["T_WHITESPACE"," ",793],["T_IF","if",793],["T_WHITESPACE"," ",793],"(",["T_STRING","preg_match",793],"(",["T_WHITESPACE","\n                ",793],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid.server[ \\t]*[^\"\\']*\\\\1[^>]*href=([\"\\'])([^\"\\']+)\\\\2[^>]*\\\/?>\/i'",794],",",["T_WHITESPACE","\n                ",794],["T_VARIABLE","$response",795],",",["T_WHITESPACE","\n                ",795],["T_VARIABLE","$r",796],")",")",["T_WHITESPACE"," ",796],"{",["T_WHITESPACE","\n            ",796],["T_VARIABLE","$version",797],["T_WHITESPACE"," ",797],"=",["T_WHITESPACE"," ",797],["T_DNUMBER","1.1",797],";",["T_WHITESPACE","\n            ",797],["T_VARIABLE","$server",798],["T_WHITESPACE"," ",798],"=",["T_WHITESPACE"," ",798],["T_VARIABLE","$r",798],"[",["T_LNUMBER","3",798],"]",";",["T_WHITESPACE","\n        ",798],"}",["T_WHITESPACE"," ",799],["T_ELSE","else",799],["T_WHITESPACE"," ",799],["T_IF","if",799],["T_WHITESPACE"," ",799],"(",["T_STRING","preg_match",799],"(",["T_WHITESPACE","\n                ",799],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*href=([\"\\'])([^\"\\']+)\\\\1[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid.server[ \\t]*[^\"\\']*\\\\3[^>]*\\\/?>\/i'",800],",",["T_WHITESPACE","\n                ",800],["T_VARIABLE","$response",801],",",["T_WHITESPACE","\n                ",801],["T_VARIABLE","$r",802],")",")",["T_WHITESPACE"," ",802],"{",["T_WHITESPACE","\n            ",802],["T_VARIABLE","$version",803],["T_WHITESPACE"," ",803],"=",["T_WHITESPACE"," ",803],["T_DNUMBER","1.1",803],";",["T_WHITESPACE","\n            ",803],["T_VARIABLE","$server",804],["T_WHITESPACE"," ",804],"=",["T_WHITESPACE"," ",804],["T_VARIABLE","$r",804],"[",["T_LNUMBER","2",804],"]",";",["T_WHITESPACE","\n        ",804],"}",["T_WHITESPACE"," ",805],["T_ELSE","else",805],["T_WHITESPACE"," ",805],"{",["T_WHITESPACE","\n            ",805],["T_RETURN","return",806],["T_WHITESPACE"," ",806],["T_STRING","false",806],";",["T_WHITESPACE","\n        ",806],"}",["T_WHITESPACE","\n        ",807],["T_IF","if",808],["T_WHITESPACE"," ",808],"(",["T_VARIABLE","$version",808],["T_WHITESPACE"," ",808],["T_IS_GREATER_OR_EQUAL",">=",808],["T_WHITESPACE"," ",808],["T_DNUMBER","2.0",808],")",["T_WHITESPACE"," ",808],"{",["T_WHITESPACE","\n            ",808],["T_IF","if",809],["T_WHITESPACE"," ",809],"(",["T_STRING","preg_match",809],"(",["T_WHITESPACE","\n                    ",809],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid2.local_id[ \\t]*[^\"\\']*\\\\1[^>]*href=([\"\\'])([^\"\\']+)\\\\2[^>]*\\\/?>\/i'",810],",",["T_WHITESPACE","\n                    ",810],["T_VARIABLE","$response",811],",",["T_WHITESPACE","\n                    ",811],["T_VARIABLE","$r",812],")",")",["T_WHITESPACE"," ",812],"{",["T_WHITESPACE","\n                ",812],["T_VARIABLE","$realId",813],["T_WHITESPACE"," ",813],"=",["T_WHITESPACE"," ",813],["T_VARIABLE","$r",813],"[",["T_LNUMBER","3",813],"]",";",["T_WHITESPACE","\n            ",813],"}",["T_WHITESPACE"," ",814],["T_ELSE","else",814],["T_WHITESPACE"," ",814],["T_IF","if",814],["T_WHITESPACE"," ",814],"(",["T_STRING","preg_match",814],"(",["T_WHITESPACE","\n                    ",814],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*href=([\"\\'])([^\"\\']+)\\\\1[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid2.local_id[ \\t]*[^\"\\']*\\\\3[^>]*\\\/?>\/i'",815],",",["T_WHITESPACE","\n                    ",815],["T_VARIABLE","$response",816],",",["T_WHITESPACE","\n                    ",816],["T_VARIABLE","$r",817],")",")",["T_WHITESPACE"," ",817],"{",["T_WHITESPACE","\n                ",817],["T_VARIABLE","$realId",818],["T_WHITESPACE"," ",818],"=",["T_WHITESPACE"," ",818],["T_VARIABLE","$r",818],"[",["T_LNUMBER","2",818],"]",";",["T_WHITESPACE","\n            ",818],"}",["T_WHITESPACE","\n        ",819],"}",["T_WHITESPACE"," ",820],["T_ELSE","else",820],["T_WHITESPACE"," ",820],"{",["T_WHITESPACE","\n            ",820],["T_IF","if",821],["T_WHITESPACE"," ",821],"(",["T_STRING","preg_match",821],"(",["T_WHITESPACE","\n                    ",821],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid.delegate[ \\t]*[^\"\\']*\\\\1[^>]*href=([\"\\'])([^\"\\']+)\\\\2[^>]*\\\/?>\/i'",822],",",["T_WHITESPACE","\n                    ",822],["T_VARIABLE","$response",823],",",["T_WHITESPACE","\n                    ",823],["T_VARIABLE","$r",824],")",")",["T_WHITESPACE"," ",824],"{",["T_WHITESPACE","\n                ",824],["T_VARIABLE","$realId",825],["T_WHITESPACE"," ",825],"=",["T_WHITESPACE"," ",825],["T_VARIABLE","$r",825],"[",["T_LNUMBER","3",825],"]",";",["T_WHITESPACE","\n            ",825],"}",["T_WHITESPACE"," ",826],["T_ELSE","else",826],["T_WHITESPACE"," ",826],["T_IF","if",826],["T_WHITESPACE"," ",826],"(",["T_STRING","preg_match",826],"(",["T_WHITESPACE","\n                    ",826],["T_CONSTANT_ENCAPSED_STRING","'\/<link[^>]*href=([\"\\'])([^\"\\']+)\\\\1[^>]*rel=([\"\\'])[ \\t]*(?:[^ \\t\"\\']+[ \\t]+)*?openid.delegate[ \\t]*[^\"\\']*\\\\3[^>]*\\\/?>\/i'",827],",",["T_WHITESPACE","\n                    ",827],["T_VARIABLE","$response",828],",",["T_WHITESPACE","\n                    ",828],["T_VARIABLE","$r",829],")",")",["T_WHITESPACE"," ",829],"{",["T_WHITESPACE","\n                ",829],["T_VARIABLE","$realId",830],["T_WHITESPACE"," ",830],"=",["T_WHITESPACE"," ",830],["T_VARIABLE","$r",830],"[",["T_LNUMBER","2",830],"]",";",["T_WHITESPACE","\n            ",830],"}",["T_WHITESPACE","\n        ",831],"}",["T_WHITESPACE","\n\n        ",832],["T_VARIABLE","$expire",834],["T_WHITESPACE"," ",834],"=",["T_WHITESPACE"," ",834],["T_STRING","time",834],"(",")",["T_WHITESPACE"," ",834],"+",["T_WHITESPACE"," ",834],["T_LNUMBER","60",834],["T_WHITESPACE"," ",834],"*",["T_WHITESPACE"," ",834],["T_LNUMBER","60",834],";",["T_WHITESPACE","\n        ",834],["T_VARIABLE","$this",835],["T_OBJECT_OPERATOR","->",835],["T_STRING","_storage",835],["T_OBJECT_OPERATOR","->",835],["T_STRING","addDiscoveryInfo",835],"(",["T_VARIABLE","$id",835],",",["T_WHITESPACE"," ",835],["T_VARIABLE","$realId",835],",",["T_WHITESPACE"," ",835],["T_VARIABLE","$server",835],",",["T_WHITESPACE"," ",835],["T_VARIABLE","$version",835],",",["T_WHITESPACE"," ",835],["T_VARIABLE","$expire",835],")",";",["T_WHITESPACE","\n        ",835],["T_VARIABLE","$id",836],["T_WHITESPACE"," ",836],"=",["T_WHITESPACE"," ",836],["T_VARIABLE","$realId",836],";",["T_WHITESPACE","\n        ",836],["T_RETURN","return",837],["T_WHITESPACE"," ",837],["T_STRING","true",837],";",["T_WHITESPACE","\n    ",837],"}",["T_WHITESPACE","\n\n    ",838],["T_DOC_COMMENT","\/**\n     * Performs check of OpenID identity.\n     *\n     * This is the first step of OpenID authentication process.\n     * On success the function does not return (it does HTTP redirection to\n     * server and exits). On failure it returns false.\n     *\n     * @param bool $immediate enables or disables interaction with user\n     * @param string $id OpenID identity\n     * @param string $returnTo HTTP URL to redirect response from server to\n     * @param string $root HTTP URL to identify consumer on server\n     * @param mixed $extensions extension object or array of extensions objects\n     * @param Zend_Controller_Response_Abstract $response an optional response\n     *  object to perform HTTP or HTML form redirection\n     * @return bool\n     *\/",840],["T_WHITESPACE","\n    ",855],["T_PROTECTED","protected",856],["T_WHITESPACE"," ",856],["T_FUNCTION","function",856],["T_WHITESPACE"," ",856],["T_STRING","_checkId",856],"(",["T_VARIABLE","$immediate",856],",",["T_WHITESPACE"," ",856],["T_VARIABLE","$id",856],",",["T_WHITESPACE"," ",856],["T_VARIABLE","$returnTo",856],"=",["T_STRING","null",856],",",["T_WHITESPACE"," ",856],["T_VARIABLE","$root",856],"=",["T_STRING","null",856],",",["T_WHITESPACE","\n        ",856],["T_VARIABLE","$extensions",857],"=",["T_STRING","null",857],",",["T_WHITESPACE"," ",857],["T_STRING","Zend_Controller_Response_Abstract",857],["T_WHITESPACE"," ",857],["T_VARIABLE","$response",857],["T_WHITESPACE"," ",857],"=",["T_WHITESPACE"," ",857],["T_STRING","null",857],")",["T_WHITESPACE","\n    ",857],"{",["T_WHITESPACE","\n        ",858],["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","_setError",859],"(",["T_CONSTANT_ENCAPSED_STRING","''",859],")",";",["T_WHITESPACE","\n\n        ",859],["T_IF","if",861],["T_WHITESPACE"," ",861],"(","!",["T_STRING","Zend_OpenId",861],["T_DOUBLE_COLON","::",861],["T_STRING","normalize",861],"(",["T_VARIABLE","$id",861],")",")",["T_WHITESPACE"," ",861],"{",["T_WHITESPACE","\n            ",861],["T_VARIABLE","$this",862],["T_OBJECT_OPERATOR","->",862],["T_STRING","_setError",862],"(",["T_CONSTANT_ENCAPSED_STRING","\"Normalisation failed\"",862],")",";",["T_WHITESPACE","\n            ",862],["T_RETURN","return",863],["T_WHITESPACE"," ",863],["T_STRING","false",863],";",["T_WHITESPACE","\n        ",863],"}",["T_WHITESPACE","\n        ",864],["T_VARIABLE","$claimedId",865],["T_WHITESPACE"," ",865],"=",["T_WHITESPACE"," ",865],["T_VARIABLE","$id",865],";",["T_WHITESPACE","\n\n        ",865],["T_IF","if",867],["T_WHITESPACE"," ",867],"(","!",["T_VARIABLE","$this",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","_discovery",867],"(",["T_VARIABLE","$id",867],",",["T_WHITESPACE"," ",867],["T_VARIABLE","$server",867],",",["T_WHITESPACE"," ",867],["T_VARIABLE","$version",867],")",")",["T_WHITESPACE"," ",867],"{",["T_WHITESPACE","\n            ",867],["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","_setError",868],"(",["T_CONSTANT_ENCAPSED_STRING","\"Discovery failed: \"",868],["T_WHITESPACE"," ",868],".",["T_WHITESPACE"," ",868],["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","getError",868],"(",")",")",";",["T_WHITESPACE","\n            ",868],["T_RETURN","return",869],["T_WHITESPACE"," ",869],["T_STRING","false",869],";",["T_WHITESPACE","\n        ",869],"}",["T_WHITESPACE","\n        ",870],["T_IF","if",871],["T_WHITESPACE"," ",871],"(","!",["T_VARIABLE","$this",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","_associate",871],"(",["T_VARIABLE","$server",871],",",["T_WHITESPACE"," ",871],["T_VARIABLE","$version",871],")",")",["T_WHITESPACE"," ",871],"{",["T_WHITESPACE","\n            ",871],["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","_setError",872],"(",["T_CONSTANT_ENCAPSED_STRING","\"Association failed: \"",872],["T_WHITESPACE"," ",872],".",["T_WHITESPACE"," ",872],["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","getError",872],"(",")",")",";",["T_WHITESPACE","\n            ",872],["T_RETURN","return",873],["T_WHITESPACE"," ",873],["T_STRING","false",873],";",["T_WHITESPACE","\n        ",873],"}",["T_WHITESPACE","\n        ",874],["T_IF","if",875],["T_WHITESPACE"," ",875],"(","!",["T_VARIABLE","$this",875],["T_OBJECT_OPERATOR","->",875],["T_STRING","_getAssociation",875],"(",["T_WHITESPACE","\n                ",875],["T_VARIABLE","$server",876],",",["T_WHITESPACE","\n                ",876],["T_VARIABLE","$handle",877],",",["T_WHITESPACE","\n                ",877],["T_VARIABLE","$macFunc",878],",",["T_WHITESPACE","\n                ",878],["T_VARIABLE","$secret",879],",",["T_WHITESPACE","\n                ",879],["T_VARIABLE","$expires",880],")",")",["T_WHITESPACE"," ",880],"{",["T_WHITESPACE","\n            ",880],["T_COMMENT","\/* Use dumb mode *\/",881],["T_WHITESPACE","\n            ",881],["T_UNSET","unset",882],"(",["T_VARIABLE","$handle",882],")",";",["T_WHITESPACE","\n            ",882],["T_UNSET","unset",883],"(",["T_VARIABLE","$macFunc",883],")",";",["T_WHITESPACE","\n            ",883],["T_UNSET","unset",884],"(",["T_VARIABLE","$secret",884],")",";",["T_WHITESPACE","\n            ",884],["T_UNSET","unset",885],"(",["T_VARIABLE","$expires",885],")",";",["T_WHITESPACE","\n        ",885],"}",["T_WHITESPACE","\n\n        ",886],["T_VARIABLE","$params",888],["T_WHITESPACE"," ",888],"=",["T_WHITESPACE"," ",888],["T_ARRAY","array",888],"(",")",";",["T_WHITESPACE","\n        ",888],["T_IF","if",889],["T_WHITESPACE"," ",889],"(",["T_VARIABLE","$version",889],["T_WHITESPACE"," ",889],["T_IS_GREATER_OR_EQUAL",">=",889],["T_WHITESPACE"," ",889],["T_DNUMBER","2.0",889],")",["T_WHITESPACE"," ",889],"{",["T_WHITESPACE","\n            ",889],["T_VARIABLE","$params",890],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.ns'",890],"]",["T_WHITESPACE"," ",890],"=",["T_WHITESPACE"," ",890],["T_STRING","Zend_OpenId",890],["T_DOUBLE_COLON","::",890],["T_STRING","NS_2_0",890],";",["T_WHITESPACE","\n        ",890],"}",["T_WHITESPACE","\n\n        ",891],["T_VARIABLE","$params",893],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.mode'",893],"]",["T_WHITESPACE"," ",893],"=",["T_WHITESPACE"," ",893],["T_VARIABLE","$immediate",893],["T_WHITESPACE"," ",893],"?",["T_WHITESPACE","\n            ",893],["T_CONSTANT_ENCAPSED_STRING","'checkid_immediate'",894],["T_WHITESPACE"," ",894],":",["T_WHITESPACE"," ",894],["T_CONSTANT_ENCAPSED_STRING","'checkid_setup'",894],";",["T_WHITESPACE","\n\n        ",894],["T_VARIABLE","$params",896],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.identity'",896],"]",["T_WHITESPACE"," ",896],"=",["T_WHITESPACE"," ",896],["T_VARIABLE","$id",896],";",["T_WHITESPACE","\n\n        ",896],["T_VARIABLE","$params",898],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.claimed_id'",898],"]",["T_WHITESPACE"," ",898],"=",["T_WHITESPACE"," ",898],["T_VARIABLE","$claimedId",898],";",["T_WHITESPACE","\n\n        ",898],["T_IF","if",900],["T_WHITESPACE"," ",900],"(",["T_VARIABLE","$version",900],["T_WHITESPACE"," ",900],["T_IS_SMALLER_OR_EQUAL","<=",900],["T_WHITESPACE"," ",900],["T_DNUMBER","2.0",900],")",["T_WHITESPACE"," ",900],"{",["T_WHITESPACE","\n            ",900],["T_IF","if",901],["T_WHITESPACE"," ",901],"(",["T_VARIABLE","$this",901],["T_OBJECT_OPERATOR","->",901],["T_STRING","_session",901],["T_WHITESPACE"," ",901],["T_IS_NOT_IDENTICAL","!==",901],["T_WHITESPACE"," ",901],["T_STRING","null",901],")",["T_WHITESPACE"," ",901],"{",["T_WHITESPACE","\n                ",901],["T_VARIABLE","$this",902],["T_OBJECT_OPERATOR","->",902],["T_STRING","_session",902],["T_OBJECT_OPERATOR","->",902],["T_STRING","identity",902],["T_WHITESPACE"," ",902],"=",["T_WHITESPACE"," ",902],["T_VARIABLE","$id",902],";",["T_WHITESPACE","\n                ",902],["T_VARIABLE","$this",903],["T_OBJECT_OPERATOR","->",903],["T_STRING","_session",903],["T_OBJECT_OPERATOR","->",903],["T_STRING","claimed_id",903],["T_WHITESPACE"," ",903],"=",["T_WHITESPACE"," ",903],["T_VARIABLE","$claimedId",903],";",["T_WHITESPACE","\n            ",903],"}",["T_WHITESPACE"," ",904],["T_ELSE","else",904],["T_WHITESPACE"," ",904],["T_IF","if",904],["T_WHITESPACE"," ",904],"(",["T_STRING","defined",904],"(",["T_CONSTANT_ENCAPSED_STRING","'SID'",904],")",")",["T_WHITESPACE"," ",904],"{",["T_WHITESPACE","\n                ",904],["T_VARIABLE","$_SESSION",905],"[",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",905],"]",["T_WHITESPACE"," ",905],"=",["T_WHITESPACE"," ",905],["T_ARRAY","array",905],"(",["T_WHITESPACE","\n                    ",905],["T_CONSTANT_ENCAPSED_STRING","\"identity\"",906],["T_WHITESPACE"," ",906],["T_DOUBLE_ARROW","=>",906],["T_WHITESPACE"," ",906],["T_VARIABLE","$id",906],",",["T_WHITESPACE","\n                    ",906],["T_CONSTANT_ENCAPSED_STRING","\"claimed_id\"",907],["T_WHITESPACE"," ",907],["T_DOUBLE_ARROW","=>",907],["T_WHITESPACE"," ",907],["T_VARIABLE","$claimedId",907],")",";",["T_WHITESPACE","\n            ",907],"}",["T_WHITESPACE"," ",908],["T_ELSE","else",908],["T_WHITESPACE"," ",908],"{",["T_WHITESPACE","\n                ",908],["T_COMMENT","#require_once \"Zend\/Session\/Namespace.php\";\n",909],["T_WHITESPACE","                ",910],["T_VARIABLE","$this",910],["T_OBJECT_OPERATOR","->",910],["T_STRING","_session",910],["T_WHITESPACE"," ",910],"=",["T_WHITESPACE"," ",910],["T_NEW","new",910],["T_WHITESPACE"," ",910],["T_STRING","Zend_Session_Namespace",910],"(",["T_CONSTANT_ENCAPSED_STRING","\"zend_openid\"",910],")",";",["T_WHITESPACE","\n                ",910],["T_VARIABLE","$this",911],["T_OBJECT_OPERATOR","->",911],["T_STRING","_session",911],["T_OBJECT_OPERATOR","->",911],["T_STRING","identity",911],["T_WHITESPACE"," ",911],"=",["T_WHITESPACE"," ",911],["T_VARIABLE","$id",911],";",["T_WHITESPACE","\n                ",911],["T_VARIABLE","$this",912],["T_OBJECT_OPERATOR","->",912],["T_STRING","_session",912],["T_OBJECT_OPERATOR","->",912],["T_STRING","claimed_id",912],["T_WHITESPACE"," ",912],"=",["T_WHITESPACE"," ",912],["T_VARIABLE","$claimedId",912],";",["T_WHITESPACE","\n            ",912],"}",["T_WHITESPACE","\n        ",913],"}",["T_WHITESPACE","\n\n        ",914],["T_IF","if",916],["T_WHITESPACE"," ",916],"(",["T_ISSET","isset",916],"(",["T_VARIABLE","$handle",916],")",")",["T_WHITESPACE"," ",916],"{",["T_WHITESPACE","\n            ",916],["T_VARIABLE","$params",917],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.assoc_handle'",917],"]",["T_WHITESPACE"," ",917],"=",["T_WHITESPACE"," ",917],["T_VARIABLE","$handle",917],";",["T_WHITESPACE","\n        ",917],"}",["T_WHITESPACE","\n\n        ",918],["T_VARIABLE","$params",920],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.return_to'",920],"]",["T_WHITESPACE"," ",920],"=",["T_WHITESPACE"," ",920],["T_STRING","Zend_OpenId",920],["T_DOUBLE_COLON","::",920],["T_STRING","absoluteUrl",920],"(",["T_VARIABLE","$returnTo",920],")",";",["T_WHITESPACE","\n\n        ",920],["T_IF","if",922],["T_WHITESPACE"," ",922],"(",["T_EMPTY","empty",922],"(",["T_VARIABLE","$root",922],")",")",["T_WHITESPACE"," ",922],"{",["T_WHITESPACE","\n            ",922],["T_VARIABLE","$root",923],["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_STRING","Zend_OpenId",923],["T_DOUBLE_COLON","::",923],["T_STRING","selfUrl",923],"(",")",";",["T_WHITESPACE","\n            ",923],["T_IF","if",924],["T_WHITESPACE"," ",924],"(",["T_VARIABLE","$root",924],"[",["T_STRING","strlen",924],"(",["T_VARIABLE","$root",924],")","-",["T_LNUMBER","1",924],"]",["T_WHITESPACE"," ",924],["T_IS_NOT_EQUAL","!=",924],["T_WHITESPACE"," ",924],["T_CONSTANT_ENCAPSED_STRING","'\/'",924],")",["T_WHITESPACE"," ",924],"{",["T_WHITESPACE","\n                ",924],["T_VARIABLE","$root",925],["T_WHITESPACE"," ",925],"=",["T_WHITESPACE"," ",925],["T_STRING","dirname",925],"(",["T_VARIABLE","$root",925],")",";",["T_WHITESPACE","\n            ",925],"}",["T_WHITESPACE","\n        ",926],"}",["T_WHITESPACE","\n        ",927],["T_IF","if",928],["T_WHITESPACE"," ",928],"(",["T_VARIABLE","$version",928],["T_WHITESPACE"," ",928],["T_IS_GREATER_OR_EQUAL",">=",928],["T_WHITESPACE"," ",928],["T_DNUMBER","2.0",928],")",["T_WHITESPACE"," ",928],"{",["T_WHITESPACE","\n            ",928],["T_VARIABLE","$params",929],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.realm'",929],"]",["T_WHITESPACE"," ",929],"=",["T_WHITESPACE"," ",929],["T_VARIABLE","$root",929],";",["T_WHITESPACE","\n        ",929],"}",["T_WHITESPACE"," ",930],["T_ELSE","else",930],["T_WHITESPACE"," ",930],"{",["T_WHITESPACE","\n            ",930],["T_VARIABLE","$params",931],"[",["T_CONSTANT_ENCAPSED_STRING","'openid.trust_root'",931],"]",["T_WHITESPACE"," ",931],"=",["T_WHITESPACE"," ",931],["T_VARIABLE","$root",931],";",["T_WHITESPACE","\n        ",931],"}",["T_WHITESPACE","\n\n        ",932],["T_IF","if",934],["T_WHITESPACE"," ",934],"(","!",["T_STRING","Zend_OpenId_Extension",934],["T_DOUBLE_COLON","::",934],["T_STRING","forAll",934],"(",["T_VARIABLE","$extensions",934],",",["T_WHITESPACE"," ",934],["T_CONSTANT_ENCAPSED_STRING","'prepareRequest'",934],",",["T_WHITESPACE"," ",934],["T_VARIABLE","$params",934],")",")",["T_WHITESPACE"," ",934],"{",["T_WHITESPACE","\n            ",934],["T_VARIABLE","$this",935],["T_OBJECT_OPERATOR","->",935],["T_STRING","_setError",935],"(",["T_CONSTANT_ENCAPSED_STRING","\"Extension::prepareRequest failure\"",935],")",";",["T_WHITESPACE","\n            ",935],["T_RETURN","return",936],["T_WHITESPACE"," ",936],["T_STRING","false",936],";",["T_WHITESPACE","\n        ",936],"}",["T_WHITESPACE","\n\n        ",937],["T_STRING","Zend_OpenId",939],["T_DOUBLE_COLON","::",939],["T_STRING","redirect",939],"(",["T_VARIABLE","$server",939],",",["T_WHITESPACE"," ",939],["T_VARIABLE","$params",939],",",["T_WHITESPACE"," ",939],["T_VARIABLE","$response",939],")",";",["T_WHITESPACE","\n        ",939],["T_RETURN","return",940],["T_WHITESPACE"," ",940],["T_STRING","true",940],";",["T_WHITESPACE","\n    ",940],"}",["T_WHITESPACE","\n\n    ",941],["T_DOC_COMMENT","\/**\n     * Sets HTTP client object to make HTTP requests\n     *\n     * @param Zend_Http_Client $client HTTP client object to be used\n     *\/",943],["T_WHITESPACE","\n    ",947],["T_PUBLIC","public",948],["T_WHITESPACE"," ",948],["T_FUNCTION","function",948],["T_WHITESPACE"," ",948],["T_STRING","setHttpClient",948],"(",["T_VARIABLE","$client",948],")",["T_WHITESPACE"," ",948],"{",["T_WHITESPACE","\n        ",948],["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","_httpClient",949],["T_WHITESPACE"," ",949],"=",["T_WHITESPACE"," ",949],["T_VARIABLE","$client",949],";",["T_WHITESPACE","\n    ",949],"}",["T_WHITESPACE","\n\n    ",950],["T_DOC_COMMENT","\/**\n     * Returns HTTP client object that will be used to make HTTP requests\n     *\n     * @return Zend_Http_Client\n     *\/",952],["T_WHITESPACE","\n    ",956],["T_PUBLIC","public",957],["T_WHITESPACE"," ",957],["T_FUNCTION","function",957],["T_WHITESPACE"," ",957],["T_STRING","getHttpClient",957],"(",")",["T_WHITESPACE"," ",957],"{",["T_WHITESPACE","\n        ",957],["T_RETURN","return",958],["T_WHITESPACE"," ",958],["T_VARIABLE","$this",958],["T_OBJECT_OPERATOR","->",958],["T_STRING","_httpClient",958],";",["T_WHITESPACE","\n    ",958],"}",["T_WHITESPACE","\n\n    ",959],["T_DOC_COMMENT","\/**\n     * Sets session object to store climed_id\n     *\n     * @param Zend_Session_Namespace $session HTTP client object to be used\n     *\/",961],["T_WHITESPACE","\n    ",965],["T_PUBLIC","public",966],["T_WHITESPACE"," ",966],["T_FUNCTION","function",966],["T_WHITESPACE"," ",966],["T_STRING","setSession",966],"(",["T_STRING","Zend_Session_Namespace",966],["T_WHITESPACE"," ",966],["T_VARIABLE","$session",966],")",["T_WHITESPACE"," ",966],"{",["T_WHITESPACE","\n        ",966],["T_VARIABLE","$this",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","_session",967],["T_WHITESPACE"," ",967],"=",["T_WHITESPACE"," ",967],["T_VARIABLE","$session",967],";",["T_WHITESPACE","\n    ",967],"}",["T_WHITESPACE","\n\n    ",968],["T_DOC_COMMENT","\/**\n     * Returns session object that is used to store climed_id\n     *\n     * @return Zend_Session_Namespace\n     *\/",970],["T_WHITESPACE","\n    ",974],["T_PUBLIC","public",975],["T_WHITESPACE"," ",975],["T_FUNCTION","function",975],["T_WHITESPACE"," ",975],["T_STRING","getSession",975],"(",")",["T_WHITESPACE"," ",975],"{",["T_WHITESPACE","\n        ",975],["T_RETURN","return",976],["T_WHITESPACE"," ",976],["T_VARIABLE","$this",976],["T_OBJECT_OPERATOR","->",976],["T_STRING","_session",976],";",["T_WHITESPACE","\n    ",976],"}",["T_WHITESPACE","\n\n    ",977],["T_DOC_COMMENT","\/**\n     * Saves error message\n     *\n     * @param string $message error message\n     *\/",979],["T_WHITESPACE","\n    ",983],["T_PROTECTED","protected",984],["T_WHITESPACE"," ",984],["T_FUNCTION","function",984],["T_WHITESPACE"," ",984],["T_STRING","_setError",984],"(",["T_VARIABLE","$message",984],")",["T_WHITESPACE","\n    ",984],"{",["T_WHITESPACE","\n        ",985],["T_VARIABLE","$this",986],["T_OBJECT_OPERATOR","->",986],["T_STRING","_error",986],["T_WHITESPACE"," ",986],"=",["T_WHITESPACE"," ",986],["T_VARIABLE","$message",986],";",["T_WHITESPACE","\n    ",986],"}",["T_WHITESPACE","\n\n    ",987],["T_DOC_COMMENT","\/**\n     * Returns error message that explains failure of login, check or verify\n     *\n     * @return string\n     *\/",989],["T_WHITESPACE","\n    ",993],["T_PUBLIC","public",994],["T_WHITESPACE"," ",994],["T_FUNCTION","function",994],["T_WHITESPACE"," ",994],["T_STRING","getError",994],"(",")",["T_WHITESPACE","\n    ",994],"{",["T_WHITESPACE","\n        ",995],["T_RETURN","return",996],["T_WHITESPACE"," ",996],["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","_error",996],";",["T_WHITESPACE","\n    ",996],"}",["T_WHITESPACE","\n\n",997],"}",["T_WHITESPACE","\n",999]]