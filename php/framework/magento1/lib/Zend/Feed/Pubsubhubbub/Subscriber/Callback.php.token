[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Feed_Pubsubhubbub\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * @see Zend_Feed_Pubsubhubbub\n *\/",22],["T_WHITESPACE","\n",24],["T_COMMENT","#require_once 'Zend\/Feed\/Pubsubhubbub.php';\n",25],["T_WHITESPACE","\n",26],["T_DOC_COMMENT","\/**\n * @see Zend_Feed_Pubsubhubbub\n *\/",27],["T_WHITESPACE","\n",29],["T_COMMENT","#require_once 'Zend\/Feed\/Pubsubhubbub\/CallbackAbstract.php';\n",30],["T_WHITESPACE","\n",31],["T_DOC_COMMENT","\/**\n * @see Zend_Feed_Reader\n *\/",32],["T_WHITESPACE","\n",34],["T_COMMENT","#require_once 'Zend\/Feed\/Reader.php';\n",35],["T_WHITESPACE","\n",36],["T_DOC_COMMENT","\/**\n * @category   Zend\n * @package    Zend_Feed_Pubsubhubbub\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",37],["T_WHITESPACE","\n",42],["T_CLASS","class",43],["T_WHITESPACE"," ",43],["T_STRING","Zend_Feed_Pubsubhubbub_Subscriber_Callback",43],["T_WHITESPACE","\n    ",43],["T_EXTENDS","extends",44],["T_WHITESPACE"," ",44],["T_STRING","Zend_Feed_Pubsubhubbub_CallbackAbstract",44],["T_WHITESPACE","\n",44],"{",["T_WHITESPACE","\n    ",45],["T_DOC_COMMENT","\/**\n     * Contains the content of any feeds sent as updates to the Callback URL\n     *\n     * @var string\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$_feedUpdate",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","null",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Holds a manually set subscription key (i.e. identifies a unique\n     * subscription) which is typical when it is not passed in the query string\n     * but is part of the Callback URL path, requiring manual retrieval e.g.\n     * using a route and the Zend_Controller_Action::_getParam() method.\n     *\n     * @var string\n     *\/",53],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_subscriptionKey",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","null",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * After verification, this is set to the verified subscription's data.\n     *\n     * @var array\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_currentSubscriptionData",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","null",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Set a subscription key to use for the current callback request manually.\n     * Required if usePathParameter is enabled for the Subscriber.\n     *\n     * @param  string $key\n     * @return Zend_Feed_Pubsubhubbub_Subscriber_Callback\n     *\/",70],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","setSubscriptionKey",77],"(",["T_VARIABLE","$key",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_subscriptionKey",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$key",79],";",["T_WHITESPACE","\n        ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Handle any callback from a Hub Server responding to a subscription or\n     * unsubscription request. This should be the Hub Server confirming the\n     * the request prior to taking action on it.\n     *\n     * @param  array $httpGetData GET data if available and not in $_GET\n     * @param  bool $sendResponseNow Whether to send response now or when asked\n     * @return void\n     *\/",83],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","handle",92],"(",["T_ARRAY","array",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$httpGetData",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","null",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$sendResponseNow",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","false",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$httpGetData",94],["T_WHITESPACE"," ",94],["T_IS_IDENTICAL","===",94],["T_WHITESPACE"," ",94],["T_STRING","null",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$httpGetData",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$_GET",95],";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n\n        ",96],["T_DOC_COMMENT","\/**\n         * Handle any feed updates (sorry for the mess :P)\n         *\n         * This DOES NOT attempt to process a feed update. Feed updates\n         * SHOULD be validated\/processed by an asynchronous process so as\n         * to avoid holding up responses to the Hub.\n         *\/",98],["T_WHITESPACE","\n        ",104],["T_VARIABLE","$contentType",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_getHeader",105],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",105],")",";",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_STRING","strtolower",106],"(",["T_VARIABLE","$_SERVER",106],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",106],"]",")",["T_WHITESPACE"," ",106],["T_IS_EQUAL","==",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'post'",106],["T_WHITESPACE","\n            ",106],["T_BOOLEAN_AND","&&",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_hasValidVerifyToken",107],"(",["T_STRING","null",107],",",["T_WHITESPACE"," ",107],["T_STRING","false",107],")",["T_WHITESPACE","\n            ",107],["T_BOOLEAN_AND","&&",108],["T_WHITESPACE"," ",108],"(",["T_STRING","stripos",108],"(",["T_VARIABLE","$contentType",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'application\/atom+xml'",108],")",["T_WHITESPACE"," ",108],["T_IS_IDENTICAL","===",108],["T_WHITESPACE"," ",108],["T_LNUMBER","0",108],["T_WHITESPACE","\n                ",108],["T_BOOLEAN_OR","||",109],["T_WHITESPACE"," ",109],["T_STRING","stripos",109],"(",["T_VARIABLE","$contentType",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'application\/rss+xml'",109],")",["T_WHITESPACE"," ",109],["T_IS_IDENTICAL","===",109],["T_WHITESPACE"," ",109],["T_LNUMBER","0",109],["T_WHITESPACE","\n                ",109],["T_BOOLEAN_OR","||",110],["T_WHITESPACE"," ",110],["T_STRING","stripos",110],"(",["T_VARIABLE","$contentType",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'application\/xml'",110],")",["T_WHITESPACE"," ",110],["T_IS_IDENTICAL","===",110],["T_WHITESPACE"," ",110],["T_LNUMBER","0",110],["T_WHITESPACE","\n                ",110],["T_BOOLEAN_OR","||",111],["T_WHITESPACE"," ",111],["T_STRING","stripos",111],"(",["T_VARIABLE","$contentType",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",111],")",["T_WHITESPACE"," ",111],["T_IS_IDENTICAL","===",111],["T_WHITESPACE"," ",111],["T_LNUMBER","0",111],["T_WHITESPACE","\n                ",111],["T_BOOLEAN_OR","||",112],["T_WHITESPACE"," ",112],["T_STRING","stripos",112],"(",["T_VARIABLE","$contentType",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'application\/rdf+xml'",112],")",["T_WHITESPACE"," ",112],["T_IS_IDENTICAL","===",112],["T_WHITESPACE"," ",112],["T_LNUMBER","0",112],")",["T_WHITESPACE","\n        ",112],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","setFeedUpdate",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_getRawBody",114],"(",")",")",";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getHttpResponse",115],"(",")",["T_WHITESPACE","\n                 ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","setHeader",116],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Hub-On-Behalf-Of'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getSubscriberCount",116],"(",")",")",";",["T_WHITESPACE","\n        ",116],["T_DOC_COMMENT","\/**\n         * Handle any (un)subscribe confirmation requests\n         *\/",117],["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE"," ",120],["T_ELSEIF","elseif",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","isValidHubVerification",120],"(",["T_VARIABLE","$httpGetData",120],")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$data",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_currentSubscriptionData",121],";",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getHttpResponse",122],"(",")",["T_OBJECT_OPERATOR","->",122],["T_STRING","setBody",122],"(",["T_VARIABLE","$httpGetData",122],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_challenge'",122],"]",")",";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$data",123],"[",["T_CONSTANT_ENCAPSED_STRING","'subscription_state'",123],"]",["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","Zend_Feed_Pubsubhubbub",123],["T_DOUBLE_COLON","::",123],["T_STRING","SUBSCRIPTION_VERIFIED",123],";",["T_WHITESPACE","\n            ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_ISSET","isset",124],"(",["T_VARIABLE","$httpGetData",124],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_lease_seconds'",124],"]",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$data",125],"[",["T_CONSTANT_ENCAPSED_STRING","'lease_seconds'",125],"]",["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$httpGetData",125],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_lease_seconds'",125],"]",";",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getStorage",127],"(",")",["T_OBJECT_OPERATOR","->",127],["T_STRING","setSubscription",127],"(",["T_VARIABLE","$data",127],")",";",["T_WHITESPACE","\n        ",127],["T_DOC_COMMENT","\/**\n         * Hey, C'mon! We tried everything else!\n         *\/",128],["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE"," ",131],["T_ELSE","else",131],["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getHttpResponse",132],"(",")",["T_OBJECT_OPERATOR","->",132],["T_STRING","setHttpResponseCode",132],"(",["T_LNUMBER","404",132],")",";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$sendResponseNow",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","sendResponse",135],"(",")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Checks validity of the request simply by making a quick pass and\n     * confirming the presence of all REQUIRED parameters.\n     *\n     * @param  array $httpGetData\n     * @return bool\n     *\/",139],["T_WHITESPACE","\n    ",145],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","isValidHubVerification",146],"(",["T_ARRAY","array",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$httpGetData",146],")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_DOC_COMMENT","\/**\n         * As per the specification, the hub.verify_token is OPTIONAL. This\n         * implementation of Pubsubhubbub considers it REQUIRED and will\n         * always send a hub.verify_token parameter to be echoed back\n         * by the Hub Server. Therefore, its absence is considered invalid.\n         *\/",148],["T_WHITESPACE","\n        ",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(",["T_STRING","strtolower",154],"(",["T_VARIABLE","$_SERVER",154],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",154],"]",")",["T_WHITESPACE"," ",154],["T_IS_NOT_IDENTICAL","!==",154],["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'get'",154],")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_STRING","false",155],";",["T_WHITESPACE","\n        ",155],"}",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$required",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_ARRAY","array",157],"(",["T_WHITESPACE","\n            ",157],["T_CONSTANT_ENCAPSED_STRING","'hub_mode'",158],",",["T_WHITESPACE","\n            ",158],["T_CONSTANT_ENCAPSED_STRING","'hub_topic'",159],",",["T_WHITESPACE","\n            ",159],["T_CONSTANT_ENCAPSED_STRING","'hub_challenge'",160],",",["T_WHITESPACE","\n            ",160],["T_CONSTANT_ENCAPSED_STRING","'hub_verify_token'",161],",",["T_WHITESPACE","\n        ",161],")",";",["T_WHITESPACE","\n        ",162],["T_FOREACH","foreach",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$required",163],["T_WHITESPACE"," ",163],["T_AS","as",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$key",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(","!",["T_STRING","array_key_exists",164],"(",["T_VARIABLE","$key",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$httpGetData",164],")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n                ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_STRING","false",165],";",["T_WHITESPACE","\n            ",165],"}",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n        ",167],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$httpGetData",168],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_mode'",168],"]",["T_WHITESPACE"," ",168],["T_IS_NOT_IDENTICAL","!==",168],["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'subscribe'",168],["T_WHITESPACE","\n            ",168],["T_BOOLEAN_AND","&&",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$httpGetData",169],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_mode'",169],"]",["T_WHITESPACE"," ",169],["T_IS_NOT_IDENTICAL","!==",169],["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'unsubscribe'",169],["T_WHITESPACE","\n        ",169],")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_STRING","false",171],";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n        ",172],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$httpGetData",173],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_mode'",173],"]",["T_WHITESPACE"," ",173],["T_IS_EQUAL","==",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'subscribe'",173],["T_WHITESPACE","\n            ",173],["T_BOOLEAN_AND","&&",174],["T_WHITESPACE"," ",174],"!",["T_STRING","array_key_exists",174],"(",["T_CONSTANT_ENCAPSED_STRING","'hub_lease_seconds'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$httpGetData",174],")",["T_WHITESPACE","\n        ",174],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_STRING","false",176],";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n        ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_STRING","Zend_Uri",178],["T_DOUBLE_COLON","::",178],["T_STRING","check",178],"(",["T_VARIABLE","$httpGetData",178],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_topic'",178],"]",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_STRING","false",179],";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE","\n\n        ",180],["T_DOC_COMMENT","\/**\n         * Attempt to retrieve any Verification Token Key attached to Callback\n         * URL's path by our Subscriber implementation\n         *\/",182],["T_WHITESPACE","\n        ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(","!",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_hasValidVerifyToken",186],"(",["T_VARIABLE","$httpGetData",186],")",")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_STRING","false",187],";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n        ",188],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_STRING","true",189],";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_DOC_COMMENT","\/**\n     * Sets a newly received feed (Atom\/RSS) sent by a Hub as an update to a\n     * Topic we've subscribed to.\n     *\n     * @param  string $feed\n     * @return Zend_Feed_Pubsubhubbub_Subscriber_Callback\n     *\/",192],["T_WHITESPACE","\n    ",198],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","setFeedUpdate",199],"(",["T_VARIABLE","$feed",199],")",["T_WHITESPACE","\n    ",199],"{",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_feedUpdate",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$feed",201],";",["T_WHITESPACE","\n        ",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Check if any newly received feed (Atom\/RSS) update was received\n     *\n     * @return bool\n     *\/",205],["T_WHITESPACE","\n    ",209],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","hasFeedUpdate",210],"(",")",["T_WHITESPACE","\n    ",210],"{",["T_WHITESPACE","\n        ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_feedUpdate",212],["T_WHITESPACE"," ",212],["T_IS_IDENTICAL","===",212],["T_WHITESPACE"," ",212],["T_STRING","null",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_STRING","false",213],";",["T_WHITESPACE","\n        ",213],"}",["T_WHITESPACE","\n        ",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_STRING","true",215],";",["T_WHITESPACE","\n    ",215],"}",["T_WHITESPACE","\n\n    ",216],["T_DOC_COMMENT","\/**\n     * Gets a newly received feed (Atom\/RSS) sent by a Hub as an update to a\n     * Topic we've subscribed to.\n     *\n     * @return string\n     *\/",218],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","getFeedUpdate",224],"(",")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_feedUpdate",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Check for a valid verify_token. By default attempts to compare values\n     * with that sent from Hub, otherwise merely ascertains its existence.\n     *\n     * @param  array $httpGetData\n     * @param  bool $checkValue\n     * @return bool\n     *\/",229],["T_WHITESPACE","\n    ",236],["T_PROTECTED","protected",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","_hasValidVerifyToken",237],"(",["T_ARRAY","array",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$httpGetData",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_STRING","null",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$checkValue",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_STRING","true",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$verifyTokenKey",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_detectVerifyTokenKey",239],"(",["T_VARIABLE","$httpGetData",239],")",";",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_EMPTY","empty",240],"(",["T_VARIABLE","$verifyTokenKey",240],")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","false",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$verifyTokenExists",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getStorage",243],"(",")",["T_OBJECT_OPERATOR","->",243],["T_STRING","hasSubscription",243],"(",["T_VARIABLE","$verifyTokenKey",243],")",";",["T_WHITESPACE","\n        ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(","!",["T_VARIABLE","$verifyTokenExists",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_STRING","false",245],";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$checkValue",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$data",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getStorage",248],"(",")",["T_OBJECT_OPERATOR","->",248],["T_STRING","getSubscription",248],"(",["T_VARIABLE","$verifyTokenKey",248],")",";",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$verifyToken",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$data",249],"[",["T_CONSTANT_ENCAPSED_STRING","'verify_token'",249],"]",";",["T_WHITESPACE","\n            ",249],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$verifyToken",250],["T_WHITESPACE"," ",250],["T_IS_NOT_IDENTICAL","!==",250],["T_WHITESPACE"," ",250],["T_STRING","hash",250],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$httpGetData",250],"[",["T_CONSTANT_ENCAPSED_STRING","'hub_verify_token'",250],"]",")",")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_STRING","false",251],";",["T_WHITESPACE","\n            ",251],"}",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_currentSubscriptionData",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$data",253],";",["T_WHITESPACE","\n            ",253],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_STRING","true",254],";",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n        ",255],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_STRING","true",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Attempt to detect the verification token key. This would be passed in\n     * the Callback URL (which we are handling with this class!) as a URI\n     * path part (the last part by convention).\n     *\n     * @param  null|array $httpGetData\n     * @return false|string\n     *\/",259],["T_WHITESPACE","\n    ",266],["T_PROTECTED","protected",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","_detectVerifyTokenKey",267],"(",["T_ARRAY","array",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$httpGetData",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","null",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_DOC_COMMENT","\/**\n         * Available when sub keys encoding in Callback URL path\n         *\/",269],["T_WHITESPACE","\n        ",271],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_ISSET","isset",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_subscriptionKey",272],")",")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_subscriptionKey",273],";",["T_WHITESPACE","\n        ",273],"}",["T_WHITESPACE","\n\n        ",274],["T_DOC_COMMENT","\/**\n         * Available only if allowed by PuSH 0.2 Hubs\n         *\/",276],["T_WHITESPACE","\n        ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_STRING","is_array",279],"(",["T_VARIABLE","$httpGetData",279],")",["T_WHITESPACE","\n            ",279],["T_BOOLEAN_AND","&&",280],["T_WHITESPACE"," ",280],["T_ISSET","isset",280],"(",["T_VARIABLE","$httpGetData",280],"[",["T_CONSTANT_ENCAPSED_STRING","'xhub_subscription'",280],"]",")",["T_WHITESPACE","\n        ",280],")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n            ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$httpGetData",282],"[",["T_CONSTANT_ENCAPSED_STRING","'xhub_subscription'",282],"]",";",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n\n        ",283],["T_DOC_COMMENT","\/**\n         * Available (possibly) if corrupted in transit and not part of $_GET\n         *\/",285],["T_WHITESPACE","\n        ",287],["T_VARIABLE","$params",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_parseQueryString",288],"(",")",";",["T_WHITESPACE","\n        ",288],["T_IF","if",289],["T_WHITESPACE"," ",289],"(",["T_ISSET","isset",289],"(",["T_VARIABLE","$params",289],"[",["T_CONSTANT_ENCAPSED_STRING","'xhub.subscription'",289],"]",")",")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n            ",289],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_STRING","rawurldecode",290],"(",["T_VARIABLE","$params",290],"[",["T_CONSTANT_ENCAPSED_STRING","'xhub.subscription'",290],"]",")",";",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE","\n\n        ",291],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_STRING","false",293],";",["T_WHITESPACE","\n    ",293],"}",["T_WHITESPACE","\n\n    ",294],["T_DOC_COMMENT","\/**\n     * Build an array of Query String parameters.\n     * This bypasses $_GET which munges parameter names and cannot accept\n     * multiple parameters with the same key.\n     *\n     * @return array|void\n     *\/",296],["T_WHITESPACE","\n    ",302],["T_PROTECTED","protected",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","_parseQueryString",303],"(",")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$params",305],["T_WHITESPACE","      ",305],"=",["T_WHITESPACE"," ",305],["T_ARRAY","array",305],"(",")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$queryString",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_CONSTANT_ENCAPSED_STRING","''",306],";",["T_WHITESPACE","\n        ",306],["T_IF","if",307],["T_WHITESPACE"," ",307],"(",["T_ISSET","isset",307],"(",["T_VARIABLE","$_SERVER",307],"[",["T_CONSTANT_ENCAPSED_STRING","'QUERY_STRING'",307],"]",")",")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$queryString",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$_SERVER",308],"[",["T_CONSTANT_ENCAPSED_STRING","'QUERY_STRING'",308],"]",";",["T_WHITESPACE","\n        ",308],"}",["T_WHITESPACE","\n        ",309],["T_IF","if",310],["T_WHITESPACE"," ",310],"(",["T_EMPTY","empty",310],"(",["T_VARIABLE","$queryString",310],")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n            ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_ARRAY","array",311],"(",")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE","\n        ",312],["T_VARIABLE","$parts",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_STRING","explode",313],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$queryString",313],")",";",["T_WHITESPACE","\n        ",313],["T_FOREACH","foreach",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$parts",314],["T_WHITESPACE"," ",314],["T_AS","as",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$kvpair",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n            ",314],["T_VARIABLE","$pair",315],["T_WHITESPACE","  ",315],"=",["T_WHITESPACE"," ",315],["T_STRING","explode",315],"(",["T_CONSTANT_ENCAPSED_STRING","'='",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$kvpair",315],")",";",["T_WHITESPACE","\n            ",315],["T_VARIABLE","$key",316],["T_WHITESPACE","   ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","rawurldecode",316],"(",["T_VARIABLE","$pair",316],"[",["T_LNUMBER","0",316],"]",")",";",["T_WHITESPACE","\n            ",316],["T_VARIABLE","$value",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","rawurldecode",317],"(",["T_VARIABLE","$pair",317],"[",["T_LNUMBER","1",317],"]",")",";",["T_WHITESPACE","\n            ",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(",["T_ISSET","isset",318],"(",["T_VARIABLE","$params",318],"[",["T_VARIABLE","$key",318],"]",")",")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n                ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_STRING","is_array",319],"(",["T_VARIABLE","$params",319],"[",["T_VARIABLE","$key",319],"]",")",")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                    ",319],["T_VARIABLE","$params",320],"[",["T_VARIABLE","$key",320],"]","[","]",["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$value",320],";",["T_WHITESPACE","\n                ",320],"}",["T_WHITESPACE"," ",321],["T_ELSE","else",321],["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n                    ",321],["T_VARIABLE","$params",322],"[",["T_VARIABLE","$key",322],"]",["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_ARRAY","array",322],"(",["T_VARIABLE","$params",322],"[",["T_VARIABLE","$key",322],"]",",",["T_WHITESPACE"," ",322],["T_VARIABLE","$value",322],")",";",["T_WHITESPACE","\n                ",322],"}",["T_WHITESPACE","\n            ",323],"}",["T_WHITESPACE"," ",324],["T_ELSE","else",324],["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n                ",324],["T_VARIABLE","$params",325],"[",["T_VARIABLE","$key",325],"]",["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$value",325],";",["T_WHITESPACE","\n            ",325],"}",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n        ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$params",328],";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n",329],"}",["T_WHITESPACE","\n",330]]