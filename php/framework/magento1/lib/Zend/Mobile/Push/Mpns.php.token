[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Mobile\n * @subpackage Zend_Mobile_Push\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/** Zend_Http_Client **\/",23],["T_WHITESPACE","\n",23],["T_COMMENT","#require_once 'Zend\/Http\/Client.php';\n",24],["T_WHITESPACE","\n",25],["T_DOC_COMMENT","\/** Zend_Mobile_Push_Abstract **\/",26],["T_WHITESPACE","\n",26],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Abstract.php';\n",27],["T_WHITESPACE","\n",28],["T_DOC_COMMENT","\/** Zend_Mobile_Push_Message_Mpns **\/",29],["T_WHITESPACE","\n",29],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Message\/Mpns.php';\n",30],["T_WHITESPACE","\n",31],["T_DOC_COMMENT","\/**\n * Mpns Push\n *\n * @category   Zend\n * @package    Zend_Mobile\n * @subpackage Zend_Mobile_Push\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",32],["T_WHITESPACE","\n",41],["T_CLASS","class",42],["T_WHITESPACE"," ",42],["T_STRING","Zend_Mobile_Push_Mpns",42],["T_WHITESPACE"," ",42],["T_EXTENDS","extends",42],["T_WHITESPACE"," ",42],["T_STRING","Zend_Mobile_Push_Abstract",42],["T_WHITESPACE","\n",42],"{",["T_WHITESPACE","\n    ",43],["T_DOC_COMMENT","\/**\n     * Http Client\n     *\n     * @var Zend_Http_Client\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_httpClient",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Get Http Client\n     *\n     * @return Zend_Http_Client\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","getHttpClient",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(","!",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_httpClient",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_httpClient",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_STRING","Zend_Http_Client",59],"(",")",";",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_httpClient",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","setConfig",60],"(",["T_ARRAY","array",60],"(",["T_WHITESPACE","\n                ",60],["T_CONSTANT_ENCAPSED_STRING","'strictredirects'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_STRING","true",61],",",["T_WHITESPACE","\n            ",61],")",")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n        ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_httpClient",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Set Http Client\n     *\n     * @return Zend_Mobile_Push_Mpns\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","setHttpClient",72],"(",["T_STRING","Zend_Http_Client",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$client",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_httpClient",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$client",74],";",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Send Message\n     *\n     * @param  Zend_Mobile_Push_Message_Abstract $message\n     * @throws Zend_Http_Client_Exception\n     * @throws Zend_Mobile_Push_Exception\n     * @throws Zend_Mobile_Push_Exception_DeviceQuotaExceeded\n     * @throws Zend_Mobile_Push_Exception_InvalidPayload\n     * @throws Zend_Mobile_Push_Exception_InvalidToken\n     * @throws Zend_Mobile_Push_Exception_QuotaExceeded\n     * @throws Zend_Mobile_Push_Exception_ServerUnavailable\n     * @return boolean\n     *\/",78],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","send",91],"(",["T_STRING","Zend_Mobile_Push_Message_Abstract",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$message",91],")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(","!",["T_VARIABLE","$message",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","validate",93],"(",")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_THROW","throw",94],["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","Zend_Mobile_Push_Exception",94],"(",["T_CONSTANT_ENCAPSED_STRING","'The message is not valid.'",94],")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","connect",97],"(",")",";",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$client",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getHttpClient",99],"(",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$client",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","setUri",100],"(",["T_VARIABLE","$message",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getToken",100],"(",")",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$client",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setHeaders",101],"(",["T_ARRAY","array",101],"(",["T_WHITESPACE","\n            ",101],["T_CONSTANT_ENCAPSED_STRING","'Context-Type'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",102],",",["T_WHITESPACE","\n            ",102],["T_CONSTANT_ENCAPSED_STRING","'Accept'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'application\/*'",103],",",["T_WHITESPACE","\n            ",103],["T_CONSTANT_ENCAPSED_STRING","'X-NotificationClass'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$message",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getDelay",104],"(",")",["T_WHITESPACE","\n        ",104],")",")",";",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$message",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getId",106],"(",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$client",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","setHeaders",107],"(",["T_CONSTANT_ENCAPSED_STRING","'X-MessageID'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$message",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getId",107],"(",")",")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n        ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$message",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getNotificationType",109],"(",")",["T_WHITESPACE"," ",109],["T_IS_NOT_EQUAL","!=",109],["T_WHITESPACE"," ",109],["T_STRING","Zend_Mobile_Push_Message_Mpns",109],["T_DOUBLE_COLON","::",109],["T_STRING","TYPE_RAW",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$client",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","setHeaders",110],"(",["T_CONSTANT_ENCAPSED_STRING","'X-WindowsPhone-Target'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$message",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getNotificationType",110],"(",")",")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$client",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","setRawData",112],"(",["T_VARIABLE","$message",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getXmlPayload",112],"(",")",",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",112],")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$response",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$client",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","request",113],"(",["T_CONSTANT_ENCAPSED_STRING","'POST'",113],")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","close",114],"(",")",";",["T_WHITESPACE","\n\n\n        ",114],["T_SWITCH","switch",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$response",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getStatus",117],"(",")",")",["T_WHITESPACE","\n        ",117],"{",["T_WHITESPACE","\n            ",118],["T_CASE","case",119],["T_WHITESPACE"," ",119],["T_LNUMBER","200",119],":",["T_WHITESPACE","\n                ",119],["T_COMMENT","\/\/ check headers for response?  need to test how this actually works to correctly handle different states.\n",120],["T_WHITESPACE","                ",121],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$response",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getHeader",121],"(",["T_CONSTANT_ENCAPSED_STRING","'NotificationStatus'",121],")",["T_WHITESPACE"," ",121],["T_IS_EQUAL","==",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'QueueFull'",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                    ",121],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/DeviceQuotaExceeded.php';\n",122],["T_WHITESPACE","                    ",123],["T_THROW","throw",123],["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","Zend_Mobile_Push_Exception_DeviceQuotaExceeded",123],"(",["T_CONSTANT_ENCAPSED_STRING","'The devices push notification queue is full, use exponential backoff'",123],")",";",["T_WHITESPACE","\n                ",123],"}",["T_WHITESPACE","\n                ",124],["T_BREAK","break",125],";",["T_WHITESPACE","\n            ",125],["T_CASE","case",126],["T_WHITESPACE"," ",126],["T_LNUMBER","400",126],":",["T_WHITESPACE","\n                ",126],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/InvalidPayload.php';\n",127],["T_WHITESPACE","                ",128],["T_THROW","throw",128],["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_STRING","Zend_Mobile_Push_Exception_InvalidPayload",128],"(",["T_CONSTANT_ENCAPSED_STRING","'The message xml was invalid'",128],")",";",["T_WHITESPACE","\n                ",128],["T_BREAK","break",129],";",["T_WHITESPACE","\n            ",129],["T_CASE","case",130],["T_WHITESPACE"," ",130],["T_LNUMBER","401",130],":",["T_WHITESPACE","\n                ",130],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/InvalidToken.php';\n",131],["T_WHITESPACE","                ",132],["T_THROW","throw",132],["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_STRING","Zend_Mobile_Push_Exception_InvalidToken",132],"(",["T_CONSTANT_ENCAPSED_STRING","'The device token is not valid or there is a mismatch between certificates'",132],")",";",["T_WHITESPACE","\n                ",132],["T_BREAK","break",133],";",["T_WHITESPACE","\n            ",133],["T_CASE","case",134],["T_WHITESPACE"," ",134],["T_LNUMBER","404",134],":",["T_WHITESPACE","\n                ",134],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/InvalidToken.php';\n",135],["T_WHITESPACE","                ",136],["T_THROW","throw",136],["T_WHITESPACE"," ",136],["T_NEW","new",136],["T_WHITESPACE"," ",136],["T_STRING","Zend_Mobile_Push_Exception_InvalidToken",136],"(",["T_CONSTANT_ENCAPSED_STRING","'The device subscription is invalid, stop sending notifications to this device'",136],")",";",["T_WHITESPACE","\n                ",136],["T_BREAK","break",137],";",["T_WHITESPACE","\n            ",137],["T_CASE","case",138],["T_WHITESPACE"," ",138],["T_LNUMBER","405",138],":",["T_WHITESPACE","\n                ",138],["T_THROW","throw",139],["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","Zend_Mobile_Push_Exception",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid method, only POST is allowed'",139],")",";",["T_WHITESPACE"," ",139],["T_COMMENT","\/\/ will never be hit unless overwritten\n",139],["T_WHITESPACE","                ",140],["T_BREAK","break",140],";",["T_WHITESPACE","\n            ",140],["T_CASE","case",141],["T_WHITESPACE"," ",141],["T_LNUMBER","406",141],":",["T_WHITESPACE","\n                ",141],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/QuotaExceeded.php';\n",142],["T_WHITESPACE","                ",143],["T_THROW","throw",143],["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_STRING","Zend_Mobile_Push_Exception_QuotaExceeded",143],"(",["T_CONSTANT_ENCAPSED_STRING","'The unauthenticated web service has reached the per-day throttling limit'",143],")",";",["T_WHITESPACE","\n                ",143],["T_BREAK","break",144],";",["T_WHITESPACE","\n            ",144],["T_CASE","case",145],["T_WHITESPACE"," ",145],["T_LNUMBER","412",145],":",["T_WHITESPACE","\n                ",145],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/InvalidToken.php';\n",146],["T_WHITESPACE","                ",147],["T_THROW","throw",147],["T_WHITESPACE"," ",147],["T_NEW","new",147],["T_WHITESPACE"," ",147],["T_STRING","Zend_Mobile_Push_Exception_InvalidToken",147],"(",["T_CONSTANT_ENCAPSED_STRING","'The device is in an inactive state.  You may retry once per hour'",147],")",";",["T_WHITESPACE","\n                ",147],["T_BREAK","break",148],";",["T_WHITESPACE","\n            ",148],["T_CASE","case",149],["T_WHITESPACE"," ",149],["T_LNUMBER","503",149],":",["T_WHITESPACE","\n                ",149],["T_COMMENT","#require_once 'Zend\/Mobile\/Push\/Exception\/ServerUnavailable.php';\n",150],["T_WHITESPACE","                ",151],["T_THROW","throw",151],["T_WHITESPACE"," ",151],["T_NEW","new",151],["T_WHITESPACE"," ",151],["T_STRING","Zend_Mobile_Push_Exception_ServerUnavailable",151],"(",["T_CONSTANT_ENCAPSED_STRING","'The server was unavailable.'",151],")",";",["T_WHITESPACE","\n                ",151],["T_BREAK","break",152],";",["T_WHITESPACE","\n            ",152],["T_DEFAULT","default",153],":",["T_WHITESPACE","\n                ",153],["T_BREAK","break",154],";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_STRING","true",156],";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n",157],"}",["T_WHITESPACE","\n",158]]