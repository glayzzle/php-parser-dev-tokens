[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Cloud\n * @subpackage DocumentService\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",2],["T_WHITESPACE","\n\n",18],["T_COMMENT","#require_once 'Zend\/Cloud\/DocumentService\/Adapter\/AbstractAdapter.php';\n",20],["T_COMMENT","#require_once 'Zend\/Cloud\/DocumentService\/Adapter\/WindowsAzure\/Query.php';\n",21],["T_COMMENT","#require_once 'Zend\/Cloud\/DocumentService\/Exception.php';\n",22],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Storage\/DynamicTableEntity.php';\n",23],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Storage\/Table.php';\n",24],["T_WHITESPACE","\n",25],["T_DOC_COMMENT","\/**\n * SimpleDB adapter for document service.\n *\n * @category   Zend\n * @package    Zend_Cloud\n * @subpackage DocumentService\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",26],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Zend_Cloud_DocumentService_Adapter_WindowsAzure",35],["T_WHITESPACE","\n    ",35],["T_EXTENDS","extends",36],["T_WHITESPACE"," ",36],["T_STRING","Zend_Cloud_DocumentService_Adapter_AbstractAdapter",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_COMMENT","\/*\n     * Options array keys for the Azure adapter.\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","ACCOUNT_NAME",41],["T_WHITESPACE","          ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'storage_accountname'",41],";",["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","ACCOUNT_KEY",42],["T_WHITESPACE","           ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'storage_accountkey'",42],";",["T_WHITESPACE","\n    ",42],["T_CONST","const",43],["T_WHITESPACE"," ",43],["T_STRING","HOST",43],["T_WHITESPACE","                  ",43],"=",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","\"storage_host\"",43],";",["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","PROXY_HOST",44],["T_WHITESPACE","            ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","\"storage_proxy_host\"",44],";",["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","PROXY_PORT",45],["T_WHITESPACE","            ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","\"storage_proxy_port\"",45],";",["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","PROXY_CREDENTIALS",46],["T_WHITESPACE","     ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","\"storage_proxy_credentials\"",46],";",["T_WHITESPACE","\n    ",46],["T_CONST","const",47],["T_WHITESPACE"," ",47],["T_STRING","DEFAULT_PARTITION_KEY",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","\"default_partition_key\"",47],";",["T_WHITESPACE","\n\n    ",47],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","PARTITION_KEY",49],["T_WHITESPACE","         ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'PartitionKey'",49],";",["T_WHITESPACE","\n    ",49],["T_CONST","const",50],["T_WHITESPACE"," ",50],["T_STRING","ROW_KEY",50],["T_WHITESPACE","               ",50],"=",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'RowKey'",50],";",["T_WHITESPACE","\n    ",50],["T_CONST","const",51],["T_WHITESPACE"," ",51],["T_STRING","VERIFY_ETAG",51],["T_WHITESPACE","           ",51],"=",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","\"verify_etag\"",51],";",["T_WHITESPACE","\n    ",51],["T_CONST","const",52],["T_WHITESPACE"," ",52],["T_STRING","TIMESTAMP_KEY",52],["T_WHITESPACE","         ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","\"Timestamp\"",52],";",["T_WHITESPACE","\n\n    ",52],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","DEFAULT_HOST",54],["T_WHITESPACE","          ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","Zend_Service_WindowsAzure_Storage",54],["T_DOUBLE_COLON","::",54],["T_STRING","URL_CLOUD_TABLE",54],";",["T_WHITESPACE","\n    ",54],["T_CONST","const",55],["T_WHITESPACE"," ",55],["T_STRING","DEFAULT_QUERY_CLASS",55],["T_WHITESPACE","   ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query'",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Azure  service instance.\n     *\n     * @var Zend_Service_WindowsAzure_Storage_Table\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_storageClient",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Class to utilize for new query objects\n     *\n     * @var string\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_queryClass",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query'",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Partition key to use by default when constructing document identifiers\n     * @var string\n     *\/",71],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_defaultPartitionKey",75],";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param array $options\n     * @return void\n     *\/",77],["T_WHITESPACE","\n    ",82],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","__construct",83],"(",["T_VARIABLE","$options",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",")",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$options",85],["T_WHITESPACE"," ",85],["T_INSTANCEOF","instanceof",85],["T_WHITESPACE"," ",85],["T_STRING","Zend_Config",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$options",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$options",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","toArray",86],"(",")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n\n        ",87],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_EMPTY","empty",89],"(",["T_VARIABLE","$options",89],")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$options",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_ARRAY","array",90],"(",")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_IF","if",93],["T_WHITESPACE"," ",93],"(","!",["T_STRING","is_array",93],"(",["T_VARIABLE","$options",93],")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_THROW","throw",94],["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","Zend_Cloud_DocumentService_Exception",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid options provided'",94],")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n\n        ",95],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_ISSET","isset",97],"(",["T_VARIABLE","$options",97],"[",["T_STRING","self",97],["T_DOUBLE_COLON","::",97],["T_STRING","DOCUMENT_CLASS",97],"]",")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","setDocumentClass",98],"(",["T_VARIABLE","$options",98],"[",["T_STRING","self",98],["T_DOUBLE_COLON","::",98],["T_STRING","DOCUMENT_CLASS",98],"]",")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_ISSET","isset",101],"(",["T_VARIABLE","$options",101],"[",["T_STRING","self",101],["T_DOUBLE_COLON","::",101],["T_STRING","DOCUMENTSET_CLASS",101],"]",")",")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","setDocumentSetClass",102],"(",["T_VARIABLE","$options",102],"[",["T_STRING","self",102],["T_DOUBLE_COLON","::",102],["T_STRING","DOCUMENTSET_CLASS",102],"]",")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n\n        ",103],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_ISSET","isset",105],"(",["T_VARIABLE","$options",105],"[",["T_STRING","self",105],["T_DOUBLE_COLON","::",105],["T_STRING","QUERY_CLASS",105],"]",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","setQueryClass",106],"(",["T_VARIABLE","$options",106],"[",["T_STRING","self",106],["T_DOUBLE_COLON","::",106],["T_STRING","QUERY_CLASS",106],"]",")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_COMMENT","\/\/ Build Zend_Service_WindowsAzure_Storage_Blob instance\n",109],["T_WHITESPACE","        ",110],["T_IF","if",110],["T_WHITESPACE"," ",110],"(","!",["T_ISSET","isset",110],"(",["T_VARIABLE","$options",110],"[",["T_STRING","self",110],["T_DOUBLE_COLON","::",110],["T_STRING","HOST",110],"]",")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$host",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","self",111],["T_DOUBLE_COLON","::",111],["T_STRING","DEFAULT_HOST",111],";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE"," ",112],["T_ELSE","else",112],["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$host",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$options",113],"[",["T_STRING","self",113],["T_DOUBLE_COLON","::",113],["T_STRING","HOST",113],"]",";",["T_WHITESPACE","\n        ",113],"}",["T_WHITESPACE","\n\n        ",114],["T_IF","if",116],["T_WHITESPACE"," ",116],"(","!",["T_WHITESPACE"," ",116],["T_ISSET","isset",116],"(",["T_VARIABLE","$options",116],"[",["T_STRING","self",116],["T_DOUBLE_COLON","::",116],["T_STRING","ACCOUNT_NAME",116],"]",")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_THROW","throw",117],["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_STRING","Zend_Cloud_DocumentService_Exception",117],"(",["T_CONSTANT_ENCAPSED_STRING","'No Windows Azure account name provided.'",117],")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_WHITESPACE"," ",120],["T_ISSET","isset",120],"(",["T_VARIABLE","$options",120],"[",["T_STRING","self",120],["T_DOUBLE_COLON","::",120],["T_STRING","ACCOUNT_KEY",120],"]",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_THROW","throw",121],["T_WHITESPACE"," ",121],["T_NEW","new",121],["T_WHITESPACE"," ",121],["T_STRING","Zend_Cloud_DocumentService_Exception",121],"(",["T_CONSTANT_ENCAPSED_STRING","'No Windows Azure account key provided.'",121],")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n\n        ",122],["T_COMMENT","\/\/ TODO: support $usePathStyleUri and $retryPolicy\n",124],["T_WHITESPACE","        ",125],["T_TRY","try",125],["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_storageClient",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_STRING","Zend_Service_WindowsAzure_Storage_Table",126],"(",["T_WHITESPACE","\n                    ",126],["T_VARIABLE","$host",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$options",127],"[",["T_STRING","self",127],["T_DOUBLE_COLON","::",127],["T_STRING","ACCOUNT_NAME",127],"]",",",["T_WHITESPACE"," ",127],["T_VARIABLE","$options",127],"[",["T_STRING","self",127],["T_DOUBLE_COLON","::",127],["T_STRING","ACCOUNT_KEY",127],"]",")",";",["T_WHITESPACE","\n            ",127],["T_COMMENT","\/\/ Parse other options\n",128],["T_WHITESPACE","            ",129],["T_IF","if",129],["T_WHITESPACE"," ",129],"(","!",["T_WHITESPACE"," ",129],["T_EMPTY","empty",129],"(",["T_VARIABLE","$options",129],"[",["T_STRING","self",129],["T_DOUBLE_COLON","::",129],["T_STRING","PROXY_HOST",129],"]",")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$proxyHost",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$options",130],"[",["T_STRING","self",130],["T_DOUBLE_COLON","::",130],["T_STRING","PROXY_HOST",130],"]",";",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$proxyPort",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_ISSET","isset",131],"(",["T_VARIABLE","$options",131],"[",["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","PROXY_PORT",131],"]",")",["T_WHITESPACE"," ",131],"?",["T_WHITESPACE"," ",131],["T_VARIABLE","$options",131],"[",["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","PROXY_PORT",131],"]",["T_WHITESPACE"," ",131],":",["T_WHITESPACE"," ",131],["T_LNUMBER","8080",131],";",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$proxyCredentials",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ISSET","isset",132],"(",["T_VARIABLE","$options",132],"[",["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","PROXY_CREDENTIALS",132],"]",")",["T_WHITESPACE"," ",132],"?",["T_WHITESPACE"," ",132],["T_VARIABLE","$options",132],"[",["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","PROXY_CREDENTIALS",132],"]",["T_WHITESPACE"," ",132],":",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","''",132],";",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_storageClient",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","setProxy",133],"(",["T_STRING","true",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$proxyHost",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$proxyPort",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$proxyCredentials",133],")",";",["T_WHITESPACE","\n            ",133],"}",["T_WHITESPACE","\n            ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_ISSET","isset",135],"(",["T_VARIABLE","$options",135],"[",["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","HTTP_ADAPTER",135],"]",")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_storageClient",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","setHttpClientChannel",136],"(",["T_VARIABLE","$options",136],"[",["T_STRING","self",136],["T_DOUBLE_COLON","::",136],["T_STRING","HTTP_ADAPTER",136],"]",")",";",["T_WHITESPACE","\n            ",136],"}",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE"," ",138],["T_CATCH","catch",138],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$e",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_THROW","throw",139],["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","Zend_Cloud_DocumentService_Exception",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document service creation: '",139],".",["T_VARIABLE","$e",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getMessage",139],"(",")",",",["T_WHITESPACE"," ",139],["T_VARIABLE","$e",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getCode",139],"(",")",",",["T_WHITESPACE"," ",139],["T_VARIABLE","$e",139],")",";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n\n    ",141],["T_DOC_COMMENT","\/**\n     * Set the default partition key\n     *\n     * @param  string $key\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure\n     *\/",143],["T_WHITESPACE","\n    ",148],["T_PUBLIC","public",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","setDefaultPartitionKey",149],"(",["T_VARIABLE","$key",149],")",["T_WHITESPACE","\n    ",149],"{",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_validateKey",151],"(",["T_VARIABLE","$key",151],")",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_defaultPartitionKey",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$key",152],";",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Retrieve default partition key\n     *\n     * @return null|string\n     *\/",156],["T_WHITESPACE","\n    ",160],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","getDefaultPartitionKey",161],"(",")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_defaultPartitionKey",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Create collection.\n     *\n     * @param  string $name\n     * @param  array  $options\n     * @return boolean\n     *\/",166],["T_WHITESPACE","\n    ",172],["T_PUBLIC","public",173],["T_WHITESPACE"," ",173],["T_FUNCTION","function",173],["T_WHITESPACE"," ",173],["T_STRING","createCollection",173],"(",["T_VARIABLE","$name",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$options",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","null",173],")",["T_WHITESPACE","\n    ",173],"{",["T_WHITESPACE","\n        ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(","!",["T_STRING","preg_match",175],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[A-Za-z][A-Za-z0-9]{2,}$\/'",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$name",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_THROW","throw",176],["T_WHITESPACE"," ",176],["T_NEW","new",176],["T_WHITESPACE"," ",176],["T_STRING","Zend_Cloud_DocumentService_Exception",176],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid collection name; Windows Azure collection names must consist of alphanumeric characters only, and be at least 3 characters long'",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n        ",177],["T_TRY","try",178],["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_storageClient",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","createTable",179],"(",["T_VARIABLE","$name",179],")",";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE"," ",180],["T_CATCH","catch",180],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$e",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_STRING","strpos",181],"(",["T_VARIABLE","$e",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getMessage",181],"(",")",",",["T_WHITESPACE"," ",181],["T_CONSTANT_ENCAPSED_STRING","\"table specified already exists\"",181],")",["T_WHITESPACE"," ",181],["T_IS_IDENTICAL","===",181],["T_WHITESPACE"," ",181],["T_STRING","false",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                ",181],["T_THROW","throw",182],["T_WHITESPACE"," ",182],["T_NEW","new",182],["T_WHITESPACE"," ",182],["T_STRING","Zend_Cloud_DocumentService_Exception",182],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on collection creation: '",182],".",["T_VARIABLE","$e",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getMessage",182],"(",")",",",["T_WHITESPACE"," ",182],["T_VARIABLE","$e",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getCode",182],"(",")",",",["T_WHITESPACE"," ",182],["T_VARIABLE","$e",182],")",";",["T_WHITESPACE","\n            ",182],"}",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n        ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_STRING","true",185],";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Delete collection.\n     *\n     * @param  string $name\n     * @param  array  $options\n     * @return boolean\n     *\/",188],["T_WHITESPACE","\n    ",194],["T_PUBLIC","public",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","deleteCollection",195],"(",["T_VARIABLE","$name",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$options",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_STRING","null",195],")",["T_WHITESPACE","\n    ",195],"{",["T_WHITESPACE","\n        ",196],["T_TRY","try",197],["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_storageClient",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","deleteTable",198],"(",["T_VARIABLE","$name",198],")",";",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE"," ",199],["T_CATCH","catch",199],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$e",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_STRING","strpos",200],"(",["T_VARIABLE","$e",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getMessage",200],"(",")",",",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"does not exist\"",200],")",["T_WHITESPACE"," ",200],["T_IS_IDENTICAL","===",200],["T_WHITESPACE"," ",200],["T_STRING","false",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_THROW","throw",201],["T_WHITESPACE"," ",201],["T_NEW","new",201],["T_WHITESPACE"," ",201],["T_STRING","Zend_Cloud_DocumentService_Exception",201],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on collection deletion: '",201],".",["T_VARIABLE","$e",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getMessage",201],"(",")",",",["T_WHITESPACE"," ",201],["T_VARIABLE","$e",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getCode",201],"(",")",",",["T_WHITESPACE"," ",201],["T_VARIABLE","$e",201],")",";",["T_WHITESPACE","\n            ",201],"}",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n        ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_STRING","true",204],";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n\n    ",205],["T_DOC_COMMENT","\/**\n     * List collections.\n     *\n     * @param  array  $options\n     * @return array\n     *\/",207],["T_WHITESPACE","\n    ",212],["T_PUBLIC","public",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","listCollections",213],"(",["T_VARIABLE","$options",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","null",213],")",["T_WHITESPACE","\n    ",213],"{",["T_WHITESPACE","\n        ",214],["T_TRY","try",215],["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$tables",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_storageClient",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","listTables",216],"(",")",";",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$restables",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_ARRAY","array",217],"(",")",";",["T_WHITESPACE","\n            ",217],["T_FOREACH","foreach",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$tables",218],["T_WHITESPACE"," ",218],["T_AS","as",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$table",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n                ",218],["T_VARIABLE","$restables",219],"[","]",["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$table",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","name",219],";",["T_WHITESPACE","\n            ",219],"}",["T_WHITESPACE","\n            ",220],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$restables",221],";",["T_WHITESPACE","\n        ",221],"}",["T_WHITESPACE"," ",222],["T_CATCH","catch",222],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$e",222],")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_THROW","throw",223],["T_WHITESPACE"," ",223],["T_NEW","new",223],["T_WHITESPACE"," ",223],["T_STRING","Zend_Cloud_DocumentService_Exception",223],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on collection list: '",223],".",["T_VARIABLE","$e",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getMessage",223],"(",")",",",["T_WHITESPACE"," ",223],["T_VARIABLE","$e",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getCode",223],"(",")",",",["T_WHITESPACE"," ",223],["T_VARIABLE","$e",223],")",";",["T_WHITESPACE","\n        ",223],"}",["T_WHITESPACE","\n\n        ",224],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$tables",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Create suitable document from array of fields\n     *\n     * @param  array $document\n     * @param  null|string $collectionName Collection to which this document belongs\n     * @return Zend_Cloud_DocumentService_Document\n     *\/",229],["T_WHITESPACE","\n    ",235],["T_PROTECTED","protected",236],["T_WHITESPACE"," ",236],["T_FUNCTION","function",236],["T_WHITESPACE"," ",236],["T_STRING","_getDocumentFromArray",236],"(",["T_VARIABLE","$document",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$collectionName",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_STRING","null",236],")",["T_WHITESPACE","\n    ",236],"{",["T_WHITESPACE","\n        ",237],["T_VARIABLE","$key",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_STRING","null",238],";",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(","!",["T_ISSET","isset",239],"(",["T_VARIABLE","$document",239],"[",["T_STRING","Zend_Cloud_DocumentService_Document",239],["T_DOUBLE_COLON","::",239],["T_STRING","KEY_FIELD",239],"]",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_ISSET","isset",240],"(",["T_VARIABLE","$document",240],"[",["T_STRING","self",240],["T_DOUBLE_COLON","::",240],["T_STRING","ROW_KEY",240],"]",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n                ",240],["T_VARIABLE","$rowKey",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$document",241],"[",["T_STRING","self",241],["T_DOUBLE_COLON","::",241],["T_STRING","ROW_KEY",241],"]",";",["T_WHITESPACE","\n                    ",241],["T_UNSET","unset",242],"(",["T_VARIABLE","$document",242],"[",["T_STRING","self",242],["T_DOUBLE_COLON","::",242],["T_STRING","ROW_KEY",242],"]",")",";",["T_WHITESPACE","\n                ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_ISSET","isset",243],"(",["T_VARIABLE","$document",243],"[",["T_STRING","self",243],["T_DOUBLE_COLON","::",243],["T_STRING","PARTITION_KEY",243],"]",")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n                    ",243],["T_VARIABLE","$key",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",["T_VARIABLE","$document",244],"[",["T_STRING","self",244],["T_DOUBLE_COLON","::",244],["T_STRING","PARTITION_KEY",244],"]",",",["T_WHITESPACE"," ",244],["T_VARIABLE","$rowKey",244],")",";",["T_WHITESPACE","\n                    ",244],["T_UNSET","unset",245],"(",["T_VARIABLE","$document",245],"[",["T_STRING","self",245],["T_DOUBLE_COLON","::",245],["T_STRING","PARTITION_KEY",245],"]",")",";",["T_WHITESPACE","\n                ",245],"}",["T_WHITESPACE"," ",246],["T_ELSEIF","elseif",246],["T_WHITESPACE"," ",246],"(",["T_STRING","null",246],["T_WHITESPACE"," ",246],["T_IS_NOT_IDENTICAL","!==",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$partitionKey",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getDefaultPartitionKey",246],"(",")",")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                    ",246],["T_VARIABLE","$key",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_ARRAY","array",247],"(",["T_VARIABLE","$partitionKey",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$rowKey",247],")",";",["T_WHITESPACE","\n                ",247],"}",["T_WHITESPACE"," ",248],["T_ELSEIF","elseif",248],["T_WHITESPACE"," ",248],"(",["T_STRING","null",248],["T_WHITESPACE"," ",248],["T_IS_NOT_IDENTICAL","!==",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$collectionName",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                    ",248],["T_VARIABLE","$key",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_ARRAY","array",249],"(",["T_VARIABLE","$collectionName",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$rowKey",249],")",";",["T_WHITESPACE","\n                ",249],"}",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE","\n        ",251],"}",["T_WHITESPACE"," ",252],["T_ELSE","else",252],["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$key",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$document",253],"[",["T_STRING","Zend_Cloud_DocumentService_Document",253],["T_DOUBLE_COLON","::",253],["T_STRING","KEY_FIELD",253],"]",";",["T_WHITESPACE","\n            ",253],["T_UNSET","unset",254],"(",["T_VARIABLE","$document",254],"[",["T_STRING","Zend_Cloud_DocumentService_Document",254],["T_DOUBLE_COLON","::",254],["T_STRING","KEY_FIELD",254],"]",")",";",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n\n        ",255],["T_VARIABLE","$documentClass",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getDocumentClass",257],"(",")",";",["T_WHITESPACE","\n        ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_NEW","new",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$documentClass",258],"(",["T_VARIABLE","$document",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$key",258],")",";",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n\n    ",259],["T_DOC_COMMENT","\/**\n     * List all documents in a collection\n     *\n     * @param  string $collectionName\n     * @param  null|array $options\n     * @return Zend_Cloud_DocumentService_DocumentSet\n     *\/",261],["T_WHITESPACE","\n    ",267],["T_PUBLIC","public",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","listDocuments",268],"(",["T_VARIABLE","$collectionName",268],",",["T_WHITESPACE"," ",268],["T_ARRAY","array",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$options",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","null",268],")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$select",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","select",270],"(",")",["T_OBJECT_OPERATOR","->",270],["T_STRING","from",270],"(",["T_VARIABLE","$collectionName",270],")",";",["T_WHITESPACE","\n        ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","query",271],"(",["T_VARIABLE","$collectionName",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$select",271],")",";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Insert document\n     *\n     * @param  array|Zend_Cloud_DocumentService_Document $document\n     * @param  array                         $options\n     * @return boolean\n     *\/",274],["T_WHITESPACE","\n    ",280],["T_PUBLIC","public",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","insertDocument",281],"(",["T_VARIABLE","$collectionName",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$document",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$options",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","null",281],")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_STRING","is_array",283],"(",["T_VARIABLE","$document",283],")",")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$document",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE","  ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","_getDocumentFromArray",284],"(",["T_VARIABLE","$document",284],",",["T_WHITESPACE"," ",284],["T_VARIABLE","$collectionName",284],")",";",["T_WHITESPACE","\n        ",284],"}",["T_WHITESPACE","\n\n        ",285],["T_IF","if",287],["T_WHITESPACE"," ",287],"(","!",["T_VARIABLE","$document",287],["T_WHITESPACE"," ",287],["T_INSTANCEOF","instanceof",287],["T_WHITESPACE"," ",287],["T_STRING","Zend_Cloud_DocumentService_Document",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_THROW","throw",288],["T_WHITESPACE"," ",288],["T_NEW","new",288],["T_WHITESPACE"," ",288],["T_STRING","Zend_Cloud_DocumentService_Exception",288],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid document supplied'",288],")",";",["T_WHITESPACE","\n        ",288],"}",["T_WHITESPACE","\n\n        ",289],["T_VARIABLE","$key",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_validateDocumentId",291],"(",["T_VARIABLE","$document",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getId",291],"(",")",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$collectionName",291],")",";",["T_WHITESPACE","\n        ",291],["T_VARIABLE","$document",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","setId",292],"(",["T_VARIABLE","$key",292],")",";",["T_WHITESPACE","\n\n        ",292],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_validateCompositeKey",294],"(",["T_VARIABLE","$key",294],")",";",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_validateFields",295],"(",["T_VARIABLE","$document",295],")",";",["T_WHITESPACE","\n        ",295],["T_TRY","try",296],["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n\n            ",296],["T_VARIABLE","$entity",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_NEW","new",298],["T_WHITESPACE"," ",298],["T_STRING","Zend_Service_WindowsAzure_Storage_DynamicTableEntity",298],"(",["T_VARIABLE","$key",298],"[",["T_LNUMBER","0",298],"]",",",["T_WHITESPACE"," ",298],["T_VARIABLE","$key",298],"[",["T_LNUMBER","1",298],"]",")",";",["T_WHITESPACE","\n            ",298],["T_VARIABLE","$entity",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","setAzureValues",299],"(",["T_VARIABLE","$document",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getFields",299],"(",")",",",["T_WHITESPACE"," ",299],["T_STRING","true",299],")",";",["T_WHITESPACE","\n            ",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_storageClient",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","insertEntity",300],"(",["T_VARIABLE","$collectionName",300],",",["T_WHITESPACE"," ",300],["T_VARIABLE","$entity",300],")",";",["T_WHITESPACE","\n        ",300],"}",["T_WHITESPACE"," ",301],["T_CATCH","catch",301],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$e",301],")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n            ",301],["T_THROW","throw",302],["T_WHITESPACE"," ",302],["T_NEW","new",302],["T_WHITESPACE"," ",302],["T_STRING","Zend_Cloud_DocumentService_Exception",302],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document insertion: '",302],".",["T_VARIABLE","$e",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getMessage",302],"(",")",",",["T_WHITESPACE"," ",302],["T_VARIABLE","$e",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getCode",302],"(",")",",",["T_WHITESPACE"," ",302],["T_VARIABLE","$e",302],")",";",["T_WHITESPACE","\n        ",302],"}",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n\n    ",304],["T_DOC_COMMENT","\/**\n     * Replace document.\n     *\n     * The new document replaces the existing document.\n     *\n     * @param  Zend_Cloud_DocumentService_Document $document\n     * @param  array                         $options\n     * @return boolean\n     *\/",306],["T_WHITESPACE","\n    ",314],["T_PUBLIC","public",315],["T_WHITESPACE"," ",315],["T_FUNCTION","function",315],["T_WHITESPACE"," ",315],["T_STRING","replaceDocument",315],"(",["T_VARIABLE","$collectionName",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$document",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$options",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_STRING","null",315],")",["T_WHITESPACE","\n    ",315],"{",["T_WHITESPACE","\n        ",316],["T_IF","if",317],["T_WHITESPACE"," ",317],"(",["T_STRING","is_array",317],"(",["T_VARIABLE","$document",317],")",")",["T_WHITESPACE"," ",317],"{",["T_WHITESPACE","\n            ",317],["T_VARIABLE","$document",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_getDocumentFromArray",318],"(",["T_VARIABLE","$document",318],",",["T_WHITESPACE"," ",318],["T_VARIABLE","$collectionName",318],")",";",["T_WHITESPACE","\n        ",318],"}",["T_WHITESPACE","\n\n        ",319],["T_IF","if",321],["T_WHITESPACE"," ",321],"(","!",["T_VARIABLE","$document",321],["T_WHITESPACE"," ",321],["T_INSTANCEOF","instanceof",321],["T_WHITESPACE"," ",321],["T_STRING","Zend_Cloud_DocumentService_Document",321],")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n            ",321],["T_THROW","throw",322],["T_WHITESPACE"," ",322],["T_NEW","new",322],["T_WHITESPACE"," ",322],["T_STRING","Zend_Cloud_DocumentService_Exception",322],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid document supplied'",322],")",";",["T_WHITESPACE","\n        ",322],"}",["T_WHITESPACE","\n\n        ",323],["T_VARIABLE","$key",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_validateDocumentId",325],"(",["T_VARIABLE","$document",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getId",325],"(",")",",",["T_WHITESPACE"," ",325],["T_VARIABLE","$collectionName",325],")",";",["T_WHITESPACE","\n        ",325],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","_validateFields",326],"(",["T_VARIABLE","$document",326],")",";",["T_WHITESPACE","\n        ",326],["T_TRY","try",327],["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_VARIABLE","$entity",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_NEW","new",328],["T_WHITESPACE"," ",328],["T_STRING","Zend_Service_WindowsAzure_Storage_DynamicTableEntity",328],"(",["T_VARIABLE","$key",328],"[",["T_LNUMBER","0",328],"]",",",["T_WHITESPACE"," ",328],["T_VARIABLE","$key",328],"[",["T_LNUMBER","1",328],"]",")",";",["T_WHITESPACE","\n            ",328],["T_VARIABLE","$entity",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","setAzureValues",329],"(",["T_VARIABLE","$document",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","getFields",329],"(",")",",",["T_WHITESPACE"," ",329],["T_STRING","true",329],")",";",["T_WHITESPACE","\n            ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_ISSET","isset",330],"(",["T_VARIABLE","$options",330],"[",["T_STRING","self",330],["T_DOUBLE_COLON","::",330],["T_STRING","VERIFY_ETAG",330],"]",")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n                ",330],["T_VARIABLE","$entity",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","setEtag",331],"(",["T_VARIABLE","$options",331],"[",["T_STRING","self",331],["T_DOUBLE_COLON","::",331],["T_STRING","VERIFY_ETAG",331],"]",")",";",["T_WHITESPACE","\n            ",331],"}",["T_WHITESPACE","\n\n            ",332],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_storageClient",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","updateEntity",334],"(",["T_VARIABLE","$collectionName",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$entity",334],",",["T_WHITESPACE"," ",334],["T_ISSET","isset",334],"(",["T_VARIABLE","$options",334],"[",["T_STRING","self",334],["T_DOUBLE_COLON","::",334],["T_STRING","VERIFY_ETAG",334],"]",")",")",";",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE"," ",335],["T_CATCH","catch",335],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$e",335],")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n            ",335],["T_THROW","throw",336],["T_WHITESPACE"," ",336],["T_NEW","new",336],["T_WHITESPACE"," ",336],["T_STRING","Zend_Cloud_DocumentService_Exception",336],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document replace: '",336],".",["T_VARIABLE","$e",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getMessage",336],"(",")",",",["T_WHITESPACE"," ",336],["T_VARIABLE","$e",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getCode",336],"(",")",",",["T_WHITESPACE"," ",336],["T_VARIABLE","$e",336],")",";",["T_WHITESPACE","\n        ",336],"}",["T_WHITESPACE","\n    ",337],"}",["T_WHITESPACE","\n\n    ",338],["T_DOC_COMMENT","\/**\n     * Update document.\n     *\n     * The new document is merged the existing document.\n     *\n     * @param  string $collectionName\n     * @param  mixed|Zend_Cloud_DocumentService_Document $documentId Document identifier or document contaiing updates\n     * @param  null|array|Zend_Cloud_DocumentService_Document Fields to update (or new fields))\n     * @param  array $options\n     * @return boolean\n     *\/",340],["T_WHITESPACE","\n    ",350],["T_PUBLIC","public",351],["T_WHITESPACE"," ",351],["T_FUNCTION","function",351],["T_WHITESPACE"," ",351],["T_STRING","updateDocument",351],"(",["T_VARIABLE","$collectionName",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$documentId",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$fieldset",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","null",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$options",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","null",351],")",["T_WHITESPACE","\n    ",351],"{",["T_WHITESPACE","\n        ",352],["T_IF","if",353],["T_WHITESPACE"," ",353],"(",["T_STRING","null",353],["T_WHITESPACE"," ",353],["T_IS_IDENTICAL","===",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$fieldset",353],["T_WHITESPACE"," ",353],["T_BOOLEAN_AND","&&",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$documentId",353],["T_WHITESPACE"," ",353],["T_INSTANCEOF","instanceof",353],["T_WHITESPACE"," ",353],["T_STRING","Zend_Cloud_DocumentService_Document",353],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n            ",353],["T_VARIABLE","$fieldset",354],["T_WHITESPACE","   ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$documentId",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getFields",354],"(",")",";",["T_WHITESPACE","\n            ",354],["T_VARIABLE","$documentId",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$documentId",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getId",355],"(",")",";",["T_WHITESPACE","\n        ",355],"}",["T_WHITESPACE"," ",356],["T_ELSEIF","elseif",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$fieldset",356],["T_WHITESPACE"," ",356],["T_INSTANCEOF","instanceof",356],["T_WHITESPACE"," ",356],["T_STRING","Zend_Cloud_DocumentService_Document",356],")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n            ",356],["T_IF","if",357],["T_WHITESPACE"," ",357],"(",["T_VARIABLE","$documentId",357],["T_WHITESPACE"," ",357],["T_IS_EQUAL","==",357],["T_WHITESPACE"," ",357],["T_STRING","null",357],")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n                ",357],["T_VARIABLE","$documentId",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$fieldset",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","getId",358],"(",")",";",["T_WHITESPACE","\n            ",358],"}",["T_WHITESPACE","\n            ",359],["T_VARIABLE","$fieldset",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$fieldset",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getFields",360],"(",")",";",["T_WHITESPACE","\n        ",360],"}",["T_WHITESPACE","\n\n        ",361],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_validateCompositeKey",363],"(",["T_VARIABLE","$documentId",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$collectionName",363],")",";",["T_WHITESPACE","\n        ",363],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","_validateFields",364],"(",["T_VARIABLE","$fieldset",364],")",";",["T_WHITESPACE","\n        ",364],["T_TRY","try",365],["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n            ",365],["T_VARIABLE","$entity",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_NEW","new",366],["T_WHITESPACE"," ",366],["T_STRING","Zend_Service_WindowsAzure_Storage_DynamicTableEntity",366],"(",["T_VARIABLE","$documentId",366],"[",["T_LNUMBER","0",366],"]",",",["T_WHITESPACE"," ",366],["T_VARIABLE","$documentId",366],"[",["T_LNUMBER","1",366],"]",")",";",["T_WHITESPACE","\n\n            ",366],["T_COMMENT","\/\/ Ensure timestamp is set correctly\n",368],["T_WHITESPACE","            ",369],["T_IF","if",369],["T_WHITESPACE"," ",369],"(",["T_ISSET","isset",369],"(",["T_VARIABLE","$fieldset",369],"[",["T_STRING","self",369],["T_DOUBLE_COLON","::",369],["T_STRING","TIMESTAMP_KEY",369],"]",")",")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n                ",369],["T_VARIABLE","$entity",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","setTimestamp",370],"(",["T_VARIABLE","$fieldset",370],"[",["T_STRING","self",370],["T_DOUBLE_COLON","::",370],["T_STRING","TIMESTAMP_KEY",370],"]",")",";",["T_WHITESPACE","\n                ",370],["T_UNSET","unset",371],"(",["T_VARIABLE","$fieldset",371],"[",["T_STRING","self",371],["T_DOUBLE_COLON","::",371],["T_STRING","TIMESTAMP_KEY",371],"]",")",";",["T_WHITESPACE","\n            ",371],"}",["T_WHITESPACE","\n\n            ",372],["T_VARIABLE","$entity",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","setAzureValues",374],"(",["T_VARIABLE","$fieldset",374],",",["T_WHITESPACE"," ",374],["T_STRING","true",374],")",";",["T_WHITESPACE","\n            ",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_ISSET","isset",375],"(",["T_VARIABLE","$options",375],"[",["T_STRING","self",375],["T_DOUBLE_COLON","::",375],["T_STRING","VERIFY_ETAG",375],"]",")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n                ",375],["T_VARIABLE","$entity",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","setEtag",376],"(",["T_VARIABLE","$options",376],"[",["T_STRING","self",376],["T_DOUBLE_COLON","::",376],["T_STRING","VERIFY_ETAG",376],"]",")",";",["T_WHITESPACE","\n            ",376],"}",["T_WHITESPACE","\n\n            ",377],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","_storageClient",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","mergeEntity",379],"(",["T_VARIABLE","$collectionName",379],",",["T_WHITESPACE"," ",379],["T_VARIABLE","$entity",379],",",["T_WHITESPACE"," ",379],["T_ISSET","isset",379],"(",["T_VARIABLE","$options",379],"[",["T_STRING","self",379],["T_DOUBLE_COLON","::",379],["T_STRING","VERIFY_ETAG",379],"]",")",")",";",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE"," ",380],["T_CATCH","catch",380],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$e",380],")",["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n            ",380],["T_THROW","throw",381],["T_WHITESPACE"," ",381],["T_NEW","new",381],["T_WHITESPACE"," ",381],["T_STRING","Zend_Cloud_DocumentService_Exception",381],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document update: '",381],".",["T_VARIABLE","$e",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getMessage",381],"(",")",",",["T_WHITESPACE"," ",381],["T_VARIABLE","$e",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getCode",381],"(",")",",",["T_WHITESPACE"," ",381],["T_VARIABLE","$e",381],")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE","\n    ",382],"}",["T_WHITESPACE","\n\n    ",383],["T_DOC_COMMENT","\/**\n     * Delete document.\n     *\n     * @param  mixed  $document Document ID or Document object.\n     * @param  array  $options\n     * @return void\n     *\/",385],["T_WHITESPACE","\n    ",391],["T_PUBLIC","public",392],["T_WHITESPACE"," ",392],["T_FUNCTION","function",392],["T_WHITESPACE"," ",392],["T_STRING","deleteDocument",392],"(",["T_VARIABLE","$collectionName",392],",",["T_WHITESPACE"," ",392],["T_VARIABLE","$documentId",392],",",["T_WHITESPACE"," ",392],["T_VARIABLE","$options",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_STRING","null",392],")",["T_WHITESPACE","\n    ",392],"{",["T_WHITESPACE","\n        ",393],["T_IF","if",394],["T_WHITESPACE"," ",394],"(",["T_VARIABLE","$documentId",394],["T_WHITESPACE"," ",394],["T_INSTANCEOF","instanceof",394],["T_WHITESPACE"," ",394],["T_STRING","Zend_Cloud_DocumentService_Document",394],")",["T_WHITESPACE"," ",394],"{",["T_WHITESPACE","\n            ",394],["T_VARIABLE","$documentId",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_VARIABLE","$documentId",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","getId",395],"(",")",";",["T_WHITESPACE","\n        ",395],"}",["T_WHITESPACE","\n\n        ",396],["T_VARIABLE","$documentId",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_validateDocumentId",398],"(",["T_VARIABLE","$documentId",398],",",["T_WHITESPACE"," ",398],["T_VARIABLE","$collectionName",398],")",";",["T_WHITESPACE","\n\n        ",398],["T_TRY","try",400],["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n            ",400],["T_VARIABLE","$entity",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_NEW","new",401],["T_WHITESPACE"," ",401],["T_STRING","Zend_Service_WindowsAzure_Storage_DynamicTableEntity",401],"(",["T_VARIABLE","$documentId",401],"[",["T_LNUMBER","0",401],"]",",",["T_WHITESPACE"," ",401],["T_VARIABLE","$documentId",401],"[",["T_LNUMBER","1",401],"]",")",";",["T_WHITESPACE","\n            ",401],["T_IF","if",402],["T_WHITESPACE"," ",402],"(",["T_ISSET","isset",402],"(",["T_VARIABLE","$options",402],"[",["T_STRING","self",402],["T_DOUBLE_COLON","::",402],["T_STRING","VERIFY_ETAG",402],"]",")",")",["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n                ",402],["T_VARIABLE","$entity",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","setEtag",403],"(",["T_VARIABLE","$options",403],"[",["T_STRING","self",403],["T_DOUBLE_COLON","::",403],["T_STRING","VERIFY_ETAG",403],"]",")",";",["T_WHITESPACE","\n            ",403],"}",["T_WHITESPACE","\n            ",404],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","_storageClient",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","deleteEntity",405],"(",["T_VARIABLE","$collectionName",405],",",["T_WHITESPACE"," ",405],["T_VARIABLE","$entity",405],",",["T_WHITESPACE"," ",405],["T_ISSET","isset",405],"(",["T_VARIABLE","$options",405],"[",["T_STRING","self",405],["T_DOUBLE_COLON","::",405],["T_STRING","VERIFY_ETAG",405],"]",")",")",";",["T_WHITESPACE","\n        ",405],"}",["T_WHITESPACE"," ",406],["T_CATCH","catch",406],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$e",406],")",["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n            ",406],["T_IF","if",407],["T_WHITESPACE"," ",407],"(",["T_STRING","strpos",407],"(",["T_VARIABLE","$e",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","getMessage",407],"(",")",",",["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","\"does not exist\"",407],")",["T_WHITESPACE"," ",407],["T_IS_IDENTICAL","===",407],["T_WHITESPACE"," ",407],["T_STRING","false",407],")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n                ",407],["T_THROW","throw",408],["T_WHITESPACE"," ",408],["T_NEW","new",408],["T_WHITESPACE"," ",408],["T_STRING","Zend_Cloud_DocumentService_Exception",408],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document deletion: '",408],".",["T_VARIABLE","$e",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","getMessage",408],"(",")",",",["T_WHITESPACE"," ",408],["T_VARIABLE","$e",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","getCode",408],"(",")",",",["T_WHITESPACE"," ",408],["T_VARIABLE","$e",408],")",";",["T_WHITESPACE","\n            ",408],"}",["T_WHITESPACE","\n        ",409],"}",["T_WHITESPACE","\n    ",410],"}",["T_WHITESPACE","\n\n    ",411],["T_DOC_COMMENT","\/**\n     * Fetch single document by ID\n     *\n     * @param  string $collectionName Collection name\n     * @param  mixed $documentId Document ID, adapter-dependent\n     * @param  array $options\n     * @return Zend_Cloud_DocumentService_Document\n     *\/",413],["T_WHITESPACE","\n    ",420],["T_PUBLIC","public",421],["T_WHITESPACE"," ",421],["T_FUNCTION","function",421],["T_WHITESPACE"," ",421],["T_STRING","fetchDocument",421],"(",["T_VARIABLE","$collectionName",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$documentId",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$options",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","null",421],")",["T_WHITESPACE","\n    ",421],"{",["T_WHITESPACE","\n        ",422],["T_VARIABLE","$documentId",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","_validateDocumentId",423],"(",["T_VARIABLE","$documentId",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$collectionName",423],")",";",["T_WHITESPACE","\n        ",423],["T_TRY","try",424],["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n            ",424],["T_VARIABLE","$entity",425],["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","_storageClient",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","retrieveEntityById",425],"(",["T_VARIABLE","$collectionName",425],",",["T_WHITESPACE"," ",425],["T_VARIABLE","$documentId",425],"[",["T_LNUMBER","0",425],"]",",",["T_WHITESPACE"," ",425],["T_VARIABLE","$documentId",425],"[",["T_LNUMBER","1",425],"]",")",";",["T_WHITESPACE","\n            ",425],["T_VARIABLE","$documentClass",426],["T_WHITESPACE"," ",426],"=",["T_WHITESPACE"," ",426],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getDocumentClass",426],"(",")",";",["T_WHITESPACE","\n            ",426],["T_RETURN","return",427],["T_WHITESPACE"," ",427],["T_NEW","new",427],["T_WHITESPACE"," ",427],["T_VARIABLE","$documentClass",427],"(",["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","_resolveAttributes",427],"(",["T_VARIABLE","$entity",427],")",",",["T_WHITESPACE"," ",427],["T_ARRAY","array",427],"(",["T_VARIABLE","$entity",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getPartitionKey",427],"(",")",",",["T_WHITESPACE"," ",427],["T_VARIABLE","$entity",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getRowKey",427],"(",")",")",")",";",["T_WHITESPACE","\n        ",427],"}",["T_WHITESPACE"," ",428],["T_CATCH","catch",428],["T_WHITESPACE"," ",428],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",428],["T_WHITESPACE"," ",428],["T_VARIABLE","$e",428],")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n            ",428],["T_IF","if",429],["T_WHITESPACE"," ",429],"(",["T_STRING","strpos",429],"(",["T_VARIABLE","$e",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getMessage",429],"(",")",",",["T_WHITESPACE"," ",429],["T_CONSTANT_ENCAPSED_STRING","\"does not exist\"",429],")",["T_WHITESPACE"," ",429],["T_IS_NOT_IDENTICAL","!==",429],["T_WHITESPACE"," ",429],["T_STRING","false",429],")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n                ",429],["T_RETURN","return",430],["T_WHITESPACE"," ",430],["T_STRING","false",430],";",["T_WHITESPACE","\n            ",430],"}",["T_WHITESPACE","\n            ",431],["T_THROW","throw",432],["T_WHITESPACE"," ",432],["T_NEW","new",432],["T_WHITESPACE"," ",432],["T_STRING","Zend_Cloud_DocumentService_Exception",432],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document fetch: '",432],".",["T_VARIABLE","$e",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getMessage",432],"(",")",",",["T_WHITESPACE"," ",432],["T_VARIABLE","$e",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getCode",432],"(",")",",",["T_WHITESPACE"," ",432],["T_VARIABLE","$e",432],")",";",["T_WHITESPACE","\n        ",432],"}",["T_WHITESPACE","\n    ",433],"}",["T_WHITESPACE","\n\n    ",434],["T_DOC_COMMENT","\/**\n     * Query for documents stored in the document service. If a string is passed in\n     * $query, the query string will be passed directly to the service.\n     *\n     * @param  string $collectionName Collection name\n     * @param  string|Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query $query\n     * @param  array $options\n     * @return array Zend_Cloud_DocumentService_DocumentSet\n     *\/",436],["T_WHITESPACE","\n    ",444],["T_PUBLIC","public",445],["T_WHITESPACE"," ",445],["T_FUNCTION","function",445],["T_WHITESPACE"," ",445],["T_STRING","query",445],"(",["T_VARIABLE","$collectionName",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$query",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$options",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_STRING","null",445],")",["T_WHITESPACE","\n    ",445],"{",["T_WHITESPACE","\n        ",446],["T_TRY","try",447],["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n            ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_VARIABLE","$query",448],["T_WHITESPACE"," ",448],["T_INSTANCEOF","instanceof",448],["T_WHITESPACE"," ",448],["T_STRING","Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query",448],")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n                ",448],["T_VARIABLE","$entities",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","_storageClient",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","retrieveEntities",449],"(",["T_VARIABLE","$query",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","assemble",449],"(",")",")",";",["T_WHITESPACE","\n            ",449],"}",["T_WHITESPACE"," ",450],["T_ELSE","else",450],["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n                ",450],["T_VARIABLE","$entities",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","_storageClient",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","retrieveEntities",451],"(",["T_VARIABLE","$collectionName",451],",",["T_WHITESPACE"," ",451],["T_VARIABLE","$query",451],")",";",["T_WHITESPACE","\n            ",451],"}",["T_WHITESPACE","\n\n            ",452],["T_VARIABLE","$documentClass",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","getDocumentClass",454],"(",")",";",["T_WHITESPACE","\n            ",454],["T_VARIABLE","$resultSet",455],["T_WHITESPACE","     ",455],"=",["T_WHITESPACE"," ",455],["T_ARRAY","array",455],"(",")",";",["T_WHITESPACE","\n            ",455],["T_FOREACH","foreach",456],["T_WHITESPACE"," ",456],"(",["T_VARIABLE","$entities",456],["T_WHITESPACE"," ",456],["T_AS","as",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$entity",456],")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n                ",456],["T_VARIABLE","$resultSet",457],"[","]",["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_NEW","new",457],["T_WHITESPACE"," ",457],["T_VARIABLE","$documentClass",457],"(",["T_WHITESPACE","\n                    ",457],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_resolveAttributes",458],"(",["T_VARIABLE","$entity",458],")",",",["T_WHITESPACE","\n                    ",458],["T_ARRAY","array",459],"(",["T_VARIABLE","$entity",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","getPartitionKey",459],"(",")",",",["T_WHITESPACE"," ",459],["T_VARIABLE","$entity",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","getRowKey",459],"(",")",")",["T_WHITESPACE","\n                ",459],")",";",["T_WHITESPACE","\n            ",460],"}",["T_WHITESPACE","\n        ",461],"}",["T_WHITESPACE"," ",462],["T_CATCH","catch",462],"(",["T_STRING","Zend_Service_WindowsAzure_Exception",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$e",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_THROW","throw",463],["T_WHITESPACE"," ",463],["T_NEW","new",463],["T_WHITESPACE"," ",463],["T_STRING","Zend_Cloud_DocumentService_Exception",463],"(",["T_CONSTANT_ENCAPSED_STRING","'Error on document query: '",463],".",["T_VARIABLE","$e",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","getMessage",463],"(",")",",",["T_WHITESPACE"," ",463],["T_VARIABLE","$e",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","getCode",463],"(",")",",",["T_WHITESPACE"," ",463],["T_VARIABLE","$e",463],")",";",["T_WHITESPACE","\n        ",463],"}",["T_WHITESPACE","\n\n        ",464],["T_VARIABLE","$setClass",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","getDocumentSetClass",466],"(",")",";",["T_WHITESPACE","\n        ",466],["T_RETURN","return",467],["T_WHITESPACE"," ",467],["T_NEW","new",467],["T_WHITESPACE"," ",467],["T_VARIABLE","$setClass",467],"(",["T_VARIABLE","$resultSet",467],")",";",["T_WHITESPACE","\n    ",467],"}",["T_WHITESPACE","\n\n    ",468],["T_DOC_COMMENT","\/**\n     * Create query statement\n     *\n     * @return Zend_Cloud_DocumentService_Query\n     *\/",470],["T_WHITESPACE","\n    ",474],["T_PUBLIC","public",475],["T_WHITESPACE"," ",475],["T_FUNCTION","function",475],["T_WHITESPACE"," ",475],["T_STRING","select",475],"(",["T_VARIABLE","$fields",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_STRING","null",475],")",["T_WHITESPACE","\n    ",475],"{",["T_WHITESPACE","\n        ",476],["T_VARIABLE","$queryClass",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","getQueryClass",477],"(",")",";",["T_WHITESPACE","\n        ",477],["T_IF","if",478],["T_WHITESPACE"," ",478],"(","!",["T_STRING","class_exists",478],"(",["T_VARIABLE","$queryClass",478],")",")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n            ",478],["T_COMMENT","#require_once 'Zend\/Loader.php';\n",479],["T_WHITESPACE","            ",480],["T_STRING","Zend_Loader",480],["T_DOUBLE_COLON","::",480],["T_STRING","loadClass",480],"(",["T_VARIABLE","$queryClass",480],")",";",["T_WHITESPACE","\n        ",480],"}",["T_WHITESPACE","\n\n        ",481],["T_VARIABLE","$query",483],["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_NEW","new",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$queryClass",483],"(",")",";",["T_WHITESPACE","\n        ",483],["T_VARIABLE","$defaultClass",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_STRING","self",484],["T_DOUBLE_COLON","::",484],["T_STRING","DEFAULT_QUERY_CLASS",484],";",["T_WHITESPACE","\n        ",484],["T_IF","if",485],["T_WHITESPACE"," ",485],"(","!",["T_VARIABLE","$query",485],["T_WHITESPACE"," ",485],["T_INSTANCEOF","instanceof",485],["T_WHITESPACE"," ",485],["T_VARIABLE","$defaultClass",485],")",["T_WHITESPACE"," ",485],"{",["T_WHITESPACE","\n            ",485],["T_THROW","throw",486],["T_WHITESPACE"," ",486],["T_NEW","new",486],["T_WHITESPACE"," ",486],["T_STRING","Zend_Cloud_DocumentService_Exception",486],"(",["T_CONSTANT_ENCAPSED_STRING","'Query class must extend '",486],["T_WHITESPACE"," ",486],".",["T_WHITESPACE"," ",486],["T_STRING","self",486],["T_DOUBLE_COLON","::",486],["T_STRING","DEFAULT_QUERY_CLASS",486],")",";",["T_WHITESPACE","\n        ",486],"}",["T_WHITESPACE","\n\n        ",487],["T_VARIABLE","$query",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","select",489],"(",["T_VARIABLE","$fields",489],")",";",["T_WHITESPACE","\n        ",489],["T_RETURN","return",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$query",490],";",["T_WHITESPACE","\n    ",490],"}",["T_WHITESPACE","\n\n    ",491],["T_DOC_COMMENT","\/**\n     * Get the concrete service client\n     *\n     * @return Zend_Service_WindowsAzure_Storage_Table\n     *\/",493],["T_WHITESPACE","\n    ",497],["T_PUBLIC","public",498],["T_WHITESPACE"," ",498],["T_FUNCTION","function",498],["T_WHITESPACE"," ",498],["T_STRING","getClient",498],"(",")",["T_WHITESPACE","\n    ",498],"{",["T_WHITESPACE","\n        ",499],["T_RETURN","return",500],["T_WHITESPACE"," ",500],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","_storageClient",500],";",["T_WHITESPACE","\n    ",500],"}",["T_WHITESPACE","\n\n    ",501],["T_DOC_COMMENT","\/**\n     * Resolve table values to attributes\n     *\n     * @param  Zend_Service_WindowsAzure_Storage_TableEntity $entity\n     * @return array\n     *\/",503],["T_WHITESPACE","\n    ",508],["T_PROTECTED","protected",509],["T_WHITESPACE"," ",509],["T_FUNCTION","function",509],["T_WHITESPACE"," ",509],["T_STRING","_resolveAttributes",509],"(",["T_STRING","Zend_Service_WindowsAzure_Storage_TableEntity",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$entity",509],")",["T_WHITESPACE","\n    ",509],"{",["T_WHITESPACE","\n        ",510],["T_VARIABLE","$result",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_ARRAY","array",511],"(",")",";",["T_WHITESPACE","\n        ",511],["T_FOREACH","foreach",512],["T_WHITESPACE"," ",512],"(",["T_VARIABLE","$entity",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","getAzureValues",512],"(",")",["T_WHITESPACE"," ",512],["T_AS","as",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$attr",512],")",["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n            ",512],["T_VARIABLE","$result",513],"[",["T_VARIABLE","$attr",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","Name",513],"]",["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_VARIABLE","$attr",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","Value",513],";",["T_WHITESPACE","\n        ",513],"}",["T_WHITESPACE","\n        ",514],["T_RETURN","return",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$result",515],";",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n\n\n    ",516],["T_DOC_COMMENT","\/**\n     * Validate a partition or row key\n     *\n     * @param  string $key\n     * @return void\n     * @throws Zend_Cloud_DocumentService_Exception\n     *\/",519],["T_WHITESPACE","\n    ",525],["T_PROTECTED","protected",526],["T_WHITESPACE"," ",526],["T_FUNCTION","function",526],["T_WHITESPACE"," ",526],["T_STRING","_validateKey",526],"(",["T_VARIABLE","$key",526],")",["T_WHITESPACE","\n    ",526],"{",["T_WHITESPACE","\n        ",527],["T_IF","if",528],["T_WHITESPACE"," ",528],"(",["T_STRING","preg_match",528],"(",["T_CONSTANT_ENCAPSED_STRING","'@[\/#?'",528],["T_WHITESPACE"," ",528],".",["T_WHITESPACE"," ",528],["T_STRING","preg_quote",528],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",528],")",["T_WHITESPACE"," ",528],".",["T_WHITESPACE"," ",528],["T_CONSTANT_ENCAPSED_STRING","']@'",528],",",["T_WHITESPACE"," ",528],["T_VARIABLE","$key",528],")",")",["T_WHITESPACE"," ",528],"{",["T_WHITESPACE","\n            ",528],["T_THROW","throw",529],["T_WHITESPACE"," ",529],["T_NEW","new",529],["T_WHITESPACE"," ",529],["T_STRING","Zend_Cloud_DocumentService_Exception",529],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid partition or row key provided; must not contain \/, \\\\,  #, or ? characters'",529],")",";",["T_WHITESPACE","\n        ",529],"}",["T_WHITESPACE","\n    ",530],"}",["T_WHITESPACE","\n\n    ",531],["T_DOC_COMMENT","\/**\n     * Validate a composite key\n     *\n     * @param  array $key\n     * @return throws Zend_Cloud_DocumentService_Exception\n     *\/",533],["T_WHITESPACE","\n    ",538],["T_PROTECTED","protected",539],["T_WHITESPACE"," ",539],["T_FUNCTION","function",539],["T_WHITESPACE"," ",539],["T_STRING","_validateCompositeKey",539],"(",["T_ARRAY","array",539],["T_WHITESPACE"," ",539],["T_VARIABLE","$key",539],")",["T_WHITESPACE","\n    ",539],"{",["T_WHITESPACE","\n        ",540],["T_IF","if",541],["T_WHITESPACE"," ",541],"(",["T_LNUMBER","2",541],["T_WHITESPACE"," ",541],["T_IS_NOT_EQUAL","!=",541],["T_WHITESPACE"," ",541],["T_STRING","count",541],"(",["T_VARIABLE","$key",541],")",")",["T_WHITESPACE"," ",541],"{",["T_WHITESPACE","\n            ",541],["T_THROW","throw",542],["T_WHITESPACE"," ",542],["T_NEW","new",542],["T_WHITESPACE"," ",542],["T_STRING","Zend_Cloud_DocumentService_Exception",542],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid document key provided; must contain exactly two elements: a PartitionKey and a RowKey'",542],")",";",["T_WHITESPACE","\n        ",542],"}",["T_WHITESPACE","\n        ",543],["T_FOREACH","foreach",544],["T_WHITESPACE"," ",544],"(",["T_VARIABLE","$key",544],["T_WHITESPACE"," ",544],["T_AS","as",544],["T_WHITESPACE"," ",544],["T_VARIABLE","$k",544],")",["T_WHITESPACE"," ",544],"{",["T_WHITESPACE","\n            ",544],["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","_validateKey",545],"(",["T_VARIABLE","$k",545],")",";",["T_WHITESPACE","\n        ",545],"}",["T_WHITESPACE","\n    ",546],"}",["T_WHITESPACE","\n\n    ",547],["T_DOC_COMMENT","\/**\n     * Validate a document identifier\n     *\n     * If the identifier is an array containing a valid partition and row key,\n     * returns it. If the identifier is a string:\n     * - if a default partition key is present, it creates an identifier using\n     *   that and the provided document ID\n     * - if a collection name is provided, it will use that for the partition key\n     * - otherwise, it's invalid\n     *\n     * @param  array|string $documentId\n     * @param  null|string $collectionName\n     * @return array\n     * @throws Zend_Cloud_DocumentService_Exception\n     *\/",549],["T_WHITESPACE","\n    ",563],["T_PROTECTED","protected",564],["T_WHITESPACE"," ",564],["T_FUNCTION","function",564],["T_WHITESPACE"," ",564],["T_STRING","_validateDocumentId",564],"(",["T_VARIABLE","$documentId",564],",",["T_WHITESPACE"," ",564],["T_VARIABLE","$collectionName",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_STRING","false",564],")",["T_WHITESPACE","\n    ",564],"{",["T_WHITESPACE","\n        ",565],["T_IF","if",566],["T_WHITESPACE"," ",566],"(",["T_STRING","is_array",566],"(",["T_VARIABLE","$documentId",566],")",")",["T_WHITESPACE"," ",566],"{",["T_WHITESPACE","\n            ",566],["T_VARIABLE","$this",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","_validateCompositeKey",567],"(",["T_VARIABLE","$documentId",567],")",";",["T_WHITESPACE","\n            ",567],["T_RETURN","return",568],["T_WHITESPACE"," ",568],["T_VARIABLE","$documentId",568],";",["T_WHITESPACE","\n        ",568],"}",["T_WHITESPACE","\n        ",569],["T_IF","if",570],["T_WHITESPACE"," ",570],"(","!",["T_STRING","is_string",570],"(",["T_VARIABLE","$documentId",570],")",")",["T_WHITESPACE"," ",570],"{",["T_WHITESPACE","\n            ",570],["T_THROW","throw",571],["T_WHITESPACE"," ",571],["T_NEW","new",571],["T_WHITESPACE"," ",571],["T_STRING","Zend_Cloud_DocumentService_Exception",571],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid document identifier; must be a string or an array'",571],")",";",["T_WHITESPACE","\n        ",571],"}",["T_WHITESPACE","\n\n        ",572],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_validateKey",574],"(",["T_VARIABLE","$documentId",574],")",";",["T_WHITESPACE","\n\n        ",574],["T_IF","if",576],["T_WHITESPACE"," ",576],"(",["T_STRING","null",576],["T_WHITESPACE"," ",576],["T_IS_NOT_IDENTICAL","!==",576],["T_WHITESPACE"," ",576],"(",["T_VARIABLE","$partitionKey",576],["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","getDefaultPartitionKey",576],"(",")",")",")",["T_WHITESPACE"," ",576],"{",["T_WHITESPACE","\n            ",576],["T_RETURN","return",577],["T_WHITESPACE"," ",577],["T_ARRAY","array",577],"(",["T_VARIABLE","$partitionKey",577],",",["T_WHITESPACE"," ",577],["T_VARIABLE","$documentId",577],")",";",["T_WHITESPACE","\n        ",577],"}",["T_WHITESPACE","\n        ",578],["T_IF","if",579],["T_WHITESPACE"," ",579],"(",["T_STRING","null",579],["T_WHITESPACE"," ",579],["T_IS_NOT_IDENTICAL","!==",579],["T_WHITESPACE"," ",579],["T_VARIABLE","$collectionName",579],")",["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n            ",579],["T_RETURN","return",580],["T_WHITESPACE"," ",580],["T_ARRAY","array",580],"(",["T_VARIABLE","$collectionName",580],",",["T_WHITESPACE"," ",580],["T_VARIABLE","$documentId",580],")",";",["T_WHITESPACE","\n        ",580],"}",["T_WHITESPACE","\n        ",581],["T_THROW","throw",582],["T_WHITESPACE"," ",582],["T_NEW","new",582],["T_WHITESPACE"," ",582],["T_STRING","Zend_Cloud_DocumentService_Exception",582],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot determine partition name; invalid document identifier'",582],")",";",["T_WHITESPACE","\n    ",582],"}",["T_WHITESPACE","\n\n    ",583],["T_DOC_COMMENT","\/**\n     * Validate a document's fields for well-formedness\n     *\n     * Since Azure uses Atom, and fieldnames are included as part of XML\n     * element tag names, the field names must be valid XML names.\n     *\n     * @param  Zend_Cloud_DocumentService_Document|array $document\n     * @return void\n     * @throws Zend_Cloud_DocumentService_Exception\n     *\/",585],["T_WHITESPACE","\n    ",594],["T_PUBLIC","public",595],["T_WHITESPACE"," ",595],["T_FUNCTION","function",595],["T_WHITESPACE"," ",595],["T_STRING","_validateFields",595],"(",["T_VARIABLE","$document",595],")",["T_WHITESPACE","\n    ",595],"{",["T_WHITESPACE","\n        ",596],["T_IF","if",597],["T_WHITESPACE"," ",597],"(",["T_VARIABLE","$document",597],["T_WHITESPACE"," ",597],["T_INSTANCEOF","instanceof",597],["T_WHITESPACE"," ",597],["T_STRING","Zend_Cloud_DocumentService_Document",597],")",["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n            ",597],["T_VARIABLE","$document",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_VARIABLE","$document",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","getFields",598],"(",")",";",["T_WHITESPACE","\n        ",598],"}",["T_WHITESPACE"," ",599],["T_ELSEIF","elseif",599],["T_WHITESPACE"," ",599],"(","!",["T_STRING","is_array",599],"(",["T_VARIABLE","$document",599],")",")",["T_WHITESPACE"," ",599],"{",["T_WHITESPACE","\n            ",599],["T_THROW","throw",600],["T_WHITESPACE"," ",600],["T_NEW","new",600],["T_WHITESPACE"," ",600],["T_STRING","Zend_Cloud_DocumentService_Exception",600],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot inspect fields; invalid type provided'",600],")",";",["T_WHITESPACE","\n        ",600],"}",["T_WHITESPACE","\n\n        ",601],["T_FOREACH","foreach",603],["T_WHITESPACE"," ",603],"(",["T_STRING","array_keys",603],"(",["T_VARIABLE","$document",603],")",["T_WHITESPACE"," ",603],["T_AS","as",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$key",603],")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n            ",603],["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","_validateFieldKey",604],"(",["T_VARIABLE","$key",604],")",";",["T_WHITESPACE","\n        ",604],"}",["T_WHITESPACE","\n    ",605],"}",["T_WHITESPACE","\n\n    ",606],["T_DOC_COMMENT","\/**\n     * Validate an individual field name for well-formedness\n     *\n     * Since Azure uses Atom, and fieldnames are included as part of XML\n     * element tag names, the field names must be valid XML names.\n     *\n     * While we could potentially normalize names, this could also lead to\n     * conflict with other field names -- which we should avoid. As such,\n     * invalid field names will raise an exception.\n     *\n     * @param  string $key\n     * @return void\n     * @throws Zend_Cloud_DocumentService_Exception\n     *\/",608],["T_WHITESPACE","\n    ",621],["T_PUBLIC","public",622],["T_WHITESPACE"," ",622],["T_FUNCTION","function",622],["T_WHITESPACE"," ",622],["T_STRING","_validateFieldKey",622],"(",["T_VARIABLE","$key",622],")",["T_WHITESPACE","\n    ",622],"{",["T_WHITESPACE","\n        ",623],["T_IF","if",624],["T_WHITESPACE"," ",624],"(","!",["T_STRING","preg_match",624],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[_A-Za-z][-._A-Za-z0-9]*$\/'",624],",",["T_WHITESPACE"," ",624],["T_VARIABLE","$key",624],")",")",["T_WHITESPACE"," ",624],"{",["T_WHITESPACE","\n            ",624],["T_THROW","throw",625],["T_WHITESPACE"," ",625],["T_NEW","new",625],["T_WHITESPACE"," ",625],["T_STRING","Zend_Cloud_DocumentService_Exception",625],"(",["T_CONSTANT_ENCAPSED_STRING","'Field keys must conform to XML names (^[_A-Za-z][-._A-Za-z0-9]*$); key \"'",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE"," ",625],["T_VARIABLE","$key",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","'\" does not match'",625],")",";",["T_WHITESPACE","\n        ",625],"}",["T_WHITESPACE","\n    ",626],"}",["T_WHITESPACE","\n",627],"}",["T_WHITESPACE","\n",628]]