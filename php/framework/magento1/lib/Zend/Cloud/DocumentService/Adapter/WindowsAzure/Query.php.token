[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Cloud\n * @subpackage DocumentService\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",2],["T_WHITESPACE","\n\n",18],["T_COMMENT","\/*\n * @see Zend_Cloud_DocumentService_QueryAdapter\n *\/",20],["T_WHITESPACE","\n",22],["T_COMMENT","#require_once 'Zend\/Cloud\/DocumentService\/QueryAdapter.php';\n",23],["T_WHITESPACE","\n",24],["T_DOC_COMMENT","\/**\n * Class implementing Query adapter for working with Azure queries in a\n * structured way\n *\n * @todo       Look into preventing a query injection attack.\n * @category   Zend\n * @package    Zend_Cloud\n * @subpackage DocumentService\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",25],["T_WHITESPACE","\n",35],["T_CLASS","class",36],["T_WHITESPACE"," ",36],["T_STRING","Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query",36],["T_WHITESPACE","\n    ",36],["T_IMPLEMENTS","implements",37],["T_WHITESPACE"," ",37],["T_STRING","Zend_Cloud_DocumentService_QueryAdapter",37],["T_WHITESPACE","\n",37],"{",["T_WHITESPACE","\n    ",38],["T_DOC_COMMENT","\/**\n     * Azure concrete query\n     *\n     * @var Zend_Service_WindowsAzure_Storage_TableEntityQuery\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$_azureSelect",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param  null|Zend_Service_WindowsAzure_Storage_TableEntityQuery $select Table select object\n     * @return void\n     *\/",46],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","__construct",52],"(",["T_VARIABLE","$select",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","null",52],")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_IF","if",54],["T_WHITESPACE"," ",54],"(","!",["T_VARIABLE","$select",54],["T_WHITESPACE"," ",54],["T_INSTANCEOF","instanceof",54],["T_WHITESPACE"," ",54],["T_STRING","Zend_Service_WindowsAzure_Storage_TableEntityQuery",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_COMMENT","#require_once 'Zend\/Service\/WindowsAzure\/Storage\/TableEntityQuery.php';\n",55],["T_WHITESPACE","            ",56],["T_VARIABLE","$select",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_NEW","new",56],["T_WHITESPACE"," ",56],["T_STRING","Zend_Service_WindowsAzure_Storage_TableEntityQuery",56],"(",")",";",["T_WHITESPACE","\n        ",56],"}",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_azureSelect",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$select",58],";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * SELECT clause (fields to be selected)\n     *\n     * Does nothing for Azure.\n     *\n     * @param  string $select\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query\n     *\/",61],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","select",69],"(",["T_VARIABLE","$select",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * FROM clause (table name)\n     *\n     * @param string $from\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query\n     *\/",74],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","from",80],"(",["T_VARIABLE","$from",80],")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_azureSelect",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","from",82],"(",["T_VARIABLE","$from",82],")",";",["T_WHITESPACE","\n        ",82],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * WHERE clause (conditions to be used)\n     *\n     * @param string $where\n     * @param mixed $value Value or array of values to be inserted instead of ?\n     * @param string $op Operation to use to join where clauses (AND\/OR)\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query\n     *\/",86],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","where",94],"(",["T_VARIABLE","$where",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$value",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","null",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$op",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'and'",94],")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_EMPTY","empty",96],"(",["T_VARIABLE","$value",96],")",["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],"!",["T_STRING","is_array",96],"(",["T_VARIABLE","$value",96],")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_COMMENT","\/\/ fix buglet in Azure - numeric values are quoted unless passed as an array\n",97],["T_WHITESPACE","            ",98],["T_VARIABLE","$value",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_VARIABLE","$value",98],")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_azureSelect",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","where",100],"(",["T_VARIABLE","$where",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$value",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$op",100],")",";",["T_WHITESPACE","\n        ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * WHERE clause for item ID\n     *\n     * This one should be used when fetching specific rows since some adapters\n     * have special syntax for primary keys\n     *\n     * @param  array $value Row ID for the document (PartitionKey, RowKey)\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query\n     *\/",104],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","whereId",113],"(",["T_VARIABLE","$value",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(","!",["T_STRING","is_array",115],"(",["T_VARIABLE","$value",115],")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_COMMENT","#require_once 'Zend\/Cloud\/DocumentService\/Exception.php';\n",116],["T_WHITESPACE","            ",117],["T_THROW","throw",117],["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_STRING","Zend_Cloud_DocumentService_Exception",117],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid document key'",117],")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_azureSelect",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","wherePartitionKey",119],"(",["T_VARIABLE","$value",119],"[",["T_LNUMBER","0",119],"]",")",["T_OBJECT_OPERATOR","->",119],["T_STRING","whereRowKey",119],"(",["T_VARIABLE","$value",119],"[",["T_LNUMBER","1",119],"]",")",";",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * LIMIT clause (how many rows to return)\n     *\n     * @param  int $limit\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","limit",129],"(",["T_VARIABLE","$limit",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_azureSelect",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","top",131],"(",["T_VARIABLE","$limit",131],")",";",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * ORDER BY clause (sorting)\n     *\n     * @todo   Azure service doesn't seem to support this yet; emulate?\n     * @param  string $sort Column to sort by\n     * @param  string $direction Direction - asc\/desc\n     * @return Zend_Cloud_DocumentService_Adapter_WindowsAzure_Query\n     * @throws Zend_Cloud_OperationNotAvailableException\n     *\/",135],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","order",144],"(",["T_VARIABLE","$sort",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$direction",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'asc'",144],")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_COMMENT","#require_once 'Zend\/Cloud\/OperationNotAvailableException.php';\n",146],["T_WHITESPACE","        ",147],["T_THROW","throw",147],["T_WHITESPACE"," ",147],["T_NEW","new",147],["T_WHITESPACE"," ",147],["T_STRING","Zend_Cloud_OperationNotAvailableException",147],"(",["T_CONSTANT_ENCAPSED_STRING","'No support for sorting for Azure yet'",147],")",";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Get Azure select query\n     *\n     * @return Zend_Service_WindowsAzure_Storage_TableEntityQuery\n     *\/",150],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","getAzureSelect",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE","  ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_azureSelect",157],";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Assemble query\n     *\n     * Simply return the WindowsAzure table entity query object\n     *\n     * @return Zend_Service_WindowsAzure_Storage_TableEntityQuery\n     *\/",160],["T_WHITESPACE","\n    ",166],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","assemble",167],"(",")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getAzureSelect",169],"(",")",";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n",170],"}",["T_WHITESPACE","\n",171]]