[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Zend Framework\n *\n * LICENSE\n *\n * This source file is subject to the new BSD license that is bundled\n * with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/framework.zend.com\/license\/new-bsd\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@zend.com so we can send you a copy immediately.\n *\n * @category   Zend\n * @package    Zend_Crypt\n * @subpackage Hmac\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n * @version    $Id$\n *\/",2],["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/**\n * @see Zend_Crypt\n *\/",23],["T_WHITESPACE","\n",25],["T_COMMENT","#require_once 'Zend\/Crypt.php';\n",26],["T_WHITESPACE","\n",27],["T_DOC_COMMENT","\/**\n * PHP implementation of the RFC 2104 Hash based Message Authentication Code\n * algorithm.\n *\n * @todo  Patch for refactoring failed tests (key block sizes >80 using internal algo)\n * @todo       Check if mhash() is a required alternative (will be PECL-only soon)\n * @category   Zend\n * @package    Zend_Crypt\n * @copyright  Copyright (c) 2005-2015 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n *\/",28],["T_WHITESPACE","\n",38],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Crypt_Hmac",39],["T_WHITESPACE"," ",39],["T_EXTENDS","extends",39],["T_WHITESPACE"," ",39],["T_STRING","Zend_Crypt",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * The key to use for the hash\n     *\n     * @var string\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_STATIC","static",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_key",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * pack() format to be used for current hashing method\n     *\n     * @var string\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_STATIC","static",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_packFormat",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Hashing algorithm; can be the md5\/sha1 functions or any algorithm name\n     * listed in the output of PHP 5.1.2+ hash_algos().\n     *\n     * @var string\n     *\/",56],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_STATIC","static",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_hashAlgorithm",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'md5'",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * List of algorithms supported my mhash()\n     *\n     * @var array\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_STATIC","static",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_supportedMhashAlgorithms",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_CONSTANT_ENCAPSED_STRING","'adler32'",69],",",["T_CONSTANT_ENCAPSED_STRING","' crc32'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'crc32b'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'gost'",69],",",["T_WHITESPACE","\n            ",69],["T_CONSTANT_ENCAPSED_STRING","'haval128'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'haval160'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'haval192'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'haval256'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'md4'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'md5'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'ripemd160'",70],",",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'sha1'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'sha256'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'tiger'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'tiger128'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'tiger160'",71],")",";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Constants representing the output mode of the hash algorithm\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_CONST","const",76],["T_WHITESPACE"," ",76],["T_STRING","STRING",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'string'",76],";",["T_WHITESPACE","\n    ",76],["T_CONST","const",77],["T_WHITESPACE"," ",77],["T_STRING","BINARY",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'binary'",77],";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Performs a HMAC computation given relevant details such as Key, Hashing\n     * algorithm, the data to compute MAC of, and an output format of String,\n     * Binary notation or BTWOC.\n     *\n     * @param string $key\n     * @param string $hash\n     * @param string $data\n     * @param string $output\n     * @throws Zend_Crypt_Hmac_Exception\n     * @return string\n     *\/",79],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_STATIC","static",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","compute",91],"(",["T_VARIABLE","$key",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$hash",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$data",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$output",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_STRING","self",91],["T_DOUBLE_COLON","::",91],["T_STRING","STRING",91],")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_COMMENT","\/\/ set the key\n",93],["T_WHITESPACE","        ",94],["T_IF","if",94],["T_WHITESPACE"," ",94],"(","!",["T_ISSET","isset",94],"(",["T_VARIABLE","$key",94],")",["T_WHITESPACE"," ",94],["T_BOOLEAN_OR","||",94],["T_WHITESPACE"," ",94],["T_EMPTY","empty",94],"(",["T_VARIABLE","$key",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_COMMENT","#require_once 'Zend\/Crypt\/Hmac\/Exception.php';\n",95],["T_WHITESPACE","            ",96],["T_THROW","throw",96],["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_STRING","Zend_Crypt_Hmac_Exception",96],"(",["T_CONSTANT_ENCAPSED_STRING","'provided key is null or empty'",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_STRING","self",98],["T_DOUBLE_COLON","::",98],["T_VARIABLE","$_key",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$key",98],";",["T_WHITESPACE","\n\n        ",98],["T_COMMENT","\/\/ set the hash\n",100],["T_WHITESPACE","        ",101],["T_STRING","self",101],["T_DOUBLE_COLON","::",101],["T_STRING","_setHashAlgorithm",101],"(",["T_VARIABLE","$hash",101],")",";",["T_WHITESPACE","\n\n        ",101],["T_COMMENT","\/\/ perform hashing and return\n",103],["T_WHITESPACE","        ",104],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_STRING","self",104],["T_DOUBLE_COLON","::",104],["T_STRING","_hash",104],"(",["T_VARIABLE","$data",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$output",104],")",";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Setter for the hash method.\n     *\n     * @param string $hash\n     * @throws Zend_Crypt_Hmac_Exception\n     * @return Zend_Crypt_Hmac\n     *\/",107],["T_WHITESPACE","\n    ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_STATIC","static",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","_setHashAlgorithm",114],"(",["T_VARIABLE","$hash",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(","!",["T_ISSET","isset",116],"(",["T_VARIABLE","$hash",116],")",["T_WHITESPACE"," ",116],["T_BOOLEAN_OR","||",116],["T_WHITESPACE"," ",116],["T_EMPTY","empty",116],"(",["T_VARIABLE","$hash",116],")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_COMMENT","#require_once 'Zend\/Crypt\/Hmac\/Exception.php';\n",117],["T_WHITESPACE","            ",118],["T_THROW","throw",118],["T_WHITESPACE"," ",118],["T_NEW","new",118],["T_WHITESPACE"," ",118],["T_STRING","Zend_Crypt_Hmac_Exception",118],"(",["T_CONSTANT_ENCAPSED_STRING","'provided hash string is null or empty'",118],")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n\n        ",119],["T_VARIABLE","$hash",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","strtolower",121],"(",["T_VARIABLE","$hash",121],")",";",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$hashSupported",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_STRING","false",122],";",["T_WHITESPACE","\n\n        ",122],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_STRING","function_exists",124],"(",["T_CONSTANT_ENCAPSED_STRING","'hash_algos'",124],")",["T_WHITESPACE"," ",124],["T_BOOLEAN_AND","&&",124],["T_WHITESPACE"," ",124],["T_STRING","in_array",124],"(",["T_VARIABLE","$hash",124],",",["T_WHITESPACE"," ",124],["T_STRING","hash_algos",124],"(",")",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$hashSupported",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","true",125],";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n\n        ",126],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$hashSupported",128],["T_WHITESPACE"," ",128],["T_IS_IDENTICAL","===",128],["T_WHITESPACE"," ",128],["T_STRING","false",128],["T_WHITESPACE"," ",128],["T_BOOLEAN_AND","&&",128],["T_WHITESPACE"," ",128],["T_STRING","function_exists",128],"(",["T_CONSTANT_ENCAPSED_STRING","'mhash'",128],")",["T_WHITESPACE"," ",128],["T_BOOLEAN_AND","&&",128],["T_WHITESPACE"," ",128],["T_STRING","in_array",128],"(",["T_VARIABLE","$hash",128],",",["T_WHITESPACE"," ",128],["T_STRING","self",128],["T_DOUBLE_COLON","::",128],["T_VARIABLE","$_supportedAlgosMhash",128],")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$hashSupported",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","true",129],";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$hashSupported",132],["T_WHITESPACE"," ",132],["T_IS_IDENTICAL","===",132],["T_WHITESPACE"," ",132],["T_STRING","false",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_COMMENT","#require_once 'Zend\/Crypt\/Hmac\/Exception.php';\n",133],["T_WHITESPACE","            ",134],["T_THROW","throw",134],["T_WHITESPACE"," ",134],["T_NEW","new",134],["T_WHITESPACE"," ",134],["T_STRING","Zend_Crypt_Hmac_Exception",134],"(",["T_CONSTANT_ENCAPSED_STRING","'hash algorithm provided is not supported on this PHP installation; please enable the hash or mhash extensions'",134],")",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n        ",135],["T_STRING","self",136],["T_DOUBLE_COLON","::",136],["T_VARIABLE","$_hashAlgorithm",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$hash",136],";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Perform HMAC and return the keyed data\n     *\n     * @param string $data\n     * @param string $output\n     * @param bool $internal Option to not use hash() functions for testing\n     * @return string\n     *\/",139],["T_WHITESPACE","\n    ",146],["T_PROTECTED","protected",147],["T_WHITESPACE"," ",147],["T_STATIC","static",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","_hash",147],"(",["T_VARIABLE","$data",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$output",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","self",147],["T_DOUBLE_COLON","::",147],["T_STRING","STRING",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$internal",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","false",147],")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_STRING","function_exists",149],"(",["T_CONSTANT_ENCAPSED_STRING","'hash_hmac'",149],")",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$output",150],["T_WHITESPACE"," ",150],["T_IS_EQUAL","==",150],["T_WHITESPACE"," ",150],["T_STRING","self",150],["T_DOUBLE_COLON","::",150],["T_STRING","BINARY",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n                ",150],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_STRING","hash_hmac",151],"(",["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_VARIABLE","$_hashAlgorithm",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$data",151],",",["T_WHITESPACE"," ",151],["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_VARIABLE","$_key",151],",",["T_WHITESPACE"," ",151],["T_STRING","true",151],")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n            ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_STRING","hash_hmac",153],"(",["T_STRING","self",153],["T_DOUBLE_COLON","::",153],["T_VARIABLE","$_hashAlgorithm",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$data",153],",",["T_WHITESPACE"," ",153],["T_STRING","self",153],["T_DOUBLE_COLON","::",153],["T_VARIABLE","$_key",153],")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n        ",154],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_STRING","function_exists",156],"(",["T_CONSTANT_ENCAPSED_STRING","'mhash'",156],")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$output",157],["T_WHITESPACE"," ",157],["T_IS_EQUAL","==",157],["T_WHITESPACE"," ",157],["T_STRING","self",157],["T_DOUBLE_COLON","::",157],["T_STRING","BINARY",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_STRING","mhash",158],"(",["T_STRING","self",158],["T_DOUBLE_COLON","::",158],["T_STRING","_getMhashDefinition",158],"(",["T_STRING","self",158],["T_DOUBLE_COLON","::",158],["T_VARIABLE","$_hashAlgorithm",158],")",",",["T_WHITESPACE"," ",158],["T_VARIABLE","$data",158],",",["T_WHITESPACE"," ",158],["T_STRING","self",158],["T_DOUBLE_COLON","::",158],["T_VARIABLE","$_key",158],")",";",["T_WHITESPACE","\n            ",158],"}",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$bin",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","mhash",160],"(",["T_STRING","self",160],["T_DOUBLE_COLON","::",160],["T_STRING","_getMhashDefinition",160],"(",["T_STRING","self",160],["T_DOUBLE_COLON","::",160],["T_VARIABLE","$_hashAlgorithm",160],")",",",["T_WHITESPACE"," ",160],["T_VARIABLE","$data",160],",",["T_WHITESPACE"," ",160],["T_STRING","self",160],["T_DOUBLE_COLON","::",160],["T_VARIABLE","$_key",160],")",";",["T_WHITESPACE","\n            ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","bin2hex",161],"(",["T_VARIABLE","$bin",161],")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Since MHASH accepts an integer constant representing the hash algorithm\n     * we need to make a small detour to get the correct integer matching our\n     * algorithm's name.\n     *\n     * @param string $hashAlgorithm\n     * @return integer\n     *\/",165],["T_WHITESPACE","\n    ",172],["T_PROTECTED","protected",173],["T_WHITESPACE"," ",173],["T_STATIC","static",173],["T_WHITESPACE"," ",173],["T_FUNCTION","function",173],["T_WHITESPACE"," ",173],["T_STRING","_getMhashDefinition",173],"(",["T_VARIABLE","$hashAlgorithm",173],")",["T_WHITESPACE","\n    ",173],"{",["T_WHITESPACE","\n        ",174],["T_FOR","for",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$i",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_LNUMBER","0",175],";",["T_WHITESPACE"," ",175],["T_VARIABLE","$i",175],["T_WHITESPACE"," ",175],["T_IS_SMALLER_OR_EQUAL","<=",175],["T_WHITESPACE"," ",175],["T_STRING","mhash_count",175],"(",")",";",["T_WHITESPACE"," ",175],["T_VARIABLE","$i",175],["T_INC","++",175],")",["T_WHITESPACE","\n        ",175],"{",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$types",177],"[",["T_STRING","mhash_get_hash_name",177],"(",["T_VARIABLE","$i",177],")","]",["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$i",177],";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$types",179],"[",["T_STRING","strtoupper",179],"(",["T_VARIABLE","$hashAlgorithm",179],")","]",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n",180],"}",["T_WHITESPACE","\n",182]]