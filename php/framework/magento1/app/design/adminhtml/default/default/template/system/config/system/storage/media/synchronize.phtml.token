[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Academic Free License (AFL 3.0)\n * that is bundled with this package in the file LICENSE_AFL.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/afl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    design\n * @package     default_default\n * @copyright   Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license     http:\/\/opensource.org\/licenses\/afl-3.0.php  Academic Free License (AFL 3.0)\n *\/",2],["T_WHITESPACE","\n",25],["T_CLOSE_TAG","?>\n",26],["T_INLINE_HTML","\n",27],["T_OPEN_TAG","<?php ",28],["T_COMMENT","\/* var $this Mage_Adminhtml_Block_System_Config_System_Storage_Media_Synchronize *\/",28],["T_WHITESPACE"," ",28],["T_CLOSE_TAG","?>\n",28],["T_INLINE_HTML","\n<script type=\"text\/javascript\">\n\/\/<![CDATA[\n    Validation.add('required-synchronize', '",29],["T_OPEN_TAG","<?php ",32],["T_ECHO","echo",32],["T_WHITESPACE"," ",32],["T_STRING","Mage",32],["T_DOUBLE_COLON","::",32],["T_STRING","helper",32],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",32],")",["T_OBJECT_OPERATOR","->",32],["T_STRING","jsQuoteEscape",32],"(",["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","__",32],"(",["T_CONSTANT_ENCAPSED_STRING","'Synchronization is required.'",32],")",")",["T_WHITESPACE"," ",32],["T_CLOSE_TAG","?>",32],["T_INLINE_HTML","', function(){\n        storage = getConnectionName(\n            $('system_media_storage_configuration_media_storage').value,\n            $('system_media_storage_configuration_media_database').value\n        );\n\n        return allowedStorages.include(storage);\n    });\n\n    defaultValues   = [];\n    defaultValues['system_media_storage_configuration_media_storage']   = $('system_media_storage_configuration_media_storage').value;\n    defaultValues['system_media_storage_configuration_media_database']  = $('system_media_storage_configuration_media_database').value;\n\n    allowedStorages = [];\n    addAllowedStorage(\n        $('system_media_storage_configuration_media_storage').value,\n        $('system_media_storage_configuration_media_database').value\n    );\n\n    ",32],["T_OPEN_TAG","<?php ",51],["T_VARIABLE","$syncStorageParams",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getSyncStorageParams",51],"(",")",["T_WHITESPACE"," ",51],["T_CLOSE_TAG","?>\n",51],["T_INLINE_HTML","    addAllowedStorage(",52],["T_OPEN_TAG","<?php ",52],["T_ECHO","echo",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$syncStorageParams",52],"[",["T_CONSTANT_ENCAPSED_STRING","'storage_type'",52],"]",["T_WHITESPACE"," ",52],["T_CLOSE_TAG","?>",52],["T_INLINE_HTML",", '",52],["T_OPEN_TAG","<?php ",52],["T_ECHO","echo",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$syncStorageParams",52],"[",["T_CONSTANT_ENCAPSED_STRING","'connection_name'",52],"]",["T_WHITESPACE"," ",52],["T_CLOSE_TAG","?>",52],["T_INLINE_HTML","');\n\n    function getConnectionName(storageType, connection)\n    {\n        if (storageType == 0) {\n            return storageType;\n        } else if (connection != '') {\n            return storageType + '_' + connection;\n        }\n\n        return '';\n    }\n\n    function addAllowedStorage(storageType, connection)\n    {\n        storage = getConnectionName(storageType, connection);\n\n        if (storage != '' && !allowedStorages.include(storage)) {\n            allowedStorages.push(storage);\n        }\n    }\n\n    function checkButtonState(event) {\n        var element = Event.element(event);\n\n        defaultStorage = getConnectionName(\n            defaultValues['system_media_storage_configuration_media_storage'],\n            defaultValues['system_media_storage_configuration_media_database']\n        );\n\n        storage = getConnectionName(\n            $('system_media_storage_configuration_media_storage').value,\n            $('system_media_storage_configuration_media_database').value\n        );\n\n        if (defaultStorage != storage) {\n            enableSyncButton();\n        } else {\n            disableSyncButton();\n        }\n    }\n\n    function enableStorageSelection() {\n        $('system_media_storage_configuration_media_storage').enable('enabled');\n        $('system_media_storage_configuration_media_database').enable('enabled');\n    }\n\n    function disableStorageSelection() {\n        $('system_media_storage_configuration_media_storage').disable('disabled');\n        $('system_media_storage_configuration_media_database').disable('disabled');\n    }\n\n    function enableSyncButton() {\n        Form.Element.enable('synchronize_button');\n        $('synchronize_button').removeClassName('disabled');\n    }\n\n    function disableSyncButton() {\n        Form.Element.disable('synchronize_button');\n        $('synchronize_button').addClassName('disabled');\n    }\n\n    Event.observe(window, 'load', function(){\n        disableStorageSelection();\n        disableSyncButton();\n        checkStatus();\n    });\n    $('system_media_storage_configuration_media_storage').observe('change', checkButtonState);\n    $('system_media_storage_configuration_media_database').observe('change', checkButtonState);\n\n    function checkStatus() {\n        var u = new Ajax.PeriodicalUpdater('', '",52],["T_OPEN_TAG","<?php ",123],["T_ECHO","echo",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getAjaxStatusUpdateUrl",123],"(",")",["T_WHITESPACE"," ",123],["T_CLOSE_TAG","?>",123],["T_INLINE_HTML","', {\n            method:     'get',\n            frequency:  5,\n            loaderArea: false,\n\n            onSuccess: function(transport) {\n                var response;\n\n                try {\n                    response = transport.responseJSON || transport.responseText.evalJSON(true) || {};\n                    if (response.state == '",123],["T_OPEN_TAG","<?php ",133],["T_ECHO","echo",133],["T_WHITESPACE"," ",133],["T_STRING","Mage_Core_Model_File_Storage_Flag",133],["T_DOUBLE_COLON","::",133],["T_STRING","STATE_RUNNING",133],["T_WHITESPACE"," ",133],["T_CLOSE_TAG","?>",133],["T_INLINE_HTML","'\n                        && response.message\n                    ) {\n                        if ($('sync_span').hasClassName('no-display')) {\n                            $('sync_span').removeClassName('no-display');\n                            $('sync_message_span').update(response.message);\n                        }\n                    } else {\n                        u.stop();\n                        enableStorageSelection();\n                        $('sync_span').addClassName('no-display');\n\n                        if (response.state == '",133],["T_OPEN_TAG","<?php ",145],["T_ECHO","echo",145],["T_WHITESPACE"," ",145],["T_STRING","Mage_Core_Model_File_Storage_Flag",145],["T_DOUBLE_COLON","::",145],["T_STRING","STATE_NOTIFIED",145],["T_WHITESPACE"," ",145],["T_CLOSE_TAG","?>",145],["T_INLINE_HTML","') {\n                            if (response.html && response.html != '') {\n                                $$('div.notification-global').each(function(e) {\n                                    if (!e.hasClassName('notification-global-notice')) {\n                                        e.hide();\n                                    }\n                                });\n\n                                Element.insert($('anchor-content'), {'before': response.html});\n                            }\n\n                            if (response.has_errors) {\n                                enableSyncButton();\n                            } else {\n                                addAllowedStorage(\n                                    $('system_media_storage_configuration_media_storage').value,\n                                    $('system_media_storage_configuration_media_database').value\n                                );\n                            }\n                        }\n                    }\n                } catch (e) {\n                    response = {};\n                }\n            }\n        });\n    }\n\n    function synchronize() {\n        var advice = Validation.getAdvice('required-synchronize', $('synchronize-validation-input'));\n        if (advice) {\n            advice.hide();\n        }\n        params = {\n            storage:    $('system_media_storage_configuration_media_storage').value,\n            connection: $('system_media_storage_configuration_media_database').value\n        }\n\n        new Ajax.Request('",145],["T_OPEN_TAG","<?php ",183],["T_ECHO","echo",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getAjaxSyncUrl",183],"(",")",["T_WHITESPACE"," ",183],["T_CLOSE_TAG","?>",183],["T_INLINE_HTML","', {\n            parameters:     params,\n            loaderArea:     false,\n            asynchronous:   true\n        });\n\n        window.setTimeout('checkStatus()', 2011);\n\n        disableStorageSelection();\n        disableSyncButton();\n    }\n\/\/]]>\n<\/script>\n\n",183],["T_OPEN_TAG","<?php ",197],["T_ECHO","echo",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getButtonHtml",197],"(",")",["T_WHITESPACE"," ",197],["T_CLOSE_TAG","?>",197],["T_INLINE_HTML","<span class=\"sync-indicator no-display\" id=\"sync_span\"><img alt=\"Synchronize\" style=\"margin:0 5px\" src=\"",197],["T_OPEN_TAG","<?php ",197],["T_ECHO","echo",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getSkinUrl",197],"(",["T_CONSTANT_ENCAPSED_STRING","'images\/process_spinner.gif'",197],")",["T_WHITESPACE"," ",197],["T_CLOSE_TAG","?>",197],["T_INLINE_HTML","\"\/><span id=\"sync_message_span\"><\/span><\/span>\n<input type=\"hidden\" id=\"synchronize-validation-input\" class=\"required-synchronize no-display\"\/>\n",197]]