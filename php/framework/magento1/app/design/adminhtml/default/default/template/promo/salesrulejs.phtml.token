[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Academic Free License (AFL 3.0)\n * that is bundled with this package in the file LICENSE_AFL.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/afl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    design\n * @package     default_default\n * @copyright   Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license     http:\/\/opensource.org\/licenses\/afl-3.0.php  Academic Free License (AFL 3.0)\n *\/",2],["T_WHITESPACE","\n",25],["T_CLOSE_TAG","?>\n",26],["T_INLINE_HTML","<script type=\"text\/javascript\">\n\/\/<![CDATA[\nvar couponTypeSpecific = '",27],["T_OPEN_TAG","<?php ",29],["T_ECHO","echo",29],["T_WHITESPACE"," ",29],["T_STRING","Mage_SalesRule_Model_Rule",29],["T_DOUBLE_COLON","::",29],["T_STRING","COUPON_TYPE_SPECIFIC",29],["T_WHITESPACE"," ",29],["T_CLOSE_TAG","?>",29],["T_INLINE_HTML","';\nvar tmpButtonsActionsStorage = [];\n\nfunction disableEnableCouponsTabContent(disable) {\n    var containerId = 'promo_catalog_edit_tabs_coupons_section_content';\n    if($(containerId)){\n        var dataFields = $(containerId).select('input', 'select', 'textarea', 'button');\n        for(var i = 0; i < dataFields.length; i++) {\n            disable ? dataFields[i].disable().addClassName('disabled')\n                : dataFields[i].enable().removeClassName('disabled');\n        }\n    }\n    disable ? $('rule_coupon_code').enable() : $('rule_coupon_code').disable();\n}\n\nfunction handleCouponsTabContentActivity() {\n    disableEnableCouponsTabContent(!$('rule_use_auto_generation').checked);\n}\n\nfunction handleCouponTypeChange() {\n    $('rule_coupon_type').observe('change', function() {\n        var disable = $('rule_coupon_type').value != couponTypeSpecific;\n        if (!disable) {\n            disable = !$('rule_use_auto_generation').checked;\n        }\n        disableEnableCouponsTabContent(disable);\n    });\n}\n\nfunction refreshCouponCodesGrid(grid, gridMassAction, transport) {\n    grid.reload();\n    gridMassAction.unselectAll();\n}\n\nfunction generateCouponCodes(idPrefix, generateUrl, grid) {\n    $(idPrefix + 'information_fieldset').removeClassName('ignore-validate');\n    var validationResult = $(idPrefix + 'information_fieldset').select('input',\n            'select', 'textarea').collect( function(elm) {\n        return Validation.validate(elm, {\n            useTitle :false,\n            onElementValidate : function() {\n            }\n        });\n    }).all();\n    $(idPrefix + 'information_fieldset').addClassName('ignore-validate');\n\n    if (!validationResult) {\n        return;\n    }\n    var elements = $(idPrefix + 'information_fieldset').select('input', 'select', 'textarea');\n\n    elements = elements.concat(\n        $$('#rule_uses_per_coupon'),\n        $$('#rule_uses_per_customer'),\n        $$('#rule_to_date')\n    );\n\n    var params = Form.serializeElements(elements, true);\n    params.form_key = FORM_KEY;\n    $('messages').update();\n    var couponCodesGrid = eval(grid);\n    new Ajax.Request(generateUrl, {\n        parameters :params,\n        method :'post',\n        onComplete : function (transport, param){\n            var response = transport.responseJSON || transport.responseText.evalJSON(true) || {};\n\n            if (couponCodesGrid) {\n                couponCodesGrid.reload();\n            }\n            if (response && response.messages) {\n                $('messages').update(response.messages);\n            }\n            if (response && response.error) {\n                alert(response.error.stripTags().toString());\n            }\n        }\n    });\n}\n\nAjax.Responders.register({\n    onComplete: function() {\n        if ($('promo_catalog_edit_tabs_coupons_section_content')\n            && $('promo_catalog_edit_tabs_coupons_section_content').visible()\n            && Ajax.activeRequestCount == 0\n        ) {\n            handleCouponsTabContentActivity();\n        }\n    }\n});\n\ndocument.observe(\"dom:loaded\", handleCouponsTabContentActivity);\ndocument.observe(\"dom:loaded\", handleCouponTypeChange);\n\/\/]]>\n<\/script>\n",29]]