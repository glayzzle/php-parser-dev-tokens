[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Review\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Review Product Collection\n *\n * @category    Mage\n * @package     Mage_Review\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Review_Model_Resource_Review_Product_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Entities alias\n     *\n     * @var array\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_entitiesAlias",42],["T_WHITESPACE","        ",42],"=",["T_WHITESPACE"," ",42],["T_ARRAY","array",42],"(",")",";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Review store table\n     *\n     * @var string\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_reviewStoreTable",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Add store data flag\n     *\n     * @var boolean\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_addStoreDataFlag",56],["T_WHITESPACE","     ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","false",56],";",["T_WHITESPACE","\n\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Filter by stores for the collection\n     *\n     * @var array\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_storesIds",64],["T_WHITESPACE","           ",64],"=",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Define module\n     *\n     *\/",66],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","_construct",70],"(",")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_init",72],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","setRowIdFieldName",73],"(",["T_CONSTANT_ENCAPSED_STRING","'review_id'",73],")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_reviewStoreTable",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","Mage",74],["T_DOUBLE_COLON","::",74],["T_STRING","getSingleton",74],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",74],")",["T_OBJECT_OPERATOR","->",74],["T_STRING","getTableName",74],"(",["T_CONSTANT_ENCAPSED_STRING","'review\/review_store'",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_initTables",75],"(",")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * init select\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","_initSelect",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_STRING","parent",85],["T_DOUBLE_COLON","::",85],["T_STRING","_initSelect",85],"(",")",";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_joinFields",86],"(",")",";",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Adds store filter into array\n     *\n     * @param mixed $storeId\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","addStoreFilter",96],"(",["T_VARIABLE","$storeId",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","null",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(",["T_STRING","is_null",98],"(",["T_VARIABLE","$storeId",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$storeId",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getStoreId",99],"(",")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_STRING","parent",102],["T_DOUBLE_COLON","::",102],["T_STRING","addStoreFilter",102],"(",["T_VARIABLE","$storeId",102],")",";",["T_WHITESPACE","\n\n        ",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(","!",["T_STRING","is_array",104],"(",["T_VARIABLE","$storeId",104],")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$storeId",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_VARIABLE","$storeId",105],")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n\n        ",106],["T_IF","if",108],["T_WHITESPACE"," ",108],"(","!",["T_EMPTY","empty",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_storesIds",108],")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_storesIds",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","array_intersect",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_storesIds",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$storeId",109],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE"," ",110],["T_ELSE","else",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_storesIds",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$storeId",111],";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Adds specific store id into array\n     *\n     * @param array $storeId\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",117],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","setStoreFilter",123],"(",["T_VARIABLE","$storeId",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_STRING","is_array",125],"(",["T_VARIABLE","$storeId",125],")",["T_WHITESPACE"," ",125],["T_BOOLEAN_AND","&&",125],["T_WHITESPACE"," ",125],["T_ISSET","isset",125],"(",["T_VARIABLE","$storeId",125],"[",["T_CONSTANT_ENCAPSED_STRING","'eq'",125],"]",")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$storeId",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","array_shift",126],"(",["T_VARIABLE","$storeId",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_IF","if",129],["T_WHITESPACE"," ",129],"(","!",["T_STRING","is_array",129],"(",["T_VARIABLE","$storeId",129],")",")","{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$storeId",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",["T_VARIABLE","$storeId",130],")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n\n        ",131],["T_IF","if",133],["T_WHITESPACE"," ",133],"(","!",["T_EMPTY","empty",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_storesIds",133],")",")","{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_storesIds",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","array_intersect",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_storesIds",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$storeId",134],")",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE"," ",135],["T_ELSE","else",135],["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_storesIds",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$storeId",136],";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n\n        ",137],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Applies all store filters in one place to prevent multiple joins in select\n     *\n     * @param null|Zend_Db_Select $select\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",142],["T_WHITESPACE","\n    ",147],["T_PROTECTED","protected",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","_applyStoresFilterToSelect",148],"(",["T_STRING","Zend_Db_Select",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$select",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","null",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$adapter",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getConnection",150],"(",")",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$storesIds",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_storesIds",151],";",["T_WHITESPACE","\n        ",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_STRING","is_null",152],"(",["T_VARIABLE","$select",152],")",")","{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$select",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getSelect",153],"(",")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n        ",154],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_STRING","is_array",156],"(",["T_VARIABLE","$storesIds",156],")",["T_WHITESPACE"," ",156],["T_BOOLEAN_AND","&&",156],["T_WHITESPACE"," ",156],"(",["T_STRING","count",156],"(",["T_VARIABLE","$storesIds",156],")",["T_WHITESPACE"," ",156],["T_IS_EQUAL","==",156],["T_WHITESPACE"," ",156],["T_LNUMBER","1",156],")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$storesIds",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","array_shift",157],"(",["T_VARIABLE","$storesIds",157],")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n\n        ",158],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_STRING","is_array",160],"(",["T_VARIABLE","$storesIds",160],")",["T_WHITESPACE"," ",160],["T_BOOLEAN_AND","&&",160],["T_WHITESPACE"," ",160],"!",["T_EMPTY","empty",160],"(",["T_VARIABLE","$storesIds",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$inCond",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$adapter",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","prepareSqlCondition",161],"(",["T_CONSTANT_ENCAPSED_STRING","'store.store_id'",161],",",["T_WHITESPACE"," ",161],["T_ARRAY","array",161],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$storesIds",161],")",")",";",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$select",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","join",162],"(",["T_ARRAY","array",162],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_reviewStoreTable",162],")",",",["T_WHITESPACE","\n                ",162],["T_CONSTANT_ENCAPSED_STRING","'rt.review_id=store.review_id AND '",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$inCond",163],",",["T_WHITESPACE","\n                ",163],["T_ARRAY","array",164],"(",")",")",["T_WHITESPACE","\n            ",164],["T_OBJECT_OPERATOR","->",165],["T_STRING","group",165],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.review_id'",165],")",";",["T_WHITESPACE","\n\n            ",165],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_useAnalyticFunction",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","true",167],";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE"," ",168],["T_ELSE","else",168],["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$select",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","join",169],"(",["T_ARRAY","array",169],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_reviewStoreTable",169],")",",",["T_WHITESPACE","\n                ",169],["T_VARIABLE","$adapter",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","quoteInto",170],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.review_id=store.review_id AND store.store_id = ?'",170],",",["T_WHITESPACE"," ",170],["T_INT_CAST","(int)",170],["T_VARIABLE","$storesIds",170],")",",",["T_WHITESPACE","\n                ",170],["T_ARRAY","array",171],"(",")",")",";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n\n        ",172],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Add stores data\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",177],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","addStoreData",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_addStoreDataFlag",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_STRING","true",184],";",["T_WHITESPACE","\n        ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Add customer filter\n     *\n     * @param int $customerId\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",188],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","addCustomerFilter",194],"(",["T_VARIABLE","$customerId",194],")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getSelect",196],"(",")",["T_WHITESPACE","\n            ",196],["T_OBJECT_OPERATOR","->",197],["T_STRING","where",197],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.customer_id = ?'",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$customerId",197],")",";",["T_WHITESPACE","\n        ",197],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Add entity filter\n     *\n     * @param int $entityId\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",201],["T_WHITESPACE","\n    ",206],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","addEntityFilter",207],"(",["T_VARIABLE","$entityId",207],")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getSelect",209],"(",")",["T_WHITESPACE","\n            ",209],["T_OBJECT_OPERATOR","->",210],["T_STRING","where",210],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.entity_pk_value = ?'",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$entityId",210],")",";",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Add status filter\n     *\n     * @param mixed $status\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",214],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","addStatusFilter",220],"(",["T_VARIABLE","$status",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getSelect",222],"(",")",["T_WHITESPACE","\n            ",222],["T_OBJECT_OPERATOR","->",223],["T_STRING","where",223],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.status_id = ?'",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$status",223],")",";",["T_WHITESPACE","\n        ",223],["T_RETURN","return",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_DOC_COMMENT","\/**\n     * Set date order\n     *\n     * @param string $dir\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",227],["T_WHITESPACE","\n    ",232],["T_PUBLIC","public",233],["T_WHITESPACE"," ",233],["T_FUNCTION","function",233],["T_WHITESPACE"," ",233],["T_STRING","setDateOrder",233],"(",["T_VARIABLE","$dir",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'DESC'",233],")",["T_WHITESPACE","\n    ",233],"{",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","setOrder",235],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.created_at'",235],",",["T_WHITESPACE"," ",235],["T_VARIABLE","$dir",235],")",";",["T_WHITESPACE","\n        ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Add review summary\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",239],["T_WHITESPACE","\n    ",243],["T_PUBLIC","public",244],["T_WHITESPACE"," ",244],["T_FUNCTION","function",244],["T_WHITESPACE"," ",244],["T_STRING","addReviewSummary",244],"(",")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_FOREACH","foreach",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getItems",246],"(",")",["T_WHITESPACE"," ",246],["T_AS","as",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$item",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$model",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","Mage",247],["T_DOUBLE_COLON","::",247],["T_STRING","getModel",247],"(",["T_CONSTANT_ENCAPSED_STRING","'rating\/rating'",247],")",";",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$model",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getReviewSummary",248],"(",["T_VARIABLE","$item",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getReviewId",248],"(",")",")",";",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$item",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","addData",249],"(",["T_VARIABLE","$model",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getData",249],"(",")",")",";",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Add rote votes\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",254],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","addRateVotes",259],"(",")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_FOREACH","foreach",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getItems",261],"(",")",["T_WHITESPACE"," ",261],["T_AS","as",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$item",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$votesCollection",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_STRING","Mage",262],["T_DOUBLE_COLON","::",262],["T_STRING","getModel",262],"(",["T_CONSTANT_ENCAPSED_STRING","'rating\/rating_option_vote'",262],")",["T_WHITESPACE","\n                ",262],["T_OBJECT_OPERATOR","->",263],["T_STRING","getResourceCollection",263],"(",")",["T_WHITESPACE","\n                ",263],["T_OBJECT_OPERATOR","->",264],["T_STRING","setEntityPkFilter",264],"(",["T_VARIABLE","$item",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getEntityId",264],"(",")",")",["T_WHITESPACE","\n                ",264],["T_OBJECT_OPERATOR","->",265],["T_STRING","setStoreFilter",265],"(",["T_STRING","Mage",265],["T_DOUBLE_COLON","::",265],["T_STRING","app",265],"(",")",["T_OBJECT_OPERATOR","->",265],["T_STRING","getStore",265],"(",")",["T_OBJECT_OPERATOR","->",265],["T_STRING","getId",265],"(",")",")",["T_WHITESPACE","\n                ",265],["T_OBJECT_OPERATOR","->",266],["T_STRING","load",266],"(",")",";",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$item",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","setRatingVotes",267],"(",["T_VARIABLE","$votesCollection",267],")",";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n        ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * join fields to entity\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",272],["T_WHITESPACE","\n    ",276],["T_PROTECTED","protected",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","_joinFields",277],"(",")",["T_WHITESPACE","\n    ",277],"{",["T_WHITESPACE","\n        ",278],["T_VARIABLE","$reviewTable",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_STRING","Mage",279],["T_DOUBLE_COLON","::",279],["T_STRING","getSingleton",279],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",279],")",["T_OBJECT_OPERATOR","->",279],["T_STRING","getTableName",279],"(",["T_CONSTANT_ENCAPSED_STRING","'review\/review'",279],")",";",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$reviewDetailTable",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_STRING","Mage",280],["T_DOUBLE_COLON","::",280],["T_STRING","getSingleton",280],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",280],")",["T_OBJECT_OPERATOR","->",280],["T_STRING","getTableName",280],"(",["T_CONSTANT_ENCAPSED_STRING","'review\/review_detail'",280],")",";",["T_WHITESPACE","\n\n        ",280],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","addAttributeToSelect",282],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",282],")",["T_WHITESPACE","\n            ",282],["T_OBJECT_OPERATOR","->",283],["T_STRING","addAttributeToSelect",283],"(",["T_CONSTANT_ENCAPSED_STRING","'sku'",283],")",";",["T_WHITESPACE","\n\n        ",283],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getSelect",285],"(",")",["T_WHITESPACE","\n            ",285],["T_OBJECT_OPERATOR","->",286],["T_STRING","join",286],"(",["T_ARRAY","array",286],"(",["T_CONSTANT_ENCAPSED_STRING","'rt'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$reviewTable",286],")",",",["T_WHITESPACE","\n                ",286],["T_CONSTANT_ENCAPSED_STRING","'rt.entity_pk_value = e.entity_id'",287],",",["T_WHITESPACE","\n                ",287],["T_ARRAY","array",288],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.review_id'",288],",",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'review_created_at'",288],["T_DOUBLE_ARROW","=>",288],["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'rt.created_at'",288],",",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'rt.entity_pk_value'",288],",",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'rt.status_id'",288],")",")",["T_WHITESPACE","\n            ",288],["T_OBJECT_OPERATOR","->",289],["T_STRING","join",289],"(",["T_ARRAY","array",289],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt'",289],["T_WHITESPACE"," ",289],["T_DOUBLE_ARROW","=>",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$reviewDetailTable",289],")",",",["T_WHITESPACE","\n                ",289],["T_CONSTANT_ENCAPSED_STRING","'rdt.review_id = rt.review_id'",290],",",["T_WHITESPACE","\n                ",290],["T_ARRAY","array",291],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.title'",291],",",["T_CONSTANT_ENCAPSED_STRING","'rdt.nickname'",291],",",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'rdt.detail'",291],",",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'rdt.customer_id'",291],",",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'rdt.store_id'",291],")",")",";",["T_WHITESPACE","\n        ",291],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n\n    ",293],["T_DOC_COMMENT","\/**\n     * Retrive all ids for collection\n     *\n     * @param unknown_type $limit\n     * @param unknown_type $offset\n     * @return array\n     *\/",295],["T_WHITESPACE","\n    ",301],["T_PUBLIC","public",302],["T_WHITESPACE"," ",302],["T_FUNCTION","function",302],["T_WHITESPACE"," ",302],["T_STRING","getAllIds",302],"(",["T_VARIABLE","$limit",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","null",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$offset",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","null",302],")",["T_WHITESPACE","\n    ",302],"{",["T_WHITESPACE","\n        ",303],["T_VARIABLE","$idsSelect",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_CLONE","clone",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","getSelect",304],"(",")",";",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$idsSelect",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","reset",305],"(",["T_STRING","Zend_Db_Select",305],["T_DOUBLE_COLON","::",305],["T_STRING","ORDER",305],")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$idsSelect",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","reset",306],"(",["T_STRING","Zend_Db_Select",306],["T_DOUBLE_COLON","::",306],["T_STRING","LIMIT_COUNT",306],")",";",["T_WHITESPACE","\n        ",306],["T_VARIABLE","$idsSelect",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","reset",307],"(",["T_STRING","Zend_Db_Select",307],["T_DOUBLE_COLON","::",307],["T_STRING","LIMIT_OFFSET",307],")",";",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$idsSelect",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","reset",308],"(",["T_STRING","Zend_Db_Select",308],["T_DOUBLE_COLON","::",308],["T_STRING","COLUMNS",308],")",";",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$idsSelect",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","columns",309],"(",["T_CONSTANT_ENCAPSED_STRING","'rt.review_id'",309],")",";",["T_WHITESPACE","\n        ",309],["T_RETURN","return",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getConnection",310],"(",")",["T_OBJECT_OPERATOR","->",310],["T_STRING","fetchCol",310],"(",["T_VARIABLE","$idsSelect",310],")",";",["T_WHITESPACE","\n    ",310],"}",["T_WHITESPACE","\n\n    ",311],["T_DOC_COMMENT","\/**\n     * Render SQL for retrieve product count\n     *\n     * @return string\n     *\/",313],["T_WHITESPACE","\n    ",317],["T_PUBLIC","public",318],["T_WHITESPACE"," ",318],["T_FUNCTION","function",318],["T_WHITESPACE"," ",318],["T_STRING","getSelectCountSql",318],"(",")",["T_WHITESPACE","\n    ",318],"{",["T_WHITESPACE","\n        ",319],["T_VARIABLE","$select",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","parent",320],["T_DOUBLE_COLON","::",320],["T_STRING","getSelectCountSql",320],"(",")",";",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$select",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","reset",321],"(",["T_STRING","Zend_Db_Select",321],["T_DOUBLE_COLON","::",321],["T_STRING","COLUMNS",321],")",["T_WHITESPACE","\n            ",321],["T_OBJECT_OPERATOR","->",322],["T_STRING","columns",322],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(e.entity_id)'",322],")",["T_WHITESPACE","\n            ",322],["T_OBJECT_OPERATOR","->",323],["T_STRING","reset",323],"(",["T_STRING","Zend_Db_Select",323],["T_DOUBLE_COLON","::",323],["T_STRING","HAVING",323],")",";",["T_WHITESPACE","\n\n        ",323],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$select",325],";",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Set order to attribute\n     *\n     * @param string $attribute\n     * @param string $dir\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",328],["T_WHITESPACE","\n    ",334],["T_PUBLIC","public",335],["T_WHITESPACE"," ",335],["T_FUNCTION","function",335],["T_WHITESPACE"," ",335],["T_STRING","setOrder",335],"(",["T_VARIABLE","$attribute",335],",",["T_WHITESPACE"," ",335],["T_VARIABLE","$dir",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'DESC'",335],")",["T_WHITESPACE","\n    ",335],"{",["T_WHITESPACE","\n        ",336],["T_SWITCH","switch",337],"(",["T_VARIABLE","$attribute",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_CASE","case",338],["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","'rt.review_id'",338],":",["T_WHITESPACE","\n            ",338],["T_CASE","case",339],["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'rt.created_at'",339],":",["T_WHITESPACE","\n            ",339],["T_CASE","case",340],["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'rt.status_id'",340],":",["T_WHITESPACE","\n            ",340],["T_CASE","case",341],["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'rdt.title'",341],":",["T_WHITESPACE","\n            ",341],["T_CASE","case",342],["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","'rdt.nickname'",342],":",["T_WHITESPACE","\n            ",342],["T_CASE","case",343],["T_WHITESPACE"," ",343],["T_CONSTANT_ENCAPSED_STRING","'rdt.detail'",343],":",["T_WHITESPACE","\n                ",343],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","getSelect",344],"(",")",["T_OBJECT_OPERATOR","->",344],["T_STRING","order",344],"(",["T_VARIABLE","$attribute",344],["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","' '",344],["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_VARIABLE","$dir",344],")",";",["T_WHITESPACE","\n                ",344],["T_BREAK","break",345],";",["T_WHITESPACE","\n            ",345],["T_CASE","case",346],["T_WHITESPACE"," ",346],["T_CONSTANT_ENCAPSED_STRING","'stores'",346],":",["T_WHITESPACE","\n                ",346],["T_COMMENT","\/\/ No way to sort\n",347],["T_WHITESPACE","                ",348],["T_BREAK","break",348],";",["T_WHITESPACE","\n            ",348],["T_CASE","case",349],["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'type'",349],":",["T_WHITESPACE","\n                ",349],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getSelect",350],"(",")",["T_OBJECT_OPERATOR","->",350],["T_STRING","order",350],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.customer_id '",350],["T_WHITESPACE"," ",350],".",["T_WHITESPACE"," ",350],["T_VARIABLE","$dir",350],")",";",["T_WHITESPACE","\n                ",350],["T_BREAK","break",351],";",["T_WHITESPACE","\n            ",351],["T_DEFAULT","default",352],":",["T_WHITESPACE","\n                ",352],["T_STRING","parent",353],["T_DOUBLE_COLON","::",353],["T_STRING","setOrder",353],"(",["T_VARIABLE","$attribute",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$dir",353],")",";",["T_WHITESPACE","\n        ",353],"}",["T_WHITESPACE","\n        ",354],["T_RETURN","return",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],";",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n\n    ",356],["T_DOC_COMMENT","\/**\n     * Add attribute to filter\n     *\n     * @param Mage_Eav_Model_Entity_Attribute_Abstract|string $attribute\n     * @param array $condition\n     * @param string $joinType\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",358],["T_WHITESPACE","\n    ",365],["T_PUBLIC","public",366],["T_WHITESPACE"," ",366],["T_FUNCTION","function",366],["T_WHITESPACE"," ",366],["T_STRING","addAttributeToFilter",366],"(",["T_VARIABLE","$attribute",366],",",["T_WHITESPACE"," ",366],["T_VARIABLE","$condition",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_STRING","null",366],",",["T_WHITESPACE"," ",366],["T_VARIABLE","$joinType",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_CONSTANT_ENCAPSED_STRING","'inner'",366],")",["T_WHITESPACE","\n    ",366],"{",["T_WHITESPACE","\n        ",367],["T_SWITCH","switch",368],"(",["T_VARIABLE","$attribute",368],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n            ",368],["T_CASE","case",369],["T_WHITESPACE"," ",369],["T_CONSTANT_ENCAPSED_STRING","'rt.review_id'",369],":",["T_WHITESPACE","\n            ",369],["T_CASE","case",370],["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'rt.created_at'",370],":",["T_WHITESPACE","\n            ",370],["T_CASE","case",371],["T_WHITESPACE"," ",371],["T_CONSTANT_ENCAPSED_STRING","'rt.status_id'",371],":",["T_WHITESPACE","\n            ",371],["T_CASE","case",372],["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'rdt.title'",372],":",["T_WHITESPACE","\n            ",372],["T_CASE","case",373],["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'rdt.nickname'",373],":",["T_WHITESPACE","\n            ",373],["T_CASE","case",374],["T_WHITESPACE"," ",374],["T_CONSTANT_ENCAPSED_STRING","'rdt.detail'",374],":",["T_WHITESPACE","\n                ",374],["T_VARIABLE","$conditionSql",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_getConditionSql",375],"(",["T_VARIABLE","$attribute",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$condition",375],")",";",["T_WHITESPACE","\n                ",375],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getSelect",376],"(",")",["T_OBJECT_OPERATOR","->",376],["T_STRING","where",376],"(",["T_VARIABLE","$conditionSql",376],")",";",["T_WHITESPACE","\n                ",376],["T_BREAK","break",377],";",["T_WHITESPACE","\n            ",377],["T_CASE","case",378],["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'stores'",378],":",["T_WHITESPACE","\n                ",378],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","setStoreFilter",379],"(",["T_VARIABLE","$condition",379],")",";",["T_WHITESPACE","\n                ",379],["T_BREAK","break",380],";",["T_WHITESPACE","\n            ",380],["T_CASE","case",381],["T_WHITESPACE"," ",381],["T_CONSTANT_ENCAPSED_STRING","'type'",381],":",["T_WHITESPACE","\n                ",381],["T_IF","if",382],["T_WHITESPACE"," ",382],"(",["T_VARIABLE","$condition",382],["T_WHITESPACE"," ",382],["T_IS_EQUAL","==",382],["T_WHITESPACE"," ",382],["T_LNUMBER","1",382],")",["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n                    ",382],["T_VARIABLE","$conditionParts",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_ARRAY","array",383],"(",["T_WHITESPACE","\n                        ",383],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_getConditionSql",384],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.customer_id'",384],",",["T_WHITESPACE"," ",384],["T_ARRAY","array",384],"(",["T_CONSTANT_ENCAPSED_STRING","'is'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_NEW","new",384],["T_WHITESPACE"," ",384],["T_STRING","Zend_Db_Expr",384],"(",["T_CONSTANT_ENCAPSED_STRING","'NULL'",384],")",")",")",",",["T_WHITESPACE","\n                        ",384],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","_getConditionSql",385],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.store_id'",385],",",["T_WHITESPACE"," ",385],["T_ARRAY","array",385],"(",["T_CONSTANT_ENCAPSED_STRING","'eq'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_STRING","Mage_Core_Model_App",385],["T_DOUBLE_COLON","::",385],["T_STRING","ADMIN_STORE_ID",385],")",")",["T_WHITESPACE","\n                    ",385],")",";",["T_WHITESPACE","\n                    ",386],["T_VARIABLE","$conditionSql",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_STRING","implode",387],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$conditionParts",387],")",";",["T_WHITESPACE","\n                ",387],"}",["T_WHITESPACE"," ",388],["T_ELSEIF","elseif",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$condition",388],["T_WHITESPACE"," ",388],["T_IS_EQUAL","==",388],["T_WHITESPACE"," ",388],["T_LNUMBER","2",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                    ",388],["T_VARIABLE","$conditionSql",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_getConditionSql",389],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.customer_id'",389],",",["T_WHITESPACE"," ",389],["T_ARRAY","array",389],"(",["T_CONSTANT_ENCAPSED_STRING","'gt'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_LNUMBER","0",389],")",")",";",["T_WHITESPACE","\n                ",389],"}",["T_WHITESPACE"," ",390],["T_ELSE","else",390],["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n                    ",390],["T_VARIABLE","$conditionParts",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_ARRAY","array",391],"(",["T_WHITESPACE","\n                        ",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_getConditionSql",392],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.customer_id'",392],",",["T_WHITESPACE"," ",392],["T_ARRAY","array",392],"(",["T_CONSTANT_ENCAPSED_STRING","'is'",392],["T_WHITESPACE"," ",392],["T_DOUBLE_ARROW","=>",392],["T_WHITESPACE"," ",392],["T_NEW","new",392],["T_WHITESPACE"," ",392],["T_STRING","Zend_Db_Expr",392],"(",["T_CONSTANT_ENCAPSED_STRING","'NULL'",392],")",")",")",",",["T_WHITESPACE","\n                        ",392],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_getConditionSql",393],"(",["T_CONSTANT_ENCAPSED_STRING","'rdt.store_id'",393],",",["T_WHITESPACE"," ",393],["T_ARRAY","array",393],"(",["T_CONSTANT_ENCAPSED_STRING","'neq'",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_STRING","Mage_Core_Model_App",393],["T_DOUBLE_COLON","::",393],["T_STRING","ADMIN_STORE_ID",393],")",")",["T_WHITESPACE","\n                    ",393],")",";",["T_WHITESPACE","\n                    ",394],["T_VARIABLE","$conditionSql",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_STRING","implode",395],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",395],",",["T_WHITESPACE"," ",395],["T_VARIABLE","$conditionParts",395],")",";",["T_WHITESPACE","\n                ",395],"}",["T_WHITESPACE","\n                ",396],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getSelect",397],"(",")",["T_OBJECT_OPERATOR","->",397],["T_STRING","where",397],"(",["T_VARIABLE","$conditionSql",397],")",";",["T_WHITESPACE","\n                ",397],["T_BREAK","break",398],";",["T_WHITESPACE","\n\n            ",398],["T_DEFAULT","default",400],":",["T_WHITESPACE","\n                ",400],["T_STRING","parent",401],["T_DOUBLE_COLON","::",401],["T_STRING","addAttributeToFilter",401],"(",["T_VARIABLE","$attribute",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$condition",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$joinType",401],")",";",["T_WHITESPACE","\n                ",401],["T_BREAK","break",402],";",["T_WHITESPACE","\n        ",402],"}",["T_WHITESPACE","\n        ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],";",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_DOC_COMMENT","\/**\n     * Retrieves column values\n     *\n     * @param string $colName\n     * @return array\n     *\/",407],["T_WHITESPACE","\n    ",412],["T_PUBLIC","public",413],["T_WHITESPACE"," ",413],["T_FUNCTION","function",413],["T_WHITESPACE"," ",413],["T_STRING","getColumnValues",413],"(",["T_VARIABLE","$colName",413],")",["T_WHITESPACE","\n    ",413],"{",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$col",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_ARRAY","array",415],"(",")",";",["T_WHITESPACE","\n        ",415],["T_FOREACH","foreach",416],["T_WHITESPACE"," ",416],"(",["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","getItems",416],"(",")",["T_WHITESPACE"," ",416],["T_AS","as",416],["T_WHITESPACE"," ",416],["T_VARIABLE","$item",416],")",["T_WHITESPACE"," ",416],"{",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$col",417],"[","]",["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_VARIABLE","$item",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getData",417],"(",["T_VARIABLE","$colName",417],")",";",["T_WHITESPACE","\n        ",417],"}",["T_WHITESPACE","\n        ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$col",419],";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n\n    ",420],["T_DOC_COMMENT","\/**\n     * Action after load\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",422],["T_WHITESPACE","\n    ",426],["T_PROTECTED","protected",427],["T_WHITESPACE"," ",427],["T_FUNCTION","function",427],["T_WHITESPACE"," ",427],["T_STRING","_afterLoad",427],"(",")",["T_WHITESPACE","\n    ",427],"{",["T_WHITESPACE","\n        ",428],["T_STRING","parent",429],["T_DOUBLE_COLON","::",429],["T_STRING","_afterLoad",429],"(",")",";",["T_WHITESPACE","\n        ",429],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_addStoreDataFlag",430],")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n            ",430],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","_addStoreData",431],"(",")",";",["T_WHITESPACE","\n        ",431],"}",["T_WHITESPACE","\n        ",432],["T_RETURN","return",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],";",["T_WHITESPACE","\n    ",433],"}",["T_WHITESPACE","\n\n    ",434],["T_DOC_COMMENT","\/**\n     * Add store data\n     *\n     *\/",436],["T_WHITESPACE","\n    ",439],["T_PROTECTED","protected",440],["T_WHITESPACE"," ",440],["T_FUNCTION","function",440],["T_WHITESPACE"," ",440],["T_STRING","_addStoreData",440],"(",")",["T_WHITESPACE","\n    ",440],"{",["T_WHITESPACE","\n        ",441],["T_VARIABLE","$adapter",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","getConnection",442],"(",")",";",["T_WHITESPACE","\n        ",442],["T_COMMENT","\/\/$this->_getConditionSql('rdt.customer_id', array('null' => null));\n",443],["T_WHITESPACE","        ",444],["T_VARIABLE","$reviewsIds",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getColumnValues",444],"(",["T_CONSTANT_ENCAPSED_STRING","'review_id'",444],")",";",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$storesToReviews",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_ARRAY","array",445],"(",")",";",["T_WHITESPACE","\n        ",445],["T_IF","if",446],["T_WHITESPACE"," ",446],"(",["T_STRING","count",446],"(",["T_VARIABLE","$reviewsIds",446],")",">",["T_LNUMBER","0",446],")",["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n            ",446],["T_VARIABLE","$reviewIdCondition",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","_getConditionSql",447],"(",["T_CONSTANT_ENCAPSED_STRING","'review_id'",447],",",["T_WHITESPACE"," ",447],["T_ARRAY","array",447],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",447],["T_WHITESPACE"," ",447],["T_DOUBLE_ARROW","=>",447],["T_WHITESPACE"," ",447],["T_VARIABLE","$reviewsIds",447],")",")",";",["T_WHITESPACE","\n            ",447],["T_VARIABLE","$storeIdCondition",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","_getConditionSql",448],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",448],",",["T_WHITESPACE"," ",448],["T_ARRAY","array",448],"(",["T_CONSTANT_ENCAPSED_STRING","'gt'",448],["T_WHITESPACE"," ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_LNUMBER","0",448],")",")",";",["T_WHITESPACE","\n            ",448],["T_VARIABLE","$select",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$adapter",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","select",449],"(",")",["T_WHITESPACE","\n                ",449],["T_OBJECT_OPERATOR","->",450],["T_STRING","from",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","_reviewStoreTable",450],")",["T_WHITESPACE","\n                ",450],["T_OBJECT_OPERATOR","->",451],["T_STRING","where",451],"(",["T_VARIABLE","$reviewIdCondition",451],")",["T_WHITESPACE","\n                ",451],["T_OBJECT_OPERATOR","->",452],["T_STRING","where",452],"(",["T_VARIABLE","$storeIdCondition",452],")",";",["T_WHITESPACE","\n            ",452],["T_VARIABLE","$result",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_VARIABLE","$adapter",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","fetchAll",453],"(",["T_VARIABLE","$select",453],")",";",["T_WHITESPACE","\n            ",453],["T_FOREACH","foreach",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$result",454],["T_WHITESPACE"," ",454],["T_AS","as",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$row",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n                ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(","!",["T_ISSET","isset",455],"(",["T_VARIABLE","$storesToReviews",455],"[",["T_VARIABLE","$row",455],"[",["T_CONSTANT_ENCAPSED_STRING","'review_id'",455],"]","]",")",")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                    ",455],["T_VARIABLE","$storesToReviews",456],"[",["T_VARIABLE","$row",456],"[",["T_CONSTANT_ENCAPSED_STRING","'review_id'",456],"]","]",["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_ARRAY","array",456],"(",")",";",["T_WHITESPACE","\n                ",456],"}",["T_WHITESPACE","\n                ",457],["T_VARIABLE","$storesToReviews",458],"[",["T_VARIABLE","$row",458],"[",["T_CONSTANT_ENCAPSED_STRING","'review_id'",458],"]","]","[","]",["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$row",458],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",458],"]",";",["T_WHITESPACE","\n            ",458],"}",["T_WHITESPACE","\n        ",459],"}",["T_WHITESPACE","\n\n        ",460],["T_FOREACH","foreach",462],["T_WHITESPACE"," ",462],"(",["T_VARIABLE","$this",462],["T_WHITESPACE"," ",462],["T_AS","as",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$item",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_IF","if",463],["T_WHITESPACE"," ",463],"(",["T_ISSET","isset",463],"(",["T_VARIABLE","$storesToReviews",463],"[",["T_VARIABLE","$item",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","getReviewId",463],"(",")","]",")",")",["T_WHITESPACE"," ",463],"{",["T_WHITESPACE","\n                ",463],["T_VARIABLE","$item",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","setData",464],"(",["T_CONSTANT_ENCAPSED_STRING","'stores'",464],",",["T_WHITESPACE"," ",464],["T_VARIABLE","$storesToReviews",464],"[",["T_VARIABLE","$item",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","getReviewId",464],"(",")","]",")",";",["T_WHITESPACE","\n            ",464],"}",["T_WHITESPACE"," ",465],["T_ELSE","else",465],["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n                ",465],["T_VARIABLE","$item",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","setData",466],"(",["T_CONSTANT_ENCAPSED_STRING","'stores'",466],",",["T_WHITESPACE"," ",466],["T_ARRAY","array",466],"(",")",")",";",["T_WHITESPACE","\n            ",466],"}",["T_WHITESPACE","\n\n        ",467],"}",["T_WHITESPACE","\n    ",469],"}",["T_WHITESPACE","\n\n    ",470],["T_DOC_COMMENT","\/**\n     * Redeclare parent method for store filters applying\n     *\n     * @return Mage_Review_Model_Resource_Review_Product_Collection\n     *\/",472],["T_WHITESPACE","\n    ",476],["T_PROTECTED","protected",477],["T_WHITESPACE"," ",477],["T_FUNCTION","function",477],["T_WHITESPACE"," ",477],["T_STRING","_beforeLoad",477],"(",")",["T_WHITESPACE","\n    ",477],"{",["T_WHITESPACE","\n        ",478],["T_STRING","parent",479],["T_DOUBLE_COLON","::",479],["T_STRING","_beforeLoad",479],"(",")",";",["T_WHITESPACE","\n        ",479],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","_applyStoresFilterToSelect",480],"(",")",";",["T_WHITESPACE","\n\n        ",480],["T_RETURN","return",482],["T_WHITESPACE"," ",482],["T_VARIABLE","$this",482],";",["T_WHITESPACE","\n    ",482],"}",["T_WHITESPACE","\n",483],"}",["T_WHITESPACE","\n",484]]