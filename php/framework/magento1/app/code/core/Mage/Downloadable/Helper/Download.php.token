[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Downloadable\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Downloadable Products Download Helper\n *\n * @category    Mage\n * @package     Mage_Downloadable\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Downloadable_Helper_Download",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Helper_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","LINK_TYPE_URL",36],["T_WHITESPACE","         ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'url'",36],";",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","LINK_TYPE_FILE",37],["T_WHITESPACE","        ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'file'",37],";",["T_WHITESPACE","\n\n    ",37],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","XML_PATH_CONTENT_DISPOSITION",39],["T_WHITESPACE","  ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'catalog\/downloadable\/content_disposition'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Type of link\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_linkType",46],["T_WHITESPACE","        ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","self",46],["T_DOUBLE_COLON","::",46],["T_STRING","LINK_TYPE_FILE",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Resource file\n     *\n     * @var string\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$_resourceFile",53],["T_WHITESPACE","    ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","null",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Resource open handle\n     *\n     * @var resource\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_handle",60],["T_WHITESPACE","          ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","null",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Remote server headers\n     *\n     * @var array\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_urlHeaders",67],["T_WHITESPACE","      ",67],"=",["T_WHITESPACE"," ",67],["T_ARRAY","array",67],"(",")",";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * MIME Content-type for a file\n     *\n     * @var string\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_contentType",74],["T_WHITESPACE","     ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'application\/octet-stream'",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * File name\n     *\n     * @var string\n     *\/",76],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$_fileName",81],["T_WHITESPACE","        ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'download'",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Retrieve Resource file handle (socket, file pointer etc)\n     *\n     * @return resource\n     *\/",83],["T_WHITESPACE","\n    ",87],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","_getHandle",88],"(",")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(","!",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_resourceFile",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_STRING","Mage",91],["T_DOUBLE_COLON","::",91],["T_STRING","throwException",91],"(",["T_STRING","Mage",91],["T_DOUBLE_COLON","::",91],["T_STRING","helper",91],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","__",91],"(",["T_CONSTANT_ENCAPSED_STRING","'Please set resource file and link type.'",91],")",")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n\n        ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","is_null",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_handle",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_linkType",95],["T_WHITESPACE"," ",95],["T_IS_EQUAL","==",95],["T_WHITESPACE"," ",95],["T_STRING","self",95],["T_DOUBLE_COLON","::",95],["T_STRING","LINK_TYPE_URL",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n\n                ",95],["T_DOC_COMMENT","\/**\n                 * Validate URL\n                 *\/",97],["T_WHITESPACE","\n                ",99],["T_VARIABLE","$urlProp",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","parse_url",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_resourceFile",100],")",";",["T_WHITESPACE","\n                ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(","!",["T_ISSET","isset",101],"(",["T_VARIABLE","$urlProp",101],"[",["T_CONSTANT_ENCAPSED_STRING","'scheme'",101],"]",")",["T_WHITESPACE","\n                    ",101],["T_BOOLEAN_OR","||",102],["T_WHITESPACE"," ",102],["T_STRING","strtolower",102],"(",["T_VARIABLE","$urlProp",102],"[",["T_CONSTANT_ENCAPSED_STRING","'scheme'",102],"]",["T_WHITESPACE"," ",102],["T_IS_NOT_EQUAL","!=",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'http'",102],")",["T_WHITESPACE"," ",102],["T_BOOLEAN_AND","&&",102],["T_WHITESPACE"," ",102],["T_STRING","strtolower",102],"(",["T_VARIABLE","$urlProp",102],"[",["T_CONSTANT_ENCAPSED_STRING","'scheme'",102],"]",["T_WHITESPACE"," ",102],["T_IS_NOT_EQUAL","!=",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'https'",102],")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                    ",102],["T_STRING","Mage",103],["T_DOUBLE_COLON","::",103],["T_STRING","throwException",103],"(",["T_STRING","Mage",103],["T_DOUBLE_COLON","::",103],["T_STRING","helper",103],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",103],")",["T_OBJECT_OPERATOR","->",103],["T_STRING","__",103],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid download URL scheme.'",103],")",")",";",["T_WHITESPACE","\n                ",103],"}",["T_WHITESPACE","\n                ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(","!",["T_ISSET","isset",105],"(",["T_VARIABLE","$urlProp",105],"[",["T_CONSTANT_ENCAPSED_STRING","'host'",105],"]",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                    ",105],["T_STRING","Mage",106],["T_DOUBLE_COLON","::",106],["T_STRING","throwException",106],"(",["T_STRING","Mage",106],["T_DOUBLE_COLON","::",106],["T_STRING","helper",106],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","__",106],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid download URL host.'",106],")",")",";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE","\n                ",107],["T_SWITCH","switch",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$urlProp",108],"[",["T_CONSTANT_ENCAPSED_STRING","'scheme'",108],"]",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                    ",108],["T_CASE","case",109],["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'https'",109],":",["T_WHITESPACE","\n                        ",109],["T_VARIABLE","$scheme",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'ssl:\/\/'",110],";",["T_WHITESPACE","\n                        ",110],["T_VARIABLE","$port",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_LNUMBER","443",111],";",["T_WHITESPACE","\n                        ",111],["T_BREAK","break",112],";",["T_WHITESPACE","\n                    ",112],["T_CASE","case",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'http'",113],":",["T_WHITESPACE","\n                    ",113],["T_DEFAULT","default",114],":",["T_WHITESPACE","\n                        ",114],["T_VARIABLE","$scheme",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","''",115],";",["T_WHITESPACE","\n                        ",115],["T_VARIABLE","$port",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_LNUMBER","80",116],";",["T_WHITESPACE","\n                ",116],"}",["T_WHITESPACE","\n                ",117],["T_VARIABLE","$hostname",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$scheme",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$urlProp",118],"[",["T_CONSTANT_ENCAPSED_STRING","'host'",118],"]",";",["T_WHITESPACE","\n\n                ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_ISSET","isset",120],"(",["T_VARIABLE","$urlProp",120],"[",["T_CONSTANT_ENCAPSED_STRING","'port'",120],"]",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                    ",120],["T_VARIABLE","$port",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_INT_CAST","(int)",121],["T_VARIABLE","$urlProp",121],"[",["T_CONSTANT_ENCAPSED_STRING","'port'",121],"]",";",["T_WHITESPACE","\n                ",121],"}",["T_WHITESPACE","\n\n                ",122],["T_VARIABLE","$path",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'\/'",124],";",["T_WHITESPACE","\n                ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_ISSET","isset",125],"(",["T_VARIABLE","$urlProp",125],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",125],"]",")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                    ",125],["T_VARIABLE","$path",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$urlProp",126],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",126],"]",";",["T_WHITESPACE","\n                ",126],"}",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$query",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","''",128],";",["T_WHITESPACE","\n                ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_ISSET","isset",129],"(",["T_VARIABLE","$urlProp",129],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",129],"]",")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                    ",129],["T_VARIABLE","$query",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'?'",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_VARIABLE","$urlProp",130],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",130],"]",";",["T_WHITESPACE","\n                ",130],"}",["T_WHITESPACE","\n\n                ",131],["T_TRY","try",133],["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                    ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_handle",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","fsockopen",134],"(",["T_VARIABLE","$hostname",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$port",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$errno",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$errstr",134],")",";",["T_WHITESPACE","\n                ",134],"}",["T_WHITESPACE","\n                ",135],["T_CATCH","catch",136],["T_WHITESPACE"," ",136],"(",["T_STRING","Exception",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$e",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                    ",136],["T_THROW","throw",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$e",137],";",["T_WHITESPACE","\n                ",137],"}",["T_WHITESPACE","\n\n                ",138],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_handle",140],["T_WHITESPACE"," ",140],["T_IS_IDENTICAL","===",140],["T_WHITESPACE"," ",140],["T_STRING","false",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                    ",140],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","throwException",141],"(",["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","helper",141],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","__",141],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot connect to remote host, error: %s.'",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$errstr",141],")",")",";",["T_WHITESPACE","\n                ",141],"}",["T_WHITESPACE","\n\n                ",142],["T_VARIABLE","$headers",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'GET '",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_VARIABLE","$path",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_VARIABLE","$query",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","' HTTP\/1.0'",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",144],["T_WHITESPACE","\n                    ",144],".",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'Host: '",145],["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_VARIABLE","$urlProp",145],"[",["T_CONSTANT_ENCAPSED_STRING","'host'",145],"]",["T_WHITESPACE"," ",145],".",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",145],["T_WHITESPACE","\n                    ",145],".",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'User-Agent: Magento ver\/'",146],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_STRING","Mage",146],["T_DOUBLE_COLON","::",146],["T_STRING","getVersion",146],"(",")",["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",146],["T_WHITESPACE","\n                    ",146],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'Connection: close'",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",147],["T_WHITESPACE","\n                    ",147],".",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",148],";",["T_WHITESPACE","\n                ",148],["T_STRING","fwrite",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_handle",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$headers",149],")",";",["T_WHITESPACE","\n\n                ",149],["T_WHILE","while",151],["T_WHITESPACE"," ",151],"(","!",["T_STRING","feof",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_handle",151],")",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                    ",151],["T_VARIABLE","$str",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","fgets",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_handle",152],",",["T_WHITESPACE"," ",152],["T_LNUMBER","1024",152],")",";",["T_WHITESPACE","\n                    ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$str",153],["T_WHITESPACE"," ",153],["T_IS_EQUAL","==",153],["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n                        ",153],["T_BREAK","break",154],";",["T_WHITESPACE","\n                    ",154],"}",["T_WHITESPACE","\n                    ",155],["T_VARIABLE","$match",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_ARRAY","array",156],"(",")",";",["T_WHITESPACE","\n                    ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_STRING","preg_match",157],"(",["T_CONSTANT_ENCAPSED_STRING","'#^([^:]+): (.*)\\s+$#'",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$str",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$match",157],")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                        ",157],["T_VARIABLE","$k",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","strtolower",158],"(",["T_VARIABLE","$match",158],"[",["T_LNUMBER","1",158],"]",")",";",["T_WHITESPACE","\n                        ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$k",159],["T_WHITESPACE"," ",159],["T_IS_EQUAL","==",159],["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'set-cookie'",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                            ",159],["T_CONTINUE","continue",160],";",["T_WHITESPACE","\n                        ",160],"}",["T_WHITESPACE","\n                        ",161],["T_ELSE","else",162],["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                            ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_urlHeaders",163],"[",["T_VARIABLE","$k",163],"]",["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","trim",163],"(",["T_VARIABLE","$match",163],"[",["T_LNUMBER","2",163],"]",")",";",["T_WHITESPACE","\n                        ",163],"}",["T_WHITESPACE","\n                    ",164],"}",["T_WHITESPACE","\n                    ",165],["T_ELSEIF","elseif",166],["T_WHITESPACE"," ",166],"(",["T_STRING","preg_match",166],"(",["T_CONSTANT_ENCAPSED_STRING","'#^HTTP\/[0-9\\.]+ (\\d+) (.*)\\s$#'",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$str",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$match",166],")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                        ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_urlHeaders",167],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",167],"]",["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$match",167],"[",["T_LNUMBER","1",167],"]",";",["T_WHITESPACE","\n                        ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_urlHeaders",168],"[",["T_CONSTANT_ENCAPSED_STRING","'code-string'",168],"]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","trim",168],"(",["T_VARIABLE","$match",168],"[",["T_LNUMBER","2",168],"]",")",";",["T_WHITESPACE","\n                    ",168],"}",["T_WHITESPACE","\n                ",169],"}",["T_WHITESPACE","\n\n                ",170],["T_IF","if",172],["T_WHITESPACE"," ",172],"(","!",["T_ISSET","isset",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_urlHeaders",172],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",172],"]",")",["T_WHITESPACE"," ",172],["T_BOOLEAN_OR","||",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_urlHeaders",172],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",172],"]",["T_WHITESPACE"," ",172],["T_IS_NOT_EQUAL","!=",172],["T_WHITESPACE"," ",172],["T_LNUMBER","200",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n                    ",172],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","throwException",173],"(",["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","helper",173],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",173],")",["T_OBJECT_OPERATOR","->",173],["T_STRING","__",173],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while getting the requested content. Please contact the store owner.'",173],")",")",";",["T_WHITESPACE","\n                ",173],"}",["T_WHITESPACE","\n            ",174],"}",["T_WHITESPACE","\n            ",175],["T_ELSEIF","elseif",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_linkType",176],["T_WHITESPACE"," ",176],["T_IS_EQUAL","==",176],["T_WHITESPACE"," ",176],["T_STRING","self",176],["T_DOUBLE_COLON","::",176],["T_STRING","LINK_TYPE_FILE",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_handle",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_NEW","new",177],["T_WHITESPACE"," ",177],["T_STRING","Varien_Io_File",177],"(",")",";",["T_WHITESPACE","\n                ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_STRING","is_file",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_resourceFile",178],")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                    ",178],["T_STRING","Mage",179],["T_DOUBLE_COLON","::",179],["T_STRING","helper",179],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",179],")",["T_OBJECT_OPERATOR","->",179],["T_STRING","saveFileToFilesystem",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_resourceFile",179],")",";",["T_WHITESPACE","\n                ",179],"}",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_handle",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","open",181],"(",["T_ARRAY","array",181],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",181],["T_DOUBLE_ARROW","=>",181],["T_STRING","Mage",181],["T_DOUBLE_COLON","::",181],["T_STRING","getBaseDir",181],"(",["T_CONSTANT_ENCAPSED_STRING","'var'",181],")",")",")",";",["T_WHITESPACE","\n                ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(","!",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_handle",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","fileExists",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_resourceFile",182],",",["T_WHITESPACE"," ",182],["T_STRING","true",182],")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                    ",182],["T_STRING","Mage",183],["T_DOUBLE_COLON","::",183],["T_STRING","throwException",183],"(",["T_STRING","Mage",183],["T_DOUBLE_COLON","::",183],["T_STRING","helper",183],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",183],")",["T_OBJECT_OPERATOR","->",183],["T_STRING","__",183],"(",["T_CONSTANT_ENCAPSED_STRING","'The file does not exist.'",183],")",")",";",["T_WHITESPACE","\n                ",183],"}",["T_WHITESPACE","\n                ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_handle",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","streamOpen",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_resourceFile",185],",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'r'",185],")",";",["T_WHITESPACE","\n            ",185],"}",["T_WHITESPACE","\n            ",186],["T_ELSE","else",187],["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                ",187],["T_STRING","Mage",188],["T_DOUBLE_COLON","::",188],["T_STRING","throwException",188],"(",["T_STRING","Mage",188],["T_DOUBLE_COLON","::",188],["T_STRING","helper",188],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",188],")",["T_OBJECT_OPERATOR","->",188],["T_STRING","__",188],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid download link type.'",188],")",")",";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_handle",191],";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_DOC_COMMENT","\/**\n     * Retrieve file size in bytes\n     *\/",194],["T_WHITESPACE","\n    ",196],["T_PUBLIC","public",197],["T_WHITESPACE"," ",197],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","getFilesize",197],"(",")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$handle",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_getHandle",199],"(",")",";",["T_WHITESPACE","\n        ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_linkType",200],["T_WHITESPACE"," ",200],["T_IS_EQUAL","==",200],["T_WHITESPACE"," ",200],["T_STRING","self",200],["T_DOUBLE_COLON","::",200],["T_STRING","LINK_TYPE_FILE",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$handle",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","streamStat",201],"(",["T_CONSTANT_ENCAPSED_STRING","'size'",201],")",";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n        ",202],["T_ELSEIF","elseif",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_linkType",203],["T_WHITESPACE"," ",203],["T_IS_EQUAL","==",203],["T_WHITESPACE"," ",203],["T_STRING","self",203],["T_DOUBLE_COLON","::",203],["T_STRING","LINK_TYPE_URL",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_ISSET","isset",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_urlHeaders",204],"[",["T_CONSTANT_ENCAPSED_STRING","'content-length'",204],"]",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n                ",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_urlHeaders",205],"[",["T_CONSTANT_ENCAPSED_STRING","'content-length'",205],"]",";",["T_WHITESPACE","\n            ",205],"}",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE","\n        ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_STRING","null",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_PUBLIC","public",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","getContentType",211],"(",")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$handle",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_getHandle",213],"(",")",";",["T_WHITESPACE","\n        ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_linkType",214],["T_WHITESPACE"," ",214],["T_IS_EQUAL","==",214],["T_WHITESPACE"," ",214],["T_STRING","self",214],["T_DOUBLE_COLON","::",214],["T_STRING","LINK_TYPE_FILE",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_IF","if",215],["T_WHITESPACE"," ",215],"(",["T_STRING","function_exists",215],"(",["T_CONSTANT_ENCAPSED_STRING","'mime_content_type'",215],")",["T_WHITESPACE"," ",215],["T_BOOLEAN_AND","&&",215],["T_WHITESPACE"," ",215],"(",["T_VARIABLE","$contentType",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_STRING","mime_content_type",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_resourceFile",215],")",")",")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n                ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$contentType",216],";",["T_WHITESPACE","\n            ",216],"}",["T_WHITESPACE"," ",217],["T_ELSE","else",217],["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_STRING","Mage",218],["T_DOUBLE_COLON","::",218],["T_STRING","helper",218],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/file'",218],")",["T_OBJECT_OPERATOR","->",218],["T_STRING","getFileType",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_resourceFile",218],")",";",["T_WHITESPACE","\n            ",218],"}",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n        ",220],["T_ELSEIF","elseif",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_linkType",221],["T_WHITESPACE"," ",221],["T_IS_EQUAL","==",221],["T_WHITESPACE"," ",221],["T_STRING","self",221],["T_DOUBLE_COLON","::",221],["T_STRING","LINK_TYPE_URL",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(",["T_ISSET","isset",222],"(",["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_urlHeaders",222],"[",["T_CONSTANT_ENCAPSED_STRING","'content-type'",222],"]",")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n                ",222],["T_VARIABLE","$contentType",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","explode",223],"(",["T_CONSTANT_ENCAPSED_STRING","'; '",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_urlHeaders",223],"[",["T_CONSTANT_ENCAPSED_STRING","'content-type'",223],"]",")",";",["T_WHITESPACE","\n                ",223],["T_RETURN","return",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$contentType",224],"[",["T_LNUMBER","0",224],"]",";",["T_WHITESPACE","\n            ",224],"}",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_contentType",227],";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_PUBLIC","public",230],["T_WHITESPACE"," ",230],["T_FUNCTION","function",230],["T_WHITESPACE"," ",230],["T_STRING","getFilename",230],"(",")",["T_WHITESPACE","\n    ",230],"{",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$handle",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_getHandle",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_linkType",233],["T_WHITESPACE"," ",233],["T_IS_EQUAL","==",233],["T_WHITESPACE"," ",233],["T_STRING","self",233],["T_DOUBLE_COLON","::",233],["T_STRING","LINK_TYPE_FILE",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n            ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_STRING","pathinfo",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_resourceFile",234],",",["T_WHITESPACE"," ",234],["T_STRING","PATHINFO_BASENAME",234],")",";",["T_WHITESPACE","\n        ",234],"}",["T_WHITESPACE","\n        ",235],["T_ELSEIF","elseif",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_linkType",236],["T_WHITESPACE"," ",236],["T_IS_EQUAL","==",236],["T_WHITESPACE"," ",236],["T_STRING","self",236],["T_DOUBLE_COLON","::",236],["T_STRING","LINK_TYPE_URL",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_ISSET","isset",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_urlHeaders",237],"[",["T_CONSTANT_ENCAPSED_STRING","'content-disposition'",237],"]",")",")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n                ",237],["T_VARIABLE","$contentDisposition",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_STRING","explode",238],"(",["T_CONSTANT_ENCAPSED_STRING","'; '",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_urlHeaders",238],"[",["T_CONSTANT_ENCAPSED_STRING","'content-disposition'",238],"]",")",";",["T_WHITESPACE","\n                ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(","!",["T_EMPTY","empty",239],"(",["T_VARIABLE","$contentDisposition",239],"[",["T_LNUMBER","1",239],"]",")",["T_WHITESPACE"," ",239],["T_BOOLEAN_AND","&&",239],["T_WHITESPACE"," ",239],["T_STRING","strpos",239],"(",["T_VARIABLE","$contentDisposition",239],"[",["T_LNUMBER","1",239],"]",",",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","'filename='",239],")",["T_WHITESPACE"," ",239],["T_IS_NOT_IDENTICAL","!==",239],["T_WHITESPACE"," ",239],["T_STRING","false",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                    ",239],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_STRING","substr",240],"(",["T_VARIABLE","$contentDisposition",240],"[",["T_LNUMBER","1",240],"]",",",["T_WHITESPACE"," ",240],["T_LNUMBER","9",240],")",";",["T_WHITESPACE","\n                ",240],"}",["T_WHITESPACE","\n            ",241],"}",["T_WHITESPACE","\n            ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$fileName",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],"@",["T_STRING","pathinfo",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_resourceFile",243],",",["T_WHITESPACE"," ",243],["T_STRING","PATHINFO_BASENAME",243],")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n                ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$fileName",244],";",["T_WHITESPACE","\n            ",244],"}",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n        ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_fileName",247],";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_DOC_COMMENT","\/**\n     * Set resource file for download\n     *\n     * @param string $resourceFile\n     * @param string $linkType\n     * @return Mage_Downloadable_Helper_Download\n     *\/",250],["T_WHITESPACE","\n    ",256],["T_PUBLIC","public",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","setResource",257],"(",["T_VARIABLE","$resourceFile",257],",",["T_WHITESPACE"," ",257],["T_VARIABLE","$linkType",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_STRING","self",257],["T_DOUBLE_COLON","::",257],["T_STRING","LINK_TYPE_FILE",257],")",["T_WHITESPACE","\n    ",257],"{",["T_WHITESPACE","\n        ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_STRING","self",259],["T_DOUBLE_COLON","::",259],["T_STRING","LINK_TYPE_FILE",259],["T_WHITESPACE"," ",259],["T_IS_EQUAL","==",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$linkType",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_COMMENT","\/\/check LFI protection\n",260],["T_WHITESPACE","            ",261],["T_DOC_COMMENT","\/** @var $helper Mage_Core_Helper_Data *\/",261],["T_WHITESPACE","\n            ",261],["T_VARIABLE","$helper",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_STRING","Mage",262],["T_DOUBLE_COLON","::",262],["T_STRING","helper",262],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",262],")",";",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$helper",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","checkLfiProtection",263],"(",["T_VARIABLE","$resourceFile",263],")",";",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n\n        ",264],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_resourceFile",266],["T_WHITESPACE","    ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$resourceFile",266],";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_linkType",267],["T_WHITESPACE","        ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$linkType",267],";",["T_WHITESPACE","\n\n        ",267],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * Retrieve Http Request Object\n     *\n     * @return Mage_Core_Controller_Request_Http\n     *\/",272],["T_WHITESPACE","\n    ",276],["T_PUBLIC","public",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","getHttpRequest",277],"(",")",["T_WHITESPACE","\n    ",277],"{",["T_WHITESPACE","\n        ",278],["T_RETURN","return",279],["T_WHITESPACE"," ",279],["T_STRING","Mage",279],["T_DOUBLE_COLON","::",279],["T_STRING","app",279],"(",")",["T_OBJECT_OPERATOR","->",279],["T_STRING","getFrontController",279],"(",")",["T_OBJECT_OPERATOR","->",279],["T_STRING","getRequest",279],"(",")",";",["T_WHITESPACE","\n    ",279],"}",["T_WHITESPACE","\n\n    ",280],["T_DOC_COMMENT","\/**\n     * Retrieve Http Response Object\n     *\n     * @return Mage_Core_Controller_Response_Http\n     *\/",282],["T_WHITESPACE","\n    ",286],["T_PUBLIC","public",287],["T_WHITESPACE"," ",287],["T_FUNCTION","function",287],["T_WHITESPACE"," ",287],["T_STRING","getHttpResponse",287],"(",")",["T_WHITESPACE","\n    ",287],"{",["T_WHITESPACE","\n        ",288],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_STRING","Mage",289],["T_DOUBLE_COLON","::",289],["T_STRING","app",289],"(",")",["T_OBJECT_OPERATOR","->",289],["T_STRING","getFrontController",289],"(",")",["T_OBJECT_OPERATOR","->",289],["T_STRING","getResponse",289],"(",")",";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_PUBLIC","public",292],["T_WHITESPACE"," ",292],["T_FUNCTION","function",292],["T_WHITESPACE"," ",292],["T_STRING","output",292],"(",")",["T_WHITESPACE","\n    ",292],"{",["T_WHITESPACE","\n        ",293],["T_VARIABLE","$handle",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_getHandle",294],"(",")",";",["T_WHITESPACE","\n        ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_linkType",295],["T_WHITESPACE"," ",295],["T_IS_EQUAL","==",295],["T_WHITESPACE"," ",295],["T_STRING","self",295],["T_DOUBLE_COLON","::",295],["T_STRING","LINK_TYPE_FILE",295],")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n            ",295],["T_WHILE","while",296],["T_WHITESPACE"," ",296],"(",["T_VARIABLE","$buffer",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$handle",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","streamRead",296],"(",")",")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n                ",296],["T_PRINT","print",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$buffer",297],";",["T_WHITESPACE","\n            ",297],"}",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE","\n        ",299],["T_ELSEIF","elseif",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_linkType",300],["T_WHITESPACE"," ",300],["T_IS_EQUAL","==",300],["T_WHITESPACE"," ",300],["T_STRING","self",300],["T_DOUBLE_COLON","::",300],["T_STRING","LINK_TYPE_URL",300],")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n            ",300],["T_WHILE","while",301],["T_WHITESPACE"," ",301],"(","!",["T_STRING","feof",301],"(",["T_VARIABLE","$handle",301],")",")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n                ",301],["T_PRINT","print",302],["T_WHITESPACE"," ",302],["T_STRING","fgets",302],"(",["T_VARIABLE","$handle",302],",",["T_WHITESPACE"," ",302],["T_LNUMBER","1024",302],")",";",["T_WHITESPACE","\n            ",302],"}",["T_WHITESPACE","\n        ",303],"}",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n\n    ",305],["T_DOC_COMMENT","\/**\n     * Use Content-Disposition: attachment\n     *\n     * @param mixed $store\n     * @return bool\n     *\/",307],["T_WHITESPACE","\n    ",312],["T_PUBLIC","public",313],["T_WHITESPACE"," ",313],["T_FUNCTION","function",313],["T_WHITESPACE"," ",313],["T_STRING","getContentDisposition",313],"(",["T_VARIABLE","$store",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_STRING","null",313],")",["T_WHITESPACE","\n    ",313],"{",["T_WHITESPACE","\n        ",314],["T_RETURN","return",315],["T_WHITESPACE"," ",315],["T_STRING","Mage",315],["T_DOUBLE_COLON","::",315],["T_STRING","getStoreConfig",315],"(",["T_STRING","self",315],["T_DOUBLE_COLON","::",315],["T_STRING","XML_PATH_CONTENT_DISPOSITION",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$store",315],")",";",["T_WHITESPACE","\n    ",315],"}",["T_WHITESPACE","\n",316],"}",["T_WHITESPACE","\n",317]]