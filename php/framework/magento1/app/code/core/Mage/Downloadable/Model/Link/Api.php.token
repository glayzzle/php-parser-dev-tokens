[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Downloadable\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Downloadable links API model\n *\n * @category    Mage\n * @package     Mage_Downloadable\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Downloadable_Model_Link_Api",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Api_Resource",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Return validator instance\n     *\n     * @return Mage_Downloadable_Model_Link_Api_Validator\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_getValidator",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_RETURN","return",43],["T_WHITESPACE"," ",43],["T_STRING","Mage",43],["T_DOUBLE_COLON","::",43],["T_STRING","getSingleton",43],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/link_api_validator'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Decode file from base64 and upload it to donwloadable 'tmp' folder\n     *\n     * @param array $fileInfo\n     * @param string $type\n     * @return string\n     *\/",46],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","_uploadFile",53],"(",["T_VARIABLE","$fileInfo",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$type",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$tmpPath",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","''",55],";",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$type",56],["T_WHITESPACE"," ",56],["T_IS_EQUAL","==",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'sample'",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$tmpPath",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","Mage_Downloadable_Model_Sample",57],["T_DOUBLE_COLON","::",57],["T_STRING","getBaseTmpPath",57],"(",")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE"," ",58],["T_ELSEIF","elseif",58],["T_WHITESPACE"," ",58],"(",["T_VARIABLE","$type",58],["T_WHITESPACE"," ",58],["T_IS_EQUAL","==",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'link'",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$tmpPath",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","Mage_Downloadable_Model_Link",59],["T_DOUBLE_COLON","::",59],["T_STRING","getBaseTmpPath",59],"(",")",";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE"," ",60],["T_ELSEIF","elseif",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$type",60],["T_WHITESPACE"," ",60],["T_IS_EQUAL","==",60],["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'link_samples'",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$tmpPath",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","Mage_Downloadable_Model_Link",61],["T_DOUBLE_COLON","::",61],["T_STRING","getBaseSampleTmpPath",61],"(",")",";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$result",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_TRY","try",65],["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$uploader",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Mage",66],["T_DOUBLE_COLON","::",66],["T_STRING","getModel",66],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/link_api_uploader'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$fileInfo",66],")",";",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$uploader",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","setAllowRenameFiles",67],"(",["T_STRING","true",67],")",";",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$uploader",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","setFilesDispersion",68],"(",["T_STRING","true",68],")",";",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$result",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$uploader",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","save",69],"(",["T_VARIABLE","$tmpPath",69],")",";",["T_WHITESPACE","\n\n            ",69],["T_IF","if",71],["T_WHITESPACE"," ",71],"(",["T_ISSET","isset",71],"(",["T_VARIABLE","$result",71],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",71],"]",")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n                ",71],["T_VARIABLE","$fullPath",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","rtrim",72],"(",["T_VARIABLE","$tmpPath",72],",",["T_WHITESPACE"," ",72],["T_STRING","DS",72],")",["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_STRING","DS",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_STRING","ltrim",72],"(",["T_VARIABLE","$result",72],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",72],"]",",",["T_WHITESPACE"," ",72],["T_STRING","DS",72],")",";",["T_WHITESPACE","\n                ",72],["T_STRING","Mage",73],["T_DOUBLE_COLON","::",73],["T_STRING","helper",73],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",73],")",["T_OBJECT_OPERATOR","->",73],["T_STRING","saveFile",73],"(",["T_VARIABLE","$fullPath",73],")",";",["T_WHITESPACE","\n            ",73],"}",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE"," ",75],["T_CATCH","catch",75],["T_WHITESPACE"," ",75],"(",["T_STRING","Exception",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$e",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$e",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getMessage",76],"(",")",["T_WHITESPACE"," ",76],["T_IS_NOT_EQUAL","!=",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","''",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_fault",77],"(",["T_CONSTANT_ENCAPSED_STRING","'upload_failed'",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$e",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getMessage",77],"(",")",")",";",["T_WHITESPACE","\n            ",77],"}",["T_WHITESPACE"," ",78],["T_ELSE","else",78],["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_fault",79],"(",["T_VARIABLE","$e",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getCode",79],"(",")",")",";",["T_WHITESPACE","\n            ",79],"}",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$result",83],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",83],"]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'new'",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$result",84],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",84],"]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","substr",84],"(",["T_VARIABLE","$result",84],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",84],"]",",",["T_WHITESPACE"," ",84],["T_STRING","strrpos",84],"(",["T_VARIABLE","$result",84],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",84],"]",",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'\/'",84],")","+",["T_LNUMBER","1",84],")",";",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_STRING","Mage",85],["T_DOUBLE_COLON","::",85],["T_STRING","helper",85],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",85],")",["T_OBJECT_OPERATOR","->",85],["T_STRING","jsonEncode",85],"(",["T_ARRAY","array",85],"(",["T_VARIABLE","$result",85],")",")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Add downloadable content to product\n     *\n     * @param int|string $productId\n     * @param array $resource\n     * @param string $resourceType\n     * @param string|int|null $store\n     * @param string|null $identifierType ('sku'|'id')\n     * @return boolean\n     *\/",88],["T_WHITESPACE","\n    ",97],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","add",98],"(",["T_VARIABLE","$productId",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$resource",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$resourceType",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$store",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","null",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$identifierType",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","null",98],")",["T_WHITESPACE","\n    ",98],"{",["T_WHITESPACE","\n        ",99],["T_TRY","try",100],["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_getValidator",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","validateType",101],"(",["T_VARIABLE","$resourceType",101],")",";",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_getValidator",102],"(",")",["T_OBJECT_OPERATOR","->",102],["T_STRING","validateAttributes",102],"(",["T_VARIABLE","$resource",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$resourceType",102],")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE"," ",103],["T_CATCH","catch",103],["T_WHITESPACE"," ",103],"(",["T_STRING","Exception",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$e",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_fault",104],"(",["T_CONSTANT_ENCAPSED_STRING","'validation_error'",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$e",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getMessage",104],"(",")",")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$resource",107],"[",["T_CONSTANT_ENCAPSED_STRING","'is_delete'",107],"]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_LNUMBER","0",107],";",["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$resourceType",108],["T_WHITESPACE"," ",108],["T_IS_EQUAL","==",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'link'",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$resource",109],"[",["T_CONSTANT_ENCAPSED_STRING","'link_id'",109],"]",["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_LNUMBER","0",109],";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE"," ",110],["T_ELSEIF","elseif",110],["T_WHITESPACE"," ",110],"(",["T_VARIABLE","$resourceType",110],["T_WHITESPACE"," ",110],["T_IS_EQUAL","==",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'sample'",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$resource",111],"[",["T_CONSTANT_ENCAPSED_STRING","'sample_id'",111],"]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_LNUMBER","0",111],";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$resource",114],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",114],"]",["T_WHITESPACE"," ",114],["T_IS_EQUAL","==",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'file'",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_ISSET","isset",115],"(",["T_VARIABLE","$resource",115],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",115],"]",")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                ",115],["T_VARIABLE","$resource",116],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",116],"]",["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_uploadFile",116],"(",["T_VARIABLE","$resource",116],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",116],"]",",",["T_WHITESPACE"," ",116],["T_VARIABLE","$resourceType",116],")",";",["T_WHITESPACE","\n            ",116],"}",["T_WHITESPACE","\n            ",117],["T_UNSET","unset",118],"(",["T_VARIABLE","$resource",118],"[",["T_VARIABLE","$resourceType",118],".",["T_CONSTANT_ENCAPSED_STRING","'_url'",118],"]",")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE"," ",119],["T_ELSEIF","elseif",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$resource",119],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",119],"]",["T_WHITESPACE"," ",119],["T_IS_EQUAL","==",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'url'",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_UNSET","unset",120],"(",["T_VARIABLE","$resource",120],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",120],"]",")",";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n\n        ",121],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$resourceType",123],["T_WHITESPACE"," ",123],["T_IS_EQUAL","==",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'link'",123],["T_WHITESPACE"," ",123],["T_BOOLEAN_AND","&&",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$resource",123],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",123],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type'",123],"]",["T_WHITESPACE"," ",123],["T_IS_EQUAL","==",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'file'",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_ISSET","isset",124],"(",["T_VARIABLE","$resource",124],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",124],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",124],"]",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$resource",125],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",125],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",125],"]",["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_uploadFile",125],"(",["T_VARIABLE","$resource",125],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",125],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",125],"]",",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'link_samples'",125],")",";",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n            ",126],["T_UNSET","unset",127],"(",["T_VARIABLE","$resource",127],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",127],"]","[",["T_CONSTANT_ENCAPSED_STRING","'url'",127],"]",")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE"," ",128],["T_ELSEIF","elseif",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$resourceType",128],["T_WHITESPACE"," ",128],["T_IS_EQUAL","==",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'link'",128],["T_WHITESPACE"," ",128],["T_BOOLEAN_AND","&&",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$resource",128],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",128],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type'",128],"]",["T_WHITESPACE"," ",128],["T_IS_EQUAL","==",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'url'",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$resource",129],"[",["T_CONSTANT_ENCAPSED_STRING","'sample'",129],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",129],"]",["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","null",129],";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_VARIABLE","$product",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_getProduct",132],"(",["T_VARIABLE","$productId",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$store",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$identifierType",132],")",";",["T_WHITESPACE","\n        ",132],["T_TRY","try",133],["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$downloadable",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_ARRAY","array",134],"(",["T_VARIABLE","$resourceType",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_ARRAY","array",134],"(",["T_VARIABLE","$resource",134],")",")",";",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$product",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","setDownloadableData",135],"(",["T_VARIABLE","$downloadable",135],")",";",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$product",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","save",136],"(",")",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE"," ",137],["T_CATCH","catch",137],["T_WHITESPACE"," ",137],"(",["T_STRING","Exception",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$e",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_fault",138],"(",["T_CONSTANT_ENCAPSED_STRING","'save_error'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$e",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getMessage",138],"(",")",")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_STRING","true",141],";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * Retrieve downloadable product links\n     *\n     * @param int|string $productId\n     * @param string|int $store\n     * @param string $identifierType ('sku'|'id')\n     * @return array\n     *\/",144],["T_WHITESPACE","\n    ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","items",152],"(",["T_VARIABLE","$productId",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$store",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","null",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$identifierType",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","null",152],")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$product",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_getProduct",154],"(",["T_VARIABLE","$productId",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$store",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$identifierType",154],")",";",["T_WHITESPACE","\n\n        ",154],["T_VARIABLE","$linkArr",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_ARRAY","array",156],"(",")",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$links",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$product",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getTypeInstance",157],"(",["T_STRING","true",157],")",["T_OBJECT_OPERATOR","->",157],["T_STRING","getLinks",157],"(",["T_VARIABLE","$product",157],")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$downloadHelper",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","helper",158],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable'",158],")",";",["T_WHITESPACE","\n        ",158],["T_FOREACH","foreach",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$links",159],["T_WHITESPACE"," ",159],["T_AS","as",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$item",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$tmpLinkItem",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_ARRAY","array",160],"(",["T_WHITESPACE","\n                ",160],["T_CONSTANT_ENCAPSED_STRING","'link_id'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$item",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getId",161],"(",")",",",["T_WHITESPACE","\n                ",161],["T_CONSTANT_ENCAPSED_STRING","'title'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$item",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getTitle",162],"(",")",",",["T_WHITESPACE","\n                ",162],["T_CONSTANT_ENCAPSED_STRING","'price'",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$item",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getPrice",163],"(",")",",",["T_WHITESPACE","\n                ",163],["T_CONSTANT_ENCAPSED_STRING","'number_of_downloads'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$item",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getNumberOfDownloads",164],"(",")",",",["T_WHITESPACE","\n                ",164],["T_CONSTANT_ENCAPSED_STRING","'is_shareable'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$item",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getIsShareable",165],"(",")",",",["T_WHITESPACE","\n                ",165],["T_CONSTANT_ENCAPSED_STRING","'link_url'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$item",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getLinkUrl",166],"(",")",",",["T_WHITESPACE","\n                ",166],["T_CONSTANT_ENCAPSED_STRING","'link_type'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$item",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getLinkType",167],"(",")",",",["T_WHITESPACE","\n                ",167],["T_CONSTANT_ENCAPSED_STRING","'sample_file'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$item",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getSampleFile",168],"(",")",",",["T_WHITESPACE","\n                ",168],["T_CONSTANT_ENCAPSED_STRING","'sample_url'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$item",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getSampleUrl",169],"(",")",",",["T_WHITESPACE","\n                ",169],["T_CONSTANT_ENCAPSED_STRING","'sample_type'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$item",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getSampleType",170],"(",")",",",["T_WHITESPACE","\n                ",170],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$item",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getSortOrder",171],"(",")",["T_WHITESPACE","\n            ",171],")",";",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$file",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","helper",173],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/file'",173],")",["T_OBJECT_OPERATOR","->",173],["T_STRING","getFilePath",173],"(",["T_WHITESPACE","\n                ",173],["T_STRING","Mage_Downloadable_Model_Link",174],["T_DOUBLE_COLON","::",174],["T_STRING","getBasePath",174],"(",")",",",["T_WHITESPACE"," ",174],["T_VARIABLE","$item",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getLinkFile",174],"(",")",["T_WHITESPACE","\n            ",174],")",";",["T_WHITESPACE","\n\n            ",175],["T_IF","if",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$item",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getLinkFile",177],"(",")",["T_WHITESPACE"," ",177],["T_BOOLEAN_AND","&&",177],["T_WHITESPACE"," ",177],"!",["T_STRING","is_file",177],"(",["T_VARIABLE","$file",177],")",")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                ",177],["T_STRING","Mage",178],["T_DOUBLE_COLON","::",178],["T_STRING","helper",178],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",178],")",["T_OBJECT_OPERATOR","->",178],["T_STRING","saveFileToFilesystem",178],"(",["T_VARIABLE","$file",178],")",";",["T_WHITESPACE","\n            ",178],"}",["T_WHITESPACE","\n\n            ",179],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$item",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getLinkFile",181],"(",")",["T_WHITESPACE"," ",181],["T_BOOLEAN_AND","&&",181],["T_WHITESPACE"," ",181],["T_STRING","is_file",181],"(",["T_VARIABLE","$file",181],")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                ",181],["T_VARIABLE","$name",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","Mage",182],["T_DOUBLE_COLON","::",182],["T_STRING","helper",182],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/file'",182],")",["T_OBJECT_OPERATOR","->",182],["T_STRING","getFileFromPathFile",182],"(",["T_VARIABLE","$item",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getLinkFile",182],"(",")",")",";",["T_WHITESPACE","\n                ",182],["T_VARIABLE","$tmpLinkItem",183],"[",["T_CONSTANT_ENCAPSED_STRING","'file_save'",183],"]",["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_ARRAY","array",183],"(",["T_WHITESPACE","\n                    ",183],["T_ARRAY","array",184],"(",["T_WHITESPACE","\n                        ",184],["T_CONSTANT_ENCAPSED_STRING","'file'",185],["T_WHITESPACE"," ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$item",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getLinkFile",185],"(",")",",",["T_WHITESPACE","\n                        ",185],["T_CONSTANT_ENCAPSED_STRING","'name'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$name",186],",",["T_WHITESPACE","\n                        ",186],["T_CONSTANT_ENCAPSED_STRING","'size'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_STRING","filesize",187],"(",["T_VARIABLE","$file",187],")",",",["T_WHITESPACE","\n                        ",187],["T_CONSTANT_ENCAPSED_STRING","'status'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'old'",188],["T_WHITESPACE","\n                    ",188],")",")",";",["T_WHITESPACE","\n            ",189],"}",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$sampleFile",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","Mage",191],["T_DOUBLE_COLON","::",191],["T_STRING","helper",191],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/file'",191],")",["T_OBJECT_OPERATOR","->",191],["T_STRING","getFilePath",191],"(",["T_WHITESPACE","\n                ",191],["T_STRING","Mage_Downloadable_Model_Link",192],["T_DOUBLE_COLON","::",192],["T_STRING","getBaseSamplePath",192],"(",")",",",["T_WHITESPACE"," ",192],["T_VARIABLE","$item",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getSampleFile",192],"(",")",["T_WHITESPACE","\n            ",192],")",";",["T_WHITESPACE","\n            ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$item",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getSampleFile",194],"(",")",["T_WHITESPACE"," ",194],["T_BOOLEAN_AND","&&",194],["T_WHITESPACE"," ",194],["T_STRING","is_file",194],"(",["T_VARIABLE","$sampleFile",194],")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$tmpLinkItem",195],"[",["T_CONSTANT_ENCAPSED_STRING","'sample_file_save'",195],"]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_ARRAY","array",195],"(",["T_WHITESPACE","\n                    ",195],["T_ARRAY","array",196],"(",["T_WHITESPACE","\n                        ",196],["T_CONSTANT_ENCAPSED_STRING","'file'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$item",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getSampleFile",197],"(",")",",",["T_WHITESPACE","\n                        ",197],["T_CONSTANT_ENCAPSED_STRING","'name'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","helper",198],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/file'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","getFileFromPathFile",198],"(",["T_VARIABLE","$item",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getSampleFile",198],"(",")",")",",",["T_WHITESPACE","\n                        ",198],["T_CONSTANT_ENCAPSED_STRING","'size'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_STRING","filesize",199],"(",["T_VARIABLE","$sampleFile",199],")",",",["T_WHITESPACE","\n                        ",199],["T_CONSTANT_ENCAPSED_STRING","'status'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'old'",200],["T_WHITESPACE","\n                    ",200],")",")",";",["T_WHITESPACE","\n            ",201],"}",["T_WHITESPACE","\n            ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$item",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getNumberOfDownloads",203],"(",")",["T_WHITESPACE"," ",203],["T_IS_EQUAL","==",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'0'",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                ",203],["T_VARIABLE","$tmpLinkItem",204],"[",["T_CONSTANT_ENCAPSED_STRING","'is_unlimited'",204],"]",["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_LNUMBER","1",204],";",["T_WHITESPACE","\n            ",204],"}",["T_WHITESPACE","\n            ",205],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$product",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getStoreId",206],"(",")",["T_WHITESPACE"," ",206],["T_BOOLEAN_AND","&&",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$item",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getStoreTitle",206],"(",")",")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n                ",206],["T_VARIABLE","$tmpLinkItem",207],"[",["T_CONSTANT_ENCAPSED_STRING","'store_title'",207],"]",["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$item",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getStoreTitle",207],"(",")",";",["T_WHITESPACE","\n            ",207],"}",["T_WHITESPACE","\n            ",208],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$product",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getStoreId",209],"(",")",["T_WHITESPACE"," ",209],["T_BOOLEAN_AND","&&",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$downloadHelper",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getIsPriceWebsiteScope",209],"(",")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n                ",209],["T_VARIABLE","$tmpLinkItem",210],"[",["T_CONSTANT_ENCAPSED_STRING","'website_price'",210],"]",["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$item",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getWebsitePrice",210],"(",")",";",["T_WHITESPACE","\n            ",210],"}",["T_WHITESPACE","\n            ",211],["T_VARIABLE","$linkArr",212],"[","]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$tmpLinkItem",212],";",["T_WHITESPACE","\n        ",212],"}",["T_WHITESPACE","\n        ",213],["T_UNSET","unset",214],"(",["T_VARIABLE","$item",214],")",";",["T_WHITESPACE","\n        ",214],["T_UNSET","unset",215],"(",["T_VARIABLE","$tmpLinkItem",215],")",";",["T_WHITESPACE","\n        ",215],["T_UNSET","unset",216],"(",["T_VARIABLE","$links",216],")",";",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$samples",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$product",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getTypeInstance",218],"(",["T_STRING","true",218],")",["T_OBJECT_OPERATOR","->",218],["T_STRING","getSamples",218],"(",["T_VARIABLE","$product",218],")",["T_OBJECT_OPERATOR","->",218],["T_STRING","getData",218],"(",")",";",["T_WHITESPACE","\n        ",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_ARRAY","array",219],"(",["T_CONSTANT_ENCAPSED_STRING","'links'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$linkArr",219],",",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'samples'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$samples",219],")",";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n\n    ",220],["T_DOC_COMMENT","\/**\n     * Remove downloadable product link\n     * @param string $linkId\n     * @param string $resourceType\n     * @return bool\n     *\/",222],["T_WHITESPACE","\n    ",227],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","remove",228],"(",["T_VARIABLE","$linkId",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$resourceType",228],")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_TRY","try",230],["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_getValidator",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","validateType",231],"(",["T_VARIABLE","$resourceType",231],")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE"," ",232],["T_CATCH","catch",232],["T_WHITESPACE"," ",232],"(",["T_STRING","Exception",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$e",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_fault",233],"(",["T_CONSTANT_ENCAPSED_STRING","'validation_error'",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$e",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getMessage",233],"(",")",")",";",["T_WHITESPACE","\n        ",233],"}",["T_WHITESPACE","\n\n        ",234],["T_SWITCH","switch",236],"(",["T_VARIABLE","$resourceType",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_CASE","case",237],["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'link'",237],":",["T_WHITESPACE","\n                ",237],["T_VARIABLE","$downloadableModel",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_STRING","Mage",238],["T_DOUBLE_COLON","::",238],["T_STRING","getSingleton",238],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/link'",238],")",";",["T_WHITESPACE","\n                ",238],["T_BREAK","break",239],";",["T_WHITESPACE","\n            ",239],["T_CASE","case",240],["T_WHITESPACE"," ",240],["T_CONSTANT_ENCAPSED_STRING","'sample'",240],":",["T_WHITESPACE","\n                ",240],["T_VARIABLE","$downloadableModel",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","Mage",241],["T_DOUBLE_COLON","::",241],["T_STRING","getSingleton",241],"(",["T_CONSTANT_ENCAPSED_STRING","'downloadable\/sample'",241],")",";",["T_WHITESPACE","\n                ",241],["T_BREAK","break",242],";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n\n        ",243],["T_VARIABLE","$downloadableModel",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","load",245],"(",["T_VARIABLE","$linkId",245],")",";",["T_WHITESPACE","\n        ",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_STRING","is_null",246],"(",["T_VARIABLE","$downloadableModel",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getId",246],"(",")",")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_fault",247],"(",["T_CONSTANT_ENCAPSED_STRING","'link_was_not_found'",247],")",";",["T_WHITESPACE","\n        ",247],"}",["T_WHITESPACE","\n\n        ",248],["T_TRY","try",250],["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n            ",250],["T_VARIABLE","$downloadableModel",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","delete",251],"(",")",";",["T_WHITESPACE","\n        ",251],"}",["T_WHITESPACE"," ",252],["T_CATCH","catch",252],["T_WHITESPACE"," ",252],"(",["T_STRING","Exception",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$e",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_fault",253],"(",["T_CONSTANT_ENCAPSED_STRING","'remove_error'",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$e",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getMessage",253],"(",")",")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_STRING","true",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Return loaded downloadable product instance\n     *\n     * @param  int|string $productId (SKU or ID)\n     * @param  int|string $store\n     * @param  string $identifierType\n     * @return Mage_Catalog_Model_Product\n     *\/",259],["T_WHITESPACE","\n    ",266],["T_PROTECTED","protected",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","_getProduct",267],"(",["T_VARIABLE","$productId",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$store",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","null",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$identifierType",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","null",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_VARIABLE","$product",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","parent",269],["T_DOUBLE_COLON","::",269],["T_STRING","_getProduct",269],"(",["T_VARIABLE","$productId",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$store",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$identifierType",269],")",";",["T_WHITESPACE","\n\n        ",269],["T_IF","if",271],["T_WHITESPACE"," ",271],"(",["T_VARIABLE","$product",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getTypeId",271],"(",")",["T_WHITESPACE"," ",271],["T_IS_NOT_IDENTICAL","!==",271],["T_WHITESPACE"," ",271],["T_STRING","Mage_Downloadable_Model_Product_Type",271],["T_DOUBLE_COLON","::",271],["T_STRING","TYPE_DOWNLOADABLE",271],")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_fault",272],"(",["T_CONSTANT_ENCAPSED_STRING","'product_not_downloadable'",272],")",";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n\n        ",273],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$product",275],";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n",276],"}",["T_WHITESPACE","\n",277]]