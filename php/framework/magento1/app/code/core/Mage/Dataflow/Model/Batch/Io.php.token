[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Dataflow\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Dataflow batch Io model\n *\n * @category   Mage\n * @package    Mage_Dataflow\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Dataflow_Model_Batch_Io",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","TMP_DIR",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'\/var\/tmp\/'",37],";",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","TMP_NAME",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'batch_%d.tmp'",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Dataflow Batch model\n     *\n     * @var Mage_Dataflow_Model_Batch\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_batchModel",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Full path to tmp dir\n     *\n     * @var string\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_path",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Filename\n     *\n     * @var string\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_filename",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Varien IO File class\n     *\n     * @var Varien_Io_File\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_ioFile",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * size of file\n     *\n     * @var int\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$_fileSize",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_LNUMBER","0",73],";",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Init model (required)\n     *\n     * @param Mage_Dataflow_Model_Batch $object\n     * @return Mage_Dataflow_Model_Batch_Io\n     *\/",75],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","init",81],"(",["T_STRING","Mage_Dataflow_Model_Batch",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$object",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_batchModel",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$object",83],";",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Retrieve real path to tmp dir\n     *\n     * @return string\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","getPath",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","is_null",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_path",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_path",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getIoAdapter",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getCleanPath",95],"(",["T_STRING","Mage",95],["T_DOUBLE_COLON","::",95],["T_STRING","getBaseDir",95],"(",["T_CONSTANT_ENCAPSED_STRING","'tmp'",95],")",")",";",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getIoAdapter",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","checkAndCreateFolder",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_path",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_path",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Retrieve tmp filename\n     *\n     * @return string\n     *\/",101],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","getFile",106],"(",["T_VARIABLE","$withPath",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","false",106],")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_STRING","is_null",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_filename",108],")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_filename",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","sprintf",109],"(",["T_STRING","self",109],["T_DOUBLE_COLON","::",109],["T_STRING","TMP_NAME",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_batchModel",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getId",109],"(",")",")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$withPath",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getPath",112],"(",")",["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_filename",112],";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n        ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_filename",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Retrieve Io File Adapter\n     *\n     * @return Varien_Io_File\n     *\/",117],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","getIoAdapter",122],"(",")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_STRING","is_null",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_ioFile",124],")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_ioFile",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_NEW","new",125],["T_WHITESPACE"," ",125],["T_STRING","Varien_Io_File",125],"(",")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n        ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_ioFile",127],";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_DOC_COMMENT","\/**\n     * Open file in stream mode\n     *\n     * @return Mage_Dataflow_Model_Batch_Io\n     *\/",130],["T_WHITESPACE","\n    ",134],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","open",135],"(",["T_VARIABLE","$write",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING","true",135],")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$mode",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$write",137],["T_WHITESPACE"," ",137],"?",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'w+'",137],["T_WHITESPACE"," ",137],":",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'r+'",137],";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$ioConfig",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",["T_WHITESPACE","\n            ",138],["T_CONSTANT_ENCAPSED_STRING","'path'",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getPath",139],"(",")",["T_WHITESPACE","\n        ",139],")",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getIoAdapter",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","setAllowCreateFolders",141],"(",["T_STRING","true",141],")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getIoAdapter",142],"(",")",["T_OBJECT_OPERATOR","->",142],["T_STRING","open",142],"(",["T_VARIABLE","$ioConfig",142],")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getIoAdapter",143],"(",")",["T_OBJECT_OPERATOR","->",143],["T_STRING","streamOpen",143],"(",["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getFile",143],"(",")",",",["T_WHITESPACE"," ",143],["T_VARIABLE","$mode",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_fileSize",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_LNUMBER","0",145],";",["T_WHITESPACE","\n\n        ",145],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Write string\n     *\n     * @param string $string\n     * @return bool\n     *\/",150],["T_WHITESPACE","\n    ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","write",156],"(",["T_VARIABLE","$string",156],")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_fileSize",158],["T_WHITESPACE"," ",158],["T_PLUS_EQUAL","+=",158],["T_WHITESPACE"," ",158],["T_STRING","strlen",158],"(",["T_VARIABLE","$string",158],")",";",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getIoAdapter",159],"(",")",["T_OBJECT_OPERATOR","->",159],["T_STRING","streamWrite",159],"(",["T_VARIABLE","$string",159],")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Read up to 1K bytes from the file pointer\n     * Reading stops as soon as one of the following conditions is met:\n     * # length  bytes have been read\n     * # EOF (end of file) is reached\n     *\n     * @return string|array\n     *\/",162],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","read",170],"(",["T_VARIABLE","$csv",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","false",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$delimiter",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","','",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$enclosure",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'\"'",170],")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$csv",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$content",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getIoAdapter",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","streamReadCsv",173],"(",["T_VARIABLE","$delimiter",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$enclosure",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n        ",174],["T_ELSE","else",175],["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$content",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getIoAdapter",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","streamRead",176],"(",["T_LNUMBER","1024",176],")",";",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_fileSize",177],["T_WHITESPACE"," ",177],["T_PLUS_EQUAL","+=",177],["T_WHITESPACE"," ",177],["T_STRING","strlen",177],"(",["T_VARIABLE","$content",177],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$content",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Close file\n     *\n     * @return bool\n     *\/",182],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","close",187],"(",")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getIoAdapter",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","streamClose",189],"(",")",";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_PUBLIC","public",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","clear",192],"(",")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_RETURN","return",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getIoAdapter",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","rm",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getFile",194],"(",["T_STRING","true",194],")",")",";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Get writed file size\n     *\n     * @return unknown\n     *\/",197],["T_WHITESPACE","\n    ",201],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","getFileSize",202],"(",")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_fileSize",204],";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n",205],"}",["T_WHITESPACE","\n",206]]