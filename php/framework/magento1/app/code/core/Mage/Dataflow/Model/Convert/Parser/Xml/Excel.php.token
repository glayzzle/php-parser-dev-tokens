[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Dataflow\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Convert excel xml parser\n *\n * @category   Mage\n * @package    Mage_Dataflow\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Dataflow_Model_Convert_Parser_Xml_Excel",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Dataflow_Model_Convert_Parser_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Simple Xml object\n     *\n     * @var SimpleXMLElement\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_xmlElement",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Field list\n     *\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_parseFieldNames",49],";",["T_WHITESPACE","\n\n    ",49],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","parse",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$adapterName",53],["T_WHITESPACE","   ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getVar",53],"(",["T_CONSTANT_ENCAPSED_STRING","'adapter'",53],",",["T_WHITESPACE"," ",53],["T_STRING","null",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$adapterMethod",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getVar",54],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'saveRow'",54],")",";",["T_WHITESPACE","\n\n        ",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(","!",["T_VARIABLE","$adapterName",56],["T_WHITESPACE"," ",56],["T_BOOLEAN_OR","||",56],["T_WHITESPACE"," ",56],"!",["T_VARIABLE","$adapterMethod",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$message",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","Mage",57],["T_DOUBLE_COLON","::",57],["T_STRING","helper",57],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow'",57],")",["T_OBJECT_OPERATOR","->",57],["T_STRING","__",57],"(",["T_CONSTANT_ENCAPSED_STRING","'Please declare \"adapter\" and \"method\" nodes first.'",57],")",";",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","addException",58],"(",["T_VARIABLE","$message",58],",",["T_WHITESPACE"," ",58],["T_STRING","Mage_Dataflow_Model_Convert_Exception",58],["T_DOUBLE_COLON","::",58],["T_STRING","FATAL",58],")",";",["T_WHITESPACE","\n            ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n\n        ",60],["T_TRY","try",62],["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$adapter",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","Mage",63],["T_DOUBLE_COLON","::",63],["T_STRING","getModel",63],"(",["T_VARIABLE","$adapterName",63],")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n        ",64],["T_CATCH","catch",65],["T_WHITESPACE"," ",65],"(",["T_STRING","Exception",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$e",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$message",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Mage",66],["T_DOUBLE_COLON","::",66],["T_STRING","helper",66],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow'",66],")",["T_OBJECT_OPERATOR","->",66],["T_STRING","__",66],"(",["T_CONSTANT_ENCAPSED_STRING","'Declared adapter %s was not found.'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$adapterName",66],")",";",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","addException",67],"(",["T_VARIABLE","$message",67],",",["T_WHITESPACE"," ",67],["T_STRING","Mage_Dataflow_Model_Convert_Exception",67],["T_DOUBLE_COLON","::",67],["T_STRING","FATAL",67],")",";",["T_WHITESPACE","\n            ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n\n        ",69],["T_IF","if",71],["T_WHITESPACE"," ",71],"(","!",["T_STRING","method_exists",71],"(",["T_VARIABLE","$adapter",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$adapterMethod",71],")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$message",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","helper",72],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow'",72],")",["T_OBJECT_OPERATOR","->",72],["T_STRING","__",72],"(",["T_CONSTANT_ENCAPSED_STRING","'Method \"%s\" was not defined in adapter %s.'",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$adapterMethod",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$adapterName",72],")",";",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","addException",73],"(",["T_VARIABLE","$message",73],",",["T_WHITESPACE"," ",73],["T_STRING","Mage_Dataflow_Model_Convert_Exception",73],["T_DOUBLE_COLON","::",73],["T_STRING","FATAL",73],")",";",["T_WHITESPACE","\n            ",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n\n        ",75],["T_VARIABLE","$batchModel",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getBatchModel",77],"(",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$batchIoAdapter",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getBatchModel",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","getIoAdapter",78],"(",")",";",["T_WHITESPACE","\n\n        ",78],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","app",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","getRequest",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","getParam",80],"(",["T_CONSTANT_ENCAPSED_STRING","'files'",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$file",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","Mage",81],["T_DOUBLE_COLON","::",81],["T_STRING","app",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","getConfig",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","getTempVarDir",81],"(",")",".",["T_CONSTANT_ENCAPSED_STRING","'\/import\/'",81],["T_WHITESPACE","\n                ",81],".",["T_WHITESPACE"," ",82],["T_STRING","urldecode",82],"(",["T_STRING","Mage",82],["T_DOUBLE_COLON","::",82],["T_STRING","app",82],"(",")",["T_OBJECT_OPERATOR","->",82],["T_STRING","getRequest",82],"(",")",["T_OBJECT_OPERATOR","->",82],["T_STRING","getParam",82],"(",["T_CONSTANT_ENCAPSED_STRING","'files'",82],")",")",";",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_copy",83],"(",["T_VARIABLE","$file",83],")",";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$batchIoAdapter",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","open",86],"(",["T_STRING","false",86],")",";",["T_WHITESPACE","\n\n        ",86],["T_VARIABLE","$isFieldNames",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getVar",88],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","''",88],")",["T_WHITESPACE"," ",88],["T_IS_EQUAL","==",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'true'",88],["T_WHITESPACE"," ",88],"?",["T_WHITESPACE"," ",88],["T_STRING","true",88],["T_WHITESPACE"," ",88],":",["T_WHITESPACE"," ",88],["T_STRING","false",88],";",["T_WHITESPACE","\n        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(","!",["T_VARIABLE","$isFieldNames",89],["T_WHITESPACE"," ",89],["T_BOOLEAN_AND","&&",89],["T_WHITESPACE"," ",89],["T_STRING","is_array",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getVar",89],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",89],")",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_parseFieldNames",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getVar",90],"(",["T_CONSTANT_ENCAPSED_STRING","'map'",90],")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$worksheet",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getVar",93],"(",["T_CONSTANT_ENCAPSED_STRING","'single_sheet'",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","''",93],")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$xmlString",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$xmlRowString",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","''",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$countRows",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_LNUMBER","0",96],";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$isWorksheet",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$isRow",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","false",97],";",["T_WHITESPACE","\n        ",97],["T_WHILE","while",98],["T_WHITESPACE"," ",98],"(","(",["T_VARIABLE","$xmlOriginalString",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$batchIoAdapter",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","read",98],"(",")",")",["T_WHITESPACE"," ",98],["T_IS_NOT_IDENTICAL","!==",98],["T_WHITESPACE"," ",98],["T_STRING","false",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$xmlString",99],["T_WHITESPACE"," ",99],["T_CONCAT_EQUAL",".=",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$xmlOriginalString",99],";",["T_WHITESPACE","\n            ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","!",["T_VARIABLE","$isWorksheet",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$strposS",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_STRING","strpos",101],"(",["T_VARIABLE","$xmlString",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'<Worksheet'",101],")",";",["T_WHITESPACE","\n                ",101],["T_VARIABLE","$substrL",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_LNUMBER","10",102],";",["T_WHITESPACE","\n                ",102],["T_COMMENT","\/\/fix for OpenOffice\n",103],["T_WHITESPACE","                ",104],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$strposS",104],["T_WHITESPACE"," ",104],["T_IS_IDENTICAL","===",104],["T_WHITESPACE"," ",104],["T_STRING","false",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                    ",104],["T_VARIABLE","$strposS",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","strpos",105],"(",["T_VARIABLE","$xmlString",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'<ss:Worksheet'",105],")",";",["T_WHITESPACE","\n                    ",105],["T_VARIABLE","$substrL",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_LNUMBER","13",106],";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE","\n                ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$strposS",108],["T_WHITESPACE"," ",108],["T_IS_IDENTICAL","===",108],["T_WHITESPACE"," ",108],["T_STRING","false",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                    ",108],["T_VARIABLE","$xmlString",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","substr",109],"(",["T_VARIABLE","$xmlString",109],",",["T_WHITESPACE"," ",109],"-",["T_LNUMBER","13",109],")",";",["T_WHITESPACE","\n                    ",109],["T_CONTINUE","continue",110],";",["T_WHITESPACE","\n                ",110],"}",["T_WHITESPACE","\n\n                ",111],["T_VARIABLE","$xmlTmpString",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","substr",113],"(",["T_VARIABLE","$xmlString",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$strposS",113],")",";",["T_WHITESPACE","\n                ",113],["T_VARIABLE","$strposF",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","strpos",114],"(",["T_VARIABLE","$xmlTmpString",114],",",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'>'",114],")",";",["T_WHITESPACE","\n\n                ",114],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$strposF",116],["T_WHITESPACE"," ",116],["T_IS_IDENTICAL","===",116],["T_WHITESPACE"," ",116],["T_STRING","false",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                    ",116],["T_VARIABLE","$xmlString",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$xmlTmpString",117],";",["T_WHITESPACE","\n                    ",117],["T_CONTINUE","continue",118],";",["T_WHITESPACE","\n                ",118],"}",["T_WHITESPACE","\n\n                ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$worksheet",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$xmlString",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_STRING","substr",122],"(",["T_VARIABLE","$xmlTmpString",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$strposF",122],")",";",["T_WHITESPACE","\n                    ",122],["T_VARIABLE","$isWorksheet",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","true",123],";",["T_WHITESPACE","\n                    ",123],["T_CONTINUE","continue",124],";",["T_WHITESPACE","\n                ",124],"}",["T_WHITESPACE","\n                ",125],["T_ELSE","else",126],["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n                    ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_STRING","preg_match",127],"(",["T_CONSTANT_ENCAPSED_STRING","'\/ss:Name=\\\"'",127],".",["T_STRING","preg_quote",127],"(",["T_VARIABLE","$worksheet",127],")",".",["T_CONSTANT_ENCAPSED_STRING","'\\\"\/siU'",127],",",["T_WHITESPACE"," ",127],["T_STRING","substr",127],"(",["T_VARIABLE","$xmlTmpString",127],",",["T_WHITESPACE"," ",127],["T_LNUMBER","0",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$strposF",127],")",")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                        ",127],["T_VARIABLE","$xmlString",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","substr",128],"(",["T_VARIABLE","$xmlTmpString",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$strposF",128],")",";",["T_WHITESPACE","\n                        ",128],["T_VARIABLE","$isWorksheet",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","true",129],";",["T_WHITESPACE","\n                        ",129],["T_CONTINUE","continue",130],";",["T_WHITESPACE","\n                    ",130],"}",["T_WHITESPACE","\n                    ",131],["T_ELSE","else",132],["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                        ",132],["T_VARIABLE","$xmlString",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","''",133],";",["T_WHITESPACE","\n                        ",133],["T_CONTINUE","continue",134],";",["T_WHITESPACE","\n                    ",134],"}",["T_WHITESPACE","\n                ",135],"}",["T_WHITESPACE","\n            ",136],"}",["T_WHITESPACE","\n            ",137],["T_ELSE","else",138],["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$xmlString",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_parseXmlRow",139],"(",["T_VARIABLE","$xmlString",139],")",";",["T_WHITESPACE","\n\n                ",139],["T_VARIABLE","$strposS",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","strpos",141],"(",["T_VARIABLE","$xmlString",141],",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'<\/Worksheet>'",141],")",";",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$substrL",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_LNUMBER","12",142],";",["T_WHITESPACE","\n                ",142],["T_COMMENT","\/\/fix for OpenOffice\n",143],["T_WHITESPACE","                ",144],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$strposS",144],["T_WHITESPACE"," ",144],["T_IS_IDENTICAL","===",144],["T_WHITESPACE"," ",144],["T_STRING","false",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                    ",144],["T_VARIABLE","$strposS",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","strpos",145],"(",["T_VARIABLE","$xmlString",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'<\/ss:Worksheet>'",145],")",";",["T_WHITESPACE","\n                    ",145],["T_VARIABLE","$substrL",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_LNUMBER","15",146],";",["T_WHITESPACE","\n                ",146],"}",["T_WHITESPACE","\n                ",147],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$strposS",148],["T_WHITESPACE"," ",148],["T_IS_NOT_IDENTICAL","!==",148],["T_WHITESPACE"," ",148],["T_STRING","false",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n                    ",148],["T_VARIABLE","$xmlString",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","substr",149],"(",["T_VARIABLE","$xmlString",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$strposS",149],["T_WHITESPACE"," ",149],"+",["T_WHITESPACE"," ",149],["T_VARIABLE","$substrL",149],")",";",["T_WHITESPACE","\n                    ",149],["T_VARIABLE","$isWorksheet",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","false",150],";",["T_WHITESPACE","\n\n                    ",150],["T_CONTINUE","continue",152],";",["T_WHITESPACE","\n                ",152],"}",["T_WHITESPACE","\n            ",153],"}",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n\n        ",155],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","addException",157],"(",["T_STRING","Mage",157],["T_DOUBLE_COLON","::",157],["T_STRING","helper",157],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow'",157],")",["T_OBJECT_OPERATOR","->",157],["T_STRING","__",157],"(",["T_CONSTANT_ENCAPSED_STRING","'Found %d rows.'",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_countRows",157],")",")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","addException",158],"(",["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","helper",158],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow'",158],")",["T_OBJECT_OPERATOR","->",158],["T_STRING","__",158],"(",["T_CONSTANT_ENCAPSED_STRING","'Starting %s :: %s'",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$adapterName",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$adapterMethod",158],")",")",";",["T_WHITESPACE","\n\n        ",158],["T_VARIABLE","$batchModel",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","setParams",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getVars",160],"(",")",")",["T_WHITESPACE","\n            ",160],["T_OBJECT_OPERATOR","->",161],["T_STRING","setAdapter",161],"(",["T_VARIABLE","$adapterName",161],")",["T_WHITESPACE","\n            ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","save",162],"(",")",";",["T_WHITESPACE","\n\n",162],["T_COMMENT","\/\/        $adapter->$adapterMethod();\n",164],["T_WHITESPACE","\n        ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],";",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$dom",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_NEW","new",168],["T_WHITESPACE"," ",168],["T_STRING","DOMDocument",168],"(",")",";",["T_WHITESPACE","\n",168],["T_COMMENT","\/\/        $dom->loadXML($this->getData());\n",169],["T_WHITESPACE","        ",170],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_STRING","Mage",170],["T_DOUBLE_COLON","::",170],["T_STRING","app",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getRequest",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getParam",170],"(",["T_CONSTANT_ENCAPSED_STRING","'files'",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$path",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_STRING","Mage",171],["T_DOUBLE_COLON","::",171],["T_STRING","app",171],"(",")",["T_OBJECT_OPERATOR","->",171],["T_STRING","getConfig",171],"(",")",["T_OBJECT_OPERATOR","->",171],["T_STRING","getTempVarDir",171],"(",")",".",["T_CONSTANT_ENCAPSED_STRING","'\/import\/'",171],";",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$file",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$path",172],".",["T_STRING","urldecode",172],"(",["T_STRING","Mage",172],["T_DOUBLE_COLON","::",172],["T_STRING","app",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getRequest",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getParam",172],"(",["T_CONSTANT_ENCAPSED_STRING","'files'",172],")",")",";",["T_WHITESPACE","\n            ",172],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_STRING","file_exists",173],"(",["T_VARIABLE","$file",173],")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                ",173],["T_VARIABLE","$dom",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","load",174],"(",["T_VARIABLE","$file",174],")",";",["T_WHITESPACE","\n            ",174],"}",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE"," ",176],["T_ELSE","else",176],["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n\n            ",176],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","validateDataString",178],"(",")",";",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$dom",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","loadXML",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getData",179],"(",")",")",";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE","\n\n        ",180],["T_VARIABLE","$worksheets",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$dom",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getElementsByTagName",182],"(",["T_CONSTANT_ENCAPSED_STRING","'Worksheet'",182],")",";",["T_WHITESPACE","\n        ",182],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getVar",183],"(",["T_CONSTANT_ENCAPSED_STRING","'adapter'",183],")",["T_WHITESPACE"," ",183],["T_BOOLEAN_AND","&&",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getVar",183],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",183],")",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$adapter",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_STRING","Mage",184],["T_DOUBLE_COLON","::",184],["T_STRING","getModel",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getVar",184],"(",["T_CONSTANT_ENCAPSED_STRING","'adapter'",184],")",")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n        ",185],["T_FOREACH","foreach",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$worksheets",186],["T_WHITESPACE"," ",186],["T_AS","as",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$worksheet",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$wsName",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$worksheet",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getAttribute",187],"(",["T_CONSTANT_ENCAPSED_STRING","'ss:Name'",187],")",";",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$rows",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$worksheet",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getElementsByTagName",188],"(",["T_CONSTANT_ENCAPSED_STRING","'Row'",188],")",";",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$firstRow",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","true",189],";",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$fieldNames",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_ARRAY","array",190],"(",")",";",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$wsData",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",")",";",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$i",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_LNUMBER","0",192],";",["T_WHITESPACE","\n            ",192],["T_FOREACH","foreach",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$rows",193],["T_WHITESPACE"," ",193],["T_AS","as",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$rowSet",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n                ",193],["T_VARIABLE","$index",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_LNUMBER","1",194],";",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$cells",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$rowSet",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getElementsByTagName",195],"(",["T_CONSTANT_ENCAPSED_STRING","'Cell'",195],")",";",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$rowData",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",")",";",["T_WHITESPACE","\n                ",196],["T_FOREACH","foreach",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$cells",197],["T_WHITESPACE"," ",197],["T_AS","as",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$cell",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                    ",197],["T_VARIABLE","$value",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$cell",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getElementsByTagName",198],"(",["T_CONSTANT_ENCAPSED_STRING","'Data'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","item",198],"(",["T_LNUMBER","0",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","nodeValue",198],";",["T_WHITESPACE","\n                    ",198],["T_VARIABLE","$ind",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$cell",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getAttribute",199],"(",["T_CONSTANT_ENCAPSED_STRING","'ss:Index'",199],")",";",["T_WHITESPACE","\n                    ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(","!",["T_STRING","is_null",200],"(",["T_VARIABLE","$ind",200],")",["T_WHITESPACE"," ",200],["T_BOOLEAN_AND","&&",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$ind",200],">",["T_LNUMBER","0",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                        ",200],["T_VARIABLE","$index",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$ind",201],";",["T_WHITESPACE","\n                    ",201],"}",["T_WHITESPACE","\n                    ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$firstRow",203],["T_WHITESPACE"," ",203],["T_BOOLEAN_AND","&&",203],["T_WHITESPACE"," ",203],"!",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getVar",203],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",203],")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                        ",203],["T_VARIABLE","$fieldNames",204],"[",["T_VARIABLE","$index",204],"]",["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'column'",204],".",["T_VARIABLE","$index",204],";",["T_WHITESPACE","\n                    ",204],"}",["T_WHITESPACE","\n                    ",205],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$firstRow",206],["T_WHITESPACE"," ",206],["T_BOOLEAN_AND","&&",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getVar",206],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",206],")",")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n                        ",206],["T_VARIABLE","$fieldNames",207],"[",["T_VARIABLE","$index",207],"]",["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$value",207],";",["T_WHITESPACE","\n                    ",207],"}",["T_WHITESPACE"," ",208],["T_ELSE","else",208],["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n                        ",208],["T_VARIABLE","$rowData",209],"[",["T_VARIABLE","$fieldNames",209],"[",["T_VARIABLE","$index",209],"]","]",["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$value",209],";",["T_WHITESPACE","\n                    ",209],"}",["T_WHITESPACE","\n                    ",210],["T_VARIABLE","$index",211],["T_INC","++",211],";",["T_WHITESPACE","\n                ",211],"}",["T_WHITESPACE","\n                ",212],["T_VARIABLE","$row",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$rowData",213],";",["T_WHITESPACE","\n                ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$row",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n                    ",214],["T_VARIABLE","$loadMethod",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getVar",215],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",215],")",";",["T_WHITESPACE","\n                    ",215],["T_VARIABLE","$adapter",216],["T_OBJECT_OPERATOR","->",216],["T_VARIABLE","$loadMethod",216],"(",["T_STRING","compact",216],"(",["T_CONSTANT_ENCAPSED_STRING","'i'",216],",",["T_WHITESPACE"," ",216],["T_CONSTANT_ENCAPSED_STRING","'row'",216],")",")",";",["T_WHITESPACE","\n                ",216],"}",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$i",218],["T_INC","++",218],";",["T_WHITESPACE","\n\n                ",218],["T_VARIABLE","$firstRow",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","false",220],";",["T_WHITESPACE","\n                ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(","!",["T_EMPTY","empty",221],"(",["T_VARIABLE","$rowData",221],")",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n                    ",221],["T_VARIABLE","$wsData",222],"[","]",["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$rowData",222],";",["T_WHITESPACE","\n                ",222],"}",["T_WHITESPACE","\n            ",223],"}",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$data",225],"[",["T_VARIABLE","$wsName",225],"]",["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$wsData",225],";",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","addException",226],"(",["T_CONSTANT_ENCAPSED_STRING","'Found worksheet \"'",226],".",["T_VARIABLE","$wsName",226],".",["T_CONSTANT_ENCAPSED_STRING","'\" with '",226],".",["T_STRING","sizeof",226],"(",["T_VARIABLE","$wsData",226],")",".",["T_CONSTANT_ENCAPSED_STRING","' row(s)'",226],")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n        ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$wsName",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getVar",228],"(",["T_CONSTANT_ENCAPSED_STRING","'single_sheet'",228],")",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_ISSET","isset",229],"(",["T_VARIABLE","$data",229],"[",["T_VARIABLE","$wsName",229],"]",")",")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n                ",229],["T_VARIABLE","$data",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_VARIABLE","$data",230],"[",["T_VARIABLE","$wsName",230],"]",";",["T_WHITESPACE","\n            ",230],"}",["T_WHITESPACE"," ",231],["T_ELSE","else",231],["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n                ",231],["T_STRING","reset",232],"(",["T_VARIABLE","$data",232],")",";",["T_WHITESPACE","\n                ",232],["T_VARIABLE","$data",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","current",233],"(",["T_VARIABLE","$data",233],")",";",["T_WHITESPACE","\n            ",233],"}",["T_WHITESPACE","\n        ",234],"}",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","setData",236],"(",["T_VARIABLE","$data",236],")",";",["T_WHITESPACE","\n        ",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],";",["T_WHITESPACE","\n    ",237],"}",["T_WHITESPACE","\n\n    ",238],["T_DOC_COMMENT","\/**\n     * Parse MS Excel XML string\n     *\n     * @param string $xmlString\n     * @return string\n     *\/",240],["T_WHITESPACE","\n    ",245],["T_PROTECTED","protected",246],["T_WHITESPACE"," ",246],["T_FUNCTION","function",246],["T_WHITESPACE"," ",246],["T_STRING","_parseXmlRow",246],"(",["T_VARIABLE","$xmlString",246],")",["T_WHITESPACE","\n    ",246],"{",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$found",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","true",248],";",["T_WHITESPACE","\n        ",248],["T_WHILE","while",249],["T_WHITESPACE"," ",249],"(",["T_VARIABLE","$found",249],["T_WHITESPACE"," ",249],["T_IS_IDENTICAL","===",249],["T_WHITESPACE"," ",249],["T_STRING","true",249],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n            ",249],["T_VARIABLE","$strposS",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","strpos",250],"(",["T_VARIABLE","$xmlString",250],",",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'<Row'",250],")",";",["T_WHITESPACE","\n\n            ",250],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$strposS",252],["T_WHITESPACE"," ",252],["T_IS_IDENTICAL","===",252],["T_WHITESPACE"," ",252],["T_STRING","false",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                ",252],["T_VARIABLE","$found",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_STRING","false",253],";",["T_WHITESPACE","\n                ",253],["T_CONTINUE","continue",254],";",["T_WHITESPACE","\n            ",254],"}",["T_WHITESPACE","\n\n            ",255],["T_VARIABLE","$xmlTmpString",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_STRING","substr",257],"(",["T_VARIABLE","$xmlString",257],",",["T_WHITESPACE"," ",257],["T_VARIABLE","$strposS",257],")",";",["T_WHITESPACE","\n            ",257],["T_VARIABLE","$strposF",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_STRING","strpos",258],"(",["T_VARIABLE","$xmlTmpString",258],",",["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'<\/Row>'",258],")",";",["T_WHITESPACE","\n\n            ",258],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$strposF",260],["T_WHITESPACE"," ",260],["T_IS_NOT_IDENTICAL","!==",260],["T_WHITESPACE"," ",260],["T_STRING","false",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n                ",260],["T_VARIABLE","$xmlRowString",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","substr",261],"(",["T_VARIABLE","$xmlTmpString",261],",",["T_WHITESPACE"," ",261],["T_LNUMBER","0",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$strposF",261],["T_WHITESPACE"," ",261],"+",["T_WHITESPACE"," ",261],["T_LNUMBER","6",261],")",";",["T_WHITESPACE","\n\n                ",261],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_saveParsedRow",263],"(",["T_VARIABLE","$xmlRowString",263],")",";",["T_WHITESPACE","\n\n                ",263],["T_VARIABLE","$xmlString",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_STRING","substr",265],"(",["T_VARIABLE","$xmlTmpString",265],",",["T_WHITESPACE"," ",265],["T_VARIABLE","$strposF",265],["T_WHITESPACE"," ",265],"+",["T_WHITESPACE"," ",265],["T_LNUMBER","6",265],")",";",["T_WHITESPACE","\n            ",265],"}",["T_WHITESPACE","\n            ",266],["T_ELSE","else",267],["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n                ",267],["T_VARIABLE","$found",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","false",268],";",["T_WHITESPACE","\n                ",268],["T_CONTINUE","continue",269],";",["T_WHITESPACE","\n            ",269],"}",["T_WHITESPACE","\n        ",270],"}",["T_WHITESPACE","\n\n        ",271],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$xmlString",273],";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_PROTECTED","protected",276],["T_WHITESPACE"," ",276],["T_FUNCTION","function",276],["T_WHITESPACE"," ",276],["T_STRING","_saveParsedRow",276],"(",["T_VARIABLE","$xmlString",276],")",["T_WHITESPACE","\n    ",276],"{",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$xml",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'<'",278],".",["T_CONSTANT_ENCAPSED_STRING","'?xml version=\"1.0\"?'",278],".",["T_CONSTANT_ENCAPSED_STRING","'><'",278],".",["T_CONSTANT_ENCAPSED_STRING","'?mso-application progid=\"Excel.Sheet\"?'",278],["T_WHITESPACE","\n            ",278],".",["T_CONSTANT_ENCAPSED_STRING","'><Workbook'",279],["T_WHITESPACE","\n            ",279],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"'",280],["T_WHITESPACE","\n            ",280],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\"'",281],["T_WHITESPACE","\n            ",281],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:x=\"urn:schemas-microsoft-com:office:excel\"'",282],["T_WHITESPACE","\n            ",282],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:x2=\"http:\/\/schemas.microsoft.com\/office\/excel\/2003\/xml\"'",283],["T_WHITESPACE","\n            ",283],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"'",284],["T_WHITESPACE","\n            ",284],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:o=\"urn:schemas-microsoft-com:office:office\"'",285],["T_WHITESPACE","\n            ",285],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:html=\"http:\/\/www.w3.org\/TR\/REC-html40\"'",286],["T_WHITESPACE","\n            ",286],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:c=\"urn:schemas-microsoft-com:office:component:spreadsheet\">'",287],["T_WHITESPACE","\n            ",287],".",["T_WHITESPACE"," ",288],["T_VARIABLE","$xmlString",288],["T_WHITESPACE","\n            ",288],".",["T_CONSTANT_ENCAPSED_STRING","'<\/Workbook>'",289],";",["T_WHITESPACE","\n\n        ",289],["T_TRY","try",291],["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n            ",291],["T_VARIABLE","$xmlElement",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_NEW","new",292],["T_WHITESPACE"," ",292],["T_STRING","SimpleXMLElement",292],"(",["T_VARIABLE","$xml",292],")",";",["T_WHITESPACE","\n        ",292],"}",["T_WHITESPACE","\n        ",293],["T_CATCH","catch",294],["T_WHITESPACE"," ",294],"(",["T_STRING","Exception",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$e",294],")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_VARIABLE","$message",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","'Invalid XML row'",295],";",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","addException",296],"(",["T_VARIABLE","$message",296],",",["T_WHITESPACE"," ",296],["T_STRING","Mage_Dataflow_Model_Convert_Exception",296],["T_DOUBLE_COLON","::",296],["T_STRING","ERROR",296],")",";",["T_WHITESPACE","\n            ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],";",["T_WHITESPACE","\n        ",297],"}",["T_WHITESPACE","\n\n        ",298],["T_VARIABLE","$xmlData",300],["T_WHITESPACE","  ",300],"=",["T_WHITESPACE"," ",300],["T_ARRAY","array",300],"(",")",";",["T_WHITESPACE","\n        ",300],["T_VARIABLE","$itemData",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_ARRAY","array",301],"(",")",";",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$cellIndex",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_LNUMBER","0",302],";",["T_WHITESPACE","\n        ",302],["T_FOREACH","foreach",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$xmlElement",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","Row",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","children",303],"(",")",["T_WHITESPACE"," ",303],["T_AS","as",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$cell",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_IF","if",304],["T_WHITESPACE"," ",304],"(",["T_STRING","is_null",304],"(",["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_parseFieldNames",304],")",")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n                ",304],["T_VARIABLE","$xmlData",305],"[",["T_STRING_CAST","(string)",305],["T_VARIABLE","$cell",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","Data",305],"]",["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_STRING_CAST","(string)",305],["T_VARIABLE","$cell",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","Data",305],";",["T_WHITESPACE","\n            ",305],"}",["T_WHITESPACE"," ",306],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                ",306],["T_VARIABLE","$attributes",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$cell",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","attributes",307],"(",["T_CONSTANT_ENCAPSED_STRING","'urn:schemas-microsoft-com:office:spreadsheet'",307],")",";",["T_WHITESPACE","\n                ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$attributes",308],["T_WHITESPACE"," ",308],["T_BOOLEAN_AND","&&",308],["T_WHITESPACE"," ",308],["T_ISSET","isset",308],"(",["T_VARIABLE","$attributes",308],"[",["T_CONSTANT_ENCAPSED_STRING","'Index'",308],"]",")",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n                    ",308],["T_VARIABLE","$cellIndex",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$attributes",309],"[",["T_CONSTANT_ENCAPSED_STRING","'Index'",309],"]",["T_WHITESPACE"," ",309],"-",["T_WHITESPACE"," ",309],["T_LNUMBER","1",309],";",["T_WHITESPACE","\n                ",309],"}",["T_WHITESPACE","\n                ",310],["T_VARIABLE","$xmlData",311],"[",["T_VARIABLE","$cellIndex",311],"]",["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_STRING_CAST","(string)",311],["T_VARIABLE","$cell",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","Data",311],";",["T_WHITESPACE","\n                ",311],["T_VARIABLE","$cellIndex",312],["T_WHITESPACE"," ",312],["T_INC","++",312],";",["T_WHITESPACE","\n            ",312],"}",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n\n        ",314],["T_IF","if",316],["T_WHITESPACE"," ",316],"(",["T_STRING","is_null",316],"(",["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_parseFieldNames",316],")",")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n            ",316],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","_parseFieldNames",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_VARIABLE","$xmlData",317],";",["T_WHITESPACE","\n            ",317],["T_RETURN","return",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],";",["T_WHITESPACE","\n        ",318],"}",["T_WHITESPACE","\n\n        ",319],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_countRows",321],["T_WHITESPACE"," ",321],["T_INC","++",321],";",["T_WHITESPACE","\n\n        ",321],["T_VARIABLE","$i",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_LNUMBER","0",323],";",["T_WHITESPACE","\n        ",323],["T_FOREACH","foreach",324],["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_parseFieldNames",324],["T_WHITESPACE"," ",324],["T_AS","as",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$field",324],")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_VARIABLE","$itemData",325],"[",["T_VARIABLE","$field",325],"]",["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_ISSET","isset",325],"(",["T_VARIABLE","$xmlData",325],"[",["T_VARIABLE","$i",325],"]",")",["T_WHITESPACE"," ",325],"?",["T_WHITESPACE"," ",325],["T_VARIABLE","$xmlData",325],"[",["T_VARIABLE","$i",325],"]",["T_WHITESPACE"," ",325],":",["T_WHITESPACE"," ",325],["T_STRING","null",325],";",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$i",326],["T_WHITESPACE"," ",326],["T_INC","++",326],";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n\n        ",327],["T_VARIABLE","$batchImportModel",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","getBatchImportModel",329],"(",")",["T_WHITESPACE","\n            ",329],["T_OBJECT_OPERATOR","->",330],["T_STRING","setId",330],"(",["T_STRING","null",330],")",["T_WHITESPACE","\n            ",330],["T_OBJECT_OPERATOR","->",331],["T_STRING","setBatchId",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getBatchModel",331],"(",")",["T_OBJECT_OPERATOR","->",331],["T_STRING","getId",331],"(",")",")",["T_WHITESPACE","\n            ",331],["T_OBJECT_OPERATOR","->",332],["T_STRING","setBatchData",332],"(",["T_VARIABLE","$itemData",332],")",["T_WHITESPACE","\n            ",332],["T_OBJECT_OPERATOR","->",333],["T_STRING","setStatus",333],"(",["T_LNUMBER","1",333],")",["T_WHITESPACE","\n            ",333],["T_OBJECT_OPERATOR","->",334],["T_STRING","save",334],"(",")",";",["T_WHITESPACE","\n\n        ",334],["T_RETURN","return",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],";",["T_WHITESPACE","\n    ",336],"}",["T_WHITESPACE","\n\n    ",337],["T_PUBLIC","public",339],["T_WHITESPACE"," ",339],["T_FUNCTION","function",339],["T_WHITESPACE"," ",339],["T_STRING","unparse",339],"(",")",["T_WHITESPACE","\n    ",339],"{",["T_WHITESPACE","\n        ",340],["T_VARIABLE","$batchExport",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","getBatchExportModel",341],"(",")",["T_WHITESPACE","\n            ",341],["T_OBJECT_OPERATOR","->",342],["T_STRING","setBatchId",342],"(",["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getBatchModel",342],"(",")",["T_OBJECT_OPERATOR","->",342],["T_STRING","getId",342],"(",")",")",";",["T_WHITESPACE","\n        ",342],["T_VARIABLE","$fieldList",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getBatchModel",343],"(",")",["T_OBJECT_OPERATOR","->",343],["T_STRING","getFieldList",343],"(",")",";",["T_WHITESPACE","\n        ",343],["T_VARIABLE","$batchExportIds",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_VARIABLE","$batchExport",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","getIdCollection",344],"(",")",";",["T_WHITESPACE","\n\n        ",344],["T_IF","if",346],["T_WHITESPACE"," ",346],"(","!",["T_STRING","is_array",346],"(",["T_VARIABLE","$batchExportIds",346],")",")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n            ",346],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],";",["T_WHITESPACE","\n        ",347],"}",["T_WHITESPACE","\n\n        ",348],["T_VARIABLE","$io",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getBatchModel",350],"(",")",["T_OBJECT_OPERATOR","->",350],["T_STRING","getIoAdapter",350],"(",")",";",["T_WHITESPACE","\n        ",350],["T_VARIABLE","$io",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","open",351],"(",")",";",["T_WHITESPACE","\n\n        ",351],["T_VARIABLE","$xml",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","'<'",353],".",["T_CONSTANT_ENCAPSED_STRING","'?xml version=\"1.0\"?'",353],".",["T_CONSTANT_ENCAPSED_STRING","'><'",353],".",["T_CONSTANT_ENCAPSED_STRING","'?mso-application progid=\"Excel.Sheet\"?'",353],["T_WHITESPACE","\n            ",353],".",["T_CONSTANT_ENCAPSED_STRING","'><Workbook'",354],["T_WHITESPACE","\n            ",354],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"'",355],["T_WHITESPACE","\n            ",355],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\"'",356],["T_WHITESPACE","\n            ",356],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:x=\"urn:schemas-microsoft-com:office:excel\"'",357],["T_WHITESPACE","\n            ",357],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:x2=\"http:\/\/schemas.microsoft.com\/office\/excel\/2003\/xml\"'",358],["T_WHITESPACE","\n            ",358],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"'",359],["T_WHITESPACE","\n            ",359],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:o=\"urn:schemas-microsoft-com:office:office\"'",360],["T_WHITESPACE","\n            ",360],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:html=\"http:\/\/www.w3.org\/TR\/REC-html40\"'",361],["T_WHITESPACE","\n            ",361],".",["T_CONSTANT_ENCAPSED_STRING","' xmlns:c=\"urn:schemas-microsoft-com:office:component:spreadsheet\">'",362],["T_WHITESPACE","\n            ",362],".",["T_CONSTANT_ENCAPSED_STRING","'<OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\">'",363],["T_WHITESPACE","\n            ",363],".",["T_CONSTANT_ENCAPSED_STRING","'<\/OfficeDocumentSettings>'",364],["T_WHITESPACE","\n            ",364],".",["T_CONSTANT_ENCAPSED_STRING","'<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\">'",365],["T_WHITESPACE","\n            ",365],".",["T_CONSTANT_ENCAPSED_STRING","'<\/ExcelWorkbook>'",366],";",["T_WHITESPACE","\n        ",366],["T_VARIABLE","$io",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","write",367],"(",["T_VARIABLE","$xml",367],")",";",["T_WHITESPACE","\n\n        ",367],["T_VARIABLE","$wsName",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_STRING","htmlspecialchars",369],"(",["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getVar",369],"(",["T_CONSTANT_ENCAPSED_STRING","'single_sheet'",369],")",")",";",["T_WHITESPACE","\n        ",369],["T_VARIABLE","$wsName",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],"!",["T_EMPTY","empty",370],"(",["T_VARIABLE","$wsName",370],")",["T_WHITESPACE"," ",370],"?",["T_WHITESPACE"," ",370],["T_VARIABLE","$wsName",370],["T_WHITESPACE"," ",370],":",["T_WHITESPACE"," ",370],["T_STRING","Mage",370],["T_DOUBLE_COLON","::",370],["T_STRING","helper",370],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow'",370],")",["T_OBJECT_OPERATOR","->",370],["T_STRING","__",370],"(",["T_CONSTANT_ENCAPSED_STRING","'Sheet 1'",370],")",";",["T_WHITESPACE","\n\n        ",370],["T_VARIABLE","$xml",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'<Worksheet ss:Name=\"'",372],["T_WHITESPACE"," ",372],".",["T_WHITESPACE"," ",372],["T_VARIABLE","$wsName",372],["T_WHITESPACE"," ",372],".",["T_WHITESPACE"," ",372],["T_CONSTANT_ENCAPSED_STRING","'\"><Table>'",372],";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$io",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","write",373],"(",["T_VARIABLE","$xml",373],")",";",["T_WHITESPACE","\n\n        ",373],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getVar",375],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",375],")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_VARIABLE","$xml",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_getXmlString",376],"(",["T_VARIABLE","$fieldList",376],")",";",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$io",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","write",377],"(",["T_VARIABLE","$xml",377],")",";",["T_WHITESPACE","\n        ",377],"}",["T_WHITESPACE","\n\n        ",378],["T_FOREACH","foreach",380],["T_WHITESPACE"," ",380],"(",["T_VARIABLE","$batchExportIds",380],["T_WHITESPACE"," ",380],["T_AS","as",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$batchExportId",380],")",["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n            ",380],["T_VARIABLE","$xmlData",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_ARRAY","array",381],"(",")",";",["T_WHITESPACE","\n            ",381],["T_VARIABLE","$batchExport",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","load",382],"(",["T_VARIABLE","$batchExportId",382],")",";",["T_WHITESPACE","\n            ",382],["T_VARIABLE","$row",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$batchExport",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","getBatchData",383],"(",")",";",["T_WHITESPACE","\n\n            ",383],["T_FOREACH","foreach",385],["T_WHITESPACE"," ",385],"(",["T_VARIABLE","$fieldList",385],["T_WHITESPACE"," ",385],["T_AS","as",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$field",385],")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n                ",385],["T_VARIABLE","$xmlData",386],"[","]",["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_ISSET","isset",386],"(",["T_VARIABLE","$row",386],"[",["T_VARIABLE","$field",386],"]",")",["T_WHITESPACE"," ",386],"?",["T_WHITESPACE"," ",386],["T_VARIABLE","$row",386],"[",["T_VARIABLE","$field",386],"]",["T_WHITESPACE"," ",386],":",["T_WHITESPACE"," ",386],["T_CONSTANT_ENCAPSED_STRING","''",386],";",["T_WHITESPACE","\n            ",386],"}",["T_WHITESPACE","\n            ",387],["T_VARIABLE","$xmlData",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","_getXmlString",388],"(",["T_VARIABLE","$xmlData",388],")",";",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$io",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","write",389],"(",["T_VARIABLE","$xmlData",389],")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n\n        ",390],["T_VARIABLE","$xml",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_CONSTANT_ENCAPSED_STRING","'<\/Table><\/Worksheet><\/Workbook>'",392],";",["T_WHITESPACE","\n        ",392],["T_VARIABLE","$io",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","write",393],"(",["T_VARIABLE","$xml",393],")",";",["T_WHITESPACE","\n        ",393],["T_VARIABLE","$io",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","close",394],"(",")",";",["T_WHITESPACE","\n\n        ",394],["T_RETURN","return",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],";",["T_WHITESPACE","\n\n",396],["T_COMMENT","\/\/        if ($wsName = $this->getVar('single_sheet')) {\n",398],["T_COMMENT","\/\/            $data = array($wsName => $this->getData());\n",399],["T_COMMENT","\/\/        } else {\n",400],["T_COMMENT","\/\/            $data = $this->getData();\n",401],["T_COMMENT","\/\/        }\n",402],["T_COMMENT","\/\/\n",403],["T_COMMENT","\/\/        $this->validateDataGrid();\n",404],["T_COMMENT","\/\/\n",405],["T_COMMENT","\/\/        $xml = '<'.'?xml version=\"1.0\"?'.'><'.'?mso-application progid=\"Excel.Sheet\"?'.'><Workbook'\n",406],["T_COMMENT","\/\/            .' xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"'\n",407],["T_COMMENT","\/\/            .' xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\"'\n",408],["T_COMMENT","\/\/            .' xmlns:x=\"urn:schemas-microsoft-com:office:excel\"'\n",409],["T_COMMENT","\/\/            .' xmlns:x2=\"http:\/\/schemas.microsoft.com\/office\/excel\/2003\/xml\"'\n",410],["T_COMMENT","\/\/            .' xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"'\n",411],["T_COMMENT","\/\/            .' xmlns:o=\"urn:schemas-microsoft-com:office:office\"'\n",412],["T_COMMENT","\/\/            .' xmlns:html=\"http:\/\/www.w3.org\/TR\/REC-html40\"'\n",413],["T_COMMENT","\/\/            .' xmlns:c=\"urn:schemas-microsoft-com:office:component:spreadsheet\">'\n",414],["T_COMMENT","\/\/            .'<OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\">'\n",415],["T_COMMENT","\/\/            .'<\/OfficeDocumentSettings>'\n",416],["T_COMMENT","\/\/            .'<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\">'\n",417],["T_COMMENT","\/\/            .'<\/ExcelWorkbook>';\n",418],["T_COMMENT","\/\/\n",419],["T_COMMENT","\/\/        if (is_array($data)) {\n",420],["T_COMMENT","\/\/            foreach ($data as $wsName=>$wsData) {\n",421],["T_COMMENT","\/\/                if (!is_array($wsData)) {\n",422],["T_COMMENT","\/\/                    continue;\n",423],["T_COMMENT","\/\/                }\n",424],["T_COMMENT","\/\/                $fields = $this->getGridFields($wsData);\n",425],["T_COMMENT","\/\/\n",426],["T_COMMENT","\/\/                $xml .= '<ss:Worksheet ss:Name=\"'.$wsName.'\"><Table>';\n",427],["T_COMMENT","\/\/                if ($this->getVar('fieldnames')) {\n",428],["T_COMMENT","\/\/                    $xml .= '<ss:Row>';\n",429],["T_COMMENT","\/\/                    foreach ($fields as $fieldName) {\n",430],["T_COMMENT","\/\/                        $xml .= '<ss:Cell><Data ss:Type=\"String\">'.$fieldName.'<\/Data><\/ss:Cell>';\n",431],["T_COMMENT","\/\/                    }\n",432],["T_COMMENT","\/\/                    $xml .= '<\/ss:Row>';\n",433],["T_COMMENT","\/\/                }\n",434],["T_COMMENT","\/\/                foreach ($wsData as $i=>$row) {\n",435],["T_COMMENT","\/\/                    if (!is_array($row)) {\n",436],["T_COMMENT","\/\/                        continue;\n",437],["T_COMMENT","\/\/                    }\n",438],["T_COMMENT","\/\/                    $xml .= '<ss:Row>';\n",439],["T_COMMENT","\/\/                    foreach ($fields as $fieldName) {\n",440],["T_COMMENT","\/\/                        $data = isset($row[$fieldName]) ? $row[$fieldName] : '';\n",441],["T_COMMENT","\/\/                        $xml .= '<ss:Cell><Data ss:Type=\"String\">'.$data.'<\/Data><\/ss:Cell>';\n",442],["T_COMMENT","\/\/                    }\n",443],["T_COMMENT","\/\/                    $xml .= '<\/ss:Row>';\n",444],["T_COMMENT","\/\/                }\n",445],["T_COMMENT","\/\/                $xml .= '<\/Table><\/ss:Worksheet>';\n",446],["T_COMMENT","\/\/            }\n",447],["T_COMMENT","\/\/        }\n",448],["T_COMMENT","\/\/\n",449],["T_COMMENT","\/\/        $xml .= '<\/Workbook>';\n",450],["T_COMMENT","\/\/\n",451],["T_COMMENT","\/\/        $this->setData($xml);\n",452],["T_COMMENT","\/\/\n",453],["T_COMMENT","\/\/        return $this;\n",454],["T_WHITESPACE","    ",455],"}",["T_WHITESPACE","\n\n    ",455],["T_DOC_COMMENT","\/**\n     * Prepare and return XML string for MS Excel XML from array\n     *\n     * @param array $fields\n     * @return string\n     *\/",457],["T_WHITESPACE","\n    ",462],["T_PROTECTED","protected",463],["T_WHITESPACE"," ",463],["T_FUNCTION","function",463],["T_WHITESPACE"," ",463],["T_STRING","_getXmlString",463],"(",["T_ARRAY","array",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$fields",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_ARRAY","array",463],"(",")",")",["T_WHITESPACE","\n    ",463],"{",["T_WHITESPACE","\n        ",464],["T_VARIABLE","$xmlHeader",465],["T_WHITESPACE"," ",465],"=",["T_WHITESPACE"," ",465],["T_CONSTANT_ENCAPSED_STRING","'<?xml version=\"1.0\"?>'",465],["T_WHITESPACE"," ",465],".",["T_WHITESPACE"," ",465],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",465],";",["T_WHITESPACE","\n        ",465],["T_VARIABLE","$xmlRegexp",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_CONSTANT_ENCAPSED_STRING","'\/^<cell><row>(.*)?<\\\/row><\\\/cell>\\s?$\/ms'",466],";",["T_WHITESPACE","\n\n        ",466],["T_IF","if",468],["T_WHITESPACE"," ",468],"(",["T_STRING","is_null",468],"(",["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_xmlElement",468],")",")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n            ",468],["T_VARIABLE","$xmlString",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$xmlHeader",469],["T_WHITESPACE"," ",469],".",["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'<cell><row><\/row><\/cell>'",469],";",["T_WHITESPACE","\n            ",469],["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","_xmlElement",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_NEW","new",470],["T_WHITESPACE"," ",470],["T_STRING","SimpleXMLElement",470],"(",["T_VARIABLE","$xmlString",470],",",["T_WHITESPACE"," ",470],["T_STRING","LIBXML_NOBLANKS",470],")",";",["T_WHITESPACE","\n        ",470],"}",["T_WHITESPACE","\n\n        ",471],["T_VARIABLE","$xmlData",473],["T_WHITESPACE"," ",473],"=",["T_WHITESPACE"," ",473],["T_ARRAY","array",473],"(",")",";",["T_WHITESPACE","\n        ",473],["T_VARIABLE","$xmlData",474],"[","]",["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_CONSTANT_ENCAPSED_STRING","'<Row>'",474],";",["T_WHITESPACE","\n        ",474],["T_FOREACH","foreach",475],["T_WHITESPACE"," ",475],"(",["T_VARIABLE","$fields",475],["T_WHITESPACE"," ",475],["T_AS","as",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$value",475],")",["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n            ",475],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_xmlElement",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","row",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_STRING","htmlspecialchars",476],"(",["T_VARIABLE","$value",476],")",";",["T_WHITESPACE","\n            ",476],["T_VARIABLE","$value",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_STRING","str_replace",477],"(",["T_VARIABLE","$xmlHeader",477],",",["T_WHITESPACE"," ",477],["T_CONSTANT_ENCAPSED_STRING","''",477],",",["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","_xmlElement",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","asXML",477],"(",")",")",";",["T_WHITESPACE","\n            ",477],["T_VARIABLE","$value",478],["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],["T_STRING","preg_replace",478],"(",["T_VARIABLE","$xmlRegexp",478],",",["T_WHITESPACE"," ",478],["T_CONSTANT_ENCAPSED_STRING","'\\\\1'",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$value",478],")",";",["T_WHITESPACE","\n            ",478],["T_IF","if",479],["T_WHITESPACE"," ",479],"(",["T_STRING","is_numeric",479],"(",["T_VARIABLE","$value",479],")",")",["T_WHITESPACE"," ",479],"{",["T_WHITESPACE","\n                ",479],["T_VARIABLE","$value",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_STRING","trim",480],"(",["T_VARIABLE","$value",480],")",";",["T_WHITESPACE","\n                ",480],["T_VARIABLE","$dataType",481],["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_CONSTANT_ENCAPSED_STRING","'Number'",481],";",["T_WHITESPACE","\n            ",481],"}",["T_WHITESPACE"," ",482],["T_ELSE","else",482],["T_WHITESPACE"," ",482],"{",["T_WHITESPACE","\n                ",482],["T_VARIABLE","$dataType",483],["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'String'",483],";",["T_WHITESPACE","\n            ",483],"}",["T_WHITESPACE","\n            ",484],["T_VARIABLE","$value",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_STRING","str_replace",485],"(",["T_ARRAY","array",485],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",485],",",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","\"\\r\"",485],",",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",485],")",",",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","'&#10;'",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$value",485],")",";",["T_WHITESPACE","\n\n            ",485],["T_VARIABLE","$xmlData",487],"[","]",["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'<Cell><Data ss:Type=\"'",487],["T_WHITESPACE"," ",487],".",["T_WHITESPACE"," ",487],["T_VARIABLE","$dataType",487],["T_WHITESPACE"," ",487],".",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'\">'",487],["T_WHITESPACE"," ",487],".",["T_WHITESPACE"," ",487],["T_VARIABLE","$value",487],["T_WHITESPACE"," ",487],".",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'<\/Data><\/Cell>'",487],";",["T_WHITESPACE","\n        ",487],"}",["T_WHITESPACE","\n        ",488],["T_VARIABLE","$xmlData",489],"[","]",["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_CONSTANT_ENCAPSED_STRING","'<\/Row>'",489],";",["T_WHITESPACE","\n\n        ",489],["T_RETURN","return",491],["T_WHITESPACE"," ",491],["T_STRING","join",491],"(",["T_CONSTANT_ENCAPSED_STRING","''",491],",",["T_WHITESPACE"," ",491],["T_VARIABLE","$xmlData",491],")",";",["T_WHITESPACE","\n    ",491],"}",["T_WHITESPACE","\n",492],"}",["T_WHITESPACE","\n",493]]