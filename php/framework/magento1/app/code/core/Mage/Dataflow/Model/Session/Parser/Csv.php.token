[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Dataflow\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Convert csv parser\n *\n * @category    Mage\n * @package     Mage_Dataflow\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Dataflow_Model_Session_Parser_Csv",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Dataflow_Model_Convert_Parser_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n\n    ",36],["T_PUBLIC","public",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","parse",38],"(",")",["T_WHITESPACE","\n    ",38],"{",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$fDel",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getVar",40],"(",["T_CONSTANT_ENCAPSED_STRING","'delimiter'",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","','",40],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$fEnc",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","getVar",41],"(",["T_CONSTANT_ENCAPSED_STRING","'enclose'",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'\"'",41],")",";",["T_WHITESPACE","\n\n        ",41],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_VARIABLE","$fDel",43],["T_IS_EQUAL","==",43],["T_CONSTANT_ENCAPSED_STRING","'\\\\t'",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n            ",43],["T_VARIABLE","$fDel",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","\"\\t\"",44],";",["T_WHITESPACE","\n        ",44],"}",["T_WHITESPACE","\n\n        ",45],["T_COMMENT","\/\/ fixed for multibyte characters\n",47],["T_WHITESPACE","        ",48],["T_STRING","setlocale",48],"(",["T_STRING","LC_ALL",48],",",["T_WHITESPACE"," ",48],["T_STRING","Mage",48],["T_DOUBLE_COLON","::",48],["T_STRING","app",48],"(",")",["T_OBJECT_OPERATOR","->",48],["T_STRING","getLocale",48],"(",")",["T_OBJECT_OPERATOR","->",48],["T_STRING","getLocaleCode",48],"(",")",".",["T_CONSTANT_ENCAPSED_STRING","'.UTF-8'",48],")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$fp",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","tmpfile",50],"(",")",";",["T_WHITESPACE","\n        ",50],["T_STRING","fputs",51],"(",["T_VARIABLE","$fp",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getData",51],"(",")",")",";",["T_WHITESPACE","\n        ",51],["T_STRING","fseek",52],"(",["T_VARIABLE","$fp",52],",",["T_WHITESPACE"," ",52],["T_LNUMBER","0",52],")",";",["T_WHITESPACE","\n\n        ",52],["T_VARIABLE","$data",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_ARRAY","array",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$sessionId",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","Mage",55],["T_DOUBLE_COLON","::",55],["T_STRING","registry",55],"(",["T_CONSTANT_ENCAPSED_STRING","'current_dataflow_session_id'",55],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$import",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","Mage",56],["T_DOUBLE_COLON","::",56],["T_STRING","getModel",56],"(",["T_CONSTANT_ENCAPSED_STRING","'dataflow\/import'",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$map",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","Varien_Convert_Mapper_Column",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_FOR","for",58],["T_WHITESPACE"," ",58],"(",["T_VARIABLE","$i",58],"=",["T_LNUMBER","0",58],";",["T_WHITESPACE"," ",58],["T_VARIABLE","$line",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","fgetcsv",58],"(",["T_VARIABLE","$fp",58],",",["T_WHITESPACE"," ",58],["T_LNUMBER","4096",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$fDel",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$fEnc",58],")",";",["T_WHITESPACE"," ",58],["T_VARIABLE","$i",58],["T_INC","++",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_LNUMBER","0",59],["T_IS_EQUAL","==",59],["T_VARIABLE","$i",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getVar",60],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",60],")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                    ",60],["T_VARIABLE","$fields",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$line",61],";",["T_WHITESPACE","\n                    ",61],["T_CONTINUE","continue",62],";",["T_WHITESPACE","\n                ",62],"}",["T_WHITESPACE"," ",63],["T_ELSE","else",63],["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n                    ",63],["T_FOREACH","foreach",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$line",64],["T_WHITESPACE"," ",64],["T_AS","as",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$j",64],["T_DOUBLE_ARROW","=>",64],["T_VARIABLE","$f",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                        ",64],["T_VARIABLE","$fields",65],"[",["T_VARIABLE","$j",65],"]",["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'column'",65],".","(",["T_VARIABLE","$j",65],"+",["T_LNUMBER","1",65],")",";",["T_WHITESPACE","\n                    ",65],"}",["T_WHITESPACE","\n                ",66],"}",["T_WHITESPACE","\n            ",67],"}",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$row",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",")",";",["T_WHITESPACE","\n            ",69],["T_FOREACH","foreach",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$fields",70],["T_WHITESPACE"," ",70],["T_AS","as",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$j",70],["T_DOUBLE_ARROW","=>",70],["T_VARIABLE","$f",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                ",70],["T_VARIABLE","$row",71],"[",["T_VARIABLE","$f",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$line",71],"[",["T_VARIABLE","$j",71],"]",";",["T_WHITESPACE","\n            ",71],"}",["T_WHITESPACE","\n            ",72],["T_COMMENT","\/*\n            if ($i <= 100)\n            {\n                $data[] = $row;\n            }\n            *\/",73],["T_WHITESPACE","\n            ",78],["T_COMMENT","\/\/$map = new Varien_Convert_Mapper_Column();\n",79],["T_WHITESPACE","            ",80],["T_VARIABLE","$map",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","setData",80],"(",["T_ARRAY","array",80],"(",["T_VARIABLE","$row",80],")",")",";",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$map",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","map",81],"(",")",";",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$row",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$map",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getData",82],"(",")",";",["T_WHITESPACE","\n            ",82],["T_COMMENT","\/\/$import = Mage::getModel('dataflow\/import');\n",83],["T_WHITESPACE","            ",84],["T_VARIABLE","$import",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","setImportId",84],"(",["T_LNUMBER","0",84],")",";",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$import",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","setSessionId",85],"(",["T_VARIABLE","$sessionId",85],")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$import",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","setSerialNumber",86],"(",["T_VARIABLE","$i",86],")",";",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$import",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","setValue",87],"(",["T_STRING","serialize",87],"(",["T_VARIABLE","$row",87],"[",["T_LNUMBER","0",87],"]",")",")",";",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$import",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","save",88],"(",")",";",["T_WHITESPACE","\n            ",88],["T_COMMENT","\/\/unset($import);\n",89],["T_WHITESPACE","        ",90],"}",["T_WHITESPACE","\n        ",90],["T_STRING","fclose",91],"(",["T_VARIABLE","$fp",91],")",";",["T_WHITESPACE","\n        ",91],["T_UNSET","unset",92],"(",["T_VARIABLE","$sessionId",92],")",";",["T_WHITESPACE","\n        ",92],["T_COMMENT","\/\/$this->setData($data);\n",93],["T_WHITESPACE","        ",94],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE"," ",95],["T_COMMENT","\/\/ end\n",95],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","unparse",97],"(",")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$csv",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","''",99],";",["T_WHITESPACE","\n\n        ",99],["T_VARIABLE","$fDel",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getVar",101],"(",["T_CONSTANT_ENCAPSED_STRING","'delimiter'",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","','",101],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$fEnc",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getVar",102],"(",["T_CONSTANT_ENCAPSED_STRING","'enclose'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'\"'",102],")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$fEsc",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getVar",103],"(",["T_CONSTANT_ENCAPSED_STRING","'escape'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",103],")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$lDel",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",104],";",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$fDel",106],["T_IS_EQUAL","==",106],["T_CONSTANT_ENCAPSED_STRING","'\\\\t'",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$fDel",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"\\t\"",107],";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$data",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getData",110],"(",")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$fields",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getGridFields",111],"(",["T_VARIABLE","$data",111],")",";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$lines",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],"(",")",";",["T_WHITESPACE","\n\n        ",112],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getVar",114],"(",["T_CONSTANT_ENCAPSED_STRING","'fieldnames'",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$line",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_ARRAY","array",115],"(",")",";",["T_WHITESPACE","\n            ",115],["T_FOREACH","foreach",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$fields",116],["T_WHITESPACE"," ",116],["T_AS","as",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$f",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                ",116],["T_VARIABLE","$line",117],"[","]",["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$fEnc",117],".",["T_STRING","str_replace",117],"(",["T_ARRAY","array",117],"(",["T_CONSTANT_ENCAPSED_STRING","'\"'",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",117],")",",",["T_WHITESPACE"," ",117],["T_ARRAY","array",117],"(",["T_VARIABLE","$fEsc",117],".",["T_CONSTANT_ENCAPSED_STRING","'\"'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$fEsc",117],".",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",117],")",",",["T_WHITESPACE"," ",117],["T_VARIABLE","$f",117],")",".",["T_VARIABLE","$fEnc",117],";",["T_WHITESPACE","\n            ",117],"}",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$lines",119],"[","]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","join",119],"(",["T_VARIABLE","$fDel",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$line",119],")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n        ",120],["T_FOREACH","foreach",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$data",121],["T_WHITESPACE"," ",121],["T_AS","as",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$i",121],["T_DOUBLE_ARROW","=>",121],["T_VARIABLE","$row",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$line",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",")",";",["T_WHITESPACE","\n            ",122],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$fields",123],["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$f",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_COMMENT","\/*\n                if (isset($row[$f]) && (preg_match('\\\"', $row[$f]) || preg_match('\\\\', $row[$f]))) {\n                    $tmp = str_replace('\\\\', '\\\\\\\\',$row[$f]);\n                    echo str_replace('\"', '\\\"',$tmp).'<br>';\n                }\n                *\/",124],["T_WHITESPACE","\n                ",129],["T_VARIABLE","$v",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_ISSET","isset",130],"(",["T_VARIABLE","$row",130],"[",["T_VARIABLE","$f",130],"]",")",["T_WHITESPACE"," ",130],"?",["T_WHITESPACE"," ",130],["T_STRING","str_replace",130],"(",["T_ARRAY","array",130],"(",["T_CONSTANT_ENCAPSED_STRING","'\"'",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",130],")",",",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",["T_VARIABLE","$fEsc",130],".",["T_CONSTANT_ENCAPSED_STRING","'\"'",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$fEsc",130],".",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",130],")",",",["T_WHITESPACE"," ",130],["T_VARIABLE","$row",130],"[",["T_VARIABLE","$f",130],"]",")",["T_WHITESPACE"," ",130],":",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","''",130],";",["T_WHITESPACE","\n\n                ",130],["T_VARIABLE","$line",132],"[","]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$fEnc",132],".",["T_VARIABLE","$v",132],".",["T_VARIABLE","$fEnc",132],";",["T_WHITESPACE","\n            ",132],"}",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$lines",134],"[","]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","join",134],"(",["T_VARIABLE","$fDel",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$line",134],")",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$result",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","join",136],"(",["T_VARIABLE","$lDel",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$lines",136],")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","setData",137],"(",["T_VARIABLE","$result",137],")",";",["T_WHITESPACE","\n\n        ",137],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n",140],"}",["T_WHITESPACE","\n",142]]