[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Captcha\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Implementation of Zend_Captcha\n *\n * @category   Mage\n * @package    Mage_Captcha\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Captcha_Model_Zend",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Zend_Captcha_Image",34],["T_WHITESPACE"," ",34],["T_IMPLEMENTS","implements",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Captcha_Model_Interface",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Key in session for captcha code\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","SESSION_WORD",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'word'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Min captcha lengths default value\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","DEFAULT_WORD_LENGTH_FROM",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_LNUMBER","3",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Max captcha lengths default value\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","DEFAULT_WORD_LENGTH_TO",49],["T_WHITESPACE","   ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","5",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Helper Instance\n     * @var Mage_Captcha_Helper_Data\n     *\/",51],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_helper",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Captcha expire time\n     * @var int\n     *\/",57],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_expiration",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n    * Override default value to prevent a captcha cut off\n    * @var int\n    * @see Zend_Captcha_Image::$_fsize\n    *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_fsize",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_LNUMBER","22",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Captcha form id\n     * @var string\n     *\/",70],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE","  ",74],["T_VARIABLE","$_formId",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Zend captcha constructor\n     *\n     * @param array $params\n     *\/",76],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","__construct",81],"(",["T_VARIABLE","$params",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(","!",["T_ISSET","isset",83],"(",["T_VARIABLE","$params",83],"[",["T_CONSTANT_ENCAPSED_STRING","'formId'",83],"]",")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_THROW","throw",84],["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","Exception",84],"(",["T_CONSTANT_ENCAPSED_STRING","'formId is mandatory'",84],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_formId",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$params",86],"[",["T_CONSTANT_ENCAPSED_STRING","'formId'",86],"]",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","setExpiration",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getTimeout",87],"(",")",")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Returns key with respect of current form ID\n     *\n     * @param string $key\n     * @return string\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","_getFormIdKey",96],"(",["T_VARIABLE","$key",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_formId",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'_'",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_VARIABLE","$key",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Get Block Name\n     *\n     * @return string\n     *\/",101],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","getBlockName",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'captcha\/captcha_zend'",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Whether captcha is required to be inserted to this form\n     *\n     * @param null|string $login\n     * @return bool\n     *\/",111],["T_WHITESPACE","\n    ",116],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","isRequired",117],"(",["T_VARIABLE","$login",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","null",117],")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_isUserAuth",119],"(",")",["T_WHITESPACE"," ",119],["T_BOOLEAN_OR","||",119],["T_WHITESPACE"," ",119],"!",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_isEnabled",119],"(",")",["T_WHITESPACE"," ",119],["T_BOOLEAN_OR","||",119],["T_WHITESPACE"," ",119],"!",["T_STRING","in_array",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_formId",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_getTargetForms",119],"(",")",")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_STRING","false",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n\n        ",121],["T_RETURN","return",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_isShowAlways",123],"(",")",["T_WHITESPACE"," ",123],["T_BOOLEAN_OR","||",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_isOverLimitAttempts",123],"(",["T_VARIABLE","$login",123],")",["T_WHITESPACE","\n            ",123],["T_BOOLEAN_OR","||",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getSession",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","getData",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_getFormIdKey",124],"(",["T_CONSTANT_ENCAPSED_STRING","'show_captcha'",124],")",")",["T_WHITESPACE","\n        ",124],")",";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Check is overlimit attempts\n     *\n     * @param string $login\n     * @return bool\n     *\/",128],["T_WHITESPACE","\n    ",133],["T_PROTECTED","protected",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","_isOverLimitAttempts",134],"(",["T_VARIABLE","$login",134],")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_RETURN","return",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_isOverLimitIpAttempt",136],"(",")",["T_WHITESPACE"," ",136],["T_BOOLEAN_OR","||",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_isOverLimitLoginAttempts",136],"(",["T_VARIABLE","$login",136],")",")",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Returns number of allowed attempts for same login\n     *\n     * @return int\n     *\/",139],["T_WHITESPACE","\n    ",143],["T_PROTECTED","protected",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","_getAllowedAttemptsForSameLogin",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_INT_CAST","(int)",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_getHelper",146],"(",")",["T_OBJECT_OPERATOR","->",146],["T_STRING","getConfigNode",146],"(",["T_CONSTANT_ENCAPSED_STRING","'failed_attempts_login'",146],")",";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Returns number of allowed attempts from same IP\n     *\n     * @return int\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","_getAllowedAttemptsFromSameIp",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_INT_CAST","(int)",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_getHelper",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","getConfigNode",156],"(",["T_CONSTANT_ENCAPSED_STRING","'failed_attempts_ip'",156],")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_DOC_COMMENT","\/**\n     * Check is overlimit saved attempts from one ip\n     *\n     * @return bool\n     *\/",159],["T_WHITESPACE","\n    ",163],["T_PROTECTED","protected",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","_isOverLimitIpAttempt",164],"(",")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$countAttemptsByIp",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","Mage",166],["T_DOUBLE_COLON","::",166],["T_STRING","getResourceModel",166],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha\/log'",166],")",["T_OBJECT_OPERATOR","->",166],["T_STRING","countAttemptsByRemoteAddress",166],"(",")",";",["T_WHITESPACE","\n        ",166],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$countAttemptsByIp",167],["T_WHITESPACE"," ",167],["T_IS_GREATER_OR_EQUAL",">=",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_getAllowedAttemptsFromSameIp",167],"(",")",";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Is Over Limit Login Attempts\n     *\n     * @param string $login\n     * @return bool\n     *\/",170],["T_WHITESPACE","\n    ",175],["T_PROTECTED","protected",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","_isOverLimitLoginAttempts",176],"(",["T_VARIABLE","$login",176],")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$login",178],["T_WHITESPACE"," ",178],["T_IS_NOT_EQUAL","!=",178],["T_WHITESPACE"," ",178],["T_STRING","false",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$countAttemptsByLogin",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING","Mage",179],["T_DOUBLE_COLON","::",179],["T_STRING","getResourceModel",179],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha\/log'",179],")",["T_OBJECT_OPERATOR","->",179],["T_STRING","countAttemptsByUserLogin",179],"(",["T_VARIABLE","$login",179],")",";",["T_WHITESPACE","\n            ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],"(",["T_VARIABLE","$countAttemptsByLogin",180],["T_WHITESPACE"," ",180],["T_IS_GREATER_OR_EQUAL",">=",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_getAllowedAttemptsForSameLogin",180],"(",")",")",";",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n        ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_STRING","false",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Check is user auth\n     *\n     * @return bool\n     *\/",185],["T_WHITESPACE","\n    ",189],["T_PROTECTED","protected",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","_isUserAuth",190],"(",")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","Mage",192],["T_DOUBLE_COLON","::",192],["T_STRING","app",192],"(",")",["T_OBJECT_OPERATOR","->",192],["T_STRING","getStore",192],"(",")",["T_OBJECT_OPERATOR","->",192],["T_STRING","isAdmin",192],"(",")",["T_WHITESPACE","\n            ",192],"?",["T_WHITESPACE"," ",193],["T_STRING","Mage",193],["T_DOUBLE_COLON","::",193],["T_STRING","getSingleton",193],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",193],")",["T_OBJECT_OPERATOR","->",193],["T_STRING","isLoggedIn",193],"(",")",["T_WHITESPACE","\n            ",193],":",["T_WHITESPACE"," ",194],["T_STRING","Mage",194],["T_DOUBLE_COLON","::",194],["T_STRING","getSingleton",194],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",194],")",["T_OBJECT_OPERATOR","->",194],["T_STRING","isLoggedIn",194],"(",")",";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Whether to respect case while checking the answer\n     *\n     * @return bool\n     *\/",197],["T_WHITESPACE","\n    ",201],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","isCaseSensitive",202],"(",")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_STRING_CAST","(string)",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_getHelper",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getConfigNode",204],"(",["T_CONSTANT_ENCAPSED_STRING","'case_sensitive'",204],")",";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n\n    ",205],["T_DOC_COMMENT","\/**\n     * Get font to use when generating captcha\n     *\n     * @return string\n     *\/",207],["T_WHITESPACE","\n    ",211],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","getFont",212],"(",")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_getFontPath",214],"(",")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * After this time isCorrect() is going to return FALSE even if word was guessed correctly\n     *\n     * @return int\n     *\/",217],["T_WHITESPACE","\n    ",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","getTimeout",222],"(",")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_IF","if",224],["T_WHITESPACE"," ",224],"(","!",["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_expiration",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_DOC_COMMENT","\/**\n             * as \"timeout\" configuration parameter specifies timeout in minutes - we multiply it on 60 to set\n             * expiration in seconds\n             *\/",225],["T_WHITESPACE","\n            ",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_expiration",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_INT_CAST","(int)",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_getHelper",229],"(",")",["T_OBJECT_OPERATOR","->",229],["T_STRING","getConfigNode",229],"(",["T_CONSTANT_ENCAPSED_STRING","'timeout'",229],")",["T_WHITESPACE"," ",229],"*",["T_WHITESPACE"," ",229],["T_LNUMBER","60",229],";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_expiration",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Get captcha image directory\n     *\n     * @return string\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","getImgDir",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_helper",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getImgDir",241],"(",")",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Get captcha image base URL\n     *\n     * @return string\n     *\/",244],["T_WHITESPACE","\n    ",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","getImgUrl",249],"(",")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_helper",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getImgUrl",251],"(",")",";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Checks whether captcha was guessed correctly by user\n     *\n     * @param string $word\n     * @return bool\n     *\/",254],["T_WHITESPACE","\n    ",259],["T_PUBLIC","public",260],["T_WHITESPACE"," ",260],["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],["T_STRING","isCorrect",260],"(",["T_VARIABLE","$word",260],")",["T_WHITESPACE","\n    ",260],"{",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$storedWord",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getWord",262],"(",")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_clearWord",263],"(",")",";",["T_WHITESPACE","\n\n        ",263],["T_IF","if",265],["T_WHITESPACE"," ",265],"(","!",["T_VARIABLE","$word",265],["T_WHITESPACE"," ",265],["T_BOOLEAN_OR","||",265],["T_WHITESPACE"," ",265],"!",["T_VARIABLE","$storedWord",265],")","{",["T_WHITESPACE","\n            ",265],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_STRING","false",266],";",["T_WHITESPACE","\n        ",266],"}",["T_WHITESPACE","\n\n        ",267],["T_IF","if",269],["T_WHITESPACE"," ",269],"(","!",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","isCaseSensitive",269],"(",")",")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$storedWord",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_STRING","strtolower",270],"(",["T_VARIABLE","$storedWord",270],")",";",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$word",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING","strtolower",271],"(",["T_VARIABLE","$word",271],")",";",["T_WHITESPACE","\n        ",271],"}",["T_WHITESPACE","\n        ",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$word",273],["T_WHITESPACE"," ",273],["T_IS_EQUAL","==",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$storedWord",273],";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Returns session instance\n     *\n     * @return Mage_Customer_Model_Session\n     *\/",276],["T_WHITESPACE","\n    ",280],["T_PUBLIC","public",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","getSession",281],"(",")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_STRING","Mage",283],["T_DOUBLE_COLON","::",283],["T_STRING","getSingleton",283],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",283],")",";",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n\n     ",284],["T_DOC_COMMENT","\/**\n     * Return full URL to captcha image\n     *\n     * @return string\n     *\/",286],["T_WHITESPACE","\n    ",290],["T_PUBLIC","public",291],["T_WHITESPACE"," ",291],["T_FUNCTION","function",291],["T_WHITESPACE"," ",291],["T_STRING","getImgSrc",291],"(",")",["T_WHITESPACE","\n    ",291],"{",["T_WHITESPACE","\n        ",292],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getImgUrl",293],"(",")",["T_WHITESPACE"," ",293],".",["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getId",293],"(",")",["T_WHITESPACE"," ",293],".",["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getSuffix",293],"(",")",";",["T_WHITESPACE","\n    ",293],"}",["T_WHITESPACE","\n\n    ",294],["T_DOC_COMMENT","\/**\n     * log Attempt\n     *\n     * @param string $login\n     * @return Mage_Captcha_Model_Zend\n     *\/",296],["T_WHITESPACE","\n    ",301],["T_PUBLIC","public",302],["T_WHITESPACE"," ",302],["T_FUNCTION","function",302],["T_WHITESPACE"," ",302],["T_STRING","logAttempt",302],"(",["T_VARIABLE","$login",302],")",["T_WHITESPACE","\n    ",302],"{",["T_WHITESPACE","\n        ",303],["T_IF","if",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_isEnabled",304],"(",")",["T_WHITESPACE"," ",304],["T_BOOLEAN_AND","&&",304],["T_WHITESPACE"," ",304],["T_STRING","in_array",304],"(",["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_formId",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_getTargetForms",304],"(",")",")",")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n            ",304],["T_STRING","Mage",305],["T_DOUBLE_COLON","::",305],["T_STRING","getResourceModel",305],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha\/log'",305],")",["T_OBJECT_OPERATOR","->",305],["T_STRING","logAttempt",305],"(",["T_VARIABLE","$login",305],")",";",["T_WHITESPACE","\n            ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_isOverLimitLoginAttempts",306],"(",["T_VARIABLE","$login",306],")",")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                ",306],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getSession",307],"(",")",["T_OBJECT_OPERATOR","->",307],["T_STRING","setData",307],"(",["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","_getFormIdKey",307],"(",["T_CONSTANT_ENCAPSED_STRING","'show_captcha'",307],")",",",["T_WHITESPACE"," ",307],["T_LNUMBER","1",307],")",";",["T_WHITESPACE","\n            ",307],"}",["T_WHITESPACE","\n        ",308],"}",["T_WHITESPACE","\n        ",309],["T_RETURN","return",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],";",["T_WHITESPACE","\n    ",310],"}",["T_WHITESPACE","\n\n    ",311],["T_DOC_COMMENT","\/**\n     * Returns path for the font file, chosen to generate captcha\n     *\n     * @return string\n     *\/",313],["T_WHITESPACE","\n    ",317],["T_PROTECTED","protected",318],["T_WHITESPACE"," ",318],["T_FUNCTION","function",318],["T_WHITESPACE"," ",318],["T_STRING","_getFontPath",318],"(",")",["T_WHITESPACE","\n    ",318],"{",["T_WHITESPACE","\n        ",319],["T_VARIABLE","$font",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING_CAST","(string)",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_getHelper",320],"(",")",["T_OBJECT_OPERATOR","->",320],["T_STRING","getConfigNode",320],"(",["T_CONSTANT_ENCAPSED_STRING","'font'",320],")",";",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$fonts",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_getHelper",321],"(",")",["T_OBJECT_OPERATOR","->",321],["T_STRING","getFonts",321],"(",")",";",["T_WHITESPACE","\n\n        ",321],["T_IF","if",323],["T_WHITESPACE"," ",323],"(",["T_ISSET","isset",323],"(",["T_VARIABLE","$fonts",323],"[",["T_VARIABLE","$font",323],"]",")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n            ",323],["T_VARIABLE","$fontPath",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_VARIABLE","$fonts",324],"[",["T_VARIABLE","$font",324],"]","[",["T_CONSTANT_ENCAPSED_STRING","'path'",324],"]",";",["T_WHITESPACE","\n        ",324],"}",["T_WHITESPACE"," ",325],["T_ELSE","else",325],["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$fontData",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_STRING","array_shift",326],"(",["T_VARIABLE","$fonts",326],")",";",["T_WHITESPACE","\n            ",326],["T_VARIABLE","$fontPath",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$fontData",327],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",327],"]",";",["T_WHITESPACE","\n        ",327],"}",["T_WHITESPACE","\n\n        ",328],["T_RETURN","return",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$fontPath",330],";",["T_WHITESPACE","\n    ",330],"}",["T_WHITESPACE","\n\n    ",331],["T_DOC_COMMENT","\/**\n     * Returns captcha helper\n     *\n     * @return Mage_Captcha_Helper_Data\n     *\/",333],["T_WHITESPACE","\n    ",337],["T_PROTECTED","protected",338],["T_WHITESPACE"," ",338],["T_FUNCTION","function",338],["T_WHITESPACE"," ",338],["T_STRING","_getHelper",338],"(",")",["T_WHITESPACE","\n    ",338],"{",["T_WHITESPACE","\n        ",339],["T_IF","if",340],["T_WHITESPACE"," ",340],"(",["T_EMPTY","empty",340],"(",["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_helper",340],")",")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n            ",340],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_helper",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_STRING","Mage",341],["T_DOUBLE_COLON","::",341],["T_STRING","helper",341],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",341],")",";",["T_WHITESPACE","\n        ",341],"}",["T_WHITESPACE","\n        ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_helper",343],";",["T_WHITESPACE","\n    ",343],"}",["T_WHITESPACE","\n\n    ",344],["T_DOC_COMMENT","\/**\n     * Generate word used for captcha render\n     *\n     * @return string\n     *\/",346],["T_WHITESPACE","\n    ",350],["T_PROTECTED","protected",351],["T_WHITESPACE"," ",351],["T_FUNCTION","function",351],["T_WHITESPACE"," ",351],["T_STRING","_generateWord",351],"(",")",["T_WHITESPACE","\n    ",351],"{",["T_WHITESPACE","\n        ",352],["T_VARIABLE","$word",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","''",353],";",["T_WHITESPACE","\n        ",353],["T_VARIABLE","$symbols",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","_getSymbols",354],"(",")",";",["T_WHITESPACE","\n        ",354],["T_VARIABLE","$wordLen",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","_getWordLen",355],"(",")",";",["T_WHITESPACE","\n        ",355],["T_FOR","for",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$i",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_LNUMBER","0",356],";",["T_WHITESPACE"," ",356],["T_VARIABLE","$i",356],["T_WHITESPACE"," ",356],"<",["T_WHITESPACE"," ",356],["T_VARIABLE","$wordLen",356],";",["T_WHITESPACE"," ",356],["T_VARIABLE","$i",356],["T_INC","++",356],")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$word",357],["T_WHITESPACE"," ",357],["T_CONCAT_EQUAL",".=",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$symbols",357],"[",["T_STRING","array_rand",357],"(",["T_VARIABLE","$symbols",357],")","]",";",["T_WHITESPACE","\n        ",357],"}",["T_WHITESPACE","\n        ",358],["T_RETURN","return",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$word",359],";",["T_WHITESPACE","\n    ",359],"}",["T_WHITESPACE","\n\n    ",360],["T_DOC_COMMENT","\/**\n     * Get symbols array to use for word generation\n     *\n     * @return array\n     *\/",362],["T_WHITESPACE","\n    ",366],["T_PROTECTED","protected",367],["T_WHITESPACE"," ",367],["T_FUNCTION","function",367],["T_WHITESPACE"," ",367],["T_STRING","_getSymbols",367],"(",")",["T_WHITESPACE","\n    ",367],"{",["T_WHITESPACE","\n        ",368],["T_RETURN","return",369],["T_WHITESPACE"," ",369],["T_STRING","str_split",369],"(",["T_STRING_CAST","(string)",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_getHelper",369],"(",")",["T_OBJECT_OPERATOR","->",369],["T_STRING","getConfigNode",369],"(",["T_CONSTANT_ENCAPSED_STRING","'symbols'",369],")",")",";",["T_WHITESPACE","\n    ",369],"}",["T_WHITESPACE","\n\n    ",370],["T_DOC_COMMENT","\/**\n     * Returns length for generating captcha word. This value may be dynamic.\n     *\n     * @return int\n     *\/",372],["T_WHITESPACE","\n    ",376],["T_PROTECTED","protected",377],["T_WHITESPACE"," ",377],["T_FUNCTION","function",377],["T_WHITESPACE"," ",377],["T_STRING","_getWordLen",377],"(",")",["T_WHITESPACE","\n    ",377],"{",["T_WHITESPACE","\n        ",378],["T_VARIABLE","$from",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_LNUMBER","0",379],";",["T_WHITESPACE","\n        ",379],["T_VARIABLE","$to",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_LNUMBER","0",380],";",["T_WHITESPACE","\n        ",380],["T_VARIABLE","$length",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_STRING_CAST","(string)",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_getHelper",381],"(",")",["T_OBJECT_OPERATOR","->",381],["T_STRING","getConfigNode",381],"(",["T_CONSTANT_ENCAPSED_STRING","'length'",381],")",";",["T_WHITESPACE","\n        ",381],["T_IF","if",382],["T_WHITESPACE"," ",382],"(","!",["T_STRING","is_numeric",382],"(",["T_VARIABLE","$length",382],")",")",["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n            ",382],["T_IF","if",383],["T_WHITESPACE"," ",383],"(",["T_STRING","preg_match",383],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(\\d+)-(\\d+)\/'",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$length",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$matches",383],")",")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n                ",383],["T_VARIABLE","$from",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_INT_CAST","(int)",384],["T_VARIABLE","$matches",384],"[",["T_LNUMBER","1",384],"]",";",["T_WHITESPACE","\n                ",384],["T_VARIABLE","$to",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_INT_CAST","(int)",385],["T_VARIABLE","$matches",385],"[",["T_LNUMBER","2",385],"]",";",["T_WHITESPACE","\n            ",385],"}",["T_WHITESPACE","\n        ",386],"}",["T_WHITESPACE"," ",387],["T_ELSE","else",387],["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n            ",387],["T_VARIABLE","$from",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_INT_CAST","(int)",388],["T_VARIABLE","$length",388],";",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$to",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_INT_CAST","(int)",389],["T_VARIABLE","$length",389],";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n\n        ",390],["T_IF","if",392],["T_WHITESPACE"," ",392],"(","(",["T_VARIABLE","$to",392],["T_WHITESPACE"," ",392],"<",["T_WHITESPACE"," ",392],["T_VARIABLE","$from",392],")",["T_WHITESPACE"," ",392],["T_BOOLEAN_OR","||",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$from",392],["T_WHITESPACE"," ",392],"<",["T_WHITESPACE"," ",392],["T_LNUMBER","1",392],")",["T_WHITESPACE"," ",392],["T_BOOLEAN_OR","||",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$to",392],["T_WHITESPACE"," ",392],"<",["T_WHITESPACE"," ",392],["T_LNUMBER","1",392],")",")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n            ",392],["T_VARIABLE","$from",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_STRING","self",393],["T_DOUBLE_COLON","::",393],["T_STRING","DEFAULT_WORD_LENGTH_FROM",393],";",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$to",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_STRING","self",394],["T_DOUBLE_COLON","::",394],["T_STRING","DEFAULT_WORD_LENGTH_TO",394],";",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n\n        ",395],["T_RETURN","return",397],["T_WHITESPACE"," ",397],["T_STRING","mt_rand",397],"(",["T_VARIABLE","$from",397],",",["T_WHITESPACE"," ",397],["T_VARIABLE","$to",397],")",";",["T_WHITESPACE","\n    ",397],"}",["T_WHITESPACE","\n\n    ",398],["T_DOC_COMMENT","\/**\n     * Whether to show captcha for this form every time\n     *\n     * @return bool\n     *\/",400],["T_WHITESPACE","\n    ",404],["T_PROTECTED","protected",405],["T_WHITESPACE"," ",405],["T_FUNCTION","function",405],["T_WHITESPACE"," ",405],["T_STRING","_isShowAlways",405],"(",")",["T_WHITESPACE","\n    ",405],"{",["T_WHITESPACE","\n        ",406],["T_COMMENT","\/\/ setting the allowed attempts to 0 is like setting mode to always\n",407],["T_WHITESPACE","        ",408],["T_IF","if",408],["T_WHITESPACE"," ",408],"(",["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_getAllowedAttemptsForSameLogin",408],"(",")",["T_WHITESPACE"," ",408],["T_IS_EQUAL","==",408],["T_WHITESPACE"," ",408],["T_LNUMBER","0",408],["T_WHITESPACE"," ",408],["T_BOOLEAN_OR","||",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_getAllowedAttemptsFromSameIp",408],"(",")",["T_WHITESPACE"," ",408],["T_IS_EQUAL","==",408],["T_WHITESPACE"," ",408],["T_LNUMBER","0",408],")",["T_WHITESPACE"," ",408],"{",["T_WHITESPACE","\n            ",408],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_STRING","true",409],";",["T_WHITESPACE","\n        ",409],"}",["T_WHITESPACE","\n\n        ",410],["T_IF","if",412],["T_WHITESPACE"," ",412],"(",["T_STRING_CAST","(string)",412],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","_getHelper",412],"(",")",["T_OBJECT_OPERATOR","->",412],["T_STRING","getConfigNode",412],"(",["T_CONSTANT_ENCAPSED_STRING","'mode'",412],")",["T_WHITESPACE"," ",412],["T_IS_EQUAL","==",412],["T_WHITESPACE"," ",412],["T_STRING","Mage_Captcha_Helper_Data",412],["T_DOUBLE_COLON","::",412],["T_STRING","MODE_ALWAYS",412],")",["T_WHITESPACE"," ",412],"{",["T_WHITESPACE","\n            ",412],["T_RETURN","return",413],["T_WHITESPACE"," ",413],["T_STRING","true",413],";",["T_WHITESPACE","\n        ",413],"}",["T_WHITESPACE","\n\n        ",414],["T_VARIABLE","$alwaysFor",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","_getHelper",416],"(",")",["T_OBJECT_OPERATOR","->",416],["T_STRING","getConfigNode",416],"(",["T_CONSTANT_ENCAPSED_STRING","'always_for'",416],")",";",["T_WHITESPACE","\n        ",416],["T_FOREACH","foreach",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$alwaysFor",417],["T_WHITESPACE"," ",417],["T_AS","as",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$nodeFormId",417],["T_WHITESPACE"," ",417],["T_DOUBLE_ARROW","=>",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$isAlwaysFor",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_IF","if",418],["T_WHITESPACE"," ",418],"(",["T_VARIABLE","$isAlwaysFor",418],["T_WHITESPACE"," ",418],["T_BOOLEAN_AND","&&",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_formId",418],["T_WHITESPACE"," ",418],["T_IS_EQUAL","==",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$nodeFormId",418],")",["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n                ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_STRING","true",419],";",["T_WHITESPACE","\n            ",419],"}",["T_WHITESPACE","\n        ",420],"}",["T_WHITESPACE","\n\n        ",421],["T_RETURN","return",423],["T_WHITESPACE"," ",423],["T_STRING","false",423],";",["T_WHITESPACE","\n    ",423],"}",["T_WHITESPACE","\n\n    ",424],["T_DOC_COMMENT","\/**\n     * Whether captcha is enabled at this area\n     *\n     * @return bool\n     *\/",426],["T_WHITESPACE","\n    ",430],["T_PROTECTED","protected",431],["T_WHITESPACE"," ",431],["T_FUNCTION","function",431],["T_WHITESPACE"," ",431],["T_STRING","_isEnabled",431],"(",")",["T_WHITESPACE","\n    ",431],"{",["T_WHITESPACE","\n        ",432],["T_RETURN","return",433],["T_WHITESPACE"," ",433],["T_STRING_CAST","(string)",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","_getHelper",433],"(",")",["T_OBJECT_OPERATOR","->",433],["T_STRING","getConfigNode",433],"(",["T_CONSTANT_ENCAPSED_STRING","'enable'",433],")",";",["T_WHITESPACE","\n    ",433],"}",["T_WHITESPACE","\n\n    ",434],["T_DOC_COMMENT","\/**\n     * Retrieve list of forms where captcha must be shown\n     *\n     * For frontend this list is based on current website\n     *\n     * @return array\n     *\/",436],["T_WHITESPACE","\n    ",442],["T_PROTECTED","protected",443],["T_WHITESPACE"," ",443],["T_FUNCTION","function",443],["T_WHITESPACE"," ",443],["T_STRING","_getTargetForms",443],"(",")",["T_WHITESPACE","\n    ",443],"{",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$formsString",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_STRING_CAST","(string)",445],["T_WHITESPACE"," ",445],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","_getHelper",445],"(",")",["T_OBJECT_OPERATOR","->",445],["T_STRING","getConfigNode",445],"(",["T_CONSTANT_ENCAPSED_STRING","'forms'",445],")",";",["T_WHITESPACE","\n        ",445],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_STRING","explode",446],"(",["T_CONSTANT_ENCAPSED_STRING","','",446],",",["T_WHITESPACE"," ",446],["T_VARIABLE","$formsString",446],")",";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Get captcha word\n     *\n     * @return string\n     *\/",449],["T_WHITESPACE","\n    ",453],["T_PUBLIC","public",454],["T_WHITESPACE"," ",454],["T_FUNCTION","function",454],["T_WHITESPACE"," ",454],["T_STRING","getWord",454],"(",")",["T_WHITESPACE","\n    ",454],"{",["T_WHITESPACE","\n        ",455],["T_VARIABLE","$sessionData",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","getSession",456],"(",")",["T_OBJECT_OPERATOR","->",456],["T_STRING","getData",456],"(",["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","_getFormIdKey",456],"(",["T_STRING","self",456],["T_DOUBLE_COLON","::",456],["T_STRING","SESSION_WORD",456],")",")",";",["T_WHITESPACE","\n        ",456],["T_RETURN","return",457],["T_WHITESPACE"," ",457],["T_STRING","time",457],"(",")",["T_WHITESPACE"," ",457],"<",["T_WHITESPACE"," ",457],["T_VARIABLE","$sessionData",457],"[",["T_CONSTANT_ENCAPSED_STRING","'expires'",457],"]",["T_WHITESPACE"," ",457],"?",["T_WHITESPACE"," ",457],["T_VARIABLE","$sessionData",457],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",457],"]",["T_WHITESPACE"," ",457],":",["T_WHITESPACE"," ",457],["T_STRING","null",457],";",["T_WHITESPACE","\n    ",457],"}",["T_WHITESPACE","\n\n    ",458],["T_DOC_COMMENT","\/**\n     * Set captcha word\n     *\n     * @param  string $word\n     * @return Zend_Captcha_Word\n     *\/",460],["T_WHITESPACE","\n    ",465],["T_PROTECTED","protected",466],["T_WHITESPACE"," ",466],["T_FUNCTION","function",466],["T_WHITESPACE"," ",466],["T_STRING","_setWord",466],"(",["T_VARIABLE","$word",466],")",["T_WHITESPACE","\n    ",466],"{",["T_WHITESPACE","\n        ",467],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","getSession",468],"(",")",["T_OBJECT_OPERATOR","->",468],["T_STRING","setData",468],"(",["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_getFormIdKey",468],"(",["T_STRING","self",468],["T_DOUBLE_COLON","::",468],["T_STRING","SESSION_WORD",468],")",",",["T_WHITESPACE","\n            ",468],["T_ARRAY","array",469],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",469],["T_WHITESPACE"," ",469],["T_DOUBLE_ARROW","=>",469],["T_WHITESPACE"," ",469],["T_VARIABLE","$word",469],",",["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'expires'",469],["T_WHITESPACE"," ",469],["T_DOUBLE_ARROW","=>",469],["T_WHITESPACE"," ",469],["T_STRING","time",469],"(",")",["T_WHITESPACE"," ",469],"+",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getTimeout",469],"(",")",")",["T_WHITESPACE","\n        ",469],")",";",["T_WHITESPACE","\n        ",470],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_word",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$word",471],";",["T_WHITESPACE","\n        ",471],["T_RETURN","return",472],["T_WHITESPACE"," ",472],["T_VARIABLE","$this",472],";",["T_WHITESPACE","\n    ",472],"}",["T_WHITESPACE","\n\n    ",473],["T_DOC_COMMENT","\/**\n     * Set captcha word\n     *\n     * @return Mage_Captcha_Model_Zend\n     *\/",475],["T_WHITESPACE","\n    ",479],["T_PROTECTED","protected",480],["T_WHITESPACE"," ",480],["T_FUNCTION","function",480],["T_WHITESPACE"," ",480],["T_STRING","_clearWord",480],"(",")",["T_WHITESPACE","\n    ",480],"{",["T_WHITESPACE","\n        ",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","getSession",482],"(",")",["T_OBJECT_OPERATOR","->",482],["T_STRING","unsetData",482],"(",["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_getFormIdKey",482],"(",["T_STRING","self",482],["T_DOUBLE_COLON","::",482],["T_STRING","SESSION_WORD",482],")",")",";",["T_WHITESPACE","\n        ",482],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","_word",483],["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_STRING","null",483],";",["T_WHITESPACE","\n        ",483],["T_RETURN","return",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$this",484],";",["T_WHITESPACE","\n    ",484],"}",["T_WHITESPACE","\n\n    ",485],["T_DOC_COMMENT","\/**\n    * Override function to generate less curly captcha that will not cut off\n    *\n    * @see Zend_Captcha_Image::_randomSize()\n    * @return int\n    *\/",487],["T_WHITESPACE","\n    ",492],["T_PROTECTED","protected",493],["T_WHITESPACE"," ",493],["T_FUNCTION","function",493],["T_WHITESPACE"," ",493],["T_STRING","_randomSize",493],"(",")",["T_WHITESPACE","\n    ",493],"{",["T_WHITESPACE","\n        ",494],["T_RETURN","return",495],["T_WHITESPACE"," ",495],["T_STRING","mt_rand",495],"(",["T_LNUMBER","280",495],",",["T_WHITESPACE"," ",495],["T_LNUMBER","300",495],")",["T_WHITESPACE"," ",495],"\/",["T_WHITESPACE"," ",495],["T_LNUMBER","100",495],";",["T_WHITESPACE","\n    ",495],"}",["T_WHITESPACE","\n\n    ",496],["T_DOC_COMMENT","\/**\n     * Overlap of the parent method\n     *\n     * Now deleting old captcha images make crontab script\n     * @see Mage_Captcha_Model_Observer::deleteExpiredImages\n     *\/",498],["T_WHITESPACE","\n    ",503],["T_PROTECTED","protected",504],["T_WHITESPACE"," ",504],["T_FUNCTION","function",504],["T_WHITESPACE"," ",504],["T_STRING","_gc",504],"(",")",["T_WHITESPACE","\n    ",504],"{",["T_WHITESPACE","\n        ",505],["T_COMMENT","\/\/do nothing\n",506],["T_WHITESPACE","    ",507],"}",["T_WHITESPACE","\n",507],"}",["T_WHITESPACE","\n",508]]