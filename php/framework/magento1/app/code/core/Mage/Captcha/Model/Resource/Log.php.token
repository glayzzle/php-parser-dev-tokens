[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Captcha\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Log Attempts resource\n *\n * @category    Mage\n * @package     Mage_Captcha\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Captcha_Model_Resource_Log",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Type Remote Address\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","TYPE_REMOTE_ADDRESS",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_LNUMBER","1",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Type User Login Name\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","TYPE_LOGIN",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_LNUMBER","2",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Define main table\n     *\n     *\/",47],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","_construct",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_setMainTable",53],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha\/log'",53],")",";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Save or Update count Attempts\n     *\n     * @param string|null $login\n     * @return Mage_Captcha_Model_Resource_Log\n     *\/",56],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","logAttempt",62],"(",["T_VARIABLE","$login",62],")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$login",64],["T_WHITESPACE"," ",64],["T_IS_NOT_EQUAL","!=",64],["T_WHITESPACE"," ",64],["T_STRING","null",64],")","{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_getWriteAdapter",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","insertOnDuplicate",65],"(",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMainTable",66],"(",")",",",["T_WHITESPACE","\n                ",66],["T_ARRAY","array",67],"(",["T_WHITESPACE","\n                     ",67],["T_CONSTANT_ENCAPSED_STRING","'type'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_STRING","self",68],["T_DOUBLE_COLON","::",68],["T_STRING","TYPE_LOGIN",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'value'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$login",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'count'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_LNUMBER","1",68],",",["T_WHITESPACE","\n                     ",68],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","getSingleton",69],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",69],")",["T_OBJECT_OPERATOR","->",69],["T_STRING","gmtDate",69],"(",")",["T_WHITESPACE","\n                ",69],")",",",["T_WHITESPACE","\n                ",70],["T_ARRAY","array",71],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_NEW","new",71],["T_WHITESPACE"," ",71],["T_STRING","Zend_Db_Expr",71],"(",["T_CONSTANT_ENCAPSED_STRING","'count+1'",71],")",",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",71],")",["T_WHITESPACE","\n            ",71],")",";",["T_WHITESPACE","\n        ",72],"}",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$ip",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","Mage",74],["T_DOUBLE_COLON","::",74],["T_STRING","helper",74],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/http'",74],")",["T_OBJECT_OPERATOR","->",74],["T_STRING","getRemoteAddr",74],"(",")",";",["T_WHITESPACE","\n        ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$ip",75],["T_WHITESPACE"," ",75],["T_IS_NOT_EQUAL","!=",75],["T_WHITESPACE"," ",75],["T_STRING","null",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_getWriteAdapter",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","insertOnDuplicate",76],"(",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getMainTable",77],"(",")",",",["T_WHITESPACE","\n                ",77],["T_ARRAY","array",78],"(",["T_WHITESPACE","\n                     ",78],["T_CONSTANT_ENCAPSED_STRING","'type'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_STRING","self",79],["T_DOUBLE_COLON","::",79],["T_STRING","TYPE_REMOTE_ADDRESS",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'value'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$ip",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'count'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_LNUMBER","1",79],",",["T_WHITESPACE","\n                     ",79],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","getSingleton",80],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",80],")",["T_OBJECT_OPERATOR","->",80],["T_STRING","gmtDate",80],"(",")",["T_WHITESPACE","\n                ",80],")",",",["T_WHITESPACE","\n                ",81],["T_ARRAY","array",82],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","Zend_Db_Expr",82],"(",["T_CONSTANT_ENCAPSED_STRING","'count+1'",82],")",",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",82],")",["T_WHITESPACE","\n            ",82],")",";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Delete User attempts by login\n     *\n     * @param string $login\n     * @return Mage_Captcha_Model_Resource_Log\n     *\/",88],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","deleteUserAttempts",94],"(",["T_VARIABLE","$login",94],")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$login",96],["T_WHITESPACE"," ",96],["T_IS_NOT_EQUAL","!=",96],["T_WHITESPACE"," ",96],["T_STRING","null",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_getWriteAdapter",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","delete",97],"(",["T_WHITESPACE","\n                ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getMainTable",98],"(",")",",",["T_WHITESPACE","\n                ",98],["T_ARRAY","array",99],"(",["T_CONSTANT_ENCAPSED_STRING","'type = ?'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_STRING","self",99],["T_DOUBLE_COLON","::",99],["T_STRING","TYPE_LOGIN",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'value = ?'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$login",99],")",["T_WHITESPACE","\n            ",99],")",";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$ip",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","Mage",102],["T_DOUBLE_COLON","::",102],["T_STRING","helper",102],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/http'",102],")",["T_OBJECT_OPERATOR","->",102],["T_STRING","getRemoteAddr",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$ip",103],["T_WHITESPACE"," ",103],["T_IS_NOT_EQUAL","!=",103],["T_WHITESPACE"," ",103],["T_STRING","null",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_getWriteAdapter",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","delete",104],"(",["T_WHITESPACE","\n                ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getMainTable",105],"(",")",",",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_CONSTANT_ENCAPSED_STRING","'type = ?'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_STRING","self",105],["T_DOUBLE_COLON","::",105],["T_STRING","TYPE_REMOTE_ADDRESS",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'value = ?'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$ip",105],")",["T_WHITESPACE","\n            ",105],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Get count attempts by ip\n     *\n     * @return null|int\n     *\/",112],["T_WHITESPACE","\n    ",116],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","countAttemptsByRemoteAddress",117],"(",")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$ip",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","Mage",119],["T_DOUBLE_COLON","::",119],["T_STRING","helper",119],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/http'",119],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getRemoteAddr",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_VARIABLE","$ip",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_LNUMBER","0",121],";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$read",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_getReadAdapter",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$select",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$read",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","select",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","from",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getMainTable",124],"(",")",",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'count'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","where",124],"(",["T_CONSTANT_ENCAPSED_STRING","'type = ?'",124],",",["T_WHITESPACE"," ",124],["T_STRING","self",124],["T_DOUBLE_COLON","::",124],["T_STRING","TYPE_REMOTE_ADDRESS",124],")",["T_WHITESPACE","\n            ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","where",125],"(",["T_CONSTANT_ENCAPSED_STRING","'value = ?'",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$ip",125],")",";",["T_WHITESPACE","\n        ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$read",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","fetchOne",126],"(",["T_VARIABLE","$select",126],")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Get count attempts by user login\n     *\n     * @param string $login\n     * @return null|int\n     *\/",129],["T_WHITESPACE","\n    ",134],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","countAttemptsByUserLogin",135],"(",["T_VARIABLE","$login",135],")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(","!",["T_VARIABLE","$login",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_LNUMBER","0",138],";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$read",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_getReadAdapter",140],"(",")",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$select",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$read",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","select",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","from",141],"(",["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getMainTable",141],"(",")",",",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'count'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","where",141],"(",["T_CONSTANT_ENCAPSED_STRING","'type = ?'",141],",",["T_WHITESPACE"," ",141],["T_STRING","self",141],["T_DOUBLE_COLON","::",141],["T_STRING","TYPE_LOGIN",141],")",["T_WHITESPACE","\n            ",141],["T_OBJECT_OPERATOR","->",142],["T_STRING","where",142],"(",["T_CONSTANT_ENCAPSED_STRING","'value = ?'",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$login",142],")",";",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$read",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","fetchOne",143],"(",["T_VARIABLE","$select",143],")",";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Delete attempts with expired in update_at time\n     *\n     * @return void\n     *\/",146],["T_WHITESPACE","\n    ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","deleteOldAttempts",151],"(",")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_getWriteAdapter",153],"(",")",["T_OBJECT_OPERATOR","->",153],["T_STRING","delete",153],"(",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getMainTable",154],"(",")",",",["T_WHITESPACE","\n            ",154],["T_ARRAY","array",155],"(",["T_CONSTANT_ENCAPSED_STRING","'updated_at < ?'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_STRING","Mage",155],["T_DOUBLE_COLON","::",155],["T_STRING","getSingleton",155],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",155],")",["T_OBJECT_OPERATOR","->",155],["T_STRING","gmtDate",155],"(",["T_STRING","null",155],",",["T_WHITESPACE"," ",155],["T_STRING","time",155],"(",")",["T_WHITESPACE"," ",155],"-",["T_WHITESPACE"," ",155],["T_LNUMBER","60",155],"*",["T_LNUMBER","30",155],")",")",["T_WHITESPACE","\n        ",155],")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n",157],"}",["T_WHITESPACE","\n",158]]