[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Captcha\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Captcha Observer\n *\n * @category    Mage\n * @package     Mage_Captcha\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Captcha_Model_Observer",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Check Captcha On Forgot Password Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","checkForgotpassword",42],"(",["T_VARIABLE","$observer",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$formId",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'user_forgotpassword'",44],";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$captchaModel",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","Mage",45],["T_DOUBLE_COLON","::",45],["T_STRING","helper",45],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",45],")",["T_OBJECT_OPERATOR","->",45],["T_STRING","getCaptcha",45],"(",["T_VARIABLE","$formId",45],")",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$captchaModel",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","isRequired",46],"(",")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$controller",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$observer",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getControllerAction",47],"(",")",";",["T_WHITESPACE","\n            ",47],["T_IF","if",48],["T_WHITESPACE"," ",48],"(","!",["T_VARIABLE","$captchaModel",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","isCorrect",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_getCaptchaString",48],"(",["T_VARIABLE","$controller",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getRequest",48],"(",")",",",["T_WHITESPACE"," ",48],["T_VARIABLE","$formId",48],")",")",")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n                ",48],["T_STRING","Mage",49],["T_DOUBLE_COLON","::",49],["T_STRING","getSingleton",49],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","addError",49],"(",["T_STRING","Mage",49],["T_DOUBLE_COLON","::",49],["T_STRING","helper",49],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","__",49],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",49],")",")",";",["T_WHITESPACE","\n                ",49],["T_VARIABLE","$controller",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","setFlag",50],"(",["T_CONSTANT_ENCAPSED_STRING","''",50],",",["T_WHITESPACE"," ",50],["T_STRING","Mage_Core_Controller_Varien_Action",50],["T_DOUBLE_COLON","::",50],["T_STRING","FLAG_NO_DISPATCH",50],",",["T_WHITESPACE"," ",50],["T_STRING","true",50],")",";",["T_WHITESPACE","\n                ",50],["T_VARIABLE","$controller",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getResponse",51],"(",")",["T_OBJECT_OPERATOR","->",51],["T_STRING","setRedirect",51],"(",["T_STRING","Mage",51],["T_DOUBLE_COLON","::",51],["T_STRING","getUrl",51],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/forgotpassword'",51],")",")",";",["T_WHITESPACE","\n            ",51],"}",["T_WHITESPACE","\n        ",52],"}",["T_WHITESPACE","\n        ",53],["T_RETURN","return",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Check Captcha On User Login Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",57],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","checkUserLogin",63],"(",["T_VARIABLE","$observer",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$formId",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'user_login'",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$captchaModel",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Mage",66],["T_DOUBLE_COLON","::",66],["T_STRING","helper",66],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",66],")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getCaptcha",66],"(",["T_VARIABLE","$formId",66],")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$controller",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$observer",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getControllerAction",67],"(",")",";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$loginParams",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$controller",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getRequest",68],"(",")",["T_OBJECT_OPERATOR","->",68],["T_STRING","getPost",68],"(",["T_CONSTANT_ENCAPSED_STRING","'login'",68],")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$login",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ISSET","isset",69],"(",["T_VARIABLE","$loginParams",69],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",69],"]",")",["T_WHITESPACE"," ",69],"?",["T_WHITESPACE"," ",69],["T_VARIABLE","$loginParams",69],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",69],"]",["T_WHITESPACE"," ",69],":",["T_WHITESPACE"," ",69],["T_STRING","null",69],";",["T_WHITESPACE","\n        ",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$captchaModel",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","isRequired",70],"(",["T_VARIABLE","$login",70],")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$word",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_getCaptchaString",71],"(",["T_VARIABLE","$controller",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getRequest",71],"(",")",",",["T_WHITESPACE"," ",71],["T_VARIABLE","$formId",71],")",";",["T_WHITESPACE","\n            ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(","!",["T_VARIABLE","$captchaModel",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","isCorrect",72],"(",["T_VARIABLE","$word",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_STRING","Mage",73],["T_DOUBLE_COLON","::",73],["T_STRING","getSingleton",73],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",73],")",["T_OBJECT_OPERATOR","->",73],["T_STRING","addError",73],"(",["T_STRING","Mage",73],["T_DOUBLE_COLON","::",73],["T_STRING","helper",73],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",73],")",["T_OBJECT_OPERATOR","->",73],["T_STRING","__",73],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",73],")",")",";",["T_WHITESPACE","\n                ",73],["T_VARIABLE","$controller",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","setFlag",74],"(",["T_CONSTANT_ENCAPSED_STRING","''",74],",",["T_WHITESPACE"," ",74],["T_STRING","Mage_Core_Controller_Varien_Action",74],["T_DOUBLE_COLON","::",74],["T_STRING","FLAG_NO_DISPATCH",74],",",["T_WHITESPACE"," ",74],["T_STRING","true",74],")",";",["T_WHITESPACE","\n                ",74],["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","getSingleton",75],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","setUsername",75],"(",["T_VARIABLE","$login",75],")",";",["T_WHITESPACE","\n                ",75],["T_VARIABLE","$beforeUrl",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","Mage",76],["T_DOUBLE_COLON","::",76],["T_STRING","getSingleton",76],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",76],")",["T_OBJECT_OPERATOR","->",76],["T_STRING","getBeforeAuthUrl",76],"(",")",";",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$url",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE","  ",77],["T_VARIABLE","$beforeUrl",77],["T_WHITESPACE"," ",77],"?",["T_WHITESPACE"," ",77],["T_VARIABLE","$beforeUrl",77],["T_WHITESPACE"," ",77],":",["T_WHITESPACE"," ",77],["T_STRING","Mage",77],["T_DOUBLE_COLON","::",77],["T_STRING","helper",77],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getLoginUrl",77],"(",")",";",["T_WHITESPACE","\n                ",77],["T_VARIABLE","$controller",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getResponse",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","setRedirect",78],"(",["T_VARIABLE","$url",78],")",";",["T_WHITESPACE","\n            ",78],"}",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$captchaModel",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","logAttempt",81],"(",["T_VARIABLE","$login",81],")",";",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Check Captcha On Register User Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",85],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","checkUserCreate",91],"(",["T_VARIABLE","$observer",91],")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$formId",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'user_create'",93],";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$captchaModel",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","helper",94],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","getCaptcha",94],"(",["T_VARIABLE","$formId",94],")",";",["T_WHITESPACE","\n        ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$captchaModel",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","isRequired",95],"(",")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$controller",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$observer",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getControllerAction",96],"(",")",";",["T_WHITESPACE","\n            ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(","!",["T_VARIABLE","$captchaModel",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","isCorrect",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_getCaptchaString",97],"(",["T_VARIABLE","$controller",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getRequest",97],"(",")",",",["T_WHITESPACE"," ",97],["T_VARIABLE","$formId",97],")",")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n                ",97],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","getSingleton",98],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","addError",98],"(",["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","helper",98],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","__",98],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",98],")",")",";",["T_WHITESPACE","\n                ",98],["T_VARIABLE","$controller",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setFlag",99],"(",["T_CONSTANT_ENCAPSED_STRING","''",99],",",["T_WHITESPACE"," ",99],["T_STRING","Mage_Core_Controller_Varien_Action",99],["T_DOUBLE_COLON","::",99],["T_STRING","FLAG_NO_DISPATCH",99],",",["T_WHITESPACE"," ",99],["T_STRING","true",99],")",";",["T_WHITESPACE","\n                ",99],["T_STRING","Mage",100],["T_DOUBLE_COLON","::",100],["T_STRING","getSingleton",100],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",100],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","setCustomerFormData",100],"(",["T_VARIABLE","$controller",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getRequest",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","getPost",100],"(",")",")",";",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$controller",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getResponse",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","setRedirect",101],"(",["T_STRING","Mage",101],["T_DOUBLE_COLON","::",101],["T_STRING","getUrl",101],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/create'",101],")",")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Check Captcha On Checkout as Guest Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",107],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","checkGuestCheckout",113],"(",["T_VARIABLE","$observer",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$formId",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'guest_checkout'",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$captchaModel",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","Mage",116],["T_DOUBLE_COLON","::",116],["T_STRING","helper",116],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",116],")",["T_OBJECT_OPERATOR","->",116],["T_STRING","getCaptcha",116],"(",["T_VARIABLE","$formId",116],")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$checkoutMethod",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","Mage",117],["T_DOUBLE_COLON","::",117],["T_STRING","getSingleton",117],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/type_onepage'",117],")",["T_OBJECT_OPERATOR","->",117],["T_STRING","getQuote",117],"(",")",["T_OBJECT_OPERATOR","->",117],["T_STRING","getCheckoutMethod",117],"(",")",";",["T_WHITESPACE","\n        ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$checkoutMethod",118],["T_WHITESPACE"," ",118],["T_IS_EQUAL","==",118],["T_WHITESPACE"," ",118],["T_STRING","Mage_Checkout_Model_Type_Onepage",118],["T_DOUBLE_COLON","::",118],["T_STRING","METHOD_GUEST",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n            ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$captchaModel",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","isRequired",119],"(",")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                ",119],["T_VARIABLE","$controller",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$observer",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getControllerAction",120],"(",")",";",["T_WHITESPACE","\n                ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$captchaModel",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","isCorrect",121],"(",["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_getCaptchaString",121],"(",["T_VARIABLE","$controller",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getRequest",121],"(",")",",",["T_WHITESPACE"," ",121],["T_VARIABLE","$formId",121],")",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$controller",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setFlag",122],"(",["T_CONSTANT_ENCAPSED_STRING","''",122],",",["T_WHITESPACE"," ",122],["T_STRING","Mage_Core_Controller_Varien_Action",122],["T_DOUBLE_COLON","::",122],["T_STRING","FLAG_NO_DISPATCH",122],",",["T_WHITESPACE"," ",122],["T_STRING","true",122],")",";",["T_WHITESPACE","\n                    ",122],["T_VARIABLE","$result",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_ARRAY","array",123],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_LNUMBER","1",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'message'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_STRING","Mage",123],["T_DOUBLE_COLON","::",123],["T_STRING","helper",123],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",123],")",["T_OBJECT_OPERATOR","->",123],["T_STRING","__",123],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",123],")",")",";",["T_WHITESPACE","\n                    ",123],["T_VARIABLE","$controller",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getResponse",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","setBody",124],"(",["T_STRING","Mage",124],["T_DOUBLE_COLON","::",124],["T_STRING","helper",124],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","jsonEncode",124],"(",["T_VARIABLE","$result",124],")",")",";",["T_WHITESPACE","\n                ",124],"}",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Check Captcha On Checkout Register Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","checkRegisterCheckout",137],"(",["T_VARIABLE","$observer",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$formId",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'register_during_checkout'",139],";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$captchaModel",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","Mage",140],["T_DOUBLE_COLON","::",140],["T_STRING","helper",140],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",140],")",["T_OBJECT_OPERATOR","->",140],["T_STRING","getCaptcha",140],"(",["T_VARIABLE","$formId",140],")",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$checkoutMethod",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","getSingleton",141],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/type_onepage'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","getQuote",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","getCheckoutMethod",141],"(",")",";",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$checkoutMethod",142],["T_WHITESPACE"," ",142],["T_IS_EQUAL","==",142],["T_WHITESPACE"," ",142],["T_STRING","Mage_Checkout_Model_Type_Onepage",142],["T_DOUBLE_COLON","::",142],["T_STRING","METHOD_REGISTER",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$captchaModel",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","isRequired",143],"(",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$controller",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$observer",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getControllerAction",144],"(",")",";",["T_WHITESPACE","\n                ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(","!",["T_VARIABLE","$captchaModel",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","isCorrect",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getCaptchaString",145],"(",["T_VARIABLE","$controller",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getRequest",145],"(",")",",",["T_WHITESPACE"," ",145],["T_VARIABLE","$formId",145],")",")",")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n                    ",145],["T_VARIABLE","$controller",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","setFlag",146],"(",["T_CONSTANT_ENCAPSED_STRING","''",146],",",["T_WHITESPACE"," ",146],["T_STRING","Mage_Core_Controller_Varien_Action",146],["T_DOUBLE_COLON","::",146],["T_STRING","FLAG_NO_DISPATCH",146],",",["T_WHITESPACE"," ",146],["T_STRING","true",146],")",";",["T_WHITESPACE","\n                    ",146],["T_VARIABLE","$result",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_ARRAY","array",147],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_LNUMBER","1",147],",",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'message'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_STRING","Mage",147],["T_DOUBLE_COLON","::",147],["T_STRING","helper",147],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",147],")",["T_OBJECT_OPERATOR","->",147],["T_STRING","__",147],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",147],")",")",";",["T_WHITESPACE","\n                    ",147],["T_VARIABLE","$controller",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getResponse",148],"(",")",["T_OBJECT_OPERATOR","->",148],["T_STRING","setBody",148],"(",["T_STRING","Mage",148],["T_DOUBLE_COLON","::",148],["T_STRING","helper",148],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",148],")",["T_OBJECT_OPERATOR","->",148],["T_STRING","jsonEncode",148],"(",["T_VARIABLE","$result",148],")",")",";",["T_WHITESPACE","\n                ",148],"}",["T_WHITESPACE","\n            ",149],"}",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n        ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Check Captcha On User Login Backend Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",155],["T_WHITESPACE","\n    ",160],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","checkUserLoginBackend",161],"(",["T_VARIABLE","$observer",161],")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$formId",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'backend_login'",163],";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$captchaModel",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","Mage",164],["T_DOUBLE_COLON","::",164],["T_STRING","helper",164],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",164],")",["T_OBJECT_OPERATOR","->",164],["T_STRING","getCaptcha",164],"(",["T_VARIABLE","$formId",164],")",";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$loginParams",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","Mage",165],["T_DOUBLE_COLON","::",165],["T_STRING","app",165],"(",")",["T_OBJECT_OPERATOR","->",165],["T_STRING","getRequest",165],"(",")",["T_OBJECT_OPERATOR","->",165],["T_STRING","getPost",165],"(",["T_CONSTANT_ENCAPSED_STRING","'login'",165],",",["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",")",")",";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$login",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","array_key_exists",166],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$loginParams",166],")",["T_WHITESPACE"," ",166],"?",["T_WHITESPACE"," ",166],["T_VARIABLE","$loginParams",166],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",166],"]",["T_WHITESPACE"," ",166],":",["T_WHITESPACE"," ",166],["T_STRING","null",166],";",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$captchaModel",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","isRequired",167],"(",["T_VARIABLE","$login",167],")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_IF","if",168],["T_WHITESPACE"," ",168],"(","!",["T_VARIABLE","$captchaModel",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","isCorrect",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_getCaptchaString",168],"(",["T_STRING","Mage",168],["T_DOUBLE_COLON","::",168],["T_STRING","app",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","getRequest",168],"(",")",",",["T_WHITESPACE"," ",168],["T_VARIABLE","$formId",168],")",")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n                ",168],["T_VARIABLE","$captchaModel",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","logAttempt",169],"(",["T_VARIABLE","$login",169],")",";",["T_WHITESPACE","\n                ",169],["T_STRING","Mage",170],["T_DOUBLE_COLON","::",170],["T_STRING","throwException",170],"(",["T_STRING","Mage",170],["T_DOUBLE_COLON","::",170],["T_STRING","helper",170],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",170],")",["T_OBJECT_OPERATOR","->",170],["T_STRING","__",170],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",170],")",")",";",["T_WHITESPACE","\n            ",170],"}",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$captchaModel",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","logAttempt",173],"(",["T_VARIABLE","$login",173],")",";",["T_WHITESPACE","\n        ",173],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Returns backend session\n     *\n     * @return Mage_Adminhtml_Model_Session\n     *\/",177],["T_WHITESPACE","\n    ",181],["T_PROTECTED","protected",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","_getBackendSession",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_STRING","Mage",184],["T_DOUBLE_COLON","::",184],["T_STRING","getSingleton",184],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",184],")",";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Check Captcha On User Login Backend Page\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",187],["T_WHITESPACE","\n    ",192],["T_PUBLIC","public",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","checkUserForgotPasswordBackend",193],"(",["T_VARIABLE","$observer",193],")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$formId",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'backend_forgotpassword'",195],";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$captchaModel",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","helper",196],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",196],")",["T_OBJECT_OPERATOR","->",196],["T_STRING","getCaptcha",196],"(",["T_VARIABLE","$formId",196],")",";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$controller",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$observer",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getControllerAction",197],"(",")",";",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$email",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING_CAST","(string)",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$observer",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getControllerAction",198],"(",")",["T_OBJECT_OPERATOR","->",198],["T_STRING","getRequest",198],"(",")",["T_OBJECT_OPERATOR","->",198],["T_STRING","getParam",198],"(",["T_CONSTANT_ENCAPSED_STRING","'email'",198],")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$params",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$observer",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getControllerAction",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getRequest",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getParams",199],"(",")",";",["T_WHITESPACE","\n\n        ",199],["T_IF","if",201],["T_WHITESPACE"," ",201],"(","!",["T_EMPTY","empty",201],"(",["T_VARIABLE","$email",201],")",["T_WHITESPACE"," ",201],["T_BOOLEAN_AND","&&",201],["T_WHITESPACE"," ",201],"!",["T_EMPTY","empty",201],"(",["T_VARIABLE","$params",201],")",")","{",["T_WHITESPACE","\n            ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$captchaModel",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","isRequired",202],"(",")",")","{",["T_WHITESPACE","\n                ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(","!",["T_VARIABLE","$captchaModel",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","isCorrect",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_getCaptchaString",203],"(",["T_VARIABLE","$controller",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getRequest",203],"(",")",",",["T_WHITESPACE"," ",203],["T_VARIABLE","$formId",203],")",")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                    ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_getBackendSession",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","setEmail",204],"(",["T_STRING_CAST","(string)",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$controller",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getRequest",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getPost",204],"(",["T_CONSTANT_ENCAPSED_STRING","'email'",204],")",")",";",["T_WHITESPACE","\n                    ",204],["T_VARIABLE","$controller",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","setFlag",205],"(",["T_CONSTANT_ENCAPSED_STRING","''",205],",",["T_WHITESPACE"," ",205],["T_STRING","Mage_Core_Controller_Varien_Action",205],["T_DOUBLE_COLON","::",205],["T_STRING","FLAG_NO_DISPATCH",205],",",["T_WHITESPACE"," ",205],["T_STRING","true",205],")",";",["T_WHITESPACE","\n                    ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_getBackendSession",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","addError",206],"(",["T_STRING","Mage",206],["T_DOUBLE_COLON","::",206],["T_STRING","helper",206],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",206],")",["T_OBJECT_OPERATOR","->",206],["T_STRING","__",206],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect CAPTCHA.'",206],")",")",";",["T_WHITESPACE","\n                    ",206],["T_VARIABLE","$controller",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getResponse",207],"(",")",["T_OBJECT_OPERATOR","->",207],["T_STRING","setRedirect",207],"(",["T_STRING","Mage",207],["T_DOUBLE_COLON","::",207],["T_STRING","getUrl",207],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/forgotpassword'",207],")",")",";",["T_WHITESPACE","\n                ",207],"}",["T_WHITESPACE","\n            ",208],"}",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Reset Attempts For Frontend\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",214],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","resetAttemptForFrontend",220],"(",["T_VARIABLE","$observer",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_RETURN","return",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_resetAttempt",222],"(",["T_VARIABLE","$observer",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getModel",222],"(",")",["T_OBJECT_OPERATOR","->",222],["T_STRING","getEmail",222],"(",")",")",";",["T_WHITESPACE","\n    ",222],"}",["T_WHITESPACE","\n\n    ",223],["T_DOC_COMMENT","\/**\n     * Reset Attempts For Backend\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Captcha_Model_Observer\n     *\/",225],["T_WHITESPACE","\n    ",230],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","resetAttemptForBackend",231],"(",["T_VARIABLE","$observer",231],")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_RETURN","return",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_resetAttempt",233],"(",["T_VARIABLE","$observer",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getUser",233],"(",")",["T_OBJECT_OPERATOR","->",233],["T_STRING","getUsername",233],"(",")",")",";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * Delete Unnecessary logged attempts\n     *\n     * @return Mage_Captcha_Model_Observer\n     *\/",236],["T_WHITESPACE","\n    ",240],["T_PUBLIC","public",241],["T_WHITESPACE"," ",241],["T_FUNCTION","function",241],["T_WHITESPACE"," ",241],["T_STRING","deleteOldAttempts",241],"(",")",["T_WHITESPACE","\n    ",241],"{",["T_WHITESPACE","\n        ",242],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","getResourceModel",243],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha\/log'",243],")",["T_OBJECT_OPERATOR","->",243],["T_STRING","deleteOldAttempts",243],"(",")",";",["T_WHITESPACE","\n        ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Delete Expired Captcha Images\n     *\n     * @return Mage_Captcha_Model_Observer\n     *\/",247],["T_WHITESPACE","\n    ",251],["T_PUBLIC","public",252],["T_WHITESPACE"," ",252],["T_FUNCTION","function",252],["T_WHITESPACE"," ",252],["T_STRING","deleteExpiredImages",252],"(",")",["T_WHITESPACE","\n    ",252],"{",["T_WHITESPACE","\n        ",253],["T_FOREACH","foreach",254],["T_WHITESPACE"," ",254],"(",["T_STRING","Mage",254],["T_DOUBLE_COLON","::",254],["T_STRING","app",254],"(",")",["T_OBJECT_OPERATOR","->",254],["T_STRING","getWebsites",254],"(",["T_STRING","true",254],")",["T_WHITESPACE"," ",254],["T_AS","as",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$website",254],")","{",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$expire",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","time",255],"(",")",["T_WHITESPACE"," ",255],"-",["T_WHITESPACE"," ",255],["T_STRING","Mage",255],["T_DOUBLE_COLON","::",255],["T_STRING","helper",255],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",255],")",["T_OBJECT_OPERATOR","->",255],["T_STRING","getConfigNode",255],"(",["T_CONSTANT_ENCAPSED_STRING","'timeout'",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$website",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getDefaultStore",255],"(",")",")","*",["T_LNUMBER","60",255],";",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$imageDirectory",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_STRING","Mage",256],["T_DOUBLE_COLON","::",256],["T_STRING","helper",256],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha'",256],")",["T_OBJECT_OPERATOR","->",256],["T_STRING","getImgDir",256],"(",["T_VARIABLE","$website",256],")",";",["T_WHITESPACE","\n            ",256],["T_FOREACH","foreach",257],["T_WHITESPACE"," ",257],"(",["T_NEW","new",257],["T_WHITESPACE"," ",257],["T_STRING","DirectoryIterator",257],"(",["T_VARIABLE","$imageDirectory",257],")",["T_WHITESPACE"," ",257],["T_AS","as",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$file",257],")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n                ",257],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$file",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","isFile",258],"(",")",["T_WHITESPACE"," ",258],["T_BOOLEAN_AND","&&",258],["T_WHITESPACE"," ",258],["T_STRING","pathinfo",258],"(",["T_VARIABLE","$file",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getFilename",258],"(",")",",",["T_WHITESPACE"," ",258],["T_STRING","PATHINFO_EXTENSION",258],")",["T_WHITESPACE"," ",258],["T_IS_EQUAL","==",258],["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'png'",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                    ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$file",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getMTime",259],"(",")",["T_WHITESPACE"," ",259],"<",["T_WHITESPACE"," ",259],["T_VARIABLE","$expire",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n                        ",259],["T_STRING","unlink",260],"(",["T_VARIABLE","$file",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getPathname",260],"(",")",")",";",["T_WHITESPACE","\n                    ",260],"}",["T_WHITESPACE","\n                ",261],"}",["T_WHITESPACE","\n            ",262],"}",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n        ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],";",["T_WHITESPACE","\n    ",265],"}",["T_WHITESPACE","\n\n    ",266],["T_DOC_COMMENT","\/**\n     * Reset Attempts\n     *\n     * @param string $login\n     * @return Mage_Captcha_Model_Observer\n     *\/",268],["T_WHITESPACE","\n    ",273],["T_PROTECTED","protected",274],["T_WHITESPACE"," ",274],["T_FUNCTION","function",274],["T_WHITESPACE"," ",274],["T_STRING","_resetAttempt",274],"(",["T_VARIABLE","$login",274],")",["T_WHITESPACE","\n    ",274],"{",["T_WHITESPACE","\n        ",275],["T_STRING","Mage",276],["T_DOUBLE_COLON","::",276],["T_STRING","getResourceModel",276],"(",["T_CONSTANT_ENCAPSED_STRING","'captcha\/log'",276],")",["T_OBJECT_OPERATOR","->",276],["T_STRING","deleteUserAttempts",276],"(",["T_VARIABLE","$login",276],")",";",["T_WHITESPACE","\n        ",276],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * Get Captcha String\n     *\n     * @param Varien_Object $request\n     * @param string $formId\n     * @return string\n     *\/",280],["T_WHITESPACE","\n    ",286],["T_PROTECTED","protected",287],["T_WHITESPACE"," ",287],["T_FUNCTION","function",287],["T_WHITESPACE"," ",287],["T_STRING","_getCaptchaString",287],"(",["T_VARIABLE","$request",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$formId",287],")",["T_WHITESPACE","\n    ",287],"{",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$captchaParams",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$request",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","getPost",289],"(",["T_STRING","Mage_Captcha_Helper_Data",289],["T_DOUBLE_COLON","::",289],["T_STRING","INPUT_NAME_FIELD_VALUE",289],")",";",["T_WHITESPACE","\n        ",289],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$captchaParams",290],"[",["T_VARIABLE","$formId",290],"]",";",["T_WHITESPACE","\n    ",290],"}",["T_WHITESPACE","\n",291],"}",["T_WHITESPACE","\n",292]]