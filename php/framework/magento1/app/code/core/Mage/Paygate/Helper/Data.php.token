[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Paygate\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Paygate data helper\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Paygate_Helper_Data",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Helper_Abstract",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * Converts a lot of messages to message\n     *\n     * @param  array $messages\n     * @return string\n     *\/",32],["T_WHITESPACE","\n    ",37],["T_PUBLIC","public",38],["T_WHITESPACE"," ",38],["T_FUNCTION","function",38],["T_WHITESPACE"," ",38],["T_STRING","convertMessagesToMessage",38],"(",["T_VARIABLE","$messages",38],")",["T_WHITESPACE","\n    ",38],"{",["T_WHITESPACE","\n        ",39],["T_RETURN","return",40],["T_WHITESPACE"," ",40],["T_STRING","implode",40],"(",["T_CONSTANT_ENCAPSED_STRING","' | '",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$messages",40],")",";",["T_WHITESPACE","\n    ",40],"}",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Return message for gateway transaction request\n     *\n     * @param  Mage_Payment_Model_Info $payment\n     * @param  string $requestType\n     * @param  string $lastTransactionId\n     * @param  Varien_Object $card\n     * @param float $amount\n     * @param string $exception\n     * @return bool|string\n     *\/",43],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","getTransactionMessage",54],"(",["T_VARIABLE","$payment",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$requestType",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$lastTransactionId",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$card",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$amount",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","false",54],",",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$exception",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","false",55],["T_WHITESPACE","\n    ",55],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n        ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getExtendedTransactionMessage",57],"(",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$payment",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$requestType",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$lastTransactionId",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$card",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$amount",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$exception",58],["T_WHITESPACE","\n        ",58],")",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Return message for gateway transaction request\n     *\n     * @param  Mage_Payment_Model_Info $payment\n     * @param  string $requestType\n     * @param  string $lastTransactionId\n     * @param  Varien_Object $card\n     * @param float $amount\n     * @param string $exception\n     * @param string $additionalMessage Custom message, which will be added to the end of generated message\n     * @return bool|string\n     *\/",62],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","getExtendedTransactionMessage",74],"(",["T_VARIABLE","$payment",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$requestType",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$lastTransactionId",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$card",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$amount",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","false",74],",",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$exception",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","false",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$additionalMessage",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","false",75],["T_WHITESPACE","\n    ",75],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$operation",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_getOperation",77],"(",["T_VARIABLE","$requestType",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_IF","if",79],["T_WHITESPACE"," ",79],"(","!",["T_VARIABLE","$operation",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_STRING","false",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$amount",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$amount",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","__",84],"(",["T_CONSTANT_ENCAPSED_STRING","'amount %s'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_formatPrice",84],"(",["T_VARIABLE","$payment",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$amount",84],")",")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n\n        ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$exception",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$result",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","__",88],"(",["T_CONSTANT_ENCAPSED_STRING","'failed'",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE"," ",89],["T_ELSE","else",89],["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$result",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","__",90],"(",["T_CONSTANT_ENCAPSED_STRING","'successful'",90],")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$card",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","__",93],"(",["T_CONSTANT_ENCAPSED_STRING","'Credit Card: xxxx-%s'",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$card",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getCcLast4",93],"(",")",")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$pattern",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'%s %s %s - %s.'",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$texts",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_VARIABLE","$card",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$amount",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$operation",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$result",96],")",";",["T_WHITESPACE","\n\n        ",96],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_STRING","is_null",98],"(",["T_VARIABLE","$lastTransactionId",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$pattern",99],["T_WHITESPACE"," ",99],["T_CONCAT_EQUAL",".=",99],["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","' %s.'",99],";",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$texts",100],"[","]",["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","__",100],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorize.Net Transaction ID %s'",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$lastTransactionId",100],")",";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n\n        ",101],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$additionalMessage",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$pattern",104],["T_WHITESPACE"," ",104],["T_CONCAT_EQUAL",".=",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","' %s.'",104],";",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$texts",105],"[","]",["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$additionalMessage",105],";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$pattern",107],["T_WHITESPACE"," ",107],["T_CONCAT_EQUAL",".=",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","' %s'",107],";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$texts",108],"[","]",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$exception",108],";",["T_WHITESPACE","\n\n        ",108],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_STRING","call_user_func_array",110],"(",["T_ARRAY","array",110],"(",["T_VARIABLE","$this",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'__'",110],")",",",["T_WHITESPACE"," ",110],["T_STRING","array_merge",110],"(",["T_ARRAY","array",110],"(",["T_VARIABLE","$pattern",110],")",",",["T_WHITESPACE"," ",110],["T_VARIABLE","$texts",110],")",")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Return operation name for request type\n     *\n     * @param  string $requestType\n     * @return bool|string\n     *\/",113],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","_getOperation",119],"(",["T_VARIABLE","$requestType",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_SWITCH","switch",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$requestType",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_CASE","case",122],["T_WHITESPACE"," ",122],["T_STRING","Mage_Paygate_Model_Authorizenet",122],["T_DOUBLE_COLON","::",122],["T_STRING","REQUEST_TYPE_AUTH_ONLY",122],":",["T_WHITESPACE","\n                ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","__",123],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize'",123],")",";",["T_WHITESPACE","\n            ",123],["T_CASE","case",124],["T_WHITESPACE"," ",124],["T_STRING","Mage_Paygate_Model_Authorizenet",124],["T_DOUBLE_COLON","::",124],["T_STRING","REQUEST_TYPE_AUTH_CAPTURE",124],":",["T_WHITESPACE","\n                ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","__",125],"(",["T_CONSTANT_ENCAPSED_STRING","'authorize and capture'",125],")",";",["T_WHITESPACE","\n            ",125],["T_CASE","case",126],["T_WHITESPACE"," ",126],["T_STRING","Mage_Paygate_Model_Authorizenet",126],["T_DOUBLE_COLON","::",126],["T_STRING","REQUEST_TYPE_PRIOR_AUTH_CAPTURE",126],":",["T_WHITESPACE","\n                ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","__",127],"(",["T_CONSTANT_ENCAPSED_STRING","'capture'",127],")",";",["T_WHITESPACE","\n            ",127],["T_CASE","case",128],["T_WHITESPACE"," ",128],["T_STRING","Mage_Paygate_Model_Authorizenet",128],["T_DOUBLE_COLON","::",128],["T_STRING","REQUEST_TYPE_CREDIT",128],":",["T_WHITESPACE","\n                ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","__",129],"(",["T_CONSTANT_ENCAPSED_STRING","'refund'",129],")",";",["T_WHITESPACE","\n            ",129],["T_CASE","case",130],["T_WHITESPACE"," ",130],["T_STRING","Mage_Paygate_Model_Authorizenet",130],["T_DOUBLE_COLON","::",130],["T_STRING","REQUEST_TYPE_VOID",130],":",["T_WHITESPACE","\n                ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","__",131],"(",["T_CONSTANT_ENCAPSED_STRING","'void'",131],")",";",["T_WHITESPACE","\n            ",131],["T_DEFAULT","default",132],":",["T_WHITESPACE","\n                ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_STRING","false",133],";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Format price with currency sign\n     * @param  Mage_Payment_Model_Info $payment\n     * @param float $amount\n     * @return string\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PROTECTED","protected",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","_formatPrice",143],"(",["T_VARIABLE","$payment",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$amount",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$payment",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getOrder",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","getBaseCurrency",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","formatTxt",145],"(",["T_VARIABLE","$amount",145],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n",146],"}",["T_WHITESPACE","\n",147]]