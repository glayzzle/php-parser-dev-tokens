[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Category flat model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Category_Flat",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Index_Model_Resource_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Amount of categories to be processed in batch\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","CATEGORY_BATCH",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_LNUMBER","500",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Store id\n     *\n     * @var int\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_storeId",47],["T_WHITESPACE","                  ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Loaded\n     *\n     * @var boolean\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_loaded",54],["T_WHITESPACE","                   ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","false",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Nodes\n     *\n     * @var array\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_nodes",61],["T_WHITESPACE","                    ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Columns\n     *\n     * @var array\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_columns",68],["T_WHITESPACE","                  ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","null",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Columns sql\n     *\n     * @var array\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_columnsSql",75],["T_WHITESPACE","               ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","null",75],";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Attribute codes\n     *\n     * @var array\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PROTECTED","protected",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$_attributeCodes",82],["T_WHITESPACE","           ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","null",82],";",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Inactive categories ids\n     *\n     * @var array\n     *\/",84],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$_inactiveCategoryIds",89],["T_WHITESPACE","      ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","null",89],";",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Store flag which defines if Catalog Category Flat Data has been initialized\n     *\n     * @var array\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$_isBuilt",96],["T_WHITESPACE","                  ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",";",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Store flag which defines if Catalog Category Flat Data has been initialized\n     *\n     * @deprecated after 1.7.0.0 use $this->_isBuilt instead\n     *\n     * @var bool|null\n     *\/",98],["T_WHITESPACE","\n    ",104],["T_PROTECTED","protected",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$_isRebuilt",105],["T_WHITESPACE","                ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","null",105],";",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * array with root category id per store\n     *\n     * @var array\n     *\/",107],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$_storesRootCategories",112],";",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Whether table changes are allowed\n     *\n     * @var bool\n     *\/",114],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$_allowTableChanges",119],["T_WHITESPACE","        ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","true",119],";",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Factory instance\n     *\n     * @var Mage_Catalog_Model_Factory\n     *\/",121],["T_WHITESPACE","\n    ",125],["T_PROTECTED","protected",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$_factory",126],";",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Initialize factory instance\n     *\n     * @param array $args\n     *\/",128],["T_WHITESPACE","\n    ",132],["T_PUBLIC","public",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","__construct",133],"(",["T_ARRAY","array",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$args",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",")",")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_factory",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],"!",["T_EMPTY","empty",135],"(",["T_VARIABLE","$args",135],"[",["T_CONSTANT_ENCAPSED_STRING","'factory'",135],"]",")",["T_WHITESPACE"," ",135],"?",["T_WHITESPACE"," ",135],["T_VARIABLE","$args",135],"[",["T_CONSTANT_ENCAPSED_STRING","'factory'",135],"]",["T_WHITESPACE"," ",135],":",["T_WHITESPACE"," ",135],["T_STRING","Mage",135],["T_DOUBLE_COLON","::",135],["T_STRING","getSingleton",135],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/factory'",135],")",";",["T_WHITESPACE","\n        ",135],["T_STRING","parent",136],["T_DOUBLE_COLON","::",136],["T_STRING","__construct",136],"(",")",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Resource initializations\n     *\n     *\/",139],["T_WHITESPACE","\n    ",142],["T_PROTECTED","protected",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","_construct",143],"(",")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_init",145],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",145],",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",145],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Set store id\n     *\n     * @param integer $storeId\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",148],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","setStoreId",154],"(",["T_VARIABLE","$storeId",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_storeId",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_INT_CAST","(int)",156],["T_VARIABLE","$storeId",156],";",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Return store id\n     *\n     * @return integer\n     *\/",160],["T_WHITESPACE","\n    ",164],["T_PUBLIC","public",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","getStoreId",165],"(",")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_STRING","is_null",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_storeId",167],")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_INT_CAST","(int)",168],["T_STRING","Mage",168],["T_DOUBLE_COLON","::",168],["T_STRING","app",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","getStore",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","getId",168],"(",")",";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n        ",169],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_storeId",170],";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * Get main table name\n     *\n     * @return string\n     *\/",173],["T_WHITESPACE","\n    ",177],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","getMainTable",178],"(",")",["T_WHITESPACE","\n    ",178],"{",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getMainStoreTable",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getStoreId",180],"(",")",")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Return name of table for given $storeId.\n     *\n     * @param integer $storeId\n     * @return string\n     *\/",183],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","getMainStoreTable",189],"(",["T_VARIABLE","$storeId",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","Mage_Catalog_Model_Abstract",189],["T_DOUBLE_COLON","::",189],["T_STRING","DEFAULT_STORE_ID",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_STRING","is_string",191],"(",["T_VARIABLE","$storeId",191],")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$storeId",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","intval",192],"(",["T_VARIABLE","$storeId",192],")",";",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n        ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getUseStoreTables",194],"(",")",["T_WHITESPACE"," ",194],["T_BOOLEAN_AND","&&",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$storeId",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$suffix",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_STRING","sprintf",195],"(",["T_CONSTANT_ENCAPSED_STRING","'store_%d'",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$storeId",195],")",";",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$table",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getTable",196],"(",["T_ARRAY","array",196],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$suffix",196],")",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE"," ",197],["T_ELSE","else",197],["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$table",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","parent",198],["T_DOUBLE_COLON","::",198],["T_STRING","getMainTable",198],"(",")",";",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE","\n\n        ",199],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$table",201],";",["T_WHITESPACE","\n    ",201],"}",["T_WHITESPACE","\n\n    ",202],["T_DOC_COMMENT","\/**\n     * Return true if need use for each store different table of flat categories data.\n     *\n     * @return boolean\n     *\/",204],["T_WHITESPACE","\n    ",208],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","getUseStoreTables",209],"(",")",["T_WHITESPACE","\n    ",209],"{",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_STRING","true",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Add inactive categories ids\n     *\n     * @param array $ids\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",214],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","addInactiveCategoryIds",220],"(",["T_VARIABLE","$ids",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(","!",["T_STRING","is_array",222],"(",["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_inactiveCategoryIds",222],")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_initInactiveCategoryIds",223],"(",")",";",["T_WHITESPACE","\n        ",223],"}",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_inactiveCategoryIds",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_STRING","array_merge",225],"(",["T_VARIABLE","$ids",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_inactiveCategoryIds",225],")",";",["T_WHITESPACE","\n        ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Retreive inactive categories ids\n     *\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",229],["T_WHITESPACE","\n    ",233],["T_PROTECTED","protected",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","_initInactiveCategoryIds",234],"(",")",["T_WHITESPACE","\n    ",234],"{",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_inactiveCategoryIds",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_ARRAY","array",236],"(",")",";",["T_WHITESPACE","\n        ",236],["T_STRING","Mage",237],["T_DOUBLE_COLON","::",237],["T_STRING","dispatchEvent",237],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_init_inactive_category_ids'",237],",",["T_WHITESPACE"," ",237],["T_ARRAY","array",237],"(",["T_CONSTANT_ENCAPSED_STRING","'tree'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],")",")",";",["T_WHITESPACE","\n        ",237],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Retreive inactive categories ids\n     *\n     * @return array\n     *\/",241],["T_WHITESPACE","\n    ",245],["T_PUBLIC","public",246],["T_WHITESPACE"," ",246],["T_FUNCTION","function",246],["T_WHITESPACE"," ",246],["T_STRING","getInactiveCategoryIds",246],"(",")",["T_WHITESPACE","\n    ",246],"{",["T_WHITESPACE","\n        ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(","!",["T_STRING","is_array",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_inactiveCategoryIds",248],")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_initInactiveCategoryIds",249],"(",")",";",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n\n        ",250],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_inactiveCategoryIds",252],";",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Load nodes by parent id\n     *\n     * @param Mage_Catalog_Model_Category|int $parentNode\n     * @param integer $recursionLevel\n     * @param integer $storeId\n     * @param bool $onlyActive\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",255],["T_WHITESPACE","\n    ",263],["T_PROTECTED","protected",264],["T_WHITESPACE"," ",264],["T_FUNCTION","function",264],["T_WHITESPACE"," ",264],["T_STRING","_loadNodes",264],"(",["T_VARIABLE","$parentNode",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_STRING","null",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$recursionLevel",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_LNUMBER","0",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$storeId",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_LNUMBER","0",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$onlyActive",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_STRING","true",264],")",["T_WHITESPACE","\n    ",264],"{",["T_WHITESPACE","\n        ",265],["T_VARIABLE","$_conn",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_getReadAdapter",266],"(",")",";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$startLevel",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_LNUMBER","1",267],";",["T_WHITESPACE","\n        ",267],["T_VARIABLE","$parentPath",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_CONSTANT_ENCAPSED_STRING","''",268],";",["T_WHITESPACE","\n        ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$parentNode",269],["T_WHITESPACE"," ",269],["T_INSTANCEOF","instanceof",269],["T_WHITESPACE"," ",269],["T_STRING","Mage_Catalog_Model_Category",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$parentPath",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$parentNode",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getPath",270],"(",")",";",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$startLevel",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$parentNode",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getLevel",271],"(",")",";",["T_WHITESPACE","\n        ",271],"}",["T_WHITESPACE"," ",272],["T_ELSEIF","elseif",272],["T_WHITESPACE"," ",272],"(",["T_STRING","is_numeric",272],"(",["T_VARIABLE","$parentNode",272],")",")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$selectParent",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$_conn",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","select",273],"(",")",["T_WHITESPACE","\n                ",273],["T_OBJECT_OPERATOR","->",274],["T_STRING","from",274],"(",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getMainStoreTable",274],"(",["T_VARIABLE","$storeId",274],")",")",["T_WHITESPACE","\n                ",274],["T_OBJECT_OPERATOR","->",275],["T_STRING","where",275],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$parentNode",275],")",["T_WHITESPACE","\n                ",275],["T_OBJECT_OPERATOR","->",276],["T_STRING","where",276],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id = ?'",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$storeId",276],")",";",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$parentNode",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$_conn",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","fetchRow",277],"(",["T_VARIABLE","$selectParent",277],")",";",["T_WHITESPACE","\n            ",277],["T_IF","if",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$parentNode",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n                ",278],["T_VARIABLE","$parentPath",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$parentNode",279],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",279],"]",";",["T_WHITESPACE","\n                ",279],["T_VARIABLE","$startLevel",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_VARIABLE","$parentNode",280],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",280],"]",";",["T_WHITESPACE","\n            ",280],"}",["T_WHITESPACE","\n        ",281],"}",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$select",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$_conn",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","select",283],"(",")",["T_WHITESPACE","\n            ",283],["T_OBJECT_OPERATOR","->",284],["T_STRING","from",284],"(",["T_WHITESPACE","\n                ",284],["T_ARRAY","array",285],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",285],["T_WHITESPACE"," ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getMainStoreTable",285],"(",["T_VARIABLE","$storeId",285],")",")",",",["T_WHITESPACE","\n                ",285],["T_ARRAY","array",286],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",286],",",["T_WHITESPACE","\n                    ",286],["T_NEW","new",287],["T_WHITESPACE"," ",287],["T_STRING","Zend_Db_Expr",287],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.'",287],["T_WHITESPACE"," ",287],".",["T_WHITESPACE"," ",287],["T_VARIABLE","$_conn",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","quoteIdentifier",287],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",287],")",")",",",["T_WHITESPACE","\n                    ",287],["T_NEW","new",288],["T_WHITESPACE"," ",288],["T_STRING","Zend_Db_Expr",288],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.'",288],["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_VARIABLE","$_conn",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","quoteIdentifier",288],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",288],")",")",",",["T_WHITESPACE","\n                    ",288],["T_CONSTANT_ENCAPSED_STRING","'is_active'",289],",",["T_WHITESPACE","\n                    ",289],["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",290],")",")",["T_WHITESPACE","\n\n            ",290],["T_OBJECT_OPERATOR","->",292],["T_STRING","where",292],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.include_in_menu = ?'",292],",",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'1'",292],")",["T_WHITESPACE","\n            ",292],["T_OBJECT_OPERATOR","->",293],["T_STRING","order",293],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.position'",293],")",";",["T_WHITESPACE","\n\n        ",293],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_VARIABLE","$onlyActive",295],")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$select",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","where",296],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.is_active = ?'",296],",",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'1'",296],")",";",["T_WHITESPACE","\n        ",296],"}",["T_WHITESPACE","\n\n        ",297],["T_DOC_COMMENT","\/** @var $urlRewrite Mage_Catalog_Helper_Category_Url_Rewrite_Interface *\/",299],["T_WHITESPACE","\n        ",299],["T_VARIABLE","$urlRewrite",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_factory",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","getCategoryUrlRewriteHelper",300],"(",")",";",["T_WHITESPACE","\n        ",300],["T_VARIABLE","$urlRewrite",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","joinTableToSelect",301],"(",["T_VARIABLE","$select",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$storeId",301],")",";",["T_WHITESPACE","\n\n        ",301],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$parentPath",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$select",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","where",304],"(",["T_VARIABLE","$_conn",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","quoteInto",304],"(",["T_CONSTANT_ENCAPSED_STRING","\"main_table.path like ?\"",304],",",["T_WHITESPACE"," ",304],"\"",["T_VARIABLE","$parentPath",304],["T_ENCAPSED_AND_WHITESPACE","\/%",304],"\"",")",")",";",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_VARIABLE","$recursionLevel",306],["T_WHITESPACE"," ",306],["T_IS_NOT_EQUAL","!=",306],["T_WHITESPACE"," ",306],["T_LNUMBER","0",306],")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_VARIABLE","$levelField",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$_conn",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","quoteIdentifier",307],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",307],")",";",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$select",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","where",308],"(",["T_VARIABLE","$levelField",308],["T_WHITESPACE"," ",308],".",["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","' <= ?'",308],",",["T_WHITESPACE"," ",308],["T_VARIABLE","$startLevel",308],["T_WHITESPACE"," ",308],"+",["T_WHITESPACE"," ",308],["T_VARIABLE","$recursionLevel",308],")",";",["T_WHITESPACE","\n        ",308],"}",["T_WHITESPACE","\n\n        ",309],["T_VARIABLE","$inactiveCategories",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getInactiveCategoryIds",311],"(",")",";",["T_WHITESPACE","\n\n        ",311],["T_IF","if",313],["T_WHITESPACE"," ",313],"(","!",["T_EMPTY","empty",313],"(",["T_VARIABLE","$inactiveCategories",313],")",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n            ",313],["T_VARIABLE","$select",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","where",314],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id NOT IN (?)'",314],",",["T_WHITESPACE"," ",314],["T_VARIABLE","$inactiveCategories",314],")",";",["T_WHITESPACE","\n        ",314],"}",["T_WHITESPACE","\n\n        ",315],["T_COMMENT","\/\/ Allow extensions to modify select (e.g. add custom category attributes to select)\n",317],["T_WHITESPACE","        ",318],["T_STRING","Mage",318],["T_DOUBLE_COLON","::",318],["T_STRING","dispatchEvent",318],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_loadnodes_before'",318],",",["T_WHITESPACE"," ",318],["T_ARRAY","array",318],"(",["T_CONSTANT_ENCAPSED_STRING","'select'",318],["T_WHITESPACE"," ",318],["T_DOUBLE_ARROW","=>",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$select",318],")",")",";",["T_WHITESPACE","\n\n        ",318],["T_VARIABLE","$arrNodes",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$_conn",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","fetchAll",320],"(",["T_VARIABLE","$select",320],")",";",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$nodes",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_ARRAY","array",321],"(",")",";",["T_WHITESPACE","\n        ",321],["T_FOREACH","foreach",322],["T_WHITESPACE"," ",322],"(",["T_VARIABLE","$arrNodes",322],["T_WHITESPACE"," ",322],["T_AS","as",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$node",322],")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$node",323],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",323],"]",["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_VARIABLE","$node",323],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",323],"]",";",["T_WHITESPACE","\n            ",323],["T_VARIABLE","$nodes",324],"[",["T_VARIABLE","$node",324],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",324],"]","]",["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_STRING","Mage",324],["T_DOUBLE_COLON","::",324],["T_STRING","getModel",324],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",324],")",["T_OBJECT_OPERATOR","->",324],["T_STRING","setData",324],"(",["T_VARIABLE","$node",324],")",";",["T_WHITESPACE","\n        ",324],"}",["T_WHITESPACE","\n\n        ",325],["T_RETURN","return",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$nodes",327],";",["T_WHITESPACE","\n    ",327],"}",["T_WHITESPACE","\n\n    ",328],["T_DOC_COMMENT","\/**\n     * Creating sorted array of nodes\n     *\n     * @param array $children\n     * @param string $path\n     * @param Varien_Object $parent\n     *\/",330],["T_WHITESPACE","\n    ",336],["T_PUBLIC","public",337],["T_WHITESPACE"," ",337],["T_FUNCTION","function",337],["T_WHITESPACE"," ",337],["T_STRING","addChildNodes",337],"(",["T_VARIABLE","$children",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$path",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$parent",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_ISSET","isset",339],"(",["T_VARIABLE","$children",339],"[",["T_VARIABLE","$path",339],"]",")",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_FOREACH","foreach",340],["T_WHITESPACE"," ",340],"(",["T_VARIABLE","$children",340],"[",["T_VARIABLE","$path",340],"]",["T_WHITESPACE"," ",340],["T_AS","as",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$child",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n                ",340],["T_VARIABLE","$childrenNodes",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$parent",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","getChildrenNodes",341],"(",")",";",["T_WHITESPACE","\n                ",341],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$childrenNodes",342],["T_WHITESPACE"," ",342],["T_BOOLEAN_AND","&&",342],["T_WHITESPACE"," ",342],["T_ISSET","isset",342],"(",["T_VARIABLE","$childrenNodes",342],"[",["T_VARIABLE","$child",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getId",342],"(",")","]",")",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                    ",342],["T_VARIABLE","$childrenNodes",343],"[",["T_VARIABLE","$child",343],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",343],"]","]",["T_OBJECT_OPERATOR","->",343],["T_STRING","setChildrenNodes",343],"(",["T_ARRAY","array",343],"(",["T_VARIABLE","$child",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getId",343],"(",")",["T_DOUBLE_ARROW","=>",343],["T_VARIABLE","$child",343],")",")",";",["T_WHITESPACE","\n                ",343],"}",["T_WHITESPACE"," ",344],["T_ELSE","else",344],["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                    ",344],["T_IF","if",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$childrenNodes",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n                        ",345],["T_VARIABLE","$childrenNodes",346],"[",["T_VARIABLE","$child",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getId",346],"(",")","]",["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_VARIABLE","$child",346],";",["T_WHITESPACE","\n                    ",346],"}",["T_WHITESPACE"," ",347],["T_ELSE","else",347],["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n                        ",347],["T_VARIABLE","$childrenNodes",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_ARRAY","array",348],"(",["T_VARIABLE","$child",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getId",348],"(",")",["T_DOUBLE_ARROW","=>",348],["T_VARIABLE","$child",348],")",";",["T_WHITESPACE","\n                    ",348],"}",["T_WHITESPACE","\n                    ",349],["T_VARIABLE","$parent",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","setChildrenNodes",350],"(",["T_VARIABLE","$childrenNodes",350],")",";",["T_WHITESPACE","\n                ",350],"}",["T_WHITESPACE","\n\n                ",351],["T_IF","if",353],["T_WHITESPACE"," ",353],"(",["T_VARIABLE","$path",353],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n                    ",353],["T_VARIABLE","$childrenPath",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_STRING","explode",354],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",354],",",["T_WHITESPACE"," ",354],["T_VARIABLE","$path",354],")",";",["T_WHITESPACE","\n                ",354],"}",["T_WHITESPACE"," ",355],["T_ELSE","else",355],["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                    ",355],["T_VARIABLE","$childrenPath",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_ARRAY","array",356],"(",")",";",["T_WHITESPACE","\n                ",356],"}",["T_WHITESPACE","\n                ",357],["T_VARIABLE","$childrenPath",358],"[","]",["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$child",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","getId",358],"(",")",";",["T_WHITESPACE","\n                ",358],["T_VARIABLE","$childrenPath",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_STRING","implode",359],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",359],",",["T_WHITESPACE"," ",359],["T_VARIABLE","$childrenPath",359],")",";",["T_WHITESPACE","\n                ",359],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","addChildNodes",360],"(",["T_VARIABLE","$children",360],",",["T_WHITESPACE"," ",360],["T_VARIABLE","$childrenPath",360],",",["T_WHITESPACE"," ",360],["T_VARIABLE","$child",360],")",";",["T_WHITESPACE","\n            ",360],"}",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Return sorted array of nodes\n     *\n     * @param integer|null $parentId\n     * @param integer $recursionLevel\n     * @param integer $storeId\n     * @return array\n     *\/",365],["T_WHITESPACE","\n    ",372],["T_PUBLIC","public",373],["T_WHITESPACE"," ",373],["T_FUNCTION","function",373],["T_WHITESPACE"," ",373],["T_STRING","getNodes",373],"(",["T_VARIABLE","$parentId",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$recursionLevel",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_LNUMBER","0",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$storeId",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_LNUMBER","0",373],")",["T_WHITESPACE","\n    ",373],"{",["T_WHITESPACE","\n        ",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(","!",["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_loaded",375],")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_VARIABLE","$selectParent",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_getReadAdapter",376],"(",")",["T_OBJECT_OPERATOR","->",376],["T_STRING","select",376],"(",")",["T_WHITESPACE","\n                ",376],["T_OBJECT_OPERATOR","->",377],["T_STRING","from",377],"(",["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getMainStoreTable",377],"(",["T_VARIABLE","$storeId",377],")",")",["T_WHITESPACE","\n                ",377],["T_OBJECT_OPERATOR","->",378],["T_STRING","where",378],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",378],",",["T_WHITESPACE"," ",378],["T_VARIABLE","$parentId",378],")",";",["T_WHITESPACE","\n            ",378],["T_IF","if",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$parentNode",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","_getReadAdapter",379],"(",")",["T_OBJECT_OPERATOR","->",379],["T_STRING","fetchRow",379],"(",["T_VARIABLE","$selectParent",379],")",")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n                ",379],["T_VARIABLE","$parentNode",380],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",380],"]",["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$parentNode",380],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",380],"]",";",["T_WHITESPACE","\n                ",380],["T_VARIABLE","$parentNode",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_STRING","Mage",381],["T_DOUBLE_COLON","::",381],["T_STRING","getModel",381],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",381],")",["T_OBJECT_OPERATOR","->",381],["T_STRING","setData",381],"(",["T_VARIABLE","$parentNode",381],")",";",["T_WHITESPACE","\n                ",381],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","_nodes",382],"[",["T_VARIABLE","$parentNode",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","getId",382],"(",")","]",["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$parentNode",382],";",["T_WHITESPACE","\n                ",382],["T_VARIABLE","$nodes",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_loadNodes",383],"(",["T_VARIABLE","$parentNode",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$recursionLevel",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$storeId",383],")",";",["T_WHITESPACE","\n                ",383],["T_VARIABLE","$childrenItems",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_ARRAY","array",384],"(",")",";",["T_WHITESPACE","\n                ",384],["T_FOREACH","foreach",385],["T_WHITESPACE"," ",385],"(",["T_VARIABLE","$nodes",385],["T_WHITESPACE"," ",385],["T_AS","as",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$node",385],")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n                    ",385],["T_VARIABLE","$pathToParent",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","explode",386],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$node",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getPath",386],"(",")",")",";",["T_WHITESPACE","\n                    ",386],["T_STRING","array_pop",387],"(",["T_VARIABLE","$pathToParent",387],")",";",["T_WHITESPACE","\n                    ",387],["T_VARIABLE","$pathToParent",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_STRING","implode",388],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",388],",",["T_WHITESPACE"," ",388],["T_VARIABLE","$pathToParent",388],")",";",["T_WHITESPACE","\n                    ",388],["T_VARIABLE","$childrenItems",389],"[",["T_VARIABLE","$pathToParent",389],"]","[","]",["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$node",389],";",["T_WHITESPACE","\n                ",389],"}",["T_WHITESPACE","\n                ",390],["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","addChildNodes",391],"(",["T_VARIABLE","$childrenItems",391],",",["T_WHITESPACE"," ",391],["T_VARIABLE","$parentNode",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","getPath",391],"(",")",",",["T_WHITESPACE"," ",391],["T_VARIABLE","$parentNode",391],")",";",["T_WHITESPACE","\n                ",391],["T_VARIABLE","$childrenNodes",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_nodes",392],"[",["T_VARIABLE","$parentNode",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getId",392],"(",")","]",";",["T_WHITESPACE","\n                ",392],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$childrenNodes",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","getChildrenNodes",393],"(",")",")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n                    ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","_nodes",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$childrenNodes",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getChildrenNodes",394],"(",")",";",["T_WHITESPACE","\n                ",394],"}",["T_WHITESPACE","\n                ",395],["T_ELSE","else",396],["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n                    ",396],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","_nodes",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_ARRAY","array",397],"(",")",";",["T_WHITESPACE","\n                ",397],"}",["T_WHITESPACE","\n                ",398],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","_loaded",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_STRING","true",399],";",["T_WHITESPACE","\n            ",399],"}",["T_WHITESPACE","\n        ",400],"}",["T_WHITESPACE","\n        ",401],["T_RETURN","return",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","_nodes",402],";",["T_WHITESPACE","\n    ",402],"}",["T_WHITESPACE","\n\n    ",403],["T_DOC_COMMENT","\/**\n     * Return array or collection of categories\n     *\n     * @param integer $parent\n     * @param integer $recursionLevel\n     * @param boolean|string $sorted\n     * @param boolean $asCollection\n     * @param boolean $toLoad\n     * @return array|Varien_Data_Collection\n     *\/",405],["T_WHITESPACE","\n    ",414],["T_PUBLIC","public",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","getCategories",415],"(",["T_VARIABLE","$parent",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$recursionLevel",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_LNUMBER","0",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$sorted",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","false",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$asCollection",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","false",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$toLoad",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","true",415],")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$asCollection",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_VARIABLE","$select",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_getReadAdapter",418],"(",")",["T_OBJECT_OPERATOR","->",418],["T_STRING","select",418],"(",")",["T_WHITESPACE","\n                ",418],["T_OBJECT_OPERATOR","->",419],["T_STRING","from",419],"(",["T_ARRAY","array",419],"(",["T_CONSTANT_ENCAPSED_STRING","'mt'",419],["T_WHITESPACE"," ",419],["T_DOUBLE_ARROW","=>",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getMainStoreTable",419],"(",["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getStoreId",419],"(",")",")",")",",",["T_WHITESPACE"," ",419],["T_ARRAY","array",419],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",419],")",")",["T_WHITESPACE","\n                ",419],["T_OBJECT_OPERATOR","->",420],["T_STRING","where",420],"(",["T_CONSTANT_ENCAPSED_STRING","'mt.entity_id = ?'",420],",",["T_WHITESPACE"," ",420],["T_VARIABLE","$parent",420],")",";",["T_WHITESPACE","\n            ",420],["T_VARIABLE","$parentPath",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","_getReadAdapter",421],"(",")",["T_OBJECT_OPERATOR","->",421],["T_STRING","fetchOne",421],"(",["T_VARIABLE","$select",421],")",";",["T_WHITESPACE","\n\n            ",421],["T_VARIABLE","$collection",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_STRING","Mage",423],["T_DOUBLE_COLON","::",423],["T_STRING","getModel",423],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",423],")",["T_OBJECT_OPERATOR","->",423],["T_STRING","getCollection",423],"(",")",["T_WHITESPACE","\n                ",423],["T_OBJECT_OPERATOR","->",424],["T_STRING","addNameToResult",424],"(",")",["T_WHITESPACE","\n                ",424],["T_OBJECT_OPERATOR","->",425],["T_STRING","addUrlRewriteToResult",425],"(",")",["T_WHITESPACE","\n                ",425],["T_OBJECT_OPERATOR","->",426],["T_STRING","addParentPathFilter",426],"(",["T_VARIABLE","$parentPath",426],")",["T_WHITESPACE","\n                ",426],["T_OBJECT_OPERATOR","->",427],["T_STRING","addStoreFilter",427],"(",")",["T_WHITESPACE","\n                ",427],["T_OBJECT_OPERATOR","->",428],["T_STRING","addIsActiveFilter",428],"(",")",["T_WHITESPACE","\n                ",428],["T_OBJECT_OPERATOR","->",429],["T_STRING","addAttributeToFilter",429],"(",["T_CONSTANT_ENCAPSED_STRING","'include_in_menu'",429],",",["T_WHITESPACE"," ",429],["T_LNUMBER","1",429],")",["T_WHITESPACE","\n                ",429],["T_OBJECT_OPERATOR","->",430],["T_STRING","addSortedField",430],"(",["T_VARIABLE","$sorted",430],")",";",["T_WHITESPACE","\n            ",430],["T_IF","if",431],["T_WHITESPACE"," ",431],"(",["T_VARIABLE","$toLoad",431],")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n                ",431],["T_RETURN","return",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$collection",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","load",432],"(",")",";",["T_WHITESPACE","\n            ",432],"}",["T_WHITESPACE","\n            ",433],["T_RETURN","return",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$collection",434],";",["T_WHITESPACE","\n        ",434],"}",["T_WHITESPACE","\n        ",435],["T_RETURN","return",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","getNodes",436],"(",["T_VARIABLE","$parent",436],",",["T_WHITESPACE"," ",436],["T_VARIABLE","$recursionLevel",436],",",["T_WHITESPACE"," ",436],["T_STRING","Mage",436],["T_DOUBLE_COLON","::",436],["T_STRING","app",436],"(",")",["T_OBJECT_OPERATOR","->",436],["T_STRING","getStore",436],"(",")",["T_OBJECT_OPERATOR","->",436],["T_STRING","getId",436],"(",")",")",";",["T_WHITESPACE","\n    ",436],"}",["T_WHITESPACE","\n\n    ",437],["T_DOC_COMMENT","\/**\n     * Return node with id $nodeId\n     *\n     * @param integer $nodeId\n     * @param array $nodes\n     * @return Varien_Object\n     *\/",439],["T_WHITESPACE","\n    ",445],["T_PUBLIC","public",446],["T_WHITESPACE"," ",446],["T_FUNCTION","function",446],["T_WHITESPACE"," ",446],["T_STRING","getNodeById",446],"(",["T_VARIABLE","$nodeId",446],",",["T_WHITESPACE"," ",446],["T_VARIABLE","$nodes",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_STRING","null",446],")",["T_WHITESPACE","\n    ",446],"{",["T_WHITESPACE","\n        ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_STRING","is_null",448],"(",["T_VARIABLE","$nodes",448],")",")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n            ",448],["T_VARIABLE","$nodes",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getNodes",449],"(",["T_VARIABLE","$nodeId",449],")",";",["T_WHITESPACE","\n        ",449],"}",["T_WHITESPACE","\n        ",450],["T_IF","if",451],["T_WHITESPACE"," ",451],"(",["T_ISSET","isset",451],"(",["T_VARIABLE","$nodes",451],"[",["T_VARIABLE","$nodeId",451],"]",")",")",["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n            ",451],["T_RETURN","return",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$nodes",452],"[",["T_VARIABLE","$nodeId",452],"]",";",["T_WHITESPACE","\n        ",452],"}",["T_WHITESPACE","\n        ",453],["T_FOREACH","foreach",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$nodes",454],["T_WHITESPACE"," ",454],["T_AS","as",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$node",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n            ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$node",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getChildrenNodes",455],"(",")",")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                ",455],["T_RETURN","return",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","getNodeById",456],"(",["T_VARIABLE","$nodeId",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$node",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","getChildrenNodes",456],"(",")",")",";",["T_WHITESPACE","\n            ",456],"}",["T_WHITESPACE","\n        ",457],"}",["T_WHITESPACE","\n        ",458],["T_RETURN","return",459],["T_WHITESPACE"," ",459],["T_ARRAY","array",459],"(",")",";",["T_WHITESPACE","\n    ",459],"}",["T_WHITESPACE","\n\n    ",460],["T_DOC_COMMENT","\/**\n     * Check if Catalog Category Flat Data has been initialized\n     *\n     * @param bool|int|\\Mage_Core_Model_Store|null $storeView Store(id) for which the value is checked\n     * @return bool\n     *\/",462],["T_WHITESPACE","\n    ",467],["T_PUBLIC","public",468],["T_WHITESPACE"," ",468],["T_FUNCTION","function",468],["T_WHITESPACE"," ",468],["T_STRING","isBuilt",468],"(",["T_VARIABLE","$storeView",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_STRING","null",468],")",["T_WHITESPACE","\n    ",468],"{",["T_WHITESPACE","\n        ",469],["T_VARIABLE","$storeView",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_STRING","is_null",470],"(",["T_VARIABLE","$storeView",470],")",["T_WHITESPACE"," ",470],"?",["T_WHITESPACE"," ",470],["T_STRING","Mage",470],["T_DOUBLE_COLON","::",470],["T_STRING","app",470],"(",")",["T_OBJECT_OPERATOR","->",470],["T_STRING","getDefaultStoreView",470],"(",")",["T_WHITESPACE"," ",470],":",["T_WHITESPACE"," ",470],["T_STRING","Mage",470],["T_DOUBLE_COLON","::",470],["T_STRING","app",470],"(",")",["T_OBJECT_OPERATOR","->",470],["T_STRING","getStore",470],"(",["T_VARIABLE","$storeView",470],")",";",["T_WHITESPACE","\n        ",470],["T_IF","if",471],["T_WHITESPACE"," ",471],"(",["T_VARIABLE","$storeView",471],["T_WHITESPACE"," ",471],["T_IS_IDENTICAL","===",471],["T_WHITESPACE"," ",471],["T_STRING","null",471],")",["T_WHITESPACE"," ",471],"{",["T_WHITESPACE","\n            ",471],["T_VARIABLE","$storeId",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_STRING","Mage_Core_Model_App",472],["T_DOUBLE_COLON","::",472],["T_STRING","ADMIN_STORE_ID",472],";",["T_WHITESPACE","\n        ",472],"}",["T_WHITESPACE"," ",473],["T_ELSE","else",473],["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$storeId",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_VARIABLE","$storeView",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","getId",474],"(",")",";",["T_WHITESPACE","\n        ",474],"}",["T_WHITESPACE","\n        ",475],["T_IF","if",476],["T_WHITESPACE"," ",476],"(","!",["T_ISSET","isset",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_isBuilt",476],"[",["T_VARIABLE","$storeId",476],"]",")",")",["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n            ",476],["T_VARIABLE","$select",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","_getReadAdapter",477],"(",")",["T_OBJECT_OPERATOR","->",477],["T_STRING","select",477],"(",")",["T_WHITESPACE","\n                ",477],["T_OBJECT_OPERATOR","->",478],["T_STRING","from",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","getMainStoreTable",478],"(",["T_VARIABLE","$storeId",478],")",",",["T_WHITESPACE"," ",478],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",478],")",["T_WHITESPACE","\n                ",478],["T_OBJECT_OPERATOR","->",479],["T_STRING","limit",479],"(",["T_LNUMBER","1",479],")",";",["T_WHITESPACE","\n            ",479],["T_TRY","try",480],["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n                ",480],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","_isBuilt",481],"[",["T_VARIABLE","$storeId",481],"]",["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_BOOL_CAST","(bool)",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","_getReadAdapter",481],"(",")",["T_OBJECT_OPERATOR","->",481],["T_STRING","fetchOne",481],"(",["T_VARIABLE","$select",481],")",";",["T_WHITESPACE","\n            ",481],"}",["T_WHITESPACE"," ",482],["T_CATCH","catch",482],["T_WHITESPACE"," ",482],"(",["T_STRING","Exception",482],["T_WHITESPACE"," ",482],["T_VARIABLE","$e",482],")",["T_WHITESPACE"," ",482],"{",["T_WHITESPACE","\n                ",482],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","_isBuilt",483],"[",["T_VARIABLE","$storeId",483],"]",["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_STRING","false",483],";",["T_WHITESPACE","\n            ",483],"}",["T_WHITESPACE","\n        ",484],"}",["T_WHITESPACE","\n        ",485],["T_RETURN","return",486],["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","_isBuilt",486],"[",["T_VARIABLE","$storeId",486],"]",";",["T_WHITESPACE","\n    ",486],"}",["T_WHITESPACE","\n\n    ",487],["T_DOC_COMMENT","\/**\n     * Rebuild flat data from eav\n     *\n     * @param array|null $stores\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",489],["T_WHITESPACE","\n    ",494],["T_PUBLIC","public",495],["T_WHITESPACE"," ",495],["T_FUNCTION","function",495],["T_WHITESPACE"," ",495],["T_STRING","rebuild",495],"(",["T_VARIABLE","$stores",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_STRING","null",495],")",["T_WHITESPACE","\n    ",495],"{",["T_WHITESPACE","\n        ",496],["T_IF","if",497],["T_WHITESPACE"," ",497],"(",["T_VARIABLE","$stores",497],["T_WHITESPACE"," ",497],["T_IS_IDENTICAL","===",497],["T_WHITESPACE"," ",497],["T_STRING","null",497],")",["T_WHITESPACE"," ",497],"{",["T_WHITESPACE","\n            ",497],["T_VARIABLE","$stores",498],["T_WHITESPACE"," ",498],"=",["T_WHITESPACE"," ",498],["T_STRING","Mage",498],["T_DOUBLE_COLON","::",498],["T_STRING","app",498],"(",")",["T_OBJECT_OPERATOR","->",498],["T_STRING","getStores",498],"(",")",";",["T_WHITESPACE","\n        ",498],"}",["T_WHITESPACE","\n\n        ",499],["T_IF","if",501],["T_WHITESPACE"," ",501],"(","!",["T_STRING","is_array",501],"(",["T_VARIABLE","$stores",501],")",")",["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n            ",501],["T_VARIABLE","$stores",502],["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_ARRAY","array",502],"(",["T_VARIABLE","$stores",502],")",";",["T_WHITESPACE","\n        ",502],"}",["T_WHITESPACE","\n\n        ",503],["T_VARIABLE","$rootId",505],["T_WHITESPACE"," ",505],"=",["T_WHITESPACE"," ",505],["T_STRING","Mage_Catalog_Model_Category",505],["T_DOUBLE_COLON","::",505],["T_STRING","TREE_ROOT_ID",505],";",["T_WHITESPACE","\n        ",505],["T_VARIABLE","$categories",506],["T_WHITESPACE"," ",506],"=",["T_WHITESPACE"," ",506],["T_ARRAY","array",506],"(",")",";",["T_WHITESPACE","\n        ",506],["T_VARIABLE","$categoriesIds",507],["T_WHITESPACE"," ",507],"=",["T_WHITESPACE"," ",507],["T_ARRAY","array",507],"(",")",";",["T_WHITESPACE","\n        ",507],["T_COMMENT","\/* @var $store Mage_Core_Model_Store *\/",508],["T_WHITESPACE","\n        ",508],["T_FOREACH","foreach",509],["T_WHITESPACE"," ",509],"(",["T_VARIABLE","$stores",509],["T_WHITESPACE"," ",509],["T_AS","as",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$store",509],")",["T_WHITESPACE"," ",509],"{",["T_WHITESPACE","\n            ",509],["T_IF","if",510],["T_WHITESPACE"," ",510],"(",["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","_allowTableChanges",510],")",["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n                ",510],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","_createTable",511],"(",["T_VARIABLE","$store",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","getId",511],"(",")",")",";",["T_WHITESPACE","\n            ",511],"}",["T_WHITESPACE","\n\n            ",512],["T_IF","if",514],["T_WHITESPACE"," ",514],"(","!",["T_ISSET","isset",514],"(",["T_VARIABLE","$categories",514],"[",["T_VARIABLE","$store",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","getRootCategoryId",514],"(",")","]",")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n                ",514],["T_VARIABLE","$select",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","_getWriteAdapter",515],"(",")",["T_OBJECT_OPERATOR","->",515],["T_STRING","select",515],"(",")",["T_WHITESPACE","\n                    ",515],["T_OBJECT_OPERATOR","->",516],["T_STRING","from",516],"(",["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","getTable",516],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",516],")",")",["T_WHITESPACE","\n                    ",516],["T_OBJECT_OPERATOR","->",517],["T_STRING","where",517],"(",["T_CONSTANT_ENCAPSED_STRING","'path = ?'",517],",",["T_WHITESPACE"," ",517],["T_STRING_CAST","(string)",517],["T_VARIABLE","$rootId",517],")",["T_WHITESPACE","\n                    ",517],["T_OBJECT_OPERATOR","->",518],["T_STRING","orWhere",518],"(",["T_CONSTANT_ENCAPSED_STRING","'path = ?'",518],",",["T_WHITESPACE"," ",518],"\"",["T_CURLY_OPEN","{",518],["T_VARIABLE","$rootId",518],"}",["T_ENCAPSED_AND_WHITESPACE","\/",518],["T_CURLY_OPEN","{",518],["T_VARIABLE","$store",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","getRootCategoryId",518],"(",")","}","\"",")",["T_WHITESPACE","\n                    ",518],["T_OBJECT_OPERATOR","->",519],["T_STRING","orWhere",519],"(",["T_CONSTANT_ENCAPSED_STRING","'path LIKE ?'",519],",",["T_WHITESPACE"," ",519],"\"",["T_CURLY_OPEN","{",519],["T_VARIABLE","$rootId",519],"}",["T_ENCAPSED_AND_WHITESPACE","\/",519],["T_CURLY_OPEN","{",519],["T_VARIABLE","$store",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","getRootCategoryId",519],"(",")","}",["T_ENCAPSED_AND_WHITESPACE","\/%",519],"\"",")",";",["T_WHITESPACE","\n                ",519],["T_VARIABLE","$categories",520],"[",["T_VARIABLE","$store",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","getRootCategoryId",520],"(",")","]",["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","_getWriteAdapter",520],"(",")",["T_OBJECT_OPERATOR","->",520],["T_STRING","fetchAll",520],"(",["T_VARIABLE","$select",520],")",";",["T_WHITESPACE","\n                ",520],["T_VARIABLE","$categoriesIds",521],"[",["T_VARIABLE","$store",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","getRootCategoryId",521],"(",")","]",["T_WHITESPACE"," ",521],"=",["T_WHITESPACE"," ",521],["T_ARRAY","array",521],"(",")",";",["T_WHITESPACE","\n                ",521],["T_FOREACH","foreach",522],["T_WHITESPACE"," ",522],"(",["T_VARIABLE","$categories",522],"[",["T_VARIABLE","$store",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","getRootCategoryId",522],"(",")","]",["T_WHITESPACE"," ",522],["T_AS","as",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$category",522],")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n                    ",522],["T_VARIABLE","$categoriesIds",523],"[",["T_VARIABLE","$store",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","getRootCategoryId",523],"(",")","]","[","]",["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_VARIABLE","$category",523],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",523],"]",";",["T_WHITESPACE","\n                ",523],"}",["T_WHITESPACE","\n            ",524],"}",["T_WHITESPACE","\n            ",525],["T_VARIABLE","$categoriesIdsChunks",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_STRING","array_chunk",526],"(",["T_VARIABLE","$categoriesIds",526],"[",["T_VARIABLE","$store",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","getRootCategoryId",526],"(",")","]",",",["T_WHITESPACE"," ",526],["T_STRING","self",526],["T_DOUBLE_COLON","::",526],["T_STRING","CATEGORY_BATCH",526],")",";",["T_WHITESPACE","\n            ",526],["T_FOREACH","foreach",527],["T_WHITESPACE"," ",527],"(",["T_VARIABLE","$categoriesIdsChunks",527],["T_WHITESPACE"," ",527],["T_AS","as",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$categoriesIdsChunk",527],")",["T_WHITESPACE"," ",527],"{",["T_WHITESPACE","\n                ",527],["T_VARIABLE","$attributesData",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","_getAttributeValues",528],"(",["T_VARIABLE","$categoriesIdsChunk",528],",",["T_WHITESPACE"," ",528],["T_VARIABLE","$store",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","getId",528],"(",")",")",";",["T_WHITESPACE","\n                ",528],["T_VARIABLE","$data",529],["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],["T_ARRAY","array",529],"(",")",";",["T_WHITESPACE","\n                ",529],["T_FOREACH","foreach",530],["T_WHITESPACE"," ",530],"(",["T_VARIABLE","$categories",530],"[",["T_VARIABLE","$store",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","getRootCategoryId",530],"(",")","]",["T_WHITESPACE"," ",530],["T_AS","as",530],["T_WHITESPACE"," ",530],["T_VARIABLE","$category",530],")",["T_WHITESPACE"," ",530],"{",["T_WHITESPACE","\n                    ",530],["T_IF","if",531],["T_WHITESPACE"," ",531],"(","!",["T_ISSET","isset",531],"(",["T_VARIABLE","$attributesData",531],"[",["T_VARIABLE","$category",531],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",531],"]","]",")",")",["T_WHITESPACE"," ",531],"{",["T_WHITESPACE","\n                        ",531],["T_CONTINUE","continue",532],";",["T_WHITESPACE","\n                    ",532],"}",["T_WHITESPACE","\n                    ",533],["T_VARIABLE","$category",534],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",534],"]",["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_VARIABLE","$store",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","getId",534],"(",")",";",["T_WHITESPACE","\n                    ",534],["T_VARIABLE","$data",535],"[","]",["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","_prepareValuesToInsert",535],"(",["T_WHITESPACE","\n                        ",535],["T_STRING","array_merge",536],"(",["T_VARIABLE","$category",536],",",["T_WHITESPACE"," ",536],["T_VARIABLE","$attributesData",536],"[",["T_VARIABLE","$category",536],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",536],"]","]",")",["T_WHITESPACE","\n                    ",536],")",";",["T_WHITESPACE","\n                ",537],"}",["T_WHITESPACE","\n                ",538],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_getWriteAdapter",539],"(",")",["T_OBJECT_OPERATOR","->",539],["T_STRING","insertMultiple",539],"(",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getMainStoreTable",539],"(",["T_VARIABLE","$store",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getId",539],"(",")",")",",",["T_WHITESPACE"," ",539],["T_VARIABLE","$data",539],")",";",["T_WHITESPACE","\n            ",539],"}",["T_WHITESPACE","\n        ",540],"}",["T_WHITESPACE","\n        ",541],["T_RETURN","return",542],["T_WHITESPACE"," ",542],["T_VARIABLE","$this",542],";",["T_WHITESPACE","\n    ",542],"}",["T_WHITESPACE","\n\n    ",543],["T_DOC_COMMENT","\/**\n     * Prepare array of column and columnValue pairs\n     *\n     * @param array $data\n     * @return array\n     *\/",545],["T_WHITESPACE","\n    ",550],["T_PROTECTED","protected",551],["T_WHITESPACE"," ",551],["T_FUNCTION","function",551],["T_WHITESPACE"," ",551],["T_STRING","_prepareValuesToInsert",551],"(",["T_VARIABLE","$data",551],")",["T_WHITESPACE","\n    ",551],"{",["T_WHITESPACE","\n        ",552],["T_VARIABLE","$values",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_ARRAY","array",553],"(",")",";",["T_WHITESPACE","\n        ",553],["T_FOREACH","foreach",554],["T_WHITESPACE"," ",554],"(",["T_STRING","array_keys",554],"(",["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","_columns",554],")",["T_WHITESPACE"," ",554],["T_AS","as",554],["T_WHITESPACE"," ",554],["T_VARIABLE","$key",554],["T_WHITESPACE"," ",554],["T_DOUBLE_ARROW","=>",554],["T_WHITESPACE"," ",554],["T_VARIABLE","$column",554],")",["T_WHITESPACE"," ",554],"{",["T_WHITESPACE","\n            ",554],["T_IF","if",555],["T_WHITESPACE"," ",555],"(",["T_ISSET","isset",555],"(",["T_VARIABLE","$data",555],"[",["T_VARIABLE","$column",555],"]",")",")",["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n                ",555],["T_VARIABLE","$values",556],"[",["T_VARIABLE","$column",556],"]",["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_VARIABLE","$data",556],"[",["T_VARIABLE","$column",556],"]",";",["T_WHITESPACE","\n            ",556],"}",["T_WHITESPACE"," ",557],["T_ELSE","else",557],["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n                ",557],["T_VARIABLE","$values",558],"[",["T_VARIABLE","$column",558],"]",["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_STRING","null",558],";",["T_WHITESPACE","\n            ",558],"}",["T_WHITESPACE","\n        ",559],"}",["T_WHITESPACE","\n        ",560],["T_RETURN","return",561],["T_WHITESPACE"," ",561],["T_VARIABLE","$values",561],";",["T_WHITESPACE","\n    ",561],"}",["T_WHITESPACE","\n\n    ",562],["T_DOC_COMMENT","\/**\n     * Create Flate Table(s)\n     *\n     * @param array|int $stores\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",564],["T_WHITESPACE","\n    ",569],["T_PUBLIC","public",570],["T_WHITESPACE"," ",570],["T_FUNCTION","function",570],["T_WHITESPACE"," ",570],["T_STRING","createTable",570],"(",["T_VARIABLE","$stores",570],")",["T_WHITESPACE","\n    ",570],"{",["T_WHITESPACE","\n        ",571],["T_RETURN","return",572],["T_WHITESPACE"," ",572],["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","_createTable",572],"(",["T_VARIABLE","$stores",572],")",";",["T_WHITESPACE","\n    ",572],"}",["T_WHITESPACE","\n\n    ",573],["T_DOC_COMMENT","\/**\n     * Creating table and adding attributes as fields to table\n     *\n     * @param array|integer $store\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",575],["T_WHITESPACE","\n    ",580],["T_PROTECTED","protected",581],["T_WHITESPACE"," ",581],["T_FUNCTION","function",581],["T_WHITESPACE"," ",581],["T_STRING","_createTable",581],"(",["T_VARIABLE","$store",581],")",["T_WHITESPACE","\n    ",581],"{",["T_WHITESPACE","\n        ",582],["T_VARIABLE","$tableName",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],["T_VARIABLE","$this",583],["T_OBJECT_OPERATOR","->",583],["T_STRING","getMainStoreTable",583],"(",["T_VARIABLE","$store",583],")",";",["T_WHITESPACE","\n        ",583],["T_VARIABLE","$_writeAdapter",584],["T_WHITESPACE"," ",584],"=",["T_WHITESPACE"," ",584],["T_VARIABLE","$this",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","_getWriteAdapter",584],"(",")",";",["T_WHITESPACE","\n        ",584],["T_VARIABLE","$_writeAdapter",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","dropTable",585],"(",["T_VARIABLE","$tableName",585],")",";",["T_WHITESPACE","\n        ",585],["T_VARIABLE","$table",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_VARIABLE","$this",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","_getWriteAdapter",586],"(",")",["T_WHITESPACE","\n            ",586],["T_OBJECT_OPERATOR","->",587],["T_STRING","newTable",587],"(",["T_VARIABLE","$tableName",587],")",["T_WHITESPACE","\n            ",587],["T_OBJECT_OPERATOR","->",588],["T_STRING","setComment",588],"(",["T_STRING","sprintf",588],"(",["T_CONSTANT_ENCAPSED_STRING","'Catalog Category Flat (Store %d)'",588],",",["T_WHITESPACE"," ",588],["T_VARIABLE","$store",588],")",")",";",["T_WHITESPACE","\n\n        ",588],["T_COMMENT","\/\/Adding columns\n",590],["T_WHITESPACE","        ",591],["T_IF","if",591],["T_WHITESPACE"," ",591],"(",["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","_columnsSql",591],["T_WHITESPACE"," ",591],["T_IS_IDENTICAL","===",591],["T_WHITESPACE"," ",591],["T_STRING","null",591],")",["T_WHITESPACE"," ",591],"{",["T_WHITESPACE","\n            ",591],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","_columns",592],["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_STRING","array_merge",592],"(",["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","_getStaticColumns",592],"(",")",",",["T_WHITESPACE"," ",592],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","_getEavColumns",592],"(",")",")",";",["T_WHITESPACE","\n            ",592],["T_FOREACH","foreach",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$this",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","_columns",593],["T_WHITESPACE"," ",593],["T_AS","as",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$fieldName",593],["T_WHITESPACE"," ",593],["T_DOUBLE_ARROW","=>",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$fieldProp",593],")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n                ",593],["T_VARIABLE","$default",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_VARIABLE","$fieldProp",594],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",594],"]",";",["T_WHITESPACE","\n                ",594],["T_IF","if",595],["T_WHITESPACE"," ",595],"(",["T_VARIABLE","$fieldProp",595],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",595],"]","[",["T_LNUMBER","0",595],"]",["T_WHITESPACE"," ",595],["T_IS_EQUAL","==",595],["T_WHITESPACE"," ",595],["T_STRING","Varien_Db_Ddl_Table",595],["T_DOUBLE_COLON","::",595],["T_STRING","TYPE_TIMESTAMP",595],["T_WHITESPACE","\n                    ",595],["T_BOOLEAN_AND","&&",596],["T_WHITESPACE"," ",596],["T_VARIABLE","$default",596],["T_WHITESPACE"," ",596],["T_IS_EQUAL","==",596],["T_WHITESPACE"," ",596],["T_CONSTANT_ENCAPSED_STRING","'CURRENT_TIMESTAMP'",596],")",["T_WHITESPACE"," ",596],"{",["T_WHITESPACE","\n                    ",596],["T_VARIABLE","$default",597],["T_WHITESPACE"," ",597],"=",["T_WHITESPACE"," ",597],["T_STRING","Varien_Db_Ddl_Table",597],["T_DOUBLE_COLON","::",597],["T_STRING","TIMESTAMP_INIT",597],";",["T_WHITESPACE","\n                ",597],"}",["T_WHITESPACE","\n                ",598],["T_VARIABLE","$table",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","addColumn",599],"(",["T_VARIABLE","$fieldName",599],",",["T_WHITESPACE"," ",599],["T_VARIABLE","$fieldProp",599],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",599],"]","[",["T_LNUMBER","0",599],"]",",",["T_WHITESPACE"," ",599],["T_VARIABLE","$fieldProp",599],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",599],"]","[",["T_LNUMBER","1",599],"]",",",["T_WHITESPACE"," ",599],["T_ARRAY","array",599],"(",["T_WHITESPACE","\n                    ",599],["T_CONSTANT_ENCAPSED_STRING","'nullable'",600],["T_WHITESPACE"," ",600],["T_DOUBLE_ARROW","=>",600],["T_WHITESPACE"," ",600],["T_VARIABLE","$fieldProp",600],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",600],"]",",",["T_WHITESPACE","\n                    ",600],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",601],["T_WHITESPACE"," ",601],["T_DOUBLE_ARROW","=>",601],["T_WHITESPACE"," ",601],["T_VARIABLE","$fieldProp",601],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",601],"]",",",["T_WHITESPACE","\n                    ",601],["T_CONSTANT_ENCAPSED_STRING","'default'",602],["T_WHITESPACE","  ",602],["T_DOUBLE_ARROW","=>",602],["T_WHITESPACE"," ",602],["T_VARIABLE","$default",602],",",["T_WHITESPACE","\n                    ",602],["T_CONSTANT_ENCAPSED_STRING","'primary'",603],["T_WHITESPACE","  ",603],["T_DOUBLE_ARROW","=>",603],["T_WHITESPACE"," ",603],["T_ISSET","isset",603],"(",["T_VARIABLE","$fieldProp",603],"[",["T_CONSTANT_ENCAPSED_STRING","'primary'",603],"]",")",["T_WHITESPACE"," ",603],"?",["T_WHITESPACE"," ",603],["T_VARIABLE","$fieldProp",603],"[",["T_CONSTANT_ENCAPSED_STRING","'primary'",603],"]",["T_WHITESPACE"," ",603],":",["T_WHITESPACE"," ",603],["T_STRING","false",603],",",["T_WHITESPACE","\n                ",603],")",",",["T_WHITESPACE"," ",604],"(",["T_VARIABLE","$fieldProp",604],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",604],"]",["T_WHITESPACE"," ",604],["T_IS_NOT_EQUAL","!=",604],["T_WHITESPACE"," ",604],["T_CONSTANT_ENCAPSED_STRING","''",604],")",["T_WHITESPACE"," ",604],"?",["T_WHITESPACE","\n                    ",604],["T_VARIABLE","$fieldProp",605],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",605],"]",["T_WHITESPACE"," ",605],":",["T_WHITESPACE","\n                    ",605],["T_STRING","ucwords",606],"(",["T_STRING","str_replace",606],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",606],",",["T_WHITESPACE"," ",606],["T_CONSTANT_ENCAPSED_STRING","' '",606],",",["T_WHITESPACE"," ",606],["T_VARIABLE","$fieldName",606],")",")",["T_WHITESPACE","\n                ",606],")",";",["T_WHITESPACE","\n            ",607],"}",["T_WHITESPACE","\n        ",608],"}",["T_WHITESPACE","\n\n        ",609],["T_COMMENT","\/\/ Adding indexes\n",611],["T_WHITESPACE","        ",612],["T_VARIABLE","$table",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","addIndex",612],"(",["T_WHITESPACE","\n            ",612],["T_VARIABLE","$_writeAdapter",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","getIndexName",613],"(",["T_VARIABLE","$tableName",613],",",["T_WHITESPACE"," ",613],["T_ARRAY","array",613],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",613],")",")",",",["T_WHITESPACE","\n            ",613],["T_ARRAY","array",614],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",614],")",",",["T_WHITESPACE","\n            ",614],["T_ARRAY","array",615],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",615],["T_WHITESPACE"," ",615],["T_DOUBLE_ARROW","=>",615],["T_WHITESPACE"," ",615],["T_CONSTANT_ENCAPSED_STRING","'primary'",615],")",["T_WHITESPACE","\n        ",615],")",";",["T_WHITESPACE","\n        ",616],["T_VARIABLE","$table",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","addIndex",617],"(",["T_WHITESPACE","\n            ",617],["T_VARIABLE","$_writeAdapter",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getIndexName",618],"(",["T_VARIABLE","$tableName",618],",",["T_WHITESPACE"," ",618],["T_ARRAY","array",618],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",618],")",")",",",["T_WHITESPACE"," ",618],["T_ARRAY","array",618],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",618],")",",",["T_WHITESPACE"," ",618],["T_ARRAY","array",618],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",618],["T_WHITESPACE"," ",618],["T_DOUBLE_ARROW","=>",618],["T_WHITESPACE"," ",618],["T_CONSTANT_ENCAPSED_STRING","'index'",618],")",["T_WHITESPACE","\n        ",618],")",";",["T_WHITESPACE","\n        ",619],["T_VARIABLE","$table",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","addIndex",620],"(",["T_WHITESPACE","\n            ",620],["T_VARIABLE","$_writeAdapter",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getIndexName",621],"(",["T_VARIABLE","$tableName",621],",",["T_WHITESPACE"," ",621],["T_ARRAY","array",621],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",621],")",")",",",["T_WHITESPACE"," ",621],["T_ARRAY","array",621],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",621],")",",",["T_WHITESPACE"," ",621],["T_ARRAY","array",621],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",621],["T_WHITESPACE"," ",621],["T_DOUBLE_ARROW","=>",621],["T_WHITESPACE"," ",621],["T_CONSTANT_ENCAPSED_STRING","'index'",621],")",["T_WHITESPACE","\n        ",621],")",";",["T_WHITESPACE","\n        ",622],["T_VARIABLE","$table",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","addIndex",623],"(",["T_WHITESPACE","\n            ",623],["T_VARIABLE","$_writeAdapter",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getIndexName",624],"(",["T_VARIABLE","$tableName",624],",",["T_WHITESPACE"," ",624],["T_ARRAY","array",624],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",624],")",")",",",["T_WHITESPACE"," ",624],["T_ARRAY","array",624],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",624],")",",",["T_WHITESPACE"," ",624],["T_ARRAY","array",624],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",624],["T_WHITESPACE"," ",624],["T_DOUBLE_ARROW","=>",624],["T_WHITESPACE"," ",624],["T_CONSTANT_ENCAPSED_STRING","'index'",624],")",["T_WHITESPACE","\n        ",624],")",";",["T_WHITESPACE","\n\n        ",625],["T_COMMENT","\/\/ Adding foreign keys\n",627],["T_WHITESPACE","        ",628],["T_VARIABLE","$table",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","addForeignKey",628],"(",["T_WHITESPACE","\n            ",628],["T_VARIABLE","$_writeAdapter",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","getForeignKeyName",629],"(",["T_WHITESPACE","\n                ",629],["T_VARIABLE","$tableName",630],",",["T_WHITESPACE"," ",630],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",630],",",["T_WHITESPACE"," ",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","getTable",630],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",630],")",",",["T_WHITESPACE"," ",630],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",630],["T_WHITESPACE","\n            ",630],")",",",["T_WHITESPACE","\n            ",631],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",632],",",["T_WHITESPACE"," ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","getTable",632],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",632],")",",",["T_WHITESPACE"," ",632],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",632],",",["T_WHITESPACE","\n            ",632],["T_STRING","Varien_Db_Ddl_Table",633],["T_DOUBLE_COLON","::",633],["T_STRING","ACTION_CASCADE",633],",",["T_WHITESPACE"," ",633],["T_STRING","Varien_Db_Ddl_Table",633],["T_DOUBLE_COLON","::",633],["T_STRING","ACTION_CASCADE",633],")",";",["T_WHITESPACE","\n        ",633],["T_VARIABLE","$table",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","addForeignKey",634],"(",["T_WHITESPACE","\n            ",634],["T_VARIABLE","$_writeAdapter",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","getForeignKeyName",635],"(",["T_VARIABLE","$tableName",635],",",["T_WHITESPACE"," ",635],["T_CONSTANT_ENCAPSED_STRING","'store_id'",635],",",["T_WHITESPACE"," ",635],["T_VARIABLE","$this",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","getTable",635],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store'",635],")",",",["T_WHITESPACE"," ",635],["T_CONSTANT_ENCAPSED_STRING","'store_id'",635],")",",",["T_WHITESPACE","\n            ",635],["T_CONSTANT_ENCAPSED_STRING","'store_id'",636],",",["T_WHITESPACE"," ",636],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","getTable",636],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store'",636],")",",",["T_WHITESPACE"," ",636],["T_CONSTANT_ENCAPSED_STRING","'store_id'",636],",",["T_WHITESPACE","\n            ",636],["T_STRING","Varien_Db_Ddl_Table",637],["T_DOUBLE_COLON","::",637],["T_STRING","ACTION_CASCADE",637],",",["T_WHITESPACE"," ",637],["T_STRING","Varien_Db_Ddl_Table",637],["T_DOUBLE_COLON","::",637],["T_STRING","ACTION_CASCADE",637],")",";",["T_WHITESPACE","\n        ",637],["T_VARIABLE","$_writeAdapter",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","createTable",638],"(",["T_VARIABLE","$table",638],")",";",["T_WHITESPACE","\n        ",638],["T_RETURN","return",639],["T_WHITESPACE"," ",639],["T_VARIABLE","$this",639],";",["T_WHITESPACE","\n    ",639],"}",["T_WHITESPACE","\n\n    ",640],["T_DOC_COMMENT","\/**\n     * Return array of static columns\n     *\n     * @return array\n     *\/",642],["T_WHITESPACE","\n    ",646],["T_PROTECTED","protected",647],["T_WHITESPACE"," ",647],["T_FUNCTION","function",647],["T_WHITESPACE"," ",647],["T_STRING","_getStaticColumns",647],"(",")",["T_WHITESPACE","\n    ",647],"{",["T_WHITESPACE","\n        ",648],["T_VARIABLE","$helper",649],["T_WHITESPACE"," ",649],"=",["T_WHITESPACE"," ",649],["T_STRING","Mage",649],["T_DOUBLE_COLON","::",649],["T_STRING","getResourceHelper",649],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",649],")",";",["T_WHITESPACE","\n        ",649],["T_VARIABLE","$columns",650],["T_WHITESPACE"," ",650],"=",["T_WHITESPACE"," ",650],["T_ARRAY","array",650],"(",")",";",["T_WHITESPACE","\n        ",650],["T_VARIABLE","$columnsToSkip",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_ARRAY","array",651],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",651],",",["T_WHITESPACE"," ",651],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",651],")",";",["T_WHITESPACE","\n        ",651],["T_VARIABLE","$describe",652],["T_WHITESPACE"," ",652],"=",["T_WHITESPACE"," ",652],["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","_getWriteAdapter",652],"(",")",["T_OBJECT_OPERATOR","->",652],["T_STRING","describeTable",652],"(",["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","getTable",652],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",652],")",")",";",["T_WHITESPACE","\n\n        ",652],["T_FOREACH","foreach",654],["T_WHITESPACE"," ",654],"(",["T_VARIABLE","$describe",654],["T_WHITESPACE"," ",654],["T_AS","as",654],["T_WHITESPACE"," ",654],["T_VARIABLE","$column",654],")",["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n            ",654],["T_IF","if",655],["T_WHITESPACE"," ",655],"(",["T_STRING","in_array",655],"(",["T_VARIABLE","$column",655],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMN_NAME'",655],"]",",",["T_WHITESPACE"," ",655],["T_VARIABLE","$columnsToSkip",655],")",")",["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n                ",655],["T_CONTINUE","continue",656],";",["T_WHITESPACE","\n            ",656],"}",["T_WHITESPACE","\n            ",657],["T_VARIABLE","$_is_unsigned",658],["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_CONSTANT_ENCAPSED_STRING","''",658],";",["T_WHITESPACE","\n            ",658],["T_VARIABLE","$ddlType",659],["T_WHITESPACE"," ",659],"=",["T_WHITESPACE"," ",659],["T_VARIABLE","$helper",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","getDdlTypeByColumnType",659],"(",["T_VARIABLE","$column",659],"[",["T_CONSTANT_ENCAPSED_STRING","'DATA_TYPE'",659],"]",")",";",["T_WHITESPACE","\n            ",659],["T_VARIABLE","$column",660],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",660],"]",["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_STRING","trim",660],"(",["T_VARIABLE","$column",660],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",660],"]",",",["T_CONSTANT_ENCAPSED_STRING","\"' \"",660],")",";",["T_WHITESPACE","\n            ",660],["T_SWITCH","switch",661],["T_WHITESPACE"," ",661],"(",["T_VARIABLE","$ddlType",661],")",["T_WHITESPACE"," ",661],"{",["T_WHITESPACE","\n                ",661],["T_CASE","case",662],["T_WHITESPACE"," ",662],["T_STRING","Varien_Db_Ddl_Table",662],["T_DOUBLE_COLON","::",662],["T_STRING","TYPE_SMALLINT",662],":",["T_WHITESPACE","\n                ",662],["T_CASE","case",663],["T_WHITESPACE"," ",663],["T_STRING","Varien_Db_Ddl_Table",663],["T_DOUBLE_COLON","::",663],["T_STRING","TYPE_INTEGER",663],":",["T_WHITESPACE","\n                ",663],["T_CASE","case",664],["T_WHITESPACE"," ",664],["T_STRING","Varien_Db_Ddl_Table",664],["T_DOUBLE_COLON","::",664],["T_STRING","TYPE_BIGINT",664],":",["T_WHITESPACE","\n                    ",664],["T_VARIABLE","$_is_unsigned",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_BOOL_CAST","(bool)",665],["T_VARIABLE","$column",665],"[",["T_CONSTANT_ENCAPSED_STRING","'UNSIGNED'",665],"]",";",["T_WHITESPACE","\n                    ",665],["T_IF","if",666],["T_WHITESPACE"," ",666],"(",["T_VARIABLE","$column",666],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",666],"]",["T_WHITESPACE"," ",666],["T_IS_IDENTICAL","===",666],["T_WHITESPACE"," ",666],["T_CONSTANT_ENCAPSED_STRING","''",666],")",["T_WHITESPACE"," ",666],"{",["T_WHITESPACE","\n                        ",666],["T_VARIABLE","$column",667],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",667],"]",["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_STRING","null",667],";",["T_WHITESPACE","\n                    ",667],"}",["T_WHITESPACE","\n\n                    ",668],["T_VARIABLE","$options",670],["T_WHITESPACE"," ",670],"=",["T_WHITESPACE"," ",670],["T_STRING","null",670],";",["T_WHITESPACE","\n                    ",670],["T_IF","if",671],["T_WHITESPACE"," ",671],"(",["T_VARIABLE","$column",671],"[",["T_CONSTANT_ENCAPSED_STRING","'SCALE'",671],"]",["T_WHITESPACE"," ",671],">",["T_WHITESPACE"," ",671],["T_LNUMBER","0",671],")",["T_WHITESPACE"," ",671],"{",["T_WHITESPACE","\n                        ",671],["T_VARIABLE","$ddlType",672],["T_WHITESPACE"," ",672],"=",["T_WHITESPACE"," ",672],["T_STRING","Varien_Db_Ddl_Table",672],["T_DOUBLE_COLON","::",672],["T_STRING","TYPE_DECIMAL",672],";",["T_WHITESPACE","\n                    ",672],"}",["T_WHITESPACE"," ",673],["T_ELSE","else",673],["T_WHITESPACE"," ",673],"{",["T_WHITESPACE","\n                        ",673],["T_BREAK","break",674],";",["T_WHITESPACE","\n                    ",674],"}",["T_WHITESPACE","\n                ",675],["T_CASE","case",676],["T_WHITESPACE"," ",676],["T_STRING","Varien_Db_Ddl_Table",676],["T_DOUBLE_COLON","::",676],["T_STRING","TYPE_DECIMAL",676],":",["T_WHITESPACE","\n                    ",676],["T_VARIABLE","$options",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_VARIABLE","$column",677],"[",["T_CONSTANT_ENCAPSED_STRING","'PRECISION'",677],"]",["T_WHITESPACE"," ",677],".",["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","','",677],["T_WHITESPACE"," ",677],".",["T_WHITESPACE"," ",677],["T_VARIABLE","$column",677],"[",["T_CONSTANT_ENCAPSED_STRING","'SCALE'",677],"]",";",["T_WHITESPACE","\n                    ",677],["T_VARIABLE","$_is_unsigned",678],["T_WHITESPACE"," ",678],"=",["T_WHITESPACE"," ",678],["T_STRING","null",678],";",["T_WHITESPACE","\n                    ",678],["T_IF","if",679],["T_WHITESPACE"," ",679],"(",["T_VARIABLE","$column",679],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",679],"]",["T_WHITESPACE"," ",679],["T_IS_IDENTICAL","===",679],["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","''",679],")",["T_WHITESPACE"," ",679],"{",["T_WHITESPACE","\n                        ",679],["T_VARIABLE","$column",680],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",680],"]",["T_WHITESPACE"," ",680],"=",["T_WHITESPACE"," ",680],["T_STRING","null",680],";",["T_WHITESPACE","\n                    ",680],"}",["T_WHITESPACE","\n                    ",681],["T_BREAK","break",682],";",["T_WHITESPACE","\n                ",682],["T_CASE","case",683],["T_WHITESPACE"," ",683],["T_STRING","Varien_Db_Ddl_Table",683],["T_DOUBLE_COLON","::",683],["T_STRING","TYPE_TEXT",683],":",["T_WHITESPACE","\n                    ",683],["T_VARIABLE","$options",684],["T_WHITESPACE"," ",684],"=",["T_WHITESPACE"," ",684],["T_VARIABLE","$column",684],"[",["T_CONSTANT_ENCAPSED_STRING","'LENGTH'",684],"]",";",["T_WHITESPACE","\n                    ",684],["T_VARIABLE","$_is_unsigned",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_STRING","null",685],";",["T_WHITESPACE","\n                    ",685],["T_BREAK","break",686],";",["T_WHITESPACE","\n                ",686],["T_CASE","case",687],["T_WHITESPACE"," ",687],["T_STRING","Varien_Db_Ddl_Table",687],["T_DOUBLE_COLON","::",687],["T_STRING","TYPE_TIMESTAMP",687],":",["T_WHITESPACE","\n                    ",687],["T_VARIABLE","$options",688],["T_WHITESPACE"," ",688],"=",["T_WHITESPACE"," ",688],["T_STRING","null",688],";",["T_WHITESPACE","\n                    ",688],["T_VARIABLE","$_is_unsigned",689],["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_STRING","null",689],";",["T_WHITESPACE","\n                    ",689],["T_BREAK","break",690],";",["T_WHITESPACE","\n                ",690],["T_CASE","case",691],["T_WHITESPACE"," ",691],["T_STRING","Varien_Db_Ddl_Table",691],["T_DOUBLE_COLON","::",691],["T_STRING","TYPE_DATETIME",691],":",["T_WHITESPACE","\n                    ",691],["T_VARIABLE","$_is_unsigned",692],["T_WHITESPACE"," ",692],"=",["T_WHITESPACE"," ",692],["T_STRING","null",692],";",["T_WHITESPACE","\n                    ",692],["T_BREAK","break",693],";",["T_WHITESPACE","\n\n            ",693],"}",["T_WHITESPACE","\n            ",695],["T_VARIABLE","$columns",696],"[",["T_VARIABLE","$column",696],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMN_NAME'",696],"]","]",["T_WHITESPACE"," ",696],"=",["T_WHITESPACE"," ",696],["T_ARRAY","array",696],"(",["T_WHITESPACE","\n                ",696],["T_CONSTANT_ENCAPSED_STRING","'type'",697],["T_WHITESPACE"," ",697],["T_DOUBLE_ARROW","=>",697],["T_WHITESPACE"," ",697],["T_ARRAY","array",697],"(",["T_VARIABLE","$ddlType",697],",",["T_WHITESPACE"," ",697],["T_VARIABLE","$options",697],")",",",["T_WHITESPACE","\n                ",697],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",698],["T_WHITESPACE"," ",698],["T_DOUBLE_ARROW","=>",698],["T_WHITESPACE"," ",698],["T_VARIABLE","$_is_unsigned",698],",",["T_WHITESPACE","\n                ",698],["T_CONSTANT_ENCAPSED_STRING","'nullable'",699],["T_WHITESPACE"," ",699],["T_DOUBLE_ARROW","=>",699],["T_WHITESPACE"," ",699],["T_VARIABLE","$column",699],"[",["T_CONSTANT_ENCAPSED_STRING","'NULLABLE'",699],"]",",",["T_WHITESPACE","\n                ",699],["T_CONSTANT_ENCAPSED_STRING","'default'",700],["T_WHITESPACE"," ",700],["T_DOUBLE_ARROW","=>",700],["T_WHITESPACE"," ",700],"(",["T_VARIABLE","$column",700],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",700],"]",["T_WHITESPACE"," ",700],["T_IS_IDENTICAL","===",700],["T_WHITESPACE"," ",700],["T_STRING","null",700],["T_WHITESPACE"," ",700],"?",["T_WHITESPACE"," ",700],["T_STRING","false",700],["T_WHITESPACE"," ",700],":",["T_WHITESPACE"," ",700],["T_VARIABLE","$column",700],"[",["T_CONSTANT_ENCAPSED_STRING","'DEFAULT'",700],"]",")",",",["T_WHITESPACE","\n                ",700],["T_CONSTANT_ENCAPSED_STRING","'comment'",701],["T_WHITESPACE"," ",701],["T_DOUBLE_ARROW","=>",701],["T_WHITESPACE"," ",701],["T_VARIABLE","$column",701],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMN_NAME'",701],"]",["T_WHITESPACE","\n            ",701],")",";",["T_WHITESPACE","\n        ",702],"}",["T_WHITESPACE","\n        ",703],["T_VARIABLE","$columns",704],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",704],"]",["T_WHITESPACE"," ",704],"=",["T_WHITESPACE"," ",704],["T_ARRAY","array",704],"(",["T_WHITESPACE","\n            ",704],["T_CONSTANT_ENCAPSED_STRING","'type'",705],["T_WHITESPACE"," ",705],["T_DOUBLE_ARROW","=>",705],["T_WHITESPACE"," ",705],["T_ARRAY","array",705],"(",["T_STRING","Varien_Db_Ddl_Table",705],["T_DOUBLE_COLON","::",705],["T_STRING","TYPE_SMALLINT",705],",",["T_WHITESPACE"," ",705],["T_LNUMBER","5",705],")",",",["T_WHITESPACE","\n            ",705],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",706],["T_WHITESPACE"," ",706],["T_DOUBLE_ARROW","=>",706],["T_WHITESPACE"," ",706],["T_STRING","true",706],",",["T_WHITESPACE","\n            ",706],["T_CONSTANT_ENCAPSED_STRING","'nullable'",707],["T_WHITESPACE"," ",707],["T_DOUBLE_ARROW","=>",707],["T_WHITESPACE"," ",707],["T_STRING","false",707],",",["T_WHITESPACE","\n            ",707],["T_CONSTANT_ENCAPSED_STRING","'default'",708],["T_WHITESPACE"," ",708],["T_DOUBLE_ARROW","=>",708],["T_WHITESPACE"," ",708],["T_CONSTANT_ENCAPSED_STRING","'0'",708],",",["T_WHITESPACE","\n            ",708],["T_CONSTANT_ENCAPSED_STRING","'comment'",709],["T_WHITESPACE"," ",709],["T_DOUBLE_ARROW","=>",709],["T_WHITESPACE"," ",709],["T_CONSTANT_ENCAPSED_STRING","'Store Id'",709],["T_WHITESPACE","\n        ",709],")",";",["T_WHITESPACE","\n        ",710],["T_RETURN","return",711],["T_WHITESPACE"," ",711],["T_VARIABLE","$columns",711],";",["T_WHITESPACE","\n    ",711],"}",["T_WHITESPACE","\n\n    ",712],["T_DOC_COMMENT","\/**\n     * Return array of eav columns, skip attribute with static type\n     *\n     * @return array\n     *\/",714],["T_WHITESPACE","\n    ",718],["T_PROTECTED","protected",719],["T_WHITESPACE"," ",719],["T_FUNCTION","function",719],["T_WHITESPACE"," ",719],["T_STRING","_getEavColumns",719],"(",")",["T_WHITESPACE","\n    ",719],"{",["T_WHITESPACE","\n        ",720],["T_VARIABLE","$columns",721],["T_WHITESPACE"," ",721],"=",["T_WHITESPACE"," ",721],["T_ARRAY","array",721],"(",")",";",["T_WHITESPACE","\n        ",721],["T_VARIABLE","$attributes",722],["T_WHITESPACE"," ",722],"=",["T_WHITESPACE"," ",722],["T_VARIABLE","$this",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","_getAttributes",722],"(",")",";",["T_WHITESPACE","\n        ",722],["T_FOREACH","foreach",723],["T_WHITESPACE"," ",723],"(",["T_VARIABLE","$attributes",723],["T_WHITESPACE"," ",723],["T_AS","as",723],["T_WHITESPACE"," ",723],["T_VARIABLE","$attribute",723],")",["T_WHITESPACE"," ",723],"{",["T_WHITESPACE","\n            ",723],["T_IF","if",724],["T_WHITESPACE"," ",724],"(",["T_VARIABLE","$attribute",724],"[",["T_CONSTANT_ENCAPSED_STRING","'backend_type'",724],"]",["T_WHITESPACE"," ",724],["T_IS_EQUAL","==",724],["T_WHITESPACE"," ",724],["T_CONSTANT_ENCAPSED_STRING","'static'",724],")",["T_WHITESPACE"," ",724],"{",["T_WHITESPACE","\n                ",724],["T_CONTINUE","continue",725],";",["T_WHITESPACE","\n            ",725],"}",["T_WHITESPACE","\n            ",726],["T_VARIABLE","$columns",727],"[",["T_VARIABLE","$attribute",727],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",727],"]","]",["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_ARRAY","array",727],"(",")",";",["T_WHITESPACE","\n            ",727],["T_SWITCH","switch",728],["T_WHITESPACE"," ",728],"(",["T_VARIABLE","$attribute",728],"[",["T_CONSTANT_ENCAPSED_STRING","'backend_type'",728],"]",")",["T_WHITESPACE"," ",728],"{",["T_WHITESPACE","\n                ",728],["T_CASE","case",729],["T_WHITESPACE"," ",729],["T_CONSTANT_ENCAPSED_STRING","'varchar'",729],":",["T_WHITESPACE","\n                    ",729],["T_VARIABLE","$columns",730],"[",["T_VARIABLE","$attribute",730],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",730],"]","]",["T_WHITESPACE"," ",730],"=",["T_WHITESPACE"," ",730],["T_ARRAY","array",730],"(",["T_WHITESPACE","\n                        ",730],["T_CONSTANT_ENCAPSED_STRING","'type'",731],["T_WHITESPACE"," ",731],["T_DOUBLE_ARROW","=>",731],["T_WHITESPACE"," ",731],["T_ARRAY","array",731],"(",["T_STRING","Varien_Db_Ddl_Table",731],["T_DOUBLE_COLON","::",731],["T_STRING","TYPE_TEXT",731],",",["T_WHITESPACE"," ",731],["T_LNUMBER","255",731],")",",",["T_WHITESPACE","\n                        ",731],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",732],["T_WHITESPACE"," ",732],["T_DOUBLE_ARROW","=>",732],["T_WHITESPACE"," ",732],["T_STRING","null",732],",",["T_WHITESPACE","\n                        ",732],["T_CONSTANT_ENCAPSED_STRING","'nullable'",733],["T_WHITESPACE"," ",733],["T_DOUBLE_ARROW","=>",733],["T_WHITESPACE"," ",733],["T_STRING","true",733],",",["T_WHITESPACE","\n                        ",733],["T_CONSTANT_ENCAPSED_STRING","'default'",734],["T_WHITESPACE"," ",734],["T_DOUBLE_ARROW","=>",734],["T_WHITESPACE"," ",734],["T_STRING","null",734],",",["T_WHITESPACE","\n                        ",734],["T_CONSTANT_ENCAPSED_STRING","'comment'",735],["T_WHITESPACE"," ",735],["T_DOUBLE_ARROW","=>",735],["T_WHITESPACE"," ",735],["T_STRING_CAST","(string)",735],["T_VARIABLE","$attribute",735],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",735],"]",["T_WHITESPACE","\n                    ",735],")",";",["T_WHITESPACE","\n                    ",736],["T_BREAK","break",737],";",["T_WHITESPACE","\n                ",737],["T_CASE","case",738],["T_WHITESPACE"," ",738],["T_CONSTANT_ENCAPSED_STRING","'int'",738],":",["T_WHITESPACE","\n                    ",738],["T_VARIABLE","$columns",739],"[",["T_VARIABLE","$attribute",739],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",739],"]","]",["T_WHITESPACE"," ",739],"=",["T_WHITESPACE"," ",739],["T_ARRAY","array",739],"(",["T_WHITESPACE","\n                        ",739],["T_CONSTANT_ENCAPSED_STRING","'type'",740],["T_WHITESPACE"," ",740],["T_DOUBLE_ARROW","=>",740],["T_WHITESPACE"," ",740],["T_ARRAY","array",740],"(",["T_STRING","Varien_Db_Ddl_Table",740],["T_DOUBLE_COLON","::",740],["T_STRING","TYPE_INTEGER",740],",",["T_WHITESPACE"," ",740],["T_STRING","null",740],")",",",["T_WHITESPACE","\n                        ",740],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",741],["T_WHITESPACE"," ",741],["T_DOUBLE_ARROW","=>",741],["T_WHITESPACE"," ",741],["T_STRING","null",741],",",["T_WHITESPACE","\n                        ",741],["T_CONSTANT_ENCAPSED_STRING","'nullable'",742],["T_WHITESPACE"," ",742],["T_DOUBLE_ARROW","=>",742],["T_WHITESPACE"," ",742],["T_STRING","true",742],",",["T_WHITESPACE","\n                        ",742],["T_CONSTANT_ENCAPSED_STRING","'default'",743],["T_WHITESPACE"," ",743],["T_DOUBLE_ARROW","=>",743],["T_WHITESPACE"," ",743],["T_STRING","null",743],",",["T_WHITESPACE","\n                        ",743],["T_CONSTANT_ENCAPSED_STRING","'comment'",744],["T_WHITESPACE"," ",744],["T_DOUBLE_ARROW","=>",744],["T_WHITESPACE"," ",744],["T_STRING_CAST","(string)",744],["T_VARIABLE","$attribute",744],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",744],"]",["T_WHITESPACE","\n                    ",744],")",";",["T_WHITESPACE","\n                    ",745],["T_BREAK","break",746],";",["T_WHITESPACE","\n                ",746],["T_CASE","case",747],["T_WHITESPACE"," ",747],["T_CONSTANT_ENCAPSED_STRING","'text'",747],":",["T_WHITESPACE","\n                    ",747],["T_VARIABLE","$columns",748],"[",["T_VARIABLE","$attribute",748],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",748],"]","]",["T_WHITESPACE"," ",748],"=",["T_WHITESPACE"," ",748],["T_ARRAY","array",748],"(",["T_WHITESPACE","\n                        ",748],["T_CONSTANT_ENCAPSED_STRING","'type'",749],["T_WHITESPACE"," ",749],["T_DOUBLE_ARROW","=>",749],["T_WHITESPACE"," ",749],["T_ARRAY","array",749],"(",["T_STRING","Varien_Db_Ddl_Table",749],["T_DOUBLE_COLON","::",749],["T_STRING","TYPE_TEXT",749],",",["T_WHITESPACE"," ",749],["T_CONSTANT_ENCAPSED_STRING","'64k'",749],")",",",["T_WHITESPACE","\n                        ",749],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",750],["T_WHITESPACE"," ",750],["T_DOUBLE_ARROW","=>",750],["T_WHITESPACE"," ",750],["T_STRING","null",750],",",["T_WHITESPACE","\n                        ",750],["T_CONSTANT_ENCAPSED_STRING","'nullable'",751],["T_WHITESPACE"," ",751],["T_DOUBLE_ARROW","=>",751],["T_WHITESPACE"," ",751],["T_STRING","true",751],",",["T_WHITESPACE","\n                        ",751],["T_CONSTANT_ENCAPSED_STRING","'default'",752],["T_WHITESPACE"," ",752],["T_DOUBLE_ARROW","=>",752],["T_WHITESPACE"," ",752],["T_STRING","null",752],",",["T_WHITESPACE","\n                        ",752],["T_CONSTANT_ENCAPSED_STRING","'comment'",753],["T_WHITESPACE"," ",753],["T_DOUBLE_ARROW","=>",753],["T_WHITESPACE"," ",753],["T_STRING_CAST","(string)",753],["T_VARIABLE","$attribute",753],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",753],"]",["T_WHITESPACE","\n                    ",753],")",";",["T_WHITESPACE","\n                    ",754],["T_BREAK","break",755],";",["T_WHITESPACE","\n                ",755],["T_CASE","case",756],["T_WHITESPACE"," ",756],["T_CONSTANT_ENCAPSED_STRING","'datetime'",756],":",["T_WHITESPACE","\n                    ",756],["T_VARIABLE","$columns",757],"[",["T_VARIABLE","$attribute",757],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",757],"]","]",["T_WHITESPACE"," ",757],"=",["T_WHITESPACE"," ",757],["T_ARRAY","array",757],"(",["T_WHITESPACE","\n                        ",757],["T_CONSTANT_ENCAPSED_STRING","'type'",758],["T_WHITESPACE"," ",758],["T_DOUBLE_ARROW","=>",758],["T_WHITESPACE"," ",758],["T_ARRAY","array",758],"(",["T_STRING","Varien_Db_Ddl_Table",758],["T_DOUBLE_COLON","::",758],["T_STRING","TYPE_DATETIME",758],",",["T_WHITESPACE"," ",758],["T_STRING","null",758],")",",",["T_WHITESPACE","\n                        ",758],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",759],["T_WHITESPACE"," ",759],["T_DOUBLE_ARROW","=>",759],["T_WHITESPACE"," ",759],["T_STRING","null",759],",",["T_WHITESPACE","\n                        ",759],["T_CONSTANT_ENCAPSED_STRING","'nullable'",760],["T_WHITESPACE"," ",760],["T_DOUBLE_ARROW","=>",760],["T_WHITESPACE"," ",760],["T_STRING","true",760],",",["T_WHITESPACE","\n                        ",760],["T_CONSTANT_ENCAPSED_STRING","'default'",761],["T_WHITESPACE"," ",761],["T_DOUBLE_ARROW","=>",761],["T_WHITESPACE"," ",761],["T_STRING","null",761],",",["T_WHITESPACE","\n                        ",761],["T_CONSTANT_ENCAPSED_STRING","'comment'",762],["T_WHITESPACE"," ",762],["T_DOUBLE_ARROW","=>",762],["T_WHITESPACE"," ",762],["T_STRING_CAST","(string)",762],["T_VARIABLE","$attribute",762],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",762],"]",["T_WHITESPACE","\n                    ",762],")",";",["T_WHITESPACE","\n                    ",763],["T_BREAK","break",764],";",["T_WHITESPACE","\n                ",764],["T_CASE","case",765],["T_WHITESPACE"," ",765],["T_CONSTANT_ENCAPSED_STRING","'decimal'",765],":",["T_WHITESPACE","\n                    ",765],["T_VARIABLE","$columns",766],"[",["T_VARIABLE","$attribute",766],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",766],"]","]",["T_WHITESPACE"," ",766],"=",["T_WHITESPACE"," ",766],["T_ARRAY","array",766],"(",["T_WHITESPACE","\n                        ",766],["T_CONSTANT_ENCAPSED_STRING","'type'",767],["T_WHITESPACE"," ",767],["T_DOUBLE_ARROW","=>",767],["T_WHITESPACE"," ",767],["T_ARRAY","array",767],"(",["T_STRING","Varien_Db_Ddl_Table",767],["T_DOUBLE_COLON","::",767],["T_STRING","TYPE_DECIMAL",767],",",["T_WHITESPACE"," ",767],["T_CONSTANT_ENCAPSED_STRING","'12,4'",767],")",",",["T_WHITESPACE","\n                        ",767],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",768],["T_WHITESPACE"," ",768],["T_DOUBLE_ARROW","=>",768],["T_WHITESPACE"," ",768],["T_STRING","null",768],",",["T_WHITESPACE","\n                        ",768],["T_CONSTANT_ENCAPSED_STRING","'nullable'",769],["T_WHITESPACE"," ",769],["T_DOUBLE_ARROW","=>",769],["T_WHITESPACE"," ",769],["T_STRING","true",769],",",["T_WHITESPACE","\n                        ",769],["T_CONSTANT_ENCAPSED_STRING","'default'",770],["T_WHITESPACE"," ",770],["T_DOUBLE_ARROW","=>",770],["T_WHITESPACE"," ",770],["T_STRING","null",770],",",["T_WHITESPACE","\n                        ",770],["T_CONSTANT_ENCAPSED_STRING","'comment'",771],["T_WHITESPACE"," ",771],["T_DOUBLE_ARROW","=>",771],["T_WHITESPACE"," ",771],["T_STRING_CAST","(string)",771],["T_VARIABLE","$attribute",771],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",771],"]",["T_WHITESPACE","\n                    ",771],")",";",["T_WHITESPACE","\n                    ",772],["T_BREAK","break",773],";",["T_WHITESPACE","\n            ",773],"}",["T_WHITESPACE","\n        ",774],"}",["T_WHITESPACE","\n        ",775],["T_RETURN","return",776],["T_WHITESPACE"," ",776],["T_VARIABLE","$columns",776],";",["T_WHITESPACE","\n    ",776],"}",["T_WHITESPACE","\n\n    ",777],["T_DOC_COMMENT","\/**\n     * Return array of attribute codes for entity type 'catalog_category'\n     *\n     * @return array\n     *\/",779],["T_WHITESPACE","\n    ",783],["T_PROTECTED","protected",784],["T_WHITESPACE"," ",784],["T_FUNCTION","function",784],["T_WHITESPACE"," ",784],["T_STRING","_getAttributes",784],"(",")",["T_WHITESPACE","\n    ",784],"{",["T_WHITESPACE","\n        ",785],["T_IF","if",786],["T_WHITESPACE"," ",786],"(",["T_VARIABLE","$this",786],["T_OBJECT_OPERATOR","->",786],["T_STRING","_attributeCodes",786],["T_WHITESPACE"," ",786],["T_IS_IDENTICAL","===",786],["T_WHITESPACE"," ",786],["T_STRING","null",786],")",["T_WHITESPACE"," ",786],"{",["T_WHITESPACE","\n            ",786],["T_VARIABLE","$select",787],["T_WHITESPACE"," ",787],"=",["T_WHITESPACE"," ",787],["T_VARIABLE","$this",787],["T_OBJECT_OPERATOR","->",787],["T_STRING","_getWriteAdapter",787],"(",")",["T_OBJECT_OPERATOR","->",787],["T_STRING","select",787],"(",")",["T_WHITESPACE","\n                ",787],["T_OBJECT_OPERATOR","->",788],["T_STRING","from",788],"(",["T_VARIABLE","$this",788],["T_OBJECT_OPERATOR","->",788],["T_STRING","getTable",788],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_type'",788],")",",",["T_WHITESPACE"," ",788],["T_ARRAY","array",788],"(",")",")",["T_WHITESPACE","\n                ",788],["T_OBJECT_OPERATOR","->",789],["T_STRING","join",789],"(",["T_WHITESPACE","\n                    ",789],["T_VARIABLE","$this",790],["T_OBJECT_OPERATOR","->",790],["T_STRING","getTable",790],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute'",790],")",",",["T_WHITESPACE","\n                    ",790],["T_VARIABLE","$this",791],["T_OBJECT_OPERATOR","->",791],["T_STRING","getTable",791],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute'",791],")",["T_WHITESPACE","\n                        ",791],".",["T_WHITESPACE"," ",792],["T_CONSTANT_ENCAPSED_STRING","'.entity_type_id = '",792],["T_WHITESPACE"," ",792],".",["T_WHITESPACE"," ",792],["T_VARIABLE","$this",792],["T_OBJECT_OPERATOR","->",792],["T_STRING","getTable",792],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_type'",792],")",["T_WHITESPACE"," ",792],".",["T_WHITESPACE"," ",792],["T_CONSTANT_ENCAPSED_STRING","'.entity_type_id'",792],",",["T_WHITESPACE","\n                    ",792],["T_VARIABLE","$this",793],["T_OBJECT_OPERATOR","->",793],["T_STRING","getTable",793],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute'",793],")",".",["T_CONSTANT_ENCAPSED_STRING","'.*'",793],["T_WHITESPACE","\n                ",793],")",["T_WHITESPACE","\n                ",794],["T_OBJECT_OPERATOR","->",795],["T_STRING","where",795],"(",["T_WHITESPACE","\n                    ",795],["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","getTable",796],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_type'",796],")",["T_WHITESPACE"," ",796],".",["T_WHITESPACE"," ",796],["T_CONSTANT_ENCAPSED_STRING","'.entity_type_code = ?'",796],",",["T_WHITESPACE"," ",796],["T_STRING","Mage_Catalog_Model_Category",796],["T_DOUBLE_COLON","::",796],["T_STRING","ENTITY",796],["T_WHITESPACE","\n                ",796],")",";",["T_WHITESPACE","\n            ",797],["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","_attributeCodes",798],["T_WHITESPACE"," ",798],"=",["T_WHITESPACE"," ",798],["T_ARRAY","array",798],"(",")",";",["T_WHITESPACE","\n            ",798],["T_FOREACH","foreach",799],["T_WHITESPACE"," ",799],"(",["T_VARIABLE","$this",799],["T_OBJECT_OPERATOR","->",799],["T_STRING","_getWriteAdapter",799],"(",")",["T_OBJECT_OPERATOR","->",799],["T_STRING","fetchAll",799],"(",["T_VARIABLE","$select",799],")",["T_WHITESPACE"," ",799],["T_AS","as",799],["T_WHITESPACE"," ",799],["T_VARIABLE","$attribute",799],")",["T_WHITESPACE"," ",799],"{",["T_WHITESPACE","\n                ",799],["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","_attributeCodes",800],"[",["T_VARIABLE","$attribute",800],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",800],"]","]",["T_WHITESPACE"," ",800],"=",["T_WHITESPACE"," ",800],["T_VARIABLE","$attribute",800],";",["T_WHITESPACE","\n            ",800],"}",["T_WHITESPACE","\n        ",801],"}",["T_WHITESPACE","\n        ",802],["T_RETURN","return",803],["T_WHITESPACE"," ",803],["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","_attributeCodes",803],";",["T_WHITESPACE","\n    ",803],"}",["T_WHITESPACE","\n\n    ",804],["T_DOC_COMMENT","\/**\n     * Return attribute values for given entities and store\n     *\n     * @param array $entityIds\n     * @param integer $store_id\n     * @return array\n     *\/",806],["T_WHITESPACE","\n    ",812],["T_PROTECTED","protected",813],["T_WHITESPACE"," ",813],["T_FUNCTION","function",813],["T_WHITESPACE"," ",813],["T_STRING","_getAttributeValues",813],"(",["T_VARIABLE","$entityIds",813],",",["T_WHITESPACE"," ",813],["T_VARIABLE","$store_id",813],")",["T_WHITESPACE","\n    ",813],"{",["T_WHITESPACE","\n        ",814],["T_IF","if",815],["T_WHITESPACE"," ",815],"(","!",["T_STRING","is_array",815],"(",["T_VARIABLE","$entityIds",815],")",")",["T_WHITESPACE"," ",815],"{",["T_WHITESPACE","\n            ",815],["T_VARIABLE","$entityIds",816],["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],["T_ARRAY","array",816],"(",["T_VARIABLE","$entityIds",816],")",";",["T_WHITESPACE","\n        ",816],"}",["T_WHITESPACE","\n        ",817],["T_VARIABLE","$values",818],["T_WHITESPACE"," ",818],"=",["T_WHITESPACE"," ",818],["T_ARRAY","array",818],"(",")",";",["T_WHITESPACE","\n\n        ",818],["T_FOREACH","foreach",820],["T_WHITESPACE"," ",820],"(",["T_VARIABLE","$entityIds",820],["T_WHITESPACE"," ",820],["T_AS","as",820],["T_WHITESPACE"," ",820],["T_VARIABLE","$entityId",820],")",["T_WHITESPACE"," ",820],"{",["T_WHITESPACE","\n            ",820],["T_VARIABLE","$values",821],"[",["T_VARIABLE","$entityId",821],"]",["T_WHITESPACE"," ",821],"=",["T_WHITESPACE"," ",821],["T_ARRAY","array",821],"(",")",";",["T_WHITESPACE","\n        ",821],"}",["T_WHITESPACE","\n        ",822],["T_VARIABLE","$attributes",823],["T_WHITESPACE"," ",823],"=",["T_WHITESPACE"," ",823],["T_VARIABLE","$this",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","_getAttributes",823],"(",")",";",["T_WHITESPACE","\n        ",823],["T_VARIABLE","$attributesType",824],["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_ARRAY","array",824],"(",["T_WHITESPACE","\n            ",824],["T_CONSTANT_ENCAPSED_STRING","'varchar'",825],",",["T_WHITESPACE","\n            ",825],["T_CONSTANT_ENCAPSED_STRING","'int'",826],",",["T_WHITESPACE","\n            ",826],["T_CONSTANT_ENCAPSED_STRING","'decimal'",827],",",["T_WHITESPACE","\n            ",827],["T_CONSTANT_ENCAPSED_STRING","'text'",828],",",["T_WHITESPACE","\n            ",828],["T_CONSTANT_ENCAPSED_STRING","'datetime'",829],["T_WHITESPACE","\n        ",829],")",";",["T_WHITESPACE","\n        ",830],["T_FOREACH","foreach",831],["T_WHITESPACE"," ",831],"(",["T_VARIABLE","$attributesType",831],["T_WHITESPACE"," ",831],["T_AS","as",831],["T_WHITESPACE"," ",831],["T_VARIABLE","$type",831],")",["T_WHITESPACE"," ",831],"{",["T_WHITESPACE","\n            ",831],["T_FOREACH","foreach",832],["T_WHITESPACE"," ",832],"(",["T_VARIABLE","$this",832],["T_OBJECT_OPERATOR","->",832],["T_STRING","_getAttributeTypeValues",832],"(",["T_VARIABLE","$type",832],",",["T_WHITESPACE"," ",832],["T_VARIABLE","$entityIds",832],",",["T_WHITESPACE"," ",832],["T_VARIABLE","$store_id",832],")",["T_WHITESPACE"," ",832],["T_AS","as",832],["T_WHITESPACE"," ",832],["T_VARIABLE","$row",832],")",["T_WHITESPACE"," ",832],"{",["T_WHITESPACE","\n                ",832],["T_VARIABLE","$values",833],"[",["T_VARIABLE","$row",833],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",833],"]","]","[",["T_VARIABLE","$attributes",833],"[",["T_VARIABLE","$row",833],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",833],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",833],"]","]",["T_WHITESPACE"," ",833],"=",["T_WHITESPACE"," ",833],["T_VARIABLE","$row",833],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",833],"]",";",["T_WHITESPACE","\n            ",833],"}",["T_WHITESPACE","\n        ",834],"}",["T_WHITESPACE","\n        ",835],["T_RETURN","return",836],["T_WHITESPACE"," ",836],["T_VARIABLE","$values",836],";",["T_WHITESPACE","\n    ",836],"}",["T_WHITESPACE","\n\n    ",837],["T_DOC_COMMENT","\/**\n     * Return attribute values for given entities and store of specific attribute type\n     *\n     * @param string $type\n     * @param array $entityIds\n     * @param integer $storeId\n     * @return array\n     *\/",839],["T_WHITESPACE","\n    ",846],["T_PROTECTED","protected",847],["T_WHITESPACE"," ",847],["T_FUNCTION","function",847],["T_WHITESPACE"," ",847],["T_STRING","_getAttributeTypeValues",847],"(",["T_VARIABLE","$type",847],",",["T_WHITESPACE"," ",847],["T_VARIABLE","$entityIds",847],",",["T_WHITESPACE"," ",847],["T_VARIABLE","$storeId",847],")",["T_WHITESPACE","\n    ",847],"{",["T_WHITESPACE","\n        ",848],["T_VARIABLE","$select",849],["T_WHITESPACE"," ",849],"=",["T_WHITESPACE"," ",849],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","_getWriteAdapter",849],"(",")",["T_OBJECT_OPERATOR","->",849],["T_STRING","select",849],"(",")",["T_WHITESPACE","\n            ",849],["T_OBJECT_OPERATOR","->",850],["T_STRING","from",850],"(",["T_WHITESPACE","\n                ",850],["T_ARRAY","array",851],"(",["T_CONSTANT_ENCAPSED_STRING","'def'",851],["T_WHITESPACE"," ",851],["T_DOUBLE_ARROW","=>",851],["T_WHITESPACE"," ",851],["T_VARIABLE","$this",851],["T_OBJECT_OPERATOR","->",851],["T_STRING","getTable",851],"(",["T_ARRAY","array",851],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",851],",",["T_WHITESPACE"," ",851],["T_VARIABLE","$type",851],")",")",")",",",["T_WHITESPACE","\n                ",851],["T_ARRAY","array",852],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",852],",",["T_WHITESPACE"," ",852],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",852],")",["T_WHITESPACE","\n            ",852],")",["T_WHITESPACE","\n            ",853],["T_OBJECT_OPERATOR","->",854],["T_STRING","joinLeft",854],"(",["T_WHITESPACE","\n                ",854],["T_ARRAY","array",855],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",855],["T_WHITESPACE"," ",855],["T_DOUBLE_ARROW","=>",855],["T_WHITESPACE"," ",855],["T_VARIABLE","$this",855],["T_OBJECT_OPERATOR","->",855],["T_STRING","getTable",855],"(",["T_ARRAY","array",855],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",855],",",["T_WHITESPACE"," ",855],["T_VARIABLE","$type",855],")",")",")",",",["T_WHITESPACE","\n                ",855],["T_CONSTANT_ENCAPSED_STRING","'store.entity_id = def.entity_id AND store.attribute_id = def.attribute_id '",856],["T_WHITESPACE","\n                    ",856],".",["T_WHITESPACE"," ",857],["T_CONSTANT_ENCAPSED_STRING","'AND store.store_id = '",857],["T_WHITESPACE"," ",857],".",["T_WHITESPACE"," ",857],["T_VARIABLE","$storeId",857],",",["T_WHITESPACE","\n                ",857],["T_ARRAY","array",858],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",858],["T_WHITESPACE"," ",858],["T_DOUBLE_ARROW","=>",858],["T_WHITESPACE"," ",858],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","_getWriteAdapter",858],"(",")",["T_OBJECT_OPERATOR","->",858],["T_STRING","getCheckSql",858],"(",["T_WHITESPACE","\n                    ",858],["T_CONSTANT_ENCAPSED_STRING","'store.value_id > 0'",859],",",["T_WHITESPACE","\n                    ",859],["T_VARIABLE","$this",860],["T_OBJECT_OPERATOR","->",860],["T_STRING","_getWriteAdapter",860],"(",")",["T_OBJECT_OPERATOR","->",860],["T_STRING","quoteIdentifier",860],"(",["T_CONSTANT_ENCAPSED_STRING","'store.value'",860],")",",",["T_WHITESPACE","\n                    ",860],["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","_getWriteAdapter",861],"(",")",["T_OBJECT_OPERATOR","->",861],["T_STRING","quoteIdentifier",861],"(",["T_CONSTANT_ENCAPSED_STRING","'def.value'",861],")",["T_WHITESPACE","\n                ",861],")",")",["T_WHITESPACE","\n            ",862],")",["T_WHITESPACE","\n            ",863],["T_OBJECT_OPERATOR","->",864],["T_STRING","where",864],"(",["T_CONSTANT_ENCAPSED_STRING","'def.entity_id IN (?)'",864],",",["T_WHITESPACE"," ",864],["T_VARIABLE","$entityIds",864],")",["T_WHITESPACE","\n            ",864],["T_OBJECT_OPERATOR","->",865],["T_STRING","where",865],"(",["T_CONSTANT_ENCAPSED_STRING","'def.store_id IN (?)'",865],",",["T_WHITESPACE"," ",865],["T_ARRAY","array",865],"(",["T_STRING","Mage_Catalog_Model_Abstract",865],["T_DOUBLE_COLON","::",865],["T_STRING","DEFAULT_STORE_ID",865],",",["T_WHITESPACE"," ",865],["T_VARIABLE","$storeId",865],")",")",";",["T_WHITESPACE","\n        ",865],["T_RETURN","return",866],["T_WHITESPACE"," ",866],["T_VARIABLE","$this",866],["T_OBJECT_OPERATOR","->",866],["T_STRING","_getWriteAdapter",866],"(",")",["T_OBJECT_OPERATOR","->",866],["T_STRING","fetchAll",866],"(",["T_VARIABLE","$select",866],")",";",["T_WHITESPACE","\n    ",866],"}",["T_WHITESPACE","\n\n    ",867],["T_DOC_COMMENT","\/**\n     * Delete store table(s) of given stores;\n     *\n     * @param array|integer $stores\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",869],["T_WHITESPACE","\n    ",874],["T_PUBLIC","public",875],["T_WHITESPACE"," ",875],["T_FUNCTION","function",875],["T_WHITESPACE"," ",875],["T_STRING","deleteStores",875],"(",["T_VARIABLE","$stores",875],")",["T_WHITESPACE","\n    ",875],"{",["T_WHITESPACE","\n        ",876],["T_VARIABLE","$this",877],["T_OBJECT_OPERATOR","->",877],["T_STRING","_deleteTable",877],"(",["T_VARIABLE","$stores",877],")",";",["T_WHITESPACE","\n        ",877],["T_RETURN","return",878],["T_WHITESPACE"," ",878],["T_VARIABLE","$this",878],";",["T_WHITESPACE","\n    ",878],"}",["T_WHITESPACE","\n\n    ",879],["T_DOC_COMMENT","\/**\n     * Delete table(s) of given stores.\n     *\n     * @param array|integer $stores\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",881],["T_WHITESPACE","\n    ",886],["T_PROTECTED","protected",887],["T_WHITESPACE"," ",887],["T_FUNCTION","function",887],["T_WHITESPACE"," ",887],["T_STRING","_deleteTable",887],"(",["T_VARIABLE","$stores",887],")",["T_WHITESPACE","\n    ",887],"{",["T_WHITESPACE","\n        ",888],["T_IF","if",889],["T_WHITESPACE"," ",889],"(","!",["T_STRING","is_array",889],"(",["T_VARIABLE","$stores",889],")",")",["T_WHITESPACE"," ",889],"{",["T_WHITESPACE","\n            ",889],["T_VARIABLE","$stores",890],["T_WHITESPACE"," ",890],"=",["T_WHITESPACE"," ",890],["T_ARRAY","array",890],"(",["T_VARIABLE","$stores",890],")",";",["T_WHITESPACE","\n        ",890],"}",["T_WHITESPACE","\n        ",891],["T_FOREACH","foreach",892],["T_WHITESPACE"," ",892],"(",["T_VARIABLE","$stores",892],["T_WHITESPACE"," ",892],["T_AS","as",892],["T_WHITESPACE"," ",892],["T_VARIABLE","$store",892],")",["T_WHITESPACE"," ",892],"{",["T_WHITESPACE","\n            ",892],["T_VARIABLE","$this",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","_getWriteAdapter",893],"(",")",["T_OBJECT_OPERATOR","->",893],["T_STRING","dropTable",893],"(",["T_VARIABLE","$this",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","getMainStoreTable",893],"(",["T_VARIABLE","$store",893],")",")",";",["T_WHITESPACE","\n        ",893],"}",["T_WHITESPACE","\n        ",894],["T_RETURN","return",895],["T_WHITESPACE"," ",895],["T_VARIABLE","$this",895],";",["T_WHITESPACE","\n    ",895],"}",["T_WHITESPACE","\n\n    ",896],["T_DOC_COMMENT","\/**\n     * Synchronize flat data with eav model for category\n     *\n     * @param Varien_Object $category\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",898],["T_WHITESPACE","\n    ",903],["T_PROTECTED","protected",904],["T_WHITESPACE"," ",904],["T_FUNCTION","function",904],["T_WHITESPACE"," ",904],["T_STRING","_synchronize",904],"(",["T_VARIABLE","$category",904],")",["T_WHITESPACE","\n    ",904],"{",["T_WHITESPACE","\n        ",905],["T_VARIABLE","$table",906],["T_WHITESPACE"," ",906],"=",["T_WHITESPACE"," ",906],["T_VARIABLE","$this",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","getMainStoreTable",906],"(",["T_VARIABLE","$category",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","getStoreId",906],"(",")",")",";",["T_WHITESPACE","\n        ",906],["T_VARIABLE","$data",907],["T_WHITESPACE","  ",907],"=",["T_WHITESPACE"," ",907],["T_VARIABLE","$this",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","_prepareDataForAllFields",907],"(",["T_VARIABLE","$category",907],")",";",["T_WHITESPACE","\n        ",907],["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","_getWriteAdapter",908],"(",")",["T_OBJECT_OPERATOR","->",908],["T_STRING","insertOnDuplicate",908],"(",["T_VARIABLE","$table",908],",",["T_WHITESPACE"," ",908],["T_VARIABLE","$data",908],")",";",["T_WHITESPACE","\n        ",908],["T_RETURN","return",909],["T_WHITESPACE"," ",909],["T_VARIABLE","$this",909],";",["T_WHITESPACE","\n    ",909],"}",["T_WHITESPACE","\n\n    ",910],["T_DOC_COMMENT","\/**\n     * Synchronize flat data with eav model.\n     *\n     * @param Mage_Catalog_Model_Category|int $category\n     * @param array $storeIds\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",912],["T_WHITESPACE","\n    ",918],["T_PUBLIC","public",919],["T_WHITESPACE"," ",919],["T_FUNCTION","function",919],["T_WHITESPACE"," ",919],["T_STRING","synchronize",919],"(",["T_VARIABLE","$category",919],["T_WHITESPACE"," ",919],"=",["T_WHITESPACE"," ",919],["T_STRING","null",919],",",["T_WHITESPACE"," ",919],["T_VARIABLE","$storeIds",919],["T_WHITESPACE"," ",919],"=",["T_WHITESPACE"," ",919],["T_ARRAY","array",919],"(",")",")",["T_WHITESPACE","\n    ",919],"{",["T_WHITESPACE","\n        ",920],["T_IF","if",921],["T_WHITESPACE"," ",921],"(",["T_STRING","is_null",921],"(",["T_VARIABLE","$category",921],")",")",["T_WHITESPACE"," ",921],"{",["T_WHITESPACE","\n            ",921],["T_IF","if",922],["T_WHITESPACE"," ",922],"(",["T_EMPTY","empty",922],"(",["T_VARIABLE","$storeIds",922],")",")",["T_WHITESPACE"," ",922],"{",["T_WHITESPACE","\n                ",922],["T_VARIABLE","$storeIds",923],["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_STRING","null",923],";",["T_WHITESPACE","\n            ",923],"}",["T_WHITESPACE","\n            ",924],["T_VARIABLE","$stores",925],["T_WHITESPACE"," ",925],"=",["T_WHITESPACE"," ",925],["T_VARIABLE","$this",925],["T_OBJECT_OPERATOR","->",925],["T_STRING","getStoresRootCategories",925],"(",["T_VARIABLE","$storeIds",925],")",";",["T_WHITESPACE","\n\n            ",925],["T_VARIABLE","$storesObjects",927],["T_WHITESPACE"," ",927],"=",["T_WHITESPACE"," ",927],["T_ARRAY","array",927],"(",")",";",["T_WHITESPACE","\n            ",927],["T_FOREACH","foreach",928],["T_WHITESPACE"," ",928],"(",["T_VARIABLE","$stores",928],["T_WHITESPACE"," ",928],["T_AS","as",928],["T_WHITESPACE"," ",928],["T_VARIABLE","$storeId",928],["T_WHITESPACE"," ",928],["T_DOUBLE_ARROW","=>",928],["T_WHITESPACE"," ",928],["T_VARIABLE","$rootCategoryId",928],")",["T_WHITESPACE"," ",928],"{",["T_WHITESPACE","\n                ",928],["T_VARIABLE","$_store",929],["T_WHITESPACE"," ",929],"=",["T_WHITESPACE"," ",929],["T_NEW","new",929],["T_WHITESPACE"," ",929],["T_STRING","Varien_Object",929],"(",["T_ARRAY","array",929],"(",["T_WHITESPACE","\n                    ",929],["T_CONSTANT_ENCAPSED_STRING","'store_id'",930],["T_WHITESPACE","          ",930],["T_DOUBLE_ARROW","=>",930],["T_WHITESPACE"," ",930],["T_VARIABLE","$storeId",930],",",["T_WHITESPACE","\n                    ",930],["T_CONSTANT_ENCAPSED_STRING","'root_category_id'",931],["T_WHITESPACE","  ",931],["T_DOUBLE_ARROW","=>",931],["T_WHITESPACE"," ",931],["T_VARIABLE","$rootCategoryId",931],["T_WHITESPACE","\n                ",931],")",")",";",["T_WHITESPACE","\n                ",932],["T_VARIABLE","$_store",933],["T_OBJECT_OPERATOR","->",933],["T_STRING","setIdFieldName",933],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",933],")",";",["T_WHITESPACE","\n                ",933],["T_VARIABLE","$storesObjects",934],"[","]",["T_WHITESPACE"," ",934],"=",["T_WHITESPACE"," ",934],["T_VARIABLE","$_store",934],";",["T_WHITESPACE","\n            ",934],"}",["T_WHITESPACE","\n\n            ",935],["T_VARIABLE","$this",937],["T_OBJECT_OPERATOR","->",937],["T_STRING","rebuild",937],"(",["T_VARIABLE","$storesObjects",937],")",";",["T_WHITESPACE","\n        ",937],"}",["T_WHITESPACE"," ",938],["T_ELSE","else",938],["T_WHITESPACE"," ",938],["T_IF","if",938],["T_WHITESPACE"," ",938],"(",["T_VARIABLE","$category",938],["T_WHITESPACE"," ",938],["T_INSTANCEOF","instanceof",938],["T_WHITESPACE"," ",938],["T_STRING","Mage_Catalog_Model_Category",938],")",["T_WHITESPACE"," ",938],"{",["T_WHITESPACE","\n            ",938],["T_VARIABLE","$categoryId",939],["T_WHITESPACE"," ",939],"=",["T_WHITESPACE"," ",939],["T_VARIABLE","$category",939],["T_OBJECT_OPERATOR","->",939],["T_STRING","getId",939],"(",")",";",["T_WHITESPACE","\n            ",939],["T_FOREACH","foreach",940],["T_WHITESPACE"," ",940],"(",["T_VARIABLE","$category",940],["T_OBJECT_OPERATOR","->",940],["T_STRING","getStoreIds",940],"(",")",["T_WHITESPACE"," ",940],["T_AS","as",940],["T_WHITESPACE"," ",940],["T_VARIABLE","$storeId",940],")",["T_WHITESPACE"," ",940],"{",["T_WHITESPACE","\n                ",940],["T_IF","if",941],["T_WHITESPACE"," ",941],"(",["T_VARIABLE","$storeId",941],["T_WHITESPACE"," ",941],["T_IS_EQUAL","==",941],["T_WHITESPACE"," ",941],["T_STRING","Mage_Catalog_Model_Abstract",941],["T_DOUBLE_COLON","::",941],["T_STRING","DEFAULT_STORE_ID",941],")",["T_WHITESPACE"," ",941],"{",["T_WHITESPACE","\n                    ",941],["T_CONTINUE","continue",942],";",["T_WHITESPACE","\n                ",942],"}",["T_WHITESPACE","\n\n                ",943],["T_VARIABLE","$attributeValues",945],["T_WHITESPACE"," ",945],"=",["T_WHITESPACE"," ",945],["T_VARIABLE","$this",945],["T_OBJECT_OPERATOR","->",945],["T_STRING","_getAttributeValues",945],"(",["T_VARIABLE","$categoryId",945],",",["T_WHITESPACE"," ",945],["T_VARIABLE","$storeId",945],")",";",["T_WHITESPACE","\n                ",945],["T_VARIABLE","$data",946],["T_WHITESPACE"," ",946],"=",["T_WHITESPACE"," ",946],["T_NEW","new",946],["T_WHITESPACE"," ",946],["T_STRING","Varien_Object",946],"(",["T_VARIABLE","$category",946],["T_OBJECT_OPERATOR","->",946],["T_STRING","getData",946],"(",")",")",";",["T_WHITESPACE","\n                ",946],["T_VARIABLE","$data",947],["T_OBJECT_OPERATOR","->",947],["T_STRING","addData",947],"(",["T_VARIABLE","$attributeValues",947],"[",["T_VARIABLE","$categoryId",947],"]",")",["T_WHITESPACE","\n                    ",947],["T_OBJECT_OPERATOR","->",948],["T_STRING","setStoreId",948],"(",["T_VARIABLE","$storeId",948],")",";",["T_WHITESPACE","\n                ",948],["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","_synchronize",949],"(",["T_VARIABLE","$data",949],")",";",["T_WHITESPACE","\n            ",949],"}",["T_WHITESPACE","\n        ",950],"}",["T_WHITESPACE"," ",951],["T_ELSE","else",951],["T_WHITESPACE"," ",951],["T_IF","if",951],["T_WHITESPACE"," ",951],"(",["T_STRING","is_numeric",951],"(",["T_VARIABLE","$category",951],")",")",["T_WHITESPACE"," ",951],"{",["T_WHITESPACE","\n            ",951],["T_VARIABLE","$write",952],["T_WHITESPACE","  ",952],"=",["T_WHITESPACE"," ",952],["T_VARIABLE","$this",952],["T_OBJECT_OPERATOR","->",952],["T_STRING","_getWriteAdapter",952],"(",")",";",["T_WHITESPACE","\n            ",952],["T_VARIABLE","$select",953],["T_WHITESPACE"," ",953],"=",["T_WHITESPACE"," ",953],["T_VARIABLE","$write",953],["T_OBJECT_OPERATOR","->",953],["T_STRING","select",953],"(",")",["T_WHITESPACE","\n                ",953],["T_OBJECT_OPERATOR","->",954],["T_STRING","from",954],"(",["T_VARIABLE","$this",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","getTable",954],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",954],")",")",["T_WHITESPACE","\n                ",954],["T_OBJECT_OPERATOR","->",955],["T_STRING","where",955],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id=?'",955],",",["T_WHITESPACE"," ",955],["T_VARIABLE","$category",955],")",";",["T_WHITESPACE","\n            ",955],["T_VARIABLE","$row",956],["T_WHITESPACE","    ",956],"=",["T_WHITESPACE"," ",956],["T_VARIABLE","$write",956],["T_OBJECT_OPERATOR","->",956],["T_STRING","fetchRow",956],"(",["T_VARIABLE","$select",956],")",";",["T_WHITESPACE","\n            ",956],["T_IF","if",957],["T_WHITESPACE"," ",957],"(","!",["T_VARIABLE","$row",957],")",["T_WHITESPACE"," ",957],"{",["T_WHITESPACE","\n                ",957],["T_RETURN","return",958],["T_WHITESPACE"," ",958],["T_VARIABLE","$this",958],";",["T_WHITESPACE","\n            ",958],"}",["T_WHITESPACE","\n\n            ",959],["T_VARIABLE","$stores",961],["T_WHITESPACE"," ",961],"=",["T_WHITESPACE"," ",961],["T_VARIABLE","$this",961],["T_OBJECT_OPERATOR","->",961],["T_STRING","getStoresRootCategories",961],"(",")",";",["T_WHITESPACE","\n            ",961],["T_VARIABLE","$path",962],["T_WHITESPACE","   ",962],"=",["T_WHITESPACE"," ",962],["T_STRING","explode",962],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",962],",",["T_WHITESPACE"," ",962],["T_VARIABLE","$row",962],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",962],"]",")",";",["T_WHITESPACE","\n            ",962],["T_FOREACH","foreach",963],["T_WHITESPACE"," ",963],"(",["T_VARIABLE","$stores",963],["T_WHITESPACE"," ",963],["T_AS","as",963],["T_WHITESPACE"," ",963],["T_VARIABLE","$storeId",963],["T_WHITESPACE"," ",963],["T_DOUBLE_ARROW","=>",963],["T_WHITESPACE"," ",963],["T_VARIABLE","$rootCategoryId",963],")",["T_WHITESPACE"," ",963],"{",["T_WHITESPACE","\n                ",963],["T_IF","if",964],["T_WHITESPACE"," ",964],"(",["T_STRING","in_array",964],"(",["T_VARIABLE","$rootCategoryId",964],",",["T_WHITESPACE"," ",964],["T_VARIABLE","$path",964],")",")",["T_WHITESPACE"," ",964],"{",["T_WHITESPACE","\n                    ",964],["T_VARIABLE","$attributeValues",965],["T_WHITESPACE"," ",965],"=",["T_WHITESPACE"," ",965],["T_VARIABLE","$this",965],["T_OBJECT_OPERATOR","->",965],["T_STRING","_getAttributeValues",965],"(",["T_VARIABLE","$category",965],",",["T_WHITESPACE"," ",965],["T_VARIABLE","$storeId",965],")",";",["T_WHITESPACE","\n                    ",965],["T_VARIABLE","$data",966],["T_WHITESPACE"," ",966],"=",["T_WHITESPACE"," ",966],["T_NEW","new",966],["T_WHITESPACE"," ",966],["T_STRING","Varien_Object",966],"(",["T_VARIABLE","$row",966],")",";",["T_WHITESPACE","\n                    ",966],["T_VARIABLE","$data",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","addData",967],"(",["T_VARIABLE","$attributeValues",967],"[",["T_VARIABLE","$category",967],"]",")",["T_WHITESPACE","\n                        ",967],["T_OBJECT_OPERATOR","->",968],["T_STRING","setStoreId",968],"(",["T_VARIABLE","$storeId",968],")",";",["T_WHITESPACE","\n                    ",968],["T_VARIABLE","$this",969],["T_OBJECT_OPERATOR","->",969],["T_STRING","_synchronize",969],"(",["T_VARIABLE","$data",969],")",";",["T_WHITESPACE","\n                ",969],"}",["T_WHITESPACE"," ",970],["T_ELSE","else",970],["T_WHITESPACE"," ",970],"{",["T_WHITESPACE","\n                    ",970],["T_VARIABLE","$where",971],["T_WHITESPACE"," ",971],"=",["T_WHITESPACE"," ",971],["T_VARIABLE","$write",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","quoteInto",971],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",971],",",["T_WHITESPACE"," ",971],["T_VARIABLE","$category",971],")",";",["T_WHITESPACE","\n                    ",971],["T_VARIABLE","$write",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","delete",972],"(",["T_VARIABLE","$this",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","getMainStoreTable",972],"(",["T_VARIABLE","$storeId",972],")",",",["T_WHITESPACE"," ",972],["T_VARIABLE","$where",972],")",";",["T_WHITESPACE","\n                ",972],"}",["T_WHITESPACE","\n            ",973],"}",["T_WHITESPACE","\n        ",974],"}",["T_WHITESPACE","\n\n        ",975],["T_RETURN","return",977],["T_WHITESPACE"," ",977],["T_VARIABLE","$this",977],";",["T_WHITESPACE","\n    ",977],"}",["T_WHITESPACE","\n\n    ",978],["T_DOC_COMMENT","\/**\n     * Remove table of given stores\n     *\n     * @param int|array $stores\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",980],["T_WHITESPACE","\n    ",985],["T_PUBLIC","public",986],["T_WHITESPACE"," ",986],["T_FUNCTION","function",986],["T_WHITESPACE"," ",986],["T_STRING","removeStores",986],"(",["T_VARIABLE","$stores",986],")",["T_WHITESPACE","\n    ",986],"{",["T_WHITESPACE","\n        ",987],["T_VARIABLE","$this",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","_deleteTable",988],"(",["T_VARIABLE","$stores",988],")",";",["T_WHITESPACE","\n        ",988],["T_RETURN","return",989],["T_WHITESPACE"," ",989],["T_VARIABLE","$this",989],";",["T_WHITESPACE","\n    ",989],"}",["T_WHITESPACE","\n\n    ",990],["T_DOC_COMMENT","\/**\n     * Synchronize flat category data after move by affected category ids\n     *\n     * @param array $affectedCategoryIds\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",992],["T_WHITESPACE","\n    ",997],["T_PUBLIC","public",998],["T_WHITESPACE"," ",998],["T_FUNCTION","function",998],["T_WHITESPACE"," ",998],["T_STRING","move",998],"(",["T_ARRAY","array",998],["T_WHITESPACE"," ",998],["T_VARIABLE","$affectedCategoryIds",998],")",["T_WHITESPACE","\n    ",998],"{",["T_WHITESPACE","\n        ",999],["T_VARIABLE","$write",1000],["T_WHITESPACE","  ",1000],"=",["T_WHITESPACE"," ",1000],["T_VARIABLE","$this",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","_getWriteAdapter",1000],"(",")",";",["T_WHITESPACE","\n        ",1000],["T_VARIABLE","$select",1001],["T_WHITESPACE"," ",1001],"=",["T_WHITESPACE"," ",1001],["T_VARIABLE","$write",1001],["T_OBJECT_OPERATOR","->",1001],["T_STRING","select",1001],"(",")",["T_WHITESPACE","\n            ",1001],["T_OBJECT_OPERATOR","->",1002],["T_STRING","from",1002],"(",["T_VARIABLE","$this",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","getTable",1002],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1002],")",",",["T_WHITESPACE"," ",1002],["T_ARRAY","array",1002],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1002],",",["T_WHITESPACE"," ",1002],["T_CONSTANT_ENCAPSED_STRING","'path'",1002],")",")",["T_WHITESPACE","\n            ",1002],["T_OBJECT_OPERATOR","->",1003],["T_STRING","where",1003],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",1003],",",["T_WHITESPACE"," ",1003],["T_VARIABLE","$affectedCategoryIds",1003],")",";",["T_WHITESPACE","\n        ",1003],["T_VARIABLE","$pairs",1004],["T_WHITESPACE","  ",1004],"=",["T_WHITESPACE"," ",1004],["T_VARIABLE","$write",1004],["T_OBJECT_OPERATOR","->",1004],["T_STRING","fetchPairs",1004],"(",["T_VARIABLE","$select",1004],")",";",["T_WHITESPACE","\n\n        ",1004],["T_VARIABLE","$pathCond",1006],["T_WHITESPACE","  ",1006],"=",["T_WHITESPACE"," ",1006],["T_ARRAY","array",1006],"(",["T_VARIABLE","$write",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","quoteInto",1006],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",1006],",",["T_WHITESPACE"," ",1006],["T_VARIABLE","$affectedCategoryIds",1006],")",")",";",["T_WHITESPACE","\n        ",1006],["T_VARIABLE","$parentIds",1007],["T_WHITESPACE"," ",1007],"=",["T_WHITESPACE"," ",1007],["T_ARRAY","array",1007],"(",")",";",["T_WHITESPACE","\n\n        ",1007],["T_FOREACH","foreach",1009],["T_WHITESPACE"," ",1009],"(",["T_VARIABLE","$pairs",1009],["T_WHITESPACE"," ",1009],["T_AS","as",1009],["T_WHITESPACE"," ",1009],["T_VARIABLE","$path",1009],")",["T_WHITESPACE"," ",1009],"{",["T_WHITESPACE","\n            ",1009],["T_VARIABLE","$pathCond",1010],"[","]",["T_WHITESPACE"," ",1010],"=",["T_WHITESPACE"," ",1010],["T_VARIABLE","$write",1010],["T_OBJECT_OPERATOR","->",1010],["T_STRING","quoteInto",1010],"(",["T_CONSTANT_ENCAPSED_STRING","'path LIKE ?'",1010],",",["T_WHITESPACE"," ",1010],["T_VARIABLE","$path",1010],["T_WHITESPACE"," ",1010],".",["T_WHITESPACE"," ",1010],["T_CONSTANT_ENCAPSED_STRING","'\/%'",1010],")",";",["T_WHITESPACE","\n            ",1010],["T_VARIABLE","$parentIds",1011],["T_WHITESPACE","  ",1011],"=",["T_WHITESPACE"," ",1011],["T_STRING","array_merge",1011],"(",["T_VARIABLE","$parentIds",1011],",",["T_WHITESPACE"," ",1011],["T_STRING","explode",1011],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",1011],",",["T_WHITESPACE"," ",1011],["T_VARIABLE","$path",1011],")",")",";",["T_WHITESPACE","\n        ",1011],"}",["T_WHITESPACE","\n\n        ",1012],["T_VARIABLE","$stores",1014],["T_WHITESPACE"," ",1014],"=",["T_WHITESPACE"," ",1014],["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","getStoresRootCategories",1014],"(",")",";",["T_WHITESPACE","\n        ",1014],["T_VARIABLE","$where",1015],["T_WHITESPACE","  ",1015],"=",["T_WHITESPACE"," ",1015],["T_STRING","join",1015],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",1015],",",["T_WHITESPACE"," ",1015],["T_VARIABLE","$pathCond",1015],")",";",["T_WHITESPACE","\n        ",1015],["T_VARIABLE","$lastId",1016],["T_WHITESPACE"," ",1016],"=",["T_WHITESPACE"," ",1016],["T_LNUMBER","0",1016],";",["T_WHITESPACE","\n        ",1016],["T_WHILE","while",1017],["T_WHITESPACE"," ",1017],"(",["T_STRING","true",1017],")",["T_WHITESPACE"," ",1017],"{",["T_WHITESPACE","\n            ",1017],["T_VARIABLE","$select",1018],["T_WHITESPACE"," ",1018],"=",["T_WHITESPACE"," ",1018],["T_VARIABLE","$write",1018],["T_OBJECT_OPERATOR","->",1018],["T_STRING","select",1018],"(",")",["T_WHITESPACE","\n                ",1018],["T_OBJECT_OPERATOR","->",1019],["T_STRING","from",1019],"(",["T_VARIABLE","$this",1019],["T_OBJECT_OPERATOR","->",1019],["T_STRING","getTable",1019],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1019],")",")",["T_WHITESPACE","\n                ",1019],["T_OBJECT_OPERATOR","->",1020],["T_STRING","where",1020],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id>?'",1020],",",["T_WHITESPACE"," ",1020],["T_VARIABLE","$lastId",1020],")",["T_WHITESPACE","\n                ",1020],["T_OBJECT_OPERATOR","->",1021],["T_STRING","where",1021],"(",["T_VARIABLE","$where",1021],")",["T_WHITESPACE","\n                ",1021],["T_OBJECT_OPERATOR","->",1022],["T_STRING","order",1022],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1022],")",["T_WHITESPACE","\n                ",1022],["T_OBJECT_OPERATOR","->",1023],["T_STRING","limit",1023],"(",["T_LNUMBER","500",1023],")",";",["T_WHITESPACE","\n            ",1023],["T_VARIABLE","$rowSet",1024],["T_WHITESPACE"," ",1024],"=",["T_WHITESPACE"," ",1024],["T_VARIABLE","$write",1024],["T_OBJECT_OPERATOR","->",1024],["T_STRING","fetchAll",1024],"(",["T_VARIABLE","$select",1024],")",";",["T_WHITESPACE","\n\n            ",1024],["T_IF","if",1026],["T_WHITESPACE"," ",1026],"(","!",["T_VARIABLE","$rowSet",1026],")",["T_WHITESPACE"," ",1026],"{",["T_WHITESPACE","\n                ",1026],["T_BREAK","break",1027],";",["T_WHITESPACE","\n            ",1027],"}",["T_WHITESPACE","\n\n            ",1028],["T_VARIABLE","$addStores",1030],["T_WHITESPACE"," ",1030],"=",["T_WHITESPACE"," ",1030],["T_ARRAY","array",1030],"(",")",";",["T_WHITESPACE","\n            ",1030],["T_VARIABLE","$remStores",1031],["T_WHITESPACE"," ",1031],"=",["T_WHITESPACE"," ",1031],["T_ARRAY","array",1031],"(",")",";",["T_WHITESPACE","\n\n            ",1031],["T_FOREACH","foreach",1033],["T_WHITESPACE"," ",1033],"(",["T_VARIABLE","$rowSet",1033],["T_WHITESPACE"," ",1033],["T_AS","as",1033],["T_WHITESPACE"," ",1033],"&",["T_VARIABLE","$row",1033],")",["T_WHITESPACE"," ",1033],"{",["T_WHITESPACE","\n                ",1033],["T_VARIABLE","$lastId",1034],["T_WHITESPACE"," ",1034],"=",["T_WHITESPACE"," ",1034],["T_VARIABLE","$row",1034],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1034],"]",";",["T_WHITESPACE","\n                ",1034],["T_VARIABLE","$path",1035],["T_WHITESPACE"," ",1035],"=",["T_WHITESPACE"," ",1035],["T_STRING","explode",1035],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",1035],",",["T_WHITESPACE"," ",1035],["T_VARIABLE","$row",1035],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",1035],"]",")",";",["T_WHITESPACE","\n                ",1035],["T_FOREACH","foreach",1036],["T_WHITESPACE"," ",1036],"(",["T_VARIABLE","$stores",1036],["T_WHITESPACE"," ",1036],["T_AS","as",1036],["T_WHITESPACE"," ",1036],["T_VARIABLE","$storeId",1036],["T_WHITESPACE"," ",1036],["T_DOUBLE_ARROW","=>",1036],["T_WHITESPACE"," ",1036],["T_VARIABLE","$rootCategoryId",1036],")",["T_WHITESPACE"," ",1036],"{",["T_WHITESPACE","\n                    ",1036],["T_IF","if",1037],["T_WHITESPACE"," ",1037],"(",["T_STRING","in_array",1037],"(",["T_VARIABLE","$rootCategoryId",1037],",",["T_WHITESPACE"," ",1037],["T_VARIABLE","$path",1037],")",")",["T_WHITESPACE"," ",1037],"{",["T_WHITESPACE","\n                        ",1037],["T_VARIABLE","$addStores",1038],"[",["T_VARIABLE","$storeId",1038],"]","[",["T_VARIABLE","$row",1038],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1038],"]","]",["T_WHITESPACE"," ",1038],"=",["T_WHITESPACE"," ",1038],["T_VARIABLE","$row",1038],";",["T_WHITESPACE","\n                    ",1038],"}",["T_WHITESPACE"," ",1039],["T_ELSE","else",1039],["T_WHITESPACE"," ",1039],"{",["T_WHITESPACE","\n                        ",1039],["T_VARIABLE","$remStores",1040],"[",["T_VARIABLE","$storeId",1040],"]","[","]",["T_WHITESPACE"," ",1040],"=",["T_WHITESPACE"," ",1040],["T_VARIABLE","$row",1040],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1040],"]",";",["T_WHITESPACE","\n                    ",1040],"}",["T_WHITESPACE","\n                ",1041],"}",["T_WHITESPACE","\n            ",1042],"}",["T_WHITESPACE","\n\n            ",1043],["T_COMMENT","\/\/ remove\n",1045],["T_WHITESPACE","            ",1046],["T_FOREACH","foreach",1046],["T_WHITESPACE"," ",1046],"(",["T_VARIABLE","$remStores",1046],["T_WHITESPACE"," ",1046],["T_AS","as",1046],["T_WHITESPACE"," ",1046],["T_VARIABLE","$storeId",1046],["T_WHITESPACE"," ",1046],["T_DOUBLE_ARROW","=>",1046],["T_WHITESPACE"," ",1046],["T_VARIABLE","$categoryIds",1046],")",["T_WHITESPACE"," ",1046],"{",["T_WHITESPACE","\n                ",1046],["T_VARIABLE","$where",1047],["T_WHITESPACE"," ",1047],"=",["T_WHITESPACE"," ",1047],["T_VARIABLE","$write",1047],["T_OBJECT_OPERATOR","->",1047],["T_STRING","quoteInto",1047],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",1047],",",["T_WHITESPACE"," ",1047],["T_VARIABLE","$categoryIds",1047],")",";",["T_WHITESPACE","\n                ",1047],["T_VARIABLE","$write",1048],["T_OBJECT_OPERATOR","->",1048],["T_STRING","delete",1048],"(",["T_VARIABLE","$this",1048],["T_OBJECT_OPERATOR","->",1048],["T_STRING","getMainStoreTable",1048],"(",["T_VARIABLE","$storeId",1048],")",",",["T_WHITESPACE"," ",1048],["T_VARIABLE","$where",1048],")",";",["T_WHITESPACE","\n            ",1048],"}",["T_WHITESPACE","\n\n            ",1049],["T_COMMENT","\/\/ add\/update\n",1051],["T_WHITESPACE","            ",1052],["T_FOREACH","foreach",1052],["T_WHITESPACE"," ",1052],"(",["T_VARIABLE","$addStores",1052],["T_WHITESPACE"," ",1052],["T_AS","as",1052],["T_WHITESPACE"," ",1052],["T_VARIABLE","$storeId",1052],["T_WHITESPACE"," ",1052],["T_DOUBLE_ARROW","=>",1052],["T_WHITESPACE"," ",1052],["T_VARIABLE","$storeCategoryIds",1052],")",["T_WHITESPACE"," ",1052],"{",["T_WHITESPACE","\n                ",1052],["T_VARIABLE","$attributeValues",1053],["T_WHITESPACE"," ",1053],"=",["T_WHITESPACE"," ",1053],["T_VARIABLE","$this",1053],["T_OBJECT_OPERATOR","->",1053],["T_STRING","_getAttributeValues",1053],"(",["T_STRING","array_keys",1053],"(",["T_VARIABLE","$storeCategoryIds",1053],")",",",["T_WHITESPACE"," ",1053],["T_VARIABLE","$storeId",1053],")",";",["T_WHITESPACE","\n                ",1053],["T_FOREACH","foreach",1054],["T_WHITESPACE"," ",1054],"(",["T_VARIABLE","$storeCategoryIds",1054],["T_WHITESPACE"," ",1054],["T_AS","as",1054],["T_WHITESPACE"," ",1054],["T_VARIABLE","$row",1054],")",["T_WHITESPACE"," ",1054],"{",["T_WHITESPACE","\n                    ",1054],["T_VARIABLE","$data",1055],["T_WHITESPACE"," ",1055],"=",["T_WHITESPACE"," ",1055],["T_NEW","new",1055],["T_WHITESPACE"," ",1055],["T_STRING","Varien_Object",1055],"(",["T_VARIABLE","$row",1055],")",";",["T_WHITESPACE","\n                    ",1055],["T_VARIABLE","$data",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","addData",1056],"(",["T_VARIABLE","$attributeValues",1056],"[",["T_VARIABLE","$row",1056],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1056],"]","]",")",["T_WHITESPACE","\n                        ",1056],["T_OBJECT_OPERATOR","->",1057],["T_STRING","setStoreId",1057],"(",["T_VARIABLE","$storeId",1057],")",";",["T_WHITESPACE","\n                    ",1057],["T_VARIABLE","$this",1058],["T_OBJECT_OPERATOR","->",1058],["T_STRING","_synchronize",1058],"(",["T_VARIABLE","$data",1058],")",";",["T_WHITESPACE","\n                ",1058],"}",["T_WHITESPACE","\n            ",1059],"}",["T_WHITESPACE","\n        ",1060],"}",["T_WHITESPACE","\n\n        ",1061],["T_RETURN","return",1063],["T_WHITESPACE"," ",1063],["T_VARIABLE","$this",1063],";",["T_WHITESPACE","\n    ",1063],"}",["T_WHITESPACE","\n\n    ",1064],["T_DOC_COMMENT","\/**\n     * Synchronize flat data with eav after moving category\n     *\n     * @param integer $categoryId\n     * @param integer $prevParentId\n     * @param integer $parentId\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",1066],["T_WHITESPACE","\n    ",1073],["T_PUBLIC","public",1074],["T_WHITESPACE"," ",1074],["T_FUNCTION","function",1074],["T_WHITESPACE"," ",1074],["T_STRING","moveold",1074],"(",["T_VARIABLE","$categoryId",1074],",",["T_WHITESPACE"," ",1074],["T_VARIABLE","$prevParentId",1074],",",["T_WHITESPACE"," ",1074],["T_VARIABLE","$parentId",1074],")",["T_WHITESPACE","\n    ",1074],"{",["T_WHITESPACE","\n        ",1075],["T_VARIABLE","$catalogCategoryTable",1076],["T_WHITESPACE"," ",1076],"=",["T_WHITESPACE"," ",1076],["T_VARIABLE","$this",1076],["T_OBJECT_OPERATOR","->",1076],["T_STRING","getTable",1076],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1076],")",";",["T_WHITESPACE","\n        ",1076],["T_VARIABLE","$_staticFields",1077],["T_WHITESPACE"," ",1077],"=",["T_WHITESPACE"," ",1077],["T_ARRAY","array",1077],"(",["T_WHITESPACE","\n            ",1077],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",1078],",",["T_WHITESPACE","\n            ",1078],["T_CONSTANT_ENCAPSED_STRING","'path'",1079],",",["T_WHITESPACE","\n            ",1079],["T_CONSTANT_ENCAPSED_STRING","'level'",1080],",",["T_WHITESPACE","\n            ",1080],["T_CONSTANT_ENCAPSED_STRING","'position'",1081],",",["T_WHITESPACE","\n            ",1081],["T_CONSTANT_ENCAPSED_STRING","'children_count'",1082],",",["T_WHITESPACE","\n            ",1082],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",1083],["T_WHITESPACE","\n        ",1083],")",";",["T_WHITESPACE","\n        ",1084],["T_VARIABLE","$prevParent",1085],["T_WHITESPACE"," ",1085],"=",["T_WHITESPACE"," ",1085],["T_STRING","Mage",1085],["T_DOUBLE_COLON","::",1085],["T_STRING","getModel",1085],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1085],")",["T_OBJECT_OPERATOR","->",1085],["T_STRING","load",1085],"(",["T_VARIABLE","$prevParentId",1085],")",";",["T_WHITESPACE","\n        ",1085],["T_VARIABLE","$parent",1086],["T_WHITESPACE"," ",1086],"=",["T_WHITESPACE"," ",1086],["T_STRING","Mage",1086],["T_DOUBLE_COLON","::",1086],["T_STRING","getModel",1086],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1086],")",["T_OBJECT_OPERATOR","->",1086],["T_STRING","load",1086],"(",["T_VARIABLE","$parentId",1086],")",";",["T_WHITESPACE","\n        ",1086],["T_IF","if",1087],["T_WHITESPACE"," ",1087],"(",["T_VARIABLE","$prevParent",1087],["T_OBJECT_OPERATOR","->",1087],["T_STRING","getStore",1087],"(",")",["T_OBJECT_OPERATOR","->",1087],["T_STRING","getWebsiteId",1087],"(",")",["T_WHITESPACE"," ",1087],["T_IS_NOT_EQUAL","!=",1087],["T_WHITESPACE"," ",1087],["T_VARIABLE","$parent",1087],["T_OBJECT_OPERATOR","->",1087],["T_STRING","getStore",1087],"(",")",["T_OBJECT_OPERATOR","->",1087],["T_STRING","getWebsiteId",1087],"(",")",")",["T_WHITESPACE"," ",1087],"{",["T_WHITESPACE","\n            ",1087],["T_FOREACH","foreach",1088],["T_WHITESPACE"," ",1088],"(",["T_VARIABLE","$prevParent",1088],["T_OBJECT_OPERATOR","->",1088],["T_STRING","getStoreIds",1088],"(",")",["T_WHITESPACE"," ",1088],["T_AS","as",1088],["T_WHITESPACE"," ",1088],["T_VARIABLE","$storeId",1088],")",["T_WHITESPACE"," ",1088],"{",["T_WHITESPACE","\n                ",1088],["T_VARIABLE","$this",1089],["T_OBJECT_OPERATOR","->",1089],["T_STRING","_getWriteAdapter",1089],"(",")",["T_OBJECT_OPERATOR","->",1089],["T_STRING","delete",1089],"(",["T_WHITESPACE","\n                    ",1089],["T_VARIABLE","$this",1090],["T_OBJECT_OPERATOR","->",1090],["T_STRING","getMainStoreTable",1090],"(",["T_VARIABLE","$storeId",1090],")",",",["T_WHITESPACE","\n                    ",1090],["T_VARIABLE","$this",1091],["T_OBJECT_OPERATOR","->",1091],["T_STRING","_getWriteAdapter",1091],"(",")",["T_OBJECT_OPERATOR","->",1091],["T_STRING","quoteInto",1091],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",1091],",",["T_WHITESPACE"," ",1091],["T_VARIABLE","$categoryId",1091],")",["T_WHITESPACE","\n                ",1091],")",";",["T_WHITESPACE","\n            ",1092],"}",["T_WHITESPACE","\n            ",1093],["T_VARIABLE","$select",1094],["T_WHITESPACE"," ",1094],"=",["T_WHITESPACE"," ",1094],["T_VARIABLE","$this",1094],["T_OBJECT_OPERATOR","->",1094],["T_STRING","_getReadAdapter",1094],"(",")",["T_OBJECT_OPERATOR","->",1094],["T_STRING","select",1094],"(",")",["T_WHITESPACE","\n                ",1094],["T_OBJECT_OPERATOR","->",1095],["T_STRING","from",1095],"(",["T_VARIABLE","$catalogCategoryTable",1095],",",["T_WHITESPACE"," ",1095],["T_CONSTANT_ENCAPSED_STRING","'path'",1095],")",["T_WHITESPACE","\n                ",1095],["T_OBJECT_OPERATOR","->",1096],["T_STRING","where",1096],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",1096],",",["T_WHITESPACE"," ",1096],["T_VARIABLE","$categoryId",1096],")",";",["T_WHITESPACE","\n\n            ",1096],["T_VARIABLE","$categoryPath",1098],["T_WHITESPACE"," ",1098],"=",["T_WHITESPACE"," ",1098],["T_VARIABLE","$this",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","_getWriteAdapter",1098],"(",")",["T_OBJECT_OPERATOR","->",1098],["T_STRING","fetchOne",1098],"(",["T_VARIABLE","$select",1098],")",";",["T_WHITESPACE","\n\n            ",1098],["T_VARIABLE","$select",1100],["T_WHITESPACE"," ",1100],"=",["T_WHITESPACE"," ",1100],["T_VARIABLE","$this",1100],["T_OBJECT_OPERATOR","->",1100],["T_STRING","_getWriteAdapter",1100],"(",")",["T_OBJECT_OPERATOR","->",1100],["T_STRING","select",1100],"(",")",["T_WHITESPACE","\n                ",1100],["T_OBJECT_OPERATOR","->",1101],["T_STRING","from",1101],"(",["T_VARIABLE","$catalogCategoryTable",1101],",",["T_WHITESPACE"," ",1101],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1101],")",["T_WHITESPACE","\n                ",1101],["T_OBJECT_OPERATOR","->",1102],["T_STRING","where",1102],"(",["T_CONSTANT_ENCAPSED_STRING","'path LIKE ?'",1102],",",["T_WHITESPACE"," ",1102],"\"",["T_VARIABLE","$categoryPath",1102],["T_ENCAPSED_AND_WHITESPACE","\/%",1102],"\"",")",["T_WHITESPACE","\n                ",1102],["T_OBJECT_OPERATOR","->",1103],["T_STRING","orWhere",1103],"(",["T_CONSTANT_ENCAPSED_STRING","'path = ?'",1103],",",["T_WHITESPACE"," ",1103],["T_VARIABLE","$categoryPath",1103],")",";",["T_WHITESPACE","\n            ",1103],["T_VARIABLE","$_categories",1104],["T_WHITESPACE"," ",1104],"=",["T_WHITESPACE"," ",1104],["T_VARIABLE","$this",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","_getWriteAdapter",1104],"(",")",["T_OBJECT_OPERATOR","->",1104],["T_STRING","fetchAll",1104],"(",["T_VARIABLE","$select",1104],")",";",["T_WHITESPACE","\n            ",1104],["T_FOREACH","foreach",1105],["T_WHITESPACE"," ",1105],"(",["T_VARIABLE","$_categories",1105],["T_WHITESPACE"," ",1105],["T_AS","as",1105],["T_WHITESPACE"," ",1105],["T_VARIABLE","$_category",1105],")",["T_WHITESPACE"," ",1105],"{",["T_WHITESPACE","\n                ",1105],["T_FOREACH","foreach",1106],["T_WHITESPACE"," ",1106],"(",["T_VARIABLE","$parent",1106],["T_OBJECT_OPERATOR","->",1106],["T_STRING","getStoreIds",1106],"(",")",["T_WHITESPACE"," ",1106],["T_AS","as",1106],["T_WHITESPACE"," ",1106],["T_VARIABLE","$storeId",1106],")",["T_WHITESPACE"," ",1106],"{",["T_WHITESPACE","\n                    ",1106],["T_VARIABLE","$_tmpCategory",1107],["T_WHITESPACE"," ",1107],"=",["T_WHITESPACE"," ",1107],["T_STRING","Mage",1107],["T_DOUBLE_COLON","::",1107],["T_STRING","getModel",1107],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1107],")",["T_WHITESPACE","\n                        ",1107],["T_OBJECT_OPERATOR","->",1108],["T_STRING","setStoreId",1108],"(",["T_VARIABLE","$storeId",1108],")",["T_WHITESPACE","\n                        ",1108],["T_OBJECT_OPERATOR","->",1109],["T_STRING","load",1109],"(",["T_VARIABLE","$_category",1109],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1109],"]",")",";",["T_WHITESPACE","\n                    ",1109],["T_VARIABLE","$this",1110],["T_OBJECT_OPERATOR","->",1110],["T_STRING","_synchronize",1110],"(",["T_VARIABLE","$_tmpCategory",1110],")",";",["T_WHITESPACE","\n                ",1110],"}",["T_WHITESPACE","\n            ",1111],"}",["T_WHITESPACE","\n        ",1112],"}",["T_WHITESPACE"," ",1113],["T_ELSE","else",1113],["T_WHITESPACE"," ",1113],"{",["T_WHITESPACE","\n            ",1113],["T_FOREACH","foreach",1114],["T_WHITESPACE"," ",1114],"(",["T_VARIABLE","$parent",1114],["T_OBJECT_OPERATOR","->",1114],["T_STRING","getStoreIds",1114],"(",")",["T_WHITESPACE"," ",1114],["T_AS","as",1114],["T_WHITESPACE"," ",1114],["T_VARIABLE","$store",1114],")",["T_WHITESPACE"," ",1114],"{",["T_WHITESPACE","\n                ",1114],["T_VARIABLE","$mainStoreTable",1115],["T_WHITESPACE"," ",1115],"=",["T_WHITESPACE"," ",1115],["T_VARIABLE","$this",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","getMainStoreTable",1115],"(",["T_VARIABLE","$store",1115],")",";",["T_WHITESPACE","\n\n                ",1115],["T_VARIABLE","$update",1117],["T_WHITESPACE"," ",1117],"=",["T_WHITESPACE"," ",1117],"\"",["T_ENCAPSED_AND_WHITESPACE","UPDATE ",1117],["T_CURLY_OPEN","{",1117],["T_VARIABLE","$mainStoreTable",1117],"}",["T_ENCAPSED_AND_WHITESPACE",", ",1117],["T_CURLY_OPEN","{",1117],["T_VARIABLE","$catalogCategoryTable",1117],"}",["T_ENCAPSED_AND_WHITESPACE"," SET",1117],"\"",";",["T_WHITESPACE","\n                ",1117],["T_FOREACH","foreach",1118],["T_WHITESPACE"," ",1118],"(",["T_VARIABLE","$_staticFields",1118],["T_WHITESPACE"," ",1118],["T_AS","as",1118],["T_WHITESPACE"," ",1118],["T_VARIABLE","$field",1118],")",["T_WHITESPACE"," ",1118],"{",["T_WHITESPACE","\n                    ",1118],["T_VARIABLE","$update",1119],["T_WHITESPACE"," ",1119],["T_CONCAT_EQUAL",".=",1119],["T_WHITESPACE"," ",1119],"\"",["T_ENCAPSED_AND_WHITESPACE"," ",1119],["T_CURLY_OPEN","{",1119],["T_VARIABLE","$mainStoreTable",1119],"}",["T_ENCAPSED_AND_WHITESPACE",".",1119],"\"",".",["T_VARIABLE","$field",1119],".","\"",["T_ENCAPSED_AND_WHITESPACE","=",1119],["T_CURLY_OPEN","{",1119],["T_VARIABLE","$catalogCategoryTable",1119],"}",["T_ENCAPSED_AND_WHITESPACE",".",1119],"\"",".",["T_VARIABLE","$field",1119],".",["T_CONSTANT_ENCAPSED_STRING","\",\"",1119],";",["T_WHITESPACE","\n                ",1119],"}",["T_WHITESPACE","\n                ",1120],["T_VARIABLE","$update",1121],["T_WHITESPACE"," ",1121],"=",["T_WHITESPACE"," ",1121],["T_STRING","substr",1121],"(",["T_VARIABLE","$update",1121],",",["T_WHITESPACE"," ",1121],["T_LNUMBER","0",1121],",",["T_WHITESPACE"," ",1121],"-",["T_LNUMBER","1",1121],")",";",["T_WHITESPACE","\n                ",1121],["T_VARIABLE","$update",1122],["T_WHITESPACE"," ",1122],["T_CONCAT_EQUAL",".=",1122],["T_WHITESPACE"," ",1122],"\"",["T_ENCAPSED_AND_WHITESPACE"," WHERE ",1122],["T_CURLY_OPEN","{",1122],["T_VARIABLE","$mainStoreTable",1122],"}",["T_ENCAPSED_AND_WHITESPACE",".entity_id = ",1122],["T_CURLY_OPEN","{",1122],["T_VARIABLE","$catalogCategoryTable",1122],"}",["T_ENCAPSED_AND_WHITESPACE",".entity_id AND ",1122],"\"",["T_WHITESPACE"," ",1122],".",["T_WHITESPACE","\n                    ",1122],"\"",["T_ENCAPSED_AND_WHITESPACE","(",1123],["T_VARIABLE","$catalogCategoryTable",1123],["T_ENCAPSED_AND_WHITESPACE","}.path like '",1123],["T_CURLY_OPEN","{",1123],["T_VARIABLE","$parent",1123],["T_OBJECT_OPERATOR","->",1123],["T_STRING","getPath",1123],"(",")","}",["T_ENCAPSED_AND_WHITESPACE","\/%' OR ",1123],"\"",["T_WHITESPACE"," ",1123],".",["T_WHITESPACE","\n                    ",1123],"\"",["T_CURLY_OPEN","{",1124],["T_VARIABLE","$catalogCategoryTable",1124],"}",["T_ENCAPSED_AND_WHITESPACE",".path like '",1124],["T_CURLY_OPEN","{",1124],["T_VARIABLE","$prevParent",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","getPath",1124],"(",")","}",["T_ENCAPSED_AND_WHITESPACE","\/%')",1124],"\"",";",["T_WHITESPACE","\n                ",1124],["T_VARIABLE","$this",1125],["T_OBJECT_OPERATOR","->",1125],["T_STRING","_getWriteAdapter",1125],"(",")",["T_OBJECT_OPERATOR","->",1125],["T_STRING","query",1125],"(",["T_VARIABLE","$update",1125],")",";",["T_WHITESPACE","\n            ",1125],"}",["T_WHITESPACE","\n        ",1126],"}",["T_WHITESPACE","\n        ",1127],["T_VARIABLE","$prevParent",1128],["T_WHITESPACE","   ",1128],"=",["T_WHITESPACE"," ",1128],["T_STRING","null",1128],";",["T_WHITESPACE","\n        ",1128],["T_VARIABLE","$parent",1129],["T_WHITESPACE","       ",1129],"=",["T_WHITESPACE"," ",1129],["T_STRING","null",1129],";",["T_WHITESPACE","\n        ",1129],["T_VARIABLE","$_tmpCategory",1130],["T_WHITESPACE"," ",1130],"=",["T_WHITESPACE"," ",1130],["T_STRING","null",1130],";",["T_WHITESPACE","\n",1130],["T_COMMENT","\/\/        $this->_move($categoryId, $prevParentPath, $parentPath);\n",1131],["T_WHITESPACE","        ",1132],["T_RETURN","return",1132],["T_WHITESPACE"," ",1132],["T_VARIABLE","$this",1132],";",["T_WHITESPACE","\n    ",1132],"}",["T_WHITESPACE","\n\n    ",1133],["T_DOC_COMMENT","\/**\n     * Prepare array of category data to insert or update.\n     * array(\n     *  'field_name' => 'value'\n     * )\n     *\n     * @param Varien_Object $category\n     * @param array $replaceFields\n     * @return array\n     *\/",1135],["T_WHITESPACE","\n    ",1144],["T_PROTECTED","protected",1145],["T_WHITESPACE"," ",1145],["T_FUNCTION","function",1145],["T_WHITESPACE"," ",1145],["T_STRING","_prepareDataForAllFields",1145],"(",["T_VARIABLE","$category",1145],",",["T_WHITESPACE"," ",1145],["T_VARIABLE","$replaceFields",1145],["T_WHITESPACE"," ",1145],"=",["T_WHITESPACE"," ",1145],["T_ARRAY","array",1145],"(",")",")",["T_WHITESPACE","\n    ",1145],"{",["T_WHITESPACE","\n        ",1146],["T_VARIABLE","$table",1147],["T_WHITESPACE"," ",1147],"=",["T_WHITESPACE"," ",1147],["T_VARIABLE","$this",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","getMainStoreTable",1147],"(",["T_VARIABLE","$category",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","getStoreId",1147],"(",")",")",";",["T_WHITESPACE","\n        ",1147],["T_VARIABLE","$this",1148],["T_OBJECT_OPERATOR","->",1148],["T_STRING","_getWriteAdapter",1148],"(",")",["T_OBJECT_OPERATOR","->",1148],["T_STRING","resetDdlCache",1148],"(",["T_VARIABLE","$table",1148],")",";",["T_WHITESPACE","\n        ",1148],["T_VARIABLE","$table",1149],["T_WHITESPACE"," ",1149],"=",["T_WHITESPACE"," ",1149],["T_VARIABLE","$this",1149],["T_OBJECT_OPERATOR","->",1149],["T_STRING","_getWriteAdapter",1149],"(",")",["T_OBJECT_OPERATOR","->",1149],["T_STRING","describeTable",1149],"(",["T_VARIABLE","$table",1149],")",";",["T_WHITESPACE","\n        ",1149],["T_VARIABLE","$data",1150],["T_WHITESPACE"," ",1150],"=",["T_WHITESPACE"," ",1150],["T_ARRAY","array",1150],"(",")",";",["T_WHITESPACE","\n        ",1150],["T_VARIABLE","$idFieldName",1151],["T_WHITESPACE"," ",1151],"=",["T_WHITESPACE"," ",1151],["T_STRING","Mage",1151],["T_DOUBLE_COLON","::",1151],["T_STRING","getSingleton",1151],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1151],")",["T_OBJECT_OPERATOR","->",1151],["T_STRING","getIdFieldName",1151],"(",")",";",["T_WHITESPACE","\n        ",1151],["T_FOREACH","foreach",1152],["T_WHITESPACE"," ",1152],"(",["T_VARIABLE","$table",1152],["T_WHITESPACE"," ",1152],["T_AS","as",1152],["T_WHITESPACE"," ",1152],["T_VARIABLE","$column",1152],["T_WHITESPACE"," ",1152],["T_DOUBLE_ARROW","=>",1152],["T_WHITESPACE"," ",1152],["T_VARIABLE","$columnData",1152],")",["T_WHITESPACE"," ",1152],"{",["T_WHITESPACE","\n            ",1152],["T_IF","if",1153],["T_WHITESPACE"," ",1153],"(",["T_VARIABLE","$column",1153],["T_WHITESPACE"," ",1153],["T_IS_NOT_EQUAL","!=",1153],["T_WHITESPACE"," ",1153],["T_VARIABLE","$idFieldName",1153],["T_WHITESPACE"," ",1153],["T_BOOLEAN_OR","||",1153],["T_WHITESPACE"," ",1153],["T_STRING","null",1153],["T_WHITESPACE"," ",1153],["T_IS_NOT_IDENTICAL","!==",1153],["T_WHITESPACE"," ",1153],["T_VARIABLE","$category",1153],["T_OBJECT_OPERATOR","->",1153],["T_STRING","getData",1153],"(",["T_VARIABLE","$column",1153],")",")",["T_WHITESPACE"," ",1153],"{",["T_WHITESPACE","\n                ",1153],["T_IF","if",1154],["T_WHITESPACE"," ",1154],"(",["T_STRING","key_exists",1154],"(",["T_VARIABLE","$column",1154],",",["T_WHITESPACE"," ",1154],["T_VARIABLE","$replaceFields",1154],")",")",["T_WHITESPACE"," ",1154],"{",["T_WHITESPACE","\n                    ",1154],["T_VARIABLE","$value",1155],["T_WHITESPACE"," ",1155],"=",["T_WHITESPACE"," ",1155],["T_VARIABLE","$category",1155],["T_OBJECT_OPERATOR","->",1155],["T_STRING","getData",1155],"(",["T_VARIABLE","$replaceFields",1155],"[",["T_VARIABLE","$column",1155],"]",")",";",["T_WHITESPACE","\n                ",1155],"}",["T_WHITESPACE"," ",1156],["T_ELSE","else",1156],["T_WHITESPACE"," ",1156],"{",["T_WHITESPACE","\n                    ",1156],["T_VARIABLE","$value",1157],["T_WHITESPACE"," ",1157],"=",["T_WHITESPACE"," ",1157],["T_VARIABLE","$category",1157],["T_OBJECT_OPERATOR","->",1157],["T_STRING","getData",1157],"(",["T_VARIABLE","$column",1157],")",";",["T_WHITESPACE","\n                ",1157],"}",["T_WHITESPACE","\n                ",1158],["T_IF","if",1159],["T_WHITESPACE"," ",1159],"(",["T_STRING","is_array",1159],"(",["T_VARIABLE","$value",1159],")",")",["T_WHITESPACE"," ",1159],"{",["T_WHITESPACE","\n                    ",1159],["T_VARIABLE","$value",1160],["T_WHITESPACE"," ",1160],"=",["T_WHITESPACE"," ",1160],["T_STRING","implode",1160],"(",["T_CONSTANT_ENCAPSED_STRING","','",1160],",",["T_WHITESPACE"," ",1160],["T_VARIABLE","$value",1160],")",";",["T_WHITESPACE","\n                ",1160],"}",["T_WHITESPACE","\n                ",1161],["T_VARIABLE","$data",1162],"[",["T_VARIABLE","$column",1162],"]",["T_WHITESPACE"," ",1162],"=",["T_WHITESPACE"," ",1162],["T_VARIABLE","$value",1162],";",["T_WHITESPACE","\n            ",1162],"}",["T_WHITESPACE","\n        ",1163],"}",["T_WHITESPACE","\n        ",1164],["T_RETURN","return",1165],["T_WHITESPACE"," ",1165],["T_VARIABLE","$data",1165],";",["T_WHITESPACE","\n    ",1165],"}",["T_WHITESPACE","\n\n    ",1166],["T_DOC_COMMENT","\/**\n     * Retrieve attribute instance\n     * Special for non static flat table\n     *\n     * @param mixed $attribute\n     * @return Mage_Eav_Model_Entity_Attribute_Abstract\n     *\/",1168],["T_WHITESPACE","\n    ",1174],["T_PUBLIC","public",1175],["T_WHITESPACE"," ",1175],["T_FUNCTION","function",1175],["T_WHITESPACE"," ",1175],["T_STRING","getAttribute",1175],"(",["T_VARIABLE","$attribute",1175],")",["T_WHITESPACE","\n    ",1175],"{",["T_WHITESPACE","\n        ",1176],["T_RETURN","return",1177],["T_WHITESPACE"," ",1177],["T_STRING","Mage",1177],["T_DOUBLE_COLON","::",1177],["T_STRING","getSingleton",1177],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/config'",1177],")",["T_WHITESPACE","\n            ",1177],["T_OBJECT_OPERATOR","->",1178],["T_STRING","getAttribute",1178],"(",["T_STRING","Mage_Catalog_Model_Category",1178],["T_DOUBLE_COLON","::",1178],["T_STRING","ENTITY",1178],",",["T_WHITESPACE"," ",1178],["T_VARIABLE","$attribute",1178],")",";",["T_WHITESPACE","\n    ",1178],"}",["T_WHITESPACE","\n\n    ",1179],["T_DOC_COMMENT","\/**\n     * Get count of active\/not active children categories\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @param bool $isActiveFlag\n     * @return integer\n     *\/",1181],["T_WHITESPACE","\n    ",1187],["T_PUBLIC","public",1188],["T_WHITESPACE"," ",1188],["T_FUNCTION","function",1188],["T_WHITESPACE"," ",1188],["T_STRING","getChildrenAmount",1188],"(",["T_VARIABLE","$category",1188],",",["T_WHITESPACE"," ",1188],["T_VARIABLE","$isActiveFlag",1188],["T_WHITESPACE"," ",1188],"=",["T_WHITESPACE"," ",1188],["T_STRING","true",1188],")",["T_WHITESPACE","\n    ",1188],"{",["T_WHITESPACE","\n        ",1189],["T_VARIABLE","$_table",1190],["T_WHITESPACE"," ",1190],"=",["T_WHITESPACE"," ",1190],["T_VARIABLE","$this",1190],["T_OBJECT_OPERATOR","->",1190],["T_STRING","getMainStoreTable",1190],"(",["T_VARIABLE","$category",1190],["T_OBJECT_OPERATOR","->",1190],["T_STRING","getStoreId",1190],"(",")",")",";",["T_WHITESPACE","\n        ",1190],["T_VARIABLE","$select",1191],["T_WHITESPACE"," ",1191],"=",["T_WHITESPACE"," ",1191],["T_VARIABLE","$this",1191],["T_OBJECT_OPERATOR","->",1191],["T_STRING","_getReadAdapter",1191],"(",")",["T_OBJECT_OPERATOR","->",1191],["T_STRING","select",1191],"(",")",["T_WHITESPACE","\n            ",1191],["T_OBJECT_OPERATOR","->",1192],["T_STRING","from",1192],"(",["T_VARIABLE","$_table",1192],",",["T_WHITESPACE"," ",1192],"\"",["T_ENCAPSED_AND_WHITESPACE","COUNT(",1192],["T_CURLY_OPEN","{",1192],["T_VARIABLE","$_table",1192],"}",["T_ENCAPSED_AND_WHITESPACE",".entity_id)",1192],"\"",")",["T_WHITESPACE","\n            ",1192],["T_OBJECT_OPERATOR","->",1193],["T_STRING","where",1193],"(","\"",["T_CURLY_OPEN","{",1193],["T_VARIABLE","$_table",1193],"}",["T_ENCAPSED_AND_WHITESPACE",".path LIKE ?",1193],"\"",",",["T_WHITESPACE"," ",1193],["T_VARIABLE","$category",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","getPath",1193],"(",")",["T_WHITESPACE"," ",1193],".",["T_WHITESPACE"," ",1193],["T_CONSTANT_ENCAPSED_STRING","'\/%'",1193],")",["T_WHITESPACE","\n            ",1193],["T_OBJECT_OPERATOR","->",1194],["T_STRING","where",1194],"(","\"",["T_CURLY_OPEN","{",1194],["T_VARIABLE","$_table",1194],"}",["T_ENCAPSED_AND_WHITESPACE",".is_active = ?",1194],"\"",",",["T_WHITESPACE"," ",1194],["T_INT_CAST","(int)",1194],["T_WHITESPACE"," ",1194],["T_VARIABLE","$isActiveFlag",1194],")",";",["T_WHITESPACE","\n        ",1194],["T_RETURN","return",1195],["T_WHITESPACE"," ",1195],["T_INT_CAST","(int)",1195],["T_WHITESPACE"," ",1195],["T_VARIABLE","$this",1195],["T_OBJECT_OPERATOR","->",1195],["T_STRING","_getReadAdapter",1195],"(",")",["T_OBJECT_OPERATOR","->",1195],["T_STRING","fetchOne",1195],"(",["T_VARIABLE","$select",1195],")",";",["T_WHITESPACE","\n    ",1195],"}",["T_WHITESPACE","\n\n    ",1196],["T_DOC_COMMENT","\/**\n     * Get products count in category\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return integer\n     *\/",1198],["T_WHITESPACE","\n    ",1203],["T_PUBLIC","public",1204],["T_WHITESPACE"," ",1204],["T_FUNCTION","function",1204],["T_WHITESPACE"," ",1204],["T_STRING","getProductCount",1204],"(",["T_VARIABLE","$category",1204],")",["T_WHITESPACE","\n    ",1204],"{",["T_WHITESPACE","\n        ",1205],["T_VARIABLE","$select",1206],["T_WHITESPACE"," ",1206],"=",["T_WHITESPACE","  ",1206],["T_VARIABLE","$this",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","_getReadAdapter",1206],"(",")",["T_OBJECT_OPERATOR","->",1206],["T_STRING","select",1206],"(",")",["T_WHITESPACE","\n            ",1206],["T_OBJECT_OPERATOR","->",1207],["T_STRING","from",1207],"(",["T_WHITESPACE","\n                ",1207],["T_VARIABLE","$this",1208],["T_OBJECT_OPERATOR","->",1208],["T_STRING","getTable",1208],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_product'",1208],")",",",["T_WHITESPACE","\n                ",1208],"\"",["T_ENCAPSED_AND_WHITESPACE","COUNT(",1209],["T_CURLY_OPEN","{",1209],["T_VARIABLE","$this",1209],["T_OBJECT_OPERATOR","->",1209],["T_STRING","getTable",1209],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_product'",1209],")","}",["T_ENCAPSED_AND_WHITESPACE",".product_id)",1209],"\"",["T_WHITESPACE","\n            ",1209],")",["T_WHITESPACE","\n            ",1210],["T_OBJECT_OPERATOR","->",1211],["T_STRING","where",1211],"(","\"",["T_CURLY_OPEN","{",1211],["T_VARIABLE","$this",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","getTable",1211],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_product'",1211],")","}",["T_ENCAPSED_AND_WHITESPACE",".category_id = ?",1211],"\"",",",["T_WHITESPACE"," ",1211],["T_VARIABLE","$category",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","getId",1211],"(",")",")",["T_WHITESPACE","\n            ",1211],["T_OBJECT_OPERATOR","->",1212],["T_STRING","group",1212],"(","\"",["T_CURLY_OPEN","{",1212],["T_VARIABLE","$this",1212],["T_OBJECT_OPERATOR","->",1212],["T_STRING","getTable",1212],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_product'",1212],")","}",["T_ENCAPSED_AND_WHITESPACE",".category_id",1212],"\"",")",";",["T_WHITESPACE","\n        ",1212],["T_RETURN","return",1213],["T_WHITESPACE"," ",1213],["T_INT_CAST","(int)",1213],["T_WHITESPACE"," ",1213],["T_VARIABLE","$this",1213],["T_OBJECT_OPERATOR","->",1213],["T_STRING","_getReadAdapter",1213],"(",")",["T_OBJECT_OPERATOR","->",1213],["T_STRING","fetchOne",1213],"(",["T_VARIABLE","$select",1213],")",";",["T_WHITESPACE","\n    ",1213],"}",["T_WHITESPACE","\n\n    ",1214],["T_DOC_COMMENT","\/**\n     * Return parent categories of category\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @param bool $isActive\n     * @return array\n     *\/",1216],["T_WHITESPACE","\n    ",1222],["T_PUBLIC","public",1223],["T_WHITESPACE"," ",1223],["T_FUNCTION","function",1223],["T_WHITESPACE"," ",1223],["T_STRING","getParentCategories",1223],"(",["T_VARIABLE","$category",1223],",",["T_WHITESPACE"," ",1223],["T_VARIABLE","$isActive",1223],["T_WHITESPACE"," ",1223],"=",["T_WHITESPACE"," ",1223],["T_STRING","true",1223],")",["T_WHITESPACE","\n    ",1223],"{",["T_WHITESPACE","\n        ",1224],["T_VARIABLE","$categories",1225],["T_WHITESPACE"," ",1225],"=",["T_WHITESPACE"," ",1225],["T_ARRAY","array",1225],"(",")",";",["T_WHITESPACE","\n        ",1225],["T_VARIABLE","$select",1226],["T_WHITESPACE"," ",1226],"=",["T_WHITESPACE"," ",1226],["T_VARIABLE","$this",1226],["T_OBJECT_OPERATOR","->",1226],["T_STRING","_getReadAdapter",1226],"(",")",["T_OBJECT_OPERATOR","->",1226],["T_STRING","select",1226],"(",")",["T_WHITESPACE","\n            ",1226],["T_OBJECT_OPERATOR","->",1227],["T_STRING","from",1227],"(",["T_WHITESPACE","\n                ",1227],["T_ARRAY","array",1228],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",1228],["T_WHITESPACE"," ",1228],["T_DOUBLE_ARROW","=>",1228],["T_WHITESPACE"," ",1228],["T_VARIABLE","$this",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","getMainStoreTable",1228],"(",["T_VARIABLE","$category",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","getStoreId",1228],"(",")",")",")",",",["T_WHITESPACE","\n                ",1228],["T_ARRAY","array",1229],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id'",1229],",",["T_WHITESPACE"," ",1229],["T_CONSTANT_ENCAPSED_STRING","'main_table.name'",1229],")",["T_WHITESPACE","\n            ",1229],")",["T_WHITESPACE","\n            ",1230],["T_OBJECT_OPERATOR","->",1231],["T_STRING","where",1231],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id IN (?)'",1231],",",["T_WHITESPACE"," ",1231],["T_STRING","array_reverse",1231],"(",["T_STRING","explode",1231],"(",["T_CONSTANT_ENCAPSED_STRING","','",1231],",",["T_WHITESPACE"," ",1231],["T_VARIABLE","$category",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","getPathInStore",1231],"(",")",")",")",")",";",["T_WHITESPACE","\n        ",1231],["T_IF","if",1232],["T_WHITESPACE"," ",1232],"(",["T_VARIABLE","$isActive",1232],")",["T_WHITESPACE"," ",1232],"{",["T_WHITESPACE","\n            ",1232],["T_VARIABLE","$select",1233],["T_OBJECT_OPERATOR","->",1233],["T_STRING","where",1233],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.is_active = ?'",1233],",",["T_WHITESPACE"," ",1233],["T_CONSTANT_ENCAPSED_STRING","'1'",1233],")",";",["T_WHITESPACE","\n        ",1233],"}",["T_WHITESPACE","\n        ",1234],["T_VARIABLE","$select",1235],["T_OBJECT_OPERATOR","->",1235],["T_STRING","order",1235],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.path ASC'",1235],")",";",["T_WHITESPACE","\n\n        ",1235],["T_VARIABLE","$urlRewrite",1237],["T_WHITESPACE"," ",1237],"=",["T_WHITESPACE"," ",1237],["T_VARIABLE","$this",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","_factory",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","getCategoryUrlRewriteHelper",1237],"(",")",";",["T_WHITESPACE","\n        ",1237],["T_VARIABLE","$urlRewrite",1238],["T_OBJECT_OPERATOR","->",1238],["T_STRING","joinTableToSelect",1238],"(",["T_VARIABLE","$select",1238],",",["T_WHITESPACE"," ",1238],["T_VARIABLE","$category",1238],["T_OBJECT_OPERATOR","->",1238],["T_STRING","getStoreId",1238],"(",")",")",";",["T_WHITESPACE","\n\n        ",1238],["T_VARIABLE","$result",1240],["T_WHITESPACE"," ",1240],"=",["T_WHITESPACE"," ",1240],["T_VARIABLE","$this",1240],["T_OBJECT_OPERATOR","->",1240],["T_STRING","_getReadAdapter",1240],"(",")",["T_OBJECT_OPERATOR","->",1240],["T_STRING","fetchAll",1240],"(",["T_VARIABLE","$select",1240],")",";",["T_WHITESPACE","\n        ",1240],["T_FOREACH","foreach",1241],["T_WHITESPACE"," ",1241],"(",["T_VARIABLE","$result",1241],["T_WHITESPACE"," ",1241],["T_AS","as",1241],["T_WHITESPACE"," ",1241],["T_VARIABLE","$row",1241],")",["T_WHITESPACE"," ",1241],"{",["T_WHITESPACE","\n            ",1241],["T_VARIABLE","$row",1242],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",1242],"]",["T_WHITESPACE"," ",1242],"=",["T_WHITESPACE"," ",1242],["T_VARIABLE","$row",1242],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1242],"]",";",["T_WHITESPACE","\n            ",1242],["T_VARIABLE","$categories",1243],"[",["T_VARIABLE","$row",1243],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1243],"]","]",["T_WHITESPACE"," ",1243],"=",["T_WHITESPACE"," ",1243],["T_STRING","Mage",1243],["T_DOUBLE_COLON","::",1243],["T_STRING","getModel",1243],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1243],")",["T_OBJECT_OPERATOR","->",1243],["T_STRING","setData",1243],"(",["T_VARIABLE","$row",1243],")",";",["T_WHITESPACE","\n        ",1243],"}",["T_WHITESPACE","\n        ",1244],["T_RETURN","return",1245],["T_WHITESPACE"," ",1245],["T_VARIABLE","$categories",1245],";",["T_WHITESPACE","\n    ",1245],"}",["T_WHITESPACE","\n\n    ",1246],["T_DOC_COMMENT","\/**\n     * Return parent category of current category with own custom design settings\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return Mage_Catalog_Model_Category\n     *\/",1248],["T_WHITESPACE","\n    ",1253],["T_PUBLIC","public",1254],["T_WHITESPACE"," ",1254],["T_FUNCTION","function",1254],["T_WHITESPACE"," ",1254],["T_STRING","getParentDesignCategory",1254],"(",["T_VARIABLE","$category",1254],")",["T_WHITESPACE","\n    ",1254],"{",["T_WHITESPACE","\n        ",1255],["T_VARIABLE","$adapter",1256],["T_WHITESPACE","    ",1256],"=",["T_WHITESPACE"," ",1256],["T_VARIABLE","$this",1256],["T_OBJECT_OPERATOR","->",1256],["T_STRING","_getReadAdapter",1256],"(",")",";",["T_WHITESPACE","\n        ",1256],["T_VARIABLE","$levelField",1257],["T_WHITESPACE"," ",1257],"=",["T_WHITESPACE"," ",1257],["T_VARIABLE","$adapter",1257],["T_OBJECT_OPERATOR","->",1257],["T_STRING","quoteIdentifier",1257],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",1257],")",";",["T_WHITESPACE","\n        ",1257],["T_VARIABLE","$pathIds",1258],["T_WHITESPACE","    ",1258],"=",["T_WHITESPACE"," ",1258],["T_STRING","array_reverse",1258],"(",["T_VARIABLE","$category",1258],["T_OBJECT_OPERATOR","->",1258],["T_STRING","getPathIds",1258],"(",")",")",";",["T_WHITESPACE","\n        ",1258],["T_VARIABLE","$select",1259],["T_WHITESPACE"," ",1259],"=",["T_WHITESPACE"," ",1259],["T_VARIABLE","$adapter",1259],["T_OBJECT_OPERATOR","->",1259],["T_STRING","select",1259],"(",")",["T_WHITESPACE","\n            ",1259],["T_OBJECT_OPERATOR","->",1260],["T_STRING","from",1260],"(",["T_ARRAY","array",1260],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",1260],["T_WHITESPACE"," ",1260],["T_DOUBLE_ARROW","=>",1260],["T_WHITESPACE"," ",1260],["T_VARIABLE","$this",1260],["T_OBJECT_OPERATOR","->",1260],["T_STRING","getMainStoreTable",1260],"(",["T_VARIABLE","$category",1260],["T_OBJECT_OPERATOR","->",1260],["T_STRING","getStoreId",1260],"(",")",")",")",",",["T_WHITESPACE"," ",1260],["T_CONSTANT_ENCAPSED_STRING","'*'",1260],")",["T_WHITESPACE","\n            ",1260],["T_OBJECT_OPERATOR","->",1261],["T_STRING","where",1261],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",1261],",",["T_WHITESPACE"," ",1261],["T_VARIABLE","$pathIds",1261],")",["T_WHITESPACE","\n            ",1261],["T_OBJECT_OPERATOR","->",1262],["T_STRING","where",1262],"(",["T_CONSTANT_ENCAPSED_STRING","'custom_use_parent_settings = ?'",1262],",",["T_WHITESPACE"," ",1262],["T_LNUMBER","0",1262],")",["T_WHITESPACE","\n            ",1262],["T_OBJECT_OPERATOR","->",1263],["T_STRING","where",1263],"(",["T_VARIABLE","$levelField",1263],["T_WHITESPACE"," ",1263],".",["T_WHITESPACE"," ",1263],["T_CONSTANT_ENCAPSED_STRING","' != ?'",1263],",",["T_WHITESPACE"," ",1263],["T_LNUMBER","0",1263],")",["T_WHITESPACE","\n            ",1263],["T_OBJECT_OPERATOR","->",1264],["T_STRING","order",1264],"(",["T_CONSTANT_ENCAPSED_STRING","'level '",1264],["T_WHITESPACE"," ",1264],".",["T_WHITESPACE"," ",1264],["T_STRING","Varien_Db_Select",1264],["T_DOUBLE_COLON","::",1264],["T_STRING","SQL_DESC",1264],")",";",["T_WHITESPACE","\n        ",1264],["T_VARIABLE","$result",1265],["T_WHITESPACE"," ",1265],"=",["T_WHITESPACE"," ",1265],["T_VARIABLE","$adapter",1265],["T_OBJECT_OPERATOR","->",1265],["T_STRING","fetchRow",1265],"(",["T_VARIABLE","$select",1265],")",";",["T_WHITESPACE","\n        ",1265],["T_RETURN","return",1266],["T_WHITESPACE"," ",1266],["T_STRING","Mage",1266],["T_DOUBLE_COLON","::",1266],["T_STRING","getModel",1266],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1266],")",["T_OBJECT_OPERATOR","->",1266],["T_STRING","setData",1266],"(",["T_VARIABLE","$result",1266],")",";",["T_WHITESPACE","\n    ",1266],"}",["T_WHITESPACE","\n\n    ",1267],["T_DOC_COMMENT","\/**\n     * Return children categories of category\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return array\n     *\/",1269],["T_WHITESPACE","\n    ",1274],["T_PUBLIC","public",1275],["T_WHITESPACE"," ",1275],["T_FUNCTION","function",1275],["T_WHITESPACE"," ",1275],["T_STRING","getChildrenCategories",1275],"(",["T_VARIABLE","$category",1275],")",["T_WHITESPACE","\n    ",1275],"{",["T_WHITESPACE","\n        ",1276],["T_VARIABLE","$categories",1277],["T_WHITESPACE"," ",1277],"=",["T_WHITESPACE"," ",1277],["T_VARIABLE","$this",1277],["T_OBJECT_OPERATOR","->",1277],["T_STRING","_loadNodes",1277],"(",["T_VARIABLE","$category",1277],",",["T_WHITESPACE"," ",1277],["T_LNUMBER","1",1277],",",["T_WHITESPACE"," ",1277],["T_VARIABLE","$category",1277],["T_OBJECT_OPERATOR","->",1277],["T_STRING","getStoreId",1277],"(",")",")",";",["T_WHITESPACE","\n        ",1277],["T_RETURN","return",1278],["T_WHITESPACE"," ",1278],["T_VARIABLE","$categories",1278],";",["T_WHITESPACE","\n    ",1278],"}",["T_WHITESPACE","\n\n    ",1279],["T_DOC_COMMENT","\/**\n     * Return children categories of category with inactive\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return array\n     *\/",1281],["T_WHITESPACE","\n    ",1286],["T_PUBLIC","public",1287],["T_WHITESPACE"," ",1287],["T_FUNCTION","function",1287],["T_WHITESPACE"," ",1287],["T_STRING","getChildrenCategoriesWithInactive",1287],"(",["T_VARIABLE","$category",1287],")",["T_WHITESPACE","\n    ",1287],"{",["T_WHITESPACE","\n        ",1288],["T_RETURN","return",1289],["T_WHITESPACE"," ",1289],["T_VARIABLE","$this",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","_loadNodes",1289],"(",["T_VARIABLE","$category",1289],",",["T_WHITESPACE"," ",1289],["T_LNUMBER","1",1289],",",["T_WHITESPACE"," ",1289],["T_VARIABLE","$category",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","getStoreId",1289],"(",")",",",["T_WHITESPACE"," ",1289],["T_STRING","false",1289],")",";",["T_WHITESPACE","\n    ",1289],"}",["T_WHITESPACE","\n\n    ",1290],["T_DOC_COMMENT","\/**\n     * Check is category in list of store categories\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return boolean\n     *\/",1292],["T_WHITESPACE","\n    ",1297],["T_PUBLIC","public",1298],["T_WHITESPACE"," ",1298],["T_FUNCTION","function",1298],["T_WHITESPACE"," ",1298],["T_STRING","isInRootCategoryList",1298],"(",["T_VARIABLE","$category",1298],")",["T_WHITESPACE","\n    ",1298],"{",["T_WHITESPACE","\n        ",1299],["T_VARIABLE","$pathIds",1300],["T_WHITESPACE"," ",1300],"=",["T_WHITESPACE"," ",1300],["T_VARIABLE","$category",1300],["T_OBJECT_OPERATOR","->",1300],["T_STRING","getParentIds",1300],"(",")",";",["T_WHITESPACE","\n        ",1300],["T_RETURN","return",1301],["T_WHITESPACE"," ",1301],["T_STRING","in_array",1301],"(",["T_STRING","Mage",1301],["T_DOUBLE_COLON","::",1301],["T_STRING","app",1301],"(",")",["T_OBJECT_OPERATOR","->",1301],["T_STRING","getStore",1301],"(",")",["T_OBJECT_OPERATOR","->",1301],["T_STRING","getRootCategoryId",1301],"(",")",",",["T_WHITESPACE"," ",1301],["T_VARIABLE","$pathIds",1301],")",";",["T_WHITESPACE","\n    ",1301],"}",["T_WHITESPACE","\n\n    ",1302],["T_DOC_COMMENT","\/**\n     * Return children ids of category\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @param bool $recursive\n     * @param bool $isActive\n     * @return array\n     *\/",1304],["T_WHITESPACE","\n    ",1311],["T_PUBLIC","public",1312],["T_WHITESPACE"," ",1312],["T_FUNCTION","function",1312],["T_WHITESPACE"," ",1312],["T_STRING","getChildren",1312],"(",["T_VARIABLE","$category",1312],",",["T_WHITESPACE"," ",1312],["T_VARIABLE","$recursive",1312],["T_WHITESPACE"," ",1312],"=",["T_WHITESPACE"," ",1312],["T_STRING","true",1312],",",["T_WHITESPACE"," ",1312],["T_VARIABLE","$isActive",1312],["T_WHITESPACE"," ",1312],"=",["T_WHITESPACE"," ",1312],["T_STRING","true",1312],")",["T_WHITESPACE","\n    ",1312],"{",["T_WHITESPACE","\n        ",1313],["T_VARIABLE","$select",1314],["T_WHITESPACE"," ",1314],"=",["T_WHITESPACE"," ",1314],["T_VARIABLE","$this",1314],["T_OBJECT_OPERATOR","->",1314],["T_STRING","_getReadAdapter",1314],"(",")",["T_OBJECT_OPERATOR","->",1314],["T_STRING","select",1314],"(",")",["T_WHITESPACE","\n            ",1314],["T_OBJECT_OPERATOR","->",1315],["T_STRING","from",1315],"(",["T_VARIABLE","$this",1315],["T_OBJECT_OPERATOR","->",1315],["T_STRING","getMainStoreTable",1315],"(",["T_VARIABLE","$category",1315],["T_OBJECT_OPERATOR","->",1315],["T_STRING","getStoreId",1315],"(",")",")",",",["T_WHITESPACE"," ",1315],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1315],")",["T_WHITESPACE","\n            ",1315],["T_OBJECT_OPERATOR","->",1316],["T_STRING","where",1316],"(",["T_CONSTANT_ENCAPSED_STRING","'path LIKE ?'",1316],",",["T_WHITESPACE"," ",1316],"\"",["T_CURLY_OPEN","{",1316],["T_VARIABLE","$category",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","getPath",1316],"(",")","}",["T_ENCAPSED_AND_WHITESPACE","\/%",1316],"\"",")",";",["T_WHITESPACE","\n        ",1316],["T_IF","if",1317],["T_WHITESPACE"," ",1317],"(","!",["T_VARIABLE","$recursive",1317],")",["T_WHITESPACE"," ",1317],"{",["T_WHITESPACE","\n            ",1317],["T_VARIABLE","$select",1318],["T_OBJECT_OPERATOR","->",1318],["T_STRING","where",1318],"(",["T_CONSTANT_ENCAPSED_STRING","'level <= ?'",1318],",",["T_WHITESPACE"," ",1318],["T_VARIABLE","$category",1318],["T_OBJECT_OPERATOR","->",1318],["T_STRING","getLevel",1318],"(",")",["T_WHITESPACE"," ",1318],"+",["T_WHITESPACE"," ",1318],["T_LNUMBER","1",1318],")",";",["T_WHITESPACE","\n        ",1318],"}",["T_WHITESPACE","\n        ",1319],["T_IF","if",1320],["T_WHITESPACE"," ",1320],"(",["T_VARIABLE","$isActive",1320],")",["T_WHITESPACE"," ",1320],"{",["T_WHITESPACE","\n            ",1320],["T_VARIABLE","$select",1321],["T_OBJECT_OPERATOR","->",1321],["T_STRING","where",1321],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active = ?'",1321],",",["T_WHITESPACE"," ",1321],["T_CONSTANT_ENCAPSED_STRING","'1'",1321],")",";",["T_WHITESPACE","\n        ",1321],"}",["T_WHITESPACE","\n        ",1322],["T_VARIABLE","$_categories",1323],["T_WHITESPACE"," ",1323],"=",["T_WHITESPACE"," ",1323],["T_VARIABLE","$this",1323],["T_OBJECT_OPERATOR","->",1323],["T_STRING","_getReadAdapter",1323],"(",")",["T_OBJECT_OPERATOR","->",1323],["T_STRING","fetchAll",1323],"(",["T_VARIABLE","$select",1323],")",";",["T_WHITESPACE","\n        ",1323],["T_VARIABLE","$categoriesIds",1324],["T_WHITESPACE"," ",1324],"=",["T_WHITESPACE"," ",1324],["T_ARRAY","array",1324],"(",")",";",["T_WHITESPACE","\n        ",1324],["T_FOREACH","foreach",1325],["T_WHITESPACE"," ",1325],"(",["T_VARIABLE","$_categories",1325],["T_WHITESPACE"," ",1325],["T_AS","as",1325],["T_WHITESPACE"," ",1325],["T_VARIABLE","$_category",1325],")",["T_WHITESPACE"," ",1325],"{",["T_WHITESPACE","\n            ",1325],["T_VARIABLE","$categoriesIds",1326],"[","]",["T_WHITESPACE"," ",1326],"=",["T_WHITESPACE"," ",1326],["T_VARIABLE","$_category",1326],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1326],"]",";",["T_WHITESPACE","\n        ",1326],"}",["T_WHITESPACE","\n        ",1327],["T_RETURN","return",1328],["T_WHITESPACE"," ",1328],["T_VARIABLE","$categoriesIds",1328],";",["T_WHITESPACE","\n    ",1328],"}",["T_WHITESPACE","\n\n    ",1329],["T_DOC_COMMENT","\/**\n     * Return all children ids of category (with category id)\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return array\n     *\/",1331],["T_WHITESPACE","\n    ",1336],["T_PUBLIC","public",1337],["T_WHITESPACE"," ",1337],["T_FUNCTION","function",1337],["T_WHITESPACE"," ",1337],["T_STRING","getAllChildren",1337],"(",["T_VARIABLE","$category",1337],")",["T_WHITESPACE","\n    ",1337],"{",["T_WHITESPACE","\n        ",1338],["T_VARIABLE","$categoriesIds",1339],["T_WHITESPACE"," ",1339],"=",["T_WHITESPACE"," ",1339],["T_VARIABLE","$this",1339],["T_OBJECT_OPERATOR","->",1339],["T_STRING","getChildren",1339],"(",["T_VARIABLE","$category",1339],")",";",["T_WHITESPACE","\n        ",1339],["T_VARIABLE","$myId",1340],["T_WHITESPACE"," ",1340],"=",["T_WHITESPACE"," ",1340],["T_ARRAY","array",1340],"(",["T_VARIABLE","$category",1340],["T_OBJECT_OPERATOR","->",1340],["T_STRING","getId",1340],"(",")",")",";",["T_WHITESPACE","\n        ",1340],["T_VARIABLE","$categoriesIds",1341],["T_WHITESPACE"," ",1341],"=",["T_WHITESPACE"," ",1341],["T_STRING","array_merge",1341],"(",["T_VARIABLE","$myId",1341],",",["T_WHITESPACE"," ",1341],["T_VARIABLE","$categoriesIds",1341],")",";",["T_WHITESPACE","\n\n        ",1341],["T_RETURN","return",1343],["T_WHITESPACE"," ",1343],["T_VARIABLE","$categoriesIds",1343],";",["T_WHITESPACE","\n    ",1343],"}",["T_WHITESPACE","\n\n    ",1344],["T_DOC_COMMENT","\/**\n     * Check if category id exist\n     *\n     * @param int $id\n     * @return bool\n     *\/",1346],["T_WHITESPACE","\n    ",1351],["T_PUBLIC","public",1352],["T_WHITESPACE"," ",1352],["T_FUNCTION","function",1352],["T_WHITESPACE"," ",1352],["T_STRING","checkId",1352],"(",["T_VARIABLE","$id",1352],")",["T_WHITESPACE","\n    ",1352],"{",["T_WHITESPACE","\n        ",1353],["T_VARIABLE","$select",1354],["T_WHITESPACE"," ",1354],"=",["T_WHITESPACE"," ",1354],["T_VARIABLE","$this",1354],["T_OBJECT_OPERATOR","->",1354],["T_STRING","_getReadAdapter",1354],"(",")",["T_OBJECT_OPERATOR","->",1354],["T_STRING","select",1354],"(",")",["T_WHITESPACE","\n            ",1354],["T_OBJECT_OPERATOR","->",1355],["T_STRING","from",1355],"(",["T_VARIABLE","$this",1355],["T_OBJECT_OPERATOR","->",1355],["T_STRING","getMainStoreTable",1355],"(",["T_VARIABLE","$this",1355],["T_OBJECT_OPERATOR","->",1355],["T_STRING","getStoreId",1355],"(",")",")",",",["T_WHITESPACE"," ",1355],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1355],")",["T_WHITESPACE","\n            ",1355],["T_OBJECT_OPERATOR","->",1356],["T_STRING","where",1356],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id=?'",1356],",",["T_WHITESPACE"," ",1356],["T_VARIABLE","$id",1356],")",";",["T_WHITESPACE","\n        ",1356],["T_RETURN","return",1357],["T_WHITESPACE"," ",1357],["T_VARIABLE","$this",1357],["T_OBJECT_OPERATOR","->",1357],["T_STRING","_getReadAdapter",1357],"(",")",["T_OBJECT_OPERATOR","->",1357],["T_STRING","fetchOne",1357],"(",["T_VARIABLE","$select",1357],")",";",["T_WHITESPACE","\n    ",1357],"}",["T_WHITESPACE","\n\n    ",1358],["T_DOC_COMMENT","\/**\n     * Get design update data of parent categories\n     *\n     * @param Mage_Catalog_Model_Category $category\n     * @return array\n     *\/",1360],["T_WHITESPACE","\n    ",1365],["T_PUBLIC","public",1366],["T_WHITESPACE"," ",1366],["T_FUNCTION","function",1366],["T_WHITESPACE"," ",1366],["T_STRING","getDesignUpdateData",1366],"(",["T_VARIABLE","$category",1366],")",["T_WHITESPACE","\n    ",1366],"{",["T_WHITESPACE","\n        ",1367],["T_VARIABLE","$categories",1368],["T_WHITESPACE"," ",1368],"=",["T_WHITESPACE"," ",1368],["T_ARRAY","array",1368],"(",")",";",["T_WHITESPACE","\n        ",1368],["T_VARIABLE","$pathIds",1369],["T_WHITESPACE"," ",1369],"=",["T_WHITESPACE"," ",1369],["T_ARRAY","array",1369],"(",")",";",["T_WHITESPACE","\n        ",1369],["T_FOREACH","foreach",1370],["T_WHITESPACE"," ",1370],"(",["T_STRING","array_reverse",1370],"(",["T_VARIABLE","$category",1370],["T_OBJECT_OPERATOR","->",1370],["T_STRING","getParentIds",1370],"(",")",")",["T_WHITESPACE"," ",1370],["T_AS","as",1370],["T_WHITESPACE"," ",1370],["T_VARIABLE","$pathId",1370],")",["T_WHITESPACE"," ",1370],"{",["T_WHITESPACE","\n            ",1370],["T_IF","if",1371],["T_WHITESPACE"," ",1371],"(",["T_VARIABLE","$pathId",1371],["T_WHITESPACE"," ",1371],["T_IS_EQUAL","==",1371],["T_WHITESPACE"," ",1371],["T_STRING","Mage",1371],["T_DOUBLE_COLON","::",1371],["T_STRING","app",1371],"(",")",["T_OBJECT_OPERATOR","->",1371],["T_STRING","getStore",1371],"(",")",["T_OBJECT_OPERATOR","->",1371],["T_STRING","getRootCategoryId",1371],"(",")",")",["T_WHITESPACE"," ",1371],"{",["T_WHITESPACE","\n                ",1371],["T_VARIABLE","$pathIds",1372],"[","]",["T_WHITESPACE"," ",1372],"=",["T_WHITESPACE"," ",1372],["T_VARIABLE","$pathId",1372],";",["T_WHITESPACE","\n                ",1372],["T_BREAK","break",1373],";",["T_WHITESPACE","\n            ",1373],"}",["T_WHITESPACE","\n            ",1374],["T_VARIABLE","$pathIds",1375],"[","]",["T_WHITESPACE"," ",1375],"=",["T_WHITESPACE"," ",1375],["T_VARIABLE","$pathId",1375],";",["T_WHITESPACE","\n        ",1375],"}",["T_WHITESPACE","\n        ",1376],["T_VARIABLE","$select",1377],["T_WHITESPACE"," ",1377],"=",["T_WHITESPACE"," ",1377],["T_VARIABLE","$this",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","_getReadAdapter",1377],"(",")",["T_OBJECT_OPERATOR","->",1377],["T_STRING","select",1377],"(",")",["T_WHITESPACE","\n            ",1377],["T_OBJECT_OPERATOR","->",1378],["T_STRING","from",1378],"(",["T_WHITESPACE","\n                ",1378],["T_ARRAY","array",1379],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",1379],["T_WHITESPACE"," ",1379],["T_DOUBLE_ARROW","=>",1379],["T_WHITESPACE"," ",1379],["T_VARIABLE","$this",1379],["T_OBJECT_OPERATOR","->",1379],["T_STRING","getMainStoreTable",1379],"(",["T_VARIABLE","$category",1379],["T_OBJECT_OPERATOR","->",1379],["T_STRING","getStoreId",1379],"(",")",")",")",",",["T_WHITESPACE","\n                ",1379],["T_ARRAY","array",1380],"(",["T_WHITESPACE","\n                    ",1380],["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id'",1381],",",["T_WHITESPACE","\n                    ",1381],["T_CONSTANT_ENCAPSED_STRING","'main_table.custom_design'",1382],",",["T_WHITESPACE","\n                    ",1382],["T_CONSTANT_ENCAPSED_STRING","'main_table.custom_design_apply'",1383],",",["T_WHITESPACE","\n                    ",1383],["T_CONSTANT_ENCAPSED_STRING","'main_table.custom_design_from'",1384],",",["T_WHITESPACE","\n                    ",1384],["T_CONSTANT_ENCAPSED_STRING","'main_table.custom_design_to'",1385],",",["T_WHITESPACE","\n                ",1385],")",["T_WHITESPACE","\n            ",1386],")",["T_WHITESPACE","\n            ",1387],["T_OBJECT_OPERATOR","->",1388],["T_STRING","where",1388],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id IN (?)'",1388],",",["T_WHITESPACE"," ",1388],["T_VARIABLE","$pathIds",1388],")",["T_WHITESPACE","\n            ",1388],["T_OBJECT_OPERATOR","->",1389],["T_STRING","where",1389],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.is_active = ?'",1389],",",["T_WHITESPACE"," ",1389],["T_CONSTANT_ENCAPSED_STRING","'1'",1389],")",["T_WHITESPACE","\n            ",1389],["T_OBJECT_OPERATOR","->",1390],["T_STRING","order",1390],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.path '",1390],["T_WHITESPACE"," ",1390],".",["T_WHITESPACE"," ",1390],["T_STRING","Varien_Db_Select",1390],["T_DOUBLE_COLON","::",1390],["T_STRING","SQL_DESC",1390],")",";",["T_WHITESPACE","\n        ",1390],["T_VARIABLE","$result",1391],["T_WHITESPACE"," ",1391],"=",["T_WHITESPACE"," ",1391],["T_VARIABLE","$this",1391],["T_OBJECT_OPERATOR","->",1391],["T_STRING","_getReadAdapter",1391],"(",")",["T_OBJECT_OPERATOR","->",1391],["T_STRING","fetchAll",1391],"(",["T_VARIABLE","$select",1391],")",";",["T_WHITESPACE","\n        ",1391],["T_FOREACH","foreach",1392],["T_WHITESPACE"," ",1392],"(",["T_VARIABLE","$result",1392],["T_WHITESPACE"," ",1392],["T_AS","as",1392],["T_WHITESPACE"," ",1392],["T_VARIABLE","$row",1392],")",["T_WHITESPACE"," ",1392],"{",["T_WHITESPACE","\n            ",1392],["T_VARIABLE","$row",1393],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",1393],"]",["T_WHITESPACE"," ",1393],"=",["T_WHITESPACE"," ",1393],["T_VARIABLE","$row",1393],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1393],"]",";",["T_WHITESPACE","\n            ",1393],["T_VARIABLE","$categories",1394],"[",["T_VARIABLE","$row",1394],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1394],"]","]",["T_WHITESPACE"," ",1394],"=",["T_WHITESPACE"," ",1394],["T_STRING","Mage",1394],["T_DOUBLE_COLON","::",1394],["T_STRING","getModel",1394],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",1394],")",["T_OBJECT_OPERATOR","->",1394],["T_STRING","setData",1394],"(",["T_VARIABLE","$row",1394],")",";",["T_WHITESPACE","\n        ",1394],"}",["T_WHITESPACE","\n        ",1395],["T_RETURN","return",1396],["T_WHITESPACE"," ",1396],["T_VARIABLE","$categories",1396],";",["T_WHITESPACE","\n    ",1396],"}",["T_WHITESPACE","\n\n    ",1397],["T_DOC_COMMENT","\/**\n     * Retrieve anchors above\n     *\n     * @param array $filterIds\n     * @param int $storeId\n     * @return array\n     *\/",1399],["T_WHITESPACE","\n    ",1405],["T_PUBLIC","public",1406],["T_WHITESPACE"," ",1406],["T_FUNCTION","function",1406],["T_WHITESPACE"," ",1406],["T_STRING","getAnchorsAbove",1406],"(",["T_ARRAY","array",1406],["T_WHITESPACE"," ",1406],["T_VARIABLE","$filterIds",1406],",",["T_WHITESPACE"," ",1406],["T_VARIABLE","$storeId",1406],["T_WHITESPACE"," ",1406],"=",["T_WHITESPACE"," ",1406],["T_LNUMBER","0",1406],")",["T_WHITESPACE","\n    ",1406],"{",["T_WHITESPACE","\n        ",1407],["T_VARIABLE","$select",1408],["T_WHITESPACE"," ",1408],"=",["T_WHITESPACE"," ",1408],["T_VARIABLE","$this",1408],["T_OBJECT_OPERATOR","->",1408],["T_STRING","_getReadAdapter",1408],"(",")",["T_OBJECT_OPERATOR","->",1408],["T_STRING","select",1408],"(",")",["T_WHITESPACE","\n            ",1408],["T_OBJECT_OPERATOR","->",1409],["T_STRING","from",1409],"(",["T_ARRAY","array",1409],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",1409],["T_WHITESPACE"," ",1409],["T_DOUBLE_ARROW","=>",1409],["T_WHITESPACE"," ",1409],["T_VARIABLE","$this",1409],["T_OBJECT_OPERATOR","->",1409],["T_STRING","getMainStoreTable",1409],"(",["T_VARIABLE","$storeId",1409],")",")",",",["T_WHITESPACE"," ",1409],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1409],")",["T_WHITESPACE","\n            ",1409],["T_OBJECT_OPERATOR","->",1410],["T_STRING","where",1410],"(",["T_CONSTANT_ENCAPSED_STRING","'is_anchor = ?'",1410],",",["T_WHITESPACE"," ",1410],["T_LNUMBER","1",1410],")",["T_WHITESPACE","\n            ",1410],["T_OBJECT_OPERATOR","->",1411],["T_STRING","where",1411],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",1411],",",["T_WHITESPACE"," ",1411],["T_VARIABLE","$filterIds",1411],")",";",["T_WHITESPACE","\n\n        ",1411],["T_RETURN","return",1413],["T_WHITESPACE"," ",1413],["T_VARIABLE","$this",1413],["T_OBJECT_OPERATOR","->",1413],["T_STRING","_getReadAdapter",1413],"(",")",["T_OBJECT_OPERATOR","->",1413],["T_STRING","fetchCol",1413],"(",["T_VARIABLE","$select",1413],")",";",["T_WHITESPACE","\n    ",1413],"}",["T_WHITESPACE","\n\n    ",1414],["T_DOC_COMMENT","\/**\n     * Retrieve array with root category id per store\n     *\n     * @param int|array $storeIds   result limitation\n     * @return array\n     *\/",1416],["T_WHITESPACE","\n    ",1421],["T_PUBLIC","public",1422],["T_WHITESPACE"," ",1422],["T_FUNCTION","function",1422],["T_WHITESPACE"," ",1422],["T_STRING","getStoresRootCategories",1422],"(",["T_VARIABLE","$storeIds",1422],["T_WHITESPACE"," ",1422],"=",["T_WHITESPACE"," ",1422],["T_STRING","null",1422],")",["T_WHITESPACE","\n    ",1422],"{",["T_WHITESPACE","\n        ",1423],["T_IF","if",1424],["T_WHITESPACE"," ",1424],"(",["T_STRING","is_null",1424],"(",["T_VARIABLE","$this",1424],["T_OBJECT_OPERATOR","->",1424],["T_STRING","_storesRootCategories",1424],")",")",["T_WHITESPACE"," ",1424],"{",["T_WHITESPACE","\n            ",1424],["T_VARIABLE","$select",1425],["T_WHITESPACE"," ",1425],"=",["T_WHITESPACE"," ",1425],["T_VARIABLE","$this",1425],["T_OBJECT_OPERATOR","->",1425],["T_STRING","_getWriteAdapter",1425],"(",")",["T_OBJECT_OPERATOR","->",1425],["T_STRING","select",1425],"(",")",["T_WHITESPACE","\n                ",1425],["T_OBJECT_OPERATOR","->",1426],["T_STRING","from",1426],"(",["T_ARRAY","array",1426],"(",["T_CONSTANT_ENCAPSED_STRING","'cs'",1426],["T_WHITESPACE"," ",1426],["T_DOUBLE_ARROW","=>",1426],["T_WHITESPACE"," ",1426],["T_VARIABLE","$this",1426],["T_OBJECT_OPERATOR","->",1426],["T_STRING","getTable",1426],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store'",1426],")",")",",",["T_WHITESPACE"," ",1426],["T_ARRAY","array",1426],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",1426],")",")",["T_WHITESPACE","\n                ",1426],["T_OBJECT_OPERATOR","->",1427],["T_STRING","join",1427],"(",["T_WHITESPACE","\n                    ",1427],["T_ARRAY","array",1428],"(",["T_CONSTANT_ENCAPSED_STRING","'csg'",1428],["T_WHITESPACE"," ",1428],["T_DOUBLE_ARROW","=>",1428],["T_WHITESPACE"," ",1428],["T_VARIABLE","$this",1428],["T_OBJECT_OPERATOR","->",1428],["T_STRING","getTable",1428],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store_group'",1428],")",")",",",["T_WHITESPACE","\n                    ",1428],["T_CONSTANT_ENCAPSED_STRING","'csg.group_id = cs.group_id'",1429],",",["T_WHITESPACE","\n                    ",1429],["T_ARRAY","array",1430],"(",["T_CONSTANT_ENCAPSED_STRING","'root_category_id'",1430],")",")",["T_WHITESPACE","\n                ",1430],["T_OBJECT_OPERATOR","->",1431],["T_STRING","where",1431],"(",["T_CONSTANT_ENCAPSED_STRING","'cs.store_id <> ?'",1431],",",["T_WHITESPACE"," ",1431],["T_STRING","Mage_Catalog_Model_Abstract",1431],["T_DOUBLE_COLON","::",1431],["T_STRING","DEFAULT_STORE_ID",1431],")",";",["T_WHITESPACE","\n            ",1431],["T_VARIABLE","$this",1432],["T_OBJECT_OPERATOR","->",1432],["T_STRING","_storesRootCategories",1432],["T_WHITESPACE"," ",1432],"=",["T_WHITESPACE"," ",1432],["T_VARIABLE","$this",1432],["T_OBJECT_OPERATOR","->",1432],["T_STRING","_getWriteAdapter",1432],"(",")",["T_OBJECT_OPERATOR","->",1432],["T_STRING","fetchPairs",1432],"(",["T_VARIABLE","$select",1432],")",";",["T_WHITESPACE","\n        ",1432],"}",["T_WHITESPACE","\n\n        ",1433],["T_IF","if",1435],["T_WHITESPACE"," ",1435],"(","!",["T_STRING","is_null",1435],"(",["T_VARIABLE","$storeIds",1435],")",")",["T_WHITESPACE"," ",1435],"{",["T_WHITESPACE","\n            ",1435],["T_IF","if",1436],["T_WHITESPACE"," ",1436],"(","!",["T_STRING","is_array",1436],"(",["T_VARIABLE","$storeIds",1436],")",")",["T_WHITESPACE"," ",1436],"{",["T_WHITESPACE","\n                ",1436],["T_VARIABLE","$storeIds",1437],["T_WHITESPACE"," ",1437],"=",["T_WHITESPACE"," ",1437],["T_ARRAY","array",1437],"(",["T_VARIABLE","$storeIds",1437],")",";",["T_WHITESPACE","\n            ",1437],"}",["T_WHITESPACE","\n\n            ",1438],["T_VARIABLE","$stores",1440],["T_WHITESPACE"," ",1440],"=",["T_WHITESPACE"," ",1440],["T_ARRAY","array",1440],"(",")",";",["T_WHITESPACE","\n            ",1440],["T_FOREACH","foreach",1441],["T_WHITESPACE"," ",1441],"(",["T_VARIABLE","$this",1441],["T_OBJECT_OPERATOR","->",1441],["T_STRING","_storesRootCategories",1441],["T_WHITESPACE"," ",1441],["T_AS","as",1441],["T_WHITESPACE"," ",1441],["T_VARIABLE","$storeId",1441],["T_WHITESPACE"," ",1441],["T_DOUBLE_ARROW","=>",1441],["T_WHITESPACE"," ",1441],["T_VARIABLE","$rootId",1441],")",["T_WHITESPACE"," ",1441],"{",["T_WHITESPACE","\n                ",1441],["T_IF","if",1442],["T_WHITESPACE"," ",1442],"(",["T_STRING","in_array",1442],"(",["T_VARIABLE","$storeId",1442],",",["T_WHITESPACE"," ",1442],["T_VARIABLE","$storeIds",1442],")",")",["T_WHITESPACE"," ",1442],"{",["T_WHITESPACE","\n                    ",1442],["T_VARIABLE","$stores",1443],"[",["T_VARIABLE","$storeId",1443],"]",["T_WHITESPACE"," ",1443],"=",["T_WHITESPACE"," ",1443],["T_VARIABLE","$rootId",1443],";",["T_WHITESPACE","\n                ",1443],"}",["T_WHITESPACE","\n            ",1444],"}",["T_WHITESPACE","\n            ",1445],["T_RETURN","return",1446],["T_WHITESPACE"," ",1446],["T_VARIABLE","$stores",1446],";",["T_WHITESPACE","\n        ",1446],"}",["T_WHITESPACE","\n\n        ",1447],["T_RETURN","return",1449],["T_WHITESPACE"," ",1449],["T_VARIABLE","$this",1449],["T_OBJECT_OPERATOR","->",1449],["T_STRING","_storesRootCategories",1449],";",["T_WHITESPACE","\n    ",1449],"}",["T_WHITESPACE","\n\n    ",1450],["T_DOC_COMMENT","\/**\n     * Creating table and adding attributes as fields to table for all stores\n     *\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",1452],["T_WHITESPACE","\n    ",1456],["T_PROTECTED","protected",1457],["T_WHITESPACE"," ",1457],["T_FUNCTION","function",1457],["T_WHITESPACE"," ",1457],["T_STRING","_createTables",1457],"(",")",["T_WHITESPACE","\n    ",1457],"{",["T_WHITESPACE","\n        ",1458],["T_IF","if",1459],["T_WHITESPACE"," ",1459],"(",["T_VARIABLE","$this",1459],["T_OBJECT_OPERATOR","->",1459],["T_STRING","_allowTableChanges",1459],")",["T_WHITESPACE"," ",1459],"{",["T_WHITESPACE","\n            ",1459],["T_FOREACH","foreach",1460],["T_WHITESPACE"," ",1460],"(",["T_STRING","Mage",1460],["T_DOUBLE_COLON","::",1460],["T_STRING","app",1460],"(",")",["T_OBJECT_OPERATOR","->",1460],["T_STRING","getStores",1460],"(",")",["T_WHITESPACE"," ",1460],["T_AS","as",1460],["T_WHITESPACE"," ",1460],["T_VARIABLE","$store",1460],")",["T_WHITESPACE"," ",1460],"{",["T_WHITESPACE","\n                ",1460],["T_VARIABLE","$this",1461],["T_OBJECT_OPERATOR","->",1461],["T_STRING","_createTable",1461],"(",["T_VARIABLE","$store",1461],["T_OBJECT_OPERATOR","->",1461],["T_STRING","getId",1461],"(",")",")",";",["T_WHITESPACE","\n            ",1461],"}",["T_WHITESPACE","\n        ",1462],"}",["T_WHITESPACE","\n        ",1463],["T_RETURN","return",1464],["T_WHITESPACE"," ",1464],["T_VARIABLE","$this",1464],";",["T_WHITESPACE","\n    ",1464],"}",["T_WHITESPACE","\n\n    ",1465],["T_DOC_COMMENT","\/**\n     * Transactional rebuild flat data from eav\n     *\n     * @throws Exception\n     * @return Mage_Catalog_Model_Resource_Category_Flat\n     *\/",1467],["T_WHITESPACE","\n    ",1472],["T_PUBLIC","public",1473],["T_WHITESPACE"," ",1473],["T_FUNCTION","function",1473],["T_WHITESPACE"," ",1473],["T_STRING","reindexAll",1473],"(",")",["T_WHITESPACE","\n    ",1473],"{",["T_WHITESPACE","\n        ",1474],["T_VARIABLE","$this",1475],["T_OBJECT_OPERATOR","->",1475],["T_STRING","_createTables",1475],"(",")",";",["T_WHITESPACE","\n        ",1475],["T_VARIABLE","$allowTableChanges",1476],["T_WHITESPACE"," ",1476],"=",["T_WHITESPACE"," ",1476],["T_VARIABLE","$this",1476],["T_OBJECT_OPERATOR","->",1476],["T_STRING","_allowTableChanges",1476],";",["T_WHITESPACE","\n        ",1476],["T_IF","if",1477],["T_WHITESPACE"," ",1477],"(",["T_VARIABLE","$allowTableChanges",1477],")",["T_WHITESPACE"," ",1477],"{",["T_WHITESPACE","\n            ",1477],["T_VARIABLE","$this",1478],["T_OBJECT_OPERATOR","->",1478],["T_STRING","_allowTableChanges",1478],["T_WHITESPACE"," ",1478],"=",["T_WHITESPACE"," ",1478],["T_STRING","false",1478],";",["T_WHITESPACE","\n        ",1478],"}",["T_WHITESPACE","\n        ",1479],["T_VARIABLE","$this",1480],["T_OBJECT_OPERATOR","->",1480],["T_STRING","beginTransaction",1480],"(",")",";",["T_WHITESPACE","\n        ",1480],["T_TRY","try",1481],["T_WHITESPACE"," ",1481],"{",["T_WHITESPACE","\n            ",1481],["T_VARIABLE","$this",1482],["T_OBJECT_OPERATOR","->",1482],["T_STRING","rebuild",1482],"(",")",";",["T_WHITESPACE","\n            ",1482],["T_VARIABLE","$this",1483],["T_OBJECT_OPERATOR","->",1483],["T_STRING","commit",1483],"(",")",";",["T_WHITESPACE","\n            ",1483],["T_IF","if",1484],["T_WHITESPACE"," ",1484],"(",["T_VARIABLE","$allowTableChanges",1484],")",["T_WHITESPACE"," ",1484],"{",["T_WHITESPACE","\n                ",1484],["T_VARIABLE","$this",1485],["T_OBJECT_OPERATOR","->",1485],["T_STRING","_allowTableChanges",1485],["T_WHITESPACE"," ",1485],"=",["T_WHITESPACE"," ",1485],["T_STRING","true",1485],";",["T_WHITESPACE","\n            ",1485],"}",["T_WHITESPACE","\n        ",1486],"}",["T_WHITESPACE"," ",1487],["T_CATCH","catch",1487],["T_WHITESPACE"," ",1487],"(",["T_STRING","Exception",1487],["T_WHITESPACE"," ",1487],["T_VARIABLE","$e",1487],")",["T_WHITESPACE"," ",1487],"{",["T_WHITESPACE","\n            ",1487],["T_VARIABLE","$this",1488],["T_OBJECT_OPERATOR","->",1488],["T_STRING","rollBack",1488],"(",")",";",["T_WHITESPACE","\n            ",1488],["T_IF","if",1489],["T_WHITESPACE"," ",1489],"(",["T_VARIABLE","$allowTableChanges",1489],")",["T_WHITESPACE"," ",1489],"{",["T_WHITESPACE","\n                ",1489],["T_VARIABLE","$this",1490],["T_OBJECT_OPERATOR","->",1490],["T_STRING","_allowTableChanges",1490],["T_WHITESPACE"," ",1490],"=",["T_WHITESPACE"," ",1490],["T_STRING","true",1490],";",["T_WHITESPACE","\n            ",1490],"}",["T_WHITESPACE","\n            ",1491],["T_THROW","throw",1492],["T_WHITESPACE"," ",1492],["T_VARIABLE","$e",1492],";",["T_WHITESPACE","\n        ",1492],"}",["T_WHITESPACE","\n        ",1493],["T_RETURN","return",1494],["T_WHITESPACE"," ",1494],["T_VARIABLE","$this",1494],";",["T_WHITESPACE","\n    ",1494],"}",["T_WHITESPACE","\n\n    ",1495],["T_DOC_COMMENT","\/**\n     * Check if Catalog Category Flat Data has been initialized\n     *\n     * @deprecated use Mage_Catalog_Model_Resource_Category_Flat::isBuilt() instead\n     *\n     * @return bool\n     *\/",1497],["T_WHITESPACE","\n    ",1503],["T_PUBLIC","public",1504],["T_WHITESPACE"," ",1504],["T_FUNCTION","function",1504],["T_WHITESPACE"," ",1504],["T_STRING","isRebuilt",1504],"(",")",["T_WHITESPACE","\n    ",1504],"{",["T_WHITESPACE","\n        ",1505],["T_RETURN","return",1506],["T_WHITESPACE"," ",1506],["T_VARIABLE","$this",1506],["T_OBJECT_OPERATOR","->",1506],["T_STRING","isBuilt",1506],"(",")",";",["T_WHITESPACE","\n    ",1506],"}",["T_WHITESPACE","\n",1507],"}",["T_WHITESPACE","\n",1508]]