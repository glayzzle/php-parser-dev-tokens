[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Product type price model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Product_Type_Configurable_Price",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Product_Type_Price",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Get product final price\n     *\n     * @param   double $qty\n     * @param   Mage_Catalog_Model_Product $product\n     * @return  double\n     *\/",36],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","getFinalPrice",43],"(",["T_VARIABLE","$qty",43],"=",["T_STRING","null",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$product",43],")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_IF","if",45],["T_WHITESPACE"," ",45],"(",["T_STRING","is_null",45],"(",["T_VARIABLE","$qty",45],")",["T_WHITESPACE"," ",45],["T_BOOLEAN_AND","&&",45],["T_WHITESPACE"," ",45],"!",["T_STRING","is_null",45],"(",["T_VARIABLE","$product",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getCalculatedFinalPrice",45],"(",")",")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n            ",45],["T_RETURN","return",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$product",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getCalculatedFinalPrice",46],"(",")",";",["T_WHITESPACE","\n        ",46],"}",["T_WHITESPACE","\n\n        ",47],["T_VARIABLE","$basePrice",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getBasePrice",49],"(",["T_VARIABLE","$product",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$qty",49],")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$finalPrice",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$basePrice",50],";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$product",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","setFinalPrice",51],"(",["T_VARIABLE","$finalPrice",51],")",";",["T_WHITESPACE","\n        ",51],["T_STRING","Mage",52],["T_DOUBLE_COLON","::",52],["T_STRING","dispatchEvent",52],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_get_final_price'",52],",",["T_WHITESPACE"," ",52],["T_ARRAY","array",52],"(",["T_CONSTANT_ENCAPSED_STRING","'product'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$product",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'qty'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$qty",52],")",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$finalPrice",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$product",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getData",53],"(",["T_CONSTANT_ENCAPSED_STRING","'final_price'",53],")",";",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$finalPrice",55],["T_WHITESPACE"," ",55],["T_PLUS_EQUAL","+=",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getTotalConfigurableItemsPrice",55],"(",["T_VARIABLE","$product",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$finalPrice",55],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$finalPrice",56],["T_WHITESPACE"," ",56],["T_PLUS_EQUAL","+=",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_applyOptionsPrice",56],"(",["T_VARIABLE","$product",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$qty",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$basePrice",56],")",["T_WHITESPACE"," ",56],"-",["T_WHITESPACE"," ",56],["T_VARIABLE","$basePrice",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$finalPrice",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","max",57],"(",["T_LNUMBER","0",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$finalPrice",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$product",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","setFinalPrice",59],"(",["T_VARIABLE","$finalPrice",59],")",";",["T_WHITESPACE","\n        ",59],["T_RETURN","return",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$finalPrice",60],";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Get Total price for configurable items\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param float $finalPrice\n     * @return float\n     *\/",63],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","getTotalConfigurableItemsPrice",70],"(",["T_VARIABLE","$product",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$finalPrice",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$price",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_DNUMBER","0.0",72],";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$product",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getTypeInstance",74],"(",["T_STRING","true",74],")",["T_WHITESPACE","\n                ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","setStoreFilter",75],"(",["T_VARIABLE","$product",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getStore",75],"(",")",",",["T_WHITESPACE"," ",75],["T_VARIABLE","$product",75],")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$attributes",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$product",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getTypeInstance",76],"(",["T_STRING","true",76],")",["T_WHITESPACE","\n                ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","getConfigurableAttributes",77],"(",["T_VARIABLE","$product",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_VARIABLE","$selectedAttributes",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",")",";",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$product",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getCustomOption",80],"(",["T_CONSTANT_ENCAPSED_STRING","'attributes'",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$selectedAttributes",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","unserialize",81],"(",["T_VARIABLE","$product",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getCustomOption",81],"(",["T_CONSTANT_ENCAPSED_STRING","'attributes'",81],")",["T_OBJECT_OPERATOR","->",81],["T_STRING","getValue",81],"(",")",")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n\n        ",82],["T_FOREACH","foreach",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$attributes",84],["T_WHITESPACE"," ",84],["T_AS","as",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$attribute",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$attributeId",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$attribute",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getProductAttribute",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","getId",85],"(",")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$value",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_getValueByIndex",86],"(",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$attribute",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getPrices",87],"(",")",["T_WHITESPACE"," ",87],"?",["T_WHITESPACE"," ",87],["T_VARIABLE","$attribute",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getPrices",87],"(",")",["T_WHITESPACE"," ",87],":",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",")",",",["T_WHITESPACE","\n                ",87],["T_ISSET","isset",88],"(",["T_VARIABLE","$selectedAttributes",88],"[",["T_VARIABLE","$attributeId",88],"]",")",["T_WHITESPACE"," ",88],"?",["T_WHITESPACE"," ",88],["T_VARIABLE","$selectedAttributes",88],"[",["T_VARIABLE","$attributeId",88],"]",["T_WHITESPACE"," ",88],":",["T_WHITESPACE"," ",88],["T_STRING","null",88],["T_WHITESPACE","\n            ",88],")",";",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$product",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","setParentId",90],"(",["T_STRING","true",90],")",";",["T_WHITESPACE","\n            ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$value",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$value",92],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing_value'",92],"]",["T_WHITESPACE"," ",92],["T_IS_NOT_EQUAL","!=",92],["T_WHITESPACE"," ",92],["T_LNUMBER","0",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                    ",92],["T_VARIABLE","$product",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","setConfigurablePrice",93],"(",["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_calcSelectionPrice",93],"(",["T_VARIABLE","$value",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$finalPrice",93],")",")",";",["T_WHITESPACE","\n                    ",93],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","dispatchEvent",94],"(",["T_WHITESPACE","\n                        ",94],["T_CONSTANT_ENCAPSED_STRING","'catalog_product_type_configurable_price'",95],",",["T_WHITESPACE","\n                        ",95],["T_ARRAY","array",96],"(",["T_CONSTANT_ENCAPSED_STRING","'product'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$product",96],")",["T_WHITESPACE","\n                    ",96],")",";",["T_WHITESPACE","\n                    ",97],["T_VARIABLE","$price",98],["T_WHITESPACE"," ",98],["T_PLUS_EQUAL","+=",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$product",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getConfigurablePrice",98],"(",")",";",["T_WHITESPACE","\n                ",98],"}",["T_WHITESPACE","\n            ",99],"}",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$price",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Calculate configurable product selection price\n     *\n     * @param   array $priceInfo\n     * @param   decimal $productPrice\n     * @return  decimal\n     *\/",105],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","_calcSelectionPrice",112],"(",["T_VARIABLE","$priceInfo",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$productPrice",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],"(",["T_VARIABLE","$priceInfo",114],"[",["T_CONSTANT_ENCAPSED_STRING","'is_percent'",114],"]",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$ratio",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$priceInfo",115],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing_value'",115],"]","\/",["T_LNUMBER","100",115],";",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$price",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$productPrice",116],["T_WHITESPACE"," ",116],"*",["T_WHITESPACE"," ",116],["T_VARIABLE","$ratio",116],";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE"," ",117],["T_ELSE","else",117],["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$price",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$priceInfo",118],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing_value'",118],"]",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$price",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_PROTECTED","protected",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","_getValueByIndex",123],"(",["T_VARIABLE","$values",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$index",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n        ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$values",124],["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$value",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_IF","if",125],"(",["T_VARIABLE","$value",125],"[",["T_CONSTANT_ENCAPSED_STRING","'value_index'",125],"]",["T_WHITESPACE"," ",125],["T_IS_EQUAL","==",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$index",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$value",126],";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n        ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","false",129],";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n",130],"}",["T_WHITESPACE","\n",131]]