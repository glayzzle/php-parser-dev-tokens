[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Configurable product type implementation\n *\n * This type builds in product attributes and existing simple products\n *\n * @category   Mage\n * @package    Mage_Catalog\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",35],["T_CLASS","class",36],["T_WHITESPACE"," ",36],["T_STRING","Mage_Catalog_Model_Product_Type_Configurable",36],["T_WHITESPACE"," ",36],["T_EXTENDS","extends",36],["T_WHITESPACE"," ",36],["T_STRING","Mage_Catalog_Model_Product_Type_Abstract",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","TYPE_CODE",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'configurable'",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Cache key for Used Product Attribute Ids\n     *\n     * @var string\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_usedProductAttributeIds",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_product_attribute_ids'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Cache key for Used Product Attributes\n     *\n     * @var string\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_usedProductAttributes",52],["T_WHITESPACE","   ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_product_attributes'",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Cache key for Used Attributes\n     *\n     * @var string\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_usedAttributes",59],["T_WHITESPACE","          ",59],"=",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_attributes'",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Cache key for configurable attributes\n     *\n     * @var string\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_configurableAttributes",66],["T_WHITESPACE","  ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_configurable_attributes'",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Cache key for Used product ids\n     *\n     * @var string\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$_usedProductIds",73],["T_WHITESPACE","          ",73],"=",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_product_ids'",73],";",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Cache key for used products\n     *\n     * @var string\n     *\/",75],["T_WHITESPACE","\n    ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$_usedProducts",80],["T_WHITESPACE","            ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_products'",80],";",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Product is composite\n     *\n     * @var bool\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$_isComposite",87],["T_WHITESPACE","             ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","true",87],";",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Product is configurable\n     *\n     * @var bool\n     *\/",89],["T_WHITESPACE","\n    ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$_canConfigure",94],["T_WHITESPACE","            ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","true",94],";",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Product attributes to include on the children of configurable products\n     *\n     * @var string\n     *\/",96],["T_WHITESPACE","\n    ",100],["T_CONST","const",101],["T_WHITESPACE"," ",101],["T_STRING","XML_PATH_PRODUCT_CONFIGURABLE_CHILD_ATTRIBUTES",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'frontend\/product\/configurable\/child\/attributes'",101],";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Return relation info about used products\n     *\n     * @return Varien_Object Object with information data\n     *\/",103],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","getRelationInfo",108],"(",")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$info",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Varien_Object",110],"(",")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$info",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setTable",111],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_link'",111],")",["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","setParentFieldName",112],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",112],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","setChildFieldName",113],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",113],")",";",["T_WHITESPACE","\n        ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$info",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Retrieve Required children ids\n     * Return grouped array, ex array(\n     *   group => array(ids)\n     * )\n     *\n     * @param  int $parentId\n     * @param  bool $required\n     * @return array\n     *\/",117],["T_WHITESPACE","\n    ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","getChildrenIds",127],"(",["T_VARIABLE","$parentId",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$required",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","true",127],")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","Mage",129],["T_DOUBLE_COLON","::",129],["T_STRING","getResourceSingleton",129],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable'",129],")",["T_WHITESPACE","\n            ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","getChildrenIds",130],"(",["T_VARIABLE","$parentId",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$required",130],")",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Retrieve parent ids array by required child\n     *\n     * @param  int|array $childId\n     * @return array\n     *\/",133],["T_WHITESPACE","\n    ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","getParentIdsByChild",139],"(",["T_VARIABLE","$childId",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","getResourceSingleton",141],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable'",141],")",["T_WHITESPACE","\n            ",141],["T_OBJECT_OPERATOR","->",142],["T_STRING","getParentIdsByChild",142],"(",["T_VARIABLE","$childId",142],")",";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Retrieve product type attributes\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",145],["T_WHITESPACE","\n    ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","getEditableAttributes",151],"(",["T_VARIABLE","$product",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","null",151],")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_STRING","is_null",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_editableAttributes",153],")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_editableAttributes",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_STRING","parent",154],["T_DOUBLE_COLON","::",154],["T_STRING","getEditableAttributes",154],"(",["T_VARIABLE","$product",154],")",";",["T_WHITESPACE","\n            ",154],["T_FOREACH","foreach",155],["T_WHITESPACE"," ",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_editableAttributes",155],["T_WHITESPACE"," ",155],["T_AS","as",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$index",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$attribute",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n                ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getUsedProductAttributeIds",156],"(",["T_VARIABLE","$product",156],")",["T_WHITESPACE","\n                    ",156],["T_BOOLEAN_AND","&&",157],["T_WHITESPACE"," ",157],["T_STRING","in_array",157],"(",["T_VARIABLE","$attribute",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getAttributeId",157],"(",")",",",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getUsedProductAttributeIds",157],"(",["T_VARIABLE","$product",157],")",")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                    ",157],["T_UNSET","unset",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_editableAttributes",158],"[",["T_VARIABLE","$index",158],"]",")",";",["T_WHITESPACE","\n                ",158],"}",["T_WHITESPACE","\n            ",159],"}",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_editableAttributes",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Checkin attribute availability for create superproduct\n     *\n     * @param   Mage_Eav_Model_Entity_Attribute $attribute\n     * @return  bool\n     *\/",165],["T_WHITESPACE","\n    ",170],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","canUseAttribute",171],"(",["T_STRING","Mage_Eav_Model_Entity_Attribute",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$attribute",171],")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$allow",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$attribute",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getIsGlobal",173],"(",")",["T_WHITESPACE"," ",173],["T_IS_EQUAL","==",173],["T_WHITESPACE"," ",173],["T_STRING","Mage_Catalog_Model_Resource_Eav_Attribute",173],["T_DOUBLE_COLON","::",173],["T_STRING","SCOPE_GLOBAL",173],["T_WHITESPACE","\n            ",173],["T_BOOLEAN_AND","&&",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$attribute",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getIsVisible",174],"(",")",["T_WHITESPACE","\n            ",174],["T_BOOLEAN_AND","&&",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$attribute",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getIsConfigurable",175],"(",")",["T_WHITESPACE","\n            ",175],["T_BOOLEAN_AND","&&",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$attribute",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","usesSource",176],"(",")",["T_WHITESPACE","\n            ",176],["T_BOOLEAN_AND","&&",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$attribute",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getIsUserDefined",177],"(",")",";",["T_WHITESPACE","\n\n        ",177],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$allow",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Declare attribute identifiers used for assign subproducts\n     *\n     * @param   array $ids\n     * @param   Mage_Catalog_Model_Product $product\n     * @return  Mage_Catalog_Model_Product_Type_Configurable\n     *\/",182],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","setUsedProductAttributeIds",189],"(",["T_VARIABLE","$ids",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$product",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","null",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$usedProductAttributes",191],["T_WHITESPACE","  ",191],"=",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",")",";",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$configurableAttributes",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_ARRAY","array",192],"(",")",";",["T_WHITESPACE","\n\n        ",192],["T_FOREACH","foreach",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$ids",194],["T_WHITESPACE"," ",194],["T_AS","as",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$attributeId",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$usedProductAttributes",195],"[","]",["T_WHITESPACE","  ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getAttributeById",195],"(",["T_VARIABLE","$attributeId",195],")",";",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$configurableAttributes",196],"[","]",["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","getModel",196],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable_attribute'",196],")",["T_WHITESPACE","\n                ",196],["T_OBJECT_OPERATOR","->",197],["T_STRING","setProductAttribute",197],"(",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getAttributeById",197],"(",["T_VARIABLE","$attributeId",197],")",")",";",["T_WHITESPACE","\n        ",197],"}",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getProduct",199],"(",["T_VARIABLE","$product",199],")",["T_OBJECT_OPERATOR","->",199],["T_STRING","setData",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_usedProductAttributes",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$usedProductAttributes",199],")",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getProduct",200],"(",["T_VARIABLE","$product",200],")",["T_OBJECT_OPERATOR","->",200],["T_STRING","setData",200],"(",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_usedProductAttributeIds",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$ids",200],")",";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getProduct",201],"(",["T_VARIABLE","$product",201],")",["T_OBJECT_OPERATOR","->",201],["T_STRING","setData",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_configurableAttributes",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$configurableAttributes",201],")",";",["T_WHITESPACE","\n\n        ",201],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Retrieve identifiers of used product attributes\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",206],["T_WHITESPACE","\n    ",211],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","getUsedProductAttributeIds",212],"(",["T_VARIABLE","$product",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","null",212],")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(","!",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getProduct",214],"(",["T_VARIABLE","$product",214],")",["T_OBJECT_OPERATOR","->",214],["T_STRING","hasData",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_usedProductAttributeIds",214],")",")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$usedProductAttributeIds",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_ARRAY","array",215],"(",")",";",["T_WHITESPACE","\n            ",215],["T_FOREACH","foreach",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getUsedProductAttributes",216],"(",["T_VARIABLE","$product",216],")",["T_WHITESPACE"," ",216],["T_AS","as",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$attribute",216],")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                ",216],["T_VARIABLE","$usedProductAttributeIds",217],"[","]",["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$attribute",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getId",217],"(",")",";",["T_WHITESPACE","\n            ",217],"}",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getProduct",219],"(",["T_VARIABLE","$product",219],")",["T_OBJECT_OPERATOR","->",219],["T_STRING","setData",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_usedProductAttributeIds",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$usedProductAttributeIds",219],")",";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n        ",220],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getProduct",221],"(",["T_VARIABLE","$product",221],")",["T_OBJECT_OPERATOR","->",221],["T_STRING","getData",221],"(",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_usedProductAttributeIds",221],")",";",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Retrieve used product attributes\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",224],["T_WHITESPACE","\n    ",229],["T_PUBLIC","public",230],["T_WHITESPACE"," ",230],["T_FUNCTION","function",230],["T_WHITESPACE"," ",230],["T_STRING","getUsedProductAttributes",230],"(",["T_VARIABLE","$product",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_STRING","null",230],")",["T_WHITESPACE","\n    ",230],"{",["T_WHITESPACE","\n        ",231],["T_IF","if",232],["T_WHITESPACE"," ",232],"(","!",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getProduct",232],"(",["T_VARIABLE","$product",232],")",["T_OBJECT_OPERATOR","->",232],["T_STRING","hasData",232],"(",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_usedProductAttributes",232],")",")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$usedProductAttributes",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_ARRAY","array",233],"(",")",";",["T_WHITESPACE","\n            ",233],["T_VARIABLE","$usedAttributes",234],["T_WHITESPACE","        ",234],"=",["T_WHITESPACE"," ",234],["T_ARRAY","array",234],"(",")",";",["T_WHITESPACE","\n            ",234],["T_FOREACH","foreach",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getConfigurableAttributes",235],"(",["T_VARIABLE","$product",235],")",["T_WHITESPACE"," ",235],["T_AS","as",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$attribute",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n                ",235],["T_IF","if",236],["T_WHITESPACE"," ",236],"(","!",["T_STRING","is_null",236],"(",["T_VARIABLE","$attribute",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getProductAttribute",236],"(",")",")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n                    ",236],["T_VARIABLE","$id",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$attribute",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getProductAttribute",237],"(",")",["T_OBJECT_OPERATOR","->",237],["T_STRING","getId",237],"(",")",";",["T_WHITESPACE","\n                    ",237],["T_VARIABLE","$usedProductAttributes",238],"[",["T_VARIABLE","$id",238],"]",["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$attribute",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getProductAttribute",238],"(",")",";",["T_WHITESPACE","\n                    ",238],["T_VARIABLE","$usedAttributes",239],"[",["T_VARIABLE","$id",239],"]",["T_WHITESPACE","        ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$attribute",239],";",["T_WHITESPACE","\n                ",239],"}",["T_WHITESPACE","\n            ",240],"}",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getProduct",242],"(",["T_VARIABLE","$product",242],")",["T_OBJECT_OPERATOR","->",242],["T_STRING","setData",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_usedAttributes",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$usedAttributes",242],")",";",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getProduct",243],"(",["T_VARIABLE","$product",243],")",["T_OBJECT_OPERATOR","->",243],["T_STRING","setData",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_usedProductAttributes",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$usedProductAttributes",243],")",";",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE","\n        ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getProduct",245],"(",["T_VARIABLE","$product",245],")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getData",245],"(",["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_usedProductAttributes",245],")",";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n\n    ",246],["T_DOC_COMMENT","\/**\n     * Retrieve configurable attributes data\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",248],["T_WHITESPACE","\n    ",253],["T_PUBLIC","public",254],["T_WHITESPACE"," ",254],["T_FUNCTION","function",254],["T_WHITESPACE"," ",254],["T_STRING","getConfigurableAttributes",254],"(",["T_VARIABLE","$product",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_STRING","null",254],")",["T_WHITESPACE","\n    ",254],"{",["T_WHITESPACE","\n        ",255],["T_STRING","Varien_Profiler",256],["T_DOUBLE_COLON","::",256],["T_STRING","start",256],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",256],".",["T_METHOD_C","__METHOD__",256],")",";",["T_WHITESPACE","\n        ",256],["T_IF","if",257],["T_WHITESPACE"," ",257],"(","!",["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getProduct",257],"(",["T_VARIABLE","$product",257],")",["T_OBJECT_OPERATOR","->",257],["T_STRING","hasData",257],"(",["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_configurableAttributes",257],")",")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n            ",257],["T_VARIABLE","$configurableAttributes",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getConfigurableAttributeCollection",258],"(",["T_VARIABLE","$product",258],")",["T_WHITESPACE","\n                ",258],["T_OBJECT_OPERATOR","->",259],["T_STRING","orderByPosition",259],"(",")",["T_WHITESPACE","\n                ",259],["T_OBJECT_OPERATOR","->",260],["T_STRING","load",260],"(",")",";",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getProduct",261],"(",["T_VARIABLE","$product",261],")",["T_OBJECT_OPERATOR","->",261],["T_STRING","setData",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_configurableAttributes",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$configurableAttributes",261],")",";",["T_WHITESPACE","\n        ",261],"}",["T_WHITESPACE","\n        ",262],["T_STRING","Varien_Profiler",263],["T_DOUBLE_COLON","::",263],["T_STRING","stop",263],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",263],".",["T_METHOD_C","__METHOD__",263],")",";",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getProduct",264],"(",["T_VARIABLE","$product",264],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","getData",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_configurableAttributes",264],")",";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Retrieve Configurable Attributes as array\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",267],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","getConfigurableAttributesAsArray",273],"(",["T_VARIABLE","$product",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","null",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$res",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_ARRAY","array",275],"(",")",";",["T_WHITESPACE","\n        ",275],["T_FOREACH","foreach",276],["T_WHITESPACE"," ",276],"(",["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getConfigurableAttributes",276],"(",["T_VARIABLE","$product",276],")",["T_WHITESPACE"," ",276],["T_AS","as",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$attribute",276],")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$res",277],"[","]",["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_ARRAY","array",277],"(",["T_WHITESPACE","\n                ",277],["T_CONSTANT_ENCAPSED_STRING","'id'",278],["T_WHITESPACE","             ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$attribute",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getId",278],"(",")",",",["T_WHITESPACE","\n                ",278],["T_CONSTANT_ENCAPSED_STRING","'label'",279],["T_WHITESPACE","          ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$attribute",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getLabel",279],"(",")",",",["T_WHITESPACE","\n                ",279],["T_CONSTANT_ENCAPSED_STRING","'use_default'",280],["T_WHITESPACE","    ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$attribute",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getUseDefault",280],"(",")",",",["T_WHITESPACE","\n                ",280],["T_CONSTANT_ENCAPSED_STRING","'position'",281],["T_WHITESPACE","       ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$attribute",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getPosition",281],"(",")",",",["T_WHITESPACE","\n                ",281],["T_CONSTANT_ENCAPSED_STRING","'values'",282],["T_WHITESPACE","         ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$attribute",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getPrices",282],"(",")",["T_WHITESPACE"," ",282],"?",["T_WHITESPACE"," ",282],["T_VARIABLE","$attribute",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getPrices",282],"(",")",["T_WHITESPACE"," ",282],":",["T_WHITESPACE"," ",282],["T_ARRAY","array",282],"(",")",",",["T_WHITESPACE","\n                ",282],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",283],["T_WHITESPACE","   ",283],["T_DOUBLE_ARROW","=>",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$attribute",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getProductAttribute",283],"(",")",["T_OBJECT_OPERATOR","->",283],["T_STRING","getId",283],"(",")",",",["T_WHITESPACE","\n                ",283],["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",284],["T_WHITESPACE"," ",284],["T_DOUBLE_ARROW","=>",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$attribute",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getProductAttribute",284],"(",")",["T_OBJECT_OPERATOR","->",284],["T_STRING","getAttributeCode",284],"(",")",",",["T_WHITESPACE","\n                ",284],["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",285],["T_WHITESPACE"," ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$attribute",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getProductAttribute",285],"(",")",["T_OBJECT_OPERATOR","->",285],["T_STRING","getFrontend",285],"(",")",["T_OBJECT_OPERATOR","->",285],["T_STRING","getLabel",285],"(",")",",",["T_WHITESPACE","\n                ",285],["T_CONSTANT_ENCAPSED_STRING","'store_label'",286],["T_WHITESPACE","    ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$attribute",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getProductAttribute",286],"(",")",["T_OBJECT_OPERATOR","->",286],["T_STRING","getStoreLabel",286],"(",")",",",["T_WHITESPACE","\n            ",286],")",";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n        ",288],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$res",289],";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_DOC_COMMENT","\/**\n     * Retrieve configurable attribute collection\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Type_Configurable_Attribute_Collection\n     *\/",292],["T_WHITESPACE","\n    ",297],["T_PUBLIC","public",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","getConfigurableAttributeCollection",298],"(",["T_VARIABLE","$product",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_STRING","null",298],")",["T_WHITESPACE","\n    ",298],"{",["T_WHITESPACE","\n        ",299],["T_RETURN","return",300],["T_WHITESPACE"," ",300],["T_STRING","Mage",300],["T_DOUBLE_COLON","::",300],["T_STRING","getResourceModel",300],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable_attribute_collection'",300],")",["T_WHITESPACE","\n            ",300],["T_OBJECT_OPERATOR","->",301],["T_STRING","setProductFilter",301],"(",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getProduct",301],"(",["T_VARIABLE","$product",301],")",")",";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Retrieve subproducts identifiers\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",305],["T_WHITESPACE","\n    ",310],["T_PUBLIC","public",311],["T_WHITESPACE"," ",311],["T_FUNCTION","function",311],["T_WHITESPACE"," ",311],["T_STRING","getUsedProductIds",311],"(",["T_VARIABLE","$product",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_STRING","null",311],")",["T_WHITESPACE","\n    ",311],"{",["T_WHITESPACE","\n        ",312],["T_IF","if",313],["T_WHITESPACE"," ",313],"(","!",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getProduct",313],"(",["T_VARIABLE","$product",313],")",["T_OBJECT_OPERATOR","->",313],["T_STRING","hasData",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_usedProductIds",313],")",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n            ",313],["T_VARIABLE","$usedProductIds",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_ARRAY","array",314],"(",")",";",["T_WHITESPACE","\n            ",314],["T_FOREACH","foreach",315],["T_WHITESPACE"," ",315],"(",["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getUsedProducts",315],"(",["T_STRING","null",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$product",315],")",["T_WHITESPACE"," ",315],["T_AS","as",315],["T_WHITESPACE"," ",315],["T_VARIABLE","$product",315],")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n                ",315],["T_VARIABLE","$usedProductIds",316],"[","]",["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$product",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getId",316],"(",")",";",["T_WHITESPACE","\n            ",316],"}",["T_WHITESPACE","\n            ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getProduct",318],"(",["T_VARIABLE","$product",318],")",["T_OBJECT_OPERATOR","->",318],["T_STRING","setData",318],"(",["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_usedProductIds",318],",",["T_WHITESPACE"," ",318],["T_VARIABLE","$usedProductIds",318],")",";",["T_WHITESPACE","\n        ",318],"}",["T_WHITESPACE","\n        ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getProduct",320],"(",["T_VARIABLE","$product",320],")",["T_OBJECT_OPERATOR","->",320],["T_STRING","getData",320],"(",["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_usedProductIds",320],")",";",["T_WHITESPACE","\n    ",320],"}",["T_WHITESPACE","\n\n    ",321],["T_DOC_COMMENT","\/**\n     * Retrieve array of \"subproducts\"\n     *\n     * @param  array\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",323],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","getUsedProducts",330],"(",["T_VARIABLE","$requiredAttributeIds",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","null",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$product",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","null",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_STRING","Varien_Profiler",332],["T_DOUBLE_COLON","::",332],["T_STRING","start",332],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",332],".",["T_METHOD_C","__METHOD__",332],")",";",["T_WHITESPACE","\n        ",332],["T_IF","if",333],["T_WHITESPACE"," ",333],"(","!",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getProduct",333],"(",["T_VARIABLE","$product",333],")",["T_OBJECT_OPERATOR","->",333],["T_STRING","hasData",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_usedProducts",333],")",")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n            ",333],["T_IF","if",334],["T_WHITESPACE"," ",334],"(",["T_STRING","is_null",334],"(",["T_VARIABLE","$requiredAttributeIds",334],")",["T_WHITESPACE","\n                ",334],["T_LOGICAL_AND","and",335],["T_WHITESPACE"," ",335],["T_STRING","is_null",335],"(",["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","getProduct",335],"(",["T_VARIABLE","$product",335],")",["T_OBJECT_OPERATOR","->",335],["T_STRING","getData",335],"(",["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_configurableAttributes",335],")",")",")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n                ",335],["T_COMMENT","\/\/ If used products load before attributes, we will load attributes.\n",336],["T_WHITESPACE","                ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getConfigurableAttributes",337],"(",["T_VARIABLE","$product",337],")",";",["T_WHITESPACE","\n                ",337],["T_COMMENT","\/\/ After attributes loading products loaded too.\n",338],["T_WHITESPACE","                ",339],["T_STRING","Varien_Profiler",339],["T_DOUBLE_COLON","::",339],["T_STRING","stop",339],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",339],".",["T_METHOD_C","__METHOD__",339],")",";",["T_WHITESPACE","\n                ",339],["T_RETURN","return",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getProduct",340],"(",["T_VARIABLE","$product",340],")",["T_OBJECT_OPERATOR","->",340],["T_STRING","getData",340],"(",["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_usedProducts",340],")",";",["T_WHITESPACE","\n            ",340],"}",["T_WHITESPACE","\n\n            ",341],["T_VARIABLE","$usedProducts",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_ARRAY","array",343],"(",")",";",["T_WHITESPACE","\n            ",343],["T_VARIABLE","$collection",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","getUsedProductCollection",344],"(",["T_VARIABLE","$product",344],")",["T_WHITESPACE","\n                ",344],["T_OBJECT_OPERATOR","->",345],["T_STRING","addFilterByRequiredOptions",345],"(",")",";",["T_WHITESPACE","\n\n            ",345],["T_COMMENT","\/\/ Provides a mechanism for attaching additional attributes to the children of configurable products\n",347],["T_WHITESPACE","            ",348],["T_COMMENT","\/\/ Will primarily have affect on the configurable product view page\n",348],["T_WHITESPACE","            ",349],["T_VARIABLE","$childAttributes",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_STRING","Mage",349],["T_DOUBLE_COLON","::",349],["T_STRING","getConfig",349],"(",")",["T_OBJECT_OPERATOR","->",349],["T_STRING","getNode",349],"(",["T_STRING","self",349],["T_DOUBLE_COLON","::",349],["T_STRING","XML_PATH_PRODUCT_CONFIGURABLE_CHILD_ATTRIBUTES",349],")",";",["T_WHITESPACE","\n\n            ",349],["T_IF","if",351],["T_WHITESPACE"," ",351],"(",["T_VARIABLE","$childAttributes",351],")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n                ",351],["T_VARIABLE","$childAttributes",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_VARIABLE","$childAttributes",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","asArray",352],"(",")",";",["T_WHITESPACE","\n                ",352],["T_VARIABLE","$childAttributes",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_STRING","array_keys",353],"(",["T_VARIABLE","$childAttributes",353],")",";",["T_WHITESPACE","\n\n                ",353],["T_VARIABLE","$collection",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","addAttributeToSelect",355],"(",["T_VARIABLE","$childAttributes",355],")",";",["T_WHITESPACE","\n            ",355],"}",["T_WHITESPACE","\n\n            ",356],["T_IF","if",358],["T_WHITESPACE"," ",358],"(",["T_STRING","is_array",358],"(",["T_VARIABLE","$requiredAttributeIds",358],")",")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n                ",358],["T_FOREACH","foreach",359],["T_WHITESPACE"," ",359],"(",["T_VARIABLE","$requiredAttributeIds",359],["T_WHITESPACE"," ",359],["T_AS","as",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$attributeId",359],")",["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n                    ",359],["T_VARIABLE","$attribute",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getAttributeById",360],"(",["T_VARIABLE","$attributeId",360],",",["T_WHITESPACE"," ",360],["T_VARIABLE","$product",360],")",";",["T_WHITESPACE","\n                    ",360],["T_IF","if",361],["T_WHITESPACE"," ",361],"(","!",["T_STRING","is_null",361],"(",["T_VARIABLE","$attribute",361],")",")",["T_WHITESPACE","\n                        ",361],["T_VARIABLE","$collection",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","addAttributeToFilter",362],"(",["T_VARIABLE","$attribute",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getAttributeCode",362],"(",")",",",["T_WHITESPACE"," ",362],["T_ARRAY","array",362],"(",["T_CONSTANT_ENCAPSED_STRING","'notnull'",362],["T_DOUBLE_ARROW","=>",362],["T_LNUMBER","1",362],")",")",";",["T_WHITESPACE","\n                ",362],"}",["T_WHITESPACE","\n            ",363],"}",["T_WHITESPACE","\n\n            ",364],["T_FOREACH","foreach",366],["T_WHITESPACE"," ",366],"(",["T_VARIABLE","$collection",366],["T_WHITESPACE"," ",366],["T_AS","as",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$item",366],")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n                ",366],["T_VARIABLE","$usedProducts",367],"[","]",["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$item",367],";",["T_WHITESPACE","\n            ",367],"}",["T_WHITESPACE","\n\n            ",368],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getProduct",370],"(",["T_VARIABLE","$product",370],")",["T_OBJECT_OPERATOR","->",370],["T_STRING","setData",370],"(",["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","_usedProducts",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$usedProducts",370],")",";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n        ",371],["T_STRING","Varien_Profiler",372],["T_DOUBLE_COLON","::",372],["T_STRING","stop",372],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",372],".",["T_METHOD_C","__METHOD__",372],")",";",["T_WHITESPACE","\n        ",372],["T_RETURN","return",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getProduct",373],"(",["T_VARIABLE","$product",373],")",["T_OBJECT_OPERATOR","->",373],["T_STRING","getData",373],"(",["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_usedProducts",373],")",";",["T_WHITESPACE","\n    ",373],"}",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * Retrieve related products collection\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Type_Configurable_Product_Collection\n     *\/",376],["T_WHITESPACE","\n    ",381],["T_PUBLIC","public",382],["T_WHITESPACE"," ",382],["T_FUNCTION","function",382],["T_WHITESPACE"," ",382],["T_STRING","getUsedProductCollection",382],"(",["T_VARIABLE","$product",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_STRING","null",382],")",["T_WHITESPACE","\n    ",382],"{",["T_WHITESPACE","\n        ",383],["T_VARIABLE","$collection",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","Mage",384],["T_DOUBLE_COLON","::",384],["T_STRING","getResourceModel",384],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable_product_collection'",384],")",["T_WHITESPACE","\n            ",384],["T_OBJECT_OPERATOR","->",385],["T_STRING","setFlag",385],"(",["T_CONSTANT_ENCAPSED_STRING","'require_stock_items'",385],",",["T_WHITESPACE"," ",385],["T_STRING","true",385],")",["T_WHITESPACE","\n            ",385],["T_OBJECT_OPERATOR","->",386],["T_STRING","setFlag",386],"(",["T_CONSTANT_ENCAPSED_STRING","'product_children'",386],",",["T_WHITESPACE"," ",386],["T_STRING","true",386],")",["T_WHITESPACE","\n            ",386],["T_OBJECT_OPERATOR","->",387],["T_STRING","setProductFilter",387],"(",["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getProduct",387],"(",["T_VARIABLE","$product",387],")",")",";",["T_WHITESPACE","\n        ",387],["T_IF","if",388],["T_WHITESPACE"," ",388],"(","!",["T_STRING","is_null",388],"(",["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getStoreFilter",388],"(",["T_VARIABLE","$product",388],")",")",")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$collection",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","addStoreFilter",389],"(",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getStoreFilter",389],"(",["T_VARIABLE","$product",389],")",")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n\n        ",390],["T_RETURN","return",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$collection",392],";",["T_WHITESPACE","\n    ",392],"}",["T_WHITESPACE","\n\n    ",393],["T_DOC_COMMENT","\/**\n     * Before save process\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Configurable\n     *\/",395],["T_WHITESPACE","\n    ",400],["T_PUBLIC","public",401],["T_WHITESPACE"," ",401],["T_FUNCTION","function",401],["T_WHITESPACE"," ",401],["T_STRING","beforeSave",401],"(",["T_VARIABLE","$product",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","null",401],")",["T_WHITESPACE","\n    ",401],"{",["T_WHITESPACE","\n        ",402],["T_STRING","parent",403],["T_DOUBLE_COLON","::",403],["T_STRING","beforeSave",403],"(",["T_VARIABLE","$product",403],")",";",["T_WHITESPACE","\n\n        ",403],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","getProduct",405],"(",["T_VARIABLE","$product",405],")",["T_OBJECT_OPERATOR","->",405],["T_STRING","canAffectOptions",405],"(",["T_STRING","false",405],")",";",["T_WHITESPACE","\n\n        ",405],["T_IF","if",407],["T_WHITESPACE"," ",407],"(",["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","getProduct",407],"(",["T_VARIABLE","$product",407],")",["T_OBJECT_OPERATOR","->",407],["T_STRING","getCanSaveConfigurableAttributes",407],"(",")",")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n            ",407],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","getProduct",408],"(",["T_VARIABLE","$product",408],")",["T_OBJECT_OPERATOR","->",408],["T_STRING","canAffectOptions",408],"(",["T_STRING","true",408],")",";",["T_WHITESPACE","\n            ",408],["T_VARIABLE","$data",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","getProduct",409],"(",["T_VARIABLE","$product",409],")",["T_OBJECT_OPERATOR","->",409],["T_STRING","getConfigurableAttributesData",409],"(",")",";",["T_WHITESPACE","\n            ",409],["T_IF","if",410],["T_WHITESPACE"," ",410],"(","!",["T_EMPTY","empty",410],"(",["T_VARIABLE","$data",410],")",")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n                ",410],["T_FOREACH","foreach",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$data",411],["T_WHITESPACE"," ",411],["T_AS","as",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$attribute",411],")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n                    ",411],["T_IF","if",412],["T_WHITESPACE"," ",412],"(","!",["T_EMPTY","empty",412],"(",["T_VARIABLE","$attribute",412],"[",["T_CONSTANT_ENCAPSED_STRING","'values'",412],"]",")",")",["T_WHITESPACE"," ",412],"{",["T_WHITESPACE","\n                        ",412],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","getProduct",413],"(",["T_VARIABLE","$product",413],")",["T_OBJECT_OPERATOR","->",413],["T_STRING","setTypeHasOptions",413],"(",["T_STRING","true",413],")",";",["T_WHITESPACE","\n                        ",413],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getProduct",414],"(",["T_VARIABLE","$product",414],")",["T_OBJECT_OPERATOR","->",414],["T_STRING","setTypeHasRequiredOptions",414],"(",["T_STRING","true",414],")",";",["T_WHITESPACE","\n                        ",414],["T_BREAK","break",415],";",["T_WHITESPACE","\n                    ",415],"}",["T_WHITESPACE","\n                ",416],"}",["T_WHITESPACE","\n            ",417],"}",["T_WHITESPACE","\n        ",418],"}",["T_WHITESPACE","\n        ",419],["T_FOREACH","foreach",420],["T_WHITESPACE"," ",420],"(",["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","getConfigurableAttributes",420],"(",["T_VARIABLE","$product",420],")",["T_WHITESPACE"," ",420],["T_AS","as",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$attribute",420],")",["T_WHITESPACE"," ",420],"{",["T_WHITESPACE","\n            ",420],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","getProduct",421],"(",["T_VARIABLE","$product",421],")",["T_OBJECT_OPERATOR","->",421],["T_STRING","setData",421],"(",["T_VARIABLE","$attribute",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","getProductAttribute",421],"(",")",["T_OBJECT_OPERATOR","->",421],["T_STRING","getAttributeCode",421],"(",")",",",["T_WHITESPACE"," ",421],["T_STRING","null",421],")",";",["T_WHITESPACE","\n        ",421],"}",["T_WHITESPACE","\n\n        ",422],["T_RETURN","return",424],["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],";",["T_WHITESPACE","\n    ",424],"}",["T_WHITESPACE","\n\n    ",425],["T_DOC_COMMENT","\/**\n     * Save configurable product depended data\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Configurable\n     *\/",427],["T_WHITESPACE","\n    ",432],["T_PUBLIC","public",433],["T_WHITESPACE"," ",433],["T_FUNCTION","function",433],["T_WHITESPACE"," ",433],["T_STRING","save",433],"(",["T_VARIABLE","$product",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_STRING","null",433],")",["T_WHITESPACE","\n    ",433],"{",["T_WHITESPACE","\n        ",434],["T_STRING","parent",435],["T_DOUBLE_COLON","::",435],["T_STRING","save",435],"(",["T_VARIABLE","$product",435],")",";",["T_WHITESPACE","\n        ",435],["T_DOC_COMMENT","\/**\n         * Save Attributes Information\n         *\/",436],["T_WHITESPACE","\n        ",438],["T_IF","if",439],["T_WHITESPACE"," ",439],"(",["T_VARIABLE","$data",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getProduct",439],"(",["T_VARIABLE","$product",439],")",["T_OBJECT_OPERATOR","->",439],["T_STRING","getConfigurableAttributesData",439],"(",")",")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n            ",439],["T_FOREACH","foreach",440],["T_WHITESPACE"," ",440],"(",["T_VARIABLE","$data",440],["T_WHITESPACE"," ",440],["T_AS","as",440],["T_WHITESPACE"," ",440],["T_VARIABLE","$attributeData",440],")",["T_WHITESPACE"," ",440],"{",["T_WHITESPACE","\n                ",440],["T_VARIABLE","$id",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_ISSET","isset",441],"(",["T_VARIABLE","$attributeData",441],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",441],"]",")",["T_WHITESPACE"," ",441],"?",["T_WHITESPACE"," ",441],["T_VARIABLE","$attributeData",441],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",441],"]",["T_WHITESPACE"," ",441],":",["T_WHITESPACE"," ",441],["T_STRING","null",441],";",["T_WHITESPACE","\n                ",441],["T_STRING","Mage",442],["T_DOUBLE_COLON","::",442],["T_STRING","getModel",442],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable_attribute'",442],")",["T_WHITESPACE","\n                   ",442],["T_OBJECT_OPERATOR","->",443],["T_STRING","setData",443],"(",["T_VARIABLE","$attributeData",443],")",["T_WHITESPACE","\n                   ",443],["T_OBJECT_OPERATOR","->",444],["T_STRING","setId",444],"(",["T_VARIABLE","$id",444],")",["T_WHITESPACE","\n                   ",444],["T_OBJECT_OPERATOR","->",445],["T_STRING","setStoreId",445],"(",["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","getProduct",445],"(",["T_VARIABLE","$product",445],")",["T_OBJECT_OPERATOR","->",445],["T_STRING","getStoreId",445],"(",")",")",["T_WHITESPACE","\n                   ",445],["T_OBJECT_OPERATOR","->",446],["T_STRING","setProductId",446],"(",["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getProduct",446],"(",["T_VARIABLE","$product",446],")",["T_OBJECT_OPERATOR","->",446],["T_STRING","getId",446],"(",")",")",["T_WHITESPACE","\n                   ",446],["T_OBJECT_OPERATOR","->",447],["T_STRING","save",447],"(",")",";",["T_WHITESPACE","\n            ",447],"}",["T_WHITESPACE","\n        ",448],"}",["T_WHITESPACE","\n\n        ",449],["T_DOC_COMMENT","\/**\n         * Save product relations\n         *\/",451],["T_WHITESPACE","\n        ",453],["T_VARIABLE","$data",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","getProduct",454],"(",["T_VARIABLE","$product",454],")",["T_OBJECT_OPERATOR","->",454],["T_STRING","getConfigurableProductsData",454],"(",")",";",["T_WHITESPACE","\n        ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_STRING","is_array",455],"(",["T_VARIABLE","$data",455],")",")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n            ",455],["T_VARIABLE","$productIds",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_STRING","array_keys",456],"(",["T_VARIABLE","$data",456],")",";",["T_WHITESPACE","\n            ",456],["T_STRING","Mage",457],["T_DOUBLE_COLON","::",457],["T_STRING","getResourceModel",457],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable'",457],")",["T_WHITESPACE","\n                ",457],["T_OBJECT_OPERATOR","->",458],["T_STRING","saveProducts",458],"(",["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getProduct",458],"(",["T_VARIABLE","$product",458],")",",",["T_WHITESPACE"," ",458],["T_VARIABLE","$productIds",458],")",";",["T_WHITESPACE","\n        ",458],"}",["T_WHITESPACE","\n        ",459],["T_RETURN","return",460],["T_WHITESPACE"," ",460],["T_VARIABLE","$this",460],";",["T_WHITESPACE","\n    ",460],"}",["T_WHITESPACE","\n\n    ",461],["T_DOC_COMMENT","\/**\n     * Check is product available for sale\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",463],["T_WHITESPACE","\n    ",468],["T_PUBLIC","public",469],["T_WHITESPACE"," ",469],["T_FUNCTION","function",469],["T_WHITESPACE"," ",469],["T_STRING","isSalable",469],"(",["T_VARIABLE","$product",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_STRING","null",469],")",["T_WHITESPACE","\n    ",469],"{",["T_WHITESPACE","\n        ",470],["T_VARIABLE","$salable",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_STRING","parent",471],["T_DOUBLE_COLON","::",471],["T_STRING","isSalable",471],"(",["T_VARIABLE","$product",471],")",";",["T_WHITESPACE","\n\n        ",471],["T_IF","if",473],["T_WHITESPACE"," ",473],"(",["T_VARIABLE","$salable",473],["T_WHITESPACE"," ",473],["T_IS_NOT_IDENTICAL","!==",473],["T_WHITESPACE"," ",473],["T_STRING","false",473],")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$salable",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","false",474],";",["T_WHITESPACE","\n            ",474],["T_IF","if",475],["T_WHITESPACE"," ",475],"(","!",["T_STRING","is_null",475],"(",["T_VARIABLE","$product",475],")",")",["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n                ",475],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","setStoreFilter",476],"(",["T_VARIABLE","$product",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getStoreId",476],"(",")",",",["T_WHITESPACE"," ",476],["T_VARIABLE","$product",476],")",";",["T_WHITESPACE","\n            ",476],"}",["T_WHITESPACE","\n            ",477],["T_FOREACH","foreach",478],["T_WHITESPACE"," ",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","getUsedProducts",478],"(",["T_STRING","null",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$product",478],")",["T_WHITESPACE"," ",478],["T_AS","as",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$child",478],")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n                ",478],["T_IF","if",479],["T_WHITESPACE"," ",479],"(",["T_VARIABLE","$child",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","isSalable",479],"(",")",")",["T_WHITESPACE"," ",479],"{",["T_WHITESPACE","\n                    ",479],["T_VARIABLE","$salable",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_STRING","true",480],";",["T_WHITESPACE","\n                    ",480],["T_BREAK","break",481],";",["T_WHITESPACE","\n                ",481],"}",["T_WHITESPACE","\n            ",482],"}",["T_WHITESPACE","\n        ",483],"}",["T_WHITESPACE","\n\n        ",484],["T_RETURN","return",486],["T_WHITESPACE"," ",486],["T_VARIABLE","$salable",486],";",["T_WHITESPACE","\n    ",486],"}",["T_WHITESPACE","\n\n    ",487],["T_DOC_COMMENT","\/**\n     * Check whether the product is available for sale\n     * is alias to isSalable for compatibility\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",489],["T_WHITESPACE","\n    ",495],["T_PUBLIC","public",496],["T_WHITESPACE"," ",496],["T_FUNCTION","function",496],["T_WHITESPACE"," ",496],["T_STRING","getIsSalable",496],"(",["T_VARIABLE","$product",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_STRING","null",496],")",["T_WHITESPACE","\n    ",496],"{",["T_WHITESPACE","\n        ",497],["T_RETURN","return",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","isSalable",498],"(",["T_VARIABLE","$product",498],")",";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Retrieve used product by attribute values\n     *  $attrbutesInfo = array(\n     *      $attributeId => $attributeValue\n     *  )\n     *\n     * @param  array $attributesInfo\n     * @param  Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product|null\n     *\/",501],["T_WHITESPACE","\n    ",510],["T_PUBLIC","public",511],["T_WHITESPACE"," ",511],["T_FUNCTION","function",511],["T_WHITESPACE"," ",511],["T_STRING","getProductByAttributes",511],"(",["T_VARIABLE","$attributesInfo",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$product",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_STRING","null",511],")",["T_WHITESPACE","\n    ",511],"{",["T_WHITESPACE","\n        ",512],["T_IF","if",513],["T_WHITESPACE"," ",513],"(",["T_STRING","is_array",513],"(",["T_VARIABLE","$attributesInfo",513],")",["T_WHITESPACE"," ",513],["T_BOOLEAN_AND","&&",513],["T_WHITESPACE"," ",513],"!",["T_EMPTY","empty",513],"(",["T_VARIABLE","$attributesInfo",513],")",")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n            ",513],["T_VARIABLE","$productCollection",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","getUsedProductCollection",514],"(",["T_VARIABLE","$product",514],")",["T_OBJECT_OPERATOR","->",514],["T_STRING","addAttributeToSelect",514],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",514],")",";",["T_WHITESPACE","\n            ",514],["T_FOREACH","foreach",515],["T_WHITESPACE"," ",515],"(",["T_VARIABLE","$attributesInfo",515],["T_WHITESPACE"," ",515],["T_AS","as",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$attributeId",515],["T_WHITESPACE"," ",515],["T_DOUBLE_ARROW","=>",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$attributeValue",515],")",["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n                ",515],["T_VARIABLE","$productCollection",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","addAttributeToFilter",516],"(",["T_VARIABLE","$attributeId",516],",",["T_WHITESPACE"," ",516],["T_VARIABLE","$attributeValue",516],")",";",["T_WHITESPACE","\n            ",516],"}",["T_WHITESPACE","\n            ",517],["T_VARIABLE","$productObject",518],["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],["T_VARIABLE","$productCollection",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","getFirstItem",518],"(",")",";",["T_WHITESPACE","\n            ",518],["T_IF","if",519],["T_WHITESPACE"," ",519],"(",["T_VARIABLE","$productObject",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","getId",519],"(",")",")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n                ",519],["T_RETURN","return",520],["T_WHITESPACE"," ",520],["T_VARIABLE","$productObject",520],";",["T_WHITESPACE","\n            ",520],"}",["T_WHITESPACE","\n\n            ",521],["T_FOREACH","foreach",523],["T_WHITESPACE"," ",523],"(",["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","getUsedProducts",523],"(",["T_STRING","null",523],",",["T_WHITESPACE"," ",523],["T_VARIABLE","$product",523],")",["T_WHITESPACE"," ",523],["T_AS","as",523],["T_WHITESPACE"," ",523],["T_VARIABLE","$productObject",523],")",["T_WHITESPACE"," ",523],"{",["T_WHITESPACE","\n                ",523],["T_VARIABLE","$checkRes",524],["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_STRING","true",524],";",["T_WHITESPACE","\n                ",524],["T_FOREACH","foreach",525],["T_WHITESPACE"," ",525],"(",["T_VARIABLE","$attributesInfo",525],["T_WHITESPACE"," ",525],["T_AS","as",525],["T_WHITESPACE"," ",525],["T_VARIABLE","$attributeId",525],["T_WHITESPACE"," ",525],["T_DOUBLE_ARROW","=>",525],["T_WHITESPACE"," ",525],["T_VARIABLE","$attributeValue",525],")",["T_WHITESPACE"," ",525],"{",["T_WHITESPACE","\n                    ",525],["T_VARIABLE","$code",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","getAttributeById",526],"(",["T_VARIABLE","$attributeId",526],",",["T_WHITESPACE"," ",526],["T_VARIABLE","$product",526],")",["T_OBJECT_OPERATOR","->",526],["T_STRING","getAttributeCode",526],"(",")",";",["T_WHITESPACE","\n                    ",526],["T_IF","if",527],["T_WHITESPACE"," ",527],"(",["T_VARIABLE","$productObject",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","getData",527],"(",["T_VARIABLE","$code",527],")",["T_WHITESPACE"," ",527],["T_IS_NOT_EQUAL","!=",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$attributeValue",527],")",["T_WHITESPACE"," ",527],"{",["T_WHITESPACE","\n                        ",527],["T_VARIABLE","$checkRes",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_STRING","false",528],";",["T_WHITESPACE","\n                    ",528],"}",["T_WHITESPACE","\n                ",529],"}",["T_WHITESPACE","\n                ",530],["T_IF","if",531],["T_WHITESPACE"," ",531],"(",["T_VARIABLE","$checkRes",531],")",["T_WHITESPACE"," ",531],"{",["T_WHITESPACE","\n                    ",531],["T_RETURN","return",532],["T_WHITESPACE"," ",532],["T_VARIABLE","$productObject",532],";",["T_WHITESPACE","\n                ",532],"}",["T_WHITESPACE","\n            ",533],"}",["T_WHITESPACE","\n        ",534],"}",["T_WHITESPACE","\n        ",535],["T_RETURN","return",536],["T_WHITESPACE"," ",536],["T_STRING","null",536],";",["T_WHITESPACE","\n    ",536],"}",["T_WHITESPACE","\n\n    ",537],["T_DOC_COMMENT","\/**\n     * Retrieve Selected Attributes info\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",539],["T_WHITESPACE","\n    ",544],["T_PUBLIC","public",545],["T_WHITESPACE"," ",545],["T_FUNCTION","function",545],["T_WHITESPACE"," ",545],["T_STRING","getSelectedAttributesInfo",545],"(",["T_VARIABLE","$product",545],["T_WHITESPACE"," ",545],"=",["T_WHITESPACE"," ",545],["T_STRING","null",545],")",["T_WHITESPACE","\n    ",545],"{",["T_WHITESPACE","\n        ",546],["T_VARIABLE","$attributes",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_ARRAY","array",547],"(",")",";",["T_WHITESPACE","\n        ",547],["T_STRING","Varien_Profiler",548],["T_DOUBLE_COLON","::",548],["T_STRING","start",548],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",548],".",["T_METHOD_C","__METHOD__",548],")",";",["T_WHITESPACE","\n        ",548],["T_IF","if",549],["T_WHITESPACE"," ",549],"(",["T_VARIABLE","$attributesOption",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","getProduct",549],"(",["T_VARIABLE","$product",549],")",["T_OBJECT_OPERATOR","->",549],["T_STRING","getCustomOption",549],"(",["T_CONSTANT_ENCAPSED_STRING","'attributes'",549],")",")",["T_WHITESPACE"," ",549],"{",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$data",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_STRING","unserialize",550],"(",["T_VARIABLE","$attributesOption",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","getValue",550],"(",")",")",";",["T_WHITESPACE","\n            ",550],["T_VARIABLE","$this",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","getUsedProductAttributeIds",551],"(",["T_VARIABLE","$product",551],")",";",["T_WHITESPACE","\n\n            ",551],["T_VARIABLE","$usedAttributes",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","getProduct",553],"(",["T_VARIABLE","$product",553],")",["T_OBJECT_OPERATOR","->",553],["T_STRING","getData",553],"(",["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","_usedAttributes",553],")",";",["T_WHITESPACE","\n\n            ",553],["T_FOREACH","foreach",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$data",555],["T_WHITESPACE"," ",555],["T_AS","as",555],["T_WHITESPACE"," ",555],["T_VARIABLE","$attributeId",555],["T_WHITESPACE"," ",555],["T_DOUBLE_ARROW","=>",555],["T_WHITESPACE"," ",555],["T_VARIABLE","$attributeValue",555],")",["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n                ",555],["T_IF","if",556],["T_WHITESPACE"," ",556],"(",["T_ISSET","isset",556],"(",["T_VARIABLE","$usedAttributes",556],"[",["T_VARIABLE","$attributeId",556],"]",")",")",["T_WHITESPACE"," ",556],"{",["T_WHITESPACE","\n                    ",556],["T_VARIABLE","$attribute",557],["T_WHITESPACE"," ",557],"=",["T_WHITESPACE"," ",557],["T_VARIABLE","$usedAttributes",557],"[",["T_VARIABLE","$attributeId",557],"]",";",["T_WHITESPACE","\n                    ",557],["T_VARIABLE","$label",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_VARIABLE","$attribute",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","getLabel",558],"(",")",";",["T_WHITESPACE","\n                    ",558],["T_VARIABLE","$value",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_VARIABLE","$attribute",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","getProductAttribute",559],"(",")",";",["T_WHITESPACE","\n                    ",559],["T_IF","if",560],["T_WHITESPACE"," ",560],"(",["T_VARIABLE","$value",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","getSourceModel",560],"(",")",")",["T_WHITESPACE"," ",560],"{",["T_WHITESPACE","\n                        ",560],["T_VARIABLE","$value",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_VARIABLE","$value",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","getSource",561],"(",")",["T_OBJECT_OPERATOR","->",561],["T_STRING","getOptionText",561],"(",["T_VARIABLE","$attributeValue",561],")",";",["T_WHITESPACE","\n                    ",561],"}",["T_WHITESPACE","\n                    ",562],["T_ELSE","else",563],["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n                        ",563],["T_VARIABLE","$value",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","''",564],";",["T_WHITESPACE","\n                    ",564],"}",["T_WHITESPACE","\n\n                    ",565],["T_VARIABLE","$attributes",567],"[","]",["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_ARRAY","array",567],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",567],["T_DOUBLE_ARROW","=>",567],["T_VARIABLE","$label",567],",",["T_WHITESPACE"," ",567],["T_CONSTANT_ENCAPSED_STRING","'value'",567],["T_DOUBLE_ARROW","=>",567],["T_VARIABLE","$value",567],")",";",["T_WHITESPACE","\n                ",567],"}",["T_WHITESPACE","\n            ",568],"}",["T_WHITESPACE","\n        ",569],"}",["T_WHITESPACE","\n        ",570],["T_STRING","Varien_Profiler",571],["T_DOUBLE_COLON","::",571],["T_STRING","stop",571],"(",["T_CONSTANT_ENCAPSED_STRING","'CONFIGURABLE:'",571],".",["T_METHOD_C","__METHOD__",571],")",";",["T_WHITESPACE","\n        ",571],["T_RETURN","return",572],["T_WHITESPACE"," ",572],["T_VARIABLE","$attributes",572],";",["T_WHITESPACE","\n    ",572],"}",["T_WHITESPACE","\n\n    ",573],["T_DOC_COMMENT","\/**\n     * Prepare product and its configuration to be added to some products list.\n     * Perform standard preparation process and then add Configurable specific options.\n     *\n     * @param Varien_Object $buyRequest\n     * @param Mage_Catalog_Model_Product $product\n     * @param string $processMode\n     * @return array|string\n     *\/",575],["T_WHITESPACE","\n    ",583],["T_PROTECTED","protected",584],["T_WHITESPACE"," ",584],["T_FUNCTION","function",584],["T_WHITESPACE"," ",584],["T_STRING","_prepareProduct",584],"(",["T_STRING","Varien_Object",584],["T_WHITESPACE"," ",584],["T_VARIABLE","$buyRequest",584],",",["T_WHITESPACE"," ",584],["T_VARIABLE","$product",584],",",["T_WHITESPACE"," ",584],["T_VARIABLE","$processMode",584],")",["T_WHITESPACE","\n    ",584],"{",["T_WHITESPACE","\n        ",585],["T_VARIABLE","$attributes",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_VARIABLE","$buyRequest",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","getSuperAttribute",586],"(",")",";",["T_WHITESPACE","\n        ",586],["T_IF","if",587],["T_WHITESPACE"," ",587],"(",["T_VARIABLE","$attributes",587],["T_WHITESPACE"," ",587],["T_BOOLEAN_OR","||",587],["T_WHITESPACE"," ",587],"!",["T_VARIABLE","$this",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","_isStrictProcessMode",587],"(",["T_VARIABLE","$processMode",587],")",")",["T_WHITESPACE"," ",587],"{",["T_WHITESPACE","\n            ",587],["T_IF","if",588],["T_WHITESPACE"," ",588],"(","!",["T_VARIABLE","$this",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","_isStrictProcessMode",588],"(",["T_VARIABLE","$processMode",588],")",")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n                ",588],["T_IF","if",589],["T_WHITESPACE"," ",589],"(",["T_STRING","is_array",589],"(",["T_VARIABLE","$attributes",589],")",")",["T_WHITESPACE"," ",589],"{",["T_WHITESPACE","\n                    ",589],["T_FOREACH","foreach",590],["T_WHITESPACE"," ",590],"(",["T_VARIABLE","$attributes",590],["T_WHITESPACE"," ",590],["T_AS","as",590],["T_WHITESPACE"," ",590],["T_VARIABLE","$key",590],["T_WHITESPACE"," ",590],["T_DOUBLE_ARROW","=>",590],["T_WHITESPACE"," ",590],["T_VARIABLE","$val",590],")",["T_WHITESPACE"," ",590],"{",["T_WHITESPACE","\n                        ",590],["T_IF","if",591],["T_WHITESPACE"," ",591],"(",["T_EMPTY","empty",591],"(",["T_VARIABLE","$val",591],")",")",["T_WHITESPACE"," ",591],"{",["T_WHITESPACE","\n                            ",591],["T_UNSET","unset",592],"(",["T_VARIABLE","$attributes",592],"[",["T_VARIABLE","$key",592],"]",")",";",["T_WHITESPACE","\n                        ",592],"}",["T_WHITESPACE","\n                    ",593],"}",["T_WHITESPACE","\n                ",594],"}",["T_WHITESPACE"," ",595],["T_ELSE","else",595],["T_WHITESPACE"," ",595],"{",["T_WHITESPACE","\n                    ",595],["T_VARIABLE","$attributes",596],["T_WHITESPACE"," ",596],"=",["T_WHITESPACE"," ",596],["T_ARRAY","array",596],"(",")",";",["T_WHITESPACE","\n                ",596],"}",["T_WHITESPACE","\n            ",597],"}",["T_WHITESPACE","\n\n            ",598],["T_VARIABLE","$result",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],["T_STRING","parent",600],["T_DOUBLE_COLON","::",600],["T_STRING","_prepareProduct",600],"(",["T_VARIABLE","$buyRequest",600],",",["T_WHITESPACE"," ",600],["T_VARIABLE","$product",600],",",["T_WHITESPACE"," ",600],["T_VARIABLE","$processMode",600],")",";",["T_WHITESPACE","\n            ",600],["T_IF","if",601],["T_WHITESPACE"," ",601],"(",["T_STRING","is_array",601],"(",["T_VARIABLE","$result",601],")",")",["T_WHITESPACE"," ",601],"{",["T_WHITESPACE","\n                ",601],["T_VARIABLE","$product",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","getProduct",602],"(",["T_VARIABLE","$product",602],")",";",["T_WHITESPACE","\n                ",602],["T_DOC_COMMENT","\/**\n                 * $attributes = array($attributeId=>$attributeValue)\n                 *\/",603],["T_WHITESPACE","\n                ",605],["T_VARIABLE","$subProduct",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_STRING","true",606],";",["T_WHITESPACE","\n                ",606],["T_IF","if",607],["T_WHITESPACE"," ",607],"(",["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","_isStrictProcessMode",607],"(",["T_VARIABLE","$processMode",607],")",")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n                    ",607],["T_FOREACH","foreach",608],"(",["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","getConfigurableAttributes",608],"(",["T_VARIABLE","$product",608],")",["T_WHITESPACE"," ",608],["T_AS","as",608],["T_WHITESPACE"," ",608],["T_VARIABLE","$attributeItem",608],")","{",["T_WHITESPACE","\n                        ",608],["T_COMMENT","\/* @var $attributeItem Varien_Object *\/",609],["T_WHITESPACE","\n                        ",609],["T_VARIABLE","$attrId",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_VARIABLE","$attributeItem",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","getData",610],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",610],")",";",["T_WHITESPACE","\n                        ",610],["T_IF","if",611],"(","!",["T_ISSET","isset",611],"(",["T_VARIABLE","$attributes",611],"[",["T_VARIABLE","$attrId",611],"]",")",["T_WHITESPACE"," ",611],["T_BOOLEAN_OR","||",611],["T_WHITESPACE"," ",611],["T_EMPTY","empty",611],"(",["T_VARIABLE","$attributes",611],"[",["T_VARIABLE","$attrId",611],"]",")",")",["T_WHITESPACE"," ",611],"{",["T_WHITESPACE","\n                            ",611],["T_VARIABLE","$subProduct",612],["T_WHITESPACE"," ",612],"=",["T_WHITESPACE"," ",612],["T_STRING","null",612],";",["T_WHITESPACE","\n                            ",612],["T_BREAK","break",613],";",["T_WHITESPACE","\n                        ",613],"}",["T_WHITESPACE","\n                    ",614],"}",["T_WHITESPACE","\n                ",615],"}",["T_WHITESPACE","\n                ",616],["T_IF","if",617],"(",["T_WHITESPACE"," ",617],["T_VARIABLE","$subProduct",617],["T_WHITESPACE"," ",617],")",["T_WHITESPACE"," ",617],"{",["T_WHITESPACE","\n                    ",617],["T_VARIABLE","$subProduct",618],["T_WHITESPACE"," ",618],"=",["T_WHITESPACE"," ",618],["T_VARIABLE","$this",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getProductByAttributes",618],"(",["T_VARIABLE","$attributes",618],",",["T_WHITESPACE"," ",618],["T_VARIABLE","$product",618],")",";",["T_WHITESPACE","\n                ",618],"}",["T_WHITESPACE","\n\n                ",619],["T_IF","if",621],["T_WHITESPACE"," ",621],"(",["T_VARIABLE","$subProduct",621],")",["T_WHITESPACE"," ",621],"{",["T_WHITESPACE","\n                    ",621],["T_VARIABLE","$product",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","addCustomOption",622],"(",["T_CONSTANT_ENCAPSED_STRING","'attributes'",622],",",["T_WHITESPACE"," ",622],["T_STRING","serialize",622],"(",["T_VARIABLE","$attributes",622],")",")",";",["T_WHITESPACE","\n                    ",622],["T_VARIABLE","$product",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","addCustomOption",623],"(",["T_CONSTANT_ENCAPSED_STRING","'product_qty_'",623],".",["T_VARIABLE","$subProduct",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","getId",623],"(",")",",",["T_WHITESPACE"," ",623],["T_LNUMBER","1",623],",",["T_WHITESPACE"," ",623],["T_VARIABLE","$subProduct",623],")",";",["T_WHITESPACE","\n                    ",623],["T_VARIABLE","$product",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","addCustomOption",624],"(",["T_CONSTANT_ENCAPSED_STRING","'simple_product'",624],",",["T_WHITESPACE"," ",624],["T_VARIABLE","$subProduct",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getId",624],"(",")",",",["T_WHITESPACE"," ",624],["T_VARIABLE","$subProduct",624],")",";",["T_WHITESPACE","\n\n                    ",624],["T_VARIABLE","$_result",626],["T_WHITESPACE"," ",626],"=",["T_WHITESPACE"," ",626],["T_VARIABLE","$subProduct",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","getTypeInstance",626],"(",["T_STRING","true",626],")",["T_OBJECT_OPERATOR","->",626],["T_STRING","_prepareProduct",626],"(",["T_WHITESPACE","\n                        ",626],["T_VARIABLE","$buyRequest",627],",",["T_WHITESPACE","\n                        ",627],["T_VARIABLE","$subProduct",628],",",["T_WHITESPACE","\n                        ",628],["T_VARIABLE","$processMode",629],["T_WHITESPACE","\n                    ",629],")",";",["T_WHITESPACE","\n                    ",630],["T_IF","if",631],["T_WHITESPACE"," ",631],"(",["T_STRING","is_string",631],"(",["T_VARIABLE","$_result",631],")",["T_WHITESPACE"," ",631],["T_BOOLEAN_AND","&&",631],["T_WHITESPACE"," ",631],"!",["T_STRING","is_array",631],"(",["T_VARIABLE","$_result",631],")",")",["T_WHITESPACE"," ",631],"{",["T_WHITESPACE","\n                        ",631],["T_RETURN","return",632],["T_WHITESPACE"," ",632],["T_VARIABLE","$_result",632],";",["T_WHITESPACE","\n                    ",632],"}",["T_WHITESPACE","\n\n                    ",633],["T_IF","if",635],["T_WHITESPACE"," ",635],"(","!",["T_ISSET","isset",635],"(",["T_VARIABLE","$_result",635],"[",["T_LNUMBER","0",635],"]",")",")",["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n                        ",635],["T_RETURN","return",636],["T_WHITESPACE"," ",636],["T_STRING","Mage",636],["T_DOUBLE_COLON","::",636],["T_STRING","helper",636],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",636],")",["T_OBJECT_OPERATOR","->",636],["T_STRING","__",636],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot add the item to shopping cart'",636],")",";",["T_WHITESPACE","\n                    ",636],"}",["T_WHITESPACE","\n\n                    ",637],["T_DOC_COMMENT","\/**\n                     * Adding parent product custom options to child product\n                     * to be sure that it will be unique as its parent\n                     *\/",639],["T_WHITESPACE","\n                    ",642],["T_IF","if",643],["T_WHITESPACE"," ",643],"(",["T_VARIABLE","$optionIds",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_VARIABLE","$product",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","getCustomOption",643],"(",["T_CONSTANT_ENCAPSED_STRING","'option_ids'",643],")",")",["T_WHITESPACE"," ",643],"{",["T_WHITESPACE","\n                        ",643],["T_VARIABLE","$optionIds",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_STRING","explode",644],"(",["T_CONSTANT_ENCAPSED_STRING","','",644],",",["T_WHITESPACE"," ",644],["T_VARIABLE","$optionIds",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","getValue",644],"(",")",")",";",["T_WHITESPACE","\n                        ",644],["T_FOREACH","foreach",645],["T_WHITESPACE"," ",645],"(",["T_VARIABLE","$optionIds",645],["T_WHITESPACE"," ",645],["T_AS","as",645],["T_WHITESPACE"," ",645],["T_VARIABLE","$optionId",645],")",["T_WHITESPACE"," ",645],"{",["T_WHITESPACE","\n                            ",645],["T_IF","if",646],["T_WHITESPACE"," ",646],"(",["T_VARIABLE","$option",646],["T_WHITESPACE"," ",646],"=",["T_WHITESPACE"," ",646],["T_VARIABLE","$product",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","getCustomOption",646],"(",["T_CONSTANT_ENCAPSED_STRING","'option_'",646],["T_WHITESPACE"," ",646],".",["T_WHITESPACE"," ",646],["T_VARIABLE","$optionId",646],")",")",["T_WHITESPACE"," ",646],"{",["T_WHITESPACE","\n                                ",646],["T_VARIABLE","$_result",647],"[",["T_LNUMBER","0",647],"]",["T_OBJECT_OPERATOR","->",647],["T_STRING","addCustomOption",647],"(",["T_CONSTANT_ENCAPSED_STRING","'option_'",647],["T_WHITESPACE"," ",647],".",["T_WHITESPACE"," ",647],["T_VARIABLE","$optionId",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$option",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","getValue",647],"(",")",")",";",["T_WHITESPACE","\n                            ",647],"}",["T_WHITESPACE","\n                        ",648],"}",["T_WHITESPACE","\n                    ",649],"}",["T_WHITESPACE","\n\n                    ",650],["T_VARIABLE","$_result",652],"[",["T_LNUMBER","0",652],"]",["T_OBJECT_OPERATOR","->",652],["T_STRING","setParentProductId",652],"(",["T_VARIABLE","$product",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","getId",652],"(",")",")",["T_WHITESPACE","\n                        ",652],["T_COMMENT","\/\/ add custom option to simple product for protection of process\n",653],["T_WHITESPACE","                        ",654],["T_COMMENT","\/\/when we add simple product separately\n",654],["T_WHITESPACE","                        ",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","addCustomOption",655],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_product_id'",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$product",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","getId",655],"(",")",")",";",["T_WHITESPACE","\n                    ",655],["T_IF","if",656],["T_WHITESPACE"," ",656],"(",["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","_isStrictProcessMode",656],"(",["T_VARIABLE","$processMode",656],")",")",["T_WHITESPACE"," ",656],"{",["T_WHITESPACE","\n                        ",656],["T_VARIABLE","$_result",657],"[",["T_LNUMBER","0",657],"]",["T_OBJECT_OPERATOR","->",657],["T_STRING","setCartQty",657],"(",["T_LNUMBER","1",657],")",";",["T_WHITESPACE","\n                    ",657],"}",["T_WHITESPACE","\n                    ",658],["T_VARIABLE","$result",659],"[","]",["T_WHITESPACE"," ",659],"=",["T_WHITESPACE"," ",659],["T_VARIABLE","$_result",659],"[",["T_LNUMBER","0",659],"]",";",["T_WHITESPACE","\n                    ",659],["T_RETURN","return",660],["T_WHITESPACE"," ",660],["T_VARIABLE","$result",660],";",["T_WHITESPACE","\n                ",660],"}",["T_WHITESPACE"," ",661],["T_ELSE","else",661],["T_WHITESPACE"," ",661],["T_IF","if",661],["T_WHITESPACE"," ",661],"(","!",["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_isStrictProcessMode",661],"(",["T_VARIABLE","$processMode",661],")",")",["T_WHITESPACE"," ",661],"{",["T_WHITESPACE","\n                    ",661],["T_RETURN","return",662],["T_WHITESPACE"," ",662],["T_VARIABLE","$result",662],";",["T_WHITESPACE","\n                ",662],"}",["T_WHITESPACE","\n            ",663],"}",["T_WHITESPACE","\n        ",664],"}",["T_WHITESPACE","\n\n        ",665],["T_RETURN","return",667],["T_WHITESPACE"," ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","getSpecifyOptionMessage",667],"(",")",";",["T_WHITESPACE","\n    ",667],"}",["T_WHITESPACE","\n\n    ",668],["T_DOC_COMMENT","\/**\n     * Check if product can be bought\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Configurable\n     * @throws Mage_Core_Exception\n     *\/",670],["T_WHITESPACE","\n    ",676],["T_PUBLIC","public",677],["T_WHITESPACE"," ",677],["T_FUNCTION","function",677],["T_WHITESPACE"," ",677],["T_STRING","checkProductBuyState",677],"(",["T_VARIABLE","$product",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_STRING","null",677],")",["T_WHITESPACE","\n    ",677],"{",["T_WHITESPACE","\n        ",678],["T_STRING","parent",679],["T_DOUBLE_COLON","::",679],["T_STRING","checkProductBuyState",679],"(",["T_VARIABLE","$product",679],")",";",["T_WHITESPACE","\n        ",679],["T_VARIABLE","$product",680],["T_WHITESPACE"," ",680],"=",["T_WHITESPACE"," ",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","getProduct",680],"(",["T_VARIABLE","$product",680],")",";",["T_WHITESPACE","\n        ",680],["T_VARIABLE","$option",681],["T_WHITESPACE"," ",681],"=",["T_WHITESPACE"," ",681],["T_VARIABLE","$product",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","getCustomOption",681],"(",["T_CONSTANT_ENCAPSED_STRING","'info_buyRequest'",681],")",";",["T_WHITESPACE","\n        ",681],["T_IF","if",682],["T_WHITESPACE"," ",682],"(",["T_VARIABLE","$option",682],["T_WHITESPACE"," ",682],["T_INSTANCEOF","instanceof",682],["T_WHITESPACE"," ",682],["T_STRING","Mage_Sales_Model_Quote_Item_Option",682],")",["T_WHITESPACE"," ",682],"{",["T_WHITESPACE","\n            ",682],["T_VARIABLE","$buyRequest",683],["T_WHITESPACE"," ",683],"=",["T_WHITESPACE"," ",683],["T_NEW","new",683],["T_WHITESPACE"," ",683],["T_STRING","Varien_Object",683],"(",["T_STRING","unserialize",683],"(",["T_VARIABLE","$option",683],["T_OBJECT_OPERATOR","->",683],["T_STRING","getValue",683],"(",")",")",")",";",["T_WHITESPACE","\n            ",683],["T_VARIABLE","$attributes",684],["T_WHITESPACE"," ",684],"=",["T_WHITESPACE"," ",684],["T_VARIABLE","$buyRequest",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","getSuperAttribute",684],"(",")",";",["T_WHITESPACE","\n            ",684],["T_IF","if",685],["T_WHITESPACE"," ",685],"(",["T_STRING","is_array",685],"(",["T_VARIABLE","$attributes",685],")",")",["T_WHITESPACE"," ",685],"{",["T_WHITESPACE","\n                ",685],["T_FOREACH","foreach",686],["T_WHITESPACE"," ",686],"(",["T_VARIABLE","$attributes",686],["T_WHITESPACE"," ",686],["T_AS","as",686],["T_WHITESPACE"," ",686],["T_VARIABLE","$key",686],["T_WHITESPACE"," ",686],["T_DOUBLE_ARROW","=>",686],["T_WHITESPACE"," ",686],["T_VARIABLE","$val",686],")",["T_WHITESPACE"," ",686],"{",["T_WHITESPACE","\n                    ",686],["T_IF","if",687],["T_WHITESPACE"," ",687],"(",["T_EMPTY","empty",687],"(",["T_VARIABLE","$val",687],")",")",["T_WHITESPACE"," ",687],"{",["T_WHITESPACE","\n                        ",687],["T_UNSET","unset",688],"(",["T_VARIABLE","$attributes",688],"[",["T_VARIABLE","$key",688],"]",")",";",["T_WHITESPACE","\n                    ",688],"}",["T_WHITESPACE","\n                ",689],"}",["T_WHITESPACE","\n            ",690],"}",["T_WHITESPACE","\n            ",691],["T_IF","if",692],["T_WHITESPACE"," ",692],"(",["T_EMPTY","empty",692],"(",["T_VARIABLE","$attributes",692],")",")",["T_WHITESPACE"," ",692],"{",["T_WHITESPACE","\n                ",692],["T_STRING","Mage",693],["T_DOUBLE_COLON","::",693],["T_STRING","throwException",693],"(",["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","getSpecifyOptionMessage",693],"(",")",")",";",["T_WHITESPACE","\n            ",693],"}",["T_WHITESPACE","\n        ",694],"}",["T_WHITESPACE","\n        ",695],["T_RETURN","return",696],["T_WHITESPACE"," ",696],["T_VARIABLE","$this",696],";",["T_WHITESPACE","\n    ",696],"}",["T_WHITESPACE","\n\n    ",697],["T_DOC_COMMENT","\/**\n     * Retrieve message for specify option(s)\n     *\n     * @return string\n     *\/",699],["T_WHITESPACE","\n    ",703],["T_PUBLIC","public",704],["T_WHITESPACE"," ",704],["T_FUNCTION","function",704],["T_WHITESPACE"," ",704],["T_STRING","getSpecifyOptionMessage",704],"(",")",["T_WHITESPACE","\n    ",704],"{",["T_WHITESPACE","\n        ",705],["T_RETURN","return",706],["T_WHITESPACE"," ",706],["T_STRING","Mage",706],["T_DOUBLE_COLON","::",706],["T_STRING","helper",706],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",706],")",["T_OBJECT_OPERATOR","->",706],["T_STRING","__",706],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify the product\\'s option(s).'",706],")",";",["T_WHITESPACE","\n    ",706],"}",["T_WHITESPACE","\n\n    ",707],["T_DOC_COMMENT","\/**\n     * Prepare additional options\/information for order item which will be\n     * created from this product\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",709],["T_WHITESPACE","\n    ",715],["T_PUBLIC","public",716],["T_WHITESPACE"," ",716],["T_FUNCTION","function",716],["T_WHITESPACE"," ",716],["T_STRING","getOrderOptions",716],"(",["T_VARIABLE","$product",716],["T_WHITESPACE"," ",716],"=",["T_WHITESPACE"," ",716],["T_STRING","null",716],")",["T_WHITESPACE","\n    ",716],"{",["T_WHITESPACE","\n        ",717],["T_VARIABLE","$options",718],["T_WHITESPACE"," ",718],"=",["T_WHITESPACE"," ",718],["T_STRING","parent",718],["T_DOUBLE_COLON","::",718],["T_STRING","getOrderOptions",718],"(",["T_VARIABLE","$product",718],")",";",["T_WHITESPACE","\n        ",718],["T_VARIABLE","$options",719],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes_info'",719],"]",["T_WHITESPACE"," ",719],"=",["T_WHITESPACE"," ",719],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","getSelectedAttributesInfo",719],"(",["T_VARIABLE","$product",719],")",";",["T_WHITESPACE","\n        ",719],["T_IF","if",720],["T_WHITESPACE"," ",720],"(",["T_VARIABLE","$simpleOption",720],["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$this",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","getProduct",720],"(",["T_VARIABLE","$product",720],")",["T_OBJECT_OPERATOR","->",720],["T_STRING","getCustomOption",720],"(",["T_CONSTANT_ENCAPSED_STRING","'simple_product'",720],")",")",["T_WHITESPACE"," ",720],"{",["T_WHITESPACE","\n            ",720],["T_VARIABLE","$options",721],"[",["T_CONSTANT_ENCAPSED_STRING","'simple_name'",721],"]",["T_WHITESPACE"," ",721],"=",["T_WHITESPACE"," ",721],["T_VARIABLE","$simpleOption",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","getProduct",721],"(",["T_VARIABLE","$product",721],")",["T_OBJECT_OPERATOR","->",721],["T_STRING","getName",721],"(",")",";",["T_WHITESPACE","\n            ",721],["T_VARIABLE","$options",722],"[",["T_CONSTANT_ENCAPSED_STRING","'simple_sku'",722],"]",["T_WHITESPACE","  ",722],"=",["T_WHITESPACE"," ",722],["T_VARIABLE","$simpleOption",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","getProduct",722],"(",["T_VARIABLE","$product",722],")",["T_OBJECT_OPERATOR","->",722],["T_STRING","getSku",722],"(",")",";",["T_WHITESPACE","\n        ",722],"}",["T_WHITESPACE","\n\n        ",723],["T_VARIABLE","$options",725],"[",["T_CONSTANT_ENCAPSED_STRING","'product_calculations'",725],"]",["T_WHITESPACE"," ",725],"=",["T_WHITESPACE"," ",725],["T_STRING","self",725],["T_DOUBLE_COLON","::",725],["T_STRING","CALCULATE_PARENT",725],";",["T_WHITESPACE","\n        ",725],["T_VARIABLE","$options",726],"[",["T_CONSTANT_ENCAPSED_STRING","'shipment_type'",726],"]",["T_WHITESPACE"," ",726],"=",["T_WHITESPACE"," ",726],["T_STRING","self",726],["T_DOUBLE_COLON","::",726],["T_STRING","SHIPMENT_TOGETHER",726],";",["T_WHITESPACE","\n\n        ",726],["T_RETURN","return",728],["T_WHITESPACE"," ",728],["T_VARIABLE","$options",728],";",["T_WHITESPACE","\n    ",728],"}",["T_WHITESPACE","\n\n    ",729],["T_DOC_COMMENT","\/**\n     * Check is virtual product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",731],["T_WHITESPACE","\n    ",736],["T_PUBLIC","public",737],["T_WHITESPACE"," ",737],["T_FUNCTION","function",737],["T_WHITESPACE"," ",737],["T_STRING","isVirtual",737],"(",["T_VARIABLE","$product",737],["T_WHITESPACE"," ",737],"=",["T_WHITESPACE"," ",737],["T_STRING","null",737],")",["T_WHITESPACE","\n    ",737],"{",["T_WHITESPACE","\n        ",738],["T_IF","if",739],["T_WHITESPACE"," ",739],"(",["T_VARIABLE","$productOption",739],["T_WHITESPACE"," ",739],"=",["T_WHITESPACE"," ",739],["T_VARIABLE","$this",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","getProduct",739],"(",["T_VARIABLE","$product",739],")",["T_OBJECT_OPERATOR","->",739],["T_STRING","getCustomOption",739],"(",["T_CONSTANT_ENCAPSED_STRING","'simple_product'",739],")",")",["T_WHITESPACE"," ",739],"{",["T_WHITESPACE","\n            ",739],["T_IF","if",740],["T_WHITESPACE"," ",740],"(",["T_VARIABLE","$optionProduct",740],["T_WHITESPACE"," ",740],"=",["T_WHITESPACE"," ",740],["T_VARIABLE","$productOption",740],["T_OBJECT_OPERATOR","->",740],["T_STRING","getProduct",740],"(",")",")",["T_WHITESPACE"," ",740],"{",["T_WHITESPACE","\n                ",740],["T_COMMENT","\/* @var $optionProduct Mage_Catalog_Model_Product *\/",741],["T_WHITESPACE","\n                ",741],["T_RETURN","return",742],["T_WHITESPACE"," ",742],["T_VARIABLE","$optionProduct",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","isVirtual",742],"(",")",";",["T_WHITESPACE","\n            ",742],"}",["T_WHITESPACE","\n        ",743],"}",["T_WHITESPACE","\n        ",744],["T_RETURN","return",745],["T_WHITESPACE"," ",745],["T_STRING","parent",745],["T_DOUBLE_COLON","::",745],["T_STRING","isVirtual",745],"(",["T_VARIABLE","$product",745],")",";",["T_WHITESPACE","\n    ",745],"}",["T_WHITESPACE","\n\n    ",746],["T_DOC_COMMENT","\/**\n     * Return true if product has options\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",748],["T_WHITESPACE","\n    ",753],["T_PUBLIC","public",754],["T_WHITESPACE"," ",754],["T_FUNCTION","function",754],["T_WHITESPACE"," ",754],["T_STRING","hasOptions",754],"(",["T_VARIABLE","$product",754],["T_WHITESPACE"," ",754],"=",["T_WHITESPACE"," ",754],["T_STRING","null",754],")",["T_WHITESPACE","\n    ",754],"{",["T_WHITESPACE","\n        ",755],["T_IF","if",756],["T_WHITESPACE"," ",756],"(",["T_VARIABLE","$this",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","getProduct",756],"(",["T_VARIABLE","$product",756],")",["T_OBJECT_OPERATOR","->",756],["T_STRING","getOptions",756],"(",")",")",["T_WHITESPACE"," ",756],"{",["T_WHITESPACE","\n            ",756],["T_RETURN","return",757],["T_WHITESPACE"," ",757],["T_STRING","true",757],";",["T_WHITESPACE","\n        ",757],"}",["T_WHITESPACE","\n\n        ",758],["T_VARIABLE","$attributes",760],["T_WHITESPACE"," ",760],"=",["T_WHITESPACE"," ",760],["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","getConfigurableAttributes",760],"(",["T_VARIABLE","$product",760],")",";",["T_WHITESPACE","\n        ",760],["T_IF","if",761],["T_WHITESPACE"," ",761],"(",["T_STRING","count",761],"(",["T_VARIABLE","$attributes",761],")",")",["T_WHITESPACE"," ",761],"{",["T_WHITESPACE","\n            ",761],["T_FOREACH","foreach",762],["T_WHITESPACE"," ",762],"(",["T_VARIABLE","$attributes",762],["T_WHITESPACE"," ",762],["T_AS","as",762],["T_WHITESPACE"," ",762],["T_VARIABLE","$attribute",762],")",["T_WHITESPACE"," ",762],"{",["T_WHITESPACE","\n                ",762],["T_DOC_COMMENT","\/** @var Mage_Catalog_Model_Product_Type_Configurable_Attribute $attribute *\/",763],["T_WHITESPACE","\n                ",763],["T_IF","if",764],["T_WHITESPACE"," ",764],"(",["T_VARIABLE","$attribute",764],["T_OBJECT_OPERATOR","->",764],["T_STRING","getData",764],"(",["T_CONSTANT_ENCAPSED_STRING","'prices'",764],")",")",["T_WHITESPACE"," ",764],"{",["T_WHITESPACE","\n                    ",764],["T_RETURN","return",765],["T_WHITESPACE"," ",765],["T_STRING","true",765],";",["T_WHITESPACE","\n                ",765],"}",["T_WHITESPACE","\n            ",766],"}",["T_WHITESPACE","\n        ",767],"}",["T_WHITESPACE","\n\n        ",768],["T_RETURN","return",770],["T_WHITESPACE"," ",770],["T_STRING","false",770],";",["T_WHITESPACE","\n    ",770],"}",["T_WHITESPACE","\n\n    ",771],["T_DOC_COMMENT","\/**\n     * Return product weight based on simple product\n     * weight or configurable product weight\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return decimal\n     *\/",773],["T_WHITESPACE","\n    ",779],["T_PUBLIC","public",780],["T_WHITESPACE"," ",780],["T_FUNCTION","function",780],["T_WHITESPACE"," ",780],["T_STRING","getWeight",780],"(",["T_VARIABLE","$product",780],["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_STRING","null",780],")",["T_WHITESPACE","\n    ",780],"{",["T_WHITESPACE","\n        ",781],["T_IF","if",782],["T_WHITESPACE"," ",782],"(",["T_VARIABLE","$this",782],["T_OBJECT_OPERATOR","->",782],["T_STRING","getProduct",782],"(",["T_VARIABLE","$product",782],")",["T_OBJECT_OPERATOR","->",782],["T_STRING","hasCustomOptions",782],"(",")",["T_WHITESPACE"," ",782],["T_BOOLEAN_AND","&&",782],["T_WHITESPACE","\n            ",782],"(",["T_VARIABLE","$simpleProductOption",783],["T_WHITESPACE"," ",783],"=",["T_WHITESPACE"," ",783],["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","getProduct",783],"(",["T_VARIABLE","$product",783],")",["T_OBJECT_OPERATOR","->",783],["T_STRING","getCustomOption",783],"(",["T_CONSTANT_ENCAPSED_STRING","'simple_product'",783],")",")",["T_WHITESPACE","\n        ",783],")",["T_WHITESPACE"," ",784],"{",["T_WHITESPACE","\n            ",784],["T_VARIABLE","$simpleProduct",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_VARIABLE","$simpleProductOption",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","getProduct",785],"(",["T_VARIABLE","$product",785],")",";",["T_WHITESPACE","\n            ",785],["T_IF","if",786],["T_WHITESPACE"," ",786],"(",["T_VARIABLE","$simpleProduct",786],")",["T_WHITESPACE"," ",786],"{",["T_WHITESPACE","\n                ",786],["T_RETURN","return",787],["T_WHITESPACE"," ",787],["T_VARIABLE","$simpleProduct",787],["T_OBJECT_OPERATOR","->",787],["T_STRING","getWeight",787],"(",")",";",["T_WHITESPACE","\n            ",787],"}",["T_WHITESPACE","\n        ",788],"}",["T_WHITESPACE","\n\n        ",789],["T_RETURN","return",791],["T_WHITESPACE"," ",791],["T_VARIABLE","$this",791],["T_OBJECT_OPERATOR","->",791],["T_STRING","getProduct",791],"(",["T_VARIABLE","$product",791],")",["T_OBJECT_OPERATOR","->",791],["T_STRING","getData",791],"(",["T_CONSTANT_ENCAPSED_STRING","'weight'",791],")",";",["T_WHITESPACE","\n    ",791],"}",["T_WHITESPACE","\n\n    ",792],["T_DOC_COMMENT","\/**\n     * Implementation of product specify logic of which product needs to be assigned to option.\n     * For example if product which was added to option already removed from catalog.\n     *\n     * @param  Mage_Catalog_Model_Product|null $optionProduct\n     * @param  Mage_Sales_Model_Quote_Item_Option $option\n     * @param  Mage_Catalog_Model_Product|null $product\n     * @return Mage_Catalog_Model_Product_Type_Configurable\n     *\/",794],["T_WHITESPACE","\n    ",802],["T_PUBLIC","public",803],["T_WHITESPACE"," ",803],["T_FUNCTION","function",803],["T_WHITESPACE"," ",803],["T_STRING","assignProductToOption",803],"(",["T_VARIABLE","$optionProduct",803],",",["T_WHITESPACE"," ",803],["T_VARIABLE","$option",803],",",["T_WHITESPACE"," ",803],["T_VARIABLE","$product",803],["T_WHITESPACE"," ",803],"=",["T_WHITESPACE"," ",803],["T_STRING","null",803],")",["T_WHITESPACE","\n    ",803],"{",["T_WHITESPACE","\n        ",804],["T_IF","if",805],["T_WHITESPACE"," ",805],"(",["T_VARIABLE","$optionProduct",805],")",["T_WHITESPACE"," ",805],"{",["T_WHITESPACE","\n            ",805],["T_VARIABLE","$option",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","setProduct",806],"(",["T_VARIABLE","$optionProduct",806],")",";",["T_WHITESPACE","\n        ",806],"}",["T_WHITESPACE"," ",807],["T_ELSE","else",807],["T_WHITESPACE"," ",807],"{",["T_WHITESPACE","\n            ",807],["T_VARIABLE","$option",808],["T_OBJECT_OPERATOR","->",808],["T_STRING","getItem",808],"(",")",["T_OBJECT_OPERATOR","->",808],["T_STRING","setHasConfigurationUnavailableError",808],"(",["T_STRING","true",808],")",";",["T_WHITESPACE","\n        ",808],"}",["T_WHITESPACE","\n        ",809],["T_RETURN","return",810],["T_WHITESPACE"," ",810],["T_VARIABLE","$this",810],";",["T_WHITESPACE","\n    ",810],"}",["T_WHITESPACE","\n\n    ",811],["T_DOC_COMMENT","\/**\n     * Retrieve products divided into groups required to purchase\n     * At least one product in each group has to be purchased\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",813],["T_WHITESPACE","\n    ",819],["T_PUBLIC","public",820],["T_WHITESPACE"," ",820],["T_FUNCTION","function",820],["T_WHITESPACE"," ",820],["T_STRING","getProductsToPurchaseByReqGroups",820],"(",["T_VARIABLE","$product",820],["T_WHITESPACE"," ",820],"=",["T_WHITESPACE"," ",820],["T_STRING","null",820],")",["T_WHITESPACE","\n    ",820],"{",["T_WHITESPACE","\n        ",821],["T_VARIABLE","$product",822],["T_WHITESPACE"," ",822],"=",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","getProduct",822],"(",["T_VARIABLE","$product",822],")",";",["T_WHITESPACE","\n        ",822],["T_RETURN","return",823],["T_WHITESPACE"," ",823],["T_ARRAY","array",823],"(",["T_VARIABLE","$this",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","getUsedProducts",823],"(",["T_STRING","null",823],",",["T_WHITESPACE"," ",823],["T_VARIABLE","$product",823],")",")",";",["T_WHITESPACE","\n    ",823],"}",["T_WHITESPACE","\n\n    ",824],["T_DOC_COMMENT","\/**\n     * Get sku of product\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return string\n     *\/",826],["T_WHITESPACE","\n    ",831],["T_PUBLIC","public",832],["T_WHITESPACE"," ",832],["T_FUNCTION","function",832],["T_WHITESPACE"," ",832],["T_STRING","getSku",832],"(",["T_VARIABLE","$product",832],["T_WHITESPACE"," ",832],"=",["T_WHITESPACE"," ",832],["T_STRING","null",832],")",["T_WHITESPACE","\n    ",832],"{",["T_WHITESPACE","\n        ",833],["T_VARIABLE","$simpleOption",834],["T_WHITESPACE"," ",834],"=",["T_WHITESPACE"," ",834],["T_VARIABLE","$this",834],["T_OBJECT_OPERATOR","->",834],["T_STRING","getProduct",834],"(",["T_VARIABLE","$product",834],")",["T_OBJECT_OPERATOR","->",834],["T_STRING","getCustomOption",834],"(",["T_CONSTANT_ENCAPSED_STRING","'simple_product'",834],")",";",["T_WHITESPACE","\n        ",834],["T_IF","if",835],"(",["T_VARIABLE","$simpleOption",835],")",["T_WHITESPACE"," ",835],"{",["T_WHITESPACE","\n            ",835],["T_VARIABLE","$optionProduct",836],["T_WHITESPACE"," ",836],"=",["T_WHITESPACE"," ",836],["T_VARIABLE","$simpleOption",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","getProduct",836],"(",["T_VARIABLE","$product",836],")",";",["T_WHITESPACE","\n            ",836],["T_VARIABLE","$simpleSku",837],["T_WHITESPACE"," ",837],"=",["T_WHITESPACE"," ",837],["T_STRING","null",837],";",["T_WHITESPACE","\n            ",837],["T_IF","if",838],["T_WHITESPACE"," ",838],"(",["T_VARIABLE","$optionProduct",838],")",["T_WHITESPACE"," ",838],"{",["T_WHITESPACE","\n                ",838],["T_VARIABLE","$simpleSku",839],["T_WHITESPACE"," ",839],"=",["T_WHITESPACE","  ",839],["T_VARIABLE","$simpleOption",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","getProduct",839],"(",["T_VARIABLE","$product",839],")",["T_OBJECT_OPERATOR","->",839],["T_STRING","getSku",839],"(",")",";",["T_WHITESPACE","\n            ",839],"}",["T_WHITESPACE","\n            ",840],["T_VARIABLE","$sku",841],["T_WHITESPACE"," ",841],"=",["T_WHITESPACE"," ",841],["T_STRING","parent",841],["T_DOUBLE_COLON","::",841],["T_STRING","getOptionSku",841],"(",["T_VARIABLE","$product",841],",",["T_WHITESPACE"," ",841],["T_VARIABLE","$simpleSku",841],")",";",["T_WHITESPACE","\n        ",841],"}",["T_WHITESPACE"," ",842],["T_ELSE","else",842],["T_WHITESPACE"," ",842],"{",["T_WHITESPACE","\n            ",842],["T_VARIABLE","$sku",843],["T_WHITESPACE"," ",843],"=",["T_WHITESPACE"," ",843],["T_STRING","parent",843],["T_DOUBLE_COLON","::",843],["T_STRING","getSku",843],"(",["T_VARIABLE","$product",843],")",";",["T_WHITESPACE","\n        ",843],"}",["T_WHITESPACE","\n\n        ",844],["T_RETURN","return",846],["T_WHITESPACE"," ",846],["T_VARIABLE","$sku",846],";",["T_WHITESPACE","\n    ",846],"}",["T_WHITESPACE","\n\n    ",847],["T_DOC_COMMENT","\/**\n     * Prepare selected options for configurable product\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @param  Varien_Object $buyRequest\n     * @return array\n     *\/",849],["T_WHITESPACE","\n    ",855],["T_PUBLIC","public",856],["T_WHITESPACE"," ",856],["T_FUNCTION","function",856],["T_WHITESPACE"," ",856],["T_STRING","processBuyRequest",856],"(",["T_VARIABLE","$product",856],",",["T_WHITESPACE"," ",856],["T_VARIABLE","$buyRequest",856],")",["T_WHITESPACE","\n    ",856],"{",["T_WHITESPACE","\n        ",857],["T_VARIABLE","$superAttribute",858],["T_WHITESPACE"," ",858],"=",["T_WHITESPACE"," ",858],["T_VARIABLE","$buyRequest",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","getSuperAttribute",858],"(",")",";",["T_WHITESPACE","\n        ",858],["T_VARIABLE","$superAttribute",859],["T_WHITESPACE"," ",859],"=",["T_WHITESPACE"," ",859],"(",["T_STRING","is_array",859],"(",["T_VARIABLE","$superAttribute",859],")",")",["T_WHITESPACE"," ",859],"?",["T_WHITESPACE"," ",859],["T_STRING","array_filter",859],"(",["T_VARIABLE","$superAttribute",859],",",["T_WHITESPACE"," ",859],["T_CONSTANT_ENCAPSED_STRING","'intval'",859],")",["T_WHITESPACE"," ",859],":",["T_WHITESPACE"," ",859],["T_ARRAY","array",859],"(",")",";",["T_WHITESPACE","\n\n        ",859],["T_VARIABLE","$options",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_ARRAY","array",861],"(",["T_CONSTANT_ENCAPSED_STRING","'super_attribute'",861],["T_WHITESPACE"," ",861],["T_DOUBLE_ARROW","=>",861],["T_WHITESPACE"," ",861],["T_VARIABLE","$superAttribute",861],")",";",["T_WHITESPACE","\n\n        ",861],["T_RETURN","return",863],["T_WHITESPACE"," ",863],["T_VARIABLE","$options",863],";",["T_WHITESPACE","\n    ",863],"}",["T_WHITESPACE","\n\n    ",864],["T_DOC_COMMENT","\/**\n     * Check if Minimum Advertise Price is enabled at least in one option\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param int $visibility\n     * @return bool|null\n     *\/",866],["T_WHITESPACE","\n    ",872],["T_PUBLIC","public",873],["T_WHITESPACE"," ",873],["T_FUNCTION","function",873],["T_WHITESPACE"," ",873],["T_STRING","isMapEnabledInOptions",873],"(",["T_VARIABLE","$product",873],",",["T_WHITESPACE"," ",873],["T_VARIABLE","$visibility",873],["T_WHITESPACE"," ",873],"=",["T_WHITESPACE"," ",873],["T_STRING","null",873],")",["T_WHITESPACE","\n    ",873],"{",["T_WHITESPACE","\n        ",874],["T_RETURN","return",875],["T_WHITESPACE"," ",875],["T_STRING","null",875],";",["T_WHITESPACE","\n    ",875],"}",["T_WHITESPACE","\n\n    ",876],["T_DOC_COMMENT","\/**\n     * Prepare and retrieve options values with product data\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",878],["T_WHITESPACE","\n    ",883],["T_PUBLIC","public",884],["T_WHITESPACE"," ",884],["T_FUNCTION","function",884],["T_WHITESPACE"," ",884],["T_STRING","getConfigurableOptions",884],"(",["T_VARIABLE","$product",884],")",["T_WHITESPACE","\n    ",884],"{",["T_WHITESPACE","\n        ",885],["T_RETURN","return",886],["T_WHITESPACE"," ",886],["T_STRING","Mage",886],["T_DOUBLE_COLON","::",886],["T_STRING","getResourceSingleton",886],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type_configurable'",886],")",["T_WHITESPACE","\n            ",886],["T_OBJECT_OPERATOR","->",887],["T_STRING","getConfigurableOptions",887],"(",["T_VARIABLE","$product",887],",",["T_WHITESPACE"," ",887],["T_VARIABLE","$this",887],["T_OBJECT_OPERATOR","->",887],["T_STRING","getUsedProductAttributes",887],"(",["T_VARIABLE","$product",887],")",")",";",["T_WHITESPACE","\n    ",887],"}",["T_WHITESPACE","\n",888],"}",["T_WHITESPACE","\n",889]]