[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Layer price filter\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n\n",33],["T_DOC_COMMENT","\/**\n * @method Mage_Catalog_Model_Layer_Filter_Price setInterval(array)\n * @method array getInterval()\n *\/",35],["T_WHITESPACE","\n",38],["T_CLASS","class",39],["T_WHITESPACE"," ",39],["T_STRING","Mage_Catalog_Model_Layer_Filter_Price",39],["T_WHITESPACE"," ",39],["T_EXTENDS","extends",39],["T_WHITESPACE"," ",39],["T_STRING","Mage_Catalog_Model_Layer_Filter_Abstract",39],["T_WHITESPACE","\n",39],"{",["T_WHITESPACE","\n    ",40],["T_DOC_COMMENT","\/**\n     * XML configuration paths for Price Layered Navigation\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","XML_PATH_RANGE_CALCULATION",44],["T_WHITESPACE","       ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'catalog\/layered_navigation\/price_range_calculation'",44],";",["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","XML_PATH_RANGE_STEP",45],["T_WHITESPACE","              ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'catalog\/layered_navigation\/price_range_step'",45],";",["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","XML_PATH_RANGE_MAX_INTERVALS",46],["T_WHITESPACE","     ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'catalog\/layered_navigation\/price_range_max_intervals'",46],";",["T_WHITESPACE","\n    ",46],["T_CONST","const",47],["T_WHITESPACE"," ",47],["T_STRING","XML_PATH_ONE_PRICE_INTERVAL",47],["T_WHITESPACE","      ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'catalog\/layered_navigation\/one_price_interval'",47],";",["T_WHITESPACE","\n    ",47],["T_CONST","const",48],["T_WHITESPACE"," ",48],["T_STRING","XML_PATH_INTERVAL_DIVISION_LIMIT",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'catalog\/layered_navigation\/interval_division_limit'",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Price layered navigation modes: Automatic (equalize price ranges), Automatic (equalize product counts), Manual\n     *\/",50],["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","RANGE_CALCULATION_AUTO",53],["T_WHITESPACE","     ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'auto'",53],";",["T_WHITESPACE"," ",53],["T_COMMENT","\/\/ equalize price ranges\n",53],["T_WHITESPACE","    ",54],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","RANGE_CALCULATION_IMPROVED",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'improved'",54],";",["T_WHITESPACE"," ",54],["T_COMMENT","\/\/ equalize product counts\n",54],["T_WHITESPACE","    ",55],["T_CONST","const",55],["T_WHITESPACE"," ",55],["T_STRING","RANGE_CALCULATION_MANUAL",55],["T_WHITESPACE","   ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'manual'",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Minimal size of the range\n     *\/",57],["T_WHITESPACE","\n    ",59],["T_CONST","const",60],["T_WHITESPACE"," ",60],["T_STRING","MIN_RANGE_POWER",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_LNUMBER","10",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Resource instance\n     *\n     * @var Mage_Catalog_Model_Resource_Eav_Mysql4_Layer_Filter_Price\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_resource",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Class constructor\n     *\n     *\/",69],["T_WHITESPACE","\n    ",72],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","__construct",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_STRING","parent",75],["T_DOUBLE_COLON","::",75],["T_STRING","__construct",75],"(",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_requestVar",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'price'",76],";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Retrieve resource instance\n     *\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Layer_Filter_Price\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","_getResource",84],"(",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_STRING","is_null",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_resource",86],")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_resource",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","getResourceModel",87],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/layer_filter_price'",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n        ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_resource",89],";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Get price range for building filter steps\n     *\n     * @return int\n     *\/",92],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","getPriceRange",97],"(",")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$range",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getData",99],"(",["T_CONSTANT_ENCAPSED_STRING","'price_range'",99],")",";",["T_WHITESPACE","\n        ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","!",["T_VARIABLE","$range",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$currentCategory",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_STRING","Mage",101],["T_DOUBLE_COLON","::",101],["T_STRING","registry",101],"(",["T_CONSTANT_ENCAPSED_STRING","'current_category_filter'",101],")",";",["T_WHITESPACE","\n            ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$currentCategory",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$range",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$currentCategory",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getFilterPriceRange",103],"(",")",";",["T_WHITESPACE","\n            ",103],"}",["T_WHITESPACE"," ",104],["T_ELSE","else",104],["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                ",104],["T_VARIABLE","$range",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getLayer",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getCurrentCategory",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getFilterPriceRange",105],"(",")",";",["T_WHITESPACE","\n            ",105],"}",["T_WHITESPACE","\n\n            ",106],["T_VARIABLE","$maxPrice",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getMaxPriceInt",108],"(",")",";",["T_WHITESPACE","\n            ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_VARIABLE","$range",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$calculation",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","Mage",110],["T_DOUBLE_COLON","::",110],["T_STRING","app",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","getStore",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","getConfig",110],"(",["T_STRING","self",110],["T_DOUBLE_COLON","::",110],["T_STRING","XML_PATH_RANGE_CALCULATION",110],")",";",["T_WHITESPACE","\n                ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$calculation",111],["T_WHITESPACE"," ",111],["T_IS_EQUAL","==",111],["T_WHITESPACE"," ",111],["T_STRING","self",111],["T_DOUBLE_COLON","::",111],["T_STRING","RANGE_CALCULATION_AUTO",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n                    ",111],["T_VARIABLE","$index",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_LNUMBER","1",112],";",["T_WHITESPACE","\n                    ",112],["T_DO","do",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                        ",113],["T_VARIABLE","$range",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","pow",114],"(",["T_LNUMBER","10",114],",",["T_WHITESPACE"," ",114],"(",["T_STRING","strlen",114],"(",["T_STRING","floor",114],"(",["T_VARIABLE","$maxPrice",114],")",")",["T_WHITESPACE"," ",114],"-",["T_WHITESPACE"," ",114],["T_VARIABLE","$index",114],")",")",";",["T_WHITESPACE","\n                        ",114],["T_VARIABLE","$items",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getRangeItemCounts",115],"(",["T_VARIABLE","$range",115],")",";",["T_WHITESPACE","\n                        ",115],["T_VARIABLE","$index",116],["T_INC","++",116],";",["T_WHITESPACE","\n                    ",116],"}",["T_WHITESPACE","\n                    ",117],["T_WHILE","while",118],"(",["T_VARIABLE","$range",118],["T_WHITESPACE"," ",118],">",["T_WHITESPACE"," ",118],["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_STRING","MIN_RANGE_POWER",118],["T_WHITESPACE"," ",118],["T_BOOLEAN_AND","&&",118],["T_WHITESPACE"," ",118],["T_STRING","count",118],"(",["T_VARIABLE","$items",118],")",["T_WHITESPACE"," ",118],"<",["T_WHITESPACE"," ",118],["T_LNUMBER","2",118],")",";",["T_WHITESPACE","\n                ",118],"}",["T_WHITESPACE"," ",119],["T_ELSE","else",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                    ",119],["T_VARIABLE","$range",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_DOUBLE_CAST","(float)",120],["T_STRING","Mage",120],["T_DOUBLE_COLON","::",120],["T_STRING","app",120],"(",")",["T_OBJECT_OPERATOR","->",120],["T_STRING","getStore",120],"(",")",["T_OBJECT_OPERATOR","->",120],["T_STRING","getConfig",120],"(",["T_STRING","self",120],["T_DOUBLE_COLON","::",120],["T_STRING","XML_PATH_RANGE_STEP",120],")",";",["T_WHITESPACE","\n                ",120],"}",["T_WHITESPACE","\n            ",121],"}",["T_WHITESPACE","\n\n            ",122],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","setData",124],"(",["T_CONSTANT_ENCAPSED_STRING","'price_range'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$range",124],")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n\n        ",125],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$range",127],";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_DOC_COMMENT","\/**\n     * Get maximum price from layer products set\n     *\n     * @return float\n     *\/",130],["T_WHITESPACE","\n    ",134],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","getMaxPriceInt",135],"(",")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$maxPrice",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getData",137],"(",["T_CONSTANT_ENCAPSED_STRING","'max_price_int'",137],")",";",["T_WHITESPACE","\n        ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_STRING","is_null",138],"(",["T_VARIABLE","$maxPrice",138],")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$maxPrice",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getLayer",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getProductCollection",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getMaxPrice",139],"(",")",";",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$maxPrice",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","floor",140],"(",["T_VARIABLE","$maxPrice",140],")",";",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","setData",141],"(",["T_CONSTANT_ENCAPSED_STRING","'max_price_int'",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$maxPrice",141],")",";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n\n        ",142],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$maxPrice",144],";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Get information about products count in range\n     *\n     * @param   int $range\n     * @return  int\n     *\/",147],["T_WHITESPACE","\n    ",152],["T_PUBLIC","public",153],["T_WHITESPACE"," ",153],["T_FUNCTION","function",153],["T_WHITESPACE"," ",153],["T_STRING","getRangeItemCounts",153],"(",["T_VARIABLE","$range",153],")",["T_WHITESPACE","\n    ",153],"{",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$rangeKey",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'range_item_counts_'",155],["T_WHITESPACE"," ",155],".",["T_WHITESPACE"," ",155],["T_VARIABLE","$range",155],";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$items",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getData",156],"(",["T_VARIABLE","$rangeKey",156],")",";",["T_WHITESPACE","\n        ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_STRING","is_null",157],"(",["T_VARIABLE","$items",157],")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$items",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_getResource",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getCount",158],"(",["T_VARIABLE","$this",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$range",158],")",";",["T_WHITESPACE","\n            ",158],["T_COMMENT","\/\/ checking max number of intervals\n",159],["T_WHITESPACE","            ",160],["T_VARIABLE","$i",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_LNUMBER","0",160],";",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$lastIndex",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","null",161],";",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$maxIntervalsNumber",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getMaxIntervalsNumber",162],"(",")",";",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$calculation",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","Mage",163],["T_DOUBLE_COLON","::",163],["T_STRING","app",163],"(",")",["T_OBJECT_OPERATOR","->",163],["T_STRING","getStore",163],"(",")",["T_OBJECT_OPERATOR","->",163],["T_STRING","getConfig",163],"(",["T_STRING","self",163],["T_DOUBLE_COLON","::",163],["T_STRING","XML_PATH_RANGE_CALCULATION",163],")",";",["T_WHITESPACE","\n            ",163],["T_FOREACH","foreach",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$items",164],["T_WHITESPACE"," ",164],["T_AS","as",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$k",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$v",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n                ",164],["T_INC","++",165],["T_VARIABLE","$i",165],";",["T_WHITESPACE","\n                ",165],["T_IF","if",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$calculation",166],["T_WHITESPACE"," ",166],["T_IS_EQUAL","==",166],["T_WHITESPACE"," ",166],["T_STRING","self",166],["T_DOUBLE_COLON","::",166],["T_STRING","RANGE_CALCULATION_MANUAL",166],["T_WHITESPACE"," ",166],["T_BOOLEAN_AND","&&",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$i",166],["T_WHITESPACE"," ",166],">",["T_WHITESPACE"," ",166],["T_LNUMBER","1",166],["T_WHITESPACE"," ",166],["T_BOOLEAN_AND","&&",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$i",166],["T_WHITESPACE"," ",166],">",["T_WHITESPACE"," ",166],["T_VARIABLE","$maxIntervalsNumber",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                    ",166],["T_VARIABLE","$items",167],"[",["T_VARIABLE","$lastIndex",167],"]",["T_WHITESPACE"," ",167],["T_PLUS_EQUAL","+=",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$v",167],";",["T_WHITESPACE","\n                    ",167],["T_UNSET","unset",168],"(",["T_VARIABLE","$items",168],"[",["T_VARIABLE","$k",168],"]",")",";",["T_WHITESPACE","\n                ",168],"}",["T_WHITESPACE"," ",169],["T_ELSE","else",169],["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n                    ",169],["T_VARIABLE","$lastIndex",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$k",170],";",["T_WHITESPACE","\n                ",170],"}",["T_WHITESPACE","\n            ",171],"}",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","setData",173],"(",["T_VARIABLE","$rangeKey",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$items",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n\n        ",174],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$items",176],";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Prepare text of item label\n     *\n     * @deprecated since 1.7.0.0\n     * @param   int $range\n     * @param   float $value\n     * @return  string\n     *\/",179],["T_WHITESPACE","\n    ",186],["T_PROTECTED","protected",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","_renderItemLabel",187],"(",["T_VARIABLE","$range",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$value",187],")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$store",189],["T_WHITESPACE","      ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","Mage",189],["T_DOUBLE_COLON","::",189],["T_STRING","app",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","getStore",189],"(",")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$fromPrice",190],["T_WHITESPACE","  ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$store",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","formatPrice",190],"(","(",["T_VARIABLE","$value",190],["T_WHITESPACE"," ",190],"-",["T_WHITESPACE"," ",190],["T_LNUMBER","1",190],")",["T_WHITESPACE"," ",190],"*",["T_WHITESPACE"," ",190],["T_VARIABLE","$range",190],")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$toPrice",191],["T_WHITESPACE","    ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$store",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","formatPrice",191],"(",["T_VARIABLE","$value",191],"*",["T_VARIABLE","$range",191],")",";",["T_WHITESPACE","\n\n        ",191],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_STRING","Mage",193],["T_DOUBLE_COLON","::",193],["T_STRING","helper",193],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",193],")",["T_OBJECT_OPERATOR","->",193],["T_STRING","__",193],"(",["T_CONSTANT_ENCAPSED_STRING","'%s - %s'",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$fromPrice",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$toPrice",193],")",";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Prepare text of range label\n     *\n     * @param float|string $fromPrice\n     * @param float|string $toPrice\n     * @return string\n     *\/",196],["T_WHITESPACE","\n    ",202],["T_PROTECTED","protected",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","_renderRangeLabel",203],"(",["T_VARIABLE","$fromPrice",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$toPrice",203],")",["T_WHITESPACE","\n    ",203],"{",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$store",205],["T_WHITESPACE","      ",205],"=",["T_WHITESPACE"," ",205],["T_STRING","Mage",205],["T_DOUBLE_COLON","::",205],["T_STRING","app",205],"(",")",["T_OBJECT_OPERATOR","->",205],["T_STRING","getStore",205],"(",")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$formattedFromPrice",206],["T_WHITESPACE","  ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$store",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","formatPrice",206],"(",["T_VARIABLE","$fromPrice",206],")",";",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$toPrice",207],["T_WHITESPACE"," ",207],["T_IS_IDENTICAL","===",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","''",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_STRING","Mage",208],["T_DOUBLE_COLON","::",208],["T_STRING","helper",208],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",208],")",["T_OBJECT_OPERATOR","->",208],["T_STRING","__",208],"(",["T_CONSTANT_ENCAPSED_STRING","'%s and above'",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$formattedFromPrice",208],")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE"," ",209],["T_ELSEIF","elseif",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$fromPrice",209],["T_WHITESPACE"," ",209],["T_IS_EQUAL","==",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$toPrice",209],["T_WHITESPACE"," ",209],["T_BOOLEAN_AND","&&",209],["T_WHITESPACE"," ",209],["T_STRING","Mage",209],["T_DOUBLE_COLON","::",209],["T_STRING","app",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","getStore",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","getConfig",209],"(",["T_STRING","self",209],["T_DOUBLE_COLON","::",209],["T_STRING","XML_PATH_ONE_PRICE_INTERVAL",209],")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$formattedFromPrice",210],";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE"," ",211],["T_ELSE","else",211],["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n            ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$fromPrice",212],["T_WHITESPACE"," ",212],["T_IS_NOT_EQUAL","!=",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$toPrice",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n                ",212],["T_VARIABLE","$toPrice",213],["T_WHITESPACE"," ",213],["T_MINUS_EQUAL","-=",213],["T_WHITESPACE"," ",213],["T_DNUMBER",".01",213],";",["T_WHITESPACE","\n            ",213],"}",["T_WHITESPACE","\n            ",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_STRING","Mage",215],["T_DOUBLE_COLON","::",215],["T_STRING","helper",215],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",215],")",["T_OBJECT_OPERATOR","->",215],["T_STRING","__",215],"(",["T_CONSTANT_ENCAPSED_STRING","'%s - %s'",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$formattedFromPrice",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$store",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","formatPrice",215],"(",["T_VARIABLE","$toPrice",215],")",")",";",["T_WHITESPACE","\n        ",215],"}",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n\n    ",217],["T_DOC_COMMENT","\/**\n     * Get price aggreagation data cache key\n     * @deprecated after 1.4\n     * @return string\n     *\/",219],["T_WHITESPACE","\n    ",223],["T_PROTECTED","protected",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","_getCacheKey",224],"(",")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$key",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getLayer",226],"(",")",["T_OBJECT_OPERATOR","->",226],["T_STRING","getStateKey",226],"(",")",["T_WHITESPACE","\n            ",226],".",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'_PRICES_GRP_'",227],["T_WHITESPACE"," ",227],".",["T_WHITESPACE"," ",227],["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","getSingleton",227],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",227],")",["T_OBJECT_OPERATOR","->",227],["T_STRING","getCustomerGroupId",227],"(",")",["T_WHITESPACE","\n            ",227],".",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'_CURR_'",228],["T_WHITESPACE"," ",228],".",["T_WHITESPACE"," ",228],["T_STRING","Mage",228],["T_DOUBLE_COLON","::",228],["T_STRING","app",228],"(",")",["T_OBJECT_OPERATOR","->",228],["T_STRING","getStore",228],"(",")",["T_OBJECT_OPERATOR","->",228],["T_STRING","getCurrentCurrencyCode",228],"(",")",["T_WHITESPACE","\n            ",228],".",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'_ATTR_'",229],["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getAttributeModel",229],"(",")",["T_OBJECT_OPERATOR","->",229],["T_STRING","getAttributeCode",229],"(",")",["T_WHITESPACE","\n            ",229],".",["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'_LOC_'",230],["T_WHITESPACE","\n            ",230],";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$taxReq",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_STRING","Mage",232],["T_DOUBLE_COLON","::",232],["T_STRING","getSingleton",232],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",232],")",["T_OBJECT_OPERATOR","->",232],["T_STRING","getDefaultRateRequest",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$key",233],["T_CONCAT_EQUAL",".=",233],["T_WHITESPACE"," ",233],["T_STRING","implode",233],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$taxReq",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getData",233],"(",")",")",";",["T_WHITESPACE","\n\n        ",233],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$key",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Get additional request param data\n     *\n     * @return string\n     *\/",238],["T_WHITESPACE","\n    ",242],["T_PROTECTED","protected",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","_getAdditionalRequestData",243],"(",")",["T_WHITESPACE","\n    ",243],"{",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$result",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","''",245],";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$appliedInterval",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getInterval",246],"(",")",";",["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$appliedInterval",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$result",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","','",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$appliedInterval",248],"[",["T_LNUMBER","0",248],"]",["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'-'",248],["T_WHITESPACE"," ",248],".",["T_WHITESPACE"," ",248],["T_VARIABLE","$appliedInterval",248],"[",["T_LNUMBER","1",248],"]",";",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$priorIntervals",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getResetValue",249],"(",")",";",["T_WHITESPACE","\n            ",249],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$priorIntervals",250],")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                ",250],["T_VARIABLE","$result",251],["T_WHITESPACE"," ",251],["T_CONCAT_EQUAL",".=",251],["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","','",251],["T_WHITESPACE"," ",251],".",["T_WHITESPACE"," ",251],["T_VARIABLE","$priorIntervals",251],";",["T_WHITESPACE","\n            ",251],"}",["T_WHITESPACE","\n        ",252],"}",["T_WHITESPACE","\n\n        ",253],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$result",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * Get data generated by algorithm for build price filter items\n     *\n     * @return array\n     *\/",258],["T_WHITESPACE","\n    ",262],["T_PROTECTED","protected",263],["T_WHITESPACE"," ",263],["T_FUNCTION","function",263],["T_WHITESPACE"," ",263],["T_STRING","_getCalculatedItemsData",263],"(",")",["T_WHITESPACE","\n    ",263],"{",["T_WHITESPACE","\n        ",264],["T_DOC_COMMENT","\/** @var $algorithmModel Mage_Catalog_Model_Layer_Filter_Price_Algorithm *\/",265],["T_WHITESPACE","\n        ",265],["T_VARIABLE","$algorithmModel",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_STRING","Mage",266],["T_DOUBLE_COLON","::",266],["T_STRING","getSingleton",266],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/layer_filter_price_algorithm'",266],")",";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$collection",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getLayer",267],"(",")",["T_OBJECT_OPERATOR","->",267],["T_STRING","getProductCollection",267],"(",")",";",["T_WHITESPACE","\n        ",267],["T_VARIABLE","$appliedInterval",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","getInterval",268],"(",")",";",["T_WHITESPACE","\n        ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$appliedInterval",269],["T_WHITESPACE","\n            ",269],["T_BOOLEAN_AND","&&",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$collection",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getPricesCount",270],"(",")",["T_WHITESPACE"," ",270],["T_IS_SMALLER_OR_EQUAL","<=",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getIntervalDivisionLimit",270],"(",")",["T_WHITESPACE","\n        ",270],")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_RETURN","return",272],["T_WHITESPACE"," ",272],["T_ARRAY","array",272],"(",")",";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$algorithmModel",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","setPricesModel",274],"(",["T_VARIABLE","$this",274],")",["T_OBJECT_OPERATOR","->",274],["T_STRING","setStatistics",274],"(",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$collection",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getMinPrice",275],"(",")",",",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$collection",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getMaxPrice",276],"(",")",",",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$collection",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getPriceStandardDeviation",277],"(",")",",",["T_WHITESPACE","\n            ",277],["T_VARIABLE","$collection",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getPricesCount",278],"(",")",["T_WHITESPACE","\n        ",278],")",";",["T_WHITESPACE","\n\n        ",279],["T_IF","if",281],["T_WHITESPACE"," ",281],"(",["T_VARIABLE","$appliedInterval",281],")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n            ",281],["T_IF","if",282],["T_WHITESPACE"," ",282],"(",["T_VARIABLE","$appliedInterval",282],"[",["T_LNUMBER","0",282],"]",["T_WHITESPACE"," ",282],["T_IS_EQUAL","==",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$appliedInterval",282],"[",["T_LNUMBER","1",282],"]",["T_WHITESPACE"," ",282],["T_BOOLEAN_OR","||",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$appliedInterval",282],"[",["T_LNUMBER","1",282],"]",["T_WHITESPACE"," ",282],["T_IS_IDENTICAL","===",282],["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","'0'",282],")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n                ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_ARRAY","array",283],"(",")",";",["T_WHITESPACE","\n            ",283],"}",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$algorithmModel",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","setLimits",285],"(",["T_VARIABLE","$appliedInterval",285],"[",["T_LNUMBER","0",285],"]",",",["T_WHITESPACE"," ",285],["T_VARIABLE","$appliedInterval",285],"[",["T_LNUMBER","1",285],"]",")",";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n\n        ",286],["T_VARIABLE","$items",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_ARRAY","array",288],"(",")",";",["T_WHITESPACE","\n        ",288],["T_FOREACH","foreach",289],["T_WHITESPACE"," ",289],"(",["T_VARIABLE","$algorithmModel",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","calculateSeparators",289],"(",")",["T_WHITESPACE"," ",289],["T_AS","as",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$separator",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$items",290],"[","]",["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_ARRAY","array",290],"(",["T_WHITESPACE","\n                ",290],["T_CONSTANT_ENCAPSED_STRING","'label'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_renderRangeLabel",291],"(",["T_VARIABLE","$separator",291],"[",["T_CONSTANT_ENCAPSED_STRING","'from'",291],"]",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$separator",291],"[",["T_CONSTANT_ENCAPSED_STRING","'to'",291],"]",")",",",["T_WHITESPACE","\n                ",291],["T_CONSTANT_ENCAPSED_STRING","'value'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],"(","(",["T_VARIABLE","$separator",292],"[",["T_CONSTANT_ENCAPSED_STRING","'from'",292],"]",["T_WHITESPACE"," ",292],["T_IS_EQUAL","==",292],["T_WHITESPACE"," ",292],["T_LNUMBER","0",292],")",["T_WHITESPACE"," ",292],"?",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","''",292],["T_WHITESPACE"," ",292],":",["T_WHITESPACE"," ",292],["T_VARIABLE","$separator",292],"[",["T_CONSTANT_ENCAPSED_STRING","'from'",292],"]",")",["T_WHITESPACE","\n                    ",292],".",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'-'",293],["T_WHITESPACE"," ",293],".",["T_WHITESPACE"," ",293],["T_VARIABLE","$separator",293],"[",["T_CONSTANT_ENCAPSED_STRING","'to'",293],"]",["T_WHITESPACE"," ",293],".",["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_getAdditionalRequestData",293],"(",")",",",["T_WHITESPACE","\n                ",293],["T_CONSTANT_ENCAPSED_STRING","'count'",294],["T_WHITESPACE"," ",294],["T_DOUBLE_ARROW","=>",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$separator",294],"[",["T_CONSTANT_ENCAPSED_STRING","'count'",294],"]",",",["T_WHITESPACE","\n            ",294],")",";",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n\n        ",296],["T_RETURN","return",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$items",298],";",["T_WHITESPACE","\n    ",298],"}",["T_WHITESPACE","\n\n    ",299],["T_DOC_COMMENT","\/**\n     * Get data for build price filter items\n     *\n     * @return array\n     *\/",301],["T_WHITESPACE","\n    ",305],["T_PROTECTED","protected",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","_getItemsData",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_STRING","Mage",308],["T_DOUBLE_COLON","::",308],["T_STRING","app",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getStore",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getConfig",308],"(",["T_STRING","self",308],["T_DOUBLE_COLON","::",308],["T_STRING","XML_PATH_RANGE_CALCULATION",308],")",["T_WHITESPACE"," ",308],["T_IS_EQUAL","==",308],["T_WHITESPACE"," ",308],["T_STRING","self",308],["T_DOUBLE_COLON","::",308],["T_STRING","RANGE_CALCULATION_IMPROVED",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_getCalculatedItemsData",309],"(",")",";",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE"," ",310],["T_ELSEIF","elseif",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getInterval",310],"(",")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n            ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_ARRAY","array",311],"(",")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE","\n\n        ",312],["T_VARIABLE","$range",314],["T_WHITESPACE","      ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getPriceRange",314],"(",")",";",["T_WHITESPACE","\n        ",314],["T_VARIABLE","$dbRanges",315],["T_WHITESPACE","   ",315],"=",["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getRangeItemCounts",315],"(",["T_VARIABLE","$range",315],")",";",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$data",316],["T_WHITESPACE","       ",316],"=",["T_WHITESPACE"," ",316],["T_ARRAY","array",316],"(",")",";",["T_WHITESPACE","\n\n        ",316],["T_IF","if",318],["T_WHITESPACE"," ",318],"(","!",["T_EMPTY","empty",318],"(",["T_VARIABLE","$dbRanges",318],")",")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$lastIndex",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_STRING","array_keys",319],"(",["T_VARIABLE","$dbRanges",319],")",";",["T_WHITESPACE","\n            ",319],["T_VARIABLE","$lastIndex",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$lastIndex",320],"[",["T_STRING","count",320],"(",["T_VARIABLE","$lastIndex",320],")",["T_WHITESPACE"," ",320],"-",["T_WHITESPACE"," ",320],["T_LNUMBER","1",320],"]",";",["T_WHITESPACE","\n\n            ",320],["T_FOREACH","foreach",322],["T_WHITESPACE"," ",322],"(",["T_VARIABLE","$dbRanges",322],["T_WHITESPACE"," ",322],["T_AS","as",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$index",322],["T_WHITESPACE"," ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$count",322],")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n                ",322],["T_VARIABLE","$fromPrice",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],"(",["T_VARIABLE","$index",323],["T_WHITESPACE"," ",323],["T_IS_EQUAL","==",323],["T_WHITESPACE"," ",323],["T_LNUMBER","1",323],")",["T_WHITESPACE"," ",323],"?",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","''",323],["T_WHITESPACE"," ",323],":",["T_WHITESPACE"," ",323],"(","(",["T_VARIABLE","$index",323],["T_WHITESPACE"," ",323],"-",["T_WHITESPACE"," ",323],["T_LNUMBER","1",323],")",["T_WHITESPACE"," ",323],"*",["T_WHITESPACE"," ",323],["T_VARIABLE","$range",323],")",";",["T_WHITESPACE","\n                ",323],["T_VARIABLE","$toPrice",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$index",324],["T_WHITESPACE"," ",324],["T_IS_EQUAL","==",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$lastIndex",324],")",["T_WHITESPACE"," ",324],"?",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","''",324],["T_WHITESPACE"," ",324],":",["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$index",324],["T_WHITESPACE"," ",324],"*",["T_WHITESPACE"," ",324],["T_VARIABLE","$range",324],")",";",["T_WHITESPACE","\n\n                ",324],["T_VARIABLE","$data",326],"[","]",["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_ARRAY","array",326],"(",["T_WHITESPACE","\n                    ",326],["T_CONSTANT_ENCAPSED_STRING","'label'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_renderRangeLabel",327],"(",["T_VARIABLE","$fromPrice",327],",",["T_WHITESPACE"," ",327],["T_VARIABLE","$toPrice",327],")",",",["T_WHITESPACE","\n                    ",327],["T_CONSTANT_ENCAPSED_STRING","'value'",328],["T_WHITESPACE"," ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$fromPrice",328],["T_WHITESPACE"," ",328],".",["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'-'",328],["T_WHITESPACE"," ",328],".",["T_WHITESPACE"," ",328],["T_VARIABLE","$toPrice",328],",",["T_WHITESPACE","\n                    ",328],["T_CONSTANT_ENCAPSED_STRING","'count'",329],["T_WHITESPACE"," ",329],["T_DOUBLE_ARROW","=>",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$count",329],",",["T_WHITESPACE","\n                ",329],")",";",["T_WHITESPACE","\n            ",330],"}",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n\n        ",332],["T_RETURN","return",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$data",334],";",["T_WHITESPACE","\n    ",334],"}",["T_WHITESPACE","\n\n    ",335],["T_DOC_COMMENT","\/**\n     * Apply price range filter to collection\n     *\n     * @return Mage_Catalog_Model_Layer_Filter_Price\n     *\/",337],["T_WHITESPACE","\n    ",341],["T_PROTECTED","protected",342],["T_WHITESPACE"," ",342],["T_FUNCTION","function",342],["T_WHITESPACE"," ",342],["T_STRING","_applyPriceRange",342],"(",")",["T_WHITESPACE","\n    ",342],"{",["T_WHITESPACE","\n        ",343],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_getResource",344],"(",")",["T_OBJECT_OPERATOR","->",344],["T_STRING","applyPriceRange",344],"(",["T_VARIABLE","$this",344],")",";",["T_WHITESPACE","\n        ",344],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],";",["T_WHITESPACE","\n    ",345],"}",["T_WHITESPACE","\n\n    ",346],["T_DOC_COMMENT","\/**\n     * Validate and parse filter request param\n     *\n     * @param string $filter\n     * @return array|bool\n     *\/",348],["T_WHITESPACE","\n    ",353],["T_PROTECTED","protected",354],["T_WHITESPACE"," ",354],["T_FUNCTION","function",354],["T_WHITESPACE"," ",354],["T_STRING","_validateFilter",354],"(",["T_VARIABLE","$filter",354],")",["T_WHITESPACE","\n    ",354],"{",["T_WHITESPACE","\n        ",355],["T_VARIABLE","$filter",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_STRING","explode",356],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$filter",356],")",";",["T_WHITESPACE","\n        ",356],["T_IF","if",357],["T_WHITESPACE"," ",357],"(",["T_STRING","count",357],"(",["T_VARIABLE","$filter",357],")",["T_WHITESPACE"," ",357],["T_IS_NOT_EQUAL","!=",357],["T_WHITESPACE"," ",357],["T_LNUMBER","2",357],")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n            ",357],["T_RETURN","return",358],["T_WHITESPACE"," ",358],["T_STRING","false",358],";",["T_WHITESPACE","\n        ",358],"}",["T_WHITESPACE","\n        ",359],["T_FOREACH","foreach",360],["T_WHITESPACE"," ",360],"(",["T_VARIABLE","$filter",360],["T_WHITESPACE"," ",360],["T_AS","as",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$v",360],")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n            ",360],["T_IF","if",361],["T_WHITESPACE"," ",361],"(","(",["T_VARIABLE","$v",361],["T_WHITESPACE"," ",361],["T_IS_NOT_IDENTICAL","!==",361],["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","''",361],["T_WHITESPACE"," ",361],["T_BOOLEAN_AND","&&",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$v",361],["T_WHITESPACE"," ",361],["T_IS_NOT_IDENTICAL","!==",361],["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'0'",361],["T_WHITESPACE"," ",361],["T_BOOLEAN_AND","&&",361],["T_WHITESPACE"," ",361],["T_DOUBLE_CAST","(float)",361],["T_VARIABLE","$v",361],["T_WHITESPACE"," ",361],["T_IS_SMALLER_OR_EQUAL","<=",361],["T_WHITESPACE"," ",361],["T_LNUMBER","0",361],")",["T_WHITESPACE"," ",361],["T_BOOLEAN_OR","||",361],["T_WHITESPACE"," ",361],["T_STRING","is_infinite",361],"(",["T_DOUBLE_CAST","(float)",361],["T_VARIABLE","$v",361],")",")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n                ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_STRING","false",362],";",["T_WHITESPACE","\n            ",362],"}",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE","\n\n        ",364],["T_RETURN","return",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$filter",366],";",["T_WHITESPACE","\n    ",366],"}",["T_WHITESPACE","\n\n    ",367],["T_DOC_COMMENT","\/**\n     * Apply price range filter\n     *\n     * @param Zend_Controller_Request_Abstract $request\n     * @param $filterBlock\n     *\n     * @return Mage_Catalog_Model_Layer_Filter_Price\n     *\/",369],["T_WHITESPACE","\n    ",376],["T_PUBLIC","public",377],["T_WHITESPACE"," ",377],["T_FUNCTION","function",377],["T_WHITESPACE"," ",377],["T_STRING","apply",377],"(",["T_STRING","Zend_Controller_Request_Abstract",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$request",377],",",["T_WHITESPACE"," ",377],["T_VARIABLE","$filterBlock",377],")",["T_WHITESPACE","\n    ",377],"{",["T_WHITESPACE","\n        ",378],["T_DOC_COMMENT","\/**\n         * Filter must be string: $fromPrice-$toPrice\n         *\/",379],["T_WHITESPACE","\n        ",381],["T_VARIABLE","$filter",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$request",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","getParam",382],"(",["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","getRequestVar",382],"(",")",")",";",["T_WHITESPACE","\n        ",382],["T_IF","if",383],["T_WHITESPACE"," ",383],"(","!",["T_VARIABLE","$filter",383],")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n            ",383],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],";",["T_WHITESPACE","\n        ",384],"}",["T_WHITESPACE","\n\n        ",385],["T_COMMENT","\/\/validate filter\n",387],["T_WHITESPACE","        ",388],["T_VARIABLE","$filterParams",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_STRING","explode",388],"(",["T_CONSTANT_ENCAPSED_STRING","','",388],",",["T_WHITESPACE"," ",388],["T_VARIABLE","$filter",388],")",";",["T_WHITESPACE","\n        ",388],["T_VARIABLE","$filter",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_validateFilter",389],"(",["T_VARIABLE","$filterParams",389],"[",["T_LNUMBER","0",389],"]",")",";",["T_WHITESPACE","\n        ",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(","!",["T_VARIABLE","$filter",390],")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n            ",390],["T_RETURN","return",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$this",391],";",["T_WHITESPACE","\n        ",391],"}",["T_WHITESPACE","\n\n        ",392],["T_LIST","list",394],"(",["T_VARIABLE","$from",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$to",394],")",["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$filter",394],";",["T_WHITESPACE","\n\n        ",394],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","setInterval",396],"(",["T_ARRAY","array",396],"(",["T_VARIABLE","$from",396],",",["T_WHITESPACE"," ",396],["T_VARIABLE","$to",396],")",")",";",["T_WHITESPACE","\n\n        ",396],["T_VARIABLE","$priorFilters",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",")",";",["T_WHITESPACE","\n        ",398],["T_FOR","for",399],["T_WHITESPACE"," ",399],"(",["T_VARIABLE","$i",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_LNUMBER","1",399],";",["T_WHITESPACE"," ",399],["T_VARIABLE","$i",399],["T_WHITESPACE"," ",399],"<",["T_WHITESPACE"," ",399],["T_STRING","count",399],"(",["T_VARIABLE","$filterParams",399],")",";",["T_WHITESPACE"," ",399],["T_INC","++",399],["T_VARIABLE","$i",399],")",["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$priorFilter",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","_validateFilter",400],"(",["T_VARIABLE","$filterParams",400],"[",["T_VARIABLE","$i",400],"]",")",";",["T_WHITESPACE","\n            ",400],["T_IF","if",401],["T_WHITESPACE"," ",401],"(",["T_VARIABLE","$priorFilter",401],")",["T_WHITESPACE"," ",401],"{",["T_WHITESPACE","\n                ",401],["T_VARIABLE","$priorFilters",402],"[","]",["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_VARIABLE","$priorFilter",402],";",["T_WHITESPACE","\n            ",402],"}",["T_WHITESPACE"," ",403],["T_ELSE","else",403],["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n                ",403],["T_COMMENT","\/\/not valid data\n",404],["T_WHITESPACE","                ",405],["T_VARIABLE","$priorFilters",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_ARRAY","array",405],"(",")",";",["T_WHITESPACE","\n                ",405],["T_BREAK","break",406],";",["T_WHITESPACE","\n            ",406],"}",["T_WHITESPACE","\n        ",407],"}",["T_WHITESPACE","\n        ",408],["T_IF","if",409],["T_WHITESPACE"," ",409],"(",["T_VARIABLE","$priorFilters",409],")",["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n            ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","setPriorIntervals",410],"(",["T_VARIABLE","$priorFilters",410],")",";",["T_WHITESPACE","\n        ",410],"}",["T_WHITESPACE","\n\n        ",411],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","_applyPriceRange",413],"(",")",";",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getLayer",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","getState",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","addFilter",414],"(",["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","_createItem",414],"(",["T_WHITESPACE","\n            ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","_renderRangeLabel",415],"(",["T_EMPTY","empty",415],"(",["T_VARIABLE","$from",415],")",["T_WHITESPACE"," ",415],"?",["T_WHITESPACE"," ",415],["T_LNUMBER","0",415],["T_WHITESPACE"," ",415],":",["T_WHITESPACE"," ",415],["T_VARIABLE","$from",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$to",415],")",",",["T_WHITESPACE","\n            ",415],["T_VARIABLE","$filter",416],["T_WHITESPACE","\n        ",416],")",")",";",["T_WHITESPACE","\n\n        ",417],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n\n    ",420],["T_DOC_COMMENT","\/**\n     * Apply filter value to product collection based on filter range and selected value\n     *\n     * @deprecated since 1.7.0.0\n     * @param int $range\n     * @param int $index\n     * @return Mage_Catalog_Model_Layer_Filter_Price\n     *\/",422],["T_WHITESPACE","\n    ",429],["T_PROTECTED","protected",430],["T_WHITESPACE"," ",430],["T_FUNCTION","function",430],["T_WHITESPACE"," ",430],["T_STRING","_applyToCollection",430],"(",["T_VARIABLE","$range",430],",",["T_WHITESPACE"," ",430],["T_VARIABLE","$index",430],")",["T_WHITESPACE","\n    ",430],"{",["T_WHITESPACE","\n        ",431],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","_getResource",432],"(",")",["T_OBJECT_OPERATOR","->",432],["T_STRING","applyFilterToCollection",432],"(",["T_VARIABLE","$this",432],",",["T_WHITESPACE"," ",432],["T_VARIABLE","$range",432],",",["T_WHITESPACE"," ",432],["T_VARIABLE","$index",432],")",";",["T_WHITESPACE","\n        ",432],["T_RETURN","return",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],";",["T_WHITESPACE","\n    ",433],"}",["T_WHITESPACE","\n\n    ",434],["T_DOC_COMMENT","\/**\n     * Retrieve active customer group id\n     *\n     * @return int\n     *\/",436],["T_WHITESPACE","\n    ",440],["T_PUBLIC","public",441],["T_WHITESPACE"," ",441],["T_FUNCTION","function",441],["T_WHITESPACE"," ",441],["T_STRING","getCustomerGroupId",441],"(",")",["T_WHITESPACE","\n    ",441],"{",["T_WHITESPACE","\n        ",442],["T_VARIABLE","$customerGroupId",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","_getData",443],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",443],")",";",["T_WHITESPACE","\n        ",443],["T_IF","if",444],["T_WHITESPACE"," ",444],"(",["T_STRING","is_null",444],"(",["T_VARIABLE","$customerGroupId",444],")",")",["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n            ",444],["T_VARIABLE","$customerGroupId",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_STRING","Mage",445],["T_DOUBLE_COLON","::",445],["T_STRING","getSingleton",445],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",445],")",["T_OBJECT_OPERATOR","->",445],["T_STRING","getCustomerGroupId",445],"(",")",";",["T_WHITESPACE","\n        ",445],"}",["T_WHITESPACE","\n        ",446],["T_RETURN","return",447],["T_WHITESPACE"," ",447],["T_VARIABLE","$customerGroupId",447],";",["T_WHITESPACE","\n    ",447],"}",["T_WHITESPACE","\n\n    ",448],["T_DOC_COMMENT","\/**\n     * Set active customer group id for filter\n     *\n     * @param int $customerGroupId\n     * @return Mage_Catalog_Model_Layer_Filter_Price\n     *\/",450],["T_WHITESPACE","\n    ",455],["T_PUBLIC","public",456],["T_WHITESPACE"," ",456],["T_FUNCTION","function",456],["T_WHITESPACE"," ",456],["T_STRING","setCustomerGroupId",456],"(",["T_VARIABLE","$customerGroupId",456],")",["T_WHITESPACE","\n    ",456],"{",["T_WHITESPACE","\n        ",457],["T_RETURN","return",458],["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","setData",458],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",458],",",["T_WHITESPACE"," ",458],["T_VARIABLE","$customerGroupId",458],")",";",["T_WHITESPACE","\n    ",458],"}",["T_WHITESPACE","\n\n    ",459],["T_DOC_COMMENT","\/**\n     * Retrieve active currency rate for filter\n     *\n     * @return float\n     *\/",461],["T_WHITESPACE","\n    ",465],["T_PUBLIC","public",466],["T_WHITESPACE"," ",466],["T_FUNCTION","function",466],["T_WHITESPACE"," ",466],["T_STRING","getCurrencyRate",466],"(",")",["T_WHITESPACE","\n    ",466],"{",["T_WHITESPACE","\n        ",467],["T_VARIABLE","$rate",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_getData",468],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_rate'",468],")",";",["T_WHITESPACE","\n        ",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(",["T_STRING","is_null",469],"(",["T_VARIABLE","$rate",469],")",")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n            ",469],["T_VARIABLE","$rate",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_STRING","Mage",470],["T_DOUBLE_COLON","::",470],["T_STRING","app",470],"(",")",["T_OBJECT_OPERATOR","->",470],["T_STRING","getStore",470],"(",["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","getStoreId",470],"(",")",")",["T_OBJECT_OPERATOR","->",470],["T_STRING","getCurrentCurrencyRate",470],"(",")",";",["T_WHITESPACE","\n        ",470],"}",["T_WHITESPACE","\n        ",471],["T_IF","if",472],["T_WHITESPACE"," ",472],"(","!",["T_VARIABLE","$rate",472],")",["T_WHITESPACE"," ",472],"{",["T_WHITESPACE","\n            ",472],["T_VARIABLE","$rate",473],["T_WHITESPACE"," ",473],"=",["T_WHITESPACE"," ",473],["T_LNUMBER","1",473],";",["T_WHITESPACE","\n        ",473],"}",["T_WHITESPACE","\n        ",474],["T_RETURN","return",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$rate",475],";",["T_WHITESPACE","\n    ",475],"}",["T_WHITESPACE","\n\n    ",476],["T_DOC_COMMENT","\/**\n     * Set active currency rate for filter\n     *\n     * @param float $rate\n     * @return Mage_Catalog_Model_Layer_Filter_Price\n     *\/",478],["T_WHITESPACE","\n    ",483],["T_PUBLIC","public",484],["T_WHITESPACE"," ",484],["T_FUNCTION","function",484],["T_WHITESPACE"," ",484],["T_STRING","setCurrencyRate",484],"(",["T_VARIABLE","$rate",484],")",["T_WHITESPACE","\n    ",484],"{",["T_WHITESPACE","\n        ",485],["T_RETURN","return",486],["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","setData",486],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_rate'",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$rate",486],")",";",["T_WHITESPACE","\n    ",486],"}",["T_WHITESPACE","\n\n    ",487],["T_DOC_COMMENT","\/**\n     * Get maximum number of intervals\n     *\n     * @return int\n     *\/",489],["T_WHITESPACE","\n    ",493],["T_PUBLIC","public",494],["T_WHITESPACE"," ",494],["T_FUNCTION","function",494],["T_WHITESPACE"," ",494],["T_STRING","getMaxIntervalsNumber",494],"(",")",["T_WHITESPACE","\n    ",494],"{",["T_WHITESPACE","\n        ",495],["T_RETURN","return",496],["T_WHITESPACE"," ",496],["T_INT_CAST","(int)",496],["T_STRING","Mage",496],["T_DOUBLE_COLON","::",496],["T_STRING","app",496],"(",")",["T_OBJECT_OPERATOR","->",496],["T_STRING","getStore",496],"(",")",["T_OBJECT_OPERATOR","->",496],["T_STRING","getConfig",496],"(",["T_STRING","self",496],["T_DOUBLE_COLON","::",496],["T_STRING","XML_PATH_RANGE_MAX_INTERVALS",496],")",";",["T_WHITESPACE","\n    ",496],"}",["T_WHITESPACE","\n\n    ",497],["T_DOC_COMMENT","\/**\n     * Get interval division limit\n     *\n     * @return int\n     *\/",499],["T_WHITESPACE","\n    ",503],["T_PUBLIC","public",504],["T_WHITESPACE"," ",504],["T_FUNCTION","function",504],["T_WHITESPACE"," ",504],["T_STRING","getIntervalDivisionLimit",504],"(",")",["T_WHITESPACE","\n    ",504],"{",["T_WHITESPACE","\n        ",505],["T_RETURN","return",506],["T_WHITESPACE"," ",506],["T_INT_CAST","(int)",506],["T_STRING","Mage",506],["T_DOUBLE_COLON","::",506],["T_STRING","app",506],"(",")",["T_OBJECT_OPERATOR","->",506],["T_STRING","getStore",506],"(",")",["T_OBJECT_OPERATOR","->",506],["T_STRING","getConfig",506],"(",["T_STRING","self",506],["T_DOUBLE_COLON","::",506],["T_STRING","XML_PATH_INTERVAL_DIVISION_LIMIT",506],")",";",["T_WHITESPACE","\n    ",506],"}",["T_WHITESPACE","\n\n    ",507],["T_DOC_COMMENT","\/**\n     * Get filter value for reset current filter state\n     *\n     * @return null|string\n     *\/",509],["T_WHITESPACE","\n    ",513],["T_PUBLIC","public",514],["T_WHITESPACE"," ",514],["T_FUNCTION","function",514],["T_WHITESPACE"," ",514],["T_STRING","getResetValue",514],"(",")",["T_WHITESPACE","\n    ",514],"{",["T_WHITESPACE","\n        ",515],["T_VARIABLE","$priorIntervals",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","getPriorIntervals",516],"(",")",";",["T_WHITESPACE","\n        ",516],["T_VARIABLE","$value",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],["T_ARRAY","array",517],"(",")",";",["T_WHITESPACE","\n        ",517],["T_IF","if",518],["T_WHITESPACE"," ",518],"(",["T_VARIABLE","$priorIntervals",518],")",["T_WHITESPACE"," ",518],"{",["T_WHITESPACE","\n            ",518],["T_FOREACH","foreach",519],["T_WHITESPACE"," ",519],"(",["T_VARIABLE","$priorIntervals",519],["T_WHITESPACE"," ",519],["T_AS","as",519],["T_WHITESPACE"," ",519],["T_VARIABLE","$priorInterval",519],")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n                ",519],["T_VARIABLE","$value",520],"[","]",["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_STRING","implode",520],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$priorInterval",520],")",";",["T_WHITESPACE","\n            ",520],"}",["T_WHITESPACE","\n            ",521],["T_RETURN","return",522],["T_WHITESPACE"," ",522],["T_STRING","implode",522],"(",["T_CONSTANT_ENCAPSED_STRING","','",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$value",522],")",";",["T_WHITESPACE","\n        ",522],"}",["T_WHITESPACE","\n        ",523],["T_RETURN","return",524],["T_WHITESPACE"," ",524],["T_STRING","parent",524],["T_DOUBLE_COLON","::",524],["T_STRING","getResetValue",524],"(",")",";",["T_WHITESPACE","\n    ",524],"}",["T_WHITESPACE","\n\n    ",525],["T_DOC_COMMENT","\/**\n     * Get 'clear price' link text\n     *\n     * @return false|string\n     *\/",527],["T_WHITESPACE","\n    ",531],["T_PUBLIC","public",532],["T_WHITESPACE"," ",532],["T_FUNCTION","function",532],["T_WHITESPACE"," ",532],["T_STRING","getClearLinkText",532],"(",")",["T_WHITESPACE","\n    ",532],"{",["T_WHITESPACE","\n        ",533],["T_IF","if",534],["T_WHITESPACE"," ",534],"(",["T_STRING","Mage",534],["T_DOUBLE_COLON","::",534],["T_STRING","app",534],"(",")",["T_OBJECT_OPERATOR","->",534],["T_STRING","getStore",534],"(",")",["T_OBJECT_OPERATOR","->",534],["T_STRING","getConfig",534],"(",["T_STRING","self",534],["T_DOUBLE_COLON","::",534],["T_STRING","XML_PATH_RANGE_CALCULATION",534],")",["T_WHITESPACE"," ",534],["T_IS_EQUAL","==",534],["T_WHITESPACE"," ",534],["T_STRING","self",534],["T_DOUBLE_COLON","::",534],["T_STRING","RANGE_CALCULATION_IMPROVED",534],["T_WHITESPACE","\n            ",534],["T_BOOLEAN_AND","&&",535],["T_WHITESPACE"," ",535],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","getPriorIntervals",535],"(",")",["T_WHITESPACE","\n        ",535],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n            ",536],["T_RETURN","return",537],["T_WHITESPACE"," ",537],["T_STRING","Mage",537],["T_DOUBLE_COLON","::",537],["T_STRING","helper",537],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",537],")",["T_OBJECT_OPERATOR","->",537],["T_STRING","__",537],"(",["T_CONSTANT_ENCAPSED_STRING","'Clear Price'",537],")",";",["T_WHITESPACE","\n        ",537],"}",["T_WHITESPACE","\n\n        ",538],["T_RETURN","return",540],["T_WHITESPACE"," ",540],["T_STRING","parent",540],["T_DOUBLE_COLON","::",540],["T_STRING","getClearLinkText",540],"(",")",";",["T_WHITESPACE","\n    ",540],"}",["T_WHITESPACE","\n\n    ",541],["T_DOC_COMMENT","\/**\n     * Load range of product prices\n     *\n     * @param int $limit\n     * @param null|int $offset\n     * @param null|int $lowerPrice\n     * @param null|int $upperPrice\n     * @return array|false\n     *\/",543],["T_WHITESPACE","\n    ",551],["T_PUBLIC","public",552],["T_WHITESPACE"," ",552],["T_FUNCTION","function",552],["T_WHITESPACE"," ",552],["T_STRING","loadPrices",552],"(",["T_VARIABLE","$limit",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$offset",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_STRING","null",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$lowerPrice",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_STRING","null",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$upperPrice",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_STRING","null",552],")",["T_WHITESPACE","\n    ",552],"{",["T_WHITESPACE","\n        ",553],["T_VARIABLE","$prices",554],["T_WHITESPACE"," ",554],"=",["T_WHITESPACE"," ",554],["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","_getResource",554],"(",")",["T_OBJECT_OPERATOR","->",554],["T_STRING","loadPrices",554],"(",["T_VARIABLE","$this",554],",",["T_WHITESPACE"," ",554],["T_VARIABLE","$limit",554],",",["T_WHITESPACE"," ",554],["T_VARIABLE","$offset",554],",",["T_WHITESPACE"," ",554],["T_VARIABLE","$lowerPrice",554],",",["T_WHITESPACE"," ",554],["T_VARIABLE","$upperPrice",554],")",";",["T_WHITESPACE","\n        ",554],["T_IF","if",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$prices",555],")",["T_WHITESPACE"," ",555],"{",["T_WHITESPACE","\n            ",555],["T_VARIABLE","$prices",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_STRING","array_map",556],"(",["T_CONSTANT_ENCAPSED_STRING","'floatval'",556],",",["T_WHITESPACE"," ",556],["T_VARIABLE","$prices",556],")",";",["T_WHITESPACE","\n        ",556],"}",["T_WHITESPACE","\n\n        ",557],["T_RETURN","return",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$prices",559],";",["T_WHITESPACE","\n    ",559],"}",["T_WHITESPACE","\n\n    ",560],["T_DOC_COMMENT","\/**\n     * Load range of product prices, preceding the price\n     *\n     * @param float $price\n     * @param int $index\n     * @param null|int $lowerPrice\n     * @return array|false\n     *\/",562],["T_WHITESPACE","\n    ",569],["T_PUBLIC","public",570],["T_WHITESPACE"," ",570],["T_FUNCTION","function",570],["T_WHITESPACE"," ",570],["T_STRING","loadPreviousPrices",570],"(",["T_VARIABLE","$price",570],",",["T_WHITESPACE"," ",570],["T_VARIABLE","$index",570],",",["T_WHITESPACE"," ",570],["T_VARIABLE","$lowerPrice",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_STRING","null",570],")",["T_WHITESPACE","\n    ",570],"{",["T_WHITESPACE","\n        ",571],["T_VARIABLE","$prices",572],["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","_getResource",572],"(",")",["T_OBJECT_OPERATOR","->",572],["T_STRING","loadPreviousPrices",572],"(",["T_VARIABLE","$this",572],",",["T_WHITESPACE"," ",572],["T_VARIABLE","$price",572],",",["T_WHITESPACE"," ",572],["T_VARIABLE","$index",572],",",["T_WHITESPACE"," ",572],["T_VARIABLE","$lowerPrice",572],")",";",["T_WHITESPACE","\n        ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(",["T_VARIABLE","$prices",573],")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_VARIABLE","$prices",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_STRING","array_map",574],"(",["T_CONSTANT_ENCAPSED_STRING","'floatval'",574],",",["T_WHITESPACE"," ",574],["T_VARIABLE","$prices",574],")",";",["T_WHITESPACE","\n        ",574],"}",["T_WHITESPACE","\n\n        ",575],["T_RETURN","return",577],["T_WHITESPACE"," ",577],["T_VARIABLE","$prices",577],";",["T_WHITESPACE","\n    ",577],"}",["T_WHITESPACE","\n\n    ",578],["T_DOC_COMMENT","\/**\n     * Load range of product prices, next to the price\n     *\n     * @param float $price\n     * @param int $rightIndex\n     * @param null|int $upperPrice\n     * @return array|false\n     *\/",580],["T_WHITESPACE","\n    ",587],["T_PUBLIC","public",588],["T_WHITESPACE"," ",588],["T_FUNCTION","function",588],["T_WHITESPACE"," ",588],["T_STRING","loadNextPrices",588],"(",["T_VARIABLE","$price",588],",",["T_WHITESPACE"," ",588],["T_VARIABLE","$rightIndex",588],",",["T_WHITESPACE"," ",588],["T_VARIABLE","$upperPrice",588],["T_WHITESPACE"," ",588],"=",["T_WHITESPACE"," ",588],["T_STRING","null",588],")",["T_WHITESPACE","\n    ",588],"{",["T_WHITESPACE","\n        ",589],["T_VARIABLE","$prices",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","_getResource",590],"(",")",["T_OBJECT_OPERATOR","->",590],["T_STRING","loadNextPrices",590],"(",["T_VARIABLE","$this",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$price",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$rightIndex",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$upperPrice",590],")",";",["T_WHITESPACE","\n        ",590],["T_IF","if",591],["T_WHITESPACE"," ",591],"(",["T_VARIABLE","$prices",591],")",["T_WHITESPACE"," ",591],"{",["T_WHITESPACE","\n            ",591],["T_VARIABLE","$prices",592],["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_STRING","array_map",592],"(",["T_CONSTANT_ENCAPSED_STRING","'floatval'",592],",",["T_WHITESPACE"," ",592],["T_VARIABLE","$prices",592],")",";",["T_WHITESPACE","\n        ",592],"}",["T_WHITESPACE","\n\n        ",593],["T_RETURN","return",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$prices",595],";",["T_WHITESPACE","\n    ",595],"}",["T_WHITESPACE","\n",596],"}",["T_WHITESPACE","\n",597]]