[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog Product Eav Indexer Resource Model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Indexer_Eav",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Indexer_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * EAV Indexers by type\n     *\n     * @var array\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_types",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Define main index table\n     *\n     *\/",44],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","_construct",48],"(",")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_init",50],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_index_eav'",50],",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",50],")",";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Retrieve array of EAV type indexers\n     *\n     * @return array\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","getIndexers",58],"(",")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_STRING","is_null",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_types",60],")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_types",61],["T_WHITESPACE","   ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",["T_WHITESPACE","\n                ",61],["T_CONSTANT_ENCAPSED_STRING","'source'",62],["T_WHITESPACE","    ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_STRING","Mage",62],["T_DOUBLE_COLON","::",62],["T_STRING","getResourceModel",62],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_indexer_eav_source'",62],")",",",["T_WHITESPACE","\n                ",62],["T_CONSTANT_ENCAPSED_STRING","'decimal'",63],["T_WHITESPACE","   ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_STRING","Mage",63],["T_DOUBLE_COLON","::",63],["T_STRING","getResourceModel",63],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_indexer_eav_decimal'",63],")",",",["T_WHITESPACE","\n            ",63],")",";",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n\n        ",65],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_types",67],";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Retrieve indexer instance by type\n     *\n     * @param string $type\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav_Abstract\n     *\/",70],["T_WHITESPACE","\n    ",75],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","getIndexer",76],"(",["T_VARIABLE","$type",76],")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$indexers",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getIndexers",78],"(",")",";",["T_WHITESPACE","\n        ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(","!",["T_ISSET","isset",79],"(",["T_VARIABLE","$indexers",79],"[",["T_VARIABLE","$type",79],"]",")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","throwException",80],"(",["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","helper",80],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",80],")",["T_OBJECT_OPERATOR","->",80],["T_STRING","__",80],"(",["T_CONSTANT_ENCAPSED_STRING","'Unknown EAV indexer type \"%s\".'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$type",80],")",")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$indexers",82],"[",["T_VARIABLE","$type",82],"]",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Process product save.\n     * Method is responsible for index support\n     * when product was saved and assigned categories was changed.\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav\n     *\/",85],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","catalogProductSave",93],"(",["T_STRING","Mage_Index_Model_Event",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$event",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$productId",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$event",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getEntityPk",95],"(",")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$data",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$event",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getNewData",96],"(",")",";",["T_WHITESPACE","\n\n        ",96],["T_DOC_COMMENT","\/**\n         * Check if filterable attribute values were updated\n         *\/",98],["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(","!",["T_ISSET","isset",101],"(",["T_VARIABLE","$data",101],"[",["T_CONSTANT_ENCAPSED_STRING","'reindex_eav'",101],"]",")",")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n\n        ",103],["T_FOREACH","foreach",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getIndexers",105],"(",")",["T_WHITESPACE"," ",105],["T_AS","as",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$indexer",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_DOC_COMMENT","\/** @var $indexer Mage_Catalog_Model_Resource_Product_Indexer_Eav_Abstract *\/",106],["T_WHITESPACE","\n            ",106],["T_VARIABLE","$indexer",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","reindexEntities",107],"(",["T_VARIABLE","$productId",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Process Product Delete\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav\n     *\/",113],["T_WHITESPACE","\n    ",118],["T_PUBLIC","public",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","catalogProductDelete",119],"(",["T_STRING","Mage_Index_Model_Event",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$event",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$data",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$event",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getNewData",121],"(",")",";",["T_WHITESPACE","\n        ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_EMPTY","empty",122],"(",["T_VARIABLE","$data",122],"[",["T_CONSTANT_ENCAPSED_STRING","'reindex_eav_parent_ids'",122],"]",")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n\n        ",124],["T_FOREACH","foreach",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getIndexers",126],"(",")",["T_WHITESPACE"," ",126],["T_AS","as",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$indexer",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_DOC_COMMENT","\/** @var $indexer Mage_Catalog_Model_Resource_Product_Indexer_Eav_Abstract *\/",127],["T_WHITESPACE","\n            ",127],["T_VARIABLE","$indexer",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","reindexEntities",128],"(",["T_VARIABLE","$data",128],"[",["T_CONSTANT_ENCAPSED_STRING","'reindex_eav_parent_ids'",128],"]",")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Process Product Mass Update\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","catalogProductMassAction",140],"(",["T_STRING","Mage_Index_Model_Event",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$event",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$data",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$event",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getNewData",142],"(",")",";",["T_WHITESPACE","\n        ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_EMPTY","empty",143],"(",["T_VARIABLE","$data",143],"[",["T_CONSTANT_ENCAPSED_STRING","'reindex_eav_product_ids'",143],"]",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_FOREACH","foreach",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getIndexers",147],"(",")",["T_WHITESPACE"," ",147],["T_AS","as",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$indexer",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_DOC_COMMENT","\/** @var $indexer Mage_Catalog_Model_Resource_Product_Indexer_Eav_Abstract *\/",148],["T_WHITESPACE","\n            ",148],["T_VARIABLE","$indexer",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","reindexEntities",149],"(",["T_VARIABLE","$data",149],"[",["T_CONSTANT_ENCAPSED_STRING","'reindex_eav_product_ids'",149],"]",")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Process Catalog Eav Attribute Save\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav\n     *\/",155],["T_WHITESPACE","\n    ",160],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","catalogEavAttributeSave",161],"(",["T_STRING","Mage_Index_Model_Event",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$event",161],")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$data",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$event",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getNewData",163],"(",")",";",["T_WHITESPACE","\n        ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_EMPTY","empty",164],"(",["T_VARIABLE","$data",164],"[",["T_CONSTANT_ENCAPSED_STRING","'reindex_attribute'",164],"]",")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$indexer",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getIndexer",168],"(",["T_VARIABLE","$data",168],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_index_type'",168],"]",")",";",["T_WHITESPACE","\n\n        ",168],["T_VARIABLE","$indexer",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","reindexAttribute",170],"(",["T_VARIABLE","$event",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getEntityPk",170],"(",")",",",["T_WHITESPACE"," ",170],"!",["T_EMPTY","empty",170],"(",["T_VARIABLE","$data",170],"[",["T_CONSTANT_ENCAPSED_STRING","'is_indexable'",170],"]",")",")",";",["T_WHITESPACE","\n\n        ",170],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Rebuild all index data\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav\n     *\/",175],["T_WHITESPACE","\n    ",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","reindexAll",180],"(",")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","useIdxTable",182],"(",["T_STRING","true",182],")",";",["T_WHITESPACE","\n        ",182],["T_FOREACH","foreach",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getIndexers",183],"(",")",["T_WHITESPACE"," ",183],["T_AS","as",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$indexer",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_DOC_COMMENT","\/** @var $indexer Mage_Catalog_Model_Resource_Product_Indexer_Eav_Abstract *\/",184],["T_WHITESPACE","\n            ",184],["T_VARIABLE","$indexer",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","reindexAll",185],"(",")",";",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n\n        ",186],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Retrieve temporary source index table name\n     *\n     * @param string $table\n     * @return string\n     *\/",191],["T_WHITESPACE","\n    ",196],["T_PUBLIC","public",197],["T_WHITESPACE"," ",197],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","getIdxTable",197],"(",["T_VARIABLE","$table",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_STRING","null",197],")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","useIdxTable",199],"(",")",")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n           ",199],["T_RETURN","return",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getTable",200],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_eav_indexer_idx'",200],")",";",["T_WHITESPACE","\n        ",200],"}",["T_WHITESPACE","\n        ",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getTable",202],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_eav_indexer_tmp'",202],")",";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n",203],"}",["T_WHITESPACE","\n",204]]