[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog product option file type\n *\n * @category   Mage\n * @package    Mage_Catalog\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Product_Option_Type_File",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Product_Option_Type_Default",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Url for custom option download controller\n     * @var string\n     *\/",36],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$_customOptionDownloadUrl",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'sales\/download\/downloadCustomOption'",40],";",["T_WHITESPACE","\n\n    ",40],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","isCustomizedView",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_RETURN","return",44],["T_WHITESPACE"," ",44],["T_STRING","true",44],";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Return option html\n     *\n     * @param array $optionInfo\n     * @return string\n     *\/",47],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","getCustomizedView",53],"(",["T_VARIABLE","$optionInfo",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_TRY","try",55],["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_ISSET","isset",56],"(",["T_VARIABLE","$optionInfo",56],"[",["T_CONSTANT_ENCAPSED_STRING","'option_value'",56],"]",")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n                ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_getOptionHtml",57],"(",["T_VARIABLE","$optionInfo",57],"[",["T_CONSTANT_ENCAPSED_STRING","'option_value'",57],"]",")",";",["T_WHITESPACE","\n            ",57],"}",["T_WHITESPACE"," ",58],["T_ELSEIF","elseif",58],["T_WHITESPACE"," ",58],"(",["T_ISSET","isset",58],"(",["T_VARIABLE","$optionInfo",58],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",58],"]",")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$optionInfo",59],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",59],"]",";",["T_WHITESPACE","\n            ",59],"}",["T_WHITESPACE","\n        ",60],"}",["T_WHITESPACE"," ",61],["T_CATCH","catch",61],["T_WHITESPACE"," ",61],"(",["T_STRING","Exception",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$e",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$optionInfo",62],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",62],"]",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Returns additional params for processing options\n     *\n     * @return Varien_Object\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","_getProcessingParams",71],"(",")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$buyRequest",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getRequest",73],"(",")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$params",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$buyRequest",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getData",74],"(",["T_CONSTANT_ENCAPSED_STRING","'_processing_params'",74],")",";",["T_WHITESPACE","\n        ",74],["T_COMMENT","\/*\n         * Notice check for params to be Varien_Object - by using object we protect from\n         * params being forged and contain data from user frontend input\n         *\/",75],["T_WHITESPACE","\n        ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$params",79],["T_WHITESPACE"," ",79],["T_INSTANCEOF","instanceof",79],["T_WHITESPACE"," ",79],["T_STRING","Varien_Object",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$params",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","Varien_Object",82],"(",")",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Returns file info array if we need to get file from already existing file.\n     * Or returns null, if we need to get file from uploaded array.\n     *\n     * @return null|array\n     *\/",85],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","_getCurrentConfigFileInfo",91],"(",")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$option",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getOption",93],"(",")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$optionId",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$option",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getId",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$processingParams",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_getProcessingParams",95],"(",")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$buyRequest",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getRequest",96],"(",")",";",["T_WHITESPACE","\n\n        ",96],["T_COMMENT","\/\/ Check maybe restore file from config requested\n",98],["T_WHITESPACE","        ",99],["T_VARIABLE","$optionActionKey",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'options_'",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$optionId",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'_file_action'",99],";",["T_WHITESPACE","\n        ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$buyRequest",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getData",100],"(",["T_VARIABLE","$optionActionKey",100],")",["T_WHITESPACE"," ",100],["T_IS_EQUAL","==",100],["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'save_old'",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$fileInfo",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_ARRAY","array",101],"(",")",";",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$currentConfig",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$processingParams",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getCurrentConfig",102],"(",")",";",["T_WHITESPACE","\n            ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$currentConfig",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$fileInfo",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$currentConfig",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getData",104],"(",["T_CONSTANT_ENCAPSED_STRING","'options\/'",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_VARIABLE","$optionId",104],")",";",["T_WHITESPACE","\n            ",104],"}",["T_WHITESPACE","\n            ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$fileInfo",106],";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_STRING","null",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Validate user input for option\n     *\n     * @throws Mage_Core_Exception\n     * @param array $values All product option values, i.e. array (option_id => mixed, option_id => mixed...)\n     * @return Mage_Catalog_Model_Product_Option_Type_File\n     *\/",111],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","validateUserValue",118],"(",["T_VARIABLE","$values",118],")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_STRING","Mage",120],["T_DOUBLE_COLON","::",120],["T_STRING","getSingleton",120],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",120],")",["T_OBJECT_OPERATOR","->",120],["T_STRING","setUseNotice",120],"(",["T_STRING","false",120],")",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setIsValid",122],"(",["T_STRING","true",122],")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$option",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getOption",123],"(",")",";",["T_WHITESPACE","\n\n        ",123],["T_COMMENT","\/*\n         * Check whether we receive uploaded file or restore file by: reorder\/edit configuration or\n         * previous configuration with no newly uploaded file\n         *\/",125],["T_WHITESPACE","\n\n        ",128],["T_VARIABLE","$fileInfo",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_getCurrentConfigFileInfo",130],"(",")",";",["T_WHITESPACE","\n\n        ",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$fileInfo",132],["T_WHITESPACE"," ",132],["T_IS_NOT_IDENTICAL","!==",132],["T_WHITESPACE"," ",132],["T_STRING","null",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_STRING","is_array",133],"(",["T_VARIABLE","$fileInfo",133],")",["T_WHITESPACE"," ",133],["T_BOOLEAN_AND","&&",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_validateFile",133],"(",["T_VARIABLE","$fileInfo",133],")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                ",133],["T_VARIABLE","$value",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$fileInfo",134],";",["T_WHITESPACE","\n            ",134],"}",["T_WHITESPACE"," ",135],["T_ELSE","else",135],["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$value",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","null",136],";",["T_WHITESPACE","\n            ",136],"}",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setUserValue",138],"(",["T_VARIABLE","$value",138],")",";",["T_WHITESPACE","\n            ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n\n        ",140],["T_COMMENT","\/\/ Process new uploaded file\n",142],["T_WHITESPACE","        ",143],["T_TRY","try",143],["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_validateUploadedFile",144],"(",")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE"," ",145],["T_CATCH","catch",145],["T_WHITESPACE"," ",145],"(",["T_STRING","Exception",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$e",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getSkipCheckRequiredOption",146],"(",")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","setUserValue",147],"(",["T_STRING","null",147],")",";",["T_WHITESPACE","\n                ",147],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],";",["T_WHITESPACE","\n            ",148],"}",["T_WHITESPACE"," ",149],["T_ELSE","else",149],["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                ",149],["T_STRING","Mage",150],["T_DOUBLE_COLON","::",150],["T_STRING","throwException",150],"(",["T_VARIABLE","$e",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getMessage",150],"(",")",")",";",["T_WHITESPACE","\n            ",150],"}",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Validate uploaded file\n     *\n     * @throws Mage_Core_Exception\n     * @return Mage_Catalog_Model_Product_Option_Type_File\n     *\/",156],["T_WHITESPACE","\n    ",161],["T_PROTECTED","protected",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","_validateUploadedFile",162],"(",")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$option",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getOption",164],"(",")",";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$processingParams",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_getProcessingParams",165],"(",")",";",["T_WHITESPACE","\n\n        ",165],["T_DOC_COMMENT","\/**\n         * Upload init\n         *\/",167],["T_WHITESPACE","\n        ",169],["T_VARIABLE","$upload",170],["T_WHITESPACE","   ",170],"=",["T_WHITESPACE"," ",170],["T_NEW","new",170],["T_WHITESPACE"," ",170],["T_STRING","Zend_File_Transfer_Adapter_Http",170],"(",")",";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$file",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$processingParams",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getFilesPrefix",171],"(",")",["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'options_'",171],["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_VARIABLE","$option",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getId",171],"(",")",["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'_file'",171],";",["T_WHITESPACE","\n        ",171],["T_TRY","try",172],["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$runValidation",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$option",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getIsRequire",173],"(",")",["T_WHITESPACE"," ",173],["T_BOOLEAN_OR","||",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$upload",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","isUploaded",173],"(",["T_VARIABLE","$file",173],")",";",["T_WHITESPACE","\n            ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(","!",["T_VARIABLE","$runValidation",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n                ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","setUserValue",175],"(",["T_STRING","null",175],")",";",["T_WHITESPACE","\n                ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],";",["T_WHITESPACE","\n            ",176],"}",["T_WHITESPACE","\n\n            ",177],["T_VARIABLE","$fileInfo",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$upload",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getFileInfo",179],"(",["T_VARIABLE","$file",179],")",";",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$fileInfo",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$fileInfo",180],"[",["T_VARIABLE","$file",180],"]",";",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$fileInfo",181],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",181],"]",["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$fileInfo",181],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",181],"]",";",["T_WHITESPACE","\n\n        ",181],"}",["T_WHITESPACE"," ",183],["T_CATCH","catch",183],["T_WHITESPACE"," ",183],"(",["T_STRING","Exception",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$e",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_COMMENT","\/\/ when file exceeds the upload_max_filesize, $_FILES is empty\n",184],["T_WHITESPACE","            ",185],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_ISSET","isset",185],"(",["T_VARIABLE","$_SERVER",185],"[",["T_CONSTANT_ENCAPSED_STRING","'CONTENT_LENGTH'",185],"]",")",["T_WHITESPACE"," ",185],["T_BOOLEAN_AND","&&",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$_SERVER",185],"[",["T_CONSTANT_ENCAPSED_STRING","'CONTENT_LENGTH'",185],"]",["T_WHITESPACE"," ",185],">",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_getUploadMaxFilesize",185],"(",")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n                ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setIsValid",186],"(",["T_STRING","false",186],")",";",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$value",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_bytesToMbytes",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_getUploadMaxFilesize",187],"(",")",")",";",["T_WHITESPACE","\n                ",187],["T_STRING","Mage",188],["T_DOUBLE_COLON","::",188],["T_STRING","throwException",188],"(",["T_WHITESPACE","\n                    ",188],["T_STRING","Mage",189],["T_DOUBLE_COLON","::",189],["T_STRING","helper",189],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",189],")",["T_OBJECT_OPERATOR","->",189],["T_STRING","__",189],"(",["T_CONSTANT_ENCAPSED_STRING","\"The file you uploaded is larger than %s Megabytes allowed by server\"",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$value",189],")",["T_WHITESPACE","\n                ",189],")",";",["T_WHITESPACE","\n            ",190],"}",["T_WHITESPACE"," ",191],["T_ELSE","else",191],["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                ",191],["T_SWITCH","switch",192],"(",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getProcessMode",192],"(",")",")",["T_WHITESPACE","\n                ",192],"{",["T_WHITESPACE","\n                    ",193],["T_CASE","case",194],["T_WHITESPACE"," ",194],["T_STRING","Mage_Catalog_Model_Product_Type_Abstract",194],["T_DOUBLE_COLON","::",194],["T_STRING","PROCESS_MODE_FULL",194],":",["T_WHITESPACE","\n                        ",194],["T_STRING","Mage",195],["T_DOUBLE_COLON","::",195],["T_STRING","throwException",195],"(",["T_WHITESPACE","\n                            ",195],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","helper",196],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",196],")",["T_OBJECT_OPERATOR","->",196],["T_STRING","__",196],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify the product\\'s required option(s).'",196],")",["T_WHITESPACE","\n                        ",196],")",";",["T_WHITESPACE","\n                        ",197],["T_BREAK","break",198],";",["T_WHITESPACE","\n                    ",198],["T_DEFAULT","default",199],":",["T_WHITESPACE","\n                        ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","setUserValue",200],"(",["T_STRING","null",200],")",";",["T_WHITESPACE","\n                        ",200],["T_BREAK","break",201],";",["T_WHITESPACE","\n                ",201],"}",["T_WHITESPACE","\n                ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],";",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n\n        ",205],["T_DOC_COMMENT","\/**\n         * Option Validations\n         *\/",207],["T_WHITESPACE","\n\n        ",209],["T_COMMENT","\/\/ Image dimensions\n",211],["T_WHITESPACE","        ",212],["T_VARIABLE","$_dimentions",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_ARRAY","array",212],"(",")",";",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$option",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getImageSizeX",213],"(",")",["T_WHITESPACE"," ",213],">",["T_WHITESPACE"," ",213],["T_LNUMBER","0",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$_dimentions",214],"[",["T_CONSTANT_ENCAPSED_STRING","'maxwidth'",214],"]",["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$option",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getImageSizeX",214],"(",")",";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n        ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$option",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getImageSizeY",216],"(",")",["T_WHITESPACE"," ",216],">",["T_WHITESPACE"," ",216],["T_LNUMBER","0",216],")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$_dimentions",217],"[",["T_CONSTANT_ENCAPSED_STRING","'maxheight'",217],"]",["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$option",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getImageSizeY",217],"(",")",";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE","\n        ",218],["T_IF","if",219],["T_WHITESPACE"," ",219],"(",["T_STRING","count",219],"(",["T_VARIABLE","$_dimentions",219],")",["T_WHITESPACE"," ",219],">",["T_WHITESPACE"," ",219],["T_LNUMBER","0",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$upload",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","addValidator",220],"(",["T_CONSTANT_ENCAPSED_STRING","'ImageSize'",220],",",["T_WHITESPACE"," ",220],["T_STRING","false",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$_dimentions",220],")",";",["T_WHITESPACE","\n        ",220],"}",["T_WHITESPACE","\n\n        ",221],["T_COMMENT","\/\/ File extension\n",223],["T_WHITESPACE","        ",224],["T_VARIABLE","$_allowed",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_parseExtensionsString",224],"(",["T_VARIABLE","$option",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getFileExtension",224],"(",")",")",";",["T_WHITESPACE","\n        ",224],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$_allowed",225],["T_WHITESPACE"," ",225],["T_IS_NOT_IDENTICAL","!==",225],["T_WHITESPACE"," ",225],["T_STRING","null",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$upload",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","addValidator",226],"(",["T_CONSTANT_ENCAPSED_STRING","'Extension'",226],",",["T_WHITESPACE"," ",226],["T_STRING","false",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$_allowed",226],")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$_forbidden",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_parseExtensionsString",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getConfigData",228],"(",["T_CONSTANT_ENCAPSED_STRING","'forbidden_extensions'",228],")",")",";",["T_WHITESPACE","\n            ",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_VARIABLE","$_forbidden",229],["T_WHITESPACE"," ",229],["T_IS_NOT_IDENTICAL","!==",229],["T_WHITESPACE"," ",229],["T_STRING","null",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n                ",229],["T_VARIABLE","$upload",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","addValidator",230],"(",["T_CONSTANT_ENCAPSED_STRING","'ExcludeExtension'",230],",",["T_WHITESPACE"," ",230],["T_STRING","false",230],",",["T_WHITESPACE"," ",230],["T_VARIABLE","$_forbidden",230],")",";",["T_WHITESPACE","\n            ",230],"}",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n\n        ",232],["T_COMMENT","\/\/ Maximum filesize\n",234],["T_WHITESPACE","        ",235],["T_VARIABLE","$upload",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","addValidator",235],"(",["T_CONSTANT_ENCAPSED_STRING","'FilesSize'",235],",",["T_WHITESPACE"," ",235],["T_STRING","false",235],",",["T_WHITESPACE"," ",235],["T_ARRAY","array",235],"(",["T_CONSTANT_ENCAPSED_STRING","'max'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_getUploadMaxFilesize",235],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",235],["T_DOC_COMMENT","\/**\n         * Upload process\n         *\/",237],["T_WHITESPACE","\n\n        ",239],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_initFilesystem",241],"(",")",";",["T_WHITESPACE","\n\n        ",241],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$upload",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","isUploaded",243],"(",["T_VARIABLE","$file",243],")",["T_WHITESPACE"," ",243],["T_BOOLEAN_AND","&&",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$upload",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","isValid",243],"(",["T_VARIABLE","$file",243],")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n\n            ",243],["T_VARIABLE","$extension",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","pathinfo",245],"(",["T_STRING","strtolower",245],"(",["T_VARIABLE","$fileInfo",245],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",245],"]",")",",",["T_WHITESPACE"," ",245],["T_STRING","PATHINFO_EXTENSION",245],")",";",["T_WHITESPACE","\n\n            ",245],["T_VARIABLE","$fileName",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","Mage_Core_Model_File_Uploader",247],["T_DOUBLE_COLON","::",247],["T_STRING","getCorrectFileName",247],"(",["T_VARIABLE","$fileInfo",247],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",247],"]",")",";",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$dispersion",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","Mage_Core_Model_File_Uploader",248],["T_DOUBLE_COLON","::",248],["T_STRING","getDispretionPath",248],"(",["T_VARIABLE","$fileName",248],")",";",["T_WHITESPACE","\n\n            ",248],["T_VARIABLE","$filePath",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$dispersion",250],";",["T_WHITESPACE","\n            ",250],["T_VARIABLE","$fileHash",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","md5",251],"(",["T_STRING","file_get_contents",251],"(",["T_VARIABLE","$fileInfo",251],"[",["T_CONSTANT_ENCAPSED_STRING","'tmp_name'",251],"]",")",")",";",["T_WHITESPACE","\n            ",251],["T_VARIABLE","$filePath",252],["T_WHITESPACE"," ",252],["T_CONCAT_EQUAL",".=",252],["T_WHITESPACE"," ",252],["T_STRING","DS",252],["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_VARIABLE","$fileHash",252],["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'.'",252],["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_VARIABLE","$extension",252],";",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$fileFullPath",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getQuoteTargetDir",253],"(",")",["T_WHITESPACE"," ",253],".",["T_WHITESPACE"," ",253],["T_VARIABLE","$filePath",253],";",["T_WHITESPACE","\n\n            ",253],["T_VARIABLE","$upload",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","addFilter",255],"(",["T_CONSTANT_ENCAPSED_STRING","'Rename'",255],",",["T_WHITESPACE"," ",255],["T_ARRAY","array",255],"(",["T_WHITESPACE","\n                ",255],["T_CONSTANT_ENCAPSED_STRING","'target'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$fileFullPath",256],",",["T_WHITESPACE","\n                ",256],["T_CONSTANT_ENCAPSED_STRING","'overwrite'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],["T_STRING","true",257],["T_WHITESPACE","\n            ",257],")",")",";",["T_WHITESPACE","\n\n            ",258],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getProduct",260],"(",")",["T_OBJECT_OPERATOR","->",260],["T_STRING","getTypeInstance",260],"(",["T_STRING","true",260],")",["T_OBJECT_OPERATOR","->",260],["T_STRING","addFileQueue",260],"(",["T_ARRAY","array",260],"(",["T_WHITESPACE","\n                ",260],["T_CONSTANT_ENCAPSED_STRING","'operation'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'receive_uploaded_file'",261],",",["T_WHITESPACE","\n                ",261],["T_CONSTANT_ENCAPSED_STRING","'src_name'",262],["T_WHITESPACE","  ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$file",262],",",["T_WHITESPACE","\n                ",262],["T_CONSTANT_ENCAPSED_STRING","'dst_name'",263],["T_WHITESPACE","  ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$fileFullPath",263],",",["T_WHITESPACE","\n                ",263],["T_CONSTANT_ENCAPSED_STRING","'uploader'",264],["T_WHITESPACE","  ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$upload",264],",",["T_WHITESPACE","\n                ",264],["T_CONSTANT_ENCAPSED_STRING","'option'",265],["T_WHITESPACE","    ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],",",["T_WHITESPACE","\n            ",265],")",")",";",["T_WHITESPACE","\n\n            ",266],["T_VARIABLE","$_width",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_LNUMBER","0",268],";",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$_height",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_LNUMBER","0",269],";",["T_WHITESPACE","\n            ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_STRING","is_readable",270],"(",["T_VARIABLE","$fileInfo",270],"[",["T_CONSTANT_ENCAPSED_STRING","'tmp_name'",270],"]",")",")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n                ",270],["T_VARIABLE","$_imageSize",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING","getimagesize",271],"(",["T_VARIABLE","$fileInfo",271],"[",["T_CONSTANT_ENCAPSED_STRING","'tmp_name'",271],"]",")",";",["T_WHITESPACE","\n                ",271],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$_imageSize",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n                    ",272],["T_VARIABLE","$_width",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$_imageSize",273],"[",["T_LNUMBER","0",273],"]",";",["T_WHITESPACE","\n                    ",273],["T_VARIABLE","$_height",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$_imageSize",274],"[",["T_LNUMBER","1",274],"]",";",["T_WHITESPACE","\n                ",274],"}",["T_WHITESPACE","\n            ",275],"}",["T_WHITESPACE","\n\n            ",276],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","setUserValue",278],"(",["T_ARRAY","array",278],"(",["T_WHITESPACE","\n                ",278],["T_CONSTANT_ENCAPSED_STRING","'type'",279],["T_WHITESPACE","          ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$fileInfo",279],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",279],"]",",",["T_WHITESPACE","\n                ",279],["T_CONSTANT_ENCAPSED_STRING","'title'",280],["T_WHITESPACE","         ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$fileInfo",280],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",280],"]",",",["T_WHITESPACE","\n                ",280],["T_CONSTANT_ENCAPSED_STRING","'quote_path'",281],["T_WHITESPACE","    ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getQuoteTargetDir",281],"(",["T_STRING","true",281],")",["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_VARIABLE","$filePath",281],",",["T_WHITESPACE","\n                ",281],["T_CONSTANT_ENCAPSED_STRING","'order_path'",282],["T_WHITESPACE","    ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getOrderTargetDir",282],"(",["T_STRING","true",282],")",["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_VARIABLE","$filePath",282],",",["T_WHITESPACE","\n                ",282],["T_CONSTANT_ENCAPSED_STRING","'fullpath'",283],["T_WHITESPACE","      ",283],["T_DOUBLE_ARROW","=>",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$fileFullPath",283],",",["T_WHITESPACE","\n                ",283],["T_CONSTANT_ENCAPSED_STRING","'size'",284],["T_WHITESPACE","          ",284],["T_DOUBLE_ARROW","=>",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$fileInfo",284],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",284],"]",",",["T_WHITESPACE","\n                ",284],["T_CONSTANT_ENCAPSED_STRING","'width'",285],["T_WHITESPACE","         ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$_width",285],",",["T_WHITESPACE","\n                ",285],["T_CONSTANT_ENCAPSED_STRING","'height'",286],["T_WHITESPACE","        ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$_height",286],",",["T_WHITESPACE","\n                ",286],["T_CONSTANT_ENCAPSED_STRING","'secret_key'",287],["T_WHITESPACE","    ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_STRING","substr",287],"(",["T_VARIABLE","$fileHash",287],",",["T_WHITESPACE"," ",287],["T_LNUMBER","0",287],",",["T_WHITESPACE"," ",287],["T_LNUMBER","20",287],")",",",["T_WHITESPACE","\n            ",287],")",")",";",["T_WHITESPACE","\n\n        ",288],"}",["T_WHITESPACE"," ",290],["T_ELSEIF","elseif",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$upload",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getErrors",290],"(",")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n            ",290],["T_VARIABLE","$errors",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_getValidatorErrors",291],"(",["T_VARIABLE","$upload",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getErrors",291],"(",")",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$fileInfo",291],")",";",["T_WHITESPACE","\n\n            ",291],["T_IF","if",293],["T_WHITESPACE"," ",293],"(",["T_STRING","count",293],"(",["T_VARIABLE","$errors",293],")",["T_WHITESPACE"," ",293],">",["T_WHITESPACE"," ",293],["T_LNUMBER","0",293],")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n                ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","setIsValid",294],"(",["T_STRING","false",294],")",";",["T_WHITESPACE","\n                ",294],["T_STRING","Mage",295],["T_DOUBLE_COLON","::",295],["T_STRING","throwException",295],"(",["T_WHITESPACE"," ",295],["T_STRING","implode",295],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",295],",",["T_WHITESPACE"," ",295],["T_VARIABLE","$errors",295],")",["T_WHITESPACE"," ",295],")",";",["T_WHITESPACE","\n            ",295],"}",["T_WHITESPACE","\n        ",296],"}",["T_WHITESPACE"," ",297],["T_ELSE","else",297],["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","setIsValid",298],"(",["T_STRING","false",298],")",";",["T_WHITESPACE","\n            ",298],["T_STRING","Mage",299],["T_DOUBLE_COLON","::",299],["T_STRING","throwException",299],"(",["T_STRING","Mage",299],["T_DOUBLE_COLON","::",299],["T_STRING","helper",299],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",299],")",["T_OBJECT_OPERATOR","->",299],["T_STRING","__",299],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify the product required option(s)'",299],")",")",";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Validate file\n     *\n     * @throws Mage_Core_Exception\n     * @param array $optionValue\n     * @return Mage_Catalog_Model_Product_Option_Type_Default\n     *\/",304],["T_WHITESPACE","\n    ",310],["T_PROTECTED","protected",311],["T_WHITESPACE"," ",311],["T_FUNCTION","function",311],["T_WHITESPACE"," ",311],["T_STRING","_validateFile",311],"(",["T_VARIABLE","$optionValue",311],")",["T_WHITESPACE","\n    ",311],"{",["T_WHITESPACE","\n        ",312],["T_VARIABLE","$option",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getOption",313],"(",")",";",["T_WHITESPACE","\n        ",313],["T_DOC_COMMENT","\/**\n         * @see Mage_Catalog_Model_Product_Option_Type_File::_validateUploadFile()\n         *              There setUserValue() sets correct fileFullPath only for\n         *              quote_path. So we must form both full paths manually and\n         *              check them.\n         *\/",314],["T_WHITESPACE","\n        ",319],["T_VARIABLE","$checkPaths",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_ARRAY","array",320],"(",")",";",["T_WHITESPACE","\n        ",320],["T_IF","if",321],["T_WHITESPACE"," ",321],"(",["T_ISSET","isset",321],"(",["T_VARIABLE","$optionValue",321],"[",["T_CONSTANT_ENCAPSED_STRING","'quote_path'",321],"]",")",")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n            ",321],["T_VARIABLE","$checkPaths",322],"[","]",["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_STRING","Mage",322],["T_DOUBLE_COLON","::",322],["T_STRING","getBaseDir",322],"(",")",["T_WHITESPACE"," ",322],".",["T_WHITESPACE"," ",322],["T_VARIABLE","$optionValue",322],"[",["T_CONSTANT_ENCAPSED_STRING","'quote_path'",322],"]",";",["T_WHITESPACE","\n        ",322],"}",["T_WHITESPACE","\n        ",323],["T_IF","if",324],["T_WHITESPACE"," ",324],"(",["T_ISSET","isset",324],"(",["T_VARIABLE","$optionValue",324],"[",["T_CONSTANT_ENCAPSED_STRING","'order_path'",324],"]",")",["T_WHITESPACE"," ",324],["T_BOOLEAN_AND","&&",324],["T_WHITESPACE"," ",324],"!",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getUseQuotePath",324],"(",")",")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_VARIABLE","$checkPaths",325],"[","]",["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_STRING","Mage",325],["T_DOUBLE_COLON","::",325],["T_STRING","getBaseDir",325],"(",")",["T_WHITESPACE"," ",325],".",["T_WHITESPACE"," ",325],["T_VARIABLE","$optionValue",325],"[",["T_CONSTANT_ENCAPSED_STRING","'order_path'",325],"]",";",["T_WHITESPACE","\n        ",325],"}",["T_WHITESPACE","\n\n        ",326],["T_VARIABLE","$fileFullPath",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_STRING","null",328],";",["T_WHITESPACE","\n        ",328],["T_FOREACH","foreach",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$checkPaths",329],["T_WHITESPACE"," ",329],["T_AS","as",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$path",329],")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n            ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(","!",["T_STRING","is_file",330],"(",["T_VARIABLE","$path",330],")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n                ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(","!",["T_STRING","Mage",331],["T_DOUBLE_COLON","::",331],["T_STRING","helper",331],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",331],")",["T_OBJECT_OPERATOR","->",331],["T_STRING","saveFileToFilesystem",331],"(",["T_VARIABLE","$fileFullPath",331],")",")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n                    ",331],["T_CONTINUE","continue",332],";",["T_WHITESPACE","\n                ",332],"}",["T_WHITESPACE","\n            ",333],"}",["T_WHITESPACE","\n            ",334],["T_VARIABLE","$fileFullPath",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_VARIABLE","$path",335],";",["T_WHITESPACE","\n            ",335],["T_BREAK","break",336],";",["T_WHITESPACE","\n        ",336],"}",["T_WHITESPACE","\n\n        ",337],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$fileFullPath",339],["T_WHITESPACE"," ",339],["T_IS_IDENTICAL","===",339],["T_WHITESPACE"," ",339],["T_STRING","null",339],")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_RETURN","return",340],["T_WHITESPACE"," ",340],["T_STRING","false",340],";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE","\n\n        ",341],["T_VARIABLE","$validatorChain",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_NEW","new",343],["T_WHITESPACE"," ",343],["T_STRING","Zend_Validate",343],"(",")",";",["T_WHITESPACE","\n\n        ",343],["T_VARIABLE","$_dimentions",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_ARRAY","array",345],"(",")",";",["T_WHITESPACE","\n\n        ",345],["T_IF","if",347],["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$option",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getImageSizeX",347],"(",")",["T_WHITESPACE"," ",347],">",["T_WHITESPACE"," ",347],["T_LNUMBER","0",347],")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$_dimentions",348],"[",["T_CONSTANT_ENCAPSED_STRING","'maxwidth'",348],"]",["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$option",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getImageSizeX",348],"(",")",";",["T_WHITESPACE","\n        ",348],"}",["T_WHITESPACE","\n        ",349],["T_IF","if",350],["T_WHITESPACE"," ",350],"(",["T_VARIABLE","$option",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getImageSizeY",350],"(",")",["T_WHITESPACE"," ",350],">",["T_WHITESPACE"," ",350],["T_LNUMBER","0",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_VARIABLE","$_dimentions",351],"[",["T_CONSTANT_ENCAPSED_STRING","'maxheight'",351],"]",["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$option",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getImageSizeY",351],"(",")",";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n        ",352],["T_IF","if",353],["T_WHITESPACE"," ",353],"(",["T_STRING","count",353],"(",["T_VARIABLE","$_dimentions",353],")",["T_WHITESPACE"," ",353],">",["T_WHITESPACE"," ",353],["T_LNUMBER","0",353],["T_WHITESPACE"," ",353],["T_BOOLEAN_AND","&&",353],["T_WHITESPACE"," ",353],"!",["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","_isImage",353],"(",["T_VARIABLE","$fileFullPath",353],")",")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n            ",353],["T_RETURN","return",354],["T_WHITESPACE"," ",354],["T_STRING","false",354],";",["T_WHITESPACE","\n        ",354],"}",["T_WHITESPACE","\n        ",355],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_STRING","count",356],"(",["T_VARIABLE","$_dimentions",356],")",["T_WHITESPACE"," ",356],">",["T_WHITESPACE"," ",356],["T_LNUMBER","0",356],")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$validatorChain",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","addValidator",357],"(",["T_WHITESPACE","\n                ",357],["T_NEW","new",358],["T_WHITESPACE"," ",358],["T_STRING","Zend_Validate_File_ImageSize",358],"(",["T_VARIABLE","$_dimentions",358],")",["T_WHITESPACE","\n            ",358],")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n\n        ",360],["T_COMMENT","\/\/ File extension\n",362],["T_WHITESPACE","        ",363],["T_VARIABLE","$_allowed",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_parseExtensionsString",363],"(",["T_VARIABLE","$option",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getFileExtension",363],"(",")",")",";",["T_WHITESPACE","\n        ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(",["T_VARIABLE","$_allowed",364],["T_WHITESPACE"," ",364],["T_IS_NOT_IDENTICAL","!==",364],["T_WHITESPACE"," ",364],["T_STRING","null",364],")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_VARIABLE","$validatorChain",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","addValidator",365],"(",["T_NEW","new",365],["T_WHITESPACE"," ",365],["T_STRING","Zend_Validate_File_Extension",365],"(",["T_VARIABLE","$_allowed",365],")",")",";",["T_WHITESPACE","\n        ",365],"}",["T_WHITESPACE"," ",366],["T_ELSE","else",366],["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$_forbidden",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_parseExtensionsString",367],"(",["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","getConfigData",367],"(",["T_CONSTANT_ENCAPSED_STRING","'forbidden_extensions'",367],")",")",";",["T_WHITESPACE","\n            ",367],["T_IF","if",368],["T_WHITESPACE"," ",368],"(",["T_VARIABLE","$_forbidden",368],["T_WHITESPACE"," ",368],["T_IS_NOT_IDENTICAL","!==",368],["T_WHITESPACE"," ",368],["T_STRING","null",368],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n                ",368],["T_VARIABLE","$validatorChain",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","addValidator",369],"(",["T_NEW","new",369],["T_WHITESPACE"," ",369],["T_STRING","Zend_Validate_File_ExcludeExtension",369],"(",["T_VARIABLE","$_forbidden",369],")",")",";",["T_WHITESPACE","\n            ",369],"}",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n\n        ",371],["T_COMMENT","\/\/ Maximum filesize\n",373],["T_WHITESPACE","        ",374],["T_VARIABLE","$validatorChain",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","addValidator",374],"(",["T_WHITESPACE","\n                ",374],["T_NEW","new",375],["T_WHITESPACE"," ",375],["T_STRING","Zend_Validate_File_FilesSize",375],"(",["T_ARRAY","array",375],"(",["T_CONSTANT_ENCAPSED_STRING","'max'",375],["T_WHITESPACE"," ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_getUploadMaxFilesize",375],"(",")",")",")",["T_WHITESPACE","\n        ",375],")",";",["T_WHITESPACE","\n\n\n        ",376],["T_IF","if",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$validatorChain",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","isValid",379],"(",["T_VARIABLE","$fileFullPath",379],")",")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$ok",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_STRING","is_readable",380],"(",["T_VARIABLE","$fileFullPath",380],")",["T_WHITESPACE","\n                ",380],["T_BOOLEAN_AND","&&",381],["T_WHITESPACE"," ",381],["T_ISSET","isset",381],"(",["T_VARIABLE","$optionValue",381],"[",["T_CONSTANT_ENCAPSED_STRING","'secret_key'",381],"]",")",["T_WHITESPACE","\n                ",381],["T_BOOLEAN_AND","&&",382],["T_WHITESPACE"," ",382],["T_STRING","substr",382],"(",["T_STRING","md5",382],"(",["T_STRING","file_get_contents",382],"(",["T_VARIABLE","$fileFullPath",382],")",")",",",["T_WHITESPACE"," ",382],["T_LNUMBER","0",382],",",["T_WHITESPACE"," ",382],["T_LNUMBER","20",382],")",["T_WHITESPACE"," ",382],["T_IS_EQUAL","==",382],["T_WHITESPACE"," ",382],["T_VARIABLE","$optionValue",382],"[",["T_CONSTANT_ENCAPSED_STRING","'secret_key'",382],"]",";",["T_WHITESPACE","\n\n            ",382],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$ok",384],";",["T_WHITESPACE","\n        ",384],"}",["T_WHITESPACE"," ",385],["T_ELSEIF","elseif",385],["T_WHITESPACE"," ",385],"(",["T_VARIABLE","$validatorChain",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","getErrors",385],"(",")",")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n            ",385],["T_VARIABLE","$errors",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","_getValidatorErrors",386],"(",["T_VARIABLE","$validatorChain",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getErrors",386],"(",")",",",["T_WHITESPACE"," ",386],["T_VARIABLE","$optionValue",386],")",";",["T_WHITESPACE","\n\n            ",386],["T_IF","if",388],["T_WHITESPACE"," ",388],"(",["T_STRING","count",388],"(",["T_VARIABLE","$errors",388],")",["T_WHITESPACE"," ",388],">",["T_WHITESPACE"," ",388],["T_LNUMBER","0",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","setIsValid",389],"(",["T_STRING","false",389],")",";",["T_WHITESPACE","\n                ",389],["T_STRING","Mage",390],["T_DOUBLE_COLON","::",390],["T_STRING","throwException",390],"(",["T_WHITESPACE"," ",390],["T_STRING","implode",390],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$errors",390],")",["T_WHITESPACE"," ",390],")",";",["T_WHITESPACE","\n            ",390],"}",["T_WHITESPACE","\n        ",391],"}",["T_WHITESPACE"," ",392],["T_ELSE","else",392],["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n            ",392],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","setIsValid",393],"(",["T_STRING","false",393],")",";",["T_WHITESPACE","\n            ",393],["T_STRING","Mage",394],["T_DOUBLE_COLON","::",394],["T_STRING","throwException",394],"(",["T_STRING","Mage",394],["T_DOUBLE_COLON","::",394],["T_STRING","helper",394],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",394],")",["T_OBJECT_OPERATOR","->",394],["T_STRING","__",394],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify the product required option(s)'",394],")",")",";",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n    ",395],"}",["T_WHITESPACE","\n\n    ",396],["T_DOC_COMMENT","\/**\n     * Get Error messages for validator Errors\n     * @param array $errors Array of validation failure message codes @see Zend_Validate::getErrors()\n     * @param array $fileInfo File info\n     * @return array Array of error messages\n     *\/",398],["T_WHITESPACE","\n    ",403],["T_PROTECTED","protected",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","_getValidatorErrors",404],"(",["T_VARIABLE","$errors",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$fileInfo",404],")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_VARIABLE","$option",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getOption",406],"(",")",";",["T_WHITESPACE","\n        ",406],["T_VARIABLE","$result",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_ARRAY","array",407],"(",")",";",["T_WHITESPACE","\n        ",407],["T_FOREACH","foreach",408],["T_WHITESPACE"," ",408],"(",["T_VARIABLE","$errors",408],["T_WHITESPACE"," ",408],["T_AS","as",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$errorCode",408],")",["T_WHITESPACE"," ",408],"{",["T_WHITESPACE","\n            ",408],["T_IF","if",409],["T_WHITESPACE"," ",409],"(",["T_VARIABLE","$errorCode",409],["T_WHITESPACE"," ",409],["T_IS_EQUAL","==",409],["T_WHITESPACE"," ",409],["T_STRING","Zend_Validate_File_ExcludeExtension",409],["T_DOUBLE_COLON","::",409],["T_STRING","FALSE_EXTENSION",409],")",["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n                ",409],["T_VARIABLE","$result",410],"[","]",["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_STRING","Mage",410],["T_DOUBLE_COLON","::",410],["T_STRING","helper",410],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",410],")",["T_OBJECT_OPERATOR","->",410],["T_STRING","__",410],"(",["T_CONSTANT_ENCAPSED_STRING","\"The file '%s' for '%s' has an invalid extension\"",410],",",["T_WHITESPACE"," ",410],["T_VARIABLE","$fileInfo",410],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",410],"]",",",["T_WHITESPACE"," ",410],["T_VARIABLE","$option",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","getTitle",410],"(",")",")",";",["T_WHITESPACE","\n            ",410],"}",["T_WHITESPACE"," ",411],["T_ELSEIF","elseif",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$errorCode",411],["T_WHITESPACE"," ",411],["T_IS_EQUAL","==",411],["T_WHITESPACE"," ",411],["T_STRING","Zend_Validate_File_Extension",411],["T_DOUBLE_COLON","::",411],["T_STRING","FALSE_EXTENSION",411],")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n                ",411],["T_VARIABLE","$result",412],"[","]",["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_STRING","Mage",412],["T_DOUBLE_COLON","::",412],["T_STRING","helper",412],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",412],")",["T_OBJECT_OPERATOR","->",412],["T_STRING","__",412],"(",["T_CONSTANT_ENCAPSED_STRING","\"The file '%s' for '%s' has an invalid extension\"",412],",",["T_WHITESPACE"," ",412],["T_VARIABLE","$fileInfo",412],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",412],"]",",",["T_WHITESPACE"," ",412],["T_VARIABLE","$option",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","getTitle",412],"(",")",")",";",["T_WHITESPACE","\n            ",412],"}",["T_WHITESPACE"," ",413],["T_ELSEIF","elseif",413],["T_WHITESPACE"," ",413],"(",["T_VARIABLE","$errorCode",413],["T_WHITESPACE"," ",413],["T_IS_EQUAL","==",413],["T_WHITESPACE"," ",413],["T_STRING","Zend_Validate_File_ImageSize",413],["T_DOUBLE_COLON","::",413],["T_STRING","WIDTH_TOO_BIG",413],["T_WHITESPACE","\n                ",413],["T_BOOLEAN_OR","||",414],["T_WHITESPACE"," ",414],["T_VARIABLE","$errorCode",414],["T_WHITESPACE"," ",414],["T_IS_EQUAL","==",414],["T_WHITESPACE"," ",414],["T_STRING","Zend_Validate_File_ImageSize",414],["T_DOUBLE_COLON","::",414],["T_STRING","HEIGHT_TOO_BIG",414],")",["T_WHITESPACE","\n            ",414],"{",["T_WHITESPACE","\n                ",415],["T_VARIABLE","$result",416],"[","]",["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_STRING","Mage",416],["T_DOUBLE_COLON","::",416],["T_STRING","helper",416],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",416],")",["T_OBJECT_OPERATOR","->",416],["T_STRING","__",416],"(",["T_CONSTANT_ENCAPSED_STRING","\"Maximum allowed image size for '%s' is %sx%s px.\"",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$option",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","getTitle",416],"(",")",",",["T_WHITESPACE"," ",416],["T_VARIABLE","$option",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","getImageSizeX",416],"(",")",",",["T_WHITESPACE"," ",416],["T_VARIABLE","$option",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","getImageSizeY",416],"(",")",")",";",["T_WHITESPACE","\n            ",416],"}",["T_WHITESPACE"," ",417],["T_ELSEIF","elseif",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$errorCode",417],["T_WHITESPACE"," ",417],["T_IS_EQUAL","==",417],["T_WHITESPACE"," ",417],["T_STRING","Zend_Validate_File_FilesSize",417],["T_DOUBLE_COLON","::",417],["T_STRING","TOO_BIG",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n                ",417],["T_VARIABLE","$result",418],"[","]",["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_STRING","Mage",418],["T_DOUBLE_COLON","::",418],["T_STRING","helper",418],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",418],")",["T_OBJECT_OPERATOR","->",418],["T_STRING","__",418],"(",["T_CONSTANT_ENCAPSED_STRING","\"The file '%s' you uploaded is larger than %s Megabytes allowed by server\"",418],",",["T_WHITESPACE"," ",418],["T_VARIABLE","$fileInfo",418],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",418],"]",",",["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_bytesToMbytes",418],"(",["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_getUploadMaxFilesize",418],"(",")",")",")",";",["T_WHITESPACE","\n            ",418],"}",["T_WHITESPACE","\n        ",419],"}",["T_WHITESPACE","\n        ",420],["T_RETURN","return",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$result",421],";",["T_WHITESPACE","\n    ",421],"}",["T_WHITESPACE","\n\n    ",422],["T_DOC_COMMENT","\/**\n     * Prepare option value for cart\n     *\n     * @return mixed Prepared option value\n     *\/",424],["T_WHITESPACE","\n    ",428],["T_PUBLIC","public",429],["T_WHITESPACE"," ",429],["T_FUNCTION","function",429],["T_WHITESPACE"," ",429],["T_STRING","prepareForCart",429],"(",")",["T_WHITESPACE","\n    ",429],"{",["T_WHITESPACE","\n        ",430],["T_VARIABLE","$option",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","getOption",431],"(",")",";",["T_WHITESPACE","\n        ",431],["T_VARIABLE","$optionId",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$option",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getId",432],"(",")",";",["T_WHITESPACE","\n        ",432],["T_VARIABLE","$buyRequest",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","getRequest",433],"(",")",";",["T_WHITESPACE","\n\n        ",433],["T_COMMENT","\/\/ Prepare value and fill buyRequest with option\n",435],["T_WHITESPACE","        ",436],["T_VARIABLE","$requestOptions",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$buyRequest",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","getOptions",436],"(",")",";",["T_WHITESPACE","\n        ",436],["T_IF","if",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","getIsValid",437],"(",")",["T_WHITESPACE"," ",437],["T_BOOLEAN_AND","&&",437],["T_WHITESPACE"," ",437],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","getUserValue",437],"(",")",["T_WHITESPACE"," ",437],["T_IS_NOT_IDENTICAL","!==",437],["T_WHITESPACE"," ",437],["T_STRING","null",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n            ",437],["T_VARIABLE","$value",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","getUserValue",438],"(",")",";",["T_WHITESPACE","\n\n            ",438],["T_COMMENT","\/\/ Save option in request, because we have no $_FILES['options']\n",440],["T_WHITESPACE","            ",441],["T_VARIABLE","$requestOptions",441],"[",["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getOption",441],"(",")",["T_OBJECT_OPERATOR","->",441],["T_STRING","getId",441],"(",")","]",["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_VARIABLE","$value",441],";",["T_WHITESPACE","\n            ",441],["T_VARIABLE","$result",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_STRING","serialize",442],"(",["T_VARIABLE","$value",442],")",";",["T_WHITESPACE","\n            ",442],["T_TRY","try",443],["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n                ",443],["T_STRING","Mage",444],["T_DOUBLE_COLON","::",444],["T_STRING","helper",444],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",444],")",["T_OBJECT_OPERATOR","->",444],["T_STRING","unserialize",444],"(",["T_VARIABLE","$result",444],")",";",["T_WHITESPACE","\n            ",444],"}",["T_WHITESPACE"," ",445],["T_CATCH","catch",445],["T_WHITESPACE"," ",445],"(",["T_STRING","Exception",445],["T_WHITESPACE"," ",445],["T_VARIABLE","$e",445],")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n                ",445],["T_STRING","Mage",446],["T_DOUBLE_COLON","::",446],["T_STRING","throwException",446],"(",["T_STRING","Mage",446],["T_DOUBLE_COLON","::",446],["T_STRING","helper",446],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",446],")",["T_OBJECT_OPERATOR","->",446],["T_STRING","__",446],"(",["T_CONSTANT_ENCAPSED_STRING","\"File options format is not valid.\"",446],")",")",";",["T_WHITESPACE","\n            ",446],"}",["T_WHITESPACE","\n        ",447],"}",["T_WHITESPACE"," ",448],["T_ELSE","else",448],["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n            ",448],["T_COMMENT","\/*\n             * Clear option info from request, so it won't be stored in our db upon\n             * unsuccessful validation. Otherwise some bad file data can happen in buyRequest\n             * and be used later in reorders and reconfigurations.\n             *\/",449],["T_WHITESPACE","\n            ",453],["T_IF","if",454],["T_WHITESPACE"," ",454],"(",["T_STRING","is_array",454],"(",["T_VARIABLE","$requestOptions",454],")",")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n                ",454],["T_UNSET","unset",455],"(",["T_VARIABLE","$requestOptions",455],"[",["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getOption",455],"(",")",["T_OBJECT_OPERATOR","->",455],["T_STRING","getId",455],"(",")","]",")",";",["T_WHITESPACE","\n            ",455],"}",["T_WHITESPACE","\n            ",456],["T_VARIABLE","$result",457],["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_STRING","null",457],";",["T_WHITESPACE","\n        ",457],"}",["T_WHITESPACE","\n        ",458],["T_VARIABLE","$buyRequest",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","setOptions",459],"(",["T_VARIABLE","$requestOptions",459],")",";",["T_WHITESPACE","\n\n        ",459],["T_COMMENT","\/\/ Clear action key from buy request - we won't need it anymore\n",461],["T_WHITESPACE","        ",462],["T_VARIABLE","$optionActionKey",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_CONSTANT_ENCAPSED_STRING","'options_'",462],["T_WHITESPACE"," ",462],".",["T_WHITESPACE"," ",462],["T_VARIABLE","$optionId",462],["T_WHITESPACE"," ",462],".",["T_WHITESPACE"," ",462],["T_CONSTANT_ENCAPSED_STRING","'_file_action'",462],";",["T_WHITESPACE","\n        ",462],["T_VARIABLE","$buyRequest",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","unsetData",463],"(",["T_VARIABLE","$optionActionKey",463],")",";",["T_WHITESPACE","\n\n        ",463],["T_RETURN","return",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$result",465],";",["T_WHITESPACE","\n    ",465],"}",["T_WHITESPACE","\n\n    ",466],["T_DOC_COMMENT","\/**\n     * Return formatted option value for quote option\n     *\n     * @param string $optionValue Prepared for cart option value\n     * @return string\n     *\/",468],["T_WHITESPACE","\n    ",473],["T_PUBLIC","public",474],["T_WHITESPACE"," ",474],["T_FUNCTION","function",474],["T_WHITESPACE"," ",474],["T_STRING","getFormattedOptionValue",474],"(",["T_VARIABLE","$optionValue",474],")",["T_WHITESPACE","\n    ",474],"{",["T_WHITESPACE","\n        ",475],["T_IF","if",476],["T_WHITESPACE"," ",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_formattedOptionValue",476],["T_WHITESPACE"," ",476],["T_IS_IDENTICAL","===",476],["T_WHITESPACE"," ",476],["T_STRING","null",476],")",["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n            ",476],["T_TRY","try",477],["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n                ",477],["T_VARIABLE","$value",478],["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],["T_STRING","Mage",478],["T_DOUBLE_COLON","::",478],["T_STRING","helper",478],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",478],")",["T_OBJECT_OPERATOR","->",478],["T_STRING","unserialize",478],"(",["T_VARIABLE","$optionValue",478],")",";",["T_WHITESPACE","\n\n                ",478],["T_VARIABLE","$customOptionUrlParams",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","getCustomOptionUrlParams",480],"(",")",["T_WHITESPACE","\n                    ",480],"?",["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","getCustomOptionUrlParams",481],"(",")",["T_WHITESPACE","\n                    ",481],":",["T_WHITESPACE"," ",482],["T_ARRAY","array",482],"(",["T_WHITESPACE","\n                        ",482],["T_CONSTANT_ENCAPSED_STRING","'id'",483],["T_WHITESPACE","  ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","getConfigurationItemOption",483],"(",")",["T_OBJECT_OPERATOR","->",483],["T_STRING","getId",483],"(",")",",",["T_WHITESPACE","\n                        ",483],["T_CONSTANT_ENCAPSED_STRING","'key'",484],["T_WHITESPACE"," ",484],["T_DOUBLE_ARROW","=>",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$value",484],"[",["T_CONSTANT_ENCAPSED_STRING","'secret_key'",484],"]",["T_WHITESPACE","\n                    ",484],")",";",["T_WHITESPACE","\n\n                ",485],["T_VARIABLE","$value",487],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",487],"]",["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_ARRAY","array",487],"(",["T_CONSTANT_ENCAPSED_STRING","'route'",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","_customOptionDownloadUrl",487],",",["T_WHITESPACE"," ",487],["T_CONSTANT_ENCAPSED_STRING","'params'",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_VARIABLE","$customOptionUrlParams",487],")",";",["T_WHITESPACE","\n\n                ",487],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","_formattedOptionValue",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","_getOptionHtml",489],"(",["T_VARIABLE","$value",489],")",";",["T_WHITESPACE","\n                ",489],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","getConfigurationItemOption",490],"(",")",["T_OBJECT_OPERATOR","->",490],["T_STRING","setValue",490],"(",["T_STRING","serialize",490],"(",["T_VARIABLE","$value",490],")",")",";",["T_WHITESPACE","\n                ",490],["T_RETURN","return",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","_formattedOptionValue",491],";",["T_WHITESPACE","\n            ",491],"}",["T_WHITESPACE"," ",492],["T_CATCH","catch",492],["T_WHITESPACE"," ",492],"(",["T_STRING","Exception",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$e",492],")",["T_WHITESPACE"," ",492],"{",["T_WHITESPACE","\n                ",492],["T_RETURN","return",493],["T_WHITESPACE"," ",493],["T_VARIABLE","$optionValue",493],";",["T_WHITESPACE","\n            ",493],"}",["T_WHITESPACE","\n        ",494],"}",["T_WHITESPACE","\n        ",495],["T_RETURN","return",496],["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","_formattedOptionValue",496],";",["T_WHITESPACE","\n    ",496],"}",["T_WHITESPACE","\n\n    ",497],["T_DOC_COMMENT","\/**\n     * Format File option html\n     *\n     * @param string|array $optionValue Serialized string of option data or its data array\n     * @return string\n     *\/",499],["T_WHITESPACE","\n    ",504],["T_PROTECTED","protected",505],["T_WHITESPACE"," ",505],["T_FUNCTION","function",505],["T_WHITESPACE"," ",505],["T_STRING","_getOptionHtml",505],"(",["T_VARIABLE","$optionValue",505],")",["T_WHITESPACE","\n    ",505],"{",["T_WHITESPACE","\n        ",506],["T_VARIABLE","$value",507],["T_WHITESPACE"," ",507],"=",["T_WHITESPACE"," ",507],["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","_unserializeValue",507],"(",["T_VARIABLE","$optionValue",507],")",";",["T_WHITESPACE","\n        ",507],["T_TRY","try",508],["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_IF","if",509],["T_WHITESPACE"," ",509],"(",["T_ISSET","isset",509],"(",["T_VARIABLE","$value",509],")",["T_WHITESPACE"," ",509],["T_BOOLEAN_AND","&&",509],["T_WHITESPACE"," ",509],["T_ISSET","isset",509],"(",["T_VARIABLE","$value",509],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",509],"]",")",["T_WHITESPACE"," ",509],["T_BOOLEAN_AND","&&",509],["T_WHITESPACE"," ",509],["T_ISSET","isset",509],"(",["T_VARIABLE","$value",509],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",509],"]",")",["T_WHITESPACE","\n                ",509],["T_BOOLEAN_AND","&&",510],["T_WHITESPACE"," ",510],["T_VARIABLE","$value",510],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",510],"]",["T_WHITESPACE"," ",510],">",["T_WHITESPACE"," ",510],["T_LNUMBER","0",510],["T_WHITESPACE"," ",510],["T_BOOLEAN_AND","&&",510],["T_WHITESPACE"," ",510],["T_VARIABLE","$value",510],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",510],"]",["T_WHITESPACE"," ",510],">",["T_WHITESPACE"," ",510],["T_LNUMBER","0",510],["T_WHITESPACE","\n            ",510],")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n                ",511],["T_VARIABLE","$sizes",512],["T_WHITESPACE"," ",512],"=",["T_WHITESPACE"," ",512],["T_VARIABLE","$value",512],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",512],"]",["T_WHITESPACE"," ",512],".",["T_WHITESPACE"," ",512],["T_CONSTANT_ENCAPSED_STRING","' x '",512],["T_WHITESPACE"," ",512],".",["T_WHITESPACE"," ",512],["T_VARIABLE","$value",512],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",512],"]",["T_WHITESPACE"," ",512],".",["T_WHITESPACE"," ",512],["T_CONSTANT_ENCAPSED_STRING","' '",512],["T_WHITESPACE"," ",512],".",["T_WHITESPACE"," ",512],["T_STRING","Mage",512],["T_DOUBLE_COLON","::",512],["T_STRING","helper",512],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",512],")",["T_OBJECT_OPERATOR","->",512],["T_STRING","__",512],"(",["T_CONSTANT_ENCAPSED_STRING","'px.'",512],")",";",["T_WHITESPACE","\n            ",512],"}",["T_WHITESPACE"," ",513],["T_ELSE","else",513],["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n                ",513],["T_VARIABLE","$sizes",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_CONSTANT_ENCAPSED_STRING","''",514],";",["T_WHITESPACE","\n            ",514],"}",["T_WHITESPACE","\n\n            ",515],["T_VARIABLE","$urlRoute",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],"!",["T_EMPTY","empty",517],"(",["T_VARIABLE","$value",517],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",517],"]","[",["T_CONSTANT_ENCAPSED_STRING","'route'",517],"]",")",["T_WHITESPACE"," ",517],"?",["T_WHITESPACE"," ",517],["T_VARIABLE","$value",517],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",517],"]","[",["T_CONSTANT_ENCAPSED_STRING","'route'",517],"]",["T_WHITESPACE"," ",517],":",["T_WHITESPACE"," ",517],["T_CONSTANT_ENCAPSED_STRING","''",517],";",["T_WHITESPACE","\n            ",517],["T_VARIABLE","$urlParams",518],["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],"!",["T_EMPTY","empty",518],"(",["T_VARIABLE","$value",518],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",518],"]","[",["T_CONSTANT_ENCAPSED_STRING","'params'",518],"]",")",["T_WHITESPACE"," ",518],"?",["T_WHITESPACE"," ",518],["T_VARIABLE","$value",518],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",518],"]","[",["T_CONSTANT_ENCAPSED_STRING","'params'",518],"]",["T_WHITESPACE"," ",518],":",["T_WHITESPACE"," ",518],["T_CONSTANT_ENCAPSED_STRING","''",518],";",["T_WHITESPACE","\n            ",518],["T_VARIABLE","$title",519],["T_WHITESPACE"," ",519],"=",["T_WHITESPACE"," ",519],"!",["T_EMPTY","empty",519],"(",["T_VARIABLE","$value",519],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",519],"]",")",["T_WHITESPACE"," ",519],"?",["T_WHITESPACE"," ",519],["T_VARIABLE","$value",519],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",519],"]",["T_WHITESPACE"," ",519],":",["T_WHITESPACE"," ",519],["T_CONSTANT_ENCAPSED_STRING","''",519],";",["T_WHITESPACE","\n\n            ",519],["T_RETURN","return",521],["T_WHITESPACE"," ",521],["T_STRING","sprintf",521],"(",["T_CONSTANT_ENCAPSED_STRING","'<a href=\"%s\" target=\"_blank\">%s<\/a> %s'",521],",",["T_WHITESPACE","\n                ",521],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","_getOptionDownloadUrl",522],"(",["T_VARIABLE","$urlRoute",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$urlParams",522],")",",",["T_WHITESPACE","\n                ",522],["T_STRING","Mage",523],["T_DOUBLE_COLON","::",523],["T_STRING","helper",523],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",523],")",["T_OBJECT_OPERATOR","->",523],["T_STRING","escapeHtml",523],"(",["T_VARIABLE","$title",523],")",",",["T_WHITESPACE","\n                ",523],["T_VARIABLE","$sizes",524],["T_WHITESPACE","\n            ",524],")",";",["T_WHITESPACE","\n        ",525],"}",["T_WHITESPACE"," ",526],["T_CATCH","catch",526],["T_WHITESPACE"," ",526],"(",["T_STRING","Exception",526],["T_WHITESPACE"," ",526],["T_VARIABLE","$e",526],")",["T_WHITESPACE"," ",526],"{",["T_WHITESPACE","\n            ",526],["T_STRING","Mage",527],["T_DOUBLE_COLON","::",527],["T_STRING","throwException",527],"(",["T_STRING","Mage",527],["T_DOUBLE_COLON","::",527],["T_STRING","helper",527],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",527],")",["T_OBJECT_OPERATOR","->",527],["T_STRING","__",527],"(",["T_CONSTANT_ENCAPSED_STRING","\"File options format is not valid.\"",527],")",")",";",["T_WHITESPACE","\n        ",527],"}",["T_WHITESPACE","\n    ",528],"}",["T_WHITESPACE","\n\n    ",529],["T_DOC_COMMENT","\/**\n     * Create a value from a storable representation\n     *\n     * @param mixed $value\n     * @return array\n     *\/",531],["T_WHITESPACE","\n    ",536],["T_PROTECTED","protected",537],["T_WHITESPACE"," ",537],["T_FUNCTION","function",537],["T_WHITESPACE"," ",537],["T_STRING","_unserializeValue",537],"(",["T_VARIABLE","$value",537],")",["T_WHITESPACE","\n    ",537],"{",["T_WHITESPACE","\n        ",538],["T_IF","if",539],["T_WHITESPACE"," ",539],"(",["T_STRING","is_array",539],"(",["T_VARIABLE","$value",539],")",")",["T_WHITESPACE"," ",539],"{",["T_WHITESPACE","\n            ",539],["T_RETURN","return",540],["T_WHITESPACE"," ",540],["T_VARIABLE","$value",540],";",["T_WHITESPACE","\n        ",540],"}",["T_WHITESPACE"," ",541],["T_ELSEIF","elseif",541],["T_WHITESPACE"," ",541],"(",["T_STRING","is_string",541],"(",["T_VARIABLE","$value",541],")",["T_WHITESPACE"," ",541],["T_BOOLEAN_AND","&&",541],["T_WHITESPACE"," ",541],"!",["T_EMPTY","empty",541],"(",["T_VARIABLE","$value",541],")",")",["T_WHITESPACE"," ",541],"{",["T_WHITESPACE","\n            ",541],["T_RETURN","return",542],["T_WHITESPACE"," ",542],["T_STRING","Mage",542],["T_DOUBLE_COLON","::",542],["T_STRING","helper",542],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",542],")",["T_OBJECT_OPERATOR","->",542],["T_STRING","unserialize",542],"(",["T_VARIABLE","$value",542],")",";",["T_WHITESPACE","\n        ",542],"}",["T_WHITESPACE"," ",543],["T_ELSE","else",543],["T_WHITESPACE"," ",543],"{",["T_WHITESPACE","\n            ",543],["T_RETURN","return",544],["T_WHITESPACE"," ",544],["T_ARRAY","array",544],"(",")",";",["T_WHITESPACE","\n        ",544],"}",["T_WHITESPACE","\n    ",545],"}",["T_WHITESPACE","\n\n    ",546],["T_DOC_COMMENT","\/**\n     * Return printable option value\n     *\n     * @param string $optionValue Prepared for cart option value\n     * @return string\n     *\/",548],["T_WHITESPACE","\n    ",553],["T_PUBLIC","public",554],["T_WHITESPACE"," ",554],["T_FUNCTION","function",554],["T_WHITESPACE"," ",554],["T_STRING","getPrintableOptionValue",554],"(",["T_VARIABLE","$optionValue",554],")",["T_WHITESPACE","\n    ",554],"{",["T_WHITESPACE","\n        ",555],["T_RETURN","return",556],["T_WHITESPACE"," ",556],["T_STRING","strip_tags",556],"(",["T_VARIABLE","$this",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","getFormattedOptionValue",556],"(",["T_VARIABLE","$optionValue",556],")",")",";",["T_WHITESPACE","\n    ",556],"}",["T_WHITESPACE","\n\n    ",557],["T_DOC_COMMENT","\/**\n     * Return formatted option value ready to edit, ready to parse\n     *\n     * @param string $optionValue Prepared for cart option value\n     * @return string\n     *\/",559],["T_WHITESPACE","\n    ",564],["T_PUBLIC","public",565],["T_WHITESPACE"," ",565],["T_FUNCTION","function",565],["T_WHITESPACE"," ",565],["T_STRING","getEditableOptionValue",565],"(",["T_VARIABLE","$optionValue",565],")",["T_WHITESPACE","\n    ",565],"{",["T_WHITESPACE","\n        ",566],["T_TRY","try",567],["T_WHITESPACE"," ",567],"{",["T_WHITESPACE","\n            ",567],["T_VARIABLE","$value",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_STRING","Mage",568],["T_DOUBLE_COLON","::",568],["T_STRING","helper",568],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",568],")",["T_OBJECT_OPERATOR","->",568],["T_STRING","unserialize",568],"(",["T_VARIABLE","$optionValue",568],")",";",["T_WHITESPACE","\n            ",568],["T_RETURN","return",569],["T_WHITESPACE"," ",569],["T_STRING","sprintf",569],"(",["T_CONSTANT_ENCAPSED_STRING","'%s [%d]'",569],",",["T_WHITESPACE","\n                ",569],["T_STRING","Mage",570],["T_DOUBLE_COLON","::",570],["T_STRING","helper",570],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",570],")",["T_OBJECT_OPERATOR","->",570],["T_STRING","escapeHtml",570],"(",["T_VARIABLE","$value",570],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",570],"]",")",",",["T_WHITESPACE","\n                ",570],["T_VARIABLE","$this",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","getConfigurationItemOption",571],"(",")",["T_OBJECT_OPERATOR","->",571],["T_STRING","getId",571],"(",")",["T_WHITESPACE","\n            ",571],")",";",["T_WHITESPACE","\n\n        ",572],"}",["T_WHITESPACE"," ",574],["T_CATCH","catch",574],["T_WHITESPACE"," ",574],"(",["T_STRING","Exception",574],["T_WHITESPACE"," ",574],["T_VARIABLE","$e",574],")",["T_WHITESPACE"," ",574],"{",["T_WHITESPACE","\n            ",574],["T_RETURN","return",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$optionValue",575],";",["T_WHITESPACE","\n        ",575],"}",["T_WHITESPACE","\n    ",576],"}",["T_WHITESPACE","\n\n    ",577],["T_DOC_COMMENT","\/**\n     * Parse user input value and return cart prepared value\n     *\n     * @param string $optionValue\n     * @param array $productOptionValues Values for product option\n     * @return string|null\n     *\/",579],["T_WHITESPACE","\n    ",585],["T_PUBLIC","public",586],["T_WHITESPACE"," ",586],["T_FUNCTION","function",586],["T_WHITESPACE"," ",586],["T_STRING","parseOptionValue",586],"(",["T_VARIABLE","$optionValue",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$productOptionValues",586],")",["T_WHITESPACE","\n    ",586],"{",["T_WHITESPACE","\n        ",587],["T_COMMENT","\/\/ search quote item option Id in option value\n",588],["T_WHITESPACE","        ",589],["T_IF","if",589],["T_WHITESPACE"," ",589],"(",["T_STRING","preg_match",589],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\[([0-9]+)\\]\/'",589],",",["T_WHITESPACE"," ",589],["T_VARIABLE","$optionValue",589],",",["T_WHITESPACE"," ",589],["T_VARIABLE","$matches",589],")",")",["T_WHITESPACE"," ",589],"{",["T_WHITESPACE","\n            ",589],["T_VARIABLE","$confItemOptionId",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_VARIABLE","$matches",590],"[",["T_LNUMBER","1",590],"]",";",["T_WHITESPACE","\n            ",590],["T_VARIABLE","$option",591],["T_WHITESPACE"," ",591],"=",["T_WHITESPACE"," ",591],["T_STRING","Mage",591],["T_DOUBLE_COLON","::",591],["T_STRING","getModel",591],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item_option'",591],")",["T_OBJECT_OPERATOR","->",591],["T_STRING","load",591],"(",["T_VARIABLE","$confItemOptionId",591],")",";",["T_WHITESPACE","\n            ",591],["T_TRY","try",592],["T_WHITESPACE"," ",592],"{",["T_WHITESPACE","\n                ",592],["T_RETURN","return",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$option",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","getValue",593],"(",")",";",["T_WHITESPACE","\n            ",593],"}",["T_WHITESPACE"," ",594],["T_CATCH","catch",594],["T_WHITESPACE"," ",594],"(",["T_STRING","Exception",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$e",594],")",["T_WHITESPACE"," ",594],"{",["T_WHITESPACE","\n                ",594],["T_RETURN","return",595],["T_WHITESPACE"," ",595],["T_STRING","null",595],";",["T_WHITESPACE","\n            ",595],"}",["T_WHITESPACE","\n        ",596],"}",["T_WHITESPACE"," ",597],["T_ELSE","else",597],["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n            ",597],["T_RETURN","return",598],["T_WHITESPACE"," ",598],["T_STRING","null",598],";",["T_WHITESPACE","\n        ",598],"}",["T_WHITESPACE","\n    ",599],"}",["T_WHITESPACE","\n\n    ",600],["T_DOC_COMMENT","\/**\n     * Prepare option value for info buy request\n     *\n     * @param string $optionValue\n     * @return mixed\n     *\/",602],["T_WHITESPACE","\n    ",607],["T_PUBLIC","public",608],["T_WHITESPACE"," ",608],["T_FUNCTION","function",608],["T_WHITESPACE"," ",608],["T_STRING","prepareOptionValueForRequest",608],"(",["T_VARIABLE","$optionValue",608],")",["T_WHITESPACE","\n    ",608],"{",["T_WHITESPACE","\n        ",609],["T_TRY","try",610],["T_WHITESPACE"," ",610],"{",["T_WHITESPACE","\n            ",610],["T_VARIABLE","$result",611],["T_WHITESPACE"," ",611],"=",["T_WHITESPACE"," ",611],["T_STRING","Mage",611],["T_DOUBLE_COLON","::",611],["T_STRING","helper",611],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",611],")",["T_OBJECT_OPERATOR","->",611],["T_STRING","unserialize",611],"(",["T_VARIABLE","$optionValue",611],")",";",["T_WHITESPACE","\n            ",611],["T_RETURN","return",612],["T_WHITESPACE"," ",612],["T_VARIABLE","$result",612],";",["T_WHITESPACE","\n        ",612],"}",["T_WHITESPACE"," ",613],["T_CATCH","catch",613],["T_WHITESPACE"," ",613],"(",["T_STRING","Exception",613],["T_WHITESPACE"," ",613],["T_VARIABLE","$e",613],")",["T_WHITESPACE"," ",613],"{",["T_WHITESPACE","\n            ",613],["T_RETURN","return",614],["T_WHITESPACE"," ",614],["T_STRING","null",614],";",["T_WHITESPACE","\n        ",614],"}",["T_WHITESPACE","\n    ",615],"}",["T_WHITESPACE","\n\n    ",616],["T_DOC_COMMENT","\/**\n     * Quote item to order item copy process\n     *\n     * @return Mage_Catalog_Model_Product_Option_Type_File\n     *\/",618],["T_WHITESPACE","\n    ",622],["T_PUBLIC","public",623],["T_WHITESPACE"," ",623],["T_FUNCTION","function",623],["T_WHITESPACE"," ",623],["T_STRING","copyQuoteToOrder",623],"(",")",["T_WHITESPACE","\n    ",623],"{",["T_WHITESPACE","\n        ",624],["T_VARIABLE","$quoteOption",625],["T_WHITESPACE"," ",625],"=",["T_WHITESPACE"," ",625],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","getQuoteItemOption",625],"(",")",";",["T_WHITESPACE","\n        ",625],["T_TRY","try",626],["T_WHITESPACE"," ",626],"{",["T_WHITESPACE","\n            ",626],["T_VARIABLE","$value",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_STRING","Mage",627],["T_DOUBLE_COLON","::",627],["T_STRING","helper",627],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",627],")",["T_OBJECT_OPERATOR","->",627],["T_STRING","unserialize",627],"(",["T_VARIABLE","$quoteOption",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","getValue",627],"(",")",")",";",["T_WHITESPACE","\n            ",627],["T_IF","if",628],["T_WHITESPACE"," ",628],"(","!",["T_ISSET","isset",628],"(",["T_VARIABLE","$value",628],"[",["T_CONSTANT_ENCAPSED_STRING","'quote_path'",628],"]",")",")",["T_WHITESPACE"," ",628],"{",["T_WHITESPACE","\n                ",628],["T_THROW","throw",629],["T_WHITESPACE"," ",629],["T_NEW","new",629],["T_WHITESPACE"," ",629],["T_STRING","Exception",629],"(",")",";",["T_WHITESPACE","\n            ",629],"}",["T_WHITESPACE","\n            ",630],["T_VARIABLE","$quoteFileFullPath",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_STRING","Mage",631],["T_DOUBLE_COLON","::",631],["T_STRING","getBaseDir",631],"(",")",["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_VARIABLE","$value",631],"[",["T_CONSTANT_ENCAPSED_STRING","'quote_path'",631],"]",";",["T_WHITESPACE","\n            ",631],["T_IF","if",632],["T_WHITESPACE"," ",632],"(","!",["T_STRING","is_file",632],"(",["T_VARIABLE","$quoteFileFullPath",632],")",["T_WHITESPACE"," ",632],["T_BOOLEAN_OR","||",632],["T_WHITESPACE"," ",632],"!",["T_STRING","is_readable",632],"(",["T_VARIABLE","$quoteFileFullPath",632],")",")",["T_WHITESPACE"," ",632],"{",["T_WHITESPACE","\n                ",632],["T_THROW","throw",633],["T_WHITESPACE"," ",633],["T_NEW","new",633],["T_WHITESPACE"," ",633],["T_STRING","Exception",633],"(",")",";",["T_WHITESPACE","\n            ",633],"}",["T_WHITESPACE","\n            ",634],["T_VARIABLE","$orderFileFullPath",635],["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_STRING","Mage",635],["T_DOUBLE_COLON","::",635],["T_STRING","getBaseDir",635],"(",")",["T_WHITESPACE"," ",635],".",["T_WHITESPACE"," ",635],["T_VARIABLE","$value",635],"[",["T_CONSTANT_ENCAPSED_STRING","'order_path'",635],"]",";",["T_WHITESPACE","\n            ",635],["T_VARIABLE","$dir",636],["T_WHITESPACE"," ",636],"=",["T_WHITESPACE"," ",636],["T_STRING","pathinfo",636],"(",["T_VARIABLE","$orderFileFullPath",636],",",["T_WHITESPACE"," ",636],["T_STRING","PATHINFO_DIRNAME",636],")",";",["T_WHITESPACE","\n            ",636],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","_createWriteableDir",637],"(",["T_VARIABLE","$dir",637],")",";",["T_WHITESPACE","\n            ",637],["T_STRING","Mage",638],["T_DOUBLE_COLON","::",638],["T_STRING","helper",638],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",638],")",["T_OBJECT_OPERATOR","->",638],["T_STRING","copyFile",638],"(",["T_VARIABLE","$quoteFileFullPath",638],",",["T_WHITESPACE"," ",638],["T_VARIABLE","$orderFileFullPath",638],")",";",["T_WHITESPACE","\n            ",638],"@",["T_STRING","copy",639],"(",["T_VARIABLE","$quoteFileFullPath",639],",",["T_WHITESPACE"," ",639],["T_VARIABLE","$orderFileFullPath",639],")",";",["T_WHITESPACE","\n        ",639],"}",["T_WHITESPACE"," ",640],["T_CATCH","catch",640],["T_WHITESPACE"," ",640],"(",["T_STRING","Exception",640],["T_WHITESPACE"," ",640],["T_VARIABLE","$e",640],")",["T_WHITESPACE"," ",640],"{",["T_WHITESPACE","\n            ",640],["T_RETURN","return",641],["T_WHITESPACE"," ",641],["T_VARIABLE","$this",641],";",["T_WHITESPACE","\n        ",641],"}",["T_WHITESPACE","\n        ",642],["T_RETURN","return",643],["T_WHITESPACE"," ",643],["T_VARIABLE","$this",643],";",["T_WHITESPACE","\n    ",643],"}",["T_WHITESPACE","\n\n    ",644],["T_DOC_COMMENT","\/**\n     * Main Destination directory\n     *\n     * @param boolean $relative If true - returns relative path to the webroot\n     * @return string\n     *\/",646],["T_WHITESPACE","\n    ",651],["T_PUBLIC","public",652],["T_WHITESPACE"," ",652],["T_FUNCTION","function",652],["T_WHITESPACE"," ",652],["T_STRING","getTargetDir",652],"(",["T_VARIABLE","$relative",652],["T_WHITESPACE"," ",652],"=",["T_WHITESPACE"," ",652],["T_STRING","false",652],")",["T_WHITESPACE","\n    ",652],"{",["T_WHITESPACE","\n        ",653],["T_VARIABLE","$fullPath",654],["T_WHITESPACE"," ",654],"=",["T_WHITESPACE"," ",654],["T_STRING","Mage",654],["T_DOUBLE_COLON","::",654],["T_STRING","getBaseDir",654],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",654],")",["T_WHITESPACE"," ",654],".",["T_WHITESPACE"," ",654],["T_STRING","DS",654],["T_WHITESPACE"," ",654],".",["T_WHITESPACE"," ",654],["T_CONSTANT_ENCAPSED_STRING","'custom_options'",654],";",["T_WHITESPACE","\n        ",654],["T_RETURN","return",655],["T_WHITESPACE"," ",655],["T_VARIABLE","$relative",655],["T_WHITESPACE"," ",655],"?",["T_WHITESPACE"," ",655],["T_STRING","str_replace",655],"(",["T_STRING","Mage",655],["T_DOUBLE_COLON","::",655],["T_STRING","getBaseDir",655],"(",")",",",["T_WHITESPACE"," ",655],["T_CONSTANT_ENCAPSED_STRING","''",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$fullPath",655],")",["T_WHITESPACE"," ",655],":",["T_WHITESPACE"," ",655],["T_VARIABLE","$fullPath",655],";",["T_WHITESPACE","\n    ",655],"}",["T_WHITESPACE","\n\n    ",656],["T_DOC_COMMENT","\/**\n     * Quote items destination directory\n     *\n     * @param boolean $relative If true - returns relative path to the webroot\n     * @return string\n     *\/",658],["T_WHITESPACE","\n    ",663],["T_PUBLIC","public",664],["T_WHITESPACE"," ",664],["T_FUNCTION","function",664],["T_WHITESPACE"," ",664],["T_STRING","getQuoteTargetDir",664],"(",["T_VARIABLE","$relative",664],["T_WHITESPACE"," ",664],"=",["T_WHITESPACE"," ",664],["T_STRING","false",664],")",["T_WHITESPACE","\n    ",664],"{",["T_WHITESPACE","\n        ",665],["T_RETURN","return",666],["T_WHITESPACE"," ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","getTargetDir",666],"(",["T_VARIABLE","$relative",666],")",["T_WHITESPACE"," ",666],".",["T_WHITESPACE"," ",666],["T_STRING","DS",666],["T_WHITESPACE"," ",666],".",["T_WHITESPACE"," ",666],["T_CONSTANT_ENCAPSED_STRING","'quote'",666],";",["T_WHITESPACE","\n    ",666],"}",["T_WHITESPACE","\n\n    ",667],["T_DOC_COMMENT","\/**\n     * Order items destination directory\n     *\n     * @param boolean $relative If true - returns relative path to the webroot\n     * @return string\n     *\/",669],["T_WHITESPACE","\n    ",674],["T_PUBLIC","public",675],["T_WHITESPACE"," ",675],["T_FUNCTION","function",675],["T_WHITESPACE"," ",675],["T_STRING","getOrderTargetDir",675],"(",["T_VARIABLE","$relative",675],["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_STRING","false",675],")",["T_WHITESPACE","\n    ",675],"{",["T_WHITESPACE","\n        ",676],["T_RETURN","return",677],["T_WHITESPACE"," ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","getTargetDir",677],"(",["T_VARIABLE","$relative",677],")",["T_WHITESPACE"," ",677],".",["T_WHITESPACE"," ",677],["T_STRING","DS",677],["T_WHITESPACE"," ",677],".",["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'order'",677],";",["T_WHITESPACE","\n    ",677],"}",["T_WHITESPACE","\n\n    ",678],["T_DOC_COMMENT","\/**\n     * Set url to custom option download controller\n     *\n     * @param string $url\n     * @return Mage_Catalog_Model_Product_Option_Type_File\n     *\/",680],["T_WHITESPACE","\n    ",685],["T_PUBLIC","public",686],["T_WHITESPACE"," ",686],["T_FUNCTION","function",686],["T_WHITESPACE"," ",686],["T_STRING","setCustomOptionDownloadUrl",686],"(",["T_VARIABLE","$url",686],")",["T_WHITESPACE","\n    ",686],"{",["T_WHITESPACE","\n        ",687],["T_VARIABLE","$this",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","_customOptionDownloadUrl",688],["T_WHITESPACE"," ",688],"=",["T_WHITESPACE"," ",688],["T_VARIABLE","$url",688],";",["T_WHITESPACE","\n        ",688],["T_RETURN","return",689],["T_WHITESPACE"," ",689],["T_VARIABLE","$this",689],";",["T_WHITESPACE","\n    ",689],"}",["T_WHITESPACE","\n\n    ",690],["T_DOC_COMMENT","\/**\n     * Directory structure initializing\n     *\/",692],["T_WHITESPACE","\n    ",694],["T_PROTECTED","protected",695],["T_WHITESPACE"," ",695],["T_FUNCTION","function",695],["T_WHITESPACE"," ",695],["T_STRING","_initFilesystem",695],"(",")",["T_WHITESPACE","\n    ",695],"{",["T_WHITESPACE","\n        ",696],["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","_createWriteableDir",697],"(",["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","getTargetDir",697],"(",")",")",";",["T_WHITESPACE","\n        ",697],["T_VARIABLE","$this",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","_createWriteableDir",698],"(",["T_VARIABLE","$this",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","getQuoteTargetDir",698],"(",")",")",";",["T_WHITESPACE","\n        ",698],["T_VARIABLE","$this",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","_createWriteableDir",699],"(",["T_VARIABLE","$this",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","getOrderTargetDir",699],"(",")",")",";",["T_WHITESPACE","\n\n        ",699],["T_COMMENT","\/\/ Directory listing and hotlink secure\n",701],["T_WHITESPACE","        ",702],["T_VARIABLE","$io",702],["T_WHITESPACE"," ",702],"=",["T_WHITESPACE"," ",702],["T_NEW","new",702],["T_WHITESPACE"," ",702],["T_STRING","Varien_Io_File",702],"(",")",";",["T_WHITESPACE","\n        ",702],["T_VARIABLE","$io",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","cd",703],"(",["T_VARIABLE","$this",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","getTargetDir",703],"(",")",")",";",["T_WHITESPACE","\n        ",703],["T_IF","if",704],["T_WHITESPACE"," ",704],"(","!",["T_VARIABLE","$io",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","fileExists",704],"(",["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","getTargetDir",704],"(",")",["T_WHITESPACE"," ",704],".",["T_WHITESPACE"," ",704],["T_STRING","DS",704],["T_WHITESPACE"," ",704],".",["T_WHITESPACE"," ",704],["T_CONSTANT_ENCAPSED_STRING","'.htaccess'",704],")",")",["T_WHITESPACE"," ",704],"{",["T_WHITESPACE","\n            ",704],["T_VARIABLE","$io",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","streamOpen",705],"(",["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","getTargetDir",705],"(",")",["T_WHITESPACE"," ",705],".",["T_WHITESPACE"," ",705],["T_STRING","DS",705],["T_WHITESPACE"," ",705],".",["T_WHITESPACE"," ",705],["T_CONSTANT_ENCAPSED_STRING","'.htaccess'",705],")",";",["T_WHITESPACE","\n            ",705],["T_VARIABLE","$io",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","streamLock",706],"(",["T_STRING","true",706],")",";",["T_WHITESPACE","\n            ",706],["T_VARIABLE","$io",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","streamWrite",707],"(",["T_CONSTANT_ENCAPSED_STRING","\"Order deny,allow\\nDeny from all\"",707],")",";",["T_WHITESPACE","\n            ",707],["T_VARIABLE","$io",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","streamUnlock",708],"(",")",";",["T_WHITESPACE","\n            ",708],["T_VARIABLE","$io",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","streamClose",709],"(",")",";",["T_WHITESPACE","\n        ",709],"}",["T_WHITESPACE","\n    ",710],"}",["T_WHITESPACE","\n\n    ",711],["T_DOC_COMMENT","\/**\n     * Create Writeable directory if it doesn't exist\n     *\n     * @param string Absolute directory path\n     * @return void\n     *\/",713],["T_WHITESPACE","\n    ",718],["T_PROTECTED","protected",719],["T_WHITESPACE"," ",719],["T_FUNCTION","function",719],["T_WHITESPACE"," ",719],["T_STRING","_createWriteableDir",719],"(",["T_VARIABLE","$path",719],")",["T_WHITESPACE","\n    ",719],"{",["T_WHITESPACE","\n        ",720],["T_VARIABLE","$io",721],["T_WHITESPACE"," ",721],"=",["T_WHITESPACE"," ",721],["T_NEW","new",721],["T_WHITESPACE"," ",721],["T_STRING","Varien_Io_File",721],"(",")",";",["T_WHITESPACE","\n        ",721],["T_IF","if",722],["T_WHITESPACE"," ",722],"(","!",["T_VARIABLE","$io",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","isWriteable",722],"(",["T_VARIABLE","$path",722],")",["T_WHITESPACE"," ",722],["T_BOOLEAN_AND","&&",722],["T_WHITESPACE"," ",722],"!",["T_VARIABLE","$io",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","mkdir",722],"(",["T_VARIABLE","$path",722],",",["T_WHITESPACE"," ",722],["T_LNUMBER","0777",722],",",["T_WHITESPACE"," ",722],["T_STRING","true",722],")",")",["T_WHITESPACE"," ",722],"{",["T_WHITESPACE","\n            ",722],["T_STRING","Mage",723],["T_DOUBLE_COLON","::",723],["T_STRING","throwException",723],"(",["T_STRING","Mage",723],["T_DOUBLE_COLON","::",723],["T_STRING","helper",723],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",723],")",["T_OBJECT_OPERATOR","->",723],["T_STRING","__",723],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot create writeable directory '%s'.\"",723],",",["T_WHITESPACE"," ",723],["T_VARIABLE","$path",723],")",")",";",["T_WHITESPACE","\n        ",723],"}",["T_WHITESPACE","\n    ",724],"}",["T_WHITESPACE","\n\n    ",725],["T_DOC_COMMENT","\/**\n     * Return URL for option file download\n     *\n     * @return string\n     *\/",727],["T_WHITESPACE","\n    ",731],["T_PROTECTED","protected",732],["T_WHITESPACE"," ",732],["T_FUNCTION","function",732],["T_WHITESPACE"," ",732],["T_STRING","_getOptionDownloadUrl",732],"(",["T_VARIABLE","$route",732],",",["T_WHITESPACE"," ",732],["T_VARIABLE","$params",732],")",["T_WHITESPACE","\n    ",732],"{",["T_WHITESPACE","\n        ",733],["T_RETURN","return",734],["T_WHITESPACE"," ",734],["T_STRING","Mage",734],["T_DOUBLE_COLON","::",734],["T_STRING","getUrl",734],"(",["T_VARIABLE","$route",734],",",["T_WHITESPACE"," ",734],["T_VARIABLE","$params",734],")",";",["T_WHITESPACE","\n    ",734],"}",["T_WHITESPACE","\n\n    ",735],["T_DOC_COMMENT","\/**\n     * Parse file extensions string with various separators\n     *\n     * @param string $extensions String to parse\n     * @return array|null\n     *\/",737],["T_WHITESPACE","\n    ",742],["T_PROTECTED","protected",743],["T_WHITESPACE"," ",743],["T_FUNCTION","function",743],["T_WHITESPACE"," ",743],["T_STRING","_parseExtensionsString",743],"(",["T_VARIABLE","$extensions",743],")",["T_WHITESPACE","\n    ",743],"{",["T_WHITESPACE","\n        ",744],["T_STRING","preg_match_all",745],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[a-z0-9]+\/si'",745],",",["T_WHITESPACE"," ",745],["T_STRING","strtolower",745],"(",["T_VARIABLE","$extensions",745],")",",",["T_WHITESPACE"," ",745],["T_VARIABLE","$matches",745],")",";",["T_WHITESPACE","\n        ",745],["T_IF","if",746],["T_WHITESPACE"," ",746],"(",["T_ISSET","isset",746],"(",["T_VARIABLE","$matches",746],"[",["T_LNUMBER","0",746],"]",")",["T_WHITESPACE"," ",746],["T_BOOLEAN_AND","&&",746],["T_WHITESPACE"," ",746],["T_STRING","is_array",746],"(",["T_VARIABLE","$matches",746],"[",["T_LNUMBER","0",746],"]",")",["T_WHITESPACE"," ",746],["T_BOOLEAN_AND","&&",746],["T_WHITESPACE"," ",746],["T_STRING","count",746],"(",["T_VARIABLE","$matches",746],"[",["T_LNUMBER","0",746],"]",")",["T_WHITESPACE"," ",746],">",["T_WHITESPACE"," ",746],["T_LNUMBER","0",746],")",["T_WHITESPACE"," ",746],"{",["T_WHITESPACE","\n            ",746],["T_RETURN","return",747],["T_WHITESPACE"," ",747],["T_VARIABLE","$matches",747],"[",["T_LNUMBER","0",747],"]",";",["T_WHITESPACE","\n        ",747],"}",["T_WHITESPACE","\n        ",748],["T_RETURN","return",749],["T_WHITESPACE"," ",749],["T_STRING","null",749],";",["T_WHITESPACE","\n    ",749],"}",["T_WHITESPACE","\n\n    ",750],["T_DOC_COMMENT","\/**\n     * Simple check if file is image\n     *\n     * @param array|string $fileInfo - either file data from Zend_File_Transfer or file path\n     * @return boolean\n     *\/",752],["T_WHITESPACE","\n    ",757],["T_PROTECTED","protected",758],["T_WHITESPACE"," ",758],["T_FUNCTION","function",758],["T_WHITESPACE"," ",758],["T_STRING","_isImage",758],"(",["T_VARIABLE","$fileInfo",758],")",["T_WHITESPACE","\n    ",758],"{",["T_WHITESPACE","\n        ",759],["T_COMMENT","\/\/ Maybe array with file info came in\n",760],["T_WHITESPACE","        ",761],["T_IF","if",761],["T_WHITESPACE"," ",761],"(",["T_STRING","is_array",761],"(",["T_VARIABLE","$fileInfo",761],")",")",["T_WHITESPACE"," ",761],"{",["T_WHITESPACE","\n            ",761],["T_RETURN","return",762],["T_WHITESPACE"," ",762],["T_STRING","strstr",762],"(",["T_VARIABLE","$fileInfo",762],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",762],"]",",",["T_WHITESPACE"," ",762],["T_CONSTANT_ENCAPSED_STRING","'image\/'",762],")",";",["T_WHITESPACE","\n        ",762],"}",["T_WHITESPACE","\n\n        ",763],["T_COMMENT","\/\/ File path came in - check the physical file\n",765],["T_WHITESPACE","        ",766],["T_IF","if",766],["T_WHITESPACE"," ",766],"(","!",["T_STRING","is_readable",766],"(",["T_VARIABLE","$fileInfo",766],")",")",["T_WHITESPACE"," ",766],"{",["T_WHITESPACE","\n            ",766],["T_RETURN","return",767],["T_WHITESPACE"," ",767],["T_STRING","false",767],";",["T_WHITESPACE","\n        ",767],"}",["T_WHITESPACE","\n        ",768],["T_VARIABLE","$imageInfo",769],["T_WHITESPACE"," ",769],"=",["T_WHITESPACE"," ",769],["T_STRING","getimagesize",769],"(",["T_VARIABLE","$fileInfo",769],")",";",["T_WHITESPACE","\n        ",769],["T_IF","if",770],["T_WHITESPACE"," ",770],"(","!",["T_VARIABLE","$imageInfo",770],")",["T_WHITESPACE"," ",770],"{",["T_WHITESPACE","\n            ",770],["T_RETURN","return",771],["T_WHITESPACE"," ",771],["T_STRING","false",771],";",["T_WHITESPACE","\n        ",771],"}",["T_WHITESPACE","\n        ",772],["T_RETURN","return",773],["T_WHITESPACE"," ",773],["T_STRING","true",773],";",["T_WHITESPACE","\n    ",773],"}",["T_WHITESPACE","\n\n    ",774],["T_DOC_COMMENT","\/**\n     * Max upload filesize in bytes\n     *\n     * @return int\n     *\/",776],["T_WHITESPACE","\n    ",780],["T_PROTECTED","protected",781],["T_WHITESPACE"," ",781],["T_FUNCTION","function",781],["T_WHITESPACE"," ",781],["T_STRING","_getUploadMaxFilesize",781],"(",")",["T_WHITESPACE","\n    ",781],"{",["T_WHITESPACE","\n        ",782],["T_RETURN","return",783],["T_WHITESPACE"," ",783],["T_STRING","min",783],"(",["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","_getBytesIniValue",783],"(",["T_CONSTANT_ENCAPSED_STRING","'upload_max_filesize'",783],")",",",["T_WHITESPACE"," ",783],["T_VARIABLE","$this",783],["T_OBJECT_OPERATOR","->",783],["T_STRING","_getBytesIniValue",783],"(",["T_CONSTANT_ENCAPSED_STRING","'post_max_size'",783],")",")",";",["T_WHITESPACE","\n    ",783],"}",["T_WHITESPACE","\n\n    ",784],["T_DOC_COMMENT","\/**\n     * Return php.ini setting value in bytes\n     *\n     * @param string $ini_key php.ini Var name\n     * @return int Setting value\n     *\/",786],["T_WHITESPACE","\n    ",791],["T_PROTECTED","protected",792],["T_WHITESPACE"," ",792],["T_FUNCTION","function",792],["T_WHITESPACE"," ",792],["T_STRING","_getBytesIniValue",792],"(",["T_VARIABLE","$ini_key",792],")",["T_WHITESPACE","\n    ",792],"{",["T_WHITESPACE","\n        ",793],["T_VARIABLE","$_bytes",794],["T_WHITESPACE"," ",794],"=",["T_WHITESPACE"," ",794],"@",["T_STRING","ini_get",794],"(",["T_VARIABLE","$ini_key",794],")",";",["T_WHITESPACE","\n\n        ",794],["T_COMMENT","\/\/ kilobytes\n",796],["T_WHITESPACE","        ",797],["T_IF","if",797],["T_WHITESPACE"," ",797],"(",["T_STRING","stristr",797],"(",["T_VARIABLE","$_bytes",797],",",["T_WHITESPACE"," ",797],["T_CONSTANT_ENCAPSED_STRING","'k'",797],")",")",["T_WHITESPACE"," ",797],"{",["T_WHITESPACE","\n            ",797],["T_VARIABLE","$_bytes",798],["T_WHITESPACE"," ",798],"=",["T_WHITESPACE"," ",798],["T_STRING","intval",798],"(",["T_VARIABLE","$_bytes",798],")",["T_WHITESPACE"," ",798],"*",["T_WHITESPACE"," ",798],["T_LNUMBER","1024",798],";",["T_WHITESPACE","\n        ",798],["T_COMMENT","\/\/ megabytes\n",799],["T_WHITESPACE","        ",800],"}",["T_WHITESPACE"," ",800],["T_ELSEIF","elseif",800],["T_WHITESPACE"," ",800],"(",["T_STRING","stristr",800],"(",["T_VARIABLE","$_bytes",800],",",["T_WHITESPACE"," ",800],["T_CONSTANT_ENCAPSED_STRING","'m'",800],")",")",["T_WHITESPACE"," ",800],"{",["T_WHITESPACE","\n            ",800],["T_VARIABLE","$_bytes",801],["T_WHITESPACE"," ",801],"=",["T_WHITESPACE"," ",801],["T_STRING","intval",801],"(",["T_VARIABLE","$_bytes",801],")",["T_WHITESPACE"," ",801],"*",["T_WHITESPACE"," ",801],["T_LNUMBER","1024",801],["T_WHITESPACE"," ",801],"*",["T_WHITESPACE"," ",801],["T_LNUMBER","1024",801],";",["T_WHITESPACE","\n        ",801],["T_COMMENT","\/\/ gigabytes\n",802],["T_WHITESPACE","        ",803],"}",["T_WHITESPACE"," ",803],["T_ELSEIF","elseif",803],["T_WHITESPACE"," ",803],"(",["T_STRING","stristr",803],"(",["T_VARIABLE","$_bytes",803],",",["T_WHITESPACE"," ",803],["T_CONSTANT_ENCAPSED_STRING","'g'",803],")",")",["T_WHITESPACE"," ",803],"{",["T_WHITESPACE","\n            ",803],["T_VARIABLE","$_bytes",804],["T_WHITESPACE"," ",804],"=",["T_WHITESPACE"," ",804],["T_STRING","intval",804],"(",["T_VARIABLE","$_bytes",804],")",["T_WHITESPACE"," ",804],"*",["T_WHITESPACE"," ",804],["T_LNUMBER","1024",804],["T_WHITESPACE"," ",804],"*",["T_WHITESPACE"," ",804],["T_LNUMBER","1024",804],["T_WHITESPACE"," ",804],"*",["T_WHITESPACE"," ",804],["T_LNUMBER","1024",804],";",["T_WHITESPACE","\n        ",804],"}",["T_WHITESPACE","\n        ",805],["T_RETURN","return",806],["T_WHITESPACE"," ",806],["T_INT_CAST","(int)",806],["T_VARIABLE","$_bytes",806],";",["T_WHITESPACE","\n    ",806],"}",["T_WHITESPACE","\n\n    ",807],["T_DOC_COMMENT","\/**\n     * Simple converrt bytes to Megabytes\n     *\n     * @param int $bytes\n     * @return int\n     *\/",809],["T_WHITESPACE","\n    ",814],["T_PROTECTED","protected",815],["T_WHITESPACE"," ",815],["T_FUNCTION","function",815],["T_WHITESPACE"," ",815],["T_STRING","_bytesToMbytes",815],"(",["T_VARIABLE","$bytes",815],")",["T_WHITESPACE","\n    ",815],"{",["T_WHITESPACE","\n        ",816],["T_RETURN","return",817],["T_WHITESPACE"," ",817],["T_STRING","round",817],"(",["T_VARIABLE","$bytes",817],["T_WHITESPACE"," ",817],"\/",["T_WHITESPACE"," ",817],"(",["T_LNUMBER","1024",817],["T_WHITESPACE"," ",817],"*",["T_WHITESPACE"," ",817],["T_LNUMBER","1024",817],")",")",";",["T_WHITESPACE","\n    ",817],"}",["T_WHITESPACE","\n",818],"}",["T_WHITESPACE","\n",819]]