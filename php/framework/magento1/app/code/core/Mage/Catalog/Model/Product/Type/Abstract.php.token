[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Abstract model for product type implementation\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_ABSTRACT","abstract",34],["T_WHITESPACE"," ",34],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Product_Type_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Product model instance\n     *\n     * @deprecated if use as singleton\n     * @var Mage_Catalog_Model_Product\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_product",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Product type instance id\n     *\n     * @var string\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_typeId",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @deprecated\n     *\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_setAttributes",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * @deprecated\n     *\n     * @var array\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_editableAttributes",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Is a composite product type\n     *\n     * @var bool\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_isComposite",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","false",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Is a configurable product type\n     *\n     * @var bool\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$_canConfigure",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","false",77],";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Whether product quantity is fractional number or not\n     *\n     * @var bool\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_canUseQtyDecimals",84],["T_WHITESPACE","  ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","true",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * @deprecated\n     *\n     * @var int\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_storeFilter",91],["T_WHITESPACE","     ",91],"=",["T_WHITESPACE"," ",91],["T_STRING","null",91],";",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * File queue array\n     *\n     * @var array\n     *\/",93],["T_WHITESPACE","\n    ",97],["T_PROTECTED","protected",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$_fileQueue",98],["T_WHITESPACE","       ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",")",";",["T_WHITESPACE","\n\n    ",98],["T_CONST","const",100],["T_WHITESPACE"," ",100],["T_STRING","CALCULATE_CHILD",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_LNUMBER","0",100],";",["T_WHITESPACE","\n    ",100],["T_CONST","const",101],["T_WHITESPACE"," ",101],["T_STRING","CALCULATE_PARENT",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_LNUMBER","1",101],";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * values for shipment type (invoice etc)\n     *\n     *\/",103],["T_WHITESPACE","\n    ",106],["T_CONST","const",107],["T_WHITESPACE"," ",107],["T_STRING","SHIPMENT_SEPARATELY",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_LNUMBER","1",107],";",["T_WHITESPACE","\n    ",107],["T_CONST","const",108],["T_WHITESPACE"," ",108],["T_STRING","SHIPMENT_TOGETHER",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_LNUMBER","0",108],";",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * Process modes\n     *\n     * Full validation - all required options must be set, whole configuration\n     * must be valid\n     *\/",110],["T_WHITESPACE","\n    ",115],["T_CONST","const",116],["T_WHITESPACE"," ",116],["T_STRING","PROCESS_MODE_FULL",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'full'",116],";",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Process modes\n     *\n     * Lite validation - only received options are validated\n     *\/",118],["T_WHITESPACE","\n    ",122],["T_CONST","const",123],["T_WHITESPACE"," ",123],["T_STRING","PROCESS_MODE_LITE",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'lite'",123],";",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * Item options prefix\n     *\/",125],["T_WHITESPACE","\n    ",127],["T_CONST","const",128],["T_WHITESPACE"," ",128],["T_STRING","OPTION_PREFIX",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'option_'",128],";",["T_WHITESPACE","\n\n    ",128],["T_DOC_COMMENT","\/**\n     * Specify type instance product\n     *\n     * @param   Mage_Catalog_Model_Product $product\n     * @return  Mage_Catalog_Model_Product_Type_Abstract\n     *\/",130],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","setProduct",136],"(",["T_VARIABLE","$product",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_product",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$product",138],";",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Specify type identifier\n     *\n     * @param   string $typeId\n     * @return  Mage_Catalog_Model_Product_Type_Abstract\n     *\/",142],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","setTypeId",148],"(",["T_VARIABLE","$typeId",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_typeId",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$typeId",150],";",["T_WHITESPACE","\n        ",150],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Retrieve catalog product object\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product\n     *\/",154],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","getProduct",160],"(",["T_VARIABLE","$product",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","null",160],")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_STRING","is_object",162],"(",["T_VARIABLE","$product",162],")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$product",163],";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE","\n        ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_product",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Return relation info about used products for specific type instance\n     *\n     * @return Varien_Object Object with information data\n     *\/",168],["T_WHITESPACE","\n    ",172],["T_PUBLIC","public",173],["T_WHITESPACE"," ",173],["T_FUNCTION","function",173],["T_WHITESPACE"," ",173],["T_STRING","getRelationInfo",173],"(",")",["T_WHITESPACE","\n    ",173],"{",["T_WHITESPACE","\n        ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_STRING","Varien_Object",175],"(",")",";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Retrieve Required children ids\n     * Return grouped array, ex array(\n     *   group => array(ids)\n     * )\n     *\n     * @param int $parentId\n     * @param bool $required\n     * @return array\n     *\/",178],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","getChildrenIds",188],"(",["T_VARIABLE","$parentId",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$required",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_STRING","true",188],")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_ARRAY","array",190],"(",")",";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Retrieve parent ids array by requered child\n     *\n     * @param int|array $childId\n     * @return array\n     *\/",193],["T_WHITESPACE","\n    ",198],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","getParentIdsByChild",199],"(",["T_VARIABLE","$childId",199],")",["T_WHITESPACE","\n    ",199],"{",["T_WHITESPACE","\n        ",200],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_ARRAY","array",201],"(",")",";",["T_WHITESPACE","\n    ",201],"}",["T_WHITESPACE","\n\n    ",202],["T_DOC_COMMENT","\/**\n     * Get array of product set attributes\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",204],["T_WHITESPACE","\n    ",209],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","getSetAttributes",210],"(",["T_VARIABLE","$product",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_STRING","null",210],")",["T_WHITESPACE","\n    ",210],"{",["T_WHITESPACE","\n        ",211],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getProduct",212],"(",["T_VARIABLE","$product",212],")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getResource",212],"(",")",["T_WHITESPACE","\n            ",212],["T_OBJECT_OPERATOR","->",213],["T_STRING","loadAllAttributes",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getProduct",213],"(",["T_VARIABLE","$product",213],")",")",["T_WHITESPACE","\n            ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","getSortedAttributes",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getProduct",214],"(",["T_VARIABLE","$product",214],")",["T_OBJECT_OPERATOR","->",214],["T_STRING","getAttributeSetId",214],"(",")",")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Compare attribues sorting\n     *\n     * @param Mage_Catalog_Model_Entity_Attribute $attribute1\n     * @param Mage_Catalog_Model_Entity_Attribute $attribute2\n     * @return int\n     *\/",217],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","attributesCompare",224],"(",["T_VARIABLE","$attribute1",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$attribute2",224],")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$sort1",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE","  ",226],"(",["T_VARIABLE","$attribute1",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getGroupSortPath",226],"(",")",["T_WHITESPACE"," ",226],"*",["T_WHITESPACE"," ",226],["T_LNUMBER","1000",226],")",["T_WHITESPACE"," ",226],"+",["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$attribute1",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getSortPath",226],"(",")",["T_WHITESPACE"," ",226],"*",["T_WHITESPACE"," ",226],["T_DNUMBER","0.0001",226],")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$sort2",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE","  ",227],"(",["T_VARIABLE","$attribute2",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getGroupSortPath",227],"(",")",["T_WHITESPACE"," ",227],"*",["T_WHITESPACE"," ",227],["T_LNUMBER","1000",227],")",["T_WHITESPACE"," ",227],"+",["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$attribute2",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getSortPath",227],"(",")",["T_WHITESPACE"," ",227],"*",["T_WHITESPACE"," ",227],["T_DNUMBER","0.0001",227],")",";",["T_WHITESPACE","\n\n        ",227],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_VARIABLE","$sort1",229],["T_WHITESPACE"," ",229],">",["T_WHITESPACE"," ",229],["T_VARIABLE","$sort2",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n            ",229],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_LNUMBER","1",230],";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE"," ",231],["T_ELSEIF","elseif",231],["T_WHITESPACE"," ",231],"(",["T_VARIABLE","$sort1",231],["T_WHITESPACE"," ",231],"<",["T_WHITESPACE"," ",231],["T_VARIABLE","$sort2",231],")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],"-",["T_LNUMBER","1",232],";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_LNUMBER","0",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Retrieve product type attributes\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",238],["T_WHITESPACE","\n    ",243],["T_PUBLIC","public",244],["T_WHITESPACE"," ",244],["T_FUNCTION","function",244],["T_WHITESPACE"," ",244],["T_STRING","getEditableAttributes",244],"(",["T_VARIABLE","$product",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","null",244],")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$cacheKey",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'_cache_editable_attributes'",246],";",["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(","!",["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getProduct",247],"(",["T_VARIABLE","$product",247],")",["T_OBJECT_OPERATOR","->",247],["T_STRING","hasData",247],"(",["T_VARIABLE","$cacheKey",247],")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$editableAttributes",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_ARRAY","array",248],"(",")",";",["T_WHITESPACE","\n            ",248],["T_FOREACH","foreach",249],["T_WHITESPACE"," ",249],"(",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getSetAttributes",249],"(",["T_VARIABLE","$product",249],")",["T_WHITESPACE"," ",249],["T_AS","as",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$attributeCode",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$attribute",249],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                ",249],["T_IF","if",250],["T_WHITESPACE"," ",250],"(","!",["T_STRING","is_array",250],"(",["T_VARIABLE","$attribute",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getApplyTo",250],"(",")",")",["T_WHITESPACE","\n                    ",250],["T_BOOLEAN_OR","||",251],["T_WHITESPACE"," ",251],["T_STRING","count",251],"(",["T_VARIABLE","$attribute",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getApplyTo",251],"(",")",")",["T_IS_EQUAL","==",251],["T_LNUMBER","0",251],["T_WHITESPACE","\n                    ",251],["T_BOOLEAN_OR","||",252],["T_WHITESPACE"," ",252],["T_STRING","in_array",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getProduct",252],"(",["T_VARIABLE","$product",252],")",["T_OBJECT_OPERATOR","->",252],["T_STRING","getTypeId",252],"(",")",",",["T_WHITESPACE"," ",252],["T_VARIABLE","$attribute",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getApplyTo",252],"(",")",")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                    ",252],["T_VARIABLE","$editableAttributes",253],"[",["T_VARIABLE","$attributeCode",253],"]",["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$attribute",253],";",["T_WHITESPACE","\n                ",253],"}",["T_WHITESPACE","\n            ",254],"}",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getProduct",256],"(",["T_VARIABLE","$product",256],")",["T_OBJECT_OPERATOR","->",256],["T_STRING","setData",256],"(",["T_VARIABLE","$cacheKey",256],",",["T_WHITESPACE"," ",256],["T_VARIABLE","$editableAttributes",256],")",";",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n        ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getProduct",258],"(",["T_VARIABLE","$product",258],")",["T_OBJECT_OPERATOR","->",258],["T_STRING","getData",258],"(",["T_VARIABLE","$cacheKey",258],")",";",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n\n    ",259],["T_DOC_COMMENT","\/**\n     * Retrieve product attribute by identifier\n     *\n     * @param   int $attributeId\n     * @return  Mage_Eav_Model_Entity_Attribute_Abstract\n     *\/",261],["T_WHITESPACE","\n    ",266],["T_PUBLIC","public",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","getAttributeById",267],"(",["T_VARIABLE","$attributeId",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$product",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","null",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_FOREACH","foreach",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getSetAttributes",269],"(",["T_VARIABLE","$product",269],")",["T_WHITESPACE"," ",269],["T_AS","as",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$attribute",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_VARIABLE","$attribute",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getId",270],"(",")",["T_WHITESPACE"," ",270],["T_IS_EQUAL","==",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$attributeId",270],")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n                ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$attribute",271],";",["T_WHITESPACE","\n            ",271],"}",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n        ",273],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_STRING","null",274],";",["T_WHITESPACE","\n    ",274],"}",["T_WHITESPACE","\n\n    ",275],["T_DOC_COMMENT","\/**\n     * Check is virtual product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",277],["T_WHITESPACE","\n    ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","isVirtual",283],"(",["T_VARIABLE","$product",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","null",283],")",["T_WHITESPACE","\n    ",283],"{",["T_WHITESPACE","\n        ",284],["T_RETURN","return",285],["T_WHITESPACE"," ",285],["T_STRING","false",285],";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_DOC_COMMENT","\/**\n     * Check is product available for sale\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",288],["T_WHITESPACE","\n    ",293],["T_PUBLIC","public",294],["T_WHITESPACE"," ",294],["T_FUNCTION","function",294],["T_WHITESPACE"," ",294],["T_STRING","isSalable",294],"(",["T_VARIABLE","$product",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_STRING","null",294],")",["T_WHITESPACE","\n    ",294],"{",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$salable",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getProduct",296],"(",["T_VARIABLE","$product",296],")",["T_OBJECT_OPERATOR","->",296],["T_STRING","getStatus",296],"(",")",["T_WHITESPACE"," ",296],["T_IS_EQUAL","==",296],["T_WHITESPACE"," ",296],["T_STRING","Mage_Catalog_Model_Product_Status",296],["T_DOUBLE_COLON","::",296],["T_STRING","STATUS_ENABLED",296],";",["T_WHITESPACE","\n        ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$salable",297],["T_WHITESPACE"," ",297],["T_BOOLEAN_AND","&&",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getProduct",297],"(",["T_VARIABLE","$product",297],")",["T_OBJECT_OPERATOR","->",297],["T_STRING","hasData",297],"(",["T_CONSTANT_ENCAPSED_STRING","'is_salable'",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$salable",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getProduct",298],"(",["T_VARIABLE","$product",298],")",["T_OBJECT_OPERATOR","->",298],["T_STRING","getData",298],"(",["T_CONSTANT_ENCAPSED_STRING","'is_salable'",298],")",";",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE","\n        ",299],["T_ELSEIF","elseif",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$salable",300],["T_WHITESPACE"," ",300],["T_BOOLEAN_AND","&&",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","isComposite",300],"(",")",")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n            ",300],["T_VARIABLE","$salable",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_STRING","null",301],";",["T_WHITESPACE","\n        ",301],"}",["T_WHITESPACE","\n\n        ",302],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_BOOL_CAST","(boolean)",304],["T_WHITESPACE"," ",304],["T_INT_CAST","(int)",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$salable",304],";",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n\n    ",305],["T_DOC_COMMENT","\/**\n     * Prepare product and its configuration to be added to some products list.\n     * Perform standard preparation process and then prepare options belonging to specific product type.\n     *\n     * @param  Varien_Object $buyRequest\n     * @param  Mage_Catalog_Model_Product $product\n     * @param  string $processMode\n     * @return array|string\n     *\/",307],["T_WHITESPACE","\n    ",315],["T_PROTECTED","protected",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","_prepareProduct",316],"(",["T_STRING","Varien_Object",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$buyRequest",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$product",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$processMode",316],")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$product",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getProduct",318],"(",["T_VARIABLE","$product",318],")",";",["T_WHITESPACE","\n        ",318],["T_COMMENT","\/* @var Mage_Catalog_Model_Product $product *\/",319],["T_WHITESPACE","\n        ",319],["T_COMMENT","\/\/ try to add custom options\n",320],["T_WHITESPACE","        ",321],["T_TRY","try",321],["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n            ",321],["T_VARIABLE","$options",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_prepareOptions",322],"(",["T_VARIABLE","$buyRequest",322],",",["T_WHITESPACE"," ",322],["T_VARIABLE","$product",322],",",["T_WHITESPACE"," ",322],["T_VARIABLE","$processMode",322],")",";",["T_WHITESPACE","\n        ",322],"}",["T_WHITESPACE"," ",323],["T_CATCH","catch",323],["T_WHITESPACE"," ",323],"(",["T_STRING","Mage_Core_Exception",323],["T_WHITESPACE"," ",323],["T_VARIABLE","$e",323],")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n            ",323],["T_RETURN","return",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$e",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getMessage",324],"(",")",";",["T_WHITESPACE","\n        ",324],"}",["T_WHITESPACE","\n\n        ",325],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_STRING","is_string",327],"(",["T_VARIABLE","$options",327],")",")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$options",328],";",["T_WHITESPACE","\n        ",328],"}",["T_WHITESPACE","\n        ",329],["T_COMMENT","\/\/ try to found super product configuration\n",330],["T_WHITESPACE","        ",331],["T_COMMENT","\/\/ (if product was buying within grouped product)\n",331],["T_WHITESPACE","        ",332],["T_VARIABLE","$superProductConfig",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$buyRequest",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getSuperProductConfig",332],"(",")",";",["T_WHITESPACE","\n        ",332],["T_IF","if",333],["T_WHITESPACE"," ",333],"(","!",["T_EMPTY","empty",333],"(",["T_VARIABLE","$superProductConfig",333],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",333],"]",")",["T_WHITESPACE","\n            ",333],["T_BOOLEAN_AND","&&",334],["T_WHITESPACE"," ",334],"!",["T_EMPTY","empty",334],"(",["T_VARIABLE","$superProductConfig",334],"[",["T_CONSTANT_ENCAPSED_STRING","'product_type'",334],"]",")",["T_WHITESPACE","\n        ",334],")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n            ",335],["T_VARIABLE","$superProductId",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_INT_CAST","(int)",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$superProductConfig",336],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",336],"]",";",["T_WHITESPACE","\n            ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_VARIABLE","$superProductId",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                ",337],["T_IF","if",338],["T_WHITESPACE"," ",338],"(","!",["T_VARIABLE","$superProduct",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_STRING","Mage",338],["T_DOUBLE_COLON","::",338],["T_STRING","registry",338],"(",["T_CONSTANT_ENCAPSED_STRING","'used_super_product_'",338],".",["T_VARIABLE","$superProductId",338],")",")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n                    ",338],["T_VARIABLE","$superProduct",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","Mage",339],["T_DOUBLE_COLON","::",339],["T_STRING","getModel",339],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",339],")",["T_OBJECT_OPERATOR","->",339],["T_STRING","load",339],"(",["T_VARIABLE","$superProductId",339],")",";",["T_WHITESPACE","\n                    ",339],["T_STRING","Mage",340],["T_DOUBLE_COLON","::",340],["T_STRING","register",340],"(",["T_CONSTANT_ENCAPSED_STRING","'used_super_product_'",340],".",["T_VARIABLE","$superProductId",340],",",["T_WHITESPACE"," ",340],["T_VARIABLE","$superProduct",340],")",";",["T_WHITESPACE","\n                ",340],"}",["T_WHITESPACE","\n                ",341],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$superProduct",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getId",342],"(",")",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                    ",342],["T_VARIABLE","$assocProductIds",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_VARIABLE","$superProduct",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getTypeInstance",343],"(",["T_STRING","true",343],")",["T_OBJECT_OPERATOR","->",343],["T_STRING","getAssociatedProductIds",343],"(",["T_VARIABLE","$superProduct",343],")",";",["T_WHITESPACE","\n                    ",343],["T_IF","if",344],["T_WHITESPACE"," ",344],"(",["T_STRING","in_array",344],"(",["T_VARIABLE","$product",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","getId",344],"(",")",",",["T_WHITESPACE"," ",344],["T_VARIABLE","$assocProductIds",344],")",")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                        ",344],["T_VARIABLE","$productType",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$superProductConfig",345],"[",["T_CONSTANT_ENCAPSED_STRING","'product_type'",345],"]",";",["T_WHITESPACE","\n                        ",345],["T_VARIABLE","$product",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","addCustomOption",346],"(",["T_CONSTANT_ENCAPSED_STRING","'product_type'",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$productType",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$superProduct",346],")",";",["T_WHITESPACE","\n\n                        ",346],["T_VARIABLE","$buyRequest",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","setData",348],"(",["T_CONSTANT_ENCAPSED_STRING","'super_product_config'",348],",",["T_WHITESPACE"," ",348],["T_ARRAY","array",348],"(",["T_WHITESPACE","\n                            ",348],["T_CONSTANT_ENCAPSED_STRING","'product_type'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$productType",349],",",["T_WHITESPACE","\n                            ",349],["T_CONSTANT_ENCAPSED_STRING","'product_id'",350],["T_WHITESPACE","   ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$superProduct",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getId",350],"(",")",["T_WHITESPACE","\n                        ",350],")",")",";",["T_WHITESPACE","\n                    ",351],"}",["T_WHITESPACE","\n                ",352],"}",["T_WHITESPACE","\n            ",353],"}",["T_WHITESPACE","\n        ",354],"}",["T_WHITESPACE","\n\n        ",355],["T_VARIABLE","$product",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","prepareCustomOptions",357],"(",")",";",["T_WHITESPACE","\n        ",357],["T_VARIABLE","$buyRequest",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","unsetData",358],"(",["T_CONSTANT_ENCAPSED_STRING","'_processing_params'",358],")",";",["T_WHITESPACE"," ",358],["T_COMMENT","\/\/ One-time params only\n",358],["T_WHITESPACE","        ",359],["T_VARIABLE","$product",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","addCustomOption",359],"(",["T_CONSTANT_ENCAPSED_STRING","'info_buyRequest'",359],",",["T_WHITESPACE"," ",359],["T_STRING","serialize",359],"(",["T_VARIABLE","$buyRequest",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getData",359],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",359],["T_IF","if",361],["T_WHITESPACE"," ",361],"(",["T_VARIABLE","$options",361],")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n            ",361],["T_VARIABLE","$optionIds",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_STRING","array_keys",362],"(",["T_VARIABLE","$options",362],")",";",["T_WHITESPACE","\n            ",362],["T_VARIABLE","$product",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","addCustomOption",363],"(",["T_CONSTANT_ENCAPSED_STRING","'option_ids'",363],",",["T_WHITESPACE"," ",363],["T_STRING","implode",363],"(",["T_CONSTANT_ENCAPSED_STRING","','",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$optionIds",363],")",")",";",["T_WHITESPACE","\n            ",363],["T_FOREACH","foreach",364],["T_WHITESPACE"," ",364],"(",["T_VARIABLE","$options",364],["T_WHITESPACE"," ",364],["T_AS","as",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$optionId",364],["T_WHITESPACE"," ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$optionValue",364],")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n                ",364],["T_VARIABLE","$product",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","addCustomOption",365],"(",["T_STRING","self",365],["T_DOUBLE_COLON","::",365],["T_STRING","OPTION_PREFIX",365],["T_WHITESPACE"," ",365],".",["T_WHITESPACE"," ",365],["T_VARIABLE","$optionId",365],",",["T_WHITESPACE"," ",365],["T_VARIABLE","$optionValue",365],")",";",["T_WHITESPACE","\n            ",365],"}",["T_WHITESPACE","\n        ",366],"}",["T_WHITESPACE","\n\n        ",367],["T_COMMENT","\/\/ set quantity in cart\n",369],["T_WHITESPACE","        ",370],["T_IF","if",370],["T_WHITESPACE"," ",370],"(",["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","_isStrictProcessMode",370],"(",["T_VARIABLE","$processMode",370],")",")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n            ",370],["T_VARIABLE","$product",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","setCartQty",371],"(",["T_VARIABLE","$buyRequest",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","getQty",371],"(",")",")",";",["T_WHITESPACE","\n        ",371],"}",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$product",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","setQty",373],"(",["T_VARIABLE","$buyRequest",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getQty",373],"(",")",")",";",["T_WHITESPACE","\n\n        ",373],["T_RETURN","return",375],["T_WHITESPACE"," ",375],["T_ARRAY","array",375],"(",["T_VARIABLE","$product",375],")",";",["T_WHITESPACE","\n    ",375],"}",["T_WHITESPACE","\n\n    ",376],["T_DOC_COMMENT","\/**\n     * Process product configuaration\n     *\n     * @param Varien_Object $buyRequest\n     * @param Mage_Catalog_Model_Product $product\n     * @param string $processMode\n     * @return array|string\n     *\/",378],["T_WHITESPACE","\n    ",385],["T_PUBLIC","public",386],["T_WHITESPACE"," ",386],["T_FUNCTION","function",386],["T_WHITESPACE"," ",386],["T_STRING","processConfiguration",386],"(",["T_STRING","Varien_Object",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$buyRequest",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$product",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","null",386],",",["T_WHITESPACE","\n        ",386],["T_VARIABLE","$processMode",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_STRING","self",387],["T_DOUBLE_COLON","::",387],["T_STRING","PROCESS_MODE_LITE",387],")",["T_WHITESPACE","\n    ",387],"{",["T_WHITESPACE","\n        ",388],["T_VARIABLE","$_products",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_prepareProduct",389],"(",["T_VARIABLE","$buyRequest",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$product",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$processMode",389],")",";",["T_WHITESPACE","\n\n        ",389],["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","processFileQueue",391],"(",")",";",["T_WHITESPACE","\n\n        ",391],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$_products",393],";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n\n    ",394],["T_DOC_COMMENT","\/**\n     * Initialize product(s) for add to cart process.\n     * Advanced version of func to prepare product for cart - processMode can be specified there.\n     *\n     * @param Varien_Object $buyRequest\n     * @param Mage_Catalog_Model_Product $product\n     * @param null|string $processMode\n     * @return array|string\n     *\/",396],["T_WHITESPACE","\n    ",404],["T_PUBLIC","public",405],["T_WHITESPACE"," ",405],["T_FUNCTION","function",405],["T_WHITESPACE"," ",405],["T_STRING","prepareForCartAdvanced",405],"(",["T_STRING","Varien_Object",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$buyRequest",405],",",["T_WHITESPACE"," ",405],["T_VARIABLE","$product",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_STRING","null",405],",",["T_WHITESPACE"," ",405],["T_VARIABLE","$processMode",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_STRING","null",405],")",["T_WHITESPACE","\n    ",405],"{",["T_WHITESPACE","\n        ",406],["T_IF","if",407],["T_WHITESPACE"," ",407],"(","!",["T_VARIABLE","$processMode",407],")",["T_WHITESPACE"," ",407],"{",["T_WHITESPACE","\n            ",407],["T_VARIABLE","$processMode",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_STRING","self",408],["T_DOUBLE_COLON","::",408],["T_STRING","PROCESS_MODE_FULL",408],";",["T_WHITESPACE","\n        ",408],"}",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$_products",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","_prepareProduct",410],"(",["T_VARIABLE","$buyRequest",410],",",["T_WHITESPACE"," ",410],["T_VARIABLE","$product",410],",",["T_WHITESPACE"," ",410],["T_VARIABLE","$processMode",410],")",";",["T_WHITESPACE","\n        ",410],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","processFileQueue",411],"(",")",";",["T_WHITESPACE","\n        ",411],["T_RETURN","return",412],["T_WHITESPACE"," ",412],["T_VARIABLE","$_products",412],";",["T_WHITESPACE","\n    ",412],"}",["T_WHITESPACE","\n\n    ",413],["T_DOC_COMMENT","\/**\n     * Initialize product(s) for add to cart process\n     *\n     * @param Varien_Object $buyRequest\n     * @param Mage_Catalog_Model_Product $product\n     * @return array|string\n     *\/",415],["T_WHITESPACE","\n    ",421],["T_PUBLIC","public",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","prepareForCart",422],"(",["T_STRING","Varien_Object",422],["T_WHITESPACE"," ",422],["T_VARIABLE","$buyRequest",422],",",["T_WHITESPACE"," ",422],["T_VARIABLE","$product",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_STRING","null",422],")",["T_WHITESPACE","\n    ",422],"{",["T_WHITESPACE","\n        ",423],["T_RETURN","return",424],["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","prepareForCartAdvanced",424],"(",["T_VARIABLE","$buyRequest",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$product",424],",",["T_WHITESPACE"," ",424],["T_STRING","self",424],["T_DOUBLE_COLON","::",424],["T_STRING","PROCESS_MODE_FULL",424],")",";",["T_WHITESPACE","\n    ",424],"}",["T_WHITESPACE","\n\n    ",425],["T_DOC_COMMENT","\/**\n     * Process File Queue\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",427],["T_WHITESPACE","\n    ",430],["T_PUBLIC","public",431],["T_WHITESPACE"," ",431],["T_FUNCTION","function",431],["T_WHITESPACE"," ",431],["T_STRING","processFileQueue",431],"(",")",["T_WHITESPACE","\n    ",431],"{",["T_WHITESPACE","\n        ",432],["T_IF","if",433],["T_WHITESPACE"," ",433],"(",["T_EMPTY","empty",433],"(",["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","_fileQueue",433],")",")",["T_WHITESPACE"," ",433],"{",["T_WHITESPACE","\n            ",433],["T_RETURN","return",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$this",434],";",["T_WHITESPACE","\n        ",434],"}",["T_WHITESPACE","\n\n        ",435],["T_FOREACH","foreach",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","_fileQueue",437],["T_WHITESPACE"," ",437],["T_AS","as",437],["T_WHITESPACE"," ",437],"&",["T_VARIABLE","$queueOptions",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n            ",437],["T_IF","if",438],["T_WHITESPACE"," ",438],"(",["T_ISSET","isset",438],"(",["T_VARIABLE","$queueOptions",438],"[",["T_CONSTANT_ENCAPSED_STRING","'operation'",438],"]",")",["T_WHITESPACE"," ",438],["T_BOOLEAN_AND","&&",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$operation",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$queueOptions",438],"[",["T_CONSTANT_ENCAPSED_STRING","'operation'",438],"]",")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n                ",438],["T_SWITCH","switch",439],["T_WHITESPACE"," ",439],"(",["T_VARIABLE","$operation",439],")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n                    ",439],["T_CASE","case",440],["T_WHITESPACE"," ",440],["T_CONSTANT_ENCAPSED_STRING","'receive_uploaded_file'",440],":",["T_WHITESPACE","\n                        ",440],["T_VARIABLE","$src",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_ISSET","isset",441],"(",["T_VARIABLE","$queueOptions",441],"[",["T_CONSTANT_ENCAPSED_STRING","'src_name'",441],"]",")",["T_WHITESPACE"," ",441],"?",["T_WHITESPACE"," ",441],["T_VARIABLE","$queueOptions",441],"[",["T_CONSTANT_ENCAPSED_STRING","'src_name'",441],"]",["T_WHITESPACE"," ",441],":",["T_WHITESPACE"," ",441],["T_CONSTANT_ENCAPSED_STRING","''",441],";",["T_WHITESPACE","\n                        ",441],["T_VARIABLE","$dst",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_ISSET","isset",442],"(",["T_VARIABLE","$queueOptions",442],"[",["T_CONSTANT_ENCAPSED_STRING","'dst_name'",442],"]",")",["T_WHITESPACE"," ",442],"?",["T_WHITESPACE"," ",442],["T_VARIABLE","$queueOptions",442],"[",["T_CONSTANT_ENCAPSED_STRING","'dst_name'",442],"]",["T_WHITESPACE"," ",442],":",["T_WHITESPACE"," ",442],["T_CONSTANT_ENCAPSED_STRING","''",442],";",["T_WHITESPACE","\n                        ",442],["T_DOC_COMMENT","\/** @var $uploader Zend_File_Transfer_Adapter_Http *\/",443],["T_WHITESPACE","\n                        ",443],["T_VARIABLE","$uploader",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_ISSET","isset",444],"(",["T_VARIABLE","$queueOptions",444],"[",["T_CONSTANT_ENCAPSED_STRING","'uploader'",444],"]",")",["T_WHITESPACE"," ",444],"?",["T_WHITESPACE"," ",444],["T_VARIABLE","$queueOptions",444],"[",["T_CONSTANT_ENCAPSED_STRING","'uploader'",444],"]",["T_WHITESPACE"," ",444],":",["T_WHITESPACE"," ",444],["T_STRING","null",444],";",["T_WHITESPACE","\n\n                        ",444],["T_VARIABLE","$path",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_STRING","dirname",446],"(",["T_VARIABLE","$dst",446],")",";",["T_WHITESPACE","\n                        ",446],["T_VARIABLE","$io",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_NEW","new",447],["T_WHITESPACE"," ",447],["T_STRING","Varien_Io_File",447],"(",")",";",["T_WHITESPACE","\n                        ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(","!",["T_VARIABLE","$io",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","isWriteable",448],"(",["T_VARIABLE","$path",448],")",["T_WHITESPACE"," ",448],["T_BOOLEAN_AND","&&",448],["T_WHITESPACE"," ",448],"!",["T_VARIABLE","$io",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","mkdir",448],"(",["T_VARIABLE","$path",448],",",["T_WHITESPACE"," ",448],["T_LNUMBER","0777",448],",",["T_WHITESPACE"," ",448],["T_STRING","true",448],")",")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n                            ",448],["T_STRING","Mage",449],["T_DOUBLE_COLON","::",449],["T_STRING","throwException",449],"(",["T_STRING","Mage",449],["T_DOUBLE_COLON","::",449],["T_STRING","helper",449],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",449],")",["T_OBJECT_OPERATOR","->",449],["T_STRING","__",449],"(",["T_CONSTANT_ENCAPSED_STRING","\"Cannot create writeable directory '%s'.\"",449],",",["T_WHITESPACE"," ",449],["T_VARIABLE","$path",449],")",")",";",["T_WHITESPACE","\n                        ",449],"}",["T_WHITESPACE","\n\n                        ",450],["T_VARIABLE","$uploader",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","setDestination",452],"(",["T_VARIABLE","$path",452],")",";",["T_WHITESPACE","\n\n                        ",452],["T_IF","if",454],["T_WHITESPACE"," ",454],"(",["T_EMPTY","empty",454],"(",["T_VARIABLE","$src",454],")",["T_WHITESPACE"," ",454],["T_BOOLEAN_OR","||",454],["T_WHITESPACE"," ",454],["T_EMPTY","empty",454],"(",["T_VARIABLE","$dst",454],")",["T_WHITESPACE"," ",454],["T_BOOLEAN_OR","||",454],["T_WHITESPACE"," ",454],"!",["T_VARIABLE","$uploader",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","receive",454],"(",["T_VARIABLE","$src",454],")",")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n                            ",454],["T_DOC_COMMENT","\/**\n                             * @todo: show invalid option\n                             *\/",455],["T_WHITESPACE","\n                            ",457],["T_IF","if",458],["T_WHITESPACE"," ",458],"(",["T_ISSET","isset",458],"(",["T_VARIABLE","$queueOptions",458],"[",["T_CONSTANT_ENCAPSED_STRING","'option'",458],"]",")",")",["T_WHITESPACE"," ",458],"{",["T_WHITESPACE","\n                                ",458],["T_VARIABLE","$queueOptions",459],"[",["T_CONSTANT_ENCAPSED_STRING","'option'",459],"]",["T_OBJECT_OPERATOR","->",459],["T_STRING","setIsValid",459],"(",["T_STRING","false",459],")",";",["T_WHITESPACE","\n                            ",459],"}",["T_WHITESPACE","\n                            ",460],["T_STRING","Mage",461],["T_DOUBLE_COLON","::",461],["T_STRING","throwException",461],"(",["T_STRING","Mage",461],["T_DOUBLE_COLON","::",461],["T_STRING","helper",461],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",461],")",["T_OBJECT_OPERATOR","->",461],["T_STRING","__",461],"(",["T_CONSTANT_ENCAPSED_STRING","\"File upload failed\"",461],")",")",";",["T_WHITESPACE","\n                        ",461],"}",["T_WHITESPACE","\n                        ",462],["T_STRING","Mage",463],["T_DOUBLE_COLON","::",463],["T_STRING","helper",463],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",463],")",["T_OBJECT_OPERATOR","->",463],["T_STRING","saveFile",463],"(",["T_VARIABLE","$dst",463],")",";",["T_WHITESPACE","\n                        ",463],["T_BREAK","break",464],";",["T_WHITESPACE","\n                    ",464],["T_CASE","case",465],["T_WHITESPACE"," ",465],["T_CONSTANT_ENCAPSED_STRING","'move_uploaded_file'",465],":",["T_WHITESPACE","\n                        ",465],["T_VARIABLE","$src",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$queueOptions",466],"[",["T_CONSTANT_ENCAPSED_STRING","'src_name'",466],"]",";",["T_WHITESPACE","\n                        ",466],["T_VARIABLE","$dst",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_VARIABLE","$queueOptions",467],"[",["T_CONSTANT_ENCAPSED_STRING","'dst_name'",467],"]",";",["T_WHITESPACE","\n                        ",467],["T_STRING","move_uploaded_file",468],"(",["T_VARIABLE","$src",468],",",["T_WHITESPACE"," ",468],["T_VARIABLE","$dst",468],")",";",["T_WHITESPACE","\n                        ",468],["T_STRING","Mage",469],["T_DOUBLE_COLON","::",469],["T_STRING","helper",469],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage_database'",469],")",["T_OBJECT_OPERATOR","->",469],["T_STRING","saveFile",469],"(",["T_VARIABLE","$dst",469],")",";",["T_WHITESPACE","\n                        ",469],["T_BREAK","break",470],";",["T_WHITESPACE","\n                    ",470],["T_DEFAULT","default",471],":",["T_WHITESPACE","\n                        ",471],["T_BREAK","break",472],";",["T_WHITESPACE","\n                ",472],"}",["T_WHITESPACE","\n            ",473],"}",["T_WHITESPACE","\n            ",474],["T_VARIABLE","$queueOptions",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_STRING","null",475],";",["T_WHITESPACE","\n        ",475],"}",["T_WHITESPACE","\n\n        ",476],["T_RETURN","return",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$this",478],";",["T_WHITESPACE","\n    ",478],"}",["T_WHITESPACE","\n\n    ",479],["T_DOC_COMMENT","\/**\n     * Add file to File Queue\n     * @param array $queueOptions   Array of File Queue\n     *                              (eg. ['operation'=>'move',\n     *                                    'src_name'=>'filename',\n     *                                    'dst_name'=>'filename2'])\n     *\/",481],["T_WHITESPACE","\n    ",487],["T_PUBLIC","public",488],["T_WHITESPACE"," ",488],["T_FUNCTION","function",488],["T_WHITESPACE"," ",488],["T_STRING","addFileQueue",488],"(",["T_VARIABLE","$queueOptions",488],")",["T_WHITESPACE","\n    ",488],"{",["T_WHITESPACE","\n        ",489],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","_fileQueue",490],"[","]",["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_VARIABLE","$queueOptions",490],";",["T_WHITESPACE","\n    ",490],"}",["T_WHITESPACE","\n\n    ",491],["T_DOC_COMMENT","\/**\n     * Check if current process mode is strict\n     *\n     * @param string $processMode\n     * @return bool\n     *\/",493],["T_WHITESPACE","\n    ",498],["T_PROTECTED","protected",499],["T_WHITESPACE"," ",499],["T_FUNCTION","function",499],["T_WHITESPACE"," ",499],["T_STRING","_isStrictProcessMode",499],"(",["T_VARIABLE","$processMode",499],")",["T_WHITESPACE","\n    ",499],"{",["T_WHITESPACE","\n        ",500],["T_RETURN","return",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$processMode",501],["T_WHITESPACE"," ",501],["T_IS_EQUAL","==",501],["T_WHITESPACE"," ",501],["T_STRING","self",501],["T_DOUBLE_COLON","::",501],["T_STRING","PROCESS_MODE_FULL",501],";",["T_WHITESPACE","\n    ",501],"}",["T_WHITESPACE","\n\n    ",502],["T_DOC_COMMENT","\/**\n     * Retrieve message for specify option(s)\n     *\n     * @return string\n     *\/",504],["T_WHITESPACE","\n    ",508],["T_PUBLIC","public",509],["T_WHITESPACE"," ",509],["T_FUNCTION","function",509],["T_WHITESPACE"," ",509],["T_STRING","getSpecifyOptionMessage",509],"(",")",["T_WHITESPACE","\n    ",509],"{",["T_WHITESPACE","\n        ",510],["T_RETURN","return",511],["T_WHITESPACE"," ",511],["T_STRING","Mage",511],["T_DOUBLE_COLON","::",511],["T_STRING","helper",511],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",511],")",["T_OBJECT_OPERATOR","->",511],["T_STRING","__",511],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify the product\\'s required option(s).'",511],")",";",["T_WHITESPACE","\n    ",511],"}",["T_WHITESPACE","\n\n    ",512],["T_DOC_COMMENT","\/**\n     * Process custom defined options for product\n     *\n     * @param Varien_Object $buyRequest\n     * @param Mage_Catalog_Model_Product $product\n     * @param string $processMode\n     * @return array\n     *\/",514],["T_WHITESPACE","\n    ",521],["T_PROTECTED","protected",522],["T_WHITESPACE"," ",522],["T_FUNCTION","function",522],["T_WHITESPACE"," ",522],["T_STRING","_prepareOptions",522],"(",["T_STRING","Varien_Object",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$buyRequest",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$product",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$processMode",522],")",["T_WHITESPACE","\n    ",522],"{",["T_WHITESPACE","\n        ",523],["T_VARIABLE","$transport",524],["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_NEW","new",524],["T_WHITESPACE"," ",524],["T_STRING","StdClass",524],";",["T_WHITESPACE","\n        ",524],["T_VARIABLE","$transport",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","options",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_ARRAY","array",525],"(",")",";",["T_WHITESPACE","\n        ",525],["T_FOREACH","foreach",526],["T_WHITESPACE"," ",526],"(",["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","getProduct",526],"(",["T_VARIABLE","$product",526],")",["T_OBJECT_OPERATOR","->",526],["T_STRING","getOptions",526],"(",")",["T_WHITESPACE"," ",526],["T_AS","as",526],["T_WHITESPACE"," ",526],["T_VARIABLE","$_option",526],")",["T_WHITESPACE"," ",526],"{",["T_WHITESPACE","\n            ",526],["T_COMMENT","\/* @var $_option Mage_Catalog_Model_Product_Option *\/",527],["T_WHITESPACE","\n            ",527],["T_VARIABLE","$group",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_VARIABLE","$_option",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","groupFactory",528],"(",["T_VARIABLE","$_option",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","getType",528],"(",")",")",["T_WHITESPACE","\n                ",528],["T_OBJECT_OPERATOR","->",529],["T_STRING","setOption",529],"(",["T_VARIABLE","$_option",529],")",["T_WHITESPACE","\n                ",529],["T_OBJECT_OPERATOR","->",530],["T_STRING","setProduct",530],"(",["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","getProduct",530],"(",["T_VARIABLE","$product",530],")",")",["T_WHITESPACE","\n                ",530],["T_OBJECT_OPERATOR","->",531],["T_STRING","setRequest",531],"(",["T_VARIABLE","$buyRequest",531],")",["T_WHITESPACE","\n                ",531],["T_OBJECT_OPERATOR","->",532],["T_STRING","setProcessMode",532],"(",["T_VARIABLE","$processMode",532],")",["T_WHITESPACE","\n                ",532],["T_OBJECT_OPERATOR","->",533],["T_STRING","validateUserValue",533],"(",["T_VARIABLE","$buyRequest",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","getOptions",533],"(",")",")",";",["T_WHITESPACE","\n\n            ",533],["T_VARIABLE","$preparedValue",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_VARIABLE","$group",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","prepareForCart",535],"(",")",";",["T_WHITESPACE","\n            ",535],["T_IF","if",536],["T_WHITESPACE"," ",536],"(",["T_VARIABLE","$preparedValue",536],["T_WHITESPACE"," ",536],["T_IS_NOT_IDENTICAL","!==",536],["T_WHITESPACE"," ",536],["T_STRING","null",536],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n                ",536],["T_VARIABLE","$transport",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","options",537],"[",["T_VARIABLE","$_option",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","getId",537],"(",")","]",["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],["T_VARIABLE","$preparedValue",537],";",["T_WHITESPACE","\n            ",537],"}",["T_WHITESPACE","\n        ",538],"}",["T_WHITESPACE","\n\n        ",539],["T_VARIABLE","$eventName",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_STRING","sprintf",541],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_type_prepare_%s_options'",541],",",["T_WHITESPACE"," ",541],["T_VARIABLE","$processMode",541],")",";",["T_WHITESPACE","\n        ",541],["T_STRING","Mage",542],["T_DOUBLE_COLON","::",542],["T_STRING","dispatchEvent",542],"(",["T_VARIABLE","$eventName",542],",",["T_WHITESPACE"," ",542],["T_ARRAY","array",542],"(",["T_WHITESPACE","\n            ",542],["T_CONSTANT_ENCAPSED_STRING","'transport'",543],["T_WHITESPACE","   ",543],["T_DOUBLE_ARROW","=>",543],["T_WHITESPACE"," ",543],["T_VARIABLE","$transport",543],",",["T_WHITESPACE","\n            ",543],["T_CONSTANT_ENCAPSED_STRING","'buy_request'",544],["T_WHITESPACE"," ",544],["T_DOUBLE_ARROW","=>",544],["T_WHITESPACE"," ",544],["T_VARIABLE","$buyRequest",544],",",["T_WHITESPACE","\n            ",544],["T_CONSTANT_ENCAPSED_STRING","'product'",545],["T_WHITESPACE"," ",545],["T_DOUBLE_ARROW","=>",545],["T_WHITESPACE"," ",545],["T_VARIABLE","$product",545],["T_WHITESPACE","\n        ",545],")",")",";",["T_WHITESPACE","\n        ",546],["T_RETURN","return",547],["T_WHITESPACE"," ",547],["T_VARIABLE","$transport",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","options",547],";",["T_WHITESPACE","\n    ",547],"}",["T_WHITESPACE","\n\n    ",548],["T_DOC_COMMENT","\/**\n     * Process product custom defined options for cart\n     *\n     * @deprecated after 1.4.2.0\n     * @see _prepareOptions()\n     *\n     * @param Varien_Object $buyRequest\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",550],["T_WHITESPACE","\n    ",559],["T_PROTECTED","protected",560],["T_WHITESPACE"," ",560],["T_FUNCTION","function",560],["T_WHITESPACE"," ",560],["T_STRING","_prepareOptionsForCart",560],"(",["T_STRING","Varien_Object",560],["T_WHITESPACE"," ",560],["T_VARIABLE","$buyRequest",560],",",["T_WHITESPACE"," ",560],["T_VARIABLE","$product",560],["T_WHITESPACE"," ",560],"=",["T_WHITESPACE"," ",560],["T_STRING","null",560],")",["T_WHITESPACE","\n    ",560],"{",["T_WHITESPACE","\n        ",561],["T_RETURN","return",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","_prepareOptions",562],"(",["T_VARIABLE","$buyRequest",562],",",["T_WHITESPACE"," ",562],["T_VARIABLE","$product",562],",",["T_WHITESPACE"," ",562],["T_STRING","self",562],["T_DOUBLE_COLON","::",562],["T_STRING","PROCESS_MODE_FULL",562],")",";",["T_WHITESPACE","\n    ",562],"}",["T_WHITESPACE","\n\n    ",563],["T_DOC_COMMENT","\/**\n     * Check if product can be bought\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     * @throws Mage_Core_Exception\n     *\/",565],["T_WHITESPACE","\n    ",571],["T_PUBLIC","public",572],["T_WHITESPACE"," ",572],["T_FUNCTION","function",572],["T_WHITESPACE"," ",572],["T_STRING","checkProductBuyState",572],"(",["T_VARIABLE","$product",572],["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_STRING","null",572],")",["T_WHITESPACE","\n    ",572],"{",["T_WHITESPACE","\n        ",573],["T_IF","if",574],["T_WHITESPACE"," ",574],"(","!",["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","getProduct",574],"(",["T_VARIABLE","$product",574],")",["T_OBJECT_OPERATOR","->",574],["T_STRING","getSkipCheckRequiredOption",574],"(",")",")",["T_WHITESPACE"," ",574],"{",["T_WHITESPACE","\n            ",574],["T_FOREACH","foreach",575],["T_WHITESPACE"," ",575],"(",["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","getProduct",575],"(",["T_VARIABLE","$product",575],")",["T_OBJECT_OPERATOR","->",575],["T_STRING","getOptions",575],"(",")",["T_WHITESPACE"," ",575],["T_AS","as",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$option",575],")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n                ",575],["T_IF","if",576],["T_WHITESPACE"," ",576],"(",["T_VARIABLE","$option",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","getIsRequire",576],"(",")",")",["T_WHITESPACE"," ",576],"{",["T_WHITESPACE","\n                    ",576],["T_VARIABLE","$customOption",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","getProduct",577],"(",["T_VARIABLE","$product",577],")",["T_WHITESPACE","\n                        ",577],["T_OBJECT_OPERATOR","->",578],["T_STRING","getCustomOption",578],"(",["T_STRING","self",578],["T_DOUBLE_COLON","::",578],["T_STRING","OPTION_PREFIX",578],["T_WHITESPACE"," ",578],".",["T_WHITESPACE"," ",578],["T_VARIABLE","$option",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","getId",578],"(",")",")",";",["T_WHITESPACE","\n                    ",578],["T_IF","if",579],["T_WHITESPACE"," ",579],"(","!",["T_VARIABLE","$customOption",579],["T_WHITESPACE"," ",579],["T_BOOLEAN_OR","||",579],["T_WHITESPACE"," ",579],["T_STRING","strlen",579],"(",["T_VARIABLE","$customOption",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","getValue",579],"(",")",")",["T_WHITESPACE"," ",579],["T_IS_EQUAL","==",579],["T_WHITESPACE"," ",579],["T_LNUMBER","0",579],")",["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n                        ",579],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","getProduct",580],"(",["T_VARIABLE","$product",580],")",["T_OBJECT_OPERATOR","->",580],["T_STRING","setSkipCheckRequiredOption",580],"(",["T_STRING","true",580],")",";",["T_WHITESPACE","\n                        ",580],["T_STRING","Mage",581],["T_DOUBLE_COLON","::",581],["T_STRING","throwException",581],"(",["T_WHITESPACE","\n                            ",581],["T_STRING","Mage",582],["T_DOUBLE_COLON","::",582],["T_STRING","helper",582],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",582],")",["T_OBJECT_OPERATOR","->",582],["T_STRING","__",582],"(",["T_CONSTANT_ENCAPSED_STRING","'The product has required options'",582],")",["T_WHITESPACE","\n                        ",582],")",";",["T_WHITESPACE","\n                    ",583],"}",["T_WHITESPACE","\n                ",584],"}",["T_WHITESPACE","\n            ",585],"}",["T_WHITESPACE","\n        ",586],"}",["T_WHITESPACE","\n\n        ",587],["T_RETURN","return",589],["T_WHITESPACE"," ",589],["T_VARIABLE","$this",589],";",["T_WHITESPACE","\n    ",589],"}",["T_WHITESPACE","\n\n    ",590],["T_DOC_COMMENT","\/**\n     * Prepare additional options\/information for order item which will be\n     * created from this product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",592],["T_WHITESPACE","\n    ",598],["T_PUBLIC","public",599],["T_WHITESPACE"," ",599],["T_FUNCTION","function",599],["T_WHITESPACE"," ",599],["T_STRING","getOrderOptions",599],"(",["T_VARIABLE","$product",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_STRING","null",599],")",["T_WHITESPACE","\n    ",599],"{",["T_WHITESPACE","\n        ",600],["T_VARIABLE","$optionArr",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],["T_ARRAY","array",601],"(",")",";",["T_WHITESPACE","\n        ",601],["T_IF","if",602],["T_WHITESPACE"," ",602],"(",["T_VARIABLE","$info",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","getProduct",602],"(",["T_VARIABLE","$product",602],")",["T_OBJECT_OPERATOR","->",602],["T_STRING","getCustomOption",602],"(",["T_CONSTANT_ENCAPSED_STRING","'info_buyRequest'",602],")",")",["T_WHITESPACE"," ",602],"{",["T_WHITESPACE","\n            ",602],["T_VARIABLE","$optionArr",603],"[",["T_CONSTANT_ENCAPSED_STRING","'info_buyRequest'",603],"]",["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],["T_STRING","unserialize",603],"(",["T_VARIABLE","$info",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","getValue",603],"(",")",")",";",["T_WHITESPACE","\n        ",603],"}",["T_WHITESPACE","\n\n        ",604],["T_IF","if",606],["T_WHITESPACE"," ",606],"(",["T_VARIABLE","$optionIds",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_VARIABLE","$this",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","getProduct",606],"(",["T_VARIABLE","$product",606],")",["T_OBJECT_OPERATOR","->",606],["T_STRING","getCustomOption",606],"(",["T_CONSTANT_ENCAPSED_STRING","'option_ids'",606],")",")",["T_WHITESPACE"," ",606],"{",["T_WHITESPACE","\n            ",606],["T_FOREACH","foreach",607],["T_WHITESPACE"," ",607],"(",["T_STRING","explode",607],"(",["T_CONSTANT_ENCAPSED_STRING","','",607],",",["T_WHITESPACE"," ",607],["T_VARIABLE","$optionIds",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","getValue",607],"(",")",")",["T_WHITESPACE"," ",607],["T_AS","as",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$optionId",607],")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n                ",607],["T_IF","if",608],["T_WHITESPACE"," ",608],"(",["T_VARIABLE","$option",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","getProduct",608],"(",["T_VARIABLE","$product",608],")",["T_OBJECT_OPERATOR","->",608],["T_STRING","getOptionById",608],"(",["T_VARIABLE","$optionId",608],")",")",["T_WHITESPACE"," ",608],"{",["T_WHITESPACE","\n\n                    ",608],["T_VARIABLE","$confItemOption",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","getProduct",610],"(",["T_VARIABLE","$product",610],")",["T_WHITESPACE","\n                        ",610],["T_OBJECT_OPERATOR","->",611],["T_STRING","getCustomOption",611],"(",["T_STRING","self",611],["T_DOUBLE_COLON","::",611],["T_STRING","OPTION_PREFIX",611],["T_WHITESPACE"," ",611],".",["T_WHITESPACE"," ",611],["T_VARIABLE","$option",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","getId",611],"(",")",")",";",["T_WHITESPACE","\n\n                    ",611],["T_VARIABLE","$group",613],["T_WHITESPACE"," ",613],"=",["T_WHITESPACE"," ",613],["T_VARIABLE","$option",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","groupFactory",613],"(",["T_VARIABLE","$option",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","getType",613],"(",")",")",["T_WHITESPACE","\n                        ",613],["T_OBJECT_OPERATOR","->",614],["T_STRING","setOption",614],"(",["T_VARIABLE","$option",614],")",["T_WHITESPACE","\n                        ",614],["T_OBJECT_OPERATOR","->",615],["T_STRING","setProduct",615],"(",["T_VARIABLE","$this",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","getProduct",615],"(",")",")",["T_WHITESPACE","\n                        ",615],["T_OBJECT_OPERATOR","->",616],["T_STRING","setConfigurationItemOption",616],"(",["T_VARIABLE","$confItemOption",616],")",";",["T_WHITESPACE","\n\n                    ",616],["T_VARIABLE","$optionArr",618],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",618],"]","[","]",["T_WHITESPACE"," ",618],"=",["T_WHITESPACE"," ",618],["T_ARRAY","array",618],"(",["T_WHITESPACE","\n                        ",618],["T_CONSTANT_ENCAPSED_STRING","'label'",619],["T_WHITESPACE"," ",619],["T_DOUBLE_ARROW","=>",619],["T_WHITESPACE"," ",619],["T_VARIABLE","$option",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","getTitle",619],"(",")",",",["T_WHITESPACE","\n                        ",619],["T_CONSTANT_ENCAPSED_STRING","'value'",620],["T_WHITESPACE"," ",620],["T_DOUBLE_ARROW","=>",620],["T_WHITESPACE"," ",620],["T_VARIABLE","$group",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","getFormattedOptionValue",620],"(",["T_VARIABLE","$confItemOption",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","getValue",620],"(",")",")",",",["T_WHITESPACE","\n                        ",620],["T_CONSTANT_ENCAPSED_STRING","'print_value'",621],["T_WHITESPACE"," ",621],["T_DOUBLE_ARROW","=>",621],["T_WHITESPACE"," ",621],["T_VARIABLE","$group",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getPrintableOptionValue",621],"(",["T_VARIABLE","$confItemOption",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getValue",621],"(",")",")",",",["T_WHITESPACE","\n                        ",621],["T_CONSTANT_ENCAPSED_STRING","'option_id'",622],["T_WHITESPACE"," ",622],["T_DOUBLE_ARROW","=>",622],["T_WHITESPACE"," ",622],["T_VARIABLE","$option",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","getId",622],"(",")",",",["T_WHITESPACE","\n                        ",622],["T_CONSTANT_ENCAPSED_STRING","'option_type'",623],["T_WHITESPACE"," ",623],["T_DOUBLE_ARROW","=>",623],["T_WHITESPACE"," ",623],["T_VARIABLE","$option",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","getType",623],"(",")",",",["T_WHITESPACE","\n                        ",623],["T_CONSTANT_ENCAPSED_STRING","'option_value'",624],["T_WHITESPACE"," ",624],["T_DOUBLE_ARROW","=>",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$confItemOption",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getValue",624],"(",")",",",["T_WHITESPACE","\n                        ",624],["T_CONSTANT_ENCAPSED_STRING","'custom_view'",625],["T_WHITESPACE"," ",625],["T_DOUBLE_ARROW","=>",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$group",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","isCustomizedView",625],"(",")",["T_WHITESPACE","\n                    ",625],")",";",["T_WHITESPACE","\n                ",626],"}",["T_WHITESPACE","\n            ",627],"}",["T_WHITESPACE","\n        ",628],"}",["T_WHITESPACE","\n\n        ",629],["T_IF","if",631],["T_WHITESPACE"," ",631],"(",["T_VARIABLE","$productTypeConfig",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","getProduct",631],"(",["T_VARIABLE","$product",631],")",["T_OBJECT_OPERATOR","->",631],["T_STRING","getCustomOption",631],"(",["T_CONSTANT_ENCAPSED_STRING","'product_type'",631],")",")",["T_WHITESPACE"," ",631],"{",["T_WHITESPACE","\n            ",631],["T_VARIABLE","$optionArr",632],"[",["T_CONSTANT_ENCAPSED_STRING","'super_product_config'",632],"]",["T_WHITESPACE"," ",632],"=",["T_WHITESPACE"," ",632],["T_ARRAY","array",632],"(",["T_WHITESPACE","\n                ",632],["T_CONSTANT_ENCAPSED_STRING","'product_code'",633],["T_WHITESPACE","  ",633],["T_DOUBLE_ARROW","=>",633],["T_WHITESPACE"," ",633],["T_VARIABLE","$productTypeConfig",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","getCode",633],"(",")",",",["T_WHITESPACE","\n                ",633],["T_CONSTANT_ENCAPSED_STRING","'product_type'",634],["T_WHITESPACE","  ",634],["T_DOUBLE_ARROW","=>",634],["T_WHITESPACE"," ",634],["T_VARIABLE","$productTypeConfig",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","getValue",634],"(",")",",",["T_WHITESPACE","\n                ",634],["T_CONSTANT_ENCAPSED_STRING","'product_id'",635],["T_WHITESPACE","    ",635],["T_DOUBLE_ARROW","=>",635],["T_WHITESPACE"," ",635],["T_VARIABLE","$productTypeConfig",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","getProductId",635],"(",")",["T_WHITESPACE","\n            ",635],")",";",["T_WHITESPACE","\n        ",636],"}",["T_WHITESPACE","\n\n        ",637],["T_RETURN","return",639],["T_WHITESPACE"," ",639],["T_VARIABLE","$optionArr",639],";",["T_WHITESPACE","\n    ",639],"}",["T_WHITESPACE","\n\n    ",640],["T_DOC_COMMENT","\/**\n     * Save type related data\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",642],["T_WHITESPACE","\n    ",647],["T_PUBLIC","public",648],["T_WHITESPACE"," ",648],["T_FUNCTION","function",648],["T_WHITESPACE"," ",648],["T_STRING","save",648],"(",["T_VARIABLE","$product",648],["T_WHITESPACE"," ",648],"=",["T_WHITESPACE"," ",648],["T_STRING","null",648],")",["T_WHITESPACE","\n    ",648],"{",["T_WHITESPACE","\n        ",649],["T_RETURN","return",650],["T_WHITESPACE"," ",650],["T_VARIABLE","$this",650],";",["T_WHITESPACE","\n    ",650],"}",["T_WHITESPACE","\n\n    ",651],["T_DOC_COMMENT","\/**\n     * Remove don't applicable attributes data\n     *\n     * @param Mage_Catalog_Model_Product $product\n     *\/",653],["T_WHITESPACE","\n    ",657],["T_PROTECTED","protected",658],["T_WHITESPACE"," ",658],["T_FUNCTION","function",658],["T_WHITESPACE"," ",658],["T_STRING","_removeNotApplicableAttributes",658],"(",["T_VARIABLE","$product",658],["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_STRING","null",658],")",["T_WHITESPACE","\n    ",658],"{",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$product",660],["T_WHITESPACE","    ",660],"=",["T_WHITESPACE"," ",660],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","getProduct",660],"(",["T_VARIABLE","$product",660],")",";",["T_WHITESPACE","\n        ",660],["T_VARIABLE","$eavConfig",661],["T_WHITESPACE","  ",661],"=",["T_WHITESPACE"," ",661],["T_STRING","Mage",661],["T_DOUBLE_COLON","::",661],["T_STRING","getSingleton",661],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",661],")",";",["T_WHITESPACE","\n        ",661],["T_VARIABLE","$entityType",662],["T_WHITESPACE"," ",662],"=",["T_WHITESPACE"," ",662],["T_VARIABLE","$product",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","getResource",662],"(",")",["T_OBJECT_OPERATOR","->",662],["T_STRING","getEntityType",662],"(",")",";",["T_WHITESPACE","\n        ",662],["T_FOREACH","foreach",663],["T_WHITESPACE"," ",663],"(",["T_VARIABLE","$eavConfig",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","getEntityAttributeCodes",663],"(",["T_VARIABLE","$entityType",663],",",["T_WHITESPACE"," ",663],["T_VARIABLE","$product",663],")",["T_WHITESPACE"," ",663],["T_AS","as",663],["T_WHITESPACE"," ",663],["T_VARIABLE","$attributeCode",663],")",["T_WHITESPACE"," ",663],"{",["T_WHITESPACE","\n            ",663],["T_VARIABLE","$attribute",664],["T_WHITESPACE"," ",664],"=",["T_WHITESPACE"," ",664],["T_VARIABLE","$eavConfig",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","getAttribute",664],"(",["T_VARIABLE","$entityType",664],",",["T_WHITESPACE"," ",664],["T_VARIABLE","$attributeCode",664],")",";",["T_WHITESPACE","\n            ",664],["T_VARIABLE","$applyTo",665],["T_WHITESPACE","   ",665],"=",["T_WHITESPACE"," ",665],["T_VARIABLE","$attribute",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","getApplyTo",665],"(",")",";",["T_WHITESPACE","\n            ",665],["T_IF","if",666],["T_WHITESPACE"," ",666],"(",["T_STRING","is_array",666],"(",["T_VARIABLE","$applyTo",666],")",["T_WHITESPACE"," ",666],["T_BOOLEAN_AND","&&",666],["T_WHITESPACE"," ",666],["T_STRING","count",666],"(",["T_VARIABLE","$applyTo",666],")",["T_WHITESPACE"," ",666],">",["T_WHITESPACE"," ",666],["T_LNUMBER","0",666],["T_WHITESPACE"," ",666],["T_BOOLEAN_AND","&&",666],["T_WHITESPACE"," ",666],"!",["T_STRING","in_array",666],"(",["T_VARIABLE","$product",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","getTypeId",666],"(",")",",",["T_WHITESPACE"," ",666],["T_VARIABLE","$applyTo",666],")",")",["T_WHITESPACE"," ",666],"{",["T_WHITESPACE","\n                ",666],["T_VARIABLE","$product",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","unsetData",667],"(",["T_VARIABLE","$attribute",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","getAttributeCode",667],"(",")",")",";",["T_WHITESPACE","\n            ",667],"}",["T_WHITESPACE","\n        ",668],"}",["T_WHITESPACE","\n    ",669],"}",["T_WHITESPACE","\n\n    ",670],["T_DOC_COMMENT","\/**\n     * Before save type related data\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",672],["T_WHITESPACE","\n    ",677],["T_PUBLIC","public",678],["T_WHITESPACE"," ",678],["T_FUNCTION","function",678],["T_WHITESPACE"," ",678],["T_STRING","beforeSave",678],"(",["T_VARIABLE","$product",678],["T_WHITESPACE"," ",678],"=",["T_WHITESPACE"," ",678],["T_STRING","null",678],")",["T_WHITESPACE","\n    ",678],"{",["T_WHITESPACE","\n        ",679],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","_removeNotApplicableAttributes",680],"(",["T_VARIABLE","$product",680],")",";",["T_WHITESPACE","\n        ",680],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","getProduct",681],"(",["T_VARIABLE","$product",681],")",["T_OBJECT_OPERATOR","->",681],["T_STRING","canAffectOptions",681],"(",["T_STRING","true",681],")",";",["T_WHITESPACE","\n        ",681],["T_RETURN","return",682],["T_WHITESPACE"," ",682],["T_VARIABLE","$this",682],";",["T_WHITESPACE","\n    ",682],"}",["T_WHITESPACE","\n\n    ",683],["T_DOC_COMMENT","\/**\n     * Check if product is composite (grouped, configurable, etc)\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",685],["T_WHITESPACE","\n    ",690],["T_PUBLIC","public",691],["T_WHITESPACE"," ",691],["T_FUNCTION","function",691],["T_WHITESPACE"," ",691],["T_STRING","isComposite",691],"(",["T_VARIABLE","$product",691],["T_WHITESPACE"," ",691],"=",["T_WHITESPACE"," ",691],["T_STRING","null",691],")",["T_WHITESPACE","\n    ",691],"{",["T_WHITESPACE","\n        ",692],["T_RETURN","return",693],["T_WHITESPACE"," ",693],["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","_isComposite",693],";",["T_WHITESPACE","\n    ",693],"}",["T_WHITESPACE","\n\n    ",694],["T_DOC_COMMENT","\/**\n     * Check if product is configurable\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",696],["T_WHITESPACE","\n    ",701],["T_PUBLIC","public",702],["T_WHITESPACE"," ",702],["T_FUNCTION","function",702],["T_WHITESPACE"," ",702],["T_STRING","canConfigure",702],"(",["T_VARIABLE","$product",702],["T_WHITESPACE"," ",702],"=",["T_WHITESPACE"," ",702],["T_STRING","null",702],")",["T_WHITESPACE","\n    ",702],"{",["T_WHITESPACE","\n        ",703],["T_RETURN","return",704],["T_WHITESPACE"," ",704],["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","_canConfigure",704],";",["T_WHITESPACE","\n    ",704],"}",["T_WHITESPACE","\n\n    ",705],["T_DOC_COMMENT","\/**\n     * Check if product qty is fractional number\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",707],["T_WHITESPACE","\n    ",712],["T_PUBLIC","public",713],["T_WHITESPACE"," ",713],["T_FUNCTION","function",713],["T_WHITESPACE"," ",713],["T_STRING","canUseQtyDecimals",713],"(",")",["T_WHITESPACE","\n    ",713],"{",["T_WHITESPACE","\n        ",714],["T_RETURN","return",715],["T_WHITESPACE"," ",715],["T_VARIABLE","$this",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","_canUseQtyDecimals",715],";",["T_WHITESPACE","\n    ",715],"}",["T_WHITESPACE","\n\n    ",716],["T_DOC_COMMENT","\/**\n     * Default action to get sku of product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return string\n     *\/",718],["T_WHITESPACE","\n    ",723],["T_PUBLIC","public",724],["T_WHITESPACE"," ",724],["T_FUNCTION","function",724],["T_WHITESPACE"," ",724],["T_STRING","getSku",724],"(",["T_VARIABLE","$product",724],["T_WHITESPACE"," ",724],"=",["T_WHITESPACE"," ",724],["T_STRING","null",724],")",["T_WHITESPACE","\n    ",724],"{",["T_WHITESPACE","\n        ",725],["T_VARIABLE","$sku",726],["T_WHITESPACE"," ",726],"=",["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","getProduct",726],"(",["T_VARIABLE","$product",726],")",["T_OBJECT_OPERATOR","->",726],["T_STRING","getData",726],"(",["T_CONSTANT_ENCAPSED_STRING","'sku'",726],")",";",["T_WHITESPACE","\n        ",726],["T_IF","if",727],["T_WHITESPACE"," ",727],"(",["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","getProduct",727],"(",["T_VARIABLE","$product",727],")",["T_OBJECT_OPERATOR","->",727],["T_STRING","getCustomOption",727],"(",["T_CONSTANT_ENCAPSED_STRING","'option_ids'",727],")",")",["T_WHITESPACE"," ",727],"{",["T_WHITESPACE","\n            ",727],["T_VARIABLE","$sku",728],["T_WHITESPACE"," ",728],"=",["T_WHITESPACE"," ",728],["T_VARIABLE","$this",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","getOptionSku",728],"(",["T_VARIABLE","$product",728],",",["T_VARIABLE","$sku",728],")",";",["T_WHITESPACE","\n        ",728],"}",["T_WHITESPACE","\n        ",729],["T_RETURN","return",730],["T_WHITESPACE"," ",730],["T_VARIABLE","$sku",730],";",["T_WHITESPACE","\n    ",730],"}",["T_WHITESPACE","\n\n    ",731],["T_DOC_COMMENT","\/**\n     * Default action to get sku of product with option\n     *\n     * @param Mage_Catalog_Model_Product $product Product with Custom Options\n     * @param string $sku Product SKU without option\n     * @return string\n     *\/",733],["T_WHITESPACE","\n    ",739],["T_PUBLIC","public",740],["T_WHITESPACE"," ",740],["T_FUNCTION","function",740],["T_WHITESPACE"," ",740],["T_STRING","getOptionSku",740],"(",["T_VARIABLE","$product",740],["T_WHITESPACE"," ",740],"=",["T_WHITESPACE"," ",740],["T_STRING","null",740],",",["T_WHITESPACE"," ",740],["T_VARIABLE","$sku",740],"=",["T_CONSTANT_ENCAPSED_STRING","''",740],")",["T_WHITESPACE","\n    ",740],"{",["T_WHITESPACE","\n        ",741],["T_VARIABLE","$skuDelimiter",742],["T_WHITESPACE"," ",742],"=",["T_WHITESPACE"," ",742],["T_CONSTANT_ENCAPSED_STRING","'-'",742],";",["T_WHITESPACE","\n        ",742],["T_IF","if",743],"(",["T_EMPTY","empty",743],"(",["T_VARIABLE","$sku",743],")",")","{",["T_WHITESPACE","\n            ",743],["T_VARIABLE","$sku",744],["T_WHITESPACE"," ",744],"=",["T_WHITESPACE"," ",744],["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","getProduct",744],"(",["T_VARIABLE","$product",744],")",["T_OBJECT_OPERATOR","->",744],["T_STRING","getData",744],"(",["T_CONSTANT_ENCAPSED_STRING","'sku'",744],")",";",["T_WHITESPACE","\n        ",744],"}",["T_WHITESPACE","\n        ",745],["T_IF","if",746],["T_WHITESPACE"," ",746],"(",["T_VARIABLE","$optionIds",746],["T_WHITESPACE"," ",746],"=",["T_WHITESPACE"," ",746],["T_VARIABLE","$this",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","getProduct",746],"(",["T_VARIABLE","$product",746],")",["T_OBJECT_OPERATOR","->",746],["T_STRING","getCustomOption",746],"(",["T_CONSTANT_ENCAPSED_STRING","'option_ids'",746],")",")",["T_WHITESPACE"," ",746],"{",["T_WHITESPACE","\n            ",746],["T_FOREACH","foreach",747],["T_WHITESPACE"," ",747],"(",["T_STRING","explode",747],"(",["T_CONSTANT_ENCAPSED_STRING","','",747],",",["T_WHITESPACE"," ",747],["T_VARIABLE","$optionIds",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","getValue",747],"(",")",")",["T_WHITESPACE"," ",747],["T_AS","as",747],["T_WHITESPACE"," ",747],["T_VARIABLE","$optionId",747],")",["T_WHITESPACE"," ",747],"{",["T_WHITESPACE","\n                ",747],["T_IF","if",748],["T_WHITESPACE"," ",748],"(",["T_VARIABLE","$option",748],["T_WHITESPACE"," ",748],"=",["T_WHITESPACE"," ",748],["T_VARIABLE","$this",748],["T_OBJECT_OPERATOR","->",748],["T_STRING","getProduct",748],"(",["T_VARIABLE","$product",748],")",["T_OBJECT_OPERATOR","->",748],["T_STRING","getOptionById",748],"(",["T_VARIABLE","$optionId",748],")",")",["T_WHITESPACE"," ",748],"{",["T_WHITESPACE","\n\n                    ",748],["T_VARIABLE","$confItemOption",750],["T_WHITESPACE"," ",750],"=",["T_WHITESPACE"," ",750],["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","getProduct",750],"(",["T_VARIABLE","$product",750],")",["T_OBJECT_OPERATOR","->",750],["T_STRING","getCustomOption",750],"(",["T_STRING","self",750],["T_DOUBLE_COLON","::",750],["T_STRING","OPTION_PREFIX",750],["T_WHITESPACE"," ",750],".",["T_WHITESPACE"," ",750],["T_VARIABLE","$optionId",750],")",";",["T_WHITESPACE","\n\n                    ",750],["T_VARIABLE","$group",752],["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_VARIABLE","$option",752],["T_OBJECT_OPERATOR","->",752],["T_STRING","groupFactory",752],"(",["T_VARIABLE","$option",752],["T_OBJECT_OPERATOR","->",752],["T_STRING","getType",752],"(",")",")",["T_WHITESPACE","\n                        ",752],["T_OBJECT_OPERATOR","->",753],["T_STRING","setOption",753],"(",["T_VARIABLE","$option",753],")",["T_OBJECT_OPERATOR","->",753],["T_STRING","setListener",753],"(",["T_NEW","new",753],["T_WHITESPACE"," ",753],["T_STRING","Varien_Object",753],"(",")",")",";",["T_WHITESPACE","\n\n                    ",753],["T_IF","if",755],["T_WHITESPACE"," ",755],"(",["T_VARIABLE","$optionSku",755],["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_VARIABLE","$group",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","getOptionSku",755],"(",["T_VARIABLE","$confItemOption",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","getValue",755],"(",")",",",["T_WHITESPACE"," ",755],["T_VARIABLE","$skuDelimiter",755],")",")",["T_WHITESPACE"," ",755],"{",["T_WHITESPACE","\n                        ",755],["T_VARIABLE","$sku",756],["T_WHITESPACE"," ",756],["T_CONCAT_EQUAL",".=",756],["T_WHITESPACE"," ",756],["T_VARIABLE","$skuDelimiter",756],["T_WHITESPACE"," ",756],".",["T_WHITESPACE"," ",756],["T_VARIABLE","$optionSku",756],";",["T_WHITESPACE","\n                    ",756],"}",["T_WHITESPACE","\n\n                    ",757],["T_IF","if",759],["T_WHITESPACE"," ",759],"(",["T_VARIABLE","$group",759],["T_OBJECT_OPERATOR","->",759],["T_STRING","getListener",759],"(",")",["T_OBJECT_OPERATOR","->",759],["T_STRING","getHasError",759],"(",")",")",["T_WHITESPACE"," ",759],"{",["T_WHITESPACE","\n                        ",759],["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","getProduct",760],"(",["T_VARIABLE","$product",760],")",["T_WHITESPACE","\n                                ",760],["T_OBJECT_OPERATOR","->",761],["T_STRING","setHasError",761],"(",["T_STRING","true",761],")",["T_WHITESPACE","\n                                ",761],["T_OBJECT_OPERATOR","->",762],["T_STRING","setMessage",762],"(",["T_WHITESPACE","\n                                    ",762],["T_VARIABLE","$group",763],["T_OBJECT_OPERATOR","->",763],["T_STRING","getListener",763],"(",")",["T_OBJECT_OPERATOR","->",763],["T_STRING","getMessage",763],"(",")",["T_WHITESPACE","\n                                ",763],")",";",["T_WHITESPACE","\n                    ",764],"}",["T_WHITESPACE","\n\n                ",765],"}",["T_WHITESPACE","\n            ",767],"}",["T_WHITESPACE","\n        ",768],"}",["T_WHITESPACE","\n        ",769],["T_RETURN","return",770],["T_WHITESPACE"," ",770],["T_VARIABLE","$sku",770],";",["T_WHITESPACE","\n    ",770],"}",["T_WHITESPACE","\n    ",771],["T_DOC_COMMENT","\/**\n     * Default action to get weight of product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return decimal\n     *\/",772],["T_WHITESPACE","\n    ",777],["T_PUBLIC","public",778],["T_WHITESPACE"," ",778],["T_FUNCTION","function",778],["T_WHITESPACE"," ",778],["T_STRING","getWeight",778],"(",["T_VARIABLE","$product",778],["T_WHITESPACE"," ",778],"=",["T_WHITESPACE"," ",778],["T_STRING","null",778],")",["T_WHITESPACE","\n    ",778],"{",["T_WHITESPACE","\n        ",779],["T_RETURN","return",780],["T_WHITESPACE"," ",780],["T_VARIABLE","$this",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","getProduct",780],"(",["T_VARIABLE","$product",780],")",["T_OBJECT_OPERATOR","->",780],["T_STRING","getData",780],"(",["T_CONSTANT_ENCAPSED_STRING","'weight'",780],")",";",["T_WHITESPACE","\n    ",780],"}",["T_WHITESPACE","\n\n    ",781],["T_DOC_COMMENT","\/**\n     * Return true if product has options\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",783],["T_WHITESPACE","\n    ",788],["T_PUBLIC","public",789],["T_WHITESPACE"," ",789],["T_FUNCTION","function",789],["T_WHITESPACE"," ",789],["T_STRING","hasOptions",789],"(",["T_VARIABLE","$product",789],["T_WHITESPACE"," ",789],"=",["T_WHITESPACE"," ",789],["T_STRING","null",789],")",["T_WHITESPACE","\n    ",789],"{",["T_WHITESPACE","\n        ",790],["T_IF","if",791],["T_WHITESPACE"," ",791],"(",["T_VARIABLE","$this",791],["T_OBJECT_OPERATOR","->",791],["T_STRING","getProduct",791],"(",["T_VARIABLE","$product",791],")",["T_OBJECT_OPERATOR","->",791],["T_STRING","getHasOptions",791],"(",")",")",["T_WHITESPACE"," ",791],"{",["T_WHITESPACE","\n            ",791],["T_RETURN","return",792],["T_WHITESPACE"," ",792],["T_STRING","true",792],";",["T_WHITESPACE","\n        ",792],"}",["T_WHITESPACE","\n        ",793],["T_IF","if",794],["T_WHITESPACE"," ",794],"(",["T_VARIABLE","$this",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","getProduct",794],"(",["T_VARIABLE","$product",794],")",["T_OBJECT_OPERATOR","->",794],["T_STRING","isRecurring",794],"(",")",")",["T_WHITESPACE"," ",794],"{",["T_WHITESPACE","\n            ",794],["T_RETURN","return",795],["T_WHITESPACE"," ",795],["T_STRING","true",795],";",["T_WHITESPACE","\n        ",795],"}",["T_WHITESPACE","\n        ",796],["T_RETURN","return",797],["T_WHITESPACE"," ",797],["T_STRING","false",797],";",["T_WHITESPACE","\n    ",797],"}",["T_WHITESPACE","\n\n    ",798],["T_DOC_COMMENT","\/**\n     * Method is needed for specific actions to change given configuration options values\n     * according current product type logic\n     * Example: the cataloginventory validation of decimal qty can change qty to int,\n     * so need to change configuration item qty option value too.\n     *\n     * @param array         $options\n     * @param Varien_Object $option\n     * @param mixed         $value\n     *\n     * @return object       Mage_Catalog_Model_Product_Type_Abstract\n     *\/",800],["T_WHITESPACE","\n    ",811],["T_PUBLIC","public",812],["T_WHITESPACE"," ",812],["T_FUNCTION","function",812],["T_WHITESPACE"," ",812],["T_STRING","updateQtyOption",812],"(",["T_VARIABLE","$options",812],",",["T_WHITESPACE"," ",812],["T_STRING","Varien_Object",812],["T_WHITESPACE"," ",812],["T_VARIABLE","$option",812],",",["T_WHITESPACE"," ",812],["T_VARIABLE","$value",812],",",["T_WHITESPACE"," ",812],["T_VARIABLE","$product",812],["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_STRING","null",812],")",["T_WHITESPACE","\n    ",812],"{",["T_WHITESPACE","\n        ",813],["T_RETURN","return",814],["T_WHITESPACE"," ",814],["T_VARIABLE","$this",814],";",["T_WHITESPACE","\n    ",814],"}",["T_WHITESPACE","\n\n    ",815],["T_DOC_COMMENT","\/**\n     * Check if product has required options\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return bool\n     *\/",817],["T_WHITESPACE","\n    ",822],["T_PUBLIC","public",823],["T_WHITESPACE"," ",823],["T_FUNCTION","function",823],["T_WHITESPACE"," ",823],["T_STRING","hasRequiredOptions",823],"(",["T_VARIABLE","$product",823],["T_WHITESPACE"," ",823],"=",["T_WHITESPACE"," ",823],["T_STRING","null",823],")",["T_WHITESPACE","\n    ",823],"{",["T_WHITESPACE","\n        ",824],["T_IF","if",825],["T_WHITESPACE"," ",825],"(",["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","getProduct",825],"(",["T_VARIABLE","$product",825],")",["T_OBJECT_OPERATOR","->",825],["T_STRING","getRequiredOptions",825],"(",")",")",["T_WHITESPACE"," ",825],"{",["T_WHITESPACE","\n            ",825],["T_RETURN","return",826],["T_WHITESPACE"," ",826],["T_STRING","true",826],";",["T_WHITESPACE","\n        ",826],"}",["T_WHITESPACE","\n        ",827],["T_RETURN","return",828],["T_WHITESPACE"," ",828],["T_STRING","false",828],";",["T_WHITESPACE","\n    ",828],"}",["T_WHITESPACE","\n\n    ",829],["T_DOC_COMMENT","\/**\n     * Retrive store filter for associated products\n     *\n     * @return int|Mage_Core_Model_Store\n     *\/",831],["T_WHITESPACE","\n    ",835],["T_PUBLIC","public",836],["T_WHITESPACE"," ",836],["T_FUNCTION","function",836],["T_WHITESPACE"," ",836],["T_STRING","getStoreFilter",836],"(",["T_VARIABLE","$product",836],["T_WHITESPACE"," ",836],"=",["T_WHITESPACE"," ",836],["T_STRING","null",836],")",["T_WHITESPACE","\n    ",836],"{",["T_WHITESPACE","\n        ",837],["T_VARIABLE","$cacheKey",838],["T_WHITESPACE"," ",838],"=",["T_WHITESPACE"," ",838],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_store_filter'",838],";",["T_WHITESPACE","\n        ",838],["T_RETURN","return",839],["T_WHITESPACE"," ",839],["T_VARIABLE","$this",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","getProduct",839],"(",["T_VARIABLE","$product",839],")",["T_OBJECT_OPERATOR","->",839],["T_STRING","getData",839],"(",["T_VARIABLE","$cacheKey",839],")",";",["T_WHITESPACE","\n    ",839],"}",["T_WHITESPACE","\n\n    ",840],["T_DOC_COMMENT","\/**\n     * Set store filter for associated products\n     *\n     * @param $store int|Mage_Core_Model_Store\n     * @return Mage_Catalog_Model_Product_Type_Configurable\n     *\/",842],["T_WHITESPACE","\n    ",847],["T_PUBLIC","public",848],["T_WHITESPACE"," ",848],["T_FUNCTION","function",848],["T_WHITESPACE"," ",848],["T_STRING","setStoreFilter",848],"(",["T_VARIABLE","$store",848],"=",["T_STRING","null",848],",",["T_WHITESPACE"," ",848],["T_VARIABLE","$product",848],["T_WHITESPACE"," ",848],"=",["T_WHITESPACE"," ",848],["T_STRING","null",848],")",["T_WHITESPACE","\n    ",848],"{",["T_WHITESPACE","\n        ",849],["T_VARIABLE","$cacheKey",850],["T_WHITESPACE"," ",850],"=",["T_WHITESPACE"," ",850],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_store_filter'",850],";",["T_WHITESPACE","\n        ",850],["T_VARIABLE","$this",851],["T_OBJECT_OPERATOR","->",851],["T_STRING","getProduct",851],"(",["T_VARIABLE","$product",851],")",["T_OBJECT_OPERATOR","->",851],["T_STRING","setData",851],"(",["T_VARIABLE","$cacheKey",851],",",["T_WHITESPACE"," ",851],["T_VARIABLE","$store",851],")",";",["T_WHITESPACE","\n        ",851],["T_RETURN","return",852],["T_WHITESPACE"," ",852],["T_VARIABLE","$this",852],";",["T_WHITESPACE","\n    ",852],"}",["T_WHITESPACE","\n\n    ",853],["T_DOC_COMMENT","\/**\n     * Allow for updates of chidren qty's\n     * (applicable for complicated product types. As default returns false)\n     *\n     * @return boolean false\n     *\/",855],["T_WHITESPACE","\n    ",860],["T_PUBLIC","public",861],["T_WHITESPACE"," ",861],["T_FUNCTION","function",861],["T_WHITESPACE"," ",861],["T_STRING","getForceChildItemQtyChanges",861],"(",["T_VARIABLE","$product",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_STRING","null",861],")",["T_WHITESPACE","\n    ",861],"{",["T_WHITESPACE","\n        ",862],["T_RETURN","return",863],["T_WHITESPACE"," ",863],["T_STRING","false",863],";",["T_WHITESPACE","\n    ",863],"}",["T_WHITESPACE","\n\n    ",864],["T_DOC_COMMENT","\/**\n     * Prepare Quote Item Quantity\n     *\n     * @param mixed $qty\n     * @return float\n     *\/",866],["T_WHITESPACE","\n    ",871],["T_PUBLIC","public",872],["T_WHITESPACE"," ",872],["T_FUNCTION","function",872],["T_WHITESPACE"," ",872],["T_STRING","prepareQuoteItemQty",872],"(",["T_VARIABLE","$qty",872],",",["T_WHITESPACE"," ",872],["T_VARIABLE","$product",872],["T_WHITESPACE"," ",872],"=",["T_WHITESPACE"," ",872],["T_STRING","null",872],")",["T_WHITESPACE","\n    ",872],"{",["T_WHITESPACE","\n        ",873],["T_RETURN","return",874],["T_WHITESPACE"," ",874],["T_STRING","floatval",874],"(",["T_VARIABLE","$qty",874],")",";",["T_WHITESPACE","\n    ",874],"}",["T_WHITESPACE","\n\n    ",875],["T_DOC_COMMENT","\/**\n     * Implementation of product specify logic of which product needs to be assigned to option.\n     * For example if product which was added to option already removed from catalog.\n     *\n     * @param Mage_Catalog_Model_Product $optionProduct\n     * @param Mage_Sales_Model_Quote_Item_Option $option\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",877],["T_WHITESPACE","\n    ",885],["T_PUBLIC","public",886],["T_WHITESPACE"," ",886],["T_FUNCTION","function",886],["T_WHITESPACE"," ",886],["T_STRING","assignProductToOption",886],"(",["T_VARIABLE","$optionProduct",886],",",["T_WHITESPACE"," ",886],["T_VARIABLE","$option",886],",",["T_WHITESPACE"," ",886],["T_VARIABLE","$product",886],["T_WHITESPACE"," ",886],"=",["T_WHITESPACE"," ",886],["T_STRING","null",886],")",["T_WHITESPACE","\n    ",886],"{",["T_WHITESPACE","\n        ",887],["T_VARIABLE","$option",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","setProduct",888],"(",["T_VARIABLE","$optionProduct",888],["T_WHITESPACE"," ",888],"?",["T_WHITESPACE"," ",888],["T_VARIABLE","$optionProduct",888],["T_WHITESPACE"," ",888],":",["T_WHITESPACE"," ",888],["T_VARIABLE","$this",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","getProduct",888],"(",["T_VARIABLE","$product",888],")",")",";",["T_WHITESPACE","\n        ",888],["T_RETURN","return",889],["T_WHITESPACE"," ",889],["T_VARIABLE","$this",889],";",["T_WHITESPACE","\n    ",889],"}",["T_WHITESPACE","\n\n    ",890],["T_DOC_COMMENT","\/**\n     * Setting specified product type variables\n     *\n     * @param array $config\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",892],["T_WHITESPACE","\n    ",897],["T_PUBLIC","public",898],["T_WHITESPACE"," ",898],["T_FUNCTION","function",898],["T_WHITESPACE"," ",898],["T_STRING","setConfig",898],"(",["T_VARIABLE","$config",898],")",["T_WHITESPACE","\n    ",898],"{",["T_WHITESPACE","\n        ",899],["T_IF","if",900],["T_WHITESPACE"," ",900],"(",["T_ISSET","isset",900],"(",["T_VARIABLE","$config",900],"[",["T_CONSTANT_ENCAPSED_STRING","'composite'",900],"]",")",")",["T_WHITESPACE"," ",900],"{",["T_WHITESPACE","\n            ",900],["T_VARIABLE","$this",901],["T_OBJECT_OPERATOR","->",901],["T_STRING","_isComposite",901],["T_WHITESPACE"," ",901],"=",["T_WHITESPACE"," ",901],["T_BOOL_CAST","(bool)",901],["T_WHITESPACE"," ",901],["T_VARIABLE","$config",901],"[",["T_CONSTANT_ENCAPSED_STRING","'composite'",901],"]",";",["T_WHITESPACE","\n        ",901],"}",["T_WHITESPACE","\n\n        ",902],["T_IF","if",904],["T_WHITESPACE"," ",904],"(",["T_ISSET","isset",904],"(",["T_VARIABLE","$config",904],"[",["T_CONSTANT_ENCAPSED_STRING","'can_use_qty_decimals'",904],"]",")",")",["T_WHITESPACE"," ",904],"{",["T_WHITESPACE","\n            ",904],["T_VARIABLE","$this",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","_canUseQtyDecimals",905],["T_WHITESPACE"," ",905],"=",["T_WHITESPACE"," ",905],["T_BOOL_CAST","(bool)",905],["T_WHITESPACE"," ",905],["T_VARIABLE","$config",905],"[",["T_CONSTANT_ENCAPSED_STRING","'can_use_qty_decimals'",905],"]",";",["T_WHITESPACE","\n        ",905],"}",["T_WHITESPACE","\n\n        ",906],["T_RETURN","return",908],["T_WHITESPACE"," ",908],["T_VARIABLE","$this",908],";",["T_WHITESPACE","\n    ",908],"}",["T_WHITESPACE","\n\n    ",909],["T_DOC_COMMENT","\/**\n     * Retrieve additional searchable data from type instance\n     * Using based on product id and store_id data\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",911],["T_WHITESPACE","\n    ",917],["T_PUBLIC","public",918],["T_WHITESPACE"," ",918],["T_FUNCTION","function",918],["T_WHITESPACE"," ",918],["T_STRING","getSearchableData",918],"(",["T_VARIABLE","$product",918],["T_WHITESPACE"," ",918],"=",["T_WHITESPACE"," ",918],["T_STRING","null",918],")",["T_WHITESPACE","\n    ",918],"{",["T_WHITESPACE","\n        ",919],["T_VARIABLE","$product",920],["T_WHITESPACE","    ",920],"=",["T_WHITESPACE"," ",920],["T_VARIABLE","$this",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","getProduct",920],"(",["T_VARIABLE","$product",920],")",";",["T_WHITESPACE","\n        ",920],["T_VARIABLE","$searchData",921],["T_WHITESPACE"," ",921],"=",["T_WHITESPACE"," ",921],["T_ARRAY","array",921],"(",")",";",["T_WHITESPACE","\n        ",921],["T_IF","if",922],["T_WHITESPACE"," ",922],"(",["T_VARIABLE","$product",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","getHasOptions",922],"(",")",")","{",["T_WHITESPACE","\n            ",922],["T_VARIABLE","$searchData",923],["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_STRING","Mage",923],["T_DOUBLE_COLON","::",923],["T_STRING","getSingleton",923],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option'",923],")",["T_WHITESPACE","\n                ",923],["T_OBJECT_OPERATOR","->",924],["T_STRING","getSearchableData",924],"(",["T_VARIABLE","$product",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","getId",924],"(",")",",",["T_WHITESPACE"," ",924],["T_VARIABLE","$product",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","getStoreId",924],"(",")",")",";",["T_WHITESPACE","\n        ",924],"}",["T_WHITESPACE","\n\n        ",925],["T_RETURN","return",927],["T_WHITESPACE"," ",927],["T_VARIABLE","$searchData",927],";",["T_WHITESPACE","\n    ",927],"}",["T_WHITESPACE","\n\n    ",928],["T_DOC_COMMENT","\/**\n     * Retrieve products divided into groups required to purchase\n     * At least one product in each group has to be purchased\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",930],["T_WHITESPACE","\n    ",936],["T_PUBLIC","public",937],["T_WHITESPACE"," ",937],["T_FUNCTION","function",937],["T_WHITESPACE"," ",937],["T_STRING","getProductsToPurchaseByReqGroups",937],"(",["T_VARIABLE","$product",937],["T_WHITESPACE"," ",937],"=",["T_WHITESPACE"," ",937],["T_STRING","null",937],")",["T_WHITESPACE","\n    ",937],"{",["T_WHITESPACE","\n        ",938],["T_VARIABLE","$product",939],["T_WHITESPACE"," ",939],"=",["T_WHITESPACE"," ",939],["T_VARIABLE","$this",939],["T_OBJECT_OPERATOR","->",939],["T_STRING","getProduct",939],"(",["T_VARIABLE","$product",939],")",";",["T_WHITESPACE","\n        ",939],["T_IF","if",940],["T_WHITESPACE"," ",940],"(",["T_VARIABLE","$this",940],["T_OBJECT_OPERATOR","->",940],["T_STRING","isComposite",940],"(",["T_VARIABLE","$product",940],")",")",["T_WHITESPACE"," ",940],"{",["T_WHITESPACE","\n            ",940],["T_RETURN","return",941],["T_WHITESPACE"," ",941],["T_ARRAY","array",941],"(",")",";",["T_WHITESPACE","\n        ",941],"}",["T_WHITESPACE","\n        ",942],["T_RETURN","return",943],["T_WHITESPACE"," ",943],["T_ARRAY","array",943],"(",["T_ARRAY","array",943],"(",["T_VARIABLE","$product",943],")",")",";",["T_WHITESPACE","\n    ",943],"}",["T_WHITESPACE","\n\n    ",944],["T_DOC_COMMENT","\/**\n     * Prepare selected options for product\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @param  Varien_Object $buyRequest\n     * @return array\n     *\/",946],["T_WHITESPACE","\n    ",952],["T_PUBLIC","public",953],["T_WHITESPACE"," ",953],["T_FUNCTION","function",953],["T_WHITESPACE"," ",953],["T_STRING","processBuyRequest",953],"(",["T_VARIABLE","$product",953],",",["T_WHITESPACE"," ",953],["T_VARIABLE","$buyRequest",953],")",["T_WHITESPACE","\n    ",953],"{",["T_WHITESPACE","\n        ",954],["T_RETURN","return",955],["T_WHITESPACE"," ",955],["T_ARRAY","array",955],"(",")",";",["T_WHITESPACE","\n    ",955],"}",["T_WHITESPACE","\n\n    ",956],["T_DOC_COMMENT","\/**\n     * Check product's options configuration\n     *\n     * @param  Mage_Catalog_Model_Product $product\n     * @param  Varien_Object $buyRequest\n     * @return array\n     *\/",958],["T_WHITESPACE","\n    ",964],["T_PUBLIC","public",965],["T_WHITESPACE"," ",965],["T_FUNCTION","function",965],["T_WHITESPACE"," ",965],["T_STRING","checkProductConfiguration",965],"(",["T_VARIABLE","$product",965],",",["T_WHITESPACE"," ",965],["T_VARIABLE","$buyRequest",965],")",["T_WHITESPACE","\n    ",965],"{",["T_WHITESPACE","\n        ",966],["T_VARIABLE","$errors",967],["T_WHITESPACE"," ",967],"=",["T_WHITESPACE"," ",967],["T_ARRAY","array",967],"(",")",";",["T_WHITESPACE","\n\n        ",967],["T_TRY","try",969],["T_WHITESPACE"," ",969],"{",["T_WHITESPACE","\n            ",969],["T_DOC_COMMENT","\/**\n             * cloning product because prepareForCart() method will modify it\n             *\/",970],["T_WHITESPACE","\n            ",972],["T_VARIABLE","$productForCheck",973],["T_WHITESPACE"," ",973],"=",["T_WHITESPACE"," ",973],["T_CLONE","clone",973],["T_WHITESPACE"," ",973],["T_VARIABLE","$product",973],";",["T_WHITESPACE","\n            ",973],["T_VARIABLE","$buyRequestForCheck",974],["T_WHITESPACE"," ",974],"=",["T_WHITESPACE"," ",974],["T_CLONE","clone",974],["T_WHITESPACE"," ",974],["T_VARIABLE","$buyRequest",974],";",["T_WHITESPACE","\n            ",974],["T_VARIABLE","$result",975],["T_WHITESPACE"," ",975],"=",["T_WHITESPACE"," ",975],["T_VARIABLE","$this",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","prepareForCart",975],"(",["T_VARIABLE","$buyRequestForCheck",975],",",["T_WHITESPACE"," ",975],["T_VARIABLE","$productForCheck",975],")",";",["T_WHITESPACE","\n\n            ",975],["T_IF","if",977],["T_WHITESPACE"," ",977],"(",["T_STRING","is_string",977],"(",["T_VARIABLE","$result",977],")",")",["T_WHITESPACE"," ",977],"{",["T_WHITESPACE","\n               ",977],["T_VARIABLE","$errors",978],"[","]",["T_WHITESPACE"," ",978],"=",["T_WHITESPACE"," ",978],["T_VARIABLE","$result",978],";",["T_WHITESPACE","\n            ",978],"}",["T_WHITESPACE","\n        ",979],"}",["T_WHITESPACE"," ",980],["T_CATCH","catch",980],["T_WHITESPACE"," ",980],"(",["T_STRING","Mage_Core_Exception",980],["T_WHITESPACE"," ",980],["T_VARIABLE","$e",980],")",["T_WHITESPACE"," ",980],"{",["T_WHITESPACE","\n            ",980],["T_VARIABLE","$errors",981],"[","]",["T_WHITESPACE"," ",981],"=",["T_WHITESPACE"," ",981],["T_VARIABLE","$e",981],["T_OBJECT_OPERATOR","->",981],["T_STRING","getMessages",981],"(",")",";",["T_WHITESPACE","\n        ",981],"}",["T_WHITESPACE"," ",982],["T_CATCH","catch",982],["T_WHITESPACE"," ",982],"(",["T_STRING","Exception",982],["T_WHITESPACE"," ",982],["T_VARIABLE","$e",982],")",["T_WHITESPACE"," ",982],"{",["T_WHITESPACE","\n            ",982],["T_STRING","Mage",983],["T_DOUBLE_COLON","::",983],["T_STRING","logException",983],"(",["T_VARIABLE","$e",983],")",";",["T_WHITESPACE","\n            ",983],["T_VARIABLE","$errors",984],"[","]",["T_WHITESPACE"," ",984],"=",["T_WHITESPACE"," ",984],["T_STRING","Mage",984],["T_DOUBLE_COLON","::",984],["T_STRING","helper",984],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",984],")",["T_OBJECT_OPERATOR","->",984],["T_STRING","__",984],"(",["T_CONSTANT_ENCAPSED_STRING","'There was an error while request processing.'",984],")",";",["T_WHITESPACE","\n        ",984],"}",["T_WHITESPACE","\n\n        ",985],["T_RETURN","return",987],["T_WHITESPACE"," ",987],["T_VARIABLE","$errors",987],";",["T_WHITESPACE","\n    ",987],"}",["T_WHITESPACE","\n\n    ",988],["T_DOC_COMMENT","\/**\n     * Check if Minimum advertise price is enabled at least in one option\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param int $visibility\n     * @return bool\n     *\/",990],["T_WHITESPACE","\n    ",996],["T_PUBLIC","public",997],["T_WHITESPACE"," ",997],["T_FUNCTION","function",997],["T_WHITESPACE"," ",997],["T_STRING","isMapEnabledInOptions",997],"(",["T_VARIABLE","$product",997],",",["T_WHITESPACE"," ",997],["T_VARIABLE","$visibility",997],["T_WHITESPACE"," ",997],"=",["T_WHITESPACE"," ",997],["T_STRING","null",997],")",["T_WHITESPACE","\n    ",997],"{",["T_WHITESPACE","\n        ",998],["T_RETURN","return",999],["T_WHITESPACE"," ",999],["T_STRING","false",999],";",["T_WHITESPACE","\n    ",999],"}",["T_WHITESPACE","\n",1000],"}",["T_WHITESPACE","\n",1001]]