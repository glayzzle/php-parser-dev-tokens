[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog compare item resource model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Compare_Item",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Initialize connection\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_init",43],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/compare_item'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'catalog_compare_item_id'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Load object by product\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @param mixed $product\n     * @return bool\n     *\/",46],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","loadByProduct",53],"(",["T_STRING","Mage_Catalog_Model_Product_Compare_Item",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$object",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$product",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$read",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_getReadAdapter",55],"(",")",";",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$product",56],["T_WHITESPACE"," ",56],["T_INSTANCEOF","instanceof",56],["T_WHITESPACE"," ",56],["T_STRING","Mage_Catalog_Model_Product",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$productId",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$product",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getId",57],"(",")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE"," ",58],["T_ELSE","else",58],["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$productId",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$product",59],";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$select",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$read",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","select",61],"(",")",["T_OBJECT_OPERATOR","->",61],["T_STRING","from",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getMainTable",61],"(",")",")",["T_WHITESPACE","\n            ",61],["T_OBJECT_OPERATOR","->",62],["T_STRING","where",62],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id = ?'",62],",",["T_WHITESPACE"," ",62],["T_INT_CAST","(int)",62],["T_VARIABLE","$productId",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$object",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getCustomerId",64],"(",")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$select",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","where",65],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id = ?'",65],",",["T_WHITESPACE"," ",65],["T_INT_CAST","(int)",65],["T_VARIABLE","$object",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getCustomerId",65],"(",")",")",";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE"," ",66],["T_ELSE","else",66],["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$select",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","where",67],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_id = ?'",67],",",["T_WHITESPACE"," ",67],["T_INT_CAST","(int)",67],["T_VARIABLE","$object",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getVisitorId",67],"(",")",")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n\n        ",68],["T_VARIABLE","$data",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$read",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","fetchRow",70],"(",["T_VARIABLE","$select",70],")",";",["T_WHITESPACE","\n\n        ",70],["T_IF","if",72],["T_WHITESPACE"," ",72],"(","!",["T_VARIABLE","$data",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_STRING","false",73],";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$object",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","setData",76],"(",["T_VARIABLE","$data",76],")",";",["T_WHITESPACE","\n\n        ",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_afterLoad",78],"(",["T_VARIABLE","$object",78],")",";",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_STRING","true",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Resource retrieve count compare items\n     *\n     * @param int $customerId\n     * @param int $visitorId\n     * @return int\n     *\/",82],["T_WHITESPACE","\n    ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","getCount",89],"(",["T_VARIABLE","$customerId",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$visitorId",89],")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$bind",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",["T_CONSTANT_ENCAPSED_STRING","'visitore_id'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_INT_CAST","(int)",91],["T_VARIABLE","$visitorId",91],")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$select",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_getReadAdapter",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","select",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","from",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getMainTable",92],"(",")",",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",92],")",["T_WHITESPACE","\n            ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","where",93],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_id = :visitore_id'",93],")",";",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$customerId",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$bind",95],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",95],"]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_INT_CAST","(int)",95],["T_VARIABLE","$customerId",95],";",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$select",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","where",96],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id = :customer_id'",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_getReadAdapter",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","fetchOne",98],"(",["T_VARIABLE","$select",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$bind",98],")",";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Clean compare table\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Compare_Item\n     *\/",101],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","clean",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_WHILE","while",108],["T_WHITESPACE"," ",108],"(",["T_STRING","true",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$select",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_getReadAdapter",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","select",109],"(",")",["T_WHITESPACE","\n                ",109],["T_OBJECT_OPERATOR","->",110],["T_STRING","from",110],"(",["T_ARRAY","array",110],"(",["T_CONSTANT_ENCAPSED_STRING","'compare_table'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getMainTable",110],"(",")",")",",",["T_WHITESPACE"," ",110],["T_ARRAY","array",110],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_compare_item_id'",110],")",")",["T_WHITESPACE","\n                ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","joinLeft",111],"(",["T_WHITESPACE","\n                    ",111],["T_ARRAY","array",112],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_table'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getTable",112],"(",["T_CONSTANT_ENCAPSED_STRING","'log\/visitor'",112],")",")",",",["T_WHITESPACE","\n                    ",112],["T_CONSTANT_ENCAPSED_STRING","'visitor_table.visitor_id=compare_table.visitor_id AND compare_table.customer_id IS NULL'",113],",",["T_WHITESPACE","\n                    ",113],["T_ARRAY","array",114],"(",")",")",["T_WHITESPACE","\n                ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","where",115],"(",["T_CONSTANT_ENCAPSED_STRING","'compare_table.visitor_id > ?'",115],",",["T_WHITESPACE"," ",115],["T_LNUMBER","0",115],")",["T_WHITESPACE","\n                ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","where",116],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_table.visitor_id IS NULL'",116],")",["T_WHITESPACE","\n                ",116],["T_OBJECT_OPERATOR","->",117],["T_STRING","limit",117],"(",["T_LNUMBER","100",117],")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$itemIds",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_getReadAdapter",118],"(",")",["T_OBJECT_OPERATOR","->",118],["T_STRING","fetchCol",118],"(",["T_VARIABLE","$select",118],")",";",["T_WHITESPACE","\n\n            ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_VARIABLE","$itemIds",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                ",120],["T_BREAK","break",121],";",["T_WHITESPACE","\n            ",121],"}",["T_WHITESPACE","\n\n            ",122],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_getWriteAdapter",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","delete",124],"(",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getMainTable",125],"(",")",",",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_getWriteAdapter",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","quoteInto",126],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_compare_item_id IN(?)'",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$itemIds",126],")",["T_WHITESPACE","\n            ",126],")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Purge visitor data after customer logout\n     *\n     * @param Mage_Catalog_Model_Product_Compare_Item $object\n     * @return Mage_Catalog_Model_Resource_Product_Compare_Item\n     *\/",133],["T_WHITESPACE","\n    ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","purgeVisitorByCustomer",139],"(",["T_VARIABLE","$object",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(","!",["T_VARIABLE","$object",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getCustomerId",141],"(",")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$where",145],["T_WHITESPACE","  ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getWriteAdapter",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","quoteInto",145],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id=?'",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$object",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getCustomerId",145],"(",")",")",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$bind",146],["T_WHITESPACE","   ",146],"=",["T_WHITESPACE"," ",146],["T_ARRAY","array",146],"(",["T_WHITESPACE","\n            ",146],["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_LNUMBER","0",147],",",["T_WHITESPACE","\n        ",147],")",";",["T_WHITESPACE","\n\n        ",148],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_getWriteAdapter",150],"(",")",["T_OBJECT_OPERATOR","->",150],["T_STRING","update",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getMainTable",150],"(",")",",",["T_WHITESPACE"," ",150],["T_VARIABLE","$bind",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$where",150],")",";",["T_WHITESPACE","\n\n        ",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Update (Merge) customer data from visitor\n     * After Login process\n     *\n     * @param Mage_Catalog_Model_Product_Compare_Item $object\n     * @return Mage_Catalog_Model_Resource_Product_Compare_Item\n     *\/",155],["T_WHITESPACE","\n    ",161],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","updateCustomerFromVisitor",162],"(",["T_VARIABLE","$object",162],")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(","!",["T_VARIABLE","$object",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getCustomerId",164],"(",")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_COMMENT","\/\/ collect visitor compared items\n",168],["T_WHITESPACE","        ",169],["T_VARIABLE","$select",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_getWriteAdapter",169],"(",")",["T_OBJECT_OPERATOR","->",169],["T_STRING","select",169],"(",")",["T_WHITESPACE","\n            ",169],["T_OBJECT_OPERATOR","->",170],["T_STRING","from",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getMainTable",170],"(",")",")",["T_WHITESPACE","\n            ",170],["T_OBJECT_OPERATOR","->",171],["T_STRING","where",171],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_id=?'",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$object",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getVisitorId",171],"(",")",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$visitor",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_getWriteAdapter",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","fetchAll",172],"(",["T_VARIABLE","$select",172],")",";",["T_WHITESPACE","\n\n        ",172],["T_COMMENT","\/\/ collect customer compared items\n",174],["T_WHITESPACE","        ",175],["T_VARIABLE","$select",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_getWriteAdapter",175],"(",")",["T_OBJECT_OPERATOR","->",175],["T_STRING","select",175],"(",")",["T_WHITESPACE","\n            ",175],["T_OBJECT_OPERATOR","->",176],["T_STRING","from",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getMainTable",176],"(",")",")",["T_WHITESPACE","\n            ",176],["T_OBJECT_OPERATOR","->",177],["T_STRING","where",177],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id = ?'",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$object",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getCustomerId",177],"(",")",")",["T_WHITESPACE","\n            ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","where",178],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_id != ?'",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$object",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getVisitorId",178],"(",")",")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$customer",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_getWriteAdapter",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","fetchAll",179],"(",["T_VARIABLE","$select",179],")",";",["T_WHITESPACE","\n\n        ",179],["T_VARIABLE","$products",181],["T_WHITESPACE","   ",181],"=",["T_WHITESPACE"," ",181],["T_ARRAY","array",181],"(",")",";",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$delete",182],["T_WHITESPACE","     ",182],"=",["T_WHITESPACE"," ",182],["T_ARRAY","array",182],"(",")",";",["T_WHITESPACE","\n        ",182],["T_VARIABLE","$update",183],["T_WHITESPACE","     ",183],"=",["T_WHITESPACE"," ",183],["T_ARRAY","array",183],"(",")",";",["T_WHITESPACE","\n        ",183],["T_FOREACH","foreach",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$visitor",184],["T_WHITESPACE"," ",184],["T_AS","as",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$row",184],")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_VARIABLE","$products",185],"[",["T_VARIABLE","$row",185],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",185],"]","]",["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_ARRAY","array",185],"(",["T_WHITESPACE","\n                ",185],["T_CONSTANT_ENCAPSED_STRING","'store_id'",186],["T_WHITESPACE","      ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$row",186],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",186],"]",",",["T_WHITESPACE","\n                ",186],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",187],["T_WHITESPACE","   ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$object",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getCustomerId",187],"(",")",",",["T_WHITESPACE","\n                ",187],["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",188],["T_WHITESPACE","    ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$object",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getVisitorId",188],"(",")",",",["T_WHITESPACE","\n                ",188],["T_CONSTANT_ENCAPSED_STRING","'product_id'",189],["T_WHITESPACE","    ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$row",189],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",189],"]",["T_WHITESPACE","\n            ",189],")",";",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$update",191],"[",["T_VARIABLE","$row",191],"[",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getIdFieldName",191],"(",")","]","]",["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$row",191],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",191],"]",";",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n\n        ",192],["T_FOREACH","foreach",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$customer",194],["T_WHITESPACE"," ",194],["T_AS","as",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$row",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_ISSET","isset",195],"(",["T_VARIABLE","$products",195],"[",["T_VARIABLE","$row",195],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",195],"]","]",")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$delete",196],"[","]",["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$row",196],"[",["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getIdFieldName",196],"(",")","]",";",["T_WHITESPACE","\n            ",196],"}",["T_WHITESPACE","\n            ",197],["T_ELSE","else",198],["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$products",199],"[",["T_VARIABLE","$row",199],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",199],"]","]",["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_ARRAY","array",199],"(",["T_WHITESPACE","\n                    ",199],["T_CONSTANT_ENCAPSED_STRING","'store_id'",200],["T_WHITESPACE","      ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$row",200],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",200],"]",",",["T_WHITESPACE","\n                    ",200],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",201],["T_WHITESPACE","   ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$object",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getCustomerId",201],"(",")",",",["T_WHITESPACE","\n                    ",201],["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",202],["T_WHITESPACE","    ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$object",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getVisitorId",202],"(",")",",",["T_WHITESPACE","\n                    ",202],["T_CONSTANT_ENCAPSED_STRING","'product_id'",203],["T_WHITESPACE","    ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$row",203],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",203],"]",["T_WHITESPACE","\n                ",203],")",";",["T_WHITESPACE","\n            ",204],"}",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n\n        ",206],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$delete",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_getWriteAdapter",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","delete",209],"(",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getMainTable",209],"(",")",",",["T_WHITESPACE","\n                ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_getWriteAdapter",210],"(",")",["T_OBJECT_OPERATOR","->",210],["T_STRING","quoteInto",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getIdFieldName",210],"(",")",["T_WHITESPACE"," ",210],".",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","' IN(?)'",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$delete",210],")",")",";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n        ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$update",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_FOREACH","foreach",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$update",213],["T_WHITESPACE"," ",213],["T_AS","as",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$itemId",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$productId",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                ",213],["T_VARIABLE","$bind",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$products",214],"[",["T_VARIABLE","$productId",214],"]",";",["T_WHITESPACE","\n                ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_getWriteAdapter",215],"(",")",["T_OBJECT_OPERATOR","->",215],["T_STRING","update",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getMainTable",215],"(",")",",",["T_WHITESPACE"," ",215],["T_VARIABLE","$bind",215],",",["T_WHITESPACE","\n                    ",215],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_getWriteAdapter",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","quoteInto",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getIdFieldName",216],"(",")",["T_WHITESPACE"," ",216],".",["T_WHITESPACE"," ",216],["T_CONSTANT_ENCAPSED_STRING","'=?'",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$itemId",216],")",")",";",["T_WHITESPACE","\n            ",216],"}",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE","\n\n        ",218],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Clear compare items by visitor and\/or customer\n     *\n     * @param int $visitorId\n     * @param int $customerId\n     * @return Mage_Catalog_Model_Resource_Product_Compare_Item\n     *\/",223],["T_WHITESPACE","\n    ",229],["T_PUBLIC","public",230],["T_WHITESPACE"," ",230],["T_FUNCTION","function",230],["T_WHITESPACE"," ",230],["T_STRING","clearItems",230],"(",["T_VARIABLE","$visitorId",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_STRING","null",230],",",["T_WHITESPACE"," ",230],["T_VARIABLE","$customerId",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_STRING","null",230],")",["T_WHITESPACE","\n    ",230],"{",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$where",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_ARRAY","array",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$customerId",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n            ",233],["T_VARIABLE","$customerId",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_INT_CAST","(int)",234],["T_VARIABLE","$customerId",234],";",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$where",235],"[","]",["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_getWriteAdapter",235],"(",")",["T_OBJECT_OPERATOR","->",235],["T_STRING","quoteInto",235],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id = ?'",235],",",["T_WHITESPACE"," ",235],["T_VARIABLE","$customerId",235],")",";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n        ",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$visitorId",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$visitorId",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_INT_CAST","(int)",238],["T_VARIABLE","$visitorId",238],";",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$where",239],"[","]",["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_getWriteAdapter",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","quoteInto",239],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_id = ?'",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$visitorId",239],")",";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(","!",["T_VARIABLE","$where",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_getWriteAdapter",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","delete",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getMainTable",244],"(",")",",",["T_WHITESPACE"," ",244],["T_VARIABLE","$where",244],")",";",["T_WHITESPACE","\n        ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n",246],"}",["T_WHITESPACE","\n",247]]