[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Catalog_Model_Convert_Parser_Product",28],["T_WHITESPACE","\n    ",28],["T_EXTENDS","extends",29],["T_WHITESPACE"," ",29],["T_STRING","Mage_Eav_Model_Convert_Parser_Abstract",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n    ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","MULTI_DELIMITER",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","' , '",31],";",["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$_resource",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Product collections per store\n     *\n     * @var array\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$_collections",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Product Type Instances object cache\n     *\n     * @var array\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_productTypeInstances",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_ARRAY","array",46],"(",")",";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Product Type cache\n     *\n     * @var array\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$_productTypes",53],";",["T_WHITESPACE","\n\n    ",53],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_inventoryFields",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_ARRAY","array",55],"(",")",";",["T_WHITESPACE","\n\n    ",55],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_imageFields",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",")",";",["T_WHITESPACE","\n\n    ",57],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_systemFields",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_ARRAY","array",59],"(",")",";",["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_internalFields",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",")",";",["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_externalFields",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",";",["T_WHITESPACE","\n\n    ",61],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_inventoryItems",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",")",";",["T_WHITESPACE","\n\n    ",63],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_productModel",65],";",["T_WHITESPACE","\n\n    ",65],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_setInstances",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_ARRAY","array",67],"(",")",";",["T_WHITESPACE","\n\n    ",67],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_store",69],";",["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_storeId",70],";",["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_attributes",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_ARRAY","array",71],"(",")",";",["T_WHITESPACE","\n\n    ",71],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","__construct",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_FOREACH","foreach",75],["T_WHITESPACE"," ",75],"(",["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","getConfig",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","getFieldset",75],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_dataflow'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'admin'",75],")",["T_WHITESPACE"," ",75],["T_AS","as",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$code",75],["T_DOUBLE_ARROW","=>",75],["T_VARIABLE","$node",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$node",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","is",76],"(",["T_CONSTANT_ENCAPSED_STRING","'inventory'",76],")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_inventoryFields",77],"[","]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$code",77],";",["T_WHITESPACE","\n                ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$node",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","is",78],"(",["T_CONSTANT_ENCAPSED_STRING","'use_config'",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                    ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_inventoryFields",79],"[","]",["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'use_config_'",79],".",["T_VARIABLE","$code",79],";",["T_WHITESPACE","\n                ",79],"}",["T_WHITESPACE","\n            ",80],"}",["T_WHITESPACE","\n            ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$node",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","is",82],"(",["T_CONSTANT_ENCAPSED_STRING","'internal'",82],")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_internalFields",83],"[","]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$code",83],";",["T_WHITESPACE","\n            ",83],"}",["T_WHITESPACE","\n            ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$node",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","is",85],"(",["T_CONSTANT_ENCAPSED_STRING","'system'",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_systemFields",86],"[","]",["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$code",86],";",["T_WHITESPACE","\n            ",86],"}",["T_WHITESPACE","\n            ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$node",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","is",88],"(",["T_CONSTANT_ENCAPSED_STRING","'external'",88],")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_externalFields",89],"[",["T_VARIABLE","$code",89],"]",["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$code",89],";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n            ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$node",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","is",91],"(",["T_CONSTANT_ENCAPSED_STRING","'img'",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_imageFields",92],"[","]",["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$code",92],";",["T_WHITESPACE","\n            ",92],"}",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * @return Mage_Catalog_Model_Mysql4_Convert\n     *\/",97],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","getResource",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_resource",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_resource",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","Mage",103],["T_DOUBLE_COLON","::",103],["T_STRING","getResourceSingleton",103],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_entity\/convert'",103],")",";",["T_WHITESPACE","\n                ",103],["T_COMMENT","#->loadStores()\n",104],["T_WHITESPACE","                ",105],["T_COMMENT","#->loadProducts()\n",105],["T_WHITESPACE","                ",106],["T_COMMENT","#->loadAttributeSets()\n",106],["T_WHITESPACE","                ",107],["T_COMMENT","#->loadAttributeOptions();\n",107],["T_WHITESPACE","        ",108],"}",["T_WHITESPACE","\n        ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_resource",109],";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","getCollection",112],"(",["T_VARIABLE","$storeId",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(","!",["T_ISSET","isset",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_collections",114],"[",["T_VARIABLE","$storeId",114],"]",")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_collections",115],"[",["T_VARIABLE","$storeId",115],"]",["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","Mage",115],["T_DOUBLE_COLON","::",115],["T_STRING","getResourceModel",115],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_collection'",115],")",";",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_collections",116],"[",["T_VARIABLE","$storeId",116],"]",["T_OBJECT_OPERATOR","->",116],["T_STRING","getEntity",116],"(",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","setStore",116],"(",["T_VARIABLE","$storeId",116],")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n        ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_collections",118],"[",["T_VARIABLE","$storeId",118],"]",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Retrieve product type options\n     *\n     * @return array\n     *\/",121],["T_WHITESPACE","\n    ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","getProductTypes",126],"(",")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_STRING","is_null",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_productTypes",128],")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_productTypes",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","Mage",129],["T_DOUBLE_COLON","::",129],["T_STRING","getSingleton",129],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",129],")",["T_WHITESPACE","\n                ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","getOptionArray",130],"(",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_productTypes",132],";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * Retrieve Product type name by code\n     *\n     * @param string $code\n     * @return string\n     *\/",135],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","getProductTypeName",141],"(",["T_VARIABLE","$code",141],")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$productTypes",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getProductTypes",143],"(",")",";",["T_WHITESPACE","\n        ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_ISSET","isset",144],"(",["T_VARIABLE","$productTypes",144],"[",["T_VARIABLE","$code",144],"]",")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$productTypes",145],"[",["T_VARIABLE","$code",145],"]",";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n        ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_STRING","false",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Retrieve product type code by name\n     *\n     * @param string $name\n     * @return string\n     *\/",150],["T_WHITESPACE","\n    ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","getProductTypeId",156],"(",["T_VARIABLE","$name",156],")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$productTypes",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getProductTypes",158],"(",")",";",["T_WHITESPACE","\n        ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$code",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","array_search",159],"(",["T_VARIABLE","$name",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$productTypes",159],")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$code",160],";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_STRING","false",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Retrieve product model cache\n     *\n     * @return Mage_Catalog_Model_Product\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","getProductModel",170],"(",")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_STRING","is_null",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_productModel",172],")",")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$productModel",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","getModel",173],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",173],")",";",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_productModel",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","Mage",174],["T_DOUBLE_COLON","::",174],["T_STRING","objects",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","save",174],"(",["T_VARIABLE","$productModel",174],")",";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE","\n        ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_STRING","Mage",176],["T_DOUBLE_COLON","::",176],["T_STRING","objects",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","load",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_productModel",176],")",";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Retrieve current store model\n     *\n     * @return Mage_Core_Model_Store\n     *\/",179],["T_WHITESPACE","\n    ",183],["T_PUBLIC","public",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","getStore",184],"(",")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(",["T_STRING","is_null",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_store",186],")",")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_TRY","try",187],["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$store",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_STRING","Mage",188],["T_DOUBLE_COLON","::",188],["T_STRING","app",188],"(",")",["T_OBJECT_OPERATOR","->",188],["T_STRING","getStore",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getVar",188],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",188],")",")",";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE"," ",189],["T_CATCH","catch",189],["T_WHITESPACE"," ",189],"(",["T_STRING","Exception",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$e",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","addException",190],"(",["T_WHITESPACE","\n                    ",190],["T_STRING","Mage",191],["T_DOUBLE_COLON","::",191],["T_STRING","helper",191],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",191],")",["T_OBJECT_OPERATOR","->",191],["T_STRING","__",191],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid store specified'",191],")",",",["T_WHITESPACE","\n                    ",191],["T_STRING","Varien_Convert_Exception",192],["T_DOUBLE_COLON","::",192],["T_STRING","FATAL",192],["T_WHITESPACE","\n                ",192],")",";",["T_WHITESPACE","\n                ",193],["T_THROW","throw",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$e",194],";",["T_WHITESPACE","\n            ",194],"}",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_store",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$store",196],";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n        ",197],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_store",198],";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Retrieve store ID\n     *\n     * @return int\n     *\/",201],["T_WHITESPACE","\n    ",205],["T_PUBLIC","public",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","getStoreId",206],"(",")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_STRING","is_null",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_storeId",208],")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_storeId",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getStore",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","getId",209],"(",")",";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_storeId",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * ReDefine Product Type Instance to Product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Convert_Parser_Product\n     *\/",214],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","setProductTypeInstance",220],"(",["T_STRING","Mage_Catalog_Model_Product",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$product",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$type",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$product",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getTypeId",222],"(",")",";",["T_WHITESPACE","\n        ",222],["T_IF","if",223],["T_WHITESPACE"," ",223],"(","!",["T_ISSET","isset",223],"(",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_productTypeInstances",223],"[",["T_VARIABLE","$type",223],"]",")",")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n            ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_productTypeInstances",224],"[",["T_VARIABLE","$type",224],"]",["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_STRING","Mage",224],["T_DOUBLE_COLON","::",224],["T_STRING","getSingleton",224],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",224],")",["T_WHITESPACE","\n                ",224],["T_OBJECT_OPERATOR","->",225],["T_STRING","factory",225],"(",["T_VARIABLE","$product",225],",",["T_WHITESPACE"," ",225],["T_STRING","true",225],")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$product",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","setTypeInstance",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_productTypeInstances",227],"[",["T_VARIABLE","$type",227],"]",",",["T_WHITESPACE"," ",227],["T_STRING","true",227],")",";",["T_WHITESPACE","\n        ",227],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","getAttributeSetInstance",231],"(",")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$productType",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getProductModel",233],"(",")",["T_OBJECT_OPERATOR","->",233],["T_STRING","getType",233],"(",")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$attributeSetId",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getProductModel",234],"(",")",["T_OBJECT_OPERATOR","->",234],["T_STRING","getAttributeSetId",234],"(",")",";",["T_WHITESPACE","\n\n        ",234],["T_IF","if",236],["T_WHITESPACE"," ",236],"(","!",["T_ISSET","isset",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_setInstances",236],"[",["T_VARIABLE","$productType",236],"]","[",["T_VARIABLE","$attributeSetId",236],"]",")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_setInstances",237],"[",["T_VARIABLE","$productType",237],"]","[",["T_VARIABLE","$attributeSetId",237],"]",["T_WHITESPACE"," ",237],"=",["T_WHITESPACE","\n                ",237],["T_STRING","Mage",238],["T_DOUBLE_COLON","::",238],["T_STRING","getSingleton",238],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",238],")",["T_OBJECT_OPERATOR","->",238],["T_STRING","factory",238],"(",["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getProductModel",238],"(",")",")",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n\n        ",239],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_setInstances",241],"[",["T_VARIABLE","$productType",241],"]","[",["T_VARIABLE","$attributeSetId",241],"]",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Retrieve eav entity attribute model\n     *\n     * @param string $code\n     * @return Mage_Eav_Model_Entity_Attribute\n     *\/",244],["T_WHITESPACE","\n    ",249],["T_PUBLIC","public",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","getAttribute",250],"(",["T_VARIABLE","$code",250],")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(","!",["T_ISSET","isset",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_attributes",252],"[",["T_VARIABLE","$code",252],"]",")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_attributes",253],"[",["T_VARIABLE","$code",253],"]",["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getProductModel",253],"(",")",["T_OBJECT_OPERATOR","->",253],["T_STRING","getResource",253],"(",")",["T_OBJECT_OPERATOR","->",253],["T_STRING","getAttribute",253],"(",["T_VARIABLE","$code",253],")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_attributes",255],"[",["T_VARIABLE","$code",255],"]",";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * @deprecated not used anymore\n     *\/",258],["T_WHITESPACE","\n    ",260],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","parse",261],"(",")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$data",263],["T_WHITESPACE","            ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getData",263],"(",")",";",["T_WHITESPACE","\n        ",263],["T_VARIABLE","$entityTypeId",264],["T_WHITESPACE","    ",264],"=",["T_WHITESPACE"," ",264],["T_STRING","Mage",264],["T_DOUBLE_COLON","::",264],["T_STRING","getSingleton",264],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",264],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","getEntityType",264],"(",["T_STRING","Mage_Catalog_Model_Product",264],["T_DOUBLE_COLON","::",264],["T_STRING","ENTITY",264],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","getId",264],"(",")",";",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$inventoryFields",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",")",";",["T_WHITESPACE","\n\n        ",265],["T_FOREACH","foreach",267],["T_WHITESPACE"," ",267],"(",["T_VARIABLE","$data",267],["T_WHITESPACE"," ",267],["T_AS","as",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$i",267],["T_DOUBLE_ARROW","=>",267],["T_VARIABLE","$row",267],")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n            ",267],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","setPosition",268],"(",["T_CONSTANT_ENCAPSED_STRING","'Line: '",268],".","(",["T_VARIABLE","$i",268],"+",["T_LNUMBER","1",268],")",")",";",["T_WHITESPACE","\n            ",268],["T_TRY","try",269],["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n                ",269],["T_COMMENT","\/\/ validate SKU\n",270],["T_WHITESPACE","                ",271],["T_IF","if",271],["T_WHITESPACE"," ",271],"(",["T_EMPTY","empty",271],"(",["T_VARIABLE","$row",271],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",271],"]",")",")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n                    ",271],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","addException",272],"(",["T_WHITESPACE","\n                        ",272],["T_STRING","Mage",273],["T_DOUBLE_COLON","::",273],["T_STRING","helper",273],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",273],")",["T_OBJECT_OPERATOR","->",273],["T_STRING","__",273],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing SKU, skipping the record.'",273],")",",",["T_WHITESPACE","\n                        ",273],["T_STRING","Mage_Dataflow_Model_Convert_Exception",274],["T_DOUBLE_COLON","::",274],["T_STRING","ERROR",274],["T_WHITESPACE","\n                    ",274],")",";",["T_WHITESPACE","\n                    ",275],["T_CONTINUE","continue",276],";",["T_WHITESPACE","\n                ",276],"}",["T_WHITESPACE","\n                ",277],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","setPosition",278],"(",["T_CONSTANT_ENCAPSED_STRING","'Line: '",278],".","(",["T_VARIABLE","$i",278],"+",["T_LNUMBER","1",278],")",".",["T_CONSTANT_ENCAPSED_STRING","', SKU: '",278],".",["T_VARIABLE","$row",278],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",278],"]",")",";",["T_WHITESPACE","\n\n                ",278],["T_COMMENT","\/\/ try to get entity_id by sku if not set\n",280],["T_WHITESPACE","                ",281],["T_IF","if",281],["T_WHITESPACE"," ",281],"(",["T_EMPTY","empty",281],"(",["T_VARIABLE","$row",281],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",281],"]",")",")",["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n                    ",281],["T_VARIABLE","$row",282],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",282],"]",["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getResource",282],"(",")",["T_OBJECT_OPERATOR","->",282],["T_STRING","getProductIdBySku",282],"(",["T_VARIABLE","$row",282],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",282],"]",")",";",["T_WHITESPACE","\n                ",282],"}",["T_WHITESPACE","\n\n                ",283],["T_COMMENT","\/\/ if attribute_set not set use default\n",285],["T_WHITESPACE","                ",286],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_EMPTY","empty",286],"(",["T_VARIABLE","$row",286],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set'",286],"]",")",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n                    ",286],["T_VARIABLE","$row",287],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set'",287],"]",["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_CONSTANT_ENCAPSED_STRING","'Default'",287],";",["T_WHITESPACE","\n                ",287],"}",["T_WHITESPACE","\n                ",288],["T_COMMENT","\/\/ get attribute_set_id, if not throw error\n",289],["T_WHITESPACE","                ",290],["T_VARIABLE","$row",290],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",290],"]",["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getAttributeSetId",290],"(",["T_VARIABLE","$entityTypeId",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$row",290],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set'",290],"]",")",";",["T_WHITESPACE","\n                ",290],["T_IF","if",291],["T_WHITESPACE"," ",291],"(","!",["T_VARIABLE","$row",291],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",291],"]",")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n                    ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","addException",292],"(",["T_WHITESPACE","\n                        ",292],["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","helper",293],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",293],")",["T_OBJECT_OPERATOR","->",293],["T_STRING","__",293],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid attribute set specified, skipping the record.'",293],")",",",["T_WHITESPACE","\n                        ",293],["T_STRING","Mage_Dataflow_Model_Convert_Exception",294],["T_DOUBLE_COLON","::",294],["T_STRING","ERROR",294],["T_WHITESPACE","\n                    ",294],")",";",["T_WHITESPACE","\n                    ",295],["T_CONTINUE","continue",296],";",["T_WHITESPACE","\n                ",296],"}",["T_WHITESPACE","\n\n                ",297],["T_IF","if",299],["T_WHITESPACE"," ",299],"(",["T_EMPTY","empty",299],"(",["T_VARIABLE","$row",299],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",299],"]",")",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n                    ",299],["T_VARIABLE","$row",300],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",300],"]",["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","'Simple'",300],";",["T_WHITESPACE","\n                ",300],"}",["T_WHITESPACE","\n                ",301],["T_COMMENT","\/\/ get product type_id, if not throw error\n",302],["T_WHITESPACE","                ",303],["T_VARIABLE","$row",303],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",303],"]",["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getProductTypeId",303],"(",["T_VARIABLE","$row",303],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",303],"]",")",";",["T_WHITESPACE","\n                ",303],["T_IF","if",304],["T_WHITESPACE"," ",304],"(","!",["T_VARIABLE","$row",304],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",304],"]",")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n                    ",304],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","addException",305],"(",["T_WHITESPACE","\n                        ",305],["T_STRING","Mage",306],["T_DOUBLE_COLON","::",306],["T_STRING","helper",306],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",306],")",["T_OBJECT_OPERATOR","->",306],["T_STRING","__",306],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid product type specified, skipping the record.'",306],")",",",["T_WHITESPACE","\n                        ",306],["T_STRING","Mage_Dataflow_Model_Convert_Exception",307],["T_DOUBLE_COLON","::",307],["T_STRING","ERROR",307],["T_WHITESPACE","\n                    ",307],")",";",["T_WHITESPACE","\n                    ",308],["T_CONTINUE","continue",309],";",["T_WHITESPACE","\n                ",309],"}",["T_WHITESPACE","\n\n                ",310],["T_COMMENT","\/\/ get store ids\n",312],["T_WHITESPACE","                ",313],["T_VARIABLE","$storeIds",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getStoreIds",313],"(",["T_ISSET","isset",313],"(",["T_VARIABLE","$row",313],"[",["T_CONSTANT_ENCAPSED_STRING","'store'",313],"]",")",["T_WHITESPACE"," ",313],"?",["T_WHITESPACE"," ",313],["T_VARIABLE","$row",313],"[",["T_CONSTANT_ENCAPSED_STRING","'store'",313],"]",["T_WHITESPACE"," ",313],":",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getVar",313],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",313],")",")",";",["T_WHITESPACE","\n                ",313],["T_IF","if",314],["T_WHITESPACE"," ",314],"(","!",["T_VARIABLE","$storeIds",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                    ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","addException",315],"(",["T_WHITESPACE","\n                        ",315],["T_STRING","Mage",316],["T_DOUBLE_COLON","::",316],["T_STRING","helper",316],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",316],")",["T_OBJECT_OPERATOR","->",316],["T_STRING","__",316],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid store specified, skipping the record.'",316],")",",",["T_WHITESPACE","\n                        ",316],["T_STRING","Mage_Dataflow_Model_Convert_Exception",317],["T_DOUBLE_COLON","::",317],["T_STRING","ERROR",317],["T_WHITESPACE","\n                    ",317],")",";",["T_WHITESPACE","\n                    ",318],["T_CONTINUE","continue",319],";",["T_WHITESPACE","\n                ",319],"}",["T_WHITESPACE","\n\n                ",320],["T_COMMENT","\/\/ import data\n",322],["T_WHITESPACE","                ",323],["T_VARIABLE","$rowError",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","false",323],";",["T_WHITESPACE","\n                ",323],["T_FOREACH","foreach",324],["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$storeIds",324],["T_WHITESPACE"," ",324],["T_AS","as",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$storeId",324],")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n                    ",324],["T_VARIABLE","$collection",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getCollection",325],"(",["T_VARIABLE","$storeId",325],")",";",["T_WHITESPACE","\n                    ",325],["T_VARIABLE","$entity",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_VARIABLE","$collection",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","getEntity",326],"(",")",";",["T_WHITESPACE","\n\n                    ",326],["T_VARIABLE","$model",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_STRING","Mage",328],["T_DOUBLE_COLON","::",328],["T_STRING","getModel",328],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",328],")",";",["T_WHITESPACE","\n                    ",328],["T_VARIABLE","$model",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","setStoreId",329],"(",["T_VARIABLE","$storeId",329],")",";",["T_WHITESPACE","\n                    ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(","!",["T_EMPTY","empty",330],"(",["T_VARIABLE","$row",330],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",330],"]",")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n                        ",330],["T_VARIABLE","$model",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","load",331],"(",["T_VARIABLE","$row",331],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",331],"]",")",";",["T_WHITESPACE","\n                    ",331],"}",["T_WHITESPACE","\n                    ",332],["T_FOREACH","foreach",333],["T_WHITESPACE"," ",333],"(",["T_VARIABLE","$row",333],["T_WHITESPACE"," ",333],["T_AS","as",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$field",333],["T_DOUBLE_ARROW","=>",333],["T_VARIABLE","$value",333],")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n                        ",333],["T_VARIABLE","$attribute",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_VARIABLE","$entity",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getAttribute",334],"(",["T_VARIABLE","$field",334],")",";",["T_WHITESPACE","\n\n                        ",334],["T_IF","if",336],["T_WHITESPACE"," ",336],"(","!",["T_VARIABLE","$attribute",336],")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                            ",336],["T_COMMENT","\/\/$inventoryFields[$row['sku']][$field] = $value;\n",337],["T_WHITESPACE","\n                            ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_STRING","in_array",339],"(",["T_VARIABLE","$field",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_inventoryFields",339],")",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n                                ",339],["T_VARIABLE","$inventoryFields",340],"[",["T_VARIABLE","$row",340],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",340],"]","]","[",["T_VARIABLE","$field",340],"]",["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$value",340],";",["T_WHITESPACE","\n                            ",340],"}",["T_WHITESPACE","\n                            ",341],["T_CONTINUE","continue",342],";",["T_WHITESPACE","\n",342],["T_COMMENT","\/\/                            $this->addException(\n",343],["T_COMMENT","\/\/                                Mage::helper('catalog')->__('Unknown attribute: %s.', $field),\n",344],["T_COMMENT","\/\/                                Mage_Dataflow_Model_Convert_Exception::ERROR\n",345],["T_COMMENT","\/\/                            );\n",346],["T_WHITESPACE","                        ",347],"}",["T_WHITESPACE","\n                        ",347],["T_IF","if",348],["T_WHITESPACE"," ",348],"(",["T_VARIABLE","$attribute",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","usesSource",348],"(",")",")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n                            ",348],["T_VARIABLE","$source",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_VARIABLE","$attribute",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getSource",349],"(",")",";",["T_WHITESPACE","\n                            ",349],["T_VARIABLE","$optionId",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getSourceOptionId",350],"(",["T_VARIABLE","$source",350],",",["T_WHITESPACE"," ",350],["T_VARIABLE","$value",350],")",";",["T_WHITESPACE","\n                            ",350],["T_IF","if",351],["T_WHITESPACE"," ",351],"(",["T_STRING","is_null",351],"(",["T_VARIABLE","$optionId",351],")",")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n                                ",351],["T_VARIABLE","$rowError",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_STRING","true",352],";",["T_WHITESPACE","\n                                ",352],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","addException",353],"(",["T_WHITESPACE","\n                                    ",353],["T_STRING","Mage",354],["T_DOUBLE_COLON","::",354],["T_STRING","helper",354],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",354],")",["T_OBJECT_OPERATOR","->",354],["T_STRING","__",354],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid attribute option specified for attribute %s (%s), skipping the record.'",354],",",["T_WHITESPACE"," ",354],["T_VARIABLE","$field",354],",",["T_WHITESPACE"," ",354],["T_VARIABLE","$value",354],")",",",["T_WHITESPACE","\n                                    ",354],["T_STRING","Mage_Dataflow_Model_Convert_Exception",355],["T_DOUBLE_COLON","::",355],["T_STRING","ERROR",355],["T_WHITESPACE","\n                                ",355],")",";",["T_WHITESPACE","\n                                ",356],["T_CONTINUE","continue",357],";",["T_WHITESPACE","\n                            ",357],"}",["T_WHITESPACE","\n                            ",358],["T_VARIABLE","$value",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$optionId",359],";",["T_WHITESPACE","\n                        ",359],"}",["T_WHITESPACE","\n                        ",360],["T_VARIABLE","$model",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","setData",361],"(",["T_VARIABLE","$field",361],",",["T_WHITESPACE"," ",361],["T_VARIABLE","$value",361],")",";",["T_WHITESPACE","\n\n                    ",361],"}",["T_COMMENT","\/\/foreach ($row as $field=>$value)\n",363],["T_WHITESPACE","\n                    ",364],["T_COMMENT","\/\/echo 'Before **********************<br\/><pre>';\n",365],["T_WHITESPACE","                    ",366],["T_COMMENT","\/\/print_r($model->getData());\n",366],["T_WHITESPACE","                    ",367],["T_IF","if",367],["T_WHITESPACE"," ",367],"(","!",["T_VARIABLE","$rowError",367],")",["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n                        ",367],["T_VARIABLE","$collection",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","addItem",368],"(",["T_VARIABLE","$model",368],")",";",["T_WHITESPACE","\n                    ",368],"}",["T_WHITESPACE","\n                    ",369],["T_UNSET","unset",370],"(",["T_VARIABLE","$model",370],")",";",["T_WHITESPACE","\n                ",370],"}",["T_WHITESPACE"," ",371],["T_COMMENT","\/\/foreach ($storeIds as $storeId)\n",371],["T_WHITESPACE","            ",372],"}",["T_WHITESPACE"," ",372],["T_CATCH","catch",372],["T_WHITESPACE"," ",372],"(",["T_STRING","Exception",372],["T_WHITESPACE"," ",372],["T_VARIABLE","$e",372],")",["T_WHITESPACE"," ",372],"{",["T_WHITESPACE","\n                ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(","!",["T_VARIABLE","$e",373],["T_WHITESPACE"," ",373],["T_INSTANCEOF","instanceof",373],["T_WHITESPACE"," ",373],["T_STRING","Mage_Dataflow_Model_Convert_Exception",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n                    ",373],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","addException",374],"(",["T_WHITESPACE","\n                        ",374],["T_STRING","Mage",375],["T_DOUBLE_COLON","::",375],["T_STRING","helper",375],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",375],")",["T_OBJECT_OPERATOR","->",375],["T_STRING","__",375],"(",["T_CONSTANT_ENCAPSED_STRING","'Error during retrieval of option value: %s'",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$e",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getMessage",375],"(",")",")",",",["T_WHITESPACE","\n                        ",375],["T_STRING","Mage_Dataflow_Model_Convert_Exception",376],["T_DOUBLE_COLON","::",376],["T_STRING","FATAL",376],["T_WHITESPACE","\n                    ",376],")",";",["T_WHITESPACE","\n                ",377],"}",["T_WHITESPACE","\n            ",378],"}",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE","\n\n        ",380],["T_COMMENT","\/\/ set importinted to adaptor\n",382],["T_WHITESPACE","        ",383],["T_IF","if",383],["T_WHITESPACE"," ",383],"(",["T_STRING","sizeof",383],"(",["T_VARIABLE","$inventoryFields",383],")",["T_WHITESPACE"," ",383],">",["T_WHITESPACE"," ",383],["T_LNUMBER","0",383],")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n            ",383],["T_STRING","Mage",384],["T_DOUBLE_COLON","::",384],["T_STRING","register",384],"(",["T_CONSTANT_ENCAPSED_STRING","'current_imported_inventory'",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$inventoryFields",384],")",";",["T_WHITESPACE","\n            ",384],["T_COMMENT","\/\/$this->setInventoryItems($inventoryFields);\n",385],["T_WHITESPACE","        ",386],"}",["T_WHITESPACE"," ",386],["T_COMMENT","\/\/ end setting imported to adaptor\n",386],["T_WHITESPACE","\n        ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","setData",388],"(",["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","_collections",388],")",";",["T_WHITESPACE","\n        ",388],["T_RETURN","return",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],";",["T_WHITESPACE","\n    ",389],"}",["T_WHITESPACE","\n\n    ",390],["T_PUBLIC","public",392],["T_WHITESPACE"," ",392],["T_FUNCTION","function",392],["T_WHITESPACE"," ",392],["T_STRING","setInventoryItems",392],"(",["T_VARIABLE","$items",392],")",["T_WHITESPACE","\n    ",392],"{",["T_WHITESPACE","\n        ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","_inventoryItems",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$items",394],";",["T_WHITESPACE","\n    ",394],"}",["T_WHITESPACE","\n\n    ",395],["T_PUBLIC","public",397],["T_WHITESPACE"," ",397],["T_FUNCTION","function",397],["T_WHITESPACE"," ",397],["T_STRING","getInventoryItems",397],"(",")",["T_WHITESPACE","\n    ",397],"{",["T_WHITESPACE","\n        ",398],["T_RETURN","return",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","_inventoryItems",399],";",["T_WHITESPACE","\n    ",399],"}",["T_WHITESPACE","\n\n    ",400],["T_DOC_COMMENT","\/**\n     * Unparse (prepare data) loaded products\n     *\n     * @return Mage_Catalog_Model_Convert_Parser_Product\n     *\/",402],["T_WHITESPACE","\n    ",406],["T_PUBLIC","public",407],["T_WHITESPACE"," ",407],["T_FUNCTION","function",407],["T_WHITESPACE"," ",407],["T_STRING","unparse",407],"(",")",["T_WHITESPACE","\n    ",407],"{",["T_WHITESPACE","\n        ",408],["T_VARIABLE","$entityIds",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","getData",409],"(",")",";",["T_WHITESPACE","\n\n        ",409],["T_FOREACH","foreach",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$entityIds",411],["T_WHITESPACE"," ",411],["T_AS","as",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$i",411],["T_WHITESPACE"," ",411],["T_DOUBLE_ARROW","=>",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$entityId",411],")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n            ",411],["T_VARIABLE","$product",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","getProductModel",412],"(",")",["T_WHITESPACE","\n                ",412],["T_OBJECT_OPERATOR","->",413],["T_STRING","setStoreId",413],"(",["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","getStoreId",413],"(",")",")",["T_WHITESPACE","\n                ",413],["T_OBJECT_OPERATOR","->",414],["T_STRING","load",414],"(",["T_VARIABLE","$entityId",414],")",";",["T_WHITESPACE","\n            ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","setProductTypeInstance",415],"(",["T_VARIABLE","$product",415],")",";",["T_WHITESPACE","\n            ",415],["T_COMMENT","\/* @var $product Mage_Catalog_Model_Product *\/",416],["T_WHITESPACE","\n\n            ",416],["T_VARIABLE","$position",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_STRING","Mage",418],["T_DOUBLE_COLON","::",418],["T_STRING","helper",418],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",418],")",["T_OBJECT_OPERATOR","->",418],["T_STRING","__",418],"(",["T_CONSTANT_ENCAPSED_STRING","'Line %d, SKU: %s'",418],",",["T_WHITESPACE"," ",418],"(",["T_VARIABLE","$i",418],"+",["T_LNUMBER","1",418],")",",",["T_WHITESPACE"," ",418],["T_VARIABLE","$product",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","getSku",418],"(",")",")",";",["T_WHITESPACE","\n            ",418],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","setPosition",419],"(",["T_VARIABLE","$position",419],")",";",["T_WHITESPACE","\n\n            ",419],["T_VARIABLE","$row",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_ARRAY","array",421],"(",["T_WHITESPACE","\n                ",421],["T_CONSTANT_ENCAPSED_STRING","'store'",422],["T_WHITESPACE","         ",422],["T_DOUBLE_ARROW","=>",422],["T_WHITESPACE"," ",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","getStore",422],"(",")",["T_OBJECT_OPERATOR","->",422],["T_STRING","getCode",422],"(",")",",",["T_WHITESPACE","\n                ",422],["T_CONSTANT_ENCAPSED_STRING","'websites'",423],["T_WHITESPACE","      ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","''",423],",",["T_WHITESPACE","\n                ",423],["T_CONSTANT_ENCAPSED_STRING","'attribute_set'",424],["T_WHITESPACE"," ",424],["T_DOUBLE_ARROW","=>",424],["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getAttributeSetName",424],"(",["T_VARIABLE","$product",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getEntityTypeId",424],"(",")",",",["T_WHITESPACE","\n                                        ",424],["T_VARIABLE","$product",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getAttributeSetId",425],"(",")",")",",",["T_WHITESPACE","\n                ",425],["T_CONSTANT_ENCAPSED_STRING","'type'",426],["T_WHITESPACE","          ",426],["T_DOUBLE_ARROW","=>",426],["T_WHITESPACE"," ",426],["T_VARIABLE","$product",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getTypeId",426],"(",")",",",["T_WHITESPACE","\n                ",426],["T_CONSTANT_ENCAPSED_STRING","'category_ids'",427],["T_WHITESPACE","  ",427],["T_DOUBLE_ARROW","=>",427],["T_WHITESPACE"," ",427],["T_STRING","join",427],"(",["T_CONSTANT_ENCAPSED_STRING","','",427],",",["T_WHITESPACE"," ",427],["T_VARIABLE","$product",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getCategoryIds",427],"(",")",")",["T_WHITESPACE","\n            ",427],")",";",["T_WHITESPACE","\n\n            ",428],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getStore",430],"(",")",["T_OBJECT_OPERATOR","->",430],["T_STRING","getCode",430],"(",")",["T_WHITESPACE"," ",430],["T_IS_EQUAL","==",430],["T_WHITESPACE"," ",430],["T_STRING","Mage_Core_Model_Store",430],["T_DOUBLE_COLON","::",430],["T_STRING","ADMIN_CODE",430],")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n                ",430],["T_VARIABLE","$websiteCodes",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_ARRAY","array",431],"(",")",";",["T_WHITESPACE","\n                ",431],["T_FOREACH","foreach",432],["T_WHITESPACE"," ",432],"(",["T_VARIABLE","$product",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getWebsiteIds",432],"(",")",["T_WHITESPACE"," ",432],["T_AS","as",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$websiteId",432],")",["T_WHITESPACE"," ",432],"{",["T_WHITESPACE","\n                    ",432],["T_VARIABLE","$websiteCode",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_STRING","Mage",433],["T_DOUBLE_COLON","::",433],["T_STRING","app",433],"(",")",["T_OBJECT_OPERATOR","->",433],["T_STRING","getWebsite",433],"(",["T_VARIABLE","$websiteId",433],")",["T_OBJECT_OPERATOR","->",433],["T_STRING","getCode",433],"(",")",";",["T_WHITESPACE","\n                    ",433],["T_VARIABLE","$websiteCodes",434],"[",["T_VARIABLE","$websiteCode",434],"]",["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_VARIABLE","$websiteCode",434],";",["T_WHITESPACE","\n                ",434],"}",["T_WHITESPACE","\n                ",435],["T_VARIABLE","$row",436],"[",["T_CONSTANT_ENCAPSED_STRING","'websites'",436],"]",["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_STRING","join",436],"(",["T_CONSTANT_ENCAPSED_STRING","','",436],",",["T_WHITESPACE"," ",436],["T_VARIABLE","$websiteCodes",436],")",";",["T_WHITESPACE","\n            ",436],"}",["T_WHITESPACE"," ",437],["T_ELSE","else",437],["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n                ",437],["T_VARIABLE","$row",438],"[",["T_CONSTANT_ENCAPSED_STRING","'websites'",438],"]",["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","getStore",438],"(",")",["T_OBJECT_OPERATOR","->",438],["T_STRING","getWebsite",438],"(",")",["T_OBJECT_OPERATOR","->",438],["T_STRING","getCode",438],"(",")",";",["T_WHITESPACE","\n                ",438],["T_IF","if",439],["T_WHITESPACE"," ",439],"(",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getVar",439],"(",["T_CONSTANT_ENCAPSED_STRING","'url_field'",439],")",")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n                    ",439],["T_VARIABLE","$row",440],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",440],"]",["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_VARIABLE","$product",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","getProductUrl",440],"(",["T_STRING","false",440],")",";",["T_WHITESPACE","\n                ",440],"}",["T_WHITESPACE","\n            ",441],"}",["T_WHITESPACE","\n\n            ",442],["T_FOREACH","foreach",444],["T_WHITESPACE"," ",444],"(",["T_VARIABLE","$product",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getData",444],"(",")",["T_WHITESPACE"," ",444],["T_AS","as",444],["T_WHITESPACE"," ",444],["T_VARIABLE","$field",444],["T_WHITESPACE"," ",444],["T_DOUBLE_ARROW","=>",444],["T_WHITESPACE"," ",444],["T_VARIABLE","$value",444],")",["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n                ",444],["T_IF","if",445],["T_WHITESPACE"," ",445],"(",["T_STRING","in_array",445],"(",["T_VARIABLE","$field",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","_systemFields",445],")",["T_WHITESPACE"," ",445],["T_BOOLEAN_OR","||",445],["T_WHITESPACE"," ",445],["T_STRING","is_object",445],"(",["T_VARIABLE","$value",445],")",")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n                    ",445],["T_CONTINUE","continue",446],";",["T_WHITESPACE","\n                ",446],"}",["T_WHITESPACE","\n\n                ",447],["T_VARIABLE","$attribute",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getAttribute",449],"(",["T_VARIABLE","$field",449],")",";",["T_WHITESPACE","\n                ",449],["T_IF","if",450],["T_WHITESPACE"," ",450],"(","!",["T_VARIABLE","$attribute",450],")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n                    ",450],["T_CONTINUE","continue",451],";",["T_WHITESPACE","\n                ",451],"}",["T_WHITESPACE","\n\n                ",452],["T_IF","if",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$attribute",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","usesSource",454],"(",")",")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n                    ",454],["T_VARIABLE","$option",455],["T_WHITESPACE"," ",455],"=",["T_WHITESPACE"," ",455],["T_VARIABLE","$attribute",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getSource",455],"(",")",["T_OBJECT_OPERATOR","->",455],["T_STRING","getOptionText",455],"(",["T_VARIABLE","$value",455],")",";",["T_WHITESPACE","\n                    ",455],["T_IF","if",456],["T_WHITESPACE"," ",456],"(",["T_VARIABLE","$value",456],["T_WHITESPACE"," ",456],["T_BOOLEAN_AND","&&",456],["T_WHITESPACE"," ",456],["T_EMPTY","empty",456],"(",["T_VARIABLE","$option",456],")",["T_WHITESPACE"," ",456],["T_BOOLEAN_AND","&&",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$option",456],["T_WHITESPACE"," ",456],["T_IS_NOT_EQUAL","!=",456],["T_WHITESPACE"," ",456],["T_CONSTANT_ENCAPSED_STRING","'0'",456],")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n                        ",456],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","addException",457],"(",["T_WHITESPACE","\n                            ",457],["T_STRING","Mage",458],["T_DOUBLE_COLON","::",458],["T_STRING","helper",458],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",458],")",["T_OBJECT_OPERATOR","->",458],["T_STRING","__",458],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid option ID specified for %s (%s), skipping the record.'",458],",",["T_WHITESPACE"," ",458],["T_VARIABLE","$field",458],",",["T_WHITESPACE"," ",458],["T_VARIABLE","$value",458],")",",",["T_WHITESPACE","\n                            ",458],["T_STRING","Mage_Dataflow_Model_Convert_Exception",459],["T_DOUBLE_COLON","::",459],["T_STRING","ERROR",459],["T_WHITESPACE","\n                        ",459],")",";",["T_WHITESPACE","\n                        ",460],["T_CONTINUE","continue",461],";",["T_WHITESPACE","\n                    ",461],"}",["T_WHITESPACE","\n                    ",462],["T_IF","if",463],["T_WHITESPACE"," ",463],"(",["T_STRING","is_array",463],"(",["T_VARIABLE","$option",463],")",")",["T_WHITESPACE"," ",463],"{",["T_WHITESPACE","\n                        ",463],["T_VARIABLE","$value",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_STRING","join",464],"(",["T_STRING","self",464],["T_DOUBLE_COLON","::",464],["T_STRING","MULTI_DELIMITER",464],",",["T_WHITESPACE"," ",464],["T_VARIABLE","$option",464],")",";",["T_WHITESPACE","\n                    ",464],"}",["T_WHITESPACE"," ",465],["T_ELSE","else",465],["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n                        ",465],["T_VARIABLE","$value",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$option",466],";",["T_WHITESPACE","\n                    ",466],"}",["T_WHITESPACE","\n                    ",467],["T_UNSET","unset",468],"(",["T_VARIABLE","$option",468],")",";",["T_WHITESPACE","\n                ",468],"}",["T_WHITESPACE"," ",469],["T_ELSEIF","elseif",469],["T_WHITESPACE"," ",469],"(",["T_STRING","is_array",469],"(",["T_VARIABLE","$value",469],")",")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n                    ",469],["T_CONTINUE","continue",470],";",["T_WHITESPACE","\n                ",470],"}",["T_WHITESPACE","\n\n                ",471],["T_VARIABLE","$row",473],"[",["T_VARIABLE","$field",473],"]",["T_WHITESPACE"," ",473],"=",["T_WHITESPACE"," ",473],["T_VARIABLE","$value",473],";",["T_WHITESPACE","\n            ",473],"}",["T_WHITESPACE","\n\n            ",474],["T_IF","if",476],["T_WHITESPACE"," ",476],"(",["T_VARIABLE","$stockItem",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_VARIABLE","$product",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getStockItem",476],"(",")",")",["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n                ",476],["T_FOREACH","foreach",477],["T_WHITESPACE"," ",477],"(",["T_VARIABLE","$stockItem",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","getData",477],"(",")",["T_WHITESPACE"," ",477],["T_AS","as",477],["T_WHITESPACE"," ",477],["T_VARIABLE","$field",477],["T_WHITESPACE"," ",477],["T_DOUBLE_ARROW","=>",477],["T_WHITESPACE"," ",477],["T_VARIABLE","$value",477],")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n                    ",477],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_STRING","in_array",478],"(",["T_VARIABLE","$field",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_systemFields",478],")",["T_WHITESPACE"," ",478],["T_BOOLEAN_OR","||",478],["T_WHITESPACE"," ",478],["T_STRING","is_object",478],"(",["T_VARIABLE","$value",478],")",")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n                        ",478],["T_CONTINUE","continue",479],";",["T_WHITESPACE","\n                    ",479],"}",["T_WHITESPACE","\n                    ",480],["T_VARIABLE","$row",481],"[",["T_VARIABLE","$field",481],"]",["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_VARIABLE","$value",481],";",["T_WHITESPACE","\n                ",481],"}",["T_WHITESPACE","\n            ",482],"}",["T_WHITESPACE","\n\n            ",483],["T_VARIABLE","$productMediaGallery",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$product",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","getMediaGallery",485],"(",")",";",["T_WHITESPACE","\n            ",485],["T_VARIABLE","$product",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","reset",486],"(",")",";",["T_WHITESPACE","\n\n            ",486],["T_VARIABLE","$processedImageList",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_ARRAY","array",488],"(",")",";",["T_WHITESPACE","\n            ",488],["T_FOREACH","foreach",489],["T_WHITESPACE"," ",489],"(",["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","_imageFields",489],["T_WHITESPACE"," ",489],["T_AS","as",489],["T_WHITESPACE"," ",489],["T_VARIABLE","$field",489],")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n                ",489],["T_IF","if",490],["T_WHITESPACE"," ",490],"(",["T_ISSET","isset",490],"(",["T_VARIABLE","$row",490],"[",["T_VARIABLE","$field",490],"]",")",")",["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n                    ",490],["T_IF","if",491],["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$row",491],"[",["T_VARIABLE","$field",491],"]",["T_WHITESPACE"," ",491],["T_IS_EQUAL","==",491],["T_WHITESPACE"," ",491],["T_CONSTANT_ENCAPSED_STRING","'no_selection'",491],")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n                        ",491],["T_VARIABLE","$row",492],"[",["T_VARIABLE","$field",492],"]",["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_STRING","null",492],";",["T_WHITESPACE","\n                    ",492],"}",["T_WHITESPACE"," ",493],["T_ELSE","else",493],["T_WHITESPACE"," ",493],"{",["T_WHITESPACE","\n                        ",493],["T_VARIABLE","$processedImageList",494],"[","]",["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$row",494],"[",["T_VARIABLE","$field",494],"]",";",["T_WHITESPACE","\n                    ",494],"}",["T_WHITESPACE","\n                ",495],"}",["T_WHITESPACE","\n            ",496],"}",["T_WHITESPACE","\n            ",497],["T_VARIABLE","$processedImageList",498],["T_WHITESPACE"," ",498],"=",["T_WHITESPACE"," ",498],["T_STRING","array_unique",498],"(",["T_VARIABLE","$processedImageList",498],")",";",["T_WHITESPACE","\n\n            ",498],["T_VARIABLE","$batchModelId",500],["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","getBatchModel",500],"(",")",["T_OBJECT_OPERATOR","->",500],["T_STRING","getId",500],"(",")",";",["T_WHITESPACE","\n            ",500],["T_VARIABLE","$this",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","getBatchExportModel",501],"(",")",["T_WHITESPACE","\n                ",501],["T_OBJECT_OPERATOR","->",502],["T_STRING","setId",502],"(",["T_STRING","null",502],")",["T_WHITESPACE","\n                ",502],["T_OBJECT_OPERATOR","->",503],["T_STRING","setBatchId",503],"(",["T_VARIABLE","$batchModelId",503],")",["T_WHITESPACE","\n                ",503],["T_OBJECT_OPERATOR","->",504],["T_STRING","setBatchData",504],"(",["T_VARIABLE","$row",504],")",["T_WHITESPACE","\n                ",504],["T_OBJECT_OPERATOR","->",505],["T_STRING","setStatus",505],"(",["T_LNUMBER","1",505],")",["T_WHITESPACE","\n                ",505],["T_OBJECT_OPERATOR","->",506],["T_STRING","save",506],"(",")",";",["T_WHITESPACE","\n\n            ",506],["T_VARIABLE","$baseRowData",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_ARRAY","array",508],"(",["T_WHITESPACE","\n                ",508],["T_CONSTANT_ENCAPSED_STRING","'store'",509],["T_WHITESPACE","     ",509],["T_DOUBLE_ARROW","=>",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$row",509],"[",["T_CONSTANT_ENCAPSED_STRING","'store'",509],"]",",",["T_WHITESPACE","\n                ",509],["T_CONSTANT_ENCAPSED_STRING","'website'",510],["T_WHITESPACE","   ",510],["T_DOUBLE_ARROW","=>",510],["T_WHITESPACE"," ",510],["T_VARIABLE","$row",510],"[",["T_CONSTANT_ENCAPSED_STRING","'website'",510],"]",",",["T_WHITESPACE","\n                ",510],["T_CONSTANT_ENCAPSED_STRING","'sku'",511],["T_WHITESPACE","       ",511],["T_DOUBLE_ARROW","=>",511],["T_WHITESPACE"," ",511],["T_VARIABLE","$row",511],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",511],"]",["T_WHITESPACE","\n            ",511],")",";",["T_WHITESPACE","\n            ",512],["T_UNSET","unset",513],"(",["T_VARIABLE","$row",513],")",";",["T_WHITESPACE","\n\n            ",513],["T_FOREACH","foreach",515],["T_WHITESPACE"," ",515],"(",["T_VARIABLE","$productMediaGallery",515],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",515],"]",["T_WHITESPACE"," ",515],["T_AS","as",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$image",515],")",["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n                ",515],["T_IF","if",516],["T_WHITESPACE"," ",516],"(",["T_STRING","in_array",516],"(",["T_VARIABLE","$image",516],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",516],"]",",",["T_WHITESPACE"," ",516],["T_VARIABLE","$processedImageList",516],")",")",["T_WHITESPACE"," ",516],"{",["T_WHITESPACE","\n                    ",516],["T_CONTINUE","continue",517],";",["T_WHITESPACE","\n                ",517],"}",["T_WHITESPACE","\n\n                ",518],["T_VARIABLE","$rowMediaGallery",520],["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_ARRAY","array",520],"(",["T_WHITESPACE","\n                    ",520],["T_CONSTANT_ENCAPSED_STRING","'_media_image'",521],["T_WHITESPACE","          ",521],["T_DOUBLE_ARROW","=>",521],["T_WHITESPACE"," ",521],["T_VARIABLE","$image",521],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",521],"]",",",["T_WHITESPACE","\n                    ",521],["T_CONSTANT_ENCAPSED_STRING","'_media_lable'",522],["T_WHITESPACE","          ",522],["T_DOUBLE_ARROW","=>",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$image",522],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",522],"]",",",["T_WHITESPACE","\n                    ",522],["T_CONSTANT_ENCAPSED_STRING","'_media_position'",523],["T_WHITESPACE","       ",523],["T_DOUBLE_ARROW","=>",523],["T_WHITESPACE"," ",523],["T_VARIABLE","$image",523],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",523],"]",",",["T_WHITESPACE","\n                    ",523],["T_CONSTANT_ENCAPSED_STRING","'_media_is_disabled'",524],["T_WHITESPACE","    ",524],["T_DOUBLE_ARROW","=>",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$image",524],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled'",524],"]",["T_WHITESPACE","\n                ",524],")",";",["T_WHITESPACE","\n                ",525],["T_VARIABLE","$rowMediaGallery",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_STRING","array_merge",526],"(",["T_VARIABLE","$baseRowData",526],",",["T_WHITESPACE"," ",526],["T_VARIABLE","$rowMediaGallery",526],")",";",["T_WHITESPACE","\n\n                ",526],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","getBatchExportModel",528],"(",")",["T_WHITESPACE","\n                    ",528],["T_OBJECT_OPERATOR","->",529],["T_STRING","setId",529],"(",["T_STRING","null",529],")",["T_WHITESPACE","\n                    ",529],["T_OBJECT_OPERATOR","->",530],["T_STRING","setBatchId",530],"(",["T_VARIABLE","$batchModelId",530],")",["T_WHITESPACE","\n                    ",530],["T_OBJECT_OPERATOR","->",531],["T_STRING","setBatchData",531],"(",["T_VARIABLE","$rowMediaGallery",531],")",["T_WHITESPACE","\n                    ",531],["T_OBJECT_OPERATOR","->",532],["T_STRING","setStatus",532],"(",["T_LNUMBER","1",532],")",["T_WHITESPACE","\n                    ",532],["T_OBJECT_OPERATOR","->",533],["T_STRING","save",533],"(",")",";",["T_WHITESPACE","\n            ",533],"}",["T_WHITESPACE","\n        ",534],"}",["T_WHITESPACE","\n\n        ",535],["T_RETURN","return",537],["T_WHITESPACE"," ",537],["T_VARIABLE","$this",537],";",["T_WHITESPACE","\n    ",537],"}",["T_WHITESPACE","\n\n    ",538],["T_DOC_COMMENT","\/**\n     * Retrieve accessible external product attributes\n     *\n     * @return array\n     *\/",540],["T_WHITESPACE","\n    ",544],["T_PUBLIC","public",545],["T_WHITESPACE"," ",545],["T_FUNCTION","function",545],["T_WHITESPACE"," ",545],["T_STRING","getExternalAttributes",545],"(",")",["T_WHITESPACE","\n    ",545],"{",["T_WHITESPACE","\n        ",546],["T_VARIABLE","$productAttributes",547],["T_WHITESPACE","  ",547],"=",["T_WHITESPACE"," ",547],["T_STRING","Mage",547],["T_DOUBLE_COLON","::",547],["T_STRING","getResourceModel",547],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_collection'",547],")",["T_OBJECT_OPERATOR","->",547],["T_STRING","load",547],"(",")",";",["T_WHITESPACE","\n        ",547],["T_VARIABLE","$attributes",548],["T_WHITESPACE","         ",548],"=",["T_WHITESPACE"," ",548],["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","_externalFields",548],";",["T_WHITESPACE","\n\n        ",548],["T_FOREACH","foreach",550],["T_WHITESPACE"," ",550],"(",["T_VARIABLE","$productAttributes",550],["T_WHITESPACE"," ",550],["T_AS","as",550],["T_WHITESPACE"," ",550],["T_VARIABLE","$attr",550],")",["T_WHITESPACE"," ",550],"{",["T_WHITESPACE","\n            ",550],["T_VARIABLE","$code",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_VARIABLE","$attr",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","getAttributeCode",551],"(",")",";",["T_WHITESPACE","\n            ",551],["T_IF","if",552],["T_WHITESPACE"," ",552],"(",["T_STRING","in_array",552],"(",["T_VARIABLE","$code",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","_internalFields",552],")",["T_WHITESPACE"," ",552],["T_BOOLEAN_OR","||",552],["T_WHITESPACE"," ",552],["T_VARIABLE","$attr",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","getFrontendInput",552],"(",")",["T_WHITESPACE"," ",552],["T_IS_EQUAL","==",552],["T_WHITESPACE"," ",552],["T_CONSTANT_ENCAPSED_STRING","'hidden'",552],")",["T_WHITESPACE"," ",552],"{",["T_WHITESPACE","\n                ",552],["T_CONTINUE","continue",553],";",["T_WHITESPACE","\n            ",553],"}",["T_WHITESPACE","\n            ",554],["T_VARIABLE","$attributes",555],"[",["T_VARIABLE","$code",555],"]",["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_VARIABLE","$code",555],";",["T_WHITESPACE","\n        ",555],"}",["T_WHITESPACE","\n\n        ",556],["T_FOREACH","foreach",558],["T_WHITESPACE"," ",558],"(",["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","_inventoryFields",558],["T_WHITESPACE"," ",558],["T_AS","as",558],["T_WHITESPACE"," ",558],["T_VARIABLE","$field",558],")",["T_WHITESPACE"," ",558],"{",["T_WHITESPACE","\n            ",558],["T_VARIABLE","$attributes",559],"[",["T_VARIABLE","$field",559],"]",["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_VARIABLE","$field",559],";",["T_WHITESPACE","\n        ",559],"}",["T_WHITESPACE","\n\n        ",560],["T_RETURN","return",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$attributes",562],";",["T_WHITESPACE","\n    ",562],"}",["T_WHITESPACE","\n",563],"}",["T_WHITESPACE","\n",564]]