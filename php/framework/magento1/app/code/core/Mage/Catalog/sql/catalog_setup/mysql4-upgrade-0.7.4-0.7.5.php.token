[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_VARIABLE","$installer",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],";",["T_WHITESPACE","\n",27],["T_COMMENT","\/* @var $installer Mage_Catalog_Model_Resource_Eav_Mysql4_Setup *\/",28],["T_WHITESPACE","\n",28],["T_VARIABLE","$installer",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","startSetup",29],"(",")",";",["T_WHITESPACE","\n",29],["T_VARIABLE","$installer",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","run",30],"(","\"",["T_ENCAPSED_AND_WHITESPACE","\nDROP TABLE IF EXISTS ",30],["T_CURLY_OPEN","{",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getTable",31],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",31],")","}",["T_ENCAPSED_AND_WHITESPACE",";\nCREATE TABLE ",31],["T_CURLY_OPEN","{",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","getTable",32],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",32],")","}",["T_ENCAPSED_AND_WHITESPACE"," (\n  `product_id` INTEGER(10) UNSIGNED NOT NULL AUTO_INCREMENT,\n  `website_id` SMALLINT(5) UNSIGNED NOT NULL,\n  PRIMARY KEY (`product_id`, `website_id`),\n  CONSTRAINT `FK_CATALOG_PRODUCT_WEBSITE_WEBSITE` FOREIGN KEY `FK_CATALOG_PRODUCT_WEBSITE_WEBSITE` (`website_id`)\n    REFERENCES `",32],["T_CURLY_OPEN","{",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getTable",37],"(",["T_CONSTANT_ENCAPSED_STRING","'core_website'",37],")","}",["T_ENCAPSED_AND_WHITESPACE","` (`website_id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `FK_CATALOG_WEBSITE_PRODUCT_PRODUCT` FOREIGN KEY `FK_CATALOG_WEBSITE_PRODUCT_PRODUCT` (`product_id`)\n    REFERENCES `",37],["T_CURLY_OPEN","{",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getTable",39],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",39],")","}",["T_ENCAPSED_AND_WHITESPACE","` (`entity_id`) ON DELETE CASCADE\n);\n\nDROP TABLE IF EXISTS ",39],["T_CURLY_OPEN","{",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getTable",42],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_status'",42],")","}",["T_ENCAPSED_AND_WHITESPACE",";\nDROP TABLE IF EXISTS ",42],["T_CURLY_OPEN","{",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getTable",43],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_visibility'",43],")","}",["T_ENCAPSED_AND_WHITESPACE",";\nDROP TABLE IF EXISTS ",43],["T_CURLY_OPEN","{",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getTable",44],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_type'",44],")","}",["T_ENCAPSED_AND_WHITESPACE",";\n",44],"\"",")",";",["T_WHITESPACE","\n",45],["T_VARIABLE","$installer",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","endSetup",46],"(",")",";",["T_WHITESPACE","\n",46],["T_VARIABLE","$productTable",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getTable",47],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",47],")",";",["T_WHITESPACE","\n",47],["T_VARIABLE","$installer",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getConnection",48],"(",")",["T_OBJECT_OPERATOR","->",48],["T_STRING","dropColumn",48],"(",["T_VARIABLE","$productTable",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",48],")",";",["T_WHITESPACE","\n",48],["T_VARIABLE","$installer",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getConnection",49],"(",")",["T_OBJECT_OPERATOR","->",49],["T_STRING","dropColumn",49],"(",["T_VARIABLE","$productTable",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'store_id'",49],")",";",["T_WHITESPACE","\n",49],["T_VARIABLE","$installer",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getConnection",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","dropColumn",50],"(",["T_VARIABLE","$productTable",50],",",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'is_active'",50],")",";",["T_WHITESPACE","\n\n",50],["T_TRY","try",52],["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n    ",52],["T_VARIABLE","$installer",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","run",53],"(","\"",["T_ENCAPSED_AND_WHITESPACE","\n    INSERT INTO ",53],["T_CURLY_OPEN","{",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getTable",54],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",54],")","}",["T_ENCAPSED_AND_WHITESPACE","\n        SELECT DISTINCT ps.product_id, cs.website_id\n        FROM ",54],["T_CURLY_OPEN","{",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getTable",56],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_store'",56],")","}",["T_ENCAPSED_AND_WHITESPACE"," ps, ",56],["T_CURLY_OPEN","{",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getTable",56],"(",["T_CONSTANT_ENCAPSED_STRING","'core_store'",56],")","}",["T_ENCAPSED_AND_WHITESPACE"," cs\n        WHERE cs.store_id=ps.store_id AND ps.store_id>0;\n    DROP TABLE IF EXISTS ",56],["T_CURLY_OPEN","{",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getTable",58],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_store'",58],")","}",["T_ENCAPSED_AND_WHITESPACE",";\n    ",58],"\"",")",";",["T_WHITESPACE","\n",59],"}",["T_WHITESPACE"," ",60],["T_CATCH","catch",60],["T_WHITESPACE"," ",60],"(",["T_STRING","Exception",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$e",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n",60],"}",["T_WHITESPACE","\n\n",61],["T_VARIABLE","$categoryTable",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getTable",63],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",63],")",";",["T_WHITESPACE","\n",63],["T_VARIABLE","$installer",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getConnection",64],"(",")",["T_OBJECT_OPERATOR","->",64],["T_STRING","dropForeignKey",64],"(",["T_VARIABLE","$categoryTable",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'FK_CATALOG_CATEGORY_ENTITY_TREE_NODE'",64],")",";",["T_WHITESPACE","\n\n",64],["T_TRY","try",66],["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n    ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","run",67],"(","\"",["T_ENCAPSED_AND_WHITESPACE","ALTER TABLE `",67],["T_CURLY_OPEN","{",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getTable",67],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",67],")","}",["T_ENCAPSED_AND_WHITESPACE","` ADD `path` VARCHAR( 255 ) NOT NULL, ADD `position` INT NOT NULL;",67],"\"",")",";",["T_WHITESPACE","\n",67],"}",["T_WHITESPACE"," ",68],["T_CATCH","catch",68],["T_WHITESPACE"," ",68],"(",["T_STRING","Exception",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$e",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n",68],"}",["T_WHITESPACE","\n",69],["T_TRY","try",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","run",71],"(","\"",["T_ENCAPSED_AND_WHITESPACE","DROP TABLE IF EXISTS `",71],["T_CURLY_OPEN","{",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getTable",71],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_tree'",71],")","}",["T_ENCAPSED_AND_WHITESPACE","`;",71],"\"",")",";",["T_WHITESPACE","\n",71],"}",["T_WHITESPACE"," ",72],["T_CATCH","catch",72],["T_WHITESPACE"," ",72],"(",["T_STRING","Exception",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$e",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n",72],"}",["T_WHITESPACE","\n\n",73],["T_VARIABLE","$installer",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getConnection",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","dropKey",75],"(",["T_VARIABLE","$categoryTable",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'FK_catalog_category_ENTITY_ENTITY_TYPE'",75],")",";",["T_WHITESPACE","\n",75],["T_VARIABLE","$installer",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getConnection",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","dropKey",76],"(",["T_VARIABLE","$categoryTable",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'FK_catalog_category_ENTITY_STORE'",76],")",";",["T_WHITESPACE","\n",76],["T_VARIABLE","$installer",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getConnection",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","dropColumn",77],"(",["T_VARIABLE","$categoryTable",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'store_id'",77],")",";",["T_WHITESPACE","\n\n",77],["T_VARIABLE","$tierPriceTable",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getTable",79],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_tier_price'",79],")",";",["T_WHITESPACE","\n",79],["T_VARIABLE","$installer",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getConnection",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","dropColumn",80],"(",["T_VARIABLE","$tierPriceTable",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",80],")",";",["T_WHITESPACE","\n",80],["T_VARIABLE","$installer",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getConnection",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","dropColumn",81],"(",["T_VARIABLE","$tierPriceTable",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",81],")",";",["T_WHITESPACE","\n",81],["T_VARIABLE","$installer",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getConnection",82],"(",")",["T_OBJECT_OPERATOR","->",82],["T_STRING","dropForeignKey",82],"(",["T_VARIABLE","$tierPriceTable",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'FK_CATALOG_PRODUCT_ENTITY_TIER_PRICE_ATTRIBUTE'",82],")",";",["T_WHITESPACE","\n",82],["T_VARIABLE","$installer",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getConnection",83],"(",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","dropKey",83],"(",["T_VARIABLE","$tierPriceTable",83],",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'FK_CATALOG_PRODUCT_ENTITY_TIER_PRICE_ATTRIBUTE'",83],")",";",["T_WHITESPACE","\n\n",83],["T_VARIABLE","$installer",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","startSetup",85],"(",")",";",["T_WHITESPACE","\n",85],["T_VARIABLE","$installer",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","installEntities",86],"(",")",";",["T_WHITESPACE","\n",86],["T_VARIABLE","$installer",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","endSetup",87],"(",")",";",["T_WHITESPACE","\n\n",87],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","convertOldTreeToNew",89],"(",")",";",["T_WHITESPACE","\n",89]]