[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * API2 for product categories\n *\n * @category   Mage\n * @package    Mage_Catalog\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Api2_Product_Category_Rest_Admin_V1",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Api2_Product_Category_Rest",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Product category assign\n     *\n     * @param array $data\n     * @return string\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","_create",42],"(",["T_ARRAY","array",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$data",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_COMMENT","\/* @var $validator Mage_Api2_Model_Resource_Validator_Fields *\/",44],["T_WHITESPACE","\n        ",44],["T_VARIABLE","$validator",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","Mage",45],["T_DOUBLE_COLON","::",45],["T_STRING","getResourceModel",45],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/validator_fields'",45],",",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_CONSTANT_ENCAPSED_STRING","'resource'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],")",")",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(","!",["T_VARIABLE","$validator",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","isValidData",46],"(",["T_VARIABLE","$data",46],")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_FOREACH","foreach",47],["T_WHITESPACE"," ",47],"(",["T_VARIABLE","$validator",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getErrors",47],"(",")",["T_WHITESPACE"," ",47],["T_AS","as",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$error",47],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n                ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_error",48],"(",["T_VARIABLE","$error",48],",",["T_WHITESPACE"," ",48],["T_STRING","Mage_Api2_Model_Server",48],["T_DOUBLE_COLON","::",48],["T_STRING","HTTP_BAD_REQUEST",48],")",";",["T_WHITESPACE","\n            ",48],"}",["T_WHITESPACE","\n            ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_critical",50],"(",["T_STRING","self",50],["T_DOUBLE_COLON","::",50],["T_STRING","RESOURCE_DATA_PRE_VALIDATION_ERROR",50],")",";",["T_WHITESPACE","\n        ",50],"}",["T_WHITESPACE","\n\n        ",51],["T_VARIABLE","$product",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_getProduct",53],"(",")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$category",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_getCategoryById",54],"(",["T_VARIABLE","$data",54],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",54],"]",")",";",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$categoryIds",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$product",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getCategoryIds",56],"(",")",";",["T_WHITESPACE","\n        ",56],["T_IF","if",57],["T_WHITESPACE"," ",57],"(","!",["T_STRING","is_array",57],"(",["T_VARIABLE","$categoryIds",57],")",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$categoryIds",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",")",";",["T_WHITESPACE","\n        ",58],"}",["T_WHITESPACE","\n        ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_STRING","in_array",60],"(",["T_VARIABLE","$category",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getId",60],"(",")",",",["T_WHITESPACE"," ",60],["T_VARIABLE","$categoryIds",60],")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_critical",61],"(",["T_STRING","sprintf",61],"(",["T_CONSTANT_ENCAPSED_STRING","'Product #%d is already assigned to category #%d'",61],",",["T_WHITESPACE","\n                ",61],["T_VARIABLE","$product",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getId",62],"(",")",",",["T_WHITESPACE"," ",62],["T_VARIABLE","$category",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getId",62],"(",")",")",",",["T_WHITESPACE"," ",62],["T_STRING","Mage_Api2_Model_Server",62],["T_DOUBLE_COLON","::",62],["T_STRING","HTTP_BAD_REQUEST",62],")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$category",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getId",64],"(",")",["T_WHITESPACE"," ",64],["T_IS_EQUAL","==",64],["T_WHITESPACE"," ",64],["T_STRING","Mage_Catalog_Model_Category",64],["T_DOUBLE_COLON","::",64],["T_STRING","TREE_ROOT_ID",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_critical",65],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot assign product to tree root category.'",65],",",["T_WHITESPACE"," ",65],["T_STRING","Mage_Api2_Model_Server",65],["T_DOUBLE_COLON","::",65],["T_STRING","HTTP_BAD_REQUEST",65],")",";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$categoryIds",67],"[","]",["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$category",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getId",67],"(",")",";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$product",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","setCategoryIds",68],"(",["T_STRING","implode",68],"(",["T_CONSTANT_ENCAPSED_STRING","','",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$categoryIds",68],")",")",";",["T_WHITESPACE","\n\n        ",68],["T_TRY","try",70],"{",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$product",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","save",71],"(",")",";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE"," ",72],["T_CATCH","catch",72],["T_WHITESPACE"," ",72],"(",["T_STRING","Mage_Core_Exception",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$e",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_critical",73],"(",["T_VARIABLE","$e",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getMessage",73],"(",")",",",["T_WHITESPACE"," ",73],["T_STRING","Mage_Api2_Model_Server",73],["T_DOUBLE_COLON","::",73],["T_STRING","HTTP_INTERNAL_ERROR",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE"," ",74],["T_CATCH","catch",74],["T_WHITESPACE"," ",74],"(",["T_STRING","Exception",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$e",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_critical",75],"(",["T_STRING","self",75],["T_DOUBLE_COLON","::",75],["T_STRING","RESOURCE_INTERNAL_ERROR",75],")",";",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n\n        ",76],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_getLocation",78],"(",["T_VARIABLE","$category",78],")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Product category unassign\n     *\n     * @return bool\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","_delete",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$product",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_getProduct",88],"(",")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$category",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_getCategoryById",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getRequest",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","getParam",89],"(",["T_CONSTANT_ENCAPSED_STRING","'category_id'",89],")",")",";",["T_WHITESPACE","\n\n        ",89],["T_VARIABLE","$categoryIds",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$product",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getCategoryIds",91],"(",")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$categoryToBeDeletedId",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","array_search",92],"(",["T_VARIABLE","$category",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getId",92],"(",")",",",["T_WHITESPACE"," ",92],["T_VARIABLE","$categoryIds",92],")",";",["T_WHITESPACE","\n        ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_STRING","false",93],["T_WHITESPACE"," ",93],["T_IS_IDENTICAL","===",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$categoryToBeDeletedId",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_critical",94],"(",["T_STRING","sprintf",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Product #%d isn\\'t assigned to category #%d'",94],",",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$product",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getId",95],"(",")",",",["T_WHITESPACE"," ",95],["T_VARIABLE","$category",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getId",95],"(",")",")",",",["T_WHITESPACE"," ",95],["T_STRING","Mage_Api2_Model_Server",95],["T_DOUBLE_COLON","::",95],["T_STRING","HTTP_BAD_REQUEST",95],")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n\n        ",96],["T_COMMENT","\/\/ delete category\n",98],["T_WHITESPACE","        ",99],["T_UNSET","unset",99],"(",["T_VARIABLE","$categoryIds",99],"[",["T_VARIABLE","$categoryToBeDeletedId",99],"]",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$product",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","setCategoryIds",100],"(",["T_STRING","implode",100],"(",["T_CONSTANT_ENCAPSED_STRING","','",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$categoryIds",100],")",")",";",["T_WHITESPACE","\n\n        ",100],["T_TRY","try",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$product",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","save",103],"(",")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE"," ",104],["T_CATCH","catch",104],["T_WHITESPACE"," ",104],"(",["T_STRING","Mage_Core_Exception",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$e",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_critical",105],"(",["T_VARIABLE","$e",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getMessage",105],"(",")",",",["T_WHITESPACE"," ",105],["T_STRING","Mage_Api2_Model_Server",105],["T_DOUBLE_COLON","::",105],["T_STRING","HTTP_INTERNAL_ERROR",105],")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE"," ",106],["T_CATCH","catch",106],["T_WHITESPACE"," ",106],"(",["T_STRING","Exception",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$e",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_critical",107],"(",["T_STRING","self",107],["T_DOUBLE_COLON","::",107],["T_STRING","RESOURCE_INTERNAL_ERROR",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_STRING","true",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Return all assigned categories\n     *\n     * @return array\n     *\/",113],["T_WHITESPACE","\n    ",117],["T_PROTECTED","protected",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","_getCategoryIds",118],"(",")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_getProduct",120],"(",")",["T_OBJECT_OPERATOR","->",120],["T_STRING","getCategoryIds",120],"(",")",";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Get resource location\n     *\n     * @param Mage_Core_Model_Abstract $resource\n     * @return string URL\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PROTECTED","protected",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","_getLocation",129],"(",["T_VARIABLE","$resource",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_DOC_COMMENT","\/** @var $apiTypeRoute Mage_Api2_Model_Route_ApiType *\/",131],["T_WHITESPACE","\n        ",131],["T_VARIABLE","$apiTypeRoute",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","Mage",132],["T_DOUBLE_COLON","::",132],["T_STRING","getModel",132],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/route_apiType'",132],")",";",["T_WHITESPACE","\n\n        ",132],["T_VARIABLE","$chain",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$apiTypeRoute",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","chain",134],"(",["T_NEW","new",134],["T_WHITESPACE"," ",134],["T_STRING","Zend_Controller_Router_Route",134],"(",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getConfig",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","getRouteWithEntityTypeAction",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getResourceType",135],"(",")",")",["T_WHITESPACE","\n        ",135],")",")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$params",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_ARRAY","array",137],"(",["T_WHITESPACE","\n            ",137],["T_CONSTANT_ENCAPSED_STRING","'api_type'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getRequest",138],"(",")",["T_OBJECT_OPERATOR","->",138],["T_STRING","getApiType",138],"(",")",",",["T_WHITESPACE","\n            ",138],["T_CONSTANT_ENCAPSED_STRING","'id'",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getRequest",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getParam",139],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",139],")",",",["T_WHITESPACE","\n            ",139],["T_CONSTANT_ENCAPSED_STRING","'category_id'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$resource",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getId",140],"(",")",["T_WHITESPACE","\n        ",140],")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$uri",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$chain",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","assemble",142],"(",["T_VARIABLE","$params",142],")",";",["T_WHITESPACE","\n\n        ",142],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'\/'",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_VARIABLE","$uri",144],";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n",145],"}",["T_WHITESPACE","\n",146]]