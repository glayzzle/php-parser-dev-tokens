[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog product linked products collection\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Link_Product_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Store product model\n     *\n     * @var Mage_Catalog_Model_Product\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_product",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Store product link model\n     *\n     * @var Mage_Catalog_Model_Product_Link\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_linkModel",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Store link type id\n     *\n     * @var int\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_linkTypeId",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Store strong mode flag that determine if needed for inner join or left join of linked products\n     *\n     * @var bool\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_isStrongMode",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Store flag that determine if product filter was enabled\n     *\n     * @var bool\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_hasLinkFilter",70],["T_WHITESPACE","  ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","false",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Declare link model and initialize type attributes join\n     *\n     * @param Mage_Catalog_Model_Product_Link $linkModel\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",72],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","setLinkModel",78],"(",["T_STRING","Mage_Catalog_Model_Product_Link",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$linkModel",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_linkModel",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$linkModel",80],";",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$linkModel",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getLinkTypeId",81],"(",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_linkTypeId",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$linkModel",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getLinkTypeId",82],"(",")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Enable strong mode for inner join of linked products\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","setIsStrongMode",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_isStrongMode",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","true",94],";",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Retrieve collection link model\n     *\n     * @return Mage_Catalog_Model_Product_Link\n     *\/",98],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","getLinkModel",103],"(",")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_linkModel",105],";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Initialize collection parent product and add limitation join\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",108],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","setProduct",114],"(",["T_STRING","Mage_Catalog_Model_Product",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$product",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_product",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$product",116],";",["T_WHITESPACE","\n        ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$product",117],["T_WHITESPACE"," ",117],["T_BOOLEAN_AND","&&",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$product",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getId",117],"(",")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_hasLinkFilter",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","true",118],";",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setStore",119],"(",["T_VARIABLE","$product",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getStore",119],"(",")",")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n        ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Retrieve collection base product object\n     *\n     * @return Mage_Catalog_Model_Product\n     *\/",124],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","getProduct",129],"(",")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_product",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Exclude products from filter\n     *\n     * @param array $products\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","addExcludeProductFilter",140],"(",["T_VARIABLE","$products",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(","!",["T_EMPTY","empty",142],"(",["T_VARIABLE","$products",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(","!",["T_STRING","is_array",143],"(",["T_VARIABLE","$products",143],")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$products",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_ARRAY","array",144],"(",["T_VARIABLE","$products",144],")",";",["T_WHITESPACE","\n            ",144],"}",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_hasLinkFilter",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","true",146],";",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getSelect",147],"(",")",["T_OBJECT_OPERATOR","->",147],["T_STRING","where",147],"(",["T_CONSTANT_ENCAPSED_STRING","'links.linked_product_id NOT IN (?)'",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$products",147],")",";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Add products to filter\n     *\n     * @param array|int|string $products\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","addProductFilter",158],"(",["T_VARIABLE","$products",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(","!",["T_EMPTY","empty",160],"(",["T_VARIABLE","$products",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(","!",["T_STRING","is_array",161],"(",["T_VARIABLE","$products",161],")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n                ",161],["T_VARIABLE","$products",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_ARRAY","array",162],"(",["T_VARIABLE","$products",162],")",";",["T_WHITESPACE","\n            ",162],"}",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getSelect",164],"(",")",["T_OBJECT_OPERATOR","->",164],["T_STRING","where",164],"(",["T_CONSTANT_ENCAPSED_STRING","'links.product_id IN (?)'",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$products",164],")",";",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_hasLinkFilter",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","true",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Add random sorting order\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",171],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","setRandomOrder",176],"(",")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getSelect",178],"(",")",["T_OBJECT_OPERATOR","->",178],["T_STRING","orderRand",178],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id'",178],")",";",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Setting group by to exclude duplications in collection\n     *\n     * @param string $groupBy\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",182],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","setGroupBy",188],"(",["T_VARIABLE","$groupBy",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",188],")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getSelect",190],"(",")",["T_OBJECT_OPERATOR","->",190],["T_STRING","group",190],"(",["T_VARIABLE","$groupBy",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_COMMENT","\/*\n         * Allow Analytic functions usage\n         *\/",192],["T_WHITESPACE","\n        ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_useAnalyticFunction",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_STRING","true",195],";",["T_WHITESPACE","\n\n        ",195],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_DOC_COMMENT","\/**\n     * Join linked products when specified link model\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",200],["T_WHITESPACE","\n    ",204],["T_PROTECTED","protected",205],["T_WHITESPACE"," ",205],["T_FUNCTION","function",205],["T_WHITESPACE"," ",205],["T_STRING","_beforeLoad",205],"(",")",["T_WHITESPACE","\n    ",205],"{",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getLinkModel",207],"(",")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_joinLinks",208],"(",")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n        ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_STRING","parent",210],["T_DOUBLE_COLON","::",210],["T_STRING","_beforeLoad",210],"(",")",";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n\n    ",211],["T_DOC_COMMENT","\/**\n     * Join linked products and their attributes\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",213],["T_WHITESPACE","\n    ",217],["T_PROTECTED","protected",218],["T_WHITESPACE"," ",218],["T_FUNCTION","function",218],["T_WHITESPACE"," ",218],["T_STRING","_joinLinks",218],"(",")",["T_WHITESPACE","\n    ",218],"{",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$select",220],["T_WHITESPACE","  ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getSelect",220],"(",")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$adapter",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$select",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getAdapter",221],"(",")",";",["T_WHITESPACE","\n\n        ",221],["T_VARIABLE","$joinCondition",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_ARRAY","array",223],"(",["T_WHITESPACE","\n            ",223],["T_CONSTANT_ENCAPSED_STRING","'links.linked_product_id = e.entity_id'",224],",",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$adapter",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","quoteInto",225],"(",["T_CONSTANT_ENCAPSED_STRING","'links.link_type_id = ?'",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_linkTypeId",225],")",["T_WHITESPACE","\n        ",225],")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$joinType",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'join'",227],";",["T_WHITESPACE","\n        ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getProduct",228],"(",")",["T_WHITESPACE"," ",228],["T_BOOLEAN_AND","&&",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getProduct",228],"(",")",["T_OBJECT_OPERATOR","->",228],["T_STRING","getId",228],"(",")",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$productId",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getProduct",229],"(",")",["T_OBJECT_OPERATOR","->",229],["T_STRING","getId",229],"(",")",";",["T_WHITESPACE","\n            ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","_isStrongMode",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getSelect",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","where",231],"(",["T_CONSTANT_ENCAPSED_STRING","'links.product_id = ?'",231],",",["T_WHITESPACE"," ",231],["T_INT_CAST","(int)",231],["T_VARIABLE","$productId",231],")",";",["T_WHITESPACE","\n            ",231],"}",["T_WHITESPACE"," ",232],["T_ELSE","else",232],["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                ",232],["T_VARIABLE","$joinType",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'joinLeft'",233],";",["T_WHITESPACE","\n                ",233],["T_VARIABLE","$joinCondition",234],"[","]",["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$adapter",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","quoteInto",234],"(",["T_CONSTANT_ENCAPSED_STRING","'links.product_id = ?'",234],",",["T_WHITESPACE"," ",234],["T_VARIABLE","$productId",234],")",";",["T_WHITESPACE","\n            ",234],"}",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","addFieldToFilter",236],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",236],",",["T_WHITESPACE"," ",236],["T_ARRAY","array",236],"(",["T_CONSTANT_ENCAPSED_STRING","'neq'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$productId",236],")",")",";",["T_WHITESPACE","\n        ",236],"}",["T_WHITESPACE"," ",237],["T_ELSE","else",237],["T_WHITESPACE"," ",237],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_isStrongMode",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","addFieldToFilter",238],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",238],",",["T_WHITESPACE"," ",238],["T_ARRAY","array",238],"(",["T_CONSTANT_ENCAPSED_STRING","'eq'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],"-",["T_LNUMBER","1",238],")",")",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n        ",239],["T_IF","if",240],"(",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_hasLinkFilter",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_VARIABLE","$select",241],["T_OBJECT_OPERATOR","->",241],["T_VARIABLE","$joinType",241],"(",["T_WHITESPACE","\n                ",241],["T_ARRAY","array",242],"(",["T_CONSTANT_ENCAPSED_STRING","'links'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getTable",242],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_link'",242],")",")",",",["T_WHITESPACE","\n                ",242],["T_STRING","implode",243],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$joinCondition",243],")",",",["T_WHITESPACE","\n                ",243],["T_ARRAY","array",244],"(",["T_CONSTANT_ENCAPSED_STRING","'link_id'",244],")",["T_WHITESPACE","\n            ",244],")",";",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","joinAttributes",246],"(",")",";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Enable sorting products by its position\n     *\n     * @param string $dir sort type asc|desc\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",253],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","setPositionOrder",259],"(",["T_VARIABLE","$dir",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_STRING","self",259],["T_DOUBLE_COLON","::",259],["T_STRING","SORT_ORDER_ASC",259],")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_IF","if",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_hasLinkFilter",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getSelect",262],"(",")",["T_OBJECT_OPERATOR","->",262],["T_STRING","order",262],"(",["T_CONSTANT_ENCAPSED_STRING","'position '",262],["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],["T_VARIABLE","$dir",262],")",";",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Enable sorting products by its attribute set name\n     *\n     * @param string $dir sort type asc|desc\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",267],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","setAttributeSetIdOrder",273],"(",["T_VARIABLE","$dir",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","self",273],["T_DOUBLE_COLON","::",273],["T_STRING","SORT_ORDER_ASC",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getSelect",275],"(",")",["T_WHITESPACE","\n            ",275],["T_OBJECT_OPERATOR","->",276],["T_STRING","joinLeft",276],"(",["T_WHITESPACE","\n                ",276],["T_ARRAY","array",277],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getTable",277],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute_set'",277],")",")",",",["T_WHITESPACE","\n                ",277],["T_CONSTANT_ENCAPSED_STRING","'e.attribute_set_id = set.attribute_set_id'",278],",",["T_WHITESPACE","\n                ",278],["T_ARRAY","array",279],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_name'",279],")",["T_WHITESPACE","\n            ",279],")",["T_WHITESPACE","\n            ",280],["T_OBJECT_OPERATOR","->",281],["T_STRING","order",281],"(",["T_CONSTANT_ENCAPSED_STRING","'set.attribute_set_name '",281],["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_VARIABLE","$dir",281],")",";",["T_WHITESPACE","\n        ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n\n    ",283],["T_DOC_COMMENT","\/**\n     * Get table alias for link model attribute\n     *\n     * @param string $attributeCode\n     * @param string $attributeType\n     *\n     * @return string\n     *\/",285],["T_WHITESPACE","\n    ",292],["T_PROTECTED","protected",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","_getLinkAttributeTableAlias",293],"(",["T_VARIABLE","$attributeCode",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$attributeType",293],")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_STRING","sprintf",295],"(",["T_CONSTANT_ENCAPSED_STRING","'link_attribute_%s_%s'",295],",",["T_WHITESPACE"," ",295],["T_VARIABLE","$attributeCode",295],",",["T_WHITESPACE"," ",295],["T_VARIABLE","$attributeType",295],")",";",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_DOC_COMMENT","\/**\n     * Join attributes\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",298],["T_WHITESPACE","\n    ",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","joinAttributes",303],"(",")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(","!",["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getLinkModel",305],"(",")",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n            ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$attributes",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getLinkModel",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getAttributes",308],"(",")",";",["T_WHITESPACE","\n\n        ",308],["T_FOREACH","foreach",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$attributes",310],["T_WHITESPACE"," ",310],["T_AS","as",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$attribute",310],")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n            ",310],["T_VARIABLE","$table",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getLinkModel",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","getAttributeTypeTable",311],"(",["T_VARIABLE","$attribute",311],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",311],"]",")",";",["T_WHITESPACE","\n            ",311],["T_VARIABLE","$alias",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_getLinkAttributeTableAlias",312],"(",["T_VARIABLE","$attribute",312],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",312],"]",",",["T_WHITESPACE"," ",312],["T_VARIABLE","$attribute",312],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",312],"]",")",";",["T_WHITESPACE","\n\n            ",312],["T_VARIABLE","$joinCondiotion",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_ARRAY","array",314],"(",["T_WHITESPACE","\n                ",314],"\"",["T_CURLY_OPEN","{",315],["T_VARIABLE","$alias",315],"}",["T_ENCAPSED_AND_WHITESPACE",".link_id = links.link_id",315],"\"",",",["T_WHITESPACE","\n                ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getSelect",316],"(",")",["T_OBJECT_OPERATOR","->",316],["T_STRING","getAdapter",316],"(",")",["T_OBJECT_OPERATOR","->",316],["T_STRING","quoteInto",316],"(","\"",["T_CURLY_OPEN","{",316],["T_VARIABLE","$alias",316],"}",["T_ENCAPSED_AND_WHITESPACE",".product_link_attribute_id = ?",316],"\"",",",["T_WHITESPACE"," ",316],["T_VARIABLE","$attribute",316],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",316],"]",")",["T_WHITESPACE","\n            ",316],")",";",["T_WHITESPACE","\n            ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getSelect",318],"(",")",["T_OBJECT_OPERATOR","->",318],["T_STRING","joinLeft",318],"(",["T_WHITESPACE","\n                ",318],["T_ARRAY","array",319],"(",["T_VARIABLE","$alias",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$table",319],")",",",["T_WHITESPACE","\n                ",319],["T_STRING","implode",320],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",320],",",["T_WHITESPACE"," ",320],["T_VARIABLE","$joinCondiotion",320],")",",",["T_WHITESPACE","\n                ",320],["T_ARRAY","array",321],"(",["T_VARIABLE","$attribute",321],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",321],"]",["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'value'",321],")",["T_WHITESPACE","\n            ",321],")",";",["T_WHITESPACE","\n        ",322],"}",["T_WHITESPACE","\n\n        ",323],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],";",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Set sorting order\n     *\n     * $attribute can also be an array of attributes\n     *\n     * @param string|array $attribute\n     * @param string $dir\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",328],["T_WHITESPACE","\n    ",336],["T_PUBLIC","public",337],["T_WHITESPACE"," ",337],["T_FUNCTION","function",337],["T_WHITESPACE"," ",337],["T_STRING","setOrder",337],"(",["T_VARIABLE","$attribute",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$dir",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_STRING","self",337],["T_DOUBLE_COLON","::",337],["T_STRING","SORT_ORDER_ASC",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$attribute",339],["T_WHITESPACE"," ",339],["T_IS_EQUAL","==",339],["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'position'",339],")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_RETURN","return",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","setPositionOrder",340],"(",["T_VARIABLE","$dir",340],")",";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE"," ",341],["T_ELSEIF","elseif",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$attribute",341],["T_WHITESPACE"," ",341],["T_IS_EQUAL","==",341],["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],["T_RETURN","return",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","setAttributeSetIdOrder",342],"(",["T_VARIABLE","$dir",342],")",";",["T_WHITESPACE","\n        ",342],"}",["T_WHITESPACE","\n        ",343],["T_RETURN","return",344],["T_WHITESPACE"," ",344],["T_STRING","parent",344],["T_DOUBLE_COLON","::",344],["T_STRING","setOrder",344],"(",["T_VARIABLE","$attribute",344],",",["T_WHITESPACE"," ",344],["T_VARIABLE","$dir",344],")",";",["T_WHITESPACE","\n    ",344],"}",["T_WHITESPACE","\n\n    ",345],["T_DOC_COMMENT","\/**\n     * Add specific link model attribute to collection filter\n     *\n     * @param string $attributeCode\n     * @param array|null $condition\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Link_Product_Collection\n     *\/",347],["T_WHITESPACE","\n    ",354],["T_PUBLIC","public",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","addLinkModelFieldToFilter",355],"(",["T_VARIABLE","$attributeCode",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$condition",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_STRING","null",355],")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_IF","if",357],["T_WHITESPACE"," ",357],"(","!",["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getProduct",357],"(",")",["T_WHITESPACE"," ",357],["T_BOOLEAN_OR","||",357],["T_WHITESPACE"," ",357],"!",["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getProduct",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","getId",357],"(",")",")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n            ",357],["T_RETURN","return",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$this",358],";",["T_WHITESPACE","\n        ",358],"}",["T_WHITESPACE","\n\n        ",359],["T_VARIABLE","$attribute",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_STRING","null",361],";",["T_WHITESPACE","\n        ",361],["T_FOREACH","foreach",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getLinkModel",362],"(",")",["T_OBJECT_OPERATOR","->",362],["T_STRING","getAttributes",362],"(",")",["T_WHITESPACE"," ",362],["T_AS","as",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$attributeData",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_IF","if",363],["T_WHITESPACE"," ",363],"(",["T_VARIABLE","$attributeData",363],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",363],"]",["T_WHITESPACE"," ",363],["T_IS_EQUAL","==",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$attributeCode",363],")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n                ",363],["T_VARIABLE","$attribute",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_VARIABLE","$attributeData",364],";",["T_WHITESPACE","\n                ",364],["T_BREAK","break",365],";",["T_WHITESPACE","\n            ",365],"}",["T_WHITESPACE","\n        ",366],"}",["T_WHITESPACE","\n\n        ",367],["T_IF","if",369],["T_WHITESPACE"," ",369],"(","!",["T_VARIABLE","$attribute",369],")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n            ",369],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$this",370],";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n\n        ",371],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_hasLinkFilter",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","true",373],";",["T_WHITESPACE","\n\n        ",373],["T_VARIABLE","$field",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_getLinkAttributeTableAlias",375],"(",["T_VARIABLE","$attribute",375],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",375],"]",",",["T_WHITESPACE"," ",375],["T_VARIABLE","$attribute",375],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",375],"]",")",["T_WHITESPACE"," ",375],".",["T_WHITESPACE"," ",375],["T_CONSTANT_ENCAPSED_STRING","'.value'",375],";",["T_WHITESPACE","\n        ",375],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getSelect",376],"(",")",["T_OBJECT_OPERATOR","->",376],["T_STRING","where",376],"(",["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_getConditionSql",376],"(",["T_VARIABLE","$field",376],",",["T_WHITESPACE"," ",376],["T_VARIABLE","$condition",376],")",")",";",["T_WHITESPACE","\n\n        ",376],["T_RETURN","return",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],";",["T_WHITESPACE","\n    ",378],"}",["T_WHITESPACE","\n",379],"}",["T_WHITESPACE","\n",380]]