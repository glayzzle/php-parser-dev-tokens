[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog Product Flat Indexer Resource Model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Flat_Indexer",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Index_Model_Resource_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","XML_NODE_MAX_INDEX_COUNT",37],["T_WHITESPACE","  ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'global\/catalog\/product\/flat\/max_index_count'",37],";",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","XML_NODE_ATTRIBUTE_NODES",38],["T_WHITESPACE","  ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'global\/catalog\/product\/flat\/attribute_nodes'",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Attribute codes for flat\n     *\n     * @var array\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_attributeCodes",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Attribute objects for flat cache\n     *\n     * @var array\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_attributes",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Required system attributes for preload\n     *\n     * @var array\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_systemAttributes",59],["T_WHITESPACE","     ",59],"=",["T_WHITESPACE"," ",59],["T_ARRAY","array",59],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'required_options'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'weight'",59],")",";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Eav Catalog_Product Entity Type Id\n     *\n     * @var int\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_entityTypeId",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Flat table columns cache\n     *\n     * @var array\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$_columns",73],";",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Flat table indexes cache\n     *\n     * @var array\n     *\/",75],["T_WHITESPACE","\n    ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$_indexes",80],";",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Product Type Instances cache\n     *\n     * @var array\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$_productTypes",87],";",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Exists flat tables cache\n     *\n     * @var array\n     *\/",89],["T_WHITESPACE","\n    ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$_existsFlatTables",94],["T_WHITESPACE","     ",94],"=",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",")",";",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Flat tables which were prepared\n     *\n     * @var array\n     *\/",96],["T_WHITESPACE","\n    ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$_preparedFlatTables",101],["T_WHITESPACE","   ",101],"=",["T_WHITESPACE"," ",101],["T_ARRAY","array",101],"(",")",";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Initialize connection\n     *\n     *\/",103],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","_construct",107],"(",")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_init",109],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",109],")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Rebuild Catalog Product Flat Data\n     *\n     * @param Mage_Core_Model_Store|int $store\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",112],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","rebuild",118],"(",["T_VARIABLE","$store",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","null",118],")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$store",120],["T_WHITESPACE"," ",120],["T_IS_IDENTICAL","===",120],["T_WHITESPACE"," ",120],["T_STRING","null",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_FOREACH","foreach",121],["T_WHITESPACE"," ",121],"(",["T_STRING","Mage",121],["T_DOUBLE_COLON","::",121],["T_STRING","app",121],"(",")",["T_OBJECT_OPERATOR","->",121],["T_STRING","getStores",121],"(",")",["T_WHITESPACE"," ",121],["T_AS","as",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$store",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","rebuild",122],"(",["T_VARIABLE","$store",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getId",122],"(",")",")",";",["T_WHITESPACE","\n            ",122],"}",["T_WHITESPACE","\n            ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$storeId",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_INT_CAST","(int)",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","app",127],"(",")",["T_OBJECT_OPERATOR","->",127],["T_STRING","getStore",127],"(",["T_VARIABLE","$store",127],")",["T_OBJECT_OPERATOR","->",127],["T_STRING","getId",127],"(",")",";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","prepareFlatTable",129],"(",["T_VARIABLE","$storeId",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","cleanNonWebsiteProducts",130],"(",["T_VARIABLE","$storeId",130],")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","updateStaticAttributes",131],"(",["T_VARIABLE","$storeId",131],")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","updateEavAttributes",132],"(",["T_VARIABLE","$storeId",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","updateEventAttributes",133],"(",["T_VARIABLE","$storeId",133],")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","updateRelationProducts",134],"(",["T_VARIABLE","$storeId",134],")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","cleanRelationProducts",135],"(",["T_VARIABLE","$storeId",135],")",";",["T_WHITESPACE","\n\n        ",135],["T_VARIABLE","$flag",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getFlatHelper",137],"(",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getFlag",137],"(",")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$flag",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setIsBuilt",138],"(",["T_STRING","true",138],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","setStoreBuilt",138],"(",["T_VARIABLE","$storeId",138],",",["T_WHITESPACE"," ",138],["T_STRING","true",138],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","save",138],"(",")",";",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Retrieve Catalog Product Flat helper\n     *\n     * @return Mage_Catalog_Helper_Product_Flat\n     *\/",142],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","getFlatHelper",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","Mage",149],["T_DOUBLE_COLON","::",149],["T_STRING","helper",149],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_flat'",149],")",";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Retrieve attribute codes using for flat\n     *\n     * @return array\n     *\/",152],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","getAttributeCodes",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_attributeCodes",159],["T_WHITESPACE"," ",159],["T_IS_IDENTICAL","===",159],["T_WHITESPACE"," ",159],["T_STRING","null",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$adapter",160],["T_WHITESPACE","               ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_getReadAdapter",160],"(",")",";",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_attributeCodes",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_ARRAY","array",161],"(",")",";",["T_WHITESPACE","\n\n            ",161],["T_VARIABLE","$attributeNodes",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","Mage",163],["T_DOUBLE_COLON","::",163],["T_STRING","getConfig",163],"(",")",["T_WHITESPACE","\n                ",163],["T_OBJECT_OPERATOR","->",164],["T_STRING","getNode",164],"(",["T_STRING","self",164],["T_DOUBLE_COLON","::",164],["T_STRING","XML_NODE_ATTRIBUTE_NODES",164],")",["T_WHITESPACE","\n                ",164],["T_OBJECT_OPERATOR","->",165],["T_STRING","children",165],"(",")",";",["T_WHITESPACE","\n            ",165],["T_FOREACH","foreach",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$attributeNodes",166],["T_WHITESPACE"," ",166],["T_AS","as",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$node",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                ",166],["T_VARIABLE","$attributes",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","Mage",167],["T_DOUBLE_COLON","::",167],["T_STRING","getConfig",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","getNode",167],"(",["T_STRING_CAST","(string)",167],["T_VARIABLE","$node",167],")",["T_OBJECT_OPERATOR","->",167],["T_STRING","asArray",167],"(",")",";",["T_WHITESPACE","\n                ",167],["T_VARIABLE","$attributes",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","array_keys",168],"(",["T_VARIABLE","$attributes",168],")",";",["T_WHITESPACE","\n                ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_systemAttributes",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","array_unique",169],"(",["T_STRING","array_merge",169],"(",["T_VARIABLE","$attributes",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_systemAttributes",169],")",")",";",["T_WHITESPACE","\n            ",169],"}",["T_WHITESPACE","\n\n            ",170],["T_VARIABLE","$bind",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",["T_WHITESPACE","\n                ",172],["T_CONSTANT_ENCAPSED_STRING","'backend_type'",173],["T_WHITESPACE","      ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_STRING","Mage_Eav_Model_Entity_Attribute_Abstract",173],["T_DOUBLE_COLON","::",173],["T_STRING","TYPE_STATIC",173],",",["T_WHITESPACE","\n                ",173],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",174],["T_WHITESPACE","    ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getEntityTypeId",174],"(",")",["T_WHITESPACE","\n            ",174],")",";",["T_WHITESPACE","\n\n            ",175],["T_VARIABLE","$select",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$adapter",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","select",177],"(",")",["T_WHITESPACE","\n                ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","from",178],"(",["T_ARRAY","array",178],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getTable",178],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute'",178],")",")",")",["T_WHITESPACE","\n                ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","join",179],"(",["T_WHITESPACE","\n                    ",179],["T_ARRAY","array",180],"(",["T_CONSTANT_ENCAPSED_STRING","'additional_table'",180],["T_WHITESPACE"," ",180],["T_DOUBLE_ARROW","=>",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getTable",180],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/eav_attribute'",180],")",")",",",["T_WHITESPACE","\n                    ",180],["T_CONSTANT_ENCAPSED_STRING","'additional_table.attribute_id = main_table.attribute_id'",181],["T_WHITESPACE","\n                ",181],")",["T_WHITESPACE","\n                ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","where",183],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_type_id = :entity_type_id'",183],")",";",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$whereCondition",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_ARRAY","array",184],"(",["T_WHITESPACE","\n                ",184],["T_CONSTANT_ENCAPSED_STRING","'main_table.backend_type = :backend_type'",185],",",["T_WHITESPACE","\n                ",185],["T_VARIABLE","$adapter",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","quoteInto",186],"(",["T_CONSTANT_ENCAPSED_STRING","'additional_table.is_used_for_promo_rules = ?'",186],",",["T_WHITESPACE"," ",186],["T_LNUMBER","1",186],")",",",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$adapter",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","quoteInto",187],"(",["T_CONSTANT_ENCAPSED_STRING","'additional_table.used_in_product_listing = ?'",187],",",["T_WHITESPACE"," ",187],["T_LNUMBER","1",187],")",",",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$adapter",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","quoteInto",188],"(",["T_CONSTANT_ENCAPSED_STRING","'additional_table.used_for_sort_by = ?'",188],",",["T_WHITESPACE"," ",188],["T_LNUMBER","1",188],")",",",["T_WHITESPACE","\n                ",188],["T_VARIABLE","$adapter",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","quoteInto",189],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.attribute_code IN(?)'",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_systemAttributes",189],")",["T_WHITESPACE","\n            ",189],")",";",["T_WHITESPACE","\n            ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getFlatHelper",191],"(",")",["T_OBJECT_OPERATOR","->",191],["T_STRING","isAddFilterableAttributes",191],"(",")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n               ",191],["T_VARIABLE","$whereCondition",192],"[","]",["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$adapter",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","quoteInto",192],"(",["T_CONSTANT_ENCAPSED_STRING","'additional_table.is_filterable > ?'",192],",",["T_WHITESPACE"," ",192],["T_LNUMBER","0",192],")",";",["T_WHITESPACE","\n            ",192],"}",["T_WHITESPACE","\n\n            ",193],["T_VARIABLE","$select",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","where",195],"(",["T_STRING","implode",195],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$whereCondition",195],")",")",";",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$attributesData",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$adapter",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","fetchAll",196],"(",["T_VARIABLE","$select",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$bind",196],")",";",["T_WHITESPACE","\n            ",196],["T_STRING","Mage",197],["T_DOUBLE_COLON","::",197],["T_STRING","getSingleton",197],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",197],")",["T_WHITESPACE","\n                ",197],["T_OBJECT_OPERATOR","->",198],["T_STRING","importAttributesData",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getEntityType",198],"(",")",",",["T_WHITESPACE"," ",198],["T_VARIABLE","$attributesData",198],")",";",["T_WHITESPACE","\n\n            ",198],["T_FOREACH","foreach",200],["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$attributesData",200],["T_WHITESPACE"," ",200],["T_AS","as",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$data",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_attributeCodes",201],"[",["T_VARIABLE","$data",201],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",201],"]","]",["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$data",201],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",201],"]",";",["T_WHITESPACE","\n            ",201],"}",["T_WHITESPACE","\n            ",202],["T_UNSET","unset",203],"(",["T_VARIABLE","$attributesData",203],")",";",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n\n        ",204],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_attributeCodes",206],";",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n\n    ",207],["T_DOC_COMMENT","\/**\n     * Retrieve entity type\n     *\n     * @return string\n     *\/",209],["T_WHITESPACE","\n    ",213],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","getEntityType",214],"(",")",["T_WHITESPACE","\n    ",214],"{",["T_WHITESPACE","\n        ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_STRING","Mage_Catalog_Model_Product",216],["T_DOUBLE_COLON","::",216],["T_STRING","ENTITY",216],";",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n\n    ",217],["T_DOC_COMMENT","\/**\n     * Retrieve Catalog Entity Type Id\n     *\n     * @return int\n     *\/",219],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","getEntityTypeId",224],"(",")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_entityTypeId",226],["T_WHITESPACE"," ",226],["T_IS_IDENTICAL","===",226],["T_WHITESPACE"," ",226],["T_STRING","null",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_entityTypeId",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","getResourceModel",227],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/config'",227],")",["T_WHITESPACE","\n                ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","getEntityTypeId",228],"(",")",";",["T_WHITESPACE","\n        ",228],"}",["T_WHITESPACE","\n        ",229],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","_entityTypeId",230],";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Retrieve attribute objects for flat\n     *\n     * @return array\n     *\/",233],["T_WHITESPACE","\n    ",237],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","getAttributes",238],"(",")",["T_WHITESPACE","\n    ",238],"{",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_attributes",240],["T_WHITESPACE"," ",240],["T_IS_IDENTICAL","===",240],["T_WHITESPACE"," ",240],["T_STRING","null",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_attributes",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_ARRAY","array",241],"(",")",";",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$attributeCodes",242],["T_WHITESPACE","    ",242],"=",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getAttributeCodes",242],"(",")",";",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$entity",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","getSingleton",243],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",243],")",["T_WHITESPACE","\n                ",243],["T_OBJECT_OPERATOR","->",244],["T_STRING","getEntityType",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getEntityType",244],"(",")",")",["T_WHITESPACE","\n                ",244],["T_OBJECT_OPERATOR","->",245],["T_STRING","getEntity",245],"(",")",";",["T_WHITESPACE","\n\n            ",245],["T_FOREACH","foreach",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$attributeCodes",247],["T_WHITESPACE"," ",247],["T_AS","as",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$attributeCode",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n                ",247],["T_VARIABLE","$attribute",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","Mage",248],["T_DOUBLE_COLON","::",248],["T_STRING","getSingleton",248],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",248],")",["T_WHITESPACE","\n                    ",248],["T_OBJECT_OPERATOR","->",249],["T_STRING","getAttribute",249],"(",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getEntityType",249],"(",")",",",["T_WHITESPACE"," ",249],["T_VARIABLE","$attributeCode",249],")",["T_WHITESPACE","\n                    ",249],["T_OBJECT_OPERATOR","->",250],["T_STRING","setEntity",250],"(",["T_VARIABLE","$entity",250],")",";",["T_WHITESPACE","\n                ",250],["T_TRY","try",251],["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n                    ",251],["T_COMMENT","\/\/ check if exists source and backend model.\n",252],["T_WHITESPACE","                    ",253],["T_COMMENT","\/\/ To prevent exception when some module was disabled\n",253],["T_WHITESPACE","                    ",254],["T_VARIABLE","$attribute",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","usesSource",254],"(",")",["T_WHITESPACE"," ",254],["T_BOOLEAN_AND","&&",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$attribute",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getSource",254],"(",")",";",["T_WHITESPACE","\n                    ",254],["T_VARIABLE","$attribute",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getBackend",255],"(",")",";",["T_WHITESPACE","\n                    ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_attributes",256],"[",["T_VARIABLE","$attributeCode",256],"]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_VARIABLE","$attribute",256],";",["T_WHITESPACE","\n                ",256],"}",["T_WHITESPACE"," ",257],["T_CATCH","catch",257],["T_WHITESPACE"," ",257],"(",["T_STRING","Exception",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$e",257],")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n                    ",257],["T_STRING","Mage",258],["T_DOUBLE_COLON","::",258],["T_STRING","logException",258],"(",["T_VARIABLE","$e",258],")",";",["T_WHITESPACE","\n                ",258],"}",["T_WHITESPACE","\n            ",259],"}",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n\n        ",261],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_attributes",263],";",["T_WHITESPACE","\n    ",263],"}",["T_WHITESPACE","\n\n    ",264],["T_DOC_COMMENT","\/**\n     * Retrieve loaded attribute by code\n     *\n     * @param string $attributeCode\n     * @throws Mage_Core_Exception\n     * @return Mage_Eav_Model_Entity_Attribute\n     *\/",266],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","getAttribute",273],"(",["T_VARIABLE","$attributeCode",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$attributes",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getAttributes",275],"(",")",";",["T_WHITESPACE","\n        ",275],["T_IF","if",276],["T_WHITESPACE"," ",276],"(","!",["T_ISSET","isset",276],"(",["T_VARIABLE","$attributes",276],"[",["T_VARIABLE","$attributeCode",276],"]",")",")",["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$attribute",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_STRING","Mage",277],["T_DOUBLE_COLON","::",277],["T_STRING","getModel",277],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/resource_eav_attribute'",277],")",["T_WHITESPACE","\n                ",277],["T_OBJECT_OPERATOR","->",278],["T_STRING","loadByCode",278],"(",["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getEntityTypeId",278],"(",")",",",["T_WHITESPACE"," ",278],["T_VARIABLE","$attributeCode",278],")",";",["T_WHITESPACE","\n            ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(","!",["T_VARIABLE","$attribute",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getId",279],"(",")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                ",279],["T_STRING","Mage",280],["T_DOUBLE_COLON","::",280],["T_STRING","throwException",280],"(",["T_STRING","Mage",280],["T_DOUBLE_COLON","::",280],["T_STRING","helper",280],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",280],")",["T_OBJECT_OPERATOR","->",280],["T_STRING","__",280],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid attribute %s'",280],",",["T_WHITESPACE"," ",280],["T_VARIABLE","$attributeCode",280],")",")",";",["T_WHITESPACE","\n            ",280],"}",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$entity",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","Mage",282],["T_DOUBLE_COLON","::",282],["T_STRING","getSingleton",282],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",282],")",["T_WHITESPACE","\n                ",282],["T_OBJECT_OPERATOR","->",283],["T_STRING","getEntityType",283],"(",["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getEntityType",283],"(",")",")",["T_WHITESPACE","\n                ",283],["T_OBJECT_OPERATOR","->",284],["T_STRING","getEntity",284],"(",")",";",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$attribute",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","setEntity",285],"(",["T_VARIABLE","$entity",285],")",";",["T_WHITESPACE","\n\n            ",285],["T_RETURN","return",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$attribute",287],";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n\n        ",288],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$attributes",290],"[",["T_VARIABLE","$attributeCode",290],"]",";",["T_WHITESPACE","\n    ",290],"}",["T_WHITESPACE","\n\n    ",291],["T_DOC_COMMENT","\/**\n     * Retrieve Catalog Product Flat Table name\n     *\n     * @param int $storeId\n     * @return string\n     *\/",293],["T_WHITESPACE","\n    ",298],["T_PUBLIC","public",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","getFlatTableName",299],"(",["T_VARIABLE","$storeId",299],")",["T_WHITESPACE","\n    ",299],"{",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_STRING","sprintf",301],"(",["T_CONSTANT_ENCAPSED_STRING","'%s_%s'",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getTable",301],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_flat'",301],")",",",["T_WHITESPACE"," ",301],["T_VARIABLE","$storeId",301],")",";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Retrieve catalog product flat columns array in old format (used before MMDB support)\n     *\n     * @return array\n     *\/",304],["T_WHITESPACE","\n    ",308],["T_PROTECTED","protected",309],["T_WHITESPACE"," ",309],["T_FUNCTION","function",309],["T_WHITESPACE"," ",309],["T_STRING","_getFlatColumnsOldDefinition",309],"(",")",["T_WHITESPACE","\n    ",309],"{",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$columns",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_ARRAY","array",311],"(",")",";",["T_WHITESPACE","\n        ",311],["T_VARIABLE","$columns",312],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",312],"]",["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_ARRAY","array",312],"(",["T_WHITESPACE","\n            ",312],["T_CONSTANT_ENCAPSED_STRING","'type'",313],["T_WHITESPACE","      ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","'int(10)'",313],",",["T_WHITESPACE","\n            ",313],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",314],["T_WHITESPACE","  ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_STRING","true",314],",",["T_WHITESPACE","\n            ",314],["T_CONSTANT_ENCAPSED_STRING","'is_null'",315],["T_WHITESPACE","   ",315],["T_DOUBLE_ARROW","=>",315],["T_WHITESPACE"," ",315],["T_STRING","false",315],",",["T_WHITESPACE","\n            ",315],["T_CONSTANT_ENCAPSED_STRING","'default'",316],["T_WHITESPACE","   ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_STRING","null",316],",",["T_WHITESPACE","\n            ",316],["T_CONSTANT_ENCAPSED_STRING","'extra'",317],["T_WHITESPACE","     ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_STRING","null",317],["T_WHITESPACE","\n        ",317],")",";",["T_WHITESPACE","\n        ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","getFlatHelper",319],"(",")",["T_OBJECT_OPERATOR","->",319],["T_STRING","isAddChildData",319],"(",")",")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n            ",319],["T_VARIABLE","$columns",320],"[",["T_CONSTANT_ENCAPSED_STRING","'child_id'",320],"]",["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_ARRAY","array",320],"(",["T_WHITESPACE","\n                ",320],["T_CONSTANT_ENCAPSED_STRING","'type'",321],["T_WHITESPACE","      ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'int(10)'",321],",",["T_WHITESPACE","\n                ",321],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",322],["T_WHITESPACE","  ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_STRING","true",322],",",["T_WHITESPACE","\n                ",322],["T_CONSTANT_ENCAPSED_STRING","'is_null'",323],["T_WHITESPACE","   ",323],["T_DOUBLE_ARROW","=>",323],["T_WHITESPACE"," ",323],["T_STRING","true",323],",",["T_WHITESPACE","\n                ",323],["T_CONSTANT_ENCAPSED_STRING","'default'",324],["T_WHITESPACE","   ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_STRING","null",324],",",["T_WHITESPACE","\n                ",324],["T_CONSTANT_ENCAPSED_STRING","'extra'",325],["T_WHITESPACE","     ",325],["T_DOUBLE_ARROW","=>",325],["T_WHITESPACE"," ",325],["T_STRING","null",325],["T_WHITESPACE","\n            ",325],")",";",["T_WHITESPACE","\n            ",326],["T_VARIABLE","$columns",327],"[",["T_CONSTANT_ENCAPSED_STRING","'is_child'",327],"]",["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_ARRAY","array",327],"(",["T_WHITESPACE","\n                ",327],["T_CONSTANT_ENCAPSED_STRING","'type'",328],["T_WHITESPACE","      ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'tinyint(1)'",328],",",["T_WHITESPACE","\n                ",328],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",329],["T_WHITESPACE","  ",329],["T_DOUBLE_ARROW","=>",329],["T_WHITESPACE"," ",329],["T_STRING","true",329],",",["T_WHITESPACE","\n                ",329],["T_CONSTANT_ENCAPSED_STRING","'is_null'",330],["T_WHITESPACE","   ",330],["T_DOUBLE_ARROW","=>",330],["T_WHITESPACE"," ",330],["T_STRING","false",330],",",["T_WHITESPACE","\n                ",330],["T_CONSTANT_ENCAPSED_STRING","'default'",331],["T_WHITESPACE","   ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_LNUMBER","0",331],",",["T_WHITESPACE","\n                ",331],["T_CONSTANT_ENCAPSED_STRING","'extra'",332],["T_WHITESPACE","     ",332],["T_DOUBLE_ARROW","=>",332],["T_WHITESPACE"," ",332],["T_STRING","null",332],["T_WHITESPACE","\n            ",332],")",";",["T_WHITESPACE","\n        ",333],"}",["T_WHITESPACE","\n        ",334],["T_VARIABLE","$columns",335],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",335],"]",["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_ARRAY","array",335],"(",["T_WHITESPACE","\n            ",335],["T_CONSTANT_ENCAPSED_STRING","'type'",336],["T_WHITESPACE","      ",336],["T_DOUBLE_ARROW","=>",336],["T_WHITESPACE"," ",336],["T_CONSTANT_ENCAPSED_STRING","'smallint(5)'",336],",",["T_WHITESPACE","\n            ",336],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",337],["T_WHITESPACE","  ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_STRING","true",337],",",["T_WHITESPACE","\n            ",337],["T_CONSTANT_ENCAPSED_STRING","'is_null'",338],["T_WHITESPACE","   ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_STRING","false",338],",",["T_WHITESPACE","\n            ",338],["T_CONSTANT_ENCAPSED_STRING","'default'",339],["T_WHITESPACE","   ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_LNUMBER","0",339],",",["T_WHITESPACE","\n            ",339],["T_CONSTANT_ENCAPSED_STRING","'extra'",340],["T_WHITESPACE","     ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_STRING","null",340],["T_WHITESPACE","\n        ",340],")",";",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$columns",342],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",342],"]",["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_ARRAY","array",342],"(",["T_WHITESPACE","\n            ",342],["T_CONSTANT_ENCAPSED_STRING","'type'",343],["T_WHITESPACE","      ",343],["T_DOUBLE_ARROW","=>",343],["T_WHITESPACE"," ",343],["T_CONSTANT_ENCAPSED_STRING","'varchar(32)'",343],",",["T_WHITESPACE","\n            ",343],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",344],["T_WHITESPACE","  ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_STRING","false",344],",",["T_WHITESPACE","\n            ",344],["T_CONSTANT_ENCAPSED_STRING","'is_null'",345],["T_WHITESPACE","   ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_STRING","false",345],",",["T_WHITESPACE","\n            ",345],["T_CONSTANT_ENCAPSED_STRING","'default'",346],["T_WHITESPACE","   ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],["T_STRING","Mage_Catalog_Model_Product_Type",346],["T_DOUBLE_COLON","::",346],["T_STRING","TYPE_SIMPLE",346],",",["T_WHITESPACE","\n            ",346],["T_CONSTANT_ENCAPSED_STRING","'extra'",347],["T_WHITESPACE","     ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],["T_STRING","null",347],["T_WHITESPACE","\n        ",347],")",";",["T_WHITESPACE","\n\n        ",348],["T_RETURN","return",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$columns",350],";",["T_WHITESPACE","\n    ",350],"}",["T_WHITESPACE","\n\n    ",351],["T_DOC_COMMENT","\/**\n     * Retrieve catalog product flat columns array in DDL format\n     *\n     * @return array\n     *\/",353],["T_WHITESPACE","\n    ",357],["T_PROTECTED","protected",358],["T_WHITESPACE"," ",358],["T_FUNCTION","function",358],["T_WHITESPACE"," ",358],["T_STRING","_getFlatColumnsDdlDefinition",358],"(",")",["T_WHITESPACE","\n    ",358],"{",["T_WHITESPACE","\n        ",359],["T_VARIABLE","$columns",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_ARRAY","array",360],"(",")",";",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$columns",361],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",361],"]",["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_ARRAY","array",361],"(",["T_WHITESPACE","\n            ",361],["T_CONSTANT_ENCAPSED_STRING","'type'",362],["T_WHITESPACE","      ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_STRING","Varien_Db_Ddl_Table",362],["T_DOUBLE_COLON","::",362],["T_STRING","TYPE_INTEGER",362],",",["T_WHITESPACE","\n            ",362],["T_CONSTANT_ENCAPSED_STRING","'length'",363],["T_WHITESPACE","    ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_STRING","null",363],",",["T_WHITESPACE","\n            ",363],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",364],["T_WHITESPACE","  ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_STRING","true",364],",",["T_WHITESPACE","\n            ",364],["T_CONSTANT_ENCAPSED_STRING","'nullable'",365],["T_WHITESPACE","  ",365],["T_DOUBLE_ARROW","=>",365],["T_WHITESPACE"," ",365],["T_STRING","false",365],",",["T_WHITESPACE","\n            ",365],["T_CONSTANT_ENCAPSED_STRING","'default'",366],["T_WHITESPACE","   ",366],["T_DOUBLE_ARROW","=>",366],["T_WHITESPACE"," ",366],["T_STRING","false",366],",",["T_WHITESPACE","\n            ",366],["T_CONSTANT_ENCAPSED_STRING","'primary'",367],["T_WHITESPACE","   ",367],["T_DOUBLE_ARROW","=>",367],["T_WHITESPACE"," ",367],["T_STRING","true",367],",",["T_WHITESPACE","\n            ",367],["T_CONSTANT_ENCAPSED_STRING","'comment'",368],["T_WHITESPACE","   ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'Entity Id'",368],["T_WHITESPACE","\n        ",368],")",";",["T_WHITESPACE","\n        ",369],["T_IF","if",370],["T_WHITESPACE"," ",370],"(",["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getFlatHelper",370],"(",")",["T_OBJECT_OPERATOR","->",370],["T_STRING","isAddChildData",370],"(",")",")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n            ",370],["T_VARIABLE","$columns",371],"[",["T_CONSTANT_ENCAPSED_STRING","'child_id'",371],"]",["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_ARRAY","array",371],"(",["T_WHITESPACE","\n                ",371],["T_CONSTANT_ENCAPSED_STRING","'type'",372],["T_WHITESPACE","      ",372],["T_DOUBLE_ARROW","=>",372],["T_WHITESPACE"," ",372],["T_STRING","Varien_Db_Ddl_Table",372],["T_DOUBLE_COLON","::",372],["T_STRING","TYPE_INTEGER",372],",",["T_WHITESPACE","\n                ",372],["T_CONSTANT_ENCAPSED_STRING","'length'",373],["T_WHITESPACE","    ",373],["T_DOUBLE_ARROW","=>",373],["T_WHITESPACE"," ",373],["T_STRING","null",373],",",["T_WHITESPACE","\n                ",373],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",374],["T_WHITESPACE","  ",374],["T_DOUBLE_ARROW","=>",374],["T_WHITESPACE"," ",374],["T_STRING","true",374],",",["T_WHITESPACE","\n                ",374],["T_CONSTANT_ENCAPSED_STRING","'nullable'",375],["T_WHITESPACE","  ",375],["T_DOUBLE_ARROW","=>",375],["T_WHITESPACE"," ",375],["T_STRING","true",375],",",["T_WHITESPACE","\n                ",375],["T_CONSTANT_ENCAPSED_STRING","'default'",376],["T_WHITESPACE","   ",376],["T_DOUBLE_ARROW","=>",376],["T_WHITESPACE"," ",376],["T_STRING","null",376],",",["T_WHITESPACE","\n                ",376],["T_CONSTANT_ENCAPSED_STRING","'primary'",377],["T_WHITESPACE","   ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],["T_STRING","true",377],",",["T_WHITESPACE","\n                ",377],["T_CONSTANT_ENCAPSED_STRING","'comment'",378],["T_WHITESPACE","   ",378],["T_DOUBLE_ARROW","=>",378],["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'Child Id'",378],["T_WHITESPACE","\n            ",378],")",";",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$columns",380],"[",["T_CONSTANT_ENCAPSED_STRING","'is_child'",380],"]",["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_ARRAY","array",380],"(",["T_WHITESPACE","\n                ",380],["T_CONSTANT_ENCAPSED_STRING","'type'",381],["T_WHITESPACE","      ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_STRING","Varien_Db_Ddl_Table",381],["T_DOUBLE_COLON","::",381],["T_STRING","TYPE_SMALLINT",381],",",["T_WHITESPACE","\n                ",381],["T_CONSTANT_ENCAPSED_STRING","'length'",382],["T_WHITESPACE","    ",382],["T_DOUBLE_ARROW","=>",382],["T_WHITESPACE"," ",382],["T_LNUMBER","1",382],",",["T_WHITESPACE","\n                ",382],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",383],["T_WHITESPACE","  ",383],["T_DOUBLE_ARROW","=>",383],["T_WHITESPACE"," ",383],["T_STRING","true",383],",",["T_WHITESPACE","\n                ",383],["T_CONSTANT_ENCAPSED_STRING","'nullable'",384],["T_WHITESPACE","  ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_STRING","false",384],",",["T_WHITESPACE","\n                ",384],["T_CONSTANT_ENCAPSED_STRING","'default'",385],["T_WHITESPACE","   ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_CONSTANT_ENCAPSED_STRING","'0'",385],",",["T_WHITESPACE","\n                ",385],["T_CONSTANT_ENCAPSED_STRING","'comment'",386],["T_WHITESPACE","   ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_CONSTANT_ENCAPSED_STRING","'Checks If Entity Is Child'",386],["T_WHITESPACE","\n            ",386],")",";",["T_WHITESPACE","\n        ",387],"}",["T_WHITESPACE","\n        ",388],["T_VARIABLE","$columns",389],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",389],"]",["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_ARRAY","array",389],"(",["T_WHITESPACE","\n            ",389],["T_CONSTANT_ENCAPSED_STRING","'type'",390],["T_WHITESPACE","      ",390],["T_DOUBLE_ARROW","=>",390],["T_WHITESPACE"," ",390],["T_STRING","Varien_Db_Ddl_Table",390],["T_DOUBLE_COLON","::",390],["T_STRING","TYPE_SMALLINT",390],",",["T_WHITESPACE","\n            ",390],["T_CONSTANT_ENCAPSED_STRING","'length'",391],["T_WHITESPACE","    ",391],["T_DOUBLE_ARROW","=>",391],["T_WHITESPACE"," ",391],["T_LNUMBER","5",391],",",["T_WHITESPACE","\n            ",391],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",392],["T_WHITESPACE","  ",392],["T_DOUBLE_ARROW","=>",392],["T_WHITESPACE"," ",392],["T_STRING","true",392],",",["T_WHITESPACE","\n            ",392],["T_CONSTANT_ENCAPSED_STRING","'nullable'",393],["T_WHITESPACE","  ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_STRING","false",393],",",["T_WHITESPACE","\n            ",393],["T_CONSTANT_ENCAPSED_STRING","'default'",394],["T_WHITESPACE","   ",394],["T_DOUBLE_ARROW","=>",394],["T_WHITESPACE"," ",394],["T_CONSTANT_ENCAPSED_STRING","'0'",394],",",["T_WHITESPACE","\n            ",394],["T_CONSTANT_ENCAPSED_STRING","'comment'",395],["T_WHITESPACE","   ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_CONSTANT_ENCAPSED_STRING","'Attribute Set Id'",395],["T_WHITESPACE","\n        ",395],")",";",["T_WHITESPACE","\n        ",396],["T_VARIABLE","$columns",397],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",397],"]",["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_ARRAY","array",397],"(",["T_WHITESPACE","\n            ",397],["T_CONSTANT_ENCAPSED_STRING","'type'",398],["T_WHITESPACE","      ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_STRING","Varien_Db_Ddl_Table",398],["T_DOUBLE_COLON","::",398],["T_STRING","TYPE_TEXT",398],",",["T_WHITESPACE","\n            ",398],["T_CONSTANT_ENCAPSED_STRING","'length'",399],["T_WHITESPACE","    ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],["T_LNUMBER","32",399],",",["T_WHITESPACE","\n            ",399],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",400],["T_WHITESPACE","  ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],["T_STRING","false",400],",",["T_WHITESPACE","\n            ",400],["T_CONSTANT_ENCAPSED_STRING","'nullable'",401],["T_WHITESPACE","  ",401],["T_DOUBLE_ARROW","=>",401],["T_WHITESPACE"," ",401],["T_STRING","false",401],",",["T_WHITESPACE","\n            ",401],["T_CONSTANT_ENCAPSED_STRING","'default'",402],["T_WHITESPACE","   ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_STRING","Mage_Catalog_Model_Product_Type",402],["T_DOUBLE_COLON","::",402],["T_STRING","TYPE_SIMPLE",402],",",["T_WHITESPACE","\n            ",402],["T_CONSTANT_ENCAPSED_STRING","'comment'",403],["T_WHITESPACE","   ",403],["T_DOUBLE_ARROW","=>",403],["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","'Type Id'",403],["T_WHITESPACE","\n        ",403],")",";",["T_WHITESPACE","\n\n        ",404],["T_RETURN","return",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$columns",406],";",["T_WHITESPACE","\n    ",406],"}",["T_WHITESPACE","\n\n    ",407],["T_DOC_COMMENT","\/**\n     * Retrieve catalog product flat table columns array\n     *\n     * @return array\n     *\/",409],["T_WHITESPACE","\n    ",413],["T_PUBLIC","public",414],["T_WHITESPACE"," ",414],["T_FUNCTION","function",414],["T_WHITESPACE"," ",414],["T_STRING","getFlatColumns",414],"(",")",["T_WHITESPACE","\n    ",414],"{",["T_WHITESPACE","\n        ",415],["T_IF","if",416],["T_WHITESPACE"," ",416],"(",["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","_columns",416],["T_WHITESPACE"," ",416],["T_IS_IDENTICAL","===",416],["T_WHITESPACE"," ",416],["T_STRING","null",416],")",["T_WHITESPACE"," ",416],"{",["T_WHITESPACE","\n            ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_STRING","Mage",417],["T_DOUBLE_COLON","::",417],["T_STRING","helper",417],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",417],")",["T_OBJECT_OPERATOR","->",417],["T_STRING","useDbCompatibleMode",417],"(",")",")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n                ",417],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_columns",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_getFlatColumnsOldDefinition",418],"(",")",";",["T_WHITESPACE","\n            ",418],"}",["T_WHITESPACE"," ",419],["T_ELSE","else",419],["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                ",419],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","_columns",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","_getFlatColumnsDdlDefinition",420],"(",")",";",["T_WHITESPACE","\n            ",420],"}",["T_WHITESPACE","\n\n            ",421],["T_FOREACH","foreach",423],["T_WHITESPACE"," ",423],"(",["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","getAttributes",423],"(",")",["T_WHITESPACE"," ",423],["T_AS","as",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$attribute",423],")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n                ",423],["T_DOC_COMMENT","\/** @var $attribute Mage_Eav_Model_Entity_Attribute_Abstract *\/",424],["T_WHITESPACE","\n                ",424],["T_VARIABLE","$columns",425],["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$attribute",425],["T_WHITESPACE","\n                    ",425],["T_OBJECT_OPERATOR","->",426],["T_STRING","setFlatAddFilterableAttributes",426],"(",["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getFlatHelper",426],"(",")",["T_OBJECT_OPERATOR","->",426],["T_STRING","isAddFilterableAttributes",426],"(",")",")",["T_WHITESPACE","\n                    ",426],["T_OBJECT_OPERATOR","->",427],["T_STRING","setFlatAddChildData",427],"(",["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getFlatHelper",427],"(",")",["T_OBJECT_OPERATOR","->",427],["T_STRING","isAddChildData",427],"(",")",")",["T_WHITESPACE","\n                    ",427],["T_OBJECT_OPERATOR","->",428],["T_STRING","getFlatColumns",428],"(",")",";",["T_WHITESPACE","\n                ",428],["T_IF","if",429],["T_WHITESPACE"," ",429],"(",["T_VARIABLE","$columns",429],["T_WHITESPACE"," ",429],["T_IS_NOT_IDENTICAL","!==",429],["T_WHITESPACE"," ",429],["T_STRING","null",429],")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n                    ",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_columns",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_STRING","array_merge",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_columns",430],",",["T_WHITESPACE"," ",430],["T_VARIABLE","$columns",430],")",";",["T_WHITESPACE","\n                ",430],"}",["T_WHITESPACE","\n            ",431],"}",["T_WHITESPACE","\n\n            ",432],["T_VARIABLE","$columnsObject",434],["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_NEW","new",434],["T_WHITESPACE"," ",434],["T_STRING","Varien_Object",434],"(",")",";",["T_WHITESPACE","\n            ",434],["T_VARIABLE","$columnsObject",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","setColumns",435],"(",["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","_columns",435],")",";",["T_WHITESPACE","\n            ",435],["T_STRING","Mage",436],["T_DOUBLE_COLON","::",436],["T_STRING","dispatchEvent",436],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_flat_prepare_columns'",436],",",["T_WHITESPACE","\n                ",436],["T_ARRAY","array",437],"(",["T_CONSTANT_ENCAPSED_STRING","'columns'",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],["T_VARIABLE","$columnsObject",437],")",["T_WHITESPACE","\n            ",437],")",";",["T_WHITESPACE","\n            ",438],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","_columns",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_VARIABLE","$columnsObject",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getColumns",439],"(",")",";",["T_WHITESPACE","\n        ",439],"}",["T_WHITESPACE","\n\n        ",440],["T_RETURN","return",442],["T_WHITESPACE"," ",442],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","_columns",442],";",["T_WHITESPACE","\n    ",442],"}",["T_WHITESPACE","\n\n    ",443],["T_DOC_COMMENT","\/**\n     * Retrieve catalog product flat table indexes array\n     *\n     * @return array\n     *\/",445],["T_WHITESPACE","\n    ",449],["T_PUBLIC","public",450],["T_WHITESPACE"," ",450],["T_FUNCTION","function",450],["T_WHITESPACE"," ",450],["T_STRING","getFlatIndexes",450],"(",")",["T_WHITESPACE","\n    ",450],"{",["T_WHITESPACE","\n        ",451],["T_IF","if",452],["T_WHITESPACE"," ",452],"(",["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","_indexes",452],["T_WHITESPACE"," ",452],["T_IS_IDENTICAL","===",452],["T_WHITESPACE"," ",452],["T_STRING","null",452],")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n            ",452],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","_indexes",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_ARRAY","array",453],"(",")",";",["T_WHITESPACE","\n\n            ",453],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getFlatHelper",455],"(",")",["T_OBJECT_OPERATOR","->",455],["T_STRING","isAddChildData",455],"(",")",")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                ",455],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","_indexes",456],"[",["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",456],"]",["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_ARRAY","array",456],"(",["T_WHITESPACE","\n                    ",456],["T_CONSTANT_ENCAPSED_STRING","'type'",457],["T_WHITESPACE","   ",457],["T_DOUBLE_ARROW","=>",457],["T_WHITESPACE"," ",457],["T_STRING","Varien_Db_Adapter_Interface",457],["T_DOUBLE_COLON","::",457],["T_STRING","INDEX_TYPE_PRIMARY",457],",",["T_WHITESPACE","\n                    ",457],["T_CONSTANT_ENCAPSED_STRING","'fields'",458],["T_WHITESPACE"," ",458],["T_DOUBLE_ARROW","=>",458],["T_WHITESPACE"," ",458],["T_ARRAY","array",458],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",458],",",["T_WHITESPACE"," ",458],["T_CONSTANT_ENCAPSED_STRING","'child_id'",458],")",["T_WHITESPACE","\n                ",458],")",";",["T_WHITESPACE","\n                ",459],["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","_indexes",460],"[",["T_CONSTANT_ENCAPSED_STRING","'IDX_CHILD'",460],"]",["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_ARRAY","array",460],"(",["T_WHITESPACE","\n                    ",460],["T_CONSTANT_ENCAPSED_STRING","'type'",461],["T_WHITESPACE","   ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_STRING","Varien_Db_Adapter_Interface",461],["T_DOUBLE_COLON","::",461],["T_STRING","INDEX_TYPE_INDEX",461],",",["T_WHITESPACE","\n                    ",461],["T_CONSTANT_ENCAPSED_STRING","'fields'",462],["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_ARRAY","array",462],"(",["T_CONSTANT_ENCAPSED_STRING","'child_id'",462],")",["T_WHITESPACE","\n                ",462],")",";",["T_WHITESPACE","\n                ",463],["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","_indexes",464],"[",["T_CONSTANT_ENCAPSED_STRING","'IDX_IS_CHILD'",464],"]",["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_ARRAY","array",464],"(",["T_WHITESPACE","\n                    ",464],["T_CONSTANT_ENCAPSED_STRING","'type'",465],["T_WHITESPACE","   ",465],["T_DOUBLE_ARROW","=>",465],["T_WHITESPACE"," ",465],["T_STRING","Varien_Db_Adapter_Interface",465],["T_DOUBLE_COLON","::",465],["T_STRING","INDEX_TYPE_INDEX",465],",",["T_WHITESPACE","\n                    ",465],["T_CONSTANT_ENCAPSED_STRING","'fields'",466],["T_WHITESPACE"," ",466],["T_DOUBLE_ARROW","=>",466],["T_WHITESPACE"," ",466],["T_ARRAY","array",466],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",466],",",["T_WHITESPACE"," ",466],["T_CONSTANT_ENCAPSED_STRING","'is_child'",466],")",["T_WHITESPACE","\n                ",466],")",";",["T_WHITESPACE","\n            ",467],"}",["T_WHITESPACE"," ",468],["T_ELSE","else",468],["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n                ",468],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_indexes",469],"[",["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",469],"]",["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_ARRAY","array",469],"(",["T_WHITESPACE","\n                    ",469],["T_CONSTANT_ENCAPSED_STRING","'type'",470],["T_WHITESPACE","   ",470],["T_DOUBLE_ARROW","=>",470],["T_WHITESPACE"," ",470],["T_STRING","Varien_Db_Adapter_Interface",470],["T_DOUBLE_COLON","::",470],["T_STRING","INDEX_TYPE_PRIMARY",470],",",["T_WHITESPACE","\n                    ",470],["T_CONSTANT_ENCAPSED_STRING","'fields'",471],["T_WHITESPACE"," ",471],["T_DOUBLE_ARROW","=>",471],["T_WHITESPACE"," ",471],["T_ARRAY","array",471],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",471],")",["T_WHITESPACE","\n                ",471],")",";",["T_WHITESPACE","\n            ",472],"}",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","_indexes",474],"[",["T_CONSTANT_ENCAPSED_STRING","'IDX_TYPE_ID'",474],"]",["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_ARRAY","array",474],"(",["T_WHITESPACE","\n                ",474],["T_CONSTANT_ENCAPSED_STRING","'type'",475],["T_WHITESPACE","   ",475],["T_DOUBLE_ARROW","=>",475],["T_WHITESPACE"," ",475],["T_STRING","Varien_Db_Adapter_Interface",475],["T_DOUBLE_COLON","::",475],["T_STRING","INDEX_TYPE_INDEX",475],",",["T_WHITESPACE","\n                ",475],["T_CONSTANT_ENCAPSED_STRING","'fields'",476],["T_WHITESPACE"," ",476],["T_DOUBLE_ARROW","=>",476],["T_WHITESPACE"," ",476],["T_ARRAY","array",476],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",476],")",["T_WHITESPACE","\n            ",476],")",";",["T_WHITESPACE","\n            ",477],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_indexes",478],"[",["T_CONSTANT_ENCAPSED_STRING","'IDX_ATTRIBUTE_SET'",478],"]",["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],["T_ARRAY","array",478],"(",["T_WHITESPACE","\n                ",478],["T_CONSTANT_ENCAPSED_STRING","'type'",479],["T_WHITESPACE","   ",479],["T_DOUBLE_ARROW","=>",479],["T_WHITESPACE"," ",479],["T_STRING","Varien_Db_Adapter_Interface",479],["T_DOUBLE_COLON","::",479],["T_STRING","INDEX_TYPE_INDEX",479],",",["T_WHITESPACE","\n                ",479],["T_CONSTANT_ENCAPSED_STRING","'fields'",480],["T_WHITESPACE"," ",480],["T_DOUBLE_ARROW","=>",480],["T_WHITESPACE"," ",480],["T_ARRAY","array",480],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",480],")",["T_WHITESPACE","\n            ",480],")",";",["T_WHITESPACE","\n\n            ",481],["T_FOREACH","foreach",483],["T_WHITESPACE"," ",483],"(",["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","getAttributes",483],"(",")",["T_WHITESPACE"," ",483],["T_AS","as",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$attribute",483],")",["T_WHITESPACE"," ",483],"{",["T_WHITESPACE","\n                ",483],["T_DOC_COMMENT","\/** @var $attribute Mage_Eav_Model_Entity_Attribute *\/",484],["T_WHITESPACE","\n                ",484],["T_VARIABLE","$indexes",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$attribute",485],["T_WHITESPACE","\n                    ",485],["T_OBJECT_OPERATOR","->",486],["T_STRING","setFlatAddFilterableAttributes",486],"(",["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getFlatHelper",486],"(",")",["T_OBJECT_OPERATOR","->",486],["T_STRING","isAddFilterableAttributes",486],"(",")",")",["T_WHITESPACE","\n                    ",486],["T_OBJECT_OPERATOR","->",487],["T_STRING","setFlatAddChildData",487],"(",["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","getFlatHelper",487],"(",")",["T_OBJECT_OPERATOR","->",487],["T_STRING","isAddChildData",487],"(",")",")",["T_WHITESPACE","\n                    ",487],["T_OBJECT_OPERATOR","->",488],["T_STRING","getFlatIndexes",488],"(",")",";",["T_WHITESPACE","\n                ",488],["T_IF","if",489],["T_WHITESPACE"," ",489],"(",["T_VARIABLE","$indexes",489],["T_WHITESPACE"," ",489],["T_IS_NOT_IDENTICAL","!==",489],["T_WHITESPACE"," ",489],["T_STRING","null",489],")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n                    ",489],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","_indexes",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_STRING","array_merge",490],"(",["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","_indexes",490],",",["T_WHITESPACE"," ",490],["T_VARIABLE","$indexes",490],")",";",["T_WHITESPACE","\n                ",490],"}",["T_WHITESPACE","\n            ",491],"}",["T_WHITESPACE","\n\n            ",492],["T_VARIABLE","$indexesObject",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_NEW","new",494],["T_WHITESPACE"," ",494],["T_STRING","Varien_Object",494],"(",")",";",["T_WHITESPACE","\n            ",494],["T_VARIABLE","$indexesObject",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","setIndexes",495],"(",["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_indexes",495],")",";",["T_WHITESPACE","\n            ",495],["T_STRING","Mage",496],["T_DOUBLE_COLON","::",496],["T_STRING","dispatchEvent",496],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_flat_prepare_indexes'",496],",",["T_WHITESPACE"," ",496],["T_ARRAY","array",496],"(",["T_WHITESPACE","\n                ",496],["T_CONSTANT_ENCAPSED_STRING","'indexes'",497],["T_WHITESPACE","   ",497],["T_DOUBLE_ARROW","=>",497],["T_WHITESPACE"," ",497],["T_VARIABLE","$indexesObject",497],["T_WHITESPACE","\n            ",497],")",")",";",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_indexes",499],["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_VARIABLE","$indexesObject",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","getIndexes",499],"(",")",";",["T_WHITESPACE","\n        ",499],"}",["T_WHITESPACE","\n\n        ",500],["T_RETURN","return",502],["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","_indexes",502],";",["T_WHITESPACE","\n    ",502],"}",["T_WHITESPACE","\n\n    ",503],["T_DOC_COMMENT","\/**\n     * Compare Flat style with Describe style columns\n     * If column a different - return false\n     *\n     * @param array $column\n     * @param array $describe\n     * @return bool\n     *\/",505],["T_WHITESPACE","\n    ",512],["T_PROTECTED","protected",513],["T_WHITESPACE"," ",513],["T_FUNCTION","function",513],["T_WHITESPACE"," ",513],["T_STRING","_compareColumnProperties",513],"(",["T_VARIABLE","$column",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$describe",513],")",["T_WHITESPACE","\n    ",513],"{",["T_WHITESPACE","\n        ",514],["T_RETURN","return",515],["T_WHITESPACE"," ",515],["T_STRING","Mage",515],["T_DOUBLE_COLON","::",515],["T_STRING","getResourceHelper",515],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",515],")",["T_OBJECT_OPERATOR","->",515],["T_STRING","compareIndexColumnProperties",515],"(",["T_VARIABLE","$column",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$describe",515],")",";",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n\n    ",516],["T_DOC_COMMENT","\/**\n     * Retrieve column definition fragment\n     * @deprecated since 1.5.0.0\n     *\n     * Example: `field_name` smallint(5) unsigned NOT NULL default '0'\n     *\n     * @param string $fieldName\n     * @param array $fieldProp\n     * @return string\n     *\/",518],["T_WHITESPACE","\n    ",527],["T_PROTECTED","protected",528],["T_WHITESPACE"," ",528],["T_FUNCTION","function",528],["T_WHITESPACE"," ",528],["T_STRING","_sqlColunmDefinition",528],"(",["T_VARIABLE","$fieldName",528],",",["T_WHITESPACE"," ",528],["T_VARIABLE","$fieldProp",528],")",["T_WHITESPACE","\n    ",528],"{",["T_WHITESPACE","\n        ",529],["T_VARIABLE","$fieldNameQuote",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","_getWriteAdapter",530],"(",")",["T_OBJECT_OPERATOR","->",530],["T_STRING","quoteIdentifier",530],"(",["T_VARIABLE","$fieldName",530],")",";",["T_WHITESPACE","\n\n        ",530],["T_DOC_COMMENT","\/**\n         * Process the case when 'is_null' prohibits null value, and 'default' proposed to be null\n         * It just means that default value not specified\n         *\/",532],["T_WHITESPACE","\n        ",535],["T_IF","if",536],["T_WHITESPACE"," ",536],"(",["T_VARIABLE","$fieldProp",536],"[",["T_CONSTANT_ENCAPSED_STRING","'is_null'",536],"]",["T_WHITESPACE"," ",536],["T_IS_IDENTICAL","===",536],["T_WHITESPACE"," ",536],["T_STRING","false",536],["T_WHITESPACE"," ",536],["T_BOOLEAN_AND","&&",536],["T_WHITESPACE"," ",536],["T_VARIABLE","$fieldProp",536],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",536],"]",["T_WHITESPACE"," ",536],["T_IS_IDENTICAL","===",536],["T_WHITESPACE"," ",536],["T_STRING","null",536],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n            ",536],["T_VARIABLE","$defaultValue",537],["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],["T_CONSTANT_ENCAPSED_STRING","''",537],";",["T_WHITESPACE","\n        ",537],"}",["T_WHITESPACE"," ",538],["T_ELSE","else",538],["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n            ",538],["T_VARIABLE","$defaultValue",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$fieldProp",539],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",539],"]",["T_WHITESPACE"," ",539],["T_IS_IDENTICAL","===",539],["T_WHITESPACE"," ",539],["T_STRING","null",539],["T_WHITESPACE"," ",539],"?",["T_WHITESPACE"," ",539],["T_CONSTANT_ENCAPSED_STRING","' DEFAULT NULL'",539],["T_WHITESPACE"," ",539],":",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_getReadAdapter",539],"(",")",["T_WHITESPACE","\n                ",539],["T_OBJECT_OPERATOR","->",540],["T_STRING","quoteInto",540],"(",["T_CONSTANT_ENCAPSED_STRING","' DEFAULT ?'",540],",",["T_WHITESPACE"," ",540],["T_VARIABLE","$fieldProp",540],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",540],"]",")",";",["T_WHITESPACE","\n        ",540],"}",["T_WHITESPACE","\n\n        ",541],["T_RETURN","return",543],["T_WHITESPACE"," ",543],"\"",["T_CURLY_OPEN","{",543],["T_VARIABLE","$fieldNameQuote",543],"}",["T_ENCAPSED_AND_WHITESPACE"," ",543],["T_CURLY_OPEN","{",543],["T_VARIABLE","$fieldProp",543],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",543],"]","}","\"",["T_WHITESPACE","\n            ",543],".",["T_WHITESPACE"," ",544],"(",["T_VARIABLE","$fieldProp",544],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",544],"]",["T_WHITESPACE"," ",544],"?",["T_WHITESPACE"," ",544],["T_CONSTANT_ENCAPSED_STRING","' UNSIGNED'",544],["T_WHITESPACE"," ",544],":",["T_WHITESPACE"," ",544],["T_CONSTANT_ENCAPSED_STRING","''",544],")",["T_WHITESPACE","\n            ",544],".",["T_WHITESPACE"," ",545],"(",["T_VARIABLE","$fieldProp",545],"[",["T_CONSTANT_ENCAPSED_STRING","'extra'",545],"]",["T_WHITESPACE"," ",545],"?",["T_WHITESPACE"," ",545],["T_CONSTANT_ENCAPSED_STRING","' '",545],["T_WHITESPACE"," ",545],".",["T_WHITESPACE"," ",545],["T_VARIABLE","$fieldProp",545],"[",["T_CONSTANT_ENCAPSED_STRING","'extra'",545],"]",["T_WHITESPACE"," ",545],":",["T_WHITESPACE"," ",545],["T_CONSTANT_ENCAPSED_STRING","''",545],")",["T_WHITESPACE","\n            ",545],".",["T_WHITESPACE"," ",546],"(",["T_VARIABLE","$fieldProp",546],"[",["T_CONSTANT_ENCAPSED_STRING","'is_null'",546],"]",["T_WHITESPACE"," ",546],["T_IS_IDENTICAL","===",546],["T_WHITESPACE"," ",546],["T_STRING","false",546],["T_WHITESPACE"," ",546],"?",["T_WHITESPACE"," ",546],["T_CONSTANT_ENCAPSED_STRING","' NOT NULL'",546],["T_WHITESPACE"," ",546],":",["T_WHITESPACE"," ",546],["T_CONSTANT_ENCAPSED_STRING","''",546],")",["T_WHITESPACE","\n            ",546],".",["T_WHITESPACE"," ",547],["T_VARIABLE","$defaultValue",547],";",["T_WHITESPACE","\n    ",547],"}",["T_WHITESPACE","\n\n    ",548],["T_DOC_COMMENT","\/**\n     * Retrieve index definition fragment\n     * @deprecated since 1.5.0.0\n     *\n     * Example: INDEX `IDX_NAME` (`field_id`)\n     *\n     * @param string $indexName\n     * @param array $indexProp\n     * @return string\n     *\/",550],["T_WHITESPACE","\n    ",559],["T_PROTECTED","protected",560],["T_WHITESPACE"," ",560],["T_FUNCTION","function",560],["T_WHITESPACE"," ",560],["T_STRING","_sqlIndexDefinition",560],"(",["T_VARIABLE","$indexName",560],",",["T_WHITESPACE"," ",560],["T_VARIABLE","$indexProp",560],")",["T_WHITESPACE","\n    ",560],"{",["T_WHITESPACE","\n        ",561],["T_VARIABLE","$fields",562],["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],["T_VARIABLE","$indexProp",562],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",562],"]",";",["T_WHITESPACE","\n        ",562],["T_IF","if",563],["T_WHITESPACE"," ",563],"(",["T_STRING","is_array",563],"(",["T_VARIABLE","$fields",563],")",")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n            ",563],["T_VARIABLE","$fieldSql",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_ARRAY","array",564],"(",")",";",["T_WHITESPACE","\n            ",564],["T_FOREACH","foreach",565],["T_WHITESPACE"," ",565],"(",["T_VARIABLE","$fields",565],["T_WHITESPACE"," ",565],["T_AS","as",565],["T_WHITESPACE"," ",565],["T_VARIABLE","$field",565],")",["T_WHITESPACE"," ",565],"{",["T_WHITESPACE","\n                ",565],["T_VARIABLE","$fieldSql",566],"[","]",["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","_getReadAdapter",566],"(",")",["T_OBJECT_OPERATOR","->",566],["T_STRING","quoteIdentifier",566],"(",["T_VARIABLE","$field",566],")",";",["T_WHITESPACE","\n            ",566],"}",["T_WHITESPACE","\n            ",567],["T_VARIABLE","$fieldSql",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_STRING","join",568],"(",["T_CONSTANT_ENCAPSED_STRING","','",568],",",["T_WHITESPACE"," ",568],["T_VARIABLE","$fieldSql",568],")",";",["T_WHITESPACE","\n        ",568],"}",["T_WHITESPACE","\n        ",569],["T_ELSE","else",570],["T_WHITESPACE"," ",570],"{",["T_WHITESPACE","\n            ",570],["T_VARIABLE","$fieldSql",571],["T_WHITESPACE"," ",571],"=",["T_WHITESPACE"," ",571],["T_VARIABLE","$this",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","_getReadAdapter",571],"(",")",["T_OBJECT_OPERATOR","->",571],["T_STRING","quoteIdentifier",571],"(",["T_VARIABLE","$fields",571],")",";",["T_WHITESPACE","\n        ",571],"}",["T_WHITESPACE","\n\n        ",572],["T_VARIABLE","$indexNameQuote",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_getReadAdapter",574],"(",")",["T_OBJECT_OPERATOR","->",574],["T_STRING","quoteIdentifier",574],"(",["T_VARIABLE","$indexName",574],")",";",["T_WHITESPACE","\n        ",574],["T_SWITCH","switch",575],["T_WHITESPACE"," ",575],"(",["T_STRING","strtolower",575],"(",["T_VARIABLE","$indexProp",575],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",575],"]",")",")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n            ",575],["T_CASE","case",576],["T_WHITESPACE"," ",576],["T_CONSTANT_ENCAPSED_STRING","'primary'",576],":",["T_WHITESPACE","\n                ",576],["T_VARIABLE","$condition",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_CONSTANT_ENCAPSED_STRING","'PRIMARY KEY'",577],";",["T_WHITESPACE","\n                ",577],["T_BREAK","break",578],";",["T_WHITESPACE","\n            ",578],["T_CASE","case",579],["T_WHITESPACE"," ",579],["T_CONSTANT_ENCAPSED_STRING","'unique'",579],":",["T_WHITESPACE","\n                ",579],["T_VARIABLE","$condition",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],["T_CONSTANT_ENCAPSED_STRING","'UNIQUE '",580],["T_WHITESPACE"," ",580],".",["T_WHITESPACE"," ",580],["T_VARIABLE","$indexNameQuote",580],";",["T_WHITESPACE","\n                ",580],["T_BREAK","break",581],";",["T_WHITESPACE","\n            ",581],["T_CASE","case",582],["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'fulltext'",582],":",["T_WHITESPACE","\n                ",582],["T_VARIABLE","$condition",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],["T_CONSTANT_ENCAPSED_STRING","'FULLTEXT '",583],["T_WHITESPACE"," ",583],".",["T_WHITESPACE"," ",583],["T_VARIABLE","$indexNameQuote",583],";",["T_WHITESPACE","\n                ",583],["T_BREAK","break",584],";",["T_WHITESPACE","\n            ",584],["T_DEFAULT","default",585],":",["T_WHITESPACE","\n                ",585],["T_VARIABLE","$condition",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_CONSTANT_ENCAPSED_STRING","'INDEX '",586],["T_WHITESPACE"," ",586],".",["T_WHITESPACE"," ",586],["T_VARIABLE","$indexNameQuote",586],";",["T_WHITESPACE","\n                ",586],["T_BREAK","break",587],";",["T_WHITESPACE","\n        ",587],"}",["T_WHITESPACE","\n\n        ",588],["T_RETURN","return",590],["T_WHITESPACE"," ",590],["T_STRING","sprintf",590],"(",["T_CONSTANT_ENCAPSED_STRING","'%s (%s)'",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$condition",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$fieldSql",590],")",";",["T_WHITESPACE","\n    ",590],"}",["T_WHITESPACE","\n\n    ",591],["T_DOC_COMMENT","\/**\n     * Retrieve UNIQUE HASH for a Table foreign key\n     *\n     * @param string $priTableName  the target table name\n     * @param string $priColumnName the target table column name\n     * @param string $refTableName  the reference table name\n     * @param string $refColumnName the reference table column name\n     * @return string\n     *\/",593],["T_WHITESPACE","\n    ",601],["T_PUBLIC","public",602],["T_WHITESPACE"," ",602],["T_FUNCTION","function",602],["T_WHITESPACE"," ",602],["T_STRING","getFkName",602],"(",["T_VARIABLE","$priTableName",602],",",["T_WHITESPACE"," ",602],["T_VARIABLE","$priColumnName",602],",",["T_WHITESPACE"," ",602],["T_VARIABLE","$refTableName",602],",",["T_WHITESPACE"," ",602],["T_VARIABLE","$refColumnName",602],")",["T_WHITESPACE","\n    ",602],"{",["T_WHITESPACE","\n        ",603],["T_RETURN","return",604],["T_WHITESPACE"," ",604],["T_STRING","Mage",604],["T_DOUBLE_COLON","::",604],["T_STRING","getSingleton",604],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",604],")",["T_WHITESPACE","\n            ",604],["T_OBJECT_OPERATOR","->",605],["T_STRING","getFkName",605],"(",["T_VARIABLE","$priTableName",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$priColumnName",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$refTableName",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$refColumnName",605],")",";",["T_WHITESPACE","\n    ",605],"}",["T_WHITESPACE","\n\n    ",606],["T_DOC_COMMENT","\/**\n     * Prepare flat table for store\n     *\n     * @param int $storeId\n     * @throws Mage_Core_Exception\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",608],["T_WHITESPACE","\n    ",614],["T_PUBLIC","public",615],["T_WHITESPACE"," ",615],["T_FUNCTION","function",615],["T_WHITESPACE"," ",615],["T_STRING","prepareFlatTable",615],"(",["T_VARIABLE","$storeId",615],")",["T_WHITESPACE","\n    ",615],"{",["T_WHITESPACE","\n        ",616],["T_IF","if",617],["T_WHITESPACE"," ",617],"(",["T_ISSET","isset",617],"(",["T_VARIABLE","$this",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","_preparedFlatTables",617],"[",["T_VARIABLE","$storeId",617],"]",")",")",["T_WHITESPACE"," ",617],"{",["T_WHITESPACE","\n            ",617],["T_RETURN","return",618],["T_WHITESPACE"," ",618],["T_VARIABLE","$this",618],";",["T_WHITESPACE","\n        ",618],"}",["T_WHITESPACE","\n        ",619],["T_VARIABLE","$adapter",620],["T_WHITESPACE","   ",620],"=",["T_WHITESPACE"," ",620],["T_VARIABLE","$this",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","_getWriteAdapter",620],"(",")",";",["T_WHITESPACE","\n        ",620],["T_VARIABLE","$tableName",621],["T_WHITESPACE"," ",621],"=",["T_WHITESPACE"," ",621],["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getFlatTableName",621],"(",["T_VARIABLE","$storeId",621],")",";",["T_WHITESPACE","\n\n        ",621],["T_COMMENT","\/\/ Extract columns we need to have in flat table\n",623],["T_WHITESPACE","        ",624],["T_VARIABLE","$columns",624],["T_WHITESPACE"," ",624],"=",["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getFlatColumns",624],"(",")",";",["T_WHITESPACE","\n        ",624],["T_IF","if",625],["T_WHITESPACE"," ",625],"(",["T_STRING","Mage",625],["T_DOUBLE_COLON","::",625],["T_STRING","helper",625],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",625],")",["T_OBJECT_OPERATOR","->",625],["T_STRING","useDbCompatibleMode",625],"(",")",")",["T_WHITESPACE"," ",625],"{",["T_WHITESPACE","\n             ",625],["T_COMMENT","\/* Convert old format of flat columns to new MMDB format that uses DDL types and definitions *\/",626],["T_WHITESPACE","\n            ",626],["T_FOREACH","foreach",627],["T_WHITESPACE"," ",627],"(",["T_VARIABLE","$columns",627],["T_WHITESPACE"," ",627],["T_AS","as",627],["T_WHITESPACE"," ",627],["T_VARIABLE","$key",627],["T_WHITESPACE"," ",627],["T_DOUBLE_ARROW","=>",627],["T_WHITESPACE"," ",627],["T_VARIABLE","$column",627],")",["T_WHITESPACE"," ",627],"{",["T_WHITESPACE","\n                ",627],["T_VARIABLE","$columns",628],"[",["T_VARIABLE","$key",628],"]",["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_STRING","Mage",628],["T_DOUBLE_COLON","::",628],["T_STRING","getResourceHelper",628],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",628],")",["T_OBJECT_OPERATOR","->",628],["T_STRING","convertOldColumnDefinition",628],"(",["T_VARIABLE","$column",628],")",";",["T_WHITESPACE","\n            ",628],"}",["T_WHITESPACE","\n        ",629],"}",["T_WHITESPACE","\n\n        ",630],["T_COMMENT","\/\/ Extract indexes we need to have in flat table\n",632],["T_WHITESPACE","        ",633],["T_VARIABLE","$indexesNeed",633],["T_WHITESPACE","  ",633],"=",["T_WHITESPACE"," ",633],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","getFlatIndexes",633],"(",")",";",["T_WHITESPACE","\n\n        ",633],["T_VARIABLE","$maxIndex",635],["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_STRING","Mage",635],["T_DOUBLE_COLON","::",635],["T_STRING","getConfig",635],"(",")",["T_OBJECT_OPERATOR","->",635],["T_STRING","getNode",635],"(",["T_STRING","self",635],["T_DOUBLE_COLON","::",635],["T_STRING","XML_NODE_MAX_INDEX_COUNT",635],")",";",["T_WHITESPACE","\n        ",635],["T_IF","if",636],["T_WHITESPACE"," ",636],"(",["T_STRING","count",636],"(",["T_VARIABLE","$indexesNeed",636],")",["T_WHITESPACE"," ",636],">",["T_WHITESPACE"," ",636],["T_VARIABLE","$maxIndex",636],")",["T_WHITESPACE"," ",636],"{",["T_WHITESPACE","\n            ",636],["T_STRING","Mage",637],["T_DOUBLE_COLON","::",637],["T_STRING","throwException",637],"(",["T_STRING","Mage",637],["T_DOUBLE_COLON","::",637],["T_STRING","helper",637],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",637],")",["T_OBJECT_OPERATOR","->",637],["T_STRING","__",637],"(",["T_CONSTANT_ENCAPSED_STRING","\"The Flat Catalog module has a limit of %2\\$d filterable and\/or sortable attributes. Currently there are %1\\$d of them. Please reduce the number of filterable\/sortable attributes in order to use this module\"",637],",",["T_WHITESPACE"," ",637],["T_STRING","count",637],"(",["T_VARIABLE","$indexesNeed",637],")",",",["T_WHITESPACE"," ",637],["T_VARIABLE","$maxIndex",637],")",")",";",["T_WHITESPACE","\n        ",637],"}",["T_WHITESPACE","\n\n        ",638],["T_COMMENT","\/\/ Process indexes to create names for them in MMDB-style and reformat to common index definition\n",640],["T_WHITESPACE","        ",641],["T_VARIABLE","$indexKeys",641],["T_WHITESPACE"," ",641],"=",["T_WHITESPACE"," ",641],["T_ARRAY","array",641],"(",")",";",["T_WHITESPACE","\n        ",641],["T_VARIABLE","$indexProps",642],["T_WHITESPACE"," ",642],"=",["T_WHITESPACE"," ",642],["T_STRING","array_values",642],"(",["T_VARIABLE","$indexesNeed",642],")",";",["T_WHITESPACE","\n        ",642],["T_VARIABLE","$upperPrimaryKey",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_STRING","strtoupper",643],"(",["T_STRING","Varien_Db_Adapter_Interface",643],["T_DOUBLE_COLON","::",643],["T_STRING","INDEX_TYPE_PRIMARY",643],")",";",["T_WHITESPACE","\n        ",643],["T_FOREACH","foreach",644],["T_WHITESPACE"," ",644],"(",["T_VARIABLE","$indexProps",644],["T_WHITESPACE"," ",644],["T_AS","as",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$i",644],["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$indexProp",644],")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n            ",644],["T_VARIABLE","$indexName",645],["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_VARIABLE","$adapter",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","getIndexName",645],"(",["T_VARIABLE","$tableName",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$indexProp",645],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",645],"]",",",["T_WHITESPACE"," ",645],["T_VARIABLE","$indexProp",645],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",645],"]",")",";",["T_WHITESPACE","\n            ",645],["T_VARIABLE","$indexProp",646],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",646],"]",["T_WHITESPACE"," ",646],"=",["T_WHITESPACE"," ",646],["T_STRING","strtoupper",646],"(",["T_VARIABLE","$indexProp",646],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",646],"]",")",";",["T_WHITESPACE","\n            ",646],["T_IF","if",647],["T_WHITESPACE"," ",647],"(",["T_VARIABLE","$indexProp",647],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",647],"]",["T_WHITESPACE"," ",647],["T_IS_EQUAL","==",647],["T_WHITESPACE"," ",647],["T_VARIABLE","$upperPrimaryKey",647],")",["T_WHITESPACE"," ",647],"{",["T_WHITESPACE","\n                ",647],["T_VARIABLE","$indexKey",648],["T_WHITESPACE"," ",648],"=",["T_WHITESPACE"," ",648],["T_VARIABLE","$upperPrimaryKey",648],";",["T_WHITESPACE","\n            ",648],"}",["T_WHITESPACE"," ",649],["T_ELSE","else",649],["T_WHITESPACE"," ",649],"{",["T_WHITESPACE","\n                ",649],["T_VARIABLE","$indexKey",650],["T_WHITESPACE"," ",650],"=",["T_WHITESPACE"," ",650],["T_VARIABLE","$indexName",650],";",["T_WHITESPACE","\n            ",650],"}",["T_WHITESPACE","\n\n            ",651],["T_VARIABLE","$indexProps",653],"[",["T_VARIABLE","$i",653],"]",["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_ARRAY","array",653],"(",["T_WHITESPACE","\n                ",653],["T_CONSTANT_ENCAPSED_STRING","'KEY_NAME'",654],["T_WHITESPACE"," ",654],["T_DOUBLE_ARROW","=>",654],["T_WHITESPACE"," ",654],["T_VARIABLE","$indexName",654],",",["T_WHITESPACE","\n                ",654],["T_CONSTANT_ENCAPSED_STRING","'COLUMNS_LIST'",655],["T_WHITESPACE"," ",655],["T_DOUBLE_ARROW","=>",655],["T_WHITESPACE"," ",655],["T_VARIABLE","$indexProp",655],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",655],"]",",",["T_WHITESPACE","\n                ",655],["T_CONSTANT_ENCAPSED_STRING","'INDEX_TYPE'",656],["T_WHITESPACE"," ",656],["T_DOUBLE_ARROW","=>",656],["T_WHITESPACE"," ",656],["T_STRING","strtolower",656],"(",["T_VARIABLE","$indexProp",656],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",656],"]",")",["T_WHITESPACE","\n            ",656],")",";",["T_WHITESPACE","\n            ",657],["T_VARIABLE","$indexKeys",658],"[",["T_VARIABLE","$i",658],"]",["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_VARIABLE","$indexKey",658],";",["T_WHITESPACE","\n        ",658],"}",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$indexesNeed",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_STRING","array_combine",660],"(",["T_VARIABLE","$indexKeys",660],",",["T_WHITESPACE"," ",660],["T_VARIABLE","$indexProps",660],")",";",["T_WHITESPACE"," ",660],["T_COMMENT","\/\/ Array with index names as keys, except for primary\n",660],["T_WHITESPACE","\n        ",661],["T_COMMENT","\/\/ Foreign keys\n",662],["T_WHITESPACE","        ",663],["T_VARIABLE","$foreignEntityKey",663],["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","getFkName",663],"(",["T_VARIABLE","$tableName",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",663],",",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",663],")",";",["T_WHITESPACE","\n        ",663],["T_VARIABLE","$foreignChildKey",664],["T_WHITESPACE","  ",664],"=",["T_WHITESPACE"," ",664],["T_VARIABLE","$this",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","getFkName",664],"(",["T_VARIABLE","$tableName",664],",",["T_WHITESPACE"," ",664],["T_CONSTANT_ENCAPSED_STRING","'child_id'",664],",",["T_WHITESPACE"," ",664],["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",664],",",["T_WHITESPACE"," ",664],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",664],")",";",["T_WHITESPACE","\n\n        ",664],["T_COMMENT","\/\/ Create table or modify existing one\n",666],["T_WHITESPACE","        ",667],["T_IF","if",667],["T_WHITESPACE"," ",667],"(","!",["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","_isFlatTableExists",667],"(",["T_VARIABLE","$storeId",667],")",")",["T_WHITESPACE"," ",667],"{",["T_WHITESPACE","\n            ",667],["T_DOC_COMMENT","\/** @var $table Varien_Db_Ddl_Table *\/",668],["T_WHITESPACE","\n            ",668],["T_VARIABLE","$table",669],["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_VARIABLE","$adapter",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","newTable",669],"(",["T_VARIABLE","$tableName",669],")",";",["T_WHITESPACE","\n            ",669],["T_FOREACH","foreach",670],["T_WHITESPACE"," ",670],"(",["T_VARIABLE","$columns",670],["T_WHITESPACE"," ",670],["T_AS","as",670],["T_WHITESPACE"," ",670],["T_VARIABLE","$fieldName",670],["T_WHITESPACE"," ",670],["T_DOUBLE_ARROW","=>",670],["T_WHITESPACE"," ",670],["T_VARIABLE","$fieldProp",670],")",["T_WHITESPACE"," ",670],"{",["T_WHITESPACE","\n                ",670],["T_VARIABLE","$table",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","addColumn",671],"(",["T_WHITESPACE","\n                    ",671],["T_VARIABLE","$fieldName",672],",",["T_WHITESPACE","\n                    ",672],["T_VARIABLE","$fieldProp",673],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",673],"]",",",["T_WHITESPACE","\n                    ",673],["T_ISSET","isset",674],"(",["T_VARIABLE","$fieldProp",674],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",674],"]",")",["T_WHITESPACE"," ",674],"?",["T_WHITESPACE"," ",674],["T_VARIABLE","$fieldProp",674],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",674],"]",["T_WHITESPACE"," ",674],":",["T_WHITESPACE"," ",674],["T_STRING","null",674],",",["T_WHITESPACE","\n                    ",674],["T_ARRAY","array",675],"(",["T_WHITESPACE","\n                        ",675],["T_CONSTANT_ENCAPSED_STRING","'nullable'",676],["T_WHITESPACE"," ",676],["T_DOUBLE_ARROW","=>",676],["T_WHITESPACE"," ",676],["T_ISSET","isset",676],"(",["T_VARIABLE","$fieldProp",676],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",676],"]",")",["T_WHITESPACE"," ",676],"?",["T_WHITESPACE"," ",676],["T_BOOL_CAST","(bool)",676],["T_VARIABLE","$fieldProp",676],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",676],"]",["T_WHITESPACE"," ",676],":",["T_WHITESPACE"," ",676],["T_STRING","false",676],",",["T_WHITESPACE","\n                        ",676],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",677],["T_WHITESPACE"," ",677],["T_DOUBLE_ARROW","=>",677],["T_WHITESPACE"," ",677],["T_ISSET","isset",677],"(",["T_VARIABLE","$fieldProp",677],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",677],"]",")",["T_WHITESPACE"," ",677],"?",["T_WHITESPACE"," ",677],["T_BOOL_CAST","(bool)",677],["T_VARIABLE","$fieldProp",677],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",677],"]",["T_WHITESPACE"," ",677],":",["T_WHITESPACE"," ",677],["T_STRING","false",677],",",["T_WHITESPACE","\n                        ",677],["T_CONSTANT_ENCAPSED_STRING","'default'",678],["T_WHITESPACE","  ",678],["T_DOUBLE_ARROW","=>",678],["T_WHITESPACE"," ",678],["T_ISSET","isset",678],"(",["T_VARIABLE","$fieldProp",678],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",678],"]",")",["T_WHITESPACE"," ",678],"?",["T_WHITESPACE"," ",678],["T_VARIABLE","$fieldProp",678],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",678],"]",["T_WHITESPACE"," ",678],":",["T_WHITESPACE"," ",678],["T_STRING","false",678],",",["T_WHITESPACE","\n                        ",678],["T_CONSTANT_ENCAPSED_STRING","'primary'",679],["T_WHITESPACE","  ",679],["T_DOUBLE_ARROW","=>",679],["T_WHITESPACE"," ",679],["T_STRING","false",679],",",["T_WHITESPACE","\n                    ",679],")",",",["T_WHITESPACE","\n                    ",680],["T_ISSET","isset",681],"(",["T_VARIABLE","$fieldProp",681],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",681],"]",")",["T_WHITESPACE"," ",681],"?",["T_WHITESPACE"," ",681],["T_VARIABLE","$fieldProp",681],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",681],"]",["T_WHITESPACE"," ",681],":",["T_WHITESPACE"," ",681],["T_VARIABLE","$fieldName",681],["T_WHITESPACE","\n                ",681],")",";",["T_WHITESPACE","\n            ",682],"}",["T_WHITESPACE","\n\n            ",683],["T_FOREACH","foreach",685],["T_WHITESPACE"," ",685],"(",["T_VARIABLE","$indexesNeed",685],["T_WHITESPACE"," ",685],["T_AS","as",685],["T_WHITESPACE"," ",685],["T_VARIABLE","$indexProp",685],")",["T_WHITESPACE"," ",685],"{",["T_WHITESPACE","\n                ",685],["T_VARIABLE","$table",686],["T_OBJECT_OPERATOR","->",686],["T_STRING","addIndex",686],"(",["T_VARIABLE","$indexProp",686],"[",["T_CONSTANT_ENCAPSED_STRING","'KEY_NAME'",686],"]",",",["T_WHITESPACE"," ",686],["T_VARIABLE","$indexProp",686],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMNS_LIST'",686],"]",",",["T_WHITESPACE","\n                    ",686],["T_ARRAY","array",687],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",687],["T_WHITESPACE"," ",687],["T_DOUBLE_ARROW","=>",687],["T_WHITESPACE"," ",687],["T_VARIABLE","$indexProp",687],"[",["T_CONSTANT_ENCAPSED_STRING","'INDEX_TYPE'",687],"]",")",")",";",["T_WHITESPACE","\n            ",687],"}",["T_WHITESPACE","\n\n            ",688],["T_VARIABLE","$table",690],["T_OBJECT_OPERATOR","->",690],["T_STRING","addForeignKey",690],"(",["T_VARIABLE","$foreignEntityKey",690],",",["T_WHITESPACE","\n                ",690],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",691],",",["T_WHITESPACE"," ",691],["T_VARIABLE","$this",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","getTable",691],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",691],")",",",["T_WHITESPACE"," ",691],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",691],",",["T_WHITESPACE","\n                ",691],["T_STRING","Varien_Db_Ddl_Table",692],["T_DOUBLE_COLON","::",692],["T_STRING","ACTION_CASCADE",692],",",["T_WHITESPACE"," ",692],["T_STRING","Varien_Db_Ddl_Table",692],["T_DOUBLE_COLON","::",692],["T_STRING","ACTION_CASCADE",692],")",";",["T_WHITESPACE","\n\n            ",692],["T_IF","if",694],["T_WHITESPACE"," ",694],"(",["T_VARIABLE","$this",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","getFlatHelper",694],"(",")",["T_OBJECT_OPERATOR","->",694],["T_STRING","isAddChildData",694],"(",")",")",["T_WHITESPACE"," ",694],"{",["T_WHITESPACE","\n                ",694],["T_VARIABLE","$table",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","addForeignKey",695],"(",["T_VARIABLE","$foreignChildKey",695],",",["T_WHITESPACE","\n                    ",695],["T_CONSTANT_ENCAPSED_STRING","'child_id'",696],",",["T_WHITESPACE"," ",696],["T_VARIABLE","$this",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","getTable",696],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",696],")",",",["T_WHITESPACE"," ",696],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",696],",",["T_WHITESPACE","\n                    ",696],["T_STRING","Varien_Db_Ddl_Table",697],["T_DOUBLE_COLON","::",697],["T_STRING","ACTION_CASCADE",697],",",["T_WHITESPACE"," ",697],["T_STRING","Varien_Db_Ddl_Table",697],["T_DOUBLE_COLON","::",697],["T_STRING","ACTION_CASCADE",697],")",";",["T_WHITESPACE","\n            ",697],"}",["T_WHITESPACE","\n            ",698],["T_VARIABLE","$table",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","setComment",699],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Catalog Product Flat (Store ",699],["T_CURLY_OPEN","{",699],["T_VARIABLE","$storeId",699],"}",["T_ENCAPSED_AND_WHITESPACE",")",699],"\"",")",";",["T_WHITESPACE","\n\n            ",699],["T_VARIABLE","$adapter",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","createTable",701],"(",["T_VARIABLE","$table",701],")",";",["T_WHITESPACE","\n\n            ",701],["T_VARIABLE","$this",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","_existsFlatTables",703],"[",["T_VARIABLE","$storeId",703],"]",["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_STRING","true",703],";",["T_WHITESPACE","\n        ",703],"}",["T_WHITESPACE"," ",704],["T_ELSE","else",704],["T_WHITESPACE"," ",704],"{",["T_WHITESPACE","\n            ",704],["T_VARIABLE","$adapter",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","resetDdlCache",705],"(",["T_VARIABLE","$tableName",705],")",";",["T_WHITESPACE","\n\n            ",705],["T_COMMENT","\/\/ Sort columns into added\/altered\/dropped lists\n",707],["T_WHITESPACE","            ",708],["T_VARIABLE","$describe",708],["T_WHITESPACE","   ",708],"=",["T_WHITESPACE"," ",708],["T_VARIABLE","$adapter",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","describeTable",708],"(",["T_VARIABLE","$tableName",708],")",";",["T_WHITESPACE","\n            ",708],["T_VARIABLE","$addColumns",709],["T_WHITESPACE","     ",709],"=",["T_WHITESPACE"," ",709],["T_STRING","array_diff_key",709],"(",["T_VARIABLE","$columns",709],",",["T_WHITESPACE"," ",709],["T_VARIABLE","$describe",709],")",";",["T_WHITESPACE","\n            ",709],["T_VARIABLE","$dropColumns",710],["T_WHITESPACE","    ",710],"=",["T_WHITESPACE"," ",710],["T_STRING","array_diff_key",710],"(",["T_VARIABLE","$describe",710],",",["T_WHITESPACE"," ",710],["T_VARIABLE","$columns",710],")",";",["T_WHITESPACE","\n            ",710],["T_VARIABLE","$modifyColumns",711],["T_WHITESPACE","  ",711],"=",["T_WHITESPACE"," ",711],["T_ARRAY","array",711],"(",")",";",["T_WHITESPACE","\n            ",711],["T_FOREACH","foreach",712],["T_WHITESPACE"," ",712],"(",["T_VARIABLE","$columns",712],["T_WHITESPACE"," ",712],["T_AS","as",712],["T_WHITESPACE"," ",712],["T_VARIABLE","$field",712],["T_WHITESPACE"," ",712],["T_DOUBLE_ARROW","=>",712],["T_WHITESPACE"," ",712],["T_VARIABLE","$fieldProp",712],")",["T_WHITESPACE"," ",712],"{",["T_WHITESPACE","\n                ",712],["T_IF","if",713],["T_WHITESPACE"," ",713],"(",["T_ISSET","isset",713],"(",["T_VARIABLE","$describe",713],"[",["T_VARIABLE","$field",713],"]",")",["T_WHITESPACE"," ",713],["T_BOOLEAN_AND","&&",713],["T_WHITESPACE"," ",713],"!",["T_VARIABLE","$this",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","_compareColumnProperties",713],"(",["T_VARIABLE","$fieldProp",713],",",["T_WHITESPACE"," ",713],["T_VARIABLE","$describe",713],"[",["T_VARIABLE","$field",713],"]",")",")",["T_WHITESPACE"," ",713],"{",["T_WHITESPACE","\n                    ",713],["T_VARIABLE","$modifyColumns",714],"[",["T_VARIABLE","$field",714],"]",["T_WHITESPACE"," ",714],"=",["T_WHITESPACE"," ",714],["T_VARIABLE","$fieldProp",714],";",["T_WHITESPACE","\n                ",714],"}",["T_WHITESPACE","\n            ",715],"}",["T_WHITESPACE","\n\n            ",716],["T_COMMENT","\/\/ Sort indexes into added\/dropped lists. Altered indexes are put into both lists.\n",718],["T_WHITESPACE","            ",719],["T_VARIABLE","$addIndexes",719],["T_WHITESPACE"," ",719],"=",["T_WHITESPACE"," ",719],["T_ARRAY","array",719],"(",")",";",["T_WHITESPACE","\n            ",719],["T_VARIABLE","$dropIndexes",720],["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_ARRAY","array",720],"(",")",";",["T_WHITESPACE","\n            ",720],["T_VARIABLE","$indexesNow",721],["T_WHITESPACE","  ",721],"=",["T_WHITESPACE"," ",721],["T_VARIABLE","$adapter",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","getIndexList",721],"(",["T_VARIABLE","$tableName",721],")",";",["T_WHITESPACE"," ",721],["T_COMMENT","\/\/ Note: primary is always stored under 'PRIMARY' key\n",721],["T_WHITESPACE","            ",722],["T_VARIABLE","$newIndexes",722],["T_WHITESPACE"," ",722],"=",["T_WHITESPACE"," ",722],["T_VARIABLE","$indexesNeed",722],";",["T_WHITESPACE","\n            ",722],["T_FOREACH","foreach",723],["T_WHITESPACE"," ",723],"(",["T_VARIABLE","$indexesNow",723],["T_WHITESPACE"," ",723],["T_AS","as",723],["T_WHITESPACE"," ",723],["T_VARIABLE","$key",723],["T_WHITESPACE"," ",723],["T_DOUBLE_ARROW","=>",723],["T_WHITESPACE"," ",723],["T_VARIABLE","$indexNow",723],")",["T_WHITESPACE"," ",723],"{",["T_WHITESPACE","\n                ",723],["T_IF","if",724],["T_WHITESPACE"," ",724],"(",["T_ISSET","isset",724],"(",["T_VARIABLE","$indexesNeed",724],"[",["T_VARIABLE","$key",724],"]",")",")",["T_WHITESPACE"," ",724],"{",["T_WHITESPACE","\n                    ",724],["T_VARIABLE","$indexNeed",725],["T_WHITESPACE"," ",725],"=",["T_WHITESPACE"," ",725],["T_VARIABLE","$indexesNeed",725],"[",["T_VARIABLE","$key",725],"]",";",["T_WHITESPACE","\n                    ",725],["T_IF","if",726],["T_WHITESPACE"," ",726],"(","(",["T_VARIABLE","$indexNeed",726],"[",["T_CONSTANT_ENCAPSED_STRING","'INDEX_TYPE'",726],"]",["T_WHITESPACE"," ",726],["T_IS_NOT_EQUAL","!=",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$indexNow",726],"[",["T_CONSTANT_ENCAPSED_STRING","'INDEX_TYPE'",726],"]",")",["T_WHITESPACE","\n                        ",726],["T_BOOLEAN_OR","||",727],["T_WHITESPACE"," ",727],"(",["T_VARIABLE","$indexNeed",727],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMNS_LIST'",727],"]",["T_WHITESPACE"," ",727],["T_IS_NOT_EQUAL","!=",727],["T_WHITESPACE"," ",727],["T_VARIABLE","$indexNow",727],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMNS_LIST'",727],"]",")",")",["T_WHITESPACE"," ",727],"{",["T_WHITESPACE","\n                        ",727],["T_VARIABLE","$dropIndexes",728],"[",["T_VARIABLE","$key",728],"]",["T_WHITESPACE"," ",728],"=",["T_WHITESPACE"," ",728],["T_VARIABLE","$indexNow",728],";",["T_WHITESPACE","\n                        ",728],["T_VARIABLE","$addIndexes",729],"[",["T_VARIABLE","$key",729],"]",["T_WHITESPACE"," ",729],"=",["T_WHITESPACE"," ",729],["T_VARIABLE","$indexNeed",729],";",["T_WHITESPACE","\n                    ",729],"}",["T_WHITESPACE","\n                    ",730],["T_UNSET","unset",731],"(",["T_VARIABLE","$newIndexes",731],"[",["T_VARIABLE","$key",731],"]",")",";",["T_WHITESPACE","\n                ",731],"}",["T_WHITESPACE"," ",732],["T_ELSE","else",732],["T_WHITESPACE"," ",732],"{",["T_WHITESPACE","\n                    ",732],["T_VARIABLE","$dropIndexes",733],"[",["T_VARIABLE","$key",733],"]",["T_WHITESPACE"," ",733],"=",["T_WHITESPACE"," ",733],["T_VARIABLE","$indexNow",733],";",["T_WHITESPACE","\n                ",733],"}",["T_WHITESPACE","\n            ",734],"}",["T_WHITESPACE","\n            ",735],["T_VARIABLE","$addIndexes",736],["T_WHITESPACE"," ",736],"=",["T_WHITESPACE"," ",736],["T_VARIABLE","$addIndexes",736],["T_WHITESPACE"," ",736],"+",["T_WHITESPACE"," ",736],["T_VARIABLE","$newIndexes",736],";",["T_WHITESPACE","\n\n            ",736],["T_COMMENT","\/\/ Compose contstraints\n",738],["T_WHITESPACE","            ",739],["T_VARIABLE","$addConstraints",739],["T_WHITESPACE"," ",739],"=",["T_WHITESPACE"," ",739],["T_ARRAY","array",739],"(",")",";",["T_WHITESPACE","\n            ",739],["T_VARIABLE","$addConstraints",740],"[",["T_VARIABLE","$foreignEntityKey",740],"]",["T_WHITESPACE"," ",740],"=",["T_WHITESPACE"," ",740],["T_ARRAY","array",740],"(",["T_WHITESPACE","\n                ",740],["T_CONSTANT_ENCAPSED_STRING","'table_index'",741],["T_WHITESPACE","   ",741],["T_DOUBLE_ARROW","=>",741],["T_WHITESPACE"," ",741],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",741],",",["T_WHITESPACE","\n                ",741],["T_CONSTANT_ENCAPSED_STRING","'ref_table'",742],["T_WHITESPACE","     ",742],["T_DOUBLE_ARROW","=>",742],["T_WHITESPACE"," ",742],["T_VARIABLE","$this",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","getTable",742],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",742],")",",",["T_WHITESPACE","\n                ",742],["T_CONSTANT_ENCAPSED_STRING","'ref_index'",743],["T_WHITESPACE","     ",743],["T_DOUBLE_ARROW","=>",743],["T_WHITESPACE"," ",743],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",743],",",["T_WHITESPACE","\n                ",743],["T_CONSTANT_ENCAPSED_STRING","'on_update'",744],["T_WHITESPACE","     ",744],["T_DOUBLE_ARROW","=>",744],["T_WHITESPACE"," ",744],["T_STRING","Varien_Db_Ddl_Table",744],["T_DOUBLE_COLON","::",744],["T_STRING","ACTION_CASCADE",744],",",["T_WHITESPACE","\n                ",744],["T_CONSTANT_ENCAPSED_STRING","'on_delete'",745],["T_WHITESPACE","     ",745],["T_DOUBLE_ARROW","=>",745],["T_WHITESPACE"," ",745],["T_STRING","Varien_Db_Ddl_Table",745],["T_DOUBLE_COLON","::",745],["T_STRING","ACTION_CASCADE",745],["T_WHITESPACE","\n            ",745],")",";",["T_WHITESPACE","\n\n            ",746],["T_COMMENT","\/\/ Additional data from childs\n",748],["T_WHITESPACE","            ",749],["T_VARIABLE","$isAddChildData",749],["T_WHITESPACE"," ",749],"=",["T_WHITESPACE"," ",749],["T_VARIABLE","$this",749],["T_OBJECT_OPERATOR","->",749],["T_STRING","getFlatHelper",749],"(",")",["T_OBJECT_OPERATOR","->",749],["T_STRING","isAddChildData",749],"(",")",";",["T_WHITESPACE","\n            ",749],["T_IF","if",750],["T_WHITESPACE"," ",750],"(","!",["T_VARIABLE","$isAddChildData",750],["T_WHITESPACE"," ",750],["T_BOOLEAN_AND","&&",750],["T_WHITESPACE"," ",750],["T_ISSET","isset",750],"(",["T_VARIABLE","$describe",750],"[",["T_CONSTANT_ENCAPSED_STRING","'is_child'",750],"]",")",")",["T_WHITESPACE"," ",750],"{",["T_WHITESPACE","\n                ",750],["T_VARIABLE","$adapter",751],["T_OBJECT_OPERATOR","->",751],["T_STRING","delete",751],"(",["T_VARIABLE","$tableName",751],",",["T_WHITESPACE"," ",751],["T_ARRAY","array",751],"(",["T_CONSTANT_ENCAPSED_STRING","'is_child = ?'",751],["T_WHITESPACE"," ",751],["T_DOUBLE_ARROW","=>",751],["T_WHITESPACE"," ",751],["T_LNUMBER","1",751],")",")",";",["T_WHITESPACE","\n                ",751],["T_VARIABLE","$adapter",752],["T_OBJECT_OPERATOR","->",752],["T_STRING","dropForeignKey",752],"(",["T_VARIABLE","$tableName",752],",",["T_WHITESPACE"," ",752],["T_VARIABLE","$foreignChildKey",752],")",";",["T_WHITESPACE","\n            ",752],"}",["T_WHITESPACE","\n            ",753],["T_IF","if",754],["T_WHITESPACE"," ",754],"(",["T_VARIABLE","$isAddChildData",754],["T_WHITESPACE"," ",754],["T_BOOLEAN_AND","&&",754],["T_WHITESPACE"," ",754],"!",["T_ISSET","isset",754],"(",["T_VARIABLE","$describe",754],"[",["T_CONSTANT_ENCAPSED_STRING","'is_child'",754],"]",")",")",["T_WHITESPACE"," ",754],"{",["T_WHITESPACE","\n                ",754],["T_VARIABLE","$adapter",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","delete",755],"(",["T_VARIABLE","$tableName",755],")",";",["T_WHITESPACE","\n                ",755],["T_VARIABLE","$dropIndexes",756],"[",["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",756],"]",["T_WHITESPACE"," ",756],"=",["T_WHITESPACE"," ",756],["T_VARIABLE","$indexesNow",756],"[",["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",756],"]",";",["T_WHITESPACE","\n                ",756],["T_VARIABLE","$addIndexes",757],"[",["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",757],"]",["T_WHITESPACE","  ",757],"=",["T_WHITESPACE"," ",757],["T_VARIABLE","$indexesNeed",757],"[",["T_CONSTANT_ENCAPSED_STRING","'PRIMARY'",757],"]",";",["T_WHITESPACE","\n\n                ",757],["T_VARIABLE","$addConstraints",759],"[",["T_VARIABLE","$foreignChildKey",759],"]",["T_WHITESPACE"," ",759],"=",["T_WHITESPACE"," ",759],["T_ARRAY","array",759],"(",["T_WHITESPACE","\n                    ",759],["T_CONSTANT_ENCAPSED_STRING","'table_index'",760],["T_WHITESPACE","   ",760],["T_DOUBLE_ARROW","=>",760],["T_WHITESPACE"," ",760],["T_CONSTANT_ENCAPSED_STRING","'child_id'",760],",",["T_WHITESPACE","\n                    ",760],["T_CONSTANT_ENCAPSED_STRING","'ref_table'",761],["T_WHITESPACE","     ",761],["T_DOUBLE_ARROW","=>",761],["T_WHITESPACE"," ",761],["T_VARIABLE","$this",761],["T_OBJECT_OPERATOR","->",761],["T_STRING","getTable",761],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",761],")",",",["T_WHITESPACE","\n                    ",761],["T_CONSTANT_ENCAPSED_STRING","'ref_index'",762],["T_WHITESPACE","     ",762],["T_DOUBLE_ARROW","=>",762],["T_WHITESPACE"," ",762],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",762],",",["T_WHITESPACE","\n                    ",762],["T_CONSTANT_ENCAPSED_STRING","'on_update'",763],["T_WHITESPACE","     ",763],["T_DOUBLE_ARROW","=>",763],["T_WHITESPACE"," ",763],["T_STRING","Varien_Db_Ddl_Table",763],["T_DOUBLE_COLON","::",763],["T_STRING","ACTION_CASCADE",763],",",["T_WHITESPACE","\n                    ",763],["T_CONSTANT_ENCAPSED_STRING","'on_delete'",764],["T_WHITESPACE","     ",764],["T_DOUBLE_ARROW","=>",764],["T_WHITESPACE"," ",764],["T_STRING","Varien_Db_Ddl_Table",764],["T_DOUBLE_COLON","::",764],["T_STRING","ACTION_CASCADE",764],["T_WHITESPACE","\n                ",764],")",";",["T_WHITESPACE","\n            ",765],"}",["T_WHITESPACE","\n\n            ",766],["T_COMMENT","\/\/ Drop constraints\n",768],["T_WHITESPACE","            ",769],["T_FOREACH","foreach",769],["T_WHITESPACE"," ",769],"(",["T_STRING","array_keys",769],"(",["T_VARIABLE","$adapter",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","getForeignKeys",769],"(",["T_VARIABLE","$tableName",769],")",")",["T_WHITESPACE"," ",769],["T_AS","as",769],["T_WHITESPACE"," ",769],["T_VARIABLE","$constraintName",769],")",["T_WHITESPACE"," ",769],"{",["T_WHITESPACE","\n                ",769],["T_VARIABLE","$adapter",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","dropForeignKey",770],"(",["T_VARIABLE","$tableName",770],",",["T_WHITESPACE"," ",770],["T_VARIABLE","$constraintName",770],")",";",["T_WHITESPACE","\n            ",770],"}",["T_WHITESPACE","\n\n            ",771],["T_COMMENT","\/\/ Drop indexes\n",773],["T_WHITESPACE","            ",774],["T_FOREACH","foreach",774],["T_WHITESPACE"," ",774],"(",["T_VARIABLE","$dropIndexes",774],["T_WHITESPACE"," ",774],["T_AS","as",774],["T_WHITESPACE"," ",774],["T_VARIABLE","$indexProp",774],")",["T_WHITESPACE"," ",774],"{",["T_WHITESPACE","\n                ",774],["T_VARIABLE","$adapter",775],["T_OBJECT_OPERATOR","->",775],["T_STRING","dropIndex",775],"(",["T_VARIABLE","$tableName",775],",",["T_WHITESPACE"," ",775],["T_VARIABLE","$indexProp",775],"[",["T_CONSTANT_ENCAPSED_STRING","'KEY_NAME'",775],"]",")",";",["T_WHITESPACE","\n            ",775],"}",["T_WHITESPACE","\n\n            ",776],["T_COMMENT","\/\/ Drop columns\n",778],["T_WHITESPACE","            ",779],["T_FOREACH","foreach",779],["T_WHITESPACE"," ",779],"(",["T_STRING","array_keys",779],"(",["T_VARIABLE","$dropColumns",779],")",["T_WHITESPACE"," ",779],["T_AS","as",779],["T_WHITESPACE"," ",779],["T_VARIABLE","$columnName",779],")",["T_WHITESPACE"," ",779],"{",["T_WHITESPACE","\n                ",779],["T_VARIABLE","$adapter",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","dropColumn",780],"(",["T_VARIABLE","$tableName",780],",",["T_WHITESPACE"," ",780],["T_VARIABLE","$columnName",780],")",";",["T_WHITESPACE","\n            ",780],"}",["T_WHITESPACE","\n\n            ",781],["T_COMMENT","\/\/ Modify columns\n",783],["T_WHITESPACE","            ",784],["T_FOREACH","foreach",784],["T_WHITESPACE"," ",784],"(",["T_VARIABLE","$modifyColumns",784],["T_WHITESPACE"," ",784],["T_AS","as",784],["T_WHITESPACE"," ",784],["T_VARIABLE","$columnName",784],["T_WHITESPACE"," ",784],["T_DOUBLE_ARROW","=>",784],["T_WHITESPACE"," ",784],["T_VARIABLE","$columnProp",784],")",["T_WHITESPACE"," ",784],"{",["T_WHITESPACE","\n                ",784],["T_VARIABLE","$columnProp",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_STRING","array_change_key_case",785],"(",["T_VARIABLE","$columnProp",785],",",["T_WHITESPACE"," ",785],["T_STRING","CASE_UPPER",785],")",";",["T_WHITESPACE","\n                ",785],["T_IF","if",786],["T_WHITESPACE"," ",786],"(","!",["T_ISSET","isset",786],"(",["T_VARIABLE","$columnProp",786],"[",["T_CONSTANT_ENCAPSED_STRING","'COMMENT'",786],"]",")",")",["T_WHITESPACE"," ",786],"{",["T_WHITESPACE","\n                    ",786],["T_VARIABLE","$columnProp",787],"[",["T_CONSTANT_ENCAPSED_STRING","'COMMENT'",787],"]",["T_WHITESPACE"," ",787],"=",["T_WHITESPACE"," ",787],["T_STRING","ucwords",787],"(",["T_STRING","str_replace",787],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",787],",",["T_WHITESPACE"," ",787],["T_CONSTANT_ENCAPSED_STRING","' '",787],",",["T_WHITESPACE"," ",787],["T_VARIABLE","$columnName",787],")",")",";",["T_WHITESPACE","\n                ",787],"}",["T_WHITESPACE","\n                ",788],["T_VARIABLE","$adapter",789],["T_OBJECT_OPERATOR","->",789],["T_STRING","changeColumn",789],"(",["T_VARIABLE","$tableName",789],",",["T_WHITESPACE"," ",789],["T_VARIABLE","$columnName",789],",",["T_WHITESPACE"," ",789],["T_VARIABLE","$columnName",789],",",["T_WHITESPACE"," ",789],["T_VARIABLE","$columnProp",789],")",";",["T_WHITESPACE","\n            ",789],"}",["T_WHITESPACE","\n\n            ",790],["T_COMMENT","\/\/ Add columns\n",792],["T_WHITESPACE","            ",793],["T_FOREACH","foreach",793],["T_WHITESPACE"," ",793],"(",["T_VARIABLE","$addColumns",793],["T_WHITESPACE"," ",793],["T_AS","as",793],["T_WHITESPACE"," ",793],["T_VARIABLE","$columnName",793],["T_WHITESPACE"," ",793],["T_DOUBLE_ARROW","=>",793],["T_WHITESPACE"," ",793],["T_VARIABLE","$columnProp",793],")",["T_WHITESPACE"," ",793],"{",["T_WHITESPACE","\n                ",793],["T_VARIABLE","$columnProp",794],["T_WHITESPACE"," ",794],"=",["T_WHITESPACE"," ",794],["T_STRING","array_change_key_case",794],"(",["T_VARIABLE","$columnProp",794],",",["T_WHITESPACE"," ",794],["T_STRING","CASE_UPPER",794],")",";",["T_WHITESPACE","\n                ",794],["T_IF","if",795],["T_WHITESPACE"," ",795],"(","!",["T_ISSET","isset",795],"(",["T_VARIABLE","$columnProp",795],"[",["T_CONSTANT_ENCAPSED_STRING","'COMMENT'",795],"]",")",")",["T_WHITESPACE"," ",795],"{",["T_WHITESPACE","\n                    ",795],["T_VARIABLE","$columnProp",796],"[",["T_CONSTANT_ENCAPSED_STRING","'COMMENT'",796],"]",["T_WHITESPACE"," ",796],"=",["T_WHITESPACE"," ",796],["T_STRING","ucwords",796],"(",["T_STRING","str_replace",796],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",796],",",["T_WHITESPACE"," ",796],["T_CONSTANT_ENCAPSED_STRING","' '",796],",",["T_WHITESPACE"," ",796],["T_VARIABLE","$columnName",796],")",")",";",["T_WHITESPACE","\n                ",796],"}",["T_WHITESPACE","\n                ",797],["T_VARIABLE","$adapter",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","addColumn",798],"(",["T_VARIABLE","$tableName",798],",",["T_WHITESPACE"," ",798],["T_VARIABLE","$columnName",798],",",["T_WHITESPACE"," ",798],["T_VARIABLE","$columnProp",798],")",";",["T_WHITESPACE","\n            ",798],"}",["T_WHITESPACE","\n\n            ",799],["T_COMMENT","\/\/ Add indexes\n",801],["T_WHITESPACE","            ",802],["T_FOREACH","foreach",802],["T_WHITESPACE"," ",802],"(",["T_VARIABLE","$addIndexes",802],["T_WHITESPACE"," ",802],["T_AS","as",802],["T_WHITESPACE"," ",802],["T_VARIABLE","$indexProp",802],")",["T_WHITESPACE"," ",802],"{",["T_WHITESPACE","\n                ",802],["T_VARIABLE","$adapter",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","addIndex",803],"(",["T_VARIABLE","$tableName",803],",",["T_WHITESPACE"," ",803],["T_VARIABLE","$indexProp",803],"[",["T_CONSTANT_ENCAPSED_STRING","'KEY_NAME'",803],"]",",",["T_WHITESPACE"," ",803],["T_VARIABLE","$indexProp",803],"[",["T_CONSTANT_ENCAPSED_STRING","'COLUMNS_LIST'",803],"]",",",["T_WHITESPACE","\n                    ",803],["T_VARIABLE","$indexProp",804],"[",["T_CONSTANT_ENCAPSED_STRING","'INDEX_TYPE'",804],"]",")",";",["T_WHITESPACE","\n            ",804],"}",["T_WHITESPACE","\n\n            ",805],["T_COMMENT","\/\/ Add constraints\n",807],["T_WHITESPACE","            ",808],["T_FOREACH","foreach",808],["T_WHITESPACE"," ",808],"(",["T_VARIABLE","$addConstraints",808],["T_WHITESPACE"," ",808],["T_AS","as",808],["T_WHITESPACE"," ",808],["T_VARIABLE","$constraintName",808],["T_WHITESPACE"," ",808],["T_DOUBLE_ARROW","=>",808],["T_WHITESPACE"," ",808],["T_VARIABLE","$constraintProp",808],")",["T_WHITESPACE"," ",808],"{",["T_WHITESPACE","\n                ",808],["T_VARIABLE","$adapter",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","addForeignKey",809],"(",["T_VARIABLE","$constraintName",809],",",["T_WHITESPACE"," ",809],["T_VARIABLE","$tableName",809],",",["T_WHITESPACE","\n                    ",809],["T_VARIABLE","$constraintProp",810],"[",["T_CONSTANT_ENCAPSED_STRING","'table_index'",810],"]",",",["T_WHITESPACE","\n                    ",810],["T_VARIABLE","$constraintProp",811],"[",["T_CONSTANT_ENCAPSED_STRING","'ref_table'",811],"]",",",["T_WHITESPACE","\n                    ",811],["T_VARIABLE","$constraintProp",812],"[",["T_CONSTANT_ENCAPSED_STRING","'ref_index'",812],"]",",",["T_WHITESPACE","\n                    ",812],["T_VARIABLE","$constraintProp",813],"[",["T_CONSTANT_ENCAPSED_STRING","'on_delete'",813],"]",",",["T_WHITESPACE","\n                    ",813],["T_VARIABLE","$constraintProp",814],"[",["T_CONSTANT_ENCAPSED_STRING","'on_update'",814],"]",["T_WHITESPACE","\n                ",814],")",";",["T_WHITESPACE","\n            ",815],"}",["T_WHITESPACE","\n        ",816],"}",["T_WHITESPACE","\n\n        ",817],["T_VARIABLE","$this",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","_preparedFlatTables",819],"[",["T_VARIABLE","$storeId",819],"]",["T_WHITESPACE"," ",819],"=",["T_WHITESPACE"," ",819],["T_STRING","true",819],";",["T_WHITESPACE","\n\n        ",819],["T_RETURN","return",821],["T_WHITESPACE"," ",821],["T_VARIABLE","$this",821],";",["T_WHITESPACE","\n    ",821],"}",["T_WHITESPACE","\n\n    ",822],["T_DOC_COMMENT","\/**\n     * Add or Update static attributes\n     *\n     * @param int $storeId\n     * @param int|array $productIds update only product(s)\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",824],["T_WHITESPACE","\n    ",830],["T_PUBLIC","public",831],["T_WHITESPACE"," ",831],["T_FUNCTION","function",831],["T_WHITESPACE"," ",831],["T_STRING","updateStaticAttributes",831],"(",["T_VARIABLE","$storeId",831],",",["T_WHITESPACE"," ",831],["T_VARIABLE","$productIds",831],["T_WHITESPACE"," ",831],"=",["T_WHITESPACE"," ",831],["T_STRING","null",831],")",["T_WHITESPACE","\n    ",831],"{",["T_WHITESPACE","\n        ",832],["T_IF","if",833],["T_WHITESPACE"," ",833],"(","!",["T_VARIABLE","$this",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","_isFlatTableExists",833],"(",["T_VARIABLE","$storeId",833],")",")",["T_WHITESPACE"," ",833],"{",["T_WHITESPACE","\n            ",833],["T_RETURN","return",834],["T_WHITESPACE"," ",834],["T_VARIABLE","$this",834],";",["T_WHITESPACE","\n        ",834],"}",["T_WHITESPACE","\n        ",835],["T_VARIABLE","$adapter",836],["T_WHITESPACE","   ",836],"=",["T_WHITESPACE"," ",836],["T_VARIABLE","$this",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","_getWriteAdapter",836],"(",")",";",["T_WHITESPACE","\n        ",836],["T_VARIABLE","$websiteId",837],["T_WHITESPACE"," ",837],"=",["T_WHITESPACE"," ",837],["T_INT_CAST","(int)",837],["T_STRING","Mage",837],["T_DOUBLE_COLON","::",837],["T_STRING","app",837],"(",")",["T_OBJECT_OPERATOR","->",837],["T_STRING","getStore",837],"(",["T_VARIABLE","$storeId",837],")",["T_OBJECT_OPERATOR","->",837],["T_STRING","getWebsite",837],"(",")",["T_OBJECT_OPERATOR","->",837],["T_STRING","getId",837],"(",")",";",["T_WHITESPACE","\n        ",837],["T_COMMENT","\/* @var $status Mage_Eav_Model_Entity_Attribute *\/",838],["T_WHITESPACE","\n        ",838],["T_VARIABLE","$status",839],["T_WHITESPACE","    ",839],"=",["T_WHITESPACE"," ",839],["T_VARIABLE","$this",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","getAttribute",839],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",839],")",";",["T_WHITESPACE","\n\n        ",839],["T_VARIABLE","$fieldList",841],["T_WHITESPACE","  ",841],"=",["T_WHITESPACE"," ",841],["T_ARRAY","array",841],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",841],",",["T_WHITESPACE"," ",841],["T_CONSTANT_ENCAPSED_STRING","'type_id'",841],",",["T_WHITESPACE"," ",841],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",841],")",";",["T_WHITESPACE","\n        ",841],["T_VARIABLE","$colsList",842],["T_WHITESPACE","   ",842],"=",["T_WHITESPACE"," ",842],["T_ARRAY","array",842],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",842],",",["T_WHITESPACE"," ",842],["T_CONSTANT_ENCAPSED_STRING","'type_id'",842],",",["T_WHITESPACE"," ",842],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",842],")",";",["T_WHITESPACE","\n        ",842],["T_IF","if",843],["T_WHITESPACE"," ",843],"(",["T_VARIABLE","$this",843],["T_OBJECT_OPERATOR","->",843],["T_STRING","getFlatHelper",843],"(",")",["T_OBJECT_OPERATOR","->",843],["T_STRING","isAddChildData",843],"(",")",")",["T_WHITESPACE"," ",843],"{",["T_WHITESPACE","\n            ",843],["T_VARIABLE","$fieldList",844],["T_WHITESPACE"," ",844],"=",["T_WHITESPACE"," ",844],["T_STRING","array_merge",844],"(",["T_VARIABLE","$fieldList",844],",",["T_WHITESPACE"," ",844],["T_ARRAY","array",844],"(",["T_CONSTANT_ENCAPSED_STRING","'child_id'",844],",",["T_WHITESPACE"," ",844],["T_CONSTANT_ENCAPSED_STRING","'is_child'",844],")",")",";",["T_WHITESPACE","\n            ",844],["T_VARIABLE","$isChild",845],["T_WHITESPACE","   ",845],"=",["T_WHITESPACE"," ",845],["T_NEW","new",845],["T_WHITESPACE"," ",845],["T_STRING","Zend_Db_Expr",845],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",845],")",";",["T_WHITESPACE","\n            ",845],["T_VARIABLE","$colsList",846],["T_WHITESPACE","  ",846],"=",["T_WHITESPACE"," ",846],["T_STRING","array_merge",846],"(",["T_VARIABLE","$colsList",846],",",["T_WHITESPACE"," ",846],["T_ARRAY","array",846],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",846],",",["T_WHITESPACE"," ",846],["T_VARIABLE","$isChild",846],")",")",";",["T_WHITESPACE","\n        ",846],"}",["T_WHITESPACE","\n\n        ",847],["T_VARIABLE","$columns",849],["T_WHITESPACE","    ",849],"=",["T_WHITESPACE"," ",849],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","getFlatColumns",849],"(",")",";",["T_WHITESPACE","\n        ",849],["T_VARIABLE","$bind",850],["T_WHITESPACE","       ",850],"=",["T_WHITESPACE"," ",850],["T_ARRAY","array",850],"(",["T_WHITESPACE","\n            ",850],["T_CONSTANT_ENCAPSED_STRING","'website_id'",851],["T_WHITESPACE","     ",851],["T_DOUBLE_ARROW","=>",851],["T_WHITESPACE"," ",851],["T_VARIABLE","$websiteId",851],",",["T_WHITESPACE","\n            ",851],["T_CONSTANT_ENCAPSED_STRING","'store_id'",852],["T_WHITESPACE","       ",852],["T_DOUBLE_ARROW","=>",852],["T_WHITESPACE"," ",852],["T_VARIABLE","$storeId",852],",",["T_WHITESPACE","\n            ",852],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",853],["T_WHITESPACE"," ",853],["T_DOUBLE_ARROW","=>",853],["T_WHITESPACE"," ",853],["T_INT_CAST","(int)",853],["T_VARIABLE","$status",853],["T_OBJECT_OPERATOR","->",853],["T_STRING","getEntityTypeId",853],"(",")",",",["T_WHITESPACE","\n            ",853],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",854],["T_WHITESPACE","   ",854],["T_DOUBLE_ARROW","=>",854],["T_WHITESPACE"," ",854],["T_INT_CAST","(int)",854],["T_VARIABLE","$status",854],["T_OBJECT_OPERATOR","->",854],["T_STRING","getId",854],"(",")",["T_WHITESPACE","\n        ",854],")",";",["T_WHITESPACE","\n\n        ",855],["T_VARIABLE","$fieldExpr",857],["T_WHITESPACE"," ",857],"=",["T_WHITESPACE"," ",857],["T_VARIABLE","$adapter",857],["T_OBJECT_OPERATOR","->",857],["T_STRING","getCheckSql",857],"(",["T_CONSTANT_ENCAPSED_STRING","'t2.value_id > 0'",857],",",["T_WHITESPACE"," ",857],["T_CONSTANT_ENCAPSED_STRING","'t2.value'",857],",",["T_WHITESPACE"," ",857],["T_CONSTANT_ENCAPSED_STRING","'t1.value'",857],")",";",["T_WHITESPACE","\n        ",857],["T_VARIABLE","$select",858],["T_WHITESPACE","     ",858],"=",["T_WHITESPACE"," ",858],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","_getWriteAdapter",858],"(",")",["T_OBJECT_OPERATOR","->",858],["T_STRING","select",858],"(",")",["T_WHITESPACE","\n            ",858],["T_OBJECT_OPERATOR","->",859],["T_STRING","from",859],"(",["T_ARRAY","array",859],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",859],["T_WHITESPACE"," ",859],["T_DOUBLE_ARROW","=>",859],["T_WHITESPACE"," ",859],["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","getTable",859],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",859],")",")",",",["T_WHITESPACE"," ",859],["T_VARIABLE","$colsList",859],")",["T_WHITESPACE","\n            ",859],["T_OBJECT_OPERATOR","->",860],["T_STRING","join",860],"(",["T_WHITESPACE","\n                ",860],["T_ARRAY","array",861],"(",["T_CONSTANT_ENCAPSED_STRING","'wp'",861],["T_WHITESPACE"," ",861],["T_DOUBLE_ARROW","=>",861],["T_WHITESPACE"," ",861],["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","getTable",861],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_website'",861],")",")",",",["T_WHITESPACE","\n                ",861],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = wp.product_id AND wp.website_id = :website_id'",862],",",["T_WHITESPACE","\n                ",862],["T_ARRAY","array",863],"(",")",")",["T_WHITESPACE","\n            ",863],["T_OBJECT_OPERATOR","->",864],["T_STRING","joinLeft",864],"(",["T_WHITESPACE","\n                ",864],["T_ARRAY","array",865],"(",["T_CONSTANT_ENCAPSED_STRING","'t1'",865],["T_WHITESPACE"," ",865],["T_DOUBLE_ARROW","=>",865],["T_WHITESPACE"," ",865],["T_VARIABLE","$status",865],["T_OBJECT_OPERATOR","->",865],["T_STRING","getBackend",865],"(",")",["T_OBJECT_OPERATOR","->",865],["T_STRING","getTable",865],"(",")",")",",",["T_WHITESPACE","\n                ",865],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = t1.entity_id'",866],",",["T_WHITESPACE","\n                ",866],["T_ARRAY","array",867],"(",")",")",["T_WHITESPACE","\n            ",867],["T_OBJECT_OPERATOR","->",868],["T_STRING","joinLeft",868],"(",["T_WHITESPACE","\n                ",868],["T_ARRAY","array",869],"(",["T_CONSTANT_ENCAPSED_STRING","'t2'",869],["T_WHITESPACE"," ",869],["T_DOUBLE_ARROW","=>",869],["T_WHITESPACE"," ",869],["T_VARIABLE","$status",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","getBackend",869],"(",")",["T_OBJECT_OPERATOR","->",869],["T_STRING","getTable",869],"(",")",")",",",["T_WHITESPACE","\n                ",869],["T_CONSTANT_ENCAPSED_STRING","'t2.entity_id = t1.entity_id'",870],["T_WHITESPACE","\n                    ",870],".",["T_WHITESPACE"," ",871],["T_CONSTANT_ENCAPSED_STRING","' AND t1.entity_type_id = t2.entity_type_id'",871],["T_WHITESPACE","\n                    ",871],".",["T_WHITESPACE"," ",872],["T_CONSTANT_ENCAPSED_STRING","' AND t1.attribute_id = t2.attribute_id'",872],["T_WHITESPACE","\n                    ",872],".",["T_WHITESPACE"," ",873],["T_CONSTANT_ENCAPSED_STRING","' AND t2.store_id = :store_id'",873],",",["T_WHITESPACE","\n                ",873],["T_ARRAY","array",874],"(",")",")",["T_WHITESPACE","\n            ",874],["T_OBJECT_OPERATOR","->",875],["T_STRING","where",875],"(",["T_CONSTANT_ENCAPSED_STRING","'t1.entity_type_id = :entity_type_id'",875],")",["T_WHITESPACE","\n            ",875],["T_OBJECT_OPERATOR","->",876],["T_STRING","where",876],"(",["T_CONSTANT_ENCAPSED_STRING","'t1.attribute_id = :attribute_id'",876],")",["T_WHITESPACE","\n            ",876],["T_OBJECT_OPERATOR","->",877],["T_STRING","where",877],"(",["T_CONSTANT_ENCAPSED_STRING","'t1.store_id = ?'",877],",",["T_WHITESPACE"," ",877],["T_STRING","Mage_Core_Model_App",877],["T_DOUBLE_COLON","::",877],["T_STRING","ADMIN_STORE_ID",877],")",["T_WHITESPACE","\n            ",877],["T_OBJECT_OPERATOR","->",878],["T_STRING","where",878],"(","\"",["T_CURLY_OPEN","{",878],["T_VARIABLE","$fieldExpr",878],"}",["T_ENCAPSED_AND_WHITESPACE"," = ?",878],"\"",",",["T_WHITESPACE"," ",878],["T_STRING","Mage_Catalog_Model_Product_Status",878],["T_DOUBLE_COLON","::",878],["T_STRING","STATUS_ENABLED",878],")",";",["T_WHITESPACE","\n        ",878],["T_FOREACH","foreach",879],["T_WHITESPACE"," ",879],"(",["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","getAttributes",879],"(",")",["T_WHITESPACE"," ",879],["T_AS","as",879],["T_WHITESPACE"," ",879],["T_VARIABLE","$attributeCode",879],["T_WHITESPACE"," ",879],["T_DOUBLE_ARROW","=>",879],["T_WHITESPACE"," ",879],["T_VARIABLE","$attribute",879],")",["T_WHITESPACE"," ",879],"{",["T_WHITESPACE","\n            ",879],["T_DOC_COMMENT","\/** @var $attribute Mage_Eav_Model_Entity_Attribute *\/",880],["T_WHITESPACE","\n            ",880],["T_IF","if",881],["T_WHITESPACE"," ",881],"(",["T_VARIABLE","$attribute",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","getBackend",881],"(",")",["T_OBJECT_OPERATOR","->",881],["T_STRING","getType",881],"(",")",["T_WHITESPACE"," ",881],["T_IS_EQUAL","==",881],["T_WHITESPACE"," ",881],["T_CONSTANT_ENCAPSED_STRING","'static'",881],")",["T_WHITESPACE"," ",881],"{",["T_WHITESPACE","\n                ",881],["T_IF","if",882],["T_WHITESPACE"," ",882],"(","!",["T_ISSET","isset",882],"(",["T_VARIABLE","$columns",882],"[",["T_VARIABLE","$attributeCode",882],"]",")",")",["T_WHITESPACE"," ",882],"{",["T_WHITESPACE","\n                    ",882],["T_CONTINUE","continue",883],";",["T_WHITESPACE","\n                ",883],"}",["T_WHITESPACE","\n                ",884],["T_VARIABLE","$fieldList",885],"[","]",["T_WHITESPACE"," ",885],"=",["T_WHITESPACE"," ",885],["T_VARIABLE","$attributeCode",885],";",["T_WHITESPACE","\n                ",885],["T_VARIABLE","$select",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","columns",886],"(",["T_VARIABLE","$attributeCode",886],",",["T_WHITESPACE"," ",886],["T_CONSTANT_ENCAPSED_STRING","'e'",886],")",";",["T_WHITESPACE","\n            ",886],"}",["T_WHITESPACE","\n        ",887],"}",["T_WHITESPACE","\n\n        ",888],["T_IF","if",890],["T_WHITESPACE"," ",890],"(",["T_VARIABLE","$productIds",890],["T_WHITESPACE"," ",890],["T_IS_NOT_IDENTICAL","!==",890],["T_WHITESPACE"," ",890],["T_STRING","null",890],")",["T_WHITESPACE"," ",890],"{",["T_WHITESPACE","\n            ",890],["T_VARIABLE","$select",891],["T_OBJECT_OPERATOR","->",891],["T_STRING","where",891],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",891],",",["T_WHITESPACE"," ",891],["T_VARIABLE","$productIds",891],")",";",["T_WHITESPACE","\n        ",891],"}",["T_WHITESPACE","\n\n        ",892],["T_VARIABLE","$sql",894],["T_WHITESPACE"," ",894],"=",["T_WHITESPACE"," ",894],["T_VARIABLE","$select",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","insertFromSelect",894],"(",["T_VARIABLE","$this",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","getFlatTableName",894],"(",["T_VARIABLE","$storeId",894],")",",",["T_WHITESPACE"," ",894],["T_VARIABLE","$fieldList",894],")",";",["T_WHITESPACE","\n        ",894],["T_VARIABLE","$adapter",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","query",895],"(",["T_VARIABLE","$sql",895],",",["T_WHITESPACE"," ",895],["T_VARIABLE","$bind",895],")",";",["T_WHITESPACE","\n\n        ",895],["T_RETURN","return",897],["T_WHITESPACE"," ",897],["T_VARIABLE","$this",897],";",["T_WHITESPACE","\n    ",897],"}",["T_WHITESPACE","\n\n    ",898],["T_DOC_COMMENT","\/**\n     * Remove non website products\n     *\n     * @param int $storeId\n     * @param int|array $productIds\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",900],["T_WHITESPACE","\n    ",906],["T_PUBLIC","public",907],["T_WHITESPACE"," ",907],["T_FUNCTION","function",907],["T_WHITESPACE"," ",907],["T_STRING","cleanNonWebsiteProducts",907],"(",["T_VARIABLE","$storeId",907],",",["T_WHITESPACE"," ",907],["T_VARIABLE","$productIds",907],["T_WHITESPACE"," ",907],"=",["T_WHITESPACE"," ",907],["T_STRING","null",907],")",["T_WHITESPACE","\n    ",907],"{",["T_WHITESPACE","\n        ",908],["T_IF","if",909],["T_WHITESPACE"," ",909],"(","!",["T_VARIABLE","$this",909],["T_OBJECT_OPERATOR","->",909],["T_STRING","_isFlatTableExists",909],"(",["T_VARIABLE","$storeId",909],")",")",["T_WHITESPACE"," ",909],"{",["T_WHITESPACE","\n            ",909],["T_RETURN","return",910],["T_WHITESPACE"," ",910],["T_VARIABLE","$this",910],";",["T_WHITESPACE","\n        ",910],"}",["T_WHITESPACE","\n\n        ",911],["T_VARIABLE","$websiteId",913],["T_WHITESPACE"," ",913],"=",["T_WHITESPACE"," ",913],["T_INT_CAST","(int)",913],["T_STRING","Mage",913],["T_DOUBLE_COLON","::",913],["T_STRING","app",913],"(",")",["T_OBJECT_OPERATOR","->",913],["T_STRING","getStore",913],"(",["T_VARIABLE","$storeId",913],")",["T_OBJECT_OPERATOR","->",913],["T_STRING","getWebsite",913],"(",")",["T_OBJECT_OPERATOR","->",913],["T_STRING","getId",913],"(",")",";",["T_WHITESPACE","\n        ",913],["T_VARIABLE","$adapter",914],["T_WHITESPACE","   ",914],"=",["T_WHITESPACE"," ",914],["T_VARIABLE","$this",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","_getWriteAdapter",914],"(",")",";",["T_WHITESPACE","\n\n        ",914],["T_VARIABLE","$joinCondition",916],["T_WHITESPACE"," ",916],"=",["T_WHITESPACE"," ",916],["T_ARRAY","array",916],"(",["T_WHITESPACE","\n            ",916],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = wp.product_id'",917],",",["T_WHITESPACE","\n            ",917],["T_CONSTANT_ENCAPSED_STRING","'wp.website_id = :website_id'",918],["T_WHITESPACE","\n        ",918],")",";",["T_WHITESPACE","\n        ",919],["T_IF","if",920],["T_WHITESPACE"," ",920],"(",["T_VARIABLE","$this",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","getFlatHelper",920],"(",")",["T_OBJECT_OPERATOR","->",920],["T_STRING","isAddChildData",920],"(",")",")",["T_WHITESPACE"," ",920],"{",["T_WHITESPACE","\n            ",920],["T_VARIABLE","$joinCondition",921],"[","]",["T_WHITESPACE"," ",921],"=",["T_WHITESPACE"," ",921],["T_CONSTANT_ENCAPSED_STRING","'e.child_id = wp.product_id'",921],";",["T_WHITESPACE","\n        ",921],"}",["T_WHITESPACE","\n        ",922],["T_VARIABLE","$bind",923],["T_WHITESPACE","   ",923],"=",["T_WHITESPACE"," ",923],["T_ARRAY","array",923],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",923],["T_WHITESPACE","    ",923],["T_DOUBLE_ARROW","=>",923],["T_WHITESPACE"," ",923],["T_VARIABLE","$websiteId",923],")",";",["T_WHITESPACE","\n        ",923],["T_VARIABLE","$select",924],["T_WHITESPACE"," ",924],"=",["T_WHITESPACE"," ",924],["T_VARIABLE","$adapter",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","select",924],"(",")",["T_WHITESPACE","\n            ",924],["T_OBJECT_OPERATOR","->",925],["T_STRING","from",925],"(",["T_ARRAY","array",925],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",925],["T_WHITESPACE"," ",925],["T_DOUBLE_ARROW","=>",925],["T_WHITESPACE"," ",925],["T_VARIABLE","$this",925],["T_OBJECT_OPERATOR","->",925],["T_STRING","getFlatTableName",925],"(",["T_VARIABLE","$storeId",925],")",")",",",["T_WHITESPACE"," ",925],["T_STRING","null",925],")",["T_WHITESPACE","\n            ",925],["T_OBJECT_OPERATOR","->",926],["T_STRING","joinLeft",926],"(",["T_WHITESPACE","\n                ",926],["T_ARRAY","array",927],"(",["T_CONSTANT_ENCAPSED_STRING","'wp'",927],["T_WHITESPACE"," ",927],["T_DOUBLE_ARROW","=>",927],["T_WHITESPACE"," ",927],["T_VARIABLE","$this",927],["T_OBJECT_OPERATOR","->",927],["T_STRING","getTable",927],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_website'",927],")",")",",",["T_WHITESPACE","\n                ",927],["T_STRING","implode",928],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",928],",",["T_WHITESPACE"," ",928],["T_VARIABLE","$joinCondition",928],")",",",["T_WHITESPACE","\n                ",928],["T_ARRAY","array",929],"(",")",")",";",["T_WHITESPACE","\n        ",929],["T_IF","if",930],["T_WHITESPACE"," ",930],"(",["T_VARIABLE","$productIds",930],["T_WHITESPACE"," ",930],["T_IS_NOT_IDENTICAL","!==",930],["T_WHITESPACE"," ",930],["T_STRING","null",930],")",["T_WHITESPACE"," ",930],"{",["T_WHITESPACE","\n            ",930],["T_VARIABLE","$condition",931],["T_WHITESPACE"," ",931],"=",["T_WHITESPACE"," ",931],["T_ARRAY","array",931],"(",["T_WHITESPACE","\n                ",931],["T_VARIABLE","$adapter",932],["T_OBJECT_OPERATOR","->",932],["T_STRING","quoteInto",932],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",932],",",["T_WHITESPACE"," ",932],["T_VARIABLE","$productIds",932],")",["T_WHITESPACE","\n            ",932],")",";",["T_WHITESPACE","\n            ",933],["T_IF","if",934],["T_WHITESPACE"," ",934],"(",["T_VARIABLE","$this",934],["T_OBJECT_OPERATOR","->",934],["T_STRING","getFlatHelper",934],"(",")",["T_OBJECT_OPERATOR","->",934],["T_STRING","isAddChildData",934],"(",")",")",["T_WHITESPACE"," ",934],"{",["T_WHITESPACE","\n                ",934],["T_VARIABLE","$condition",935],"[","]",["T_WHITESPACE"," ",935],"=",["T_WHITESPACE"," ",935],["T_VARIABLE","$adapter",935],["T_OBJECT_OPERATOR","->",935],["T_STRING","quoteInto",935],"(",["T_CONSTANT_ENCAPSED_STRING","'e.child_id IN(?)'",935],",",["T_WHITESPACE"," ",935],["T_VARIABLE","$productIds",935],")",";",["T_WHITESPACE","\n            ",935],"}",["T_WHITESPACE","\n            ",936],["T_VARIABLE","$select",937],["T_OBJECT_OPERATOR","->",937],["T_STRING","where",937],"(",["T_STRING","implode",937],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",937],",",["T_WHITESPACE"," ",937],["T_VARIABLE","$condition",937],")",")",";",["T_WHITESPACE","\n        ",937],"}",["T_WHITESPACE","\n\n        ",938],["T_VARIABLE","$sql",940],["T_WHITESPACE"," ",940],"=",["T_WHITESPACE"," ",940],["T_VARIABLE","$select",940],["T_OBJECT_OPERATOR","->",940],["T_STRING","deleteFromSelect",940],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",940],")",";",["T_WHITESPACE","\n        ",940],["T_VARIABLE","$adapter",941],["T_OBJECT_OPERATOR","->",941],["T_STRING","query",941],"(",["T_VARIABLE","$sql",941],",",["T_WHITESPACE"," ",941],["T_VARIABLE","$bind",941],")",";",["T_WHITESPACE","\n\n        ",941],["T_RETURN","return",943],["T_WHITESPACE"," ",943],["T_VARIABLE","$this",943],";",["T_WHITESPACE","\n    ",943],"}",["T_WHITESPACE","\n\n    ",944],["T_DOC_COMMENT","\/**\n     * Update attribute flat data\n     *\n     * @param Mage_Eav_Model_Entity_Attribute $attribute\n     * @param int $storeId\n     * @param int|array $productIds update only product(s)\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",946],["T_WHITESPACE","\n    ",953],["T_PUBLIC","public",954],["T_WHITESPACE"," ",954],["T_FUNCTION","function",954],["T_WHITESPACE"," ",954],["T_STRING","updateAttribute",954],"(",["T_VARIABLE","$attribute",954],",",["T_WHITESPACE"," ",954],["T_VARIABLE","$storeId",954],",",["T_WHITESPACE"," ",954],["T_VARIABLE","$productIds",954],["T_WHITESPACE"," ",954],"=",["T_WHITESPACE"," ",954],["T_STRING","null",954],")",["T_WHITESPACE","\n    ",954],"{",["T_WHITESPACE","\n        ",955],["T_IF","if",956],["T_WHITESPACE"," ",956],"(","!",["T_VARIABLE","$this",956],["T_OBJECT_OPERATOR","->",956],["T_STRING","_isFlatTableExists",956],"(",["T_VARIABLE","$storeId",956],")",")",["T_WHITESPACE"," ",956],"{",["T_WHITESPACE","\n            ",956],["T_RETURN","return",957],["T_WHITESPACE"," ",957],["T_VARIABLE","$this",957],";",["T_WHITESPACE","\n        ",957],"}",["T_WHITESPACE","\n        ",958],["T_VARIABLE","$adapter",959],["T_WHITESPACE","       ",959],"=",["T_WHITESPACE"," ",959],["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","_getWriteAdapter",959],"(",")",";",["T_WHITESPACE","\n        ",959],["T_VARIABLE","$flatTableName",960],["T_WHITESPACE"," ",960],"=",["T_WHITESPACE"," ",960],["T_VARIABLE","$this",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","getFlatTableName",960],"(",["T_VARIABLE","$storeId",960],")",";",["T_WHITESPACE","\n        ",960],["T_VARIABLE","$describe",961],["T_WHITESPACE","      ",961],"=",["T_WHITESPACE"," ",961],["T_VARIABLE","$adapter",961],["T_OBJECT_OPERATOR","->",961],["T_STRING","describeTable",961],"(",["T_VARIABLE","$flatTableName",961],")",";",["T_WHITESPACE","\n\n        ",961],["T_IF","if",963],["T_WHITESPACE"," ",963],"(",["T_VARIABLE","$attribute",963],["T_OBJECT_OPERATOR","->",963],["T_STRING","getBackend",963],"(",")",["T_OBJECT_OPERATOR","->",963],["T_STRING","getType",963],"(",")",["T_WHITESPACE"," ",963],["T_IS_EQUAL","==",963],["T_WHITESPACE"," ",963],["T_CONSTANT_ENCAPSED_STRING","'static'",963],")",["T_WHITESPACE"," ",963],"{",["T_WHITESPACE","\n            ",963],["T_IF","if",964],["T_WHITESPACE"," ",964],"(","!",["T_ISSET","isset",964],"(",["T_VARIABLE","$describe",964],"[",["T_VARIABLE","$attribute",964],["T_OBJECT_OPERATOR","->",964],["T_STRING","getAttributeCode",964],"(",")","]",")",")",["T_WHITESPACE"," ",964],"{",["T_WHITESPACE","\n                ",964],["T_RETURN","return",965],["T_WHITESPACE"," ",965],["T_VARIABLE","$this",965],";",["T_WHITESPACE","\n            ",965],"}",["T_WHITESPACE","\n\n            ",966],["T_VARIABLE","$select",968],["T_WHITESPACE"," ",968],"=",["T_WHITESPACE"," ",968],["T_VARIABLE","$adapter",968],["T_OBJECT_OPERATOR","->",968],["T_STRING","select",968],"(",")",["T_WHITESPACE","\n                ",968],["T_OBJECT_OPERATOR","->",969],["T_STRING","join",969],"(",["T_WHITESPACE","\n                    ",969],["T_ARRAY","array",970],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",970],["T_WHITESPACE"," ",970],["T_DOUBLE_ARROW","=>",970],["T_WHITESPACE"," ",970],["T_VARIABLE","$this",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","getTable",970],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",970],")",")",",",["T_WHITESPACE","\n                    ",970],["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id = e.entity_id'",971],",",["T_WHITESPACE","\n                    ",971],["T_ARRAY","array",972],"(",["T_VARIABLE","$attribute",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","getAttributeCode",972],"(",")",["T_WHITESPACE"," ",972],["T_DOUBLE_ARROW","=>",972],["T_WHITESPACE"," ",972],["T_CONSTANT_ENCAPSED_STRING","'main_table.'",972],["T_WHITESPACE"," ",972],".",["T_WHITESPACE"," ",972],["T_VARIABLE","$attribute",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","getAttributeCode",972],"(",")",")",["T_WHITESPACE","\n                ",972],")",";",["T_WHITESPACE","\n            ",973],["T_IF","if",974],["T_WHITESPACE"," ",974],"(",["T_VARIABLE","$this",974],["T_OBJECT_OPERATOR","->",974],["T_STRING","getFlatHelper",974],"(",")",["T_OBJECT_OPERATOR","->",974],["T_STRING","isAddChildData",974],"(",")",")",["T_WHITESPACE"," ",974],"{",["T_WHITESPACE","\n                ",974],["T_VARIABLE","$select",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","where",975],"(",["T_CONSTANT_ENCAPSED_STRING","'e.is_child = ?'",975],",",["T_WHITESPACE"," ",975],["T_LNUMBER","0",975],")",";",["T_WHITESPACE","\n            ",975],"}",["T_WHITESPACE","\n            ",976],["T_IF","if",977],["T_WHITESPACE"," ",977],"(",["T_VARIABLE","$productIds",977],["T_WHITESPACE"," ",977],["T_IS_NOT_IDENTICAL","!==",977],["T_WHITESPACE"," ",977],["T_STRING","null",977],")",["T_WHITESPACE"," ",977],"{",["T_WHITESPACE","\n                ",977],["T_VARIABLE","$select",978],["T_OBJECT_OPERATOR","->",978],["T_STRING","where",978],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id IN(?)'",978],",",["T_WHITESPACE"," ",978],["T_VARIABLE","$productIds",978],")",";",["T_WHITESPACE","\n            ",978],"}",["T_WHITESPACE","\n\n            ",979],["T_VARIABLE","$sql",981],["T_WHITESPACE"," ",981],"=",["T_WHITESPACE"," ",981],["T_VARIABLE","$select",981],["T_OBJECT_OPERATOR","->",981],["T_STRING","crossUpdateFromSelect",981],"(",["T_ARRAY","array",981],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",981],["T_WHITESPACE"," ",981],["T_DOUBLE_ARROW","=>",981],["T_WHITESPACE"," ",981],["T_VARIABLE","$flatTableName",981],")",")",";",["T_WHITESPACE","\n            ",981],["T_VARIABLE","$adapter",982],["T_OBJECT_OPERATOR","->",982],["T_STRING","query",982],"(",["T_VARIABLE","$sql",982],")",";",["T_WHITESPACE","\n        ",982],"}",["T_WHITESPACE"," ",983],["T_ELSE","else",983],["T_WHITESPACE"," ",983],"{",["T_WHITESPACE","\n            ",983],["T_VARIABLE","$columns",984],["T_WHITESPACE"," ",984],"=",["T_WHITESPACE"," ",984],["T_VARIABLE","$attribute",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","getFlatColumns",984],"(",")",";",["T_WHITESPACE","\n            ",984],["T_IF","if",985],["T_WHITESPACE"," ",985],"(","!",["T_VARIABLE","$columns",985],")",["T_WHITESPACE"," ",985],"{",["T_WHITESPACE","\n                ",985],["T_RETURN","return",986],["T_WHITESPACE"," ",986],["T_VARIABLE","$this",986],";",["T_WHITESPACE","\n            ",986],"}",["T_WHITESPACE","\n            ",987],["T_FOREACH","foreach",988],["T_WHITESPACE"," ",988],"(",["T_STRING","array_keys",988],"(",["T_VARIABLE","$columns",988],")",["T_WHITESPACE"," ",988],["T_AS","as",988],["T_WHITESPACE"," ",988],["T_VARIABLE","$columnName",988],")",["T_WHITESPACE"," ",988],"{",["T_WHITESPACE","\n                ",988],["T_IF","if",989],["T_WHITESPACE"," ",989],"(","!",["T_ISSET","isset",989],"(",["T_VARIABLE","$describe",989],"[",["T_VARIABLE","$columnName",989],"]",")",")",["T_WHITESPACE"," ",989],"{",["T_WHITESPACE","\n                    ",989],["T_RETURN","return",990],["T_WHITESPACE"," ",990],["T_VARIABLE","$this",990],";",["T_WHITESPACE","\n                ",990],"}",["T_WHITESPACE","\n            ",991],"}",["T_WHITESPACE","\n\n            ",992],["T_VARIABLE","$select",994],["T_WHITESPACE"," ",994],"=",["T_WHITESPACE"," ",994],["T_VARIABLE","$attribute",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","getFlatUpdateSelect",994],"(",["T_VARIABLE","$storeId",994],")",";",["T_WHITESPACE","\n            ",994],["T_IF","if",995],["T_WHITESPACE"," ",995],"(",["T_VARIABLE","$select",995],["T_WHITESPACE"," ",995],["T_INSTANCEOF","instanceof",995],["T_WHITESPACE"," ",995],["T_STRING","Varien_Db_Select",995],")",["T_WHITESPACE"," ",995],"{",["T_WHITESPACE","\n                ",995],["T_IF","if",996],["T_WHITESPACE"," ",996],"(",["T_VARIABLE","$productIds",996],["T_WHITESPACE"," ",996],["T_IS_NOT_IDENTICAL","!==",996],["T_WHITESPACE"," ",996],["T_STRING","null",996],")",["T_WHITESPACE"," ",996],"{",["T_WHITESPACE","\n                    ",996],["T_VARIABLE","$select",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","where",997],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",997],",",["T_WHITESPACE"," ",997],["T_VARIABLE","$productIds",997],")",";",["T_WHITESPACE","\n                ",997],"}",["T_WHITESPACE","\n\n                ",998],["T_VARIABLE","$sql",1000],["T_WHITESPACE"," ",1000],"=",["T_WHITESPACE"," ",1000],["T_VARIABLE","$select",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","crossUpdateFromSelect",1000],"(",["T_ARRAY","array",1000],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",1000],["T_WHITESPACE"," ",1000],["T_DOUBLE_ARROW","=>",1000],["T_WHITESPACE"," ",1000],["T_VARIABLE","$flatTableName",1000],")",")",";",["T_WHITESPACE","\n                ",1000],["T_VARIABLE","$adapter",1001],["T_OBJECT_OPERATOR","->",1001],["T_STRING","query",1001],"(",["T_VARIABLE","$sql",1001],")",";",["T_WHITESPACE","\n            ",1001],"}",["T_WHITESPACE","\n        ",1002],"}",["T_WHITESPACE","\n\n        ",1003],["T_RETURN","return",1005],["T_WHITESPACE"," ",1005],["T_VARIABLE","$this",1005],";",["T_WHITESPACE","\n    ",1005],"}",["T_WHITESPACE","\n\n    ",1006],["T_DOC_COMMENT","\/**\n     * Update non static EAV attributes flat data\n     *\n     * @param int $storeId\n     * @param int|array $productIds update only product(s)\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1008],["T_WHITESPACE","\n    ",1014],["T_PUBLIC","public",1015],["T_WHITESPACE"," ",1015],["T_FUNCTION","function",1015],["T_WHITESPACE"," ",1015],["T_STRING","updateEavAttributes",1015],"(",["T_VARIABLE","$storeId",1015],",",["T_WHITESPACE"," ",1015],["T_VARIABLE","$productIds",1015],["T_WHITESPACE"," ",1015],"=",["T_WHITESPACE"," ",1015],["T_STRING","null",1015],")",["T_WHITESPACE","\n    ",1015],"{",["T_WHITESPACE","\n        ",1016],["T_IF","if",1017],["T_WHITESPACE"," ",1017],"(","!",["T_VARIABLE","$this",1017],["T_OBJECT_OPERATOR","->",1017],["T_STRING","_isFlatTableExists",1017],"(",["T_VARIABLE","$storeId",1017],")",")",["T_WHITESPACE"," ",1017],"{",["T_WHITESPACE","\n            ",1017],["T_RETURN","return",1018],["T_WHITESPACE"," ",1018],["T_VARIABLE","$this",1018],";",["T_WHITESPACE","\n        ",1018],"}",["T_WHITESPACE","\n\n        ",1019],["T_FOREACH","foreach",1021],["T_WHITESPACE"," ",1021],"(",["T_VARIABLE","$this",1021],["T_OBJECT_OPERATOR","->",1021],["T_STRING","getAttributes",1021],"(",")",["T_WHITESPACE"," ",1021],["T_AS","as",1021],["T_WHITESPACE"," ",1021],["T_VARIABLE","$attribute",1021],")",["T_WHITESPACE"," ",1021],"{",["T_WHITESPACE","\n            ",1021],["T_COMMENT","\/* @var $attribute Mage_Eav_Model_Entity_Attribute *\/",1022],["T_WHITESPACE","\n            ",1022],["T_IF","if",1023],["T_WHITESPACE"," ",1023],"(",["T_VARIABLE","$attribute",1023],["T_OBJECT_OPERATOR","->",1023],["T_STRING","getBackend",1023],"(",")",["T_OBJECT_OPERATOR","->",1023],["T_STRING","getType",1023],"(",")",["T_WHITESPACE"," ",1023],["T_IS_NOT_EQUAL","!=",1023],["T_WHITESPACE"," ",1023],["T_CONSTANT_ENCAPSED_STRING","'static'",1023],")",["T_WHITESPACE"," ",1023],"{",["T_WHITESPACE","\n                ",1023],["T_VARIABLE","$this",1024],["T_OBJECT_OPERATOR","->",1024],["T_STRING","updateAttribute",1024],"(",["T_VARIABLE","$attribute",1024],",",["T_WHITESPACE"," ",1024],["T_VARIABLE","$storeId",1024],",",["T_WHITESPACE"," ",1024],["T_VARIABLE","$productIds",1024],")",";",["T_WHITESPACE","\n            ",1024],"}",["T_WHITESPACE","\n        ",1025],"}",["T_WHITESPACE","\n        ",1026],["T_RETURN","return",1027],["T_WHITESPACE"," ",1027],["T_VARIABLE","$this",1027],";",["T_WHITESPACE","\n    ",1027],"}",["T_WHITESPACE","\n\n    ",1028],["T_DOC_COMMENT","\/**\n     * Update events observer attributes\n     *\n     * @param int $storeId\n     *\/",1030],["T_WHITESPACE","\n    ",1034],["T_PUBLIC","public",1035],["T_WHITESPACE"," ",1035],["T_FUNCTION","function",1035],["T_WHITESPACE"," ",1035],["T_STRING","updateEventAttributes",1035],"(",["T_VARIABLE","$storeId",1035],["T_WHITESPACE"," ",1035],"=",["T_WHITESPACE"," ",1035],["T_STRING","null",1035],")",["T_WHITESPACE","\n    ",1035],"{",["T_WHITESPACE","\n        ",1036],["T_STRING","Mage",1037],["T_DOUBLE_COLON","::",1037],["T_STRING","dispatchEvent",1037],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_flat_rebuild'",1037],",",["T_WHITESPACE"," ",1037],["T_ARRAY","array",1037],"(",["T_WHITESPACE","\n            ",1037],["T_CONSTANT_ENCAPSED_STRING","'store_id'",1038],["T_WHITESPACE"," ",1038],["T_DOUBLE_ARROW","=>",1038],["T_WHITESPACE"," ",1038],["T_VARIABLE","$storeId",1038],",",["T_WHITESPACE","\n            ",1038],["T_CONSTANT_ENCAPSED_STRING","'table'",1039],["T_WHITESPACE","    ",1039],["T_DOUBLE_ARROW","=>",1039],["T_WHITESPACE"," ",1039],["T_VARIABLE","$this",1039],["T_OBJECT_OPERATOR","->",1039],["T_STRING","getFlatTableName",1039],"(",["T_VARIABLE","$storeId",1039],")",["T_WHITESPACE","\n        ",1039],")",")",";",["T_WHITESPACE","\n    ",1040],"}",["T_WHITESPACE","\n\n    ",1041],["T_DOC_COMMENT","\/**\n     * Retrieve Product Type Instances\n     * as key - type code, value - instance model\n     *\n     * @return array\n     *\/",1043],["T_WHITESPACE","\n    ",1048],["T_PUBLIC","public",1049],["T_WHITESPACE"," ",1049],["T_FUNCTION","function",1049],["T_WHITESPACE"," ",1049],["T_STRING","getProductTypeInstances",1049],"(",")",["T_WHITESPACE","\n    ",1049],"{",["T_WHITESPACE","\n        ",1050],["T_IF","if",1051],["T_WHITESPACE"," ",1051],"(",["T_VARIABLE","$this",1051],["T_OBJECT_OPERATOR","->",1051],["T_STRING","_productTypes",1051],["T_WHITESPACE"," ",1051],["T_IS_IDENTICAL","===",1051],["T_WHITESPACE"," ",1051],["T_STRING","null",1051],")",["T_WHITESPACE"," ",1051],"{",["T_WHITESPACE","\n            ",1051],["T_VARIABLE","$this",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","_productTypes",1052],["T_WHITESPACE"," ",1052],"=",["T_WHITESPACE"," ",1052],["T_ARRAY","array",1052],"(",")",";",["T_WHITESPACE","\n            ",1052],["T_VARIABLE","$productEmulator",1053],["T_WHITESPACE","     ",1053],"=",["T_WHITESPACE"," ",1053],["T_NEW","new",1053],["T_WHITESPACE"," ",1053],["T_STRING","Varien_Object",1053],"(",")",";",["T_WHITESPACE","\n\n            ",1053],["T_FOREACH","foreach",1055],["T_WHITESPACE"," ",1055],"(",["T_STRING","array_keys",1055],"(",["T_STRING","Mage_Catalog_Model_Product_Type",1055],["T_DOUBLE_COLON","::",1055],["T_STRING","getTypes",1055],"(",")",")",["T_WHITESPACE"," ",1055],["T_AS","as",1055],["T_WHITESPACE"," ",1055],["T_VARIABLE","$typeId",1055],")",["T_WHITESPACE"," ",1055],"{",["T_WHITESPACE","\n                ",1055],["T_VARIABLE","$productEmulator",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","setTypeId",1056],"(",["T_VARIABLE","$typeId",1056],")",";",["T_WHITESPACE","\n                ",1056],["T_VARIABLE","$this",1057],["T_OBJECT_OPERATOR","->",1057],["T_STRING","_productTypes",1057],"[",["T_VARIABLE","$typeId",1057],"]",["T_WHITESPACE"," ",1057],"=",["T_WHITESPACE"," ",1057],["T_STRING","Mage",1057],["T_DOUBLE_COLON","::",1057],["T_STRING","getSingleton",1057],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",1057],")",["T_WHITESPACE","\n                    ",1057],["T_OBJECT_OPERATOR","->",1058],["T_STRING","factory",1058],"(",["T_VARIABLE","$productEmulator",1058],")",";",["T_WHITESPACE","\n            ",1058],"}",["T_WHITESPACE","\n        ",1059],"}",["T_WHITESPACE","\n        ",1060],["T_RETURN","return",1061],["T_WHITESPACE"," ",1061],["T_VARIABLE","$this",1061],["T_OBJECT_OPERATOR","->",1061],["T_STRING","_productTypes",1061],";",["T_WHITESPACE","\n    ",1061],"}",["T_WHITESPACE","\n\n    ",1062],["T_DOC_COMMENT","\/**\n     * Update relation products\n     *\n     * @param int $storeId\n     * @param int|array $productIds Update child product(s) only\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1064],["T_WHITESPACE","\n    ",1070],["T_PUBLIC","public",1071],["T_WHITESPACE"," ",1071],["T_FUNCTION","function",1071],["T_WHITESPACE"," ",1071],["T_STRING","updateRelationProducts",1071],"(",["T_VARIABLE","$storeId",1071],",",["T_WHITESPACE"," ",1071],["T_VARIABLE","$productIds",1071],["T_WHITESPACE"," ",1071],"=",["T_WHITESPACE"," ",1071],["T_STRING","null",1071],")",["T_WHITESPACE","\n    ",1071],"{",["T_WHITESPACE","\n        ",1072],["T_IF","if",1073],["T_WHITESPACE"," ",1073],"(","!",["T_VARIABLE","$this",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","getFlatHelper",1073],"(",")",["T_OBJECT_OPERATOR","->",1073],["T_STRING","isAddChildData",1073],"(",")",["T_WHITESPACE"," ",1073],["T_BOOLEAN_OR","||",1073],["T_WHITESPACE"," ",1073],"!",["T_VARIABLE","$this",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","_isFlatTableExists",1073],"(",["T_VARIABLE","$storeId",1073],")",")",["T_WHITESPACE"," ",1073],"{",["T_WHITESPACE","\n            ",1073],["T_RETURN","return",1074],["T_WHITESPACE"," ",1074],["T_VARIABLE","$this",1074],";",["T_WHITESPACE","\n        ",1074],"}",["T_WHITESPACE","\n\n        ",1075],["T_VARIABLE","$adapter",1077],["T_WHITESPACE"," ",1077],"=",["T_WHITESPACE"," ",1077],["T_VARIABLE","$this",1077],["T_OBJECT_OPERATOR","->",1077],["T_STRING","_getWriteAdapter",1077],"(",")",";",["T_WHITESPACE","\n\n        ",1077],["T_FOREACH","foreach",1079],["T_WHITESPACE"," ",1079],"(",["T_VARIABLE","$this",1079],["T_OBJECT_OPERATOR","->",1079],["T_STRING","getProductTypeInstances",1079],"(",")",["T_WHITESPACE"," ",1079],["T_AS","as",1079],["T_WHITESPACE"," ",1079],["T_VARIABLE","$typeInstance",1079],")",["T_WHITESPACE"," ",1079],"{",["T_WHITESPACE","\n            ",1079],["T_IF","if",1080],["T_WHITESPACE"," ",1080],"(","!",["T_VARIABLE","$typeInstance",1080],["T_OBJECT_OPERATOR","->",1080],["T_STRING","isComposite",1080],"(",")",")",["T_WHITESPACE"," ",1080],"{",["T_WHITESPACE","\n                ",1080],["T_CONTINUE","continue",1081],";",["T_WHITESPACE","\n            ",1081],"}",["T_WHITESPACE","\n            ",1082],["T_VARIABLE","$relation",1083],["T_WHITESPACE"," ",1083],"=",["T_WHITESPACE"," ",1083],["T_VARIABLE","$typeInstance",1083],["T_OBJECT_OPERATOR","->",1083],["T_STRING","getRelationInfo",1083],"(",")",";",["T_WHITESPACE","\n            ",1083],["T_IF","if",1084],["T_WHITESPACE"," ",1084],"(",["T_VARIABLE","$relation",1084],["T_WHITESPACE","\n                ",1084],["T_BOOLEAN_AND","&&",1085],["T_WHITESPACE"," ",1085],["T_VARIABLE","$relation",1085],["T_OBJECT_OPERATOR","->",1085],["T_STRING","getTable",1085],"(",")",["T_WHITESPACE","\n                ",1085],["T_BOOLEAN_AND","&&",1086],["T_WHITESPACE"," ",1086],["T_VARIABLE","$relation",1086],["T_OBJECT_OPERATOR","->",1086],["T_STRING","getParentFieldName",1086],"(",")",["T_WHITESPACE","\n                ",1086],["T_BOOLEAN_AND","&&",1087],["T_WHITESPACE"," ",1087],["T_VARIABLE","$relation",1087],["T_OBJECT_OPERATOR","->",1087],["T_STRING","getChildFieldName",1087],"(",")",["T_WHITESPACE","\n            ",1087],")",["T_WHITESPACE"," ",1088],"{",["T_WHITESPACE","\n                ",1088],["T_VARIABLE","$columns",1089],["T_WHITESPACE","    ",1089],"=",["T_WHITESPACE"," ",1089],["T_VARIABLE","$this",1089],["T_OBJECT_OPERATOR","->",1089],["T_STRING","getFlatColumns",1089],"(",")",";",["T_WHITESPACE","\n                ",1089],["T_VARIABLE","$fieldList",1090],["T_WHITESPACE","  ",1090],"=",["T_WHITESPACE"," ",1090],["T_STRING","array_keys",1090],"(",["T_VARIABLE","$columns",1090],")",";",["T_WHITESPACE","\n                ",1090],["T_UNSET","unset",1091],"(",["T_VARIABLE","$columns",1091],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1091],"]",")",";",["T_WHITESPACE","\n                ",1091],["T_UNSET","unset",1092],"(",["T_VARIABLE","$columns",1092],"[",["T_CONSTANT_ENCAPSED_STRING","'child_id'",1092],"]",")",";",["T_WHITESPACE","\n                ",1092],["T_UNSET","unset",1093],"(",["T_VARIABLE","$columns",1093],"[",["T_CONSTANT_ENCAPSED_STRING","'is_child'",1093],"]",")",";",["T_WHITESPACE","\n\n                ",1093],["T_VARIABLE","$select",1095],["T_WHITESPACE"," ",1095],"=",["T_WHITESPACE"," ",1095],["T_VARIABLE","$adapter",1095],["T_OBJECT_OPERATOR","->",1095],["T_STRING","select",1095],"(",")",["T_WHITESPACE","\n                    ",1095],["T_OBJECT_OPERATOR","->",1096],["T_STRING","from",1096],"(",["T_WHITESPACE","\n                        ",1096],["T_ARRAY","array",1097],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",1097],["T_WHITESPACE"," ",1097],["T_DOUBLE_ARROW","=>",1097],["T_WHITESPACE"," ",1097],["T_VARIABLE","$this",1097],["T_OBJECT_OPERATOR","->",1097],["T_STRING","getTable",1097],"(",["T_VARIABLE","$relation",1097],["T_OBJECT_OPERATOR","->",1097],["T_STRING","getTable",1097],"(",")",")",")",",",["T_WHITESPACE","\n                        ",1097],["T_ARRAY","array",1098],"(",["T_VARIABLE","$relation",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","getParentFieldName",1098],"(",")",",",["T_WHITESPACE"," ",1098],["T_VARIABLE","$relation",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","getChildFieldName",1098],"(",")",",",["T_WHITESPACE"," ",1098],["T_NEW","new",1098],["T_WHITESPACE"," ",1098],["T_STRING","Zend_Db_Expr",1098],"(",["T_CONSTANT_ENCAPSED_STRING","'1'",1098],")",")",")",["T_WHITESPACE","\n                    ",1098],["T_OBJECT_OPERATOR","->",1099],["T_STRING","join",1099],"(",["T_WHITESPACE","\n                        ",1099],["T_ARRAY","array",1100],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",1100],["T_WHITESPACE"," ",1100],["T_DOUBLE_ARROW","=>",1100],["T_WHITESPACE"," ",1100],["T_VARIABLE","$this",1100],["T_OBJECT_OPERATOR","->",1100],["T_STRING","getFlatTableName",1100],"(",["T_VARIABLE","$storeId",1100],")",")",",",["T_WHITESPACE","\n                        ",1100],"\"",["T_ENCAPSED_AND_WHITESPACE","e.entity_id = t.",1101],["T_CURLY_OPEN","{",1101],["T_VARIABLE","$relation",1101],["T_OBJECT_OPERATOR","->",1101],["T_STRING","getChildFieldName",1101],"(",")","}","\"",",",["T_WHITESPACE","\n                        ",1101],["T_STRING","array_keys",1102],"(",["T_VARIABLE","$columns",1102],")",["T_WHITESPACE","\n                    ",1102],")",";",["T_WHITESPACE","\n                ",1103],["T_IF","if",1104],["T_WHITESPACE"," ",1104],"(",["T_VARIABLE","$relation",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","getWhere",1104],"(",")",["T_WHITESPACE"," ",1104],["T_IS_NOT_IDENTICAL","!==",1104],["T_WHITESPACE"," ",1104],["T_STRING","null",1104],")",["T_WHITESPACE"," ",1104],"{",["T_WHITESPACE","\n                    ",1104],["T_VARIABLE","$select",1105],["T_OBJECT_OPERATOR","->",1105],["T_STRING","where",1105],"(",["T_VARIABLE","$relation",1105],["T_OBJECT_OPERATOR","->",1105],["T_STRING","getWhere",1105],"(",")",")",";",["T_WHITESPACE","\n                ",1105],"}",["T_WHITESPACE","\n                ",1106],["T_IF","if",1107],["T_WHITESPACE"," ",1107],"(",["T_VARIABLE","$productIds",1107],["T_WHITESPACE"," ",1107],["T_IS_NOT_IDENTICAL","!==",1107],["T_WHITESPACE"," ",1107],["T_STRING","null",1107],")",["T_WHITESPACE"," ",1107],"{",["T_WHITESPACE","\n                    ",1107],["T_VARIABLE","$cond",1108],["T_WHITESPACE"," ",1108],"=",["T_WHITESPACE"," ",1108],["T_ARRAY","array",1108],"(",["T_WHITESPACE","\n                        ",1108],["T_VARIABLE","$adapter",1109],["T_OBJECT_OPERATOR","->",1109],["T_STRING","quoteInto",1109],"(","\"",["T_CURLY_OPEN","{",1109],["T_VARIABLE","$relation",1109],["T_OBJECT_OPERATOR","->",1109],["T_STRING","getChildFieldName",1109],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," IN(?)",1109],"\"",",",["T_WHITESPACE"," ",1109],["T_VARIABLE","$productIds",1109],")",",",["T_WHITESPACE","\n                        ",1109],["T_VARIABLE","$adapter",1110],["T_OBJECT_OPERATOR","->",1110],["T_STRING","quoteInto",1110],"(","\"",["T_CURLY_OPEN","{",1110],["T_VARIABLE","$relation",1110],["T_OBJECT_OPERATOR","->",1110],["T_STRING","getParentFieldName",1110],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," IN(?)",1110],"\"",",",["T_WHITESPACE"," ",1110],["T_VARIABLE","$productIds",1110],")",["T_WHITESPACE","\n                    ",1110],")",";",["T_WHITESPACE","\n\n                    ",1111],["T_VARIABLE","$select",1113],["T_OBJECT_OPERATOR","->",1113],["T_STRING","where",1113],"(",["T_STRING","implode",1113],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",1113],",",["T_WHITESPACE"," ",1113],["T_VARIABLE","$cond",1113],")",")",";",["T_WHITESPACE","\n                ",1113],"}",["T_WHITESPACE","\n                ",1114],["T_VARIABLE","$sql",1115],["T_WHITESPACE"," ",1115],"=",["T_WHITESPACE"," ",1115],["T_VARIABLE","$select",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","insertFromSelect",1115],"(",["T_VARIABLE","$this",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","getFlatTableName",1115],"(",["T_VARIABLE","$storeId",1115],")",",",["T_WHITESPACE"," ",1115],["T_VARIABLE","$fieldList",1115],")",";",["T_WHITESPACE","\n                ",1115],["T_VARIABLE","$adapter",1116],["T_OBJECT_OPERATOR","->",1116],["T_STRING","query",1116],"(",["T_VARIABLE","$sql",1116],")",";",["T_WHITESPACE","\n            ",1116],"}",["T_WHITESPACE","\n        ",1117],"}",["T_WHITESPACE","\n\n        ",1118],["T_RETURN","return",1120],["T_WHITESPACE"," ",1120],["T_VARIABLE","$this",1120],";",["T_WHITESPACE","\n    ",1120],"}",["T_WHITESPACE","\n\n    ",1121],["T_DOC_COMMENT","\/**\n     * Update children data from parent\n     *\n     * @param int $storeId\n     * @param int|array $productIds\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1123],["T_WHITESPACE","\n    ",1129],["T_PUBLIC","public",1130],["T_WHITESPACE"," ",1130],["T_FUNCTION","function",1130],["T_WHITESPACE"," ",1130],["T_STRING","updateChildrenDataFromParent",1130],"(",["T_VARIABLE","$storeId",1130],",",["T_WHITESPACE"," ",1130],["T_VARIABLE","$productIds",1130],["T_WHITESPACE"," ",1130],"=",["T_WHITESPACE"," ",1130],["T_STRING","null",1130],")",["T_WHITESPACE","\n    ",1130],"{",["T_WHITESPACE","\n        ",1131],["T_IF","if",1132],["T_WHITESPACE"," ",1132],"(","!",["T_VARIABLE","$this",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","getFlatHelper",1132],"(",")",["T_OBJECT_OPERATOR","->",1132],["T_STRING","isAddChildData",1132],"(",")",["T_WHITESPACE"," ",1132],["T_BOOLEAN_OR","||",1132],["T_WHITESPACE"," ",1132],"!",["T_VARIABLE","$this",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","_isFlatTableExists",1132],"(",["T_VARIABLE","$storeId",1132],")",")",["T_WHITESPACE"," ",1132],"{",["T_WHITESPACE","\n            ",1132],["T_RETURN","return",1133],["T_WHITESPACE"," ",1133],["T_VARIABLE","$this",1133],";",["T_WHITESPACE","\n        ",1133],"}",["T_WHITESPACE","\n        ",1134],["T_VARIABLE","$adapter",1135],["T_WHITESPACE"," ",1135],"=",["T_WHITESPACE"," ",1135],["T_VARIABLE","$this",1135],["T_OBJECT_OPERATOR","->",1135],["T_STRING","_getWriteAdapter",1135],"(",")",";",["T_WHITESPACE","\n\n        ",1135],["T_VARIABLE","$select",1137],["T_WHITESPACE"," ",1137],"=",["T_WHITESPACE"," ",1137],["T_VARIABLE","$adapter",1137],["T_OBJECT_OPERATOR","->",1137],["T_STRING","select",1137],"(",")",";",["T_WHITESPACE","\n        ",1137],["T_FOREACH","foreach",1138],["T_WHITESPACE"," ",1138],"(",["T_STRING","array_keys",1138],"(",["T_VARIABLE","$this",1138],["T_OBJECT_OPERATOR","->",1138],["T_STRING","getFlatColumns",1138],"(",")",")",["T_WHITESPACE"," ",1138],["T_AS","as",1138],["T_WHITESPACE"," ",1138],["T_VARIABLE","$columnName",1138],")",["T_WHITESPACE"," ",1138],"{",["T_WHITESPACE","\n            ",1138],["T_IF","if",1139],["T_WHITESPACE"," ",1139],"(",["T_VARIABLE","$columnName",1139],["T_WHITESPACE"," ",1139],["T_IS_EQUAL","==",1139],["T_WHITESPACE"," ",1139],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1139],["T_WHITESPACE"," ",1139],["T_BOOLEAN_OR","||",1139],["T_WHITESPACE"," ",1139],["T_VARIABLE","$columnName",1139],["T_WHITESPACE"," ",1139],["T_IS_EQUAL","==",1139],["T_WHITESPACE"," ",1139],["T_CONSTANT_ENCAPSED_STRING","'child_id'",1139],["T_WHITESPACE"," ",1139],["T_BOOLEAN_OR","||",1139],["T_WHITESPACE"," ",1139],["T_VARIABLE","$columnName",1139],["T_WHITESPACE"," ",1139],["T_IS_EQUAL","==",1139],["T_WHITESPACE"," ",1139],["T_CONSTANT_ENCAPSED_STRING","'is_child'",1139],")",["T_WHITESPACE"," ",1139],"{",["T_WHITESPACE","\n                ",1139],["T_CONTINUE","continue",1140],";",["T_WHITESPACE","\n            ",1140],"}",["T_WHITESPACE","\n            ",1141],["T_VARIABLE","$select",1142],["T_OBJECT_OPERATOR","->",1142],["T_STRING","columns",1142],"(",["T_ARRAY","array",1142],"(",["T_VARIABLE","$columnName",1142],["T_WHITESPACE"," ",1142],["T_DOUBLE_ARROW","=>",1142],["T_WHITESPACE"," ",1142],["T_NEW","new",1142],["T_WHITESPACE"," ",1142],["T_STRING","Zend_Db_Expr",1142],"(",["T_CONSTANT_ENCAPSED_STRING","'t1.'",1142],["T_WHITESPACE"," ",1142],".",["T_WHITESPACE"," ",1142],["T_VARIABLE","$columnName",1142],")",")",")",";",["T_WHITESPACE","\n        ",1142],"}",["T_WHITESPACE","\n        ",1143],["T_VARIABLE","$select",1144],["T_WHITESPACE","\n            ",1144],["T_OBJECT_OPERATOR","->",1145],["T_STRING","joinLeft",1145],"(",["T_WHITESPACE","\n                ",1145],["T_ARRAY","array",1146],"(",["T_CONSTANT_ENCAPSED_STRING","'t1'",1146],["T_WHITESPACE"," ",1146],["T_DOUBLE_ARROW","=>",1146],["T_WHITESPACE"," ",1146],["T_VARIABLE","$this",1146],["T_OBJECT_OPERATOR","->",1146],["T_STRING","getFlatTableName",1146],"(",["T_VARIABLE","$storeId",1146],")",")",",",["T_WHITESPACE","\n                ",1146],["T_VARIABLE","$adapter",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","quoteInto",1147],"(",["T_CONSTANT_ENCAPSED_STRING","'t2.child_id = t1.entity_id AND t1.is_child = ?'",1147],",",["T_WHITESPACE"," ",1147],["T_LNUMBER","0",1147],")",",",["T_WHITESPACE","\n                ",1147],["T_ARRAY","array",1148],"(",")",")",["T_WHITESPACE","\n            ",1148],["T_OBJECT_OPERATOR","->",1149],["T_STRING","where",1149],"(",["T_CONSTANT_ENCAPSED_STRING","'t2.is_child = ?'",1149],",",["T_WHITESPACE"," ",1149],["T_LNUMBER","1",1149],")",";",["T_WHITESPACE","\n\n        ",1149],["T_IF","if",1151],["T_WHITESPACE"," ",1151],"(",["T_VARIABLE","$productIds",1151],["T_WHITESPACE"," ",1151],["T_IS_NOT_IDENTICAL","!==",1151],["T_WHITESPACE"," ",1151],["T_STRING","null",1151],")",["T_WHITESPACE"," ",1151],"{",["T_WHITESPACE","\n            ",1151],["T_VARIABLE","$select",1152],["T_OBJECT_OPERATOR","->",1152],["T_STRING","where",1152],"(",["T_CONSTANT_ENCAPSED_STRING","'t2.child_id IN(?)'",1152],",",["T_WHITESPACE"," ",1152],["T_VARIABLE","$productIds",1152],")",";",["T_WHITESPACE","\n        ",1152],"}",["T_WHITESPACE","\n\n        ",1153],["T_VARIABLE","$sql",1155],["T_WHITESPACE"," ",1155],"=",["T_WHITESPACE"," ",1155],["T_VARIABLE","$select",1155],["T_OBJECT_OPERATOR","->",1155],["T_STRING","crossUpdateFromSelect",1155],"(",["T_ARRAY","array",1155],"(",["T_CONSTANT_ENCAPSED_STRING","'t2'",1155],["T_WHITESPACE"," ",1155],["T_DOUBLE_ARROW","=>",1155],["T_WHITESPACE"," ",1155],["T_VARIABLE","$this",1155],["T_OBJECT_OPERATOR","->",1155],["T_STRING","getFlatTableName",1155],"(",["T_VARIABLE","$storeId",1155],")",")",")",";",["T_WHITESPACE","\n        ",1155],["T_VARIABLE","$adapter",1156],["T_OBJECT_OPERATOR","->",1156],["T_STRING","query",1156],"(",["T_VARIABLE","$sql",1156],")",";",["T_WHITESPACE","\n\n        ",1156],["T_RETURN","return",1158],["T_WHITESPACE"," ",1158],["T_VARIABLE","$this",1158],";",["T_WHITESPACE","\n    ",1158],"}",["T_WHITESPACE","\n\n    ",1159],["T_DOC_COMMENT","\/**\n     * Clean unused relation products\n     *\n     * @param int $storeId\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1161],["T_WHITESPACE","\n    ",1166],["T_PUBLIC","public",1167],["T_WHITESPACE"," ",1167],["T_FUNCTION","function",1167],["T_WHITESPACE"," ",1167],["T_STRING","cleanRelationProducts",1167],"(",["T_VARIABLE","$storeId",1167],")",["T_WHITESPACE","\n    ",1167],"{",["T_WHITESPACE","\n        ",1168],["T_IF","if",1169],["T_WHITESPACE"," ",1169],"(","!",["T_VARIABLE","$this",1169],["T_OBJECT_OPERATOR","->",1169],["T_STRING","getFlatHelper",1169],"(",")",["T_OBJECT_OPERATOR","->",1169],["T_STRING","isAddChildData",1169],"(",")",")",["T_WHITESPACE"," ",1169],"{",["T_WHITESPACE","\n            ",1169],["T_RETURN","return",1170],["T_WHITESPACE"," ",1170],["T_VARIABLE","$this",1170],";",["T_WHITESPACE","\n        ",1170],"}",["T_WHITESPACE","\n\n        ",1171],["T_FOREACH","foreach",1173],["T_WHITESPACE"," ",1173],"(",["T_VARIABLE","$this",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","getProductTypeInstances",1173],"(",")",["T_WHITESPACE"," ",1173],["T_AS","as",1173],["T_WHITESPACE"," ",1173],["T_VARIABLE","$typeInstance",1173],")",["T_WHITESPACE"," ",1173],"{",["T_WHITESPACE","\n            ",1173],["T_IF","if",1174],["T_WHITESPACE"," ",1174],"(","!",["T_VARIABLE","$typeInstance",1174],["T_OBJECT_OPERATOR","->",1174],["T_STRING","isComposite",1174],"(",")",")",["T_WHITESPACE"," ",1174],"{",["T_WHITESPACE","\n                ",1174],["T_CONTINUE","continue",1175],";",["T_WHITESPACE","\n            ",1175],"}",["T_WHITESPACE","\n            ",1176],["T_VARIABLE","$adapter",1177],["T_WHITESPACE","  ",1177],"=",["T_WHITESPACE"," ",1177],["T_VARIABLE","$this",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","_getWriteAdapter",1177],"(",")",";",["T_WHITESPACE","\n            ",1177],["T_VARIABLE","$relation",1178],["T_WHITESPACE"," ",1178],"=",["T_WHITESPACE"," ",1178],["T_VARIABLE","$typeInstance",1178],["T_OBJECT_OPERATOR","->",1178],["T_STRING","getRelationInfo",1178],"(",")",";",["T_WHITESPACE","\n            ",1178],["T_IF","if",1179],["T_WHITESPACE"," ",1179],"(",["T_VARIABLE","$relation",1179],["T_WHITESPACE","\n                ",1179],["T_BOOLEAN_AND","&&",1180],["T_WHITESPACE"," ",1180],["T_VARIABLE","$relation",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","getTable",1180],"(",")",["T_WHITESPACE","\n                ",1180],["T_BOOLEAN_AND","&&",1181],["T_WHITESPACE"," ",1181],["T_VARIABLE","$relation",1181],["T_OBJECT_OPERATOR","->",1181],["T_STRING","getParentFieldName",1181],"(",")",["T_WHITESPACE","\n                ",1181],["T_BOOLEAN_AND","&&",1182],["T_WHITESPACE"," ",1182],["T_VARIABLE","$relation",1182],["T_OBJECT_OPERATOR","->",1182],["T_STRING","getChildFieldName",1182],"(",")",["T_WHITESPACE","\n            ",1182],")",["T_WHITESPACE"," ",1183],"{",["T_WHITESPACE","\n                ",1183],["T_VARIABLE","$select",1184],["T_WHITESPACE"," ",1184],"=",["T_WHITESPACE"," ",1184],["T_VARIABLE","$this",1184],["T_OBJECT_OPERATOR","->",1184],["T_STRING","_getWriteAdapter",1184],"(",")",["T_OBJECT_OPERATOR","->",1184],["T_STRING","select",1184],"(",")",["T_WHITESPACE","\n                    ",1184],["T_OBJECT_OPERATOR","->",1185],["T_STRING","distinct",1185],"(",["T_STRING","true",1185],")",["T_WHITESPACE","\n                    ",1185],["T_OBJECT_OPERATOR","->",1186],["T_STRING","from",1186],"(",["T_WHITESPACE","\n                        ",1186],["T_VARIABLE","$this",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","getTable",1187],"(",["T_VARIABLE","$relation",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","getTable",1187],"(",")",")",",",["T_WHITESPACE","\n                        ",1187],"\"",["T_CURLY_OPEN","{",1188],["T_VARIABLE","$relation",1188],["T_OBJECT_OPERATOR","->",1188],["T_STRING","getParentFieldName",1188],"(",")","}","\"",["T_WHITESPACE","\n                    ",1188],")",";",["T_WHITESPACE","\n                ",1189],["T_VARIABLE","$joinLeftCond",1190],["T_WHITESPACE"," ",1190],"=",["T_WHITESPACE"," ",1190],["T_ARRAY","array",1190],"(",["T_WHITESPACE","\n                    ",1190],"\"",["T_ENCAPSED_AND_WHITESPACE","e.entity_id = t.",1191],["T_CURLY_OPEN","{",1191],["T_VARIABLE","$relation",1191],["T_OBJECT_OPERATOR","->",1191],["T_STRING","getParentFieldName",1191],"(",")","}","\"",",",["T_WHITESPACE","\n                    ",1191],"\"",["T_ENCAPSED_AND_WHITESPACE","e.child_id = t.",1192],["T_CURLY_OPEN","{",1192],["T_VARIABLE","$relation",1192],["T_OBJECT_OPERATOR","->",1192],["T_STRING","getChildFieldName",1192],"(",")","}","\"",["T_WHITESPACE","\n                ",1192],")",";",["T_WHITESPACE","\n                ",1193],["T_IF","if",1194],["T_WHITESPACE"," ",1194],"(",["T_VARIABLE","$relation",1194],["T_OBJECT_OPERATOR","->",1194],["T_STRING","getWhere",1194],"(",")",["T_WHITESPACE"," ",1194],["T_IS_NOT_IDENTICAL","!==",1194],["T_WHITESPACE"," ",1194],["T_STRING","null",1194],")",["T_WHITESPACE"," ",1194],"{",["T_WHITESPACE","\n                    ",1194],["T_VARIABLE","$select",1195],["T_OBJECT_OPERATOR","->",1195],["T_STRING","where",1195],"(",["T_VARIABLE","$relation",1195],["T_OBJECT_OPERATOR","->",1195],["T_STRING","getWhere",1195],"(",")",")",";",["T_WHITESPACE","\n                    ",1195],["T_VARIABLE","$joinLeftCond",1196],"[","]",["T_WHITESPACE"," ",1196],"=",["T_WHITESPACE"," ",1196],["T_VARIABLE","$relation",1196],["T_OBJECT_OPERATOR","->",1196],["T_STRING","getWhere",1196],"(",")",";",["T_WHITESPACE","\n                ",1196],"}",["T_WHITESPACE","\n\n                ",1197],["T_VARIABLE","$entitySelect",1199],["T_WHITESPACE"," ",1199],"=",["T_WHITESPACE"," ",1199],["T_NEW","new",1199],["T_WHITESPACE"," ",1199],["T_STRING","Zend_Db_Expr",1199],"(",["T_VARIABLE","$select",1199],["T_OBJECT_OPERATOR","->",1199],["T_STRING","__toString",1199],"(",")",")",";",["T_WHITESPACE","\n\n                ",1199],["T_VARIABLE","$select",1201],["T_WHITESPACE"," ",1201],"=",["T_WHITESPACE"," ",1201],["T_VARIABLE","$adapter",1201],["T_OBJECT_OPERATOR","->",1201],["T_STRING","select",1201],"(",")",["T_WHITESPACE","\n                    ",1201],["T_OBJECT_OPERATOR","->",1202],["T_STRING","from",1202],"(",["T_ARRAY","array",1202],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",1202],["T_WHITESPACE"," ",1202],["T_DOUBLE_ARROW","=>",1202],["T_WHITESPACE"," ",1202],["T_VARIABLE","$this",1202],["T_OBJECT_OPERATOR","->",1202],["T_STRING","getFlatTableName",1202],"(",["T_VARIABLE","$storeId",1202],")",")",",",["T_WHITESPACE"," ",1202],["T_STRING","null",1202],")",["T_WHITESPACE","\n                    ",1202],["T_OBJECT_OPERATOR","->",1203],["T_STRING","joinLeft",1203],"(",["T_WHITESPACE","\n                        ",1203],["T_ARRAY","array",1204],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",1204],["T_WHITESPACE"," ",1204],["T_DOUBLE_ARROW","=>",1204],["T_WHITESPACE"," ",1204],["T_VARIABLE","$this",1204],["T_OBJECT_OPERATOR","->",1204],["T_STRING","getTable",1204],"(",["T_VARIABLE","$relation",1204],["T_OBJECT_OPERATOR","->",1204],["T_STRING","getTable",1204],"(",")",")",")",",",["T_WHITESPACE","\n                        ",1204],["T_STRING","implode",1205],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",1205],",",["T_WHITESPACE"," ",1205],["T_VARIABLE","$joinLeftCond",1205],")",",",["T_WHITESPACE","\n                        ",1205],["T_ARRAY","array",1206],"(",")",")",["T_WHITESPACE","\n                    ",1206],["T_OBJECT_OPERATOR","->",1207],["T_STRING","where",1207],"(",["T_CONSTANT_ENCAPSED_STRING","'e.is_child = ?'",1207],",",["T_WHITESPACE"," ",1207],["T_LNUMBER","1",1207],")",["T_WHITESPACE","\n                    ",1207],["T_OBJECT_OPERATOR","->",1208],["T_STRING","where",1208],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",1208],",",["T_WHITESPACE"," ",1208],["T_VARIABLE","$entitySelect",1208],")",["T_WHITESPACE","\n                    ",1208],["T_OBJECT_OPERATOR","->",1209],["T_STRING","where",1209],"(","\"",["T_ENCAPSED_AND_WHITESPACE","t.",1209],["T_CURLY_OPEN","{",1209],["T_VARIABLE","$relation",1209],["T_OBJECT_OPERATOR","->",1209],["T_STRING","getChildFieldName",1209],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," IS NULL",1209],"\"",")",";",["T_WHITESPACE","\n\n                ",1209],["T_VARIABLE","$sql",1211],["T_WHITESPACE"," ",1211],"=",["T_WHITESPACE"," ",1211],["T_VARIABLE","$select",1211],["T_OBJECT_OPERATOR","->",1211],["T_STRING","deleteFromSelect",1211],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",1211],")",";",["T_WHITESPACE","\n                ",1211],["T_VARIABLE","$adapter",1212],["T_OBJECT_OPERATOR","->",1212],["T_STRING","query",1212],"(",["T_VARIABLE","$sql",1212],")",";",["T_WHITESPACE","\n            ",1212],"}",["T_WHITESPACE","\n        ",1213],"}",["T_WHITESPACE","\n\n        ",1214],["T_RETURN","return",1216],["T_WHITESPACE"," ",1216],["T_VARIABLE","$this",1216],";",["T_WHITESPACE","\n    ",1216],"}",["T_WHITESPACE","\n\n    ",1217],["T_DOC_COMMENT","\/**\n     * Remove product data from flat\n     *\n     * @param int|array $productIds\n     * @param int $storeId\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1219],["T_WHITESPACE","\n    ",1225],["T_PUBLIC","public",1226],["T_WHITESPACE"," ",1226],["T_FUNCTION","function",1226],["T_WHITESPACE"," ",1226],["T_STRING","removeProduct",1226],"(",["T_VARIABLE","$productIds",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$storeId",1226],")",["T_WHITESPACE","\n    ",1226],"{",["T_WHITESPACE","\n        ",1227],["T_IF","if",1228],["T_WHITESPACE"," ",1228],"(","!",["T_VARIABLE","$this",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","_isFlatTableExists",1228],"(",["T_VARIABLE","$storeId",1228],")",")",["T_WHITESPACE"," ",1228],"{",["T_WHITESPACE","\n            ",1228],["T_RETURN","return",1229],["T_WHITESPACE"," ",1229],["T_VARIABLE","$this",1229],";",["T_WHITESPACE","\n        ",1229],"}",["T_WHITESPACE","\n        ",1230],["T_VARIABLE","$adapter",1231],["T_WHITESPACE"," ",1231],"=",["T_WHITESPACE"," ",1231],["T_VARIABLE","$this",1231],["T_OBJECT_OPERATOR","->",1231],["T_STRING","_getWriteAdapter",1231],"(",")",";",["T_WHITESPACE","\n        ",1231],["T_VARIABLE","$cond",1232],["T_WHITESPACE"," ",1232],"=",["T_WHITESPACE"," ",1232],["T_ARRAY","array",1232],"(",["T_WHITESPACE","\n            ",1232],["T_VARIABLE","$adapter",1233],["T_OBJECT_OPERATOR","->",1233],["T_STRING","quoteInto",1233],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",1233],",",["T_WHITESPACE"," ",1233],["T_VARIABLE","$productIds",1233],")",["T_WHITESPACE","\n        ",1233],")",";",["T_WHITESPACE","\n        ",1234],["T_IF","if",1235],["T_WHITESPACE"," ",1235],"(",["T_VARIABLE","$this",1235],["T_OBJECT_OPERATOR","->",1235],["T_STRING","getFlatHelper",1235],"(",")",["T_OBJECT_OPERATOR","->",1235],["T_STRING","isAddChildData",1235],"(",")",")",["T_WHITESPACE"," ",1235],"{",["T_WHITESPACE","\n            ",1235],["T_VARIABLE","$cond",1236],"[","]",["T_WHITESPACE"," ",1236],"=",["T_WHITESPACE"," ",1236],["T_VARIABLE","$adapter",1236],["T_OBJECT_OPERATOR","->",1236],["T_STRING","quoteInto",1236],"(",["T_CONSTANT_ENCAPSED_STRING","'child_id IN(?)'",1236],",",["T_WHITESPACE"," ",1236],["T_VARIABLE","$productIds",1236],")",";",["T_WHITESPACE","\n        ",1236],"}",["T_WHITESPACE","\n        ",1237],["T_VARIABLE","$cond",1238],["T_WHITESPACE"," ",1238],"=",["T_WHITESPACE"," ",1238],["T_STRING","implode",1238],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",1238],",",["T_WHITESPACE"," ",1238],["T_VARIABLE","$cond",1238],")",";",["T_WHITESPACE","\n        ",1238],["T_VARIABLE","$adapter",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","delete",1239],"(",["T_VARIABLE","$this",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","getFlatTableName",1239],"(",["T_VARIABLE","$storeId",1239],")",",",["T_WHITESPACE"," ",1239],["T_VARIABLE","$cond",1239],")",";",["T_WHITESPACE","\n\n        ",1239],["T_RETURN","return",1241],["T_WHITESPACE"," ",1241],["T_VARIABLE","$this",1241],";",["T_WHITESPACE","\n    ",1241],"}",["T_WHITESPACE","\n\n    ",1242],["T_DOC_COMMENT","\/**\n     * Remove children from parent product\n     *\n     * @param int|array $productIds\n     * @param int $storeId\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1244],["T_WHITESPACE","\n    ",1250],["T_PUBLIC","public",1251],["T_WHITESPACE"," ",1251],["T_FUNCTION","function",1251],["T_WHITESPACE"," ",1251],["T_STRING","removeProductChildren",1251],"(",["T_VARIABLE","$productIds",1251],",",["T_WHITESPACE"," ",1251],["T_VARIABLE","$storeId",1251],")",["T_WHITESPACE","\n    ",1251],"{",["T_WHITESPACE","\n        ",1252],["T_IF","if",1253],["T_WHITESPACE"," ",1253],"(","!",["T_VARIABLE","$this",1253],["T_OBJECT_OPERATOR","->",1253],["T_STRING","getFlatHelper",1253],"(",")",["T_OBJECT_OPERATOR","->",1253],["T_STRING","isAddChildData",1253],"(",")",")",["T_WHITESPACE"," ",1253],"{",["T_WHITESPACE","\n            ",1253],["T_RETURN","return",1254],["T_WHITESPACE"," ",1254],["T_VARIABLE","$this",1254],";",["T_WHITESPACE","\n        ",1254],"}",["T_WHITESPACE","\n        ",1255],["T_VARIABLE","$whereExpr",1256],["T_WHITESPACE"," ",1256],"=",["T_WHITESPACE"," ",1256],["T_ARRAY","array",1256],"(",["T_WHITESPACE","\n            ",1256],["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",1257],["T_WHITESPACE"," ",1257],["T_DOUBLE_ARROW","=>",1257],["T_WHITESPACE"," ",1257],["T_VARIABLE","$productIds",1257],",",["T_WHITESPACE","\n            ",1257],["T_CONSTANT_ENCAPSED_STRING","'is_child = ?'",1258],["T_WHITESPACE","    ",1258],["T_DOUBLE_ARROW","=>",1258],["T_WHITESPACE"," ",1258],["T_LNUMBER","1",1258],["T_WHITESPACE","\n        ",1258],")",";",["T_WHITESPACE","\n        ",1259],["T_VARIABLE","$this",1260],["T_OBJECT_OPERATOR","->",1260],["T_STRING","_getWriteAdapter",1260],"(",")",["T_OBJECT_OPERATOR","->",1260],["T_STRING","delete",1260],"(",["T_VARIABLE","$this",1260],["T_OBJECT_OPERATOR","->",1260],["T_STRING","getFlatTableName",1260],"(",["T_VARIABLE","$storeId",1260],")",",",["T_WHITESPACE"," ",1260],["T_VARIABLE","$whereExpr",1260],")",";",["T_WHITESPACE","\n\n        ",1260],["T_RETURN","return",1262],["T_WHITESPACE"," ",1262],["T_VARIABLE","$this",1262],";",["T_WHITESPACE","\n    ",1262],"}",["T_WHITESPACE","\n\n    ",1263],["T_DOC_COMMENT","\/**\n     * Update flat data for product\n     *\n     * @param int|array $productIds\n     * @param int $storeId\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1265],["T_WHITESPACE","\n    ",1271],["T_PUBLIC","public",1272],["T_WHITESPACE"," ",1272],["T_FUNCTION","function",1272],["T_WHITESPACE"," ",1272],["T_STRING","updateProduct",1272],"(",["T_VARIABLE","$productIds",1272],",",["T_WHITESPACE"," ",1272],["T_VARIABLE","$storeId",1272],")",["T_WHITESPACE","\n    ",1272],"{",["T_WHITESPACE","\n        ",1273],["T_IF","if",1274],["T_WHITESPACE"," ",1274],"(","!",["T_VARIABLE","$this",1274],["T_OBJECT_OPERATOR","->",1274],["T_STRING","_isFlatTableExists",1274],"(",["T_VARIABLE","$storeId",1274],")",")",["T_WHITESPACE"," ",1274],"{",["T_WHITESPACE","\n            ",1274],["T_RETURN","return",1275],["T_WHITESPACE"," ",1275],["T_VARIABLE","$this",1275],";",["T_WHITESPACE","\n        ",1275],"}",["T_WHITESPACE","\n\n        ",1276],["T_VARIABLE","$this",1278],["T_OBJECT_OPERATOR","->",1278],["T_STRING","saveProduct",1278],"(",["T_VARIABLE","$productIds",1278],",",["T_WHITESPACE"," ",1278],["T_VARIABLE","$storeId",1278],")",";",["T_WHITESPACE","\n\n        ",1278],["T_STRING","Mage",1280],["T_DOUBLE_COLON","::",1280],["T_STRING","dispatchEvent",1280],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_flat_update_product'",1280],",",["T_WHITESPACE"," ",1280],["T_ARRAY","array",1280],"(",["T_WHITESPACE","\n            ",1280],["T_CONSTANT_ENCAPSED_STRING","'store_id'",1281],["T_WHITESPACE","      ",1281],["T_DOUBLE_ARROW","=>",1281],["T_WHITESPACE"," ",1281],["T_VARIABLE","$storeId",1281],",",["T_WHITESPACE","\n            ",1281],["T_CONSTANT_ENCAPSED_STRING","'table'",1282],["T_WHITESPACE","         ",1282],["T_DOUBLE_ARROW","=>",1282],["T_WHITESPACE"," ",1282],["T_VARIABLE","$this",1282],["T_OBJECT_OPERATOR","->",1282],["T_STRING","getFlatTableName",1282],"(",["T_VARIABLE","$storeId",1282],")",",",["T_WHITESPACE","\n            ",1282],["T_CONSTANT_ENCAPSED_STRING","'product_ids'",1283],["T_WHITESPACE","   ",1283],["T_DOUBLE_ARROW","=>",1283],["T_WHITESPACE"," ",1283],["T_VARIABLE","$productIds",1283],["T_WHITESPACE","\n        ",1283],")",")",";",["T_WHITESPACE","\n\n        ",1284],["T_RETURN","return",1286],["T_WHITESPACE"," ",1286],["T_VARIABLE","$this",1286],";",["T_WHITESPACE","\n    ",1286],"}",["T_WHITESPACE","\n\n    ",1287],["T_DOC_COMMENT","\/**\n     * Save product(s) data for store\n     *\n     * @param int|array $productIds\n     * @param int $storeId\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1289],["T_WHITESPACE","\n    ",1295],["T_PUBLIC","public",1296],["T_WHITESPACE"," ",1296],["T_FUNCTION","function",1296],["T_WHITESPACE"," ",1296],["T_STRING","saveProduct",1296],"(",["T_VARIABLE","$productIds",1296],",",["T_WHITESPACE"," ",1296],["T_VARIABLE","$storeId",1296],")",["T_WHITESPACE","\n    ",1296],"{",["T_WHITESPACE","\n        ",1297],["T_IF","if",1298],["T_WHITESPACE"," ",1298],"(","!",["T_VARIABLE","$this",1298],["T_OBJECT_OPERATOR","->",1298],["T_STRING","_isFlatTableExists",1298],"(",["T_VARIABLE","$storeId",1298],")",")",["T_WHITESPACE"," ",1298],"{",["T_WHITESPACE","\n            ",1298],["T_RETURN","return",1299],["T_WHITESPACE"," ",1299],["T_VARIABLE","$this",1299],";",["T_WHITESPACE","\n        ",1299],"}",["T_WHITESPACE","\n\n        ",1300],["T_VARIABLE","$this",1302],["T_OBJECT_OPERATOR","->",1302],["T_STRING","updateStaticAttributes",1302],"(",["T_VARIABLE","$storeId",1302],",",["T_WHITESPACE"," ",1302],["T_VARIABLE","$productIds",1302],")",";",["T_WHITESPACE","\n        ",1302],["T_VARIABLE","$this",1303],["T_OBJECT_OPERATOR","->",1303],["T_STRING","updateEavAttributes",1303],"(",["T_VARIABLE","$storeId",1303],",",["T_WHITESPACE"," ",1303],["T_VARIABLE","$productIds",1303],")",";",["T_WHITESPACE","\n\n        ",1303],["T_RETURN","return",1305],["T_WHITESPACE"," ",1305],["T_VARIABLE","$this",1305],";",["T_WHITESPACE","\n    ",1305],"}",["T_WHITESPACE","\n\n    ",1306],["T_DOC_COMMENT","\/**\n     * Delete flat table process\n     *\n     * @param int $storeId\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1308],["T_WHITESPACE","\n    ",1313],["T_PUBLIC","public",1314],["T_WHITESPACE"," ",1314],["T_FUNCTION","function",1314],["T_WHITESPACE"," ",1314],["T_STRING","deleteFlatTable",1314],"(",["T_VARIABLE","$storeId",1314],")",["T_WHITESPACE","\n    ",1314],"{",["T_WHITESPACE","\n        ",1315],["T_IF","if",1316],["T_WHITESPACE"," ",1316],"(",["T_VARIABLE","$this",1316],["T_OBJECT_OPERATOR","->",1316],["T_STRING","_isFlatTableExists",1316],"(",["T_VARIABLE","$storeId",1316],")",")",["T_WHITESPACE"," ",1316],"{",["T_WHITESPACE","\n            ",1316],["T_VARIABLE","$this",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","_getWriteAdapter",1317],"(",")",["T_OBJECT_OPERATOR","->",1317],["T_STRING","dropTable",1317],"(",["T_VARIABLE","$this",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","getFlatTableName",1317],"(",["T_VARIABLE","$storeId",1317],")",")",";",["T_WHITESPACE","\n        ",1317],"}",["T_WHITESPACE","\n\n        ",1318],["T_RETURN","return",1320],["T_WHITESPACE"," ",1320],["T_VARIABLE","$this",1320],";",["T_WHITESPACE","\n    ",1320],"}",["T_WHITESPACE","\n\n    ",1321],["T_DOC_COMMENT","\/**\n     * Check is flat table for store exists\n     *\n     * @param int $storeId\n     * @return bool\n     *\/",1323],["T_WHITESPACE","\n    ",1328],["T_PROTECTED","protected",1329],["T_WHITESPACE"," ",1329],["T_FUNCTION","function",1329],["T_WHITESPACE"," ",1329],["T_STRING","_isFlatTableExists",1329],"(",["T_VARIABLE","$storeId",1329],")",["T_WHITESPACE","\n    ",1329],"{",["T_WHITESPACE","\n        ",1330],["T_IF","if",1331],["T_WHITESPACE"," ",1331],"(","!",["T_ISSET","isset",1331],"(",["T_VARIABLE","$this",1331],["T_OBJECT_OPERATOR","->",1331],["T_STRING","_existsFlatTables",1331],"[",["T_VARIABLE","$storeId",1331],"]",")",")",["T_WHITESPACE"," ",1331],"{",["T_WHITESPACE","\n            ",1331],["T_VARIABLE","$tableName",1332],["T_WHITESPACE","     ",1332],"=",["T_WHITESPACE"," ",1332],["T_VARIABLE","$this",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","getFlatTableName",1332],"(",["T_VARIABLE","$storeId",1332],")",";",["T_WHITESPACE","\n            ",1332],["T_VARIABLE","$isTableExists",1333],["T_WHITESPACE"," ",1333],"=",["T_WHITESPACE"," ",1333],["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","_getWriteAdapter",1333],"(",")",["T_OBJECT_OPERATOR","->",1333],["T_STRING","isTableExists",1333],"(",["T_VARIABLE","$tableName",1333],")",";",["T_WHITESPACE","\n\n            ",1333],["T_VARIABLE","$this",1335],["T_OBJECT_OPERATOR","->",1335],["T_STRING","_existsFlatTables",1335],"[",["T_VARIABLE","$storeId",1335],"]",["T_WHITESPACE"," ",1335],"=",["T_WHITESPACE"," ",1335],["T_VARIABLE","$isTableExists",1335],["T_WHITESPACE"," ",1335],"?",["T_WHITESPACE"," ",1335],["T_STRING","true",1335],["T_WHITESPACE"," ",1335],":",["T_WHITESPACE"," ",1335],["T_STRING","false",1335],";",["T_WHITESPACE","\n        ",1335],"}",["T_WHITESPACE","\n\n        ",1336],["T_RETURN","return",1338],["T_WHITESPACE"," ",1338],["T_VARIABLE","$this",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","_existsFlatTables",1338],"[",["T_VARIABLE","$storeId",1338],"]",";",["T_WHITESPACE","\n    ",1338],"}",["T_WHITESPACE","\n\n    ",1339],["T_DOC_COMMENT","\/**\n     * Retrieve previous key from array by key\n     *\n     * @param array $array\n     * @param mixed $key\n     * @return mixed\n     *\/",1341],["T_WHITESPACE","\n    ",1347],["T_PROTECTED","protected",1348],["T_WHITESPACE"," ",1348],["T_FUNCTION","function",1348],["T_WHITESPACE"," ",1348],["T_STRING","_arrayPrevKey",1348],"(",["T_ARRAY","array",1348],["T_WHITESPACE"," ",1348],["T_VARIABLE","$array",1348],",",["T_WHITESPACE"," ",1348],["T_VARIABLE","$key",1348],")",["T_WHITESPACE","\n    ",1348],"{",["T_WHITESPACE","\n        ",1349],["T_VARIABLE","$prev",1350],["T_WHITESPACE"," ",1350],"=",["T_WHITESPACE"," ",1350],["T_STRING","false",1350],";",["T_WHITESPACE","\n        ",1350],["T_FOREACH","foreach",1351],["T_WHITESPACE"," ",1351],"(",["T_STRING","array_keys",1351],"(",["T_VARIABLE","$array",1351],")",["T_WHITESPACE"," ",1351],["T_AS","as",1351],["T_WHITESPACE"," ",1351],["T_VARIABLE","$k",1351],")",["T_WHITESPACE"," ",1351],"{",["T_WHITESPACE","\n            ",1351],["T_IF","if",1352],["T_WHITESPACE"," ",1352],"(",["T_VARIABLE","$k",1352],["T_WHITESPACE"," ",1352],["T_IS_EQUAL","==",1352],["T_WHITESPACE"," ",1352],["T_VARIABLE","$key",1352],")",["T_WHITESPACE"," ",1352],"{",["T_WHITESPACE","\n                ",1352],["T_RETURN","return",1353],["T_WHITESPACE"," ",1353],["T_VARIABLE","$prev",1353],";",["T_WHITESPACE","\n            ",1353],"}",["T_WHITESPACE","\n            ",1354],["T_VARIABLE","$prev",1355],["T_WHITESPACE"," ",1355],"=",["T_WHITESPACE"," ",1355],["T_VARIABLE","$k",1355],";",["T_WHITESPACE","\n        ",1355],"}",["T_WHITESPACE","\n        ",1356],["T_RETURN","return",1357],["T_WHITESPACE"," ",1357],["T_STRING","false",1357],";",["T_WHITESPACE","\n    ",1357],"}",["T_WHITESPACE","\n\n    ",1358],["T_DOC_COMMENT","\/**\n     * Retrieve next key from array by key\n     *\n     * @param array $array\n     * @param mixed $key\n     * @return mixed\n     *\/",1360],["T_WHITESPACE","\n    ",1366],["T_PROTECTED","protected",1367],["T_WHITESPACE"," ",1367],["T_FUNCTION","function",1367],["T_WHITESPACE"," ",1367],["T_STRING","_arrayNextKey",1367],"(",["T_ARRAY","array",1367],["T_WHITESPACE"," ",1367],["T_VARIABLE","$array",1367],",",["T_WHITESPACE"," ",1367],["T_VARIABLE","$key",1367],")",["T_WHITESPACE","\n    ",1367],"{",["T_WHITESPACE","\n        ",1368],["T_VARIABLE","$next",1369],["T_WHITESPACE"," ",1369],"=",["T_WHITESPACE"," ",1369],["T_STRING","false",1369],";",["T_WHITESPACE","\n        ",1369],["T_FOREACH","foreach",1370],["T_WHITESPACE"," ",1370],"(",["T_STRING","array_keys",1370],"(",["T_VARIABLE","$array",1370],")",["T_WHITESPACE"," ",1370],["T_AS","as",1370],["T_WHITESPACE"," ",1370],["T_VARIABLE","$k",1370],")",["T_WHITESPACE"," ",1370],"{",["T_WHITESPACE","\n            ",1370],["T_IF","if",1371],["T_WHITESPACE"," ",1371],"(",["T_VARIABLE","$next",1371],["T_WHITESPACE"," ",1371],["T_IS_IDENTICAL","===",1371],["T_WHITESPACE"," ",1371],["T_STRING","true",1371],")",["T_WHITESPACE"," ",1371],"{",["T_WHITESPACE","\n                ",1371],["T_RETURN","return",1372],["T_WHITESPACE"," ",1372],["T_VARIABLE","$k",1372],";",["T_WHITESPACE","\n            ",1372],"}",["T_WHITESPACE","\n            ",1373],["T_IF","if",1374],["T_WHITESPACE"," ",1374],"(",["T_VARIABLE","$k",1374],["T_WHITESPACE"," ",1374],["T_IS_EQUAL","==",1374],["T_WHITESPACE"," ",1374],["T_VARIABLE","$key",1374],")",["T_WHITESPACE"," ",1374],"{",["T_WHITESPACE","\n                ",1374],["T_VARIABLE","$next",1375],["T_WHITESPACE"," ",1375],"=",["T_WHITESPACE"," ",1375],["T_STRING","true",1375],";",["T_WHITESPACE","\n            ",1375],"}",["T_WHITESPACE","\n        ",1376],"}",["T_WHITESPACE","\n        ",1377],["T_RETURN","return",1378],["T_WHITESPACE"," ",1378],["T_STRING","false",1378],";",["T_WHITESPACE","\n    ",1378],"}",["T_WHITESPACE","\n\n    ",1379],["T_DOC_COMMENT","\/**\n     * Transactional rebuild Catalog Product Flat Data\n     *\n     * @return Mage_Catalog_Model_Resource_Product_Flat_Indexer\n     *\/",1381],["T_WHITESPACE","\n    ",1385],["T_PUBLIC","public",1386],["T_WHITESPACE"," ",1386],["T_FUNCTION","function",1386],["T_WHITESPACE"," ",1386],["T_STRING","reindexAll",1386],"(",")",["T_WHITESPACE","\n    ",1386],"{",["T_WHITESPACE","\n        ",1387],["T_FOREACH","foreach",1388],["T_WHITESPACE"," ",1388],"(",["T_STRING","Mage",1388],["T_DOUBLE_COLON","::",1388],["T_STRING","app",1388],"(",")",["T_OBJECT_OPERATOR","->",1388],["T_STRING","getStores",1388],"(",")",["T_WHITESPACE"," ",1388],["T_AS","as",1388],["T_WHITESPACE"," ",1388],["T_VARIABLE","$storeId",1388],["T_WHITESPACE"," ",1388],["T_DOUBLE_ARROW","=>",1388],["T_WHITESPACE"," ",1388],["T_VARIABLE","$store",1388],")",["T_WHITESPACE"," ",1388],"{",["T_WHITESPACE","\n            ",1388],["T_VARIABLE","$this",1389],["T_OBJECT_OPERATOR","->",1389],["T_STRING","prepareFlatTable",1389],"(",["T_VARIABLE","$storeId",1389],")",";",["T_WHITESPACE","\n            ",1389],["T_VARIABLE","$this",1390],["T_OBJECT_OPERATOR","->",1390],["T_STRING","beginTransaction",1390],"(",")",";",["T_WHITESPACE","\n            ",1390],["T_TRY","try",1391],["T_WHITESPACE"," ",1391],"{",["T_WHITESPACE","\n                ",1391],["T_VARIABLE","$this",1392],["T_OBJECT_OPERATOR","->",1392],["T_STRING","rebuild",1392],"(",["T_VARIABLE","$store",1392],")",";",["T_WHITESPACE","\n                ",1392],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","commit",1393],"(",")",";",["T_WHITESPACE","\n           ",1393],"}",["T_WHITESPACE"," ",1394],["T_CATCH","catch",1394],["T_WHITESPACE"," ",1394],"(",["T_STRING","Exception",1394],["T_WHITESPACE"," ",1394],["T_VARIABLE","$e",1394],")",["T_WHITESPACE"," ",1394],"{",["T_WHITESPACE","\n                ",1394],["T_VARIABLE","$this",1395],["T_OBJECT_OPERATOR","->",1395],["T_STRING","rollBack",1395],"(",")",";",["T_WHITESPACE","\n                ",1395],["T_THROW","throw",1396],["T_WHITESPACE"," ",1396],["T_VARIABLE","$e",1396],";",["T_WHITESPACE","\n           ",1396],"}",["T_WHITESPACE","\n        ",1397],"}",["T_WHITESPACE","\n\n        ",1398],["T_RETURN","return",1400],["T_WHITESPACE"," ",1400],["T_VARIABLE","$this",1400],";",["T_WHITESPACE","\n    ",1400],"}",["T_WHITESPACE","\n",1401],"}",["T_WHITESPACE","\n",1402]]