[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Layer attribute filter\n *\n * @category   Mage\n * @package    Mage_Catalog\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Layer_Filter_Attribute",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Layer_Filter_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","OPTIONS_ONLY_WITH_RESULTS",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_LNUMBER","1",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Resource instance\n     *\n     * @var Mage_Catalog_Model_Resource_Eav_Mysql4_Layer_Filter_Attribute\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_resource",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Construct attribute filter\n     *\n     *\/",45],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","__construct",49],"(",")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_STRING","parent",51],["T_DOUBLE_COLON","::",51],["T_STRING","__construct",51],"(",")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_requestVar",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'attribute'",52],";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Retrieve resource instance\n     *\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Layer_Filter_Attribute\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","_getResource",60],"(",")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_STRING","is_null",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_resource",62],")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_resource",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","Mage",63],["T_DOUBLE_COLON","::",63],["T_STRING","getResourceModel",63],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/layer_filter_attribute'",63],")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_resource",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Get option text from frontend model by option id\n     *\n     * @param   int $optionId\n     * @return  string|bool\n     *\/",68],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","_getOptionText",74],"(",["T_VARIABLE","$optionId",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getAttributeModel",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","getFrontend",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","getOption",76],"(",["T_VARIABLE","$optionId",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Apply attribute option filter to product collection\n     *\n     * @param   Zend_Controller_Request_Abstract $request\n     * @param   Varien_Object $filterBlock\n     * @return  Mage_Catalog_Model_Layer_Filter_Attribute\n     *\/",79],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","apply",86],"(",["T_STRING","Zend_Controller_Request_Abstract",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$request",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$filterBlock",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$filter",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$request",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getParam",88],"(",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_requestVar",88],")",";",["T_WHITESPACE","\n        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_STRING","is_array",89],"(",["T_VARIABLE","$filter",89],")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_RETURN","return",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$text",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_getOptionText",92],"(",["T_VARIABLE","$filter",92],")",";",["T_WHITESPACE","\n        ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$filter",93],["T_WHITESPACE"," ",93],["T_BOOLEAN_AND","&&",93],["T_WHITESPACE"," ",93],["T_STRING","strlen",93],"(",["T_VARIABLE","$text",93],")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_getResource",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","applyFilterToCollection",94],"(",["T_VARIABLE","$this",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$filter",94],")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getLayer",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getState",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","addFilter",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_createItem",95],"(",["T_VARIABLE","$text",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$filter",95],")",")",";",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_items",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Check whether specified attribute can be used in LN\n     *\n     * @param Mage_Catalog_Model_Resource_Eav_Attribute $attribute\n     * @return bool\n     *\/",101],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","_getIsFilterableAttribute",107],"(",["T_VARIABLE","$attribute",107],")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$attribute",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getIsFilterable",109],"(",")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Get data array for building attribute filter items\n     *\n     * @return array\n     *\/",112],["T_WHITESPACE","\n    ",116],["T_PROTECTED","protected",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","_getItemsData",117],"(",")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$attribute",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getAttributeModel",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_requestVar",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$attribute",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getAttributeCode",120],"(",")",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$key",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getLayer",122],"(",")",["T_OBJECT_OPERATOR","->",122],["T_STRING","getStateKey",122],"(",")",".",["T_CONSTANT_ENCAPSED_STRING","'_'",122],".",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_requestVar",122],";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$data",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getLayer",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getAggregator",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getCacheData",123],"(",["T_VARIABLE","$key",123],")",";",["T_WHITESPACE","\n\n        ",123],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$data",125],["T_WHITESPACE"," ",125],["T_IS_IDENTICAL","===",125],["T_WHITESPACE"," ",125],["T_STRING","null",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$options",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$attribute",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getFrontend",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getSelectOptions",126],"(",")",";",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$optionsCount",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_getResource",127],"(",")",["T_OBJECT_OPERATOR","->",127],["T_STRING","getCount",127],"(",["T_VARIABLE","$this",127],")",";",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$data",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_ARRAY","array",128],"(",")",";",["T_WHITESPACE","\n            ",128],["T_FOREACH","foreach",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$options",129],["T_WHITESPACE"," ",129],["T_AS","as",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$option",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_STRING","is_array",130],"(",["T_VARIABLE","$option",130],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",130],"]",")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                    ",130],["T_CONTINUE","continue",131],";",["T_WHITESPACE","\n                ",131],"}",["T_WHITESPACE","\n                ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_STRING","Mage",133],["T_DOUBLE_COLON","::",133],["T_STRING","helper",133],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",133],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","strlen",133],"(",["T_VARIABLE","$option",133],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",133],"]",")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                    ",133],["T_COMMENT","\/\/ Check filter type\n",134],["T_WHITESPACE","                    ",135],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_getIsFilterableAttribute",135],"(",["T_VARIABLE","$attribute",135],")",["T_WHITESPACE"," ",135],["T_IS_EQUAL","==",135],["T_WHITESPACE"," ",135],["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","OPTIONS_ONLY_WITH_RESULTS",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                        ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(","!",["T_EMPTY","empty",136],"(",["T_VARIABLE","$optionsCount",136],"[",["T_VARIABLE","$option",136],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",136],"]","]",")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                            ",136],["T_VARIABLE","$data",137],"[","]",["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_ARRAY","array",137],"(",["T_WHITESPACE","\n                                ",137],["T_CONSTANT_ENCAPSED_STRING","'label'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$option",138],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",138],"]",",",["T_WHITESPACE","\n                                ",138],["T_CONSTANT_ENCAPSED_STRING","'value'",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$option",139],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",139],"]",",",["T_WHITESPACE","\n                                ",139],["T_CONSTANT_ENCAPSED_STRING","'count'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$optionsCount",140],"[",["T_VARIABLE","$option",140],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",140],"]","]",",",["T_WHITESPACE","\n                            ",140],")",";",["T_WHITESPACE","\n                        ",141],"}",["T_WHITESPACE","\n                    ",142],"}",["T_WHITESPACE","\n                    ",143],["T_ELSE","else",144],["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                        ",144],["T_VARIABLE","$data",145],"[","]",["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",["T_WHITESPACE","\n                            ",145],["T_CONSTANT_ENCAPSED_STRING","'label'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$option",146],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",146],"]",",",["T_WHITESPACE","\n                            ",146],["T_CONSTANT_ENCAPSED_STRING","'value'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$option",147],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",147],"]",",",["T_WHITESPACE","\n                            ",147],["T_CONSTANT_ENCAPSED_STRING","'count'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_ISSET","isset",148],"(",["T_VARIABLE","$optionsCount",148],"[",["T_VARIABLE","$option",148],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",148],"]","]",")",["T_WHITESPACE"," ",148],"?",["T_WHITESPACE"," ",148],["T_VARIABLE","$optionsCount",148],"[",["T_VARIABLE","$option",148],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",148],"]","]",["T_WHITESPACE"," ",148],":",["T_WHITESPACE"," ",148],["T_LNUMBER","0",148],",",["T_WHITESPACE","\n                        ",148],")",";",["T_WHITESPACE","\n                    ",149],"}",["T_WHITESPACE","\n                ",150],"}",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n\n            ",152],["T_VARIABLE","$tags",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_ARRAY","array",154],"(",["T_WHITESPACE","\n                ",154],["T_STRING","Mage_Eav_Model_Entity_Attribute",155],["T_DOUBLE_COLON","::",155],["T_STRING","CACHE_TAG",155],".",["T_CONSTANT_ENCAPSED_STRING","':'",155],".",["T_VARIABLE","$attribute",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getId",155],"(",")",["T_WHITESPACE","\n            ",155],")",";",["T_WHITESPACE","\n\n            ",156],["T_VARIABLE","$tags",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getLayer",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getStateTags",158],"(",["T_VARIABLE","$tags",158],")",";",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getLayer",159],"(",")",["T_OBJECT_OPERATOR","->",159],["T_STRING","getAggregator",159],"(",")",["T_OBJECT_OPERATOR","->",159],["T_STRING","saveCacheData",159],"(",["T_VARIABLE","$data",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$key",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$tags",159],")",";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n        ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$data",161],";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n",162],"}",["T_WHITESPACE","\n",163]]