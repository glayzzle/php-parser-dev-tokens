[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog Category Flat Indexer Model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Category_Indexer_Flat",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Index_Model_Indexer_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Data key for matching result to be saved in\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","EVENT_MATCH_RESULT_KEY",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_match_result'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Matched entity events\n     *\n     * @var array\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_matchedEntities",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_ARRAY","array",47],"(",["T_WHITESPACE","\n        ",47],["T_STRING","Mage_Catalog_Model_Category",48],["T_DOUBLE_COLON","::",48],["T_STRING","ENTITY",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_WHITESPACE","\n            ",48],["T_STRING","Mage_Index_Model_Event",49],["T_DOUBLE_COLON","::",49],["T_STRING","TYPE_SAVE",49],["T_WHITESPACE","\n        ",49],")",",",["T_WHITESPACE","\n        ",50],["T_STRING","Mage_Core_Model_Store",51],["T_DOUBLE_COLON","::",51],["T_STRING","ENTITY",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_ARRAY","array",51],"(",["T_WHITESPACE","\n            ",51],["T_STRING","Mage_Index_Model_Event",52],["T_DOUBLE_COLON","::",52],["T_STRING","TYPE_SAVE",52],",",["T_WHITESPACE","\n            ",52],["T_STRING","Mage_Index_Model_Event",53],["T_DOUBLE_COLON","::",53],["T_STRING","TYPE_DELETE",53],["T_WHITESPACE","\n        ",53],")",",",["T_WHITESPACE","\n        ",54],["T_STRING","Mage_Core_Model_Store_Group",55],["T_DOUBLE_COLON","::",55],["T_STRING","ENTITY",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_ARRAY","array",55],"(",["T_WHITESPACE","\n            ",55],["T_STRING","Mage_Index_Model_Event",56],["T_DOUBLE_COLON","::",56],["T_STRING","TYPE_SAVE",56],["T_WHITESPACE","\n        ",56],")",",",["T_WHITESPACE","\n    ",57],")",";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Whether the indexer should be displayed on process\/list page\n     *\n     * @return bool\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","isVisible",65],"(",")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_DOC_COMMENT","\/** @var $categoryFlatHelper Mage_Catalog_Helper_Category_Flat *\/",67],["T_WHITESPACE","\n        ",67],["T_VARIABLE","$categoryFlatHelper",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","helper",68],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",68],")",";",["T_WHITESPACE","\n        ",68],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$categoryFlatHelper",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","isEnabled",69],"(",")",["T_WHITESPACE"," ",69],["T_BOOLEAN_OR","||",69],["T_WHITESPACE"," ",69],"!",["T_VARIABLE","$categoryFlatHelper",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","isBuilt",69],"(",")",";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Retrieve Indexer name\n     *\n     * @return string\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","getName",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_STRING","Mage",79],["T_DOUBLE_COLON","::",79],["T_STRING","helper",79],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",79],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","__",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Category Flat Data'",79],")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Retrieve Indexer description\n     *\n     * @return string\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","getDescription",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_STRING","Mage",89],["T_DOUBLE_COLON","::",89],["T_STRING","helper",89],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",89],")",["T_OBJECT_OPERATOR","->",89],["T_STRING","__",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Reorganize EAV category structure to flat structure'",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Retrieve Catalog Category Flat Indexer model\n     *\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Flat\n     *\/",92],["T_WHITESPACE","\n    ",96],["T_PROTECTED","protected",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","_getIndexer",97],"(",")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_STRING","Mage",99],["T_DOUBLE_COLON","::",99],["T_STRING","getResourceSingleton",99],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Check if event can be matched by process\n     * Overwrote for check is flat catalog category is enabled and specific save\n     * category, store, store_group\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return bool\n     *\/",102],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","matchEvent",110],"(",["T_STRING","Mage_Index_Model_Event",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$event",110],")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_DOC_COMMENT","\/** @var $categoryFlatHelper Mage_Catalog_Helper_Category_Flat *\/",112],["T_WHITESPACE","\n        ",112],["T_VARIABLE","$categoryFlatHelper",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","Mage",113],["T_DOUBLE_COLON","::",113],["T_STRING","helper",113],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",113],")",";",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(","!",["T_VARIABLE","$categoryFlatHelper",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","isAccessible",114],"(",")",["T_WHITESPACE"," ",114],["T_BOOLEAN_OR","||",114],["T_WHITESPACE"," ",114],"!",["T_VARIABLE","$categoryFlatHelper",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","isBuilt",114],"(",")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_STRING","false",115],";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$data",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$event",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getNewData",118],"(",")",";",["T_WHITESPACE","\n        ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_ISSET","isset",119],"(",["T_VARIABLE","$data",119],"[",["T_STRING","self",119],["T_DOUBLE_COLON","::",119],["T_STRING","EVENT_MATCH_RESULT_KEY",119],"]",")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$data",120],"[",["T_STRING","self",120],["T_DOUBLE_COLON","::",120],["T_STRING","EVENT_MATCH_RESULT_KEY",120],"]",";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n\n        ",121],["T_VARIABLE","$entity",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$event",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getEntity",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$entity",124],["T_WHITESPACE"," ",124],["T_IS_EQUAL","==",124],["T_WHITESPACE"," ",124],["T_STRING","Mage_Core_Model_Store",124],["T_DOUBLE_COLON","::",124],["T_STRING","ENTITY",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$event",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getType",125],"(",")",["T_WHITESPACE"," ",125],["T_IS_EQUAL","==",125],["T_WHITESPACE"," ",125],["T_STRING","Mage_Index_Model_Event",125],["T_DOUBLE_COLON","::",125],["T_STRING","TYPE_DELETE",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$result",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","true",126],";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE"," ",127],["T_ELSEIF","elseif",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$event",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getType",127],"(",")",["T_WHITESPACE"," ",127],["T_IS_EQUAL","==",127],["T_WHITESPACE"," ",127],["T_STRING","Mage_Index_Model_Event",127],["T_DOUBLE_COLON","::",127],["T_STRING","TYPE_SAVE",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_DOC_COMMENT","\/** @var $store Mage_Core_Model_Store *\/",128],["T_WHITESPACE","\n                ",128],["T_VARIABLE","$store",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$event",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getDataObject",129],"(",")",";",["T_WHITESPACE","\n                ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$store",130],["T_WHITESPACE"," ",130],["T_BOOLEAN_AND","&&",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$store",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","isObjectNew",130],"(",")",["T_WHITESPACE","\n                    ",130],["T_BOOLEAN_OR","||",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$store",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","dataHasChangedFor",131],"(",["T_CONSTANT_ENCAPSED_STRING","'group_id'",131],")",["T_WHITESPACE","\n                    ",131],["T_BOOLEAN_OR","||",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$store",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","dataHasChangedFor",132],"(",["T_CONSTANT_ENCAPSED_STRING","'root_category_id'",132],")",["T_WHITESPACE","\n                ",132],")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                    ",133],["T_VARIABLE","$result",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","true",134],";",["T_WHITESPACE","\n                ",134],"}",["T_WHITESPACE"," ",135],["T_ELSE","else",135],["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                    ",135],["T_VARIABLE","$result",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","false",136],";",["T_WHITESPACE","\n                ",136],"}",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE"," ",138],["T_ELSE","else",138],["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$result",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","false",139],";",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE"," ",141],["T_ELSEIF","elseif",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$entity",141],["T_WHITESPACE"," ",141],["T_IS_EQUAL","==",141],["T_WHITESPACE"," ",141],["T_STRING","Mage_Core_Model_Store_Group",141],["T_DOUBLE_COLON","::",141],["T_STRING","ENTITY",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_DOC_COMMENT","\/** @var $storeGroup Mage_Core_Model_Store_Group *\/",142],["T_WHITESPACE","\n            ",142],["T_VARIABLE","$storeGroup",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$event",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getDataObject",143],"(",")",";",["T_WHITESPACE","\n            ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$storeGroup",144],["T_WHITESPACE","\n                ",144],["T_BOOLEAN_AND","&&",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$storeGroup",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","dataHasChangedFor",145],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",145],")",["T_WHITESPACE"," ",145],["T_BOOLEAN_OR","||",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$storeGroup",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","dataHasChangedFor",145],"(",["T_CONSTANT_ENCAPSED_STRING","'root_category_id'",145],")",")",["T_WHITESPACE","\n            ",145],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                ",146],["T_VARIABLE","$result",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","true",147],";",["T_WHITESPACE","\n            ",147],"}",["T_WHITESPACE"," ",148],["T_ELSE","else",148],["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n                ",148],["T_VARIABLE","$result",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","false",149],";",["T_WHITESPACE","\n            ",149],"}",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE"," ",151],["T_ELSE","else",151],["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$result",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","parent",152],["T_DOUBLE_COLON","::",152],["T_STRING","matchEvent",152],"(",["T_VARIABLE","$event",152],")",";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n\n        ",153],["T_VARIABLE","$event",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","addNewData",155],"(",["T_STRING","self",155],["T_DOUBLE_COLON","::",155],["T_STRING","EVENT_MATCH_RESULT_KEY",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$result",155],")",";",["T_WHITESPACE","\n\n        ",155],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$result",157],";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Register data required by process in event object\n     *\n     * @param Mage_Index_Model_Event $event\n     *\/",160],["T_WHITESPACE","\n    ",164],["T_PROTECTED","protected",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","_registerEvent",165],"(",["T_STRING","Mage_Index_Model_Event",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$event",165],")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$event",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","addNewData",167],"(",["T_STRING","self",167],["T_DOUBLE_COLON","::",167],["T_STRING","EVENT_MATCH_RESULT_KEY",167],",",["T_WHITESPACE"," ",167],["T_STRING","true",167],")",";",["T_WHITESPACE","\n        ",167],["T_SWITCH","switch",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$event",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getEntity",168],"(",")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_CASE","case",169],["T_WHITESPACE"," ",169],["T_STRING","Mage_Catalog_Model_Category",169],["T_DOUBLE_COLON","::",169],["T_STRING","ENTITY",169],":",["T_WHITESPACE","\n                ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_registerCatalogCategoryEvent",170],"(",["T_VARIABLE","$event",170],")",";",["T_WHITESPACE","\n                ",170],["T_BREAK","break",171],";",["T_WHITESPACE","\n\n            ",171],["T_CASE","case",173],["T_WHITESPACE"," ",173],["T_STRING","Mage_Core_Model_Store",173],["T_DOUBLE_COLON","::",173],["T_STRING","ENTITY",173],":",["T_WHITESPACE","\n                ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$event",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getType",174],"(",")",["T_WHITESPACE"," ",174],["T_IS_EQUAL","==",174],["T_WHITESPACE"," ",174],["T_STRING","Mage_Index_Model_Event",174],["T_DOUBLE_COLON","::",174],["T_STRING","TYPE_DELETE",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n                    ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_registerCoreStoreEvent",175],"(",["T_VARIABLE","$event",175],")",";",["T_WHITESPACE","\n                    ",175],["T_BREAK","break",176],";",["T_WHITESPACE","\n                ",176],"}",["T_WHITESPACE","\n            ",177],["T_CASE","case",178],["T_WHITESPACE"," ",178],["T_STRING","Mage_Core_Model_Store_Group",178],["T_DOUBLE_COLON","::",178],["T_STRING","ENTITY",178],":",["T_WHITESPACE","\n                ",178],["T_VARIABLE","$event",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","addNewData",179],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_skip_call_event_handler'",179],",",["T_WHITESPACE"," ",179],["T_STRING","true",179],")",";",["T_WHITESPACE","\n                ",179],["T_VARIABLE","$process",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$event",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getProcess",180],"(",")",";",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$process",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","changeStatus",181],"(",["T_STRING","Mage_Index_Model_Process",181],["T_DOUBLE_COLON","::",181],["T_STRING","STATUS_REQUIRE_REINDEX",181],")",";",["T_WHITESPACE","\n                ",181],["T_BREAK","break",182],";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n\n    ",184],["T_DOC_COMMENT","\/**\n     * Register data required by catalog category process in event object\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Catalog_Model_Category_Indexer_Flat\n     *\/",186],["T_WHITESPACE","\n    ",191],["T_PROTECTED","protected",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","_registerCatalogCategoryEvent",192],"(",["T_STRING","Mage_Index_Model_Event",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$event",192],")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_SWITCH","switch",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$event",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getType",194],"(",")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_CASE","case",195],["T_WHITESPACE"," ",195],["T_STRING","Mage_Index_Model_Event",195],["T_DOUBLE_COLON","::",195],["T_STRING","TYPE_SAVE",195],":",["T_WHITESPACE","\n                ",195],["T_COMMENT","\/* @var $category Mage_Catalog_Model_Category *\/",196],["T_WHITESPACE","\n                ",196],["T_VARIABLE","$category",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$event",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getDataObject",197],"(",")",";",["T_WHITESPACE","\n\n                ",197],["T_DOC_COMMENT","\/**\n                 * Check if category has another affected category ids (category move result)\n                 *\/",199],["T_WHITESPACE","\n                ",201],["T_VARIABLE","$affectedCategoryIds",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$category",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getAffectedCategoryIds",202],"(",")",";",["T_WHITESPACE","\n                ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$affectedCategoryIds",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                    ",203],["T_VARIABLE","$event",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","addNewData",204],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_affected_category_ids'",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$affectedCategoryIds",204],")",";",["T_WHITESPACE","\n                ",204],"}",["T_WHITESPACE"," ",205],["T_ELSE","else",205],["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                    ",205],["T_VARIABLE","$event",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","addNewData",206],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_category_id'",206],",",["T_WHITESPACE"," ",206],["T_VARIABLE","$category",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getId",206],"(",")",")",";",["T_WHITESPACE","\n                ",206],"}",["T_WHITESPACE","\n\n                ",207],["T_BREAK","break",209],";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Register core store delete process\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Catalog_Model_Category_Indexer_Flat\n     *\/",214],["T_WHITESPACE","\n    ",219],["T_PROTECTED","protected",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","_registerCoreStoreEvent",220],"(",["T_STRING","Mage_Index_Model_Event",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$event",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(",["T_VARIABLE","$event",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getType",222],"(",")",["T_WHITESPACE"," ",222],["T_IS_EQUAL","==",222],["T_WHITESPACE"," ",222],["T_STRING","Mage_Index_Model_Event",222],["T_DOUBLE_COLON","::",222],["T_STRING","TYPE_DELETE",222],")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_COMMENT","\/* @var $store Mage_Core_Model_Store *\/",223],["T_WHITESPACE","\n            ",223],["T_VARIABLE","$store",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$event",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getDataObject",224],"(",")",";",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$event",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","addNewData",225],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_delete_store_id'",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$store",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getId",225],"(",")",")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_DOC_COMMENT","\/**\n     * Process event\n     *\n     * @param Mage_Index_Model_Event $event\n     *\/",230],["T_WHITESPACE","\n    ",234],["T_PROTECTED","protected",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","_processEvent",235],"(",["T_STRING","Mage_Index_Model_Event",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$event",235],")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$data",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$event",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getNewData",237],"(",")",";",["T_WHITESPACE","\n\n        ",237],["T_IF","if",239],["T_WHITESPACE"," ",239],"(","!",["T_EMPTY","empty",239],"(",["T_VARIABLE","$data",239],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_reindex_all'",239],"]",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","reindexAll",240],"(",")",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE"," ",241],["T_ELSE","else",241],["T_WHITESPACE"," ",241],["T_IF","if",241],["T_WHITESPACE"," ",241],"(","!",["T_EMPTY","empty",241],"(",["T_VARIABLE","$data",241],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_category_id'",241],"]",")",")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_COMMENT","\/\/ catalog_product save\n",242],["T_WHITESPACE","            ",243],["T_VARIABLE","$categoryId",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$data",243],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_category_id'",243],"]",";",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_getIndexer",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","synchronize",244],"(",["T_VARIABLE","$categoryId",244],")",";",["T_WHITESPACE","\n        ",244],"}",["T_WHITESPACE"," ",245],["T_ELSE","else",245],["T_WHITESPACE"," ",245],["T_IF","if",245],["T_WHITESPACE"," ",245],"(","!",["T_EMPTY","empty",245],"(",["T_VARIABLE","$data",245],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_affected_category_ids'",245],"]",")",")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$categoryIds",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$data",246],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_affected_category_ids'",246],"]",";",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_getIndexer",247],"(",")",["T_OBJECT_OPERATOR","->",247],["T_STRING","move",247],"(",["T_VARIABLE","$categoryIds",247],")",";",["T_WHITESPACE","\n        ",247],"}",["T_WHITESPACE"," ",248],["T_ELSE","else",248],["T_WHITESPACE"," ",248],["T_IF","if",248],["T_WHITESPACE"," ",248],"(","!",["T_EMPTY","empty",248],"(",["T_VARIABLE","$data",248],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_delete_store_id'",248],"]",")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$storeId",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$data",249],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_flat_delete_store_id'",249],"]",";",["T_WHITESPACE","\n            ",249],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_getIndexer",250],"(",")",["T_OBJECT_OPERATOR","->",250],["T_STRING","deleteStores",250],"(",["T_VARIABLE","$storeId",250],")",";",["T_WHITESPACE","\n        ",250],"}",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Rebuild all index data\n     *\n     *\/",254],["T_WHITESPACE","\n    ",257],["T_PUBLIC","public",258],["T_WHITESPACE"," ",258],["T_FUNCTION","function",258],["T_WHITESPACE"," ",258],["T_STRING","reindexAll",258],"(",")",["T_WHITESPACE","\n    ",258],"{",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_getIndexer",260],"(",")",["T_OBJECT_OPERATOR","->",260],["T_STRING","reindexAll",260],"(",")",";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n",261],"}",["T_WHITESPACE","\n",262]]