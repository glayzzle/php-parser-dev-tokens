[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Category tree model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Category_Tree",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Varien_Data_Tree_Dbp",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","ID_FIELD",37],["T_WHITESPACE","    ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'id'",37],";",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","PATH_FIELD",38],["T_WHITESPACE","  ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'path'",38],";",["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","ORDER_FIELD",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'order'",39],";",["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","LEVEL_FIELD",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'level'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Categories resource collection\n     *\n     * @var Mage_Catalog_Model_Resource_Category_Collection\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_collection",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Id of 'is_active' category attribute\n     *\n     * @var int\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_isActiveAttributeId",54],["T_WHITESPACE","              ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Join URL rewrites data to collection flag\n     *\n     * @var boolean\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_joinUrlRewriteIntoCollection",61],["T_WHITESPACE","     ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","false",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Inactive categories ids\n     *\n     * @var array\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_inactiveCategoryIds",68],["T_WHITESPACE","              ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","null",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * store id\n     *\n     * @var integer\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_storeId",75],["T_WHITESPACE","                          ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","null",75],";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Initialize tree\n     *\n     *\/",77],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","__construct",81],"(",")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$resource",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","Mage",83],["T_DOUBLE_COLON","::",83],["T_STRING","getSingleton",83],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",83],")",";",["T_WHITESPACE","\n\n        ",83],["T_STRING","parent",85],["T_DOUBLE_COLON","::",85],["T_STRING","__construct",85],"(",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$resource",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getConnection",86],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_write'",86],")",",",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$resource",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getTableName",87],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",87],")",",",["T_WHITESPACE","\n            ",87],["T_ARRAY","array",88],"(",["T_WHITESPACE","\n                ",88],["T_STRING","Varien_Data_Tree_Dbp",89],["T_DOUBLE_COLON","::",89],["T_STRING","ID_FIELD",89],["T_WHITESPACE","       ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",89],",",["T_WHITESPACE","\n                ",89],["T_STRING","Varien_Data_Tree_Dbp",90],["T_DOUBLE_COLON","::",90],["T_STRING","PATH_FIELD",90],["T_WHITESPACE","     ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'path'",90],",",["T_WHITESPACE","\n                ",90],["T_STRING","Varien_Data_Tree_Dbp",91],["T_DOUBLE_COLON","::",91],["T_STRING","ORDER_FIELD",91],["T_WHITESPACE","    ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'position'",91],",",["T_WHITESPACE","\n                ",91],["T_STRING","Varien_Data_Tree_Dbp",92],["T_DOUBLE_COLON","::",92],["T_STRING","LEVEL_FIELD",92],["T_WHITESPACE","    ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'level'",92],",",["T_WHITESPACE","\n            ",92],")",["T_WHITESPACE","\n        ",93],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Set store id\n     *\n     * @param integer $storeId\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",97],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","setStoreId",103],"(",["T_VARIABLE","$storeId",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_storeId",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_INT_CAST","(int)",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$storeId",105],";",["T_WHITESPACE","\n        ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Return store id\n     *\n     * @return integer\n     *\/",109],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","getStoreId",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_storeId",116],["T_WHITESPACE"," ",116],["T_IS_IDENTICAL","===",116],["T_WHITESPACE"," ",116],["T_STRING","null",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_storeId",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","Mage",117],["T_DOUBLE_COLON","::",117],["T_STRING","app",117],"(",")",["T_OBJECT_OPERATOR","->",117],["T_STRING","getStore",117],"(",")",["T_OBJECT_OPERATOR","->",117],["T_STRING","getId",117],"(",")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n        ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_storeId",119],";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_DOC_COMMENT","\/**\n     * Enter description here...\n     *\n     * @param Mage_Catalog_Model_Resource_Category_Collection $collection\n     * @param boolean $sorted\n     * @param array $exclude\n     * @param boolean $toLoad\n     * @param boolean $onlyActive\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",122],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","addCollectionData",132],"(",["T_VARIABLE","$collection",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","null",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$sorted",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","false",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$exclude",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_VARIABLE","$toLoad",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","true",132],",",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$onlyActive",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","false",133],")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_STRING","is_null",135],"(",["T_VARIABLE","$collection",135],")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$collection",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getCollection",136],"(",["T_VARIABLE","$sorted",136],")",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE"," ",137],["T_ELSE","else",137],["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setCollection",138],"(",["T_VARIABLE","$collection",138],")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_IF","if",141],["T_WHITESPACE"," ",141],"(","!",["T_STRING","is_array",141],"(",["T_VARIABLE","$exclude",141],")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$exclude",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_VARIABLE","$exclude",142],")",";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$nodeIds",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",")",";",["T_WHITESPACE","\n        ",145],["T_FOREACH","foreach",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getNodes",146],"(",")",["T_WHITESPACE"," ",146],["T_AS","as",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$node",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_IF","if",147],["T_WHITESPACE"," ",147],"(","!",["T_STRING","in_array",147],"(",["T_VARIABLE","$node",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getId",147],"(",")",",",["T_WHITESPACE"," ",147],["T_VARIABLE","$exclude",147],")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n                ",147],["T_VARIABLE","$nodeIds",148],"[","]",["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$node",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getId",148],"(",")",";",["T_WHITESPACE","\n            ",148],"}",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$collection",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","addIdFilter",151],"(",["T_VARIABLE","$nodeIds",151],")",";",["T_WHITESPACE","\n        ",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_VARIABLE","$onlyActive",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n\n            ",152],["T_VARIABLE","$disabledIds",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_getDisabledIds",154],"(",["T_VARIABLE","$collection",154],")",";",["T_WHITESPACE","\n            ",154],["T_IF","if",155],["T_WHITESPACE"," ",155],"(",["T_VARIABLE","$disabledIds",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$collection",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","addFieldToFilter",156],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",156],",",["T_WHITESPACE"," ",156],["T_ARRAY","array",156],"(",["T_CONSTANT_ENCAPSED_STRING","'nin'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$disabledIds",156],")",")",";",["T_WHITESPACE","\n            ",156],"}",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$collection",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","addAttributeToFilter",158],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active'",158],",",["T_WHITESPACE"," ",158],["T_LNUMBER","1",158],")",";",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$collection",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","addAttributeToFilter",159],"(",["T_CONSTANT_ENCAPSED_STRING","'include_in_menu'",159],",",["T_WHITESPACE"," ",159],["T_LNUMBER","1",159],")",";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n\n        ",160],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_joinUrlRewriteIntoCollection",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$collection",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","joinUrlRewrite",163],"(",")",";",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_joinUrlRewriteIntoCollection",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","false",164],";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n\n        ",165],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$toLoad",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$collection",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","load",168],"(",")",";",["T_WHITESPACE","\n\n            ",168],["T_FOREACH","foreach",170],["T_WHITESPACE"," ",170],"(",["T_VARIABLE","$collection",170],["T_WHITESPACE"," ",170],["T_AS","as",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$category",170],")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n                ",170],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getNodeById",171],"(",["T_VARIABLE","$category",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getId",171],"(",")",")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n                    ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getNodeById",172],"(",["T_VARIABLE","$category",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getId",172],"(",")",")",["T_WHITESPACE","\n                        ",172],["T_OBJECT_OPERATOR","->",173],["T_STRING","addData",173],"(",["T_VARIABLE","$category",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getData",173],"(",")",")",";",["T_WHITESPACE","\n                ",173],"}",["T_WHITESPACE","\n            ",174],"}",["T_WHITESPACE","\n\n            ",175],["T_FOREACH","foreach",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getNodes",177],"(",")",["T_WHITESPACE"," ",177],["T_AS","as",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$node",177],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_VARIABLE","$collection",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getItemById",178],"(",["T_VARIABLE","$node",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getId",178],"(",")",")",["T_WHITESPACE"," ",178],["T_BOOLEAN_AND","&&",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$node",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getParent",178],"(",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                    ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","removeNode",179],"(",["T_VARIABLE","$node",179],")",";",["T_WHITESPACE","\n                ",179],"}",["T_WHITESPACE","\n            ",180],"}",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n\n        ",182],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Add inactive categories ids\n     *\n     * @param unknown_type $ids\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",187],["T_WHITESPACE","\n    ",192],["T_PUBLIC","public",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","addInactiveCategoryIds",193],"(",["T_VARIABLE","$ids",193],")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(","!",["T_STRING","is_array",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_inactiveCategoryIds",195],")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_initInactiveCategoryIds",196],"(",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_inactiveCategoryIds",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","array_merge",198],"(",["T_VARIABLE","$ids",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_inactiveCategoryIds",198],")",";",["T_WHITESPACE","\n        ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],";",["T_WHITESPACE","\n    ",199],"}",["T_WHITESPACE","\n\n    ",200],["T_DOC_COMMENT","\/**\n     * Retrieve inactive categories ids\n     *\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",202],["T_WHITESPACE","\n    ",206],["T_PROTECTED","protected",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","_initInactiveCategoryIds",207],"(",")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_inactiveCategoryIds",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_ARRAY","array",209],"(",")",";",["T_WHITESPACE","\n        ",209],["T_STRING","Mage",210],["T_DOUBLE_COLON","::",210],["T_STRING","dispatchEvent",210],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_init_inactive_category_ids'",210],",",["T_WHITESPACE"," ",210],["T_ARRAY","array",210],"(",["T_CONSTANT_ENCAPSED_STRING","'tree'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],")",")",";",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Retrieve inactive categories ids\n     *\n     * @return array\n     *\/",214],["T_WHITESPACE","\n    ",218],["T_PUBLIC","public",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","getInactiveCategoryIds",219],"(",")",["T_WHITESPACE","\n    ",219],"{",["T_WHITESPACE","\n        ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(","!",["T_STRING","is_array",221],"(",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_inactiveCategoryIds",221],")",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_initInactiveCategoryIds",222],"(",")",";",["T_WHITESPACE","\n        ",222],"}",["T_WHITESPACE","\n\n        ",223],["T_RETURN","return",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_inactiveCategoryIds",225],";",["T_WHITESPACE","\n    ",225],"}",["T_WHITESPACE","\n\n    ",226],["T_DOC_COMMENT","\/**\n     * Return disable category ids\n     *\n     * @param Mage_Catalog_Model_Resource_Category_Collection $collection\n     * @return array\n     *\/",228],["T_WHITESPACE","\n    ",233],["T_PROTECTED","protected",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","_getDisabledIds",234],"(",["T_VARIABLE","$collection",234],")",["T_WHITESPACE","\n    ",234],"{",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$storeId",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_STRING","Mage",236],["T_DOUBLE_COLON","::",236],["T_STRING","app",236],"(",")",["T_OBJECT_OPERATOR","->",236],["T_STRING","getStore",236],"(",")",["T_OBJECT_OPERATOR","->",236],["T_STRING","getId",236],"(",")",";",["T_WHITESPACE","\n\n        ",236],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_inactiveItems",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getInactiveCategoryIds",238],"(",")",";",["T_WHITESPACE","\n\n\n        ",238],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_inactiveItems",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","array_merge",241],"(",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_getInactiveItemIds",242],"(",["T_VARIABLE","$collection",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$storeId",242],")",",",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_inactiveItems",243],["T_WHITESPACE","\n        ",243],")",";",["T_WHITESPACE","\n\n\n        ",244],["T_VARIABLE","$allIds",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$collection",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getAllIds",247],"(",")",";",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$disabledIds",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_ARRAY","array",248],"(",")",";",["T_WHITESPACE","\n\n        ",248],["T_FOREACH","foreach",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$allIds",250],["T_WHITESPACE"," ",250],["T_AS","as",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$id",250],")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n            ",250],["T_VARIABLE","$parents",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getNodeById",251],"(",["T_VARIABLE","$id",251],")",["T_OBJECT_OPERATOR","->",251],["T_STRING","getPath",251],"(",")",";",["T_WHITESPACE","\n            ",251],["T_FOREACH","foreach",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$parents",252],["T_WHITESPACE"," ",252],["T_AS","as",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$parent",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(","!",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_getItemIsActive",253],"(",["T_VARIABLE","$parent",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getId",253],"(",")",",",["T_WHITESPACE"," ",253],["T_VARIABLE","$storeId",253],")",")","{",["T_WHITESPACE","\n                    ",253],["T_VARIABLE","$disabledIds",254],"[","]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$id",254],";",["T_WHITESPACE","\n                    ",254],["T_CONTINUE","continue",255],";",["T_WHITESPACE","\n                ",255],"}",["T_WHITESPACE","\n            ",256],"}",["T_WHITESPACE","\n        ",257],"}",["T_WHITESPACE","\n        ",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$disabledIds",259],";",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n\n    ",260],["T_DOC_COMMENT","\/**\n     * Returns attribute id for attribute \"is_active\"\n     *\n     * @return int\n     *\/",262],["T_WHITESPACE","\n    ",266],["T_PROTECTED","protected",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","_getIsActiveAttributeId",267],"(",")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_VARIABLE","$resource",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","Mage",269],["T_DOUBLE_COLON","::",269],["T_STRING","getSingleton",269],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",269],")",";",["T_WHITESPACE","\n        ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_STRING","is_null",270],"(",["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_isActiveAttributeId",270],")",")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$bind",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_ARRAY","array",271],"(",["T_WHITESPACE","\n                ",271],["T_CONSTANT_ENCAPSED_STRING","'entity_type_code'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_STRING","Mage_Catalog_Model_Category",272],["T_DOUBLE_COLON","::",272],["T_STRING","ENTITY",272],",",["T_WHITESPACE","\n                ",272],["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",273],["T_WHITESPACE","   ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_CONSTANT_ENCAPSED_STRING","'is_active'",273],["T_WHITESPACE","\n            ",273],")",";",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$select",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_conn",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","select",275],"(",")",["T_WHITESPACE","\n                ",275],["T_OBJECT_OPERATOR","->",276],["T_STRING","from",276],"(",["T_ARRAY","array",276],"(",["T_CONSTANT_ENCAPSED_STRING","'a'",276],["T_DOUBLE_ARROW","=>",276],["T_VARIABLE","$resource",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getTableName",276],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute'",276],")",")",",",["T_WHITESPACE"," ",276],["T_ARRAY","array",276],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",276],")",")",["T_WHITESPACE","\n                ",276],["T_OBJECT_OPERATOR","->",277],["T_STRING","join",277],"(",["T_ARRAY","array",277],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",277],["T_DOUBLE_ARROW","=>",277],["T_VARIABLE","$resource",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getTableName",277],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_type'",277],")",")",",",["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","'a.entity_type_id = t.entity_type_id'",277],")",["T_WHITESPACE","\n                ",277],["T_OBJECT_OPERATOR","->",278],["T_STRING","where",278],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type_code = :entity_type_code'",278],")",["T_WHITESPACE","\n                ",278],["T_OBJECT_OPERATOR","->",279],["T_STRING","where",279],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_code = :attribute_code'",279],")",";",["T_WHITESPACE","\n\n            ",279],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_isActiveAttributeId",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_conn",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","fetchOne",281],"(",["T_VARIABLE","$select",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$bind",281],")",";",["T_WHITESPACE","\n        ",281],"}",["T_WHITESPACE","\n        ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_isActiveAttributeId",283],";",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n\n    ",284],["T_DOC_COMMENT","\/**\n     * Retrieve inactive category item ids\n     *\n     * @param Mage_Catalog_Model_Resource_Category_Collection $collection\n     * @param int $storeId\n     * @return array\n     *\/",286],["T_WHITESPACE","\n    ",292],["T_PROTECTED","protected",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","_getInactiveItemIds",293],"(",["T_VARIABLE","$collection",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$storeId",293],")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$filter",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$collection",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getAllIds",295],"(",")",";",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$attributeId",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","_getIsActiveAttributeId",296],"(",")",";",["T_WHITESPACE","\n\n        ",296],["T_VARIABLE","$conditionSql",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_conn",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getCheckSql",298],"(",["T_CONSTANT_ENCAPSED_STRING","'c.value_id > 0'",298],",",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'c.value'",298],",",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'d.value'",298],")",";",["T_WHITESPACE","\n        ",298],["T_VARIABLE","$table",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_STRING","Mage",299],["T_DOUBLE_COLON","::",299],["T_STRING","getSingleton",299],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",299],")",["T_OBJECT_OPERATOR","->",299],["T_STRING","getTableName",299],"(",["T_ARRAY","array",299],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",299],",",["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'int'",299],")",")",";",["T_WHITESPACE","\n        ",299],["T_VARIABLE","$bind",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_ARRAY","array",300],"(",["T_WHITESPACE","\n            ",300],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",301],["T_WHITESPACE"," ",301],["T_DOUBLE_ARROW","=>",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$attributeId",301],",",["T_WHITESPACE","\n            ",301],["T_CONSTANT_ENCAPSED_STRING","'store_id'",302],["T_WHITESPACE","     ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$storeId",302],",",["T_WHITESPACE","\n            ",302],["T_CONSTANT_ENCAPSED_STRING","'zero_store_id'",303],["T_DOUBLE_ARROW","=>",303],["T_WHITESPACE"," ",303],["T_LNUMBER","0",303],",",["T_WHITESPACE","\n            ",303],["T_CONSTANT_ENCAPSED_STRING","'cond'",304],["T_WHITESPACE","         ",304],["T_DOUBLE_ARROW","=>",304],["T_WHITESPACE"," ",304],["T_LNUMBER","0",304],",",["T_WHITESPACE","\n\n        ",304],")",";",["T_WHITESPACE","\n        ",306],["T_VARIABLE","$select",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","_conn",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","select",307],"(",")",["T_WHITESPACE","\n            ",307],["T_OBJECT_OPERATOR","->",308],["T_STRING","from",308],"(",["T_ARRAY","array",308],"(",["T_CONSTANT_ENCAPSED_STRING","'d'",308],["T_DOUBLE_ARROW","=>",308],["T_VARIABLE","$table",308],")",",",["T_WHITESPACE"," ",308],["T_ARRAY","array",308],"(",["T_CONSTANT_ENCAPSED_STRING","'d.entity_id'",308],")",")",["T_WHITESPACE","\n            ",308],["T_OBJECT_OPERATOR","->",309],["T_STRING","where",309],"(",["T_CONSTANT_ENCAPSED_STRING","'d.attribute_id = :attribute_id'",309],")",["T_WHITESPACE","\n            ",309],["T_OBJECT_OPERATOR","->",310],["T_STRING","where",310],"(",["T_CONSTANT_ENCAPSED_STRING","'d.store_id = :zero_store_id'",310],")",["T_WHITESPACE","\n            ",310],["T_OBJECT_OPERATOR","->",311],["T_STRING","where",311],"(",["T_CONSTANT_ENCAPSED_STRING","'d.entity_id IN (?)'",311],",",["T_WHITESPACE"," ",311],["T_VARIABLE","$filter",311],")",["T_WHITESPACE","\n            ",311],["T_OBJECT_OPERATOR","->",312],["T_STRING","joinLeft",312],"(",["T_WHITESPACE","\n                ",312],["T_ARRAY","array",313],"(",["T_CONSTANT_ENCAPSED_STRING","'c'",313],["T_DOUBLE_ARROW","=>",313],["T_VARIABLE","$table",313],")",",",["T_WHITESPACE","\n                ",313],["T_CONSTANT_ENCAPSED_STRING","'c.attribute_id = :attribute_id AND c.store_id = :store_id AND c.entity_id = d.entity_id'",314],",",["T_WHITESPACE","\n                ",314],["T_ARRAY","array",315],"(",")",["T_WHITESPACE","\n            ",315],")",["T_WHITESPACE","\n            ",316],["T_OBJECT_OPERATOR","->",317],["T_STRING","where",317],"(",["T_VARIABLE","$conditionSql",317],["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","' = :cond'",317],")",";",["T_WHITESPACE","\n\n        ",317],["T_RETURN","return",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","_conn",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","fetchCol",319],"(",["T_VARIABLE","$select",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$bind",319],")",";",["T_WHITESPACE","\n    ",319],"}",["T_WHITESPACE","\n\n    ",320],["T_DOC_COMMENT","\/**\n     * Check is category items active\n     *\n     * @param int $id\n     * @return boolean\n     *\/",322],["T_WHITESPACE","\n    ",327],["T_PROTECTED","protected",328],["T_WHITESPACE"," ",328],["T_FUNCTION","function",328],["T_WHITESPACE"," ",328],["T_STRING","_getItemIsActive",328],"(",["T_VARIABLE","$id",328],")",["T_WHITESPACE","\n    ",328],"{",["T_WHITESPACE","\n        ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(","!",["T_STRING","in_array",330],"(",["T_VARIABLE","$id",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_inactiveItems",330],")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_STRING","true",331],";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n        ",332],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_STRING","false",333],";",["T_WHITESPACE","\n    ",333],"}",["T_WHITESPACE","\n\n    ",334],["T_DOC_COMMENT","\/**\n     * Get categories collection\n     *\n     * @param boolean $sorted\n     * @return Mage_Catalog_Model_Resource_Category_Collection\n     *\/",336],["T_WHITESPACE","\n    ",341],["T_PUBLIC","public",342],["T_WHITESPACE"," ",342],["T_FUNCTION","function",342],["T_WHITESPACE"," ",342],["T_STRING","getCollection",342],"(",["T_VARIABLE","$sorted",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","false",342],")",["T_WHITESPACE","\n    ",342],"{",["T_WHITESPACE","\n        ",343],["T_IF","if",344],["T_WHITESPACE"," ",344],"(",["T_STRING","is_null",344],"(",["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_collection",344],")",")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_collection",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_getDefaultCollection",345],"(",["T_VARIABLE","$sorted",345],")",";",["T_WHITESPACE","\n        ",345],"}",["T_WHITESPACE","\n        ",346],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_collection",347],";",["T_WHITESPACE","\n    ",347],"}",["T_WHITESPACE","\n\n    ",348],["T_DOC_COMMENT","\/**\n     * Enter description here...\n     *\n     * @param Mage_Catalog_Model_Resource_Category_Collection $collection\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",350],["T_WHITESPACE","\n    ",355],["T_PUBLIC","public",356],["T_WHITESPACE"," ",356],["T_FUNCTION","function",356],["T_WHITESPACE"," ",356],["T_STRING","setCollection",356],"(",["T_VARIABLE","$collection",356],")",["T_WHITESPACE","\n    ",356],"{",["T_WHITESPACE","\n        ",357],["T_IF","if",358],["T_WHITESPACE"," ",358],"(","!",["T_STRING","is_null",358],"(",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_collection",358],")",")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_STRING","destruct",359],"(",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_collection",359],")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","_collection",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_VARIABLE","$collection",361],";",["T_WHITESPACE","\n        ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Enter description here...\n     *\n     * @param boolean $sorted\n     * @return Mage_Catalog_Model_Resource_Category_Collection\n     *\/",365],["T_WHITESPACE","\n    ",370],["T_PROTECTED","protected",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","_getDefaultCollection",371],"(",["T_VARIABLE","$sorted",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","false",371],")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_joinUrlRewriteIntoCollection",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","true",373],";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$collection",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","Mage",374],["T_DOUBLE_COLON","::",374],["T_STRING","getModel",374],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",374],")",["T_OBJECT_OPERATOR","->",374],["T_STRING","getCollection",374],"(",")",";",["T_WHITESPACE","\n        ",374],["T_DOC_COMMENT","\/** @var $collection Mage_Catalog_Model_Resource_Category_Collection *\/",375],["T_WHITESPACE","\n\n        ",375],["T_VARIABLE","$attributes",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_STRING","Mage",377],["T_DOUBLE_COLON","::",377],["T_STRING","getConfig",377],"(",")",["T_OBJECT_OPERATOR","->",377],["T_STRING","getNode",377],"(",["T_CONSTANT_ENCAPSED_STRING","'frontend\/category\/collection\/attributes'",377],")",";",["T_WHITESPACE","\n        ",377],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$attributes",378],")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n            ",378],["T_VARIABLE","$attributes",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_VARIABLE","$attributes",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","asArray",379],"(",")",";",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$attributes",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_STRING","array_keys",380],"(",["T_VARIABLE","$attributes",380],")",";",["T_WHITESPACE","\n        ",380],"}",["T_WHITESPACE","\n        ",381],["T_VARIABLE","$collection",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","addAttributeToSelect",382],"(",["T_VARIABLE","$attributes",382],")",";",["T_WHITESPACE","\n\n        ",382],["T_IF","if",384],["T_WHITESPACE"," ",384],"(",["T_VARIABLE","$sorted",384],")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n            ",384],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_STRING","is_string",385],"(",["T_VARIABLE","$sorted",385],")",")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n                ",385],["T_COMMENT","\/\/ $sorted is supposed to be attribute name\n",386],["T_WHITESPACE","                ",387],["T_VARIABLE","$collection",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","addAttributeToSort",387],"(",["T_VARIABLE","$sorted",387],")",";",["T_WHITESPACE","\n            ",387],"}",["T_WHITESPACE"," ",388],["T_ELSE","else",388],["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_VARIABLE","$collection",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","addAttributeToSort",389],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",389],")",";",["T_WHITESPACE","\n            ",389],"}",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n\n        ",391],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$collection",393],";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n\n    ",394],["T_DOC_COMMENT","\/**\n     * Move tree before\n     *\n     * @param unknown_type $category\n     * @param Varien_Data_Tree_Node $newParent\n     * @param Varien_Data_Tree_Node $prevNode\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",396],["T_WHITESPACE","\n    ",403],["T_PROTECTED","protected",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","_beforeMove",404],"(",["T_VARIABLE","$category",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$newParent",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$prevNode",404],")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_STRING","Mage",406],["T_DOUBLE_COLON","::",406],["T_STRING","dispatchEvent",406],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_move_before'",406],",",["T_WHITESPACE"," ",406],["T_ARRAY","array",406],"(",["T_WHITESPACE","\n            ",406],["T_CONSTANT_ENCAPSED_STRING","'category'",407],["T_WHITESPACE","      ",407],["T_DOUBLE_ARROW","=>",407],["T_WHITESPACE"," ",407],["T_VARIABLE","$category",407],",",["T_WHITESPACE","\n            ",407],["T_CONSTANT_ENCAPSED_STRING","'prev_parent'",408],["T_WHITESPACE","   ",408],["T_DOUBLE_ARROW","=>",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$prevNode",408],",",["T_WHITESPACE","\n            ",408],["T_CONSTANT_ENCAPSED_STRING","'parent'",409],["T_WHITESPACE","        ",409],["T_DOUBLE_ARROW","=>",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$newParent",409],["T_WHITESPACE","\n        ",409],")",")",";",["T_WHITESPACE","\n\n        ",410],["T_RETURN","return",412],["T_WHITESPACE"," ",412],["T_VARIABLE","$this",412],";",["T_WHITESPACE","\n    ",412],"}",["T_WHITESPACE","\n\n    ",413],["T_DOC_COMMENT","\/**\n     * Executing parents move method and cleaning cache after it\n     *\n     * @param unknown_type $category\n     * @param unknown_type $newParent\n     * @param unknown_type $prevNode\n     *\/",415],["T_WHITESPACE","\n    ",421],["T_PUBLIC","public",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","move",422],"(",["T_VARIABLE","$category",422],",",["T_WHITESPACE"," ",422],["T_VARIABLE","$newParent",422],",",["T_WHITESPACE"," ",422],["T_VARIABLE","$prevNode",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_STRING","null",422],")",["T_WHITESPACE","\n    ",422],"{",["T_WHITESPACE","\n        ",423],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","_beforeMove",424],"(",["T_VARIABLE","$category",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$newParent",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$prevNode",424],")",";",["T_WHITESPACE","\n        ",424],["T_STRING","Mage",425],["T_DOUBLE_COLON","::",425],["T_STRING","getResourceSingleton",425],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",425],")",["T_OBJECT_OPERATOR","->",425],["T_STRING","move",425],"(",["T_VARIABLE","$category",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getId",425],"(",")",",",["T_WHITESPACE"," ",425],["T_VARIABLE","$newParent",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getId",425],"(",")",")",";",["T_WHITESPACE","\n        ",425],["T_STRING","parent",426],["T_DOUBLE_COLON","::",426],["T_STRING","move",426],"(",["T_VARIABLE","$category",426],",",["T_WHITESPACE"," ",426],["T_VARIABLE","$newParent",426],",",["T_WHITESPACE"," ",426],["T_VARIABLE","$prevNode",426],")",";",["T_WHITESPACE","\n\n        ",426],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","_afterMove",428],"(",["T_VARIABLE","$category",428],",",["T_WHITESPACE"," ",428],["T_VARIABLE","$newParent",428],",",["T_WHITESPACE"," ",428],["T_VARIABLE","$prevNode",428],")",";",["T_WHITESPACE","\n    ",428],"}",["T_WHITESPACE","\n\n    ",429],["T_DOC_COMMENT","\/**\n     * Move tree after\n     *\n     * @param unknown_type $category\n     * @param Varien_Data_Tree_Node $newParent\n     * @param Varien_Data_Tree_Node $prevNode\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",431],["T_WHITESPACE","\n    ",438],["T_PROTECTED","protected",439],["T_WHITESPACE"," ",439],["T_FUNCTION","function",439],["T_WHITESPACE"," ",439],["T_STRING","_afterMove",439],"(",["T_VARIABLE","$category",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$newParent",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$prevNode",439],")",["T_WHITESPACE","\n    ",439],"{",["T_WHITESPACE","\n        ",440],["T_STRING","Mage",441],["T_DOUBLE_COLON","::",441],["T_STRING","app",441],"(",")",["T_OBJECT_OPERATOR","->",441],["T_STRING","cleanCache",441],"(",["T_ARRAY","array",441],"(",["T_STRING","Mage_Catalog_Model_Category",441],["T_DOUBLE_COLON","::",441],["T_STRING","CACHE_TAG",441],")",")",";",["T_WHITESPACE","\n\n        ",441],["T_STRING","Mage",443],["T_DOUBLE_COLON","::",443],["T_STRING","dispatchEvent",443],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_move_after'",443],",",["T_WHITESPACE"," ",443],["T_ARRAY","array",443],"(",["T_WHITESPACE","\n            ",443],["T_CONSTANT_ENCAPSED_STRING","'category'",444],["T_WHITESPACE","  ",444],["T_DOUBLE_ARROW","=>",444],["T_WHITESPACE"," ",444],["T_VARIABLE","$category",444],",",["T_WHITESPACE","\n            ",444],["T_CONSTANT_ENCAPSED_STRING","'prev_node'",445],["T_WHITESPACE"," ",445],["T_DOUBLE_ARROW","=>",445],["T_WHITESPACE"," ",445],["T_VARIABLE","$prevNode",445],",",["T_WHITESPACE","\n            ",445],["T_CONSTANT_ENCAPSED_STRING","'parent'",446],["T_WHITESPACE","    ",446],["T_DOUBLE_ARROW","=>",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$newParent",446],["T_WHITESPACE","\n        ",446],")",")",";",["T_WHITESPACE","\n\n        ",447],["T_RETURN","return",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],";",["T_WHITESPACE","\n    ",449],"}",["T_WHITESPACE","\n\n    ",450],["T_DOC_COMMENT","\/**\n     * Load whole category tree, that will include specified categories ids.\n     *\n     * @param array $ids\n     * @param bool $addCollectionData\n     * @param bool $updateAnchorProductCount\n     * @return Mage_Catalog_Model_Resource_Category_Tree\n     *\/",452],["T_WHITESPACE","\n    ",459],["T_PUBLIC","public",460],["T_WHITESPACE"," ",460],["T_FUNCTION","function",460],["T_WHITESPACE"," ",460],["T_STRING","loadByIds",460],"(",["T_VARIABLE","$ids",460],",",["T_WHITESPACE"," ",460],["T_VARIABLE","$addCollectionData",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_STRING","true",460],",",["T_WHITESPACE"," ",460],["T_VARIABLE","$updateAnchorProductCount",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_STRING","true",460],")",["T_WHITESPACE","\n    ",460],"{",["T_WHITESPACE","\n        ",461],["T_VARIABLE","$levelField",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","_conn",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","quoteIdentifier",462],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",462],")",";",["T_WHITESPACE","\n        ",462],["T_VARIABLE","$pathField",463],["T_WHITESPACE","  ",463],"=",["T_WHITESPACE"," ",463],["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","_conn",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","quoteIdentifier",463],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",463],")",";",["T_WHITESPACE","\n        ",463],["T_COMMENT","\/\/ load first two levels, if no ids specified\n",464],["T_WHITESPACE","        ",465],["T_IF","if",465],["T_WHITESPACE"," ",465],"(",["T_EMPTY","empty",465],"(",["T_VARIABLE","$ids",465],")",")",["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n            ",465],["T_VARIABLE","$select",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","_conn",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","select",466],"(",")",["T_WHITESPACE","\n                ",466],["T_OBJECT_OPERATOR","->",467],["T_STRING","from",467],"(",["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_table",467],",",["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",467],")",["T_WHITESPACE","\n                ",467],["T_OBJECT_OPERATOR","->",468],["T_STRING","where",468],"(",["T_VARIABLE","$levelField",468],["T_WHITESPACE"," ",468],".",["T_WHITESPACE"," ",468],["T_CONSTANT_ENCAPSED_STRING","' <= 2'",468],")",";",["T_WHITESPACE","\n            ",468],["T_VARIABLE","$ids",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_conn",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","fetchCol",469],"(",["T_VARIABLE","$select",469],")",";",["T_WHITESPACE","\n        ",469],"}",["T_WHITESPACE","\n        ",470],["T_IF","if",471],["T_WHITESPACE"," ",471],"(","!",["T_STRING","is_array",471],"(",["T_VARIABLE","$ids",471],")",")",["T_WHITESPACE"," ",471],"{",["T_WHITESPACE","\n            ",471],["T_VARIABLE","$ids",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_ARRAY","array",472],"(",["T_VARIABLE","$ids",472],")",";",["T_WHITESPACE","\n        ",472],"}",["T_WHITESPACE","\n        ",473],["T_FOREACH","foreach",474],["T_WHITESPACE"," ",474],"(",["T_VARIABLE","$ids",474],["T_WHITESPACE"," ",474],["T_AS","as",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$key",474],["T_WHITESPACE"," ",474],["T_DOUBLE_ARROW","=>",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$id",474],")",["T_WHITESPACE"," ",474],"{",["T_WHITESPACE","\n            ",474],["T_VARIABLE","$ids",475],"[",["T_VARIABLE","$key",475],"]",["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_INT_CAST","(int)",475],["T_VARIABLE","$id",475],";",["T_WHITESPACE","\n        ",475],"}",["T_WHITESPACE","\n\n        ",476],["T_COMMENT","\/\/ collect paths of specified IDs and prepare to collect all their parents and neighbours\n",478],["T_WHITESPACE","        ",479],["T_VARIABLE","$select",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","_conn",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","select",479],"(",")",["T_WHITESPACE","\n            ",479],["T_OBJECT_OPERATOR","->",480],["T_STRING","from",480],"(",["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","_table",480],",",["T_WHITESPACE"," ",480],["T_ARRAY","array",480],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",480],",",["T_WHITESPACE"," ",480],["T_CONSTANT_ENCAPSED_STRING","'level'",480],")",")",["T_WHITESPACE","\n            ",480],["T_OBJECT_OPERATOR","->",481],["T_STRING","where",481],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",481],",",["T_WHITESPACE"," ",481],["T_VARIABLE","$ids",481],")",";",["T_WHITESPACE","\n        ",481],["T_VARIABLE","$where",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_ARRAY","array",482],"(",["T_VARIABLE","$levelField",482],["T_WHITESPACE"," ",482],".",["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","'=0'",482],["T_WHITESPACE"," ",482],["T_DOUBLE_ARROW","=>",482],["T_WHITESPACE"," ",482],["T_STRING","true",482],")",";",["T_WHITESPACE","\n\n        ",482],["T_FOREACH","foreach",484],["T_WHITESPACE"," ",484],"(",["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","_conn",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","fetchAll",484],"(",["T_VARIABLE","$select",484],")",["T_WHITESPACE"," ",484],["T_AS","as",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$item",484],")",["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n            ",484],["T_VARIABLE","$pathIds",485],["T_WHITESPACE","  ",485],"=",["T_WHITESPACE"," ",485],["T_STRING","explode",485],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$item",485],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",485],"]",")",";",["T_WHITESPACE","\n            ",485],["T_VARIABLE","$level",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_INT_CAST","(int)",486],["T_VARIABLE","$item",486],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",486],"]",";",["T_WHITESPACE","\n            ",486],["T_WHILE","while",487],["T_WHITESPACE"," ",487],"(",["T_VARIABLE","$level",487],["T_WHITESPACE"," ",487],">",["T_WHITESPACE"," ",487],["T_LNUMBER","0",487],")",["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n                ",487],["T_VARIABLE","$pathIds",488],"[",["T_STRING","count",488],"(",["T_VARIABLE","$pathIds",488],")",["T_WHITESPACE"," ",488],"-",["T_WHITESPACE"," ",488],["T_LNUMBER","1",488],"]",["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_CONSTANT_ENCAPSED_STRING","'%'",488],";",["T_WHITESPACE","\n                ",488],["T_VARIABLE","$path",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_STRING","implode",489],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",489],",",["T_WHITESPACE"," ",489],["T_VARIABLE","$pathIds",489],")",";",["T_WHITESPACE","\n                ",489],["T_VARIABLE","$where",490],"[","\"",["T_VARIABLE","$levelField",490],["T_ENCAPSED_AND_WHITESPACE","=",490],["T_VARIABLE","$level",490],["T_ENCAPSED_AND_WHITESPACE"," AND ",490],["T_VARIABLE","$pathField",490],["T_ENCAPSED_AND_WHITESPACE"," LIKE '",490],["T_VARIABLE","$path",490],["T_ENCAPSED_AND_WHITESPACE","'",490],"\"","]",["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_STRING","true",490],";",["T_WHITESPACE","\n                ",490],["T_STRING","array_pop",491],"(",["T_VARIABLE","$pathIds",491],")",";",["T_WHITESPACE","\n                ",491],["T_VARIABLE","$level",492],["T_DEC","--",492],";",["T_WHITESPACE","\n            ",492],"}",["T_WHITESPACE","\n        ",493],"}",["T_WHITESPACE","\n        ",494],["T_VARIABLE","$where",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_STRING","array_keys",495],"(",["T_VARIABLE","$where",495],")",";",["T_WHITESPACE","\n\n        ",495],["T_COMMENT","\/\/ get all required records\n",497],["T_WHITESPACE","        ",498],["T_IF","if",498],["T_WHITESPACE"," ",498],"(",["T_VARIABLE","$addCollectionData",498],")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$select",499],["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_createCollectionDataSelect",499],"(",")",";",["T_WHITESPACE","\n        ",499],"}",["T_WHITESPACE"," ",500],["T_ELSE","else",500],["T_WHITESPACE"," ",500],"{",["T_WHITESPACE","\n            ",500],["T_VARIABLE","$select",501],["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_CLONE","clone",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$this",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","_select",501],";",["T_WHITESPACE","\n            ",501],["T_VARIABLE","$select",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","order",502],"(",["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","_orderField",502],["T_WHITESPACE"," ",502],".",["T_WHITESPACE"," ",502],["T_CONSTANT_ENCAPSED_STRING","' '",502],["T_WHITESPACE"," ",502],".",["T_WHITESPACE"," ",502],["T_STRING","Varien_Db_Select",502],["T_DOUBLE_COLON","::",502],["T_STRING","SQL_ASC",502],")",";",["T_WHITESPACE","\n        ",502],"}",["T_WHITESPACE","\n        ",503],["T_VARIABLE","$select",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","where",504],"(",["T_STRING","implode",504],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",504],",",["T_WHITESPACE"," ",504],["T_VARIABLE","$where",504],")",")",";",["T_WHITESPACE","\n\n        ",504],["T_COMMENT","\/\/ get array of records and add them as nodes to the tree\n",506],["T_WHITESPACE","        ",507],["T_VARIABLE","$arrNodes",507],["T_WHITESPACE"," ",507],"=",["T_WHITESPACE"," ",507],["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","_conn",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","fetchAll",507],"(",["T_VARIABLE","$select",507],")",";",["T_WHITESPACE","\n        ",507],["T_IF","if",508],["T_WHITESPACE"," ",508],"(","!",["T_VARIABLE","$arrNodes",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_RETURN","return",509],["T_WHITESPACE"," ",509],["T_STRING","false",509],";",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE","\n        ",510],["T_IF","if",511],["T_WHITESPACE"," ",511],"(",["T_VARIABLE","$updateAnchorProductCount",511],")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n            ",511],["T_VARIABLE","$this",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","_updateAnchorProductCount",512],"(",["T_VARIABLE","$arrNodes",512],")",";",["T_WHITESPACE","\n        ",512],"}",["T_WHITESPACE","\n        ",513],["T_VARIABLE","$childrenItems",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_ARRAY","array",514],"(",")",";",["T_WHITESPACE","\n        ",514],["T_FOREACH","foreach",515],["T_WHITESPACE"," ",515],"(",["T_VARIABLE","$arrNodes",515],["T_WHITESPACE"," ",515],["T_AS","as",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$key",515],["T_WHITESPACE"," ",515],["T_DOUBLE_ARROW","=>",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$nodeInfo",515],")",["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n            ",515],["T_VARIABLE","$pathToParent",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_STRING","explode",516],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",516],",",["T_WHITESPACE"," ",516],["T_VARIABLE","$nodeInfo",516],"[",["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","_pathField",516],"]",")",";",["T_WHITESPACE","\n            ",516],["T_STRING","array_pop",517],"(",["T_VARIABLE","$pathToParent",517],")",";",["T_WHITESPACE","\n            ",517],["T_VARIABLE","$pathToParent",518],["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],["T_STRING","implode",518],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",518],",",["T_WHITESPACE"," ",518],["T_VARIABLE","$pathToParent",518],")",";",["T_WHITESPACE","\n            ",518],["T_VARIABLE","$childrenItems",519],"[",["T_VARIABLE","$pathToParent",519],"]","[","]",["T_WHITESPACE"," ",519],"=",["T_WHITESPACE"," ",519],["T_VARIABLE","$nodeInfo",519],";",["T_WHITESPACE","\n        ",519],"}",["T_WHITESPACE","\n        ",520],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","addChildNodes",521],"(",["T_VARIABLE","$childrenItems",521],",",["T_WHITESPACE"," ",521],["T_CONSTANT_ENCAPSED_STRING","''",521],",",["T_WHITESPACE"," ",521],["T_STRING","null",521],")",";",["T_WHITESPACE","\n        ",521],["T_RETURN","return",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],";",["T_WHITESPACE","\n    ",522],"}",["T_WHITESPACE","\n\n    ",523],["T_DOC_COMMENT","\/**\n     * Load array of category parents\n     *\n     * @param string $path\n     * @param bool $addCollectionData\n     * @param bool $withRootNode\n     * @return array\n     *\/",525],["T_WHITESPACE","\n    ",532],["T_PUBLIC","public",533],["T_WHITESPACE"," ",533],["T_FUNCTION","function",533],["T_WHITESPACE"," ",533],["T_STRING","loadBreadcrumbsArray",533],"(",["T_VARIABLE","$path",533],",",["T_WHITESPACE"," ",533],["T_VARIABLE","$addCollectionData",533],["T_WHITESPACE"," ",533],"=",["T_WHITESPACE"," ",533],["T_STRING","true",533],",",["T_WHITESPACE"," ",533],["T_VARIABLE","$withRootNode",533],["T_WHITESPACE"," ",533],"=",["T_WHITESPACE"," ",533],["T_STRING","false",533],")",["T_WHITESPACE","\n    ",533],"{",["T_WHITESPACE","\n        ",534],["T_VARIABLE","$pathIds",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_STRING","explode",535],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",535],",",["T_WHITESPACE"," ",535],["T_VARIABLE","$path",535],")",";",["T_WHITESPACE","\n        ",535],["T_IF","if",536],["T_WHITESPACE"," ",536],"(","!",["T_VARIABLE","$withRootNode",536],")",["T_WHITESPACE"," ",536],"{",["T_WHITESPACE","\n            ",536],["T_STRING","array_shift",537],"(",["T_VARIABLE","$pathIds",537],")",";",["T_WHITESPACE","\n        ",537],"}",["T_WHITESPACE","\n        ",538],["T_VARIABLE","$result",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_ARRAY","array",539],"(",")",";",["T_WHITESPACE","\n        ",539],["T_IF","if",540],["T_WHITESPACE"," ",540],"(","!",["T_EMPTY","empty",540],"(",["T_VARIABLE","$pathIds",540],")",")",["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n            ",540],["T_IF","if",541],["T_WHITESPACE"," ",541],"(",["T_VARIABLE","$addCollectionData",541],")",["T_WHITESPACE"," ",541],"{",["T_WHITESPACE","\n                ",541],["T_VARIABLE","$select",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","_createCollectionDataSelect",542],"(",["T_STRING","false",542],")",";",["T_WHITESPACE","\n            ",542],"}",["T_WHITESPACE"," ",543],["T_ELSE","else",543],["T_WHITESPACE"," ",543],"{",["T_WHITESPACE","\n                ",543],["T_VARIABLE","$select",544],["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_CLONE","clone",544],["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","_select",544],";",["T_WHITESPACE","\n            ",544],"}",["T_WHITESPACE","\n            ",545],["T_VARIABLE","$select",546],["T_WHITESPACE","\n                ",546],["T_OBJECT_OPERATOR","->",547],["T_STRING","where",547],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",547],",",["T_WHITESPACE"," ",547],["T_VARIABLE","$pathIds",547],")",["T_WHITESPACE","\n                ",547],["T_OBJECT_OPERATOR","->",548],["T_STRING","order",548],"(",["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","_conn",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getLengthSql",548],"(",["T_CONSTANT_ENCAPSED_STRING","'e.path'",548],")",["T_WHITESPACE"," ",548],".",["T_WHITESPACE"," ",548],["T_CONSTANT_ENCAPSED_STRING","' '",548],["T_WHITESPACE"," ",548],".",["T_WHITESPACE"," ",548],["T_STRING","Varien_Db_Select",548],["T_DOUBLE_COLON","::",548],["T_STRING","SQL_ASC",548],")",";",["T_WHITESPACE","\n            ",548],["T_VARIABLE","$result",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","_conn",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","fetchAll",549],"(",["T_VARIABLE","$select",549],")",";",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","_updateAnchorProductCount",550],"(",["T_VARIABLE","$result",550],")",";",["T_WHITESPACE","\n        ",550],"}",["T_WHITESPACE","\n        ",551],["T_RETURN","return",552],["T_WHITESPACE"," ",552],["T_VARIABLE","$result",552],";",["T_WHITESPACE","\n    ",552],"}",["T_WHITESPACE","\n\n    ",553],["T_DOC_COMMENT","\/**\n     * Replace products count with self products count, if category is non-anchor\n     *\n     * @param array $data\n     *\/",555],["T_WHITESPACE","\n    ",559],["T_PROTECTED","protected",560],["T_WHITESPACE"," ",560],["T_FUNCTION","function",560],["T_WHITESPACE"," ",560],["T_STRING","_updateAnchorProductCount",560],"(","&",["T_VARIABLE","$data",560],")",["T_WHITESPACE","\n    ",560],"{",["T_WHITESPACE","\n        ",561],["T_FOREACH","foreach",562],["T_WHITESPACE"," ",562],"(",["T_VARIABLE","$data",562],["T_WHITESPACE"," ",562],["T_AS","as",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$key",562],["T_WHITESPACE"," ",562],["T_DOUBLE_ARROW","=>",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$row",562],")",["T_WHITESPACE"," ",562],"{",["T_WHITESPACE","\n            ",562],["T_IF","if",563],["T_WHITESPACE"," ",563],"(",["T_LNUMBER","0",563],["T_WHITESPACE"," ",563],["T_IS_IDENTICAL","===",563],["T_WHITESPACE"," ",563],["T_INT_CAST","(int)",563],["T_VARIABLE","$row",563],"[",["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",563],"]",")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n                ",563],["T_VARIABLE","$data",564],"[",["T_VARIABLE","$key",564],"]","[",["T_CONSTANT_ENCAPSED_STRING","'product_count'",564],"]",["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_VARIABLE","$row",564],"[",["T_CONSTANT_ENCAPSED_STRING","'self_product_count'",564],"]",";",["T_WHITESPACE","\n            ",564],"}",["T_WHITESPACE","\n        ",565],"}",["T_WHITESPACE","\n    ",566],"}",["T_WHITESPACE","\n\n    ",567],["T_DOC_COMMENT","\/**\n     * Obtain select for categories with attributes.\n     * By default everything from entity table is selected\n     * + name, is_active and is_anchor\n     * Also the correct product_count is selected, depending on is the category anchor or not.\n     *\n     * @param bool $sorted\n     * @param array $optionalAttributes\n     * @return Zend_Db_Select\n     *\/",569],["T_WHITESPACE","\n    ",578],["T_PROTECTED","protected",579],["T_WHITESPACE"," ",579],["T_FUNCTION","function",579],["T_WHITESPACE"," ",579],["T_STRING","_createCollectionDataSelect",579],"(",["T_VARIABLE","$sorted",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_STRING","true",579],",",["T_WHITESPACE"," ",579],["T_VARIABLE","$optionalAttributes",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_ARRAY","array",579],"(",")",")",["T_WHITESPACE","\n    ",579],"{",["T_WHITESPACE","\n        ",580],["T_VARIABLE","$select",581],["T_WHITESPACE"," ",581],"=",["T_WHITESPACE"," ",581],["T_VARIABLE","$this",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","_getDefaultCollection",581],"(",["T_VARIABLE","$sorted",581],["T_WHITESPACE"," ",581],"?",["T_WHITESPACE"," ",581],["T_VARIABLE","$this",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","_orderField",581],["T_WHITESPACE"," ",581],":",["T_WHITESPACE"," ",581],["T_STRING","false",581],")",["T_WHITESPACE","\n            ",581],["T_OBJECT_OPERATOR","->",582],["T_STRING","getSelect",582],"(",")",";",["T_WHITESPACE","\n        ",582],["T_COMMENT","\/\/ add attributes to select\n",583],["T_WHITESPACE","        ",584],["T_VARIABLE","$attributes",584],["T_WHITESPACE"," ",584],"=",["T_WHITESPACE"," ",584],["T_ARRAY","array",584],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",584],",",["T_WHITESPACE"," ",584],["T_CONSTANT_ENCAPSED_STRING","'is_active'",584],",",["T_WHITESPACE"," ",584],["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",584],")",";",["T_WHITESPACE","\n        ",584],["T_IF","if",585],["T_WHITESPACE"," ",585],"(",["T_VARIABLE","$optionalAttributes",585],")",["T_WHITESPACE"," ",585],"{",["T_WHITESPACE","\n            ",585],["T_VARIABLE","$attributes",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","array_unique",586],"(",["T_STRING","array_merge",586],"(",["T_VARIABLE","$attributes",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$optionalAttributes",586],")",")",";",["T_WHITESPACE","\n        ",586],"}",["T_WHITESPACE","\n        ",587],["T_FOREACH","foreach",588],["T_WHITESPACE"," ",588],"(",["T_VARIABLE","$attributes",588],["T_WHITESPACE"," ",588],["T_AS","as",588],["T_WHITESPACE"," ",588],["T_VARIABLE","$attributeCode",588],")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n            ",588],["T_COMMENT","\/* @var $attribute Mage_Eav_Model_Entity_Attribute *\/",589],["T_WHITESPACE","\n            ",589],["T_VARIABLE","$attribute",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_STRING","Mage",590],["T_DOUBLE_COLON","::",590],["T_STRING","getResourceSingleton",590],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",590],")",["T_OBJECT_OPERATOR","->",590],["T_STRING","getAttribute",590],"(",["T_VARIABLE","$attributeCode",590],")",";",["T_WHITESPACE","\n            ",590],["T_COMMENT","\/\/ join non-static attribute table\n",591],["T_WHITESPACE","            ",592],["T_IF","if",592],["T_WHITESPACE"," ",592],"(","!",["T_VARIABLE","$attribute",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","getBackend",592],"(",")",["T_OBJECT_OPERATOR","->",592],["T_STRING","isStatic",592],"(",")",")",["T_WHITESPACE"," ",592],"{",["T_WHITESPACE","\n                ",592],["T_VARIABLE","$tableDefault",593],["T_WHITESPACE","   ",593],"=",["T_WHITESPACE"," ",593],["T_STRING","sprintf",593],"(",["T_CONSTANT_ENCAPSED_STRING","'d_%s'",593],",",["T_WHITESPACE"," ",593],["T_VARIABLE","$attributeCode",593],")",";",["T_WHITESPACE","\n                ",593],["T_VARIABLE","$tableStore",594],["T_WHITESPACE","     ",594],"=",["T_WHITESPACE"," ",594],["T_STRING","sprintf",594],"(",["T_CONSTANT_ENCAPSED_STRING","'s_%s'",594],",",["T_WHITESPACE"," ",594],["T_VARIABLE","$attributeCode",594],")",";",["T_WHITESPACE","\n                ",594],["T_VARIABLE","$valueExpr",595],["T_WHITESPACE","      ",595],"=",["T_WHITESPACE"," ",595],["T_VARIABLE","$this",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","_conn",595],["T_WHITESPACE","\n                    ",595],["T_OBJECT_OPERATOR","->",596],["T_STRING","getCheckSql",596],"(","\"",["T_CURLY_OPEN","{",596],["T_VARIABLE","$tableStore",596],"}",["T_ENCAPSED_AND_WHITESPACE",".value_id > 0",596],"\"",",",["T_WHITESPACE"," ",596],"\"",["T_CURLY_OPEN","{",596],["T_VARIABLE","$tableStore",596],"}",["T_ENCAPSED_AND_WHITESPACE",".value",596],"\"",",",["T_WHITESPACE"," ",596],"\"",["T_CURLY_OPEN","{",596],["T_VARIABLE","$tableDefault",596],"}",["T_ENCAPSED_AND_WHITESPACE",".value",596],"\"",")",";",["T_WHITESPACE","\n\n                ",596],["T_VARIABLE","$select",598],["T_WHITESPACE","\n                    ",598],["T_OBJECT_OPERATOR","->",599],["T_STRING","joinLeft",599],"(",["T_WHITESPACE","\n                        ",599],["T_ARRAY","array",600],"(",["T_VARIABLE","$tableDefault",600],["T_WHITESPACE"," ",600],["T_DOUBLE_ARROW","=>",600],["T_WHITESPACE"," ",600],["T_VARIABLE","$attribute",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","getBackend",600],"(",")",["T_OBJECT_OPERATOR","->",600],["T_STRING","getTable",600],"(",")",")",",",["T_WHITESPACE","\n                        ",600],["T_STRING","sprintf",601],"(",["T_CONSTANT_ENCAPSED_STRING","'%1$s.entity_id=e.entity_id AND %1$s.attribute_id=%2$d'",601],["T_WHITESPACE","\n                            ",601],".",["T_WHITESPACE"," ",602],["T_CONSTANT_ENCAPSED_STRING","' AND %1$s.entity_type_id=e.entity_type_id AND %1$s.store_id=%3$d'",602],",",["T_WHITESPACE","\n                            ",602],["T_VARIABLE","$tableDefault",603],",",["T_WHITESPACE"," ",603],["T_VARIABLE","$attribute",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","getId",603],"(",")",",",["T_WHITESPACE"," ",603],["T_STRING","Mage_Core_Model_App",603],["T_DOUBLE_COLON","::",603],["T_STRING","ADMIN_STORE_ID",603],")",",",["T_WHITESPACE","\n                        ",603],["T_ARRAY","array",604],"(",["T_VARIABLE","$attributeCode",604],["T_WHITESPACE"," ",604],["T_DOUBLE_ARROW","=>",604],["T_WHITESPACE"," ",604],["T_CONSTANT_ENCAPSED_STRING","'value'",604],")",")",["T_WHITESPACE","\n                    ",604],["T_OBJECT_OPERATOR","->",605],["T_STRING","joinLeft",605],"(",["T_WHITESPACE","\n                        ",605],["T_ARRAY","array",606],"(",["T_VARIABLE","$tableStore",606],["T_WHITESPACE"," ",606],["T_DOUBLE_ARROW","=>",606],["T_WHITESPACE"," ",606],["T_VARIABLE","$attribute",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","getBackend",606],"(",")",["T_OBJECT_OPERATOR","->",606],["T_STRING","getTable",606],"(",")",")",",",["T_WHITESPACE","\n                        ",606],["T_STRING","sprintf",607],"(",["T_CONSTANT_ENCAPSED_STRING","'%1$s.entity_id=e.entity_id AND %1$s.attribute_id=%2$d'",607],["T_WHITESPACE","\n                            ",607],".",["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","' AND %1$s.entity_type_id=e.entity_type_id AND %1$s.store_id=%3$d'",608],",",["T_WHITESPACE","\n                            ",608],["T_VARIABLE","$tableStore",609],",",["T_WHITESPACE"," ",609],["T_VARIABLE","$attribute",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","getId",609],"(",")",",",["T_WHITESPACE"," ",609],["T_VARIABLE","$this",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","getStoreId",609],"(",")",")",",",["T_WHITESPACE","\n                        ",609],["T_ARRAY","array",610],"(",["T_VARIABLE","$attributeCode",610],["T_WHITESPACE"," ",610],["T_DOUBLE_ARROW","=>",610],["T_WHITESPACE"," ",610],["T_VARIABLE","$valueExpr",610],")",["T_WHITESPACE","\n                    ",610],")",";",["T_WHITESPACE","\n            ",611],"}",["T_WHITESPACE","\n        ",612],"}",["T_WHITESPACE","\n\n        ",613],["T_COMMENT","\/\/ count children products qty plus self products qty\n",615],["T_WHITESPACE","        ",616],["T_VARIABLE","$categoriesTable",616],["T_WHITESPACE","         ",616],"=",["T_WHITESPACE"," ",616],["T_STRING","Mage",616],["T_DOUBLE_COLON","::",616],["T_STRING","getSingleton",616],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",616],")",["T_OBJECT_OPERATOR","->",616],["T_STRING","getTableName",616],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",616],")",";",["T_WHITESPACE","\n        ",616],["T_VARIABLE","$categoriesProductsTable",617],["T_WHITESPACE"," ",617],"=",["T_WHITESPACE"," ",617],["T_STRING","Mage",617],["T_DOUBLE_COLON","::",617],["T_STRING","getSingleton",617],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",617],")",["T_OBJECT_OPERATOR","->",617],["T_STRING","getTableName",617],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_product'",617],")",";",["T_WHITESPACE","\n\n        ",617],["T_VARIABLE","$subConcat",619],["T_WHITESPACE"," ",619],"=",["T_WHITESPACE"," ",619],["T_VARIABLE","$this",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","_conn",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","getConcatSql",619],"(",["T_ARRAY","array",619],"(",["T_CONSTANT_ENCAPSED_STRING","'e.path'",619],",",["T_WHITESPACE"," ",619],["T_VARIABLE","$this",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","_conn",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","quote",619],"(",["T_CONSTANT_ENCAPSED_STRING","'\/%'",619],")",")",")",";",["T_WHITESPACE","\n        ",619],["T_VARIABLE","$subSelect",620],["T_WHITESPACE"," ",620],"=",["T_WHITESPACE"," ",620],["T_VARIABLE","$this",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","_conn",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","select",620],"(",")",["T_WHITESPACE","\n            ",620],["T_OBJECT_OPERATOR","->",621],["T_STRING","from",621],"(",["T_ARRAY","array",621],"(",["T_CONSTANT_ENCAPSED_STRING","'see'",621],["T_WHITESPACE"," ",621],["T_DOUBLE_ARROW","=>",621],["T_WHITESPACE"," ",621],["T_VARIABLE","$categoriesTable",621],")",",",["T_WHITESPACE"," ",621],["T_STRING","null",621],")",["T_WHITESPACE","\n            ",621],["T_OBJECT_OPERATOR","->",622],["T_STRING","joinLeft",622],"(",["T_WHITESPACE","\n                ",622],["T_ARRAY","array",623],"(",["T_CONSTANT_ENCAPSED_STRING","'scp'",623],["T_WHITESPACE"," ",623],["T_DOUBLE_ARROW","=>",623],["T_WHITESPACE"," ",623],["T_VARIABLE","$categoriesProductsTable",623],")",",",["T_WHITESPACE","\n                ",623],["T_CONSTANT_ENCAPSED_STRING","'see.entity_id=scp.category_id'",624],",",["T_WHITESPACE","\n                ",624],["T_ARRAY","array",625],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(DISTINCT scp.product_id)'",625],")",")",["T_WHITESPACE","\n            ",625],["T_OBJECT_OPERATOR","->",626],["T_STRING","where",626],"(",["T_CONSTANT_ENCAPSED_STRING","'see.entity_id = e.entity_id'",626],")",["T_WHITESPACE","\n            ",626],["T_OBJECT_OPERATOR","->",627],["T_STRING","orWhere",627],"(",["T_CONSTANT_ENCAPSED_STRING","'see.path LIKE ?'",627],",",["T_WHITESPACE"," ",627],["T_VARIABLE","$subConcat",627],")",";",["T_WHITESPACE","\n        ",627],["T_VARIABLE","$select",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","columns",628],"(",["T_ARRAY","array",628],"(",["T_CONSTANT_ENCAPSED_STRING","'product_count'",628],["T_WHITESPACE"," ",628],["T_DOUBLE_ARROW","=>",628],["T_WHITESPACE"," ",628],["T_VARIABLE","$subSelect",628],")",")",";",["T_WHITESPACE","\n\n        ",628],["T_VARIABLE","$subSelect",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","_conn",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","select",630],"(",")",["T_WHITESPACE","\n            ",630],["T_OBJECT_OPERATOR","->",631],["T_STRING","from",631],"(",["T_ARRAY","array",631],"(",["T_CONSTANT_ENCAPSED_STRING","'cp'",631],["T_WHITESPACE"," ",631],["T_DOUBLE_ARROW","=>",631],["T_WHITESPACE"," ",631],["T_VARIABLE","$categoriesProductsTable",631],")",",",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'COUNT(cp.product_id)'",631],")",["T_WHITESPACE","\n            ",631],["T_OBJECT_OPERATOR","->",632],["T_STRING","where",632],"(",["T_CONSTANT_ENCAPSED_STRING","'cp.category_id = e.entity_id'",632],")",";",["T_WHITESPACE","\n\n        ",632],["T_VARIABLE","$select",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","columns",634],"(",["T_ARRAY","array",634],"(",["T_CONSTANT_ENCAPSED_STRING","'self_product_count'",634],["T_WHITESPACE"," ",634],["T_DOUBLE_ARROW","=>",634],["T_WHITESPACE"," ",634],["T_VARIABLE","$subSelect",634],")",")",";",["T_WHITESPACE","\n\n        ",634],["T_RETURN","return",636],["T_WHITESPACE"," ",636],["T_VARIABLE","$select",636],";",["T_WHITESPACE","\n    ",636],"}",["T_WHITESPACE","\n\n    ",637],["T_DOC_COMMENT","\/**\n     * Get real existing category ids by specified ids\n     *\n     * @param array $ids\n     * @return array\n     *\/",639],["T_WHITESPACE","\n    ",644],["T_PUBLIC","public",645],["T_WHITESPACE"," ",645],["T_FUNCTION","function",645],["T_WHITESPACE"," ",645],["T_STRING","getExistingCategoryIdsBySpecifiedIds",645],"(",["T_VARIABLE","$ids",645],")",["T_WHITESPACE","\n    ",645],"{",["T_WHITESPACE","\n        ",646],["T_IF","if",647],["T_WHITESPACE"," ",647],"(",["T_EMPTY","empty",647],"(",["T_VARIABLE","$ids",647],")",")",["T_WHITESPACE"," ",647],"{",["T_WHITESPACE","\n            ",647],["T_RETURN","return",648],["T_WHITESPACE"," ",648],["T_ARRAY","array",648],"(",")",";",["T_WHITESPACE","\n        ",648],"}",["T_WHITESPACE","\n        ",649],["T_IF","if",650],["T_WHITESPACE"," ",650],"(","!",["T_STRING","is_array",650],"(",["T_VARIABLE","$ids",650],")",")",["T_WHITESPACE"," ",650],"{",["T_WHITESPACE","\n            ",650],["T_VARIABLE","$ids",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_ARRAY","array",651],"(",["T_VARIABLE","$ids",651],")",";",["T_WHITESPACE","\n        ",651],"}",["T_WHITESPACE","\n        ",652],["T_VARIABLE","$select",653],["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","_conn",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","select",653],"(",")",["T_WHITESPACE","\n            ",653],["T_OBJECT_OPERATOR","->",654],["T_STRING","from",654],"(",["T_VARIABLE","$this",654],["T_OBJECT_OPERATOR","->",654],["T_STRING","_table",654],",",["T_WHITESPACE"," ",654],["T_ARRAY","array",654],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",654],")",")",["T_WHITESPACE","\n            ",654],["T_OBJECT_OPERATOR","->",655],["T_STRING","where",655],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$ids",655],")",";",["T_WHITESPACE","\n        ",655],["T_RETURN","return",656],["T_WHITESPACE"," ",656],["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","_conn",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","fetchCol",656],"(",["T_VARIABLE","$select",656],")",";",["T_WHITESPACE","\n    ",656],"}",["T_WHITESPACE","\n",657],"}",["T_WHITESPACE","\n",658]]