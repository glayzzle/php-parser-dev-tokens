[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Category products indexer model.\n * Responsibility for system actions:\n *  - Product save (changed assigned categories list)\n *  - Category save (changed assigned products list or category move)\n *  - Store save (new store creation, changed store group) - require reindex all data\n *  - Store group save (changed root category or group website) - require reindex all data\n *\n * @method Mage_Catalog_Model_Resource_Category_Indexer_Product _getResource()\n * @method Mage_Catalog_Model_Resource_Category_Indexer_Product getResource()\n * @method int getCategoryId()\n * @method Mage_Catalog_Model_Category_Indexer_Product setCategoryId(int $value)\n * @method int getProductId()\n * @method Mage_Catalog_Model_Category_Indexer_Product setProductId(int $value)\n * @method int getPosition()\n * @method Mage_Catalog_Model_Category_Indexer_Product setPosition(int $value)\n * @method int getIsParent()\n * @method Mage_Catalog_Model_Category_Indexer_Product setIsParent(int $value)\n * @method int getStoreId()\n * @method Mage_Catalog_Model_Category_Indexer_Product setStoreId(int $value)\n * @method int getVisibility()\n * @method Mage_Catalog_Model_Category_Indexer_Product setVisibility(int $value)\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",53],["T_CLASS","class",54],["T_WHITESPACE"," ",54],["T_STRING","Mage_Catalog_Model_Category_Indexer_Product",54],["T_WHITESPACE"," ",54],["T_EXTENDS","extends",54],["T_WHITESPACE"," ",54],["T_STRING","Mage_Index_Model_Indexer_Abstract",54],["T_WHITESPACE","\n",54],"{",["T_WHITESPACE","\n    ",55],["T_DOC_COMMENT","\/**\n     * Data key for matching result to be saved in\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_CONST","const",59],["T_WHITESPACE"," ",59],["T_STRING","EVENT_MATCH_RESULT_KEY",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product_match_result'",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",61],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_matchedEntities",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",["T_WHITESPACE","\n        ",64],["T_STRING","Mage_Catalog_Model_Product",65],["T_DOUBLE_COLON","::",65],["T_STRING","ENTITY",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_ARRAY","array",65],"(",["T_WHITESPACE","\n            ",65],["T_STRING","Mage_Index_Model_Event",66],["T_DOUBLE_COLON","::",66],["T_STRING","TYPE_SAVE",66],",",["T_WHITESPACE","\n            ",66],["T_STRING","Mage_Index_Model_Event",67],["T_DOUBLE_COLON","::",67],["T_STRING","TYPE_MASS_ACTION",67],["T_WHITESPACE","\n        ",67],")",",",["T_WHITESPACE","\n        ",68],["T_STRING","Mage_Catalog_Model_Category",69],["T_DOUBLE_COLON","::",69],["T_STRING","ENTITY",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_WHITESPACE","\n            ",69],["T_STRING","Mage_Index_Model_Event",70],["T_DOUBLE_COLON","::",70],["T_STRING","TYPE_SAVE",70],["T_WHITESPACE","\n        ",70],")",",",["T_WHITESPACE","\n        ",71],["T_STRING","Mage_Core_Model_Store",72],["T_DOUBLE_COLON","::",72],["T_STRING","ENTITY",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",["T_WHITESPACE","\n            ",72],["T_STRING","Mage_Index_Model_Event",73],["T_DOUBLE_COLON","::",73],["T_STRING","TYPE_SAVE",73],["T_WHITESPACE","\n        ",73],")",",",["T_WHITESPACE","\n        ",74],["T_STRING","Mage_Core_Model_Store_Group",75],["T_DOUBLE_COLON","::",75],["T_STRING","ENTITY",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_ARRAY","array",75],"(",["T_WHITESPACE","\n            ",75],["T_STRING","Mage_Index_Model_Event",76],["T_DOUBLE_COLON","::",76],["T_STRING","TYPE_SAVE",76],["T_WHITESPACE","\n        ",76],")",",",["T_WHITESPACE","\n        ",77],["T_STRING","Mage_Catalog_Model_Convert_Adapter_Product",78],["T_DOUBLE_COLON","::",78],["T_STRING","ENTITY",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_ARRAY","array",78],"(",["T_WHITESPACE","\n            ",78],["T_STRING","Mage_Index_Model_Event",79],["T_DOUBLE_COLON","::",79],["T_STRING","TYPE_SAVE",79],["T_WHITESPACE","\n        ",79],")",["T_WHITESPACE","\n    ",80],")",";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Initialize resource\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","_construct",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_init",88],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_indexer_product'",88],")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Get Indexer name\n     *\n     * @return string\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","getName",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","helper",98],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","__",98],"(",["T_CONSTANT_ENCAPSED_STRING","'Category Products'",98],")",";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Get Indexer description\n     *\n     * @return string\n     *\/",101],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","getDescription",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_STRING","Mage",108],["T_DOUBLE_COLON","::",108],["T_STRING","helper",108],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",108],")",["T_OBJECT_OPERATOR","->",108],["T_STRING","__",108],"(",["T_CONSTANT_ENCAPSED_STRING","'Indexed category\/products association'",108],")",";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Check if event can be matched by process.\n     * Overwrote for specific config save, store and store groups save matching\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return bool\n     *\/",111],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","matchEvent",118],"(",["T_STRING","Mage_Index_Model_Event",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$event",118],")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$data",120],["T_WHITESPACE","      ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$event",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getNewData",120],"(",")",";",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_ISSET","isset",121],"(",["T_VARIABLE","$data",121],"[",["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","EVENT_MATCH_RESULT_KEY",121],"]",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$data",122],"[",["T_STRING","self",122],["T_DOUBLE_COLON","::",122],["T_STRING","EVENT_MATCH_RESULT_KEY",122],"]",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n\n        ",123],["T_VARIABLE","$entity",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$event",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getEntity",125],"(",")",";",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$entity",126],["T_WHITESPACE"," ",126],["T_IS_EQUAL","==",126],["T_WHITESPACE"," ",126],["T_STRING","Mage_Core_Model_Store",126],["T_DOUBLE_COLON","::",126],["T_STRING","ENTITY",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$store",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$event",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getDataObject",127],"(",")",";",["T_WHITESPACE","\n            ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$store",128],["T_WHITESPACE"," ",128],["T_BOOLEAN_AND","&&",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$store",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","isObjectNew",128],"(",")",["T_WHITESPACE"," ",128],["T_BOOLEAN_OR","||",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$store",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","dataHasChangedFor",128],"(",["T_CONSTANT_ENCAPSED_STRING","'group_id'",128],")",")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n                ",128],["T_VARIABLE","$result",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","true",129],";",["T_WHITESPACE","\n            ",129],"}",["T_WHITESPACE"," ",130],["T_ELSE","else",130],["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$result",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","false",131],";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE"," ",133],["T_ELSEIF","elseif",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$entity",133],["T_WHITESPACE"," ",133],["T_IS_EQUAL","==",133],["T_WHITESPACE"," ",133],["T_STRING","Mage_Core_Model_Store_Group",133],["T_DOUBLE_COLON","::",133],["T_STRING","ENTITY",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$storeGroup",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$event",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getDataObject",134],"(",")",";",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$hasDataChanges",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$storeGroup",135],["T_WHITESPACE"," ",135],["T_BOOLEAN_AND","&&",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$storeGroup",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","dataHasChangedFor",135],"(",["T_CONSTANT_ENCAPSED_STRING","'root_category_id'",135],")",["T_WHITESPACE","\n                ",135],["T_BOOLEAN_OR","||",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$storeGroup",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","dataHasChangedFor",136],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",136],")",")",";",["T_WHITESPACE","\n            ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$storeGroup",137],["T_WHITESPACE"," ",137],["T_BOOLEAN_AND","&&",137],["T_WHITESPACE"," ",137],"!",["T_VARIABLE","$storeGroup",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","isObjectNew",137],"(",")",["T_WHITESPACE"," ",137],["T_BOOLEAN_AND","&&",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$hasDataChanges",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                ",137],["T_VARIABLE","$result",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","true",138],";",["T_WHITESPACE","\n            ",138],"}",["T_WHITESPACE"," ",139],["T_ELSE","else",139],["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$result",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","false",140],";",["T_WHITESPACE","\n            ",140],"}",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE"," ",142],["T_ELSE","else",142],["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$result",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","parent",143],["T_DOUBLE_COLON","::",143],["T_STRING","matchEvent",143],"(",["T_VARIABLE","$event",143],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_VARIABLE","$event",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","addNewData",146],"(",["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_STRING","EVENT_MATCH_RESULT_KEY",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$result",146],")",";",["T_WHITESPACE","\n\n        ",146],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$result",148],";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Register data required by process in event object\n     * Check if category ids was changed\n     *\n     * @param Mage_Index_Model_Event $event\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PROTECTED","protected",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","_registerEvent",158],"(",["T_STRING","Mage_Index_Model_Event",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$event",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$event",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","addNewData",160],"(",["T_STRING","self",160],["T_DOUBLE_COLON","::",160],["T_STRING","EVENT_MATCH_RESULT_KEY",160],",",["T_WHITESPACE"," ",160],["T_STRING","true",160],")",";",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$entity",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$event",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getEntity",161],"(",")",";",["T_WHITESPACE","\n        ",161],["T_SWITCH","switch",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$entity",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_CASE","case",163],["T_WHITESPACE"," ",163],["T_STRING","Mage_Catalog_Model_Product",163],["T_DOUBLE_COLON","::",163],["T_STRING","ENTITY",163],":",["T_WHITESPACE","\n               ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_registerProductEvent",164],"(",["T_VARIABLE","$event",164],")",";",["T_WHITESPACE","\n                ",164],["T_BREAK","break",165],";",["T_WHITESPACE","\n\n            ",165],["T_CASE","case",167],["T_WHITESPACE"," ",167],["T_STRING","Mage_Catalog_Model_Category",167],["T_DOUBLE_COLON","::",167],["T_STRING","ENTITY",167],":",["T_WHITESPACE","\n                ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_registerCategoryEvent",168],"(",["T_VARIABLE","$event",168],")",";",["T_WHITESPACE","\n                ",168],["T_BREAK","break",169],";",["T_WHITESPACE","\n\n            ",169],["T_CASE","case",171],["T_WHITESPACE"," ",171],["T_STRING","Mage_Catalog_Model_Convert_Adapter_Product",171],["T_DOUBLE_COLON","::",171],["T_STRING","ENTITY",171],":",["T_WHITESPACE","\n                ",171],["T_VARIABLE","$event",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","addNewData",172],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product_reindex_all'",172],",",["T_WHITESPACE"," ",172],["T_STRING","true",172],")",";",["T_WHITESPACE","\n                ",172],["T_BREAK","break",173],";",["T_WHITESPACE","\n\n            ",173],["T_CASE","case",175],["T_WHITESPACE"," ",175],["T_STRING","Mage_Core_Model_Store",175],["T_DOUBLE_COLON","::",175],["T_STRING","ENTITY",175],":",["T_WHITESPACE","\n            ",175],["T_CASE","case",176],["T_WHITESPACE"," ",176],["T_STRING","Mage_Core_Model_Store_Group",176],["T_DOUBLE_COLON","::",176],["T_STRING","ENTITY",176],":",["T_WHITESPACE","\n                ",176],["T_VARIABLE","$process",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$event",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getProcess",177],"(",")",";",["T_WHITESPACE","\n                ",177],["T_VARIABLE","$process",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","changeStatus",178],"(",["T_STRING","Mage_Index_Model_Process",178],["T_DOUBLE_COLON","::",178],["T_STRING","STATUS_REQUIRE_REINDEX",178],")",";",["T_WHITESPACE","\n                ",178],["T_BREAK","break",179],";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE","\n        ",180],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Register event data during product save process\n     *\n     * @param Mage_Index_Model_Event $event\n     *\/",184],["T_WHITESPACE","\n    ",188],["T_PROTECTED","protected",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","_registerProductEvent",189],"(",["T_STRING","Mage_Index_Model_Event",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$event",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$eventType",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$event",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getType",191],"(",")",";",["T_WHITESPACE","\n        ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$eventType",192],["T_WHITESPACE"," ",192],["T_IS_EQUAL","==",192],["T_WHITESPACE"," ",192],["T_STRING","Mage_Index_Model_Event",192],["T_DOUBLE_COLON","::",192],["T_STRING","TYPE_SAVE",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$product",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$event",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getDataObject",193],"(",")",";",["T_WHITESPACE","\n            ",193],["T_DOC_COMMENT","\/**\n             * Check if product categories data was changed\n             *\/",194],["T_WHITESPACE","\n            ",196],["T_IF","if",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$product",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getIsChangedCategories",197],"(",")",["T_WHITESPACE"," ",197],["T_BOOLEAN_OR","||",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$product",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","dataHasChangedFor",197],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",197],")",["T_WHITESPACE","\n                ",197],["T_BOOLEAN_OR","||",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$product",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","dataHasChangedFor",198],"(",["T_CONSTANT_ENCAPSED_STRING","'visibility'",198],")",["T_WHITESPACE"," ",198],["T_BOOLEAN_OR","||",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$product",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getIsChangedWebsites",198],"(",")",")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$event",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","addNewData",199],"(",["T_CONSTANT_ENCAPSED_STRING","'category_ids'",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$product",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getCategoryIds",199],"(",")",")",";",["T_WHITESPACE","\n            ",199],"}",["T_WHITESPACE","\n        ",200],"}",["T_WHITESPACE"," ",201],["T_ELSE","else",201],["T_WHITESPACE"," ",201],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_VARIABLE","$eventType",201],["T_WHITESPACE"," ",201],["T_IS_EQUAL","==",201],["T_WHITESPACE"," ",201],["T_STRING","Mage_Index_Model_Event",201],["T_DOUBLE_COLON","::",201],["T_STRING","TYPE_MASS_ACTION",201],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n            ",201],["T_COMMENT","\/* @var $actionObject Varien_Object *\/",202],["T_WHITESPACE","\n            ",202],["T_VARIABLE","$actionObject",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$event",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getDataObject",203],"(",")",";",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$attributes",204],["T_WHITESPACE","   ",204],"=",["T_WHITESPACE"," ",204],["T_ARRAY","array",204],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'visibility'",204],")",";",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$rebuildIndex",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_STRING","false",205],";",["T_WHITESPACE","\n\n            ",205],["T_COMMENT","\/\/ check if attributes changed\n",207],["T_WHITESPACE","            ",208],["T_VARIABLE","$attrData",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$actionObject",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getAttributesData",208],"(",")",";",["T_WHITESPACE","\n            ",208],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_STRING","is_array",209],"(",["T_VARIABLE","$attrData",209],")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n                ",209],["T_FOREACH","foreach",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$attributes",210],["T_WHITESPACE"," ",210],["T_AS","as",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$attributeCode",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                    ",210],["T_IF","if",211],["T_WHITESPACE"," ",211],"(",["T_STRING","array_key_exists",211],"(",["T_VARIABLE","$attributeCode",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$attrData",211],")",")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n                        ",211],["T_VARIABLE","$rebuildIndex",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","true",212],";",["T_WHITESPACE","\n                        ",212],["T_BREAK","break",213],";",["T_WHITESPACE","\n                    ",213],"}",["T_WHITESPACE","\n                ",214],"}",["T_WHITESPACE","\n            ",215],"}",["T_WHITESPACE","\n\n            ",216],["T_COMMENT","\/\/ check changed websites\n",218],["T_WHITESPACE","            ",219],["T_IF","if",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$actionObject",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getWebsiteIds",219],"(",")",")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n                ",219],["T_VARIABLE","$rebuildIndex",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","true",220],";",["T_WHITESPACE","\n            ",220],"}",["T_WHITESPACE","\n\n            ",221],["T_COMMENT","\/\/ register affected products\n",223],["T_WHITESPACE","            ",224],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$rebuildIndex",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                ",224],["T_VARIABLE","$event",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","addNewData",225],"(",["T_CONSTANT_ENCAPSED_STRING","'product_ids'",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$actionObject",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getProductIds",225],"(",")",")",";",["T_WHITESPACE","\n            ",225],"}",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_DOC_COMMENT","\/**\n     * Register event data during category save process\n     *\n     * @param Mage_Index_Model_Event $event\n     *\/",230],["T_WHITESPACE","\n    ",234],["T_PROTECTED","protected",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","_registerCategoryEvent",235],"(",["T_STRING","Mage_Index_Model_Event",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$event",235],")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$category",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$event",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getDataObject",237],"(",")",";",["T_WHITESPACE","\n        ",237],["T_DOC_COMMENT","\/**\n         * Check if product categories data was changed\n         *\/",238],["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(",["T_VARIABLE","$category",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getIsChangedProductList",241],"(",")",")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$event",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","addNewData",242],"(",["T_CONSTANT_ENCAPSED_STRING","'products_was_changed'",242],",",["T_WHITESPACE"," ",242],["T_STRING","true",242],")",";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_DOC_COMMENT","\/**\n         * Check if category has another affected category ids (category move result)\n         *\/",244],["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$category",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getAffectedCategoryIds",247],"(",")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$event",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","addNewData",248],"(",["T_CONSTANT_ENCAPSED_STRING","'affected_category_ids'",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$category",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getAffectedCategoryIds",248],"(",")",")",";",["T_WHITESPACE","\n        ",248],"}",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_DOC_COMMENT","\/**\n     * Process event data and save to index\n     *\n     * @param Mage_Index_Model_Event $event\n     *\/",252],["T_WHITESPACE","\n    ",256],["T_PROTECTED","protected",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","_processEvent",257],"(",["T_STRING","Mage_Index_Model_Event",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$event",257],")",["T_WHITESPACE","\n    ",257],"{",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$data",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$event",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getNewData",259],"(",")",";",["T_WHITESPACE","\n        ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(","!",["T_EMPTY","empty",260],"(",["T_VARIABLE","$data",260],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product_reindex_all'",260],"]",")",")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","reindexAll",261],"(",")",";",["T_WHITESPACE","\n        ",261],"}",["T_WHITESPACE","\n        ",262],["T_IF","if",263],["T_WHITESPACE"," ",263],"(",["T_EMPTY","empty",263],"(",["T_VARIABLE","$data",263],"[",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product_skip_call_event_handler'",263],"]",")",")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","callEventHandler",264],"(",["T_VARIABLE","$event",264],")",";",["T_WHITESPACE","\n        ",264],"}",["T_WHITESPACE","\n    ",265],"}",["T_WHITESPACE","\n",266],"}",["T_WHITESPACE","\n",267]]