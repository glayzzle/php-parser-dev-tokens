[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog Layer Price Filter resource model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Layer_Filter_Price",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Minimal possible price\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","MIN_POSSIBLE_PRICE",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_DNUMBER",".01",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Initialize connection and define main table name\n     *\n     *\/",42],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","_construct",46],"(",")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_init",48],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_index_price'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Retrieve joined price index table alias\n     *\n     * @return string\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","_getIndexTableAlias",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'price_index'",58],";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Replace table alias in condition string\n     *\n     * @param string|null $conditionString\n     * @return string|null\n     *\/",61],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","_replaceTableAlias",67],"(",["T_VARIABLE","$conditionString",67],")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_STRING","is_null",69],"(",["T_VARIABLE","$conditionString",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","null",70],";",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$adapter",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_getReadAdapter",72],"(",")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$oldAlias",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",["T_WHITESPACE","\n            ",73],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",74],["T_DOUBLE_COLON","::",74],["T_STRING","INDEX_TABLE_ALIAS",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'.'",74],",",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$adapter",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","quoteIdentifier",75],"(",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",75],["T_DOUBLE_COLON","::",75],["T_STRING","INDEX_TABLE_ALIAS",75],")",["T_WHITESPACE"," ",75],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'.'",75],",",["T_WHITESPACE","\n        ",75],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$newAlias",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_ARRAY","array",77],"(",["T_WHITESPACE","\n            ",77],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",78],["T_DOUBLE_COLON","::",78],["T_STRING","MAIN_TABLE_ALIAS",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'.'",78],",",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$adapter",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","quoteIdentifier",79],"(",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",79],["T_DOUBLE_COLON","::",79],["T_STRING","MAIN_TABLE_ALIAS",79],")",["T_WHITESPACE"," ",79],".",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'.'",79],",",["T_WHITESPACE","\n        ",79],")",";",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_STRING","str_replace",81],"(",["T_VARIABLE","$oldAlias",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$newAlias",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$conditionString",81],")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Retrieve clean select with joined price index table\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @return Varien_Db_Select\n     *\/",84],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","_getSelect",90],"(",["T_VARIABLE","$filter",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$collection",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$filter",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getLayer",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","getProductCollection",92],"(",")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$collection",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","addPriceData",93],"(",["T_VARIABLE","$filter",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getCustomerGroupId",93],"(",")",",",["T_WHITESPACE"," ",93],["T_VARIABLE","$filter",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getWebsiteId",93],"(",")",")",";",["T_WHITESPACE","\n\n        ",93],["T_IF","if",95],["T_WHITESPACE"," ",95],"(","!",["T_STRING","is_null",95],"(",["T_VARIABLE","$collection",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getCatalogPreparedSelect",95],"(",")",")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$select",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_CLONE","clone",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$collection",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getCatalogPreparedSelect",96],"(",")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE"," ",97],["T_ELSE","else",97],["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$select",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_CLONE","clone",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$collection",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getSelect",98],"(",")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_COMMENT","\/\/ reset columns, order and limitation conditions\n",101],["T_WHITESPACE","        ",102],["T_VARIABLE","$select",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","reset",102],"(",["T_STRING","Zend_Db_Select",102],["T_DOUBLE_COLON","::",102],["T_STRING","COLUMNS",102],")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$select",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","reset",103],"(",["T_STRING","Zend_Db_Select",103],["T_DOUBLE_COLON","::",103],["T_STRING","ORDER",103],")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$select",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","reset",104],"(",["T_STRING","Zend_Db_Select",104],["T_DOUBLE_COLON","::",104],["T_STRING","LIMIT_COUNT",104],")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$select",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","reset",105],"(",["T_STRING","Zend_Db_Select",105],["T_DOUBLE_COLON","::",105],["T_STRING","LIMIT_OFFSET",105],")",";",["T_WHITESPACE","\n\n        ",105],["T_COMMENT","\/\/ remove join with main table\n",107],["T_WHITESPACE","        ",108],["T_VARIABLE","$fromPart",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$select",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getPart",108],"(",["T_STRING","Zend_Db_Select",108],["T_DOUBLE_COLON","::",108],["T_STRING","FROM",108],")",";",["T_WHITESPACE","\n        ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_ISSET","isset",109],"(",["T_VARIABLE","$fromPart",109],"[",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",109],["T_DOUBLE_COLON","::",109],["T_STRING","INDEX_TABLE_ALIAS",109],"]",")",["T_WHITESPACE","\n            ",109],["T_BOOLEAN_OR","||",110],["T_WHITESPACE"," ",110],"!",["T_ISSET","isset",110],"(",["T_VARIABLE","$fromPart",110],"[",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",110],["T_DOUBLE_COLON","::",110],["T_STRING","MAIN_TABLE_ALIAS",110],"]",")",["T_WHITESPACE","\n        ",110],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$select",112],";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_COMMENT","\/\/ processing FROM part\n",115],["T_WHITESPACE","        ",116],["T_VARIABLE","$priceIndexJoinPart",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$fromPart",116],"[",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",116],["T_DOUBLE_COLON","::",116],["T_STRING","INDEX_TABLE_ALIAS",116],"]",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$priceIndexJoinConditions",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","explode",117],"(",["T_CONSTANT_ENCAPSED_STRING","'AND'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$priceIndexJoinPart",117],"[",["T_CONSTANT_ENCAPSED_STRING","'joinCondition'",117],"]",")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$priceIndexJoinPart",118],"[",["T_CONSTANT_ENCAPSED_STRING","'joinType'",118],"]",["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","Zend_Db_Select",118],["T_DOUBLE_COLON","::",118],["T_STRING","FROM",118],";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$priceIndexJoinPart",119],"[",["T_CONSTANT_ENCAPSED_STRING","'joinCondition'",119],"]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","null",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$fromPart",120],"[",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",120],["T_DOUBLE_COLON","::",120],["T_STRING","MAIN_TABLE_ALIAS",120],"]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$priceIndexJoinPart",120],";",["T_WHITESPACE","\n        ",120],["T_UNSET","unset",121],"(",["T_VARIABLE","$fromPart",121],"[",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",121],["T_DOUBLE_COLON","::",121],["T_STRING","INDEX_TABLE_ALIAS",121],"]",")",";",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$select",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setPart",122],"(",["T_STRING","Zend_Db_Select",122],["T_DOUBLE_COLON","::",122],["T_STRING","FROM",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$fromPart",122],")",";",["T_WHITESPACE","\n        ",122],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$fromPart",123],["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$key",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$fromJoinItem",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$fromPart",124],"[",["T_VARIABLE","$key",124],"]","[",["T_CONSTANT_ENCAPSED_STRING","'joinCondition'",124],"]",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_replaceTableAlias",124],"(",["T_VARIABLE","$fromJoinItem",124],"[",["T_CONSTANT_ENCAPSED_STRING","'joinCondition'",124],"]",")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$select",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setPart",126],"(",["T_STRING","Zend_Db_Select",126],["T_DOUBLE_COLON","::",126],["T_STRING","FROM",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$fromPart",126],")",";",["T_WHITESPACE","\n\n        ",126],["T_COMMENT","\/\/ processing WHERE part\n",128],["T_WHITESPACE","        ",129],["T_VARIABLE","$wherePart",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$select",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getPart",129],"(",["T_STRING","Zend_Db_Select",129],["T_DOUBLE_COLON","::",129],["T_STRING","WHERE",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$excludedWherePart",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",130],["T_DOUBLE_COLON","::",130],["T_STRING","MAIN_TABLE_ALIAS",130],["T_WHITESPACE"," ",130],".",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'.status'",130],";",["T_WHITESPACE","\n        ",130],["T_FOREACH","foreach",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$wherePart",131],["T_WHITESPACE"," ",131],["T_AS","as",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$key",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$wherePartItem",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_STRING","strpos",132],"(",["T_VARIABLE","$wherePartItem",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$excludedWherePart",132],")",["T_WHITESPACE"," ",132],["T_IS_NOT_IDENTICAL","!==",132],["T_WHITESPACE"," ",132],["T_STRING","false",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$wherePart",133],"[",["T_VARIABLE","$key",133],"]",["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_STRING","Zend_Db_Expr",133],"(",["T_CONSTANT_ENCAPSED_STRING","'1=1'",133],")",";",["T_WHITESPACE","\n                ",133],["T_CONTINUE","continue",134],";",["T_WHITESPACE","\n            ",134],"}",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$wherePart",136],"[",["T_VARIABLE","$key",136],"]",["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_replaceTableAlias",136],"(",["T_VARIABLE","$wherePartItem",136],")",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$select",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setPart",138],"(",["T_STRING","Zend_Db_Select",138],["T_DOUBLE_COLON","::",138],["T_STRING","WHERE",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$wherePart",138],")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$excludeJoinPart",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",139],["T_DOUBLE_COLON","::",139],["T_STRING","MAIN_TABLE_ALIAS",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'.entity_id'",139],";",["T_WHITESPACE","\n        ",139],["T_FOREACH","foreach",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$priceIndexJoinConditions",140],["T_WHITESPACE"," ",140],["T_AS","as",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$condition",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_STRING","strpos",141],"(",["T_VARIABLE","$condition",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$excludeJoinPart",141],")",["T_WHITESPACE"," ",141],["T_IS_NOT_IDENTICAL","!==",141],["T_WHITESPACE"," ",141],["T_STRING","false",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_CONTINUE","continue",142],";",["T_WHITESPACE","\n            ",142],"}",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$select",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","where",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_replaceTableAlias",144],"(",["T_VARIABLE","$condition",144],")",")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$select",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","where",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_getPriceExpression",146],"(",["T_VARIABLE","$filter",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$select",146],")",["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","' IS NOT NULL'",146],")",";",["T_WHITESPACE","\n\n        ",146],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$select",148],";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Prepare response object and dispatch prepare price event\n     * Return response object\n     *\n     * @deprecated since 1.7.0.0\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param Varien_Db_Select $select\n     * @return Varien_Object\n     *\/",151],["T_WHITESPACE","\n    ",159],["T_PROTECTED","protected",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","_dispatchPreparePriceEvent",160],"(",["T_VARIABLE","$filter",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$select",160],")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_COMMENT","\/\/ prepare response object for event\n",162],["T_WHITESPACE","        ",163],["T_VARIABLE","$response",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_NEW","new",163],["T_WHITESPACE"," ",163],["T_STRING","Varien_Object",163],"(",")",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$response",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","setAdditionalCalculations",164],"(",["T_ARRAY","array",164],"(",")",")",";",["T_WHITESPACE","\n\n        ",164],["T_COMMENT","\/\/ prepare event arguments\n",166],["T_WHITESPACE","        ",167],["T_VARIABLE","$eventArgs",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_WHITESPACE","\n            ",167],["T_CONSTANT_ENCAPSED_STRING","'select'",168],["T_WHITESPACE","          ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$select",168],",",["T_WHITESPACE","\n            ",168],["T_CONSTANT_ENCAPSED_STRING","'table'",169],["T_WHITESPACE","           ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_getIndexTableAlias",169],"(",")",",",["T_WHITESPACE","\n            ",169],["T_CONSTANT_ENCAPSED_STRING","'store_id'",170],["T_WHITESPACE","        ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$filter",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getStoreId",170],"(",")",",",["T_WHITESPACE","\n            ",170],["T_CONSTANT_ENCAPSED_STRING","'response_object'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$response",171],["T_WHITESPACE","\n        ",171],")",";",["T_WHITESPACE","\n\n        ",172],["T_DOC_COMMENT","\/**\n         * @deprecated since 1.3.2.2\n         *\/",174],["T_WHITESPACE","\n        ",176],["T_STRING","Mage",177],["T_DOUBLE_COLON","::",177],["T_STRING","dispatchEvent",177],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex_prepare_price_select'",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$eventArgs",177],")",";",["T_WHITESPACE","\n\n        ",177],["T_DOC_COMMENT","\/**\n         * @since 1.4\n         *\/",179],["T_WHITESPACE","\n        ",181],["T_STRING","Mage",182],["T_DOUBLE_COLON","::",182],["T_STRING","dispatchEvent",182],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_prepare_price_select'",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$eventArgs",182],")",";",["T_WHITESPACE","\n\n        ",182],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$response",184],";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Retrieve maximal price for attribute\n     *\n     * @deprecated since 1.7.0.0\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @return float\n     *\/",187],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","getMaxPrice",194],"(",["T_VARIABLE","$filter",194],")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$filter",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getLayer",196],"(",")",["T_OBJECT_OPERATOR","->",196],["T_STRING","getProductCollection",196],"(",")",["T_OBJECT_OPERATOR","->",196],["T_STRING","getMaxPrice",196],"(",")",";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n\n    ",197],["T_DOC_COMMENT","\/**\n     * Price expression generated by products collection\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param Varien_Db_Select $select\n     * @param bool $replaceAlias\n     * @return string\n     *\/",199],["T_WHITESPACE","\n    ",206],["T_PROTECTED","protected",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","_getPriceExpression",207],"(",["T_VARIABLE","$filter",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$select",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$replaceAlias",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_STRING","true",207],")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$priceExpression",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$filter",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getLayer",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","getProductCollection",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","getPriceExpression",209],"(",["T_VARIABLE","$select",209],")",";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$additionalPriceExpression",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$filter",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getLayer",210],"(",")",["T_OBJECT_OPERATOR","->",210],["T_STRING","getProductCollection",210],"(",")",["T_OBJECT_OPERATOR","->",210],["T_STRING","getAdditionalPriceExpression",210],"(",["T_VARIABLE","$select",210],")",";",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$result",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_EMPTY","empty",211],"(",["T_VARIABLE","$additionalPriceExpression",211],")",["T_WHITESPACE","\n            ",211],"?",["T_WHITESPACE"," ",212],["T_VARIABLE","$priceExpression",212],["T_WHITESPACE","\n            ",212],":",["T_WHITESPACE"," ",213],"\"",["T_ENCAPSED_AND_WHITESPACE","(",213],["T_CURLY_OPEN","{",213],["T_VARIABLE","$priceExpression",213],"}",["T_ENCAPSED_AND_WHITESPACE"," ",213],["T_CURLY_OPEN","{",213],["T_VARIABLE","$additionalPriceExpression",213],"}",["T_ENCAPSED_AND_WHITESPACE",")",213],"\"",";",["T_WHITESPACE","\n        ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$replaceAlias",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$result",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_replaceTableAlias",215],"(",["T_VARIABLE","$result",215],")",";",["T_WHITESPACE","\n        ",215],"}",["T_WHITESPACE","\n\n        ",216],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$result",218],";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Get comparing value sql part\n     *\n     * @param float $price\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param bool $decrease\n     * @return float\n     *\/",221],["T_WHITESPACE","\n    ",228],["T_PROTECTED","protected",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","_getComparingValue",229],"(",["T_VARIABLE","$price",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$filter",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$decrease",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_STRING","true",229],")",["T_WHITESPACE","\n    ",229],"{",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$currencyRate",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$filter",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getLayer",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","getProductCollection",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","getCurrencyRate",231],"(",")",";",["T_WHITESPACE","\n        ",231],["T_IF","if",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$decrease",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$result",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$price",233],["T_WHITESPACE"," ",233],"-",["T_WHITESPACE"," ",233],"(",["T_STRING","self",233],["T_DOUBLE_COLON","::",233],["T_STRING","MIN_POSSIBLE_PRICE",233],["T_WHITESPACE"," ",233],"\/",["T_WHITESPACE"," ",233],["T_LNUMBER","2",233],")",")",["T_WHITESPACE"," ",233],"\/",["T_WHITESPACE"," ",233],["T_VARIABLE","$currencyRate",233],";",["T_WHITESPACE","\n        ",233],"}",["T_WHITESPACE"," ",234],["T_ELSE","else",234],["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$result",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$price",235],["T_WHITESPACE"," ",235],"+",["T_WHITESPACE"," ",235],"(",["T_STRING","self",235],["T_DOUBLE_COLON","::",235],["T_STRING","MIN_POSSIBLE_PRICE",235],["T_WHITESPACE"," ",235],"\/",["T_WHITESPACE"," ",235],["T_LNUMBER","2",235],")",")",["T_WHITESPACE"," ",235],"\/",["T_WHITESPACE"," ",235],["T_VARIABLE","$currencyRate",235],";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n        ",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_STRING","sprintf",237],"(",["T_CONSTANT_ENCAPSED_STRING","'%F'",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$result",237],")",";",["T_WHITESPACE","\n    ",237],"}",["T_WHITESPACE","\n\n    ",238],["T_DOC_COMMENT","\/**\n     * Get full price expression generated by products collection\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param Varien_Db_Select $select\n     * @return Zend_Db_Expr\n     *\/",240],["T_WHITESPACE","\n    ",246],["T_PROTECTED","protected",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","_getFullPriceExpression",247],"(",["T_VARIABLE","$filter",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$select",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_NEW","new",249],["T_WHITESPACE"," ",249],["T_STRING","Zend_Db_Expr",249],"(",["T_CONSTANT_ENCAPSED_STRING","'ROUND(('",249],["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_getPriceExpression",249],"(",["T_VARIABLE","$filter",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$select",249],")",["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","') * '",249],["T_WHITESPACE","\n            ",249],".",["T_WHITESPACE"," ",250],["T_VARIABLE","$filter",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getLayer",250],"(",")",["T_OBJECT_OPERATOR","->",250],["T_STRING","getProductCollection",250],"(",")",["T_OBJECT_OPERATOR","->",250],["T_STRING","getCurrencyRate",250],"(",")",["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","', 2)'",250],")",";",["T_WHITESPACE","\n    ",250],"}",["T_WHITESPACE","\n\n    ",251],["T_DOC_COMMENT","\/**\n     * Retrieve array with products counts per price range\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param int $range\n     * @return array\n     *\/",253],["T_WHITESPACE","\n    ",259],["T_PUBLIC","public",260],["T_WHITESPACE"," ",260],["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],["T_STRING","getCount",260],"(",["T_VARIABLE","$filter",260],",",["T_WHITESPACE"," ",260],["T_VARIABLE","$range",260],")",["T_WHITESPACE","\n    ",260],"{",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$select",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","_getSelect",262],"(",["T_VARIABLE","$filter",262],")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$priceExpression",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_getFullPriceExpression",263],"(",["T_VARIABLE","$filter",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$select",263],")",";",["T_WHITESPACE","\n\n        ",263],["T_DOC_COMMENT","\/**\n         * Check and set correct variable values to prevent SQL-injections\n         *\/",265],["T_WHITESPACE","\n        ",267],["T_VARIABLE","$range",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","floatval",268],"(",["T_VARIABLE","$range",268],")",";",["T_WHITESPACE","\n        ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$range",269],["T_WHITESPACE"," ",269],["T_IS_EQUAL","==",269],["T_WHITESPACE"," ",269],["T_LNUMBER","0",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$range",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_LNUMBER","1",270],";",["T_WHITESPACE","\n        ",270],"}",["T_WHITESPACE","\n        ",271],["T_VARIABLE","$countExpr",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_NEW","new",272],["T_WHITESPACE"," ",272],["T_STRING","Zend_Db_Expr",272],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",272],")",";",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$rangeExpr",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_NEW","new",273],["T_WHITESPACE"," ",273],["T_STRING","Zend_Db_Expr",273],"(","\"",["T_ENCAPSED_AND_WHITESPACE","FLOOR((",273],["T_CURLY_OPEN","{",273],["T_VARIABLE","$priceExpression",273],"}",["T_ENCAPSED_AND_WHITESPACE",") \/ ",273],["T_CURLY_OPEN","{",273],["T_VARIABLE","$range",273],"}",["T_ENCAPSED_AND_WHITESPACE",") + 1",273],"\"",")",";",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$rangeOrderExpr",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_NEW","new",274],["T_WHITESPACE"," ",274],["T_STRING","Zend_Db_Expr",274],"(","\"",["T_ENCAPSED_AND_WHITESPACE","FLOOR((",274],["T_CURLY_OPEN","{",274],["T_VARIABLE","$priceExpression",274],"}",["T_ENCAPSED_AND_WHITESPACE",") \/ ",274],["T_CURLY_OPEN","{",274],["T_VARIABLE","$range",274],"}",["T_ENCAPSED_AND_WHITESPACE",") + 1 ASC",274],"\"",")",";",["T_WHITESPACE","\n\n        ",274],["T_VARIABLE","$select",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","columns",276],"(",["T_ARRAY","array",276],"(",["T_WHITESPACE","\n            ",276],["T_CONSTANT_ENCAPSED_STRING","'range'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$rangeExpr",277],",",["T_WHITESPACE","\n            ",277],["T_CONSTANT_ENCAPSED_STRING","'count'",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$countExpr",278],["T_WHITESPACE","\n        ",278],")",")",";",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$select",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","group",280],"(",["T_VARIABLE","$rangeExpr",280],")",["T_OBJECT_OPERATOR","->",280],["T_STRING","order",280],"(",["T_VARIABLE","$rangeOrderExpr",280],")",";",["T_WHITESPACE","\n\n        ",280],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_getReadAdapter",282],"(",")",["T_OBJECT_OPERATOR","->",282],["T_STRING","fetchPairs",282],"(",["T_VARIABLE","$select",282],")",";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n\n    ",283],["T_DOC_COMMENT","\/**\n     * Apply attribute filter to product collection\n     *\n     * @deprecated since 1.7.0.0\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param int $range\n     * @param int $index    the range factor\n     * @return Mage_Catalog_Model_Resource_Layer_Filter_Price\n     *\/",285],["T_WHITESPACE","\n    ",293],["T_PUBLIC","public",294],["T_WHITESPACE"," ",294],["T_FUNCTION","function",294],["T_WHITESPACE"," ",294],["T_STRING","applyFilterToCollection",294],"(",["T_VARIABLE","$filter",294],",",["T_WHITESPACE"," ",294],["T_VARIABLE","$range",294],",",["T_WHITESPACE"," ",294],["T_VARIABLE","$index",294],")",["T_WHITESPACE","\n    ",294],"{",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$select",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$filter",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getLayer",296],"(",")",["T_OBJECT_OPERATOR","->",296],["T_STRING","getProductCollection",296],"(",")",["T_OBJECT_OPERATOR","->",296],["T_STRING","getSelect",296],"(",")",";",["T_WHITESPACE","\n        ",296],["T_VARIABLE","$priceExpr",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_getPriceExpression",297],"(",["T_VARIABLE","$filter",297],",",["T_WHITESPACE"," ",297],["T_VARIABLE","$select",297],")",";",["T_WHITESPACE","\n        ",297],["T_VARIABLE","$filter",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getLayer",298],"(",")",["T_OBJECT_OPERATOR","->",298],["T_STRING","getProductCollection",298],"(",")",["T_WHITESPACE","\n            ",298],["T_OBJECT_OPERATOR","->",299],["T_STRING","getSelect",299],"(",")",["T_WHITESPACE","\n            ",299],["T_OBJECT_OPERATOR","->",300],["T_STRING","where",300],"(",["T_VARIABLE","$priceExpr",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","' >= '",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_getComparingValue",300],"(","(",["T_VARIABLE","$range",300],["T_WHITESPACE"," ",300],"*",["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$index",300],["T_WHITESPACE"," ",300],"-",["T_WHITESPACE"," ",300],["T_LNUMBER","1",300],")",")",",",["T_WHITESPACE"," ",300],["T_VARIABLE","$filter",300],")",")",["T_WHITESPACE","\n            ",300],["T_OBJECT_OPERATOR","->",301],["T_STRING","where",301],"(",["T_VARIABLE","$priceExpr",301],["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","' < '",301],["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_getComparingValue",301],"(","(",["T_VARIABLE","$range",301],["T_WHITESPACE"," ",301],"*",["T_WHITESPACE"," ",301],["T_VARIABLE","$index",301],")",",",["T_WHITESPACE"," ",301],["T_VARIABLE","$filter",301],")",")",";",["T_WHITESPACE","\n\n        ",301],["T_RETURN","return",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],";",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n\n    ",304],["T_DOC_COMMENT","\/**\n     * Load range of product prices\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param int $limit\n     * @param null|int $offset\n     * @param null|int $lowerPrice\n     * @param null|int $upperPrice\n     * @return array\n     *\/",306],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","loadPrices",316],"(",["T_VARIABLE","$filter",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$limit",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$offset",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","null",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$lowerPrice",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","null",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$upperPrice",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","null",316],")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$select",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_getSelect",318],"(",["T_VARIABLE","$filter",318],")",";",["T_WHITESPACE","\n        ",318],["T_VARIABLE","$priceExpression",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","_getPriceExpression",319],"(",["T_VARIABLE","$filter",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$select",319],")",";",["T_WHITESPACE","\n        ",319],["T_VARIABLE","$select",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","columns",320],"(",["T_ARRAY","array",320],"(",["T_WHITESPACE","\n            ",320],["T_CONSTANT_ENCAPSED_STRING","'min_price_expr'",321],["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_getFullPriceExpression",321],"(",["T_VARIABLE","$filter",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$select",321],")",["T_WHITESPACE","\n        ",321],")",")",";",["T_WHITESPACE","\n        ",322],["T_IF","if",323],["T_WHITESPACE"," ",323],"(","!",["T_STRING","is_null",323],"(",["T_VARIABLE","$lowerPrice",323],")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n            ",323],["T_VARIABLE","$select",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","where",324],"(","\"",["T_VARIABLE","$priceExpression",324],["T_ENCAPSED_AND_WHITESPACE"," >= ",324],"\"",["T_WHITESPACE"," ",324],".",["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_getComparingValue",324],"(",["T_VARIABLE","$lowerPrice",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$filter",324],")",")",";",["T_WHITESPACE","\n        ",324],"}",["T_WHITESPACE","\n        ",325],["T_IF","if",326],["T_WHITESPACE"," ",326],"(","!",["T_STRING","is_null",326],"(",["T_VARIABLE","$upperPrice",326],")",")",["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n            ",326],["T_VARIABLE","$select",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","where",327],"(","\"",["T_VARIABLE","$priceExpression",327],["T_ENCAPSED_AND_WHITESPACE"," < ",327],"\"",["T_WHITESPACE"," ",327],".",["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_getComparingValue",327],"(",["T_VARIABLE","$upperPrice",327],",",["T_WHITESPACE"," ",327],["T_VARIABLE","$filter",327],")",")",";",["T_WHITESPACE","\n        ",327],"}",["T_WHITESPACE","\n        ",328],["T_VARIABLE","$select",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","order",329],"(","\"",["T_VARIABLE","$priceExpression",329],["T_ENCAPSED_AND_WHITESPACE"," ASC",329],"\"",")",["T_OBJECT_OPERATOR","->",329],["T_STRING","limit",329],"(",["T_VARIABLE","$limit",329],",",["T_WHITESPACE"," ",329],["T_VARIABLE","$offset",329],")",";",["T_WHITESPACE","\n\n        ",329],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_getReadAdapter",331],"(",")",["T_OBJECT_OPERATOR","->",331],["T_STRING","fetchCol",331],"(",["T_VARIABLE","$select",331],")",";",["T_WHITESPACE","\n    ",331],"}",["T_WHITESPACE","\n\n    ",332],["T_DOC_COMMENT","\/**\n     * Load range of product prices, preceding the price\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param float $price\n     * @param int $index\n     * @return array|false\n     *\/",334],["T_WHITESPACE","\n    ",341],["T_PUBLIC","public",342],["T_WHITESPACE"," ",342],["T_FUNCTION","function",342],["T_WHITESPACE"," ",342],["T_STRING","loadPreviousPrices",342],"(",["T_VARIABLE","$filter",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$price",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$index",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$lowerPrice",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","null",342],")",["T_WHITESPACE","\n    ",342],"{",["T_WHITESPACE","\n        ",343],["T_VARIABLE","$select",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_getSelect",344],"(",["T_VARIABLE","$filter",344],")",";",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$priceExpression",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_getPriceExpression",345],"(",["T_VARIABLE","$filter",345],",",["T_WHITESPACE"," ",345],["T_VARIABLE","$select",345],")",";",["T_WHITESPACE","\n        ",345],["T_VARIABLE","$select",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","columns",346],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",346],")",["T_OBJECT_OPERATOR","->",346],["T_STRING","where",346],"(","\"",["T_VARIABLE","$priceExpression",346],["T_ENCAPSED_AND_WHITESPACE"," < ",346],"\"",["T_WHITESPACE"," ",346],".",["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","_getComparingValue",346],"(",["T_VARIABLE","$price",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$filter",346],")",")",";",["T_WHITESPACE","\n        ",346],["T_IF","if",347],["T_WHITESPACE"," ",347],"(","!",["T_STRING","is_null",347],"(",["T_VARIABLE","$lowerPrice",347],")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$select",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","where",348],"(","\"",["T_VARIABLE","$priceExpression",348],["T_ENCAPSED_AND_WHITESPACE"," >= ",348],"\"",["T_WHITESPACE"," ",348],".",["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_getComparingValue",348],"(",["T_VARIABLE","$lowerPrice",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$filter",348],")",")",";",["T_WHITESPACE","\n        ",348],"}",["T_WHITESPACE","\n        ",349],["T_VARIABLE","$offset",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","_getReadAdapter",350],"(",")",["T_OBJECT_OPERATOR","->",350],["T_STRING","fetchOne",350],"(",["T_VARIABLE","$select",350],")",";",["T_WHITESPACE","\n        ",350],["T_IF","if",351],["T_WHITESPACE"," ",351],"(","!",["T_VARIABLE","$offset",351],")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n            ",351],["T_RETURN","return",352],["T_WHITESPACE"," ",352],["T_STRING","false",352],";",["T_WHITESPACE","\n        ",352],"}",["T_WHITESPACE","\n\n        ",353],["T_RETURN","return",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","loadPrices",355],"(",["T_VARIABLE","$filter",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$index",355],["T_WHITESPACE"," ",355],"-",["T_WHITESPACE"," ",355],["T_VARIABLE","$offset",355],["T_WHITESPACE"," ",355],"+",["T_WHITESPACE"," ",355],["T_LNUMBER","1",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$offset",355],["T_WHITESPACE"," ",355],"-",["T_WHITESPACE"," ",355],["T_LNUMBER","1",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$lowerPrice",355],")",";",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n\n    ",356],["T_DOC_COMMENT","\/**\n     * Load range of product prices, next to the price\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @param float $price\n     * @param int $rightIndex\n     * @param null|int $upperPrice\n     * @return array\n     *\/",358],["T_WHITESPACE","\n    ",366],["T_PUBLIC","public",367],["T_WHITESPACE"," ",367],["T_FUNCTION","function",367],["T_WHITESPACE"," ",367],["T_STRING","loadNextPrices",367],"(",["T_VARIABLE","$filter",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$price",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$rightIndex",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$upperPrice",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_STRING","null",367],")",["T_WHITESPACE","\n    ",367],"{",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$select",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_getSelect",369],"(",["T_VARIABLE","$filter",369],")",";",["T_WHITESPACE","\n\n        ",369],["T_VARIABLE","$pricesSelect",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_CLONE","clone",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$select",371],";",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$priceExpression",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_getPriceExpression",372],"(",["T_VARIABLE","$filter",372],",",["T_WHITESPACE"," ",372],["T_VARIABLE","$pricesSelect",372],")",";",["T_WHITESPACE","\n\n        ",372],["T_VARIABLE","$select",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","columns",374],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",374],")",["T_OBJECT_OPERATOR","->",374],["T_STRING","where",374],"(","\"",["T_VARIABLE","$priceExpression",374],["T_ENCAPSED_AND_WHITESPACE"," > ",374],"\"",["T_WHITESPACE"," ",374],".",["T_WHITESPACE"," ",374],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","_getComparingValue",374],"(",["T_VARIABLE","$price",374],",",["T_WHITESPACE"," ",374],["T_VARIABLE","$filter",374],",",["T_WHITESPACE"," ",374],["T_STRING","false",374],")",")",";",["T_WHITESPACE","\n        ",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(","!",["T_STRING","is_null",375],"(",["T_VARIABLE","$upperPrice",375],")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_VARIABLE","$select",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","where",376],"(","\"",["T_VARIABLE","$priceExpression",376],["T_ENCAPSED_AND_WHITESPACE"," < ",376],"\"",["T_WHITESPACE"," ",376],".",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_getComparingValue",376],"(",["T_VARIABLE","$upperPrice",376],",",["T_WHITESPACE"," ",376],["T_VARIABLE","$filter",376],")",")",";",["T_WHITESPACE","\n        ",376],"}",["T_WHITESPACE","\n        ",377],["T_VARIABLE","$offset",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_getReadAdapter",378],"(",")",["T_OBJECT_OPERATOR","->",378],["T_STRING","fetchOne",378],"(",["T_VARIABLE","$select",378],")",";",["T_WHITESPACE","\n        ",378],["T_IF","if",379],["T_WHITESPACE"," ",379],"(","!",["T_VARIABLE","$offset",379],")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n            ",379],["T_RETURN","return",380],["T_WHITESPACE"," ",380],["T_STRING","false",380],";",["T_WHITESPACE","\n        ",380],"}",["T_WHITESPACE","\n\n        ",381],["T_VARIABLE","$pricesSelect",383],["T_WHITESPACE","\n            ",383],["T_OBJECT_OPERATOR","->",384],["T_STRING","columns",384],"(",["T_ARRAY","array",384],"(",["T_WHITESPACE","\n                ",384],["T_CONSTANT_ENCAPSED_STRING","'min_price_expr'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","_getFullPriceExpression",385],"(",["T_VARIABLE","$filter",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$pricesSelect",385],")",["T_WHITESPACE","\n            ",385],")",")",["T_WHITESPACE","\n            ",386],["T_OBJECT_OPERATOR","->",387],["T_STRING","where",387],"(","\"",["T_VARIABLE","$priceExpression",387],["T_ENCAPSED_AND_WHITESPACE"," >= ",387],"\"",["T_WHITESPACE"," ",387],".",["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","_getComparingValue",387],"(",["T_VARIABLE","$price",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$filter",387],")",")",";",["T_WHITESPACE","\n        ",387],["T_IF","if",388],["T_WHITESPACE"," ",388],"(","!",["T_STRING","is_null",388],"(",["T_VARIABLE","$upperPrice",388],")",")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$pricesSelect",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","where",389],"(","\"",["T_VARIABLE","$priceExpression",389],["T_ENCAPSED_AND_WHITESPACE"," < ",389],"\"",["T_WHITESPACE"," ",389],".",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_getComparingValue",389],"(",["T_VARIABLE","$upperPrice",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$filter",389],")",")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n        ",390],["T_VARIABLE","$pricesSelect",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","order",391],"(","\"",["T_VARIABLE","$priceExpression",391],["T_ENCAPSED_AND_WHITESPACE"," DESC",391],"\"",")",["T_OBJECT_OPERATOR","->",391],["T_STRING","limit",391],"(",["T_VARIABLE","$rightIndex",391],["T_WHITESPACE"," ",391],"-",["T_WHITESPACE"," ",391],["T_VARIABLE","$offset",391],["T_WHITESPACE"," ",391],"+",["T_WHITESPACE"," ",391],["T_LNUMBER","1",391],",",["T_WHITESPACE"," ",391],["T_VARIABLE","$offset",391],["T_WHITESPACE"," ",391],"-",["T_WHITESPACE"," ",391],["T_LNUMBER","1",391],")",";",["T_WHITESPACE","\n\n        ",391],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_STRING","array_reverse",393],"(",["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_getReadAdapter",393],"(",")",["T_OBJECT_OPERATOR","->",393],["T_STRING","fetchCol",393],"(",["T_VARIABLE","$pricesSelect",393],")",")",";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n\n    ",394],["T_DOC_COMMENT","\/**\n     * Apply price range filter to product collection\n     *\n     * @param Mage_Catalog_Model_Layer_Filter_Price $filter\n     * @return Mage_Catalog_Model_Resource_Layer_Filter_Price\n     *\/",396],["T_WHITESPACE","\n    ",401],["T_PUBLIC","public",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","applyPriceRange",402],"(",["T_VARIABLE","$filter",402],")",["T_WHITESPACE","\n    ",402],"{",["T_WHITESPACE","\n        ",403],["T_VARIABLE","$interval",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_VARIABLE","$filter",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","getInterval",404],"(",")",";",["T_WHITESPACE","\n        ",404],["T_IF","if",405],["T_WHITESPACE"," ",405],"(","!",["T_VARIABLE","$interval",405],")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n            ",405],["T_RETURN","return",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],";",["T_WHITESPACE","\n        ",406],"}",["T_WHITESPACE","\n\n        ",407],["T_LIST","list",409],"(",["T_VARIABLE","$from",409],",",["T_WHITESPACE"," ",409],["T_VARIABLE","$to",409],")",["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$interval",409],";",["T_WHITESPACE","\n        ",409],["T_IF","if",410],["T_WHITESPACE"," ",410],"(",["T_VARIABLE","$from",410],["T_WHITESPACE"," ",410],["T_IS_IDENTICAL","===",410],["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","''",410],["T_WHITESPACE"," ",410],["T_BOOLEAN_AND","&&",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$to",410],["T_WHITESPACE"," ",410],["T_IS_IDENTICAL","===",410],["T_WHITESPACE"," ",410],["T_CONSTANT_ENCAPSED_STRING","''",410],")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n            ",410],["T_RETURN","return",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$this",411],";",["T_WHITESPACE","\n        ",411],"}",["T_WHITESPACE","\n\n        ",412],["T_VARIABLE","$select",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$filter",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getLayer",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","getProductCollection",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","getSelect",414],"(",")",";",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$priceExpr",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","_getPriceExpression",415],"(",["T_VARIABLE","$filter",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$select",415],",",["T_WHITESPACE"," ",415],["T_STRING","false",415],")",";",["T_WHITESPACE","\n\n        ",415],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$to",417],["T_WHITESPACE"," ",417],["T_IS_NOT_IDENTICAL","!==",417],["T_WHITESPACE"," ",417],["T_CONSTANT_ENCAPSED_STRING","''",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_VARIABLE","$to",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_DOUBLE_CAST","(float)",418],["T_VARIABLE","$to",418],";",["T_WHITESPACE","\n            ",418],["T_IF","if",419],["T_WHITESPACE"," ",419],"(",["T_VARIABLE","$from",419],["T_WHITESPACE"," ",419],["T_IS_EQUAL","==",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$to",419],")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                ",419],["T_VARIABLE","$to",420],["T_WHITESPACE"," ",420],["T_PLUS_EQUAL","+=",420],["T_WHITESPACE"," ",420],["T_STRING","self",420],["T_DOUBLE_COLON","::",420],["T_STRING","MIN_POSSIBLE_PRICE",420],";",["T_WHITESPACE","\n            ",420],"}",["T_WHITESPACE","\n        ",421],"}",["T_WHITESPACE","\n\n        ",422],["T_IF","if",424],["T_WHITESPACE"," ",424],"(",["T_VARIABLE","$from",424],["T_WHITESPACE"," ",424],["T_IS_NOT_IDENTICAL","!==",424],["T_WHITESPACE"," ",424],["T_CONSTANT_ENCAPSED_STRING","''",424],")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n            ",424],["T_VARIABLE","$select",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","where",425],"(",["T_VARIABLE","$priceExpr",425],["T_WHITESPACE"," ",425],".",["T_WHITESPACE"," ",425],["T_CONSTANT_ENCAPSED_STRING","' >= '",425],["T_WHITESPACE"," ",425],".",["T_WHITESPACE"," ",425],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","_getComparingValue",425],"(",["T_VARIABLE","$from",425],",",["T_WHITESPACE"," ",425],["T_VARIABLE","$filter",425],")",")",";",["T_WHITESPACE","\n        ",425],"}",["T_WHITESPACE","\n        ",426],["T_IF","if",427],["T_WHITESPACE"," ",427],"(",["T_VARIABLE","$to",427],["T_WHITESPACE"," ",427],["T_IS_NOT_IDENTICAL","!==",427],["T_WHITESPACE"," ",427],["T_CONSTANT_ENCAPSED_STRING","''",427],")",["T_WHITESPACE"," ",427],"{",["T_WHITESPACE","\n            ",427],["T_VARIABLE","$select",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","where",428],"(",["T_VARIABLE","$priceExpr",428],["T_WHITESPACE"," ",428],".",["T_WHITESPACE"," ",428],["T_CONSTANT_ENCAPSED_STRING","' < '",428],["T_WHITESPACE"," ",428],".",["T_WHITESPACE"," ",428],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","_getComparingValue",428],"(",["T_VARIABLE","$to",428],",",["T_WHITESPACE"," ",428],["T_VARIABLE","$filter",428],")",")",";",["T_WHITESPACE","\n        ",428],"}",["T_WHITESPACE","\n\n        ",429],["T_RETURN","return",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],";",["T_WHITESPACE","\n\n    ",431],"}",["T_WHITESPACE","\n",433],"}",["T_WHITESPACE","\n",434]]