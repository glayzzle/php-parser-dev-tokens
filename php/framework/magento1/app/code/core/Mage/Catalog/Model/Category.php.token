[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog category\n *\n * @category   Mage\n * @package    Mage_Catalog\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Category",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Entity code.\n     * Can be used as part of method name for entity processing\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","ENTITY",41],["T_WHITESPACE","                ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'catalog_category'",41],";",["T_WHITESPACE","\n    ",41],["T_DOC_COMMENT","\/**\n     * Category display modes\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","DM_PRODUCT",45],["T_WHITESPACE","            ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'PRODUCTS'",45],";",["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","DM_PAGE",46],["T_WHITESPACE","               ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'PAGE'",46],";",["T_WHITESPACE","\n    ",46],["T_CONST","const",47],["T_WHITESPACE"," ",47],["T_STRING","DM_MIXED",47],["T_WHITESPACE","              ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'PRODUCTS_AND_PAGE'",47],";",["T_WHITESPACE","\n    ",47],["T_CONST","const",48],["T_WHITESPACE"," ",48],["T_STRING","TREE_ROOT_ID",48],["T_WHITESPACE","          ",48],"=",["T_WHITESPACE"," ",48],["T_LNUMBER","1",48],";",["T_WHITESPACE","\n\n    ",48],["T_CONST","const",50],["T_WHITESPACE"," ",50],["T_STRING","CACHE_TAG",50],["T_WHITESPACE","             ",50],"=",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'catalog_category'",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Prefix of model events names\n     *\n     * @var string\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_eventPrefix",57],["T_WHITESPACE","     ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'catalog_category'",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Parameter name in event\n     *\n     * @var string\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_eventObject",64],["T_WHITESPACE","     ",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'category'",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Model cache tag for clear cache in after save and after delete\n     *\/",66],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_cacheTag",69],["T_WHITESPACE","        ",69],"=",["T_WHITESPACE"," ",69],["T_STRING","self",69],["T_DOUBLE_COLON","::",69],["T_STRING","CACHE_TAG",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * URL Model instance\n     *\n     * @var Mage_Core_Model_Url\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_STATIC","static",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_url",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * URL rewrite model\n     *\n     * @var Mage_Core_Model_Url_Rewrite\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_STATIC","static",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$_urlRewrite",83],";",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Use flat resource model flag\n     *\n     * @var bool\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$_useFlatResource",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","false",90],";",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Category design attributes\n     *\n     * @var array\n     *\/",92],["T_WHITESPACE","\n    ",96],["T_PRIVATE","private",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$_designAttributes",97],["T_WHITESPACE","  ",97],"=",["T_WHITESPACE"," ",97],["T_ARRAY","array",97],"(",["T_WHITESPACE","\n        ",97],["T_CONSTANT_ENCAPSED_STRING","'custom_design'",98],",",["T_WHITESPACE","\n        ",98],["T_CONSTANT_ENCAPSED_STRING","'custom_design_from'",99],",",["T_WHITESPACE","\n        ",99],["T_CONSTANT_ENCAPSED_STRING","'custom_design_to'",100],",",["T_WHITESPACE","\n        ",100],["T_CONSTANT_ENCAPSED_STRING","'page_layout'",101],",",["T_WHITESPACE","\n        ",101],["T_CONSTANT_ENCAPSED_STRING","'custom_layout_update'",102],",",["T_WHITESPACE","\n        ",102],["T_CONSTANT_ENCAPSED_STRING","'custom_apply_to_products'",103],["T_WHITESPACE","\n    ",103],")",";",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Category tree model\n     *\n     * @var Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Tree\n     *\/",106],["T_WHITESPACE","\n    ",110],["T_PROTECTED","protected",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$_treeModel",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","null",111],";",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Category Url instance\n     *\n     * @var Mage_Catalog_Model_Category_Url\n     *\/",113],["T_WHITESPACE","\n    ",117],["T_PROTECTED","protected",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$_urlModel",118],";",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * Initialize resource mode\n     *\n     * @return void\n     *\/",120],["T_WHITESPACE","\n    ",124],["T_PROTECTED","protected",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","_construct",125],"(",")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_COMMENT","\/\/ If Flat Data enabled then use it but only on frontend\n",127],["T_WHITESPACE","        ",128],["T_VARIABLE","$flatHelper",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","Mage",128],["T_DOUBLE_COLON","::",128],["T_STRING","helper",128],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",128],")",";",["T_WHITESPACE","\n        ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$flatHelper",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","isAvailable",129],"(",")",["T_WHITESPACE"," ",129],["T_BOOLEAN_AND","&&",129],["T_WHITESPACE"," ",129],"!",["T_STRING","Mage",129],["T_DOUBLE_COLON","::",129],["T_STRING","app",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","getStore",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","isAdmin",129],"(",")",["T_WHITESPACE"," ",129],["T_BOOLEAN_AND","&&",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$flatHelper",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","isBuilt",129],"(",["T_STRING","true",129],")",["T_WHITESPACE","\n            ",129],["T_BOOLEAN_AND","&&",130],["T_WHITESPACE"," ",130],"!",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getDisableFlat",130],"(",")",["T_WHITESPACE","\n        ",130],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_init",132],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_flat'",132],")",";",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_useFlatResource",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","true",133],";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_ELSE","else",134],["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_init",135],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",135],")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Retrieve URL instance\n     *\n     * @return Mage_Core_Model_Url\n     *\/",139],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","getUrlInstance",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(","!",["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_VARIABLE","$_url",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_STRING","self",147],["T_DOUBLE_COLON","::",147],["T_VARIABLE","$_url",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","Mage",147],["T_DOUBLE_COLON","::",147],["T_STRING","getModel",147],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/url'",147],")",";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","self",149],["T_DOUBLE_COLON","::",149],["T_VARIABLE","$_url",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Get url rewrite model\n     *\n     * @return Mage_Core_Model_Url_Rewrite\n     *\/",152],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","getUrlRewrite",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(","!",["T_STRING","self",159],["T_DOUBLE_COLON","::",159],["T_VARIABLE","$_urlRewrite",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_STRING","self",160],["T_DOUBLE_COLON","::",160],["T_VARIABLE","$_urlRewrite",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","Mage",160],["T_DOUBLE_COLON","::",160],["T_STRING","getSingleton",160],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/factory'",160],")",["T_OBJECT_OPERATOR","->",160],["T_STRING","getUrlRewriteInstance",160],"(",")",";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_STRING","self",162],["T_DOUBLE_COLON","::",162],["T_VARIABLE","$_urlRewrite",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Retrieve category tree model\n     *\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Tree\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","getTreeModel",170],"(",")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_STRING","Mage",172],["T_DOUBLE_COLON","::",172],["T_STRING","getResourceModel",172],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_tree'",172],")",";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Enter description here...\n     *\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Tree\n     *\/",175],["T_WHITESPACE","\n    ",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","getTreeModelInstance",180],"(",")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_STRING","is_null",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_treeModel",182],")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_treeModel",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_STRING","Mage",183],["T_DOUBLE_COLON","::",183],["T_STRING","getResourceSingleton",183],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_tree'",183],")",";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n        ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_treeModel",185],";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Move category\n     *\n     * @param   int $parentId new parent category id\n     * @param   int $afterCategoryId category id after which we have put current category\n     * @return  Mage_Catalog_Model_Category\n     *\/",188],["T_WHITESPACE","\n    ",194],["T_PUBLIC","public",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","move",195],"(",["T_VARIABLE","$parentId",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$afterCategoryId",195],")",["T_WHITESPACE","\n    ",195],"{",["T_WHITESPACE","\n        ",196],["T_DOC_COMMENT","\/**\n         * Validate new parent category id. (category model is used for backward\n         * compatibility in event params)\n         *\/",197],["T_WHITESPACE","\n        ",200],["T_VARIABLE","$parent",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","Mage",201],["T_DOUBLE_COLON","::",201],["T_STRING","getModel",201],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",201],")",["T_WHITESPACE","\n            ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","setStoreId",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getStoreId",202],"(",")",")",["T_WHITESPACE","\n            ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","load",203],"(",["T_VARIABLE","$parentId",203],")",";",["T_WHITESPACE","\n\n        ",203],["T_IF","if",205],["T_WHITESPACE"," ",205],"(","!",["T_VARIABLE","$parent",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getId",205],"(",")",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n            ",205],["T_STRING","Mage",206],["T_DOUBLE_COLON","::",206],["T_STRING","throwException",206],"(",["T_WHITESPACE","\n                ",206],["T_STRING","Mage",207],["T_DOUBLE_COLON","::",207],["T_STRING","helper",207],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",207],")",["T_OBJECT_OPERATOR","->",207],["T_STRING","__",207],"(",["T_CONSTANT_ENCAPSED_STRING","'Category move operation is not possible: the new parent category was not found.'",207],")",["T_WHITESPACE","\n            ",207],")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n\n        ",209],["T_IF","if",211],["T_WHITESPACE"," ",211],"(","!",["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getId",211],"(",")",")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n            ",211],["T_STRING","Mage",212],["T_DOUBLE_COLON","::",212],["T_STRING","throwException",212],"(",["T_WHITESPACE","\n                ",212],["T_STRING","Mage",213],["T_DOUBLE_COLON","::",213],["T_STRING","helper",213],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",213],")",["T_OBJECT_OPERATOR","->",213],["T_STRING","__",213],"(",["T_CONSTANT_ENCAPSED_STRING","'Category move operation is not possible: the current category was not found.'",213],")",["T_WHITESPACE","\n            ",213],")",";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE"," ",215],["T_ELSEIF","elseif",215],["T_WHITESPACE"," ",215],"(",["T_VARIABLE","$parent",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getId",215],"(",")",["T_WHITESPACE"," ",215],["T_IS_EQUAL","==",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getId",215],"(",")",")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_STRING","Mage",216],["T_DOUBLE_COLON","::",216],["T_STRING","throwException",216],"(",["T_WHITESPACE","\n                ",216],["T_STRING","Mage",217],["T_DOUBLE_COLON","::",217],["T_STRING","helper",217],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",217],")",["T_OBJECT_OPERATOR","->",217],["T_STRING","__",217],"(",["T_CONSTANT_ENCAPSED_STRING","'Category move operation is not possible: parent category is equal to child category.'",217],")",["T_WHITESPACE","\n            ",217],")",";",["T_WHITESPACE","\n        ",218],"}",["T_WHITESPACE","\n\n        ",219],["T_DOC_COMMENT","\/**\n         * Setting affected category ids for third party engine index refresh\n        *\/",221],["T_WHITESPACE","\n        ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","setMovedCategoryId",224],"(",["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getId",224],"(",")",")",";",["T_WHITESPACE","\n\n        ",224],["T_VARIABLE","$eventParams",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_eventObject",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],",",["T_WHITESPACE","\n            ",227],["T_CONSTANT_ENCAPSED_STRING","'parent'",228],["T_WHITESPACE","        ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$parent",228],",",["T_WHITESPACE","\n            ",228],["T_CONSTANT_ENCAPSED_STRING","'category_id'",229],["T_WHITESPACE","   ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getId",229],"(",")",",",["T_WHITESPACE","\n            ",229],["T_CONSTANT_ENCAPSED_STRING","'prev_parent_id'",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getParentId",230],"(",")",",",["T_WHITESPACE","\n            ",230],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",231],["T_WHITESPACE","     ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$parentId",231],["T_WHITESPACE","\n        ",231],")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$moveComplete",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","false",233],";",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_getResource",235],"(",")",["T_OBJECT_OPERATOR","->",235],["T_STRING","beginTransaction",235],"(",")",";",["T_WHITESPACE","\n        ",235],["T_TRY","try",236],["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_DOC_COMMENT","\/**\n             * catalog_category_tree_move_before and catalog_category_tree_move_after\n             * events declared for backward compatibility\n             *\/",237],["T_WHITESPACE","\n            ",240],["T_STRING","Mage",241],["T_DOUBLE_COLON","::",241],["T_STRING","dispatchEvent",241],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_move_before'",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$eventParams",241],")",";",["T_WHITESPACE","\n            ",241],["T_STRING","Mage",242],["T_DOUBLE_COLON","::",242],["T_STRING","dispatchEvent",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_eventPrefix",242],".",["T_CONSTANT_ENCAPSED_STRING","'_move_before'",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$eventParams",242],")",";",["T_WHITESPACE","\n\n            ",242],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getResource",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","changeParent",244],"(",["T_VARIABLE","$this",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$parent",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$afterCategoryId",244],")",";",["T_WHITESPACE","\n\n            ",244],["T_STRING","Mage",246],["T_DOUBLE_COLON","::",246],["T_STRING","dispatchEvent",246],"(",["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_eventPrefix",246],".",["T_CONSTANT_ENCAPSED_STRING","'_move_after'",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$eventParams",246],")",";",["T_WHITESPACE","\n            ",246],["T_STRING","Mage",247],["T_DOUBLE_COLON","::",247],["T_STRING","dispatchEvent",247],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_move_after'",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$eventParams",247],")",";",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_getResource",248],"(",")",["T_OBJECT_OPERATOR","->",248],["T_STRING","commit",248],"(",")",";",["T_WHITESPACE","\n\n            ",248],["T_COMMENT","\/\/ Set data for indexer\n",250],["T_WHITESPACE","            ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","setAffectedCategoryIds",251],"(",["T_ARRAY","array",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getId",251],"(",")",",",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getParentId",251],"(",")",",",["T_WHITESPACE"," ",251],["T_VARIABLE","$parentId",251],")",")",";",["T_WHITESPACE","\n\n            ",251],["T_VARIABLE","$moveComplete",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_STRING","true",253],";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE"," ",254],["T_CATCH","catch",254],["T_WHITESPACE"," ",254],"(",["T_STRING","Exception",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$e",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_getResource",255],"(",")",["T_OBJECT_OPERATOR","->",255],["T_STRING","rollBack",255],"(",")",";",["T_WHITESPACE","\n            ",255],["T_THROW","throw",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$e",256],";",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n        ",257],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$moveComplete",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n            ",258],["T_STRING","Mage",259],["T_DOUBLE_COLON","::",259],["T_STRING","dispatchEvent",259],"(",["T_CONSTANT_ENCAPSED_STRING","'category_move'",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$eventParams",259],")",";",["T_WHITESPACE","\n            ",259],["T_STRING","Mage",260],["T_DOUBLE_COLON","::",260],["T_STRING","getSingleton",260],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/indexer'",260],")",["T_OBJECT_OPERATOR","->",260],["T_STRING","processEntityAction",260],"(",["T_WHITESPACE","\n                ",260],["T_VARIABLE","$this",261],",",["T_WHITESPACE"," ",261],["T_STRING","self",261],["T_DOUBLE_COLON","::",261],["T_STRING","ENTITY",261],",",["T_WHITESPACE"," ",261],["T_STRING","Mage_Index_Model_Event",261],["T_DOUBLE_COLON","::",261],["T_STRING","TYPE_SAVE",261],["T_WHITESPACE","\n            ",261],")",";",["T_WHITESPACE","\n            ",262],["T_STRING","Mage",263],["T_DOUBLE_COLON","::",263],["T_STRING","app",263],"(",")",["T_OBJECT_OPERATOR","->",263],["T_STRING","cleanCache",263],"(",["T_ARRAY","array",263],"(",["T_STRING","self",263],["T_DOUBLE_COLON","::",263],["T_STRING","CACHE_TAG",263],")",")",";",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n\n        ",264],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],";",["T_WHITESPACE","\n    ",266],"}",["T_WHITESPACE","\n\n    ",267],["T_DOC_COMMENT","\/**\n     * Retrieve default attribute set id\n     *\n     * @return int\n     *\/",269],["T_WHITESPACE","\n    ",273],["T_PUBLIC","public",274],["T_WHITESPACE"," ",274],["T_FUNCTION","function",274],["T_WHITESPACE"," ",274],["T_STRING","getDefaultAttributeSetId",274],"(",")",["T_WHITESPACE","\n    ",274],"{",["T_WHITESPACE","\n        ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getResource",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","getEntityType",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","getDefaultAttributeSetId",276],"(",")",";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n\n    ",277],["T_DOC_COMMENT","\/**\n     * Get category products collection\n     *\n     * @return Varien_Data_Collection_Db\n     *\/",279],["T_WHITESPACE","\n    ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","getProductCollection",284],"(",")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$collection",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_STRING","Mage",286],["T_DOUBLE_COLON","::",286],["T_STRING","getResourceModel",286],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_collection'",286],")",["T_WHITESPACE","\n            ",286],["T_OBJECT_OPERATOR","->",287],["T_STRING","setStoreId",287],"(",["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getStoreId",287],"(",")",")",["T_WHITESPACE","\n            ",287],["T_OBJECT_OPERATOR","->",288],["T_STRING","addCategoryFilter",288],"(",["T_VARIABLE","$this",288],")",";",["T_WHITESPACE","\n        ",288],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$collection",289],";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_DOC_COMMENT","\/**\n     * Retrieve all customer attributes\n     *\n     * @todo Use with Flat Resource\n     * @return array\n     *\/",292],["T_WHITESPACE","\n    ",297],["T_PUBLIC","public",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","getAttributes",298],"(",["T_VARIABLE","$noDesignAttributes",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_STRING","false",298],")",["T_WHITESPACE","\n    ",298],"{",["T_WHITESPACE","\n        ",299],["T_VARIABLE","$result",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","getResource",300],"(",")",["T_WHITESPACE","\n            ",300],["T_OBJECT_OPERATOR","->",301],["T_STRING","loadAllAttributes",301],"(",["T_VARIABLE","$this",301],")",["T_WHITESPACE","\n            ",301],["T_OBJECT_OPERATOR","->",302],["T_STRING","getSortedAttributes",302],"(",")",";",["T_WHITESPACE","\n\n        ",302],["T_IF","if",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$noDesignAttributes",304],")","{",["T_WHITESPACE","\n            ",304],["T_FOREACH","foreach",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$result",305],["T_WHITESPACE"," ",305],["T_AS","as",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$k",305],["T_DOUBLE_ARROW","=>",305],["T_VARIABLE","$a",305],")","{",["T_WHITESPACE","\n                ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_STRING","in_array",306],"(",["T_VARIABLE","$k",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_designAttributes",306],")",")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                    ",306],["T_UNSET","unset",307],"(",["T_VARIABLE","$result",307],"[",["T_VARIABLE","$k",307],"]",")",";",["T_WHITESPACE","\n                ",307],"}",["T_WHITESPACE","\n            ",308],"}",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE","\n\n        ",310],["T_RETURN","return",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$result",312],";",["T_WHITESPACE","\n    ",312],"}",["T_WHITESPACE","\n\n    ",313],["T_DOC_COMMENT","\/**\n     * Retrieve array of product id's for category\n     *\n     * array($productId => $position)\n     *\n     * @return array\n     *\/",315],["T_WHITESPACE","\n    ",321],["T_PUBLIC","public",322],["T_WHITESPACE"," ",322],["T_FUNCTION","function",322],["T_WHITESPACE"," ",322],["T_STRING","getProductsPosition",322],"(",")",["T_WHITESPACE","\n    ",322],"{",["T_WHITESPACE","\n        ",323],["T_IF","if",324],["T_WHITESPACE"," ",324],"(","!",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getId",324],"(",")",")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_ARRAY","array",325],"(",")",";",["T_WHITESPACE","\n        ",325],"}",["T_WHITESPACE","\n\n        ",326],["T_VARIABLE","$array",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getData",328],"(",["T_CONSTANT_ENCAPSED_STRING","'products_position'",328],")",";",["T_WHITESPACE","\n        ",328],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_STRING","is_null",329],"(",["T_VARIABLE","$array",329],")",")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n            ",329],["T_VARIABLE","$array",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getResource",330],"(",")",["T_OBJECT_OPERATOR","->",330],["T_STRING","getProductsPosition",330],"(",["T_VARIABLE","$this",330],")",";",["T_WHITESPACE","\n            ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","setData",331],"(",["T_CONSTANT_ENCAPSED_STRING","'products_position'",331],",",["T_WHITESPACE"," ",331],["T_VARIABLE","$array",331],")",";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n        ",332],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$array",333],";",["T_WHITESPACE","\n    ",333],"}",["T_WHITESPACE","\n\n    ",334],["T_DOC_COMMENT","\/**\n     * Retrieve array of store ids for category\n     *\n     * @return array\n     *\/",336],["T_WHITESPACE","\n    ",340],["T_PUBLIC","public",341],["T_WHITESPACE"," ",341],["T_FUNCTION","function",341],["T_WHITESPACE"," ",341],["T_STRING","getStoreIds",341],"(",")",["T_WHITESPACE","\n    ",341],"{",["T_WHITESPACE","\n        ",342],["T_IF","if",343],["T_WHITESPACE"," ",343],"(",["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getInitialSetupFlag",343],"(",")",")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n            ",343],["T_RETURN","return",344],["T_WHITESPACE"," ",344],["T_ARRAY","array",344],"(",")",";",["T_WHITESPACE","\n        ",344],"}",["T_WHITESPACE","\n\n        ",345],["T_IF","if",347],["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$storeIds",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getData",347],"(",["T_CONSTANT_ENCAPSED_STRING","'store_ids'",347],")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n            ",347],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$storeIds",348],";",["T_WHITESPACE","\n        ",348],"}",["T_WHITESPACE","\n\n        ",349],["T_IF","if",351],["T_WHITESPACE"," ",351],"(","!",["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getId",351],"(",")",")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n            ",351],["T_RETURN","return",352],["T_WHITESPACE"," ",352],["T_ARRAY","array",352],"(",")",";",["T_WHITESPACE","\n        ",352],"}",["T_WHITESPACE","\n\n        ",353],["T_VARIABLE","$nodes",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_ARRAY","array",355],"(",")",";",["T_WHITESPACE","\n        ",355],["T_FOREACH","foreach",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getPathIds",356],"(",")",["T_WHITESPACE"," ",356],["T_AS","as",356],["T_WHITESPACE"," ",356],["T_VARIABLE","$id",356],")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$nodes",357],"[","]",["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_VARIABLE","$id",357],";",["T_WHITESPACE","\n        ",357],"}",["T_WHITESPACE","\n\n        ",358],["T_VARIABLE","$storeIds",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_ARRAY","array",360],"(",")",";",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$storeCollection",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_STRING","Mage",361],["T_DOUBLE_COLON","::",361],["T_STRING","getModel",361],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store'",361],")",["T_OBJECT_OPERATOR","->",361],["T_STRING","getCollection",361],"(",")",["T_OBJECT_OPERATOR","->",361],["T_STRING","loadByCategoryIds",361],"(",["T_VARIABLE","$nodes",361],")",";",["T_WHITESPACE","\n        ",361],["T_FOREACH","foreach",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$storeCollection",362],["T_WHITESPACE"," ",362],["T_AS","as",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$store",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_VARIABLE","$storeIds",363],"[",["T_VARIABLE","$store",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getId",363],"(",")","]",["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$store",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getId",363],"(",")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE","\n\n        ",364],["T_VARIABLE","$entityStoreId",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getStoreId",366],"(",")",";",["T_WHITESPACE","\n        ",366],["T_IF","if",367],["T_WHITESPACE"," ",367],"(","!",["T_STRING","in_array",367],"(",["T_VARIABLE","$entityStoreId",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$storeIds",367],")",")",["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n            ",367],["T_STRING","array_unshift",368],"(",["T_VARIABLE","$storeIds",368],",",["T_WHITESPACE"," ",368],["T_VARIABLE","$entityStoreId",368],")",";",["T_WHITESPACE","\n        ",368],"}",["T_WHITESPACE","\n        ",369],["T_IF","if",370],["T_WHITESPACE"," ",370],"(","!",["T_STRING","in_array",370],"(",["T_LNUMBER","0",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$storeIds",370],")",")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n            ",370],["T_STRING","array_unshift",371],"(",["T_VARIABLE","$storeIds",371],",",["T_WHITESPACE"," ",371],["T_LNUMBER","0",371],")",";",["T_WHITESPACE","\n        ",371],"}",["T_WHITESPACE","\n\n        ",372],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","setData",374],"(",["T_CONSTANT_ENCAPSED_STRING","'store_ids'",374],",",["T_WHITESPACE"," ",374],["T_VARIABLE","$storeIds",374],")",";",["T_WHITESPACE","\n        ",374],["T_RETURN","return",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$storeIds",375],";",["T_WHITESPACE","\n    ",375],"}",["T_WHITESPACE","\n\n    ",376],["T_DOC_COMMENT","\/**\n     * Retrieve Layout Update Handle name\n     *\n     * @return string\n     *\/",378],["T_WHITESPACE","\n    ",382],["T_PUBLIC","public",383],["T_WHITESPACE"," ",383],["T_FUNCTION","function",383],["T_WHITESPACE"," ",383],["T_STRING","getLayoutUpdateHandle",383],"(",")",["T_WHITESPACE","\n    ",383],"{",["T_WHITESPACE","\n        ",384],["T_VARIABLE","$layout",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_CONSTANT_ENCAPSED_STRING","'catalog_category_'",385],";",["T_WHITESPACE","\n        ",385],["T_IF","if",386],["T_WHITESPACE"," ",386],"(",["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getIsAnchor",386],"(",")",")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n            ",386],["T_VARIABLE","$layout",387],["T_WHITESPACE"," ",387],["T_CONCAT_EQUAL",".=",387],["T_WHITESPACE"," ",387],["T_CONSTANT_ENCAPSED_STRING","'layered'",387],";",["T_WHITESPACE","\n        ",387],"}",["T_WHITESPACE","\n        ",388],["T_ELSE","else",389],["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n            ",389],["T_VARIABLE","$layout",390],["T_WHITESPACE"," ",390],["T_CONCAT_EQUAL",".=",390],["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'default'",390],";",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n        ",391],["T_RETURN","return",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$layout",392],";",["T_WHITESPACE","\n    ",392],"}",["T_WHITESPACE","\n\n    ",393],["T_DOC_COMMENT","\/**\n     * Return store id.\n     *\n     * If store id is underfined for category return current active store id\n     *\n     * @return integer\n     *\/",395],["T_WHITESPACE","\n    ",401],["T_PUBLIC","public",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","getStoreId",402],"(",")",["T_WHITESPACE","\n    ",402],"{",["T_WHITESPACE","\n        ",403],["T_IF","if",404],["T_WHITESPACE"," ",404],"(",["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","hasData",404],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",404],")",")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n            ",404],["T_RETURN","return",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","_getData",405],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",405],")",";",["T_WHITESPACE","\n        ",405],"}",["T_WHITESPACE","\n        ",406],["T_RETURN","return",407],["T_WHITESPACE"," ",407],["T_STRING","Mage",407],["T_DOUBLE_COLON","::",407],["T_STRING","app",407],"(",")",["T_OBJECT_OPERATOR","->",407],["T_STRING","getStore",407],"(",")",["T_OBJECT_OPERATOR","->",407],["T_STRING","getId",407],"(",")",";",["T_WHITESPACE","\n    ",407],"}",["T_WHITESPACE","\n\n    ",408],["T_DOC_COMMENT","\/**\n     * Set store id\n     *\n     * @param integer $storeId\n     * @return Mage_Catalog_Model_Category\n     *\/",410],["T_WHITESPACE","\n    ",415],["T_PUBLIC","public",416],["T_WHITESPACE"," ",416],["T_FUNCTION","function",416],["T_WHITESPACE"," ",416],["T_STRING","setStoreId",416],"(",["T_VARIABLE","$storeId",416],")",["T_WHITESPACE","\n    ",416],"{",["T_WHITESPACE","\n        ",417],["T_IF","if",418],["T_WHITESPACE"," ",418],"(","!",["T_STRING","is_numeric",418],"(",["T_VARIABLE","$storeId",418],")",")",["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n            ",418],["T_VARIABLE","$storeId",419],["T_WHITESPACE"," ",419],"=",["T_WHITESPACE"," ",419],["T_STRING","Mage",419],["T_DOUBLE_COLON","::",419],["T_STRING","app",419],"(",["T_VARIABLE","$storeId",419],")",["T_OBJECT_OPERATOR","->",419],["T_STRING","getStore",419],"(",")",["T_OBJECT_OPERATOR","->",419],["T_STRING","getId",419],"(",")",";",["T_WHITESPACE","\n        ",419],"}",["T_WHITESPACE","\n        ",420],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","setData",421],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$storeId",421],")",";",["T_WHITESPACE","\n        ",421],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","getResource",422],"(",")",["T_OBJECT_OPERATOR","->",422],["T_STRING","setStoreId",422],"(",["T_VARIABLE","$storeId",422],")",";",["T_WHITESPACE","\n        ",422],["T_RETURN","return",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],";",["T_WHITESPACE","\n    ",423],"}",["T_WHITESPACE","\n\n    ",424],["T_DOC_COMMENT","\/**\n     * Get category url\n     *\n     * @return string\n     *\/",426],["T_WHITESPACE","\n    ",430],["T_PUBLIC","public",431],["T_WHITESPACE"," ",431],["T_FUNCTION","function",431],["T_WHITESPACE"," ",431],["T_STRING","getUrl",431],"(",")",["T_WHITESPACE","\n    ",431],"{",["T_WHITESPACE","\n        ",432],["T_RETURN","return",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","getUrlModel",433],"(",")",["T_OBJECT_OPERATOR","->",433],["T_STRING","getCategoryUrl",433],"(",["T_VARIABLE","$this",433],")",";",["T_WHITESPACE","\n    ",433],"}",["T_WHITESPACE","\n\n    ",434],["T_DOC_COMMENT","\/**\n     * Get product url model\n     *\n     * @return Mage_Catalog_Model_Category_Url\n     *\/",436],["T_WHITESPACE","\n    ",440],["T_PUBLIC","public",441],["T_WHITESPACE"," ",441],["T_FUNCTION","function",441],["T_WHITESPACE"," ",441],["T_STRING","getUrlModel",441],"(",")",["T_WHITESPACE","\n    ",441],"{",["T_WHITESPACE","\n        ",442],["T_IF","if",443],["T_WHITESPACE"," ",443],"(",["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","_urlModel",443],["T_WHITESPACE"," ",443],["T_IS_IDENTICAL","===",443],["T_WHITESPACE"," ",443],["T_STRING","null",443],")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n            ",443],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","_urlModel",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_STRING","Mage",444],["T_DOUBLE_COLON","::",444],["T_STRING","getSingleton",444],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/factory'",444],")",["T_OBJECT_OPERATOR","->",444],["T_STRING","getCategoryUrlInstance",444],"(",")",";",["T_WHITESPACE","\n        ",444],"}",["T_WHITESPACE","\n        ",445],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_urlModel",446],";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Retrieve category id URL\n     *\n     * @return string\n     *\/",449],["T_WHITESPACE","\n    ",453],["T_PUBLIC","public",454],["T_WHITESPACE"," ",454],["T_FUNCTION","function",454],["T_WHITESPACE"," ",454],["T_STRING","getCategoryIdUrl",454],"(",")",["T_WHITESPACE","\n    ",454],"{",["T_WHITESPACE","\n        ",455],["T_STRING","Varien_Profiler",456],["T_DOUBLE_COLON","::",456],["T_STRING","start",456],"(",["T_CONSTANT_ENCAPSED_STRING","'REGULAR: '",456],".",["T_METHOD_C","__METHOD__",456],")",";",["T_WHITESPACE","\n        ",456],["T_VARIABLE","$urlKey",457],["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","getUrlKey",457],"(",")",["T_WHITESPACE"," ",457],"?",["T_WHITESPACE"," ",457],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","getUrlKey",457],"(",")",["T_WHITESPACE"," ",457],":",["T_WHITESPACE"," ",457],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","formatUrlKey",457],"(",["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","getName",457],"(",")",")",";",["T_WHITESPACE","\n        ",457],["T_VARIABLE","$url",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getUrlInstance",458],"(",")",["T_OBJECT_OPERATOR","->",458],["T_STRING","getUrl",458],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category\/view'",458],",",["T_WHITESPACE"," ",458],["T_ARRAY","array",458],"(",["T_WHITESPACE","\n            ",458],["T_CONSTANT_ENCAPSED_STRING","'s'",459],["T_DOUBLE_ARROW","=>",459],["T_VARIABLE","$urlKey",459],",",["T_WHITESPACE","\n            ",459],["T_CONSTANT_ENCAPSED_STRING","'id'",460],["T_DOUBLE_ARROW","=>",460],["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","getId",460],"(",")",",",["T_WHITESPACE","\n        ",460],")",")",";",["T_WHITESPACE","\n        ",461],["T_STRING","Varien_Profiler",462],["T_DOUBLE_COLON","::",462],["T_STRING","stop",462],"(",["T_CONSTANT_ENCAPSED_STRING","'REGULAR: '",462],".",["T_METHOD_C","__METHOD__",462],")",";",["T_WHITESPACE","\n        ",462],["T_RETURN","return",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$url",463],";",["T_WHITESPACE","\n    ",463],"}",["T_WHITESPACE","\n\n    ",464],["T_DOC_COMMENT","\/**\n     * Format URL key from name or defined key\n     *\n     * @param string $str\n     * @return string\n     *\/",466],["T_WHITESPACE","\n    ",471],["T_PUBLIC","public",472],["T_WHITESPACE"," ",472],["T_FUNCTION","function",472],["T_WHITESPACE"," ",472],["T_STRING","formatUrlKey",472],"(",["T_VARIABLE","$str",472],")",["T_WHITESPACE","\n    ",472],"{",["T_WHITESPACE","\n        ",473],["T_VARIABLE","$str",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","Mage",474],["T_DOUBLE_COLON","::",474],["T_STRING","helper",474],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_url'",474],")",["T_OBJECT_OPERATOR","->",474],["T_STRING","format",474],"(",["T_VARIABLE","$str",474],")",";",["T_WHITESPACE","\n        ",474],["T_VARIABLE","$urlKey",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_STRING","preg_replace",475],"(",["T_CONSTANT_ENCAPSED_STRING","'#[^0-9a-z]+#i'",475],",",["T_WHITESPACE"," ",475],["T_CONSTANT_ENCAPSED_STRING","'-'",475],",",["T_WHITESPACE"," ",475],["T_VARIABLE","$str",475],")",";",["T_WHITESPACE","\n        ",475],["T_VARIABLE","$urlKey",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_STRING","strtolower",476],"(",["T_VARIABLE","$urlKey",476],")",";",["T_WHITESPACE","\n        ",476],["T_VARIABLE","$urlKey",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_STRING","trim",477],"(",["T_VARIABLE","$urlKey",477],",",["T_WHITESPACE"," ",477],["T_CONSTANT_ENCAPSED_STRING","'-'",477],")",";",["T_WHITESPACE","\n        ",477],["T_RETURN","return",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$urlKey",478],";",["T_WHITESPACE","\n    ",478],"}",["T_WHITESPACE","\n\n    ",479],["T_DOC_COMMENT","\/**\n     * Retrieve image URL\n     *\n     * @return string\n     *\/",481],["T_WHITESPACE","\n    ",485],["T_PUBLIC","public",486],["T_WHITESPACE"," ",486],["T_FUNCTION","function",486],["T_WHITESPACE"," ",486],["T_STRING","getImageUrl",486],"(",")",["T_WHITESPACE","\n    ",486],"{",["T_WHITESPACE","\n        ",487],["T_VARIABLE","$url",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_STRING","false",488],";",["T_WHITESPACE","\n        ",488],["T_IF","if",489],["T_WHITESPACE"," ",489],"(",["T_VARIABLE","$image",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","getImage",489],"(",")",")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n            ",489],["T_VARIABLE","$url",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_STRING","Mage",490],["T_DOUBLE_COLON","::",490],["T_STRING","getBaseUrl",490],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",490],")",".",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category\/'",490],".",["T_VARIABLE","$image",490],";",["T_WHITESPACE","\n        ",490],"}",["T_WHITESPACE","\n        ",491],["T_RETURN","return",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$url",492],";",["T_WHITESPACE","\n    ",492],"}",["T_WHITESPACE","\n\n    ",493],["T_DOC_COMMENT","\/**\n     * Retrieve URL path\n     *\n     * @return string\n     *\/",495],["T_WHITESPACE","\n    ",499],["T_PUBLIC","public",500],["T_WHITESPACE"," ",500],["T_FUNCTION","function",500],["T_WHITESPACE"," ",500],["T_STRING","getUrlPath",500],"(",")",["T_WHITESPACE","\n    ",500],"{",["T_WHITESPACE","\n        ",501],["T_VARIABLE","$path",502],["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","getData",502],"(",["T_CONSTANT_ENCAPSED_STRING","'url_path'",502],")",";",["T_WHITESPACE","\n        ",502],["T_IF","if",503],["T_WHITESPACE"," ",503],"(",["T_VARIABLE","$path",503],")",["T_WHITESPACE"," ",503],"{",["T_WHITESPACE","\n            ",503],["T_RETURN","return",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$path",504],";",["T_WHITESPACE","\n        ",504],"}",["T_WHITESPACE","\n\n        ",505],["T_VARIABLE","$path",507],["T_WHITESPACE"," ",507],"=",["T_WHITESPACE"," ",507],["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","getUrlKey",507],"(",")",";",["T_WHITESPACE","\n\n        ",507],["T_IF","if",509],["T_WHITESPACE"," ",509],"(",["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getParentId",509],"(",")",")",["T_WHITESPACE"," ",509],"{",["T_WHITESPACE","\n            ",509],["T_VARIABLE","$parentPath",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_STRING","Mage",510],["T_DOUBLE_COLON","::",510],["T_STRING","getModel",510],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",510],")",["T_OBJECT_OPERATOR","->",510],["T_STRING","load",510],"(",["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","getParentId",510],"(",")",")",["T_OBJECT_OPERATOR","->",510],["T_STRING","getCategoryPath",510],"(",")",";",["T_WHITESPACE","\n            ",510],["T_VARIABLE","$path",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_VARIABLE","$parentPath",511],".",["T_CONSTANT_ENCAPSED_STRING","'\/'",511],".",["T_VARIABLE","$path",511],";",["T_WHITESPACE","\n        ",511],"}",["T_WHITESPACE","\n\n        ",512],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","setUrlPath",514],"(",["T_VARIABLE","$path",514],")",";",["T_WHITESPACE","\n\n        ",514],["T_RETURN","return",516],["T_WHITESPACE"," ",516],["T_VARIABLE","$path",516],";",["T_WHITESPACE","\n    ",516],"}",["T_WHITESPACE","\n\n    ",517],["T_DOC_COMMENT","\/**\n     * Get parent category object\n     *\n     * @return Mage_Catalog_Model_Category\n     *\/",519],["T_WHITESPACE","\n    ",523],["T_PUBLIC","public",524],["T_WHITESPACE"," ",524],["T_FUNCTION","function",524],["T_WHITESPACE"," ",524],["T_STRING","getParentCategory",524],"(",")",["T_WHITESPACE","\n    ",524],"{",["T_WHITESPACE","\n        ",525],["T_IF","if",526],["T_WHITESPACE"," ",526],"(","!",["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","hasData",526],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_category'",526],")",")",["T_WHITESPACE"," ",526],"{",["T_WHITESPACE","\n            ",526],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","setData",527],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_category'",527],",",["T_WHITESPACE"," ",527],["T_STRING","Mage",527],["T_DOUBLE_COLON","::",527],["T_STRING","getModel",527],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",527],")",["T_OBJECT_OPERATOR","->",527],["T_STRING","load",527],"(",["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","getParentId",527],"(",")",")",")",";",["T_WHITESPACE","\n        ",527],"}",["T_WHITESPACE","\n        ",528],["T_RETURN","return",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","_getData",529],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_category'",529],")",";",["T_WHITESPACE","\n    ",529],"}",["T_WHITESPACE","\n\n    ",530],["T_DOC_COMMENT","\/**\n     * Get parent category identifier\n     *\n     * @return int\n     *\/",532],["T_WHITESPACE","\n    ",536],["T_PUBLIC","public",537],["T_WHITESPACE"," ",537],["T_FUNCTION","function",537],["T_WHITESPACE"," ",537],["T_STRING","getParentId",537],"(",")",["T_WHITESPACE","\n    ",537],"{",["T_WHITESPACE","\n        ",538],["T_VARIABLE","$parentIds",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getParentIds",539],"(",")",";",["T_WHITESPACE","\n        ",539],["T_RETURN","return",540],["T_WHITESPACE"," ",540],["T_STRING","intval",540],"(",["T_STRING","array_pop",540],"(",["T_VARIABLE","$parentIds",540],")",")",";",["T_WHITESPACE","\n    ",540],"}",["T_WHITESPACE","\n\n    ",541],["T_DOC_COMMENT","\/**\n     * Get all parent categories ids\n     *\n     * @return array\n     *\/",543],["T_WHITESPACE","\n    ",547],["T_PUBLIC","public",548],["T_WHITESPACE"," ",548],["T_FUNCTION","function",548],["T_WHITESPACE"," ",548],["T_STRING","getParentIds",548],"(",")",["T_WHITESPACE","\n    ",548],"{",["T_WHITESPACE","\n        ",549],["T_RETURN","return",550],["T_WHITESPACE"," ",550],["T_STRING","array_diff",550],"(",["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","getPathIds",550],"(",")",",",["T_WHITESPACE"," ",550],["T_ARRAY","array",550],"(",["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","getId",550],"(",")",")",")",";",["T_WHITESPACE","\n    ",550],"}",["T_WHITESPACE","\n\n    ",551],["T_DOC_COMMENT","\/**\n     * Retrieve dates for custom design (from & to)\n     *\n     * @return array\n     *\/",553],["T_WHITESPACE","\n    ",557],["T_PUBLIC","public",558],["T_WHITESPACE"," ",558],["T_FUNCTION","function",558],["T_WHITESPACE"," ",558],["T_STRING","getCustomDesignDate",558],"(",")",["T_WHITESPACE","\n    ",558],"{",["T_WHITESPACE","\n        ",559],["T_VARIABLE","$result",560],["T_WHITESPACE"," ",560],"=",["T_WHITESPACE"," ",560],["T_ARRAY","array",560],"(",")",";",["T_WHITESPACE","\n        ",560],["T_VARIABLE","$result",561],"[",["T_CONSTANT_ENCAPSED_STRING","'from'",561],"]",["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","getData",561],"(",["T_CONSTANT_ENCAPSED_STRING","'custom_design_from'",561],")",";",["T_WHITESPACE","\n        ",561],["T_VARIABLE","$result",562],"[",["T_CONSTANT_ENCAPSED_STRING","'to'",562],"]",["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","getData",562],"(",["T_CONSTANT_ENCAPSED_STRING","'custom_design_to'",562],")",";",["T_WHITESPACE","\n\n        ",562],["T_RETURN","return",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$result",564],";",["T_WHITESPACE","\n    ",564],"}",["T_WHITESPACE","\n\n    ",565],["T_DOC_COMMENT","\/**\n     * Retrieve design attributes array\n     *\n     * @return array\n     *\/",567],["T_WHITESPACE","\n    ",571],["T_PUBLIC","public",572],["T_WHITESPACE"," ",572],["T_FUNCTION","function",572],["T_WHITESPACE"," ",572],["T_STRING","getDesignAttributes",572],"(",")",["T_WHITESPACE","\n    ",572],"{",["T_WHITESPACE","\n        ",573],["T_VARIABLE","$result",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_ARRAY","array",574],"(",")",";",["T_WHITESPACE","\n        ",574],["T_FOREACH","foreach",575],["T_WHITESPACE"," ",575],"(",["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","_designAttributes",575],["T_WHITESPACE"," ",575],["T_AS","as",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$attrName",575],")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n            ",575],["T_VARIABLE","$result",576],"[","]",["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","_getAttribute",576],"(",["T_VARIABLE","$attrName",576],")",";",["T_WHITESPACE","\n        ",576],"}",["T_WHITESPACE","\n        ",577],["T_RETURN","return",578],["T_WHITESPACE"," ",578],["T_VARIABLE","$result",578],";",["T_WHITESPACE","\n    ",578],"}",["T_WHITESPACE","\n\n    ",579],["T_DOC_COMMENT","\/**\n     * Retrieve attribute by code\n     *\n     * @param string $attributeCode\n     * @return Mage_Eav_Model_Entity_Attribute_Abstract\n     *\/",581],["T_WHITESPACE","\n    ",586],["T_PRIVATE","private",587],["T_WHITESPACE"," ",587],["T_FUNCTION","function",587],["T_WHITESPACE"," ",587],["T_STRING","_getAttribute",587],"(",["T_VARIABLE","$attributeCode",587],")",["T_WHITESPACE","\n    ",587],"{",["T_WHITESPACE","\n        ",588],["T_IF","if",589],["T_WHITESPACE"," ",589],"(","!",["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","_useFlatResource",589],")",["T_WHITESPACE"," ",589],"{",["T_WHITESPACE","\n            ",589],["T_VARIABLE","$attribute",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","getResource",590],"(",")",["T_OBJECT_OPERATOR","->",590],["T_STRING","getAttribute",590],"(",["T_VARIABLE","$attributeCode",590],")",";",["T_WHITESPACE","\n        ",590],"}",["T_WHITESPACE","\n        ",591],["T_ELSE","else",592],["T_WHITESPACE"," ",592],"{",["T_WHITESPACE","\n            ",592],["T_VARIABLE","$attribute",593],["T_WHITESPACE"," ",593],"=",["T_WHITESPACE"," ",593],["T_STRING","Mage",593],["T_DOUBLE_COLON","::",593],["T_STRING","getSingleton",593],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/config'",593],")",["T_WHITESPACE","\n                ",593],["T_OBJECT_OPERATOR","->",594],["T_STRING","getAttribute",594],"(",["T_STRING","self",594],["T_DOUBLE_COLON","::",594],["T_STRING","ENTITY",594],",",["T_WHITESPACE"," ",594],["T_VARIABLE","$attributeCode",594],")",";",["T_WHITESPACE","\n        ",594],"}",["T_WHITESPACE","\n        ",595],["T_RETURN","return",596],["T_WHITESPACE"," ",596],["T_VARIABLE","$attribute",596],";",["T_WHITESPACE","\n    ",596],"}",["T_WHITESPACE","\n\n    ",597],["T_DOC_COMMENT","\/**\n     * Get all children categories IDs\n     *\n     * @param boolean $asArray return result as array instead of comma-separated list of IDs\n     * @return array|string\n     *\/",599],["T_WHITESPACE","\n    ",604],["T_PUBLIC","public",605],["T_WHITESPACE"," ",605],["T_FUNCTION","function",605],["T_WHITESPACE"," ",605],["T_STRING","getAllChildren",605],"(",["T_VARIABLE","$asArray",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_STRING","false",605],")",["T_WHITESPACE","\n    ",605],"{",["T_WHITESPACE","\n        ",606],["T_VARIABLE","$children",607],["T_WHITESPACE"," ",607],"=",["T_WHITESPACE"," ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","getResource",607],"(",")",["T_OBJECT_OPERATOR","->",607],["T_STRING","getAllChildren",607],"(",["T_VARIABLE","$this",607],")",";",["T_WHITESPACE","\n        ",607],["T_IF","if",608],["T_WHITESPACE"," ",608],"(",["T_VARIABLE","$asArray",608],")",["T_WHITESPACE"," ",608],"{",["T_WHITESPACE","\n            ",608],["T_RETURN","return",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$children",609],";",["T_WHITESPACE","\n        ",609],"}",["T_WHITESPACE","\n        ",610],["T_ELSE","else",611],["T_WHITESPACE"," ",611],"{",["T_WHITESPACE","\n            ",611],["T_RETURN","return",612],["T_WHITESPACE"," ",612],["T_STRING","implode",612],"(",["T_CONSTANT_ENCAPSED_STRING","','",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$children",612],")",";",["T_WHITESPACE","\n        ",612],"}",["T_WHITESPACE","\n\n",613],["T_COMMENT","\/\/        $this->getTreeModelInstance()->load();\n",615],["T_COMMENT","\/\/        $children = $this->getTreeModelInstance()->getChildren($this->getId());\n",616],["T_COMMENT","\/\/\n",617],["T_COMMENT","\/\/        $myId = array($this->getId());\n",618],["T_COMMENT","\/\/        if (is_array($children)) {\n",619],["T_COMMENT","\/\/            $children = array_merge($myId, $children);\n",620],["T_COMMENT","\/\/        }\n",621],["T_COMMENT","\/\/        else {\n",622],["T_COMMENT","\/\/            $children = $myId;\n",623],["T_COMMENT","\/\/        }\n",624],["T_COMMENT","\/\/        if ($asArray) {\n",625],["T_COMMENT","\/\/            return $children;\n",626],["T_COMMENT","\/\/        }\n",627],["T_COMMENT","\/\/        else {\n",628],["T_COMMENT","\/\/            return implode(',', $children);\n",629],["T_COMMENT","\/\/        }\n",630],["T_WHITESPACE","    ",631],"}",["T_WHITESPACE","\n\n    ",631],["T_DOC_COMMENT","\/**\n     * Retrieve children ids comma separated\n     *\n     * @return string\n     *\/",633],["T_WHITESPACE","\n    ",637],["T_PUBLIC","public",638],["T_WHITESPACE"," ",638],["T_FUNCTION","function",638],["T_WHITESPACE"," ",638],["T_STRING","getChildren",638],"(",")",["T_WHITESPACE","\n    ",638],"{",["T_WHITESPACE","\n        ",639],["T_RETURN","return",640],["T_WHITESPACE"," ",640],["T_STRING","implode",640],"(",["T_CONSTANT_ENCAPSED_STRING","','",640],",",["T_WHITESPACE"," ",640],["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","getResource",640],"(",")",["T_OBJECT_OPERATOR","->",640],["T_STRING","getChildren",640],"(",["T_VARIABLE","$this",640],",",["T_WHITESPACE"," ",640],["T_STRING","false",640],")",")",";",["T_WHITESPACE","\n    ",640],"}",["T_WHITESPACE","\n\n    ",641],["T_DOC_COMMENT","\/**\n     * Retrieve Stores where isset category Path\n     * Return comma separated string\n     *\n     * @return string\n     *\/",643],["T_WHITESPACE","\n    ",648],["T_PUBLIC","public",649],["T_WHITESPACE"," ",649],["T_FUNCTION","function",649],["T_WHITESPACE"," ",649],["T_STRING","getPathInStore",649],"(",")",["T_WHITESPACE","\n    ",649],"{",["T_WHITESPACE","\n        ",650],["T_VARIABLE","$result",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_ARRAY","array",651],"(",")",";",["T_WHITESPACE","\n        ",651],["T_COMMENT","\/\/$path = $this->getTreeModelInstance()->getPath($this->getId());\n",652],["T_WHITESPACE","        ",653],["T_VARIABLE","$path",653],["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_STRING","array_reverse",653],"(",["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","getPathIds",653],"(",")",")",";",["T_WHITESPACE","\n        ",653],["T_FOREACH","foreach",654],["T_WHITESPACE"," ",654],"(",["T_VARIABLE","$path",654],["T_WHITESPACE"," ",654],["T_AS","as",654],["T_WHITESPACE"," ",654],["T_VARIABLE","$itemId",654],")",["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n            ",654],["T_IF","if",655],["T_WHITESPACE"," ",655],"(",["T_VARIABLE","$itemId",655],["T_WHITESPACE"," ",655],["T_IS_EQUAL","==",655],["T_WHITESPACE"," ",655],["T_STRING","Mage",655],["T_DOUBLE_COLON","::",655],["T_STRING","app",655],"(",")",["T_OBJECT_OPERATOR","->",655],["T_STRING","getStore",655],"(",")",["T_OBJECT_OPERATOR","->",655],["T_STRING","getRootCategoryId",655],"(",")",")",["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n                ",655],["T_BREAK","break",656],";",["T_WHITESPACE","\n            ",656],"}",["T_WHITESPACE","\n            ",657],["T_VARIABLE","$result",658],"[","]",["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_VARIABLE","$itemId",658],";",["T_WHITESPACE","\n        ",658],"}",["T_WHITESPACE","\n        ",659],["T_RETURN","return",660],["T_WHITESPACE"," ",660],["T_STRING","implode",660],"(",["T_CONSTANT_ENCAPSED_STRING","','",660],",",["T_WHITESPACE"," ",660],["T_VARIABLE","$result",660],")",";",["T_WHITESPACE","\n    ",660],"}",["T_WHITESPACE","\n\n    ",661],["T_DOC_COMMENT","\/**\n     * Check category id exising\n     *\n     * @param   int $id\n     * @return  bool\n     *\/",663],["T_WHITESPACE","\n    ",668],["T_PUBLIC","public",669],["T_WHITESPACE"," ",669],["T_FUNCTION","function",669],["T_WHITESPACE"," ",669],["T_STRING","checkId",669],"(",["T_VARIABLE","$id",669],")",["T_WHITESPACE","\n    ",669],"{",["T_WHITESPACE","\n        ",670],["T_RETURN","return",671],["T_WHITESPACE"," ",671],["T_VARIABLE","$this",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","_getResource",671],"(",")",["T_OBJECT_OPERATOR","->",671],["T_STRING","checkId",671],"(",["T_VARIABLE","$id",671],")",";",["T_WHITESPACE","\n    ",671],"}",["T_WHITESPACE","\n\n    ",672],["T_DOC_COMMENT","\/**\n     * Get array categories ids which are part of category path\n     * Result array contain id of current category because it is part of the path\n     *\n     * @return array\n     *\/",674],["T_WHITESPACE","\n    ",679],["T_PUBLIC","public",680],["T_WHITESPACE"," ",680],["T_FUNCTION","function",680],["T_WHITESPACE"," ",680],["T_STRING","getPathIds",680],"(",")",["T_WHITESPACE","\n    ",680],"{",["T_WHITESPACE","\n        ",681],["T_VARIABLE","$ids",682],["T_WHITESPACE"," ",682],"=",["T_WHITESPACE"," ",682],["T_VARIABLE","$this",682],["T_OBJECT_OPERATOR","->",682],["T_STRING","getData",682],"(",["T_CONSTANT_ENCAPSED_STRING","'path_ids'",682],")",";",["T_WHITESPACE","\n        ",682],["T_IF","if",683],["T_WHITESPACE"," ",683],"(",["T_STRING","is_null",683],"(",["T_VARIABLE","$ids",683],")",")",["T_WHITESPACE"," ",683],"{",["T_WHITESPACE","\n            ",683],["T_VARIABLE","$ids",684],["T_WHITESPACE"," ",684],"=",["T_WHITESPACE"," ",684],["T_STRING","explode",684],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",684],",",["T_WHITESPACE"," ",684],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","getPath",684],"(",")",")",";",["T_WHITESPACE","\n            ",684],["T_VARIABLE","$this",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","setData",685],"(",["T_CONSTANT_ENCAPSED_STRING","'path_ids'",685],",",["T_WHITESPACE"," ",685],["T_VARIABLE","$ids",685],")",";",["T_WHITESPACE","\n        ",685],"}",["T_WHITESPACE","\n        ",686],["T_RETURN","return",687],["T_WHITESPACE"," ",687],["T_VARIABLE","$ids",687],";",["T_WHITESPACE","\n    ",687],"}",["T_WHITESPACE","\n\n    ",688],["T_DOC_COMMENT","\/**\n     * Retrieve level\n     *\n     * @return int\n     *\/",690],["T_WHITESPACE","\n    ",694],["T_PUBLIC","public",695],["T_WHITESPACE"," ",695],["T_FUNCTION","function",695],["T_WHITESPACE"," ",695],["T_STRING","getLevel",695],"(",")",["T_WHITESPACE","\n    ",695],"{",["T_WHITESPACE","\n        ",696],["T_IF","if",697],["T_WHITESPACE"," ",697],"(","!",["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","hasLevel",697],"(",")",")",["T_WHITESPACE"," ",697],"{",["T_WHITESPACE","\n            ",697],["T_RETURN","return",698],["T_WHITESPACE"," ",698],["T_STRING","count",698],"(",["T_STRING","explode",698],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",698],",",["T_WHITESPACE"," ",698],["T_VARIABLE","$this",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","getPath",698],"(",")",")",")",["T_WHITESPACE"," ",698],"-",["T_WHITESPACE"," ",698],["T_LNUMBER","1",698],";",["T_WHITESPACE","\n        ",698],"}",["T_WHITESPACE","\n        ",699],["T_RETURN","return",700],["T_WHITESPACE"," ",700],["T_VARIABLE","$this",700],["T_OBJECT_OPERATOR","->",700],["T_STRING","getData",700],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",700],")",";",["T_WHITESPACE","\n    ",700],"}",["T_WHITESPACE","\n\n    ",701],["T_DOC_COMMENT","\/**\n     * Verify category ids\n     *\n     * @param array $ids\n     * @return bool\n     *\/",703],["T_WHITESPACE","\n    ",708],["T_PUBLIC","public",709],["T_WHITESPACE"," ",709],["T_FUNCTION","function",709],["T_WHITESPACE"," ",709],["T_STRING","verifyIds",709],"(",["T_ARRAY","array",709],["T_WHITESPACE"," ",709],["T_VARIABLE","$ids",709],")",["T_WHITESPACE","\n    ",709],"{",["T_WHITESPACE","\n        ",710],["T_RETURN","return",711],["T_WHITESPACE"," ",711],["T_VARIABLE","$this",711],["T_OBJECT_OPERATOR","->",711],["T_STRING","getResource",711],"(",")",["T_OBJECT_OPERATOR","->",711],["T_STRING","verifyIds",711],"(",["T_VARIABLE","$ids",711],")",";",["T_WHITESPACE","\n    ",711],"}",["T_WHITESPACE","\n\n    ",712],["T_DOC_COMMENT","\/**\n     * Retrieve Is Category has children flag\n     *\n     * @return bool\n     *\/",714],["T_WHITESPACE","\n    ",718],["T_PUBLIC","public",719],["T_WHITESPACE"," ",719],["T_FUNCTION","function",719],["T_WHITESPACE"," ",719],["T_STRING","hasChildren",719],"(",")",["T_WHITESPACE","\n    ",719],"{",["T_WHITESPACE","\n        ",720],["T_RETURN","return",721],["T_WHITESPACE"," ",721],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","_getResource",721],"(",")",["T_OBJECT_OPERATOR","->",721],["T_STRING","getChildrenAmount",721],"(",["T_VARIABLE","$this",721],")",["T_WHITESPACE"," ",721],">",["T_WHITESPACE"," ",721],["T_LNUMBER","0",721],";",["T_WHITESPACE","\n    ",721],"}",["T_WHITESPACE","\n\n    ",722],["T_DOC_COMMENT","\/**\n     * Retrieve Request Path\n     *\n     * @return string\n     *\/",724],["T_WHITESPACE","\n    ",728],["T_PUBLIC","public",729],["T_WHITESPACE"," ",729],["T_FUNCTION","function",729],["T_WHITESPACE"," ",729],["T_STRING","getRequestPath",729],"(",")",["T_WHITESPACE","\n    ",729],"{",["T_WHITESPACE","\n        ",730],["T_IF","if",731],["T_WHITESPACE"," ",731],"(","!",["T_VARIABLE","$this",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","_getData",731],"(",["T_CONSTANT_ENCAPSED_STRING","'request_path'",731],")",")",["T_WHITESPACE"," ",731],"{",["T_WHITESPACE","\n            ",731],["T_VARIABLE","$this",732],["T_OBJECT_OPERATOR","->",732],["T_STRING","getUrl",732],"(",")",";",["T_WHITESPACE","\n        ",732],"}",["T_WHITESPACE","\n        ",733],["T_RETURN","return",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$this",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","_getData",734],"(",["T_CONSTANT_ENCAPSED_STRING","'request_path'",734],")",";",["T_WHITESPACE","\n    ",734],"}",["T_WHITESPACE","\n\n    ",735],["T_DOC_COMMENT","\/**\n     * Retrieve Name data wrapper\n     *\n     * @return string\n     *\/",737],["T_WHITESPACE","\n    ",741],["T_PUBLIC","public",742],["T_WHITESPACE"," ",742],["T_FUNCTION","function",742],["T_WHITESPACE"," ",742],["T_STRING","getName",742],"(",")",["T_WHITESPACE","\n    ",742],"{",["T_WHITESPACE","\n        ",743],["T_RETURN","return",744],["T_WHITESPACE"," ",744],["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","_getData",744],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",744],")",";",["T_WHITESPACE","\n    ",744],"}",["T_WHITESPACE","\n\n    ",745],["T_DOC_COMMENT","\/**\n     * Before delete process\n     *\n     * @return Mage_Catalog_Model_Category\n     *\/",747],["T_WHITESPACE","\n    ",751],["T_PROTECTED","protected",752],["T_WHITESPACE"," ",752],["T_FUNCTION","function",752],["T_WHITESPACE"," ",752],["T_STRING","_beforeDelete",752],"(",")",["T_WHITESPACE","\n    ",752],"{",["T_WHITESPACE","\n        ",753],["T_VARIABLE","$this",754],["T_OBJECT_OPERATOR","->",754],["T_STRING","_protectFromNonAdmin",754],"(",")",";",["T_WHITESPACE","\n        ",754],["T_IF","if",755],["T_WHITESPACE"," ",755],"(",["T_VARIABLE","$this",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","getResource",755],"(",")",["T_OBJECT_OPERATOR","->",755],["T_STRING","isForbiddenToDelete",755],"(",["T_VARIABLE","$this",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","getId",755],"(",")",")",")",["T_WHITESPACE"," ",755],"{",["T_WHITESPACE","\n            ",755],["T_STRING","Mage",756],["T_DOUBLE_COLON","::",756],["T_STRING","throwException",756],"(",["T_CONSTANT_ENCAPSED_STRING","\"Can't delete root category.\"",756],")",";",["T_WHITESPACE","\n        ",756],"}",["T_WHITESPACE","\n        ",757],["T_RETURN","return",758],["T_WHITESPACE"," ",758],["T_STRING","parent",758],["T_DOUBLE_COLON","::",758],["T_STRING","_beforeDelete",758],"(",")",";",["T_WHITESPACE","\n    ",758],"}",["T_WHITESPACE","\n\n    ",759],["T_DOC_COMMENT","\/**\n     * Retrieve anchors above\n     *\n     * @return array\n     *\/",761],["T_WHITESPACE","\n    ",765],["T_PUBLIC","public",766],["T_WHITESPACE"," ",766],["T_FUNCTION","function",766],["T_WHITESPACE"," ",766],["T_STRING","getAnchorsAbove",766],"(",")",["T_WHITESPACE","\n    ",766],"{",["T_WHITESPACE","\n        ",767],["T_VARIABLE","$anchors",768],["T_WHITESPACE"," ",768],"=",["T_WHITESPACE"," ",768],["T_ARRAY","array",768],"(",")",";",["T_WHITESPACE","\n        ",768],["T_VARIABLE","$path",769],["T_WHITESPACE"," ",769],"=",["T_WHITESPACE"," ",769],["T_VARIABLE","$this",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","getPathIds",769],"(",")",";",["T_WHITESPACE","\n\n        ",769],["T_IF","if",771],["T_WHITESPACE"," ",771],"(",["T_STRING","in_array",771],"(",["T_VARIABLE","$this",771],["T_OBJECT_OPERATOR","->",771],["T_STRING","getId",771],"(",")",",",["T_WHITESPACE"," ",771],["T_VARIABLE","$path",771],")",")",["T_WHITESPACE"," ",771],"{",["T_WHITESPACE","\n            ",771],["T_UNSET","unset",772],"(",["T_VARIABLE","$path",772],"[",["T_STRING","array_search",772],"(",["T_VARIABLE","$this",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","getId",772],"(",")",",",["T_WHITESPACE"," ",772],["T_VARIABLE","$path",772],")","]",")",";",["T_WHITESPACE","\n        ",772],"}",["T_WHITESPACE","\n\n        ",773],["T_IF","if",775],["T_WHITESPACE"," ",775],"(",["T_VARIABLE","$this",775],["T_OBJECT_OPERATOR","->",775],["T_STRING","_useFlatResource",775],")",["T_WHITESPACE"," ",775],"{",["T_WHITESPACE","\n            ",775],["T_VARIABLE","$anchors",776],["T_WHITESPACE"," ",776],"=",["T_WHITESPACE"," ",776],["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","_getResource",776],"(",")",["T_OBJECT_OPERATOR","->",776],["T_STRING","getAnchorsAbove",776],"(",["T_VARIABLE","$path",776],",",["T_WHITESPACE"," ",776],["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","getStoreId",776],"(",")",")",";",["T_WHITESPACE","\n        ",776],"}",["T_WHITESPACE","\n        ",777],["T_ELSE","else",778],["T_WHITESPACE"," ",778],"{",["T_WHITESPACE","\n            ",778],["T_IF","if",779],["T_WHITESPACE"," ",779],"(","!",["T_STRING","Mage",779],["T_DOUBLE_COLON","::",779],["T_STRING","registry",779],"(",["T_CONSTANT_ENCAPSED_STRING","'_category_is_anchor_attribute'",779],")",")",["T_WHITESPACE"," ",779],"{",["T_WHITESPACE","\n                ",779],["T_VARIABLE","$model",780],["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_VARIABLE","$this",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","_getAttribute",780],"(",["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",780],")",";",["T_WHITESPACE","\n                ",780],["T_STRING","Mage",781],["T_DOUBLE_COLON","::",781],["T_STRING","register",781],"(",["T_CONSTANT_ENCAPSED_STRING","'_category_is_anchor_attribute'",781],",",["T_WHITESPACE"," ",781],["T_VARIABLE","$model",781],")",";",["T_WHITESPACE","\n            ",781],"}",["T_WHITESPACE","\n\n            ",782],["T_IF","if",784],["T_WHITESPACE"," ",784],"(",["T_VARIABLE","$isAnchorAttribute",784],["T_WHITESPACE"," ",784],"=",["T_WHITESPACE"," ",784],["T_STRING","Mage",784],["T_DOUBLE_COLON","::",784],["T_STRING","registry",784],"(",["T_CONSTANT_ENCAPSED_STRING","'_category_is_anchor_attribute'",784],")",")",["T_WHITESPACE"," ",784],"{",["T_WHITESPACE","\n                ",784],["T_VARIABLE","$anchors",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_VARIABLE","$this",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","getResource",785],"(",")",["T_OBJECT_OPERATOR","->",785],["T_STRING","findWhereAttributeIs",785],"(",["T_VARIABLE","$path",785],",",["T_WHITESPACE"," ",785],["T_VARIABLE","$isAnchorAttribute",785],",",["T_WHITESPACE"," ",785],["T_LNUMBER","1",785],")",";",["T_WHITESPACE","\n            ",785],"}",["T_WHITESPACE","\n        ",786],"}",["T_WHITESPACE","\n        ",787],["T_RETURN","return",788],["T_WHITESPACE"," ",788],["T_VARIABLE","$anchors",788],";",["T_WHITESPACE","\n    ",788],"}",["T_WHITESPACE","\n\n    ",789],["T_DOC_COMMENT","\/**\n     * Retrieve count products of category\n     *\n     * @return int\n     *\/",791],["T_WHITESPACE","\n    ",795],["T_PUBLIC","public",796],["T_WHITESPACE"," ",796],["T_FUNCTION","function",796],["T_WHITESPACE"," ",796],["T_STRING","getProductCount",796],"(",")",["T_WHITESPACE","\n    ",796],"{",["T_WHITESPACE","\n        ",797],["T_IF","if",798],["T_WHITESPACE"," ",798],"(","!",["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","hasProductCount",798],"(",")",")",["T_WHITESPACE"," ",798],"{",["T_WHITESPACE","\n            ",798],["T_VARIABLE","$count",799],["T_WHITESPACE"," ",799],"=",["T_WHITESPACE"," ",799],["T_VARIABLE","$this",799],["T_OBJECT_OPERATOR","->",799],["T_STRING","_getResource",799],"(",")",["T_OBJECT_OPERATOR","->",799],["T_STRING","getProductCount",799],"(",["T_VARIABLE","$this",799],")",";",["T_WHITESPACE"," ",799],["T_COMMENT","\/\/ load product count\n",799],["T_WHITESPACE","            ",800],["T_VARIABLE","$this",800],["T_OBJECT_OPERATOR","->",800],["T_STRING","setData",800],"(",["T_CONSTANT_ENCAPSED_STRING","'product_count'",800],",",["T_WHITESPACE"," ",800],["T_VARIABLE","$count",800],")",";",["T_WHITESPACE","\n        ",800],"}",["T_WHITESPACE","\n        ",801],["T_RETURN","return",802],["T_WHITESPACE"," ",802],["T_VARIABLE","$this",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","getData",802],"(",["T_CONSTANT_ENCAPSED_STRING","'product_count'",802],")",";",["T_WHITESPACE","\n    ",802],"}",["T_WHITESPACE","\n\n    ",803],["T_DOC_COMMENT","\/**\n     * Retrieve categories by parent\n     *\n     * @param int $parent\n     * @param int $recursionLevel\n     * @param bool $sorted\n     * @param bool $asCollection\n     * @param bool $toLoad\n     * @return mixed\n     *\/",805],["T_WHITESPACE","\n    ",814],["T_PUBLIC","public",815],["T_WHITESPACE"," ",815],["T_FUNCTION","function",815],["T_WHITESPACE"," ",815],["T_STRING","getCategories",815],"(",["T_VARIABLE","$parent",815],",",["T_WHITESPACE"," ",815],["T_VARIABLE","$recursionLevel",815],["T_WHITESPACE"," ",815],"=",["T_WHITESPACE"," ",815],["T_LNUMBER","0",815],",",["T_WHITESPACE"," ",815],["T_VARIABLE","$sorted",815],"=",["T_STRING","false",815],",",["T_WHITESPACE"," ",815],["T_VARIABLE","$asCollection",815],"=",["T_STRING","false",815],",",["T_WHITESPACE"," ",815],["T_VARIABLE","$toLoad",815],"=",["T_STRING","true",815],")",["T_WHITESPACE","\n    ",815],"{",["T_WHITESPACE","\n        ",816],["T_VARIABLE","$categories",817],["T_WHITESPACE"," ",817],"=",["T_WHITESPACE"," ",817],["T_VARIABLE","$this",817],["T_OBJECT_OPERATOR","->",817],["T_STRING","getResource",817],"(",")",["T_WHITESPACE","\n            ",817],["T_OBJECT_OPERATOR","->",818],["T_STRING","getCategories",818],"(",["T_VARIABLE","$parent",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$recursionLevel",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$sorted",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$asCollection",818],",",["T_WHITESPACE"," ",818],["T_VARIABLE","$toLoad",818],")",";",["T_WHITESPACE","\n        ",818],["T_RETURN","return",819],["T_WHITESPACE"," ",819],["T_VARIABLE","$categories",819],";",["T_WHITESPACE","\n    ",819],"}",["T_WHITESPACE","\n\n    ",820],["T_DOC_COMMENT","\/**\n     * Return parent categories of current category\n     *\n     * @return array\n     *\/",822],["T_WHITESPACE","\n    ",826],["T_PUBLIC","public",827],["T_WHITESPACE"," ",827],["T_FUNCTION","function",827],["T_WHITESPACE"," ",827],["T_STRING","getParentCategories",827],"(",")",["T_WHITESPACE","\n    ",827],"{",["T_WHITESPACE","\n        ",828],["T_RETURN","return",829],["T_WHITESPACE"," ",829],["T_VARIABLE","$this",829],["T_OBJECT_OPERATOR","->",829],["T_STRING","getResource",829],"(",")",["T_OBJECT_OPERATOR","->",829],["T_STRING","getParentCategories",829],"(",["T_VARIABLE","$this",829],")",";",["T_WHITESPACE","\n    ",829],"}",["T_WHITESPACE","\n\n    ",830],["T_DOC_COMMENT","\/**\n     * Retuen children categories of current category\n     *\n     * @return array\n     *\/",832],["T_WHITESPACE","\n    ",836],["T_PUBLIC","public",837],["T_WHITESPACE"," ",837],["T_FUNCTION","function",837],["T_WHITESPACE"," ",837],["T_STRING","getChildrenCategories",837],"(",")",["T_WHITESPACE","\n    ",837],"{",["T_WHITESPACE","\n        ",838],["T_RETURN","return",839],["T_WHITESPACE"," ",839],["T_VARIABLE","$this",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","getResource",839],"(",")",["T_OBJECT_OPERATOR","->",839],["T_STRING","getChildrenCategories",839],"(",["T_VARIABLE","$this",839],")",";",["T_WHITESPACE","\n    ",839],"}",["T_WHITESPACE","\n\n    ",840],["T_DOC_COMMENT","\/**\n     * Return children categories of current category\n     *\n     * @return array\n     *\/",842],["T_WHITESPACE","\n    ",846],["T_PUBLIC","public",847],["T_WHITESPACE"," ",847],["T_FUNCTION","function",847],["T_WHITESPACE"," ",847],["T_STRING","getChildrenCategoriesWithInactive",847],"(",")",["T_WHITESPACE","\n    ",847],"{",["T_WHITESPACE","\n        ",848],["T_RETURN","return",849],["T_WHITESPACE"," ",849],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","getResource",849],"(",")",["T_OBJECT_OPERATOR","->",849],["T_STRING","getChildrenCategoriesWithInactive",849],"(",["T_VARIABLE","$this",849],")",";",["T_WHITESPACE","\n    ",849],"}",["T_WHITESPACE","\n\n    ",850],["T_DOC_COMMENT","\/**\n     * Return parent category of current category with own custom design settings\n     *\n     * @return Mage_Catalog_Model_Category\n     *\/",852],["T_WHITESPACE","\n    ",856],["T_PUBLIC","public",857],["T_WHITESPACE"," ",857],["T_FUNCTION","function",857],["T_WHITESPACE"," ",857],["T_STRING","getParentDesignCategory",857],"(",")",["T_WHITESPACE","\n    ",857],"{",["T_WHITESPACE","\n        ",858],["T_RETURN","return",859],["T_WHITESPACE"," ",859],["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","getResource",859],"(",")",["T_OBJECT_OPERATOR","->",859],["T_STRING","getParentDesignCategory",859],"(",["T_VARIABLE","$this",859],")",";",["T_WHITESPACE","\n    ",859],"}",["T_WHITESPACE","\n\n    ",860],["T_DOC_COMMENT","\/**\n     * Check category is in Root Category list\n     *\n     * @return bool\n     *\/",862],["T_WHITESPACE","\n    ",866],["T_PUBLIC","public",867],["T_WHITESPACE"," ",867],["T_FUNCTION","function",867],["T_WHITESPACE"," ",867],["T_STRING","isInRootCategoryList",867],"(",")",["T_WHITESPACE","\n    ",867],"{",["T_WHITESPACE","\n        ",868],["T_RETURN","return",869],["T_WHITESPACE"," ",869],["T_VARIABLE","$this",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","getResource",869],"(",")",["T_OBJECT_OPERATOR","->",869],["T_STRING","isInRootCategoryList",869],"(",["T_VARIABLE","$this",869],")",";",["T_WHITESPACE","\n    ",869],"}",["T_WHITESPACE","\n\n    ",870],["T_DOC_COMMENT","\/**\n     * Retrieve Available int Product Listing sort by\n     *\n     * @return null|array\n     *\/",872],["T_WHITESPACE","\n    ",876],["T_PUBLIC","public",877],["T_WHITESPACE"," ",877],["T_FUNCTION","function",877],["T_WHITESPACE"," ",877],["T_STRING","getAvailableSortBy",877],"(",")",["T_WHITESPACE","\n    ",877],"{",["T_WHITESPACE","\n        ",878],["T_VARIABLE","$available",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","getData",879],"(",["T_CONSTANT_ENCAPSED_STRING","'available_sort_by'",879],")",";",["T_WHITESPACE","\n        ",879],["T_IF","if",880],["T_WHITESPACE"," ",880],"(",["T_EMPTY","empty",880],"(",["T_VARIABLE","$available",880],")",")",["T_WHITESPACE"," ",880],"{",["T_WHITESPACE","\n            ",880],["T_RETURN","return",881],["T_WHITESPACE"," ",881],["T_ARRAY","array",881],"(",")",";",["T_WHITESPACE","\n        ",881],"}",["T_WHITESPACE","\n        ",882],["T_IF","if",883],["T_WHITESPACE"," ",883],"(",["T_VARIABLE","$available",883],["T_WHITESPACE"," ",883],["T_BOOLEAN_AND","&&",883],["T_WHITESPACE"," ",883],"!",["T_STRING","is_array",883],"(",["T_VARIABLE","$available",883],")",")",["T_WHITESPACE"," ",883],"{",["T_WHITESPACE","\n            ",883],["T_VARIABLE","$available",884],["T_WHITESPACE"," ",884],"=",["T_WHITESPACE"," ",884],["T_STRING","explode",884],"(",["T_CONSTANT_ENCAPSED_STRING","','",884],",",["T_WHITESPACE"," ",884],["T_VARIABLE","$available",884],")",";",["T_WHITESPACE","\n        ",884],"}",["T_WHITESPACE","\n        ",885],["T_RETURN","return",886],["T_WHITESPACE"," ",886],["T_VARIABLE","$available",886],";",["T_WHITESPACE","\n    ",886],"}",["T_WHITESPACE","\n\n    ",887],["T_DOC_COMMENT","\/**\n     * Retrieve Available Product Listing  Sort By\n     * code as key, value - name\n     *\n     * @return array\n     *\/",889],["T_WHITESPACE","\n    ",894],["T_PUBLIC","public",895],["T_WHITESPACE"," ",895],["T_FUNCTION","function",895],["T_WHITESPACE"," ",895],["T_STRING","getAvailableSortByOptions",895],"(",")",["T_WHITESPACE"," ",895],"{",["T_WHITESPACE","\n        ",895],["T_VARIABLE","$availableSortBy",896],["T_WHITESPACE"," ",896],"=",["T_WHITESPACE"," ",896],["T_ARRAY","array",896],"(",")",";",["T_WHITESPACE","\n        ",896],["T_VARIABLE","$defaultSortBy",897],["T_WHITESPACE","   ",897],"=",["T_WHITESPACE"," ",897],["T_STRING","Mage",897],["T_DOUBLE_COLON","::",897],["T_STRING","getSingleton",897],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/config'",897],")",["T_WHITESPACE","\n            ",897],["T_OBJECT_OPERATOR","->",898],["T_STRING","getAttributeUsedForSortByArray",898],"(",")",";",["T_WHITESPACE","\n        ",898],["T_IF","if",899],["T_WHITESPACE"," ",899],"(",["T_VARIABLE","$this",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","getAvailableSortBy",899],"(",")",")",["T_WHITESPACE"," ",899],"{",["T_WHITESPACE","\n            ",899],["T_FOREACH","foreach",900],["T_WHITESPACE"," ",900],"(",["T_VARIABLE","$this",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","getAvailableSortBy",900],"(",")",["T_WHITESPACE"," ",900],["T_AS","as",900],["T_WHITESPACE"," ",900],["T_VARIABLE","$sortBy",900],")",["T_WHITESPACE"," ",900],"{",["T_WHITESPACE","\n                ",900],["T_IF","if",901],["T_WHITESPACE"," ",901],"(",["T_ISSET","isset",901],"(",["T_VARIABLE","$defaultSortBy",901],"[",["T_VARIABLE","$sortBy",901],"]",")",")",["T_WHITESPACE"," ",901],"{",["T_WHITESPACE","\n                    ",901],["T_VARIABLE","$availableSortBy",902],"[",["T_VARIABLE","$sortBy",902],"]",["T_WHITESPACE"," ",902],"=",["T_WHITESPACE"," ",902],["T_VARIABLE","$defaultSortBy",902],"[",["T_VARIABLE","$sortBy",902],"]",";",["T_WHITESPACE","\n                ",902],"}",["T_WHITESPACE","\n            ",903],"}",["T_WHITESPACE","\n        ",904],"}",["T_WHITESPACE","\n\n        ",905],["T_IF","if",907],["T_WHITESPACE"," ",907],"(","!",["T_VARIABLE","$availableSortBy",907],")",["T_WHITESPACE"," ",907],"{",["T_WHITESPACE","\n            ",907],["T_VARIABLE","$availableSortBy",908],["T_WHITESPACE"," ",908],"=",["T_WHITESPACE"," ",908],["T_VARIABLE","$defaultSortBy",908],";",["T_WHITESPACE","\n        ",908],"}",["T_WHITESPACE","\n\n        ",909],["T_RETURN","return",911],["T_WHITESPACE"," ",911],["T_VARIABLE","$availableSortBy",911],";",["T_WHITESPACE","\n    ",911],"}",["T_WHITESPACE","\n\n    ",912],["T_DOC_COMMENT","\/**\n     * Retrieve Product Listing Default Sort By\n     *\n     * @return string\n     *\/",914],["T_WHITESPACE","\n    ",918],["T_PUBLIC","public",919],["T_WHITESPACE"," ",919],["T_FUNCTION","function",919],["T_WHITESPACE"," ",919],["T_STRING","getDefaultSortBy",919],"(",")",["T_WHITESPACE"," ",919],"{",["T_WHITESPACE","\n        ",919],["T_IF","if",920],["T_WHITESPACE"," ",920],"(","!",["T_VARIABLE","$sortBy",920],["T_WHITESPACE"," ",920],"=",["T_WHITESPACE"," ",920],["T_VARIABLE","$this",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","getData",920],"(",["T_CONSTANT_ENCAPSED_STRING","'default_sort_by'",920],")",")",["T_WHITESPACE"," ",920],"{",["T_WHITESPACE","\n            ",920],["T_VARIABLE","$sortBy",921],["T_WHITESPACE"," ",921],"=",["T_WHITESPACE"," ",921],["T_STRING","Mage",921],["T_DOUBLE_COLON","::",921],["T_STRING","getSingleton",921],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/config'",921],")",["T_WHITESPACE","\n                ",921],["T_OBJECT_OPERATOR","->",922],["T_STRING","getProductListDefaultSortBy",922],"(",["T_VARIABLE","$this",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","getStoreId",922],"(",")",")",";",["T_WHITESPACE","\n        ",922],"}",["T_WHITESPACE","\n        ",923],["T_VARIABLE","$available",924],["T_WHITESPACE"," ",924],"=",["T_WHITESPACE"," ",924],["T_VARIABLE","$this",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","getAvailableSortByOptions",924],"(",")",";",["T_WHITESPACE","\n        ",924],["T_IF","if",925],["T_WHITESPACE"," ",925],"(","!",["T_ISSET","isset",925],"(",["T_VARIABLE","$available",925],"[",["T_VARIABLE","$sortBy",925],"]",")",")",["T_WHITESPACE"," ",925],"{",["T_WHITESPACE","\n            ",925],["T_VARIABLE","$sortBy",926],["T_WHITESPACE"," ",926],"=",["T_WHITESPACE"," ",926],["T_STRING","array_keys",926],"(",["T_VARIABLE","$available",926],")",";",["T_WHITESPACE","\n            ",926],["T_VARIABLE","$sortBy",927],["T_WHITESPACE"," ",927],"=",["T_WHITESPACE"," ",927],["T_VARIABLE","$sortBy",927],"[",["T_LNUMBER","0",927],"]",";",["T_WHITESPACE","\n        ",927],"}",["T_WHITESPACE","\n\n        ",928],["T_RETURN","return",930],["T_WHITESPACE"," ",930],["T_VARIABLE","$sortBy",930],";",["T_WHITESPACE","\n    ",930],"}",["T_WHITESPACE","\n\n    ",931],["T_DOC_COMMENT","\/**\n     * Validate attribute values\n     *\n     * @throws Mage_Eav_Model_Entity_Attribute_Exception\n     * @return bool|array\n     *\/",933],["T_WHITESPACE","\n    ",938],["T_PUBLIC","public",939],["T_WHITESPACE"," ",939],["T_FUNCTION","function",939],["T_WHITESPACE"," ",939],["T_STRING","validate",939],"(",")",["T_WHITESPACE","\n    ",939],"{",["T_WHITESPACE","\n        ",940],["T_RETURN","return",941],["T_WHITESPACE"," ",941],["T_VARIABLE","$this",941],["T_OBJECT_OPERATOR","->",941],["T_STRING","_getResource",941],"(",")",["T_OBJECT_OPERATOR","->",941],["T_STRING","validate",941],"(",["T_VARIABLE","$this",941],")",";",["T_WHITESPACE","\n    ",941],"}",["T_WHITESPACE","\n\n    ",942],["T_DOC_COMMENT","\/**\n     * Callback function which called after transaction commit in resource model\n     *\n     * @return Mage_Catalog_Model_Category\n     *\/",944],["T_WHITESPACE","\n    ",948],["T_PUBLIC","public",949],["T_WHITESPACE"," ",949],["T_FUNCTION","function",949],["T_WHITESPACE"," ",949],["T_STRING","afterCommitCallback",949],"(",")",["T_WHITESPACE","\n    ",949],"{",["T_WHITESPACE","\n        ",950],["T_STRING","parent",951],["T_DOUBLE_COLON","::",951],["T_STRING","afterCommitCallback",951],"(",")",";",["T_WHITESPACE","\n\n        ",951],["T_DOC_COMMENT","\/** @var \\Mage_Index_Model_Indexer $indexer *\/",953],["T_WHITESPACE","\n        ",953],["T_VARIABLE","$indexer",954],["T_WHITESPACE"," ",954],"=",["T_WHITESPACE"," ",954],["T_STRING","Mage",954],["T_DOUBLE_COLON","::",954],["T_STRING","getSingleton",954],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/indexer'",954],")",";",["T_WHITESPACE","\n        ",954],["T_VARIABLE","$indexer",955],["T_OBJECT_OPERATOR","->",955],["T_STRING","processEntityAction",955],"(",["T_VARIABLE","$this",955],",",["T_WHITESPACE"," ",955],["T_STRING","self",955],["T_DOUBLE_COLON","::",955],["T_STRING","ENTITY",955],",",["T_WHITESPACE"," ",955],["T_STRING","Mage_Index_Model_Event",955],["T_DOUBLE_COLON","::",955],["T_STRING","TYPE_SAVE",955],")",";",["T_WHITESPACE","\n\n        ",955],["T_RETURN","return",957],["T_WHITESPACE"," ",957],["T_VARIABLE","$this",957],";",["T_WHITESPACE","\n    ",957],"}",["T_WHITESPACE","\n",958],"}",["T_WHITESPACE","\n",959]]