[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog Product Eav Decimal Attributes Indexer resource model\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Indexer_Eav_Decimal",35],["T_WHITESPACE","\n    ",35],["T_EXTENDS","extends",36],["T_WHITESPACE"," ",36],["T_STRING","Mage_Catalog_Model_Resource_Product_Indexer_Eav_Abstract",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_DOC_COMMENT","\/**\n     * Initialize connection and define main index table\n     *\n     *\/",38],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","_construct",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","_init",44],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_index_eav_decimal'",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Prepare data index for indexable attributes\n     *\n     * @param array $entityIds      the entity ids limitation\n     * @param int $attributeId      the attribute id limitation\n     * @return Mage_Catalog_Model_Resource_Product_Indexer_Eav_Decimal\n     *\/",47],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","_prepareIndex",54],"(",["T_VARIABLE","$entityIds",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$attributeId",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$write",56],["T_WHITESPACE","      ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_getWriteAdapter",56],"(",")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$idxTable",57],["T_WHITESPACE","   ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getIdxTable",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_COMMENT","\/\/ prepare select attributes\n",58],["T_WHITESPACE","        ",59],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_STRING","is_null",59],"(",["T_VARIABLE","$attributeId",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$attrIds",60],["T_WHITESPACE","    ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_getIndexableAttributes",60],"(",")",";",["T_WHITESPACE","\n        ",60],"}",["T_WHITESPACE"," ",61],["T_ELSE","else",61],["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$attrIds",62],["T_WHITESPACE","    ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_VARIABLE","$attributeId",62],")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n\n        ",63],["T_IF","if",65],["T_WHITESPACE"," ",65],"(","!",["T_VARIABLE","$attrIds",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_VARIABLE","$productValueExpression",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$write",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getCheckSql",69],"(",["T_CONSTANT_ENCAPSED_STRING","'pds.value_id > 0'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'pds.value'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'pdd.value'",69],")",";",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$select",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$write",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","select",70],"(",")",["T_WHITESPACE","\n            ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","from",71],"(",["T_WHITESPACE","\n                ",71],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'pdd'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getValueTable",72],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",72],",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'decimal'",72],")",")",",",["T_WHITESPACE","\n                ",72],["T_ARRAY","array",73],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",73],")",")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","join",74],"(",["T_WHITESPACE","\n                ",74],["T_ARRAY","array",75],"(",["T_CONSTANT_ENCAPSED_STRING","'cs'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getTable",75],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store'",75],")",")",",",["T_WHITESPACE","\n                ",75],["T_CONSTANT_ENCAPSED_STRING","''",76],",",["T_WHITESPACE","\n                ",76],["T_ARRAY","array",77],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",77],")",")",["T_WHITESPACE","\n            ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","joinLeft",78],"(",["T_WHITESPACE","\n                ",78],["T_ARRAY","array",79],"(",["T_CONSTANT_ENCAPSED_STRING","'pds'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getValueTable",79],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'decimal'",79],")",")",",",["T_WHITESPACE","\n                ",79],["T_CONSTANT_ENCAPSED_STRING","'pds.entity_id = pdd.entity_id AND pds.attribute_id = pdd.attribute_id'",80],["T_WHITESPACE","\n                    ",80],".",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","' AND pds.store_id=cs.store_id'",81],",",["T_WHITESPACE","\n                ",81],["T_ARRAY","array",82],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$productValueExpression",82],")",")",["T_WHITESPACE","\n            ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","where",83],"(",["T_CONSTANT_ENCAPSED_STRING","'pdd.store_id=?'",83],",",["T_WHITESPACE"," ",83],["T_STRING","Mage_Catalog_Model_Abstract",83],["T_DOUBLE_COLON","::",83],["T_STRING","DEFAULT_STORE_ID",83],")",["T_WHITESPACE","\n            ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","where",84],"(",["T_CONSTANT_ENCAPSED_STRING","'cs.store_id!=?'",84],",",["T_WHITESPACE"," ",84],["T_STRING","Mage_Catalog_Model_Abstract",84],["T_DOUBLE_COLON","::",84],["T_STRING","DEFAULT_STORE_ID",84],")",["T_WHITESPACE","\n            ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","where",85],"(",["T_CONSTANT_ENCAPSED_STRING","'pdd.attribute_id IN(?)'",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$attrIds",85],")",["T_WHITESPACE","\n            ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","where",86],"(","\"",["T_CURLY_OPEN","{",86],["T_VARIABLE","$productValueExpression",86],"}",["T_ENCAPSED_AND_WHITESPACE"," IS NOT NULL",86],"\"",")",";",["T_WHITESPACE","\n\n        ",86],["T_VARIABLE","$statusCond",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$write",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","quoteInto",88],"(",["T_CONSTANT_ENCAPSED_STRING","'=?'",88],",",["T_WHITESPACE"," ",88],["T_STRING","Mage_Catalog_Model_Product_Status",88],["T_DOUBLE_COLON","::",88],["T_STRING","STATUS_ENABLED",88],")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_addAttributeToSelect",89],"(",["T_VARIABLE","$select",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'status'",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'pdd.entity_id'",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'cs.store_id'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$statusCond",89],")",";",["T_WHITESPACE","\n\n        ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_STRING","is_null",91],"(",["T_VARIABLE","$entityIds",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$select",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","where",92],"(",["T_CONSTANT_ENCAPSED_STRING","'pdd.entity_id IN(?)'",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$entityIds",92],")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n\n        ",93],["T_DOC_COMMENT","\/**\n         * Add additional external limitation\n         *\/",95],["T_WHITESPACE","\n        ",97],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","dispatchEvent",98],"(",["T_CONSTANT_ENCAPSED_STRING","'prepare_catalog_product_index_select'",98],",",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'select'",99],["T_WHITESPACE","        ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$select",99],",",["T_WHITESPACE","\n            ",99],["T_CONSTANT_ENCAPSED_STRING","'entity_field'",100],["T_WHITESPACE","  ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_NEW","new",100],["T_WHITESPACE"," ",100],["T_STRING","Zend_Db_Expr",100],"(",["T_CONSTANT_ENCAPSED_STRING","'pdd.entity_id'",100],")",",",["T_WHITESPACE","\n            ",100],["T_CONSTANT_ENCAPSED_STRING","'website_field'",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_STRING","Zend_Db_Expr",101],"(",["T_CONSTANT_ENCAPSED_STRING","'cs.website_id'",101],")",",",["T_WHITESPACE","\n            ",101],["T_CONSTANT_ENCAPSED_STRING","'store_field'",102],["T_WHITESPACE","   ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_STRING","Zend_Db_Expr",102],"(",["T_CONSTANT_ENCAPSED_STRING","'cs.store_id'",102],")",["T_WHITESPACE","\n        ",102],")",")",";",["T_WHITESPACE","\n\n        ",103],["T_VARIABLE","$query",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$select",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","insertFromSelect",105],"(",["T_VARIABLE","$idxTable",105],")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$write",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","query",106],"(",["T_VARIABLE","$query",106],")",";",["T_WHITESPACE","\n\n        ",106],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Retrieve decimal indexable attributes\n     *\n     * @return array\n     *\/",111],["T_WHITESPACE","\n    ",115],["T_PROTECTED","protected",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","_getIndexableAttributes",116],"(",")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$adapter",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_getReadAdapter",118],"(",")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$select",119],["T_WHITESPACE","  ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$adapter",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","select",119],"(",")",["T_WHITESPACE","\n            ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","from",120],"(",["T_ARRAY","array",120],"(",["T_CONSTANT_ENCAPSED_STRING","'ca'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getTable",120],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/eav_attribute'",120],")",")",",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",120],")",["T_WHITESPACE","\n            ",120],["T_OBJECT_OPERATOR","->",121],["T_STRING","join",121],"(",["T_WHITESPACE","\n                ",121],["T_ARRAY","array",122],"(",["T_CONSTANT_ENCAPSED_STRING","'ea'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getTable",122],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/attribute'",122],")",")",",",["T_WHITESPACE","\n                ",122],["T_CONSTANT_ENCAPSED_STRING","'ca.attribute_id = ea.attribute_id'",123],",",["T_WHITESPACE","\n                ",123],["T_ARRAY","array",124],"(",")",")",["T_WHITESPACE","\n            ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","where",125],"(",["T_CONSTANT_ENCAPSED_STRING","'ea.attribute_code != ?'",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'price'",125],")",["T_WHITESPACE","\n            ",125],["T_OBJECT_OPERATOR","->",126],["T_STRING","where",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_getIndexableAttributesCondition",126],"(",")",")",["T_WHITESPACE","\n            ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","where",127],"(",["T_CONSTANT_ENCAPSED_STRING","'ea.backend_type=?'",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'decimal'",127],")",";",["T_WHITESPACE","\n\n        ",127],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$adapter",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","fetchCol",129],"(",["T_VARIABLE","$select",129],")",";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Retrieve temporary decimal index table name\n     *\n     * @param string $table\n     * @return string\n     *\/",132],["T_WHITESPACE","\n    ",137],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","getIdxTable",138],"(",["T_VARIABLE","$table",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","null",138],")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","useIdxTable",140],"(",")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getTable",141],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_eav_decimal_indexer_idx'",141],")",";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getTable",143],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_eav_decimal_indexer_tmp'",143],")",";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n",144],"}",["T_WHITESPACE","\n",145]]