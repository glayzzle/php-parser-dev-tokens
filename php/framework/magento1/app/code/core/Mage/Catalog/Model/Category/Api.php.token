[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Catalog\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog category api\n *\n * @category   Mage\n * @package    Mage_Catalog\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Category_Api",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Api_Resource",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","__construct",36],"(",")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","_storeIdSessionField",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'category_store_id'",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Retrieve level of categories for category\/store view\/website\n     *\n     * @param string|int|null $website\n     * @param string|int|null $store\n     * @param int|null $categoryId\n     * @return array\n     *\/",41],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","level",49],"(",["T_VARIABLE","$website",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","null",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$store",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","null",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$categoryId",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","null",49],")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$ids",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_ARRAY","array",51],"(",")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$storeId",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","Mage_Catalog_Model_Category",52],["T_DOUBLE_COLON","::",52],["T_STRING","DEFAULT_STORE_ID",52],";",["T_WHITESPACE","\n\n        ",52],["T_COMMENT","\/\/ load root categories of website\n",54],["T_WHITESPACE","        ",55],["T_IF","if",55],["T_WHITESPACE"," ",55],"(",["T_STRING","null",55],["T_WHITESPACE"," ",55],["T_IS_NOT_IDENTICAL","!==",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$website",55],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_TRY","try",56],["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n                ",56],["T_VARIABLE","$website",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","Mage",57],["T_DOUBLE_COLON","::",57],["T_STRING","app",57],"(",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","getWebsite",57],"(",["T_VARIABLE","$website",57],")",";",["T_WHITESPACE","\n                ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_STRING","null",58],["T_WHITESPACE"," ",58],["T_IS_IDENTICAL","===",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$store",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                    ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_STRING","null",59],["T_WHITESPACE"," ",59],["T_IS_IDENTICAL","===",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$categoryId",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                        ",59],["T_FOREACH","foreach",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$website",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getStores",60],"(",")",["T_WHITESPACE"," ",60],["T_AS","as",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$store",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                            ",60],["T_COMMENT","\/* @var $store Mage_Core_Model_Store *\/",61],["T_WHITESPACE","\n                            ",61],["T_VARIABLE","$ids",62],"[","]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$store",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getRootCategoryId",62],"(",")",";",["T_WHITESPACE","\n                        ",62],"}",["T_WHITESPACE","\n                    ",63],"}",["T_WHITESPACE"," ",64],["T_ELSE","else",64],["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                        ",64],["T_VARIABLE","$ids",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$categoryId",65],";",["T_WHITESPACE","\n                    ",65],"}",["T_WHITESPACE","\n                ",66],"}",["T_WHITESPACE"," ",67],["T_ELSEIF","elseif",67],["T_WHITESPACE"," ",67],"(",["T_STRING","in_array",67],"(",["T_VARIABLE","$store",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$website",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getStoreIds",67],"(",")",")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                    ",67],["T_VARIABLE","$storeId",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","app",68],"(",")",["T_OBJECT_OPERATOR","->",68],["T_STRING","getStore",68],"(",["T_VARIABLE","$store",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","getId",68],"(",")",";",["T_WHITESPACE","\n                    ",68],["T_VARIABLE","$ids",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],"(",["T_STRING","null",69],["T_WHITESPACE"," ",69],["T_IS_IDENTICAL","===",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$categoryId",69],")","?",["T_WHITESPACE"," ",69],["T_VARIABLE","$store",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getRootCategoryId",69],"(",")",["T_WHITESPACE"," ",69],":",["T_WHITESPACE"," ",69],["T_VARIABLE","$categoryId",69],";",["T_WHITESPACE","\n                ",69],"}",["T_WHITESPACE"," ",70],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_fault",71],"(",["T_CONSTANT_ENCAPSED_STRING","'store_not_exists'",71],")",";",["T_WHITESPACE","\n                ",71],"}",["T_WHITESPACE","\n            ",72],"}",["T_WHITESPACE"," ",73],["T_CATCH","catch",73],["T_WHITESPACE"," ",73],"(",["T_STRING","Mage_Core_Exception",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$e",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n                ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_fault",74],"(",["T_CONSTANT_ENCAPSED_STRING","'website_not_exists'",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$e",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getMessage",74],"(",")",")",";",["T_WHITESPACE","\n            ",74],"}",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n        ",76],["T_ELSEIF","elseif",77],["T_WHITESPACE"," ",77],"(",["T_STRING","null",77],["T_WHITESPACE"," ",77],["T_IS_NOT_IDENTICAL","!==",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$store",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_COMMENT","\/\/ load children of root category of store\n",78],["T_WHITESPACE","            ",79],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_STRING","null",79],["T_WHITESPACE"," ",79],["T_IS_IDENTICAL","===",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$categoryId",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n                ",79],["T_TRY","try",80],["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n                    ",80],["T_VARIABLE","$store",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","Mage",81],["T_DOUBLE_COLON","::",81],["T_STRING","app",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","getStore",81],"(",["T_VARIABLE","$store",81],")",";",["T_WHITESPACE","\n                    ",81],["T_VARIABLE","$storeId",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$store",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getId",82],"(",")",";",["T_WHITESPACE","\n                    ",82],["T_VARIABLE","$ids",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$store",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getRootCategoryId",83],"(",")",";",["T_WHITESPACE","\n                ",83],"}",["T_WHITESPACE"," ",84],["T_CATCH","catch",84],["T_WHITESPACE"," ",84],"(",["T_STRING","Mage_Core_Model_Store_Exception",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$e",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                    ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_fault",85],"(",["T_CONSTANT_ENCAPSED_STRING","'store_not_exists'",85],")",";",["T_WHITESPACE","\n                ",85],"}",["T_WHITESPACE","\n            ",86],"}",["T_WHITESPACE","\n            ",87],["T_COMMENT","\/\/ load children of specified category id\n",88],["T_WHITESPACE","            ",89],["T_ELSE","else",89],["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$storeId",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_getStoreId",90],"(",["T_VARIABLE","$store",90],")",";",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$ids",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_INT_CAST","(int)",91],["T_VARIABLE","$categoryId",91],";",["T_WHITESPACE","\n            ",91],"}",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n        ",93],["T_COMMENT","\/\/ load all root categories\n",94],["T_WHITESPACE","        ",95],["T_ELSE","else",95],["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$ids",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],"(",["T_STRING","null",96],["T_WHITESPACE"," ",96],["T_IS_IDENTICAL","===",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$categoryId",96],")","?",["T_WHITESPACE"," ",96],["T_STRING","Mage_Catalog_Model_Category",96],["T_DOUBLE_COLON","::",96],["T_STRING","TREE_ROOT_ID",96],["T_WHITESPACE"," ",96],":",["T_WHITESPACE"," ",96],["T_VARIABLE","$categoryId",96],";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$collection",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","Mage",99],["T_DOUBLE_COLON","::",99],["T_STRING","getModel",99],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",99],")",["T_OBJECT_OPERATOR","->",99],["T_STRING","getCollection",99],"(",")",["T_WHITESPACE","\n            ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","setStoreId",100],"(",["T_VARIABLE","$storeId",100],")",["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","addAttributeToSelect",101],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",101],")",["T_WHITESPACE","\n            ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","addAttributeToSelect",102],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active'",102],")",";",["T_WHITESPACE","\n\n        ",102],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_STRING","is_array",104],"(",["T_VARIABLE","$ids",104],")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$collection",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","addFieldToFilter",105],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",105],",",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$ids",105],")",")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE"," ",106],["T_ELSE","else",106],["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$collection",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","addFieldToFilter",107],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$ids",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_COMMENT","\/\/ Only basic category data\n",110],["T_WHITESPACE","        ",111],["T_VARIABLE","$result",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",")",";",["T_WHITESPACE","\n        ",111],["T_FOREACH","foreach",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$collection",112],["T_WHITESPACE"," ",112],["T_AS","as",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$category",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_COMMENT","\/* @var $category Mage_Catalog_Model_Category *\/",113],["T_WHITESPACE","\n            ",113],["T_VARIABLE","$result",114],"[","]",["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_WHITESPACE","\n                ",114],["T_CONSTANT_ENCAPSED_STRING","'category_id'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$category",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getId",115],"(",")",",",["T_WHITESPACE","\n                ",115],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",116],["T_WHITESPACE","   ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$category",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getParentId",116],"(",")",",",["T_WHITESPACE","\n                ",116],["T_CONSTANT_ENCAPSED_STRING","'name'",117],["T_WHITESPACE","        ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$category",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getName",117],"(",")",",",["T_WHITESPACE","\n                ",117],["T_CONSTANT_ENCAPSED_STRING","'is_active'",118],["T_WHITESPACE","   ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$category",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getIsActive",118],"(",")",",",["T_WHITESPACE","\n                ",118],["T_CONSTANT_ENCAPSED_STRING","'position'",119],["T_WHITESPACE","    ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$category",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getPosition",119],"(",")",",",["T_WHITESPACE","\n                ",119],["T_CONSTANT_ENCAPSED_STRING","'level'",120],["T_WHITESPACE","       ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$category",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getLevel",120],"(",")",["T_WHITESPACE","\n            ",120],")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n\n        ",122],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$result",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Retrieve category tree\n     *\n     * @param int $parent\n     * @param string|int $store\n     * @return array\n     *\/",127],["T_WHITESPACE","\n    ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","tree",134],"(",["T_VARIABLE","$parentId",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","null",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$store",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_STRING","null",134],")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_STRING","is_null",136],"(",["T_VARIABLE","$parentId",136],")",["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],"!",["T_STRING","is_null",136],"(",["T_VARIABLE","$store",136],")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$parentId",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","Mage",137],["T_DOUBLE_COLON","::",137],["T_STRING","app",137],"(",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getStore",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_getStoreId",137],"(",["T_VARIABLE","$store",137],")",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getRootCategoryId",137],"(",")",";",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE"," ",138],["T_ELSEIF","elseif",138],["T_WHITESPACE"," ",138],"(",["T_STRING","is_null",138],"(",["T_VARIABLE","$parentId",138],")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$parentId",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_LNUMBER","1",139],";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n\n        ",140],["T_COMMENT","\/* @var $tree Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Tree *\/",142],["T_WHITESPACE","\n        ",142],["T_VARIABLE","$tree",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","Mage",143],["T_DOUBLE_COLON","::",143],["T_STRING","getResourceSingleton",143],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_tree'",143],")",["T_WHITESPACE","\n            ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","load",144],"(",")",";",["T_WHITESPACE","\n\n        ",144],["T_VARIABLE","$root",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$tree",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getNodeById",146],"(",["T_VARIABLE","$parentId",146],")",";",["T_WHITESPACE","\n\n        ",146],["T_IF","if",148],"(",["T_VARIABLE","$root",148],["T_WHITESPACE"," ",148],["T_BOOLEAN_AND","&&",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$root",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getId",148],"(",")",["T_WHITESPACE"," ",148],["T_IS_EQUAL","==",148],["T_WHITESPACE"," ",148],["T_LNUMBER","1",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$root",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","setName",149],"(",["T_STRING","Mage",149],["T_DOUBLE_COLON","::",149],["T_STRING","helper",149],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",149],")",["T_OBJECT_OPERATOR","->",149],["T_STRING","__",149],"(",["T_CONSTANT_ENCAPSED_STRING","'Root'",149],")",")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_VARIABLE","$collection",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","Mage",152],["T_DOUBLE_COLON","::",152],["T_STRING","getModel",152],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",152],")",["T_OBJECT_OPERATOR","->",152],["T_STRING","getCollection",152],"(",")",["T_WHITESPACE","\n            ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","setStoreId",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_getStoreId",153],"(",["T_VARIABLE","$store",153],")",")",["T_WHITESPACE","\n            ",153],["T_OBJECT_OPERATOR","->",154],["T_STRING","addAttributeToSelect",154],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",154],")",["T_WHITESPACE","\n            ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","addAttributeToSelect",155],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active'",155],")",";",["T_WHITESPACE","\n\n        ",155],["T_VARIABLE","$tree",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","addCollectionData",157],"(",["T_VARIABLE","$collection",157],",",["T_WHITESPACE"," ",157],["T_STRING","true",157],")",";",["T_WHITESPACE","\n\n        ",157],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_nodeToArray",159],"(",["T_VARIABLE","$root",159],")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Convert node to array\n     *\n     * @param Varien_Data_Tree_Node $node\n     * @return array\n     *\/",162],["T_WHITESPACE","\n    ",167],["T_PROTECTED","protected",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","_nodeToArray",168],"(",["T_STRING","Varien_Data_Tree_Node",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$node",168],")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_COMMENT","\/\/ Only basic category data\n",170],["T_WHITESPACE","        ",171],["T_VARIABLE","$result",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_ARRAY","array",171],"(",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$result",172],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",172],"]",["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$node",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getId",172],"(",")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$result",173],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",173],"]",["T_WHITESPACE","   ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$node",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getParentId",173],"(",")",";",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$result",174],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",174],"]",["T_WHITESPACE","        ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$node",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getName",174],"(",")",";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$result",175],"[",["T_CONSTANT_ENCAPSED_STRING","'is_active'",175],"]",["T_WHITESPACE","   ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$node",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getIsActive",175],"(",")",";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$result",176],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",176],"]",["T_WHITESPACE","    ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$node",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getPosition",176],"(",")",";",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$result",177],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",177],"]",["T_WHITESPACE","       ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$node",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getLevel",177],"(",")",";",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$result",178],"[",["T_CONSTANT_ENCAPSED_STRING","'children'",178],"]",["T_WHITESPACE","    ",178],"=",["T_WHITESPACE"," ",178],["T_ARRAY","array",178],"(",")",";",["T_WHITESPACE","\n\n        ",178],["T_FOREACH","foreach",180],["T_WHITESPACE"," ",180],"(",["T_VARIABLE","$node",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getChildren",180],"(",")",["T_WHITESPACE"," ",180],["T_AS","as",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$child",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$result",181],"[",["T_CONSTANT_ENCAPSED_STRING","'children'",181],"]","[","]",["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_nodeToArray",181],"(",["T_VARIABLE","$child",181],")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n\n        ",182],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$result",184],";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Initilize and return category model\n     *\n     * @param int $categoryId\n     * @param string|int $store\n     * @return Mage_Catalog_Model_Category\n     *\/",187],["T_WHITESPACE","\n    ",193],["T_PROTECTED","protected",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","_initCategory",194],"(",["T_VARIABLE","$categoryId",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$store",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","null",194],")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$category",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","getModel",196],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",196],")",["T_WHITESPACE","\n            ",196],["T_OBJECT_OPERATOR","->",197],["T_STRING","setStoreId",197],"(",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","_getStoreId",197],"(",["T_VARIABLE","$store",197],")",")",["T_WHITESPACE","\n            ",197],["T_OBJECT_OPERATOR","->",198],["T_STRING","load",198],"(",["T_VARIABLE","$categoryId",198],")",";",["T_WHITESPACE","\n\n        ",198],["T_IF","if",200],["T_WHITESPACE"," ",200],"(","!",["T_VARIABLE","$category",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getId",200],"(",")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_fault",201],"(",["T_CONSTANT_ENCAPSED_STRING","'not_exists'",201],")",";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n\n        ",202],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$category",204],";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n\n    ",205],["T_DOC_COMMENT","\/**\n     * Retrieve category data\n     *\n     * @param int $categoryId\n     * @param string|int $store\n     * @param array $attributes\n     * @return array\n     *\/",207],["T_WHITESPACE","\n    ",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","info",215],"(",["T_VARIABLE","$categoryId",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$store",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_STRING","null",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$attributes",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_STRING","null",215],")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$category",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_initCategory",217],"(",["T_VARIABLE","$categoryId",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$store",217],")",";",["T_WHITESPACE","\n\n        ",217],["T_COMMENT","\/\/ Basic category data\n",219],["T_WHITESPACE","        ",220],["T_VARIABLE","$result",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_ARRAY","array",220],"(",")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$result",221],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",221],"]",["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$category",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getId",221],"(",")",";",["T_WHITESPACE","\n\n        ",221],["T_VARIABLE","$result",223],"[",["T_CONSTANT_ENCAPSED_STRING","'is_active'",223],"]",["T_WHITESPACE","   ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$category",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getIsActive",223],"(",")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$result",224],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",224],"]",["T_WHITESPACE","    ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$category",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getPosition",224],"(",")",";",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$result",225],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",225],"]",["T_WHITESPACE","       ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$category",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getLevel",225],"(",")",";",["T_WHITESPACE","\n\n        ",225],["T_FOREACH","foreach",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$category",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getAttributes",227],"(",")",["T_WHITESPACE"," ",227],["T_AS","as",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$attribute",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_isAllowedAttribute",228],"(",["T_VARIABLE","$attribute",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$attributes",228],")",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n                ",228],["T_VARIABLE","$result",229],"[",["T_VARIABLE","$attribute",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getAttributeCode",229],"(",")","]",["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$category",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getData",229],"(",["T_VARIABLE","$attribute",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getAttributeCode",229],"(",")",")",";",["T_WHITESPACE","\n            ",229],"}",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$result",232],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",232],"]",["T_WHITESPACE","   ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$category",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getParentId",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$result",233],"[",["T_CONSTANT_ENCAPSED_STRING","'children'",233],"]",["T_WHITESPACE","           ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$category",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getChildren",233],"(",")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$result",234],"[",["T_CONSTANT_ENCAPSED_STRING","'all_children'",234],"]",["T_WHITESPACE","       ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$category",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getAllChildren",234],"(",")",";",["T_WHITESPACE","\n\n        ",234],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$result",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Create new category\n     *\n     * @param int $parentId\n     * @param array $categoryData\n     * @param int|null|string $store\n     * @return int\n     *\/",239],["T_WHITESPACE","\n    ",246],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","create",247],"(",["T_VARIABLE","$parentId",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$categoryData",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$store",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","null",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$parent_category",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_initCategory",249],"(",["T_VARIABLE","$parentId",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$store",249],")",";",["T_WHITESPACE","\n\n        ",249],["T_DOC_COMMENT","\/** @var $category Mage_Catalog_Model_Category *\/",251],["T_WHITESPACE","\n        ",251],["T_VARIABLE","$category",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_STRING","Mage",252],["T_DOUBLE_COLON","::",252],["T_STRING","getModel",252],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",252],")",["T_WHITESPACE","\n            ",252],["T_OBJECT_OPERATOR","->",253],["T_STRING","setStoreId",253],"(",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_getStoreId",253],"(",["T_VARIABLE","$store",253],")",")",";",["T_WHITESPACE","\n\n        ",253],["T_VARIABLE","$category",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","addData",255],"(",["T_ARRAY","array",255],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",255],["T_DOUBLE_ARROW","=>",255],["T_STRING","implode",255],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$parent_category",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getPathIds",255],"(",")",")",")",")",";",["T_WHITESPACE","\n        ",255],["T_VARIABLE","$category",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","setAttributeSetId",256],"(",["T_VARIABLE","$category",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getDefaultAttributeSetId",256],"(",")",")",";",["T_WHITESPACE","\n\n        ",256],["T_VARIABLE","$useConfig",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_ARRAY","array",258],"(",")",";",["T_WHITESPACE","\n        ",258],["T_FOREACH","foreach",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$category",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getAttributes",259],"(",")",["T_WHITESPACE"," ",259],["T_AS","as",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$attribute",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_isAllowedAttribute",260],"(",["T_VARIABLE","$attribute",260],")",["T_WHITESPACE","\n                ",260],["T_BOOLEAN_AND","&&",261],["T_WHITESPACE"," ",261],["T_ISSET","isset",261],"(",["T_VARIABLE","$categoryData",261],"[",["T_VARIABLE","$attribute",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getAttributeCode",261],"(",")","]",")",["T_WHITESPACE","\n            ",261],")",["T_WHITESPACE"," ",262],"{",["T_WHITESPACE","\n                ",262],["T_COMMENT","\/\/ check whether value is 'use_config'\n",263],["T_WHITESPACE","                ",264],["T_VARIABLE","$attrCode",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$attribute",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getAttributeCode",264],"(",")",";",["T_WHITESPACE","\n                ",264],["T_VARIABLE","$categoryDataValue",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_VARIABLE","$categoryData",265],"[",["T_VARIABLE","$attrCode",265],"]",";",["T_WHITESPACE","\n                ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_CONSTANT_ENCAPSED_STRING","'use_config'",266],["T_WHITESPACE"," ",266],["T_IS_IDENTICAL","===",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$categoryDataValue",266],["T_WHITESPACE"," ",266],["T_BOOLEAN_OR","||",266],["T_WHITESPACE","\n                    ",266],"(",["T_STRING","is_array",267],"(",["T_VARIABLE","$categoryDataValue",267],")",["T_WHITESPACE"," ",267],["T_BOOLEAN_AND","&&",267],["T_WHITESPACE","\n                    ",267],["T_STRING","count",268],"(",["T_VARIABLE","$categoryDataValue",268],")",["T_WHITESPACE"," ",268],["T_IS_EQUAL","==",268],["T_WHITESPACE"," ",268],["T_LNUMBER","1",268],["T_WHITESPACE"," ",268],["T_BOOLEAN_AND","&&",268],["T_WHITESPACE","\n                    ",268],["T_CONSTANT_ENCAPSED_STRING","'use_config'",269],["T_WHITESPACE"," ",269],["T_IS_IDENTICAL","===",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$categoryDataValue",269],"[",["T_LNUMBER","0",269],"]",")",["T_WHITESPACE","\n                ",269],")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n                    ",270],["T_VARIABLE","$useConfig",271],"[","]",["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$attrCode",271],";",["T_WHITESPACE","\n                    ",271],["T_VARIABLE","$category",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","setData",272],"(",["T_VARIABLE","$attrCode",272],",",["T_WHITESPACE"," ",272],["T_STRING","null",272],")",";",["T_WHITESPACE","\n                ",272],"}",["T_WHITESPACE"," ",273],["T_ELSE","else",273],["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n                    ",273],["T_VARIABLE","$category",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","setData",274],"(",["T_VARIABLE","$attrCode",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$categoryDataValue",274],")",";",["T_WHITESPACE","\n                ",274],"}",["T_WHITESPACE","\n            ",275],"}",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE","\n\n        ",277],["T_VARIABLE","$category",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","setParentId",279],"(",["T_VARIABLE","$parent_category",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getId",279],"(",")",")",";",["T_WHITESPACE","\n\n        ",279],["T_DOC_COMMENT","\/**\n         * Proceed with $useConfig set into category model for processing through validation\n         *\/",281],["T_WHITESPACE","\n        ",283],["T_IF","if",284],["T_WHITESPACE"," ",284],"(",["T_STRING","count",284],"(",["T_VARIABLE","$useConfig",284],")",["T_WHITESPACE"," ",284],">",["T_WHITESPACE"," ",284],["T_LNUMBER","0",284],")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$category",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","setData",285],"(",["T_CONSTANT_ENCAPSED_STRING","\"use_post_data_config\"",285],",",["T_WHITESPACE"," ",285],["T_VARIABLE","$useConfig",285],")",";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n\n        ",286],["T_TRY","try",288],["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$validate",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$category",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","validate",289],"(",")",";",["T_WHITESPACE","\n            ",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$validate",290],["T_WHITESPACE"," ",290],["T_IS_NOT_IDENTICAL","!==",290],["T_WHITESPACE"," ",290],["T_STRING","true",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n                ",290],["T_FOREACH","foreach",291],["T_WHITESPACE"," ",291],"(",["T_VARIABLE","$validate",291],["T_WHITESPACE"," ",291],["T_AS","as",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$code",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$error",291],")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n                    ",291],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$error",292],["T_WHITESPACE"," ",292],["T_IS_IDENTICAL","===",292],["T_WHITESPACE"," ",292],["T_STRING","true",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n                        ",292],["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","throwException",293],"(",["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","helper",293],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",293],")",["T_OBJECT_OPERATOR","->",293],["T_STRING","__",293],"(",["T_CONSTANT_ENCAPSED_STRING","'Attribute \"%s\" is required.'",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$code",293],")",")",";",["T_WHITESPACE","\n                    ",293],"}",["T_WHITESPACE"," ",294],["T_ELSE","else",294],["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n                        ",294],["T_STRING","Mage",295],["T_DOUBLE_COLON","::",295],["T_STRING","throwException",295],"(",["T_VARIABLE","$error",295],")",";",["T_WHITESPACE","\n                    ",295],"}",["T_WHITESPACE","\n                ",296],"}",["T_WHITESPACE","\n            ",297],"}",["T_WHITESPACE","\n\n            ",298],["T_VARIABLE","$category",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","save",300],"(",")",";",["T_WHITESPACE","\n        ",300],"}",["T_WHITESPACE","\n        ",301],["T_CATCH","catch",302],["T_WHITESPACE"," ",302],"(",["T_STRING","Mage_Core_Exception",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$e",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n            ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_fault",303],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$e",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getMessage",303],"(",")",")",";",["T_WHITESPACE","\n        ",303],"}",["T_WHITESPACE","\n        ",304],["T_CATCH","catch",305],["T_WHITESPACE"," ",305],"(",["T_STRING","Exception",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$e",305],")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n            ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_fault",306],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$e",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getMessage",306],"(",")",")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n\n        ",307],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$category",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getId",309],"(",")",";",["T_WHITESPACE","\n    ",309],"}",["T_WHITESPACE","\n\n    ",310],["T_DOC_COMMENT","\/**\n     * Update category data\n     *\n     * @param int $categoryId\n     * @param array $categoryData\n     * @param string|int $store\n     * @return boolean\n     *\/",312],["T_WHITESPACE","\n    ",319],["T_PUBLIC","public",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","update",320],"(",["T_VARIABLE","$categoryId",320],",",["T_WHITESPACE"," ",320],["T_VARIABLE","$categoryData",320],",",["T_WHITESPACE"," ",320],["T_VARIABLE","$store",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","null",320],")",["T_WHITESPACE","\n    ",320],"{",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$category",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_initCategory",322],"(",["T_VARIABLE","$categoryId",322],",",["T_WHITESPACE"," ",322],["T_VARIABLE","$store",322],")",";",["T_WHITESPACE","\n\n        ",322],["T_FOREACH","foreach",324],["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$category",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getAttributes",324],"(",")",["T_WHITESPACE"," ",324],["T_AS","as",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$attribute",324],")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_IF","if",325],["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_isAllowedAttribute",325],"(",["T_VARIABLE","$attribute",325],")",["T_WHITESPACE","\n                ",325],["T_BOOLEAN_AND","&&",326],["T_WHITESPACE"," ",326],["T_ISSET","isset",326],"(",["T_VARIABLE","$categoryData",326],"[",["T_VARIABLE","$attribute",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","getAttributeCode",326],"(",")","]",")",")",["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n                ",326],["T_VARIABLE","$category",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","setData",327],"(",["T_WHITESPACE","\n                    ",327],["T_VARIABLE","$attribute",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getAttributeCode",328],"(",")",",",["T_WHITESPACE","\n                    ",328],["T_VARIABLE","$categoryData",329],"[",["T_VARIABLE","$attribute",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","getAttributeCode",329],"(",")","]",["T_WHITESPACE","\n                ",329],")",";",["T_WHITESPACE","\n            ",330],"}",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n\n        ",332],["T_TRY","try",334],["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n            ",334],["T_VARIABLE","$validate",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_VARIABLE","$category",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","validate",335],"(",")",";",["T_WHITESPACE","\n            ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$validate",336],["T_WHITESPACE"," ",336],["T_IS_NOT_IDENTICAL","!==",336],["T_WHITESPACE"," ",336],["T_STRING","true",336],")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                ",336],["T_FOREACH","foreach",337],["T_WHITESPACE"," ",337],"(",["T_VARIABLE","$validate",337],["T_WHITESPACE"," ",337],["T_AS","as",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$code",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$error",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                    ",337],["T_IF","if",338],["T_WHITESPACE"," ",338],"(",["T_VARIABLE","$error",338],["T_WHITESPACE"," ",338],["T_IS_IDENTICAL","===",338],["T_WHITESPACE"," ",338],["T_STRING","true",338],")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n                        ",338],["T_STRING","Mage",339],["T_DOUBLE_COLON","::",339],["T_STRING","throwException",339],"(",["T_STRING","Mage",339],["T_DOUBLE_COLON","::",339],["T_STRING","helper",339],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",339],")",["T_OBJECT_OPERATOR","->",339],["T_STRING","__",339],"(",["T_CONSTANT_ENCAPSED_STRING","'Attribute \"%s\" is required.'",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$code",339],")",")",";",["T_WHITESPACE","\n                    ",339],"}",["T_WHITESPACE","\n                    ",340],["T_ELSE","else",341],["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                        ",341],["T_STRING","Mage",342],["T_DOUBLE_COLON","::",342],["T_STRING","throwException",342],"(",["T_VARIABLE","$error",342],")",";",["T_WHITESPACE","\n                    ",342],"}",["T_WHITESPACE","\n                ",343],"}",["T_WHITESPACE","\n            ",344],"}",["T_WHITESPACE","\n\n            ",345],["T_VARIABLE","$category",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","save",347],"(",")",";",["T_WHITESPACE","\n        ",347],"}",["T_WHITESPACE"," ",348],["T_CATCH","catch",348],["T_WHITESPACE"," ",348],"(",["T_STRING","Mage_Core_Exception",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$e",348],")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","_fault",349],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",349],",",["T_WHITESPACE"," ",349],["T_VARIABLE","$e",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getMessage",349],"(",")",")",";",["T_WHITESPACE","\n        ",349],"}",["T_WHITESPACE"," ",350],["T_CATCH","catch",350],["T_WHITESPACE"," ",350],"(",["T_STRING","Mage_Eav_Model_Entity_Attribute_Exception",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$e",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_fault",351],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$e",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getMessage",351],"(",")",")",";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n\n        ",352],["T_RETURN","return",354],["T_WHITESPACE"," ",354],["T_STRING","true",354],";",["T_WHITESPACE","\n    ",354],"}",["T_WHITESPACE","\n\n    ",355],["T_DOC_COMMENT","\/**\n     * Move category in tree\n     *\n     * @param int $categoryId\n     * @param int $parentId\n     * @param int $afterId\n     * @return boolean\n     *\/",357],["T_WHITESPACE","\n    ",364],["T_PUBLIC","public",365],["T_WHITESPACE"," ",365],["T_FUNCTION","function",365],["T_WHITESPACE"," ",365],["T_STRING","move",365],"(",["T_VARIABLE","$categoryId",365],",",["T_WHITESPACE"," ",365],["T_VARIABLE","$parentId",365],",",["T_WHITESPACE"," ",365],["T_VARIABLE","$afterId",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_STRING","null",365],")",["T_WHITESPACE","\n    ",365],"{",["T_WHITESPACE","\n        ",366],["T_VARIABLE","$category",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_initCategory",367],"(",["T_VARIABLE","$categoryId",367],")",";",["T_WHITESPACE","\n        ",367],["T_VARIABLE","$parent_category",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","_initCategory",368],"(",["T_VARIABLE","$parentId",368],")",";",["T_WHITESPACE","\n\n        ",368],["T_COMMENT","\/\/ if $afterId is null - move category to the down\n",370],["T_WHITESPACE","        ",371],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_VARIABLE","$afterId",371],["T_WHITESPACE"," ",371],["T_IS_IDENTICAL","===",371],["T_WHITESPACE"," ",371],["T_STRING","null",371],["T_WHITESPACE"," ",371],["T_BOOLEAN_AND","&&",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$parent_category",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","hasChildren",371],"(",")",")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n            ",371],["T_VARIABLE","$parentChildren",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$parent_category",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","getChildren",372],"(",")",";",["T_WHITESPACE","\n            ",372],["T_VARIABLE","$afterId",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","array_pop",373],"(",["T_STRING","explode",373],"(",["T_CONSTANT_ENCAPSED_STRING","','",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$parentChildren",373],")",")",";",["T_WHITESPACE","\n        ",373],"}",["T_WHITESPACE","\n\n        ",374],["T_IF","if",376],"(",["T_WHITESPACE"," ",376],["T_STRING","strpos",376],"(",["T_VARIABLE","$parent_category",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getPath",376],"(",")",",",["T_WHITESPACE"," ",376],["T_VARIABLE","$category",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getPath",376],"(",")",")",["T_WHITESPACE"," ",376],["T_IS_IDENTICAL","===",376],["T_WHITESPACE"," ",376],["T_LNUMBER","0",376],")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","_fault",377],"(",["T_CONSTANT_ENCAPSED_STRING","'not_moved'",377],",",["T_WHITESPACE"," ",377],["T_CONSTANT_ENCAPSED_STRING","\"Operation do not allow to move a parent category to any of children category\"",377],")",";",["T_WHITESPACE","\n        ",377],"}",["T_WHITESPACE","\n\n        ",378],["T_TRY","try",380],["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n            ",380],["T_VARIABLE","$category",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","move",381],"(",["T_VARIABLE","$parentId",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$afterId",381],")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE"," ",382],["T_CATCH","catch",382],["T_WHITESPACE"," ",382],"(",["T_STRING","Mage_Core_Exception",382],["T_WHITESPACE"," ",382],["T_VARIABLE","$e",382],")",["T_WHITESPACE"," ",382],"{",["T_WHITESPACE","\n            ",382],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_fault",383],"(",["T_CONSTANT_ENCAPSED_STRING","'not_moved'",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$e",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","getMessage",383],"(",")",")",";",["T_WHITESPACE","\n        ",383],"}",["T_WHITESPACE","\n\n        ",384],["T_RETURN","return",386],["T_WHITESPACE"," ",386],["T_STRING","true",386],";",["T_WHITESPACE","\n    ",386],"}",["T_WHITESPACE","\n\n    ",387],["T_DOC_COMMENT","\/**\n     * Delete category\n     *\n     * @param int $categoryId\n     * @return boolean\n     *\/",389],["T_WHITESPACE","\n    ",394],["T_PUBLIC","public",395],["T_WHITESPACE"," ",395],["T_FUNCTION","function",395],["T_WHITESPACE"," ",395],["T_STRING","delete",395],"(",["T_VARIABLE","$categoryId",395],")",["T_WHITESPACE","\n    ",395],"{",["T_WHITESPACE","\n        ",396],["T_IF","if",397],["T_WHITESPACE"," ",397],"(",["T_STRING","Mage_Catalog_Model_Category",397],["T_DOUBLE_COLON","::",397],["T_STRING","TREE_ROOT_ID",397],["T_WHITESPACE"," ",397],["T_IS_EQUAL","==",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$categoryId",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_fault",398],"(",["T_CONSTANT_ENCAPSED_STRING","'not_deleted'",398],",",["T_WHITESPACE"," ",398],["T_CONSTANT_ENCAPSED_STRING","'Cannot remove the system category.'",398],")",";",["T_WHITESPACE","\n        ",398],"}",["T_WHITESPACE","\n\n        ",399],["T_VARIABLE","$category",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_initCategory",401],"(",["T_VARIABLE","$categoryId",401],")",";",["T_WHITESPACE","\n\n        ",401],["T_TRY","try",403],["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n            ",403],["T_VARIABLE","$category",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","delete",404],"(",")",";",["T_WHITESPACE","\n        ",404],"}",["T_WHITESPACE"," ",405],["T_CATCH","catch",405],["T_WHITESPACE"," ",405],"(",["T_STRING","Mage_Core_Exception",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$e",405],")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n            ",405],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","_fault",406],"(",["T_CONSTANT_ENCAPSED_STRING","'not_deleted'",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$e",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getMessage",406],"(",")",")",";",["T_WHITESPACE","\n        ",406],"}",["T_WHITESPACE","\n\n        ",407],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_STRING","true",409],";",["T_WHITESPACE","\n    ",409],"}",["T_WHITESPACE","\n\n    ",410],["T_DOC_COMMENT","\/**\n     * Get prduct Id from sku or from product id\n     *\n     * @param int|string $productId\n     * @param  string $identifierType\n     * @return int\n     *\/",412],["T_WHITESPACE","\n    ",418],["T_PROTECTED","protected",419],["T_WHITESPACE"," ",419],["T_FUNCTION","function",419],["T_WHITESPACE"," ",419],["T_STRING","_getProductId",419],"(",["T_VARIABLE","$productId",419],",",["T_WHITESPACE"," ",419],["T_VARIABLE","$identifierType",419],["T_WHITESPACE"," ",419],"=",["T_WHITESPACE"," ",419],["T_STRING","null",419],")",["T_WHITESPACE","\n    ",419],"{",["T_WHITESPACE","\n        ",420],["T_VARIABLE","$product",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","Mage",421],["T_DOUBLE_COLON","::",421],["T_STRING","helper",421],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",421],")",["T_OBJECT_OPERATOR","->",421],["T_STRING","getProduct",421],"(",["T_VARIABLE","$productId",421],",",["T_WHITESPACE"," ",421],["T_STRING","null",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$identifierType",421],")",";",["T_WHITESPACE","\n        ",421],["T_IF","if",422],["T_WHITESPACE"," ",422],"(","!",["T_VARIABLE","$product",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","getId",422],"(",")",")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n            ",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","_fault",423],"(",["T_CONSTANT_ENCAPSED_STRING","'not_exists'",423],",",["T_CONSTANT_ENCAPSED_STRING","'Product not exists.'",423],")",";",["T_WHITESPACE","\n        ",423],"}",["T_WHITESPACE","\n        ",424],["T_RETURN","return",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$product",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getId",425],"(",")",";",["T_WHITESPACE","\n    ",425],"}",["T_WHITESPACE","\n\n\n    ",426],["T_DOC_COMMENT","\/**\n     * Retrieve list of assigned products to category\n     *\n     * @param int $categoryId\n     * @param string|int $store\n     * @return array\n     *\/",429],["T_WHITESPACE","\n    ",435],["T_PUBLIC","public",436],["T_WHITESPACE"," ",436],["T_FUNCTION","function",436],["T_WHITESPACE"," ",436],["T_STRING","assignedProducts",436],"(",["T_VARIABLE","$categoryId",436],",",["T_WHITESPACE"," ",436],["T_VARIABLE","$store",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_STRING","null",436],")",["T_WHITESPACE","\n    ",436],"{",["T_WHITESPACE","\n        ",437],["T_VARIABLE","$category",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","_initCategory",438],"(",["T_VARIABLE","$categoryId",438],")",";",["T_WHITESPACE","\n\n        ",438],["T_VARIABLE","$storeId",440],["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","_getStoreId",440],"(",["T_VARIABLE","$store",440],")",";",["T_WHITESPACE","\n        ",440],["T_VARIABLE","$collection",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_VARIABLE","$category",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","setStoreId",441],"(",["T_VARIABLE","$storeId",441],")",["T_OBJECT_OPERATOR","->",441],["T_STRING","getProductCollection",441],"(",")",";",["T_WHITESPACE","\n        ",441],"(",["T_VARIABLE","$storeId",442],["T_WHITESPACE"," ",442],["T_IS_EQUAL","==",442],["T_WHITESPACE"," ",442],["T_LNUMBER","0",442],")","?",["T_WHITESPACE"," ",442],["T_VARIABLE","$collection",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","addOrder",442],"(",["T_CONSTANT_ENCAPSED_STRING","'position'",442],",",["T_WHITESPACE"," ",442],["T_CONSTANT_ENCAPSED_STRING","'asc'",442],")",["T_WHITESPACE"," ",442],":",["T_WHITESPACE"," ",442],["T_VARIABLE","$collection",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","setOrder",442],"(",["T_CONSTANT_ENCAPSED_STRING","'position'",442],",",["T_WHITESPACE"," ",442],["T_CONSTANT_ENCAPSED_STRING","'asc'",442],")",";",";",["T_WHITESPACE","\n\n        ",442],["T_VARIABLE","$result",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_ARRAY","array",444],"(",")",";",["T_WHITESPACE","\n\n        ",444],["T_FOREACH","foreach",446],["T_WHITESPACE"," ",446],"(",["T_VARIABLE","$collection",446],["T_WHITESPACE"," ",446],["T_AS","as",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$product",446],")",["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n            ",446],["T_VARIABLE","$result",447],"[","]",["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_ARRAY","array",447],"(",["T_WHITESPACE","\n                ",447],["T_CONSTANT_ENCAPSED_STRING","'product_id'",448],["T_WHITESPACE"," ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_VARIABLE","$product",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","getId",448],"(",")",",",["T_WHITESPACE","\n                ",448],["T_CONSTANT_ENCAPSED_STRING","'type'",449],["T_WHITESPACE","       ",449],["T_DOUBLE_ARROW","=>",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$product",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getTypeId",449],"(",")",",",["T_WHITESPACE","\n                ",449],["T_CONSTANT_ENCAPSED_STRING","'set'",450],["T_WHITESPACE","        ",450],["T_DOUBLE_ARROW","=>",450],["T_WHITESPACE"," ",450],["T_VARIABLE","$product",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","getAttributeSetId",450],"(",")",",",["T_WHITESPACE","\n                ",450],["T_CONSTANT_ENCAPSED_STRING","'sku'",451],["T_WHITESPACE","        ",451],["T_DOUBLE_ARROW","=>",451],["T_WHITESPACE"," ",451],["T_VARIABLE","$product",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","getSku",451],"(",")",",",["T_WHITESPACE","\n                ",451],["T_CONSTANT_ENCAPSED_STRING","'position'",452],["T_WHITESPACE","   ",452],["T_DOUBLE_ARROW","=>",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$product",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","getCatIndexPosition",452],"(",")",["T_WHITESPACE","\n            ",452],")",";",["T_WHITESPACE","\n        ",453],"}",["T_WHITESPACE","\n\n        ",454],["T_RETURN","return",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$result",456],";",["T_WHITESPACE","\n    ",456],"}",["T_WHITESPACE","\n\n    ",457],["T_DOC_COMMENT","\/**\n     * Assign product to category\n     *\n     * @param int $categoryId\n     * @param int $productId\n     * @param int $position\n     * @return boolean\n     *\/",459],["T_WHITESPACE","\n    ",466],["T_PUBLIC","public",467],["T_WHITESPACE"," ",467],["T_FUNCTION","function",467],["T_WHITESPACE"," ",467],["T_STRING","assignProduct",467],"(",["T_VARIABLE","$categoryId",467],",",["T_WHITESPACE"," ",467],["T_VARIABLE","$productId",467],",",["T_WHITESPACE"," ",467],["T_VARIABLE","$position",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_STRING","null",467],",",["T_WHITESPACE"," ",467],["T_VARIABLE","$identifierType",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_STRING","null",467],")",["T_WHITESPACE","\n    ",467],"{",["T_WHITESPACE","\n        ",468],["T_VARIABLE","$category",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_initCategory",469],"(",["T_VARIABLE","$categoryId",469],")",";",["T_WHITESPACE","\n        ",469],["T_VARIABLE","$positions",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_VARIABLE","$category",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","getProductsPosition",470],"(",")",";",["T_WHITESPACE","\n        ",470],["T_VARIABLE","$productId",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_getProductId",471],"(",["T_VARIABLE","$productId",471],")",";",["T_WHITESPACE","\n        ",471],["T_VARIABLE","$positions",472],"[",["T_VARIABLE","$productId",472],"]",["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_VARIABLE","$position",472],";",["T_WHITESPACE","\n        ",472],["T_VARIABLE","$category",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","setPostedProducts",473],"(",["T_VARIABLE","$positions",473],")",";",["T_WHITESPACE","\n\n        ",473],["T_TRY","try",475],["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n            ",475],["T_VARIABLE","$category",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","save",476],"(",")",";",["T_WHITESPACE","\n        ",476],"}",["T_WHITESPACE"," ",477],["T_CATCH","catch",477],["T_WHITESPACE"," ",477],"(",["T_STRING","Mage_Core_Exception",477],["T_WHITESPACE"," ",477],["T_VARIABLE","$e",477],")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n            ",477],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_fault",478],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$e",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","getMessage",478],"(",")",")",";",["T_WHITESPACE","\n        ",478],"}",["T_WHITESPACE","\n\n        ",479],["T_RETURN","return",481],["T_WHITESPACE"," ",481],["T_STRING","true",481],";",["T_WHITESPACE","\n    ",481],"}",["T_WHITESPACE","\n\n\n    ",482],["T_DOC_COMMENT","\/**\n     * Update product assignment\n     *\n     * @param int $categoryId\n     * @param int $productId\n     * @param int $position\n     * @return boolean\n     *\/",485],["T_WHITESPACE","\n    ",492],["T_PUBLIC","public",493],["T_WHITESPACE"," ",493],["T_FUNCTION","function",493],["T_WHITESPACE"," ",493],["T_STRING","updateProduct",493],"(",["T_VARIABLE","$categoryId",493],",",["T_WHITESPACE"," ",493],["T_VARIABLE","$productId",493],",",["T_WHITESPACE"," ",493],["T_VARIABLE","$position",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_STRING","null",493],",",["T_WHITESPACE"," ",493],["T_VARIABLE","$identifierType",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_STRING","null",493],")",["T_WHITESPACE","\n    ",493],"{",["T_WHITESPACE","\n        ",494],["T_VARIABLE","$category",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_initCategory",495],"(",["T_VARIABLE","$categoryId",495],")",";",["T_WHITESPACE","\n        ",495],["T_VARIABLE","$positions",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$category",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","getProductsPosition",496],"(",")",";",["T_WHITESPACE","\n        ",496],["T_VARIABLE","$productId",497],["T_WHITESPACE"," ",497],"=",["T_WHITESPACE"," ",497],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","_getProductId",497],"(",["T_VARIABLE","$productId",497],",",["T_WHITESPACE"," ",497],["T_VARIABLE","$identifierType",497],")",";",["T_WHITESPACE","\n        ",497],["T_IF","if",498],["T_WHITESPACE"," ",498],"(","!",["T_ISSET","isset",498],"(",["T_VARIABLE","$positions",498],"[",["T_VARIABLE","$productId",498],"]",")",")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_fault",499],"(",["T_CONSTANT_ENCAPSED_STRING","'product_not_assigned'",499],")",";",["T_WHITESPACE","\n        ",499],"}",["T_WHITESPACE","\n        ",500],["T_VARIABLE","$positions",501],"[",["T_VARIABLE","$productId",501],"]",["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_VARIABLE","$position",501],";",["T_WHITESPACE","\n        ",501],["T_VARIABLE","$category",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","setPostedProducts",502],"(",["T_VARIABLE","$positions",502],")",";",["T_WHITESPACE","\n\n        ",502],["T_TRY","try",504],["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n            ",504],["T_VARIABLE","$category",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","save",505],"(",")",";",["T_WHITESPACE","\n        ",505],"}",["T_WHITESPACE"," ",506],["T_CATCH","catch",506],["T_WHITESPACE"," ",506],"(",["T_STRING","Mage_Core_Exception",506],["T_WHITESPACE"," ",506],["T_VARIABLE","$e",506],")",["T_WHITESPACE"," ",506],"{",["T_WHITESPACE","\n            ",506],["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","_fault",507],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",507],",",["T_WHITESPACE"," ",507],["T_VARIABLE","$e",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","getMessage",507],"(",")",")",";",["T_WHITESPACE","\n        ",507],"}",["T_WHITESPACE","\n\n        ",508],["T_RETURN","return",510],["T_WHITESPACE"," ",510],["T_STRING","true",510],";",["T_WHITESPACE","\n    ",510],"}",["T_WHITESPACE","\n\n    ",511],["T_DOC_COMMENT","\/**\n     * Remove product assignment from category\n     *\n     * @param int $categoryId\n     * @param int $productId\n     * @return boolean\n     *\/",513],["T_WHITESPACE","\n    ",519],["T_PUBLIC","public",520],["T_WHITESPACE"," ",520],["T_FUNCTION","function",520],["T_WHITESPACE"," ",520],["T_STRING","removeProduct",520],"(",["T_VARIABLE","$categoryId",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$productId",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$identifierType",520],["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_STRING","null",520],")",["T_WHITESPACE","\n    ",520],"{",["T_WHITESPACE","\n        ",521],["T_VARIABLE","$category",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","_initCategory",522],"(",["T_VARIABLE","$categoryId",522],")",";",["T_WHITESPACE","\n        ",522],["T_VARIABLE","$positions",523],["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_VARIABLE","$category",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","getProductsPosition",523],"(",")",";",["T_WHITESPACE","\n        ",523],["T_VARIABLE","$productId",524],["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","_getProductId",524],"(",["T_VARIABLE","$productId",524],",",["T_WHITESPACE"," ",524],["T_VARIABLE","$identifierType",524],")",";",["T_WHITESPACE","\n        ",524],["T_IF","if",525],["T_WHITESPACE"," ",525],"(","!",["T_ISSET","isset",525],"(",["T_VARIABLE","$positions",525],"[",["T_VARIABLE","$productId",525],"]",")",")",["T_WHITESPACE"," ",525],"{",["T_WHITESPACE","\n            ",525],["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","_fault",526],"(",["T_CONSTANT_ENCAPSED_STRING","'product_not_assigned'",526],")",";",["T_WHITESPACE","\n        ",526],"}",["T_WHITESPACE","\n\n        ",527],["T_UNSET","unset",529],"(",["T_VARIABLE","$positions",529],"[",["T_VARIABLE","$productId",529],"]",")",";",["T_WHITESPACE","\n        ",529],["T_VARIABLE","$category",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","setPostedProducts",530],"(",["T_VARIABLE","$positions",530],")",";",["T_WHITESPACE","\n\n        ",530],["T_TRY","try",532],["T_WHITESPACE"," ",532],"{",["T_WHITESPACE","\n            ",532],["T_VARIABLE","$category",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","save",533],"(",")",";",["T_WHITESPACE","\n        ",533],"}",["T_WHITESPACE"," ",534],["T_CATCH","catch",534],["T_WHITESPACE"," ",534],"(",["T_STRING","Mage_Core_Exception",534],["T_WHITESPACE"," ",534],["T_VARIABLE","$e",534],")",["T_WHITESPACE"," ",534],"{",["T_WHITESPACE","\n            ",534],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","_fault",535],"(",["T_CONSTANT_ENCAPSED_STRING","'data_invalid'",535],",",["T_WHITESPACE"," ",535],["T_VARIABLE","$e",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","getMessage",535],"(",")",")",";",["T_WHITESPACE","\n        ",535],"}",["T_WHITESPACE","\n\n        ",536],["T_RETURN","return",538],["T_WHITESPACE"," ",538],["T_STRING","true",538],";",["T_WHITESPACE","\n    ",538],"}",["T_WHITESPACE","\n\n",539],"}",["T_WHITESPACE"," ",541],["T_COMMENT","\/\/ Class Mage_Catalog_Model_Category_Api End\n",541]]