[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sendfriend\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * SendFriend Log\n *\n * @method Mage_Sendfriend_Model_Resource_Sendfriend _getResource()\n * @method Mage_Sendfriend_Model_Resource_Sendfriend getResource()\n * @method int getIp()\n * @method Mage_Sendfriend_Model_Sendfriend setIp(int $value)\n * @method int getTime()\n * @method Mage_Sendfriend_Model_Sendfriend setTime(int $value)\n *\n * @category    Mage\n * @package     Mage_Sendfriend\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",40],["T_CLASS","class",41],["T_WHITESPACE"," ",41],["T_STRING","Mage_Sendfriend_Model_Sendfriend",41],["T_WHITESPACE"," ",41],["T_EXTENDS","extends",41],["T_WHITESPACE"," ",41],["T_STRING","Mage_Core_Model_Abstract",41],["T_WHITESPACE","\n",41],"{",["T_WHITESPACE","\n    ",42],["T_DOC_COMMENT","\/**\n     * Recipient Names\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_names",48],["T_WHITESPACE","   ",48],"=",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Recipient Emails\n     *\n     * @var array\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_emails",55],["T_WHITESPACE","  ",55],"=",["T_WHITESPACE"," ",55],["T_ARRAY","array",55],"(",")",";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Sender data array\n     *\n     * @var array\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_sender",62],["T_WHITESPACE","  ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",")",";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Product Instance\n     *\n     * @var Mage_Catalog_Model_Product\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_product",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Count of sent in last period\n     *\n     * @var int\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_sentCount",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Last values for Cookie\n     *\n     * @var string\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$_lastCookieValue",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",")",";",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\n     *\/",85],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","_construct",89],"(",")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_init",91],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend\/sendfriend'",91],")",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Retrieve Data Helper\n     *\n     * @return Mage_Sendfriend_Helper_Data\n     *\/",94],["T_WHITESPACE","\n    ",98],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","_getHelper",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_STRING","Mage",101],["T_DOUBLE_COLON","::",101],["T_STRING","helper",101],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",101],")",";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Retrieve Option Array\n     *\n     * @deprecated It Is a not Source model\n     * @return array\n     *\/",104],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","toOptionArray",110],"(",")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","        ",111],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","send",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","isExceedLimit",116],"(",")",")","{",["T_WHITESPACE","\n            ",116],["T_STRING","Mage",117],["T_DOUBLE_COLON","::",117],["T_STRING","throwException",117],"(",["T_STRING","Mage",117],["T_DOUBLE_COLON","::",117],["T_STRING","helper",117],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",117],")",["T_OBJECT_OPERATOR","->",117],["T_STRING","__",117],"(",["T_CONSTANT_ENCAPSED_STRING","'You have exceeded limit of %d sends in an hour'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getMaxSendsToFriend",117],"(",")",")",")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_COMMENT","\/* @var $translate Mage_Core_Model_Translate *\/",120],["T_WHITESPACE","\n        ",120],["T_VARIABLE","$translate",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","Mage",121],["T_DOUBLE_COLON","::",121],["T_STRING","getSingleton",121],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/translate'",121],")",";",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$translate",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setTranslateInline",122],"(",["T_STRING","false",122],")",";",["T_WHITESPACE","\n\n        ",122],["T_COMMENT","\/* @var $mailTemplate Mage_Core_Model_Email_Template *\/",124],["T_WHITESPACE","\n        ",124],["T_VARIABLE","$mailTemplate",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","Mage",125],["T_DOUBLE_COLON","::",125],["T_STRING","getModel",125],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template'",125],")",";",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$message",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","nl2br",127],"(",["T_STRING","htmlspecialchars",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getSender",127],"(",")",["T_OBJECT_OPERATOR","->",127],["T_STRING","getMessage",127],"(",")",")",")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$sender",128],["T_WHITESPACE","  ",128],"=",["T_WHITESPACE"," ",128],["T_ARRAY","array",128],"(",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","'name'",129],["T_WHITESPACE","  ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_getHelper",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","escapeHtml",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getSender",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","getName",129],"(",")",")",",",["T_WHITESPACE","\n            ",129],["T_CONSTANT_ENCAPSED_STRING","'email'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_getHelper",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","escapeHtml",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getSender",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","getEmail",130],"(",")",")",["T_WHITESPACE","\n        ",130],")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$mailTemplate",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","setDesignConfig",133],"(",["T_ARRAY","array",133],"(",["T_WHITESPACE","\n            ",133],["T_CONSTANT_ENCAPSED_STRING","'area'",134],["T_WHITESPACE","  ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'frontend'",134],",",["T_WHITESPACE","\n            ",134],["T_CONSTANT_ENCAPSED_STRING","'store'",135],["T_WHITESPACE"," ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_STRING","Mage",135],["T_DOUBLE_COLON","::",135],["T_STRING","app",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","getStore",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","getId",135],"(",")",["T_WHITESPACE","\n        ",135],")",")",";",["T_WHITESPACE","\n\n        ",136],["T_FOREACH","foreach",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getRecipients",138],"(",")",["T_OBJECT_OPERATOR","->",138],["T_STRING","getEmails",138],"(",")",["T_WHITESPACE"," ",138],["T_AS","as",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$k",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$email",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$name",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getRecipients",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getNames",139],"(",["T_VARIABLE","$k",139],")",";",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$mailTemplate",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","sendTransactional",140],"(",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getTemplate",141],"(",")",",",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$sender",142],",",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$email",143],",",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$name",144],",",["T_WHITESPACE","\n                ",144],["T_ARRAY","array",145],"(",["T_WHITESPACE","\n                    ",145],["T_CONSTANT_ENCAPSED_STRING","'name'",146],["T_WHITESPACE","          ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$name",146],",",["T_WHITESPACE","\n                    ",146],["T_CONSTANT_ENCAPSED_STRING","'email'",147],["T_WHITESPACE","         ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$email",147],",",["T_WHITESPACE","\n                    ",147],["T_CONSTANT_ENCAPSED_STRING","'product_name'",148],["T_WHITESPACE","  ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getProduct",148],"(",")",["T_OBJECT_OPERATOR","->",148],["T_STRING","getName",148],"(",")",",",["T_WHITESPACE","\n                    ",148],["T_CONSTANT_ENCAPSED_STRING","'product_url'",149],["T_WHITESPACE","   ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getProduct",149],"(",")",["T_OBJECT_OPERATOR","->",149],["T_STRING","getUrlInStore",149],"(",")",",",["T_WHITESPACE","\n                    ",149],["T_CONSTANT_ENCAPSED_STRING","'message'",150],["T_WHITESPACE","       ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$message",150],",",["T_WHITESPACE","\n                    ",150],["T_CONSTANT_ENCAPSED_STRING","'sender_name'",151],["T_WHITESPACE","   ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$sender",151],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",151],"]",",",["T_WHITESPACE","\n                    ",151],["T_CONSTANT_ENCAPSED_STRING","'sender_email'",152],["T_WHITESPACE","  ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$sender",152],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",152],"]",",",["T_WHITESPACE","\n                    ",152],["T_CONSTANT_ENCAPSED_STRING","'product_image'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_STRING","Mage",153],["T_DOUBLE_COLON","::",153],["T_STRING","helper",153],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/image'",153],")",["T_OBJECT_OPERATOR","->",153],["T_STRING","init",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getProduct",153],"(",")",",",["T_WHITESPACE","\n                        ",153],["T_CONSTANT_ENCAPSED_STRING","'small_image'",154],")",["T_OBJECT_OPERATOR","->",154],["T_STRING","resize",154],"(",["T_LNUMBER","75",154],")",",",["T_WHITESPACE","\n                ",154],")",["T_WHITESPACE","\n            ",155],")",";",["T_WHITESPACE","\n        ",156],"}",["T_WHITESPACE","\n\n        ",157],["T_VARIABLE","$translate",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","setTranslateInline",159],"(",["T_STRING","true",159],")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_incrementSentCount",160],"(",")",";",["T_WHITESPACE","\n\n        ",160],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Validate Form data\n     *\n     * @return bool|array\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","validate",170],"(",")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$errors",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",")",";",["T_WHITESPACE","\n\n        ",172],["T_VARIABLE","$name",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getSender",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","getName",174],"(",")",";",["T_WHITESPACE","\n        ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_EMPTY","empty",175],"(",["T_VARIABLE","$name",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$errors",176],"[","]",["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","Mage",176],["T_DOUBLE_COLON","::",176],["T_STRING","helper",176],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",176],")",["T_OBJECT_OPERATOR","->",176],["T_STRING","__",176],"(",["T_CONSTANT_ENCAPSED_STRING","'The sender name cannot be empty.'",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n        ",177],["T_VARIABLE","$email",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getSender",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getEmail",179],"(",")",";",["T_WHITESPACE","\n        ",179],["T_IF","if",180],["T_WHITESPACE"," ",180],"(",["T_EMPTY","empty",180],"(",["T_VARIABLE","$email",180],")",["T_WHITESPACE"," ",180],["T_LOGICAL_OR","OR",180],["T_WHITESPACE"," ",180],"!",["T_STRING","Zend_Validate",180],["T_DOUBLE_COLON","::",180],["T_STRING","is",180],"(",["T_VARIABLE","$email",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'EmailAddress'",180],")",")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$errors",181],"[","]",["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING","Mage",181],["T_DOUBLE_COLON","::",181],["T_STRING","helper",181],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",181],")",["T_OBJECT_OPERATOR","->",181],["T_STRING","__",181],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid sender email.'",181],")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n\n        ",182],["T_VARIABLE","$message",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getSender",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getMessage",184],"(",")",";",["T_WHITESPACE","\n        ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_EMPTY","empty",185],"(",["T_VARIABLE","$message",185],")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$errors",186],"[","]",["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","Mage",186],["T_DOUBLE_COLON","::",186],["T_STRING","helper",186],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",186],")",["T_OBJECT_OPERATOR","->",186],["T_STRING","__",186],"(",["T_CONSTANT_ENCAPSED_STRING","'The message cannot be empty.'",186],")",";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_IF","if",189],["T_WHITESPACE"," ",189],"(","!",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getRecipients",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","getEmails",189],"(",")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$errors",190],"[","]",["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","Mage",190],["T_DOUBLE_COLON","::",190],["T_STRING","helper",190],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",190],")",["T_OBJECT_OPERATOR","->",190],["T_STRING","__",190],"(",["T_CONSTANT_ENCAPSED_STRING","'At least one recipient must be specified.'",190],")",";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n\n        ",191],["T_COMMENT","\/\/ validate recipients email addresses\n",193],["T_WHITESPACE","        ",194],["T_FOREACH","foreach",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getRecipients",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","getEmails",194],"(",")",["T_WHITESPACE"," ",194],["T_AS","as",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$email",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(","!",["T_STRING","Zend_Validate",195],["T_DOUBLE_COLON","::",195],["T_STRING","is",195],"(",["T_VARIABLE","$email",195],",",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'EmailAddress'",195],")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$errors",196],"[","]",["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","helper",196],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",196],")",["T_OBJECT_OPERATOR","->",196],["T_STRING","__",196],"(",["T_CONSTANT_ENCAPSED_STRING","'An invalid email address for recipient was entered.'",196],")",";",["T_WHITESPACE","\n                ",196],["T_BREAK","break",197],";",["T_WHITESPACE","\n            ",197],"}",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE","\n\n        ",199],["T_VARIABLE","$maxRecipients",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getMaxRecipients",201],"(",")",";",["T_WHITESPACE","\n        ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_STRING","count",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getRecipients",202],"(",")",["T_OBJECT_OPERATOR","->",202],["T_STRING","getEmails",202],"(",")",")",["T_WHITESPACE"," ",202],">",["T_WHITESPACE"," ",202],["T_VARIABLE","$maxRecipients",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$errors",203],"[","]",["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","Mage",203],["T_DOUBLE_COLON","::",203],["T_STRING","helper",203],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",203],")",["T_OBJECT_OPERATOR","->",203],["T_STRING","__",203],"(",["T_CONSTANT_ENCAPSED_STRING","'No more than %d emails can be sent at a time.'",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getMaxRecipients",203],"(",")",")",";",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n\n        ",204],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_EMPTY","empty",206],"(",["T_VARIABLE","$errors",206],")",")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n            ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_STRING","true",207],";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n\n        ",208],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$errors",210],";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n\n    ",211],["T_DOC_COMMENT","\/**\n     * Set cookie instance\n     *\n     * @param Mage_Core_Model_Cookie $product\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",213],["T_WHITESPACE","\n    ",218],["T_PUBLIC","public",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","setCookie",219],"(",["T_VARIABLE","$cookie",219],")",["T_WHITESPACE","\n    ",219],"{",["T_WHITESPACE","\n        ",220],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","setData",221],"(",["T_CONSTANT_ENCAPSED_STRING","'_cookie'",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$cookie",221],")",";",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Retrieve Cookie instance\n     *\n     * @throws Mage_Core_Exception\n     * @return Mage_Core_Model_Cookie\n     *\/",224],["T_WHITESPACE","\n    ",229],["T_PUBLIC","public",230],["T_WHITESPACE"," ",230],["T_FUNCTION","function",230],["T_WHITESPACE"," ",230],["T_STRING","getCookie",230],"(",")",["T_WHITESPACE","\n    ",230],"{",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$cookie",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_getData",232],"(",["T_CONSTANT_ENCAPSED_STRING","'_cookie'",232],")",";",["T_WHITESPACE","\n        ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(","!",["T_VARIABLE","$cookie",233],["T_WHITESPACE"," ",233],["T_INSTANCEOF","instanceof",233],["T_WHITESPACE"," ",233],["T_STRING","Mage_Core_Model_Cookie",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n            ",233],["T_STRING","Mage",234],["T_DOUBLE_COLON","::",234],["T_STRING","throwException",234],"(",["T_STRING","Mage",234],["T_DOUBLE_COLON","::",234],["T_STRING","helper",234],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",234],")",["T_OBJECT_OPERATOR","->",234],["T_STRING","__",234],"(",["T_CONSTANT_ENCAPSED_STRING","'Please define a correct Cookie instance.'",234],")",")",";",["T_WHITESPACE","\n        ",234],"}",["T_WHITESPACE","\n        ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$cookie",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Set Visitor Remote Address\n     *\n     * @param int $ipAddr the IP address on Long Format\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",239],["T_WHITESPACE","\n    ",244],["T_PUBLIC","public",245],["T_WHITESPACE"," ",245],["T_FUNCTION","function",245],["T_WHITESPACE"," ",245],["T_STRING","setRemoteAddr",245],"(",["T_VARIABLE","$ipAddr",245],")",["T_WHITESPACE","\n    ",245],"{",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","setData",247],"(",["T_CONSTANT_ENCAPSED_STRING","'_remote_addr'",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$ipAddr",247],")",";",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Retrieve Visitor Remote Address\n     *\n     * @return int\n     *\/",251],["T_WHITESPACE","\n    ",255],["T_PUBLIC","public",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","getRemoteAddr",256],"(",")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_getData",258],"(",["T_CONSTANT_ENCAPSED_STRING","'_remote_addr'",258],")",";",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n\n    ",259],["T_DOC_COMMENT","\/**\n     * Set Website Id\n     *\n     * @param int $id - website id\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",261],["T_WHITESPACE","\n    ",266],["T_PUBLIC","public",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","setWebsiteId",267],"(",["T_VARIABLE","$id",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","setData",269],"(",["T_CONSTANT_ENCAPSED_STRING","'_website_id'",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$id",269],")",";",["T_WHITESPACE","\n        ",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * Retrieve Website Id\n     *\n     * @return int\n     *\/",273],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","getWebsiteId",278],"(",")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_getData",280],"(",["T_CONSTANT_ENCAPSED_STRING","'_website_id'",280],")",";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Set Recipients\n     *\n     * @param array $recipients\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",283],["T_WHITESPACE","\n    ",288],["T_PUBLIC","public",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","setRecipients",289],"(",["T_VARIABLE","$recipients",289],")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_COMMENT","\/\/ validate array\n",291],["T_WHITESPACE","        ",292],["T_IF","if",292],["T_WHITESPACE"," ",292],"(","!",["T_STRING","is_array",292],"(",["T_VARIABLE","$recipients",292],")",["T_WHITESPACE"," ",292],["T_LOGICAL_OR","OR",292],["T_WHITESPACE"," ",292],"!",["T_ISSET","isset",292],"(",["T_VARIABLE","$recipients",292],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",292],"]",")",["T_WHITESPACE","\n            ",292],["T_LOGICAL_OR","OR",293],["T_WHITESPACE"," ",293],"!",["T_ISSET","isset",293],"(",["T_VARIABLE","$recipients",293],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",293],"]",")",["T_WHITESPACE"," ",293],["T_LOGICAL_OR","OR",293],["T_WHITESPACE"," ",293],"!",["T_STRING","is_array",293],"(",["T_VARIABLE","$recipients",293],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",293],"]",")",["T_WHITESPACE","\n            ",293],["T_LOGICAL_OR","OR",294],["T_WHITESPACE"," ",294],"!",["T_STRING","is_array",294],"(",["T_VARIABLE","$recipients",294],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",294],"]",")",")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],";",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n\n        ",296],["T_VARIABLE","$emails",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_ARRAY","array",298],"(",")",";",["T_WHITESPACE","\n        ",298],["T_VARIABLE","$names",299],["T_WHITESPACE","  ",299],"=",["T_WHITESPACE"," ",299],["T_ARRAY","array",299],"(",")",";",["T_WHITESPACE","\n        ",299],["T_FOREACH","foreach",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$recipients",300],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",300],"]",["T_WHITESPACE"," ",300],["T_AS","as",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$k",300],["T_WHITESPACE"," ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$email",300],")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n            ",300],["T_IF","if",301],["T_WHITESPACE"," ",301],"(","!",["T_ISSET","isset",301],"(",["T_VARIABLE","$emails",301],"[",["T_VARIABLE","$email",301],"]",")",["T_WHITESPACE"," ",301],["T_BOOLEAN_AND","&&",301],["T_WHITESPACE"," ",301],["T_ISSET","isset",301],"(",["T_VARIABLE","$recipients",301],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",301],"]","[",["T_VARIABLE","$k",301],"]",")",")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n                ",301],["T_VARIABLE","$emails",302],"[",["T_VARIABLE","$email",302],"]",["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","true",302],";",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$names",303],"[","]",["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$recipients",303],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",303],"]","[",["T_VARIABLE","$k",303],"]",";",["T_WHITESPACE","\n            ",303],"}",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n\n        ",305],["T_IF","if",307],["T_WHITESPACE"," ",307],"(",["T_VARIABLE","$emails",307],")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$emails",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","array_keys",308],"(",["T_VARIABLE","$emails",308],")",";",["T_WHITESPACE","\n        ",308],"}",["T_WHITESPACE","\n\n        ",309],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","setData",311],"(",["T_CONSTANT_ENCAPSED_STRING","'_recipients'",311],",",["T_WHITESPACE"," ",311],["T_NEW","new",311],["T_WHITESPACE"," ",311],["T_STRING","Varien_Object",311],"(",["T_ARRAY","array",311],"(",["T_WHITESPACE","\n            ",311],["T_CONSTANT_ENCAPSED_STRING","'emails'",312],["T_WHITESPACE"," ",312],["T_DOUBLE_ARROW","=>",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$emails",312],",",["T_WHITESPACE","\n            ",312],["T_CONSTANT_ENCAPSED_STRING","'names'",313],["T_WHITESPACE","  ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$names",313],["T_WHITESPACE","\n        ",313],")",")",")",";",["T_WHITESPACE","\n    ",314],"}",["T_WHITESPACE","\n\n    ",315],["T_DOC_COMMENT","\/**\n     * Retrieve Recipients object\n     *\n     * @return Varien_Object\n     *\/",317],["T_WHITESPACE","\n    ",321],["T_PUBLIC","public",322],["T_WHITESPACE"," ",322],["T_FUNCTION","function",322],["T_WHITESPACE"," ",322],["T_STRING","getRecipients",322],"(",")",["T_WHITESPACE","\n    ",322],"{",["T_WHITESPACE","\n        ",323],["T_VARIABLE","$recipients",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_getData",324],"(",["T_CONSTANT_ENCAPSED_STRING","'_recipients'",324],")",";",["T_WHITESPACE","\n        ",324],["T_IF","if",325],["T_WHITESPACE"," ",325],"(","!",["T_VARIABLE","$recipients",325],["T_WHITESPACE"," ",325],["T_INSTANCEOF","instanceof",325],["T_WHITESPACE"," ",325],["T_STRING","Varien_Object",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$recipients",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE","  ",326],["T_NEW","new",326],["T_WHITESPACE"," ",326],["T_STRING","Varien_Object",326],"(",["T_ARRAY","array",326],"(",["T_WHITESPACE","\n                ",326],["T_CONSTANT_ENCAPSED_STRING","'emails'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_ARRAY","array",327],"(",")",",",["T_WHITESPACE","\n                ",327],["T_CONSTANT_ENCAPSED_STRING","'names'",328],["T_WHITESPACE","  ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],["T_ARRAY","array",328],"(",")",["T_WHITESPACE","\n            ",328],")",")",";",["T_WHITESPACE","\n            ",329],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","setData",330],"(",["T_CONSTANT_ENCAPSED_STRING","'_recipients'",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$recipients",330],")",";",["T_WHITESPACE","\n        ",330],"}",["T_WHITESPACE","\n        ",331],["T_RETURN","return",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$recipients",332],";",["T_WHITESPACE","\n    ",332],"}",["T_WHITESPACE","\n\n    ",333],["T_DOC_COMMENT","\/**\n     * Set product instance\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",335],["T_WHITESPACE","\n    ",340],["T_PUBLIC","public",341],["T_WHITESPACE"," ",341],["T_FUNCTION","function",341],["T_WHITESPACE"," ",341],["T_STRING","setProduct",341],"(",["T_VARIABLE","$product",341],")",["T_WHITESPACE","\n    ",341],"{",["T_WHITESPACE","\n        ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","setData",343],"(",["T_CONSTANT_ENCAPSED_STRING","'_product'",343],",",["T_WHITESPACE"," ",343],["T_VARIABLE","$product",343],")",";",["T_WHITESPACE","\n    ",343],"}",["T_WHITESPACE","\n\n    ",344],["T_DOC_COMMENT","\/**\n     * Retrieve Product instance\n     *\n     * @throws Mage_Core_Exception\n     * @return Mage_Catalog_Model_Product\n     *\/",346],["T_WHITESPACE","\n    ",351],["T_PUBLIC","public",352],["T_WHITESPACE"," ",352],["T_FUNCTION","function",352],["T_WHITESPACE"," ",352],["T_STRING","getProduct",352],"(",")",["T_WHITESPACE","\n    ",352],"{",["T_WHITESPACE","\n        ",353],["T_VARIABLE","$product",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","_getData",354],"(",["T_CONSTANT_ENCAPSED_STRING","'_product'",354],")",";",["T_WHITESPACE","\n        ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(","!",["T_VARIABLE","$product",355],["T_WHITESPACE"," ",355],["T_INSTANCEOF","instanceof",355],["T_WHITESPACE"," ",355],["T_STRING","Mage_Catalog_Model_Product",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_STRING","Mage",356],["T_DOUBLE_COLON","::",356],["T_STRING","throwException",356],"(",["T_STRING","Mage",356],["T_DOUBLE_COLON","::",356],["T_STRING","helper",356],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",356],")",["T_OBJECT_OPERATOR","->",356],["T_STRING","__",356],"(",["T_CONSTANT_ENCAPSED_STRING","'Please define a correct Product instance.'",356],")",")",";",["T_WHITESPACE","\n        ",356],"}",["T_WHITESPACE","\n        ",357],["T_RETURN","return",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$product",358],";",["T_WHITESPACE","\n    ",358],"}",["T_WHITESPACE","\n\n    ",359],["T_DOC_COMMENT","\/**\n     * Set Sender Information array\n     *\n     * @param array $sender\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",361],["T_WHITESPACE","\n    ",366],["T_PUBLIC","public",367],["T_WHITESPACE"," ",367],["T_FUNCTION","function",367],["T_WHITESPACE"," ",367],["T_STRING","setSender",367],"(",["T_VARIABLE","$sender",367],")",["T_WHITESPACE","\n    ",367],"{",["T_WHITESPACE","\n        ",368],["T_IF","if",369],["T_WHITESPACE"," ",369],"(","!",["T_STRING","is_array",369],"(",["T_VARIABLE","$sender",369],")",")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n            ",369],["T_STRING","Mage",370],["T_DOUBLE_COLON","::",370],["T_STRING","helper",370],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",370],")",["T_OBJECT_OPERATOR","->",370],["T_STRING","__",370],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid Sender Information'",370],")",";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n\n        ",371],["T_RETURN","return",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","setData",373],"(",["T_CONSTANT_ENCAPSED_STRING","'_sender'",373],",",["T_WHITESPACE"," ",373],["T_NEW","new",373],["T_WHITESPACE"," ",373],["T_STRING","Varien_Object",373],"(",["T_VARIABLE","$sender",373],")",")",";",["T_WHITESPACE","\n    ",373],"}",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * Retrieve Sender Information Object\n     *\n     * @throws Mage_Core_Exception\n     * @return Varien_Object\n     *\/",376],["T_WHITESPACE","\n    ",381],["T_PUBLIC","public",382],["T_WHITESPACE"," ",382],["T_FUNCTION","function",382],["T_WHITESPACE"," ",382],["T_STRING","getSender",382],"(",")",["T_WHITESPACE","\n    ",382],"{",["T_WHITESPACE","\n        ",383],["T_VARIABLE","$sender",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_getData",384],"(",["T_CONSTANT_ENCAPSED_STRING","'_sender'",384],")",";",["T_WHITESPACE","\n        ",384],["T_IF","if",385],["T_WHITESPACE"," ",385],"(","!",["T_VARIABLE","$sender",385],["T_WHITESPACE"," ",385],["T_INSTANCEOF","instanceof",385],["T_WHITESPACE"," ",385],["T_STRING","Varien_Object",385],")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n            ",385],["T_STRING","Mage",386],["T_DOUBLE_COLON","::",386],["T_STRING","throwException",386],"(",["T_STRING","Mage",386],["T_DOUBLE_COLON","::",386],["T_STRING","helper",386],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",386],")",["T_OBJECT_OPERATOR","->",386],["T_STRING","__",386],"(",["T_CONSTANT_ENCAPSED_STRING","'Please define the correct Sender information.'",386],")",")",";",["T_WHITESPACE","\n        ",386],"}",["T_WHITESPACE","\n        ",387],["T_RETURN","return",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$sender",388],";",["T_WHITESPACE","\n    ",388],"}",["T_WHITESPACE","\n\n    ",389],["T_DOC_COMMENT","\/**\n     * @deprecated after 1.3.2.4\n     * For get count sent letters use Mage_Sendfriend_Model_Sendfriend::getSentCount\n     * or Mage_Sendfriend_Model_Sendfriend::isExceedLimit\n     *\n     * @param int $ip\n     * @param int $startTime\n     * @return int\n     *\/",391],["T_WHITESPACE","\n    ",399],["T_PUBLIC","public",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","getSendCount",400],"(",["T_VARIABLE","$ip",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_STRING","null",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$startTime",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_STRING","null",400],")",["T_WHITESPACE","\n    ",400],"{",["T_WHITESPACE","\n        ",401],["T_IF","if",402],["T_WHITESPACE"," ",402],"(",["T_STRING","is_null",402],"(",["T_VARIABLE","$ip",402],")",")",["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n            ",402],["T_VARIABLE","$ip",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","getRemoteAddr",403],"(",")",";",["T_WHITESPACE","\n        ",403],"}",["T_WHITESPACE","\n        ",404],["T_IF","if",405],["T_WHITESPACE"," ",405],"(",["T_STRING","is_null",405],"(",["T_VARIABLE","$startTime",405],")",")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n            ",405],["T_VARIABLE","$startTime",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_STRING","time",406],"(",")",["T_WHITESPACE"," ",406],"-",["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","_getHelper",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","getPeriod",406],"(",")",";",["T_WHITESPACE","\n        ",406],"}",["T_WHITESPACE","\n\n        ",407],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","_getResource",409],"(",")",["T_OBJECT_OPERATOR","->",409],["T_STRING","getSendCount",409],"(",["T_VARIABLE","$this",409],",",["T_WHITESPACE"," ",409],["T_VARIABLE","$ip",409],",",["T_WHITESPACE"," ",409],["T_VARIABLE","$startTime",409],")",";",["T_WHITESPACE","\n    ",409],"}",["T_WHITESPACE","\n\n    ",410],["T_DOC_COMMENT","\/**\n     * Get max allowed uses of \"Send to Friend\" function per hour\n     *\n     * @return integer\n     *\/",412],["T_WHITESPACE","\n    ",416],["T_PUBLIC","public",417],["T_WHITESPACE"," ",417],["T_FUNCTION","function",417],["T_WHITESPACE"," ",417],["T_STRING","getMaxSendsToFriend",417],"(",")",["T_WHITESPACE","\n    ",417],"{",["T_WHITESPACE","\n        ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","_getHelper",419],"(",")",["T_OBJECT_OPERATOR","->",419],["T_STRING","getMaxEmailPerPeriod",419],"(",")",";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n\n    ",420],["T_DOC_COMMENT","\/**\n     * Get current Email \"Send to friend\" template\n     *\n     * @return string\n     *\/",422],["T_WHITESPACE","\n    ",426],["T_PUBLIC","public",427],["T_WHITESPACE"," ",427],["T_FUNCTION","function",427],["T_WHITESPACE"," ",427],["T_STRING","getTemplate",427],"(",")",["T_WHITESPACE","\n    ",427],"{",["T_WHITESPACE","\n        ",428],["T_RETURN","return",429],["T_WHITESPACE"," ",429],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","_getHelper",429],"(",")",["T_OBJECT_OPERATOR","->",429],["T_STRING","getEmailTemplate",429],"(",")",";",["T_WHITESPACE","\n    ",429],"}",["T_WHITESPACE","\n\n    ",430],["T_DOC_COMMENT","\/**\n     * Get max allowed recipients for \"Send to a Friend\" function\n     *\n     * @return integer\n     *\/",432],["T_WHITESPACE","\n    ",436],["T_PUBLIC","public",437],["T_WHITESPACE"," ",437],["T_FUNCTION","function",437],["T_WHITESPACE"," ",437],["T_STRING","getMaxRecipients",437],"(",")",["T_WHITESPACE","\n    ",437],"{",["T_WHITESPACE","\n        ",438],["T_RETURN","return",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","_getHelper",439],"(",")",["T_OBJECT_OPERATOR","->",439],["T_STRING","getMaxRecipients",439],"(",")",";",["T_WHITESPACE","\n    ",439],"}",["T_WHITESPACE","\n\n    ",440],["T_DOC_COMMENT","\/**\n     * Check if user is allowed to email product to a friend\n     *\n     * @return boolean\n     *\/",442],["T_WHITESPACE","\n    ",446],["T_PUBLIC","public",447],["T_WHITESPACE"," ",447],["T_FUNCTION","function",447],["T_WHITESPACE"," ",447],["T_STRING","canEmailToFriend",447],"(",")",["T_WHITESPACE","\n    ",447],"{",["T_WHITESPACE","\n        ",448],["T_RETURN","return",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","_getHelper",449],"(",")",["T_OBJECT_OPERATOR","->",449],["T_STRING","isEnabled",449],"(",")",";",["T_WHITESPACE","\n    ",449],"}",["T_WHITESPACE","\n\n    ",450],["T_DOC_COMMENT","\/**\n     * Check if user is exceed limit\n     *\n     * @return boolean\n     *\/",452],["T_WHITESPACE","\n    ",456],["T_PUBLIC","public",457],["T_WHITESPACE"," ",457],["T_FUNCTION","function",457],["T_WHITESPACE"," ",457],["T_STRING","isExceedLimit",457],"(",")",["T_WHITESPACE","\n    ",457],"{",["T_WHITESPACE","\n        ",458],["T_RETURN","return",459],["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","getSentCount",459],"(",")",["T_WHITESPACE"," ",459],["T_IS_GREATER_OR_EQUAL",">=",459],["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","getMaxSendsToFriend",459],"(",")",";",["T_WHITESPACE","\n    ",459],"}",["T_WHITESPACE","\n\n    ",460],["T_DOC_COMMENT","\/**\n     * Return count of sent in last period\n     *\n     * @param bool $useCache - flag, is allow to use value of attribute of model if it is processed last time\n     * @return int\n     *\/",462],["T_WHITESPACE","\n    ",467],["T_PUBLIC","public",468],["T_WHITESPACE"," ",468],["T_FUNCTION","function",468],["T_WHITESPACE"," ",468],["T_STRING","getSentCount",468],"(",["T_VARIABLE","$useCache",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_STRING","true",468],")",["T_WHITESPACE","\n    ",468],"{",["T_WHITESPACE","\n        ",469],["T_IF","if",470],["T_WHITESPACE"," ",470],"(",["T_VARIABLE","$useCache",470],["T_WHITESPACE"," ",470],["T_BOOLEAN_AND","&&",470],["T_WHITESPACE"," ",470],"!",["T_STRING","is_null",470],"(",["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","_sentCount",470],")",")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n            ",470],["T_RETURN","return",471],["T_WHITESPACE"," ",471],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_sentCount",471],";",["T_WHITESPACE","\n        ",471],"}",["T_WHITESPACE","\n\n        ",472],["T_SWITCH","switch",474],["T_WHITESPACE"," ",474],"(",["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","_getHelper",474],"(",")",["T_OBJECT_OPERATOR","->",474],["T_STRING","getLimitBy",474],"(",")",")",["T_WHITESPACE"," ",474],"{",["T_WHITESPACE","\n            ",474],["T_CASE","case",475],["T_WHITESPACE"," ",475],["T_STRING","Mage_Sendfriend_Helper_Data",475],["T_DOUBLE_COLON","::",475],["T_STRING","CHECK_COOKIE",475],":",["T_WHITESPACE","\n                ",475],["T_RETURN","return",476],["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_sentCount",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_sentCountByCookies",476],"(",["T_STRING","false",476],")",";",["T_WHITESPACE","\n            ",476],["T_CASE","case",477],["T_WHITESPACE"," ",477],["T_STRING","Mage_Sendfriend_Helper_Data",477],["T_DOUBLE_COLON","::",477],["T_STRING","CHECK_IP",477],":",["T_WHITESPACE","\n                ",477],["T_RETURN","return",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_sentCount",478],["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_sentCountByIp",478],"(",["T_STRING","false",478],")",";",["T_WHITESPACE","\n            ",478],["T_DEFAULT","default",479],":",["T_WHITESPACE","\n                ",479],["T_RETURN","return",480],["T_WHITESPACE"," ",480],["T_LNUMBER","0",480],";",["T_WHITESPACE","\n        ",480],"}",["T_WHITESPACE","\n    ",481],"}",["T_WHITESPACE","\n\n    ",482],["T_DOC_COMMENT","\/**\n     * Increase count of sent\n     *\n     * @return int\n     *\/",484],["T_WHITESPACE","\n    ",488],["T_PROTECTED","protected",489],["T_WHITESPACE"," ",489],["T_FUNCTION","function",489],["T_WHITESPACE"," ",489],["T_STRING","_incrementSentCount",489],"(",")",["T_WHITESPACE","\n    ",489],"{",["T_WHITESPACE","\n        ",490],["T_SWITCH","switch",491],["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","_getHelper",491],"(",")",["T_OBJECT_OPERATOR","->",491],["T_STRING","getLimitBy",491],"(",")",")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n            ",491],["T_CASE","case",492],["T_WHITESPACE"," ",492],["T_STRING","Mage_Sendfriend_Helper_Data",492],["T_DOUBLE_COLON","::",492],["T_STRING","CHECK_COOKIE",492],":",["T_WHITESPACE","\n                ",492],["T_RETURN","return",493],["T_WHITESPACE"," ",493],["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","_sentCount",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","_sentCountByCookies",493],"(",["T_STRING","true",493],")",";",["T_WHITESPACE","\n            ",493],["T_CASE","case",494],["T_WHITESPACE"," ",494],["T_STRING","Mage_Sendfriend_Helper_Data",494],["T_DOUBLE_COLON","::",494],["T_STRING","CHECK_IP",494],":",["T_WHITESPACE","\n                ",494],["T_RETURN","return",495],["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_sentCount",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_sentCountByIp",495],"(",["T_STRING","true",495],")",";",["T_WHITESPACE","\n            ",495],["T_DEFAULT","default",496],":",["T_WHITESPACE","\n                ",496],["T_RETURN","return",497],["T_WHITESPACE"," ",497],["T_LNUMBER","0",497],";",["T_WHITESPACE","\n        ",497],"}",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Return count of sent in last period by cookie\n     *\n     * @param bool $increment - flag, increase count before return value\n     * @return int\n     *\/",501],["T_WHITESPACE","\n    ",506],["T_PROTECTED","protected",507],["T_WHITESPACE"," ",507],["T_FUNCTION","function",507],["T_WHITESPACE"," ",507],["T_STRING","_sentCountByCookies",507],"(",["T_VARIABLE","$increment",507],["T_WHITESPACE"," ",507],"=",["T_WHITESPACE"," ",507],["T_STRING","false",507],")",["T_WHITESPACE","\n    ",507],"{",["T_WHITESPACE","\n        ",508],["T_VARIABLE","$cookie",509],["T_WHITESPACE","   ",509],"=",["T_WHITESPACE"," ",509],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","_getHelper",509],"(",")",["T_OBJECT_OPERATOR","->",509],["T_STRING","getCookieName",509],"(",")",";",["T_WHITESPACE","\n        ",509],["T_VARIABLE","$time",510],["T_WHITESPACE","     ",510],"=",["T_WHITESPACE"," ",510],["T_STRING","time",510],"(",")",";",["T_WHITESPACE","\n        ",510],["T_VARIABLE","$newTimes",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_ARRAY","array",511],"(",")",";",["T_WHITESPACE","\n\n        ",511],["T_IF","if",513],["T_WHITESPACE"," ",513],"(",["T_ISSET","isset",513],"(",["T_VARIABLE","$this",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","_lastCookieValue",513],"[",["T_VARIABLE","$cookie",513],"]",")",")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n            ",513],["T_VARIABLE","$oldTimes",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","_lastCookieValue",514],"[",["T_VARIABLE","$cookie",514],"]",";",["T_WHITESPACE","\n        ",514],"}",["T_WHITESPACE"," ",515],["T_ELSE","else",515],["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n            ",515],["T_VARIABLE","$oldTimes",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","getCookie",516],"(",")",["T_OBJECT_OPERATOR","->",516],["T_STRING","get",516],"(",["T_VARIABLE","$cookie",516],")",";",["T_WHITESPACE","\n        ",516],"}",["T_WHITESPACE","\n\n        ",517],["T_IF","if",519],["T_WHITESPACE"," ",519],"(",["T_VARIABLE","$oldTimes",519],")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n            ",519],["T_VARIABLE","$oldTimes",520],["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_STRING","explode",520],"(",["T_CONSTANT_ENCAPSED_STRING","','",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$oldTimes",520],")",";",["T_WHITESPACE","\n            ",520],["T_FOREACH","foreach",521],["T_WHITESPACE"," ",521],"(",["T_VARIABLE","$oldTimes",521],["T_WHITESPACE"," ",521],["T_AS","as",521],["T_WHITESPACE"," ",521],["T_VARIABLE","$oldTime",521],")",["T_WHITESPACE"," ",521],"{",["T_WHITESPACE","\n                ",521],["T_VARIABLE","$periodTime",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_VARIABLE","$time",522],["T_WHITESPACE"," ",522],"-",["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","_getHelper",522],"(",")",["T_OBJECT_OPERATOR","->",522],["T_STRING","getPeriod",522],"(",")",";",["T_WHITESPACE","\n                ",522],["T_IF","if",523],["T_WHITESPACE"," ",523],"(",["T_STRING","is_numeric",523],"(",["T_VARIABLE","$oldTime",523],")",["T_WHITESPACE"," ",523],["T_LOGICAL_AND","AND",523],["T_WHITESPACE"," ",523],["T_VARIABLE","$oldTime",523],["T_WHITESPACE"," ",523],["T_IS_GREATER_OR_EQUAL",">=",523],["T_WHITESPACE"," ",523],["T_VARIABLE","$periodTime",523],")",["T_WHITESPACE"," ",523],"{",["T_WHITESPACE","\n                    ",523],["T_VARIABLE","$newTimes",524],"[","]",["T_WHITESPACE"," ",524],"=",["T_WHITESPACE"," ",524],["T_VARIABLE","$oldTime",524],";",["T_WHITESPACE","\n                ",524],"}",["T_WHITESPACE","\n            ",525],"}",["T_WHITESPACE","\n        ",526],"}",["T_WHITESPACE","\n\n        ",527],["T_IF","if",529],["T_WHITESPACE"," ",529],"(",["T_VARIABLE","$increment",529],")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n            ",529],["T_VARIABLE","$newTimes",530],"[","]",["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_VARIABLE","$time",530],";",["T_WHITESPACE","\n            ",530],["T_VARIABLE","$newValue",531],["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_STRING","implode",531],"(",["T_CONSTANT_ENCAPSED_STRING","','",531],",",["T_WHITESPACE"," ",531],["T_VARIABLE","$newTimes",531],")",";",["T_WHITESPACE","\n            ",531],["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","getCookie",532],"(",")",["T_OBJECT_OPERATOR","->",532],["T_STRING","set",532],"(",["T_VARIABLE","$cookie",532],",",["T_WHITESPACE"," ",532],["T_VARIABLE","$newValue",532],")",";",["T_WHITESPACE","\n            ",532],["T_VARIABLE","$this",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","_lastCookieValue",533],"[",["T_VARIABLE","$cookie",533],"]",["T_WHITESPACE"," ",533],"=",["T_WHITESPACE"," ",533],["T_VARIABLE","$newValue",533],";",["T_WHITESPACE","\n        ",533],"}",["T_WHITESPACE","\n\n        ",534],["T_RETURN","return",536],["T_WHITESPACE"," ",536],["T_STRING","count",536],"(",["T_VARIABLE","$newTimes",536],")",";",["T_WHITESPACE","\n    ",536],"}",["T_WHITESPACE","\n    ",537],["T_DOC_COMMENT","\/**\n     * Return count of sent in last period by IP address\n     *\n     * @param bool $increment - flag, increase count before return value\n     * @return int\n     *\/",538],["T_WHITESPACE","\n    ",543],["T_PROTECTED","protected",544],["T_WHITESPACE"," ",544],["T_FUNCTION","function",544],["T_WHITESPACE"," ",544],["T_STRING","_sentCountByIp",544],"(",["T_VARIABLE","$increment",544],["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_STRING","false",544],")",["T_WHITESPACE","\n    ",544],"{",["T_WHITESPACE","\n        ",545],["T_VARIABLE","$time",546],["T_WHITESPACE","   ",546],"=",["T_WHITESPACE"," ",546],["T_STRING","time",546],"(",")",";",["T_WHITESPACE","\n        ",546],["T_VARIABLE","$period",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","_getHelper",547],"(",")",["T_OBJECT_OPERATOR","->",547],["T_STRING","getPeriod",547],"(",")",";",["T_WHITESPACE","\n        ",547],["T_VARIABLE","$websiteId",548],["T_WHITESPACE"," ",548],"=",["T_WHITESPACE"," ",548],["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getWebsiteId",548],"(",")",";",["T_WHITESPACE","\n\n        ",548],["T_IF","if",550],["T_WHITESPACE"," ",550],"(",["T_VARIABLE","$increment",550],")",["T_WHITESPACE"," ",550],"{",["T_WHITESPACE","\n            ",550],["T_COMMENT","\/\/ delete expired logs\n",551],["T_WHITESPACE","            ",552],["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","_getResource",552],"(",")",["T_OBJECT_OPERATOR","->",552],["T_STRING","deleteLogsBefore",552],"(",["T_VARIABLE","$time",552],["T_WHITESPACE"," ",552],"-",["T_WHITESPACE"," ",552],["T_VARIABLE","$period",552],")",";",["T_WHITESPACE","\n            ",552],["T_COMMENT","\/\/ add new item\n",553],["T_WHITESPACE","            ",554],["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","_getResource",554],"(",")",["T_OBJECT_OPERATOR","->",554],["T_STRING","addSendItem",554],"(",["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","getRemoteAddr",554],"(",")",",",["T_WHITESPACE"," ",554],["T_VARIABLE","$time",554],",",["T_WHITESPACE"," ",554],["T_VARIABLE","$websiteId",554],")",";",["T_WHITESPACE","\n        ",554],"}",["T_WHITESPACE","\n\n        ",555],["T_RETURN","return",557],["T_WHITESPACE"," ",557],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","_getResource",557],"(",")",["T_OBJECT_OPERATOR","->",557],["T_STRING","getSendCount",557],"(",["T_VARIABLE","$this",557],",",["T_WHITESPACE"," ",557],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","getRemoteAddr",557],"(",")",",",["T_WHITESPACE"," ",557],["T_STRING","time",557],"(",")",["T_WHITESPACE"," ",557],"-",["T_WHITESPACE"," ",557],["T_VARIABLE","$period",557],",",["T_WHITESPACE"," ",557],["T_VARIABLE","$websiteId",557],")",";",["T_WHITESPACE","\n    ",557],"}",["T_WHITESPACE","\n    ",558],["T_DOC_COMMENT","\/**\n     * Register self in global register with name send_to_friend_model\n     *\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",559],["T_WHITESPACE","\n    ",563],["T_PUBLIC","public",564],["T_WHITESPACE"," ",564],["T_FUNCTION","function",564],["T_WHITESPACE"," ",564],["T_STRING","register",564],"(",")",["T_WHITESPACE","\n    ",564],"{",["T_WHITESPACE","\n        ",565],["T_IF","if",566],["T_WHITESPACE"," ",566],"(","!",["T_STRING","Mage",566],["T_DOUBLE_COLON","::",566],["T_STRING","registry",566],"(",["T_CONSTANT_ENCAPSED_STRING","'send_to_friend_model'",566],")",")",["T_WHITESPACE"," ",566],"{",["T_WHITESPACE","\n            ",566],["T_STRING","Mage",567],["T_DOUBLE_COLON","::",567],["T_STRING","register",567],"(",["T_CONSTANT_ENCAPSED_STRING","'send_to_friend_model'",567],",",["T_WHITESPACE"," ",567],["T_VARIABLE","$this",567],")",";",["T_WHITESPACE","\n        ",567],"}",["T_WHITESPACE","\n        ",568],["T_RETURN","return",569],["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],";",["T_WHITESPACE","\n    ",569],"}",["T_WHITESPACE","\n\n    ",570],["T_DOC_COMMENT","\/**\n     * @deprecated after 1.3.2.4\n     * use Mage_Sendfriend_Model_Sendfriend::_sentCountByCookies\n     *\n     * @return int\n     *\/",572],["T_WHITESPACE","\n    ",577],["T_PROTECTED","protected",578],["T_WHITESPACE"," ",578],["T_FUNCTION","function",578],["T_WHITESPACE"," ",578],["T_STRING","_amountByCookies",578],"(",")",["T_WHITESPACE","\n    ",578],"{",["T_WHITESPACE","\n        ",579],["T_RETURN","return",580],["T_WHITESPACE"," ",580],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","_sentCountByCookies",580],"(",["T_STRING","true",580],")",";",["T_WHITESPACE","\n    ",580],"}",["T_WHITESPACE","\n\n    ",581],["T_DOC_COMMENT","\/**\n     * @deprecated after 1.3.2.4\n     * use Mage_Sendfriend_Model_Sendfriend::_sentCountByIp\n     *\n     * @return int\n     *\/",583],["T_WHITESPACE","\n    ",588],["T_PROTECTED","protected",589],["T_WHITESPACE"," ",589],["T_FUNCTION","function",589],["T_WHITESPACE"," ",589],["T_STRING","_amountByIp",589],"(",")",["T_WHITESPACE","\n    ",589],"{",["T_WHITESPACE","\n        ",590],["T_RETURN","return",591],["T_WHITESPACE"," ",591],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","_sentCountByIp",591],"(",["T_STRING","true",591],")",";",["T_WHITESPACE","\n    ",591],"}",["T_WHITESPACE","\n",592],"}",["T_WHITESPACE","\n",593]]