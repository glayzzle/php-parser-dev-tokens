[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sendfriend\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Email to a Friend Block\n *\n * @category    Mage\n * @package     Mage_Sendfriend\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sendfriend_Block_Send",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Block_Template",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Retrieve username for form field\n     *\n     * @return string\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","getUserName",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$name",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getFormData",44],"(",")",["T_OBJECT_OPERATOR","->",44],["T_STRING","getData",44],"(",["T_CONSTANT_ENCAPSED_STRING","'sender\/name'",44],")",";",["T_WHITESPACE","\n        ",44],["T_IF","if",45],["T_WHITESPACE"," ",45],"(","!",["T_EMPTY","empty",45],"(",["T_VARIABLE","$name",45],")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n            ",45],["T_RETURN","return",46],["T_WHITESPACE"," ",46],["T_STRING","trim",46],"(",["T_VARIABLE","$name",46],")",";",["T_WHITESPACE","\n        ",46],"}",["T_WHITESPACE","\n\n        ",47],["T_COMMENT","\/* @var $session Mage_Customer_Model_Session *\/",49],["T_WHITESPACE","\n        ",49],["T_VARIABLE","$session",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","Mage",50],["T_DOUBLE_COLON","::",50],["T_STRING","getSingleton",50],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$session",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","isLoggedIn",52],"(",")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$session",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getCustomer",53],"(",")",["T_OBJECT_OPERATOR","->",53],["T_STRING","getName",53],"(",")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","''",56],";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Retrieve sender email address\n     *\n     * @return string\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","getEmail",64],"(",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$email",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getFormData",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getData",66],"(",["T_CONSTANT_ENCAPSED_STRING","'sender\/email'",66],")",";",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_EMPTY","empty",67],"(",["T_VARIABLE","$email",67],")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_STRING","trim",68],"(",["T_VARIABLE","$email",68],")",";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n\n        ",69],["T_COMMENT","\/* @var $session Mage_Customer_Model_Session *\/",71],["T_WHITESPACE","\n        ",71],["T_VARIABLE","$session",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","getSingleton",72],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",72],")",";",["T_WHITESPACE","\n\n        ",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$session",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","isLoggedIn",74],"(",")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$session",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getCustomer",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","getEmail",75],"(",")",";",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n\n        ",76],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","''",78],";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Retrieve Message text\n     *\n     * @return string\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","getMessage",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getFormData",88],"(",")",["T_OBJECT_OPERATOR","->",88],["T_STRING","getData",88],"(",["T_CONSTANT_ENCAPSED_STRING","'sender\/message'",88],")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Retrieve Form data or empty Varien_Object\n     *\n     * @return Varien_Object\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","getFormData",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$data",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getData",98],"(",["T_CONSTANT_ENCAPSED_STRING","'form_data'",98],")",";",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_VARIABLE","$data",99],["T_WHITESPACE"," ",99],["T_INSTANCEOF","instanceof",99],["T_WHITESPACE"," ",99],["T_STRING","Varien_Object",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$data",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_NEW","new",100],["T_WHITESPACE"," ",100],["T_STRING","Varien_Object",100],"(",")",";",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setData",101],"(",["T_CONSTANT_ENCAPSED_STRING","'form_data'",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$data",101],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$data",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Set Form data array\n     *\n     * @param array $data\n     * @return Mage_Sendfriend_Block_Send\n     *\/",107],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","setFormData",113],"(",["T_VARIABLE","$data",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_STRING","is_array",115],"(",["T_VARIABLE","$data",115],")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","setData",116],"(",["T_CONSTANT_ENCAPSED_STRING","'form_data'",116],",",["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_STRING","Varien_Object",116],"(",["T_VARIABLE","$data",116],")",")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n\n        ",117],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_DOC_COMMENT","\/**\n     * Retrieve Current Product Id\n     *\n     * @return int\n     *\/",122],["T_WHITESPACE","\n    ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","getProductId",127],"(",")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getRequest",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","getParam",129],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",129],",",["T_WHITESPACE"," ",129],["T_STRING","null",129],")",";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Retrieve current category id for product\n     *\n     * @return int\n     *\/",132],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","getCategoryId",137],"(",")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getRequest",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getParam",139],"(",["T_CONSTANT_ENCAPSED_STRING","'cat_id'",139],",",["T_WHITESPACE"," ",139],["T_STRING","null",139],")",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Retrieve Max Recipients\n     *\n     * @return int\n     *\/",142],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","getMaxRecipients",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","Mage",149],["T_DOUBLE_COLON","::",149],["T_STRING","helper",149],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",149],")",["T_OBJECT_OPERATOR","->",149],["T_STRING","getMaxRecipients",149],"(",")",";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Retrieve Send URL for Form Action\n     *\n     * @return string\n     *\/",152],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","getSendUrl",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_STRING","Mage",159],["T_DOUBLE_COLON","::",159],["T_STRING","getUrl",159],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/sendmail'",159],",",["T_WHITESPACE"," ",159],["T_ARRAY","array",159],"(",["T_WHITESPACE","\n            ",159],["T_CONSTANT_ENCAPSED_STRING","'id'",160],["T_WHITESPACE","     ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getProductId",160],"(",")",",",["T_WHITESPACE","\n            ",160],["T_CONSTANT_ENCAPSED_STRING","'cat_id'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getCategoryId",161],"(",")",",",["T_WHITESPACE","\n            ",161],["T_CONSTANT_ENCAPSED_STRING","'_secure'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_isSecure",162],"(",")",["T_WHITESPACE","\n        ",162],")",")",";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Return send friend model\n     *\n     * @return Mage_Sendfriend_Model_Sendfriend\n     *\/",166],["T_WHITESPACE","\n    ",170],["T_PROTECTED","protected",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","_getSendfriendModel",171],"(",")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","registry",173],"(",["T_CONSTANT_ENCAPSED_STRING","'send_to_friend_model'",173],")",";",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Check if user is allowed to send\n     *\n     * @return boolean\n     *\/",176],["T_WHITESPACE","\n    ",180],["T_PUBLIC","public",181],["T_WHITESPACE"," ",181],["T_FUNCTION","function",181],["T_WHITESPACE"," ",181],["T_STRING","canSend",181],"(",")",["T_WHITESPACE","\n    ",181],"{",["T_WHITESPACE","\n        ",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],"!",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_getSendfriendModel",183],"(",")",["T_OBJECT_OPERATOR","->",183],["T_STRING","isExceedLimit",183],"(",")",";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n",184],"}",["T_WHITESPACE","\n",185]]