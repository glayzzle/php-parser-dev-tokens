[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Bundle\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Bundle Selection Resource Model\n *\n * @category    Mage\n * @package     Mage_Bundle\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Bundle_Model_Resource_Selection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Define main table and id field\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_init",43],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/selection'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'selection_id'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Retrieve Price From index\n     *\n     * @param int $productId\n     * @param float $qty\n     * @param int $storeId\n     * @param int $groupId\n     * @return mixed\n     *\/",46],["T_WHITESPACE","\n    ",54],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","getPriceFromIndex",55],"(",["T_VARIABLE","$productId",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$qty",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$storeId",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$groupId",55],")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$adapter",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_getReadAdapter",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$select",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_CLONE","clone",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$adapter",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","select",58],"(",")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$select",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","reset",59],"(",")",";",["T_WHITESPACE","\n\n        ",59],["T_VARIABLE","$attrPriceId",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","Mage",61],["T_DOUBLE_COLON","::",61],["T_STRING","getSingleton",61],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",61],")",["T_WHITESPACE","\n            ",61],["T_OBJECT_OPERATOR","->",62],["T_STRING","getIdByCode",62],"(",["T_STRING","Mage_Catalog_Model_Product",62],["T_DOUBLE_COLON","::",62],["T_STRING","ENTITY",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'price'",62],")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$attrTierPriceId",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","Mage",63],["T_DOUBLE_COLON","::",63],["T_STRING","getSingleton",63],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",63],")",["T_WHITESPACE","\n            ",63],["T_OBJECT_OPERATOR","->",64],["T_STRING","getIdByCode",64],"(",["T_STRING","Mage_Catalog_Model_Product",64],["T_DOUBLE_COLON","::",64],["T_STRING","ENTITY",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'tier_price'",64],")",";",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$websiteId",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Mage",66],["T_DOUBLE_COLON","::",66],["T_STRING","app",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getStore",66],"(",["T_VARIABLE","$storeId",66],")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getWebsiteId",66],"(",")",";",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$select",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","from",68],"(",["T_ARRAY","array",68],"(",["T_CONSTANT_ENCAPSED_STRING","\"price_index\"",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getTable",68],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/price'",68],")",")",",",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'SUM(value)'",68],")",")",["T_WHITESPACE","\n            ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","where",69],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = :product_id'",69],")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","where",70],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id = :website_id'",70],")",["T_WHITESPACE","\n            ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","where",71],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id = :customer_group'",71],")",["T_WHITESPACE","\n            ",71],["T_OBJECT_OPERATOR","->",72],["T_STRING","where",72],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_id = :price_attribute OR attribute_id = :tier_price_attribute'",72],")",["T_WHITESPACE","\n            ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","where",73],"(",["T_CONSTANT_ENCAPSED_STRING","'qty <= :qty'",73],")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","group",74],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",74],")",";",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$bind",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_ARRAY","array",76],"(",["T_WHITESPACE","\n            ",76],["T_CONSTANT_ENCAPSED_STRING","'product_id'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$productId",77],",",["T_WHITESPACE","\n            ",77],["T_CONSTANT_ENCAPSED_STRING","'website_id'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$websiteId",78],",",["T_WHITESPACE","\n            ",78],["T_CONSTANT_ENCAPSED_STRING","'customer_group'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$groupId",79],",",["T_WHITESPACE","\n            ",79],["T_CONSTANT_ENCAPSED_STRING","'price_attribute'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$attrPriceId",80],",",["T_WHITESPACE","\n            ",80],["T_CONSTANT_ENCAPSED_STRING","'tier_price_attribute'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$attrTierPriceId",81],",",["T_WHITESPACE","\n            ",81],["T_CONSTANT_ENCAPSED_STRING","'qty'",82],["T_WHITESPACE","   ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$qty",82],["T_WHITESPACE","\n        ",82],")",";",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$price",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$adapter",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","fetchCol",85],"(",["T_VARIABLE","$select",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$bind",85],")",";",["T_WHITESPACE","\n        ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(","!",["T_EMPTY","empty",86],"(",["T_VARIABLE","$price",86],")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","array_shift",87],"(",["T_VARIABLE","$price",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE"," ",88],["T_ELSE","else",88],["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_LNUMBER","0",89],";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Retrieve Required children ids\n     * Return grouped array, ex array(\n     *   group => array(ids)\n     * )\n     *\n     * @param int $parentId\n     * @param bool $required\n     * @return array\n     *\/",93],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","getChildrenIds",103],"(",["T_VARIABLE","$parentId",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$required",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","true",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$childrenIds",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$notRequired",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_ARRAY","array",106],"(",")",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$adapter",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_getReadAdapter",107],"(",")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$select",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$adapter",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","select",108],"(",")",["T_WHITESPACE","\n            ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","from",109],"(",["T_WHITESPACE","\n                ",109],["T_ARRAY","array",110],"(",["T_CONSTANT_ENCAPSED_STRING","'tbl_selection'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getMainTable",110],"(",")",")",",",["T_WHITESPACE","\n                ",110],["T_ARRAY","array",111],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'parent_product_id'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'option_id'",111],")",["T_WHITESPACE","\n            ",111],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","join",113],"(",["T_WHITESPACE","\n                ",113],["T_ARRAY","array",114],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getTable",114],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",114],")",")",",",["T_WHITESPACE","\n                ",114],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = tbl_selection.product_id AND e.required_options=0'",115],",",["T_WHITESPACE","\n                ",115],["T_ARRAY","array",116],"(",")",["T_WHITESPACE","\n            ",116],")",["T_WHITESPACE","\n            ",117],["T_OBJECT_OPERATOR","->",118],["T_STRING","join",118],"(",["T_WHITESPACE","\n                ",118],["T_ARRAY","array",119],"(",["T_CONSTANT_ENCAPSED_STRING","'tbl_option'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getTable",119],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/option'",119],")",")",",",["T_WHITESPACE","\n                ",119],["T_CONSTANT_ENCAPSED_STRING","'tbl_option.option_id = tbl_selection.option_id'",120],",",["T_WHITESPACE","\n                ",120],["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","'required'",121],")",["T_WHITESPACE","\n            ",121],")",["T_WHITESPACE","\n            ",122],["T_OBJECT_OPERATOR","->",123],["T_STRING","where",123],"(",["T_CONSTANT_ENCAPSED_STRING","'tbl_selection.parent_product_id = :parent_id'",123],")",";",["T_WHITESPACE","\n        ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$adapter",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","fetchAll",124],"(",["T_VARIABLE","$select",124],",",["T_WHITESPACE"," ",124],["T_ARRAY","array",124],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$parentId",124],")",")",["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$row",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$row",125],"[",["T_CONSTANT_ENCAPSED_STRING","'required'",125],"]",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$childrenIds",126],"[",["T_VARIABLE","$row",126],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",126],"]","]","[",["T_VARIABLE","$row",126],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",126],"]","]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$row",126],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",126],"]",";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE"," ",127],["T_ELSE","else",127],["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$notRequired",128],"[",["T_VARIABLE","$row",128],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",128],"]","]","[",["T_VARIABLE","$row",128],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",128],"]","]",["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$row",128],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",128],"]",";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(","!",["T_VARIABLE","$required",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$childrenIds",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","array_merge",133],"(",["T_VARIABLE","$childrenIds",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$notRequired",133],")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_ELSE","else",134],["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_VARIABLE","$childrenIds",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_FOREACH","foreach",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$notRequired",136],["T_WHITESPACE"," ",136],["T_AS","as",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$groupedChildrenIds",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                    ",136],["T_FOREACH","foreach",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$groupedChildrenIds",137],["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$childId",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                        ",137],["T_VARIABLE","$childrenIds",138],"[",["T_LNUMBER","0",138],"]","[",["T_VARIABLE","$childId",138],"]",["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$childId",138],";",["T_WHITESPACE","\n                    ",138],"}",["T_WHITESPACE","\n                ",139],"}",["T_WHITESPACE","\n            ",140],"}",["T_WHITESPACE","\n            ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(","!",["T_VARIABLE","$childrenIds",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$childrenIds",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_ARRAY","array",143],"(",["T_ARRAY","array",143],"(",")",")",";",["T_WHITESPACE","\n            ",143],"}",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$childrenIds",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Retrieve array of related bundle product ids by selection product id(s)\n     *\n     * @param int|array $childId\n     * @return array\n     *\/",150],["T_WHITESPACE","\n    ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","getParentIdsByChild",156],"(",["T_VARIABLE","$childId",156],")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$adapter",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_getReadAdapter",158],"(",")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$select",159],["T_WHITESPACE","  ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$adapter",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","select",159],"(",")",["T_WHITESPACE","\n            ",159],["T_OBJECT_OPERATOR","->",160],["T_STRING","distinct",160],"(",["T_STRING","true",160],")",["T_WHITESPACE","\n            ",160],["T_OBJECT_OPERATOR","->",161],["T_STRING","from",161],"(",["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getMainTable",161],"(",")",",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'parent_product_id'",161],")",["T_WHITESPACE","\n            ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","where",162],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN(?)'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$childId",162],")",";",["T_WHITESPACE","\n\n        ",162],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$adapter",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","fetchCol",164],"(",["T_VARIABLE","$select",164],")",";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_DOC_COMMENT","\/**\n     * Save bundle item price per website\n     *\n     * @param Mage_Bundle_Model_Selection $item\n     *\/",167],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","saveSelectionPrice",172],"(",["T_VARIABLE","$item",172],")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$write",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_getWriteAdapter",174],"(",")",";",["T_WHITESPACE","\n        ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$item",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getDefaultPriceScope",175],"(",")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$write",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","delete",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getTable",176],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/selection_price'",176],")",",",["T_WHITESPACE","\n                ",176],["T_ARRAY","array",177],"(",["T_WHITESPACE","\n                    ",177],["T_CONSTANT_ENCAPSED_STRING","'selection_id = ?'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$item",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getSelectionId",178],"(",")",",",["T_WHITESPACE","\n                    ",178],["T_CONSTANT_ENCAPSED_STRING","'website_id = ?'",179],["T_WHITESPACE","   ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$item",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getWebsiteId",179],"(",")",["T_WHITESPACE","\n                ",179],")",["T_WHITESPACE","\n            ",180],")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE"," ",182],["T_ELSE","else",182],["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n             ",182],["T_VARIABLE","$values",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_ARRAY","array",183],"(",["T_WHITESPACE","\n                ",183],["T_CONSTANT_ENCAPSED_STRING","'selection_id'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$item",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getSelectionId",184],"(",")",",",["T_WHITESPACE","\n                ",184],["T_CONSTANT_ENCAPSED_STRING","'website_id'",185],["T_WHITESPACE","   ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$item",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getWebsiteId",185],"(",")",",",["T_WHITESPACE","\n                ",185],["T_CONSTANT_ENCAPSED_STRING","'selection_price_type'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$item",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getSelectionPriceType",186],"(",")",",",["T_WHITESPACE","\n                ",186],["T_CONSTANT_ENCAPSED_STRING","'selection_price_value'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$item",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getSelectionPriceValue",187],"(",")",["T_WHITESPACE","\n            ",187],")",";",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$write",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","insertOnDuplicate",189],"(",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getTable",190],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/selection_price'",190],")",",",["T_WHITESPACE","\n                ",190],["T_VARIABLE","$values",191],",",["T_WHITESPACE","\n                ",191],["T_ARRAY","array",192],"(",["T_CONSTANT_ENCAPSED_STRING","'selection_price_type'",192],",",["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'selection_price_value'",192],")",["T_WHITESPACE","\n            ",192],")",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n",195],"}",["T_WHITESPACE","\n",196]]