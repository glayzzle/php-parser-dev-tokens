[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Bundle\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Bundle Product Price Index\n *\n * @method Mage_Bundle_Model_Resource_Price_Index _getResource()\n * @method Mage_Bundle_Model_Resource_Price_Index getResource()\n * @method Mage_Bundle_Model_Price_Index setEntityId(int $value)\n * @method int getWebsiteId()\n * @method Mage_Bundle_Model_Price_Index setWebsiteId(int $value)\n * @method int getCustomerGroupId()\n * @method Mage_Bundle_Model_Price_Index setCustomerGroupId(int $value)\n * @method float getMinPrice()\n * @method Mage_Bundle_Model_Price_Index setMinPrice(float $value)\n * @method float getMaxPrice()\n * @method Mage_Bundle_Model_Price_Index setMaxPrice(float $value)\n *\n * @category    Mage\n * @package     Mage_Bundle\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",46],["T_CLASS","class",47],["T_WHITESPACE"," ",47],["T_STRING","Mage_Bundle_Model_Price_Index",47],["T_WHITESPACE"," ",47],["T_EXTENDS","extends",47],["T_WHITESPACE"," ",47],["T_STRING","Mage_Core_Model_Abstract",47],["T_WHITESPACE","\n",47],"{",["T_WHITESPACE","\n    ",48],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\n     *\/",49],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","_construct",53],"(",")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_init",55],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/price_index'",55],")",";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Retrieve resource instance wrapper\n     *\n     * @return Mage_Bundle_Model_Mysql4_Price_Index\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","_getResource",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_STRING","parent",65],["T_DOUBLE_COLON","::",65],["T_STRING","_getResource",65],"(",")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Reindex Product price\n     *\n     * @param int $productId\n     * @param int $priceType\n     * @return Mage_Bundle_Model_Price_Index\n     *\/",68],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","_reindexProduct",75],"(",["T_VARIABLE","$productId",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$priceType",75],")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_getResource",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","reindexProduct",77],"(",["T_VARIABLE","$productId",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$priceType",77],")",";",["T_WHITESPACE","\n        ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Reindex Bundle product Price Index\n     *\n     * @param Mage_Core_Model_Product|Mage_Catalog_Model_Product_Condition_Interface|array|int $products\n     * @return Mage_Bundle_Model_Price_Index\n     *\/",81],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","reindex",87],"(",["T_VARIABLE","$products",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","null",87],")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_getResource",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","reindex",89],"(",["T_VARIABLE","$products",89],")",";",["T_WHITESPACE","\n        ",89],["T_RETURN","return",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Add bundle price range index to Product collection\n     *\n     * @param Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection $collection\n     * @return Mage_Bundle_Model_Price_Index\n     *\/",93],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","addPriceIndexToCollection",99],"(",["T_VARIABLE","$collection",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$productObjects",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_ARRAY","array",101],"(",")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$productIds",102],["T_WHITESPACE","     ",102],"=",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_FOREACH","foreach",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$collection",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getItems",103],"(",")",["T_WHITESPACE"," ",103],["T_AS","as",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$product",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_COMMENT","\/* @var $product Mage_Catalog_Model_Product *\/",104],["T_WHITESPACE","\n            ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$product",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getTypeId",105],"(",")",["T_WHITESPACE"," ",105],["T_IS_EQUAL","==",105],["T_WHITESPACE"," ",105],["T_STRING","Mage_Catalog_Model_Product_Type",105],["T_DOUBLE_COLON","::",105],["T_STRING","TYPE_BUNDLE",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                ",105],["T_VARIABLE","$productIds",106],"[","]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$product",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getEntityId",106],"(",")",";",["T_WHITESPACE","\n                ",106],["T_VARIABLE","$productObjects",107],"[",["T_VARIABLE","$product",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getEntityId",107],"(",")","]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$product",107],";",["T_WHITESPACE","\n            ",107],"}",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$websiteId",110],["T_WHITESPACE","  ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","Mage",110],["T_DOUBLE_COLON","::",110],["T_STRING","app",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","getStore",110],"(",["T_VARIABLE","$collection",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getStoreId",110],"(",")",")",["T_WHITESPACE","\n            ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","getWebsiteId",111],"(",")",";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$groupId",112],["T_WHITESPACE","    ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","Mage",112],["T_DOUBLE_COLON","::",112],["T_STRING","getSingleton",112],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",112],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","getCustomerGroupId",113],"(",")",";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$addOptionsToResult",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","false",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$prices",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_getResource",116],"(",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","loadPriceIndex",116],"(",["T_VARIABLE","$productIds",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$websiteId",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$groupId",116],")",";",["T_WHITESPACE","\n        ",116],["T_FOREACH","foreach",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$productIds",117],["T_WHITESPACE"," ",117],["T_AS","as",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$productId",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_ISSET","isset",118],"(",["T_VARIABLE","$prices",118],"[",["T_VARIABLE","$productId",118],"]",")",")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$productObjects",119],"[",["T_VARIABLE","$productId",119],"]",["T_WHITESPACE","\n                    ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","setData",120],"(",["T_CONSTANT_ENCAPSED_STRING","'_price_index'",120],",",["T_WHITESPACE"," ",120],["T_STRING","true",120],")",["T_WHITESPACE","\n                    ",120],["T_OBJECT_OPERATOR","->",121],["T_STRING","setData",121],"(",["T_CONSTANT_ENCAPSED_STRING","'_price_index_min_price'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$prices",121],"[",["T_VARIABLE","$productId",121],"]","[",["T_CONSTANT_ENCAPSED_STRING","'min_price'",121],"]",")",["T_WHITESPACE","\n                    ",121],["T_OBJECT_OPERATOR","->",122],["T_STRING","setData",122],"(",["T_CONSTANT_ENCAPSED_STRING","'_price_index_max_price'",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$prices",122],"[",["T_VARIABLE","$productId",122],"]","[",["T_CONSTANT_ENCAPSED_STRING","'max_price'",122],"]",")",";",["T_WHITESPACE","\n            ",122],"}",["T_WHITESPACE","\n            ",123],["T_ELSE","else",124],["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$addOptionsToResult",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","true",125],";",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$addOptionsToResult",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$collection",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","addOptionsToResult",130],"(",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n\n        ",131],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Add price index to bundle product after load\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_Bundle_Model_Price_Index\n     *\/",136],["T_WHITESPACE","\n    ",141],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","addPriceIndexToProduct",142],"(",["T_VARIABLE","$product",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$websiteId",144],["T_WHITESPACE","  ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$product",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getStore",144],"(",")",["T_OBJECT_OPERATOR","->",144],["T_STRING","getWebsiteId",144],"(",")",";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$groupId",145],["T_WHITESPACE","    ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","Mage",145],["T_DOUBLE_COLON","::",145],["T_STRING","getSingleton",145],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",145],")",["T_WHITESPACE","\n            ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","getCustomerGroupId",146],"(",")",";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$prices",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_getResource",147],"(",")",["T_WHITESPACE","\n            ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","loadPriceIndex",148],"(",["T_VARIABLE","$product",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getId",148],"(",")",",",["T_WHITESPACE"," ",148],["T_VARIABLE","$websiteId",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$groupId",148],")",";",["T_WHITESPACE","\n        ",148],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_ISSET","isset",149],"(",["T_VARIABLE","$prices",149],"[",["T_VARIABLE","$product",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getId",149],"(",")","]",")",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$product",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","setData",150],"(",["T_CONSTANT_ENCAPSED_STRING","'_price_index'",150],",",["T_WHITESPACE"," ",150],["T_STRING","true",150],")",["T_WHITESPACE","\n                ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","setData",151],"(",["T_CONSTANT_ENCAPSED_STRING","'_price_index_min_price'",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$prices",151],"[",["T_VARIABLE","$product",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getId",151],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'min_price'",151],"]",")",["T_WHITESPACE","\n                ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","setData",152],"(",["T_CONSTANT_ENCAPSED_STRING","'_price_index_max_price'",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$prices",152],"[",["T_VARIABLE","$product",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getId",152],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'max_price'",152],"]",")",";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n        ",153],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n",155],"}",["T_WHITESPACE","\n",156]]