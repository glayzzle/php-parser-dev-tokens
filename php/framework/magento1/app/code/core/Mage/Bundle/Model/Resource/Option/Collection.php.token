[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Bundle\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Bundle Options Resource Collection\n *\n * @category    Mage\n * @package     Mage_Bundle\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Bundle_Model_Resource_Option_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Collection_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * All item ids cache\n     *\n     * @var array\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_itemIds",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * True when selections a\n     *\n     * @var bool\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_selectionsAppended",49],["T_WHITESPACE","   ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","false",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Init model and resource model\n     *\n     *\/",51],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","_construct",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_init",57],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/option'",57],")",";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Joins values to options\n     *\n     * @param int $storeId\n     * @return Mage_Bundle_Model_Resource_Option_Collection\n     *\/",60],["T_WHITESPACE","\n    ",65],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","joinValues",66],"(",["T_VARIABLE","$storeId",66],")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getSelect",68],"(",")",["T_WHITESPACE","\n            ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","joinLeft",69],"(",["T_WHITESPACE","\n                ",69],["T_ARRAY","array",70],"(",["T_CONSTANT_ENCAPSED_STRING","'option_value_default'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getTable",70],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/option_value'",70],")",")",",",["T_WHITESPACE","\n                ",70],["T_CONSTANT_ENCAPSED_STRING","'main_table.option_id = option_value_default.option_id and option_value_default.store_id = 0'",71],",",["T_WHITESPACE","\n                ",71],["T_ARRAY","array",72],"(",")",["T_WHITESPACE","\n            ",72],")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","columns",74],"(",["T_ARRAY","array",74],"(",["T_CONSTANT_ENCAPSED_STRING","'default_title'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'option_value_default.title'",74],")",")",";",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$title",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getConnection",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","getCheckSql",76],"(",["T_WHITESPACE","\n            ",76],["T_CONSTANT_ENCAPSED_STRING","'option_value.title IS NOT NULL'",77],",",["T_WHITESPACE","\n            ",77],["T_CONSTANT_ENCAPSED_STRING","'option_value.title'",78],",",["T_WHITESPACE","\n            ",78],["T_CONSTANT_ENCAPSED_STRING","'option_value_default.title'",79],["T_WHITESPACE","\n        ",79],")",";",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$storeId",81],["T_WHITESPACE"," ",81],["T_IS_NOT_IDENTICAL","!==",81],["T_WHITESPACE"," ",81],["T_STRING","null",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getSelect",82],"(",")",["T_WHITESPACE","\n                ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","columns",83],"(",["T_ARRAY","array",83],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$title",83],")",")",["T_WHITESPACE","\n                ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","joinLeft",84],"(",["T_ARRAY","array",84],"(",["T_CONSTANT_ENCAPSED_STRING","'option_value'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getTable",84],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle\/option_value'",84],")",")",",",["T_WHITESPACE","\n                    ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getConnection",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","quoteInto",85],"(",["T_WHITESPACE","\n                        ",85],["T_CONSTANT_ENCAPSED_STRING","'main_table.option_id = option_value.option_id and option_value.store_id = ?'",86],",",["T_WHITESPACE","\n                        ",86],["T_VARIABLE","$storeId",87],["T_WHITESPACE","\n                    ",87],")",",",["T_WHITESPACE","\n                    ",88],["T_ARRAY","array",89],"(",")",["T_WHITESPACE","\n                ",89],")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n        ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Sets product id filter\n     *\n     * @param int $productId\n     * @return Mage_Bundle_Model_Resource_Option_Collection\n     *\/",95],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","setProductIdFilter",101],"(",["T_VARIABLE","$productId",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","addFieldToFilter",103],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.parent_id'",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$productId",103],")",";",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Sets order by position\n     *\n     * @return Mage_Bundle_Model_Resource_Option_Collection\n     *\/",107],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","setPositionOrder",112],"(",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getSelect",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","order",114],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.position asc'",114],")",["T_WHITESPACE","\n            ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","order",115],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.option_id asc'",115],")",";",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Append selection to options\n     * stripBefore - indicates to reload\n     * appendAll - indicates do we need to filter by saleable and required custom options\n     *\n     * @param Mage_Bundle_Model_Resource_Selection_Collection $selectionsCollection\n     * @param bool $stripBefore\n     * @param bool $appendAll\n     * @return array\n     *\/",119],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","appendSelections",129],"(",["T_VARIABLE","$selectionsCollection",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$stripBefore",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","false",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$appendAll",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","true",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$stripBefore",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_stripSelections",132],"(",")",";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n\n        ",133],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_selectionsAppended",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_FOREACH","foreach",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$selectionsCollection",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getItems",136],"(",")",["T_WHITESPACE"," ",136],["T_AS","as",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$key",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$_selection",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$_option",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getItemById",137],"(",["T_VARIABLE","$_selection",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getOptionId",137],"(",")",")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                    ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$appendAll",138],["T_WHITESPACE"," ",138],["T_BOOLEAN_OR","||",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$_selection",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","isSalable",138],"(",")",["T_WHITESPACE"," ",138],["T_BOOLEAN_AND","&&",138],["T_WHITESPACE"," ",138],"!",["T_VARIABLE","$_selection",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getRequiredOptions",138],"(",")",")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                        ",138],["T_VARIABLE","$_selection",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","setOption",139],"(",["T_VARIABLE","$_option",139],")",";",["T_WHITESPACE","\n                        ",139],["T_VARIABLE","$_option",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","addSelection",140],"(",["T_VARIABLE","$_selection",140],")",";",["T_WHITESPACE","\n                    ",140],"}",["T_WHITESPACE"," ",141],["T_ELSE","else",141],["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                        ",141],["T_VARIABLE","$selectionsCollection",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","removeItemByKey",142],"(",["T_VARIABLE","$key",142],")",";",["T_WHITESPACE","\n                    ",142],"}",["T_WHITESPACE","\n                ",143],"}",["T_WHITESPACE","\n            ",144],"}",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_selectionsAppended",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","true",146],";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n\n        ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getItems",149],"(",")",";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Removes appended selections before\n     *\n     * @return Mage_Bundle_Model_Resource_Option_Collection\n     *\/",152],["T_WHITESPACE","\n    ",156],["T_PROTECTED","protected",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","_stripSelections",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_FOREACH","foreach",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getItems",159],"(",")",["T_WHITESPACE"," ",159],["T_AS","as",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$option",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$option",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","setSelections",160],"(",["T_ARRAY","array",160],"(",")",")",";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_selectionsAppended",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","false",162],";",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Sets filter by option id\n     *\n     * @param array|int $ids\n     * @return Mage_Bundle_Model_Resource_Option_Collection\n     *\/",166],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","setIdFilter",172],"(",["T_VARIABLE","$ids",172],")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_STRING","is_array",174],"(",["T_VARIABLE","$ids",174],")",")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","addFieldToFilter",175],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.option_id'",175],",",["T_WHITESPACE"," ",175],["T_ARRAY","array",175],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$ids",175],")",")",";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE"," ",176],["T_ELSE","else",176],["T_WHITESPACE"," ",176],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$ids",176],["T_WHITESPACE"," ",176],["T_IS_NOT_EQUAL","!=",176],["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","''",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","addFieldToFilter",177],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.option_id'",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$ids",177],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Reset all item ids cache\n     *\n     * @return Mage_Bundle_Model_Resource_Option_Collection\n     *\/",182],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","resetAllIds",187],"(",")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_itemIds",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","null",189],";",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Retrive all ids for collection\n     *\n     * @return array\n     *\/",193],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","getAllIds",198],"(",")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_STRING","is_null",200],"(",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_itemIds",200],")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_itemIds",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","parent",201],["T_DOUBLE_COLON","::",201],["T_STRING","getAllIds",201],"(",")",";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_itemIds",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n",204],"}",["T_WHITESPACE","\n\n",205]]