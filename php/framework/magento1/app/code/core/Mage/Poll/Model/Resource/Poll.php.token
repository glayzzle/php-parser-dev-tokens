[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Poll\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Poll Mysql4 resource model\n *\n * @category    Mage\n * @package     Mage_Poll\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Poll_Model_Resource_Poll",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Initialize resource\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_init",43],"(",["T_CONSTANT_ENCAPSED_STRING","'poll\/poll'",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'poll_id'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Initialize unique fields\n     *\n     * @return Mage_Poll_Model_Resource_Poll\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","_initUniqueFields",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_uniqueFields",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_ARRAY","array",53],"(",["T_ARRAY","array",53],"(",["T_WHITESPACE","\n            ",53],["T_CONSTANT_ENCAPSED_STRING","'field'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'poll_title'",54],",",["T_WHITESPACE","\n            ",54],["T_CONSTANT_ENCAPSED_STRING","'title'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_STRING","Mage",55],["T_DOUBLE_COLON","::",55],["T_STRING","helper",55],"(",["T_CONSTANT_ENCAPSED_STRING","'poll'",55],")",["T_OBJECT_OPERATOR","->",55],["T_STRING","__",55],"(",["T_CONSTANT_ENCAPSED_STRING","'Poll with the same question'",55],")",["T_WHITESPACE","\n        ",55],")",")",";",["T_WHITESPACE","\n        ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Get select object for not closed poll ids\n     *\n     * @param Mage_Poll_Model_Poll $object\n     * @return\n     *\/",60],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","_getSelectIds",66],"(",["T_VARIABLE","$object",66],")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$read",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_getReadAdapter",68],"(",")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$select",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$read",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","select",69],"(",")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","from",70],"(",["T_ARRAY","array",70],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",70],["T_DOUBLE_ARROW","=>",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getMainTable",70],"(",")",")",",",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getIdFieldName",70],"(",")",")",["T_WHITESPACE","\n            ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","where",71],"(",["T_CONSTANT_ENCAPSED_STRING","'closed = ?'",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","0",71],")",";",["T_WHITESPACE","\n\n        ",71],["T_VARIABLE","$excludeIds",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$object",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getExcludeFilter",73],"(",")",";",["T_WHITESPACE","\n        ",73],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$excludeIds",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$select",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","where",75],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.poll_id NOT IN(?)'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$excludeIds",75],")",";",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n\n        ",76],["T_VARIABLE","$storeId",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$object",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getStoreFilter",78],"(",")",";",["T_WHITESPACE","\n        ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$storeId",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$select",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","join",80],"(",["T_WHITESPACE","\n                ",80],["T_ARRAY","array",81],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getTable",81],"(",["T_CONSTANT_ENCAPSED_STRING","'poll\/poll_store'",81],")",")",",",["T_WHITESPACE","\n                ",81],["T_CONSTANT_ENCAPSED_STRING","'main_table.poll_id=store.poll_id AND store.store_id = '",82],["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_VARIABLE","$read",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","quote",82],"(",["T_VARIABLE","$storeId",82],")",",",["T_WHITESPACE","\n                ",82],["T_ARRAY","array",83],"(",")",["T_WHITESPACE","\n            ",83],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n\n        ",85],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$select",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Get random identifier not closed poll\n     *\n     * @param Mage_Poll_Model_Poll $object\n     * @return int\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","getRandomId",96],"(",["T_VARIABLE","$object",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$select",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_getSelectIds",98],"(",["T_VARIABLE","$object",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","orderRand",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","limit",98],"(",["T_LNUMBER","1",98],")",";",["T_WHITESPACE","\n        ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_getReadAdapter",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","fetchOne",99],"(",["T_VARIABLE","$select",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Get all ids for not closed polls\n     *\n     * @param Mage_Poll_Model_Poll $object\n     * @return array\n     *\/",102],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","getAllIds",108],"(",["T_VARIABLE","$object",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$select",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_getSelectIds",110],"(",["T_VARIABLE","$object",110],")",";",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_getReadAdapter",111],"(",")",["T_OBJECT_OPERATOR","->",111],["T_STRING","fetchCol",111],"(",["T_VARIABLE","$select",111],")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Check answer id existing for poll\n     *\n     * @param Mage_Poll_Model_Poll $poll\n     * @param int $answerId\n     * @return bool\n     *\/",114],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","checkAnswerId",121],"(",["T_VARIABLE","$poll",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$answerId",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$select",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_getReadAdapter",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","select",123],"(",")",["T_WHITESPACE","\n            ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","from",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getTable",124],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_answer'",124],")",",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'answer_id'",124],")",["T_WHITESPACE","\n            ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","where",125],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_id = :poll_id'",125],")",["T_WHITESPACE","\n            ",125],["T_OBJECT_OPERATOR","->",126],["T_STRING","where",126],"(",["T_CONSTANT_ENCAPSED_STRING","'answer_id = :answer_id'",126],")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$bind",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","':poll_id'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$poll",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getId",127],"(",")",",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","':answer_id'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$answerId",127],")",";",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_getReadAdapter",128],"(",")",["T_OBJECT_OPERATOR","->",128],["T_STRING","fetchOne",128],"(",["T_VARIABLE","$select",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$bind",128],")",";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Get voted poll ids by specified IP-address\n     * Will return non-empty only if appropriate option in config is enabled\n     * If poll id is not empty, it will look only for records with specified value\n     *\n     * @param string $ipAddress\n     * @param int $pollId\n     * @return array\n     *\/",131],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","getVotedPollIdsByIp",140],"(",["T_VARIABLE","$ipAddress",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$pollId",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","false",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_COMMENT","\/\/ check if validation by ip is enabled\n",142],["T_WHITESPACE","        ",143],["T_IF","if",143],["T_WHITESPACE"," ",143],"(","!",["T_STRING","Mage",143],["T_DOUBLE_COLON","::",143],["T_STRING","getModel",143],"(",["T_CONSTANT_ENCAPSED_STRING","'poll\/poll'",143],")",["T_OBJECT_OPERATOR","->",143],["T_STRING","isValidationByIp",143],"(",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_ARRAY","array",144],"(",")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_COMMENT","\/\/ look for ids in database\n",147],["T_WHITESPACE","        ",148],["T_VARIABLE","$select",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_getReadAdapter",148],"(",")",["T_OBJECT_OPERATOR","->",148],["T_STRING","select",148],"(",")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","distinct",149],"(",")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","from",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getTable",150],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_vote'",150],")",",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'poll_id'",150],")",["T_WHITESPACE","\n            ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","where",151],"(",["T_CONSTANT_ENCAPSED_STRING","'ip_address = ?'",151],",",["T_WHITESPACE"," ",151],["T_STRING","inet_pton",151],"(",["T_VARIABLE","$ipAddress",151],")",")",";",["T_WHITESPACE","\n        ",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(","!",["T_EMPTY","empty",152],"(",["T_VARIABLE","$pollId",152],")",")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$select",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","where",153],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_id = ?'",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$pollId",153],")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$result",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_getReadAdapter",155],"(",")",["T_OBJECT_OPERATOR","->",155],["T_STRING","fetchCol",155],"(",["T_VARIABLE","$select",155],")",";",["T_WHITESPACE","\n        ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_EMPTY","empty",156],"(",["T_VARIABLE","$result",156],")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$result",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_ARRAY","array",157],"(",")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$result",159],";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Resett votes count\n     *\n     * @param Mage_Poll_Model_Poll $object\n     * @return Mage_Poll_Model_Poll\n     *\/",162],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","resetVotesCount",168],"(",["T_VARIABLE","$object",168],")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$adapter",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_getWriteAdapter",170],"(",")",";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$select",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$adapter",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","select",171],"(",")",["T_WHITESPACE","\n            ",171],["T_OBJECT_OPERATOR","->",172],["T_STRING","from",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getTable",172],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_answer'",172],")",",",["T_WHITESPACE"," ",172],["T_NEW","new",172],["T_WHITESPACE"," ",172],["T_STRING","Zend_Db_Expr",172],"(",["T_CONSTANT_ENCAPSED_STRING","\"SUM(votes_count)\"",172],")",")",["T_WHITESPACE","\n            ",172],["T_OBJECT_OPERATOR","->",173],["T_STRING","where",173],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_id = ?'",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$object",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getPollId",173],"(",")",")",";",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$adapter",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","update",174],"(",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getMainTable",175],"(",")",",",["T_WHITESPACE","\n            ",175],["T_ARRAY","array",176],"(",["T_CONSTANT_ENCAPSED_STRING","'votes_count'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_NEW","new",176],["T_WHITESPACE"," ",176],["T_STRING","Zend_Db_Expr",176],"(","\"",["T_ENCAPSED_AND_WHITESPACE","(",176],["T_VARIABLE","$select",176],["T_ENCAPSED_AND_WHITESPACE",")",176],"\"",")",")",",",["T_WHITESPACE","\n            ",176],["T_ARRAY","array",177],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_id = '",177],["T_WHITESPACE"," ",177],".",["T_WHITESPACE"," ",177],["T_VARIABLE","$adapter",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","quote",177],"(",["T_VARIABLE","$object",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getPollId",177],"(",")",")",")",["T_WHITESPACE","\n        ",177],")",";",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$object",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Load store Ids array\n     *\n     * @param Mage_Poll_Model_Poll $object\n     *\/",182],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","loadStoreIds",187],"(",["T_STRING","Mage_Poll_Model_Poll",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$object",187],")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$pollId",189],["T_WHITESPACE","   ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$object",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getId",189],"(",")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$storeIds",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_ARRAY","array",190],"(",")",";",["T_WHITESPACE","\n        ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$pollId",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$storeIds",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","lookupStoreIds",192],"(",["T_VARIABLE","$pollId",192],")",";",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$object",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","setStoreIds",194],"(",["T_VARIABLE","$storeIds",194],")",";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Delete current poll from the table poll_store and then\n     * insert to update \"poll to store\" relations\n     *\n     * @param Mage_Core_Model_Abstract $object\n     *\/",197],["T_WHITESPACE","\n    ",202],["T_PUBLIC","public",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","_afterSave",203],"(",["T_STRING","Mage_Core_Model_Abstract",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$object",203],")",["T_WHITESPACE","\n    ",203],"{",["T_WHITESPACE","\n        ",204],["T_DOC_COMMENT","\/** stores *\/",205],["T_WHITESPACE","\n        ",205],["T_VARIABLE","$deleteWhere",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_getWriteAdapter",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","quoteInto",206],"(",["T_CONSTANT_ENCAPSED_STRING","'poll_id = ?'",206],",",["T_WHITESPACE"," ",206],["T_VARIABLE","$object",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getId",206],"(",")",")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_getWriteAdapter",207],"(",")",["T_OBJECT_OPERATOR","->",207],["T_STRING","delete",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getTable",207],"(",["T_CONSTANT_ENCAPSED_STRING","'poll\/poll_store'",207],")",",",["T_WHITESPACE"," ",207],["T_VARIABLE","$deleteWhere",207],")",";",["T_WHITESPACE","\n\n        ",207],["T_FOREACH","foreach",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$object",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getStoreIds",209],"(",")",["T_WHITESPACE"," ",209],["T_AS","as",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$storeId",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$pollStoreData",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_ARRAY","array",210],"(",["T_WHITESPACE","\n            ",210],["T_CONSTANT_ENCAPSED_STRING","'poll_id'",211],["T_WHITESPACE","   ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$object",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getId",211],"(",")",",",["T_WHITESPACE","\n            ",211],["T_CONSTANT_ENCAPSED_STRING","'store_id'",212],["T_WHITESPACE","  ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$storeId",212],["T_WHITESPACE","\n            ",212],")",";",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_getWriteAdapter",214],"(",")",["T_OBJECT_OPERATOR","->",214],["T_STRING","insert",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getTable",214],"(",["T_CONSTANT_ENCAPSED_STRING","'poll\/poll_store'",214],")",",",["T_WHITESPACE"," ",214],["T_VARIABLE","$pollStoreData",214],")",";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n\n        ",215],["T_DOC_COMMENT","\/** answers *\/",217],["T_WHITESPACE","\n        ",217],["T_FOREACH","foreach",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$object",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getAnswers",218],"(",")",["T_WHITESPACE"," ",218],["T_AS","as",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$answer",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$answer",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","setPollId",219],"(",["T_VARIABLE","$object",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getId",219],"(",")",")",";",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$answer",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","save",220],"(",")",";",["T_WHITESPACE","\n        ",220],"}",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Get store ids to which specified item is assigned\n     *\n     * @param int $id\n     * @return array\n     *\/",224],["T_WHITESPACE","\n    ",229],["T_PUBLIC","public",230],["T_WHITESPACE"," ",230],["T_FUNCTION","function",230],["T_WHITESPACE"," ",230],["T_STRING","lookupStoreIds",230],"(",["T_VARIABLE","$id",230],")",["T_WHITESPACE","\n    ",230],"{",["T_WHITESPACE","\n        ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_getReadAdapter",232],"(",")",["T_OBJECT_OPERATOR","->",232],["T_STRING","fetchCol",232],"(",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_getReadAdapter",233],"(",")",["T_OBJECT_OPERATOR","->",233],["T_STRING","select",233],"(",")",["T_WHITESPACE","\n                ",233],["T_OBJECT_OPERATOR","->",234],["T_STRING","from",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getTable",234],"(",["T_CONSTANT_ENCAPSED_STRING","'poll\/poll_store'",234],")",",",["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'store_id'",234],")",["T_WHITESPACE","\n                ",234],["T_OBJECT_OPERATOR","->",235],["T_STRING","where",235],"(","\"",["T_CURLY_OPEN","{",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getIdFieldName",235],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," = :id_field",235],"\"",")",",",["T_WHITESPACE","\n            ",235],["T_ARRAY","array",236],"(",["T_CONSTANT_ENCAPSED_STRING","':id_field'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$id",236],")",["T_WHITESPACE","\n        ",236],")",";",["T_WHITESPACE","\n    ",237],"}",["T_WHITESPACE","\n",238],"}",["T_WHITESPACE","\n",239]]