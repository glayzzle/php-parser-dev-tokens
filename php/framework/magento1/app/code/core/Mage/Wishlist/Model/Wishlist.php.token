[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Wishlist\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Wishlist model\n *\n * @method Mage_Wishlist_Model_Resource_Wishlist _getResource()\n * @method Mage_Wishlist_Model_Resource_Wishlist getResource()\n * @method int getShared()\n * @method Mage_Wishlist_Model_Wishlist setShared(int $value)\n * @method string getSharingCode()\n * @method Mage_Wishlist_Model_Wishlist setSharingCode(string $value)\n * @method string getUpdatedAt()\n * @method Mage_Wishlist_Model_Wishlist setUpdatedAt(string $value)\n *\n * @category    Mage\n * @package     Mage_Wishlist\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",43],["T_CLASS","class",44],["T_WHITESPACE"," ",44],["T_STRING","Mage_Wishlist_Model_Wishlist",44],["T_WHITESPACE"," ",44],["T_EXTENDS","extends",44],["T_WHITESPACE"," ",44],["T_STRING","Mage_Core_Model_Abstract",44],["T_WHITESPACE","\n",44],"{",["T_WHITESPACE","\n    ",45],["T_DOC_COMMENT","\/**\n     * Prefix of model events names\n     *\n     * @var string\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$_eventPrefix",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'wishlist'",51],";",["T_WHITESPACE","\n    ",51],["T_DOC_COMMENT","\/**\n     * Wishlist item collection\n     *\n     * @var Mage_Wishlist_Model_Mysql4_Item_Collection\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_itemCollection",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","null",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Store filter for wishlist\n     *\n     * @var Mage_Core_Model_Store\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_store",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","null",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Shared store ids (website stores)\n     *\n     * @var array\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_storeIds",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","null",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Entity cache tag\n     *\n     * @var string\n     *\/",73],["T_WHITESPACE","\n    ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$_cacheTag",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'wishlist'",78],";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\/",80],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","_construct",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_init",85],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/wishlist'",85],")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Load wishlist by customer\n     *\n     * @param mixed $customer\n     * @param bool $create Create wishlist if don't exists\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",88],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","loadByCustomer",95],"(",["T_VARIABLE","$customer",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$create",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","false",95],")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$customer",97],["T_WHITESPACE"," ",97],["T_INSTANCEOF","instanceof",97],["T_WHITESPACE"," ",97],["T_STRING","Mage_Customer_Model_Customer",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$customer",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$customer",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getId",98],"(",")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_VARIABLE","$customer",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_INT_CAST","(int)",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$customer",101],";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$customerIdFieldName",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_getResource",102],"(",")",["T_OBJECT_OPERATOR","->",102],["T_STRING","getCustomerIdFieldName",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_getResource",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","load",103],"(",["T_VARIABLE","$this",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$customer",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$customerIdFieldName",103],")",";",["T_WHITESPACE","\n        ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(","!",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getId",104],"(",")",["T_WHITESPACE"," ",104],["T_BOOLEAN_AND","&&",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$create",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","setCustomerId",105],"(",["T_VARIABLE","$customer",105],")",";",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","setSharingCode",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_getSharingRandomCode",106],"(",")",")",";",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","save",107],"(",")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist name\n     *\n     * @return string\n     *\/",113],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","getName",118],"(",")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$name",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_getData",120],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",120],")",";",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_STRING","strlen",121],"(",["T_VARIABLE","$name",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","helper",122],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",122],")",["T_OBJECT_OPERATOR","->",122],["T_STRING","getDefaultWishlistName",122],"(",")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n        ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$name",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Set random sharing code\n     *\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",127],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","generateSharingCode",132],"(",")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","setSharingCode",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_getSharingRandomCode",134],"(",")",")",";",["T_WHITESPACE","\n        ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * Load by sharing code\n     *\n     * @param string $code\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",138],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","loadByCode",144],"(",["T_VARIABLE","$code",144],")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_getResource",146],"(",")",["T_OBJECT_OPERATOR","->",146],["T_STRING","load",146],"(",["T_VARIABLE","$this",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$code",146],",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","'sharing_code'",146],")",";",["T_WHITESPACE","\n        ",146],["T_IF","if",147],"(","!",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getShared",147],"(",")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","setId",148],"(",["T_STRING","null",148],")",";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n\n        ",149],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Retrieve sharing code (random string)\n     *\n     * @return string\n     *\/",154],["T_WHITESPACE","\n    ",158],["T_PROTECTED","protected",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","_getSharingRandomCode",159],"(",")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","helper",161],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","uniqHash",161],"(",")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Set date of last update for wishlist\n     *\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",164],["T_WHITESPACE","\n    ",168],["T_PROTECTED","protected",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","_beforeSave",169],"(",")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_STRING","parent",171],["T_DOUBLE_COLON","::",171],["T_STRING","_beforeSave",171],"(",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","setUpdatedAt",172],"(",["T_STRING","Mage",172],["T_DOUBLE_COLON","::",172],["T_STRING","getSingleton",172],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",172],")",["T_OBJECT_OPERATOR","->",172],["T_STRING","gmtDate",172],"(",")",")",";",["T_WHITESPACE","\n        ",172],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],";",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Save related items\n     *\n     * @return Mage_Sales_Model_Quote\n     *\/",176],["T_WHITESPACE","\n    ",180],["T_PROTECTED","protected",181],["T_WHITESPACE"," ",181],["T_FUNCTION","function",181],["T_WHITESPACE"," ",181],["T_STRING","_afterSave",181],"(",")",["T_WHITESPACE","\n    ",181],"{",["T_WHITESPACE","\n        ",182],["T_STRING","parent",183],["T_DOUBLE_COLON","::",183],["T_STRING","_afterSave",183],"(",")",";",["T_WHITESPACE","\n\n        ",183],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_STRING","null",185],["T_WHITESPACE"," ",185],["T_IS_NOT_IDENTICAL","!==",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_itemCollection",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getItemCollection",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","save",186],"(",")",";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n        ",187],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Add catalog product object data to wishlist\n     *\n     * @param   Mage_Catalog_Model_Product $product\n     * @param   int $qty\n     * @param   bool $forciblySetQty\n     *\n     * @return  Mage_Wishlist_Model_Item\n     *\/",191],["T_WHITESPACE","\n    ",199],["T_PROTECTED","protected",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","_addCatalogProduct",200],"(",["T_STRING","Mage_Catalog_Model_Product",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$product",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$qty",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_LNUMBER","1",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$forciblySetQty",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","false",200],")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$item",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","null",202],";",["T_WHITESPACE","\n        ",202],["T_FOREACH","foreach",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getItemCollection",203],"(",")",["T_WHITESPACE"," ",203],["T_AS","as",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$_item",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_VARIABLE","$_item",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","representProduct",204],"(",["T_VARIABLE","$product",204],")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n                ",204],["T_VARIABLE","$item",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$_item",205],";",["T_WHITESPACE","\n                ",205],["T_BREAK","break",206],";",["T_WHITESPACE","\n            ",206],"}",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n\n        ",208],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$item",210],["T_WHITESPACE"," ",210],["T_IS_IDENTICAL","===",210],["T_WHITESPACE"," ",210],["T_STRING","null",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$storeId",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$product",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","hasWishlistStoreId",211],"(",")",["T_WHITESPACE"," ",211],"?",["T_WHITESPACE"," ",211],["T_VARIABLE","$product",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getWishlistStoreId",211],"(",")",["T_WHITESPACE"," ",211],":",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getStore",211],"(",")",["T_OBJECT_OPERATOR","->",211],["T_STRING","getId",211],"(",")",";",["T_WHITESPACE","\n            ",211],["T_VARIABLE","$item",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","Mage",212],["T_DOUBLE_COLON","::",212],["T_STRING","getModel",212],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/item'",212],")",";",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$item",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","setProductId",213],"(",["T_VARIABLE","$product",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getId",213],"(",")",")",["T_WHITESPACE","\n                ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","setWishlistId",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getId",214],"(",")",")",["T_WHITESPACE","\n                ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","setAddedAt",215],"(",["T_STRING","now",215],"(",")",")",["T_WHITESPACE","\n                ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","setStoreId",216],"(",["T_VARIABLE","$storeId",216],")",["T_WHITESPACE","\n                ",216],["T_OBJECT_OPERATOR","->",217],["T_STRING","setOptions",217],"(",["T_VARIABLE","$product",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getCustomOptions",217],"(",")",")",["T_WHITESPACE","\n                ",217],["T_OBJECT_OPERATOR","->",218],["T_STRING","setProduct",218],"(",["T_VARIABLE","$product",218],")",["T_WHITESPACE","\n                ",218],["T_OBJECT_OPERATOR","->",219],["T_STRING","setQty",219],"(",["T_VARIABLE","$qty",219],")",["T_WHITESPACE","\n                ",219],["T_OBJECT_OPERATOR","->",220],["T_STRING","save",220],"(",")",";",["T_WHITESPACE","\n\n            ",220],["T_STRING","Mage",222],["T_DOUBLE_COLON","::",222],["T_STRING","dispatchEvent",222],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist_item_add_after'",222],",",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],")",")",";",["T_WHITESPACE","\n\n            ",222],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$item",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getId",224],"(",")",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                ",224],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getItemCollection",225],"(",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","addItem",225],"(",["T_VARIABLE","$item",225],")",";",["T_WHITESPACE","\n            ",225],"}",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$qty",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$forciblySetQty",228],["T_WHITESPACE"," ",228],"?",["T_WHITESPACE"," ",228],["T_VARIABLE","$qty",228],["T_WHITESPACE"," ",228],":",["T_WHITESPACE"," ",228],["T_VARIABLE","$item",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getQty",228],"(",")",["T_WHITESPACE"," ",228],"+",["T_WHITESPACE"," ",228],["T_VARIABLE","$qty",228],";",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$item",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","setQty",229],"(",["T_VARIABLE","$qty",229],")",["T_WHITESPACE","\n                ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","save",230],"(",")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n\n        ",231],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","addItem",233],"(",["T_VARIABLE","$item",233],")",";",["T_WHITESPACE","\n\n        ",233],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$item",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist item collection\n     *\n     * @return Mage_Wishlist_Model_Mysql4_Item_Collection\n     *\/",238],["T_WHITESPACE","\n    ",242],["T_PUBLIC","public",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","getItemCollection",243],"(",")",["T_WHITESPACE","\n    ",243],"{",["T_WHITESPACE","\n        ",244],["T_IF","if",245],["T_WHITESPACE"," ",245],"(",["T_STRING","is_null",245],"(",["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_itemCollection",245],")",")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n            ",245],["T_DOC_COMMENT","\/** @var $currentWebsiteOnly boolean *\/",246],["T_WHITESPACE","\n            ",246],["T_VARIABLE","$currentWebsiteOnly",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],"!",["T_STRING","Mage",247],["T_DOUBLE_COLON","::",247],["T_STRING","app",247],"(",")",["T_OBJECT_OPERATOR","->",247],["T_STRING","getStore",247],"(",")",["T_OBJECT_OPERATOR","->",247],["T_STRING","isAdmin",247],"(",")",";",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_itemCollection",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE","  ",248],["T_STRING","Mage",248],["T_DOUBLE_COLON","::",248],["T_STRING","getResourceModel",248],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/item_collection'",248],")",["T_WHITESPACE","\n                ",248],["T_OBJECT_OPERATOR","->",249],["T_STRING","addWishlistFilter",249],"(",["T_VARIABLE","$this",249],")",["T_WHITESPACE","\n                ",249],["T_OBJECT_OPERATOR","->",250],["T_STRING","addStoreFilter",250],"(",["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getSharedStoreIds",250],"(",["T_VARIABLE","$currentWebsiteOnly",250],")",")",["T_WHITESPACE","\n                ",250],["T_OBJECT_OPERATOR","->",251],["T_STRING","setVisibilityFilter",251],"(",")",";",["T_WHITESPACE","\n\n            ",251],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_STRING","Mage",253],["T_DOUBLE_COLON","::",253],["T_STRING","app",253],"(",")",["T_OBJECT_OPERATOR","->",253],["T_STRING","getStore",253],"(",")",["T_OBJECT_OPERATOR","->",253],["T_STRING","isAdmin",253],"(",")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                ",253],["T_VARIABLE","$customer",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_STRING","Mage",254],["T_DOUBLE_COLON","::",254],["T_STRING","getModel",254],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",254],")",["T_OBJECT_OPERATOR","->",254],["T_STRING","load",254],"(",["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getCustomerId",254],"(",")",")",";",["T_WHITESPACE","\n                ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_itemCollection",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","setWebsiteId",255],"(",["T_VARIABLE","$customer",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getWebsiteId",255],"(",")",")",";",["T_WHITESPACE","\n                ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_itemCollection",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","setCustomerGroupId",256],"(",["T_VARIABLE","$customer",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getGroupId",256],"(",")",")",";",["T_WHITESPACE","\n            ",256],"}",["T_WHITESPACE","\n        ",257],"}",["T_WHITESPACE","\n\n        ",258],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_itemCollection",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist item collection\n     *\n     * @param int $itemId\n     * @return Mage_Wishlist_Model_Item\n     *\/",263],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","getItem",269],"(",["T_VARIABLE","$itemId",269],")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_IF","if",271],["T_WHITESPACE"," ",271],"(","!",["T_VARIABLE","$itemId",271],")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_RETURN","return",272],["T_WHITESPACE"," ",272],["T_STRING","false",272],";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n        ",273],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getItemCollection",274],"(",")",["T_OBJECT_OPERATOR","->",274],["T_STRING","getItemById",274],"(",["T_VARIABLE","$itemId",274],")",";",["T_WHITESPACE","\n    ",274],"}",["T_WHITESPACE","\n\n    ",275],["T_DOC_COMMENT","\/**\n     * Retrieve Product collection\n     *\n     * @deprecated after 1.4.2.0\n     * @see Mage_Wishlist_Model_Wishlist::getItemCollection()\n     *\n     * @return Mage_Wishlist_Model_Mysql4_Product_Collection\n     *\/",277],["T_WHITESPACE","\n    ",284],["T_PUBLIC","public",285],["T_WHITESPACE"," ",285],["T_FUNCTION","function",285],["T_WHITESPACE"," ",285],["T_STRING","getProductCollection",285],"(",")",["T_WHITESPACE","\n    ",285],"{",["T_WHITESPACE","\n        ",286],["T_VARIABLE","$collection",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getData",287],"(",["T_CONSTANT_ENCAPSED_STRING","'product_collection'",287],")",";",["T_WHITESPACE","\n        ",287],["T_IF","if",288],["T_WHITESPACE"," ",288],"(",["T_STRING","is_null",288],"(",["T_VARIABLE","$collection",288],")",")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$collection",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_STRING","Mage",289],["T_DOUBLE_COLON","::",289],["T_STRING","getResourceModel",289],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/product_collection'",289],")",";",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","setData",290],"(",["T_CONSTANT_ENCAPSED_STRING","'product_collection'",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$collection",290],")",";",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE","\n        ",291],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$collection",292],";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n\n    ",293],["T_DOC_COMMENT","\/**\n     * Adding item to wishlist\n     *\n     * @param   Mage_Wishlist_Model_Item $item\n     * @return  Mage_Wishlist_Model_Wishlist\n     *\/",295],["T_WHITESPACE","\n    ",300],["T_PUBLIC","public",301],["T_WHITESPACE"," ",301],["T_FUNCTION","function",301],["T_WHITESPACE"," ",301],["T_STRING","addItem",301],"(",["T_STRING","Mage_Wishlist_Model_Item",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$item",301],")",["T_WHITESPACE","\n    ",301],"{",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$item",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","setWishlist",303],"(",["T_VARIABLE","$this",303],")",";",["T_WHITESPACE","\n        ",303],["T_IF","if",304],["T_WHITESPACE"," ",304],"(","!",["T_VARIABLE","$item",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","getId",304],"(",")",")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n            ",304],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getItemCollection",305],"(",")",["T_OBJECT_OPERATOR","->",305],["T_STRING","addItem",305],"(",["T_VARIABLE","$item",305],")",";",["T_WHITESPACE","\n            ",305],["T_STRING","Mage",306],["T_DOUBLE_COLON","::",306],["T_STRING","dispatchEvent",306],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist_add_item'",306],",",["T_WHITESPACE"," ",306],["T_ARRAY","array",306],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",306],["T_WHITESPACE"," ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$item",306],")",")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n        ",307],["T_RETURN","return",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],";",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * Adds new product to wishlist.\n     * Returns new item or string on error.\n     *\n     * @param int|Mage_Catalog_Model_Product $product\n     * @param mixed $buyRequest\n     * @param bool $forciblySetQty\n     * @return Mage_Wishlist_Model_Item|string\n     *\/",311],["T_WHITESPACE","\n    ",319],["T_PUBLIC","public",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","addNewItem",320],"(",["T_VARIABLE","$product",320],",",["T_WHITESPACE"," ",320],["T_VARIABLE","$buyRequest",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","null",320],",",["T_WHITESPACE"," ",320],["T_VARIABLE","$forciblySetQty",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_STRING","false",320],")",["T_WHITESPACE","\n    ",320],"{",["T_WHITESPACE","\n        ",321],["T_COMMENT","\/*\n         * Always load product, to ensure:\n         * a) we have new instance and do not interfere with other products in wishlist\n         * b) product has full set of attributes\n         *\/",322],["T_WHITESPACE","\n        ",326],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$product",327],["T_WHITESPACE"," ",327],["T_INSTANCEOF","instanceof",327],["T_WHITESPACE"," ",327],["T_STRING","Mage_Catalog_Model_Product",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_VARIABLE","$productId",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$product",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getId",328],"(",")",";",["T_WHITESPACE","\n            ",328],["T_COMMENT","\/\/ Maybe force some store by wishlist internal properties\n",329],["T_WHITESPACE","            ",330],["T_VARIABLE","$storeId",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$product",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","hasWishlistStoreId",330],"(",")",["T_WHITESPACE"," ",330],"?",["T_WHITESPACE"," ",330],["T_VARIABLE","$product",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getWishlistStoreId",330],"(",")",["T_WHITESPACE"," ",330],":",["T_WHITESPACE"," ",330],["T_VARIABLE","$product",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getStoreId",330],"(",")",";",["T_WHITESPACE","\n        ",330],"}",["T_WHITESPACE"," ",331],["T_ELSE","else",331],["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n            ",331],["T_VARIABLE","$productId",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_INT_CAST","(int)",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$product",332],";",["T_WHITESPACE","\n            ",332],["T_IF","if",333],["T_WHITESPACE"," ",333],"(",["T_VARIABLE","$buyRequest",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getStoreId",333],"(",")",")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n                ",333],["T_VARIABLE","$storeId",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_VARIABLE","$buyRequest",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getStoreId",334],"(",")",";",["T_WHITESPACE","\n            ",334],"}",["T_WHITESPACE"," ",335],["T_ELSE","else",335],["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n                ",335],["T_VARIABLE","$storeId",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_STRING","Mage",336],["T_DOUBLE_COLON","::",336],["T_STRING","app",336],"(",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","getStore",336],"(",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","getId",336],"(",")",";",["T_WHITESPACE","\n            ",336],"}",["T_WHITESPACE","\n        ",337],"}",["T_WHITESPACE","\n\n        ",338],["T_COMMENT","\/* @var $product Mage_Catalog_Model_Product *\/",340],["T_WHITESPACE","\n        ",340],["T_VARIABLE","$product",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_STRING","Mage",341],["T_DOUBLE_COLON","::",341],["T_STRING","getModel",341],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",341],")",["T_WHITESPACE","\n            ",341],["T_OBJECT_OPERATOR","->",342],["T_STRING","setStoreId",342],"(",["T_VARIABLE","$storeId",342],")",["T_WHITESPACE","\n            ",342],["T_OBJECT_OPERATOR","->",343],["T_STRING","load",343],"(",["T_VARIABLE","$productId",343],")",";",["T_WHITESPACE","\n\n        ",343],["T_IF","if",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$buyRequest",345],["T_WHITESPACE"," ",345],["T_INSTANCEOF","instanceof",345],["T_WHITESPACE"," ",345],["T_STRING","Varien_Object",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n            ",345],["T_VARIABLE","$_buyRequest",346],["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_VARIABLE","$buyRequest",346],";",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE"," ",347],["T_ELSEIF","elseif",347],["T_WHITESPACE"," ",347],"(",["T_STRING","is_string",347],"(",["T_VARIABLE","$buyRequest",347],")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$_buyRequest",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_NEW","new",348],["T_WHITESPACE"," ",348],["T_STRING","Varien_Object",348],"(",["T_STRING","unserialize",348],"(",["T_VARIABLE","$buyRequest",348],")",")",";",["T_WHITESPACE","\n        ",348],"}",["T_WHITESPACE"," ",349],["T_ELSEIF","elseif",349],["T_WHITESPACE"," ",349],"(",["T_STRING","is_array",349],"(",["T_VARIABLE","$buyRequest",349],")",")",["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n            ",349],["T_VARIABLE","$_buyRequest",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_NEW","new",350],["T_WHITESPACE"," ",350],["T_STRING","Varien_Object",350],"(",["T_VARIABLE","$buyRequest",350],")",";",["T_WHITESPACE","\n        ",350],"}",["T_WHITESPACE"," ",351],["T_ELSE","else",351],["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n            ",351],["T_VARIABLE","$_buyRequest",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_NEW","new",352],["T_WHITESPACE"," ",352],["T_STRING","Varien_Object",352],"(",")",";",["T_WHITESPACE","\n        ",352],"}",["T_WHITESPACE","\n\n        ",353],["T_VARIABLE","$cartCandidates",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$product",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getTypeInstance",355],"(",["T_STRING","true",355],")",["T_WHITESPACE","\n            ",355],["T_OBJECT_OPERATOR","->",356],["T_STRING","processConfiguration",356],"(",["T_VARIABLE","$_buyRequest",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$product",356],")",";",["T_WHITESPACE","\n\n        ",356],["T_DOC_COMMENT","\/**\n         * Error message\n         *\/",358],["T_WHITESPACE","\n        ",360],["T_IF","if",361],["T_WHITESPACE"," ",361],"(",["T_STRING","is_string",361],"(",["T_VARIABLE","$cartCandidates",361],")",")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n            ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$cartCandidates",362],";",["T_WHITESPACE","\n        ",362],"}",["T_WHITESPACE","\n\n        ",363],["T_DOC_COMMENT","\/**\n         * If prepare process return one object\n         *\/",365],["T_WHITESPACE","\n        ",367],["T_IF","if",368],["T_WHITESPACE"," ",368],"(","!",["T_STRING","is_array",368],"(",["T_VARIABLE","$cartCandidates",368],")",")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n            ",368],["T_VARIABLE","$cartCandidates",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_ARRAY","array",369],"(",["T_VARIABLE","$cartCandidates",369],")",";",["T_WHITESPACE","\n        ",369],"}",["T_WHITESPACE","\n\n        ",370],["T_VARIABLE","$errors",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_ARRAY","array",372],"(",")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$items",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_ARRAY","array",373],"(",")",";",["T_WHITESPACE","\n\n        ",373],["T_FOREACH","foreach",375],["T_WHITESPACE"," ",375],"(",["T_VARIABLE","$cartCandidates",375],["T_WHITESPACE"," ",375],["T_AS","as",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$candidate",375],")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_IF","if",376],["T_WHITESPACE"," ",376],"(",["T_VARIABLE","$candidate",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getParentProductId",376],"(",")",")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n                ",376],["T_CONTINUE","continue",377],";",["T_WHITESPACE","\n            ",377],"}",["T_WHITESPACE","\n            ",378],["T_VARIABLE","$candidate",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","setWishlistStoreId",379],"(",["T_VARIABLE","$storeId",379],")",";",["T_WHITESPACE","\n\n            ",379],["T_VARIABLE","$qty",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$candidate",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getQty",381],"(",")",["T_WHITESPACE"," ",381],"?",["T_WHITESPACE"," ",381],["T_VARIABLE","$candidate",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getQty",381],"(",")",["T_WHITESPACE"," ",381],":",["T_WHITESPACE"," ",381],["T_LNUMBER","1",381],";",["T_WHITESPACE"," ",381],["T_COMMENT","\/\/ No null values as qty. Convert zero to 1.\n",381],["T_WHITESPACE","            ",382],["T_VARIABLE","$item",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","_addCatalogProduct",382],"(",["T_VARIABLE","$candidate",382],",",["T_WHITESPACE"," ",382],["T_VARIABLE","$qty",382],",",["T_WHITESPACE"," ",382],["T_VARIABLE","$forciblySetQty",382],")",";",["T_WHITESPACE","\n            ",382],["T_VARIABLE","$items",383],"[","]",["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$item",383],";",["T_WHITESPACE","\n\n            ",383],["T_COMMENT","\/\/ Collect errors instead of throwing first one\n",385],["T_WHITESPACE","            ",386],["T_IF","if",386],["T_WHITESPACE"," ",386],"(",["T_VARIABLE","$item",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getHasError",386],"(",")",")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n                ",386],["T_VARIABLE","$errors",387],"[","]",["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$item",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getMessage",387],"(",")",";",["T_WHITESPACE","\n            ",387],"}",["T_WHITESPACE","\n        ",388],"}",["T_WHITESPACE","\n\n        ",389],["T_STRING","Mage",391],["T_DOUBLE_COLON","::",391],["T_STRING","dispatchEvent",391],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist_product_add_after'",391],",",["T_WHITESPACE"," ",391],["T_ARRAY","array",391],"(",["T_CONSTANT_ENCAPSED_STRING","'items'",391],["T_WHITESPACE"," ",391],["T_DOUBLE_ARROW","=>",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$items",391],")",")",";",["T_WHITESPACE","\n\n        ",391],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$item",393],";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n\n    ",394],["T_DOC_COMMENT","\/**\n     * Set customer id\n     *\n     * @param int $customerId\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",396],["T_WHITESPACE","\n    ",401],["T_PUBLIC","public",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","setCustomerId",402],"(",["T_VARIABLE","$customerId",402],")",["T_WHITESPACE","\n    ",402],"{",["T_WHITESPACE","\n        ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","setData",404],"(",["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","_getResource",404],"(",")",["T_OBJECT_OPERATOR","->",404],["T_STRING","getCustomerIdFieldName",404],"(",")",",",["T_WHITESPACE"," ",404],["T_VARIABLE","$customerId",404],")",";",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_DOC_COMMENT","\/**\n     * Retrieve customer id\n     *\n     * @return int\n     *\/",407],["T_WHITESPACE","\n    ",411],["T_PUBLIC","public",412],["T_WHITESPACE"," ",412],["T_FUNCTION","function",412],["T_WHITESPACE"," ",412],["T_STRING","getCustomerId",412],"(",")",["T_WHITESPACE","\n    ",412],"{",["T_WHITESPACE","\n        ",413],["T_RETURN","return",414],["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getData",414],"(",["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","_getResource",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","getCustomerIdFieldName",414],"(",")",")",";",["T_WHITESPACE","\n    ",414],"}",["T_WHITESPACE","\n\n    ",415],["T_DOC_COMMENT","\/**\n     * Retrieve data for save\n     *\n     * @return array\n     *\/",417],["T_WHITESPACE","\n    ",421],["T_PUBLIC","public",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","getDataForSave",422],"(",")",["T_WHITESPACE","\n    ",422],"{",["T_WHITESPACE","\n        ",423],["T_VARIABLE","$data",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_ARRAY","array",424],"(",")",";",["T_WHITESPACE","\n        ",424],["T_VARIABLE","$data",425],"[",["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","_getResource",425],"(",")",["T_OBJECT_OPERATOR","->",425],["T_STRING","getCustomerIdFieldName",425],"(",")","]",["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getCustomerId",425],"(",")",";",["T_WHITESPACE","\n        ",425],["T_VARIABLE","$data",426],"[",["T_CONSTANT_ENCAPSED_STRING","'shared'",426],"]",["T_WHITESPACE","      ",426],"=",["T_WHITESPACE"," ",426],["T_INT_CAST","(int)",426],["T_WHITESPACE"," ",426],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getShared",426],"(",")",";",["T_WHITESPACE","\n        ",426],["T_VARIABLE","$data",427],"[",["T_CONSTANT_ENCAPSED_STRING","'sharing_code'",427],"]","=",["T_WHITESPACE"," ",427],["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getSharingCode",427],"(",")",";",["T_WHITESPACE","\n        ",427],["T_RETURN","return",428],["T_WHITESPACE"," ",428],["T_VARIABLE","$data",428],";",["T_WHITESPACE","\n    ",428],"}",["T_WHITESPACE","\n\n    ",429],["T_DOC_COMMENT","\/**\n     * Retrieve shared store ids for current website or all stores if $current is false\n     *\n     * @param bool $current Use current website or not\n     * @return array\n     *\/",431],["T_WHITESPACE","\n    ",436],["T_PUBLIC","public",437],["T_WHITESPACE"," ",437],["T_FUNCTION","function",437],["T_WHITESPACE"," ",437],["T_STRING","getSharedStoreIds",437],"(",["T_VARIABLE","$current",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_STRING","true",437],")",["T_WHITESPACE","\n    ",437],"{",["T_WHITESPACE","\n        ",438],["T_IF","if",439],["T_WHITESPACE"," ",439],"(",["T_STRING","is_null",439],"(",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","_storeIds",439],")",["T_WHITESPACE"," ",439],["T_BOOLEAN_OR","||",439],["T_WHITESPACE"," ",439],"!",["T_STRING","is_array",439],"(",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","_storeIds",439],")",")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n            ",439],["T_IF","if",440],["T_WHITESPACE"," ",440],"(",["T_VARIABLE","$current",440],")",["T_WHITESPACE"," ",440],"{",["T_WHITESPACE","\n                ",440],["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","_storeIds",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getStore",441],"(",")",["T_OBJECT_OPERATOR","->",441],["T_STRING","getWebsite",441],"(",")",["T_OBJECT_OPERATOR","->",441],["T_STRING","getStoreIds",441],"(",")",";",["T_WHITESPACE","\n            ",441],"}",["T_WHITESPACE"," ",442],["T_ELSE","else",442],["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n                ",442],["T_VARIABLE","$_storeIds",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_ARRAY","array",443],"(",")",";",["T_WHITESPACE","\n                ",443],["T_VARIABLE","$stores",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_STRING","Mage",444],["T_DOUBLE_COLON","::",444],["T_STRING","app",444],"(",")",["T_OBJECT_OPERATOR","->",444],["T_STRING","getStores",444],"(",")",";",["T_WHITESPACE","\n                ",444],["T_FOREACH","foreach",445],["T_WHITESPACE"," ",445],"(",["T_VARIABLE","$stores",445],["T_WHITESPACE"," ",445],["T_AS","as",445],["T_WHITESPACE"," ",445],["T_VARIABLE","$store",445],")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n                    ",445],["T_VARIABLE","$_storeIds",446],"[","]",["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_VARIABLE","$store",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getId",446],"(",")",";",["T_WHITESPACE","\n                ",446],"}",["T_WHITESPACE","\n                ",447],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","_storeIds",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_VARIABLE","$_storeIds",448],";",["T_WHITESPACE","\n            ",448],"}",["T_WHITESPACE","\n        ",449],"}",["T_WHITESPACE","\n        ",450],["T_RETURN","return",451],["T_WHITESPACE"," ",451],["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","_storeIds",451],";",["T_WHITESPACE","\n    ",451],"}",["T_WHITESPACE","\n\n    ",452],["T_DOC_COMMENT","\/**\n     * Set shared store ids\n     *\n     * @param array $storeIds\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",454],["T_WHITESPACE","\n    ",459],["T_PUBLIC","public",460],["T_WHITESPACE"," ",460],["T_FUNCTION","function",460],["T_WHITESPACE"," ",460],["T_STRING","setSharedStoreIds",460],"(",["T_VARIABLE","$storeIds",460],")",["T_WHITESPACE","\n    ",460],"{",["T_WHITESPACE","\n        ",461],["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","_storeIds",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_ARRAY_CAST","(array)",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$storeIds",462],";",["T_WHITESPACE","\n        ",462],["T_RETURN","return",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$this",463],";",["T_WHITESPACE","\n    ",463],"}",["T_WHITESPACE","\n\n    ",464],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist store object\n     *\n     * @return Mage_Core_Model_Store\n     *\/",466],["T_WHITESPACE","\n    ",470],["T_PUBLIC","public",471],["T_WHITESPACE"," ",471],["T_FUNCTION","function",471],["T_WHITESPACE"," ",471],["T_STRING","getStore",471],"(",")",["T_WHITESPACE","\n    ",471],"{",["T_WHITESPACE","\n        ",472],["T_IF","if",473],["T_WHITESPACE"," ",473],"(",["T_STRING","is_null",473],"(",["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","_store",473],")",")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","setStore",474],"(",["T_STRING","Mage",474],["T_DOUBLE_COLON","::",474],["T_STRING","app",474],"(",")",["T_OBJECT_OPERATOR","->",474],["T_STRING","getStore",474],"(",")",")",";",["T_WHITESPACE","\n        ",474],"}",["T_WHITESPACE","\n        ",475],["T_RETURN","return",476],["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_store",476],";",["T_WHITESPACE","\n    ",476],"}",["T_WHITESPACE","\n\n    ",477],["T_DOC_COMMENT","\/**\n     * Set wishlist store\n     *\n     * @param Mage_Core_Model_Store $store\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",479],["T_WHITESPACE","\n    ",484],["T_PUBLIC","public",485],["T_WHITESPACE"," ",485],["T_FUNCTION","function",485],["T_WHITESPACE"," ",485],["T_STRING","setStore",485],"(",["T_VARIABLE","$store",485],")",["T_WHITESPACE","\n    ",485],"{",["T_WHITESPACE","\n        ",486],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","_store",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_VARIABLE","$store",487],";",["T_WHITESPACE","\n        ",487],["T_RETURN","return",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$this",488],";",["T_WHITESPACE","\n    ",488],"}",["T_WHITESPACE","\n\n    ",489],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist items count\n     *\n     * @return int\n     *\/",491],["T_WHITESPACE","\n    ",495],["T_PUBLIC","public",496],["T_WHITESPACE"," ",496],["T_FUNCTION","function",496],["T_WHITESPACE"," ",496],["T_STRING","getItemsCount",496],"(",")",["T_WHITESPACE","\n    ",496],"{",["T_WHITESPACE","\n        ",497],["T_RETURN","return",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","getItemCollection",498],"(",")",["T_OBJECT_OPERATOR","->",498],["T_STRING","getSize",498],"(",")",";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist has salable item(s)\n     *\n     * @return bool\n     *\/",501],["T_WHITESPACE","\n    ",505],["T_PUBLIC","public",506],["T_WHITESPACE"," ",506],["T_FUNCTION","function",506],["T_WHITESPACE"," ",506],["T_STRING","isSalable",506],"(",")",["T_WHITESPACE","\n    ",506],"{",["T_WHITESPACE","\n        ",507],["T_FOREACH","foreach",508],["T_WHITESPACE"," ",508],"(",["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","getItemCollection",508],"(",")",["T_WHITESPACE"," ",508],["T_AS","as",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$item",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_IF","if",509],["T_WHITESPACE"," ",509],"(",["T_VARIABLE","$item",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getProduct",509],"(",")",["T_OBJECT_OPERATOR","->",509],["T_STRING","getIsSalable",509],"(",")",")",["T_WHITESPACE"," ",509],"{",["T_WHITESPACE","\n                ",509],["T_RETURN","return",510],["T_WHITESPACE"," ",510],["T_STRING","true",510],";",["T_WHITESPACE","\n            ",510],"}",["T_WHITESPACE","\n        ",511],"}",["T_WHITESPACE","\n        ",512],["T_RETURN","return",513],["T_WHITESPACE"," ",513],["T_STRING","false",513],";",["T_WHITESPACE","\n    ",513],"}",["T_WHITESPACE","\n\n    ",514],["T_DOC_COMMENT","\/**\n     * Check customer is owner this wishlist\n     *\n     * @param int $customerId\n     * @return bool\n     *\/",516],["T_WHITESPACE","\n    ",521],["T_PUBLIC","public",522],["T_WHITESPACE"," ",522],["T_FUNCTION","function",522],["T_WHITESPACE"," ",522],["T_STRING","isOwner",522],"(",["T_VARIABLE","$customerId",522],")",["T_WHITESPACE","\n    ",522],"{",["T_WHITESPACE","\n        ",523],["T_RETURN","return",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$customerId",524],["T_WHITESPACE"," ",524],["T_IS_EQUAL","==",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","getCustomerId",524],"(",")",";",["T_WHITESPACE","\n    ",524],"}",["T_WHITESPACE","\n\n\n    ",525],["T_DOC_COMMENT","\/**\n     * Update wishlist Item and set data from request\n     *\n     * $params sets how current item configuration must be taken into account and additional options.\n     * It's passed to Mage_Catalog_Helper_Product->addParamsToBuyRequest() to compose resulting buyRequest.\n     *\n     * Basically it can hold\n     * - 'current_config', Varien_Object or array - current buyRequest that configures product in this item,\n     *   used to restore currently attached files\n     * - 'files_prefix': string[a-z0-9_] - prefix that was added at frontend to names of file options (file inputs), so they won't\n     *   intersect with other submitted options\n     *\n     * For more options see Mage_Catalog_Helper_Product->addParamsToBuyRequest()\n     *\n     * @param int|Mage_Wishlist_Model_Item $itemId\n     * @param Varien_Object $buyRequest\n     * @param null|array|Varien_Object $params\n     * @return Mage_Wishlist_Model_Wishlist\n     *\n     * @see Mage_Catalog_Helper_Product::addParamsToBuyRequest()\n     *\/",528],["T_WHITESPACE","\n    ",548],["T_PUBLIC","public",549],["T_WHITESPACE"," ",549],["T_FUNCTION","function",549],["T_WHITESPACE"," ",549],["T_STRING","updateItem",549],"(",["T_VARIABLE","$itemId",549],",",["T_WHITESPACE"," ",549],["T_VARIABLE","$buyRequest",549],",",["T_WHITESPACE"," ",549],["T_VARIABLE","$params",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_STRING","null",549],")",["T_WHITESPACE","\n    ",549],"{",["T_WHITESPACE","\n        ",550],["T_VARIABLE","$item",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_STRING","null",551],";",["T_WHITESPACE","\n        ",551],["T_IF","if",552],["T_WHITESPACE"," ",552],"(",["T_VARIABLE","$itemId",552],["T_WHITESPACE"," ",552],["T_INSTANCEOF","instanceof",552],["T_WHITESPACE"," ",552],["T_STRING","Mage_Wishlist_Model_Item",552],")",["T_WHITESPACE"," ",552],"{",["T_WHITESPACE","\n            ",552],["T_VARIABLE","$item",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_VARIABLE","$itemId",553],";",["T_WHITESPACE","\n        ",553],"}",["T_WHITESPACE"," ",554],["T_ELSE","else",554],["T_WHITESPACE"," ",554],"{",["T_WHITESPACE","\n            ",554],["T_VARIABLE","$item",555],["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","getItem",555],"(",["T_INT_CAST","(int)",555],["T_VARIABLE","$itemId",555],")",";",["T_WHITESPACE","\n        ",555],"}",["T_WHITESPACE","\n        ",556],["T_IF","if",557],["T_WHITESPACE"," ",557],"(","!",["T_VARIABLE","$item",557],")",["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n            ",557],["T_STRING","Mage",558],["T_DOUBLE_COLON","::",558],["T_STRING","throwException",558],"(",["T_STRING","Mage",558],["T_DOUBLE_COLON","::",558],["T_STRING","helper",558],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",558],")",["T_OBJECT_OPERATOR","->",558],["T_STRING","__",558],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot specify wishlist item.'",558],")",")",";",["T_WHITESPACE","\n        ",558],"}",["T_WHITESPACE","\n\n        ",559],["T_VARIABLE","$product",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_VARIABLE","$item",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","getProduct",561],"(",")",";",["T_WHITESPACE","\n        ",561],["T_VARIABLE","$productId",562],["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],["T_VARIABLE","$product",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","getId",562],"(",")",";",["T_WHITESPACE","\n        ",562],["T_IF","if",563],["T_WHITESPACE"," ",563],"(",["T_VARIABLE","$productId",563],")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n            ",563],["T_IF","if",564],["T_WHITESPACE"," ",564],"(","!",["T_VARIABLE","$params",564],")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n                ",564],["T_VARIABLE","$params",565],["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],["T_NEW","new",565],["T_WHITESPACE"," ",565],["T_STRING","Varien_Object",565],"(",")",";",["T_WHITESPACE","\n            ",565],"}",["T_WHITESPACE"," ",566],["T_ELSE","else",566],["T_WHITESPACE"," ",566],["T_IF","if",566],["T_WHITESPACE"," ",566],"(",["T_STRING","is_array",566],"(",["T_VARIABLE","$params",566],")",")",["T_WHITESPACE"," ",566],"{",["T_WHITESPACE","\n                ",566],["T_VARIABLE","$params",567],["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_NEW","new",567],["T_WHITESPACE"," ",567],["T_STRING","Varien_Object",567],"(",["T_VARIABLE","$params",567],")",";",["T_WHITESPACE","\n            ",567],"}",["T_WHITESPACE","\n            ",568],["T_VARIABLE","$params",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","setCurrentConfig",569],"(",["T_VARIABLE","$item",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","getBuyRequest",569],"(",")",")",";",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$buyRequest",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_STRING","Mage",570],["T_DOUBLE_COLON","::",570],["T_STRING","helper",570],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",570],")",["T_OBJECT_OPERATOR","->",570],["T_STRING","addParamsToBuyRequest",570],"(",["T_VARIABLE","$buyRequest",570],",",["T_WHITESPACE"," ",570],["T_VARIABLE","$params",570],")",";",["T_WHITESPACE","\n\n            ",570],["T_VARIABLE","$product",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","setWishlistStoreId",572],"(",["T_VARIABLE","$item",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","getStoreId",572],"(",")",")",";",["T_WHITESPACE","\n            ",572],["T_VARIABLE","$items",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getItemCollection",573],"(",")",";",["T_WHITESPACE","\n            ",573],["T_VARIABLE","$isForceSetQuantity",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_STRING","true",574],";",["T_WHITESPACE","\n            ",574],["T_FOREACH","foreach",575],["T_WHITESPACE"," ",575],"(",["T_VARIABLE","$items",575],["T_WHITESPACE"," ",575],["T_AS","as",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$_item",575],")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n                ",575],["T_COMMENT","\/* @var $_item Mage_Wishlist_Model_Item *\/",576],["T_WHITESPACE","\n                ",576],["T_IF","if",577],["T_WHITESPACE"," ",577],"(",["T_VARIABLE","$_item",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","getProductId",577],"(",")",["T_WHITESPACE"," ",577],["T_IS_EQUAL","==",577],["T_WHITESPACE"," ",577],["T_VARIABLE","$product",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","getId",577],"(",")",["T_WHITESPACE","\n                    ",577],["T_BOOLEAN_AND","&&",578],["T_WHITESPACE"," ",578],["T_VARIABLE","$_item",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","representProduct",578],"(",["T_VARIABLE","$product",578],")",["T_WHITESPACE","\n                    ",578],["T_BOOLEAN_AND","&&",579],["T_WHITESPACE"," ",579],["T_VARIABLE","$_item",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","getId",579],"(",")",["T_WHITESPACE"," ",579],["T_IS_NOT_EQUAL","!=",579],["T_WHITESPACE"," ",579],["T_VARIABLE","$item",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","getId",579],"(",")",")",["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n                    ",579],["T_COMMENT","\/\/ We do not add new wishlist item, but updating the existing one\n",580],["T_WHITESPACE","                    ",581],["T_VARIABLE","$isForceSetQuantity",581],["T_WHITESPACE"," ",581],"=",["T_WHITESPACE"," ",581],["T_STRING","false",581],";",["T_WHITESPACE","\n                ",581],"}",["T_WHITESPACE","\n            ",582],"}",["T_WHITESPACE","\n            ",583],["T_VARIABLE","$resultItem",584],["T_WHITESPACE"," ",584],"=",["T_WHITESPACE"," ",584],["T_VARIABLE","$this",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","addNewItem",584],"(",["T_VARIABLE","$product",584],",",["T_WHITESPACE"," ",584],["T_VARIABLE","$buyRequest",584],",",["T_WHITESPACE"," ",584],["T_VARIABLE","$isForceSetQuantity",584],")",";",["T_WHITESPACE","\n            ",584],["T_DOC_COMMENT","\/**\n             * Error message\n             *\/",585],["T_WHITESPACE","\n            ",587],["T_IF","if",588],["T_WHITESPACE"," ",588],"(",["T_STRING","is_string",588],"(",["T_VARIABLE","$resultItem",588],")",")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n                ",588],["T_STRING","Mage",589],["T_DOUBLE_COLON","::",589],["T_STRING","throwException",589],"(",["T_STRING","Mage",589],["T_DOUBLE_COLON","::",589],["T_STRING","helper",589],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",589],")",["T_OBJECT_OPERATOR","->",589],["T_STRING","__",589],"(",["T_VARIABLE","$resultItem",589],")",")",";",["T_WHITESPACE","\n            ",589],"}",["T_WHITESPACE","\n\n            ",590],["T_IF","if",592],["T_WHITESPACE"," ",592],"(",["T_VARIABLE","$resultItem",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","getId",592],"(",")",["T_WHITESPACE"," ",592],["T_IS_NOT_EQUAL","!=",592],["T_WHITESPACE"," ",592],["T_VARIABLE","$itemId",592],")",["T_WHITESPACE"," ",592],"{",["T_WHITESPACE","\n                ",592],["T_IF","if",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$resultItem",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","getDescription",593],"(",")",["T_WHITESPACE"," ",593],["T_IS_NOT_EQUAL","!=",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$item",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","getDescription",593],"(",")",")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n                    ",593],["T_VARIABLE","$resultItem",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","setDescription",594],"(",["T_VARIABLE","$item",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","getDescription",594],"(",")",")",["T_OBJECT_OPERATOR","->",594],["T_STRING","save",594],"(",")",";",["T_WHITESPACE","\n                ",594],"}",["T_WHITESPACE","\n                ",595],["T_VARIABLE","$item",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","isDeleted",596],"(",["T_STRING","true",596],")",";",["T_WHITESPACE","\n                ",596],["T_VARIABLE","$this",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","setDataChanges",597],"(",["T_STRING","true",597],")",";",["T_WHITESPACE","\n            ",597],"}",["T_WHITESPACE"," ",598],["T_ELSE","else",598],["T_WHITESPACE"," ",598],"{",["T_WHITESPACE","\n                ",598],["T_VARIABLE","$resultItem",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","setQty",599],"(",["T_VARIABLE","$buyRequest",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","getQty",599],"(",")",["T_WHITESPACE"," ",599],"*",["T_WHITESPACE"," ",599],["T_LNUMBER","1",599],")",";",["T_WHITESPACE","\n                ",599],["T_VARIABLE","$resultItem",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","setOrigData",600],"(",["T_CONSTANT_ENCAPSED_STRING","'qty'",600],",",["T_WHITESPACE"," ",600],["T_LNUMBER","0",600],")",";",["T_WHITESPACE","\n            ",600],"}",["T_WHITESPACE","\n        ",601],"}",["T_WHITESPACE"," ",602],["T_ELSE","else",602],["T_WHITESPACE"," ",602],"{",["T_WHITESPACE","\n            ",602],["T_STRING","Mage",603],["T_DOUBLE_COLON","::",603],["T_STRING","throwException",603],"(",["T_STRING","Mage",603],["T_DOUBLE_COLON","::",603],["T_STRING","helper",603],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",603],")",["T_OBJECT_OPERATOR","->",603],["T_STRING","__",603],"(",["T_CONSTANT_ENCAPSED_STRING","'The product does not exist.'",603],")",")",";",["T_WHITESPACE","\n        ",603],"}",["T_WHITESPACE","\n        ",604],["T_RETURN","return",605],["T_WHITESPACE"," ",605],["T_VARIABLE","$this",605],";",["T_WHITESPACE","\n    ",605],"}",["T_WHITESPACE","\n\n    ",606],["T_DOC_COMMENT","\/**\n     * Save wishlist.\n     *\n     * @return Mage_Wishlist_Model_Wishlist\n     *\/",608],["T_WHITESPACE","\n    ",612],["T_PUBLIC","public",613],["T_WHITESPACE"," ",613],["T_FUNCTION","function",613],["T_WHITESPACE"," ",613],["T_STRING","save",613],"(",")",["T_WHITESPACE","\n    ",613],"{",["T_WHITESPACE","\n        ",614],["T_VARIABLE","$this",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","_hasDataChanges",615],["T_WHITESPACE"," ",615],"=",["T_WHITESPACE"," ",615],["T_STRING","true",615],";",["T_WHITESPACE","\n        ",615],["T_RETURN","return",616],["T_WHITESPACE"," ",616],["T_STRING","parent",616],["T_DOUBLE_COLON","::",616],["T_STRING","save",616],"(",")",";",["T_WHITESPACE","\n    ",616],"}",["T_WHITESPACE","\n",617],"}",["T_WHITESPACE","\n",618]]