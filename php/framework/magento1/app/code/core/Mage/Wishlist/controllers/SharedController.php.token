[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Wishlist\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Wishlist shared items controllers\n *\n * @category    Mage\n * @package     Mage_Wishlist\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Wishlist_SharedController",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Wishlist_Controller_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Is need check a Formkey\n     * @var bool\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_isCheckFormKey",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","false",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Retrieve wishlist instance by requested code\n     *\n     * @return Mage_Wishlist_Model_Wishlist|false\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","_getWishlist",48],"(",")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$code",50],["T_WHITESPACE","     ",50],"=",["T_WHITESPACE"," ",50],["T_STRING_CAST","(string)",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getRequest",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","getParam",50],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",50],")",";",["T_WHITESPACE","\n        ",50],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_EMPTY","empty",51],"(",["T_VARIABLE","$code",51],")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n            ",51],["T_RETURN","return",52],["T_WHITESPACE"," ",52],["T_STRING","false",52],";",["T_WHITESPACE","\n        ",52],"}",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$wishlist",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","Mage",55],["T_DOUBLE_COLON","::",55],["T_STRING","getModel",55],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/wishlist'",55],")",["T_OBJECT_OPERATOR","->",55],["T_STRING","loadByCode",55],"(",["T_VARIABLE","$code",55],")",";",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(","!",["T_VARIABLE","$wishlist",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getId",56],"(",")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_STRING","false",57],";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n\n        ",58],["T_STRING","Mage",60],["T_DOUBLE_COLON","::",60],["T_STRING","getSingleton",60],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",60],")",["T_OBJECT_OPERATOR","->",60],["T_STRING","setSharedWishlist",60],"(",["T_VARIABLE","$code",60],")",";",["T_WHITESPACE","\n\n        ",60],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$wishlist",62],";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Shared wishlist view page\n     *\n     *\/",65],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","indexAction",69],"(",")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$wishlist",71],["T_WHITESPACE","   ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_getWishlist",71],"(",")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$customerId",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","getSingleton",72],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",72],")",["T_OBJECT_OPERATOR","->",72],["T_STRING","getCustomerId",72],"(",")",";",["T_WHITESPACE","\n\n        ",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$wishlist",74],["T_WHITESPACE"," ",74],["T_BOOLEAN_AND","&&",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$wishlist",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getCustomerId",74],"(",")",["T_WHITESPACE"," ",74],["T_BOOLEAN_AND","&&",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$wishlist",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getCustomerId",74],"(",")",["T_WHITESPACE"," ",74],["T_IS_EQUAL","==",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$customerId",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_redirectUrl",75],"(",["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","helper",75],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","getListUrl",75],"(",["T_VARIABLE","$wishlist",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getId",75],"(",")",")",")",";",["T_WHITESPACE","\n            ",75],["T_RETURN","return",76],";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n\n        ",77],["T_STRING","Mage",79],["T_DOUBLE_COLON","::",79],["T_STRING","register",79],"(",["T_CONSTANT_ENCAPSED_STRING","'shared_wishlist'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$wishlist",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","loadLayout",81],"(",")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_initLayoutMessages",82],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",82],")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_initLayoutMessages",83],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/session'",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","renderLayout",84],"(",")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Add shared wishlist item to shopping cart\n     *\n     * If Product has required options - redirect\n     * to product view page with message about needed defined required options\n     *\n     *\/",87],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","cartAction",94],"(",")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$itemId",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_INT_CAST","(int)",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getRequest",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","getParam",96],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",96],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$code",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getRequest",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getParam",97],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_COMMENT","\/* @var $item Mage_Wishlist_Model_Item *\/",99],["T_WHITESPACE","\n        ",99],["T_VARIABLE","$item",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","Mage",100],["T_DOUBLE_COLON","::",100],["T_STRING","getModel",100],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/item'",100],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","load",100],"(",["T_VARIABLE","$itemId",100],")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$wishlist",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_STRING","Mage",101],["T_DOUBLE_COLON","::",101],["T_STRING","getModel",101],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/wishlist'",101],")",["T_OBJECT_OPERATOR","->",101],["T_STRING","loadByCode",101],"(",["T_VARIABLE","$code",101],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$redirectUrl",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","Mage",102],["T_DOUBLE_COLON","::",102],["T_STRING","getUrl",102],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/index'",102],",",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$code",102],")",")",";",["T_WHITESPACE","\n\n        ",102],["T_COMMENT","\/* @var $session Mage_Wishlist_Model_Session *\/",104],["T_WHITESPACE","\n        ",104],["T_VARIABLE","$session",105],["T_WHITESPACE","    ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","Mage",105],["T_DOUBLE_COLON","::",105],["T_STRING","getSingleton",105],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/session'",105],")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$cart",106],["T_WHITESPACE","       ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","Mage",106],["T_DOUBLE_COLON","::",106],["T_STRING","getSingleton",106],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",106],")",";",["T_WHITESPACE","\n\n        ",106],["T_TRY","try",108],["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$options",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","Mage",109],["T_DOUBLE_COLON","::",109],["T_STRING","getModel",109],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist\/item_option'",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","getCollection",109],"(",")",["T_WHITESPACE","\n                    ",109],["T_OBJECT_OPERATOR","->",110],["T_STRING","addItemFilter",110],"(",["T_ARRAY","array",110],"(",["T_VARIABLE","$itemId",110],")",")",";",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$item",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setOptions",111],"(",["T_VARIABLE","$options",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getOptionsByItem",111],"(",["T_VARIABLE","$itemId",111],")",")",";",["T_WHITESPACE","\n\n            ",111],["T_VARIABLE","$item",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","addToCart",113],"(",["T_VARIABLE","$cart",113],")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$cart",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","save",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","getQuote",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","collectTotals",114],"(",")",";",["T_WHITESPACE","\n\n            ",114],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_STRING","Mage",116],["T_DOUBLE_COLON","::",116],["T_STRING","helper",116],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",116],")",["T_OBJECT_OPERATOR","->",116],["T_STRING","getShouldRedirectToCart",116],"(",")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                ",116],["T_VARIABLE","$redirectUrl",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","Mage",117],["T_DOUBLE_COLON","::",117],["T_STRING","helper",117],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",117],")",["T_OBJECT_OPERATOR","->",117],["T_STRING","getCartUrl",117],"(",")",";",["T_WHITESPACE","\n            ",117],"}",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE"," ",119],["T_CATCH","catch",119],["T_WHITESPACE"," ",119],"(",["T_STRING","Mage_Core_Exception",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$e",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$e",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getCode",120],"(",")",["T_WHITESPACE"," ",120],["T_IS_EQUAL","==",120],["T_WHITESPACE"," ",120],["T_STRING","Mage_Wishlist_Model_Item",120],["T_DOUBLE_COLON","::",120],["T_STRING","EXCEPTION_CODE_NOT_SALABLE",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                ",120],["T_VARIABLE","$session",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","addError",121],"(",["T_STRING","Mage",121],["T_DOUBLE_COLON","::",121],["T_STRING","helper",121],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",121],")",["T_OBJECT_OPERATOR","->",121],["T_STRING","__",121],"(",["T_CONSTANT_ENCAPSED_STRING","'This product(s) is currently out of stock'",121],")",")",";",["T_WHITESPACE","\n            ",121],"}",["T_WHITESPACE"," ",122],["T_ELSEIF","elseif",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$e",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getCode",122],"(",")",["T_WHITESPACE"," ",122],["T_IS_EQUAL","==",122],["T_WHITESPACE"," ",122],["T_STRING","Mage_Wishlist_Model_Item",122],["T_DOUBLE_COLON","::",122],["T_STRING","EXCEPTION_CODE_NOT_SPECIFIED_PRODUCT",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(","!",["T_VARIABLE","$wishlist",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getItemsCount",123],"(",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                    ",123],["T_VARIABLE","$redirectUrl",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","Mage",124],["T_DOUBLE_COLON","::",124],["T_STRING","helper",124],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","getCartUrl",124],"(",")",";",["T_WHITESPACE","\n                    ",124],["T_VARIABLE","$session",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","Mage",125],["T_DOUBLE_COLON","::",125],["T_STRING","getSingleton",125],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/session'",125],")",";",["T_WHITESPACE","\n                ",125],"}",["T_WHITESPACE","\n                ",126],["T_VARIABLE","$message",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","helper",127],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",127],")",["T_OBJECT_OPERATOR","->",127],["T_STRING","__",127],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot add the selected product to shopping cart because the product was removed from the wishlist'",127],")",";",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$session",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","addNotice",128],"(",["T_VARIABLE","$message",128],")",";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_STRING","Mage",130],["T_DOUBLE_COLON","::",130],["T_STRING","getSingleton",130],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/session'",130],")",["T_OBJECT_OPERATOR","->",130],["T_STRING","addNotice",130],"(",["T_VARIABLE","$e",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getMessage",130],"(",")",")",";",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$redirectUrl",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$item",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getProductUrl",131],"(",")",";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE"," ",133],["T_CATCH","catch",133],["T_WHITESPACE"," ",133],"(",["T_STRING","Exception",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$e",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$session",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","addException",134],"(",["T_VARIABLE","$e",134],",",["T_WHITESPACE"," ",134],["T_STRING","Mage",134],["T_DOUBLE_COLON","::",134],["T_STRING","helper",134],"(",["T_CONSTANT_ENCAPSED_STRING","'wishlist'",134],")",["T_OBJECT_OPERATOR","->",134],["T_STRING","__",134],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot add item to shopping cart'",134],")",")",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n\n        ",135],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_redirectUrl",137],"(",["T_VARIABLE","$redirectUrl",137],")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n",138],"}",["T_WHITESPACE","\n",139]]