[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Weee\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * WEEE data helper\n *\n * @category Mage\n * @package  Mage_Weee\n * @author   Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Weee_Helper_Data",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Helper_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Config Path for FPT\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","XML_PATH_FPT_ENABLED",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/enable'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     *'FPT Tax Configuration' for TAXED\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","TAXED",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'1'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     *'FPT Tax Configuration' for LOADED_AND_DISPLAY_WITH_TAX\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_CONST","const",50],["T_WHITESPACE"," ",50],["T_STRING","LOADED_AND_DISPLAY_WITH_TAX",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'2'",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Current store, in the case of backend order, it could be different from admin store\n     *\n     * @var Mage_Core_Model_Store\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_store",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",59],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_storeDisplayConfig",62],["T_WHITESPACE","   ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",")",";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Get weee amount display type on product view page\n     *\n     * @param   mixed $store\n     * @return  int\n     *\/",64],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","getPriceDisplayType",70],"(",["T_VARIABLE","$store",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","null",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","getStoreConfig",72],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/display'",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$store",72],")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Get weee amount display type on product list page\n     *\n     * @param   mixed $store\n     * @return  int\n     *\/",75],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","getListPriceDisplayType",81],"(",["T_VARIABLE","$store",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","null",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_STRING","Mage",83],["T_DOUBLE_COLON","::",83],["T_STRING","getStoreConfig",83],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/display_list'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$store",83],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Get weee amount display type in sales modules\n     *\n     * @param   mixed $store\n     * @return  int\n     *\/",86],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","getSalesPriceDisplayType",92],"(",["T_VARIABLE","$store",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","null",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","getStoreConfig",94],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/display_sales'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$store",94],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Get weee amount display type in email templates\n     *\n     * @param   mixed $store\n     * @return  int\n     *\/",97],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","getEmailPriceDisplayType",103],"(",["T_VARIABLE","$store",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","null",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_STRING","Mage",105],["T_DOUBLE_COLON","::",105],["T_STRING","getStoreConfig",105],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/display_email'",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$store",105],")",";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Check if weee tax amount should be discounted\n     *\n     * @param   mixed $store\n     * @return  bool\n     *\/",108],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","isDiscounted",114],"(",["T_VARIABLE","$store",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","null",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_STRING","Mage",116],["T_DOUBLE_COLON","::",116],["T_STRING","getStoreConfigFlag",116],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/discount'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$store",116],")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Check if weee tax amount should be taxable\n     *\n     * @param   mixed $store\n     * @return  bool\n     *\/",119],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","isTaxable",125],"(",["T_VARIABLE","$store",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","null",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","getStoreConfig",127],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/apply_vat'",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$store",127],")",["T_WHITESPACE"," ",127],["T_IS_EQUAL","==",127],["T_WHITESPACE"," ",127],["T_STRING","self",127],["T_DOUBLE_COLON","::",127],["T_STRING","TAXED",127],["T_WHITESPACE"," ",127],["T_BOOLEAN_OR","||",127],["T_WHITESPACE","\n            ",127],["T_STRING","Mage",128],["T_DOUBLE_COLON","::",128],["T_STRING","getStoreConfig",128],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/apply_vat'",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$store",128],")",["T_WHITESPACE"," ",128],["T_IS_EQUAL","==",128],["T_WHITESPACE"," ",128],["T_STRING","self",128],["T_DOUBLE_COLON","::",128],["T_STRING","LOADED_AND_DISPLAY_WITH_TAX",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Returns true if default store tax is already applied to the FPT(weee)\n     *\n     * @param mixed $store\n     * @return bool\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","isTaxIncluded",137],"(",["T_VARIABLE","$store",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","null",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_STRING","Mage",139],["T_DOUBLE_COLON","::",139],["T_STRING","getStoreConfig",139],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/apply_vat'",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$store",139],")",["T_WHITESPACE"," ",139],["T_IS_EQUAL","==",139],["T_WHITESPACE"," ",139],["T_STRING","self",139],["T_DOUBLE_COLON","::",139],["T_STRING","LOADED_AND_DISPLAY_WITH_TAX",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Get Weee Tax Configuration Type\n     *\n     * @param   mixed $store\n     * @return  int\n     *\/",142],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","getTaxType",148],"(",["T_VARIABLE","$store",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","null",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_STRING","Mage",150],["T_DOUBLE_COLON","::",150],["T_STRING","getStoreConfig",150],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/apply_vat'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$store",150],")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Check if weee tax amount should be included to subtotal\n     *\n     * @param   mixed $store\n     * @return  bool\n     *\/",153],["T_WHITESPACE","\n    ",158],["T_PUBLIC","public",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","includeInSubtotal",159],"(",["T_VARIABLE","$store",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","null",159],")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","getStoreConfigFlag",161],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/weee\/include_in_subtotal'",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$store",161],")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Get weee tax amount for product based on shipping and billing addresses, website and tax settings\n     *\n     * @param   Mage_Catalog_Model_Product $product\n     * @param   null|Mage_Customer_Model_Address_Abstract $shipping\n     * @param   null|Mage_Customer_Model_Address_Abstract $billing\n     * @param   mixed $website\n     * @param   bool $calculateTaxes\n     * @return  float\n     *\/",164],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","getAmount",174],"(",["T_VARIABLE","$product",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$shipping",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","null",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$billing",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","null",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$website",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","null",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$calculateTaxes",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","false",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","isEnabled",176],"(",")",")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_STRING","Mage",177],["T_DOUBLE_COLON","::",177],["T_STRING","getSingleton",177],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",177],")",["T_OBJECT_OPERATOR","->",177],["T_WHITESPACE","\n                ",177],["T_STRING","getWeeeAmount",178],"(",["T_VARIABLE","$product",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$shipping",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$billing",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$website",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$calculateTaxes",178],")",";",["T_WHITESPACE","\n        ",178],"}",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_LNUMBER","0",180],";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Returns diaplay type for price accordingly to current zone\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param array|null                 $compareTo\n     * @param string                     $zone\n     * @param Mage_Core_Model_Store      $store\n     * @return bool|int\n     *\/",183],["T_WHITESPACE","\n    ",191],["T_PUBLIC","public",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","typeOfDisplay",192],"(",["T_VARIABLE","$product",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$compareTo",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","null",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$zone",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","null",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$store",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","null",192],")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(","!",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","isEnabled",194],"(",["T_VARIABLE","$store",194],")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_STRING","false",195],";",["T_WHITESPACE","\n        ",195],"}",["T_WHITESPACE","\n        ",196],["T_SWITCH","switch",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$zone",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n            ",197],["T_CASE","case",198],["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'product_view'",198],":",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$type",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getPriceDisplayType",199],"(",["T_VARIABLE","$store",199],")",";",["T_WHITESPACE","\n                ",199],["T_BREAK","break",200],";",["T_WHITESPACE","\n            ",200],["T_CASE","case",201],["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'product_list'",201],":",["T_WHITESPACE","\n                ",201],["T_VARIABLE","$type",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getListPriceDisplayType",202],"(",["T_VARIABLE","$store",202],")",";",["T_WHITESPACE","\n                ",202],["T_BREAK","break",203],";",["T_WHITESPACE","\n            ",203],["T_CASE","case",204],["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'sales'",204],":",["T_WHITESPACE","\n                ",204],["T_VARIABLE","$type",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getSalesPriceDisplayType",205],"(",["T_VARIABLE","$store",205],")",";",["T_WHITESPACE","\n                ",205],["T_BREAK","break",206],";",["T_WHITESPACE","\n            ",206],["T_CASE","case",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'email'",207],":",["T_WHITESPACE","\n                ",207],["T_VARIABLE","$type",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getEmailPriceDisplayType",208],"(",["T_VARIABLE","$store",208],")",";",["T_WHITESPACE","\n                ",208],["T_BREAK","break",209],";",["T_WHITESPACE","\n            ",209],["T_DEFAULT","default",210],":",["T_WHITESPACE","\n                ",210],["T_IF","if",211],["T_WHITESPACE"," ",211],"(",["T_STRING","Mage",211],["T_DOUBLE_COLON","::",211],["T_STRING","registry",211],"(",["T_CONSTANT_ENCAPSED_STRING","'current_product'",211],")",")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n                    ",211],["T_VARIABLE","$type",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getPriceDisplayType",212],"(",["T_VARIABLE","$store",212],")",";",["T_WHITESPACE","\n                ",212],"}",["T_WHITESPACE"," ",213],["T_ELSE","else",213],["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                    ",213],["T_VARIABLE","$type",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getListPriceDisplayType",214],"(",["T_VARIABLE","$store",214],")",";",["T_WHITESPACE","\n                ",214],"}",["T_WHITESPACE","\n                ",215],["T_BREAK","break",216],";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE","\n\n        ",217],["T_IF","if",219],["T_WHITESPACE"," ",219],"(",["T_STRING","is_null",219],"(",["T_VARIABLE","$compareTo",219],")",")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n            ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$type",220],";",["T_WHITESPACE","\n        ",220],"}",["T_WHITESPACE"," ",221],["T_ELSE","else",221],["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(",["T_STRING","is_array",222],"(",["T_VARIABLE","$compareTo",222],")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n                ",222],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_STRING","in_array",223],"(",["T_VARIABLE","$type",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$compareTo",223],")",";",["T_WHITESPACE","\n            ",223],"}",["T_WHITESPACE"," ",224],["T_ELSE","else",224],["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                ",224],["T_RETURN","return",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$type",225],["T_WHITESPACE"," ",225],["T_IS_EQUAL","==",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$compareTo",225],";",["T_WHITESPACE","\n            ",225],"}",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_DOC_COMMENT","\/**\n     * Proxy for Mage_Weee_Model_Tax::getProductWeeeAttributes()\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param null|false|Varien_Object   $shipping\n     * @param null|false|Varien_Object   $billing\n     * @param Mage_Core_Model_Website    $website\n     * @param bool                       $calculateTaxes\n     * @return array\n     *\/",230],["T_WHITESPACE","\n    ",239],["T_PUBLIC","public",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","getProductWeeeAttributes",240],"(",["T_VARIABLE","$product",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$shipping",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","null",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$billing",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","null",240],",",["T_WHITESPACE","\n                                             ",240],["T_VARIABLE","$website",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","null",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$calculateTaxes",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","false",241],")",["T_WHITESPACE","\n    ",241],"{",["T_WHITESPACE","\n        ",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","getSingleton",243],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",243],")",["T_WHITESPACE","\n            ",243],["T_OBJECT_OPERATOR","->",244],["T_STRING","getProductWeeeAttributes",244],"(",["T_VARIABLE","$product",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$shipping",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$billing",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$website",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$calculateTaxes",244],")",";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Returns applied weee taxes\n     *\n     * @param Mage_Sales_Model_Quote_Item_Abstract $item\n     * @return array\n     *\/",247],["T_WHITESPACE","\n    ",252],["T_PUBLIC","public",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","getApplied",253],"(",["T_VARIABLE","$item",253],")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$item",255],["T_WHITESPACE"," ",255],["T_INSTANCEOF","instanceof",255],["T_WHITESPACE"," ",255],["T_STRING","Mage_Sales_Model_Quote_Item_Abstract",255],")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n            ",255],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_VARIABLE","$item",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getHasChildren",256],"(",")",["T_WHITESPACE"," ",256],["T_BOOLEAN_AND","&&",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$item",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","isChildrenCalculated",256],"(",")",")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n                ",256],["T_VARIABLE","$result",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_ARRAY","array",257],"(",")",";",["T_WHITESPACE","\n                ",257],["T_FOREACH","foreach",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$item",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getChildren",258],"(",")",["T_WHITESPACE"," ",258],["T_AS","as",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$child",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                    ",258],["T_VARIABLE","$childData",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getApplied",259],"(",["T_VARIABLE","$child",259],")",";",["T_WHITESPACE","\n                    ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_STRING","is_array",260],"(",["T_VARIABLE","$childData",260],")",")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n                        ",260],["T_VARIABLE","$result",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","array_merge",261],"(",["T_VARIABLE","$result",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$childData",261],")",";",["T_WHITESPACE","\n                    ",261],"}",["T_WHITESPACE","\n                ",262],"}",["T_WHITESPACE","\n                ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$result",264],";",["T_WHITESPACE","\n            ",264],"}",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n\n        ",266],["T_DOC_COMMENT","\/**\n         * if order item data is old enough then weee_tax_applied cab be\n         * not valid serialized data\n         *\/",268],["T_WHITESPACE","\n        ",271],["T_VARIABLE","$data",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$item",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getWeeeTaxApplied",272],"(",")",";",["T_WHITESPACE","\n        ",272],["T_IF","if",273],["T_WHITESPACE"," ",273],"(",["T_EMPTY","empty",273],"(",["T_VARIABLE","$data",273],")",")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n            ",273],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_ARRAY","array",274],"(",")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE","\n        ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_STRING","unserialize",276],"(",["T_VARIABLE","$item",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getWeeeTaxApplied",276],"(",")",")",";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n\n    ",277],["T_DOC_COMMENT","\/**\n     * Sets applied weee taxes\n     *\n     * @param Mage_Sales_Model_Quote_Item_Abstract $item\n     * @param array                                $value\n     * @return Mage_Weee_Helper_Data\n     *\/",279],["T_WHITESPACE","\n    ",285],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","setApplied",286],"(",["T_VARIABLE","$item",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$value",286],")",["T_WHITESPACE","\n    ",286],"{",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$item",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","setWeeeTaxApplied",288],"(",["T_STRING","serialize",288],"(",["T_VARIABLE","$value",288],")",")",";",["T_WHITESPACE","\n        ",288],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_DOC_COMMENT","\/**\n     * Returns array of weee attributes allowed for display\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return array\n     *\/",292],["T_WHITESPACE","\n    ",297],["T_PUBLIC","public",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","getProductWeeeAttributesForDisplay",298],"(",["T_VARIABLE","$product",298],")",["T_WHITESPACE","\n    ",298],"{",["T_WHITESPACE","\n        ",299],["T_IF","if",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","isEnabled",300],"(",")",")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n            ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getProductWeeeAttributes",301],"(",["T_VARIABLE","$product",301],",",["T_WHITESPACE"," ",301],["T_STRING","null",301],",",["T_WHITESPACE"," ",301],["T_STRING","null",301],",",["T_WHITESPACE"," ",301],["T_STRING","null",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","typeOfDisplay",301],"(",["T_VARIABLE","$product",301],",",["T_WHITESPACE"," ",301],["T_LNUMBER","1",301],")",")",";",["T_WHITESPACE","\n        ",301],"}",["T_WHITESPACE","\n        ",302],["T_RETURN","return",303],["T_WHITESPACE"," ",303],["T_ARRAY","array",303],"(",")",";",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n\n    ",304],["T_DOC_COMMENT","\/**\n     * Get Product Weee attributes for price renderer\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param null|false|Varien_Object $shipping Shipping Address\n     * @param null|false|Varien_Object $billing Billing Address\n     * @param null|Mage_Core_Model_Website $website\n     * @param mixed $calculateTaxes\n     * @return array\n     *\/",306],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","getProductWeeeAttributesForRenderer",316],"(",["T_VARIABLE","$product",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$shipping",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","null",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$billing",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","null",316],",",["T_WHITESPACE","\n                                                        ",316],["T_VARIABLE","$website",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","null",317],",",["T_WHITESPACE"," ",317],["T_VARIABLE","$calculateTaxes",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","false",317],")",["T_WHITESPACE","\n    ",317],"{",["T_WHITESPACE","\n        ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","isEnabled",319],"(",")",")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n            ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getProductWeeeAttributes",320],"(",["T_WHITESPACE","\n                ",320],["T_VARIABLE","$product",321],",",["T_WHITESPACE","\n                ",321],["T_VARIABLE","$shipping",322],",",["T_WHITESPACE","\n                ",322],["T_VARIABLE","$billing",323],",",["T_WHITESPACE","\n                ",323],["T_VARIABLE","$website",324],",",["T_WHITESPACE","\n                ",324],["T_VARIABLE","$calculateTaxes",325],["T_WHITESPACE"," ",325],"?",["T_WHITESPACE"," ",325],["T_VARIABLE","$calculateTaxes",325],["T_WHITESPACE"," ",325],":",["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","typeOfDisplay",325],"(",["T_VARIABLE","$product",325],",",["T_WHITESPACE"," ",325],["T_LNUMBER","1",325],")",["T_WHITESPACE","\n            ",325],")",";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n        ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_ARRAY","array",328],"(",")",";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n\n    ",329],["T_DOC_COMMENT","\/**\n     * Returns amount to display excluding taxes\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return float\n     *\/",331],["T_WHITESPACE","\n    ",336],["T_PUBLIC","public",337],["T_WHITESPACE"," ",337],["T_FUNCTION","function",337],["T_WHITESPACE"," ",337],["T_STRING","getAmountForDisplay",337],"(",["T_VARIABLE","$product",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","isEnabled",339],"(",")",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$attributes",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getProductWeeeAttributesForRenderer",340],"(",["T_VARIABLE","$product",340],",",["T_WHITESPACE","\n                ",340],["T_STRING","null",341],",",["T_WHITESPACE"," ",341],["T_STRING","null",341],",",["T_WHITESPACE"," ",341],["T_STRING","null",341],",",["T_WHITESPACE"," ",341],["T_STRING","true",341],")",";",["T_WHITESPACE","\n\n            ",341],["T_IF","if",343],["T_WHITESPACE"," ",343],"(",["T_STRING","is_array",343],"(",["T_VARIABLE","$attributes",343],")",")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n                ",343],["T_VARIABLE","$amount",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_LNUMBER","0",344],";",["T_WHITESPACE","\n                ",344],["T_FOREACH","foreach",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$attributes",345],["T_WHITESPACE"," ",345],["T_AS","as",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$attribute",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n                    ",345],["T_COMMENT","\/* @var $attribute Varien_Object *\/",346],["T_WHITESPACE","\n                    ",346],["T_VARIABLE","$amount",347],["T_WHITESPACE"," ",347],["T_PLUS_EQUAL","+=",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$attribute",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getAmount",347],"(",")",";",["T_WHITESPACE","\n                ",347],"}",["T_WHITESPACE","\n                ",348],["T_RETURN","return",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$amount",349],";",["T_WHITESPACE","\n            ",349],"}",["T_WHITESPACE","\n        ",350],"}",["T_WHITESPACE","\n        ",351],["T_RETURN","return",352],["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],";",["T_WHITESPACE","\n    ",352],"}",["T_WHITESPACE","\n\n    ",353],["T_DOC_COMMENT","\/**\n     * Returns amount to display including taxes\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return float\n     *\/",355],["T_WHITESPACE","\n    ",360],["T_PUBLIC","public",361],["T_WHITESPACE"," ",361],["T_FUNCTION","function",361],["T_WHITESPACE"," ",361],["T_STRING","getAmountForDisplayInclTaxes",361],"(",["T_VARIABLE","$product",361],")",["T_WHITESPACE","\n    ",361],"{",["T_WHITESPACE","\n        ",362],["T_IF","if",363],["T_WHITESPACE"," ",363],"(",["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","isEnabled",363],"(",")",")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n            ",363],["T_VARIABLE","$attributes",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getProductWeeeAttributesForRenderer",364],"(",["T_VARIABLE","$product",364],",",["T_WHITESPACE","\n                ",364],["T_STRING","null",365],",",["T_WHITESPACE"," ",365],["T_STRING","null",365],",",["T_WHITESPACE"," ",365],["T_STRING","null",365],",",["T_WHITESPACE"," ",365],["T_STRING","true",365],")",";",["T_WHITESPACE","\n            ",365],["T_RETURN","return",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getAmountInclTaxes",366],"(",["T_VARIABLE","$attributes",366],")",";",["T_WHITESPACE","\n        ",366],"}",["T_WHITESPACE","\n        ",367],["T_RETURN","return",368],["T_WHITESPACE"," ",368],["T_LNUMBER","0",368],";",["T_WHITESPACE","\n    ",368],"}",["T_WHITESPACE","\n\n    ",369],["T_DOC_COMMENT","\/**\n     * Returns original amount\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return int\n     *\/",371],["T_WHITESPACE","\n    ",376],["T_PUBLIC","public",377],["T_WHITESPACE"," ",377],["T_FUNCTION","function",377],["T_WHITESPACE"," ",377],["T_STRING","getOriginalAmount",377],"(",["T_VARIABLE","$product",377],")",["T_WHITESPACE","\n    ",377],"{",["T_WHITESPACE","\n        ",378],["T_IF","if",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","isEnabled",379],"(",")",")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n            ",379],["T_RETURN","return",380],["T_WHITESPACE"," ",380],["T_STRING","Mage",380],["T_DOUBLE_COLON","::",380],["T_STRING","getModel",380],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",380],")",["T_OBJECT_OPERATOR","->",380],["T_STRING","getWeeeAmount",380],"(",["T_VARIABLE","$product",380],",",["T_WHITESPACE"," ",380],["T_STRING","null",380],",",["T_WHITESPACE"," ",380],["T_STRING","null",380],",",["T_WHITESPACE"," ",380],["T_STRING","null",380],",",["T_WHITESPACE"," ",380],["T_STRING","false",380],",",["T_WHITESPACE"," ",380],["T_STRING","true",380],")",";",["T_WHITESPACE","\n        ",380],"}",["T_WHITESPACE","\n        ",381],["T_RETURN","return",382],["T_WHITESPACE"," ",382],["T_LNUMBER","0",382],";",["T_WHITESPACE","\n    ",382],"}",["T_WHITESPACE","\n\n    ",383],["T_DOC_COMMENT","\/**\n     * Adds HTML containers and formats tier prices accordingly to the currency used\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param array                      $tierPrices\n     * @param boolean                    $includeIndex\n     * @return Mage_Weee_Helper_Data\n     *\/",385],["T_WHITESPACE","\n    ",392],["T_PUBLIC","public",393],["T_WHITESPACE"," ",393],["T_FUNCTION","function",393],["T_WHITESPACE"," ",393],["T_STRING","processTierPrices",393],"(",["T_VARIABLE","$product",393],",",["T_WHITESPACE"," ",393],"&",["T_VARIABLE","$tierPrices",393],",",["T_WHITESPACE"," ",393],["T_VARIABLE","$includeIndex",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_STRING","true",393],")",["T_WHITESPACE","\n    ",393],"{",["T_WHITESPACE","\n        ",394],["T_VARIABLE","$weeeAmountInclTax",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","getAmountForDisplayInclTaxes",395],"(",["T_VARIABLE","$product",395],")",";",["T_WHITESPACE","\n        ",395],["T_VARIABLE","$weeeAmount",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getAmountForDisplay",396],"(",["T_VARIABLE","$product",396],")",";",["T_WHITESPACE","\n        ",396],["T_VARIABLE","$store",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_STRING","Mage",397],["T_DOUBLE_COLON","::",397],["T_STRING","app",397],"(",")",["T_OBJECT_OPERATOR","->",397],["T_STRING","getStore",397],"(",")",";",["T_WHITESPACE","\n        ",397],["T_FOREACH","foreach",398],["T_WHITESPACE"," ",398],"(",["T_VARIABLE","$tierPrices",398],["T_WHITESPACE"," ",398],["T_AS","as",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$index",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],"&",["T_VARIABLE","$tier",398],")",["T_WHITESPACE"," ",398],"{",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$spanTag",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_CONSTANT_ENCAPSED_STRING","'<span class=\"price tier-'",399],["T_WHITESPACE"," ",399],".",["T_WHITESPACE"," ",399],"(",["T_VARIABLE","$includeIndex",399],["T_WHITESPACE"," ",399],"?",["T_WHITESPACE"," ",399],["T_VARIABLE","$index",399],["T_WHITESPACE"," ",399],":",["T_WHITESPACE"," ",399],["T_CONSTANT_ENCAPSED_STRING","'fixed'",399],")",";",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$html",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_VARIABLE","$store",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","formatPrice",400],"(",["T_VARIABLE","$store",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","convertPrice",400],"(",["T_WHITESPACE","\n                ",400],["T_STRING","Mage",401],["T_DOUBLE_COLON","::",401],["T_STRING","helper",401],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",401],")",["T_OBJECT_OPERATOR","->",401],["T_STRING","getPrice",401],"(",["T_VARIABLE","$product",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$tier",401],"[",["T_CONSTANT_ENCAPSED_STRING","'website_price'",401],"]",",",["T_WHITESPACE"," ",401],["T_STRING","true",401],")",["T_WHITESPACE"," ",401],"+",["T_WHITESPACE"," ",401],["T_VARIABLE","$weeeAmountInclTax",401],")",",",["T_WHITESPACE"," ",401],["T_STRING","false",401],")",";",["T_WHITESPACE","\n            ",401],["T_VARIABLE","$tier",402],"[",["T_CONSTANT_ENCAPSED_STRING","'formated_price_incl_weee'",402],"]",["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_VARIABLE","$spanTag",402],["T_WHITESPACE"," ",402],".",["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'-incl-tax\">'",402],["T_WHITESPACE"," ",402],".",["T_WHITESPACE"," ",402],["T_VARIABLE","$html",402],["T_WHITESPACE"," ",402],".",["T_WHITESPACE"," ",402],["T_CONSTANT_ENCAPSED_STRING","'<\/span>'",402],";",["T_WHITESPACE","\n            ",402],["T_VARIABLE","$html",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_VARIABLE","$store",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","formatPrice",403],"(",["T_VARIABLE","$store",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","convertPrice",403],"(",["T_WHITESPACE","\n                ",403],["T_STRING","Mage",404],["T_DOUBLE_COLON","::",404],["T_STRING","helper",404],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",404],")",["T_OBJECT_OPERATOR","->",404],["T_STRING","getPrice",404],"(",["T_VARIABLE","$product",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$tier",404],"[",["T_CONSTANT_ENCAPSED_STRING","'website_price'",404],"]",")",["T_WHITESPACE"," ",404],"+",["T_WHITESPACE"," ",404],["T_VARIABLE","$weeeAmount",404],")",",",["T_WHITESPACE"," ",404],["T_STRING","false",404],")",";",["T_WHITESPACE","\n            ",404],["T_VARIABLE","$tier",405],"[",["T_CONSTANT_ENCAPSED_STRING","'formated_price_incl_weee_only'",405],"]",["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_VARIABLE","$spanTag",405],["T_WHITESPACE"," ",405],".",["T_WHITESPACE"," ",405],["T_CONSTANT_ENCAPSED_STRING","'\">'",405],["T_WHITESPACE"," ",405],".",["T_WHITESPACE"," ",405],["T_VARIABLE","$html",405],["T_WHITESPACE"," ",405],".",["T_WHITESPACE"," ",405],["T_CONSTANT_ENCAPSED_STRING","'<\/span>'",405],";",["T_WHITESPACE","\n            ",405],["T_VARIABLE","$tier",406],"[",["T_CONSTANT_ENCAPSED_STRING","'formated_weee'",406],"]",["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$store",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","formatPrice",406],"(",["T_VARIABLE","$store",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","convertPrice",406],"(",["T_VARIABLE","$weeeAmount",406],")",")",";",["T_WHITESPACE","\n        ",406],"}",["T_WHITESPACE","\n        ",407],["T_RETURN","return",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],";",["T_WHITESPACE","\n    ",408],"}",["T_WHITESPACE","\n\n    ",409],["T_DOC_COMMENT","\/**\n     * Check if fixed taxes are used in system\n     *\n     * @param Mage_Core_Model_Store $store\n     * @return bool\n     *\/",411],["T_WHITESPACE","\n    ",416],["T_PUBLIC","public",417],["T_WHITESPACE"," ",417],["T_FUNCTION","function",417],["T_WHITESPACE"," ",417],["T_STRING","isEnabled",417],"(",["T_VARIABLE","$store",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_STRING","null",417],")",["T_WHITESPACE","\n    ",417],"{",["T_WHITESPACE","\n        ",418],["T_IF","if",419],["T_WHITESPACE"," ",419],"(",["T_VARIABLE","$store",419],["T_WHITESPACE"," ",419],["T_IS_EQUAL","==",419],["T_WHITESPACE"," ",419],["T_STRING","null",419],["T_WHITESPACE"," ",419],["T_BOOLEAN_AND","&&",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","_store",419],")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n            ",419],["T_COMMENT","\/\/This is needed when order is created from backend\n",420],["T_WHITESPACE","            ",421],["T_VARIABLE","$store",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","_store",421],";",["T_WHITESPACE","\n        ",421],"}",["T_WHITESPACE","\n        ",422],["T_RETURN","return",423],["T_WHITESPACE"," ",423],["T_STRING","Mage",423],["T_DOUBLE_COLON","::",423],["T_STRING","getStoreConfig",423],"(",["T_STRING","self",423],["T_DOUBLE_COLON","::",423],["T_STRING","XML_PATH_FPT_ENABLED",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$store",423],")",";",["T_WHITESPACE","\n    ",423],"}",["T_WHITESPACE","\n\n    ",424],["T_DOC_COMMENT","\/**\n     * Set the store for the current quote\n     *\n     * @param Mage_Core_Model_Store $store\n     *\/",426],["T_WHITESPACE","\n    ",430],["T_PUBLIC","public",431],["T_WHITESPACE"," ",431],["T_FUNCTION","function",431],["T_WHITESPACE"," ",431],["T_STRING","setStore",431],"(",["T_VARIABLE","$store",431],")",["T_WHITESPACE","\n    ",431],"{",["T_WHITESPACE","\n        ",432],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","_store",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_VARIABLE","$store",433],";",["T_WHITESPACE","\n    ",433],"}",["T_WHITESPACE","\n\n    ",434],["T_DOC_COMMENT","\/**\n     * Returns all summed weee taxes with all local taxes applied\n     *\n     * @throws Mage_Exception\n     * @param array $attributes Array of Varien_Object, result from getProductWeeeAttributes()\n     * @return float\n     *\/",436],["T_WHITESPACE","\n    ",442],["T_PUBLIC","public",443],["T_WHITESPACE"," ",443],["T_FUNCTION","function",443],["T_WHITESPACE"," ",443],["T_STRING","getAmountInclTaxes",443],"(",["T_VARIABLE","$attributes",443],")",["T_WHITESPACE","\n    ",443],"{",["T_WHITESPACE","\n        ",444],["T_IF","if",445],["T_WHITESPACE"," ",445],"(",["T_STRING","is_array",445],"(",["T_VARIABLE","$attributes",445],")",")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n            ",445],["T_VARIABLE","$amount",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_LNUMBER","0",446],";",["T_WHITESPACE","\n            ",446],["T_FOREACH","foreach",447],["T_WHITESPACE"," ",447],"(",["T_VARIABLE","$attributes",447],["T_WHITESPACE"," ",447],["T_AS","as",447],["T_WHITESPACE"," ",447],["T_VARIABLE","$attribute",447],")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n                ",447],["T_COMMENT","\/* @var $attribute Varien_Object *\/",448],["T_WHITESPACE","\n                ",448],["T_VARIABLE","$amount",449],["T_WHITESPACE"," ",449],["T_PLUS_EQUAL","+=",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$attribute",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getAmount",449],"(",")",["T_WHITESPACE"," ",449],"+",["T_WHITESPACE"," ",449],["T_VARIABLE","$attribute",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getTaxAmount",449],"(",")",";",["T_WHITESPACE","\n            ",449],"}",["T_WHITESPACE","\n        ",450],"}",["T_WHITESPACE"," ",451],["T_ELSE","else",451],["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n            ",451],["T_THROW","throw",452],["T_WHITESPACE"," ",452],["T_NEW","new",452],["T_WHITESPACE"," ",452],["T_STRING","Mage_Exception",452],"(",["T_CONSTANT_ENCAPSED_STRING","'$attributes must be an array'",452],")",";",["T_WHITESPACE","\n        ",452],"}",["T_WHITESPACE","\n\n        ",453],["T_RETURN","return",455],["T_WHITESPACE"," ",455],["T_DOUBLE_CAST","(float)",455],["T_VARIABLE","$amount",455],";",["T_WHITESPACE","\n    ",455],"}",["T_WHITESPACE","\n\n    ",456],["T_DOC_COMMENT","\/**\n     * Check if the configuration for the particular store causes conflicts\n     *\n     * @param Mage_Core_Model_Store|null $store\n     * @return boolean\n     *\/",458],["T_WHITESPACE","\n    ",463],["T_PUBLIC","public",464],["T_WHITESPACE"," ",464],["T_FUNCTION","function",464],["T_WHITESPACE"," ",464],["T_STRING","validateCatalogPricesAndFptConfiguration",464],"(",["T_VARIABLE","$store",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_STRING","null",464],")",["T_WHITESPACE","\n    ",464],"{",["T_WHITESPACE","\n        ",465],["T_COMMENT","\/\/ Check the configuration - Weee enabled and catalog display\n",466],["T_WHITESPACE","        ",467],["T_VARIABLE","$priceIncludesTax",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_getHelper",467],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",467],")",["T_OBJECT_OPERATOR","->",467],["T_STRING","priceIncludesTax",467],"(",["T_VARIABLE","$store",467],")",";",["T_WHITESPACE","\n        ",467],["T_COMMENT","\/\/ $priceIncludesTax = Mage::getStoreConfig(Mage_Tax_Model_Config::CONFIG_XML_PATH_PRICE_INCLUDES_TAX, $store);\n",468],["T_WHITESPACE","        ",469],["T_VARIABLE","$fptTaxConfig",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getTaxType",469],"(",["T_VARIABLE","$store",469],")",";",["T_WHITESPACE","\n\n        ",469],["T_COMMENT","\/\/ If FPT == Including tax & Catalog Prices Excluding Tax or\n",471],["T_WHITESPACE","        ",472],["T_COMMENT","\/\/ FPT = Taxed (Meaning - go ahead and calculate tax on fpt and Catalog Prices Include tax)\n",472],["T_WHITESPACE","        ",473],["T_RETURN","return",473],["T_WHITESPACE"," ",473],"(","(",["T_VARIABLE","$fptTaxConfig",473],["T_WHITESPACE"," ",473],["T_IS_EQUAL","==",473],["T_WHITESPACE"," ",473],["T_STRING","Mage_Tax_Model_Config",473],["T_DOUBLE_COLON","::",473],["T_STRING","FPT_LOADED_DISPLAY_WITH_TAX",473],["T_WHITESPACE"," ",473],["T_BOOLEAN_AND","&&",473],["T_WHITESPACE"," ",473],"!",["T_VARIABLE","$priceIncludesTax",473],")",["T_WHITESPACE","\n            ",473],["T_BOOLEAN_OR","||",474],["T_WHITESPACE"," ",474],"(",["T_VARIABLE","$fptTaxConfig",474],["T_WHITESPACE"," ",474],["T_IS_EQUAL","==",474],["T_WHITESPACE"," ",474],["T_STRING","Mage_Tax_Model_Config",474],["T_DOUBLE_COLON","::",474],["T_STRING","FPT_TAXED",474],["T_WHITESPACE"," ",474],["T_BOOLEAN_AND","&&",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$priceIncludesTax",474],")",")",";",["T_WHITESPACE","\n    ",474],"}",["T_WHITESPACE","\n\n    ",475],["T_DOC_COMMENT","\/**\n     * Set a value to a specific property searching FPT by title for the Item\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @param string $title\n     * @param string $property\n     * @param string $value\n     *\/",477],["T_WHITESPACE","\n    ",484],["T_PUBLIC","public",485],["T_WHITESPACE"," ",485],["T_FUNCTION","function",485],["T_WHITESPACE"," ",485],["T_STRING","setWeeeTaxesAppliedProperty",485],"(",["T_VARIABLE","$item",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$title",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$property",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$value",485],")",["T_WHITESPACE","\n    ",485],"{",["T_WHITESPACE","\n        ",486],["T_VARIABLE","$weeeTaxAppliedAmounts",487],["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","getApplied",487],"(",["T_VARIABLE","$item",487],")",";",["T_WHITESPACE","\n        ",487],["T_FOREACH","foreach",488],["T_WHITESPACE"," ",488],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",488],["T_WHITESPACE"," ",488],["T_AS","as",488],["T_WHITESPACE"," ",488],"&",["T_VARIABLE","$weeeTaxAppliedAmount",488],")",["T_WHITESPACE"," ",488],"{",["T_WHITESPACE","\n            ",488],["T_COMMENT","\/\/if the title is not set we set the value to all fields\n",489],["T_WHITESPACE","            ",490],["T_IF","if",490],["T_WHITESPACE"," ",490],"(",["T_ISSET","isset",490],"(",["T_VARIABLE","$title",490],")",")",["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n                ",490],["T_IF","if",491],["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$weeeTaxAppliedAmount",491],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",491],"]",["T_WHITESPACE"," ",491],["T_IS_EQUAL","==",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$title",491],")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n                    ",491],["T_VARIABLE","$weeeTaxAppliedAmount",492],"[",["T_VARIABLE","$property",492],"]",["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_VARIABLE","$value",492],";",["T_WHITESPACE","\n                ",492],"}",["T_WHITESPACE","\n            ",493],"}",["T_WHITESPACE"," ",494],["T_ELSE","else",494],["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n                ",494],["T_VARIABLE","$weeeTaxAppliedAmount",495],"[",["T_VARIABLE","$property",495],"]",["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_VARIABLE","$value",495],";",["T_WHITESPACE","\n            ",495],"}",["T_WHITESPACE","\n        ",496],"}",["T_WHITESPACE","\n        ",497],["T_VARIABLE","$item",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","setWeeeTaxApplied",498],"(",["T_STRING","serialize",498],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",498],")",")",";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Get the total weee tax\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",501],["T_WHITESPACE","\n    ",506],["T_PUBLIC","public",507],["T_WHITESPACE"," ",507],["T_FUNCTION","function",507],["T_WHITESPACE"," ",507],["T_STRING","getWeeeTaxInclTax",507],"(",["T_VARIABLE","$item",507],")",["T_WHITESPACE","\n    ",507],"{",["T_WHITESPACE","\n        ",508],["T_VARIABLE","$weeeTaxAppliedAmounts",509],["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getApplied",509],"(",["T_VARIABLE","$item",509],")",";",["T_WHITESPACE","\n        ",509],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_LNUMBER","0",510],";",["T_WHITESPACE","\n        ",510],["T_FOREACH","foreach",511],["T_WHITESPACE"," ",511],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",511],["T_WHITESPACE"," ",511],["T_AS","as",511],["T_WHITESPACE"," ",511],["T_VARIABLE","$weeeTaxAppliedAmount",511],")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n            ",511],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",512],["T_WHITESPACE"," ",512],["T_PLUS_EQUAL","+=",512],["T_WHITESPACE"," ",512],["T_STRING","max",512],"(",["T_VARIABLE","$weeeTaxAppliedAmount",512],"[",["T_CONSTANT_ENCAPSED_STRING","'amount_incl_tax'",512],"]",",",["T_WHITESPACE"," ",512],["T_LNUMBER","0",512],")",";",["T_WHITESPACE","\n        ",512],"}",["T_WHITESPACE","\n        ",513],["T_RETURN","return",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",514],";",["T_WHITESPACE","\n    ",514],"}",["T_WHITESPACE","\n\n    ",515],["T_DOC_COMMENT","\/**\n     * Get the total base weee tax\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",517],["T_WHITESPACE","\n    ",522],["T_PUBLIC","public",523],["T_WHITESPACE"," ",523],["T_FUNCTION","function",523],["T_WHITESPACE"," ",523],["T_STRING","getBaseWeeeTaxInclTax",523],"(",["T_VARIABLE","$item",523],")",["T_WHITESPACE","\n    ",523],"{",["T_WHITESPACE","\n        ",524],["T_VARIABLE","$weeeTaxAppliedAmounts",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","getApplied",525],"(",["T_VARIABLE","$item",525],")",";",["T_WHITESPACE","\n        ",525],["T_VARIABLE","$totalBaseWeeeTaxIncTaxApplied",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_LNUMBER","0",526],";",["T_WHITESPACE","\n        ",526],["T_FOREACH","foreach",527],["T_WHITESPACE"," ",527],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",527],["T_WHITESPACE"," ",527],["T_AS","as",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$weeeTaxAppliedAmount",527],")",["T_WHITESPACE"," ",527],"{",["T_WHITESPACE","\n            ",527],["T_VARIABLE","$totalBaseWeeeTaxIncTaxApplied",528],["T_WHITESPACE"," ",528],["T_PLUS_EQUAL","+=",528],["T_WHITESPACE"," ",528],["T_STRING","max",528],"(",["T_VARIABLE","$weeeTaxAppliedAmount",528],"[",["T_CONSTANT_ENCAPSED_STRING","'base_amount_incl_tax'",528],"]",",",["T_WHITESPACE"," ",528],["T_LNUMBER","0",528],")",";",["T_WHITESPACE","\n        ",528],"}",["T_WHITESPACE","\n        ",529],["T_RETURN","return",530],["T_WHITESPACE"," ",530],["T_VARIABLE","$totalBaseWeeeTaxIncTaxApplied",530],";",["T_WHITESPACE","\n    ",530],"}",["T_WHITESPACE","\n\n    ",531],["T_DOC_COMMENT","\/**\n     * Get the total weee including tax by row\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",533],["T_WHITESPACE","\n    ",538],["T_PUBLIC","public",539],["T_WHITESPACE"," ",539],["T_FUNCTION","function",539],["T_WHITESPACE"," ",539],["T_STRING","getRowWeeeTaxInclTax",539],"(",["T_VARIABLE","$item",539],")",["T_WHITESPACE","\n    ",539],"{",["T_WHITESPACE","\n        ",540],["T_VARIABLE","$weeeTaxAppliedAmounts",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","getApplied",541],"(",["T_VARIABLE","$item",541],")",";",["T_WHITESPACE","\n        ",541],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_LNUMBER","0",542],";",["T_WHITESPACE","\n        ",542],["T_FOREACH","foreach",543],["T_WHITESPACE"," ",543],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",543],["T_WHITESPACE"," ",543],["T_AS","as",543],["T_WHITESPACE"," ",543],["T_VARIABLE","$weeeTaxAppliedAmount",543],")",["T_WHITESPACE"," ",543],"{",["T_WHITESPACE","\n            ",543],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",544],["T_WHITESPACE"," ",544],["T_PLUS_EQUAL","+=",544],["T_WHITESPACE"," ",544],["T_STRING","max",544],"(",["T_VARIABLE","$weeeTaxAppliedAmount",544],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount_incl_tax'",544],"]",",",["T_WHITESPACE"," ",544],["T_LNUMBER","0",544],")",";",["T_WHITESPACE","\n        ",544],"}",["T_WHITESPACE","\n        ",545],["T_RETURN","return",546],["T_WHITESPACE"," ",546],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",546],";",["T_WHITESPACE","\n    ",546],"}",["T_WHITESPACE","\n\n    ",547],["T_DOC_COMMENT","\/**\n     * Get the total base weee including tax by row\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",549],["T_WHITESPACE","\n    ",554],["T_PUBLIC","public",555],["T_WHITESPACE"," ",555],["T_FUNCTION","function",555],["T_WHITESPACE"," ",555],["T_STRING","getBaseRowWeeeTaxInclTax",555],"(",["T_VARIABLE","$item",555],")",["T_WHITESPACE","\n    ",555],"{",["T_WHITESPACE","\n        ",556],["T_VARIABLE","$weeeTaxAppliedAmounts",557],["T_WHITESPACE"," ",557],"=",["T_WHITESPACE"," ",557],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","getApplied",557],"(",["T_VARIABLE","$item",557],")",";",["T_WHITESPACE","\n        ",557],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_LNUMBER","0",558],";",["T_WHITESPACE","\n        ",558],["T_FOREACH","foreach",559],["T_WHITESPACE"," ",559],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",559],["T_WHITESPACE"," ",559],["T_AS","as",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$weeeTaxAppliedAmount",559],")",["T_WHITESPACE"," ",559],"{",["T_WHITESPACE","\n            ",559],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",560],["T_WHITESPACE"," ",560],["T_PLUS_EQUAL","+=",560],["T_WHITESPACE"," ",560],["T_STRING","max",560],"(",["T_VARIABLE","$weeeTaxAppliedAmount",560],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount_incl_tax'",560],"]",",",["T_WHITESPACE"," ",560],["T_LNUMBER","0",560],")",";",["T_WHITESPACE","\n        ",560],"}",["T_WHITESPACE","\n        ",561],["T_RETURN","return",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$totalWeeeTaxIncTaxApplied",562],";",["T_WHITESPACE","\n    ",562],"}",["T_WHITESPACE","\n\n    ",563],["T_DOC_COMMENT","\/**\n     * Get the total tax applied on weee by unit\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",565],["T_WHITESPACE","\n    ",570],["T_PUBLIC","public",571],["T_WHITESPACE"," ",571],["T_FUNCTION","function",571],["T_WHITESPACE"," ",571],["T_STRING","getTotalTaxAppliedForWeeeTax",571],"(",["T_VARIABLE","$item",571],")",["T_WHITESPACE","\n    ",571],"{",["T_WHITESPACE","\n        ",572],["T_VARIABLE","$weeeTaxAppliedAmounts",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getApplied",573],"(",["T_VARIABLE","$item",573],")",";",["T_WHITESPACE","\n        ",573],["T_VARIABLE","$totalTaxForWeeeTax",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_LNUMBER","0",574],";",["T_WHITESPACE","\n        ",574],["T_FOREACH","foreach",575],["T_WHITESPACE"," ",575],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",575],["T_WHITESPACE"," ",575],["T_AS","as",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$weeeTaxAppliedAmount",575],")",["T_WHITESPACE"," ",575],"{",["T_WHITESPACE","\n            ",575],["T_VARIABLE","$totalTaxForWeeeTax",576],["T_WHITESPACE"," ",576],["T_PLUS_EQUAL","+=",576],["T_WHITESPACE"," ",576],["T_STRING","max",576],"(",["T_VARIABLE","$weeeTaxAppliedAmount",576],"[",["T_CONSTANT_ENCAPSED_STRING","'amount_incl_tax'",576],"]",["T_WHITESPACE","\n                ",576],"-",["T_WHITESPACE"," ",577],["T_VARIABLE","$weeeTaxAppliedAmount",577],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",577],"]",",",["T_WHITESPACE"," ",577],["T_LNUMBER","0",577],")",";",["T_WHITESPACE","\n        ",577],"}",["T_WHITESPACE","\n        ",578],["T_RETURN","return",579],["T_WHITESPACE"," ",579],["T_VARIABLE","$totalTaxForWeeeTax",579],";",["T_WHITESPACE","\n    ",579],"}",["T_WHITESPACE","\n\n    ",580],["T_DOC_COMMENT","\/**\n     * Get the total tax applied on weee by unit\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",582],["T_WHITESPACE","\n    ",587],["T_PUBLIC","public",588],["T_WHITESPACE"," ",588],["T_FUNCTION","function",588],["T_WHITESPACE"," ",588],["T_STRING","getBaseTotalTaxAppliedForWeeeTax",588],"(",["T_VARIABLE","$item",588],")",["T_WHITESPACE","\n    ",588],"{",["T_WHITESPACE","\n        ",589],["T_VARIABLE","$weeeTaxAppliedAmounts",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","getApplied",590],"(",["T_VARIABLE","$item",590],")",";",["T_WHITESPACE","\n        ",590],["T_VARIABLE","$totalTaxForWeeeTax",591],["T_WHITESPACE"," ",591],"=",["T_WHITESPACE"," ",591],["T_LNUMBER","0",591],";",["T_WHITESPACE","\n        ",591],["T_FOREACH","foreach",592],["T_WHITESPACE"," ",592],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",592],["T_WHITESPACE"," ",592],["T_AS","as",592],["T_WHITESPACE"," ",592],["T_VARIABLE","$weeeTaxAppliedAmount",592],")",["T_WHITESPACE"," ",592],"{",["T_WHITESPACE","\n            ",592],["T_VARIABLE","$totalTaxForWeeeTax",593],["T_WHITESPACE"," ",593],["T_PLUS_EQUAL","+=",593],["T_WHITESPACE"," ",593],["T_STRING","max",593],"(",["T_VARIABLE","$weeeTaxAppliedAmount",593],"[",["T_CONSTANT_ENCAPSED_STRING","'base_amount_incl_tax'",593],"]",["T_WHITESPACE","\n                ",593],"-",["T_WHITESPACE"," ",594],["T_VARIABLE","$weeeTaxAppliedAmount",594],"[",["T_CONSTANT_ENCAPSED_STRING","'base_amount'",594],"]",",",["T_WHITESPACE"," ",594],["T_LNUMBER","0",594],")",";",["T_WHITESPACE","\n        ",594],"}",["T_WHITESPACE","\n        ",595],["T_RETURN","return",596],["T_WHITESPACE"," ",596],["T_VARIABLE","$totalTaxForWeeeTax",596],";",["T_WHITESPACE","\n    ",596],"}",["T_WHITESPACE","\n\n    ",597],["T_DOC_COMMENT","\/**\n     * Get the Total tax applied for Weee\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",599],["T_WHITESPACE","\n    ",604],["T_PUBLIC","public",605],["T_WHITESPACE"," ",605],["T_FUNCTION","function",605],["T_WHITESPACE"," ",605],["T_STRING","getTotalRowTaxAppliedForWeeeTax",605],"(",["T_VARIABLE","$item",605],")",["T_WHITESPACE","\n    ",605],"{",["T_WHITESPACE","\n        ",606],["T_VARIABLE","$weeeTaxAppliedAmounts",607],["T_WHITESPACE"," ",607],"=",["T_WHITESPACE"," ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","getApplied",607],"(",["T_VARIABLE","$item",607],")",";",["T_WHITESPACE","\n        ",607],["T_VARIABLE","$totalTaxForWeeeTax",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_LNUMBER","0",608],";",["T_WHITESPACE","\n        ",608],["T_FOREACH","foreach",609],["T_WHITESPACE"," ",609],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",609],["T_WHITESPACE"," ",609],["T_AS","as",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$weeeTaxAppliedAmount",609],")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n            ",609],["T_VARIABLE","$totalTaxForWeeeTax",610],["T_WHITESPACE"," ",610],["T_PLUS_EQUAL","+=",610],["T_WHITESPACE"," ",610],["T_STRING","max",610],"(",["T_VARIABLE","$weeeTaxAppliedAmount",610],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount_incl_tax'",610],"]",["T_WHITESPACE","\n                ",610],"-",["T_WHITESPACE"," ",611],["T_VARIABLE","$weeeTaxAppliedAmount",611],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount'",611],"]",",",["T_WHITESPACE"," ",611],["T_LNUMBER","0",611],")",";",["T_WHITESPACE","\n        ",611],"}",["T_WHITESPACE","\n        ",612],["T_RETURN","return",613],["T_WHITESPACE"," ",613],["T_VARIABLE","$totalTaxForWeeeTax",613],";",["T_WHITESPACE","\n    ",613],"}",["T_WHITESPACE","\n\n    ",614],["T_DOC_COMMENT","\/**\n     * Get the Total tax applied in base for Weee\n     *\n     * @param Mage_Core_Model_Abstract $item\n     * @return float\n     *\/",616],["T_WHITESPACE","\n    ",621],["T_PUBLIC","public",622],["T_WHITESPACE"," ",622],["T_FUNCTION","function",622],["T_WHITESPACE"," ",622],["T_STRING","getBaseTotalRowTaxAppliedForWeeeTax",622],"(",["T_VARIABLE","$item",622],")",["T_WHITESPACE","\n    ",622],"{",["T_WHITESPACE","\n        ",623],["T_VARIABLE","$weeeTaxAppliedAmounts",624],["T_WHITESPACE"," ",624],"=",["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getApplied",624],"(",["T_VARIABLE","$item",624],")",";",["T_WHITESPACE","\n        ",624],["T_VARIABLE","$totalTaxForWeeeTax",625],["T_WHITESPACE"," ",625],"=",["T_WHITESPACE"," ",625],["T_LNUMBER","0",625],";",["T_WHITESPACE","\n        ",625],["T_FOREACH","foreach",626],["T_WHITESPACE"," ",626],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",626],["T_WHITESPACE"," ",626],["T_AS","as",626],["T_WHITESPACE"," ",626],["T_VARIABLE","$weeeTaxAppliedAmount",626],")",["T_WHITESPACE"," ",626],"{",["T_WHITESPACE","\n            ",626],["T_VARIABLE","$totalTaxForWeeeTax",627],["T_WHITESPACE"," ",627],["T_PLUS_EQUAL","+=",627],["T_WHITESPACE"," ",627],["T_STRING","max",627],"(",["T_VARIABLE","$weeeTaxAppliedAmount",627],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount_incl_tax'",627],"]",["T_WHITESPACE","\n                ",627],"-",["T_WHITESPACE"," ",628],["T_VARIABLE","$weeeTaxAppliedAmount",628],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount'",628],"]",",",["T_WHITESPACE"," ",628],["T_LNUMBER","0",628],")",";",["T_WHITESPACE","\n        ",628],"}",["T_WHITESPACE","\n        ",629],["T_RETURN","return",630],["T_WHITESPACE"," ",630],["T_VARIABLE","$totalTaxForWeeeTax",630],";",["T_WHITESPACE","\n    ",630],"}",["T_WHITESPACE","\n\n    ",631],["T_DOC_COMMENT","\/**\n     * Calculate row weee amount for an order, invoice or credit memo item\n     * The returned value may contain discount if the discount is not included in\n     * the discount for subtotal\n     *\n     * @param mixed $item\n     * @return float\n     *\/",633],["T_WHITESPACE","\n    ",640],["T_PUBLIC","public",641],["T_WHITESPACE"," ",641],["T_FUNCTION","function",641],["T_WHITESPACE"," ",641],["T_STRING","getRowWeeeAmountAfterDiscount",641],"(",["T_VARIABLE","$item",641],")",["T_WHITESPACE","\n    ",641],"{",["T_WHITESPACE","\n        ",642],["T_VARIABLE","$weeeTaxAppliedAmounts",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","getApplied",643],"(",["T_VARIABLE","$item",643],")",";",["T_WHITESPACE","\n        ",643],["T_VARIABLE","$weeeAmountInclDiscount",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_LNUMBER","0",644],";",["T_WHITESPACE","\n        ",644],["T_FOREACH","foreach",645],["T_WHITESPACE"," ",645],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",645],["T_WHITESPACE"," ",645],["T_AS","as",645],["T_WHITESPACE"," ",645],["T_VARIABLE","$weeeTaxAppliedAmount",645],")",["T_WHITESPACE"," ",645],"{",["T_WHITESPACE","\n            ",645],["T_VARIABLE","$weeeAmountInclDiscount",646],["T_WHITESPACE"," ",646],["T_PLUS_EQUAL","+=",646],["T_WHITESPACE"," ",646],["T_VARIABLE","$weeeTaxAppliedAmount",646],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount'",646],"]",";",["T_WHITESPACE","\n            ",646],["T_IF","if",647],["T_WHITESPACE"," ",647],"(","!",["T_VARIABLE","$this",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","includeInSubtotal",647],"(",")",")",["T_WHITESPACE"," ",647],"{",["T_WHITESPACE","\n                ",647],["T_VARIABLE","$weeeAmountInclDiscount",648],["T_WHITESPACE"," ",648],["T_MINUS_EQUAL","-=",648],["T_WHITESPACE"," ",648],["T_ISSET","isset",648],"(",["T_VARIABLE","$weeeTaxAppliedAmount",648],"[",["T_CONSTANT_ENCAPSED_STRING","'weee_discount'",648],"]",")",["T_WHITESPACE","\n                    ",648],"?",["T_WHITESPACE"," ",649],["T_VARIABLE","$weeeTaxAppliedAmount",649],"[",["T_CONSTANT_ENCAPSED_STRING","'weee_discount'",649],"]",["T_WHITESPACE"," ",649],":",["T_WHITESPACE"," ",649],["T_LNUMBER","0",649],";",["T_WHITESPACE","\n            ",649],"}",["T_WHITESPACE","\n        ",650],"}",["T_WHITESPACE","\n        ",651],["T_RETURN","return",652],["T_WHITESPACE"," ",652],["T_VARIABLE","$weeeAmountInclDiscount",652],";",["T_WHITESPACE","\n    ",652],"}",["T_WHITESPACE","\n\n    ",653],["T_DOC_COMMENT","\/**\n     * Calculate base row weee amount for an order, invoice or credit memo item\n     * The returned value may contain discount if the discount is not included in\n     * the discount for subtotal\n     *\n     * @param mixed $item\n     * @return float\n     *\/",655],["T_WHITESPACE","\n    ",662],["T_PUBLIC","public",663],["T_WHITESPACE"," ",663],["T_FUNCTION","function",663],["T_WHITESPACE"," ",663],["T_STRING","getBaseRowWeeeAmountAfterDiscount",663],"(",["T_VARIABLE","$item",663],")",["T_WHITESPACE","\n    ",663],"{",["T_WHITESPACE","\n        ",664],["T_VARIABLE","$weeeTaxAppliedAmounts",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","getApplied",665],"(",["T_VARIABLE","$item",665],")",";",["T_WHITESPACE","\n        ",665],["T_VARIABLE","$baseWeeeAmountInclDiscount",666],["T_WHITESPACE"," ",666],"=",["T_WHITESPACE"," ",666],["T_LNUMBER","0",666],";",["T_WHITESPACE","\n        ",666],["T_FOREACH","foreach",667],["T_WHITESPACE"," ",667],"(",["T_VARIABLE","$weeeTaxAppliedAmounts",667],["T_WHITESPACE"," ",667],["T_AS","as",667],["T_WHITESPACE"," ",667],["T_VARIABLE","$weeeTaxAppliedAmount",667],")",["T_WHITESPACE"," ",667],"{",["T_WHITESPACE","\n            ",667],["T_VARIABLE","$baseWeeeAmountInclDiscount",668],["T_WHITESPACE"," ",668],["T_PLUS_EQUAL","+=",668],["T_WHITESPACE"," ",668],["T_VARIABLE","$weeeTaxAppliedAmount",668],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount'",668],"]",";",["T_WHITESPACE","\n            ",668],["T_IF","if",669],["T_WHITESPACE"," ",669],"(","!",["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","includeInSubtotal",669],"(",")",")",["T_WHITESPACE"," ",669],"{",["T_WHITESPACE","\n                ",669],["T_VARIABLE","$baseWeeeAmountInclDiscount",670],["T_WHITESPACE"," ",670],["T_MINUS_EQUAL","-=",670],["T_WHITESPACE"," ",670],["T_ISSET","isset",670],"(",["T_VARIABLE","$weeeTaxAppliedAmount",670],"[",["T_CONSTANT_ENCAPSED_STRING","'base_weee_discount'",670],"]",")",["T_WHITESPACE","\n                    ",670],"?",["T_WHITESPACE"," ",671],["T_VARIABLE","$weeeTaxAppliedAmount",671],"[",["T_CONSTANT_ENCAPSED_STRING","'base_weee_discount'",671],"]",["T_WHITESPACE"," ",671],":",["T_WHITESPACE"," ",671],["T_LNUMBER","0",671],";",["T_WHITESPACE","\n            ",671],"}",["T_WHITESPACE","\n        ",672],"}",["T_WHITESPACE","\n        ",673],["T_RETURN","return",674],["T_WHITESPACE"," ",674],["T_VARIABLE","$baseWeeeAmountInclDiscount",674],";",["T_WHITESPACE","\n    ",674],"}",["T_WHITESPACE","\n\n    ",675],["T_DOC_COMMENT","\/**\n     * Get The Helper with the name provider\n     *\n     * @param string $helperName\n     * @return Mage_Core_Helper_Abstract\n     *\/",677],["T_WHITESPACE","\n    ",682],["T_PROTECTED","protected",683],["T_WHITESPACE"," ",683],["T_FUNCTION","function",683],["T_WHITESPACE"," ",683],["T_STRING","_getHelper",683],"(",["T_VARIABLE","$helperName",683],")",["T_WHITESPACE","\n    ",683],"{",["T_WHITESPACE","\n        ",684],["T_RETURN","return",685],["T_WHITESPACE"," ",685],["T_STRING","Mage",685],["T_DOUBLE_COLON","::",685],["T_STRING","helper",685],"(",["T_VARIABLE","$helperName",685],")",";",["T_WHITESPACE","\n    ",685],"}",["T_WHITESPACE","\n",686],"}",["T_WHITESPACE","\n\n",687]]