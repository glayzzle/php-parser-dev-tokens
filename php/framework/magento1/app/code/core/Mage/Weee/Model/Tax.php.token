[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Weee\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Model to calculate Weee amount\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Weee_Model_Tax",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Model_Abstract",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * Including FPT only\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","DISPLAY_INCL",35],["T_WHITESPACE","              ",35],"=",["T_WHITESPACE"," ",35],["T_LNUMBER","0",35],";",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Including FPT and FPT description\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","DISPLAY_INCL_DESCR",39],["T_WHITESPACE","        ",39],"=",["T_WHITESPACE"," ",39],["T_LNUMBER","1",39],";",["T_WHITESPACE","\n    ",39],["T_DOC_COMMENT","\/**\n     * Excluding FPT, FPT description, final price\n     *\/",40],["T_WHITESPACE","\n    ",42],["T_CONST","const",43],["T_WHITESPACE"," ",43],["T_STRING","DISPLAY_EXCL_DESCR_INCL",43],["T_WHITESPACE","   ",43],"=",["T_WHITESPACE"," ",43],["T_LNUMBER","2",43],";",["T_WHITESPACE","\n    ",43],["T_DOC_COMMENT","\/**\n     * Excluding FPT\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_CONST","const",47],["T_WHITESPACE"," ",47],["T_STRING","DISPLAY_EXCL",47],["T_WHITESPACE","              ",47],"=",["T_WHITESPACE"," ",47],["T_LNUMBER","3",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * All weee attributes\n     *\n     * @var array\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_allAttributes",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","null",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Cache product discounts\n     *\n     * @var array\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_productDiscounts",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Tax helper\n     *\n     * @var Mage_Tax_Helper_Data\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_taxHelper",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Initialize resource\n     *\/",70],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","_construct",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_init",75],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",75],")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Initialize tax helper\n     *\n     * @param array $args\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","__construct",84],"(",["T_ARRAY","array",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$args",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",")",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_STRING","parent",86],["T_DOUBLE_COLON","::",86],["T_STRING","__construct",86],"(",")",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_taxHelper",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],"!",["T_EMPTY","empty",87],"(",["T_VARIABLE","$args",87],"[",["T_CONSTANT_ENCAPSED_STRING","'helper'",87],"]",")",["T_WHITESPACE"," ",87],"?",["T_WHITESPACE"," ",87],["T_VARIABLE","$args",87],"[",["T_CONSTANT_ENCAPSED_STRING","'helper'",87],"]",["T_WHITESPACE"," ",87],":",["T_WHITESPACE"," ",87],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","helper",87],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",87],")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Calculate weee amount for a product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param Mage_Customer_Model_Address_Abstract $shipping\n     * @param Mage_Customer_Model_Address_Abstract $billing\n     * @param mixed $website\n     * @param boolean $calculateTax\n     * @param boolean $ignoreDiscount\n     * @return float\n     *\/",90],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","getWeeeAmount",101],"(",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$product",102],",",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$shipping",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","null",103],",",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$billing",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","null",104],",",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$website",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","null",105],",",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$calculateTax",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","false",106],",",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$ignoreDiscount",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","false",107],")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$amount",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_LNUMBER","0",109],";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$attributes",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getProductWeeeAttributes",110],"(",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$product",111],",",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$shipping",112],",",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$billing",113],",",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$website",114],",",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$calculateTax",115],",",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$ignoreDiscount",116],["T_WHITESPACE","\n        ",116],")",";",["T_WHITESPACE","\n        ",117],["T_FOREACH","foreach",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$attributes",118],["T_WHITESPACE"," ",118],["T_AS","as",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$attribute",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$amount",119],["T_WHITESPACE"," ",119],["T_PLUS_EQUAL","+=",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$attribute",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getAmount",119],"(",")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n        ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$amount",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Get a list of Weee attribute codes\n     *\n     * @param boolean $forceEnabled\n     * @return array\n     *\/",124],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","getWeeeAttributeCodes",130],"(",["T_VARIABLE","$forceEnabled",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","false",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getWeeeTaxAttributeCodes",132],"(",["T_VARIABLE","$forceEnabled",132],")",";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * Retrieve Weee tax attribute codes\n     *\n     * @param bool $forceEnabled\n     * @return array\n     *\/",135],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","getWeeeTaxAttributeCodes",141],"(",["T_VARIABLE","$forceEnabled",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","false",141],")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(","!",["T_VARIABLE","$forceEnabled",143],["T_WHITESPACE"," ",143],["T_BOOLEAN_AND","&&",143],["T_WHITESPACE"," ",143],"!",["T_STRING","Mage",143],["T_DOUBLE_COLON","::",143],["T_STRING","helper",143],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",143],")",["T_OBJECT_OPERATOR","->",143],["T_STRING","isEnabled",143],"(",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_ARRAY","array",144],"(",")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_IF","if",147],["T_WHITESPACE"," ",147],"(",["T_STRING","is_null",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_allAttributes",147],")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_allAttributes",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","Mage",148],["T_DOUBLE_COLON","::",148],["T_STRING","getModel",148],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",148],")",["T_OBJECT_OPERATOR","->",148],["T_STRING","getAttributeCodesByFrontendType",148],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",148],")",";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_allAttributes",150],";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Get Weee amounts associated with a product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param Mage_Customer_Model_Address_Abstract $shipping\n     * @param Mage_Customer_Model_Address_Abstract $billing\n     * @param mixed $website\n     * @param boolean $calculateTax\n     * @param boolean $ignoreDiscount\n     * @return array|\\Varien_Object\n     *\/",153],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","getProductWeeeAttributes",164],"(",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$product",165],",",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$shipping",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","null",166],",",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$billing",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","null",167],",",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$website",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","null",168],",",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$calculateTax",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","null",169],",",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$ignoreDiscount",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","false",170],")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$result",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$allWeee",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getWeeeTaxAttributeCodes",173],"(",")",";",["T_WHITESPACE","\n        ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(","!",["T_VARIABLE","$allWeee",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$result",175],";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n\n        ",176],["T_VARIABLE","$websiteId",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","Mage",178],["T_DOUBLE_COLON","::",178],["T_STRING","app",178],"(",")",["T_OBJECT_OPERATOR","->",178],["T_STRING","getWebsite",178],"(",["T_VARIABLE","$website",178],")",["T_OBJECT_OPERATOR","->",178],["T_STRING","getId",178],"(",")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$store",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING","Mage",179],["T_DOUBLE_COLON","::",179],["T_STRING","app",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getWebsite",179],"(",["T_VARIABLE","$website",179],")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getDefaultGroup",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getDefaultStore",179],"(",")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$customer",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","null",180],";",["T_WHITESPACE","\n\n        ",180],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_VARIABLE","$shipping",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$customerTaxClass",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$shipping",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getQuote",183],"(",")",["T_OBJECT_OPERATOR","->",183],["T_STRING","getCustomerTaxClassId",183],"(",")",";",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$customer",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$shipping",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getQuote",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getCustomer",184],"(",")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE"," ",185],["T_ELSE","else",185],["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$customerTaxClass",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","null",186],";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$calculator",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","Mage",189],["T_DOUBLE_COLON","::",189],["T_STRING","getModel",189],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",189],")",";",["T_WHITESPACE","\n        ",189],["T_IF","if",190],["T_WHITESPACE"," ",190],"(",["T_VARIABLE","$customer",190],")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$calculator",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","setCustomer",191],"(",["T_VARIABLE","$customer",191],")",";",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$rateRequest",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$calculator",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getRateRequest",193],"(",["T_VARIABLE","$shipping",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$billing",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$customerTaxClass",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$store",193],")",";",["T_WHITESPACE","\n\n        ",193],["T_VARIABLE","$currentPercent",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$product",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getTaxPercent",195],"(",")",";",["T_WHITESPACE","\n\n        ",195],["T_IF","if",197],["T_WHITESPACE"," ",197],"(","!",["T_VARIABLE","$currentPercent",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$currentPercent",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","getSingleton",198],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","getRate",198],"(",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$rateRequest",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","setProductClassId",199],"(",["T_VARIABLE","$product",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getTaxClassId",199],"(",")",")",")",";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_VARIABLE","$discountPercent",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_LNUMBER","0",202],";",["T_WHITESPACE","\n\n        ",202],["T_IF","if",204],["T_WHITESPACE"," ",204],"(","!",["T_VARIABLE","$ignoreDiscount",204],["T_WHITESPACE"," ",204],["T_BOOLEAN_AND","&&",204],["T_WHITESPACE"," ",204],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","helper",204],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",204],")",["T_OBJECT_OPERATOR","->",204],["T_STRING","isDiscounted",204],"(",["T_VARIABLE","$store",204],")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$discountPercent",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_getDiscountPercentForProduct",205],"(",["T_VARIABLE","$product",205],")",";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n\n        ",206],["T_VARIABLE","$productAttributes",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$product",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getTypeInstance",208],"(",["T_STRING","true",208],")",["T_OBJECT_OPERATOR","->",208],["T_STRING","getSetAttributes",208],"(",["T_VARIABLE","$product",208],")",";",["T_WHITESPACE","\n        ",208],["T_FOREACH","foreach",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$productAttributes",209],["T_WHITESPACE"," ",209],["T_AS","as",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$code",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$attribute",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_STRING","in_array",210],"(",["T_VARIABLE","$code",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$allWeee",210],")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_VARIABLE","$attributeSelect",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getResource",211],"(",")",["T_OBJECT_OPERATOR","->",211],["T_STRING","getReadConnection",211],"(",")",["T_OBJECT_OPERATOR","->",211],["T_STRING","select",211],"(",")",";",["T_WHITESPACE","\n                ",211],["T_VARIABLE","$attributeSelect",212],["T_WHITESPACE","\n                    ",212],["T_OBJECT_OPERATOR","->",213],["T_STRING","from",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getResource",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","getTable",213],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",213],")",",",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'value'",213],")",["T_WHITESPACE","\n                    ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","where",214],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_id = ?'",214],",",["T_WHITESPACE"," ",214],["T_INT_CAST","(int)",214],["T_VARIABLE","$attribute",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getId",214],"(",")",")",["T_WHITESPACE","\n                    ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","where",215],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id IN(?)'",215],",",["T_WHITESPACE"," ",215],["T_ARRAY","array",215],"(",["T_VARIABLE","$websiteId",215],",",["T_WHITESPACE"," ",215],["T_LNUMBER","0",215],")",")",["T_WHITESPACE","\n                    ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","where",216],"(",["T_CONSTANT_ENCAPSED_STRING","'country = ?'",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$rateRequest",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getCountryId",216],"(",")",")",["T_WHITESPACE","\n                    ",216],["T_OBJECT_OPERATOR","->",217],["T_STRING","where",217],"(",["T_CONSTANT_ENCAPSED_STRING","'state IN(?)'",217],",",["T_WHITESPACE"," ",217],["T_ARRAY","array",217],"(",["T_VARIABLE","$rateRequest",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getRegionId",217],"(",")",",",["T_WHITESPACE"," ",217],["T_CONSTANT_ENCAPSED_STRING","'*'",217],")",")",["T_WHITESPACE","\n                    ",217],["T_OBJECT_OPERATOR","->",218],["T_STRING","where",218],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",218],",",["T_WHITESPACE"," ",218],["T_INT_CAST","(int)",218],["T_VARIABLE","$product",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getId",218],"(",")",")",["T_WHITESPACE","\n                    ",218],["T_OBJECT_OPERATOR","->",219],["T_STRING","limit",219],"(",["T_LNUMBER","1",219],")",";",["T_WHITESPACE","\n\n                ",219],["T_VARIABLE","$order",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_ARRAY","array",221],"(",["T_CONSTANT_ENCAPSED_STRING","'state '",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_STRING","Varien_Db_Select",221],["T_DOUBLE_COLON","::",221],["T_STRING","SQL_DESC",221],",",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'website_id '",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_STRING","Varien_Db_Select",221],["T_DOUBLE_COLON","::",221],["T_STRING","SQL_DESC",221],")",";",["T_WHITESPACE","\n                ",221],["T_VARIABLE","$attributeSelect",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","order",222],"(",["T_VARIABLE","$order",222],")",";",["T_WHITESPACE","\n                ",222],["T_VARIABLE","$value",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getResource",223],"(",")",["T_OBJECT_OPERATOR","->",223],["T_STRING","getReadConnection",223],"(",")",["T_OBJECT_OPERATOR","->",223],["T_STRING","fetchOne",223],"(",["T_VARIABLE","$attributeSelect",223],")",";",["T_WHITESPACE","\n\n                ",223],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$value",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n                    ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$discountPercent",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n                        ",226],["T_VARIABLE","$value",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","app",227],"(",")",["T_OBJECT_OPERATOR","->",227],["T_STRING","getStore",227],"(",")",["T_OBJECT_OPERATOR","->",227],["T_STRING","roundPrice",227],"(",["T_VARIABLE","$value",227],["T_WHITESPACE"," ",227],"-",["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$value",227],["T_WHITESPACE"," ",227],"*",["T_WHITESPACE"," ",227],["T_VARIABLE","$discountPercent",227],["T_WHITESPACE"," ",227],"\/",["T_WHITESPACE"," ",227],["T_LNUMBER","100",227],")",")",";",["T_WHITESPACE","\n                    ",227],"}",["T_WHITESPACE","\n\n                    ",228],["T_VARIABLE","$taxAmount",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_LNUMBER","0",230],";",["T_WHITESPACE","\n                    ",230],["T_VARIABLE","$amount",231],["T_WHITESPACE","    ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$value",231],";",["T_WHITESPACE","\n                    ",231],["T_IF","if",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$calculateTax",232],["T_WHITESPACE"," ",232],["T_BOOLEAN_AND","&&",232],["T_WHITESPACE"," ",232],["T_STRING","Mage",232],["T_DOUBLE_COLON","::",232],["T_STRING","helper",232],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",232],")",["T_OBJECT_OPERATOR","->",232],["T_STRING","isTaxable",232],"(",["T_VARIABLE","$store",232],")",")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                        ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_taxHelper",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","isCrossBorderTradeEnabled",233],"(",["T_VARIABLE","$store",233],")",")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n                            ",233],["T_VARIABLE","$defaultPercent",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$currentPercent",234],";",["T_WHITESPACE","\n                        ",234],"}",["T_WHITESPACE"," ",235],["T_ELSE","else",235],["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n                            ",235],["T_VARIABLE","$defaultRateRequest",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$calculator",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getDefaultRateRequest",236],"(",["T_VARIABLE","$store",236],")",";",["T_WHITESPACE","\n                            ",236],["T_VARIABLE","$defaultPercent",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_STRING","Mage",237],["T_DOUBLE_COLON","::",237],["T_STRING","getModel",237],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",237],")",["T_WHITESPACE","\n                                ",237],["T_OBJECT_OPERATOR","->",238],["T_STRING","getRate",238],"(",["T_VARIABLE","$defaultRateRequest",238],["T_WHITESPACE","\n                                ",238],["T_OBJECT_OPERATOR","->",239],["T_STRING","setProductClassId",239],"(",["T_VARIABLE","$product",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getTaxClassId",239],"(",")",")",")",";",["T_WHITESPACE","\n                        ",239],"}",["T_WHITESPACE","\n\n                        ",240],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_STRING","Mage",242],["T_DOUBLE_COLON","::",242],["T_STRING","helper",242],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",242],")",["T_OBJECT_OPERATOR","->",242],["T_STRING","isTaxIncluded",242],"(",["T_VARIABLE","$store",242],")",")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n                            ",242],["T_VARIABLE","$taxAmount",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","app",243],"(",")",["T_OBJECT_OPERATOR","->",243],["T_STRING","getStore",243],"(",")",["T_WHITESPACE","\n                                    ",243],["T_OBJECT_OPERATOR","->",244],["T_STRING","roundPrice",244],"(",["T_VARIABLE","$value",244],["T_WHITESPACE"," ",244],"\/",["T_WHITESPACE"," ",244],"(",["T_LNUMBER","100",244],["T_WHITESPACE"," ",244],"+",["T_WHITESPACE"," ",244],["T_VARIABLE","$defaultPercent",244],")",["T_WHITESPACE"," ",244],"*",["T_WHITESPACE"," ",244],["T_VARIABLE","$currentPercent",244],")",";",["T_WHITESPACE","\n                            ",244],["T_VARIABLE","$amount",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE","  ",245],["T_VARIABLE","$amount",245],["T_WHITESPACE"," ",245],"-",["T_WHITESPACE"," ",245],["T_VARIABLE","$taxAmount",245],";",["T_WHITESPACE","\n                        ",245],"}",["T_WHITESPACE"," ",246],["T_ELSE","else",246],["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                            ",246],["T_VARIABLE","$appliedRates",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","Mage",247],["T_DOUBLE_COLON","::",247],["T_STRING","getModel",247],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",247],")",["T_OBJECT_OPERATOR","->",247],["T_STRING","getAppliedRates",247],"(",["T_VARIABLE","$rateRequest",247],")",";",["T_WHITESPACE","\n                            ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_STRING","count",248],"(",["T_VARIABLE","$appliedRates",248],")",["T_WHITESPACE"," ",248],">",["T_WHITESPACE"," ",248],["T_LNUMBER","1",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                                ",248],["T_VARIABLE","$taxAmount",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_LNUMBER","0",249],";",["T_WHITESPACE","\n                                ",249],["T_FOREACH","foreach",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$appliedRates",250],["T_WHITESPACE"," ",250],["T_AS","as",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$appliedRate",250],")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                                    ",250],["T_VARIABLE","$taxRate",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$appliedRate",251],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",251],"]",";",["T_WHITESPACE","\n                                    ",251],["T_VARIABLE","$taxAmount",252],["T_WHITESPACE"," ",252],["T_PLUS_EQUAL","+=",252],["T_WHITESPACE"," ",252],["T_STRING","Mage",252],["T_DOUBLE_COLON","::",252],["T_STRING","app",252],"(",")",["T_OBJECT_OPERATOR","->",252],["T_STRING","getStore",252],"(",")",["T_OBJECT_OPERATOR","->",252],["T_STRING","roundPrice",252],"(",["T_VARIABLE","$value",252],["T_WHITESPACE"," ",252],"*",["T_WHITESPACE"," ",252],["T_VARIABLE","$taxRate",252],["T_WHITESPACE"," ",252],"\/",["T_WHITESPACE"," ",252],["T_LNUMBER","100",252],")",";",["T_WHITESPACE","\n                                ",252],"}",["T_WHITESPACE","\n                            ",253],"}",["T_WHITESPACE"," ",254],["T_ELSE","else",254],["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n                                ",254],["T_VARIABLE","$taxAmount",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","Mage",255],["T_DOUBLE_COLON","::",255],["T_STRING","app",255],"(",")",["T_OBJECT_OPERATOR","->",255],["T_STRING","getStore",255],"(",")",["T_OBJECT_OPERATOR","->",255],["T_STRING","roundPrice",255],"(",["T_VARIABLE","$value",255],["T_WHITESPACE"," ",255],"*",["T_WHITESPACE"," ",255],["T_VARIABLE","$currentPercent",255],["T_WHITESPACE"," ",255],"\/",["T_WHITESPACE"," ",255],["T_LNUMBER","100",255],")",";",["T_WHITESPACE","\n                            ",255],"}",["T_WHITESPACE","\n                        ",256],"}",["T_WHITESPACE","\n                    ",257],"}",["T_WHITESPACE","\n\n                    ",258],["T_VARIABLE","$one",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_NEW","new",260],["T_WHITESPACE"," ",260],["T_STRING","Varien_Object",260],"(",")",";",["T_WHITESPACE","\n                    ",260],["T_VARIABLE","$one",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","setName",261],"(",["T_STRING","Mage",261],["T_DOUBLE_COLON","::",261],["T_STRING","helper",261],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",261],")",["T_OBJECT_OPERATOR","->",261],["T_STRING","__",261],"(",["T_VARIABLE","$attribute",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getFrontend",261],"(",")",["T_OBJECT_OPERATOR","->",261],["T_STRING","getLabel",261],"(",")",")",")",["T_WHITESPACE","\n                        ",261],["T_OBJECT_OPERATOR","->",262],["T_STRING","setAmount",262],"(",["T_VARIABLE","$amount",262],")",["T_WHITESPACE","\n                        ",262],["T_OBJECT_OPERATOR","->",263],["T_STRING","setTaxAmount",263],"(",["T_VARIABLE","$taxAmount",263],")",["T_WHITESPACE","\n                        ",263],["T_OBJECT_OPERATOR","->",264],["T_STRING","setCode",264],"(",["T_VARIABLE","$attribute",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getAttributeCode",264],"(",")",")",";",["T_WHITESPACE","\n\n                    ",264],["T_VARIABLE","$result",266],"[","]",["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$one",266],";",["T_WHITESPACE","\n                ",266],"}",["T_WHITESPACE","\n            ",267],"}",["T_WHITESPACE","\n        ",268],"}",["T_WHITESPACE","\n        ",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$result",270],";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * Get discount percentage for a product\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return int\n     *\/",273],["T_WHITESPACE","\n    ",278],["T_PROTECTED","protected",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","_getDiscountPercentForProduct",279],"(",["T_VARIABLE","$product",279],")",["T_WHITESPACE","\n    ",279],"{",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$website",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","Mage",281],["T_DOUBLE_COLON","::",281],["T_STRING","app",281],"(",")",["T_OBJECT_OPERATOR","->",281],["T_STRING","getStore",281],"(",")",["T_OBJECT_OPERATOR","->",281],["T_STRING","getWebsiteId",281],"(",")",";",["T_WHITESPACE","\n        ",281],["T_VARIABLE","$group",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","Mage",282],["T_DOUBLE_COLON","::",282],["T_STRING","getSingleton",282],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",282],")",["T_OBJECT_OPERATOR","->",282],["T_STRING","getCustomerGroupId",282],"(",")",";",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$key",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","implode",283],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",283],",",["T_WHITESPACE"," ",283],["T_ARRAY","array",283],"(",["T_VARIABLE","$website",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$group",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$product",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getId",283],"(",")",")",")",";",["T_WHITESPACE","\n        ",283],["T_IF","if",284],["T_WHITESPACE"," ",284],"(","!",["T_ISSET","isset",284],"(",["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","_productDiscounts",284],"[",["T_VARIABLE","$key",284],"]",")",")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","_productDiscounts",285],"[",["T_VARIABLE","$key",285],"]",["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_INT_CAST","(int)",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getResource",285],"(",")",["T_WHITESPACE","\n                ",285],["T_OBJECT_OPERATOR","->",286],["T_STRING","getProductDiscountPercent",286],"(",["T_VARIABLE","$product",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getId",286],"(",")",",",["T_WHITESPACE"," ",286],["T_VARIABLE","$website",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$group",286],")",";",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$value",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_productDiscounts",288],"[",["T_VARIABLE","$key",288],"]",";",["T_WHITESPACE","\n        ",288],["T_IF","if",289],["T_WHITESPACE"," ",289],"(",["T_VARIABLE","$value",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n            ",289],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_LNUMBER","100",290],["T_WHITESPACE"," ",290],"-",["T_WHITESPACE"," ",290],["T_STRING","min",290],"(",["T_LNUMBER","100",290],",",["T_WHITESPACE"," ",290],["T_STRING","max",290],"(",["T_LNUMBER","0",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$value",290],")",")",";",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE"," ",291],["T_ELSE","else",291],["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n            ",291],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_LNUMBER","0",292],";",["T_WHITESPACE","\n        ",292],"}",["T_WHITESPACE","\n    ",293],"}",["T_WHITESPACE","\n\n    ",294],["T_DOC_COMMENT","\/**\n     * Update discounts for FPT amounts of all products\n     *\n     * @return Mage_Weee_Model_Tax\n     *\/",296],["T_WHITESPACE","\n    ",300],["T_PUBLIC","public",301],["T_WHITESPACE"," ",301],["T_FUNCTION","function",301],["T_WHITESPACE"," ",301],["T_STRING","updateDiscountPercents",301],"(",")",["T_WHITESPACE","\n    ",301],"{",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getResource",303],"(",")",["T_OBJECT_OPERATOR","->",303],["T_STRING","updateDiscountPercents",303],"(",")",";",["T_WHITESPACE","\n        ",303],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],";",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n\n    ",305],["T_DOC_COMMENT","\/**\n     * Update discounts for FPT amounts base on products condiotion\n     *\n     * @param  mixed $products\n     * @return Mage_Weee_Model_Tax\n     *\/",307],["T_WHITESPACE","\n    ",312],["T_PUBLIC","public",313],["T_WHITESPACE"," ",313],["T_FUNCTION","function",313],["T_WHITESPACE"," ",313],["T_STRING","updateProductsDiscountPercent",313],"(",["T_VARIABLE","$products",313],")",["T_WHITESPACE","\n    ",313],"{",["T_WHITESPACE","\n        ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getResource",315],"(",")",["T_OBJECT_OPERATOR","->",315],["T_STRING","updateProductsDiscountPercent",315],"(",["T_VARIABLE","$products",315],")",";",["T_WHITESPACE","\n        ",315],["T_RETURN","return",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n",317],"}",["T_WHITESPACE","\n",318]]