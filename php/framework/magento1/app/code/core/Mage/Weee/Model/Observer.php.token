[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Weee\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Class Mage_Weee_Model_Observer\n *\n * @category    Mage\n * @package     Mage_Weee\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Weee_Model_Observer",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Model_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Assign custom renderer for product create\/edit form weee attribute element\n     *\n     * @param Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","setWeeeRendererInForm",42],"(",["T_STRING","Varien_Event_Observer",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$observer",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_COMMENT","\/\/adminhtml_catalog_product_edit_prepare_form\n",44],["T_WHITESPACE","\n        ",45],["T_VARIABLE","$form",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$observer",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getEvent",46],"(",")",["T_OBJECT_OPERATOR","->",46],["T_STRING","getForm",46],"(",")",";",["T_WHITESPACE","\n",46],["T_COMMENT","\/\/        $product = $observer->getEvent()->getProduct();\n",47],["T_WHITESPACE","\n        ",48],["T_VARIABLE","$attributes",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","Mage",49],["T_DOUBLE_COLON","::",49],["T_STRING","getSingleton",49],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","getWeeeAttributeCodes",49],"(",["T_STRING","true",49],")",";",["T_WHITESPACE","\n        ",49],["T_FOREACH","foreach",50],["T_WHITESPACE"," ",50],"(",["T_VARIABLE","$attributes",50],["T_WHITESPACE"," ",50],["T_AS","as",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$code",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$weeeTax",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$form",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getElement",51],"(",["T_VARIABLE","$code",51],")",";",["T_WHITESPACE","\n            ",51],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$weeeTax",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n                ",52],["T_VARIABLE","$weeeTax",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","setRenderer",53],"(",["T_WHITESPACE","\n                    ",53],["T_STRING","Mage",54],["T_DOUBLE_COLON","::",54],["T_STRING","app",54],"(",")",["T_OBJECT_OPERATOR","->",54],["T_STRING","getLayout",54],"(",")",["T_OBJECT_OPERATOR","->",54],["T_STRING","createBlock",54],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/renderer_weee_tax'",54],")",["T_WHITESPACE","\n                ",54],")",";",["T_WHITESPACE","\n            ",55],"}",["T_WHITESPACE","\n        ",56],"}",["T_WHITESPACE","\n\n        ",57],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Exclude WEEE attributes from standard form generation\n     *\n     * @param Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",62],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","updateExcludedFieldList",68],"(",["T_STRING","Varien_Event_Observer",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$observer",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_COMMENT","\/\/adminhtml_catalog_product_form_prepare_excluded_field_list\n",70],["T_WHITESPACE","\n        ",71],["T_VARIABLE","$block",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$observer",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getEvent",72],"(",")",["T_OBJECT_OPERATOR","->",72],["T_STRING","getObject",72],"(",")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$list",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$block",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getFormExcludedFieldList",73],"(",")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$attributes",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","Mage",74],["T_DOUBLE_COLON","::",74],["T_STRING","getSingleton",74],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",74],")",["T_OBJECT_OPERATOR","->",74],["T_STRING","getWeeeAttributeCodes",74],"(",["T_STRING","true",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$list",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","array_merge",75],"(",["T_VARIABLE","$list",75],",",["T_WHITESPACE"," ",75],["T_STRING","array_values",75],"(",["T_VARIABLE","$attributes",75],")",")",";",["T_WHITESPACE","\n\n        ",75],["T_VARIABLE","$block",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setFormExcludedFieldList",77],"(",["T_VARIABLE","$list",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Add additional price calculation to select object which is using for select indexed data\n     *\n     * @param   Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",82],["T_WHITESPACE","\n    ",87],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","prepareCatalogIndexSelect",88],"(",["T_STRING","Varien_Event_Observer",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$observer",88],")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$storeId",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_INT_CAST","(int)",90],["T_VARIABLE","$observer",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getEvent",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","getStoreId",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_STRING","Mage",91],["T_DOUBLE_COLON","::",91],["T_STRING","helper",91],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","isEnabled",91],"(",["T_VARIABLE","$storeId",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n\n        ",93],["T_SWITCH","switch",95],["T_WHITESPACE"," ",95],"(",["T_STRING","Mage",95],["T_DOUBLE_COLON","::",95],["T_STRING","helper",95],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",95],")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getListPriceDisplayType",95],"(",")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_CASE","case",96],["T_WHITESPACE"," ",96],["T_STRING","Mage_Weee_Model_Tax",96],["T_DOUBLE_COLON","::",96],["T_STRING","DISPLAY_EXCL_DESCR_INCL",96],":",["T_WHITESPACE","\n            ",96],["T_CASE","case",97],["T_WHITESPACE"," ",97],["T_STRING","Mage_Weee_Model_Tax",97],["T_DOUBLE_COLON","::",97],["T_STRING","DISPLAY_EXCL",97],":",["T_WHITESPACE","\n                ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_DOC_COMMENT","\/** @var $select Varien_Db_Select *\/",101],["T_WHITESPACE","\n        ",101],["T_VARIABLE","$select",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$observer",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getEvent",102],"(",")",["T_OBJECT_OPERATOR","->",102],["T_STRING","getSelect",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$table",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$observer",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getEvent",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","getTable",103],"(",")",";",["T_WHITESPACE","\n\n        ",103],["T_VARIABLE","$websiteId",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_INT_CAST","(int)",105],["T_STRING","Mage",105],["T_DOUBLE_COLON","::",105],["T_STRING","app",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getStore",105],"(",["T_VARIABLE","$storeId",105],")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getWebsiteId",105],"(",")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$customerGroupId",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_INT_CAST","(int)",106],["T_STRING","Mage",106],["T_DOUBLE_COLON","::",106],["T_STRING","getSingleton",106],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","getCustomerGroupId",106],"(",")",";",["T_WHITESPACE","\n\n        ",106],["T_VARIABLE","$response",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$observer",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getEvent",108],"(",")",["T_OBJECT_OPERATOR","->",108],["T_STRING","getResponseObject",108],"(",")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$additionalCalculations",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$response",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getAdditionalCalculations",109],"(",")",";",["T_WHITESPACE","\n\n        ",109],["T_VARIABLE","$attributes",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","Mage",111],["T_DOUBLE_COLON","::",111],["T_STRING","getSingleton",111],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",111],")",["T_OBJECT_OPERATOR","->",111],["T_STRING","getWeeeAttributeCodes",111],"(",")",";",["T_WHITESPACE","\n\n        ",111],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$attributes",113],["T_WHITESPACE"," ",113],["T_BOOLEAN_AND","&&",113],["T_WHITESPACE"," ",113],["T_STRING","Mage",113],["T_DOUBLE_COLON","::",113],["T_STRING","helper",113],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",113],")",["T_OBJECT_OPERATOR","->",113],["T_STRING","isDiscounted",113],"(",")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$joinConditions",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_WHITESPACE","\n                ",114],"\"",["T_ENCAPSED_AND_WHITESPACE","discount_percent.entity_id = ",115],["T_CURLY_OPEN","{",115],["T_VARIABLE","$table",115],"}",["T_ENCAPSED_AND_WHITESPACE",".entity_id",115],"\"",",",["T_WHITESPACE","\n                ",115],["T_VARIABLE","$select",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getAdapter",116],"(",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","quoteInto",116],"(",["T_CONSTANT_ENCAPSED_STRING","'discount_percent.website_id = ?'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$websiteId",116],")",",",["T_WHITESPACE","\n                ",116],["T_VARIABLE","$select",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getAdapter",117],"(",")",["T_OBJECT_OPERATOR","->",117],["T_STRING","quoteInto",117],"(",["T_CONSTANT_ENCAPSED_STRING","'discount_percent.customer_group_id = ?'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$customerGroupId",117],")",["T_WHITESPACE","\n            ",117],")",";",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$tableWeeDiscount",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","Mage",119],["T_DOUBLE_COLON","::",119],["T_STRING","getSingleton",119],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",119],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getResource",119],"(",")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getTable",119],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/discount'",119],")",";",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$select",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","joinLeft",120],"(",["T_WHITESPACE","\n                ",120],["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","'discount_percent'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$tableWeeDiscount",121],")",",",["T_WHITESPACE","\n                ",121],["T_STRING","implode",122],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$joinConditions",122],")",",",["T_WHITESPACE","\n                ",122],["T_ARRAY","array",123],"(",")",["T_WHITESPACE","\n            ",123],")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$checkDiscountField",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$select",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getAdapter",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getCheckSql",126],"(",["T_WHITESPACE","\n            ",126],["T_CONSTANT_ENCAPSED_STRING","'discount_percent.value IS NULL'",127],",",["T_WHITESPACE"," ",127],["T_LNUMBER","0",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'discount_percent.value'",127],")",";",["T_WHITESPACE","\n        ",127],["T_FOREACH","foreach",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$attributes",128],["T_WHITESPACE"," ",128],["T_AS","as",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$attribute",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$fieldAlias",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","sprintf",129],"(",["T_CONSTANT_ENCAPSED_STRING","'weee_%s_table.value'",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$attribute",129],")",";",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$checkAdditionalCalculation",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$select",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getAdapter",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","getCheckSql",130],"(","\"",["T_CURLY_OPEN","{",130],["T_VARIABLE","$fieldAlias",130],"}",["T_ENCAPSED_AND_WHITESPACE"," IS NULL",130],"\"",",",["T_WHITESPACE"," ",130],["T_LNUMBER","0",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$fieldAlias",130],")",";",["T_WHITESPACE","\n            ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","Mage",131],["T_DOUBLE_COLON","::",131],["T_STRING","helper",131],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",131],")",["T_OBJECT_OPERATOR","->",131],["T_STRING","isDiscounted",131],"(",")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$additionalCalculations",132],"[","]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","sprintf",132],"(",["T_CONSTANT_ENCAPSED_STRING","'+(%s*(1-(%s\/100)))'",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$checkAdditionalCalculation",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$checkDiscountField",132],")",";",["T_WHITESPACE","\n            ",132],"}",["T_WHITESPACE"," ",133],["T_ELSE","else",133],["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                ",133],["T_VARIABLE","$additionalCalculations",134],"[","]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],"\"",["T_ENCAPSED_AND_WHITESPACE","+(",134],["T_VARIABLE","$checkAdditionalCalculation",134],["T_ENCAPSED_AND_WHITESPACE",")",134],"\"",";",["T_WHITESPACE","\n            ",134],"}",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$response",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","setAdditionalCalculations",137],"(",["T_VARIABLE","$additionalCalculations",137],")",";",["T_WHITESPACE","\n\n        ",137],["T_DOC_COMMENT","\/** @var $rateRequest Varien_Object *\/",139],["T_WHITESPACE","\n        ",139],["T_VARIABLE","$rateRequest",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","Mage",140],["T_DOUBLE_COLON","::",140],["T_STRING","getSingleton",140],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",140],")",["T_OBJECT_OPERATOR","->",140],["T_STRING","getRateRequest",140],"(",")",";",["T_WHITESPACE","\n\n        ",140],["T_VARIABLE","$attributes",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","Mage",142],["T_DOUBLE_COLON","::",142],["T_STRING","getSingleton",142],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",142],")",["T_OBJECT_OPERATOR","->",142],["T_STRING","getWeeeTaxAttributeCodes",142],"(",")",";",["T_WHITESPACE","\n        ",142],["T_FOREACH","foreach",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$attributes",143],["T_WHITESPACE"," ",143],["T_AS","as",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$attribute",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$attributeId",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_INT_CAST","(int)",144],["T_STRING","Mage",144],["T_DOUBLE_COLON","::",144],["T_STRING","getSingleton",144],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",144],")",["T_WHITESPACE","\n                ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","getIdByCode",145],"(",["T_STRING","Mage_Catalog_Model_Product",145],["T_DOUBLE_COLON","::",145],["T_STRING","ENTITY",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$attribute",145],")",";",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$tableAlias",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","sprintf",146],"(",["T_CONSTANT_ENCAPSED_STRING","'weee_%s_table'",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$attribute",146],")",";",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$quotedTableAlias",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$select",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getAdapter",147],"(",")",["T_OBJECT_OPERATOR","->",147],["T_STRING","quoteTableAs",147],"(",["T_VARIABLE","$tableAlias",147],",",["T_WHITESPACE"," ",147],["T_STRING","null",147],")",";",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$attributeSelect",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_getSelect",148],"(",")",";",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$attributeSelect",149],["T_WHITESPACE","\n                ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","from",150],"(",["T_ARRAY","array",150],"(",["T_VARIABLE","$tableAlias",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_STRING","Mage",150],["T_DOUBLE_COLON","::",150],["T_STRING","getSingleton",150],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",150],")",["T_OBJECT_OPERATOR","->",150],["T_STRING","getResource",150],"(",")",["T_OBJECT_OPERATOR","->",150],["T_STRING","getTable",150],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",150],")",")",")",["T_WHITESPACE","\n                ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","where",151],"(","\"",["T_CURLY_OPEN","{",151],["T_VARIABLE","$quotedTableAlias",151],"}",["T_ENCAPSED_AND_WHITESPACE",".attribute_id = ?",151],"\"",",",["T_WHITESPACE"," ",151],["T_VARIABLE","$attributeId",151],")",["T_WHITESPACE","\n                ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","where",152],"(","\"",["T_CURLY_OPEN","{",152],["T_VARIABLE","$quotedTableAlias",152],"}",["T_ENCAPSED_AND_WHITESPACE",".website_id IN(?)",152],"\"",",",["T_WHITESPACE"," ",152],["T_ARRAY","array",152],"(",["T_VARIABLE","$websiteId",152],",",["T_WHITESPACE"," ",152],["T_LNUMBER","0",152],")",")",["T_WHITESPACE","\n                ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","where",153],"(","\"",["T_CURLY_OPEN","{",153],["T_VARIABLE","$quotedTableAlias",153],"}",["T_ENCAPSED_AND_WHITESPACE",".country = ?",153],"\"",",",["T_WHITESPACE"," ",153],["T_VARIABLE","$rateRequest",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getCountryId",153],"(",")",")",["T_WHITESPACE","\n                ",153],["T_OBJECT_OPERATOR","->",154],["T_STRING","where",154],"(","\"",["T_CURLY_OPEN","{",154],["T_VARIABLE","$quotedTableAlias",154],"}",["T_ENCAPSED_AND_WHITESPACE",".state IN(?)",154],"\"",",",["T_WHITESPACE"," ",154],["T_ARRAY","array",154],"(",["T_VARIABLE","$rateRequest",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getRegionId",154],"(",")",",",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'*'",154],")",")",";",["T_WHITESPACE","\n\n            ",154],["T_VARIABLE","$order",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_ARRAY","array",156],"(",["T_WHITESPACE","\n                ",156],["T_STRING","sprintf",157],"(",["T_CONSTANT_ENCAPSED_STRING","'%s.state %s'",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$tableAlias",157],",",["T_WHITESPACE"," ",157],["T_STRING","Varien_Db_Select",157],["T_DOUBLE_COLON","::",157],["T_STRING","SQL_DESC",157],")",",",["T_WHITESPACE","\n                ",157],["T_STRING","sprintf",158],"(",["T_CONSTANT_ENCAPSED_STRING","'%s.website_id %s'",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$tableAlias",158],",",["T_WHITESPACE"," ",158],["T_STRING","Varien_Db_Select",158],["T_DOUBLE_COLON","::",158],["T_STRING","SQL_DESC",158],")",["T_WHITESPACE","\n            ",158],")",";",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$attributeSelect",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","order",160],"(",["T_VARIABLE","$order",160],")",";",["T_WHITESPACE","\n\n            ",160],["T_VARIABLE","$joinCondition",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","sprintf",162],"(",["T_CONSTANT_ENCAPSED_STRING","'%s.entity_id = %s.entity_id'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$table",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$quotedTableAlias",162],")",";",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$select",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","joinLeft",163],"(",["T_WHITESPACE","\n                ",163],["T_ARRAY","array",164],"(",["T_VARIABLE","$tableAlias",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$attributeSelect",164],")",",",["T_WHITESPACE","\n                ",164],["T_VARIABLE","$joinCondition",165],",",["T_WHITESPACE","\n                ",165],["T_ARRAY","array",166],"(",")",["T_WHITESPACE","\n            ",166],")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n        ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Get empty select object\n     *\n     * @return Varien_Db_Select\n     *\/",172],["T_WHITESPACE","\n    ",176],["T_PROTECTED","protected",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","_getSelect",177],"(",")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_STRING","Mage",179],["T_DOUBLE_COLON","::",179],["T_STRING","getSingleton",179],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",179],")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getResource",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getReadConnection",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","select",179],"(",")",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Add new attribute type to manage attributes interface\n     *\n     * @param   Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",182],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","addWeeeTaxAttributeType",188],"(",["T_STRING","Varien_Event_Observer",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$observer",188],")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_COMMENT","\/\/ adminhtml_product_attribute_types\n",190],["T_WHITESPACE","\n        ",191],["T_VARIABLE","$response",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$observer",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getEvent",192],"(",")",["T_OBJECT_OPERATOR","->",192],["T_STRING","getResponse",192],"(",")",";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$types",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$response",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getTypes",193],"(",")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$types",194],"[","]",["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_ARRAY","array",194],"(",["T_WHITESPACE","\n            ",194],["T_CONSTANT_ENCAPSED_STRING","'value'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'weee'",195],",",["T_WHITESPACE","\n            ",195],["T_CONSTANT_ENCAPSED_STRING","'label'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","helper",196],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",196],")",["T_OBJECT_OPERATOR","->",196],["T_STRING","__",196],"(",["T_CONSTANT_ENCAPSED_STRING","'Fixed Product Tax'",196],")",",",["T_WHITESPACE","\n            ",196],["T_CONSTANT_ENCAPSED_STRING","'hide_fields'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_ARRAY","array",197],"(",["T_WHITESPACE","\n                ",197],["T_CONSTANT_ENCAPSED_STRING","'is_unique'",198],",",["T_WHITESPACE","\n                ",198],["T_CONSTANT_ENCAPSED_STRING","'is_required'",199],",",["T_WHITESPACE","\n                ",199],["T_CONSTANT_ENCAPSED_STRING","'frontend_class'",200],",",["T_WHITESPACE","\n                ",200],["T_CONSTANT_ENCAPSED_STRING","'is_configurable'",201],",",["T_WHITESPACE","\n\n                ",201],["T_CONSTANT_ENCAPSED_STRING","'_scope'",203],",",["T_WHITESPACE","\n                ",203],["T_CONSTANT_ENCAPSED_STRING","'_default_value'",204],",",["T_WHITESPACE","\n                ",204],["T_CONSTANT_ENCAPSED_STRING","'_front_fieldset'",205],",",["T_WHITESPACE","\n            ",205],")",",",["T_WHITESPACE","\n            ",206],["T_CONSTANT_ENCAPSED_STRING","'disabled_types'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_ARRAY","array",207],"(",["T_WHITESPACE","\n                ",207],["T_STRING","Mage_Catalog_Model_Product_Type",208],["T_DOUBLE_COLON","::",208],["T_STRING","TYPE_GROUPED",208],",",["T_WHITESPACE","\n            ",208],")",["T_WHITESPACE","\n        ",209],")",";",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$response",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","setTypes",212],"(",["T_VARIABLE","$types",212],")",";",["T_WHITESPACE","\n\n        ",212],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Automaticaly assign backend model to weee attributes\n     *\n     * @param   Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",217],["T_WHITESPACE","\n    ",222],["T_PUBLIC","public",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","assignBackendModelToAttribute",223],"(",["T_STRING","Varien_Event_Observer",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$observer",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$backendModel",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_STRING","Mage_Weee_Model_Attribute_Backend_Weee_Tax",225],["T_DOUBLE_COLON","::",225],["T_STRING","getBackendModelName",225],"(",")",";",["T_WHITESPACE","\n        ",225],["T_DOC_COMMENT","\/** @var $object Mage_Eav_Model_Entity_Attribute_Abstract *\/",226],["T_WHITESPACE","\n        ",226],["T_VARIABLE","$object",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$observer",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getEvent",227],"(",")",["T_OBJECT_OPERATOR","->",227],["T_STRING","getAttribute",227],"(",")",";",["T_WHITESPACE","\n        ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$object",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getFrontendInput",228],"(",")",["T_WHITESPACE"," ",228],["T_IS_EQUAL","==",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'weee'",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$object",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","setBackendModel",229],"(",["T_VARIABLE","$backendModel",229],")",";",["T_WHITESPACE","\n            ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(","!",["T_VARIABLE","$object",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getApplyTo",230],"(",")",")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$applyTo",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_ARRAY","array",231],"(",")",";",["T_WHITESPACE","\n                ",231],["T_FOREACH","foreach",232],["T_WHITESPACE"," ",232],"(",["T_STRING","Mage_Catalog_Model_Product_Type",232],["T_DOUBLE_COLON","::",232],["T_STRING","getOptions",232],"(",")",["T_WHITESPACE"," ",232],["T_AS","as",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$option",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                    ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_VARIABLE","$option",233],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",233],"]",["T_WHITESPACE"," ",233],["T_IS_EQUAL","==",233],["T_WHITESPACE"," ",233],["T_STRING","Mage_Catalog_Model_Product_Type",233],["T_DOUBLE_COLON","::",233],["T_STRING","TYPE_GROUPED",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n                        ",233],["T_CONTINUE","continue",234],";",["T_WHITESPACE","\n                    ",234],"}",["T_WHITESPACE","\n                    ",235],["T_VARIABLE","$applyTo",236],"[","]",["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$option",236],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",236],"]",";",["T_WHITESPACE","\n                ",236],"}",["T_WHITESPACE","\n                ",237],["T_VARIABLE","$object",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","setApplyTo",238],"(",["T_VARIABLE","$applyTo",238],")",";",["T_WHITESPACE","\n            ",238],"}",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n\n        ",240],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],";",["T_WHITESPACE","\n    ",242],"}",["T_WHITESPACE","\n\n    ",243],["T_DOC_COMMENT","\/**\n     * Add custom element type for attributes form\n     *\n     * @param   Varien_Event_Observer $observer\n     *\/",245],["T_WHITESPACE","\n    ",249],["T_PUBLIC","public",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","updateElementTypes",250],"(",["T_STRING","Varien_Event_Observer",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$observer",250],")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$response",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$observer",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getEvent",252],"(",")",["T_OBJECT_OPERATOR","->",252],["T_STRING","getResponse",252],"(",")",";",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$types",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$response",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getTypes",253],"(",")",";",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$types",254],"[",["T_CONSTANT_ENCAPSED_STRING","'weee'",254],"]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_STRING","Mage",254],["T_DOUBLE_COLON","::",254],["T_STRING","getConfig",254],"(",")",["T_OBJECT_OPERATOR","->",254],["T_STRING","getBlockClassName",254],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/element_weee_tax'",254],")",";",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$response",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","setTypes",255],"(",["T_VARIABLE","$types",255],")",";",["T_WHITESPACE","\n        ",255],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Update WEEE amounts discount percents\n     *\n     * @param   Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",259],["T_WHITESPACE","\n    ",264],["T_PUBLIC","public",265],["T_WHITESPACE"," ",265],["T_FUNCTION","function",265],["T_WHITESPACE"," ",265],["T_STRING","updateDiscountPercents",265],"(",["T_STRING","Varien_Event_Observer",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$observer",265],")",["T_WHITESPACE","\n    ",265],"{",["T_WHITESPACE","\n        ",266],["T_IF","if",267],["T_WHITESPACE"," ",267],"(","!",["T_STRING","Mage",267],["T_DOUBLE_COLON","::",267],["T_STRING","helper",267],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",267],")",["T_OBJECT_OPERATOR","->",267],["T_STRING","isEnabled",267],"(",")",")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n            ",267],["T_RETURN","return",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$this",268],";",["T_WHITESPACE","\n        ",268],"}",["T_WHITESPACE","\n\n        ",269],["T_VARIABLE","$productCondition",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$observer",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getEvent",271],"(",")",["T_OBJECT_OPERATOR","->",271],["T_STRING","getProductCondition",271],"(",")",";",["T_WHITESPACE","\n        ",271],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$productCondition",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$eventProduct",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$productCondition",273],";",["T_WHITESPACE","\n        ",273],"}",["T_WHITESPACE"," ",274],["T_ELSE","else",274],["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$eventProduct",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$observer",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getEvent",275],"(",")",["T_OBJECT_OPERATOR","->",275],["T_STRING","getProduct",275],"(",")",";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE","\n        ",276],["T_STRING","Mage",277],["T_DOUBLE_COLON","::",277],["T_STRING","getModel",277],"(",["T_CONSTANT_ENCAPSED_STRING","'weee\/tax'",277],")",["T_OBJECT_OPERATOR","->",277],["T_STRING","updateProductsDiscountPercent",277],"(",["T_VARIABLE","$eventProduct",277],")",";",["T_WHITESPACE","\n\n        ",277],["T_RETURN","return",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],";",["T_WHITESPACE","\n    ",279],"}",["T_WHITESPACE","\n\n    ",280],["T_DOC_COMMENT","\/**\n     * Update configurable options of the product view page\n     *\n     * @param   Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",282],["T_WHITESPACE","\n    ",287],["T_PUBLIC","public",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","updateCofigurableProductOptions",288],"(",["T_STRING","Varien_Event_Observer",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$observer",288],")",["T_WHITESPACE","\n    ",288],"{",["T_WHITESPACE","\n        ",289],["T_COMMENT","\/* @var $weeeHelper Mage_Weee_Helper_Data *\/",290],["T_WHITESPACE","\n        ",290],["T_VARIABLE","$weeeHelper",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","Mage",291],["T_DOUBLE_COLON","::",291],["T_STRING","helper",291],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",291],")",";",["T_WHITESPACE","\n        ",291],["T_IF","if",292],["T_WHITESPACE"," ",292],"(","!",["T_VARIABLE","$weeeHelper",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","isEnabled",292],"(",")",")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n            ",292],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],";",["T_WHITESPACE","\n        ",293],"}",["T_WHITESPACE","\n\n        ",294],["T_VARIABLE","$response",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$observer",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getEvent",296],"(",")",["T_OBJECT_OPERATOR","->",296],["T_STRING","getResponseObject",296],"(",")",";",["T_WHITESPACE","\n        ",296],["T_VARIABLE","$options",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$response",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getAdditionalOptions",297],"(",")",";",["T_WHITESPACE","\n\n        ",297],["T_VARIABLE","$eventProduct",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$observer",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getEvent",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","getProduct",299],"(",")",";",["T_WHITESPACE","\n\n        ",299],["T_VARIABLE","$_product",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_VARIABLE","$eventProduct",301],["T_WHITESPACE"," ",301],"?",["T_WHITESPACE"," ",301],["T_VARIABLE","$eventProduct",301],["T_WHITESPACE"," ",301],":",["T_WHITESPACE"," ",301],["T_STRING","Mage",301],["T_DOUBLE_COLON","::",301],["T_STRING","registry",301],"(",["T_CONSTANT_ENCAPSED_STRING","'current_product'",301],")",";",["T_WHITESPACE","\n\n        ",301],["T_IF","if",303],["T_WHITESPACE"," ",303],"(","!",["T_VARIABLE","$_product",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],";",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n\n        ",305],["T_VARIABLE","$amount",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$weeeHelper",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getAmountForDisplay",307],"(",["T_VARIABLE","$_product",307],")",";",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$origAmount",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$weeeHelper",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getOriginalAmount",308],"(",["T_VARIABLE","$_product",308],")",";",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$attributes",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$weeeHelper",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getProductWeeeAttributes",309],"(",["T_VARIABLE","$_product",309],",",["T_WHITESPACE"," ",309],["T_STRING","null",309],",",["T_WHITESPACE"," ",309],["T_STRING","null",309],",",["T_WHITESPACE"," ",309],["T_STRING","null",309],",",["T_WHITESPACE"," ",309],["T_VARIABLE","$weeeHelper",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","isTaxable",309],"(",")",")",";",["T_WHITESPACE","\n        ",309],["T_VARIABLE","$amountInclTaxes",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$weeeHelper",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getAmountInclTaxes",310],"(",["T_VARIABLE","$attributes",310],")",";",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$taxes",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$amountInclTaxes",311],["T_WHITESPACE"," ",311],"-",["T_WHITESPACE"," ",311],["T_VARIABLE","$amount",311],";",["T_WHITESPACE","\n\n        ",311],["T_IF","if",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$weeeHelper",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","typeOfDisplay",313],"(",["T_VARIABLE","$_product",313],",",["T_WHITESPACE"," ",313],["T_LNUMBER","3",313],")",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n            ",313],["T_COMMENT","\/\/ don't show weee as part of the product\n",314],["T_WHITESPACE","            ",315],["T_VARIABLE","$options",315],"[",["T_CONSTANT_ENCAPSED_STRING","'oldPlusDisposition'",315],"]",["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_LNUMBER","0",315],";",["T_WHITESPACE","\n            ",315],["T_VARIABLE","$options",316],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDisposition'",316],"]",["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_LNUMBER","0",316],";",["T_WHITESPACE","\n            ",316],["T_VARIABLE","$options",317],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDispositionTax'",317],"]",["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_LNUMBER","0",317],";",["T_WHITESPACE","\n        ",317],"}",["T_WHITESPACE"," ",318],["T_ELSE","else",318],["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$options",319],"[",["T_CONSTANT_ENCAPSED_STRING","'oldPlusDisposition'",319],"]",["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$origAmount",319],";",["T_WHITESPACE","\n            ",319],["T_VARIABLE","$options",320],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDisposition'",320],"]",["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$amount",320],";",["T_WHITESPACE","\n            ",320],["T_VARIABLE","$options",321],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDispositionTax'",321],"]",["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$taxes",321],["T_WHITESPACE"," ",321],"<",["T_WHITESPACE"," ",321],["T_LNUMBER","0",321],")",["T_WHITESPACE"," ",321],"?",["T_WHITESPACE"," ",321],["T_LNUMBER","0",321],["T_WHITESPACE"," ",321],":",["T_WHITESPACE"," ",321],["T_VARIABLE","$taxes",321],";",["T_WHITESPACE","\n        ",321],"}",["T_WHITESPACE","\n\n        ",322],["T_COMMENT","\/\/ Exclude Weee amount from excluding tax amount\n",324],["T_WHITESPACE","        ",325],["T_IF","if",325],["T_WHITESPACE"," ",325],"(","!",["T_VARIABLE","$weeeHelper",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","typeOfDisplay",325],"(",["T_VARIABLE","$_product",325],",",["T_WHITESPACE"," ",325],["T_ARRAY","array",325],"(",["T_LNUMBER","0",325],",",["T_WHITESPACE"," ",325],["T_LNUMBER","1",325],",",["T_WHITESPACE"," ",325],["T_LNUMBER","4",325],")",")",")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$options",326],"[",["T_CONSTANT_ENCAPSED_STRING","'exclDisposition'",326],"]",["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_STRING","true",326],";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n\n        ",327],["T_VARIABLE","$response",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","setAdditionalOptions",329],"(",["T_VARIABLE","$options",329],")",";",["T_WHITESPACE","\n\n        ",329],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],";",["T_WHITESPACE","\n    ",331],"}",["T_WHITESPACE","\n\n    ",332],["T_DOC_COMMENT","\/**\n     * Process bundle options selection for prepare view json\n     *\n     * @param   Varien_Event_Observer $observer\n     * @return  Mage_Weee_Model_Observer\n     *\/",334],["T_WHITESPACE","\n    ",339],["T_PUBLIC","public",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","updateBundleProductOptions",340],"(",["T_STRING","Varien_Event_Observer",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$observer",340],")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_COMMENT","\/* @var $weeeHelper Mage_Weee_Helper_Data *\/",342],["T_WHITESPACE","\n        ",342],["T_VARIABLE","$weeeHelper",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_STRING","Mage",343],["T_DOUBLE_COLON","::",343],["T_STRING","helper",343],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",343],")",";",["T_WHITESPACE","\n        ",343],["T_IF","if",344],["T_WHITESPACE"," ",344],"(","!",["T_VARIABLE","$weeeHelper",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","isEnabled",344],"(",")",")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],";",["T_WHITESPACE","\n        ",345],"}",["T_WHITESPACE","\n\n        ",346],["T_VARIABLE","$response",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$observer",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getEvent",348],"(",")",["T_OBJECT_OPERATOR","->",348],["T_STRING","getResponseObject",348],"(",")",";",["T_WHITESPACE","\n        ",348],["T_VARIABLE","$selection",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_VARIABLE","$observer",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getEvent",349],"(",")",["T_OBJECT_OPERATOR","->",349],["T_STRING","getSelection",349],"(",")",";",["T_WHITESPACE","\n        ",349],["T_VARIABLE","$options",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$response",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getAdditionalOptions",350],"(",")",";",["T_WHITESPACE","\n\n        ",350],["T_VARIABLE","$_product",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_STRING","Mage",352],["T_DOUBLE_COLON","::",352],["T_STRING","registry",352],"(",["T_CONSTANT_ENCAPSED_STRING","'current_product'",352],")",";",["T_WHITESPACE","\n\n        ",352],["T_VARIABLE","$typeDynamic",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_STRING","Mage_Bundle_Block_Adminhtml_Catalog_Product_Edit_Tab_Attributes_Extend",354],["T_DOUBLE_COLON","::",354],["T_STRING","DYNAMIC",354],";",["T_WHITESPACE","\n        ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(","!",["T_VARIABLE","$_product",355],["T_WHITESPACE"," ",355],["T_BOOLEAN_OR","||",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$_product",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getPriceType",355],"(",")",["T_WHITESPACE"," ",355],["T_IS_NOT_EQUAL","!=",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$typeDynamic",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_RETURN","return",356],["T_WHITESPACE"," ",356],["T_VARIABLE","$this",356],";",["T_WHITESPACE","\n        ",356],"}",["T_WHITESPACE","\n\n        ",357],["T_VARIABLE","$amount",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$weeeHelper",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getAmountForDisplay",359],"(",["T_VARIABLE","$selection",359],")",";",["T_WHITESPACE","\n        ",359],["T_VARIABLE","$attributes",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$weeeHelper",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getProductWeeeAttributes",360],"(",["T_VARIABLE","$_product",360],",",["T_WHITESPACE"," ",360],["T_STRING","null",360],",",["T_WHITESPACE"," ",360],["T_STRING","null",360],",",["T_WHITESPACE"," ",360],["T_STRING","null",360],",",["T_WHITESPACE"," ",360],["T_VARIABLE","$weeeHelper",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","isTaxable",360],"(",")",")",";",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$amountInclTaxes",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_VARIABLE","$weeeHelper",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getAmountInclTaxes",361],"(",["T_VARIABLE","$attributes",361],")",";",["T_WHITESPACE","\n        ",361],["T_VARIABLE","$taxes",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_VARIABLE","$amountInclTaxes",362],["T_WHITESPACE"," ",362],"-",["T_WHITESPACE"," ",362],["T_VARIABLE","$amount",362],";",["T_WHITESPACE","\n\n        ",362],["T_IF","if",364],["T_WHITESPACE"," ",364],"(",["T_VARIABLE","$weeeHelper",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","typeOfDisplay",364],"(",["T_VARIABLE","$_product",364],",",["T_WHITESPACE"," ",364],["T_LNUMBER","3",364],")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_COMMENT","\/\/ don't show weee as part of the product\n",365],["T_WHITESPACE","            ",366],["T_VARIABLE","$options",366],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDisposition'",366],"]",["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_LNUMBER","0",366],";",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$options",367],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDispositionTax'",367],"]",["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_LNUMBER","0",367],";",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE"," ",368],["T_ELSE","else",368],["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n            ",368],["T_VARIABLE","$options",369],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDisposition'",369],"]",["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$amount",369],";",["T_WHITESPACE","\n            ",369],["T_VARIABLE","$options",370],"[",["T_CONSTANT_ENCAPSED_STRING","'plusDispositionTax'",370],"]",["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],"(",["T_VARIABLE","$taxes",370],["T_WHITESPACE"," ",370],"<",["T_WHITESPACE"," ",370],["T_LNUMBER","0",370],")",["T_WHITESPACE"," ",370],"?",["T_WHITESPACE"," ",370],["T_LNUMBER","0",370],["T_WHITESPACE"," ",370],":",["T_WHITESPACE"," ",370],["T_VARIABLE","$taxes",370],";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n\n        ",371],["T_COMMENT","\/\/ Exclude Weee amount from excluding tax amount\n",373],["T_WHITESPACE","        ",374],["T_IF","if",374],["T_WHITESPACE"," ",374],"(","!",["T_VARIABLE","$weeeHelper",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","typeOfDisplay",374],"(",["T_VARIABLE","$_product",374],",",["T_WHITESPACE"," ",374],["T_ARRAY","array",374],"(",["T_LNUMBER","0",374],",",["T_WHITESPACE"," ",374],["T_LNUMBER","1",374],",",["T_WHITESPACE"," ",374],["T_LNUMBER","4",374],")",")",")",["T_WHITESPACE"," ",374],"{",["T_WHITESPACE","\n            ",374],["T_VARIABLE","$options",375],"[",["T_CONSTANT_ENCAPSED_STRING","'exclDisposition'",375],"]",["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_STRING","true",375],";",["T_WHITESPACE","\n        ",375],"}",["T_WHITESPACE","\n\n        ",376],["T_VARIABLE","$response",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","setAdditionalOptions",378],"(",["T_VARIABLE","$options",378],")",";",["T_WHITESPACE","\n\n        ",378],["T_RETURN","return",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],";",["T_WHITESPACE","\n    ",380],"}",["T_WHITESPACE","\n\n    ",381],["T_DOC_COMMENT","\/**\n     * Notify weee helper about the admin session quote store when creating order\n     * in the backend\n     *\n     * @param Varien_Event_Observer $observer\n     * @return Mage_Weee_Model_Observer\n     *\/",383],["T_WHITESPACE","\n    ",389],["T_PUBLIC","public",390],["T_WHITESPACE"," ",390],["T_FUNCTION","function",390],["T_WHITESPACE"," ",390],["T_STRING","setSessionQuoteStore",390],"(",["T_STRING","Varien_Event_Observer",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$observer",390],")",["T_WHITESPACE","\n    ",390],"{",["T_WHITESPACE","\n        ",391],["T_COMMENT","\/* @var $weeeHelper Mage_Weee_Helper_Data *\/",392],["T_WHITESPACE","\n        ",392],["T_VARIABLE","$weeeHelper",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_STRING","Mage",393],["T_DOUBLE_COLON","::",393],["T_STRING","helper",393],"(",["T_CONSTANT_ENCAPSED_STRING","'weee'",393],")",";",["T_WHITESPACE","\n\n        ",393],["T_VARIABLE","$sessionQuote",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_VARIABLE","$observer",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","getEvent",395],"(",")",["T_OBJECT_OPERATOR","->",395],["T_STRING","getSessionQuote",395],"(",")",";",["T_WHITESPACE","\n        ",395],["T_IF","if",396],["T_WHITESPACE"," ",396],"(",["T_VARIABLE","$sessionQuote",396],")",["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n            ",396],["T_VARIABLE","$weeeHelper",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","setStore",397],"(",["T_VARIABLE","$sessionQuote",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getStore",397],"(",")",")",";",["T_WHITESPACE","\n        ",397],"}",["T_WHITESPACE","\n\n        ",398],["T_RETURN","return",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$this",400],";",["T_WHITESPACE","\n    ",400],"}",["T_WHITESPACE","\n",401],"}",["T_WHITESPACE","\n\n",402]]