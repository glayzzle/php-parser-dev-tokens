[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_CatalogSearch\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog search helper\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",31],["T_CLASS","class",32],["T_WHITESPACE"," ",32],["T_STRING","Mage_CatalogSearch_Helper_Data",32],["T_WHITESPACE"," ",32],["T_EXTENDS","extends",32],["T_WHITESPACE"," ",32],["T_STRING","Mage_Core_Helper_Abstract",32],["T_WHITESPACE","\n",32],"{",["T_WHITESPACE","\n    ",33],["T_DOC_COMMENT","\/**\n     * Query variable name\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","QUERY_VAR_NAME",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'q'",37],";",["T_WHITESPACE","\n\n    ",37],["T_COMMENT","\/*\n     * Maximum query length\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","MAX_QUERY_LEN",42],["T_WHITESPACE","  ",42],"=",["T_WHITESPACE"," ",42],["T_LNUMBER","200",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Query object\n     *\n     * @var Mage_CatalogSearch_Model_Query\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_query",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Query string\n     *\n     * @var string\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_queryText",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Note messages\n     *\n     * @var array\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_messages",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",")",";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Is a maximum length cut\n     *\n     * @var bool\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_isMaxLength",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","false",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Search engine model\n     *\n     * @var Mage_CatalogSearch_Model_Resource_Fulltext_Engine\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$_engine",77],";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Retrieve search query parameter name\n     *\n     * @return string\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","getQueryParamName",84],"(",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_STRING","self",86],["T_DOUBLE_COLON","::",86],["T_STRING","QUERY_VAR_NAME",86],";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Retrieve query model object\n     *\n     * @return Mage_CatalogSearch_Model_Query\n     *\/",89],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","getQuery",94],"(",")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_query",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_query",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","Mage",97],["T_DOUBLE_COLON","::",97],["T_STRING","getModel",97],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/query'",97],")",["T_WHITESPACE","\n                ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","loadByQuery",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getQueryText",98],"(",")",")",";",["T_WHITESPACE","\n            ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_query",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getId",99],"(",")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n                ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_query",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","setQueryText",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getQueryText",100],"(",")",")",";",["T_WHITESPACE","\n            ",100],"}",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_query",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Is a minimum query length\n     *\n     * @return bool\n     *\/",106],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","isMinQueryLength",111],"(",")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$minQueryLength",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getMinQueryLength",113],"(",")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$thisQueryLength",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","Mage",114],["T_DOUBLE_COLON","::",114],["T_STRING","helper",114],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",114],")",["T_OBJECT_OPERATOR","->",114],["T_STRING","strlen",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getQueryText",114],"(",")",")",";",["T_WHITESPACE","\n        ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],"!",["T_VARIABLE","$thisQueryLength",115],["T_WHITESPACE"," ",115],["T_BOOLEAN_OR","||",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$minQueryLength",115],["T_WHITESPACE"," ",115],["T_IS_NOT_IDENTICAL","!==",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","''",115],["T_WHITESPACE"," ",115],["T_BOOLEAN_AND","&&",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$thisQueryLength",115],["T_WHITESPACE"," ",115],"<",["T_WHITESPACE"," ",115],["T_VARIABLE","$minQueryLength",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Retrieve search query text\n     *\n     * @return string\n     *\/",118],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","getQueryText",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(","!",["T_ISSET","isset",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_queryText",125],")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_queryText",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_getRequest",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getParam",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getQueryParamName",126],"(",")",")",";",["T_WHITESPACE","\n            ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_queryText",127],["T_WHITESPACE"," ",127],["T_IS_IDENTICAL","===",127],["T_WHITESPACE"," ",127],["T_STRING","null",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_queryText",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","''",128],";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_COMMENT","\/* @var $stringHelper Mage_Core_Helper_String *\/",130],["T_WHITESPACE","\n                ",130],["T_VARIABLE","$stringHelper",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","Mage",131],["T_DOUBLE_COLON","::",131],["T_STRING","helper",131],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",131],")",";",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_queryText",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","is_array",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_queryText",132],")",["T_WHITESPACE"," ",132],"?",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","''",132],["T_WHITESPACE","\n                    ",132],":",["T_WHITESPACE"," ",133],["T_VARIABLE","$stringHelper",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","cleanString",133],"(",["T_STRING","trim",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_queryText",133],")",")",";",["T_WHITESPACE","\n\n                ",133],["T_VARIABLE","$maxQueryLength",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getMaxQueryLength",135],"(",")",";",["T_WHITESPACE","\n                ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$maxQueryLength",136],["T_WHITESPACE"," ",136],["T_IS_NOT_IDENTICAL","!==",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","''",136],["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$stringHelper",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","strlen",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_queryText",136],")",["T_WHITESPACE"," ",136],">",["T_WHITESPACE"," ",136],["T_VARIABLE","$maxQueryLength",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                    ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_queryText",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$stringHelper",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","substr",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_queryText",137],",",["T_WHITESPACE"," ",137],["T_LNUMBER","0",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$maxQueryLength",137],")",";",["T_WHITESPACE","\n                    ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_isMaxLength",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","true",138],";",["T_WHITESPACE","\n                ",138],"}",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n        ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_queryText",142],";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Retrieve HTML escaped search query\n     *\n     * @return string\n     *\/",145],["T_WHITESPACE","\n    ",149],["T_PUBLIC","public",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","getEscapedQueryText",150],"(",")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","escapeHtml",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getQueryText",152],"(",")",")",";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Retrieve suggest collection for query\n     *\n     * @return Mage_CatalogSearch_Model_Resource_Query_Collection\n     *\/",155],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","getSuggestCollection",160],"(",")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getQuery",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","getSuggestCollection",162],"(",")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Retrieve result page url and set \"secure\" param to avoid confirm\n     * message when we submit form from secure page to unsecure\n     *\n     * @param   string $query\n     * @return  string\n     *\/",165],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","getResultUrl",172],"(",["T_VARIABLE","$query",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","null",172],")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_getUrl",174],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/result'",174],",",["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",["T_WHITESPACE","\n            ",174],["T_CONSTANT_ENCAPSED_STRING","'_query'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_ARRAY","array",175],"(",["T_STRING","self",175],["T_DOUBLE_COLON","::",175],["T_STRING","QUERY_VAR_NAME",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$query",175],")",",",["T_WHITESPACE","\n            ",175],["T_CONSTANT_ENCAPSED_STRING","'_secure'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_getApp",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","getFrontController",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","getRequest",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","isSecure",176],"(",")",["T_WHITESPACE","\n        ",176],")",")",";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n\n    ",178],["T_DOC_COMMENT","\/**\n     * Retrieve suggest url\n     *\n     * @return string\n     *\/",180],["T_WHITESPACE","\n    ",184],["T_PUBLIC","public",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","getSuggestUrl",185],"(",")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_getUrl",187],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/ajax\/suggest'",187],",",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",["T_WHITESPACE","\n            ",187],["T_CONSTANT_ENCAPSED_STRING","'_secure'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_getApp",188],"(",")",["T_OBJECT_OPERATOR","->",188],["T_STRING","getStore",188],"(",")",["T_OBJECT_OPERATOR","->",188],["T_STRING","isCurrentlySecure",188],"(",")",["T_WHITESPACE","\n        ",188],")",")",";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_DOC_COMMENT","\/**\n     * Get App\n     *\n     * @return Mage_Core_Model_App\n     *\/",192],["T_WHITESPACE","\n    ",196],["T_PROTECTED","protected",197],["T_WHITESPACE"," ",197],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","_getApp",197],"(",")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_STRING","Mage",199],["T_DOUBLE_COLON","::",199],["T_STRING","app",199],"(",")",";",["T_WHITESPACE","\n    ",199],"}",["T_WHITESPACE","\n\n    ",200],["T_DOC_COMMENT","\/**\n     * Retrieve search term url\n     *\n     * @return string\n     *\/",202],["T_WHITESPACE","\n    ",206],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","getSearchTermUrl",207],"(",")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_getUrl",209],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/term\/popular'",209],")",";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Retrieve advanced search URL\n     *\n     * @return string\n     *\/",212],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","getAdvancedSearchUrl",217],"(",")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_getUrl",219],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/advanced'",219],")",";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n\n    ",220],["T_DOC_COMMENT","\/**\n     * Retrieve minimum query length\n     *\n     * @param mixed $store\n     * @return int|string\n     *\/",222],["T_WHITESPACE","\n    ",227],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","getMinQueryLength",228],"(",["T_VARIABLE","$store",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","null",228],")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_STRING","Mage",230],["T_DOUBLE_COLON","::",230],["T_STRING","getStoreConfig",230],"(",["T_STRING","Mage_CatalogSearch_Model_Query",230],["T_DOUBLE_COLON","::",230],["T_STRING","XML_PATH_MIN_QUERY_LENGTH",230],",",["T_WHITESPACE"," ",230],["T_VARIABLE","$store",230],")",";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Retrieve maximum query length\n     *\n     * @param mixed $store\n     * @return int|string\n     *\/",233],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","getMaxQueryLength",239],"(",["T_VARIABLE","$store",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","null",239],")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","Mage",241],["T_DOUBLE_COLON","::",241],["T_STRING","getStoreConfig",241],"(",["T_STRING","Mage_CatalogSearch_Model_Query",241],["T_DOUBLE_COLON","::",241],["T_STRING","XML_PATH_MAX_QUERY_LENGTH",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$store",241],")",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Retrieve maximum query words count for like search\n     *\n     * @param mixed $store\n     * @return int\n     *\/",244],["T_WHITESPACE","\n    ",249],["T_PUBLIC","public",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","getMaxQueryWords",250],"(",["T_VARIABLE","$store",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","null",250],")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_STRING","Mage",252],["T_DOUBLE_COLON","::",252],["T_STRING","getStoreConfig",252],"(",["T_STRING","Mage_CatalogSearch_Model_Query",252],["T_DOUBLE_COLON","::",252],["T_STRING","XML_PATH_MAX_QUERY_WORDS",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$store",252],")",";",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Add Note message\n     *\n     * @param string $message\n     * @return Mage_CatalogSearch_Helper_Data\n     *\/",255],["T_WHITESPACE","\n    ",260],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","addNoteMessage",261],"(",["T_VARIABLE","$message",261],")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_messages",263],"[","]",["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$message",263],";",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Set Note messages\n     *\n     * @param array $messages\n     * @return Mage_CatalogSearch_Helper_Data\n     *\/",267],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","setNoteMessages",273],"(",["T_ARRAY","array",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$messages",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_messages",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$messages",275],";",["T_WHITESPACE","\n        ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n\n    ",277],["T_DOC_COMMENT","\/**\n     * Retrieve Current Note messages\n     *\n     * @return array\n     *\/",279],["T_WHITESPACE","\n    ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","getNoteMessages",284],"(",")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_messages",286],";",["T_WHITESPACE","\n    ",286],"}",["T_WHITESPACE","\n\n    ",287],["T_DOC_COMMENT","\/**\n     * Check query of a warnings\n     *\n     * @param mixed $store\n     * @return Mage_CatalogSearch_Helper_Data\n     *\/",289],["T_WHITESPACE","\n    ",294],["T_PUBLIC","public",295],["T_WHITESPACE"," ",295],["T_FUNCTION","function",295],["T_WHITESPACE"," ",295],["T_STRING","checkNotes",295],"(",["T_VARIABLE","$store",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_STRING","null",295],")",["T_WHITESPACE","\n    ",295],"{",["T_WHITESPACE","\n        ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_isMaxLength",297],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","addNoteMessage",298],"(",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","__",298],"(",["T_CONSTANT_ENCAPSED_STRING","'Maximum Search query length is %s. Your query was cut.'",298],",",["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getMaxQueryLength",298],"(",")",")",")",";",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE","\n\n        ",299],["T_COMMENT","\/* @var $stringHelper Mage_Core_Helper_String *\/",301],["T_WHITESPACE","\n        ",301],["T_VARIABLE","$stringHelper",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","Mage",302],["T_DOUBLE_COLON","::",302],["T_STRING","helper",302],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",302],")",";",["T_WHITESPACE","\n\n        ",302],["T_VARIABLE","$searchType",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_STRING","Mage",304],["T_DOUBLE_COLON","::",304],["T_STRING","getStoreConfig",304],"(",["T_STRING","Mage_CatalogSearch_Model_Fulltext",304],["T_DOUBLE_COLON","::",304],["T_STRING","XML_PATH_CATALOG_SEARCH_TYPE",304],")",";",["T_WHITESPACE","\n        ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$searchType",305],["T_WHITESPACE"," ",305],["T_IS_EQUAL","==",305],["T_WHITESPACE"," ",305],["T_STRING","Mage_CatalogSearch_Model_Fulltext",305],["T_DOUBLE_COLON","::",305],["T_STRING","SEARCH_TYPE_COMBINE",305],["T_WHITESPACE","\n            ",305],["T_BOOLEAN_OR","||",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$searchType",306],["T_WHITESPACE"," ",306],["T_IS_EQUAL","==",306],["T_WHITESPACE"," ",306],["T_STRING","Mage_CatalogSearch_Model_Fulltext",306],["T_DOUBLE_COLON","::",306],["T_STRING","SEARCH_TYPE_LIKE",306],["T_WHITESPACE","\n        ",306],")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$wordsFull",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$stringHelper",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","splitWords",308],"(",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getQueryText",308],"(",")",",",["T_WHITESPACE"," ",308],["T_STRING","true",308],")",";",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$wordsLike",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$stringHelper",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","splitWords",309],"(",["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getQueryText",309],"(",")",",",["T_WHITESPACE"," ",309],["T_STRING","true",309],",",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getMaxQueryWords",309],"(",")",")",";",["T_WHITESPACE","\n            ",309],["T_IF","if",310],["T_WHITESPACE"," ",310],"(",["T_STRING","count",310],"(",["T_VARIABLE","$wordsFull",310],")",["T_WHITESPACE"," ",310],">",["T_WHITESPACE"," ",310],["T_STRING","count",310],"(",["T_VARIABLE","$wordsLike",310],")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_VARIABLE","$wordsCut",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_STRING","array_map",311],"(",["T_ARRAY","array",311],"(",["T_VARIABLE","$this",311],",",["T_WHITESPACE"," ",311],["T_CONSTANT_ENCAPSED_STRING","'escapeHtml'",311],")",",",["T_WHITESPACE"," ",311],["T_STRING","array_diff",311],"(",["T_VARIABLE","$wordsFull",311],",",["T_WHITESPACE"," ",311],["T_VARIABLE","$wordsLike",311],")",")",";",["T_WHITESPACE","\n                ",311],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","addNoteMessage",312],"(",["T_WHITESPACE","\n                    ",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","__",313],"(",["T_CONSTANT_ENCAPSED_STRING","'Maximum words count is %1$s. In your search query was cut next part: %2$s.'",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getMaxQueryWords",313],"(",")",",",["T_WHITESPACE"," ",313],["T_STRING","join",313],"(",["T_CONSTANT_ENCAPSED_STRING","' '",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$wordsCut",313],")",")",["T_WHITESPACE","\n                ",313],")",";",["T_WHITESPACE","\n            ",314],"}",["T_WHITESPACE","\n        ",315],"}",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Join index array to string by separator\n     * Support 2 level array gluing\n     *\n     * @param array $index\n     * @param string $separator\n     * @return string\n     *\/",319],["T_WHITESPACE","\n    ",326],["T_PUBLIC","public",327],["T_WHITESPACE"," ",327],["T_FUNCTION","function",327],["T_WHITESPACE"," ",327],["T_STRING","prepareIndexdata",327],"(",["T_VARIABLE","$index",327],",",["T_WHITESPACE"," ",327],["T_VARIABLE","$separator",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","' '",327],")",["T_WHITESPACE","\n    ",327],"{",["T_WHITESPACE","\n        ",328],["T_VARIABLE","$_index",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_ARRAY","array",329],"(",")",";",["T_WHITESPACE","\n        ",329],["T_FOREACH","foreach",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$index",330],["T_WHITESPACE"," ",330],["T_AS","as",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$value",330],")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(","!",["T_STRING","is_array",331],"(",["T_VARIABLE","$value",331],")",")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n                ",331],["T_VARIABLE","$_index",332],"[","]",["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$value",332],";",["T_WHITESPACE","\n            ",332],"}",["T_WHITESPACE","\n            ",333],["T_ELSE","else",334],["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n                ",334],["T_VARIABLE","$_index",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","array_merge",335],"(",["T_VARIABLE","$_index",335],",",["T_WHITESPACE"," ",335],["T_VARIABLE","$value",335],")",";",["T_WHITESPACE","\n            ",335],"}",["T_WHITESPACE","\n        ",336],"}",["T_WHITESPACE","\n        ",337],["T_RETURN","return",338],["T_WHITESPACE"," ",338],["T_STRING","join",338],"(",["T_VARIABLE","$separator",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$_index",338],")",";",["T_WHITESPACE","\n    ",338],"}",["T_WHITESPACE","\n\n    ",339],["T_DOC_COMMENT","\/**\n     * Get current search engine resource model\n     *\n     * @return object\n     *\/",341],["T_WHITESPACE","\n    ",345],["T_PUBLIC","public",346],["T_WHITESPACE"," ",346],["T_FUNCTION","function",346],["T_WHITESPACE"," ",346],["T_STRING","getEngine",346],"(",")",["T_WHITESPACE","\n    ",346],"{",["T_WHITESPACE","\n        ",347],["T_IF","if",348],["T_WHITESPACE"," ",348],"(","!",["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_engine",348],")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$engine",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_STRING","Mage",349],["T_DOUBLE_COLON","::",349],["T_STRING","getStoreConfig",349],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/search\/engine'",349],")",";",["T_WHITESPACE","\n\n            ",349],["T_DOC_COMMENT","\/**\n             * This needed if there already was saved in configuration some none-default engine\n             * and module of that engine was disabled after that.\n             * Problem is in this engine in database configuration still set.\n             *\/",351],["T_WHITESPACE","\n            ",355],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$engine",356],["T_WHITESPACE"," ",356],["T_BOOLEAN_AND","&&",356],["T_WHITESPACE"," ",356],["T_STRING","Mage",356],["T_DOUBLE_COLON","::",356],["T_STRING","getConfig",356],"(",")",["T_OBJECT_OPERATOR","->",356],["T_STRING","getResourceModelClassName",356],"(",["T_VARIABLE","$engine",356],")",")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n                ",356],["T_VARIABLE","$model",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_STRING","Mage",357],["T_DOUBLE_COLON","::",357],["T_STRING","getResourceSingleton",357],"(",["T_VARIABLE","$engine",357],")",";",["T_WHITESPACE","\n                ",357],["T_IF","if",358],["T_WHITESPACE"," ",358],"(",["T_VARIABLE","$model",358],["T_WHITESPACE"," ",358],["T_BOOLEAN_AND","&&",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$model",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","test",358],"(",")",")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n                    ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_engine",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$model",359],";",["T_WHITESPACE","\n                ",359],"}",["T_WHITESPACE","\n            ",360],"}",["T_WHITESPACE","\n            ",361],["T_IF","if",362],["T_WHITESPACE"," ",362],"(","!",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_engine",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n                ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_engine",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_STRING","Mage",363],["T_DOUBLE_COLON","::",363],["T_STRING","getResourceSingleton",363],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/fulltext_engine'",363],")",";",["T_WHITESPACE","\n            ",363],"}",["T_WHITESPACE","\n        ",364],"}",["T_WHITESPACE","\n\n        ",365],["T_RETURN","return",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_engine",367],";",["T_WHITESPACE","\n    ",367],"}",["T_WHITESPACE","\n",368],"}",["T_WHITESPACE","\n",369]]