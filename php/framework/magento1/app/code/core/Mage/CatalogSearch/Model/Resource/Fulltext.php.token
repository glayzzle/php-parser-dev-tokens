[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_CatalogSearch\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * CatalogSearch Fulltext Index resource model\n *\n * @category    Mage\n * @package     Mage_CatalogSearch\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_CatalogSearch_Model_Resource_Fulltext",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Searchable attributes cache\n     *\n     * @var array\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_searchableAttributes",42],["T_WHITESPACE","     ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","null",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Index values separator\n     *\n     * @var string\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_separator",49],["T_WHITESPACE","                ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'|'",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Array of Zend_Date objects per store\n     *\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_dates",56],["T_WHITESPACE","                    ",56],"=",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",")",";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Product Type Instances cache\n     *\n     * @var array\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_productTypes",63],["T_WHITESPACE","             ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",")",";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Store search engine instance\n     *\n     * @var object\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_engine",70],["T_WHITESPACE","                   ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","null",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Whether table changes are allowed\n     *\n     * @deprecated after 1.6.1.0\n     * @var bool\n     *\/",72],["T_WHITESPACE","\n    ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$_allowTableChanges",78],["T_WHITESPACE","       ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","true",78],";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",80],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$_foundData",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",")",";",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Init resource model\n     *\n     *\/",85],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","_construct",89],"(",")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_init",91],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch\/fulltext'",91],",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'product_id'",91],")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_engine",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","Mage",92],["T_DOUBLE_COLON","::",92],["T_STRING","helper",92],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",92],")",["T_OBJECT_OPERATOR","->",92],["T_STRING","getEngine",92],"(",")",";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Return options separator\n     *\n     * @return string\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","getSeparator",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_separator",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Regenerate search index for store(s)\n     *\n     * @param  int|null $storeId\n     * @param  int|array|null $productIds\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",105],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","rebuildIndex",112],"(",["T_VARIABLE","$storeId",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","null",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$productIds",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","null",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_STRING","is_null",114],"(",["T_VARIABLE","$storeId",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$storeIds",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","array_keys",115],"(",["T_STRING","Mage",115],["T_DOUBLE_COLON","::",115],["T_STRING","app",115],"(",")",["T_OBJECT_OPERATOR","->",115],["T_STRING","getStores",115],"(",")",")",";",["T_WHITESPACE","\n            ",115],["T_FOREACH","foreach",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$storeIds",116],["T_WHITESPACE"," ",116],["T_AS","as",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$storeId",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_rebuildStoreIndex",117],"(",["T_VARIABLE","$storeId",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$productIds",117],")",";",["T_WHITESPACE","\n            ",117],"}",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE"," ",119],["T_ELSE","else",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_rebuildStoreIndex",120],"(",["T_VARIABLE","$storeId",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$productIds",120],")",";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n\n        ",121],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Regenerate search index for specific store\n     *\n     * @param int $storeId Store View Id\n     * @param int|array $productIds Product Entity Id\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",126],["T_WHITESPACE","\n    ",132],["T_PROTECTED","protected",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","_rebuildStoreIndex",133],"(",["T_VARIABLE","$storeId",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$productIds",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","null",133],")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","cleanIndex",135],"(",["T_VARIABLE","$storeId",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$productIds",135],")",";",["T_WHITESPACE","\n\n        ",135],["T_COMMENT","\/\/ prepare searchable attributes\n",137],["T_WHITESPACE","        ",138],["T_VARIABLE","$staticFields",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",")",";",["T_WHITESPACE","\n        ",138],["T_FOREACH","foreach",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_getSearchableAttributes",139],"(",["T_CONSTANT_ENCAPSED_STRING","'static'",139],")",["T_WHITESPACE"," ",139],["T_AS","as",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$attribute",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$staticFields",140],"[","]",["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$attribute",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getAttributeCode",140],"(",")",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$dynamicFields",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_WHITESPACE","\n            ",142],["T_CONSTANT_ENCAPSED_STRING","'int'",143],["T_WHITESPACE","       ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_STRING","array_keys",143],"(",["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_getSearchableAttributes",143],"(",["T_CONSTANT_ENCAPSED_STRING","'int'",143],")",")",",",["T_WHITESPACE","\n            ",143],["T_CONSTANT_ENCAPSED_STRING","'varchar'",144],["T_WHITESPACE","   ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_STRING","array_keys",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_getSearchableAttributes",144],"(",["T_CONSTANT_ENCAPSED_STRING","'varchar'",144],")",")",",",["T_WHITESPACE","\n            ",144],["T_CONSTANT_ENCAPSED_STRING","'text'",145],["T_WHITESPACE","      ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_STRING","array_keys",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getSearchableAttributes",145],"(",["T_CONSTANT_ENCAPSED_STRING","'text'",145],")",")",",",["T_WHITESPACE","\n            ",145],["T_CONSTANT_ENCAPSED_STRING","'decimal'",146],["T_WHITESPACE","   ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_STRING","array_keys",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_getSearchableAttributes",146],"(",["T_CONSTANT_ENCAPSED_STRING","'decimal'",146],")",")",",",["T_WHITESPACE","\n            ",146],["T_CONSTANT_ENCAPSED_STRING","'datetime'",147],["T_WHITESPACE","  ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_STRING","array_keys",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_getSearchableAttributes",147],"(",["T_CONSTANT_ENCAPSED_STRING","'datetime'",147],")",")",",",["T_WHITESPACE","\n        ",147],")",";",["T_WHITESPACE","\n\n        ",148],["T_COMMENT","\/\/ status and visibility filter\n",150],["T_WHITESPACE","        ",151],["T_VARIABLE","$visibility",151],["T_WHITESPACE","     ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_getSearchableAttribute",151],"(",["T_CONSTANT_ENCAPSED_STRING","'visibility'",151],")",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$status",152],["T_WHITESPACE","         ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_getSearchableAttribute",152],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",152],")",";",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$statusVals",153],["T_WHITESPACE","     ",153],"=",["T_WHITESPACE"," ",153],["T_STRING","Mage",153],["T_DOUBLE_COLON","::",153],["T_STRING","getSingleton",153],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_status'",153],")",["T_OBJECT_OPERATOR","->",153],["T_STRING","getVisibleStatusIds",153],"(",")",";",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$allowedVisibilityValues",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_engine",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getAllowedVisibility",154],"(",")",";",["T_WHITESPACE","\n\n        ",154],["T_VARIABLE","$websiteId",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","Mage",156],["T_DOUBLE_COLON","::",156],["T_STRING","app",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","getStore",156],"(",["T_VARIABLE","$storeId",156],")",["T_OBJECT_OPERATOR","->",156],["T_STRING","getWebsite",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","getId",156],"(",")",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$lastProductId",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_LNUMBER","0",157],";",["T_WHITESPACE","\n        ",157],["T_WHILE","while",158],["T_WHITESPACE"," ",158],"(",["T_STRING","true",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$products",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_getSearchableProducts",159],"(",["T_VARIABLE","$storeId",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$staticFields",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$productIds",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$lastProductId",159],")",";",["T_WHITESPACE","\n            ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(","!",["T_VARIABLE","$products",160],")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n                ",160],["T_BREAK","break",161],";",["T_WHITESPACE","\n            ",161],"}",["T_WHITESPACE","\n\n            ",162],["T_VARIABLE","$productAttributes",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_ARRAY","array",164],"(",")",";",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$productRelations",165],["T_WHITESPACE","  ",165],"=",["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",")",";",["T_WHITESPACE","\n            ",165],["T_FOREACH","foreach",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$products",166],["T_WHITESPACE"," ",166],["T_AS","as",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$productData",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                ",166],["T_VARIABLE","$lastProductId",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$productData",167],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",167],"]",";",["T_WHITESPACE","\n                ",167],["T_VARIABLE","$productAttributes",168],"[",["T_VARIABLE","$productData",168],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",168],"]","]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$productData",168],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",168],"]",";",["T_WHITESPACE","\n                ",168],["T_VARIABLE","$productChildren",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_getProductChildrenIds",169],"(",["T_VARIABLE","$productData",169],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",169],"]",",",["T_WHITESPACE","\n                        ",169],["T_VARIABLE","$productData",170],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",170],"]",",",["T_WHITESPACE"," ",170],["T_VARIABLE","$websiteId",170],")",";",["T_WHITESPACE","\n                ",170],["T_VARIABLE","$productRelations",171],"[",["T_VARIABLE","$productData",171],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",171],"]","]",["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$productChildren",171],";",["T_WHITESPACE","\n                ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$productChildren",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n                    ",172],["T_FOREACH","foreach",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$productChildren",173],["T_WHITESPACE"," ",173],["T_AS","as",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$productChildId",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                        ",173],["T_VARIABLE","$productAttributes",174],"[",["T_VARIABLE","$productChildId",174],"]",["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$productChildId",174],";",["T_WHITESPACE","\n                    ",174],"}",["T_WHITESPACE","\n                ",175],"}",["T_WHITESPACE","\n            ",176],"}",["T_WHITESPACE","\n\n            ",177],["T_VARIABLE","$productIndexes",179],["T_WHITESPACE","    ",179],"=",["T_WHITESPACE"," ",179],["T_ARRAY","array",179],"(",")",";",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$productAttributes",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_getProductAttributes",180],"(",["T_VARIABLE","$storeId",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$productAttributes",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$dynamicFields",180],")",";",["T_WHITESPACE","\n            ",180],["T_FOREACH","foreach",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$products",181],["T_WHITESPACE"," ",181],["T_AS","as",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$productData",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(","!",["T_ISSET","isset",182],"(",["T_VARIABLE","$productAttributes",182],"[",["T_VARIABLE","$productData",182],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",182],"]","]",")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                    ",182],["T_CONTINUE","continue",183],";",["T_WHITESPACE","\n                ",183],"}",["T_WHITESPACE","\n\n                ",184],["T_VARIABLE","$productAttr",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$productAttributes",186],"[",["T_VARIABLE","$productData",186],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",186],"]","]",";",["T_WHITESPACE","\n                ",186],["T_IF","if",187],["T_WHITESPACE"," ",187],"(","!",["T_ISSET","isset",187],"(",["T_VARIABLE","$productAttr",187],"[",["T_VARIABLE","$visibility",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getId",187],"(",")","]",")",["T_WHITESPACE","\n                    ",187],["T_BOOLEAN_OR","||",188],["T_WHITESPACE"," ",188],"!",["T_STRING","in_array",188],"(",["T_VARIABLE","$productAttr",188],"[",["T_VARIABLE","$visibility",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getId",188],"(",")","]",",",["T_WHITESPACE"," ",188],["T_VARIABLE","$allowedVisibilityValues",188],")",["T_WHITESPACE","\n                ",188],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                    ",189],["T_CONTINUE","continue",190],";",["T_WHITESPACE","\n                ",190],"}",["T_WHITESPACE","\n                ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(","!",["T_ISSET","isset",192],"(",["T_VARIABLE","$productAttr",192],"[",["T_VARIABLE","$status",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getId",192],"(",")","]",")",["T_WHITESPACE"," ",192],["T_BOOLEAN_OR","||",192],["T_WHITESPACE"," ",192],"!",["T_STRING","in_array",192],"(",["T_VARIABLE","$productAttr",192],"[",["T_VARIABLE","$status",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getId",192],"(",")","]",",",["T_WHITESPACE"," ",192],["T_VARIABLE","$statusVals",192],")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                    ",192],["T_CONTINUE","continue",193],";",["T_WHITESPACE","\n                ",193],"}",["T_WHITESPACE","\n\n                ",194],["T_VARIABLE","$productIndex",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",["T_WHITESPACE","\n                    ",196],["T_VARIABLE","$productData",197],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",197],"]",["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$productAttr",197],["T_WHITESPACE","\n                ",197],")",";",["T_WHITESPACE","\n\n                ",198],["T_VARIABLE","$hasChildren",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","false",200],";",["T_WHITESPACE","\n                ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_VARIABLE","$productChildren",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$productRelations",201],"[",["T_VARIABLE","$productData",201],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",201],"]","]",")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n                    ",201],["T_FOREACH","foreach",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$productChildren",202],["T_WHITESPACE"," ",202],["T_AS","as",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$productChildId",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_ISSET","isset",203],"(",["T_VARIABLE","$productAttributes",203],"[",["T_VARIABLE","$productChildId",203],"]",")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                            ",203],["T_VARIABLE","$productChildAttr",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$productAttributes",204],"[",["T_VARIABLE","$productChildId",204],"]",";",["T_WHITESPACE","\n                            ",204],["T_IF","if",205],["T_WHITESPACE"," ",205],"(","!",["T_ISSET","isset",205],"(",["T_VARIABLE","$productChildAttr",205],"[",["T_VARIABLE","$status",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getId",205],"(",")","]",")",["T_WHITESPACE","\n                                ",205],["T_BOOLEAN_OR","||",206],["T_WHITESPACE"," ",206],"!",["T_STRING","in_array",206],"(",["T_VARIABLE","$productChildAttr",206],"[",["T_VARIABLE","$status",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getId",206],"(",")","]",",",["T_WHITESPACE"," ",206],["T_VARIABLE","$statusVals",206],")",["T_WHITESPACE","\n                            ",206],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n                                ",207],["T_CONTINUE","continue",208],";",["T_WHITESPACE","\n                            ",208],"}",["T_WHITESPACE","\n\n                            ",209],["T_VARIABLE","$hasChildren",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","true",211],";",["T_WHITESPACE","\n                            ",211],["T_VARIABLE","$productIndex",212],"[",["T_VARIABLE","$productChildId",212],"]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$productChildAttr",212],";",["T_WHITESPACE","\n                        ",212],"}",["T_WHITESPACE","\n                    ",213],"}",["T_WHITESPACE","\n                ",214],"}",["T_WHITESPACE","\n                ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(","!",["T_STRING","is_null",216],"(",["T_VARIABLE","$productChildren",216],")",["T_WHITESPACE"," ",216],["T_BOOLEAN_AND","&&",216],["T_WHITESPACE"," ",216],"!",["T_VARIABLE","$hasChildren",216],")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                    ",216],["T_CONTINUE","continue",217],";",["T_WHITESPACE","\n                ",217],"}",["T_WHITESPACE","\n\n                ",218],["T_VARIABLE","$index",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","_prepareProductIndex",220],"(",["T_VARIABLE","$productIndex",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$productData",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$storeId",220],")",";",["T_WHITESPACE","\n\n                ",220],["T_VARIABLE","$productIndexes",222],"[",["T_VARIABLE","$productData",222],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",222],"]","]",["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$index",222],";",["T_WHITESPACE","\n            ",222],"}",["T_WHITESPACE","\n\n            ",223],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_saveProductIndexes",225],"(",["T_VARIABLE","$storeId",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$productIndexes",225],")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n\n        ",226],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","resetSearchResults",228],"(",")",";",["T_WHITESPACE","\n\n        ",228],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Retrieve searchable products per store\n     *\n     * @param int $storeId\n     * @param array $staticFields\n     * @param array|int $productIds\n     * @param int $lastProductId\n     * @param int $limit\n     * @return array\n     *\/",233],["T_WHITESPACE","\n    ",242],["T_PROTECTED","protected",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","_getSearchableProducts",243],"(",["T_VARIABLE","$storeId",243],",",["T_WHITESPACE"," ",243],["T_ARRAY","array",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$staticFields",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$productIds",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","null",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$lastProductId",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_LNUMBER","0",243],",",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$limit",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_LNUMBER","100",244],")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$websiteId",246],["T_WHITESPACE","      ",246],"=",["T_WHITESPACE"," ",246],["T_STRING","Mage",246],["T_DOUBLE_COLON","::",246],["T_STRING","app",246],"(",")",["T_OBJECT_OPERATOR","->",246],["T_STRING","getStore",246],"(",["T_VARIABLE","$storeId",246],")",["T_OBJECT_OPERATOR","->",246],["T_STRING","getWebsiteId",246],"(",")",";",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$writeAdapter",247],["T_WHITESPACE","   ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_getWriteAdapter",247],"(",")",";",["T_WHITESPACE","\n\n        ",247],["T_VARIABLE","$select",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$writeAdapter",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","select",249],"(",")",["T_WHITESPACE","\n            ",249],["T_OBJECT_OPERATOR","->",250],["T_STRING","useStraightJoin",250],"(",["T_STRING","true",250],")",["T_WHITESPACE","\n            ",250],["T_OBJECT_OPERATOR","->",251],["T_STRING","from",251],"(",["T_WHITESPACE","\n                ",251],["T_ARRAY","array",252],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",252],["T_WHITESPACE"," ",252],["T_DOUBLE_ARROW","=>",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getTable",252],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",252],")",")",",",["T_WHITESPACE","\n                ",252],["T_STRING","array_merge",253],"(",["T_ARRAY","array",253],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",253],",",["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'type_id'",253],")",",",["T_WHITESPACE"," ",253],["T_VARIABLE","$staticFields",253],")",["T_WHITESPACE","\n            ",253],")",["T_WHITESPACE","\n            ",254],["T_OBJECT_OPERATOR","->",255],["T_STRING","join",255],"(",["T_WHITESPACE","\n                ",255],["T_ARRAY","array",256],"(",["T_CONSTANT_ENCAPSED_STRING","'website'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getTable",256],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_website'",256],")",")",",",["T_WHITESPACE","\n                ",256],["T_VARIABLE","$writeAdapter",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","quoteInto",257],"(",["T_WHITESPACE","\n                    ",257],["T_CONSTANT_ENCAPSED_STRING","'website.product_id=e.entity_id AND website.website_id=?'",258],",",["T_WHITESPACE","\n                    ",258],["T_VARIABLE","$websiteId",259],["T_WHITESPACE","\n                ",259],")",",",["T_WHITESPACE","\n                ",260],["T_ARRAY","array",261],"(",")",["T_WHITESPACE","\n            ",261],")",["T_WHITESPACE","\n            ",262],["T_OBJECT_OPERATOR","->",263],["T_STRING","join",263],"(",["T_WHITESPACE","\n                ",263],["T_ARRAY","array",264],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_status'",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getTable",264],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_status'",264],")",")",",",["T_WHITESPACE","\n                ",264],["T_VARIABLE","$writeAdapter",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","quoteInto",265],"(",["T_WHITESPACE","\n                    ",265],["T_CONSTANT_ENCAPSED_STRING","'stock_status.product_id=e.entity_id AND stock_status.website_id=?'",266],",",["T_WHITESPACE","\n                    ",266],["T_VARIABLE","$websiteId",267],["T_WHITESPACE","\n                ",267],")",",",["T_WHITESPACE","\n                ",268],["T_ARRAY","array",269],"(",["T_CONSTANT_ENCAPSED_STRING","'in_stock'",269],["T_WHITESPACE"," ",269],["T_DOUBLE_ARROW","=>",269],["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'stock_status'",269],")",["T_WHITESPACE","\n            ",269],")",";",["T_WHITESPACE","\n\n        ",270],["T_IF","if",272],["T_WHITESPACE"," ",272],"(","!",["T_STRING","is_null",272],"(",["T_VARIABLE","$productIds",272],")",")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$select",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","where",273],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$productIds",273],")",";",["T_WHITESPACE","\n        ",273],"}",["T_WHITESPACE","\n\n        ",274],["T_VARIABLE","$select",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","where",276],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id>?'",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$lastProductId",276],")",["T_WHITESPACE","\n            ",276],["T_OBJECT_OPERATOR","->",277],["T_STRING","limit",277],"(",["T_VARIABLE","$limit",277],")",["T_WHITESPACE","\n            ",277],["T_OBJECT_OPERATOR","->",278],["T_STRING","order",278],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",278],")",";",["T_WHITESPACE","\n\n        ",278],["T_DOC_COMMENT","\/**\n         * Add additional external limitation\n         *\/",280],["T_WHITESPACE","\n        ",282],["T_STRING","Mage",283],["T_DOUBLE_COLON","::",283],["T_STRING","dispatchEvent",283],"(",["T_CONSTANT_ENCAPSED_STRING","'prepare_catalog_product_index_select'",283],",",["T_WHITESPACE"," ",283],["T_ARRAY","array",283],"(",["T_WHITESPACE","\n            ",283],["T_CONSTANT_ENCAPSED_STRING","'select'",284],["T_WHITESPACE","        ",284],["T_DOUBLE_ARROW","=>",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$select",284],",",["T_WHITESPACE","\n            ",284],["T_CONSTANT_ENCAPSED_STRING","'entity_field'",285],["T_WHITESPACE","  ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_NEW","new",285],["T_WHITESPACE"," ",285],["T_STRING","Zend_Db_Expr",285],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",285],")",",",["T_WHITESPACE","\n            ",285],["T_CONSTANT_ENCAPSED_STRING","'website_field'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_NEW","new",286],["T_WHITESPACE"," ",286],["T_STRING","Zend_Db_Expr",286],"(",["T_CONSTANT_ENCAPSED_STRING","'website.website_id'",286],")",",",["T_WHITESPACE","\n            ",286],["T_CONSTANT_ENCAPSED_STRING","'store_field'",287],["T_WHITESPACE","   ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$storeId",287],["T_WHITESPACE","\n        ",287],")",")",";",["T_WHITESPACE","\n\n        ",288],["T_VARIABLE","$result",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$writeAdapter",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","fetchAll",290],"(",["T_VARIABLE","$select",290],")",";",["T_WHITESPACE","\n\n        ",290],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$result",292],";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n\n    ",293],["T_DOC_COMMENT","\/**\n     * Reset search results\n     *\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",295],["T_WHITESPACE","\n    ",299],["T_PUBLIC","public",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","resetSearchResults",300],"(",")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_STRING","Mage",302],["T_DOUBLE_COLON","::",302],["T_STRING","dispatchEvent",302],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch_reset_search_result'",302],")",";",["T_WHITESPACE","\n        ",302],["T_RETURN","return",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],";",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n\n    ",304],["T_DOC_COMMENT","\/**\n     * Delete search index data for store\n     *\n     * @param int $storeId Store View Id\n     * @param int $productId Product Entity Id\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",306],["T_WHITESPACE","\n    ",312],["T_PUBLIC","public",313],["T_WHITESPACE"," ",313],["T_FUNCTION","function",313],["T_WHITESPACE"," ",313],["T_STRING","cleanIndex",313],"(",["T_VARIABLE","$storeId",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_STRING","null",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$productId",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_STRING","null",313],")",["T_WHITESPACE","\n    ",313],"{",["T_WHITESPACE","\n        ",314],["T_IF","if",315],["T_WHITESPACE"," ",315],"(",["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_engine",315],")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n            ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_engine",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","cleanIndex",316],"(",["T_VARIABLE","$storeId",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$productId",316],")",";",["T_WHITESPACE","\n        ",316],"}",["T_WHITESPACE","\n\n        ",317],["T_RETURN","return",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],";",["T_WHITESPACE","\n    ",319],"}",["T_WHITESPACE","\n\n    ",320],["T_DOC_COMMENT","\/**\n     * Prepare results for query\n     *\n     * @param Mage_CatalogSearch_Model_Fulltext $object\n     * @param string $queryText\n     * @param Mage_CatalogSearch_Model_Query $query\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",322],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","prepareResult",330],"(",["T_VARIABLE","$object",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$queryText",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$query",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$adapter",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_getWriteAdapter",332],"(",")",";",["T_WHITESPACE","\n        ",332],["T_VARIABLE","$searchType",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_VARIABLE","$object",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getSearchType",333],"(",["T_VARIABLE","$query",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getStoreId",333],"(",")",")",";",["T_WHITESPACE","\n\n        ",333],["T_VARIABLE","$preparedTerms",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","Mage",335],["T_DOUBLE_COLON","::",335],["T_STRING","getResourceHelper",335],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",335],")",["T_WHITESPACE","\n            ",335],["T_OBJECT_OPERATOR","->",336],["T_STRING","prepareTerms",336],"(",["T_VARIABLE","$queryText",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$query",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getMaxQueryWords",336],"(",")",")",";",["T_WHITESPACE","\n\n        ",336],["T_VARIABLE","$bind",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_ARRAY","array",338],"(",")",";",["T_WHITESPACE","\n        ",338],["T_VARIABLE","$like",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_ARRAY","array",339],"(",")",";",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$likeCond",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","''",340],";",["T_WHITESPACE","\n        ",340],["T_IF","if",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$searchType",341],["T_WHITESPACE"," ",341],["T_IS_EQUAL","==",341],["T_WHITESPACE"," ",341],["T_STRING","Mage_CatalogSearch_Model_Fulltext",341],["T_DOUBLE_COLON","::",341],["T_STRING","SEARCH_TYPE_LIKE",341],["T_WHITESPACE","\n            ",341],["T_BOOLEAN_OR","||",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$searchType",342],["T_WHITESPACE"," ",342],["T_IS_EQUAL","==",342],["T_WHITESPACE"," ",342],["T_STRING","Mage_CatalogSearch_Model_Fulltext",342],["T_DOUBLE_COLON","::",342],["T_STRING","SEARCH_TYPE_COMBINE",342],["T_WHITESPACE","\n        ",342],")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n            ",343],["T_VARIABLE","$helper",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_STRING","Mage",344],["T_DOUBLE_COLON","::",344],["T_STRING","getResourceHelper",344],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",344],")",";",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$words",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_STRING","Mage",345],["T_DOUBLE_COLON","::",345],["T_STRING","helper",345],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",345],")",["T_OBJECT_OPERATOR","->",345],["T_STRING","splitWords",345],"(",["T_VARIABLE","$queryText",345],",",["T_WHITESPACE"," ",345],["T_STRING","true",345],",",["T_WHITESPACE"," ",345],["T_VARIABLE","$query",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getMaxQueryWords",345],"(",")",")",";",["T_WHITESPACE","\n            ",345],["T_FOREACH","foreach",346],["T_WHITESPACE"," ",346],"(",["T_VARIABLE","$words",346],["T_WHITESPACE"," ",346],["T_AS","as",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$word",346],")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n                ",346],["T_VARIABLE","$like",347],"[","]",["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$helper",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getCILike",347],"(",["T_CONSTANT_ENCAPSED_STRING","'s.data_index'",347],",",["T_WHITESPACE"," ",347],["T_VARIABLE","$word",347],",",["T_WHITESPACE"," ",347],["T_ARRAY","array",347],"(",["T_CONSTANT_ENCAPSED_STRING","'position'",347],["T_WHITESPACE"," ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],["T_CONSTANT_ENCAPSED_STRING","'any'",347],")",")",";",["T_WHITESPACE","\n            ",347],"}",["T_WHITESPACE","\n\n            ",348],["T_IF","if",350],["T_WHITESPACE"," ",350],"(",["T_VARIABLE","$like",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n                ",350],["T_VARIABLE","$likeCond",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'('",351],["T_WHITESPACE"," ",351],".",["T_WHITESPACE"," ",351],["T_STRING","join",351],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$like",351],")",["T_WHITESPACE"," ",351],".",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","')'",351],";",["T_WHITESPACE","\n            ",351],"}",["T_WHITESPACE","\n        ",352],"}",["T_WHITESPACE","\n\n        ",353],["T_VARIABLE","$mainTableAlias",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'s'",355],";",["T_WHITESPACE","\n        ",355],["T_VARIABLE","$fields",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_ARRAY","array",356],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",356],")",";",["T_WHITESPACE","\n\n        ",356],["T_VARIABLE","$select",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$adapter",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","select",358],"(",")",["T_WHITESPACE","\n            ",358],["T_OBJECT_OPERATOR","->",359],["T_STRING","from",359],"(",["T_ARRAY","array",359],"(",["T_VARIABLE","$mainTableAlias",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getMainTable",359],"(",")",")",",",["T_WHITESPACE"," ",359],["T_VARIABLE","$fields",359],")",["T_WHITESPACE","\n            ",359],["T_OBJECT_OPERATOR","->",360],["T_STRING","joinInner",360],"(",["T_ARRAY","array",360],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getTable",360],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",360],")",")",",",["T_WHITESPACE","\n                ",360],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = s.product_id'",361],",",["T_WHITESPACE","\n                ",361],["T_ARRAY","array",362],"(",")",")",["T_WHITESPACE","\n            ",362],["T_OBJECT_OPERATOR","->",363],["T_STRING","where",363],"(",["T_VARIABLE","$mainTableAlias",363],["T_WHITESPACE"," ",363],".",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'.store_id = ?'",363],",",["T_WHITESPACE"," ",363],["T_INT_CAST","(int)",363],["T_VARIABLE","$query",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getStoreId",363],"(",")",")",";",["T_WHITESPACE","\n\n        ",363],["T_VARIABLE","$where",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_CONSTANT_ENCAPSED_STRING","\"\"",365],";",["T_WHITESPACE","\n        ",365],["T_IF","if",366],["T_WHITESPACE"," ",366],"(",["T_VARIABLE","$searchType",366],["T_WHITESPACE"," ",366],["T_IS_EQUAL","==",366],["T_WHITESPACE"," ",366],["T_STRING","Mage_CatalogSearch_Model_Fulltext",366],["T_DOUBLE_COLON","::",366],["T_STRING","SEARCH_TYPE_FULLTEXT",366],["T_WHITESPACE","\n            ",366],["T_BOOLEAN_OR","||",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$searchType",367],["T_WHITESPACE"," ",367],["T_IS_EQUAL","==",367],["T_WHITESPACE"," ",367],["T_STRING","Mage_CatalogSearch_Model_Fulltext",367],["T_DOUBLE_COLON","::",367],["T_STRING","SEARCH_TYPE_COMBINE",367],["T_WHITESPACE","\n        ",367],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n            ",368],["T_VARIABLE","$bind",369],"[",["T_CONSTANT_ENCAPSED_STRING","':query'",369],"]",["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_STRING","implode",369],"(",["T_CONSTANT_ENCAPSED_STRING","' '",369],",",["T_WHITESPACE"," ",369],["T_VARIABLE","$preparedTerms",369],"[",["T_LNUMBER","0",369],"]",")",";",["T_WHITESPACE","\n            ",369],["T_VARIABLE","$where",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],["T_STRING","Mage",370],["T_DOUBLE_COLON","::",370],["T_STRING","getResourceHelper",370],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",370],")",["T_WHITESPACE","\n                ",370],["T_OBJECT_OPERATOR","->",371],["T_STRING","chooseFulltext",371],"(",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","getMainTable",371],"(",")",",",["T_WHITESPACE"," ",371],["T_VARIABLE","$mainTableAlias",371],",",["T_WHITESPACE"," ",371],["T_VARIABLE","$select",371],")",";",["T_WHITESPACE","\n        ",371],"}",["T_WHITESPACE","\n        ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(",["T_VARIABLE","$likeCond",373],["T_WHITESPACE"," ",373],["T_IS_NOT_EQUAL","!=",373],["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","''",373],["T_WHITESPACE"," ",373],["T_BOOLEAN_AND","&&",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$searchType",373],["T_WHITESPACE"," ",373],["T_IS_EQUAL","==",373],["T_WHITESPACE"," ",373],["T_STRING","Mage_CatalogSearch_Model_Fulltext",373],["T_DOUBLE_COLON","::",373],["T_STRING","SEARCH_TYPE_COMBINE",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_VARIABLE","$where",374],["T_WHITESPACE"," ",374],["T_CONCAT_EQUAL",".=",374],["T_WHITESPACE"," ",374],"(",["T_VARIABLE","$where",374],["T_WHITESPACE"," ",374],"?",["T_WHITESPACE"," ",374],["T_CONSTANT_ENCAPSED_STRING","' OR '",374],["T_WHITESPACE"," ",374],":",["T_WHITESPACE"," ",374],["T_CONSTANT_ENCAPSED_STRING","''",374],")",["T_WHITESPACE"," ",374],".",["T_WHITESPACE"," ",374],["T_VARIABLE","$likeCond",374],";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE"," ",375],["T_ELSEIF","elseif",375],["T_WHITESPACE"," ",375],"(",["T_VARIABLE","$likeCond",375],["T_WHITESPACE"," ",375],["T_IS_NOT_EQUAL","!=",375],["T_WHITESPACE"," ",375],["T_CONSTANT_ENCAPSED_STRING","''",375],["T_WHITESPACE"," ",375],["T_BOOLEAN_AND","&&",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$searchType",375],["T_WHITESPACE"," ",375],["T_IS_EQUAL","==",375],["T_WHITESPACE"," ",375],["T_STRING","Mage_CatalogSearch_Model_Fulltext",375],["T_DOUBLE_COLON","::",375],["T_STRING","SEARCH_TYPE_LIKE",375],")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_VARIABLE","$select",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","columns",376],"(",["T_ARRAY","array",376],"(",["T_CONSTANT_ENCAPSED_STRING","'relevance'",376],["T_WHITESPACE"," ",376],["T_DOUBLE_ARROW","=>",376],["T_WHITESPACE"," ",376],["T_NEW","new",376],["T_WHITESPACE"," ",376],["T_STRING","Zend_Db_Expr",376],"(",["T_LNUMBER","0",376],")",")",")",";",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$where",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_VARIABLE","$likeCond",377],";",["T_WHITESPACE","\n        ",377],"}",["T_WHITESPACE","\n\n        ",378],["T_IF","if",380],["T_WHITESPACE"," ",380],"(",["T_VARIABLE","$where",380],["T_WHITESPACE"," ",380],["T_IS_NOT_EQUAL","!=",380],["T_WHITESPACE"," ",380],["T_CONSTANT_ENCAPSED_STRING","''",380],")",["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n            ",380],["T_VARIABLE","$select",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","where",381],"(",["T_VARIABLE","$where",381],")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE","\n\n        ",382],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_foundData",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$adapter",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","fetchPairs",384],"(",["T_VARIABLE","$select",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$bind",384],")",";",["T_WHITESPACE","\n\n        ",384],["T_RETURN","return",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],";",["T_WHITESPACE","\n    ",386],"}",["T_WHITESPACE","\n\n    ",387],["T_DOC_COMMENT","\/**\n     * Retrieve found data\n     *\n     * @return array\n     *\/",389],["T_WHITESPACE","\n    ",393],["T_PUBLIC","public",394],["T_WHITESPACE"," ",394],["T_FUNCTION","function",394],["T_WHITESPACE"," ",394],["T_STRING","getFoundData",394],"(",")",["T_WHITESPACE","\n    ",394],"{",["T_WHITESPACE","\n        ",395],["T_RETURN","return",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","_foundData",396],";",["T_WHITESPACE","\n    ",396],"}",["T_WHITESPACE","\n\n    ",397],["T_DOC_COMMENT","\/**\n     * Retrieve EAV Config Singleton\n     *\n     * @return Mage_Eav_Model_Config\n     *\/",399],["T_WHITESPACE","\n    ",403],["T_PUBLIC","public",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","getEavConfig",404],"(",")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_RETURN","return",406],["T_WHITESPACE"," ",406],["T_STRING","Mage",406],["T_DOUBLE_COLON","::",406],["T_STRING","getSingleton",406],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",406],")",";",["T_WHITESPACE","\n    ",406],"}",["T_WHITESPACE","\n\n    ",407],["T_DOC_COMMENT","\/**\n     * Retrieve searchable attributes\n     *\n     * @param string $backendType\n     * @return array\n     *\/",409],["T_WHITESPACE","\n    ",414],["T_PROTECTED","protected",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","_getSearchableAttributes",415],"(",["T_VARIABLE","$backendType",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","null",415],")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_STRING","is_null",417],"(",["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","_searchableAttributes",417],")",")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_searchableAttributes",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_ARRAY","array",418],"(",")",";",["T_WHITESPACE","\n\n            ",418],["T_VARIABLE","$productAttributeCollection",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_STRING","Mage",420],["T_DOUBLE_COLON","::",420],["T_STRING","getResourceModel",420],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_collection'",420],")",";",["T_WHITESPACE","\n\n            ",420],["T_IF","if",422],["T_WHITESPACE"," ",422],"(",["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","_engine",422],["T_WHITESPACE"," ",422],["T_BOOLEAN_AND","&&",422],["T_WHITESPACE"," ",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","_engine",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","allowAdvancedIndex",422],"(",")",")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n                ",422],["T_VARIABLE","$productAttributeCollection",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","addToIndexFilter",423],"(",["T_STRING","true",423],")",";",["T_WHITESPACE","\n            ",423],"}",["T_WHITESPACE"," ",424],["T_ELSE","else",424],["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n                ",424],["T_VARIABLE","$productAttributeCollection",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","addSearchableAttributeFilter",425],"(",")",";",["T_WHITESPACE","\n            ",425],"}",["T_WHITESPACE","\n            ",426],["T_VARIABLE","$attributes",427],["T_WHITESPACE"," ",427],"=",["T_WHITESPACE"," ",427],["T_VARIABLE","$productAttributeCollection",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getItems",427],"(",")",";",["T_WHITESPACE","\n\n            ",427],["T_STRING","Mage",429],["T_DOUBLE_COLON","::",429],["T_STRING","dispatchEvent",429],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch_searchable_attributes_load_after'",429],",",["T_WHITESPACE"," ",429],["T_ARRAY","array",429],"(",["T_WHITESPACE","\n                ",429],["T_CONSTANT_ENCAPSED_STRING","'engine'",430],["T_WHITESPACE"," ",430],["T_DOUBLE_ARROW","=>",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_engine",430],",",["T_WHITESPACE","\n                ",430],["T_CONSTANT_ENCAPSED_STRING","'attributes'",431],["T_WHITESPACE"," ",431],["T_DOUBLE_ARROW","=>",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$attributes",431],["T_WHITESPACE","\n            ",431],")",")",";",["T_WHITESPACE","\n\n            ",432],["T_VARIABLE","$entity",434],["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getEavConfig",434],"(",")",["T_WHITESPACE","\n                ",434],["T_OBJECT_OPERATOR","->",435],["T_STRING","getEntityType",435],"(",["T_STRING","Mage_Catalog_Model_Product",435],["T_DOUBLE_COLON","::",435],["T_STRING","ENTITY",435],")",["T_WHITESPACE","\n                ",435],["T_OBJECT_OPERATOR","->",436],["T_STRING","getEntity",436],"(",")",";",["T_WHITESPACE","\n\n            ",436],["T_FOREACH","foreach",438],["T_WHITESPACE"," ",438],"(",["T_VARIABLE","$attributes",438],["T_WHITESPACE"," ",438],["T_AS","as",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$attribute",438],")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n                ",438],["T_VARIABLE","$attribute",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","setEntity",439],"(",["T_VARIABLE","$entity",439],")",";",["T_WHITESPACE","\n            ",439],"}",["T_WHITESPACE","\n\n            ",440],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","_searchableAttributes",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$attributes",442],";",["T_WHITESPACE","\n        ",442],"}",["T_WHITESPACE","\n\n        ",443],["T_IF","if",445],["T_WHITESPACE"," ",445],"(","!",["T_STRING","is_null",445],"(",["T_VARIABLE","$backendType",445],")",")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n            ",445],["T_VARIABLE","$attributes",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_ARRAY","array",446],"(",")",";",["T_WHITESPACE","\n            ",446],["T_FOREACH","foreach",447],["T_WHITESPACE"," ",447],"(",["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","_searchableAttributes",447],["T_WHITESPACE"," ",447],["T_AS","as",447],["T_WHITESPACE"," ",447],["T_VARIABLE","$attributeId",447],["T_WHITESPACE"," ",447],["T_DOUBLE_ARROW","=>",447],["T_WHITESPACE"," ",447],["T_VARIABLE","$attribute",447],")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n                ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_VARIABLE","$attribute",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","getBackendType",448],"(",")",["T_WHITESPACE"," ",448],["T_IS_EQUAL","==",448],["T_WHITESPACE"," ",448],["T_VARIABLE","$backendType",448],")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n                    ",448],["T_VARIABLE","$attributes",449],"[",["T_VARIABLE","$attributeId",449],"]",["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$attribute",449],";",["T_WHITESPACE","\n                ",449],"}",["T_WHITESPACE","\n            ",450],"}",["T_WHITESPACE","\n\n            ",451],["T_RETURN","return",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$attributes",453],";",["T_WHITESPACE","\n        ",453],"}",["T_WHITESPACE","\n\n        ",454],["T_RETURN","return",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","_searchableAttributes",456],";",["T_WHITESPACE","\n    ",456],"}",["T_WHITESPACE","\n\n    ",457],["T_DOC_COMMENT","\/**\n     * Retrieve searchable attribute by Id or code\n     *\n     * @param int|string $attribute\n     * @return Mage_Eav_Model_Entity_Attribute\n     *\/",459],["T_WHITESPACE","\n    ",464],["T_PROTECTED","protected",465],["T_WHITESPACE"," ",465],["T_FUNCTION","function",465],["T_WHITESPACE"," ",465],["T_STRING","_getSearchableAttribute",465],"(",["T_VARIABLE","$attribute",465],")",["T_WHITESPACE","\n    ",465],"{",["T_WHITESPACE","\n        ",466],["T_VARIABLE","$attributes",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_getSearchableAttributes",467],"(",")",";",["T_WHITESPACE","\n        ",467],["T_IF","if",468],["T_WHITESPACE"," ",468],"(",["T_STRING","is_numeric",468],"(",["T_VARIABLE","$attribute",468],")",")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n            ",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(",["T_ISSET","isset",469],"(",["T_VARIABLE","$attributes",469],"[",["T_VARIABLE","$attribute",469],"]",")",")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n                ",469],["T_RETURN","return",470],["T_WHITESPACE"," ",470],["T_VARIABLE","$attributes",470],"[",["T_VARIABLE","$attribute",470],"]",";",["T_WHITESPACE","\n            ",470],"}",["T_WHITESPACE","\n        ",471],"}",["T_WHITESPACE"," ",472],["T_ELSEIF","elseif",472],["T_WHITESPACE"," ",472],"(",["T_STRING","is_string",472],"(",["T_VARIABLE","$attribute",472],")",")",["T_WHITESPACE"," ",472],"{",["T_WHITESPACE","\n            ",472],["T_FOREACH","foreach",473],["T_WHITESPACE"," ",473],"(",["T_VARIABLE","$attributes",473],["T_WHITESPACE"," ",473],["T_AS","as",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$attributeModel",473],")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n                ",473],["T_IF","if",474],["T_WHITESPACE"," ",474],"(",["T_VARIABLE","$attributeModel",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","getAttributeCode",474],"(",")",["T_WHITESPACE"," ",474],["T_IS_EQUAL","==",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$attribute",474],")",["T_WHITESPACE"," ",474],"{",["T_WHITESPACE","\n                    ",474],["T_RETURN","return",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$attributeModel",475],";",["T_WHITESPACE","\n                ",475],"}",["T_WHITESPACE","\n            ",476],"}",["T_WHITESPACE","\n        ",477],"}",["T_WHITESPACE","\n\n        ",478],["T_RETURN","return",480],["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","getEavConfig",480],"(",")",["T_OBJECT_OPERATOR","->",480],["T_STRING","getAttribute",480],"(",["T_STRING","Mage_Catalog_Model_Product",480],["T_DOUBLE_COLON","::",480],["T_STRING","ENTITY",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$attribute",480],")",";",["T_WHITESPACE","\n    ",480],"}",["T_WHITESPACE","\n\n    ",481],["T_DOC_COMMENT","\/**\n     * Returns expresion for field unification\n     *\n     * @param string $field\n     * @param string $backendType\n     * @return Zend_Db_Expr\n     *\/",483],["T_WHITESPACE","\n    ",489],["T_PROTECTED","protected",490],["T_WHITESPACE"," ",490],["T_FUNCTION","function",490],["T_WHITESPACE"," ",490],["T_STRING","_unifyField",490],"(",["T_VARIABLE","$field",490],",",["T_WHITESPACE"," ",490],["T_VARIABLE","$backendType",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_CONSTANT_ENCAPSED_STRING","'varchar'",490],")",["T_WHITESPACE","\n    ",490],"{",["T_WHITESPACE","\n        ",491],["T_IF","if",492],["T_WHITESPACE"," ",492],"(",["T_VARIABLE","$backendType",492],["T_WHITESPACE"," ",492],["T_IS_EQUAL","==",492],["T_WHITESPACE"," ",492],["T_CONSTANT_ENCAPSED_STRING","'datetime'",492],")",["T_WHITESPACE"," ",492],"{",["T_WHITESPACE","\n            ",492],["T_VARIABLE","$expr",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_STRING","Mage",493],["T_DOUBLE_COLON","::",493],["T_STRING","getResourceHelper",493],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",493],")",["T_OBJECT_OPERATOR","->",493],["T_STRING","castField",493],"(",["T_WHITESPACE","\n                ",493],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","_getReadAdapter",494],"(",")",["T_OBJECT_OPERATOR","->",494],["T_STRING","getDateFormatSql",494],"(",["T_VARIABLE","$field",494],",",["T_WHITESPACE"," ",494],["T_CONSTANT_ENCAPSED_STRING","'%Y-%m-%d %H:%i:%s'",494],")",")",";",["T_WHITESPACE","\n        ",494],"}",["T_WHITESPACE"," ",495],["T_ELSE","else",495],["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n            ",495],["T_VARIABLE","$expr",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_STRING","Mage",496],["T_DOUBLE_COLON","::",496],["T_STRING","getResourceHelper",496],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",496],")",["T_OBJECT_OPERATOR","->",496],["T_STRING","castField",496],"(",["T_VARIABLE","$field",496],")",";",["T_WHITESPACE","\n        ",496],"}",["T_WHITESPACE","\n        ",497],["T_RETURN","return",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$expr",498],";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Load product(s) attributes\n     *\n     * @param int $storeId\n     * @param array $productIds\n     * @param array $attributeTypes\n     * @return array\n     *\/",501],["T_WHITESPACE","\n    ",508],["T_PROTECTED","protected",509],["T_WHITESPACE"," ",509],["T_FUNCTION","function",509],["T_WHITESPACE"," ",509],["T_STRING","_getProductAttributes",509],"(",["T_VARIABLE","$storeId",509],",",["T_WHITESPACE"," ",509],["T_ARRAY","array",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$productIds",509],",",["T_WHITESPACE"," ",509],["T_ARRAY","array",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$attributeTypes",509],")",["T_WHITESPACE","\n    ",509],"{",["T_WHITESPACE","\n        ",510],["T_VARIABLE","$result",511],["T_WHITESPACE","  ",511],"=",["T_WHITESPACE"," ",511],["T_ARRAY","array",511],"(",")",";",["T_WHITESPACE","\n        ",511],["T_VARIABLE","$selects",512],["T_WHITESPACE"," ",512],"=",["T_WHITESPACE"," ",512],["T_ARRAY","array",512],"(",")",";",["T_WHITESPACE","\n        ",512],["T_VARIABLE","$websiteId",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_STRING","Mage",513],["T_DOUBLE_COLON","::",513],["T_STRING","app",513],"(",")",["T_OBJECT_OPERATOR","->",513],["T_STRING","getStore",513],"(",["T_VARIABLE","$storeId",513],")",["T_OBJECT_OPERATOR","->",513],["T_STRING","getWebsiteId",513],"(",")",";",["T_WHITESPACE","\n        ",513],["T_VARIABLE","$adapter",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","_getWriteAdapter",514],"(",")",";",["T_WHITESPACE","\n        ",514],["T_VARIABLE","$ifStoreValue",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_VARIABLE","$adapter",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","getCheckSql",515],"(",["T_CONSTANT_ENCAPSED_STRING","'t_store.value_id > 0'",515],",",["T_WHITESPACE"," ",515],["T_CONSTANT_ENCAPSED_STRING","'t_store.value'",515],",",["T_WHITESPACE"," ",515],["T_CONSTANT_ENCAPSED_STRING","'t_default.value'",515],")",";",["T_WHITESPACE","\n        ",515],["T_FOREACH","foreach",516],["T_WHITESPACE"," ",516],"(",["T_VARIABLE","$attributeTypes",516],["T_WHITESPACE"," ",516],["T_AS","as",516],["T_WHITESPACE"," ",516],["T_VARIABLE","$backendType",516],["T_WHITESPACE"," ",516],["T_DOUBLE_ARROW","=>",516],["T_WHITESPACE"," ",516],["T_VARIABLE","$attributeIds",516],")",["T_WHITESPACE"," ",516],"{",["T_WHITESPACE","\n            ",516],["T_IF","if",517],["T_WHITESPACE"," ",517],"(",["T_VARIABLE","$attributeIds",517],")",["T_WHITESPACE"," ",517],"{",["T_WHITESPACE","\n                ",517],["T_VARIABLE","$tableName",518],["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","getTable",518],"(",["T_ARRAY","array",518],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",518],",",["T_WHITESPACE"," ",518],["T_VARIABLE","$backendType",518],")",")",";",["T_WHITESPACE","\n                ",518],["T_VARIABLE","$select",519],["T_WHITESPACE"," ",519],"=",["T_WHITESPACE"," ",519],["T_VARIABLE","$adapter",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","select",519],"(",")",["T_WHITESPACE","\n                    ",519],["T_OBJECT_OPERATOR","->",520],["T_STRING","from",520],"(",["T_WHITESPACE","\n                        ",520],["T_ARRAY","array",521],"(",["T_CONSTANT_ENCAPSED_STRING","'t_default'",521],["T_WHITESPACE"," ",521],["T_DOUBLE_ARROW","=>",521],["T_WHITESPACE"," ",521],["T_VARIABLE","$tableName",521],")",",",["T_WHITESPACE","\n                        ",521],["T_ARRAY","array",522],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",522],",",["T_WHITESPACE"," ",522],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",522],")",")",["T_WHITESPACE","\n                    ",522],["T_OBJECT_OPERATOR","->",523],["T_STRING","joinLeft",523],"(",["T_WHITESPACE","\n                        ",523],["T_ARRAY","array",524],"(",["T_CONSTANT_ENCAPSED_STRING","'t_store'",524],["T_WHITESPACE"," ",524],["T_DOUBLE_ARROW","=>",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$tableName",524],")",",",["T_WHITESPACE","\n                        ",524],["T_VARIABLE","$adapter",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","quoteInto",525],"(",["T_WHITESPACE","\n                            ",525],["T_CONSTANT_ENCAPSED_STRING","'t_default.entity_id=t_store.entity_id'",526],["T_WHITESPACE"," ",526],".",["T_WHITESPACE","\n                                ",526],["T_CONSTANT_ENCAPSED_STRING","' AND t_default.attribute_id=t_store.attribute_id'",527],["T_WHITESPACE"," ",527],".",["T_WHITESPACE","\n                                ",527],["T_CONSTANT_ENCAPSED_STRING","' AND t_store.store_id=?'",528],",",["T_WHITESPACE","\n                            ",528],["T_VARIABLE","$storeId",529],")",",",["T_WHITESPACE","\n                        ",529],["T_ARRAY","array",530],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",530],["T_WHITESPACE"," ",530],["T_DOUBLE_ARROW","=>",530],["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","_unifyField",530],"(",["T_VARIABLE","$ifStoreValue",530],",",["T_WHITESPACE"," ",530],["T_VARIABLE","$backendType",530],")",")",")",["T_WHITESPACE","\n                    ",530],["T_OBJECT_OPERATOR","->",531],["T_STRING","where",531],"(",["T_CONSTANT_ENCAPSED_STRING","'t_default.store_id=?'",531],",",["T_WHITESPACE"," ",531],["T_LNUMBER","0",531],")",["T_WHITESPACE","\n                    ",531],["T_OBJECT_OPERATOR","->",532],["T_STRING","where",532],"(",["T_CONSTANT_ENCAPSED_STRING","'t_default.attribute_id IN (?)'",532],",",["T_WHITESPACE"," ",532],["T_VARIABLE","$attributeIds",532],")",["T_WHITESPACE","\n                    ",532],["T_OBJECT_OPERATOR","->",533],["T_STRING","where",533],"(",["T_CONSTANT_ENCAPSED_STRING","'t_default.entity_id IN (?)'",533],",",["T_WHITESPACE"," ",533],["T_VARIABLE","$productIds",533],")",";",["T_WHITESPACE","\n\n                ",533],["T_DOC_COMMENT","\/**\n                 * Add additional external limitation\n                 *\/",535],["T_WHITESPACE","\n                ",537],["T_STRING","Mage",538],["T_DOUBLE_COLON","::",538],["T_STRING","dispatchEvent",538],"(",["T_CONSTANT_ENCAPSED_STRING","'prepare_catalog_product_index_select'",538],",",["T_WHITESPACE"," ",538],["T_ARRAY","array",538],"(",["T_WHITESPACE","\n                    ",538],["T_CONSTANT_ENCAPSED_STRING","'select'",539],["T_WHITESPACE","        ",539],["T_DOUBLE_ARROW","=>",539],["T_WHITESPACE"," ",539],["T_VARIABLE","$select",539],",",["T_WHITESPACE","\n                    ",539],["T_CONSTANT_ENCAPSED_STRING","'entity_field'",540],["T_WHITESPACE","  ",540],["T_DOUBLE_ARROW","=>",540],["T_WHITESPACE"," ",540],["T_NEW","new",540],["T_WHITESPACE"," ",540],["T_STRING","Zend_Db_Expr",540],"(",["T_CONSTANT_ENCAPSED_STRING","'t_default.entity_id'",540],")",",",["T_WHITESPACE","\n                    ",540],["T_CONSTANT_ENCAPSED_STRING","'website_field'",541],["T_WHITESPACE"," ",541],["T_DOUBLE_ARROW","=>",541],["T_WHITESPACE"," ",541],["T_VARIABLE","$websiteId",541],",",["T_WHITESPACE","\n                    ",541],["T_CONSTANT_ENCAPSED_STRING","'store_field'",542],["T_WHITESPACE","   ",542],["T_DOUBLE_ARROW","=>",542],["T_WHITESPACE"," ",542],["T_NEW","new",542],["T_WHITESPACE"," ",542],["T_STRING","Zend_Db_Expr",542],"(",["T_CONSTANT_ENCAPSED_STRING","'t_store.store_id'",542],")",["T_WHITESPACE","\n                ",542],")",")",";",["T_WHITESPACE","\n\n                ",543],["T_VARIABLE","$selects",545],"[","]",["T_WHITESPACE"," ",545],"=",["T_WHITESPACE"," ",545],["T_VARIABLE","$select",545],";",["T_WHITESPACE","\n            ",545],"}",["T_WHITESPACE","\n        ",546],"}",["T_WHITESPACE","\n\n        ",547],["T_IF","if",549],["T_WHITESPACE"," ",549],"(",["T_VARIABLE","$selects",549],")",["T_WHITESPACE"," ",549],"{",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$select",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$adapter",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","select",550],"(",")",["T_OBJECT_OPERATOR","->",550],["T_STRING","union",550],"(",["T_VARIABLE","$selects",550],",",["T_WHITESPACE"," ",550],["T_STRING","Zend_Db_Select",550],["T_DOUBLE_COLON","::",550],["T_STRING","SQL_UNION_ALL",550],")",";",["T_WHITESPACE","\n            ",550],["T_VARIABLE","$query",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_VARIABLE","$adapter",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","query",551],"(",["T_VARIABLE","$select",551],")",";",["T_WHITESPACE","\n            ",551],["T_WHILE","while",552],["T_WHITESPACE"," ",552],"(",["T_VARIABLE","$row",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_VARIABLE","$query",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","fetch",552],"(",")",")",["T_WHITESPACE"," ",552],"{",["T_WHITESPACE","\n                ",552],["T_VARIABLE","$result",553],"[",["T_VARIABLE","$row",553],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",553],"]","]","[",["T_VARIABLE","$row",553],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",553],"]","]",["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_VARIABLE","$row",553],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",553],"]",";",["T_WHITESPACE","\n            ",553],"}",["T_WHITESPACE","\n        ",554],"}",["T_WHITESPACE","\n\n        ",555],["T_RETURN","return",557],["T_WHITESPACE"," ",557],["T_VARIABLE","$result",557],";",["T_WHITESPACE","\n    ",557],"}",["T_WHITESPACE","\n\n    ",558],["T_DOC_COMMENT","\/**\n     * Retrieve Product Type Instance\n     *\n     * @param string $typeId\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",560],["T_WHITESPACE","\n    ",565],["T_PROTECTED","protected",566],["T_WHITESPACE"," ",566],["T_FUNCTION","function",566],["T_WHITESPACE"," ",566],["T_STRING","_getProductTypeInstance",566],"(",["T_VARIABLE","$typeId",566],")",["T_WHITESPACE","\n    ",566],"{",["T_WHITESPACE","\n        ",567],["T_IF","if",568],["T_WHITESPACE"," ",568],"(","!",["T_ISSET","isset",568],"(",["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","_productTypes",568],"[",["T_VARIABLE","$typeId",568],"]",")",")",["T_WHITESPACE"," ",568],"{",["T_WHITESPACE","\n            ",568],["T_VARIABLE","$productEmulator",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","_getProductEmulator",569],"(",")",";",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$productEmulator",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","setTypeId",570],"(",["T_VARIABLE","$typeId",570],")",";",["T_WHITESPACE","\n\n            ",570],["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","_productTypes",572],"[",["T_VARIABLE","$typeId",572],"]",["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_STRING","Mage",572],["T_DOUBLE_COLON","::",572],["T_STRING","getSingleton",572],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",572],")",["T_WHITESPACE","\n                ",572],["T_OBJECT_OPERATOR","->",573],["T_STRING","factory",573],"(",["T_VARIABLE","$productEmulator",573],")",";",["T_WHITESPACE","\n        ",573],"}",["T_WHITESPACE","\n        ",574],["T_RETURN","return",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","_productTypes",575],"[",["T_VARIABLE","$typeId",575],"]",";",["T_WHITESPACE","\n    ",575],"}",["T_WHITESPACE","\n\n    ",576],["T_DOC_COMMENT","\/**\n     * Return all product children ids\n     *\n     * @param $productId\n     * @param $typeId\n     * @param null|int $websiteId\n     * @return array|null\n     *\/",578],["T_WHITESPACE","\n    ",585],["T_PROTECTED","protected",586],["T_WHITESPACE"," ",586],["T_FUNCTION","function",586],["T_WHITESPACE"," ",586],["T_STRING","_getProductChildrenIds",586],"(",["T_VARIABLE","$productId",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$typeId",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$websiteId",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","null",586],")",["T_WHITESPACE","\n    ",586],"{",["T_WHITESPACE","\n        ",587],["T_VARIABLE","$typeInstance",588],["T_WHITESPACE"," ",588],"=",["T_WHITESPACE"," ",588],["T_VARIABLE","$this",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","_getProductTypeInstance",588],"(",["T_VARIABLE","$typeId",588],")",";",["T_WHITESPACE","\n        ",588],["T_VARIABLE","$relation",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_VARIABLE","$typeInstance",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","isComposite",589],"(",")",["T_WHITESPACE","\n            ",589],"?",["T_WHITESPACE"," ",590],["T_VARIABLE","$typeInstance",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","getRelationInfo",590],"(",")",["T_WHITESPACE","\n            ",590],":",["T_WHITESPACE"," ",591],["T_STRING","false",591],";",["T_WHITESPACE","\n\n        ",591],["T_IF","if",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$relation",593],["T_WHITESPACE"," ",593],["T_BOOLEAN_AND","&&",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$relation",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","getTable",593],"(",")",["T_WHITESPACE"," ",593],["T_BOOLEAN_AND","&&",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$relation",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","getParentFieldName",593],"(",")",["T_WHITESPACE"," ",593],["T_BOOLEAN_AND","&&",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$relation",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","getChildFieldName",593],"(",")",")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n            ",593],["T_VARIABLE","$select",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","_getReadAdapter",594],"(",")",["T_OBJECT_OPERATOR","->",594],["T_STRING","select",594],"(",")",["T_WHITESPACE","\n                ",594],["T_OBJECT_OPERATOR","->",595],["T_STRING","from",595],"(",["T_WHITESPACE","\n                    ",595],["T_ARRAY","array",596],"(",["T_CONSTANT_ENCAPSED_STRING","'main'",596],["T_WHITESPACE"," ",596],["T_DOUBLE_ARROW","=>",596],["T_WHITESPACE"," ",596],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","getTable",596],"(",["T_VARIABLE","$relation",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","getTable",596],"(",")",")",")",",",["T_WHITESPACE","\n                    ",596],["T_ARRAY","array",597],"(",["T_VARIABLE","$relation",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","getChildFieldName",597],"(",")",")",")",["T_WHITESPACE","\n                ",597],["T_OBJECT_OPERATOR","->",598],["T_STRING","where",598],"(","\"",["T_ENCAPSED_AND_WHITESPACE","main.",598],["T_CURLY_OPEN","{",598],["T_VARIABLE","$relation",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","getParentFieldName",598],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," = ?",598],"\"",",",["T_WHITESPACE"," ",598],["T_VARIABLE","$productId",598],")",";",["T_WHITESPACE","\n            ",598],["T_IF","if",599],["T_WHITESPACE"," ",599],"(","!",["T_STRING","is_null",599],"(",["T_VARIABLE","$relation",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","getWhere",599],"(",")",")",")",["T_WHITESPACE"," ",599],"{",["T_WHITESPACE","\n                ",599],["T_VARIABLE","$select",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","where",600],"(",["T_VARIABLE","$relation",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","getWhere",600],"(",")",")",";",["T_WHITESPACE","\n            ",600],"}",["T_WHITESPACE","\n\n            ",601],["T_STRING","Mage",603],["T_DOUBLE_COLON","::",603],["T_STRING","dispatchEvent",603],"(",["T_CONSTANT_ENCAPSED_STRING","'prepare_product_children_id_list_select'",603],",",["T_WHITESPACE"," ",603],["T_ARRAY","array",603],"(",["T_WHITESPACE","\n                ",603],["T_CONSTANT_ENCAPSED_STRING","'select'",604],["T_WHITESPACE","        ",604],["T_DOUBLE_ARROW","=>",604],["T_WHITESPACE"," ",604],["T_VARIABLE","$select",604],",",["T_WHITESPACE","\n                ",604],["T_CONSTANT_ENCAPSED_STRING","'entity_field'",605],["T_WHITESPACE","  ",605],["T_DOUBLE_ARROW","=>",605],["T_WHITESPACE"," ",605],["T_CONSTANT_ENCAPSED_STRING","'main.product_id'",605],",",["T_WHITESPACE","\n                ",605],["T_CONSTANT_ENCAPSED_STRING","'website_field'",606],["T_WHITESPACE"," ",606],["T_DOUBLE_ARROW","=>",606],["T_WHITESPACE"," ",606],["T_VARIABLE","$websiteId",606],["T_WHITESPACE","\n            ",606],")",")",";",["T_WHITESPACE","\n\n            ",607],["T_RETURN","return",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$this",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","_getReadAdapter",609],"(",")",["T_OBJECT_OPERATOR","->",609],["T_STRING","fetchCol",609],"(",["T_VARIABLE","$select",609],")",";",["T_WHITESPACE","\n        ",609],"}",["T_WHITESPACE","\n\n        ",610],["T_RETURN","return",612],["T_WHITESPACE"," ",612],["T_STRING","null",612],";",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n\n    ",613],["T_DOC_COMMENT","\/**\n     * Return all product children ids\n     *\n     * @param int $productId Product Entity Id\n     * @param string $typeId Super Product Link Type\n     * @return array|null\n     *\/",615],["T_WHITESPACE","\n    ",621],["T_PROTECTED","protected",622],["T_WHITESPACE"," ",622],["T_FUNCTION","function",622],["T_WHITESPACE"," ",622],["T_STRING","_getProductChildIds",622],"(",["T_VARIABLE","$productId",622],",",["T_WHITESPACE"," ",622],["T_VARIABLE","$typeId",622],")",["T_WHITESPACE","\n    ",622],"{",["T_WHITESPACE","\n        ",623],["T_RETURN","return",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","_getProductChildrenIds",624],"(",["T_VARIABLE","$productId",624],",",["T_WHITESPACE"," ",624],["T_VARIABLE","$typeId",624],")",";",["T_WHITESPACE","\n    ",624],"}",["T_WHITESPACE","\n\n    ",625],["T_DOC_COMMENT","\/**\n     * Retrieve Product Emulator (Varien Object)\n     *\n     * @return Varien_Object\n     *\/",627],["T_WHITESPACE","\n    ",631],["T_PROTECTED","protected",632],["T_WHITESPACE"," ",632],["T_FUNCTION","function",632],["T_WHITESPACE"," ",632],["T_STRING","_getProductEmulator",632],"(",")",["T_WHITESPACE","\n    ",632],"{",["T_WHITESPACE","\n        ",633],["T_VARIABLE","$productEmulator",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_NEW","new",634],["T_WHITESPACE"," ",634],["T_STRING","Varien_Object",634],"(",")",";",["T_WHITESPACE","\n        ",634],["T_VARIABLE","$productEmulator",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","setIdFieldName",635],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",635],")",";",["T_WHITESPACE","\n\n        ",635],["T_RETURN","return",637],["T_WHITESPACE"," ",637],["T_VARIABLE","$productEmulator",637],";",["T_WHITESPACE","\n    ",637],"}",["T_WHITESPACE","\n\n    ",638],["T_DOC_COMMENT","\/**\n     * Prepare Fulltext index value for product\n     *\n     * @param array $indexData\n     * @param array $productData\n     * @param int $storeId\n     * @return string\n     *\/",640],["T_WHITESPACE","\n    ",647],["T_PROTECTED","protected",648],["T_WHITESPACE"," ",648],["T_FUNCTION","function",648],["T_WHITESPACE"," ",648],["T_STRING","_prepareProductIndex",648],"(",["T_VARIABLE","$indexData",648],",",["T_WHITESPACE"," ",648],["T_VARIABLE","$productData",648],",",["T_WHITESPACE"," ",648],["T_VARIABLE","$storeId",648],")",["T_WHITESPACE","\n    ",648],"{",["T_WHITESPACE","\n        ",649],["T_VARIABLE","$index",650],["T_WHITESPACE"," ",650],"=",["T_WHITESPACE"," ",650],["T_ARRAY","array",650],"(",")",";",["T_WHITESPACE","\n\n        ",650],["T_FOREACH","foreach",652],["T_WHITESPACE"," ",652],"(",["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","_getSearchableAttributes",652],"(",["T_CONSTANT_ENCAPSED_STRING","'static'",652],")",["T_WHITESPACE"," ",652],["T_AS","as",652],["T_WHITESPACE"," ",652],["T_VARIABLE","$attribute",652],")",["T_WHITESPACE"," ",652],"{",["T_WHITESPACE","\n            ",652],["T_VARIABLE","$attributeCode",653],["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_VARIABLE","$attribute",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","getAttributeCode",653],"(",")",";",["T_WHITESPACE","\n\n            ",653],["T_IF","if",655],["T_WHITESPACE"," ",655],"(",["T_ISSET","isset",655],"(",["T_VARIABLE","$productData",655],"[",["T_VARIABLE","$attributeCode",655],"]",")",")",["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n                ",655],["T_VARIABLE","$value",656],["T_WHITESPACE"," ",656],"=",["T_WHITESPACE"," ",656],["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","_getAttributeValue",656],"(",["T_VARIABLE","$attribute",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","getId",656],"(",")",",",["T_WHITESPACE"," ",656],["T_VARIABLE","$productData",656],"[",["T_VARIABLE","$attributeCode",656],"]",",",["T_WHITESPACE"," ",656],["T_VARIABLE","$storeId",656],")",";",["T_WHITESPACE","\n                ",656],["T_IF","if",657],["T_WHITESPACE"," ",657],"(",["T_VARIABLE","$value",657],")",["T_WHITESPACE"," ",657],"{",["T_WHITESPACE","\n                    ",657],["T_COMMENT","\/\/For grouped products\n",658],["T_WHITESPACE","                    ",659],["T_IF","if",659],["T_WHITESPACE"," ",659],"(",["T_ISSET","isset",659],"(",["T_VARIABLE","$index",659],"[",["T_VARIABLE","$attributeCode",659],"]",")",")",["T_WHITESPACE"," ",659],"{",["T_WHITESPACE","\n                        ",659],["T_IF","if",660],["T_WHITESPACE"," ",660],"(","!",["T_STRING","is_array",660],"(",["T_VARIABLE","$index",660],"[",["T_VARIABLE","$attributeCode",660],"]",")",")",["T_WHITESPACE"," ",660],"{",["T_WHITESPACE","\n                            ",660],["T_VARIABLE","$index",661],"[",["T_VARIABLE","$attributeCode",661],"]",["T_WHITESPACE"," ",661],"=",["T_WHITESPACE"," ",661],["T_ARRAY","array",661],"(",["T_VARIABLE","$index",661],"[",["T_VARIABLE","$attributeCode",661],"]",")",";",["T_WHITESPACE","\n                        ",661],"}",["T_WHITESPACE","\n                        ",662],["T_VARIABLE","$index",663],"[",["T_VARIABLE","$attributeCode",663],"]","[","]",["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],["T_VARIABLE","$value",663],";",["T_WHITESPACE","\n                    ",663],"}",["T_WHITESPACE","\n                    ",664],["T_COMMENT","\/\/For other types of products\n",665],["T_WHITESPACE","                    ",666],["T_ELSE","else",666],["T_WHITESPACE"," ",666],"{",["T_WHITESPACE","\n                        ",666],["T_VARIABLE","$index",667],"[",["T_VARIABLE","$attributeCode",667],"]",["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_VARIABLE","$value",667],";",["T_WHITESPACE","\n                    ",667],"}",["T_WHITESPACE","\n                ",668],"}",["T_WHITESPACE","\n            ",669],"}",["T_WHITESPACE","\n        ",670],"}",["T_WHITESPACE","\n\n        ",671],["T_FOREACH","foreach",673],["T_WHITESPACE"," ",673],"(",["T_VARIABLE","$indexData",673],["T_WHITESPACE"," ",673],["T_AS","as",673],["T_WHITESPACE"," ",673],["T_VARIABLE","$entityId",673],["T_WHITESPACE"," ",673],["T_DOUBLE_ARROW","=>",673],["T_WHITESPACE"," ",673],["T_VARIABLE","$attributeData",673],")",["T_WHITESPACE"," ",673],"{",["T_WHITESPACE","\n            ",673],["T_FOREACH","foreach",674],["T_WHITESPACE"," ",674],"(",["T_VARIABLE","$attributeData",674],["T_WHITESPACE"," ",674],["T_AS","as",674],["T_WHITESPACE"," ",674],["T_VARIABLE","$attributeId",674],["T_WHITESPACE"," ",674],["T_DOUBLE_ARROW","=>",674],["T_WHITESPACE"," ",674],["T_VARIABLE","$attributeValue",674],")",["T_WHITESPACE"," ",674],"{",["T_WHITESPACE","\n                ",674],["T_VARIABLE","$value",675],["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","_getAttributeValue",675],"(",["T_VARIABLE","$attributeId",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$attributeValue",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$storeId",675],")",";",["T_WHITESPACE","\n                ",675],["T_IF","if",676],["T_WHITESPACE"," ",676],"(","!",["T_STRING","is_null",676],"(",["T_VARIABLE","$value",676],")",["T_WHITESPACE"," ",676],["T_BOOLEAN_AND","&&",676],["T_WHITESPACE"," ",676],["T_VARIABLE","$value",676],["T_WHITESPACE"," ",676],["T_IS_NOT_IDENTICAL","!==",676],["T_WHITESPACE"," ",676],["T_STRING","false",676],")",["T_WHITESPACE"," ",676],"{",["T_WHITESPACE","\n                    ",676],["T_VARIABLE","$attributeCode",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","_getSearchableAttribute",677],"(",["T_VARIABLE","$attributeId",677],")",["T_OBJECT_OPERATOR","->",677],["T_STRING","getAttributeCode",677],"(",")",";",["T_WHITESPACE","\n\n                    ",677],["T_IF","if",679],["T_WHITESPACE"," ",679],"(",["T_ISSET","isset",679],"(",["T_VARIABLE","$index",679],"[",["T_VARIABLE","$attributeCode",679],"]",")",")",["T_WHITESPACE"," ",679],"{",["T_WHITESPACE","\n                        ",679],["T_VARIABLE","$index",680],"[",["T_VARIABLE","$attributeCode",680],"]","[",["T_VARIABLE","$entityId",680],"]",["T_WHITESPACE"," ",680],"=",["T_WHITESPACE"," ",680],["T_VARIABLE","$value",680],";",["T_WHITESPACE","\n                    ",680],"}",["T_WHITESPACE"," ",681],["T_ELSE","else",681],["T_WHITESPACE"," ",681],"{",["T_WHITESPACE","\n                        ",681],["T_VARIABLE","$index",682],"[",["T_VARIABLE","$attributeCode",682],"]",["T_WHITESPACE"," ",682],"=",["T_WHITESPACE"," ",682],["T_ARRAY","array",682],"(",["T_VARIABLE","$entityId",682],["T_WHITESPACE"," ",682],["T_DOUBLE_ARROW","=>",682],["T_WHITESPACE"," ",682],["T_VARIABLE","$value",682],")",";",["T_WHITESPACE","\n                    ",682],"}",["T_WHITESPACE","\n                ",683],"}",["T_WHITESPACE","\n            ",684],"}",["T_WHITESPACE","\n        ",685],"}",["T_WHITESPACE","\n\n        ",686],["T_IF","if",688],["T_WHITESPACE"," ",688],"(","!",["T_VARIABLE","$this",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","_engine",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","allowAdvancedIndex",688],"(",")",")",["T_WHITESPACE"," ",688],"{",["T_WHITESPACE","\n            ",688],["T_VARIABLE","$product",689],["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_VARIABLE","$this",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","_getProductEmulator",689],"(",")",["T_WHITESPACE","\n                ",689],["T_OBJECT_OPERATOR","->",690],["T_STRING","setId",690],"(",["T_VARIABLE","$productData",690],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",690],"]",")",["T_WHITESPACE","\n                ",690],["T_OBJECT_OPERATOR","->",691],["T_STRING","setTypeId",691],"(",["T_VARIABLE","$productData",691],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",691],"]",")",["T_WHITESPACE","\n                ",691],["T_OBJECT_OPERATOR","->",692],["T_STRING","setStoreId",692],"(",["T_VARIABLE","$storeId",692],")",";",["T_WHITESPACE","\n            ",692],["T_VARIABLE","$typeInstance",693],["T_WHITESPACE"," ",693],"=",["T_WHITESPACE"," ",693],["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","_getProductTypeInstance",693],"(",["T_VARIABLE","$productData",693],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",693],"]",")",";",["T_WHITESPACE","\n            ",693],["T_IF","if",694],["T_WHITESPACE"," ",694],"(",["T_VARIABLE","$data",694],["T_WHITESPACE"," ",694],"=",["T_WHITESPACE"," ",694],["T_VARIABLE","$typeInstance",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","getSearchableData",694],"(",["T_VARIABLE","$product",694],")",")",["T_WHITESPACE"," ",694],"{",["T_WHITESPACE","\n                ",694],["T_VARIABLE","$index",695],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",695],"]",["T_WHITESPACE"," ",695],"=",["T_WHITESPACE"," ",695],["T_VARIABLE","$data",695],";",["T_WHITESPACE","\n            ",695],"}",["T_WHITESPACE","\n        ",696],"}",["T_WHITESPACE","\n\n        ",697],["T_IF","if",699],["T_WHITESPACE"," ",699],"(",["T_ISSET","isset",699],"(",["T_VARIABLE","$productData",699],"[",["T_CONSTANT_ENCAPSED_STRING","'in_stock'",699],"]",")",")",["T_WHITESPACE"," ",699],"{",["T_WHITESPACE","\n            ",699],["T_VARIABLE","$index",700],"[",["T_CONSTANT_ENCAPSED_STRING","'in_stock'",700],"]",["T_WHITESPACE"," ",700],"=",["T_WHITESPACE"," ",700],["T_VARIABLE","$productData",700],"[",["T_CONSTANT_ENCAPSED_STRING","'in_stock'",700],"]",";",["T_WHITESPACE","\n        ",700],"}",["T_WHITESPACE","\n\n        ",701],["T_IF","if",703],["T_WHITESPACE"," ",703],"(",["T_VARIABLE","$this",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","_engine",703],")",["T_WHITESPACE"," ",703],"{",["T_WHITESPACE","\n            ",703],["T_RETURN","return",704],["T_WHITESPACE"," ",704],["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","_engine",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","prepareEntityIndex",704],"(",["T_VARIABLE","$index",704],",",["T_WHITESPACE"," ",704],["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","_separator",704],")",";",["T_WHITESPACE","\n        ",704],"}",["T_WHITESPACE","\n\n        ",705],["T_RETURN","return",707],["T_WHITESPACE"," ",707],["T_STRING","Mage",707],["T_DOUBLE_COLON","::",707],["T_STRING","helper",707],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",707],")",["T_OBJECT_OPERATOR","->",707],["T_STRING","prepareIndexdata",707],"(",["T_VARIABLE","$index",707],",",["T_WHITESPACE"," ",707],["T_VARIABLE","$this",707],["T_OBJECT_OPERATOR","->",707],["T_STRING","_separator",707],")",";",["T_WHITESPACE","\n    ",707],"}",["T_WHITESPACE","\n\n    ",708],["T_DOC_COMMENT","\/**\n     * Retrieve attribute source value for search\n     *\n     * @param int $attributeId\n     * @param mixed $value\n     * @param int $storeId\n     * @return mixed\n     *\/",710],["T_WHITESPACE","\n    ",717],["T_PROTECTED","protected",718],["T_WHITESPACE"," ",718],["T_FUNCTION","function",718],["T_WHITESPACE"," ",718],["T_STRING","_getAttributeValue",718],"(",["T_VARIABLE","$attributeId",718],",",["T_WHITESPACE"," ",718],["T_VARIABLE","$value",718],",",["T_WHITESPACE"," ",718],["T_VARIABLE","$storeId",718],")",["T_WHITESPACE","\n    ",718],"{",["T_WHITESPACE","\n        ",719],["T_VARIABLE","$attribute",720],["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$this",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","_getSearchableAttribute",720],"(",["T_VARIABLE","$attributeId",720],")",";",["T_WHITESPACE","\n        ",720],["T_IF","if",721],["T_WHITESPACE"," ",721],"(","!",["T_VARIABLE","$attribute",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","getIsSearchable",721],"(",")",")",["T_WHITESPACE"," ",721],"{",["T_WHITESPACE","\n            ",721],["T_IF","if",722],["T_WHITESPACE"," ",722],"(",["T_VARIABLE","$this",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","_engine",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","allowAdvancedIndex",722],"(",")",")",["T_WHITESPACE"," ",722],"{",["T_WHITESPACE","\n                ",722],["T_IF","if",723],["T_WHITESPACE"," ",723],"(",["T_VARIABLE","$attribute",723],["T_OBJECT_OPERATOR","->",723],["T_STRING","getAttributeCode",723],"(",")",["T_WHITESPACE"," ",723],["T_IS_EQUAL","==",723],["T_WHITESPACE"," ",723],["T_CONSTANT_ENCAPSED_STRING","'visibility'",723],")",["T_WHITESPACE"," ",723],"{",["T_WHITESPACE","\n                    ",723],["T_RETURN","return",724],["T_WHITESPACE"," ",724],["T_VARIABLE","$value",724],";",["T_WHITESPACE","\n                ",724],"}",["T_WHITESPACE"," ",725],["T_ELSEIF","elseif",725],["T_WHITESPACE"," ",725],"(","!","(",["T_VARIABLE","$attribute",725],["T_OBJECT_OPERATOR","->",725],["T_STRING","getIsVisibleInAdvancedSearch",725],"(",")",["T_WHITESPACE","\n                    ",725],["T_BOOLEAN_OR","||",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$attribute",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","getIsFilterable",726],"(",")",["T_WHITESPACE","\n                    ",726],["T_BOOLEAN_OR","||",727],["T_WHITESPACE"," ",727],["T_VARIABLE","$attribute",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","getIsFilterableInSearch",727],"(",")",["T_WHITESPACE","\n                    ",727],["T_BOOLEAN_OR","||",728],["T_WHITESPACE"," ",728],["T_VARIABLE","$attribute",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","getUsedForSortBy",728],"(",")",")",["T_WHITESPACE","\n                ",728],")",["T_WHITESPACE"," ",729],"{",["T_WHITESPACE","\n                    ",729],["T_RETURN","return",730],["T_WHITESPACE"," ",730],["T_STRING","null",730],";",["T_WHITESPACE","\n                ",730],"}",["T_WHITESPACE","\n            ",731],"}",["T_WHITESPACE"," ",732],["T_ELSE","else",732],["T_WHITESPACE"," ",732],"{",["T_WHITESPACE","\n                ",732],["T_RETURN","return",733],["T_WHITESPACE"," ",733],["T_STRING","null",733],";",["T_WHITESPACE","\n            ",733],"}",["T_WHITESPACE","\n        ",734],"}",["T_WHITESPACE","\n\n        ",735],["T_IF","if",737],["T_WHITESPACE"," ",737],"(",["T_VARIABLE","$attribute",737],["T_OBJECT_OPERATOR","->",737],["T_STRING","usesSource",737],"(",")",")",["T_WHITESPACE"," ",737],"{",["T_WHITESPACE","\n            ",737],["T_IF","if",738],["T_WHITESPACE"," ",738],"(",["T_VARIABLE","$this",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","_engine",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","allowAdvancedIndex",738],"(",")",")",["T_WHITESPACE"," ",738],"{",["T_WHITESPACE","\n                ",738],["T_RETURN","return",739],["T_WHITESPACE"," ",739],["T_VARIABLE","$value",739],";",["T_WHITESPACE","\n            ",739],"}",["T_WHITESPACE","\n\n            ",740],["T_VARIABLE","$attribute",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","setStoreId",742],"(",["T_VARIABLE","$storeId",742],")",";",["T_WHITESPACE","\n            ",742],["T_VARIABLE","$value",743],["T_WHITESPACE"," ",743],"=",["T_WHITESPACE"," ",743],["T_VARIABLE","$attribute",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","getSource",743],"(",")",["T_OBJECT_OPERATOR","->",743],["T_STRING","getIndexOptionText",743],"(",["T_VARIABLE","$value",743],")",";",["T_WHITESPACE","\n\n            ",743],["T_IF","if",745],["T_WHITESPACE"," ",745],"(",["T_STRING","is_array",745],"(",["T_VARIABLE","$value",745],")",")",["T_WHITESPACE"," ",745],"{",["T_WHITESPACE","\n                ",745],["T_VARIABLE","$value",746],["T_WHITESPACE"," ",746],"=",["T_WHITESPACE"," ",746],["T_STRING","implode",746],"(",["T_VARIABLE","$this",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","_separator",746],",",["T_WHITESPACE"," ",746],["T_VARIABLE","$value",746],")",";",["T_WHITESPACE","\n            ",746],"}",["T_WHITESPACE"," ",747],["T_ELSEIF","elseif",747],["T_WHITESPACE"," ",747],"(",["T_EMPTY","empty",747],"(",["T_VARIABLE","$value",747],")",")",["T_WHITESPACE"," ",747],"{",["T_WHITESPACE","\n                ",747],["T_VARIABLE","$inputType",748],["T_WHITESPACE"," ",748],"=",["T_WHITESPACE"," ",748],["T_VARIABLE","$attribute",748],["T_OBJECT_OPERATOR","->",748],["T_STRING","getFrontend",748],"(",")",["T_OBJECT_OPERATOR","->",748],["T_STRING","getInputType",748],"(",")",";",["T_WHITESPACE","\n                ",748],["T_IF","if",749],["T_WHITESPACE"," ",749],"(",["T_VARIABLE","$inputType",749],["T_WHITESPACE"," ",749],["T_IS_EQUAL","==",749],["T_WHITESPACE"," ",749],["T_CONSTANT_ENCAPSED_STRING","'select'",749],["T_WHITESPACE"," ",749],["T_BOOLEAN_OR","||",749],["T_WHITESPACE"," ",749],["T_VARIABLE","$inputType",749],["T_WHITESPACE"," ",749],["T_IS_EQUAL","==",749],["T_WHITESPACE"," ",749],["T_CONSTANT_ENCAPSED_STRING","'multiselect'",749],")",["T_WHITESPACE"," ",749],"{",["T_WHITESPACE","\n                    ",749],["T_RETURN","return",750],["T_WHITESPACE"," ",750],["T_STRING","null",750],";",["T_WHITESPACE","\n                ",750],"}",["T_WHITESPACE","\n            ",751],"}",["T_WHITESPACE","\n        ",752],"}",["T_WHITESPACE"," ",753],["T_ELSEIF","elseif",753],["T_WHITESPACE"," ",753],"(",["T_VARIABLE","$attribute",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","getBackendType",753],"(",")",["T_WHITESPACE"," ",753],["T_IS_EQUAL","==",753],["T_WHITESPACE"," ",753],["T_CONSTANT_ENCAPSED_STRING","'datetime'",753],")",["T_WHITESPACE"," ",753],"{",["T_WHITESPACE","\n            ",753],["T_VARIABLE","$value",754],["T_WHITESPACE"," ",754],"=",["T_WHITESPACE"," ",754],["T_VARIABLE","$this",754],["T_OBJECT_OPERATOR","->",754],["T_STRING","_getStoreDate",754],"(",["T_VARIABLE","$storeId",754],",",["T_WHITESPACE"," ",754],["T_VARIABLE","$value",754],")",";",["T_WHITESPACE","\n        ",754],"}",["T_WHITESPACE"," ",755],["T_ELSE","else",755],["T_WHITESPACE"," ",755],"{",["T_WHITESPACE","\n            ",755],["T_VARIABLE","$inputType",756],["T_WHITESPACE"," ",756],"=",["T_WHITESPACE"," ",756],["T_VARIABLE","$attribute",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","getFrontend",756],"(",")",["T_OBJECT_OPERATOR","->",756],["T_STRING","getInputType",756],"(",")",";",["T_WHITESPACE","\n            ",756],["T_IF","if",757],["T_WHITESPACE"," ",757],"(",["T_VARIABLE","$inputType",757],["T_WHITESPACE"," ",757],["T_IS_EQUAL","==",757],["T_WHITESPACE"," ",757],["T_CONSTANT_ENCAPSED_STRING","'price'",757],")",["T_WHITESPACE"," ",757],"{",["T_WHITESPACE","\n                ",757],["T_VARIABLE","$value",758],["T_WHITESPACE"," ",758],"=",["T_WHITESPACE"," ",758],["T_STRING","Mage",758],["T_DOUBLE_COLON","::",758],["T_STRING","app",758],"(",")",["T_OBJECT_OPERATOR","->",758],["T_STRING","getStore",758],"(",["T_VARIABLE","$storeId",758],")",["T_OBJECT_OPERATOR","->",758],["T_STRING","roundPrice",758],"(",["T_VARIABLE","$value",758],")",";",["T_WHITESPACE","\n            ",758],"}",["T_WHITESPACE","\n        ",759],"}",["T_WHITESPACE","\n\n        ",760],["T_VARIABLE","$value",762],["T_WHITESPACE"," ",762],"=",["T_WHITESPACE"," ",762],["T_STRING","preg_replace",762],"(",["T_CONSTANT_ENCAPSED_STRING","\"#\\s+#siu\"",762],",",["T_WHITESPACE"," ",762],["T_CONSTANT_ENCAPSED_STRING","' '",762],",",["T_WHITESPACE"," ",762],["T_STRING","trim",762],"(",["T_STRING","strip_tags",762],"(",["T_VARIABLE","$value",762],")",")",")",";",["T_WHITESPACE","\n\n        ",762],["T_RETURN","return",764],["T_WHITESPACE"," ",764],["T_VARIABLE","$value",764],";",["T_WHITESPACE","\n    ",764],"}",["T_WHITESPACE","\n\n    ",765],["T_DOC_COMMENT","\/**\n     * Save Product index\n     *\n     * @param int $productId\n     * @param int $storeId\n     * @param string $index\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",767],["T_WHITESPACE","\n    ",774],["T_PROTECTED","protected",775],["T_WHITESPACE"," ",775],["T_FUNCTION","function",775],["T_WHITESPACE"," ",775],["T_STRING","_saveProductIndex",775],"(",["T_VARIABLE","$productId",775],",",["T_WHITESPACE"," ",775],["T_VARIABLE","$storeId",775],",",["T_WHITESPACE"," ",775],["T_VARIABLE","$index",775],")",["T_WHITESPACE","\n    ",775],"{",["T_WHITESPACE","\n        ",776],["T_IF","if",777],["T_WHITESPACE"," ",777],"(",["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","_engine",777],")",["T_WHITESPACE"," ",777],"{",["T_WHITESPACE","\n            ",777],["T_VARIABLE","$this",778],["T_OBJECT_OPERATOR","->",778],["T_STRING","_engine",778],["T_OBJECT_OPERATOR","->",778],["T_STRING","saveEntityIndex",778],"(",["T_VARIABLE","$productId",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$storeId",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$index",778],")",";",["T_WHITESPACE","\n        ",778],"}",["T_WHITESPACE","\n\n        ",779],["T_RETURN","return",781],["T_WHITESPACE"," ",781],["T_VARIABLE","$this",781],";",["T_WHITESPACE","\n    ",781],"}",["T_WHITESPACE","\n\n    ",782],["T_DOC_COMMENT","\/**\n     * Save Multiply Product indexes\n     *\n     * @param int $storeId\n     * @param array $productIndexes\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",784],["T_WHITESPACE","\n    ",790],["T_PROTECTED","protected",791],["T_WHITESPACE"," ",791],["T_FUNCTION","function",791],["T_WHITESPACE"," ",791],["T_STRING","_saveProductIndexes",791],"(",["T_VARIABLE","$storeId",791],",",["T_WHITESPACE"," ",791],["T_VARIABLE","$productIndexes",791],")",["T_WHITESPACE","\n    ",791],"{",["T_WHITESPACE","\n        ",792],["T_IF","if",793],["T_WHITESPACE"," ",793],"(",["T_VARIABLE","$this",793],["T_OBJECT_OPERATOR","->",793],["T_STRING","_engine",793],")",["T_WHITESPACE"," ",793],"{",["T_WHITESPACE","\n            ",793],["T_VARIABLE","$this",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","_engine",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","saveEntityIndexes",794],"(",["T_VARIABLE","$storeId",794],",",["T_WHITESPACE"," ",794],["T_VARIABLE","$productIndexes",794],")",";",["T_WHITESPACE","\n        ",794],"}",["T_WHITESPACE","\n\n        ",795],["T_RETURN","return",797],["T_WHITESPACE"," ",797],["T_VARIABLE","$this",797],";",["T_WHITESPACE","\n    ",797],"}",["T_WHITESPACE","\n\n    ",798],["T_DOC_COMMENT","\/**\n     * Retrieve Date value for store\n     *\n     * @param int $storeId\n     * @param string $date\n     * @return string\n     *\/",800],["T_WHITESPACE","\n    ",806],["T_PROTECTED","protected",807],["T_WHITESPACE"," ",807],["T_FUNCTION","function",807],["T_WHITESPACE"," ",807],["T_STRING","_getStoreDate",807],"(",["T_VARIABLE","$storeId",807],",",["T_WHITESPACE"," ",807],["T_VARIABLE","$date",807],["T_WHITESPACE"," ",807],"=",["T_WHITESPACE"," ",807],["T_STRING","null",807],")",["T_WHITESPACE","\n    ",807],"{",["T_WHITESPACE","\n        ",808],["T_IF","if",809],["T_WHITESPACE"," ",809],"(","!",["T_ISSET","isset",809],"(",["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","_dates",809],"[",["T_VARIABLE","$storeId",809],"]",")",")",["T_WHITESPACE"," ",809],"{",["T_WHITESPACE","\n            ",809],["T_VARIABLE","$timezone",810],["T_WHITESPACE"," ",810],"=",["T_WHITESPACE"," ",810],["T_STRING","Mage",810],["T_DOUBLE_COLON","::",810],["T_STRING","getStoreConfig",810],"(",["T_STRING","Mage_Core_Model_Locale",810],["T_DOUBLE_COLON","::",810],["T_STRING","XML_PATH_DEFAULT_TIMEZONE",810],",",["T_WHITESPACE"," ",810],["T_VARIABLE","$storeId",810],")",";",["T_WHITESPACE","\n            ",810],["T_VARIABLE","$locale",811],["T_WHITESPACE","   ",811],"=",["T_WHITESPACE"," ",811],["T_STRING","Mage",811],["T_DOUBLE_COLON","::",811],["T_STRING","getStoreConfig",811],"(",["T_STRING","Mage_Core_Model_Locale",811],["T_DOUBLE_COLON","::",811],["T_STRING","XML_PATH_DEFAULT_LOCALE",811],",",["T_WHITESPACE"," ",811],["T_VARIABLE","$storeId",811],")",";",["T_WHITESPACE","\n            ",811],["T_VARIABLE","$locale",812],["T_WHITESPACE","   ",812],"=",["T_WHITESPACE"," ",812],["T_NEW","new",812],["T_WHITESPACE"," ",812],["T_STRING","Zend_Locale",812],"(",["T_VARIABLE","$locale",812],")",";",["T_WHITESPACE","\n\n            ",812],["T_VARIABLE","$dateObj",814],["T_WHITESPACE"," ",814],"=",["T_WHITESPACE"," ",814],["T_NEW","new",814],["T_WHITESPACE"," ",814],["T_STRING","Zend_Date",814],"(",["T_STRING","null",814],",",["T_WHITESPACE"," ",814],["T_STRING","null",814],",",["T_WHITESPACE"," ",814],["T_VARIABLE","$locale",814],")",";",["T_WHITESPACE","\n            ",814],["T_VARIABLE","$dateObj",815],["T_OBJECT_OPERATOR","->",815],["T_STRING","setTimezone",815],"(",["T_VARIABLE","$timezone",815],")",";",["T_WHITESPACE","\n            ",815],["T_VARIABLE","$this",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","_dates",816],"[",["T_VARIABLE","$storeId",816],"]",["T_WHITESPACE"," ",816],"=",["T_WHITESPACE"," ",816],["T_ARRAY","array",816],"(",["T_VARIABLE","$dateObj",816],",",["T_WHITESPACE"," ",816],["T_VARIABLE","$locale",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","getTranslation",816],"(",["T_STRING","null",816],",",["T_WHITESPACE"," ",816],["T_CONSTANT_ENCAPSED_STRING","'date'",816],",",["T_WHITESPACE"," ",816],["T_VARIABLE","$locale",816],")",")",";",["T_WHITESPACE","\n        ",816],"}",["T_WHITESPACE","\n\n        ",817],["T_IF","if",819],["T_WHITESPACE"," ",819],"(","!",["T_STRING","is_empty_date",819],"(",["T_VARIABLE","$date",819],")",")",["T_WHITESPACE"," ",819],"{",["T_WHITESPACE","\n            ",819],["T_LIST","list",820],"(",["T_VARIABLE","$dateObj",820],",",["T_WHITESPACE"," ",820],["T_VARIABLE","$format",820],")",["T_WHITESPACE"," ",820],"=",["T_WHITESPACE"," ",820],["T_VARIABLE","$this",820],["T_OBJECT_OPERATOR","->",820],["T_STRING","_dates",820],"[",["T_VARIABLE","$storeId",820],"]",";",["T_WHITESPACE","\n            ",820],["T_VARIABLE","$dateObj",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","setDate",821],"(",["T_VARIABLE","$date",821],",",["T_WHITESPACE"," ",821],["T_STRING","Varien_Date",821],["T_DOUBLE_COLON","::",821],["T_STRING","DATETIME_INTERNAL_FORMAT",821],")",";",["T_WHITESPACE","\n\n            ",821],["T_RETURN","return",823],["T_WHITESPACE"," ",823],["T_VARIABLE","$dateObj",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","toString",823],"(",["T_VARIABLE","$format",823],")",";",["T_WHITESPACE","\n        ",823],"}",["T_WHITESPACE","\n\n        ",824],["T_RETURN","return",826],["T_WHITESPACE"," ",826],["T_STRING","null",826],";",["T_WHITESPACE","\n    ",826],"}",["T_WHITESPACE","\n\n\n\n\n\n    ",827],["T_COMMENT","\/\/ Deprecated methods\n",833],["T_WHITESPACE","\n    ",834],["T_DOC_COMMENT","\/**\n     * Set whether table changes are allowed\n     *\n     * @deprecated after 1.6.1.0\n     * @param bool $value\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",835],["T_WHITESPACE","\n    ",841],["T_PUBLIC","public",842],["T_WHITESPACE"," ",842],["T_FUNCTION","function",842],["T_WHITESPACE"," ",842],["T_STRING","setAllowTableChanges",842],"(",["T_VARIABLE","$value",842],["T_WHITESPACE"," ",842],"=",["T_WHITESPACE"," ",842],["T_STRING","true",842],")",["T_WHITESPACE","\n    ",842],"{",["T_WHITESPACE","\n        ",843],["T_VARIABLE","$this",844],["T_OBJECT_OPERATOR","->",844],["T_STRING","_allowTableChanges",844],["T_WHITESPACE"," ",844],"=",["T_WHITESPACE"," ",844],["T_VARIABLE","$value",844],";",["T_WHITESPACE","\n        ",844],["T_RETURN","return",845],["T_WHITESPACE"," ",845],["T_VARIABLE","$this",845],";",["T_WHITESPACE","\n    ",845],"}",["T_WHITESPACE","\n\n    ",846],["T_DOC_COMMENT","\/**\n     * Update category products indexes\n     *\n     * deprecated after 1.6.2.0\n     *\n     * @param array $productIds\n     * @param array $categoryIds\n     * @return Mage_CatalogSearch_Model_Resource_Fulltext\n     *\/",848],["T_WHITESPACE","\n    ",856],["T_PUBLIC","public",857],["T_WHITESPACE"," ",857],["T_FUNCTION","function",857],["T_WHITESPACE"," ",857],["T_STRING","updateCategoryIndex",857],"(",["T_VARIABLE","$productIds",857],",",["T_WHITESPACE"," ",857],["T_VARIABLE","$categoryIds",857],")",["T_WHITESPACE","\n    ",857],"{",["T_WHITESPACE","\n        ",858],["T_RETURN","return",859],["T_WHITESPACE"," ",859],["T_VARIABLE","$this",859],";",["T_WHITESPACE","\n    ",859],"}",["T_WHITESPACE","\n",860],"}",["T_WHITESPACE","\n",861]]