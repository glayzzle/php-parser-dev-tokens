[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Admin\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Auth session model\n *\n * @category    Mage\n * @package     Mage_Admin\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Admin_Model_Session",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Session_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Whether it is the first page after successfull login\n     *\n     * @var boolean\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_isFirstPageAfterLogin",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * @var Mage_Admin_Model_Redirectpolicy\n     *\/",45],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_urlPolicy",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * @var Mage_Core_Controller_Response_Http\n     *\/",50],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$_response",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * @var Mage_Core_Model_Factory\n     *\/",55],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_factory",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Class constructor\n     *\n     *\/",60],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","__construct",64],"(",["T_VARIABLE","$parameters",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",")",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_DOC_COMMENT","\/** @var Mage_Admin_Model_Redirectpolicy _urlPolicy *\/",66],["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_urlPolicy",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],"(","!",["T_EMPTY","empty",67],"(",["T_VARIABLE","$parameters",67],"[",["T_CONSTANT_ENCAPSED_STRING","'redirectPolicy'",67],"]",")",")",["T_WHITESPACE"," ",67],"?",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$parameters",68],"[",["T_CONSTANT_ENCAPSED_STRING","'redirectPolicy'",68],"]",["T_WHITESPACE"," ",68],":",["T_WHITESPACE"," ",68],["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","getModel",68],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/redirectpolicy'",68],")",";",["T_WHITESPACE","\n\n        ",68],["T_DOC_COMMENT","\/** @var Mage_Core_Controller_Response_Http _response *\/",70],["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_response",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],"(","!",["T_EMPTY","empty",71],"(",["T_VARIABLE","$parameters",71],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",71],"]",")",")",["T_WHITESPACE"," ",71],"?",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$parameters",72],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",72],"]",["T_WHITESPACE"," ",72],":",["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","Mage_Core_Controller_Response_Http",72],"(",")",";",["T_WHITESPACE","\n\n        ",72],["T_DOC_COMMENT","\/** @var $user Mage_Core_Model_Factory *\/",74],["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_factory",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],"(","!",["T_EMPTY","empty",75],"(",["T_VARIABLE","$parameters",75],"[",["T_CONSTANT_ENCAPSED_STRING","'factory'",75],"]",")",")",["T_WHITESPACE"," ",75],"?",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$parameters",76],"[",["T_CONSTANT_ENCAPSED_STRING","'factory'",76],"]",["T_WHITESPACE"," ",76],":",["T_WHITESPACE"," ",76],["T_STRING","Mage",76],["T_DOUBLE_COLON","::",76],["T_STRING","getModel",76],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/factory'",76],")",";",["T_WHITESPACE","\n\n        ",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","init",78],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",78],")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Pull out information from session whether there is currently the first page after log in\n     *\n     * The idea is to set this value on login(), then redirect happens,\n     * after that on next request the value is grabbed once the session is initialized\n     * Since the session is used as a singleton, the value will be in $_isFirstPageAfterLogin until the end of request,\n     * unless it is reset intentionally from somewhere\n     *\n     * @param string $namespace\n     * @param string $sessionName\n     * @return Mage_Admin_Model_Session\n     * @see self::login()\n     *\/",81],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","init",94],"(",["T_VARIABLE","$namespace",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$sessionName",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","null",94],")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_STRING","parent",96],["T_DOUBLE_COLON","::",96],["T_STRING","init",96],"(",["T_VARIABLE","$namespace",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$sessionName",96],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","isFirstPageAfterLogin",97],"(",")",";",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Try to login user in admin\n     *\n     * @param  string $username\n     * @param  string $password\n     * @param  Mage_Core_Controller_Request_Http $request\n     * @return Mage_Admin_Model_User|null\n     *\/",101],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","login",109],"(",["T_VARIABLE","$username",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$password",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$request",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","null",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_EMPTY","empty",111],"(",["T_VARIABLE","$username",111],")",["T_WHITESPACE"," ",111],["T_BOOLEAN_OR","||",111],["T_WHITESPACE"," ",111],["T_EMPTY","empty",111],"(",["T_VARIABLE","$password",111],")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_RETURN","return",112],";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_TRY","try",115],["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_DOC_COMMENT","\/** @var $user Mage_Admin_Model_User *\/",116],["T_WHITESPACE","\n            ",116],["T_VARIABLE","$user",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_factory",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getModel",117],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",117],")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$user",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","login",118],"(",["T_VARIABLE","$username",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$password",118],")",";",["T_WHITESPACE","\n            ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$user",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getId",119],"(",")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","renewSession",120],"(",")",";",["T_WHITESPACE","\n\n                ",120],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","getSingleton",122],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/url'",122],")",["T_OBJECT_OPERATOR","->",122],["T_STRING","useSecretKey",122],"(",")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                    ",122],["T_STRING","Mage",123],["T_DOUBLE_COLON","::",123],["T_STRING","getSingleton",123],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/url'",123],")",["T_OBJECT_OPERATOR","->",123],["T_STRING","renewSecretUrls",123],"(",")",";",["T_WHITESPACE","\n                ",123],"}",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","setIsFirstPageAfterLogin",125],"(",["T_STRING","true",125],")",";",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setUser",126],"(",["T_VARIABLE","$user",126],")",";",["T_WHITESPACE","\n                ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","setAcl",127],"(",["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","getResourceModel",127],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/acl'",127],")",["T_OBJECT_OPERATOR","->",127],["T_STRING","loadAcl",127],"(",")",")",";",["T_WHITESPACE","\n\n                ",127],["T_VARIABLE","$alternativeUrl",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_getRequestUri",129],"(",["T_VARIABLE","$request",129],")",";",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$redirectUrl",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_urlPolicy",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getRedirectUrl",130],"(",["T_VARIABLE","$user",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$request",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$alternativeUrl",130],")",";",["T_WHITESPACE","\n                ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$redirectUrl",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                    ",131],["T_STRING","Mage",132],["T_DOUBLE_COLON","::",132],["T_STRING","dispatchEvent",132],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_session_user_login_success'",132],",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$user",132],")",")",";",["T_WHITESPACE","\n                    ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_response",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","clearHeaders",133],"(",")",["T_WHITESPACE","\n                        ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","setRedirect",134],"(",["T_VARIABLE","$redirectUrl",134],")",["T_WHITESPACE","\n                        ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","sendHeadersAndExit",135],"(",")",";",["T_WHITESPACE","\n                ",135],"}",["T_WHITESPACE","\n            ",136],"}",["T_WHITESPACE"," ",137],["T_ELSE","else",137],["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                ",137],["T_STRING","Mage",138],["T_DOUBLE_COLON","::",138],["T_STRING","throwException",138],"(",["T_STRING","Mage",138],["T_DOUBLE_COLON","::",138],["T_STRING","helper",138],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",138],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","__",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid User Name or Password.'",138],")",")",";",["T_WHITESPACE","\n            ",138],"}",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE"," ",140],["T_CATCH","catch",140],["T_WHITESPACE"," ",140],"(",["T_STRING","Mage_Core_Exception",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$e",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","dispatchEvent",141],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_session_user_login_failed'",141],",",["T_WHITESPACE","\n                ",141],["T_ARRAY","array",142],"(",["T_CONSTANT_ENCAPSED_STRING","'user_name'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$username",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'exception'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$e",142],")",")",";",["T_WHITESPACE","\n            ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$request",143],["T_WHITESPACE"," ",143],["T_BOOLEAN_AND","&&",143],["T_WHITESPACE"," ",143],"!",["T_VARIABLE","$request",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getParam",143],"(",["T_CONSTANT_ENCAPSED_STRING","'messageSent'",143],")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                ",143],["T_STRING","Mage",144],["T_DOUBLE_COLON","::",144],["T_STRING","getSingleton",144],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",144],")",["T_OBJECT_OPERATOR","->",144],["T_STRING","addError",144],"(",["T_VARIABLE","$e",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getMessage",144],"(",")",")",";",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$request",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","setParam",145],"(",["T_CONSTANT_ENCAPSED_STRING","'messageSent'",145],",",["T_WHITESPACE"," ",145],["T_STRING","true",145],")",";",["T_WHITESPACE","\n            ",145],"}",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n\n        ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$user",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Refresh ACL resources stored in session\n     *\n     * @param  Mage_Admin_Model_User $user\n     * @return Mage_Admin_Model_Session\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","refreshAcl",158],"(",["T_VARIABLE","$user",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","null",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_STRING","is_null",160],"(",["T_VARIABLE","$user",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$user",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getUser",161],"(",")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n        ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(","!",["T_VARIABLE","$user",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n        ",165],["T_IF","if",166],["T_WHITESPACE"," ",166],"(","!",["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getAcl",166],"(",")",["T_WHITESPACE"," ",166],["T_BOOLEAN_OR","||",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$user",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getReloadAclFlag",166],"(",")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","setAcl",167],"(",["T_STRING","Mage",167],["T_DOUBLE_COLON","::",167],["T_STRING","getResourceModel",167],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/acl'",167],")",["T_OBJECT_OPERATOR","->",167],["T_STRING","loadAcl",167],"(",")",")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n        ",168],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$user",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getReloadAclFlag",169],"(",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$user",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","unsetData",170],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",170],")",";",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$user",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","setReloadAclFlag",171],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",171],")",["T_OBJECT_OPERATOR","->",171],["T_STRING","save",171],"(",")",";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n        ",172],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],";",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Check current user permission on resource and privilege\n     *\n     * Mage::getSingleton('admin\/session')->isAllowed('admin\/catalog')\n     * Mage::getSingleton('admin\/session')->isAllowed('catalog')\n     *\n     * @param   string $resource\n     * @param   string $privilege\n     * @return  boolean\n     *\/",176],["T_WHITESPACE","\n    ",185],["T_PUBLIC","public",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","isAllowed",186],"(",["T_VARIABLE","$resource",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$privilege",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","null",186],")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$user",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getUser",188],"(",")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$acl",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getAcl",189],"(",")",";",["T_WHITESPACE","\n\n        ",189],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$user",191],["T_WHITESPACE"," ",191],["T_BOOLEAN_AND","&&",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$acl",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(","!",["T_STRING","preg_match",192],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^admin\/'",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$resource",192],")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                ",192],["T_VARIABLE","$resource",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'admin\/'",193],["T_WHITESPACE"," ",193],".",["T_WHITESPACE"," ",193],["T_VARIABLE","$resource",193],";",["T_WHITESPACE","\n            ",193],"}",["T_WHITESPACE","\n\n            ",194],["T_TRY","try",196],["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n                ",196],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$acl",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","isAllowed",197],"(",["T_VARIABLE","$user",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getAclRole",197],"(",")",",",["T_WHITESPACE"," ",197],["T_VARIABLE","$resource",197],",",["T_WHITESPACE"," ",197],["T_VARIABLE","$privilege",197],")",";",["T_WHITESPACE","\n            ",197],"}",["T_WHITESPACE"," ",198],["T_CATCH","catch",198],["T_WHITESPACE"," ",198],"(",["T_STRING","Exception",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$e",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n                ",198],["T_TRY","try",199],["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                    ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(","!",["T_VARIABLE","$acl",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","has",200],"(",["T_VARIABLE","$resource",200],")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                        ",200],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$acl",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","isAllowed",201],"(",["T_VARIABLE","$user",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getAclRole",201],"(",")",",",["T_WHITESPACE"," ",201],["T_STRING","null",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$privilege",201],")",";",["T_WHITESPACE","\n                    ",201],"}",["T_WHITESPACE","\n                ",202],"}",["T_WHITESPACE"," ",203],["T_CATCH","catch",203],["T_WHITESPACE"," ",203],"(",["T_STRING","Exception",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$e",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE"," ",203],"}",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n        ",205],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_STRING","false",206],";",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n\n    ",207],["T_DOC_COMMENT","\/**\n     * Check if user is logged in\n     *\n     * @return boolean\n     *\/",209],["T_WHITESPACE","\n    ",213],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","isLoggedIn",214],"(",")",["T_WHITESPACE","\n    ",214],"{",["T_WHITESPACE","\n        ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getUser",216],"(",")",["T_WHITESPACE"," ",216],["T_BOOLEAN_AND","&&",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getUser",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","getId",216],"(",")",";",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n\n    ",217],["T_DOC_COMMENT","\/**\n     * Check if it is the first page after successfull login\n     *\n     * @return boolean\n     *\/",219],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","isFirstPageAfterLogin",224],"(",")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_STRING","is_null",226],"(",["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_isFirstPageAfterLogin",226],")",")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_isFirstPageAfterLogin",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getData",227],"(",["T_CONSTANT_ENCAPSED_STRING","'is_first_visit'",227],",",["T_WHITESPACE"," ",227],["T_STRING","true",227],")",";",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE","\n        ",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_isFirstPageAfterLogin",229],";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_DOC_COMMENT","\/**\n     * Setter whether the current\/next page should be treated as first page after login\n     *\n     * @param bool $value\n     * @return Mage_Admin_Model_Session\n     *\/",232],["T_WHITESPACE","\n    ",237],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","setIsFirstPageAfterLogin",238],"(",["T_VARIABLE","$value",238],")",["T_WHITESPACE","\n    ",238],"{",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_isFirstPageAfterLogin",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_BOOL_CAST","(bool)",240],["T_VARIABLE","$value",240],";",["T_WHITESPACE","\n        ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","setIsFirstVisit",241],"(",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_isFirstPageAfterLogin",241],")",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Custom REQUEST_URI logic\n     *\n     * @param Mage_Core_Controller_Request_Http $request\n     * @return string|null\n     *\/",244],["T_WHITESPACE","\n    ",249],["T_PROTECTED","protected",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","_getRequestUri",250],"(",["T_VARIABLE","$request",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","null",250],")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_STRING","Mage",252],["T_DOUBLE_COLON","::",252],["T_STRING","getSingleton",252],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/url'",252],")",["T_OBJECT_OPERATOR","->",252],["T_STRING","useSecretKey",252],"(",")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_RETURN","return",253],["T_WHITESPACE"," ",253],["T_STRING","Mage",253],["T_DOUBLE_COLON","::",253],["T_STRING","getSingleton",253],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/url'",253],")",["T_OBJECT_OPERATOR","->",253],["T_STRING","getUrl",253],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/*'",253],",",["T_WHITESPACE"," ",253],["T_ARRAY","array",253],"(",["T_CONSTANT_ENCAPSED_STRING","'_current'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_STRING","true",253],")",")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE"," ",254],["T_ELSEIF","elseif",254],["T_WHITESPACE"," ",254],"(",["T_VARIABLE","$request",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n            ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$request",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getRequestUri",255],"(",")",";",["T_WHITESPACE","\n        ",255],"}",["T_WHITESPACE"," ",256],["T_ELSE","else",256],["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n            ",256],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_STRING","null",257],";",["T_WHITESPACE","\n        ",257],"}",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n",259],"}",["T_WHITESPACE","\n",260]]