[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Admin\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Admin user model\n *\n * @method Mage_Admin_Model_Resource_User _getResource()\n * @method Mage_Admin_Model_Resource_User getResource()\n * @method string getFirstname()\n * @method Mage_Admin_Model_User setFirstname(string $value)\n * @method string getLastname()\n * @method Mage_Admin_Model_User setLastname(string $value)\n * @method string getEmail()\n * @method Mage_Admin_Model_User setEmail(string $value)\n * @method string getUsername()\n * @method Mage_Admin_Model_User setUsername(string $value)\n * @method string getPassword()\n * @method Mage_Admin_Model_User setPassword(string $value)\n * @method string getCreated()\n * @method Mage_Admin_Model_User setCreated(string $value)\n * @method string getModified()\n * @method Mage_Admin_Model_User setModified(string $value)\n * @method string getLogdate()\n * @method Mage_Admin_Model_User setLogdate(string $value)\n * @method int getLognum()\n * @method Mage_Admin_Model_User setLognum(int $value)\n * @method int getReloadAclFlag()\n * @method Mage_Admin_Model_User setReloadAclFlag(int $value)\n * @method int getIsActive()\n * @method Mage_Admin_Model_User setIsActive(int $value)\n * @method string getExtra()\n * @method Mage_Admin_Model_User setExtra(string $value)\n *\n * @category    Mage\n * @package     Mage_Admin\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",60],["T_CLASS","class",61],["T_WHITESPACE"," ",61],["T_STRING","Mage_Admin_Model_User",61],["T_WHITESPACE"," ",61],["T_EXTENDS","extends",61],["T_WHITESPACE"," ",61],["T_STRING","Mage_Core_Model_Abstract",61],["T_WHITESPACE","\n",61],"{",["T_WHITESPACE","\n    ",62],["T_COMMENT","\/**#@+\n     * Configuration paths for email templates and identities\n     *\/",63],["T_WHITESPACE","\n    ",65],["T_CONST","const",66],["T_WHITESPACE"," ",66],["T_STRING","XML_PATH_FORGOT_EMAIL_TEMPLATE",66],["T_WHITESPACE","    ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'admin\/emails\/forgot_email_template'",66],";",["T_WHITESPACE","\n    ",66],["T_CONST","const",67],["T_WHITESPACE"," ",67],["T_STRING","XML_PATH_FORGOT_EMAIL_IDENTITY",67],["T_WHITESPACE","    ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'admin\/emails\/forgot_email_identity'",67],";",["T_WHITESPACE","\n    ",67],["T_CONST","const",68],["T_WHITESPACE"," ",68],["T_STRING","XML_PATH_STARTUP_PAGE",68],["T_WHITESPACE","             ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'admin\/startup\/page'",68],";",["T_WHITESPACE","\n    ",68],["T_COMMENT","\/**#@-*\/",69],["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Minimum length of admin password\n     *\/",71],["T_WHITESPACE","\n    ",73],["T_CONST","const",74],["T_WHITESPACE"," ",74],["T_STRING","MIN_PASSWORD_LENGTH",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_LNUMBER","7",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Length of salt\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_CONST","const",79],["T_WHITESPACE"," ",79],["T_STRING","HASH_SALT_LENGTH",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_LNUMBER","32",79],";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Model event prefix\n     *\n     * @var string\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_eventPrefix",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'admin_user'",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Admin role\n     *\n     * @var Mage_Admin_Model_Roles\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_PROTECTED","protected",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$_role",93],";",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Available resources flag\n     *\n     * @var boolean\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$_hasAvailableResources",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","true",100],";",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Initialize user model\n     *\/",102],["T_WHITESPACE","\n    ",104],["T_PROTECTED","protected",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","_construct",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_init",107],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",107],")",";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * Processing data before model save\n     *\n     * @return Mage_Admin_Model_User\n     *\/",110],["T_WHITESPACE","\n    ",114],["T_PROTECTED","protected",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","_beforeSave",115],"(",")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$data",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_ARRAY","array",117],"(",["T_WHITESPACE","\n            ",117],["T_CONSTANT_ENCAPSED_STRING","'firstname'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getFirstname",118],"(",")",",",["T_WHITESPACE","\n            ",118],["T_CONSTANT_ENCAPSED_STRING","'lastname'",119],["T_WHITESPACE","  ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getLastname",119],"(",")",",",["T_WHITESPACE","\n            ",119],["T_CONSTANT_ENCAPSED_STRING","'email'",120],["T_WHITESPACE","     ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getEmail",120],"(",")",",",["T_WHITESPACE","\n            ",120],["T_CONSTANT_ENCAPSED_STRING","'modified'",121],["T_WHITESPACE","  ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_getDateNow",121],"(",")",",",["T_WHITESPACE","\n            ",121],["T_CONSTANT_ENCAPSED_STRING","'extra'",122],["T_WHITESPACE","     ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_STRING","serialize",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getExtra",122],"(",")",")",["T_WHITESPACE","\n        ",122],")",";",["T_WHITESPACE","\n\n        ",123],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getId",125],"(",")",["T_WHITESPACE"," ",125],">",["T_WHITESPACE"," ",125],["T_LNUMBER","0",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$data",126],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id'",126],"]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getId",126],"(",")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getUsername",129],"(",")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$data",130],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getUsername",130],"(",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n\n        ",131],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getNewPassword",133],"(",")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_COMMENT","\/\/ Change user password\n",134],["T_WHITESPACE","            ",135],["T_VARIABLE","$data",135],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",135],"]",["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_getEncodedPassword",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getNewPassword",135],"(",")",")",";",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$data",136],"[",["T_CONSTANT_ENCAPSED_STRING","'new_password'",136],"]",["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$data",136],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",136],"]",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE"," ",137],["T_ELSEIF","elseif",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getPassword",137],"(",")",["T_WHITESPACE"," ",137],["T_BOOLEAN_AND","&&",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getPassword",137],"(",")",["T_WHITESPACE"," ",137],["T_IS_NOT_EQUAL","!=",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getOrigData",137],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",137],")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_COMMENT","\/\/ New user password\n",138],["T_WHITESPACE","            ",139],["T_VARIABLE","$data",139],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_getEncodedPassword",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getPassword",139],"(",")",")",";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE"," ",140],["T_ELSEIF","elseif",140],["T_WHITESPACE"," ",140],"(","!",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getPassword",140],"(",")",["T_WHITESPACE"," ",140],["T_BOOLEAN_AND","&&",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getOrigData",140],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",140],")",["T_WHITESPACE"," ",140],["T_COMMENT","\/\/ Change user data\n",140],["T_WHITESPACE","            ",141],["T_BOOLEAN_OR","||",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getPassword",141],"(",")",["T_WHITESPACE"," ",141],["T_IS_EQUAL","==",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getOrigData",141],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",141],")",["T_WHITESPACE","     ",141],["T_COMMENT","\/\/ Retrieve user password\n",141],["T_WHITESPACE","        ",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$data",143],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",143],"]",["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getOrigData",143],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",143],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","cleanPasswordsValidationData",146],"(",")",";",["T_WHITESPACE","\n\n        ",146],["T_IF","if",148],["T_WHITESPACE"," ",148],"(","!",["T_STRING","is_null",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getIsActive",148],"(",")",")",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$data",149],"[",["T_CONSTANT_ENCAPSED_STRING","'is_active'",149],"]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","intval",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getIsActive",149],"(",")",")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","addData",152],"(",["T_VARIABLE","$data",152],")",";",["T_WHITESPACE","\n\n        ",152],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_STRING","parent",154],["T_DOUBLE_COLON","::",154],["T_STRING","_beforeSave",154],"(",")",";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_DOC_COMMENT","\/**\n     * Save admin user extra data (like configuration sections state)\n     *\n     * @param   array $data\n     * @return  Mage_Admin_Model_User\n     *\/",157],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","saveExtra",163],"(",["T_VARIABLE","$data",163],")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_STRING","is_array",165],"(",["T_VARIABLE","$data",165],")",")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$data",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","serialize",166],"(",["T_VARIABLE","$data",166],")",";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_getResource",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","saveExtra",168],"(",["T_VARIABLE","$this",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$data",168],")",";",["T_WHITESPACE","\n        ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Save user roles\n     *\n     * @return Mage_Admin_Model_User\n     *\/",172],["T_WHITESPACE","\n    ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","saveRelations",177],"(",")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_getResource",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","_saveRelations",179],"(",["T_VARIABLE","$this",179],")",";",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Retrieve user roles\n     *\n     * @return array\n     *\/",183],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","getRoles",188],"(",")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_getResource",190],"(",")",["T_OBJECT_OPERATOR","->",190],["T_STRING","getRoles",190],"(",["T_VARIABLE","$this",190],")",";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Get admin role model\n     *\n     * @return Mage_Admin_Model_Roles\n     *\/",193],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","getRole",198],"(",")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_STRING","null",200],["T_WHITESPACE"," ",200],["T_IS_IDENTICAL","===",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_role",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_role",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","Mage",201],["T_DOUBLE_COLON","::",201],["T_STRING","getModel",201],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/roles'",201],")",";",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$roles",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getRoles",202],"(",")",";",["T_WHITESPACE","\n            ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$roles",203],["T_WHITESPACE"," ",203],["T_BOOLEAN_AND","&&",203],["T_WHITESPACE"," ",203],["T_ISSET","isset",203],"(",["T_VARIABLE","$roles",203],"[",["T_LNUMBER","0",203],"]",")",["T_WHITESPACE"," ",203],["T_BOOLEAN_AND","&&",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$roles",203],"[",["T_LNUMBER","0",203],"]",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n                ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_role",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","load",204],"(",["T_VARIABLE","$roles",204],"[",["T_LNUMBER","0",204],"]",")",";",["T_WHITESPACE","\n            ",204],"}",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n        ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_role",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Unassign user from his current role\n     *\n     * @return Mage_Admin_Model_User\n     *\/",210],["T_WHITESPACE","\n    ",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","deleteFromRole",215],"(",")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_getResource",217],"(",")",["T_OBJECT_OPERATOR","->",217],["T_STRING","deleteFromRole",217],"(",["T_VARIABLE","$this",217],")",";",["T_WHITESPACE","\n        ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Check if such combination role\/user exists\n     *\n     * @return boolean\n     *\/",221],["T_WHITESPACE","\n    ",225],["T_PUBLIC","public",226],["T_WHITESPACE"," ",226],["T_FUNCTION","function",226],["T_WHITESPACE"," ",226],["T_STRING","roleUserExists",226],"(",")",["T_WHITESPACE","\n    ",226],"{",["T_WHITESPACE","\n        ",227],["T_VARIABLE","$result",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_getResource",228],"(",")",["T_OBJECT_OPERATOR","->",228],["T_STRING","roleUserExists",228],"(",["T_VARIABLE","$this",228],")",";",["T_WHITESPACE","\n        ",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],"(",["T_STRING","is_array",229],"(",["T_VARIABLE","$result",229],")",["T_WHITESPACE"," ",229],["T_BOOLEAN_AND","&&",229],["T_WHITESPACE"," ",229],["T_STRING","count",229],"(",["T_VARIABLE","$result",229],")",["T_WHITESPACE"," ",229],">",["T_WHITESPACE"," ",229],["T_LNUMBER","0",229],")",["T_WHITESPACE"," ",229],"?",["T_WHITESPACE"," ",229],["T_STRING","true",229],["T_WHITESPACE"," ",229],":",["T_WHITESPACE"," ",229],["T_STRING","false",229],";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_DOC_COMMENT","\/**\n     * Assign user to role\n     *\n     * @return Mage_Admin_Model_User\n     *\/",232],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","add",237],"(",")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_getResource",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","add",239],"(",["T_VARIABLE","$this",239],")",";",["T_WHITESPACE","\n        ",239],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],";",["T_WHITESPACE","\n    ",240],"}",["T_WHITESPACE","\n\n    ",241],["T_DOC_COMMENT","\/**\n     * Check if user exists based on its id, username and email\n     *\n     * @return boolean\n     *\/",243],["T_WHITESPACE","\n    ",247],["T_PUBLIC","public",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","userExists",248],"(",")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$result",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_getResource",250],"(",")",["T_OBJECT_OPERATOR","->",250],["T_STRING","userExists",250],"(",["T_VARIABLE","$this",250],")",";",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],"(",["T_STRING","is_array",251],"(",["T_VARIABLE","$result",251],")",["T_WHITESPACE"," ",251],["T_BOOLEAN_AND","&&",251],["T_WHITESPACE"," ",251],["T_STRING","count",251],"(",["T_VARIABLE","$result",251],")",["T_WHITESPACE"," ",251],">",["T_WHITESPACE"," ",251],["T_LNUMBER","0",251],")",["T_WHITESPACE"," ",251],"?",["T_WHITESPACE"," ",251],["T_STRING","true",251],["T_WHITESPACE"," ",251],":",["T_WHITESPACE"," ",251],["T_STRING","false",251],";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Retrieve admin user collection\n     *\n     * @return Mage_Admin_Model_Resource_User_Collection\n     *\/",254],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","getCollection",259],"(",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n        ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_STRING","Mage",260],["T_DOUBLE_COLON","::",260],["T_STRING","getResourceModel",260],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user_collection'",260],")",";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Send email with new user password\n     *\n     * @return Mage_Admin_Model_User\n     * @deprecated deprecated since version 1.6.1.0\n     *\/",263],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","sendNewPasswordEmail",269],"(",")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Send email with reset password confirmation link\n     *\n     * @return Mage_Admin_Model_User\n     *\/",274],["T_WHITESPACE","\n    ",278],["T_PUBLIC","public",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","sendPasswordResetConfirmationEmail",279],"(",")",["T_WHITESPACE","\n    ",279],"{",["T_WHITESPACE","\n        ",280],["T_DOC_COMMENT","\/** @var $mailer Mage_Core_Model_Email_Template_Mailer *\/",281],["T_WHITESPACE","\n        ",281],["T_VARIABLE","$mailer",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","Mage",282],["T_DOUBLE_COLON","::",282],["T_STRING","getModel",282],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template_mailer'",282],")",";",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$emailInfo",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","Mage",283],["T_DOUBLE_COLON","::",283],["T_STRING","getModel",283],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_info'",283],")",";",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$emailInfo",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","addTo",284],"(",["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getEmail",284],"(",")",",",["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getName",284],"(",")",")",";",["T_WHITESPACE","\n        ",284],["T_VARIABLE","$mailer",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","addEmailInfo",285],"(",["T_VARIABLE","$emailInfo",285],")",";",["T_WHITESPACE","\n\n        ",285],["T_COMMENT","\/\/ Set all required params and send emails\n",287],["T_WHITESPACE","        ",288],["T_VARIABLE","$mailer",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","setSender",288],"(",["T_STRING","Mage",288],["T_DOUBLE_COLON","::",288],["T_STRING","getStoreConfig",288],"(",["T_STRING","self",288],["T_DOUBLE_COLON","::",288],["T_STRING","XML_PATH_FORGOT_EMAIL_IDENTITY",288],")",")",";",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$mailer",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","setStoreId",289],"(",["T_LNUMBER","0",289],")",";",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$mailer",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","setTemplateId",290],"(",["T_STRING","Mage",290],["T_DOUBLE_COLON","::",290],["T_STRING","getStoreConfig",290],"(",["T_STRING","self",290],["T_DOUBLE_COLON","::",290],["T_STRING","XML_PATH_FORGOT_EMAIL_TEMPLATE",290],")",")",";",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$mailer",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","setTemplateParams",291],"(",["T_ARRAY","array",291],"(",["T_WHITESPACE","\n            ",291],["T_CONSTANT_ENCAPSED_STRING","'user'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_WHITESPACE","\n        ",292],")",")",";",["T_WHITESPACE","\n        ",293],["T_VARIABLE","$mailer",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","send",294],"(",")",";",["T_WHITESPACE","\n\n        ",294],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Retrieve user name\n     *\n     * @param string $separator\n     * @return string\n     *\/",299],["T_WHITESPACE","\n    ",304],["T_PUBLIC","public",305],["T_WHITESPACE"," ",305],["T_FUNCTION","function",305],["T_WHITESPACE"," ",305],["T_STRING","getName",305],"(",["T_VARIABLE","$separator",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_CONSTANT_ENCAPSED_STRING","' '",305],")",["T_WHITESPACE","\n    ",305],"{",["T_WHITESPACE","\n        ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getFirstname",307],"(",")",["T_WHITESPACE"," ",307],".",["T_WHITESPACE"," ",307],["T_VARIABLE","$separator",307],["T_WHITESPACE"," ",307],".",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getLastname",307],"(",")",";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * Retrieve user identifier\n     *\n     * @return mixed\n     *\/",310],["T_WHITESPACE","\n    ",314],["T_PUBLIC","public",315],["T_WHITESPACE"," ",315],["T_FUNCTION","function",315],["T_WHITESPACE"," ",315],["T_STRING","getId",315],"(",")",["T_WHITESPACE","\n    ",315],"{",["T_WHITESPACE","\n        ",316],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getUserId",317],"(",")",";",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n\n    ",318],["T_DOC_COMMENT","\/**\n     * Get user ACL role\n     *\n     * @return string\n     *\/",320],["T_WHITESPACE","\n    ",324],["T_PUBLIC","public",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","getAclRole",325],"(",")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_RETURN","return",327],["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'U'",327],["T_WHITESPACE"," ",327],".",["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getUserId",327],"(",")",";",["T_WHITESPACE","\n    ",327],"}",["T_WHITESPACE","\n\n    ",328],["T_DOC_COMMENT","\/**\n     * Authenticate user name and password and save loaded record\n     *\n     * @param string $username\n     * @param string $password\n     * @return boolean\n     * @throws Mage_Core_Exception\n     *\/",330],["T_WHITESPACE","\n    ",337],["T_PUBLIC","public",338],["T_WHITESPACE"," ",338],["T_FUNCTION","function",338],["T_WHITESPACE"," ",338],["T_STRING","authenticate",338],"(",["T_VARIABLE","$username",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$password",338],")",["T_WHITESPACE","\n    ",338],"{",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$config",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_STRING","Mage",340],["T_DOUBLE_COLON","::",340],["T_STRING","getStoreConfigFlag",340],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/security\/use_case_sensitive_login'",340],")",";",["T_WHITESPACE","\n        ",340],["T_VARIABLE","$result",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_STRING","false",341],";",["T_WHITESPACE","\n\n        ",341],["T_TRY","try",343],["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n            ",343],["T_STRING","Mage",344],["T_DOUBLE_COLON","::",344],["T_STRING","dispatchEvent",344],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_user_authenticate_before'",344],",",["T_WHITESPACE"," ",344],["T_ARRAY","array",344],"(",["T_WHITESPACE","\n                ",344],["T_CONSTANT_ENCAPSED_STRING","'username'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$username",345],",",["T_WHITESPACE","\n                ",345],["T_CONSTANT_ENCAPSED_STRING","'user'",346],["T_WHITESPACE","     ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],["T_WHITESPACE","\n            ",346],")",")",";",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","loadByUsername",348],"(",["T_VARIABLE","$username",348],")",";",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$sensitive",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],"(",["T_VARIABLE","$config",349],")",["T_WHITESPACE"," ",349],"?",["T_WHITESPACE"," ",349],["T_VARIABLE","$username",349],["T_WHITESPACE"," ",349],["T_IS_EQUAL","==",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getUsername",349],"(",")",["T_WHITESPACE"," ",349],":",["T_WHITESPACE"," ",349],["T_STRING","true",349],";",["T_WHITESPACE","\n\n            ",349],["T_IF","if",351],["T_WHITESPACE"," ",351],"(",["T_VARIABLE","$sensitive",351],["T_WHITESPACE"," ",351],["T_BOOLEAN_AND","&&",351],["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getId",351],"(",")",["T_WHITESPACE"," ",351],["T_BOOLEAN_AND","&&",351],["T_WHITESPACE"," ",351],["T_STRING","Mage",351],["T_DOUBLE_COLON","::",351],["T_STRING","helper",351],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",351],")",["T_OBJECT_OPERATOR","->",351],["T_STRING","validateHash",351],"(",["T_VARIABLE","$password",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getPassword",351],"(",")",")",")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n                ",351],["T_IF","if",352],["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getIsActive",352],"(",")",["T_WHITESPACE"," ",352],["T_IS_NOT_EQUAL","!=",352],["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'1'",352],")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n                    ",352],["T_STRING","Mage",353],["T_DOUBLE_COLON","::",353],["T_STRING","throwException",353],"(",["T_STRING","Mage",353],["T_DOUBLE_COLON","::",353],["T_STRING","helper",353],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",353],")",["T_OBJECT_OPERATOR","->",353],["T_STRING","__",353],"(",["T_CONSTANT_ENCAPSED_STRING","'This account is inactive.'",353],")",")",";",["T_WHITESPACE","\n                ",353],"}",["T_WHITESPACE","\n                ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(","!",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","hasAssigned2Role",355],"(",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getId",355],"(",")",")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                    ",355],["T_STRING","Mage",356],["T_DOUBLE_COLON","::",356],["T_STRING","throwException",356],"(",["T_STRING","Mage",356],["T_DOUBLE_COLON","::",356],["T_STRING","helper",356],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",356],")",["T_OBJECT_OPERATOR","->",356],["T_STRING","__",356],"(",["T_CONSTANT_ENCAPSED_STRING","'Access denied.'",356],")",")",";",["T_WHITESPACE","\n                ",356],"}",["T_WHITESPACE","\n                ",357],["T_VARIABLE","$result",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","true",358],";",["T_WHITESPACE","\n            ",358],"}",["T_WHITESPACE","\n\n            ",359],["T_STRING","Mage",361],["T_DOUBLE_COLON","::",361],["T_STRING","dispatchEvent",361],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_user_authenticate_after'",361],",",["T_WHITESPACE"," ",361],["T_ARRAY","array",361],"(",["T_WHITESPACE","\n                ",361],["T_CONSTANT_ENCAPSED_STRING","'username'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$username",362],",",["T_WHITESPACE","\n                ",362],["T_CONSTANT_ENCAPSED_STRING","'password'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$password",363],",",["T_WHITESPACE","\n                ",363],["T_CONSTANT_ENCAPSED_STRING","'user'",364],["T_WHITESPACE","     ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],",",["T_WHITESPACE","\n                ",364],["T_CONSTANT_ENCAPSED_STRING","'result'",365],["T_WHITESPACE","   ",365],["T_DOUBLE_ARROW","=>",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$result",365],",",["T_WHITESPACE","\n            ",365],")",")",";",["T_WHITESPACE","\n        ",366],"}",["T_WHITESPACE","\n        ",367],["T_CATCH","catch",368],["T_WHITESPACE"," ",368],"(",["T_STRING","Mage_Core_Exception",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$e",368],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n            ",368],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","unsetData",369],"(",")",";",["T_WHITESPACE","\n            ",369],["T_THROW","throw",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$e",370],";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n\n        ",371],["T_IF","if",373],["T_WHITESPACE"," ",373],"(","!",["T_VARIABLE","$result",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","unsetData",374],"(",")",";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE","\n        ",375],["T_RETURN","return",376],["T_WHITESPACE"," ",376],["T_VARIABLE","$result",376],";",["T_WHITESPACE","\n    ",376],"}",["T_WHITESPACE","\n\n    ",377],["T_DOC_COMMENT","\/**\n     * Login user\n     *\n     * @param   string $login\n     * @param   string $password\n     * @return  Mage_Admin_Model_User\n     *\/",379],["T_WHITESPACE","\n    ",385],["T_PUBLIC","public",386],["T_WHITESPACE"," ",386],["T_FUNCTION","function",386],["T_WHITESPACE"," ",386],["T_STRING","login",386],"(",["T_VARIABLE","$username",386],",",["T_WHITESPACE"," ",386],["T_VARIABLE","$password",386],")",["T_WHITESPACE","\n    ",386],"{",["T_WHITESPACE","\n        ",387],["T_IF","if",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","authenticate",388],"(",["T_VARIABLE","$username",388],",",["T_WHITESPACE"," ",388],["T_VARIABLE","$password",388],")",")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getResource",389],"(",")",["T_OBJECT_OPERATOR","->",389],["T_STRING","recordLogin",389],"(",["T_VARIABLE","$this",389],")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n        ",390],["T_RETURN","return",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$this",391],";",["T_WHITESPACE","\n    ",391],"}",["T_WHITESPACE","\n\n    ",392],["T_DOC_COMMENT","\/**\n     * Reload current user\n     *\n     * @return Mage_Admin_Model_User\n     *\/",394],["T_WHITESPACE","\n    ",398],["T_PUBLIC","public",399],["T_WHITESPACE"," ",399],["T_FUNCTION","function",399],["T_WHITESPACE"," ",399],["T_STRING","reload",399],"(",")",["T_WHITESPACE","\n    ",399],"{",["T_WHITESPACE","\n        ",400],["T_VARIABLE","$id",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getId",401],"(",")",";",["T_WHITESPACE","\n        ",401],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","setId",402],"(",["T_STRING","null",402],")",";",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","load",403],"(",["T_VARIABLE","$id",403],")",";",["T_WHITESPACE","\n        ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],";",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_DOC_COMMENT","\/**\n     * Load user by its username\n     *\n     * @param string $username\n     * @return Mage_Admin_Model_User\n     *\/",407],["T_WHITESPACE","\n    ",412],["T_PUBLIC","public",413],["T_WHITESPACE"," ",413],["T_FUNCTION","function",413],["T_WHITESPACE"," ",413],["T_STRING","loadByUsername",413],"(",["T_VARIABLE","$username",413],")",["T_WHITESPACE","\n    ",413],"{",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","setData",415],"(",["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","getResource",415],"(",")",["T_OBJECT_OPERATOR","->",415],["T_STRING","loadByUsername",415],"(",["T_VARIABLE","$username",415],")",")",";",["T_WHITESPACE","\n        ",415],["T_RETURN","return",416],["T_WHITESPACE"," ",416],["T_VARIABLE","$this",416],";",["T_WHITESPACE","\n    ",416],"}",["T_WHITESPACE","\n\n    ",417],["T_DOC_COMMENT","\/**\n     * Check if user is assigned to any role\n     *\n     * @param int|Mage_Core_Admin_Model_User $user\n     * @return null|boolean|array\n     *\/",419],["T_WHITESPACE","\n    ",424],["T_PUBLIC","public",425],["T_WHITESPACE"," ",425],["T_FUNCTION","function",425],["T_WHITESPACE"," ",425],["T_STRING","hasAssigned2Role",425],"(",["T_VARIABLE","$user",425],")",["T_WHITESPACE","\n    ",425],"{",["T_WHITESPACE","\n        ",426],["T_RETURN","return",427],["T_WHITESPACE"," ",427],["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getResource",427],"(",")",["T_OBJECT_OPERATOR","->",427],["T_STRING","hasAssigned2Role",427],"(",["T_VARIABLE","$user",427],")",";",["T_WHITESPACE","\n    ",427],"}",["T_WHITESPACE","\n\n    ",428],["T_DOC_COMMENT","\/**\n     * Retrieve encoded password\n     *\n     * @param string $password\n     * @return string\n     *\/",430],["T_WHITESPACE","\n    ",435],["T_PROTECTED","protected",436],["T_WHITESPACE"," ",436],["T_FUNCTION","function",436],["T_WHITESPACE"," ",436],["T_STRING","_getEncodedPassword",436],"(",["T_VARIABLE","$password",436],")",["T_WHITESPACE","\n    ",436],"{",["T_WHITESPACE","\n        ",437],["T_RETURN","return",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","_getHelper",438],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",438],")",["T_OBJECT_OPERATOR","->",438],["T_STRING","getHash",438],"(",["T_VARIABLE","$password",438],",",["T_WHITESPACE"," ",438],["T_STRING","self",438],["T_DOUBLE_COLON","::",438],["T_STRING","HASH_SALT_LENGTH",438],")",";",["T_WHITESPACE","\n    ",438],"}",["T_WHITESPACE","\n\n    ",439],["T_DOC_COMMENT","\/**\n     * Returns helper instance\n     *\n     * @param string $helperName\n     * @return Mage_Core_Helper_Abstract\n     *\/",441],["T_WHITESPACE","\n    ",446],["T_PROTECTED","protected",447],["T_WHITESPACE"," ",447],["T_FUNCTION","function",447],["T_WHITESPACE"," ",447],["T_STRING","_getHelper",447],"(",["T_VARIABLE","$helperName",447],")",["T_WHITESPACE","\n    ",447],"{",["T_WHITESPACE","\n        ",448],["T_RETURN","return",449],["T_WHITESPACE"," ",449],["T_STRING","Mage",449],["T_DOUBLE_COLON","::",449],["T_STRING","helper",449],"(",["T_VARIABLE","$helperName",449],")",";",["T_WHITESPACE","\n    ",449],"}",["T_WHITESPACE","\n\n    ",450],["T_DOC_COMMENT","\/**\n     * Find first menu item that user is able to access\n     *\n     * @param Mage_Core_Model_Config_Element $parent\n     * @param string $path\n     * @param integer $level\n     * @return string\n     *\/",452],["T_WHITESPACE","\n    ",459],["T_PUBLIC","public",460],["T_WHITESPACE"," ",460],["T_FUNCTION","function",460],["T_WHITESPACE"," ",460],["T_STRING","findFirstAvailableMenu",460],"(",["T_VARIABLE","$parent",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_STRING","null",460],",",["T_WHITESPACE"," ",460],["T_VARIABLE","$path",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_CONSTANT_ENCAPSED_STRING","''",460],",",["T_WHITESPACE"," ",460],["T_VARIABLE","$level",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_LNUMBER","0",460],")",["T_WHITESPACE","\n    ",460],"{",["T_WHITESPACE","\n        ",461],["T_IF","if",462],["T_WHITESPACE"," ",462],"(",["T_VARIABLE","$parent",462],["T_WHITESPACE"," ",462],["T_IS_EQUAL","==",462],["T_WHITESPACE"," ",462],["T_STRING","null",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_VARIABLE","$parent",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_STRING","Mage",463],["T_DOUBLE_COLON","::",463],["T_STRING","getSingleton",463],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config'",463],")",["T_OBJECT_OPERATOR","->",463],["T_STRING","getAdminhtmlConfig",463],"(",")",["T_OBJECT_OPERATOR","->",463],["T_STRING","getNode",463],"(",["T_CONSTANT_ENCAPSED_STRING","'menu'",463],")",";",["T_WHITESPACE","\n        ",463],"}",["T_WHITESPACE","\n        ",464],["T_FOREACH","foreach",465],["T_WHITESPACE"," ",465],"(",["T_VARIABLE","$parent",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","children",465],"(",")",["T_WHITESPACE"," ",465],["T_AS","as",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$childName",465],["T_WHITESPACE"," ",465],["T_DOUBLE_ARROW","=>",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$child",465],")",["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n            ",465],["T_VARIABLE","$aclResource",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_CONSTANT_ENCAPSED_STRING","'admin\/'",466],["T_WHITESPACE"," ",466],".",["T_WHITESPACE"," ",466],["T_VARIABLE","$path",466],["T_WHITESPACE"," ",466],".",["T_WHITESPACE"," ",466],["T_VARIABLE","$childName",466],";",["T_WHITESPACE","\n            ",466],["T_IF","if",467],["T_WHITESPACE"," ",467],"(",["T_STRING","Mage",467],["T_DOUBLE_COLON","::",467],["T_STRING","getSingleton",467],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",467],")",["T_OBJECT_OPERATOR","->",467],["T_STRING","isAllowed",467],"(",["T_VARIABLE","$aclResource",467],")",")",["T_WHITESPACE"," ",467],"{",["T_WHITESPACE","\n                ",467],["T_IF","if",468],["T_WHITESPACE"," ",468],"(","!",["T_VARIABLE","$child",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","children",468],")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n                    ",468],["T_RETURN","return",469],["T_WHITESPACE"," ",469],["T_STRING_CAST","(string)",469],["T_VARIABLE","$child",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","action",469],";",["T_WHITESPACE","\n                ",469],"}",["T_WHITESPACE"," ",470],["T_ELSE","else",470],["T_WHITESPACE"," ",470],["T_IF","if",470],["T_WHITESPACE"," ",470],"(",["T_VARIABLE","$child",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","children",470],")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n                    ",470],["T_VARIABLE","$action",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","findFirstAvailableMenu",471],"(",["T_VARIABLE","$child",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","children",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$path",471],["T_WHITESPACE"," ",471],".",["T_WHITESPACE"," ",471],["T_VARIABLE","$childName",471],["T_WHITESPACE"," ",471],".",["T_WHITESPACE"," ",471],["T_CONSTANT_ENCAPSED_STRING","'\/'",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$level",471],["T_WHITESPACE"," ",471],"+",["T_WHITESPACE"," ",471],["T_LNUMBER","1",471],")",";",["T_WHITESPACE","\n                    ",471],["T_RETURN","return",472],["T_WHITESPACE"," ",472],["T_VARIABLE","$action",472],["T_WHITESPACE"," ",472],"?",["T_WHITESPACE"," ",472],["T_VARIABLE","$action",472],["T_WHITESPACE"," ",472],":",["T_WHITESPACE"," ",472],["T_STRING_CAST","(string)",472],["T_VARIABLE","$child",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","action",472],";",["T_WHITESPACE","\n                ",472],"}",["T_WHITESPACE","\n            ",473],"}",["T_WHITESPACE","\n        ",474],"}",["T_WHITESPACE","\n        ",475],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","_hasAvailableResources",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_STRING","false",476],";",["T_WHITESPACE","\n        ",476],["T_RETURN","return",477],["T_WHITESPACE"," ",477],["T_CONSTANT_ENCAPSED_STRING","'*\/*\/denied'",477],";",["T_WHITESPACE","\n    ",477],"}",["T_WHITESPACE","\n\n    ",478],["T_DOC_COMMENT","\/**\n     * Check if user has available resources\n     *\n     * @return bool\n     *\/",480],["T_WHITESPACE","\n    ",484],["T_PUBLIC","public",485],["T_WHITESPACE"," ",485],["T_FUNCTION","function",485],["T_WHITESPACE"," ",485],["T_STRING","hasAvailableResources",485],"(",")",["T_WHITESPACE","\n    ",485],"{",["T_WHITESPACE","\n        ",486],["T_RETURN","return",487],["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","_hasAvailableResources",487],";",["T_WHITESPACE","\n    ",487],"}",["T_WHITESPACE","\n\n    ",488],["T_DOC_COMMENT","\/**\n     * Find admin start page url\n     *\n     * @deprecated Please use getStartupPageUrl() method instead\n     * @see getStartupPageUrl()\n     * @return string\n     *\/",490],["T_WHITESPACE","\n    ",496],["T_PUBLIC","public",497],["T_WHITESPACE"," ",497],["T_FUNCTION","function",497],["T_WHITESPACE"," ",497],["T_STRING","getStatrupPageUrl",497],"(",")",["T_WHITESPACE","\n    ",497],"{",["T_WHITESPACE","\n        ",498],["T_RETURN","return",499],["T_WHITESPACE"," ",499],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","getStartupPageUrl",499],"(",")",";",["T_WHITESPACE","\n    ",499],"}",["T_WHITESPACE","\n\n    ",500],["T_DOC_COMMENT","\/**\n     * Find admin start page url\n     *\n     * @return string\n     *\/",502],["T_WHITESPACE","\n    ",506],["T_PUBLIC","public",507],["T_WHITESPACE"," ",507],["T_FUNCTION","function",507],["T_WHITESPACE"," ",507],["T_STRING","getStartupPageUrl",507],"(",")",["T_WHITESPACE","\n    ",507],"{",["T_WHITESPACE","\n        ",508],["T_VARIABLE","$startupPage",509],["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_STRING","Mage",509],["T_DOUBLE_COLON","::",509],["T_STRING","getStoreConfig",509],"(",["T_STRING","self",509],["T_DOUBLE_COLON","::",509],["T_STRING","XML_PATH_STARTUP_PAGE",509],")",";",["T_WHITESPACE","\n        ",509],["T_VARIABLE","$aclResource",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_CONSTANT_ENCAPSED_STRING","'admin\/'",510],["T_WHITESPACE"," ",510],".",["T_WHITESPACE"," ",510],["T_VARIABLE","$startupPage",510],";",["T_WHITESPACE","\n        ",510],["T_IF","if",511],["T_WHITESPACE"," ",511],"(",["T_STRING","Mage",511],["T_DOUBLE_COLON","::",511],["T_STRING","getSingleton",511],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",511],")",["T_OBJECT_OPERATOR","->",511],["T_STRING","isAllowed",511],"(",["T_VARIABLE","$aclResource",511],")",")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n            ",511],["T_VARIABLE","$nodePath",512],["T_WHITESPACE"," ",512],"=",["T_WHITESPACE"," ",512],["T_CONSTANT_ENCAPSED_STRING","'menu\/'",512],["T_WHITESPACE"," ",512],".",["T_WHITESPACE"," ",512],["T_STRING","join",512],"(",["T_CONSTANT_ENCAPSED_STRING","'\/children\/'",512],",",["T_WHITESPACE"," ",512],["T_STRING","explode",512],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",512],",",["T_WHITESPACE"," ",512],["T_VARIABLE","$startupPage",512],")",")",["T_WHITESPACE"," ",512],".",["T_WHITESPACE"," ",512],["T_CONSTANT_ENCAPSED_STRING","'\/action'",512],";",["T_WHITESPACE","\n            ",512],["T_VARIABLE","$url",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_STRING_CAST","(string)",513],["T_STRING","Mage",513],["T_DOUBLE_COLON","::",513],["T_STRING","getSingleton",513],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/config'",513],")",["T_OBJECT_OPERATOR","->",513],["T_STRING","getAdminhtmlConfig",513],"(",")",["T_OBJECT_OPERATOR","->",513],["T_STRING","getNode",513],"(",["T_VARIABLE","$nodePath",513],")",";",["T_WHITESPACE","\n            ",513],["T_IF","if",514],["T_WHITESPACE"," ",514],"(",["T_VARIABLE","$url",514],")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n                ",514],["T_RETURN","return",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$url",515],";",["T_WHITESPACE","\n            ",515],"}",["T_WHITESPACE","\n        ",516],"}",["T_WHITESPACE","\n        ",517],["T_RETURN","return",518],["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","findFirstAvailableMenu",518],"(",")",";",["T_WHITESPACE","\n    ",518],"}",["T_WHITESPACE","\n\n    ",519],["T_DOC_COMMENT","\/**\n     * Validate user attribute values.\n     * Returns TRUE or array of errors.\n     *\n     * @return mixed\n     *\/",521],["T_WHITESPACE","\n    ",526],["T_PUBLIC","public",527],["T_WHITESPACE"," ",527],["T_FUNCTION","function",527],["T_WHITESPACE"," ",527],["T_STRING","validate",527],"(",")",["T_WHITESPACE","\n    ",527],"{",["T_WHITESPACE","\n        ",528],["T_VARIABLE","$errors",529],["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],["T_NEW","new",529],["T_WHITESPACE"," ",529],["T_STRING","ArrayObject",529],"(",")",";",["T_WHITESPACE","\n\n        ",529],["T_IF","if",531],["T_WHITESPACE"," ",531],"(","!",["T_STRING","Zend_Validate",531],["T_DOUBLE_COLON","::",531],["T_STRING","is",531],"(",["T_VARIABLE","$this",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","getUsername",531],"(",")",",",["T_WHITESPACE"," ",531],["T_CONSTANT_ENCAPSED_STRING","'NotEmpty'",531],")",")",["T_WHITESPACE"," ",531],"{",["T_WHITESPACE","\n            ",531],["T_VARIABLE","$errors",532],"[","]",["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_STRING","Mage",532],["T_DOUBLE_COLON","::",532],["T_STRING","helper",532],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",532],")",["T_OBJECT_OPERATOR","->",532],["T_STRING","__",532],"(",["T_CONSTANT_ENCAPSED_STRING","'User Name is required field.'",532],")",";",["T_WHITESPACE","\n        ",532],"}",["T_WHITESPACE","\n\n        ",533],["T_IF","if",535],["T_WHITESPACE"," ",535],"(","!",["T_STRING","Zend_Validate",535],["T_DOUBLE_COLON","::",535],["T_STRING","is",535],"(",["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","getFirstname",535],"(",")",",",["T_WHITESPACE"," ",535],["T_CONSTANT_ENCAPSED_STRING","'NotEmpty'",535],")",")",["T_WHITESPACE"," ",535],"{",["T_WHITESPACE","\n            ",535],["T_VARIABLE","$errors",536],"[","]",["T_WHITESPACE"," ",536],"=",["T_WHITESPACE"," ",536],["T_STRING","Mage",536],["T_DOUBLE_COLON","::",536],["T_STRING","helper",536],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",536],")",["T_OBJECT_OPERATOR","->",536],["T_STRING","__",536],"(",["T_CONSTANT_ENCAPSED_STRING","'First Name is required field.'",536],")",";",["T_WHITESPACE","\n        ",536],"}",["T_WHITESPACE","\n\n        ",537],["T_IF","if",539],["T_WHITESPACE"," ",539],"(","!",["T_STRING","Zend_Validate",539],["T_DOUBLE_COLON","::",539],["T_STRING","is",539],"(",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getLastname",539],"(",")",",",["T_WHITESPACE"," ",539],["T_CONSTANT_ENCAPSED_STRING","'NotEmpty'",539],")",")",["T_WHITESPACE"," ",539],"{",["T_WHITESPACE","\n            ",539],["T_VARIABLE","$errors",540],"[","]",["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_STRING","Mage",540],["T_DOUBLE_COLON","::",540],["T_STRING","helper",540],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",540],")",["T_OBJECT_OPERATOR","->",540],["T_STRING","__",540],"(",["T_CONSTANT_ENCAPSED_STRING","'Last Name is required field.'",540],")",";",["T_WHITESPACE","\n        ",540],"}",["T_WHITESPACE","\n\n        ",541],["T_IF","if",543],["T_WHITESPACE"," ",543],"(","!",["T_STRING","Zend_Validate",543],["T_DOUBLE_COLON","::",543],["T_STRING","is",543],"(",["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","getEmail",543],"(",")",",",["T_WHITESPACE"," ",543],["T_CONSTANT_ENCAPSED_STRING","'EmailAddress'",543],")",")",["T_WHITESPACE"," ",543],"{",["T_WHITESPACE","\n            ",543],["T_VARIABLE","$errors",544],"[","]",["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_STRING","Mage",544],["T_DOUBLE_COLON","::",544],["T_STRING","helper",544],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",544],")",["T_OBJECT_OPERATOR","->",544],["T_STRING","__",544],"(",["T_CONSTANT_ENCAPSED_STRING","'Please enter a valid email.'",544],")",";",["T_WHITESPACE","\n        ",544],"}",["T_WHITESPACE","\n\n        ",545],["T_IF","if",547],["T_WHITESPACE"," ",547],"(",["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","hasNewPassword",547],"(",")",")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n            ",547],["T_IF","if",548],["T_WHITESPACE"," ",548],"(",["T_STRING","Mage",548],["T_DOUBLE_COLON","::",548],["T_STRING","helper",548],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",548],")",["T_OBJECT_OPERATOR","->",548],["T_STRING","strlen",548],"(",["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getNewPassword",548],"(",")",")",["T_WHITESPACE"," ",548],"<",["T_WHITESPACE"," ",548],["T_STRING","self",548],["T_DOUBLE_COLON","::",548],["T_STRING","MIN_PASSWORD_LENGTH",548],")",["T_WHITESPACE"," ",548],"{",["T_WHITESPACE","\n                ",548],["T_VARIABLE","$errors",549],"[","]",["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_STRING","Mage",549],["T_DOUBLE_COLON","::",549],["T_STRING","helper",549],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",549],")",["T_OBJECT_OPERATOR","->",549],["T_STRING","__",549],"(",["T_CONSTANT_ENCAPSED_STRING","'Password must be at least of %d characters.'",549],",",["T_WHITESPACE"," ",549],["T_STRING","self",549],["T_DOUBLE_COLON","::",549],["T_STRING","MIN_PASSWORD_LENGTH",549],")",";",["T_WHITESPACE","\n            ",549],"}",["T_WHITESPACE","\n\n            ",550],["T_IF","if",552],["T_WHITESPACE"," ",552],"(","!",["T_STRING","preg_match",552],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[a-z]\/iu'",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","getNewPassword",552],"(",")",")",["T_WHITESPACE","\n                ",552],["T_BOOLEAN_OR","||",553],["T_WHITESPACE"," ",553],"!",["T_STRING","preg_match",553],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[0-9]\/u'",553],",",["T_WHITESPACE"," ",553],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","getNewPassword",553],"(",")",")",["T_WHITESPACE","\n            ",553],")",["T_WHITESPACE"," ",554],"{",["T_WHITESPACE","\n                ",554],["T_VARIABLE","$errors",555],"[","]",["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_STRING","Mage",555],["T_DOUBLE_COLON","::",555],["T_STRING","helper",555],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",555],")",["T_OBJECT_OPERATOR","->",555],["T_STRING","__",555],"(",["T_CONSTANT_ENCAPSED_STRING","'Password must include both numeric and alphabetic characters.'",555],")",";",["T_WHITESPACE","\n            ",555],"}",["T_WHITESPACE","\n\n            ",556],["T_IF","if",558],["T_WHITESPACE"," ",558],"(",["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","hasPasswordConfirmation",558],"(",")",["T_WHITESPACE"," ",558],["T_BOOLEAN_AND","&&",558],["T_WHITESPACE"," ",558],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","getNewPassword",558],"(",")",["T_WHITESPACE"," ",558],["T_IS_NOT_EQUAL","!=",558],["T_WHITESPACE"," ",558],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","getPasswordConfirmation",558],"(",")",")",["T_WHITESPACE"," ",558],"{",["T_WHITESPACE","\n                ",558],["T_VARIABLE","$errors",559],"[","]",["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_STRING","Mage",559],["T_DOUBLE_COLON","::",559],["T_STRING","helper",559],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",559],")",["T_OBJECT_OPERATOR","->",559],["T_STRING","__",559],"(",["T_CONSTANT_ENCAPSED_STRING","'Password confirmation must be same as password.'",559],")",";",["T_WHITESPACE","\n            ",559],"}",["T_WHITESPACE","\n\n            ",560],["T_STRING","Mage",562],["T_DOUBLE_COLON","::",562],["T_STRING","dispatchEvent",562],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_user_validate'",562],",",["T_WHITESPACE"," ",562],["T_ARRAY","array",562],"(",["T_WHITESPACE","\n                ",562],["T_CONSTANT_ENCAPSED_STRING","'user'",563],["T_WHITESPACE"," ",563],["T_DOUBLE_ARROW","=>",563],["T_WHITESPACE"," ",563],["T_VARIABLE","$this",563],",",["T_WHITESPACE","\n                ",563],["T_CONSTANT_ENCAPSED_STRING","'errors'",564],["T_WHITESPACE"," ",564],["T_DOUBLE_ARROW","=>",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$errors",564],",",["T_WHITESPACE","\n            ",564],")",")",";",["T_WHITESPACE","\n        ",565],"}",["T_WHITESPACE","\n\n        ",566],["T_IF","if",568],["T_WHITESPACE"," ",568],"(",["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","userExists",568],"(",")",")",["T_WHITESPACE"," ",568],"{",["T_WHITESPACE","\n            ",568],["T_VARIABLE","$errors",569],"[","]",["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_STRING","Mage",569],["T_DOUBLE_COLON","::",569],["T_STRING","helper",569],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",569],")",["T_OBJECT_OPERATOR","->",569],["T_STRING","__",569],"(",["T_CONSTANT_ENCAPSED_STRING","'A user with the same user name or email aleady exists.'",569],")",";",["T_WHITESPACE","\n        ",569],"}",["T_WHITESPACE","\n\n        ",570],["T_IF","if",572],["T_WHITESPACE"," ",572],"(",["T_STRING","count",572],"(",["T_VARIABLE","$errors",572],")",["T_WHITESPACE"," ",572],["T_IS_IDENTICAL","===",572],["T_WHITESPACE"," ",572],["T_LNUMBER","0",572],")",["T_WHITESPACE"," ",572],"{",["T_WHITESPACE","\n            ",572],["T_RETURN","return",573],["T_WHITESPACE"," ",573],["T_STRING","true",573],";",["T_WHITESPACE","\n        ",573],"}",["T_WHITESPACE","\n        ",574],["T_RETURN","return",575],["T_WHITESPACE"," ",575],["T_ARRAY_CAST","(array)",575],["T_VARIABLE","$errors",575],";",["T_WHITESPACE","\n    ",575],"}",["T_WHITESPACE","\n\n    ",576],["T_DOC_COMMENT","\/**\n     * Validate password against current user password\n     * Returns true or array of errors.\n     *\n     * @return mixed\n     *\/",578],["T_WHITESPACE","\n    ",583],["T_PUBLIC","public",584],["T_WHITESPACE"," ",584],["T_FUNCTION","function",584],["T_WHITESPACE"," ",584],["T_STRING","validateCurrentPassword",584],"(",["T_VARIABLE","$password",584],")",["T_WHITESPACE","\n    ",584],"{",["T_WHITESPACE","\n        ",585],["T_VARIABLE","$result",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_ARRAY","array",586],"(",")",";",["T_WHITESPACE","\n\n        ",586],["T_IF","if",588],["T_WHITESPACE"," ",588],"(","!",["T_STRING","Zend_Validate",588],["T_DOUBLE_COLON","::",588],["T_STRING","is",588],"(",["T_VARIABLE","$password",588],",",["T_WHITESPACE"," ",588],["T_CONSTANT_ENCAPSED_STRING","'NotEmpty'",588],")",")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n            ",588],["T_VARIABLE","$result",589],"[","]",["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","_getHelper",589],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",589],")",["T_OBJECT_OPERATOR","->",589],["T_STRING","__",589],"(",["T_CONSTANT_ENCAPSED_STRING","'Current password field cannot be empty.'",589],")",";",["T_WHITESPACE","\n        ",589],"}",["T_WHITESPACE"," ",590],["T_ELSEIF","elseif",590],["T_WHITESPACE"," ",590],"(",["T_STRING","is_null",590],"(",["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","getId",590],"(",")",")",["T_WHITESPACE"," ",590],["T_BOOLEAN_OR","||",590],["T_WHITESPACE"," ",590],"!",["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","_getHelper",590],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",590],")",["T_OBJECT_OPERATOR","->",590],["T_STRING","validateHash",590],"(",["T_VARIABLE","$password",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","getPassword",590],"(",")",")",")","{",["T_WHITESPACE","\n            ",590],["T_VARIABLE","$result",591],"[","]",["T_WHITESPACE"," ",591],"=",["T_WHITESPACE"," ",591],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","_getHelper",591],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",591],")",["T_OBJECT_OPERATOR","->",591],["T_STRING","__",591],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid current password.'",591],")",";",["T_WHITESPACE","\n        ",591],"}",["T_WHITESPACE","\n\n        ",592],["T_IF","if",594],["T_WHITESPACE"," ",594],"(",["T_EMPTY","empty",594],"(",["T_VARIABLE","$result",594],")",")",["T_WHITESPACE"," ",594],"{",["T_WHITESPACE","\n            ",594],["T_VARIABLE","$result",595],["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_STRING","true",595],";",["T_WHITESPACE","\n        ",595],"}",["T_WHITESPACE","\n        ",596],["T_RETURN","return",597],["T_WHITESPACE"," ",597],["T_VARIABLE","$result",597],";",["T_WHITESPACE","\n    ",597],"}",["T_WHITESPACE","\n\n    ",598],["T_DOC_COMMENT","\/**\n     * Change reset password link token\n     *\n     * Stores new reset password link token and its creation time\n     *\n     * @param string $newResetPasswordLinkToken\n     * @return Mage_Admin_Model_User\n     * @throws Mage_Core_Exception\n     *\/",600],["T_WHITESPACE","\n    ",608],["T_PUBLIC","public",609],["T_WHITESPACE"," ",609],["T_FUNCTION","function",609],["T_WHITESPACE"," ",609],["T_STRING","changeResetPasswordLinkToken",609],"(",["T_VARIABLE","$newResetPasswordLinkToken",609],")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n        ",609],["T_IF","if",610],["T_WHITESPACE"," ",610],"(","!",["T_STRING","is_string",610],"(",["T_VARIABLE","$newResetPasswordLinkToken",610],")",["T_WHITESPACE"," ",610],["T_BOOLEAN_OR","||",610],["T_WHITESPACE"," ",610],["T_EMPTY","empty",610],"(",["T_VARIABLE","$newResetPasswordLinkToken",610],")",")",["T_WHITESPACE"," ",610],"{",["T_WHITESPACE","\n            ",610],["T_THROW","throw",611],["T_WHITESPACE"," ",611],["T_STRING","Mage",611],["T_DOUBLE_COLON","::",611],["T_STRING","exception",611],"(",["T_CONSTANT_ENCAPSED_STRING","'Mage_Core'",611],",",["T_WHITESPACE"," ",611],["T_STRING","Mage",611],["T_DOUBLE_COLON","::",611],["T_STRING","helper",611],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",611],")",["T_OBJECT_OPERATOR","->",611],["T_STRING","__",611],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid password reset token.'",611],")",")",";",["T_WHITESPACE","\n        ",611],"}",["T_WHITESPACE","\n        ",612],["T_VARIABLE","$this",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","setRpToken",613],"(",["T_VARIABLE","$newResetPasswordLinkToken",613],")",";",["T_WHITESPACE","\n        ",613],["T_VARIABLE","$currentDate",614],["T_WHITESPACE"," ",614],"=",["T_WHITESPACE"," ",614],["T_STRING","Varien_Date",614],["T_DOUBLE_COLON","::",614],["T_STRING","now",614],"(",")",";",["T_WHITESPACE","\n        ",614],["T_VARIABLE","$this",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","setRpTokenCreatedAt",615],"(",["T_VARIABLE","$currentDate",615],")",";",["T_WHITESPACE","\n\n        ",615],["T_RETURN","return",617],["T_WHITESPACE"," ",617],["T_VARIABLE","$this",617],";",["T_WHITESPACE","\n    ",617],"}",["T_WHITESPACE","\n\n    ",618],["T_DOC_COMMENT","\/**\n     * Check if current reset password link token is expired\n     *\n     * @return boolean\n     *\/",620],["T_WHITESPACE","\n    ",624],["T_PUBLIC","public",625],["T_WHITESPACE"," ",625],["T_FUNCTION","function",625],["T_WHITESPACE"," ",625],["T_STRING","isResetPasswordLinkTokenExpired",625],"(",")",["T_WHITESPACE","\n    ",625],"{",["T_WHITESPACE","\n        ",626],["T_VARIABLE","$resetPasswordLinkToken",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","getRpToken",627],"(",")",";",["T_WHITESPACE","\n        ",627],["T_VARIABLE","$resetPasswordLinkTokenCreatedAt",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","getRpTokenCreatedAt",628],"(",")",";",["T_WHITESPACE","\n\n        ",628],["T_IF","if",630],["T_WHITESPACE"," ",630],"(",["T_EMPTY","empty",630],"(",["T_VARIABLE","$resetPasswordLinkToken",630],")",["T_WHITESPACE"," ",630],["T_BOOLEAN_OR","||",630],["T_WHITESPACE"," ",630],["T_EMPTY","empty",630],"(",["T_VARIABLE","$resetPasswordLinkTokenCreatedAt",630],")",")",["T_WHITESPACE"," ",630],"{",["T_WHITESPACE","\n            ",630],["T_RETURN","return",631],["T_WHITESPACE"," ",631],["T_STRING","true",631],";",["T_WHITESPACE","\n        ",631],"}",["T_WHITESPACE","\n\n        ",632],["T_VARIABLE","$tokenExpirationPeriod",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_STRING","Mage",634],["T_DOUBLE_COLON","::",634],["T_STRING","helper",634],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",634],")",["T_OBJECT_OPERATOR","->",634],["T_STRING","getResetPasswordLinkExpirationPeriod",634],"(",")",";",["T_WHITESPACE","\n\n        ",634],["T_VARIABLE","$currentDate",636],["T_WHITESPACE"," ",636],"=",["T_WHITESPACE"," ",636],["T_STRING","Varien_Date",636],["T_DOUBLE_COLON","::",636],["T_STRING","now",636],"(",")",";",["T_WHITESPACE","\n        ",636],["T_VARIABLE","$currentTimestamp",637],["T_WHITESPACE"," ",637],"=",["T_WHITESPACE"," ",637],["T_STRING","Varien_Date",637],["T_DOUBLE_COLON","::",637],["T_STRING","toTimestamp",637],"(",["T_VARIABLE","$currentDate",637],")",";",["T_WHITESPACE","\n        ",637],["T_VARIABLE","$tokenTimestamp",638],["T_WHITESPACE"," ",638],"=",["T_WHITESPACE"," ",638],["T_STRING","Varien_Date",638],["T_DOUBLE_COLON","::",638],["T_STRING","toTimestamp",638],"(",["T_VARIABLE","$resetPasswordLinkTokenCreatedAt",638],")",";",["T_WHITESPACE","\n        ",638],["T_IF","if",639],["T_WHITESPACE"," ",639],"(",["T_VARIABLE","$tokenTimestamp",639],["T_WHITESPACE"," ",639],">",["T_WHITESPACE"," ",639],["T_VARIABLE","$currentTimestamp",639],")",["T_WHITESPACE"," ",639],"{",["T_WHITESPACE","\n            ",639],["T_RETURN","return",640],["T_WHITESPACE"," ",640],["T_STRING","true",640],";",["T_WHITESPACE","\n        ",640],"}",["T_WHITESPACE","\n\n        ",641],["T_VARIABLE","$hoursDifference",643],["T_WHITESPACE"," ",643],"=",["T_WHITESPACE"," ",643],["T_STRING","floor",643],"(","(",["T_VARIABLE","$currentTimestamp",643],["T_WHITESPACE"," ",643],"-",["T_WHITESPACE"," ",643],["T_VARIABLE","$tokenTimestamp",643],")",["T_WHITESPACE"," ",643],"\/",["T_WHITESPACE"," ",643],"(",["T_LNUMBER","60",643],["T_WHITESPACE"," ",643],"*",["T_WHITESPACE"," ",643],["T_LNUMBER","60",643],")",")",";",["T_WHITESPACE","\n        ",643],["T_IF","if",644],["T_WHITESPACE"," ",644],"(",["T_VARIABLE","$hoursDifference",644],["T_WHITESPACE"," ",644],["T_IS_GREATER_OR_EQUAL",">=",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$tokenExpirationPeriod",644],")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n            ",644],["T_RETURN","return",645],["T_WHITESPACE"," ",645],["T_STRING","true",645],";",["T_WHITESPACE","\n        ",645],"}",["T_WHITESPACE","\n\n        ",646],["T_RETURN","return",648],["T_WHITESPACE"," ",648],["T_STRING","false",648],";",["T_WHITESPACE","\n    ",648],"}",["T_WHITESPACE","\n\n    ",649],["T_DOC_COMMENT","\/**\n     * Clean password's validation data (password, current_password, new_password, password_confirmation)\n     *\n     * @return Mage_Admin_Model_User\n     *\/",651],["T_WHITESPACE","\n    ",655],["T_PUBLIC","public",656],["T_WHITESPACE"," ",656],["T_FUNCTION","function",656],["T_WHITESPACE"," ",656],["T_STRING","cleanPasswordsValidationData",656],"(",")",["T_WHITESPACE","\n    ",656],"{",["T_WHITESPACE","\n        ",657],["T_VARIABLE","$this",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","setData",658],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",658],",",["T_WHITESPACE"," ",658],["T_STRING","null",658],")",";",["T_WHITESPACE","\n        ",658],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","setData",659],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",659],",",["T_WHITESPACE"," ",659],["T_STRING","null",659],")",";",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","setData",660],"(",["T_CONSTANT_ENCAPSED_STRING","'new_password'",660],",",["T_WHITESPACE"," ",660],["T_STRING","null",660],")",";",["T_WHITESPACE","\n        ",660],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","setData",661],"(",["T_CONSTANT_ENCAPSED_STRING","'password_confirmation'",661],",",["T_WHITESPACE"," ",661],["T_STRING","null",661],")",";",["T_WHITESPACE","\n        ",661],["T_RETURN","return",662],["T_WHITESPACE"," ",662],["T_VARIABLE","$this",662],";",["T_WHITESPACE","\n    ",662],"}",["T_WHITESPACE","\n\n    ",663],["T_DOC_COMMENT","\/**\n     * Simple sql format date\n     *\n     * @param string | boolean $dayOnly\n     * @return string\n     *\/",665],["T_WHITESPACE","\n    ",670],["T_PROTECTED","protected",671],["T_WHITESPACE"," ",671],["T_FUNCTION","function",671],["T_WHITESPACE"," ",671],["T_STRING","_getDateNow",671],"(",["T_VARIABLE","$dayOnly",671],["T_WHITESPACE"," ",671],"=",["T_WHITESPACE"," ",671],["T_STRING","false",671],")",["T_WHITESPACE","\n    ",671],"{",["T_WHITESPACE","\n        ",672],["T_RETURN","return",673],["T_WHITESPACE"," ",673],["T_STRING","now",673],"(",["T_VARIABLE","$dayOnly",673],")",";",["T_WHITESPACE","\n    ",673],"}",["T_WHITESPACE","\n",674],"}",["T_WHITESPACE","\n",675]]