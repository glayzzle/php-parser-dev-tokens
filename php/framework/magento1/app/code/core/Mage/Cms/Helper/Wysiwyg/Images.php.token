[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Cms\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Wysiwyg Images Helper\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Cms_Helper_Wysiwyg_Images",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Helper_Abstract",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Current directory path\n     * @var string\n     *\/",33],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_currentPath",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Current directory URL\n     * @var string\n     *\/",39],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_currentUrl",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Currenty selected store ID if applicable\n     *\n     * @var int\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_storeId",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","null",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Image Storage root directory\n     * @var string\n     *\/",52],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_storageRoot",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Set a specified store ID value\n     *\n     * @param <type> $store\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","setStoreId",63],"(",["T_VARIABLE","$store",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_storeId",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$store",65],";",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Images Storage root directory\n     *\n     * @return string\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","getStorageRoot",74],"(",")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_storageRoot",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$path",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","Mage",77],["T_DOUBLE_COLON","::",77],["T_STRING","getConfig",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getOptions",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getMediaDir",77],"(",")",["T_WHITESPACE","\n                ",77],".",["T_WHITESPACE"," ",78],["T_STRING","DS",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_STRING","Mage_Cms_Model_Wysiwyg_Config",78],["T_DOUBLE_COLON","::",78],["T_STRING","IMAGE_DIRECTORY",78],";",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_storageRoot",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","realpath",79],"(",["T_VARIABLE","$path",79],")",";",["T_WHITESPACE","\n            ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(","!",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_storageRoot",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_storageRoot",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$path",81],";",["T_WHITESPACE","\n            ",81],"}",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_storageRoot",83],["T_WHITESPACE"," ",83],["T_CONCAT_EQUAL",".=",83],["T_WHITESPACE"," ",83],["T_STRING","DS",83],";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_storageRoot",85],";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Images Storage base URL\n     *\n     * @return string\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","getBaseUrl",93],"(",")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_STRING","Mage",95],["T_DOUBLE_COLON","::",95],["T_STRING","getBaseUrl",95],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",95],")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Ext Tree node key name\n     *\n     * @return string\n     *\/",98],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","getTreeNodeName",103],"(",")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'node'",105],";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Encode path to HTML element id\n     *\n     * @param string $path Path to file\/directory\n     * @return string\n     *\/",108],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","convertPathToId",114],"(",["T_VARIABLE","$path",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$storageRoot",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","realpath",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getStorageRoot",116],"(",")",")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$path",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","str_replace",117],"(",["T_VARIABLE","$storageRoot",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","''",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$path",117],")",";",["T_WHITESPACE","\n        ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","idEncode",118],"(",["T_VARIABLE","$path",118],")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Decode HTML element id\n     *\n     * @param string $id\n     * @return string\n     *\/",121],["T_WHITESPACE","\n    ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","convertIdToPath",127],"(",["T_VARIABLE","$id",127],")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$path",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","idDecode",129],"(",["T_VARIABLE","$id",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$storageRoot",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","realpath",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getStorageRoot",130],"(",")",")",";",["T_WHITESPACE","\n        ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(","!",["T_STRING","strstr",131],"(",["T_VARIABLE","$path",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$storageRoot",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$path",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$storageRoot",132],["T_WHITESPACE"," ",132],".",["T_WHITESPACE"," ",132],["T_STRING","DS",132],["T_WHITESPACE"," ",132],".",["T_WHITESPACE"," ",132],["T_VARIABLE","$path",132],";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$path",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * File system path correction\n     *\n     * @param string $path Original path\n     * @param boolean $trim Trim slashes or not\n     * @return string\n     *\/",137],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","correctPath",144],"(",["T_VARIABLE","$path",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$trim",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","true",144],")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$path",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","strtr",146],"(",["T_VARIABLE","$path",146],",",["T_WHITESPACE"," ",146],["T_CONSTANT_ENCAPSED_STRING","\"\\\\\\\/\"",146],",",["T_WHITESPACE"," ",146],["T_STRING","DS",146],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_STRING","DS",146],")",";",["T_WHITESPACE","\n        ",146],["T_IF","if",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$trim",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$path",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","trim",148],"(",["T_VARIABLE","$path",148],",",["T_WHITESPACE"," ",148],["T_STRING","DS",148],")",";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$path",150],";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Return file system path as Url string\n     *\n     * @param string $path\n     * @return string\n     *\/",153],["T_WHITESPACE","\n    ",158],["T_PUBLIC","public",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","convertPathToUrl",159],"(",["T_VARIABLE","$path",159],")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","str_replace",161],"(",["T_STRING","DS",161],",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'\/'",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$path",161],")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Check whether using static URLs is allowed\n     *\n     * @return boolean\n     *\/",164],["T_WHITESPACE","\n    ",168],["T_PUBLIC","public",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","isUsingStaticUrlsAllowed",169],"(",")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$checkResult",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_NEW","new",171],["T_WHITESPACE"," ",171],["T_STRING","StdClass",171],";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$checkResult",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","isAllowed",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","false",172],";",["T_WHITESPACE","\n        ",172],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","dispatchEvent",173],"(",["T_CONSTANT_ENCAPSED_STRING","'cms_wysiwyg_images_static_urls_allowed'",173],",",["T_WHITESPACE"," ",173],["T_ARRAY","array",173],"(",["T_WHITESPACE","\n            ",173],["T_CONSTANT_ENCAPSED_STRING","'result'",174],["T_WHITESPACE","   ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$checkResult",174],",",["T_WHITESPACE","\n            ",174],["T_CONSTANT_ENCAPSED_STRING","'store_id'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_storeId",175],["T_WHITESPACE","\n        ",175],")",")",";",["T_WHITESPACE","\n        ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$checkResult",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","isAllowed",177],";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n\n    ",178],["T_DOC_COMMENT","\/**\n     * Prepare Image insertion declaration for Wysiwyg or textarea(as_is mode)\n     *\n     * @param string $filename Filename transferred via Ajax\n     * @param bool $renderAsTag Leave image HTML as is or transform it to controller directive\n     * @return string\n     *\/",180],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","getImageHtmlDeclaration",187],"(",["T_VARIABLE","$filename",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$renderAsTag",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_STRING","false",187],")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$fileurl",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getCurrentUrl",189],"(",")",["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_VARIABLE","$filename",189],";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$mediaPath",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","str_replace",190],"(",["T_STRING","Mage",190],["T_DOUBLE_COLON","::",190],["T_STRING","getBaseUrl",190],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",190],")",",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","''",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$fileurl",190],")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$directive",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","sprintf",191],"(",["T_CONSTANT_ENCAPSED_STRING","'{{media url=\"%s\"}}'",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$mediaPath",191],")",";",["T_WHITESPACE","\n        ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$renderAsTag",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$html",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","sprintf",193],"(",["T_CONSTANT_ENCAPSED_STRING","'<img src=\"%s\" alt=\"\" \/>'",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","isUsingStaticUrlsAllowed",193],"(",")",["T_WHITESPACE"," ",193],"?",["T_WHITESPACE"," ",193],["T_VARIABLE","$fileurl",193],["T_WHITESPACE"," ",193],":",["T_WHITESPACE"," ",193],["T_VARIABLE","$directive",193],")",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE"," ",194],["T_ELSE","else",194],["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","isUsingStaticUrlsAllowed",195],"(",")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$html",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$fileurl",196],";",["T_WHITESPACE"," ",196],["T_COMMENT","\/\/ $mediaPath;\n",196],["T_WHITESPACE","            ",197],"}",["T_WHITESPACE"," ",197],["T_ELSE","else",197],["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$directive",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","helper",198],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","urlEncode",198],"(",["T_VARIABLE","$directive",198],")",";",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$html",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","Mage",199],["T_DOUBLE_COLON","::",199],["T_STRING","helper",199],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",199],")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getUrl",199],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/cms_wysiwyg\/directive'",199],",",["T_WHITESPACE"," ",199],["T_ARRAY","array",199],"(",["T_CONSTANT_ENCAPSED_STRING","'___directive'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$directive",199],")",")",";",["T_WHITESPACE","\n            ",199],"}",["T_WHITESPACE","\n        ",200],"}",["T_WHITESPACE","\n        ",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$html",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Return path of the current selected directory or root directory for startup\n     * Try to create target directory if it doesn't exist\n     *\n     * @throws Mage_Core_Exception\n     * @return string\n     *\/",205],["T_WHITESPACE","\n    ",211],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","getCurrentPath",212],"(",")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(","!",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_currentPath",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$currentPath",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getStorageRoot",215],"(",")",";",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$node",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_getRequest",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","getParam",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getTreeNodeName",216],"(",")",")",";",["T_WHITESPACE","\n            ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_VARIABLE","$node",217],")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$path",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","realpath",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","convertIdToPath",218],"(",["T_VARIABLE","$node",218],")",")",";",["T_WHITESPACE","\n                ",218],["T_IF","if",219],["T_WHITESPACE"," ",219],"(",["T_STRING","is_dir",219],"(",["T_VARIABLE","$path",219],")",["T_WHITESPACE"," ",219],["T_BOOLEAN_AND","&&",219],["T_WHITESPACE"," ",219],["T_STRING","false",219],["T_WHITESPACE"," ",219],["T_IS_NOT_IDENTICAL","!==",219],["T_WHITESPACE"," ",219],["T_STRING","stripos",219],"(",["T_VARIABLE","$path",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$currentPath",219],")",")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n                    ",219],["T_VARIABLE","$currentPath",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$path",220],";",["T_WHITESPACE","\n                ",220],"}",["T_WHITESPACE","\n            ",221],"}",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$io",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_NEW","new",223],["T_WHITESPACE"," ",223],["T_STRING","Varien_Io_File",223],"(",")",";",["T_WHITESPACE","\n            ",223],["T_IF","if",224],["T_WHITESPACE"," ",224],"(","!",["T_VARIABLE","$io",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","isWriteable",224],"(",["T_VARIABLE","$currentPath",224],")",["T_WHITESPACE"," ",224],["T_BOOLEAN_AND","&&",224],["T_WHITESPACE"," ",224],"!",["T_VARIABLE","$io",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","mkdir",224],"(",["T_VARIABLE","$currentPath",224],")",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                ",224],["T_VARIABLE","$message",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_STRING","Mage",225],["T_DOUBLE_COLON","::",225],["T_STRING","helper",225],"(",["T_CONSTANT_ENCAPSED_STRING","'cms'",225],")",["T_OBJECT_OPERATOR","->",225],["T_STRING","__",225],"(",["T_CONSTANT_ENCAPSED_STRING","'The directory %s is not writable by server.'",225],",",["T_WHITESPACE","\n                    ",225],["T_VARIABLE","$io",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getFilteredPath",226],"(",["T_VARIABLE","$currentPath",226],")",")",";",["T_WHITESPACE","\n                ",226],["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","throwException",227],"(",["T_VARIABLE","$message",227],")",";",["T_WHITESPACE","\n            ",227],"}",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_currentPath",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$currentPath",229],";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_currentPath",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Return URL based on current selected directory or root directory for startup\n     *\n     * @return string\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","getCurrentUrl",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(","!",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_currentUrl",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$mediaPath",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","realpath",242],"(",["T_STRING","Mage",242],["T_DOUBLE_COLON","::",242],["T_STRING","getConfig",242],"(",")",["T_OBJECT_OPERATOR","->",242],["T_STRING","getOptions",242],"(",")",["T_OBJECT_OPERATOR","->",242],["T_STRING","getMediaDir",242],"(",")",")",";",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$path",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","str_replace",243],"(",["T_VARIABLE","$mediaPath",243],",",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","''",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getCurrentPath",243],"(",")",")",";",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$path",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","trim",244],"(",["T_VARIABLE","$path",244],",",["T_WHITESPACE"," ",244],["T_STRING","DS",244],")",";",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_currentUrl",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","Mage",245],["T_DOUBLE_COLON","::",245],["T_STRING","app",245],"(",")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getStore",245],"(",["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_storeId",245],")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getBaseUrl",245],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",245],")",["T_WHITESPACE"," ",245],".",["T_WHITESPACE","\n                                 ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","convertPathToUrl",246],"(",["T_VARIABLE","$path",246],")",["T_WHITESPACE"," ",246],".",["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'\/'",246],";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_currentUrl",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Storage model singleton\n     *\n     * @return Mage_Cms_Model_Page_Wysiwyg_Images_Storage\n     *\/",251],["T_WHITESPACE","\n    ",255],["T_PUBLIC","public",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","getStorage",256],"(",")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_STRING","Mage",258],["T_DOUBLE_COLON","::",258],["T_STRING","getSingleton",258],"(",["T_CONSTANT_ENCAPSED_STRING","'cms\/wysiwyg_images_storage'",258],")",";",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n\n    ",259],["T_DOC_COMMENT","\/**\n     * Encode string to valid HTML id element, based on base64 encoding\n     *\n     * @param string $string\n     * @return string\n     *\/",261],["T_WHITESPACE","\n    ",266],["T_PUBLIC","public",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","idEncode",267],"(",["T_VARIABLE","$string",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_STRING","strtr",269],"(",["T_STRING","base64_encode",269],"(",["T_VARIABLE","$string",269],")",",",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'+\/='",269],",",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","':_-'",269],")",";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * Revert opration to idEncode\n     *\n     * @param string $string\n     * @return string\n     *\/",272],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","idDecode",278],"(",["T_VARIABLE","$string",278],")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$string",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_STRING","strtr",280],"(",["T_VARIABLE","$string",280],",",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","':_-'",280],",",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'+\/='",280],")",";",["T_WHITESPACE","\n        ",280],["T_RETURN","return",281],["T_WHITESPACE"," ",281],["T_STRING","base64_decode",281],"(",["T_VARIABLE","$string",281],")",";",["T_WHITESPACE","\n    ",281],"}",["T_WHITESPACE","\n\n    ",282],["T_DOC_COMMENT","\/**\n     * Reduce filename by replacing some characters with dots\n     *\n     * @param string $filename\n     * @param int $maxLength Maximum filename\n     * @return string Truncated filename\n     *\/",284],["T_WHITESPACE","\n    ",290],["T_PUBLIC","public",291],["T_WHITESPACE"," ",291],["T_FUNCTION","function",291],["T_WHITESPACE"," ",291],["T_STRING","getShortFilename",291],"(",["T_VARIABLE","$filename",291],",",["T_WHITESPACE"," ",291],["T_VARIABLE","$maxLength",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_LNUMBER","20",291],")",["T_WHITESPACE","\n    ",291],"{",["T_WHITESPACE","\n        ",292],["T_IF","if",293],["T_WHITESPACE"," ",293],"(",["T_STRING","strlen",293],"(",["T_VARIABLE","$filename",293],")",["T_WHITESPACE"," ",293],["T_IS_SMALLER_OR_EQUAL","<=",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$maxLength",293],")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n            ",293],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$filename",294],";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_STRING","substr",296],"(",["T_VARIABLE","$filename",296],",",["T_WHITESPACE"," ",296],["T_LNUMBER","0",296],",",["T_WHITESPACE"," ",296],["T_VARIABLE","$maxLength",296],")",["T_WHITESPACE"," ",296],".",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'...'",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n",297],"}",["T_WHITESPACE","\n",298]]