[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Reports\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Coupons Report collection\n *\n * @category    Mage\n * @package     Mage_Reports\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Reports_Model_Resource_Coupons_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Entity_Order_Collection",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * From value\n     *\n     * @var string\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_from",42],["T_WHITESPACE","     ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","''",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * To value\n     *\n     * @var string\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_to",49],["T_WHITESPACE","       ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","''",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Set date range\n     *\n     * @param string $from\n     * @param string $to\n     * @return Mage_Reports_Model_Resource_Coupons_Collection\n     *\/",51],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","setDateRange",58],"(",["T_VARIABLE","$from",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$to",58],")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_from",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$from",60],";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_to",61],["T_WHITESPACE","   ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$to",61],";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_reset",62],"(",")",";",["T_WHITESPACE","\n        ",62],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Set store ids\n     *\n     * @param array $storeIds\n     * @return Mage_Reports_Model_Resource_Coupons_Collection\n     *\/",66],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","setStoreIds",72],"(",["T_VARIABLE","$storeIds",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","joinFields",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_from",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_to",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$storeIds",74],")",";",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Join fields\n     *\n     * @param string $from\n     * @param string $to\n     * @param array $storeIds\n     *\/",78],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","joinFields",85],"(",["T_VARIABLE","$from",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$to",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$storeIds",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",")",")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","groupByAttribute",87],"(",["T_CONSTANT_ENCAPSED_STRING","'coupon_code'",87],")",["T_WHITESPACE","\n            ",87],["T_OBJECT_OPERATOR","->",88],["T_STRING","addAttributeToFilter",88],"(",["T_CONSTANT_ENCAPSED_STRING","'created_at'",88],",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_CONSTANT_ENCAPSED_STRING","'from'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$from",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'to'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$to",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'datetime'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","true",88],")",")",["T_WHITESPACE","\n            ",88],["T_OBJECT_OPERATOR","->",89],["T_STRING","addAttributeToFilter",89],"(",["T_CONSTANT_ENCAPSED_STRING","'coupon_code'",89],",",["T_WHITESPACE"," ",89],["T_ARRAY","array",89],"(",["T_CONSTANT_ENCAPSED_STRING","'neq'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","''",89],")",")",["T_WHITESPACE","\n            ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","getSelect",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","columns",90],"(",["T_ARRAY","array",90],"(",["T_CONSTANT_ENCAPSED_STRING","'uses'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'COUNT(e.entity_id)'",90],")",")",["T_WHITESPACE","\n            ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","having",91],"(",["T_CONSTANT_ENCAPSED_STRING","'uses > ?'",91],",",["T_WHITESPACE"," ",91],["T_LNUMBER","0",91],")",["T_WHITESPACE","\n            ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","order",92],"(",["T_CONSTANT_ENCAPSED_STRING","'uses '",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_STRING","self",92],["T_DOUBLE_COLON","::",92],["T_STRING","SORT_ORDER_DESC",92],")",";",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$storeIds",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","array_values",94],"(",["T_VARIABLE","$storeIds",94],")",";",["T_WHITESPACE","\n        ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_STRING","count",95],"(",["T_VARIABLE","$storeIds",95],")",["T_WHITESPACE"," ",95],["T_IS_GREATER_OR_EQUAL",">=",95],["T_WHITESPACE"," ",95],["T_LNUMBER","1",95],["T_WHITESPACE"," ",95],["T_BOOLEAN_AND","&&",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$storeIds",95],"[",["T_LNUMBER","0",95],"]",["T_WHITESPACE"," ",95],["T_IS_NOT_EQUAL","!=",95],["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","''",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","addAttributeToFilter",96],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",96],",",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$storeIds",96],")",")",";",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","addExpressionAttributeToSelect",97],"(",["T_WHITESPACE","\n                ",97],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",98],",",["T_WHITESPACE","\n                ",98],["T_CONSTANT_ENCAPSED_STRING","'SUM({{base_subtotal}})'",99],",",["T_WHITESPACE","\n                ",99],["T_ARRAY","array",100],"(",["T_CONSTANT_ENCAPSED_STRING","'base_subtotal'",100],")",")",["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","addExpressionAttributeToSelect",101],"(",["T_WHITESPACE","\n                ",101],["T_CONSTANT_ENCAPSED_STRING","'discount'",102],",",["T_WHITESPACE","\n                ",102],["T_CONSTANT_ENCAPSED_STRING","'SUM({{base_discount_amount}})'",103],",",["T_WHITESPACE","\n                ",103],["T_ARRAY","array",104],"(",["T_CONSTANT_ENCAPSED_STRING","'base_discount_amount'",104],")",")",["T_WHITESPACE","\n            ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","addExpressionAttributeToSelect",105],"(",["T_WHITESPACE","\n                ",105],["T_CONSTANT_ENCAPSED_STRING","'total'",106],",",["T_WHITESPACE","\n                ",106],["T_CONSTANT_ENCAPSED_STRING","'SUM({{base_subtotal}}-{{base_discount_amount}})'",107],",",["T_WHITESPACE","\n                ",107],["T_ARRAY","array",108],"(",["T_CONSTANT_ENCAPSED_STRING","'base_subtotal'",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'base_discount_amount'",108],")",")",";",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE"," ",109],["T_ELSE","else",109],["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","addExpressionAttributeToSelect",110],"(",["T_WHITESPACE","\n                ",110],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",111],",",["T_WHITESPACE","\n                ",111],["T_CONSTANT_ENCAPSED_STRING","'SUM({{base_subtotal}}*{{base_to_global_rate}})'",112],",",["T_WHITESPACE","\n                ",112],["T_ARRAY","array",113],"(",["T_CONSTANT_ENCAPSED_STRING","'base_subtotal'",113],",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",113],")",")",["T_WHITESPACE","\n            ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","addExpressionAttributeToSelect",114],"(",["T_WHITESPACE","\n                ",114],["T_CONSTANT_ENCAPSED_STRING","'discount'",115],",",["T_WHITESPACE","\n                ",115],["T_CONSTANT_ENCAPSED_STRING","'SUM({{base_discount_amount}}*{{base_to_global_rate}})'",116],",",["T_WHITESPACE","\n                ",116],["T_ARRAY","array",117],"(",["T_CONSTANT_ENCAPSED_STRING","'base_discount_amount'",117],",",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",117],")",")",["T_WHITESPACE","\n            ",117],["T_OBJECT_OPERATOR","->",118],["T_STRING","addExpressionAttributeToSelect",118],"(",["T_WHITESPACE","\n                ",118],["T_CONSTANT_ENCAPSED_STRING","'total'",119],",",["T_WHITESPACE","\n                ",119],["T_CONSTANT_ENCAPSED_STRING","'SUM(({{base_subtotal}}-{{base_discount_amount}})*{{base_to_global_rate}})'",120],",",["T_WHITESPACE","\n                ",120],["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","'base_subtotal'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'base_discount_amount'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",121],")",")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n\n    ",122],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Get select count sql\n     *\n     * @return string\n     *\/",126],["T_WHITESPACE","\n    ",130],["T_PUBLIC","public",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","getSelectCountSql",131],"(",")",["T_WHITESPACE","\n    ",131],"{",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$countSelect",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_CLONE","clone",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getSelect",133],"(",")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$countSelect",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","reset",134],"(",["T_STRING","Zend_Db_Select",134],["T_DOUBLE_COLON","::",134],["T_STRING","ORDER",134],")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$countSelect",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","reset",135],"(",["T_STRING","Zend_Db_Select",135],["T_DOUBLE_COLON","::",135],["T_STRING","LIMIT_COUNT",135],")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$countSelect",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","reset",136],"(",["T_STRING","Zend_Db_Select",136],["T_DOUBLE_COLON","::",136],["T_STRING","LIMIT_OFFSET",136],")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$countSelect",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","reset",137],"(",["T_STRING","Zend_Db_Select",137],["T_DOUBLE_COLON","::",137],["T_STRING","COLUMNS",137],")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$countSelect",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","reset",138],"(",["T_STRING","Zend_Db_Select",138],["T_DOUBLE_COLON","::",138],["T_STRING","GROUP",138],")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$countSelect",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","reset",139],"(",["T_STRING","Zend_Db_Select",139],["T_DOUBLE_COLON","::",139],["T_STRING","HAVING",139],")",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$countSelect",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","columns",140],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(DISTINCT main_table.rule_id)'",140],")",";",["T_WHITESPACE","\n\n        ",140],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$countSelect",142],";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n",143],"}",["T_WHITESPACE","\n",144]]