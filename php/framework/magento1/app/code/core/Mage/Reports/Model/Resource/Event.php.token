[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Reports\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Report events resource model\n *\n * @category    Mage\n * @package     Mage_Reports\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Reports_Model_Resource_Event",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Initialize main table and identifier field.\n     * Set main entity table name and primary key field name.\n     *\n     * @return void\n     *\/",37],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","_construct",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_init",45],"(",["T_CONSTANT_ENCAPSED_STRING","'reports\/event'",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'event_id'",45],")",";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Update customer type after customer login\n     *\n     * @param Mage_Reports_Model_Event $model\n     * @param int $visitorId\n     * @param int $customerId\n     * @param array $types\n     * @return Mage_Reports_Model_Resource_Event\n     *\/",48],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","updateCustomerType",57],"(",["T_STRING","Mage_Reports_Model_Event",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$model",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$visitorId",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$customerId",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$types",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",")",")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$types",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_getWriteAdapter",60],"(",")",["T_OBJECT_OPERATOR","->",60],["T_STRING","update",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getMainTable",60],"(",")",",",["T_WHITESPACE","\n                ",60],["T_ARRAY","array",61],"(",["T_CONSTANT_ENCAPSED_STRING","'subject_id'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_INT_CAST","(int)",61],["T_VARIABLE","$customerId",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'subtype'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_LNUMBER","0",61],")",",",["T_WHITESPACE","\n                ",61],["T_ARRAY","array",62],"(",["T_WHITESPACE","\n                    ",62],["T_CONSTANT_ENCAPSED_STRING","'subject_id = ?'",63],["T_WHITESPACE","      ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_INT_CAST","(int)",63],["T_VARIABLE","$visitorId",63],",",["T_WHITESPACE","\n                    ",63],["T_CONSTANT_ENCAPSED_STRING","'subtype = ?'",64],["T_WHITESPACE","         ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_LNUMBER","1",64],",",["T_WHITESPACE","\n                    ",64],["T_CONSTANT_ENCAPSED_STRING","'event_type_id IN(?)'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$types",65],["T_WHITESPACE","\n                ",65],")",["T_WHITESPACE","\n            ",66],")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n        ",68],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Add events log to a collection\n     * The collection id field is used without corellation, so it must be unique.\n     * DESC ordering by event will be added to the collection\n     *\n     * @param Varien_Data_Collection_Db $collection\n     * @param int $eventTypeId\n     * @param int $eventSubjectId\n     * @param int $subtype\n     * @param array $skipIds\n     * @return Mage_Reports_Model_Resource_Event\n     *\/",72],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","applyLogToCollection",84],"(",["T_STRING","Varien_Data_Collection_Db",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$collection",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$eventTypeId",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$eventSubjectId",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$subtype",84],",",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$skipIds",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",")",")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$idFieldName",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$collection",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getResource",87],"(",")",["T_OBJECT_OPERATOR","->",87],["T_STRING","getIdFieldName",87],"(",")",";",["T_WHITESPACE","\n\n        ",87],["T_VARIABLE","$derivedSelect",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getReadConnection",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","select",89],"(",")",["T_WHITESPACE","\n            ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","from",90],"(",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getTable",91],"(",["T_CONSTANT_ENCAPSED_STRING","'reports\/event'",91],")",",",["T_WHITESPACE","\n                ",91],["T_ARRAY","array",92],"(",["T_CONSTANT_ENCAPSED_STRING","'event_id'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_NEW","new",92],["T_WHITESPACE"," ",92],["T_STRING","Zend_Db_Expr",92],"(",["T_CONSTANT_ENCAPSED_STRING","'MAX(event_id)'",92],")",",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'object_id'",92],")",")",["T_WHITESPACE","\n            ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","where",93],"(",["T_CONSTANT_ENCAPSED_STRING","'event_type_id = ?'",93],",",["T_WHITESPACE"," ",93],["T_INT_CAST","(int)",93],["T_VARIABLE","$eventTypeId",93],")",["T_WHITESPACE","\n            ",93],["T_OBJECT_OPERATOR","->",94],["T_STRING","where",94],"(",["T_CONSTANT_ENCAPSED_STRING","'subject_id = ?'",94],",",["T_WHITESPACE"," ",94],["T_INT_CAST","(int)",94],["T_VARIABLE","$eventSubjectId",94],")",["T_WHITESPACE","\n            ",94],["T_OBJECT_OPERATOR","->",95],["T_STRING","where",95],"(",["T_CONSTANT_ENCAPSED_STRING","'subtype = ?'",95],",",["T_WHITESPACE"," ",95],["T_INT_CAST","(int)",95],["T_VARIABLE","$subtype",95],")",["T_WHITESPACE","\n            ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","where",96],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id IN(?)'",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getCurrentStoreIds",96],"(",")",")",["T_WHITESPACE","\n            ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","group",97],"(",["T_CONSTANT_ENCAPSED_STRING","'object_id'",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$skipIds",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","!",["T_STRING","is_array",100],"(",["T_VARIABLE","$skipIds",100],")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$skipIds",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_ARRAY","array",101],"(",["T_INT_CAST","(int)",101],["T_VARIABLE","$skipIds",101],")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$derivedSelect",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","where",103],"(",["T_CONSTANT_ENCAPSED_STRING","'object_id NOT IN(?)'",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$skipIds",103],")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n\n        ",104],["T_VARIABLE","$collection",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getSelect",106],"(",")",["T_WHITESPACE","\n            ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","joinInner",107],"(",["T_WHITESPACE","\n                ",107],["T_ARRAY","array",108],"(",["T_CONSTANT_ENCAPSED_STRING","'evt'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","Zend_Db_Expr",108],"(","\"",["T_ENCAPSED_AND_WHITESPACE","(",108],["T_CURLY_OPEN","{",108],["T_VARIABLE","$derivedSelect",108],"}",["T_ENCAPSED_AND_WHITESPACE",")",108],"\"",")",")",",",["T_WHITESPACE","\n                ",108],"\"",["T_CURLY_OPEN","{",109],["T_VARIABLE","$idFieldName",109],"}",["T_ENCAPSED_AND_WHITESPACE"," = evt.object_id",109],"\"",",",["T_WHITESPACE","\n                ",109],["T_ARRAY","array",110],"(",")",")",["T_WHITESPACE","\n            ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","order",111],"(",["T_CONSTANT_ENCAPSED_STRING","'evt.event_id '",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_STRING","Varien_Db_Select",111],["T_DOUBLE_COLON","::",111],["T_STRING","SQL_DESC",111],")",";",["T_WHITESPACE","\n\n        ",111],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * Obtain all current store ids, depending on configuration\n     *\n     * @param array $predefinedStoreIds\n     * @return array\n     *\/",116],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","getCurrentStoreIds",122],"(",["T_ARRAY","array",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$predefinedStoreIds",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_STRING","null",122],")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$stores",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_ARRAY","array",124],"(",")",";",["T_WHITESPACE","\n        ",124],["T_COMMENT","\/\/ get all or specified stores\n",125],["T_WHITESPACE","        ",126],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_STRING","Mage",126],["T_DOUBLE_COLON","::",126],["T_STRING","app",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getStore",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getId",126],"(",")",["T_WHITESPACE"," ",126],["T_IS_EQUAL","==",126],["T_WHITESPACE"," ",126],["T_LNUMBER","0",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_STRING","null",127],["T_WHITESPACE"," ",127],["T_IS_NOT_IDENTICAL","!==",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$predefinedStoreIds",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$stores",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$predefinedStoreIds",128],";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_FOREACH","foreach",130],["T_WHITESPACE"," ",130],"(",["T_STRING","Mage",130],["T_DOUBLE_COLON","::",130],["T_STRING","app",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","getStores",130],"(",")",["T_WHITESPACE"," ",130],["T_AS","as",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$store",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                    ",130],["T_VARIABLE","$stores",131],"[","]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$store",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getId",131],"(",")",";",["T_WHITESPACE","\n                ",131],"}",["T_WHITESPACE","\n            ",132],"}",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_ELSE","else",134],["T_WHITESPACE"," ",134],"{",["T_WHITESPACE"," ",134],["T_COMMENT","\/\/ get all stores, required by configuration in current store scope\n",134],["T_WHITESPACE","            ",135],["T_SWITCH","switch",135],["T_WHITESPACE"," ",135],"(",["T_STRING","Mage",135],["T_DOUBLE_COLON","::",135],["T_STRING","getStoreConfig",135],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/recently_products\/scope'",135],")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_CASE","case",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'website'",136],":",["T_WHITESPACE","\n                    ",136],["T_VARIABLE","$resourceStore",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","Mage",137],["T_DOUBLE_COLON","::",137],["T_STRING","app",137],"(",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getStore",137],"(",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getWebsite",137],"(",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getStores",137],"(",")",";",["T_WHITESPACE","\n                    ",137],["T_BREAK","break",138],";",["T_WHITESPACE","\n                ",138],["T_CASE","case",139],["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'group'",139],":",["T_WHITESPACE","\n                    ",139],["T_VARIABLE","$resourceStore",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","Mage",140],["T_DOUBLE_COLON","::",140],["T_STRING","app",140],"(",")",["T_OBJECT_OPERATOR","->",140],["T_STRING","getStore",140],"(",")",["T_OBJECT_OPERATOR","->",140],["T_STRING","getGroup",140],"(",")",["T_OBJECT_OPERATOR","->",140],["T_STRING","getStores",140],"(",")",";",["T_WHITESPACE","\n                    ",140],["T_BREAK","break",141],";",["T_WHITESPACE","\n                ",141],["T_DEFAULT","default",142],":",["T_WHITESPACE","\n                    ",142],["T_VARIABLE","$resourceStore",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_ARRAY","array",143],"(",["T_STRING","Mage",143],["T_DOUBLE_COLON","::",143],["T_STRING","app",143],"(",")",["T_OBJECT_OPERATOR","->",143],["T_STRING","getStore",143],"(",")",")",";",["T_WHITESPACE","\n                    ",143],["T_BREAK","break",144],";",["T_WHITESPACE","\n            ",144],"}",["T_WHITESPACE","\n\n            ",145],["T_FOREACH","foreach",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$resourceStore",147],["T_WHITESPACE"," ",147],["T_AS","as",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$store",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n                ",147],["T_VARIABLE","$stores",148],"[","]",["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$store",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getId",148],"(",")",";",["T_WHITESPACE","\n            ",148],"}",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n        ",150],["T_FOREACH","foreach",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$stores",151],["T_WHITESPACE"," ",151],["T_AS","as",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$key",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$store",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$stores",152],"[",["T_VARIABLE","$key",152],"]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_INT_CAST","(int)",152],["T_VARIABLE","$store",152],";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n\n        ",153],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$stores",155],";",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Clean report event table\n     *\n     * @param Mage_Reports_Model_Event $object\n     * @return Mage_Reports_Model_Resource_Event\n     *\/",158],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","clean",164],"(",["T_STRING","Mage_Reports_Model_Event",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$object",164],")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_WHILE","while",166],["T_WHITESPACE"," ",166],"(",["T_STRING","true",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$select",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_getReadAdapter",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","select",167],"(",")",["T_WHITESPACE","\n                ",167],["T_OBJECT_OPERATOR","->",168],["T_STRING","from",168],"(",["T_ARRAY","array",168],"(",["T_CONSTANT_ENCAPSED_STRING","'event_table'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getMainTable",168],"(",")",")",",",["T_WHITESPACE"," ",168],["T_ARRAY","array",168],"(",["T_CONSTANT_ENCAPSED_STRING","'event_id'",168],")",")",["T_WHITESPACE","\n                ",168],["T_OBJECT_OPERATOR","->",169],["T_STRING","joinLeft",169],"(",["T_WHITESPACE","\n                    ",169],["T_ARRAY","array",170],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_table'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getTable",170],"(",["T_CONSTANT_ENCAPSED_STRING","'log\/visitor'",170],")",")",",",["T_WHITESPACE","\n                    ",170],["T_CONSTANT_ENCAPSED_STRING","'event_table.subject_id = visitor_table.visitor_id'",171],",",["T_WHITESPACE","\n                    ",171],["T_ARRAY","array",172],"(",")",")",["T_WHITESPACE","\n                ",172],["T_OBJECT_OPERATOR","->",173],["T_STRING","where",173],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_table.visitor_id IS NULL'",173],")",["T_WHITESPACE","\n                ",173],["T_OBJECT_OPERATOR","->",174],["T_STRING","where",174],"(",["T_CONSTANT_ENCAPSED_STRING","'event_table.subtype = ?'",174],",",["T_WHITESPACE"," ",174],["T_LNUMBER","1",174],")",["T_WHITESPACE","\n                ",174],["T_OBJECT_OPERATOR","->",175],["T_STRING","limit",175],"(",["T_LNUMBER","1000",175],")",";",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$eventIds",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_getReadAdapter",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","fetchCol",176],"(",["T_VARIABLE","$select",176],")",";",["T_WHITESPACE","\n\n            ",176],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_VARIABLE","$eventIds",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                ",178],["T_BREAK","break",179],";",["T_WHITESPACE","\n            ",179],"}",["T_WHITESPACE","\n\n            ",180],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_getWriteAdapter",182],"(",")",["T_OBJECT_OPERATOR","->",182],["T_STRING","delete",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getMainTable",182],"(",")",",",["T_WHITESPACE"," ",182],["T_ARRAY","array",182],"(",["T_CONSTANT_ENCAPSED_STRING","'event_id IN(?)'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$eventIds",182],")",")",";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n        ",183],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n",185],"}",["T_WHITESPACE","\n\n",186]]